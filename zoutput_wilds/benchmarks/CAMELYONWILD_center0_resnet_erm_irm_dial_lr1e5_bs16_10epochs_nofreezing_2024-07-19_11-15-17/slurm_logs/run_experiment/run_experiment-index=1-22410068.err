Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Fri Jul 19 11:17:58 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYONWILD_center0_resnet_erm_irm_dial_lr1e5_bs16_10epochs_reallynofreezing_2024-07-19_11-15-17/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYONWILD_center0_resnet_erm_irm_dial_lr1e5_bs16_10epochs_reallynofreezing_2024-07-19_11-15-17/rule_results/1.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=1
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'888c1ef2'
model name: dset_te_0_erm_b888c1ef2_not_commited_2024md_07md_19_12_57_13_seed_0_22410068

 Experiment start at: 2024-07-19 12:57:13.422812
before training, model accuracy: 0.3186810612678528
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/autograd/graph.py:744: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.91717225, 'precision': 0.92291224, 'recall': 0.9172189, 'specificity': 0.9172189, 'f1': 0.9168964, 'auroc': 0.9751637, 'binary_precision': 0.97238207, 'binary_recall': 0.85887086, 'binary_specificity': 0.97556704, 'binary_f1_score': 0.9121084}
confusion matrix:
        0       1
0  135277    3388
1   19601  119286
---- Validation: 
scalar performance:
{'acc': 0.88939136, 'precision': 0.9071346, 'recall': 0.8891951, 'specificity': 0.8891951, 'f1': 0.8881368, 'auroc': 0.98113275, 'binary_precision': 0.9916585, 'binary_recall': 0.7849683, 'binary_specificity': 0.9934219, 'binary_f1_score': 0.8762904}
confusion matrix:
       0      1
0  59200    392
1  12766  46602
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9300632, 'precision': 0.9324247, 'recall': 0.9300908, 'specificity': 0.9300908, 'f1': 0.9299706, 'auroc': 0.9796026, 'binary_precision': 0.96456736, 'binary_recall': 0.89303553, 'binary_specificity': 0.9671461, 'binary_f1_score': 0.9274242}
confusion matrix:
       0      1
0  20106    683
1   2227  18593
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-19 16:58:29.377565,epoch time: 4:01:15.954753,used: 4:01:15.954753,model: dset_te_0_erm_b888c1ef2_not_commited_2024md_07md_19_12_57_13_seed_0_22410068
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.93219286, 'precision': 0.93485916, 'recall': 0.9322243, 'specificity': 0.9322243, 'f1': 0.93209213, 'auroc': 0.98070776, 'binary_precision': 0.96911067, 'binary_recall': 0.89295614, 'binary_specificity': 0.97149247, 'binary_f1_score': 0.92947614}
confusion matrix:
        0       1
0  134712    3953
1   14867  124020
---- Validation: 
scalar performance:
{'acc': 0.9300521, 'precision': 0.9370656, 'recall': 0.92993337, 'specificity': 0.92993337, 'f1': 0.929757, 'auroc': 0.98699796, 'binary_precision': 0.9919624, 'binary_recall': 0.8668643, 'binary_specificity': 0.9930024, 'binary_f1_score': 0.92520386}
confusion matrix:
       0      1
0  59175    417
1   7904  51464
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9560191, 'precision': 0.9567131, 'recall': 0.95603377, 'specificity': 0.95603377, 'f1': 0.95600337, 'auroc': 0.98947406, 'binary_precision': 0.97470254, 'binary_recall': 0.9364073, 'binary_specificity': 0.9756602, 'binary_f1_score': 0.9551712}
confusion matrix:
       0      1
0  20283    506
1   1324  19496
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-07-19 20:31:52.164250,epoch time: 3:33:22.786685,used: 7:34:38.741438,model: dset_te_0_erm_b888c1ef2_not_commited_2024md_07md_19_12_57_13_seed_0_22410068
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9351725, 'precision': 0.9373896, 'recall': 0.9352016, 'specificity': 0.9352016, 'f1': 0.93509316, 'auroc': 0.98270893, 'binary_precision': 0.9687345, 'binary_recall': 0.8994809, 'binary_specificity': 0.9709223, 'binary_f1_score': 0.93282413}
confusion matrix:
        0       1
0  134631    4032
1   13961  124928
---- Validation: 
scalar performance:
{'acc': 0.922041, 'precision': 0.9306562, 'recall': 0.9219083, 'specificity': 0.9219083, 'f1': 0.9216324, 'auroc': 0.98766696, 'binary_precision': 0.9910984, 'binary_recall': 0.8514351, 'binary_specificity': 0.9923815, 'binary_f1_score': 0.9159735}
confusion matrix:
       0      1
0  59138    454
1   8820  50548
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9590473, 'precision': 0.9595367, 'recall': 0.9590596, 'specificity': 0.9590596, 'f1': 0.9590372, 'auroc': 0.9911579, 'binary_precision': 0.9747194, 'binary_recall': 0.9426033, 'binary_specificity': 0.9755159, 'binary_f1_score': 0.9583924}
confusion matrix:
       0      1
0  20280    509
1   1195  19625
new oracle model saved
early stop counter: 1
val acc:0.9220409989356995, best validation acc: 0.9300521016120911, corresponding to test acc:                         0.9560191035270691 / 0.9590473175048828
after epoch: 3,now: 2024-07-19 23:36:04.599338,epoch time: 3:04:12.435088,used: 10:38:51.176526,model: dset_te_0_erm_b888c1ef2_not_commited_2024md_07md_19_12_57_13_seed_0_22410068
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9410849, 'precision': 0.94301796, 'recall': 0.9411117, 'specificity': 0.9411117, 'f1': 0.941023, 'auroc': 0.9840965, 'binary_precision': 0.9724844, 'binary_recall': 0.90795463, 'binary_specificity': 0.97426873, 'binary_f1_score': 0.9391123}
confusion matrix:
        0       1
0  135096    3568
1   12784  126104
---- Validation: 
scalar performance:
{'acc': 0.9458137, 'precision': 0.94984025, 'recall': 0.9457252, 'specificity': 0.9457252, 'f1': 0.94568455, 'auroc': 0.99087405, 'binary_precision': 0.99193156, 'binary_recall': 0.8987333, 'binary_specificity': 0.99271715, 'binary_f1_score': 0.9430354}
confusion matrix:
       0      1
0  59158    434
1   6012  53356
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9674109, 'precision': 0.9677222, 'recall': 0.9674206, 'specificity': 0.9674206, 'f1': 0.9674059, 'auroc': 0.9931725, 'binary_precision': 0.97997636, 'binary_recall': 0.9543708, 'binary_specificity': 0.9804704, 'binary_f1_score': 0.9670041}
confusion matrix:
       0      1
0  20383    406
1    950  19870
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-07-20 02:23:56.560434,epoch time: 2:47:51.961096,used: 13:26:43.137622,model: dset_te_0_erm_b888c1ef2_not_commited_2024md_07md_19_12_57_13_seed_0_22410068
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9478152, 'precision': 0.9491356, 'recall': 0.947837, 'specificity': 0.947837, 'f1': 0.9477785, 'auroc': 0.98658663, 'binary_precision': 0.97368884, 'binary_recall': 0.9205901, 'binary_specificity': 0.9750838, 'binary_f1_score': 0.9463953}
confusion matrix:
        0       1
0  135210    3455
1   11029  127858
---- Validation: 
scalar performance:
{'acc': 0.9549008, 'precision': 0.9573169, 'recall': 0.95483303, 'specificity': 0.95483303, 'f1': 0.95483625, 'auroc': 0.9923034, 'binary_precision': 0.99008983, 'binary_recall': 0.9188283, 'binary_specificity': 0.9908377, 'binary_f1_score': 0.95312893}
confusion matrix:
       0      1
0  59046    546
1   4819  54549
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9671225, 'precision': 0.96721625, 'recall': 0.9671279, 'specificity': 0.9671279, 'f1': 0.9671211, 'auroc': 0.99347264, 'binary_precision': 0.9740228, 'binary_recall': 0.95989436, 'binary_specificity': 0.9743614, 'binary_f1_score': 0.96690696}
confusion matrix:
       0      1
0  20256    533
1    835  19985
better model found
persisted
after epoch: 5,now: 2024-07-20 05:32:18.898754,epoch time: 3:08:22.338320,used: 16:35:05.475942,model: dset_te_0_erm_b888c1ef2_not_commited_2024md_07md_19_12_57_13_seed_0_22410068
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9536267, 'precision': 0.95436877, 'recall': 0.9536431, 'specificity': 0.9536431, 'f1': 0.9536089, 'auroc': 0.988637, 'binary_precision': 0.9729338, 'binary_recall': 0.93329155, 'binary_specificity': 0.9739947, 'binary_f1_score': 0.95270044}
confusion matrix:
        0       1
0  135058    3606
1    9265  129623
---- Validation: 
scalar performance:
{'acc': 0.9573386, 'precision': 0.959582, 'recall': 0.9572735, 'specificity': 0.9572735, 'f1': 0.957282, 'auroc': 0.9927333, 'binary_precision': 0.9912238, 'binary_recall': 0.9226856, 'binary_specificity': 0.99186134, 'binary_f1_score': 0.9557275}
confusion matrix:
       0      1
0  59107    485
1   4590  54778
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9683722, 'precision': 0.96861625, 'recall': 0.9683808, 'specificity': 0.9683808, 'f1': 0.96836853, 'auroc': 0.99345535, 'binary_precision': 0.97949654, 'binary_recall': 0.95682037, 'binary_specificity': 0.9799413, 'binary_f1_score': 0.9680256}
confusion matrix:
       0      1
0  20372    417
1    899  19921
new oracle model saved
better model found
persisted
after epoch: 6,now: 2024-07-20 08:31:00.269172,epoch time: 2:58:41.370418,used: 19:33:46.846360,model: dset_te_0_erm_b888c1ef2_not_commited_2024md_07md_19_12_57_13_seed_0_22410068
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.95231164, 'precision': 0.95353484, 'recall': 0.9523329, 'specificity': 0.9523329, 'f1': 0.952281, 'auroc': 0.98833144, 'binary_precision': 0.9772926, 'binary_recall': 0.92622167, 'binary_specificity': 0.97844416, 'binary_f1_score': 0.95107204}
confusion matrix:
        0       1
0  135674    2989
1   10247  128642
---- Validation: 
scalar performance:
{'acc': 0.9494284, 'precision': 0.95265496, 'recall': 0.9493495, 'specificity': 0.9493495, 'f1': 0.94933176, 'auroc': 0.99207103, 'binary_precision': 0.9904037, 'binary_recall': 0.90745854, 'binary_specificity': 0.99124044, 'binary_f1_score': 0.94711864}
confusion matrix:
       0      1
0  59070    522
1   5494  53874
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97156864, 'precision': 0.97185624, 'recall': 0.971578, 'specificity': 0.971578, 'f1': 0.97156465, 'auroc': 0.9941143, 'binary_precision': 0.9836938, 'binary_recall': 0.95907784, 'binary_specificity': 0.9840781, 'binary_f1_score': 0.9712298}
confusion matrix:
       0      1
0  20458    331
1    852  19968
new oracle model saved
early stop counter: 1
val acc:0.949428379535675, best validation acc: 0.9573385715484619, corresponding to test acc:                         0.9683722257614136 / 0.9715686440467834
after epoch: 7,now: 2024-07-20 11:30:25.288989,epoch time: 2:59:25.019817,used: 22:33:11.866177,model: dset_te_0_erm_b888c1ef2_not_commited_2024md_07md_19_12_57_13_seed_0_22410068
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9538429, 'precision': 0.955104, 'recall': 0.9538646, 'specificity': 0.9538646, 'f1': 0.95381236, 'auroc': 0.9894464, 'binary_precision': 0.97926754, 'binary_recall': 0.92739576, 'binary_specificity': 0.98033345, 'binary_f1_score': 0.95262605}
confusion matrix:
        0       1
0  135935    2727
1   10084  128806
---- Validation: 
scalar performance:
{'acc': 0.94593143, 'precision': 0.9502294, 'recall': 0.94584, 'specificity': 0.94584, 'f1': 0.9457941, 'auroc': 0.9934814, 'binary_precision': 0.9937507, 'binary_recall': 0.89730155, 'binary_specificity': 0.99437845, 'binary_f1_score': 0.94306654}
confusion matrix:
       0      1
0  59257    335
1   6097  53271
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96644956, 'precision': 0.96746314, 'recall': 0.966467, 'specificity': 0.966467, 'f1': 0.9664323, 'auroc': 0.9939221, 'binary_precision': 0.98941743, 'binary_recall': 0.94303554, 'binary_specificity': 0.9898985, 'binary_f1_score': 0.96566993}
confusion matrix:
       0      1
0  20579    210
1   1186  19634
early stop counter: 2
val acc:0.9459314346313477, best validation acc: 0.9573385715484619, corresponding to test acc:                         0.9683722257614136 / 0.9715686440467834
after epoch: 8,now: 2024-07-20 16:05:52.325574,epoch time: 4:35:27.036585,used: 1 day, 3:08:38.902762,model: dset_te_0_erm_b888c1ef2_not_commited_2024md_07md_19_12_57_13_seed_0_22410068
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9560551, 'precision': 0.9567747, 'recall': 0.9560711, 'specificity': 0.9560711, 'f1': 0.95603883, 'auroc': 0.98972, 'binary_precision': 0.9751065, 'binary_recall': 0.93607754, 'binary_specificity': 0.9760646, 'binary_f1_score': 0.95519346}
confusion matrix:
        0       1
0  135346    3319
1    8878  130009
---- Validation: 
scalar performance:
{'acc': 0.9632313, 'precision': 0.9643482, 'recall': 0.96318585, 'specificity': 0.96318585, 'f1': 0.9632065, 'auroc': 0.99364674, 'binary_precision': 0.98665535, 'binary_recall': 0.9390244, 'binary_specificity': 0.9873473, 'binary_f1_score': 0.9622509}
confusion matrix:
       0      1
0  58838    754
1   3620  55748
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9702949, 'precision': 0.97031015, 'recall': 0.9702971, 'specificity': 0.9702971, 'f1': 0.97029483, 'auroc': 0.99375343, 'binary_precision': 0.97318065, 'binary_recall': 0.96729106, 'binary_specificity': 0.9733032, 'binary_f1_score': 0.970227}
confusion matrix:
       0      1
0  20234    555
1    681  20139
better model found
persisted
after epoch: 9,now: 2024-07-20 21:03:08.631753,epoch time: 4:57:16.306179,used: 1 day, 8:05:55.208941,model: dset_te_0_erm_b888c1ef2_not_commited_2024md_07md_19_12_57_13_seed_0_22410068
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9570315, 'precision': 0.9580797, 'recall': 0.95705104, 'specificity': 0.95705104, 'f1': 0.9570081, 'auroc': 0.9901394, 'binary_precision': 0.98019654, 'binary_recall': 0.93298244, 'binary_specificity': 0.9811197, 'binary_f1_score': 0.9560069}
confusion matrix:
        0       1
0  136045    2618
1    9308  129581
---- Validation: 
scalar performance:
{'acc': 0.9566493, 'precision': 0.9589131, 'recall': 0.95658386, 'specificity': 0.95658386, 'f1': 0.95659125, 'auroc': 0.99363995, 'binary_precision': 0.99067724, 'binary_recall': 0.92180973, 'binary_specificity': 0.9913579, 'binary_f1_score': 0.95500356}
confusion matrix:
       0      1
0  59077    515
1   4642  54726
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97063136, 'precision': 0.97081304, 'recall': 0.97063875, 'specificity': 0.97063875, 'f1': 0.97062886, 'auroc': 0.99396664, 'binary_precision': 0.980249, 'binary_recall': 0.96066284, 'binary_specificity': 0.9806147, 'binary_f1_score': 0.9703571}
confusion matrix:
       0      1
0  20386    403
1    819  20001
early stop counter: 1
val acc:0.9566493034362793, best validation acc: 0.9632313251495361, corresponding to test acc:                         0.9702948927879333 / 0.9715686440467834
after epoch: 10,now: 2024-07-21 02:10:36.808459,epoch time: 5:07:28.176706,used: 1 day, 13:13:23.385647,model: dset_te_0_erm_b888c1ef2_not_commited_2024md_07md_19_12_57_13_seed_0_22410068
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 10 with time: 1 day, 13:13:23.385647 at 2024-07-21 02:10:36.808459
persisted model performance metric: 

scalar performance:
{'acc': 0.9702949, 'precision': 0.97031015, 'recall': 0.9702971, 'specificity': 0.9702971, 'f1': 0.97029483, 'auroc': 0.99375343, 'binary_precision': 0.97318065, 'binary_recall': 0.96729106, 'binary_specificity': 0.9733032, 'binary_f1_score': 0.970227}
confusion matrix:
       0      1
0  20234    555
1    681  20139
oracle model performance metric: 

scalar performance:
{'acc': 0.97156864, 'precision': 0.97185624, 'recall': 0.971578, 'specificity': 0.971578, 'f1': 0.97156465, 'auroc': 0.9941143, 'binary_precision': 0.9836938, 'binary_recall': 0.95907784, 'binary_specificity': 0.9840781, 'binary_f1_score': 0.9712298}
confusion matrix:
       0      1
0  20458    331
1    852  19968
results aggregation path: zoutput/benchmarks/CAMELYONWILD_center0_resnet_erm_irm_dial_lr1e5_bs16_10epochs_reallynofreezing_2024-07-19_11-15-17/rule_results/1.csv
results aggregation path: zoutput/benchmarks/CAMELYONWILD_center0_resnet_erm_irm_dial_lr1e5_bs16_10epochs_reallynofreezing_2024-07-19_11-15-17/rule_results/1.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONWILD_center0_resnet_erm_irm_dial_lr1e5_bs16_10epochs_reallynofreezing_2024-07-19_11-15-17/confusion_matrix/1.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 499774 KiB |  10999 MiB |   1290 TiB |   1290 TiB |
|       from large pool | 403328 KiB |  10925 MiB |   1286 TiB |   1286 TiB |
|       from small pool |  96446 KiB |    131 MiB |      3 TiB |      3 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 499774 KiB |  10999 MiB |   1290 TiB |   1290 TiB |
|       from large pool | 403328 KiB |  10925 MiB |   1286 TiB |   1286 TiB |
|       from small pool |  96446 KiB |    131 MiB |      3 TiB |      3 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 478230 KiB |  10881 MiB |   1277 TiB |   1277 TiB |
|       from large pool | 387840 KiB |  10808 MiB |   1273 TiB |   1273 TiB |
|       from small pool |  90390 KiB |    125 MiB |      3 TiB |      3 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  11488 MiB |  11488 MiB |  11488 MiB |      0 B   |
|       from large pool |  11356 MiB |  11356 MiB |  11356 MiB |      0 B   |
|       from small pool |    132 MiB |    132 MiB |    132 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory | 753601 KiB |   1326 MiB | 506900 GiB | 506900 GiB |
|       from large pool | 741504 KiB |   1322 MiB | 502492 GiB | 502491 GiB |
|       from small pool |  12097 KiB |     18 MiB |   4408 GiB |   4408 GiB |
|---------------------------------------------------------------------------|
| Allocations           |   16983    |   35940    |  219371 K  |  219354 K  |
|       from large pool |      87    |     908    |   82595 K  |   82595 K  |
|       from small pool |   16896    |   35851    |  136776 K  |  136759 K  |
|---------------------------------------------------------------------------|
| Active allocs         |   16983    |   35940    |  219371 K  |  219354 K  |
|       from large pool |      87    |     908    |   82595 K  |   82595 K  |
|       from small pool |   16896    |   35851    |  136776 K  |  136759 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     407    |     407    |     407    |       0    |
|       from large pool |     341    |     341    |     341    |       0    |
|       from small pool |      66    |      66    |      66    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      75    |   17375    |  115062 K  |  115062 K  |
|       from large pool |      19    |     187    |   50470 K  |   50470 K  |
|       from small pool |      56    |   17355    |   64591 K  |   64591 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  10999 MiB |   1290 TiB |   1290 TiB |
|       from large pool |  16640 KiB |  10925 MiB |   1286 TiB |   1286 TiB |
|       from small pool |      0 KiB |    131 MiB |      3 TiB |      3 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  10999 MiB |   1290 TiB |   1290 TiB |
|       from large pool |  16640 KiB |  10925 MiB |   1286 TiB |   1286 TiB |
|       from small pool |      0 KiB |    131 MiB |      3 TiB |      3 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  10881 MiB |   1277 TiB |   1277 TiB |
|       from large pool |  16640 KiB |  10808 MiB |   1273 TiB |   1273 TiB |
|       from small pool |      0 KiB |    125 MiB |      3 TiB |      3 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1224 MiB |  11488 MiB |  11488 MiB |  10264 MiB |
|       from large pool |   1118 MiB |  11356 MiB |  11356 MiB |  10238 MiB |
|       from small pool |    106 MiB |    132 MiB |    132 MiB |     26 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  50944 KiB |   1326 MiB | 506901 GiB | 506901 GiB |
|       from large pool |  50944 KiB |   1322 MiB | 502492 GiB | 502492 GiB |
|       from small pool |      0 KiB |     36 MiB |   4408 GiB |   4408 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |   35940    |  219371 K  |  219371 K  |
|       from large pool |       2    |     908    |   82595 K  |   82595 K  |
|       from small pool |       0    |   35851    |  136776 K  |  136776 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |   35940    |  219371 K  |  219371 K  |
|       from large pool |       2    |     908    |   82595 K  |   82595 K  |
|       from small pool |       0    |   35851    |  136776 K  |  136776 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      83    |     407    |     407    |     324    |
|       from large pool |      30    |     341    |     341    |     311    |
|       from small pool |      53    |      66    |      66    |      13    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |   17375    |  115070 K  |  115070 K  |
|       from large pool |       4    |     187    |   50470 K  |   50470 K  |
|       from small pool |       0    |   17355    |   64599 K  |   64599 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Sun Jul 21 05:59:49 2024]
Finished job 0.
1 of 1 steps (100%) done
