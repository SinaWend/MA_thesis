Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Fri Jul 19 11:18:00 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYONWILD_center0_resnet_erm_irm_dial_lr1e5_bs16_10epochs_reallynofreezing_2024-07-19_11-15-17/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYONWILD_center0_resnet_erm_irm_dial_lr1e5_bs16_10epochs_reallynofreezing_2024-07-19_11-15-17/rule_results/2.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=2
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'888c1ef2'
model name: dset_te_0_erm_b888c1ef2_not_commited_2024md_07md_19_12_57_13_seed_0_22410069

 Experiment start at: 2024-07-19 12:57:13.444419
before training, model accuracy: 0.3186810612678528
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/autograd/graph.py:744: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.91716146, 'precision': 0.92294383, 'recall': 0.9172083, 'specificity': 0.9172083, 'f1': 0.9168835, 'auroc': 0.97534704, 'binary_precision': 0.9725972, 'binary_recall': 0.8586477, 'binary_specificity': 0.9757689, 'binary_f1_score': 0.9120772}
confusion matrix:
        0       1
0  135305    3360
1   19632  119255
---- Validation: 
scalar performance:
{'acc': 0.89535135, 'precision': 0.91137415, 'recall': 0.8951659, 'specificity': 0.8951659, 'f1': 0.89429015, 'auroc': 0.98226774, 'binary_precision': 0.99209195, 'binary_recall': 0.79665816, 'binary_specificity': 0.9936736, 'binary_f1_score': 0.8836987}
confusion matrix:
       0      1
0  59215    377
1  12072  47296
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9317215, 'precision': 0.9340274, 'recall': 0.93174875, 'specificity': 0.93174875, 'f1': 0.9316336, 'auroc': 0.98020077, 'binary_precision': 0.96584964, 'binary_recall': 0.8951969, 'binary_specificity': 0.9683005, 'binary_f1_score': 0.9291822}
confusion matrix:
       0      1
0  20130    659
1   2182  18638
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-19 16:58:29.377592,epoch time: 4:01:15.933173,used: 4:01:15.933173,model: dset_te_0_erm_b888c1ef2_not_commited_2024md_07md_19_12_57_13_seed_0_22410069
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.93273693, 'precision': 0.93516004, 'recall': 0.93276685, 'specificity': 0.93276685, 'f1': 0.9326463, 'auroc': 0.98071146, 'binary_precision': 0.96783257, 'binary_recall': 0.89533937, 'binary_specificity': 0.97019434, 'binary_f1_score': 0.93017566}
confusion matrix:
        0       1
0  134532    4133
1   14536  124351
---- Validation: 
scalar performance:
{'acc': 0.9334566, 'precision': 0.9396472, 'recall': 0.93334544, 'specificity': 0.93334544, 'f1': 0.93320966, 'auroc': 0.98721135, 'binary_precision': 0.991348, 'binary_recall': 0.87429255, 'binary_specificity': 0.9923983, 'binary_f1_score': 0.9291481}
confusion matrix:
       0      1
0  59139    453
1   7463  51905
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9550578, 'precision': 0.9557333, 'recall': 0.9550722, 'specificity': 0.9550722, 'f1': 0.9550421, 'auroc': 0.98887074, 'binary_precision': 0.9734659, 'binary_recall': 0.9356868, 'binary_specificity': 0.9744576, 'binary_f1_score': 0.9542026}
confusion matrix:
       0      1
0  20258    531
1   1339  19481
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-07-19 20:31:52.165687,epoch time: 3:33:22.788095,used: 7:34:38.721268,model: dset_te_0_erm_b888c1ef2_not_commited_2024md_07md_19_12_57_13_seed_0_22410069
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9346825, 'precision': 0.9370409, 'recall': 0.9347125, 'specificity': 0.9347125, 'f1': 0.9345974, 'auroc': 0.9823948, 'binary_precision': 0.96935, 'binary_recall': 0.8978609, 'binary_specificity': 0.9715642, 'binary_f1_score': 0.9322369}
confusion matrix:
        0       1
0  134720    3943
1   14186  124703
---- Validation: 
scalar performance:
{'acc': 0.92448723, 'precision': 0.93254447, 'recall': 0.9243592, 'specificity': 0.9243592, 'f1': 0.9241183, 'auroc': 0.9876025, 'binary_precision': 0.99111056, 'binary_recall': 0.85637045, 'binary_specificity': 0.99234796, 'binary_f1_score': 0.9188271}
confusion matrix:
       0      1
0  59136    456
1   8527  50841
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95806193, 'precision': 0.9586484, 'recall': 0.9580754, 'specificity': 0.9580754, 'f1': 0.9580494, 'auroc': 0.9907154, 'binary_precision': 0.97523546, 'binary_recall': 0.94005764, 'binary_specificity': 0.9760931, 'binary_f1_score': 0.9573235}
confusion matrix:
       0      1
0  20292    497
1   1248  19572
new oracle model saved
early stop counter: 1
val acc:0.9244872331619263, best validation acc: 0.9334565997123718, corresponding to test acc:                         0.9550577998161316 / 0.958061933517456
after epoch: 3,now: 2024-07-19 23:36:04.609010,epoch time: 3:04:12.443323,used: 10:38:51.164591,model: dset_te_0_erm_b888c1ef2_not_commited_2024md_07md_19_12_57_13_seed_0_22410069
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9410597, 'precision': 0.9429134, 'recall': 0.94108593, 'specificity': 0.94108593, 'f1': 0.94100034, 'auroc': 0.9839361, 'binary_precision': 0.9717698, 'binary_recall': 0.9086098, 'binary_specificity': 0.973562, 'binary_f1_score': 0.93912905}
confusion matrix:
        0       1
0  134998    3666
1   12693  126195
---- Validation: 
scalar performance:
{'acc': 0.9490417, 'precision': 0.952524, 'recall': 0.9489597, 'specificity': 0.9489597, 'f1': 0.9489368, 'auroc': 0.99056506, 'binary_precision': 0.99175274, 'binary_recall': 0.9054204, 'binary_specificity': 0.992499, 'binary_f1_score': 0.9466223}
confusion matrix:
       0      1
0  59145    447
1   5615  53753
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96765125, 'precision': 0.9679137, 'recall': 0.9676602, 'specificity': 0.9676602, 'f1': 0.9676471, 'auroc': 0.9930867, 'binary_precision': 0.9791831, 'binary_recall': 0.9556676, 'binary_specificity': 0.9796527, 'binary_f1_score': 0.9672824}
confusion matrix:
       0      1
0  20366    423
1    923  19897
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-07-20 02:24:18.152410,epoch time: 2:48:13.543400,used: 13:27:04.707991,model: dset_te_0_erm_b888c1ef2_not_commited_2024md_07md_19_12_57_13_seed_0_22410069
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9483124, 'precision': 0.9496202, 'recall': 0.9483341, 'specificity': 0.9483341, 'f1': 0.94827646, 'auroc': 0.9869384, 'binary_precision': 0.9740699, 'binary_recall': 0.9212309, 'binary_specificity': 0.9754372, 'binary_f1_score': 0.9469138}
confusion matrix:
        0       1
0  135259    3406
1   10940  127947
---- Validation: 
scalar performance:
{'acc': 0.9574227, 'precision': 0.9592771, 'recall': 0.9573635, 'specificity': 0.9573635, 'f1': 0.9573755, 'auroc': 0.99224126, 'binary_precision': 0.987994, 'binary_recall': 0.9259365, 'binary_specificity': 0.98879045, 'binary_f1_score': 0.95595914}
confusion matrix:
       0      1
0  58924    668
1   4397  54971
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96685815, 'precision': 0.96687794, 'recall': 0.96686065, 'specificity': 0.96686065, 'f1': 0.96685785, 'auroc': 0.99344015, 'binary_precision': 0.9701117, 'binary_recall': 0.9634486, 'binary_specificity': 0.9702727, 'binary_f1_score': 0.9667686}
confusion matrix:
       0      1
0  20171    618
1    761  20059
better model found
persisted
after epoch: 5,now: 2024-07-20 05:32:19.190765,epoch time: 3:08:01.038355,used: 16:35:05.746346,model: dset_te_0_erm_b888c1ef2_not_commited_2024md_07md_19_12_57_13_seed_0_22410069
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9538717, 'precision': 0.9545708, 'recall': 0.9538877, 'specificity': 0.9538877, 'f1': 0.9538551, 'auroc': 0.9885154, 'binary_precision': 0.97260016, 'binary_recall': 0.934134, 'binary_specificity': 0.97364134, 'binary_f1_score': 0.952979}
confusion matrix:
        0       1
0  135009    3655
1    9148  129740
---- Validation: 
scalar performance:
{'acc': 0.961197, 'precision': 0.9627949, 'recall': 0.9611424, 'specificity': 0.9611424, 'f1': 0.9611601, 'auroc': 0.9928837, 'binary_precision': 0.9895215, 'binary_recall': 0.9321183, 'binary_specificity': 0.9901665, 'binary_f1_score': 0.95996255}
confusion matrix:
       0      1
0  59006    586
1   4030  55338
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9688529, 'precision': 0.9690634, 'recall': 0.96886086, 'specificity': 0.96886086, 'f1': 0.9688498, 'auroc': 0.99332327, 'binary_precision': 0.97918713, 'binary_recall': 0.9581172, 'binary_specificity': 0.9796046, 'binary_f1_score': 0.9685376}
confusion matrix:
       0      1
0  20365    424
1    872  19948
new oracle model saved
better model found
persisted
after epoch: 6,now: 2024-07-20 08:31:00.354119,epoch time: 2:58:41.163354,used: 19:33:46.909700,model: dset_te_0_erm_b888c1ef2_not_commited_2024md_07md_19_12_57_13_seed_0_22410069
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9525206, 'precision': 0.9538472, 'recall': 0.9525427, 'specificity': 0.9525427, 'f1': 0.95248747, 'auroc': 0.98829377, 'binary_precision': 0.9785891, 'binary_recall': 0.92536485, 'binary_specificity': 0.9797206, 'binary_f1_score': 0.951233}
confusion matrix:
        0       1
0  135851    2812
1   10366  128523
---- Validation: 
scalar performance:
{'acc': 0.9558675, 'precision': 0.9580358, 'recall': 0.9558034, 'specificity': 0.9558034, 'f1': 0.95581067, 'auroc': 0.99241203, 'binary_precision': 0.9890829, 'binary_recall': 0.9217424, 'binary_specificity': 0.9898644, 'binary_f1_score': 0.9542261}
confusion matrix:
       0      1
0  58988    604
1   4646  54722
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9715446, 'precision': 0.97171783, 'recall': 0.9715519, 'specificity': 0.9715519, 'f1': 0.9715423, 'auroc': 0.99429345, 'binary_precision': 0.98094445, 'binary_recall': 0.96181554, 'binary_specificity': 0.9812882, 'binary_f1_score': 0.9712858}
confusion matrix:
       0      1
0  20400    389
1    795  20025
new oracle model saved
early stop counter: 1
val acc:0.9558675289154053, best validation acc: 0.961197018623352, corresponding to test acc:                         0.9688528776168823 / 0.971544623374939
after epoch: 7,now: 2024-07-20 11:30:25.406783,epoch time: 2:59:25.052664,used: 22:33:11.962364,model: dset_te_0_erm_b888c1ef2_not_commited_2024md_07md_19_12_57_13_seed_0_22410069
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9543401, 'precision': 0.9556516, 'recall': 0.9543623, 'specificity': 0.9543623, 'f1': 0.95430875, 'auroc': 0.98968244, 'binary_precision': 0.98030335, 'binary_recall': 0.9273886, 'binary_specificity': 0.98133594, 'binary_f1_score': 0.9531121}
confusion matrix:
        0       1
0  136074    2588
1   10085  128805
---- Validation: 
scalar performance:
{'acc': 0.9564055, 'precision': 0.95904064, 'recall': 0.9563348, 'specificity': 0.9563348, 'f1': 0.9563379, 'auroc': 0.99404716, 'binary_precision': 0.993353, 'binary_recall': 0.91879463, 'binary_specificity': 0.993875, 'binary_f1_score': 0.95462024}
confusion matrix:
       0      1
0  59227    365
1   4821  54547
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9680598, 'precision': 0.96875244, 'recall': 0.9680742, 'specificity': 0.9680742, 'f1': 0.9680487, 'auroc': 0.9940343, 'binary_precision': 0.9869585, 'binary_recall': 0.94870317, 'binary_specificity': 0.9874453, 'binary_f1_score': 0.9674528}
confusion matrix:
       0      1
0  20528    261
1   1068  19752
early stop counter: 2
val acc:0.956405520439148, best validation acc: 0.961197018623352, corresponding to test acc:                         0.9688528776168823 / 0.971544623374939
after epoch: 8,now: 2024-07-20 16:05:52.346464,epoch time: 4:35:26.939681,used: 1 day, 3:08:38.902045,model: dset_te_0_erm_b888c1ef2_not_commited_2024md_07md_19_12_57_13_seed_0_22410069
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9535186, 'precision': 0.954586, 'recall': 0.9535381, 'specificity': 0.9535381, 'f1': 0.95349264, 'auroc': 0.9892545, 'binary_precision': 0.9768151, 'binary_recall': 0.9291654, 'binary_specificity': 0.9779108, 'binary_f1_score': 0.9523946}
confusion matrix:
        0       1
0  135602    3063
1    9838  129049
---- Validation: 
scalar performance:
{'acc': 0.9603564, 'precision': 0.9619076, 'recall': 0.96030253, 'specificity': 0.96030253, 'f1': 0.96031976, 'auroc': 0.99331367, 'binary_precision': 0.9882084, 'binary_recall': 0.9316804, 'binary_specificity': 0.9889247, 'binary_f1_score': 0.9591123}
confusion matrix:
       0      1
0  58932    660
1   4056  55312
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97120816, 'precision': 0.9712988, 'recall': 0.97121346, 'specificity': 0.97121346, 'f1': 0.971207, 'auroc': 0.99402946, 'binary_precision': 0.97802573, 'binary_recall': 0.96412104, 'binary_specificity': 0.9783058, 'binary_f1_score': 0.9710236}
confusion matrix:
       0      1
0  20338    451
1    747  20073
early stop counter: 3
val acc:0.9603564143180847, best validation acc: 0.961197018623352, corresponding to test acc:                         0.9688528776168823 / 0.971544623374939
after epoch: 9,now: 2024-07-20 21:03:08.550269,epoch time: 4:57:16.203805,used: 1 day, 8:05:55.105850,model: dset_te_0_erm_b888c1ef2_not_commited_2024md_07md_19_12_57_13_seed_0_22410069
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9552913, 'precision': 0.9565531, 'recall': 0.9553128, 'specificity': 0.9553128, 'f1': 0.9552618, 'auroc': 0.9897592, 'binary_precision': 0.980759, 'binary_recall': 0.9288785, 'binary_specificity': 0.9817471, 'binary_f1_score': 0.9541141}
confusion matrix:
        0       1
0  136132    2531
1    9878  129011
---- Validation: 
scalar performance:
{'acc': 0.9638702, 'precision': 0.9652195, 'recall': 0.9638202, 'specificity': 0.9638202, 'f1': 0.9638411, 'auroc': 0.99423623, 'binary_precision': 0.9898072, 'binary_recall': 0.93725574, 'binary_specificity': 0.99038464, 'binary_f1_score': 0.9628149}
confusion matrix:
       0      1
0  59019    573
1   3725  55643
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.971088, 'precision': 0.97111297, 'recall': 0.9710908, 'specificity': 0.9710908, 'f1': 0.9710877, 'auroc': 0.99447274, 'binary_precision': 0.974735, 'binary_recall': 0.96729106, 'binary_specificity': 0.9748906, 'binary_f1_score': 0.97099876}
confusion matrix:
       0      1
0  20267    522
1    681  20139
better model found
persisted
after epoch: 10,now: 2024-07-21 02:10:37.053341,epoch time: 5:07:28.503072,used: 1 day, 13:13:23.608922,model: dset_te_0_erm_b888c1ef2_not_commited_2024md_07md_19_12_57_13_seed_0_22410069
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 10 with time: 1 day, 13:13:23.608922 at 2024-07-21 02:10:37.053341
persisted model performance metric: 

scalar performance:
{'acc': 0.971088, 'precision': 0.97111297, 'recall': 0.9710908, 'specificity': 0.9710908, 'f1': 0.9710877, 'auroc': 0.99447274, 'binary_precision': 0.974735, 'binary_recall': 0.96729106, 'binary_specificity': 0.9748906, 'binary_f1_score': 0.97099876}
confusion matrix:
       0      1
0  20267    522
1    681  20139
oracle model performance metric: 

scalar performance:
{'acc': 0.9715446, 'precision': 0.97171783, 'recall': 0.9715519, 'specificity': 0.9715519, 'f1': 0.9715423, 'auroc': 0.99429345, 'binary_precision': 0.98094445, 'binary_recall': 0.96181554, 'binary_specificity': 0.9812882, 'binary_f1_score': 0.9712858}
confusion matrix:
       0      1
0  20400    389
1    795  20025
results aggregation path: zoutput/benchmarks/CAMELYONWILD_center0_resnet_erm_irm_dial_lr1e5_bs16_10epochs_reallynofreezing_2024-07-19_11-15-17/rule_results/2.csv
results aggregation path: zoutput/benchmarks/CAMELYONWILD_center0_resnet_erm_irm_dial_lr1e5_bs16_10epochs_reallynofreezing_2024-07-19_11-15-17/rule_results/2.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONWILD_center0_resnet_erm_irm_dial_lr1e5_bs16_10epochs_reallynofreezing_2024-07-19_11-15-17/confusion_matrix/2.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 499774 KiB |  10999 MiB |   1290 TiB |   1290 TiB |
|       from large pool | 403328 KiB |  10925 MiB |   1286 TiB |   1286 TiB |
|       from small pool |  96446 KiB |    131 MiB |      3 TiB |      3 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 499774 KiB |  10999 MiB |   1290 TiB |   1290 TiB |
|       from large pool | 403328 KiB |  10925 MiB |   1286 TiB |   1286 TiB |
|       from small pool |  96446 KiB |    131 MiB |      3 TiB |      3 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 478230 KiB |  10881 MiB |   1277 TiB |   1277 TiB |
|       from large pool | 387840 KiB |  10808 MiB |   1273 TiB |   1273 TiB |
|       from small pool |  90390 KiB |    125 MiB |      3 TiB |      3 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  11488 MiB |  11488 MiB |  11488 MiB |      0 B   |
|       from large pool |  11356 MiB |  11356 MiB |  11356 MiB |      0 B   |
|       from small pool |    132 MiB |    132 MiB |    132 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory | 753601 KiB |   1325 MiB | 506964 GiB | 506964 GiB |
|       from large pool | 741504 KiB |   1322 MiB | 502492 GiB | 502491 GiB |
|       from small pool |  12097 KiB |     18 MiB |   4472 GiB |   4472 GiB |
|---------------------------------------------------------------------------|
| Allocations           |   16983    |   35940    |  219371 K  |  219354 K  |
|       from large pool |      87    |     908    |   82595 K  |   82595 K  |
|       from small pool |   16896    |   35851    |  136776 K  |  136759 K  |
|---------------------------------------------------------------------------|
| Active allocs         |   16983    |   35940    |  219371 K  |  219354 K  |
|       from large pool |      87    |     908    |   82595 K  |   82595 K  |
|       from small pool |   16896    |   35851    |  136776 K  |  136759 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     407    |     407    |     407    |       0    |
|       from large pool |     341    |     341    |     341    |       0    |
|       from small pool |      66    |      66    |      66    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      72    |   17375    |  115058 K  |  115058 K  |
|       from large pool |      19    |     187    |   50470 K  |   50470 K  |
|       from small pool |      53    |   17355    |   64588 K  |   64587 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  10999 MiB |   1290 TiB |   1290 TiB |
|       from large pool |  16640 KiB |  10925 MiB |   1286 TiB |   1286 TiB |
|       from small pool |      0 KiB |    131 MiB |      3 TiB |      3 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  10999 MiB |   1290 TiB |   1290 TiB |
|       from large pool |  16640 KiB |  10925 MiB |   1286 TiB |   1286 TiB |
|       from small pool |      0 KiB |    131 MiB |      3 TiB |      3 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  10881 MiB |   1277 TiB |   1277 TiB |
|       from large pool |  16640 KiB |  10808 MiB |   1273 TiB |   1273 TiB |
|       from small pool |      0 KiB |    125 MiB |      3 TiB |      3 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1224 MiB |  11488 MiB |  11488 MiB |  10264 MiB |
|       from large pool |   1118 MiB |  11356 MiB |  11356 MiB |  10238 MiB |
|       from small pool |    106 MiB |    132 MiB |    132 MiB |     26 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  50944 KiB |   1325 MiB | 506965 GiB | 506965 GiB |
|       from large pool |  50944 KiB |   1322 MiB | 502492 GiB | 502492 GiB |
|       from small pool |      0 KiB |     38 MiB |   4472 GiB |   4472 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |   35940    |  219371 K  |  219371 K  |
|       from large pool |       2    |     908    |   82595 K  |   82595 K  |
|       from small pool |       0    |   35851    |  136776 K  |  136776 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |   35940    |  219371 K  |  219371 K  |
|       from large pool |       2    |     908    |   82595 K  |   82595 K  |
|       from small pool |       0    |   35851    |  136776 K  |  136776 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      83    |     407    |     407    |     324    |
|       from large pool |      30    |     341    |     341    |     311    |
|       from small pool |      53    |      66    |      66    |      13    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |   17375    |  115066 K  |  115066 K  |
|       from large pool |       4    |     187    |   50470 K  |   50470 K  |
|       from small pool |       0    |   17355    |   64596 K  |   64596 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Sun Jul 21 06:02:54 2024]
Finished job 0.
1 of 1 steps (100%) done
