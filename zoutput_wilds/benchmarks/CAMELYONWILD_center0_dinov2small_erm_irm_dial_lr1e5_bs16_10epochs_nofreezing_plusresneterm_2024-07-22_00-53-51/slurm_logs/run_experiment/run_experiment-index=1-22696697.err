Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Mon Jul 22 10:26:21 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYONWILD_center0_dinov2small_erm_irm_dial_lr1e5_bs16_10epochs_nofreezing_plusresneterm_2024-07-22_00-53-51/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYONWILD_center0_dinov2small_erm_irm_dial_lr1e5_bs16_10epochs_nofreezing_plusresneterm_2024-07-22_00-53-51/rule_results/1.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=1
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/swiglu_ffn.py:51: UserWarning: xFormers is not available (SwiGLU)
  warnings.warn("xFormers is not available (SwiGLU)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/attention.py:33: UserWarning: xFormers is not available (Attention)
  warnings.warn("xFormers is not available (Attention)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/block.py:40: UserWarning: xFormers is not available (Block)
  warnings.warn("xFormers is not available (Block)")
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'888c1ef2'
model name: dset_te_0_erm_b888c1ef2_not_commited_2024md_07md_22_12_19_36_seed_0_22696697

 Experiment start at: 2024-07-22 12:19:36.952571
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
before training, model accuracy: 0.5626667737960815
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.96318525, 'precision': 0.96348894, 'recall': 0.9631957, 'specificity': 0.9631957, 'f1': 0.9631798, 'auroc': 0.99217474, 'binary_precision': 0.97555494, 'binary_recall': 0.95024014, 'binary_specificity': 0.97615117, 'binary_f1_score': 0.9627312}
confusion matrix:
        0       1
0  135358    3307
1    6911  131976
---- Validation: 
scalar performance:
{'acc': 0.97708476, 'precision': 0.97710776, 'recall': 0.9770789, 'specificity': 0.9770789, 'f1': 0.97708416, 'auroc': 0.99650824, 'binary_precision': 0.9799844, 'binary_recall': 0.9739759, 'binary_specificity': 0.98018193, 'binary_f1_score': 0.9769709}
confusion matrix:
       0      1
0  58411   1181
1   1545  57823
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9584225, 'precision': 0.95861745, 'recall': 0.95841485, 'specificity': 0.95841485, 'f1': 0.95841753, 'auroc': 0.99247336, 'binary_precision': 0.94934565, 'binary_recall': 0.9685879, 'binary_specificity': 0.94824183, 'binary_f1_score': 0.95887023}
confusion matrix:
       0      1
0  19713   1076
1    654  20166
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-22 16:32:09.353114,epoch time: 4:12:32.400543,used: 4:12:32.400543,model: dset_te_0_erm_b888c1ef2_not_commited_2024md_07md_22_12_19_36_seed_0_22696697
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9689896, 'precision': 0.9699855, 'recall': 0.9690083, 'specificity': 0.9690083, 'f1': 0.968974, 'auroc': 0.9949312, 'binary_precision': 0.99182314, 'binary_recall': 0.9458268, 'binary_specificity': 0.99218976, 'binary_f1_score': 0.96827906}
confusion matrix:
        0       1
0  137581    1083
1    7524  131364
---- Validation: 
scalar performance:
{'acc': 0.9811197, 'precision': 0.98151064, 'recall': 0.98109365, 'specificity': 0.98109365, 'f1': 0.98111504, 'auroc': 0.99785364, 'binary_precision': 0.9947684, 'binary_recall': 0.9672551, 'binary_specificity': 0.99493223, 'binary_f1_score': 0.9808188}
confusion matrix:
       0      1
0  59290    302
1   1944  57424
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97279435, 'precision': 0.9732347, 'recall': 0.97280586, 'specificity': 0.97280586, 'f1': 0.97278845, 'auroc': 0.99491227, 'binary_precision': 0.98785806, 'binary_recall': 0.95739675, 'binary_specificity': 0.9882149, 'binary_f1_score': 0.9723889}
confusion matrix:
       0      1
0  20544    245
1    887  19933
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-07-22 20:52:46.873812,epoch time: 4:20:37.520698,used: 8:33:09.921241,model: dset_te_0_erm_b888c1ef2_not_commited_2024md_07md_22_12_19_36_seed_0_22696697
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9695192, 'precision': 0.96988636, 'recall': 0.9695306, 'specificity': 0.9695306, 'f1': 0.9695138, 'auroc': 0.99479055, 'binary_precision': 0.98322415, 'binary_recall': 0.9553885, 'binary_specificity': 0.98367274, 'binary_f1_score': 0.96910644}
confusion matrix:
        0       1
0  136400    2264
1    6196  132692
---- Validation: 
scalar performance:
{'acc': 0.98242265, 'precision': 0.98248804, 'recall': 0.98241246, 'specificity': 0.98241246, 'f1': 0.98242176, 'auroc': 0.99780214, 'binary_precision': 0.98765475, 'binary_recall': 0.976991, 'binary_specificity': 0.9878339, 'binary_f1_score': 0.98229396}
confusion matrix:
       0      1
0  58867    725
1   1366  58002
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96407026, 'precision': 0.9643691, 'recall': 0.96407986, 'specificity': 0.96407986, 'f1': 0.96406496, 'auroc': 0.99237764, 'binary_precision': 0.9763372, 'binary_recall': 0.9512488, 'binary_specificity': 0.9769109, 'binary_f1_score': 0.9636297}
confusion matrix:
       0      1
0  20309    480
1   1015  19805
better model found
persisted
after epoch: 3,now: 2024-07-23 00:55:15.564989,epoch time: 4:02:28.691177,used: 12:35:38.612418,model: dset_te_0_erm_b888c1ef2_not_commited_2024md_07md_22_12_19_36_seed_0_22696697
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.97618103, 'precision': 0.976297, 'recall': 0.97618735, 'specificity': 0.97618735, 'f1': 0.97617984, 'auroc': 0.9964354, 'binary_precision': 0.9839317, 'binary_recall': 0.96821135, 'binary_specificity': 0.9841634, 'binary_f1_score': 0.97600824}
confusion matrix:
        0       1
0  136470    2196
1    4415  134471
---- Validation: 
scalar performance:
{'acc': 0.982305, 'precision': 0.9825753, 'recall': 0.9822835, 'specificity': 0.9822835, 'f1': 0.98230183, 'auroc': 0.9984265, 'binary_precision': 0.99353594, 'binary_recall': 0.9708597, 'binary_specificity': 0.9937072, 'binary_f1_score': 0.9820669}
confusion matrix:
       0      1
0  59217    375
1   1730  57638
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96721864, 'precision': 0.96802723, 'recall': 0.96723425, 'specificity': 0.96723425, 'f1': 0.9672053, 'auroc': 0.9938743, 'binary_precision': 0.9876679, 'binary_recall': 0.94630164, 'binary_specificity': 0.9881668, 'binary_f1_score': 0.9665424}
confusion matrix:
       0      1
0  20543    246
1   1118  19702
early stop counter: 1
val acc:0.9823049902915955, best validation acc: 0.9824226498603821, corresponding to test acc:                         0.9640702605247498 / 0.9727943539619446
after epoch: 4,now: 2024-07-23 03:49:29.900455,epoch time: 2:54:14.335466,used: 15:29:52.947884,model: dset_te_0_erm_b888c1ef2_not_commited_2024md_07md_22_12_19_36_seed_0_22696697
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9775177, 'precision': 0.9775418, 'recall': 0.977515, 'specificity': 0.977515, 'f1': 0.97751737, 'auroc': 0.9972471, 'binary_precision': 0.97434616, 'binary_recall': 0.98089844, 'binary_specificity': 0.9741315, 'binary_f1_score': 0.9776113}
confusion matrix:
        0       1
0  135076    3587
1    2653  136236
---- Validation: 
scalar performance:
{'acc': 0.9862643, 'precision': 0.98626614, 'recall': 0.98626304, 'specificity': 0.98626304, 'f1': 0.9862642, 'auroc': 0.9986023, 'binary_precision': 0.98686165, 'binary_recall': 0.9855983, 'binary_specificity': 0.98692775, 'binary_f1_score': 0.98622954}
confusion matrix:
       0      1
0  58813    779
1    855  58513
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9681079, 'precision': 0.96817315, 'recall': 0.96811235, 'specificity': 0.96811235, 'f1': 0.9681069, 'auroc': 0.9927658, 'binary_precision': 0.9738902, 'binary_recall': 0.96205574, 'binary_specificity': 0.974169, 'binary_f1_score': 0.96793675}
confusion matrix:
       0      1
0  20252    537
1    790  20030
better model found
persisted
after epoch: 5,now: 2024-07-23 06:08:02.136496,epoch time: 2:18:32.236041,used: 17:48:25.183925,model: dset_te_0_erm_b888c1ef2_not_commited_2024md_07md_22_12_19_36_seed_0_22696697
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.97632515, 'precision': 0.97651, 'recall': 0.97633326, 'specificity': 0.97633326, 'f1': 0.9763231, 'auroc': 0.99685407, 'binary_precision': 0.9860986, 'binary_recall': 0.966311, 'binary_specificity': 0.9863555, 'binary_f1_score': 0.9761045}
confusion matrix:
        0       1
0  136772    1892
1    4679  134209
---- Validation: 
scalar performance:
{'acc': 0.9875, 'precision': 0.987589, 'recall': 0.98748803, 'specificity': 0.98748803, 'f1': 0.9874991, 'auroc': 0.99891216, 'binary_precision': 0.99372196, 'binary_recall': 0.98115146, 'binary_specificity': 0.99382466, 'binary_f1_score': 0.9873967}
confusion matrix:
       0      1
0  59224    368
1   1119  58249
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9766637, 'precision': 0.9769046, 'recall': 0.9766722, 'specificity': 0.9766722, 'f1': 0.9766611, 'auroc': 0.99635535, 'binary_precision': 0.98781025, 'binary_recall': 0.9652738, 'binary_specificity': 0.9880706, 'binary_f1_score': 0.97641206}
confusion matrix:
       0      1
0  20541    248
1    723  20097
new oracle model saved
better model found
persisted
after epoch: 6,now: 2024-07-23 08:51:46.656387,epoch time: 2:43:44.519891,used: 20:32:09.703816,model: dset_te_0_erm_b888c1ef2_not_commited_2024md_07md_22_12_19_36_seed_0_22696697
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.978822, 'precision': 0.9789846, 'recall': 0.9788297, 'specificity': 0.9788297, 'f1': 0.97882044, 'auroc': 0.99712145, 'binary_precision': 0.98801714, 'binary_recall': 0.9694362, 'binary_specificity': 0.98822314, 'binary_f1_score': 0.9786385}
confusion matrix:
        0       1
0  137029    1633
1    4245  134645
---- Validation: 
scalar performance:
{'acc': 0.9865753, 'precision': 0.9866686, 'recall': 0.9865631, 'specificity': 0.9865631, 'f1': 0.9865744, 'auroc': 0.9986917, 'binary_precision': 0.99295187, 'binary_recall': 0.9800566, 'binary_specificity': 0.9930695, 'binary_f1_score': 0.9864621}
confusion matrix:
       0      1
0  59179    413
1   1184  58184
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9780096, 'precision': 0.97848177, 'recall': 0.9780214, 'specificity': 0.9780214, 'f1': 0.9780045, 'auroc': 0.9963467, 'binary_precision': 0.9937001, 'binary_recall': 0.96215177, 'binary_specificity': 0.993891, 'binary_f1_score': 0.9776715}
confusion matrix:
       0      1
0  20662    127
1    788  20032
new oracle model saved
early stop counter: 1
val acc:0.9865753054618835, best validation acc: 0.987500011920929, corresponding to test acc:                         0.9766637086868286 / 0.9780095815658569
after epoch: 7,now: 2024-07-23 13:15:42.196362,epoch time: 4:23:55.539975,used: 1 day, 0:56:05.243791,model: dset_te_0_erm_b888c1ef2_not_commited_2024md_07md_22_12_19_36_seed_0_22696697
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.97724754, 'precision': 0.97776353, 'recall': 0.97726107, 'specificity': 0.97726107, 'f1': 0.9772419, 'auroc': 0.9974119, 'binary_precision': 0.9936697, 'binary_recall': 0.96065205, 'binary_specificity': 0.99387, 'binary_f1_score': 0.976882}
confusion matrix:
        0       1
0  137813     850
1    5465  133424
---- Validation: 
scalar performance:
{'acc': 0.98468393, 'precision': 0.9849782, 'recall': 0.9846615, 'specificity': 0.9846615, 'f1': 0.984681, 'auroc': 0.99882734, 'binary_precision': 0.9964628, 'binary_recall': 0.9727631, 'binary_specificity': 0.9965599, 'binary_f1_score': 0.98447037}
confusion matrix:
       0      1
0  59387    205
1   1617  57751
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9744767, 'precision': 0.97490203, 'recall': 0.97448796, 'specificity': 0.97448796, 'f1': 0.97447133, 'auroc': 0.9948373, 'binary_precision': 0.9893016, 'binary_recall': 0.959366, 'binary_specificity': 0.9896099, 'binary_f1_score': 0.97410387}
confusion matrix:
       0      1
0  20573    216
1    846  19974
early stop counter: 2
val acc:0.9846839308738708, best validation acc: 0.987500011920929, corresponding to test acc:                         0.9766637086868286 / 0.9780095815658569
after epoch: 8,now: 2024-07-23 19:40:30.225869,epoch time: 6:24:48.029507,used: 1 day, 7:20:53.273298,model: dset_te_0_erm_b888c1ef2_not_commited_2024md_07md_22_12_19_36_seed_0_22696697
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9804433, 'precision': 0.9807132, 'recall': 0.9804529, 'specificity': 0.9804529, 'f1': 0.98044086, 'auroc': 0.9977996, 'binary_precision': 0.99230516, 'binary_recall': 0.9684276, 'binary_specificity': 0.99247825, 'binary_f1_score': 0.98022103}
confusion matrix:
        0       1
0  137622    1043
1    4385  134502
---- Validation: 
scalar performance:
{'acc': 0.98582715, 'precision': 0.9860227, 'recall': 0.9858091, 'specificity': 0.9858091, 'f1': 0.9858253, 'auroc': 0.9989086, 'binary_precision': 0.99531156, 'binary_recall': 0.9761993, 'binary_specificity': 0.99541885, 'binary_f1_score': 0.9856628}
confusion matrix:
       0      1
0  59319    273
1   1413  57955
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97214544, 'precision': 0.97318184, 'recall': 0.97216296, 'specificity': 0.97216296, 'f1': 0.9721309, 'auroc': 0.9956051, 'binary_precision': 0.9955139, 'binary_recall': 0.9486071, 'binary_specificity': 0.9957189, 'binary_f1_score': 0.9714946}
confusion matrix:
       0      1
0  20700     89
1   1070  19750
early stop counter: 3
val acc:0.9858271479606628, best validation acc: 0.987500011920929, corresponding to test acc:                         0.9766637086868286 / 0.9780095815658569
after epoch: 9,now: 2024-07-24 00:44:29.025464,epoch time: 5:03:58.799595,used: 1 day, 12:24:52.072893,model: dset_te_0_erm_b888c1ef2_not_commited_2024md_07md_22_12_19_36_seed_0_22696697
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9795786, 'precision': 0.97963744, 'recall': 0.9795744, 'specificity': 0.9795744, 'f1': 0.97957784, 'auroc': 0.99792457, 'binary_precision': 0.9745175, 'binary_recall': 0.9849444, 'binary_specificity': 0.97420436, 'binary_f1_score': 0.97970325}
confusion matrix:
        0       1
0  135090    3577
1    2091  136794
---- Validation: 
scalar performance:
{'acc': 0.9882986, 'precision': 0.9882982, 'recall': 0.9882996, 'specificity': 0.9882996, 'f1': 0.9882986, 'auroc': 0.99902505, 'binary_precision': 0.9877343, 'binary_recall': 0.98883235, 'binary_specificity': 0.9877668, 'binary_f1_score': 0.98828304}
confusion matrix:
       0      1
0  58863    729
1    663  58705
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97452474, 'precision': 0.9745333, 'recall': 0.97452646, 'specificity': 0.97452646, 'f1': 0.9745247, 'auroc': 0.99598134, 'binary_precision': 0.97674197, 'binary_recall': 0.97223824, 'binary_specificity': 0.9768147, 'binary_f1_score': 0.9744849}
confusion matrix:
       0      1
0  20307    482
1    578  20242
better model found
persisted
after epoch: 10,now: 2024-07-24 04:57:25.280549,epoch time: 4:12:56.255085,used: 1 day, 16:37:48.327978,model: dset_te_0_erm_b888c1ef2_not_commited_2024md_07md_22_12_19_36_seed_0_22696697
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 10 with time: 1 day, 16:37:48.327978 at 2024-07-24 04:57:25.280549
persisted model performance metric: 

scalar performance:
{'acc': 0.97452474, 'precision': 0.9745333, 'recall': 0.97452646, 'specificity': 0.97452646, 'f1': 0.9745247, 'auroc': 0.99598134, 'binary_precision': 0.97674197, 'binary_recall': 0.97223824, 'binary_specificity': 0.9768147, 'binary_f1_score': 0.9744849}
confusion matrix:
       0      1
0  20307    482
1    578  20242
oracle model performance metric: 

scalar performance:
{'acc': 0.9780096, 'precision': 0.97848177, 'recall': 0.9780214, 'specificity': 0.9780214, 'f1': 0.9780045, 'auroc': 0.9963467, 'binary_precision': 0.9937001, 'binary_recall': 0.96215177, 'binary_specificity': 0.993891, 'binary_f1_score': 0.9776715}
confusion matrix:
       0      1
0  20662    127
1    788  20032
results aggregation path: zoutput/benchmarks/CAMELYONWILD_center0_dinov2small_erm_irm_dial_lr1e5_bs16_10epochs_nofreezing_plusresneterm_2024-07-22_00-53-51/rule_results/1.csv
results aggregation path: zoutput/benchmarks/CAMELYONWILD_center0_dinov2small_erm_irm_dial_lr1e5_bs16_10epochs_nofreezing_plusresneterm_2024-07-22_00-53-51/rule_results/1.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONWILD_center0_dinov2small_erm_irm_dial_lr1e5_bs16_10epochs_nofreezing_plusresneterm_2024-07-22_00-53-51/confusion_matrix/1.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 463176 KiB |  13222 MiB |   1624 TiB |   1624 TiB |
|       from large pool | 414861 KiB |  13181 MiB |   1602 TiB |   1602 TiB |
|       from small pool |  48314 KiB |     65 MiB |     22 TiB |     22 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 463176 KiB |  13222 MiB |   1624 TiB |   1624 TiB |
|       from large pool | 414861 KiB |  13181 MiB |   1602 TiB |   1602 TiB |
|       from small pool |  48314 KiB |     65 MiB |     22 TiB |     22 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 449411 KiB |  13214 MiB |   1609 TiB |   1609 TiB |
|       from large pool | 407075 KiB |  13175 MiB |   1587 TiB |   1587 TiB |
|       from small pool |  42336 KiB |     59 MiB |     22 TiB |     22 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  14484 MiB |  14484 MiB |  14484 MiB |      0 B   |
|       from large pool |  14414 MiB |  14414 MiB |  14414 MiB |      0 B   |
|       from small pool |     70 MiB |     70 MiB |     70 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory | 448184 KiB |   1253 MiB |   1231 TiB |   1231 TiB |
|       from large pool | 435058 KiB |   1243 MiB |   1208 TiB |   1208 TiB |
|       from small pool |  13125 KiB |     19 MiB |     22 TiB |     22 TiB |
|---------------------------------------------------------------------------|
| Allocations           |   16742    |   35699    |  311416 K  |  311399 K  |
|       from large pool |     187    |    1413    |  149965 K  |  149965 K  |
|       from small pool |   16555    |   35510    |  161450 K  |  161434 K  |
|---------------------------------------------------------------------------|
| Active allocs         |   16742    |   35699    |  311416 K  |  311399 K  |
|       from large pool |     187    |    1413    |  149965 K  |  149965 K  |
|       from small pool |   16555    |   35510    |  161450 K  |  161434 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     636    |     636    |     636    |       0    |
|       from large pool |     601    |     601    |     601    |       0    |
|       from small pool |      35    |      35    |      35    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      65    |   17394    |  191329 K  |  191328 K  |
|       from large pool |      37    |     600    |  111014 K  |  111014 K  |
|       from small pool |      28    |   17356    |   80314 K  |   80314 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13222 MiB |   1624 TiB |   1624 TiB |
|       from large pool |  16640 KiB |  13181 MiB |   1602 TiB |   1602 TiB |
|       from small pool |      0 KiB |     65 MiB |     22 TiB |     22 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13222 MiB |   1624 TiB |   1624 TiB |
|       from large pool |  16640 KiB |  13181 MiB |   1602 TiB |   1602 TiB |
|       from small pool |      0 KiB |     65 MiB |     22 TiB |     22 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13214 MiB |   1609 TiB |   1609 TiB |
|       from large pool |  16640 KiB |  13175 MiB |   1587 TiB |   1587 TiB |
|       from small pool |      0 KiB |     59 MiB |     22 TiB |     22 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    890 MiB |  14484 MiB |  14484 MiB |  13594 MiB |
|       from large pool |    830 MiB |  14414 MiB |  14414 MiB |  13584 MiB |
|       from small pool |     60 MiB |     70 MiB |     70 MiB |     10 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1253 MiB |   1231 TiB |   1231 TiB |
|       from large pool |  24320 KiB |   1243 MiB |   1208 TiB |   1208 TiB |
|       from small pool |      0 KiB |     50 MiB |     22 TiB |     22 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |   35699    |  311416 K  |  311416 K  |
|       from large pool |       2    |    1413    |  149965 K  |  149965 K  |
|       from small pool |       0    |   35510    |  161450 K  |  161450 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |   35699    |  311416 K  |  311416 K  |
|       from large pool |       2    |    1413    |  149965 K  |  149965 K  |
|       from small pool |       0    |   35510    |  161450 K  |  161450 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      67    |     636    |     636    |     569    |
|       from large pool |      37    |     601    |     601    |     564    |
|       from small pool |      30    |      35    |      35    |       5    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |   17394    |  191336 K  |  191336 K  |
|       from large pool |       4    |     600    |  111014 K  |  111014 K  |
|       from small pool |       0    |   17356    |   80322 K  |   80322 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Wed Jul 24 08:06:06 2024]
Finished job 0.
1 of 1 steps (100%) done
