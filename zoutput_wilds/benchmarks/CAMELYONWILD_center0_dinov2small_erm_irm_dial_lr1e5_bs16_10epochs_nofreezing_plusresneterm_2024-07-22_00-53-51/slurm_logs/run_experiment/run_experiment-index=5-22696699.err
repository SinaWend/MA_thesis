Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Mon Jul 22 10:26:45 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYONWILD_center0_dinov2small_erm_irm_dial_lr1e5_bs16_10epochs_nofreezing_plusresneterm_2024-07-22_00-53-51/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYONWILD_center0_dinov2small_erm_irm_dial_lr1e5_bs16_10epochs_nofreezing_plusresneterm_2024-07-22_00-53-51/rule_results/5.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=5
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'888c1ef2'
model name: dset_te_0_erm_b888c1ef2_not_commited_2024md_07md_22_12_19_36_seed_0_22696699

 Experiment start at: 2024-07-22 12:19:36.952180
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
before training, model accuracy: 0.3185849189758301
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9654407, 'precision': 0.96591353, 'recall': 0.9654534, 'specificity': 0.9654534, 'f1': 0.96543264, 'auroc': 0.992771, 'binary_precision': 0.98095423, 'binary_recall': 0.9493682, 'binary_specificity': 0.98153853, 'binary_f1_score': 0.9649028}
confusion matrix:
        0       1
0  136107    2560
1    7032  131853
---- Validation: 
scalar performance:
{'acc': 0.97737896, 'precision': 0.97770226, 'recall': 0.97735524, 'specificity': 0.97735524, 'f1': 0.9773742, 'auroc': 0.9961345, 'binary_precision': 0.98966706, 'binary_recall': 0.96474534, 'binary_specificity': 0.9899651, 'binary_f1_score': 0.9770473}
confusion matrix:
       0      1
0  58994    598
1   2093  57275
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9657526, 'precision': 0.9668524, 'recall': 0.9657708, 'specificity': 0.9657708, 'f1': 0.9657334, 'auroc': 0.99387515, 'binary_precision': 0.9896985, 'binary_recall': 0.94135445, 'binary_specificity': 0.9901871, 'binary_f1_score': 0.9649214}
confusion matrix:
       0      1
0  20585    204
1   1221  19599
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-22 16:50:26.541351,epoch time: 4:30:49.589171,used: 4:30:49.589171,model: dset_te_0_erm_b888c1ef2_not_commited_2024md_07md_22_12_19_36_seed_0_22696699
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.97311497, 'precision': 0.9733826, 'recall': 0.97312474, 'specificity': 0.97312474, 'f1': 0.97311157, 'auroc': 0.99536836, 'binary_precision': 0.9848452, 'binary_recall': 0.96106243, 'binary_specificity': 0.9851871, 'binary_f1_score': 0.97280854}
confusion matrix:
        0       1
0  136609    2054
1    5408  133481
---- Validation: 
scalar performance:
{'acc': 0.9799933, 'precision': 0.9803376, 'recall': 0.9799688, 'specificity': 0.9799688, 'f1': 0.9799889, 'auroc': 0.997516, 'binary_precision': 0.99273705, 'binary_recall': 0.9669856, 'binary_specificity': 0.99295205, 'binary_f1_score': 0.97969216}
confusion matrix:
       0      1
0  59172    420
1   1960  57408
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9627725, 'precision': 0.96450293, 'recall': 0.9627953, 'specificity': 0.9627953, 'f1': 0.96273905, 'auroc': 0.99328315, 'binary_precision': 0.993041, 'binary_recall': 0.93213254, 'binary_specificity': 0.9934581, 'binary_f1_score': 0.96162325}
confusion matrix:
       0      1
0  20653    136
1   1413  19407
better model found
persisted
after epoch: 2,now: 2024-07-22 21:21:42.148866,epoch time: 4:31:15.607515,used: 9:02:05.196686,model: dset_te_0_erm_b888c1ef2_not_commited_2024md_07md_22_12_19_36_seed_0_22696699
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9772439, 'precision': 0.9774208, 'recall': 0.9772519, 'specificity': 0.9772519, 'f1': 0.97724205, 'auroc': 0.99655616, 'binary_precision': 0.98681724, 'binary_recall': 0.96744883, 'binary_specificity': 0.98705494, 'binary_f1_score': 0.977037}
confusion matrix:
        0       1
0  136868    1795
1    4521  134368
---- Validation: 
scalar performance:
{'acc': 0.9851379, 'precision': 0.985266, 'recall': 0.98512334, 'specificity': 0.98512334, 'f1': 0.9851365, 'auroc': 0.99813956, 'binary_precision': 0.9926951, 'binary_recall': 0.97741205, 'binary_specificity': 0.9928346, 'binary_f1_score': 0.9849943}
confusion matrix:
       0      1
0  59165    427
1   1341  58027
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97315484, 'precision': 0.9739453, 'recall': 0.97317016, 'specificity': 0.97317016, 'f1': 0.9731443, 'auroc': 0.99532115, 'binary_precision': 0.99348795, 'binary_recall': 0.9525937, 'binary_specificity': 0.9937467, 'binary_f1_score': 0.9726111}
confusion matrix:
       0      1
0  20659    130
1    987  19833
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-07-23 01:32:43.854597,epoch time: 4:11:01.705731,used: 13:13:06.902417,model: dset_te_0_erm_b888c1ef2_not_commited_2024md_07md_22_12_19_36_seed_0_22696699
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9785121, 'precision': 0.97854173, 'recall': 0.97851545, 'specificity': 0.97851545, 'f1': 0.9785119, 'auroc': 0.9971486, 'binary_precision': 0.9825106, 'binary_recall': 0.9744037, 'binary_specificity': 0.9826272, 'binary_f1_score': 0.9784404}
confusion matrix:
        0       1
0  136256    2409
1    3555  135332
---- Validation: 
scalar performance:
{'acc': 0.98553294, 'precision': 0.9855865, 'recall': 0.9855238, 'specificity': 0.9855238, 'f1': 0.9855323, 'auroc': 0.9985634, 'binary_precision': 0.99023724, 'binary_recall': 0.9806798, 'binary_specificity': 0.9903678, 'binary_f1_score': 0.98543537}
confusion matrix:
       0      1
0  59018    574
1   1147  58221
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9739239, 'precision': 0.9743179, 'recall': 0.97393477, 'specificity': 0.97393477, 'f1': 0.9739189, 'auroc': 0.9953203, 'binary_precision': 0.9881759, 'binary_recall': 0.959366, 'binary_specificity': 0.9885035, 'binary_f1_score': 0.9735579}
confusion matrix:
       0      1
0  20550    239
1    846  19974
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-07-23 04:13:59.146236,epoch time: 2:41:15.291639,used: 15:54:22.194056,model: dset_te_0_erm_b888c1ef2_not_commited_2024md_07md_22_12_19_36_seed_0_22696699
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9804577, 'precision': 0.98049915, 'recall': 0.9804616, 'specificity': 0.9804616, 'f1': 0.9804574, 'auroc': 0.9975948, 'binary_precision': 0.9851684, 'binary_recall': 0.97563505, 'binary_specificity': 0.9852882, 'binary_f1_score': 0.9803785}
confusion matrix:
        0       1
0  136624    2040
1    3384  135504
---- Validation: 
scalar performance:
{'acc': 0.9846503, 'precision': 0.9846764, 'recall': 0.9846442, 'specificity': 0.9846442, 'f1': 0.9846499, 'auroc': 0.99836516, 'binary_precision': 0.9877929, 'binary_recall': 0.98137045, 'binary_specificity': 0.98791784, 'binary_f1_score': 0.98457116}
confusion matrix:
       0      1
0  58872    720
1   1106  58262
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9680838, 'precision': 0.9691178, 'recall': 0.96810144, 'specificity': 0.96810144, 'f1': 0.96806705, 'auroc': 0.99396443, 'binary_precision': 0.9913289, 'binary_recall': 0.9444765, 'binary_specificity': 0.9917264, 'binary_f1_score': 0.9673357}
confusion matrix:
       0      1
0  20617    172
1   1156  19664
early stop counter: 1
val acc:0.9846503138542175, best validation acc: 0.9855329394340515, corresponding to test acc:                         0.973923921585083 / 0.973923921585083
after epoch: 5,now: 2024-07-23 06:19:53.364246,epoch time: 2:05:54.218010,used: 18:00:16.412066,model: dset_te_0_erm_b888c1ef2_not_commited_2024md_07md_22_12_19_36_seed_0_22696699
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.98157823, 'precision': 0.9816437, 'recall': 0.9815831, 'specificity': 0.9815831, 'f1': 0.98157775, 'auroc': 0.99788857, 'binary_precision': 0.9874649, 'binary_recall': 0.97557026, 'binary_specificity': 0.9875959, 'binary_f1_score': 0.9814816}
confusion matrix:
        0       1
0  136944    1720
1    3393  135495
---- Validation: 
scalar performance:
{'acc': 0.98755044, 'precision': 0.98755884, 'recall': 0.9875473, 'specificity': 0.9875473, 'f1': 0.9875503, 'auroc': 0.99891627, 'binary_precision': 0.9891666, 'binary_recall': 0.985851, 'binary_specificity': 0.9892435, 'binary_f1_score': 0.9875061}
confusion matrix:
       0      1
0  58951    641
1    840  58528
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97430843, 'precision': 0.9750712, 'recall': 0.9743235, 'specificity': 0.9743235, 'f1': 0.9742987, 'auroc': 0.9961238, 'binary_precision': 0.994294, 'binary_recall': 0.95413065, 'binary_specificity': 0.9945163, 'binary_f1_score': 0.9737984}
confusion matrix:
       0      1
0  20675    114
1    955  19865
new oracle model saved
better model found
persisted
after epoch: 6,now: 2024-07-23 08:51:46.734944,epoch time: 2:31:53.370698,used: 20:32:09.782764,model: dset_te_0_erm_b888c1ef2_not_commited_2024md_07md_22_12_19_36_seed_0_22696699
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.98274195, 'precision': 0.98283315, 'recall': 0.9827475, 'specificity': 0.9827475, 'f1': 0.9827413, 'auroc': 0.9982649, 'binary_precision': 0.98966587, 'binary_recall': 0.9756993, 'binary_specificity': 0.9897957, 'binary_f1_score': 0.98263294}
confusion matrix:
        0       1
0  137252    1415
1    3375  135510
---- Validation: 
scalar performance:
{'acc': 0.9871217, 'precision': 0.98720264, 'recall': 0.9871104, 'specificity': 0.9871104, 'f1': 0.98712087, 'auroc': 0.9990153, 'binary_precision': 0.9930269, 'binary_recall': 0.9810841, 'binary_specificity': 0.99313664, 'binary_f1_score': 0.98701936}
confusion matrix:
       0      1
0  59183    409
1   1123  58245
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96147466, 'precision': 0.9638277, 'recall': 0.96150136, 'specificity': 0.96150136, 'f1': 0.96142733, 'auroc': 0.9946317, 'binary_precision': 0.99705136, 'binary_recall': 0.9257445, 'binary_specificity': 0.9972582, 'binary_f1_score': 0.96007574}
confusion matrix:
       0      1
0  20732     57
1   1546  19274
early stop counter: 1
val acc:0.9871217012405396, best validation acc: 0.9875504374504089, corresponding to test acc:                         0.974308431148529 / 0.974308431148529
after epoch: 7,now: 2024-07-23 13:12:55.994903,epoch time: 4:21:09.259959,used: 1 day, 0:53:19.042723,model: dset_te_0_erm_b888c1ef2_not_commited_2024md_07md_22_12_19_36_seed_0_22696699
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.98357785, 'precision': 0.98360246, 'recall': 0.98358095, 'specificity': 0.98358095, 'f1': 0.9835777, 'auroc': 0.99835205, 'binary_precision': 0.9872609, 'binary_recall': 0.9798256, 'binary_specificity': 0.9873362, 'binary_f1_score': 0.98352915}
confusion matrix:
        0       1
0  136907    1756
1    2802  136087
---- Validation: 
scalar performance:
{'acc': 0.98757565, 'precision': 0.98760027, 'recall': 0.9875697, 'specificity': 0.9875697, 'f1': 0.9875753, 'auroc': 0.9990449, 'binary_precision': 0.99062645, 'binary_recall': 0.9844192, 'binary_specificity': 0.9907202, 'binary_f1_score': 0.98751307}
confusion matrix:
       0      1
0  59039    553
1    925  58443
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9724819, 'precision': 0.9735063, 'recall': 0.9724994, 'specificity': 0.9724994, 'f1': 0.9724678, 'auroc': 0.9951811, 'binary_precision': 0.9957168, 'binary_recall': 0.94908744, 'binary_specificity': 0.9959113, 'binary_f1_score': 0.9718432}
confusion matrix:
       0      1
0  20704     85
1   1060  19760
better model found
persisted
after epoch: 8,now: 2024-07-23 18:04:56.876630,epoch time: 4:52:00.881727,used: 1 day, 5:45:19.924450,model: dset_te_0_erm_b888c1ef2_not_commited_2024md_07md_22_12_19_36_seed_0_22696699
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.98420477, 'precision': 0.9842342, 'recall': 0.98420805, 'specificity': 0.98420805, 'f1': 0.98420453, 'auroc': 0.9984989, 'binary_precision': 0.9882178, 'binary_recall': 0.98012066, 'binary_specificity': 0.98829544, 'binary_f1_score': 0.98415256}
confusion matrix:
        0       1
0  137041    1623
1    2761  136127
---- Validation: 
scalar performance:
{'acc': 0.9874412, 'precision': 0.9874429, 'recall': 0.98744, 'specificity': 0.98744, 'f1': 0.9874411, 'auroc': 0.9990236, 'binary_precision': 0.98800933, 'binary_recall': 0.9868111, 'binary_specificity': 0.9880689, 'binary_f1_score': 0.9874099}
confusion matrix:
       0      1
0  58881    711
1    783  58585
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96286863, 'precision': 0.9645994, 'recall': 0.96289146, 'specificity': 0.96289146, 'f1': 0.9628353, 'auroc': 0.9927614, 'binary_precision': 0.9931433, 'binary_recall': 0.9322286, 'binary_specificity': 0.9935543, 'binary_f1_score': 0.9617224}
confusion matrix:
       0      1
0  20655    134
1   1411  19409
early stop counter: 1
val acc:0.9874411821365356, best validation acc: 0.9875756502151489, corresponding to test acc:                         0.972481906414032 / 0.974308431148529
after epoch: 9,now: 2024-07-24 00:07:35.546453,epoch time: 6:02:38.669823,used: 1 day, 11:47:58.594273,model: dset_te_0_erm_b888c1ef2_not_commited_2024md_07md_22_12_19_36_seed_0_22696699
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9852136, 'precision': 0.9852325, 'recall': 0.98521626, 'specificity': 0.98521626, 'f1': 0.9852135, 'auroc': 0.99858963, 'binary_precision': 0.98846817, 'binary_recall': 0.9819063, 'binary_specificity': 0.9885262, 'binary_f1_score': 0.9851763}
confusion matrix:
        0       1
0  137073    1591
1    2513  136375
---- Validation: 
scalar performance:
{'acc': 0.9892569, 'precision': 0.98926544, 'recall': 0.9892537, 'specificity': 0.9892537, 'f1': 0.98925674, 'auroc': 0.9991203, 'binary_precision': 0.9908903, 'binary_recall': 0.9875522, 'binary_specificity': 0.9909552, 'binary_f1_score': 0.9892184}
confusion matrix:
       0      1
0  59053    539
1    739  58629
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9713043, 'precision': 0.9723325, 'recall': 0.97132176, 'specificity': 0.97132176, 'f1': 0.9712894, 'auroc': 0.9948454, 'binary_precision': 0.994557, 'binary_recall': 0.9478386, 'binary_specificity': 0.9948049, 'binary_f1_score': 0.97063595}
confusion matrix:
       0      1
0  20681    108
1   1086  19734
better model found
persisted
after epoch: 10,now: 2024-07-24 04:57:25.385560,epoch time: 4:49:49.839107,used: 1 day, 16:37:48.433380,model: dset_te_0_erm_b888c1ef2_not_commited_2024md_07md_22_12_19_36_seed_0_22696699
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 10 with time: 1 day, 16:37:48.433380 at 2024-07-24 04:57:25.385560
persisted model performance metric: 

scalar performance:
{'acc': 0.9713043, 'precision': 0.9723325, 'recall': 0.97132176, 'specificity': 0.97132176, 'f1': 0.9712894, 'auroc': 0.9948454, 'binary_precision': 0.994557, 'binary_recall': 0.9478386, 'binary_specificity': 0.9948049, 'binary_f1_score': 0.97063595}
confusion matrix:
       0      1
0  20681    108
1   1086  19734
oracle model performance metric: 

scalar performance:
{'acc': 0.97430843, 'precision': 0.9750712, 'recall': 0.9743235, 'specificity': 0.9743235, 'f1': 0.9742987, 'auroc': 0.9961238, 'binary_precision': 0.994294, 'binary_recall': 0.95413065, 'binary_specificity': 0.9945163, 'binary_f1_score': 0.9737984}
confusion matrix:
       0      1
0  20675    114
1    955  19865
results aggregation path: zoutput/benchmarks/CAMELYONWILD_center0_dinov2small_erm_irm_dial_lr1e5_bs16_10epochs_nofreezing_plusresneterm_2024-07-22_00-53-51/rule_results/5.csv
results aggregation path: zoutput/benchmarks/CAMELYONWILD_center0_dinov2small_erm_irm_dial_lr1e5_bs16_10epochs_nofreezing_plusresneterm_2024-07-22_00-53-51/rule_results/5.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONWILD_center0_dinov2small_erm_irm_dial_lr1e5_bs16_10epochs_nofreezing_plusresneterm_2024-07-22_00-53-51/confusion_matrix/5.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 494846 KiB |   1839 MiB |   3014 TiB |   3014 TiB |
|       from large pool | 398400 KiB |   1766 MiB |   3007 TiB |   3007 TiB |
|       from small pool |  96446 KiB |    131 MiB |      6 TiB |      6 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 494846 KiB |   1839 MiB |   3014 TiB |   3014 TiB |
|       from large pool | 398400 KiB |   1766 MiB |   3007 TiB |   3007 TiB |
|       from small pool |  96446 KiB |    131 MiB |      6 TiB |      6 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 478230 KiB |   1821 MiB |   2998 TiB |   2998 TiB |
|       from large pool | 387840 KiB |   1750 MiB |   2991 TiB |   2991 TiB |
|       from small pool |  90390 KiB |    125 MiB |      6 TiB |      6 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2114 MiB |   2114 MiB |   2114 MiB |      0 B   |
|       from large pool |   1982 MiB |   1982 MiB |   1982 MiB |      0 B   |
|       from small pool |    132 MiB |    132 MiB |    132 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |    850 MiB |    880 MiB |   1430 TiB |   1430 TiB |
|       from large pool |    842 MiB |    875 MiB |   1422 TiB |   1422 TiB |
|       from small pool |      7 MiB |     16 MiB |      7 TiB |      7 TiB |
|---------------------------------------------------------------------------|
| Allocations           |   16983    |   35920    |  275425 K  |  275408 K  |
|       from large pool |      87    |     178    |  118651 K  |  118651 K  |
|       from small pool |   16896    |   35832    |  156773 K  |  156756 K  |
|---------------------------------------------------------------------------|
| Active allocs         |   16983    |   35920    |  275425 K  |  275408 K  |
|       from large pool |      87    |     178    |  118651 K  |  118651 K  |
|       from small pool |   16896    |   35832    |  156773 K  |  156756 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      99    |      99    |      99    |       0    |
|       from large pool |      33    |      33    |      33    |       0    |
|       from small pool |      66    |      66    |      66    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      49    |   17373    |  110639 K  |  110639 K  |
|       from large pool |      18    |      22    |   41187 K  |   41187 K  |
|       from small pool |      31    |   17355    |   69451 K  |   69451 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   1839 MiB |   3014 TiB |   3014 TiB |
|       from large pool |  16640 KiB |   1766 MiB |   3007 TiB |   3007 TiB |
|       from small pool |      0 KiB |    131 MiB |      6 TiB |      6 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   1839 MiB |   3014 TiB |   3014 TiB |
|       from large pool |  16640 KiB |   1766 MiB |   3007 TiB |   3007 TiB |
|       from small pool |      0 KiB |    131 MiB |      6 TiB |      6 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   1821 MiB |   2998 TiB |   2998 TiB |
|       from large pool |  16640 KiB |   1750 MiB |   2991 TiB |   2991 TiB |
|       from small pool |      0 KiB |    125 MiB |      6 TiB |      6 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1334 MiB |   2114 MiB |   2114 MiB |    780 MiB |
|       from large pool |   1232 MiB |   1982 MiB |   1982 MiB |    750 MiB |
|       from small pool |    102 MiB |    132 MiB |    132 MiB |     30 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 134912 KiB |    957 MiB |   1430 TiB |   1430 TiB |
|       from large pool | 134912 KiB |    938 MiB |   1422 TiB |   1422 TiB |
|       from small pool |      0 KiB |     32 MiB |      7 TiB |      7 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |   35920    |  275425 K  |  275425 K  |
|       from large pool |       2    |     178    |  118651 K  |  118651 K  |
|       from small pool |       0    |   35832    |  156773 K  |  156773 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |   35920    |  275425 K  |  275425 K  |
|       from large pool |       2    |     178    |  118651 K  |  118651 K  |
|       from small pool |       0    |   35832    |  156773 K  |  156773 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      74    |      99    |      99    |      25    |
|       from large pool |      23    |      33    |      33    |      10    |
|       from small pool |      51    |      66    |      66    |      15    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |   17373    |  110647 K  |  110647 K  |
|       from large pool |       4    |      25    |   41187 K  |   41187 K  |
|       from small pool |       0    |   17355    |   69459 K  |   69459 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Wed Jul 24 07:50:43 2024]
Finished job 0.
1 of 1 steps (100%) done
