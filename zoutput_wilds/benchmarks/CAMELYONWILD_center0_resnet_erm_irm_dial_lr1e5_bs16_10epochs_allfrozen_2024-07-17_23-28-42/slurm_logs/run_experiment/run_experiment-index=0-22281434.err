Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Thu Jul 18 11:15:51 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYONWILD_center0_dinov2small_erm_irm_dial_lr1e5_bs16_10epochs_nofreezing_2024-07-17_23-28-42/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYONWILD_center0_dinov2small_erm_irm_dial_lr1e5_bs16_10epochs_nofreezing_2024-07-17_23-28-42/rule_results/0.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=0
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'888c1ef2'
model name: dset_te_0_erm_b888c1ef2_not_commited_2024md_07md_18_13_09_11_seed_0_22281434

 Experiment start at: 2024-07-18 13:09:11.289460
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
before training, model accuracy: 0.3185849189758301
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.8585995, 'precision': 0.85932183, 'recall': 0.85861707, 'specificity': 0.85861707, 'f1': 0.8585324, 'auroc': 0.9258857, 'binary_precision': 0.8756305, 'binary_recall': 0.8361882, 'binary_specificity': 0.88104594, 'binary_f1_score': 0.8554549}
confusion matrix:
        0       1
0  122172   16495
1   22751  116134
---- Validation: 
scalar performance:
{'acc': 0.86951077, 'precision': 0.87623584, 'recall': 0.869385, 'specificity': 0.869385, 'f1': 0.8688971, 'auroc': 0.9386675, 'binary_precision': 0.9260684, 'binary_recall': 0.8026041, 'binary_specificity': 0.9361659, 'binary_f1_score': 0.85992724}
confusion matrix:
       0      1
0  55788   3804
1  11719  47649
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8177077, 'precision': 0.82430553, 'recall': 0.8177608, 'specificity': 0.8177608, 'f1': 0.8167931, 'auroc': 0.91198635, 'binary_precision': 0.87074906, 'binary_recall': 0.74649376, 'binary_specificity': 0.88902783, 'binary_f1_score': 0.803848}
confusion matrix:
       0      1
0  18482   2307
1   5278  15542
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-18 17:41:29.315311,epoch time: 4:32:18.025851,used: 4:32:18.025851,model: dset_te_0_erm_b888c1ef2_not_commited_2024md_07md_18_13_09_11_seed_0_22281434
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.8721573, 'precision': 0.8728187, 'recall': 0.87217444, 'specificity': 0.87217444, 'f1': 0.87210417, 'auroc': 0.93683696, 'binary_precision': 0.88872683, 'binary_recall': 0.8510825, 'binary_specificity': 0.8932664, 'binary_f1_score': 0.8694974}
confusion matrix:
        0       1
0  123863   14800
1   20683  118206
---- Validation: 
scalar performance:
{'acc': 0.8841291, 'precision': 0.89113426, 'recall': 0.88400334, 'specificity': 0.88400334, 'f1': 0.8835834, 'auroc': 0.95125616, 'binary_precision': 0.9430104, 'binary_recall': 0.81720793, 'binary_specificity': 0.95079875, 'binary_f1_score': 0.8756136}
confusion matrix:
       0      1
0  56660   2932
1  10852  48516
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8406354, 'precision': 0.8461874, 'recall': 0.8406826, 'specificity': 0.8406826, 'f1': 0.84000695, 'auroc': 0.9260851, 'binary_precision': 0.89021504, 'binary_recall': 0.77737755, 'binary_specificity': 0.9039877, 'binary_f1_score': 0.82997876}
confusion matrix:
       0      1
0  18793   1996
1   4635  16185
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-07-18 21:53:47.995687,epoch time: 4:12:18.680376,used: 8:44:36.706227,model: dset_te_0_erm_b888c1ef2_not_commited_2024md_07md_18_13_09_11_seed_0_22281434
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.8787254, 'precision': 0.87898684, 'recall': 0.87873614, 'specificity': 0.87873614, 'f1': 0.8787066, 'auroc': 0.9413879, 'binary_precision': 0.8891461, 'binary_recall': 0.8655617, 'binary_specificity': 0.8919106, 'binary_f1_score': 0.8771954}
confusion matrix:
        0       1
0  123675   14988
1   18672  120217
---- Validation: 
scalar performance:
{'acc': 0.8918376, 'precision': 0.8968006, 'recall': 0.8917326, 'specificity': 0.8917326, 'f1': 0.8914793, 'auroc': 0.9547196, 'binary_precision': 0.9407093, 'binary_recall': 0.8359554, 'binary_specificity': 0.9475097, 'binary_f1_score': 0.88524413}
confusion matrix:
       0      1
0  56464   3128
1   9739  49629
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.856209, 'precision': 0.8591488, 'recall': 0.85624266, 'specificity': 0.85624266, 'f1': 0.8559223, 'auroc': 0.9340346, 'binary_precision': 0.8918291, 'binary_recall': 0.81099904, 'binary_specificity': 0.90148634, 'binary_f1_score': 0.8494956}
confusion matrix:
       0      1
0  18741   2048
1   3935  16885
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-07-19 01:47:42.305687,epoch time: 3:53:54.310000,used: 12:38:31.016227,model: dset_te_0_erm_b888c1ef2_not_commited_2024md_07md_18_13_09_11_seed_0_22281434
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.883892, 'precision': 0.8840387, 'recall': 0.8838999, 'specificity': 0.8838999, 'f1': 0.8838824, 'auroc': 0.94525874, 'binary_precision': 0.8917472, 'binary_recall': 0.8740775, 'binary_specificity': 0.8937223, 'binary_f1_score': 0.88282394}
confusion matrix:
        0       1
0  123928   14737
1   17489  121398
---- Validation: 
scalar performance:
{'acc': 0.89766306, 'precision': 0.9034544, 'recall': 0.8975506, 'specificity': 0.8975506, 'f1': 0.89727545, 'auroc': 0.95851254, 'binary_precision': 0.95132357, 'binary_recall': 0.83780825, 'binary_specificity': 0.9572929, 'binary_f1_score': 0.8909648}
confusion matrix:
       0      1
0  57047   2545
1   9629  49739
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8626499, 'precision': 0.8661015, 'recall': 0.86268604, 'specificity': 0.86268604, 'f1': 0.8623338, 'auroc': 0.938831, 'binary_precision': 0.9018356, 'binary_recall': 0.814121, 'binary_specificity': 0.9112511, 'binary_f1_score': 0.85573643}
confusion matrix:
       0      1
0  18944   1845
1   3870  16950
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-07-19 05:48:28.308694,epoch time: 4:00:46.003007,used: 16:39:17.019234,model: dset_te_0_erm_b888c1ef2_not_commited_2024md_07md_18_13_09_11_seed_0_22281434
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.88412625, 'precision': 0.8848169, 'recall': 0.88414335, 'specificity': 0.88414335, 'f1': 0.8840774, 'auroc': 0.9460825, 'binary_precision': 0.90132284, 'binary_recall': 0.8629111, 'binary_specificity': 0.9053756, 'binary_f1_score': 0.88169885}
confusion matrix:
        0       1
0  125543   13121
1   19040  119848
---- Validation: 
scalar performance:
{'acc': 0.89453596, 'precision': 0.90155154, 'recall': 0.8944118, 'specificity': 0.8944118, 'f1': 0.8940515, 'auroc': 0.95964205, 'binary_precision': 0.95415926, 'binary_recall': 0.8284766, 'binary_specificity': 0.960347, 'binary_f1_score': 0.8868873}
confusion matrix:
       0      1
0  57229   2363
1  10183  49185
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8581076, 'precision': 0.86262155, 'recall': 0.8581492, 'specificity': 0.8581492, 'f1': 0.8576746, 'auroc': 0.9374714, 'binary_precision': 0.90326595, 'binary_recall': 0.8023535, 'binary_specificity': 0.9139449, 'binary_f1_score': 0.8498245}
confusion matrix:
       0      1
0  19000   1789
1   4115  16705
early stop counter: 1
val acc:0.8945359587669373, best validation acc: 0.8976630568504333, corresponding to test acc:                         0.8626499176025391 / 0.8626499176025391
after epoch: 5,now: 2024-07-19 09:38:30.579088,epoch time: 3:50:02.270394,used: 20:29:19.289628,model: dset_te_0_erm_b888c1ef2_not_commited_2024md_07md_18_13_09_11_seed_0_22281434
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.8880822, 'precision': 0.88945484, 'recall': 0.8881062, 'specificity': 0.8881062, 'f1': 0.887988, 'auroc': 0.9487431, 'binary_precision': 0.91277784, 'binary_recall': 0.8583679, 'binary_specificity': 0.9178446, 'binary_f1_score': 0.88473713}
confusion matrix:
        0       1
0  127272   11392
1   19671  119217
---- Validation: 
scalar performance:
{'acc': 0.8969738, 'precision': 0.90664077, 'recall': 0.8968289, 'specificity': 0.8968289, 'f1': 0.8963331, 'auroc': 0.9642824, 'binary_precision': 0.96886945, 'binary_recall': 0.81990296, 'binary_specificity': 0.9737549, 'binary_f1_score': 0.88818336}
confusion matrix:
       0      1
0  58028   1564
1  10692  48676
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8724795, 'precision': 0.87972957, 'recall': 0.872531, 'specificity': 0.872531, 'f1': 0.87187886, 'auroc': 0.9479688, 'binary_precision': 0.93238574, 'binary_recall': 0.8034102, 'binary_specificity': 0.9416518, 'binary_f1_score': 0.86310625}
confusion matrix:
       0      1
0  19576   1213
1   4093  16727
new oracle model saved
early stop counter: 2
val acc:0.8969737887382507, best validation acc: 0.8976630568504333, corresponding to test acc:                         0.8626499176025391 / 0.8724794983863831
after epoch: 6,now: 2024-07-19 13:55:16.197868,epoch time: 4:16:45.618780,used: 1 day, 0:46:04.908408,model: dset_te_0_erm_b888c1ef2_not_commited_2024md_07md_18_13_09_11_seed_0_22281434
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.8888497, 'precision': 0.88982415, 'recall': 0.8888693, 'specificity': 0.8888693, 'f1': 0.8887837, 'auroc': 0.9497342, 'binary_precision': 0.909512, 'binary_recall': 0.86381537, 'binary_specificity': 0.91392326, 'binary_f1_score': 0.8860749}
confusion matrix:
        0       1
0  126731   11936
1   18914  119971
---- Validation: 
scalar performance:
{'acc': 0.897537, 'precision': 0.9051579, 'recall': 0.8974082, 'specificity': 0.8974082, 'f1': 0.89703107, 'auroc': 0.9626148, 'binary_precision': 0.960256, 'binary_recall': 0.8289988, 'binary_specificity': 0.9658176, 'binary_f1_score': 0.889813}
confusion matrix:
       0      1
0  57555   2037
1  10152  49216
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8657983, 'precision': 0.8713906, 'recall': 0.865844, 'specificity': 0.865844, 'f1': 0.86530143, 'auroc': 0.94197726, 'binary_precision': 0.9171504, 'binary_recall': 0.80446684, 'binary_specificity': 0.9272211, 'binary_f1_score': 0.8571209}
confusion matrix:
       0      1
0  19276   1513
1   4071  16749
early stop counter: 3
val acc:0.8975369930267334, best validation acc: 0.8976630568504333, corresponding to test acc:                         0.8626499176025391 / 0.8724794983863831
after epoch: 7,now: 2024-07-19 18:26:17.319854,epoch time: 4:31:01.121986,used: 1 day, 5:17:06.030394,model: dset_te_0_erm_b888c1ef2_not_commited_2024md_07md_18_13_09_11_seed_0_22281434
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.89059347, 'precision': 0.8913106, 'recall': 0.89061093, 'specificity': 0.89061093, 'f1': 0.8905464, 'auroc': 0.9510581, 'binary_precision': 0.90826666, 'binary_recall': 0.8691473, 'binary_specificity': 0.9120746, 'binary_f1_score': 0.88827646}
confusion matrix:
        0       1
0  126471   12192
1   18174  120715
---- Validation: 
scalar performance:
{'acc': 0.9039257, 'precision': 0.9105698, 'recall': 0.90380627, 'specificity': 0.90380627, 'f1': 0.90351653, 'auroc': 0.96494985, 'binary_precision': 0.96233004, 'binary_recall': 0.8403854, 'binary_specificity': 0.96722716, 'binary_f1_score': 0.89723325}
confusion matrix:
       0      1
0  57639   1953
1   9476  49892
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.87750244, 'precision': 0.8813646, 'recall': 0.87754, 'specificity': 0.87754, 'f1': 0.8771992, 'auroc': 0.9487264, 'binary_precision': 0.9199295, 'binary_recall': 0.8271854, 'binary_specificity': 0.92789453, 'binary_f1_score': 0.87109584}
confusion matrix:
       0      1
0  19290   1499
1   3598  17222
new oracle model saved
better model found
persisted
after epoch: 8,now: 2024-07-19 22:06:47.352407,epoch time: 3:40:30.032553,used: 1 day, 8:57:36.062947,model: dset_te_0_erm_b888c1ef2_not_commited_2024md_07md_18_13_09_11_seed_0_22281434
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.89057904, 'precision': 0.8907031, 'recall': 0.89058626, 'specificity': 0.89058626, 'f1': 0.8905716, 'auroc': 0.95172524, 'binary_precision': 0.8978691, 'binary_recall': 0.88161683, 'binary_specificity': 0.89955574, 'binary_f1_score': 0.88966876}
confusion matrix:
        0       1
0  124736   13928
1   16442  122446
---- Validation: 
scalar performance:
{'acc': 0.90862477, 'precision': 0.9117495, 'recall': 0.9085431, 'specificity': 0.9085431, 'f1': 0.9084387, 'auroc': 0.9652891, 'binary_precision': 0.947151, 'binary_recall': 0.8651799, 'binary_specificity': 0.9519063, 'binary_f1_score': 0.90431166}
confusion matrix:
       0      1
0  56726   2866
1   8004  51364
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8816602, 'precision': 0.8823831, 'recall': 0.88167644, 'specificity': 0.88167644, 'f1': 0.8816074, 'auroc': 0.94784427, 'binary_precision': 0.8991964, 'binary_recall': 0.85989434, 'binary_specificity': 0.90345854, 'binary_f1_score': 0.87910634}
confusion matrix:
       0      1
0  18782   2007
1   2917  17903
new oracle model saved
better model found
persisted
after epoch: 9,now: 2024-07-20 01:52:48.832919,epoch time: 3:46:01.480512,used: 1 day, 12:43:37.543459,model: dset_te_0_erm_b888c1ef2_not_commited_2024md_07md_18_13_09_11_seed_0_22281434
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.8901431, 'precision': 0.8901534, 'recall': 0.89014107, 'specificity': 0.89014107, 'f1': 0.8901419, 'auroc': 0.95226645, 'binary_precision': 0.88833874, 'binary_recall': 0.8926689, 'binary_specificity': 0.88761324, 'binary_f1_score': 0.8904985}
confusion matrix:
        0       1
0  123080   15584
1   14907  123981
---- Validation: 
scalar performance:
{'acc': 0.91147447, 'precision': 0.9136208, 'recall': 0.911407, 'specificity': 0.911407, 'f1': 0.91134953, 'auroc': 0.9669572, 'binary_precision': 0.9429499, 'binary_recall': 0.87558955, 'binary_specificity': 0.94722444, 'binary_f1_score': 0.90802217}
confusion matrix:
       0      1
0  56447   3145
1   7386  51982
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8845202, 'precision': 0.8851413, 'recall': 0.8845352, 'specificity': 0.8845352, 'f1': 0.8844764, 'auroc': 0.9496211, 'binary_precision': 0.9007958, 'binary_recall': 0.8644092, 'binary_specificity': 0.9046611, 'binary_f1_score': 0.8822275}
confusion matrix:
       0      1
0  18807   1982
1   2823  17997
new oracle model saved
better model found
persisted
after epoch: 10,now: 2024-07-20 05:32:19.615355,epoch time: 3:39:30.782436,used: 1 day, 16:23:08.325895,model: dset_te_0_erm_b888c1ef2_not_commited_2024md_07md_18_13_09_11_seed_0_22281434
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 10 with time: 1 day, 16:23:08.325895 at 2024-07-20 05:32:19.615355
persisted model performance metric: 

scalar performance:
{'acc': 0.8845202, 'precision': 0.8851413, 'recall': 0.8845352, 'specificity': 0.8845352, 'f1': 0.8844764, 'auroc': 0.9496211, 'binary_precision': 0.9007958, 'binary_recall': 0.8644092, 'binary_specificity': 0.9046611, 'binary_f1_score': 0.8822275}
confusion matrix:
       0      1
0  18807   1982
1   2823  17997
oracle model performance metric: 

scalar performance:
{'acc': 0.8845202, 'precision': 0.8851413, 'recall': 0.8845352, 'specificity': 0.8845352, 'f1': 0.8844764, 'auroc': 0.9496211, 'binary_precision': 0.9007958, 'binary_recall': 0.8644092, 'binary_specificity': 0.9046611, 'binary_f1_score': 0.8822275}
confusion matrix:
       0      1
0  18807   1982
1   2823  17997
results aggregation path: zoutput/benchmarks/CAMELYONWILD_center0_dinov2small_erm_irm_dial_lr1e5_bs16_10epochs_nofreezing_2024-07-17_23-28-42/rule_results/0.csv
results aggregation path: zoutput/benchmarks/CAMELYONWILD_center0_dinov2small_erm_irm_dial_lr1e5_bs16_10epochs_nofreezing_2024-07-17_23-28-42/rule_results/0.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONWILD_center0_dinov2small_erm_irm_dial_lr1e5_bs16_10epochs_nofreezing_2024-07-17_23-28-42/confusion_matrix/0.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 211606 KiB | 647356 KiB |   2029 TiB |   2029 TiB |
|       from large pool | 167936 KiB | 568000 KiB |   2028 TiB |   2028 TiB |
|       from small pool |  43670 KiB |  82608 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 211606 KiB | 647356 KiB |   2029 TiB |   2029 TiB |
|       from large pool | 167936 KiB | 568000 KiB |   2028 TiB |   2028 TiB |
|       from small pool |  43670 KiB |  82608 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 202745 KiB | 633953 KiB |   2024 TiB |   2024 TiB |
|       from large pool | 165120 KiB | 560704 KiB |   2024 TiB |   2024 TiB |
|       from small pool |  37625 KiB |  76494 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 763904 KiB | 763904 KiB | 763904 KiB |      0 B   |
|       from large pool | 679936 KiB | 679936 KiB | 679936 KiB |      0 B   |
|       from small pool |  83968 KiB |  83968 KiB |  83968 KiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |  77161 KiB | 213912 KiB |    800 TiB |    800 TiB |
|       from large pool |  67584 KiB | 209284 KiB |    800 TiB |    800 TiB |
|       from small pool |   9577 KiB |  11377 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Allocations           |   16506    |   35443    |  179499 K  |  179482 K  |
|       from large pool |      36    |      76    |   72856 K  |   72856 K  |
|       from small pool |   16470    |   35406    |  106643 K  |  106626 K  |
|---------------------------------------------------------------------------|
| Active allocs         |   16506    |   35443    |  179499 K  |  179482 K  |
|       from large pool |      36    |      76    |   72856 K  |   72856 K  |
|       from small pool |   16470    |   35406    |  106643 K  |  106626 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      55    |      55    |      55    |       0    |
|       from large pool |      14    |      14    |      14    |       0    |
|       from small pool |      41    |      41    |      41    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      36    |   17363    |   80152 K  |   80152 K  |
|       from large pool |       7    |      11    |   26054 K  |   26054 K  |
|       from small pool |      29    |   17356    |   54097 K  |   54097 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB | 647356 KiB |   2029 TiB |   2029 TiB |
|       from large pool |  16640 KiB | 568000 KiB |   2028 TiB |   2028 TiB |
|       from small pool |      0 KiB |  82608 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB | 647356 KiB |   2029 TiB |   2029 TiB |
|       from large pool |  16640 KiB | 568000 KiB |   2028 TiB |   2028 TiB |
|       from small pool |      0 KiB |  82608 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB | 633953 KiB |   2024 TiB |   2024 TiB |
|       from large pool |  16640 KiB | 560704 KiB |   2024 TiB |   2024 TiB |
|       from small pool |      0 KiB |  76494 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 288768 KiB | 763904 KiB | 763904 KiB | 475136 KiB |
|       from large pool | 235520 KiB | 679936 KiB | 679936 KiB | 444416 KiB |
|       from small pool |  53248 KiB |  83968 KiB |  83968 KiB |  30720 KiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  55040 KiB | 213912 KiB |    800 TiB |    800 TiB |
|       from large pool |  55040 KiB | 209284 KiB |    800 TiB |    800 TiB |
|       from small pool |      0 KiB |  17172 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |   35443    |  179499 K  |  179499 K  |
|       from large pool |       2    |      76    |   72856 K  |   72856 K  |
|       from small pool |       0    |   35406    |  106643 K  |  106643 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |   35443    |  179499 K  |  179499 K  |
|       from large pool |       2    |      76    |   72856 K  |   72856 K  |
|       from small pool |       0    |   35406    |  106643 K  |  106643 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      36    |      55    |      55    |      19    |
|       from large pool |      10    |      14    |      14    |       4    |
|       from small pool |      26    |      41    |      41    |      15    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |   17363    |   80160 K  |   80160 K  |
|       from large pool |       3    |      13    |   26054 K  |   26054 K  |
|       from small pool |       0    |   17356    |   54105 K  |   54105 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB | 647356 KiB |   2029 TiB |   2029 TiB |
|       from large pool |  16640 KiB | 568000 KiB |   2028 TiB |   2028 TiB |
|       from small pool |      0 KiB |  82608 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB | 647356 KiB |   2029 TiB |   2029 TiB |
|       from large pool |  16640 KiB | 568000 KiB |   2028 TiB |   2028 TiB |
|       from small pool |      0 KiB |  82608 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB | 633953 KiB |   2024 TiB |   2024 TiB |
|       from large pool |  16640 KiB | 560704 KiB |   2024 TiB |   2024 TiB |
|       from small pool |      0 KiB |  76494 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 288768 KiB | 763904 KiB | 763904 KiB | 475136 KiB |
|       from large pool | 235520 KiB | 679936 KiB | 679936 KiB | 444416 KiB |
|       from small pool |  53248 KiB |  83968 KiB |  83968 KiB |  30720 KiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  55040 KiB | 213912 KiB |    800 TiB |    800 TiB |
|       from large pool |  55040 KiB | 209284 KiB |    800 TiB |    800 TiB |
|       from small pool |      0 KiB |  17172 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |   35443    |  179499 K  |  179499 K  |
|       from large pool |       2    |      76    |   72856 K  |   72856 K  |
|       from small pool |       0    |   35406    |  106643 K  |  106643 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |   35443    |  179499 K  |  179499 K  |
|       from large pool |       2    |      76    |   72856 K  |   72856 K  |
|       from small pool |       0    |   35406    |  106643 K  |  106643 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      36    |      55    |      55    |      19    |
|       from large pool |      10    |      14    |      14    |       4    |
|       from small pool |      26    |      41    |      41    |      15    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |   17363    |   80160 K  |   80160 K  |
|       from large pool |       3    |      13    |   26054 K  |   26054 K  |
|       from small pool |       0    |   17356    |   54105 K  |   54105 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'888c1ef2'
model name: dset_te_0_erm_b888c1ef2_not_commited_2024md_07md_20_09_18_43_seed_1_22281434

 Experiment start at: 2024-07-20 09:18:43.648533
before training, model accuracy: 0.5293469429016113
epoch: 1
---- Training Domain: 
slurmstepd: error: *** JOB 22281434 ON gpusrv35 CANCELLED AT 2024-07-20T11:15:12 DUE TO TIME LIMIT ***
