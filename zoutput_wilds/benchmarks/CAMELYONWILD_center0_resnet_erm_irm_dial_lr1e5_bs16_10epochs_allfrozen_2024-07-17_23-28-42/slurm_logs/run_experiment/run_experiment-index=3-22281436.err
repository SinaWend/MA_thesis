Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Thu Jul 18 11:34:44 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYONWILD_center0_dinov2small_erm_irm_dial_lr1e5_bs16_10epochs_nofreezing_2024-07-17_23-28-42/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYONWILD_center0_dinov2small_erm_irm_dial_lr1e5_bs16_10epochs_nofreezing_2024-07-17_23-28-42/rule_results/3.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=3
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'888c1ef2'
model name: dset_te_0_erm_b888c1ef2_not_commited_2024md_07md_18_13_09_11_seed_0_22281436

 Experiment start at: 2024-07-18 13:09:11.288842
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
before training, model accuracy: 0.3185849189758301
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.8615791, 'precision': 0.8617297, 'recall': 0.86158735, 'specificity': 0.86158735, 'f1': 0.86156654, 'auroc': 0.92766833, 'binary_precision': 0.8693143, 'binary_recall': 0.85136944, 'binary_specificity': 0.87180525, 'binary_f1_score': 0.86024827}
confusion matrix:
        0       1
0  120888   17776
1   20643  118245
---- Validation: 
scalar performance:
{'acc': 0.8708053, 'precision': 0.874457, 'recall': 0.87071246, 'specificity': 0.87071246, 'f1': 0.87046903, 'auroc': 0.9360781, 'binary_precision': 0.91096747, 'binary_recall': 0.8214021, 'binary_specificity': 0.92002285, 'binary_f1_score': 0.8638695}
confusion matrix:
       0      1
0  54826   4766
1  10603  48765
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8164099, 'precision': 0.82040656, 'recall': 0.8164515, 'specificity': 0.8164515, 'f1': 0.81584924, 'auroc': 0.90530413, 'binary_precision': 0.8563781, 'binary_recall': 0.76066285, 'binary_specificity': 0.8722401, 'binary_f1_score': 0.8056877}
confusion matrix:
       0      1
0  18133   2656
1   4983  15837
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-18 17:41:29.315299,epoch time: 4:32:18.026457,used: 4:32:18.026457,model: dset_te_0_erm_b888c1ef2_not_commited_2024md_07md_18_13_09_11_seed_0_22281436
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.8768699, 'precision': 0.8771889, 'recall': 0.8768819, 'specificity': 0.8768819, 'f1': 0.87684625, 'auroc': 0.93896174, 'binary_precision': 0.88836557, 'binary_recall': 0.8623011, 'binary_specificity': 0.8914627, 'binary_f1_score': 0.8751393}
confusion matrix:
        0       1
0  123612   15050
1   19125  119765
---- Validation: 
scalar performance:
{'acc': 0.8847848, 'precision': 0.8896967, 'recall': 0.8846793, 'specificity': 0.8846793, 'f1': 0.8844001, 'auroc': 0.9495814, 'binary_precision': 0.93297935, 'binary_recall': 0.8286619, 'binary_specificity': 0.9406967, 'binary_f1_score': 0.877732}
confusion matrix:
       0      1
0  56058   3534
1  10172  49196
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8539018, 'precision': 0.8553287, 'recall': 0.8539254, 'specificity': 0.8539254, 'f1': 0.85376084, 'auroc': 0.9301709, 'binary_precision': 0.8780325, 'binary_recall': 0.8222382, 'binary_specificity': 0.8856126, 'binary_f1_score': 0.84922}
confusion matrix:
       0      1
0  18411   2378
1   3701  17119
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-07-18 22:18:31.989215,epoch time: 4:37:02.673916,used: 9:09:20.700373,model: dset_te_0_erm_b888c1ef2_not_commited_2024md_07md_18_13_09_11_seed_0_22281436
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.873793, 'precision': 0.8800882, 'recall': 0.87384593, 'specificity': 0.87384593, 'f1': 0.87327933, 'auroc': 0.9422687, 'binary_precision': 0.9292096, 'binary_recall': 0.8094607, 'binary_specificity': 0.9382311, 'binary_f1_score': 0.8652113}
confusion matrix:
        0       1
0  130097    8565
1   26464  112426
---- Validation: 
scalar performance:
{'acc': 0.86651814, 'precision': 0.8853296, 'recall': 0.8663103, 'specificity': 0.8663103, 'f1': 0.8648217, 'auroc': 0.95334536, 'binary_precision': 0.9699989, 'binary_recall': 0.7559123, 'binary_specificity': 0.9767083, 'binary_f1_score': 0.8496777}
confusion matrix:
       0      1
0  58204   1388
1  14491  44877
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.84315896, 'precision': 0.85740304, 'recall': 0.8432333, 'specificity': 0.8432333, 'f1': 0.84160066, 'auroc': 0.9393544, 'binary_precision': 0.9289401, 'binary_recall': 0.74341977, 'binary_specificity': 0.9430468, 'binary_f1_score': 0.82588977}
confusion matrix:
       0      1
0  19605   1184
1   5342  15478
early stop counter: 1
val acc:0.8665181398391724, best validation acc: 0.8847848176956177, corresponding to test acc:                         0.8539018034934998 / 0.8539018034934998
after epoch: 3,now: 2024-07-19 03:00:44.206932,epoch time: 4:42:12.217717,used: 13:51:32.918090,model: dset_te_0_erm_b888c1ef2_not_commited_2024md_07md_18_13_09_11_seed_0_22281436
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.8806674, 'precision': 0.88162506, 'recall': 0.88068765, 'specificity': 0.88068765, 'f1': 0.8805964, 'auroc': 0.94400585, 'binary_precision': 0.9009454, 'binary_recall': 0.8555959, 'binary_specificity': 0.9057794, 'binary_f1_score': 0.87768525}
confusion matrix:
        0       1
0  125599   13065
1   20056  118832
---- Validation: 
scalar performance:
{'acc': 0.8960827, 'precision': 0.8997532, 'recall': 0.89599276, 'specificity': 0.89599276, 'f1': 0.895828, 'auroc': 0.9578769, 'binary_precision': 0.9375908, 'binary_recall': 0.8482347, 'binary_specificity': 0.94375086, 'binary_f1_score': 0.8906772}
confusion matrix:
       0      1
0  56240   3352
1   9010  50358
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.86543775, 'precision': 0.8662372, 'recall': 0.86545515, 'specificity': 0.86545515, 'f1': 0.8653681, 'auroc': 0.938239, 'binary_precision': 0.88353574, 'binary_recall': 0.84207493, 'binary_specificity': 0.88883543, 'binary_f1_score': 0.8623072}
confusion matrix:
       0      1
0  18478   2311
1   3288  17532
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-07-19 07:57:48.216483,epoch time: 4:57:04.009551,used: 18:48:36.927641,model: dset_te_0_erm_b888c1ef2_not_commited_2024md_07md_18_13_09_11_seed_0_22281436
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.8836939, 'precision': 0.8845957, 'recall': 0.8837131, 'specificity': 0.8837131, 'f1': 0.88362926, 'auroc': 0.94520223, 'binary_precision': 0.90341866, 'binary_recall': 0.8594531, 'binary_specificity': 0.9079731, 'binary_f1_score': 0.88088757}
confusion matrix:
        0       1
0  125905   12761
1   19520  119366
---- Validation: 
scalar performance:
{'acc': 0.89534295, 'precision': 0.9021923, 'recall': 0.8952204, 'specificity': 0.8952204, 'f1': 0.8948742, 'auroc': 0.9586425, 'binary_precision': 0.95420927, 'binary_recall': 0.83012736, 'binary_specificity': 0.96031344, 'binary_f1_score': 0.88785404}
confusion matrix:
       0      1
0  57227   2365
1  10085  49283
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8703405, 'precision': 0.873528, 'recall': 0.870375, 'specificity': 0.870375, 'f1': 0.87007076, 'auroc': 0.9434545, 'binary_precision': 0.90822, 'binary_recall': 0.82415944, 'binary_specificity': 0.9165905, 'binary_f1_score': 0.8641503}
confusion matrix:
       0      1
0  19055   1734
1   3661  17159
new oracle model saved
early stop counter: 1
val acc:0.8953429460525513, best validation acc: 0.8960826992988586, corresponding to test acc:                         0.8654377460479736 / 0.8703405261039734
after epoch: 5,now: 2024-07-19 12:48:51.207388,epoch time: 4:51:02.990905,used: 23:39:39.918546,model: dset_te_0_erm_b888c1ef2_not_commited_2024md_07md_18_13_09_11_seed_0_22281436
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.8858736, 'precision': 0.8866124, 'recall': 0.8858912, 'specificity': 0.8858912, 'f1': 0.8858223, 'auroc': 0.94697106, 'binary_precision': 0.90371364, 'binary_recall': 0.863983, 'binary_specificity': 0.90779936, 'binary_f1_score': 0.8834018}
confusion matrix:
        0       1
0  125880   12785
1   18891  119996
---- Validation: 
scalar performance:
{'acc': 0.8947125, 'precision': 0.9010565, 'recall': 0.8945944, 'specificity': 0.8945944, 'f1': 0.8942739, 'auroc': 0.9606081, 'binary_precision': 0.9510293, 'binary_recall': 0.8318623, 'binary_specificity': 0.9573265, 'binary_f1_score': 0.88746333}
confusion matrix:
       0      1
0  57049   2543
1   9982  49386
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8697878, 'precision': 0.87277013, 'recall': 0.86982113, 'specificity': 0.86982113, 'f1': 0.869534, 'auroc': 0.9437922, 'binary_precision': 0.9062995, 'binary_recall': 0.82507205, 'binary_specificity': 0.9145702, 'binary_f1_score': 0.8637804}
confusion matrix:
       0      1
0  19013   1776
1   3642  17178
early stop counter: 2
val acc:0.894712507724762, best validation acc: 0.8960826992988586, corresponding to test acc:                         0.8654377460479736 / 0.8703405261039734
after epoch: 6,now: 2024-07-19 17:44:57.338968,epoch time: 4:56:06.131580,used: 1 day, 4:35:46.050126,model: dset_te_0_erm_b888c1ef2_not_commited_2024md_07md_18_13_09_11_seed_0_22281436
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.87775266, 'precision': 0.8786063, 'recall': 0.8777717, 'specificity': 0.8777717, 'f1': 0.87768745, 'auroc': 0.9420601, 'binary_precision': 0.89678586, 'binary_recall': 0.85398924, 'binary_specificity': 0.9015541, 'binary_f1_score': 0.87486446}
confusion matrix:
        0       1
0  125014   13651
1   20279  118608
---- Validation: 
scalar performance:
{'acc': 0.88285977, 'precision': 0.8887682, 'recall': 0.88274395, 'specificity': 0.88274395, 'f1': 0.8823902, 'auroc': 0.95158225, 'binary_precision': 0.9362266, 'binary_recall': 0.8212168, 'binary_specificity': 0.944271, 'binary_f1_score': 0.8749585}
confusion matrix:
       0      1
0  56271   3321
1  10614  48754
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8467639, 'precision': 0.8503387, 'recall': 0.8468015, 'specificity': 0.8468015, 'f1': 0.84638184, 'auroc': 0.9262755, 'binary_precision': 0.88591427, 'binary_recall': 0.7963016, 'binary_specificity': 0.89730144, 'binary_f1_score': 0.83872104}
confusion matrix:
       0      1
0  18654   2135
1   4241  16579
early stop counter: 3
val acc:0.8828597664833069, best validation acc: 0.8960826992988586, corresponding to test acc:                         0.8654377460479736 / 0.8703405261039734
after epoch: 7,now: 2024-07-19 22:06:52.753747,epoch time: 4:21:55.414779,used: 1 day, 8:57:41.464905,model: dset_te_0_erm_b888c1ef2_not_commited_2024md_07md_18_13_09_11_seed_0_22281436
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.8859601, 'precision': 0.886724, 'recall': 0.8859781, 'specificity': 0.8859781, 'f1': 0.88590705, 'auroc': 0.94695175, 'binary_precision': 0.90411514, 'binary_recall': 0.86370313, 'binary_specificity': 0.908253, 'binary_f1_score': 0.88344723}
confusion matrix:
        0       1
0  125942   12722
1   18930  119958
---- Validation: 
scalar performance:
{'acc': 0.89229995, 'precision': 0.9009367, 'recall': 0.892162, 'specificity': 0.892162, 'f1': 0.89169204, 'auroc': 0.95811653, 'binary_precision': 0.95931333, 'binary_recall': 0.81892604, 'binary_specificity': 0.965398, 'binary_f1_score': 0.8835781}
confusion matrix:
       0      1
0  57530   2062
1  10750  48618
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8522916, 'precision': 0.86233175, 'recall': 0.8523536, 'specificity': 0.8523536, 'f1': 0.85127676, 'auroc': 0.9390199, 'binary_precision': 0.9228331, 'binary_recall': 0.7691162, 'binary_specificity': 0.9355909, 'binary_f1_score': 0.8389919}
confusion matrix:
       0      1
0  19450   1339
1   4807  16013
early stop counter: 4
val acc:0.8922999501228333, best validation acc: 0.8960826992988586, corresponding to test acc:                         0.8654377460479736 / 0.8703405261039734
after epoch: 8,now: 2024-07-20 02:23:55.941122,epoch time: 4:17:03.187375,used: 1 day, 13:14:44.652280,model: dset_te_0_erm_b888c1ef2_not_commited_2024md_07md_18_13_09_11_seed_0_22281436
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.8754684, 'precision': 0.8757851, 'recall': 0.8754567, 'specificity': 0.8754567, 'f1': 0.87543964, 'auroc': 0.94389534, 'binary_precision': 0.8650756, 'binary_recall': 0.8899401, 'binary_specificity': 0.8609733, 'binary_f1_score': 0.87733173}
confusion matrix:
        0       1
0  119386   19278
1   15286  123602
---- Validation: 
scalar performance:
{'acc': 0.89136684, 'precision': 0.89409786, 'recall': 0.89128876, 'specificity': 0.89128876, 'f1': 0.89116406, 'auroc': 0.95468473, 'binary_precision': 0.9264374, 'binary_recall': 0.84980124, 'binary_specificity': 0.9327762, 'binary_f1_score': 0.8864661}
confusion matrix:
       0      1
0  55586   4006
1   8917  50451
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8557283, 'precision': 0.85708064, 'recall': 0.8557513, 'specificity': 0.8557513, 'f1': 0.85559714, 'auroc': 0.9310281, 'binary_precision': 0.87924236, 'binary_recall': 0.82497597, 'binary_specificity': 0.8865265, 'binary_f1_score': 0.85124516}
confusion matrix:
       0      1
0  18430   2359
1   3644  17176
early stop counter: 5
val acc:0.8913668394088745, best validation acc: 0.8960826992988586, corresponding to test acc:                         0.8654377460479736 / 0.8703405261039734
after epoch: 9,now: 2024-07-20 06:51:32.771079,epoch time: 4:27:36.829957,used: 1 day, 17:42:21.482237,model: dset_te_0_erm_b888c1ef2_not_commited_2024md_07md_18_13_09_11_seed_0_22281436
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 9 with time: 1 day, 17:42:21.482237 at 2024-07-20 06:51:32.771079
persisted model performance metric: 

scalar performance:
{'acc': 0.86543775, 'precision': 0.8662372, 'recall': 0.86545515, 'specificity': 0.86545515, 'f1': 0.8653681, 'auroc': 0.938239, 'binary_precision': 0.88353574, 'binary_recall': 0.84207493, 'binary_specificity': 0.88883543, 'binary_f1_score': 0.8623072}
confusion matrix:
       0      1
0  18478   2311
1   3288  17532
oracle model performance metric: 

scalar performance:
{'acc': 0.8703405, 'precision': 0.873528, 'recall': 0.870375, 'specificity': 0.870375, 'f1': 0.87007076, 'auroc': 0.9434545, 'binary_precision': 0.90822, 'binary_recall': 0.82415944, 'binary_specificity': 0.9165905, 'binary_f1_score': 0.8641503}
confusion matrix:
       0      1
0  19055   1734
1   3661  17159
results aggregation path: zoutput/benchmarks/CAMELYONWILD_center0_dinov2small_erm_irm_dial_lr1e5_bs16_10epochs_nofreezing_2024-07-17_23-28-42/rule_results/3.csv
results aggregation path: zoutput/benchmarks/CAMELYONWILD_center0_dinov2small_erm_irm_dial_lr1e5_bs16_10epochs_nofreezing_2024-07-17_23-28-42/rule_results/3.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONWILD_center0_dinov2small_erm_irm_dial_lr1e5_bs16_10epochs_nofreezing_2024-07-17_23-28-42/confusion_matrix/3.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 211606 KiB |   2903 MiB |   5432 TiB |   5432 TiB |
|       from large pool | 167936 KiB |   2865 MiB |   5430 TiB |   5430 TiB |
|       from small pool |  43670 KiB |     80 MiB |      1 TiB |      1 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 211606 KiB |   2903 MiB |   5432 TiB |   5432 TiB |
|       from large pool | 167936 KiB |   2865 MiB |   5430 TiB |   5430 TiB |
|       from small pool |  43670 KiB |     80 MiB |      1 TiB |      1 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 202745 KiB |   2882 MiB |   5416 TiB |   5416 TiB |
|       from large pool | 165120 KiB |   2846 MiB |   5414 TiB |   5414 TiB |
|       from small pool |  37625 KiB |     74 MiB |      1 TiB |      1 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   3118 MiB |   3118 MiB |   3118 MiB |      0 B   |
|       from large pool |   3036 MiB |   3036 MiB |   3036 MiB |      0 B   |
|       from small pool |     82 MiB |     82 MiB |     82 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory | 154985 KiB | 319982 KiB |   1979 TiB |   1979 TiB |
|       from large pool | 147456 KiB | 319103 KiB |   1978 TiB |   1978 TiB |
|       from small pool |   7529 KiB |  11377 KiB |      1 TiB |      1 TiB |
|---------------------------------------------------------------------------|
| Allocations           |   16506    |   35443    |  422190 K  |  422174 K  |
|       from large pool |      36    |     248    |  218633 K  |  218633 K  |
|       from small pool |   16470    |   35406    |  203556 K  |  203540 K  |
|---------------------------------------------------------------------------|
| Active allocs         |   16506    |   35443    |  422190 K  |  422174 K  |
|       from large pool |      36    |     248    |  218633 K  |  218633 K  |
|       from small pool |   16470    |   35406    |  203556 K  |  203540 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      92    |      92    |      92    |       0    |
|       from large pool |      51    |      51    |      51    |       0    |
|       from small pool |      41    |      41    |      41    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      36    |   17364    |  212259 K  |  212259 K  |
|       from large pool |       8    |      26    |  109592 K  |  109592 K  |
|       from small pool |      28    |   17356    |  102667 K  |  102667 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   2903 MiB |   5432 TiB |   5432 TiB |
|       from large pool |  16640 KiB |   2865 MiB |   5430 TiB |   5430 TiB |
|       from small pool |      0 KiB |     80 MiB |      1 TiB |      1 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   2903 MiB |   5432 TiB |   5432 TiB |
|       from large pool |  16640 KiB |   2865 MiB |   5430 TiB |   5430 TiB |
|       from small pool |      0 KiB |     80 MiB |      1 TiB |      1 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   2882 MiB |   5416 TiB |   5416 TiB |
|       from large pool |  16640 KiB |   2846 MiB |   5414 TiB |   5414 TiB |
|       from small pool |      0 KiB |     74 MiB |      1 TiB |      1 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 366592 KiB |   3118 MiB |   3118 MiB |   2760 MiB |
|       from large pool | 315392 KiB |   3036 MiB |   3036 MiB |   2728 MiB |
|       from small pool |  51200 KiB |     82 MiB |     82 MiB |     32 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 134912 KiB | 319982 KiB |   1979 TiB |   1979 TiB |
|       from large pool | 134912 KiB | 319103 KiB |   1978 TiB |   1978 TiB |
|       from small pool |      0 KiB |  15124 KiB |      1 TiB |      1 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |   35443    |  422190 K  |  422190 K  |
|       from large pool |       2    |     248    |  218633 K  |  218633 K  |
|       from small pool |       0    |   35406    |  203556 K  |  203556 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |   35443    |  422190 K  |  422190 K  |
|       from large pool |       2    |     248    |  218633 K  |  218633 K  |
|       from small pool |       0    |   35406    |  203556 K  |  203556 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      35    |      92    |      92    |      57    |
|       from large pool |      10    |      51    |      51    |      41    |
|       from small pool |      25    |      41    |      41    |      16    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |   17364    |  212267 K  |  212267 K  |
|       from large pool |       4    |      26    |  109592 K  |  109592 K  |
|       from small pool |       0    |   17356    |  102675 K  |  102675 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   2903 MiB |   5432 TiB |   5432 TiB |
|       from large pool |  16640 KiB |   2865 MiB |   5430 TiB |   5430 TiB |
|       from small pool |      0 KiB |     80 MiB |      1 TiB |      1 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   2903 MiB |   5432 TiB |   5432 TiB |
|       from large pool |  16640 KiB |   2865 MiB |   5430 TiB |   5430 TiB |
|       from small pool |      0 KiB |     80 MiB |      1 TiB |      1 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   2882 MiB |   5416 TiB |   5416 TiB |
|       from large pool |  16640 KiB |   2846 MiB |   5414 TiB |   5414 TiB |
|       from small pool |      0 KiB |     74 MiB |      1 TiB |      1 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 366592 KiB |   3118 MiB |   3118 MiB |   2760 MiB |
|       from large pool | 315392 KiB |   3036 MiB |   3036 MiB |   2728 MiB |
|       from small pool |  51200 KiB |     82 MiB |     82 MiB |     32 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 134912 KiB | 319982 KiB |   1979 TiB |   1979 TiB |
|       from large pool | 134912 KiB | 319103 KiB |   1978 TiB |   1978 TiB |
|       from small pool |      0 KiB |  15124 KiB |      1 TiB |      1 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |   35443    |  422190 K  |  422190 K  |
|       from large pool |       2    |     248    |  218633 K  |  218633 K  |
|       from small pool |       0    |   35406    |  203556 K  |  203556 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |   35443    |  422190 K  |  422190 K  |
|       from large pool |       2    |     248    |  218633 K  |  218633 K  |
|       from small pool |       0    |   35406    |  203556 K  |  203556 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      35    |      92    |      92    |      57    |
|       from large pool |      10    |      51    |      51    |      41    |
|       from small pool |      25    |      41    |      41    |      16    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |   17364    |  212267 K  |  212267 K  |
|       from large pool |       4    |      26    |  109592 K  |  109592 K  |
|       from small pool |       0    |   17356    |  102675 K  |  102675 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'888c1ef2'
model name: dset_te_0_erm_b888c1ef2_not_commited_2024md_07md_20_09_55_53_seed_1_22281436

 Experiment start at: 2024-07-20 09:55:53.545260
before training, model accuracy: 0.5293469429016113
slurmstepd: error: *** JOB 22281436 ON gpusrv38 CANCELLED AT 2024-07-20T11:34:42 DUE TO TIME LIMIT ***
