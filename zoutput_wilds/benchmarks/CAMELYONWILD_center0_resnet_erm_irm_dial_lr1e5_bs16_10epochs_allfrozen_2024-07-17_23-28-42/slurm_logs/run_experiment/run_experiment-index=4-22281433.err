Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Thu Jul 18 11:15:51 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYONWILD_center0_dinov2small_erm_irm_dial_lr1e5_bs16_10epochs_nofreezing_2024-07-17_23-28-42/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYONWILD_center0_dinov2small_erm_irm_dial_lr1e5_bs16_10epochs_nofreezing_2024-07-17_23-28-42/rule_results/4.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=4
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'888c1ef2'
model name: dset_te_0_dann_b888c1ef2_not_commited_2024md_07md_18_13_09_11_seed_0_22281433

 Experiment start at: 2024-07-18 13:09:11.304876
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.8449228, 'precision': 0.85005665, 'recall': 0.8448734, 'specificity': 0.8448734, 'f1': 0.8443388, 'auroc': 0.92596257, 'binary_precision': 0.807867, 'binary_recall': 0.90543526, 'binary_specificity': 0.7843116, 'binary_f1_score': 0.85387295}
confusion matrix:
        0       1
0  108755   29908
1   13134  125755
---- Validation: 
scalar performance:
{'acc': 0.8864492, 'precision': 0.88648, 'recall': 0.886441, 'specificity': 0.886441, 'f1': 0.88644505, 'auroc': 0.94027686, 'binary_precision': 0.88948905, 'binary_recall': 0.88205767, 'binary_specificity': 0.89082426, 'binary_f1_score': 0.8857578}
confusion matrix:
       0      1
0  53086   6506
1   7002  52366
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
scalar performance:
{'acc': 0.85337305, 'precision': 0.85352504, 'recall': 0.85336536, 'specificity': 0.85336536, 'f1': 0.8533553, 'auroc': 0.9171548, 'binary_precision': 0.8463783, 'binary_recall': 0.8637368, 'binary_specificity': 0.8429939, 'binary_f1_score': 0.85496944}
confusion matrix:
       0      1
0  17525   3264
1   2837  17983
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-18 17:41:36.642644,epoch time: 4:32:25.337768,used: 4:32:25.337768,model: dset_te_0_dann_b888c1ef2_not_commited_2024md_07md_18_13_09_11_seed_0_22281433
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.8731805, 'precision': 0.8731959, 'recall': 0.87318313, 'specificity': 0.87318313, 'f1': 0.8731797, 'auroc': 0.93258786, 'binary_precision': 0.87579554, 'binary_recall': 0.8699374, 'binary_specificity': 0.8764288, 'binary_f1_score': 0.8728566}
confusion matrix:
        0       1
0  121530   17135
1   18064  120823
---- Validation: 
scalar performance:
{'acc': 0.8966628, 'precision': 0.8989363, 'recall': 0.89659196, 'specificity': 0.89659196, 'f1': 0.89650303, 'auroc': 0.9434042, 'binary_precision': 0.9285857, 'binary_recall': 0.8589981, 'binary_specificity': 0.9341858, 'binary_f1_score': 0.89243746}
confusion matrix:
       0      1
0  55670   3922
1   8371  50997
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.87002814, 'precision': 0.8701767, 'recall': 0.87003565, 'specificity': 0.87003565, 'f1': 0.87001663, 'auroc': 0.92622745, 'binary_precision': 0.8777821, 'binary_recall': 0.8599904, 'binary_specificity': 0.8800808, 'binary_f1_score': 0.8687952}
confusion matrix:
       0      1
0  18296   2493
1   2915  17905
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-07-18 21:53:47.458130,epoch time: 4:12:10.815486,used: 8:44:36.153254,model: dset_te_0_dann_b888c1ef2_not_commited_2024md_07md_18_13_09_11_seed_0_22281433
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.88105655, 'precision': 0.8832195, 'recall': 0.8810869, 'specificity': 0.8810869, 'f1': 0.88089436, 'auroc': 0.93365324, 'binary_precision': 0.912212, 'binary_recall': 0.8434782, 'binary_specificity': 0.91869557, 'binary_f1_score': 0.87649965}
confusion matrix:
        0       1
0  127390   11274
1   21739  117149
---- Validation: 
scalar performance:
{'acc': 0.89967215, 'precision': 0.9033388, 'recall': 0.89958274, 'specificity': 0.89958274, 'f1': 0.8994287, 'auroc': 0.9430418, 'binary_precision': 0.9413275, 'binary_recall': 0.8520752, 'binary_specificity': 0.9470902, 'binary_f1_score': 0.89448047}
confusion matrix:
       0      1
0  56439   3153
1   8782  50586
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.87692565, 'precision': 0.8791114, 'recall': 0.87695396, 'specificity': 0.87695396, 'f1': 0.87675375, 'auroc': 0.92865, 'binary_precision': 0.9080842, 'binary_recall': 0.83895296, 'binary_specificity': 0.914955, 'binary_f1_score': 0.8721508}
confusion matrix:
       0      1
0  19021   1768
1   3353  17467
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-07-19 01:47:41.928845,epoch time: 3:53:54.470715,used: 12:38:30.623969,model: dset_te_0_dann_b888c1ef2_not_commited_2024md_07md_18_13_09_11_seed_0_22281433
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.8840109, 'precision': 0.8864236, 'recall': 0.88404256, 'specificity': 0.88404256, 'f1': 0.88383555, 'auroc': 0.9364747, 'binary_precision': 0.917158, 'binary_recall': 0.8444851, 'binary_specificity': 0.9236, 'binary_f1_score': 0.8793226}
confusion matrix:
        0       1
0  128071   10594
1   21599  117288
---- Validation: 
scalar performance:
{'acc': 0.89678043, 'precision': 0.9033681, 'recall': 0.89666045, 'specificity': 0.89666045, 'f1': 0.8963367, 'auroc': 0.9405248, 'binary_precision': 0.95444804, 'binary_recall': 0.8329235, 'binary_specificity': 0.96039736, 'binary_f1_score': 0.8895545}
confusion matrix:
       0      1
0  57232   2360
1   9919  49449
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8737292, 'precision': 0.8779974, 'recall': 0.8737688, 'specificity': 0.8737688, 'f1': 0.87338006, 'auroc': 0.92658794, 'binary_precision': 0.9183509, 'binary_recall': 0.82060516, 'binary_specificity': 0.9269325, 'binary_f1_score': 0.8667309}
confusion matrix:
       0      1
0  19270   1519
1   3735  17085
early stop counter: 1
val acc:0.8967804312705994, best validation acc: 0.8996721506118774, corresponding to test acc:                         0.8769256472587585 / 0.8769256472587585
after epoch: 4,now: 2024-07-19 05:48:28.378680,epoch time: 4:00:46.449835,used: 16:39:17.073804,model: dset_te_0_dann_b888c1ef2_not_commited_2024md_07md_18_13_09_11_seed_0_22281433
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.8825373, 'precision': 0.88744307, 'recall': 0.8825832, 'specificity': 0.8825832, 'f1': 0.8821732, 'auroc': 0.9356663, 'binary_precision': 0.9312441, 'binary_recall': 0.82627136, 'binary_specificity': 0.93889505, 'binary_f1_score': 0.8756228}
confusion matrix:
        0       1
0  130190    8473
1   24129  114760
---- Validation: 
scalar performance:
{'acc': 0.8952673, 'precision': 0.9047017, 'recall': 0.89512384, 'specificity': 0.89512384, 'f1': 0.8946284, 'auroc': 0.9424377, 'binary_precision': 0.96602356, 'binary_recall': 0.81894284, 'binary_specificity': 0.9713049, 'binary_f1_score': 0.88642347}
confusion matrix:
       0      1
0  57882   1710
1  10749  48619
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.88466436, 'precision': 0.88856876, 'recall': 0.8847017, 'specificity': 0.8847017, 'f1': 0.88438094, 'auroc': 0.93522215, 'binary_precision': 0.9277057, 'binary_recall': 0.8345341, 'binary_specificity': 0.9348694, 'binary_f1_score': 0.87865686}
confusion matrix:
       0      1
0  19435   1354
1   3445  17375
new oracle model saved
early stop counter: 2
val acc:0.8952673077583313, best validation acc: 0.8996721506118774, corresponding to test acc:                         0.8769256472587585 / 0.8846643567085266
after epoch: 5,now: 2024-07-19 09:38:31.068393,epoch time: 3:50:02.689713,used: 20:29:19.763517,model: dset_te_0_dann_b888c1ef2_not_commited_2024md_07md_18_13_09_11_seed_0_22281433
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.8877796, 'precision': 0.8911109, 'recall': 0.8878175, 'specificity': 0.8878175, 'f1': 0.887547, 'auroc': 0.9387181, 'binary_precision': 0.9274125, 'binary_recall': 0.8416157, 'binary_specificity': 0.9340194, 'binary_f1_score': 0.88243353}
confusion matrix:
        0       1
0  129513    9149
1   21998  116892
---- Validation: 
scalar performance:
{'acc': 0.90196705, 'precision': 0.9085446, 'recall': 0.9018479, 'specificity': 0.9018479, 'f1': 0.9015516, 'auroc': 0.9451705, 'binary_precision': 0.9599144, 'binary_recall': 0.83858305, 'binary_specificity': 0.96511275, 'binary_f1_score': 0.8951561}
confusion matrix:
       0      1
0  57513   2079
1   9583  49785
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8880771, 'precision': 0.890028, 'recall': 0.8881035, 'specificity': 0.8881035, 'f1': 0.8879418, 'auroc': 0.9394211, 'binary_precision': 0.9177997, 'binary_recall': 0.85268974, 'binary_specificity': 0.9235172, 'binary_f1_score': 0.8840475}
confusion matrix:
       0      1
0  19199   1590
1   3067  17753
new oracle model saved
better model found
persisted
after epoch: 6,now: 2024-07-19 13:55:16.406921,epoch time: 4:16:45.338528,used: 1 day, 0:46:05.102045,model: dset_te_0_dann_b888c1ef2_not_commited_2024md_07md_18_13_09_11_seed_0_22281433
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.8905394, 'precision': 0.89362776, 'recall': 0.89057493, 'specificity': 0.89057493, 'f1': 0.8903306, 'auroc': 0.9396658, 'binary_precision': 0.9286945, 'binary_recall': 0.8462275, 'binary_specificity': 0.9349223, 'binary_f1_score': 0.8855452}
confusion matrix:
        0       1
0  129641    9024
1   21357  117530
---- Validation: 
scalar performance:
{'acc': 0.89968055, 'precision': 0.90847015, 'recall': 0.8995428, 'specificity': 0.8995428, 'f1': 0.8991151, 'auroc': 0.9410554, 'binary_precision': 0.9679201, 'binary_recall': 0.82637113, 'binary_specificity': 0.9727145, 'binary_f1_score': 0.89156234}
confusion matrix:
       0      1
0  57966   1626
1  10308  49060
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.87913674, 'precision': 0.88420534, 'recall': 0.87917954, 'specificity': 0.87917954, 'f1': 0.8787453, 'auroc': 0.93055403, 'binary_precision': 0.92852104, 'binary_recall': 0.8217099, 'binary_specificity': 0.9366492, 'binary_f1_score': 0.8718563}
confusion matrix:
       0      1
0  19472   1317
1   3712  17108
early stop counter: 1
val acc:0.8996805548667908, best validation acc: 0.9019670486450195, corresponding to test acc:                         0.8880770802497864 / 0.8880770802497864
after epoch: 7,now: 2024-07-19 18:26:17.801092,epoch time: 4:31:01.394171,used: 1 day, 5:17:06.496216,model: dset_te_0_dann_b888c1ef2_not_commited_2024md_07md_18_13_09_11_seed_0_22281433
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.880689, 'precision': 0.8901695, 'recall': 0.88075256, 'specificity': 0.88075256, 'f1': 0.87997234, 'auroc': 0.9338175, 'binary_precision': 0.9511927, 'binary_recall': 0.80276334, 'binary_specificity': 0.9587417, 'binary_f1_score': 0.8706975}
confusion matrix:
        0       1
0  132942    5721
1   27394  111495
---- Validation: 
scalar performance:
{'acc': 0.8906355, 'precision': 0.9045017, 'recall': 0.8904615, 'specificity': 0.8904615, 'f1': 0.88965845, 'auroc': 0.936109, 'binary_precision': 0.97892475, 'binary_recall': 0.7980394, 'binary_specificity': 0.98288363, 'binary_f1_score': 0.87927544}
confusion matrix:
       0      1
0  58572   1020
1  11990  47378
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8761085, 'precision': 0.88600695, 'recall': 0.8761682, 'specificity': 0.8761682, 'f1': 0.8753214, 'auroc': 0.92817307, 'binary_precision': 0.94800663, 'binary_recall': 0.79606146, 'binary_specificity': 0.9562749, 'binary_f1_score': 0.86541516}
confusion matrix:
       0      1
0  19880    909
1   4246  16574
early stop counter: 2
val acc:0.8906354904174805, best validation acc: 0.9019670486450195, corresponding to test acc:                         0.8880770802497864 / 0.8880770802497864
after epoch: 8,now: 2024-07-19 22:06:46.800572,epoch time: 3:40:28.999480,used: 1 day, 8:57:35.495696,model: dset_te_0_dann_b888c1ef2_not_commited_2024md_07md_18_13_09_11_seed_0_22281433
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.89343256, 'precision': 0.89495325, 'recall': 0.8934574, 'specificity': 0.8934574, 'f1': 0.89333415, 'auroc': 0.94219726, 'binary_precision': 0.9196606, 'binary_recall': 0.86237013, 'binary_specificity': 0.92454475, 'binary_f1_score': 0.8900944}
confusion matrix:
        0       1
0  128202   10463
1   19115  119772
---- Validation: 
scalar performance:
{'acc': 0.90595996, 'precision': 0.91204596, 'recall': 0.9058459, 'specificity': 0.9058459, 'f1': 0.90559375, 'auroc': 0.94551826, 'binary_precision': 0.9616542, 'binary_recall': 0.84527016, 'binary_specificity': 0.96642166, 'binary_f1_score': 0.899714}
confusion matrix:
       0      1
0  57591   2001
1   9186  50182
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8885337, 'precision': 0.89102435, 'recall': 0.8885635, 'specificity': 0.8885635, 'f1': 0.88836133, 'auroc': 0.9362736, 'binary_precision': 0.9224183, 'binary_recall': 0.8486071, 'binary_specificity': 0.9285199, 'binary_f1_score': 0.8839746}
confusion matrix:
       0      1
0  19303   1486
1   3152  17668
new oracle model saved
better model found
persisted
after epoch: 9,now: 2024-07-20 01:52:49.244614,epoch time: 3:46:02.444042,used: 1 day, 12:43:37.939738,model: dset_te_0_dann_b888c1ef2_not_commited_2024md_07md_18_13_09_11_seed_0_22281433
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.8912132, 'precision': 0.89482254, 'recall': 0.8912518, 'specificity': 0.8912518, 'f1': 0.8909708, 'auroc': 0.9399005, 'binary_precision': 0.93277484, 'binary_recall': 0.8433846, 'binary_specificity': 0.93911904, 'binary_f1_score': 0.8858303}
confusion matrix:
        0       1
0  130222    8442
1   21752  117136
---- Validation: 
scalar performance:
{'acc': 0.9047411, 'precision': 0.91116655, 'recall': 0.90462375, 'specificity': 0.90462375, 'f1': 0.9043491, 'auroc': 0.9444778, 'binary_precision': 0.9620979, 'binary_recall': 0.8423056, 'binary_specificity': 0.9669419, 'binary_f1_score': 0.8982253}
confusion matrix:
       0      1
0  57622   1970
1   9362  50006
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.88781273, 'precision': 0.89132285, 'recall': 0.887848, 'specificity': 0.887848, 'f1': 0.88756704, 'auroc': 0.9363772, 'binary_precision': 0.9285714, 'binary_recall': 0.8404419, 'binary_specificity': 0.9352542, 'binary_f1_score': 0.8823114}
confusion matrix:
       0      1
0  19443   1346
1   3322  17498
early stop counter: 1
val acc:0.904741108417511, best validation acc: 0.905959963798523, corresponding to test acc:                         0.8885337114334106 / 0.8885337114334106
after epoch: 10,now: 2024-07-20 05:32:19.072816,epoch time: 3:39:29.828202,used: 1 day, 16:23:07.767940,model: dset_te_0_dann_b888c1ef2_not_commited_2024md_07md_18_13_09_11_seed_0_22281433
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 10 with time: 1 day, 16:23:07.767940 at 2024-07-20 05:32:19.072816
persisted model performance metric: 

scalar performance:
{'acc': 0.8885337, 'precision': 0.89102435, 'recall': 0.8885635, 'specificity': 0.8885635, 'f1': 0.88836133, 'auroc': 0.9362736, 'binary_precision': 0.9224183, 'binary_recall': 0.8486071, 'binary_specificity': 0.9285199, 'binary_f1_score': 0.8839746}
confusion matrix:
       0      1
0  19303   1486
1   3152  17668
oracle model performance metric: 

scalar performance:
{'acc': 0.8885337, 'precision': 0.89102435, 'recall': 0.8885635, 'specificity': 0.8885635, 'f1': 0.88836133, 'auroc': 0.9362736, 'binary_precision': 0.9224183, 'binary_recall': 0.8486071, 'binary_specificity': 0.9285199, 'binary_f1_score': 0.8839746}
confusion matrix:
       0      1
0  19303   1486
1   3152  17668
results aggregation path: zoutput/benchmarks/CAMELYONWILD_center0_dinov2small_erm_irm_dial_lr1e5_bs16_10epochs_nofreezing_2024-07-17_23-28-42/rule_results/4.csv
results aggregation path: zoutput/benchmarks/CAMELYONWILD_center0_dinov2small_erm_irm_dial_lr1e5_bs16_10epochs_nofreezing_2024-07-17_23-28-42/rule_results/4.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONWILD_center0_dinov2small_erm_irm_dial_lr1e5_bs16_10epochs_nofreezing_2024-07-17_23-28-42/confusion_matrix/4.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 211616 KiB | 647370 KiB |   2747 TiB |   2747 TiB |
|       from large pool | 167936 KiB | 568000 KiB |   2745 TiB |   2745 TiB |
|       from small pool |  43680 KiB |  81829 KiB |      1 TiB |      1 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 211616 KiB | 647370 KiB |   2747 TiB |   2747 TiB |
|       from large pool | 167936 KiB | 568000 KiB |   2745 TiB |   2745 TiB |
|       from small pool |  43680 KiB |  81829 KiB |      1 TiB |      1 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 202745 KiB | 633954 KiB |   2740 TiB |   2740 TiB |
|       from large pool | 165120 KiB | 560704 KiB |   2739 TiB |   2739 TiB |
|       from small pool |  37625 KiB |  75700 KiB |      1 TiB |      1 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 763904 KiB | 763904 KiB | 763904 KiB |      0 B   |
|       from large pool | 679936 KiB | 679936 KiB | 679936 KiB |      0 B   |
|       from small pool |  83968 KiB |  83968 KiB |  83968 KiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |  77151 KiB | 213902 KiB |   1082 TiB |   1082 TiB |
|       from large pool |  67584 KiB | 209284 KiB |   1081 TiB |   1081 TiB |
|       from small pool |   9567 KiB |  11366 KiB |      1 TiB |      1 TiB |
|---------------------------------------------------------------------------|
| Allocations           |   16526    |   35463    |  231422 K  |  231406 K  |
|       from large pool |      36    |      76    |   98483 K  |   98483 K  |
|       from small pool |   16490    |   35426    |  132939 K  |  132922 K  |
|---------------------------------------------------------------------------|
| Active allocs         |   16526    |   35463    |  231422 K  |  231406 K  |
|       from large pool |      36    |      76    |   98483 K  |   98483 K  |
|       from small pool |   16490    |   35426    |  132939 K  |  132922 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      55    |      55    |      55    |       0    |
|       from large pool |      14    |      14    |      14    |       0    |
|       from small pool |      41    |      41    |      41    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      36    |   17361    |  104245 K  |  104245 K  |
|       from large pool |       7    |      11    |   35069 K  |   35069 K  |
|       from small pool |      29    |   17354    |   69175 K  |   69175 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB | 647370 KiB |   2747 TiB |   2747 TiB |
|       from large pool |  16640 KiB | 568000 KiB |   2745 TiB |   2745 TiB |
|       from small pool |      0 KiB |  81829 KiB |      1 TiB |      1 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB | 647370 KiB |   2747 TiB |   2747 TiB |
|       from large pool |  16640 KiB | 568000 KiB |   2745 TiB |   2745 TiB |
|       from small pool |      0 KiB |  81829 KiB |      1 TiB |      1 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB | 633954 KiB |   2740 TiB |   2740 TiB |
|       from large pool |  16640 KiB | 560704 KiB |   2739 TiB |   2739 TiB |
|       from small pool |      0 KiB |  75700 KiB |      1 TiB |      1 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 288768 KiB | 763904 KiB | 763904 KiB | 475136 KiB |
|       from large pool | 235520 KiB | 679936 KiB | 679936 KiB | 444416 KiB |
|       from small pool |  53248 KiB |  83968 KiB |  83968 KiB |  30720 KiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  55040 KiB | 213902 KiB |   1082 TiB |   1082 TiB |
|       from large pool |  55040 KiB | 209284 KiB |   1081 TiB |   1081 TiB |
|       from small pool |      0 KiB |  17163 KiB |      1 TiB |      1 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |   35463    |  231422 K  |  231422 K  |
|       from large pool |       2    |      76    |   98483 K  |   98483 K  |
|       from small pool |       0    |   35426    |  132939 K  |  132939 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |   35463    |  231422 K  |  231422 K  |
|       from large pool |       2    |      76    |   98483 K  |   98483 K  |
|       from small pool |       0    |   35426    |  132939 K  |  132939 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      36    |      55    |      55    |      19    |
|       from large pool |      10    |      14    |      14    |       4    |
|       from small pool |      26    |      41    |      41    |      15    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |   17361    |  104252 K  |  104252 K  |
|       from large pool |       3    |      13    |   35069 K  |   35069 K  |
|       from small pool |       0    |   17354    |   69183 K  |   69183 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB | 647370 KiB |   2747 TiB |   2747 TiB |
|       from large pool |  16640 KiB | 568000 KiB |   2745 TiB |   2745 TiB |
|       from small pool |      0 KiB |  81829 KiB |      1 TiB |      1 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB | 647370 KiB |   2747 TiB |   2747 TiB |
|       from large pool |  16640 KiB | 568000 KiB |   2745 TiB |   2745 TiB |
|       from small pool |      0 KiB |  81829 KiB |      1 TiB |      1 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB | 633954 KiB |   2740 TiB |   2740 TiB |
|       from large pool |  16640 KiB | 560704 KiB |   2739 TiB |   2739 TiB |
|       from small pool |      0 KiB |  75700 KiB |      1 TiB |      1 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 288768 KiB | 763904 KiB | 763904 KiB | 475136 KiB |
|       from large pool | 235520 KiB | 679936 KiB | 679936 KiB | 444416 KiB |
|       from small pool |  53248 KiB |  83968 KiB |  83968 KiB |  30720 KiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  55040 KiB | 213902 KiB |   1082 TiB |   1082 TiB |
|       from large pool |  55040 KiB | 209284 KiB |   1081 TiB |   1081 TiB |
|       from small pool |      0 KiB |  17163 KiB |      1 TiB |      1 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |   35463    |  231422 K  |  231422 K  |
|       from large pool |       2    |      76    |   98483 K  |   98483 K  |
|       from small pool |       0    |   35426    |  132939 K  |  132939 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |   35463    |  231422 K  |  231422 K  |
|       from large pool |       2    |      76    |   98483 K  |   98483 K  |
|       from small pool |       0    |   35426    |  132939 K  |  132939 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      36    |      55    |      55    |      19    |
|       from large pool |      10    |      14    |      14    |       4    |
|       from small pool |      26    |      41    |      41    |      15    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |   17361    |  104252 K  |  104252 K  |
|       from large pool |       3    |      13    |   35069 K  |   35069 K  |
|       from small pool |       0    |   17354    |   69183 K  |   69183 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'888c1ef2'
model name: dset_te_0_dann_b888c1ef2_not_commited_2024md_07md_20_09_18_43_seed_1_22281433

 Experiment start at: 2024-07-20 09:18:43.697361
epoch: 1
---- Training Domain: 
slurmstepd: error: *** JOB 22281433 ON gpusrv29 CANCELLED AT 2024-07-20T11:15:12 DUE TO TIME LIMIT ***
