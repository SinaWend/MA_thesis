Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Sun Jul 14 11:16:14 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYONWILDnew_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_halffreeze/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYONWILDnew_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_halffreeze/rule_results/1.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=1
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/swiglu_ffn.py:51: UserWarning: xFormers is not available (SwiGLU)
  warnings.warn("xFormers is not available (SwiGLU)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/attention.py:33: UserWarning: xFormers is not available (Attention)
  warnings.warn("xFormers is not available (Attention)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/block.py:40: UserWarning: xFormers is not available (Block)
  warnings.warn("xFormers is not available (Block)")
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_0_erm_b44271c83_not_commited_2024md_07md_14_13_06_42_seed_0_21971798

 Experiment start at: 2024-07-14 13:06:42.445931
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
before training, model accuracy: 0.5626667737960815
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.96743673, 'precision': 0.9678726, 'recall': 0.96744907, 'specificity': 0.96744907, 'f1': 0.96742976, 'auroc': 0.9938219, 'binary_precision': 0.982355, 'binary_recall': 0.9520258, 'binary_specificity': 0.98287237, 'binary_f1_score': 0.9669526}
confusion matrix:
        0       1
0  136290    2375
1    6663  132224
---- Validation: 
scalar performance:
{'acc': 0.9734449, 'precision': 0.97382593, 'recall': 0.9734189, 'specificity': 0.9734189, 'f1': 0.9734384, 'auroc': 0.9962292, 'binary_precision': 0.9868013, 'binary_recall': 0.9596247, 'binary_specificity': 0.9872131, 'binary_f1_score': 0.9730233}
confusion matrix:
       0      1
0  58830    762
1   2397  56971
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9680838, 'precision': 0.9681176, 'recall': 0.9680871, 'specificity': 0.9680871, 'f1': 0.9680834, 'auroc': 0.9947001, 'binary_precision': 0.97228146, 'binary_recall': 0.96368873, 'binary_specificity': 0.9724854, 'binary_f1_score': 0.967966}
confusion matrix:
       0      1
0  20217    572
1    756  20064
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-14 17:33:43.726178,epoch time: 4:27:01.280247,used: 4:27:01.280247,model: dset_te_0_erm_b44271c83_not_commited_2024md_07md_14_13_06_42_seed_0_21971798
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.970982, 'precision': 0.9717889, 'recall': 0.9709988, 'specificity': 0.9709988, 'f1': 0.9709703, 'auroc': 0.99540937, 'binary_precision': 0.99150234, 'binary_recall': 0.95015407, 'binary_specificity': 0.9918436, 'binary_f1_score': 0.97038794}
confusion matrix:
        0       1
0  137533    1131
1    6923  131965
---- Validation: 
scalar performance:
{'acc': 0.97981673, 'precision': 0.9800198, 'recall': 0.97979814, 'specificity': 0.97979814, 'f1': 0.979814, 'auroc': 0.99747646, 'binary_precision': 0.98943245, 'binary_recall': 0.96991646, 'binary_specificity': 0.9896798, 'binary_f1_score': 0.9795773}
confusion matrix:
       0      1
0  58977    615
1   1786  57582
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9683242, 'precision': 0.96833265, 'recall': 0.96832263, 'specificity': 0.96832263, 'f1': 0.9683239, 'auroc': 0.99472344, 'binary_precision': 0.96651036, 'binary_recall': 0.970317, 'binary_specificity': 0.9663283, 'binary_f1_score': 0.9684099}
confusion matrix:
       0      1
0  20089    700
1    618  20202
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-07-14 21:02:45.225713,epoch time: 3:29:01.499535,used: 7:56:02.779782,model: dset_te_0_erm_b44271c83_not_commited_2024md_07md_14_13_06_42_seed_0_21971798
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9765521, 'precision': 0.9768586, 'recall': 0.9765625, 'specificity': 0.9765625, 'f1': 0.97654873, 'auroc': 0.9965654, 'binary_precision': 0.9891513, 'binary_recall': 0.96371174, 'binary_specificity': 0.98941326, 'binary_f1_score': 0.97626585}
confusion matrix:
        0       1
0  137196    1468
1    5040  133848
---- Validation: 
scalar performance:
{'acc': 0.9808927, 'precision': 0.9811281, 'recall': 0.9808727, 'specificity': 0.9808727, 'f1': 0.98088974, 'auroc': 0.99784535, 'binary_precision': 0.9913088, 'binary_recall': 0.9702197, 'binary_specificity': 0.9915257, 'binary_f1_score': 0.98065084}
confusion matrix:
       0      1
0  59087    505
1   1768  57600
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97452474, 'precision': 0.97473764, 'recall': 0.9745327, 'specificity': 0.9745327, 'f1': 0.9745222, 'auroc': 0.9957117, 'binary_precision': 0.9849794, 'binary_recall': 0.9637848, 'binary_specificity': 0.9852807, 'binary_f1_score': 0.9742668}
confusion matrix:
       0      1
0  20483    306
1    754  20066
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-07-14 23:50:14.911040,epoch time: 2:47:29.685327,used: 10:43:32.465109,model: dset_te_0_erm_b44271c83_not_commited_2024md_07md_14_13_06_42_seed_0_21971798
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.977842, 'precision': 0.9779464, 'recall': 0.977848, 'specificity': 0.977848, 'f1': 0.97784096, 'auroc': 0.9966488, 'binary_precision': 0.98521006, 'binary_recall': 0.970285, 'binary_specificity': 0.985411, 'binary_f1_score': 0.9776905}
confusion matrix:
        0       1
0  136643    2023
1    4127  134759
---- Validation: 
scalar performance:
{'acc': 0.98608774, 'precision': 0.98619604, 'recall': 0.9860745, 'specificity': 0.9860745, 'f1': 0.98608667, 'auroc': 0.99862456, 'binary_precision': 0.9929954, 'binary_recall': 0.9790291, 'binary_specificity': 0.9931199, 'binary_f1_score': 0.9859628}
confusion matrix:
       0      1
0  59182    410
1   1245  58123
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9781778, 'precision': 0.97844595, 'recall': 0.9781867, 'specificity': 0.9781867, 'f1': 0.97817504, 'auroc': 0.99560225, 'binary_precision': 0.9899606, 'binary_recall': 0.96618634, 'binary_specificity': 0.9901871, 'binary_f1_score': 0.977929}
confusion matrix:
       0      1
0  20585    204
1    704  20116
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-07-15 03:19:59.015537,epoch time: 3:29:44.104497,used: 14:13:16.569606,model: dset_te_0_erm_b44271c83_not_commited_2024md_07md_14_13_06_42_seed_0_21971798
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.97801495, 'precision': 0.978027, 'recall': 0.97801304, 'specificity': 0.97801304, 'f1': 0.9780147, 'auroc': 0.99710846, 'binary_precision': 0.9758197, 'binary_recall': 0.9803584, 'binary_specificity': 0.97566766, 'binary_f1_score': 0.9780838}
confusion matrix:
        0       1
0  135289    3374
1    2728  136161
---- Validation: 
scalar performance:
{'acc': 0.98581874, 'precision': 0.98583937, 'recall': 0.9858134, 'specificity': 0.9858134, 'f1': 0.98581845, 'auroc': 0.9985224, 'binary_precision': 0.9885653, 'binary_recall': 0.9829538, 'binary_specificity': 0.988673, 'binary_f1_score': 0.98575157}
confusion matrix:
       0      1
0  58917    675
1   1012  58356
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9695258, 'precision': 0.96973276, 'recall': 0.96953374, 'specificity': 0.96953374, 'f1': 0.9695228, 'auroc': 0.9924451, 'binary_precision': 0.97978014, 'binary_recall': 0.95888567, 'binary_specificity': 0.9801818, 'binary_f1_score': 0.9692203}
confusion matrix:
       0      1
0  20377    412
1    856  19964
early stop counter: 1
val acc:0.9858187437057495, best validation acc: 0.9860877394676208, corresponding to test acc:                         0.9781777858734131 / 0.9781777858734131
after epoch: 5,now: 2024-07-15 06:05:08.453919,epoch time: 2:45:09.438382,used: 16:58:26.007988,model: dset_te_0_erm_b44271c83_not_commited_2024md_07md_14_13_06_42_seed_0_21971798
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.98058385, 'precision': 0.9806233, 'recall': 0.9805876, 'specificity': 0.9805876, 'f1': 0.98058355, 'auroc': 0.9974828, 'binary_precision': 0.9851863, 'binary_recall': 0.97587264, 'binary_specificity': 0.9853026, 'binary_f1_score': 0.9805073}
confusion matrix:
        0       1
0  136626    2038
1    3351  135537
---- Validation: 
scalar performance:
{'acc': 0.98592806, 'precision': 0.9859528, 'recall': 0.9859221, 'specificity': 0.9859221, 'f1': 0.9859277, 'auroc': 0.99852103, 'binary_precision': 0.9889819, 'binary_recall': 0.98275167, 'binary_specificity': 0.98909247, 'binary_f1_score': 0.9858569}
confusion matrix:
       0      1
0  58942    650
1   1024  58344
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.977577, 'precision': 0.9776882, 'recall': 0.9775828, 'specificity': 0.9775828, 'f1': 0.97757584, 'auroc': 0.996562, 'binary_precision': 0.9851671, 'binary_recall': 0.9697887, 'binary_specificity': 0.9853769, 'binary_f1_score': 0.97741735}
confusion matrix:
       0      1
0  20485    304
1    629  20191
early stop counter: 2
val acc:0.9859280586242676, best validation acc: 0.9860877394676208, corresponding to test acc:                         0.9781777858734131 / 0.9781777858734131
after epoch: 6,now: 2024-07-15 10:03:20.105544,epoch time: 3:58:11.651625,used: 20:56:37.659613,model: dset_te_0_erm_b44271c83_not_commited_2024md_07md_14_13_06_42_seed_0_21971798
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.98200697, 'precision': 0.982087, 'recall': 0.9820124, 'specificity': 0.9820124, 'f1': 0.9820063, 'auroc': 0.99785185, 'binary_precision': 0.9885075, 'binary_recall': 0.9753834, 'binary_specificity': 0.98864144, 'binary_f1_score': 0.9819016}
confusion matrix:
        0       1
0  137087    1575
1    3419  135471
---- Validation: 
scalar performance:
{'acc': 0.98618025, 'precision': 0.9863024, 'recall': 0.9861661, 'specificity': 0.9861661, 'f1': 0.986179, 'auroc': 0.99879295, 'binary_precision': 0.9935531, 'binary_recall': 0.97865856, 'binary_specificity': 0.9936736, 'binary_f1_score': 0.9860496}
confusion matrix:
       0      1
0  59215    377
1   1267  58101
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9781778, 'precision': 0.9785954, 'recall': 0.97818893, 'specificity': 0.97818893, 'f1': 0.9781734, 'auroc': 0.9953612, 'binary_precision': 0.9929201, 'binary_recall': 0.9632565, 'binary_specificity': 0.9931214, 'binary_f1_score': 0.9778634}
confusion matrix:
       0      1
0  20646    143
1    765  20055
better model found
persisted
after epoch: 7,now: 2024-07-15 15:42:18.053831,epoch time: 5:38:57.948287,used: 1 day, 2:35:35.607900,model: dset_te_0_erm_b44271c83_not_commited_2024md_07md_14_13_06_42_seed_0_21971798
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9820142, 'precision': 0.9821079, 'recall': 0.98202, 'specificity': 0.98202, 'f1': 0.98201346, 'auroc': 0.9977689, 'binary_precision': 0.9890357, 'binary_recall': 0.97486484, 'binary_specificity': 0.9891752, 'binary_f1_score': 0.9818992}
confusion matrix:
        0       1
0  137162    1501
1    3491  135398
---- Validation: 
scalar performance:
{'acc': 0.9879792, 'precision': 0.9880837, 'recall': 0.9879662, 'specificity': 0.9879662, 'f1': 0.9879782, 'auroc': 0.9989587, 'binary_precision': 0.9947737, 'binary_recall': 0.98106724, 'binary_specificity': 0.99486506, 'binary_f1_score': 0.9878729}
confusion matrix:
       0      1
0  59286    306
1   1124  58244
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97834605, 'precision': 0.9786973, 'recall': 0.97835624, 'specificity': 0.97835624, 'f1': 0.9783424, 'auroc': 0.99598765, 'binary_precision': 0.99185145, 'binary_recall': 0.9646494, 'binary_specificity': 0.9920631, 'binary_f1_score': 0.9780614}
confusion matrix:
       0      1
0  20624    165
1    736  20084
new oracle model saved
better model found
persisted
after epoch: 8,now: 2024-07-15 20:41:12.324377,epoch time: 4:58:54.270546,used: 1 day, 7:34:29.878446,model: dset_te_0_erm_b44271c83_not_commited_2024md_07md_14_13_06_42_seed_0_21971798
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9793048, 'precision': 0.9798058, 'recall': 0.97931784, 'specificity': 0.97931784, 'f1': 0.9792998, 'auroc': 0.99796474, 'binary_precision': 0.9955117, 'binary_recall': 0.9629843, 'binary_specificity': 0.99565136, 'binary_f1_score': 0.97897786}
confusion matrix:
        0       1
0  138062     603
1    5141  133746
---- Validation: 
scalar performance:
{'acc': 0.98502016, 'precision': 0.98530114, 'recall': 0.98499835, 'specificity': 0.98499835, 'f1': 0.9850174, 'auroc': 0.99876976, 'binary_precision': 0.99651664, 'binary_recall': 0.97338635, 'binary_specificity': 0.9966103, 'binary_f1_score': 0.98481566}
confusion matrix:
       0      1
0  59390    202
1   1580  57788
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9687808, 'precision': 0.97027755, 'recall': 0.968802, 'specificity': 0.968802, 'f1': 0.9687569, 'auroc': 0.9953809, 'binary_precision': 0.99699575, 'binary_recall': 0.9404419, 'binary_specificity': 0.997162, 'binary_f1_score': 0.9678934}
confusion matrix:
       0      1
0  20730     59
1   1240  19580
early stop counter: 1
val acc:0.9850201606750488, best validation acc: 0.9879791736602783, corresponding to test acc:                         0.978346049785614 / 0.978346049785614
after epoch: 9,now: 2024-07-16 00:53:13.533077,epoch time: 4:12:01.208700,used: 1 day, 11:46:31.087146,model: dset_te_0_erm_b44271c83_not_commited_2024md_07md_14_13_06_42_seed_0_21971798
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9828969, 'precision': 0.9828993, 'recall': 0.98289794, 'specificity': 0.98289794, 'f1': 0.9828969, 'auroc': 0.99817973, 'binary_precision': 0.9841968, 'binary_recall': 0.98158187, 'binary_specificity': 0.984214, 'binary_f1_score': 0.9828876}
confusion matrix:
        0       1
0  136478    2189
1    2558  136327
---- Validation: 
scalar performance:
{'acc': 0.98908037, 'precision': 0.9891084, 'recall': 0.989074, 'specificity': 0.989074, 'f1': 0.9890801, 'auroc': 0.9990564, 'binary_precision': 0.9923689, 'binary_recall': 0.98569936, 'binary_specificity': 0.9924486, 'binary_f1_score': 0.98902285}
confusion matrix:
       0      1
0  59142    450
1    849  58519
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9764714, 'precision': 0.9768139, 'recall': 0.97648156, 'specificity': 0.97648156, 'f1': 0.97646755, 'auroc': 0.99533916, 'binary_precision': 0.9897803, 'binary_recall': 0.96292025, 'binary_specificity': 0.9900428, 'binary_f1_score': 0.97616553}
confusion matrix:
       0      1
0  20582    207
1    772  20048
better model found
persisted
after epoch: 10,now: 2024-07-16 05:05:38.341140,epoch time: 4:12:24.808063,used: 1 day, 15:58:55.895209,model: dset_te_0_erm_b44271c83_not_commited_2024md_07md_14_13_06_42_seed_0_21971798
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9828501, 'precision': 0.98285604, 'recall': 0.9828516, 'specificity': 0.9828516, 'f1': 0.9828501, 'auroc': 0.9980636, 'binary_precision': 0.9847625, 'binary_recall': 0.98090535, 'binary_specificity': 0.9847979, 'binary_f1_score': 0.9828301}
confusion matrix:
        0       1
0  136557    2108
1    2652  136235
---- Validation: 
scalar performance:
{'acc': 0.9879876, 'precision': 0.9880714, 'recall': 0.98797596, 'specificity': 0.98797596, 'f1': 0.9879868, 'auroc': 0.99900365, 'binary_precision': 0.99401444, 'binary_recall': 0.98184204, 'binary_specificity': 0.9941099, 'binary_f1_score': 0.9878907}
confusion matrix:
       0      1
0  59241    351
1   1078  58290
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9730827, 'precision': 0.97367334, 'recall': 0.973096, 'specificity': 0.973096, 'f1': 0.97307485, 'auroc': 0.99479914, 'binary_precision': 0.9905867, 'binary_recall': 0.9552834, 'binary_specificity': 0.9909087, 'binary_f1_score': 0.97261477}
confusion matrix:
       0      1
0  20600    189
1    931  19889
early stop counter: 1
val acc:0.9879875779151917, best validation acc: 0.9890803694725037, corresponding to test acc:                         0.9764714241027832 / 0.978346049785614
after epoch: 11,now: 2024-07-16 08:59:38.169531,epoch time: 3:53:59.828391,used: 1 day, 19:52:55.723600,model: dset_te_0_erm_b44271c83_not_commited_2024md_07md_14_13_06_42_seed_0_21971798
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
slurmstepd: error: *** JOB 21971798 ON supergpu03 CANCELLED AT 2024-07-16T11:16:33 DUE TO TIME LIMIT ***
