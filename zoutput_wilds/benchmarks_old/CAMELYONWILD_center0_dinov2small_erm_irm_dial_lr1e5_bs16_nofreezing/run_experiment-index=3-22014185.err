Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Tue Jul 16 11:34:19 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYONWILD_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_nofreezing/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYONWILD_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_nofreezing/rule_results/3.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=3
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/swiglu_ffn.py:51: UserWarning: xFormers is not available (SwiGLU)
  warnings.warn("xFormers is not available (SwiGLU)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/attention.py:33: UserWarning: xFormers is not available (Attention)
  warnings.warn("xFormers is not available (Attention)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/block.py:40: UserWarning: xFormers is not available (Block)
  warnings.warn("xFormers is not available (Block)")
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_0_erm_b44271c83_not_commited_2024md_07md_16_13_12_11_seed_0_22014185

 Experiment start at: 2024-07-16 13:12:11.612199
before training, model accuracy: 0.5626667737960815
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.96583706, 'precision': 0.96602595, 'recall': 0.9658452, 'specificity': 0.9658452, 'f1': 0.96583396, 'auroc': 0.992944, 'binary_precision': 0.9756103, 'binary_recall': 0.9556186, 'binary_specificity': 0.97607183, 'binary_f1_score': 0.96551096}
confusion matrix:
        0       1
0  135347    3318
1    6164  132723
---- Validation: 
scalar performance:
{'acc': 0.9788753, 'precision': 0.9789008, 'recall': 0.9788691, 'specificity': 0.9788691, 'f1': 0.9788747, 'auroc': 0.99708295, 'binary_precision': 0.9819609, 'binary_recall': 0.9755929, 'binary_specificity': 0.98214525, 'binary_f1_score': 0.97876656}
confusion matrix:
       0      1
0  58528   1064
1   1449  57919
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9669302, 'precision': 0.96699715, 'recall': 0.96692586, 'specificity': 0.96692586, 'f1': 0.9669288, 'auroc': 0.9945397, 'binary_precision': 0.9615896, 'binary_recall': 0.9727666, 'binary_specificity': 0.9610852, 'binary_f1_score': 0.96714574}
confusion matrix:
       0      1
0  19980    809
1    567  20253
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-16 17:49:30.819552,epoch time: 4:37:19.207353,used: 4:37:19.207353,model: dset_te_0_erm_b44271c83_not_commited_2024md_07md_16_13_12_11_seed_0_22014185
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9688599, 'precision': 0.97005665, 'recall': 0.96888036, 'specificity': 0.96888036, 'f1': 0.9688411, 'auroc': 0.9956027, 'binary_precision': 0.99397725, 'binary_recall': 0.9434868, 'binary_specificity': 0.9942739, 'binary_f1_score': 0.96807414}
confusion matrix:
        0       1
0  137870     794
1    7849  131039
---- Validation: 
scalar performance:
{'acc': 0.98102725, 'precision': 0.98146516, 'recall': 0.9809996, 'specificity': 0.9809996, 'f1': 0.981022, 'auroc': 0.997965, 'binary_precision': 0.9955229, 'binary_recall': 0.9663287, 'binary_specificity': 0.99567056, 'binary_f1_score': 0.9807086}
confusion matrix:
       0      1
0  59334    258
1   1999  57369
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9726502, 'precision': 0.9734048, 'recall': 0.97266513, 'specificity': 0.97266513, 'f1': 0.9726398, 'auroc': 0.9944478, 'binary_precision': 0.9924933, 'binary_recall': 0.95254564, 'binary_specificity': 0.9927846, 'binary_f1_score': 0.9721092}
confusion matrix:
       0      1
0  20639    150
1    988  19832
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-07-16 21:39:50.350677,epoch time: 3:50:19.531125,used: 8:27:38.738478,model: dset_te_0_erm_b44271c83_not_commited_2024md_07md_16_13_12_11_seed_0_22014185
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.97210974, 'precision': 0.97212625, 'recall': 0.9721123, 'specificity': 0.9721123, 'f1': 0.97210956, 'auroc': 0.9955212, 'binary_precision': 0.97512555, 'binary_recall': 0.9689822, 'binary_specificity': 0.9752423, 'binary_f1_score': 0.97204417}
confusion matrix:
        0       1
0  135231    3433
1    4308  134580
---- Validation: 
scalar performance:
{'acc': 0.98357433, 'precision': 0.98363054, 'recall': 0.9835649, 'specificity': 0.9835649, 'f1': 0.98357356, 'auroc': 0.998162, 'binary_precision': 0.988397, 'binary_recall': 0.97857434, 'binary_specificity': 0.9885555, 'binary_f1_score': 0.98346114}
confusion matrix:
       0      1
0  58910    682
1   1272  58096
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96659374, 'precision': 0.9669502, 'recall': 0.9666041, 'specificity': 0.9666041, 'f1': 0.9665879, 'auroc': 0.99309814, 'binary_precision': 0.98003757, 'binary_recall': 0.95264167, 'binary_specificity': 0.9805666, 'binary_f1_score': 0.96614546}
confusion matrix:
       0      1
0  20385    404
1    986  19834
better model found
persisted
after epoch: 3,now: 2024-07-17 01:29:19.108992,epoch time: 3:49:28.758315,used: 12:17:07.496793,model: dset_te_0_erm_b44271c83_not_commited_2024md_07md_16_13_12_11_seed_0_22014185
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.974657, 'precision': 0.97499675, 'recall': 0.9746677, 'specificity': 0.9746677, 'f1': 0.9746529, 'auroc': 0.99606, 'binary_precision': 0.98789984, 'binary_recall': 0.9611264, 'binary_specificity': 0.98820907, 'binary_f1_score': 0.97432923}
confusion matrix:
        0       1
0  137031    1635
1    5399  133487
---- Validation: 
scalar performance:
{'acc': 0.98447376, 'precision': 0.98466897, 'recall': 0.98445565, 'specificity': 0.98445565, 'f1': 0.98447174, 'auroc': 0.99850833, 'binary_precision': 0.9939375, 'binary_recall': 0.9748349, 'binary_specificity': 0.9940764, 'binary_f1_score': 0.9842936}
confusion matrix:
       0      1
0  59239    353
1   1494  57874
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97180897, 'precision': 0.97257143, 'recall': 0.97182405, 'specificity': 0.97182405, 'f1': 0.97179824, 'auroc': 0.99412876, 'binary_precision': 0.9917405, 'binary_recall': 0.951585, 'binary_specificity': 0.9920631, 'binary_f1_score': 0.9712479}
confusion matrix:
       0      1
0  20624    165
1   1008  19812
better model found
persisted
after epoch: 4,now: 2024-07-17 04:43:53.194442,epoch time: 3:14:34.085450,used: 15:31:41.582243,model: dset_te_0_erm_b44271c83_not_commited_2024md_07md_16_13_12_11_seed_0_22014185
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9751758, 'precision': 0.9751762, 'recall': 0.9751755, 'specificity': 0.9751755, 'f1': 0.97517586, 'auroc': 0.9965977, 'binary_precision': 0.97488827, 'binary_recall': 0.97552, 'binary_specificity': 0.97483104, 'binary_f1_score': 0.9752041}
confusion matrix:
        0       1
0  135173    3490
1    3400  135489
---- Validation: 
scalar performance:
{'acc': 0.9814223, 'precision': 0.98142743, 'recall': 0.9814199, 'specificity': 0.9814199, 'f1': 0.9814221, 'auroc': 0.99790204, 'binary_precision': 0.9825903, 'binary_recall': 0.9801408, 'binary_specificity': 0.98269904, 'binary_f1_score': 0.9813641}
confusion matrix:
       0      1
0  58561   1031
1   1179  58189
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9686366, 'precision': 0.9687586, 'recall': 0.9686427, 'specificity': 0.9686427, 'f1': 0.96863484, 'auroc': 0.9924433, 'binary_precision': 0.9765102, 'binary_recall': 0.9604227, 'binary_specificity': 0.9768628, 'binary_f1_score': 0.96839964}
confusion matrix:
       0      1
0  20308    481
1    824  19996
early stop counter: 1
val acc:0.9814223051071167, best validation acc: 0.9844737648963928, corresponding to test acc:                         0.9718089699745178 / 0.9726501703262329
after epoch: 5,now: 2024-07-17 07:35:12.538970,epoch time: 2:51:19.344528,used: 18:23:00.926771,model: dset_te_0_erm_b44271c83_not_commited_2024md_07md_16_13_12_11_seed_0_22014185
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.980555, 'precision': 0.9806343, 'recall': 0.9805603, 'specificity': 0.9805603, 'f1': 0.98055434, 'auroc': 0.99762213, 'binary_precision': 0.98701215, 'binary_recall': 0.9739574, 'binary_specificity': 0.9871632, 'binary_f1_score': 0.98044133}
confusion matrix:
        0       1
0  136884    1780
1    3617  135271
---- Validation: 
scalar performance:
{'acc': 0.9885844, 'precision': 0.98863447, 'recall': 0.9885757, 'specificity': 0.9885757, 'f1': 0.9885839, 'auroc': 0.9990231, 'binary_precision': 0.99313134, 'binary_recall': 0.98393077, 'binary_specificity': 0.99322057, 'binary_f1_score': 0.98850965}
confusion matrix:
       0      1
0  59188    404
1    954  58414
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97632724, 'precision': 0.97670484, 'recall': 0.9763378, 'specificity': 0.9763378, 'f1': 0.9763229, 'auroc': 0.9957504, 'binary_precision': 0.99030995, 'binary_recall': 0.9621037, 'binary_specificity': 0.9905719, 'binary_f1_score': 0.9760031}
confusion matrix:
       0      1
0  20593    196
1    789  20031
new oracle model saved
better model found
persisted
after epoch: 6,now: 2024-07-17 11:03:37.438249,epoch time: 3:28:24.899279,used: 21:51:25.826050,model: dset_te_0_erm_b44271c83_not_commited_2024md_07md_16_13_12_11_seed_0_22014185
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.97878593, 'precision': 0.97891575, 'recall': 0.97879285, 'specificity': 0.97879285, 'f1': 0.9787847, 'auroc': 0.997275, 'binary_precision': 0.9870084, 'binary_recall': 0.9703794, 'binary_specificity': 0.9872063, 'binary_f1_score': 0.9786233}
confusion matrix:
        0       1
0  136888    1774
1    4114  134776
---- Validation: 
scalar performance:
{'acc': 0.98733187, 'precision': 0.9874016, 'recall': 0.9873214, 'specificity': 0.9873214, 'f1': 0.98733115, 'auroc': 0.9987217, 'binary_precision': 0.99277794, 'binary_recall': 0.9817578, 'binary_specificity': 0.99288493, 'binary_f1_score': 0.98723716}
confusion matrix:
       0      1
0  59168    424
1   1083  58285
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.98024464, 'precision': 0.98059344, 'recall': 0.9802548, 'specificity': 0.9802548, 'f1': 0.9802413, 'auroc': 0.99696887, 'binary_precision': 0.993729, 'binary_recall': 0.96661866, 'binary_specificity': 0.993891, 'binary_f1_score': 0.97998637}
confusion matrix:
       0      1
0  20662    127
1    695  20125
new oracle model saved
early stop counter: 1
val acc:0.9873318672180176, best validation acc: 0.9885843992233276, corresponding to test acc:                         0.9763272404670715 / 0.9802446365356445
after epoch: 7,now: 2024-07-17 16:53:34.841933,epoch time: 5:49:57.403684,used: 1 day, 3:41:23.229734,model: dset_te_0_erm_b44271c83_not_commited_2024md_07md_16_13_12_11_seed_0_22014185
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9730573, 'precision': 0.9740182, 'recall': 0.97307575, 'specificity': 0.97307575, 'f1': 0.9730444, 'auroc': 0.99740684, 'binary_precision': 0.9955652, 'binary_recall': 0.95039207, 'binary_specificity': 0.9957595, 'binary_f1_score': 0.9724543}
confusion matrix:
        0       1
0  138075     588
1    6890  131999
---- Validation: 
scalar performance:
{'acc': 0.98041356, 'precision': 0.98100686, 'recall': 0.98038125, 'specificity': 0.98038125, 'f1': 0.9804065, 'auroc': 0.9988242, 'binary_precision': 0.997436, 'binary_recall': 0.96322936, 'binary_specificity': 0.9975332, 'binary_f1_score': 0.9800343}
confusion matrix:
       0      1
0  59445    147
1   2183  57185
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97137636, 'precision': 0.9723941, 'recall': 0.97139376, 'specificity': 0.97139376, 'f1': 0.9713617, 'auroc': 0.9959115, 'binary_precision': 0.99450797, 'binary_recall': 0.9480307, 'binary_specificity': 0.9947568, 'binary_f1_score': 0.9707133}
confusion matrix:
       0      1
0  20680    109
1   1082  19738
early stop counter: 2
val acc:0.980413556098938, best validation acc: 0.9885843992233276, corresponding to test acc:                         0.9763272404670715 / 0.9802446365356445
after epoch: 8,now: 2024-07-17 22:07:53.780121,epoch time: 5:14:18.938188,used: 1 day, 8:55:42.167922,model: dset_te_0_erm_b44271c83_not_commited_2024md_07md_16_13_12_11_seed_0_22014185
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9800614, 'precision': 0.9800956, 'recall': 0.98006487, 'specificity': 0.98006487, 'f1': 0.9800612, 'auroc': 0.99754655, 'binary_precision': 0.9843529, 'binary_recall': 0.97566366, 'binary_specificity': 0.98446614, 'binary_f1_score': 0.97998905}
confusion matrix:
        0       1
0  136511    2154
1    3380  135507
---- Validation: 
scalar performance:
{'acc': 0.9876261, 'precision': 0.9876797, 'recall': 0.987617, 'specificity': 0.987617, 'f1': 0.9876255, 'auroc': 0.9989912, 'binary_precision': 0.9923464, 'binary_recall': 0.98278534, 'binary_specificity': 0.9924486, 'binary_f1_score': 0.9875427}
confusion matrix:
       0      1
0  59142    450
1   1022  58346
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9692855, 'precision': 0.97016287, 'recall': 0.9693017, 'specificity': 0.9693017, 'f1': 0.9692719, 'auroc': 0.9939406, 'binary_precision': 0.99065983, 'binary_recall': 0.9475504, 'binary_specificity': 0.991053, 'binary_f1_score': 0.9686257}
confusion matrix:
       0      1
0  20603    186
1   1092  19728
early stop counter: 3
val acc:0.9876260757446289, best validation acc: 0.9885843992233276, corresponding to test acc:                         0.9763272404670715 / 0.9802446365356445
after epoch: 9,now: 2024-07-18 02:05:07.206500,epoch time: 3:57:13.426379,used: 1 day, 12:52:55.594301,model: dset_te_0_erm_b44271c83_not_commited_2024md_07md_16_13_12_11_seed_0_22014185
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.98065585, 'precision': 0.9806562, 'recall': 0.98065567, 'specificity': 0.98065567, 'f1': 0.9806559, 'auroc': 0.997898, 'binary_precision': 0.98041856, 'binary_recall': 0.98093385, 'binary_specificity': 0.98037744, 'binary_f1_score': 0.9806762}
confusion matrix:
        0       1
0  135946    2721
1    2648  136237
---- Validation: 
scalar performance:
{'acc': 0.9875336, 'precision': 0.9875416, 'recall': 0.9875305, 'specificity': 0.9875305, 'f1': 0.98753345, 'auroc': 0.9987869, 'binary_precision': 0.9891001, 'binary_recall': 0.98588467, 'binary_specificity': 0.9891764, 'binary_f1_score': 0.98748976}
confusion matrix:
       0      1
0  58947    645
1    838  58530
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9755822, 'precision': 0.97571886, 'recall': 0.9755886, 'specificity': 0.9755886, 'f1': 0.97558063, 'auroc': 0.99571764, 'binary_precision': 0.98396873, 'binary_recall': 0.9669548, 'binary_specificity': 0.9842224, 'binary_f1_score': 0.9753876}
confusion matrix:
       0      1
0  20461    328
1    688  20132
early stop counter: 4
val acc:0.9875336289405823, best validation acc: 0.9885843992233276, corresponding to test acc:                         0.9763272404670715 / 0.9802446365356445
after epoch: 10,now: 2024-07-18 05:50:11.374102,epoch time: 3:45:04.167602,used: 1 day, 16:37:59.761903,model: dset_te_0_erm_b44271c83_not_commited_2024md_07md_16_13_12_11_seed_0_22014185
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9826339, 'precision': 0.982646, 'recall': 0.98263603, 'specificity': 0.98263603, 'f1': 0.9826338, 'auroc': 0.99803877, 'binary_precision': 0.98527527, 'binary_recall': 0.97994053, 'binary_specificity': 0.98533154, 'binary_f1_score': 0.9826006}
confusion matrix:
        0       1
0  136631    2034
1    2786  136101
---- Validation: 
scalar performance:
{'acc': 0.98962677, 'precision': 0.9896817, 'recall': 0.9896176, 'specificity': 0.9896176, 'f1': 0.9896263, 'auroc': 0.9992864, 'binary_precision': 0.9944208, 'binary_recall': 0.98473924, 'binary_specificity': 0.9944959, 'binary_f1_score': 0.9895563}
confusion matrix:
       0      1
0  59264    328
1    906  58462
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97156864, 'precision': 0.97253263, 'recall': 0.9715856, 'specificity': 0.9715856, 'f1': 0.9715549, 'auroc': 0.99375, 'binary_precision': 0.9940623, 'binary_recall': 0.94884723, 'binary_specificity': 0.9943239, 'binary_f1_score': 0.97092867}
confusion matrix:
       0      1
0  20671    118
1   1065  19755
better model found
persisted
after epoch: 11,now: 2024-07-18 08:47:48.191725,epoch time: 2:57:36.817623,used: 1 day, 19:35:36.579526,model: dset_te_0_erm_b44271c83_not_commited_2024md_07md_16_13_12_11_seed_0_22014185
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
slurmstepd: error: *** JOB 22014185 ON gpusrv38 CANCELLED AT 2024-07-18T11:34:05 DUE TO TIME LIMIT ***
