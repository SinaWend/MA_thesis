Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Tue Jul 16 11:14:30 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYONWILD_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_nofreezing/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYONWILD_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_nofreezing/rule_results/4.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=4
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/swiglu_ffn.py:51: UserWarning: xFormers is not available (SwiGLU)
  warnings.warn("xFormers is not available (SwiGLU)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/attention.py:33: UserWarning: xFormers is not available (Attention)
  warnings.warn("xFormers is not available (Attention)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/block.py:40: UserWarning: xFormers is not available (Block)
  warnings.warn("xFormers is not available (Block)")
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_0_erm_b44271c83_not_commited_2024md_07md_16_13_12_11_seed_0_22014178

 Experiment start at: 2024-07-16 13:12:11.608069
before training, model accuracy: 0.5626667737960815
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.96460843, 'precision': 0.96510386, 'recall': 0.96462166, 'specificity': 0.96462166, 'f1': 0.9645997, 'auroc': 0.9926621, 'binary_precision': 0.98048484, 'binary_recall': 0.9481449, 'binary_specificity': 0.98109835, 'binary_f1_score': 0.96404374}
confusion matrix:
        0       1
0  136044    2621
1    7202  131685
---- Validation: 
scalar performance:
{'acc': 0.97668123, 'precision': 0.97683954, 'recall': 0.9766648, 'specificity': 0.9766648, 'f1': 0.9766786, 'auroc': 0.99655664, 'binary_precision': 0.9850693, 'binary_recall': 0.9679457, 'binary_specificity': 0.9853839, 'binary_f1_score': 0.9764324}
confusion matrix:
       0      1
0  58721    871
1   1903  57465
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9670985, 'precision': 0.96711826, 'recall': 0.967101, 'specificity': 0.967101, 'f1': 0.96709824, 'auroc': 0.9938595, 'binary_precision': 0.97035354, 'binary_recall': 0.96368873, 'binary_specificity': 0.9705132, 'binary_f1_score': 0.9670097}
confusion matrix:
       0      1
0  20176    613
1    756  20064
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-16 17:49:30.819771,epoch time: 4:37:19.211702,used: 4:37:19.211702,model: dset_te_0_erm_b44271c83_not_commited_2024md_07md_16_13_12_11_seed_0_22014178
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9713531, 'precision': 0.97194004, 'recall': 0.9713675, 'specificity': 0.9713675, 'f1': 0.9713448, 'auroc': 0.9947301, 'binary_precision': 0.9887861, 'binary_recall': 0.9535669, 'binary_specificity': 0.98916805, 'binary_f1_score': 0.9708572}
confusion matrix:
        0       1
0  137162    1502
1    6449  132439
---- Validation: 
scalar performance:
{'acc': 0.98391056, 'precision': 0.984023, 'recall': 0.983897, 'specificity': 0.983897, 'f1': 0.98390925, 'auroc': 0.9979683, 'binary_precision': 0.99094236, 'binary_recall': 0.9766878, 'binary_specificity': 0.9911062, 'binary_f1_score': 0.98376346}
confusion matrix:
       0      1
0  59062    530
1   1384  57984
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9704631, 'precision': 0.97072387, 'recall': 0.970472, 'specificity': 0.970472, 'f1': 0.97045946, 'auroc': 0.99276054, 'binary_precision': 0.9819909, 'binary_recall': 0.9585495, 'binary_specificity': 0.9823945, 'binary_f1_score': 0.97012866}
confusion matrix:
       0      1
0  20423    366
1    863  19957
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-07-16 21:39:50.328804,epoch time: 3:50:19.509033,used: 8:27:38.720735,model: dset_te_0_erm_b44271c83_not_commited_2024md_07md_16_13_12_11_seed_0_22014178
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9755217, 'precision': 0.97569966, 'recall': 0.9755297, 'specificity': 0.9755297, 'f1': 0.97551966, 'auroc': 0.99593115, 'binary_precision': 0.9851047, 'binary_recall': 0.9656846, 'binary_specificity': 0.9853747, 'binary_f1_score': 0.975298}
confusion matrix:
        0       1
0  136636    2028
1    4766  134122
---- Validation: 
scalar performance:
{'acc': 0.98440653, 'precision': 0.9844892, 'recall': 0.984395, 'specificity': 0.984395, 'f1': 0.9844055, 'auroc': 0.9980091, 'binary_precision': 0.99036545, 'binary_recall': 0.9782711, 'binary_specificity': 0.99051887, 'binary_f1_score': 0.9842811}
confusion matrix:
       0      1
0  59027    565
1   1290  58078
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9740681, 'precision': 0.9744313, 'recall': 0.97407854, 'specificity': 0.97407854, 'f1': 0.9740635, 'auroc': 0.9941187, 'binary_precision': 0.9877452, 'binary_recall': 0.96008646, 'binary_specificity': 0.9880706, 'binary_f1_score': 0.9737195}
confusion matrix:
       0      1
0  20541    248
1    831  19989
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-07-17 01:29:19.323850,epoch time: 3:49:28.995046,used: 12:17:07.715781,model: dset_te_0_erm_b44271c83_not_commited_2024md_07md_16_13_12_11_seed_0_22014178
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.97149724, 'precision': 0.97181034, 'recall': 0.97150755, 'specificity': 0.97150755, 'f1': 0.9714929, 'auroc': 0.99507606, 'binary_precision': 0.9841637, 'binary_recall': 0.95846236, 'binary_specificity': 0.9845528, 'binary_f1_score': 0.971143}
confusion matrix:
        0       1
0  136524    2142
1    5769  133117
---- Validation: 
scalar performance:
{'acc': 0.9805565, 'precision': 0.98087454, 'recall': 0.980533, 'specificity': 0.980533, 'f1': 0.98055255, 'auroc': 0.99799013, 'binary_precision': 0.99277955, 'binary_recall': 0.96808046, 'binary_specificity': 0.9929856, 'binary_f1_score': 0.9802745}
confusion matrix:
       0      1
0  59174    418
1   1895  57473
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.965344, 'precision': 0.96619105, 'recall': 0.96536005, 'specificity': 0.96536005, 'f1': 0.96532905, 'auroc': 0.9906217, 'binary_precision': 0.98624915, 'binary_recall': 0.9439001, 'binary_specificity': 0.98682, 'binary_f1_score': 0.96461}
confusion matrix:
       0      1
0  20515    274
1   1168  19652
early stop counter: 1
val acc:0.9805564880371094, best validation acc: 0.9844065308570862, corresponding to test acc:                         0.9740681052207947 / 0.9740681052207947
after epoch: 4,now: 2024-07-17 04:43:52.959092,epoch time: 3:14:33.635242,used: 15:31:41.351023,model: dset_te_0_erm_b44271c83_not_commited_2024md_07md_16_13_12_11_seed_0_22014178
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.97703135, 'precision': 0.9771267, 'recall': 0.97702575, 'specificity': 0.97702575, 'f1': 0.9770299, 'auroc': 0.99747884, 'binary_precision': 0.97058195, 'binary_recall': 0.9839224, 'binary_specificity': 0.970129, 'binary_f1_score': 0.97720665}
confusion matrix:
        0       1
0  134521    4142
1    2233  136656
---- Validation: 
scalar performance:
{'acc': 0.9859785, 'precision': 0.98597896, 'recall': 0.98598063, 'specificity': 0.98598063, 'f1': 0.9859785, 'auroc': 0.9986416, 'binary_precision': 0.9848251, 'binary_recall': 0.98711425, 'binary_specificity': 0.98484695, 'binary_f1_score': 0.98596835}
confusion matrix:
       0      1
0  58689    903
1    765  58603
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97257805, 'precision': 0.97267216, 'recall': 0.9725834, 'specificity': 0.9725834, 'f1': 0.97257686, 'auroc': 0.99293494, 'binary_precision': 0.97953117, 'binary_recall': 0.9653698, 'binary_specificity': 0.979797, 'binary_f1_score': 0.97239894}
confusion matrix:
       0      1
0  20369    420
1    721  20099
better model found
persisted
after epoch: 5,now: 2024-07-17 07:35:21.209103,epoch time: 2:51:28.250011,used: 18:23:09.601034,model: dset_te_0_erm_b44271c83_not_commited_2024md_07md_16_13_12_11_seed_0_22014178
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9771214, 'precision': 0.9774172, 'recall': 0.9771316, 'specificity': 0.9771316, 'f1': 0.97711825, 'auroc': 0.99698114, 'binary_precision': 0.9895036, 'binary_recall': 0.964511, 'binary_specificity': 0.98975223, 'binary_f1_score': 0.9768475}
confusion matrix:
        0       1
0  137243    1421
1    4929  133959
---- Validation: 
scalar performance:
{'acc': 0.98607934, 'precision': 0.986277, 'recall': 0.9860612, 'specificity': 0.9860612, 'f1': 0.98607755, 'auroc': 0.99881667, 'binary_precision': 0.9956202, 'binary_recall': 0.97640145, 'binary_specificity': 0.9957209, 'binary_f1_score': 0.9859172}
confusion matrix:
       0      1
0  59337    255
1   1401  57967
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97639936, 'precision': 0.97693706, 'recall': 0.97641194, 'specificity': 0.97641194, 'f1': 0.9763931, 'auroc': 0.9953636, 'binary_precision': 0.9931391, 'binary_recall': 0.95946205, 'binary_specificity': 0.9933619, 'binary_f1_score': 0.9760101}
confusion matrix:
       0      1
0  20651    138
1    844  19976
new oracle model saved
better model found
persisted
after epoch: 6,now: 2024-07-17 11:03:37.512744,epoch time: 3:28:16.303641,used: 21:51:25.904675,model: dset_te_0_erm_b44271c83_not_commited_2024md_07md_16_13_12_11_seed_0_22014178
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.98010826, 'precision': 0.9802015, 'recall': 0.9801141, 'specificity': 0.9801141, 'f1': 0.9801074, 'auroc': 0.99752027, 'binary_precision': 0.9871002, 'binary_recall': 0.9729642, 'binary_specificity': 0.987264, 'binary_f1_score': 0.97998124}
confusion matrix:
        0       1
0  136896    1766
1    3755  135135
---- Validation: 
scalar performance:
{'acc': 0.9879035, 'precision': 0.9879577, 'recall': 0.98789436, 'specificity': 0.98789436, 'f1': 0.987903, 'auroc': 0.9988295, 'binary_precision': 0.9926522, 'binary_recall': 0.983038, 'binary_specificity': 0.9927507, 'binary_f1_score': 0.98782176}
confusion matrix:
       0      1
0  59160    432
1   1007  58361
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9766637, 'precision': 0.97713745, 'recall': 0.9766755, 'specificity': 0.9766755, 'f1': 0.97665834, 'auroc': 0.9955317, 'binary_precision': 0.99236, 'binary_recall': 0.96075886, 'binary_specificity': 0.9925922, 'binary_f1_score': 0.9763038}
confusion matrix:
       0      1
0  20635    154
1    817  20003
new oracle model saved
better model found
persisted
after epoch: 7,now: 2024-07-17 16:53:35.290127,epoch time: 5:49:57.777383,used: 1 day, 3:41:23.682058,model: dset_te_0_erm_b44271c83_not_commited_2024md_07md_16_13_12_11_seed_0_22014178
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9748119, 'precision': 0.97564363, 'recall': 0.9748291, 'specificity': 0.9748291, 'f1': 0.97480154, 'auroc': 0.99745893, 'binary_precision': 0.99573785, 'binary_recall': 0.9537472, 'binary_specificity': 0.99591094, 'binary_f1_score': 0.9742903}
confusion matrix:
        0       1
0  138096     567
1    6424  132465
---- Validation: 
scalar performance:
{'acc': 0.9813887, 'precision': 0.981919, 'recall': 0.98135823, 'specificity': 0.98135823, 'f1': 0.98138267, 'auroc': 0.99884355, 'binary_precision': 0.9974412, 'binary_recall': 0.96518326, 'binary_specificity': 0.9975332, 'binary_f1_score': 0.98104715}
confusion matrix:
       0      1
0  59445    147
1   2067  57301
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.971112, 'precision': 0.9722892, 'recall': 0.9711307, 'specificity': 0.9711307, 'f1': 0.97109485, 'auroc': 0.9947202, 'binary_precision': 0.9960554, 'binary_recall': 0.94601345, 'binary_specificity': 0.996248, 'binary_f1_score': 0.9703898}
confusion matrix:
       0      1
0  20711     78
1   1124  19696
early stop counter: 1
val acc:0.9813886880874634, best validation acc: 0.9879034757614136, corresponding to test acc:                         0.9766637086868286 / 0.9766637086868286
after epoch: 8,now: 2024-07-17 22:07:53.899339,epoch time: 5:14:18.609212,used: 1 day, 8:55:42.291270,model: dset_te_0_erm_b44271c83_not_commited_2024md_07md_16_13_12_11_seed_0_22014178
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9826663, 'precision': 0.98269033, 'recall': 0.9826693, 'specificity': 0.9826693, 'f1': 0.9826662, 'auroc': 0.9978765, 'binary_precision': 0.98630416, 'binary_recall': 0.97895414, 'binary_specificity': 0.98638445, 'binary_f1_score': 0.9826154}
confusion matrix:
        0       1
0  136777    1888
1    2923  135964
---- Validation: 
scalar performance:
{'acc': 0.9892737, 'precision': 0.9893024, 'recall': 0.9892673, 'specificity': 0.9892673, 'f1': 0.9892734, 'auroc': 0.99905545, 'binary_precision': 0.9926057, 'binary_recall': 0.985851, 'binary_specificity': 0.9926836, 'binary_f1_score': 0.98921674}
confusion matrix:
       0      1
0  59156    436
1    840  58528
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9757985, 'precision': 0.9763652, 'recall': 0.9758115, 'specificity': 0.9758115, 'f1': 0.9757918, 'auroc': 0.99603665, 'binary_precision': 0.99298334, 'binary_recall': 0.9584054, 'binary_specificity': 0.9932176, 'binary_f1_score': 0.97538805}
confusion matrix:
       0      1
0  20648    141
1    866  19954
better model found
persisted
after epoch: 9,now: 2024-07-18 02:05:07.423652,epoch time: 3:57:13.524313,used: 1 day, 12:52:55.815583,model: dset_te_0_erm_b44271c83_not_commited_2024md_07md_16_13_12_11_seed_0_22014178
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9752659, 'precision': 0.97548574, 'recall': 0.97525764, 'specificity': 0.97525764, 'f1': 0.97526276, 'auroc': 0.9976814, 'binary_precision': 0.9654557, 'binary_recall': 0.98584443, 'binary_specificity': 0.9646708, 'binary_f1_score': 0.97554356}
confusion matrix:
        0       1
0  133768    4899
1    1966  136919
---- Validation: 
scalar performance:
{'acc': 0.98674345, 'precision': 0.9867443, 'recall': 0.98674583, 'specificity': 0.98674583, 'f1': 0.98674345, 'auroc': 0.9990014, 'binary_precision': 0.9854673, 'binary_recall': 0.988007, 'binary_specificity': 0.9854846, 'binary_f1_score': 0.9867355}
confusion matrix:
       0      1
0  58727    865
1    712  58656
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97180897, 'precision': 0.97192174, 'recall': 0.9718149, 'specificity': 0.9718149, 'f1': 0.9718075, 'auroc': 0.99347377, 'binary_precision': 0.9794056, 'binary_recall': 0.96392894, 'binary_specificity': 0.9797008, 'binary_f1_score': 0.9716056}
confusion matrix:
       0      1
0  20367    422
1    751  20069
early stop counter: 1
val acc:0.9867434501647949, best validation acc: 0.989273726940155, corresponding to test acc:                         0.975798487663269 / 0.9766637086868286
after epoch: 10,now: 2024-07-18 05:50:11.376609,epoch time: 3:45:03.952957,used: 1 day, 16:37:59.768540,model: dset_te_0_erm_b44271c83_not_commited_2024md_07md_16_13_12_11_seed_0_22014178
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9806883, 'precision': 0.9806926, 'recall': 0.98068726, 'specificity': 0.98068726, 'f1': 0.9806882, 'auroc': 0.997991, 'binary_precision': 0.9794334, 'binary_recall': 0.98202854, 'binary_specificity': 0.9793459, 'binary_f1_score': 0.9807292}
confusion matrix:
        0       1
0  135801    2864
1    2496  136391
---- Validation: 
scalar performance:
{'acc': 0.9895007, 'precision': 0.989521, 'recall': 0.9894954, 'specificity': 0.9894954, 'f1': 0.9895004, 'auroc': 0.99912894, 'binary_precision': 0.9922419, 'binary_recall': 0.98667634, 'binary_specificity': 0.9923144, 'binary_f1_score': 0.9894512}
confusion matrix:
       0      1
0  59134    458
1    791  58577
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9736355, 'precision': 0.973976, 'recall': 0.9736456, 'specificity': 0.9736456, 'f1': 0.97363114, 'auroc': 0.99457514, 'binary_precision': 0.9868674, 'binary_recall': 0.96008646, 'binary_specificity': 0.9872048, 'binary_f1_score': 0.97329277}
confusion matrix:
       0      1
0  20523    266
1    831  19989
better model found
persisted
after epoch: 11,now: 2024-07-18 08:47:48.185885,epoch time: 2:57:36.809276,used: 1 day, 19:35:36.577816,model: dset_te_0_erm_b44271c83_not_commited_2024md_07md_16_13_12_11_seed_0_22014178
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
slurmstepd: error: *** JOB 22014178 ON gpusrv35 CANCELLED AT 2024-07-18T11:14:30 DUE TO TIME LIMIT ***
