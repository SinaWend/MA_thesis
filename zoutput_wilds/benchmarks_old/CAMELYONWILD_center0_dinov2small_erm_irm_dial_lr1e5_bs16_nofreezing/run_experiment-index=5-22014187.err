Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Tue Jul 16 11:34:19 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYONWILD_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_nofreezing/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYONWILD_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_nofreezing/rule_results/5.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=5
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/swiglu_ffn.py:51: UserWarning: xFormers is not available (SwiGLU)
  warnings.warn("xFormers is not available (SwiGLU)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/attention.py:33: UserWarning: xFormers is not available (Attention)
  warnings.warn("xFormers is not available (Attention)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/block.py:40: UserWarning: xFormers is not available (Block)
  warnings.warn("xFormers is not available (Block)")
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_0_erm_b44271c83_not_commited_2024md_07md_16_13_12_11_seed_0_22014187

 Experiment start at: 2024-07-16 13:12:11.612237
before training, model accuracy: 0.5626667737960815
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9663811, 'precision': 0.96666497, 'recall': 0.9663911, 'specificity': 0.9663911, 'f1': 0.9663764, 'auroc': 0.9933325, 'binary_precision': 0.9783771, 'binary_recall': 0.9538978, 'binary_specificity': 0.97888434, 'binary_f1_score': 0.96598244}
confusion matrix:
        0       1
0  135737    2928
1    6403  132484
---- Validation: 
scalar performance:
{'acc': 0.97987556, 'precision': 0.97996897, 'recall': 0.97986317, 'specificity': 0.97986317, 'f1': 0.97987413, 'auroc': 0.9972025, 'binary_precision': 0.9862093, 'binary_recall': 0.97328526, 'binary_specificity': 0.98644114, 'binary_f1_score': 0.9797046}
confusion matrix:
       0      1
0  58784    808
1   1586  57782
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9671225, 'precision': 0.9671314, 'recall': 0.967121, 'specificity': 0.967121, 'f1': 0.96712226, 'auroc': 0.9943715, 'binary_precision': 0.9652698, 'binary_recall': 0.96916425, 'binary_specificity': 0.9650777, 'binary_f1_score': 0.9672131}
confusion matrix:
       0      1
0  20063    726
1    642  20178
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-16 17:49:30.819575,epoch time: 4:37:19.207338,used: 4:37:19.207338,model: dset_te_0_erm_b44271c83_not_commited_2024md_07md_16_13_12_11_seed_0_22014187
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.96914095, 'precision': 0.9700939, 'recall': 0.96915925, 'specificity': 0.96915925, 'f1': 0.9691261, 'auroc': 0.9952169, 'binary_precision': 0.99146223, 'binary_recall': 0.94648206, 'binary_specificity': 0.99183637, 'binary_f1_score': 0.9684501}
confusion matrix:
        0       1
0  137532    1132
1    7433  131455
---- Validation: 
scalar performance:
{'acc': 0.98101044, 'precision': 0.9813595, 'recall': 0.9809858, 'specificity': 0.9809858, 'f1': 0.9810062, 'auroc': 0.9977777, 'binary_precision': 0.9938601, 'binary_recall': 0.9679288, 'binary_specificity': 0.9940428, 'binary_f1_score': 0.98072314}
confusion matrix:
       0      1
0  59237    355
1   1904  57464
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97039104, 'precision': 0.97110987, 'recall': 0.9704057, 'specificity': 0.9704057, 'f1': 0.97038037, 'auroc': 0.9938277, 'binary_precision': 0.9897, 'binary_recall': 0.9507205, 'binary_specificity': 0.9900909, 'binary_f1_score': 0.9698188}
confusion matrix:
       0      1
0  20583    206
1   1026  19794
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-07-16 21:39:50.112392,epoch time: 3:50:19.292817,used: 8:27:38.500155,model: dset_te_0_erm_b44271c83_not_commited_2024md_07md_16_13_12_11_seed_0_22014187
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.97220343, 'precision': 0.9722563, 'recall': 0.9722078, 'specificity': 0.9722078, 'f1': 0.9722028, 'auroc': 0.9954473, 'binary_precision': 0.9774615, 'binary_recall': 0.966743, 'binary_specificity': 0.97767264, 'binary_f1_score': 0.9720727}
confusion matrix:
        0       1
0  135568    3096
1    4619  134269
---- Validation: 
scalar performance:
{'acc': 0.98414594, 'precision': 0.984186, 'recall': 0.98413813, 'specificity': 0.98413813, 'f1': 0.9841454, 'auroc': 0.9982133, 'binary_precision': 0.988145, 'binary_recall': 0.97998923, 'binary_specificity': 0.98828703, 'binary_f1_score': 0.9840502}
confusion matrix:
       0      1
0  58894    698
1   1188  58180
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9681079, 'precision': 0.9685819, 'recall': 0.96811986, 'specificity': 0.96811986, 'f1': 0.96810037, 'auroc': 0.9924199, 'binary_precision': 0.9836733, 'binary_recall': 0.95206535, 'binary_specificity': 0.9841743, 'binary_f1_score': 0.96761125}
confusion matrix:
       0      1
0  20460    329
1    998  19822
better model found
persisted
after epoch: 3,now: 2024-07-17 01:29:19.075224,epoch time: 3:49:28.962832,used: 12:17:07.462987,model: dset_te_0_erm_b44271c83_not_commited_2024md_07md_16_13_12_11_seed_0_22014187
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9755109, 'precision': 0.9758136, 'recall': 0.975521, 'specificity': 0.975521, 'f1': 0.9755074, 'auroc': 0.996477, 'binary_precision': 0.98801476, 'binary_recall': 0.9627392, 'binary_specificity': 0.9883028, 'binary_f1_score': 0.9752132}
confusion matrix:
        0       1
0  137044    1622
1    5175  133711
---- Validation: 
scalar performance:
{'acc': 0.9842888, 'precision': 0.9845289, 'recall': 0.98426867, 'specificity': 0.98426867, 'f1': 0.9842863, 'auroc': 0.9986516, 'binary_precision': 0.99485344, 'binary_recall': 0.9735548, 'binary_specificity': 0.99498254, 'binary_f1_score': 0.98408884}
confusion matrix:
       0      1
0  59293    299
1   1570  57798
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97534186, 'precision': 0.9758662, 'recall': 0.9753543, 'specificity': 0.9753543, 'f1': 0.97533554, 'auroc': 0.9952653, 'binary_precision': 0.9918497, 'binary_recall': 0.9585975, 'binary_specificity': 0.9921112, 'binary_f1_score': 0.9749401}
confusion matrix:
       0      1
0  20625    164
1    862  19958
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-07-17 04:43:53.398451,epoch time: 3:14:34.323227,used: 15:31:41.786214,model: dset_te_0_erm_b44271c83_not_commited_2024md_07md_16_13_12_11_seed_0_22014187
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.97844726, 'precision': 0.9784478, 'recall': 0.97844696, 'specificity': 0.97844696, 'f1': 0.97844726, 'auroc': 0.99720216, 'binary_precision': 0.97809994, 'binary_recall': 0.97884643, 'binary_specificity': 0.9780475, 'binary_f1_score': 0.978473}
confusion matrix:
        0       1
0  135619    3044
1    2938  135951
---- Validation: 
scalar performance:
{'acc': 0.98562545, 'precision': 0.98563635, 'recall': 0.9856217, 'specificity': 0.9856217, 'f1': 0.9856252, 'auroc': 0.9985342, 'binary_precision': 0.98751986, 'binary_recall': 0.98362756, 'binary_specificity': 0.98761576, 'binary_f1_score': 0.98556983}
confusion matrix:
       0      1
0  58854    738
1    972  58396
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9702468, 'precision': 0.97048557, 'recall': 0.9702553, 'specificity': 0.9702553, 'f1': 0.97024345, 'auroc': 0.9930639, 'binary_precision': 0.9812721, 'binary_recall': 0.9588376, 'binary_specificity': 0.981673, 'binary_f1_score': 0.96992517}
confusion matrix:
       0      1
0  20408    381
1    857  19963
better model found
persisted
after epoch: 5,now: 2024-07-17 07:35:12.689128,epoch time: 2:51:19.290677,used: 18:23:01.076891,model: dset_te_0_erm_b44271c83_not_commited_2024md_07md_16_13_12_11_seed_0_22014187
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9805118, 'precision': 0.98062587, 'recall': 0.9805181, 'specificity': 0.9805181, 'f1': 0.9805107, 'auroc': 0.99751717, 'binary_precision': 0.9882366, 'binary_recall': 0.97263265, 'binary_specificity': 0.9884036, 'binary_f1_score': 0.9803725}
confusion matrix:
        0       1
0  137056    1608
1    3801  135087
---- Validation: 
scalar performance:
{'acc': 0.9888534, 'precision': 0.9889333, 'recall': 0.9888421, 'specificity': 0.9888421, 'f1': 0.9888527, 'auroc': 0.9991252, 'binary_precision': 0.9947324, 'binary_recall': 0.98286957, 'binary_specificity': 0.99481475, 'binary_f1_score': 0.98876536}
confusion matrix:
       0      1
0  59283    309
1   1017  58351
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97611094, 'precision': 0.97653496, 'recall': 0.97612214, 'specificity': 0.97612214, 'f1': 0.97610605, 'auroc': 0.99588645, 'binary_precision': 0.990937, 'binary_recall': 0.96104705, 'binary_specificity': 0.9911973, 'binary_f1_score': 0.9757632}
confusion matrix:
       0      1
0  20606    183
1    811  20009
new oracle model saved
better model found
persisted
after epoch: 6,now: 2024-07-17 11:03:37.629155,epoch time: 3:28:24.940027,used: 21:51:26.016918,model: dset_te_0_erm_b44271c83_not_commited_2024md_07md_16_13_12_11_seed_0_22014187
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.980591, 'precision': 0.980636, 'recall': 0.9805952, 'specificity': 0.9805952, 'f1': 0.9805907, 'auroc': 0.997542, 'binary_precision': 0.98549724, 'binary_recall': 0.9755706, 'binary_specificity': 0.9856197, 'binary_f1_score': 0.98050874}
confusion matrix:
        0       1
0  136668    1994
1    3393  135497
---- Validation: 
scalar performance:
{'acc': 0.98760927, 'precision': 0.98765624, 'recall': 0.9876008, 'specificity': 0.9876008, 'f1': 0.9876088, 'auroc': 0.99884534, 'binary_precision': 0.9919947, 'binary_recall': 0.98310536, 'binary_specificity': 0.99209625, 'binary_f1_score': 0.98753}
confusion matrix:
       0      1
0  59121    471
1   1003  58365
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97949964, 'precision': 0.97976303, 'recall': 0.9795085, 'specificity': 0.9795085, 'f1': 0.9794971, 'auroc': 0.99607015, 'binary_precision': 0.9911931, 'binary_recall': 0.9676273, 'binary_specificity': 0.9913897, 'binary_f1_score': 0.97926843}
confusion matrix:
       0      1
0  20610    179
1    674  20146
new oracle model saved
early stop counter: 1
val acc:0.9876092672348022, best validation acc: 0.988853394985199, corresponding to test acc:                         0.9761109352111816 / 0.9794996380805969
after epoch: 7,now: 2024-07-17 16:53:35.005697,epoch time: 5:49:57.376542,used: 1 day, 3:41:23.393460,model: dset_te_0_erm_b44271c83_not_commited_2024md_07md_16_13_12_11_seed_0_22014187
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9743796, 'precision': 0.9751614, 'recall': 0.9743962, 'specificity': 0.9743962, 'f1': 0.97436976, 'auroc': 0.9974978, 'binary_precision': 0.9946399, 'binary_recall': 0.95394164, 'binary_specificity': 0.9948508, 'binary_f1_score': 0.9738658}
confusion matrix:
        0       1
0  137949     714
1    6397  132492
---- Validation: 
scalar performance:
{'acc': 0.9812542, 'precision': 0.98176515, 'recall': 0.9812243, 'specificity': 0.9812243, 'f1': 0.98124826, 'auroc': 0.9987289, 'binary_precision': 0.99699044, 'binary_recall': 0.9653517, 'binary_specificity': 0.9970969, 'binary_f1_score': 0.98091596}
confusion matrix:
       0      1
0  59419    173
1   2057  57311
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9707035, 'precision': 0.97172403, 'recall': 0.9707209, 'specificity': 0.9707209, 'f1': 0.97068834, 'auroc': 0.99533296, 'binary_precision': 0.9938524, 'binary_recall': 0.94731027, 'binary_specificity': 0.9941315, 'binary_f1_score': 0.9700234}
confusion matrix:
       0      1
0  20667    122
1   1097  19723
early stop counter: 2
val acc:0.9812542200088501, best validation acc: 0.988853394985199, corresponding to test acc:                         0.9761109352111816 / 0.9794996380805969
after epoch: 8,now: 2024-07-17 22:07:53.816544,epoch time: 5:14:18.810847,used: 1 day, 8:55:42.204307,model: dset_te_0_erm_b44271c83_not_commited_2024md_07md_16_13_12_11_seed_0_22014187
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.98187727, 'precision': 0.98199993, 'recall': 0.98188376, 'specificity': 0.98188376, 'f1': 0.98187625, 'auroc': 0.99774563, 'binary_precision': 0.9898916, 'binary_recall': 0.97372687, 'binary_specificity': 0.9900407, 'binary_f1_score': 0.9817427}
confusion matrix:
        0       1
0  137284    1381
1    3649  135238
---- Validation: 
scalar performance:
{'acc': 0.9874664, 'precision': 0.9875576, 'recall': 0.9874543, 'specificity': 0.9874543, 'f1': 0.98746556, 'auroc': 0.99878275, 'binary_precision': 0.9937721, 'binary_recall': 0.98103356, 'binary_specificity': 0.993875, 'binary_f1_score': 0.9873618}
confusion matrix:
       0      1
0  59227    365
1   1126  58242
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97555816, 'precision': 0.97628295, 'recall': 0.9755728, 'specificity': 0.9755728, 'f1': 0.97554946, 'auroc': 0.996279, 'binary_precision': 0.99505025, 'binary_recall': 0.95590776, 'binary_specificity': 0.9952379, 'binary_f1_score': 0.9750864}
confusion matrix:
       0      1
0  20690     99
1    918  19902
early stop counter: 3
val acc:0.9874663949012756, best validation acc: 0.988853394985199, corresponding to test acc:                         0.9761109352111816 / 0.9794996380805969
after epoch: 9,now: 2024-07-18 02:05:07.121347,epoch time: 3:57:13.304803,used: 1 day, 12:52:55.509110,model: dset_te_0_erm_b44271c83_not_commited_2024md_07md_16_13_12_11_seed_0_22014187
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9775466, 'precision': 0.97763157, 'recall': 0.97754145, 'specificity': 0.97754145, 'f1': 0.9775454, 'auroc': 0.9976995, 'binary_precision': 0.97145396, 'binary_recall': 0.9840444, 'binary_specificity': 0.9710385, 'binary_f1_score': 0.97770864}
confusion matrix:
        0       1
0  134651    4016
1    2216  136669
---- Validation: 
scalar performance:
{'acc': 0.9871806, 'precision': 0.9871805, 'recall': 0.98718053, 'specificity': 0.98718053, 'f1': 0.98718053, 'auroc': 0.9987976, 'binary_precision': 0.98714817, 'binary_recall': 0.9871648, 'binary_specificity': 0.98719627, 'binary_f1_score': 0.9871565}
confusion matrix:
       0      1
0  58829    763
1    762  58606
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9738758, 'precision': 0.97388494, 'recall': 0.97387755, 'specificity': 0.97387755, 'f1': 0.97387576, 'auroc': 0.9953793, 'binary_precision': 0.97615945, 'binary_recall': 0.97151774, 'binary_specificity': 0.9762374, 'binary_f1_score': 0.9738331}
confusion matrix:
       0      1
0  20295    494
1    593  20227
early stop counter: 4
val acc:0.9871805906295776, best validation acc: 0.988853394985199, corresponding to test acc:                         0.9761109352111816 / 0.9794996380805969
after epoch: 10,now: 2024-07-18 05:50:11.368336,epoch time: 3:45:04.246989,used: 1 day, 16:37:59.756099,model: dset_te_0_erm_b44271c83_not_commited_2024md_07md_16_13_12_11_seed_0_22014187
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.982515, 'precision': 0.9825429, 'recall': 0.9825182, 'specificity': 0.9825182, 'f1': 0.98251486, 'auroc': 0.9980724, 'binary_precision': 0.98641294, 'binary_recall': 0.9785365, 'binary_specificity': 0.98649985, 'binary_f1_score': 0.98245895}
confusion matrix:
        0       1
0  136793    1872
1    2981  135906
---- Validation: 
scalar performance:
{'acc': 0.9891308, 'precision': 0.9891765, 'recall': 0.9891225, 'specificity': 0.9891225, 'f1': 0.9891303, 'auroc': 0.99915266, 'binary_precision': 0.9934574, 'binary_recall': 0.98470557, 'binary_specificity': 0.9935394, 'binary_f1_score': 0.9890621}
confusion matrix:
       0      1
0  59207    385
1    908  58460
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9694297, 'precision': 0.9705579, 'recall': 0.96944803, 'specificity': 0.96944803, 'f1': 0.9694122, 'auroc': 0.9926778, 'binary_precision': 0.993786, 'binary_recall': 0.94481266, 'binary_specificity': 0.9940834, 'binary_f1_score': 0.96868074}
confusion matrix:
       0      1
0  20666    123
1   1149  19671
better model found
persisted
after epoch: 11,now: 2024-07-18 08:47:48.250379,epoch time: 2:57:36.882043,used: 1 day, 19:35:36.638142,model: dset_te_0_erm_b44271c83_not_commited_2024md_07md_16_13_12_11_seed_0_22014187
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
slurmstepd: error: *** JOB 22014187 ON gpusrv38 CANCELLED AT 2024-07-18T11:34:05 DUE TO TIME LIMIT ***
