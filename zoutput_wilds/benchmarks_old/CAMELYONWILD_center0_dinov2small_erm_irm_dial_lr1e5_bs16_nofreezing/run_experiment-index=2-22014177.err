Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Tue Jul 16 11:14:27 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYONWILD_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_nofreezing/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYONWILD_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_nofreezing/rule_results/2.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=2
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/swiglu_ffn.py:51: UserWarning: xFormers is not available (SwiGLU)
  warnings.warn("xFormers is not available (SwiGLU)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/attention.py:33: UserWarning: xFormers is not available (Attention)
  warnings.warn("xFormers is not available (Attention)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/block.py:40: UserWarning: xFormers is not available (Block)
  warnings.warn("xFormers is not available (Block)")
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_0_erm_b44271c83_not_commited_2024md_07md_16_13_12_11_seed_0_22014177

 Experiment start at: 2024-07-16 13:12:11.605553
before training, model accuracy: 0.5626667737960815
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9664387, 'precision': 0.96676356, 'recall': 0.9664494, 'specificity': 0.9664494, 'f1': 0.9664334, 'auroc': 0.99307466, 'binary_precision': 0.97927856, 'binary_recall': 0.95309854, 'binary_specificity': 0.9798002, 'binary_f1_score': 0.96601117}
confusion matrix:
        0       1
0  135864    2801
1    6514  132373
---- Validation: 
scalar performance:
{'acc': 0.9774798, 'precision': 0.9775211, 'recall': 0.97747177, 'specificity': 0.97747177, 'f1': 0.977479, 'auroc': 0.9966811, 'binary_precision': 0.981517, 'binary_recall': 0.97320104, 'binary_specificity': 0.9817425, 'binary_f1_score': 0.9773413}
confusion matrix:
       0      1
0  58504   1088
1   1591  57777
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9632291, 'precision': 0.9635023, 'recall': 0.9632202, 'specificity': 0.9632202, 'f1': 0.9632232, 'auroc': 0.9944926, 'binary_precision': 0.95243454, 'binary_recall': 0.97521615, 'binary_specificity': 0.9512242, 'binary_f1_score': 0.96369076}
confusion matrix:
       0      1
0  19775   1014
1    516  20304
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-16 17:49:30.913793,epoch time: 4:37:19.308240,used: 4:37:19.308240,model: dset_te_0_erm_b44271c83_not_commited_2024md_07md_16_13_12_11_seed_0_22014177
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9697318, 'precision': 0.9705819, 'recall': 0.9697491, 'specificity': 0.9697491, 'f1': 0.96971893, 'auroc': 0.9951658, 'binary_precision': 0.9907851, 'binary_recall': 0.9483325, 'binary_specificity': 0.9911657, 'binary_f1_score': 0.9690941}
confusion matrix:
        0       1
0  137439    1225
1    7176  131712
---- Validation: 
scalar performance:
{'acc': 0.9793544, 'precision': 0.9797158, 'recall': 0.97932935, 'specificity': 0.97932935, 'f1': 0.9793497, 'auroc': 0.9974761, 'binary_precision': 0.99242055, 'binary_recall': 0.9660086, 'binary_specificity': 0.99265003, 'binary_f1_score': 0.9790365}
confusion matrix:
       0      1
0  59154    438
1   2018  57350
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9706794, 'precision': 0.9707885, 'recall': 0.9706852, 'specificity': 0.9706852, 'f1': 0.970678, 'auroc': 0.99402153, 'binary_precision': 0.9781421, 'binary_recall': 0.96292025, 'binary_specificity': 0.9784501, 'binary_f1_score': 0.9704715}
confusion matrix:
       0      1
0  20341    448
1    772  20048
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-07-16 21:39:50.514497,epoch time: 3:50:19.600704,used: 8:27:38.908944,model: dset_te_0_erm_b44271c83_not_commited_2024md_07md_16_13_12_11_seed_0_22014177
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.96990114, 'precision': 0.9699037, 'recall': 0.9699003, 'specificity': 0.9699003, 'f1': 0.96990097, 'auroc': 0.99475956, 'binary_precision': 0.9689934, 'binary_recall': 0.970919, 'binary_specificity': 0.9688816, 'binary_f1_score': 0.96995527}
confusion matrix:
        0       1
0  134349    4315
1    4039  134849
---- Validation: 
scalar performance:
{'acc': 0.9818006, 'precision': 0.98180056, 'recall': 0.98180056, 'specificity': 0.98180056, 'f1': 0.98180056, 'auroc': 0.9976878, 'binary_precision': 0.9817582, 'binary_recall': 0.9817747, 'binary_specificity': 0.9818264, 'binary_f1_score': 0.9817664}
confusion matrix:
       0      1
0  58509   1083
1   1082  58286
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96527195, 'precision': 0.96537006, 'recall': 0.9652666, 'specificity': 0.9652666, 'f1': 0.9652698, 'auroc': 0.99382377, 'binary_precision': 0.95879704, 'binary_recall': 0.9723823, 'binary_specificity': 0.9581509, 'binary_f1_score': 0.9655419}
confusion matrix:
       0      1
0  19919    870
1    575  20245
better model found
persisted
after epoch: 3,now: 2024-07-17 01:29:19.206370,epoch time: 3:49:28.691873,used: 12:17:07.600817,model: dset_te_0_erm_b44271c83_not_commited_2024md_07md_16_13_12_11_seed_0_22014177
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.97644407, 'precision': 0.97660005, 'recall': 0.9764514, 'specificity': 0.9764514, 'f1': 0.97644234, 'auroc': 0.9963982, 'binary_precision': 0.9854242, 'binary_recall': 0.9672321, 'binary_specificity': 0.9856706, 'binary_f1_score': 0.97624344}
confusion matrix:
        0       1
0  136679    1987
1    4551  134335
---- Validation: 
scalar performance:
{'acc': 0.98523873, 'precision': 0.98538053, 'recall': 0.9852234, 'specificity': 0.9852234, 'f1': 0.98523724, 'auroc': 0.9986923, 'binary_precision': 0.9932196, 'binary_recall': 0.977092, 'binary_specificity': 0.9933548, 'binary_f1_score': 0.98508984}
confusion matrix:
       0      1
0  59196    396
1   1360  58008
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9774568, 'precision': 0.97775817, 'recall': 0.9774663, 'specificity': 0.9774663, 'f1': 0.9774536, 'auroc': 0.99513316, 'binary_precision': 0.98994577, 'binary_recall': 0.96474546, 'binary_specificity': 0.9901871, 'binary_f1_score': 0.9771832}
confusion matrix:
       0      1
0  20585    204
1    734  20086
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-07-17 04:43:53.485186,epoch time: 3:14:34.278816,used: 15:31:41.879633,model: dset_te_0_erm_b44271c83_not_commited_2024md_07md_16_13_12_11_seed_0_22014177
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9768548, 'precision': 0.9768879, 'recall': 0.9768515, 'specificity': 0.9768515, 'f1': 0.9768542, 'auroc': 0.9971745, 'binary_precision': 0.97311294, 'binary_recall': 0.980848, 'binary_specificity': 0.97285503, 'binary_f1_score': 0.9769652}
confusion matrix:
        0       1
0  134899    3764
1    2660  136229
---- Validation: 
scalar performance:
{'acc': 0.9869536, 'precision': 0.98695934, 'recall': 0.98695105, 'specificity': 0.98695105, 'f1': 0.98695344, 'auroc': 0.99876463, 'binary_precision': 0.9882283, 'binary_recall': 0.9855983, 'binary_specificity': 0.9883038, 'binary_f1_score': 0.98691154}
confusion matrix:
       0      1
0  58895    697
1    855  58513
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97180897, 'precision': 0.97190684, 'recall': 0.9718145, 'specificity': 0.9718145, 'f1': 0.9718077, 'auroc': 0.9935219, 'binary_precision': 0.97889143, 'binary_recall': 0.9644573, 'binary_specificity': 0.9791717, 'binary_f1_score': 0.97162074}
confusion matrix:
       0      1
0  20356    433
1    740  20080
better model found
persisted
after epoch: 5,now: 2024-07-17 07:35:09.932584,epoch time: 2:51:16.447398,used: 18:22:58.327031,model: dset_te_0_erm_b44271c83_not_commited_2024md_07md_16_13_12_11_seed_0_22014177
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.97716826, 'precision': 0.9773233, 'recall': 0.97717565, 'specificity': 0.97717565, 'f1': 0.9771666, 'auroc': 0.9967632, 'binary_precision': 0.9861295, 'binary_recall': 0.9679886, 'binary_specificity': 0.9863627, 'binary_f1_score': 0.97697484}
confusion matrix:
        0       1
0  136773    1891
1    4446  134442
---- Validation: 
scalar performance:
{'acc': 0.9875084, 'precision': 0.98755443, 'recall': 0.9875, 'specificity': 0.9875, 'f1': 0.98750794, 'auroc': 0.9988276, 'binary_precision': 0.99184257, 'binary_recall': 0.9830548, 'binary_specificity': 0.9919452, 'binary_f1_score': 0.98742914}
confusion matrix:
       0      1
0  59112    480
1   1006  58362
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97517365, 'precision': 0.9753063, 'recall': 0.97518, 'specificity': 0.97518, 'f1': 0.97517216, 'auroc': 0.99486256, 'binary_precision': 0.98343515, 'binary_recall': 0.96666664, 'binary_specificity': 0.9836933, 'binary_f1_score': 0.9749788}
confusion matrix:
       0      1
0  20450    339
1    694  20126
better model found
persisted
after epoch: 6,now: 2024-07-17 11:03:37.325633,epoch time: 3:28:27.393049,used: 21:51:25.720080,model: dset_te_0_erm_b44271c83_not_commited_2024md_07md_16_13_12_11_seed_0_22014177
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.98024875, 'precision': 0.9802896, 'recall': 0.9802527, 'specificity': 0.9802527, 'f1': 0.98024845, 'auroc': 0.9974673, 'binary_precision': 0.98492956, 'binary_recall': 0.9754554, 'binary_specificity': 0.98504996, 'binary_f1_score': 0.9801696}
confusion matrix:
        0       1
0  136589    2073
1    3409  135481
---- Validation: 
scalar performance:
{'acc': 0.98795396, 'precision': 0.98801243, 'recall': 0.98794436, 'specificity': 0.98794436, 'f1': 0.98795336, 'auroc': 0.99892366, 'binary_precision': 0.9929044, 'binary_recall': 0.9828864, 'binary_specificity': 0.9930024, 'binary_f1_score': 0.98787004}
confusion matrix:
       0      1
0  59175    417
1   1016  58352
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9755101, 'precision': 0.97614485, 'recall': 0.9755238, 'specificity': 0.9755238, 'f1': 0.9755025, 'auroc': 0.9946343, 'binary_precision': 0.99371666, 'binary_recall': 0.95710856, 'binary_specificity': 0.9939391, 'binary_f1_score': 0.9750691}
confusion matrix:
       0      1
0  20663    126
1    893  19927
better model found
persisted
after epoch: 7,now: 2024-07-17 16:53:34.964685,epoch time: 5:49:57.639052,used: 1 day, 3:41:23.359132,model: dset_te_0_erm_b44271c83_not_commited_2024md_07md_16_13_12_11_seed_0_22014177
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9746498, 'precision': 0.97534, 'recall': 0.9746654, 'specificity': 0.9746654, 'f1': 0.9746412, 'auroc': 0.99718, 'binary_precision': 0.99365765, 'binary_recall': 0.9554392, 'binary_specificity': 0.99389166, 'binary_f1_score': 0.9741737}
confusion matrix:
        0       1
0  137816     847
1    6189  132700
---- Validation: 
scalar performance:
{'acc': 0.9812542, 'precision': 0.9817833, 'recall': 0.9812238, 'specificity': 0.9812238, 'f1': 0.98124814, 'auroc': 0.9985807, 'binary_precision': 0.9972846, 'binary_recall': 0.96506536, 'binary_specificity': 0.9973822, 'binary_f1_score': 0.98091054}
confusion matrix:
       0      1
0  59436    156
1   2074  57294
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9766637, 'precision': 0.9771699, 'recall': 0.976676, 'specificity': 0.976676, 'f1': 0.976658, 'auroc': 0.99567795, 'binary_precision': 0.9928979, 'binary_recall': 0.9602305, 'binary_specificity': 0.9931214, 'binary_f1_score': 0.97629106}
confusion matrix:
       0      1
0  20646    143
1    828  19992
early stop counter: 1
val acc:0.9812542200088501, best validation acc: 0.9879539608955383, corresponding to test acc:                         0.9755101203918457 / 0.97745680809021
after epoch: 8,now: 2024-07-17 22:07:53.740512,epoch time: 5:14:18.775827,used: 1 day, 8:55:42.134959,model: dset_te_0_erm_b44271c83_not_commited_2024md_07md_16_13_12_11_seed_0_22014177
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9800398, 'precision': 0.9802997, 'recall': 0.98004925, 'specificity': 0.98004925, 'f1': 0.98003733, 'auroc': 0.99771357, 'binary_precision': 0.99167436, 'binary_recall': 0.9682404, 'binary_specificity': 0.99185807, 'binary_f1_score': 0.9798173}
confusion matrix:
        0       1
0  137536    1129
1    4411  134476
---- Validation: 
scalar performance:
{'acc': 0.98705447, 'precision': 0.98719025, 'recall': 0.98703957, 'specificity': 0.98703957, 'f1': 0.9870533, 'auroc': 0.99897754, 'binary_precision': 0.9948655, 'binary_recall': 0.97911334, 'binary_specificity': 0.9949658, 'binary_f1_score': 0.98692656}
confusion matrix:
       0      1
0  59292    300
1   1240  58128
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9756783, 'precision': 0.97634894, 'recall': 0.9756924, 'specificity': 0.9756924, 'f1': 0.9756703, 'auroc': 0.99618345, 'binary_precision': 0.99440897, 'binary_recall': 0.9567723, 'binary_specificity': 0.9946125, 'binary_f1_score': 0.97522765}
confusion matrix:
       0      1
0  20677    112
1    900  19920
early stop counter: 2
val acc:0.9870544672012329, best validation acc: 0.9879539608955383, corresponding to test acc:                         0.9755101203918457 / 0.97745680809021
after epoch: 9,now: 2024-07-18 02:05:07.361014,epoch time: 3:57:13.620502,used: 1 day, 12:52:55.755461,model: dset_te_0_erm_b44271c83_not_commited_2024md_07md_16_13_12_11_seed_0_22014177
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9790706, 'precision': 0.97912157, 'recall': 0.97906667, 'specificity': 0.97906667, 'f1': 0.9790699, 'auroc': 0.9978528, 'binary_precision': 0.9743701, 'binary_recall': 0.98405874, 'binary_specificity': 0.9740746, 'binary_f1_score': 0.97919047}
confusion matrix:
        0       1
0  135072    3595
1    2214  136671
---- Validation: 
scalar performance:
{'acc': 0.98760086, 'precision': 0.9876027, 'recall': 0.9875996, 'specificity': 0.9875996, 'f1': 0.9876008, 'auroc': 0.9989209, 'binary_precision': 0.9881942, 'binary_recall': 0.9869458, 'binary_specificity': 0.9882535, 'binary_f1_score': 0.98756963}
confusion matrix:
       0      1
0  58892    700
1    775  58593
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9719051, 'precision': 0.971972, 'recall': 0.97190964, 'specificity': 0.97190964, 'f1': 0.9719043, 'auroc': 0.9939033, 'binary_precision': 0.9777778, 'binary_recall': 0.96580213, 'binary_specificity': 0.9780172, 'binary_f1_score': 0.97175306}
confusion matrix:
       0      1
0  20332    457
1    712  20108
early stop counter: 3
val acc:0.9876008629798889, best validation acc: 0.9879539608955383, corresponding to test acc:                         0.9755101203918457 / 0.97745680809021
after epoch: 10,now: 2024-07-18 05:50:11.394971,epoch time: 3:45:04.033957,used: 1 day, 16:37:59.789418,model: dset_te_0_erm_b44271c83_not_commited_2024md_07md_16_13_12_11_seed_0_22014177
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9795858, 'precision': 0.9795934, 'recall': 0.97958755, 'specificity': 0.97958755, 'f1': 0.97958577, 'auroc': 0.99768806, 'binary_precision': 0.9817109, 'binary_recall': 0.9774133, 'binary_specificity': 0.9817618, 'binary_f1_score': 0.9795574}
confusion matrix:
        0       1
0  136136    2529
1    3137  135750
---- Validation: 
scalar performance:
{'acc': 0.988307, 'precision': 0.9883666, 'recall': 0.98829734, 'specificity': 0.98829734, 'f1': 0.9883064, 'auroc': 0.99909157, 'binary_precision': 0.9933121, 'binary_recall': 0.9831896, 'binary_specificity': 0.99340516, 'binary_f1_score': 0.9882249}
confusion matrix:
       0      1
0  59199    393
1    998  58370
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96976614, 'precision': 0.97048056, 'recall': 0.9697808, 'specificity': 0.9697808, 'f1': 0.9697553, 'auroc': 0.9926212, 'binary_precision': 0.9890011, 'binary_recall': 0.9501441, 'binary_specificity': 0.9894175, 'binary_f1_score': 0.96918327}
confusion matrix:
       0      1
0  20569    220
1   1038  19782
better model found
persisted
after epoch: 11,now: 2024-07-18 08:47:48.248888,epoch time: 2:57:36.853917,used: 1 day, 19:35:36.643335,model: dset_te_0_erm_b44271c83_not_commited_2024md_07md_16_13_12_11_seed_0_22014177
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
slurmstepd: error: *** JOB 22014177 ON gpusrv40 CANCELLED AT 2024-07-18T11:14:30 DUE TO TIME LIMIT ***
