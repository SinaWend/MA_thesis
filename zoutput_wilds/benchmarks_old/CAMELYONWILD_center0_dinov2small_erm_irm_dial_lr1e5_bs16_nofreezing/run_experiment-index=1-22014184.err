Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Tue Jul 16 14:13:17 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYONWILD_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_nofreezing/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYONWILD_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_nofreezing/rule_results/1.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=1
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/swiglu_ffn.py:51: UserWarning: xFormers is not available (SwiGLU)
  warnings.warn("xFormers is not available (SwiGLU)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/attention.py:33: UserWarning: xFormers is not available (Attention)
  warnings.warn("xFormers is not available (Attention)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/block.py:40: UserWarning: xFormers is not available (Block)
  warnings.warn("xFormers is not available (Block)")
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_0_erm_b44271c83_not_commited_2024md_07md_16_16_37_15_seed_0_22014184

 Experiment start at: 2024-07-16 16:37:15.255327
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
before training, model accuracy: 0.5626667737960815
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9670152, 'precision': 0.96704465, 'recall': 0.9670185, 'specificity': 0.9670185, 'f1': 0.9670148, 'auroc': 0.9934703, 'binary_precision': 0.9709581, 'binary_recall': 0.9628835, 'binary_specificity': 0.9711535, 'binary_f1_score': 0.9669039}
confusion matrix:
        0       1
0  134665    4000
1    5155  133732
---- Validation: 
scalar performance:
{'acc': 0.97709316, 'precision': 0.97710705, 'recall': 0.9770887, 'specificity': 0.9770887, 'f1': 0.97709274, 'auroc': 0.9967673, 'binary_precision': 0.97925377, 'binary_recall': 0.9747507, 'binary_specificity': 0.97942674, 'binary_f1_score': 0.976997}
confusion matrix:
       0      1
0  58366   1226
1   1499  57869
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9638059, 'precision': 0.96397835, 'recall': 0.9637988, 'specificity': 0.9637988, 'f1': 0.96380216, 'auroc': 0.99406815, 'binary_precision': 0.95521826, 'binary_recall': 0.9732949, 'binary_specificity': 0.9543027, 'binary_f1_score': 0.9641719}
confusion matrix:
       0      1
0  19839    950
1    556  20264
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-16 20:32:42.747977,epoch time: 3:55:27.492650,used: 3:55:27.492650,model: dset_te_0_erm_b44271c83_not_commited_2024md_07md_16_16_37_15_seed_0_22014184
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9702362, 'precision': 0.9710421, 'recall': 0.970253, 'specificity': 0.970253, 'f1': 0.97022426, 'auroc': 0.99527884, 'binary_precision': 0.99072844, 'binary_recall': 0.94940525, 'binary_specificity': 0.9911008, 'binary_f1_score': 0.9696268}
confusion matrix:
        0       1
0  137430    1234
1    7027  131861
---- Validation: 
scalar performance:
{'acc': 0.9823134, 'precision': 0.98254484, 'recall': 0.98229355, 'specificity': 0.98229355, 'f1': 0.9823107, 'auroc': 0.9979845, 'binary_precision': 0.9926529, 'binary_recall': 0.97175246, 'binary_specificity': 0.9928346, 'binary_f1_score': 0.98209155}
confusion matrix:
       0      1
0  59165    427
1   1677  57691
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9701026, 'precision': 0.970732, 'recall': 0.9701164, 'specificity': 0.9701164, 'f1': 0.97009325, 'auroc': 0.9931798, 'binary_precision': 0.98813087, 'binary_recall': 0.9516811, 'binary_specificity': 0.9885516, 'binary_f1_score': 0.96956354}
confusion matrix:
       0      1
0  20551    238
1   1006  19814
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-07-17 00:59:50.253840,epoch time: 4:27:07.505863,used: 8:22:34.998513,model: dset_te_0_erm_b44271c83_not_commited_2024md_07md_16_16_37_15_seed_0_22014184
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.97410214, 'precision': 0.9741044, 'recall': 0.9741032, 'specificity': 0.9741032, 'f1': 0.97410214, 'auroc': 0.9959175, 'binary_precision': 0.975362, 'binary_recall': 0.9728198, 'binary_specificity': 0.97538656, 'binary_f1_score': 0.9740892}
confusion matrix:
        0       1
0  135251    3413
1    3775  135113
---- Validation: 
scalar performance:
{'acc': 0.9857767, 'precision': 0.985782, 'recall': 0.9857743, 'specificity': 0.9857743, 'f1': 0.9857766, 'auroc': 0.99847275, 'binary_precision': 0.9869803, 'binary_recall': 0.9844866, 'binary_specificity': 0.98706204, 'binary_f1_score': 0.9857319}
confusion matrix:
       0      1
0  58821    771
1    921  58447
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96926147, 'precision': 0.96926403, 'recall': 0.9692625, 'specificity': 0.9692625, 'f1': 0.9692614, 'auroc': 0.9940177, 'binary_precision': 0.97057265, 'binary_recall': 0.9679155, 'binary_specificity': 0.9706095, 'binary_f1_score': 0.9692422}
confusion matrix:
       0      1
0  20178    611
1    668  20152
better model found
persisted
after epoch: 3,now: 2024-07-17 04:43:53.080193,epoch time: 3:44:02.826353,used: 12:06:37.824866,model: dset_te_0_erm_b44271c83_not_commited_2024md_07md_16_16_37_15_seed_0_22014184
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.97854453, 'precision': 0.9785988, 'recall': 0.9785489, 'specificity': 0.9785489, 'f1': 0.9785441, 'auroc': 0.996964, 'binary_precision': 0.9838957, 'binary_recall': 0.9730498, 'binary_specificity': 0.984048, 'binary_f1_score': 0.9784427}
confusion matrix:
        0       1
0  136454    2212
1    3743  135143
---- Validation: 
scalar performance:
{'acc': 0.9866173, 'precision': 0.98667765, 'recall': 0.9866077, 'specificity': 0.9866077, 'f1': 0.98661673, 'auroc': 0.99875665, 'binary_precision': 0.99164367, 'binary_recall': 0.9814547, 'binary_specificity': 0.9917606, 'binary_f1_score': 0.9865229}
confusion matrix:
       0      1
0  59101    491
1   1101  58267
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9782018, 'precision': 0.9784252, 'recall': 0.97821, 'specificity': 0.97821, 'f1': 0.9781996, 'auroc': 0.99555016, 'binary_precision': 0.98895055, 'binary_recall': 0.967243, 'binary_specificity': 0.989177, 'binary_f1_score': 0.9779763}
confusion matrix:
       0      1
0  20564    225
1    682  20138
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-07-17 07:35:44.681598,epoch time: 2:51:51.601405,used: 14:58:29.426271,model: dset_te_0_erm_b44271c83_not_commited_2024md_07md_16_16_37_15_seed_0_22014184
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.97746366, 'precision': 0.9774728, 'recall': 0.97746205, 'specificity': 0.97746205, 'f1': 0.97746354, 'auroc': 0.9971961, 'binary_precision': 0.97558844, 'binary_recall': 0.9794728, 'binary_specificity': 0.9754513, 'binary_f1_score': 0.9775268}
confusion matrix:
        0       1
0  135259    3404
1    2851  136038
---- Validation: 
scalar performance:
{'acc': 0.98497814, 'precision': 0.98498315, 'recall': 0.9849758, 'specificity': 0.9849758, 'f1': 0.98497796, 'auroc': 0.9984131, 'binary_precision': 0.98613715, 'binary_recall': 0.9837286, 'binary_specificity': 0.986223, 'binary_f1_score': 0.98493135}
confusion matrix:
       0      1
0  58771    821
1    966  58402
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97214544, 'precision': 0.9721838, 'recall': 0.9721489, 'specificity': 0.9721489, 'f1': 0.9721451, 'auroc': 0.99397314, 'binary_precision': 0.97663033, 'binary_recall': 0.96748316, 'binary_specificity': 0.9768147, 'binary_f1_score': 0.9720352}
confusion matrix:
       0      1
0  20307    482
1    677  20143
early stop counter: 1
val acc:0.9849781394004822, best validation acc: 0.9866173267364502, corresponding to test acc:                         0.9782018065452576 / 0.9782018065452576
after epoch: 5,now: 2024-07-17 11:03:37.033956,epoch time: 3:27:52.352358,used: 18:26:21.778629,model: dset_te_0_erm_b44271c83_not_commited_2024md_07md_16_16_37_15_seed_0_22014184
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.97932637, 'precision': 0.9794464, 'recall': 0.9793329, 'specificity': 0.9793329, 'f1': 0.9793253, 'auroc': 0.99730295, 'binary_precision': 0.9872363, 'binary_recall': 0.971243, 'binary_specificity': 0.9874228, 'binary_f1_score': 0.9791743}
confusion matrix:
        0       1
0  136920    1744
1    3994  134894
---- Validation: 
scalar performance:
{'acc': 0.988307, 'precision': 0.9883957, 'recall': 0.9882951, 'specificity': 0.9882951, 'f1': 0.9883062, 'auroc': 0.99892735, 'binary_precision': 0.99452394, 'binary_recall': 0.9819768, 'binary_specificity': 0.99461335, 'binary_f1_score': 0.98821056}
confusion matrix:
       0      1
0  59271    321
1   1070  58298
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9736595, 'precision': 0.97442305, 'recall': 0.9736746, 'specificity': 0.9736746, 'f1': 0.9736495, 'auroc': 0.9960743, 'binary_precision': 0.993643, 'binary_recall': 0.9534582, 'binary_specificity': 0.993891, 'binary_f1_score': 0.97313595}
confusion matrix:
       0      1
0  20662    127
1    969  19851
better model found
persisted
after epoch: 6,now: 2024-07-17 16:53:34.915396,epoch time: 5:49:57.881440,used: 1 day, 0:16:19.660069,model: dset_te_0_erm_b44271c83_not_commited_2024md_07md_16_16_37_15_seed_0_22014184
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9783572, 'precision': 0.97848296, 'recall': 0.978364, 'specificity': 0.978364, 'f1': 0.978356, 'auroc': 0.99717534, 'binary_precision': 0.986448, 'binary_recall': 0.97007704, 'binary_specificity': 0.986651, 'binary_f1_score': 0.97819394}
confusion matrix:
        0       1
0  136811    1851
1    4156  134734
---- Validation: 
scalar performance:
{'acc': 0.9871722, 'precision': 0.9872472, 'recall': 0.9871613, 'specificity': 0.9871613, 'f1': 0.9871714, 'auroc': 0.9988179, 'binary_precision': 0.9928428, 'binary_recall': 0.98137045, 'binary_specificity': 0.99295205, 'binary_f1_score': 0.9870733}
confusion matrix:
       0      1
0  59172    420
1   1106  58262
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9783941, 'precision': 0.9789896, 'recall': 0.9784074, 'specificity': 0.9784074, 'f1': 0.97838783, 'auroc': 0.99684954, 'binary_precision': 0.99606556, 'binary_recall': 0.9606148, 'binary_specificity': 0.9961999, 'binary_f1_score': 0.97801906}
confusion matrix:
       0      1
0  20710     79
1    820  20000
new oracle model saved
early stop counter: 1
val acc:0.9871721863746643, best validation acc: 0.988306999206543, corresponding to test acc:                         0.9736595153808594 / 0.978394091129303
after epoch: 7,now: 2024-07-17 22:07:53.719070,epoch time: 5:14:18.803674,used: 1 day, 5:30:38.463743,model: dset_te_0_erm_b44271c83_not_commited_2024md_07md_16_16_37_15_seed_0_22014184
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.97596127, 'precision': 0.97662115, 'recall': 0.9759766, 'specificity': 0.9759766, 'f1': 0.97595346, 'auroc': 0.99748486, 'binary_precision': 0.99456125, 'binary_recall': 0.95719606, 'binary_specificity': 0.99475706, 'binary_f1_score': 0.975521}
confusion matrix:
        0       1
0  137936     727
1    5945  132944
---- Validation: 
scalar performance:
{'acc': 0.98183423, 'precision': 0.98233163, 'recall': 0.9818048, 'specificity': 0.9818048, 'f1': 0.9818287, 'auroc': 0.99875975, 'binary_precision': 0.997357, 'binary_recall': 0.96616024, 'binary_specificity': 0.99744934, 'binary_f1_score': 0.9815109}
confusion matrix:
       0      1
0  59440    152
1   2009  57359
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9750535, 'precision': 0.97569263, 'recall': 0.97506726, 'specificity': 0.97506726, 'f1': 0.9750457, 'auroc': 0.99529517, 'binary_precision': 0.9933167, 'binary_recall': 0.9565802, 'binary_specificity': 0.9935543, 'binary_f1_score': 0.97460246}
confusion matrix:
       0      1
0  20655    134
1    904  19916
early stop counter: 2
val acc:0.9818342328071594, best validation acc: 0.988306999206543, corresponding to test acc:                         0.9736595153808594 / 0.978394091129303
after epoch: 8,now: 2024-07-18 02:05:07.359654,epoch time: 3:57:13.640584,used: 1 day, 9:27:52.104327,model: dset_te_0_erm_b44271c83_not_commited_2024md_07md_16_16_37_15_seed_0_22014184
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.98073876, 'precision': 0.980966, 'recall': 0.9807476, 'specificity': 0.9807476, 'f1': 0.98073673, 'auroc': 0.99765784, 'binary_precision': 0.9916211, 'binary_recall': 0.969702, 'binary_specificity': 0.99179316, 'binary_f1_score': 0.9805391}
confusion matrix:
        0       1
0  137527    1138
1    4208  134679
---- Validation: 
scalar performance:
{'acc': 0.9869536, 'precision': 0.9870719, 'recall': 0.9869397, 'specificity': 0.9869397, 'f1': 0.98695254, 'auroc': 0.9988563, 'binary_precision': 0.9942045, 'binary_recall': 0.9795681, 'binary_specificity': 0.99431133, 'binary_f1_score': 0.9868321}
confusion matrix:
       0      1
0  59253    339
1   1213  58155
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97243387, 'precision': 0.9734454, 'recall': 0.9724512, 'specificity': 0.9724512, 'f1': 0.97241986, 'auroc': 0.994992, 'binary_precision': 0.9955166, 'binary_recall': 0.94918346, 'binary_specificity': 0.9957189, 'binary_f1_score': 0.97179806}
confusion matrix:
       0      1
0  20700     89
1   1058  19762
early stop counter: 3
val acc:0.986953616142273, best validation acc: 0.988306999206543, corresponding to test acc:                         0.9736595153808594 / 0.978394091129303
after epoch: 9,now: 2024-07-18 05:50:11.393963,epoch time: 3:45:04.034309,used: 1 day, 13:12:56.138636,model: dset_te_0_erm_b44271c83_not_commited_2024md_07md_16_16_37_15_seed_0_22014184
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.98340493, 'precision': 0.9834105, 'recall': 0.9834064, 'specificity': 0.9834064, 'f1': 0.9834049, 'auroc': 0.9981812, 'binary_precision': 0.9852557, 'binary_recall': 0.9815243, 'binary_specificity': 0.9852885, 'binary_f1_score': 0.98338646}
confusion matrix:
        0       1
0  136627    2040
1    2566  136319
---- Validation: 
scalar performance:
{'acc': 0.98922324, 'precision': 0.9892385, 'recall': 0.9892188, 'specificity': 0.9892188, 'f1': 0.9892231, 'auroc': 0.99909854, 'binary_precision': 0.99153775, 'binary_recall': 0.9868279, 'binary_specificity': 0.99160963, 'binary_f1_score': 0.9891772}
confusion matrix:
       0      1
0  59092    500
1    782  58586
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.976856, 'precision': 0.977234, 'recall': 0.9768666, 'specificity': 0.9768666, 'f1': 0.9768517, 'auroc': 0.9945797, 'binary_precision': 0.9908538, 'binary_recall': 0.96263206, 'binary_specificity': 0.9911011, 'binary_f1_score': 0.9765391}
confusion matrix:
       0      1
0  20604    185
1    778  20042
better model found
persisted
after epoch: 10,now: 2024-07-18 08:47:48.235407,epoch time: 2:57:36.841444,used: 1 day, 16:10:32.980080,model: dset_te_0_erm_b44271c83_not_commited_2024md_07md_16_16_37_15_seed_0_22014184
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9808144, 'precision': 0.9808208, 'recall': 0.9808131, 'specificity': 0.9808131, 'f1': 0.9808143, 'auroc': 0.9979837, 'binary_precision': 0.97925276, 'binary_recall': 0.982475, 'binary_specificity': 0.9791512, 'binary_f1_score': 0.9808612}
confusion matrix:
        0       1
0  135774    2891
1    2434  136453
---- Validation: 
scalar performance:
{'acc': 0.9900975, 'precision': 0.9901141, 'recall': 0.99009275, 'specificity': 0.99009275, 'f1': 0.9900973, 'auroc': 0.99924946, 'binary_precision': 0.9925345, 'binary_recall': 0.9875859, 'binary_specificity': 0.99259967, 'binary_f1_score': 0.990054}
confusion matrix:
       0      1
0  59151    441
1    737  58631
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97611094, 'precision': 0.9764693, 'recall': 0.9761213, 'specificity': 0.9761213, 'f1': 0.97610676, 'auroc': 0.994003, 'binary_precision': 0.98972434, 'binary_recall': 0.96224785, 'binary_specificity': 0.9899947, 'binary_f1_score': 0.97579265}
confusion matrix:
       0      1
0  20581    208
1    786  20034
better model found
persisted
after epoch: 11,now: 2024-07-18 12:45:44.022438,epoch time: 3:57:55.787031,used: 1 day, 20:08:28.767111,model: dset_te_0_erm_b44271c83_not_commited_2024md_07md_16_16_37_15_seed_0_22014184
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
slurmstepd: error: *** JOB 22014184 ON supergpu03 CANCELLED AT 2024-07-18T14:12:38 DUE TO TIME LIMIT ***
