Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Sat Jul 27 03:06:26 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_diva_irm_3seeds_nofreeze_2024-07-27_01-18-02/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_diva_irm_3seeds_nofreeze_2024-07-27_01-18-02/rule_results/18.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=18
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/swiglu_ffn.py:51: UserWarning: xFormers is not available (SwiGLU)
  warnings.warn("xFormers is not available (SwiGLU)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/attention.py:33: UserWarning: xFormers is not available (Attention)
  warnings.warn("xFormers is not available (Attention)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/block.py:40: UserWarning: xFormers is not available (Block)
  warnings.warn("xFormers is not available (Block)")
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/init.py:452: UserWarning: Initializing zero-element tensors is a no-op
  warnings.warn("Initializing zero-element tensors is a no-op")
Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main

using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_03_07_09_seed_0_23090499

 Experiment start at: 2024-07-27 03:07:10.476935
before training, model accuracy: 0.38604649901390076
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9453125, 'precision': 0.94535524, 'recall': 0.9452608, 'specificity': 0.9452608, 'f1': 0.945298, 'auroc': 0.984416, 'binary_precision': 0.9431673, 'binary_recall': 0.94922876, 'binary_specificity': 0.9412929, 'binary_f1_score': 0.94618833}
confusion matrix:
      0     1
0  1427    89
1    79  1477
---- Validation: 
scalar performance:
{'acc': 0.7663044, 'precision': 0.7671131, 'recall': 0.7666602, 'specificity': 0.7666602, 'f1': 0.7662535, 'auroc': 0.82263565, 'binary_precision': 0.7485119, 'binary_recall': 0.792126, 'binary_specificity': 0.7411945, 'binary_f1_score': 0.7697016}
confusion matrix:
     0    1
0  484  169
1  132  503
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.76046515, 'precision': 0.78848, 'recall': 0.76046515, 'specificity': 0.76046515, 'f1': 0.75450504, 'auroc': 0.8812114, 'binary_precision': 0.6985816, 'binary_recall': 0.9162791, 'binary_specificity': 0.60465115, 'binary_f1_score': 0.7927566}
confusion matrix:
     0    1
0  130   85
1   18  197
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-27 03:08:21.501250,epoch time: 0:01:11.024315,used: 0:01:11.024315,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_03_07_09_seed_0_23090499
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9534505, 'precision': 0.9535049, 'recall': 0.95339286, 'specificity': 0.95339286, 'f1': 0.9534367, 'auroc': 0.9923107, 'binary_precision': 0.95089287, 'binary_recall': 0.9576108, 'binary_specificity': 0.94917494, 'binary_f1_score': 0.95424}
confusion matrix:
      0     1
0  1438    77
1    66  1491
---- Validation: 
scalar performance:
{'acc': 0.82375777, 'precision': 0.82890344, 'recall': 0.82462406, 'specificity': 0.82462406, 'f1': 0.8233077, 'auroc': 0.8877573, 'binary_precision': 0.7841226, 'binary_recall': 0.88661414, 'binary_specificity': 0.762634, 'binary_f1_score': 0.8322246}
confusion matrix:
     0    1
0  498  155
1   72  563
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.81627905, 'precision': 0.82214, 'recall': 0.81627905, 'specificity': 0.81627905, 'f1': 0.81543964, 'auroc': 0.90877235, 'binary_precision': 0.77868855, 'binary_recall': 0.88372093, 'binary_specificity': 0.74883723, 'binary_f1_score': 0.8278867}
confusion matrix:
     0    1
0  161   54
1   25  190
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-07-27 03:09:25.950987,epoch time: 0:01:04.449737,used: 0:02:15.474052,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_03_07_09_seed_0_23090499
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9720052, 'precision': 0.97198737, 'recall': 0.97201777, 'specificity': 0.97201777, 'f1': 0.97200096, 'auroc': 0.9960128, 'binary_precision': 0.9735995, 'binary_recall': 0.97109824, 'binary_specificity': 0.9729373, 'binary_f1_score': 0.97234726}
confusion matrix:
      0     1
0  1474    41
1    45  1512
---- Validation: 
scalar performance:
{'acc': 0.8128882, 'precision': 0.8235377, 'recall': 0.8116036, 'specificity': 0.8116036, 'f1': 0.81087154, 'auroc': 0.8817855, 'binary_precision': 0.87884617, 'binary_recall': 0.719685, 'binary_specificity': 0.9035222, 'binary_f1_score': 0.79134196}
confusion matrix:
     0    1
0  590   63
1  178  457
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8744186, 'precision': 0.8818533, 'recall': 0.8744186, 'specificity': 0.8744186, 'f1': 0.87380433, 'auroc': 0.93388855, 'binary_precision': 0.9351351, 'binary_recall': 0.80465114, 'binary_specificity': 0.94418603, 'binary_f1_score': 0.865}
confusion matrix:
     0    1
0  203   12
1   42  173
new oracle model saved
early stop counter: 1
val acc:0.8128882050514221, best validation acc: 0.8237577676773071, corresponding to test acc:                         0.8162790536880493 / 0.8744186162948608
after epoch: 3,now: 2024-07-27 03:10:29.661501,epoch time: 0:01:03.710514,used: 0:03:19.184566,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_03_07_09_seed_0_23090499
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9785156, 'precision': 0.97871554, 'recall': 0.97868145, 'specificity': 0.97868145, 'f1': 0.9785156, 'auroc': 0.99775445, 'binary_precision': 0.9920687, 'binary_recall': 0.9652733, 'binary_specificity': 0.9920896, 'binary_f1_score': 0.9784876}
confusion matrix:
      0     1
0  1505    12
1    54  1501
---- Validation: 
scalar performance:
{'acc': 0.77251554, 'precision': 0.7755585, 'recall': 0.77321994, 'specificity': 0.77321994, 'f1': 0.7721583, 'auroc': 0.82297814, 'binary_precision': 0.74289775, 'binary_recall': 0.82362205, 'binary_specificity': 0.7228178, 'binary_f1_score': 0.78118}
confusion matrix:
     0    1
0  472  181
1  112  523
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7976744, 'precision': 0.81542265, 'recall': 0.7976744, 'specificity': 0.7976744, 'f1': 0.79478765, 'auroc': 0.84649, 'binary_precision': 0.7406015, 'binary_recall': 0.9162791, 'binary_specificity': 0.67906976, 'binary_f1_score': 0.8191268}
confusion matrix:
     0    1
0  146   69
1   18  197
early stop counter: 2
val acc:0.7725155353546143, best validation acc: 0.8237577676773071, corresponding to test acc:                         0.8162790536880493 / 0.8744186162948608
after epoch: 4,now: 2024-07-27 03:11:33.027676,epoch time: 0:01:03.366175,used: 0:04:22.550741,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_03_07_09_seed_0_23090499
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.94889325, 'precision': 0.95080626, 'recall': 0.9484584, 'specificity': 0.9484584, 'f1': 0.94879436, 'auroc': 0.9939945, 'binary_precision': 0.9248029, 'binary_recall': 0.978819, 'binary_specificity': 0.91809773, 'binary_f1_score': 0.9510446}
confusion matrix:
      0     1
0  1390   124
1    33  1525
---- Validation: 
scalar performance:
{'acc': 0.76785713, 'precision': 0.7799403, 'recall': 0.76927686, 'specificity': 0.76927686, 'f1': 0.76592565, 'auroc': 0.8271768, 'binary_precision': 0.7181818, 'binary_recall': 0.8708661, 'binary_specificity': 0.6676876, 'binary_f1_score': 0.7871886}
confusion matrix:
     0    1
0  436  217
1   82  553
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7139535, 'precision': 0.7809659, 'recall': 0.7139535, 'specificity': 0.7139535, 'f1': 0.6958159, 'auroc': 0.885365, 'binary_precision': 0.64375, 'binary_recall': 0.95813954, 'binary_specificity': 0.46976745, 'binary_f1_score': 0.77009344}
confusion matrix:
     0    1
0  101  114
1    9  206
early stop counter: 3
val acc:0.7678571343421936, best validation acc: 0.8237577676773071, corresponding to test acc:                         0.8162790536880493 / 0.8744186162948608
after epoch: 5,now: 2024-07-27 03:12:36.537643,epoch time: 0:01:03.509967,used: 0:05:26.060708,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_03_07_09_seed_0_23090499
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.976237, 'precision': 0.97635984, 'recall': 0.9763973, 'specificity': 0.9763973, 'f1': 0.97623694, 'auroc': 0.99753356, 'binary_precision': 0.98815787, 'binary_recall': 0.96467566, 'binary_specificity': 0.9881188, 'binary_f1_score': 0.97627556}
confusion matrix:
      0     1
0  1497    18
1    55  1502
---- Validation: 
scalar performance:
{'acc': 0.6001553, 'precision': 0.69602865, 'recall': 0.595161, 'specificity': 0.595161, 'f1': 0.53843254, 'auroc': 0.8244734, 'binary_precision': 0.8296703, 'binary_recall': 0.23779528, 'binary_specificity': 0.9525268, 'binary_f1_score': 0.36964506}
confusion matrix:
     0    1
0  622   31
1  484  151
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8, 'precision': 0.8272103, 'recall': 0.79999995, 'specificity': 0.79999995, 'f1': 0.79575384, 'auroc': 0.89817196, 'binary_precision': 0.92156863, 'binary_recall': 0.65581393, 'binary_specificity': 0.94418603, 'binary_f1_score': 0.7663044}
confusion matrix:
     0    1
0  203   12
1   74  141
early stop counter: 4
val acc:0.6001552939414978, best validation acc: 0.8237577676773071, corresponding to test acc:                         0.8162790536880493 / 0.8744186162948608
after epoch: 6,now: 2024-07-27 03:13:39.948155,epoch time: 0:01:03.410512,used: 0:06:29.471220,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_03_07_09_seed_0_23090499
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9840495, 'precision': 0.98403496, 'recall': 0.98412216, 'specificity': 0.98412216, 'f1': 0.9840484, 'auroc': 0.9985167, 'binary_precision': 0.9896104, 'binary_recall': 0.9788054, 'binary_specificity': 0.98943895, 'binary_f1_score': 0.98417825}
confusion matrix:
      0     1
0  1499    16
1    33  1524
---- Validation: 
scalar performance:
{'acc': 0.81444097, 'precision': 0.82052183, 'recall': 0.8134606, 'specificity': 0.8134606, 'f1': 0.81319964, 'auroc': 0.87290394, 'binary_precision': 0.8613139, 'binary_recall': 0.7433071, 'binary_specificity': 0.88361406, 'binary_f1_score': 0.79797137}
confusion matrix:
     0    1
0  577   76
1  163  472
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8255814, 'precision': 0.8264359, 'recall': 0.82558143, 'specificity': 0.82558143, 'f1': 0.8254672, 'auroc': 0.8835262, 'binary_precision': 0.84313726, 'binary_recall': 0.8, 'binary_specificity': 0.8511628, 'binary_f1_score': 0.8210024}
confusion matrix:
     0    1
0  183   32
1   43  172
early stop counter: 5
val acc:0.8144409656524658, best validation acc: 0.8237577676773071, corresponding to test acc:                         0.8162790536880493 / 0.8744186162948608
after epoch: 7,now: 2024-07-27 03:14:43.061540,epoch time: 0:01:03.113385,used: 0:07:32.584605,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_03_07_09_seed_0_23090499
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 7 with time: 0:07:32.584605 at 2024-07-27 03:14:43.061540
persisted model performance metric: 

scalar performance:
{'acc': 0.81627905, 'precision': 0.82214, 'recall': 0.81627905, 'specificity': 0.81627905, 'f1': 0.81543964, 'auroc': 0.90877235, 'binary_precision': 0.77868855, 'binary_recall': 0.88372093, 'binary_specificity': 0.74883723, 'binary_f1_score': 0.8278867}
confusion matrix:
     0    1
0  161   54
1   25  190
oracle model performance metric: 

scalar performance:
{'acc': 0.8744186, 'precision': 0.8818533, 'recall': 0.8744186, 'specificity': 0.8744186, 'f1': 0.87380433, 'auroc': 0.93388855, 'binary_precision': 0.9351351, 'binary_recall': 0.80465114, 'binary_specificity': 0.94418603, 'binary_f1_score': 0.865}
confusion matrix:
     0    1
0  203   12
1   42  173
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_diva_irm_3seeds_nofreeze_2024-07-27_01-18-02/rule_results/18.csv
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_diva_irm_3seeds_nofreeze_2024-07-27_01-18-02/rule_results/18.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_diva_irm_3seeds_nofreeze_2024-07-27_01-18-02/confusion_matrix/18.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    918 MiB |  13688 MiB |  17339 GiB |  17339 GiB |
|       from large pool |    857 MiB |  13629 MiB |  17122 GiB |  17121 GiB |
|       from small pool |     60 MiB |     97 MiB |    217 GiB |    217 GiB |
|---------------------------------------------------------------------------|
| Active memory         |    918 MiB |  13688 MiB |  17339 GiB |  17339 GiB |
|       from large pool |    857 MiB |  13629 MiB |  17122 GiB |  17121 GiB |
|       from small pool |     60 MiB |     97 MiB |    217 GiB |    217 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |    904 MiB |  13680 MiB |  17324 GiB |  17324 GiB |
|       from large pool |    844 MiB |  13621 MiB |  17107 GiB |  17107 GiB |
|       from small pool |     60 MiB |     97 MiB |    217 GiB |    216 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  14836 MiB |  14836 MiB |  14836 MiB |      0 B   |
|       from large pool |  14730 MiB |  14730 MiB |  14730 MiB |      0 B   |
|       from small pool |    106 MiB |    106 MiB |    106 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |   1725 MiB |   2280 MiB |  12958 GiB |  12956 GiB |
|       from large pool |   1714 MiB |   2272 MiB |  12739 GiB |  12738 GiB |
|       from small pool |     11 MiB |     17 MiB |    218 GiB |    218 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    1784    |    3095    |    3130 K  |    3128 K  |
|       from large pool |     265    |    1491    |    1549 K  |    1549 K  |
|       from small pool |    1519    |    2211    |    1581 K  |    1579 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    1784    |    3095    |    3130 K  |    3128 K  |
|       from large pool |     265    |    1491    |    1549 K  |    1549 K  |
|       from small pool |    1519    |    2211    |    1581 K  |    1579 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     594    |     594    |     594    |       0    |
|       from large pool |     541    |     541    |     541    |       0    |
|       from small pool |      53    |      53    |      53    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     132    |     578    |    1883 K  |    1883 K  |
|       from large pool |      51    |     535    |    1022 K  |    1022 K  |
|       from small pool |      81    |     232    |     861 K  |     861 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13688 MiB |  17339 GiB |  17339 GiB |
|       from large pool |  16640 KiB |  13629 MiB |  17122 GiB |  17122 GiB |
|       from small pool |      0 KiB |     97 MiB |    217 GiB |    217 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13688 MiB |  17339 GiB |  17339 GiB |
|       from large pool |  16640 KiB |  13629 MiB |  17122 GiB |  17122 GiB |
|       from small pool |      0 KiB |     97 MiB |    217 GiB |    217 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13680 MiB |  17324 GiB |  17324 GiB |
|       from large pool |  16640 KiB |  13621 MiB |  17107 GiB |  17107 GiB |
|       from small pool |      0 KiB |     97 MiB |    217 GiB |    217 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2644 MiB |  14836 MiB |  14836 MiB |  12192 MiB |
|       from large pool |   2572 MiB |  14730 MiB |  14730 MiB |  12158 MiB |
|       from small pool |     72 MiB |    106 MiB |    106 MiB |     34 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   2280 MiB |  12958 GiB |  12958 GiB |
|       from large pool |  24320 KiB |   2272 MiB |  12740 GiB |  12740 GiB |
|       from small pool |      0 KiB |     39 MiB |    218 GiB |    218 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3095    |    3130 K  |    3130 K  |
|       from large pool |       2    |    1491    |    1549 K  |    1549 K  |
|       from small pool |       0    |    2211    |    1581 K  |    1581 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3095    |    3130 K  |    3130 K  |
|       from large pool |       2    |    1491    |    1549 K  |    1549 K  |
|       from small pool |       0    |    2211    |    1581 K  |    1581 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      92    |     594    |     594    |     502    |
|       from large pool |      56    |     541    |     541    |     485    |
|       from small pool |      36    |      53    |      53    |      17    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       2    |     578    |    1883 K  |    1883 K  |
|       from large pool |       2    |     535    |    1022 K  |    1022 K  |
|       from small pool |       0    |     232    |     861 K  |     861 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13688 MiB |  17339 GiB |  17339 GiB |
|       from large pool |  16640 KiB |  13629 MiB |  17122 GiB |  17122 GiB |
|       from small pool |      0 KiB |     97 MiB |    217 GiB |    217 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13688 MiB |  17339 GiB |  17339 GiB |
|       from large pool |  16640 KiB |  13629 MiB |  17122 GiB |  17122 GiB |
|       from small pool |      0 KiB |     97 MiB |    217 GiB |    217 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13680 MiB |  17324 GiB |  17324 GiB |
|       from large pool |  16640 KiB |  13621 MiB |  17107 GiB |  17107 GiB |
|       from small pool |      0 KiB |     97 MiB |    217 GiB |    217 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2644 MiB |  14836 MiB |  14836 MiB |  12192 MiB |
|       from large pool |   2572 MiB |  14730 MiB |  14730 MiB |  12158 MiB |
|       from small pool |     72 MiB |    106 MiB |    106 MiB |     34 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   2280 MiB |  12958 GiB |  12958 GiB |
|       from large pool |  24320 KiB |   2272 MiB |  12740 GiB |  12740 GiB |
|       from small pool |      0 KiB |     39 MiB |    218 GiB |    218 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3095    |    3130 K  |    3130 K  |
|       from large pool |       2    |    1491    |    1549 K  |    1549 K  |
|       from small pool |       0    |    2211    |    1581 K  |    1581 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3095    |    3130 K  |    3130 K  |
|       from large pool |       2    |    1491    |    1549 K  |    1549 K  |
|       from small pool |       0    |    2211    |    1581 K  |    1581 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      92    |     594    |     594    |     502    |
|       from large pool |      56    |     541    |     541    |     485    |
|       from small pool |      36    |      53    |      53    |      17    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       2    |     578    |    1883 K  |    1883 K  |
|       from large pool |       2    |     535    |    1022 K  |    1022 K  |
|       from small pool |       0    |     232    |     861 K  |     861 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/init.py:452: UserWarning: Initializing zero-element tensors is a no-op
  warnings.warn("Initializing zero-element tensors is a no-op")
Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main

using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_03_15_13_seed_1_23090499

 Experiment start at: 2024-07-27 03:15:13.853206
before training, model accuracy: 0.5155555605888367
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.93033856, 'precision': 0.93283284, 'recall': 0.9298206, 'specificity': 0.9298206, 'f1': 0.93016756, 'auroc': 0.9863007, 'binary_precision': 0.9033613, 'binary_recall': 0.965982, 'binary_specificity': 0.8936592, 'binary_f1_score': 0.93362284}
confusion matrix:
      0     1
0  1353   161
1    53  1505
---- Validation: 
scalar performance:
{'acc': 0.7533177, 'precision': 0.79805744, 'recall': 0.7564516, 'specificity': 0.7564516, 'f1': 0.74517417, 'auroc': 0.91504157, 'binary_precision': 0.6784091, 'binary_recall': 0.947619, 'binary_specificity': 0.5652842, 'binary_f1_score': 0.79072845}
confusion matrix:
     0    1
0  368  283
1   33  597
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.76, 'precision': 0.7896613, 'recall': 0.76, 'specificity': 0.76, 'f1': 0.75369453, 'auroc': 0.9197037, 'binary_precision': 0.6969697, 'binary_recall': 0.92, 'binary_specificity': 0.6, 'binary_f1_score': 0.7931034}
confusion matrix:
     0    1
0  135   90
1   18  207
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-27 03:16:22.283220,epoch time: 0:01:08.430014,used: 0:01:08.430014,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_03_15_13_seed_1_23090499
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9085286, 'precision': 0.92150104, 'recall': 0.9095729, 'specificity': 0.9095729, 'f1': 0.9079622, 'auroc': 0.99014956, 'binary_precision': 0.9984338, 'binary_recall': 0.8204633, 'binary_specificity': 0.9986825, 'binary_f1_score': 0.9007418}
confusion matrix:
      0     1
0  1516     2
1   279  1275
---- Validation: 
scalar performance:
{'acc': 0.6112412, 'precision': 0.6943016, 'recall': 0.60573477, 'specificity': 0.60573477, 'f1': 0.55843246, 'auroc': 0.799755, 'binary_precision': 0.8173077, 'binary_recall': 0.26984128, 'binary_specificity': 0.9416283, 'binary_f1_score': 0.40572792}
confusion matrix:
     0    1
0  613   38
1  460  170
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.75555557, 'precision': 0.78655124, 'recall': 0.75555557, 'specificity': 0.75555557, 'f1': 0.7487616, 'auroc': 0.85517037, 'binary_precision': 0.8807947, 'binary_recall': 0.5911111, 'binary_specificity': 0.92, 'binary_f1_score': 0.7074468}
confusion matrix:
     0    1
0  207   18
1   92  133
early stop counter: 1
val acc:0.6112412214279175, best validation acc: 0.7533177137374878, corresponding to test acc:                         0.7599999904632568 / 0.7599999904632568
after epoch: 2,now: 2024-07-27 03:17:26.472804,epoch time: 0:01:04.189584,used: 0:02:12.619598,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_03_15_13_seed_1_23090499
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.96028644, 'precision': 0.96128833, 'recall': 0.9600369, 'specificity': 0.9600369, 'f1': 0.9602443, 'auroc': 0.99486434, 'binary_precision': 0.94252163, 'binary_recall': 0.9813385, 'binary_specificity': 0.9387352, 'binary_f1_score': 0.9615385}
confusion matrix:
      0     1
0  1425    93
1    29  1525
---- Validation: 
scalar performance:
{'acc': 0.7704918, 'precision': 0.79784876, 'recall': 0.7729391, 'specificity': 0.7729391, 'f1': 0.7661271, 'auroc': 0.9080828, 'binary_precision': 0.7033898, 'binary_recall': 0.9222222, 'binary_specificity': 0.6236559, 'binary_f1_score': 0.7980769}
confusion matrix:
     0    1
0  406  245
1   49  581
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7355555, 'precision': 0.78665864, 'recall': 0.7355555, 'specificity': 0.7355555, 'f1': 0.72322005, 'auroc': 0.91885436, 'binary_precision': 0.665625, 'binary_recall': 0.94666666, 'binary_specificity': 0.52444446, 'binary_f1_score': 0.7816514}
confusion matrix:
     0    1
0  118  107
1   12  213
better model found
persisted
after epoch: 3,now: 2024-07-27 03:18:31.195856,epoch time: 0:01:04.723052,used: 0:03:17.342650,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_03_15_13_seed_1_23090499
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.98307294, 'precision': 0.9830552, 'recall': 0.98309445, 'specificity': 0.98309445, 'f1': 0.9830711, 'auroc': 0.99835944, 'binary_precision': 0.9851517, 'binary_recall': 0.9813505, 'binary_specificity': 0.9848385, 'binary_f1_score': 0.98324746}
confusion matrix:
      0     1
0  1494    23
1    29  1526
---- Validation: 
scalar performance:
{'acc': 0.80093676, 'precision': 0.8265189, 'recall': 0.7986175, 'specificity': 0.7986175, 'f1': 0.7960646, 'auroc': 0.89029336, 'binary_precision': 0.9139073, 'binary_recall': 0.6571429, 'binary_specificity': 0.94009215, 'binary_f1_score': 0.76454294}
confusion matrix:
     0    1
0  612   39
1  216  414
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.86444443, 'precision': 0.8876051, 'recall': 0.8644445, 'specificity': 0.8644445, 'f1': 0.8623888, 'auroc': 0.93973327, 'binary_precision': 0.9823529, 'binary_recall': 0.74222225, 'binary_specificity': 0.9866667, 'binary_f1_score': 0.8455696}
confusion matrix:
     0    1
0  222    3
1   58  167
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-07-27 03:19:36.764755,epoch time: 0:01:05.568899,used: 0:04:22.911549,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_03_15_13_seed_1_23090499
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.98014325, 'precision': 0.98012996, 'recall': 0.9801526, 'specificity': 0.9801526, 'f1': 0.9801403, 'auroc': 0.99812543, 'binary_precision': 0.98132646, 'binary_recall': 0.97943443, 'binary_specificity': 0.9808707, 'binary_f1_score': 0.9803796}
confusion matrix:
      0     1
0  1487    29
1    32  1524
---- Validation: 
scalar performance:
{'acc': 0.8696331, 'precision': 0.8697746, 'recall': 0.86945724, 'specificity': 0.86945724, 'f1': 0.86955166, 'auroc': 0.9147301, 'binary_precision': 0.8739903, 'binary_recall': 0.85873014, 'binary_specificity': 0.88018435, 'binary_f1_score': 0.866293}
confusion matrix:
     0    1
0  573   78
1   89  541
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8511111, 'precision': 0.8522872, 'recall': 0.8511111, 'specificity': 0.8511111, 'f1': 0.8509867, 'auroc': 0.9230222, 'binary_precision': 0.8319328, 'binary_recall': 0.88, 'binary_specificity': 0.82222223, 'binary_f1_score': 0.8552916}
confusion matrix:
     0    1
0  185   40
1   27  198
better model found
persisted
after epoch: 5,now: 2024-07-27 03:20:42.550320,epoch time: 0:01:05.785565,used: 0:05:28.697114,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_03_15_13_seed_1_23090499
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9765625, 'precision': 0.9771854, 'recall': 0.97683835, 'specificity': 0.97683835, 'f1': 0.97656083, 'auroc': 0.9981233, 'binary_precision': 0.99798656, 'binary_recall': 0.9556555, 'binary_specificity': 0.9980211, 'binary_f1_score': 0.9763624}
confusion matrix:
      0     1
0  1513     3
1    69  1487
---- Validation: 
scalar performance:
{'acc': 0.84777516, 'precision': 0.85540134, 'recall': 0.84656936, 'specificity': 0.84656936, 'f1': 0.84660256, 'auroc': 0.90690756, 'binary_precision': 0.90352505, 'binary_recall': 0.77301586, 'binary_specificity': 0.92012286, 'binary_f1_score': 0.8331908}
confusion matrix:
     0    1
0  599   52
1  143  487
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.84444445, 'precision': 0.86388016, 'recall': 0.8444444, 'specificity': 0.8444444, 'f1': 0.84233916, 'auroc': 0.9254519, 'binary_precision': 0.9479769, 'binary_recall': 0.72888887, 'binary_specificity': 0.96, 'binary_f1_score': 0.8241206}
confusion matrix:
     0    1
0  216    9
1   61  164
early stop counter: 1
val acc:0.8477751612663269, best validation acc: 0.8696330785751343, corresponding to test acc:                         0.851111114025116 / 0.8644444346427917
after epoch: 6,now: 2024-07-27 03:21:47.223725,epoch time: 0:01:04.673405,used: 0:06:33.370519,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_03_15_13_seed_1_23090499
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9840495, 'precision': 0.98408103, 'recall': 0.98414767, 'specificity': 0.98414767, 'f1': 0.9840492, 'auroc': 0.9988346, 'binary_precision': 0.99215686, 'binary_recall': 0.97620577, 'binary_specificity': 0.9920896, 'binary_f1_score': 0.98411673}
confusion matrix:
      0     1
0  1505    12
1    37  1518
---- Validation: 
scalar performance:
{'acc': 0.87275565, 'precision': 0.872957, 'recall': 0.872555, 'specificity': 0.872555, 'f1': 0.8726659, 'auroc': 0.91274965, 'binary_precision': 0.8784441, 'binary_recall': 0.86031747, 'binary_specificity': 0.8847926, 'binary_f1_score': 0.86928624}
confusion matrix:
     0    1
0  576   75
1   88  542
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8688889, 'precision': 0.8697727, 'recall': 0.86888885, 'specificity': 0.86888885, 'f1': 0.86881053, 'auroc': 0.9284938, 'binary_precision': 0.88785046, 'binary_recall': 0.84444445, 'binary_specificity': 0.8933333, 'binary_f1_score': 0.8656037}
confusion matrix:
     0    1
0  201   24
1   35  190
new oracle model saved
better model found
persisted
after epoch: 7,now: 2024-07-27 03:22:52.848324,epoch time: 0:01:05.624599,used: 0:07:38.995118,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_03_15_13_seed_1_23090499
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9235026, 'precision': 0.933884, 'recall': 0.92246896, 'specificity': 0.92246896, 'f1': 0.9229026, 'auroc': 0.99824613, 'binary_precision': 0.8701008, 'binary_recall': 0.9980732, 'binary_specificity': 0.8468647, 'binary_f1_score': 0.92970383}
confusion matrix:
      0     1
0  1283   232
1     3  1554
---- Validation: 
scalar performance:
{'acc': 0.7298985, 'precision': 0.7914626, 'recall': 0.7336149, 'specificity': 0.7336149, 'f1': 0.7168493, 'auroc': 0.9066589, 'binary_precision': 0.65334773, 'binary_recall': 0.96031743, 'binary_specificity': 0.50691247, 'binary_f1_score': 0.777635}
confusion matrix:
     0    1
0  330  321
1   25  605
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6844444, 'precision': 0.76490116, 'recall': 0.6844444, 'specificity': 0.6844444, 'f1': 0.6585152, 'auroc': 0.8947358, 'binary_precision': 0.61891115, 'binary_recall': 0.96, 'binary_specificity': 0.40888888, 'binary_f1_score': 0.7526133}
confusion matrix:
    0    1
0  92  133
1   9  216
early stop counter: 1
val acc:0.7298985123634338, best validation acc: 0.8727556467056274, corresponding to test acc:                         0.8688889145851135 / 0.8688889145851135
after epoch: 8,now: 2024-07-27 03:23:57.354311,epoch time: 0:01:04.505987,used: 0:08:43.501105,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_03_15_13_seed_1_23090499
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.961263, 'precision': 0.96358824, 'recall': 0.9616798, 'specificity': 0.9616798, 'f1': 0.96123475, 'auroc': 0.99815345, 'binary_precision': 0.99930364, 'binary_recall': 0.924018, 'binary_specificity': 0.99934167, 'binary_f1_score': 0.9601874}
confusion matrix:
      0     1
0  1518     1
1   118  1435
---- Validation: 
scalar performance:
{'acc': 0.79313034, 'precision': 0.8289552, 'recall': 0.7903994, 'specificity': 0.7903994, 'f1': 0.78623927, 'auroc': 0.8990905, 'binary_precision': 0.9334917, 'binary_recall': 0.6238095, 'binary_specificity': 0.9569892, 'binary_f1_score': 0.7478591}
confusion matrix:
     0    1
0  623   28
1  237  393
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.82222223, 'precision': 0.85898197, 'recall': 0.82222223, 'specificity': 0.82222223, 'f1': 0.81755155, 'auroc': 0.9218173, 'binary_precision': 0.9738562, 'binary_recall': 0.6622222, 'binary_specificity': 0.9822222, 'binary_f1_score': 0.7883598}
confusion matrix:
     0    1
0  221    4
1   76  149
early stop counter: 2
val acc:0.7931303381919861, best validation acc: 0.8727556467056274, corresponding to test acc:                         0.8688889145851135 / 0.8688889145851135
after epoch: 9,now: 2024-07-27 03:25:02.130480,epoch time: 0:01:04.776169,used: 0:09:48.277274,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_03_15_13_seed_1_23090499
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9781901, 'precision': 0.97871715, 'recall': 0.9784324, 'specificity': 0.9784324, 'f1': 0.97818893, 'auroc': 0.9991081, 'binary_precision': 0.997992, 'binary_recall': 0.95884246, 'binary_specificity': 0.99802244, 'binary_f1_score': 0.9780256}
confusion matrix:
      0     1
0  1514     3
1    64  1491
---- Validation: 
scalar performance:
{'acc': 0.6861827, 'precision': 0.7802004, 'recall': 0.68136203, 'specificity': 0.68136203, 'f1': 0.653942, 'auroc': 0.9073367, 'binary_precision': 0.93846154, 'binary_recall': 0.3873016, 'binary_specificity': 0.97542244, 'binary_f1_score': 0.54831463}
confusion matrix:
     0    1
0  635   16
1  386  244
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8111111, 'precision': 0.8601153, 'recall': 0.8111111, 'specificity': 0.8111111, 'f1': 0.80445886, 'auroc': 0.9234173, 'binary_precision': 0.9929578, 'binary_recall': 0.62666667, 'binary_specificity': 0.9955556, 'binary_f1_score': 0.7683924}
confusion matrix:
     0    1
0  224    1
1   84  141
early stop counter: 3
val acc:0.6861826777458191, best validation acc: 0.8727556467056274, corresponding to test acc:                         0.8688889145851135 / 0.8688889145851135
after epoch: 10,now: 2024-07-27 03:26:07.973686,epoch time: 0:01:05.843206,used: 0:10:54.120480,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_03_15_13_seed_1_23090499
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9716797, 'precision': 0.9725721, 'recall': 0.9720013, 'specificity': 0.9720013, 'f1': 0.9716755, 'auroc': 0.9989139, 'binary_precision': 0.99661934, 'binary_recall': 0.9473008, 'binary_specificity': 0.99670184, 'binary_f1_score': 0.97133446}
confusion matrix:
      0     1
0  1511     5
1    82  1474
---- Validation: 
scalar performance:
{'acc': 0.74863386, 'precision': 0.81982124, 'recall': 0.74472606, 'specificity': 0.74472606, 'f1': 0.73179233, 'auroc': 0.92218566, 'binary_precision': 0.96666664, 'binary_recall': 0.5063492, 'binary_specificity': 0.9831029, 'binary_f1_score': 0.6645834}
confusion matrix:
     0    1
0  640   11
1  311  319
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.77111113, 'precision': 0.83300173, 'recall': 0.77111113, 'specificity': 0.77111113, 'f1': 0.7599578, 'auroc': 0.8968296, 'binary_precision': 0.9765625, 'binary_recall': 0.5555556, 'binary_specificity': 0.9866667, 'binary_f1_score': 0.70821536}
confusion matrix:
     0    1
0  222    3
1  100  125
early stop counter: 4
val acc:0.748633861541748, best validation acc: 0.8727556467056274, corresponding to test acc:                         0.8688889145851135 / 0.8688889145851135
after epoch: 11,now: 2024-07-27 03:27:12.290897,epoch time: 0:01:04.317211,used: 0:11:58.437691,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_03_15_13_seed_1_23090499
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.98860675, 'precision': 0.9886396, 'recall': 0.98858017, 'specificity': 0.98858017, 'f1': 0.9886048, 'auroc': 0.9993925, 'binary_precision': 0.98653847, 'binary_recall': 0.9909852, 'binary_specificity': 0.9861751, 'binary_f1_score': 0.98875684}
confusion matrix:
      0     1
0  1498    21
1    14  1539
---- Validation: 
scalar performance:
{'acc': 0.86260736, 'precision': 0.87189054, 'recall': 0.8613159, 'specificity': 0.8613159, 'f1': 0.86141133, 'auroc': 0.92181265, 'binary_precision': 0.9266917, 'binary_recall': 0.78253967, 'binary_specificity': 0.94009215, 'binary_f1_score': 0.84853697}
confusion matrix:
     0    1
0  612   39
1  137  493
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.83555555, 'precision': 0.8671465, 'recall': 0.83555555, 'specificity': 0.83555555, 'f1': 0.8319404, 'auroc': 0.9167012, 'binary_precision': 0.9748428, 'binary_recall': 0.6888889, 'binary_specificity': 0.9822222, 'binary_f1_score': 0.8072917}
confusion matrix:
     0    1
0  221    4
1   70  155
early stop counter: 5
val acc:0.8626073598861694, best validation acc: 0.8727556467056274, corresponding to test acc:                         0.8688889145851135 / 0.8688889145851135
after epoch: 12,now: 2024-07-27 03:28:16.832056,epoch time: 0:01:04.541159,used: 0:13:02.978850,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_03_15_13_seed_1_23090499
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 12 with time: 0:13:02.978850 at 2024-07-27 03:28:16.832056
persisted model performance metric: 

scalar performance:
{'acc': 0.8688889, 'precision': 0.8697727, 'recall': 0.86888885, 'specificity': 0.86888885, 'f1': 0.86881053, 'auroc': 0.9284938, 'binary_precision': 0.88785046, 'binary_recall': 0.84444445, 'binary_specificity': 0.8933333, 'binary_f1_score': 0.8656037}
confusion matrix:
     0    1
0  201   24
1   35  190
oracle model performance metric: 

scalar performance:
{'acc': 0.8688889, 'precision': 0.8697727, 'recall': 0.86888885, 'specificity': 0.86888885, 'f1': 0.86881053, 'auroc': 0.9284938, 'binary_precision': 0.88785046, 'binary_recall': 0.84444445, 'binary_specificity': 0.8933333, 'binary_f1_score': 0.8656037}
confusion matrix:
     0    1
0  201   24
1   35  190
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_diva_irm_3seeds_nofreeze_2024-07-27_01-18-02/rule_results/18.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_diva_irm_3seeds_nofreeze_2024-07-27_01-18-02/confusion_matrix/18.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    917 MiB |  13688 MiB |  47665 GiB |  47664 GiB |
|       from large pool |    857 MiB |  13629 MiB |  47068 GiB |  47067 GiB |
|       from small pool |     60 MiB |    100 MiB |    597 GiB |    597 GiB |
|---------------------------------------------------------------------------|
| Active memory         |    917 MiB |  13688 MiB |  47665 GiB |  47664 GiB |
|       from large pool |    857 MiB |  13629 MiB |  47068 GiB |  47067 GiB |
|       from small pool |     60 MiB |    100 MiB |    597 GiB |    597 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |    904 MiB |  13680 MiB |  47620 GiB |  47619 GiB |
|       from large pool |    844 MiB |  13621 MiB |  47024 GiB |  47023 GiB |
|       from small pool |     60 MiB |    100 MiB |    595 GiB |    595 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  14784 MiB |  14836 MiB |  26976 MiB |  12192 MiB |
|       from large pool |  14672 MiB |  14730 MiB |  26830 MiB |  12158 MiB |
|       from small pool |    112 MiB |    112 MiB |    146 MiB |     34 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |   1982 MiB |   2737 MiB |  37711 GiB |  37709 GiB |
|       from large pool |   1972 MiB |   2728 MiB |  37111 GiB |  37109 GiB |
|       from small pool |      9 MiB |     39 MiB |    600 GiB |    599 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    1796    |    3099    |    8579 K  |    8578 K  |
|       from large pool |     265    |    1491    |    4254 K  |    4254 K  |
|       from small pool |    1531    |    2223    |    4325 K  |    4324 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    1796    |    3099    |    8579 K  |    8578 K  |
|       from large pool |     265    |    1491    |    4254 K  |    4254 K  |
|       from small pool |    1531    |    2223    |    4325 K  |    4324 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     558    |     594    |    1060    |     502    |
|       from large pool |     502    |     541    |     987    |     485    |
|       from small pool |      56    |      56    |      73    |      17    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     139    |     578    |    5218 K  |    5218 K  |
|       from large pool |      53    |     535    |    2846 K  |    2846 K  |
|       from small pool |      86    |     238    |    2372 K  |    2371 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13688 MiB |  47665 GiB |  47665 GiB |
|       from large pool |  16640 KiB |  13629 MiB |  47068 GiB |  47068 GiB |
|       from small pool |      0 KiB |    100 MiB |    597 GiB |    597 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13688 MiB |  47665 GiB |  47665 GiB |
|       from large pool |  16640 KiB |  13629 MiB |  47068 GiB |  47068 GiB |
|       from small pool |      0 KiB |    100 MiB |    597 GiB |    597 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13680 MiB |  47620 GiB |  47620 GiB |
|       from large pool |  16640 KiB |  13621 MiB |  47024 GiB |  47024 GiB |
|       from small pool |      0 KiB |    100 MiB |    595 GiB |    595 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2900 MiB |  14836 MiB |  26976 MiB |  24076 MiB |
|       from large pool |   2830 MiB |  14730 MiB |  26830 MiB |  24000 MiB |
|       from small pool |     70 MiB |    112 MiB |    146 MiB |     76 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   2737 MiB |  37711 GiB |  37711 GiB |
|       from large pool |  24320 KiB |   2728 MiB |  37111 GiB |  37111 GiB |
|       from small pool |      0 KiB |     45 MiB |    600 GiB |    600 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3099    |    8579 K  |    8579 K  |
|       from large pool |       2    |    1491    |    4254 K  |    4254 K  |
|       from small pool |       0    |    2223    |    4325 K  |    4325 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3099    |    8579 K  |    8579 K  |
|       from large pool |       2    |    1491    |    4254 K  |    4254 K  |
|       from small pool |       0    |    2223    |    4325 K  |    4325 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      91    |     594    |    1060    |     969    |
|       from large pool |      56    |     541    |     987    |     931    |
|       from small pool |      35    |      56    |      73    |      38    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       2    |     578    |    5219 K  |    5219 K  |
|       from large pool |       2    |     535    |    2846 K  |    2846 K  |
|       from small pool |       0    |     238    |    2372 K  |    2372 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13688 MiB |  47665 GiB |  47665 GiB |
|       from large pool |  16640 KiB |  13629 MiB |  47068 GiB |  47068 GiB |
|       from small pool |      0 KiB |    100 MiB |    597 GiB |    597 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13688 MiB |  47665 GiB |  47665 GiB |
|       from large pool |  16640 KiB |  13629 MiB |  47068 GiB |  47068 GiB |
|       from small pool |      0 KiB |    100 MiB |    597 GiB |    597 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13680 MiB |  47620 GiB |  47620 GiB |
|       from large pool |  16640 KiB |  13621 MiB |  47024 GiB |  47024 GiB |
|       from small pool |      0 KiB |    100 MiB |    595 GiB |    595 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2900 MiB |  14836 MiB |  26976 MiB |  24076 MiB |
|       from large pool |   2830 MiB |  14730 MiB |  26830 MiB |  24000 MiB |
|       from small pool |     70 MiB |    112 MiB |    146 MiB |     76 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   2737 MiB |  37711 GiB |  37711 GiB |
|       from large pool |  24320 KiB |   2728 MiB |  37111 GiB |  37111 GiB |
|       from small pool |      0 KiB |     45 MiB |    600 GiB |    600 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3099    |    8579 K  |    8579 K  |
|       from large pool |       2    |    1491    |    4254 K  |    4254 K  |
|       from small pool |       0    |    2223    |    4325 K  |    4325 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3099    |    8579 K  |    8579 K  |
|       from large pool |       2    |    1491    |    4254 K  |    4254 K  |
|       from small pool |       0    |    2223    |    4325 K  |    4325 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      91    |     594    |    1060    |     969    |
|       from large pool |      56    |     541    |     987    |     931    |
|       from small pool |      35    |      56    |      73    |      38    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       2    |     578    |    5219 K  |    5219 K  |
|       from large pool |       2    |     535    |    2846 K  |    2846 K  |
|       from small pool |       0    |     238    |    2372 K  |    2372 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/init.py:452: UserWarning: Initializing zero-element tensors is a no-op
  warnings.warn("Initializing zero-element tensors is a no-op")
Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main

using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_03_28_47_seed_2_23090499

 Experiment start at: 2024-07-27 03:28:48.192190
before training, model accuracy: 0.6134259104728699
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9532068, 'precision': 0.9533066, 'recall': 0.9532784, 'specificity': 0.9532784, 'f1': 0.9532067, 'auroc': 0.9896965, 'binary_precision': 0.96227664, 'binary_recall': 0.9441559, 'binary_specificity': 0.96240103, 'binary_f1_score': 0.9531301}
confusion matrix:
      0     1
0  1459    57
1    86  1454
---- Validation: 
scalar performance:
{'acc': 0.7026604, 'precision': 0.7603915, 'recall': 0.70874095, 'specificity': 0.70874095, 'f1': 0.6889834, 'auroc': 0.90400505, 'binary_precision': 0.63095236, 'binary_recall': 0.937299, 'binary_specificity': 0.48018292, 'binary_f1_score': 0.7542044}
confusion matrix:
     0    1
0  315  341
1   39  583
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6990741, 'precision': 0.7759358, 'recall': 0.6990741, 'specificity': 0.6990741, 'f1': 0.6765499, 'auroc': 0.9092078, 'binary_precision': 0.630303, 'binary_recall': 0.962963, 'binary_specificity': 0.4351852, 'binary_f1_score': 0.7619048}
confusion matrix:
    0    1
0  94  122
1   8  208
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-27 03:29:55.913327,epoch time: 0:01:07.721137,used: 0:01:07.721137,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_03_28_47_seed_2_23090499
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.966623, 'precision': 0.96712345, 'recall': 0.9667649, 'specificity': 0.9667649, 'f1': 0.9666194, 'auroc': 0.99559504, 'binary_precision': 0.98450136, 'binary_recall': 0.9487013, 'binary_specificity': 0.9848285, 'binary_f1_score': 0.96626985}
confusion matrix:
      0     1
0  1493    23
1    79  1461
---- Validation: 
scalar performance:
{'acc': 0.8333333, 'precision': 0.8351465, 'recall': 0.83431935, 'specificity': 0.83431935, 'f1': 0.83329654, 'auroc': 0.901368, 'binary_precision': 0.80296296, 'binary_recall': 0.87138265, 'binary_specificity': 0.7972561, 'binary_f1_score': 0.8357749}
confusion matrix:
     0    1
0  523  133
1   80  542
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7916667, 'precision': 0.8096105, 'recall': 0.7916666, 'specificity': 0.7916666, 'f1': 0.7886038, 'auroc': 0.9073217, 'binary_precision': 0.73507464, 'binary_recall': 0.912037, 'binary_specificity': 0.6712963, 'binary_f1_score': 0.8140496}
confusion matrix:
     0    1
0  145   71
1   19  197
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-07-27 03:31:00.044566,epoch time: 0:01:04.131239,used: 0:02:11.852376,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_03_28_47_seed_2_23090499
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.96825916, 'precision': 0.9690082, 'recall': 0.96842945, 'specificity': 0.96842945, 'f1': 0.9682529, 'auroc': 0.99269074, 'binary_precision': 0.9898167, 'binary_recall': 0.94675326, 'binary_specificity': 0.99010557, 'binary_f1_score': 0.9678062}
confusion matrix:
      0     1
0  1501    15
1    82  1458
---- Validation: 
scalar performance:
{'acc': 0.79499215, 'precision': 0.80121046, 'recall': 0.7929721, 'specificity': 0.7929721, 'f1': 0.79304385, 'auroc': 0.87294626, 'binary_precision': 0.8383459, 'binary_recall': 0.7170418, 'binary_specificity': 0.86890244, 'binary_f1_score': 0.7729636}
confusion matrix:
     0    1
0  570   86
1  176  446
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8148148, 'precision': 0.8148418, 'recall': 0.8148148, 'specificity': 0.8148148, 'f1': 0.8148109, 'auroc': 0.89139664, 'binary_precision': 0.817757, 'binary_recall': 0.8101852, 'binary_specificity': 0.8194444, 'binary_f1_score': 0.81395346}
confusion matrix:
     0    1
0  177   39
1   41  175
new oracle model saved
early stop counter: 1
val acc:0.7949921488761902, best validation acc: 0.8333333134651184, corresponding to test acc:                         0.7916666865348816 / 0.8148148059844971
after epoch: 3,now: 2024-07-27 03:32:03.806157,epoch time: 0:01:03.761591,used: 0:03:15.613967,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_03_28_47_seed_2_23090499
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9646597, 'precision': 0.9660078, 'recall': 0.9648837, 'specificity': 0.9648837, 'f1': 0.9646442, 'auroc': 0.996079, 'binary_precision': 0.9931129, 'binary_recall': 0.93636364, 'binary_specificity': 0.9934037, 'binary_f1_score': 0.9639038}
confusion matrix:
      0     1
0  1506    10
1    98  1442
---- Validation: 
scalar performance:
{'acc': 0.7175274, 'precision': 0.7513768, 'recall': 0.71243185, 'specificity': 0.71243185, 'f1': 0.7044326, 'auroc': 0.83503497, 'binary_precision': 0.8372093, 'binary_recall': 0.5209003, 'binary_specificity': 0.9039634, 'binary_f1_score': 0.64222}
confusion matrix:
     0    1
0  593   63
1  298  324
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8333333, 'precision': 0.83566433, 'recall': 0.8333334, 'specificity': 0.8333334, 'f1': 0.83304346, 'auroc': 0.90487826, 'binary_precision': 0.8636364, 'binary_recall': 0.7916667, 'binary_specificity': 0.875, 'binary_f1_score': 0.826087}
confusion matrix:
     0    1
0  189   27
1   45  171
new oracle model saved
early stop counter: 2
val acc:0.7175273895263672, best validation acc: 0.8333333134651184, corresponding to test acc:                         0.7916666865348816 / 0.8333333134651184
after epoch: 4,now: 2024-07-27 03:33:07.353043,epoch time: 0:01:03.546886,used: 0:04:19.160853,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_03_28_47_seed_2_23090499
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.96727747, 'precision': 0.96826345, 'recall': 0.96747077, 'specificity': 0.96747077, 'f1': 0.967268, 'auroc': 0.9972471, 'binary_precision': 0.9918033, 'binary_recall': 0.94285715, 'binary_specificity': 0.99208444, 'binary_f1_score': 0.96671104}
confusion matrix:
      0     1
0  1504    12
1    88  1452
---- Validation: 
scalar performance:
{'acc': 0.6760563, 'precision': 0.7030901, 'recall': 0.670869, 'specificity': 0.670869, 'f1': 0.6606862, 'auroc': 0.81102955, 'binary_precision': 0.7708333, 'binary_recall': 0.47588426, 'binary_specificity': 0.86585367, 'binary_f1_score': 0.58846915}
confusion matrix:
     0    1
0  568   88
1  326  296
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7916667, 'precision': 0.800982, 'recall': 0.7916666, 'specificity': 0.7916666, 'f1': 0.7900421, 'auroc': 0.8921896, 'binary_precision': 0.7480315, 'binary_recall': 0.8796296, 'binary_specificity': 0.7037037, 'binary_f1_score': 0.8085106}
confusion matrix:
     0    1
0  152   64
1   26  190
early stop counter: 3
val acc:0.6760563254356384, best validation acc: 0.8333333134651184, corresponding to test acc:                         0.7916666865348816 / 0.8333333134651184
after epoch: 5,now: 2024-07-27 03:34:11.587836,epoch time: 0:01:04.234793,used: 0:05:23.395646,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_03_28_47_seed_2_23090499
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.98036647, 'precision': 0.980495, 'recall': 0.9803139, 'specificity': 0.9803139, 'f1': 0.9803624, 'auroc': 0.99869525, 'binary_precision': 0.974359, 'binary_recall': 0.987013, 'binary_specificity': 0.97361475, 'binary_f1_score': 0.9806452}
confusion matrix:
      0     1
0  1476    40
1    20  1520
---- Validation: 
scalar performance:
{'acc': 0.82472616, 'precision': 0.83270454, 'recall': 0.8267685, 'specificity': 0.8267685, 'f1': 0.8241987, 'auroc': 0.9091444, 'binary_precision': 0.77410465, 'binary_recall': 0.903537, 'binary_specificity': 0.75, 'binary_f1_score': 0.8338279}
confusion matrix:
     0    1
0  492  164
1   60  562
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.775463, 'precision': 0.7993362, 'recall': 0.775463, 'specificity': 0.775463, 'f1': 0.77089494, 'auroc': 0.9293124, 'binary_precision': 0.71480143, 'binary_recall': 0.9166667, 'binary_specificity': 0.6342593, 'binary_f1_score': 0.8032454}
confusion matrix:
     0    1
0  137   79
1   18  198
early stop counter: 4
val acc:0.8247261643409729, best validation acc: 0.8333333134651184, corresponding to test acc:                         0.7916666865348816 / 0.8333333134651184
after epoch: 6,now: 2024-07-27 03:35:15.270517,epoch time: 0:01:03.682681,used: 0:06:27.078327,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_03_28_47_seed_2_23090499
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9842932, 'precision': 0.9845278, 'recall': 0.984395, 'specificity': 0.984395, 'f1': 0.98429275, 'auroc': 0.9985449, 'binary_precision': 0.99733335, 'binary_recall': 0.9714286, 'binary_specificity': 0.9973615, 'binary_f1_score': 0.9842105}
confusion matrix:
      0     1
0  1512     4
1    44  1496
---- Validation: 
scalar performance:
{'acc': 0.82472616, 'precision': 0.83612585, 'recall': 0.8222272, 'specificity': 0.8222272, 'f1': 0.8223436, 'auroc': 0.89988285, 'binary_precision': 0.8917323, 'binary_recall': 0.7282958, 'binary_specificity': 0.91615856, 'binary_f1_score': 0.8017699}
confusion matrix:
     0    1
0  601   55
1  169  453
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8518519, 'precision': 0.85877264, 'recall': 0.8518518, 'specificity': 0.8518518, 'f1': 0.85113394, 'auroc': 0.9207176, 'binary_precision': 0.9086022, 'binary_recall': 0.7824074, 'binary_specificity': 0.9212963, 'binary_f1_score': 0.84079605}
confusion matrix:
     0    1
0  199   17
1   47  169
new oracle model saved
early stop counter: 5
val acc:0.8247261643409729, best validation acc: 0.8333333134651184, corresponding to test acc:                         0.7916666865348816 / 0.8518518805503845
after epoch: 7,now: 2024-07-27 03:36:19.000274,epoch time: 0:01:03.729757,used: 0:07:30.808084,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_03_28_47_seed_2_23090499
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 7 with time: 0:07:30.808084 at 2024-07-27 03:36:19.000274
persisted model performance metric: 

scalar performance:
{'acc': 0.7916667, 'precision': 0.8096105, 'recall': 0.7916666, 'specificity': 0.7916666, 'f1': 0.7886038, 'auroc': 0.9073217, 'binary_precision': 0.73507464, 'binary_recall': 0.912037, 'binary_specificity': 0.6712963, 'binary_f1_score': 0.8140496}
confusion matrix:
     0    1
0  145   71
1   19  197
oracle model performance metric: 

scalar performance:
{'acc': 0.8518519, 'precision': 0.85877264, 'recall': 0.8518518, 'specificity': 0.8518518, 'f1': 0.85113394, 'auroc': 0.9207176, 'binary_precision': 0.9086022, 'binary_recall': 0.7824074, 'binary_specificity': 0.9212963, 'binary_f1_score': 0.84079605}
confusion matrix:
     0    1
0  199   17
1   47  169
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_diva_irm_3seeds_nofreeze_2024-07-27_01-18-02/rule_results/18.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_diva_irm_3seeds_nofreeze_2024-07-27_01-18-02/confusion_matrix/18.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    916 MiB |  13688 MiB |  64983 GiB |  64982 GiB |
|       from large pool |    856 MiB |  13629 MiB |  64169 GiB |  64168 GiB |
|       from small pool |     60 MiB |    100 MiB |    813 GiB |    813 GiB |
|---------------------------------------------------------------------------|
| Active memory         |    916 MiB |  13688 MiB |  64983 GiB |  64982 GiB |
|       from large pool |    856 MiB |  13629 MiB |  64169 GiB |  64168 GiB |
|       from small pool |     60 MiB |    100 MiB |    813 GiB |    813 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |    904 MiB |  13680 MiB |  64921 GiB |  64920 GiB |
|       from large pool |    844 MiB |  13621 MiB |  64109 GiB |  64108 GiB |
|       from small pool |     60 MiB |    100 MiB |    812 GiB |    812 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  14756 MiB |  14836 MiB |  38832 MiB |  24076 MiB |
|       from large pool |  14650 MiB |  14730 MiB |  38650 MiB |  24000 MiB |
|       from small pool |    106 MiB |    112 MiB |    182 MiB |     76 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |   1999 MiB |   3226 MiB |  51986 GiB |  51984 GiB |
|       from large pool |   1989 MiB |   3217 MiB |  51169 GiB |  51167 GiB |
|       from small pool |      9 MiB |     45 MiB |    817 GiB |    817 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    1784    |    3099    |   11703 K  |   11701 K  |
|       from large pool |     265    |    1491    |    5800 K  |    5800 K  |
|       from small pool |    1519    |    2223    |    5902 K  |    5901 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    1784    |    3099    |   11703 K  |   11701 K  |
|       from large pool |     265    |    1491    |    5800 K  |    5800 K  |
|       from small pool |    1519    |    2223    |    5902 K  |    5901 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     548    |     594    |    1517    |     969    |
|       from large pool |     495    |     541    |    1426    |     931    |
|       from small pool |      53    |      56    |      91    |      38    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     134    |     578    |    7201 K  |    7201 K  |
|       from large pool |      55    |     535    |    3979 K  |    3979 K  |
|       from small pool |      79    |     238    |    3221 K  |    3221 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13688 MiB |  64983 GiB |  64983 GiB |
|       from large pool |  16640 KiB |  13629 MiB |  64169 GiB |  64169 GiB |
|       from small pool |      0 KiB |    100 MiB |    813 GiB |    813 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13688 MiB |  64983 GiB |  64983 GiB |
|       from large pool |  16640 KiB |  13629 MiB |  64169 GiB |  64169 GiB |
|       from small pool |      0 KiB |    100 MiB |    813 GiB |    813 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13680 MiB |  64921 GiB |  64921 GiB |
|       from large pool |  16640 KiB |  13621 MiB |  64109 GiB |  64109 GiB |
|       from small pool |      0 KiB |    100 MiB |    812 GiB |    812 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2916 MiB |  14836 MiB |  38832 MiB |  35916 MiB |
|       from large pool |   2846 MiB |  14730 MiB |  38650 MiB |  35804 MiB |
|       from small pool |     70 MiB |    112 MiB |    182 MiB |    112 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   3226 MiB |  51987 GiB |  51987 GiB |
|       from large pool |  24320 KiB |   3217 MiB |  51169 GiB |  51169 GiB |
|       from small pool |      0 KiB |     45 MiB |    817 GiB |    817 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3099    |   11703 K  |   11703 K  |
|       from large pool |       2    |    1491    |    5800 K  |    5800 K  |
|       from small pool |       0    |    2223    |    5902 K  |    5902 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3099    |   11703 K  |   11703 K  |
|       from large pool |       2    |    1491    |    5800 K  |    5800 K  |
|       from small pool |       0    |    2223    |    5902 K  |    5902 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      92    |     594    |    1517    |    1425    |
|       from large pool |      57    |     541    |    1426    |    1369    |
|       from small pool |      35    |      56    |      91    |      56    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       2    |     578    |    7201 K  |    7201 K  |
|       from large pool |       2    |     535    |    3979 K  |    3979 K  |
|       from small pool |       0    |     238    |    3221 K  |    3221 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Sat Jul 27 03:36:25 2024]
Finished job 0.
1 of 1 steps (100%) done
