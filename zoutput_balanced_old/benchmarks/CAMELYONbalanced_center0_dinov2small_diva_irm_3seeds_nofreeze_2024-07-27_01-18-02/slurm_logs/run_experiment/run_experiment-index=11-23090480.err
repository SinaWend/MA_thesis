Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Sat Jul 27 01:18:56 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_diva_irm_3seeds_nofreeze_2024-07-27_01-18-02/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_diva_irm_3seeds_nofreeze_2024-07-27_01-18-02/rule_results/11.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=11
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/swiglu_ffn.py:51: UserWarning: xFormers is not available (SwiGLU)
  warnings.warn("xFormers is not available (SwiGLU)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/attention.py:33: UserWarning: xFormers is not available (Attention)
  warnings.warn("xFormers is not available (Attention)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/block.py:40: UserWarning: xFormers is not available (Block)
  warnings.warn("xFormers is not available (Block)")
Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main

using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_01_19_34_seed_0_23090480

 Experiment start at: 2024-07-27 01:19:35.631403
before training, model accuracy: 0.46279069781303406
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.94401044, 'precision': 0.9470042, 'recall': 0.9446331, 'specificity': 0.9446331, 'f1': 0.9439602, 'auroc': 0.9898758, 'binary_precision': 0.98734176, 'binary_recall': 0.90115535, 'binary_specificity': 0.98811096, 'binary_f1_score': 0.9422819}
confusion matrix:
      0     1
0  1496    18
1   154  1404
---- Validation: 
scalar performance:
{'acc': 0.52018636, 'precision': 0.56704897, 'recall': 0.51397187, 'specificity': 0.51397187, 'f1': 0.3970823, 'auroc': 0.8089713, 'binary_precision': 0.6197183, 'binary_recall': 0.06929134, 'binary_specificity': 0.9586524, 'binary_f1_score': 0.12464589}
confusion matrix:
     0   1
0  626  27
1  591  44
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5534884, 'precision': 0.6098449, 'recall': 0.5534884, 'specificity': 0.5534884, 'f1': 0.48779035, 'auroc': 0.81975126, 'binary_precision': 0.6885246, 'binary_recall': 0.19534884, 'binary_specificity': 0.9116279, 'binary_f1_score': 0.30434784}
confusion matrix:
     0   1
0  196  19
1  173  42
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-27 01:21:10.325108,epoch time: 0:01:34.693705,used: 0:01:34.693705,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_01_19_34_seed_0_23090480
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9215495, 'precision': 0.9309963, 'recall': 0.9226386, 'specificity': 0.9226386, 'f1': 0.92123866, 'auroc': 0.9924686, 'binary_precision': 0.998486, 'binary_recall': 0.8465982, 'binary_specificity': 0.998679, 'binary_f1_score': 0.9162904}
confusion matrix:
      0     1
0  1512     2
1   239  1319
---- Validation: 
scalar performance:
{'acc': 0.6001553, 'precision': 0.75053614, 'recall': 0.59466183, 'specificity': 0.59466183, 'f1': 0.5233589, 'auroc': 0.9040817, 'binary_precision': 0.9411765, 'binary_recall': 0.2015748, 'binary_specificity': 0.98774886, 'binary_f1_score': 0.33203632}
confusion matrix:
     0    1
0  645    8
1  507  128
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6348837, 'precision': 0.78897846, 'recall': 0.6348837, 'specificity': 0.6348837, 'f1': 0.5787234, 'auroc': 0.9171877, 'binary_precision': 1.0, 'binary_recall': 0.26976743, 'binary_specificity': 1.0, 'binary_f1_score': 0.42490843}
confusion matrix:
     0   1
0  215   0
1  157  58
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-07-27 01:22:40.795783,epoch time: 0:01:30.470675,used: 0:03:05.164380,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_01_19_34_seed_0_23090480
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9713542, 'precision': 0.9718319, 'recall': 0.9716159, 'specificity': 0.9716159, 'f1': 0.9713532, 'auroc': 0.9957378, 'binary_precision': 0.990648, 'binary_recall': 0.9524727, 'binary_specificity': 0.9907591, 'binary_f1_score': 0.97118527}
confusion matrix:
      0     1
0  1501    14
1    74  1483
---- Validation: 
scalar performance:
{'acc': 0.82686335, 'precision': 0.8285878, 'recall': 0.82634115, 'specificity': 0.82634115, 'f1': 0.82644814, 'auroc': 0.9013854, 'binary_precision': 0.84915257, 'binary_recall': 0.7889764, 'binary_specificity': 0.863706, 'binary_f1_score': 0.8179592}
confusion matrix:
     0    1
0  564   89
1  134  501
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.83255816, 'precision': 0.8344102, 'recall': 0.83255816, 'specificity': 0.83255816, 'f1': 0.83232594, 'auroc': 0.90338564, 'binary_precision': 0.8592965, 'binary_recall': 0.7953488, 'binary_specificity': 0.8697674, 'binary_f1_score': 0.82608694}
confusion matrix:
     0    1
0  187   28
1   44  171
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-07-27 01:24:11.569094,epoch time: 0:01:30.773311,used: 0:04:35.937691,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_01_19_34_seed_0_23090480
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9505208, 'precision': 0.95429933, 'recall': 0.95117927, 'specificity': 0.95117927, 'f1': 0.9504596, 'auroc': 0.99653, 'binary_precision': 0.9992893, 'binary_recall': 0.90301865, 'binary_specificity': 0.99933994, 'binary_f1_score': 0.9487179}
confusion matrix:
      0     1
0  1514     1
1   151  1406
---- Validation: 
scalar performance:
{'acc': 0.7212733, 'precision': 0.79902595, 'recall': 0.71767014, 'specificity': 0.71767014, 'f1': 0.6997297, 'auroc': 0.8918667, 'binary_precision': 0.9480519, 'binary_recall': 0.45984253, 'binary_specificity': 0.9754977, 'binary_f1_score': 0.6193001}
confusion matrix:
     0    1
0  637   16
1  343  292
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.82325584, 'precision': 0.861585, 'recall': 0.8232558, 'specificity': 0.8232558, 'f1': 0.8184445, 'auroc': 0.91368306, 'binary_precision': 0.97931033, 'binary_recall': 0.6604651, 'binary_specificity': 0.9860465, 'binary_f1_score': 0.7888889}
confusion matrix:
     0    1
0  212    3
1   73  142
early stop counter: 1
val acc:0.7212733030319214, best validation acc: 0.8268633484840393, corresponding to test acc:                         0.8325581550598145 / 0.8325581550598145
after epoch: 4,now: 2024-07-27 01:25:41.426418,epoch time: 0:01:29.857324,used: 0:06:05.795015,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_01_19_34_seed_0_23090480
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.96875, 'precision': 0.96969014, 'recall': 0.9691167, 'specificity': 0.9691167, 'f1': 0.9687457, 'auroc': 0.99679506, 'binary_precision': 0.9945873, 'binary_recall': 0.9435173, 'binary_specificity': 0.994716, 'binary_f1_score': 0.96837944}
confusion matrix:
      0     1
0  1506     8
1    88  1470
---- Validation: 
scalar performance:
{'acc': 0.70108694, 'precision': 0.78401387, 'recall': 0.69726276, 'specificity': 0.69726276, 'f1': 0.67498606, 'auroc': 0.8860034, 'binary_precision': 0.9340278, 'binary_recall': 0.42362204, 'binary_specificity': 0.9709035, 'binary_f1_score': 0.5828819}
confusion matrix:
     0    1
0  634   19
1  366  269
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7953488, 'precision': 0.8428123, 'recall': 0.7953489, 'specificity': 0.7953489, 'f1': 0.78801125, 'auroc': 0.90550566, 'binary_precision': 0.97037035, 'binary_recall': 0.60930234, 'binary_specificity': 0.98139536, 'binary_f1_score': 0.74857146}
confusion matrix:
     0    1
0  211    4
1   84  131
early stop counter: 2
val acc:0.7010869383811951, best validation acc: 0.8268633484840393, corresponding to test acc:                         0.8325581550598145 / 0.8325581550598145
after epoch: 5,now: 2024-07-27 01:27:10.681815,epoch time: 0:01:29.255397,used: 0:07:35.050412,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_01_19_34_seed_0_23090480
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9742839, 'precision': 0.9743152, 'recall': 0.9743806, 'specificity': 0.9743806, 'f1': 0.97428346, 'auroc': 0.99650645, 'binary_precision': 0.9823529, 'binary_recall': 0.96655947, 'binary_specificity': 0.9822017, 'binary_f1_score': 0.97439224}
confusion matrix:
      0     1
0  1490    27
1    52  1503
---- Validation: 
scalar performance:
{'acc': 0.8291925, 'precision': 0.8373441, 'recall': 0.8280957, 'specificity': 0.8280957, 'f1': 0.82779574, 'auroc': 0.9043597, 'binary_precision': 0.88640594, 'binary_recall': 0.7496063, 'binary_specificity': 0.906585, 'binary_f1_score': 0.8122866}
confusion matrix:
     0    1
0  592   61
1  159  476
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.80697674, 'precision': 0.8077824, 'recall': 0.8069768, 'specificity': 0.8069768, 'f1': 0.8068503, 'auroc': 0.90100586, 'binary_precision': 0.8235294, 'binary_recall': 0.7813954, 'binary_specificity': 0.83255816, 'binary_f1_score': 0.80190927}
confusion matrix:
     0    1
0  179   36
1   47  168
better model found
persisted
after epoch: 6,now: 2024-07-27 01:28:40.687119,epoch time: 0:01:30.005304,used: 0:09:05.055716,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_01_19_34_seed_0_23090480
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.98046875, 'precision': 0.98076916, 'recall': 0.9806877, 'specificity': 0.9806877, 'f1': 0.98046863, 'auroc': 0.99831104, 'binary_precision': 0.99668217, 'binary_recall': 0.96467566, 'binary_specificity': 0.9966997, 'binary_f1_score': 0.9804177}
confusion matrix:
      0     1
0  1510     5
1    55  1502
---- Validation: 
scalar performance:
{'acc': 0.8167702, 'precision': 0.821205, 'recall': 0.8159313, 'specificity': 0.8159313, 'f1': 0.8158305, 'auroc': 0.90310985, 'binary_precision': 0.85561496, 'binary_recall': 0.7559055, 'binary_specificity': 0.87595713, 'binary_f1_score': 0.80267555}
confusion matrix:
     0    1
0  572   81
1  155  480
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8, 'precision': 0.8006504, 'recall': 0.8, 'specificity': 0.8, 'f1': 0.79989177, 'auroc': 0.9043591, 'binary_precision': 0.7866667, 'binary_recall': 0.82325584, 'binary_specificity': 0.7767442, 'binary_f1_score': 0.80454546}
confusion matrix:
     0    1
0  167   48
1   38  177
early stop counter: 1
val acc:0.8167701959609985, best validation acc: 0.8291925191879272, corresponding to test acc:                         0.8069767355918884 / 0.8325581550598145
after epoch: 7,now: 2024-07-27 01:30:10.196967,epoch time: 0:01:29.509848,used: 0:10:34.565564,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_01_19_34_seed_0_23090480
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9840495, 'precision': 0.9841579, 'recall': 0.98397624, 'specificity': 0.98397624, 'f1': 0.9840436, 'auroc': 0.9991237, 'binary_precision': 0.9796567, 'binary_recall': 0.9890886, 'binary_specificity': 0.97886395, 'binary_f1_score': 0.9843501}
confusion matrix:
      0     1
0  1482    32
1    17  1541
---- Validation: 
scalar performance:
{'acc': 0.7779503, 'precision': 0.7928178, 'recall': 0.7763442, 'specificity': 0.7763442, 'f1': 0.7743811, 'auroc': 0.86573416, 'binary_precision': 0.85539716, 'binary_recall': 0.6614173, 'binary_specificity': 0.89127105, 'binary_f1_score': 0.74600357}
confusion matrix:
     0    1
0  582   71
1  215  420
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8395349, 'precision': 0.8434655, 'recall': 0.8395349, 'specificity': 0.8395349, 'f1': 0.8390745, 'auroc': 0.9170146, 'binary_precision': 0.8802083, 'binary_recall': 0.7860465, 'binary_specificity': 0.89302325, 'binary_f1_score': 0.83046687}
confusion matrix:
     0    1
0  192   23
1   46  169
new oracle model saved
early stop counter: 2
val acc:0.7779502868652344, best validation acc: 0.8291925191879272, corresponding to test acc:                         0.8069767355918884 / 0.8395348787307739
after epoch: 8,now: 2024-07-27 01:31:40.142534,epoch time: 0:01:29.945567,used: 0:12:04.511131,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_01_19_34_seed_0_23090480
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9635417, 'precision': 0.9651958, 'recall': 0.9639889, 'specificity': 0.9639889, 'f1': 0.9635278, 'auroc': 0.99676025, 'binary_precision': 0.99656355, 'binary_recall': 0.9312781, 'binary_specificity': 0.9966997, 'binary_f1_score': 0.9628154}
confusion matrix:
      0     1
0  1510     5
1   107  1450
---- Validation: 
scalar performance:
{'acc': 0.6995342, 'precision': 0.7981512, 'recall': 0.6954709, 'specificity': 0.6954709, 'f1': 0.66971624, 'auroc': 0.90535986, 'binary_precision': 0.9661654, 'binary_recall': 0.40472442, 'binary_specificity': 0.98621744, 'binary_f1_score': 0.57047725}
confusion matrix:
     0    1
0  644    9
1  378  257
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.76744187, 'precision': 0.84126985, 'recall': 0.76744187, 'specificity': 0.76744187, 'f1': 0.75414526, 'auroc': 0.91459167, 'binary_precision': 1.0, 'binary_recall': 0.53488374, 'binary_specificity': 1.0, 'binary_f1_score': 0.6969697}
confusion matrix:
     0    1
0  215    0
1  100  115
early stop counter: 3
val acc:0.6995341777801514, best validation acc: 0.8291925191879272, corresponding to test acc:                         0.8069767355918884 / 0.8395348787307739
after epoch: 9,now: 2024-07-27 01:33:09.181430,epoch time: 0:01:29.038896,used: 0:13:33.550027,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_01_19_34_seed_0_23090480
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.984375, 'precision': 0.9845762, 'recall': 0.9845418, 'specificity': 0.9845418, 'f1': 0.984375, 'auroc': 0.99904656, 'binary_precision': 0.9980172, 'binary_recall': 0.9710611, 'binary_specificity': 0.99802244, 'binary_f1_score': 0.9843547}
confusion matrix:
      0     1
0  1514     3
1    45  1510
---- Validation: 
scalar performance:
{'acc': 0.8175466, 'precision': 0.8448992, 'recall': 0.8155683, 'specificity': 0.8155683, 'f1': 0.81317604, 'auroc': 0.9225718, 'binary_precision': 0.9385965, 'binary_recall': 0.67401576, 'binary_specificity': 0.95712095, 'binary_f1_score': 0.7846013}
confusion matrix:
     0    1
0  625   28
1  207  428
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.83255816, 'precision': 0.87456447, 'recall': 0.83255816, 'specificity': 0.83255816, 'f1': 0.82772815, 'auroc': 0.93207145, 'binary_precision': 1.0, 'binary_recall': 0.66511625, 'binary_specificity': 1.0, 'binary_f1_score': 0.7988826}
confusion matrix:
     0    1
0  215    0
1   72  143
early stop counter: 4
val acc:0.8175466060638428, best validation acc: 0.8291925191879272, corresponding to test acc:                         0.8069767355918884 / 0.8395348787307739
after epoch: 10,now: 2024-07-27 01:34:38.627989,epoch time: 0:01:29.446559,used: 0:15:02.996586,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_01_19_34_seed_0_23090480
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9635417, 'precision': 0.9653084, 'recall': 0.9631709, 'specificity': 0.9631709, 'f1': 0.96348023, 'auroc': 0.99834204, 'binary_precision': 0.9397077, 'binary_recall': 0.9916452, 'binary_specificity': 0.93469656, 'binary_f1_score': 0.96497816}
confusion matrix:
      0     1
0  1417    99
1    13  1543
---- Validation: 
scalar performance:
{'acc': 0.83618015, 'precision': 0.8426247, 'recall': 0.8371357, 'specificity': 0.8371357, 'f1': 0.8356521, 'auroc': 0.90672004, 'binary_precision': 0.792011, 'binary_recall': 0.9055118, 'binary_specificity': 0.76875955, 'binary_f1_score': 0.8449669}
confusion matrix:
     0    1
0  502  151
1   60  575
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8372093, 'precision': 0.84302723, 'recall': 0.8372093, 'specificity': 0.8372093, 'f1': 0.836516, 'auroc': 0.93423474, 'binary_precision': 0.7983539, 'binary_recall': 0.9023256, 'binary_specificity': 0.772093, 'binary_f1_score': 0.84716153}
confusion matrix:
     0    1
0  166   49
1   21  194
better model found
persisted
after epoch: 11,now: 2024-07-27 01:36:08.372131,epoch time: 0:01:29.744142,used: 0:16:32.740728,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_01_19_34_seed_0_23090480
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9739583, 'precision': 0.974774, 'recall': 0.9742676, 'specificity': 0.9742676, 'f1': 0.97395515, 'auroc': 0.99786985, 'binary_precision': 0.9979757, 'binary_recall': 0.95051414, 'binary_specificity': 0.9980211, 'binary_f1_score': 0.9736669}
confusion matrix:
      0     1
0  1513     3
1    77  1479
---- Validation: 
scalar performance:
{'acc': 0.6257764, 'precision': 0.74770415, 'recall': 0.620798, 'specificity': 0.620798, 'f1': 0.56829137, 'auroc': 0.8383945, 'binary_precision': 0.91803277, 'binary_recall': 0.26456693, 'binary_specificity': 0.9770291, 'binary_f1_score': 0.41075796}
confusion matrix:
     0    1
0  638   15
1  467  168
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8534884, 'precision': 0.8745644, 'recall': 0.8534884, 'specificity': 0.8534884, 'f1': 0.851398, 'auroc': 0.9119308, 'binary_precision': 0.9634146, 'binary_recall': 0.7348837, 'binary_specificity': 0.97209305, 'binary_f1_score': 0.83377314}
confusion matrix:
     0    1
0  209    6
1   57  158
new oracle model saved
early stop counter: 1
val acc:0.6257764101028442, best validation acc: 0.8361801505088806, corresponding to test acc:                         0.8372092843055725 / 0.8534883856773376
after epoch: 12,now: 2024-07-27 01:37:38.139179,epoch time: 0:01:29.767048,used: 0:18:02.507776,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_01_19_34_seed_0_23090480
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.97526044, 'precision': 0.9753798, 'recall': 0.97540885, 'specificity': 0.97540885, 'f1': 0.9752604, 'auroc': 0.9978316, 'binary_precision': 0.9868421, 'binary_recall': 0.9640103, 'binary_specificity': 0.9868074, 'binary_f1_score': 0.9752926}
confusion matrix:
      0     1
0  1496    20
1    56  1500
---- Validation: 
scalar performance:
{'acc': 0.85248446, 'precision': 0.85260206, 'recall': 0.8526293, 'specificity': 0.8526293, 'f1': 0.8524841, 'auroc': 0.9131519, 'binary_precision': 0.84178185, 'binary_recall': 0.8629921, 'binary_specificity': 0.84226644, 'binary_f1_score': 0.85225505}
confusion matrix:
     0    1
0  550  103
1   87  548
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8372093, 'precision': 0.8386452, 'recall': 0.8372093, 'specificity': 0.8372093, 'f1': 0.83703655, 'auroc': 0.9192212, 'binary_precision': 0.8606965, 'binary_recall': 0.80465114, 'binary_specificity': 0.8697674, 'binary_f1_score': 0.8317308}
confusion matrix:
     0    1
0  187   28
1   42  173
better model found
persisted
after epoch: 13,now: 2024-07-27 01:39:07.689459,epoch time: 0:01:29.550280,used: 0:19:32.058056,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_01_19_34_seed_0_23090480
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.96777344, 'precision': 0.9689497, 'recall': 0.9681368, 'specificity': 0.9681368, 'f1': 0.9677659, 'auroc': 0.99790967, 'binary_precision': 0.9959156, 'binary_recall': 0.9402314, 'binary_specificity': 0.9960422, 'binary_f1_score': 0.96727276}
confusion matrix:
      0     1
0  1510     6
1    93  1463
---- Validation: 
scalar performance:
{'acc': 0.8035714, 'precision': 0.8243269, 'recall': 0.8017858, 'specificity': 0.8017858, 'f1': 0.7997029, 'auroc': 0.89633787, 'binary_precision': 0.90295357, 'binary_recall': 0.67401576, 'binary_specificity': 0.9295559, 'binary_f1_score': 0.7718665}
confusion matrix:
     0    1
0  607   46
1  207  428
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8581395, 'precision': 0.85833335, 'recall': 0.8581395, 'specificity': 0.8581395, 'f1': 0.8581203, 'auroc': 0.9269875, 'binary_precision': 0.8666667, 'binary_recall': 0.8465116, 'binary_specificity': 0.8697674, 'binary_f1_score': 0.8564706}
confusion matrix:
     0    1
0  187   28
1   33  182
new oracle model saved
early stop counter: 1
val acc:0.8035714030265808, best validation acc: 0.8524844646453857, corresponding to test acc:                         0.8372092843055725 / 0.8581395149230957
after epoch: 14,now: 2024-07-27 01:40:37.329724,epoch time: 0:01:29.640265,used: 0:21:01.698321,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_01_19_34_seed_0_23090480
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9860026, 'precision': 0.9860026, 'recall': 0.98609346, 'specificity': 0.98609346, 'f1': 0.98600197, 'auroc': 0.9991322, 'binary_precision': 0.99283856, 'binary_recall': 0.97944766, 'binary_specificity': 0.99273926, 'binary_f1_score': 0.98609763}
confusion matrix:
      0     1
0  1504    11
1    32  1525
---- Validation: 
scalar performance:
{'acc': 0.6630435, 'precision': 0.75918245, 'recall': 0.65872353, 'specificity': 0.65872353, 'f1': 0.62504995, 'auroc': 0.815071, 'binary_precision': 0.91358024, 'binary_recall': 0.3496063, 'binary_specificity': 0.96784073, 'binary_f1_score': 0.50569475}
confusion matrix:
     0    1
0  632   21
1  413  222
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.68372095, 'precision': 0.79486823, 'recall': 0.68372095, 'specificity': 0.68372095, 'f1': 0.6508156, 'auroc': 0.9151541, 'binary_precision': 0.97590363, 'binary_recall': 0.37674418, 'binary_specificity': 0.9906977, 'binary_f1_score': 0.54362416}
confusion matrix:
     0   1
0  213   2
1  134  81
early stop counter: 2
val acc:0.6630434989929199, best validation acc: 0.8524844646453857, corresponding to test acc:                         0.8372092843055725 / 0.8581395149230957
after epoch: 15,now: 2024-07-27 01:42:07.481671,epoch time: 0:01:30.151947,used: 0:22:31.850268,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_01_19_34_seed_0_23090480
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9710286, 'precision': 0.9722914, 'recall': 0.9713826, 'specificity': 0.9713826, 'f1': 0.9710207, 'auroc': 0.9985044, 'binary_precision': 1.0, 'binary_recall': 0.9427653, 'binary_specificity': 1.0, 'binary_f1_score': 0.97053957}
confusion matrix:
      0     1
0  1517     0
1    89  1466
---- Validation: 
scalar performance:
{'acc': 0.8128882, 'precision': 0.84680945, 'recall': 0.810692, 'specificity': 0.810692, 'f1': 0.8074219, 'auroc': 0.9217036, 'binary_precision': 0.95183486, 'binary_recall': 0.6535433, 'binary_specificity': 0.96784073, 'binary_f1_score': 0.7749767}
confusion matrix:
     0    1
0  632   21
1  220  415
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8418605, 'precision': 0.8798586, 'recall': 0.8418605, 'specificity': 0.8418605, 'f1': 0.83780426, 'auroc': 0.93501353, 'binary_precision': 1.0, 'binary_recall': 0.68372095, 'binary_specificity': 1.0, 'binary_f1_score': 0.8121547}
confusion matrix:
     0    1
0  215    0
1   68  147
early stop counter: 3
val acc:0.8128882050514221, best validation acc: 0.8524844646453857, corresponding to test acc:                         0.8372092843055725 / 0.8581395149230957
after epoch: 16,now: 2024-07-27 01:43:36.898992,epoch time: 0:01:29.417321,used: 0:24:01.267589,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_01_19_34_seed_0_23090480
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.98860675, 'precision': 0.9885875, 'recall': 0.9886714, 'specificity': 0.9886714, 'f1': 0.98860586, 'auroc': 0.99919707, 'binary_precision': 0.9935149, 'binary_recall': 0.98394346, 'binary_specificity': 0.9933993, 'binary_f1_score': 0.988706}
confusion matrix:
      0     1
0  1505    10
1    25  1532
---- Validation: 
scalar performance:
{'acc': 0.80201864, 'precision': 0.8376603, 'recall': 0.7997335, 'specificity': 0.7997335, 'f1': 0.7957868, 'auroc': 0.92418694, 'binary_precision': 0.94392526, 'binary_recall': 0.63622046, 'binary_specificity': 0.9632466, 'binary_f1_score': 0.7601129}
confusion matrix:
     0    1
0  629   24
1  231  404
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.772093, 'precision': 0.8434505, 'recall': 0.77209306, 'specificity': 0.77209306, 'f1': 0.7596066, 'auroc': 0.9401406, 'binary_precision': 1.0, 'binary_recall': 0.54418606, 'binary_specificity': 1.0, 'binary_f1_score': 0.70481926}
confusion matrix:
     0    1
0  215    0
1   98  117
early stop counter: 4
val acc:0.8020186424255371, best validation acc: 0.8524844646453857, corresponding to test acc:                         0.8372092843055725 / 0.8581395149230957
after epoch: 17,now: 2024-07-27 01:45:06.282413,epoch time: 0:01:29.383421,used: 0:25:30.651010,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_01_19_34_seed_0_23090480
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.97786456, 'precision': 0.97865176, 'recall': 0.9776437, 'specificity': 0.9776437, 'f1': 0.9778447, 'auroc': 0.9992895, 'binary_precision': 0.9620882, 'binary_recall': 0.9954984, 'binary_specificity': 0.95978904, 'binary_f1_score': 0.9785082}
confusion matrix:
      0     1
0  1456    61
1     7  1548
---- Validation: 
scalar performance:
{'acc': 0.72670805, 'precision': 0.7736169, 'recall': 0.723768, 'specificity': 0.723768, 'f1': 0.7127419, 'auroc': 0.871662, 'binary_precision': 0.8834688, 'binary_recall': 0.51338583, 'binary_specificity': 0.9341501, 'binary_f1_score': 0.6494024}
confusion matrix:
     0    1
0  610   43
1  309  326
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.82093024, 'precision': 0.8343023, 'recall': 0.82093024, 'specificity': 0.82093024, 'f1': 0.8191215, 'auroc': 0.90383995, 'binary_precision': 0.9011628, 'binary_recall': 0.7209302, 'binary_specificity': 0.9209302, 'binary_f1_score': 0.8010336}
confusion matrix:
     0    1
0  198   17
1   60  155
early stop counter: 5
val acc:0.7267080545425415, best validation acc: 0.8524844646453857, corresponding to test acc:                         0.8372092843055725 / 0.8581395149230957
after epoch: 18,now: 2024-07-27 01:46:35.610835,epoch time: 0:01:29.328422,used: 0:26:59.979432,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_01_19_34_seed_0_23090480
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 18 with time: 0:26:59.979432 at 2024-07-27 01:46:35.610835
persisted model performance metric: 

scalar performance:
{'acc': 0.8372093, 'precision': 0.8386452, 'recall': 0.8372093, 'specificity': 0.8372093, 'f1': 0.83703655, 'auroc': 0.9192212, 'binary_precision': 0.8606965, 'binary_recall': 0.80465114, 'binary_specificity': 0.8697674, 'binary_f1_score': 0.8317308}
confusion matrix:
     0    1
0  187   28
1   42  173
oracle model performance metric: 

scalar performance:
{'acc': 0.8581395, 'precision': 0.85833335, 'recall': 0.8581395, 'specificity': 0.8581395, 'f1': 0.8581203, 'auroc': 0.9269875, 'binary_precision': 0.8666667, 'binary_recall': 0.8465116, 'binary_specificity': 0.8697674, 'binary_f1_score': 0.8564706}
confusion matrix:
     0    1
0  187   28
1   33  182
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_diva_irm_3seeds_nofreeze_2024-07-27_01-18-02/rule_results/11.csv
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_diva_irm_3seeds_nofreeze_2024-07-27_01-18-02/rule_results/11.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_diva_irm_3seeds_nofreeze_2024-07-27_01-18-02/confusion_matrix/11.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   1092 MiB |  13863 MiB |  43933 GiB |  43932 GiB |
|       from large pool |   1032 MiB |  13805 MiB |  43382 GiB |  43381 GiB |
|       from small pool |     59 MiB |     95 MiB |    551 GiB |    551 GiB |
|---------------------------------------------------------------------------|
| Active memory         |   1092 MiB |  13863 MiB |  43933 GiB |  43932 GiB |
|       from large pool |   1032 MiB |  13805 MiB |  43382 GiB |  43381 GiB |
|       from small pool |     59 MiB |     95 MiB |    551 GiB |    551 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |   1078 MiB |  13855 MiB |  43892 GiB |  43891 GiB |
|       from large pool |   1019 MiB |  13797 MiB |  43342 GiB |  43341 GiB |
|       from small pool |     59 MiB |     95 MiB |    550 GiB |    550 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  14998 MiB |  14998 MiB |  14998 MiB |      0 B   |
|       from large pool |  14892 MiB |  14892 MiB |  14892 MiB |      0 B   |
|       from small pool |    106 MiB |    106 MiB |    106 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |   1677 MiB |   2242 MiB |  32736 GiB |  32734 GiB |
|       from large pool |   1667 MiB |   2234 MiB |  32182 GiB |  32181 GiB |
|       from small pool |     10 MiB |     17 MiB |    553 GiB |    553 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    1792    |    3103    |    7970 K  |    7968 K  |
|       from large pool |     269    |    1495    |    3951 K  |    3951 K  |
|       from small pool |    1523    |    2219    |    4018 K  |    4017 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    1792    |    3103    |    7970 K  |    7968 K  |
|       from large pool |     269    |    1495    |    3951 K  |    3951 K  |
|       from small pool |    1523    |    2219    |    4018 K  |    4017 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     596    |     596    |     596    |       0    |
|       from large pool |     543    |     543    |     543    |       0    |
|       from small pool |      53    |      53    |      53    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     142    |     580    |    5058 K  |    5058 K  |
|       from large pool |      54    |     534    |    2870 K  |    2870 K  |
|       from small pool |      88    |     243    |    2188 K  |    2187 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13863 MiB |  43933 GiB |  43933 GiB |
|       from large pool |  16640 KiB |  13805 MiB |  43382 GiB |  43382 GiB |
|       from small pool |      0 KiB |     95 MiB |    551 GiB |    551 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13863 MiB |  43933 GiB |  43933 GiB |
|       from large pool |  16640 KiB |  13805 MiB |  43382 GiB |  43382 GiB |
|       from small pool |      0 KiB |     95 MiB |    551 GiB |    551 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13855 MiB |  43892 GiB |  43892 GiB |
|       from large pool |  16640 KiB |  13797 MiB |  43342 GiB |  43342 GiB |
|       from small pool |      0 KiB |     95 MiB |    550 GiB |    550 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2770 MiB |  14998 MiB |  14998 MiB |  12228 MiB |
|       from large pool |   2700 MiB |  14892 MiB |  14892 MiB |  12192 MiB |
|       from small pool |     70 MiB |    106 MiB |    106 MiB |     36 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   2242 MiB |  32736 GiB |  32736 GiB |
|       from large pool |  24320 KiB |   2234 MiB |  32183 GiB |  32183 GiB |
|       from small pool |      0 KiB |     41 MiB |    553 GiB |    553 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3103    |    7970 K  |    7970 K  |
|       from large pool |       2    |    1495    |    3951 K  |    3951 K  |
|       from small pool |       0    |    2219    |    4018 K  |    4018 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3103    |    7970 K  |    7970 K  |
|       from large pool |       2    |    1495    |    3951 K  |    3951 K  |
|       from small pool |       0    |    2219    |    4018 K  |    4018 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      95    |     596    |     596    |     501    |
|       from large pool |      60    |     543    |     543    |     483    |
|       from small pool |      35    |      53    |      53    |      18    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       2    |     580    |    5058 K  |    5058 K  |
|       from large pool |       2    |     534    |    2870 K  |    2870 K  |
|       from small pool |       0    |     243    |    2188 K  |    2188 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13863 MiB |  43933 GiB |  43933 GiB |
|       from large pool |  16640 KiB |  13805 MiB |  43382 GiB |  43382 GiB |
|       from small pool |      0 KiB |     95 MiB |    551 GiB |    551 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13863 MiB |  43933 GiB |  43933 GiB |
|       from large pool |  16640 KiB |  13805 MiB |  43382 GiB |  43382 GiB |
|       from small pool |      0 KiB |     95 MiB |    551 GiB |    551 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13855 MiB |  43892 GiB |  43892 GiB |
|       from large pool |  16640 KiB |  13797 MiB |  43342 GiB |  43342 GiB |
|       from small pool |      0 KiB |     95 MiB |    550 GiB |    550 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2770 MiB |  14998 MiB |  14998 MiB |  12228 MiB |
|       from large pool |   2700 MiB |  14892 MiB |  14892 MiB |  12192 MiB |
|       from small pool |     70 MiB |    106 MiB |    106 MiB |     36 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   2242 MiB |  32736 GiB |  32736 GiB |
|       from large pool |  24320 KiB |   2234 MiB |  32183 GiB |  32183 GiB |
|       from small pool |      0 KiB |     41 MiB |    553 GiB |    553 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3103    |    7970 K  |    7970 K  |
|       from large pool |       2    |    1495    |    3951 K  |    3951 K  |
|       from small pool |       0    |    2219    |    4018 K  |    4018 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3103    |    7970 K  |    7970 K  |
|       from large pool |       2    |    1495    |    3951 K  |    3951 K  |
|       from small pool |       0    |    2219    |    4018 K  |    4018 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      95    |     596    |     596    |     501    |
|       from large pool |      60    |     543    |     543    |     483    |
|       from small pool |      35    |      53    |      53    |      18    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       2    |     580    |    5058 K  |    5058 K  |
|       from large pool |       2    |     534    |    2870 K  |    2870 K  |
|       from small pool |       0    |     243    |    2188 K  |    2188 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main

using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_01_47_09_seed_1_23090480

 Experiment start at: 2024-07-27 01:47:10.400837
before training, model accuracy: 0.46000000834465027
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9274089, 'precision': 0.93479294, 'recall': 0.92828256, 'specificity': 0.92828256, 'f1': 0.9271885, 'auroc': 0.98839843, 'binary_precision': 0.99480325, 'binary_recall': 0.8611825, 'binary_specificity': 0.9953826, 'binary_f1_score': 0.9231829}
confusion matrix:
      0     1
0  1509     7
1   216  1340
---- Validation: 
scalar performance:
{'acc': 0.7587822, 'precision': 0.80931044, 'recall': 0.75542754, 'specificity': 0.75542754, 'f1': 0.74686015, 'auroc': 0.8962506, 'binary_precision': 0.93029493, 'binary_recall': 0.55079365, 'binary_specificity': 0.96006143, 'binary_f1_score': 0.6919242}
confusion matrix:
     0    1
0  625   26
1  283  347
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7866667, 'precision': 0.8305733, 'recall': 0.78666663, 'specificity': 0.78666663, 'f1': 0.7793397, 'auroc': 0.9001284, 'binary_precision': 0.951049, 'binary_recall': 0.60444444, 'binary_specificity': 0.9688889, 'binary_f1_score': 0.7391305}
confusion matrix:
     0    1
0  218    7
1   89  136
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-27 01:48:46.500011,epoch time: 0:01:36.099174,used: 0:01:36.099174,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_01_47_09_seed_1_23090480
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9547526, 'precision': 0.9555619, 'recall': 0.9545162, 'specificity': 0.9545162, 'f1': 0.9547093, 'auroc': 0.99184763, 'binary_precision': 0.93920594, 'binary_recall': 0.97363347, 'binary_specificity': 0.9353988, 'binary_f1_score': 0.9561099}
confusion matrix:
      0     1
0  1419    98
1    41  1514
---- Validation: 
scalar performance:
{'acc': 0.8446526, 'precision': 0.84493655, 'recall': 0.84439325, 'specificity': 0.84439325, 'f1': 0.8445158, 'auroc': 0.90319896, 'binary_precision': 0.85154974, 'binary_recall': 0.82857144, 'binary_specificity': 0.86021507, 'binary_f1_score': 0.8399035}
confusion matrix:
     0    1
0  560   91
1  108  522
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8244445, 'precision': 0.8249644, 'recall': 0.8244444, 'specificity': 0.8244444, 'f1': 0.8243742, 'auroc': 0.9034074, 'binary_precision': 0.8119658, 'binary_recall': 0.84444445, 'binary_specificity': 0.80444443, 'binary_f1_score': 0.82788676}
confusion matrix:
     0    1
0  181   44
1   35  190
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-07-27 01:50:18.866606,epoch time: 0:01:32.366595,used: 0:03:08.465769,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_01_47_09_seed_1_23090480
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.95996094, 'precision': 0.96225667, 'recall': 0.96050763, 'specificity': 0.96050763, 'f1': 0.9599371, 'auroc': 0.9963443, 'binary_precision': 0.99861014, 'binary_recall': 0.92233634, 'binary_specificity': 0.998679, 'binary_f1_score': 0.958959}
confusion matrix:
      0     1
0  1512     2
1   121  1437
---- Validation: 
scalar performance:
{'acc': 0.7174083, 'precision': 0.79698265, 'recall': 0.71310806, 'specificity': 0.71310806, 'f1': 0.69446945, 'auroc': 0.8712628, 'binary_precision': 0.94666666, 'binary_recall': 0.45079365, 'binary_specificity': 0.97542244, 'binary_f1_score': 0.61075264}
confusion matrix:
     0    1
0  635   16
1  346  284
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.79555553, 'precision': 0.84082365, 'recall': 0.7955556, 'specificity': 0.7955556, 'f1': 0.78853387, 'auroc': 0.8953086, 'binary_precision': 0.96503496, 'binary_recall': 0.61333334, 'binary_specificity': 0.9777778, 'binary_f1_score': 0.75}
confusion matrix:
     0    1
0  220    5
1   87  138
early stop counter: 1
val acc:0.717408299446106, best validation acc: 0.8446525931358337, corresponding to test acc:                         0.8244444727897644 / 0.8244444727897644
after epoch: 3,now: 2024-07-27 01:51:49.221574,epoch time: 0:01:30.354968,used: 0:04:38.820737,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_01_47_09_seed_1_23090480
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.95996094, 'precision': 0.95996654, 'recall': 0.95994145, 'specificity': 0.95994145, 'f1': 0.95995307, 'auroc': 0.99461913, 'binary_precision': 0.9595895, 'binary_recall': 0.9614396, 'binary_specificity': 0.9584433, 'binary_f1_score': 0.96051365}
confusion matrix:
      0     1
0  1453    63
1    60  1496
---- Validation: 
scalar performance:
{'acc': 0.82825917, 'precision': 0.8283765, 'recall': 0.82805943, 'specificity': 0.82805943, 'f1': 0.82814515, 'auroc': 0.8675103, 'binary_precision': 0.8317152, 'binary_recall': 0.815873, 'binary_specificity': 0.8402458, 'binary_f1_score': 0.82371795}
confusion matrix:
     0    1
0  547  104
1  116  514
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.78, 'precision': 0.802213, 'recall': 0.78, 'specificity': 0.78, 'f1': 0.77588177, 'auroc': 0.9219358, 'binary_precision': 0.7202797, 'binary_recall': 0.91555554, 'binary_specificity': 0.64444447, 'binary_f1_score': 0.80626225}
confusion matrix:
     0    1
0  145   80
1   19  206
early stop counter: 2
val acc:0.8282591700553894, best validation acc: 0.8446525931358337, corresponding to test acc:                         0.8244444727897644 / 0.8244444727897644
after epoch: 4,now: 2024-07-27 01:53:19.768867,epoch time: 0:01:30.547293,used: 0:06:09.368030,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_01_47_09_seed_1_23090480
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9798177, 'precision': 0.97981393, 'recall': 0.9798871, 'specificity': 0.9798871, 'f1': 0.9798169, 'auroc': 0.9976032, 'binary_precision': 0.9856864, 'binary_recall': 0.97427654, 'binary_specificity': 0.9854977, 'binary_f1_score': 0.9799483}
confusion matrix:
      0     1
0  1495    22
1    40  1515
---- Validation: 
scalar performance:
{'acc': 0.7665886, 'precision': 0.780334, 'recall': 0.7647209, 'specificity': 0.7647209, 'f1': 0.762795, 'auroc': 0.84095526, 'binary_precision': 0.8384458, 'binary_recall': 0.6507937, 'binary_specificity': 0.8786482, 'binary_f1_score': 0.73279715}
confusion matrix:
     0    1
0  572   79
1  220  410
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.82222223, 'precision': 0.8253325, 'recall': 0.82222223, 'specificity': 0.82222223, 'f1': 0.8217963, 'auroc': 0.9095901, 'binary_precision': 0.85714287, 'binary_recall': 0.7733333, 'binary_specificity': 0.8711111, 'binary_f1_score': 0.81308407}
confusion matrix:
     0    1
0  196   29
1   51  174
early stop counter: 3
val acc:0.7665886282920837, best validation acc: 0.8446525931358337, corresponding to test acc:                         0.8244444727897644 / 0.8244444727897644
after epoch: 5,now: 2024-07-27 01:54:50.177602,epoch time: 0:01:30.408735,used: 0:07:39.776765,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_01_47_09_seed_1_23090480
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.98372394, 'precision': 0.98370284, 'recall': 0.98378325, 'specificity': 0.98378325, 'f1': 0.9837226, 'auroc': 0.9975581, 'binary_precision': 0.9883344, 'binary_recall': 0.97944766, 'binary_specificity': 0.9881188, 'binary_f1_score': 0.983871}
confusion matrix:
      0     1
0  1497    18
1    32  1525
---- Validation: 
scalar performance:
{'acc': 0.7782982, 'precision': 0.81178653, 'recall': 0.77557606, 'specificity': 0.77557606, 'f1': 0.7709793, 'auroc': 0.9027631, 'binary_precision': 0.9099526, 'binary_recall': 0.60952383, 'binary_specificity': 0.9416283, 'binary_f1_score': 0.73003805}
confusion matrix:
     0    1
0  613   38
1  246  384
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8155556, 'precision': 0.8423997, 'recall': 0.8155556, 'specificity': 0.8155556, 'f1': 0.8118682, 'auroc': 0.90121484, 'binary_precision': 0.9382716, 'binary_recall': 0.6755555, 'binary_specificity': 0.95555556, 'binary_f1_score': 0.78552973}
confusion matrix:
     0    1
0  215   10
1   73  152
early stop counter: 4
val acc:0.7782981991767883, best validation acc: 0.8446525931358337, corresponding to test acc:                         0.8244444727897644 / 0.8244444727897644
after epoch: 6,now: 2024-07-27 01:56:20.255016,epoch time: 0:01:30.077414,used: 0:09:09.854179,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_01_47_09_seed_1_23090480
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9765625, 'precision': 0.97735846, 'recall': 0.97683394, 'specificity': 0.97683394, 'f1': 0.9765593, 'auroc': 0.9981178, 'binary_precision': 1.0, 'binary_recall': 0.95366794, 'binary_specificity': 1.0, 'binary_f1_score': 0.9762846}
confusion matrix:
      0     1
0  1518     0
1    72  1482
---- Validation: 
scalar performance:
{'acc': 0.69633096, 'precision': 0.78420025, 'recall': 0.69170505, 'specificity': 0.69170505, 'f1': 0.6677021, 'auroc': 0.88894373, 'binary_precision': 0.9381818, 'binary_recall': 0.40952381, 'binary_specificity': 0.9738863, 'binary_f1_score': 0.57016575}
confusion matrix:
     0    1
0  634   17
1  372  258
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7911111, 'precision': 0.8436837, 'recall': 0.7911111, 'specificity': 0.7911111, 'f1': 0.7828051, 'auroc': 0.9197284, 'binary_precision': 0.9781022, 'binary_recall': 0.59555554, 'binary_specificity': 0.9866667, 'binary_f1_score': 0.7403315}
confusion matrix:
     0    1
0  222    3
1   91  134
early stop counter: 5
val acc:0.6963309645652771, best validation acc: 0.8446525931358337, corresponding to test acc:                         0.8244444727897644 / 0.8244444727897644
after epoch: 7,now: 2024-07-27 01:57:50.375628,epoch time: 0:01:30.120612,used: 0:10:39.974791,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_01_47_09_seed_1_23090480
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 7 with time: 0:10:39.974791 at 2024-07-27 01:57:50.375628
persisted model performance metric: 

scalar performance:
{'acc': 0.8244445, 'precision': 0.8249644, 'recall': 0.8244444, 'specificity': 0.8244444, 'f1': 0.8243742, 'auroc': 0.9034074, 'binary_precision': 0.8119658, 'binary_recall': 0.84444445, 'binary_specificity': 0.80444443, 'binary_f1_score': 0.82788676}
confusion matrix:
     0    1
0  181   44
1   35  190
oracle model performance metric: 

scalar performance:
{'acc': 0.8244445, 'precision': 0.8249644, 'recall': 0.8244444, 'specificity': 0.8244444, 'f1': 0.8243742, 'auroc': 0.9034074, 'binary_precision': 0.8119658, 'binary_recall': 0.84444445, 'binary_specificity': 0.80444443, 'binary_f1_score': 0.82788676}
confusion matrix:
     0    1
0  181   44
1   35  190
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_diva_irm_3seeds_nofreeze_2024-07-27_01-18-02/rule_results/11.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_diva_irm_3seeds_nofreeze_2024-07-27_01-18-02/confusion_matrix/11.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   1090 MiB |  13863 MiB |  61580 GiB |  61579 GiB |
|       from large pool |   1031 MiB |  13805 MiB |  60805 GiB |  60804 GiB |
|       from small pool |     59 MiB |     99 MiB |    774 GiB |    774 GiB |
|---------------------------------------------------------------------------|
| Active memory         |   1090 MiB |  13863 MiB |  61580 GiB |  61579 GiB |
|       from large pool |   1031 MiB |  13805 MiB |  60805 GiB |  60804 GiB |
|       from small pool |     59 MiB |     99 MiB |    774 GiB |    774 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |   1078 MiB |  13855 MiB |  61524 GiB |  61523 GiB |
|       from large pool |   1019 MiB |  13797 MiB |  60751 GiB |  60750 GiB |
|       from small pool |     59 MiB |     99 MiB |    773 GiB |    773 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  14944 MiB |  14998 MiB |  27172 MiB |  12228 MiB |
|       from large pool |  14832 MiB |  14892 MiB |  27024 MiB |  12192 MiB |
|       from small pool |    112 MiB |    112 MiB |    148 MiB |     36 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |   1993 MiB |   2834 MiB |  47431 GiB |  47429 GiB |
|       from large pool |   1982 MiB |   2827 MiB |  46653 GiB |  46651 GiB |
|       from small pool |     10 MiB |     41 MiB |    777 GiB |    777 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    1804    |    3107    |   11171 K  |   11169 K  |
|       from large pool |     269    |    1495    |    5538 K  |    5538 K  |
|       from small pool |    1535    |    2231    |    5632 K  |    5630 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    1804    |    3107    |   11171 K  |   11169 K  |
|       from large pool |     269    |    1495    |    5538 K  |    5538 K  |
|       from small pool |    1535    |    2231    |    5632 K  |    5630 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     562    |     596    |    1063    |     501    |
|       from large pool |     506    |     543    |     989    |     483    |
|       from small pool |      56    |      56    |      74    |      18    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     142    |     580    |    6959 K  |    6958 K  |
|       from large pool |      55    |     534    |    3881 K  |    3881 K  |
|       from small pool |      87    |     243    |    3077 K  |    3077 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13863 MiB |  61580 GiB |  61580 GiB |
|       from large pool |  16640 KiB |  13805 MiB |  60805 GiB |  60805 GiB |
|       from small pool |      0 KiB |     99 MiB |    774 GiB |    774 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13863 MiB |  61580 GiB |  61580 GiB |
|       from large pool |  16640 KiB |  13805 MiB |  60805 GiB |  60805 GiB |
|       from small pool |      0 KiB |     99 MiB |    774 GiB |    774 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13855 MiB |  61524 GiB |  61524 GiB |
|       from large pool |  16640 KiB |  13797 MiB |  60751 GiB |  60751 GiB |
|       from small pool |      0 KiB |     99 MiB |    773 GiB |    773 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   3084 MiB |  14998 MiB |  27172 MiB |  24088 MiB |
|       from large pool |   3014 MiB |  14892 MiB |  27024 MiB |  24010 MiB |
|       from small pool |     70 MiB |    112 MiB |    148 MiB |     78 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   2834 MiB |  47431 GiB |  47431 GiB |
|       from large pool |  24320 KiB |   2827 MiB |  46653 GiB |  46653 GiB |
|       from small pool |      0 KiB |     44 MiB |    777 GiB |    777 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3107    |   11171 K  |   11171 K  |
|       from large pool |       2    |    1495    |    5538 K  |    5538 K  |
|       from small pool |       0    |    2231    |    5632 K  |    5632 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3107    |   11171 K  |   11171 K  |
|       from large pool |       2    |    1495    |    5538 K  |    5538 K  |
|       from small pool |       0    |    2231    |    5632 K  |    5632 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      95    |     596    |    1063    |     968    |
|       from large pool |      60    |     543    |     989    |     929    |
|       from small pool |      35    |      56    |      74    |      39    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       2    |     580    |    6959 K  |    6959 K  |
|       from large pool |       2    |     534    |    3881 K  |    3881 K  |
|       from small pool |       0    |     243    |    3078 K  |    3078 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13863 MiB |  61580 GiB |  61580 GiB |
|       from large pool |  16640 KiB |  13805 MiB |  60805 GiB |  60805 GiB |
|       from small pool |      0 KiB |     99 MiB |    774 GiB |    774 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13863 MiB |  61580 GiB |  61580 GiB |
|       from large pool |  16640 KiB |  13805 MiB |  60805 GiB |  60805 GiB |
|       from small pool |      0 KiB |     99 MiB |    774 GiB |    774 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13855 MiB |  61524 GiB |  61524 GiB |
|       from large pool |  16640 KiB |  13797 MiB |  60751 GiB |  60751 GiB |
|       from small pool |      0 KiB |     99 MiB |    773 GiB |    773 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   3084 MiB |  14998 MiB |  27172 MiB |  24088 MiB |
|       from large pool |   3014 MiB |  14892 MiB |  27024 MiB |  24010 MiB |
|       from small pool |     70 MiB |    112 MiB |    148 MiB |     78 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   2834 MiB |  47431 GiB |  47431 GiB |
|       from large pool |  24320 KiB |   2827 MiB |  46653 GiB |  46653 GiB |
|       from small pool |      0 KiB |     44 MiB |    777 GiB |    777 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3107    |   11171 K  |   11171 K  |
|       from large pool |       2    |    1495    |    5538 K  |    5538 K  |
|       from small pool |       0    |    2231    |    5632 K  |    5632 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3107    |   11171 K  |   11171 K  |
|       from large pool |       2    |    1495    |    5538 K  |    5538 K  |
|       from small pool |       0    |    2231    |    5632 K  |    5632 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      95    |     596    |    1063    |     968    |
|       from large pool |      60    |     543    |     989    |     929    |
|       from small pool |      35    |      56    |      74    |      39    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       2    |     580    |    6959 K  |    6959 K  |
|       from large pool |       2    |     534    |    3881 K  |    3881 K  |
|       from small pool |       0    |     243    |    3078 K  |    3078 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main

using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_01_58_23_seed_2_23090480

 Experiment start at: 2024-07-27 01:58:24.510335
before training, model accuracy: 0.28703704476356506
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.8808901, 'precision': 0.90065813, 'recall': 0.8817668, 'specificity': 0.8817668, 'f1': 0.87956965, 'auroc': 0.97965086, 'binary_precision': 0.9916388, 'binary_recall': 0.77012986, 'binary_specificity': 0.9934037, 'binary_f1_score': 0.8669591}
confusion matrix:
      0     1
0  1506    10
1   354  1186
---- Validation: 
scalar performance:
{'acc': 0.71048516, 'precision': 0.7770895, 'recall': 0.7037806, 'specificity': 0.7037806, 'f1': 0.6875859, 'auroc': 0.8689245, 'binary_precision': 0.90645164, 'binary_recall': 0.4517685, 'binary_specificity': 0.95579267, 'binary_f1_score': 0.60300434}
confusion matrix:
     0    1
0  627   29
1  341  281
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7731481, 'precision': 0.8165739, 'recall': 0.7731482, 'specificity': 0.7731482, 'f1': 0.7650924, 'auroc': 0.8930042, 'binary_precision': 0.9338235, 'binary_recall': 0.587963, 'binary_specificity': 0.9583333, 'binary_f1_score': 0.72159094}
confusion matrix:
     0    1
0  207    9
1   89  127
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-27 01:59:57.080793,epoch time: 0:01:32.570458,used: 0:01:32.570458,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_01_58_23_seed_2_23090480
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9165576, 'precision': 0.91863334, 'recall': 0.9162877, 'specificity': 0.9162877, 'f1': 0.9164133, 'auroc': 0.9820996, 'binary_precision': 0.89105296, 'binary_recall': 0.9506493, 'binary_specificity': 0.8819261, 'binary_f1_score': 0.91988695}
confusion matrix:
      0     1
0  1337   179
1    76  1464
---- Validation: 
scalar performance:
{'acc': 0.7762128, 'precision': 0.7963898, 'recall': 0.77959573, 'specificity': 0.77959573, 'f1': 0.7736495, 'auroc': 0.87903404, 'binary_precision': 0.7121212, 'binary_recall': 0.9067524, 'binary_specificity': 0.652439, 'binary_f1_score': 0.79773694}
confusion matrix:
     0    1
0  428  228
1   58  564
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7731481, 'precision': 0.80319756, 'recall': 0.7731482, 'specificity': 0.7731482, 'f1': 0.76738465, 'auroc': 0.91244423, 'binary_precision': 0.7077465, 'binary_recall': 0.9305556, 'binary_specificity': 0.6157407, 'binary_f1_score': 0.804}
confusion matrix:
     0    1
0  133   83
1   15  201
better model found
persisted
after epoch: 2,now: 2024-07-27 02:01:25.592866,epoch time: 0:01:28.512073,used: 0:03:01.082531,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_01_58_23_seed_2_23090480
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.953534, 'precision': 0.9569651, 'recall': 0.9538858, 'specificity': 0.9538858, 'f1': 0.9534693, 'auroc': 0.99510026, 'binary_precision': 0.9985735, 'binary_recall': 0.90909094, 'binary_specificity': 0.9986807, 'binary_f1_score': 0.9517335}
confusion matrix:
      0     1
0  1514     2
1   140  1400
---- Validation: 
scalar performance:
{'acc': 0.6056338, 'precision': 0.7253663, 'recall': 0.59560525, 'specificity': 0.59560525, 'f1': 0.53368473, 'auroc': 0.77661, 'binary_precision': 0.8831169, 'binary_recall': 0.21864952, 'binary_specificity': 0.972561, 'binary_f1_score': 0.35051546}
confusion matrix:
     0    1
0  638   18
1  486  136
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7962963, 'precision': 0.84618855, 'recall': 0.7962963, 'specificity': 0.7962963, 'f1': 0.7886826, 'auroc': 0.91928154, 'binary_precision': 0.97761196, 'binary_recall': 0.6064815, 'binary_specificity': 0.9861111, 'binary_f1_score': 0.74857146}
confusion matrix:
     0    1
0  213    3
1   85  131
new oracle model saved
early stop counter: 1
val acc:0.6056337952613831, best validation acc: 0.7762128114700317, corresponding to test acc:                         0.7731481194496155 / 0.7962962985038757
after epoch: 3,now: 2024-07-27 02:02:54.752438,epoch time: 0:01:29.159572,used: 0:04:30.242103,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_01_58_23_seed_2_23090480
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.966623, 'precision': 0.96847963, 'recall': 0.9668831, 'specificity': 0.9668831, 'f1': 0.96660125, 'auroc': 0.9957434, 'binary_precision': 1.0, 'binary_recall': 0.93376625, 'binary_specificity': 1.0, 'binary_f1_score': 0.96574885}
confusion matrix:
      0     1
0  1516     0
1   102  1438
---- Validation: 
scalar performance:
{'acc': 0.7738654, 'precision': 0.79722273, 'recall': 0.77001804, 'specificity': 0.77001804, 'f1': 0.7675286, 'auroc': 0.87055916, 'binary_precision': 0.8741573, 'binary_recall': 0.6254019, 'binary_specificity': 0.91463417, 'binary_f1_score': 0.72914714}
confusion matrix:
     0    1
0  600   56
1  233  389
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8009259, 'precision': 0.8010292, 'recall': 0.80092597, 'specificity': 0.80092597, 'f1': 0.8009089, 'auroc': 0.890132, 'binary_precision': 0.8066038, 'binary_recall': 0.7916667, 'binary_specificity': 0.8101852, 'binary_f1_score': 0.7990655}
confusion matrix:
     0    1
0  175   41
1   45  171
new oracle model saved
early stop counter: 2
val acc:0.7738654017448425, best validation acc: 0.7762128114700317, corresponding to test acc:                         0.7731481194496155 / 0.8009259104728699
after epoch: 4,now: 2024-07-27 02:04:23.792076,epoch time: 0:01:29.039638,used: 0:05:59.281741,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_01_58_23_seed_2_23090480
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9741492, 'precision': 0.97414684, 'recall': 0.97417593, 'specificity': 0.97417593, 'f1': 0.97414875, 'auroc': 0.9966483, 'binary_precision': 0.97776324, 'binary_recall': 0.97077924, 'binary_specificity': 0.97757256, 'binary_f1_score': 0.9742587}
confusion matrix:
      0     1
0  1482    34
1    45  1495
---- Validation: 
scalar performance:
{'acc': 0.7629108, 'precision': 0.76857996, 'recall': 0.7608055, 'specificity': 0.7608055, 'f1': 0.76054615, 'auroc': 0.8482938, 'binary_precision': 0.8015123, 'binary_recall': 0.68167204, 'binary_specificity': 0.839939, 'binary_f1_score': 0.73675066}
confusion matrix:
     0    1
0  551  105
1  198  424
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8171296, 'precision': 0.82076657, 'recall': 0.8171296, 'specificity': 0.8171296, 'f1': 0.81660986, 'auroc': 0.8974837, 'binary_precision': 0.8549223, 'binary_recall': 0.7638889, 'binary_specificity': 0.8703704, 'binary_f1_score': 0.80684596}
confusion matrix:
     0    1
0  188   28
1   51  165
new oracle model saved
early stop counter: 3
val acc:0.762910783290863, best validation acc: 0.7762128114700317, corresponding to test acc:                         0.7731481194496155 / 0.8171296119689941
after epoch: 5,now: 2024-07-27 02:05:52.745882,epoch time: 0:01:28.953806,used: 0:07:28.235547,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_01_58_23_seed_2_23090480
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9698953, 'precision': 0.9705563, 'recall': 0.9697598, 'specificity': 0.9697598, 'f1': 0.96987665, 'auroc': 0.9973426, 'binary_precision': 0.95477384, 'binary_recall': 0.987013, 'binary_specificity': 0.9525066, 'binary_f1_score': 0.9706258}
confusion matrix:
      0     1
0  1444    72
1    20  1520
---- Validation: 
scalar performance:
{'acc': 0.8231612, 'precision': 0.8235546, 'recall': 0.82257766, 'specificity': 0.82257766, 'f1': 0.822821, 'auroc': 0.88843036, 'binary_precision': 0.83, 'binary_recall': 0.8006431, 'binary_specificity': 0.8445122, 'binary_f1_score': 0.8150572}
confusion matrix:
     0    1
0  554  102
1  124  498
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8310185, 'precision': 0.83359975, 'recall': 0.8310185, 'specificity': 0.8310185, 'f1': 0.830691, 'auroc': 0.9077932, 'binary_precision': 0.8042553, 'binary_recall': 0.875, 'binary_specificity': 0.787037, 'binary_f1_score': 0.83813745}
confusion matrix:
     0    1
0  170   46
1   27  189
new oracle model saved
better model found
persisted
after epoch: 6,now: 2024-07-27 02:07:22.844921,epoch time: 0:01:30.099039,used: 0:08:58.334586,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_01_58_23_seed_2_23090480
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9584424, 'precision': 0.96125543, 'recall': 0.9587611, 'specificity': 0.9587611, 'f1': 0.95839703, 'auroc': 0.99748874, 'binary_precision': 0.99929327, 'binary_recall': 0.91818184, 'binary_specificity': 0.99934036, 'binary_f1_score': 0.957022}
confusion matrix:
      0     1
0  1515     1
1   126  1414
---- Validation: 
scalar performance:
{'acc': 0.76134586, 'precision': 0.80496377, 'recall': 0.75619805, 'specificity': 0.75619805, 'f1': 0.74993503, 'auroc': 0.88490605, 'binary_precision': 0.91383815, 'binary_recall': 0.562701, 'binary_specificity': 0.9496951, 'binary_f1_score': 0.6965174}
confusion matrix:
     0    1
0  623   33
1  272  350
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7800926, 'precision': 0.7995118, 'recall': 0.7800926, 'specificity': 0.7800926, 'f1': 0.77646935, 'auroc': 0.8758359, 'binary_precision': 0.8757764, 'binary_recall': 0.6527778, 'binary_specificity': 0.9074074, 'binary_f1_score': 0.74801064}
confusion matrix:
     0    1
0  196   20
1   75  141
early stop counter: 1
val acc:0.7613458633422852, best validation acc: 0.8231611847877502, corresponding to test acc:                         0.8310185074806213 / 0.8310185074806213
after epoch: 7,now: 2024-07-27 02:08:51.314071,epoch time: 0:01:28.469150,used: 0:10:26.803736,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_01_58_23_seed_2_23090480
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.97938484, 'precision': 0.97952366, 'recall': 0.9793296, 'specificity': 0.9793296, 'f1': 0.97938037, 'auroc': 0.9984729, 'binary_precision': 0.97309417, 'binary_recall': 0.98636365, 'binary_specificity': 0.9722955, 'binary_f1_score': 0.979684}
confusion matrix:
      0     1
0  1474    42
1    21  1519
---- Validation: 
scalar performance:
{'acc': 0.7652582, 'precision': 0.7694479, 'recall': 0.7634254, 'specificity': 0.7634254, 'f1': 0.7633754, 'auroc': 0.85028625, 'binary_precision': 0.797048, 'binary_recall': 0.69453377, 'binary_specificity': 0.83231705, 'binary_f1_score': 0.742268}
confusion matrix:
     0    1
0  546  110
1  190  432
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8310185, 'precision': 0.83119595, 'recall': 0.8310185, 'specificity': 0.8310185, 'f1': 0.8309959, 'auroc': 0.87967247, 'binary_precision': 0.8235294, 'binary_recall': 0.8425926, 'binary_specificity': 0.8194444, 'binary_f1_score': 0.832952}
confusion matrix:
     0    1
0  177   39
1   34  182
early stop counter: 2
val acc:0.7652581930160522, best validation acc: 0.8231611847877502, corresponding to test acc:                         0.8310185074806213 / 0.8310185074806213
after epoch: 8,now: 2024-07-27 02:10:19.505200,epoch time: 0:01:28.191129,used: 0:11:54.994865,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_01_58_23_seed_2_23090480
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9816754, 'precision': 0.9817481, 'recall': 0.9816383, 'specificity': 0.9816383, 'f1': 0.9816725, 'auroc': 0.9982888, 'binary_precision': 0.9774775, 'binary_recall': 0.98636365, 'binary_specificity': 0.9769129, 'binary_f1_score': 0.98190045}
confusion matrix:
      0     1
0  1481    35
1    21  1519
---- Validation: 
scalar performance:
{'acc': 0.78951484, 'precision': 0.8003426, 'recall': 0.7919698, 'specificity': 0.7919698, 'f1': 0.78844225, 'auroc': 0.8885308, 'binary_precision': 0.7362785, 'binary_recall': 0.8842444, 'binary_specificity': 0.6996951, 'binary_f1_score': 0.8035062}
confusion matrix:
     0    1
0  459  197
1   72  550
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7800926, 'precision': 0.81192267, 'recall': 0.7800926, 'specificity': 0.7800926, 'f1': 0.7743356, 'auroc': 0.9209962, 'binary_precision': 0.7122807, 'binary_recall': 0.9398148, 'binary_specificity': 0.6203704, 'binary_f1_score': 0.8103792}
confusion matrix:
     0    1
0  134   82
1   13  203
early stop counter: 3
val acc:0.7895148396492004, best validation acc: 0.8231611847877502, corresponding to test acc:                         0.8310185074806213 / 0.8310185074806213
after epoch: 9,now: 2024-07-27 02:11:47.898862,epoch time: 0:01:28.393662,used: 0:13:23.388527,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_01_58_23_seed_2_23090480
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9859293, 'precision': 0.9859263, 'recall': 0.98593104, 'specificity': 0.98593104, 'f1': 0.98592854, 'auroc': 0.99893856, 'binary_precision': 0.98635477, 'binary_recall': 0.98571426, 'binary_specificity': 0.98614776, 'binary_f1_score': 0.9860344}
confusion matrix:
      0     1
0  1495    21
1    22  1518
---- Validation: 
scalar performance:
{'acc': 0.8200313, 'precision': 0.8201394, 'recall': 0.81961215, 'specificity': 0.81961215, 'f1': 0.81977713, 'auroc': 0.8769165, 'binary_precision': 0.82236844, 'binary_recall': 0.8038585, 'binary_specificity': 0.83536583, 'binary_f1_score': 0.8130082}
confusion matrix:
     0    1
0  548  108
1  122  500
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8263889, 'precision': 0.8295034, 'recall': 0.8263889, 'specificity': 0.8263889, 'f1': 0.8259777, 'auroc': 0.8993269, 'binary_precision': 0.79746836, 'binary_recall': 0.875, 'binary_specificity': 0.7777778, 'binary_f1_score': 0.8344371}
confusion matrix:
     0    1
0  168   48
1   27  189
early stop counter: 4
val acc:0.8200312852859497, best validation acc: 0.8231611847877502, corresponding to test acc:                         0.8310185074806213 / 0.8310185074806213
after epoch: 10,now: 2024-07-27 02:13:16.338093,epoch time: 0:01:28.439231,used: 0:14:51.827758,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_01_58_23_seed_2_23090480
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9633508, 'precision': 0.9655175, 'recall': 0.9636312, 'specificity': 0.9636312, 'f1': 0.9633218, 'auroc': 0.99860793, 'binary_precision': 0.9993007, 'binary_recall': 0.92792207, 'binary_specificity': 0.99934036, 'binary_f1_score': 0.96228963}
confusion matrix:
      0     1
0  1515     1
1   111  1429
---- Validation: 
scalar performance:
{'acc': 0.6658842, 'precision': 0.78262913, 'recall': 0.6571274, 'specificity': 0.6571274, 'f1': 0.62025565, 'auroc': 0.8965497, 'binary_precision': 0.9577465, 'binary_recall': 0.3279743, 'binary_specificity': 0.9862805, 'binary_f1_score': 0.48862278}
confusion matrix:
     0    1
0  647    9
1  418  204
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7430556, 'precision': 0.82609636, 'recall': 0.7430556, 'specificity': 0.7430556, 'f1': 0.7255856, 'auroc': 0.9120156, 'binary_precision': 0.99065423, 'binary_recall': 0.49074075, 'binary_specificity': 0.9953704, 'binary_f1_score': 0.65634674}
confusion matrix:
     0    1
0  215    1
1  110  106
early stop counter: 5
val acc:0.6658841967582703, best validation acc: 0.8231611847877502, corresponding to test acc:                         0.8310185074806213 / 0.8310185074806213
after epoch: 11,now: 2024-07-27 02:14:44.595157,epoch time: 0:01:28.257064,used: 0:16:20.084822,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_01_58_23_seed_2_23090480
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 11 with time: 0:16:20.084822 at 2024-07-27 02:14:44.595157
persisted model performance metric: 

scalar performance:
{'acc': 0.8310185, 'precision': 0.83359975, 'recall': 0.8310185, 'specificity': 0.8310185, 'f1': 0.830691, 'auroc': 0.9077932, 'binary_precision': 0.8042553, 'binary_recall': 0.875, 'binary_specificity': 0.787037, 'binary_f1_score': 0.83813745}
confusion matrix:
     0    1
0  170   46
1   27  189
oracle model performance metric: 

scalar performance:
{'acc': 0.8310185, 'precision': 0.83359975, 'recall': 0.8310185, 'specificity': 0.8310185, 'f1': 0.830691, 'auroc': 0.9077932, 'binary_precision': 0.8042553, 'binary_recall': 0.875, 'binary_specificity': 0.787037, 'binary_f1_score': 0.83813745}
confusion matrix:
     0    1
0  170   46
1   27  189
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_diva_irm_3seeds_nofreeze_2024-07-27_01-18-02/rule_results/11.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_diva_irm_3seeds_nofreeze_2024-07-27_01-18-02/confusion_matrix/11.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   1090 MiB |  13863 MiB |  88476 GiB |  88475 GiB |
|       from large pool |   1031 MiB |  13805 MiB |  87364 GiB |  87363 GiB |
|       from small pool |     59 MiB |     99 MiB |   1112 GiB |   1112 GiB |
|---------------------------------------------------------------------------|
| Active memory         |   1090 MiB |  13863 MiB |  88476 GiB |  88475 GiB |
|       from large pool |   1031 MiB |  13805 MiB |  87364 GiB |  87363 GiB |
|       from small pool |     59 MiB |     99 MiB |   1112 GiB |   1112 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |   1078 MiB |  13855 MiB |  88390 GiB |  88389 GiB |
|       from large pool |   1019 MiB |  13797 MiB |  87280 GiB |  87279 GiB |
|       from small pool |     59 MiB |     99 MiB |   1109 GiB |   1109 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  14930 MiB |  14998 MiB |  39018 MiB |  24088 MiB |
|       from large pool |  14824 MiB |  14892 MiB |  38834 MiB |  24010 MiB |
|       from small pool |    106 MiB |    112 MiB |    184 MiB |     78 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |   1983 MiB |   3065 MiB |  69012 GiB |  69010 GiB |
|       from large pool |   1972 MiB |   3057 MiB |  67895 GiB |  67893 GiB |
|       from small pool |     10 MiB |     44 MiB |   1116 GiB |   1116 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    1792    |    3107    |   16047 K  |   16046 K  |
|       from large pool |     269    |    1495    |    7956 K  |    7956 K  |
|       from small pool |    1523    |    2231    |    8091 K  |    8089 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    1792    |    3107    |   16047 K  |   16046 K  |
|       from large pool |     269    |    1495    |    7956 K  |    7956 K  |
|       from small pool |    1523    |    2231    |    8091 K  |    8089 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     552    |     596    |    1520    |     968    |
|       from large pool |     499    |     543    |    1428    |     929    |
|       from small pool |      53    |      56    |      92    |      39    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     135    |     580    |   10100 K  |   10100 K  |
|       from large pool |      53    |     534    |    5671 K  |    5671 K  |
|       from small pool |      82    |     243    |    4428 K  |    4428 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13863 MiB |  88476 GiB |  88476 GiB |
|       from large pool |  16640 KiB |  13805 MiB |  87364 GiB |  87364 GiB |
|       from small pool |      0 KiB |     99 MiB |   1112 GiB |   1112 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13863 MiB |  88476 GiB |  88476 GiB |
|       from large pool |  16640 KiB |  13805 MiB |  87364 GiB |  87364 GiB |
|       from small pool |      0 KiB |     99 MiB |   1112 GiB |   1112 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13855 MiB |  88390 GiB |  88390 GiB |
|       from large pool |  16640 KiB |  13797 MiB |  87280 GiB |  87280 GiB |
|       from small pool |      0 KiB |     99 MiB |   1109 GiB |   1109 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   3074 MiB |  14998 MiB |  39018 MiB |  35944 MiB |
|       from large pool |   3004 MiB |  14892 MiB |  38834 MiB |  35830 MiB |
|       from small pool |     70 MiB |    112 MiB |    184 MiB |    114 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   3065 MiB |  69012 GiB |  69012 GiB |
|       from large pool |  24320 KiB |   3057 MiB |  67895 GiB |  67895 GiB |
|       from small pool |      0 KiB |     45 MiB |   1116 GiB |   1116 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3107    |   16047 K  |   16047 K  |
|       from large pool |       2    |    1495    |    7956 K  |    7956 K  |
|       from small pool |       0    |    2231    |    8091 K  |    8091 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3107    |   16047 K  |   16047 K  |
|       from large pool |       2    |    1495    |    7956 K  |    7956 K  |
|       from small pool |       0    |    2231    |    8091 K  |    8091 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      95    |     596    |    1520    |    1425    |
|       from large pool |      60    |     543    |    1428    |    1368    |
|       from small pool |      35    |      56    |      92    |      57    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       2    |     580    |   10100 K  |   10100 K  |
|       from large pool |       2    |     534    |    5671 K  |    5671 K  |
|       from small pool |       0    |     243    |    4429 K  |    4429 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Sat Jul 27 02:14:55 2024]
Finished job 0.
1 of 1 steps (100%) done
