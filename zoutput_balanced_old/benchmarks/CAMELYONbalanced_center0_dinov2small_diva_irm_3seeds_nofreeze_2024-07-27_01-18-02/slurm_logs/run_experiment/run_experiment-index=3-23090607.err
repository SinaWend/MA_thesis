Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Sat Jul 27 03:21:26 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_diva_irm_3seeds_nofreeze_2024-07-27_01-18-02/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_diva_irm_3seeds_nofreeze_2024-07-27_01-18-02/rule_results/3.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=3
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/swiglu_ffn.py:51: UserWarning: xFormers is not available (SwiGLU)
  warnings.warn("xFormers is not available (SwiGLU)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/attention.py:33: UserWarning: xFormers is not available (Attention)
  warnings.warn("xFormers is not available (Attention)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/block.py:40: UserWarning: xFormers is not available (Block)
  warnings.warn("xFormers is not available (Block)")
Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main

using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_03_22_20_seed_0_23090607

 Experiment start at: 2024-07-27 03:22:21.092735
hyper-parameter scheduler not set,going to use default Warmpup and epoch update
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
before training, model accuracy: 0.5186046361923218
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/autograd/graph.py:744: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.94433594, 'precision': 0.9486299, 'recall': 0.9451084, 'specificity': 0.9451084, 'f1': 0.94425786, 'auroc': 0.9909097, 'binary_precision': 0.9964235, 'binary_recall': 0.8935215, 'binary_specificity': 0.9966953, 'binary_f1_score': 0.9421711}
confusion matrix:
      0     1
0  1508     5
1   166  1393
---- Validation: 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
scalar performance:
{'acc': 0.6995342, 'precision': 0.76915586, 'recall': 0.6959267, 'specificity': 0.6959267, 'f1': 0.6763103, 'auroc': 0.8867806, 'binary_precision': 0.9025974, 'binary_recall': 0.43779528, 'binary_specificity': 0.9540582, 'binary_f1_score': 0.58960766}
confusion matrix:
     0    1
0  623   30
1  357  278
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8395349, 'precision': 0.859779, 'recall': 0.8395349, 'specificity': 0.8395349, 'f1': 0.83724546, 'auroc': 0.9075825, 'binary_precision': 0.94512194, 'binary_recall': 0.7209302, 'binary_specificity': 0.95813954, 'binary_f1_score': 0.81794196}
confusion matrix:
     0    1
0  206    9
1   60  155
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-27 03:24:51.672164,epoch time: 0:02:30.579429,used: 0:02:30.579429,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_03_22_20_seed_0_23090607
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.96484375, 'precision': 0.9650762, 'recall': 0.9650068, 'specificity': 0.9650068, 'f1': 0.9648435, 'auroc': 0.9950275, 'binary_precision': 0.9788079, 'binary_recall': 0.951094, 'binary_specificity': 0.9789196, 'binary_f1_score': 0.96475196}
confusion matrix:
      0     1
0  1486    32
1    76  1478
---- Validation: 
scalar performance:
{'acc': 0.8586956, 'precision': 0.8614713, 'recall': 0.85808206, 'specificity': 0.85808206, 'f1': 0.85825264, 'auroc': 0.9166657, 'binary_precision': 0.8898451, 'binary_recall': 0.8141732, 'binary_specificity': 0.90199083, 'binary_f1_score': 0.85032886}
confusion matrix:
     0    1
0  589   64
1  118  517
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.83255816, 'precision': 0.835461, 'recall': 0.83255816, 'specificity': 0.83255816, 'f1': 0.8321951, 'auroc': 0.9038615, 'binary_precision': 0.8042553, 'binary_recall': 0.87906975, 'binary_specificity': 0.7860465, 'binary_f1_score': 0.84}
confusion matrix:
     0    1
0  169   46
1   26  189
better model found
persisted
after epoch: 2,now: 2024-07-27 03:27:15.170025,epoch time: 0:02:23.497861,used: 0:04:54.077290,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_03_22_20_seed_0_23090607
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.94596356, 'precision': 0.9505006, 'recall': 0.9465406, 'specificity': 0.9465406, 'f1': 0.9458695, 'auroc': 0.9941119, 'binary_precision': 0.99856216, 'binary_recall': 0.8943979, 'binary_specificity': 0.99868333, 'binary_f1_score': 0.94361407}
confusion matrix:
      0     1
0  1517     2
1   164  1389
---- Validation: 
scalar performance:
{'acc': 0.5085404, 'precision': 0.6288941, 'recall': 0.5015965, 'specificity': 0.5015965, 'f1': 0.3412978, 'auroc': 0.79470885, 'binary_precision': 0.75, 'binary_recall': 0.0047244094, 'binary_specificity': 0.9984686, 'binary_f1_score': 0.0093896715}
confusion matrix:
     0  1
0  652  1
1  632  3
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5, 'precision': 0.25, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.33333334, 'auroc': 0.7946565, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
     0  1
0  215  0
1  215  0
early stop counter: 1
val acc:0.5085403919219971, best validation acc: 0.8586956262588501, corresponding to test acc:                         0.8325581550598145 / 0.8395348787307739
after epoch: 3,now: 2024-07-27 03:29:37.891791,epoch time: 0:02:22.721766,used: 0:07:16.799056,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_03_22_20_seed_0_23090607
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.96484375, 'precision': 0.9665558, 'recall': 0.96532154, 'specificity': 0.96532154, 'f1': 0.96483034, 'auroc': 0.9966178, 'binary_precision': 0.9986245, 'binary_recall': 0.93196404, 'binary_specificity': 0.998679, 'binary_f1_score': 0.96414346}
confusion matrix:
      0     1
0  1512     2
1   106  1452
---- Validation: 
scalar performance:
{'acc': 0.6125776, 'precision': 0.72569597, 'recall': 0.6075424, 'specificity': 0.6075424, 'f1': 0.5515918, 'auroc': 0.8656063, 'binary_precision': 0.8820225, 'binary_recall': 0.24724409, 'binary_specificity': 0.96784073, 'binary_f1_score': 0.38622382}
confusion matrix:
     0    1
0  632   21
1  478  157
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.60232556, 'precision': 0.76777625, 'recall': 0.60232556, 'specificity': 0.60232556, 'f1': 0.5296759, 'auroc': 0.9002055, 'binary_precision': 0.9782609, 'binary_recall': 0.20930232, 'binary_specificity': 0.9953488, 'binary_f1_score': 0.34482756}
confusion matrix:
     0   1
0  214   1
1  170  45
early stop counter: 2
val acc:0.6125776171684265, best validation acc: 0.8586956262588501, corresponding to test acc:                         0.8325581550598145 / 0.8395348787307739
after epoch: 4,now: 2024-07-27 03:32:00.574358,epoch time: 0:02:22.682567,used: 0:09:39.481623,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_03_22_20_seed_0_23090607
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9742839, 'precision': 0.974303, 'recall': 0.97425973, 'specificity': 0.97425973, 'f1': 0.9742788, 'auroc': 0.9978694, 'binary_precision': 0.97307694, 'binary_recall': 0.97620577, 'binary_specificity': 0.97231376, 'binary_f1_score': 0.9746389}
confusion matrix:
      0     1
0  1475    42
1    37  1518
---- Validation: 
scalar performance:
{'acc': 0.7523292, 'precision': 0.75505674, 'recall': 0.75155365, 'specificity': 0.75155365, 'f1': 0.75124586, 'auroc': 0.83097273, 'binary_precision': 0.77816904, 'binary_recall': 0.696063, 'binary_specificity': 0.8070444, 'binary_f1_score': 0.7348296}
confusion matrix:
     0    1
0  527  126
1  193  442
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.80465114, 'precision': 0.80467755, 'recall': 0.80465114, 'specificity': 0.80465114, 'f1': 0.80464697, 'auroc': 0.87991345, 'binary_precision': 0.80751175, 'binary_recall': 0.8, 'binary_specificity': 0.80930233, 'binary_f1_score': 0.8037383}
confusion matrix:
     0    1
0  174   41
1   43  172
early stop counter: 3
val acc:0.7523291707038879, best validation acc: 0.8586956262588501, corresponding to test acc:                         0.8325581550598145 / 0.8395348787307739
after epoch: 5,now: 2024-07-27 03:34:23.712262,epoch time: 0:02:23.137904,used: 0:12:02.619527,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_03_22_20_seed_0_23090607
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.96972656, 'precision': 0.9706162, 'recall': 0.97004783, 'specificity': 0.97004783, 'f1': 0.96972215, 'auroc': 0.99539447, 'binary_precision': 0.99459094, 'binary_recall': 0.94537276, 'binary_specificity': 0.99472296, 'binary_f1_score': 0.9693575}
confusion matrix:
      0     1
0  1508     8
1    85  1471
---- Validation: 
scalar performance:
{'acc': 0.7958075, 'precision': 0.8012047, 'recall': 0.7948451, 'specificity': 0.7948451, 'f1': 0.7944932, 'auroc': 0.8756846, 'binary_precision': 0.8381818, 'binary_recall': 0.7259843, 'binary_specificity': 0.863706, 'binary_f1_score': 0.77805907}
confusion matrix:
     0    1
0  564   89
1  174  461
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8465116, 'precision': 0.84663165, 'recall': 0.8465116, 'specificity': 0.8465116, 'f1': 0.84649837, 'auroc': 0.9023472, 'binary_precision': 0.84018266, 'binary_recall': 0.855814, 'binary_specificity': 0.8372093, 'binary_f1_score': 0.8479263}
confusion matrix:
     0    1
0  180   35
1   31  184
new oracle model saved
early stop counter: 4
val acc:0.7958074808120728, best validation acc: 0.8586956262588501, corresponding to test acc:                         0.8325581550598145 / 0.8465116024017334
after epoch: 6,now: 2024-07-27 03:36:46.319118,epoch time: 0:02:22.606856,used: 0:14:25.226383,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_03_22_20_seed_0_23090607
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9742839, 'precision': 0.97502375, 'recall': 0.9745805, 'specificity': 0.9745805, 'f1': 0.9742812, 'auroc': 0.99880326, 'binary_precision': 0.9973064, 'binary_recall': 0.9517995, 'binary_specificity': 0.9973615, 'binary_f1_score': 0.9740217}
confusion matrix:
      0     1
0  1512     4
1    75  1481
---- Validation: 
scalar performance:
{'acc': 0.7569876, 'precision': 0.81314516, 'recall': 0.7539991, 'specificity': 0.7539991, 'f1': 0.74410427, 'auroc': 0.88683844, 'binary_precision': 0.9423077, 'binary_recall': 0.5401575, 'binary_specificity': 0.96784073, 'binary_f1_score': 0.6866867}
confusion matrix:
     0    1
0  632   21
1  292  343
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7209302, 'precision': 0.81616664, 'recall': 0.7209302, 'specificity': 0.7209302, 'f1': 0.69820327, 'auroc': 0.91601944, 'binary_precision': 0.9896907, 'binary_recall': 0.44651163, 'binary_specificity': 0.9953488, 'binary_f1_score': 0.61538464}
confusion matrix:
     0   1
0  214   1
1  119  96
early stop counter: 5
val acc:0.7569875717163086, best validation acc: 0.8586956262588501, corresponding to test acc:                         0.8325581550598145 / 0.8465116024017334
after epoch: 7,now: 2024-07-27 03:39:08.312115,epoch time: 0:02:21.992997,used: 0:16:47.219380,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_03_22_20_seed_0_23090607
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 7 with time: 0:16:47.219380 at 2024-07-27 03:39:08.312115
persisted model performance metric: 

scalar performance:
{'acc': 0.83255816, 'precision': 0.835461, 'recall': 0.83255816, 'specificity': 0.83255816, 'f1': 0.8321951, 'auroc': 0.9038615, 'binary_precision': 0.8042553, 'binary_recall': 0.87906975, 'binary_specificity': 0.7860465, 'binary_f1_score': 0.84}
confusion matrix:
     0    1
0  169   46
1   26  189
oracle model performance metric: 

scalar performance:
{'acc': 0.8465116, 'precision': 0.84663165, 'recall': 0.8465116, 'specificity': 0.8465116, 'f1': 0.84649837, 'auroc': 0.9023472, 'binary_precision': 0.84018266, 'binary_recall': 0.855814, 'binary_specificity': 0.8372093, 'binary_f1_score': 0.8479263}
confusion matrix:
     0    1
0  180   35
1   31  184
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_diva_irm_3seeds_nofreeze_2024-07-27_01-18-02/rule_results/3.csv
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_diva_irm_3seeds_nofreeze_2024-07-27_01-18-02/rule_results/3.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_diva_irm_3seeds_nofreeze_2024-07-27_01-18-02/confusion_matrix/3.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   2426 MiB |   8858 MiB |  43626 GiB |  43624 GiB |
|       from large pool |   2336 MiB |   8783 MiB |  43215 GiB |  43213 GiB |
|       from small pool |     89 MiB |    126 MiB |    410 GiB |    410 GiB |
|---------------------------------------------------------------------------|
| Active memory         |   2426 MiB |   8858 MiB |  43626 GiB |  43624 GiB |
|       from large pool |   2336 MiB |   8783 MiB |  43215 GiB |  43213 GiB |
|       from small pool |     89 MiB |    126 MiB |    410 GiB |    410 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |   2409 MiB |   8848 MiB |  43589 GiB |  43587 GiB |
|       from large pool |   2320 MiB |   8774 MiB |  43179 GiB |  43177 GiB |
|       from small pool |     89 MiB |    126 MiB |    409 GiB |    409 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   9366 MiB |   9366 MiB |   9366 MiB |      0 B   |
|       from large pool |   9232 MiB |   9232 MiB |   9232 MiB |      0 B   |
|       from small pool |    134 MiB |    134 MiB |    134 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |   1221 MiB |   1832 MiB |  37985 GiB |  37983 GiB |
|       from large pool |   1213 MiB |   1826 MiB |  37561 GiB |  37560 GiB |
|       from small pool |      8 MiB |     21 MiB |    423 GiB |    423 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    2464    |    3317    |    6668 K  |    6665 K  |
|       from large pool |     392    |     816    |    3332 K  |    3332 K  |
|       from small pool |    2072    |    2768    |    3335 K  |    3333 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    2464    |    3317    |    6668 K  |    6665 K  |
|       from large pool |     392    |     816    |    3332 K  |    3332 K  |
|       from small pool |    2072    |    2768    |    3335 K  |    3333 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     267    |     267    |     267    |       0    |
|       from large pool |     200    |     200    |     200    |       0    |
|       from small pool |      67    |      67    |      67    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     162    |     308    |    3389 K  |    3389 K  |
|       from large pool |      71    |     183    |    1766 K  |    1766 K  |
|       from small pool |      91    |     237    |    1623 K  |    1623 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   8858 MiB |  43626 GiB |  43626 GiB |
|       from large pool |  16640 KiB |   8783 MiB |  43215 GiB |  43215 GiB |
|       from small pool |      0 KiB |    126 MiB |    410 GiB |    410 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   8858 MiB |  43626 GiB |  43626 GiB |
|       from large pool |  16640 KiB |   8783 MiB |  43215 GiB |  43215 GiB |
|       from small pool |      0 KiB |    126 MiB |    410 GiB |    410 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   8848 MiB |  43589 GiB |  43589 GiB |
|       from large pool |  16640 KiB |   8774 MiB |  43179 GiB |  43179 GiB |
|       from small pool |      0 KiB |    126 MiB |    409 GiB |    409 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   3648 MiB |   9366 MiB |   9366 MiB |   5718 MiB |
|       from large pool |   3550 MiB |   9232 MiB |   9232 MiB |   5682 MiB |
|       from small pool |     98 MiB |    134 MiB |    134 MiB |     36 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1832 MiB |  37986 GiB |  37986 GiB |
|       from large pool |  24320 KiB |   1826 MiB |  37563 GiB |  37563 GiB |
|       from small pool |      0 KiB |     45 MiB |    423 GiB |    423 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3317    |    6668 K  |    6668 K  |
|       from large pool |       2    |     816    |    3332 K  |    3332 K  |
|       from small pool |       0    |    2768    |    3335 K  |    3335 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3317    |    6668 K  |    6668 K  |
|       from large pool |       2    |     816    |    3332 K  |    3332 K  |
|       from small pool |       0    |    2768    |    3335 K  |    3335 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     128    |     267    |     267    |     139    |
|       from large pool |      79    |     200    |     200    |     121    |
|       from small pool |      49    |      67    |      67    |      18    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |     308    |    3390 K  |    3390 K  |
|       from large pool |       4    |     183    |    1766 K  |    1766 K  |
|       from small pool |       0    |     237    |    1623 K  |    1623 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   8858 MiB |  43626 GiB |  43626 GiB |
|       from large pool |  16640 KiB |   8783 MiB |  43215 GiB |  43215 GiB |
|       from small pool |      0 KiB |    126 MiB |    410 GiB |    410 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   8858 MiB |  43626 GiB |  43626 GiB |
|       from large pool |  16640 KiB |   8783 MiB |  43215 GiB |  43215 GiB |
|       from small pool |      0 KiB |    126 MiB |    410 GiB |    410 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   8848 MiB |  43589 GiB |  43589 GiB |
|       from large pool |  16640 KiB |   8774 MiB |  43179 GiB |  43179 GiB |
|       from small pool |      0 KiB |    126 MiB |    409 GiB |    409 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   3648 MiB |   9366 MiB |   9366 MiB |   5718 MiB |
|       from large pool |   3550 MiB |   9232 MiB |   9232 MiB |   5682 MiB |
|       from small pool |     98 MiB |    134 MiB |    134 MiB |     36 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1832 MiB |  37986 GiB |  37986 GiB |
|       from large pool |  24320 KiB |   1826 MiB |  37563 GiB |  37563 GiB |
|       from small pool |      0 KiB |     45 MiB |    423 GiB |    423 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3317    |    6668 K  |    6668 K  |
|       from large pool |       2    |     816    |    3332 K  |    3332 K  |
|       from small pool |       0    |    2768    |    3335 K  |    3335 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3317    |    6668 K  |    6668 K  |
|       from large pool |       2    |     816    |    3332 K  |    3332 K  |
|       from small pool |       0    |    2768    |    3335 K  |    3335 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     128    |     267    |     267    |     139    |
|       from large pool |      79    |     200    |     200    |     121    |
|       from small pool |      49    |      67    |      67    |      18    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |     308    |    3390 K  |    3390 K  |
|       from large pool |       4    |     183    |    1766 K  |    1766 K  |
|       from small pool |       0    |     237    |    1623 K  |    1623 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main

using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_03_39_47_seed_1_23090607

 Experiment start at: 2024-07-27 03:39:47.769932
hyper-parameter scheduler not set,going to use default Warmpup and epoch update
before training, model accuracy: 0.5022222399711609
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9313151, 'precision': 0.9368429, 'recall': 0.9306401, 'specificity': 0.9306401, 'f1': 0.9310139, 'auroc': 0.9937043, 'binary_precision': 0.89069766, 'binary_recall': 0.985209, 'binary_specificity': 0.8760712, 'binary_f1_score': 0.9355725}
confusion matrix:
      0     1
0  1329   188
1    23  1532
---- Validation: 
scalar performance:
{'acc': 0.7689305, 'precision': 0.7920649, 'recall': 0.77119815, 'specificity': 0.77119815, 'f1': 0.76522195, 'auroc': 0.8657816, 'binary_precision': 0.70566505, 'binary_recall': 0.9095238, 'binary_specificity': 0.6328725, 'binary_f1_score': 0.79472953}
confusion matrix:
     0    1
0  412  239
1   57  573
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.72444445, 'precision': 0.74420255, 'recall': 0.72444445, 'specificity': 0.72444445, 'f1': 0.7187557, 'auroc': 0.8556839, 'binary_precision': 0.6747405, 'binary_recall': 0.8666667, 'binary_specificity': 0.5822222, 'binary_f1_score': 0.7587549}
confusion matrix:
     0    1
0  131   94
1   30  195
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-27 03:42:14.920274,epoch time: 0:02:27.150342,used: 0:02:27.150342,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_03_39_47_seed_1_23090607
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9742839, 'precision': 0.97434425, 'recall': 0.9743967, 'specificity': 0.9743967, 'f1': 0.9742836, 'auroc': 0.9973632, 'binary_precision': 0.9836173, 'binary_recall': 0.9652733, 'binary_specificity': 0.9835201, 'binary_f1_score': 0.974359}
confusion matrix:
      0     1
0  1492    25
1    54  1501
---- Validation: 
scalar performance:
{'acc': 0.785324, 'precision': 0.80885637, 'recall': 0.7830261, 'specificity': 0.7830261, 'f1': 0.7801777, 'auroc': 0.8828908, 'binary_precision': 0.8901099, 'binary_recall': 0.64285713, 'binary_specificity': 0.92319506, 'binary_f1_score': 0.7465437}
confusion matrix:
     0    1
0  601   50
1  225  405
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.73777777, 'precision': 0.79344726, 'recall': 0.73777777, 'specificity': 0.73777777, 'f1': 0.72472215, 'auroc': 0.87867653, 'binary_precision': 0.9212598, 'binary_recall': 0.52, 'binary_specificity': 0.95555556, 'binary_f1_score': 0.6647727}
confusion matrix:
     0    1
0  215   10
1  108  117
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-07-27 03:44:38.906248,epoch time: 0:02:23.985974,used: 0:04:51.136316,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_03_39_47_seed_1_23090607
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9661458, 'precision': 0.96757615, 'recall': 0.9665866, 'specificity': 0.9665866, 'f1': 0.9661361, 'auroc': 0.99606085, 'binary_precision': 0.997264, 'binary_recall': 0.93581516, 'binary_specificity': 0.99735796, 'binary_f1_score': 0.9655629}
confusion matrix:
      0     1
0  1510     4
1   100  1458
---- Validation: 
scalar performance:
{'acc': 0.7619048, 'precision': 0.80846614, 'recall': 0.758679, 'specificity': 0.758679, 'f1': 0.7510065, 'auroc': 0.9082266, 'binary_precision': 0.92428195, 'binary_recall': 0.5619048, 'binary_specificity': 0.95545316, 'binary_f1_score': 0.6989141}
confusion matrix:
     0    1
0  622   29
1  276  354
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5977778, 'precision': 0.7565298, 'recall': 0.5977778, 'specificity': 0.5977778, 'f1': 0.52416, 'auroc': 0.8992987, 'binary_precision': 0.9583333, 'binary_recall': 0.20444444, 'binary_specificity': 0.9911111, 'binary_f1_score': 0.33699632}
confusion matrix:
     0   1
0  223   2
1  179  46
early stop counter: 1
val acc:0.761904776096344, best validation acc: 0.785323977470398, corresponding to test acc:                         0.7377777695655823 / 0.7377777695655823
after epoch: 3,now: 2024-07-27 03:47:00.901421,epoch time: 0:02:21.995173,used: 0:07:13.131489,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_03_39_47_seed_1_23090607
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.961263, 'precision': 0.963324, 'recall': 0.9608214, 'specificity': 0.9608214, 'f1': 0.9611858, 'auroc': 0.9975827, 'binary_precision': 0.9357965, 'binary_recall': 0.99165595, 'binary_specificity': 0.9299868, 'binary_f1_score': 0.9629168}
confusion matrix:
      0     1
0  1408   106
1    13  1545
---- Validation: 
scalar performance:
{'acc': 0.7455113, 'precision': 0.7463968, 'recall': 0.74493086, 'specificity': 0.74493086, 'f1': 0.74493295, 'auroc': 0.8257431, 'binary_precision': 0.7576271, 'binary_recall': 0.7095238, 'binary_specificity': 0.7803379, 'binary_f1_score': 0.7327869}
confusion matrix:
     0    1
0  508  143
1  183  447
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.78444445, 'precision': 0.788, 'recall': 0.78444445, 'specificity': 0.78444445, 'f1': 0.78377706, 'auroc': 0.8677333, 'binary_precision': 0.756, 'binary_recall': 0.84, 'binary_specificity': 0.72888887, 'binary_f1_score': 0.7957895}
confusion matrix:
     0    1
0  164   61
1   36  189
new oracle model saved
early stop counter: 2
val acc:0.7455112934112549, best validation acc: 0.785323977470398, corresponding to test acc:                         0.7377777695655823 / 0.7844444513320923
after epoch: 4,now: 2024-07-27 03:49:24.418606,epoch time: 0:02:23.517185,used: 0:09:36.648674,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_03_39_47_seed_1_23090607
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.95670575, 'precision': 0.95888484, 'recall': 0.95716226, 'specificity': 0.95716226, 'f1': 0.9566785, 'auroc': 0.9945268, 'binary_precision': 0.99375, 'binary_recall': 0.9202572, 'binary_specificity': 0.99406725, 'binary_f1_score': 0.95559263}
confusion matrix:
      0     1
0  1508     9
1   124  1431
---- Validation: 
scalar performance:
{'acc': 0.6307572, 'precision': 0.7259389, 'recall': 0.62532, 'specificity': 0.62532, 'f1': 0.5818743, 'auroc': 0.8698095, 'binary_precision': 0.8685446, 'binary_recall': 0.2936508, 'binary_specificity': 0.9569892, 'binary_f1_score': 0.43890864}
confusion matrix:
     0    1
0  623   28
1  445  185
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.49333334, 'precision': 0.24832214, 'recall': 0.49333334, 'specificity': 0.49333334, 'f1': 0.33035713, 'auroc': 0.8760296, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9866667, 'binary_f1_score': 0.0}
confusion matrix:
     0  1
0  222  3
1  225  0
early stop counter: 3
val acc:0.630757212638855, best validation acc: 0.785323977470398, corresponding to test acc:                         0.7377777695655823 / 0.7844444513320923
after epoch: 5,now: 2024-07-27 03:51:46.522229,epoch time: 0:02:22.103623,used: 0:11:58.752297,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_03_39_47_seed_1_23090607
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.97753906, 'precision': 0.9778651, 'recall': 0.9777515, 'specificity': 0.9777515, 'f1': 0.9775388, 'auroc': 0.9985311, 'binary_precision': 0.9940199, 'binary_recall': 0.9614396, 'binary_specificity': 0.9940633, 'binary_f1_score': 0.97745836}
confusion matrix:
      0     1
0  1507     9
1    60  1496
---- Validation: 
scalar performance:
{'acc': 0.6541764, 'precision': 0.76243454, 'recall': 0.6488223, 'specificity': 0.6488223, 'f1': 0.6097995, 'auroc': 0.8835784, 'binary_precision': 0.9269406, 'binary_recall': 0.32222223, 'binary_specificity': 0.97542244, 'binary_f1_score': 0.47820964}
confusion matrix:
     0    1
0  635   16
1  427  203
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6333333, 'precision': 0.78846157, 'recall': 0.6333333, 'specificity': 0.6333333, 'f1': 0.57637995, 'auroc': 0.88073087, 'binary_precision': 1.0, 'binary_recall': 0.26666668, 'binary_specificity': 1.0, 'binary_f1_score': 0.42105266}
confusion matrix:
     0   1
0  225   0
1  165  60
early stop counter: 4
val acc:0.6541764140129089, best validation acc: 0.785323977470398, corresponding to test acc:                         0.7377777695655823 / 0.7844444513320923
after epoch: 6,now: 2024-07-27 03:54:10.087973,epoch time: 0:02:23.565744,used: 0:14:22.318041,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_03_39_47_seed_1_23090607
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.976237, 'precision': 0.97676784, 'recall': 0.9765259, 'specificity': 0.9765259, 'f1': 0.9762361, 'auroc': 0.9987201, 'binary_precision': 0.9966555, 'binary_recall': 0.9563543, 'binary_specificity': 0.9966975, 'binary_f1_score': 0.9760891}
confusion matrix:
      0     1
0  1509     5
1    68  1490
---- Validation: 
scalar performance:
{'acc': 0.6346604, 'precision': 0.73916006, 'recall': 0.62913465, 'specificity': 0.62913465, 'f1': 0.5845221, 'auroc': 0.8698809, 'binary_precision': 0.89320385, 'binary_recall': 0.2920635, 'binary_specificity': 0.96620584, 'binary_f1_score': 0.44019142}
confusion matrix:
     0    1
0  629   22
1  446  184
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.54444444, 'precision': 0.67857146, 'recall': 0.54444444, 'specificity': 0.54444444, 'f1': 0.4391245, 'auroc': 0.870084, 'binary_precision': 0.8333333, 'binary_recall': 0.11111111, 'binary_specificity': 0.9777778, 'binary_f1_score': 0.19607843}
confusion matrix:
     0   1
0  220   5
1  200  25
early stop counter: 5
val acc:0.6346604228019714, best validation acc: 0.785323977470398, corresponding to test acc:                         0.7377777695655823 / 0.7844444513320923
after epoch: 7,now: 2024-07-27 03:56:32.474734,epoch time: 0:02:22.386761,used: 0:16:44.704802,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_03_39_47_seed_1_23090607
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 7 with time: 0:16:44.704802 at 2024-07-27 03:56:32.474734
persisted model performance metric: 

scalar performance:
{'acc': 0.73777777, 'precision': 0.79344726, 'recall': 0.73777777, 'specificity': 0.73777777, 'f1': 0.72472215, 'auroc': 0.87867653, 'binary_precision': 0.9212598, 'binary_recall': 0.52, 'binary_specificity': 0.95555556, 'binary_f1_score': 0.6647727}
confusion matrix:
     0    1
0  215   10
1  108  117
oracle model performance metric: 

scalar performance:
{'acc': 0.78444445, 'precision': 0.788, 'recall': 0.78444445, 'specificity': 0.78444445, 'f1': 0.78377706, 'auroc': 0.8677333, 'binary_precision': 0.756, 'binary_recall': 0.84, 'binary_specificity': 0.72888887, 'binary_f1_score': 0.7957895}
confusion matrix:
     0    1
0  164   61
1   36  189
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_diva_irm_3seeds_nofreeze_2024-07-27_01-18-02/rule_results/3.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_diva_irm_3seeds_nofreeze_2024-07-27_01-18-02/confusion_matrix/3.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   2425 MiB |   8858 MiB |  87285 GiB |  87283 GiB |
|       from large pool |   2335 MiB |   8783 MiB |  86461 GiB |  86459 GiB |
|       from small pool |     89 MiB |    130 MiB |    823 GiB |    823 GiB |
|---------------------------------------------------------------------------|
| Active memory         |   2425 MiB |   8858 MiB |  87285 GiB |  87283 GiB |
|       from large pool |   2335 MiB |   8783 MiB |  86461 GiB |  86459 GiB |
|       from small pool |     89 MiB |    130 MiB |    823 GiB |    823 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |   2409 MiB |   8848 MiB |  87203 GiB |  87201 GiB |
|       from large pool |   2320 MiB |   8774 MiB |  86381 GiB |  86378 GiB |
|       from small pool |     89 MiB |    130 MiB |    822 GiB |    822 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   9332 MiB |   9366 MiB |  15050 MiB |   5718 MiB |
|       from large pool |   9192 MiB |   9232 MiB |  14874 MiB |   5682 MiB |
|       from small pool |    140 MiB |    140 MiB |    176 MiB |     36 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |   1186 MiB |   2382 MiB |  79169 GiB |  79168 GiB |
|       from large pool |   1176 MiB |   2374 MiB |  78319 GiB |  78318 GiB |
|       from small pool |     10 MiB |     45 MiB |    849 GiB |    849 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    2476    |    3329    |   13349 K  |   13347 K  |
|       from large pool |     392    |     816    |    6667 K  |    6666 K  |
|       from small pool |    2084    |    2780    |    6682 K  |    6680 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    2476    |    3329    |   13349 K  |   13347 K  |
|       from large pool |     392    |     816    |    6667 K  |    6666 K  |
|       from small pool |    2084    |    2780    |    6682 K  |    6680 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     234    |     267    |     373    |     139    |
|       from large pool |     164    |     200    |     285    |     121    |
|       from small pool |      70    |      70    |      88    |      18    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     166    |     315    |    6838 K  |    6838 K  |
|       from large pool |      77    |     183    |    3469 K  |    3469 K  |
|       from small pool |      89    |     238    |    3369 K  |    3368 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   8858 MiB |  87285 GiB |  87285 GiB |
|       from large pool |  16640 KiB |   8783 MiB |  86461 GiB |  86461 GiB |
|       from small pool |      0 KiB |    130 MiB |    823 GiB |    823 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   8858 MiB |  87285 GiB |  87285 GiB |
|       from large pool |  16640 KiB |   8783 MiB |  86461 GiB |  86461 GiB |
|       from small pool |      0 KiB |    130 MiB |    823 GiB |    823 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   8848 MiB |  87203 GiB |  87203 GiB |
|       from large pool |  16640 KiB |   8774 MiB |  86381 GiB |  86380 GiB |
|       from small pool |      0 KiB |    130 MiB |    822 GiB |    822 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   3612 MiB |   9366 MiB |  15050 MiB |  11438 MiB |
|       from large pool |   3512 MiB |   9232 MiB |  14874 MiB |  11362 MiB |
|       from small pool |    100 MiB |    140 MiB |    176 MiB |     76 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   2382 MiB |  79170 GiB |  79170 GiB |
|       from large pool |  24320 KiB |   2374 MiB |  78320 GiB |  78320 GiB |
|       from small pool |      0 KiB |     48 MiB |    849 GiB |    849 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3329    |   13349 K  |   13349 K  |
|       from large pool |       2    |     816    |    6667 K  |    6667 K  |
|       from small pool |       0    |    2780    |    6682 K  |    6682 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3329    |   13349 K  |   13349 K  |
|       from large pool |       2    |     816    |    6667 K  |    6667 K  |
|       from small pool |       0    |    2780    |    6682 K  |    6682 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     128    |     267    |     373    |     245    |
|       from large pool |      78    |     200    |     285    |     207    |
|       from small pool |      50    |      70    |      88    |      38    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |     315    |    6838 K  |    6838 K  |
|       from large pool |       4    |     183    |    3469 K  |    3469 K  |
|       from small pool |       0    |     238    |    3369 K  |    3369 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   8858 MiB |  87285 GiB |  87285 GiB |
|       from large pool |  16640 KiB |   8783 MiB |  86461 GiB |  86461 GiB |
|       from small pool |      0 KiB |    130 MiB |    823 GiB |    823 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   8858 MiB |  87285 GiB |  87285 GiB |
|       from large pool |  16640 KiB |   8783 MiB |  86461 GiB |  86461 GiB |
|       from small pool |      0 KiB |    130 MiB |    823 GiB |    823 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   8848 MiB |  87203 GiB |  87203 GiB |
|       from large pool |  16640 KiB |   8774 MiB |  86381 GiB |  86380 GiB |
|       from small pool |      0 KiB |    130 MiB |    822 GiB |    822 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   3612 MiB |   9366 MiB |  15050 MiB |  11438 MiB |
|       from large pool |   3512 MiB |   9232 MiB |  14874 MiB |  11362 MiB |
|       from small pool |    100 MiB |    140 MiB |    176 MiB |     76 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   2382 MiB |  79170 GiB |  79170 GiB |
|       from large pool |  24320 KiB |   2374 MiB |  78320 GiB |  78320 GiB |
|       from small pool |      0 KiB |     48 MiB |    849 GiB |    849 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3329    |   13349 K  |   13349 K  |
|       from large pool |       2    |     816    |    6667 K  |    6667 K  |
|       from small pool |       0    |    2780    |    6682 K  |    6682 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3329    |   13349 K  |   13349 K  |
|       from large pool |       2    |     816    |    6667 K  |    6667 K  |
|       from small pool |       0    |    2780    |    6682 K  |    6682 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     128    |     267    |     373    |     245    |
|       from large pool |      78    |     200    |     285    |     207    |
|       from small pool |      50    |      70    |      88    |      38    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |     315    |    6838 K  |    6838 K  |
|       from large pool |       4    |     183    |    3469 K  |    3469 K  |
|       from small pool |       0    |     238    |    3369 K  |    3369 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main

using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_03_57_11_seed_2_23090607

 Experiment start at: 2024-07-27 03:57:12.674404
hyper-parameter scheduler not set,going to use default Warmpup and epoch update
before training, model accuracy: 0.5
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9132853, 'precision': 0.92521703, 'recall': 0.91395074, 'specificity': 0.91395074, 'f1': 0.9127606, 'auroc': 0.987267, 'binary_precision': 0.9984363, 'binary_recall': 0.8292208, 'binary_specificity': 0.9986807, 'binary_f1_score': 0.905995}
confusion matrix:
      0     1
0  1514     2
1   263  1277
---- Validation: 
scalar performance:
{'acc': 0.6087637, 'precision': 0.75841534, 'recall': 0.5983624, 'specificity': 0.5983624, 'f1': 0.5311413, 'auroc': 0.8515239, 'binary_precision': 0.9485294, 'binary_recall': 0.2073955, 'binary_specificity': 0.9893293, 'binary_f1_score': 0.3403694}
confusion matrix:
     0    1
0  649    7
1  493  129
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6435185, 'precision': 0.79189193, 'recall': 0.6435185, 'specificity': 0.6435185, 'f1': 0.59162223, 'auroc': 0.87875086, 'binary_precision': 1.0, 'binary_recall': 0.28703704, 'binary_specificity': 1.0, 'binary_f1_score': 0.4460432}
confusion matrix:
     0   1
0  216   0
1  154  62
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-27 03:59:38.481676,epoch time: 0:02:25.807272,used: 0:02:25.807272,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_03_57_11_seed_2_23090607
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9676047, 'precision': 0.9676226, 'recall': 0.9676464, 'specificity': 0.9676464, 'f1': 0.9676046, 'auroc': 0.9955993, 'binary_precision': 0.97307944, 'binary_recall': 0.9623377, 'binary_specificity': 0.97295517, 'binary_f1_score': 0.9676787}
confusion matrix:
      0     1
0  1475    41
1    58  1482
---- Validation: 
scalar performance:
{'acc': 0.7402191, 'precision': 0.75518763, 'recall': 0.7432848, 'specificity': 0.7432848, 'f1': 0.7378299, 'auroc': 0.8458209, 'binary_precision': 0.6863753, 'binary_recall': 0.8585209, 'binary_specificity': 0.6280488, 'binary_f1_score': 0.76285714}
confusion matrix:
     0    1
0  412  244
1   88  534
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6319444, 'precision': 0.70165753, 'recall': 0.6319444, 'specificity': 0.6319444, 'f1': 0.597126, 'auroc': 0.8757287, 'binary_precision': 0.58309036, 'binary_recall': 0.9259259, 'binary_specificity': 0.33796296, 'binary_f1_score': 0.7155635}
confusion matrix:
    0    1
0  73  143
1  16  200
better model found
persisted
after epoch: 2,now: 2024-07-27 04:02:01.036325,epoch time: 0:02:22.554649,used: 0:04:48.361921,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_03_57_11_seed_2_23090607
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9728403, 'precision': 0.9729245, 'recall': 0.972908, 'specificity': 0.972908, 'f1': 0.9728403, 'auroc': 0.99664617, 'binary_precision': 0.9814937, 'binary_recall': 0.96428573, 'binary_specificity': 0.98153037, 'binary_f1_score': 0.97281367}
confusion matrix:
      0     1
0  1488    28
1    55  1485
---- Validation: 
scalar performance:
{'acc': 0.81846637, 'precision': 0.8183731, 'recall': 0.8182545, 'specificity': 0.8182545, 'f1': 0.81830573, 'auroc': 0.88282967, 'binary_precision': 0.815534, 'binary_recall': 0.8102894, 'binary_specificity': 0.8262195, 'binary_f1_score': 0.8129032}
confusion matrix:
     0    1
0  542  114
1  118  504
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8217593, 'precision': 0.83043516, 'recall': 0.8217592, 'specificity': 0.8217592, 'f1': 0.82058156, 'auroc': 0.9058857, 'binary_precision': 0.8839779, 'binary_recall': 0.7407407, 'binary_specificity': 0.9027778, 'binary_f1_score': 0.80604523}
confusion matrix:
     0    1
0  195   21
1   56  160
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-07-27 04:04:24.347879,epoch time: 0:02:23.311554,used: 0:07:11.673475,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_03_57_11_seed_2_23090607
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.96138746, 'precision': 0.9637159, 'recall': 0.961678, 'specificity': 0.961678, 'f1': 0.9613539, 'auroc': 0.9976419, 'binary_precision': 0.9985975, 'binary_recall': 0.92467535, 'binary_specificity': 0.9986807, 'binary_f1_score': 0.9602158}
confusion matrix:
      0     1
0  1514     2
1   116  1424
---- Validation: 
scalar performance:
{'acc': 0.65336466, 'precision': 0.76392776, 'recall': 0.64451563, 'specificity': 0.64451563, 'f1': 0.6050479, 'auroc': 0.88274205, 'binary_precision': 0.9282297, 'binary_recall': 0.3118971, 'binary_specificity': 0.97713417, 'binary_f1_score': 0.46690732}
confusion matrix:
     0    1
0  641   15
1  428  194
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6041667, 'precision': 0.70905924, 'recall': 0.6041666, 'specificity': 0.6041666, 'f1': 0.5473945, 'auroc': 0.87242794, 'binary_precision': 0.85714287, 'binary_recall': 0.25, 'binary_specificity': 0.9583333, 'binary_f1_score': 0.38709676}
confusion matrix:
     0   1
0  207   9
1  162  54
early stop counter: 1
val acc:0.6533646583557129, best validation acc: 0.8184663653373718, corresponding to test acc:                         0.8217592835426331 / 0.8217592835426331
after epoch: 4,now: 2024-07-27 04:06:45.755313,epoch time: 0:02:21.407434,used: 0:09:33.080909,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_03_57_11_seed_2_23090607
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9757853, 'precision': 0.9758051, 'recall': 0.97576845, 'specificity': 0.97576845, 'f1': 0.975783, 'auroc': 0.9975208, 'binary_precision': 0.97412676, 'binary_recall': 0.9779221, 'binary_specificity': 0.97361475, 'binary_f1_score': 0.9760208}
confusion matrix:
      0     1
0  1476    40
1    34  1506
---- Validation: 
scalar performance:
{'acc': 0.814554, 'precision': 0.82912886, 'recall': 0.81169367, 'specificity': 0.81169367, 'f1': 0.8114104, 'auroc': 0.8927878, 'binary_precision': 0.892057, 'binary_recall': 0.70418006, 'binary_specificity': 0.91920733, 'binary_f1_score': 0.787062}
confusion matrix:
     0    1
0  603   53
1  184  438
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8009259, 'precision': 0.8409422, 'recall': 0.8009259, 'specificity': 0.8009259, 'f1': 0.79490805, 'auroc': 0.9080719, 'binary_precision': 0.9577465, 'binary_recall': 0.6296296, 'binary_specificity': 0.9722222, 'binary_f1_score': 0.75977653}
confusion matrix:
     0    1
0  210    6
1   80  136
early stop counter: 2
val acc:0.81455397605896, best validation acc: 0.8184663653373718, corresponding to test acc:                         0.8217592835426331 / 0.8217592835426331
after epoch: 5,now: 2024-07-27 04:09:07.441741,epoch time: 0:02:21.686428,used: 0:11:54.767337,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_03_57_11_seed_2_23090607
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.95778793, 'precision': 0.9584973, 'recall': 0.957644, 'specificity': 0.957644, 'f1': 0.95775974, 'auroc': 0.9947585, 'binary_precision': 0.94231975, 'binary_recall': 0.975974, 'binary_specificity': 0.939314, 'binary_f1_score': 0.9588517}
confusion matrix:
      0     1
0  1424    92
1    37  1503
---- Validation: 
scalar performance:
{'acc': 0.7605634, 'precision': 0.7851119, 'recall': 0.7565191, 'specificity': 0.7565191, 'f1': 0.7532513, 'auroc': 0.8619214, 'binary_precision': 0.86238533, 'binary_recall': 0.6045016, 'binary_specificity': 0.9085366, 'binary_f1_score': 0.710775}
confusion matrix:
     0    1
0  596   60
1  246  376
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7476852, 'precision': 0.79833484, 'recall': 0.7476852, 'specificity': 0.7476852, 'f1': 0.73650134, 'auroc': 0.8813014, 'binary_precision': 0.9212598, 'binary_recall': 0.5416667, 'binary_specificity': 0.9537037, 'binary_f1_score': 0.68221575}
confusion matrix:
     0    1
0  206   10
1   99  117
early stop counter: 3
val acc:0.7605633735656738, best validation acc: 0.8184663653373718, corresponding to test acc:                         0.8217592835426331 / 0.8217592835426331
after epoch: 6,now: 2024-07-27 04:11:28.538605,epoch time: 0:02:21.096864,used: 0:14:15.864201,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_03_57_11_seed_2_23090607
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.98003924, 'precision': 0.98005724, 'recall': 0.9800817, 'specificity': 0.9800817, 'f1': 0.9800391, 'auroc': 0.99762833, 'binary_precision': 0.9855548, 'binary_recall': 0.9746753, 'binary_specificity': 0.9854881, 'binary_f1_score': 0.98008484}
confusion matrix:
      0     1
0  1494    22
1    39  1501
---- Validation: 
scalar performance:
{'acc': 0.80046946, 'precision': 0.8195474, 'recall': 0.79714096, 'specificity': 0.79714096, 'f1': 0.7961041, 'auroc': 0.90004456, 'binary_precision': 0.891258, 'binary_recall': 0.67202574, 'binary_specificity': 0.9222561, 'binary_f1_score': 0.7662695}
confusion matrix:
     0    1
0  605   51
1  204  418
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.775463, 'precision': 0.8132266, 'recall': 0.775463, 'specificity': 0.775463, 'f1': 0.76848495, 'auroc': 0.90886486, 'binary_precision': 0.9219858, 'binary_recall': 0.6018519, 'binary_specificity': 0.9490741, 'binary_f1_score': 0.7282914}
confusion matrix:
     0    1
0  205   11
1   86  130
early stop counter: 4
val acc:0.8004694581031799, best validation acc: 0.8184663653373718, corresponding to test acc:                         0.8217592835426331 / 0.8217592835426331
after epoch: 7,now: 2024-07-27 04:13:51.136644,epoch time: 0:02:22.598039,used: 0:16:38.462240,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_03_57_11_seed_2_23090607
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.97742146, 'precision': 0.9774138, 'recall': 0.9774381, 'specificity': 0.9774381, 'f1': 0.97742075, 'auroc': 0.9976395, 'binary_precision': 0.97977823, 'binary_recall': 0.9753247, 'binary_specificity': 0.97955143, 'binary_f1_score': 0.97754633}
confusion matrix:
      0     1
0  1485    31
1    38  1502
---- Validation: 
scalar performance:
{'acc': 0.65336466, 'precision': 0.7582336, 'recall': 0.6446406, 'specificity': 0.6446406, 'f1': 0.6065104, 'auroc': 0.85501623, 'binary_precision': 0.9162791, 'binary_recall': 0.31672025, 'binary_specificity': 0.972561, 'binary_f1_score': 0.47072878}
confusion matrix:
     0    1
0  638   18
1  425  197
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.525463, 'precision': 0.60165143, 'recall': 0.5254629, 'specificity': 0.5254629, 'f1': 0.41604295, 'auroc': 0.85485256, 'binary_precision': 0.6896552, 'binary_recall': 0.09259259, 'binary_specificity': 0.9583333, 'binary_f1_score': 0.1632653}
confusion matrix:
     0   1
0  207   9
1  196  20
early stop counter: 5
val acc:0.6533646583557129, best validation acc: 0.8184663653373718, corresponding to test acc:                         0.8217592835426331 / 0.8217592835426331
after epoch: 8,now: 2024-07-27 04:16:12.166345,epoch time: 0:02:21.029701,used: 0:18:59.491941,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_03_57_11_seed_2_23090607
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 8 with time: 0:18:59.491941 at 2024-07-27 04:16:12.166345
persisted model performance metric: 

scalar performance:
{'acc': 0.8217593, 'precision': 0.83043516, 'recall': 0.8217592, 'specificity': 0.8217592, 'f1': 0.82058156, 'auroc': 0.9058857, 'binary_precision': 0.8839779, 'binary_recall': 0.7407407, 'binary_specificity': 0.9027778, 'binary_f1_score': 0.80604523}
confusion matrix:
     0    1
0  195   21
1   56  160
oracle model performance metric: 

scalar performance:
{'acc': 0.8217593, 'precision': 0.83043516, 'recall': 0.8217592, 'specificity': 0.8217592, 'f1': 0.82058156, 'auroc': 0.9058857, 'binary_precision': 0.8839779, 'binary_recall': 0.7407407, 'binary_specificity': 0.9027778, 'binary_f1_score': 0.80604523}
confusion matrix:
     0    1
0  195   21
1   56  160
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_diva_irm_3seeds_nofreeze_2024-07-27_01-18-02/rule_results/3.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_diva_irm_3seeds_nofreeze_2024-07-27_01-18-02/confusion_matrix/3.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   2426 MiB |   8861 MiB | 136870 GiB | 136868 GiB |
|       from large pool |   2336 MiB |   8786 MiB | 135580 GiB | 135578 GiB |
|       from small pool |     89 MiB |    130 MiB |   1289 GiB |   1289 GiB |
|---------------------------------------------------------------------------|
| Active memory         |   2426 MiB |   8861 MiB | 136870 GiB | 136868 GiB |
|       from large pool |   2336 MiB |   8786 MiB | 135580 GiB | 135578 GiB |
|       from small pool |     89 MiB |    130 MiB |   1289 GiB |   1289 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |   2409 MiB |   8848 MiB | 136734 GiB | 136732 GiB |
|       from large pool |   2320 MiB |   8774 MiB | 135446 GiB | 135444 GiB |
|       from small pool |     89 MiB |    130 MiB |   1287 GiB |   1287 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   9322 MiB |   9366 MiB |  20760 MiB |  11438 MiB |
|       from large pool |   9186 MiB |   9232 MiB |  20548 MiB |  11362 MiB |
|       from small pool |    136 MiB |    140 MiB |    212 MiB |     76 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |   1155 MiB |   2765 MiB | 125279 GiB | 125278 GiB |
|       from large pool |   1147 MiB |   2757 MiB | 123949 GiB | 123948 GiB |
|       from small pool |      8 MiB |     48 MiB |   1329 GiB |   1329 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    2464    |    3329    |   20922 K  |   20919 K  |
|       from large pool |     392    |     816    |   10452 K  |   10452 K  |
|       from small pool |    2072    |    2780    |   10469 K  |   10467 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    2464    |    3329    |   20922 K  |   20919 K  |
|       from large pool |     392    |     816    |   10452 K  |   10452 K  |
|       from small pool |    2072    |    2780    |   10469 K  |   10467 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     232    |     267    |     477    |     245    |
|       from large pool |     164    |     200    |     371    |     207    |
|       from small pool |      68    |      70    |     106    |      38    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     159    |     315    |   10935 K  |   10935 K  |
|       from large pool |      77    |     183    |    5584 K  |    5584 K  |
|       from small pool |      82    |     238    |    5350 K  |    5350 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   8861 MiB | 136870 GiB | 136870 GiB |
|       from large pool |  16640 KiB |   8786 MiB | 135580 GiB | 135580 GiB |
|       from small pool |      0 KiB |    130 MiB |   1289 GiB |   1289 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   8861 MiB | 136870 GiB | 136870 GiB |
|       from large pool |  16640 KiB |   8786 MiB | 135580 GiB | 135580 GiB |
|       from small pool |      0 KiB |    130 MiB |   1289 GiB |   1289 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   8848 MiB | 136734 GiB | 136734 GiB |
|       from large pool |  16640 KiB |   8774 MiB | 135446 GiB | 135446 GiB |
|       from small pool |      0 KiB |    130 MiB |   1287 GiB |   1287 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   3582 MiB |   9366 MiB |  20760 MiB |  17178 MiB |
|       from large pool |   3484 MiB |   9232 MiB |  20548 MiB |  17064 MiB |
|       from small pool |     98 MiB |    140 MiB |    212 MiB |    114 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   2765 MiB | 125281 GiB | 125281 GiB |
|       from large pool |  24320 KiB |   2757 MiB | 123951 GiB | 123951 GiB |
|       from small pool |      0 KiB |     48 MiB |   1329 GiB |   1329 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3329    |   20922 K  |   20922 K  |
|       from large pool |       2    |     816    |   10452 K  |   10452 K  |
|       from small pool |       0    |    2780    |   10469 K  |   10469 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3329    |   20922 K  |   20922 K  |
|       from large pool |       2    |     816    |   10452 K  |   10452 K  |
|       from small pool |       0    |    2780    |   10469 K  |   10469 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     127    |     267    |     477    |     350    |
|       from large pool |      78    |     200    |     371    |     293    |
|       from small pool |      49    |      70    |     106    |      57    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |     315    |   10935 K  |   10935 K  |
|       from large pool |       4    |     183    |    5584 K  |    5584 K  |
|       from small pool |       0    |     238    |    5350 K  |    5350 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Sat Jul 27 04:16:21 2024]
Finished job 0.
1 of 1 steps (100%) done
