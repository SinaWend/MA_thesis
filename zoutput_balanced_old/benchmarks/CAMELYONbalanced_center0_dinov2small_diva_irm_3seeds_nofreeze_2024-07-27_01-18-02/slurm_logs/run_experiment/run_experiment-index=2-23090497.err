Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Sat Jul 27 03:03:55 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_diva_irm_3seeds_nofreeze_2024-07-27_01-18-02/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_diva_irm_3seeds_nofreeze_2024-07-27_01-18-02/rule_results/2.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=2
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/swiglu_ffn.py:51: UserWarning: xFormers is not available (SwiGLU)
  warnings.warn("xFormers is not available (SwiGLU)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/attention.py:33: UserWarning: xFormers is not available (Attention)
  warnings.warn("xFormers is not available (Attention)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/block.py:40: UserWarning: xFormers is not available (Block)
  warnings.warn("xFormers is not available (Block)")
Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main

using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_03_04_39_seed_0_23090497

 Experiment start at: 2024-07-27 03:04:40.112417
hyper-parameter scheduler not set,going to use default Warmpup and epoch update
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
before training, model accuracy: 0.48604652285575867
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/autograd/graph.py:744: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.95996094, 'precision': 0.9613297, 'recall': 0.96032935, 'specificity': 0.96032935, 'f1': 0.95994806, 'auroc': 0.99477684, 'binary_precision': 0.9897401, 'binary_recall': 0.93054664, 'binary_specificity': 0.99011207, 'binary_f1_score': 0.959231}
confusion matrix:
      0     1
0  1502    15
1   108  1447
---- Validation: 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
scalar performance:
{'acc': 0.76863354, 'precision': 0.77741885, 'recall': 0.76735115, 'specificity': 0.76735115, 'f1': 0.7661777, 'auroc': 0.84804237, 'binary_precision': 0.82341653, 'binary_recall': 0.6755906, 'binary_specificity': 0.8591118, 'binary_f1_score': 0.7422146}
confusion matrix:
     0    1
0  561   92
1  206  429
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.80697674, 'precision': 0.81189555, 'recall': 0.80697674, 'specificity': 0.80697674, 'f1': 0.80621266, 'auroc': 0.89468896, 'binary_precision': 0.85106385, 'binary_recall': 0.74418604, 'binary_specificity': 0.8697674, 'binary_f1_score': 0.7940447}
confusion matrix:
     0    1
0  187   28
1   55  160
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-27 03:07:05.960656,epoch time: 0:02:25.848239,used: 0:02:25.848239,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_03_04_39_seed_0_23090497
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.97233075, 'precision': 0.9723108, 'recall': 0.9723478, 'specificity': 0.9723478, 'f1': 0.9723267, 'auroc': 0.9965695, 'binary_precision': 0.97422683, 'binary_recall': 0.97109824, 'binary_specificity': 0.97359735, 'binary_f1_score': 0.97266}
confusion matrix:
      0     1
0  1475    40
1    45  1512
---- Validation: 
scalar performance:
{'acc': 0.8035714, 'precision': 0.8096793, 'recall': 0.8025672, 'specificity': 0.8025672, 'f1': 0.8022064, 'auroc': 0.8783953, 'binary_precision': 0.84981686, 'binary_recall': 0.73070866, 'binary_specificity': 0.8744257, 'binary_f1_score': 0.78577477}
confusion matrix:
     0    1
0  571   82
1  171  464
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.83488375, 'precision': 0.86020106, 'recall': 0.8348837, 'specificity': 0.8348837, 'f1': 0.8319305, 'auroc': 0.9225527, 'binary_precision': 0.9556962, 'binary_recall': 0.7023256, 'binary_specificity': 0.96744186, 'binary_f1_score': 0.8096515}
confusion matrix:
     0    1
0  208    7
1   64  151
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-07-27 03:09:27.701945,epoch time: 0:02:21.741289,used: 0:04:47.589528,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_03_04_39_seed_0_23090497
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9684245, 'precision': 0.9699131, 'recall': 0.9688504, 'specificity': 0.9688504, 'f1': 0.96841437, 'auroc': 0.9983555, 'binary_precision': 1.0, 'binary_recall': 0.9377007, 'binary_specificity': 1.0, 'binary_f1_score': 0.96784884}
confusion matrix:
      0     1
0  1515     0
1    97  1460
---- Validation: 
scalar performance:
{'acc': 0.6917702, 'precision': 0.7817421, 'recall': 0.68777055, 'specificity': 0.68777055, 'f1': 0.6622131, 'auroc': 0.8763647, 'binary_precision': 0.9375, 'binary_recall': 0.4015748, 'binary_specificity': 0.9739663, 'binary_f1_score': 0.56229323}
confusion matrix:
     0    1
0  636   17
1  380  255
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.75116277, 'precision': 0.8338509, 'recall': 0.75116277, 'specificity': 0.75116277, 'f1': 0.73473775, 'auroc': 0.92772305, 'binary_precision': 1.0, 'binary_recall': 0.5023256, 'binary_specificity': 1.0, 'binary_f1_score': 0.6687307}
confusion matrix:
     0    1
0  215    0
1  107  108
early stop counter: 1
val acc:0.6917701959609985, best validation acc: 0.8035714030265808, corresponding to test acc:                         0.8348837494850159 / 0.8348837494850159
after epoch: 3,now: 2024-07-27 03:11:47.572927,epoch time: 0:02:19.870982,used: 0:07:07.460510,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_03_04_39_seed_0_23090497
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9720052, 'precision': 0.9723542, 'recall': 0.971864, 'specificity': 0.971864, 'f1': 0.97198987, 'auroc': 0.99780667, 'binary_precision': 0.9622404, 'binary_recall': 0.98327976, 'binary_specificity': 0.96044827, 'binary_f1_score': 0.9726463}
confusion matrix:
      0     1
0  1457    60
1    26  1529
---- Validation: 
scalar performance:
{'acc': 0.78881985, 'precision': 0.80573106, 'recall': 0.78715074, 'specificity': 0.78715074, 'f1': 0.78516483, 'auroc': 0.8905451, 'binary_precision': 0.8742268, 'binary_recall': 0.66771656, 'binary_specificity': 0.906585, 'binary_f1_score': 0.7571429}
confusion matrix:
     0    1
0  592   61
1  211  424
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7767442, 'precision': 0.84214604, 'recall': 0.7767442, 'specificity': 0.7767442, 'f1': 0.76553977, 'auroc': 0.9327853, 'binary_precision': 0.9917355, 'binary_recall': 0.55813956, 'binary_specificity': 0.9953488, 'binary_f1_score': 0.71428573}
confusion matrix:
     0    1
0  214    1
1   95  120
early stop counter: 2
val acc:0.7888198494911194, best validation acc: 0.8035714030265808, corresponding to test acc:                         0.8348837494850159 / 0.8348837494850159
after epoch: 4,now: 2024-07-27 03:14:07.398860,epoch time: 0:02:19.825933,used: 0:09:27.286443,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_03_04_39_seed_0_23090497
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.96940106, 'precision': 0.9704461, 'recall': 0.96972656, 'specificity': 0.96972656, 'f1': 0.9693947, 'auroc': 0.9975128, 'binary_precision': 0.9959267, 'binary_recall': 0.94340837, 'binary_specificity': 0.9960448, 'binary_f1_score': 0.96895635}
confusion matrix:
      0     1
0  1511     6
1    88  1467
---- Validation: 
scalar performance:
{'acc': 0.7779503, 'precision': 0.8193393, 'recall': 0.7754109, 'specificity': 0.7754109, 'f1': 0.7694011, 'auroc': 0.9180596, 'binary_precision': 0.9308642, 'binary_recall': 0.59370077, 'binary_specificity': 0.95712095, 'binary_f1_score': 0.725}
confusion matrix:
     0    1
0  625   28
1  258  377
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8255814, 'precision': 0.8680067, 'recall': 0.8255814, 'specificity': 0.8255814, 'f1': 0.82040524, 'auroc': 0.92030287, 'binary_precision': 0.9929578, 'binary_recall': 0.65581393, 'binary_specificity': 0.9953488, 'binary_f1_score': 0.7899159}
confusion matrix:
     0    1
0  214    1
1   74  141
early stop counter: 3
val acc:0.7779502868652344, best validation acc: 0.8035714030265808, corresponding to test acc:                         0.8348837494850159 / 0.8348837494850159
after epoch: 5,now: 2024-07-27 03:16:27.067869,epoch time: 0:02:19.669009,used: 0:11:46.955452,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_03_04_39_seed_0_23090497
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.984375, 'precision': 0.9844816, 'recall': 0.9845096, 'specificity': 0.9845096, 'f1': 0.984375, 'auroc': 0.9994222, 'binary_precision': 0.99539775, 'binary_recall': 0.97363347, 'binary_specificity': 0.99538565, 'binary_f1_score': 0.9843953}
confusion matrix:
      0     1
0  1510     7
1    41  1514
---- Validation: 
scalar performance:
{'acc': 0.7748447, 'precision': 0.77966785, 'recall': 0.7738891, 'specificity': 0.7738891, 'f1': 0.77342373, 'auroc': 0.87194896, 'binary_precision': 0.81306714, 'binary_recall': 0.7055118, 'binary_specificity': 0.84226644, 'binary_f1_score': 0.7554806}
confusion matrix:
     0    1
0  550  103
1  187  448
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8511628, 'precision': 0.8514365, 'recall': 0.8511628, 'specificity': 0.8511628, 'f1': 0.8511338, 'auroc': 0.9205841, 'binary_precision': 0.84162897, 'binary_recall': 0.8651163, 'binary_specificity': 0.8372093, 'binary_f1_score': 0.853211}
confusion matrix:
     0    1
0  180   35
1   29  186
new oracle model saved
early stop counter: 4
val acc:0.7748447060585022, best validation acc: 0.8035714030265808, corresponding to test acc:                         0.8348837494850159 / 0.8511627912521362
after epoch: 6,now: 2024-07-27 03:18:46.915262,epoch time: 0:02:19.847393,used: 0:14:06.802845,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_03_04_39_seed_0_23090497
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9628906, 'precision': 0.9644923, 'recall': 0.9625547, 'specificity': 0.9625547, 'f1': 0.9628339, 'auroc': 0.9972073, 'binary_precision': 0.9401344, 'binary_recall': 0.9897106, 'binary_specificity': 0.9353988, 'binary_f1_score': 0.9642857}
confusion matrix:
      0     1
0  1419    98
1    16  1539
---- Validation: 
scalar performance:
{'acc': 0.8377329, 'precision': 0.8393267, 'recall': 0.8382113, 'specificity': 0.8382113, 'f1': 0.83765054, 'auroc': 0.90788484, 'binary_precision': 0.8123167, 'binary_recall': 0.87244093, 'binary_specificity': 0.8039816, 'binary_f1_score': 0.8413059}
confusion matrix:
     0    1
0  525  128
1   81  554
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.872093, 'precision': 0.88344926, 'recall': 0.872093, 'specificity': 0.872093, 'f1': 0.87113893, 'auroc': 0.93540287, 'binary_precision': 0.9494382, 'binary_recall': 0.7860465, 'binary_specificity': 0.95813954, 'binary_f1_score': 0.8600509}
confusion matrix:
     0    1
0  206    9
1   46  169
new oracle model saved
better model found
persisted
after epoch: 7,now: 2024-07-27 03:21:08.065077,epoch time: 0:02:21.149815,used: 0:16:27.952660,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_03_04_39_seed_0_23090497
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.97721356, 'precision': 0.97722906, 'recall': 0.97719026, 'specificity': 0.97719026, 'f1': 0.97720796, 'auroc': 0.99807906, 'binary_precision': 0.9763124, 'binary_recall': 0.978819, 'binary_specificity': 0.97556144, 'binary_f1_score': 0.9775641}
confusion matrix:
      0     1
0  1477    37
1    33  1525
---- Validation: 
scalar performance:
{'acc': 0.85248446, 'precision': 0.8530878, 'recall': 0.85278124, 'specificity': 0.85278124, 'f1': 0.8524717, 'auroc': 0.9118858, 'binary_precision': 0.83458644, 'binary_recall': 0.87401575, 'binary_specificity': 0.8315467, 'binary_f1_score': 0.85384613}
confusion matrix:
     0    1
0  543  110
1   80  555
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8465116, 'precision': 0.8533921, 'recall': 0.8465116, 'specificity': 0.8465116, 'f1': 0.8457608, 'auroc': 0.9136614, 'binary_precision': 0.9027027, 'binary_recall': 0.7767442, 'binary_specificity': 0.9162791, 'binary_f1_score': 0.835}
confusion matrix:
     0    1
0  197   18
1   48  167
better model found
persisted
after epoch: 8,now: 2024-07-27 03:23:28.718699,epoch time: 0:02:20.653622,used: 0:18:48.606282,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_03_04_39_seed_0_23090497
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9866536, 'precision': 0.9868022, 'recall': 0.98657084, 'specificity': 0.98657084, 'f1': 0.98664874, 'auroc': 0.9993137, 'binary_precision': 0.9809524, 'binary_recall': 0.9929306, 'binary_specificity': 0.9802111, 'binary_f1_score': 0.98690516}
confusion matrix:
      0     1
0  1486    30
1    11  1545
---- Validation: 
scalar performance:
{'acc': 0.6902174, 'precision': 0.762128, 'recall': 0.6864996, 'specificity': 0.6864996, 'f1': 0.66474944, 'auroc': 0.90015554, 'binary_precision': 0.89597315, 'binary_recall': 0.42047244, 'binary_specificity': 0.9525268, 'binary_f1_score': 0.5723473}
confusion matrix:
     0    1
0  622   31
1  368  267
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6604651, 'precision': 0.75754315, 'recall': 0.6604651, 'specificity': 0.6604651, 'f1': 0.62514037, 'auroc': 0.89236885, 'binary_precision': 0.91566265, 'binary_recall': 0.3534884, 'binary_specificity': 0.96744186, 'binary_f1_score': 0.51006716}
confusion matrix:
     0   1
0  208   7
1  139  76
early stop counter: 1
val acc:0.6902173757553101, best validation acc: 0.8524844646453857, corresponding to test acc:                         0.8465116024017334 / 0.8720930218696594
after epoch: 9,now: 2024-07-27 03:25:48.261986,epoch time: 0:02:19.543287,used: 0:21:08.149569,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_03_04_39_seed_0_23090497
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.97298175, 'precision': 0.9737935, 'recall': 0.972744, 'specificity': 0.972744, 'f1': 0.9729559, 'auroc': 0.9985438, 'binary_precision': 0.9571695, 'binary_recall': 0.99100256, 'binary_specificity': 0.9544855, 'binary_f1_score': 0.9737922}
confusion matrix:
      0     1
0  1447    69
1    14  1542
---- Validation: 
scalar performance:
{'acc': 0.77251554, 'precision': 0.77766836, 'recall': 0.77343696, 'specificity': 0.77343696, 'f1': 0.7718222, 'auroc': 0.8493109, 'binary_precision': 0.7361878, 'binary_recall': 0.8393701, 'binary_specificity': 0.70750386, 'binary_f1_score': 0.7844003}
confusion matrix:
     0    1
0  462  191
1  102  533
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8023256, 'precision': 0.81373477, 'recall': 0.8023256, 'specificity': 0.8023256, 'f1': 0.80051196, 'auroc': 0.89010274, 'binary_precision': 0.75390625, 'binary_recall': 0.89767444, 'binary_specificity': 0.7069768, 'binary_f1_score': 0.8195329}
confusion matrix:
     0    1
0  152   63
1   22  193
early stop counter: 2
val acc:0.7725155353546143, best validation acc: 0.8524844646453857, corresponding to test acc:                         0.8465116024017334 / 0.8720930218696594
after epoch: 10,now: 2024-07-27 03:28:08.311866,epoch time: 0:02:20.049880,used: 0:23:28.199449,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_03_04_39_seed_0_23090497
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9840495, 'precision': 0.98408926, 'recall': 0.98416126, 'specificity': 0.98416126, 'f1': 0.9840492, 'auroc': 0.9987664, 'binary_precision': 0.9928058, 'binary_recall': 0.9755784, 'binary_specificity': 0.9927441, 'binary_f1_score': 0.98411673}
confusion matrix:
      0     1
0  1505    11
1    38  1518
---- Validation: 
scalar performance:
{'acc': 0.75, 'precision': 0.75261235, 'recall': 0.7492349, 'specificity': 0.7492349, 'f1': 0.7489321, 'auroc': 0.82949686, 'binary_precision': 0.77504396, 'binary_recall': 0.69448817, 'binary_specificity': 0.8039816, 'binary_f1_score': 0.73255813}
confusion matrix:
     0    1
0  525  128
1  194  441
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7860465, 'precision': 0.7985504, 'recall': 0.7860465, 'specificity': 0.7860465, 'f1': 0.7837826, 'auroc': 0.8854948, 'binary_precision': 0.73745173, 'binary_recall': 0.88837206, 'binary_specificity': 0.68372095, 'binary_f1_score': 0.8059072}
confusion matrix:
     0    1
0  147   68
1   24  191
early stop counter: 3
val acc:0.75, best validation acc: 0.8524844646453857, corresponding to test acc:                         0.8465116024017334 / 0.8720930218696594
after epoch: 11,now: 2024-07-27 03:30:28.134508,epoch time: 0:02:19.822642,used: 0:25:48.022091,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_03_04_39_seed_0_23090497
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9798177, 'precision': 0.9803009, 'recall': 0.980081, 'specificity': 0.980081, 'f1': 0.97981703, 'auroc': 0.999501, 'binary_precision': 0.999332, 'binary_recall': 0.9608221, 'binary_specificity': 0.99933994, 'binary_f1_score': 0.9796988}
confusion matrix:
      0     1
0  1514     1
1    61  1496
---- Validation: 
scalar performance:
{'acc': 0.6995342, 'precision': 0.7727422, 'recall': 0.69586164, 'specificity': 0.69586164, 'f1': 0.67543006, 'auroc': 0.8748544, 'binary_precision': 0.910596, 'binary_recall': 0.43307087, 'binary_specificity': 0.9586524, 'binary_f1_score': 0.58697975}
confusion matrix:
     0    1
0  626   27
1  360  275
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8, 'precision': 0.8186393, 'recall': 0.79999995, 'specificity': 0.79999995, 'f1': 0.79703176, 'auroc': 0.89395344, 'binary_precision': 0.8957055, 'binary_recall': 0.67906976, 'binary_specificity': 0.9209302, 'binary_f1_score': 0.77248675}
confusion matrix:
     0    1
0  198   17
1   69  146
early stop counter: 4
val acc:0.6995341777801514, best validation acc: 0.8524844646453857, corresponding to test acc:                         0.8465116024017334 / 0.8720930218696594
after epoch: 12,now: 2024-07-27 03:32:48.110760,epoch time: 0:02:19.976252,used: 0:28:07.998343,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_03_04_39_seed_0_23090497
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9902344, 'precision': 0.9902073, 'recall': 0.9903004, 'specificity': 0.9903004, 'f1': 0.9902333, 'auroc': 0.99909484, 'binary_precision': 0.994822, 'binary_recall': 0.98588836, 'binary_specificity': 0.9947125, 'binary_f1_score': 0.99033505}
confusion matrix:
      0     1
0  1505     8
1    22  1537
---- Validation: 
scalar performance:
{'acc': 0.8167702, 'precision': 0.81692487, 'recall': 0.81658244, 'specificity': 0.81658244, 'f1': 0.816657, 'auroc': 0.88329816, 'binary_precision': 0.82125604, 'binary_recall': 0.8031496, 'binary_specificity': 0.8300153, 'binary_f1_score': 0.8121019}
confusion matrix:
     0    1
0  542  111
1  125  510
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8116279, 'precision': 0.8131522, 'recall': 0.81162786, 'specificity': 0.81162786, 'f1': 0.8113984, 'auroc': 0.9094863, 'binary_precision': 0.79130435, 'binary_recall': 0.8465116, 'binary_specificity': 0.7767442, 'binary_f1_score': 0.81797755}
confusion matrix:
     0    1
0  167   48
1   33  182
early stop counter: 5
val acc:0.8167701959609985, best validation acc: 0.8524844646453857, corresponding to test acc:                         0.8465116024017334 / 0.8720930218696594
after epoch: 13,now: 2024-07-27 03:35:08.145734,epoch time: 0:02:20.034974,used: 0:30:28.033317,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_03_04_39_seed_0_23090497
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 13 with time: 0:30:28.033317 at 2024-07-27 03:35:08.145734
persisted model performance metric: 

scalar performance:
{'acc': 0.8465116, 'precision': 0.8533921, 'recall': 0.8465116, 'specificity': 0.8465116, 'f1': 0.8457608, 'auroc': 0.9136614, 'binary_precision': 0.9027027, 'binary_recall': 0.7767442, 'binary_specificity': 0.9162791, 'binary_f1_score': 0.835}
confusion matrix:
     0    1
0  197   18
1   48  167
oracle model performance metric: 

scalar performance:
{'acc': 0.872093, 'precision': 0.88344926, 'recall': 0.872093, 'specificity': 0.872093, 'f1': 0.87113893, 'auroc': 0.93540287, 'binary_precision': 0.9494382, 'binary_recall': 0.7860465, 'binary_specificity': 0.95813954, 'binary_f1_score': 0.8600509}
confusion matrix:
     0    1
0  206    9
1   46  169
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_diva_irm_3seeds_nofreeze_2024-07-27_01-18-02/rule_results/2.csv
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_diva_irm_3seeds_nofreeze_2024-07-27_01-18-02/rule_results/2.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_diva_irm_3seeds_nofreeze_2024-07-27_01-18-02/confusion_matrix/2.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   2389 MiB |   8830 MiB |  80844 GiB |  80842 GiB |
|       from large pool |   2297 MiB |   8754 MiB |  80082 GiB |  80080 GiB |
|       from small pool |     91 MiB |    129 MiB |    761 GiB |    761 GiB |
|---------------------------------------------------------------------------|
| Active memory         |   2389 MiB |   8830 MiB |  80844 GiB |  80842 GiB |
|       from large pool |   2297 MiB |   8754 MiB |  80082 GiB |  80080 GiB |
|       from small pool |     91 MiB |    129 MiB |    761 GiB |    761 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |   2375 MiB |   8821 MiB |  80742 GiB |  80740 GiB |
|       from large pool |   2284 MiB |   8745 MiB |  79982 GiB |  79980 GiB |
|       from small pool |     91 MiB |    128 MiB |    760 GiB |    760 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   9370 MiB |   9370 MiB |   9370 MiB |      0 B   |
|       from large pool |   9234 MiB |   9234 MiB |   9234 MiB |      0 B   |
|       from small pool |    136 MiB |    136 MiB |    136 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |   1198 MiB |   2052 MiB |  69353 GiB |  69352 GiB |
|       from large pool |   1186 MiB |   2046 MiB |  68566 GiB |  68565 GiB |
|       from small pool |     12 MiB |     22 MiB |    786 GiB |    786 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    2464    |    3317    |   12341 K  |   12338 K  |
|       from large pool |     392    |     816    |    6172 K  |    6171 K  |
|       from small pool |    2072    |    2768    |    6169 K  |    6167 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    2464    |    3317    |   12341 K  |   12338 K  |
|       from large pool |     392    |     816    |    6172 K  |    6171 K  |
|       from small pool |    2072    |    2768    |    6169 K  |    6167 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     269    |     269    |     269    |       0    |
|       from large pool |     201    |     201    |     201    |       0    |
|       from small pool |      68    |      68    |      68    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     154    |     309    |    6423 K  |    6423 K  |
|       from large pool |      84    |     190    |    3299 K  |    3299 K  |
|       from small pool |      70    |     225    |    3123 K  |    3123 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   8830 MiB |  80844 GiB |  80844 GiB |
|       from large pool |  16640 KiB |   8754 MiB |  80082 GiB |  80082 GiB |
|       from small pool |      0 KiB |    129 MiB |    761 GiB |    761 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   8830 MiB |  80844 GiB |  80844 GiB |
|       from large pool |  16640 KiB |   8754 MiB |  80082 GiB |  80082 GiB |
|       from small pool |      0 KiB |    129 MiB |    761 GiB |    761 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   8821 MiB |  80742 GiB |  80742 GiB |
|       from large pool |  16640 KiB |   8745 MiB |  79982 GiB |  79982 GiB |
|       from small pool |      0 KiB |    128 MiB |    760 GiB |    760 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   3588 MiB |   9370 MiB |   9370 MiB |   5782 MiB |
|       from large pool |   3484 MiB |   9234 MiB |   9234 MiB |   5750 MiB |
|       from small pool |    104 MiB |    136 MiB |    136 MiB |     32 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   2052 MiB |  69354 GiB |  69354 GiB |
|       from large pool |  24320 KiB |   2046 MiB |  68567 GiB |  68567 GiB |
|       from small pool |      0 KiB |     52 MiB |    786 GiB |    786 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3317    |   12341 K  |   12341 K  |
|       from large pool |       2    |     816    |    6172 K  |    6172 K  |
|       from small pool |       0    |    2768    |    6169 K  |    6169 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3317    |   12341 K  |   12341 K  |
|       from large pool |       2    |     816    |    6172 K  |    6172 K  |
|       from small pool |       0    |    2768    |    6169 K  |    6169 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     135    |     269    |     269    |     134    |
|       from large pool |      83    |     201    |     201    |     118    |
|       from small pool |      52    |      68    |      68    |      16    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     309    |    6423 K  |    6423 K  |
|       from large pool |       3    |     190    |    3299 K  |    3299 K  |
|       from small pool |       0    |     225    |    3123 K  |    3123 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   8830 MiB |  80844 GiB |  80844 GiB |
|       from large pool |  16640 KiB |   8754 MiB |  80082 GiB |  80082 GiB |
|       from small pool |      0 KiB |    129 MiB |    761 GiB |    761 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   8830 MiB |  80844 GiB |  80844 GiB |
|       from large pool |  16640 KiB |   8754 MiB |  80082 GiB |  80082 GiB |
|       from small pool |      0 KiB |    129 MiB |    761 GiB |    761 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   8821 MiB |  80742 GiB |  80742 GiB |
|       from large pool |  16640 KiB |   8745 MiB |  79982 GiB |  79982 GiB |
|       from small pool |      0 KiB |    128 MiB |    760 GiB |    760 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   3588 MiB |   9370 MiB |   9370 MiB |   5782 MiB |
|       from large pool |   3484 MiB |   9234 MiB |   9234 MiB |   5750 MiB |
|       from small pool |    104 MiB |    136 MiB |    136 MiB |     32 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   2052 MiB |  69354 GiB |  69354 GiB |
|       from large pool |  24320 KiB |   2046 MiB |  68567 GiB |  68567 GiB |
|       from small pool |      0 KiB |     52 MiB |    786 GiB |    786 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3317    |   12341 K  |   12341 K  |
|       from large pool |       2    |     816    |    6172 K  |    6172 K  |
|       from small pool |       0    |    2768    |    6169 K  |    6169 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3317    |   12341 K  |   12341 K  |
|       from large pool |       2    |     816    |    6172 K  |    6172 K  |
|       from small pool |       0    |    2768    |    6169 K  |    6169 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     135    |     269    |     269    |     134    |
|       from large pool |      83    |     201    |     201    |     118    |
|       from small pool |      52    |      68    |      68    |      16    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     309    |    6423 K  |    6423 K  |
|       from large pool |       3    |     190    |    3299 K  |    3299 K  |
|       from small pool |       0    |     225    |    3123 K  |    3123 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main

using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_03_35_46_seed_1_23090497

 Experiment start at: 2024-07-27 03:35:46.913850
hyper-parameter scheduler not set,going to use default Warmpup and epoch update
before training, model accuracy: 0.6533333659172058
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9557292, 'precision': 0.95602655, 'recall': 0.9555935, 'specificity': 0.9555935, 'f1': 0.9557061, 'auroc': 0.9918268, 'binary_precision': 0.94706994, 'binary_recall': 0.96655947, 'binary_specificity': 0.9446276, 'binary_f1_score': 0.95671546}
confusion matrix:
      0     1
0  1433    84
1    52  1503
---- Validation: 
scalar performance:
{'acc': 0.8040593, 'precision': 0.8180858, 'recall': 0.8057604, 'specificity': 0.8057604, 'f1': 0.80243933, 'auroc': 0.9105966, 'binary_precision': 0.7470665, 'binary_recall': 0.9095238, 'binary_specificity': 0.7019969, 'binary_f1_score': 0.8203293}
confusion matrix:
     0    1
0  457  194
1   57  573
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.80222225, 'precision': 0.81726944, 'recall': 0.80222225, 'specificity': 0.80222225, 'f1': 0.7998491, 'auroc': 0.9287112, 'binary_precision': 0.7481752, 'binary_recall': 0.9111111, 'binary_specificity': 0.6933333, 'binary_f1_score': 0.8216433}
confusion matrix:
     0    1
0  156   69
1   20  205
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-27 03:38:11.272548,epoch time: 0:02:24.358698,used: 0:02:24.358698,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_03_35_46_seed_1_23090497
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9010417, 'precision': 0.9163916, 'recall': 0.902439, 'specificity': 0.902439, 'f1': 0.9003277, 'auroc': 0.99596405, 'binary_precision': 1.0, 'binary_recall': 0.80487806, 'binary_specificity': 1.0, 'binary_f1_score': 0.8918919}
confusion matrix:
      0     1
0  1514     0
1   304  1254
---- Validation: 
scalar performance:
{'acc': 0.6690086, 'precision': 0.77252656, 'recall': 0.66387606, 'specificity': 0.66387606, 'f1': 0.63019633, 'auroc': 0.9136128, 'binary_precision': 0.9364407, 'binary_recall': 0.35079366, 'binary_specificity': 0.9769585, 'binary_f1_score': 0.51039267}
confusion matrix:
     0    1
0  636   15
1  409  221
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.53333336, 'precision': 0.7586207, 'recall': 0.53333336, 'specificity': 0.53333336, 'f1': 0.4034091, 'auroc': 0.9172741, 'binary_precision': 1.0, 'binary_recall': 0.06666667, 'binary_specificity': 1.0, 'binary_f1_score': 0.125}
confusion matrix:
     0   1
0  225   0
1  210  15
early stop counter: 1
val acc:0.6690086126327515, best validation acc: 0.8040593266487122, corresponding to test acc:                         0.8022222518920898 / 0.8022222518920898
after epoch: 2,now: 2024-07-27 03:40:31.386671,epoch time: 0:02:20.114123,used: 0:04:44.472821,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_03_35_46_seed_1_23090497
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9667969, 'precision': 0.96788746, 'recall': 0.96652603, 'specificity': 0.96652603, 'f1': 0.96675885, 'auroc': 0.9977096, 'binary_precision': 0.94818014, 'binary_recall': 0.9884244, 'binary_specificity': 0.9446276, 'binary_f1_score': 0.9678842}
confusion matrix:
      0     1
0  1433    84
1    18  1537
---- Validation: 
scalar performance:
{'acc': 0.76112413, 'precision': 0.8115995, 'recall': 0.7643881, 'specificity': 0.7643881, 'f1': 0.7525091, 'auroc': 0.92544067, 'binary_precision': 0.68202245, 'binary_recall': 0.96349204, 'binary_specificity': 0.5652842, 'binary_f1_score': 0.7986842}
confusion matrix:
     0    1
0  368  283
1   23  607
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.74222225, 'precision': 0.78366375, 'recall': 0.7422222, 'specificity': 0.7422222, 'f1': 0.73245037, 'auroc': 0.92217284, 'binary_precision': 0.6752412, 'binary_recall': 0.93333334, 'binary_specificity': 0.5511111, 'binary_f1_score': 0.78358215}
confusion matrix:
     0    1
0  124  101
1   15  210
early stop counter: 2
val acc:0.7611241340637207, best validation acc: 0.8040593266487122, corresponding to test acc:                         0.8022222518920898 / 0.8022222518920898
after epoch: 3,now: 2024-07-27 03:42:51.894427,epoch time: 0:02:20.507756,used: 0:07:04.980577,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_03_35_46_seed_1_23090497
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.95996094, 'precision': 0.9623232, 'recall': 0.9604341, 'specificity': 0.9604341, 'f1': 0.95993304, 'auroc': 0.99820924, 'binary_precision': 0.9986072, 'binary_recall': 0.9221865, 'binary_specificity': 0.9986816, 'binary_f1_score': 0.95887655}
confusion matrix:
      0     1
0  1515     2
1   121  1434
---- Validation: 
scalar performance:
{'acc': 0.78844655, 'precision': 0.823648, 'recall': 0.78571427, 'specificity': 0.78571427, 'f1': 0.7813995, 'auroc': 0.89242196, 'binary_precision': 0.9263658, 'binary_recall': 0.61904764, 'binary_specificity': 0.95238096, 'binary_f1_score': 0.74215037}
confusion matrix:
     0    1
0  620   31
1  240  390
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8377778, 'precision': 0.8545952, 'recall': 0.83777773, 'specificity': 0.83777773, 'f1': 0.8358313, 'auroc': 0.8974024, 'binary_precision': 0.9318182, 'binary_recall': 0.72888887, 'binary_specificity': 0.94666666, 'binary_f1_score': 0.81795514}
confusion matrix:
     0    1
0  213   12
1   61  164
new oracle model saved
early stop counter: 3
val acc:0.7884465456008911, best validation acc: 0.8040593266487122, corresponding to test acc:                         0.8022222518920898 / 0.8377777934074402
after epoch: 4,now: 2024-07-27 03:45:12.573458,epoch time: 0:02:20.679031,used: 0:09:25.659608,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_03_35_46_seed_1_23090497
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.953125, 'precision': 0.95695555, 'recall': 0.95255744, 'specificity': 0.95255744, 'f1': 0.9529776, 'auroc': 0.99789345, 'binary_precision': 0.91824645, 'binary_recall': 0.99614394, 'binary_specificity': 0.90897095, 'binary_f1_score': 0.9556104}
confusion matrix:
      0     1
0  1378   138
1     6  1550
---- Validation: 
scalar performance:
{'acc': 0.77907884, 'precision': 0.79694116, 'recall': 0.7810548, 'specificity': 0.7810548, 'f1': 0.77648485, 'auroc': 0.8936045, 'binary_precision': 0.7198986, 'binary_recall': 0.9015873, 'binary_specificity': 0.6605223, 'binary_f1_score': 0.80056375}
confusion matrix:
     0    1
0  430  221
1   62  568
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.75555557, 'precision': 0.80423284, 'recall': 0.75555557, 'specificity': 0.75555557, 'f1': 0.7453704, 'auroc': 0.93722475, 'binary_precision': 0.6825397, 'binary_recall': 0.95555556, 'binary_specificity': 0.5555556, 'binary_f1_score': 0.79629636}
confusion matrix:
     0    1
0  125  100
1   10  215
early stop counter: 4
val acc:0.7790788412094116, best validation acc: 0.8040593266487122, corresponding to test acc:                         0.8022222518920898 / 0.8377777934074402
after epoch: 5,now: 2024-07-27 03:47:33.311767,epoch time: 0:02:20.738309,used: 0:11:46.397917,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_03_35_46_seed_1_23090497
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.94173175, 'precision': 0.9471977, 'recall': 0.9424807, 'specificity': 0.9424807, 'f1': 0.94161224, 'auroc': 0.99759674, 'binary_precision': 1.0, 'binary_recall': 0.8849614, 'binary_specificity': 1.0, 'binary_f1_score': 0.9389704}
confusion matrix:
      0     1
0  1516     0
1   179  1377
---- Validation: 
scalar performance:
{'acc': 0.59016395, 'precision': 0.7552763, 'recall': 0.58346134, 'specificity': 0.58346134, 'f1': 0.5031821, 'auroc': 0.91524637, 'binary_precision': 0.95652175, 'binary_recall': 0.17460318, 'binary_specificity': 0.9923195, 'binary_f1_score': 0.295302}
confusion matrix:
     0    1
0  646    5
1  520  110
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5, 'precision': 0.25, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.33333334, 'auroc': 0.9237926, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
     0  1
0  225  0
1  225  0
early stop counter: 5
val acc:0.5901639461517334, best validation acc: 0.8040593266487122, corresponding to test acc:                         0.8022222518920898 / 0.8377777934074402
after epoch: 6,now: 2024-07-27 03:49:53.214476,epoch time: 0:02:19.902709,used: 0:14:06.300626,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_03_35_46_seed_1_23090497
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 6 with time: 0:14:06.300626 at 2024-07-27 03:49:53.214476
persisted model performance metric: 

scalar performance:
{'acc': 0.80222225, 'precision': 0.81726944, 'recall': 0.80222225, 'specificity': 0.80222225, 'f1': 0.7998491, 'auroc': 0.9287112, 'binary_precision': 0.7481752, 'binary_recall': 0.9111111, 'binary_specificity': 0.6933333, 'binary_f1_score': 0.8216433}
confusion matrix:
     0    1
0  156   69
1   20  205
oracle model performance metric: 

scalar performance:
{'acc': 0.8377778, 'precision': 0.8545952, 'recall': 0.83777773, 'specificity': 0.83777773, 'f1': 0.8358313, 'auroc': 0.8974024, 'binary_precision': 0.9318182, 'binary_recall': 0.72888887, 'binary_specificity': 0.94666666, 'binary_f1_score': 0.81795514}
confusion matrix:
     0    1
0  213   12
1   61  164
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_diva_irm_3seeds_nofreeze_2024-07-27_01-18-02/rule_results/2.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_diva_irm_3seeds_nofreeze_2024-07-27_01-18-02/confusion_matrix/2.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   2393 MiB |   8831 MiB | 118290 GiB | 118288 GiB |
|       from large pool |   2301 MiB |   8755 MiB | 117173 GiB | 117170 GiB |
|       from small pool |     91 MiB |    132 MiB |   1117 GiB |   1117 GiB |
|---------------------------------------------------------------------------|
| Active memory         |   2393 MiB |   8831 MiB | 118290 GiB | 118288 GiB |
|       from large pool |   2301 MiB |   8755 MiB | 117173 GiB | 117170 GiB |
|       from small pool |     91 MiB |    132 MiB |   1117 GiB |   1117 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |   2375 MiB |   8821 MiB | 118141 GiB | 118139 GiB |
|       from large pool |   2284 MiB |   8745 MiB | 117025 GiB | 117023 GiB |
|       from small pool |     91 MiB |    132 MiB |   1116 GiB |   1116 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   9338 MiB |   9370 MiB |  15120 MiB |   5782 MiB |
|       from large pool |   9198 MiB |   9234 MiB |  14948 MiB |   5750 MiB |
|       from small pool |    140 MiB |    140 MiB |    172 MiB |     32 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |   1398 MiB |   2520 MiB | 104101 GiB | 104100 GiB |
|       from large pool |   1386 MiB |   2515 MiB | 102947 GiB | 102946 GiB |
|       from small pool |     12 MiB |     52 MiB |   1153 GiB |   1153 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    2476    |    3329    |   18074 K  |   18072 K  |
|       from large pool |     392    |     816    |    9033 K  |    9032 K  |
|       from small pool |    2084    |    2780    |    9041 K  |    9039 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    2476    |    3329    |   18074 K  |   18072 K  |
|       from large pool |     392    |     816    |    9033 K  |    9032 K  |
|       from small pool |    2084    |    2780    |    9041 K  |    9039 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     241    |     269    |     375    |     134    |
|       from large pool |     171    |     201    |     289    |     118    |
|       from small pool |      70    |      70    |      86    |      16    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     146    |     309    |    9426 K  |    9426 K  |
|       from large pool |      74    |     190    |    4837 K  |    4837 K  |
|       from small pool |      72    |     225    |    4589 K  |    4589 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   8831 MiB | 118290 GiB | 118290 GiB |
|       from large pool |  16640 KiB |   8755 MiB | 117173 GiB | 117173 GiB |
|       from small pool |      0 KiB |    132 MiB |   1117 GiB |   1117 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   8831 MiB | 118290 GiB | 118290 GiB |
|       from large pool |  16640 KiB |   8755 MiB | 117173 GiB | 117173 GiB |
|       from small pool |      0 KiB |    132 MiB |   1117 GiB |   1117 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   8821 MiB | 118141 GiB | 118141 GiB |
|       from large pool |  16640 KiB |   8745 MiB | 117025 GiB | 117025 GiB |
|       from small pool |      0 KiB |    132 MiB |   1116 GiB |   1116 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   3792 MiB |   9370 MiB |  15120 MiB |  11328 MiB |
|       from large pool |   3688 MiB |   9234 MiB |  14948 MiB |  11260 MiB |
|       from small pool |    104 MiB |    140 MiB |    172 MiB |     68 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   2520 MiB | 104102 GiB | 104102 GiB |
|       from large pool |  24320 KiB |   2515 MiB | 102948 GiB | 102948 GiB |
|       from small pool |      0 KiB |     60 MiB |   1153 GiB |   1153 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3329    |   18074 K  |   18074 K  |
|       from large pool |       2    |     816    |    9033 K  |    9033 K  |
|       from small pool |       0    |    2780    |    9041 K  |    9041 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3329    |   18074 K  |   18074 K  |
|       from large pool |       2    |     816    |    9033 K  |    9033 K  |
|       from small pool |       0    |    2780    |    9041 K  |    9041 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     132    |     269    |     375    |     243    |
|       from large pool |      80    |     201    |     289    |     209    |
|       from small pool |      52    |      70    |      86    |      34    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     309    |    9426 K  |    9426 K  |
|       from large pool |       3    |     190    |    4837 K  |    4837 K  |
|       from small pool |       0    |     225    |    4589 K  |    4589 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   8831 MiB | 118290 GiB | 118290 GiB |
|       from large pool |  16640 KiB |   8755 MiB | 117173 GiB | 117173 GiB |
|       from small pool |      0 KiB |    132 MiB |   1117 GiB |   1117 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   8831 MiB | 118290 GiB | 118290 GiB |
|       from large pool |  16640 KiB |   8755 MiB | 117173 GiB | 117173 GiB |
|       from small pool |      0 KiB |    132 MiB |   1117 GiB |   1117 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   8821 MiB | 118141 GiB | 118141 GiB |
|       from large pool |  16640 KiB |   8745 MiB | 117025 GiB | 117025 GiB |
|       from small pool |      0 KiB |    132 MiB |   1116 GiB |   1116 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   3792 MiB |   9370 MiB |  15120 MiB |  11328 MiB |
|       from large pool |   3688 MiB |   9234 MiB |  14948 MiB |  11260 MiB |
|       from small pool |    104 MiB |    140 MiB |    172 MiB |     68 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   2520 MiB | 104102 GiB | 104102 GiB |
|       from large pool |  24320 KiB |   2515 MiB | 102948 GiB | 102948 GiB |
|       from small pool |      0 KiB |     60 MiB |   1153 GiB |   1153 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3329    |   18074 K  |   18074 K  |
|       from large pool |       2    |     816    |    9033 K  |    9033 K  |
|       from small pool |       0    |    2780    |    9041 K  |    9041 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3329    |   18074 K  |   18074 K  |
|       from large pool |       2    |     816    |    9033 K  |    9033 K  |
|       from small pool |       0    |    2780    |    9041 K  |    9041 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     132    |     269    |     375    |     243    |
|       from large pool |      80    |     201    |     289    |     209    |
|       from small pool |      52    |      70    |      86    |      34    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     309    |    9426 K  |    9426 K  |
|       from large pool |       3    |     190    |    4837 K  |    4837 K  |
|       from small pool |       0    |     225    |    4589 K  |    4589 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main

using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_03_50_31_seed_2_23090497

 Experiment start at: 2024-07-27 03:50:32.036735
hyper-parameter scheduler not set,going to use default Warmpup and epoch update
before training, model accuracy: 0.5995370149612427
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9453534, 'precision': 0.94657755, 'recall': 0.9451573, 'specificity': 0.9451573, 'f1': 0.945296, 'auroc': 0.991295, 'binary_precision': 0.9250774, 'binary_recall': 0.97012985, 'binary_specificity': 0.9201847, 'binary_f1_score': 0.94706815}
confusion matrix:
      0     1
0  1395   121
1    46  1494
---- Validation: 
scalar performance:
{'acc': 0.7331768, 'precision': 0.7669761, 'recall': 0.7377583, 'specificity': 0.7377583, 'f1': 0.7268167, 'auroc': 0.8661233, 'binary_precision': 0.66509986, 'binary_recall': 0.90996784, 'binary_specificity': 0.5655488, 'binary_f1_score': 0.7684996}
confusion matrix:
     0    1
0  371  285
1   56  566
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7037037, 'precision': 0.76832294, 'recall': 0.7037037, 'specificity': 0.7037037, 'f1': 0.6847219, 'auroc': 0.9174169, 'binary_precision': 0.636646, 'binary_recall': 0.9490741, 'binary_specificity': 0.45833334, 'binary_f1_score': 0.7620818}
confusion matrix:
    0    1
0  99  117
1  11  205
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-27 03:52:55.948743,epoch time: 0:02:23.912008,used: 0:02:23.912008,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_03_50_31_seed_2_23090497
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.98003924, 'precision': 0.98007596, 'recall': 0.9800149, 'specificity': 0.9800149, 'f1': 0.980037, 'auroc': 0.99769473, 'binary_precision': 0.9774048, 'binary_recall': 0.98311687, 'binary_specificity': 0.9769129, 'binary_f1_score': 0.98025244}
confusion matrix:
      0     1
0  1481    35
1    26  1514
---- Validation: 
scalar performance:
{'acc': 0.7801252, 'precision': 0.82372403, 'recall': 0.77515733, 'specificity': 0.77515733, 'f1': 0.7702466, 'auroc': 0.88813627, 'binary_precision': 0.9360614, 'binary_recall': 0.58842444, 'binary_specificity': 0.9618902, 'binary_f1_score': 0.7226061}
confusion matrix:
     0    1
0  631   25
1  256  366
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8032407, 'precision': 0.8423428, 'recall': 0.8032408, 'specificity': 0.8032408, 'f1': 0.79745716, 'auroc': 0.88479507, 'binary_precision': 0.95804197, 'binary_recall': 0.6342593, 'binary_specificity': 0.9722222, 'binary_f1_score': 0.7632312}
confusion matrix:
     0    1
0  210    6
1   79  137
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-07-27 03:55:17.009363,epoch time: 0:02:21.060620,used: 0:04:44.972628,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_03_50_31_seed_2_23090497
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9777487, 'precision': 0.97821796, 'recall': 0.9778861, 'specificity': 0.9778861, 'f1': 0.97774655, 'auroc': 0.99719286, 'binary_precision': 0.9952894, 'binary_recall': 0.9603896, 'binary_specificity': 0.9953826, 'binary_f1_score': 0.9775281}
confusion matrix:
      0     1
0  1509     7
1    61  1479
---- Validation: 
scalar performance:
{'acc': 0.7910798, 'precision': 0.83481944, 'recall': 0.786203, 'specificity': 0.786203, 'f1': 0.78198695, 'auroc': 0.9015641, 'binary_precision': 0.9493671, 'binary_recall': 0.6028939, 'binary_specificity': 0.9695122, 'binary_f1_score': 0.7374631}
confusion matrix:
     0    1
0  636   20
1  247  375
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8472222, 'precision': 0.8742031, 'recall': 0.8472222, 'specificity': 0.8472222, 'f1': 0.8444178, 'auroc': 0.9250043, 'binary_precision': 0.9746835, 'binary_recall': 0.712963, 'binary_specificity': 0.9814815, 'binary_f1_score': 0.8235294}
confusion matrix:
     0    1
0  212    4
1   62  154
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-07-27 03:57:38.139145,epoch time: 0:02:21.129782,used: 0:07:06.102410,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_03_50_31_seed_2_23090497
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9554974, 'precision': 0.95883775, 'recall': 0.95584416, 'specificity': 0.95584416, 'f1': 0.95543754, 'auroc': 0.99648714, 'binary_precision': 1.0, 'binary_recall': 0.9116883, 'binary_specificity': 1.0, 'binary_f1_score': 0.9538044}
confusion matrix:
      0     1
0  1516     0
1   136  1404
---- Validation: 
scalar performance:
{'acc': 0.6830986, 'precision': 0.7710394, 'recall': 0.6753122, 'specificity': 0.6753122, 'f1': 0.64925206, 'auroc': 0.85825384, 'binary_precision': 0.9189189, 'binary_recall': 0.38263667, 'binary_specificity': 0.9679878, 'binary_f1_score': 0.54029506}
confusion matrix:
     0    1
0  635   21
1  384  238
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7175926, 'precision': 0.7976079, 'recall': 0.7175926, 'specificity': 0.7175926, 'f1': 0.6972426, 'auroc': 0.88573813, 'binary_precision': 0.9519231, 'binary_recall': 0.45833334, 'binary_specificity': 0.9768519, 'binary_f1_score': 0.61875}
confusion matrix:
     0   1
0  211   5
1  117  99
early stop counter: 1
val acc:0.6830986142158508, best validation acc: 0.7910798192024231, corresponding to test acc:                         0.8472222089767456 / 0.8472222089767456
after epoch: 4,now: 2024-07-27 03:59:57.013013,epoch time: 0:02:18.873868,used: 0:09:24.976278,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_03_50_31_seed_2_23090497
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9718586, 'precision': 0.97230977, 'recall': 0.97174895, 'specificity': 0.97174895, 'f1': 0.9718455, 'auroc': 0.99739015, 'binary_precision': 0.9595449, 'binary_recall': 0.98571426, 'binary_specificity': 0.95778364, 'binary_f1_score': 0.9724536}
confusion matrix:
      0     1
0  1452    64
1    22  1518
---- Validation: 
scalar performance:
{'acc': 0.74882627, 'precision': 0.7874825, 'recall': 0.75358546, 'specificity': 0.75358546, 'f1': 0.74232495, 'auroc': 0.8662679, 'binary_precision': 0.67520374, 'binary_recall': 0.93247586, 'binary_specificity': 0.5746951, 'binary_f1_score': 0.78325456}
confusion matrix:
     0    1
0  377  279
1   42  580
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7361111, 'precision': 0.7942308, 'recall': 0.7361111, 'specificity': 0.7361111, 'f1': 0.7224026, 'auroc': 0.84585047, 'binary_precision': 0.66346157, 'binary_recall': 0.9583333, 'binary_specificity': 0.5138889, 'binary_f1_score': 0.78409094}
confusion matrix:
     0    1
0  111  105
1    9  207
early stop counter: 2
val acc:0.748826265335083, best validation acc: 0.7910798192024231, corresponding to test acc:                         0.8472222089767456 / 0.8472222089767456
after epoch: 5,now: 2024-07-27 04:02:15.446202,epoch time: 0:02:18.433189,used: 0:11:43.409467,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_03_50_31_seed_2_23090497
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.98658377, 'precision': 0.98658144, 'recall': 0.98661125, 'specificity': 0.98661125, 'f1': 0.98658353, 'auroc': 0.99881613, 'binary_precision': 0.9901897, 'binary_recall': 0.98311687, 'binary_specificity': 0.99010557, 'binary_f1_score': 0.98664063}
confusion matrix:
      0     1
0  1501    15
1    26  1514
---- Validation: 
scalar performance:
{'acc': 0.7832551, 'precision': 0.8025428, 'recall': 0.7797893, 'specificity': 0.7797893, 'f1': 0.77819663, 'auroc': 0.87089, 'binary_precision': 0.8725702, 'binary_recall': 0.64951766, 'binary_specificity': 0.910061, 'binary_f1_score': 0.7447005}
confusion matrix:
     0    1
0  597   59
1  218  404
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.724537, 'precision': 0.7704531, 'recall': 0.724537, 'specificity': 0.724537, 'f1': 0.7123271, 'auroc': 0.86567646, 'binary_precision': 0.88188976, 'binary_recall': 0.5185185, 'binary_specificity': 0.9305556, 'binary_f1_score': 0.6530612}
confusion matrix:
     0    1
0  201   15
1  104  112
early stop counter: 3
val acc:0.7832551002502441, best validation acc: 0.7910798192024231, corresponding to test acc:                         0.8472222089767456 / 0.8472222089767456
after epoch: 6,now: 2024-07-27 04:04:33.773596,epoch time: 0:02:18.327394,used: 0:14:01.736861,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_03_50_31_seed_2_23090497
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.98625654, 'precision': 0.9863479, 'recall': 0.9862146, 'specificity': 0.9862146, 'f1': 0.9862542, 'auroc': 0.99916434, 'binary_precision': 0.98136246, 'binary_recall': 0.99155843, 'binary_specificity': 0.9808707, 'binary_f1_score': 0.9864341}
confusion matrix:
      0     1
0  1487    29
1    13  1527
---- Validation: 
scalar performance:
{'acc': 0.80829424, 'precision': 0.811309, 'recall': 0.80688775, 'specificity': 0.80688775, 'f1': 0.80722904, 'auroc': 0.8818793, 'binary_precision': 0.8360071, 'binary_recall': 0.7540193, 'binary_specificity': 0.8597561, 'binary_f1_score': 0.7928994}
confusion matrix:
     0    1
0  564   92
1  153  469
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8240741, 'precision': 0.82961285, 'recall': 0.8240741, 'specificity': 0.8240741, 'f1': 0.82333195, 'auroc': 0.8992198, 'binary_precision': 0.87234044, 'binary_recall': 0.7592593, 'binary_specificity': 0.8888889, 'binary_f1_score': 0.81188124}
confusion matrix:
     0    1
0  192   24
1   52  164
better model found
persisted
after epoch: 7,now: 2024-07-27 04:06:53.060174,epoch time: 0:02:19.286578,used: 0:16:21.023439,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_03_50_31_seed_2_23090497
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9718586, 'precision': 0.9727964, 'recall': 0.9720471, 'specificity': 0.9720471, 'f1': 0.9718511, 'auroc': 0.99810433, 'binary_precision': 0.99590725, 'binary_recall': 0.9480519, 'binary_specificity': 0.9960422, 'binary_f1_score': 0.97139055}
confusion matrix:
      0     1
0  1510     6
1    80  1460
---- Validation: 
scalar performance:
{'acc': 0.6666667, 'precision': 0.7696742, 'recall': 0.6582229, 'specificity': 0.6582229, 'f1': 0.6245583, 'auroc': 0.8714464, 'binary_precision': 0.9298246, 'binary_recall': 0.34083602, 'binary_specificity': 0.9756098, 'binary_f1_score': 0.49882352}
confusion matrix:
     0    1
0  640   16
1  410  212
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6898148, 'precision': 0.8029556, 'recall': 0.6898148, 'specificity': 0.6898148, 'f1': 0.6578723, 'auroc': 0.89658356, 'binary_precision': 0.9880952, 'binary_recall': 0.38425925, 'binary_specificity': 0.9953704, 'binary_f1_score': 0.55333334}
confusion matrix:
     0   1
0  215   1
1  133  83
early stop counter: 1
val acc:0.6666666865348816, best validation acc: 0.8082942366600037, corresponding to test acc:                         0.8240740895271301 / 0.8472222089767456
after epoch: 8,now: 2024-07-27 04:09:11.673408,epoch time: 0:02:18.613234,used: 0:18:39.636673,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_03_50_31_seed_2_23090497
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9856021, 'precision': 0.98580956, 'recall': 0.9856989, 'specificity': 0.9856989, 'f1': 0.9856018, 'auroc': 0.99917626, 'binary_precision': 0.99800265, 'binary_recall': 0.97337663, 'binary_specificity': 0.9980211, 'binary_f1_score': 0.9855358}
confusion matrix:
      0     1
0  1513     3
1    41  1499
---- Validation: 
scalar performance:
{'acc': 0.75352114, 'precision': 0.8106243, 'recall': 0.74770117, 'specificity': 0.74770117, 'f1': 0.7386348, 'auroc': 0.8869157, 'binary_precision': 0.93732196, 'binary_recall': 0.5289389, 'binary_specificity': 0.9664634, 'binary_f1_score': 0.676259}
confusion matrix:
     0    1
0  634   22
1  293  329
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7939815, 'precision': 0.8449091, 'recall': 0.7939815, 'specificity': 0.7939815, 'f1': 0.7860851, 'auroc': 0.8844093, 'binary_precision': 0.97744364, 'binary_recall': 0.6018519, 'binary_specificity': 0.9861111, 'binary_f1_score': 0.7449857}
confusion matrix:
     0    1
0  213    3
1   86  130
early stop counter: 2
val acc:0.7535211443901062, best validation acc: 0.8082942366600037, corresponding to test acc:                         0.8240740895271301 / 0.8472222089767456
after epoch: 9,now: 2024-07-27 04:11:30.732015,epoch time: 0:02:19.058607,used: 0:20:58.695280,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_03_50_31_seed_2_23090497
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.989856, 'precision': 0.9898499, 'recall': 0.9898631, 'specificity': 0.9898631, 'f1': 0.9898555, 'auroc': 0.9992988, 'binary_precision': 0.99089134, 'binary_recall': 0.98896104, 'binary_specificity': 0.99076515, 'binary_f1_score': 0.9899252}
confusion matrix:
      0     1
0  1502    14
1    17  1523
---- Validation: 
scalar performance:
{'acc': 0.8317684, 'precision': 0.83767056, 'recall': 0.8299619, 'specificity': 0.8299619, 'f1': 0.830395, 'auroc': 0.8976134, 'binary_precision': 0.87615526, 'binary_recall': 0.7620579, 'binary_specificity': 0.89786583, 'binary_f1_score': 0.8151333}
confusion matrix:
     0    1
0  589   67
1  148  474
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7962963, 'precision': 0.8038242, 'recall': 0.7962963, 'specificity': 0.7962963, 'f1': 0.79502666, 'auroc': 0.88183725, 'binary_precision': 0.85164833, 'binary_recall': 0.7175926, 'binary_specificity': 0.875, 'binary_f1_score': 0.7788945}
confusion matrix:
     0    1
0  189   27
1   61  155
better model found
persisted
after epoch: 10,now: 2024-07-27 04:13:49.741549,epoch time: 0:02:19.009534,used: 0:23:17.704814,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_03_50_31_seed_2_23090497
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9856021, 'precision': 0.9856021, 'recall': 0.98563206, 'specificity': 0.98563206, 'f1': 0.9856019, 'auroc': 0.99935067, 'binary_precision': 0.9895288, 'binary_recall': 0.9818182, 'binary_specificity': 0.9894459, 'binary_f1_score': 0.9856584}
confusion matrix:
      0     1
0  1500    16
1    28  1512
---- Validation: 
scalar performance:
{'acc': 0.7816901, 'precision': 0.8273562, 'recall': 0.77664006, 'specificity': 0.77664006, 'f1': 0.7715697, 'auroc': 0.90849984, 'binary_precision': 0.9431524, 'binary_recall': 0.5868167, 'binary_specificity': 0.9664634, 'binary_f1_score': 0.72348857}
confusion matrix:
     0    1
0  634   22
1  257  365
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5787037, 'precision': 0.7713568, 'recall': 0.5787037, 'specificity': 0.5787037, 'f1': 0.48779154, 'auroc': 0.89356136, 'binary_precision': 1.0, 'binary_recall': 0.1574074, 'binary_specificity': 1.0, 'binary_f1_score': 0.27199998}
confusion matrix:
     0   1
0  216   0
1  182  34
early stop counter: 1
val acc:0.7816901206970215, best validation acc: 0.8317683935165405, corresponding to test acc:                         0.7962962985038757 / 0.8472222089767456
after epoch: 11,now: 2024-07-27 04:16:08.269674,epoch time: 0:02:18.528125,used: 0:25:36.232939,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_03_50_31_seed_2_23090497
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.983966, 'precision': 0.984239, 'recall': 0.9838853, 'specificity': 0.9838853, 'f1': 0.98396075, 'auroc': 0.99952585, 'binary_precision': 0.9745385, 'binary_recall': 0.9941558, 'binary_specificity': 0.97361475, 'binary_f1_score': 0.9842494}
confusion matrix:
      0     1
0  1476    40
1     9  1531
---- Validation: 
scalar performance:
{'acc': 0.82159626, 'precision': 0.8249349, 'recall': 0.8229281, 'specificity': 0.8229281, 'f1': 0.8214546, 'auroc': 0.90232384, 'binary_precision': 0.7846821, 'binary_recall': 0.87299037, 'binary_specificity': 0.77286583, 'binary_f1_score': 0.8264841}
confusion matrix:
     0    1
0  507  149
1   79  543
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7453704, 'precision': 0.78216505, 'recall': 0.7453704, 'specificity': 0.7453704, 'f1': 0.7367896, 'auroc': 0.87545013, 'binary_precision': 0.6802721, 'binary_recall': 0.9259259, 'binary_specificity': 0.5648148, 'binary_f1_score': 0.7843137}
confusion matrix:
     0    1
0  122   94
1   16  200
early stop counter: 2
val acc:0.8215962648391724, best validation acc: 0.8317683935165405, corresponding to test acc:                         0.7962962985038757 / 0.8472222089767456
after epoch: 12,now: 2024-07-27 04:18:26.957933,epoch time: 0:02:18.688259,used: 0:27:54.921198,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_03_50_31_seed_2_23090497
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.976767, 'precision': 0.97728467, 'recall': 0.97664994, 'specificity': 0.97664994, 'f1': 0.97675514, 'auroc': 0.9984931, 'binary_precision': 0.9634069, 'binary_recall': 0.99155843, 'binary_specificity': 0.96174145, 'binary_f1_score': 0.97728}
confusion matrix:
      0     1
0  1458    58
1    13  1527
---- Validation: 
scalar performance:
{'acc': 0.8309859, 'precision': 0.83287215, 'recall': 0.83199114, 'specificity': 0.83199114, 'f1': 0.83094454, 'auroc': 0.90363014, 'binary_precision': 0.8002958, 'binary_recall': 0.86977494, 'binary_specificity': 0.79420733, 'binary_f1_score': 0.8335901}
confusion matrix:
     0    1
0  521  135
1   81  541
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.837963, 'precision': 0.8398276, 'recall': 0.837963, 'specificity': 0.837963, 'f1': 0.8377404, 'auroc': 0.9146733, 'binary_precision': 0.8146552, 'binary_recall': 0.875, 'binary_specificity': 0.8009259, 'binary_f1_score': 0.84375}
confusion matrix:
     0    1
0  173   43
1   27  189
early stop counter: 3
val acc:0.8309859037399292, best validation acc: 0.8317683935165405, corresponding to test acc:                         0.7962962985038757 / 0.8472222089767456
after epoch: 13,now: 2024-07-27 04:20:45.923647,epoch time: 0:02:18.965714,used: 0:30:13.886912,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_03_50_31_seed_2_23090497
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.97022253, 'precision': 0.97168636, 'recall': 0.9704546, 'specificity': 0.9704546, 'f1': 0.97020817, 'auroc': 0.99870205, 'binary_precision': 1.0, 'binary_recall': 0.9409091, 'binary_specificity': 1.0, 'binary_f1_score': 0.969555}
confusion matrix:
      0     1
0  1516     0
1    91  1449
---- Validation: 
scalar performance:
{'acc': 0.53286386, 'precision': 0.74327207, 'recall': 0.52013814, 'specificity': 0.52013814, 'f1': 0.38353303, 'auroc': 0.8681861, 'binary_precision': 0.962963, 'binary_recall': 0.041800644, 'binary_specificity': 0.9984756, 'binary_f1_score': 0.08012327}
confusion matrix:
     0   1
0  655   1
1  596  26
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5023148, 'precision': 0.7505801, 'recall': 0.5023148, 'specificity': 0.5023148, 'f1': 0.3384568, 'auroc': 0.8705418, 'binary_precision': 1.0, 'binary_recall': 0.0046296297, 'binary_specificity': 1.0, 'binary_f1_score': 0.00921659}
confusion matrix:
     0  1
0  216  0
1  215  1
early stop counter: 4
val acc:0.5328638553619385, best validation acc: 0.8317683935165405, corresponding to test acc:                         0.7962962985038757 / 0.8472222089767456
after epoch: 14,now: 2024-07-27 04:23:04.556160,epoch time: 0:02:18.632513,used: 0:32:32.519425,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_03_50_31_seed_2_23090497
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9911649, 'precision': 0.9911745, 'recall': 0.99120295, 'specificity': 0.99120295, 'f1': 0.9911648, 'auroc': 0.9993386, 'binary_precision': 0.99606556, 'binary_recall': 0.98636365, 'binary_specificity': 0.9960422, 'binary_f1_score': 0.99119085}
confusion matrix:
      0     1
0  1510     6
1    21  1519
---- Validation: 
scalar performance:
{'acc': 0.6776213, 'precision': 0.77252316, 'recall': 0.66956025, 'specificity': 0.66956025, 'f1': 0.6406349, 'auroc': 0.8654922, 'binary_precision': 0.9268293, 'binary_recall': 0.36655948, 'binary_specificity': 0.972561, 'binary_f1_score': 0.5253456}
confusion matrix:
     0    1
0  638   18
1  394  228
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6458333, 'precision': 0.78522325, 'recall': 0.6458334, 'specificity': 0.6458334, 'f1': 0.59654015, 'auroc': 0.9105581, 'binary_precision': 0.9846154, 'binary_recall': 0.2962963, 'binary_specificity': 0.9953704, 'binary_f1_score': 0.455516}
confusion matrix:
     0   1
0  215   1
1  152  64
early stop counter: 5
val acc:0.6776213049888611, best validation acc: 0.8317683935165405, corresponding to test acc:                         0.7962962985038757 / 0.8472222089767456
after epoch: 15,now: 2024-07-27 04:25:23.294574,epoch time: 0:02:18.738414,used: 0:34:51.257839,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_03_50_31_seed_2_23090497
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 15 with time: 0:34:51.257839 at 2024-07-27 04:25:23.294574
persisted model performance metric: 

scalar performance:
{'acc': 0.7962963, 'precision': 0.8038242, 'recall': 0.7962963, 'specificity': 0.7962963, 'f1': 0.79502666, 'auroc': 0.88183725, 'binary_precision': 0.85164833, 'binary_recall': 0.7175926, 'binary_specificity': 0.875, 'binary_f1_score': 0.7788945}
confusion matrix:
     0    1
0  189   27
1   61  155
oracle model performance metric: 

scalar performance:
{'acc': 0.8472222, 'precision': 0.8742031, 'recall': 0.8472222, 'specificity': 0.8472222, 'f1': 0.8444178, 'auroc': 0.9250043, 'binary_precision': 0.9746835, 'binary_recall': 0.712963, 'binary_specificity': 0.9814815, 'binary_f1_score': 0.8235294}
confusion matrix:
     0    1
0  212    4
1   62  154
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_diva_irm_3seeds_nofreeze_2024-07-27_01-18-02/rule_results/2.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_diva_irm_3seeds_nofreeze_2024-07-27_01-18-02/confusion_matrix/2.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   2391 MiB |   8832 MiB | 211208 GiB | 211205 GiB |
|       from large pool |   2300 MiB |   8756 MiB | 209217 GiB | 209215 GiB |
|       from small pool |     91 MiB |    132 MiB |   1990 GiB |   1990 GiB |
|---------------------------------------------------------------------------|
| Active memory         |   2391 MiB |   8832 MiB | 211208 GiB | 211205 GiB |
|       from large pool |   2300 MiB |   8756 MiB | 209217 GiB | 209215 GiB |
|       from small pool |     91 MiB |    132 MiB |   1990 GiB |   1990 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |   2375 MiB |   8821 MiB | 210792 GiB | 210789 GiB |
|       from large pool |   2284 MiB |   8745 MiB | 208804 GiB | 208802 GiB |
|       from small pool |     91 MiB |    132 MiB |   1987 GiB |   1987 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   9302 MiB |   9370 MiB |  20630 MiB |  11328 MiB |
|       from large pool |   9166 MiB |   9234 MiB |  20426 MiB |  11260 MiB |
|       from small pool |    136 MiB |    140 MiB |    204 MiB |     68 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |   1850 MiB |   2854 MiB | 192187 GiB | 192185 GiB |
|       from large pool |   1839 MiB |   2848 MiB | 190136 GiB | 190134 GiB |
|       from small pool |     10 MiB |     60 MiB |   2051 GiB |   2051 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    2464    |    3329    |   32228 K  |   32225 K  |
|       from large pool |     392    |     816    |   16113 K  |   16112 K  |
|       from small pool |    2072    |    2780    |   16114 K  |   16112 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    2464    |    3329    |   32228 K  |   32225 K  |
|       from large pool |     392    |     816    |   16113 K  |   16112 K  |
|       from small pool |    2072    |    2780    |   16114 K  |   16112 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     226    |     269    |     469    |     243    |
|       from large pool |     158    |     201    |     367    |     209    |
|       from small pool |      68    |      70    |     102    |      34    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     155    |     311    |   16922 K  |   16922 K  |
|       from large pool |      85    |     190    |    8706 K  |    8706 K  |
|       from small pool |      70    |     226    |    8216 K  |    8215 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   8832 MiB | 211208 GiB | 211208 GiB |
|       from large pool |  16640 KiB |   8756 MiB | 209217 GiB | 209217 GiB |
|       from small pool |      0 KiB |    132 MiB |   1990 GiB |   1990 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   8832 MiB | 211208 GiB | 211208 GiB |
|       from large pool |  16640 KiB |   8756 MiB | 209217 GiB | 209217 GiB |
|       from small pool |      0 KiB |    132 MiB |   1990 GiB |   1990 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   8821 MiB | 210792 GiB | 210792 GiB |
|       from large pool |  16640 KiB |   8745 MiB | 208804 GiB | 208804 GiB |
|       from small pool |      0 KiB |    132 MiB |   1987 GiB |   1987 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   4242 MiB |   9370 MiB |  20630 MiB |  16388 MiB |
|       from large pool |   4140 MiB |   9234 MiB |  20426 MiB |  16286 MiB |
|       from small pool |    102 MiB |    140 MiB |    204 MiB |    102 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   2854 MiB | 192188 GiB | 192188 GiB |
|       from large pool |  24320 KiB |   2848 MiB | 190137 GiB | 190137 GiB |
|       from small pool |      0 KiB |     60 MiB |   2051 GiB |   2051 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3329    |   32228 K  |   32228 K  |
|       from large pool |       2    |     816    |   16113 K  |   16113 K  |
|       from small pool |       0    |    2780    |   16114 K  |   16114 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3329    |   32228 K  |   32228 K  |
|       from large pool |       2    |     816    |   16113 K  |   16113 K  |
|       from small pool |       0    |    2780    |   16114 K  |   16114 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     134    |     269    |     469    |     335    |
|       from large pool |      83    |     201    |     367    |     284    |
|       from small pool |      51    |      70    |     102    |      51    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     311    |   16923 K  |   16923 K  |
|       from large pool |       3    |     190    |    8706 K  |    8706 K  |
|       from small pool |       0    |     226    |    8216 K  |    8216 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Sat Jul 27 04:25:32 2024]
Finished job 0.
1 of 1 steps (100%) done
