Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Sat Jul 27 02:54:29 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_diva_irm_3seeds_nofreeze_2024-07-27_01-18-02/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_diva_irm_3seeds_nofreeze_2024-07-27_01-18-02/rule_results/17.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=17
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/swiglu_ffn.py:51: UserWarning: xFormers is not available (SwiGLU)
  warnings.warn("xFormers is not available (SwiGLU)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/attention.py:33: UserWarning: xFormers is not available (Attention)
  warnings.warn("xFormers is not available (Attention)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/block.py:40: UserWarning: xFormers is not available (Block)
  warnings.warn("xFormers is not available (Block)")
Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main

using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_02_55_37_seed_0_23090496

 Experiment start at: 2024-07-27 02:55:38.174553
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
before training, model accuracy: 0.6069767475128174
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9586589, 'precision': 0.95876616, 'recall': 0.9588002, 'specificity': 0.9588002, 'f1': 0.9586587, 'auroc': 0.9925991, 'binary_precision': 0.9697567, 'binary_recall': 0.94794345, 'binary_specificity': 0.969657, 'binary_f1_score': 0.958726}
confusion matrix:
      0     1
0  1470    46
1    81  1475
---- Validation: 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
scalar performance:
{'acc': 0.8097826, 'precision': 0.81256616, 'recall': 0.81042916, 'specificity': 0.81042916, 'f1': 0.80955017, 'auroc': 0.8896167, 'binary_precision': 0.77936965, 'binary_recall': 0.8566929, 'binary_specificity': 0.7641654, 'binary_f1_score': 0.816204}
confusion matrix:
     0    1
0  499  154
1   91  544
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.80930233, 'precision': 0.8138927, 'recall': 0.80930233, 'specificity': 0.80930233, 'f1': 0.8086026, 'auroc': 0.90438074, 'binary_precision': 0.7759336, 'binary_recall': 0.8697674, 'binary_specificity': 0.74883723, 'binary_f1_score': 0.82017547}
confusion matrix:
     0    1
0  161   54
1   28  187
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-27 02:57:08.788120,epoch time: 0:01:30.613567,used: 0:01:30.613567,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_02_55_37_seed_0_23090496
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9583333, 'precision': 0.96045625, 'recall': 0.95880955, 'specificity': 0.95880955, 'f1': 0.9583092, 'auroc': 0.9947857, 'binary_precision': 0.9951456, 'binary_recall': 0.9222365, 'binary_specificity': 0.9953826, 'binary_f1_score': 0.95730484}
confusion matrix:
      0     1
0  1509     7
1   121  1435
---- Validation: 
scalar performance:
{'acc': 0.8206522, 'precision': 0.832803, 'recall': 0.819304, 'specificity': 0.819304, 'f1': 0.8185388, 'auroc': 0.9002447, 'binary_precision': 0.89299613, 'binary_recall': 0.72283465, 'binary_specificity': 0.91577333, 'binary_f1_score': 0.7989556}
confusion matrix:
     0    1
0  598   55
1  176  459
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8116279, 'precision': 0.8140808, 'recall': 0.8116279, 'specificity': 0.8116279, 'f1': 0.8112594, 'auroc': 0.9006598, 'binary_precision': 0.84183675, 'binary_recall': 0.76744187, 'binary_specificity': 0.855814, 'binary_f1_score': 0.8029197}
confusion matrix:
     0    1
0  184   31
1   50  165
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-07-27 02:58:32.530150,epoch time: 0:01:23.742030,used: 0:02:54.355597,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_02_55_37_seed_0_23090496
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.94401044, 'precision': 0.9489275, 'recall': 0.9447216, 'specificity': 0.9447216, 'f1': 0.94390994, 'auroc': 0.9960799, 'binary_precision': 0.9992785, 'binary_recall': 0.8901028, 'binary_specificity': 0.99934036, 'binary_f1_score': 0.9415363}
confusion matrix:
      0     1
0  1515     1
1   171  1385
---- Validation: 
scalar performance:
{'acc': 0.7756211, 'precision': 0.780579, 'recall': 0.77465487, 'specificity': 0.77465487, 'f1': 0.774177, 'auroc': 0.86437464, 'binary_precision': 0.81454545, 'binary_recall': 0.7055118, 'binary_specificity': 0.84379786, 'binary_f1_score': 0.7561182}
confusion matrix:
     0    1
0  551  102
1  187  448
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8, 'precision': 0.80595696, 'recall': 0.79999995, 'specificity': 0.79999995, 'f1': 0.7990217, 'auroc': 0.8875717, 'binary_precision': 0.7632653, 'binary_recall': 0.8697674, 'binary_specificity': 0.73023254, 'binary_f1_score': 0.8130434}
confusion matrix:
     0    1
0  157   58
1   28  187
early stop counter: 1
val acc:0.7756211161613464, best validation acc: 0.820652186870575, corresponding to test acc:                         0.8116279244422913 / 0.8116279244422913
after epoch: 3,now: 2024-07-27 02:59:53.996603,epoch time: 0:01:21.466453,used: 0:04:15.822050,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_02_55_37_seed_0_23090496
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9707031, 'precision': 0.9708843, 'recall': 0.9705945, 'specificity': 0.9705945, 'f1': 0.97068954, 'auroc': 0.996639, 'binary_precision': 0.96455693, 'binary_recall': 0.97817713, 'binary_specificity': 0.96301186, 'binary_f1_score': 0.9713193}
confusion matrix:
      0     1
0  1458    56
1    34  1524
---- Validation: 
scalar performance:
{'acc': 0.8167702, 'precision': 0.822755, 'recall': 0.8177111, 'specificity': 0.8177111, 'f1': 0.8161958, 'auroc': 0.89847946, 'binary_precision': 0.7751724, 'binary_recall': 0.8850394, 'binary_specificity': 0.75038284, 'binary_f1_score': 0.82647055}
confusion matrix:
     0    1
0  490  163
1   73  562
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.81395346, 'precision': 0.81861293, 'recall': 0.8139535, 'specificity': 0.8139535, 'f1': 0.8132708, 'auroc': 0.91132504, 'binary_precision': 0.780083, 'binary_recall': 0.8744186, 'binary_specificity': 0.75348836, 'binary_f1_score': 0.82456136}
confusion matrix:
     0    1
0  162   53
1   27  188
new oracle model saved
early stop counter: 2
val acc:0.8167701959609985, best validation acc: 0.820652186870575, corresponding to test acc:                         0.8116279244422913 / 0.8139534592628479
after epoch: 4,now: 2024-07-27 03:01:16.498035,epoch time: 0:01:22.501432,used: 0:05:38.323482,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_02_55_37_seed_0_23090496
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.95247394, 'precision': 0.9560241, 'recall': 0.953145, 'specificity': 0.953145, 'f1': 0.95242155, 'auroc': 0.99751794, 'binary_precision': 1.0, 'binary_recall': 0.9062901, 'binary_specificity': 1.0, 'binary_f1_score': 0.9508418}
confusion matrix:
      0     1
0  1514     0
1   146  1412
---- Validation: 
scalar performance:
{'acc': 0.55590063, 'precision': 0.73847026, 'recall': 0.5496931, 'specificity': 0.5496931, 'f1': 0.44195965, 'auroc': 0.8686161, 'binary_precision': 0.943662, 'binary_recall': 0.105511814, 'binary_specificity': 0.99387443, 'binary_f1_score': 0.1898017}
confusion matrix:
     0   1
0  649   4
1  568  67
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.68139535, 'precision': 0.80539775, 'recall': 0.68139535, 'specificity': 0.68139535, 'f1': 0.6454003, 'auroc': 0.8978745, 'binary_precision': 1.0, 'binary_recall': 0.3627907, 'binary_specificity': 1.0, 'binary_f1_score': 0.5324232}
confusion matrix:
     0   1
0  215   0
1  137  78
early stop counter: 3
val acc:0.5559006333351135, best validation acc: 0.820652186870575, corresponding to test acc:                         0.8116279244422913 / 0.8139534592628479
after epoch: 5,now: 2024-07-27 03:02:38.086829,epoch time: 0:01:21.588794,used: 0:06:59.912276,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_02_55_37_seed_0_23090496
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.97753906, 'precision': 0.97795045, 'recall': 0.97780025, 'specificity': 0.97780025, 'f1': 0.97753865, 'auroc': 0.9978917, 'binary_precision': 0.9960027, 'binary_recall': 0.95956355, 'binary_specificity': 0.996037, 'binary_f1_score': 0.97744364}
confusion matrix:
      0     1
0  1508     6
1    63  1495
---- Validation: 
scalar performance:
{'acc': 0.8035714, 'precision': 0.80789834, 'recall': 0.8027191, 'specificity': 0.8027191, 'f1': 0.802542, 'auroc': 0.88337535, 'binary_precision': 0.8410714, 'binary_recall': 0.7417323, 'binary_specificity': 0.863706, 'binary_f1_score': 0.78828454}
confusion matrix:
     0    1
0  564   89
1  164  471
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7953488, 'precision': 0.7974336, 'recall': 0.7953488, 'specificity': 0.7953488, 'f1': 0.7949896, 'auroc': 0.87201726, 'binary_precision': 0.77253217, 'binary_recall': 0.8372093, 'binary_specificity': 0.75348836, 'binary_f1_score': 0.80357134}
confusion matrix:
     0    1
0  162   53
1   35  180
early stop counter: 4
val acc:0.8035714030265808, best validation acc: 0.820652186870575, corresponding to test acc:                         0.8116279244422913 / 0.8139534592628479
after epoch: 6,now: 2024-07-27 03:03:59.565623,epoch time: 0:01:21.478794,used: 0:08:21.391070,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_02_55_37_seed_0_23090496
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9641927, 'precision': 0.9648155, 'recall': 0.9639832, 'specificity': 0.9639832, 'f1': 0.9641633, 'auroc': 0.9959197, 'binary_precision': 0.95074815, 'binary_recall': 0.98007715, 'binary_specificity': 0.9478892, 'binary_f1_score': 0.9651899}
confusion matrix:
      0     1
0  1437    79
1    31  1525
---- Validation: 
scalar performance:
{'acc': 0.85714287, 'precision': 0.8591658, 'recall': 0.8566158, 'specificity': 0.8566158, 'f1': 0.8567893, 'auroc': 0.92236197, 'binary_precision': 0.8828523, 'binary_recall': 0.81889766, 'binary_specificity': 0.89433384, 'binary_f1_score': 0.8496732}
confusion matrix:
     0    1
0  584   69
1  115  520
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.855814, 'precision': 0.8628792, 'recall': 0.855814, 'specificity': 0.855814, 'f1': 0.8551087, 'auroc': 0.93300164, 'binary_precision': 0.91351354, 'binary_recall': 0.7860465, 'binary_specificity': 0.9255814, 'binary_f1_score': 0.845}
confusion matrix:
     0    1
0  199   16
1   46  169
new oracle model saved
better model found
persisted
after epoch: 7,now: 2024-07-27 03:05:22.848140,epoch time: 0:01:23.282517,used: 0:09:44.673587,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_02_55_37_seed_0_23090496
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9840495, 'precision': 0.98406404, 'recall': 0.9841443, 'specificity': 0.9841443, 'f1': 0.98404896, 'auroc': 0.99815935, 'binary_precision': 0.99151987, 'binary_recall': 0.97686374, 'binary_specificity': 0.9914248, 'binary_f1_score': 0.9841373}
confusion matrix:
      0     1
0  1503    13
1    36  1520
---- Validation: 
scalar performance:
{'acc': 0.757764, 'precision': 0.8177587, 'recall': 0.7546997, 'specificity': 0.7546997, 'f1': 0.7442571, 'auroc': 0.9296813, 'binary_precision': 0.95238096, 'binary_recall': 0.53543305, 'binary_specificity': 0.9739663, 'binary_f1_score': 0.68548393}
confusion matrix:
     0    1
0  636   17
1  295  340
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7837209, 'precision': 0.84239244, 'recall': 0.78372097, 'specificity': 0.78372097, 'f1': 0.774041, 'auroc': 0.9331963, 'binary_precision': 0.984127, 'binary_recall': 0.5767442, 'binary_specificity': 0.9906977, 'binary_f1_score': 0.72727275}
confusion matrix:
     0    1
0  213    2
1   91  124
early stop counter: 1
val acc:0.7577639818191528, best validation acc: 0.8571428656578064, corresponding to test acc:                         0.8558139801025391 / 0.8558139801025391
after epoch: 8,now: 2024-07-27 03:06:44.588381,epoch time: 0:01:21.740241,used: 0:11:06.413828,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_02_55_37_seed_0_23090496
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9798177, 'precision': 0.98004377, 'recall': 0.9797157, 'specificity': 0.9797157, 'f1': 0.97980946, 'auroc': 0.99843705, 'binary_precision': 0.9721519, 'binary_recall': 0.98841697, 'binary_specificity': 0.9710145, 'binary_f1_score': 0.9802169}
confusion matrix:
      0     1
0  1474    44
1    18  1536
---- Validation: 
scalar performance:
{'acc': 0.85636646, 'precision': 0.85755813, 'recall': 0.8559586, 'specificity': 0.8559586, 'f1': 0.85612285, 'auroc': 0.92249215, 'binary_precision': 0.875, 'binary_recall': 0.8267717, 'binary_specificity': 0.8851455, 'binary_f1_score': 0.8502024}
confusion matrix:
     0    1
0  578   75
1  110  525
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8534884, 'precision': 0.8534961, 'recall': 0.8534884, 'specificity': 0.8534884, 'f1': 0.8534876, 'auroc': 0.9259924, 'binary_precision': 0.8551402, 'binary_recall': 0.8511628, 'binary_specificity': 0.855814, 'binary_f1_score': 0.8531469}
confusion matrix:
     0    1
0  184   31
1   32  183
early stop counter: 2
val acc:0.8563664555549622, best validation acc: 0.8571428656578064, corresponding to test acc:                         0.8558139801025391 / 0.8558139801025391
after epoch: 9,now: 2024-07-27 03:08:05.816689,epoch time: 0:01:21.228308,used: 0:12:27.642136,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_02_55_37_seed_0_23090496
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9811198, 'precision': 0.9814082, 'recall': 0.98131025, 'specificity': 0.98131025, 'f1': 0.98111963, 'auroc': 0.9989178, 'binary_precision': 0.99668217, 'binary_recall': 0.9659164, 'binary_specificity': 0.99670404, 'binary_f1_score': 0.9810581}
confusion matrix:
      0     1
0  1512     5
1    53  1502
---- Validation: 
scalar performance:
{'acc': 0.72282606, 'precision': 0.80115956, 'recall': 0.7192232, 'specificity': 0.7192232, 'f1': 0.7014025, 'auroc': 0.92321384, 'binary_precision': 0.9512987, 'binary_recall': 0.46141732, 'binary_specificity': 0.9770291, 'binary_f1_score': 0.621421}
confusion matrix:
     0    1
0  638   15
1  342  293
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7744186, 'precision': 0.8409946, 'recall': 0.7744186, 'specificity': 0.7744186, 'f1': 0.7628429, 'auroc': 0.92281234, 'binary_precision': 0.9916667, 'binary_recall': 0.5534884, 'binary_specificity': 0.9953488, 'binary_f1_score': 0.7104478}
confusion matrix:
     0    1
0  214    1
1   96  119
early stop counter: 3
val acc:0.7228260636329651, best validation acc: 0.8571428656578064, corresponding to test acc:                         0.8558139801025391 / 0.8558139801025391
after epoch: 10,now: 2024-07-27 03:09:27.303355,epoch time: 0:01:21.486666,used: 0:13:49.128802,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_02_55_37_seed_0_23090496
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.98046875, 'precision': 0.98044753, 'recall': 0.9805274, 'specificity': 0.9805274, 'f1': 0.98046714, 'auroc': 0.9974352, 'binary_precision': 0.98509395, 'binary_recall': 0.97623634, 'binary_specificity': 0.98481846, 'binary_f1_score': 0.9806452}
confusion matrix:
      0     1
0  1492    23
1    37  1520
---- Validation: 
scalar performance:
{'acc': 0.82686335, 'precision': 0.8271699, 'recall': 0.8270792, 'specificity': 0.8270792, 'f1': 0.8268608, 'auroc': 0.89160633, 'binary_precision': 0.8130699, 'binary_recall': 0.8425197, 'binary_specificity': 0.8116386, 'binary_f1_score': 0.8275329}
confusion matrix:
     0    1
0  530  123
1  100  535
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7790698, 'precision': 0.7795596, 'recall': 0.7790698, 'specificity': 0.7790698, 'f1': 0.7789729, 'auroc': 0.85914546, 'binary_precision': 0.79126215, 'binary_recall': 0.75813955, 'binary_specificity': 0.8, 'binary_f1_score': 0.77434677}
confusion matrix:
     0    1
0  172   43
1   52  163
early stop counter: 4
val acc:0.8268633484840393, best validation acc: 0.8571428656578064, corresponding to test acc:                         0.8558139801025391 / 0.8558139801025391
after epoch: 11,now: 2024-07-27 03:10:48.722466,epoch time: 0:01:21.419111,used: 0:15:10.547913,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_02_55_37_seed_0_23090496
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9902344, 'precision': 0.9902195, 'recall': 0.9902892, 'specificity': 0.9902892, 'f1': 0.9902338, 'auroc': 0.99940765, 'binary_precision': 0.99480855, 'binary_recall': 0.98585206, 'binary_specificity': 0.9947264, 'binary_f1_score': 0.99031}
confusion matrix:
      0     1
0  1509     8
1    22  1533
---- Validation: 
scalar performance:
{'acc': 0.76940995, 'precision': 0.82331, 'recall': 0.7665324, 'specificity': 0.7665324, 'f1': 0.7580575, 'auroc': 0.9259734, 'binary_precision': 0.95187163, 'binary_recall': 0.5606299, 'binary_specificity': 0.97243494, 'binary_f1_score': 0.7056492}
confusion matrix:
     0    1
0  635   18
1  279  356
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8, 'precision': 0.84821093, 'recall': 0.79999995, 'specificity': 0.79999995, 'f1': 0.79282916, 'auroc': 0.9188372, 'binary_precision': 0.9777778, 'binary_recall': 0.6139535, 'binary_specificity': 0.9860465, 'binary_f1_score': 0.7542857}
confusion matrix:
     0    1
0  212    3
1   83  132
early stop counter: 5
val acc:0.7694099545478821, best validation acc: 0.8571428656578064, corresponding to test acc:                         0.8558139801025391 / 0.8558139801025391
after epoch: 12,now: 2024-07-27 03:12:09.711502,epoch time: 0:01:20.989036,used: 0:16:31.536949,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_02_55_37_seed_0_23090496
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 12 with time: 0:16:31.536949 at 2024-07-27 03:12:09.711502
persisted model performance metric: 

scalar performance:
{'acc': 0.855814, 'precision': 0.8628792, 'recall': 0.855814, 'specificity': 0.855814, 'f1': 0.8551087, 'auroc': 0.93300164, 'binary_precision': 0.91351354, 'binary_recall': 0.7860465, 'binary_specificity': 0.9255814, 'binary_f1_score': 0.845}
confusion matrix:
     0    1
0  199   16
1   46  169
oracle model performance metric: 

scalar performance:
{'acc': 0.855814, 'precision': 0.8628792, 'recall': 0.855814, 'specificity': 0.855814, 'f1': 0.8551087, 'auroc': 0.93300164, 'binary_precision': 0.91351354, 'binary_recall': 0.7860465, 'binary_specificity': 0.9255814, 'binary_f1_score': 0.845}
confusion matrix:
     0    1
0  199   16
1   46  169
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_diva_irm_3seeds_nofreeze_2024-07-27_01-18-02/rule_results/17.csv
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_diva_irm_3seeds_nofreeze_2024-07-27_01-18-02/rule_results/17.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_diva_irm_3seeds_nofreeze_2024-07-27_01-18-02/confusion_matrix/17.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   1397 MiB |  14169 MiB |  29519 GiB |  29518 GiB |
|       from large pool |   1336 MiB |  14110 MiB |  29150 GiB |  29148 GiB |
|       from small pool |     60 MiB |     97 MiB |    369 GiB |    369 GiB |
|---------------------------------------------------------------------------|
| Active memory         |   1397 MiB |  14169 MiB |  29519 GiB |  29518 GiB |
|       from large pool |   1336 MiB |  14110 MiB |  29150 GiB |  29148 GiB |
|       from small pool |     60 MiB |     97 MiB |    369 GiB |    369 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |   1388 MiB |  14164 MiB |  29496 GiB |  29495 GiB |
|       from large pool |   1327 MiB |  14105 MiB |  29127 GiB |  29126 GiB |
|       from small pool |     60 MiB |     97 MiB |    368 GiB |    368 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  15302 MiB |  15302 MiB |  15302 MiB |      0 B   |
|       from large pool |  15196 MiB |  15196 MiB |  15196 MiB |      0 B   |
|       from small pool |    106 MiB |    106 MiB |    106 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |   1792 MiB |   2530 MiB |  22350 GiB |  22349 GiB |
|       from large pool |   1779 MiB |   2522 MiB |  21979 GiB |  21977 GiB |
|       from small pool |     13 MiB |     17 MiB |    371 GiB |    371 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    1792    |    3103    |    5329 K  |    5327 K  |
|       from large pool |     269    |    1495    |    2638 K  |    2638 K  |
|       from small pool |    1523    |    2219    |    2691 K  |    2689 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    1792    |    3103    |    5329 K  |    5327 K  |
|       from large pool |     269    |    1495    |    2638 K  |    2638 K  |
|       from small pool |    1523    |    2219    |    2691 K  |    2689 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     589    |     589    |     589    |       0    |
|       from large pool |     536    |     536    |     536    |       0    |
|       from small pool |      53    |      53    |      53    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     147    |     576    |    3355 K  |    3355 K  |
|       from large pool |      61    |     532    |    1898 K  |    1898 K  |
|       from small pool |      86    |     235    |    1456 K  |    1456 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  14169 MiB |  29519 GiB |  29519 GiB |
|       from large pool |  16640 KiB |  14110 MiB |  29150 GiB |  29150 GiB |
|       from small pool |      0 KiB |     97 MiB |    369 GiB |    369 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  14169 MiB |  29519 GiB |  29519 GiB |
|       from large pool |  16640 KiB |  14110 MiB |  29150 GiB |  29150 GiB |
|       from small pool |      0 KiB |     97 MiB |    369 GiB |    369 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  14164 MiB |  29496 GiB |  29496 GiB |
|       from large pool |  16640 KiB |  14105 MiB |  29127 GiB |  29127 GiB |
|       from small pool |      0 KiB |     97 MiB |    368 GiB |    368 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   3190 MiB |  15302 MiB |  15302 MiB |  12112 MiB |
|       from large pool |   3116 MiB |  15196 MiB |  15196 MiB |  12080 MiB |
|       from small pool |     74 MiB |    106 MiB |    106 MiB |     32 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   2530 MiB |  22351 GiB |  22351 GiB |
|       from large pool |  24320 KiB |   2522 MiB |  21980 GiB |  21979 GiB |
|       from small pool |      0 KiB |     41 MiB |    371 GiB |    371 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3103    |    5329 K  |    5329 K  |
|       from large pool |       2    |    1495    |    2638 K  |    2638 K  |
|       from small pool |       0    |    2219    |    2691 K  |    2691 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3103    |    5329 K  |    5329 K  |
|       from large pool |       2    |    1495    |    2638 K  |    2638 K  |
|       from small pool |       0    |    2219    |    2691 K  |    2691 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      98    |     589    |     589    |     491    |
|       from large pool |      61    |     536    |     536    |     475    |
|       from small pool |      37    |      53    |      53    |      16    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       2    |     576    |    3355 K  |    3355 K  |
|       from large pool |       2    |     532    |    1898 K  |    1898 K  |
|       from small pool |       0    |     235    |    1457 K  |    1457 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  14169 MiB |  29519 GiB |  29519 GiB |
|       from large pool |  16640 KiB |  14110 MiB |  29150 GiB |  29150 GiB |
|       from small pool |      0 KiB |     97 MiB |    369 GiB |    369 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  14169 MiB |  29519 GiB |  29519 GiB |
|       from large pool |  16640 KiB |  14110 MiB |  29150 GiB |  29150 GiB |
|       from small pool |      0 KiB |     97 MiB |    369 GiB |    369 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  14164 MiB |  29496 GiB |  29496 GiB |
|       from large pool |  16640 KiB |  14105 MiB |  29127 GiB |  29127 GiB |
|       from small pool |      0 KiB |     97 MiB |    368 GiB |    368 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   3190 MiB |  15302 MiB |  15302 MiB |  12112 MiB |
|       from large pool |   3116 MiB |  15196 MiB |  15196 MiB |  12080 MiB |
|       from small pool |     74 MiB |    106 MiB |    106 MiB |     32 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   2530 MiB |  22351 GiB |  22351 GiB |
|       from large pool |  24320 KiB |   2522 MiB |  21980 GiB |  21979 GiB |
|       from small pool |      0 KiB |     41 MiB |    371 GiB |    371 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3103    |    5329 K  |    5329 K  |
|       from large pool |       2    |    1495    |    2638 K  |    2638 K  |
|       from small pool |       0    |    2219    |    2691 K  |    2691 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3103    |    5329 K  |    5329 K  |
|       from large pool |       2    |    1495    |    2638 K  |    2638 K  |
|       from small pool |       0    |    2219    |    2691 K  |    2691 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      98    |     589    |     589    |     491    |
|       from large pool |      61    |     536    |     536    |     475    |
|       from small pool |      37    |      53    |      53    |      16    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       2    |     576    |    3355 K  |    3355 K  |
|       from large pool |       2    |     532    |    1898 K  |    1898 K  |
|       from small pool |       0    |     235    |    1457 K  |    1457 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main

using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_03_12_49_seed_1_23090496

 Experiment start at: 2024-07-27 03:12:50.261940
before training, model accuracy: 0.46666666865348816
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9397786, 'precision': 0.9428943, 'recall': 0.9392821, 'specificity': 0.9392821, 'f1': 0.93961686, 'auroc': 0.9903902, 'binary_precision': 0.9087112, 'binary_recall': 0.9794212, 'binary_specificity': 0.89914304, 'binary_f1_score': 0.94274217}
confusion matrix:
      0     1
0  1364   153
1    32  1523
---- Validation: 
scalar performance:
{'acc': 0.74004686, 'precision': 0.7830292, 'recall': 0.74318993, 'specificity': 0.74318993, 'f1': 0.7313875, 'auroc': 0.89514786, 'binary_precision': 0.6685585, 'binary_recall': 0.9349206, 'binary_specificity': 0.5514593, 'binary_f1_score': 0.7796161}
confusion matrix:
     0    1
0  359  292
1   41  589
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7111111, 'precision': 0.77431273, 'recall': 0.7111111, 'specificity': 0.7111111, 'f1': 0.693454, 'auroc': 0.91697776, 'binary_precision': 0.6426426, 'binary_recall': 0.95111114, 'binary_specificity': 0.47111112, 'binary_f1_score': 0.76702505}
confusion matrix:
     0    1
0  106  119
1   11  214
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-27 03:14:19.381967,epoch time: 0:01:29.120027,used: 0:01:29.120027,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_03_12_49_seed_1_23090496
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9671224, 'precision': 0.9671618, 'recall': 0.9672313, 'specificity': 0.9672313, 'f1': 0.96712184, 'auroc': 0.9945928, 'binary_precision': 0.97580117, 'binary_recall': 0.9588689, 'binary_specificity': 0.9755937, 'binary_f1_score': 0.96726096}
confusion matrix:
      0     1
0  1479    37
1    64  1492
---- Validation: 
scalar performance:
{'acc': 0.8657299, 'precision': 0.8693019, 'recall': 0.86492574, 'specificity': 0.86492574, 'f1': 0.86519086, 'auroc': 0.9113623, 'binary_precision': 0.9017544, 'binary_recall': 0.815873, 'binary_specificity': 0.9139785, 'binary_f1_score': 0.8566666}
confusion matrix:
     0    1
0  595   56
1  116  514
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.86444443, 'precision': 0.86445165, 'recall': 0.86444443, 'specificity': 0.86444443, 'f1': 0.8644438, 'auroc': 0.92630124, 'binary_precision': 0.86283183, 'binary_recall': 0.8666667, 'binary_specificity': 0.8622222, 'binary_f1_score': 0.864745}
confusion matrix:
     0    1
0  194   31
1   30  195
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-07-27 03:15:43.851468,epoch time: 0:01:24.469501,used: 0:02:53.589528,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_03_12_49_seed_1_23090496
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9560547, 'precision': 0.95909095, 'recall': 0.9566474, 'specificity': 0.9566474, 'f1': 0.9560144, 'auroc': 0.996943, 'binary_precision': 1.0, 'binary_recall': 0.9132948, 'binary_specificity': 1.0, 'binary_f1_score': 0.95468277}
confusion matrix:
      0     1
0  1515     0
1   135  1422
---- Validation: 
scalar performance:
{'acc': 0.637783, 'precision': 0.75276303, 'recall': 0.63215566, 'specificity': 0.63215566, 'f1': 0.58601207, 'auroc': 0.87950647, 'binary_precision': 0.9191919, 'binary_recall': 0.2888889, 'binary_specificity': 0.97542244, 'binary_f1_score': 0.43961352}
confusion matrix:
     0    1
0  635   16
1  448  182
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.84, 'precision': 0.87200934, 'recall': 0.84000003, 'specificity': 0.84000003, 'f1': 0.8364825, 'auroc': 0.9051852, 'binary_precision': 0.9811321, 'binary_recall': 0.6933333, 'binary_specificity': 0.9866667, 'binary_f1_score': 0.8125}
confusion matrix:
     0    1
0  222    3
1   69  156
early stop counter: 1
val acc:0.6377829909324646, best validation acc: 0.8657299280166626, corresponding to test acc:                         0.8644444346427917 / 0.8644444346427917
after epoch: 3,now: 2024-07-27 03:17:06.257024,epoch time: 0:01:22.405556,used: 0:04:15.995084,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_03_12_49_seed_1_23090496
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.97265625, 'precision': 0.9726477, 'recall': 0.9727439, 'specificity': 0.9727439, 'f1': 0.9726546, 'auroc': 0.9973508, 'binary_precision': 0.97919375, 'binary_recall': 0.9666239, 'binary_specificity': 0.97886395, 'binary_f1_score': 0.9728682}
confusion matrix:
      0     1
0  1482    32
1    52  1506
---- Validation: 
scalar performance:
{'acc': 0.85870415, 'precision': 0.85993826, 'recall': 0.85821813, 'specificity': 0.85821813, 'f1': 0.8584336, 'auroc': 0.9130763, 'binary_precision': 0.87731093, 'binary_recall': 0.82857144, 'binary_specificity': 0.8878648, 'binary_f1_score': 0.8522449}
confusion matrix:
     0    1
0  578   73
1  108  522
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8622222, 'precision': 0.86248, 'recall': 0.8622222, 'specificity': 0.8622222, 'f1': 0.8621977, 'auroc': 0.92770374, 'binary_precision': 0.85281384, 'binary_recall': 0.8755556, 'binary_specificity': 0.8488889, 'binary_f1_score': 0.86403507}
confusion matrix:
     0    1
0  191   34
1   28  197
early stop counter: 2
val acc:0.858704149723053, best validation acc: 0.8657299280166626, corresponding to test acc:                         0.8644444346427917 / 0.8644444346427917
after epoch: 4,now: 2024-07-27 03:18:29.005837,epoch time: 0:01:22.748813,used: 0:05:38.743897,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_03_12_49_seed_1_23090496
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.96972656, 'precision': 0.9709401, 'recall': 0.9700543, 'specificity': 0.9700543, 'f1': 0.9697182, 'auroc': 0.9975417, 'binary_precision': 0.997955, 'binary_recall': 0.94208497, 'binary_specificity': 0.9980237, 'binary_f1_score': 0.9692155}
confusion matrix:
      0     1
0  1515     3
1    90  1464
---- Validation: 
scalar performance:
{'acc': 0.7946916, 'precision': 0.8255768, 'recall': 0.7921403, 'specificity': 0.7921403, 'f1': 0.78868353, 'auroc': 0.89613783, 'binary_precision': 0.92183906, 'binary_recall': 0.6365079, 'binary_specificity': 0.9477727, 'binary_f1_score': 0.75305164}
confusion matrix:
     0    1
0  617   34
1  229  401
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.82, 'precision': 0.82889396, 'recall': 0.82, 'specificity': 0.82, 'f1': 0.8187748, 'auroc': 0.9049284, 'binary_precision': 0.88297874, 'binary_recall': 0.73777777, 'binary_specificity': 0.9022222, 'binary_f1_score': 0.80387414}
confusion matrix:
     0    1
0  203   22
1   59  166
early stop counter: 3
val acc:0.7946916222572327, best validation acc: 0.8657299280166626, corresponding to test acc:                         0.8644444346427917 / 0.8644444346427917
after epoch: 5,now: 2024-07-27 03:19:51.505686,epoch time: 0:01:22.499849,used: 0:07:01.243746,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_03_12_49_seed_1_23090496
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.98014325, 'precision': 0.9803648, 'recall': 0.9800339, 'specificity': 0.9800339, 'f1': 0.98013437, 'auroc': 0.99830043, 'binary_precision': 0.97280204, 'binary_recall': 0.9884319, 'binary_specificity': 0.9716359, 'binary_f1_score': 0.98055476}
confusion matrix:
      0     1
0  1473    43
1    18  1538
---- Validation: 
scalar performance:
{'acc': 0.83138174, 'precision': 0.8427383, 'recall': 0.82987714, 'specificity': 0.82987714, 'f1': 0.829488, 'auroc': 0.90411574, 'binary_precision': 0.9011628, 'binary_recall': 0.7380952, 'binary_specificity': 0.921659, 'binary_f1_score': 0.8115183}
confusion matrix:
     0    1
0  600   51
1  165  465
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8466667, 'precision': 0.8542878, 'recall': 0.8466667, 'specificity': 0.8466667, 'f1': 0.84583765, 'auroc': 0.90550125, 'binary_precision': 0.90625, 'binary_recall': 0.7733333, 'binary_specificity': 0.92, 'binary_f1_score': 0.8345324}
confusion matrix:
     0    1
0  207   18
1   51  174
early stop counter: 4
val acc:0.8313817381858826, best validation acc: 0.8657299280166626, corresponding to test acc:                         0.8644444346427917 / 0.8644444346427917
after epoch: 6,now: 2024-07-27 03:21:13.775358,epoch time: 0:01:22.269672,used: 0:08:23.513418,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_03_12_49_seed_1_23090496
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9765625, 'precision': 0.9770287, 'recall': 0.9763979, 'specificity': 0.9763979, 'f1': 0.97654736, 'auroc': 0.9985943, 'binary_precision': 0.9648903, 'binary_recall': 0.9897106, 'binary_specificity': 0.96308506, 'binary_f1_score': 0.9771429}
confusion matrix:
      0     1
0  1461    56
1    16  1539
---- Validation: 
scalar performance:
{'acc': 0.8345043, 'precision': 0.83661366, 'recall': 0.8351511, 'specificity': 0.8351511, 'f1': 0.8343944, 'auroc': 0.90622973, 'binary_precision': 0.8055556, 'binary_recall': 0.87460315, 'binary_specificity': 0.79569894, 'binary_f1_score': 0.8386606}
confusion matrix:
     0    1
0  518  133
1   79  551
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.74666667, 'precision': 0.78886855, 'recall': 0.74666667, 'specificity': 0.74666667, 'f1': 0.7370633, 'auroc': 0.89840984, 'binary_precision': 0.6784566, 'binary_recall': 0.93777776, 'binary_specificity': 0.5555556, 'binary_f1_score': 0.78731346}
confusion matrix:
     0    1
0  125  100
1   14  211
early stop counter: 5
val acc:0.8345043063163757, best validation acc: 0.8657299280166626, corresponding to test acc:                         0.8644444346427917 / 0.8644444346427917
after epoch: 7,now: 2024-07-27 03:22:36.060787,epoch time: 0:01:22.285429,used: 0:09:45.798847,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_03_12_49_seed_1_23090496
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 7 with time: 0:09:45.798847 at 2024-07-27 03:22:36.060787
persisted model performance metric: 

scalar performance:
{'acc': 0.86444443, 'precision': 0.86445165, 'recall': 0.86444443, 'specificity': 0.86444443, 'f1': 0.8644438, 'auroc': 0.92630124, 'binary_precision': 0.86283183, 'binary_recall': 0.8666667, 'binary_specificity': 0.8622222, 'binary_f1_score': 0.864745}
confusion matrix:
     0    1
0  194   31
1   30  195
oracle model performance metric: 

scalar performance:
{'acc': 0.86444443, 'precision': 0.86445165, 'recall': 0.86444443, 'specificity': 0.86444443, 'f1': 0.8644438, 'auroc': 0.92630124, 'binary_precision': 0.86283183, 'binary_recall': 0.8666667, 'binary_specificity': 0.8622222, 'binary_f1_score': 0.864745}
confusion matrix:
     0    1
0  194   31
1   30  195
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_diva_irm_3seeds_nofreeze_2024-07-27_01-18-02/rule_results/17.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_diva_irm_3seeds_nofreeze_2024-07-27_01-18-02/confusion_matrix/17.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   1399 MiB |  14169 MiB |  47270 GiB |  47269 GiB |
|       from large pool |   1338 MiB |  14110 MiB |  46677 GiB |  46675 GiB |
|       from small pool |     60 MiB |    100 MiB |    593 GiB |    593 GiB |
|---------------------------------------------------------------------------|
| Active memory         |   1399 MiB |  14169 MiB |  47270 GiB |  47269 GiB |
|       from large pool |   1338 MiB |  14110 MiB |  46677 GiB |  46675 GiB |
|       from small pool |     60 MiB |    100 MiB |    593 GiB |    593 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |   1388 MiB |  14164 MiB |  47227 GiB |  47226 GiB |
|       from large pool |   1327 MiB |  14105 MiB |  46635 GiB |  46634 GiB |
|       from small pool |     60 MiB |    100 MiB |    592 GiB |    592 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  15258 MiB |  15302 MiB |  27370 MiB |  12112 MiB |
|       from large pool |  15148 MiB |  15196 MiB |  27228 MiB |  12080 MiB |
|       from small pool |    110 MiB |    110 MiB |    142 MiB |     32 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |   2018 MiB |   3051 MiB |  36552 GiB |  36550 GiB |
|       from large pool |   2009 MiB |   3041 MiB |  35956 GiB |  35954 GiB |
|       from small pool |      9 MiB |     41 MiB |    596 GiB |    596 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    1804    |    3107    |    8530 K  |    8528 K  |
|       from large pool |     269    |    1495    |    4223 K  |    4223 K  |
|       from small pool |    1535    |    2231    |    4306 K  |    4305 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    1804    |    3107    |    8530 K  |    8528 K  |
|       from large pool |     269    |    1495    |    4223 K  |    4223 K  |
|       from small pool |    1535    |    2231    |    4306 K  |    4305 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     561    |     589    |    1052    |     491    |
|       from large pool |     506    |     536    |     981    |     475    |
|       from small pool |      55    |      55    |      71    |      16    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     141    |     576    |    5242 K  |    5241 K  |
|       from large pool |      60    |     532    |    2934 K  |    2934 K  |
|       from small pool |      81    |     235    |    2307 K  |    2307 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  14169 MiB |  47270 GiB |  47270 GiB |
|       from large pool |  16640 KiB |  14110 MiB |  46677 GiB |  46677 GiB |
|       from small pool |      0 KiB |    100 MiB |    593 GiB |    593 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  14169 MiB |  47270 GiB |  47270 GiB |
|       from large pool |  16640 KiB |  14110 MiB |  46677 GiB |  46677 GiB |
|       from small pool |      0 KiB |    100 MiB |    593 GiB |    593 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  14164 MiB |  47227 GiB |  47227 GiB |
|       from large pool |  16640 KiB |  14105 MiB |  46635 GiB |  46635 GiB |
|       from small pool |      0 KiB |    100 MiB |    592 GiB |    592 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   3418 MiB |  15302 MiB |  27370 MiB |  23952 MiB |
|       from large pool |   3348 MiB |  15196 MiB |  27228 MiB |  23880 MiB |
|       from small pool |     70 MiB |    110 MiB |    142 MiB |     72 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   3051 MiB |  36553 GiB |  36553 GiB |
|       from large pool |  24320 KiB |   3041 MiB |  35957 GiB |  35956 GiB |
|       from small pool |      0 KiB |     43 MiB |    596 GiB |    596 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3107    |    8530 K  |    8530 K  |
|       from large pool |       2    |    1495    |    4223 K  |    4223 K  |
|       from small pool |       0    |    2231    |    4306 K  |    4306 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3107    |    8530 K  |    8530 K  |
|       from large pool |       2    |    1495    |    4223 K  |    4223 K  |
|       from small pool |       0    |    2231    |    4306 K  |    4306 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      96    |     589    |    1052    |     956    |
|       from large pool |      61    |     536    |     981    |     920    |
|       from small pool |      35    |      55    |      71    |      36    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       2    |     576    |    5242 K  |    5242 K  |
|       from large pool |       2    |     532    |    2934 K  |    2934 K  |
|       from small pool |       0    |     235    |    2307 K  |    2307 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  14169 MiB |  47270 GiB |  47270 GiB |
|       from large pool |  16640 KiB |  14110 MiB |  46677 GiB |  46677 GiB |
|       from small pool |      0 KiB |    100 MiB |    593 GiB |    593 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  14169 MiB |  47270 GiB |  47270 GiB |
|       from large pool |  16640 KiB |  14110 MiB |  46677 GiB |  46677 GiB |
|       from small pool |      0 KiB |    100 MiB |    593 GiB |    593 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  14164 MiB |  47227 GiB |  47227 GiB |
|       from large pool |  16640 KiB |  14105 MiB |  46635 GiB |  46635 GiB |
|       from small pool |      0 KiB |    100 MiB |    592 GiB |    592 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   3418 MiB |  15302 MiB |  27370 MiB |  23952 MiB |
|       from large pool |   3348 MiB |  15196 MiB |  27228 MiB |  23880 MiB |
|       from small pool |     70 MiB |    110 MiB |    142 MiB |     72 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   3051 MiB |  36553 GiB |  36553 GiB |
|       from large pool |  24320 KiB |   3041 MiB |  35957 GiB |  35956 GiB |
|       from small pool |      0 KiB |     43 MiB |    596 GiB |    596 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3107    |    8530 K  |    8530 K  |
|       from large pool |       2    |    1495    |    4223 K  |    4223 K  |
|       from small pool |       0    |    2231    |    4306 K  |    4306 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3107    |    8530 K  |    8530 K  |
|       from large pool |       2    |    1495    |    4223 K  |    4223 K  |
|       from small pool |       0    |    2231    |    4306 K  |    4306 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      96    |     589    |    1052    |     956    |
|       from large pool |      61    |     536    |     981    |     920    |
|       from small pool |      35    |      55    |      71    |      36    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       2    |     576    |    5242 K  |    5242 K  |
|       from large pool |       2    |     532    |    2934 K  |    2934 K  |
|       from small pool |       0    |     235    |    2307 K  |    2307 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main

using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_03_23_13_seed_2_23090496

 Experiment start at: 2024-07-27 03:23:14.774255
before training, model accuracy: 0.46759259700775146
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.90772253, 'precision': 0.9207666, 'recall': 0.90842104, 'specificity': 0.90842104, 'f1': 0.9071008, 'auroc': 0.9859824, 'binary_precision': 0.9968404, 'binary_recall': 0.81948054, 'binary_specificity': 0.9973615, 'binary_f1_score': 0.8995011}
confusion matrix:
      0     1
0  1512     4
1   278  1262
---- Validation: 
scalar performance:
{'acc': 0.5406886, 'precision': 0.717456, 'recall': 0.5283017, 'specificity': 0.5283017, 'f1': 0.4034377, 'auroc': 0.85119057, 'binary_precision': 0.90697676, 'binary_recall': 0.062700965, 'binary_specificity': 0.99390244, 'binary_f1_score': 0.11729323}
confusion matrix:
     0   1
0  652   4
1  583  39
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.599537, 'precision': 0.777635, 'recall': 0.599537, 'specificity': 0.599537, 'f1': 0.5230479, 'auroc': 0.8873457, 'binary_precision': 1.0, 'binary_recall': 0.19907407, 'binary_specificity': 1.0, 'binary_f1_score': 0.33204636}
confusion matrix:
     0   1
0  216   0
1  173  43
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-27 03:24:39.677875,epoch time: 0:01:24.903620,used: 0:01:24.903620,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_03_23_13_seed_2_23090496
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.88056284, 'precision': 0.899348, 'recall': 0.8797151, 'specificity': 0.8797151, 'f1': 0.87896615, 'auroc': 0.98866975, 'binary_precision': 0.8146759, 'binary_recall': 0.9876623, 'binary_specificity': 0.7717678, 'binary_f1_score': 0.8928676}
confusion matrix:
      0     1
0  1170   346
1    19  1521
---- Validation: 
scalar performance:
{'acc': 0.74100155, 'precision': 0.74096227, 'recall': 0.7411306, 'specificity': 0.7411306, 'f1': 0.74094427, 'auroc': 0.8033782, 'binary_precision': 0.7284144, 'binary_recall': 0.7459807, 'binary_specificity': 0.7362805, 'binary_f1_score': 0.7370929}
confusion matrix:
     0    1
0  483  173
1  158  464
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7569444, 'precision': 0.78806925, 'recall': 0.7569444, 'specificity': 0.7569444, 'f1': 0.75019693, 'auroc': 0.9046854, 'binary_precision': 0.6933798, 'binary_recall': 0.9212963, 'binary_specificity': 0.5925926, 'binary_f1_score': 0.7912525}
confusion matrix:
     0    1
0  128   88
1   17  199
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-07-27 03:26:01.934345,epoch time: 0:01:22.256470,used: 0:02:47.160090,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_03_23_13_seed_2_23090496
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.97447646, 'precision': 0.9744689, 'recall': 0.97448516, 'specificity': 0.97448516, 'f1': 0.9744754, 'auroc': 0.99665046, 'binary_precision': 0.97591144, 'binary_recall': 0.97337663, 'binary_specificity': 0.9755937, 'binary_f1_score': 0.9746424}
confusion matrix:
      0     1
0  1479    37
1    41  1499
---- Validation: 
scalar performance:
{'acc': 0.7879499, 'precision': 0.7998672, 'recall': 0.79052866, 'specificity': 0.79052866, 'f1': 0.78672135, 'auroc': 0.8837861, 'binary_precision': 0.73306775, 'binary_recall': 0.8874598, 'binary_specificity': 0.69359756, 'binary_f1_score': 0.80290914}
confusion matrix:
     0    1
0  455  201
1   70  552
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7337963, 'precision': 0.7720539, 'recall': 0.7337963, 'specificity': 0.7337963, 'f1': 0.72409654, 'auroc': 0.9056713, 'binary_precision': 0.6700337, 'binary_recall': 0.9212963, 'binary_specificity': 0.5462963, 'binary_f1_score': 0.7758284}
confusion matrix:
     0    1
0  118   98
1   17  199
better model found
persisted
after epoch: 3,now: 2024-07-27 03:27:23.403577,epoch time: 0:01:21.469232,used: 0:04:08.629322,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_03_23_13_seed_2_23090496
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.97611254, 'precision': 0.97682244, 'recall': 0.9762782, 'specificity': 0.9762782, 'f1': 0.9761083, 'auroc': 0.9980464, 'binary_precision': 0.9972881, 'binary_recall': 0.95519483, 'binary_specificity': 0.9973615, 'binary_f1_score': 0.97578776}
confusion matrix:
      0     1
0  1512     4
1    69  1471
---- Validation: 
scalar performance:
{'acc': 0.6690141, 'precision': 0.7520384, 'recall': 0.6611344, 'specificity': 0.6611344, 'f1': 0.6328691, 'auroc': 0.8618374, 'binary_precision': 0.8901961, 'binary_recall': 0.36495176, 'binary_specificity': 0.95731705, 'binary_f1_score': 0.5176739}
confusion matrix:
     0    1
0  628   28
1  395  227
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7569444, 'precision': 0.81541556, 'recall': 0.7569444, 'specificity': 0.7569444, 'f1': 0.74513274, 'auroc': 0.89313275, 'binary_precision': 0.9512195, 'binary_recall': 0.5416667, 'binary_specificity': 0.9722222, 'binary_f1_score': 0.6902655}
confusion matrix:
     0    1
0  210    6
1   99  117
early stop counter: 1
val acc:0.6690140962600708, best validation acc: 0.7879499197006226, corresponding to test acc:                         0.7337962985038757 / 0.7569444179534912
after epoch: 4,now: 2024-07-27 03:28:43.935322,epoch time: 0:01:20.531745,used: 0:05:29.161067,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_03_23_13_seed_2_23090496
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.97742146, 'precision': 0.9775888, 'recall': 0.97751004, 'specificity': 0.97751004, 'f1': 0.97742116, 'auroc': 0.99683034, 'binary_precision': 0.9887043, 'binary_recall': 0.9662338, 'binary_specificity': 0.9887863, 'binary_f1_score': 0.97733986}
confusion matrix:
      0     1
0  1499    17
1    52  1488
---- Validation: 
scalar performance:
{'acc': 0.7973396, 'precision': 0.81724, 'recall': 0.7939255, 'specificity': 0.7939255, 'f1': 0.7927096, 'auroc': 0.8825828, 'binary_precision': 0.89032257, 'binary_recall': 0.6655949, 'binary_specificity': 0.9222561, 'binary_f1_score': 0.76172954}
confusion matrix:
     0    1
0  605   51
1  208  414
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8564815, 'precision': 0.85897434, 'recall': 0.85648143, 'specificity': 0.85648143, 'f1': 0.8562319, 'auroc': 0.924147, 'binary_precision': 0.8888889, 'binary_recall': 0.8148148, 'binary_specificity': 0.8981481, 'binary_f1_score': 0.85024154}
confusion matrix:
     0    1
0  194   22
1   40  176
new oracle model saved
better model found
persisted
after epoch: 5,now: 2024-07-27 03:30:06.034851,epoch time: 0:01:22.099529,used: 0:06:51.260596,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_03_23_13_seed_2_23090496
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.970877, 'precision': 0.971202, 'recall': 0.97078526, 'specificity': 0.97078526, 'f1': 0.97086614, 'auroc': 0.9973563, 'binary_precision': 0.96063495, 'binary_recall': 0.98246753, 'binary_specificity': 0.9591029, 'binary_f1_score': 0.9714286}
confusion matrix:
      0     1
0  1454    62
1    27  1513
---- Validation: 
scalar performance:
{'acc': 0.79577464, 'precision': 0.81398034, 'recall': 0.7924844, 'specificity': 0.7924844, 'f1': 0.79140353, 'auroc': 0.8845091, 'binary_precision': 0.88322717, 'binary_recall': 0.6688103, 'binary_specificity': 0.91615856, 'binary_f1_score': 0.76120764}
confusion matrix:
     0    1
0  601   55
1  206  416
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8425926, 'precision': 0.8425926, 'recall': 0.8425926, 'specificity': 0.8425926, 'f1': 0.8425926, 'auroc': 0.91561645, 'binary_precision': 0.8425926, 'binary_recall': 0.8425926, 'binary_specificity': 0.8425926, 'binary_f1_score': 0.8425926}
confusion matrix:
     0    1
0  182   34
1   34  182
early stop counter: 1
val acc:0.7957746386528015, best validation acc: 0.7973396182060242, corresponding to test acc:                         0.8564814925193787 / 0.8564814925193787
after epoch: 6,now: 2024-07-27 03:31:26.180528,epoch time: 0:01:20.145677,used: 0:08:11.406273,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_03_23_13_seed_2_23090496
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.96825916, 'precision': 0.96835333, 'recall': 0.9682135, 'specificity': 0.9682135, 'f1': 0.96825343, 'auroc': 0.9963515, 'binary_precision': 0.9633911, 'binary_recall': 0.97402596, 'binary_specificity': 0.96240103, 'binary_f1_score': 0.96867937}
confusion matrix:
      0     1
0  1459    57
1    40  1500
---- Validation: 
scalar performance:
{'acc': 0.8231612, 'precision': 0.8230243, 'recall': 0.8231193, 'specificity': 0.8231193, 'f1': 0.82306373, 'auroc': 0.89238346, 'binary_precision': 0.81629395, 'binary_recall': 0.8215434, 'binary_specificity': 0.8246951, 'binary_f1_score': 0.81891024}
confusion matrix:
     0    1
0  541  115
1  111  511
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8032407, 'precision': 0.8073581, 'recall': 0.8032408, 'specificity': 0.8032408, 'f1': 0.8025795, 'auroc': 0.91313016, 'binary_precision': 0.77178425, 'binary_recall': 0.8611111, 'binary_specificity': 0.7453704, 'binary_f1_score': 0.81400436}
confusion matrix:
     0    1
0  161   55
1   30  186
better model found
persisted
after epoch: 7,now: 2024-07-27 03:32:48.532147,epoch time: 0:01:22.351619,used: 0:09:33.757892,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_03_23_13_seed_2_23090496
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.98756546, 'precision': 0.9875647, 'recall': 0.9875647, 'specificity': 0.9875647, 'f1': 0.9875647, 'auroc': 0.99927735, 'binary_precision': 0.9876623, 'binary_recall': 0.9876623, 'binary_specificity': 0.987467, 'binary_f1_score': 0.9876623}
confusion matrix:
      0     1
0  1497    19
1    19  1521
---- Validation: 
scalar performance:
{'acc': 0.68622845, 'precision': 0.758059, 'recall': 0.67898595, 'specificity': 0.67898595, 'f1': 0.6573527, 'auroc': 0.8368069, 'binary_precision': 0.8877193, 'binary_recall': 0.4067524, 'binary_specificity': 0.9512195, 'binary_f1_score': 0.5578831}
confusion matrix:
     0    1
0  624   32
1  369  253
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7986111, 'precision': 0.8148119, 'recall': 0.7986111, 'specificity': 0.7986111, 'f1': 0.7959864, 'auroc': 0.8561385, 'binary_precision': 0.88622755, 'binary_recall': 0.6851852, 'binary_specificity': 0.912037, 'binary_f1_score': 0.7728459}
confusion matrix:
     0    1
0  197   19
1   68  148
early stop counter: 1
val acc:0.6862284541130066, best validation acc: 0.8231611847877502, corresponding to test acc:                         0.8032407164573669 / 0.8564814925193787
after epoch: 8,now: 2024-07-27 03:34:08.883832,epoch time: 0:01:20.351685,used: 0:10:54.109577,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_03_23_13_seed_2_23090496
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9878927, 'precision': 0.9878849, 'recall': 0.9879048, 'specificity': 0.9879048, 'f1': 0.98789215, 'auroc': 0.9993733, 'binary_precision': 0.9895765, 'binary_recall': 0.98636365, 'binary_specificity': 0.9894459, 'binary_f1_score': 0.98796743}
confusion matrix:
      0     1
0  1500    16
1    21  1519
---- Validation: 
scalar performance:
{'acc': 0.85758996, 'precision': 0.85785747, 'recall': 0.8571558, 'specificity': 0.8571558, 'f1': 0.8573717, 'auroc': 0.9175432, 'binary_precision': 0.8630363, 'binary_recall': 0.840836, 'binary_specificity': 0.8734756, 'binary_f1_score': 0.8517915}
confusion matrix:
     0    1
0  573   83
1   99  523
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8287037, 'precision': 0.84293383, 'recall': 0.82870376, 'specificity': 0.82870376, 'f1': 0.8269081, 'auroc': 0.8956405, 'binary_precision': 0.9127907, 'binary_recall': 0.7268519, 'binary_specificity': 0.9305556, 'binary_f1_score': 0.80927837}
confusion matrix:
     0    1
0  201   15
1   59  157
better model found
persisted
after epoch: 9,now: 2024-07-27 03:35:30.380425,epoch time: 0:01:21.496593,used: 0:12:15.606170,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_03_23_13_seed_2_23090496
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9846204, 'precision': 0.9846889, 'recall': 0.98468375, 'specificity': 0.98468375, 'f1': 0.98462045, 'auroc': 0.9990381, 'binary_precision': 0.99273926, 'binary_recall': 0.97662336, 'binary_specificity': 0.9927441, 'binary_f1_score': 0.9846154}
confusion matrix:
      0     1
0  1505    11
1    36  1504
---- Validation: 
scalar performance:
{'acc': 0.7934272, 'precision': 0.82583904, 'recall': 0.7891562, 'specificity': 0.7891562, 'f1': 0.7863878, 'auroc': 0.9133616, 'binary_precision': 0.9221698, 'binary_recall': 0.62861735, 'binary_specificity': 0.9496951, 'binary_f1_score': 0.7476099}
confusion matrix:
     0    1
0  623   33
1  231  391
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7916667, 'precision': 0.84661233, 'recall': 0.7916666, 'specificity': 0.7916666, 'f1': 0.7830696, 'auroc': 0.9117799, 'binary_precision': 0.9846154, 'binary_recall': 0.5925926, 'binary_specificity': 0.9907407, 'binary_f1_score': 0.7398843}
confusion matrix:
     0    1
0  214    2
1   88  128
early stop counter: 1
val acc:0.7934272289276123, best validation acc: 0.8575899600982666, corresponding to test acc:                         0.8287037014961243 / 0.8564814925193787
after epoch: 10,now: 2024-07-27 03:36:50.710312,epoch time: 0:01:20.329887,used: 0:13:35.936057,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_03_23_13_seed_2_23090496
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.98003924, 'precision': 0.98003155, 'recall': 0.98005605, 'specificity': 0.98005605, 'f1': 0.98003864, 'auroc': 0.9978614, 'binary_precision': 0.9823875, 'binary_recall': 0.9779221, 'binary_specificity': 0.98218995, 'binary_f1_score': 0.98014975}
confusion matrix:
      0     1
0  1489    27
1    34  1506
---- Validation: 
scalar performance:
{'acc': 0.6181534, 'precision': 0.7097354, 'recall': 0.6090086, 'specificity': 0.6090086, 'f1': 0.56132025, 'auroc': 0.82970023, 'binary_precision': 0.84183675, 'binary_recall': 0.2652733, 'binary_specificity': 0.9527439, 'binary_f1_score': 0.40342298}
confusion matrix:
     0    1
0  625   31
1  457  165
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7106481, 'precision': 0.7939787, 'recall': 0.7106482, 'specificity': 0.7106482, 'f1': 0.68857956, 'auroc': 0.86732686, 'binary_precision': 0.95049506, 'binary_recall': 0.44444445, 'binary_specificity': 0.9768519, 'binary_f1_score': 0.60567826}
confusion matrix:
     0   1
0  211   5
1  120  96
early stop counter: 2
val acc:0.6181533932685852, best validation acc: 0.8575899600982666, corresponding to test acc:                         0.8287037014961243 / 0.8564814925193787
after epoch: 11,now: 2024-07-27 03:38:11.216648,epoch time: 0:01:20.506336,used: 0:14:56.442393,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_03_23_13_seed_2_23090496
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9528796, 'precision': 0.9561436, 'recall': 0.952558, 'specificity': 0.952558, 'f1': 0.95276874, 'auroc': 0.99791574, 'binary_precision': 0.91947114, 'binary_recall': 0.9935065, 'binary_specificity': 0.9116095, 'binary_f1_score': 0.95505613}
confusion matrix:
      0     1
0  1382   134
1    10  1530
---- Validation: 
scalar performance:
{'acc': 0.786385, 'precision': 0.8043717, 'recall': 0.7895459, 'specificity': 0.7895459, 'f1': 0.78432167, 'auroc': 0.9041031, 'binary_precision': 0.7234315, 'binary_recall': 0.9083601, 'binary_specificity': 0.6707317, 'binary_f1_score': 0.80541706}
confusion matrix:
     0    1
0  440  216
1   57  565
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7152778, 'precision': 0.7786362, 'recall': 0.7152778, 'specificity': 0.7152778, 'f1': 0.69811666, 'auroc': 0.9232253, 'binary_precision': 0.64576805, 'binary_recall': 0.9537037, 'binary_specificity': 0.47685185, 'binary_f1_score': 0.77009344}
confusion matrix:
     0    1
0  103  113
1   10  206
early stop counter: 3
val acc:0.7863849997520447, best validation acc: 0.8575899600982666, corresponding to test acc:                         0.8287037014961243 / 0.8564814925193787
after epoch: 12,now: 2024-07-27 03:39:31.746768,epoch time: 0:01:20.530120,used: 0:16:16.972513,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_03_23_13_seed_2_23090496
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.98920155, 'precision': 0.98919386, 'recall': 0.9892137, 'specificity': 0.9892137, 'f1': 0.9892011, 'auroc': 0.99938107, 'binary_precision': 0.9908795, 'binary_recall': 0.9876623, 'binary_specificity': 0.99076515, 'binary_f1_score': 0.98926824}
confusion matrix:
      0     1
0  1502    14
1    19  1521
---- Validation: 
scalar performance:
{'acc': 0.79812205, 'precision': 0.81676054, 'recall': 0.7948127, 'specificity': 0.7948127, 'f1': 0.7937534, 'auroc': 0.88361454, 'binary_precision': 0.88723403, 'binary_recall': 0.670418, 'binary_specificity': 0.91920733, 'binary_f1_score': 0.7637363}
confusion matrix:
     0    1
0  603   53
1  205  417
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8263889, 'precision': 0.8398576, 'recall': 0.8263889, 'specificity': 0.8263889, 'f1': 0.8246516, 'auroc': 0.8982768, 'binary_precision': 0.90751445, 'binary_recall': 0.7268519, 'binary_specificity': 0.9259259, 'binary_f1_score': 0.807198}
confusion matrix:
     0    1
0  200   16
1   59  157
early stop counter: 4
val acc:0.7981220483779907, best validation acc: 0.8575899600982666, corresponding to test acc:                         0.8287037014961243 / 0.8564814925193787
after epoch: 13,now: 2024-07-27 03:40:52.054275,epoch time: 0:01:20.307507,used: 0:17:37.280020,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_03_23_13_seed_2_23090496
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9849476, 'precision': 0.9850056, 'recall': 0.98491585, 'specificity': 0.98491585, 'f1': 0.9849456, 'auroc': 0.99924016, 'binary_precision': 0.9813144, 'binary_recall': 0.98896104, 'binary_specificity': 0.9808707, 'binary_f1_score': 0.9851229}
confusion matrix:
      0     1
0  1487    29
1    17  1523
---- Validation: 
scalar performance:
{'acc': 0.7762128, 'precision': 0.8057512, 'recall': 0.77197134, 'specificity': 0.77197134, 'f1': 0.76872206, 'auroc': 0.8749682, 'binary_precision': 0.8943662, 'binary_recall': 0.6125402, 'binary_specificity': 0.93140244, 'binary_f1_score': 0.72709924}
confusion matrix:
     0    1
0  611   45
1  241  381
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8356481, 'precision': 0.83949745, 'recall': 0.8356482, 'specificity': 0.8356482, 'f1': 0.83518094, 'auroc': 0.90828615, 'binary_precision': 0.87564766, 'binary_recall': 0.7824074, 'binary_specificity': 0.8888889, 'binary_f1_score': 0.8264058}
confusion matrix:
     0    1
0  192   24
1   47  169
early stop counter: 5
val acc:0.7762128114700317, best validation acc: 0.8575899600982666, corresponding to test acc:                         0.8287037014961243 / 0.8564814925193787
after epoch: 14,now: 2024-07-27 03:42:12.384371,epoch time: 0:01:20.330096,used: 0:18:57.610116,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_03_23_13_seed_2_23090496
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 14 with time: 0:18:57.610116 at 2024-07-27 03:42:12.384371
persisted model performance metric: 

scalar performance:
{'acc': 0.8287037, 'precision': 0.84293383, 'recall': 0.82870376, 'specificity': 0.82870376, 'f1': 0.8269081, 'auroc': 0.8956405, 'binary_precision': 0.9127907, 'binary_recall': 0.7268519, 'binary_specificity': 0.9305556, 'binary_f1_score': 0.80927837}
confusion matrix:
     0    1
0  201   15
1   59  157
oracle model performance metric: 

scalar performance:
{'acc': 0.8564815, 'precision': 0.85897434, 'recall': 0.85648143, 'specificity': 0.85648143, 'f1': 0.8562319, 'auroc': 0.924147, 'binary_precision': 0.8888889, 'binary_recall': 0.8148148, 'binary_specificity': 0.8981481, 'binary_f1_score': 0.85024154}
confusion matrix:
     0    1
0  194   22
1   40  176
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_diva_irm_3seeds_nofreeze_2024-07-27_01-18-02/rule_results/17.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_diva_irm_3seeds_nofreeze_2024-07-27_01-18-02/confusion_matrix/17.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   1399 MiB |  14170 MiB |  81630 GiB |  81629 GiB |
|       from large pool |   1339 MiB |  14111 MiB |  80608 GiB |  80606 GiB |
|       from small pool |     60 MiB |    100 MiB |   1022 GiB |   1022 GiB |
|---------------------------------------------------------------------------|
| Active memory         |   1399 MiB |  14170 MiB |  81630 GiB |  81629 GiB |
|       from large pool |   1339 MiB |  14111 MiB |  80608 GiB |  80606 GiB |
|       from small pool |     60 MiB |    100 MiB |   1022 GiB |   1022 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |   1388 MiB |  14164 MiB |  81555 GiB |  81553 GiB |
|       from large pool |   1327 MiB |  14105 MiB |  80534 GiB |  80533 GiB |
|       from small pool |     60 MiB |    100 MiB |   1020 GiB |   1020 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  15218 MiB |  15302 MiB |  39170 MiB |  23952 MiB |
|       from large pool |  15112 MiB |  15196 MiB |  38992 MiB |  23880 MiB |
|       from small pool |    106 MiB |    110 MiB |    178 MiB |     72 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |   2008 MiB |   3236 MiB |  64012 GiB |  64010 GiB |
|       from large pool |   1996 MiB |   3226 MiB |  62985 GiB |  62983 GiB |
|       from small pool |     11 MiB |     43 MiB |   1027 GiB |   1027 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    1792    |    3107    |   14722 K  |   14720 K  |
|       from large pool |     269    |    1495    |    7292 K  |    7291 K  |
|       from small pool |    1523    |    2231    |    7430 K  |    7428 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    1792    |    3107    |   14722 K  |   14720 K  |
|       from large pool |     269    |    1495    |    7292 K  |    7291 K  |
|       from small pool |    1523    |    2231    |    7430 K  |    7428 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     551    |     589    |    1507    |     956    |
|       from large pool |     498    |     536    |    1418    |     920    |
|       from small pool |      53    |      55    |      89    |      36    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     136    |     576    |    9236 K  |    9236 K  |
|       from large pool |      58    |     532    |    5237 K  |    5237 K  |
|       from small pool |      78    |     235    |    3998 K  |    3998 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  14170 MiB |  81630 GiB |  81630 GiB |
|       from large pool |  16640 KiB |  14111 MiB |  80608 GiB |  80608 GiB |
|       from small pool |      0 KiB |    100 MiB |   1022 GiB |   1022 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  14170 MiB |  81630 GiB |  81630 GiB |
|       from large pool |  16640 KiB |  14111 MiB |  80608 GiB |  80608 GiB |
|       from small pool |      0 KiB |    100 MiB |   1022 GiB |   1022 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  14164 MiB |  81555 GiB |  81555 GiB |
|       from large pool |  16640 KiB |  14105 MiB |  80534 GiB |  80534 GiB |
|       from small pool |      0 KiB |    100 MiB |   1020 GiB |   1020 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   3408 MiB |  15302 MiB |  39170 MiB |  35762 MiB |
|       from large pool |   3336 MiB |  15196 MiB |  38992 MiB |  35656 MiB |
|       from small pool |     72 MiB |    110 MiB |    178 MiB |    106 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   3236 MiB |  64013 GiB |  64013 GiB |
|       from large pool |  24320 KiB |   3226 MiB |  62986 GiB |  62986 GiB |
|       from small pool |      0 KiB |     45 MiB |   1027 GiB |   1027 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3107    |   14722 K  |   14722 K  |
|       from large pool |       2    |    1495    |    7292 K  |    7292 K  |
|       from small pool |       0    |    2231    |    7430 K  |    7430 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3107    |   14722 K  |   14722 K  |
|       from large pool |       2    |    1495    |    7292 K  |    7292 K  |
|       from small pool |       0    |    2231    |    7430 K  |    7430 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      97    |     589    |    1507    |    1410    |
|       from large pool |      61    |     536    |    1418    |    1357    |
|       from small pool |      36    |      55    |      89    |      53    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       2    |     576    |    9236 K  |    9236 K  |
|       from large pool |       2    |     532    |    5237 K  |    5237 K  |
|       from small pool |       0    |     235    |    3998 K  |    3998 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Sat Jul 27 03:42:22 2024]
Finished job 0.
1 of 1 steps (100%) done
