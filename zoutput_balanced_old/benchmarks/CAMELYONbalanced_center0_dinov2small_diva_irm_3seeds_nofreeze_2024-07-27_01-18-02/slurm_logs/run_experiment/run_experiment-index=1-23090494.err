Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Sat Jul 27 02:38:26 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_diva_irm_3seeds_nofreeze_2024-07-27_01-18-02/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_diva_irm_3seeds_nofreeze_2024-07-27_01-18-02/rule_results/1.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=1
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/swiglu_ffn.py:51: UserWarning: xFormers is not available (SwiGLU)
  warnings.warn("xFormers is not available (SwiGLU)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/attention.py:33: UserWarning: xFormers is not available (Attention)
  warnings.warn("xFormers is not available (Attention)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/block.py:40: UserWarning: xFormers is not available (Block)
  warnings.warn("xFormers is not available (Block)")
Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main

using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_02_39_12_seed_0_23090494

 Experiment start at: 2024-07-27 02:39:13.291483
hyper-parameter scheduler not set,going to use default Warmpup and epoch update
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
before training, model accuracy: 0.5186046361923218
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/autograd/graph.py:744: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9534505, 'precision': 0.95407486, 'recall': 0.95372665, 'specificity': 0.95372665, 'f1': 0.95344687, 'auroc': 0.989512, 'binary_precision': 0.9744795, 'binary_recall': 0.93251926, 'binary_specificity': 0.97493404, 'binary_f1_score': 0.95303774}
confusion matrix:
      0     1
0  1478    38
1   105  1451
---- Validation: 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
scalar performance:
{'acc': 0.70652175, 'precision': 0.78812015, 'recall': 0.7101976, 'specificity': 0.7101976, 'f1': 0.6864339, 'auroc': 0.9022657, 'binary_precision': 0.6312564, 'binary_recall': 0.97322834, 'binary_specificity': 0.44716692, 'binary_f1_score': 0.7657993}
confusion matrix:
     0    1
0  292  361
1   17  618
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.69534886, 'precision': 0.76634026, 'recall': 0.69534886, 'specificity': 0.69534886, 'f1': 0.67359877, 'auroc': 0.8862088, 'binary_precision': 0.62883437, 'binary_recall': 0.95348835, 'binary_specificity': 0.4372093, 'binary_f1_score': 0.75785583}
confusion matrix:
    0    1
0  94  121
1  10  205
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-27 02:41:39.987658,epoch time: 0:02:26.696175,used: 0:02:26.696175,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_02_39_12_seed_0_23090494
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9238281, 'precision': 0.932899, 'recall': 0.92489445, 'specificity': 0.92489445, 'f1': 0.9235418, 'auroc': 0.9891424, 'binary_precision': 0.9992458, 'binary_recall': 0.8504493, 'binary_specificity': 0.9993395, 'binary_f1_score': 0.91886264}
confusion matrix:
      0     1
0  1513     1
1   233  1325
---- Validation: 
scalar performance:
{'acc': 0.71118015, 'precision': 0.7366512, 'recall': 0.70882297, 'specificity': 0.70882297, 'f1': 0.70166695, 'auroc': 0.84561145, 'binary_precision': 0.8108747, 'binary_recall': 0.5401575, 'binary_specificity': 0.8774885, 'binary_f1_score': 0.64839315}
confusion matrix:
     0    1
0  573   80
1  292  343
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7906977, 'precision': 0.80594707, 'recall': 0.7906977, 'specificity': 0.7906977, 'f1': 0.7880567, 'auroc': 0.8710438, 'binary_precision': 0.8742515, 'binary_recall': 0.67906976, 'binary_specificity': 0.9023256, 'binary_f1_score': 0.7643979}
confusion matrix:
     0    1
0  194   21
1   69  146
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-07-27 02:44:02.517564,epoch time: 0:02:22.529906,used: 0:04:49.226081,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_02_39_12_seed_0_23090494
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.94889325, 'precision': 0.95290685, 'recall': 0.9494699, 'specificity': 0.9494699, 'f1': 0.94881904, 'auroc': 0.9946205, 'binary_precision': 0.99857247, 'binary_recall': 0.9002574, 'binary_specificity': 0.9986825, 'binary_f1_score': 0.94686973}
confusion matrix:
      0     1
0  1516     2
1   155  1399
---- Validation: 
scalar performance:
{'acc': 0.51086956, 'precision': 0.5878502, 'recall': 0.50404555, 'specificity': 0.50404555, 'f1': 0.3518332, 'auroc': 0.812227, 'binary_precision': 0.6666667, 'binary_recall': 0.015748031, 'binary_specificity': 0.992343, 'binary_f1_score': 0.03076923}
confusion matrix:
     0   1
0  648   5
1  625  10
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5, 'precision': 0.25, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.33333334, 'auroc': 0.85179013, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
     0  1
0  215  0
1  215  0
early stop counter: 1
val acc:0.510869562625885, best validation acc: 0.7111801505088806, corresponding to test acc:                         0.7906976938247681 / 0.7906976938247681
after epoch: 3,now: 2024-07-27 02:46:23.536941,epoch time: 0:02:21.019377,used: 0:07:10.245458,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_02_39_12_seed_0_23090494
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9716797, 'precision': 0.97165823, 'recall': 0.9716972, 'specificity': 0.9716972, 'f1': 0.97167516, 'auroc': 0.99552995, 'binary_precision': 0.9735995, 'binary_recall': 0.97047496, 'binary_specificity': 0.9729194, 'binary_f1_score': 0.9720347}
confusion matrix:
      0     1
0  1473    41
1    46  1512
---- Validation: 
scalar performance:
{'acc': 0.7003106, 'precision': 0.7076849, 'recall': 0.7015543, 'specificity': 0.7015543, 'f1': 0.6984192, 'auroc': 0.7878574, 'binary_precision': 0.66490066, 'binary_recall': 0.7905512, 'binary_specificity': 0.6125574, 'binary_f1_score': 0.72230214}
confusion matrix:
     0    1
0  400  253
1  133  502
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.75348836, 'precision': 0.8017719, 'recall': 0.75348836, 'specificity': 0.75348836, 'f1': 0.74321705, 'auroc': 0.8766955, 'binary_precision': 0.6810631, 'binary_recall': 0.95348835, 'binary_specificity': 0.5534884, 'binary_f1_score': 0.7945736}
confusion matrix:
     0    1
0  119   96
1   10  205
early stop counter: 2
val acc:0.7003105878829956, best validation acc: 0.7111801505088806, corresponding to test acc:                         0.7906976938247681 / 0.7906976938247681
after epoch: 4,now: 2024-07-27 02:48:44.406324,epoch time: 0:02:20.869383,used: 0:09:31.114841,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_02_39_12_seed_0_23090494
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9671224, 'precision': 0.96723413, 'recall': 0.9670489, 'specificity': 0.9670489, 'f1': 0.9671118, 'auroc': 0.9958545, 'binary_precision': 0.9624682, 'binary_recall': 0.97299033, 'binary_specificity': 0.96110743, 'binary_f1_score': 0.96770066}
confusion matrix:
      0     1
0  1458    59
1    42  1513
---- Validation: 
scalar performance:
{'acc': 0.71506214, 'precision': 0.7880018, 'recall': 0.7115011, 'specificity': 0.7115011, 'f1': 0.6935844, 'auroc': 0.8981756, 'binary_precision': 0.92948717, 'binary_recall': 0.4566929, 'binary_specificity': 0.96630937, 'binary_f1_score': 0.6124604}
confusion matrix:
     0    1
0  631   22
1  345  290
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7372093, 'precision': 0.82341313, 'recall': 0.7372093, 'specificity': 0.7372093, 'f1': 0.7184478, 'auroc': 0.9174905, 'binary_precision': 0.99038464, 'binary_recall': 0.47906977, 'binary_specificity': 0.9953488, 'binary_f1_score': 0.64576805}
confusion matrix:
     0    1
0  214    1
1  112  103
better model found
persisted
after epoch: 5,now: 2024-07-27 02:51:06.066593,epoch time: 0:02:21.660269,used: 0:11:52.775110,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_02_39_12_seed_0_23090494
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9690755, 'precision': 0.970155, 'recall': 0.9687947, 'specificity': 0.9687947, 'f1': 0.9690394, 'auroc': 0.99805164, 'binary_precision': 0.9506478, 'binary_recall': 0.9903599, 'binary_specificity': 0.94722956, 'binary_f1_score': 0.9700976}
confusion matrix:
      0     1
0  1436    80
1    15  1541
---- Validation: 
scalar performance:
{'acc': 0.75, 'precision': 0.782629, 'recall': 0.7523387, 'specificity': 0.7523387, 'f1': 0.74369586, 'auroc': 0.8637415, 'binary_precision': 0.6830409, 'binary_recall': 0.91968507, 'binary_specificity': 0.58499235, 'binary_f1_score': 0.78389263}
confusion matrix:
     0    1
0  382  271
1   51  584
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7139535, 'precision': 0.7631999, 'recall': 0.7139535, 'specificity': 0.7139535, 'f1': 0.6999166, 'auroc': 0.8533099, 'binary_precision': 0.64935064, 'binary_recall': 0.9302326, 'binary_specificity': 0.4976744, 'binary_f1_score': 0.7648184}
confusion matrix:
     0    1
0  107  108
1   15  200
better model found
persisted
after epoch: 6,now: 2024-07-27 02:53:27.887619,epoch time: 0:02:21.821026,used: 0:14:14.596136,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_02_39_12_seed_0_23090494
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.97233075, 'precision': 0.9723211, 'recall': 0.97232974, 'specificity': 0.97232974, 'f1': 0.9723253, 'auroc': 0.99641854, 'binary_precision': 0.973025, 'binary_recall': 0.9724005, 'binary_specificity': 0.9722589, 'binary_f1_score': 0.9727127}
confusion matrix:
      0     1
0  1472    42
1    43  1515
---- Validation: 
scalar performance:
{'acc': 0.7996894, 'precision': 0.80267906, 'recall': 0.8003666, 'specificity': 0.8003666, 'f1': 0.7994109, 'auroc': 0.8818439, 'binary_precision': 0.7689016, 'binary_recall': 0.8488189, 'binary_specificity': 0.75191426, 'binary_f1_score': 0.80688626}
confusion matrix:
     0    1
0  491  162
1   96  539
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7883721, 'precision': 0.80702966, 'recall': 0.78837204, 'specificity': 0.78837204, 'f1': 0.78510743, 'auroc': 0.91322875, 'binary_precision': 0.73134327, 'binary_recall': 0.9116279, 'binary_specificity': 0.66511625, 'binary_f1_score': 0.8115942}
confusion matrix:
     0    1
0  143   72
1   19  196
better model found
persisted
after epoch: 7,now: 2024-07-27 02:55:49.097972,epoch time: 0:02:21.210353,used: 0:16:35.806489,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_02_39_12_seed_0_23090494
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9794922, 'precision': 0.9795259, 'recall': 0.97945905, 'specificity': 0.97945905, 'f1': 0.97948736, 'auroc': 0.9985277, 'binary_precision': 0.9776072, 'binary_recall': 0.9820051, 'binary_specificity': 0.9769129, 'binary_f1_score': 0.9798012}
confusion matrix:
      0     1
0  1481    35
1    28  1528
---- Validation: 
scalar performance:
{'acc': 0.878882, 'precision': 0.88229287, 'recall': 0.8782289, 'specificity': 0.8782289, 'f1': 0.87845886, 'auroc': 0.931929, 'binary_precision': 0.915078, 'binary_recall': 0.83149606, 'binary_specificity': 0.9249617, 'binary_f1_score': 0.8712871}
confusion matrix:
     0    1
0  604   49
1  107  528
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8627907, 'precision': 0.87266666, 'recall': 0.8627907, 'specificity': 0.8627907, 'f1': 0.8618756, 'auroc': 0.93157375, 'binary_precision': 0.93333334, 'binary_recall': 0.7813954, 'binary_specificity': 0.94418603, 'binary_f1_score': 0.8506329}
confusion matrix:
     0    1
0  203   12
1   47  168
new oracle model saved
better model found
persisted
after epoch: 8,now: 2024-07-27 02:58:11.460202,epoch time: 0:02:22.362230,used: 0:18:58.168719,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_02_39_12_seed_0_23090494
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9840495, 'precision': 0.98411334, 'recall': 0.9840027, 'specificity': 0.9840027, 'f1': 0.9840454, 'auroc': 0.99902415, 'binary_precision': 0.9808429, 'binary_recall': 0.98778135, 'binary_specificity': 0.98022413, 'binary_f1_score': 0.9842999}
confusion matrix:
      0     1
0  1487    30
1    19  1536
---- Validation: 
scalar performance:
{'acc': 0.84782606, 'precision': 0.8554736, 'recall': 0.84679794, 'specificity': 0.84679794, 'f1': 0.84670806, 'auroc': 0.925092, 'binary_precision': 0.9042357, 'binary_recall': 0.77322835, 'binary_specificity': 0.92036754, 'binary_f1_score': 0.8336163}
confusion matrix:
     0    1
0  601   52
1  144  491
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.82325584, 'precision': 0.8348459, 'recall': 0.8232558, 'specificity': 0.8232558, 'f1': 0.82171303, 'auroc': 0.89804757, 'binary_precision': 0.8971428, 'binary_recall': 0.73023254, 'binary_specificity': 0.9162791, 'binary_f1_score': 0.80512816}
confusion matrix:
     0    1
0  197   18
1   58  157
early stop counter: 1
val acc:0.8478260636329651, best validation acc: 0.8788819909095764, corresponding to test acc:                         0.8627907037734985 / 0.8627907037734985
after epoch: 9,now: 2024-07-27 03:00:31.708369,epoch time: 0:02:20.248167,used: 0:21:18.416886,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_02_39_12_seed_0_23090494
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9713542, 'precision': 0.97253966, 'recall': 0.9716784, 'specificity': 0.9716784, 'f1': 0.97134656, 'auroc': 0.99877703, 'binary_precision': 0.9993188, 'binary_recall': 0.94401544, 'binary_specificity': 0.99934125, 'binary_f1_score': 0.9708802}
confusion matrix:
      0     1
0  1517     1
1    87  1467
---- Validation: 
scalar performance:
{'acc': 0.5745342, 'precision': 0.7462671, 'recall': 0.56861246, 'specificity': 0.56861246, 'f1': 0.47709304, 'auroc': 0.8551742, 'binary_precision': 0.9484536, 'binary_recall': 0.14488189, 'binary_specificity': 0.992343, 'binary_f1_score': 0.25136614}
confusion matrix:
     0   1
0  648   5
1  543  92
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6232558, 'precision': 0.7679789, 'recall': 0.62325585, 'specificity': 0.62325585, 'f1': 0.5644508, 'auroc': 0.89704704, 'binary_precision': 0.9649123, 'binary_recall': 0.25581396, 'binary_specificity': 0.9906977, 'binary_f1_score': 0.40441176}
confusion matrix:
     0   1
0  213   2
1  160  55
early stop counter: 2
val acc:0.5745341777801514, best validation acc: 0.8788819909095764, corresponding to test acc:                         0.8627907037734985 / 0.8627907037734985
after epoch: 10,now: 2024-07-27 03:02:51.969004,epoch time: 0:02:20.260635,used: 0:23:38.677521,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_02_39_12_seed_0_23090494
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9781901, 'precision': 0.9786247, 'recall': 0.978428, 'specificity': 0.978428, 'f1': 0.97818947, 'auroc': 0.9981762, 'binary_precision': 0.99666446, 'binary_recall': 0.96015424, 'binary_specificity': 0.99670184, 'binary_f1_score': 0.97806877}
confusion matrix:
      0     1
0  1511     5
1    62  1494
---- Validation: 
scalar performance:
{'acc': 0.8447205, 'precision': 0.8475559, 'recall': 0.8440825, 'specificity': 0.8440825, 'f1': 0.8442062, 'auroc': 0.9127395, 'binary_precision': 0.87564766, 'binary_recall': 0.7984252, 'binary_specificity': 0.8897397, 'binary_f1_score': 0.8352554}
confusion matrix:
     0    1
0  581   72
1  128  507
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.83255816, 'precision': 0.8335973, 'recall': 0.83255816, 'specificity': 0.83255816, 'f1': 0.8324276, 'auroc': 0.927139, 'binary_precision': 0.81497794, 'binary_recall': 0.8604651, 'binary_specificity': 0.80465114, 'binary_f1_score': 0.8371041}
confusion matrix:
     0    1
0  173   42
1   30  185
early stop counter: 3
val acc:0.8447204828262329, best validation acc: 0.8788819909095764, corresponding to test acc:                         0.8627907037734985 / 0.8627907037734985
after epoch: 11,now: 2024-07-27 03:05:12.531633,epoch time: 0:02:20.562629,used: 0:25:59.240150,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_02_39_12_seed_0_23090494
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.97753906, 'precision': 0.9777433, 'recall': 0.9774219, 'specificity': 0.9774219, 'f1': 0.97752774, 'auroc': 0.99807984, 'binary_precision': 0.9709229, 'binary_recall': 0.98524696, 'binary_specificity': 0.9695968, 'binary_f1_score': 0.97803247}
confusion matrix:
      0     1
0  1467    46
1    23  1536
---- Validation: 
scalar performance:
{'acc': 0.8113354, 'precision': 0.8118532, 'recall': 0.81161326, 'specificity': 0.81161326, 'f1': 0.8113217, 'auroc': 0.87921286, 'binary_precision': 0.79518074, 'binary_recall': 0.83149606, 'binary_specificity': 0.79173046, 'binary_f1_score': 0.8129331}
confusion matrix:
     0    1
0  517  136
1  107  528
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.89069766, 'precision': 0.8907061, 'recall': 0.89069766, 'specificity': 0.89069766, 'f1': 0.89069706, 'auroc': 0.9438832, 'binary_precision': 0.8888889, 'binary_recall': 0.89302325, 'binary_specificity': 0.88837206, 'binary_f1_score': 0.8909513}
confusion matrix:
     0    1
0  191   24
1   23  192
new oracle model saved
early stop counter: 4
val acc:0.8113353848457336, best validation acc: 0.8788819909095764, corresponding to test acc:                         0.8627907037734985 / 0.8906976580619812
after epoch: 12,now: 2024-07-27 03:07:33.029075,epoch time: 0:02:20.497442,used: 0:28:19.737592,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_02_39_12_seed_0_23090494
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9869792, 'precision': 0.98706484, 'recall': 0.98713505, 'specificity': 0.98713505, 'f1': 0.986979, 'auroc': 0.9992602, 'binary_precision': 0.9980315, 'binary_recall': 0.9762516, 'binary_specificity': 0.9980185, 'binary_f1_score': 0.9870214}
confusion matrix:
      0     1
0  1511     3
1    37  1521
---- Validation: 
scalar performance:
{'acc': 0.8113354, 'precision': 0.8126777, 'recall': 0.8108536, 'specificity': 0.8108536, 'f1': 0.8109387, 'auroc': 0.8835273, 'binary_precision': 0.8299663, 'binary_recall': 0.776378, 'binary_specificity': 0.8453292, 'binary_f1_score': 0.80227834}
confusion matrix:
     0    1
0  552  101
1  142  493
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.84418607, 'precision': 0.8443723, 'recall': 0.84418607, 'specificity': 0.84418607, 'f1': 0.84416497, 'auroc': 0.9086858, 'binary_precision': 0.85238093, 'binary_recall': 0.83255816, 'binary_specificity': 0.855814, 'binary_f1_score': 0.8423529}
confusion matrix:
     0    1
0  184   31
1   36  179
early stop counter: 5
val acc:0.8113353848457336, best validation acc: 0.8788819909095764, corresponding to test acc:                         0.8627907037734985 / 0.8906976580619812
after epoch: 13,now: 2024-07-27 03:09:52.797282,epoch time: 0:02:19.768207,used: 0:30:39.505799,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_02_39_12_seed_0_23090494
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 13 with time: 0:30:39.505799 at 2024-07-27 03:09:52.797282
persisted model performance metric: 

scalar performance:
{'acc': 0.8627907, 'precision': 0.87266666, 'recall': 0.8627907, 'specificity': 0.8627907, 'f1': 0.8618756, 'auroc': 0.93157375, 'binary_precision': 0.93333334, 'binary_recall': 0.7813954, 'binary_specificity': 0.94418603, 'binary_f1_score': 0.8506329}
confusion matrix:
     0    1
0  203   12
1   47  168
oracle model performance metric: 

scalar performance:
{'acc': 0.89069766, 'precision': 0.8907061, 'recall': 0.89069766, 'specificity': 0.89069766, 'f1': 0.89069706, 'auroc': 0.9438832, 'binary_precision': 0.8888889, 'binary_recall': 0.89302325, 'binary_specificity': 0.88837206, 'binary_f1_score': 0.8909513}
confusion matrix:
     0    1
0  191   24
1   23  192
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_diva_irm_3seeds_nofreeze_2024-07-27_01-18-02/rule_results/1.csv
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_diva_irm_3seeds_nofreeze_2024-07-27_01-18-02/rule_results/1.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_diva_irm_3seeds_nofreeze_2024-07-27_01-18-02/confusion_matrix/1.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   2426 MiB |   8858 MiB |  80843 GiB |  80840 GiB |
|       from large pool |   2336 MiB |   8783 MiB |  80084 GiB |  80082 GiB |
|       from small pool |     89 MiB |    126 MiB |    758 GiB |    758 GiB |
|---------------------------------------------------------------------------|
| Active memory         |   2426 MiB |   8858 MiB |  80843 GiB |  80840 GiB |
|       from large pool |   2336 MiB |   8783 MiB |  80084 GiB |  80082 GiB |
|       from small pool |     89 MiB |    126 MiB |    758 GiB |    758 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |   2409 MiB |   8848 MiB |  80775 GiB |  80773 GiB |
|       from large pool |   2320 MiB |   8774 MiB |  80018 GiB |  80015 GiB |
|       from small pool |     89 MiB |    126 MiB |    757 GiB |    757 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   9366 MiB |   9366 MiB |   9366 MiB |      0 B   |
|       from large pool |   9232 MiB |   9232 MiB |   9232 MiB |      0 B   |
|       from small pool |    134 MiB |    134 MiB |    134 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |   1223 MiB |   1832 MiB |  70377 GiB |  70376 GiB |
|       from large pool |   1213 MiB |   1826 MiB |  69595 GiB |  69594 GiB |
|       from small pool |     10 MiB |     21 MiB |    781 GiB |    781 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    2464    |    3317    |   12343 K  |   12340 K  |
|       from large pool |     392    |     816    |    6172 K  |    6171 K  |
|       from small pool |    2072    |    2768    |    6170 K  |    6168 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    2464    |    3317    |   12343 K  |   12340 K  |
|       from large pool |     392    |     816    |    6172 K  |    6171 K  |
|       from small pool |    2072    |    2768    |    6170 K  |    6168 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     267    |     267    |     267    |       0    |
|       from large pool |     200    |     200    |     200    |       0    |
|       from small pool |      67    |      67    |      67    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     164    |     308    |    6299 K  |    6299 K  |
|       from large pool |      71    |     183    |    3269 K  |    3269 K  |
|       from small pool |      93    |     237    |    3029 K  |    3029 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   8858 MiB |  80843 GiB |  80843 GiB |
|       from large pool |  16640 KiB |   8783 MiB |  80084 GiB |  80084 GiB |
|       from small pool |      0 KiB |    126 MiB |    758 GiB |    758 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   8858 MiB |  80843 GiB |  80843 GiB |
|       from large pool |  16640 KiB |   8783 MiB |  80084 GiB |  80084 GiB |
|       from small pool |      0 KiB |    126 MiB |    758 GiB |    758 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   8848 MiB |  80775 GiB |  80775 GiB |
|       from large pool |  16640 KiB |   8774 MiB |  80018 GiB |  80018 GiB |
|       from small pool |      0 KiB |    126 MiB |    757 GiB |    757 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   3650 MiB |   9366 MiB |   9366 MiB |   5716 MiB |
|       from large pool |   3550 MiB |   9232 MiB |   9232 MiB |   5682 MiB |
|       from small pool |    100 MiB |    134 MiB |    134 MiB |     34 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1832 MiB |  70379 GiB |  70379 GiB |
|       from large pool |  24320 KiB |   1826 MiB |  69597 GiB |  69596 GiB |
|       from small pool |      0 KiB |     46 MiB |    782 GiB |    782 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3317    |   12343 K  |   12343 K  |
|       from large pool |       2    |     816    |    6172 K  |    6172 K  |
|       from small pool |       0    |    2768    |    6170 K  |    6170 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3317    |   12343 K  |   12343 K  |
|       from large pool |       2    |     816    |    6172 K  |    6172 K  |
|       from small pool |       0    |    2768    |    6170 K  |    6170 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     129    |     267    |     267    |     138    |
|       from large pool |      79    |     200    |     200    |     121    |
|       from small pool |      50    |      67    |      67    |      17    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |     308    |    6299 K  |    6299 K  |
|       from large pool |       4    |     183    |    3269 K  |    3269 K  |
|       from small pool |       0    |     237    |    3030 K  |    3030 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   8858 MiB |  80843 GiB |  80843 GiB |
|       from large pool |  16640 KiB |   8783 MiB |  80084 GiB |  80084 GiB |
|       from small pool |      0 KiB |    126 MiB |    758 GiB |    758 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   8858 MiB |  80843 GiB |  80843 GiB |
|       from large pool |  16640 KiB |   8783 MiB |  80084 GiB |  80084 GiB |
|       from small pool |      0 KiB |    126 MiB |    758 GiB |    758 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   8848 MiB |  80775 GiB |  80775 GiB |
|       from large pool |  16640 KiB |   8774 MiB |  80018 GiB |  80018 GiB |
|       from small pool |      0 KiB |    126 MiB |    757 GiB |    757 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   3650 MiB |   9366 MiB |   9366 MiB |   5716 MiB |
|       from large pool |   3550 MiB |   9232 MiB |   9232 MiB |   5682 MiB |
|       from small pool |    100 MiB |    134 MiB |    134 MiB |     34 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1832 MiB |  70379 GiB |  70379 GiB |
|       from large pool |  24320 KiB |   1826 MiB |  69597 GiB |  69596 GiB |
|       from small pool |      0 KiB |     46 MiB |    782 GiB |    782 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3317    |   12343 K  |   12343 K  |
|       from large pool |       2    |     816    |    6172 K  |    6172 K  |
|       from small pool |       0    |    2768    |    6170 K  |    6170 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3317    |   12343 K  |   12343 K  |
|       from large pool |       2    |     816    |    6172 K  |    6172 K  |
|       from small pool |       0    |    2768    |    6170 K  |    6170 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     129    |     267    |     267    |     138    |
|       from large pool |      79    |     200    |     200    |     121    |
|       from small pool |      50    |      67    |      67    |      17    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |     308    |    6299 K  |    6299 K  |
|       from large pool |       4    |     183    |    3269 K  |    3269 K  |
|       from small pool |       0    |     237    |    3030 K  |    3030 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main

using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_03_10_31_seed_1_23090494

 Experiment start at: 2024-07-27 03:10:32.736625
hyper-parameter scheduler not set,going to use default Warmpup and epoch update
before training, model accuracy: 0.5022222399711609
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.90755206, 'precision': 0.91670835, 'recall': 0.90660375, 'specificity': 0.90660375, 'f1': 0.906885, 'auroc': 0.9892649, 'binary_precision': 0.8581081, 'binary_recall': 0.97943443, 'binary_specificity': 0.8337731, 'binary_f1_score': 0.9147659}
confusion matrix:
      0     1
0  1264   252
1    32  1524
---- Validation: 
scalar performance:
{'acc': 0.74004686, 'precision': 0.7830292, 'recall': 0.74318993, 'specificity': 0.74318993, 'f1': 0.7313875, 'auroc': 0.84170866, 'binary_precision': 0.6685585, 'binary_recall': 0.9349206, 'binary_specificity': 0.5514593, 'binary_f1_score': 0.7796161}
confusion matrix:
     0    1
0  359  292
1   41  589
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.74666667, 'precision': 0.78236294, 'recall': 0.74666667, 'specificity': 0.74666667, 'f1': 0.7383988, 'auroc': 0.8622618, 'binary_precision': 0.6819672, 'binary_recall': 0.92444444, 'binary_specificity': 0.5688889, 'binary_f1_score': 0.7849056}
confusion matrix:
     0    1
0  128   97
1   17  208
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-27 03:12:57.252877,epoch time: 0:02:24.516252,used: 0:02:24.516252,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_03_10_31_seed_1_23090494
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.96451825, 'precision': 0.9658661, 'recall': 0.9648418, 'specificity': 0.9648418, 'f1': 0.96450603, 'auroc': 0.9952603, 'binary_precision': 0.99384403, 'binary_recall': 0.9356085, 'binary_specificity': 0.99407506, 'binary_f1_score': 0.9638474}
confusion matrix:
      0     1
0  1510     9
1   100  1453
---- Validation: 
scalar performance:
{'acc': 0.8165496, 'precision': 0.8239896, 'recall': 0.81528413, 'specificity': 0.81528413, 'f1': 0.81503284, 'auroc': 0.8884647, 'binary_precision': 0.86915886, 'binary_recall': 0.7380952, 'binary_specificity': 0.8924731, 'binary_f1_score': 0.7982833}
confusion matrix:
     0    1
0  581   70
1  165  465
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7866667, 'precision': 0.7918552, 'recall': 0.7866667, 'specificity': 0.7866667, 'f1': 0.78571427, 'auroc': 0.84811854, 'binary_precision': 0.83076924, 'binary_recall': 0.72, 'binary_specificity': 0.85333335, 'binary_f1_score': 0.7714286}
confusion matrix:
     0    1
0  192   33
1   63  162
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-07-27 03:15:18.483574,epoch time: 0:02:21.230697,used: 0:04:45.746949,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_03_10_31_seed_1_23090494
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.96972656, 'precision': 0.97032094, 'recall': 0.9699969, 'specificity': 0.9699969, 'f1': 0.96972454, 'auroc': 0.9960829, 'binary_precision': 0.9906103, 'binary_recall': 0.94922876, 'binary_specificity': 0.99076515, 'binary_f1_score': 0.96947813}
confusion matrix:
      0     1
0  1502    14
1    79  1477
---- Validation: 
scalar performance:
{'acc': 0.7392662, 'precision': 0.7695031, 'recall': 0.73645675, 'specificity': 0.73645675, 'f1': 0.73018587, 'auroc': 0.8505157, 'binary_precision': 0.8557692, 'binary_recall': 0.5650794, 'binary_specificity': 0.9078341, 'binary_f1_score': 0.6806884}
confusion matrix:
     0    1
0  591   60
1  274  356
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.75333333, 'precision': 0.7694328, 'recall': 0.75333333, 'specificity': 0.75333333, 'f1': 0.74959266, 'auroc': 0.8293531, 'binary_precision': 0.8352941, 'binary_recall': 0.6311111, 'binary_specificity': 0.8755556, 'binary_f1_score': 0.71898735}
confusion matrix:
     0    1
0  197   28
1   83  142
early stop counter: 1
val acc:0.7392662167549133, best validation acc: 0.8165495991706848, corresponding to test acc:                         0.7866666913032532 / 0.7866666913032532
after epoch: 3,now: 2024-07-27 03:17:37.963352,epoch time: 0:02:19.479778,used: 0:07:05.226727,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_03_10_31_seed_1_23090494
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9814453, 'precision': 0.9815179, 'recall': 0.98154753, 'specificity': 0.98154753, 'f1': 0.98144525, 'auroc': 0.99857223, 'binary_precision': 0.9908137, 'binary_recall': 0.9723117, 'binary_specificity': 0.9907834, 'binary_f1_score': 0.9814755}
confusion matrix:
      0     1
0  1505    14
1    43  1510
---- Validation: 
scalar performance:
{'acc': 0.8071819, 'precision': 0.8223916, 'recall': 0.80537635, 'specificity': 0.80537635, 'f1': 0.8042033, 'auroc': 0.88226295, 'binary_precision': 0.8884381, 'binary_recall': 0.6952381, 'binary_specificity': 0.9155146, 'binary_f1_score': 0.78005344}
confusion matrix:
     0    1
0  596   55
1  192  438
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.75555557, 'precision': 0.7847098, 'recall': 0.7555555, 'specificity': 0.7555555, 'f1': 0.74913335, 'auroc': 0.8734222, 'binary_precision': 0.875817, 'binary_recall': 0.59555554, 'binary_specificity': 0.91555554, 'binary_f1_score': 0.7089947}
confusion matrix:
     0    1
0  206   19
1   91  134
early stop counter: 2
val acc:0.8071818947792053, best validation acc: 0.8165495991706848, corresponding to test acc:                         0.7866666913032532 / 0.7866666913032532
after epoch: 4,now: 2024-07-27 03:19:57.850411,epoch time: 0:02:19.887059,used: 0:09:25.113786,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_03_10_31_seed_1_23090494
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.976237, 'precision': 0.9768827, 'recall': 0.97651696, 'specificity': 0.97651696, 'f1': 0.97623515, 'auroc': 0.9980835, 'binary_precision': 0.99798524, 'binary_recall': 0.95501286, 'binary_specificity': 0.9980211, 'binary_f1_score': 0.9760263}
confusion matrix:
      0     1
0  1513     3
1    70  1486
---- Validation: 
scalar performance:
{'acc': 0.7330211, 'precision': 0.7927947, 'recall': 0.7292627, 'specificity': 0.7292627, 'f1': 0.71652687, 'auroc': 0.8892449, 'binary_precision': 0.92105263, 'binary_recall': 0.5, 'binary_specificity': 0.95852536, 'binary_f1_score': 0.6481481}
confusion matrix:
     0    1
0  624   27
1  315  315
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7311111, 'precision': 0.80545115, 'recall': 0.7311111, 'specificity': 0.7311111, 'f1': 0.71369076, 'auroc': 0.8718914, 'binary_precision': 0.95614034, 'binary_recall': 0.48444444, 'binary_specificity': 0.9777778, 'binary_f1_score': 0.64306784}
confusion matrix:
     0    1
0  220    5
1  116  109
early stop counter: 3
val acc:0.733021080493927, best validation acc: 0.8165495991706848, corresponding to test acc:                         0.7866666913032532 / 0.7866666913032532
after epoch: 5,now: 2024-07-27 03:22:17.008129,epoch time: 0:02:19.157718,used: 0:11:44.271504,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_03_10_31_seed_1_23090494
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9742839, 'precision': 0.975204, 'recall': 0.974647, 'specificity': 0.974647, 'f1': 0.97428054, 'auroc': 0.9993446, 'binary_precision': 1.0, 'binary_recall': 0.949294, 'binary_specificity': 1.0, 'binary_f1_score': 0.9739875}
confusion matrix:
      0     1
0  1514     0
1    79  1479
---- Validation: 
scalar performance:
{'acc': 0.54332554, 'precision': 0.7340028, 'recall': 0.5357911, 'specificity': 0.5357911, 'f1': 0.4149822, 'auroc': 0.8961482, 'binary_precision': 0.9411765, 'binary_recall': 0.07619048, 'binary_specificity': 0.9953917, 'binary_f1_score': 0.14096916}
confusion matrix:
     0   1
0  648   3
1  582  48
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5422222, 'precision': 0.7610209, 'recall': 0.5422222, 'specificity': 0.5422222, 'f1': 0.42085662, 'auroc': 0.89281976, 'binary_precision': 1.0, 'binary_recall': 0.08444444, 'binary_specificity': 1.0, 'binary_f1_score': 0.1557377}
confusion matrix:
     0   1
0  225   0
1  206  19
early stop counter: 4
val acc:0.5433255434036255, best validation acc: 0.8165495991706848, corresponding to test acc:                         0.7866666913032532 / 0.7866666913032532
after epoch: 6,now: 2024-07-27 03:24:36.406596,epoch time: 0:02:19.398467,used: 0:14:03.669971,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_03_10_31_seed_1_23090494
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9710286, 'precision': 0.97203165, 'recall': 0.9713671, 'specificity': 0.9713671, 'f1': 0.97102344, 'auroc': 0.9969473, 'binary_precision': 0.9972881, 'binary_recall': 0.94537276, 'binary_specificity': 0.9973615, 'binary_f1_score': 0.9706367}
confusion matrix:
      0     1
0  1512     4
1    85  1471
---- Validation: 
scalar performance:
{'acc': 0.78454334, 'precision': 0.7974427, 'recall': 0.78279567, 'specificity': 0.78279567, 'f1': 0.78142524, 'auroc': 0.8661717, 'binary_precision': 0.85542166, 'binary_recall': 0.6761905, 'binary_specificity': 0.8894009, 'binary_f1_score': 0.7553191}
confusion matrix:
     0    1
0  579   72
1  204  426
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8288889, 'precision': 0.8413564, 'recall': 0.8288889, 'specificity': 0.8288889, 'f1': 0.8273121, 'auroc': 0.89017284, 'binary_precision': 0.9065934, 'binary_recall': 0.73333335, 'binary_specificity': 0.92444444, 'binary_f1_score': 0.8108108}
confusion matrix:
     0    1
0  208   17
1   60  165
new oracle model saved
early stop counter: 5
val acc:0.7845433354377747, best validation acc: 0.8165495991706848, corresponding to test acc:                         0.7866666913032532 / 0.8288888931274414
after epoch: 7,now: 2024-07-27 03:26:56.958761,epoch time: 0:02:20.552165,used: 0:16:24.222136,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_03_10_31_seed_1_23090494
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 7 with time: 0:16:24.222136 at 2024-07-27 03:26:56.958761
persisted model performance metric: 

scalar performance:
{'acc': 0.7866667, 'precision': 0.7918552, 'recall': 0.7866667, 'specificity': 0.7866667, 'f1': 0.78571427, 'auroc': 0.84811854, 'binary_precision': 0.83076924, 'binary_recall': 0.72, 'binary_specificity': 0.85333335, 'binary_f1_score': 0.7714286}
confusion matrix:
     0    1
0  192   33
1   63  162
oracle model performance metric: 

scalar performance:
{'acc': 0.8288889, 'precision': 0.8413564, 'recall': 0.8288889, 'specificity': 0.8288889, 'f1': 0.8273121, 'auroc': 0.89017284, 'binary_precision': 0.9065934, 'binary_recall': 0.73333335, 'binary_specificity': 0.92444444, 'binary_f1_score': 0.8108108}
confusion matrix:
     0    1
0  208   17
1   60  165
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_diva_irm_3seeds_nofreeze_2024-07-27_01-18-02/rule_results/1.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_diva_irm_3seeds_nofreeze_2024-07-27_01-18-02/confusion_matrix/1.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   2425 MiB |   8858 MiB | 124500 GiB | 124498 GiB |
|       from large pool |   2335 MiB |   8783 MiB | 123328 GiB | 123326 GiB |
|       from small pool |     89 MiB |    130 MiB |   1171 GiB |   1171 GiB |
|---------------------------------------------------------------------------|
| Active memory         |   2425 MiB |   8858 MiB | 124500 GiB | 124498 GiB |
|       from large pool |   2335 MiB |   8783 MiB | 123328 GiB | 123326 GiB |
|       from small pool |     89 MiB |    130 MiB |   1171 GiB |   1171 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |   2409 MiB |   8848 MiB | 124389 GiB | 124387 GiB |
|       from large pool |   2320 MiB |   8774 MiB | 123219 GiB | 123217 GiB |
|       from small pool |     89 MiB |    130 MiB |   1170 GiB |   1170 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   9332 MiB |   9366 MiB |  15048 MiB |   5716 MiB |
|       from large pool |   9192 MiB |   9232 MiB |  14874 MiB |   5682 MiB |
|       from small pool |    140 MiB |    140 MiB |    174 MiB |     34 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |   1164 MiB |   2382 MiB | 111575 GiB | 111574 GiB |
|       from large pool |   1156 MiB |   2374 MiB | 110367 GiB | 110366 GiB |
|       from small pool |      8 MiB |     46 MiB |   1208 GiB |   1208 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    2476    |    3329    |   19024 K  |   19021 K  |
|       from large pool |     392    |     816    |    9506 K  |    9506 K  |
|       from small pool |    2084    |    2780    |    9517 K  |    9515 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    2476    |    3329    |   19024 K  |   19021 K  |
|       from large pool |     392    |     816    |    9506 K  |    9506 K  |
|       from small pool |    2084    |    2780    |    9517 K  |    9515 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     234    |     267    |     372    |     138    |
|       from large pool |     164    |     200    |     285    |     121    |
|       from small pool |      70    |      70    |      87    |      17    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     168    |     313    |    9740 K  |    9739 K  |
|       from large pool |      75    |     183    |    4964 K  |    4964 K  |
|       from small pool |      93    |     238    |    4775 K  |    4775 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   8858 MiB | 124500 GiB | 124500 GiB |
|       from large pool |  16640 KiB |   8783 MiB | 123328 GiB | 123328 GiB |
|       from small pool |      0 KiB |    130 MiB |   1171 GiB |   1171 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   8858 MiB | 124500 GiB | 124500 GiB |
|       from large pool |  16640 KiB |   8783 MiB | 123328 GiB | 123328 GiB |
|       from small pool |      0 KiB |    130 MiB |   1171 GiB |   1171 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   8848 MiB | 124389 GiB | 124389 GiB |
|       from large pool |  16640 KiB |   8774 MiB | 123219 GiB | 123219 GiB |
|       from small pool |      0 KiB |    130 MiB |   1170 GiB |   1170 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   3590 MiB |   9366 MiB |  15048 MiB |  11458 MiB |
|       from large pool |   3492 MiB |   9232 MiB |  14874 MiB |  11382 MiB |
|       from small pool |     98 MiB |    140 MiB |    174 MiB |     76 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   2382 MiB | 111577 GiB | 111577 GiB |
|       from large pool |  24320 KiB |   2374 MiB | 110368 GiB | 110368 GiB |
|       from small pool |      0 KiB |     48 MiB |   1208 GiB |   1208 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3329    |   19024 K  |   19024 K  |
|       from large pool |       2    |     816    |    9506 K  |    9506 K  |
|       from small pool |       0    |    2780    |    9517 K  |    9517 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3329    |   19024 K  |   19024 K  |
|       from large pool |       2    |     816    |    9506 K  |    9506 K  |
|       from small pool |       0    |    2780    |    9517 K  |    9517 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     126    |     267    |     372    |     246    |
|       from large pool |      77    |     200    |     285    |     208    |
|       from small pool |      49    |      70    |      87    |      38    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |     313    |    9740 K  |    9740 K  |
|       from large pool |       4    |     183    |    4964 K  |    4964 K  |
|       from small pool |       0    |     238    |    4775 K  |    4775 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   8858 MiB | 124500 GiB | 124500 GiB |
|       from large pool |  16640 KiB |   8783 MiB | 123328 GiB | 123328 GiB |
|       from small pool |      0 KiB |    130 MiB |   1171 GiB |   1171 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   8858 MiB | 124500 GiB | 124500 GiB |
|       from large pool |  16640 KiB |   8783 MiB | 123328 GiB | 123328 GiB |
|       from small pool |      0 KiB |    130 MiB |   1171 GiB |   1171 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   8848 MiB | 124389 GiB | 124389 GiB |
|       from large pool |  16640 KiB |   8774 MiB | 123219 GiB | 123219 GiB |
|       from small pool |      0 KiB |    130 MiB |   1170 GiB |   1170 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   3590 MiB |   9366 MiB |  15048 MiB |  11458 MiB |
|       from large pool |   3492 MiB |   9232 MiB |  14874 MiB |  11382 MiB |
|       from small pool |     98 MiB |    140 MiB |    174 MiB |     76 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   2382 MiB | 111577 GiB | 111577 GiB |
|       from large pool |  24320 KiB |   2374 MiB | 110368 GiB | 110368 GiB |
|       from small pool |      0 KiB |     48 MiB |   1208 GiB |   1208 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3329    |   19024 K  |   19024 K  |
|       from large pool |       2    |     816    |    9506 K  |    9506 K  |
|       from small pool |       0    |    2780    |    9517 K  |    9517 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3329    |   19024 K  |   19024 K  |
|       from large pool |       2    |     816    |    9506 K  |    9506 K  |
|       from small pool |       0    |    2780    |    9517 K  |    9517 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     126    |     267    |     372    |     246    |
|       from large pool |      77    |     200    |     285    |     208    |
|       from small pool |      49    |      70    |      87    |      38    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |     313    |    9740 K  |    9740 K  |
|       from large pool |       4    |     183    |    4964 K  |    4964 K  |
|       from small pool |       0    |     238    |    4775 K  |    4775 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main

using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_03_27_35_seed_2_23090494

 Experiment start at: 2024-07-27 03:27:36.626310
hyper-parameter scheduler not set,going to use default Warmpup and epoch update
before training, model accuracy: 0.5
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.94208115, 'precision': 0.94376045, 'recall': 0.9418489, 'specificity': 0.9418489, 'f1': 0.9420019, 'auroc': 0.9914955, 'binary_precision': 0.9183548, 'binary_recall': 0.9714286, 'binary_specificity': 0.9122691, 'binary_f1_score': 0.94414645}
confusion matrix:
      0     1
0  1383   133
1    44  1496
---- Validation: 
scalar performance:
{'acc': 0.8341158, 'precision': 0.8521029, 'recall': 0.83108187, 'specificity': 0.83108187, 'f1': 0.8309827, 'auroc': 0.9035468, 'binary_precision': 0.9253112, 'binary_recall': 0.7170418, 'binary_specificity': 0.94512194, 'binary_f1_score': 0.80797094}
confusion matrix:
     0    1
0  620   36
1  176  446
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8356481, 'precision': 0.86685646, 'recall': 0.8356482, 'specificity': 0.8356482, 'f1': 0.83207685, 'auroc': 0.9063143, 'binary_precision': 0.9738562, 'binary_recall': 0.6898148, 'binary_specificity': 0.9814815, 'binary_f1_score': 0.80758804}
confusion matrix:
     0    1
0  212    4
1   67  149
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-27 03:29:59.648929,epoch time: 0:02:23.022619,used: 0:02:23.022619,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_03_27_35_seed_2_23090494
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.95222515, 'precision': 0.9541383, 'recall': 0.9519806, 'specificity': 0.9519806, 'f1': 0.9521538, 'auroc': 0.99428904, 'binary_precision': 0.9265606, 'binary_recall': 0.98311687, 'binary_specificity': 0.9208443, 'binary_f1_score': 0.95400125}
confusion matrix:
      0     1
0  1396   120
1    26  1514
---- Validation: 
scalar performance:
{'acc': 0.76760566, 'precision': 0.7752259, 'recall': 0.7697117, 'specificity': 0.7697117, 'f1': 0.76680255, 'auroc': 0.8482276, 'binary_precision': 0.7222982, 'binary_recall': 0.84887457, 'binary_specificity': 0.6905488, 'binary_f1_score': 0.78048784}
confusion matrix:
     0    1
0  453  203
1   94  528
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8425926, 'precision': 0.8440379, 'recall': 0.8425926, 'specificity': 0.8425926, 'f1': 0.84242713, 'auroc': 0.9002272, 'binary_precision': 0.86633664, 'binary_recall': 0.8101852, 'binary_specificity': 0.875, 'binary_f1_score': 0.8373206}
confusion matrix:
     0    1
0  189   27
1   41  175
new oracle model saved
early stop counter: 1
val acc:0.7676056623458862, best validation acc: 0.8341158032417297, corresponding to test acc:                         0.8356481194496155 / 0.8425925970077515
after epoch: 2,now: 2024-07-27 03:32:18.829472,epoch time: 0:02:19.180543,used: 0:04:42.203162,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_03_27_35_seed_2_23090494
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.97709423, 'precision': 0.977563, 'recall': 0.9772316, 'specificity': 0.9772316, 'f1': 0.977092, 'auroc': 0.9958842, 'binary_precision': 0.99461645, 'binary_recall': 0.9597403, 'binary_specificity': 0.99472296, 'binary_f1_score': 0.9768672}
confusion matrix:
      0     1
0  1508     8
1    62  1478
---- Validation: 
scalar performance:
{'acc': 0.68622845, 'precision': 0.7544522, 'recall': 0.67911094, 'specificity': 0.67911094, 'f1': 0.65836143, 'auroc': 0.82506275, 'binary_precision': 0.8797251, 'binary_recall': 0.41157556, 'binary_specificity': 0.94664633, 'binary_f1_score': 0.5607886}
confusion matrix:
     0    1
0  621   35
1  366  256
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7106481, 'precision': 0.75610423, 'recall': 0.7106482, 'specificity': 0.7106482, 'f1': 0.6972127, 'auroc': 0.8405564, 'binary_precision': 0.864, 'binary_recall': 0.5, 'binary_specificity': 0.9212963, 'binary_f1_score': 0.6334311}
confusion matrix:
     0    1
0  199   17
1  108  108
early stop counter: 2
val acc:0.6862284541130066, best validation acc: 0.8341158032417297, corresponding to test acc:                         0.8356481194496155 / 0.8425925970077515
after epoch: 3,now: 2024-07-27 03:34:37.899956,epoch time: 0:02:19.070484,used: 0:07:01.273646,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_03_27_35_seed_2_23090494
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9748037, 'precision': 0.97554576, 'recall': 0.97466075, 'specificity': 0.97466075, 'f1': 0.9747868, 'auroc': 0.99861735, 'binary_precision': 0.95862067, 'binary_recall': 0.99285716, 'binary_specificity': 0.95646435, 'binary_f1_score': 0.97543865}
confusion matrix:
      0     1
0  1450    66
1    11  1529
---- Validation: 
scalar performance:
{'acc': 0.8364632, 'precision': 0.8366413, 'recall': 0.8360349, 'specificity': 0.8360349, 'f1': 0.83622247, 'auroc': 0.8991109, 'binary_precision': 0.8401977, 'binary_recall': 0.8199357, 'binary_specificity': 0.85213417, 'binary_f1_score': 0.829943}
confusion matrix:
     0    1
0  559   97
1  112  510
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8564815, 'precision': 0.8666667, 'recall': 0.85648143, 'specificity': 0.85648143, 'f1': 0.85547787, 'auroc': 0.9149734, 'binary_precision': 0.92777777, 'binary_recall': 0.7731481, 'binary_specificity': 0.9398148, 'binary_f1_score': 0.8434344}
confusion matrix:
     0    1
0  203   13
1   49  167
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-07-27 03:36:57.752689,epoch time: 0:02:19.852733,used: 0:09:21.126379,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_03_27_35_seed_2_23090494
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9790576, 'precision': 0.9790635, 'recall': 0.97909224, 'specificity': 0.97909224, 'f1': 0.9790574, 'auroc': 0.9978292, 'binary_precision': 0.9836173, 'binary_recall': 0.9746753, 'binary_specificity': 0.98350924, 'binary_f1_score': 0.9791259}
confusion matrix:
      0     1
0  1491    25
1    39  1501
---- Validation: 
scalar performance:
{'acc': 0.80516434, 'precision': 0.80516434, 'recall': 0.80538046, 'specificity': 0.80538046, 'f1': 0.8051299, 'auroc': 0.87198305, 'binary_precision': 0.7918623, 'binary_recall': 0.8135048, 'binary_specificity': 0.7972561, 'binary_f1_score': 0.8025377}
confusion matrix:
     0    1
0  523  133
1  116  506
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8171296, 'precision': 0.8201558, 'recall': 0.8171296, 'specificity': 0.8171296, 'f1': 0.8166964, 'auroc': 0.90052724, 'binary_precision': 0.85128206, 'binary_recall': 0.7685185, 'binary_specificity': 0.8657407, 'binary_f1_score': 0.80778587}
confusion matrix:
     0    1
0  187   29
1   50  166
early stop counter: 1
val acc:0.8051643371582031, best validation acc: 0.836463212966919, corresponding to test acc:                         0.8564814925193787 / 0.8564814925193787
after epoch: 5,now: 2024-07-27 03:39:15.900602,epoch time: 0:02:18.147913,used: 0:11:39.274292,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_03_27_35_seed_2_23090494
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9659686, 'precision': 0.96774614, 'recall': 0.9662235, 'specificity': 0.9662235, 'f1': 0.9659475, 'auroc': 0.9978878, 'binary_precision': 0.9986111, 'binary_recall': 0.93376625, 'binary_specificity': 0.9986807, 'binary_f1_score': 0.96510065}
confusion matrix:
      0     1
0  1514     2
1   102  1438
---- Validation: 
scalar performance:
{'acc': 0.7316119, 'precision': 0.7990557, 'recall': 0.7251514, 'specificity': 0.7251514, 'f1': 0.71181, 'auroc': 0.8708098, 'binary_precision': 0.93457943, 'binary_recall': 0.48231512, 'binary_specificity': 0.9679878, 'binary_f1_score': 0.63626724}
confusion matrix:
     0    1
0  635   21
1  322  300
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7013889, 'precision': 0.79803026, 'recall': 0.7013889, 'specificity': 0.7013889, 'f1': 0.6750459, 'auroc': 0.888546, 'binary_precision': 0.9677419, 'binary_recall': 0.41666666, 'binary_specificity': 0.9861111, 'binary_f1_score': 0.58252424}
confusion matrix:
     0   1
0  213   3
1  126  90
early stop counter: 2
val acc:0.7316119074821472, best validation acc: 0.836463212966919, corresponding to test acc:                         0.8564814925193787 / 0.8564814925193787
after epoch: 6,now: 2024-07-27 03:41:34.660382,epoch time: 0:02:18.759780,used: 0:13:58.034072,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_03_27_35_seed_2_23090494
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.97742146, 'precision': 0.9774369, 'recall': 0.9774072, 'specificity': 0.9774072, 'f1': 0.9774195, 'auroc': 0.99705946, 'binary_precision': 0.9760518, 'binary_recall': 0.9792208, 'binary_specificity': 0.9755937, 'binary_f1_score': 0.9776337}
confusion matrix:
      0     1
0  1479    37
1    32  1508
---- Validation: 
scalar performance:
{'acc': 0.80438185, 'precision': 0.8094261, 'recall': 0.8060348, 'specificity': 0.8060348, 'f1': 0.8040575, 'auroc': 0.87425005, 'binary_precision': 0.7627119, 'binary_recall': 0.8681672, 'binary_specificity': 0.74390244, 'binary_f1_score': 0.8120301}
confusion matrix:
     0    1
0  488  168
1   82  540
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7453704, 'precision': 0.77799904, 'recall': 0.7453704, 'specificity': 0.7453704, 'f1': 0.73767304, 'auroc': 0.8785579, 'binary_precision': 0.6827586, 'binary_recall': 0.9166667, 'binary_specificity': 0.5740741, 'binary_f1_score': 0.7826087}
confusion matrix:
     0    1
0  124   92
1   18  198
early stop counter: 3
val acc:0.8043818473815918, best validation acc: 0.836463212966919, corresponding to test acc:                         0.8564814925193787 / 0.8564814925193787
after epoch: 7,now: 2024-07-27 03:43:53.413577,epoch time: 0:02:18.753195,used: 0:16:16.787267,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_03_27_35_seed_2_23090494
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9882199, 'precision': 0.9882787, 'recall': 0.9881883, 'specificity': 0.9881883, 'f1': 0.9882183, 'auroc': 0.99917364, 'binary_precision': 0.9845361, 'binary_recall': 0.99220777, 'binary_specificity': 0.9841689, 'binary_f1_score': 0.98835707}
confusion matrix:
      0     1
0  1492    24
1    12  1528
---- Validation: 
scalar performance:
{'acc': 0.8372457, 'precision': 0.8372257, 'recall': 0.83746374, 'specificity': 0.83746374, 'f1': 0.8372134, 'auroc': 0.8997897, 'binary_precision': 0.8244514, 'binary_recall': 0.84565914, 'binary_specificity': 0.8292683, 'binary_f1_score': 0.83492064}
confusion matrix:
     0    1
0  544  112
1   96  526
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8611111, 'precision': 0.86728287, 'recall': 0.8611111, 'specificity': 0.8611111, 'f1': 0.86052513, 'auroc': 0.91743827, 'binary_precision': 0.9148936, 'binary_recall': 0.7962963, 'binary_specificity': 0.9259259, 'binary_f1_score': 0.85148513}
confusion matrix:
     0    1
0  200   16
1   44  172
new oracle model saved
better model found
persisted
after epoch: 8,now: 2024-07-27 03:46:14.717208,epoch time: 0:02:21.303631,used: 0:18:38.090898,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_03_27_35_seed_2_23090494
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.97938484, 'precision': 0.9796852, 'recall': 0.9792987, 'specificity': 0.9792987, 'f1': 0.9793776, 'auroc': 0.9986628, 'binary_precision': 0.96948504, 'binary_recall': 0.99025977, 'binary_specificity': 0.9683377, 'binary_f1_score': 0.9797623}
confusion matrix:
      0     1
0  1468    48
1    15  1525
---- Validation: 
scalar performance:
{'acc': 0.86463225, 'precision': 0.86451334, 'recall': 0.8646822, 'specificity': 0.8646822, 'f1': 0.8645718, 'auroc': 0.9169532, 'binary_precision': 0.8569157, 'binary_recall': 0.8665595, 'binary_specificity': 0.8628049, 'binary_f1_score': 0.8617106}
confusion matrix:
     0    1
0  566   90
1   83  539
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8356481, 'precision': 0.84020555, 'recall': 0.8356482, 'specificity': 0.8356482, 'f1': 0.83509594, 'auroc': 0.9133659, 'binary_precision': 0.87958115, 'binary_recall': 0.7777778, 'binary_specificity': 0.8935185, 'binary_f1_score': 0.8255529}
confusion matrix:
     0    1
0  193   23
1   48  168
better model found
persisted
after epoch: 9,now: 2024-07-27 03:48:34.575834,epoch time: 0:02:19.858626,used: 0:20:57.949524,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_03_27_35_seed_2_23090494
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9810209, 'precision': 0.9815756, 'recall': 0.98116887, 'specificity': 0.98116887, 'f1': 0.98101854, 'auroc': 0.99936265, 'binary_precision': 1.0, 'binary_recall': 0.9623377, 'binary_specificity': 1.0, 'binary_f1_score': 0.98080736}
confusion matrix:
      0     1
0  1516     0
1    58  1482
---- Validation: 
scalar performance:
{'acc': 0.76760566, 'precision': 0.8151288, 'recall': 0.76233727, 'specificity': 0.76233727, 'f1': 0.7559756, 'auroc': 0.90327966, 'binary_precision': 0.9310345, 'binary_recall': 0.5643087, 'binary_specificity': 0.96036583, 'binary_f1_score': 0.7027027}
confusion matrix:
     0    1
0  630   26
1  271  351
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7430556, 'precision': 0.78058887, 'recall': 0.7430556, 'specificity': 0.7430556, 'f1': 0.73416567, 'auroc': 0.87358534, 'binary_precision': 0.8832117, 'binary_recall': 0.5601852, 'binary_specificity': 0.9259259, 'binary_f1_score': 0.6855524}
confusion matrix:
     0    1
0  200   16
1   95  121
early stop counter: 1
val acc:0.7676056623458862, best validation acc: 0.864632248878479, corresponding to test acc:                         0.8356481194496155 / 0.8611111044883728
after epoch: 10,now: 2024-07-27 03:50:53.351681,epoch time: 0:02:18.775847,used: 0:23:16.725371,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_03_27_35_seed_2_23090494
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.97447646, 'precision': 0.9756355, 'recall': 0.97429496, 'specificity': 0.97429496, 'f1': 0.97445226, 'auroc': 0.99883413, 'binary_precision': 0.95403725, 'binary_recall': 0.9974026, 'binary_specificity': 0.9511873, 'binary_f1_score': 0.9752381}
confusion matrix:
      0     1
0  1442    74
1     4  1536
---- Validation: 
scalar performance:
{'acc': 0.7801252, 'precision': 0.7941865, 'recall': 0.7829484, 'specificity': 0.7829484, 'f1': 0.778514, 'auroc': 0.89206976, 'binary_precision': 0.72287583, 'binary_recall': 0.88906753, 'binary_specificity': 0.6768293, 'binary_f1_score': 0.79740447}
confusion matrix:
     0    1
0  444  212
1   69  553
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7337963, 'precision': 0.7898674, 'recall': 0.7337963, 'specificity': 0.7337963, 'f1': 0.7202687, 'auroc': 0.9194959, 'binary_precision': 0.66237944, 'binary_recall': 0.9537037, 'binary_specificity': 0.5138889, 'binary_f1_score': 0.7817837}
confusion matrix:
     0    1
0  111  105
1   10  206
early stop counter: 2
val acc:0.7801252007484436, best validation acc: 0.864632248878479, corresponding to test acc:                         0.8356481194496155 / 0.8611111044883728
after epoch: 11,now: 2024-07-27 03:53:12.248352,epoch time: 0:02:18.896671,used: 0:25:35.622042,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_03_27_35_seed_2_23090494
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.97611254, 'precision': 0.9761758, 'recall': 0.9760777, 'specificity': 0.9760777, 'f1': 0.976109, 'auroc': 0.9970488, 'binary_precision': 0.9723117, 'binary_recall': 0.9805195, 'binary_specificity': 0.9716359, 'binary_f1_score': 0.9763983}
confusion matrix:
      0     1
0  1473    43
1    30  1510
---- Validation: 
scalar performance:
{'acc': 0.8341158, 'precision': 0.8371998, 'recall': 0.8327901, 'specificity': 0.8327901, 'f1': 0.8332517, 'auroc': 0.8990079, 'binary_precision': 0.8634752, 'binary_recall': 0.7829582, 'binary_specificity': 0.88262194, 'binary_f1_score': 0.821248}
confusion matrix:
     0    1
0  579   77
1  135  487
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8240741, 'precision': 0.83947015, 'recall': 0.8240741, 'specificity': 0.8240741, 'f1': 0.82205653, 'auroc': 0.8910966, 'binary_precision': 0.9117647, 'binary_recall': 0.7175926, 'binary_specificity': 0.9305556, 'binary_f1_score': 0.8031088}
confusion matrix:
     0    1
0  201   15
1   61  155
early stop counter: 3
val acc:0.8341158032417297, best validation acc: 0.864632248878479, corresponding to test acc:                         0.8356481194496155 / 0.8611111044883728
after epoch: 12,now: 2024-07-27 03:55:32.093090,epoch time: 0:02:19.844738,used: 0:27:55.466780,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_03_27_35_seed_2_23090494
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.98527485, 'precision': 0.98551905, 'recall': 0.98519945, 'specificity': 0.98519945, 'f1': 0.98527044, 'auroc': 0.9993695, 'binary_precision': 0.9764181, 'binary_recall': 0.9948052, 'binary_specificity': 0.9755937, 'binary_f1_score': 0.98552585}
confusion matrix:
      0     1
0  1479    37
1     8  1532
---- Validation: 
scalar performance:
{'acc': 0.8200313, 'precision': 0.8260751, 'recall': 0.818154, 'specificity': 0.818154, 'f1': 0.8184838, 'auroc': 0.886232, 'binary_precision': 0.8643123, 'binary_recall': 0.7475884, 'binary_specificity': 0.8887195, 'binary_f1_score': 0.8017241}
confusion matrix:
     0    1
0  583   73
1  157  465
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8449074, 'precision': 0.8652707, 'recall': 0.8449074, 'specificity': 0.8449074, 'f1': 0.8427153, 'auroc': 0.9099794, 'binary_precision': 0.95151514, 'binary_recall': 0.7268519, 'binary_specificity': 0.962963, 'binary_f1_score': 0.824147}
confusion matrix:
     0    1
0  208    8
1   59  157
early stop counter: 4
val acc:0.8200312852859497, best validation acc: 0.864632248878479, corresponding to test acc:                         0.8356481194496155 / 0.8611111044883728
after epoch: 13,now: 2024-07-27 03:57:50.667293,epoch time: 0:02:18.574203,used: 0:30:14.040983,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_03_27_35_seed_2_23090494
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.98756546, 'precision': 0.9875611, 'recall': 0.9875904, 'specificity': 0.9875904, 'f1': 0.98756516, 'auroc': 0.99914163, 'binary_precision': 0.9908497, 'binary_recall': 0.9844156, 'binary_specificity': 0.99076515, 'binary_f1_score': 0.98762214}
confusion matrix:
      0     1
0  1502    14
1    24  1516
---- Validation: 
scalar performance:
{'acc': 0.78951484, 'precision': 0.8157048, 'recall': 0.78559524, 'specificity': 0.78559524, 'f1': 0.7833842, 'auroc': 0.88712895, 'binary_precision': 0.9002268, 'binary_recall': 0.63826364, 'binary_specificity': 0.93292683, 'binary_f1_score': 0.74694264}
confusion matrix:
     0    1
0  612   44
1  225  397
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8449074, 'precision': 0.8707236, 'recall': 0.8449074, 'specificity': 0.8449074, 'f1': 0.8421595, 'auroc': 0.92560446, 'binary_precision': 0.9685535, 'binary_recall': 0.712963, 'binary_specificity': 0.9768519, 'binary_f1_score': 0.82133335}
confusion matrix:
     0    1
0  211    5
1   62  154
early stop counter: 5
val acc:0.7895148396492004, best validation acc: 0.864632248878479, corresponding to test acc:                         0.8356481194496155 / 0.8611111044883728
after epoch: 14,now: 2024-07-27 04:00:09.116996,epoch time: 0:02:18.449703,used: 0:32:32.490686,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_03_27_35_seed_2_23090494
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 14 with time: 0:32:32.490686 at 2024-07-27 04:00:09.116996
persisted model performance metric: 

scalar performance:
{'acc': 0.8356481, 'precision': 0.84020555, 'recall': 0.8356482, 'specificity': 0.8356482, 'f1': 0.83509594, 'auroc': 0.9133659, 'binary_precision': 0.87958115, 'binary_recall': 0.7777778, 'binary_specificity': 0.8935185, 'binary_f1_score': 0.8255529}
confusion matrix:
     0    1
0  193   23
1   48  168
oracle model performance metric: 

scalar performance:
{'acc': 0.8611111, 'precision': 0.86728287, 'recall': 0.8611111, 'specificity': 0.8611111, 'f1': 0.86052513, 'auroc': 0.91743827, 'binary_precision': 0.9148936, 'binary_recall': 0.7962963, 'binary_specificity': 0.9259259, 'binary_f1_score': 0.85148513}
confusion matrix:
     0    1
0  200   16
1   44  172
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_diva_irm_3seeds_nofreeze_2024-07-27_01-18-02/rule_results/1.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_diva_irm_3seeds_nofreeze_2024-07-27_01-18-02/confusion_matrix/1.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   2428 MiB |   8861 MiB | 211128 GiB | 211125 GiB |
|       from large pool |   2338 MiB |   8786 MiB | 209144 GiB | 209142 GiB |
|       from small pool |     89 MiB |    130 MiB |   1983 GiB |   1983 GiB |
|---------------------------------------------------------------------------|
| Active memory         |   2428 MiB |   8861 MiB | 211128 GiB | 211125 GiB |
|       from large pool |   2338 MiB |   8786 MiB | 209144 GiB | 209142 GiB |
|       from small pool |     89 MiB |    130 MiB |   1983 GiB |   1983 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |   2409 MiB |   8848 MiB | 210912 GiB | 210909 GiB |
|       from large pool |   2320 MiB |   8774 MiB | 208931 GiB | 208928 GiB |
|       from small pool |     89 MiB |    130 MiB |   1980 GiB |   1980 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   9322 MiB |   9366 MiB |  20780 MiB |  11458 MiB |
|       from large pool |   9186 MiB |   9232 MiB |  20568 MiB |  11382 MiB |
|       from small pool |    136 MiB |    140 MiB |    212 MiB |     76 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |   1821 MiB |   2669 MiB | 192740 GiB | 192738 GiB |
|       from large pool |   1813 MiB |   2661 MiB | 190694 GiB | 190692 GiB |
|       from small pool |      8 MiB |     48 MiB |   2046 GiB |   2046 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    2464    |    3329    |   32237 K  |   32235 K  |
|       from large pool |     392    |     816    |   16116 K  |   16115 K  |
|       from small pool |    2072    |    2780    |   16121 K  |   16119 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    2464    |    3329    |   32237 K  |   32235 K  |
|       from large pool |     392    |     816    |   16116 K  |   16115 K  |
|       from small pool |    2072    |    2780    |   16121 K  |   16119 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     232    |     267    |     478    |     246    |
|       from large pool |     164    |     200    |     372    |     208    |
|       from small pool |      68    |      70    |     106    |      38    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     161    |     313    |   16472 K  |   16472 K  |
|       from large pool |      69    |     183    |    8243 K  |    8243 K  |
|       from small pool |      92    |     239    |    8229 K  |    8229 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   8861 MiB | 211128 GiB | 211128 GiB |
|       from large pool |  16640 KiB |   8786 MiB | 209144 GiB | 209144 GiB |
|       from small pool |      0 KiB |    130 MiB |   1983 GiB |   1983 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   8861 MiB | 211128 GiB | 211128 GiB |
|       from large pool |  16640 KiB |   8786 MiB | 209144 GiB | 209144 GiB |
|       from small pool |      0 KiB |    130 MiB |   1983 GiB |   1983 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   8848 MiB | 210912 GiB | 210912 GiB |
|       from large pool |  16640 KiB |   8774 MiB | 208931 GiB | 208931 GiB |
|       from small pool |      0 KiB |    130 MiB |   1980 GiB |   1980 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   4250 MiB |   9366 MiB |  20780 MiB |  16530 MiB |
|       from large pool |   4152 MiB |   9232 MiB |  20568 MiB |  16416 MiB |
|       from small pool |     98 MiB |    140 MiB |    212 MiB |    114 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   2669 MiB | 192741 GiB | 192741 GiB |
|       from large pool |  24320 KiB |   2661 MiB | 190695 GiB | 190695 GiB |
|       from small pool |      0 KiB |     48 MiB |   2046 GiB |   2046 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3329    |   32237 K  |   32237 K  |
|       from large pool |       2    |     816    |   16116 K  |   16116 K  |
|       from small pool |       0    |    2780    |   16121 K  |   16121 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3329    |   32237 K  |   32237 K  |
|       from large pool |       2    |     816    |   16116 K  |   16116 K  |
|       from small pool |       0    |    2780    |   16121 K  |   16121 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     130    |     267    |     478    |     348    |
|       from large pool |      81    |     200    |     372    |     291    |
|       from small pool |      49    |      70    |     106    |      57    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |     313    |   16473 K  |   16473 K  |
|       from large pool |       4    |     183    |    8243 K  |    8243 K  |
|       from small pool |       0    |     239    |    8230 K  |    8230 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Sat Jul 27 04:00:18 2024]
Finished job 0.
1 of 1 steps (100%) done
