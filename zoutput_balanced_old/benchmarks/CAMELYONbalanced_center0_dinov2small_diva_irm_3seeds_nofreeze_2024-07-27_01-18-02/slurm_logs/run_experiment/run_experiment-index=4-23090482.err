Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Sat Jul 27 01:18:58 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_diva_irm_3seeds_nofreeze_2024-07-27_01-18-02/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_diva_irm_3seeds_nofreeze_2024-07-27_01-18-02/rule_results/4.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=4
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/swiglu_ffn.py:51: UserWarning: xFormers is not available (SwiGLU)
  warnings.warn("xFormers is not available (SwiGLU)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/attention.py:33: UserWarning: xFormers is not available (Attention)
  warnings.warn("xFormers is not available (Attention)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/block.py:40: UserWarning: xFormers is not available (Block)
  warnings.warn("xFormers is not available (Block)")
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/init.py:452: UserWarning: Initializing zero-element tensors is a no-op
  warnings.warn("Initializing zero-element tensors is a no-op")
Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main

using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_01_19_45_seed_0_23090482

 Experiment start at: 2024-07-27 01:19:46.246497
hyper-parameter scheduler not set,going to use default Warmpup and epoch update
before training, model accuracy: 0.41860464215278625
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9192708, 'precision': 0.9280908, 'recall': 0.9203268, 'specificity': 0.9203268, 'f1': 0.9189738, 'auroc': 0.9842963, 'binary_precision': 0.9932229, 'binary_recall': 0.8465982, 'binary_specificity': 0.9940555, 'binary_f1_score': 0.9140679}
confusion matrix:
      0     1
0  1505     9
1   239  1319
---- Validation: 
scalar performance:
{'acc': 0.73680127, 'precision': 0.7384619, 'recall': 0.73615295, 'specificity': 0.73615295, 'f1': 0.73595303, 'auroc': 0.8245481, 'binary_precision': 0.75517243, 'binary_recall': 0.6897638, 'binary_specificity': 0.7825421, 'binary_f1_score': 0.7209876}
confusion matrix:
     0    1
0  511  142
1  197  438
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7906977, 'precision': 0.7957131, 'recall': 0.7906977, 'specificity': 0.7906977, 'f1': 0.7898065, 'auroc': 0.8926338, 'binary_precision': 0.7572017, 'binary_recall': 0.855814, 'binary_specificity': 0.7255814, 'binary_f1_score': 0.8034935}
confusion matrix:
     0    1
0  156   59
1   31  184
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-27 01:21:40.352890,epoch time: 0:01:54.106393,used: 0:01:54.106393,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_01_19_45_seed_0_23090482
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.97265625, 'precision': 0.9730576, 'recall': 0.9729004, 'specificity': 0.9729004, 'f1': 0.97265565, 'auroc': 0.99700576, 'binary_precision': 0.9906729, 'binary_recall': 0.95504177, 'binary_specificity': 0.9907591, 'binary_f1_score': 0.972531}
confusion matrix:
      0     1
0  1501    14
1    70  1487
---- Validation: 
scalar performance:
{'acc': 0.8152174, 'precision': 0.82362735, 'recall': 0.8140744, 'specificity': 0.8140744, 'f1': 0.8135994, 'auroc': 0.8958122, 'binary_precision': 0.87242025, 'binary_recall': 0.7322835, 'binary_specificity': 0.89586526, 'binary_f1_score': 0.7962329}
confusion matrix:
     0    1
0  585   68
1  170  465
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.81627905, 'precision': 0.82061404, 'recall': 0.81627905, 'specificity': 0.81627905, 'f1': 0.81565595, 'auroc': 0.9064359, 'binary_precision': 0.8578947, 'binary_recall': 0.75813955, 'binary_specificity': 0.8744186, 'binary_f1_score': 0.80493826}
confusion matrix:
     0    1
0  188   27
1   52  163
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-07-27 01:23:29.051414,epoch time: 0:01:48.698524,used: 0:03:42.804917,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_01_19_45_seed_0_23090482
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.98079425, 'precision': 0.98077816, 'recall': 0.98085463, 'specificity': 0.98085463, 'f1': 0.980793, 'auroc': 0.99818003, 'binary_precision': 0.98572356, 'binary_recall': 0.9762211, 'binary_specificity': 0.9854881, 'binary_f1_score': 0.98094934}
confusion matrix:
      0     1
0  1494    22
1    37  1519
---- Validation: 
scalar performance:
{'acc': 0.71118015, 'precision': 0.7330076, 'recall': 0.70897496, 'specificity': 0.70897496, 'f1': 0.7028223, 'auroc': 0.8274059, 'binary_precision': 0.80091536, 'binary_recall': 0.5511811, 'binary_specificity': 0.8667688, 'binary_f1_score': 0.6529851}
confusion matrix:
     0    1
0  566   87
1  285  350
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7837209, 'precision': 0.836282, 'recall': 0.78372097, 'specificity': 0.78372097, 'f1': 0.7749262, 'auroc': 0.92114663, 'binary_precision': 0.9692308, 'binary_recall': 0.5860465, 'binary_specificity': 0.98139536, 'binary_f1_score': 0.7304348}
confusion matrix:
     0    1
0  211    4
1   89  126
early stop counter: 1
val acc:0.7111801505088806, best validation acc: 0.8152173757553101, corresponding to test acc:                         0.8162790536880493 / 0.8162790536880493
after epoch: 3,now: 2024-07-27 01:25:17.095883,epoch time: 0:01:48.044469,used: 0:05:30.849386,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_01_19_45_seed_0_23090482
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9798177, 'precision': 0.979908, 'recall': 0.9799959, 'specificity': 0.9799959, 'f1': 0.9798174, 'auroc': 0.99664235, 'binary_precision': 0.9914698, 'binary_recall': 0.9685897, 'binary_specificity': 0.9914021, 'binary_f1_score': 0.9798962}
confusion matrix:
      0     1
0  1499    13
1    49  1511
---- Validation: 
scalar performance:
{'acc': 0.76785713, 'precision': 0.78843737, 'recall': 0.76595604, 'specificity': 0.76595604, 'f1': 0.7627486, 'auroc': 0.86169225, 'binary_precision': 0.86206895, 'binary_recall': 0.62992126, 'binary_specificity': 0.90199083, 'binary_f1_score': 0.7279345}
confusion matrix:
     0    1
0  589   64
1  235  400
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.76976746, 'precision': 0.8255534, 'recall': 0.7697674, 'specificity': 0.7697674, 'f1': 0.75946295, 'auroc': 0.90068144, 'binary_precision': 0.96031743, 'binary_recall': 0.5627907, 'binary_specificity': 0.9767442, 'binary_f1_score': 0.7096774}
confusion matrix:
     0    1
0  210    5
1   94  121
early stop counter: 2
val acc:0.7678571343421936, best validation acc: 0.8152173757553101, corresponding to test acc:                         0.8162790536880493 / 0.8162790536880493
after epoch: 4,now: 2024-07-27 01:27:05.002476,epoch time: 0:01:47.906593,used: 0:07:18.755979,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_01_19_45_seed_0_23090482
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9733073, 'precision': 0.9734199, 'recall': 0.9732272, 'specificity': 0.9732272, 'f1': 0.9732971, 'auroc': 0.9975556, 'binary_precision': 0.96886915, 'binary_recall': 0.978819, 'binary_specificity': 0.9676354, 'binary_f1_score': 0.9738187}
confusion matrix:
      0     1
0  1465    49
1    33  1525
---- Validation: 
scalar performance:
{'acc': 0.79891306, 'precision': 0.80464095, 'recall': 0.7979296, 'specificity': 0.7979296, 'f1': 0.7975677, 'auroc': 0.8843231, 'binary_precision': 0.8430657, 'binary_recall': 0.72755903, 'binary_specificity': 0.86830014, 'binary_f1_score': 0.7810651}
confusion matrix:
     0    1
0  567   86
1  173  462
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.82325584, 'precision': 0.8325803, 'recall': 0.8232558, 'specificity': 0.8232558, 'f1': 0.82200825, 'auroc': 0.8848891, 'binary_precision': 0.8882682, 'binary_recall': 0.73953485, 'binary_specificity': 0.90697676, 'binary_f1_score': 0.80710655}
confusion matrix:
     0    1
0  195   20
1   56  159
new oracle model saved
early stop counter: 3
val acc:0.7989130616188049, best validation acc: 0.8152173757553101, corresponding to test acc:                         0.8162790536880493 / 0.8232558369636536
after epoch: 5,now: 2024-07-27 01:28:53.720323,epoch time: 0:01:48.717847,used: 0:09:07.473826,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_01_19_45_seed_0_23090482
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.961263, 'precision': 0.9625352, 'recall': 0.96166086, 'specificity': 0.96166086, 'f1': 0.96125317, 'auroc': 0.99499035, 'binary_precision': 0.9904502, 'binary_recall': 0.93256265, 'binary_specificity': 0.9907591, 'binary_f1_score': 0.9606352}
confusion matrix:
      0     1
0  1501    14
1   105  1452
---- Validation: 
scalar performance:
{'acc': 0.7740683, 'precision': 0.8041286, 'recall': 0.77184284, 'specificity': 0.77184284, 'f1': 0.76734203, 'auroc': 0.8557765, 'binary_precision': 0.89631337, 'binary_recall': 0.6125984, 'binary_specificity': 0.9310873, 'binary_f1_score': 0.7277829}
confusion matrix:
     0    1
0  608   45
1  246  389
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.81627905, 'precision': 0.83842593, 'recall': 0.81627905, 'specificity': 0.81627905, 'f1': 0.81322336, 'auroc': 0.9079935, 'binary_precision': 0.925, 'binary_recall': 0.6883721, 'binary_specificity': 0.94418603, 'binary_f1_score': 0.78933334}
confusion matrix:
     0    1
0  203   12
1   67  148
early stop counter: 4
val acc:0.774068295955658, best validation acc: 0.8152173757553101, corresponding to test acc:                         0.8162790536880493 / 0.8232558369636536
after epoch: 6,now: 2024-07-27 01:30:41.194679,epoch time: 0:01:47.474356,used: 0:10:54.948182,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_01_19_45_seed_0_23090482
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9550781, 'precision': 0.9581332, 'recall': 0.95570314, 'specificity': 0.95570314, 'f1': 0.95503783, 'auroc': 0.9956817, 'binary_precision': 0.9992968, 'binary_recall': 0.91206676, 'binary_specificity': 0.9993395, 'binary_f1_score': 0.95369124}
confusion matrix:
      0     1
0  1513     1
1   137  1421
---- Validation: 
scalar performance:
{'acc': 0.77018636, 'precision': 0.8145009, 'recall': 0.7675369, 'specificity': 0.7675369, 'f1': 0.76057976, 'auroc': 0.899555, 'binary_precision': 0.9291139, 'binary_recall': 0.57795274, 'binary_specificity': 0.95712095, 'binary_f1_score': 0.71262133}
confusion matrix:
     0    1
0  625   28
1  268  367
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.84418607, 'precision': 0.85717493, 'recall': 0.84418607, 'specificity': 0.84418607, 'f1': 0.8427565, 'auroc': 0.90273666, 'binary_precision': 0.92528737, 'binary_recall': 0.74883723, 'binary_specificity': 0.9395349, 'binary_f1_score': 0.8277635}
confusion matrix:
     0    1
0  202   13
1   54  161
new oracle model saved
early stop counter: 5
val acc:0.7701863646507263, best validation acc: 0.8152173757553101, corresponding to test acc:                         0.8162790536880493 / 0.8441860675811768
after epoch: 7,now: 2024-07-27 01:32:29.310066,epoch time: 0:01:48.115387,used: 0:12:43.063569,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_01_19_45_seed_0_23090482
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 7 with time: 0:12:43.063569 at 2024-07-27 01:32:29.310066
persisted model performance metric: 

scalar performance:
{'acc': 0.81627905, 'precision': 0.82061404, 'recall': 0.81627905, 'specificity': 0.81627905, 'f1': 0.81565595, 'auroc': 0.9064359, 'binary_precision': 0.8578947, 'binary_recall': 0.75813955, 'binary_specificity': 0.8744186, 'binary_f1_score': 0.80493826}
confusion matrix:
     0    1
0  188   27
1   52  163
oracle model performance metric: 

scalar performance:
{'acc': 0.84418607, 'precision': 0.85717493, 'recall': 0.84418607, 'specificity': 0.84418607, 'f1': 0.8427565, 'auroc': 0.90273666, 'binary_precision': 0.92528737, 'binary_recall': 0.74883723, 'binary_specificity': 0.9395349, 'binary_f1_score': 0.8277635}
confusion matrix:
     0    1
0  202   13
1   54  161
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_diva_irm_3seeds_nofreeze_2024-07-27_01-18-02/rule_results/4.csv
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_diva_irm_3seeds_nofreeze_2024-07-27_01-18-02/rule_results/4.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_diva_irm_3seeds_nofreeze_2024-07-27_01-18-02/confusion_matrix/4.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   1245 MiB |   7994 MiB |  46538 GiB |  46537 GiB |
|       from large pool |   1156 MiB |   7921 MiB |  46134 GiB |  46132 GiB |
|       from small pool |     88 MiB |    124 MiB |    404 GiB |    404 GiB |
|---------------------------------------------------------------------------|
| Active memory         |   1245 MiB |   7994 MiB |  46538 GiB |  46537 GiB |
|       from large pool |   1156 MiB |   7921 MiB |  46134 GiB |  46132 GiB |
|       from small pool |     88 MiB |    124 MiB |    404 GiB |    404 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |   1234 MiB |   7988 MiB |  46501 GiB |  46500 GiB |
|       from large pool |   1146 MiB |   7915 MiB |  46097 GiB |  46095 GiB |
|       from small pool |     88 MiB |    124 MiB |    404 GiB |    404 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   8856 MiB |   8856 MiB |   8856 MiB |      0 B   |
|       from large pool |   8722 MiB |   8722 MiB |   8722 MiB |      0 B   |
|       from small pool |    134 MiB |    134 MiB |    134 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |    986 MiB |   1707 MiB |  37110 GiB |  37109 GiB |
|       from large pool |    977 MiB |   1700 MiB |  36688 GiB |  36687 GiB |
|       from small pool |      9 MiB |     17 MiB |    421 GiB |    421 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    2444    |    3289    |    6573 K  |    6570 K  |
|       from large pool |     382    |     808    |    3343 K  |    3343 K  |
|       from small pool |    2062    |    2754    |    3229 K  |    3227 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    2444    |    3289    |    6573 K  |    6570 K  |
|       from large pool |     382    |     808    |    3343 K  |    3343 K  |
|       from small pool |    2062    |    2754    |    3229 K  |    3227 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     270    |     270    |     270    |       0    |
|       from large pool |     203    |     203    |     203    |       0    |
|       from small pool |      67    |      67    |      67    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     161    |     319    |    3379 K  |    3379 K  |
|       from large pool |      85    |     207    |    1734 K  |    1734 K  |
|       from small pool |      76    |     234    |    1644 K  |    1644 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   7994 MiB |  46538 GiB |  46538 GiB |
|       from large pool |  16640 KiB |   7921 MiB |  46134 GiB |  46134 GiB |
|       from small pool |      0 KiB |    124 MiB |    404 GiB |    404 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   7994 MiB |  46538 GiB |  46538 GiB |
|       from large pool |  16640 KiB |   7921 MiB |  46134 GiB |  46134 GiB |
|       from small pool |      0 KiB |    124 MiB |    404 GiB |    404 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   7988 MiB |  46501 GiB |  46501 GiB |
|       from large pool |  16640 KiB |   7915 MiB |  46097 GiB |  46096 GiB |
|       from small pool |      0 KiB |    124 MiB |    404 GiB |    404 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2232 MiB |   8856 MiB |   8856 MiB |   6624 MiB |
|       from large pool |   2134 MiB |   8722 MiB |   8722 MiB |   6588 MiB |
|       from small pool |     98 MiB |    134 MiB |    134 MiB |     36 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1707 MiB |  37111 GiB |  37111 GiB |
|       from large pool |  24320 KiB |   1700 MiB |  36689 GiB |  36689 GiB |
|       from small pool |      0 KiB |     47 MiB |    421 GiB |    421 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3289    |    6573 K  |    6573 K  |
|       from large pool |       2    |     808    |    3343 K  |    3343 K  |
|       from small pool |       0    |    2754    |    3229 K  |    3229 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3289    |    6573 K  |    6573 K  |
|       from large pool |       2    |     808    |    3343 K  |    3343 K  |
|       from small pool |       0    |    2754    |    3229 K  |    3229 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     125    |     270    |     270    |     145    |
|       from large pool |      76    |     203    |     203    |     127    |
|       from small pool |      49    |      67    |      67    |      18    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     319    |    3380 K  |    3380 K  |
|       from large pool |       3    |     207    |    1734 K  |    1734 K  |
|       from small pool |       0    |     234    |    1645 K  |    1645 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   7994 MiB |  46538 GiB |  46538 GiB |
|       from large pool |  16640 KiB |   7921 MiB |  46134 GiB |  46134 GiB |
|       from small pool |      0 KiB |    124 MiB |    404 GiB |    404 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   7994 MiB |  46538 GiB |  46538 GiB |
|       from large pool |  16640 KiB |   7921 MiB |  46134 GiB |  46134 GiB |
|       from small pool |      0 KiB |    124 MiB |    404 GiB |    404 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   7988 MiB |  46501 GiB |  46501 GiB |
|       from large pool |  16640 KiB |   7915 MiB |  46097 GiB |  46096 GiB |
|       from small pool |      0 KiB |    124 MiB |    404 GiB |    404 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2232 MiB |   8856 MiB |   8856 MiB |   6624 MiB |
|       from large pool |   2134 MiB |   8722 MiB |   8722 MiB |   6588 MiB |
|       from small pool |     98 MiB |    134 MiB |    134 MiB |     36 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1707 MiB |  37111 GiB |  37111 GiB |
|       from large pool |  24320 KiB |   1700 MiB |  36689 GiB |  36689 GiB |
|       from small pool |      0 KiB |     47 MiB |    421 GiB |    421 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3289    |    6573 K  |    6573 K  |
|       from large pool |       2    |     808    |    3343 K  |    3343 K  |
|       from small pool |       0    |    2754    |    3229 K  |    3229 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3289    |    6573 K  |    6573 K  |
|       from large pool |       2    |     808    |    3343 K  |    3343 K  |
|       from small pool |       0    |    2754    |    3229 K  |    3229 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     125    |     270    |     270    |     145    |
|       from large pool |      76    |     203    |     203    |     127    |
|       from small pool |      49    |      67    |      67    |      18    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     319    |    3380 K  |    3380 K  |
|       from large pool |       3    |     207    |    1734 K  |    1734 K  |
|       from small pool |       0    |     234    |    1645 K  |    1645 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/init.py:452: UserWarning: Initializing zero-element tensors is a no-op
  warnings.warn("Initializing zero-element tensors is a no-op")
Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main

using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_01_33_00_seed_1_23090482

 Experiment start at: 2024-07-27 01:33:00.863703
hyper-parameter scheduler not set,going to use default Warmpup and epoch update
before training, model accuracy: 0.5822222232818604
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.960612, 'precision': 0.9609256, 'recall': 0.9604807, 'specificity': 0.9604807, 'f1': 0.96059203, 'auroc': 0.9946553, 'binary_precision': 0.9514808, 'binary_recall': 0.97168595, 'binary_specificity': 0.9492754, 'binary_f1_score': 0.9614772}
confusion matrix:
      0     1
0  1441    77
1    44  1510
---- Validation: 
scalar performance:
{'acc': 0.7525371, 'precision': 0.80192524, 'recall': 0.7558116, 'specificity': 0.7558116, 'f1': 0.7435348, 'auroc': 0.8667593, 'binary_precision': 0.67564535, 'binary_recall': 0.95555556, 'binary_specificity': 0.5560676, 'binary_f1_score': 0.7915845}
confusion matrix:
     0    1
0  362  289
1   28  602
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.72, 'precision': 0.77690756, 'recall': 0.72, 'specificity': 0.72, 'f1': 0.70483506, 'auroc': 0.89234567, 'binary_precision': 0.6513761, 'binary_recall': 0.94666666, 'binary_specificity': 0.49333334, 'binary_f1_score': 0.7717391}
confusion matrix:
     0    1
0  111  114
1   12  213
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-27 01:34:52.018681,epoch time: 0:01:51.154978,used: 0:01:51.154978,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_01_33_00_seed_1_23090482
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.96223956, 'precision': 0.9623949, 'recall': 0.96241057, 'specificity': 0.96241057, 'f1': 0.9622395, 'auroc': 0.9919287, 'binary_precision': 0.97495055, 'binary_recall': 0.94990367, 'binary_specificity': 0.9749175, 'binary_f1_score': 0.96226406}
confusion matrix:
      0     1
0  1477    38
1    78  1479
---- Validation: 
scalar performance:
{'acc': 0.80093676, 'precision': 0.8046123, 'recall': 0.8, 'specificity': 0.8, 'f1': 0.79994935, 'auroc': 0.8718065, 'binary_precision': 0.8342246, 'binary_recall': 0.74285716, 'binary_specificity': 0.85714287, 'binary_f1_score': 0.7858943}
confusion matrix:
     0    1
0  558   93
1  162  468
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8111111, 'precision': 0.8143964, 'recall': 0.8111111, 'specificity': 0.8111111, 'f1': 0.8106164, 'auroc': 0.9038025, 'binary_precision': 0.7822581, 'binary_recall': 0.8622222, 'binary_specificity': 0.76, 'binary_f1_score': 0.82029605}
confusion matrix:
     0    1
0  171   54
1   31  194
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-07-27 01:36:40.145428,epoch time: 0:01:48.126747,used: 0:03:39.281725,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_01_33_00_seed_1_23090482
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.92252606, 'precision': 0.93219376, 'recall': 0.92347264, 'specificity': 0.92347264, 'f1': 0.92219627, 'auroc': 0.9965157, 'binary_precision': 1.0, 'binary_recall': 0.84694535, 'binary_specificity': 1.0, 'binary_f1_score': 0.91713095}
confusion matrix:
      0     1
0  1517     0
1   238  1317
---- Validation: 
scalar performance:
{'acc': 0.520687, 'precision': 0.72954607, 'recall': 0.51272404, 'specificity': 0.51272404, 'f1': 0.36583748, 'auroc': 0.88908887, 'binary_precision': 0.9444444, 'binary_recall': 0.026984127, 'binary_specificity': 0.9984639, 'binary_f1_score': 0.052469134}
confusion matrix:
     0   1
0  650   1
1  613  17
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.55333334, 'precision': 0.74492013, 'recall': 0.55333334, 'specificity': 0.55333334, 'f1': 0.44474798, 'auroc': 0.9035457, 'binary_precision': 0.96153843, 'binary_recall': 0.11111111, 'binary_specificity': 0.9955556, 'binary_f1_score': 0.19920318}
confusion matrix:
     0   1
0  224   1
1  200  25
early stop counter: 1
val acc:0.5206869840621948, best validation acc: 0.800936758518219, corresponding to test acc:                         0.8111110925674438 / 0.8111110925674438
after epoch: 3,now: 2024-07-27 01:38:27.871066,epoch time: 0:01:47.725638,used: 0:05:27.007363,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_01_33_00_seed_1_23090482
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9635417, 'precision': 0.96378225, 'recall': 0.96369576, 'specificity': 0.96369576, 'f1': 0.96354127, 'auroc': 0.9934616, 'binary_precision': 0.97746855, 'binary_recall': 0.9497746, 'binary_specificity': 0.97761685, 'binary_f1_score': 0.9634226}
confusion matrix:
      0     1
0  1485    34
1    78  1475
---- Validation: 
scalar performance:
{'acc': 0.81342703, 'precision': 0.8198731, 'recall': 0.8122376, 'specificity': 0.8122376, 'f1': 0.812041, 'auroc': 0.8935442, 'binary_precision': 0.8613678, 'binary_recall': 0.73968256, 'binary_specificity': 0.8847926, 'binary_f1_score': 0.7959009}
confusion matrix:
     0    1
0  576   75
1  164  466
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.83555555, 'precision': 0.8465069, 'recall': 0.83555555, 'specificity': 0.83555555, 'f1': 0.8342459, 'auroc': 0.9063506, 'binary_precision': 0.9081081, 'binary_recall': 0.74666667, 'binary_specificity': 0.92444444, 'binary_f1_score': 0.8195122}
confusion matrix:
     0    1
0  208   17
1   57  168
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-07-27 01:40:16.311559,epoch time: 0:01:48.440493,used: 0:07:15.447856,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_01_33_00_seed_1_23090482
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.97298175, 'precision': 0.9733976, 'recall': 0.9731879, 'specificity': 0.9731879, 'f1': 0.97298074, 'auroc': 0.9977677, 'binary_precision': 0.9906604, 'binary_recall': 0.9555985, 'binary_specificity': 0.9907773, 'binary_f1_score': 0.9728136}
confusion matrix:
      0     1
0  1504    14
1    69  1485
---- Validation: 
scalar performance:
{'acc': 0.7619048, 'precision': 0.7761941, 'recall': 0.7599846, 'specificity': 0.7599846, 'f1': 0.75783825, 'auroc': 0.84504914, 'binary_precision': 0.83505154, 'binary_recall': 0.64285713, 'binary_specificity': 0.87711215, 'binary_f1_score': 0.7264575}
confusion matrix:
     0    1
0  571   80
1  225  405
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7866667, 'precision': 0.78687066, 'recall': 0.78666663, 'specificity': 0.78666663, 'f1': 0.7866287, 'auroc': 0.85509133, 'binary_precision': 0.79452056, 'binary_recall': 0.7733333, 'binary_specificity': 0.8, 'binary_f1_score': 0.7837838}
confusion matrix:
     0    1
0  180   45
1   51  174
early stop counter: 1
val acc:0.761904776096344, best validation acc: 0.8134270310401917, corresponding to test acc:                         0.8355555534362793 / 0.8355555534362793
after epoch: 5,now: 2024-07-27 01:42:03.660905,epoch time: 0:01:47.349346,used: 0:09:02.797202,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_01_33_00_seed_1_23090482
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9742839, 'precision': 0.9743842, 'recall': 0.9742123, 'specificity': 0.9742123, 'f1': 0.974275, 'auroc': 0.9969231, 'binary_precision': 0.9701018, 'binary_recall': 0.97944766, 'binary_specificity': 0.9689769, 'binary_f1_score': 0.9747523}
confusion matrix:
      0     1
0  1468    47
1    32  1525
---- Validation: 
scalar performance:
{'acc': 0.82825917, 'precision': 0.83033955, 'recall': 0.8289043, 'specificity': 0.8289043, 'f1': 0.8281451, 'auroc': 0.8948431, 'binary_precision': 0.7997076, 'binary_recall': 0.86825395, 'binary_specificity': 0.78955454, 'binary_f1_score': 0.8325723}
confusion matrix:
     0    1
0  514  137
1   83  547
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7644445, 'precision': 0.7927829, 'recall': 0.7644445, 'specificity': 0.7644445, 'f1': 0.7586032, 'auroc': 0.89246416, 'binary_precision': 0.7016949, 'binary_recall': 0.92, 'binary_specificity': 0.60888886, 'binary_f1_score': 0.79615384}
confusion matrix:
     0    1
0  137   88
1   18  207
better model found
persisted
after epoch: 6,now: 2024-07-27 01:43:51.802511,epoch time: 0:01:48.141606,used: 0:10:50.938808,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_01_33_00_seed_1_23090482
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.97298175, 'precision': 0.9739879, 'recall': 0.9733206, 'specificity': 0.9733206, 'f1': 0.9729769, 'auroc': 0.99895704, 'binary_precision': 0.99932206, 'binary_recall': 0.9473008, 'binary_specificity': 0.99934036, 'binary_f1_score': 0.9726163}
confusion matrix:
      0     1
0  1515     1
1    82  1474
---- Validation: 
scalar performance:
{'acc': 0.69476974, 'precision': 0.7848362, 'recall': 0.6900922, 'specificity': 0.6900922, 'f1': 0.6653187, 'auroc': 0.8986126, 'binary_precision': 0.9409594, 'binary_recall': 0.4047619, 'binary_specificity': 0.97542244, 'binary_f1_score': 0.5660378}
confusion matrix:
     0    1
0  635   16
1  375  255
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5555556, 'precision': 0.64848745, 'recall': 0.5555556, 'specificity': 0.5555556, 'f1': 0.47311726, 'auroc': 0.8430815, 'binary_precision': 0.7659575, 'binary_recall': 0.16, 'binary_specificity': 0.95111114, 'binary_f1_score': 0.2647059}
confusion matrix:
     0   1
0  214  11
1  189  36
early stop counter: 1
val acc:0.6947697401046753, best validation acc: 0.8282591700553894, corresponding to test acc:                         0.7644444704055786 / 0.8355555534362793
after epoch: 7,now: 2024-07-27 01:45:38.952077,epoch time: 0:01:47.149566,used: 0:12:38.088374,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_01_33_00_seed_1_23090482
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.98567706, 'precision': 0.9856916, 'recall': 0.985662, 'specificity': 0.985662, 'f1': 0.98567516, 'auroc': 0.9989495, 'binary_precision': 0.9845758, 'binary_recall': 0.9871134, 'binary_specificity': 0.98421055, 'binary_f1_score': 0.985843}
confusion matrix:
      0     1
0  1496    24
1    20  1532
---- Validation: 
scalar performance:
{'acc': 0.84231067, 'precision': 0.86027634, 'recall': 0.84047616, 'specificity': 0.84047616, 'f1': 0.8397798, 'auroc': 0.92445326, 'binary_precision': 0.9367347, 'binary_recall': 0.7285714, 'binary_specificity': 0.95238096, 'binary_f1_score': 0.81964284}
confusion matrix:
     0    1
0  620   31
1  171  459
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.82666665, 'precision': 0.86167306, 'recall': 0.82666665, 'specificity': 0.82666665, 'f1': 0.8223684, 'auroc': 0.91664195, 'binary_precision': 0.9741936, 'binary_recall': 0.6711111, 'binary_specificity': 0.9822222, 'binary_f1_score': 0.79473686}
confusion matrix:
     0    1
0  221    4
1   74  151
better model found
persisted
after epoch: 8,now: 2024-07-27 01:47:27.396105,epoch time: 0:01:48.444028,used: 0:14:26.532402,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_01_33_00_seed_1_23090482
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.96158856, 'precision': 0.9638072, 'recall': 0.9620738, 'specificity': 0.9620738, 'f1': 0.96156496, 'auroc': 0.9986553, 'binary_precision': 0.99930555, 'binary_recall': 0.9248072, 'binary_specificity': 0.99934036, 'binary_f1_score': 0.9606141}
confusion matrix:
      0     1
0  1515     1
1   117  1439
---- Validation: 
scalar performance:
{'acc': 0.75019515, 'precision': 0.8002937, 'recall': 0.7467998, 'specificity': 0.7467998, 'f1': 0.7375672, 'auroc': 0.88063717, 'binary_precision': 0.9189189, 'binary_recall': 0.53968257, 'binary_specificity': 0.953917, 'binary_f1_score': 0.68}
confusion matrix:
     0    1
0  621   30
1  290  340
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.84444445, 'precision': 0.85814047, 'recall': 0.84444445, 'specificity': 0.84444445, 'f1': 0.84294283, 'auroc': 0.91059756, 'binary_precision': 0.9281768, 'binary_recall': 0.74666667, 'binary_specificity': 0.94222224, 'binary_f1_score': 0.8275862}
confusion matrix:
     0    1
0  212   13
1   57  168
new oracle model saved
early stop counter: 1
val acc:0.7501951456069946, best validation acc: 0.8423106670379639, corresponding to test acc:                         0.8266666531562805 / 0.8444444537162781
after epoch: 9,now: 2024-07-27 01:49:15.378548,epoch time: 0:01:47.982443,used: 0:16:14.514845,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_01_33_00_seed_1_23090482
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9847005, 'precision': 0.9851341, 'recall': 0.98453295, 'specificity': 0.98453295, 'f1': 0.98469037, 'auroc': 0.99962604, 'binary_precision': 0.9736512, 'binary_recall': 0.9967887, 'binary_specificity': 0.9722772, 'binary_f1_score': 0.98508406}
confusion matrix:
      0     1
0  1473    42
1     5  1552
---- Validation: 
scalar performance:
{'acc': 0.82201403, 'precision': 0.8221719, 'recall': 0.821787, 'specificity': 0.821787, 'f1': 0.82188106, 'auroc': 0.8765733, 'binary_precision': 0.8262987, 'binary_recall': 0.8079365, 'binary_specificity': 0.8356375, 'binary_f1_score': 0.81701446}
confusion matrix:
     0    1
0  544  107
1  121  509
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8666667, 'precision': 0.8671308, 'recall': 0.8666667, 'specificity': 0.8666667, 'f1': 0.86662453, 'auroc': 0.91350126, 'binary_precision': 0.88018435, 'binary_recall': 0.8488889, 'binary_specificity': 0.8844444, 'binary_f1_score': 0.8642534}
confusion matrix:
     0    1
0  199   26
1   34  191
new oracle model saved
early stop counter: 2
val acc:0.8220140337944031, best validation acc: 0.8423106670379639, corresponding to test acc:                         0.8266666531562805 / 0.8666666746139526
after epoch: 10,now: 2024-07-27 01:51:03.752641,epoch time: 0:01:48.374093,used: 0:18:02.888938,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_01_33_00_seed_1_23090482
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9847005, 'precision': 0.9846812, 'recall': 0.98476446, 'specificity': 0.98476446, 'f1': 0.98469937, 'auroc': 0.9987104, 'binary_precision': 0.98962384, 'binary_recall': 0.9800899, 'binary_specificity': 0.98943895, 'binary_f1_score': 0.98483384}
confusion matrix:
      0     1
0  1499    16
1    31  1526
---- Validation: 
scalar performance:
{'acc': 0.8555816, 'precision': 0.85561895, 'recall': 0.8557092, 'specificity': 0.8557092, 'f1': 0.855576, 'auroc': 0.90237, 'binary_precision': 0.8460342, 'binary_recall': 0.8634921, 'binary_specificity': 0.84792626, 'binary_f1_score': 0.85467404}
confusion matrix:
     0    1
0  552   99
1   86  544
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.76222223, 'precision': 0.7679869, 'recall': 0.76222223, 'specificity': 0.76222223, 'f1': 0.7609366, 'auroc': 0.8654666, 'binary_precision': 0.72868216, 'binary_recall': 0.83555555, 'binary_specificity': 0.6888889, 'binary_f1_score': 0.7784679}
confusion matrix:
     0    1
0  155   70
1   37  188
better model found
persisted
after epoch: 11,now: 2024-07-27 01:52:51.605267,epoch time: 0:01:47.852626,used: 0:19:50.741564,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_01_33_00_seed_1_23090482
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9873047, 'precision': 0.9873408, 'recall': 0.98727286, 'specificity': 0.98727286, 'f1': 0.9873017, 'auroc': 0.99915594, 'binary_precision': 0.9852847, 'binary_recall': 0.98971725, 'binary_specificity': 0.9848285, 'binary_f1_score': 0.987496}
confusion matrix:
      0     1
0  1493    23
1    16  1540
---- Validation: 
scalar performance:
{'acc': 0.8165496, 'precision': 0.8380554, 'recall': 0.8144649, 'specificity': 0.8144649, 'f1': 0.8128544, 'auroc': 0.91940606, 'binary_precision': 0.9193206, 'binary_recall': 0.6873016, 'binary_specificity': 0.9416283, 'binary_f1_score': 0.7865576}
confusion matrix:
     0    1
0  613   38
1  197  433
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.80222225, 'precision': 0.83564407, 'recall': 0.80222225, 'specificity': 0.80222225, 'f1': 0.79717314, 'auroc': 0.9029136, 'binary_precision': 0.9415584, 'binary_recall': 0.64444447, 'binary_specificity': 0.96, 'binary_f1_score': 0.7651716}
confusion matrix:
     0    1
0  216    9
1   80  145
early stop counter: 1
val acc:0.8165495991706848, best validation acc: 0.8555815815925598, corresponding to test acc:                         0.7622222304344177 / 0.8666666746139526
after epoch: 12,now: 2024-07-27 01:54:39.225523,epoch time: 0:01:47.620256,used: 0:21:38.361820,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_01_33_00_seed_1_23090482
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9589844, 'precision': 0.9616555, 'recall': 0.95948553, 'specificity': 0.95948553, 'f1': 0.9589507, 'auroc': 0.99853873, 'binary_precision': 1.0, 'binary_recall': 0.91897106, 'binary_specificity': 1.0, 'binary_f1_score': 0.9577748}
confusion matrix:
      0     1
0  1517     0
1   126  1429
---- Validation: 
scalar performance:
{'acc': 0.6143638, 'precision': 0.7772568, 'recall': 0.6079877, 'specificity': 0.6079877, 'f1': 0.54138595, 'auroc': 0.9299149, 'binary_precision': 0.98571426, 'binary_recall': 0.21904762, 'binary_specificity': 0.9969278, 'binary_f1_score': 0.35844156}
confusion matrix:
     0    1
0  649    2
1  492  138
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5555556, 'precision': 0.74625695, 'recall': 0.5555556, 'specificity': 0.5555556, 'f1': 0.4488536, 'auroc': 0.9163111, 'binary_precision': 0.962963, 'binary_recall': 0.115555555, 'binary_specificity': 0.9955556, 'binary_f1_score': 0.20634922}
confusion matrix:
     0   1
0  224   1
1  199  26
early stop counter: 2
val acc:0.6143637895584106, best validation acc: 0.8555815815925598, corresponding to test acc:                         0.7622222304344177 / 0.8666666746139526
after epoch: 13,now: 2024-07-27 01:56:26.723231,epoch time: 0:01:47.497708,used: 0:23:25.859528,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_01_33_00_seed_1_23090482
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9820964, 'precision': 0.9823667, 'recall': 0.982247, 'specificity': 0.982247, 'f1': 0.9820961, 'auroc': 0.9989623, 'binary_precision': 0.99668217, 'binary_recall': 0.9677835, 'binary_specificity': 0.99671054, 'binary_f1_score': 0.9820203}
confusion matrix:
      0     1
0  1515     5
1    50  1502
---- Validation: 
scalar performance:
{'acc': 0.7103825, 'precision': 0.7960323, 'recall': 0.705914, 'specificity': 0.705914, 'f1': 0.6849439, 'auroc': 0.912855, 'binary_precision': 0.9512195, 'binary_recall': 0.43333334, 'binary_specificity': 0.97849464, 'binary_f1_score': 0.5954198}
confusion matrix:
     0    1
0  637   14
1  357  273
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5777778, 'precision': 0.7348083, 'recall': 0.5777778, 'specificity': 0.5777778, 'f1': 0.4930149, 'auroc': 0.8855704, 'binary_precision': 0.9268293, 'binary_recall': 0.16888888, 'binary_specificity': 0.9866667, 'binary_f1_score': 0.28571427}
confusion matrix:
     0   1
0  222   3
1  187  38
early stop counter: 3
val acc:0.7103825211524963, best validation acc: 0.8555815815925598, corresponding to test acc:                         0.7622222304344177 / 0.8666666746139526
after epoch: 14,now: 2024-07-27 01:58:14.507472,epoch time: 0:01:47.784241,used: 0:25:13.643769,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_01_33_00_seed_1_23090482
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9840495, 'precision': 0.9840435, 'recall': 0.9840511, 'specificity': 0.9840511, 'f1': 0.9840472, 'auroc': 0.9982746, 'binary_precision': 0.98455596, 'binary_recall': 0.98392284, 'binary_specificity': 0.9841793, 'binary_f1_score': 0.98423934}
confusion matrix:
      0     1
0  1493    24
1    25  1530
---- Validation: 
scalar performance:
{'acc': 0.8774395, 'precision': 0.8795793, 'recall': 0.8768305, 'specificity': 0.8768305, 'f1': 0.8771133, 'auroc': 0.9280496, 'binary_precision': 0.9042735, 'binary_recall': 0.8396825, 'binary_specificity': 0.9139785, 'binary_f1_score': 0.8707819}
confusion matrix:
     0    1
0  595   56
1  101  529
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.81333333, 'precision': 0.8246454, 'recall': 0.8133334, 'specificity': 0.8133334, 'f1': 0.811693, 'auroc': 0.88643956, 'binary_precision': 0.8852459, 'binary_recall': 0.72, 'binary_specificity': 0.9066667, 'binary_f1_score': 0.7941177}
confusion matrix:
     0    1
0  204   21
1   63  162
better model found
persisted
after epoch: 15,now: 2024-07-27 02:00:02.174293,epoch time: 0:01:47.666821,used: 0:27:01.310590,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_01_33_00_seed_1_23090482
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9954427, 'precision': 0.99543, 'recall': 0.9954854, 'specificity': 0.9954854, 'f1': 0.9954425, 'auroc': 0.99979234, 'binary_precision': 0.9993511, 'binary_recall': 0.9916291, 'binary_specificity': 0.99934167, 'binary_f1_score': 0.9954752}
confusion matrix:
      0     1
0  1518     1
1    13  1540
---- Validation: 
scalar performance:
{'acc': 0.8376269, 'precision': 0.85638636, 'recall': 0.83573985, 'specificity': 0.83573985, 'f1': 0.8348875, 'auroc': 0.92256606, 'binary_precision': 0.93415636, 'binary_recall': 0.72063494, 'binary_specificity': 0.9508448, 'binary_f1_score': 0.81362003}
confusion matrix:
     0    1
0  619   32
1  176  454
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.81333333, 'precision': 0.83732057, 'recall': 0.81333333, 'specificity': 0.81333333, 'f1': 0.80995476, 'auroc': 0.9008988, 'binary_precision': 0.92727274, 'binary_recall': 0.68, 'binary_specificity': 0.94666666, 'binary_f1_score': 0.78461546}
confusion matrix:
     0    1
0  213   12
1   72  153
early stop counter: 1
val acc:0.8376268744468689, best validation acc: 0.8774394989013672, corresponding to test acc:                         0.8133333325386047 / 0.8666666746139526
after epoch: 16,now: 2024-07-27 02:01:49.955713,epoch time: 0:01:47.781420,used: 0:28:49.092010,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_01_33_00_seed_1_23090482
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9716797, 'precision': 0.9723012, 'recall': 0.9719238, 'specificity': 0.9719238, 'f1': 0.9716772, 'auroc': 0.99659216, 'binary_precision': 0.9926125, 'binary_recall': 0.951094, 'binary_specificity': 0.9927536, 'binary_f1_score': 0.9714098}
confusion matrix:
      0     1
0  1507    11
1    76  1478
---- Validation: 
scalar performance:
{'acc': 0.86026543, 'precision': 0.8607348, 'recall': 0.859959, 'specificity': 0.859959, 'f1': 0.86011505, 'auroc': 0.90861434, 'binary_precision': 0.87027913, 'binary_recall': 0.84126985, 'binary_specificity': 0.8786482, 'binary_f1_score': 0.8555286}
confusion matrix:
     0    1
0  572   79
1  100  530
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7822222, 'precision': 0.78231144, 'recall': 0.7822222, 'specificity': 0.7822222, 'f1': 0.782205, 'auroc': 0.8618469, 'binary_precision': 0.7873303, 'binary_recall': 0.7733333, 'binary_specificity': 0.7911111, 'binary_f1_score': 0.780269}
confusion matrix:
     0    1
0  178   47
1   51  174
early stop counter: 2
val acc:0.8602654337882996, best validation acc: 0.8774394989013672, corresponding to test acc:                         0.8133333325386047 / 0.8666666746139526
after epoch: 17,now: 2024-07-27 02:03:37.415392,epoch time: 0:01:47.459679,used: 0:30:36.551689,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_01_33_00_seed_1_23090482
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9899089, 'precision': 0.98993313, 'recall': 0.98999524, 'specificity': 0.98999524, 'f1': 0.9899087, 'auroc': 0.99962735, 'binary_precision': 0.99738735, 'binary_recall': 0.9826255, 'binary_specificity': 0.99736494, 'binary_f1_score': 0.9899514}
confusion matrix:
      0     1
0  1514     4
1    27  1527
---- Validation: 
scalar performance:
{'acc': 0.73614365, 'precision': 0.8083035, 'recall': 0.73213005, 'specificity': 0.73213005, 'f1': 0.7175101, 'auroc': 0.9183022, 'binary_precision': 0.95341617, 'binary_recall': 0.4873016, 'binary_specificity': 0.9769585, 'binary_f1_score': 0.644958}
confusion matrix:
     0    1
0  636   15
1  323  307
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.79333335, 'precision': 0.83953726, 'recall': 0.7933333, 'specificity': 0.7933333, 'f1': 0.78605497, 'auroc': 0.9094914, 'binary_precision': 0.96478873, 'binary_recall': 0.60888886, 'binary_specificity': 0.9777778, 'binary_f1_score': 0.746594}
confusion matrix:
     0    1
0  220    5
1   88  137
early stop counter: 3
val acc:0.7361436486244202, best validation acc: 0.8774394989013672, corresponding to test acc:                         0.8133333325386047 / 0.8666666746139526
after epoch: 18,now: 2024-07-27 02:05:24.593747,epoch time: 0:01:47.178355,used: 0:32:23.730044,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_01_33_00_seed_1_23090482
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.97721356, 'precision': 0.97787017, 'recall': 0.977512, 'specificity': 0.977512, 'f1': 0.9772119, 'auroc': 0.99953914, 'binary_precision': 0.99932843, 'binary_recall': 0.955684, 'binary_specificity': 0.99933994, 'binary_f1_score': 0.977019}
confusion matrix:
      0     1
0  1514     1
1    69  1488
---- Validation: 
scalar performance:
{'acc': 0.78844655, 'precision': 0.8344387, 'recall': 0.78538144, 'specificity': 0.78538144, 'f1': 0.77964616, 'auroc': 0.9271573, 'binary_precision': 0.9544304, 'binary_recall': 0.5984127, 'binary_specificity': 0.97235024, 'binary_f1_score': 0.73560977}
confusion matrix:
     0    1
0  633   18
1  253  377
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8422222, 'precision': 0.87338364, 'recall': 0.8422222, 'specificity': 0.8422222, 'f1': 0.83886015, 'auroc': 0.9208889, 'binary_precision': 0.98125, 'binary_recall': 0.69777775, 'binary_specificity': 0.9866667, 'binary_f1_score': 0.81558436}
confusion matrix:
     0    1
0  222    3
1   68  157
early stop counter: 4
val acc:0.7884465456008911, best validation acc: 0.8774394989013672, corresponding to test acc:                         0.8133333325386047 / 0.8666666746139526
after epoch: 19,now: 2024-07-27 02:07:12.105511,epoch time: 0:01:47.511764,used: 0:34:11.241808,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_01_33_00_seed_1_23090482
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.99088544, 'precision': 0.9908681, 'recall': 0.9909147, 'specificity': 0.9909147, 'f1': 0.99088466, 'auroc': 0.9996804, 'binary_precision': 0.9935317, 'binary_recall': 0.98841697, 'binary_specificity': 0.9934124, 'binary_f1_score': 0.99096775}
confusion matrix:
      0     1
0  1508    10
1    18  1536
---- Validation: 
scalar performance:
{'acc': 0.75800157, 'precision': 0.8158256, 'recall': 0.7544547, 'specificity': 0.7544547, 'f1': 0.7446422, 'auroc': 0.9253968, 'binary_precision': 0.94692737, 'binary_recall': 0.53809524, 'binary_specificity': 0.9708141, 'binary_f1_score': 0.68623483}
confusion matrix:
     0    1
0  632   19
1  291  339
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.84, 'precision': 0.87200934, 'recall': 0.84000003, 'specificity': 0.84000003, 'f1': 0.8364825, 'auroc': 0.9345975, 'binary_precision': 0.9811321, 'binary_recall': 0.6933333, 'binary_specificity': 0.9866667, 'binary_f1_score': 0.8125}
confusion matrix:
     0    1
0  222    3
1   69  156
early stop counter: 5
val acc:0.7580015659332275, best validation acc: 0.8774394989013672, corresponding to test acc:                         0.8133333325386047 / 0.8666666746139526
after epoch: 20,now: 2024-07-27 02:08:59.744922,epoch time: 0:01:47.639411,used: 0:35:58.881219,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_01_33_00_seed_1_23090482
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 20 with time: 0:35:58.881219 at 2024-07-27 02:08:59.744922
persisted model performance metric: 

scalar performance:
{'acc': 0.81333333, 'precision': 0.8246454, 'recall': 0.8133334, 'specificity': 0.8133334, 'f1': 0.811693, 'auroc': 0.88643956, 'binary_precision': 0.8852459, 'binary_recall': 0.72, 'binary_specificity': 0.9066667, 'binary_f1_score': 0.7941177}
confusion matrix:
     0    1
0  204   21
1   63  162
oracle model performance metric: 

scalar performance:
{'acc': 0.8666667, 'precision': 0.8671308, 'recall': 0.8666667, 'specificity': 0.8666667, 'f1': 0.86662453, 'auroc': 0.91350126, 'binary_precision': 0.88018435, 'binary_recall': 0.8488889, 'binary_specificity': 0.8844444, 'binary_f1_score': 0.8642534}
confusion matrix:
     0    1
0  199   26
1   34  191
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_diva_irm_3seeds_nofreeze_2024-07-27_01-18-02/rule_results/4.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_diva_irm_3seeds_nofreeze_2024-07-27_01-18-02/confusion_matrix/4.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   1247 MiB |   7994 MiB | 179196 GiB | 179195 GiB |
|       from large pool |   1159 MiB |   7921 MiB | 177636 GiB | 177635 GiB |
|       from small pool |     88 MiB |    128 MiB |   1559 GiB |   1559 GiB |
|---------------------------------------------------------------------------|
| Active memory         |   1247 MiB |   7994 MiB | 179196 GiB | 179195 GiB |
|       from large pool |   1159 MiB |   7921 MiB | 177636 GiB | 177635 GiB |
|       from small pool |     88 MiB |    128 MiB |   1559 GiB |   1559 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |   1234 MiB |   7988 MiB | 179026 GiB | 179025 GiB |
|       from large pool |   1146 MiB |   7915 MiB | 177469 GiB | 177468 GiB |
|       from small pool |     88 MiB |    128 MiB |   1557 GiB |   1557 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   8840 MiB |   8856 MiB |  15464 MiB |   6624 MiB |
|       from large pool |   8702 MiB |   8722 MiB |  15290 MiB |   6588 MiB |
|       from small pool |    138 MiB |    138 MiB |    174 MiB |     36 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |   1168 MiB |   2131 MiB | 143978 GiB | 143977 GiB |
|       from large pool |   1158 MiB |   2123 MiB | 142372 GiB | 142370 GiB |
|       from small pool |      9 MiB |     47 MiB |   1606 GiB |   1606 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    2456    |    3301    |   25284 K  |   25281 K  |
|       from large pool |     382    |     808    |   12862 K  |   12861 K  |
|       from small pool |    2074    |    2766    |   12421 K  |   12419 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    2456    |    3301    |   25284 K  |   25281 K  |
|       from large pool |     382    |     808    |   12862 K  |   12861 K  |
|       from small pool |    2074    |    2766    |   12421 K  |   12419 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     258    |     270    |     403    |     145    |
|       from large pool |     189    |     203    |     316    |     127    |
|       from small pool |      69    |      69    |      87    |      18    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     156    |     319    |   13621 K  |   13621 K  |
|       from large pool |      82    |     207    |    7275 K  |    7275 K  |
|       from small pool |      74    |     235    |    6346 K  |    6345 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   7994 MiB | 179196 GiB | 179196 GiB |
|       from large pool |  16640 KiB |   7921 MiB | 177636 GiB | 177636 GiB |
|       from small pool |      0 KiB |    128 MiB |   1559 GiB |   1559 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   7994 MiB | 179196 GiB | 179196 GiB |
|       from large pool |  16640 KiB |   7921 MiB | 177636 GiB | 177636 GiB |
|       from small pool |      0 KiB |    128 MiB |   1559 GiB |   1559 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   7988 MiB | 179026 GiB | 179026 GiB |
|       from large pool |  16640 KiB |   7915 MiB | 177469 GiB | 177469 GiB |
|       from small pool |      0 KiB |    128 MiB |   1557 GiB |   1557 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2416 MiB |   8856 MiB |  15464 MiB |  13048 MiB |
|       from large pool |   2318 MiB |   8722 MiB |  15290 MiB |  12972 MiB |
|       from small pool |     98 MiB |    138 MiB |    174 MiB |     76 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   2131 MiB | 143979 GiB | 143979 GiB |
|       from large pool |  24320 KiB |   2123 MiB | 142372 GiB | 142372 GiB |
|       from small pool |      0 KiB |     53 MiB |   1606 GiB |   1606 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3301    |   25284 K  |   25284 K  |
|       from large pool |       2    |     808    |   12862 K  |   12862 K  |
|       from small pool |       0    |    2766    |   12421 K  |   12421 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3301    |   25284 K  |   25284 K  |
|       from large pool |       2    |     808    |   12862 K  |   12862 K  |
|       from small pool |       0    |    2766    |   12421 K  |   12421 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     124    |     270    |     403    |     279    |
|       from large pool |      75    |     203    |     316    |     241    |
|       from small pool |      49    |      69    |      87    |      38    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     319    |   13622 K  |   13622 K  |
|       from large pool |       3    |     207    |    7275 K  |    7275 K  |
|       from small pool |       0    |     235    |    6346 K  |    6346 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   7994 MiB | 179196 GiB | 179196 GiB |
|       from large pool |  16640 KiB |   7921 MiB | 177636 GiB | 177636 GiB |
|       from small pool |      0 KiB |    128 MiB |   1559 GiB |   1559 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   7994 MiB | 179196 GiB | 179196 GiB |
|       from large pool |  16640 KiB |   7921 MiB | 177636 GiB | 177636 GiB |
|       from small pool |      0 KiB |    128 MiB |   1559 GiB |   1559 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   7988 MiB | 179026 GiB | 179026 GiB |
|       from large pool |  16640 KiB |   7915 MiB | 177469 GiB | 177469 GiB |
|       from small pool |      0 KiB |    128 MiB |   1557 GiB |   1557 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2416 MiB |   8856 MiB |  15464 MiB |  13048 MiB |
|       from large pool |   2318 MiB |   8722 MiB |  15290 MiB |  12972 MiB |
|       from small pool |     98 MiB |    138 MiB |    174 MiB |     76 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   2131 MiB | 143979 GiB | 143979 GiB |
|       from large pool |  24320 KiB |   2123 MiB | 142372 GiB | 142372 GiB |
|       from small pool |      0 KiB |     53 MiB |   1606 GiB |   1606 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3301    |   25284 K  |   25284 K  |
|       from large pool |       2    |     808    |   12862 K  |   12862 K  |
|       from small pool |       0    |    2766    |   12421 K  |   12421 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3301    |   25284 K  |   25284 K  |
|       from large pool |       2    |     808    |   12862 K  |   12862 K  |
|       from small pool |       0    |    2766    |   12421 K  |   12421 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     124    |     270    |     403    |     279    |
|       from large pool |      75    |     203    |     316    |     241    |
|       from small pool |      49    |      69    |      87    |      38    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     319    |   13622 K  |   13622 K  |
|       from large pool |       3    |     207    |    7275 K  |    7275 K  |
|       from small pool |       0    |     235    |    6346 K  |    6346 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/init.py:452: UserWarning: Initializing zero-element tensors is a no-op
  warnings.warn("Initializing zero-element tensors is a no-op")
Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main

using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_02_09_32_seed_2_23090482

 Experiment start at: 2024-07-27 02:09:32.970834
hyper-parameter scheduler not set,going to use default Warmpup and epoch update
before training, model accuracy: 0.5046296119689941
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.934555, 'precision': 0.9348922, 'recall': 0.93445325, 'specificity': 0.93445325, 'f1': 0.934528, 'auroc': 0.9846499, 'binary_precision': 0.9245881, 'binary_recall': 0.9474026, 'binary_specificity': 0.92150396, 'binary_f1_score': 0.9358563}
confusion matrix:
      0     1
0  1397   119
1    81  1459
---- Validation: 
scalar performance:
{'acc': 0.7762128, 'precision': 0.7990659, 'recall': 0.779804, 'specificity': 0.779804, 'f1': 0.77325356, 'auroc': 0.8955523, 'binary_precision': 0.7094763, 'binary_recall': 0.914791, 'binary_specificity': 0.64481705, 'binary_f1_score': 0.79915726}
confusion matrix:
     0    1
0  423  233
1   53  569
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6944444, 'precision': 0.7625304, 'recall': 0.6944444, 'specificity': 0.6944444, 'f1': 0.67325985, 'auroc': 0.91051525, 'binary_precision': 0.62883437, 'binary_recall': 0.9490741, 'binary_specificity': 0.4398148, 'binary_f1_score': 0.75645757}
confusion matrix:
    0    1
0  95  121
1  11  205
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-27 02:11:23.088286,epoch time: 0:01:50.117452,used: 0:01:50.117452,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_02_09_32_seed_2_23090482
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.96007854, 'precision': 0.9605149, 'recall': 0.9599681, 'specificity': 0.9599681, 'f1': 0.9600599, 'auroc': 0.99417937, 'binary_precision': 0.9481669, 'binary_recall': 0.97402596, 'binary_specificity': 0.9459103, 'binary_f1_score': 0.9609225}
confusion matrix:
      0     1
0  1434    82
1    40  1500
---- Validation: 
scalar performance:
{'acc': 0.80125195, 'precision': 0.81340504, 'recall': 0.8038193, 'specificity': 0.8038193, 'f1': 0.8001241, 'auroc': 0.89937556, 'binary_precision': 0.7446808, 'binary_recall': 0.90032154, 'binary_specificity': 0.70731705, 'binary_f1_score': 0.8151383}
confusion matrix:
     0    1
0  464  192
1   62  560
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8078704, 'precision': 0.8193774, 'recall': 0.8078704, 'specificity': 0.8078704, 'f1': 0.80612403, 'auroc': 0.9019419, 'binary_precision': 0.75875485, 'binary_recall': 0.9027778, 'binary_specificity': 0.712963, 'binary_f1_score': 0.8245243}
confusion matrix:
     0    1
0  154   62
1   21  195
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-07-27 02:13:10.460564,epoch time: 0:01:47.372278,used: 0:03:37.489730,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_02_09_32_seed_2_23090482
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.96629584, 'precision': 0.966776, 'recall': 0.9664351, 'specificity': 0.9664351, 'f1': 0.9662923, 'auroc': 0.99513197, 'binary_precision': 0.9838384, 'binary_recall': 0.9487013, 'binary_specificity': 0.9841689, 'binary_f1_score': 0.96595037}
confusion matrix:
      0     1
0  1492    24
1    79  1461
---- Validation: 
scalar performance:
{'acc': 0.8317684, 'precision': 0.83173, 'recall': 0.8319617, 'specificity': 0.8319617, 'f1': 0.8317312, 'auroc': 0.9002309, 'binary_precision': 0.81946623, 'binary_recall': 0.8392283, 'binary_specificity': 0.8246951, 'binary_f1_score': 0.82922953}
confusion matrix:
     0    1
0  541  115
1  100  522
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8564815, 'precision': 0.8579854, 'recall': 0.8564815, 'specificity': 0.8564815, 'f1': 0.85633063, 'auroc': 0.9051354, 'binary_precision': 0.8811881, 'binary_recall': 0.8240741, 'binary_specificity': 0.8888889, 'binary_f1_score': 0.8516746}
confusion matrix:
     0    1
0  192   24
1   38  178
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-07-27 02:14:58.141492,epoch time: 0:01:47.680928,used: 0:05:25.170658,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_02_09_32_seed_2_23090482
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.96040577, 'precision': 0.9611688, 'recall': 0.9602568, 'specificity': 0.9602568, 'f1': 0.96037793, 'auroc': 0.99544036, 'binary_precision': 0.9442705, 'binary_recall': 0.9792208, 'binary_specificity': 0.9412929, 'binary_f1_score': 0.96142817}
confusion matrix:
      0     1
0  1427    89
1    32  1508
---- Validation: 
scalar performance:
{'acc': 0.7910798, 'precision': 0.8051522, 'recall': 0.79386914, 'specificity': 0.79386914, 'f1': 0.789605, 'auroc': 0.8968978, 'binary_precision': 0.73263437, 'binary_recall': 0.8987138, 'binary_specificity': 0.6890244, 'binary_f1_score': 0.8072202}
confusion matrix:
     0    1
0  452  204
1   63  559
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8240741, 'precision': 0.828125, 'recall': 0.82407403, 'specificity': 0.82407403, 'f1': 0.82352936, 'auroc': 0.9072574, 'binary_precision': 0.7916667, 'binary_recall': 0.8796296, 'binary_specificity': 0.7685185, 'binary_f1_score': 0.8333333}
confusion matrix:
     0    1
0  166   50
1   26  190
early stop counter: 1
val acc:0.7910798192024231, best validation acc: 0.8317683935165405, corresponding to test acc:                         0.8564814925193787 / 0.8564814925193787
after epoch: 4,now: 2024-07-27 02:16:44.741500,epoch time: 0:01:46.600008,used: 0:07:11.770666,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_02_09_32_seed_2_23090482
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9689136, 'precision': 0.97011113, 'recall': 0.96912503, 'specificity': 0.96912503, 'f1': 0.968902, 'auroc': 0.99686927, 'binary_precision': 0.995882, 'binary_recall': 0.9422078, 'binary_specificity': 0.9960422, 'binary_f1_score': 0.96830165}
confusion matrix:
      0     1
0  1510     6
1    89  1451
---- Validation: 
scalar performance:
{'acc': 0.814554, 'precision': 0.8369982, 'recall': 0.8110688, 'specificity': 0.8110688, 'f1': 0.81013364, 'auroc': 0.90207386, 'binary_precision': 0.9175705, 'binary_recall': 0.6800643, 'binary_specificity': 0.94207317, 'binary_f1_score': 0.7811634}
confusion matrix:
     0    1
0  618   38
1  199  423
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.837963, 'precision': 0.858755, 'recall': 0.837963, 'specificity': 0.837963, 'f1': 0.8355807, 'auroc': 0.9274262, 'binary_precision': 0.94512194, 'binary_recall': 0.7175926, 'binary_specificity': 0.9583333, 'binary_f1_score': 0.8157895}
confusion matrix:
     0    1
0  207    9
1   61  155
early stop counter: 2
val acc:0.81455397605896, best validation acc: 0.8317683935165405, corresponding to test acc:                         0.8564814925193787 / 0.8564814925193787
after epoch: 5,now: 2024-07-27 02:18:31.495043,epoch time: 0:01:46.753543,used: 0:08:58.524209,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_02_09_32_seed_2_23090482
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9826571, 'precision': 0.9826494, 'recall': 0.982674, 'specificity': 0.982674, 'f1': 0.98265654, 'auroc': 0.9984164, 'binary_precision': 0.98499674, 'binary_recall': 0.9805195, 'binary_specificity': 0.9848285, 'binary_f1_score': 0.98275304}
confusion matrix:
      0     1
0  1493    23
1    30  1510
---- Validation: 
scalar performance:
{'acc': 0.81377155, 'precision': 0.8214723, 'recall': 0.8116398, 'specificity': 0.8116398, 'f1': 0.81182444, 'auroc': 0.8903027, 'binary_precision': 0.865019, 'binary_recall': 0.73151124, 'binary_specificity': 0.8917683, 'binary_f1_score': 0.79268295}
confusion matrix:
     0    1
0  585   71
1  167  455
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.787037, 'precision': 0.8411105, 'recall': 0.787037, 'specificity': 0.787037, 'f1': 0.7782489, 'auroc': 0.9192815, 'binary_precision': 0.97692305, 'binary_recall': 0.587963, 'binary_specificity': 0.9861111, 'binary_f1_score': 0.73410404}
confusion matrix:
     0    1
0  213    3
1   89  127
early stop counter: 3
val acc:0.8137715458869934, best validation acc: 0.8317683935165405, corresponding to test acc:                         0.8564814925193787 / 0.8564814925193787
after epoch: 6,now: 2024-07-27 02:20:18.310157,epoch time: 0:01:46.815114,used: 0:10:45.339323,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_02_09_32_seed_2_23090482
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.98003924, 'precision': 0.98038125, 'recall': 0.9801588, 'specificity': 0.9801588, 'f1': 0.9800381, 'auroc': 0.9973093, 'binary_precision': 0.99531144, 'binary_recall': 0.96493506, 'binary_specificity': 0.9953826, 'binary_f1_score': 0.97988784}
confusion matrix:
      0     1
0  1509     7
1    54  1486
---- Validation: 
scalar performance:
{'acc': 0.85289514, 'precision': 0.8650888, 'recall': 0.8504578, 'specificity': 0.8504578, 'f1': 0.85094994, 'auroc': 0.9274076, 'binary_precision': 0.9254902, 'binary_recall': 0.75884247, 'binary_specificity': 0.94207317, 'binary_f1_score': 0.8339223}
confusion matrix:
     0    1
0  618   38
1  150  472
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7916667, 'precision': 0.84971213, 'recall': 0.7916667, 'specificity': 0.7916667, 'f1': 0.7826476, 'auroc': 0.9380573, 'binary_precision': 0.9921875, 'binary_recall': 0.587963, 'binary_specificity': 0.9953704, 'binary_f1_score': 0.73837215}
confusion matrix:
     0    1
0  215    1
1   89  127
better model found
persisted
after epoch: 7,now: 2024-07-27 02:22:05.520668,epoch time: 0:01:47.210511,used: 0:12:32.549834,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_02_09_32_seed_2_23090482
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9790576, 'precision': 0.9795683, 'recall': 0.97920024, 'specificity': 0.97920024, 'f1': 0.9790553, 'auroc': 0.9985707, 'binary_precision': 0.99730456, 'binary_recall': 0.96103895, 'binary_specificity': 0.9973615, 'binary_f1_score': 0.97883594}
confusion matrix:
      0     1
0  1512     4
1    60  1480
---- Validation: 
scalar performance:
{'acc': 0.7300469, 'precision': 0.8005786, 'recall': 0.72346044, 'specificity': 0.72346044, 'f1': 0.7093546, 'auroc': 0.9124137, 'binary_precision': 0.93968254, 'binary_recall': 0.47588426, 'binary_specificity': 0.9710366, 'binary_f1_score': 0.63180363}
confusion matrix:
     0    1
0  637   19
1  326  296
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5740741, 'precision': 0.77, 'recall': 0.5740741, 'specificity': 0.5740741, 'f1': 0.47968164, 'auroc': 0.9085648, 'binary_precision': 1.0, 'binary_recall': 0.14814815, 'binary_specificity': 1.0, 'binary_f1_score': 0.2580645}
confusion matrix:
     0   1
0  216   0
1  184  32
early stop counter: 1
val acc:0.7300469279289246, best validation acc: 0.8528951406478882, corresponding to test acc:                         0.7916666865348816 / 0.8564814925193787
after epoch: 8,now: 2024-07-27 02:23:52.111910,epoch time: 0:01:46.591242,used: 0:14:19.141076,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_02_09_32_seed_2_23090482
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9806937, 'precision': 0.98068786, 'recall': 0.98071563, 'specificity': 0.98071563, 'f1': 0.9806932, 'auroc': 0.99878776, 'binary_precision': 0.98367083, 'binary_recall': 0.9779221, 'binary_specificity': 0.98350924, 'binary_f1_score': 0.980788}
confusion matrix:
      0     1
0  1491    25
1    34  1506
---- Validation: 
scalar performance:
{'acc': 0.79890454, 'precision': 0.81893027, 'recall': 0.7954916, 'specificity': 0.7954916, 'f1': 0.7943102, 'auroc': 0.89398134, 'binary_precision': 0.8924731, 'binary_recall': 0.6672026, 'binary_specificity': 0.9237805, 'binary_f1_score': 0.7635695}
confusion matrix:
     0    1
0  606   50
1  207  415
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7037037, 'precision': 0.7946428, 'recall': 0.7037037, 'specificity': 0.7037037, 'f1': 0.67892975, 'auroc': 0.9189601, 'binary_precision': 0.9583333, 'binary_recall': 0.42592594, 'binary_specificity': 0.9814815, 'binary_f1_score': 0.5897436}
confusion matrix:
     0   1
0  212   4
1  124  92
early stop counter: 2
val acc:0.798904538154602, best validation acc: 0.8528951406478882, corresponding to test acc:                         0.7916666865348816 / 0.8564814925193787
after epoch: 9,now: 2024-07-27 02:25:38.842731,epoch time: 0:01:46.730821,used: 0:16:05.871897,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_02_09_32_seed_2_23090482
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9787304, 'precision': 0.9788748, 'recall': 0.9788139, 'specificity': 0.9788139, 'f1': 0.9787302, 'auroc': 0.9977131, 'binary_precision': 0.98938286, 'binary_recall': 0.9681818, 'binary_specificity': 0.9894459, 'binary_f1_score': 0.97866756}
confusion matrix:
      0     1
0  1500    16
1    49  1491
---- Validation: 
scalar performance:
{'acc': 0.81924886, 'precision': 0.82331485, 'recall': 0.81768346, 'specificity': 0.81768346, 'f1': 0.8180671, 'auroc': 0.87913203, 'binary_precision': 0.85352623, 'binary_recall': 0.75884247, 'binary_specificity': 0.8765244, 'binary_f1_score': 0.8034043}
confusion matrix:
     0    1
0  575   81
1  150  472
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8310185, 'precision': 0.84897757, 'recall': 0.8310185, 'specificity': 0.8310185, 'f1': 0.8288162, 'auroc': 0.92241085, 'binary_precision': 0.92814374, 'binary_recall': 0.7175926, 'binary_specificity': 0.9444444, 'binary_f1_score': 0.8093995}
confusion matrix:
     0    1
0  204   12
1   61  155
early stop counter: 3
val acc:0.8192488551139832, best validation acc: 0.8528951406478882, corresponding to test acc:                         0.7916666865348816 / 0.8564814925193787
after epoch: 10,now: 2024-07-27 02:27:25.525122,epoch time: 0:01:46.682391,used: 0:17:52.554288,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_02_09_32_seed_2_23090482
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9882199, 'precision': 0.98821914, 'recall': 0.98821914, 'specificity': 0.98821914, 'f1': 0.98821914, 'auroc': 0.9991236, 'binary_precision': 0.9883117, 'binary_recall': 0.9883117, 'binary_specificity': 0.98812664, 'binary_f1_score': 0.9883117}
confusion matrix:
      0     1
0  1498    18
1    18  1522
---- Validation: 
scalar performance:
{'acc': 0.86463225, 'precision': 0.8645632, 'recall': 0.8648072, 'specificity': 0.8648072, 'f1': 0.86459565, 'auroc': 0.9203347, 'binary_precision': 0.8535433, 'binary_recall': 0.87138265, 'binary_specificity': 0.8582317, 'binary_f1_score': 0.86237067}
confusion matrix:
     0    1
0  563   93
1   80  542
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8587963, 'precision': 0.85972923, 'recall': 0.8587963, 'specificity': 0.8587963, 'f1': 0.8587047, 'auroc': 0.9325489, 'binary_precision': 0.8780488, 'binary_recall': 0.8333333, 'binary_specificity': 0.8842593, 'binary_f1_score': 0.85510683}
confusion matrix:
     0    1
0  191   25
1   36  180
new oracle model saved
better model found
persisted
after epoch: 11,now: 2024-07-27 02:29:13.173389,epoch time: 0:01:47.648267,used: 0:19:40.202555,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_02_09_32_seed_2_23090482
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.97742146, 'precision': 0.97795165, 'recall': 0.97756654, 'specificity': 0.97756654, 'f1': 0.97741884, 'auroc': 0.9984462, 'binary_precision': 0.99595416, 'binary_recall': 0.9590909, 'binary_specificity': 0.9960422, 'binary_f1_score': 0.977175}
confusion matrix:
      0     1
0  1510     6
1    63  1477
---- Validation: 
scalar performance:
{'acc': 0.86150235, 'precision': 0.86877537, 'recall': 0.85963356, 'specificity': 0.85963356, 'f1': 0.86029106, 'auroc': 0.92638814, 'binary_precision': 0.91433895, 'binary_recall': 0.7893891, 'binary_specificity': 0.92987806, 'binary_f1_score': 0.8472822}
confusion matrix:
     0    1
0  610   46
1  131  491
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8564815, 'precision': 0.87841284, 'recall': 0.8564815, 'specificity': 0.8564815, 'f1': 0.8543714, 'auroc': 0.9270619, 'binary_precision': 0.9695122, 'binary_recall': 0.7361111, 'binary_specificity': 0.9768519, 'binary_f1_score': 0.83684206}
confusion matrix:
     0    1
0  211    5
1   57  159
early stop counter: 1
val acc:0.8615023493766785, best validation acc: 0.864632248878479, corresponding to test acc:                         0.8587962985038757 / 0.8587962985038757
after epoch: 12,now: 2024-07-27 02:30:59.910907,epoch time: 0:01:46.737518,used: 0:21:26.940073,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_02_09_32_seed_2_23090482
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9849476, 'precision': 0.9849404, 'recall': 0.984957, 'specificity': 0.984957, 'f1': 0.98494697, 'auroc': 0.99889684, 'binary_precision': 0.9863281, 'binary_recall': 0.98376626, 'binary_specificity': 0.98614776, 'binary_f1_score': 0.9850455}
confusion matrix:
      0     1
0  1495    21
1    25  1515
---- Validation: 
scalar performance:
{'acc': 0.8419405, 'precision': 0.85883486, 'recall': 0.8390371, 'specificity': 0.8390371, 'f1': 0.83916116, 'auroc': 0.91832507, 'binary_precision': 0.9303279, 'binary_recall': 0.7299035, 'binary_specificity': 0.9481707, 'binary_f1_score': 0.8180181}
confusion matrix:
     0    1
0  622   34
1  168  454
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8171296, 'precision': 0.8632971, 'recall': 0.8171296, 'specificity': 0.8171296, 'f1': 0.8111292, 'auroc': 0.92721194, 'binary_precision': 0.9928058, 'binary_recall': 0.6388889, 'binary_specificity': 0.9953704, 'binary_f1_score': 0.7774648}
confusion matrix:
     0    1
0  215    1
1   78  138
early stop counter: 2
val acc:0.8419405221939087, best validation acc: 0.864632248878479, corresponding to test acc:                         0.8587962985038757 / 0.8587962985038757
after epoch: 13,now: 2024-07-27 02:32:46.786318,epoch time: 0:01:46.875411,used: 0:23:13.815484,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_02_09_32_seed_2_23090482
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9446989, 'precision': 0.94985163, 'recall': 0.9451299, 'specificity': 0.9451299, 'f1': 0.9445742, 'auroc': 0.99819714, 'binary_precision': 1.0, 'binary_recall': 0.89025974, 'binary_specificity': 1.0, 'binary_f1_score': 0.94194436}
confusion matrix:
      0     1
0  1516     0
1   169  1371
---- Validation: 
scalar performance:
{'acc': 0.6118936, 'precision': 0.7700397, 'recall': 0.6014528, 'specificity': 0.6014528, 'f1': 0.5341799, 'auroc': 0.8800609, 'binary_precision': 0.9701493, 'binary_recall': 0.20900321, 'binary_specificity': 0.99390244, 'binary_f1_score': 0.34391534}
confusion matrix:
     0    1
0  652    4
1  492  130
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5486111, 'precision': 0.76277375, 'recall': 0.5486111, 'specificity': 0.5486111, 'f1': 0.43310517, 'auroc': 0.91896003, 'binary_precision': 1.0, 'binary_recall': 0.097222224, 'binary_specificity': 1.0, 'binary_f1_score': 0.17721519}
confusion matrix:
     0   1
0  216   0
1  195  21
early stop counter: 3
val acc:0.6118935942649841, best validation acc: 0.864632248878479, corresponding to test acc:                         0.8587962985038757 / 0.8587962985038757
after epoch: 14,now: 2024-07-27 02:34:33.556111,epoch time: 0:01:46.769793,used: 0:25:00.585277,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_02_09_32_seed_2_23090482
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9882199, 'precision': 0.98821914, 'recall': 0.98821914, 'specificity': 0.98821914, 'f1': 0.98821914, 'auroc': 0.99888253, 'binary_precision': 0.9883117, 'binary_recall': 0.9883117, 'binary_specificity': 0.98812664, 'binary_f1_score': 0.9883117}
confusion matrix:
      0     1
0  1498    18
1    18  1522
---- Validation: 
scalar performance:
{'acc': 0.8364632, 'precision': 0.8408468, 'recall': 0.83491004, 'specificity': 0.83491004, 'f1': 0.835394, 'auroc': 0.8977678, 'binary_precision': 0.87341774, 'binary_recall': 0.77652735, 'binary_specificity': 0.89329267, 'binary_f1_score': 0.8221277}
confusion matrix:
     0    1
0  586   70
1  139  483
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8194444, 'precision': 0.85018796, 'recall': 0.8194444, 'specificity': 0.8194444, 'f1': 0.8153927, 'auroc': 0.9177383, 'binary_precision': 0.95394737, 'binary_recall': 0.6712963, 'binary_specificity': 0.9675926, 'binary_f1_score': 0.7880435}
confusion matrix:
     0    1
0  209    7
1   71  145
early stop counter: 4
val acc:0.836463212966919, best validation acc: 0.864632248878479, corresponding to test acc:                         0.8587962985038757 / 0.8587962985038757
after epoch: 15,now: 2024-07-27 02:36:20.668363,epoch time: 0:01:47.112252,used: 0:26:47.697529,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_02_09_32_seed_2_23090482
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9676047, 'precision': 0.9684336, 'recall': 0.9674511, 'specificity': 0.9674511, 'f1': 0.9675808, 'auroc': 0.9976635, 'binary_precision': 0.9505941, 'binary_recall': 0.987013, 'binary_specificity': 0.9478892, 'binary_f1_score': 0.96846133}
confusion matrix:
      0     1
0  1437    79
1    20  1520
---- Validation: 
scalar performance:
{'acc': 0.8388106, 'precision': 0.8387556, 'recall': 0.83898807, 'specificity': 0.83898807, 'f1': 0.8387711, 'auroc': 0.9036154, 'binary_precision': 0.827044, 'binary_recall': 0.84565914, 'binary_specificity': 0.83231705, 'binary_f1_score': 0.836248}
confusion matrix:
     0    1
0  546  110
1   96  526
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7986111, 'precision': 0.79866874, 'recall': 0.79861116, 'specificity': 0.79861116, 'f1': 0.7986014, 'auroc': 0.8995627, 'binary_precision': 0.8028169, 'binary_recall': 0.7916667, 'binary_specificity': 0.8055556, 'binary_f1_score': 0.7972028}
confusion matrix:
     0    1
0  174   42
1   45  171
early stop counter: 5
val acc:0.8388106226921082, best validation acc: 0.864632248878479, corresponding to test acc:                         0.8587962985038757 / 0.8587962985038757
after epoch: 16,now: 2024-07-27 02:38:07.377234,epoch time: 0:01:46.708871,used: 0:28:34.406400,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_02_09_32_seed_2_23090482
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 16 with time: 0:28:34.406400 at 2024-07-27 02:38:07.377234
persisted model performance metric: 

scalar performance:
{'acc': 0.8587963, 'precision': 0.85972923, 'recall': 0.8587963, 'specificity': 0.8587963, 'f1': 0.8587047, 'auroc': 0.9325489, 'binary_precision': 0.8780488, 'binary_recall': 0.8333333, 'binary_specificity': 0.8842593, 'binary_f1_score': 0.85510683}
confusion matrix:
     0    1
0  191   25
1   36  180
oracle model performance metric: 

scalar performance:
{'acc': 0.8587963, 'precision': 0.85972923, 'recall': 0.8587963, 'specificity': 0.8587963, 'f1': 0.8587047, 'auroc': 0.9325489, 'binary_precision': 0.8780488, 'binary_recall': 0.8333333, 'binary_specificity': 0.8842593, 'binary_f1_score': 0.85510683}
confusion matrix:
     0    1
0  191   25
1   36  180
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_diva_irm_3seeds_nofreeze_2024-07-27_01-18-02/rule_results/4.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_diva_irm_3seeds_nofreeze_2024-07-27_01-18-02/confusion_matrix/4.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   1252 MiB |   7996 MiB | 284806 GiB | 284805 GiB |
|       from large pool |   1164 MiB |   7923 MiB | 282332 GiB | 282331 GiB |
|       from small pool |     88 MiB |    128 MiB |   2473 GiB |   2473 GiB |
|---------------------------------------------------------------------------|
| Active memory         |   1252 MiB |   7996 MiB | 284806 GiB | 284805 GiB |
|       from large pool |   1164 MiB |   7923 MiB | 282332 GiB | 282331 GiB |
|       from small pool |     88 MiB |    128 MiB |   2473 GiB |   2473 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |   1234 MiB |   7988 MiB | 284499 GiB | 284498 GiB |
|       from large pool |   1146 MiB |   7915 MiB | 282029 GiB | 282028 GiB |
|       from small pool |     88 MiB |    128 MiB |   2470 GiB |   2470 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   8826 MiB |   8856 MiB |  21874 MiB |  13048 MiB |
|       from large pool |   8692 MiB |   8722 MiB |  21664 MiB |  12972 MiB |
|       from small pool |    134 MiB |    138 MiB |    210 MiB |     76 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |   1285 MiB |   2131 MiB | 230669 GiB | 230668 GiB |
|       from large pool |   1275 MiB |   2123 MiB | 228125 GiB | 228124 GiB |
|       from small pool |      9 MiB |     53 MiB |   2544 GiB |   2544 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    2444    |    3301    |   40157 K  |   40155 K  |
|       from large pool |     382    |     808    |   20437 K  |   20436 K  |
|       from small pool |    2062    |    2766    |   19720 K  |   19718 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    2444    |    3301    |   40157 K  |   40155 K  |
|       from large pool |     382    |     808    |   20437 K  |   20436 K  |
|       from small pool |    2062    |    2766    |   19720 K  |   19718 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     250    |     270    |     529    |     279    |
|       from large pool |     183    |     203    |     424    |     241    |
|       from small pool |      67    |      69    |     105    |      38    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     157    |     319    |   21456 K  |   21456 K  |
|       from large pool |      81    |     207    |   11411 K  |   11411 K  |
|       from small pool |      76    |     235    |   10044 K  |   10044 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   7996 MiB | 284806 GiB | 284806 GiB |
|       from large pool |  16640 KiB |   7923 MiB | 282332 GiB | 282332 GiB |
|       from small pool |      0 KiB |    128 MiB |   2473 GiB |   2473 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   7996 MiB | 284806 GiB | 284806 GiB |
|       from large pool |  16640 KiB |   7923 MiB | 282332 GiB | 282332 GiB |
|       from small pool |      0 KiB |    128 MiB |   2473 GiB |   2473 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   7988 MiB | 284499 GiB | 284499 GiB |
|       from large pool |  16640 KiB |   7915 MiB | 282029 GiB | 282029 GiB |
|       from small pool |      0 KiB |    128 MiB |   2470 GiB |   2470 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2538 MiB |   8856 MiB |  21874 MiB |  19336 MiB |
|       from large pool |   2440 MiB |   8722 MiB |  21664 MiB |  19224 MiB |
|       from small pool |     98 MiB |    138 MiB |    210 MiB |    112 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   2131 MiB | 230670 GiB | 230670 GiB |
|       from large pool |  24320 KiB |   2123 MiB | 228125 GiB | 228125 GiB |
|       from small pool |      0 KiB |     53 MiB |   2544 GiB |   2544 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3301    |   40157 K  |   40157 K  |
|       from large pool |       2    |     808    |   20437 K  |   20437 K  |
|       from small pool |       0    |    2766    |   19720 K  |   19720 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3301    |   40157 K  |   40157 K  |
|       from large pool |       2    |     808    |   20437 K  |   20437 K  |
|       from small pool |       0    |    2766    |   19720 K  |   19720 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     126    |     270    |     529    |     403    |
|       from large pool |      77    |     203    |     424    |     347    |
|       from small pool |      49    |      69    |     105    |      56    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     319    |   21456 K  |   21456 K  |
|       from large pool |       3    |     207    |   11411 K  |   11411 K  |
|       from small pool |       0    |     235    |   10044 K  |   10044 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Sat Jul 27 02:38:16 2024]
Finished job 0.
1 of 1 steps (100%) done
