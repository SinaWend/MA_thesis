Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Sat Jul 27 02:15:21 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_diva_irm_3seeds_nofreeze_2024-07-27_01-18-02/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_diva_irm_3seeds_nofreeze_2024-07-27_01-18-02/rule_results/8.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=8
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/swiglu_ffn.py:51: UserWarning: xFormers is not available (SwiGLU)
  warnings.warn("xFormers is not available (SwiGLU)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/attention.py:33: UserWarning: xFormers is not available (Attention)
  warnings.warn("xFormers is not available (Attention)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/block.py:40: UserWarning: xFormers is not available (Block)
  warnings.warn("xFormers is not available (Block)")
Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main

using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_02_16_04_seed_0_23090492

 Experiment start at: 2024-07-27 02:16:05.437329
hyper-parameter scheduler not set,going to use default Warmpup and epoch update
before training, model accuracy: 0.48604652285575867
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9199219, 'precision': 0.9236114, 'recall': 0.91936195, 'specificity': 0.91936195, 'f1': 0.91966414, 'auroc': 0.98684657, 'binary_precision': 0.8870491, 'binary_recall': 0.96463025, 'binary_specificity': 0.8740936, 'binary_f1_score': 0.9242144}
confusion matrix:
      0     1
0  1326   191
1    55  1500
---- Validation: 
scalar performance:
{'acc': 0.73447204, 'precision': 0.7557087, 'recall': 0.73643875, 'specificity': 0.73643875, 'f1': 0.7298764, 'auroc': 0.8239114, 'binary_precision': 0.6784409, 'binary_recall': 0.8771654, 'binary_specificity': 0.5957121, 'binary_f1_score': 0.76510984}
confusion matrix:
     0    1
0  389  264
1   78  557
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8418605, 'precision': 0.8433162, 'recall': 0.8418605, 'specificity': 0.8418605, 'f1': 0.8416927, 'auroc': 0.93256897, 'binary_precision': 0.8209607, 'binary_recall': 0.8744186, 'binary_specificity': 0.80930233, 'binary_f1_score': 0.8468469}
confusion matrix:
     0    1
0  174   41
1   27  188
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-27 02:18:58.070319,epoch time: 0:02:52.632990,used: 0:02:52.632990,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_02_16_04_seed_0_23090492
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9560547, 'precision': 0.9574282, 'recall': 0.95648867, 'specificity': 0.95648867, 'f1': 0.9560425, 'auroc': 0.9928727, 'binary_precision': 0.98632944, 'binary_recall': 0.9261874, 'binary_specificity': 0.98678994, 'binary_f1_score': 0.9553128}
confusion matrix:
      0     1
0  1494    20
1   115  1443
---- Validation: 
scalar performance:
{'acc': 0.7531056, 'precision': 0.7586031, 'recall': 0.7520373, 'specificity': 0.7520373, 'f1': 0.7512245, 'auroc': 0.8352703, 'binary_precision': 0.79297596, 'binary_recall': 0.6755906, 'binary_specificity': 0.82848394, 'binary_f1_score': 0.72959185}
confusion matrix:
     0    1
0  541  112
1  206  429
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8116279, 'precision': 0.81277144, 'recall': 0.8116279, 'specificity': 0.8116279, 'f1': 0.81145555, 'auroc': 0.8915955, 'binary_precision': 0.79385966, 'binary_recall': 0.8418605, 'binary_specificity': 0.7813954, 'binary_f1_score': 0.8171557}
confusion matrix:
     0    1
0  168   47
1   34  181
better model found
persisted
after epoch: 2,now: 2024-07-27 02:21:44.957910,epoch time: 0:02:46.887591,used: 0:05:39.520581,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_02_16_04_seed_0_23090492
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.96516925, 'precision': 0.96653247, 'recall': 0.96555763, 'specificity': 0.96555763, 'f1': 0.96515894, 'auroc': 0.99670434, 'binary_precision': 0.9952153, 'binary_recall': 0.93573266, 'binary_specificity': 0.9953826, 'binary_f1_score': 0.96455777}
confusion matrix:
      0     1
0  1509     7
1   100  1456
---- Validation: 
scalar performance:
{'acc': 0.7251553, 'precision': 0.72688407, 'recall': 0.72447217, 'specificity': 0.72447217, 'f1': 0.724195, 'auroc': 0.82225704, 'binary_precision': 0.7435009, 'binary_recall': 0.6755906, 'binary_specificity': 0.77335376, 'binary_f1_score': 0.7079208}
confusion matrix:
     0    1
0  505  148
1  206  429
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.73953485, 'precision': 0.7628237, 'recall': 0.73953485, 'specificity': 0.73953485, 'f1': 0.73363423, 'auroc': 0.8700919, 'binary_precision': 0.8410596, 'binary_recall': 0.59069765, 'binary_specificity': 0.88837206, 'binary_f1_score': 0.69398904}
confusion matrix:
     0    1
0  191   24
1   88  127
early stop counter: 1
val acc:0.7251552939414978, best validation acc: 0.7531055808067322, corresponding to test acc:                         0.8116279244422913 / 0.8418604731559753
after epoch: 3,now: 2024-07-27 02:24:30.777512,epoch time: 0:02:45.819602,used: 0:08:25.340183,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_02_16_04_seed_0_23090492
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9628906, 'precision': 0.96286905, 'recall': 0.96294606, 'specificity': 0.96294606, 'f1': 0.9628876, 'auroc': 0.99383676, 'binary_precision': 0.9675956, 'binary_recall': 0.9588953, 'binary_specificity': 0.9669967, 'binary_f1_score': 0.96322584}
confusion matrix:
      0     1
0  1465    50
1    64  1493
---- Validation: 
scalar performance:
{'acc': 0.6040373, 'precision': 0.6400415, 'recall': 0.60033524, 'specificity': 0.60033524, 'f1': 0.5720763, 'auroc': 0.75079036, 'binary_precision': 0.7076412, 'binary_recall': 0.33543307, 'binary_specificity': 0.86523736, 'binary_f1_score': 0.45512822}
confusion matrix:
     0    1
0  565   88
1  422  213
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6534884, 'precision': 0.6852287, 'recall': 0.6534884, 'specificity': 0.6534884, 'f1': 0.6379796, 'auroc': 0.8087182, 'binary_precision': 0.7619048, 'binary_recall': 0.44651163, 'binary_specificity': 0.8604651, 'binary_f1_score': 0.56304985}
confusion matrix:
     0   1
0  185  30
1  119  96
early stop counter: 2
val acc:0.6040372848510742, best validation acc: 0.7531055808067322, corresponding to test acc:                         0.8116279244422913 / 0.8418604731559753
after epoch: 4,now: 2024-07-27 02:27:16.446134,epoch time: 0:02:45.668622,used: 0:11:11.008805,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_02_16_04_seed_0_23090492
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9736328, 'precision': 0.97417426, 'recall': 0.9739083, 'specificity': 0.9739083, 'f1': 0.9736316, 'auroc': 0.9972521, 'binary_precision': 0.9939759, 'binary_recall': 0.9537572, 'binary_specificity': 0.9940594, 'binary_f1_score': 0.9734513}
confusion matrix:
      0     1
0  1506     9
1    72  1485
---- Validation: 
scalar performance:
{'acc': 0.7049689, 'precision': 0.7154707, 'recall': 0.7033486, 'specificity': 0.7033486, 'f1': 0.70022666, 'auroc': 0.8187481, 'binary_precision': 0.75967413, 'binary_recall': 0.58740157, 'binary_specificity': 0.8192956, 'binary_f1_score': 0.6625222}
confusion matrix:
     0    1
0  535  118
1  262  373
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7883721, 'precision': 0.7886781, 'recall': 0.78837204, 'specificity': 0.78837204, 'f1': 0.78831595, 'auroc': 0.8465765, 'binary_precision': 0.7792793, 'binary_recall': 0.80465114, 'binary_specificity': 0.772093, 'binary_f1_score': 0.79176193}
confusion matrix:
     0    1
0  166   49
1   42  173
early stop counter: 3
val acc:0.7049689292907715, best validation acc: 0.7531055808067322, corresponding to test acc:                         0.8116279244422913 / 0.8418604731559753
after epoch: 5,now: 2024-07-27 02:30:01.377441,epoch time: 0:02:44.931307,used: 0:13:55.940112,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_02_16_04_seed_0_23090492
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9788411, 'precision': 0.9789245, 'recall': 0.9787793, 'specificity': 0.9787793, 'f1': 0.9788344, 'auroc': 0.9981147, 'binary_precision': 0.9751592, 'binary_recall': 0.9833012, 'binary_specificity': 0.9742574, 'binary_f1_score': 0.9792133}
confusion matrix:
      0     1
0  1476    39
1    26  1531
---- Validation: 
scalar performance:
{'acc': 0.8035714, 'precision': 0.8037051, 'recall': 0.80371755, 'specificity': 0.80371755, 'f1': 0.80357134, 'auroc': 0.8766661, 'binary_precision': 0.7929448, 'binary_recall': 0.8141732, 'binary_specificity': 0.7932619, 'binary_f1_score': 0.8034188}
confusion matrix:
     0    1
0  518  135
1  118  517
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.75581396, 'precision': 0.76362133, 'recall': 0.75581396, 'specificity': 0.75581396, 'f1': 0.7539925, 'auroc': 0.8429854, 'binary_precision': 0.80898875, 'binary_recall': 0.66976744, 'binary_specificity': 0.8418605, 'binary_f1_score': 0.7328244}
confusion matrix:
     0    1
0  181   34
1   71  144
better model found
persisted
after epoch: 6,now: 2024-07-27 02:32:47.213060,epoch time: 0:02:45.835619,used: 0:16:41.775731,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_02_16_04_seed_0_23090492
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9635417, 'precision': 0.9654016, 'recall': 0.96403784, 'specificity': 0.96403784, 'f1': 0.9635259, 'auroc': 0.99856794, 'binary_precision': 0.9986207, 'binary_recall': 0.9293967, 'binary_specificity': 0.998679, 'binary_f1_score': 0.962766}
confusion matrix:
      0     1
0  1512     2
1   110  1448
---- Validation: 
scalar performance:
{'acc': 0.50621116, 'precision': 0.4199741, 'recall': 0.499256, 'specificity': 0.499256, 'f1': 0.33748075, 'auroc': 0.79714704, 'binary_precision': 0.33333334, 'binary_recall': 0.0015748031, 'binary_specificity': 0.9969372, 'binary_f1_score': 0.003134796}
confusion matrix:
     0  1
0  651  2
1  634  1
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5, 'precision': 0.25, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.33333334, 'auroc': 0.82548404, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
     0  1
0  215  0
1  215  0
early stop counter: 1
val acc:0.5062111616134644, best validation acc: 0.8035714030265808, corresponding to test acc:                         0.7558139562606812 / 0.8418604731559753
after epoch: 7,now: 2024-07-27 02:35:32.203524,epoch time: 0:02:44.990464,used: 0:19:26.766195,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_02_16_04_seed_0_23090492
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9635417, 'precision': 0.96433324, 'recall': 0.9632702, 'specificity': 0.9632702, 'f1': 0.963503, 'auroc': 0.9963121, 'binary_precision': 0.9485431, 'binary_recall': 0.98139834, 'binary_specificity': 0.9451421, 'binary_f1_score': 0.96469104}
confusion matrix:
      0     1
0  1430    83
1    29  1530
---- Validation: 
scalar performance:
{'acc': 0.7795031, 'precision': 0.80538666, 'recall': 0.7774415, 'specificity': 0.7774415, 'f1': 0.77382946, 'auroc': 0.8830714, 'binary_precision': 0.8908686, 'binary_recall': 0.62992126, 'binary_specificity': 0.9249617, 'binary_f1_score': 0.73800737}
confusion matrix:
     0    1
0  604   49
1  235  400
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.82790697, 'precision': 0.86202204, 'recall': 0.82790697, 'specificity': 0.82790697, 'f1': 0.8237549, 'auroc': 0.9044889, 'binary_precision': 0.97315437, 'binary_recall': 0.6744186, 'binary_specificity': 0.98139536, 'binary_f1_score': 0.7967033}
confusion matrix:
     0    1
0  211    4
1   70  145
early stop counter: 2
val acc:0.7795031070709229, best validation acc: 0.8035714030265808, corresponding to test acc:                         0.7558139562606812 / 0.8418604731559753
after epoch: 8,now: 2024-07-27 02:38:18.003579,epoch time: 0:02:45.800055,used: 0:22:12.566250,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_02_16_04_seed_0_23090492
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9817708, 'precision': 0.9818702, 'recall': 0.9819119, 'specificity': 0.9819119, 'f1': 0.98177075, 'auroc': 0.9981233, 'binary_precision': 0.99277264, 'binary_recall': 0.9710797, 'binary_specificity': 0.9927441, 'binary_f1_score': 0.98180634}
confusion matrix:
      0     1
0  1505    11
1    45  1511
---- Validation: 
scalar performance:
{'acc': 0.76552796, 'precision': 0.7982536, 'recall': 0.76318145, 'specificity': 0.76318145, 'f1': 0.7578049, 'auroc': 0.88500077, 'binary_precision': 0.89361703, 'binary_recall': 0.5952756, 'binary_specificity': 0.9310873, 'binary_f1_score': 0.7145558}
confusion matrix:
     0    1
0  608   45
1  257  378
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8534884, 'precision': 0.8668283, 'recall': 0.8534884, 'specificity': 0.8534884, 'f1': 0.8521441, 'auroc': 0.9283937, 'binary_precision': 0.9367816, 'binary_recall': 0.75813955, 'binary_specificity': 0.9488372, 'binary_f1_score': 0.83804625}
confusion matrix:
     0    1
0  204   11
1   52  163
new oracle model saved
early stop counter: 3
val acc:0.7655279636383057, best validation acc: 0.8035714030265808, corresponding to test acc:                         0.7558139562606812 / 0.8534883856773376
after epoch: 9,now: 2024-07-27 02:41:04.362482,epoch time: 0:02:46.358903,used: 0:24:58.925153,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_02_16_04_seed_0_23090492
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.98079425, 'precision': 0.98085874, 'recall': 0.98074436, 'specificity': 0.98074436, 'f1': 0.98078895, 'auroc': 0.9986265, 'binary_precision': 0.97766435, 'binary_recall': 0.9845758, 'binary_specificity': 0.9769129, 'binary_f1_score': 0.9811079}
confusion matrix:
      0     1
0  1481    35
1    24  1532
---- Validation: 
scalar performance:
{'acc': 0.8090062, 'precision': 0.8101482, 'recall': 0.80855656, 'specificity': 0.80855656, 'f1': 0.80864453, 'auroc': 0.8867481, 'binary_precision': 0.82579565, 'binary_recall': 0.776378, 'binary_specificity': 0.8407351, 'binary_f1_score': 0.80032474}
confusion matrix:
     0    1
0  549  104
1  142  493
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.82093024, 'precision': 0.82110393, 'recall': 0.82093024, 'specificity': 0.82093024, 'f1': 0.82090604, 'auroc': 0.8826176, 'binary_precision': 0.82857144, 'binary_recall': 0.80930233, 'binary_specificity': 0.83255816, 'binary_f1_score': 0.8188235}
confusion matrix:
     0    1
0  179   36
1   41  174
better model found
persisted
after epoch: 10,now: 2024-07-27 02:43:50.479296,epoch time: 0:02:46.116814,used: 0:27:45.041967,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_02_16_04_seed_0_23090492
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9794922, 'precision': 0.9799957, 'recall': 0.9797599, 'specificity': 0.9797599, 'f1': 0.9794915, 'auroc': 0.99752593, 'binary_precision': 0.99933153, 'binary_recall': 0.9601798, 'binary_specificity': 0.99933994, 'binary_f1_score': 0.9793646}
confusion matrix:
      0     1
0  1514     1
1    62  1495
---- Validation: 
scalar performance:
{'acc': 0.6878882, 'precision': 0.7925828, 'recall': 0.6836599, 'specificity': 0.6836599, 'f1': 0.65420276, 'auroc': 0.91023445, 'binary_precision': 0.96414346, 'binary_recall': 0.38110235, 'binary_specificity': 0.98621744, 'binary_f1_score': 0.5462754}
confusion matrix:
     0    1
0  644    9
1  393  242
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.75116277, 'precision': 0.81874585, 'recall': 0.75116277, 'specificity': 0.75116277, 'f1': 0.73723435, 'auroc': 0.8946024, 'binary_precision': 0.9655172, 'binary_recall': 0.52093023, 'binary_specificity': 0.98139536, 'binary_f1_score': 0.6767372}
confusion matrix:
     0    1
0  211    4
1  103  112
early stop counter: 1
val acc:0.6878882050514221, best validation acc: 0.8090062141418457, corresponding to test acc:                         0.8209302425384521 / 0.8534883856773376
after epoch: 11,now: 2024-07-27 02:46:35.995838,epoch time: 0:02:45.516542,used: 0:30:30.558509,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_02_16_04_seed_0_23090492
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9811198, 'precision': 0.98148894, 'recall': 0.9813566, 'specificity': 0.9813566, 'f1': 0.9811195, 'auroc': 0.99938357, 'binary_precision': 0.9986693, 'binary_recall': 0.9640334, 'binary_specificity': 0.9986799, 'binary_f1_score': 0.9810458}
confusion matrix:
      0     1
0  1513     2
1    56  1501
---- Validation: 
scalar performance:
{'acc': 0.5458075, 'precision': 0.74525785, 'recall': 0.5394135, 'specificity': 0.5394135, 'f1': 0.42046377, 'auroc': 0.92695975, 'binary_precision': 0.962963, 'binary_recall': 0.08188976, 'binary_specificity': 0.9969372, 'binary_f1_score': 0.1509434}
confusion matrix:
     0   1
0  651   2
1  583  52
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5023256, 'precision': 0.75058275, 'recall': 0.5023256, 'specificity': 0.5023256, 'f1': 0.3384806, 'auroc': 0.93593836, 'binary_precision': 1.0, 'binary_recall': 0.004651163, 'binary_specificity': 1.0, 'binary_f1_score': 0.009259259}
confusion matrix:
     0  1
0  215  0
1  214  1
early stop counter: 2
val acc:0.5458074808120728, best validation acc: 0.8090062141418457, corresponding to test acc:                         0.8209302425384521 / 0.8534883856773376
after epoch: 12,now: 2024-07-27 02:49:22.837064,epoch time: 0:02:46.841226,used: 0:33:17.399735,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_02_16_04_seed_0_23090492
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.8720703, 'precision': 0.8980756, 'recall': 0.87033266, 'specificity': 0.87033266, 'f1': 0.86955, 'auroc': 0.9957937, 'binary_precision': 0.799691, 'binary_recall': 0.997431, 'binary_specificity': 0.74323434, 'binary_f1_score': 0.8876822}
confusion matrix:
      0     1
0  1126   389
1     4  1553
---- Validation: 
scalar performance:
{'acc': 0.76086956, 'precision': 0.7955069, 'recall': 0.7632321, 'specificity': 0.7632321, 'f1': 0.7547164, 'auroc': 0.8678805, 'binary_precision': 0.6907818, 'binary_recall': 0.93228346, 'binary_specificity': 0.5941807, 'binary_f1_score': 0.79356563}
confusion matrix:
     0    1
0  388  265
1   43  592
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.67906976, 'precision': 0.77274376, 'recall': 0.67906976, 'specificity': 0.67906976, 'f1': 0.6489256, 'auroc': 0.9249973, 'binary_precision': 0.61290324, 'binary_recall': 0.97209305, 'binary_specificity': 0.3860465, 'binary_f1_score': 0.75179857}
confusion matrix:
    0    1
0  83  132
1   6  209
early stop counter: 3
val acc:0.760869562625885, best validation acc: 0.8090062141418457, corresponding to test acc:                         0.8209302425384521 / 0.8534883856773376
after epoch: 13,now: 2024-07-27 02:52:09.541635,epoch time: 0:02:46.704571,used: 0:36:04.104306,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_02_16_04_seed_0_23090492
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9820964, 'precision': 0.9822059, 'recall': 0.9822417, 'specificity': 0.9822417, 'f1': 0.9820963, 'auroc': 0.9988503, 'binary_precision': 0.99342537, 'binary_recall': 0.9710797, 'binary_specificity': 0.9934037, 'binary_f1_score': 0.98212546}
confusion matrix:
      0     1
0  1506    10
1    45  1511
---- Validation: 
scalar performance:
{'acc': 0.65993786, 'precision': 0.7676201, 'recall': 0.65544367, 'specificity': 0.65544367, 'f1': 0.61816835, 'auroc': 0.9205936, 'binary_precision': 0.9339207, 'binary_recall': 0.33385828, 'binary_specificity': 0.9770291, 'binary_f1_score': 0.49187934}
confusion matrix:
     0    1
0  638   15
1  423  212
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.60930234, 'precision': 0.78067887, 'recall': 0.60930234, 'specificity': 0.60930234, 'f1': 0.53892106, 'auroc': 0.9283072, 'binary_precision': 1.0, 'binary_recall': 0.21860465, 'binary_specificity': 1.0, 'binary_f1_score': 0.35877863}
confusion matrix:
     0   1
0  215   0
1  168  47
early stop counter: 4
val acc:0.659937858581543, best validation acc: 0.8090062141418457, corresponding to test acc:                         0.8209302425384521 / 0.8534883856773376
after epoch: 14,now: 2024-07-27 02:54:55.346866,epoch time: 0:02:45.805231,used: 0:38:49.909537,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_02_16_04_seed_0_23090492
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9892578, 'precision': 0.9892421, 'recall': 0.9892763, 'specificity': 0.9892763, 'f1': 0.98925656, 'auroc': 0.9992497, 'binary_precision': 0.99096775, 'binary_recall': 0.98778135, 'binary_specificity': 0.99077123, 'binary_f1_score': 0.989372}
confusion matrix:
      0     1
0  1503    14
1    19  1536
---- Validation: 
scalar performance:
{'acc': 0.76009315, 'precision': 0.8139522, 'recall': 0.75717044, 'specificity': 0.75717044, 'f1': 0.7479236, 'auroc': 0.9102169, 'binary_precision': 0.94054055, 'binary_recall': 0.5480315, 'binary_specificity': 0.96630937, 'binary_f1_score': 0.69253725}
confusion matrix:
     0    1
0  631   22
1  287  348
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.772093, 'precision': 0.8268496, 'recall': 0.77209306, 'specificity': 0.77209306, 'f1': 0.76213056, 'auroc': 0.92415357, 'binary_precision': 0.96062994, 'binary_recall': 0.5674419, 'binary_specificity': 0.9767442, 'binary_f1_score': 0.71345025}
confusion matrix:
     0    1
0  210    5
1   93  122
early stop counter: 5
val acc:0.7600931525230408, best validation acc: 0.8090062141418457, corresponding to test acc:                         0.8209302425384521 / 0.8534883856773376
after epoch: 15,now: 2024-07-27 02:57:41.440059,epoch time: 0:02:46.093193,used: 0:41:36.002730,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_02_16_04_seed_0_23090492
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 15 with time: 0:41:36.002730 at 2024-07-27 02:57:41.440059
persisted model performance metric: 

scalar performance:
{'acc': 0.82093024, 'precision': 0.82110393, 'recall': 0.82093024, 'specificity': 0.82093024, 'f1': 0.82090604, 'auroc': 0.8826176, 'binary_precision': 0.82857144, 'binary_recall': 0.80930233, 'binary_specificity': 0.83255816, 'binary_f1_score': 0.8188235}
confusion matrix:
     0    1
0  179   36
1   41  174
oracle model performance metric: 

scalar performance:
{'acc': 0.8534884, 'precision': 0.8668283, 'recall': 0.8534884, 'specificity': 0.8534884, 'f1': 0.8521441, 'auroc': 0.9283937, 'binary_precision': 0.9367816, 'binary_recall': 0.75813955, 'binary_specificity': 0.9488372, 'binary_f1_score': 0.83804625}
confusion matrix:
     0    1
0  204   11
1   52  163
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_diva_irm_3seeds_nofreeze_2024-07-27_01-18-02/rule_results/8.csv
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_diva_irm_3seeds_nofreeze_2024-07-27_01-18-02/rule_results/8.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_diva_irm_3seeds_nofreeze_2024-07-27_01-18-02/confusion_matrix/8.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   2390 MiB |   8908 MiB | 100130 GiB | 100128 GiB |
|       from large pool |   2298 MiB |   8832 MiB |  99255 GiB |  99252 GiB |
|       from small pool |     91 MiB |    129 MiB |    875 GiB |    875 GiB |
|---------------------------------------------------------------------------|
| Active memory         |   2390 MiB |   8908 MiB | 100130 GiB | 100128 GiB |
|       from large pool |   2298 MiB |   8832 MiB |  99255 GiB |  99252 GiB |
|       from small pool |     91 MiB |    129 MiB |    875 GiB |    875 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |   2375 MiB |   8902 MiB | 100023 GiB | 100021 GiB |
|       from large pool |   2284 MiB |   8826 MiB |  99150 GiB |  99147 GiB |
|       from small pool |     91 MiB |    128 MiB |    873 GiB |    873 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   9714 MiB |   9714 MiB |   9714 MiB |      0 B   |
|       from large pool |   9578 MiB |   9578 MiB |   9578 MiB |      0 B   |
|       from small pool |    136 MiB |    136 MiB |    136 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |    899 MiB |   1984 MiB |  77928 GiB |  77927 GiB |
|       from large pool |    889 MiB |   1979 MiB |  77024 GiB |  77023 GiB |
|       from small pool |     10 MiB |     22 MiB |    904 GiB |    904 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    2464    |    3317    |   14229 K  |   14227 K  |
|       from large pool |     392    |     816    |    7152 K  |    7152 K  |
|       from small pool |    2072    |    2768    |    7076 K  |    7074 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    2464    |    3317    |   14229 K  |   14227 K  |
|       from large pool |     392    |     816    |    7152 K  |    7152 K  |
|       from small pool |    2072    |    2768    |    7076 K  |    7074 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     269    |     269    |     269    |       0    |
|       from large pool |     201    |     201    |     201    |       0    |
|       from small pool |      68    |      68    |      68    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     149    |     307    |    8018 K  |    8018 K  |
|       from large pool |      82    |     196    |    4415 K  |    4415 K  |
|       from small pool |      67    |     225    |    3603 K  |    3603 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   8908 MiB | 100130 GiB | 100130 GiB |
|       from large pool |  16640 KiB |   8832 MiB |  99255 GiB |  99255 GiB |
|       from small pool |      0 KiB |    129 MiB |    875 GiB |    875 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   8908 MiB | 100130 GiB | 100130 GiB |
|       from large pool |  16640 KiB |   8832 MiB |  99255 GiB |  99255 GiB |
|       from small pool |      0 KiB |    129 MiB |    875 GiB |    875 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   8902 MiB | 100023 GiB | 100023 GiB |
|       from large pool |  16640 KiB |   8826 MiB |  99150 GiB |  99150 GiB |
|       from small pool |      0 KiB |    128 MiB |    873 GiB |    873 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   3290 MiB |   9714 MiB |   9714 MiB |   6424 MiB |
|       from large pool |   3188 MiB |   9578 MiB |   9578 MiB |   6390 MiB |
|       from small pool |    102 MiB |    136 MiB |    136 MiB |     34 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1984 MiB |  77929 GiB |  77929 GiB |
|       from large pool |  24320 KiB |   1979 MiB |  77024 GiB |  77024 GiB |
|       from small pool |      0 KiB |     50 MiB |    904 GiB |    904 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3317    |   14229 K  |   14229 K  |
|       from large pool |       2    |     816    |    7152 K  |    7152 K  |
|       from small pool |       0    |    2768    |    7076 K  |    7076 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3317    |   14229 K  |   14229 K  |
|       from large pool |       2    |     816    |    7152 K  |    7152 K  |
|       from small pool |       0    |    2768    |    7076 K  |    7076 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     133    |     269    |     269    |     136    |
|       from large pool |      82    |     201    |     201    |     119    |
|       from small pool |      51    |      68    |      68    |      17    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     307    |    8018 K  |    8018 K  |
|       from large pool |       3    |     196    |    4415 K  |    4415 K  |
|       from small pool |       0    |     225    |    3603 K  |    3603 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   8908 MiB | 100130 GiB | 100130 GiB |
|       from large pool |  16640 KiB |   8832 MiB |  99255 GiB |  99255 GiB |
|       from small pool |      0 KiB |    129 MiB |    875 GiB |    875 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   8908 MiB | 100130 GiB | 100130 GiB |
|       from large pool |  16640 KiB |   8832 MiB |  99255 GiB |  99255 GiB |
|       from small pool |      0 KiB |    129 MiB |    875 GiB |    875 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   8902 MiB | 100023 GiB | 100023 GiB |
|       from large pool |  16640 KiB |   8826 MiB |  99150 GiB |  99150 GiB |
|       from small pool |      0 KiB |    128 MiB |    873 GiB |    873 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   3290 MiB |   9714 MiB |   9714 MiB |   6424 MiB |
|       from large pool |   3188 MiB |   9578 MiB |   9578 MiB |   6390 MiB |
|       from small pool |    102 MiB |    136 MiB |    136 MiB |     34 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1984 MiB |  77929 GiB |  77929 GiB |
|       from large pool |  24320 KiB |   1979 MiB |  77024 GiB |  77024 GiB |
|       from small pool |      0 KiB |     50 MiB |    904 GiB |    904 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3317    |   14229 K  |   14229 K  |
|       from large pool |       2    |     816    |    7152 K  |    7152 K  |
|       from small pool |       0    |    2768    |    7076 K  |    7076 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3317    |   14229 K  |   14229 K  |
|       from large pool |       2    |     816    |    7152 K  |    7152 K  |
|       from small pool |       0    |    2768    |    7076 K  |    7076 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     133    |     269    |     269    |     136    |
|       from large pool |      82    |     201    |     201    |     119    |
|       from small pool |      51    |      68    |      68    |      17    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     307    |    8018 K  |    8018 K  |
|       from large pool |       3    |     196    |    4415 K  |    4415 K  |
|       from small pool |       0    |     225    |    3603 K  |    3603 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main

using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_02_58_15_seed_1_23090492

 Experiment start at: 2024-07-27 02:58:16.484692
hyper-parameter scheduler not set,going to use default Warmpup and epoch update
before training, model accuracy: 0.6533333659172058
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9609375, 'precision': 0.9610846, 'recall': 0.9610846, 'specificity': 0.9610846, 'f1': 0.96093744, 'auroc': 0.99162626, 'binary_precision': 0.972973, 'binary_recall': 0.94919616, 'binary_specificity': 0.972973, 'binary_f1_score': 0.96093744}
confusion matrix:
      0     1
0  1476    41
1    79  1476
---- Validation: 
scalar performance:
{'acc': 0.7587822, 'precision': 0.7717327, 'recall': 0.76052225, 'specificity': 0.76052225, 'f1': 0.7566467, 'auroc': 0.84511983, 'binary_precision': 0.7081712, 'binary_recall': 0.8666667, 'binary_specificity': 0.6543779, 'binary_f1_score': 0.7794432}
confusion matrix:
     0    1
0  426  225
1   84  546
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.76666665, 'precision': 0.7893518, 'recall': 0.76666665, 'specificity': 0.76666665, 'f1': 0.7620019, 'auroc': 0.90421724, 'binary_precision': 0.7083333, 'binary_recall': 0.9066667, 'binary_specificity': 0.62666667, 'binary_f1_score': 0.79532164}
confusion matrix:
     0    1
0  141   84
1   21  204
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-27 03:01:07.462897,epoch time: 0:02:50.978205,used: 0:02:50.978205,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_02_58_15_seed_1_23090492
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9765625, 'precision': 0.9769403, 'recall': 0.97678745, 'specificity': 0.97678745, 'f1': 0.976562, 'auroc': 0.9971199, 'binary_precision': 0.994008, 'binary_recall': 0.9595116, 'binary_specificity': 0.9940633, 'binary_f1_score': 0.9764552}
confusion matrix:
      0     1
0  1507     9
1    63  1493
---- Validation: 
scalar performance:
{'acc': 0.77751756, 'precision': 0.79922235, 'recall': 0.7752688, 'specificity': 0.7752688, 'f1': 0.7724047, 'auroc': 0.87316465, 'binary_precision': 0.875817, 'binary_recall': 0.63809526, 'binary_specificity': 0.9124424, 'binary_f1_score': 0.7382921}
confusion matrix:
     0    1
0  594   57
1  228  402
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8488889, 'precision': 0.8552036, 'recall': 0.8488889, 'specificity': 0.8488889, 'f1': 0.84821427, 'auroc': 0.92292345, 'binary_precision': 0.9025641, 'binary_recall': 0.7822222, 'binary_specificity': 0.91555554, 'binary_f1_score': 0.83809525}
confusion matrix:
     0    1
0  206   19
1   49  176
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-07-27 03:03:55.297122,epoch time: 0:02:47.834225,used: 0:05:38.812430,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_02_58_15_seed_1_23090492
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.96223956, 'precision': 0.96406114, 'recall': 0.9625882, 'specificity': 0.9625882, 'f1': 0.9622188, 'auroc': 0.9961883, 'binary_precision': 0.99585634, 'binary_recall': 0.9291237, 'binary_specificity': 0.9960526, 'binary_f1_score': 0.96133333}
confusion matrix:
      0     1
0  1514     6
1   110  1442
---- Validation: 
scalar performance:
{'acc': 0.78142077, 'precision': 0.8153204, 'recall': 0.77869946, 'specificity': 0.77869946, 'f1': 0.7742049, 'auroc': 0.89571846, 'binary_precision': 0.9146919, 'binary_recall': 0.61269844, 'binary_specificity': 0.9447005, 'binary_f1_score': 0.7338403}
confusion matrix:
     0    1
0  615   36
1  244  386
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.82, 'precision': 0.8511358, 'recall': 0.82, 'specificity': 0.82, 'f1': 0.8159193, 'auroc': 0.9231802, 'binary_precision': 0.9556962, 'binary_recall': 0.6711111, 'binary_specificity': 0.9688889, 'binary_f1_score': 0.78851175}
confusion matrix:
     0    1
0  218    7
1   74  151
better model found
persisted
after epoch: 3,now: 2024-07-27 03:06:42.335545,epoch time: 0:02:47.038423,used: 0:08:25.850853,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_02_58_15_seed_1_23090492
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9003906, 'precision': 0.91607237, 'recall': 0.90160775, 'specificity': 0.90160775, 'f1': 0.89962673, 'auroc': 0.9917086, 'binary_precision': 1.0, 'binary_recall': 0.80321544, 'binary_specificity': 1.0, 'binary_f1_score': 0.89087015}
confusion matrix:
      0     1
0  1517     0
1   306  1249
---- Validation: 
scalar performance:
{'acc': 0.5277127, 'precision': 0.7247026, 'recall': 0.51989245, 'specificity': 0.51989245, 'f1': 0.38201165, 'auroc': 0.8293718, 'binary_precision': 0.9310345, 'binary_recall': 0.042857144, 'binary_specificity': 0.9969278, 'binary_f1_score': 0.081942335}
confusion matrix:
     0   1
0  649   2
1  603  27
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6155556, 'precision': 0.78266335, 'recall': 0.6155555, 'specificity': 0.6155555, 'f1': 0.5488813, 'auroc': 0.89795554, 'binary_precision': 1.0, 'binary_recall': 0.23111111, 'binary_specificity': 1.0, 'binary_f1_score': 0.37545127}
confusion matrix:
     0   1
0  225   0
1  173  52
early stop counter: 1
val acc:0.5277127027511597, best validation acc: 0.7814207673072815, corresponding to test acc:                         0.8199999928474426 / 0.8488888740539551
after epoch: 4,now: 2024-07-27 03:09:28.547575,epoch time: 0:02:46.212030,used: 0:11:12.062883,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_02_58_15_seed_1_23090492
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9794922, 'precision': 0.97988546, 'recall': 0.97968066, 'specificity': 0.97968066, 'f1': 0.9794914, 'auroc': 0.99871385, 'binary_precision': 0.99666667, 'binary_recall': 0.9626529, 'binary_specificity': 0.99670833, 'binary_f1_score': 0.9793646}
confusion matrix:
      0     1
0  1514     5
1    58  1495
---- Validation: 
scalar performance:
{'acc': 0.7876659, 'precision': 0.8209126, 'recall': 0.78499746, 'specificity': 0.78499746, 'f1': 0.7809067, 'auroc': 0.8946749, 'binary_precision': 0.9201878, 'binary_recall': 0.62222224, 'binary_specificity': 0.9477727, 'binary_f1_score': 0.7424243}
confusion matrix:
     0    1
0  617   34
1  238  392
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.83555555, 'precision': 0.8501928, 'recall': 0.83555555, 'specificity': 0.83555555, 'f1': 0.83381903, 'auroc': 0.9060148, 'binary_precision': 0.92178774, 'binary_recall': 0.73333335, 'binary_specificity': 0.93777776, 'binary_f1_score': 0.8168317}
confusion matrix:
     0    1
0  211   14
1   60  165
better model found
persisted
after epoch: 5,now: 2024-07-27 03:12:15.140529,epoch time: 0:02:46.592954,used: 0:13:58.655837,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_02_58_15_seed_1_23090492
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.97721356, 'precision': 0.97774875, 'recall': 0.97747254, 'specificity': 0.97747254, 'f1': 0.9772123, 'auroc': 0.9984972, 'binary_precision': 0.9973226, 'binary_recall': 0.95758355, 'binary_specificity': 0.9973615, 'binary_f1_score': 0.9770491}
confusion matrix:
      0     1
0  1512     4
1    66  1490
---- Validation: 
scalar performance:
{'acc': 0.8173302, 'precision': 0.8301683, 'recall': 0.8156938, 'specificity': 0.8156938, 'f1': 0.8149594, 'auroc': 0.89812255, 'binary_precision': 0.8913044, 'binary_recall': 0.715873, 'binary_specificity': 0.9155146, 'binary_f1_score': 0.7940141}
confusion matrix:
     0    1
0  596   55
1  179  451
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.83111113, 'precision': 0.8355923, 'recall': 0.8311111, 'specificity': 0.8311111, 'f1': 0.8305454, 'auroc': 0.90190613, 'binary_precision': 0.8743719, 'binary_recall': 0.7733333, 'binary_specificity': 0.8888889, 'binary_f1_score': 0.8207547}
confusion matrix:
     0    1
0  200   25
1   51  174
better model found
persisted
after epoch: 6,now: 2024-07-27 03:15:02.268589,epoch time: 0:02:47.128060,used: 0:16:45.783897,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_02_58_15_seed_1_23090492
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.94596356, 'precision': 0.9506833, 'recall': 0.9466238, 'specificity': 0.9466238, 'f1': 0.94586957, 'auroc': 0.9978732, 'binary_precision': 1.0, 'binary_recall': 0.8932476, 'binary_specificity': 1.0, 'binary_f1_score': 0.9436141}
confusion matrix:
      0     1
0  1517     0
1   166  1389
---- Validation: 
scalar performance:
{'acc': 0.5839188, 'precision': 0.74764776, 'recall': 0.5771377, 'specificity': 0.5771377, 'f1': 0.49318993, 'auroc': 0.9085802, 'binary_precision': 0.94495416, 'binary_recall': 0.16349207, 'binary_specificity': 0.9907834, 'binary_f1_score': 0.2787551}
confusion matrix:
     0    1
0  645    6
1  527  103
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.54, 'precision': 0.7604166, 'recall': 0.54, 'specificity': 0.54, 'f1': 0.41653982, 'auroc': 0.93187165, 'binary_precision': 1.0, 'binary_recall': 0.08, 'binary_specificity': 1.0, 'binary_f1_score': 0.14814813}
confusion matrix:
     0   1
0  225   0
1  207  18
early stop counter: 1
val acc:0.5839188098907471, best validation acc: 0.8173301815986633, corresponding to test acc:                         0.8311111330986023 / 0.8488888740539551
after epoch: 7,now: 2024-07-27 03:17:48.484831,epoch time: 0:02:46.216242,used: 0:19:32.000139,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_02_58_15_seed_1_23090492
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.98860675, 'precision': 0.98861706, 'recall': 0.98859537, 'specificity': 0.98859537, 'f1': 0.98860526, 'auroc': 0.99948204, 'binary_precision': 0.98778135, 'binary_recall': 0.9896907, 'binary_specificity': 0.9875, 'binary_f1_score': 0.9887351}
confusion matrix:
      0     1
0  1501    19
1    16  1536
---- Validation: 
scalar performance:
{'acc': 0.80640125, 'precision': 0.8125321, 'recall': 0.80522275, 'specificity': 0.80522275, 'f1': 0.80498934, 'auroc': 0.8833705, 'binary_precision': 0.8523985, 'binary_recall': 0.73333335, 'binary_specificity': 0.87711215, 'binary_f1_score': 0.78839594}
confusion matrix:
     0    1
0  571   80
1  168  462
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.82, 'precision': 0.8201581, 'recall': 0.82000005, 'specificity': 0.82000005, 'f1': 0.8199779, 'auroc': 0.8549333, 'binary_precision': 0.8272727, 'binary_recall': 0.8088889, 'binary_specificity': 0.83111113, 'binary_f1_score': 0.8179776}
confusion matrix:
     0    1
0  187   38
1   43  182
early stop counter: 2
val acc:0.806401252746582, best validation acc: 0.8173301815986633, corresponding to test acc:                         0.8311111330986023 / 0.8488888740539551
after epoch: 8,now: 2024-07-27 03:20:36.006653,epoch time: 0:02:47.521822,used: 0:22:19.521961,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_02_58_15_seed_1_23090492
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9635417, 'precision': 0.96550345, 'recall': 0.9639263, 'specificity': 0.9639263, 'f1': 0.9635205, 'auroc': 0.99779356, 'binary_precision': 0.9986159, 'binary_recall': 0.92916936, 'binary_specificity': 0.99868333, 'binary_f1_score': 0.9626418}
confusion matrix:
      0     1
0  1517     2
1   110  1443
---- Validation: 
scalar performance:
{'acc': 0.6541764, 'precision': 0.7701621, 'recall': 0.6487199, 'specificity': 0.6487199, 'f1': 0.60791886, 'auroc': 0.8774389, 'binary_precision': 0.943128, 'binary_recall': 0.31587303, 'binary_specificity': 0.98156685, 'binary_f1_score': 0.47324616}
confusion matrix:
     0    1
0  639   12
1  431  199
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7888889, 'precision': 0.8319036, 'recall': 0.7888889, 'specificity': 0.7888889, 'f1': 0.7818198, 'auroc': 0.8912395, 'binary_precision': 0.9513889, 'binary_recall': 0.60888886, 'binary_specificity': 0.9688889, 'binary_f1_score': 0.7425474}
confusion matrix:
     0    1
0  218    7
1   88  137
early stop counter: 3
val acc:0.6541764140129089, best validation acc: 0.8173301815986633, corresponding to test acc:                         0.8311111330986023 / 0.8488888740539551
after epoch: 9,now: 2024-07-27 03:23:22.785464,epoch time: 0:02:46.778811,used: 0:25:06.300772,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_02_58_15_seed_1_23090492
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.976888, 'precision': 0.97763073, 'recall': 0.97718513, 'specificity': 0.97718513, 'f1': 0.9768857, 'auroc': 0.9985565, 'binary_precision': 1.0, 'binary_recall': 0.9543702, 'binary_specificity': 1.0, 'binary_f1_score': 0.9766524}
confusion matrix:
      0     1
0  1516     0
1    71  1485
---- Validation: 
scalar performance:
{'acc': 0.637783, 'precision': 0.74877274, 'recall': 0.63220686, 'specificity': 0.63220686, 'f1': 0.58704984, 'auroc': 0.8815546, 'binary_precision': 0.9108911, 'binary_recall': 0.2920635, 'binary_specificity': 0.97235024, 'binary_f1_score': 0.4423077}
confusion matrix:
     0    1
0  633   18
1  446  184
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.78444445, 'precision': 0.82217646, 'recall': 0.78444445, 'specificity': 0.78444445, 'f1': 0.7779429, 'auroc': 0.8798815, 'binary_precision': 0.9324324, 'binary_recall': 0.61333334, 'binary_specificity': 0.95555556, 'binary_f1_score': 0.7399464}
confusion matrix:
     0    1
0  215   10
1   87  138
early stop counter: 4
val acc:0.6377829909324646, best validation acc: 0.8173301815986633, corresponding to test acc:                         0.8311111330986023 / 0.8488888740539551
after epoch: 10,now: 2024-07-27 03:26:08.825926,epoch time: 0:02:46.040462,used: 0:27:52.341234,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_02_58_15_seed_1_23090492
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9824219, 'precision': 0.98267037, 'recall': 0.9826139, 'specificity': 0.9826139, 'f1': 0.98242176, 'auroc': 0.99915516, 'binary_precision': 0.997351, 'binary_recall': 0.9678663, 'binary_specificity': 0.9973615, 'binary_f1_score': 0.9823874}
confusion matrix:
      0     1
0  1512     4
1    50  1506
---- Validation: 
scalar performance:
{'acc': 0.6885246, 'precision': 0.7878741, 'recall': 0.6836406, 'specificity': 0.6836406, 'f1': 0.65561384, 'auroc': 0.89914536, 'binary_precision': 0.9529412, 'binary_recall': 0.3857143, 'binary_specificity': 0.98156685, 'binary_f1_score': 0.54915255}
confusion matrix:
     0    1
0  639   12
1  387  243
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7644445, 'precision': 0.8362933, 'recall': 0.7644445, 'specificity': 0.7644445, 'f1': 0.75115293, 'auroc': 0.91235554, 'binary_precision': 0.9917355, 'binary_recall': 0.53333336, 'binary_specificity': 0.9955556, 'binary_f1_score': 0.69364166}
confusion matrix:
     0    1
0  224    1
1  105  120
early stop counter: 5
val acc:0.688524603843689, best validation acc: 0.8173301815986633, corresponding to test acc:                         0.8311111330986023 / 0.8488888740539551
after epoch: 11,now: 2024-07-27 03:28:56.113038,epoch time: 0:02:47.287112,used: 0:30:39.628346,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_02_58_15_seed_1_23090492
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 11 with time: 0:30:39.628346 at 2024-07-27 03:28:56.113038
persisted model performance metric: 

scalar performance:
{'acc': 0.83111113, 'precision': 0.8355923, 'recall': 0.8311111, 'specificity': 0.8311111, 'f1': 0.8305454, 'auroc': 0.90190613, 'binary_precision': 0.8743719, 'binary_recall': 0.7733333, 'binary_specificity': 0.8888889, 'binary_f1_score': 0.8207547}
confusion matrix:
     0    1
0  200   25
1   51  174
oracle model performance metric: 

scalar performance:
{'acc': 0.8488889, 'precision': 0.8552036, 'recall': 0.8488889, 'specificity': 0.8488889, 'f1': 0.84821427, 'auroc': 0.92292345, 'binary_precision': 0.9025641, 'binary_recall': 0.7822222, 'binary_specificity': 0.91555554, 'binary_f1_score': 0.83809525}
confusion matrix:
     0    1
0  206   19
1   49  176
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_diva_irm_3seeds_nofreeze_2024-07-27_01-18-02/rule_results/8.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_diva_irm_3seeds_nofreeze_2024-07-27_01-18-02/confusion_matrix/8.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   2391 MiB |   8913 MiB | 173648 GiB | 173646 GiB |
|       from large pool |   2299 MiB |   8837 MiB | 172126 GiB | 172124 GiB |
|       from small pool |     91 MiB |    132 MiB |   1522 GiB |   1521 GiB |
|---------------------------------------------------------------------------|
| Active memory         |   2391 MiB |   8913 MiB | 173648 GiB | 173646 GiB |
|       from large pool |   2299 MiB |   8837 MiB | 172126 GiB | 172124 GiB |
|       from small pool |     91 MiB |    132 MiB |   1522 GiB |   1521 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |   2375 MiB |   8902 MiB | 173462 GiB | 173460 GiB |
|       from large pool |   2284 MiB |   8826 MiB | 171942 GiB | 171940 GiB |
|       from small pool |     91 MiB |    132 MiB |   1519 GiB |   1519 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   9700 MiB |   9714 MiB |  16124 MiB |   6424 MiB |
|       from large pool |   9560 MiB |   9578 MiB |  15950 MiB |   6390 MiB |
|       from small pool |    140 MiB |    140 MiB |    174 MiB |     34 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |   1504 MiB |   2525 MiB | 142052 GiB | 142051 GiB |
|       from large pool |   1494 MiB |   2519 MiB | 140482 GiB | 140481 GiB |
|       from small pool |     10 MiB |     50 MiB |   1570 GiB |   1570 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    2476    |    3329    |   24697 K  |   24694 K  |
|       from large pool |     392    |     816    |   12406 K  |   12405 K  |
|       from small pool |    2084    |    2780    |   12291 K  |   12289 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    2476    |    3329    |   24697 K  |   24694 K  |
|       from large pool |     392    |     816    |   12406 K  |   12405 K  |
|       from small pool |    2084    |    2780    |   12291 K  |   12289 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     253    |     269    |     389    |     136    |
|       from large pool |     183    |     201    |     302    |     119    |
|       from small pool |      70    |      70    |      87    |      17    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     140    |     307    |   13471 K  |   13471 K  |
|       from large pool |      72    |     196    |    7166 K  |    7166 K  |
|       from small pool |      68    |     226    |    6305 K  |    6304 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   8913 MiB | 173648 GiB | 173648 GiB |
|       from large pool |  16640 KiB |   8837 MiB | 172126 GiB | 172126 GiB |
|       from small pool |      0 KiB |    132 MiB |   1522 GiB |   1522 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   8913 MiB | 173648 GiB | 173648 GiB |
|       from large pool |  16640 KiB |   8837 MiB | 172126 GiB | 172126 GiB |
|       from small pool |      0 KiB |    132 MiB |   1522 GiB |   1522 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   8902 MiB | 173462 GiB | 173462 GiB |
|       from large pool |  16640 KiB |   8826 MiB | 171942 GiB | 171942 GiB |
|       from small pool |      0 KiB |    132 MiB |   1519 GiB |   1519 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   3896 MiB |   9714 MiB |  16124 MiB |  12228 MiB |
|       from large pool |   3794 MiB |   9578 MiB |  15950 MiB |  12156 MiB |
|       from small pool |    102 MiB |    140 MiB |    174 MiB |     72 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   2525 MiB | 142054 GiB | 142053 GiB |
|       from large pool |  24320 KiB |   2519 MiB | 140483 GiB | 140483 GiB |
|       from small pool |      0 KiB |     60 MiB |   1570 GiB |   1570 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3329    |   24697 K  |   24697 K  |
|       from large pool |       2    |     816    |   12406 K  |   12406 K  |
|       from small pool |       0    |    2780    |   12291 K  |   12291 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3329    |   24697 K  |   24697 K  |
|       from large pool |       2    |     816    |   12406 K  |   12406 K  |
|       from small pool |       0    |    2780    |   12291 K  |   12291 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     131    |     269    |     389    |     258    |
|       from large pool |      80    |     201    |     302    |     222    |
|       from small pool |      51    |      70    |      87    |      36    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     307    |   13472 K  |   13472 K  |
|       from large pool |       3    |     196    |    7166 K  |    7166 K  |
|       from small pool |       0    |     226    |    6305 K  |    6305 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   8913 MiB | 173648 GiB | 173648 GiB |
|       from large pool |  16640 KiB |   8837 MiB | 172126 GiB | 172126 GiB |
|       from small pool |      0 KiB |    132 MiB |   1522 GiB |   1522 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   8913 MiB | 173648 GiB | 173648 GiB |
|       from large pool |  16640 KiB |   8837 MiB | 172126 GiB | 172126 GiB |
|       from small pool |      0 KiB |    132 MiB |   1522 GiB |   1522 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   8902 MiB | 173462 GiB | 173462 GiB |
|       from large pool |  16640 KiB |   8826 MiB | 171942 GiB | 171942 GiB |
|       from small pool |      0 KiB |    132 MiB |   1519 GiB |   1519 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   3896 MiB |   9714 MiB |  16124 MiB |  12228 MiB |
|       from large pool |   3794 MiB |   9578 MiB |  15950 MiB |  12156 MiB |
|       from small pool |    102 MiB |    140 MiB |    174 MiB |     72 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   2525 MiB | 142054 GiB | 142053 GiB |
|       from large pool |  24320 KiB |   2519 MiB | 140483 GiB | 140483 GiB |
|       from small pool |      0 KiB |     60 MiB |   1570 GiB |   1570 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3329    |   24697 K  |   24697 K  |
|       from large pool |       2    |     816    |   12406 K  |   12406 K  |
|       from small pool |       0    |    2780    |   12291 K  |   12291 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3329    |   24697 K  |   24697 K  |
|       from large pool |       2    |     816    |   12406 K  |   12406 K  |
|       from small pool |       0    |    2780    |   12291 K  |   12291 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     131    |     269    |     389    |     258    |
|       from large pool |      80    |     201    |     302    |     222    |
|       from small pool |      51    |      70    |      87    |      36    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     307    |   13472 K  |   13472 K  |
|       from large pool |       3    |     196    |    7166 K  |    7166 K  |
|       from small pool |       0    |     226    |    6305 K  |    6305 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main

using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_03_29_30_seed_2_23090492

 Experiment start at: 2024-07-27 03:29:30.940709
hyper-parameter scheduler not set,going to use default Warmpup and epoch update
before training, model accuracy: 0.5995370149612427
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9545157, 'precision': 0.9562496, 'recall': 0.9542842, 'specificity': 0.9542842, 'f1': 0.95445347, 'auroc': 0.9948908, 'binary_precision': 0.9300184, 'binary_recall': 0.98376626, 'binary_specificity': 0.9248021, 'binary_f1_score': 0.9561376}
confusion matrix:
      0     1
0  1402   114
1    25  1515
---- Validation: 
scalar performance:
{'acc': 0.75273865, 'precision': 0.77447414, 'recall': 0.7563549, 'specificity': 0.7563549, 'f1': 0.74937755, 'auroc': 0.8637901, 'binary_precision': 0.6902985, 'binary_recall': 0.89228296, 'binary_specificity': 0.62042683, 'binary_f1_score': 0.7784011}
confusion matrix:
     0    1
0  407  249
1   67  555
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7916667, 'precision': 0.8160535, 'recall': 0.7916667, 'specificity': 0.7916667, 'f1': 0.78756887, 'auroc': 0.89726937, 'binary_precision': 0.7282609, 'binary_recall': 0.9305556, 'binary_specificity': 0.6527778, 'binary_f1_score': 0.81707317}
confusion matrix:
     0    1
0  141   75
1   15  201
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-27 03:32:21.915208,epoch time: 0:02:50.974499,used: 0:02:50.974499,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_03_29_30_seed_2_23090492
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9466623, 'precision': 0.9485104, 'recall': 0.94642, 'specificity': 0.94642, 'f1': 0.946584, 'auroc': 0.99062765, 'binary_precision': 0.9216167, 'binary_recall': 0.97727275, 'binary_specificity': 0.9155673, 'binary_f1_score': 0.9486291}
confusion matrix:
      0     1
0  1388   128
1    35  1505
---- Validation: 
scalar performance:
{'acc': 0.76212835, 'precision': 0.761989, 'recall': 0.76183486, 'specificity': 0.76183486, 'f1': 0.76189506, 'auroc': 0.84024787, 'binary_precision': 0.7581169, 'binary_recall': 0.7508039, 'binary_specificity': 0.77286583, 'binary_f1_score': 0.7544427}
confusion matrix:
     0    1
0  507  149
1  155  467
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7731481, 'precision': 0.80520165, 'recall': 0.7731482, 'specificity': 0.7731482, 'f1': 0.7670313, 'auroc': 0.8523234, 'binary_precision': 0.9041096, 'binary_recall': 0.6111111, 'binary_specificity': 0.9351852, 'binary_f1_score': 0.7292818}
confusion matrix:
     0    1
0  202   14
1   84  132
better model found
persisted
after epoch: 2,now: 2024-07-27 03:35:08.807041,epoch time: 0:02:46.891833,used: 0:05:37.866332,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_03_29_30_seed_2_23090492
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9528796, 'precision': 0.95651805, 'recall': 0.9532416, 'specificity': 0.9532416, 'f1': 0.9528092, 'auroc': 0.99858606, 'binary_precision': 0.9992847, 'binary_recall': 0.9071429, 'binary_specificity': 0.99934036, 'binary_f1_score': 0.95098704}
confusion matrix:
      0     1
0  1515     1
1   143  1397
---- Validation: 
scalar performance:
{'acc': 0.56729263, 'precision': 0.7344751, 'recall': 0.5557162, 'specificity': 0.5557162, 'f1': 0.45746818, 'auroc': 0.8638226, 'binary_precision': 0.9259259, 'binary_recall': 0.12057878, 'binary_specificity': 0.99085367, 'binary_f1_score': 0.21337126}
confusion matrix:
     0   1
0  650   6
1  547  75
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5300926, 'precision': 0.7244604, 'recall': 0.5300926, 'specificity': 0.5300926, 'f1': 0.40025848, 'auroc': 0.85628855, 'binary_precision': 0.93333334, 'binary_recall': 0.06481481, 'binary_specificity': 0.9953704, 'binary_f1_score': 0.121212125}
confusion matrix:
     0   1
0  215   1
1  202  14
early stop counter: 1
val acc:0.5672926306724548, best validation acc: 0.7621283531188965, corresponding to test acc:                         0.7731481194496155 / 0.7916666865348816
after epoch: 3,now: 2024-07-27 03:37:55.660805,epoch time: 0:02:46.853764,used: 0:08:24.720096,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_03_29_30_seed_2_23090492
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.95909685, 'precision': 0.95909965, 'recall': 0.9591278, 'specificity': 0.9591278, 'f1': 0.9590963, 'auroc': 0.9939164, 'binary_precision': 0.9633268, 'binary_recall': 0.95519483, 'binary_specificity': 0.9630607, 'binary_f1_score': 0.95924354}
confusion matrix:
      0     1
0  1460    56
1    69  1471
---- Validation: 
scalar performance:
{'acc': 0.74100155, 'precision': 0.74491805, 'recall': 0.73908913, 'specificity': 0.73908913, 'f1': 0.7388125, 'auroc': 0.8333906, 'binary_precision': 0.76994437, 'binary_recall': 0.6672026, 'binary_specificity': 0.8109756, 'binary_f1_score': 0.71490103}
confusion matrix:
     0    1
0  532  124
1  207  415
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7615741, 'precision': 0.76637566, 'recall': 0.76157403, 'specificity': 0.76157403, 'f1': 0.76049477, 'auroc': 0.85892487, 'binary_precision': 0.80213904, 'binary_recall': 0.6944444, 'binary_specificity': 0.8287037, 'binary_f1_score': 0.7444169}
confusion matrix:
     0    1
0  179   37
1   66  150
early stop counter: 2
val acc:0.741001546382904, best validation acc: 0.7621283531188965, corresponding to test acc:                         0.7731481194496155 / 0.7916666865348816
after epoch: 4,now: 2024-07-27 03:40:41.187685,epoch time: 0:02:45.526880,used: 0:11:10.246976,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_03_29_30_seed_2_23090492
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.97938484, 'precision': 0.97963214, 'recall': 0.97948897, 'specificity': 0.97948897, 'f1': 0.9793842, 'auroc': 0.9981358, 'binary_precision': 0.9926618, 'binary_recall': 0.9662338, 'binary_specificity': 0.9927441, 'binary_f1_score': 0.9792695}
confusion matrix:
      0     1
0  1505    11
1    52  1488
---- Validation: 
scalar performance:
{'acc': 0.7214398, 'precision': 0.80241, 'recall': 0.71440965, 'specificity': 0.71440965, 'f1': 0.6971402, 'auroc': 0.887151, 'binary_precision': 0.95238096, 'binary_recall': 0.45016077, 'binary_specificity': 0.97865856, 'binary_f1_score': 0.6113537}
confusion matrix:
     0    1
0  642   14
1  342  280
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6875, 'precision': 0.7819116, 'recall': 0.6875, 'specificity': 0.6875, 'f1': 0.65894544, 'auroc': 0.896755, 'binary_precision': 0.94505495, 'binary_recall': 0.39814815, 'binary_specificity': 0.9768519, 'binary_f1_score': 0.5602606}
confusion matrix:
     0   1
0  211   5
1  130  86
early stop counter: 3
val acc:0.721439778804779, best validation acc: 0.7621283531188965, corresponding to test acc:                         0.7731481194496155 / 0.7916666865348816
after epoch: 5,now: 2024-07-27 03:43:26.064654,epoch time: 0:02:44.876969,used: 0:13:55.123945,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_03_29_30_seed_2_23090492
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9826571, 'precision': 0.98267317, 'recall': 0.9826431, 'specificity': 0.9826431, 'f1': 0.9826555, 'auroc': 0.99837196, 'binary_precision': 0.9812298, 'binary_recall': 0.9844156, 'binary_specificity': 0.9808707, 'binary_f1_score': 0.98282015}
confusion matrix:
      0     1
0  1487    29
1    24  1516
---- Validation: 
scalar performance:
{'acc': 0.8356807, 'precision': 0.8355644, 'recall': 0.8355644, 'specificity': 0.8355644, 'f1': 0.8355644, 'auroc': 0.9031534, 'binary_precision': 0.8311897, 'binary_recall': 0.8311897, 'binary_specificity': 0.839939, 'binary_f1_score': 0.8311897}
confusion matrix:
     0    1
0  551  105
1  105  517
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8518519, 'precision': 0.8607912, 'recall': 0.8518518, 'specificity': 0.8518518, 'f1': 0.8509284, 'auroc': 0.9253472, 'binary_precision': 0.9175824, 'binary_recall': 0.7731481, 'binary_specificity': 0.9305556, 'binary_f1_score': 0.83919597}
confusion matrix:
     0    1
0  201   15
1   49  167
new oracle model saved
better model found
persisted
after epoch: 6,now: 2024-07-27 03:46:12.956363,epoch time: 0:02:46.891709,used: 0:16:42.015654,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_03_29_30_seed_2_23090492
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.98658377, 'precision': 0.9865775, 'recall': 0.9865906, 'specificity': 0.9865906, 'f1': 0.9865831, 'auroc': 0.9991249, 'binary_precision': 0.98763824, 'binary_recall': 0.98571426, 'binary_specificity': 0.987467, 'binary_f1_score': 0.9866753}
confusion matrix:
      0     1
0  1497    19
1    22  1518
---- Validation: 
scalar performance:
{'acc': 0.8341158, 'precision': 0.8463515, 'recall': 0.83158183, 'specificity': 0.83158183, 'f1': 0.8317987, 'auroc': 0.91659236, 'binary_precision': 0.9051383, 'binary_recall': 0.7363344, 'binary_specificity': 0.9268293, 'binary_f1_score': 0.8120567}
confusion matrix:
     0    1
0  608   48
1  164  458
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8217593, 'precision': 0.856013, 'recall': 0.8217593, 'specificity': 0.8217593, 'f1': 0.81736624, 'auroc': 0.92796206, 'binary_precision': 0.96644294, 'binary_recall': 0.6666667, 'binary_specificity': 0.9768519, 'binary_f1_score': 0.78904116}
confusion matrix:
     0    1
0  211    5
1   72  144
early stop counter: 1
val acc:0.8341158032417297, best validation acc: 0.8356807231903076, corresponding to test acc:                         0.8518518805503845 / 0.8518518805503845
after epoch: 7,now: 2024-07-27 03:48:59.017551,epoch time: 0:02:46.061188,used: 0:19:28.076842,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_03_29_30_seed_2_23090492
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9689136, 'precision': 0.97051525, 'recall': 0.96915585, 'specificity': 0.96915585, 'f1': 0.96889687, 'auroc': 0.9980237, 'binary_precision': 1.0, 'binary_recall': 0.9383117, 'binary_specificity': 1.0, 'binary_f1_score': 0.9681742}
confusion matrix:
      0     1
0  1516     0
1    95  1445
---- Validation: 
scalar performance:
{'acc': 0.6651017, 'precision': 0.7822445, 'recall': 0.65632355, 'specificity': 0.65632355, 'f1': 0.61913115, 'auroc': 0.8869329, 'binary_precision': 0.9575472, 'binary_recall': 0.32636657, 'binary_specificity': 0.9862805, 'binary_f1_score': 0.48681056}
confusion matrix:
     0    1
0  647    9
1  419  203
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5439815, 'precision': 0.7181355, 'recall': 0.5439815, 'specificity': 0.5439815, 'f1': 0.43026608, 'auroc': 0.8790349, 'binary_precision': 0.9130435, 'binary_recall': 0.097222224, 'binary_specificity': 0.9907407, 'binary_f1_score': 0.17573223}
confusion matrix:
     0   1
0  214   2
1  195  21
early stop counter: 2
val acc:0.6651017069816589, best validation acc: 0.8356807231903076, corresponding to test acc:                         0.8518518805503845 / 0.8518518805503845
after epoch: 8,now: 2024-07-27 03:51:45.544089,epoch time: 0:02:46.526538,used: 0:22:14.603380,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_03_29_30_seed_2_23090492
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9787304, 'precision': 0.9792617, 'recall': 0.9788755, 'specificity': 0.9788755, 'f1': 0.9787279, 'auroc': 0.9987737, 'binary_precision': 0.9973028, 'binary_recall': 0.9603896, 'binary_specificity': 0.9973615, 'binary_f1_score': 0.97849816}
confusion matrix:
      0     1
0  1512     4
1    61  1479
---- Validation: 
scalar performance:
{'acc': 0.6455399, 'precision': 0.7772213, 'recall': 0.63614374, 'specificity': 0.63614374, 'f1': 0.5892789, 'auroc': 0.8895871, 'binary_precision': 0.96174866, 'binary_recall': 0.2829582, 'binary_specificity': 0.9893293, 'binary_f1_score': 0.43726712}
confusion matrix:
     0    1
0  649    7
1  446  176
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5740741, 'precision': 0.7553946, 'recall': 0.5740741, 'specificity': 0.5740741, 'f1': 0.4821629, 'auroc': 0.90307784, 'binary_precision': 0.9705882, 'binary_recall': 0.15277778, 'binary_specificity': 0.9953704, 'binary_f1_score': 0.26399997}
confusion matrix:
     0   1
0  215   1
1  183  33
early stop counter: 3
val acc:0.6455398797988892, best validation acc: 0.8356807231903076, corresponding to test acc:                         0.8518518805503845 / 0.8518518805503845
after epoch: 9,now: 2024-07-27 03:54:31.717574,epoch time: 0:02:46.173485,used: 0:25:00.776865,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_03_29_30_seed_2_23090492
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9856021, 'precision': 0.98580956, 'recall': 0.9856989, 'specificity': 0.9856989, 'f1': 0.9856018, 'auroc': 0.9995246, 'binary_precision': 0.99800265, 'binary_recall': 0.97337663, 'binary_specificity': 0.9980211, 'binary_f1_score': 0.9855358}
confusion matrix:
      0     1
0  1513     3
1    41  1499
---- Validation: 
scalar performance:
{'acc': 0.8458529, 'precision': 0.8501551, 'recall': 0.84434795, 'specificity': 0.84434795, 'f1': 0.84488404, 'auroc': 0.91372, 'binary_precision': 0.8828829, 'binary_recall': 0.78778136, 'binary_specificity': 0.9009146, 'binary_f1_score': 0.83262527}
confusion matrix:
     0    1
0  591   65
1  132  490
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8564815, 'precision': 0.8609375, 'recall': 0.85648143, 'specificity': 0.85648143, 'f1': 0.85603714, 'auroc': 0.9293982, 'binary_precision': 0.9010417, 'binary_recall': 0.8009259, 'binary_specificity': 0.912037, 'binary_f1_score': 0.8480392}
confusion matrix:
     0    1
0  197   19
1   43  173
new oracle model saved
better model found
persisted
after epoch: 10,now: 2024-07-27 03:57:19.370517,epoch time: 0:02:47.652943,used: 0:27:48.429808,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_03_29_30_seed_2_23090492
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9826571, 'precision': 0.98274213, 'recall': 0.9827254, 'specificity': 0.9827254, 'f1': 0.982657, 'auroc': 0.99860704, 'binary_precision': 0.9914078, 'binary_recall': 0.97402596, 'binary_specificity': 0.9914248, 'binary_f1_score': 0.98263997}
confusion matrix:
      0     1
0  1503    13
1    40  1500
---- Validation: 
scalar performance:
{'acc': 0.6627543, 'precision': 0.75712246, 'recall': 0.6544536, 'specificity': 0.6544536, 'f1': 0.6217021, 'auroc': 0.7637832, 'binary_precision': 0.906383, 'binary_recall': 0.34244373, 'binary_specificity': 0.9664634, 'binary_f1_score': 0.49708283}
confusion matrix:
     0    1
0  634   22
1  409  213
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6944444, 'precision': 0.79473686, 'recall': 0.6944444, 'specificity': 0.6944444, 'f1': 0.6660341, 'auroc': 0.8419281, 'binary_precision': 0.96666664, 'binary_recall': 0.4027778, 'binary_specificity': 0.9861111, 'binary_f1_score': 0.5686275}
confusion matrix:
     0   1
0  213   3
1  129  87
early stop counter: 1
val acc:0.6627542972564697, best validation acc: 0.8458529114723206, corresponding to test acc:                         0.8564814925193787 / 0.8564814925193787
after epoch: 11,now: 2024-07-27 04:00:05.456821,epoch time: 0:02:46.086304,used: 0:30:34.516112,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_03_29_30_seed_2_23090492
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.97709423, 'precision': 0.9779705, 'recall': 0.9769386, 'specificity': 0.9769386, 'f1': 0.9770769, 'auroc': 0.9994141, 'binary_precision': 0.959375, 'binary_recall': 0.9967533, 'binary_specificity': 0.957124, 'binary_f1_score': 0.977707}
confusion matrix:
      0     1
0  1451    65
1     5  1535
---- Validation: 
scalar performance:
{'acc': 0.80359936, 'precision': 0.82300013, 'recall': 0.8068142, 'specificity': 0.8068142, 'f1': 0.8016405, 'auroc': 0.913399, 'binary_precision': 0.73690933, 'binary_recall': 0.9276527, 'binary_specificity': 0.6859756, 'binary_f1_score': 0.82135236}
confusion matrix:
     0    1
0  450  206
1   45  577
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8240741, 'precision': 0.8368083, 'recall': 0.8240741, 'specificity': 0.8240741, 'f1': 0.8223954, 'auroc': 0.9169239, 'binary_precision': 0.77131784, 'binary_recall': 0.9212963, 'binary_specificity': 0.7268519, 'binary_f1_score': 0.8396625}
confusion matrix:
     0    1
0  157   59
1   17  199
early stop counter: 2
val acc:0.8035993576049805, best validation acc: 0.8458529114723206, corresponding to test acc:                         0.8564814925193787 / 0.8564814925193787
after epoch: 12,now: 2024-07-27 04:02:51.898505,epoch time: 0:02:46.441684,used: 0:33:20.957796,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_03_29_30_seed_2_23090492
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.97742146, 'precision': 0.97823346, 'recall': 0.9775974, 'specificity': 0.9775974, 'f1': 0.9774165, 'auroc': 0.99862325, 'binary_precision': 1.0, 'binary_recall': 0.95519483, 'binary_specificity': 1.0, 'binary_f1_score': 0.97708404}
confusion matrix:
      0     1
0  1516     0
1    69  1471
---- Validation: 
scalar performance:
{'acc': 0.57824725, 'precision': 0.75266397, 'recall': 0.5668869, 'specificity': 0.5668869, 'f1': 0.47579065, 'auroc': 0.85133576, 'binary_precision': 0.95604396, 'binary_recall': 0.13987139, 'binary_specificity': 0.99390244, 'binary_f1_score': 0.2440393}
confusion matrix:
     0   1
0  652   4
1  535  87
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5601852, 'precision': 0.7660098, 'recall': 0.5601852, 'specificity': 0.5601852, 'f1': 0.4547049, 'auroc': 0.89315414, 'binary_precision': 1.0, 'binary_recall': 0.12037037, 'binary_specificity': 1.0, 'binary_f1_score': 0.21487604}
confusion matrix:
     0   1
0  216   0
1  190  26
early stop counter: 3
val acc:0.5782472491264343, best validation acc: 0.8458529114723206, corresponding to test acc:                         0.8564814925193787 / 0.8564814925193787
after epoch: 13,now: 2024-07-27 04:05:37.432064,epoch time: 0:02:45.533559,used: 0:36:06.491355,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_03_29_30_seed_2_23090492
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.989856, 'precision': 0.9899249, 'recall': 0.98991966, 'specificity': 0.98991966, 'f1': 0.989856, 'auroc': 0.99952793, 'binary_precision': 0.9980198, 'binary_recall': 0.9818182, 'binary_specificity': 0.9980211, 'binary_f1_score': 0.9898527}
confusion matrix:
      0     1
0  1513     3
1    28  1512
---- Validation: 
scalar performance:
{'acc': 0.74726135, 'precision': 0.7759465, 'recall': 0.74281186, 'specificity': 0.74281186, 'f1': 0.73810196, 'auroc': 0.8572539, 'binary_precision': 0.8585132, 'binary_recall': 0.5755627, 'binary_specificity': 0.910061, 'binary_f1_score': 0.68912417}
confusion matrix:
     0    1
0  597   59
1  264  358
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7939815, 'precision': 0.8449091, 'recall': 0.7939815, 'specificity': 0.7939815, 'f1': 0.7860851, 'auroc': 0.932806, 'binary_precision': 0.97744364, 'binary_recall': 0.6018519, 'binary_specificity': 0.9861111, 'binary_f1_score': 0.7449857}
confusion matrix:
     0    1
0  213    3
1   86  130
early stop counter: 4
val acc:0.7472613453865051, best validation acc: 0.8458529114723206, corresponding to test acc:                         0.8564814925193787 / 0.8564814925193787
after epoch: 14,now: 2024-07-27 04:08:24.012402,epoch time: 0:02:46.580338,used: 0:38:53.071693,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_03_29_30_seed_2_23090492
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.989856, 'precision': 0.9898656, 'recall': 0.9898939, 'specificity': 0.9898939, 'f1': 0.9898559, 'auroc': 0.9990705, 'binary_precision': 0.9947541, 'binary_recall': 0.9850649, 'binary_specificity': 0.99472296, 'binary_f1_score': 0.98988575}
confusion matrix:
      0     1
0  1508     8
1    23  1517
---- Validation: 
scalar performance:
{'acc': 0.75117373, 'precision': 0.7855159, 'recall': 0.74641454, 'specificity': 0.74641454, 'f1': 0.7409406, 'auroc': 0.87989426, 'binary_precision': 0.87810946, 'binary_recall': 0.56752414, 'binary_specificity': 0.9253049, 'binary_f1_score': 0.68945307}
confusion matrix:
     0    1
0  607   49
1  269  353
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8217593, 'precision': 0.83148587, 'recall': 0.8217592, 'specificity': 0.8217592, 'f1': 0.8204421, 'auroc': 0.89973426, 'binary_precision': 0.8882682, 'binary_recall': 0.7361111, 'binary_specificity': 0.9074074, 'binary_f1_score': 0.8050633}
confusion matrix:
     0    1
0  196   20
1   57  159
early stop counter: 5
val acc:0.751173734664917, best validation acc: 0.8458529114723206, corresponding to test acc:                         0.8564814925193787 / 0.8564814925193787
after epoch: 15,now: 2024-07-27 04:11:09.370971,epoch time: 0:02:45.358569,used: 0:41:38.430262,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_03_29_30_seed_2_23090492
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 15 with time: 0:41:38.430262 at 2024-07-27 04:11:09.370971
persisted model performance metric: 

scalar performance:
{'acc': 0.8564815, 'precision': 0.8609375, 'recall': 0.85648143, 'specificity': 0.85648143, 'f1': 0.85603714, 'auroc': 0.9293982, 'binary_precision': 0.9010417, 'binary_recall': 0.8009259, 'binary_specificity': 0.912037, 'binary_f1_score': 0.8480392}
confusion matrix:
     0    1
0  197   19
1   43  173
oracle model performance metric: 

scalar performance:
{'acc': 0.8564815, 'precision': 0.8609375, 'recall': 0.85648143, 'specificity': 0.85648143, 'f1': 0.85603714, 'auroc': 0.9293982, 'binary_precision': 0.9010417, 'binary_recall': 0.8009259, 'binary_specificity': 0.912037, 'binary_f1_score': 0.8480392}
confusion matrix:
     0    1
0  197   19
1   43  173
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_diva_irm_3seeds_nofreeze_2024-07-27_01-18-02/rule_results/8.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_diva_irm_3seeds_nofreeze_2024-07-27_01-18-02/confusion_matrix/8.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   2393 MiB |   8913 MiB | 273430 GiB | 273428 GiB |
|       from large pool |   2302 MiB |   8837 MiB | 271038 GiB | 271036 GiB |
|       from small pool |     91 MiB |    132 MiB |   2392 GiB |   2392 GiB |
|---------------------------------------------------------------------------|
| Active memory         |   2393 MiB |   8913 MiB | 273430 GiB | 273428 GiB |
|       from large pool |   2302 MiB |   8837 MiB | 271038 GiB | 271036 GiB |
|       from small pool |     91 MiB |    132 MiB |   2392 GiB |   2392 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |   2375 MiB |   8902 MiB | 272969 GiB | 272967 GiB |
|       from large pool |   2284 MiB |   8826 MiB | 270581 GiB | 270578 GiB |
|       from small pool |     91 MiB |    132 MiB |   2388 GiB |   2388 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   9634 MiB |   9714 MiB |  21862 MiB |  12228 MiB |
|       from large pool |   9498 MiB |   9578 MiB |  21654 MiB |  12156 MiB |
|       from small pool |    136 MiB |    140 MiB |    208 MiB |     72 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |   1692 MiB |   2815 MiB | 232362 GiB | 232361 GiB |
|       from large pool |   1681 MiB |   2809 MiB | 229897 GiB | 229895 GiB |
|       from small pool |     10 MiB |     60 MiB |   2465 GiB |   2465 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    2464    |    3329    |   38849 K  |   38847 K  |
|       from large pool |     392    |     816    |   19520 K  |   19519 K  |
|       from small pool |    2072    |    2780    |   19329 K  |   19327 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    2464    |    3329    |   38849 K  |   38847 K  |
|       from large pool |     392    |     816    |   19520 K  |   19519 K  |
|       from small pool |    2072    |    2780    |   19329 K  |   19327 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     221    |     269    |     479    |     258    |
|       from large pool |     153    |     201    |     375    |     222    |
|       from small pool |      68    |      70    |     104    |      36    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     150    |     307    |   20882 K  |   20882 K  |
|       from large pool |      80    |     196    |   10950 K  |   10950 K  |
|       from small pool |      70    |     226    |    9931 K  |    9931 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   8913 MiB | 273430 GiB | 273430 GiB |
|       from large pool |  16640 KiB |   8837 MiB | 271038 GiB | 271038 GiB |
|       from small pool |      0 KiB |    132 MiB |   2392 GiB |   2392 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   8913 MiB | 273430 GiB | 273430 GiB |
|       from large pool |  16640 KiB |   8837 MiB | 271038 GiB | 271038 GiB |
|       from small pool |      0 KiB |    132 MiB |   2392 GiB |   2392 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   8902 MiB | 272969 GiB | 272969 GiB |
|       from large pool |  16640 KiB |   8826 MiB | 270581 GiB | 270581 GiB |
|       from small pool |      0 KiB |    132 MiB |   2388 GiB |   2388 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   4086 MiB |   9714 MiB |  21862 MiB |  17776 MiB |
|       from large pool |   3984 MiB |   9578 MiB |  21654 MiB |  17670 MiB |
|       from small pool |    102 MiB |    140 MiB |    208 MiB |    106 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   2815 MiB | 232363 GiB | 232363 GiB |
|       from large pool |  24320 KiB |   2809 MiB | 229898 GiB | 229898 GiB |
|       from small pool |      0 KiB |     60 MiB |   2465 GiB |   2465 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3329    |   38849 K  |   38849 K  |
|       from large pool |       2    |     816    |   19520 K  |   19520 K  |
|       from small pool |       0    |    2780    |   19329 K  |   19329 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3329    |   38849 K  |   38849 K  |
|       from large pool |       2    |     816    |   19520 K  |   19520 K  |
|       from small pool |       0    |    2780    |   19329 K  |   19329 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     132    |     269    |     479    |     347    |
|       from large pool |      81    |     201    |     375    |     294    |
|       from small pool |      51    |      70    |     104    |      53    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     307    |   20882 K  |   20882 K  |
|       from large pool |       3    |     196    |   10950 K  |   10950 K  |
|       from small pool |       0    |     226    |    9932 K  |    9932 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Sat Jul 27 04:11:20 2024]
Finished job 0.
1 of 1 steps (100%) done
