Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Sat Jul 27 01:19:39 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_diva_irm_3seeds_nofreeze_2024-07-27_01-18-02/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_diva_irm_3seeds_nofreeze_2024-07-27_01-18-02/rule_results/6.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=6
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/swiglu_ffn.py:51: UserWarning: xFormers is not available (SwiGLU)
  warnings.warn("xFormers is not available (SwiGLU)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/attention.py:33: UserWarning: xFormers is not available (Attention)
  warnings.warn("xFormers is not available (Attention)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/block.py:40: UserWarning: xFormers is not available (Block)
  warnings.warn("xFormers is not available (Block)")
Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main

using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_01_20_24_seed_0_23090487

 Experiment start at: 2024-07-27 01:20:25.861904
hyper-parameter scheduler not set,going to use default Warmpup and epoch update
before training, model accuracy: 0.48604652285575867
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.95182294, 'precision': 0.955084, 'recall': 0.9524371, 'specificity': 0.9524371, 'f1': 0.9517738, 'auroc': 0.99530494, 'binary_precision': 0.9971771, 'binary_recall': 0.90751445, 'binary_specificity': 0.99735975, 'binary_f1_score': 0.95023537}
confusion matrix:
      0     1
0  1511     4
1   144  1413
---- Validation: 
scalar performance:
{'acc': 0.77329195, 'precision': 0.7801343, 'recall': 0.77216244, 'specificity': 0.77216244, 'f1': 0.771373, 'auroc': 0.8649311, 'binary_precision': 0.82056075, 'binary_recall': 0.6913386, 'binary_specificity': 0.8529862, 'binary_f1_score': 0.7504273}
confusion matrix:
     0    1
0  557   96
1  196  439
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8, 'precision': 0.8009375, 'recall': 0.79999995, 'specificity': 0.79999995, 'f1': 0.799844, 'auroc': 0.86048675, 'binary_precision': 0.817734, 'binary_recall': 0.772093, 'binary_specificity': 0.82790697, 'binary_f1_score': 0.7942583}
confusion matrix:
     0    1
0  178   37
1   49  166
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-27 01:23:25.368520,epoch time: 0:02:59.506616,used: 0:02:59.506616,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_01_20_24_seed_0_23090487
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9560547, 'precision': 0.9573892, 'recall': 0.95574594, 'specificity': 0.95574594, 'f1': 0.9559951, 'auroc': 0.9958172, 'binary_precision': 0.9355828, 'binary_recall': 0.9807074, 'binary_specificity': 0.93078446, 'binary_f1_score': 0.95761377}
confusion matrix:
      0     1
0  1412   105
1    30  1525
---- Validation: 
scalar performance:
{'acc': 0.7119565, 'precision': 0.7166766, 'recall': 0.7108476, 'specificity': 0.7108476, 'f1': 0.7096418, 'auroc': 0.8046714, 'binary_precision': 0.74535316, 'binary_recall': 0.6314961, 'binary_specificity': 0.7901991, 'binary_f1_score': 0.683717}
confusion matrix:
     0    1
0  516  137
1  234  401
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.75348836, 'precision': 0.77338374, 'recall': 0.75348836, 'specificity': 0.75348836, 'f1': 0.7489203, 'auroc': 0.85568416, 'binary_precision': 0.84713376, 'binary_recall': 0.61860466, 'binary_specificity': 0.88837206, 'binary_f1_score': 0.71505374}
confusion matrix:
     0    1
0  191   24
1   82  133
early stop counter: 1
val acc:0.7119565010070801, best validation acc: 0.7732919454574585, corresponding to test acc:                         0.800000011920929 / 0.800000011920929
after epoch: 2,now: 2024-07-27 01:26:18.825080,epoch time: 0:02:53.456560,used: 0:05:52.963176,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_01_20_24_seed_0_23090487
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.96875, 'precision': 0.9702418, 'recall': 0.9691318, 'specificity': 0.9691318, 'f1': 0.96873885, 'auroc': 0.99674046, 'binary_precision': 1.0, 'binary_recall': 0.93826365, 'binary_specificity': 1.0, 'binary_f1_score': 0.96814865}
confusion matrix:
      0     1
0  1517     0
1    96  1459
---- Validation: 
scalar performance:
{'acc': 0.6459627, 'precision': 0.7298726, 'recall': 0.64166117, 'specificity': 0.64166117, 'f1': 0.6064751, 'auroc': 0.83484524, 'binary_precision': 0.86530614, 'binary_recall': 0.33385828, 'binary_specificity': 0.949464, 'binary_f1_score': 0.4818182}
confusion matrix:
     0    1
0  620   33
1  423  212
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6348837, 'precision': 0.74742067, 'recall': 0.63488376, 'specificity': 0.63488376, 'f1': 0.5880397, 'auroc': 0.8758248, 'binary_precision': 0.9142857, 'binary_recall': 0.29767442, 'binary_specificity': 0.97209305, 'binary_f1_score': 0.44912282}
confusion matrix:
     0   1
0  209   6
1  151  64
early stop counter: 2
val acc:0.6459627151489258, best validation acc: 0.7732919454574585, corresponding to test acc:                         0.800000011920929 / 0.800000011920929
after epoch: 3,now: 2024-07-27 01:29:12.721071,epoch time: 0:02:53.895991,used: 0:08:46.859167,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_01_20_24_seed_0_23090487
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.96484375, 'precision': 0.9667488, 'recall': 0.9652957, 'specificity': 0.9652957, 'f1': 0.96482646, 'auroc': 0.9976629, 'binary_precision': 1.0, 'binary_recall': 0.9305913, 'binary_specificity': 1.0, 'binary_f1_score': 0.9640479}
confusion matrix:
      0     1
0  1516     0
1   108  1448
---- Validation: 
scalar performance:
{'acc': 0.6560559, 'precision': 0.7583176, 'recall': 0.6515935, 'specificity': 0.6515935, 'f1': 0.6144742, 'auroc': 0.8453727, 'binary_precision': 0.9173913, 'binary_recall': 0.33228347, 'binary_specificity': 0.9709035, 'binary_f1_score': 0.48786125}
confusion matrix:
     0    1
0  634   19
1  424  211
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6488372, 'precision': 0.73255813, 'recall': 0.6488372, 'specificity': 0.6488372, 'f1': 0.6141068, 'auroc': 0.86156845, 'binary_precision': 0.872093, 'binary_recall': 0.3488372, 'binary_specificity': 0.9488372, 'binary_f1_score': 0.49833885}
confusion matrix:
     0   1
0  204  11
1  140  75
early stop counter: 3
val acc:0.6560559272766113, best validation acc: 0.7732919454574585, corresponding to test acc:                         0.800000011920929 / 0.800000011920929
after epoch: 4,now: 2024-07-27 01:32:04.875796,epoch time: 0:02:52.154725,used: 0:11:39.013892,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_01_20_24_seed_0_23090487
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9824219, 'precision': 0.9824821, 'recall': 0.9823717, 'specificity': 0.9823717, 'f1': 0.98241645, 'auroc': 0.9989095, 'binary_precision': 0.97959185, 'binary_recall': 0.98587936, 'binary_specificity': 0.97886395, 'binary_f1_score': 0.9827255}
confusion matrix:
      0     1
0  1482    32
1    22  1536
---- Validation: 
scalar performance:
{'acc': 0.8175466, 'precision': 0.82916117, 'recall': 0.8162195, 'specificity': 0.8162195, 'f1': 0.8154587, 'auroc': 0.90418065, 'binary_precision': 0.8875969, 'binary_recall': 0.72125983, 'binary_specificity': 0.9111792, 'binary_f1_score': 0.7958297}
confusion matrix:
     0    1
0  595   58
1  177  458
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8418605, 'precision': 0.8631005, 'recall': 0.8418604, 'specificity': 0.8418604, 'f1': 0.8395134, 'auroc': 0.92571115, 'binary_precision': 0.9509202, 'binary_recall': 0.7209302, 'binary_specificity': 0.96279067, 'binary_f1_score': 0.8201058}
confusion matrix:
     0    1
0  207    8
1   60  155
new oracle model saved
better model found
persisted
after epoch: 5,now: 2024-07-27 01:34:58.551221,epoch time: 0:02:53.675425,used: 0:14:32.689317,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_01_20_24_seed_0_23090487
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.98014325, 'precision': 0.9805411, 'recall': 0.980373, 'specificity': 0.980373, 'f1': 0.9801427, 'auroc': 0.99871886, 'binary_precision': 0.99800134, 'binary_recall': 0.9627249, 'binary_specificity': 0.9980211, 'binary_f1_score': 0.9800458}
confusion matrix:
      0     1
0  1513     3
1    58  1498
---- Validation: 
scalar performance:
{'acc': 0.7445652, 'precision': 0.80930793, 'recall': 0.7413356, 'specificity': 0.7413356, 'f1': 0.7287507, 'auroc': 0.9228569, 'binary_precision': 0.94736844, 'binary_recall': 0.5102362, 'binary_specificity': 0.97243494, 'binary_f1_score': 0.66325486}
confusion matrix:
     0    1
0  635   18
1  311  324
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7093023, 'precision': 0.7931818, 'recall': 0.7093023, 'specificity': 0.7093023, 'f1': 0.68690836, 'auroc': 0.8926555, 'binary_precision': 0.95, 'binary_recall': 0.44186047, 'binary_specificity': 0.9767442, 'binary_f1_score': 0.60317457}
confusion matrix:
     0   1
0  210   5
1  120  95
early stop counter: 1
val acc:0.7445651888847351, best validation acc: 0.8175466060638428, corresponding to test acc:                         0.8418604731559753 / 0.8418604731559753
after epoch: 6,now: 2024-07-27 01:37:52.010167,epoch time: 0:02:53.458946,used: 0:17:26.148263,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_01_20_24_seed_0_23090487
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.95996094, 'precision': 0.9627522, 'recall': 0.9595078, 'specificity': 0.9595078, 'f1': 0.9598665, 'auroc': 0.9990084, 'binary_precision': 0.9297719, 'binary_recall': 0.9961415, 'binary_specificity': 0.9228741, 'binary_f1_score': 0.9618131}
confusion matrix:
      0     1
0  1400   117
1     6  1549
---- Validation: 
scalar performance:
{'acc': 0.73913044, 'precision': 0.7512914, 'recall': 0.7406205, 'specificity': 0.7406205, 'f1': 0.7366899, 'auroc': 0.83982825, 'binary_precision': 0.6924067, 'binary_recall': 0.8472441, 'binary_specificity': 0.63399696, 'binary_f1_score': 0.76203966}
confusion matrix:
     0    1
0  414  239
1   97  538
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.69069767, 'precision': 0.77093065, 'recall': 0.69069767, 'specificity': 0.69069767, 'f1': 0.6659677, 'auroc': 0.90275824, 'binary_precision': 0.62349397, 'binary_recall': 0.96279067, 'binary_specificity': 0.41860464, 'binary_f1_score': 0.75685555}
confusion matrix:
    0    1
0  90  125
1   8  207
early stop counter: 2
val acc:0.739130437374115, best validation acc: 0.8175466060638428, corresponding to test acc:                         0.8418604731559753 / 0.8418604731559753
after epoch: 7,now: 2024-07-27 01:40:45.023135,epoch time: 0:02:53.012968,used: 0:20:19.161231,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_01_20_24_seed_0_23090487
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.97591144, 'precision': 0.97653675, 'recall': 0.9756818, 'specificity': 0.9756818, 'f1': 0.9758898, 'auroc': 0.9984984, 'binary_precision': 0.9626168, 'binary_recall': 0.9910199, 'binary_specificity': 0.96034366, 'binary_f1_score': 0.9766119}
confusion matrix:
      0     1
0  1453    60
1    14  1545
---- Validation: 
scalar performance:
{'acc': 0.8299689, 'precision': 0.83402264, 'recall': 0.8291869, 'specificity': 0.8291869, 'f1': 0.82918966, 'auroc': 0.89382684, 'binary_precision': 0.8674912, 'binary_recall': 0.77322835, 'binary_specificity': 0.8851455, 'binary_f1_score': 0.817652}
confusion matrix:
     0    1
0  578   75
1  144  491
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8372093, 'precision': 0.8439051, 'recall': 0.83720934, 'specificity': 0.83720934, 'f1': 0.836413, 'auroc': 0.9063277, 'binary_precision': 0.8918919, 'binary_recall': 0.76744187, 'binary_specificity': 0.90697676, 'binary_f1_score': 0.82500005}
confusion matrix:
     0    1
0  195   20
1   50  165
better model found
persisted
after epoch: 8,now: 2024-07-27 01:43:38.941535,epoch time: 0:02:53.918400,used: 0:23:13.079631,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_01_20_24_seed_0_23090487
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9788411, 'precision': 0.9794304, 'recall': 0.9791265, 'specificity': 0.9791265, 'f1': 0.97883993, 'auroc': 0.9993968, 'binary_precision': 1.0, 'binary_recall': 0.958253, 'binary_specificity': 1.0, 'binary_f1_score': 0.9786815}
confusion matrix:
      0     1
0  1515     0
1    65  1492
---- Validation: 
scalar performance:
{'acc': 0.5613354, 'precision': 0.7546084, 'recall': 0.55516154, 'specificity': 0.55516154, 'f1': 0.4502392, 'auroc': 0.901705, 'binary_precision': 0.972973, 'binary_recall': 0.11338583, 'binary_specificity': 0.9969372, 'binary_f1_score': 0.20310296}
confusion matrix:
     0   1
0  651   2
1  563  72
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.53023255, 'precision': 0.7577938, 'recall': 0.53023255, 'specificity': 0.53023255, 'f1': 0.39720738, 'auroc': 0.90306115, 'binary_precision': 1.0, 'binary_recall': 0.060465116, 'binary_specificity': 1.0, 'binary_f1_score': 0.11403509}
confusion matrix:
     0   1
0  215   0
1  202  13
early stop counter: 1
val acc:0.5613353848457336, best validation acc: 0.8299689292907715, corresponding to test acc:                         0.8372092843055725 / 0.8418604731559753
after epoch: 9,now: 2024-07-27 01:46:30.627205,epoch time: 0:02:51.685670,used: 0:26:04.765301,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_01_20_24_seed_0_23090487
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.98502606, 'precision': 0.9850353, 'recall': 0.9851168, 'specificity': 0.9851168, 'f1': 0.9850255, 'auroc': 0.9993175, 'binary_precision': 0.9921773, 'binary_recall': 0.9781491, 'binary_specificity': 0.99208444, 'binary_f1_score': 0.98511326}
confusion matrix:
      0     1
0  1504    12
1    34  1522
---- Validation: 
scalar performance:
{'acc': 0.8074534, 'precision': 0.828223, 'recall': 0.80567944, 'specificity': 0.80567944, 'f1': 0.8037044, 'auroc': 0.91111887, 'binary_precision': 0.9073684, 'binary_recall': 0.67874014, 'binary_specificity': 0.9326187, 'binary_f1_score': 0.7765766}
confusion matrix:
     0    1
0  609   44
1  204  431
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8418605, 'precision': 0.85172164, 'recall': 0.8418605, 'specificity': 0.8418605, 'f1': 0.84074426, 'auroc': 0.91154134, 'binary_precision': 0.91061455, 'binary_recall': 0.75813955, 'binary_specificity': 0.9255814, 'binary_f1_score': 0.8274112}
confusion matrix:
     0    1
0  199   16
1   52  163
early stop counter: 2
val acc:0.8074533939361572, best validation acc: 0.8299689292907715, corresponding to test acc:                         0.8372092843055725 / 0.8418604731559753
after epoch: 10,now: 2024-07-27 01:49:22.529899,epoch time: 0:02:51.902694,used: 0:28:56.667995,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_01_20_24_seed_0_23090487
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9892578, 'precision': 0.98923886, 'recall': 0.9893005, 'specificity': 0.9893005, 'f1': 0.989257, 'auroc': 0.99943244, 'binary_precision': 0.99287564, 'binary_recall': 0.98585206, 'binary_specificity': 0.99274886, 'binary_f1_score': 0.9893514}
confusion matrix:
      0     1
0  1506    11
1    22  1533
---- Validation: 
scalar performance:
{'acc': 0.8408385, 'precision': 0.86084425, 'recall': 0.83919036, 'specificity': 0.83919036, 'f1': 0.838117, 'auroc': 0.9234665, 'binary_precision': 0.9423868, 'binary_recall': 0.72125983, 'binary_specificity': 0.95712095, 'binary_f1_score': 0.8171275}
confusion matrix:
     0    1
0  625   28
1  177  458
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7906977, 'precision': 0.83741367, 'recall': 0.7906977, 'specificity': 0.7906977, 'f1': 0.78319323, 'auroc': 0.9425851, 'binary_precision': 0.962963, 'binary_recall': 0.60465115, 'binary_specificity': 0.9767442, 'binary_f1_score': 0.74285716}
confusion matrix:
     0    1
0  210    5
1   85  130
better model found
persisted
after epoch: 11,now: 2024-07-27 01:52:14.875618,epoch time: 0:02:52.345719,used: 0:31:49.013714,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_01_20_24_seed_0_23090487
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.98795575, 'precision': 0.98794425, 'recall': 0.98796594, 'specificity': 0.98796594, 'f1': 0.9879542, 'auroc': 0.99931324, 'binary_precision': 0.9890464, 'binary_recall': 0.9871383, 'binary_specificity': 0.9887937, 'binary_f1_score': 0.98809147}
confusion matrix:
      0     1
0  1500    17
1    20  1535
---- Validation: 
scalar performance:
{'acc': 0.77717394, 'precision': 0.8001973, 'recall': 0.7752095, 'specificity': 0.7752095, 'f1': 0.77194667, 'auroc': 0.88757396, 'binary_precision': 0.8799127, 'binary_recall': 0.63464564, 'binary_specificity': 0.91577333, 'binary_f1_score': 0.73741996}
confusion matrix:
     0    1
0  598   55
1  232  403
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8534884, 'precision': 0.86968327, 'recall': 0.8534884, 'specificity': 0.8534884, 'f1': 0.851866, 'auroc': 0.9237858, 'binary_precision': 0.9470588, 'binary_recall': 0.74883723, 'binary_specificity': 0.95813954, 'binary_f1_score': 0.8363636}
confusion matrix:
     0    1
0  206    9
1   54  161
new oracle model saved
early stop counter: 1
val acc:0.7771739363670349, best validation acc: 0.8408384919166565, corresponding to test acc:                         0.7906976938247681 / 0.8534883856773376
after epoch: 12,now: 2024-07-27 01:55:08.444832,epoch time: 0:02:53.569214,used: 0:34:42.582928,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_01_20_24_seed_0_23090487
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9892578, 'precision': 0.9892603, 'recall': 0.9892514, 'specificity': 0.9892514, 'f1': 0.98925567, 'auroc': 0.999158, 'binary_precision': 0.9890886, 'binary_recall': 0.9897238, 'binary_specificity': 0.9887789, 'binary_f1_score': 0.98940605}
confusion matrix:
      0     1
0  1498    17
1    16  1541
---- Validation: 
scalar performance:
{'acc': 0.81055903, 'precision': 0.82992625, 'recall': 0.80885077, 'specificity': 0.80885077, 'f1': 0.80711937, 'auroc': 0.92230654, 'binary_precision': 0.9064449, 'binary_recall': 0.68661416, 'binary_specificity': 0.9310873, 'binary_f1_score': 0.78136206}
confusion matrix:
     0    1
0  608   45
1  199  436
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8372093, 'precision': 0.8458586, 'recall': 0.83720934, 'specificity': 0.83720934, 'f1': 0.8361851, 'auroc': 0.90383995, 'binary_precision': 0.9005525, 'binary_recall': 0.75813955, 'binary_specificity': 0.9162791, 'binary_f1_score': 0.82323235}
confusion matrix:
     0    1
0  197   18
1   52  163
early stop counter: 2
val acc:0.8105590343475342, best validation acc: 0.8408384919166565, corresponding to test acc:                         0.7906976938247681 / 0.8534883856773376
after epoch: 13,now: 2024-07-27 01:58:01.657089,epoch time: 0:02:53.212257,used: 0:37:35.795185,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_01_20_24_seed_0_23090487
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9869792, 'precision': 0.98699945, 'recall': 0.98707867, 'specificity': 0.98707867, 'f1': 0.9869789, 'auroc': 0.99907494, 'binary_precision': 0.9947781, 'binary_recall': 0.97943443, 'binary_specificity': 0.99472296, 'binary_f1_score': 0.98704666}
confusion matrix:
      0     1
0  1508     8
1    32  1524
---- Validation: 
scalar performance:
{'acc': 0.82608694, 'precision': 0.82719624, 'recall': 0.82566226, 'specificity': 0.82566226, 'f1': 0.8257807, 'auroc': 0.903782, 'binary_precision': 0.84307176, 'binary_recall': 0.79527557, 'binary_specificity': 0.856049, 'binary_f1_score': 0.81847644}
confusion matrix:
     0    1
0  559   94
1  130  505
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.80465114, 'precision': 0.8084953, 'recall': 0.80465114, 'specificity': 0.80465114, 'f1': 0.8040407, 'auroc': 0.8637967, 'binary_precision': 0.8429319, 'binary_recall': 0.74883723, 'binary_specificity': 0.8604651, 'binary_f1_score': 0.7931034}
confusion matrix:
     0    1
0  185   30
1   54  161
early stop counter: 3
val acc:0.8260869383811951, best validation acc: 0.8408384919166565, corresponding to test acc:                         0.7906976938247681 / 0.8534883856773376
after epoch: 14,now: 2024-07-27 02:00:53.427402,epoch time: 0:02:51.770313,used: 0:40:27.565498,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_01_20_24_seed_0_23090487
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.97721356, 'precision': 0.9778837, 'recall': 0.97749794, 'specificity': 0.97749794, 'f1': 0.9772116, 'auroc': 0.9983225, 'binary_precision': 0.99932796, 'binary_recall': 0.9556555, 'binary_specificity': 0.99934036, 'binary_f1_score': 0.97700393}
confusion matrix:
      0     1
0  1515     1
1    69  1487
---- Validation: 
scalar performance:
{'acc': 0.67624223, 'precision': 0.78701586, 'recall': 0.6718489, 'specificity': 0.6718489, 'f1': 0.6383326, 'auroc': 0.93049645, 'binary_precision': 0.9618644, 'binary_recall': 0.35748032, 'binary_specificity': 0.98621744, 'binary_f1_score': 0.52123994}
confusion matrix:
     0    1
0  644    9
1  408  227
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.51860464, 'precision': 0.75473934, 'recall': 0.51860464, 'specificity': 0.51860464, 'f1': 0.37339407, 'auroc': 0.9253975, 'binary_precision': 1.0, 'binary_recall': 0.037209302, 'binary_specificity': 1.0, 'binary_f1_score': 0.07174888}
confusion matrix:
     0  1
0  215  0
1  207  8
early stop counter: 4
val acc:0.6762422323226929, best validation acc: 0.8408384919166565, corresponding to test acc:                         0.7906976938247681 / 0.8534883856773376
after epoch: 15,now: 2024-07-27 02:03:45.700401,epoch time: 0:02:52.272999,used: 0:43:19.838497,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_01_20_24_seed_0_23090487
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.96028644, 'precision': 0.9629399, 'recall': 0.9598454, 'specificity': 0.9598454, 'f1': 0.9601966, 'auroc': 0.9971982, 'binary_precision': 0.9308479, 'binary_recall': 0.9954984, 'binary_specificity': 0.9241925, 'binary_f1_score': 0.9620883}
confusion matrix:
      0     1
0  1402   115
1     7  1548
---- Validation: 
scalar performance:
{'acc': 0.7546584, 'precision': 0.7643352, 'recall': 0.7559562, 'specificity': 0.7559562, 'f1': 0.75298536, 'auroc': 0.81294096, 'binary_precision': 0.71014494, 'binary_recall': 0.8488189, 'binary_specificity': 0.6630934, 'binary_f1_score': 0.77331424}
confusion matrix:
     0    1
0  433  220
1   96  539
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7837209, 'precision': 0.79671943, 'recall': 0.7837209, 'specificity': 0.7837209, 'f1': 0.78132606, 'auroc': 0.8713467, 'binary_precision': 0.7346154, 'binary_recall': 0.88837206, 'binary_specificity': 0.67906976, 'binary_f1_score': 0.8042105}
confusion matrix:
     0    1
0  146   69
1   24  191
early stop counter: 5
val acc:0.7546584010124207, best validation acc: 0.8408384919166565, corresponding to test acc:                         0.7906976938247681 / 0.8534883856773376
after epoch: 16,now: 2024-07-27 02:06:39.412963,epoch time: 0:02:53.712562,used: 0:46:13.551059,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_01_20_24_seed_0_23090487
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 16 with time: 0:46:13.551059 at 2024-07-27 02:06:39.412963
persisted model performance metric: 

scalar performance:
{'acc': 0.7906977, 'precision': 0.83741367, 'recall': 0.7906977, 'specificity': 0.7906977, 'f1': 0.78319323, 'auroc': 0.9425851, 'binary_precision': 0.962963, 'binary_recall': 0.60465115, 'binary_specificity': 0.9767442, 'binary_f1_score': 0.74285716}
confusion matrix:
     0    1
0  210    5
1   85  130
oracle model performance metric: 

scalar performance:
{'acc': 0.8534884, 'precision': 0.86968327, 'recall': 0.8534884, 'specificity': 0.8534884, 'f1': 0.851866, 'auroc': 0.9237858, 'binary_precision': 0.9470588, 'binary_recall': 0.74883723, 'binary_specificity': 0.95813954, 'binary_f1_score': 0.8363636}
confusion matrix:
     0    1
0  206    9
1   54  161
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_diva_irm_3seeds_nofreeze_2024-07-27_01-18-02/rule_results/6.csv
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_diva_irm_3seeds_nofreeze_2024-07-27_01-18-02/rule_results/6.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_diva_irm_3seeds_nofreeze_2024-07-27_01-18-02/confusion_matrix/6.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   2389 MiB |   8908 MiB | 106796 GiB | 106794 GiB |
|       from large pool |   2297 MiB |   8832 MiB | 105863 GiB | 105861 GiB |
|       from small pool |     91 MiB |    129 MiB |    933 GiB |    933 GiB |
|---------------------------------------------------------------------------|
| Active memory         |   2389 MiB |   8908 MiB | 106796 GiB | 106794 GiB |
|       from large pool |   2297 MiB |   8832 MiB | 105863 GiB | 105861 GiB |
|       from small pool |     91 MiB |    129 MiB |    933 GiB |    933 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |   2375 MiB |   8902 MiB | 106678 GiB | 106676 GiB |
|       from large pool |   2284 MiB |   8826 MiB | 105746 GiB | 105744 GiB |
|       from small pool |     91 MiB |    128 MiB |    931 GiB |    931 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   9714 MiB |   9714 MiB |   9714 MiB |      0 B   |
|       from large pool |   9578 MiB |   9578 MiB |   9578 MiB |      0 B   |
|       from small pool |    136 MiB |    136 MiB |    136 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |    902 MiB |   1985 MiB |  83066 GiB |  83066 GiB |
|       from large pool |    890 MiB |   1979 MiB |  82102 GiB |  82101 GiB |
|       from small pool |     12 MiB |     22 MiB |    964 GiB |    964 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    2464    |    3317    |   15175 K  |   15172 K  |
|       from large pool |     392    |     816    |    7628 K  |    7628 K  |
|       from small pool |    2072    |    2768    |    7546 K  |    7544 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    2464    |    3317    |   15175 K  |   15172 K  |
|       from large pool |     392    |     816    |    7628 K  |    7628 K  |
|       from small pool |    2072    |    2768    |    7546 K  |    7544 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     269    |     269    |     269    |       0    |
|       from large pool |     201    |     201    |     201    |       0    |
|       from small pool |      68    |      68    |      68    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     146    |     305    |    8121 K  |    8121 K  |
|       from large pool |      80    |     196    |    4278 K  |    4278 K  |
|       from small pool |      66    |     225    |    3843 K  |    3843 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   8908 MiB | 106796 GiB | 106796 GiB |
|       from large pool |  16640 KiB |   8832 MiB | 105863 GiB | 105863 GiB |
|       from small pool |      0 KiB |    129 MiB |    933 GiB |    933 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   8908 MiB | 106796 GiB | 106796 GiB |
|       from large pool |  16640 KiB |   8832 MiB | 105863 GiB | 105863 GiB |
|       from small pool |      0 KiB |    129 MiB |    933 GiB |    933 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   8902 MiB | 106678 GiB | 106678 GiB |
|       from large pool |  16640 KiB |   8826 MiB | 105746 GiB | 105746 GiB |
|       from small pool |      0 KiB |    128 MiB |    931 GiB |    931 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   3292 MiB |   9714 MiB |   9714 MiB |   6422 MiB |
|       from large pool |   3188 MiB |   9578 MiB |   9578 MiB |   6390 MiB |
|       from small pool |    104 MiB |    136 MiB |    136 MiB |     32 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1985 MiB |  83067 GiB |  83067 GiB |
|       from large pool |  24320 KiB |   1979 MiB |  82103 GiB |  82103 GiB |
|       from small pool |      0 KiB |     52 MiB |    964 GiB |    964 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3317    |   15175 K  |   15175 K  |
|       from large pool |       2    |     816    |    7628 K  |    7628 K  |
|       from small pool |       0    |    2768    |    7546 K  |    7546 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3317    |   15175 K  |   15175 K  |
|       from large pool |       2    |     816    |    7628 K  |    7628 K  |
|       from small pool |       0    |    2768    |    7546 K  |    7546 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     134    |     269    |     269    |     135    |
|       from large pool |      82    |     201    |     201    |     119    |
|       from small pool |      52    |      68    |      68    |      16    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     305    |    8122 K  |    8122 K  |
|       from large pool |       3    |     196    |    4278 K  |    4278 K  |
|       from small pool |       0    |     225    |    3843 K  |    3843 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   8908 MiB | 106796 GiB | 106796 GiB |
|       from large pool |  16640 KiB |   8832 MiB | 105863 GiB | 105863 GiB |
|       from small pool |      0 KiB |    129 MiB |    933 GiB |    933 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   8908 MiB | 106796 GiB | 106796 GiB |
|       from large pool |  16640 KiB |   8832 MiB | 105863 GiB | 105863 GiB |
|       from small pool |      0 KiB |    129 MiB |    933 GiB |    933 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   8902 MiB | 106678 GiB | 106678 GiB |
|       from large pool |  16640 KiB |   8826 MiB | 105746 GiB | 105746 GiB |
|       from small pool |      0 KiB |    128 MiB |    931 GiB |    931 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   3292 MiB |   9714 MiB |   9714 MiB |   6422 MiB |
|       from large pool |   3188 MiB |   9578 MiB |   9578 MiB |   6390 MiB |
|       from small pool |    104 MiB |    136 MiB |    136 MiB |     32 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1985 MiB |  83067 GiB |  83067 GiB |
|       from large pool |  24320 KiB |   1979 MiB |  82103 GiB |  82103 GiB |
|       from small pool |      0 KiB |     52 MiB |    964 GiB |    964 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3317    |   15175 K  |   15175 K  |
|       from large pool |       2    |     816    |    7628 K  |    7628 K  |
|       from small pool |       0    |    2768    |    7546 K  |    7546 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3317    |   15175 K  |   15175 K  |
|       from large pool |       2    |     816    |    7628 K  |    7628 K  |
|       from small pool |       0    |    2768    |    7546 K  |    7546 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     134    |     269    |     269    |     135    |
|       from large pool |      82    |     201    |     201    |     119    |
|       from small pool |      52    |      68    |      68    |      16    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     305    |    8122 K  |    8122 K  |
|       from large pool |       3    |     196    |    4278 K  |    4278 K  |
|       from small pool |       0    |     225    |    3843 K  |    3843 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main

using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_02_07_15_seed_1_23090487

 Experiment start at: 2024-07-27 02:07:16.632800
hyper-parameter scheduler not set,going to use default Warmpup and epoch update
before training, model accuracy: 0.6533333659172058
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9667969, 'precision': 0.96684, 'recall': 0.9668915, 'specificity': 0.9668915, 'f1': 0.9667965, 'auroc': 0.995721, 'binary_precision': 0.9751309, 'binary_recall': 0.95881593, 'binary_specificity': 0.97496706, 'binary_f1_score': 0.9669046}
confusion matrix:
      0     1
0  1480    38
1    64  1490
---- Validation: 
scalar performance:
{'acc': 0.7907885, 'precision': 0.81059176, 'recall': 0.79283154, 'specificity': 0.79283154, 'f1': 0.7881484, 'auroc': 0.9009924, 'binary_precision': 0.7279597, 'binary_recall': 0.9174603, 'binary_specificity': 0.66820276, 'binary_f1_score': 0.81179774}
confusion matrix:
     0    1
0  435  216
1   52  578
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.73777777, 'precision': 0.7855127, 'recall': 0.7377778, 'specificity': 0.7377778, 'f1': 0.72633946, 'auroc': 0.90735805, 'binary_precision': 0.6687697, 'binary_recall': 0.94222224, 'binary_specificity': 0.53333336, 'binary_f1_score': 0.78228784}
confusion matrix:
     0    1
0  120  105
1   13  212
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-27 02:10:14.895020,epoch time: 0:02:58.262220,used: 0:02:58.262220,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_02_07_15_seed_1_23090487
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.96516925, 'precision': 0.96515155, 'recall': 0.9651841, 'specificity': 0.9651841, 'f1': 0.9651652, 'auroc': 0.9942292, 'binary_precision': 0.96709675, 'binary_recall': 0.9639871, 'binary_specificity': 0.966381, 'binary_f1_score': 0.9655394}
confusion matrix:
      0     1
0  1466    51
1    56  1499
---- Validation: 
scalar performance:
{'acc': 0.8376269, 'precision': 0.83776915, 'recall': 0.8378136, 'specificity': 0.8378136, 'f1': 0.8376259, 'auroc': 0.90309656, 'binary_precision': 0.8256173, 'binary_recall': 0.8492063, 'binary_specificity': 0.8264209, 'binary_f1_score': 0.83724564}
confusion matrix:
     0    1
0  538  113
1   95  535
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8155556, 'precision': 0.8233806, 'recall': 0.8155556, 'specificity': 0.8155556, 'f1': 0.814433, 'auroc': 0.9109136, 'binary_precision': 0.77307695, 'binary_recall': 0.8933333, 'binary_specificity': 0.73777777, 'binary_f1_score': 0.82886606}
confusion matrix:
     0    1
0  166   59
1   24  201
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-07-27 02:13:10.319543,epoch time: 0:02:55.424523,used: 0:05:53.686743,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_02_07_15_seed_1_23090487
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9785156, 'precision': 0.9784975, 'recall': 0.9785713, 'specificity': 0.9785713, 'f1': 0.97851413, 'auroc': 0.9982865, 'binary_precision': 0.9831388, 'binary_recall': 0.97429305, 'binary_specificity': 0.9828496, 'binary_f1_score': 0.978696}
confusion matrix:
      0     1
0  1490    26
1    40  1516
---- Validation: 
scalar performance:
{'acc': 0.8501171, 'precision': 0.8521341, 'recall': 0.84948796, 'specificity': 0.84948796, 'f1': 0.84970593, 'auroc': 0.91433513, 'binary_precision': 0.875, 'binary_recall': 0.8111111, 'binary_specificity': 0.8878648, 'binary_f1_score': 0.84184515}
confusion matrix:
     0    1
0  578   73
1  119  511
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8488889, 'precision': 0.8498841, 'recall': 0.8488889, 'specificity': 0.8488889, 'f1': 0.84878135, 'auroc': 0.91654325, 'binary_precision': 0.8685446, 'binary_recall': 0.82222223, 'binary_specificity': 0.8755556, 'binary_f1_score': 0.84474885}
confusion matrix:
     0    1
0  197   28
1   40  185
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-07-27 02:16:04.409838,epoch time: 0:02:54.090295,used: 0:08:47.777038,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_02_07_15_seed_1_23090487
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9781901, 'precision': 0.9788548, 'recall': 0.97798944, 'specificity': 0.97798944, 'f1': 0.97817266, 'auroc': 0.99885416, 'binary_precision': 0.9638404, 'binary_recall': 0.9942122, 'binary_specificity': 0.96176666, 'binary_f1_score': 0.97879076}
confusion matrix:
      0     1
0  1459    58
1     9  1546
---- Validation: 
scalar performance:
{'acc': 0.8110851, 'precision': 0.81238073, 'recall': 0.81052226, 'specificity': 0.81052226, 'f1': 0.8106557, 'auroc': 0.87629044, 'binary_precision': 0.82881355, 'binary_recall': 0.77619046, 'binary_specificity': 0.84485406, 'binary_f1_score': 0.8016393}
confusion matrix:
     0    1
0  550  101
1  141  489
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.82222223, 'precision': 0.82385993, 'recall': 0.82222223, 'specificity': 0.82222223, 'f1': 0.82199717, 'auroc': 0.89641476, 'binary_precision': 0.8008299, 'binary_recall': 0.8577778, 'binary_specificity': 0.7866667, 'binary_f1_score': 0.8283261}
confusion matrix:
     0    1
0  177   48
1   32  193
early stop counter: 1
val acc:0.8110851049423218, best validation acc: 0.8501170873641968, corresponding to test acc:                         0.8488888740539551 / 0.8488888740539551
after epoch: 4,now: 2024-07-27 02:19:01.333802,epoch time: 0:02:56.923964,used: 0:11:44.701002,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_02_07_15_seed_1_23090487
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.97558594, 'precision': 0.97558606, 'recall': 0.9755782, 'specificity': 0.9755782, 'f1': 0.975582, 'auroc': 0.9970902, 'binary_precision': 0.9755784, 'binary_recall': 0.97620577, 'binary_specificity': 0.97495055, 'binary_f1_score': 0.975892}
confusion matrix:
      0     1
0  1479    38
1    37  1518
---- Validation: 
scalar performance:
{'acc': 0.83138174, 'precision': 0.83219165, 'recall': 0.8309524, 'specificity': 0.8309524, 'f1': 0.83111405, 'auroc': 0.89394826, 'binary_precision': 0.845, 'binary_recall': 0.8047619, 'binary_specificity': 0.85714287, 'binary_f1_score': 0.82439023}
confusion matrix:
     0    1
0  558   93
1  123  507
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8088889, 'precision': 0.8095002, 'recall': 0.8088889, 'specificity': 0.8088889, 'f1': 0.80879444, 'auroc': 0.89827156, 'binary_precision': 0.79574466, 'binary_recall': 0.83111113, 'binary_specificity': 0.7866667, 'binary_f1_score': 0.8130434}
confusion matrix:
     0    1
0  177   48
1   38  187
early stop counter: 2
val acc:0.8313817381858826, best validation acc: 0.8501170873641968, corresponding to test acc:                         0.8488888740539551 / 0.8488888740539551
after epoch: 5,now: 2024-07-27 02:21:55.512979,epoch time: 0:02:54.179177,used: 0:14:38.880179,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_02_07_15_seed_1_23090487
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.98795575, 'precision': 0.9879517, 'recall': 0.98803425, 'specificity': 0.98803425, 'f1': 0.9879552, 'auroc': 0.9987769, 'binary_precision': 0.99414444, 'binary_recall': 0.9820051, 'binary_specificity': 0.9940633, 'binary_f1_score': 0.9880375}
confusion matrix:
      0     1
0  1507     9
1    28  1528
---- Validation: 
scalar performance:
{'acc': 0.8321624, 'precision': 0.8503186, 'recall': 0.83028674, 'specificity': 0.83028674, 'f1': 0.8293656, 'auroc': 0.91473615, 'binary_precision': 0.926078, 'binary_recall': 0.715873, 'binary_specificity': 0.9447005, 'binary_f1_score': 0.80752015}
confusion matrix:
     0    1
0  615   36
1  179  451
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8422222, 'precision': 0.8507085, 'recall': 0.8422222, 'specificity': 0.8422222, 'f1': 0.841262, 'auroc': 0.9130666, 'binary_precision': 0.9052632, 'binary_recall': 0.7644445, 'binary_specificity': 0.92, 'binary_f1_score': 0.8289157}
confusion matrix:
     0    1
0  207   18
1   53  172
early stop counter: 3
val acc:0.8321623802185059, best validation acc: 0.8501170873641968, corresponding to test acc:                         0.8488888740539551 / 0.8488888740539551
after epoch: 6,now: 2024-07-27 02:24:47.773511,epoch time: 0:02:52.260532,used: 0:17:31.140711,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_02_07_15_seed_1_23090487
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9563802, 'precision': 0.95856977, 'recall': 0.9559789, 'specificity': 0.9559789, 'f1': 0.95629454, 'auroc': 0.9963386, 'binary_precision': 0.9298246, 'binary_recall': 0.9884244, 'binary_specificity': 0.92353326, 'binary_f1_score': 0.9582294}
confusion matrix:
      0     1
0  1401   116
1    18  1537
---- Validation: 
scalar performance:
{'acc': 0.86416864, 'precision': 0.86416245, 'recall': 0.8642601, 'specificity': 0.8642601, 'f1': 0.8641586, 'auroc': 0.91943526, 'binary_precision': 0.85625, 'binary_recall': 0.8698413, 'binary_specificity': 0.85867894, 'binary_f1_score': 0.8629921}
confusion matrix:
     0    1
0  559   92
1   82  548
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.87333333, 'precision': 0.88154066, 'recall': 0.87333333, 'specificity': 0.87333333, 'f1': 0.8726485, 'auroc': 0.9459555, 'binary_precision': 0.9375, 'binary_recall': 0.8, 'binary_specificity': 0.94666666, 'binary_f1_score': 0.8633094}
confusion matrix:
     0    1
0  213   12
1   45  180
new oracle model saved
better model found
persisted
after epoch: 7,now: 2024-07-27 02:27:42.462364,epoch time: 0:02:54.688853,used: 0:20:25.829564,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_02_07_15_seed_1_23090487
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9781901, 'precision': 0.97876585, 'recall': 0.9784888, 'specificity': 0.9784888, 'f1': 0.9781891, 'auroc': 0.9990295, 'binary_precision': 0.9993302, 'binary_recall': 0.957638, 'binary_specificity': 0.9993395, 'binary_f1_score': 0.97804}
confusion matrix:
      0     1
0  1513     1
1    66  1492
---- Validation: 
scalar performance:
{'acc': 0.6869633, 'precision': 0.7675724, 'recall': 0.6823861, 'specificity': 0.6823861, 'f1': 0.6581333, 'auroc': 0.89795375, 'binary_precision': 0.91039425, 'binary_recall': 0.4031746, 'binary_specificity': 0.96159756, 'binary_f1_score': 0.5588559}
confusion matrix:
     0    1
0  626   25
1  376  254
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.74666667, 'precision': 0.81368536, 'recall': 0.74666667, 'specificity': 0.74666667, 'f1': 0.73237205, 'auroc': 0.880958, 'binary_precision': 0.9586777, 'binary_recall': 0.51555556, 'binary_specificity': 0.9777778, 'binary_f1_score': 0.67052025}
confusion matrix:
     0    1
0  220    5
1  109  116
early stop counter: 1
val acc:0.6869633197784424, best validation acc: 0.864168643951416, corresponding to test acc:                         0.8733333349227905 / 0.8733333349227905
after epoch: 8,now: 2024-07-27 02:30:40.510828,epoch time: 0:02:58.048464,used: 0:23:23.878028,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_02_07_15_seed_1_23090487
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9863281, 'precision': 0.9864137, 'recall': 0.9864839, 'specificity': 0.9864839, 'f1': 0.986328, 'auroc': 0.99961126, 'binary_precision': 0.9973753, 'binary_recall': 0.9756098, 'binary_specificity': 0.99735796, 'binary_f1_score': 0.98637253}
confusion matrix:
      0     1
0  1510     4
1    38  1520
---- Validation: 
scalar performance:
{'acc': 0.7369243, 'precision': 0.7961863, 'recall': 0.7332053, 'specificity': 0.7332053, 'f1': 0.72100437, 'auroc': 0.91247106, 'binary_precision': 0.9246377, 'binary_recall': 0.5063492, 'binary_specificity': 0.96006143, 'binary_f1_score': 0.654359}
confusion matrix:
     0    1
0  625   26
1  311  319
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6755555, 'precision': 0.7917665, 'recall': 0.6755556, 'specificity': 0.6755556, 'f1': 0.6396762, 'auroc': 0.91863704, 'binary_precision': 0.97590363, 'binary_recall': 0.36, 'binary_specificity': 0.9911111, 'binary_f1_score': 0.52597404}
confusion matrix:
     0   1
0  223   2
1  144  81
early stop counter: 2
val acc:0.7369242906570435, best validation acc: 0.864168643951416, corresponding to test acc:                         0.8733333349227905 / 0.8733333349227905
after epoch: 9,now: 2024-07-27 02:33:33.985592,epoch time: 0:02:53.474764,used: 0:26:17.352792,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_02_07_15_seed_1_23090487
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9847005, 'precision': 0.984804, 'recall': 0.9848243, 'specificity': 0.9848243, 'f1': 0.9847005, 'auroc': 0.99919367, 'binary_precision': 0.99539775, 'binary_recall': 0.97426, 'binary_specificity': 0.9953887, 'binary_f1_score': 0.98471546}
confusion matrix:
      0     1
0  1511     7
1    40  1514
---- Validation: 
scalar performance:
{'acc': 0.715847, 'precision': 0.7961452, 'recall': 0.71152073, 'specificity': 0.71152073, 'f1': 0.6924962, 'auroc': 0.91378593, 'binary_precision': 0.94630873, 'binary_recall': 0.44761905, 'binary_specificity': 0.97542244, 'binary_f1_score': 0.6077586}
confusion matrix:
     0    1
0  635   16
1  348  282
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6244444, 'precision': 0.77709365, 'recall': 0.6244445, 'specificity': 0.6244445, 'f1': 0.5644604, 'auroc': 0.91190124, 'binary_precision': 0.98275864, 'binary_recall': 0.25333333, 'binary_specificity': 0.9955556, 'binary_f1_score': 0.40282685}
confusion matrix:
     0   1
0  224   1
1  168  57
early stop counter: 3
val acc:0.7158470153808594, best validation acc: 0.864168643951416, corresponding to test acc:                         0.8733333349227905 / 0.8733333349227905
after epoch: 10,now: 2024-07-27 02:36:28.313466,epoch time: 0:02:54.327874,used: 0:29:11.680666,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_02_07_15_seed_1_23090487
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9788411, 'precision': 0.97881943, 'recall': 0.9788842, 'specificity': 0.9788842, 'f1': 0.9788393, 'auroc': 0.9977549, 'binary_precision': 0.9825243, 'binary_recall': 0.9755784, 'binary_specificity': 0.98218995, 'binary_f1_score': 0.979039}
confusion matrix:
      0     1
0  1489    27
1    38  1518
---- Validation: 
scalar performance:
{'acc': 0.84231067, 'precision': 0.8496326, 'recall': 0.84111625, 'specificity': 0.84111625, 'f1': 0.84111774, 'auroc': 0.91792905, 'binary_precision': 0.8962963, 'binary_recall': 0.768254, 'binary_specificity': 0.9139785, 'binary_f1_score': 0.82735044}
confusion matrix:
     0    1
0  595   56
1  146  484
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.76222223, 'precision': 0.82208365, 'recall': 0.76222223, 'specificity': 0.76222223, 'f1': 0.75063574, 'auroc': 0.9008, 'binary_precision': 0.9609375, 'binary_recall': 0.5466667, 'binary_specificity': 0.9777778, 'binary_f1_score': 0.6968839}
confusion matrix:
     0    1
0  220    5
1  102  123
early stop counter: 4
val acc:0.8423106670379639, best validation acc: 0.864168643951416, corresponding to test acc:                         0.8733333349227905 / 0.8733333349227905
after epoch: 11,now: 2024-07-27 02:39:20.940042,epoch time: 0:02:52.626576,used: 0:32:04.307242,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_02_07_15_seed_1_23090487
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9840495, 'precision': 0.98433506, 'recall': 0.9842646, 'specificity': 0.9842646, 'f1': 0.98404944, 'auroc': 0.9997386, 'binary_precision': 1.0, 'binary_recall': 0.9685292, 'binary_specificity': 1.0, 'binary_f1_score': 0.9840131}
confusion matrix:
      0     1
0  1515     0
1    49  1508
---- Validation: 
scalar performance:
{'acc': 0.5870414, 'precision': 0.7495643, 'recall': 0.5803123, 'specificity': 0.5803123, 'f1': 0.4986012, 'auroc': 0.90598834, 'binary_precision': 0.94690263, 'binary_recall': 0.16984127, 'binary_specificity': 0.9907834, 'binary_f1_score': 0.28802153}
confusion matrix:
     0    1
0  645    6
1  523  107
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.53333336, 'precision': 0.7060691, 'recall': 0.5333333, 'specificity': 0.5333333, 'f1': 0.40961114, 'auroc': 0.91038024, 'binary_precision': 0.8947368, 'binary_recall': 0.075555556, 'binary_specificity': 0.9911111, 'binary_f1_score': 0.13934426}
confusion matrix:
     0   1
0  223   2
1  208  17
early stop counter: 5
val acc:0.5870413780212402, best validation acc: 0.864168643951416, corresponding to test acc:                         0.8733333349227905 / 0.8733333349227905
after epoch: 12,now: 2024-07-27 02:42:16.170712,epoch time: 0:02:55.230670,used: 0:34:59.537912,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_02_07_15_seed_1_23090487
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 12 with time: 0:34:59.537912 at 2024-07-27 02:42:16.170712
persisted model performance metric: 

scalar performance:
{'acc': 0.87333333, 'precision': 0.88154066, 'recall': 0.87333333, 'specificity': 0.87333333, 'f1': 0.8726485, 'auroc': 0.9459555, 'binary_precision': 0.9375, 'binary_recall': 0.8, 'binary_specificity': 0.94666666, 'binary_f1_score': 0.8633094}
confusion matrix:
     0    1
0  213   12
1   45  180
oracle model performance metric: 

scalar performance:
{'acc': 0.87333333, 'precision': 0.88154066, 'recall': 0.87333333, 'specificity': 0.87333333, 'f1': 0.8726485, 'auroc': 0.9459555, 'binary_precision': 0.9375, 'binary_recall': 0.8, 'binary_specificity': 0.94666666, 'binary_f1_score': 0.8633094}
confusion matrix:
     0    1
0  213   12
1   45  180
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_diva_irm_3seeds_nofreeze_2024-07-27_01-18-02/rule_results/6.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_diva_irm_3seeds_nofreeze_2024-07-27_01-18-02/confusion_matrix/6.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   2391 MiB |   8913 MiB | 186978 GiB | 186976 GiB |
|       from large pool |   2299 MiB |   8837 MiB | 185340 GiB | 185337 GiB |
|       from small pool |     91 MiB |    132 MiB |   1638 GiB |   1638 GiB |
|---------------------------------------------------------------------------|
| Active memory         |   2391 MiB |   8913 MiB | 186978 GiB | 186976 GiB |
|       from large pool |   2299 MiB |   8837 MiB | 185340 GiB | 185337 GiB |
|       from small pool |     91 MiB |    132 MiB |   1638 GiB |   1638 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |   2375 MiB |   8902 MiB | 186774 GiB | 186771 GiB |
|       from large pool |   2284 MiB |   8826 MiB | 185138 GiB | 185135 GiB |
|       from small pool |     91 MiB |    132 MiB |   1636 GiB |   1635 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   9700 MiB |   9714 MiB |  16122 MiB |   6422 MiB |
|       from large pool |   9560 MiB |   9578 MiB |  15950 MiB |   6390 MiB |
|       from small pool |    140 MiB |    140 MiB |    172 MiB |     32 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |   1504 MiB |   2525 MiB | 153004 GiB | 153002 GiB |
|       from large pool |   1494 MiB |   2519 MiB | 151314 GiB | 151312 GiB |
|       from small pool |     10 MiB |     52 MiB |   1690 GiB |   1690 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    2476    |    3329    |   26590 K  |   26587 K  |
|       from large pool |     392    |     816    |   13357 K  |   13356 K  |
|       from small pool |    2084    |    2780    |   13232 K  |   13230 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    2476    |    3329    |   26590 K  |   26587 K  |
|       from large pool |     392    |     816    |   13357 K  |   13356 K  |
|       from small pool |    2084    |    2780    |   13232 K  |   13230 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     253    |     269    |     388    |     135    |
|       from large pool |     183    |     201    |     302    |     119    |
|       from small pool |      70    |      70    |      86    |      16    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     140    |     305    |   14072 K  |   14072 K  |
|       from large pool |      72    |     196    |    7281 K  |    7281 K  |
|       from small pool |      68    |     226    |    6791 K  |    6791 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   8913 MiB | 186978 GiB | 186978 GiB |
|       from large pool |  16640 KiB |   8837 MiB | 185340 GiB | 185340 GiB |
|       from small pool |      0 KiB |    132 MiB |   1638 GiB |   1638 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   8913 MiB | 186978 GiB | 186978 GiB |
|       from large pool |  16640 KiB |   8837 MiB | 185340 GiB | 185340 GiB |
|       from small pool |      0 KiB |    132 MiB |   1638 GiB |   1638 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   8902 MiB | 186774 GiB | 186774 GiB |
|       from large pool |  16640 KiB |   8826 MiB | 185138 GiB | 185138 GiB |
|       from small pool |      0 KiB |    132 MiB |   1636 GiB |   1636 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   3896 MiB |   9714 MiB |  16122 MiB |  12226 MiB |
|       from large pool |   3794 MiB |   9578 MiB |  15950 MiB |  12156 MiB |
|       from small pool |    102 MiB |    140 MiB |    172 MiB |     70 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   2525 MiB | 153005 GiB | 153005 GiB |
|       from large pool |  24320 KiB |   2519 MiB | 151314 GiB | 151314 GiB |
|       from small pool |      0 KiB |     60 MiB |   1690 GiB |   1690 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3329    |   26590 K  |   26590 K  |
|       from large pool |       2    |     816    |   13357 K  |   13357 K  |
|       from small pool |       0    |    2780    |   13232 K  |   13232 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3329    |   26590 K  |   26590 K  |
|       from large pool |       2    |     816    |   13357 K  |   13357 K  |
|       from small pool |       0    |    2780    |   13232 K  |   13232 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     131    |     269    |     388    |     257    |
|       from large pool |      80    |     201    |     302    |     222    |
|       from small pool |      51    |      70    |      86    |      35    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     305    |   14072 K  |   14072 K  |
|       from large pool |       3    |     196    |    7281 K  |    7281 K  |
|       from small pool |       0    |     226    |    6791 K  |    6791 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   8913 MiB | 186978 GiB | 186978 GiB |
|       from large pool |  16640 KiB |   8837 MiB | 185340 GiB | 185340 GiB |
|       from small pool |      0 KiB |    132 MiB |   1638 GiB |   1638 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   8913 MiB | 186978 GiB | 186978 GiB |
|       from large pool |  16640 KiB |   8837 MiB | 185340 GiB | 185340 GiB |
|       from small pool |      0 KiB |    132 MiB |   1638 GiB |   1638 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   8902 MiB | 186774 GiB | 186774 GiB |
|       from large pool |  16640 KiB |   8826 MiB | 185138 GiB | 185138 GiB |
|       from small pool |      0 KiB |    132 MiB |   1636 GiB |   1636 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   3896 MiB |   9714 MiB |  16122 MiB |  12226 MiB |
|       from large pool |   3794 MiB |   9578 MiB |  15950 MiB |  12156 MiB |
|       from small pool |    102 MiB |    140 MiB |    172 MiB |     70 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   2525 MiB | 153005 GiB | 153005 GiB |
|       from large pool |  24320 KiB |   2519 MiB | 151314 GiB | 151314 GiB |
|       from small pool |      0 KiB |     60 MiB |   1690 GiB |   1690 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3329    |   26590 K  |   26590 K  |
|       from large pool |       2    |     816    |   13357 K  |   13357 K  |
|       from small pool |       0    |    2780    |   13232 K  |   13232 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3329    |   26590 K  |   26590 K  |
|       from large pool |       2    |     816    |   13357 K  |   13357 K  |
|       from small pool |       0    |    2780    |   13232 K  |   13232 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     131    |     269    |     388    |     257    |
|       from large pool |      80    |     201    |     302    |     222    |
|       from small pool |      51    |      70    |      86    |      35    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     305    |   14072 K  |   14072 K  |
|       from large pool |       3    |     196    |    7281 K  |    7281 K  |
|       from small pool |       0    |     226    |    6791 K  |    6791 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main

using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_02_42_51_seed_2_23090487

 Experiment start at: 2024-07-27 02:42:52.349469
hyper-parameter scheduler not set,going to use default Warmpup and epoch update
before training, model accuracy: 0.5995370149612427
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9414267, 'precision': 0.9443325, 'recall': 0.9417546, 'specificity': 0.9417546, 'f1': 0.9413575, 'auroc': 0.98918676, 'binary_precision': 0.98228204, 'binary_recall': 0.9, 'binary_specificity': 0.98350924, 'binary_f1_score': 0.93934256}
confusion matrix:
      0     1
0  1491    25
1   154  1386
---- Validation: 
scalar performance:
{'acc': 0.7824726, 'precision': 0.82517457, 'recall': 0.77756894, 'specificity': 0.77756894, 'f1': 0.77292925, 'auroc': 0.8953415, 'binary_precision': 0.93654823, 'binary_recall': 0.5932476, 'binary_specificity': 0.9618902, 'binary_f1_score': 0.72637796}
confusion matrix:
     0    1
0  631   25
1  253  369
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7476852, 'precision': 0.8323077, 'recall': 0.7476852, 'specificity': 0.7476852, 'f1': 0.73052996, 'auroc': 0.8961977, 'binary_precision': 1.0, 'binary_recall': 0.49537036, 'binary_specificity': 1.0, 'binary_f1_score': 0.66253865}
confusion matrix:
     0    1
0  216    0
1  109  107
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-27 02:45:48.601964,epoch time: 0:02:56.252495,used: 0:02:56.252495,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_02_42_51_seed_2_23090487
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9728403, 'precision': 0.97283655, 'recall': 0.97284126, 'specificity': 0.97284126, 'f1': 0.9728388, 'auroc': 0.9969644, 'binary_precision': 0.97335935, 'binary_recall': 0.9727273, 'binary_specificity': 0.97295517, 'binary_f1_score': 0.97304326}
confusion matrix:
      0     1
0  1475    41
1    42  1498
---- Validation: 
scalar performance:
{'acc': 0.6776213, 'precision': 0.77924204, 'recall': 0.6693936, 'specificity': 0.6693936, 'f1': 0.6390028, 'auroc': 0.8782326, 'binary_precision': 0.9411765, 'binary_recall': 0.3601286, 'binary_specificity': 0.97865856, 'binary_f1_score': 0.52093023}
confusion matrix:
     0    1
0  642   14
1  398  224
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7523148, 'precision': 0.83436537, 'recall': 0.7523148, 'specificity': 0.7523148, 'f1': 0.7361267, 'auroc': 0.93492806, 'binary_precision': 1.0, 'binary_recall': 0.5046296, 'binary_specificity': 1.0, 'binary_f1_score': 0.6707692}
confusion matrix:
     0    1
0  216    0
1  107  109
new oracle model saved
early stop counter: 1
val acc:0.6776213049888611, best validation acc: 0.7824726104736328, corresponding to test acc:                         0.7476851940155029 / 0.7523148059844971
after epoch: 2,now: 2024-07-27 02:48:44.517418,epoch time: 0:02:55.915454,used: 0:05:52.167949,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_02_42_51_seed_2_23090487
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.97022253, 'precision': 0.9704846, 'recall': 0.970141, 'specificity': 0.970141, 'f1': 0.9702128, 'auroc': 0.996444, 'binary_precision': 0.9611712, 'binary_recall': 0.9805195, 'binary_specificity': 0.9597625, 'binary_f1_score': 0.9707489}
confusion matrix:
      0     1
0  1455    61
1    30  1510
---- Validation: 
scalar performance:
{'acc': 0.7856025, 'precision': 0.79344815, 'recall': 0.7877005, 'specificity': 0.7877005, 'f1': 0.7848813, 'auroc': 0.86894166, 'binary_precision': 0.7383562, 'binary_recall': 0.8665595, 'binary_specificity': 0.70884144, 'binary_f1_score': 0.79733735}
confusion matrix:
     0    1
0  465  191
1   83  539
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8564815, 'precision': 0.8572472, 'recall': 0.85648143, 'specificity': 0.85648143, 'f1': 0.85640454, 'auroc': 0.91105103, 'binary_precision': 0.8737864, 'binary_recall': 0.8333333, 'binary_specificity': 0.8796296, 'binary_f1_score': 0.8530806}
confusion matrix:
     0    1
0  190   26
1   36  180
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-07-27 02:51:38.586457,epoch time: 0:02:54.069039,used: 0:08:46.236988,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_02_42_51_seed_2_23090487
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9810209, 'precision': 0.98104143, 'recall': 0.98100436, 'specificity': 0.98100436, 'f1': 0.98101914, 'auroc': 0.9977354, 'binary_precision': 0.97930145, 'binary_recall': 0.98311687, 'binary_specificity': 0.97889185, 'binary_f1_score': 0.98120546}
confusion matrix:
      0     1
0  1484    32
1    26  1514
---- Validation: 
scalar performance:
{'acc': 0.75508606, 'precision': 0.76819384, 'recall': 0.7519753, 'specificity': 0.7519753, 'f1': 0.7504061, 'auroc': 0.8386352, 'binary_precision': 0.8212058, 'binary_recall': 0.6350482, 'binary_specificity': 0.86890244, 'binary_f1_score': 0.7162285}
confusion matrix:
     0    1
0  570   86
1  227  395
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8333333, 'precision': 0.8334477, 'recall': 0.8333334, 'specificity': 0.8333334, 'f1': 0.833319, 'auroc': 0.91280866, 'binary_precision': 0.8396226, 'binary_recall': 0.8240741, 'binary_specificity': 0.8425926, 'binary_f1_score': 0.83177567}
confusion matrix:
     0    1
0  182   34
1   38  178
early stop counter: 1
val acc:0.7550860643386841, best validation acc: 0.7856025099754333, corresponding to test acc:                         0.8564814925193787 / 0.8564814925193787
after epoch: 4,now: 2024-07-27 02:54:33.127650,epoch time: 0:02:54.541193,used: 0:11:40.778181,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_02_42_51_seed_2_23090487
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.97971207, 'precision': 0.98030937, 'recall': 0.97986495, 'specificity': 0.97986495, 'f1': 0.97970927, 'auroc': 0.99866575, 'binary_precision': 0.9993243, 'binary_recall': 0.9603896, 'binary_specificity': 0.99934036, 'binary_f1_score': 0.9794702}
confusion matrix:
      0     1
0  1515     1
1    61  1479
---- Validation: 
scalar performance:
{'acc': 0.74726135, 'precision': 0.81256974, 'recall': 0.741062, 'specificity': 0.741062, 'f1': 0.73001564, 'auroc': 0.9140338, 'binary_precision': 0.9489489, 'binary_recall': 0.5080386, 'binary_specificity': 0.9740854, 'binary_f1_score': 0.6617801}
confusion matrix:
     0    1
0  639   17
1  306  316
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5787037, 'precision': 0.75757575, 'recall': 0.5787037, 'specificity': 0.5787037, 'f1': 0.4901961, 'auroc': 0.9078629, 'binary_precision': 0.9722222, 'binary_recall': 0.16203703, 'binary_specificity': 0.9953704, 'binary_f1_score': 0.27777776}
confusion matrix:
     0   1
0  215   1
1  181  35
early stop counter: 2
val acc:0.7472613453865051, best validation acc: 0.7856025099754333, corresponding to test acc:                         0.8564814925193787 / 0.8564814925193787
after epoch: 5,now: 2024-07-27 02:57:26.608832,epoch time: 0:02:53.481182,used: 0:14:34.259363,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_02_42_51_seed_2_23090487
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9649869, 'precision': 0.9669557, 'recall': 0.9652546, 'specificity': 0.9652546, 'f1': 0.96496236, 'auroc': 0.9991215, 'binary_precision': 0.99930316, 'binary_recall': 0.93116885, 'binary_specificity': 0.99934036, 'binary_f1_score': 0.96403366}
confusion matrix:
      0     1
0  1515     1
1   106  1434
---- Validation: 
scalar performance:
{'acc': 0.5586854, 'precision': 0.73867387, 'recall': 0.5467905, 'specificity': 0.5467905, 'f1': 0.43915266, 'auroc': 0.8848301, 'binary_precision': 0.93939394, 'binary_recall': 0.09967846, 'binary_specificity': 0.99390244, 'binary_f1_score': 0.18023255}
confusion matrix:
     0   1
0  652   4
1  560  62
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5115741, 'precision': 0.641844, 'recall': 0.5115741, 'specificity': 0.5115741, 'f1': 0.36600935, 'auroc': 0.892704, 'binary_precision': 0.7777778, 'binary_recall': 0.032407407, 'binary_specificity': 0.9907407, 'binary_f1_score': 0.06222222}
confusion matrix:
     0  1
0  214  2
1  209  7
early stop counter: 3
val acc:0.5586854219436646, best validation acc: 0.7856025099754333, corresponding to test acc:                         0.8564814925193787 / 0.8564814925193787
after epoch: 6,now: 2024-07-27 03:00:17.976850,epoch time: 0:02:51.368018,used: 0:17:25.627381,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_02_42_51_seed_2_23090487
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9764398, 'precision': 0.9771745, 'recall': 0.976608, 'specificity': 0.976608, 'f1': 0.97643536, 'auroc': 0.9985261, 'binary_precision': 0.99796474, 'binary_recall': 0.95519483, 'binary_specificity': 0.9980211, 'binary_f1_score': 0.97611153}
confusion matrix:
      0     1
0  1513     3
1    69  1471
---- Validation: 
scalar performance:
{'acc': 0.69248825, 'precision': 0.7887815, 'recall': 0.68462527, 'specificity': 0.68462527, 'f1': 0.65890676, 'auroc': 0.9053211, 'binary_precision': 0.9490196, 'binary_recall': 0.38906753, 'binary_specificity': 0.98018295, 'binary_f1_score': 0.55188143}
confusion matrix:
     0    1
0  643   13
1  380  242
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6018519, 'precision': 0.7783505, 'recall': 0.6018518, 'specificity': 0.6018518, 'f1': 0.52684665, 'auroc': 0.94429445, 'binary_precision': 1.0, 'binary_recall': 0.2037037, 'binary_specificity': 1.0, 'binary_f1_score': 0.33846155}
confusion matrix:
     0   1
0  216   0
1  172  44
early stop counter: 4
val acc:0.6924882531166077, best validation acc: 0.7856025099754333, corresponding to test acc:                         0.8564814925193787 / 0.8564814925193787
after epoch: 7,now: 2024-07-27 03:03:10.677431,epoch time: 0:02:52.700581,used: 0:20:18.327962,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_02_42_51_seed_2_23090487
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9856021, 'precision': 0.98580956, 'recall': 0.9856989, 'specificity': 0.9856989, 'f1': 0.9856018, 'auroc': 0.99954, 'binary_precision': 0.99800265, 'binary_recall': 0.97337663, 'binary_specificity': 0.9980211, 'binary_f1_score': 0.9855358}
confusion matrix:
      0     1
0  1513     3
1    41  1499
---- Validation: 
scalar performance:
{'acc': 0.69092333, 'precision': 0.8002485, 'recall': 0.68272585, 'specificity': 0.68272585, 'f1': 0.65409636, 'auroc': 0.90333354, 'binary_precision': 0.9748954, 'binary_recall': 0.37459806, 'binary_specificity': 0.99085367, 'binary_f1_score': 0.5412311}
confusion matrix:
     0    1
0  650    6
1  389  233
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5810185, 'precision': 0.7720403, 'recall': 0.5810185, 'specificity': 0.5810185, 'f1': 0.49180764, 'auroc': 0.9228395, 'binary_precision': 1.0, 'binary_recall': 0.16203703, 'binary_specificity': 1.0, 'binary_f1_score': 0.27888444}
confusion matrix:
     0   1
0  216   0
1  181  35
early stop counter: 5
val acc:0.6909233331680298, best validation acc: 0.7856025099754333, corresponding to test acc:                         0.8564814925193787 / 0.8564814925193787
after epoch: 8,now: 2024-07-27 03:06:02.980195,epoch time: 0:02:52.302764,used: 0:23:10.630726,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_02_42_51_seed_2_23090487
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 8 with time: 0:23:10.630726 at 2024-07-27 03:06:02.980195
persisted model performance metric: 

scalar performance:
{'acc': 0.8564815, 'precision': 0.8572472, 'recall': 0.85648143, 'specificity': 0.85648143, 'f1': 0.85640454, 'auroc': 0.91105103, 'binary_precision': 0.8737864, 'binary_recall': 0.8333333, 'binary_specificity': 0.8796296, 'binary_f1_score': 0.8530806}
confusion matrix:
     0    1
0  190   26
1   36  180
oracle model performance metric: 

scalar performance:
{'acc': 0.8564815, 'precision': 0.8572472, 'recall': 0.85648143, 'specificity': 0.85648143, 'f1': 0.85640454, 'auroc': 0.91105103, 'binary_precision': 0.8737864, 'binary_recall': 0.8333333, 'binary_specificity': 0.8796296, 'binary_f1_score': 0.8530806}
confusion matrix:
     0    1
0  190   26
1   36  180
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_diva_irm_3seeds_nofreeze_2024-07-27_01-18-02/rule_results/6.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_diva_irm_3seeds_nofreeze_2024-07-27_01-18-02/confusion_matrix/6.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   2393 MiB |   8913 MiB | 240294 GiB | 240291 GiB |
|       from large pool |   2302 MiB |   8837 MiB | 238189 GiB | 238187 GiB |
|       from small pool |     91 MiB |    132 MiB |   2104 GiB |   2104 GiB |
|---------------------------------------------------------------------------|
| Active memory         |   2393 MiB |   8913 MiB | 240294 GiB | 240291 GiB |
|       from large pool |   2302 MiB |   8837 MiB | 238189 GiB | 238187 GiB |
|       from small pool |     91 MiB |    132 MiB |   2104 GiB |   2104 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |   2375 MiB |   8902 MiB | 239942 GiB | 239940 GiB |
|       from large pool |   2284 MiB |   8826 MiB | 237841 GiB | 237838 GiB |
|       from small pool |     91 MiB |    132 MiB |   2101 GiB |   2101 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   9634 MiB |   9714 MiB |  21860 MiB |  12226 MiB |
|       from large pool |   9498 MiB |   9578 MiB |  21654 MiB |  12156 MiB |
|       from small pool |    136 MiB |    140 MiB |    206 MiB |     70 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |   1692 MiB |   2815 MiB | 201257 GiB | 201255 GiB |
|       from large pool |   1681 MiB |   2809 MiB | 199087 GiB | 199085 GiB |
|       from small pool |     10 MiB |     60 MiB |   2169 GiB |   2169 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    2464    |    3329    |   34162 K  |   34160 K  |
|       from large pool |     392    |     816    |   17161 K  |   17160 K  |
|       from small pool |    2072    |    2780    |   17001 K  |   16999 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    2464    |    3329    |   34162 K  |   34160 K  |
|       from large pool |     392    |     816    |   17161 K  |   17160 K  |
|       from small pool |    2072    |    2780    |   17001 K  |   16999 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     221    |     269    |     478    |     257    |
|       from large pool |     153    |     201    |     375    |     222    |
|       from small pool |      68    |      70    |     103    |      35    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     152    |     305    |   18031 K  |   18030 K  |
|       from large pool |      80    |     196    |    9303 K  |    9303 K  |
|       from small pool |      72    |     226    |    8727 K  |    8727 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   8913 MiB | 240294 GiB | 240294 GiB |
|       from large pool |  16640 KiB |   8837 MiB | 238189 GiB | 238189 GiB |
|       from small pool |      0 KiB |    132 MiB |   2104 GiB |   2104 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   8913 MiB | 240294 GiB | 240294 GiB |
|       from large pool |  16640 KiB |   8837 MiB | 238189 GiB | 238189 GiB |
|       from small pool |      0 KiB |    132 MiB |   2104 GiB |   2104 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   8902 MiB | 239942 GiB | 239942 GiB |
|       from large pool |  16640 KiB |   8826 MiB | 237841 GiB | 237841 GiB |
|       from small pool |      0 KiB |    132 MiB |   2101 GiB |   2101 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   4086 MiB |   9714 MiB |  21860 MiB |  17774 MiB |
|       from large pool |   3984 MiB |   9578 MiB |  21654 MiB |  17670 MiB |
|       from small pool |    102 MiB |    140 MiB |    206 MiB |    104 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   2815 MiB | 201258 GiB | 201258 GiB |
|       from large pool |  24320 KiB |   2809 MiB | 199088 GiB | 199088 GiB |
|       from small pool |      0 KiB |     60 MiB |   2169 GiB |   2169 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3329    |   34162 K  |   34162 K  |
|       from large pool |       2    |     816    |   17161 K  |   17161 K  |
|       from small pool |       0    |    2780    |   17001 K  |   17001 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3329    |   34162 K  |   34162 K  |
|       from large pool |       2    |     816    |   17161 K  |   17161 K  |
|       from small pool |       0    |    2780    |   17001 K  |   17001 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     132    |     269    |     478    |     346    |
|       from large pool |      81    |     201    |     375    |     294    |
|       from small pool |      51    |      70    |     103    |      52    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     305    |   18031 K  |   18031 K  |
|       from large pool |       3    |     196    |    9303 K  |    9303 K  |
|       from small pool |       0    |     226    |    8727 K  |    8727 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Sat Jul 27 03:06:13 2024]
Finished job 0.
1 of 1 steps (100%) done
