Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Sat Jul 27 01:19:39 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_diva_irm_3seeds_nofreeze_2024-07-27_01-18-02/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_diva_irm_3seeds_nofreeze_2024-07-27_01-18-02/rule_results/13.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=13
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/swiglu_ffn.py:51: UserWarning: xFormers is not available (SwiGLU)
  warnings.warn("xFormers is not available (SwiGLU)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/attention.py:33: UserWarning: xFormers is not available (Attention)
  warnings.warn("xFormers is not available (Attention)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/block.py:40: UserWarning: xFormers is not available (Block)
  warnings.warn("xFormers is not available (Block)")
Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main

using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_01_20_30_seed_0_23090486

 Experiment start at: 2024-07-27 01:20:31.653630
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
before training, model accuracy: 0.45348837971687317
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9348958, 'precision': 0.9376064, 'recall': 0.9354359, 'specificity': 0.9354359, 'f1': 0.9348399, 'auroc': 0.9883649, 'binary_precision': 0.9754558, 'binary_recall': 0.89395887, 'binary_specificity': 0.9769129, 'binary_f1_score': 0.93293095}
confusion matrix:
      0     1
0  1481    35
1   165  1391
---- Validation: 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
scalar performance:
{'acc': 0.8385093, 'precision': 0.8392276, 'recall': 0.83817387, 'specificity': 0.83817387, 'f1': 0.838303, 'auroc': 0.8938274, 'binary_precision': 0.8517298, 'binary_recall': 0.8141732, 'binary_specificity': 0.8621746, 'binary_f1_score': 0.8325281}
confusion matrix:
     0    1
0  563   90
1  118  517
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8372093, 'precision': 0.83747214, 'recall': 0.83720934, 'specificity': 0.83720934, 'f1': 0.83717763, 'auroc': 0.90885884, 'binary_precision': 0.84689, 'binary_recall': 0.82325584, 'binary_specificity': 0.8511628, 'binary_f1_score': 0.8349057}
confusion matrix:
     0    1
0  183   32
1   38  177
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-27 01:22:04.064081,epoch time: 0:01:32.410451,used: 0:01:32.410451,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_01_20_30_seed_0_23090486
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9654948, 'precision': 0.9655628, 'recall': 0.9654349, 'specificity': 0.9654349, 'f1': 0.96548414, 'auroc': 0.99349993, 'binary_precision': 0.96239644, 'binary_recall': 0.96981376, 'binary_specificity': 0.9610561, 'binary_f1_score': 0.96609086}
confusion matrix:
      0     1
0  1456    59
1    47  1510
---- Validation: 
scalar performance:
{'acc': 0.8369565, 'precision': 0.8384752, 'recall': 0.83742386, 'specificity': 0.83742386, 'f1': 0.83687943, 'auroc': 0.9048004, 'binary_precision': 0.8120411, 'binary_recall': 0.8708661, 'binary_specificity': 0.8039816, 'binary_f1_score': 0.8404255}
confusion matrix:
     0    1
0  525  128
1   82  553
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.82093024, 'precision': 0.82402146, 'recall': 0.82093024, 'specificity': 0.82093024, 'f1': 0.8205021, 'auroc': 0.9013953, 'binary_precision': 0.7923729, 'binary_recall': 0.8697674, 'binary_specificity': 0.772093, 'binary_f1_score': 0.8292683}
confusion matrix:
     0    1
0  166   49
1   28  187
early stop counter: 1
val acc:0.8369565010070801, best validation acc: 0.8385093212127686, corresponding to test acc:                         0.8372092843055725 / 0.8372092843055725
after epoch: 2,now: 2024-07-27 01:23:27.701203,epoch time: 0:01:23.637122,used: 0:02:56.047573,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_01_20_30_seed_0_23090486
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9609375, 'precision': 0.96180296, 'recall': 0.9612376, 'specificity': 0.9612376, 'f1': 0.96093154, 'auroc': 0.99433565, 'binary_precision': 0.98512506, 'binary_recall': 0.9369775, 'binary_specificity': 0.9854977, 'binary_f1_score': 0.96044827}
confusion matrix:
      0     1
0  1495    22
1    98  1457
---- Validation: 
scalar performance:
{'acc': 0.7709627, 'precision': 0.7732717, 'recall': 0.77027774, 'specificity': 0.77027774, 'f1': 0.77014124, 'auroc': 0.8568497, 'binary_precision': 0.7951389, 'binary_recall': 0.72125983, 'binary_specificity': 0.8192956, 'binary_f1_score': 0.75639975}
confusion matrix:
     0    1
0  535  118
1  177  458
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7930232, 'precision': 0.7930296, 'recall': 0.7930232, 'specificity': 0.7930232, 'f1': 0.79302216, 'auroc': 0.8677339, 'binary_precision': 0.7916667, 'binary_recall': 0.7953488, 'binary_specificity': 0.7906977, 'binary_f1_score': 0.7935035}
confusion matrix:
     0    1
0  170   45
1   44  171
early stop counter: 2
val acc:0.7709627151489258, best validation acc: 0.8385093212127686, corresponding to test acc:                         0.8372092843055725 / 0.8372092843055725
after epoch: 3,now: 2024-07-27 01:24:51.396945,epoch time: 0:01:23.695742,used: 0:04:19.743315,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_01_20_30_seed_0_23090486
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.96940106, 'precision': 0.9698893, 'recall': 0.9696502, 'specificity': 0.9696502, 'f1': 0.9693997, 'auroc': 0.99632967, 'binary_precision': 0.9886364, 'binary_recall': 0.95051414, 'binary_specificity': 0.9887863, 'binary_f1_score': 0.9692005}
confusion matrix:
      0     1
0  1499    17
1    77  1479
---- Validation: 
scalar performance:
{'acc': 0.7585404, 'precision': 0.79347825, 'recall': 0.7560948, 'specificity': 0.7560948, 'f1': 0.74992996, 'auroc': 0.8904897, 'binary_precision': 0.8913044, 'binary_recall': 0.5811024, 'binary_specificity': 0.9310873, 'binary_f1_score': 0.7035272}
confusion matrix:
     0    1
0  608   45
1  266  369
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8418605, 'precision': 0.8597937, 'recall': 0.8418604, 'specificity': 0.8418604, 'f1': 0.8398651, 'auroc': 0.91647375, 'binary_precision': 0.94011974, 'binary_recall': 0.73023254, 'binary_specificity': 0.95348835, 'binary_f1_score': 0.82198954}
confusion matrix:
     0    1
0  205   10
1   58  157
new oracle model saved
early stop counter: 3
val acc:0.7585403919219971, best validation acc: 0.8385093212127686, corresponding to test acc:                         0.8372092843055725 / 0.8418604731559753
after epoch: 4,now: 2024-07-27 01:26:16.270217,epoch time: 0:01:24.873272,used: 0:05:44.616587,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_01_20_30_seed_0_23090486
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9710286, 'precision': 0.9722914, 'recall': 0.9713826, 'specificity': 0.9713826, 'f1': 0.9710207, 'auroc': 0.99835515, 'binary_precision': 1.0, 'binary_recall': 0.9427653, 'binary_specificity': 1.0, 'binary_f1_score': 0.97053957}
confusion matrix:
      0     1
0  1517     0
1    89  1466
---- Validation: 
scalar performance:
{'acc': 0.5706522, 'precision': 0.7390231, 'recall': 0.56469715, 'specificity': 0.56469715, 'f1': 0.47101107, 'auroc': 0.87036395, 'binary_precision': 0.9361702, 'binary_recall': 0.13858268, 'binary_specificity': 0.99081165, 'binary_f1_score': 0.2414266}
confusion matrix:
     0   1
0  647   6
1  547  88
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.74186045, 'precision': 0.81034863, 'recall': 0.74186045, 'specificity': 0.74186045, 'f1': 0.7267872, 'auroc': 0.8988426, 'binary_precision': 0.95614034, 'binary_recall': 0.5069767, 'binary_specificity': 0.9767442, 'binary_f1_score': 0.6626139}
confusion matrix:
     0    1
0  210    5
1  106  109
early stop counter: 4
val acc:0.570652186870575, best validation acc: 0.8385093212127686, corresponding to test acc:                         0.8372092843055725 / 0.8418604731559753
after epoch: 5,now: 2024-07-27 01:27:40.026673,epoch time: 0:01:23.756456,used: 0:07:08.373043,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_01_20_30_seed_0_23090486
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.97591144, 'precision': 0.97619796, 'recall': 0.97610104, 'specificity': 0.97610104, 'f1': 0.97591114, 'auroc': 0.9971428, 'binary_precision': 0.9913736, 'binary_recall': 0.9607717, 'binary_specificity': 0.99143046, 'binary_f1_score': 0.9758327}
confusion matrix:
      0     1
0  1504    13
1    61  1494
---- Validation: 
scalar performance:
{'acc': 0.7795031, 'precision': 0.7997376, 'recall': 0.7776585, 'specificity': 0.7776585, 'f1': 0.77490944, 'auroc': 0.8692672, 'binary_precision': 0.8742004, 'binary_recall': 0.6456693, 'binary_specificity': 0.90964776, 'binary_f1_score': 0.7427536}
confusion matrix:
     0    1
0  594   59
1  225  410
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.81395346, 'precision': 0.8141982, 'recall': 0.8139535, 'specificity': 0.8139535, 'f1': 0.8139173, 'auroc': 0.8580855, 'binary_precision': 0.8229665, 'binary_recall': 0.8, 'binary_specificity': 0.82790697, 'binary_f1_score': 0.8113208}
confusion matrix:
     0    1
0  178   37
1   43  172
early stop counter: 5
val acc:0.7795031070709229, best validation acc: 0.8385093212127686, corresponding to test acc:                         0.8372092843055725 / 0.8418604731559753
after epoch: 6,now: 2024-07-27 01:29:03.610138,epoch time: 0:01:23.583465,used: 0:08:31.956508,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_01_20_30_seed_0_23090486
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 6 with time: 0:08:31.956508 at 2024-07-27 01:29:03.610138
persisted model performance metric: 

scalar performance:
{'acc': 0.8372093, 'precision': 0.83747214, 'recall': 0.83720934, 'specificity': 0.83720934, 'f1': 0.83717763, 'auroc': 0.90885884, 'binary_precision': 0.84689, 'binary_recall': 0.82325584, 'binary_specificity': 0.8511628, 'binary_f1_score': 0.8349057}
confusion matrix:
     0    1
0  183   32
1   38  177
oracle model performance metric: 

scalar performance:
{'acc': 0.8418605, 'precision': 0.8597937, 'recall': 0.8418604, 'specificity': 0.8418604, 'f1': 0.8398651, 'auroc': 0.91647375, 'binary_precision': 0.94011974, 'binary_recall': 0.73023254, 'binary_specificity': 0.95348835, 'binary_f1_score': 0.82198954}
confusion matrix:
     0    1
0  205   10
1   58  157
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_diva_irm_3seeds_nofreeze_2024-07-27_01-18-02/rule_results/13.csv
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_diva_irm_3seeds_nofreeze_2024-07-27_01-18-02/rule_results/13.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_diva_irm_3seeds_nofreeze_2024-07-27_01-18-02/confusion_matrix/13.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   1251 MiB |  14022 MiB |  14864 GiB |  14863 GiB |
|       from large pool |   1192 MiB |  13963 MiB |  14677 GiB |  14676 GiB |
|       from small pool |     59 MiB |     95 MiB |    186 GiB |    186 GiB |
|---------------------------------------------------------------------------|
| Active memory         |   1251 MiB |  14022 MiB |  14864 GiB |  14863 GiB |
|       from large pool |   1192 MiB |  13963 MiB |  14677 GiB |  14676 GiB |
|       from small pool |     59 MiB |     95 MiB |    186 GiB |    186 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |   1240 MiB |  14016 MiB |  14851 GiB |  14850 GiB |
|       from large pool |   1180 MiB |  13958 MiB |  14665 GiB |  14663 GiB |
|       from small pool |     59 MiB |     95 MiB |    186 GiB |    186 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  15172 MiB |  15172 MiB |  15172 MiB |      0 B   |
|       from large pool |  15066 MiB |  15066 MiB |  15066 MiB |      0 B   |
|       from small pool |    106 MiB |    106 MiB |    106 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |   1676 MiB |   2298 MiB |  11167 GiB |  11166 GiB |
|       from large pool |   1665 MiB |   2289 MiB |  10980 GiB |  10978 GiB |
|       from small pool |     10 MiB |     17 MiB |    187 GiB |    187 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    1792    |    3103    |    2689 K  |    2687 K  |
|       from large pool |     269    |    1495    |    1329 K  |    1329 K  |
|       from small pool |    1523    |    2219    |    1360 K  |    1358 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    1792    |    3103    |    2689 K  |    2687 K  |
|       from large pool |     269    |    1495    |    1329 K  |    1329 K  |
|       from small pool |    1523    |    2219    |    1360 K  |    1358 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     593    |     593    |     593    |       0    |
|       from large pool |     540    |     540    |     540    |       0    |
|       from small pool |      53    |      53    |      53    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     141    |     582    |    1734 K  |    1734 K  |
|       from large pool |      56    |     534    |     999 K  |     999 K  |
|       from small pool |      85    |     240    |     734 K  |     734 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  14022 MiB |  14864 GiB |  14864 GiB |
|       from large pool |  16640 KiB |  13963 MiB |  14677 GiB |  14677 GiB |
|       from small pool |      0 KiB |     95 MiB |    186 GiB |    186 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  14022 MiB |  14864 GiB |  14864 GiB |
|       from large pool |  16640 KiB |  13963 MiB |  14677 GiB |  14677 GiB |
|       from small pool |      0 KiB |     95 MiB |    186 GiB |    186 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  14016 MiB |  14851 GiB |  14851 GiB |
|       from large pool |  16640 KiB |  13958 MiB |  14665 GiB |  14665 GiB |
|       from small pool |      0 KiB |     95 MiB |    186 GiB |    186 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2928 MiB |  15172 MiB |  15172 MiB |  12244 MiB |
|       from large pool |   2858 MiB |  15066 MiB |  15066 MiB |  12208 MiB |
|       from small pool |     70 MiB |    106 MiB |    106 MiB |     36 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   2298 MiB |  11168 GiB |  11168 GiB |
|       from large pool |  24320 KiB |   2289 MiB |  10980 GiB |  10980 GiB |
|       from small pool |      0 KiB |     39 MiB |    187 GiB |    187 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3103    |    2689 K  |    2689 K  |
|       from large pool |       2    |    1495    |    1329 K  |    1329 K  |
|       from small pool |       0    |    2219    |    1360 K  |    1360 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3103    |    2689 K  |    2689 K  |
|       from large pool |       2    |    1495    |    1329 K  |    1329 K  |
|       from small pool |       0    |    2219    |    1360 K  |    1360 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      95    |     593    |     593    |     498    |
|       from large pool |      60    |     540    |     540    |     480    |
|       from small pool |      35    |      53    |      53    |      18    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       2    |     582    |    1734 K  |    1734 K  |
|       from large pool |       2    |     534    |     999 K  |     999 K  |
|       from small pool |       0    |     240    |     734 K  |     734 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  14022 MiB |  14864 GiB |  14864 GiB |
|       from large pool |  16640 KiB |  13963 MiB |  14677 GiB |  14677 GiB |
|       from small pool |      0 KiB |     95 MiB |    186 GiB |    186 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  14022 MiB |  14864 GiB |  14864 GiB |
|       from large pool |  16640 KiB |  13963 MiB |  14677 GiB |  14677 GiB |
|       from small pool |      0 KiB |     95 MiB |    186 GiB |    186 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  14016 MiB |  14851 GiB |  14851 GiB |
|       from large pool |  16640 KiB |  13958 MiB |  14665 GiB |  14665 GiB |
|       from small pool |      0 KiB |     95 MiB |    186 GiB |    186 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2928 MiB |  15172 MiB |  15172 MiB |  12244 MiB |
|       from large pool |   2858 MiB |  15066 MiB |  15066 MiB |  12208 MiB |
|       from small pool |     70 MiB |    106 MiB |    106 MiB |     36 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   2298 MiB |  11168 GiB |  11168 GiB |
|       from large pool |  24320 KiB |   2289 MiB |  10980 GiB |  10980 GiB |
|       from small pool |      0 KiB |     39 MiB |    187 GiB |    187 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3103    |    2689 K  |    2689 K  |
|       from large pool |       2    |    1495    |    1329 K  |    1329 K  |
|       from small pool |       0    |    2219    |    1360 K  |    1360 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3103    |    2689 K  |    2689 K  |
|       from large pool |       2    |    1495    |    1329 K  |    1329 K  |
|       from small pool |       0    |    2219    |    1360 K  |    1360 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      95    |     593    |     593    |     498    |
|       from large pool |      60    |     540    |     540    |     480    |
|       from small pool |      35    |      53    |      53    |      18    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       2    |     582    |    1734 K  |    1734 K  |
|       from large pool |       2    |     534    |     999 K  |     999 K  |
|       from small pool |       0    |     240    |     734 K  |     734 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main

using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_01_29_43_seed_1_23090486

 Experiment start at: 2024-07-27 01:29:43.844153
before training, model accuracy: 0.5022222399711609
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9391276, 'precision': 0.93911314, 'recall': 0.9391688, 'specificity': 0.9391688, 'f1': 0.9391242, 'auroc': 0.982436, 'binary_precision': 0.94354314, 'binary_recall': 0.93564993, 'binary_specificity': 0.94268775, 'binary_f1_score': 0.93957996}
confusion matrix:
      0     1
0  1431    87
1   100  1454
---- Validation: 
scalar performance:
{'acc': 0.8095238, 'precision': 0.82355195, 'recall': 0.8112135, 'specificity': 0.8112135, 'f1': 0.80797625, 'auroc': 0.9112135, 'binary_precision': 0.75195825, 'binary_recall': 0.9142857, 'binary_specificity': 0.7081413, 'binary_f1_score': 0.8252149}
confusion matrix:
     0    1
0  461  190
1   54  576
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.81333333, 'precision': 0.81900454, 'recall': 0.81333333, 'specificity': 0.81333333, 'f1': 0.8125, 'auroc': 0.9227457, 'binary_precision': 0.7764706, 'binary_recall': 0.88, 'binary_specificity': 0.74666667, 'binary_f1_score': 0.82500005}
confusion matrix:
     0    1
0  168   57
1   27  198
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-27 01:31:14.722179,epoch time: 0:01:30.878026,used: 0:01:30.878026,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_01_29_43_seed_1_23090486
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.921875, 'precision': 0.9283748, 'recall': 0.9211699, 'specificity': 0.9211699, 'f1': 0.9214796, 'auroc': 0.9917218, 'binary_precision': 0.87845623, 'binary_recall': 0.9813385, 'binary_specificity': 0.8610013, 'binary_f1_score': 0.9270517}
confusion matrix:
      0     1
0  1307   211
1    29  1525
---- Validation: 
scalar performance:
{'acc': 0.7900078, 'precision': 0.81218183, 'recall': 0.7921659, 'specificity': 0.7921659, 'f1': 0.787009, 'auroc': 0.9110892, 'binary_precision': 0.72478205, 'binary_recall': 0.9238095, 'binary_specificity': 0.6605223, 'binary_f1_score': 0.8122819}
confusion matrix:
     0    1
0  430  221
1   48  582
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.76666665, 'precision': 0.79261315, 'recall': 0.76666665, 'specificity': 0.76666665, 'f1': 0.76137686, 'auroc': 0.9221136, 'binary_precision': 0.70547944, 'binary_recall': 0.91555554, 'binary_specificity': 0.61777776, 'binary_f1_score': 0.7969052}
confusion matrix:
     0    1
0  139   86
1   19  206
early stop counter: 1
val acc:0.7900078296661377, best validation acc: 0.8095238208770752, corresponding to test acc:                         0.8133333325386047 / 0.8133333325386047
after epoch: 2,now: 2024-07-27 01:32:39.717662,epoch time: 0:01:24.995483,used: 0:02:55.873509,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_01_29_43_seed_1_23090486
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.97786456, 'precision': 0.97787386, 'recall': 0.9779541, 'specificity': 0.9779541, 'f1': 0.9778638, 'auroc': 0.9967959, 'binary_precision': 0.9850065, 'binary_recall': 0.9710797, 'binary_specificity': 0.9848285, 'binary_f1_score': 0.97799355}
confusion matrix:
      0     1
0  1493    23
1    45  1511
---- Validation: 
scalar performance:
{'acc': 0.7946916, 'precision': 0.7962054, 'recall': 0.79406047, 'specificity': 0.79406047, 'f1': 0.7941452, 'auroc': 0.8661467, 'binary_precision': 0.8136752, 'binary_recall': 0.75555557, 'binary_specificity': 0.8325653, 'binary_f1_score': 0.7835391}
confusion matrix:
     0    1
0  542  109
1  154  476
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.82666665, 'precision': 0.82877076, 'recall': 0.8266667, 'specificity': 0.8266667, 'f1': 0.8263889, 'auroc': 0.9158124, 'binary_precision': 0.80246913, 'binary_recall': 0.8666667, 'binary_specificity': 0.7866667, 'binary_f1_score': 0.8333333}
confusion matrix:
     0    1
0  177   48
1   30  195
new oracle model saved
early stop counter: 2
val acc:0.7946916222572327, best validation acc: 0.8095238208770752, corresponding to test acc:                         0.8133333325386047 / 0.8266666531562805
after epoch: 3,now: 2024-07-27 01:34:05.623804,epoch time: 0:01:25.906142,used: 0:04:21.779651,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_01_29_43_seed_1_23090486
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9505208, 'precision': 0.95238936, 'recall': 0.950111, 'specificity': 0.950111, 'f1': 0.9504293, 'auroc': 0.9938941, 'binary_precision': 0.9265331, 'binary_recall': 0.9800899, 'binary_specificity': 0.92013204, 'binary_f1_score': 0.95255935}
confusion matrix:
      0     1
0  1394   121
1    31  1526
---- Validation: 
scalar performance:
{'acc': 0.8649493, 'precision': 0.8649868, 'recall': 0.8650794, 'specificity': 0.8650794, 'f1': 0.864944, 'auroc': 0.9149538, 'binary_precision': 0.85536546, 'binary_recall': 0.8730159, 'binary_specificity': 0.85714287, 'binary_f1_score': 0.8641005}
confusion matrix:
     0    1
0  558   93
1   80  550
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8622222, 'precision': 0.86248, 'recall': 0.8622222, 'specificity': 0.8622222, 'f1': 0.8621977, 'auroc': 0.93965435, 'binary_precision': 0.85281384, 'binary_recall': 0.8755556, 'binary_specificity': 0.8488889, 'binary_f1_score': 0.86403507}
confusion matrix:
     0    1
0  191   34
1   28  197
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-07-27 01:35:32.670083,epoch time: 0:01:27.046279,used: 0:05:48.825930,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_01_29_43_seed_1_23090486
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.97721356, 'precision': 0.9774047, 'recall': 0.9773877, 'specificity': 0.9773877, 'f1': 0.97721356, 'auroc': 0.99783206, 'binary_precision': 0.990753, 'binary_recall': 0.9640103, 'binary_specificity': 0.99076515, 'binary_f1_score': 0.9771987}
confusion matrix:
      0     1
0  1502    14
1    56  1500
---- Validation: 
scalar performance:
{'acc': 0.69086653, 'precision': 0.7481525, 'recall': 0.6868408, 'specificity': 0.6868408, 'f1': 0.66903543, 'auroc': 0.8486383, 'binary_precision': 0.863354, 'binary_recall': 0.44126984, 'binary_specificity': 0.9324117, 'binary_f1_score': 0.5840336}
confusion matrix:
     0    1
0  607   44
1  352  278
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8711111, 'precision': 0.8820073, 'recall': 0.87111115, 'specificity': 0.87111115, 'f1': 0.8701855, 'auroc': 0.93037033, 'binary_precision': 0.9465241, 'binary_recall': 0.7866667, 'binary_specificity': 0.95555556, 'binary_f1_score': 0.85922337}
confusion matrix:
     0    1
0  215   10
1   48  177
new oracle model saved
early stop counter: 1
val acc:0.6908665299415588, best validation acc: 0.8649492859840393, corresponding to test acc:                         0.8622221946716309 / 0.8711110949516296
after epoch: 5,now: 2024-07-27 01:36:58.707358,epoch time: 0:01:26.037275,used: 0:07:14.863205,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_01_29_43_seed_1_23090486
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.96875, 'precision': 0.97000724, 'recall': 0.96841717, 'specificity': 0.96841717, 'f1': 0.9687069, 'auroc': 0.9978243, 'binary_precision': 0.9490172, 'binary_recall': 0.99165595, 'binary_specificity': 0.94517833, 'binary_f1_score': 0.9698682}
confusion matrix:
      0     1
0  1431    83
1    13  1545
---- Validation: 
scalar performance:
{'acc': 0.8649493, 'precision': 0.8686279, 'recall': 0.8641321, 'specificity': 0.8641321, 'f1': 0.8643936, 'auroc': 0.9109355, 'binary_precision': 0.9015817, 'binary_recall': 0.8142857, 'binary_specificity': 0.9139785, 'binary_f1_score': 0.85571307}
confusion matrix:
     0    1
0  595   56
1  117  513
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8466667, 'precision': 0.85099995, 'recall': 0.8466667, 'specificity': 0.8466667, 'f1': 0.84619194, 'auroc': 0.91407406, 'binary_precision': 0.89, 'binary_recall': 0.7911111, 'binary_specificity': 0.9022222, 'binary_f1_score': 0.837647}
confusion matrix:
     0    1
0  203   22
1   47  178
early stop counter: 2
val acc:0.8649492859840393, best validation acc: 0.8649492859840393, corresponding to test acc:                         0.8622221946716309 / 0.8711110949516296
after epoch: 6,now: 2024-07-27 01:38:23.014933,epoch time: 0:01:24.307575,used: 0:08:39.170780,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_01_29_43_seed_1_23090486
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9635417, 'precision': 0.96546257, 'recall': 0.96315396, 'specificity': 0.96315396, 'f1': 0.96347624, 'auroc': 0.9984963, 'binary_precision': 0.9386391, 'binary_recall': 0.9929306, 'binary_specificity': 0.9333773, 'binary_f1_score': 0.96502185}
confusion matrix:
      0     1
0  1415   101
1    11  1545
---- Validation: 
scalar performance:
{'acc': 0.8321624, 'precision': 0.8374133, 'recall': 0.8331797, 'specificity': 0.8331797, 'f1': 0.8317683, 'auroc': 0.9045254, 'binary_precision': 0.79102385, 'binary_recall': 0.8952381, 'binary_specificity': 0.7711213, 'binary_f1_score': 0.8399107}
confusion matrix:
     0    1
0  502  149
1   66  564
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.85555553, 'precision': 0.86156195, 'recall': 0.85555553, 'specificity': 0.85555553, 'f1': 0.85495317, 'auroc': 0.9306469, 'binary_precision': 0.81496066, 'binary_recall': 0.92, 'binary_specificity': 0.7911111, 'binary_f1_score': 0.86430067}
confusion matrix:
     0    1
0  178   47
1   18  207
early stop counter: 3
val acc:0.8321623802185059, best validation acc: 0.8649492859840393, corresponding to test acc:                         0.8622221946716309 / 0.8711110949516296
after epoch: 7,now: 2024-07-27 01:39:48.474211,epoch time: 0:01:25.459278,used: 0:10:04.630058,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_01_29_43_seed_1_23090486
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.92089844, 'precision': 0.9311391, 'recall': 0.9199641, 'specificity': 0.9199641, 'f1': 0.9202964, 'auroc': 0.99733436, 'binary_precision': 0.86771303, 'binary_recall': 0.9954984, 'binary_specificity': 0.8444298, 'binary_f1_score': 0.9272238}
confusion matrix:
      0     1
0  1281   236
1     7  1548
---- Validation: 
scalar performance:
{'acc': 0.81342703, 'precision': 0.82968634, 'recall': 0.815233, 'specificity': 0.815233, 'f1': 0.81166226, 'auroc': 0.9103358, 'binary_precision': 0.75225806, 'binary_recall': 0.9253968, 'binary_specificity': 0.7050691, 'binary_f1_score': 0.82989323}
confusion matrix:
     0    1
0  459  192
1   47  583
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.76666665, 'precision': 0.8041637, 'recall': 0.76666665, 'specificity': 0.76666665, 'f1': 0.7592467, 'auroc': 0.90885925, 'binary_precision': 0.69736844, 'binary_recall': 0.94222224, 'binary_specificity': 0.5911111, 'binary_f1_score': 0.8015123}
confusion matrix:
     0    1
0  133   92
1   13  212
early stop counter: 4
val acc:0.8134270310401917, best validation acc: 0.8649492859840393, corresponding to test acc:                         0.8622221946716309 / 0.8711110949516296
after epoch: 8,now: 2024-07-27 01:41:13.586395,epoch time: 0:01:25.112184,used: 0:11:29.742242,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_01_29_43_seed_1_23090486
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9749349, 'precision': 0.9757928, 'recall': 0.9752331, 'specificity': 0.9752331, 'f1': 0.97493124, 'auroc': 0.9989903, 'binary_precision': 0.9993243, 'binary_recall': 0.9511254, 'binary_specificity': 0.99934083, 'binary_f1_score': 0.9746293}
confusion matrix:
      0     1
0  1516     1
1    76  1479
---- Validation: 
scalar performance:
{'acc': 0.83138174, 'precision': 0.85139275, 'recall': 0.8294163, 'specificity': 0.8294163, 'f1': 0.8283225, 'auroc': 0.9124131, 'binary_precision': 0.93125, 'binary_recall': 0.7095238, 'binary_specificity': 0.94930875, 'binary_f1_score': 0.8054054}
confusion matrix:
     0    1
0  618   33
1  183  447
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8422222, 'precision': 0.8755202, 'recall': 0.8422222, 'specificity': 0.8422222, 'f1': 0.83864534, 'auroc': 0.9349333, 'binary_precision': 0.98734176, 'binary_recall': 0.6933333, 'binary_specificity': 0.9911111, 'binary_f1_score': 0.81462145}
confusion matrix:
     0    1
0  223    2
1   69  156
early stop counter: 5
val acc:0.8313817381858826, best validation acc: 0.8649492859840393, corresponding to test acc:                         0.8622221946716309 / 0.8711110949516296
after epoch: 9,now: 2024-07-27 01:42:38.814980,epoch time: 0:01:25.228585,used: 0:12:54.970827,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_01_29_43_seed_1_23090486
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 9 with time: 0:12:54.970827 at 2024-07-27 01:42:38.814980
persisted model performance metric: 

scalar performance:
{'acc': 0.8622222, 'precision': 0.86248, 'recall': 0.8622222, 'specificity': 0.8622222, 'f1': 0.8621977, 'auroc': 0.93965435, 'binary_precision': 0.85281384, 'binary_recall': 0.8755556, 'binary_specificity': 0.8488889, 'binary_f1_score': 0.86403507}
confusion matrix:
     0    1
0  191   34
1   28  197
oracle model performance metric: 

scalar performance:
{'acc': 0.8711111, 'precision': 0.8820073, 'recall': 0.87111115, 'specificity': 0.87111115, 'f1': 0.8701855, 'auroc': 0.93037033, 'binary_precision': 0.9465241, 'binary_recall': 0.7866667, 'binary_specificity': 0.95555556, 'binary_f1_score': 0.85922337}
confusion matrix:
     0    1
0  215   10
1   48  177
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_diva_irm_3seeds_nofreeze_2024-07-27_01-18-02/rule_results/13.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_diva_irm_3seeds_nofreeze_2024-07-27_01-18-02/confusion_matrix/13.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   1252 MiB |  14022 MiB |  37617 GiB |  37616 GiB |
|       from large pool |   1193 MiB |  13964 MiB |  37145 GiB |  37144 GiB |
|       from small pool |     59 MiB |     99 MiB |    472 GiB |    472 GiB |
|---------------------------------------------------------------------------|
| Active memory         |   1252 MiB |  14022 MiB |  37617 GiB |  37616 GiB |
|       from large pool |   1193 MiB |  13964 MiB |  37145 GiB |  37144 GiB |
|       from small pool |     59 MiB |     99 MiB |    472 GiB |    472 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |   1240 MiB |  14016 MiB |  37584 GiB |  37583 GiB |
|       from large pool |   1180 MiB |  13958 MiB |  37113 GiB |  37112 GiB |
|       from small pool |     59 MiB |     99 MiB |    471 GiB |    471 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  15114 MiB |  15172 MiB |  27358 MiB |  12244 MiB |
|       from large pool |  15002 MiB |  15066 MiB |  27210 MiB |  12208 MiB |
|       from small pool |    112 MiB |    112 MiB |    148 MiB |     36 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |   1987 MiB |   3046 MiB |  29695 GiB |  29693 GiB |
|       from large pool |   1976 MiB |   3038 MiB |  29220 GiB |  29218 GiB |
|       from small pool |     10 MiB |     39 MiB |    474 GiB |    474 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    1804    |    3107    |    6790 K  |    6788 K  |
|       from large pool |     269    |    1495    |    3361 K  |    3361 K  |
|       from small pool |    1535    |    2231    |    3428 K  |    3427 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    1804    |    3107    |    6790 K  |    6788 K  |
|       from large pool |     269    |    1495    |    3361 K  |    3361 K  |
|       from small pool |    1535    |    2231    |    3428 K  |    3427 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     562    |     593    |    1060    |     498    |
|       from large pool |     506    |     540    |     986    |     480    |
|       from small pool |      56    |      56    |      74    |      18    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     140    |     582    |    4262 K  |    4262 K  |
|       from large pool |      56    |     534    |    2370 K  |    2370 K  |
|       from small pool |      84    |     240    |    1892 K  |    1892 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  14022 MiB |  37617 GiB |  37617 GiB |
|       from large pool |  16640 KiB |  13964 MiB |  37145 GiB |  37145 GiB |
|       from small pool |      0 KiB |     99 MiB |    472 GiB |    472 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  14022 MiB |  37617 GiB |  37617 GiB |
|       from large pool |  16640 KiB |  13964 MiB |  37145 GiB |  37145 GiB |
|       from small pool |      0 KiB |     99 MiB |    472 GiB |    472 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  14016 MiB |  37584 GiB |  37584 GiB |
|       from large pool |  16640 KiB |  13958 MiB |  37113 GiB |  37113 GiB |
|       from small pool |      0 KiB |     99 MiB |    471 GiB |    471 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   3240 MiB |  15172 MiB |  27358 MiB |  24118 MiB |
|       from large pool |   3170 MiB |  15066 MiB |  27210 MiB |  24040 MiB |
|       from small pool |     70 MiB |    112 MiB |    148 MiB |     78 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   3046 MiB |  29695 GiB |  29695 GiB |
|       from large pool |  24320 KiB |   3038 MiB |  29221 GiB |  29221 GiB |
|       from small pool |      0 KiB |     44 MiB |    474 GiB |    474 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3107    |    6790 K  |    6790 K  |
|       from large pool |       2    |    1495    |    3361 K  |    3361 K  |
|       from small pool |       0    |    2231    |    3428 K  |    3428 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3107    |    6790 K  |    6790 K  |
|       from large pool |       2    |    1495    |    3361 K  |    3361 K  |
|       from small pool |       0    |    2231    |    3428 K  |    3428 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      95    |     593    |    1060    |     965    |
|       from large pool |      60    |     540    |     986    |     926    |
|       from small pool |      35    |      56    |      74    |      39    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       2    |     582    |    4263 K  |    4263 K  |
|       from large pool |       2    |     534    |    2370 K  |    2370 K  |
|       from small pool |       0    |     240    |    1892 K  |    1892 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  14022 MiB |  37617 GiB |  37617 GiB |
|       from large pool |  16640 KiB |  13964 MiB |  37145 GiB |  37145 GiB |
|       from small pool |      0 KiB |     99 MiB |    472 GiB |    472 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  14022 MiB |  37617 GiB |  37617 GiB |
|       from large pool |  16640 KiB |  13964 MiB |  37145 GiB |  37145 GiB |
|       from small pool |      0 KiB |     99 MiB |    472 GiB |    472 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  14016 MiB |  37584 GiB |  37584 GiB |
|       from large pool |  16640 KiB |  13958 MiB |  37113 GiB |  37113 GiB |
|       from small pool |      0 KiB |     99 MiB |    471 GiB |    471 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   3240 MiB |  15172 MiB |  27358 MiB |  24118 MiB |
|       from large pool |   3170 MiB |  15066 MiB |  27210 MiB |  24040 MiB |
|       from small pool |     70 MiB |    112 MiB |    148 MiB |     78 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   3046 MiB |  29695 GiB |  29695 GiB |
|       from large pool |  24320 KiB |   3038 MiB |  29221 GiB |  29221 GiB |
|       from small pool |      0 KiB |     44 MiB |    474 GiB |    474 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3107    |    6790 K  |    6790 K  |
|       from large pool |       2    |    1495    |    3361 K  |    3361 K  |
|       from small pool |       0    |    2231    |    3428 K  |    3428 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3107    |    6790 K  |    6790 K  |
|       from large pool |       2    |    1495    |    3361 K  |    3361 K  |
|       from small pool |       0    |    2231    |    3428 K  |    3428 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      95    |     593    |    1060    |     965    |
|       from large pool |      60    |     540    |     986    |     926    |
|       from small pool |      35    |      56    |      74    |      39    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       2    |     582    |    4263 K  |    4263 K  |
|       from large pool |       2    |     534    |    2370 K  |    2370 K  |
|       from small pool |       0    |     240    |    1892 K  |    1892 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main

using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_01_43_19_seed_2_23090486

 Experiment start at: 2024-07-27 01:43:20.331207
before training, model accuracy: 0.506944477558136
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9394634, 'precision': 0.94360304, 'recall': 0.93985283, 'specificity': 0.93985283, 'f1': 0.9393553, 'auroc': 0.9830472, 'binary_precision': 0.9884643, 'binary_recall': 0.89025974, 'binary_specificity': 0.9894459, 'binary_f1_score': 0.93679535}
confusion matrix:
      0     1
0  1500    16
1   169  1371
---- Validation: 
scalar performance:
{'acc': 0.80203444, 'precision': 0.8181995, 'recall': 0.798957, 'specificity': 0.798957, 'f1': 0.7982515, 'auroc': 0.88214403, 'binary_precision': 0.88357586, 'binary_recall': 0.68327975, 'binary_specificity': 0.91463417, 'binary_f1_score': 0.77062553}
confusion matrix:
     0    1
0  600   56
1  197  425
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8171296, 'precision': 0.8343351, 'recall': 0.8171296, 'specificity': 0.8171296, 'f1': 0.81474626, 'auroc': 0.8992841, 'binary_precision': 0.9101796, 'binary_recall': 0.7037037, 'binary_specificity': 0.9305556, 'binary_f1_score': 0.7937337}
confusion matrix:
     0    1
0  201   15
1   64  152
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-27 01:44:49.575491,epoch time: 0:01:29.244284,used: 0:01:29.244284,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_01_43_19_seed_2_23090486
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9695681, 'precision': 0.96975803, 'recall': 0.9696613, 'specificity': 0.9696613, 'f1': 0.96956754, 'auroc': 0.99547124, 'binary_precision': 0.98137057, 'binary_recall': 0.9577922, 'binary_specificity': 0.98153037, 'binary_f1_score': 0.9694381}
confusion matrix:
      0     1
0  1488    28
1    65  1475
---- Validation: 
scalar performance:
{'acc': 0.79264474, 'precision': 0.80394804, 'recall': 0.78997725, 'specificity': 0.78997725, 'f1': 0.7895491, 'auroc': 0.8799138, 'binary_precision': 0.8562874, 'binary_recall': 0.6897106, 'binary_specificity': 0.8902439, 'binary_f1_score': 0.7640249}
confusion matrix:
     0    1
0  584   72
1  193  429
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8726852, 'precision': 0.87774545, 'recall': 0.8726852, 'specificity': 0.8726852, 'f1': 0.8722574, 'auroc': 0.93306327, 'binary_precision': 0.921466, 'binary_recall': 0.8148148, 'binary_specificity': 0.9305556, 'binary_f1_score': 0.8648649}
confusion matrix:
     0    1
0  201   15
1   40  176
new oracle model saved
early stop counter: 1
val acc:0.792644739151001, best validation acc: 0.8020344376564026, corresponding to test acc:                         0.8171296119689941 / 0.8726851940155029
after epoch: 2,now: 2024-07-27 01:46:14.094431,epoch time: 0:01:24.518940,used: 0:02:53.763224,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_01_43_19_seed_2_23090486
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.96302354, 'precision': 0.96308327, 'recall': 0.9629879, 'specificity': 0.9629879, 'f1': 0.9630182, 'auroc': 0.99509215, 'binary_precision': 0.9594334, 'binary_recall': 0.96753246, 'binary_specificity': 0.9584433, 'binary_f1_score': 0.96346587}
confusion matrix:
      0     1
0  1453    63
1    50  1490
---- Validation: 
scalar performance:
{'acc': 0.8419405, 'precision': 0.84364194, 'recall': 0.84095365, 'specificity': 0.84095365, 'f1': 0.84137964, 'auroc': 0.9035076, 'binary_precision': 0.86206895, 'binary_recall': 0.8038585, 'binary_specificity': 0.8780488, 'binary_f1_score': 0.8319468}
confusion matrix:
     0    1
0  576   80
1  122  500
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8541667, 'precision': 0.8547826, 'recall': 0.8541666, 'specificity': 0.8541666, 'f1': 0.8541033, 'auroc': 0.9346708, 'binary_precision': 0.84, 'binary_recall': 0.875, 'binary_specificity': 0.8333333, 'binary_f1_score': 0.85714287}
confusion matrix:
     0    1
0  180   36
1   27  189
better model found
persisted
after epoch: 3,now: 2024-07-27 01:47:38.134907,epoch time: 0:01:24.040476,used: 0:04:17.803700,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_01_43_19_seed_2_23090486
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.976767, 'precision': 0.9771073, 'recall': 0.9768864, 'specificity': 0.9768864, 'f1': 0.9767657, 'auroc': 0.997053, 'binary_precision': 0.9919625, 'binary_recall': 0.96168834, 'binary_specificity': 0.99208444, 'binary_f1_score': 0.9765908}
confusion matrix:
      0     1
0  1504    12
1    59  1481
---- Validation: 
scalar performance:
{'acc': 0.7910798, 'precision': 0.7929821, 'recall': 0.7898694, 'specificity': 0.7898694, 'f1': 0.7901515, 'auroc': 0.86952984, 'binary_precision': 0.81085813, 'binary_recall': 0.74437296, 'binary_specificity': 0.83536583, 'binary_f1_score': 0.77619445}
confusion matrix:
     0    1
0  548  108
1  159  463
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8078704, 'precision': 0.8143451, 'recall': 0.8078704, 'specificity': 0.8078704, 'f1': 0.8068759, 'auroc': 0.90554273, 'binary_precision': 0.7692308, 'binary_recall': 0.8796296, 'binary_specificity': 0.7361111, 'binary_f1_score': 0.8207343}
confusion matrix:
     0    1
0  159   57
1   26  190
early stop counter: 1
val acc:0.7910798192024231, best validation acc: 0.8419405221939087, corresponding to test acc:                         0.8541666865348816 / 0.8726851940155029
after epoch: 4,now: 2024-07-27 01:49:02.063910,epoch time: 0:01:23.929003,used: 0:05:41.732703,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_01_43_19_seed_2_23090486
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9810209, 'precision': 0.9812013, 'recall': 0.9811123, 'specificity': 0.9811123, 'f1': 0.9810207, 'auroc': 0.9985163, 'binary_precision': 0.99268615, 'binary_recall': 0.9694805, 'binary_specificity': 0.9927441, 'binary_f1_score': 0.9809461}
confusion matrix:
      0     1
0  1505    11
1    47  1493
---- Validation: 
scalar performance:
{'acc': 0.7331768, 'precision': 0.79650795, 'recall': 0.7268841, 'specificity': 0.7268841, 'f1': 0.7144846, 'auroc': 0.892876, 'binary_precision': 0.92705166, 'binary_recall': 0.4903537, 'binary_specificity': 0.9634146, 'binary_f1_score': 0.6414301}
confusion matrix:
     0    1
0  632   24
1  317  305
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8078704, 'precision': 0.82921547, 'recall': 0.8078704, 'specificity': 0.8078704, 'f1': 0.80470484, 'auroc': 0.9024348, 'binary_precision': 0.9130435, 'binary_recall': 0.6805556, 'binary_specificity': 0.9351852, 'binary_f1_score': 0.7798409}
confusion matrix:
     0    1
0  202   14
1   69  147
early stop counter: 2
val acc:0.7331768274307251, best validation acc: 0.8419405221939087, corresponding to test acc:                         0.8541666865348816 / 0.8726851940155029
after epoch: 5,now: 2024-07-27 01:50:25.534395,epoch time: 0:01:23.470485,used: 0:07:05.203188,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_01_43_19_seed_2_23090486
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.98003924, 'precision': 0.9802072, 'recall': 0.980128, 'specificity': 0.980128, 'f1': 0.980039, 'auroc': 0.9978262, 'binary_precision': 0.99136215, 'binary_recall': 0.9688312, 'binary_specificity': 0.9914248, 'binary_f1_score': 0.9799672}
confusion matrix:
      0     1
0  1503    13
1    48  1492
---- Validation: 
scalar performance:
{'acc': 0.7605634, 'precision': 0.81375605, 'recall': 0.7549775, 'specificity': 0.7549775, 'f1': 0.7471839, 'auroc': 0.88982, 'binary_precision': 0.9364641, 'binary_recall': 0.54501605, 'binary_specificity': 0.964939, 'binary_f1_score': 0.6890244}
confusion matrix:
     0    1
0  633   23
1  283  339
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7986111, 'precision': 0.8209621, 'recall': 0.79861116, 'specificity': 0.79861116, 'f1': 0.79504293, 'auroc': 0.8960905, 'binary_precision': 0.9056604, 'binary_recall': 0.6666667, 'binary_specificity': 0.9305556, 'binary_f1_score': 0.76799995}
confusion matrix:
     0    1
0  201   15
1   72  144
early stop counter: 3
val acc:0.7605633735656738, best validation acc: 0.8419405221939087, corresponding to test acc:                         0.8541666865348816 / 0.8726851940155029
after epoch: 6,now: 2024-07-27 01:51:48.832054,epoch time: 0:01:23.297659,used: 0:08:28.500847,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_01_43_19_seed_2_23090486
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.986911, 'precision': 0.98697186, 'recall': 0.98697186, 'specificity': 0.98697186, 'f1': 0.98691106, 'auroc': 0.99842846, 'binary_precision': 0.99472296, 'binary_recall': 0.9792208, 'binary_specificity': 0.99472296, 'binary_f1_score': 0.98691106}
confusion matrix:
      0     1
0  1508     8
1    32  1508
---- Validation: 
scalar performance:
{'acc': 0.63380283, 'precision': 0.7290214, 'recall': 0.6249191, 'specificity': 0.6249191, 'f1': 0.58249867, 'auroc': 0.8255578, 'binary_precision': 0.8701923, 'binary_recall': 0.2909968, 'binary_specificity': 0.95884144, 'binary_f1_score': 0.43614456}
confusion matrix:
     0    1
0  629   27
1  441  181
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7986111, 'precision': 0.8263757, 'recall': 0.7986111, 'specificity': 0.7986111, 'f1': 0.79423505, 'auroc': 0.895769, 'binary_precision': 0.92156863, 'binary_recall': 0.6527778, 'binary_specificity': 0.9444444, 'binary_f1_score': 0.7642277}
confusion matrix:
     0    1
0  204   12
1   75  141
early stop counter: 4
val acc:0.6338028311729431, best validation acc: 0.8419405221939087, corresponding to test acc:                         0.8541666865348816 / 0.8726851940155029
after epoch: 7,now: 2024-07-27 01:53:12.348035,epoch time: 0:01:23.515981,used: 0:09:52.016828,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_01_43_19_seed_2_23090486
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9806937, 'precision': 0.98068786, 'recall': 0.98071563, 'specificity': 0.98071563, 'f1': 0.9806932, 'auroc': 0.9971285, 'binary_precision': 0.98367083, 'binary_recall': 0.9779221, 'binary_specificity': 0.98350924, 'binary_f1_score': 0.980788}
confusion matrix:
      0     1
0  1491    25
1    34  1506
---- Validation: 
scalar performance:
{'acc': 0.786385, 'precision': 0.806998, 'recall': 0.7828381, 'specificity': 0.7828381, 'f1': 0.7811856, 'auroc': 0.8596777, 'binary_precision': 0.8801743, 'binary_recall': 0.64951766, 'binary_specificity': 0.91615856, 'binary_f1_score': 0.747456}
confusion matrix:
     0    1
0  601   55
1  218  404
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8356481, 'precision': 0.84579456, 'recall': 0.8356482, 'specificity': 0.8356482, 'f1': 0.8344336, 'auroc': 0.91698813, 'binary_precision': 0.9050279, 'binary_recall': 0.75, 'binary_specificity': 0.9212963, 'binary_f1_score': 0.8202532}
confusion matrix:
     0    1
0  199   17
1   54  162
early stop counter: 5
val acc:0.7863849997520447, best validation acc: 0.8419405221939087, corresponding to test acc:                         0.8541666865348816 / 0.8726851940155029
after epoch: 8,now: 2024-07-27 01:54:35.737051,epoch time: 0:01:23.389016,used: 0:11:15.405844,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_01_43_19_seed_2_23090486
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 8 with time: 0:11:15.405844 at 2024-07-27 01:54:35.737051
persisted model performance metric: 

scalar performance:
{'acc': 0.8541667, 'precision': 0.8547826, 'recall': 0.8541666, 'specificity': 0.8541666, 'f1': 0.8541033, 'auroc': 0.9346708, 'binary_precision': 0.84, 'binary_recall': 0.875, 'binary_specificity': 0.8333333, 'binary_f1_score': 0.85714287}
confusion matrix:
     0    1
0  180   36
1   27  189
oracle model performance metric: 

scalar performance:
{'acc': 0.8726852, 'precision': 0.87774545, 'recall': 0.8726852, 'specificity': 0.8726852, 'f1': 0.8722574, 'auroc': 0.93306327, 'binary_precision': 0.921466, 'binary_recall': 0.8148148, 'binary_specificity': 0.9305556, 'binary_f1_score': 0.8648649}
confusion matrix:
     0    1
0  201   15
1   40  176
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_diva_irm_3seeds_nofreeze_2024-07-27_01-18-02/rule_results/13.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_diva_irm_3seeds_nofreeze_2024-07-27_01-18-02/confusion_matrix/13.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   1252 MiB |  14023 MiB |  57340 GiB |  57339 GiB |
|       from large pool |   1192 MiB |  13964 MiB |  56621 GiB |  56619 GiB |
|       from small pool |     59 MiB |     99 MiB |    719 GiB |    719 GiB |
|---------------------------------------------------------------------------|
| Active memory         |   1252 MiB |  14023 MiB |  57340 GiB |  57339 GiB |
|       from large pool |   1192 MiB |  13964 MiB |  56621 GiB |  56619 GiB |
|       from small pool |     59 MiB |     99 MiB |    719 GiB |    719 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |   1240 MiB |  14016 MiB |  57288 GiB |  57287 GiB |
|       from large pool |   1180 MiB |  13958 MiB |  56570 GiB |  56569 GiB |
|       from small pool |     59 MiB |     99 MiB |    717 GiB |    717 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  15066 MiB |  15172 MiB |  39184 MiB |  24118 MiB |
|       from large pool |  14960 MiB |  15066 MiB |  39000 MiB |  24040 MiB |
|       from small pool |    106 MiB |    112 MiB |    184 MiB |     78 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |   2001 MiB |   3229 MiB |  45463 GiB |  45461 GiB |
|       from large pool |   1991 MiB |   3221 MiB |  44740 GiB |  44739 GiB |
|       from small pool |     10 MiB |     44 MiB |    722 GiB |    722 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    1792    |    3107    |   10348 K  |   10347 K  |
|       from large pool |     269    |    1495    |    5123 K  |    5123 K  |
|       from small pool |    1523    |    2231    |    5225 K  |    5224 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    1792    |    3107    |   10348 K  |   10347 K  |
|       from large pool |     269    |    1495    |    5123 K  |    5123 K  |
|       from small pool |    1523    |    2231    |    5225 K  |    5224 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     551    |     593    |    1516    |     965    |
|       from large pool |     498    |     540    |    1424    |     926    |
|       from small pool |      53    |      56    |      92    |      39    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     136    |     582    |    6563 K  |    6563 K  |
|       from large pool |      54    |     534    |    3692 K  |    3691 K  |
|       from small pool |      82    |     240    |    2871 K  |    2871 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  14023 MiB |  57340 GiB |  57340 GiB |
|       from large pool |  16640 KiB |  13964 MiB |  56621 GiB |  56621 GiB |
|       from small pool |      0 KiB |     99 MiB |    719 GiB |    719 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  14023 MiB |  57340 GiB |  57340 GiB |
|       from large pool |  16640 KiB |  13964 MiB |  56621 GiB |  56621 GiB |
|       from small pool |      0 KiB |     99 MiB |    719 GiB |    719 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  14016 MiB |  57288 GiB |  57288 GiB |
|       from large pool |  16640 KiB |  13958 MiB |  56570 GiB |  56570 GiB |
|       from small pool |      0 KiB |     99 MiB |    717 GiB |    717 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   3254 MiB |  15172 MiB |  39184 MiB |  35930 MiB |
|       from large pool |   3184 MiB |  15066 MiB |  39000 MiB |  35816 MiB |
|       from small pool |     70 MiB |    112 MiB |    184 MiB |    114 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   3229 MiB |  45464 GiB |  45463 GiB |
|       from large pool |  24320 KiB |   3221 MiB |  44741 GiB |  44741 GiB |
|       from small pool |      0 KiB |     48 MiB |    722 GiB |    722 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3107    |   10348 K  |   10348 K  |
|       from large pool |       2    |    1495    |    5123 K  |    5123 K  |
|       from small pool |       0    |    2231    |    5225 K  |    5225 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3107    |   10348 K  |   10348 K  |
|       from large pool |       2    |    1495    |    5123 K  |    5123 K  |
|       from small pool |       0    |    2231    |    5225 K  |    5225 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      96    |     593    |    1516    |    1420    |
|       from large pool |      61    |     540    |    1424    |    1363    |
|       from small pool |      35    |      56    |      92    |      57    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       2    |     582    |    6564 K  |    6564 K  |
|       from large pool |       2    |     534    |    3692 K  |    3692 K  |
|       from small pool |       0    |     240    |    2872 K  |    2872 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Sat Jul 27 01:54:46 2024]
Finished job 0.
1 of 1 steps (100%) done
