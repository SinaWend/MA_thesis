Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Sat Jul 27 01:47:42 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_diva_irm_3seeds_nofreeze_2024-07-27_01-18-02/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_diva_irm_3seeds_nofreeze_2024-07-27_01-18-02/rule_results/14.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=14
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/var/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/swiglu_ffn.py:51: UserWarning: xFormers is not available (SwiGLU)
  warnings.warn("xFormers is not available (SwiGLU)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/attention.py:33: UserWarning: xFormers is not available (Attention)
  warnings.warn("xFormers is not available (Attention)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/block.py:40: UserWarning: xFormers is not available (Block)
  warnings.warn("xFormers is not available (Block)")
Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main

using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_01_48_58_seed_0_23090488

 Experiment start at: 2024-07-27 01:48:59.223124
before training, model accuracy: 0.5093023180961609
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9397786, 'precision': 0.9404679, 'recall': 0.94008344, 'specificity': 0.94008344, 'f1': 0.9397733, 'auroc': 0.9855981, 'binary_precision': 0.96164197, 'binary_recall': 0.91779065, 'binary_specificity': 0.96237624, 'binary_f1_score': 0.9392047}
confusion matrix:
      0     1
0  1458    57
1   128  1429
---- Validation: 
scalar performance:
{'acc': 0.742236, 'precision': 0.7914376, 'recall': 0.74507236, 'specificity': 0.74507236, 'f1': 0.7323117, 'auroc': 0.85619855, 'binary_precision': 0.6681465, 'binary_recall': 0.9480315, 'binary_specificity': 0.5421133, 'binary_f1_score': 0.7838541}
confusion matrix:
     0    1
0  354  299
1   33  602
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.74186045, 'precision': 0.784218, 'recall': 0.74186045, 'specificity': 0.74186045, 'f1': 0.73187053, 'auroc': 0.87225527, 'binary_precision': 0.67449665, 'binary_recall': 0.9348837, 'binary_specificity': 0.5488372, 'binary_f1_score': 0.7836258}
confusion matrix:
     0    1
0  118   97
1   14  201
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-27 01:49:49.667728,epoch time: 0:00:50.444604,used: 0:00:50.444604,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_01_48_58_seed_0_23090488
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.96223956, 'precision': 0.96222055, 'recall': 0.96225035, 'specificity': 0.96225035, 'f1': 0.9622338, 'auroc': 0.99439853, 'binary_precision': 0.96394074, 'binary_recall': 0.96146435, 'binary_specificity': 0.9630363, 'binary_f1_score': 0.96270096}
confusion matrix:
      0     1
0  1459    56
1    60  1497
---- Validation: 
scalar performance:
{'acc': 0.7531056, 'precision': 0.8007711, 'recall': 0.7558573, 'specificity': 0.7558573, 'f1': 0.7442248, 'auroc': 0.8943459, 'binary_precision': 0.6774916, 'binary_recall': 0.9527559, 'binary_specificity': 0.55895865, 'binary_f1_score': 0.7918848}
confusion matrix:
     0    1
0  365  288
1   30  605
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.727907, 'precision': 0.7803651, 'recall': 0.72790694, 'specificity': 0.72790694, 'f1': 0.7145548, 'auroc': 0.90228236, 'binary_precision': 0.65909094, 'binary_recall': 0.94418603, 'binary_specificity': 0.5116279, 'binary_f1_score': 0.7762906}
confusion matrix:
     0    1
0  110  105
1   12  203
better model found
persisted
after epoch: 2,now: 2024-07-27 01:50:36.378403,epoch time: 0:00:46.710675,used: 0:01:37.155279,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_01_48_58_seed_0_23090488
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9355469, 'precision': 0.9414699, 'recall': 0.93485236, 'specificity': 0.93485236, 'f1': 0.93525004, 'auroc': 0.9953123, 'binary_precision': 0.8933333, 'binary_recall': 0.9909968, 'binary_specificity': 0.878708, 'binary_f1_score': 0.93963414}
confusion matrix:
      0     1
0  1333   184
1    14  1541
---- Validation: 
scalar performance:
{'acc': 0.67624223, 'precision': 0.77055347, 'recall': 0.68031377, 'specificity': 0.68031377, 'f1': 0.64830744, 'auroc': 0.8609519, 'binary_precision': 0.6072835, 'binary_recall': 0.9716535, 'binary_specificity': 0.38897398, 'binary_f1_score': 0.74742573}
confusion matrix:
     0    1
0  254  399
1   18  617
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.627907, 'precision': 0.73736405, 'recall': 0.627907, 'specificity': 0.627907, 'f1': 0.57942104, 'auroc': 0.8614819, 'binary_precision': 0.5761773, 'binary_recall': 0.96744186, 'binary_specificity': 0.2883721, 'binary_f1_score': 0.72222227}
confusion matrix:
    0    1
0  62  153
1   7  208
early stop counter: 1
val acc:0.6762422323226929, best validation acc: 0.7531055808067322, corresponding to test acc:                         0.7279070019721985 / 0.7418604493141174
after epoch: 3,now: 2024-07-27 01:51:22.603527,epoch time: 0:00:46.225124,used: 0:02:23.380403,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_01_48_58_seed_0_23090488
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.97558594, 'precision': 0.9758474, 'recall': 0.975781, 'specificity': 0.975781, 'f1': 0.9755858, 'auroc': 0.9978922, 'binary_precision': 0.99072236, 'binary_recall': 0.9607969, 'binary_specificity': 0.99076515, 'binary_f1_score': 0.97553015}
confusion matrix:
      0     1
0  1502    14
1    61  1495
---- Validation: 
scalar performance:
{'acc': 0.79037267, 'precision': 0.7945021, 'recall': 0.7911782, 'specificity': 0.7911782, 'f1': 0.78991675, 'auroc': 0.8864671, 'binary_precision': 0.7559607, 'binary_recall': 0.8488189, 'binary_specificity': 0.7335375, 'binary_f1_score': 0.79970324}
confusion matrix:
     0    1
0  479  174
1   96  539
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.75813955, 'precision': 0.78499603, 'recall': 0.7581395, 'specificity': 0.7581395, 'f1': 0.7523041, 'auroc': 0.9135965, 'binary_precision': 0.6975089, 'binary_recall': 0.9116279, 'binary_specificity': 0.60465115, 'binary_f1_score': 0.79032254}
confusion matrix:
     0    1
0  130   85
1   19  196
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-07-27 01:52:10.000181,epoch time: 0:00:47.396654,used: 0:03:10.777057,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_01_48_58_seed_0_23090488
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.97558594, 'precision': 0.97608685, 'recall': 0.9758529, 'specificity': 0.9758529, 'f1': 0.97558504, 'auroc': 0.9979905, 'binary_precision': 0.99532086, 'binary_recall': 0.95632625, 'binary_specificity': 0.99537957, 'binary_f1_score': 0.97543406}
confusion matrix:
      0     1
0  1508     7
1    68  1489
---- Validation: 
scalar performance:
{'acc': 0.67236024, 'precision': 0.77271605, 'recall': 0.6680638, 'specificity': 0.6680638, 'f1': 0.63581693, 'auroc': 0.87048995, 'binary_precision': 0.9346939, 'binary_recall': 0.36062992, 'binary_specificity': 0.9754977, 'binary_f1_score': 0.5204545}
confusion matrix:
     0    1
0  637   16
1  406  229
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.81395346, 'precision': 0.85878515, 'recall': 0.8139535, 'specificity': 0.8139535, 'f1': 0.8079542, 'auroc': 0.9077339, 'binary_precision': 0.9856115, 'binary_recall': 0.6372093, 'binary_specificity': 0.9906977, 'binary_f1_score': 0.77401125}
confusion matrix:
     0    1
0  213    2
1   78  137
new oracle model saved
early stop counter: 1
val acc:0.6723602414131165, best validation acc: 0.7903726696968079, corresponding to test acc:                         0.7581395506858826 / 0.8139534592628479
after epoch: 5,now: 2024-07-27 01:52:56.986749,epoch time: 0:00:46.986568,used: 0:03:57.763625,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_01_48_58_seed_0_23090488
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9824219, 'precision': 0.982437, 'recall': 0.9825254, 'specificity': 0.9825254, 'f1': 0.9824213, 'auroc': 0.99715626, 'binary_precision': 0.99021524, 'binary_recall': 0.9749518, 'binary_specificity': 0.990099, 'binary_f1_score': 0.9825243}
confusion matrix:
      0     1
0  1500    15
1    39  1518
---- Validation: 
scalar performance:
{'acc': 0.7476708, 'precision': 0.7625253, 'recall': 0.74596107, 'specificity': 0.74596107, 'f1': 0.74314344, 'auroc': 0.8426957, 'binary_precision': 0.8215768, 'binary_recall': 0.62362206, 'binary_specificity': 0.86830014, 'binary_f1_score': 0.70904213}
confusion matrix:
     0    1
0  567   86
1  239  396
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.81627905, 'precision': 0.8163407, 'recall': 0.81627905, 'specificity': 0.81627905, 'f1': 0.8162701, 'auroc': 0.87123847, 'binary_precision': 0.8207547, 'binary_recall': 0.80930233, 'binary_specificity': 0.82325584, 'binary_f1_score': 0.81498826}
confusion matrix:
     0    1
0  177   38
1   41  174
new oracle model saved
early stop counter: 2
val acc:0.7476708292961121, best validation acc: 0.7903726696968079, corresponding to test acc:                         0.7581395506858826 / 0.8162790536880493
after epoch: 6,now: 2024-07-27 01:53:44.068068,epoch time: 0:00:47.081319,used: 0:04:44.844944,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_01_48_58_seed_0_23090488
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.96744794, 'precision': 0.9690594, 'recall': 0.9678663, 'specificity': 0.9678663, 'f1': 0.9674355, 'auroc': 0.997138, 'binary_precision': 1.0, 'binary_recall': 0.93573266, 'binary_specificity': 1.0, 'binary_f1_score': 0.9667995}
confusion matrix:
      0     1
0  1516     0
1   100  1456
---- Validation: 
scalar performance:
{'acc': 0.6257764, 'precision': 0.7726625, 'recall': 0.620581, 'specificity': 0.620581, 'f1': 0.5624494, 'auroc': 0.8880949, 'binary_precision': 0.9693251, 'binary_recall': 0.2488189, 'binary_specificity': 0.992343, 'binary_f1_score': 0.39598995}
confusion matrix:
     0    1
0  648    5
1  477  158
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6744186, 'precision': 0.80281687, 'recall': 0.67441857, 'specificity': 0.67441857, 'f1': 0.6358137, 'auroc': 0.90820986, 'binary_precision': 1.0, 'binary_recall': 0.3488372, 'binary_specificity': 1.0, 'binary_f1_score': 0.51724136}
confusion matrix:
     0   1
0  215   0
1  140  75
early stop counter: 3
val acc:0.6257764101028442, best validation acc: 0.7903726696968079, corresponding to test acc:                         0.7581395506858826 / 0.8162790536880493
after epoch: 7,now: 2024-07-27 01:54:30.808448,epoch time: 0:00:46.740380,used: 0:05:31.585324,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_01_48_58_seed_0_23090488
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.98307294, 'precision': 0.9830682, 'recall': 0.98317635, 'specificity': 0.98317635, 'f1': 0.98307186, 'auroc': 0.9988159, 'binary_precision': 0.99024075, 'binary_recall': 0.97626686, 'binary_specificity': 0.9900859, 'binary_f1_score': 0.9832041}
confusion matrix:
      0     1
0  1498    15
1    37  1522
---- Validation: 
scalar performance:
{'acc': 0.7826087, 'precision': 0.8088057, 'recall': 0.78054774, 'specificity': 0.78054774, 'f1': 0.777015, 'auroc': 0.8876482, 'binary_precision': 0.8953229, 'binary_recall': 0.6330709, 'binary_specificity': 0.92802453, 'binary_f1_score': 0.74169743}
confusion matrix:
     0    1
0  606   47
1  233  402
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8372093, 'precision': 0.8564894, 'recall': 0.8372093, 'specificity': 0.8372093, 'f1': 0.8349781, 'auroc': 0.91262305, 'binary_precision': 0.93939394, 'binary_recall': 0.7209302, 'binary_specificity': 0.95348835, 'binary_f1_score': 0.81578946}
confusion matrix:
     0    1
0  205   10
1   60  155
new oracle model saved
early stop counter: 4
val acc:0.782608687877655, best validation acc: 0.7903726696968079, corresponding to test acc:                         0.7581395506858826 / 0.8372092843055725
after epoch: 8,now: 2024-07-27 01:55:17.463861,epoch time: 0:00:46.655413,used: 0:06:18.240737,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_01_48_58_seed_0_23090488
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.95703125, 'precision': 0.9591419, 'recall': 0.95663804, 'specificity': 0.95663804, 'f1': 0.95694935, 'auroc': 0.9976226, 'binary_precision': 0.93095094, 'binary_recall': 0.9884244, 'binary_specificity': 0.92485166, 'binary_f1_score': 0.9588272}
confusion matrix:
      0     1
0  1403   114
1    18  1537
---- Validation: 
scalar performance:
{'acc': 0.8167702, 'precision': 0.8314699, 'recall': 0.81823206, 'specificity': 0.81823206, 'f1': 0.81516576, 'auroc': 0.9078318, 'binary_precision': 0.75808537, 'binary_recall': 0.92283463, 'binary_specificity': 0.7136294, 'binary_f1_score': 0.8323864}
confusion matrix:
     0    1
0  466  187
1   49  586
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.81627905, 'precision': 0.82821476, 'recall': 0.81627905, 'specificity': 0.81627905, 'f1': 0.81459343, 'auroc': 0.9219037, 'binary_precision': 0.765625, 'binary_recall': 0.9116279, 'binary_specificity': 0.7209302, 'binary_f1_score': 0.83227175}
confusion matrix:
     0    1
0  155   60
1   19  196
better model found
persisted
after epoch: 9,now: 2024-07-27 01:56:04.285560,epoch time: 0:00:46.821699,used: 0:07:05.062436,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_01_48_58_seed_0_23090488
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.98339844, 'precision': 0.9836233, 'recall': 0.9835956, 'specificity': 0.9835956, 'f1': 0.98339844, 'auroc': 0.9983467, 'binary_precision': 0.9980159, 'binary_recall': 0.96917146, 'binary_specificity': 0.9980198, 'binary_f1_score': 0.98338217}
confusion matrix:
      0     1
0  1512     3
1    48  1509
---- Validation: 
scalar performance:
{'acc': 0.72670805, 'precision': 0.7869395, 'recall': 0.7234641, 'specificity': 0.7234641, 'f1': 0.70967215, 'auroc': 0.89787656, 'binary_precision': 0.91495603, 'binary_recall': 0.49133858, 'binary_specificity': 0.9555896, 'binary_f1_score': 0.6393443}
confusion matrix:
     0    1
0  624   29
1  323  312
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7837209, 'precision': 0.8206915, 'recall': 0.7837209, 'specificity': 0.7837209, 'f1': 0.77730256, 'auroc': 0.9018713, 'binary_precision': 0.92957747, 'binary_recall': 0.6139535, 'binary_specificity': 0.95348835, 'binary_f1_score': 0.7394958}
confusion matrix:
     0    1
0  205   10
1   83  132
early stop counter: 1
val acc:0.7267080545425415, best validation acc: 0.8167701959609985, corresponding to test acc:                         0.8162790536880493 / 0.8372092843055725
after epoch: 10,now: 2024-07-27 01:56:50.547977,epoch time: 0:00:46.262417,used: 0:07:51.324853,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_01_48_58_seed_0_23090488
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9781901, 'precision': 0.97869277, 'recall': 0.97845757, 'specificity': 0.97845757, 'f1': 0.9781893, 'auroc': 0.99882317, 'binary_precision': 0.99799466, 'binary_recall': 0.9588953, 'binary_specificity': 0.9980198, 'binary_f1_score': 0.9780544}
confusion matrix:
      0     1
0  1512     3
1    64  1493
---- Validation: 
scalar performance:
{'acc': 0.8291925, 'precision': 0.8451148, 'recall': 0.8276832, 'specificity': 0.8276832, 'f1': 0.82671535, 'auroc': 0.9261917, 'binary_precision': 0.9158317, 'binary_recall': 0.719685, 'binary_specificity': 0.93568146, 'binary_f1_score': 0.80599654}
confusion matrix:
     0    1
0  611   42
1  178  457
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.76046515, 'precision': 0.82703173, 'recall': 0.76046515, 'specificity': 0.76046515, 'f1': 0.7476224, 'auroc': 0.9193727, 'binary_precision': 0.9745763, 'binary_recall': 0.53488374, 'binary_specificity': 0.9860465, 'binary_f1_score': 0.6906907}
confusion matrix:
     0    1
0  212    3
1  100  115
better model found
persisted
after epoch: 11,now: 2024-07-27 01:57:37.389271,epoch time: 0:00:46.841294,used: 0:08:38.166147,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_01_48_58_seed_0_23090488
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.98079425, 'precision': 0.9812579, 'recall': 0.9810533, 'specificity': 0.9810533, 'f1': 0.9807937, 'auroc': 0.9987837, 'binary_precision': 1.0, 'binary_recall': 0.9621066, 'binary_specificity': 1.0, 'binary_f1_score': 0.9806874}
confusion matrix:
      0     1
0  1515     0
1    59  1498
---- Validation: 
scalar performance:
{'acc': 0.7468944, 'precision': 0.8062717, 'recall': 0.7437846, 'specificity': 0.7437846, 'f1': 0.7323754, 'auroc': 0.91290104, 'binary_precision': 0.937677, 'binary_recall': 0.52125984, 'binary_specificity': 0.96630937, 'binary_f1_score': 0.6700404}
confusion matrix:
     0    1
0  631   22
1  304  331
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.67209303, 'precision': 0.7787707, 'recall': 0.67209303, 'specificity': 0.67209303, 'f1': 0.6374042, 'auroc': 0.90113574, 'binary_precision': 0.9512195, 'binary_recall': 0.3627907, 'binary_specificity': 0.98139536, 'binary_f1_score': 0.5252525}
confusion matrix:
     0   1
0  211   4
1  137  78
early stop counter: 1
val acc:0.7468944191932678, best validation acc: 0.8291925191879272, corresponding to test acc:                         0.760465145111084 / 0.8372092843055725
after epoch: 12,now: 2024-07-27 01:58:23.700700,epoch time: 0:00:46.311429,used: 0:09:24.477576,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_01_48_58_seed_0_23090488
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9794922, 'precision': 0.97998345, 'recall': 0.97977245, 'specificity': 0.97977245, 'f1': 0.97949153, 'auroc': 0.99951416, 'binary_precision': 0.999332, 'binary_recall': 0.9602054, 'binary_specificity': 0.9993395, 'binary_f1_score': 0.97937804}
confusion matrix:
      0     1
0  1513     1
1    62  1496
---- Validation: 
scalar performance:
{'acc': 0.6583851, 'precision': 0.7614174, 'recall': 0.653934, 'specificity': 0.653934, 'f1': 0.6173035, 'auroc': 0.8937237, 'binary_precision': 0.9220779, 'binary_recall': 0.33543307, 'binary_specificity': 0.97243494, 'binary_f1_score': 0.49191687}
confusion matrix:
     0    1
0  635   18
1  422  213
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7837209, 'precision': 0.83927464, 'recall': 0.7837209, 'specificity': 0.7837209, 'f1': 0.7744895, 'auroc': 0.92941046, 'binary_precision': 0.9765625, 'binary_recall': 0.5813953, 'binary_specificity': 0.9860465, 'binary_f1_score': 0.72886294}
confusion matrix:
     0    1
0  212    3
1   90  125
early stop counter: 2
val acc:0.6583850979804993, best validation acc: 0.8291925191879272, corresponding to test acc:                         0.760465145111084 / 0.8372092843055725
after epoch: 13,now: 2024-07-27 01:59:10.100223,epoch time: 0:00:46.399523,used: 0:10:10.877099,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_01_48_58_seed_0_23090488
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.976888, 'precision': 0.97758174, 'recall': 0.9771766, 'specificity': 0.9771766, 'f1': 0.9768859, 'auroc': 0.99924797, 'binary_precision': 0.9993275, 'binary_recall': 0.95501286, 'binary_specificity': 0.99934036, 'binary_f1_score': 0.97666776}
confusion matrix:
      0     1
0  1515     1
1    70  1486
---- Validation: 
scalar performance:
{'acc': 0.67624223, 'precision': 0.77006114, 'recall': 0.6720659, 'specificity': 0.6720659, 'f1': 0.64225435, 'auroc': 0.90023273, 'binary_precision': 0.92578125, 'binary_recall': 0.37322834, 'binary_specificity': 0.9709035, 'binary_f1_score': 0.53198653}
confusion matrix:
     0    1
0  634   19
1  398  237
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7790698, 'precision': 0.81111324, 'recall': 0.7790698, 'specificity': 0.7790698, 'f1': 0.7732307, 'auroc': 0.8942131, 'binary_precision': 0.9109589, 'binary_recall': 0.61860466, 'binary_specificity': 0.9395349, 'binary_f1_score': 0.7368421}
confusion matrix:
     0    1
0  202   13
1   82  133
early stop counter: 3
val acc:0.6762422323226929, best validation acc: 0.8291925191879272, corresponding to test acc:                         0.760465145111084 / 0.8372092843055725
after epoch: 14,now: 2024-07-27 01:59:56.407220,epoch time: 0:00:46.306997,used: 0:10:57.184096,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_01_48_58_seed_0_23090488
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9814453, 'precision': 0.98169905, 'recall': 0.98165107, 'specificity': 0.98165107, 'f1': 0.98144525, 'auroc': 0.9990041, 'binary_precision': 0.9966887, 'binary_recall': 0.96660244, 'binary_specificity': 0.9966997, 'binary_f1_score': 0.98141503}
confusion matrix:
      0     1
0  1510     5
1    52  1505
---- Validation: 
scalar performance:
{'acc': 0.8369565, 'precision': 0.837137, 'recall': 0.83677274, 'specificity': 0.83677274, 'f1': 0.83685577, 'auroc': 0.9004594, 'binary_precision': 0.84219, 'binary_recall': 0.82362205, 'binary_specificity': 0.84992343, 'binary_f1_score': 0.83280253}
confusion matrix:
     0    1
0  555   98
1  112  523
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.83255816, 'precision': 0.83301926, 'recall': 0.83255816, 'specificity': 0.83255816, 'f1': 0.83250016, 'auroc': 0.9117577, 'binary_precision': 0.8206278, 'binary_recall': 0.8511628, 'binary_specificity': 0.81395346, 'binary_f1_score': 0.83561647}
confusion matrix:
     0    1
0  175   40
1   32  183
better model found
persisted
after epoch: 15,now: 2024-07-27 02:00:43.473852,epoch time: 0:00:47.066632,used: 0:11:44.250728,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_01_48_58_seed_0_23090488
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.97753906, 'precision': 0.97811425, 'recall': 0.97783756, 'specificity': 0.97783756, 'f1': 0.977538, 'auroc': 0.9990279, 'binary_precision': 0.9986604, 'binary_recall': 0.95699614, 'binary_specificity': 0.998679, 'binary_f1_score': 0.97738445}
confusion matrix:
      0     1
0  1512     2
1    67  1491
---- Validation: 
scalar performance:
{'acc': 0.76009315, 'precision': 0.80737233, 'recall': 0.7573223, 'specificity': 0.7573223, 'f1': 0.74915147, 'auroc': 0.9050633, 'binary_precision': 0.9244792, 'binary_recall': 0.5590551, 'binary_specificity': 0.9555896, 'binary_f1_score': 0.6967615}
confusion matrix:
     0    1
0  624   29
1  280  355
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8116279, 'precision': 0.8574797, 'recall': 0.8116279, 'specificity': 0.8116279, 'f1': 0.8053875, 'auroc': 0.93220115, 'binary_precision': 0.98550725, 'binary_recall': 0.63255817, 'binary_specificity': 0.9906977, 'binary_f1_score': 0.77053833}
confusion matrix:
     0    1
0  213    2
1   79  136
early stop counter: 1
val acc:0.7600931525230408, best validation acc: 0.8369565010070801, corresponding to test acc:                         0.8325581550598145 / 0.8372092843055725
after epoch: 16,now: 2024-07-27 02:01:29.852462,epoch time: 0:00:46.378610,used: 0:12:30.629338,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_01_48_58_seed_0_23090488
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.98372394, 'precision': 0.9838443, 'recall': 0.98387384, 'specificity': 0.98387384, 'f1': 0.9837239, 'auroc': 0.99916315, 'binary_precision': 0.99539477, 'binary_recall': 0.972365, 'binary_specificity': 0.9953826, 'binary_f1_score': 0.9837451}
confusion matrix:
      0     1
0  1509     7
1    43  1513
---- Validation: 
scalar performance:
{'acc': 0.71428573, 'precision': 0.79528666, 'recall': 0.7105835, 'specificity': 0.7105835, 'f1': 0.6909394, 'auroc': 0.91247237, 'binary_precision': 0.9464883, 'binary_recall': 0.4456693, 'binary_specificity': 0.9754977, 'binary_f1_score': 0.6059958}
confusion matrix:
     0    1
0  637   16
1  352  283
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7651163, 'precision': 0.81994045, 'recall': 0.76511633, 'specificity': 0.76511633, 'f1': 0.7546037, 'auroc': 0.89990807, 'binary_precision': 0.95238096, 'binary_recall': 0.55813956, 'binary_specificity': 0.97209305, 'binary_f1_score': 0.70381236}
confusion matrix:
     0    1
0  209    6
1   95  120
early stop counter: 2
val acc:0.7142857313156128, best validation acc: 0.8369565010070801, corresponding to test acc:                         0.8325581550598145 / 0.8372092843055725
after epoch: 17,now: 2024-07-27 02:02:16.199771,epoch time: 0:00:46.347309,used: 0:13:16.976647,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_01_48_58_seed_0_23090488
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9895833, 'precision': 0.9896217, 'recall': 0.9896865, 'specificity': 0.9896865, 'f1': 0.9895832, 'auroc': 0.99946547, 'binary_precision': 0.99803793, 'binary_recall': 0.9813505, 'binary_specificity': 0.99802244, 'binary_f1_score': 0.98962384}
confusion matrix:
      0     1
0  1514     3
1    29  1526
---- Validation: 
scalar performance:
{'acc': 0.76785713, 'precision': 0.7946552, 'recall': 0.76571727, 'specificity': 0.76571727, 'f1': 0.7614553, 'auroc': 0.88501287, 'binary_precision': 0.8800905, 'binary_recall': 0.6125984, 'binary_specificity': 0.9188361, 'binary_f1_score': 0.72237694}
confusion matrix:
     0    1
0  600   53
1  246  389
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.81627905, 'precision': 0.8248889, 'recall': 0.81627905, 'specificity': 0.81627905, 'f1': 0.8150538, 'auroc': 0.88718224, 'binary_precision': 0.87777776, 'binary_recall': 0.7348837, 'binary_specificity': 0.89767444, 'binary_f1_score': 0.8}
confusion matrix:
     0    1
0  193   22
1   57  158
early stop counter: 3
val acc:0.7678571343421936, best validation acc: 0.8369565010070801, corresponding to test acc:                         0.8325581550598145 / 0.8372092843055725
after epoch: 18,now: 2024-07-27 02:03:02.496196,epoch time: 0:00:46.296425,used: 0:14:03.273072,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_01_48_58_seed_0_23090488
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9765625, 'precision': 0.9766156, 'recall': 0.97651863, 'specificity': 0.97651863, 'f1': 0.9765568, 'auroc': 0.9972861, 'binary_precision': 0.9738019, 'binary_recall': 0.98006433, 'binary_specificity': 0.972973, 'binary_f1_score': 0.97692305}
confusion matrix:
      0     1
0  1476    41
1    31  1524
---- Validation: 
scalar performance:
{'acc': 0.79891306, 'precision': 0.81351686, 'recall': 0.80040395, 'specificity': 0.80040395, 'f1': 0.7970623, 'auroc': 0.90517354, 'binary_precision': 0.742268, 'binary_recall': 0.9070866, 'binary_specificity': 0.6937213, 'binary_f1_score': 0.8164422}
confusion matrix:
     0    1
0  453  200
1   59  576
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8, 'precision': 0.8186393, 'recall': 0.79999995, 'specificity': 0.79999995, 'f1': 0.79703176, 'auroc': 0.9162141, 'binary_precision': 0.74157304, 'binary_recall': 0.9209302, 'binary_specificity': 0.67906976, 'binary_f1_score': 0.8215768}
confusion matrix:
     0    1
0  146   69
1   17  198
early stop counter: 4
val acc:0.7989130616188049, best validation acc: 0.8369565010070801, corresponding to test acc:                         0.8325581550598145 / 0.8372092843055725
after epoch: 19,now: 2024-07-27 02:03:48.841943,epoch time: 0:00:46.345747,used: 0:14:49.618819,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_01_48_58_seed_0_23090488
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.97233075, 'precision': 0.97295505, 'recall': 0.97211635, 'specificity': 0.97211635, 'f1': 0.97230744, 'auroc': 0.99779725, 'binary_precision': 0.9588529, 'binary_recall': 0.987797, 'binary_specificity': 0.9564356, 'binary_f1_score': 0.9731098}
confusion matrix:
      0     1
0  1449    66
1    19  1538
---- Validation: 
scalar performance:
{'acc': 0.76475155, 'precision': 0.79286635, 'recall': 0.76688695, 'specificity': 0.76688695, 'f1': 0.75990474, 'auroc': 0.8542885, 'binary_precision': 0.6985646, 'binary_recall': 0.91968507, 'binary_specificity': 0.61408883, 'binary_f1_score': 0.7940177}
confusion matrix:
     0    1
0  401  252
1   51  584
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.74883723, 'precision': 0.7764958, 'recall': 0.74883723, 'specificity': 0.74883723, 'f1': 0.742395, 'auroc': 0.8518064, 'binary_precision': 0.68904597, 'binary_recall': 0.90697676, 'binary_specificity': 0.59069765, 'binary_f1_score': 0.78313255}
confusion matrix:
     0    1
0  127   88
1   20  195
early stop counter: 5
val acc:0.7647515535354614, best validation acc: 0.8369565010070801, corresponding to test acc:                         0.8325581550598145 / 0.8372092843055725
after epoch: 20,now: 2024-07-27 02:04:35.161527,epoch time: 0:00:46.319584,used: 0:15:35.938403,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_01_48_58_seed_0_23090488
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 20 with time: 0:15:35.938403 at 2024-07-27 02:04:35.161527
persisted model performance metric: 

scalar performance:
{'acc': 0.83255816, 'precision': 0.83301926, 'recall': 0.83255816, 'specificity': 0.83255816, 'f1': 0.83250016, 'auroc': 0.9117577, 'binary_precision': 0.8206278, 'binary_recall': 0.8511628, 'binary_specificity': 0.81395346, 'binary_f1_score': 0.83561647}
confusion matrix:
     0    1
0  175   40
1   32  183
oracle model performance metric: 

scalar performance:
{'acc': 0.8372093, 'precision': 0.8564894, 'recall': 0.8372093, 'specificity': 0.8372093, 'f1': 0.8349781, 'auroc': 0.91262305, 'binary_precision': 0.93939394, 'binary_recall': 0.7209302, 'binary_specificity': 0.95348835, 'binary_f1_score': 0.81578946}
confusion matrix:
     0    1
0  205   10
1   60  155
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_diva_irm_3seeds_nofreeze_2024-07-27_01-18-02/rule_results/14.csv
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_diva_irm_3seeds_nofreeze_2024-07-27_01-18-02/rule_results/14.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_diva_irm_3seeds_nofreeze_2024-07-27_01-18-02/confusion_matrix/14.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   1124 MiB |  13895 MiB |  49328 GiB |  49327 GiB |
|       from large pool |   1064 MiB |  13836 MiB |  48715 GiB |  48714 GiB |
|       from small pool |     60 MiB |     97 MiB |    612 GiB |    612 GiB |
|---------------------------------------------------------------------------|
| Active memory         |   1124 MiB |  13895 MiB |  49328 GiB |  49327 GiB |
|       from large pool |   1064 MiB |  13836 MiB |  48715 GiB |  48714 GiB |
|       from small pool |     60 MiB |     97 MiB |    612 GiB |    612 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |   1113 MiB |  13889 MiB |  49286 GiB |  49285 GiB |
|       from large pool |   1053 MiB |  13830 MiB |  48675 GiB |  48674 GiB |
|       from small pool |     60 MiB |     97 MiB |    611 GiB |    611 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  15030 MiB |  15030 MiB |  15030 MiB |      0 B   |
|       from large pool |  14924 MiB |  14924 MiB |  14924 MiB |      0 B   |
|       from small pool |    106 MiB |    106 MiB |    106 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |   1885 MiB |   2306 MiB |  36751 GiB |  36749 GiB |
|       from large pool |   1873 MiB |   2299 MiB |  36136 GiB |  36134 GiB |
|       from small pool |     11 MiB |     17 MiB |    615 GiB |    615 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    1792    |    3103    |    8848 K  |    8846 K  |
|       from large pool |     269    |    1495    |    4399 K  |    4399 K  |
|       from small pool |    1523    |    2219    |    4449 K  |    4447 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    1792    |    3103    |    8848 K  |    8846 K  |
|       from large pool |     269    |    1495    |    4399 K  |    4399 K  |
|       from small pool |    1523    |    2219    |    4449 K  |    4447 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     588    |     588    |     588    |       0    |
|       from large pool |     535    |     535    |     535    |       0    |
|       from small pool |      53    |      53    |      53    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     134    |     573    |    5434 K  |    5434 K  |
|       from large pool |      49    |     528    |    2976 K  |    2976 K  |
|       from small pool |      85    |     234    |    2458 K  |    2458 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  65536 KiB |  13895 MiB |  49328 GiB |  49328 GiB |
|       from large pool |  65536 KiB |  13836 MiB |  48715 GiB |  48715 GiB |
|       from small pool |      0 KiB |     97 MiB |    612 GiB |    612 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  65536 KiB |  13895 MiB |  49328 GiB |  49328 GiB |
|       from large pool |  65536 KiB |  13836 MiB |  48715 GiB |  48715 GiB |
|       from small pool |      0 KiB |     97 MiB |    612 GiB |    612 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  65536 KiB |  13889 MiB |  49286 GiB |  49286 GiB |
|       from large pool |  65536 KiB |  13830 MiB |  48675 GiB |  48675 GiB |
|       from small pool |      0 KiB |     97 MiB |    611 GiB |    611 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   3010 MiB |  15030 MiB |  15030 MiB |  12020 MiB |
|       from large pool |   2938 MiB |  14924 MiB |  14924 MiB |  11986 MiB |
|       from small pool |     72 MiB |    106 MiB |    106 MiB |     34 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  61440 KiB |   2306 MiB |  36752 GiB |  36752 GiB |
|       from large pool |  61440 KiB |   2299 MiB |  36136 GiB |  36136 GiB |
|       from small pool |      0 KiB |     43 MiB |    615 GiB |    615 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3103    |    8848 K  |    8848 K  |
|       from large pool |       2    |    1495    |    4399 K  |    4399 K  |
|       from small pool |       0    |    2219    |    4449 K  |    4449 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3103    |    8848 K  |    8848 K  |
|       from large pool |       2    |    1495    |    4399 K  |    4399 K  |
|       from small pool |       0    |    2219    |    4449 K  |    4449 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      95    |     588    |     588    |     493    |
|       from large pool |      59    |     535    |     535    |     476    |
|       from small pool |      36    |      53    |      53    |      17    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       1    |     573    |    5434 K  |    5434 K  |
|       from large pool |       1    |     528    |    2976 K  |    2976 K  |
|       from small pool |       0    |     234    |    2458 K  |    2458 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  65536 KiB |  13895 MiB |  49328 GiB |  49328 GiB |
|       from large pool |  65536 KiB |  13836 MiB |  48715 GiB |  48715 GiB |
|       from small pool |      0 KiB |     97 MiB |    612 GiB |    612 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  65536 KiB |  13895 MiB |  49328 GiB |  49328 GiB |
|       from large pool |  65536 KiB |  13836 MiB |  48715 GiB |  48715 GiB |
|       from small pool |      0 KiB |     97 MiB |    612 GiB |    612 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  65536 KiB |  13889 MiB |  49286 GiB |  49286 GiB |
|       from large pool |  65536 KiB |  13830 MiB |  48675 GiB |  48675 GiB |
|       from small pool |      0 KiB |     97 MiB |    611 GiB |    611 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   3010 MiB |  15030 MiB |  15030 MiB |  12020 MiB |
|       from large pool |   2938 MiB |  14924 MiB |  14924 MiB |  11986 MiB |
|       from small pool |     72 MiB |    106 MiB |    106 MiB |     34 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  61440 KiB |   2306 MiB |  36752 GiB |  36752 GiB |
|       from large pool |  61440 KiB |   2299 MiB |  36136 GiB |  36136 GiB |
|       from small pool |      0 KiB |     43 MiB |    615 GiB |    615 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3103    |    8848 K  |    8848 K  |
|       from large pool |       2    |    1495    |    4399 K  |    4399 K  |
|       from small pool |       0    |    2219    |    4449 K  |    4449 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3103    |    8848 K  |    8848 K  |
|       from large pool |       2    |    1495    |    4399 K  |    4399 K  |
|       from small pool |       0    |    2219    |    4449 K  |    4449 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      95    |     588    |     588    |     493    |
|       from large pool |      59    |     535    |     535    |     476    |
|       from small pool |      36    |      53    |      53    |      17    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       1    |     573    |    5434 K  |    5434 K  |
|       from large pool |       1    |     528    |    2976 K  |    2976 K  |
|       from small pool |       0    |     234    |    2458 K  |    2458 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main

using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_02_05_02_seed_1_23090488

 Experiment start at: 2024-07-27 02:05:02.965704
before training, model accuracy: 0.542222261428833
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.96028644, 'precision': 0.96076846, 'recall': 0.9605341, 'specificity': 0.9605341, 'f1': 0.96028477, 'auroc': 0.99124676, 'binary_precision': 0.9792781, 'binary_recall': 0.9415167, 'binary_specificity': 0.97955143, 'binary_f1_score': 0.96002626}
confusion matrix:
      0     1
0  1485    31
1    91  1465
---- Validation: 
scalar performance:
{'acc': 0.8235753, 'precision': 0.8280829, 'recall': 0.82452637, 'specificity': 0.82452637, 'f1': 0.8232253, 'auroc': 0.90436935, 'binary_precision': 0.78531075, 'binary_recall': 0.8825397, 'binary_specificity': 0.76651305, 'binary_f1_score': 0.83109117}
confusion matrix:
     0    1
0  499  152
1   74  556
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7644445, 'precision': 0.784689, 'recall': 0.7644445, 'specificity': 0.7644445, 'f1': 0.760181, 'auroc': 0.9077728, 'binary_precision': 0.70877194, 'binary_recall': 0.8977778, 'binary_specificity': 0.6311111, 'binary_f1_score': 0.7921569}
confusion matrix:
     0    1
0  142   83
1   23  202
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-27 02:05:53.519955,epoch time: 0:00:50.554251,used: 0:00:50.554251,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_02_05_02_seed_1_23090488
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9628906, 'precision': 0.96310544, 'recall': 0.96307087, 'specificity': 0.96307087, 'f1': 0.96289057, 'auroc': 0.9917258, 'binary_precision': 0.9768519, 'binary_recall': 0.94922876, 'binary_specificity': 0.9769129, 'binary_f1_score': 0.9628422}
confusion matrix:
      0     1
0  1481    35
1    79  1477
---- Validation: 
scalar performance:
{'acc': 0.8040593, 'precision': 0.80524904, 'recall': 0.80350745, 'specificity': 0.80350745, 'f1': 0.80362844, 'auroc': 0.8749031, 'binary_precision': 0.820643, 'binary_recall': 0.76984125, 'binary_specificity': 0.8371736, 'binary_f1_score': 0.7944308}
confusion matrix:
     0    1
0  545  106
1  145  485
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7822222, 'precision': 0.78231144, 'recall': 0.7822222, 'specificity': 0.7822222, 'f1': 0.782205, 'auroc': 0.89384687, 'binary_precision': 0.7873303, 'binary_recall': 0.7733333, 'binary_specificity': 0.7911111, 'binary_f1_score': 0.780269}
confusion matrix:
     0    1
0  178   47
1   51  174
new oracle model saved
early stop counter: 1
val acc:0.8040593266487122, best validation acc: 0.8235753178596497, corresponding to test acc:                         0.7644444704055786 / 0.7822222113609314
after epoch: 2,now: 2024-07-27 02:06:41.601999,epoch time: 0:00:48.082044,used: 0:01:38.636295,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_02_05_02_seed_1_23090488
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9593099, 'precision': 0.9613354, 'recall': 0.9597507, 'specificity': 0.9597507, 'f1': 0.9592869, 'auroc': 0.9961843, 'binary_precision': 0.99515235, 'binary_recall': 0.9241158, 'binary_specificity': 0.99538565, 'binary_f1_score': 0.9583195}
confusion matrix:
      0     1
0  1510     7
1   118  1437
---- Validation: 
scalar performance:
{'acc': 0.8001561, 'precision': 0.83202577, 'recall': 0.7975935, 'specificity': 0.7975935, 'f1': 0.794252, 'auroc': 0.9063199, 'binary_precision': 0.9308756, 'binary_recall': 0.64126986, 'binary_specificity': 0.953917, 'binary_f1_score': 0.7593985}
confusion matrix:
     0    1
0  621   30
1  226  404
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8088889, 'precision': 0.8463532, 'recall': 0.8088889, 'specificity': 0.8088889, 'f1': 0.8035773, 'auroc': 0.8977976, 'binary_precision': 0.9602649, 'binary_recall': 0.64444447, 'binary_specificity': 0.97333336, 'binary_f1_score': 0.7712766}
confusion matrix:
     0    1
0  219    6
1   80  145
new oracle model saved
early stop counter: 2
val acc:0.8001561164855957, best validation acc: 0.8235753178596497, corresponding to test acc:                         0.7644444704055786 / 0.8088889122009277
after epoch: 3,now: 2024-07-27 02:07:29.421516,epoch time: 0:00:47.819517,used: 0:02:26.455812,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_02_05_02_seed_1_23090488
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.97265625, 'precision': 0.97289276, 'recall': 0.9728559, 'specificity': 0.9728559, 'f1': 0.9726562, 'auroc': 0.9958781, 'binary_precision': 0.98742557, 'binary_recall': 0.958253, 'binary_specificity': 0.98745877, 'binary_f1_score': 0.9726206}
confusion matrix:
      0     1
0  1496    19
1    65  1492
---- Validation: 
scalar performance:
{'acc': 0.8399688, 'precision': 0.84067714, 'recall': 0.8403482, 'specificity': 0.8403482, 'f1': 0.83995473, 'auroc': 0.89516985, 'binary_precision': 0.82051283, 'binary_recall': 0.8634921, 'binary_specificity': 0.8172043, 'binary_f1_score': 0.841454}
confusion matrix:
     0    1
0  532  119
1   86  544
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.79555553, 'precision': 0.7979094, 'recall': 0.79555553, 'specificity': 0.79555553, 'f1': 0.79515094, 'auroc': 0.8963951, 'binary_precision': 0.7714286, 'binary_recall': 0.84, 'binary_specificity': 0.7511111, 'binary_f1_score': 0.80425537}
confusion matrix:
     0    1
0  169   56
1   36  189
better model found
persisted
after epoch: 4,now: 2024-07-27 02:08:17.098507,epoch time: 0:00:47.676991,used: 0:03:14.132803,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_02_05_02_seed_1_23090488
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.96516925, 'precision': 0.96705663, 'recall': 0.9655949, 'specificity': 0.9655949, 'f1': 0.96515167, 'auroc': 0.99837005, 'binary_precision': 1.0, 'binary_recall': 0.9311897, 'binary_specificity': 1.0, 'binary_f1_score': 0.96436894}
confusion matrix:
      0     1
0  1517     0
1   107  1448
---- Validation: 
scalar performance:
{'acc': 0.72287273, 'precision': 0.7900926, 'recall': 0.7188684, 'specificity': 0.7188684, 'f1': 0.7034291, 'auroc': 0.8752103, 'binary_precision': 0.9256966, 'binary_recall': 0.47460318, 'binary_specificity': 0.96313363, 'binary_f1_score': 0.62749213}
confusion matrix:
     0    1
0  627   24
1  331  299
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.82666665, 'precision': 0.84091616, 'recall': 0.8266667, 'specificity': 0.8266667, 'f1': 0.8248364, 'auroc': 0.9007604, 'binary_precision': 0.91061455, 'binary_recall': 0.72444445, 'binary_specificity': 0.9288889, 'binary_f1_score': 0.8069307}
confusion matrix:
     0    1
0  209   16
1   62  163
new oracle model saved
early stop counter: 1
val acc:0.7228727340698242, best validation acc: 0.8399688005447388, corresponding to test acc:                         0.7955555319786072 / 0.8266666531562805
after epoch: 5,now: 2024-07-27 02:09:04.695722,epoch time: 0:00:47.597215,used: 0:04:01.730018,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_02_05_02_seed_1_23090488
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.97591144, 'precision': 0.9759115, 'recall': 0.97599214, 'specificity': 0.97599214, 'f1': 0.9759104, 'auroc': 0.9976828, 'binary_precision': 0.9824219, 'binary_recall': 0.96979433, 'binary_specificity': 0.98218995, 'binary_f1_score': 0.9760673}
confusion matrix:
      0     1
0  1489    27
1    47  1509
---- Validation: 
scalar performance:
{'acc': 0.84933645, 'precision': 0.8525986, 'recall': 0.8485407, 'specificity': 0.8485407, 'f1': 0.84874654, 'auroc': 0.91198885, 'binary_precision': 0.882662, 'binary_recall': 0.8, 'binary_specificity': 0.89708143, 'binary_f1_score': 0.8393006}
confusion matrix:
     0    1
0  584   67
1  126  504
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.82222223, 'precision': 0.8272908, 'recall': 0.82222223, 'specificity': 0.82222223, 'f1': 0.8215313, 'auroc': 0.9073778, 'binary_precision': 0.8680203, 'binary_recall': 0.76, 'binary_specificity': 0.8844444, 'binary_f1_score': 0.8104266}
confusion matrix:
     0    1
0  199   26
1   54  171
better model found
persisted
after epoch: 6,now: 2024-07-27 02:09:52.768845,epoch time: 0:00:48.073123,used: 0:04:49.803141,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_02_05_02_seed_1_23090488
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.93847656, 'precision': 0.94436646, 'recall': 0.93917394, 'specificity': 0.93917394, 'f1': 0.9383315, 'auroc': 0.9957181, 'binary_precision': 0.9985391, 'binary_recall': 0.8796654, 'binary_specificity': 0.9986825, 'binary_f1_score': 0.9353404}
confusion matrix:
      0     1
0  1516     2
1   187  1367
---- Validation: 
scalar performance:
{'acc': 0.7041374, 'precision': 0.79426336, 'recall': 0.6995392, 'specificity': 0.6995392, 'f1': 0.676568, 'auroc': 0.90272593, 'binary_precision': 0.9530686, 'binary_recall': 0.41904762, 'binary_specificity': 0.9800307, 'binary_f1_score': 0.58213896}
confusion matrix:
     0    1
0  638   13
1  366  264
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7977778, 'precision': 0.84735024, 'recall': 0.7977778, 'specificity': 0.7977778, 'f1': 0.7902957, 'auroc': 0.8984691, 'binary_precision': 0.9785714, 'binary_recall': 0.60888886, 'binary_specificity': 0.9866667, 'binary_f1_score': 0.7506849}
confusion matrix:
     0    1
0  222    3
1   88  137
early stop counter: 1
val acc:0.70413738489151, best validation acc: 0.8493364453315735, corresponding to test acc:                         0.8222222328186035 / 0.8266666531562805
after epoch: 7,now: 2024-07-27 02:10:40.649362,epoch time: 0:00:47.880517,used: 0:05:37.683658,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_02_05_02_seed_1_23090488
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9720052, 'precision': 0.972949, 'recall': 0.9717461, 'specificity': 0.9717461, 'f1': 0.9719755, 'auroc': 0.9979499, 'binary_precision': 0.9548267, 'binary_recall': 0.9916452, 'binary_specificity': 0.95184696, 'binary_f1_score': 0.97288775}
confusion matrix:
      0     1
0  1443    73
1    13  1543
---- Validation: 
scalar performance:
{'acc': 0.81186575, 'precision': 0.8208201, 'recall': 0.81047106, 'specificity': 0.81047106, 'f1': 0.8100278, 'auroc': 0.8887304, 'binary_precision': 0.8704762, 'binary_recall': 0.7253968, 'binary_specificity': 0.8955453, 'binary_f1_score': 0.79134196}
confusion matrix:
     0    1
0  583   68
1  173  457
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.84, 'precision': 0.84002686, 'recall': 0.84000003, 'specificity': 0.84000003, 'f1': 0.8399968, 'auroc': 0.90245926, 'binary_precision': 0.8370044, 'binary_recall': 0.84444445, 'binary_specificity': 0.83555555, 'binary_f1_score': 0.84070796}
confusion matrix:
     0    1
0  188   37
1   35  190
new oracle model saved
early stop counter: 2
val acc:0.8118657469749451, best validation acc: 0.8493364453315735, corresponding to test acc:                         0.8222222328186035 / 0.8399999737739563
after epoch: 8,now: 2024-07-27 02:11:28.764073,epoch time: 0:00:48.114711,used: 0:06:25.798369,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_02_05_02_seed_1_23090488
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9827474, 'precision': 0.98282814, 'recall': 0.98269236, 'specificity': 0.98269236, 'f1': 0.98274267, 'auroc': 0.9988071, 'binary_precision': 0.9789541, 'binary_recall': 0.9871383, 'binary_specificity': 0.9782465, 'binary_f1_score': 0.9830291}
confusion matrix:
      0     1
0  1484    33
1    20  1535
---- Validation: 
scalar performance:
{'acc': 0.852459, 'precision': 0.85494447, 'recall': 0.8517665, 'specificity': 0.8517665, 'f1': 0.8519914, 'auroc': 0.90526414, 'binary_precision': 0.88082904, 'binary_recall': 0.8095238, 'binary_specificity': 0.89400923, 'binary_f1_score': 0.84367245}
confusion matrix:
     0    1
0  582   69
1  120  510
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8577778, 'precision': 0.86008227, 'recall': 0.8577778, 'specificity': 0.8577778, 'f1': 0.85754985, 'auroc': 0.91978276, 'binary_precision': 0.8888889, 'binary_recall': 0.81777775, 'binary_specificity': 0.8977778, 'binary_f1_score': 0.8518518}
confusion matrix:
     0    1
0  202   23
1   41  184
new oracle model saved
better model found
persisted
after epoch: 9,now: 2024-07-27 02:12:16.972630,epoch time: 0:00:48.208557,used: 0:07:14.006926,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_02_05_02_seed_1_23090488
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9860026, 'precision': 0.98598015, 'recall': 0.9860579, 'specificity': 0.9860579, 'f1': 0.9860014, 'auroc': 0.9989567, 'binary_precision': 0.990285, 'binary_recall': 0.9820167, 'binary_specificity': 0.990099, 'binary_f1_score': 0.98613346}
confusion matrix:
      0     1
0  1500    15
1    28  1529
---- Validation: 
scalar performance:
{'acc': 0.84777516, 'precision': 0.8484899, 'recall': 0.8473886, 'specificity': 0.8473886, 'f1': 0.8475611, 'auroc': 0.90585124, 'binary_precision': 0.8606965, 'binary_recall': 0.8238095, 'binary_specificity': 0.87096775, 'binary_f1_score': 0.84184915}
confusion matrix:
     0    1
0  567   84
1  111  519
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.82, 'precision': 0.829912, 'recall': 0.82000005, 'specificity': 0.82000005, 'f1': 0.8186377, 'auroc': 0.8928592, 'binary_precision': 0.88709676, 'binary_recall': 0.73333335, 'binary_specificity': 0.9066667, 'binary_f1_score': 0.80291975}
confusion matrix:
     0    1
0  204   21
1   60  165
early stop counter: 1
val acc:0.8477751612663269, best validation acc: 0.8524590134620667, corresponding to test acc:                         0.8577777743339539 / 0.8577777743339539
after epoch: 10,now: 2024-07-27 02:13:04.350531,epoch time: 0:00:47.377901,used: 0:08:01.384827,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_02_05_02_seed_1_23090488
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9863281, 'precision': 0.9863582, 'recall': 0.98629886, 'specificity': 0.98629886, 'f1': 0.9863248, 'auroc': 0.99889266, 'binary_precision': 0.9846449, 'binary_recall': 0.9884393, 'binary_specificity': 0.9841584, 'binary_f1_score': 0.98653847}
confusion matrix:
      0     1
0  1491    24
1    18  1539
---- Validation: 
scalar performance:
{'acc': 0.852459, 'precision': 0.8602059, 'recall': 0.85125446, 'specificity': 0.85125446, 'f1': 0.85132253, 'auroc': 0.90811265, 'binary_precision': 0.90909094, 'binary_recall': 0.7777778, 'binary_specificity': 0.9247312, 'binary_f1_score': 0.8383234}
confusion matrix:
     0    1
0  602   49
1  140  490
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8577778, 'precision': 0.8634056, 'recall': 0.8577778, 'specificity': 0.8577778, 'f1': 0.85722494, 'auroc': 0.92815804, 'binary_precision': 0.9086294, 'binary_recall': 0.79555553, 'binary_specificity': 0.92, 'binary_f1_score': 0.84834117}
confusion matrix:
     0    1
0  207   18
1   46  179
early stop counter: 2
val acc:0.8524590134620667, best validation acc: 0.8524590134620667, corresponding to test acc:                         0.8577777743339539 / 0.8577777743339539
after epoch: 11,now: 2024-07-27 02:13:51.658918,epoch time: 0:00:47.308387,used: 0:08:48.693214,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_02_05_02_seed_1_23090488
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9905599, 'precision': 0.99057245, 'recall': 0.9905456, 'specificity': 0.9905456, 'f1': 0.990558, 'auroc': 0.9994315, 'binary_precision': 0.98973703, 'binary_recall': 0.9916452, 'binary_specificity': 0.9894459, 'binary_f1_score': 0.99069023}
confusion matrix:
      0     1
0  1500    16
1    13  1543
---- Validation: 
scalar performance:
{'acc': 0.82982045, 'precision': 0.8343112, 'recall': 0.828853, 'specificity': 0.828853, 'f1': 0.8289187, 'auroc': 0.89518446, 'binary_precision': 0.8691756, 'binary_recall': 0.76984125, 'binary_specificity': 0.8878648, 'binary_f1_score': 0.8164983}
confusion matrix:
     0    1
0  578   73
1  145  485
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8377778, 'precision': 0.83858705, 'recall': 0.83777773, 'specificity': 0.83777773, 'f1': 0.8376808, 'auroc': 0.91152596, 'binary_precision': 0.8220339, 'binary_recall': 0.8622222, 'binary_specificity': 0.81333333, 'binary_f1_score': 0.8416486}
confusion matrix:
     0    1
0  183   42
1   31  194
early stop counter: 3
val acc:0.829820454120636, best validation acc: 0.8524590134620667, corresponding to test acc:                         0.8577777743339539 / 0.8577777743339539
after epoch: 12,now: 2024-07-27 02:14:39.006385,epoch time: 0:00:47.347467,used: 0:09:36.040681,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_02_05_02_seed_1_23090488
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.97721356, 'precision': 0.9779319, 'recall': 0.9775064, 'specificity': 0.9775064, 'f1': 0.97721136, 'auroc': 0.99899364, 'binary_precision': 1.0, 'binary_recall': 0.95501286, 'binary_specificity': 1.0, 'binary_f1_score': 0.97698885}
confusion matrix:
      0     1
0  1516     0
1    70  1486
---- Validation: 
scalar performance:
{'acc': 0.59562844, 'precision': 0.75454456, 'recall': 0.5890425, 'specificity': 0.5890425, 'f1': 0.5132465, 'auroc': 0.9111867, 'binary_precision': 0.9516129, 'binary_recall': 0.18730159, 'binary_specificity': 0.9907834, 'binary_f1_score': 0.31299737}
confusion matrix:
     0    1
0  645    6
1  512  118
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5422222, 'precision': 0.7610209, 'recall': 0.5422222, 'specificity': 0.5422222, 'f1': 0.42085662, 'auroc': 0.9048494, 'binary_precision': 1.0, 'binary_recall': 0.08444444, 'binary_specificity': 1.0, 'binary_f1_score': 0.1557377}
confusion matrix:
     0   1
0  225   0
1  206  19
early stop counter: 4
val acc:0.5956284403800964, best validation acc: 0.8524590134620667, corresponding to test acc:                         0.8577777743339539 / 0.8577777743339539
after epoch: 13,now: 2024-07-27 02:15:26.471115,epoch time: 0:00:47.464730,used: 0:10:23.505411,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_02_05_02_seed_1_23090488
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9863281, 'precision': 0.98635006, 'recall': 0.98644656, 'specificity': 0.98644656, 'f1': 0.98632765, 'auroc': 0.9995172, 'binary_precision': 0.9947781, 'binary_recall': 0.97817713, 'binary_specificity': 0.994716, 'binary_f1_score': 0.98640776}
confusion matrix:
      0     1
0  1506     8
1    34  1524
---- Validation: 
scalar performance:
{'acc': 0.76502734, 'precision': 0.816875, 'recall': 0.76167434, 'specificity': 0.76167434, 'f1': 0.7534139, 'auroc': 0.91662943, 'binary_precision': 0.94101876, 'binary_recall': 0.55714285, 'binary_specificity': 0.96620584, 'binary_f1_score': 0.69990027}
confusion matrix:
     0    1
0  629   22
1  279  351
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7977778, 'precision': 0.8530114, 'recall': 0.7977778, 'specificity': 0.7977778, 'f1': 0.78954566, 'auroc': 0.9272049, 'binary_precision': 0.99264705, 'binary_recall': 0.6, 'binary_specificity': 0.9955556, 'binary_f1_score': 0.7479225}
confusion matrix:
     0    1
0  224    1
1   90  135
early stop counter: 5
val acc:0.7650273442268372, best validation acc: 0.8524590134620667, corresponding to test acc:                         0.8577777743339539 / 0.8577777743339539
after epoch: 14,now: 2024-07-27 02:16:13.731411,epoch time: 0:00:47.260296,used: 0:11:10.765707,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_02_05_02_seed_1_23090488
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 14 with time: 0:11:10.765707 at 2024-07-27 02:16:13.731411
persisted model performance metric: 

scalar performance:
{'acc': 0.8577778, 'precision': 0.86008227, 'recall': 0.8577778, 'specificity': 0.8577778, 'f1': 0.85754985, 'auroc': 0.91978276, 'binary_precision': 0.8888889, 'binary_recall': 0.81777775, 'binary_specificity': 0.8977778, 'binary_f1_score': 0.8518518}
confusion matrix:
     0    1
0  202   23
1   41  184
oracle model performance metric: 

scalar performance:
{'acc': 0.8577778, 'precision': 0.86008227, 'recall': 0.8577778, 'specificity': 0.8577778, 'f1': 0.85754985, 'auroc': 0.91978276, 'binary_precision': 0.8888889, 'binary_recall': 0.81777775, 'binary_specificity': 0.8977778, 'binary_f1_score': 0.8518518}
confusion matrix:
     0    1
0  202   23
1   41  184
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_diva_irm_3seeds_nofreeze_2024-07-27_01-18-02/rule_results/14.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_diva_irm_3seeds_nofreeze_2024-07-27_01-18-02/confusion_matrix/14.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   1121 MiB |  13895 MiB |  84793 GiB |  84792 GiB |
|       from large pool |   1061 MiB |  13836 MiB |  83738 GiB |  83737 GiB |
|       from small pool |     60 MiB |    100 MiB |   1054 GiB |   1054 GiB |
|---------------------------------------------------------------------------|
| Active memory         |   1121 MiB |  13895 MiB |  84793 GiB |  84792 GiB |
|       from large pool |   1061 MiB |  13836 MiB |  83738 GiB |  83737 GiB |
|       from small pool |     60 MiB |    100 MiB |   1054 GiB |   1054 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |   1113 MiB |  13889 MiB |  84721 GiB |  84720 GiB |
|       from large pool |   1053 MiB |  13830 MiB |  83669 GiB |  83668 GiB |
|       from small pool |     60 MiB |    100 MiB |   1052 GiB |   1052 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  14942 MiB |  15030 MiB |  26962 MiB |  12020 MiB |
|       from large pool |  14832 MiB |  14924 MiB |  26818 MiB |  11986 MiB |
|       from small pool |    110 MiB |    110 MiB |    144 MiB |     34 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |   1474 MiB |   2740 MiB |  64760 GiB |  64758 GiB |
|       from large pool |   1462 MiB |   2730 MiB |  63700 GiB |  63699 GiB |
|       from small pool |     11 MiB |     43 MiB |   1059 GiB |   1059 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    1804    |    3107    |   15198 K  |   15196 K  |
|       from large pool |     269    |    1495    |    7559 K  |    7559 K  |
|       from small pool |    1535    |    2231    |    7638 K  |    7637 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    1804    |    3107    |   15198 K  |   15196 K  |
|       from large pool |     269    |    1495    |    7559 K  |    7559 K  |
|       from small pool |    1535    |    2231    |    7638 K  |    7637 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     547    |     588    |    1040    |     493    |
|       from large pool |     492    |     535    |     968    |     476    |
|       from small pool |      55    |      55    |      72    |      17    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     130    |     573    |    9521 K  |    9521 K  |
|       from large pool |      50    |     528    |    5292 K  |    5292 K  |
|       from small pool |      80    |     235    |    4228 K  |    4228 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  65536 KiB |  13895 MiB |  84793 GiB |  84793 GiB |
|       from large pool |  65536 KiB |  13836 MiB |  83738 GiB |  83738 GiB |
|       from small pool |      0 KiB |    100 MiB |   1054 GiB |   1054 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  65536 KiB |  13895 MiB |  84793 GiB |  84793 GiB |
|       from large pool |  65536 KiB |  13836 MiB |  83738 GiB |  83738 GiB |
|       from small pool |      0 KiB |    100 MiB |   1054 GiB |   1054 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  65536 KiB |  13889 MiB |  84721 GiB |  84721 GiB |
|       from large pool |  65536 KiB |  13830 MiB |  83669 GiB |  83669 GiB |
|       from small pool |      0 KiB |    100 MiB |   1052 GiB |   1052 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2596 MiB |  15030 MiB |  26962 MiB |  24366 MiB |
|       from large pool |   2524 MiB |  14924 MiB |  26818 MiB |  24294 MiB |
|       from small pool |     72 MiB |    110 MiB |    144 MiB |     72 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  61440 KiB |   2740 MiB |  64760 GiB |  64760 GiB |
|       from large pool |  61440 KiB |   2730 MiB |  63700 GiB |  63700 GiB |
|       from small pool |      0 KiB |     45 MiB |   1059 GiB |   1059 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3107    |   15198 K  |   15198 K  |
|       from large pool |       2    |    1495    |    7559 K  |    7559 K  |
|       from small pool |       0    |    2231    |    7638 K  |    7638 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3107    |   15198 K  |   15198 K  |
|       from large pool |       2    |    1495    |    7559 K  |    7559 K  |
|       from small pool |       0    |    2231    |    7638 K  |    7638 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      94    |     588    |    1040    |     946    |
|       from large pool |      58    |     535    |     968    |     910    |
|       from small pool |      36    |      55    |      72    |      36    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       1    |     573    |    9521 K  |    9521 K  |
|       from large pool |       1    |     528    |    5292 K  |    5292 K  |
|       from small pool |       0    |     235    |    4228 K  |    4228 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  65536 KiB |  13895 MiB |  84793 GiB |  84793 GiB |
|       from large pool |  65536 KiB |  13836 MiB |  83738 GiB |  83738 GiB |
|       from small pool |      0 KiB |    100 MiB |   1054 GiB |   1054 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  65536 KiB |  13895 MiB |  84793 GiB |  84793 GiB |
|       from large pool |  65536 KiB |  13836 MiB |  83738 GiB |  83738 GiB |
|       from small pool |      0 KiB |    100 MiB |   1054 GiB |   1054 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  65536 KiB |  13889 MiB |  84721 GiB |  84721 GiB |
|       from large pool |  65536 KiB |  13830 MiB |  83669 GiB |  83669 GiB |
|       from small pool |      0 KiB |    100 MiB |   1052 GiB |   1052 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2596 MiB |  15030 MiB |  26962 MiB |  24366 MiB |
|       from large pool |   2524 MiB |  14924 MiB |  26818 MiB |  24294 MiB |
|       from small pool |     72 MiB |    110 MiB |    144 MiB |     72 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  61440 KiB |   2740 MiB |  64760 GiB |  64760 GiB |
|       from large pool |  61440 KiB |   2730 MiB |  63700 GiB |  63700 GiB |
|       from small pool |      0 KiB |     45 MiB |   1059 GiB |   1059 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3107    |   15198 K  |   15198 K  |
|       from large pool |       2    |    1495    |    7559 K  |    7559 K  |
|       from small pool |       0    |    2231    |    7638 K  |    7638 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3107    |   15198 K  |   15198 K  |
|       from large pool |       2    |    1495    |    7559 K  |    7559 K  |
|       from small pool |       0    |    2231    |    7638 K  |    7638 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      94    |     588    |    1040    |     946    |
|       from large pool |      58    |     535    |     968    |     910    |
|       from small pool |      36    |      55    |      72    |      36    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       1    |     573    |    9521 K  |    9521 K  |
|       from large pool |       1    |     528    |    5292 K  |    5292 K  |
|       from small pool |       0    |     235    |    4228 K  |    4228 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main

using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_02_16_39_seed_2_23090488

 Experiment start at: 2024-07-27 02:16:40.380060
before training, model accuracy: 0.46064814925193787
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.8998691, 'precision': 0.91514826, 'recall': 0.9006288, 'specificity': 0.9006288, 'f1': 0.8990577, 'auroc': 0.9684392, 'binary_precision': 0.9967794, 'binary_recall': 0.8038961, 'binary_specificity': 0.9973615, 'binary_f1_score': 0.8900072}
confusion matrix:
      0     1
0  1512     4
1   302  1238
---- Validation: 
scalar performance:
{'acc': 0.68388104, 'precision': 0.76435184, 'recall': 0.67632437, 'specificity': 0.67632437, 'f1': 0.65214837, 'auroc': 0.85090876, 'binary_precision': 0.9037037, 'binary_recall': 0.39228296, 'binary_specificity': 0.96036583, 'binary_f1_score': 0.5470852}
confusion matrix:
     0    1
0  630   26
1  378  244
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7777778, 'precision': 0.8170254, 'recall': 0.7777778, 'specificity': 0.7777778, 'f1': 0.77068037, 'auroc': 0.8823731, 'binary_precision': 0.9285714, 'binary_recall': 0.6018519, 'binary_specificity': 0.9537037, 'binary_f1_score': 0.7303371}
confusion matrix:
     0    1
0  206   10
1   86  130
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-27 02:17:29.456163,epoch time: 0:00:49.076103,used: 0:00:49.076103,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_02_16_39_seed_2_23090488
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9518979, 'precision': 0.95288444, 'recall': 0.9520928, 'specificity': 0.9520928, 'f1': 0.95188344, 'auroc': 0.9904045, 'binary_precision': 0.97607654, 'binary_recall': 0.92727274, 'binary_specificity': 0.9769129, 'binary_f1_score': 0.9510489}
confusion matrix:
      0     1
0  1481    35
1   112  1428
---- Validation: 
scalar performance:
{'acc': 0.8364632, 'precision': 0.8383579, 'recall': 0.83541, 'specificity': 0.83541, 'f1': 0.8358359, 'auroc': 0.89142275, 'binary_precision': 0.8578856, 'binary_recall': 0.79581994, 'binary_specificity': 0.875, 'binary_f1_score': 0.825688}
confusion matrix:
     0    1
0  574   82
1  127  495
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8125, 'precision': 0.81266755, 'recall': 0.8125, 'specificity': 0.8125, 'f1': 0.8124749, 'auroc': 0.8961549, 'binary_precision': 0.8054299, 'binary_recall': 0.8240741, 'binary_specificity': 0.8009259, 'binary_f1_score': 0.81464535}
confusion matrix:
     0    1
0  173   43
1   38  178
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-07-27 02:18:16.674494,epoch time: 0:00:47.218331,used: 0:01:36.294434,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_02_16_39_seed_2_23090488
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9100131, 'precision': 0.9220257, 'recall': 0.9093573, 'specificity': 0.9093573, 'f1': 0.90926766, 'auroc': 0.9923419, 'binary_precision': 0.85276073, 'binary_recall': 0.99285716, 'binary_specificity': 0.8258575, 'binary_f1_score': 0.9174918}
confusion matrix:
      0     1
0  1252   264
1    11  1529
---- Validation: 
scalar performance:
{'acc': 0.8489828, 'precision': 0.8493558, 'recall': 0.8494799, 'specificity': 0.8494799, 'f1': 0.8489804, 'auroc': 0.9002701, 'binary_precision': 0.8294931, 'binary_recall': 0.8681672, 'binary_specificity': 0.83079267, 'binary_f1_score': 0.8483896}
confusion matrix:
     0    1
0  545  111
1   82  540
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.75, 'precision': 0.770903, 'recall': 0.75, 'specificity': 0.75, 'f1': 0.7450826, 'auroc': 0.89120376, 'binary_precision': 0.6956522, 'binary_recall': 0.8888889, 'binary_specificity': 0.6111111, 'binary_f1_score': 0.7804878}
confusion matrix:
     0    1
0  132   84
1   24  192
better model found
persisted
after epoch: 3,now: 2024-07-27 02:19:03.282729,epoch time: 0:00:46.608235,used: 0:02:22.902669,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_02_16_39_seed_2_23090488
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.95746076, 'precision': 0.9602212, 'recall': 0.9577768, 'specificity': 0.9577768, 'f1': 0.9574151, 'auroc': 0.9944644, 'binary_precision': 0.99788135, 'binary_recall': 0.91753244, 'binary_specificity': 0.9980211, 'binary_f1_score': 0.9560216}
confusion matrix:
      0     1
0  1513     3
1   127  1413
---- Validation: 
scalar performance:
{'acc': 0.63458526, 'precision': 0.7505281, 'recall': 0.6252647, 'specificity': 0.6252647, 'f1': 0.5777144, 'auroc': 0.88697636, 'binary_precision': 0.9144385, 'binary_recall': 0.2749196, 'binary_specificity': 0.9756098, 'binary_f1_score': 0.42274413}
confusion matrix:
     0    1
0  640   16
1  451  171
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7361111, 'precision': 0.8110107, 'recall': 0.7361111, 'specificity': 0.7361111, 'f1': 0.71920544, 'auroc': 0.89752656, 'binary_precision': 0.96363634, 'binary_recall': 0.49074075, 'binary_specificity': 0.9814815, 'binary_f1_score': 0.65030676}
confusion matrix:
     0    1
0  212    4
1  110  106
early stop counter: 1
val acc:0.6345852613449097, best validation acc: 0.8489828109741211, corresponding to test acc:                         0.75 / 0.8125
after epoch: 4,now: 2024-07-27 02:19:49.441063,epoch time: 0:00:46.158334,used: 0:03:09.061003,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_02_16_39_seed_2_23090488
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9777487, 'precision': 0.9780406, 'recall': 0.9778604, 'specificity': 0.9778604, 'f1': 0.97774774, 'auroc': 0.9969412, 'binary_precision': 0.9919786, 'binary_recall': 0.96363634, 'binary_specificity': 0.99208444, 'binary_f1_score': 0.9776021}
confusion matrix:
      0     1
0  1504    12
1    56  1484
---- Validation: 
scalar performance:
{'acc': 0.81533647, 'precision': 0.8152057, 'recall': 0.8152057, 'specificity': 0.8152057, 'f1': 0.8152057, 'auroc': 0.8911605, 'binary_precision': 0.8102894, 'binary_recall': 0.8102894, 'binary_specificity': 0.82012194, 'binary_f1_score': 0.8102894}
confusion matrix:
     0    1
0  538  118
1  118  504
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8055556, 'precision': 0.8124123, 'recall': 0.8055556, 'specificity': 0.8055556, 'f1': 0.80448276, 'auroc': 0.9108582, 'binary_precision': 0.766129, 'binary_recall': 0.8796296, 'binary_specificity': 0.7314815, 'binary_f1_score': 0.8189655}
confusion matrix:
     0    1
0  158   58
1   26  190
early stop counter: 2
val acc:0.8153364658355713, best validation acc: 0.8489828109741211, corresponding to test acc:                         0.75 / 0.8125
after epoch: 5,now: 2024-07-27 02:20:35.731838,epoch time: 0:00:46.290775,used: 0:03:55.351778,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_02_16_39_seed_2_23090488
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9790576, 'precision': 0.97931945, 'recall': 0.97916424, 'specificity': 0.97916424, 'f1': 0.97905684, 'auroc': 0.9966843, 'binary_precision': 0.9926569, 'binary_recall': 0.9655844, 'binary_specificity': 0.9927441, 'binary_f1_score': 0.9789335}
confusion matrix:
      0     1
0  1505    11
1    53  1487
---- Validation: 
scalar performance:
{'acc': 0.70422536, 'precision': 0.7591335, 'recall': 0.69789135, 'specificity': 0.69789135, 'f1': 0.6833689, 'auroc': 0.8667065, 'binary_precision': 0.8719512, 'binary_recall': 0.45980707, 'binary_specificity': 0.9359756, 'binary_f1_score': 0.60210526}
confusion matrix:
     0    1
0  614   42
1  336  286
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8194444, 'precision': 0.8249041, 'recall': 0.8194444, 'specificity': 0.8194444, 'f1': 0.81868273, 'auroc': 0.8934542, 'binary_precision': 0.86702126, 'binary_recall': 0.7546296, 'binary_specificity': 0.8842593, 'binary_f1_score': 0.80693066}
confusion matrix:
     0    1
0  191   25
1   53  163
new oracle model saved
early stop counter: 3
val acc:0.7042253613471985, best validation acc: 0.8489828109741211, corresponding to test acc:                         0.75 / 0.8194444179534912
after epoch: 6,now: 2024-07-27 02:21:22.595564,epoch time: 0:00:46.863726,used: 0:04:42.215504,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_02_16_39_seed_2_23090488
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9656414, 'precision': 0.96643686, 'recall': 0.96581656, 'specificity': 0.96581656, 'f1': 0.96563387, 'auroc': 0.99658656, 'binary_precision': 0.9877634, 'binary_recall': 0.9435065, 'binary_specificity': 0.98812664, 'binary_f1_score': 0.9651278}
confusion matrix:
      0     1
0  1498    18
1    87  1453
---- Validation: 
scalar performance:
{'acc': 0.6071988, 'precision': 0.74811697, 'recall': 0.59687966, 'specificity': 0.59687966, 'f1': 0.5306928, 'auroc': 0.8689147, 'binary_precision': 0.9285714, 'binary_recall': 0.20900321, 'binary_specificity': 0.9847561, 'binary_f1_score': 0.34120733}
confusion matrix:
     0    1
0  646   10
1  492  130
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6481481, 'precision': 0.7503259, 'recall': 0.6481482, 'specificity': 0.6481482, 'f1': 0.60816324, 'auroc': 0.8951689, 'binary_precision': 0.9102564, 'binary_recall': 0.3287037, 'binary_specificity': 0.9675926, 'binary_f1_score': 0.48299322}
confusion matrix:
     0   1
0  209   7
1  145  71
early stop counter: 4
val acc:0.6071987748146057, best validation acc: 0.8489828109741211, corresponding to test acc:                         0.75 / 0.8194444179534912
after epoch: 7,now: 2024-07-27 02:22:08.868218,epoch time: 0:00:46.272654,used: 0:05:28.488158,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_02_16_39_seed_2_23090488
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.96629584, 'precision': 0.9670216, 'recall': 0.9661524, 'specificity': 0.9661524, 'f1': 0.9662733, 'auroc': 0.9965327, 'binary_precision': 0.9504702, 'binary_recall': 0.9844156, 'binary_specificity': 0.9478892, 'binary_f1_score': 0.96714514}
confusion matrix:
      0     1
0  1437    79
1    24  1516
---- Validation: 
scalar performance:
{'acc': 0.7824726, 'precision': 0.7823273, 'recall': 0.7824435, 'specificity': 0.7824435, 'f1': 0.7823682, 'auroc': 0.8527248, 'binary_precision': 0.77388537, 'binary_recall': 0.7813505, 'binary_specificity': 0.7835366, 'binary_f1_score': 0.7776}
confusion matrix:
     0    1
0  514  142
1  136  486
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7546296, 'precision': 0.78451, 'recall': 0.7546296, 'specificity': 0.7546296, 'f1': 0.7480135, 'auroc': 0.86541927, 'binary_precision': 0.6923077, 'binary_recall': 0.9166667, 'binary_specificity': 0.5925926, 'binary_f1_score': 0.78884465}
confusion matrix:
     0    1
0  128   88
1   18  198
early stop counter: 5
val acc:0.7824726104736328, best validation acc: 0.8489828109741211, corresponding to test acc:                         0.75 / 0.8194444179534912
after epoch: 8,now: 2024-07-27 02:22:55.167830,epoch time: 0:00:46.299612,used: 0:06:14.787770,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_02_16_39_seed_2_23090488
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 8 with time: 0:06:14.787770 at 2024-07-27 02:22:55.167830
persisted model performance metric: 

scalar performance:
{'acc': 0.75, 'precision': 0.770903, 'recall': 0.75, 'specificity': 0.75, 'f1': 0.7450826, 'auroc': 0.89120376, 'binary_precision': 0.6956522, 'binary_recall': 0.8888889, 'binary_specificity': 0.6111111, 'binary_f1_score': 0.7804878}
confusion matrix:
     0    1
0  132   84
1   24  192
oracle model performance metric: 

scalar performance:
{'acc': 0.8194444, 'precision': 0.8249041, 'recall': 0.8194444, 'specificity': 0.8194444, 'f1': 0.81868273, 'auroc': 0.8934542, 'binary_precision': 0.86702126, 'binary_recall': 0.7546296, 'binary_specificity': 0.8842593, 'binary_f1_score': 0.80693066}
confusion matrix:
     0    1
0  191   25
1   53  163
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_diva_irm_3seeds_nofreeze_2024-07-27_01-18-02/rule_results/14.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_diva_irm_3seeds_nofreeze_2024-07-27_01-18-02/confusion_matrix/14.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   1124 MiB |  13896 MiB | 104621 GiB | 104620 GiB |
|       from large pool |   1064 MiB |  13837 MiB | 103319 GiB | 103318 GiB |
|       from small pool |     60 MiB |    100 MiB |   1301 GiB |   1301 GiB |
|---------------------------------------------------------------------------|
| Active memory         |   1124 MiB |  13896 MiB | 104621 GiB | 104620 GiB |
|       from large pool |   1064 MiB |  13837 MiB | 103319 GiB | 103318 GiB |
|       from small pool |     60 MiB |    100 MiB |   1301 GiB |   1301 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |   1113 MiB |  13889 MiB | 104535 GiB | 104534 GiB |
|       from large pool |   1053 MiB |  13830 MiB | 103236 GiB | 103235 GiB |
|       from small pool |     60 MiB |    100 MiB |   1299 GiB |   1299 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  14972 MiB |  15030 MiB |  39338 MiB |  24366 MiB |
|       from large pool |  14866 MiB |  14924 MiB |  39160 MiB |  24294 MiB |
|       from small pool |    106 MiB |    110 MiB |    178 MiB |     72 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |   1045 MiB |   2740 MiB |  80076 GiB |  80075 GiB |
|       from large pool |   1033 MiB |   2730 MiB |  78768 GiB |  78767 GiB |
|       from small pool |     11 MiB |     45 MiB |   1307 GiB |   1307 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    1792    |    3107    |   18758 K  |   18756 K  |
|       from large pool |     269    |    1495    |    9327 K  |    9327 K  |
|       from small pool |    1523    |    2231    |    9430 K  |    9429 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    1792    |    3107    |   18758 K  |   18756 K  |
|       from large pool |     269    |    1495    |    9327 K  |    9327 K  |
|       from small pool |    1523    |    2231    |    9430 K  |    9429 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     552    |     588    |    1498    |     946    |
|       from large pool |     499    |     535    |    1409    |     910    |
|       from small pool |      53    |      55    |      89    |      36    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     118    |     573    |   11734 K  |   11734 K  |
|       from large pool |      40    |     528    |    6507 K  |    6507 K  |
|       from small pool |      78    |     235    |    5227 K  |    5227 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  65536 KiB |  13896 MiB | 104621 GiB | 104621 GiB |
|       from large pool |  65536 KiB |  13837 MiB | 103319 GiB | 103319 GiB |
|       from small pool |      0 KiB |    100 MiB |   1301 GiB |   1301 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  65536 KiB |  13896 MiB | 104621 GiB | 104621 GiB |
|       from large pool |  65536 KiB |  13837 MiB | 103319 GiB | 103319 GiB |
|       from small pool |      0 KiB |    100 MiB |   1301 GiB |   1301 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  65536 KiB |  13889 MiB | 104535 GiB | 104535 GiB |
|       from large pool |  65536 KiB |  13830 MiB | 103236 GiB | 103235 GiB |
|       from small pool |      0 KiB |    100 MiB |   1299 GiB |   1299 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2170 MiB |  15030 MiB |  39338 MiB |  37168 MiB |
|       from large pool |   2098 MiB |  14924 MiB |  39160 MiB |  37062 MiB |
|       from small pool |     72 MiB |    110 MiB |    178 MiB |    106 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  61440 KiB |   2740 MiB |  80076 GiB |  80076 GiB |
|       from large pool |  61440 KiB |   2730 MiB |  78769 GiB |  78769 GiB |
|       from small pool |      0 KiB |     47 MiB |   1307 GiB |   1307 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3107    |   18758 K  |   18758 K  |
|       from large pool |       2    |    1495    |    9327 K  |    9327 K  |
|       from small pool |       0    |    2231    |    9430 K  |    9430 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3107    |   18758 K  |   18758 K  |
|       from large pool |       2    |    1495    |    9327 K  |    9327 K  |
|       from small pool |       0    |    2231    |    9430 K  |    9430 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      92    |     588    |    1498    |    1406    |
|       from large pool |      56    |     535    |    1409    |    1353    |
|       from small pool |      36    |      55    |      89    |      53    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       1    |     573    |   11735 K  |   11735 K  |
|       from large pool |       1    |     528    |    6507 K  |    6507 K  |
|       from small pool |       0    |     235    |    5227 K  |    5227 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Sat Jul 27 02:22:59 2024]
Finished job 0.
1 of 1 steps (100%) done
