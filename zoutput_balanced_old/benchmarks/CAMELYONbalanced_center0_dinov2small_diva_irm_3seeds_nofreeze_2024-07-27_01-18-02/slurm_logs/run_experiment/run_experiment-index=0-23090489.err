Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Sat Jul 27 01:54:59 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_diva_irm_3seeds_nofreeze_2024-07-27_01-18-02/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_diva_irm_3seeds_nofreeze_2024-07-27_01-18-02/rule_results/0.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=0
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/swiglu_ffn.py:51: UserWarning: xFormers is not available (SwiGLU)
  warnings.warn("xFormers is not available (SwiGLU)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/attention.py:33: UserWarning: xFormers is not available (Attention)
  warnings.warn("xFormers is not available (Attention)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/block.py:40: UserWarning: xFormers is not available (Block)
  warnings.warn("xFormers is not available (Block)")
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_01_55_45_seed_0_23090489

 Experiment start at: 2024-07-27 01:55:45.603339
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
before training, model accuracy: 0.569767415523529
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.96451825, 'precision': 0.9651401, 'recall': 0.96480983, 'specificity': 0.96480983, 'f1': 0.96451586, 'auroc': 0.9927025, 'binary_precision': 0.98590606, 'binary_recall': 0.943481, 'binary_specificity': 0.98613864, 'binary_f1_score': 0.9642271}
confusion matrix:
      0     1
0  1494    21
1    88  1469
---- Validation: 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
scalar performance:
{'acc': 0.7546584, 'precision': 0.7641678, 'recall': 0.7532865, 'specificity': 0.7532865, 'f1': 0.7517251, 'auroc': 0.8573537, 'binary_precision': 0.8109162, 'binary_recall': 0.6551181, 'binary_specificity': 0.8514548, 'binary_f1_score': 0.7247387}
confusion matrix:
     0    1
0  556   97
1  219  416
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.80465114, 'precision': 0.8091725, 'recall': 0.80465114, 'specificity': 0.80465114, 'f1': 0.80393434, 'auroc': 0.89951324, 'binary_precision': 0.84656084, 'binary_recall': 0.74418604, 'binary_specificity': 0.8651163, 'binary_f1_score': 0.7920792}
confusion matrix:
     0    1
0  186   29
1   55  160
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-27 01:57:20.471372,epoch time: 0:01:34.868033,used: 0:01:34.868033,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_01_55_45_seed_0_23090489
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9749349, 'precision': 0.974908, 'recall': 0.97498107, 'specificity': 0.97498107, 'f1': 0.974932, 'auroc': 0.99756575, 'binary_precision': 0.9786684, 'binary_recall': 0.97175866, 'binary_specificity': 0.9782034, 'binary_f1_score': 0.9752013}
confusion matrix:
      0     1
0  1481    33
1    44  1514
---- Validation: 
scalar performance:
{'acc': 0.8462733, 'precision': 0.8474147, 'recall': 0.84667736, 'specificity': 0.84667736, 'f1': 0.8462284, 'auroc': 0.90519106, 'binary_precision': 0.8237037, 'binary_recall': 0.87559056, 'binary_specificity': 0.81776416, 'binary_f1_score': 0.8488549}
confusion matrix:
     0    1
0  534  119
1   79  556
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8255814, 'precision': 0.8334367, 'recall': 0.82558143, 'specificity': 0.82558143, 'f1': 0.824548, 'auroc': 0.91543543, 'binary_precision': 0.88461536, 'binary_recall': 0.74883723, 'binary_specificity': 0.9023256, 'binary_f1_score': 0.8110831}
confusion matrix:
     0    1
0  194   21
1   54  161
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-07-27 01:58:50.089696,epoch time: 0:01:29.618324,used: 0:03:04.486357,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_01_55_45_seed_0_23090489
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.98567706, 'precision': 0.9856575, 'recall': 0.98571515, 'specificity': 0.98571515, 'f1': 0.9856758, 'auroc': 0.9987452, 'binary_precision': 0.98899674, 'binary_recall': 0.98263663, 'binary_specificity': 0.9887937, 'binary_f1_score': 0.9858064}
confusion matrix:
      0     1
0  1500    17
1    27  1528
---- Validation: 
scalar performance:
{'acc': 0.8377329, 'precision': 0.83839977, 'recall': 0.8374082, 'specificity': 0.8374082, 'f1': 0.83753467, 'auroc': 0.8928627, 'binary_precision': 0.8503289, 'binary_recall': 0.8141732, 'binary_specificity': 0.8606432, 'binary_f1_score': 0.8318584}
confusion matrix:
     0    1
0  562   91
1  118  517
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.88837206, 'precision': 0.89002585, 'recall': 0.88837206, 'specificity': 0.88837206, 'f1': 0.88825357, 'auroc': 0.94515955, 'binary_precision': 0.91542286, 'binary_recall': 0.855814, 'binary_specificity': 0.9209302, 'binary_f1_score': 0.8846153}
confusion matrix:
     0    1
0  198   17
1   31  184
new oracle model saved
early stop counter: 1
val acc:0.8377329111099243, best validation acc: 0.8462733030319214, corresponding to test acc:                         0.8255813717842102 / 0.8883720636367798
after epoch: 3,now: 2024-07-27 02:00:16.966897,epoch time: 0:01:26.877201,used: 0:04:31.363558,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_01_55_45_seed_0_23090489
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.96191406, 'precision': 0.96415657, 'recall': 0.9623238, 'specificity': 0.9623238, 'f1': 0.9618876, 'auroc': 0.9987885, 'binary_precision': 0.9993046, 'binary_recall': 0.92530584, 'binary_specificity': 0.99934167, 'binary_f1_score': 0.96088266}
confusion matrix:
      0     1
0  1518     1
1   116  1437
---- Validation: 
scalar performance:
{'acc': 0.70962733, 'precision': 0.7765269, 'recall': 0.70614123, 'specificity': 0.70614123, 'f1': 0.6886935, 'auroc': 0.8885484, 'binary_precision': 0.90909094, 'binary_recall': 0.4566929, 'binary_specificity': 0.9555896, 'binary_f1_score': 0.6079665}
confusion matrix:
     0    1
0  624   29
1  345  290
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.76046515, 'precision': 0.83055127, 'recall': 0.76046515, 'specificity': 0.76046515, 'f1': 0.7470574, 'auroc': 0.9157382, 'binary_precision': 0.98275864, 'binary_recall': 0.53023255, 'binary_specificity': 0.9906977, 'binary_f1_score': 0.68882173}
confusion matrix:
     0    1
0  213    2
1  101  114
early stop counter: 2
val acc:0.7096273303031921, best validation acc: 0.8462733030319214, corresponding to test acc:                         0.8255813717842102 / 0.8883720636367798
after epoch: 4,now: 2024-07-27 02:01:44.267243,epoch time: 0:01:27.300346,used: 0:05:58.663904,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_01_55_45_seed_0_23090489
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9785156, 'precision': 0.9792142, 'recall': 0.97830003, 'specificity': 0.97830003, 'f1': 0.97849715, 'auroc': 0.9992352, 'binary_precision': 0.9638854, 'binary_recall': 0.9948586, 'binary_specificity': 0.96174145, 'binary_f1_score': 0.9791271}
confusion matrix:
      0     1
0  1458    58
1     8  1548
---- Validation: 
scalar performance:
{'acc': 0.7476708, 'precision': 0.76211405, 'recall': 0.7459828, 'specificity': 0.7459828, 'f1': 0.7432505, 'auroc': 0.8447553, 'binary_precision': 0.82024795, 'binary_recall': 0.6251969, 'binary_specificity': 0.8667688, 'binary_f1_score': 0.7095621}
confusion matrix:
     0    1
0  566   87
1  238  397
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8534884, 'precision': 0.87122864, 'recall': 0.8534883, 'specificity': 0.8534883, 'f1': 0.8517168, 'auroc': 0.9330882, 'binary_precision': 0.95238096, 'binary_recall': 0.74418604, 'binary_specificity': 0.96279067, 'binary_f1_score': 0.8355091}
confusion matrix:
     0    1
0  207    8
1   55  160
early stop counter: 3
val acc:0.7476708292961121, best validation acc: 0.8462733030319214, corresponding to test acc:                         0.8255813717842102 / 0.8883720636367798
after epoch: 5,now: 2024-07-27 02:03:11.259493,epoch time: 0:01:26.992250,used: 0:07:25.656154,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_01_55_45_seed_0_23090489
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9733073, 'precision': 0.97452915, 'recall': 0.9730365, 'specificity': 0.9730365, 'f1': 0.9732754, 'auroc': 0.9989551, 'binary_precision': 0.95320195, 'binary_recall': 0.996139, 'binary_specificity': 0.9499341, 'binary_f1_score': 0.97419757}
confusion matrix:
      0     1
0  1442    76
1     6  1548
---- Validation: 
scalar performance:
{'acc': 0.83618015, 'precision': 0.83620507, 'recall': 0.8362675, 'specificity': 0.8362675, 'f1': 0.8361753, 'auroc': 0.9041468, 'binary_precision': 0.8281734, 'binary_recall': 0.8425197, 'binary_specificity': 0.8300153, 'binary_f1_score': 0.83528495}
confusion matrix:
     0    1
0  542  111
1  100  535
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.89302325, 'precision': 0.89302325, 'recall': 0.89302325, 'specificity': 0.89302325, 'f1': 0.89302325, 'auroc': 0.95102215, 'binary_precision': 0.89302325, 'binary_recall': 0.89302325, 'binary_specificity': 0.89302325, 'binary_f1_score': 0.89302325}
confusion matrix:
     0    1
0  192   23
1   23  192
new oracle model saved
early stop counter: 4
val acc:0.8361801505088806, best validation acc: 0.8462733030319214, corresponding to test acc:                         0.8255813717842102 / 0.8930232524871826
after epoch: 6,now: 2024-07-27 02:04:38.489598,epoch time: 0:01:27.230105,used: 0:08:52.886259,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_01_55_45_seed_0_23090489
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9892578, 'precision': 0.9893389, 'recall': 0.9892068, 'specificity': 0.9892068, 'f1': 0.9892551, 'auroc': 0.9995354, 'binary_precision': 0.9853223, 'binary_recall': 0.993565, 'binary_specificity': 0.9848485, 'binary_f1_score': 0.9894265}
confusion matrix:
      0     1
0  1495    23
1    10  1544
---- Validation: 
scalar performance:
{'acc': 0.88121116, 'precision': 0.8812729, 'recall': 0.881112, 'specificity': 0.881112, 'f1': 0.88116646, 'auroc': 0.9417877, 'binary_precision': 0.88375795, 'binary_recall': 0.87401575, 'binary_specificity': 0.88820827, 'binary_f1_score': 0.8788599}
confusion matrix:
     0    1
0  580   73
1   80  555
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.855814, 'precision': 0.8619529, 'recall': 0.855814, 'specificity': 0.855814, 'f1': 0.8552, 'auroc': 0.93440783, 'binary_precision': 0.90909094, 'binary_recall': 0.7906977, 'binary_specificity': 0.9209302, 'binary_f1_score': 0.8457712}
confusion matrix:
     0    1
0  198   17
1   45  170
better model found
persisted
after epoch: 7,now: 2024-07-27 02:06:06.570463,epoch time: 0:01:28.080865,used: 0:10:20.967124,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_01_55_45_seed_0_23090489
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9785156, 'precision': 0.9785509, 'recall': 0.9786418, 'specificity': 0.9786418, 'f1': 0.978515, 'auroc': 0.9983063, 'binary_precision': 0.9875817, 'binary_recall': 0.96983314, 'binary_specificity': 0.9874505, 'binary_f1_score': 0.9786269}
confusion matrix:
      0     1
0  1495    19
1    47  1511
---- Validation: 
scalar performance:
{'acc': 0.6079193, 'precision': 0.69650733, 'recall': 0.6031219, 'specificity': 0.6031219, 'f1': 0.5525732, 'auroc': 0.7911125, 'binary_precision': 0.825, 'binary_recall': 0.25984251, 'binary_specificity': 0.94640124, 'binary_f1_score': 0.3952096}
confusion matrix:
     0    1
0  618   35
1  470  165
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.59302324, 'precision': 0.7345114, 'recall': 0.59302324, 'specificity': 0.59302324, 'f1': 0.5207342, 'auroc': 0.84292054, 'binary_precision': 0.9166667, 'binary_recall': 0.20465116, 'binary_specificity': 0.98139536, 'binary_f1_score': 0.33460075}
confusion matrix:
     0   1
0  211   4
1  171  44
early stop counter: 1
val acc:0.6079192757606506, best validation acc: 0.8812111616134644, corresponding to test acc:                         0.8558139801025391 / 0.8930232524871826
after epoch: 8,now: 2024-07-27 02:07:34.401107,epoch time: 0:01:27.830644,used: 0:11:48.797768,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_01_55_45_seed_0_23090489
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.98307294, 'precision': 0.9835165, 'recall': 0.98290896, 'specificity': 0.98290896, 'f1': 0.983062, 'auroc': 0.9996261, 'binary_precision': 0.97176915, 'binary_recall': 0.9955013, 'binary_specificity': 0.97031665, 'binary_f1_score': 0.98349214}
confusion matrix:
      0     1
0  1471    45
1     7  1549
---- Validation: 
scalar performance:
{'acc': 0.81832296, 'precision': 0.83461857, 'recall': 0.81676817, 'specificity': 0.81676817, 'f1': 0.81554735, 'auroc': 0.92102593, 'binary_precision': 0.9050505, 'binary_recall': 0.7055118, 'binary_specificity': 0.92802453, 'binary_f1_score': 0.79292035}
confusion matrix:
     0    1
0  606   47
1  187  448
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.90697676, 'precision': 0.90984946, 'recall': 0.90697676, 'specificity': 0.90697676, 'f1': 0.9068135, 'auroc': 0.9512547, 'binary_precision': 0.9441624, 'binary_recall': 0.8651163, 'binary_specificity': 0.9488372, 'binary_f1_score': 0.9029126}
confusion matrix:
     0    1
0  204   11
1   29  186
new oracle model saved
early stop counter: 2
val acc:0.8183229565620422, best validation acc: 0.8812111616134644, corresponding to test acc:                         0.8558139801025391 / 0.9069767594337463
after epoch: 9,now: 2024-07-27 02:09:02.516189,epoch time: 0:01:28.115082,used: 0:13:16.912850,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_01_55_45_seed_0_23090489
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.98307294, 'precision': 0.98333263, 'recall': 0.9832933, 'specificity': 0.9832933, 'f1': 0.9830729, 'auroc': 0.99968445, 'binary_precision': 0.9986755, 'binary_recall': 0.96790755, 'binary_specificity': 0.998679, 'binary_f1_score': 0.9830509}
confusion matrix:
      0     1
0  1512     2
1    50  1508
---- Validation: 
scalar performance:
{'acc': 0.60248446, 'precision': 0.7550781, 'recall': 0.5970023, 'specificity': 0.5970023, 'f1': 0.5264869, 'auroc': 0.8987453, 'binary_precision': 0.9489051, 'binary_recall': 0.20472442, 'binary_specificity': 0.9892802, 'binary_f1_score': 0.33678755}
confusion matrix:
     0    1
0  646    7
1  505  130
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.4976744, 'precision': 0.24941725, 'recall': 0.4976744, 'specificity': 0.4976744, 'f1': 0.33229813, 'auroc': 0.87351, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9953488, 'binary_f1_score': 0.0}
confusion matrix:
     0  1
0  214  1
1  215  0
early stop counter: 3
val acc:0.6024844646453857, best validation acc: 0.8812111616134644, corresponding to test acc:                         0.8558139801025391 / 0.9069767594337463
after epoch: 10,now: 2024-07-27 02:10:30.777229,epoch time: 0:01:28.261040,used: 0:14:45.173890,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_01_55_45_seed_0_23090489
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.98502606, 'precision': 0.98505557, 'recall': 0.9851592, 'specificity': 0.9851592, 'f1': 0.9850255, 'auroc': 0.9987472, 'binary_precision': 0.9941215, 'binary_recall': 0.97626686, 'binary_specificity': 0.9940516, 'binary_f1_score': 0.98511326}
confusion matrix:
      0     1
0  1504     9
1    37  1522
---- Validation: 
scalar performance:
{'acc': 0.8579193, 'precision': 0.86822075, 'recall': 0.85675204, 'specificity': 0.85675204, 'f1': 0.8566116, 'auroc': 0.93527627, 'binary_precision': 0.9264151, 'binary_recall': 0.77322835, 'binary_specificity': 0.94027567, 'binary_f1_score': 0.84291846}
confusion matrix:
     0    1
0  614   39
1  144  491
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8116279, 'precision': 0.83700633, 'recall': 0.8116279, 'specificity': 0.8116279, 'f1': 0.8080135, 'auroc': 0.9237642, 'binary_precision': 0.92948717, 'binary_recall': 0.6744186, 'binary_specificity': 0.9488372, 'binary_f1_score': 0.78167117}
confusion matrix:
     0    1
0  204   11
1   70  145
early stop counter: 4
val acc:0.8579192757606506, best validation acc: 0.8812111616134644, corresponding to test acc:                         0.8558139801025391 / 0.9069767594337463
after epoch: 11,now: 2024-07-27 02:11:58.578662,epoch time: 0:01:27.801433,used: 0:16:12.975323,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_01_55_45_seed_0_23090489
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9899089, 'precision': 0.98994875, 'recall': 0.9900216, 'specificity': 0.9900216, 'f1': 0.9899087, 'auroc': 0.99974775, 'binary_precision': 0.998692, 'binary_recall': 0.98136246, 'binary_specificity': 0.9986807, 'binary_f1_score': 0.98995143}
confusion matrix:
      0     1
0  1514     2
1    29  1527
---- Validation: 
scalar performance:
{'acc': 0.60947204, 'precision': 0.7717391, 'recall': 0.6040021, 'specificity': 0.6040021, 'f1': 0.53515446, 'auroc': 0.90983105, 'binary_precision': 0.9782609, 'binary_recall': 0.21259843, 'binary_specificity': 0.9954058, 'binary_f1_score': 0.3492885}
confusion matrix:
     0    1
0  650    3
1  500  135
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5651163, 'precision': 0.7674129, 'recall': 0.5651163, 'specificity': 0.5651163, 'f1': 0.46368662, 'auroc': 0.9050081, 'binary_precision': 1.0, 'binary_recall': 0.13023256, 'binary_specificity': 1.0, 'binary_f1_score': 0.23045267}
confusion matrix:
     0   1
0  215   0
1  187  28
early stop counter: 5
val acc:0.6094720363616943, best validation acc: 0.8812111616134644, corresponding to test acc:                         0.8558139801025391 / 0.9069767594337463
after epoch: 12,now: 2024-07-27 02:13:26.031546,epoch time: 0:01:27.452884,used: 0:17:40.428207,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_01_55_45_seed_0_23090489
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 12 with time: 0:17:40.428207 at 2024-07-27 02:13:26.031546
persisted model performance metric: 

scalar performance:
{'acc': 0.855814, 'precision': 0.8619529, 'recall': 0.855814, 'specificity': 0.855814, 'f1': 0.8552, 'auroc': 0.93440783, 'binary_precision': 0.90909094, 'binary_recall': 0.7906977, 'binary_specificity': 0.9209302, 'binary_f1_score': 0.8457712}
confusion matrix:
     0    1
0  198   17
1   45  170
oracle model performance metric: 

scalar performance:
{'acc': 0.90697676, 'precision': 0.90984946, 'recall': 0.90697676, 'specificity': 0.90697676, 'f1': 0.9068135, 'auroc': 0.9512547, 'binary_precision': 0.9441624, 'binary_recall': 0.8651163, 'binary_specificity': 0.9488372, 'binary_f1_score': 0.9029126}
confusion matrix:
     0    1
0  204   11
1   29  186
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_diva_irm_3seeds_nofreeze_2024-07-27_01-18-02/rule_results/0.csv
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_diva_irm_3seeds_nofreeze_2024-07-27_01-18-02/rule_results/0.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_diva_irm_3seeds_nofreeze_2024-07-27_01-18-02/confusion_matrix/0.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 454925 KiB |   2002 MiB |  26137 GiB |  26137 GiB |
|       from large pool | 414333 KiB |   1970 MiB |  25803 GiB |  25803 GiB |
|       from small pool |  40592 KiB |     56 MiB |    334 GiB |    334 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 454925 KiB |   2002 MiB |  26137 GiB |  26137 GiB |
|       from large pool | 414333 KiB |   1970 MiB |  25803 GiB |  25803 GiB |
|       from small pool |  40592 KiB |     56 MiB |    334 GiB |    334 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 447480 KiB |   1998 MiB |  26059 GiB |  26059 GiB |
|       from large pool | 407075 KiB |   1966 MiB |  25726 GiB |  25725 GiB |
|       from small pool |  40405 KiB |     56 MiB |    333 GiB |    333 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2276 MiB |   2276 MiB |   2276 MiB |      0 B   |
|       from large pool |   2212 MiB |   2212 MiB |   2212 MiB |      0 B   |
|       from small pool |     64 MiB |     64 MiB |     64 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory | 386802 KiB | 387009 KiB |  20277 GiB |  20277 GiB |
|       from large pool | 380291 KiB | 380291 KiB |  19925 GiB |  19925 GiB |
|       from small pool |   6511 KiB |  12075 KiB |    351 GiB |    351 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    1298    |    1669    |    4986 K  |    4985 K  |
|       from large pool |     187    |     311    |    2395 K  |    2395 K  |
|       from small pool |    1111    |    1407    |    2590 K  |    2589 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    1298    |    1669    |    4986 K  |    4985 K  |
|       from large pool |     187    |     311    |    2395 K  |    2395 K  |
|       from small pool |    1111    |    1407    |    2590 K  |    2589 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     124    |     124    |     124    |       0    |
|       from large pool |      92    |      92    |      92    |       0    |
|       from small pool |      32    |      32    |      32    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      73    |     256    |    2910 K  |    2910 K  |
|       from large pool |      35    |      90    |    1851 K  |    1851 K  |
|       from small pool |      38    |     221    |    1059 K  |    1059 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   2002 MiB |  26137 GiB |  26137 GiB |
|       from large pool |  16640 KiB |   1970 MiB |  25803 GiB |  25803 GiB |
|       from small pool |      0 KiB |     56 MiB |    334 GiB |    334 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   2002 MiB |  26137 GiB |  26137 GiB |
|       from large pool |  16640 KiB |   1970 MiB |  25803 GiB |  25803 GiB |
|       from small pool |      0 KiB |     56 MiB |    334 GiB |    334 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   1998 MiB |  26059 GiB |  26059 GiB |
|       from large pool |  16640 KiB |   1966 MiB |  25726 GiB |  25726 GiB |
|       from small pool |      0 KiB |     56 MiB |    333 GiB |    333 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    822 MiB |   2276 MiB |   2276 MiB |   1454 MiB |
|       from large pool |    776 MiB |   2212 MiB |   2212 MiB |   1436 MiB |
|       from small pool |     46 MiB |     64 MiB |     64 MiB |     18 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  30464 KiB | 392712 KiB |  20277 GiB |  20277 GiB |
|       from large pool |  30464 KiB | 384405 KiB |  19926 GiB |  19926 GiB |
|       from small pool |      0 KiB |  22117 KiB |    351 GiB |    351 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    1669    |    4986 K  |    4986 K  |
|       from large pool |       2    |     311    |    2395 K  |    2395 K  |
|       from small pool |       0    |    1407    |    2590 K  |    2590 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    1669    |    4986 K  |    4986 K  |
|       from large pool |       2    |     311    |    2395 K  |    2395 K  |
|       from small pool |       0    |    1407    |    2590 K  |    2590 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      57    |     124    |     124    |      67    |
|       from large pool |      34    |      92    |      92    |      58    |
|       from small pool |      23    |      32    |      32    |       9    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |     256    |    2910 K  |    2910 K  |
|       from large pool |       4    |      90    |    1851 K  |    1851 K  |
|       from small pool |       0    |     221    |    1059 K  |    1059 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   2002 MiB |  26137 GiB |  26137 GiB |
|       from large pool |  16640 KiB |   1970 MiB |  25803 GiB |  25803 GiB |
|       from small pool |      0 KiB |     56 MiB |    334 GiB |    334 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   2002 MiB |  26137 GiB |  26137 GiB |
|       from large pool |  16640 KiB |   1970 MiB |  25803 GiB |  25803 GiB |
|       from small pool |      0 KiB |     56 MiB |    334 GiB |    334 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   1998 MiB |  26059 GiB |  26059 GiB |
|       from large pool |  16640 KiB |   1966 MiB |  25726 GiB |  25726 GiB |
|       from small pool |      0 KiB |     56 MiB |    333 GiB |    333 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    822 MiB |   2276 MiB |   2276 MiB |   1454 MiB |
|       from large pool |    776 MiB |   2212 MiB |   2212 MiB |   1436 MiB |
|       from small pool |     46 MiB |     64 MiB |     64 MiB |     18 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  30464 KiB | 392712 KiB |  20277 GiB |  20277 GiB |
|       from large pool |  30464 KiB | 384405 KiB |  19926 GiB |  19926 GiB |
|       from small pool |      0 KiB |  22117 KiB |    351 GiB |    351 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    1669    |    4986 K  |    4986 K  |
|       from large pool |       2    |     311    |    2395 K  |    2395 K  |
|       from small pool |       0    |    1407    |    2590 K  |    2590 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    1669    |    4986 K  |    4986 K  |
|       from large pool |       2    |     311    |    2395 K  |    2395 K  |
|       from small pool |       0    |    1407    |    2590 K  |    2590 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      57    |     124    |     124    |      67    |
|       from large pool |      34    |      92    |      92    |      58    |
|       from small pool |      23    |      32    |      32    |       9    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |     256    |    2910 K  |    2910 K  |
|       from large pool |       4    |      90    |    1851 K  |    1851 K  |
|       from small pool |       0    |     221    |    1059 K  |    1059 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_02_13_58_seed_1_23090489

 Experiment start at: 2024-07-27 02:13:59.126178
before training, model accuracy: 0.6177777647972107
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.96158856, 'precision': 0.9631841, 'recall': 0.962006, 'specificity': 0.962006, 'f1': 0.96157384, 'auroc': 0.9958184, 'binary_precision': 0.9938187, 'binary_recall': 0.92994857, 'binary_specificity': 0.9940633, 'binary_f1_score': 0.96082336}
confusion matrix:
      0     1
0  1507     9
1   109  1447
---- Validation: 
scalar performance:
{'acc': 0.7806401, 'precision': 0.80925393, 'recall': 0.7781106, 'specificity': 0.7781106, 'f1': 0.7743425, 'auroc': 0.8925195, 'binary_precision': 0.8993135, 'binary_recall': 0.6238095, 'binary_specificity': 0.9324117, 'binary_f1_score': 0.7366448}
confusion matrix:
     0    1
0  607   44
1  237  393
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.81333333, 'precision': 0.83402467, 'recall': 0.81333333, 'specificity': 0.81333333, 'f1': 0.810397, 'auroc': 0.9029531, 'binary_precision': 0.91715974, 'binary_recall': 0.6888889, 'binary_specificity': 0.93777776, 'binary_f1_score': 0.78680205}
confusion matrix:
     0    1
0  211   14
1   70  155
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-27 02:15:30.774394,epoch time: 0:01:31.648216,used: 0:01:31.648216,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_02_13_58_seed_1_23090489
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9671224, 'precision': 0.968411, 'recall': 0.96743906, 'specificity': 0.96743906, 'f1': 0.9671118, 'auroc': 0.99651086, 'binary_precision': 0.99590164, 'binary_recall': 0.93882805, 'binary_specificity': 0.99605006, 'binary_f1_score': 0.966523}
confusion matrix:
      0     1
0  1513     6
1    95  1458
---- Validation: 
scalar performance:
{'acc': 0.7283372, 'precision': 0.7979326, 'recall': 0.72432154, 'specificity': 0.72432154, 'f1': 0.7091524, 'auroc': 0.9088265, 'binary_precision': 0.9378882, 'binary_recall': 0.47936508, 'binary_specificity': 0.96927804, 'binary_f1_score': 0.63445383}
confusion matrix:
     0    1
0  631   20
1  328  302
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.73777777, 'precision': 0.81989956, 'recall': 0.73777777, 'specificity': 0.73777777, 'f1': 0.71979487, 'auroc': 0.91670126, 'binary_precision': 0.981982, 'binary_recall': 0.48444444, 'binary_specificity': 0.9911111, 'binary_f1_score': 0.64880955}
confusion matrix:
     0    1
0  223    2
1  116  109
early stop counter: 1
val acc:0.7283372282981873, best validation acc: 0.7806401252746582, corresponding to test acc:                         0.8133333325386047 / 0.8133333325386047
after epoch: 2,now: 2024-07-27 02:16:58.837994,epoch time: 0:01:28.063600,used: 0:02:59.711816,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_02_13_58_seed_1_23090489
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9628906, 'precision': 0.96494853, 'recall': 0.9633591, 'specificity': 0.9633591, 'f1': 0.96287024, 'auroc': 0.9981911, 'binary_precision': 0.99930745, 'binary_recall': 0.9273779, 'binary_specificity': 0.99934036, 'binary_f1_score': 0.962}
confusion matrix:
      0     1
0  1515     1
1   113  1443
---- Validation: 
scalar performance:
{'acc': 0.77751756, 'precision': 0.8252172, 'recall': 0.7743472, 'specificity': 0.7743472, 'f1': 0.76764905, 'auroc': 0.9242313, 'binary_precision': 0.9457364, 'binary_recall': 0.5809524, 'binary_specificity': 0.9677419, 'binary_f1_score': 0.71976405}
confusion matrix:
     0    1
0  630   21
1  264  366
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.70666665, 'precision': 0.80555475, 'recall': 0.70666665, 'specificity': 0.70666665, 'f1': 0.6808442, 'auroc': 0.9230025, 'binary_precision': 0.97938144, 'binary_recall': 0.42222223, 'binary_specificity': 0.9911111, 'binary_f1_score': 0.5900621}
confusion matrix:
     0   1
0  223   2
1  130  95
early stop counter: 2
val acc:0.777517557144165, best validation acc: 0.7806401252746582, corresponding to test acc:                         0.8133333325386047 / 0.8133333325386047
after epoch: 3,now: 2024-07-27 02:18:26.657759,epoch time: 0:01:27.819765,used: 0:04:27.531581,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_02_13_58_seed_1_23090489
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.96940106, 'precision': 0.9707254, 'recall': 0.96913064, 'specificity': 0.96913064, 'f1': 0.9693632, 'auroc': 0.9982916, 'binary_precision': 0.94837123, 'binary_recall': 0.99356085, 'binary_specificity': 0.9447005, 'binary_f1_score': 0.97044027}
confusion matrix:
      0     1
0  1435    84
1    10  1543
---- Validation: 
scalar performance:
{'acc': 0.76112413, 'precision': 0.76723117, 'recall': 0.7623144, 'specificity': 0.7623144, 'f1': 0.7602579, 'auroc': 0.83735883, 'binary_precision': 0.72252744, 'binary_recall': 0.83492064, 'binary_specificity': 0.6897081, 'binary_f1_score': 0.7746686}
confusion matrix:
     0    1
0  449  202
1  104  526
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.74444443, 'precision': 0.7788167, 'recall': 0.7444445, 'specificity': 0.7444445, 'f1': 0.7363178, 'auroc': 0.9081284, 'binary_precision': 0.6809211, 'binary_recall': 0.92, 'binary_specificity': 0.5688889, 'binary_f1_score': 0.7826087}
confusion matrix:
     0    1
0  128   97
1   18  207
early stop counter: 3
val acc:0.7611241340637207, best validation acc: 0.7806401252746582, corresponding to test acc:                         0.8133333325386047 / 0.8133333325386047
after epoch: 4,now: 2024-07-27 02:19:54.482647,epoch time: 0:01:27.824888,used: 0:05:55.356469,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_02_13_58_seed_1_23090489
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9840495, 'precision': 0.98422015, 'recall': 0.98419607, 'specificity': 0.98419607, 'f1': 0.98404944, 'auroc': 0.998526, 'binary_precision': 0.9966997, 'binary_recall': 0.97168595, 'binary_specificity': 0.9967062, 'binary_f1_score': 0.9840339}
confusion matrix:
      0     1
0  1513     5
1    44  1510
---- Validation: 
scalar performance:
{'acc': 0.79859483, 'precision': 0.8230383, 'recall': 0.7963134, 'specificity': 0.7963134, 'f1': 0.7938171, 'auroc': 0.90468633, 'binary_precision': 0.90789473, 'binary_recall': 0.6571429, 'binary_specificity': 0.9354839, 'binary_f1_score': 0.76243097}
confusion matrix:
     0    1
0  609   42
1  216  414
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.84444445, 'precision': 0.87081337, 'recall': 0.84444445, 'specificity': 0.84444445, 'f1': 0.841629, 'auroc': 0.9163259, 'binary_precision': 0.969697, 'binary_recall': 0.7111111, 'binary_specificity': 0.9777778, 'binary_f1_score': 0.8205129}
confusion matrix:
     0    1
0  220    5
1   65  160
new oracle model saved
better model found
persisted
after epoch: 5,now: 2024-07-27 02:21:22.445161,epoch time: 0:01:27.962514,used: 0:07:23.318983,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_02_13_58_seed_1_23090489
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.98014325, 'precision': 0.98012674, 'recall': 0.98016036, 'specificity': 0.98016036, 'f1': 0.9801409, 'auroc': 0.99835896, 'binary_precision': 0.9819355, 'binary_recall': 0.9787781, 'binary_specificity': 0.9815425, 'binary_f1_score': 0.9803543}
confusion matrix:
      0     1
0  1489    28
1    33  1522
---- Validation: 
scalar performance:
{'acc': 0.7782982, 'precision': 0.7872374, 'recall': 0.7768049, 'specificity': 0.7768049, 'f1': 0.77588224, 'auroc': 0.86413336, 'binary_precision': 0.8339768, 'binary_recall': 0.6857143, 'binary_specificity': 0.86789554, 'binary_f1_score': 0.75261325}
confusion matrix:
     0    1
0  565   86
1  198  432
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.78444445, 'precision': 0.7998501, 'recall': 0.78444445, 'specificity': 0.78444445, 'f1': 0.78163975, 'auroc': 0.8778074, 'binary_precision': 0.8678161, 'binary_recall': 0.6711111, 'binary_specificity': 0.8977778, 'binary_f1_score': 0.75689226}
confusion matrix:
     0    1
0  202   23
1   74  151
early stop counter: 1
val acc:0.7782981991767883, best validation acc: 0.7985948324203491, corresponding to test acc:                         0.8444444537162781 / 0.8444444537162781
after epoch: 6,now: 2024-07-27 02:22:50.107014,epoch time: 0:01:27.661853,used: 0:08:50.980836,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_02_13_58_seed_1_23090489
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9817708, 'precision': 0.9820224, 'recall': 0.98166776, 'specificity': 0.98166776, 'f1': 0.9817634, 'auroc': 0.9989364, 'binary_precision': 0.9734345, 'binary_recall': 0.9909852, 'binary_specificity': 0.97235024, 'binary_f1_score': 0.9821315}
confusion matrix:
      0     1
0  1477    42
1    14  1539
---- Validation: 
scalar performance:
{'acc': 0.8508977, 'precision': 0.85172594, 'recall': 0.8513057, 'specificity': 0.8513057, 'f1': 0.8508799, 'auroc': 0.91404676, 'binary_precision': 0.8300752, 'binary_recall': 0.8761905, 'binary_specificity': 0.8264209, 'binary_f1_score': 0.8525097}
confusion matrix:
     0    1
0  538  113
1   78  552
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8511111, 'precision': 0.8511181, 'recall': 0.8511111, 'specificity': 0.8511111, 'f1': 0.85111034, 'auroc': 0.9193877, 'binary_precision': 0.8495575, 'binary_recall': 0.85333335, 'binary_specificity': 0.8488889, 'binary_f1_score': 0.8514412}
confusion matrix:
     0    1
0  191   34
1   33  192
new oracle model saved
better model found
persisted
after epoch: 7,now: 2024-07-27 02:24:18.035602,epoch time: 0:01:27.928588,used: 0:10:18.909424,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_02_13_58_seed_1_23090489
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9866536, 'precision': 0.9867085, 'recall': 0.9867743, 'specificity': 0.9867743, 'f1': 0.98665345, 'auroc': 0.99898136, 'binary_precision': 0.99607074, 'binary_recall': 0.9775064, 'binary_specificity': 0.9960422, 'binary_f1_score': 0.98670125}
confusion matrix:
      0     1
0  1510     6
1    35  1521
---- Validation: 
scalar performance:
{'acc': 0.68930525, 'precision': 0.7818897, 'recall': 0.68453664, 'specificity': 0.68453664, 'f1': 0.65810037, 'auroc': 0.91251314, 'binary_precision': 0.93939394, 'binary_recall': 0.3936508, 'binary_specificity': 0.97542244, 'binary_f1_score': 0.55480987}
confusion matrix:
     0    1
0  635   16
1  382  248
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.60444444, 'precision': 0.7791563, 'recall': 0.60444444, 'specificity': 0.60444444, 'f1': 0.53107435, 'auroc': 0.9258865, 'binary_precision': 1.0, 'binary_recall': 0.20888889, 'binary_specificity': 1.0, 'binary_f1_score': 0.34558824}
confusion matrix:
     0   1
0  225   0
1  178  47
early stop counter: 1
val acc:0.6893052458763123, best validation acc: 0.8508977293968201, corresponding to test acc:                         0.851111114025116 / 0.851111114025116
after epoch: 8,now: 2024-07-27 02:25:45.810129,epoch time: 0:01:27.774527,used: 0:11:46.683951,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_02_13_58_seed_1_23090489
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.984375, 'precision': 0.98437285, 'recall': 0.98437285, 'specificity': 0.98437285, 'f1': 0.98437285, 'auroc': 0.99919164, 'binary_precision': 0.98455596, 'binary_recall': 0.98455596, 'binary_specificity': 0.98418975, 'binary_f1_score': 0.98455596}
confusion matrix:
      0     1
0  1494    24
1    24  1530
---- Validation: 
scalar performance:
{'acc': 0.8430913, 'precision': 0.8435191, 'recall': 0.84278035, 'specificity': 0.84278035, 'f1': 0.84292245, 'auroc': 0.90330136, 'binary_precision': 0.8522167, 'binary_recall': 0.8238095, 'binary_specificity': 0.86175114, 'binary_f1_score': 0.83777237}
confusion matrix:
     0    1
0  561   90
1  111  519
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.84, 'precision': 0.84, 'recall': 0.84, 'specificity': 0.84, 'f1': 0.84, 'auroc': 0.9253334, 'binary_precision': 0.84, 'binary_recall': 0.84, 'binary_specificity': 0.84, 'binary_f1_score': 0.84}
confusion matrix:
     0    1
0  189   36
1   36  189
early stop counter: 2
val acc:0.8430913090705872, best validation acc: 0.8508977293968201, corresponding to test acc:                         0.851111114025116 / 0.851111114025116
after epoch: 9,now: 2024-07-27 02:27:13.191613,epoch time: 0:01:27.381484,used: 0:13:14.065435,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_02_13_58_seed_1_23090489
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9869792, 'precision': 0.9870763, 'recall': 0.9869144, 'specificity': 0.9869144, 'f1': 0.98697484, 'auroc': 0.99950993, 'binary_precision': 0.9828135, 'binary_recall': 0.9916506, 'binary_specificity': 0.9821782, 'binary_f1_score': 0.98721224}
confusion matrix:
      0     1
0  1488    27
1    13  1544
---- Validation: 
scalar performance:
{'acc': 0.7900078, 'precision': 0.818339, 'recall': 0.787532, 'specificity': 0.787532, 'f1': 0.78420854, 'auroc': 0.9022584, 'binary_precision': 0.90929705, 'binary_recall': 0.6365079, 'binary_specificity': 0.9385561, 'binary_f1_score': 0.7488329}
confusion matrix:
     0    1
0  611   40
1  229  401
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8111111, 'precision': 0.84340656, 'recall': 0.8111111, 'specificity': 0.8111111, 'f1': 0.8065632, 'auroc': 0.90269625, 'binary_precision': 0.94871795, 'binary_recall': 0.6577778, 'binary_specificity': 0.96444446, 'binary_f1_score': 0.7769029}
confusion matrix:
     0    1
0  217    8
1   77  148
early stop counter: 3
val acc:0.7900078296661377, best validation acc: 0.8508977293968201, corresponding to test acc:                         0.851111114025116 / 0.851111114025116
after epoch: 10,now: 2024-07-27 02:28:40.741248,epoch time: 0:01:27.549635,used: 0:14:41.615070,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_02_13_58_seed_1_23090489
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9785156, 'precision': 0.97899795, 'recall': 0.9787787, 'specificity': 0.9787787, 'f1': 0.97851485, 'auroc': 0.99871254, 'binary_precision': 0.997996, 'binary_recall': 0.95953757, 'binary_specificity': 0.9980198, 'binary_f1_score': 0.9783889}
confusion matrix:
      0     1
0  1512     3
1    63  1494
---- Validation: 
scalar performance:
{'acc': 0.52459013, 'precision': 0.6675044, 'recall': 0.51682025, 'specificity': 0.51682025, 'f1': 0.38037646, 'auroc': 0.8528985, 'binary_precision': 0.8181818, 'binary_recall': 0.042857144, 'binary_specificity': 0.9907834, 'binary_f1_score': 0.08144797}
confusion matrix:
     0   1
0  645   6
1  603  27
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.61333334, 'precision': 0.77268195, 'recall': 0.61333334, 'specificity': 0.61333334, 'f1': 0.547179, 'auroc': 0.8862815, 'binary_precision': 0.9811321, 'binary_recall': 0.23111111, 'binary_specificity': 0.9955556, 'binary_f1_score': 0.37410071}
confusion matrix:
     0   1
0  224   1
1  173  52
early stop counter: 4
val acc:0.5245901346206665, best validation acc: 0.8508977293968201, corresponding to test acc:                         0.851111114025116 / 0.851111114025116
after epoch: 11,now: 2024-07-27 02:30:08.301277,epoch time: 0:01:27.560029,used: 0:16:09.175099,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_02_13_58_seed_1_23090489
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.99283856, 'precision': 0.9928261, 'recall': 0.9928528, 'specificity': 0.9928528, 'f1': 0.9928378, 'auroc': 0.99936116, 'binary_precision': 0.99419355, 'binary_recall': 0.9916345, 'binary_specificity': 0.9940711, 'binary_f1_score': 0.99291235}
confusion matrix:
      0     1
0  1509     9
1    13  1541
---- Validation: 
scalar performance:
{'acc': 0.8555816, 'precision': 0.85556436, 'recall': 0.85565794, 'specificity': 0.85565794, 'f1': 0.8555689, 'auroc': 0.90894103, 'binary_precision': 0.8482003, 'binary_recall': 0.86031747, 'binary_specificity': 0.85099846, 'binary_f1_score': 0.8542159}
confusion matrix:
     0    1
0  554   97
1   88  542
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.86, 'precision': 0.8612058, 'recall': 0.86, 'specificity': 0.86, 'f1': 0.85988307, 'auroc': 0.9040197, 'binary_precision': 0.8820755, 'binary_recall': 0.83111113, 'binary_specificity': 0.8888889, 'binary_f1_score': 0.85583526}
confusion matrix:
     0    1
0  200   25
1   38  187
new oracle model saved
better model found
persisted
after epoch: 12,now: 2024-07-27 02:31:35.838661,epoch time: 0:01:27.537384,used: 0:17:36.712483,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_02_13_58_seed_1_23090489
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9860026, 'precision': 0.98600256, 'recall': 0.98606217, 'specificity': 0.98606217, 'f1': 0.98600215, 'auroc': 0.99899197, 'binary_precision': 0.99153644, 'binary_recall': 0.98068255, 'binary_specificity': 0.9914417, 'binary_f1_score': 0.98607963}
confusion matrix:
      0     1
0  1506    13
1    30  1523
---- Validation: 
scalar performance:
{'acc': 0.8594848, 'precision': 0.866248, 'recall': 0.85837173, 'specificity': 0.85837173, 'f1': 0.85853434, 'auroc': 0.9239924, 'binary_precision': 0.9120879, 'binary_recall': 0.7904762, 'binary_specificity': 0.92626727, 'binary_f1_score': 0.8469388}
confusion matrix:
     0    1
0  603   48
1  132  498
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.82222223, 'precision': 0.84689, 'recall': 0.82222223, 'specificity': 0.82222223, 'f1': 0.81900454, 'auroc': 0.9137975, 'binary_precision': 0.93939394, 'binary_recall': 0.6888889, 'binary_specificity': 0.95555556, 'binary_f1_score': 0.7948718}
confusion matrix:
     0    1
0  215   10
1   70  155
better model found
persisted
after epoch: 13,now: 2024-07-27 02:33:03.130436,epoch time: 0:01:27.291775,used: 0:19:04.004258,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_02_13_58_seed_1_23090489
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9824219, 'precision': 0.9827332, 'recall': 0.98263085, 'specificity': 0.98263085, 'f1': 0.98242176, 'auroc': 0.9996494, 'binary_precision': 0.998672, 'binary_recall': 0.966581, 'binary_specificity': 0.9986807, 'binary_f1_score': 0.98236454}
confusion matrix:
      0     1
0  1514     2
1    52  1504
---- Validation: 
scalar performance:
{'acc': 0.5979703, 'precision': 0.72820544, 'recall': 0.5916539, 'specificity': 0.5916539, 'f1': 0.5236457, 'auroc': 0.89741546, 'binary_precision': 0.8965517, 'binary_recall': 0.20634921, 'binary_specificity': 0.9769585, 'binary_f1_score': 0.33548388}
confusion matrix:
     0    1
0  636   15
1  500  130
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7688889, 'precision': 0.8228695, 'recall': 0.7688889, 'specificity': 0.7688889, 'f1': 0.75880766, 'auroc': 0.88730866, 'binary_precision': 0.9548872, 'binary_recall': 0.5644444, 'binary_specificity': 0.97333336, 'binary_f1_score': 0.7094972}
confusion matrix:
     0    1
0  219    6
1   98  127
early stop counter: 1
val acc:0.5979703068733215, best validation acc: 0.8594847917556763, corresponding to test acc:                         0.8222222328186035 / 0.8600000143051147
after epoch: 14,now: 2024-07-27 02:34:30.022516,epoch time: 0:01:26.892080,used: 0:20:30.896338,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_02_13_58_seed_1_23090489
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.99153644, 'precision': 0.991566, 'recall': 0.991511, 'specificity': 0.991511, 'f1': 0.9915347, 'auroc': 0.99962103, 'binary_precision': 0.98975015, 'binary_recall': 0.99356914, 'binary_specificity': 0.98945284, 'binary_f1_score': 0.99165595}
confusion matrix:
      0     1
0  1501    16
1    10  1545
---- Validation: 
scalar performance:
{'acc': 0.8321624, 'precision': 0.8513948, 'recall': 0.83023554, 'specificity': 0.83023554, 'f1': 0.82922506, 'auroc': 0.9213152, 'binary_precision': 0.9296066, 'binary_recall': 0.7126984, 'binary_specificity': 0.9477727, 'binary_f1_score': 0.8068284}
confusion matrix:
     0    1
0  617   34
1  181  449
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8, 'precision': 0.8386363, 'recall': 0.79999995, 'specificity': 0.79999995, 'f1': 0.7941278, 'auroc': 0.9026568, 'binary_precision': 0.95302016, 'binary_recall': 0.6311111, 'binary_specificity': 0.9688889, 'binary_f1_score': 0.7593583}
confusion matrix:
     0    1
0  218    7
1   83  142
early stop counter: 2
val acc:0.8321623802185059, best validation acc: 0.8594847917556763, corresponding to test acc:                         0.8222222328186035 / 0.8600000143051147
after epoch: 15,now: 2024-07-27 02:35:57.292660,epoch time: 0:01:27.270144,used: 0:21:58.166482,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_02_13_58_seed_1_23090489
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9716797, 'precision': 0.9728775, 'recall': 0.97139746, 'specificity': 0.97139746, 'f1': 0.97164524, 'auroc': 0.99906486, 'binary_precision': 0.95197046, 'binary_recall': 0.9942122, 'binary_specificity': 0.9485827, 'binary_f1_score': 0.9726329}
confusion matrix:
      0     1
0  1439    78
1     9  1546
---- Validation: 
scalar performance:
{'acc': 0.7915691, 'precision': 0.81221163, 'recall': 0.7936508, 'specificity': 0.7936508, 'f1': 0.788826, 'auroc': 0.87389123, 'binary_precision': 0.72772896, 'binary_recall': 0.9206349, 'binary_specificity': 0.6666667, 'binary_f1_score': 0.8128942}
confusion matrix:
     0    1
0  434  217
1   50  580
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.75333333, 'precision': 0.7932367, 'recall': 0.75333333, 'specificity': 0.75333333, 'f1': 0.74464625, 'auroc': 0.88825184, 'binary_precision': 0.6850649, 'binary_recall': 0.93777776, 'binary_specificity': 0.5688889, 'binary_f1_score': 0.7917448}
confusion matrix:
     0    1
0  128   97
1   14  211
early stop counter: 3
val acc:0.7915691137313843, best validation acc: 0.8594847917556763, corresponding to test acc:                         0.8222222328186035 / 0.8600000143051147
after epoch: 16,now: 2024-07-27 02:37:24.197807,epoch time: 0:01:26.905147,used: 0:23:25.071629,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_02_13_58_seed_1_23090489
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9847005, 'precision': 0.9849936, 'recall': 0.984868, 'specificity': 0.984868, 'f1': 0.9847002, 'auroc': 0.9997563, 'binary_precision': 1.0, 'binary_recall': 0.969736, 'binary_specificity': 1.0, 'binary_f1_score': 0.9846355}
confusion matrix:
      0     1
0  1519     0
1    47  1506
---- Validation: 
scalar performance:
{'acc': 0.84777516, 'precision': 0.86132264, 'recall': 0.8461853, 'specificity': 0.8461853, 'f1': 0.84588134, 'auroc': 0.928018, 'binary_precision': 0.92730844, 'binary_recall': 0.74920636, 'binary_specificity': 0.94316435, 'binary_f1_score': 0.82879716}
confusion matrix:
     0    1
0  614   37
1  158  472
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.84444445, 'precision': 0.8654971, 'recall': 0.84444445, 'specificity': 0.84444445, 'f1': 0.84217167, 'auroc': 0.905679, 'binary_precision': 0.9532164, 'binary_recall': 0.72444445, 'binary_specificity': 0.96444446, 'binary_f1_score': 0.8232323}
confusion matrix:
     0    1
0  217    8
1   62  163
early stop counter: 4
val acc:0.8477751612663269, best validation acc: 0.8594847917556763, corresponding to test acc:                         0.8222222328186035 / 0.8600000143051147
after epoch: 17,now: 2024-07-27 02:38:51.044812,epoch time: 0:01:26.847005,used: 0:24:51.918634,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_02_13_58_seed_1_23090489
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.98567706, 'precision': 0.9856559, 'recall': 0.9857086, 'specificity': 0.9857086, 'f1': 0.9856756, 'auroc': 0.998919, 'binary_precision': 0.9883721, 'binary_recall': 0.9832905, 'binary_specificity': 0.98812664, 'binary_f1_score': 0.98582476}
confusion matrix:
      0     1
0  1498    18
1    26  1530
---- Validation: 
scalar performance:
{'acc': 0.7892272, 'precision': 0.81166923, 'recall': 0.78699434, 'specificity': 0.78699434, 'f1': 0.78443485, 'auroc': 0.8811858, 'binary_precision': 0.8913044, 'binary_recall': 0.6507937, 'binary_specificity': 0.92319506, 'binary_f1_score': 0.7522936}
confusion matrix:
     0    1
0  601   50
1  220  410
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.78444445, 'precision': 0.82679737, 'recall': 0.78444445, 'specificity': 0.78444445, 'f1': 0.77722657, 'auroc': 0.90733826, 'binary_precision': 0.9444444, 'binary_recall': 0.60444444, 'binary_specificity': 0.96444446, 'binary_f1_score': 0.73712736}
confusion matrix:
     0    1
0  217    8
1   89  136
early stop counter: 5
val acc:0.7892271876335144, best validation acc: 0.8594847917556763, corresponding to test acc:                         0.8222222328186035 / 0.8600000143051147
after epoch: 18,now: 2024-07-27 02:40:18.222444,epoch time: 0:01:27.177632,used: 0:26:19.096266,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_02_13_58_seed_1_23090489
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 18 with time: 0:26:19.096266 at 2024-07-27 02:40:18.222444
persisted model performance metric: 

scalar performance:
{'acc': 0.82222223, 'precision': 0.84689, 'recall': 0.82222223, 'specificity': 0.82222223, 'f1': 0.81900454, 'auroc': 0.9137975, 'binary_precision': 0.93939394, 'binary_recall': 0.6888889, 'binary_specificity': 0.95555556, 'binary_f1_score': 0.7948718}
confusion matrix:
     0    1
0  215   10
1   70  155
oracle model performance metric: 

scalar performance:
{'acc': 0.86, 'precision': 0.8612058, 'recall': 0.86, 'specificity': 0.86, 'f1': 0.85988307, 'auroc': 0.9040197, 'binary_precision': 0.8820755, 'binary_recall': 0.83111113, 'binary_specificity': 0.8888889, 'binary_f1_score': 0.85583526}
confusion matrix:
     0    1
0  200   25
1   38  187
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_diva_irm_3seeds_nofreeze_2024-07-27_01-18-02/rule_results/0.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_diva_irm_3seeds_nofreeze_2024-07-27_01-18-02/confusion_matrix/0.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 455469 KiB |   2004 MiB |  65335 GiB |  65335 GiB |
|       from large pool | 414870 KiB |   1971 MiB |  64496 GiB |  64496 GiB |
|       from small pool |  40598 KiB |     60 MiB |    839 GiB |    838 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 455469 KiB |   2004 MiB |  65335 GiB |  65335 GiB |
|       from large pool | 414870 KiB |   1971 MiB |  64496 GiB |  64496 GiB |
|       from small pool |  40598 KiB |     60 MiB |    839 GiB |    838 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 447481 KiB |   1998 MiB |  65095 GiB |  65094 GiB |
|       from large pool | 407075 KiB |   1966 MiB |  64257 GiB |  64257 GiB |
|       from small pool |  40406 KiB |     60 MiB |    837 GiB |    837 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2262 MiB |   2276 MiB |   3716 MiB |   1454 MiB |
|       from large pool |   2192 MiB |   2212 MiB |   3628 MiB |   1436 MiB |
|       from small pool |     70 MiB |     70 MiB |     88 MiB |     18 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 398547 KiB | 400040 KiB |  49998 GiB |  49997 GiB |
|       from large pool | 392041 KiB | 392041 KiB |  49114 GiB |  49114 GiB |
|       from small pool |   6505 KiB |  22117 KiB |    883 GiB |    883 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    1310    |    1681    |   12467 K  |   12466 K  |
|       from large pool |     187    |     311    |    5982 K  |    5982 K  |
|       from small pool |    1123    |    1419    |    6485 K  |    6484 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    1310    |    1681    |   12467 K  |   12466 K  |
|       from large pool |     187    |     311    |    5982 K  |    5982 K  |
|       from small pool |    1123    |    1419    |    6485 K  |    6484 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     126    |     126    |     193    |      67    |
|       from large pool |      91    |      92    |     149    |      58    |
|       from small pool |      35    |      35    |      44    |       9    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      73    |     257    |    6889 K  |    6889 K  |
|       from large pool |      34    |      90    |    4279 K  |    4279 K  |
|       from small pool |      39    |     223    |    2610 K  |    2610 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   2004 MiB |  65335 GiB |  65335 GiB |
|       from large pool |  16640 KiB |   1971 MiB |  64496 GiB |  64496 GiB |
|       from small pool |      0 KiB |     60 MiB |    839 GiB |    839 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   2004 MiB |  65335 GiB |  65335 GiB |
|       from large pool |  16640 KiB |   1971 MiB |  64496 GiB |  64496 GiB |
|       from small pool |      0 KiB |     60 MiB |    839 GiB |    839 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   1998 MiB |  65095 GiB |  65095 GiB |
|       from large pool |  16640 KiB |   1966 MiB |  64257 GiB |  64257 GiB |
|       from small pool |      0 KiB |     60 MiB |    837 GiB |    837 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    834 MiB |   2276 MiB |   3716 MiB |   2882 MiB |
|       from large pool |    788 MiB |   2212 MiB |   3628 MiB |   2840 MiB |
|       from small pool |     46 MiB |     70 MiB |     88 MiB |     42 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  30464 KiB | 418550 KiB |  49998 GiB |  49998 GiB |
|       from large pool |  30464 KiB | 409071 KiB |  49115 GiB |  49115 GiB |
|       from small pool |      0 KiB |  22117 KiB |    883 GiB |    883 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    1681    |   12467 K  |   12467 K  |
|       from large pool |       2    |     311    |    5982 K  |    5982 K  |
|       from small pool |       0    |    1419    |    6485 K  |    6485 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    1681    |   12467 K  |   12467 K  |
|       from large pool |       2    |     311    |    5982 K  |    5982 K  |
|       from small pool |       0    |    1419    |    6485 K  |    6485 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      57    |     126    |     193    |     136    |
|       from large pool |      34    |      92    |     149    |     115    |
|       from small pool |      23    |      35    |      44    |      21    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |     257    |    6889 K  |    6889 K  |
|       from large pool |       4    |      90    |    4279 K  |    4279 K  |
|       from small pool |       0    |     223    |    2610 K  |    2610 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   2004 MiB |  65335 GiB |  65335 GiB |
|       from large pool |  16640 KiB |   1971 MiB |  64496 GiB |  64496 GiB |
|       from small pool |      0 KiB |     60 MiB |    839 GiB |    839 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   2004 MiB |  65335 GiB |  65335 GiB |
|       from large pool |  16640 KiB |   1971 MiB |  64496 GiB |  64496 GiB |
|       from small pool |      0 KiB |     60 MiB |    839 GiB |    839 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   1998 MiB |  65095 GiB |  65095 GiB |
|       from large pool |  16640 KiB |   1966 MiB |  64257 GiB |  64257 GiB |
|       from small pool |      0 KiB |     60 MiB |    837 GiB |    837 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    834 MiB |   2276 MiB |   3716 MiB |   2882 MiB |
|       from large pool |    788 MiB |   2212 MiB |   3628 MiB |   2840 MiB |
|       from small pool |     46 MiB |     70 MiB |     88 MiB |     42 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  30464 KiB | 418550 KiB |  49998 GiB |  49998 GiB |
|       from large pool |  30464 KiB | 409071 KiB |  49115 GiB |  49115 GiB |
|       from small pool |      0 KiB |  22117 KiB |    883 GiB |    883 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    1681    |   12467 K  |   12467 K  |
|       from large pool |       2    |     311    |    5982 K  |    5982 K  |
|       from small pool |       0    |    1419    |    6485 K  |    6485 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    1681    |   12467 K  |   12467 K  |
|       from large pool |       2    |     311    |    5982 K  |    5982 K  |
|       from small pool |       0    |    1419    |    6485 K  |    6485 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      57    |     126    |     193    |     136    |
|       from large pool |      34    |      92    |     149    |     115    |
|       from small pool |      23    |      35    |      44    |      21    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |     257    |    6889 K  |    6889 K  |
|       from large pool |       4    |      90    |    4279 K  |    4279 K  |
|       from small pool |       0    |     223    |    2610 K  |    2610 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_02_40_51_seed_2_23090489

 Experiment start at: 2024-07-27 02:40:51.593678
before training, model accuracy: 0.41203704476356506
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.96924084, 'precision': 0.9698111, 'recall': 0.9691156, 'specificity': 0.9691156, 'f1': 0.96922374, 'auroc': 0.9970942, 'binary_precision': 0.95528966, 'binary_recall': 0.9850649, 'binary_specificity': 0.95316625, 'binary_f1_score': 0.9699488}
confusion matrix:
      0     1
0  1445    71
1    23  1517
---- Validation: 
scalar performance:
{'acc': 0.68622845, 'precision': 0.70769817, 'recall': 0.6902351, 'specificity': 0.6902351, 'f1': 0.6806439, 'auroc': 0.7459439, 'binary_precision': 0.6339394, 'binary_recall': 0.840836, 'binary_specificity': 0.53963417, 'binary_f1_score': 0.7228749}
confusion matrix:
     0    1
0  354  302
1   99  523
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7060185, 'precision': 0.7417079, 'recall': 0.7060185, 'specificity': 0.7060185, 'f1': 0.69475067, 'auroc': 0.83631253, 'binary_precision': 0.64882946, 'binary_recall': 0.8981481, 'binary_specificity': 0.5138889, 'binary_f1_score': 0.7533981}
confusion matrix:
     0    1
0  111  105
1   22  194
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-27 02:42:22.744407,epoch time: 0:01:31.150729,used: 0:01:31.150729,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_02_40_51_seed_2_23090489
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9728403, 'precision': 0.97290796, 'recall': 0.9729029, 'specificity': 0.9729029, 'f1': 0.9728403, 'auroc': 0.9966509, 'binary_precision': 0.9808581, 'binary_recall': 0.96493506, 'binary_specificity': 0.9808707, 'binary_f1_score': 0.9728314}
confusion matrix:
      0     1
0  1487    29
1    54  1486
---- Validation: 
scalar performance:
{'acc': 0.799687, 'precision': 0.8119401, 'recall': 0.796962, 'specificity': 0.796962, 'f1': 0.7965778, 'auroc': 0.87386286, 'binary_precision': 0.8674699, 'binary_recall': 0.69453377, 'binary_specificity': 0.8993902, 'binary_f1_score': 0.77142864}
confusion matrix:
     0    1
0  590   66
1  190  432
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8217593, 'precision': 0.85167617, 'recall': 0.8217592, 'specificity': 0.8217592, 'f1': 0.81788623, 'auroc': 0.90933645, 'binary_precision': 0.95424837, 'binary_recall': 0.6759259, 'binary_specificity': 0.9675926, 'binary_f1_score': 0.7913279}
confusion matrix:
     0    1
0  209    7
1   70  146
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-07-27 02:43:49.892597,epoch time: 0:01:27.148190,used: 0:02:58.298919,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_02_40_51_seed_2_23090489
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.97447646, 'precision': 0.97462404, 'recall': 0.97441834, 'specificity': 0.97441834, 'f1': 0.9744706, 'auroc': 0.99684876, 'binary_precision': 0.96798974, 'binary_recall': 0.9818182, 'binary_specificity': 0.9670185, 'binary_f1_score': 0.97485495}
confusion matrix:
      0     1
0  1466    50
1    28  1512
---- Validation: 
scalar performance:
{'acc': 0.7746479, 'precision': 0.78287786, 'recall': 0.77682143, 'specificity': 0.77682143, 'f1': 0.77380526, 'auroc': 0.8656404, 'binary_precision': 0.7275204, 'binary_recall': 0.8585209, 'binary_specificity': 0.69512194, 'binary_f1_score': 0.7876106}
confusion matrix:
     0    1
0  456  200
1   88  534
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8032407, 'precision': 0.81048787, 'recall': 0.8032408, 'specificity': 0.8032408, 'f1': 0.8020859, 'auroc': 0.89941275, 'binary_precision': 0.7630522, 'binary_recall': 0.8796296, 'binary_specificity': 0.7268519, 'binary_f1_score': 0.8172043}
confusion matrix:
     0    1
0  157   59
1   26  190
early stop counter: 1
val acc:0.7746478915214539, best validation acc: 0.7996870279312134, corresponding to test acc:                         0.8217592835426331 / 0.8217592835426331
after epoch: 3,now: 2024-07-27 02:45:16.489452,epoch time: 0:01:26.596855,used: 0:04:24.895774,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_02_40_51_seed_2_23090489
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9633508, 'precision': 0.9653177, 'recall': 0.96310693, 'specificity': 0.96310693, 'f1': 0.96329606, 'auroc': 0.99803483, 'binary_precision': 0.9369645, 'binary_recall': 0.9941558, 'binary_specificity': 0.93205804, 'binary_f1_score': 0.9647133}
confusion matrix:
      0     1
0  1413   103
1     9  1531
---- Validation: 
scalar performance:
{'acc': 0.827856, 'precision': 0.8279257, 'recall': 0.82815075, 'specificity': 0.82815075, 'f1': 0.8278354, 'auroc': 0.89952755, 'binary_precision': 0.8130841, 'binary_recall': 0.8392283, 'binary_specificity': 0.81707317, 'binary_f1_score': 0.8259494}
confusion matrix:
     0    1
0  536  120
1  100  522
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.837963, 'precision': 0.8403263, 'recall': 0.837963, 'specificity': 0.837963, 'f1': 0.8376812, 'auroc': 0.9106225, 'binary_precision': 0.8119658, 'binary_recall': 0.8796296, 'binary_specificity': 0.7962963, 'binary_f1_score': 0.84444445}
confusion matrix:
     0    1
0  172   44
1   26  190
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-07-27 02:46:43.359341,epoch time: 0:01:26.869889,used: 0:05:51.765663,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_02_40_51_seed_2_23090489
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.97971207, 'precision': 0.9799178, 'recall': 0.97980845, 'specificity': 0.97980845, 'f1': 0.97971165, 'auroc': 0.99850297, 'binary_precision': 0.99201065, 'binary_recall': 0.96753246, 'binary_specificity': 0.99208444, 'binary_f1_score': 0.97961867}
confusion matrix:
      0     1
0  1504    12
1    50  1490
---- Validation: 
scalar performance:
{'acc': 0.69640064, 'precision': 0.78766584, 'recall': 0.68872786, 'specificity': 0.68872786, 'f1': 0.66487074, 'auroc': 0.8956307, 'binary_precision': 0.9431818, 'binary_recall': 0.40032154, 'binary_specificity': 0.97713417, 'binary_f1_score': 0.56207675}
confusion matrix:
     0    1
0  641   15
1  373  249
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5138889, 'precision': 0.7535211, 'recall': 0.5138889, 'specificity': 0.5138889, 'f1': 0.36347565, 'auroc': 0.9065072, 'binary_precision': 1.0, 'binary_recall': 0.027777778, 'binary_specificity': 1.0, 'binary_f1_score': 0.054054055}
confusion matrix:
     0  1
0  216  0
1  210  6
early stop counter: 1
val acc:0.6964006423950195, best validation acc: 0.8278560042381287, corresponding to test acc:                         0.8379629850387573 / 0.8379629850387573
after epoch: 5,now: 2024-07-27 02:48:09.917761,epoch time: 0:01:26.558420,used: 0:07:18.324083,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_02_40_51_seed_2_23090489
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9816754, 'precision': 0.98168707, 'recall': 0.98166394, 'specificity': 0.98166394, 'f1': 0.98167384, 'auroc': 0.9978039, 'binary_precision': 0.98056996, 'binary_recall': 0.98311687, 'binary_specificity': 0.9802111, 'binary_f1_score': 0.9818418}
confusion matrix:
      0     1
0  1486    30
1    26  1514
---- Validation: 
scalar performance:
{'acc': 0.7605634, 'precision': 0.7971583, 'recall': 0.75576913, 'specificity': 0.75576913, 'f1': 0.75055426, 'auroc': 0.8860898, 'binary_precision': 0.895, 'binary_recall': 0.5755627, 'binary_specificity': 0.9359756, 'binary_f1_score': 0.7005871}
confusion matrix:
     0    1
0  614   42
1  264  358
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8564815, 'precision': 0.86786693, 'recall': 0.85648143, 'specificity': 0.85648143, 'f1': 0.85536236, 'auroc': 0.9302555, 'binary_precision': 0.9325843, 'binary_recall': 0.7685185, 'binary_specificity': 0.9444444, 'binary_f1_score': 0.8426396}
confusion matrix:
     0    1
0  204   12
1   50  166
new oracle model saved
early stop counter: 2
val acc:0.7605633735656738, best validation acc: 0.8278560042381287, corresponding to test acc:                         0.8379629850387573 / 0.8564814925193787
after epoch: 6,now: 2024-07-27 02:49:36.686790,epoch time: 0:01:26.769029,used: 0:08:45.093112,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_02_40_51_seed_2_23090489
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9787304, 'precision': 0.97877973, 'recall': 0.97870076, 'specificity': 0.97870076, 'f1': 0.9787276, 'auroc': 0.9975572, 'binary_precision': 0.9754997, 'binary_recall': 0.98246753, 'binary_specificity': 0.97493404, 'binary_f1_score': 0.9789712}
confusion matrix:
      0     1
0  1478    38
1    27  1513
---- Validation: 
scalar performance:
{'acc': 0.7965571, 'precision': 0.80824935, 'recall': 0.7938715, 'specificity': 0.7938715, 'f1': 0.7934799, 'auroc': 0.86102927, 'binary_precision': 0.862, 'binary_recall': 0.69292605, 'binary_specificity': 0.89481705, 'binary_f1_score': 0.76827097}
confusion matrix:
     0    1
0  587   69
1  191  431
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7546296, 'precision': 0.7610989, 'recall': 0.7546296, 'specificity': 0.7546296, 'f1': 0.7531003, 'auroc': 0.83269036, 'binary_precision': 0.8021978, 'binary_recall': 0.6759259, 'binary_specificity': 0.8333333, 'binary_f1_score': 0.7336684}
confusion matrix:
     0    1
0  180   36
1   70  146
early stop counter: 3
val acc:0.7965571284294128, best validation acc: 0.8278560042381287, corresponding to test acc:                         0.8379629850387573 / 0.8564814925193787
after epoch: 7,now: 2024-07-27 02:51:03.306397,epoch time: 0:01:26.619607,used: 0:10:11.712719,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_02_40_51_seed_2_23090489
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.98658377, 'precision': 0.9865761, 'recall': 0.98660094, 'specificity': 0.98660094, 'f1': 0.98658335, 'auroc': 0.9990988, 'binary_precision': 0.9889106, 'binary_recall': 0.9844156, 'binary_specificity': 0.9887863, 'binary_f1_score': 0.986658}
confusion matrix:
      0     1
0  1499    17
1    24  1516
---- Validation: 
scalar performance:
{'acc': 0.82472616, 'precision': 0.83572304, 'recall': 0.82226884, 'specificity': 0.82226884, 'f1': 0.8224084, 'auroc': 0.89807415, 'binary_precision': 0.8901961, 'binary_recall': 0.7299035, 'binary_specificity': 0.91463417, 'binary_f1_score': 0.80212015}
confusion matrix:
     0    1
0  600   56
1  168  454
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.849537, 'precision': 0.86539626, 'recall': 0.849537, 'specificity': 0.849537, 'f1': 0.84788644, 'auroc': 0.9126158, 'binary_precision': 0.94152045, 'binary_recall': 0.7453704, 'binary_specificity': 0.9537037, 'binary_f1_score': 0.8320413}
confusion matrix:
     0    1
0  206   10
1   55  161
early stop counter: 4
val acc:0.8247261643409729, best validation acc: 0.8278560042381287, corresponding to test acc:                         0.8379629850387573 / 0.8564814925193787
after epoch: 8,now: 2024-07-27 02:52:30.006270,epoch time: 0:01:26.699873,used: 0:11:38.412592,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_02_40_51_seed_2_23090489
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.98625654, 'precision': 0.9862517, 'recall': 0.98626083, 'specificity': 0.98626083, 'f1': 0.9862559, 'auroc': 0.9995233, 'binary_precision': 0.9869961, 'binary_recall': 0.98571426, 'binary_specificity': 0.9868074, 'binary_f1_score': 0.98635477}
confusion matrix:
      0     1
0  1496    20
1    22  1518
---- Validation: 
scalar performance:
{'acc': 0.7605634, 'precision': 0.81892425, 'recall': 0.7547692, 'specificity': 0.7547692, 'f1': 0.7462028, 'auroc': 0.8932339, 'binary_precision': 0.9488636, 'binary_recall': 0.53697747, 'binary_specificity': 0.972561, 'binary_f1_score': 0.6858316}
confusion matrix:
     0    1
0  638   18
1  288  334
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7060185, 'precision': 0.80023426, 'recall': 0.7060185, 'specificity': 0.7060185, 'f1': 0.6809917, 'auroc': 0.88921034, 'binary_precision': 0.96842104, 'binary_recall': 0.42592594, 'binary_specificity': 0.9861111, 'binary_f1_score': 0.5916399}
confusion matrix:
     0   1
0  213   3
1  124  92
early stop counter: 5
val acc:0.7605633735656738, best validation acc: 0.8278560042381287, corresponding to test acc:                         0.8379629850387573 / 0.8564814925193787
after epoch: 9,now: 2024-07-27 02:53:56.411846,epoch time: 0:01:26.405576,used: 0:13:04.818168,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_02_40_51_seed_2_23090489
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 9 with time: 0:13:04.818168 at 2024-07-27 02:53:56.411846
persisted model performance metric: 

scalar performance:
{'acc': 0.837963, 'precision': 0.8403263, 'recall': 0.837963, 'specificity': 0.837963, 'f1': 0.8376812, 'auroc': 0.9106225, 'binary_precision': 0.8119658, 'binary_recall': 0.8796296, 'binary_specificity': 0.7962963, 'binary_f1_score': 0.84444445}
confusion matrix:
     0    1
0  172   44
1   26  190
oracle model performance metric: 

scalar performance:
{'acc': 0.8564815, 'precision': 0.86786693, 'recall': 0.85648143, 'specificity': 0.85648143, 'f1': 0.85536236, 'auroc': 0.9302555, 'binary_precision': 0.9325843, 'binary_recall': 0.7685185, 'binary_specificity': 0.9444444, 'binary_f1_score': 0.8426396}
confusion matrix:
     0    1
0  204   12
1   50  166
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_diva_irm_3seeds_nofreeze_2024-07-27_01-18-02/rule_results/0.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_diva_irm_3seeds_nofreeze_2024-07-27_01-18-02/confusion_matrix/0.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 455387 KiB |   2004 MiB |  84897 GiB |  84897 GiB |
|       from large pool | 414795 KiB |   1971 MiB |  83808 GiB |  83807 GiB |
|       from small pool |  40592 KiB |     60 MiB |   1089 GiB |   1089 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 455387 KiB |   2004 MiB |  84897 GiB |  84897 GiB |
|       from large pool | 414795 KiB |   1971 MiB |  83808 GiB |  83807 GiB |
|       from small pool |  40592 KiB |     60 MiB |   1089 GiB |   1089 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 447481 KiB |   1998 MiB |  84590 GiB |  84589 GiB |
|       from large pool | 407075 KiB |   1966 MiB |  83503 GiB |  83502 GiB |
|       from small pool |  40406 KiB |     60 MiB |   1087 GiB |   1086 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2268 MiB |   2276 MiB |   5150 MiB |   2882 MiB |
|       from large pool |   2204 MiB |   2212 MiB |   5044 MiB |   2840 MiB |
|       from small pool |     64 MiB |     70 MiB |    106 MiB |     42 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 367908 KiB | 418550 KiB |  65173 GiB |  65172 GiB |
|       from large pool | 361397 KiB | 409071 KiB |  64026 GiB |  64026 GiB |
|       from small pool |   6511 KiB |  22117 KiB |   1146 GiB |   1146 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    1298    |    1681    |   16197 K  |   16196 K  |
|       from large pool |     187    |     311    |    7773 K  |    7773 K  |
|       from small pool |    1111    |    1419    |    8424 K  |    8422 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    1298    |    1681    |   16197 K  |   16196 K  |
|       from large pool |     187    |     311    |    7773 K  |    7773 K  |
|       from small pool |    1111    |    1419    |    8424 K  |    8422 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     123    |     126    |     259    |     136    |
|       from large pool |      91    |      92    |     206    |     115    |
|       from small pool |      32    |      35    |      53    |      21    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      70    |     257    |    8783 K  |    8782 K  |
|       from large pool |      34    |      90    |    5404 K  |    5404 K  |
|       from small pool |      36    |     223    |    3378 K  |    3378 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   2004 MiB |  84897 GiB |  84897 GiB |
|       from large pool |  16640 KiB |   1971 MiB |  83808 GiB |  83808 GiB |
|       from small pool |      0 KiB |     60 MiB |   1089 GiB |   1089 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   2004 MiB |  84897 GiB |  84897 GiB |
|       from large pool |  16640 KiB |   1971 MiB |  83808 GiB |  83808 GiB |
|       from small pool |      0 KiB |     60 MiB |   1089 GiB |   1089 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   1998 MiB |  84590 GiB |  84590 GiB |
|       from large pool |  16640 KiB |   1966 MiB |  83503 GiB |  83503 GiB |
|       from small pool |      0 KiB |     60 MiB |   1087 GiB |   1087 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    804 MiB |   2276 MiB |   5150 MiB |   4346 MiB |
|       from large pool |    758 MiB |   2212 MiB |   5044 MiB |   4286 MiB |
|       from small pool |     46 MiB |     70 MiB |    106 MiB |     60 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  30464 KiB | 418550 KiB |  65173 GiB |  65173 GiB |
|       from large pool |  30464 KiB | 409071 KiB |  64027 GiB |  64027 GiB |
|       from small pool |      0 KiB |  22117 KiB |   1146 GiB |   1146 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    1681    |   16197 K  |   16197 K  |
|       from large pool |       2    |     311    |    7773 K  |    7773 K  |
|       from small pool |       0    |    1419    |    8424 K  |    8424 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    1681    |   16197 K  |   16197 K  |
|       from large pool |       2    |     311    |    7773 K  |    7773 K  |
|       from small pool |       0    |    1419    |    8424 K  |    8424 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      57    |     126    |     259    |     202    |
|       from large pool |      34    |      92    |     206    |     172    |
|       from small pool |      23    |      35    |      53    |      30    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |     257    |    8783 K  |    8783 K  |
|       from large pool |       4    |      90    |    5404 K  |    5404 K  |
|       from small pool |       0    |     223    |    3378 K  |    3378 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Sat Jul 27 02:54:03 2024]
Finished job 0.
1 of 1 steps (100%) done
