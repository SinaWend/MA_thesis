Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Sat Jul 27 02:05:51 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_diva_irm_3seeds_nofreeze_2024-07-27_01-18-02/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_diva_irm_3seeds_nofreeze_2024-07-27_01-18-02/rule_results/15.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=15
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/swiglu_ffn.py:51: UserWarning: xFormers is not available (SwiGLU)
  warnings.warn("xFormers is not available (SwiGLU)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/attention.py:33: UserWarning: xFormers is not available (Attention)
  warnings.warn("xFormers is not available (Attention)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/block.py:40: UserWarning: xFormers is not available (Block)
  warnings.warn("xFormers is not available (Block)")
Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main

using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_02_06_41_seed_0_23090491

 Experiment start at: 2024-07-27 02:06:42.338318
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
before training, model accuracy: 0.46279069781303406
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.88378906, 'precision': 0.90419817, 'recall': 0.8852658, 'specificity': 0.8852658, 'f1': 0.88257, 'auroc': 0.9793284, 'binary_precision': 0.9983375, 'binary_recall': 0.7718509, 'binary_specificity': 0.9986807, 'binary_f1_score': 0.87060535}
confusion matrix:
      0     1
0  1514     2
1   355  1201
---- Validation: 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
scalar performance:
{'acc': 0.66770184, 'precision': 0.7310033, 'recall': 0.66396886, 'specificity': 0.66396886, 'f1': 0.64021593, 'auroc': 0.8552797, 'binary_precision': 0.8484849, 'binary_recall': 0.3968504, 'binary_specificity': 0.9310873, 'binary_f1_score': 0.5407725}
confusion matrix:
     0    1
0  608   45
1  383  252
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.81860465, 'precision': 0.8400563, 'recall': 0.81860465, 'specificity': 0.81860465, 'f1': 0.8156981, 'auroc': 0.8969822, 'binary_precision': 0.9254658, 'binary_recall': 0.69302326, 'binary_specificity': 0.94418603, 'binary_f1_score': 0.79255325}
confusion matrix:
     0    1
0  203   12
1   66  149
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-27 02:08:13.337645,epoch time: 0:01:30.999327,used: 0:01:30.999327,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_02_06_41_seed_0_23090491
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.945638, 'precision': 0.945888, 'recall': 0.94549876, 'specificity': 0.94549876, 'f1': 0.945609, 'auroc': 0.9901885, 'binary_precision': 0.93820935, 'binary_recall': 0.955684, 'binary_specificity': 0.9353135, 'binary_f1_score': 0.94686604}
confusion matrix:
      0     1
0  1417    98
1    69  1488
---- Validation: 
scalar performance:
{'acc': 0.6218944, 'precision': 0.7664794, 'recall': 0.6269754, 'specificity': 0.6269754, 'f1': 0.56743795, 'auroc': 0.9156238, 'binary_precision': 0.56666666, 'binary_recall': 0.9905512, 'binary_specificity': 0.2633997, 'binary_f1_score': 0.72091687}
confusion matrix:
     0    1
0  172  481
1    6  629
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.61627907, 'precision': 0.75663674, 'recall': 0.61627907, 'specificity': 0.61627907, 'f1': 0.555504, 'auroc': 0.9126879, 'binary_precision': 0.56684494, 'binary_recall': 0.9860465, 'binary_specificity': 0.24651162, 'binary_f1_score': 0.71986413}
confusion matrix:
    0    1
0  53  162
1   3  212
early stop counter: 1
val acc:0.6218944191932678, best validation acc: 0.6677018404006958, corresponding to test acc:                         0.8186046481132507 / 0.8186046481132507
after epoch: 2,now: 2024-07-27 02:09:36.690817,epoch time: 0:01:23.353172,used: 0:02:54.352499,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_02_06_41_seed_0_23090491
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9355469, 'precision': 0.9399594, 'recall': 0.93494904, 'specificity': 0.93494904, 'f1': 0.9353148, 'auroc': 0.99255556, 'binary_precision': 0.898883, 'binary_recall': 0.98327976, 'binary_specificity': 0.8866183, 'binary_f1_score': 0.93918914}
confusion matrix:
      0     1
0  1345   172
1    26  1529
---- Validation: 
scalar performance:
{'acc': 0.7453416, 'precision': 0.79079914, 'recall': 0.7480701, 'specificity': 0.7480701, 'f1': 0.736339, 'auroc': 0.90214515, 'binary_precision': 0.67227834, 'binary_recall': 0.9433071, 'binary_specificity': 0.5528331, 'binary_f1_score': 0.785059}
confusion matrix:
     0    1
0  361  292
1   36  599
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7372093, 'precision': 0.7836558, 'recall': 0.7372093, 'specificity': 0.7372093, 'f1': 0.7259927, 'auroc': 0.9126663, 'binary_precision': 0.66887414, 'binary_recall': 0.9395349, 'binary_specificity': 0.53488374, 'binary_f1_score': 0.7814313}
confusion matrix:
     0    1
0  115  100
1   13  202
better model found
persisted
after epoch: 3,now: 2024-07-27 02:11:00.348214,epoch time: 0:01:23.657397,used: 0:04:18.009896,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_02_06_41_seed_0_23090491
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.95247394, 'precision': 0.9528738, 'recall': 0.95230484, 'specificity': 0.95230484, 'f1': 0.9524433, 'auroc': 0.9922298, 'binary_precision': 0.9422836, 'binary_recall': 0.9652956, 'binary_specificity': 0.939314, 'binary_f1_score': 0.9536508}
confusion matrix:
      0     1
0  1424    92
1    54  1502
---- Validation: 
scalar performance:
{'acc': 0.8369565, 'precision': 0.8379565, 'recall': 0.837337, 'specificity': 0.837337, 'f1': 0.83691716, 'auroc': 0.9126985, 'binary_precision': 0.81575036, 'binary_recall': 0.8645669, 'binary_specificity': 0.8101072, 'binary_f1_score': 0.8394495}
confusion matrix:
     0    1
0  529  124
1   86  549
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8116279, 'precision': 0.8191466, 'recall': 0.81162786, 'specificity': 0.81162786, 'f1': 0.8105118, 'auroc': 0.9224013, 'binary_precision': 0.7701613, 'binary_recall': 0.88837206, 'binary_specificity': 0.7348837, 'binary_f1_score': 0.82505393}
confusion matrix:
     0    1
0  158   57
1   24  191
better model found
persisted
after epoch: 4,now: 2024-07-27 02:12:24.829602,epoch time: 0:01:24.481388,used: 0:05:42.491284,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_02_06_41_seed_0_23090491
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.94401044, 'precision': 0.9490521, 'recall': 0.94473004, 'specificity': 0.94473004, 'f1': 0.9439069, 'auroc': 0.9967464, 'binary_precision': 1.0, 'binary_recall': 0.88946015, 'binary_specificity': 1.0, 'binary_f1_score': 0.9414966}
confusion matrix:
      0     1
0  1516     0
1   172  1384
---- Validation: 
scalar performance:
{'acc': 0.7717391, 'precision': 0.81808645, 'recall': 0.76904655, 'specificity': 0.76904655, 'f1': 0.7618864, 'auroc': 0.9046701, 'binary_precision': 0.9360614, 'binary_recall': 0.5763779, 'binary_specificity': 0.96171516, 'binary_f1_score': 0.71345025}
confusion matrix:
     0    1
0  628   25
1  269  366
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8255814, 'precision': 0.8540843, 'recall': 0.82558143, 'specificity': 0.82558143, 'f1': 0.8219993, 'auroc': 0.9023472, 'binary_precision': 0.95454544, 'binary_recall': 0.68372095, 'binary_specificity': 0.96744186, 'binary_f1_score': 0.79674804}
confusion matrix:
     0    1
0  208    7
1   68  147
new oracle model saved
early stop counter: 1
val acc:0.77173912525177, best validation acc: 0.8369565010070801, corresponding to test acc:                         0.8116279244422913 / 0.8255813717842102
after epoch: 5,now: 2024-07-27 02:13:48.612043,epoch time: 0:01:23.782441,used: 0:07:06.273725,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_02_06_41_seed_0_23090491
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9625651, 'precision': 0.9645188, 'recall': 0.96309793, 'specificity': 0.96309793, 'f1': 0.9625483, 'auroc': 0.9972439, 'binary_precision': 0.9986188, 'binary_recall': 0.92751765, 'binary_specificity': 0.99867815, 'binary_f1_score': 0.9617559}
confusion matrix:
      0     1
0  1511     2
1   113  1446
---- Validation: 
scalar performance:
{'acc': 0.83540374, 'precision': 0.8463165, 'recall': 0.8341561, 'specificity': 0.8341561, 'f1': 0.83370966, 'auroc': 0.9106101, 'binary_precision': 0.9043977, 'binary_recall': 0.74488187, 'binary_specificity': 0.9234303, 'binary_f1_score': 0.8169257}
confusion matrix:
     0    1
0  603   50
1  162  473
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.83488375, 'precision': 0.8350649, 'recall': 0.8348837, 'specificity': 0.8348837, 'f1': 0.8348614, 'auroc': 0.9175122, 'binary_precision': 0.8428571, 'binary_recall': 0.82325584, 'binary_specificity': 0.8465116, 'binary_f1_score': 0.83294123}
confusion matrix:
     0    1
0  182   33
1   38  177
new oracle model saved
early stop counter: 2
val acc:0.8354037404060364, best validation acc: 0.8369565010070801, corresponding to test acc:                         0.8116279244422913 / 0.8348837494850159
after epoch: 6,now: 2024-07-27 02:15:12.440694,epoch time: 0:01:23.828651,used: 0:08:30.102376,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_02_06_41_seed_0_23090491
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9609375, 'precision': 0.9632826, 'recall': 0.9613823, 'specificity': 0.9613823, 'f1': 0.96090966, 'auroc': 0.99616754, 'binary_precision': 0.99930364, 'binary_recall': 0.9234234, 'binary_specificity': 0.99934125, 'binary_f1_score': 0.9598662}
confusion matrix:
      0     1
0  1517     1
1   119  1435
---- Validation: 
scalar performance:
{'acc': 0.8253106, 'precision': 0.843791, 'recall': 0.8236811, 'specificity': 0.8236811, 'f1': 0.8223959, 'auroc': 0.9175483, 'binary_precision': 0.920082, 'binary_recall': 0.7070866, 'binary_specificity': 0.94027567, 'binary_f1_score': 0.7996438}
confusion matrix:
     0    1
0  614   39
1  186  449
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8418605, 'precision': 0.8582602, 'recall': 0.8418605, 'specificity': 0.8418605, 'f1': 0.8400297, 'auroc': 0.9150677, 'binary_precision': 0.93491125, 'binary_recall': 0.7348837, 'binary_specificity': 0.9488372, 'binary_f1_score': 0.8229166}
confusion matrix:
     0    1
0  204   11
1   57  158
new oracle model saved
early stop counter: 3
val acc:0.8253105878829956, best validation acc: 0.8369565010070801, corresponding to test acc:                         0.8116279244422913 / 0.8418604731559753
after epoch: 7,now: 2024-07-27 02:16:36.124011,epoch time: 0:01:23.683317,used: 0:09:53.785693,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_02_06_41_seed_0_23090491
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.97721356, 'precision': 0.97724366, 'recall': 0.97730196, 'specificity': 0.97730196, 'f1': 0.9772132, 'auroc': 0.99733186, 'binary_precision': 0.9849673, 'binary_recall': 0.9697555, 'binary_specificity': 0.9848485, 'binary_f1_score': 0.9773022}
confusion matrix:
      0     1
0  1495    23
1    47  1507
---- Validation: 
scalar performance:
{'acc': 0.8431677, 'precision': 0.8441803, 'recall': 0.8435495, 'specificity': 0.8435495, 'f1': 0.8431299, 'auroc': 0.91552496, 'binary_precision': 0.8216939, 'binary_recall': 0.8708661, 'binary_specificity': 0.8162328, 'binary_f1_score': 0.84556574}
confusion matrix:
     0    1
0  533  120
1   82  553
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.82790697, 'precision': 0.82816255, 'recall': 0.82790697, 'specificity': 0.82790697, 'f1': 0.82787347, 'auroc': 0.92806923, 'binary_precision': 0.81900454, 'binary_recall': 0.8418605, 'binary_specificity': 0.81395346, 'binary_f1_score': 0.8302752}
confusion matrix:
     0    1
0  175   40
1   34  181
better model found
persisted
after epoch: 8,now: 2024-07-27 02:17:59.820241,epoch time: 0:01:23.696230,used: 0:11:17.481923,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_02_06_41_seed_0_23090491
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.95735675, 'precision': 0.96025485, 'recall': 0.9578778, 'specificity': 0.9578778, 'f1': 0.95731765, 'auroc': 0.99821526, 'binary_precision': 1.0, 'binary_recall': 0.9157556, 'binary_specificity': 1.0, 'binary_f1_score': 0.95602554}
confusion matrix:
      0     1
0  1517     0
1   131  1424
---- Validation: 
scalar performance:
{'acc': 0.6560559, 'precision': 0.75009537, 'recall': 0.65170205, 'specificity': 0.65170205, 'f1': 0.6166396, 'auroc': 0.8416467, 'binary_precision': 0.9, 'binary_recall': 0.34015748, 'binary_specificity': 0.9632466, 'binary_f1_score': 0.49371427}
confusion matrix:
     0    1
0  629   24
1  419  216
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.82790697, 'precision': 0.8556012, 'recall': 0.82790697, 'specificity': 0.82790697, 'f1': 0.82448983, 'auroc': 0.9329151, 'binary_precision': 0.9548387, 'binary_recall': 0.6883721, 'binary_specificity': 0.96744186, 'binary_f1_score': 0.8}
confusion matrix:
     0    1
0  208    7
1   67  148
early stop counter: 1
val acc:0.6560559272766113, best validation acc: 0.8431677222251892, corresponding to test acc:                         0.8279069662094116 / 0.8418604731559753
after epoch: 9,now: 2024-07-27 02:19:21.538583,epoch time: 0:01:21.718342,used: 0:12:39.200265,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_02_06_41_seed_0_23090491
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9749349, 'precision': 0.97540665, 'recall': 0.97518075, 'specificity': 0.97518075, 'f1': 0.9749339, 'auroc': 0.9974035, 'binary_precision': 0.993988, 'binary_recall': 0.9562982, 'binary_specificity': 0.9940633, 'binary_f1_score': 0.9747789}
confusion matrix:
      0     1
0  1507     9
1    68  1488
---- Validation: 
scalar performance:
{'acc': 0.8245342, 'precision': 0.8246952, 'recall': 0.8246952, 'specificity': 0.8246952, 'f1': 0.8245341, 'auroc': 0.8875185, 'binary_precision': 0.81316996, 'binary_recall': 0.83622044, 'binary_specificity': 0.81316996, 'binary_f1_score': 0.8245341}
confusion matrix:
     0    1
0  531  122
1  104  531
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8255814, 'precision': 0.8366589, 'recall': 0.82558143, 'specificity': 0.82558143, 'f1': 0.8241347, 'auroc': 0.92480254, 'binary_precision': 0.77559054, 'binary_recall': 0.9162791, 'binary_specificity': 0.7348837, 'binary_f1_score': 0.84008527}
confusion matrix:
     0    1
0  158   57
1   18  197
early stop counter: 2
val acc:0.8245341777801514, best validation acc: 0.8431677222251892, corresponding to test acc:                         0.8279069662094116 / 0.8418604731559753
after epoch: 10,now: 2024-07-27 02:20:43.056025,epoch time: 0:01:21.517442,used: 0:14:00.717707,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_02_06_41_seed_0_23090491
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9720052, 'precision': 0.972871, 'recall': 0.97172594, 'specificity': 0.97172594, 'f1': 0.9719743, 'auroc': 0.9983996, 'binary_precision': 0.95603716, 'binary_recall': 0.99037844, 'binary_specificity': 0.9530734, 'binary_f1_score': 0.97290486}
confusion matrix:
      0     1
0  1442    71
1    15  1544
---- Validation: 
scalar performance:
{'acc': 0.8462733, 'precision': 0.8490155, 'recall': 0.8468944, 'specificity': 0.8468944, 'f1': 0.8461096, 'auroc': 0.91425884, 'binary_precision': 0.8143885, 'binary_recall': 0.8913386, 'binary_specificity': 0.80245024, 'binary_f1_score': 0.8511278}
confusion matrix:
     0    1
0  524  129
1   69  566
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8697674, 'precision': 0.8700557, 'recall': 0.8697674, 'specificity': 0.8697674, 'f1': 0.8697421, 'auroc': 0.94580853, 'binary_precision': 0.8597285, 'binary_recall': 0.88372093, 'binary_specificity': 0.855814, 'binary_f1_score': 0.8715596}
confusion matrix:
     0    1
0  184   31
1   25  190
new oracle model saved
better model found
persisted
after epoch: 11,now: 2024-07-27 02:22:05.449599,epoch time: 0:01:22.393574,used: 0:15:23.111281,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_02_06_41_seed_0_23090491
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9746094, 'precision': 0.9749862, 'recall': 0.97483397, 'specificity': 0.97483397, 'f1': 0.97460884, 'auroc': 0.9978714, 'binary_precision': 0.99201065, 'binary_recall': 0.95758355, 'binary_specificity': 0.99208444, 'binary_f1_score': 0.9744931}
confusion matrix:
      0     1
0  1504    12
1    66  1490
---- Validation: 
scalar performance:
{'acc': 0.8625776, 'precision': 0.86354613, 'recall': 0.8622143, 'specificity': 0.8622143, 'f1': 0.8623785, 'auroc': 0.9162967, 'binary_precision': 0.87913907, 'binary_recall': 0.83622044, 'binary_specificity': 0.88820827, 'binary_f1_score': 0.85714287}
confusion matrix:
     0    1
0  580   73
1  104  531
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8465116, 'precision': 0.8516543, 'recall': 0.8465116, 'specificity': 0.8465116, 'f1': 0.8459484, 'auroc': 0.9262303, 'binary_precision': 0.8941799, 'binary_recall': 0.7860465, 'binary_specificity': 0.90697676, 'binary_f1_score': 0.8366337}
confusion matrix:
     0    1
0  195   20
1   46  169
better model found
persisted
after epoch: 12,now: 2024-07-27 02:23:27.297465,epoch time: 0:01:21.847866,used: 0:16:44.959147,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_02_06_41_seed_0_23090491
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.944987, 'precision': 0.9505802, 'recall': 0.9443221, 'specificity': 0.9443221, 'f1': 0.9447504, 'auroc': 0.99882305, 'binary_precision': 0.90337604, 'binary_recall': 0.9980707, 'binary_specificity': 0.8905735, 'binary_f1_score': 0.9483654}
confusion matrix:
      0     1
0  1351   166
1     3  1552
---- Validation: 
scalar performance:
{'acc': 0.7864907, 'precision': 0.8201839, 'recall': 0.78873885, 'specificity': 0.78873885, 'f1': 0.7815865, 'auroc': 0.91878307, 'binary_precision': 0.71276593, 'binary_recall': 0.9496063, 'binary_specificity': 0.62787133, 'binary_f1_score': 0.81431466}
confusion matrix:
     0    1
0  410  243
1   32  603
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7953488, 'precision': 0.8281772, 'recall': 0.7953488, 'specificity': 0.7953488, 'f1': 0.7900996, 'auroc': 0.9441644, 'binary_precision': 0.7243816, 'binary_recall': 0.95348835, 'binary_specificity': 0.6372093, 'binary_f1_score': 0.82329315}
confusion matrix:
     0    1
0  137   78
1   10  205
early stop counter: 1
val acc:0.7864906787872314, best validation acc: 0.8625776171684265, corresponding to test acc:                         0.8465116024017334 / 0.869767427444458
after epoch: 13,now: 2024-07-27 02:24:48.986563,epoch time: 0:01:21.689098,used: 0:18:06.648245,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_02_06_41_seed_0_23090491
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9863281, 'precision': 0.9863348, 'recall': 0.9863167, 'specificity': 0.9863167, 'f1': 0.98632526, 'auroc': 0.99890924, 'binary_precision': 0.98588836, 'binary_recall': 0.9871548, 'binary_specificity': 0.9854785, 'binary_f1_score': 0.9865211}
confusion matrix:
      0     1
0  1493    22
1    20  1537
---- Validation: 
scalar performance:
{'acc': 0.86180127, 'precision': 0.8675654, 'recall': 0.86092776, 'specificity': 0.86092776, 'f1': 0.8610292, 'auroc': 0.93073034, 'binary_precision': 0.9102334, 'binary_recall': 0.7984252, 'binary_specificity': 0.9234303, 'binary_f1_score': 0.8506712}
confusion matrix:
     0    1
0  603   50
1  128  507
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8604651, 'precision': 0.8697109, 'recall': 0.86046517, 'specificity': 0.86046517, 'f1': 0.8595873, 'auroc': 0.946198, 'binary_precision': 0.9281768, 'binary_recall': 0.7813954, 'binary_specificity': 0.9395349, 'binary_f1_score': 0.8484849}
confusion matrix:
     0    1
0  202   13
1   47  168
early stop counter: 2
val acc:0.861801266670227, best validation acc: 0.8625776171684265, corresponding to test acc:                         0.8465116024017334 / 0.869767427444458
after epoch: 14,now: 2024-07-27 02:26:10.420704,epoch time: 0:01:21.434141,used: 0:19:28.082386,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_02_06_41_seed_0_23090491
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9811198, 'precision': 0.98129356, 'recall': 0.98103327, 'specificity': 0.98103327, 'f1': 0.981113, 'auroc': 0.99850273, 'binary_precision': 0.97461927, 'binary_recall': 0.98841697, 'binary_specificity': 0.97364956, 'binary_f1_score': 0.9814696}
confusion matrix:
      0     1
0  1478    40
1    18  1536
---- Validation: 
scalar performance:
{'acc': 0.6863354, 'precision': 0.7549304, 'recall': 0.68264943, 'specificity': 0.68264943, 'f1': 0.6610173, 'auroc': 0.7806454, 'binary_precision': 0.88372093, 'binary_recall': 0.41889763, 'binary_specificity': 0.94640124, 'binary_f1_score': 0.56837606}
confusion matrix:
     0    1
0  618   35
1  369  266
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.82790697, 'precision': 0.86202204, 'recall': 0.82790697, 'specificity': 0.82790697, 'f1': 0.8237549, 'auroc': 0.9159546, 'binary_precision': 0.97315437, 'binary_recall': 0.6744186, 'binary_specificity': 0.98139536, 'binary_f1_score': 0.7967033}
confusion matrix:
     0    1
0  211    4
1   70  145
early stop counter: 3
val acc:0.6863353848457336, best validation acc: 0.8625776171684265, corresponding to test acc:                         0.8465116024017334 / 0.869767427444458
after epoch: 15,now: 2024-07-27 02:27:32.072174,epoch time: 0:01:21.651470,used: 0:20:49.733856,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_02_06_41_seed_0_23090491
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9863281, 'precision': 0.98631406, 'recall': 0.98634213, 'specificity': 0.98634213, 'f1': 0.98632646, 'auroc': 0.99889946, 'binary_precision': 0.9877498, 'binary_recall': 0.985209, 'binary_specificity': 0.9874753, 'binary_f1_score': 0.9864778}
confusion matrix:
      0     1
0  1498    19
1    23  1532
---- Validation: 
scalar performance:
{'acc': 0.8447205, 'precision': 0.8470791, 'recall': 0.8452979, 'specificity': 0.8452979, 'f1': 0.8445852, 'auroc': 0.9125128, 'binary_precision': 0.8147612, 'binary_recall': 0.88661414, 'binary_specificity': 0.8039816, 'binary_f1_score': 0.84917045}
confusion matrix:
     0    1
0  525  128
1   72  563
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.855814, 'precision': 0.8583255, 'recall': 0.855814, 'specificity': 0.855814, 'f1': 0.85556084, 'auroc': 0.9368956, 'binary_precision': 0.82832617, 'binary_recall': 0.89767444, 'binary_specificity': 0.81395346, 'binary_f1_score': 0.8616072}
confusion matrix:
     0    1
0  175   40
1   22  193
early stop counter: 4
val acc:0.8447204828262329, best validation acc: 0.8625776171684265, corresponding to test acc:                         0.8465116024017334 / 0.869767427444458
after epoch: 16,now: 2024-07-27 02:28:53.762126,epoch time: 0:01:21.689952,used: 0:22:11.423808,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_02_06_41_seed_0_23090491
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.97526044, 'precision': 0.9752697, 'recall': 0.9753495, 'specificity': 0.9753495, 'f1': 0.97525954, 'auroc': 0.99769175, 'binary_precision': 0.9823989, 'binary_recall': 0.968509, 'binary_specificity': 0.98218995, 'binary_f1_score': 0.9754045}
confusion matrix:
      0     1
0  1489    27
1    49  1507
---- Validation: 
scalar performance:
{'acc': 0.7996894, 'precision': 0.8209806, 'recall': 0.8014735, 'specificity': 0.8014735, 'f1': 0.7969353, 'auroc': 0.9079114, 'binary_precision': 0.7347447, 'binary_recall': 0.92913383, 'binary_specificity': 0.67381316, 'binary_f1_score': 0.8205842}
confusion matrix:
     0    1
0  440  213
1   45  590
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.74883723, 'precision': 0.7989137, 'recall': 0.74883723, 'specificity': 0.74883723, 'f1': 0.7378582, 'auroc': 0.9378042, 'binary_precision': 0.6765677, 'binary_recall': 0.95348835, 'binary_specificity': 0.54418606, 'binary_f1_score': 0.7915058}
confusion matrix:
     0    1
0  117   98
1   10  205
early stop counter: 5
val acc:0.7996894121170044, best validation acc: 0.8625776171684265, corresponding to test acc:                         0.8465116024017334 / 0.869767427444458
after epoch: 17,now: 2024-07-27 02:30:15.602555,epoch time: 0:01:21.840429,used: 0:23:33.264237,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_02_06_41_seed_0_23090491
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 17 with time: 0:23:33.264237 at 2024-07-27 02:30:15.602555
persisted model performance metric: 

scalar performance:
{'acc': 0.8465116, 'precision': 0.8516543, 'recall': 0.8465116, 'specificity': 0.8465116, 'f1': 0.8459484, 'auroc': 0.9262303, 'binary_precision': 0.8941799, 'binary_recall': 0.7860465, 'binary_specificity': 0.90697676, 'binary_f1_score': 0.8366337}
confusion matrix:
     0    1
0  195   20
1   46  169
oracle model performance metric: 

scalar performance:
{'acc': 0.8697674, 'precision': 0.8700557, 'recall': 0.8697674, 'specificity': 0.8697674, 'f1': 0.8697421, 'auroc': 0.94580853, 'binary_precision': 0.8597285, 'binary_recall': 0.88372093, 'binary_specificity': 0.855814, 'binary_f1_score': 0.8715596}
confusion matrix:
     0    1
0  184   31
1   25  190
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_diva_irm_3seeds_nofreeze_2024-07-27_01-18-02/rule_results/15.csv
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_diva_irm_3seeds_nofreeze_2024-07-27_01-18-02/rule_results/15.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_diva_irm_3seeds_nofreeze_2024-07-27_01-18-02/confusion_matrix/15.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   1091 MiB |  13862 MiB |  41883 GiB |  41882 GiB |
|       from large pool |   1032 MiB |  13804 MiB |  41362 GiB |  41361 GiB |
|       from small pool |     59 MiB |     95 MiB |    521 GiB |    521 GiB |
|---------------------------------------------------------------------------|
| Active memory         |   1091 MiB |  13862 MiB |  41883 GiB |  41882 GiB |
|       from large pool |   1032 MiB |  13804 MiB |  41362 GiB |  41361 GiB |
|       from small pool |     59 MiB |     95 MiB |    521 GiB |    521 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |   1078 MiB |  13855 MiB |  41693 GiB |  41692 GiB |
|       from large pool |   1019 MiB |  13797 MiB |  41173 GiB |  41172 GiB |
|       from small pool |     59 MiB |     95 MiB |    520 GiB |    519 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  14996 MiB |  14996 MiB |  14996 MiB |      0 B   |
|       from large pool |  14890 MiB |  14890 MiB |  14890 MiB |      0 B   |
|       from small pool |    106 MiB |    106 MiB |    106 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |   1732 MiB |   2147 MiB |  31834 GiB |  31833 GiB |
|       from large pool |   1721 MiB |   2139 MiB |  31311 GiB |  31310 GiB |
|       from small pool |     10 MiB |     17 MiB |    523 GiB |    523 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    1792    |    3103    |    7530 K  |    7528 K  |
|       from large pool |     269    |    1495    |    3729 K  |    3729 K  |
|       from small pool |    1523    |    2219    |    3800 K  |    3799 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    1792    |    3103    |    7530 K  |    7528 K  |
|       from large pool |     269    |    1495    |    3729 K  |    3729 K  |
|       from small pool |    1523    |    2219    |    3800 K  |    3799 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     595    |     595    |     595    |       0    |
|       from large pool |     542    |     542    |     542    |       0    |
|       from small pool |      53    |      53    |      53    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     147    |     580    |    4982 K  |    4982 K  |
|       from large pool |      60    |     534    |    2869 K  |    2869 K  |
|       from small pool |      87    |     240    |    2113 K  |    2113 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13862 MiB |  41883 GiB |  41883 GiB |
|       from large pool |  16640 KiB |  13804 MiB |  41362 GiB |  41362 GiB |
|       from small pool |      0 KiB |     95 MiB |    521 GiB |    521 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13862 MiB |  41883 GiB |  41883 GiB |
|       from large pool |  16640 KiB |  13804 MiB |  41362 GiB |  41362 GiB |
|       from small pool |      0 KiB |     95 MiB |    521 GiB |    521 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13855 MiB |  41693 GiB |  41693 GiB |
|       from large pool |  16640 KiB |  13797 MiB |  41173 GiB |  41173 GiB |
|       from small pool |      0 KiB |     95 MiB |    520 GiB |    520 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2824 MiB |  14996 MiB |  14996 MiB |  12172 MiB |
|       from large pool |   2754 MiB |  14890 MiB |  14890 MiB |  12136 MiB |
|       from small pool |     70 MiB |    106 MiB |    106 MiB |     36 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   2147 MiB |  31835 GiB |  31835 GiB |
|       from large pool |  24320 KiB |   2139 MiB |  31312 GiB |  31312 GiB |
|       from small pool |      0 KiB |     45 MiB |    523 GiB |    523 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3103    |    7530 K  |    7530 K  |
|       from large pool |       2    |    1495    |    3729 K  |    3729 K  |
|       from small pool |       0    |    2219    |    3800 K  |    3800 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3103    |    7530 K  |    7530 K  |
|       from large pool |       2    |    1495    |    3729 K  |    3729 K  |
|       from small pool |       0    |    2219    |    3800 K  |    3800 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      96    |     595    |     595    |     499    |
|       from large pool |      61    |     542    |     542    |     481    |
|       from small pool |      35    |      53    |      53    |      18    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       2    |     580    |    4983 K  |    4983 K  |
|       from large pool |       2    |     534    |    2869 K  |    2869 K  |
|       from small pool |       0    |     240    |    2113 K  |    2113 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13862 MiB |  41883 GiB |  41883 GiB |
|       from large pool |  16640 KiB |  13804 MiB |  41362 GiB |  41362 GiB |
|       from small pool |      0 KiB |     95 MiB |    521 GiB |    521 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13862 MiB |  41883 GiB |  41883 GiB |
|       from large pool |  16640 KiB |  13804 MiB |  41362 GiB |  41362 GiB |
|       from small pool |      0 KiB |     95 MiB |    521 GiB |    521 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13855 MiB |  41693 GiB |  41693 GiB |
|       from large pool |  16640 KiB |  13797 MiB |  41173 GiB |  41173 GiB |
|       from small pool |      0 KiB |     95 MiB |    520 GiB |    520 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2824 MiB |  14996 MiB |  14996 MiB |  12172 MiB |
|       from large pool |   2754 MiB |  14890 MiB |  14890 MiB |  12136 MiB |
|       from small pool |     70 MiB |    106 MiB |    106 MiB |     36 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   2147 MiB |  31835 GiB |  31835 GiB |
|       from large pool |  24320 KiB |   2139 MiB |  31312 GiB |  31312 GiB |
|       from small pool |      0 KiB |     45 MiB |    523 GiB |    523 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3103    |    7530 K  |    7530 K  |
|       from large pool |       2    |    1495    |    3729 K  |    3729 K  |
|       from small pool |       0    |    2219    |    3800 K  |    3800 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3103    |    7530 K  |    7530 K  |
|       from large pool |       2    |    1495    |    3729 K  |    3729 K  |
|       from small pool |       0    |    2219    |    3800 K  |    3800 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      96    |     595    |     595    |     499    |
|       from large pool |      61    |     542    |     542    |     481    |
|       from small pool |      35    |      53    |      53    |      18    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       2    |     580    |    4983 K  |    4983 K  |
|       from large pool |       2    |     534    |    2869 K  |    2869 K  |
|       from small pool |       0    |     240    |    2113 K  |    2113 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main

using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_02_30_56_seed_1_23090491

 Experiment start at: 2024-07-27 02:30:56.964219
before training, model accuracy: 0.46000000834465027
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9238281, 'precision': 0.9250312, 'recall': 0.92348444, 'specificity': 0.92348444, 'f1': 0.92371935, 'auroc': 0.9812006, 'binary_precision': 0.9055794, 'binary_recall': 0.9486191, 'binary_specificity': 0.8983498, 'binary_f1_score': 0.92659974}
confusion matrix:
      0     1
0  1361   154
1    80  1477
---- Validation: 
scalar performance:
{'acc': 0.70179546, 'precision': 0.73014724, 'recall': 0.6988224, 'specificity': 0.6988224, 'f1': 0.6902805, 'auroc': 0.8266038, 'binary_precision': 0.8069307, 'binary_recall': 0.51746035, 'binary_specificity': 0.88018435, 'binary_f1_score': 0.63056093}
confusion matrix:
     0    1
0  573   78
1  304  326
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6511111, 'precision': 0.70979595, 'recall': 0.6511111, 'specificity': 0.6511111, 'f1': 0.6248785, 'auroc': 0.8369185, 'binary_precision': 0.8207547, 'binary_recall': 0.38666666, 'binary_specificity': 0.91555554, 'binary_f1_score': 0.52567977}
confusion matrix:
     0   1
0  206  19
1  138  87
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-27 02:32:24.621608,epoch time: 0:01:27.657389,used: 0:01:27.657389,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_02_30_56_seed_1_23090491
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9479167, 'precision': 0.95012283, 'recall': 0.9483521, 'specificity': 0.9483521, 'f1': 0.94788134, 'auroc': 0.9915403, 'binary_precision': 0.984701, 'binary_recall': 0.9111969, 'binary_specificity': 0.98550725, 'binary_f1_score': 0.9465241}
confusion matrix:
      0     1
0  1496    22
1   138  1416
---- Validation: 
scalar performance:
{'acc': 0.80249804, 'precision': 0.82294565, 'recall': 0.8004097, 'specificity': 0.8004097, 'f1': 0.79851997, 'auroc': 0.8863555, 'binary_precision': 0.9002123, 'binary_recall': 0.6730159, 'binary_specificity': 0.9278034, 'binary_f1_score': 0.77020895}
confusion matrix:
     0    1
0  604   47
1  206  424
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8422222, 'precision': 0.85519516, 'recall': 0.8422222, 'specificity': 0.8422222, 'f1': 0.84076834, 'auroc': 0.9056395, 'binary_precision': 0.9230769, 'binary_recall': 0.74666667, 'binary_specificity': 0.93777776, 'binary_f1_score': 0.8255529}
confusion matrix:
     0    1
0  211   14
1   57  168
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-07-27 02:33:48.848865,epoch time: 0:01:24.227257,used: 0:02:51.884646,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_02_30_56_seed_1_23090491
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9641927, 'precision': 0.96487, 'recall': 0.96396345, 'specificity': 0.96396345, 'f1': 0.96416056, 'auroc': 0.995859, 'binary_precision': 0.9502178, 'binary_recall': 0.9807322, 'binary_specificity': 0.9471947, 'binary_f1_score': 0.9652339}
confusion matrix:
      0     1
0  1435    80
1    30  1527
---- Validation: 
scalar performance:
{'acc': 0.7689305, 'precision': 0.7826079, 'recall': 0.7670763, 'specificity': 0.7670763, 'f1': 0.76522195, 'auroc': 0.85303926, 'binary_precision': 0.8408163, 'binary_recall': 0.6539683, 'binary_specificity': 0.88018435, 'binary_f1_score': 0.7357143}
confusion matrix:
     0    1
0  573   78
1  218  412
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8244445, 'precision': 0.8252218, 'recall': 0.8244444, 'specificity': 0.8244444, 'f1': 0.8243395, 'auroc': 0.9029136, 'binary_precision': 0.8411215, 'binary_recall': 0.8, 'binary_specificity': 0.8488889, 'binary_f1_score': 0.8200456}
confusion matrix:
     0    1
0  191   34
1   45  180
early stop counter: 1
val acc:0.7689304947853088, best validation acc: 0.8024980425834656, corresponding to test acc:                         0.8422222137451172 / 0.8422222137451172
after epoch: 3,now: 2024-07-27 02:35:11.868910,epoch time: 0:01:23.020045,used: 0:04:14.904691,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_02_30_56_seed_1_23090491
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.93880206, 'precision': 0.94311106, 'recall': 0.93809605, 'specificity': 0.93809605, 'f1': 0.938572, 'auroc': 0.9946595, 'binary_precision': 0.9029982, 'binary_recall': 0.98524696, 'binary_specificity': 0.89094514, 'binary_f1_score': 0.94233125}
confusion matrix:
      0     1
0  1348   165
1    23  1536
---- Validation: 
scalar performance:
{'acc': 0.8360656, 'precision': 0.848022, 'recall': 0.8345366, 'specificity': 0.8345366, 'f1': 0.83416885, 'auroc': 0.8977349, 'binary_precision': 0.90856034, 'binary_recall': 0.7412698, 'binary_specificity': 0.9278034, 'binary_f1_score': 0.8164336}
confusion matrix:
     0    1
0  604   47
1  163  467
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.85333335, 'precision': 0.8648648, 'recall': 0.85333335, 'specificity': 0.85333335, 'f1': 0.8521652, 'auroc': 0.9140148, 'binary_precision': 0.9297297, 'binary_recall': 0.7644445, 'binary_specificity': 0.94222224, 'binary_f1_score': 0.8390244}
confusion matrix:
     0    1
0  212   13
1   53  172
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-07-27 02:36:36.186072,epoch time: 0:01:24.317162,used: 0:05:39.221853,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_02_30_56_seed_1_23090491
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9788411, 'precision': 0.9788283, 'recall': 0.9788983, 'specificity': 0.9788983, 'f1': 0.97884, 'auroc': 0.99675024, 'binary_precision': 0.98376626, 'binary_recall': 0.97427654, 'binary_specificity': 0.9835201, 'binary_f1_score': 0.97899836}
confusion matrix:
      0     1
0  1492    25
1    40  1515
---- Validation: 
scalar performance:
{'acc': 0.78844655, 'precision': 0.81930315, 'recall': 0.7858679, 'specificity': 0.7858679, 'f1': 0.782137, 'auroc': 0.8954307, 'binary_precision': 0.91454965, 'binary_recall': 0.62857145, 'binary_specificity': 0.94316435, 'binary_f1_score': 0.74506116}
confusion matrix:
     0    1
0  614   37
1  234  396
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8155556, 'precision': 0.8388554, 'recall': 0.8155556, 'specificity': 0.8155556, 'f1': 0.8123294, 'auroc': 0.88481975, 'binary_precision': 0.92771083, 'binary_recall': 0.6844444, 'binary_specificity': 0.94666666, 'binary_f1_score': 0.7877238}
confusion matrix:
     0    1
0  213   12
1   71  154
early stop counter: 1
val acc:0.7884465456008911, best validation acc: 0.8360655903816223, corresponding to test acc:                         0.8533333539962769 / 0.8533333539962769
after epoch: 5,now: 2024-07-27 02:37:59.117588,epoch time: 0:01:22.931516,used: 0:07:02.153369,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_02_30_56_seed_1_23090491
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.97786456, 'precision': 0.9780559, 'recall': 0.9780389, 'specificity': 0.9780389, 'f1': 0.9778646, 'auroc': 0.997813, 'binary_precision': 0.9914135, 'binary_recall': 0.96465296, 'binary_specificity': 0.9914248, 'binary_f1_score': 0.9778502}
confusion matrix:
      0     1
0  1503    13
1    55  1501
---- Validation: 
scalar performance:
{'acc': 0.5964091, 'precision': 0.71919096, 'recall': 0.5901434, 'specificity': 0.5901434, 'f1': 0.52318394, 'auroc': 0.8227025, 'binary_precision': 0.8791946, 'binary_recall': 0.20793651, 'binary_specificity': 0.97235024, 'binary_f1_score': 0.33632863}
confusion matrix:
     0    1
0  633   18
1  499  131
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.61777776, 'precision': 0.7512748, 'recall': 0.61777776, 'specificity': 0.61777776, 'f1': 0.5592355, 'auroc': 0.88551116, 'binary_precision': 0.93442625, 'binary_recall': 0.25333333, 'binary_specificity': 0.9822222, 'binary_f1_score': 0.39860135}
confusion matrix:
     0   1
0  221   4
1  168  57
early stop counter: 2
val acc:0.5964090824127197, best validation acc: 0.8360655903816223, corresponding to test acc:                         0.8533333539962769 / 0.8533333539962769
after epoch: 6,now: 2024-07-27 02:39:22.081845,epoch time: 0:01:22.964257,used: 0:08:25.117626,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_02_30_56_seed_1_23090491
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9742839, 'precision': 0.974895, 'recall': 0.97454166, 'specificity': 0.97454166, 'f1': 0.97428185, 'auroc': 0.99771035, 'binary_precision': 0.995302, 'binary_recall': 0.95369774, 'binary_specificity': 0.99538565, 'binary_f1_score': 0.9740558}
confusion matrix:
      0     1
0  1510     7
1    72  1483
---- Validation: 
scalar performance:
{'acc': 0.7533177, 'precision': 0.8142427, 'recall': 0.74966717, 'specificity': 0.74966717, 'f1': 0.7389019, 'auroc': 0.89496994, 'binary_precision': 0.94857144, 'binary_recall': 0.52698416, 'binary_specificity': 0.97235024, 'binary_f1_score': 0.67755103}
confusion matrix:
     0    1
0  633   18
1  298  332
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.82666665, 'precision': 0.8554235, 'recall': 0.82666665, 'specificity': 0.82666665, 'f1': 0.8230882, 'auroc': 0.90433574, 'binary_precision': 0.95652175, 'binary_recall': 0.6844444, 'binary_specificity': 0.9688889, 'binary_f1_score': 0.79792744}
confusion matrix:
     0    1
0  218    7
1   71  154
early stop counter: 3
val acc:0.7533177137374878, best validation acc: 0.8360655903816223, corresponding to test acc:                         0.8533333539962769 / 0.8533333539962769
after epoch: 7,now: 2024-07-27 02:40:45.493903,epoch time: 0:01:23.412058,used: 0:09:48.529684,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_02_30_56_seed_1_23090491
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.98307294, 'precision': 0.9830661, 'recall': 0.98313165, 'specificity': 0.98313165, 'f1': 0.98307216, 'auroc': 0.9978806, 'binary_precision': 0.9882965, 'binary_recall': 0.978121, 'binary_specificity': 0.9881423, 'binary_f1_score': 0.9831824}
confusion matrix:
      0     1
0  1500    18
1    34  1520
---- Validation: 
scalar performance:
{'acc': 0.83918816, 'precision': 0.85213625, 'recall': 0.8376088, 'specificity': 0.8376088, 'f1': 0.83721596, 'auroc': 0.9176761, 'binary_precision': 0.91568625, 'binary_recall': 0.7412698, 'binary_specificity': 0.9339478, 'binary_f1_score': 0.81929827}
confusion matrix:
     0    1
0  608   43
1  163  467
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.81777775, 'precision': 0.82520366, 'recall': 0.81777775, 'specificity': 0.81777775, 'f1': 0.8167316, 'auroc': 0.8931259, 'binary_precision': 0.87434554, 'binary_recall': 0.74222225, 'binary_specificity': 0.8933333, 'binary_f1_score': 0.80288464}
confusion matrix:
     0    1
0  201   24
1   58  167
better model found
persisted
after epoch: 8,now: 2024-07-27 02:42:09.789076,epoch time: 0:01:24.295173,used: 0:11:12.824857,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_02_30_56_seed_1_23090491
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.98079425, 'precision': 0.9809996, 'recall': 0.9809733, 'specificity': 0.9809733, 'f1': 0.98079425, 'auroc': 0.9983222, 'binary_precision': 0.9947125, 'binary_recall': 0.96722364, 'binary_specificity': 0.99472296, 'binary_f1_score': 0.98077554}
confusion matrix:
      0     1
0  1508     8
1    51  1505
---- Validation: 
scalar performance:
{'acc': 0.72131145, 'precision': 0.8004009, 'recall': 0.7170507, 'specificity': 0.7170507, 'f1': 0.69910526, 'auroc': 0.9001798, 'binary_precision': 0.95049506, 'binary_recall': 0.45714286, 'binary_specificity': 0.9769585, 'binary_f1_score': 0.61736333}
confusion matrix:
     0    1
0  636   15
1  342  288
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.73333335, 'precision': 0.80661905, 'recall': 0.73333335, 'specificity': 0.73333335, 'f1': 0.71638656, 'auroc': 0.90068644, 'binary_precision': 0.95652175, 'binary_recall': 0.4888889, 'binary_specificity': 0.9777778, 'binary_f1_score': 0.64705884}
confusion matrix:
     0    1
0  220    5
1  115  110
early stop counter: 1
val acc:0.7213114500045776, best validation acc: 0.8391881585121155, corresponding to test acc:                         0.8177777528762817 / 0.8533333539962769
after epoch: 9,now: 2024-07-27 02:43:33.167022,epoch time: 0:01:23.377946,used: 0:12:36.202803,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_02_30_56_seed_1_23090491
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9638672, 'precision': 0.96619606, 'recall': 0.9633981, 'specificity': 0.9633981, 'f1': 0.96378875, 'auroc': 0.9987036, 'binary_precision': 0.93663245, 'binary_recall': 0.9961489, 'binary_specificity': 0.9306473, 'binary_f1_score': 0.9654743}
confusion matrix:
      0     1
0  1409   105
1     6  1552
---- Validation: 
scalar performance:
{'acc': 0.83372366, 'precision': 0.83954644, 'recall': 0.8347926, 'specificity': 0.8347926, 'f1': 0.83328104, 'auroc': 0.90732455, 'binary_precision': 0.79079497, 'binary_recall': 0.9, 'binary_specificity': 0.76958525, 'binary_f1_score': 0.84187084}
confusion matrix:
     0    1
0  501  150
1   63  567
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.81777775, 'precision': 0.827108, 'recall': 0.81777775, 'specificity': 0.81777775, 'f1': 0.8164691, 'auroc': 0.88406914, 'binary_precision': 0.7718631, 'binary_recall': 0.9022222, 'binary_specificity': 0.73333335, 'binary_f1_score': 0.8319672}
confusion matrix:
     0    1
0  165   60
1   22  203
early stop counter: 2
val acc:0.8337236642837524, best validation acc: 0.8391881585121155, corresponding to test acc:                         0.8177777528762817 / 0.8533333539962769
after epoch: 10,now: 2024-07-27 02:44:56.486719,epoch time: 0:01:23.319697,used: 0:13:59.522500,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_02_30_56_seed_1_23090491
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9794922, 'precision': 0.97947794, 'recall': 0.9795017, 'specificity': 0.9795017, 'f1': 0.9794889, 'auroc': 0.9983034, 'binary_precision': 0.980695, 'binary_recall': 0.9788054, 'binary_specificity': 0.980198, 'binary_f1_score': 0.9797493}
confusion matrix:
      0     1
0  1485    30
1    33  1524
---- Validation: 
scalar performance:
{'acc': 0.76502734, 'precision': 0.7831317, 'recall': 0.7629032, 'specificity': 0.7629032, 'f1': 0.7601865, 'auroc': 0.86924875, 'binary_precision': 0.8507463, 'binary_recall': 0.6333333, 'binary_specificity': 0.8924731, 'binary_f1_score': 0.72611463}
confusion matrix:
     0    1
0  581   70
1  231  399
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.74444443, 'precision': 0.75768363, 'recall': 0.74444443, 'specificity': 0.74444443, 'f1': 0.74111927, 'auroc': 0.8239013, 'binary_precision': 0.81609195, 'binary_recall': 0.6311111, 'binary_specificity': 0.8577778, 'binary_f1_score': 0.7117795}
confusion matrix:
     0    1
0  193   32
1   83  142
early stop counter: 3
val acc:0.7650273442268372, best validation acc: 0.8391881585121155, corresponding to test acc:                         0.8177777528762817 / 0.8533333539962769
after epoch: 11,now: 2024-07-27 02:46:20.267382,epoch time: 0:01:23.780663,used: 0:15:23.303163,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_02_30_56_seed_1_23090491
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9641927, 'precision': 0.96477884, 'recall': 0.9639813, 'specificity': 0.9639813, 'f1': 0.9641633, 'auroc': 0.9964832, 'binary_precision': 0.9513412, 'binary_recall': 0.97944766, 'binary_specificity': 0.9485149, 'binary_f1_score': 0.9651899}
confusion matrix:
      0     1
0  1437    78
1    32  1525
---- Validation: 
scalar performance:
{'acc': 0.82591724, 'precision': 0.8282424, 'recall': 0.8266001, 'specificity': 0.8266001, 'f1': 0.8257797, 'auroc': 0.8898032, 'binary_precision': 0.7962154, 'binary_recall': 0.86825395, 'binary_specificity': 0.78494626, 'binary_f1_score': 0.8306758}
confusion matrix:
     0    1
0  511  140
1   83  547
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.79333335, 'precision': 0.799782, 'recall': 0.79333335, 'specificity': 0.79333335, 'f1': 0.79221594, 'auroc': 0.87946665, 'binary_precision': 0.75581396, 'binary_recall': 0.8666667, 'binary_specificity': 0.72, 'binary_f1_score': 0.80745345}
confusion matrix:
     0    1
0  162   63
1   30  195
early stop counter: 4
val acc:0.8259172439575195, best validation acc: 0.8391881585121155, corresponding to test acc:                         0.8177777528762817 / 0.8533333539962769
after epoch: 12,now: 2024-07-27 02:47:43.887147,epoch time: 0:01:23.619765,used: 0:16:46.922928,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_02_30_56_seed_1_23090491
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9785156, 'precision': 0.9786955, 'recall': 0.9784187, 'specificity': 0.9784187, 'f1': 0.9785068, 'auroc': 0.9988948, 'binary_precision': 0.9721166, 'binary_recall': 0.9858612, 'binary_specificity': 0.97097623, 'binary_f1_score': 0.9789406}
confusion matrix:
      0     1
0  1472    44
1    22  1534
---- Validation: 
scalar performance:
{'acc': 0.8306011, 'precision': 0.8330621, 'recall': 0.82987714, 'specificity': 0.82987714, 'f1': 0.8300339, 'auroc': 0.8743081, 'binary_precision': 0.8578856, 'binary_recall': 0.78571427, 'binary_specificity': 0.87403995, 'binary_f1_score': 0.8202154}
confusion matrix:
     0    1
0  569   82
1  135  495
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8155556, 'precision': 0.81696427, 'recall': 0.8155556, 'specificity': 0.8155556, 'f1': 0.8153504, 'auroc': 0.8814223, 'binary_precision': 0.79583335, 'binary_recall': 0.8488889, 'binary_specificity': 0.7822222, 'binary_f1_score': 0.82150537}
confusion matrix:
     0    1
0  176   49
1   34  191
early stop counter: 5
val acc:0.8306010961532593, best validation acc: 0.8391881585121155, corresponding to test acc:                         0.8177777528762817 / 0.8533333539962769
after epoch: 13,now: 2024-07-27 02:49:07.022829,epoch time: 0:01:23.135682,used: 0:18:10.058610,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_02_30_56_seed_1_23090491
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 13 with time: 0:18:10.058610 at 2024-07-27 02:49:07.022829
persisted model performance metric: 

scalar performance:
{'acc': 0.81777775, 'precision': 0.82520366, 'recall': 0.81777775, 'specificity': 0.81777775, 'f1': 0.8167316, 'auroc': 0.8931259, 'binary_precision': 0.87434554, 'binary_recall': 0.74222225, 'binary_specificity': 0.8933333, 'binary_f1_score': 0.80288464}
confusion matrix:
     0    1
0  201   24
1   58  167
oracle model performance metric: 

scalar performance:
{'acc': 0.85333335, 'precision': 0.8648648, 'recall': 0.85333335, 'specificity': 0.85333335, 'f1': 0.8521652, 'auroc': 0.9140148, 'binary_precision': 0.9297297, 'binary_recall': 0.7644445, 'binary_specificity': 0.94222224, 'binary_f1_score': 0.8390244}
confusion matrix:
     0    1
0  212   13
1   53  172
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_diva_irm_3seeds_nofreeze_2024-07-27_01-18-02/rule_results/15.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_diva_irm_3seeds_nofreeze_2024-07-27_01-18-02/confusion_matrix/15.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   1093 MiB |  13864 MiB |  74650 GiB |  74649 GiB |
|       from large pool |   1034 MiB |  13806 MiB |  73718 GiB |  73717 GiB |
|       from small pool |     59 MiB |     99 MiB |    931 GiB |    931 GiB |
|---------------------------------------------------------------------------|
| Active memory         |   1093 MiB |  13864 MiB |  74650 GiB |  74649 GiB |
|       from large pool |   1034 MiB |  13806 MiB |  73718 GiB |  73717 GiB |
|       from small pool |     59 MiB |     99 MiB |    931 GiB |    931 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |   1078 MiB |  13855 MiB |  74430 GiB |  74429 GiB |
|       from large pool |   1019 MiB |  13797 MiB |  73501 GiB |  73500 GiB |
|       from small pool |     59 MiB |     99 MiB |    929 GiB |    929 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  14950 MiB |  14996 MiB |  27122 MiB |  12172 MiB |
|       from large pool |  14838 MiB |  14890 MiB |  26974 MiB |  12136 MiB |
|       from small pool |    112 MiB |    112 MiB |    148 MiB |     36 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |   1992 MiB |   2844 MiB |  57180 GiB |  57178 GiB |
|       from large pool |   1981 MiB |   2836 MiB |  56245 GiB |  56243 GiB |
|       from small pool |     10 MiB |     45 MiB |    935 GiB |    935 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    1804    |    3107    |   13428 K  |   13426 K  |
|       from large pool |     269    |    1495    |    6655 K  |    6654 K  |
|       from small pool |    1535    |    2231    |    6772 K  |    6771 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    1804    |    3107    |   13428 K  |   13426 K  |
|       from large pool |     269    |    1495    |    6655 K  |    6654 K  |
|       from small pool |    1535    |    2231    |    6772 K  |    6771 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     562    |     595    |    1061    |     499    |
|       from large pool |     506    |     542    |     987    |     481    |
|       from small pool |      56    |      56    |      74    |      18    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     142    |     580    |    8928 K  |    8927 K  |
|       from large pool |      52    |     534    |    5149 K  |    5149 K  |
|       from small pool |      90    |     240    |    3778 K  |    3778 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13864 MiB |  74650 GiB |  74650 GiB |
|       from large pool |  16640 KiB |  13806 MiB |  73718 GiB |  73718 GiB |
|       from small pool |      0 KiB |     99 MiB |    931 GiB |    931 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13864 MiB |  74650 GiB |  74650 GiB |
|       from large pool |  16640 KiB |  13806 MiB |  73718 GiB |  73718 GiB |
|       from small pool |      0 KiB |     99 MiB |    931 GiB |    931 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13855 MiB |  74430 GiB |  74430 GiB |
|       from large pool |  16640 KiB |  13797 MiB |  73501 GiB |  73501 GiB |
|       from small pool |      0 KiB |     99 MiB |    929 GiB |    929 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   3086 MiB |  14996 MiB |  27122 MiB |  24036 MiB |
|       from large pool |   3016 MiB |  14890 MiB |  26974 MiB |  23958 MiB |
|       from small pool |     70 MiB |    112 MiB |    148 MiB |     78 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   2844 MiB |  57181 GiB |  57181 GiB |
|       from large pool |  24320 KiB |   2836 MiB |  56245 GiB |  56245 GiB |
|       from small pool |      0 KiB |     46 MiB |    935 GiB |    935 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3107    |   13428 K  |   13428 K  |
|       from large pool |       2    |    1495    |    6655 K  |    6655 K  |
|       from small pool |       0    |    2231    |    6772 K  |    6772 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3107    |   13428 K  |   13428 K  |
|       from large pool |       2    |    1495    |    6655 K  |    6655 K  |
|       from small pool |       0    |    2231    |    6772 K  |    6772 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      95    |     595    |    1061    |     966    |
|       from large pool |      60    |     542    |     987    |     927    |
|       from small pool |      35    |      56    |      74    |      39    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       2    |     580    |    8928 K  |    8928 K  |
|       from large pool |       2    |     534    |    5149 K  |    5149 K  |
|       from small pool |       0    |     240    |    3779 K  |    3779 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13864 MiB |  74650 GiB |  74650 GiB |
|       from large pool |  16640 KiB |  13806 MiB |  73718 GiB |  73718 GiB |
|       from small pool |      0 KiB |     99 MiB |    931 GiB |    931 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13864 MiB |  74650 GiB |  74650 GiB |
|       from large pool |  16640 KiB |  13806 MiB |  73718 GiB |  73718 GiB |
|       from small pool |      0 KiB |     99 MiB |    931 GiB |    931 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13855 MiB |  74430 GiB |  74430 GiB |
|       from large pool |  16640 KiB |  13797 MiB |  73501 GiB |  73501 GiB |
|       from small pool |      0 KiB |     99 MiB |    929 GiB |    929 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   3086 MiB |  14996 MiB |  27122 MiB |  24036 MiB |
|       from large pool |   3016 MiB |  14890 MiB |  26974 MiB |  23958 MiB |
|       from small pool |     70 MiB |    112 MiB |    148 MiB |     78 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   2844 MiB |  57181 GiB |  57181 GiB |
|       from large pool |  24320 KiB |   2836 MiB |  56245 GiB |  56245 GiB |
|       from small pool |      0 KiB |     46 MiB |    935 GiB |    935 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3107    |   13428 K  |   13428 K  |
|       from large pool |       2    |    1495    |    6655 K  |    6655 K  |
|       from small pool |       0    |    2231    |    6772 K  |    6772 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3107    |   13428 K  |   13428 K  |
|       from large pool |       2    |    1495    |    6655 K  |    6655 K  |
|       from small pool |       0    |    2231    |    6772 K  |    6772 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      95    |     595    |    1061    |     966    |
|       from large pool |      60    |     542    |     987    |     927    |
|       from small pool |      35    |      56    |      74    |      39    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       2    |     580    |    8928 K  |    8928 K  |
|       from large pool |       2    |     534    |    5149 K  |    5149 K  |
|       from small pool |       0    |     240    |    3779 K  |    3779 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main

using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_02_49_45_seed_2_23090491

 Experiment start at: 2024-07-27 02:49:46.128898
before training, model accuracy: 0.28703704476356506
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9437173, 'precision': 0.94373953, 'recall': 0.94376004, 'specificity': 0.94376004, 'f1': 0.9437171, 'auroc': 0.9840716, 'binary_precision': 0.94940865, 'binary_recall': 0.9383117, 'binary_specificity': 0.94920844, 'binary_f1_score': 0.94382757}
confusion matrix:
      0     1
0  1439    77
1    95  1445
---- Validation: 
scalar performance:
{'acc': 0.70735526, 'precision': 0.73766077, 'recall': 0.7118976, 'specificity': 0.7118976, 'f1': 0.70045274, 'auroc': 0.8240849, 'binary_precision': 0.64588237, 'binary_recall': 0.88263667, 'binary_specificity': 0.54115856, 'binary_f1_score': 0.74592394}
confusion matrix:
     0    1
0  355  301
1   73  549
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6851852, 'precision': 0.77193755, 'recall': 0.6851852, 'specificity': 0.6851852, 'f1': 0.6579014, 'auroc': 0.9112226, 'binary_precision': 0.6183432, 'binary_recall': 0.9675926, 'binary_specificity': 0.4027778, 'binary_f1_score': 0.7545126}
confusion matrix:
    0    1
0  87  129
1   7  209
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-27 02:51:11.961297,epoch time: 0:01:25.832399,used: 0:01:25.832399,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_02_49_45_seed_2_23090491
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9715314, 'precision': 0.9715383, 'recall': 0.971522, 'specificity': 0.971522, 'f1': 0.9715292, 'auroc': 0.99659824, 'binary_precision': 0.97083604, 'binary_recall': 0.9727273, 'binary_specificity': 0.97031665, 'binary_f1_score': 0.9717807}
confusion matrix:
      0     1
0  1471    45
1    42  1498
---- Validation: 
scalar performance:
{'acc': 0.7652582, 'precision': 0.7976493, 'recall': 0.76954997, 'specificity': 0.76954997, 'f1': 0.76050735, 'auroc': 0.8854991, 'binary_precision': 0.69258374, 'binary_recall': 0.93086815, 'binary_specificity': 0.6082317, 'binary_f1_score': 0.7942387}
confusion matrix:
     0    1
0  399  257
1   43  579
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7731481, 'precision': 0.80947065, 'recall': 0.7731482, 'specificity': 0.7731482, 'f1': 0.76629055, 'auroc': 0.88835305, 'binary_precision': 0.7034483, 'binary_recall': 0.9444444, 'binary_specificity': 0.6018519, 'binary_f1_score': 0.80632406}
confusion matrix:
     0    1
0  130   86
1   12  204
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-07-27 02:52:34.443450,epoch time: 0:01:22.482153,used: 0:02:48.314552,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_02_49_45_seed_2_23090491
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.95091623, 'precision': 0.9545405, 'recall': 0.95127815, 'specificity': 0.95127815, 'f1': 0.950843, 'auroc': 0.99478805, 'binary_precision': 0.9971388, 'binary_recall': 0.9051948, 'binary_specificity': 0.9973615, 'binary_f1_score': 0.94894487}
confusion matrix:
      0     1
0  1512     4
1   146  1394
---- Validation: 
scalar performance:
{'acc': 0.786385, 'precision': 0.8116232, 'recall': 0.7825048, 'specificity': 0.7825048, 'f1': 0.78028166, 'auroc': 0.8710493, 'binary_precision': 0.89390516, 'binary_recall': 0.6366559, 'binary_specificity': 0.92835367, 'binary_f1_score': 0.74366194}
confusion matrix:
     0    1
0  609   47
1  226  396
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8194444, 'precision': 0.829647, 'recall': 0.8194444, 'specificity': 0.8194444, 'f1': 0.8180365, 'auroc': 0.90798616, 'binary_precision': 0.8876405, 'binary_recall': 0.7314815, 'binary_specificity': 0.9074074, 'binary_f1_score': 0.80203044}
confusion matrix:
     0    1
0  196   20
1   58  158
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-07-27 02:53:57.574958,epoch time: 0:01:23.131508,used: 0:04:11.446060,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_02_49_45_seed_2_23090491
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9820026, 'precision': 0.9820186, 'recall': 0.98198867, 'specificity': 0.98198867, 'f1': 0.98200095, 'auroc': 0.9977727, 'binary_precision': 0.98058254, 'binary_recall': 0.98376626, 'binary_specificity': 0.9802111, 'binary_f1_score': 0.9821718}
confusion matrix:
      0     1
0  1486    30
1    25  1515
---- Validation: 
scalar performance:
{'acc': 0.7543036, 'precision': 0.78823686, 'recall': 0.7587542, 'specificity': 0.7587542, 'f1': 0.7488692, 'auroc': 0.8754951, 'binary_precision': 0.6824645, 'binary_recall': 0.926045, 'binary_specificity': 0.5914634, 'binary_f1_score': 0.7858117}
confusion matrix:
     0    1
0  388  268
1   46  576
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.712963, 'precision': 0.7912758, 'recall': 0.712963, 'specificity': 0.712963, 'f1': 0.69227946, 'auroc': 0.8666409, 'binary_precision': 0.6402439, 'binary_recall': 0.9722222, 'binary_specificity': 0.4537037, 'binary_f1_score': 0.77205884}
confusion matrix:
    0    1
0  98  118
1   6  210
early stop counter: 1
val acc:0.7543035745620728, best validation acc: 0.7863849997520447, corresponding to test acc:                         0.8194444179534912 / 0.8194444179534912
after epoch: 4,now: 2024-07-27 02:55:18.357584,epoch time: 0:01:20.782626,used: 0:05:32.228686,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_02_49_45_seed_2_23090491
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9748037, 'precision': 0.9749404, 'recall': 0.97474813, 'specificity': 0.97474813, 'f1': 0.9747982, 'auroc': 0.99746215, 'binary_precision': 0.96860987, 'binary_recall': 0.9818182, 'binary_specificity': 0.9676781, 'binary_f1_score': 0.9751693}
confusion matrix:
      0     1
0  1467    49
1    28  1512
---- Validation: 
scalar performance:
{'acc': 0.8309859, 'precision': 0.8360754, 'recall': 0.8326161, 'specificity': 0.8326161, 'f1': 0.83072686, 'auroc': 0.9038973, 'binary_precision': 0.7875354, 'binary_recall': 0.8938907, 'binary_specificity': 0.77134144, 'binary_f1_score': 0.8373494}
confusion matrix:
     0    1
0  506  150
1   66  556
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7847222, 'precision': 0.7864969, 'recall': 0.7847222, 'specificity': 0.7847222, 'f1': 0.7843883, 'auroc': 0.90001285, 'binary_precision': 0.7639485, 'binary_recall': 0.8240741, 'binary_specificity': 0.7453704, 'binary_f1_score': 0.792873}
confusion matrix:
     0    1
0  161   55
1   38  178
better model found
persisted
after epoch: 5,now: 2024-07-27 02:56:40.298578,epoch time: 0:01:21.940994,used: 0:06:54.169680,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_02_49_45_seed_2_23090491
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9685864, 'precision': 0.97015107, 'recall': 0.96882606, 'specificity': 0.96882606, 'f1': 0.9685699, 'auroc': 0.9979217, 'binary_precision': 0.9993084, 'binary_recall': 0.9383117, 'binary_specificity': 0.99934036, 'binary_f1_score': 0.96784997}
confusion matrix:
      0     1
0  1515     1
1    95  1445
---- Validation: 
scalar performance:
{'acc': 0.69874805, 'precision': 0.7904655, 'recall': 0.69109774, 'specificity': 0.69109774, 'f1': 0.6676378, 'auroc': 0.8985423, 'binary_precision': 0.94716984, 'binary_recall': 0.40353698, 'binary_specificity': 0.97865856, 'binary_f1_score': 0.56595266}
confusion matrix:
     0    1
0  642   14
1  371  251
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6828704, 'precision': 0.77495086, 'recall': 0.6828704, 'specificity': 0.6828704, 'f1': 0.65389276, 'auroc': 0.8981482, 'binary_precision': 0.93406594, 'binary_recall': 0.3935185, 'binary_specificity': 0.9722222, 'binary_f1_score': 0.5537459}
confusion matrix:
     0   1
0  210   6
1  131  85
early stop counter: 1
val acc:0.6987480521202087, best validation acc: 0.8309859037399292, corresponding to test acc:                         0.7847222089767456 / 0.8194444179534912
after epoch: 6,now: 2024-07-27 02:58:01.587597,epoch time: 0:01:21.289019,used: 0:08:15.458699,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_02_49_45_seed_2_23090491
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.98036647, 'precision': 0.9803974, 'recall': 0.9803447, 'specificity': 0.9803447, 'f1': 0.9803643, 'auroc': 0.99774444, 'binary_precision': 0.97803617, 'binary_recall': 0.98311687, 'binary_specificity': 0.97757256, 'binary_f1_score': 0.9805699}
confusion matrix:
      0     1
0  1482    34
1    26  1514
---- Validation: 
scalar performance:
{'acc': 0.75352114, 'precision': 0.770368, 'recall': 0.75003433, 'specificity': 0.75003433, 'f1': 0.7477687, 'auroc': 0.85930765, 'binary_precision': 0.8315335, 'binary_recall': 0.61897105, 'binary_specificity': 0.88109756, 'binary_f1_score': 0.70967746}
confusion matrix:
     0    1
0  578   78
1  237  385
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7962963, 'precision': 0.79999995, 'recall': 0.7962963, 'specificity': 0.7962963, 'f1': 0.7956656, 'auroc': 0.89594054, 'binary_precision': 0.8333333, 'binary_recall': 0.7407407, 'binary_specificity': 0.8518519, 'binary_f1_score': 0.78431374}
confusion matrix:
     0    1
0  184   32
1   56  160
early stop counter: 2
val acc:0.7535211443901062, best validation acc: 0.8309859037399292, corresponding to test acc:                         0.7847222089767456 / 0.8194444179534912
after epoch: 7,now: 2024-07-27 02:59:22.382515,epoch time: 0:01:20.794918,used: 0:09:36.253617,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_02_49_45_seed_2_23090491
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9689136, 'precision': 0.97002625, 'recall': 0.9687344, 'specificity': 0.9687344, 'f1': 0.9688848, 'auroc': 0.9983394, 'binary_precision': 0.94903666, 'binary_recall': 0.99155843, 'binary_specificity': 0.9459103, 'binary_f1_score': 0.96983165}
confusion matrix:
      0     1
0  1434    82
1    13  1527
---- Validation: 
scalar performance:
{'acc': 0.76134586, 'precision': 0.7761198, 'recall': 0.7581146, 'specificity': 0.7581146, 'f1': 0.75646085, 'auroc': 0.85452366, 'binary_precision': 0.8336842, 'binary_recall': 0.6366559, 'binary_specificity': 0.87957317, 'binary_f1_score': 0.721969}
confusion matrix:
     0    1
0  577   79
1  226  396
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7777778, 'precision': 0.7797203, 'recall': 0.7777778, 'specificity': 0.7777778, 'f1': 0.7773913, 'auroc': 0.8677341, 'binary_precision': 0.8030303, 'binary_recall': 0.7361111, 'binary_specificity': 0.8194444, 'binary_f1_score': 0.76811594}
confusion matrix:
     0    1
0  177   39
1   57  159
early stop counter: 3
val acc:0.7613458633422852, best validation acc: 0.8309859037399292, corresponding to test acc:                         0.7847222089767456 / 0.8194444179534912
after epoch: 8,now: 2024-07-27 03:00:43.628456,epoch time: 0:01:21.245941,used: 0:10:57.499558,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_02_49_45_seed_2_23090491
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.970877, 'precision': 0.9715633, 'recall': 0.970739, 'specificity': 0.970739, 'f1': 0.97085845, 'auroc': 0.997705, 'binary_precision': 0.95543003, 'binary_recall': 0.9883117, 'binary_specificity': 0.95316625, 'binary_f1_score': 0.9715927}
confusion matrix:
      0     1
0  1445    71
1    18  1522
---- Validation: 
scalar performance:
{'acc': 0.7769953, 'precision': 0.7905165, 'recall': 0.77977467, 'specificity': 0.77977467, 'f1': 0.775421, 'auroc': 0.8674418, 'binary_precision': 0.7208388, 'binary_recall': 0.8842444, 'binary_specificity': 0.6753049, 'binary_f1_score': 0.7942238}
confusion matrix:
     0    1
0  443  213
1   72  550
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6828704, 'precision': 0.77495086, 'recall': 0.6828704, 'specificity': 0.6828704, 'f1': 0.65389276, 'auroc': 0.9006773, 'binary_precision': 0.6158358, 'binary_recall': 0.9722222, 'binary_specificity': 0.3935185, 'binary_f1_score': 0.7540395}
confusion matrix:
    0    1
0  85  131
1   6  210
early stop counter: 4
val acc:0.7769953012466431, best validation acc: 0.8309859037399292, corresponding to test acc:                         0.7847222089767456 / 0.8194444179534912
after epoch: 9,now: 2024-07-27 03:02:04.416170,epoch time: 0:01:20.787714,used: 0:12:18.287272,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_02_49_45_seed_2_23090491
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.98232985, 'precision': 0.98269033, 'recall': 0.98245215, 'specificity': 0.98245215, 'f1': 0.9823288, 'auroc': 0.9991123, 'binary_precision': 0.9979893, 'binary_recall': 0.9668831, 'binary_specificity': 0.9980211, 'binary_f1_score': 0.98219}
confusion matrix:
      0     1
0  1513     3
1    51  1489
---- Validation: 
scalar performance:
{'acc': 0.799687, 'precision': 0.83215964, 'recall': 0.79546213, 'specificity': 0.79546213, 'f1': 0.792982, 'auroc': 0.9031645, 'binary_precision': 0.92957747, 'binary_recall': 0.6366559, 'binary_specificity': 0.9542683, 'binary_f1_score': 0.7557252}
confusion matrix:
     0    1
0  626   30
1  226  396
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7939815, 'precision': 0.8019084, 'recall': 0.7939815, 'specificity': 0.7939815, 'f1': 0.79262024, 'auroc': 0.88702416, 'binary_precision': 0.8508287, 'binary_recall': 0.712963, 'binary_specificity': 0.875, 'binary_f1_score': 0.77581865}
confusion matrix:
     0    1
0  189   27
1   62  154
early stop counter: 5
val acc:0.7996870279312134, best validation acc: 0.8309859037399292, corresponding to test acc:                         0.7847222089767456 / 0.8194444179534912
after epoch: 10,now: 2024-07-27 03:03:25.274340,epoch time: 0:01:20.858170,used: 0:13:39.145442,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_02_49_45_seed_2_23090491
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 10 with time: 0:13:39.145442 at 2024-07-27 03:03:25.274340
persisted model performance metric: 

scalar performance:
{'acc': 0.7847222, 'precision': 0.7864969, 'recall': 0.7847222, 'specificity': 0.7847222, 'f1': 0.7843883, 'auroc': 0.90001285, 'binary_precision': 0.7639485, 'binary_recall': 0.8240741, 'binary_specificity': 0.7453704, 'binary_f1_score': 0.792873}
confusion matrix:
     0    1
0  161   55
1   38  178
oracle model performance metric: 

scalar performance:
{'acc': 0.8194444, 'precision': 0.829647, 'recall': 0.8194444, 'specificity': 0.8194444, 'f1': 0.8180365, 'auroc': 0.90798616, 'binary_precision': 0.8876405, 'binary_recall': 0.7314815, 'binary_specificity': 0.9074074, 'binary_f1_score': 0.80203044}
confusion matrix:
     0    1
0  196   20
1   58  158
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_diva_irm_3seeds_nofreeze_2024-07-27_01-18-02/rule_results/15.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_diva_irm_3seeds_nofreeze_2024-07-27_01-18-02/confusion_matrix/15.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   1093 MiB |  13864 MiB |  99250 GiB |  99248 GiB |
|       from large pool |   1034 MiB |  13806 MiB |  98011 GiB |  98010 GiB |
|       from small pool |     59 MiB |     99 MiB |   1238 GiB |   1238 GiB |
|---------------------------------------------------------------------------|
| Active memory         |   1093 MiB |  13864 MiB |  99250 GiB |  99248 GiB |
|       from large pool |   1034 MiB |  13806 MiB |  98011 GiB |  98010 GiB |
|       from small pool |     59 MiB |     99 MiB |   1238 GiB |   1238 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |   1078 MiB |  13855 MiB |  99007 GiB |  99006 GiB |
|       from large pool |   1019 MiB |  13797 MiB |  97771 GiB |  97770 GiB |
|       from small pool |     59 MiB |     99 MiB |   1236 GiB |   1236 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  14918 MiB |  14996 MiB |  38954 MiB |  24036 MiB |
|       from large pool |  14812 MiB |  14890 MiB |  38770 MiB |  23958 MiB |
|       from small pool |    106 MiB |    112 MiB |    184 MiB |     78 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |   1972 MiB |   3297 MiB |  77625 GiB |  77623 GiB |
|       from large pool |   1961 MiB |   3289 MiB |  76381 GiB |  76379 GiB |
|       from small pool |     10 MiB |     46 MiB |   1243 GiB |   1243 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    1792    |    3107    |   17865 K  |   17864 K  |
|       from large pool |     269    |    1495    |    8852 K  |    8852 K  |
|       from small pool |    1523    |    2231    |    9013 K  |    9011 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    1792    |    3107    |   17865 K  |   17864 K  |
|       from large pool |     269    |    1495    |    8852 K  |    8852 K  |
|       from small pool |    1523    |    2231    |    9013 K  |    9011 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     551    |     595    |    1517    |     966    |
|       from large pool |     498    |     542    |    1425    |     927    |
|       from small pool |      53    |      56    |      92    |      39    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     129    |     580    |   11574 K  |   11574 K  |
|       from large pool |      47    |     534    |    6554 K  |    6554 K  |
|       from small pool |      82    |     240    |    5019 K  |    5019 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13864 MiB |  99250 GiB |  99250 GiB |
|       from large pool |  16640 KiB |  13806 MiB |  98011 GiB |  98011 GiB |
|       from small pool |      0 KiB |     99 MiB |   1238 GiB |   1238 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13864 MiB |  99250 GiB |  99250 GiB |
|       from large pool |  16640 KiB |  13806 MiB |  98011 GiB |  98011 GiB |
|       from small pool |      0 KiB |     99 MiB |   1238 GiB |   1238 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13855 MiB |  99007 GiB |  99007 GiB |
|       from large pool |  16640 KiB |  13797 MiB |  97771 GiB |  97771 GiB |
|       from small pool |      0 KiB |     99 MiB |   1236 GiB |   1236 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   3066 MiB |  14996 MiB |  38954 MiB |  35888 MiB |
|       from large pool |   2996 MiB |  14890 MiB |  38770 MiB |  35774 MiB |
|       from small pool |     70 MiB |    112 MiB |    184 MiB |    114 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   3297 MiB |  77625 GiB |  77625 GiB |
|       from large pool |  24320 KiB |   3289 MiB |  76381 GiB |  76381 GiB |
|       from small pool |      0 KiB |     46 MiB |   1244 GiB |   1244 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3107    |   17865 K  |   17865 K  |
|       from large pool |       2    |    1495    |    8852 K  |    8852 K  |
|       from small pool |       0    |    2231    |    9013 K  |    9013 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3107    |   17865 K  |   17865 K  |
|       from large pool |       2    |    1495    |    8852 K  |    8852 K  |
|       from small pool |       0    |    2231    |    9013 K  |    9013 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      94    |     595    |    1517    |    1423    |
|       from large pool |      59    |     542    |    1425    |    1366    |
|       from small pool |      35    |      56    |      92    |      57    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       2    |     580    |   11574 K  |   11574 K  |
|       from large pool |       2    |     534    |    6554 K  |    6554 K  |
|       from small pool |       0    |     240    |    5019 K  |    5019 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Sat Jul 27 03:03:35 2024]
Finished job 0.
1 of 1 steps (100%) done
