Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Sat Jul 27 01:19:39 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_diva_irm_3seeds_nofreeze_2024-07-27_01-18-02/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_diva_irm_3seeds_nofreeze_2024-07-27_01-18-02/rule_results/5.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=5
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/swiglu_ffn.py:51: UserWarning: xFormers is not available (SwiGLU)
  warnings.warn("xFormers is not available (SwiGLU)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/attention.py:33: UserWarning: xFormers is not available (Attention)
  warnings.warn("xFormers is not available (Attention)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/block.py:40: UserWarning: xFormers is not available (Block)
  warnings.warn("xFormers is not available (Block)")
Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main

using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_01_20_34_seed_0_23090485

 Experiment start at: 2024-07-27 01:20:35.512494
hyper-parameter scheduler not set,going to use default Warmpup and epoch update
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
before training, model accuracy: 0.5
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/autograd/graph.py:744: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.8968099, 'precision': 0.91161543, 'recall': 0.8979982, 'specificity': 0.8979982, 'f1': 0.89605963, 'auroc': 0.9856339, 'binary_precision': 0.9928344, 'binary_recall': 0.80192924, 'binary_specificity': 0.99406725, 'binary_f1_score': 0.8872288}
confusion matrix:
      0     1
0  1508     9
1   308  1247
---- Validation: 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
scalar performance:
{'acc': 0.80124223, 'precision': 0.80305994, 'recall': 0.8017677, 'specificity': 0.8017677, 'f1': 0.8011036, 'auroc': 0.8673837, 'binary_precision': 0.77583694, 'binary_recall': 0.8393701, 'binary_specificity': 0.7641654, 'binary_f1_score': 0.806354}
confusion matrix:
     0    1
0  499  154
1  102  533
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7883721, 'precision': 0.79018635, 'recall': 0.7883721, 'specificity': 0.7883721, 'f1': 0.78804076, 'auroc': 0.8716496, 'binary_precision': 0.76724136, 'binary_recall': 0.82790697, 'binary_specificity': 0.74883723, 'binary_f1_score': 0.7964206}
confusion matrix:
     0    1
0  161   54
1   37  178
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-27 01:23:12.359272,epoch time: 0:02:36.846778,used: 0:02:36.846778,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_01_20_34_seed_0_23090485
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.94954425, 'precision': 0.95116305, 'recall': 0.94914687, 'specificity': 0.94914687, 'f1': 0.9494579, 'auroc': 0.9936727, 'binary_precision': 0.92748326, 'binary_recall': 0.9768934, 'binary_specificity': 0.92140025, 'binary_f1_score': 0.9515473}
confusion matrix:
      0     1
0  1395   119
1    36  1522
---- Validation: 
scalar performance:
{'acc': 0.7833851, 'precision': 0.79313076, 'recall': 0.78463423, 'specificity': 0.78463423, 'f1': 0.7820448, 'auroc': 0.8437544, 'binary_precision': 0.73607427, 'binary_recall': 0.87401575, 'binary_specificity': 0.69525266, 'binary_f1_score': 0.7991361}
confusion matrix:
     0    1
0  454  199
1   80  555
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7860465, 'precision': 0.7942977, 'recall': 0.7860465, 'specificity': 0.7860465, 'f1': 0.7845363, 'auroc': 0.8543645, 'binary_precision': 0.7450199, 'binary_recall': 0.8697674, 'binary_specificity': 0.7023256, 'binary_f1_score': 0.8025751}
confusion matrix:
     0    1
0  151   64
1   28  187
early stop counter: 1
val acc:0.7833850979804993, best validation acc: 0.8012422323226929, corresponding to test acc:                         0.7883720993995667 / 0.7883720993995667
after epoch: 2,now: 2024-07-27 01:25:41.187141,epoch time: 0:02:28.827869,used: 0:05:05.674647,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_01_20_34_seed_0_23090485
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9749349, 'precision': 0.97512496, 'recall': 0.97483313, 'specificity': 0.97483313, 'f1': 0.9749244, 'auroc': 0.9966353, 'binary_precision': 0.9683344, 'binary_recall': 0.98264784, 'binary_specificity': 0.9670185, 'binary_f1_score': 0.97543865}
confusion matrix:
      0     1
0  1466    50
1    27  1529
---- Validation: 
scalar performance:
{'acc': 0.7779503, 'precision': 0.7817266, 'recall': 0.7787317, 'specificity': 0.7787317, 'f1': 0.7774991, 'auroc': 0.8384054, 'binary_precision': 0.745429, 'binary_recall': 0.8346457, 'binary_specificity': 0.7228178, 'binary_f1_score': 0.78751856}
confusion matrix:
     0    1
0  472  181
1  105  530
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8418605, 'precision': 0.8437643, 'recall': 0.8418604, 'specificity': 0.8418604, 'f1': 0.8416412, 'auroc': 0.87221205, 'binary_precision': 0.8181818, 'binary_recall': 0.87906975, 'binary_specificity': 0.80465114, 'binary_f1_score': 0.84753364}
confusion matrix:
     0    1
0  173   42
1   26  189
new oracle model saved
early stop counter: 2
val acc:0.7779502868652344, best validation acc: 0.8012422323226929, corresponding to test acc:                         0.7883720993995667 / 0.8418604731559753
after epoch: 3,now: 2024-07-27 01:28:10.629605,epoch time: 0:02:29.442464,used: 0:07:35.117111,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_01_20_34_seed_0_23090485
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9749349, 'precision': 0.97536755, 'recall': 0.9751723, 'specificity': 0.9751723, 'f1': 0.9749341, 'auroc': 0.99714565, 'binary_precision': 0.99332887, 'binary_recall': 0.9569409, 'binary_specificity': 0.9934037, 'binary_f1_score': 0.9747954}
confusion matrix:
      0     1
0  1506    10
1    67  1489
---- Validation: 
scalar performance:
{'acc': 0.76785713, 'precision': 0.7717705, 'recall': 0.7669761, 'specificity': 0.7669761, 'f1': 0.7665873, 'auroc': 0.8530755, 'binary_precision': 0.8010753, 'binary_recall': 0.703937, 'binary_specificity': 0.8300153, 'binary_f1_score': 0.74937135}
confusion matrix:
     0    1
0  542  111
1  188  447
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7883721, 'precision': 0.79925466, 'recall': 0.7883721, 'specificity': 0.7883721, 'f1': 0.7864305, 'auroc': 0.8715631, 'binary_precision': 0.8563218, 'binary_recall': 0.69302326, 'binary_specificity': 0.88372093, 'binary_f1_score': 0.7660669}
confusion matrix:
     0    1
0  190   25
1   66  149
early stop counter: 3
val acc:0.7678571343421936, best validation acc: 0.8012422323226929, corresponding to test acc:                         0.7883720993995667 / 0.8418604731559753
after epoch: 4,now: 2024-07-27 01:30:39.686933,epoch time: 0:02:29.057328,used: 0:10:04.174439,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_01_20_34_seed_0_23090485
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.96809894, 'precision': 0.9687669, 'recall': 0.9684331, 'specificity': 0.9684331, 'f1': 0.968097, 'auroc': 0.9967233, 'binary_precision': 0.9905977, 'binary_recall': 0.9461193, 'binary_specificity': 0.99074686, 'binary_f1_score': 0.96784776}
confusion matrix:
      0     1
0  1499    14
1    84  1475
---- Validation: 
scalar performance:
{'acc': 0.79736024, 'precision': 0.8301919, 'recall': 0.7951393, 'specificity': 0.7951393, 'f1': 0.7913275, 'auroc': 0.8931232, 'binary_precision': 0.9308756, 'binary_recall': 0.63622046, 'binary_specificity': 0.9540582, 'binary_f1_score': 0.7558466}
confusion matrix:
     0    1
0  623   30
1  231  404
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7651163, 'precision': 0.83645403, 'recall': 0.7651163, 'specificity': 0.7651163, 'f1': 0.7519689, 'auroc': 0.90702, 'binary_precision': 0.9913793, 'binary_recall': 0.53488374, 'binary_specificity': 0.9953488, 'binary_f1_score': 0.6948641}
confusion matrix:
     0    1
0  214    1
1  100  115
early stop counter: 4
val acc:0.7973602414131165, best validation acc: 0.8012422323226929, corresponding to test acc:                         0.7883720993995667 / 0.8418604731559753
after epoch: 5,now: 2024-07-27 01:33:08.545314,epoch time: 0:02:28.858381,used: 0:12:33.032820,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_01_20_34_seed_0_23090485
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9788411, 'precision': 0.9789593, 'recall': 0.9787694, 'specificity': 0.9787694, 'f1': 0.9788344, 'auroc': 0.99874896, 'binary_precision': 0.97391856, 'binary_recall': 0.9845659, 'binary_specificity': 0.972973, 'binary_f1_score': 0.97921336}
confusion matrix:
      0     1
0  1476    41
1    24  1531
---- Validation: 
scalar performance:
{'acc': 0.80124223, 'precision': 0.8054148, 'recall': 0.8004004, 'specificity': 0.8004004, 'f1': 0.800223, 'auroc': 0.8877711, 'binary_precision': 0.83778965, 'binary_recall': 0.7401575, 'binary_specificity': 0.8606432, 'binary_f1_score': 0.78595316}
confusion matrix:
     0    1
0  562   91
1  165  470
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.80465114, 'precision': 0.82206976, 'recall': 0.80465114, 'specificity': 0.80465114, 'f1': 0.8019737, 'auroc': 0.8873553, 'binary_precision': 0.8969697, 'binary_recall': 0.6883721, 'binary_specificity': 0.9209302, 'binary_f1_score': 0.77894735}
confusion matrix:
     0    1
0  198   17
1   67  148
early stop counter: 5
val acc:0.8012422323226929, best validation acc: 0.8012422323226929, corresponding to test acc:                         0.7883720993995667 / 0.8418604731559753
after epoch: 6,now: 2024-07-27 01:35:37.775367,epoch time: 0:02:29.230053,used: 0:15:02.262873,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_01_20_34_seed_0_23090485
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 6 with time: 0:15:02.262873 at 2024-07-27 01:35:37.775367
persisted model performance metric: 

scalar performance:
{'acc': 0.7883721, 'precision': 0.79018635, 'recall': 0.7883721, 'specificity': 0.7883721, 'f1': 0.78804076, 'auroc': 0.8716496, 'binary_precision': 0.76724136, 'binary_recall': 0.82790697, 'binary_specificity': 0.74883723, 'binary_f1_score': 0.7964206}
confusion matrix:
     0    1
0  161   54
1   37  178
oracle model performance metric: 

scalar performance:
{'acc': 0.8418605, 'precision': 0.8437643, 'recall': 0.8418604, 'specificity': 0.8418604, 'f1': 0.8416412, 'auroc': 0.87221205, 'binary_precision': 0.8181818, 'binary_recall': 0.87906975, 'binary_specificity': 0.80465114, 'binary_f1_score': 0.84753364}
confusion matrix:
     0    1
0  173   42
1   26  189
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_diva_irm_3seeds_nofreeze_2024-07-27_01-18-02/rule_results/5.csv
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_diva_irm_3seeds_nofreeze_2024-07-27_01-18-02/rule_results/5.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_diva_irm_3seeds_nofreeze_2024-07-27_01-18-02/confusion_matrix/5.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   2798 MiB |   9157 MiB |  37624 GiB |  37621 GiB |
|       from large pool |   2707 MiB |   9081 MiB |  37270 GiB |  37267 GiB |
|       from small pool |     91 MiB |    129 MiB |    354 GiB |    353 GiB |
|---------------------------------------------------------------------------|
| Active memory         |   2798 MiB |   9157 MiB |  37624 GiB |  37621 GiB |
|       from large pool |   2707 MiB |   9081 MiB |  37270 GiB |  37267 GiB |
|       from small pool |     91 MiB |    129 MiB |    354 GiB |    353 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |   2779 MiB |   9143 MiB |  37560 GiB |  37557 GiB |
|       from large pool |   2687 MiB |   9068 MiB |  37206 GiB |  37204 GiB |
|       from small pool |     91 MiB |    128 MiB |    353 GiB |    353 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   9726 MiB |   9726 MiB |   9726 MiB |      0 B   |
|       from large pool |   9592 MiB |   9592 MiB |   9592 MiB |      0 B   |
|       from small pool |    134 MiB |    134 MiB |    134 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |   1041 MiB |   2251 MiB |  32909 GiB |  32908 GiB |
|       from large pool |   1032 MiB |   2245 MiB |  32544 GiB |  32543 GiB |
|       from small pool |      8 MiB |     21 MiB |    364 GiB |    364 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    2464    |    3317    |    5722 K  |    5720 K  |
|       from large pool |     392    |     816    |    2859 K  |    2859 K  |
|       from small pool |    2072    |    2768    |    2863 K  |    2860 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    2464    |    3317    |    5722 K  |    5720 K  |
|       from large pool |     392    |     816    |    2859 K  |    2859 K  |
|       from small pool |    2072    |    2768    |    2863 K  |    2860 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     266    |     266    |     266    |       0    |
|       from large pool |     199    |     199    |     199    |       0    |
|       from small pool |      67    |      67    |      67    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     139    |     299    |    2910 K  |    2910 K  |
|       from large pool |      71    |     182    |    1576 K  |    1575 K  |
|       from small pool |      68    |     228    |    1334 K  |    1334 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   9157 MiB |  37624 GiB |  37624 GiB |
|       from large pool |  16640 KiB |   9081 MiB |  37270 GiB |  37270 GiB |
|       from small pool |      0 KiB |    129 MiB |    354 GiB |    354 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   9157 MiB |  37624 GiB |  37624 GiB |
|       from large pool |  16640 KiB |   9081 MiB |  37270 GiB |  37270 GiB |
|       from small pool |      0 KiB |    129 MiB |    354 GiB |    354 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   9143 MiB |  37560 GiB |  37560 GiB |
|       from large pool |  16640 KiB |   9068 MiB |  37206 GiB |  37206 GiB |
|       from small pool |      0 KiB |    128 MiB |    353 GiB |    353 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   3840 MiB |   9726 MiB |   9726 MiB |   5886 MiB |
|       from large pool |   3740 MiB |   9592 MiB |   9592 MiB |   5852 MiB |
|       from small pool |    100 MiB |    134 MiB |    134 MiB |     34 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   2251 MiB |  32910 GiB |  32910 GiB |
|       from large pool |  24320 KiB |   2245 MiB |  32545 GiB |  32545 GiB |
|       from small pool |      0 KiB |     50 MiB |    364 GiB |    364 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3317    |    5722 K  |    5722 K  |
|       from large pool |       2    |     816    |    2859 K  |    2859 K  |
|       from small pool |       0    |    2768    |    2863 K  |    2863 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3317    |    5722 K  |    5722 K  |
|       from large pool |       2    |     816    |    2859 K  |    2859 K  |
|       from small pool |       0    |    2768    |    2863 K  |    2863 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     133    |     266    |     266    |     133    |
|       from large pool |      83    |     199    |     199    |     116    |
|       from small pool |      50    |      67    |      67    |      17    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     299    |    2911 K  |    2911 K  |
|       from large pool |       3    |     182    |    1576 K  |    1576 K  |
|       from small pool |       0    |     228    |    1334 K  |    1334 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   9157 MiB |  37624 GiB |  37624 GiB |
|       from large pool |  16640 KiB |   9081 MiB |  37270 GiB |  37270 GiB |
|       from small pool |      0 KiB |    129 MiB |    354 GiB |    354 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   9157 MiB |  37624 GiB |  37624 GiB |
|       from large pool |  16640 KiB |   9081 MiB |  37270 GiB |  37270 GiB |
|       from small pool |      0 KiB |    129 MiB |    354 GiB |    354 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   9143 MiB |  37560 GiB |  37560 GiB |
|       from large pool |  16640 KiB |   9068 MiB |  37206 GiB |  37206 GiB |
|       from small pool |      0 KiB |    128 MiB |    353 GiB |    353 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   3840 MiB |   9726 MiB |   9726 MiB |   5886 MiB |
|       from large pool |   3740 MiB |   9592 MiB |   9592 MiB |   5852 MiB |
|       from small pool |    100 MiB |    134 MiB |    134 MiB |     34 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   2251 MiB |  32910 GiB |  32910 GiB |
|       from large pool |  24320 KiB |   2245 MiB |  32545 GiB |  32545 GiB |
|       from small pool |      0 KiB |     50 MiB |    364 GiB |    364 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3317    |    5722 K  |    5722 K  |
|       from large pool |       2    |     816    |    2859 K  |    2859 K  |
|       from small pool |       0    |    2768    |    2863 K  |    2863 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3317    |    5722 K  |    5722 K  |
|       from large pool |       2    |     816    |    2859 K  |    2859 K  |
|       from small pool |       0    |    2768    |    2863 K  |    2863 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     133    |     266    |     266    |     133    |
|       from large pool |      83    |     199    |     199    |     116    |
|       from small pool |      50    |      67    |      67    |      17    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     299    |    2911 K  |    2911 K  |
|       from large pool |       3    |     182    |    1576 K  |    1576 K  |
|       from small pool |       0    |     228    |    1334 K  |    1334 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main

using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_01_36_21_seed_1_23090485

 Experiment start at: 2024-07-27 01:36:22.676332
hyper-parameter scheduler not set,going to use default Warmpup and epoch update
before training, model accuracy: 0.5022222399711609
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.97721356, 'precision': 0.977285, 'recall': 0.9771588, 'specificity': 0.9771588, 'f1': 0.977207, 'auroc': 0.9981762, 'binary_precision': 0.97385204, 'binary_recall': 0.98136246, 'binary_specificity': 0.97295517, 'binary_f1_score': 0.9775928}
confusion matrix:
      0     1
0  1475    41
1    29  1527
---- Validation: 
scalar performance:
{'acc': 0.8360656, 'precision': 0.83766234, 'recall': 0.8354839, 'specificity': 0.8354839, 'f1': 0.8356681, 'auroc': 0.90224075, 'binary_precision': 0.85714287, 'binary_recall': 0.8, 'binary_specificity': 0.87096775, 'binary_f1_score': 0.82758623}
confusion matrix:
     0    1
0  567   84
1  126  504
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.84444445, 'precision': 0.84718764, 'recall': 0.84444445, 'specificity': 0.84444445, 'f1': 0.84413654, 'auroc': 0.91012347, 'binary_precision': 0.8780488, 'binary_recall': 0.8, 'binary_specificity': 0.8888889, 'binary_f1_score': 0.8372092}
confusion matrix:
     0    1
0  200   25
1   45  180
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-27 01:38:57.954433,epoch time: 0:02:35.278101,used: 0:02:35.278101,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_01_36_21_seed_1_23090485
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9742839, 'precision': 0.97461843, 'recall': 0.974147, 'specificity': 0.974147, 'f1': 0.9742701, 'auroc': 0.99728775, 'binary_precision': 0.9647355, 'binary_recall': 0.985209, 'binary_specificity': 0.96308506, 'binary_f1_score': 0.9748648}
confusion matrix:
      0     1
0  1461    56
1    23  1532
---- Validation: 
scalar performance:
{'acc': 0.84933645, 'precision': 0.84977937, 'recall': 0.84902716, 'specificity': 0.84902716, 'f1': 0.8491743, 'auroc': 0.907383, 'binary_precision': 0.8587849, 'binary_recall': 0.8301587, 'binary_specificity': 0.86789554, 'binary_f1_score': 0.8442292}
confusion matrix:
     0    1
0  565   86
1  107  523
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.82222223, 'precision': 0.8288744, 'recall': 0.82222223, 'specificity': 0.82222223, 'f1': 0.8213186, 'auroc': 0.9034469, 'binary_precision': 0.87564766, 'binary_recall': 0.7511111, 'binary_specificity': 0.8933333, 'binary_f1_score': 0.80861235}
confusion matrix:
     0    1
0  201   24
1   56  169
better model found
persisted
after epoch: 2,now: 2024-07-27 01:41:28.270909,epoch time: 0:02:30.316476,used: 0:05:05.594577,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_01_36_21_seed_1_23090485
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.98046875, 'precision': 0.9807994, 'recall': 0.98032975, 'specificity': 0.98032975, 'f1': 0.980458, 'auroc': 0.998345, 'binary_precision': 0.97103274, 'binary_recall': 0.99100256, 'binary_specificity': 0.969657, 'binary_f1_score': 0.980916}
confusion matrix:
      0     1
0  1470    46
1    14  1542
---- Validation: 
scalar performance:
{'acc': 0.8266979, 'precision': 0.8276538, 'recall': 0.8271377, 'specificity': 0.8271377, 'f1': 0.82666737, 'auroc': 0.90959024, 'binary_precision': 0.8053892, 'binary_recall': 0.85396826, 'binary_specificity': 0.8003072, 'binary_f1_score': 0.82896763}
confusion matrix:
     0    1
0  521  130
1   92  538
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8088889, 'precision': 0.80977, 'recall': 0.8088889, 'specificity': 0.8088889, 'f1': 0.8087529, 'auroc': 0.8908247, 'binary_precision': 0.79324895, 'binary_recall': 0.83555555, 'binary_specificity': 0.7822222, 'binary_f1_score': 0.81385285}
confusion matrix:
     0    1
0  176   49
1   37  188
early stop counter: 1
val acc:0.8266978859901428, best validation acc: 0.8493364453315735, corresponding to test acc:                         0.8222222328186035 / 0.8444444537162781
after epoch: 3,now: 2024-07-27 01:43:58.530475,epoch time: 0:02:30.259566,used: 0:07:35.854143,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_01_36_21_seed_1_23090485
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.98502606, 'precision': 0.9850303, 'recall': 0.9851043, 'specificity': 0.9851043, 'f1': 0.9850255, 'auroc': 0.998819, 'binary_precision': 0.99153095, 'binary_recall': 0.9787781, 'binary_specificity': 0.99143046, 'binary_f1_score': 0.98511326}
confusion matrix:
      0     1
0  1504    13
1    33  1522
---- Validation: 
scalar performance:
{'acc': 0.86416864, 'precision': 0.86951876, 'recall': 0.8631848, 'specificity': 0.8631848, 'f1': 0.8634175, 'auroc': 0.9213201, 'binary_precision': 0.91007197, 'binary_recall': 0.8031746, 'binary_specificity': 0.92319506, 'binary_f1_score': 0.8532884}
confusion matrix:
     0    1
0  601   50
1  124  506
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8244445, 'precision': 0.83157706, 'recall': 0.8244444, 'specificity': 0.8244444, 'f1': 0.82349527, 'auroc': 0.8989235, 'binary_precision': 0.8802083, 'binary_recall': 0.7511111, 'binary_specificity': 0.8977778, 'binary_f1_score': 0.8105516}
confusion matrix:
     0    1
0  202   23
1   56  169
better model found
persisted
after epoch: 4,now: 2024-07-27 01:46:28.641703,epoch time: 0:02:30.111228,used: 0:10:05.965371,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_01_36_21_seed_1_23090485
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9781901, 'precision': 0.9786247, 'recall': 0.978428, 'specificity': 0.978428, 'f1': 0.97818947, 'auroc': 0.9985641, 'binary_precision': 0.99666446, 'binary_recall': 0.96015424, 'binary_specificity': 0.99670184, 'binary_f1_score': 0.97806877}
confusion matrix:
      0     1
0  1511     5
1    62  1494
---- Validation: 
scalar performance:
{'acc': 0.78844655, 'precision': 0.8159611, 'recall': 0.7859959, 'specificity': 0.7859959, 'f1': 0.7827178, 'auroc': 0.8984127, 'binary_precision': 0.9051919, 'binary_recall': 0.6365079, 'binary_specificity': 0.9354839, 'binary_f1_score': 0.74743706}
confusion matrix:
     0    1
0  609   42
1  229  401
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8155556, 'precision': 0.8173673, 'recall': 0.8155556, 'specificity': 0.8155556, 'f1': 0.8152919, 'auroc': 0.8936148, 'binary_precision': 0.84134614, 'binary_recall': 0.7777778, 'binary_specificity': 0.85333335, 'binary_f1_score': 0.8083141}
confusion matrix:
     0    1
0  192   33
1   50  175
early stop counter: 1
val acc:0.7884465456008911, best validation acc: 0.864168643951416, corresponding to test acc:                         0.8244444727897644 / 0.8444444537162781
after epoch: 5,now: 2024-07-27 01:48:58.059838,epoch time: 0:02:29.418135,used: 0:12:35.383506,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_01_36_21_seed_1_23090485
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9869792, 'precision': 0.98706853, 'recall': 0.98692393, 'specificity': 0.98692393, 'f1': 0.98697567, 'auroc': 0.9992832, 'binary_precision': 0.98278064, 'binary_recall': 0.9916345, 'binary_specificity': 0.98221344, 'binary_f1_score': 0.98718774}
confusion matrix:
      0     1
0  1491    27
1    13  1541
---- Validation: 
scalar performance:
{'acc': 0.8579235, 'precision': 0.8593633, 'recall': 0.85739887, 'specificity': 0.85739887, 'f1': 0.8576215, 'auroc': 0.91141343, 'binary_precision': 0.8783784, 'binary_recall': 0.82539684, 'binary_specificity': 0.8894009, 'binary_f1_score': 0.8510639}
confusion matrix:
     0    1
0  579   72
1  110  520
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.85555553, 'precision': 0.85612535, 'recall': 0.85555553, 'specificity': 0.85555553, 'f1': 0.8554978, 'auroc': 0.9153185, 'binary_precision': 0.8703704, 'binary_recall': 0.83555555, 'binary_specificity': 0.8755556, 'binary_f1_score': 0.8526077}
confusion matrix:
     0    1
0  197   28
1   37  188
new oracle model saved
early stop counter: 2
val acc:0.8579235076904297, best validation acc: 0.864168643951416, corresponding to test acc:                         0.8244444727897644 / 0.855555534362793
after epoch: 6,now: 2024-07-27 01:51:27.065143,epoch time: 0:02:29.005305,used: 0:15:04.388811,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_01_36_21_seed_1_23090485
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.98079425, 'precision': 0.98125327, 'recall': 0.9810091, 'specificity': 0.9810091, 'f1': 0.98079336, 'auroc': 0.9992654, 'binary_precision': 0.999332, 'binary_recall': 0.96267694, 'binary_specificity': 0.99934125, 'binary_f1_score': 0.98066205}
confusion matrix:
      0     1
0  1517     1
1    58  1496
---- Validation: 
scalar performance:
{'acc': 0.7626854, 'precision': 0.8135594, 'recall': 0.7593446, 'specificity': 0.7593446, 'f1': 0.75104463, 'auroc': 0.9010131, 'binary_precision': 0.93582886, 'binary_recall': 0.5555556, 'binary_specificity': 0.96313363, 'binary_f1_score': 0.69721115}
confusion matrix:
     0    1
0  627   24
1  280  350
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.82222223, 'precision': 0.8419166, 'recall': 0.82222223, 'specificity': 0.82222223, 'f1': 0.8196249, 'auroc': 0.8911803, 'binary_precision': 0.9239766, 'binary_recall': 0.7022222, 'binary_specificity': 0.94222224, 'binary_f1_score': 0.79797983}
confusion matrix:
     0    1
0  212   13
1   67  158
early stop counter: 3
val acc:0.7626854181289673, best validation acc: 0.864168643951416, corresponding to test acc:                         0.8244444727897644 / 0.855555534362793
after epoch: 7,now: 2024-07-27 01:53:55.899162,epoch time: 0:02:28.834019,used: 0:17:33.222830,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_01_36_21_seed_1_23090485
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9873047, 'precision': 0.9872979, 'recall': 0.9873067, 'specificity': 0.9873067, 'f1': 0.9873022, 'auroc': 0.99939203, 'binary_precision': 0.987797, 'binary_recall': 0.987163, 'binary_specificity': 0.9874505, 'binary_f1_score': 0.98747987}
confusion matrix:
      0     1
0  1495    19
1    20  1538
---- Validation: 
scalar performance:
{'acc': 0.8376269, 'precision': 0.8574904, 'recall': 0.8356887, 'specificity': 0.8356887, 'f1': 0.8347507, 'auroc': 0.9276546, 'binary_precision': 0.93775934, 'binary_recall': 0.71746033, 'binary_specificity': 0.953917, 'binary_f1_score': 0.81294966}
confusion matrix:
     0    1
0  621   30
1  178  452
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8622222, 'precision': 0.88103896, 'recall': 0.8622222, 'specificity': 0.8622222, 'f1': 0.86050004, 'auroc': 0.9303309, 'binary_precision': 0.9657143, 'binary_recall': 0.7511111, 'binary_specificity': 0.97333336, 'binary_f1_score': 0.845}
confusion matrix:
     0    1
0  219    6
1   56  169
new oracle model saved
early stop counter: 4
val acc:0.8376268744468689, best validation acc: 0.864168643951416, corresponding to test acc:                         0.8244444727897644 / 0.8622221946716309
after epoch: 8,now: 2024-07-27 01:56:26.110991,epoch time: 0:02:30.211829,used: 0:20:03.434659,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_01_36_21_seed_1_23090485
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9742839, 'precision': 0.97533107, 'recall': 0.97406065, 'specificity': 0.97406065, 'f1': 0.9742582, 'auroc': 0.9987961, 'binary_precision': 0.9554731, 'binary_recall': 0.9954897, 'binary_specificity': 0.9526316, 'binary_f1_score': 0.975071}
confusion matrix:
      0     1
0  1448    72
1     7  1545
---- Validation: 
scalar performance:
{'acc': 0.8704137, 'precision': 0.8710072, 'recall': 0.87076294, 'specificity': 0.87076294, 'f1': 0.87040734, 'auroc': 0.9248019, 'binary_precision': 0.8515152, 'binary_recall': 0.8920635, 'binary_specificity': 0.8494624, 'binary_f1_score': 0.8713178}
confusion matrix:
     0    1
0  553   98
1   68  562
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8577778, 'precision': 0.8587984, 'recall': 0.8577778, 'specificity': 0.8577778, 'f1': 0.85767657, 'auroc': 0.91653824, 'binary_precision': 0.8779343, 'binary_recall': 0.83111113, 'binary_specificity': 0.8844444, 'binary_f1_score': 0.85388124}
confusion matrix:
     0    1
0  199   26
1   38  187
better model found
persisted
after epoch: 9,now: 2024-07-27 01:58:55.289607,epoch time: 0:02:29.178616,used: 0:22:32.613275,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_01_36_21_seed_1_23090485
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.94140625, 'precision': 0.9477549, 'recall': 0.9406208, 'specificity': 0.9406208, 'f1': 0.94111514, 'auroc': 0.9978299, 'binary_precision': 0.897747, 'binary_recall': 0.9980732, 'binary_specificity': 0.88316834, 'binary_f1_score': 0.94525546}
confusion matrix:
      0     1
0  1338   177
1     3  1554
---- Validation: 
scalar performance:
{'acc': 0.7915691, 'precision': 0.80773056, 'recall': 0.7934204, 'specificity': 0.7934204, 'f1': 0.78946704, 'auroc': 0.8868712, 'binary_precision': 0.73299104, 'binary_recall': 0.9063492, 'binary_specificity': 0.68049157, 'binary_f1_score': 0.8105039}
confusion matrix:
     0    1
0  443  208
1   59  571
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.76222223, 'precision': 0.78944266, 'recall': 0.7622222, 'specificity': 0.7622222, 'f1': 0.75649714, 'auroc': 0.90514565, 'binary_precision': 0.70068026, 'binary_recall': 0.91555554, 'binary_specificity': 0.60888886, 'binary_f1_score': 0.79383427}
confusion matrix:
     0    1
0  137   88
1   19  206
early stop counter: 1
val acc:0.7915691137313843, best validation acc: 0.8704137206077576, corresponding to test acc:                         0.8577777743339539 / 0.8622221946716309
after epoch: 10,now: 2024-07-27 02:01:24.105135,epoch time: 0:02:28.815528,used: 0:25:01.428803,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_01_36_21_seed_1_23090485
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9707031, 'precision': 0.9720013, 'recall': 0.9709801, 'specificity': 0.9709801, 'f1': 0.97069263, 'auroc': 0.99973935, 'binary_precision': 0.99931645, 'binary_recall': 0.94261765, 'binary_specificity': 0.99934256, 'binary_f1_score': 0.9701393}
confusion matrix:
      0     1
0  1520     1
1    89  1462
---- Validation: 
scalar performance:
{'acc': 0.5261514, 'precision': 0.69428384, 'recall': 0.5183564, 'specificity': 0.5183564, 'f1': 0.3811944, 'auroc': 0.9106186, 'binary_precision': 0.87096775, 'binary_recall': 0.042857144, 'binary_specificity': 0.9938556, 'binary_f1_score': 0.0816944}
confusion matrix:
     0   1
0  647   4
1  603  27
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.4977778, 'precision': 0.2494432, 'recall': 0.4977778, 'specificity': 0.4977778, 'f1': 0.3323442, 'auroc': 0.9207111, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9955556, 'binary_f1_score': 0.0}
confusion matrix:
     0  1
0  224  1
1  225  0
early stop counter: 2
val acc:0.5261514186859131, best validation acc: 0.8704137206077576, corresponding to test acc:                         0.8577777743339539 / 0.8622221946716309
after epoch: 11,now: 2024-07-27 02:03:52.771505,epoch time: 0:02:28.666370,used: 0:27:30.095173,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_01_36_21_seed_1_23090485
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9707031, 'precision': 0.9706911, 'recall': 0.9707525, 'specificity': 0.9707525, 'f1': 0.97070163, 'auroc': 0.9968643, 'binary_precision': 0.9753247, 'binary_recall': 0.96653795, 'binary_specificity': 0.97496706, 'binary_f1_score': 0.9709115}
confusion matrix:
      0     1
0  1480    38
1    52  1502
---- Validation: 
scalar performance:
{'acc': 0.62138957, 'precision': 0.7222943, 'recall': 0.615745, 'specificity': 0.615745, 'f1': 0.567002, 'auroc': 0.8570478, 'binary_precision': 0.8680203, 'binary_recall': 0.27142859, 'binary_specificity': 0.96006143, 'binary_f1_score': 0.41354296}
confusion matrix:
     0    1
0  625   26
1  459  171
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.62222224, 'precision': 0.7537837, 'recall': 0.6222222, 'specificity': 0.6222222, 'f1': 0.5659722, 'auroc': 0.8936296, 'binary_precision': 0.93650794, 'binary_recall': 0.26222223, 'binary_specificity': 0.9822222, 'binary_f1_score': 0.4097222}
confusion matrix:
     0   1
0  221   4
1  166  59
early stop counter: 3
val acc:0.6213895678520203, best validation acc: 0.8704137206077576, corresponding to test acc:                         0.8577777743339539 / 0.8622221946716309
after epoch: 12,now: 2024-07-27 02:06:20.827551,epoch time: 0:02:28.056046,used: 0:29:58.151219,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_01_36_21_seed_1_23090485
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.98828125, 'precision': 0.9882897, 'recall': 0.988356, 'specificity': 0.988356, 'f1': 0.98828095, 'auroc': 0.99940526, 'binary_precision': 0.9947849, 'binary_recall': 0.981982, 'binary_specificity': 0.99472994, 'binary_f1_score': 0.988342}
confusion matrix:
      0     1
0  1510     8
1    28  1526
---- Validation: 
scalar performance:
{'acc': 0.6198283, 'precision': 0.7391151, 'recall': 0.6139273, 'specificity': 0.6139273, 'f1': 0.5595187, 'auroc': 0.87788016, 'binary_precision': 0.9039548, 'binary_recall': 0.25396827, 'binary_specificity': 0.9738863, 'binary_f1_score': 0.3965304}
confusion matrix:
     0    1
0  634   17
1  470  160
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.59555554, 'precision': 0.7299083, 'recall': 0.59555554, 'specificity': 0.59555554, 'f1': 0.5263596, 'auroc': 0.90578765, 'binary_precision': 0.9056604, 'binary_recall': 0.21333334, 'binary_specificity': 0.9777778, 'binary_f1_score': 0.34532374}
confusion matrix:
     0   1
0  220   5
1  177  48
early stop counter: 4
val acc:0.6198282837867737, best validation acc: 0.8704137206077576, corresponding to test acc:                         0.8577777743339539 / 0.8622221946716309
after epoch: 13,now: 2024-07-27 02:08:47.273365,epoch time: 0:02:26.445814,used: 0:32:24.597033,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_01_36_21_seed_1_23090485
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9895833, 'precision': 0.98959184, 'recall': 0.98965824, 'specificity': 0.98965824, 'f1': 0.989583, 'auroc': 0.9994333, 'binary_precision': 0.9960887, 'binary_recall': 0.983269, 'binary_specificity': 0.99604744, 'binary_f1_score': 0.9896373}
confusion matrix:
      0     1
0  1512     6
1    26  1528
---- Validation: 
scalar performance:
{'acc': 0.83684623, 'precision': 0.85081273, 'recall': 0.8352022, 'specificity': 0.8352022, 'f1': 0.8346989, 'auroc': 0.92115426, 'binary_precision': 0.9168317, 'binary_recall': 0.7349206, 'binary_specificity': 0.9354839, 'binary_f1_score': 0.815859}
confusion matrix:
     0    1
0  609   42
1  167  463
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8666667, 'precision': 0.8763, 'recall': 0.8666667, 'specificity': 0.8666667, 'f1': 0.8658079, 'auroc': 0.93305683, 'binary_precision': 0.93650794, 'binary_recall': 0.7866667, 'binary_specificity': 0.94666666, 'binary_f1_score': 0.8550725}
confusion matrix:
     0    1
0  213   12
1   48  177
new oracle model saved
early stop counter: 5
val acc:0.8368462324142456, best validation acc: 0.8704137206077576, corresponding to test acc:                         0.8577777743339539 / 0.8666666746139526
after epoch: 14,now: 2024-07-27 02:11:12.094978,epoch time: 0:02:24.821613,used: 0:34:49.418646,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_01_36_21_seed_1_23090485
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 14 with time: 0:34:49.418646 at 2024-07-27 02:11:12.094978
persisted model performance metric: 

scalar performance:
{'acc': 0.8577778, 'precision': 0.8587984, 'recall': 0.8577778, 'specificity': 0.8577778, 'f1': 0.85767657, 'auroc': 0.91653824, 'binary_precision': 0.8779343, 'binary_recall': 0.83111113, 'binary_specificity': 0.8844444, 'binary_f1_score': 0.85388124}
confusion matrix:
     0    1
0  199   26
1   38  187
oracle model performance metric: 

scalar performance:
{'acc': 0.8666667, 'precision': 0.8763, 'recall': 0.8666667, 'specificity': 0.8666667, 'f1': 0.8658079, 'auroc': 0.93305683, 'binary_precision': 0.93650794, 'binary_recall': 0.7866667, 'binary_specificity': 0.94666666, 'binary_f1_score': 0.8550725}
confusion matrix:
     0    1
0  213   12
1   48  177
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_diva_irm_3seeds_nofreeze_2024-07-27_01-18-02/rule_results/5.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_diva_irm_3seeds_nofreeze_2024-07-27_01-18-02/confusion_matrix/5.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   2800 MiB |   9163 MiB | 125136 GiB | 125133 GiB |
|       from large pool |   2709 MiB |   9087 MiB | 123957 GiB | 123954 GiB |
|       from small pool |     91 MiB |    132 MiB |   1178 GiB |   1178 GiB |
|---------------------------------------------------------------------------|
| Active memory         |   2800 MiB |   9163 MiB | 125136 GiB | 125133 GiB |
|       from large pool |   2709 MiB |   9087 MiB | 123957 GiB | 123954 GiB |
|       from small pool |     91 MiB |    132 MiB |   1178 GiB |   1178 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |   2779 MiB |   9143 MiB | 124960 GiB | 124958 GiB |
|       from large pool |   2687 MiB |   9068 MiB | 123784 GiB | 123781 GiB |
|       from small pool |     91 MiB |    132 MiB |   1176 GiB |   1176 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   9672 MiB |   9726 MiB |  15558 MiB |   5886 MiB |
|       from large pool |   9532 MiB |   9592 MiB |  15384 MiB |   5852 MiB |
|       from small pool |    140 MiB |    140 MiB |    174 MiB |     34 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |   1885 MiB |   2545 MiB | 112632 GiB | 112630 GiB |
|       from large pool |   1870 MiB |   2543 MiB | 111419 GiB | 111417 GiB |
|       from small pool |     14 MiB |     50 MiB |   1213 GiB |   1213 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    2476    |    3329    |   19029 K  |   19027 K  |
|       from large pool |     392    |     816    |    9507 K  |    9506 K  |
|       from small pool |    2084    |    2780    |    9522 K  |    9520 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    2476    |    3329    |   19029 K  |   19027 K  |
|       from large pool |     392    |     816    |    9507 K  |    9506 K  |
|       from small pool |    2084    |    2780    |    9522 K  |    9520 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     237    |     266    |     370    |     133    |
|       from large pool |     167    |     199    |     283    |     116    |
|       from small pool |      70    |      70    |      87    |      17    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     153    |     303    |    9771 K  |    9771 K  |
|       from large pool |      75    |     182    |    5027 K  |    5027 K  |
|       from small pool |      78    |     228    |    4744 K  |    4744 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   9163 MiB | 125136 GiB | 125136 GiB |
|       from large pool |  16640 KiB |   9087 MiB | 123957 GiB | 123957 GiB |
|       from small pool |      0 KiB |    132 MiB |   1178 GiB |   1178 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   9163 MiB | 125136 GiB | 125136 GiB |
|       from large pool |  16640 KiB |   9087 MiB | 123957 GiB | 123957 GiB |
|       from small pool |      0 KiB |    132 MiB |   1178 GiB |   1178 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   9143 MiB | 124960 GiB | 124960 GiB |
|       from large pool |  16640 KiB |   9068 MiB | 123784 GiB | 123784 GiB |
|       from small pool |      0 KiB |    132 MiB |   1176 GiB |   1176 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   4686 MiB |   9726 MiB |  15558 MiB |  10872 MiB |
|       from large pool |   4580 MiB |   9592 MiB |  15384 MiB |  10804 MiB |
|       from small pool |    106 MiB |    140 MiB |    174 MiB |     68 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   2545 MiB | 112633 GiB | 112633 GiB |
|       from large pool |  24320 KiB |   2543 MiB | 111420 GiB | 111420 GiB |
|       from small pool |      0 KiB |     54 MiB |   1213 GiB |   1213 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3329    |   19029 K  |   19029 K  |
|       from large pool |       2    |     816    |    9507 K  |    9507 K  |
|       from small pool |       0    |    2780    |    9522 K  |    9522 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3329    |   19029 K  |   19029 K  |
|       from large pool |       2    |     816    |    9507 K  |    9507 K  |
|       from small pool |       0    |    2780    |    9522 K  |    9522 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     136    |     266    |     370    |     234    |
|       from large pool |      83    |     199    |     283    |     200    |
|       from small pool |      53    |      70    |      87    |      34    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     303    |    9771 K  |    9771 K  |
|       from large pool |       3    |     182    |    5027 K  |    5027 K  |
|       from small pool |       0    |     228    |    4744 K  |    4744 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   9163 MiB | 125136 GiB | 125136 GiB |
|       from large pool |  16640 KiB |   9087 MiB | 123957 GiB | 123957 GiB |
|       from small pool |      0 KiB |    132 MiB |   1178 GiB |   1178 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   9163 MiB | 125136 GiB | 125136 GiB |
|       from large pool |  16640 KiB |   9087 MiB | 123957 GiB | 123957 GiB |
|       from small pool |      0 KiB |    132 MiB |   1178 GiB |   1178 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   9143 MiB | 124960 GiB | 124960 GiB |
|       from large pool |  16640 KiB |   9068 MiB | 123784 GiB | 123784 GiB |
|       from small pool |      0 KiB |    132 MiB |   1176 GiB |   1176 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   4686 MiB |   9726 MiB |  15558 MiB |  10872 MiB |
|       from large pool |   4580 MiB |   9592 MiB |  15384 MiB |  10804 MiB |
|       from small pool |    106 MiB |    140 MiB |    174 MiB |     68 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   2545 MiB | 112633 GiB | 112633 GiB |
|       from large pool |  24320 KiB |   2543 MiB | 111420 GiB | 111420 GiB |
|       from small pool |      0 KiB |     54 MiB |   1213 GiB |   1213 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3329    |   19029 K  |   19029 K  |
|       from large pool |       2    |     816    |    9507 K  |    9507 K  |
|       from small pool |       0    |    2780    |    9522 K  |    9522 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3329    |   19029 K  |   19029 K  |
|       from large pool |       2    |     816    |    9507 K  |    9507 K  |
|       from small pool |       0    |    2780    |    9522 K  |    9522 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     136    |     266    |     370    |     234    |
|       from large pool |      83    |     199    |     283    |     200    |
|       from small pool |      53    |      70    |      87    |      34    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     303    |    9771 K  |    9771 K  |
|       from large pool |       3    |     182    |    5027 K  |    5027 K  |
|       from small pool |       0    |     228    |    4744 K  |    4744 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main

using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_02_11_51_seed_2_23090485

 Experiment start at: 2024-07-27 02:11:52.267186
hyper-parameter scheduler not set,going to use default Warmpup and epoch update
before training, model accuracy: 0.5
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9554974, 'precision': 0.95587695, 'recall': 0.95562315, 'specificity': 0.95562315, 'f1': 0.95549417, 'auroc': 0.9894793, 'binary_precision': 0.9711409, 'binary_recall': 0.93961036, 'binary_specificity': 0.9716359, 'binary_f1_score': 0.95511544}
confusion matrix:
      0     1
0  1473    43
1    93  1447
---- Validation: 
scalar performance:
{'acc': 0.7832551, 'precision': 0.79283994, 'recall': 0.7855805, 'specificity': 0.7855805, 'f1': 0.782292, 'auroc': 0.8464924, 'binary_precision': 0.7327935, 'binary_recall': 0.87299037, 'binary_specificity': 0.6981707, 'binary_f1_score': 0.7967718}
confusion matrix:
     0    1
0  458  198
1   79  543
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8101852, 'precision': 0.81085145, 'recall': 0.8101852, 'specificity': 0.8101852, 'f1': 0.81008345, 'auroc': 0.864519, 'binary_precision': 0.79646015, 'binary_recall': 0.8333333, 'binary_specificity': 0.787037, 'binary_f1_score': 0.81447965}
confusion matrix:
     0    1
0  170   46
1   36  180
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-27 02:14:20.021534,epoch time: 0:02:27.754348,used: 0:02:27.754348,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_02_11_51_seed_2_23090485
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9548429, 'precision': 0.9572283, 'recall': 0.95513827, 'specificity': 0.95513827, 'f1': 0.954802, 'auroc': 0.9928739, 'binary_precision': 0.9922753, 'binary_recall': 0.91753244, 'binary_specificity': 0.9927441, 'binary_f1_score': 0.9534413}
confusion matrix:
      0     1
0  1505    11
1   127  1413
---- Validation: 
scalar performance:
{'acc': 0.8255086, 'precision': 0.84320223, 'recall': 0.8224478, 'specificity': 0.8224478, 'f1': 0.82217425, 'auroc': 0.90391624, 'binary_precision': 0.9147609, 'binary_recall': 0.7073955, 'binary_specificity': 0.9375, 'binary_f1_score': 0.7978241}
confusion matrix:
     0    1
0  615   41
1  182  440
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7824074, 'precision': 0.8356087, 'recall': 0.7824074, 'specificity': 0.7824074, 'f1': 0.7734282, 'auroc': 0.9225769, 'binary_precision': 0.9692308, 'binary_recall': 0.5833333, 'binary_specificity': 0.9814815, 'binary_f1_score': 0.7283237}
confusion matrix:
     0    1
0  212    4
1   90  126
better model found
persisted
after epoch: 2,now: 2024-07-27 02:16:42.405565,epoch time: 0:02:22.384031,used: 0:04:50.138379,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_02_11_51_seed_2_23090485
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.94829845, 'precision': 0.95162755, 'recall': 0.9479714, 'specificity': 0.9479714, 'f1': 0.9481735, 'auroc': 0.99676013, 'binary_precision': 0.9147659, 'binary_recall': 0.9896104, 'binary_specificity': 0.90633243, 'binary_f1_score': 0.9507174}
confusion matrix:
      0     1
0  1374   142
1    16  1524
---- Validation: 
scalar performance:
{'acc': 0.7347418, 'precision': 0.7807575, 'recall': 0.73999095, 'specificity': 0.73999095, 'f1': 0.72610044, 'auroc': 0.8647802, 'binary_precision': 0.6602492, 'binary_recall': 0.937299, 'binary_specificity': 0.54268295, 'binary_f1_score': 0.77475077}
confusion matrix:
     0    1
0  356  300
1   39  583
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8310185, 'precision': 0.8446783, 'recall': 0.83101857, 'specificity': 0.83101857, 'f1': 0.8293276, 'auroc': 0.92348254, 'binary_precision': 0.7760618, 'binary_recall': 0.9305556, 'binary_specificity': 0.7314815, 'binary_f1_score': 0.8463158}
confusion matrix:
     0    1
0  158   58
1   15  201
new oracle model saved
early stop counter: 1
val acc:0.7347418069839478, best validation acc: 0.8255085945129395, corresponding to test acc:                         0.7824074029922485 / 0.8310185074806213
after epoch: 3,now: 2024-07-27 02:19:03.950491,epoch time: 0:02:21.544926,used: 0:07:11.683305,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_02_11_51_seed_2_23090485
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.960733, 'precision': 0.9616524, 'recall': 0.9609207, 'specificity': 0.9609207, 'f1': 0.96072245, 'auroc': 0.99336946, 'binary_precision': 0.98431104, 'binary_recall': 0.937013, 'binary_specificity': 0.9848285, 'binary_f1_score': 0.9600798}
confusion matrix:
      0     1
0  1493    23
1    97  1443
---- Validation: 
scalar performance:
{'acc': 0.78716743, 'precision': 0.7888026, 'recall': 0.78601676, 'specificity': 0.78601676, 'f1': 0.7862876, 'auroc': 0.8574352, 'binary_precision': 0.80487806, 'binary_recall': 0.74276525, 'binary_specificity': 0.8292683, 'binary_f1_score': 0.7725752}
confusion matrix:
     0    1
0  544  112
1  160  462
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7986111, 'precision': 0.808674, 'recall': 0.7986111, 'specificity': 0.7986111, 'f1': 0.7969563, 'auroc': 0.8754287, 'binary_precision': 0.86440676, 'binary_recall': 0.7083333, 'binary_specificity': 0.8888889, 'binary_f1_score': 0.77862597}
confusion matrix:
     0    1
0  192   24
1   63  153
early stop counter: 2
val acc:0.7871674299240112, best validation acc: 0.8255085945129395, corresponding to test acc:                         0.7824074029922485 / 0.8310185074806213
after epoch: 4,now: 2024-07-27 02:21:24.438457,epoch time: 0:02:20.487966,used: 0:09:32.171271,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_02_11_51_seed_2_23090485
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.976767, 'precision': 0.97738385, 'recall': 0.97692233, 'specificity': 0.97692233, 'f1': 0.9767636, 'auroc': 0.9980562, 'binary_precision': 0.99661934, 'binary_recall': 0.95714283, 'binary_specificity': 0.99670184, 'binary_f1_score': 0.9764823}
confusion matrix:
      0     1
0  1511     5
1    66  1474
---- Validation: 
scalar performance:
{'acc': 0.7316119, 'precision': 0.78604317, 'recall': 0.7256514, 'specificity': 0.7256514, 'f1': 0.71471786, 'auroc': 0.85828567, 'binary_precision': 0.90434784, 'binary_recall': 0.5016077, 'binary_specificity': 0.9496951, 'binary_f1_score': 0.6452947}
confusion matrix:
     0    1
0  623   33
1  310  312
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7662037, 'precision': 0.8177527, 'recall': 0.7662037, 'specificity': 0.7662037, 'f1': 0.7563207, 'auroc': 0.9102795, 'binary_precision': 0.9457364, 'binary_recall': 0.5648148, 'binary_specificity': 0.9675926, 'binary_f1_score': 0.70724636}
confusion matrix:
     0    1
0  209    7
1   94  122
early stop counter: 3
val acc:0.7316119074821472, best validation acc: 0.8255085945129395, corresponding to test acc:                         0.7824074029922485 / 0.8310185074806213
after epoch: 5,now: 2024-07-27 02:23:44.228352,epoch time: 0:02:19.789895,used: 0:11:51.961166,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_02_11_51_seed_2_23090485
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.97971207, 'precision': 0.9803549, 'recall': 0.97987014, 'specificity': 0.97987014, 'f1': 0.9797089, 'auroc': 0.99851286, 'binary_precision': 1.0, 'binary_recall': 0.9597403, 'binary_specificity': 1.0, 'binary_f1_score': 0.9794566}
confusion matrix:
      0     1
0  1516     0
1    62  1478
---- Validation: 
scalar performance:
{'acc': 0.57511735, 'precision': 0.75073105, 'recall': 0.56367147, 'specificity': 0.56367147, 'f1': 0.47007117, 'auroc': 0.89475274, 'binary_precision': 0.954023, 'binary_recall': 0.13344051, 'binary_specificity': 0.99390244, 'binary_f1_score': 0.23413257}
confusion matrix:
     0   1
0  652   4
1  539  83
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5115741, 'precision': 0.7529274, 'recall': 0.5115741, 'specificity': 0.5115741, 'f1': 0.35854977, 'auroc': 0.9231181, 'binary_precision': 1.0, 'binary_recall': 0.023148147, 'binary_specificity': 1.0, 'binary_f1_score': 0.045248866}
confusion matrix:
     0  1
0  216  0
1  211  5
early stop counter: 4
val acc:0.5751173496246338, best validation acc: 0.8255085945129395, corresponding to test acc:                         0.7824074029922485 / 0.8310185074806213
after epoch: 6,now: 2024-07-27 02:26:04.242264,epoch time: 0:02:20.013912,used: 0:14:11.975078,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_02_11_51_seed_2_23090485
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9718586, 'precision': 0.9721371, 'recall': 0.9717747, 'specificity': 0.9717747, 'f1': 0.9718492, 'auroc': 0.9978566, 'binary_precision': 0.9624682, 'binary_recall': 0.98246753, 'binary_specificity': 0.9610818, 'binary_f1_score': 0.972365}
confusion matrix:
      0     1
0  1457    59
1    27  1513
---- Validation: 
scalar performance:
{'acc': 0.8482003, 'precision': 0.8540493, 'recall': 0.849926, 'specificity': 0.849926, 'f1': 0.8479289, 'auroc': 0.91456556, 'binary_precision': 0.80140847, 'binary_recall': 0.914791, 'binary_specificity': 0.785061, 'binary_f1_score': 0.8543544}
confusion matrix:
     0    1
0  515  141
1   53  569
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8449074, 'precision': 0.8449739, 'recall': 0.8449074, 'specificity': 0.8449074, 'f1': 0.8449, 'auroc': 0.93389916, 'binary_precision': 0.84018266, 'binary_recall': 0.8518519, 'binary_specificity': 0.837963, 'binary_f1_score': 0.84597707}
confusion matrix:
     0    1
0  181   35
1   32  184
new oracle model saved
better model found
persisted
after epoch: 7,now: 2024-07-27 02:28:26.000617,epoch time: 0:02:21.758353,used: 0:16:33.733431,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_02_11_51_seed_2_23090485
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9829843, 'precision': 0.9830449, 'recall': 0.9830449, 'specificity': 0.9830449, 'f1': 0.9829843, 'auroc': 0.9981508, 'binary_precision': 0.99076515, 'binary_recall': 0.9753247, 'binary_specificity': 0.99076515, 'binary_f1_score': 0.9829843}
confusion matrix:
      0     1
0  1502    14
1    38  1502
---- Validation: 
scalar performance:
{'acc': 0.8208138, 'precision': 0.84032536, 'recall': 0.81758296, 'specificity': 0.81758296, 'f1': 0.8170628, 'auroc': 0.90132636, 'binary_precision': 0.9154334, 'binary_recall': 0.6961415, 'binary_specificity': 0.9390244, 'binary_f1_score': 0.79086757}
confusion matrix:
     0    1
0  616   40
1  189  433
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8078704, 'precision': 0.83852607, 'recall': 0.8078704, 'specificity': 0.8078704, 'f1': 0.80341995, 'auroc': 0.90682864, 'binary_precision': 0.9403973, 'binary_recall': 0.6574074, 'binary_specificity': 0.9583333, 'binary_f1_score': 0.7738419}
confusion matrix:
     0    1
0  207    9
1   74  142
early stop counter: 1
val acc:0.820813775062561, best validation acc: 0.8482003211975098, corresponding to test acc:                         0.8449074029922485 / 0.8449074029922485
after epoch: 8,now: 2024-07-27 02:30:46.408409,epoch time: 0:02:20.407792,used: 0:18:54.141223,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_02_11_51_seed_2_23090485
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9820026, 'precision': 0.98203075, 'recall': 0.9820503, 'specificity': 0.9820503, 'f1': 0.98200256, 'auroc': 0.9985852, 'binary_precision': 0.9881657, 'binary_recall': 0.975974, 'binary_specificity': 0.98812664, 'binary_f1_score': 0.982032}
confusion matrix:
      0     1
0  1498    18
1    37  1503
---- Validation: 
scalar performance:
{'acc': 0.7918623, 'precision': 0.79198426, 'recall': 0.79217315, 'specificity': 0.79217315, 'f1': 0.7918439, 'auroc': 0.88248956, 'binary_precision': 0.7763975, 'binary_recall': 0.8038585, 'binary_specificity': 0.7804878, 'binary_f1_score': 0.7898894}
confusion matrix:
     0    1
0  512  144
1  122  500
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7847222, 'precision': 0.83131313, 'recall': 0.7847222, 'specificity': 0.7847222, 'f1': 0.7768781, 'auroc': 0.892061, 'binary_precision': 0.95555556, 'binary_recall': 0.5972222, 'binary_specificity': 0.9722222, 'binary_f1_score': 0.73504275}
confusion matrix:
     0    1
0  210    6
1   87  129
early stop counter: 2
val acc:0.7918623089790344, best validation acc: 0.8482003211975098, corresponding to test acc:                         0.8449074029922485 / 0.8449074029922485
after epoch: 9,now: 2024-07-27 02:33:06.548745,epoch time: 0:02:20.140336,used: 0:21:14.281559,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_02_11_51_seed_2_23090485
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9849476, 'precision': 0.9851048, 'recall': 0.9850341, 'specificity': 0.9850341, 'f1': 0.98494744, 'auroc': 0.99849826, 'binary_precision': 0.99601597, 'binary_recall': 0.97402596, 'binary_specificity': 0.9960422, 'binary_f1_score': 0.9848982}
confusion matrix:
      0     1
0  1510     6
1    40  1500
---- Validation: 
scalar performance:
{'acc': 0.65336466, 'precision': 0.7528671, 'recall': 0.6447656, 'specificity': 0.6447656, 'f1': 0.6079426, 'auroc': 0.8332876, 'binary_precision': 0.9049774, 'binary_recall': 0.3215434, 'binary_specificity': 0.9679878, 'binary_f1_score': 0.47449583}
confusion matrix:
     0    1
0  635   21
1  422  200
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5694444, 'precision': 0.6897844, 'recall': 0.5694444, 'specificity': 0.5694444, 'f1': 0.48833418, 'auroc': 0.8610897, 'binary_precision': 0.84090906, 'binary_recall': 0.1712963, 'binary_specificity': 0.9675926, 'binary_f1_score': 0.28461537}
confusion matrix:
     0   1
0  209   7
1  179  37
early stop counter: 3
val acc:0.6533646583557129, best validation acc: 0.8482003211975098, corresponding to test acc:                         0.8449074029922485 / 0.8449074029922485
after epoch: 10,now: 2024-07-27 02:35:26.753641,epoch time: 0:02:20.204896,used: 0:23:34.486455,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_02_11_51_seed_2_23090485
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.976767, 'precision': 0.97751296, 'recall': 0.97662425, 'specificity': 0.97662425, 'f1': 0.97675145, 'auroc': 0.9992182, 'binary_precision': 0.96050155, 'binary_recall': 0.9948052, 'binary_specificity': 0.9584433, 'binary_f1_score': 0.97735244}
confusion matrix:
      0     1
0  1453    63
1     8  1532
---- Validation: 
scalar performance:
{'acc': 0.82159626, 'precision': 0.8221781, 'recall': 0.8221781, 'specificity': 0.8221781, 'f1': 0.82159626, 'auroc': 0.88428605, 'binary_precision': 0.8003049, 'binary_recall': 0.8440514, 'binary_specificity': 0.8003049, 'binary_f1_score': 0.82159626}
confusion matrix:
     0    1
0  525  131
1   97  525
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8564815, 'precision': 0.85697114, 'recall': 0.8564815, 'specificity': 0.8564815, 'f1': 0.85643226, 'auroc': 0.91452336, 'binary_precision': 0.8701923, 'binary_recall': 0.837963, 'binary_specificity': 0.875, 'binary_f1_score': 0.8537736}
confusion matrix:
     0    1
0  189   27
1   35  181
new oracle model saved
early stop counter: 4
val acc:0.8215962648391724, best validation acc: 0.8482003211975098, corresponding to test acc:                         0.8449074029922485 / 0.8564814925193787
after epoch: 11,now: 2024-07-27 02:37:47.980340,epoch time: 0:02:21.226699,used: 0:25:55.713154,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_02_11_51_seed_2_23090485
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.98363876, 'precision': 0.9837687, 'recall': 0.9835863, 'specificity': 0.9835863, 'f1': 0.98363537, 'auroc': 0.99874115, 'binary_precision': 0.9775641, 'binary_recall': 0.99025977, 'binary_specificity': 0.9769129, 'binary_f1_score': 0.983871}
confusion matrix:
      0     1
0  1481    35
1    15  1525
---- Validation: 
scalar performance:
{'acc': 0.8450704, 'precision': 0.84557307, 'recall': 0.8456273, 'specificity': 0.8456273, 'f1': 0.84507, 'auroc': 0.9035468, 'binary_precision': 0.824159, 'binary_recall': 0.8665595, 'binary_specificity': 0.8246951, 'binary_f1_score': 0.8448276}
confusion matrix:
     0    1
0  541  115
1   83  539
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8217593, 'precision': 0.82176614, 'recall': 0.8217592, 'specificity': 0.8217592, 'f1': 0.82175833, 'auroc': 0.9110725, 'binary_precision': 0.82325584, 'binary_recall': 0.8194444, 'binary_specificity': 0.8240741, 'binary_f1_score': 0.82134575}
confusion matrix:
     0    1
0  178   38
1   39  177
early stop counter: 5
val acc:0.8450704216957092, best validation acc: 0.8482003211975098, corresponding to test acc:                         0.8449074029922485 / 0.8564814925193787
after epoch: 12,now: 2024-07-27 02:40:08.472234,epoch time: 0:02:20.491894,used: 0:28:16.205048,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_02_11_51_seed_2_23090485
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 12 with time: 0:28:16.205048 at 2024-07-27 02:40:08.472234
persisted model performance metric: 

scalar performance:
{'acc': 0.8449074, 'precision': 0.8449739, 'recall': 0.8449074, 'specificity': 0.8449074, 'f1': 0.8449, 'auroc': 0.93389916, 'binary_precision': 0.84018266, 'binary_recall': 0.8518519, 'binary_specificity': 0.837963, 'binary_f1_score': 0.84597707}
confusion matrix:
     0    1
0  181   35
1   32  184
oracle model performance metric: 

scalar performance:
{'acc': 0.8564815, 'precision': 0.85697114, 'recall': 0.8564815, 'specificity': 0.8564815, 'f1': 0.85643226, 'auroc': 0.91452336, 'binary_precision': 0.8701923, 'binary_recall': 0.837963, 'binary_specificity': 0.875, 'binary_f1_score': 0.8537736}
confusion matrix:
     0    1
0  189   27
1   35  181
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_diva_irm_3seeds_nofreeze_2024-07-27_01-18-02/rule_results/5.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_diva_irm_3seeds_nofreeze_2024-07-27_01-18-02/confusion_matrix/5.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   2803 MiB |   9163 MiB | 199774 GiB | 199771 GiB |
|       from large pool |   2712 MiB |   9087 MiB | 197895 GiB | 197893 GiB |
|       from small pool |     91 MiB |    132 MiB |   1878 GiB |   1878 GiB |
|---------------------------------------------------------------------------|
| Active memory         |   2803 MiB |   9163 MiB | 199774 GiB | 199771 GiB |
|       from large pool |   2712 MiB |   9087 MiB | 197895 GiB | 197893 GiB |
|       from small pool |     91 MiB |    132 MiB |   1878 GiB |   1878 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |   2779 MiB |   9143 MiB | 199486 GiB | 199484 GiB |
|       from large pool |   2687 MiB |   9068 MiB | 197611 GiB | 197608 GiB |
|       from small pool |     91 MiB |    132 MiB |   1875 GiB |   1875 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   9592 MiB |   9726 MiB |  20464 MiB |  10872 MiB |
|       from large pool |   9456 MiB |   9592 MiB |  20260 MiB |  10804 MiB |
|       from small pool |    136 MiB |    140 MiB |    204 MiB |     68 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |   2356 MiB |   3151 MiB | 184556 GiB | 184553 GiB |
|       from large pool |   2343 MiB |   3146 MiB | 182623 GiB | 182621 GiB |
|       from small pool |     12 MiB |     54 MiB |   1932 GiB |   1932 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    2464    |    3329    |   30362 K  |   30360 K  |
|       from large pool |     392    |     816    |   15175 K  |   15174 K  |
|       from small pool |    2072    |    2780    |   15187 K  |   15185 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    2464    |    3329    |   30362 K  |   30360 K  |
|       from large pool |     392    |     816    |   15175 K  |   15174 K  |
|       from small pool |    2072    |    2780    |   15187 K  |   15185 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     197    |     266    |     431    |     234    |
|       from large pool |     129    |     199    |     329    |     200    |
|       from small pool |      68    |      70    |     102    |      34    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     151    |     307    |   15684 K  |   15683 K  |
|       from large pool |      79    |     182    |    8022 K  |    8022 K  |
|       from small pool |      72    |     228    |    7661 K  |    7661 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   9163 MiB | 199774 GiB | 199773 GiB |
|       from large pool |  16640 KiB |   9087 MiB | 197895 GiB | 197895 GiB |
|       from small pool |      0 KiB |    132 MiB |   1878 GiB |   1878 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   9163 MiB | 199774 GiB | 199773 GiB |
|       from large pool |  16640 KiB |   9087 MiB | 197895 GiB | 197895 GiB |
|       from small pool |      0 KiB |    132 MiB |   1878 GiB |   1878 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   9143 MiB | 199486 GiB | 199486 GiB |
|       from large pool |  16640 KiB |   9068 MiB | 197611 GiB | 197611 GiB |
|       from small pool |      0 KiB |    132 MiB |   1875 GiB |   1875 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   5160 MiB |   9726 MiB |  20464 MiB |  15304 MiB |
|       from large pool |   5056 MiB |   9592 MiB |  20260 MiB |  15204 MiB |
|       from small pool |    104 MiB |    140 MiB |    204 MiB |    100 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   3151 MiB | 184557 GiB | 184557 GiB |
|       from large pool |  24320 KiB |   3146 MiB | 182624 GiB | 182624 GiB |
|       from small pool |      0 KiB |     56 MiB |   1932 GiB |   1932 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3329    |   30362 K  |   30362 K  |
|       from large pool |       2    |     816    |   15175 K  |   15175 K  |
|       from small pool |       0    |    2780    |   15187 K  |   15187 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3329    |   30362 K  |   30362 K  |
|       from large pool |       2    |     816    |   15175 K  |   15175 K  |
|       from small pool |       0    |    2780    |   15187 K  |   15187 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     139    |     266    |     431    |     292    |
|       from large pool |      87    |     199    |     329    |     242    |
|       from small pool |      52    |      70    |     102    |      50    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     307    |   15684 K  |   15684 K  |
|       from large pool |       3    |     182    |    8022 K  |    8022 K  |
|       from small pool |       0    |     228    |    7662 K  |    7662 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Sat Jul 27 02:40:16 2024]
Finished job 0.
1 of 1 steps (100%) done
