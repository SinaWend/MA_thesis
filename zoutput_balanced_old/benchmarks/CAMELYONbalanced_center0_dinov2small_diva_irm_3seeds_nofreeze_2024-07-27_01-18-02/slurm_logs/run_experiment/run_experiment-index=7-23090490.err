Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Sat Jul 27 02:04:19 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_diva_irm_3seeds_nofreeze_2024-07-27_01-18-02/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_diva_irm_3seeds_nofreeze_2024-07-27_01-18-02/rule_results/7.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=7
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/swiglu_ffn.py:51: UserWarning: xFormers is not available (SwiGLU)
  warnings.warn("xFormers is not available (SwiGLU)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/attention.py:33: UserWarning: xFormers is not available (Attention)
  warnings.warn("xFormers is not available (Attention)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/block.py:40: UserWarning: xFormers is not available (Block)
  warnings.warn("xFormers is not available (Block)")
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/init.py:452: UserWarning: Initializing zero-element tensors is a no-op
  warnings.warn("Initializing zero-element tensors is a no-op")
Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main

using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_02_05_02_seed_0_23090490

 Experiment start at: 2024-07-27 02:05:03.504337
hyper-parameter scheduler not set,going to use default Warmpup and epoch update
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
before training, model accuracy: 0.46279069781303406
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/autograd/graph.py:744: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9641927, 'precision': 0.96552074, 'recall': 0.9645766, 'specificity': 0.9645766, 'f1': 0.96418244, 'auroc': 0.99531436, 'binary_precision': 0.99385244, 'binary_recall': 0.93508995, 'binary_specificity': 0.9940633, 'binary_f1_score': 0.96357614}
confusion matrix:
      0     1
0  1507     9
1   101  1455
---- Validation: 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
scalar performance:
{'acc': 0.8090062, 'precision': 0.8101482, 'recall': 0.80855656, 'specificity': 0.80855656, 'f1': 0.80864453, 'auroc': 0.8733429, 'binary_precision': 0.82579565, 'binary_recall': 0.776378, 'binary_specificity': 0.8407351, 'binary_f1_score': 0.80032474}
confusion matrix:
     0    1
0  549  104
1  142  493
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8372093, 'precision': 0.8376768, 'recall': 0.83720934, 'specificity': 0.83720934, 'f1': 0.83715296, 'auroc': 0.92326665, 'binary_precision': 0.8251121, 'binary_recall': 0.855814, 'binary_specificity': 0.81860465, 'binary_f1_score': 0.84018266}
confusion matrix:
     0    1
0  176   39
1   31  184
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-27 02:07:27.615639,epoch time: 0:02:24.111302,used: 0:02:24.111302,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_02_05_02_seed_0_23090490
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.95996094, 'precision': 0.96236575, 'recall': 0.9604921, 'specificity': 0.9604921, 'f1': 0.9599345, 'auroc': 0.99626815, 'binary_precision': 0.99930364, 'binary_recall': 0.9216442, 'binary_specificity': 0.99933994, 'binary_f1_score': 0.95890415}
confusion matrix:
      0     1
0  1514     1
1   122  1435
---- Validation: 
scalar performance:
{'acc': 0.52018636, 'precision': 0.6769279, 'recall': 0.5134727, 'specificity': 0.5134727, 'f1': 0.3705447, 'auroc': 0.7892561, 'binary_precision': 0.84, 'binary_recall': 0.033070866, 'binary_specificity': 0.99387443, 'binary_f1_score': 0.06363636}
confusion matrix:
     0   1
0  649   4
1  614  21
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5534884, 'precision': 0.76412773, 'recall': 0.5534884, 'specificity': 0.5534884, 'f1': 0.44229782, 'auroc': 0.8844565, 'binary_precision': 1.0, 'binary_recall': 0.10697675, 'binary_specificity': 1.0, 'binary_f1_score': 0.19327731}
confusion matrix:
     0   1
0  215   0
1  192  23
early stop counter: 1
val acc:0.5201863646507263, best validation acc: 0.8090062141418457, corresponding to test acc:                         0.8372092843055725 / 0.8372092843055725
after epoch: 2,now: 2024-07-27 02:09:46.637765,epoch time: 0:02:19.022126,used: 0:04:43.133428,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_02_05_02_seed_0_23090490
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9703776, 'precision': 0.97048604, 'recall': 0.970521, 'specificity': 0.970521, 'f1': 0.97037756, 'auroc': 0.9971228, 'binary_precision': 0.98159105, 'binary_recall': 0.9595116, 'binary_specificity': 0.98153037, 'binary_f1_score': 0.9704257}
confusion matrix:
      0     1
0  1488    28
1    63  1493
---- Validation: 
scalar performance:
{'acc': 0.75, 'precision': 0.7513449, 'recall': 0.75047207, 'specificity': 0.75047207, 'f1': 0.74986434, 'auroc': 0.7963994, 'binary_precision': 0.72913617, 'binary_recall': 0.784252, 'binary_specificity': 0.7166922, 'binary_f1_score': 0.7556905}
confusion matrix:
     0    1
0  468  185
1  137  498
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7744186, 'precision': 0.77881575, 'recall': 0.7744186, 'specificity': 0.7744186, 'f1': 0.7735257, 'auroc': 0.8287939, 'binary_precision': 0.74380165, 'binary_recall': 0.8372093, 'binary_specificity': 0.7116279, 'binary_f1_score': 0.7877462}
confusion matrix:
     0    1
0  153   62
1   35  180
early stop counter: 2
val acc:0.75, best validation acc: 0.8090062141418457, corresponding to test acc:                         0.8372092843055725 / 0.8372092843055725
after epoch: 3,now: 2024-07-27 02:12:05.652185,epoch time: 0:02:19.014420,used: 0:07:02.147848,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_02_05_02_seed_0_23090490
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9716797, 'precision': 0.9719785, 'recall': 0.97155046, 'specificity': 0.97155046, 'f1': 0.9716654, 'auroc': 0.9975836, 'binary_precision': 0.9627995, 'binary_recall': 0.98199356, 'binary_specificity': 0.96110743, 'binary_f1_score': 0.97230184}
confusion matrix:
      0     1
0  1458    59
1    28  1527
---- Validation: 
scalar performance:
{'acc': 0.7624224, 'precision': 0.77303624, 'recall': 0.7637651, 'specificity': 0.7637651, 'f1': 0.76067674, 'auroc': 0.83897936, 'binary_precision': 0.7155963, 'binary_recall': 0.85984254, 'binary_specificity': 0.6676876, 'binary_f1_score': 0.7811159}
confusion matrix:
     0    1
0  436  217
1   89  546
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7930232, 'precision': 0.801, 'recall': 0.7930232, 'specificity': 0.7930232, 'f1': 0.7916429, 'auroc': 0.8840887, 'binary_precision': 0.752, 'binary_recall': 0.8744186, 'binary_specificity': 0.7116279, 'binary_f1_score': 0.80860215}
confusion matrix:
     0    1
0  153   62
1   27  188
early stop counter: 3
val acc:0.7624223828315735, best validation acc: 0.8090062141418457, corresponding to test acc:                         0.8372092843055725 / 0.8372092843055725
after epoch: 4,now: 2024-07-27 02:14:24.184556,epoch time: 0:02:18.532371,used: 0:09:20.680219,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_02_05_02_seed_0_23090490
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9765625, 'precision': 0.9772007, 'recall': 0.9763656, 'specificity': 0.9763656, 'f1': 0.97654414, 'auroc': 0.99884146, 'binary_precision': 0.9625702, 'binary_recall': 0.992283, 'binary_specificity': 0.96044827, 'binary_f1_score': 0.9772008}
confusion matrix:
      0     1
0  1457    60
1    12  1543
---- Validation: 
scalar performance:
{'acc': 0.8136646, 'precision': 0.81880224, 'recall': 0.8145398, 'specificity': 0.8145398, 'f1': 0.81317407, 'auroc': 0.8946112, 'binary_precision': 0.77468705, 'binary_recall': 0.8771654, 'binary_specificity': 0.75191426, 'binary_f1_score': 0.82274747}
confusion matrix:
     0    1
0  491  162
1   78  557
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.76744187, 'precision': 0.7991531, 'recall': 0.76744187, 'specificity': 0.76744187, 'f1': 0.76111114, 'auroc': 0.92538667, 'binary_precision': 0.7017544, 'binary_recall': 0.9302326, 'binary_specificity': 0.60465115, 'binary_f1_score': 0.8}
confusion matrix:
     0    1
0  130   85
1   15  200
better model found
persisted
after epoch: 5,now: 2024-07-27 02:16:43.773191,epoch time: 0:02:19.588635,used: 0:11:40.268854,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_02_05_02_seed_0_23090490
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.98502606, 'precision': 0.9850416, 'recall': 0.9850087, 'specificity': 0.9850087, 'f1': 0.9850235, 'auroc': 0.9990827, 'binary_precision': 0.9839538, 'binary_recall': 0.9864865, 'binary_specificity': 0.98353094, 'binary_f1_score': 0.9852185}
confusion matrix:
      0     1
0  1493    25
1    21  1533
---- Validation: 
scalar performance:
{'acc': 0.81444097, 'precision': 0.8229836, 'recall': 0.81556594, 'specificity': 0.81556594, 'f1': 0.8135507, 'auroc': 0.90481484, 'binary_precision': 0.76684636, 'binary_recall': 0.89606297, 'binary_specificity': 0.7350689, 'binary_f1_score': 0.82643425}
confusion matrix:
     0    1
0  480  173
1   66  569
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7976744, 'precision': 0.8048564, 'recall': 0.7976744, 'specificity': 0.7976744, 'f1': 0.7964757, 'auroc': 0.9103948, 'binary_precision': 0.7580645, 'binary_recall': 0.8744186, 'binary_specificity': 0.7209302, 'binary_f1_score': 0.812095}
confusion matrix:
     0    1
0  155   60
1   27  188
better model found
persisted
after epoch: 6,now: 2024-07-27 02:19:03.410516,epoch time: 0:02:19.637325,used: 0:13:59.906179,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_02_05_02_seed_0_23090490
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.96451825, 'precision': 0.9663832, 'recall': 0.9649658, 'specificity': 0.9649658, 'f1': 0.9645013, 'auroc': 0.9984094, 'binary_precision': 0.9993099, 'binary_recall': 0.9305913, 'binary_specificity': 0.99934036, 'binary_f1_score': 0.9637272}
confusion matrix:
      0     1
0  1515     1
1   108  1448
---- Validation: 
scalar performance:
{'acc': 0.63975155, 'precision': 0.760314, 'recall': 0.6349278, 'specificity': 0.6349278, 'f1': 0.5881263, 'auroc': 0.90231395, 'binary_precision': 0.93401015, 'binary_recall': 0.28976378, 'binary_specificity': 0.98009187, 'binary_f1_score': 0.44230768}
confusion matrix:
     0    1
0  640   13
1  451  184
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.727907, 'precision': 0.81073034, 'recall': 0.72790694, 'specificity': 0.72790694, 'f1': 0.7084814, 'auroc': 0.9194808, 'binary_precision': 0.97115386, 'binary_recall': 0.46976745, 'binary_specificity': 0.9860465, 'binary_f1_score': 0.6332289}
confusion matrix:
     0    1
0  212    3
1  114  101
early stop counter: 1
val acc:0.6397515535354614, best validation acc: 0.8144409656524658, corresponding to test acc:                         0.7976744174957275 / 0.8372092843055725
after epoch: 7,now: 2024-07-27 02:21:22.025978,epoch time: 0:02:18.615462,used: 0:16:18.521641,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_02_05_02_seed_0_23090490
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9091797, 'precision': 0.922518, 'recall': 0.9080409, 'specificity': 0.9080409, 'f1': 0.90827554, 'auroc': 0.9972453, 'binary_precision': 0.85063154, 'binary_recall': 0.9955013, 'binary_specificity': 0.8205805, 'binary_f1_score': 0.91738236}
confusion matrix:
      0     1
0  1244   272
1     7  1549
---- Validation: 
scalar performance:
{'acc': 0.83540374, 'precision': 0.8411157, 'recall': 0.8363049, 'specificity': 0.8363049, 'f1': 0.83494365, 'auroc': 0.9161279, 'binary_precision': 0.7933426, 'binary_recall': 0.9007874, 'binary_specificity': 0.77182233, 'binary_f1_score': 0.8436579}
confusion matrix:
     0    1
0  504  149
1   63  572
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.86744183, 'precision': 0.87744445, 'recall': 0.8674419, 'specificity': 0.8674419, 'f1': 0.8665578, 'auroc': 0.94193614, 'binary_precision': 0.9388889, 'binary_recall': 0.7860465, 'binary_specificity': 0.9488372, 'binary_f1_score': 0.8556962}
confusion matrix:
     0    1
0  204   11
1   46  169
new oracle model saved
better model found
persisted
after epoch: 8,now: 2024-07-27 02:23:42.608490,epoch time: 0:02:20.582512,used: 0:18:39.104153,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_02_05_02_seed_0_23090490
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.98795575, 'precision': 0.98797905, 'recall': 0.9879325, 'specificity': 0.9879325, 'f1': 0.9879532, 'auroc': 0.99941623, 'binary_precision': 0.9865471, 'binary_recall': 0.98971725, 'binary_specificity': 0.98614776, 'binary_f1_score': 0.9881297}
confusion matrix:
      0     1
0  1495    21
1    16  1540
---- Validation: 
scalar performance:
{'acc': 0.76319873, 'precision': 0.8157742, 'recall': 0.76032007, 'specificity': 0.76032007, 'f1': 0.75154054, 'auroc': 0.91859496, 'binary_precision': 0.9411765, 'binary_recall': 0.5543307, 'binary_specificity': 0.96630937, 'binary_f1_score': 0.6977205}
confusion matrix:
     0    1
0  631   22
1  283  352
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7906977, 'precision': 0.84018123, 'recall': 0.7906977, 'specificity': 0.7906977, 'f1': 0.782799, 'auroc': 0.9171228, 'binary_precision': 0.9699248, 'binary_recall': 0.6, 'binary_specificity': 0.98139536, 'binary_f1_score': 0.7413793}
confusion matrix:
     0    1
0  211    4
1   86  129
early stop counter: 1
val acc:0.763198733329773, best validation acc: 0.8354037404060364, corresponding to test acc:                         0.8674418330192566 / 0.8674418330192566
after epoch: 9,now: 2024-07-27 02:26:01.250760,epoch time: 0:02:18.642270,used: 0:20:57.746423,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_02_05_02_seed_0_23090490
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9625651, 'precision': 0.9645606, 'recall': 0.9630522, 'specificity': 0.9630522, 'f1': 0.9625462, 'auroc': 0.99755, 'binary_precision': 0.9986169, 'binary_recall': 0.92742455, 'binary_specificity': 0.9986799, 'binary_f1_score': 0.96170497}
confusion matrix:
      0     1
0  1513     2
1   113  1444
---- Validation: 
scalar performance:
{'acc': 0.55201864, 'precision': 0.74208534, 'recall': 0.5457344, 'specificity': 0.5457344, 'f1': 0.43356478, 'auroc': 0.8817475, 'binary_precision': 0.953125, 'binary_recall': 0.096062995, 'binary_specificity': 0.9954058, 'binary_f1_score': 0.17453505}
confusion matrix:
     0   1
0  650   3
1  574  61
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.51860464, 'precision': 0.70476186, 'recall': 0.51860464, 'specificity': 0.51860464, 'f1': 0.37700787, 'auroc': 0.8925257, 'binary_precision': 0.9, 'binary_recall': 0.041860465, 'binary_specificity': 0.9953488, 'binary_f1_score': 0.08}
confusion matrix:
     0  1
0  214  1
1  206  9
early stop counter: 2
val acc:0.5520186424255371, best validation acc: 0.8354037404060364, corresponding to test acc:                         0.8674418330192566 / 0.8674418330192566
after epoch: 10,now: 2024-07-27 02:28:20.061705,epoch time: 0:02:18.810945,used: 0:23:16.557368,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_02_05_02_seed_0_23090490
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9863281, 'precision': 0.98642635, 'recall': 0.9865006, 'specificity': 0.9865006, 'f1': 0.986328, 'auroc': 0.9990506, 'binary_precision': 0.9980302, 'binary_recall': 0.974984, 'binary_specificity': 0.9980172, 'binary_f1_score': 0.98637253}
confusion matrix:
      0     1
0  1510     3
1    39  1520
---- Validation: 
scalar performance:
{'acc': 0.7251553, 'precision': 0.8091233, 'recall': 0.7214769, 'specificity': 0.7214769, 'f1': 0.7029706, 'auroc': 0.9088471, 'binary_precision': 0.9667774, 'binary_recall': 0.45826772, 'binary_specificity': 0.9846861, 'binary_f1_score': 0.6217949}
confusion matrix:
     0    1
0  643   10
1  344  291
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.69302326, 'precision': 0.8042626, 'recall': 0.69302326, 'specificity': 0.69302326, 'f1': 0.6621429, 'auroc': 0.9453326, 'binary_precision': 0.9882353, 'binary_recall': 0.3906977, 'binary_specificity': 0.9953488, 'binary_f1_score': 0.56}
confusion matrix:
     0   1
0  214   1
1  131  84
early stop counter: 3
val acc:0.7251552939414978, best validation acc: 0.8354037404060364, corresponding to test acc:                         0.8674418330192566 / 0.8674418330192566
after epoch: 11,now: 2024-07-27 02:30:39.219364,epoch time: 0:02:19.157659,used: 0:25:35.715027,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_02_05_02_seed_0_23090490
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9876302, 'precision': 0.9876187, 'recall': 0.987708, 'specificity': 0.987708, 'f1': 0.9876294, 'auroc': 0.99941206, 'binary_precision': 0.99350226, 'binary_recall': 0.9820167, 'binary_specificity': 0.9933993, 'binary_f1_score': 0.98772603}
confusion matrix:
      0     1
0  1505    10
1    28  1529
---- Validation: 
scalar performance:
{'acc': 0.7880435, 'precision': 0.8233971, 'recall': 0.78571224, 'specificity': 0.78571224, 'f1': 0.7811246, 'auroc': 0.91430223, 'binary_precision': 0.9268868, 'binary_recall': 0.6188976, 'binary_specificity': 0.9525268, 'binary_f1_score': 0.7422096}
confusion matrix:
     0    1
0  622   31
1  242  393
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.83488375, 'precision': 0.86020106, 'recall': 0.8348837, 'specificity': 0.8348837, 'f1': 0.8319305, 'auroc': 0.9211465, 'binary_precision': 0.9556962, 'binary_recall': 0.7023256, 'binary_specificity': 0.96744186, 'binary_f1_score': 0.8096515}
confusion matrix:
     0    1
0  208    7
1   64  151
early stop counter: 4
val acc:0.7880434989929199, best validation acc: 0.8354037404060364, corresponding to test acc:                         0.8674418330192566 / 0.8674418330192566
after epoch: 12,now: 2024-07-27 02:32:58.283619,epoch time: 0:02:19.064255,used: 0:27:54.779282,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_02_05_02_seed_0_23090490
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.96028644, 'precision': 0.96258485, 'recall': 0.9607799, 'specificity': 0.9607799, 'f1': 0.96026087, 'auroc': 0.99745804, 'binary_precision': 0.9986092, 'binary_recall': 0.92287916, 'binary_specificity': 0.9986807, 'binary_f1_score': 0.9592519}
confusion matrix:
      0     1
0  1514     2
1   120  1436
---- Validation: 
scalar performance:
{'acc': 0.7336956, 'precision': 0.78442395, 'recall': 0.73070264, 'specificity': 0.73070264, 'f1': 0.71957755, 'auroc': 0.88719773, 'binary_precision': 0.9010989, 'binary_recall': 0.51653546, 'binary_specificity': 0.9448698, 'binary_f1_score': 0.6566567}
confusion matrix:
     0    1
0  617   36
1  307  328
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.855814, 'precision': 0.8744792, 'recall': 0.855814, 'specificity': 0.855814, 'f1': 0.8539946, 'auroc': 0.9191346, 'binary_precision': 0.9580838, 'binary_recall': 0.74418604, 'binary_specificity': 0.96744186, 'binary_f1_score': 0.8376964}
confusion matrix:
     0    1
0  208    7
1   55  160
early stop counter: 5
val acc:0.7336956262588501, best validation acc: 0.8354037404060364, corresponding to test acc:                         0.8674418330192566 / 0.8674418330192566
after epoch: 13,now: 2024-07-27 02:35:16.869840,epoch time: 0:02:18.586221,used: 0:30:13.365503,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_02_05_02_seed_0_23090490
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 13 with time: 0:30:13.365503 at 2024-07-27 02:35:16.869840
persisted model performance metric: 

scalar performance:
{'acc': 0.86744183, 'precision': 0.87744445, 'recall': 0.8674419, 'specificity': 0.8674419, 'f1': 0.8665578, 'auroc': 0.94193614, 'binary_precision': 0.9388889, 'binary_recall': 0.7860465, 'binary_specificity': 0.9488372, 'binary_f1_score': 0.8556962}
confusion matrix:
     0    1
0  204   11
1   46  169
oracle model performance metric: 

scalar performance:
{'acc': 0.86744183, 'precision': 0.87744445, 'recall': 0.8674419, 'specificity': 0.8674419, 'f1': 0.8665578, 'auroc': 0.94193614, 'binary_precision': 0.9388889, 'binary_recall': 0.7860465, 'binary_specificity': 0.9488372, 'binary_f1_score': 0.8556962}
confusion matrix:
     0    1
0  204   11
1   46  169
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_diva_irm_3seeds_nofreeze_2024-07-27_01-18-02/rule_results/7.csv
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_diva_irm_3seeds_nofreeze_2024-07-27_01-18-02/rule_results/7.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_diva_irm_3seeds_nofreeze_2024-07-27_01-18-02/confusion_matrix/7.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   1983 MiB |   8504 MiB |  80419 GiB |  80417 GiB |
|       from large pool |   1892 MiB |   8428 MiB |  79663 GiB |  79661 GiB |
|       from small pool |     91 MiB |    129 MiB |    756 GiB |    756 GiB |
|---------------------------------------------------------------------------|
| Active memory         |   1983 MiB |   8504 MiB |  80419 GiB |  80417 GiB |
|       from large pool |   1892 MiB |   8428 MiB |  79663 GiB |  79661 GiB |
|       from small pool |     91 MiB |    129 MiB |    756 GiB |    756 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |   1972 MiB |   8498 MiB |  80341 GiB |  80339 GiB |
|       from large pool |   1881 MiB |   8422 MiB |  79586 GiB |  79584 GiB |
|       from small pool |     91 MiB |    128 MiB |    755 GiB |    755 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   9132 MiB |   9132 MiB |   9132 MiB |      0 B   |
|       from large pool |   8998 MiB |   8998 MiB |   8998 MiB |      0 B   |
|       from small pool |    134 MiB |    134 MiB |    134 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |   1060 MiB |   2037 MiB |  67113 GiB |  67112 GiB |
|       from large pool |   1051 MiB |   2031 MiB |  66335 GiB |  66334 GiB |
|       from small pool |      8 MiB |     22 MiB |    777 GiB |    777 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    2444    |    3289    |   12159 K  |   12157 K  |
|       from large pool |     382    |     808    |    6161 K  |    6161 K  |
|       from small pool |    2062    |    2754    |    5997 K  |    5995 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    2444    |    3289    |   12159 K  |   12157 K  |
|       from large pool |     382    |     808    |    6161 K  |    6161 K  |
|       from small pool |    2062    |    2754    |    5997 K  |    5995 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     265    |     265    |     265    |       0    |
|       from large pool |     198    |     198    |     198    |       0    |
|       from small pool |      67    |      67    |      67    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     140    |     300    |    6409 K  |    6409 K  |
|       from large pool |      73    |     192    |    3621 K  |    3621 K  |
|       from small pool |      67    |     227    |    2788 K  |    2788 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   8504 MiB |  80419 GiB |  80419 GiB |
|       from large pool |  16640 KiB |   8428 MiB |  79663 GiB |  79663 GiB |
|       from small pool |      0 KiB |    129 MiB |    756 GiB |    756 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   8504 MiB |  80419 GiB |  80419 GiB |
|       from large pool |  16640 KiB |   8428 MiB |  79663 GiB |  79663 GiB |
|       from small pool |      0 KiB |    129 MiB |    756 GiB |    756 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   8498 MiB |  80341 GiB |  80341 GiB |
|       from large pool |  16640 KiB |   8422 MiB |  79586 GiB |  79586 GiB |
|       from small pool |      0 KiB |    128 MiB |    755 GiB |    755 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   3044 MiB |   9132 MiB |   9132 MiB |   6088 MiB |
|       from large pool |   2944 MiB |   8998 MiB |   8998 MiB |   6054 MiB |
|       from small pool |    100 MiB |    134 MiB |    134 MiB |     34 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   2037 MiB |  67114 GiB |  67114 GiB |
|       from large pool |  24320 KiB |   2031 MiB |  66336 GiB |  66336 GiB |
|       from small pool |      0 KiB |     50 MiB |    777 GiB |    777 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3289    |   12159 K  |   12159 K  |
|       from large pool |       2    |     808    |    6161 K  |    6161 K  |
|       from small pool |       0    |    2754    |    5997 K  |    5997 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3289    |   12159 K  |   12159 K  |
|       from large pool |       2    |     808    |    6161 K  |    6161 K  |
|       from small pool |       0    |    2754    |    5997 K  |    5997 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     120    |     265    |     265    |     145    |
|       from large pool |      70    |     198    |     198    |     128    |
|       from small pool |      50    |      67    |      67    |      17    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |     300    |    6410 K  |    6410 K  |
|       from large pool |       4    |     192    |    3621 K  |    3621 K  |
|       from small pool |       0    |     227    |    2788 K  |    2788 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   8504 MiB |  80419 GiB |  80419 GiB |
|       from large pool |  16640 KiB |   8428 MiB |  79663 GiB |  79663 GiB |
|       from small pool |      0 KiB |    129 MiB |    756 GiB |    756 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   8504 MiB |  80419 GiB |  80419 GiB |
|       from large pool |  16640 KiB |   8428 MiB |  79663 GiB |  79663 GiB |
|       from small pool |      0 KiB |    129 MiB |    756 GiB |    756 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   8498 MiB |  80341 GiB |  80341 GiB |
|       from large pool |  16640 KiB |   8422 MiB |  79586 GiB |  79586 GiB |
|       from small pool |      0 KiB |    128 MiB |    755 GiB |    755 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   3044 MiB |   9132 MiB |   9132 MiB |   6088 MiB |
|       from large pool |   2944 MiB |   8998 MiB |   8998 MiB |   6054 MiB |
|       from small pool |    100 MiB |    134 MiB |    134 MiB |     34 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   2037 MiB |  67114 GiB |  67114 GiB |
|       from large pool |  24320 KiB |   2031 MiB |  66336 GiB |  66336 GiB |
|       from small pool |      0 KiB |     50 MiB |    777 GiB |    777 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3289    |   12159 K  |   12159 K  |
|       from large pool |       2    |     808    |    6161 K  |    6161 K  |
|       from small pool |       0    |    2754    |    5997 K  |    5997 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3289    |   12159 K  |   12159 K  |
|       from large pool |       2    |     808    |    6161 K  |    6161 K  |
|       from small pool |       0    |    2754    |    5997 K  |    5997 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     120    |     265    |     265    |     145    |
|       from large pool |      70    |     198    |     198    |     128    |
|       from small pool |      50    |      67    |      67    |      17    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |     300    |    6410 K  |    6410 K  |
|       from large pool |       4    |     192    |    3621 K  |    3621 K  |
|       from small pool |       0    |     227    |    2788 K  |    2788 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/init.py:452: UserWarning: Initializing zero-element tensors is a no-op
  warnings.warn("Initializing zero-element tensors is a no-op")
Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main

using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_02_35_54_seed_1_23090490

 Experiment start at: 2024-07-27 02:35:55.086144
hyper-parameter scheduler not set,going to use default Warmpup and epoch update
before training, model accuracy: 0.5666666626930237
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9453125, 'precision': 0.9491067, 'recall': 0.9459082, 'specificity': 0.9459082, 'f1': 0.9452397, 'auroc': 0.9917201, 'binary_precision': 0.9935943, 'binary_recall': 0.8977492, 'binary_specificity': 0.99406725, 'binary_f1_score': 0.94324327}
confusion matrix:
      0     1
0  1508     9
1   159  1396
---- Validation: 
scalar performance:
{'acc': 0.8087432, 'precision': 0.8089608, 'recall': 0.8084741, 'specificity': 0.8084741, 'f1': 0.8085747, 'auroc': 0.885134, 'binary_precision': 0.81402934, 'binary_recall': 0.7920635, 'binary_specificity': 0.8248848, 'binary_f1_score': 0.80289626}
confusion matrix:
     0    1
0  537  114
1  131  499
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.81333333, 'precision': 0.8134324, 'recall': 0.81333333, 'specificity': 0.81333333, 'f1': 0.8133186, 'auroc': 0.8724543, 'binary_precision': 0.81900454, 'binary_recall': 0.80444443, 'binary_specificity': 0.82222223, 'binary_f1_score': 0.8116592}
confusion matrix:
     0    1
0  185   40
1   44  181
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-27 02:38:18.441586,epoch time: 0:02:23.355442,used: 0:02:23.355442,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_02_35_54_seed_1_23090490
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.96972656, 'precision': 0.9699719, 'recall': 0.96960074, 'specificity': 0.96960074, 'f1': 0.9697113, 'auroc': 0.99675226, 'binary_precision': 0.9621212, 'binary_recall': 0.9788054, 'binary_specificity': 0.96039605, 'binary_f1_score': 0.97039163}
confusion matrix:
      0     1
0  1455    60
1    33  1524
---- Validation: 
scalar performance:
{'acc': 0.84387195, 'precision': 0.8446367, 'recall': 0.8442652, 'specificity': 0.8442652, 'f1': 0.8438559, 'auroc': 0.88953745, 'binary_precision': 0.8237952, 'binary_recall': 0.86825395, 'binary_specificity': 0.8202765, 'binary_f1_score': 0.8454405}
confusion matrix:
     0    1
0  534  117
1   83  547
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8511111, 'precision': 0.8519523, 'recall': 0.8511111, 'specificity': 0.8511111, 'f1': 0.8510221, 'auroc': 0.9202963, 'binary_precision': 0.86915886, 'binary_recall': 0.82666665, 'binary_specificity': 0.8755556, 'binary_f1_score': 0.8473804}
confusion matrix:
     0    1
0  197   28
1   39  186
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-07-27 02:40:38.290358,epoch time: 0:02:19.848772,used: 0:04:43.204214,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_02_35_54_seed_1_23090490
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9580078, 'precision': 0.96016526, 'recall': 0.9576107, 'specificity': 0.9576107, 'f1': 0.9579265, 'auroc': 0.99669933, 'binary_precision': 0.93159807, 'binary_recall': 0.9897106, 'binary_specificity': 0.9255109, 'binary_f1_score': 0.95977545}
confusion matrix:
      0     1
0  1404   113
1    16  1539
---- Validation: 
scalar performance:
{'acc': 0.80796254, 'precision': 0.81621456, 'recall': 0.80926776, 'specificity': 0.80926776, 'f1': 0.8071133, 'auroc': 0.87854826, 'binary_precision': 0.76086956, 'binary_recall': 0.8888889, 'binary_specificity': 0.7296467, 'binary_f1_score': 0.81991214}
confusion matrix:
     0    1
0  475  176
1   70  560
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.82666665, 'precision': 0.8275985, 'recall': 0.8266667, 'specificity': 0.8266667, 'f1': 0.8265433, 'auroc': 0.89864695, 'binary_precision': 0.8101266, 'binary_recall': 0.85333335, 'binary_specificity': 0.8, 'binary_f1_score': 0.8311688}
confusion matrix:
     0    1
0  180   45
1   33  192
early stop counter: 1
val acc:0.8079625368118286, best validation acc: 0.8438719511032104, corresponding to test acc:                         0.851111114025116 / 0.851111114025116
after epoch: 3,now: 2024-07-27 02:42:56.970939,epoch time: 0:02:18.680581,used: 0:07:01.884795,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_02_35_54_seed_1_23090490
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9798177, 'precision': 0.98004854, 'recall': 0.97970986, 'specificity': 0.97970986, 'f1': 0.979809, 'auroc': 0.99860907, 'binary_precision': 0.9721695, 'binary_recall': 0.9884244, 'binary_specificity': 0.97099537, 'binary_f1_score': 0.9802296}
confusion matrix:
      0     1
0  1473    44
1    18  1537
---- Validation: 
scalar performance:
{'acc': 0.85870415, 'precision': 0.85869074, 'recall': 0.8586278, 'specificity': 0.8586278, 'f1': 0.8586545, 'auroc': 0.9114841, 'binary_precision': 0.8580542, 'binary_recall': 0.85396826, 'binary_specificity': 0.86328727, 'binary_f1_score': 0.8560063}
confusion matrix:
     0    1
0  562   89
1   92  538
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8488889, 'precision': 0.84933054, 'recall': 0.8488889, 'specificity': 0.8488889, 'f1': 0.8488411, 'auroc': 0.9255506, 'binary_precision': 0.86175114, 'binary_recall': 0.83111113, 'binary_specificity': 0.8666667, 'binary_f1_score': 0.84615386}
confusion matrix:
     0    1
0  195   30
1   38  187
better model found
persisted
after epoch: 4,now: 2024-07-27 02:45:16.070432,epoch time: 0:02:19.099493,used: 0:09:20.984288,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_02_35_54_seed_1_23090490
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9472656, 'precision': 0.9517442, 'recall': 0.94661474, 'specificity': 0.94661474, 'f1': 0.9470716, 'auroc': 0.9978023, 'binary_precision': 0.9100529, 'binary_recall': 0.99421966, 'binary_specificity': 0.8990099, 'binary_f1_score': 0.95027626}
confusion matrix:
      0     1
0  1362   153
1     9  1548
---- Validation: 
scalar performance:
{'acc': 0.84074944, 'precision': 0.8451977, 'recall': 0.84167945, 'specificity': 0.84167945, 'f1': 0.8404553, 'auroc': 0.92065203, 'binary_precision': 0.8016997, 'binary_recall': 0.8984127, 'binary_specificity': 0.78494626, 'binary_f1_score': 0.8473054}
confusion matrix:
     0    1
0  511  140
1   64  566
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8377778, 'precision': 0.84020376, 'recall': 0.83777773, 'specificity': 0.83777773, 'f1': 0.83748806, 'auroc': 0.9278815, 'binary_precision': 0.8114754, 'binary_recall': 0.88, 'binary_specificity': 0.79555553, 'binary_f1_score': 0.8443497}
confusion matrix:
     0    1
0  179   46
1   27  198
early stop counter: 1
val acc:0.8407494425773621, best validation acc: 0.858704149723053, corresponding to test acc:                         0.8488888740539551 / 0.851111114025116
after epoch: 5,now: 2024-07-27 02:47:34.575587,epoch time: 0:02:18.505155,used: 0:11:39.489443,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_02_35_54_seed_1_23090490
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9319661, 'precision': 0.9320397, 'recall': 0.93189955, 'specificity': 0.93189955, 'f1': 0.9319474, 'auroc': 0.98425245, 'binary_precision': 0.92861694, 'binary_recall': 0.93758047, 'binary_specificity': 0.9262187, 'binary_f1_score': 0.9330772}
confusion matrix:
      0     1
0  1406   112
1    97  1457
---- Validation: 
scalar performance:
{'acc': 0.67837626, 'precision': 0.6834829, 'recall': 0.6796211, 'specificity': 0.6796211, 'f1': 0.6770203, 'auroc': 0.7861726, 'binary_precision': 0.64850134, 'binary_recall': 0.75555557, 'binary_specificity': 0.60368663, 'binary_f1_score': 0.6979472}
confusion matrix:
     0    1
0  393  258
1  154  476
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.64444447, 'precision': 0.73569703, 'recall': 0.64444447, 'specificity': 0.64444447, 'f1': 0.6063423, 'auroc': 0.87251353, 'binary_precision': 0.5890411, 'binary_recall': 0.95555556, 'binary_specificity': 0.33333334, 'binary_f1_score': 0.7288136}
confusion matrix:
    0    1
0  75  150
1  10  215
early stop counter: 2
val acc:0.6783762574195862, best validation acc: 0.858704149723053, corresponding to test acc:                         0.8488888740539551 / 0.851111114025116
after epoch: 6,now: 2024-07-27 02:49:52.957393,epoch time: 0:02:18.381806,used: 0:13:57.871249,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_02_35_54_seed_1_23090490
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9798177, 'precision': 0.9803009, 'recall': 0.980081, 'specificity': 0.980081, 'f1': 0.97981703, 'auroc': 0.9992564, 'binary_precision': 0.999332, 'binary_recall': 0.9608221, 'binary_specificity': 0.99933994, 'binary_f1_score': 0.9796988}
confusion matrix:
      0     1
0  1514     1
1    61  1496
---- Validation: 
scalar performance:
{'acc': 0.8126464, 'precision': 0.8430555, 'recall': 0.8101895, 'specificity': 0.8101895, 'f1': 0.8075228, 'auroc': 0.9186282, 'binary_precision': 0.9411765, 'binary_recall': 0.6603175, 'binary_specificity': 0.96006143, 'binary_f1_score': 0.7761194}
confusion matrix:
     0    1
0  625   26
1  214  416
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.83555555, 'precision': 0.8488981, 'recall': 0.83555555, 'specificity': 0.83555555, 'f1': 0.83396816, 'auroc': 0.91593087, 'binary_precision': 0.9171271, 'binary_recall': 0.73777777, 'binary_specificity': 0.93333334, 'binary_f1_score': 0.817734}
confusion matrix:
     0    1
0  210   15
1   59  166
early stop counter: 3
val acc:0.8126463890075684, best validation acc: 0.858704149723053, corresponding to test acc:                         0.8488888740539551 / 0.851111114025116
after epoch: 7,now: 2024-07-27 02:52:11.642279,epoch time: 0:02:18.684886,used: 0:16:16.556135,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_02_35_54_seed_1_23090490
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.98046875, 'precision': 0.9808943, 'recall': 0.98032105, 'specificity': 0.98032105, 'f1': 0.98045737, 'auroc': 0.9990852, 'binary_precision': 0.9692211, 'binary_recall': 0.9929215, 'binary_specificity': 0.9677207, 'binary_f1_score': 0.9809281}
confusion matrix:
      0     1
0  1469    49
1    11  1543
---- Validation: 
scalar performance:
{'acc': 0.8087432, 'precision': 0.8229597, 'recall': 0.8104454, 'specificity': 0.8104454, 'f1': 0.8071619, 'auroc': 0.90348184, 'binary_precision': 0.7509778, 'binary_recall': 0.9142857, 'binary_specificity': 0.7066052, 'binary_f1_score': 0.82462424}
confusion matrix:
     0    1
0  460  191
1   54  576
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.76, 'precision': 0.8095238, 'recall': 0.76, 'specificity': 0.76, 'f1': 0.75, 'auroc': 0.93222713, 'binary_precision': 0.6857143, 'binary_recall': 0.96, 'binary_specificity': 0.56, 'binary_f1_score': 0.8}
confusion matrix:
     0    1
0  126   99
1    9  216
early stop counter: 4
val acc:0.8087431788444519, best validation acc: 0.858704149723053, corresponding to test acc:                         0.8488888740539551 / 0.851111114025116
after epoch: 8,now: 2024-07-27 02:54:29.571413,epoch time: 0:02:17.929134,used: 0:18:34.485269,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_02_35_54_seed_1_23090490
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9863281, 'precision': 0.98641527, 'recall': 0.9864549, 'specificity': 0.9864549, 'f1': 0.98632807, 'auroc': 0.99959517, 'binary_precision': 0.996717, 'binary_recall': 0.97620577, 'binary_specificity': 0.99670404, 'binary_f1_score': 0.98635477}
confusion matrix:
      0     1
0  1512     5
1    37  1518
---- Validation: 
scalar performance:
{'acc': 0.6814988, 'precision': 0.779276, 'recall': 0.67657447, 'specificity': 0.67657447, 'f1': 0.6472789, 'auroc': 0.9038141, 'binary_precision': 0.9404762, 'binary_recall': 0.37619048, 'binary_specificity': 0.9769585, 'binary_f1_score': 0.53741497}
confusion matrix:
     0    1
0  636   15
1  393  237
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8155556, 'precision': 0.8423997, 'recall': 0.8155556, 'specificity': 0.8155556, 'f1': 0.8118682, 'auroc': 0.9087012, 'binary_precision': 0.9382716, 'binary_recall': 0.6755555, 'binary_specificity': 0.95555556, 'binary_f1_score': 0.78552973}
confusion matrix:
     0    1
0  215   10
1   73  152
early stop counter: 5
val acc:0.6814988255500793, best validation acc: 0.858704149723053, corresponding to test acc:                         0.8488888740539551 / 0.851111114025116
after epoch: 9,now: 2024-07-27 02:56:46.970620,epoch time: 0:02:17.399207,used: 0:20:51.884476,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_02_35_54_seed_1_23090490
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 9 with time: 0:20:51.884476 at 2024-07-27 02:56:46.970620
persisted model performance metric: 

scalar performance:
{'acc': 0.8488889, 'precision': 0.84933054, 'recall': 0.8488889, 'specificity': 0.8488889, 'f1': 0.8488411, 'auroc': 0.9255506, 'binary_precision': 0.86175114, 'binary_recall': 0.83111113, 'binary_specificity': 0.8666667, 'binary_f1_score': 0.84615386}
confusion matrix:
     0    1
0  195   30
1   38  187
oracle model performance metric: 

scalar performance:
{'acc': 0.8511111, 'precision': 0.8519523, 'recall': 0.8511111, 'specificity': 0.8511111, 'f1': 0.8510221, 'auroc': 0.9202963, 'binary_precision': 0.86915886, 'binary_recall': 0.82666665, 'binary_specificity': 0.8755556, 'binary_f1_score': 0.8473804}
confusion matrix:
     0    1
0  197   28
1   39  186
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_diva_irm_3seeds_nofreeze_2024-07-27_01-18-02/rule_results/7.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_diva_irm_3seeds_nofreeze_2024-07-27_01-18-02/confusion_matrix/7.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   1987 MiB |   8511 MiB | 136208 GiB | 136206 GiB |
|       from large pool |   1895 MiB |   8435 MiB | 134923 GiB | 134921 GiB |
|       from small pool |     91 MiB |    132 MiB |   1284 GiB |   1284 GiB |
|---------------------------------------------------------------------------|
| Active memory         |   1987 MiB |   8511 MiB | 136208 GiB | 136206 GiB |
|       from large pool |   1895 MiB |   8435 MiB | 134923 GiB | 134921 GiB |
|       from small pool |     91 MiB |    132 MiB |   1284 GiB |   1284 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |   1972 MiB |   8498 MiB | 136053 GiB | 136051 GiB |
|       from large pool |   1881 MiB |   8422 MiB | 134771 GiB | 134769 GiB |
|       from small pool |     91 MiB |    132 MiB |   1282 GiB |   1282 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   8974 MiB |   9132 MiB |  15062 MiB |   6088 MiB |
|       from large pool |   8834 MiB |   8998 MiB |  14888 MiB |   6054 MiB |
|       from small pool |    140 MiB |    140 MiB |    174 MiB |     34 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |   1062 MiB |   2276 MiB | 116800 GiB | 116799 GiB |
|       from large pool |   1052 MiB |   2271 MiB | 115479 GiB | 115478 GiB |
|       from small pool |     10 MiB |     50 MiB |   1321 GiB |   1321 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    2456    |    3301    |   20608 K  |   20606 K  |
|       from large pool |     382    |     808    |   10436 K  |   10435 K  |
|       from small pool |    2074    |    2766    |   10172 K  |   10170 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    2456    |    3301    |   20608 K  |   20606 K  |
|       from large pool |     382    |     808    |   10436 K  |   10435 K  |
|       from small pool |    2074    |    2766    |   10172 K  |   10170 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     242    |     265    |     387    |     145    |
|       from large pool |     172    |     198    |     300    |     128    |
|       from small pool |      70    |      70    |      87    |      17    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     147    |     302    |   10927 K  |   10927 K  |
|       from large pool |      76    |     192    |    6044 K  |    6044 K  |
|       from small pool |      71    |     227    |    4882 K  |    4882 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   8511 MiB | 136208 GiB | 136208 GiB |
|       from large pool |  16640 KiB |   8435 MiB | 134923 GiB | 134923 GiB |
|       from small pool |      0 KiB |    132 MiB |   1284 GiB |   1284 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   8511 MiB | 136208 GiB | 136208 GiB |
|       from large pool |  16640 KiB |   8435 MiB | 134923 GiB | 134923 GiB |
|       from small pool |      0 KiB |    132 MiB |   1284 GiB |   1284 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   8498 MiB | 136053 GiB | 136053 GiB |
|       from large pool |  16640 KiB |   8422 MiB | 134771 GiB | 134771 GiB |
|       from small pool |      0 KiB |    132 MiB |   1282 GiB |   1282 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   3050 MiB |   9132 MiB |  15062 MiB |  12012 MiB |
|       from large pool |   2948 MiB |   8998 MiB |  14888 MiB |  11940 MiB |
|       from small pool |    102 MiB |    140 MiB |    174 MiB |     72 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   2276 MiB | 116802 GiB | 116802 GiB |
|       from large pool |  24320 KiB |   2271 MiB | 115480 GiB | 115480 GiB |
|       from small pool |      0 KiB |     56 MiB |   1321 GiB |   1321 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3301    |   20608 K  |   20608 K  |
|       from large pool |       2    |     808    |   10436 K  |   10436 K  |
|       from small pool |       0    |    2766    |   10172 K  |   10172 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3301    |   20608 K  |   20608 K  |
|       from large pool |       2    |     808    |   10436 K  |   10436 K  |
|       from small pool |       0    |    2766    |   10172 K  |   10172 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     121    |     265    |     387    |     266    |
|       from large pool |      70    |     198    |     300    |     230    |
|       from small pool |      51    |      70    |      87    |      36    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |     302    |   10927 K  |   10927 K  |
|       from large pool |       4    |     192    |    6044 K  |    6044 K  |
|       from small pool |       0    |     227    |    4883 K  |    4883 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   8511 MiB | 136208 GiB | 136208 GiB |
|       from large pool |  16640 KiB |   8435 MiB | 134923 GiB | 134923 GiB |
|       from small pool |      0 KiB |    132 MiB |   1284 GiB |   1284 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   8511 MiB | 136208 GiB | 136208 GiB |
|       from large pool |  16640 KiB |   8435 MiB | 134923 GiB | 134923 GiB |
|       from small pool |      0 KiB |    132 MiB |   1284 GiB |   1284 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   8498 MiB | 136053 GiB | 136053 GiB |
|       from large pool |  16640 KiB |   8422 MiB | 134771 GiB | 134771 GiB |
|       from small pool |      0 KiB |    132 MiB |   1282 GiB |   1282 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   3050 MiB |   9132 MiB |  15062 MiB |  12012 MiB |
|       from large pool |   2948 MiB |   8998 MiB |  14888 MiB |  11940 MiB |
|       from small pool |    102 MiB |    140 MiB |    174 MiB |     72 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   2276 MiB | 116802 GiB | 116802 GiB |
|       from large pool |  24320 KiB |   2271 MiB | 115480 GiB | 115480 GiB |
|       from small pool |      0 KiB |     56 MiB |   1321 GiB |   1321 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3301    |   20608 K  |   20608 K  |
|       from large pool |       2    |     808    |   10436 K  |   10436 K  |
|       from small pool |       0    |    2766    |   10172 K  |   10172 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3301    |   20608 K  |   20608 K  |
|       from large pool |       2    |     808    |   10436 K  |   10436 K  |
|       from small pool |       0    |    2766    |   10172 K  |   10172 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     121    |     265    |     387    |     266    |
|       from large pool |      70    |     198    |     300    |     230    |
|       from small pool |      51    |      70    |      87    |      36    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |     302    |   10927 K  |   10927 K  |
|       from large pool |       4    |     192    |    6044 K  |    6044 K  |
|       from small pool |       0    |     227    |    4883 K  |    4883 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/init.py:452: UserWarning: Initializing zero-element tensors is a no-op
  warnings.warn("Initializing zero-element tensors is a no-op")
Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main

using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_02_57_23_seed_2_23090490

 Experiment start at: 2024-07-27 02:57:23.879566
hyper-parameter scheduler not set,going to use default Warmpup and epoch update
before training, model accuracy: 0.48842594027519226
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9486257, 'precision': 0.950483, 'recall': 0.94838345, 'specificity': 0.94838345, 'f1': 0.9485502, 'auroc': 0.99160725, 'binary_precision': 0.92345375, 'binary_recall': 0.9792208, 'binary_specificity': 0.91754615, 'binary_f1_score': 0.95052}
confusion matrix:
      0     1
0  1391   125
1    32  1508
---- Validation: 
scalar performance:
{'acc': 0.7574335, 'precision': 0.79460096, 'recall': 0.76205295, 'specificity': 0.76205295, 'f1': 0.7515907, 'auroc': 0.8967606, 'binary_precision': 0.6830986, 'binary_recall': 0.9356913, 'binary_specificity': 0.5884146, 'binary_f1_score': 0.789688}
confusion matrix:
     0    1
0  386  270
1   40  582
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.775463, 'precision': 0.808831, 'recall': 0.775463, 'specificity': 0.775463, 'f1': 0.76922953, 'auroc': 0.91439474, 'binary_precision': 0.70731705, 'binary_recall': 0.9398148, 'binary_specificity': 0.6111111, 'binary_f1_score': 0.80715704}
confusion matrix:
     0    1
0  132   84
1   13  203
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-27 02:59:44.899472,epoch time: 0:02:21.019906,used: 0:02:21.019906,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_02_57_23_seed_2_23090490
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9679319, 'precision': 0.96860826, 'recall': 0.96809447, 'specificity': 0.96809447, 'f1': 0.96792644, 'auroc': 0.9951478, 'binary_precision': 0.98848236, 'binary_recall': 0.9474026, 'binary_specificity': 0.9887863, 'binary_f1_score': 0.96750665}
confusion matrix:
      0     1
0  1499    17
1    81  1459
---- Validation: 
scalar performance:
{'acc': 0.7762128, 'precision': 0.77685314, 'recall': 0.77680427, 'specificity': 0.77680427, 'f1': 0.7762123, 'auroc': 0.84338486, 'binary_precision': 0.7553192, 'binary_recall': 0.7990354, 'binary_specificity': 0.75457317, 'binary_f1_score': 0.77656245}
confusion matrix:
     0    1
0  495  161
1  125  497
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7986111, 'precision': 0.8121597, 'recall': 0.7986111, 'specificity': 0.7986111, 'f1': 0.7964019, 'auroc': 0.9205675, 'binary_precision': 0.74712646, 'binary_recall': 0.9027778, 'binary_specificity': 0.6944444, 'binary_f1_score': 0.8176101}
confusion matrix:
     0    1
0  150   66
1   21  195
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-07-27 03:02:02.879593,epoch time: 0:02:17.980121,used: 0:04:39.000027,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_02_57_23_seed_2_23090490
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9496073, 'precision': 0.95389223, 'recall': 0.95, 'specificity': 0.95, 'f1': 0.94951594, 'auroc': 0.99519503, 'binary_precision': 1.0, 'binary_recall': 0.9, 'binary_specificity': 1.0, 'binary_f1_score': 0.9473684}
confusion matrix:
      0     1
0  1516     0
1   154  1386
---- Validation: 
scalar performance:
{'acc': 0.69953054, 'precision': 0.78488237, 'recall': 0.6920683, 'specificity': 0.6920683, 'f1': 0.67005163, 'auroc': 0.87024856, 'binary_precision': 0.93430656, 'binary_recall': 0.41157556, 'binary_specificity': 0.972561, 'binary_f1_score': 0.57142854}
confusion matrix:
     0    1
0  638   18
1  366  256
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6226852, 'precision': 0.7677895, 'recall': 0.6226852, 'specificity': 0.6226852, 'f1': 0.56356335, 'auroc': 0.88290894, 'binary_precision': 0.9649123, 'binary_recall': 0.25462964, 'binary_specificity': 0.9907407, 'binary_f1_score': 0.40293044}
confusion matrix:
     0   1
0  214   2
1  161  55
early stop counter: 1
val acc:0.6995305418968201, best validation acc: 0.7762128114700317, corresponding to test acc:                         0.7986111044883728 / 0.7986111044883728
after epoch: 3,now: 2024-07-27 03:04:19.413963,epoch time: 0:02:16.534370,used: 0:06:55.534397,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_02_57_23_seed_2_23090490
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.976767, 'precision': 0.97747767, 'recall': 0.97693264, 'specificity': 0.97693264, 'f1': 0.9767629, 'auroc': 0.997831, 'binary_precision': 0.9979661, 'binary_recall': 0.95584416, 'binary_specificity': 0.9980211, 'binary_f1_score': 0.97645116}
confusion matrix:
      0     1
0  1513     3
1    68  1472
---- Validation: 
scalar performance:
{'acc': 0.80829424, 'precision': 0.8344963, 'recall': 0.80451286, 'specificity': 0.80451286, 'f1': 0.80302626, 'auroc': 0.88784945, 'binary_precision': 0.92170024, 'binary_recall': 0.66237944, 'binary_specificity': 0.94664633, 'binary_f1_score': 0.7708138}
confusion matrix:
     0    1
0  621   35
1  210  412
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8171296, 'precision': 0.84269834, 'recall': 0.8171296, 'specificity': 0.8171296, 'f1': 0.8136538, 'auroc': 0.9081361, 'binary_precision': 0.93630576, 'binary_recall': 0.6805556, 'binary_specificity': 0.9537037, 'binary_f1_score': 0.7882038}
confusion matrix:
     0    1
0  206   10
1   69  147
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-07-27 03:06:37.558260,epoch time: 0:02:18.144297,used: 0:09:13.678694,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_02_57_23_seed_2_23090490
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9718586, 'precision': 0.9727964, 'recall': 0.9720471, 'specificity': 0.9720471, 'f1': 0.9718511, 'auroc': 0.9954425, 'binary_precision': 0.99590725, 'binary_recall': 0.9480519, 'binary_specificity': 0.9960422, 'binary_f1_score': 0.97139055}
confusion matrix:
      0     1
0  1510     6
1    80  1460
---- Validation: 
scalar performance:
{'acc': 0.8114241, 'precision': 0.8113855, 'recall': 0.811603, 'specificity': 0.811603, 'f1': 0.8113824, 'auroc': 0.8720492, 'binary_precision': 0.7990581, 'binary_recall': 0.81832796, 'binary_specificity': 0.80487806, 'binary_f1_score': 0.8085782}
confusion matrix:
     0    1
0  528  128
1  113  509
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8171296, 'precision': 0.81746304, 'recall': 0.8171296, 'specificity': 0.8171296, 'f1': 0.8170816, 'auroc': 0.90429956, 'binary_precision': 0.8277512, 'binary_recall': 0.8009259, 'binary_specificity': 0.8333333, 'binary_f1_score': 0.8141176}
confusion matrix:
     0    1
0  180   36
1   43  173
better model found
persisted
after epoch: 5,now: 2024-07-27 03:08:54.872608,epoch time: 0:02:17.314348,used: 0:11:30.993042,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_02_57_23_seed_2_23090490
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.95418847, 'precision': 0.95772946, 'recall': 0.9545455, 'specificity': 0.9545455, 'f1': 0.95412236, 'auroc': 0.99670446, 'binary_precision': 1.0, 'binary_recall': 0.90909094, 'binary_specificity': 1.0, 'binary_f1_score': 0.95238096}
confusion matrix:
      0     1
0  1516     0
1   140  1400
---- Validation: 
scalar performance:
{'acc': 0.5766823, 'precision': 0.7374605, 'recall': 0.5654042, 'specificity': 0.5654042, 'f1': 0.47564283, 'auroc': 0.8457382, 'binary_precision': 0.9263158, 'binary_recall': 0.1414791, 'binary_specificity': 0.9893293, 'binary_f1_score': 0.24546723}
confusion matrix:
     0   1
0  649   7
1  534  88
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5555556, 'precision': 0.7647059, 'recall': 0.5555556, 'specificity': 0.5555556, 'f1': 0.44615385, 'auroc': 0.9077289, 'binary_precision': 1.0, 'binary_recall': 0.11111111, 'binary_specificity': 1.0, 'binary_f1_score': 0.19999999}
confusion matrix:
     0   1
0  216   0
1  192  24
early stop counter: 1
val acc:0.5766823291778564, best validation acc: 0.8114240765571594, corresponding to test acc:                         0.8171296119689941 / 0.8171296119689941
after epoch: 6,now: 2024-07-27 03:11:11.809359,epoch time: 0:02:16.936751,used: 0:13:47.929793,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_02_57_23_seed_2_23090490
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.97971207, 'precision': 0.97984564, 'recall': 0.9797931, 'specificity': 0.9797931, 'f1': 0.9797119, 'auroc': 0.9977894, 'binary_precision': 0.99005306, 'binary_recall': 0.9694805, 'binary_specificity': 0.99010557, 'binary_f1_score': 0.9796588}
confusion matrix:
      0     1
0  1501    15
1    47  1493
---- Validation: 
scalar performance:
{'acc': 0.80203444, 'precision': 0.8374546, 'recall': 0.79766536, 'specificity': 0.79766536, 'f1': 0.79498386, 'auroc': 0.9019023, 'binary_precision': 0.94033414, 'binary_recall': 0.6334405, 'binary_specificity': 0.9618902, 'binary_f1_score': 0.7569645}
confusion matrix:
     0    1
0  631   25
1  228  394
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8078704, 'precision': 0.8582492, 'recall': 0.8078704, 'specificity': 0.8078704, 'f1': 0.8008697, 'auroc': 0.92116773, 'binary_precision': 0.9925926, 'binary_recall': 0.6203704, 'binary_specificity': 0.9953704, 'binary_f1_score': 0.76353276}
confusion matrix:
     0    1
0  215    1
1   82  134
early stop counter: 2
val acc:0.8020344376564026, best validation acc: 0.8114240765571594, corresponding to test acc:                         0.8171296119689941 / 0.8171296119689941
after epoch: 7,now: 2024-07-27 03:13:28.864008,epoch time: 0:02:17.054649,used: 0:16:04.984442,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_02_57_23_seed_2_23090490
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9842932, 'precision': 0.98440665, 'recall': 0.9843693, 'specificity': 0.9843693, 'f1': 0.9842931, 'auroc': 0.9988457, 'binary_precision': 0.9940397, 'binary_recall': 0.9746753, 'binary_specificity': 0.9940633, 'binary_f1_score': 0.9842623}
confusion matrix:
      0     1
0  1507     9
1    39  1501
---- Validation: 
scalar performance:
{'acc': 0.700313, 'precision': 0.78976023, 'recall': 0.6927471, 'specificity': 0.6927471, 'f1': 0.67005795, 'auroc': 0.894694, 'binary_precision': 0.94423795, 'binary_recall': 0.40836012, 'binary_specificity': 0.97713417, 'binary_f1_score': 0.5701459}
confusion matrix:
     0    1
0  641   15
1  368  254
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7291667, 'precision': 0.8243243, 'recall': 0.7291667, 'specificity': 0.7291667, 'f1': 0.7077283, 'auroc': 0.90693593, 'binary_precision': 1.0, 'binary_recall': 0.45833334, 'binary_specificity': 1.0, 'binary_f1_score': 0.62857145}
confusion matrix:
     0   1
0  216   0
1  117  99
early stop counter: 3
val acc:0.7003129720687866, best validation acc: 0.8114240765571594, corresponding to test acc:                         0.8171296119689941 / 0.8171296119689941
after epoch: 8,now: 2024-07-27 03:15:45.796071,epoch time: 0:02:16.932063,used: 0:18:21.916505,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_02_57_23_seed_2_23090490
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9790576, 'precision': 0.9791703, 'recall': 0.97913337, 'specificity': 0.97913337, 'f1': 0.97905755, 'auroc': 0.9960576, 'binary_precision': 0.9887417, 'binary_recall': 0.9694805, 'binary_specificity': 0.9887863, 'binary_f1_score': 0.9790164}
confusion matrix:
      0     1
0  1499    17
1    47  1493
---- Validation: 
scalar performance:
{'acc': 0.76760566, 'precision': 0.7795193, 'recall': 0.7647121, 'specificity': 0.7647121, 'f1': 0.7636662, 'auroc': 0.8457204, 'binary_precision': 0.83095723, 'binary_recall': 0.6559486, 'binary_specificity': 0.8734756, 'binary_f1_score': 0.73315364}
confusion matrix:
     0    1
0  573   83
1  214  408
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8171296, 'precision': 0.82568073, 'recall': 0.8171296, 'specificity': 0.8171296, 'f1': 0.8159213, 'auroc': 0.8832733, 'binary_precision': 0.878453, 'binary_recall': 0.7361111, 'binary_specificity': 0.8981481, 'binary_f1_score': 0.80100757}
confusion matrix:
     0    1
0  194   22
1   57  159
early stop counter: 4
val acc:0.7676056623458862, best validation acc: 0.8114240765571594, corresponding to test acc:                         0.8171296119689941 / 0.8171296119689941
after epoch: 9,now: 2024-07-27 03:18:02.451232,epoch time: 0:02:16.655161,used: 0:20:38.571666,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_02_57_23_seed_2_23090490
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9846204, 'precision': 0.98481447, 'recall': 0.98471457, 'specificity': 0.98471457, 'f1': 0.9846201, 'auroc': 0.99923325, 'binary_precision': 0.99667335, 'binary_recall': 0.9727273, 'binary_specificity': 0.99670184, 'binary_f1_score': 0.9845547}
confusion matrix:
      0     1
0  1511     5
1    42  1498
---- Validation: 
scalar performance:
{'acc': 0.7902973, 'precision': 0.8245132, 'recall': 0.78589916, 'specificity': 0.78589916, 'f1': 0.7827633, 'auroc': 0.891984, 'binary_precision': 0.923445, 'binary_recall': 0.62057877, 'binary_specificity': 0.9512195, 'binary_f1_score': 0.74230766}
confusion matrix:
     0    1
0  624   32
1  236  386
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7800926, 'precision': 0.8079823, 'recall': 0.7800926, 'specificity': 0.7800926, 'f1': 0.7749988, 'auroc': 0.90279925, 'binary_precision': 0.90066224, 'binary_recall': 0.6296296, 'binary_specificity': 0.9305556, 'binary_f1_score': 0.7411444}
confusion matrix:
     0    1
0  201   15
1   80  136
early stop counter: 5
val acc:0.7902973294258118, best validation acc: 0.8114240765571594, corresponding to test acc:                         0.8171296119689941 / 0.8171296119689941
after epoch: 10,now: 2024-07-27 03:20:19.314313,epoch time: 0:02:16.863081,used: 0:22:55.434747,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_02_57_23_seed_2_23090490
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 10 with time: 0:22:55.434747 at 2024-07-27 03:20:19.314313
persisted model performance metric: 

scalar performance:
{'acc': 0.8171296, 'precision': 0.81746304, 'recall': 0.8171296, 'specificity': 0.8171296, 'f1': 0.8170816, 'auroc': 0.90429956, 'binary_precision': 0.8277512, 'binary_recall': 0.8009259, 'binary_specificity': 0.8333333, 'binary_f1_score': 0.8141176}
confusion matrix:
     0    1
0  180   36
1   43  173
oracle model performance metric: 

scalar performance:
{'acc': 0.8171296, 'precision': 0.84269834, 'recall': 0.8171296, 'specificity': 0.8171296, 'f1': 0.8136538, 'auroc': 0.9081361, 'binary_precision': 0.93630576, 'binary_recall': 0.6805556, 'binary_specificity': 0.9537037, 'binary_f1_score': 0.7882038}
confusion matrix:
     0    1
0  206   10
1   69  147
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_diva_irm_3seeds_nofreeze_2024-07-27_01-18-02/rule_results/7.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_diva_irm_3seeds_nofreeze_2024-07-27_01-18-02/confusion_matrix/7.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   1989 MiB |   8511 MiB | 197794 GiB | 197792 GiB |
|       from large pool |   1898 MiB |   8435 MiB | 195929 GiB | 195928 GiB |
|       from small pool |     91 MiB |    132 MiB |   1864 GiB |   1864 GiB |
|---------------------------------------------------------------------------|
| Active memory         |   1989 MiB |   8511 MiB | 197794 GiB | 197792 GiB |
|       from large pool |   1898 MiB |   8435 MiB | 195929 GiB | 195928 GiB |
|       from small pool |     91 MiB |    132 MiB |   1864 GiB |   1864 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |   1972 MiB |   8498 MiB | 197584 GiB | 197582 GiB |
|       from large pool |   1881 MiB |   8422 MiB | 195723 GiB | 195721 GiB |
|       from small pool |     91 MiB |    132 MiB |   1861 GiB |   1861 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   8968 MiB |   9132 MiB |  20980 MiB |  12012 MiB |
|       from large pool |   8832 MiB |   8998 MiB |  20772 MiB |  11940 MiB |
|       from small pool |    136 MiB |    140 MiB |    208 MiB |     72 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |   1122 MiB |   2314 MiB | 172150 GiB | 172149 GiB |
|       from large pool |   1113 MiB |   2310 MiB | 170233 GiB | 170232 GiB |
|       from small pool |      8 MiB |     56 MiB |   1917 GiB |   1917 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    2444    |    3301    |   29925 K  |   29922 K  |
|       from large pool |     382    |     808    |   15155 K  |   15154 K  |
|       from small pool |    2062    |    2766    |   14769 K  |   14767 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    2444    |    3301    |   29925 K  |   29922 K  |
|       from large pool |     382    |     808    |   15155 K  |   15154 K  |
|       from small pool |    2062    |    2766    |   14769 K  |   14767 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     240    |     265    |     506    |     266    |
|       from large pool |     172    |     198    |     402    |     230    |
|       from small pool |      68    |      70    |     104    |      36    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     132    |     302    |   15720 K  |   15720 K  |
|       from large pool |      70    |     192    |    8519 K  |    8519 K  |
|       from small pool |      62    |     227    |    7201 K  |    7201 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   8511 MiB | 197794 GiB | 197794 GiB |
|       from large pool |  16640 KiB |   8435 MiB | 195929 GiB | 195929 GiB |
|       from small pool |      0 KiB |    132 MiB |   1864 GiB |   1864 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   8511 MiB | 197794 GiB | 197794 GiB |
|       from large pool |  16640 KiB |   8435 MiB | 195929 GiB | 195929 GiB |
|       from small pool |      0 KiB |    132 MiB |   1864 GiB |   1864 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   8498 MiB | 197584 GiB | 197584 GiB |
|       from large pool |  16640 KiB |   8422 MiB | 195723 GiB | 195723 GiB |
|       from small pool |      0 KiB |    132 MiB |   1861 GiB |   1861 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   3112 MiB |   9132 MiB |  20980 MiB |  17868 MiB |
|       from large pool |   3012 MiB |   8998 MiB |  20772 MiB |  17760 MiB |
|       from small pool |    100 MiB |    140 MiB |    208 MiB |    108 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   2314 MiB | 172151 GiB | 172151 GiB |
|       from large pool |  24320 KiB |   2310 MiB | 170234 GiB | 170234 GiB |
|       from small pool |      0 KiB |     56 MiB |   1917 GiB |   1917 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3301    |   29925 K  |   29925 K  |
|       from large pool |       2    |     808    |   15155 K  |   15155 K  |
|       from small pool |       0    |    2766    |   14769 K  |   14769 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3301    |   29925 K  |   29925 K  |
|       from large pool |       2    |     808    |   15155 K  |   15155 K  |
|       from small pool |       0    |    2766    |   14769 K  |   14769 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     121    |     265    |     506    |     385    |
|       from large pool |      71    |     198    |     402    |     331    |
|       from small pool |      50    |      70    |     104    |      54    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |     302    |   15721 K  |   15721 K  |
|       from large pool |       4    |     192    |    8519 K  |    8519 K  |
|       from small pool |       0    |     227    |    7201 K  |    7201 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Sat Jul 27 03:20:29 2024]
Finished job 0.
1 of 1 steps (100%) done
