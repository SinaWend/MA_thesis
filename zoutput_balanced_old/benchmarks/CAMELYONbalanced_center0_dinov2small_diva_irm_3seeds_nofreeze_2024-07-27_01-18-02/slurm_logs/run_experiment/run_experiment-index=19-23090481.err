Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Sat Jul 27 01:18:57 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_diva_irm_3seeds_nofreeze_2024-07-27_01-18-02/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_diva_irm_3seeds_nofreeze_2024-07-27_01-18-02/rule_results/19.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=19
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/var/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/swiglu_ffn.py:51: UserWarning: xFormers is not available (SwiGLU)
  warnings.warn("xFormers is not available (SwiGLU)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/attention.py:33: UserWarning: xFormers is not available (Attention)
  warnings.warn("xFormers is not available (Attention)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/block.py:40: UserWarning: xFormers is not available (Block)
  warnings.warn("xFormers is not available (Block)")
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/init.py:452: UserWarning: Initializing zero-element tensors is a no-op
  warnings.warn("Initializing zero-element tensors is a no-op")
Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main

using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_01_19_28_seed_0_23090481

 Experiment start at: 2024-07-27 01:19:29.527671
before training, model accuracy: 0.38604649901390076
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.8935547, 'precision': 0.9106833, 'recall': 0.8951056, 'specificity': 0.8951056, 'f1': 0.8926822, 'auroc': 0.98895276, 'binary_precision': 0.99838185, 'binary_recall': 0.79153305, 'binary_specificity': 0.99867815, 'binary_f1_score': 0.8830054}
confusion matrix:
      0     1
0  1511     2
1   325  1234
---- Validation: 
scalar performance:
{'acc': 0.59782606, 'precision': 0.7340214, 'recall': 0.5924081, 'specificity': 0.5924081, 'f1': 0.52304614, 'auroc': 0.75268114, 'binary_precision': 0.90909094, 'binary_recall': 0.20472442, 'binary_specificity': 0.98009187, 'binary_f1_score': 0.33419025}
confusion matrix:
     0    1
0  640   13
1  505  130
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7162791, 'precision': 0.77909607, 'recall': 0.71627903, 'specificity': 0.71627903, 'f1': 0.6993627, 'auroc': 0.85079503, 'binary_precision': 0.91150445, 'binary_recall': 0.47906977, 'binary_specificity': 0.95348835, 'binary_f1_score': 0.6280488}
confusion matrix:
     0    1
0  205   10
1  112  103
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-27 01:20:19.637389,epoch time: 0:00:50.109718,used: 0:00:50.109718,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_01_19_28_seed_0_23090481
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9658203, 'precision': 0.96580946, 'recall': 0.9658179, 'specificity': 0.9658179, 'f1': 0.96581364, 'auroc': 0.99487245, 'binary_precision': 0.96660244, 'binary_recall': 0.965982, 'binary_specificity': 0.9656539, 'binary_f1_score': 0.9662921}
confusion matrix:
      0     1
0  1462    52
1    53  1505
---- Validation: 
scalar performance:
{'acc': 0.6630435, 'precision': 0.72652686, 'recall': 0.6592661, 'specificity': 0.6592661, 'f1': 0.63448906, 'auroc': 0.8020065, 'binary_precision': 0.8430034, 'binary_recall': 0.38897637, 'binary_specificity': 0.9295559, 'binary_f1_score': 0.5323276}
confusion matrix:
     0    1
0  607   46
1  388  247
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.80697674, 'precision': 0.82104075, 'recall': 0.80697674, 'specificity': 0.80697674, 'f1': 0.8048394, 'auroc': 0.89644134, 'binary_precision': 0.8882353, 'binary_recall': 0.7023256, 'binary_specificity': 0.9116279, 'binary_f1_score': 0.7844156}
confusion matrix:
     0    1
0  196   19
1   64  151
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-07-27 01:21:06.432976,epoch time: 0:00:46.795587,used: 0:01:36.905305,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_01_19_28_seed_0_23090481
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.96875, 'precision': 0.96903396, 'recall': 0.9689385, 'specificity': 0.9689385, 'f1': 0.96874964, 'auroc': 0.99426097, 'binary_precision': 0.9840743, 'binary_recall': 0.95369774, 'binary_specificity': 0.9841793, 'binary_f1_score': 0.9686479}
confusion matrix:
      0     1
0  1493    24
1    72  1483
---- Validation: 
scalar performance:
{'acc': 0.8113354, 'precision': 0.81283695, 'recall': 0.8118086, 'specificity': 0.8118086, 'f1': 0.8112397, 'auroc': 0.8962294, 'binary_precision': 0.78739005, 'binary_recall': 0.84566927, 'binary_specificity': 0.77794796, 'binary_f1_score': 0.81548977}
confusion matrix:
     0    1
0  508  145
1   98  537
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.81860465, 'precision': 0.83124536, 'recall': 0.81860465, 'specificity': 0.81860465, 'f1': 0.81685746, 'auroc': 0.9108491, 'binary_precision': 0.76653695, 'binary_recall': 0.9162791, 'binary_specificity': 0.7209302, 'binary_f1_score': 0.83474576}
confusion matrix:
     0    1
0  155   60
1   18  197
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-07-27 01:21:53.272051,epoch time: 0:00:46.839075,used: 0:02:23.744380,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_01_19_28_seed_0_23090481
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9658203, 'precision': 0.9669157, 'recall': 0.96619225, 'specificity': 0.96619225, 'f1': 0.96581364, 'auroc': 0.9964398, 'binary_precision': 0.9932065, 'binary_recall': 0.9389852, 'binary_specificity': 0.9933993, 'binary_f1_score': 0.9653351}
confusion matrix:
      0     1
0  1505    10
1    95  1462
---- Validation: 
scalar performance:
{'acc': 0.5993789, 'precision': 0.7246207, 'recall': 0.5940698, 'specificity': 0.5940698, 'f1': 0.52829355, 'auroc': 0.8537314, 'binary_precision': 0.8888889, 'binary_recall': 0.21417323, 'binary_specificity': 0.9739663, 'binary_f1_score': 0.34517765}
confusion matrix:
     0    1
0  636   17
1  499  136
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.73953485, 'precision': 0.80235386, 'recall': 0.73953485, 'specificity': 0.73953485, 'f1': 0.72526467, 'auroc': 0.89981616, 'binary_precision': 0.94017094, 'binary_recall': 0.5116279, 'binary_specificity': 0.96744186, 'binary_f1_score': 0.6626506}
confusion matrix:
     0    1
0  208    7
1  105  110
early stop counter: 1
val acc:0.5993788838386536, best validation acc: 0.8113353848457336, corresponding to test acc:                         0.8186046481132507 / 0.8186046481132507
after epoch: 4,now: 2024-07-27 01:22:39.614037,epoch time: 0:00:46.341986,used: 0:03:10.086366,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_01_19_28_seed_0_23090481
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9742839, 'precision': 0.9750453, 'recall': 0.97461903, 'specificity': 0.97461903, 'f1': 0.97428155, 'auroc': 0.99691296, 'binary_precision': 0.9979798, 'binary_recall': 0.9512195, 'binary_specificity': 0.9980185, 'binary_f1_score': 0.9740388}
confusion matrix:
      0     1
0  1511     3
1    76  1482
---- Validation: 
scalar performance:
{'acc': 0.6226708, 'precision': 0.6804044, 'recall': 0.6186034, 'specificity': 0.6186034, 'f1': 0.5854374, 'auroc': 0.81016994, 'binary_precision': 0.7790262, 'binary_recall': 0.32755905, 'binary_specificity': 0.90964776, 'binary_f1_score': 0.46119732}
confusion matrix:
     0    1
0  594   59
1  427  208
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.80930233, 'precision': 0.8163094, 'recall': 0.80930233, 'specificity': 0.80930233, 'f1': 0.80824035, 'auroc': 0.8790481, 'binary_precision': 0.863388, 'binary_recall': 0.7348837, 'binary_specificity': 0.88372093, 'binary_f1_score': 0.79396987}
confusion matrix:
     0    1
0  190   25
1   57  158
early stop counter: 2
val acc:0.6226708292961121, best validation acc: 0.8113353848457336, corresponding to test acc:                         0.8186046481132507 / 0.8186046481132507
after epoch: 5,now: 2024-07-27 01:23:25.805293,epoch time: 0:00:46.191256,used: 0:03:56.277622,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_01_19_28_seed_0_23090481
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9765625, 'precision': 0.9765428, 'recall': 0.97658396, 'specificity': 0.97658396, 'f1': 0.97655964, 'auroc': 0.9975531, 'binary_precision': 0.9787097, 'binary_recall': 0.9749357, 'binary_specificity': 0.9782322, 'binary_f1_score': 0.97681904}
confusion matrix:
      0     1
0  1483    33
1    39  1517
---- Validation: 
scalar performance:
{'acc': 0.8175466, 'precision': 0.8221117, 'recall': 0.8183683, 'specificity': 0.8183683, 'f1': 0.8171364, 'auroc': 0.9029145, 'binary_precision': 0.780112, 'binary_recall': 0.8771654, 'binary_specificity': 0.7595712, 'binary_f1_score': 0.8257969}
confusion matrix:
     0    1
0  496  157
1   78  557
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.80465114, 'precision': 0.82357943, 'recall': 0.80465114, 'specificity': 0.80465114, 'f1': 0.801752, 'auroc': 0.9220768, 'binary_precision': 0.74531835, 'binary_recall': 0.9255814, 'binary_specificity': 0.68372095, 'binary_f1_score': 0.8257261}
confusion matrix:
     0    1
0  147   68
1   16  199
better model found
persisted
after epoch: 6,now: 2024-07-27 01:24:12.462550,epoch time: 0:00:46.657257,used: 0:04:42.934879,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_01_19_28_seed_0_23090481
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9824219, 'precision': 0.9824499, 'recall': 0.98239344, 'specificity': 0.98239344, 'f1': 0.9824179, 'auroc': 0.998827, 'binary_precision': 0.98079383, 'binary_recall': 0.9845758, 'binary_specificity': 0.9802111, 'binary_f1_score': 0.98268116}
confusion matrix:
      0     1
0  1486    30
1    24  1532
---- Validation: 
scalar performance:
{'acc': 0.8121118, 'precision': 0.8162619, 'recall': 0.8128999, 'specificity': 0.8128999, 'f1': 0.81173, 'auroc': 0.8807442, 'binary_precision': 0.7763713, 'binary_recall': 0.86929137, 'binary_specificity': 0.7565084, 'binary_f1_score': 0.820208}
confusion matrix:
     0    1
0  494  159
1   83  552
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.81395346, 'precision': 0.8149346, 'recall': 0.8139535, 'specificity': 0.8139535, 'f1': 0.81380844, 'auroc': 0.8602488, 'binary_precision': 0.79735684, 'binary_recall': 0.8418605, 'binary_specificity': 0.7860465, 'binary_f1_score': 0.81900454}
confusion matrix:
     0    1
0  169   46
1   34  181
early stop counter: 1
val acc:0.8121117949485779, best validation acc: 0.8175466060638428, corresponding to test acc:                         0.804651141166687 / 0.8186046481132507
after epoch: 7,now: 2024-07-27 01:24:58.899266,epoch time: 0:00:46.436716,used: 0:05:29.371595,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_01_19_28_seed_0_23090481
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.97265625, 'precision': 0.9737891, 'recall': 0.9723574, 'specificity': 0.9723574, 'f1': 0.9726224, 'auroc': 0.99879646, 'binary_precision': 0.9537893, 'binary_recall': 0.99421966, 'binary_specificity': 0.95049506, 'binary_f1_score': 0.9735849}
confusion matrix:
      0     1
0  1440    75
1     9  1548
---- Validation: 
scalar performance:
{'acc': 0.7919255, 'precision': 0.80687547, 'recall': 0.7934476, 'specificity': 0.7934476, 'f1': 0.78991497, 'auroc': 0.8765093, 'binary_precision': 0.7355584, 'binary_recall': 0.9023622, 'binary_specificity': 0.68453294, 'binary_f1_score': 0.81046677}
confusion matrix:
     0    1
0  447  206
1   62  573
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.76976746, 'precision': 0.79016197, 'recall': 0.7697674, 'specificity': 0.7697674, 'f1': 0.76564956, 'auroc': 0.9095079, 'binary_precision': 0.7132353, 'binary_recall': 0.9023256, 'binary_specificity': 0.6372093, 'binary_f1_score': 0.7967146}
confusion matrix:
     0    1
0  137   78
1   21  194
early stop counter: 2
val acc:0.7919254899024963, best validation acc: 0.8175466060638428, corresponding to test acc:                         0.804651141166687 / 0.8186046481132507
after epoch: 8,now: 2024-07-27 01:25:45.252468,epoch time: 0:00:46.353202,used: 0:06:15.724797,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_01_19_28_seed_0_23090481
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.97753906, 'precision': 0.97801256, 'recall': 0.97778535, 'specificity': 0.97778535, 'f1': 0.9775382, 'auroc': 0.99881727, 'binary_precision': 0.99666, 'binary_recall': 0.9588689, 'binary_specificity': 0.99670184, 'binary_f1_score': 0.9773993}
confusion matrix:
      0     1
0  1511     5
1    64  1492
---- Validation: 
scalar performance:
{'acc': 0.79736024, 'precision': 0.8273777, 'recall': 0.79522616, 'specificity': 0.79522616, 'f1': 0.79177207, 'auroc': 0.91347504, 'binary_precision': 0.9230769, 'binary_recall': 0.6425197, 'binary_specificity': 0.9479326, 'binary_f1_score': 0.7576602}
confusion matrix:
     0    1
0  619   34
1  227  408
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.81860465, 'precision': 0.85884845, 'recall': 0.81860465, 'specificity': 0.81860465, 'f1': 0.81337225, 'auroc': 0.93665767, 'binary_precision': 0.97902095, 'binary_recall': 0.6511628, 'binary_specificity': 0.9860465, 'binary_f1_score': 0.7821229}
confusion matrix:
     0    1
0  212    3
1   75  140
early stop counter: 3
val acc:0.7973602414131165, best validation acc: 0.8175466060638428, corresponding to test acc:                         0.804651141166687 / 0.8186046481132507
after epoch: 9,now: 2024-07-27 01:26:31.415690,epoch time: 0:00:46.163222,used: 0:07:01.888019,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_01_19_28_seed_0_23090481
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9684245, 'precision': 0.96974653, 'recall': 0.9687861, 'specificity': 0.9687861, 'f1': 0.9684151, 'auroc': 0.9987956, 'binary_precision': 0.9979508, 'binary_recall': 0.93954986, 'binary_specificity': 0.99802244, 'binary_f1_score': 0.9678701}
confusion matrix:
      0     1
0  1514     3
1    94  1461
---- Validation: 
scalar performance:
{'acc': 0.5279503, 'precision': 0.7135096, 'recall': 0.52132493, 'specificity': 0.52132493, 'f1': 0.38558108, 'auroc': 0.84359765, 'binary_precision': 0.90909094, 'binary_recall': 0.047244094, 'binary_specificity': 0.9954058, 'binary_f1_score': 0.08982036}
confusion matrix:
     0   1
0  650   3
1  605  30
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5023256, 'precision': 0.75058275, 'recall': 0.5023256, 'specificity': 0.5023256, 'f1': 0.3384806, 'auroc': 0.919762, 'binary_precision': 1.0, 'binary_recall': 0.004651163, 'binary_specificity': 1.0, 'binary_f1_score': 0.009259259}
confusion matrix:
     0  1
0  215  0
1  214  1
early stop counter: 4
val acc:0.5279502868652344, best validation acc: 0.8175466060638428, corresponding to test acc:                         0.804651141166687 / 0.8186046481132507
after epoch: 10,now: 2024-07-27 01:27:17.383911,epoch time: 0:00:45.968221,used: 0:07:47.856240,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_01_19_28_seed_0_23090481
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9703776, 'precision': 0.9713231, 'recall': 0.9707075, 'specificity': 0.9707075, 'f1': 0.9703728, 'auroc': 0.9972178, 'binary_precision': 0.9959377, 'binary_recall': 0.94537276, 'binary_specificity': 0.9960422, 'binary_f1_score': 0.96999675}
confusion matrix:
      0     1
0  1510     6
1    85  1471
---- Validation: 
scalar performance:
{'acc': 0.6630435, 'precision': 0.7748385, 'recall': 0.6585282, 'specificity': 0.6585282, 'f1': 0.62121755, 'auroc': 0.90188706, 'binary_precision': 0.94666666, 'binary_recall': 0.33543307, 'binary_specificity': 0.9816233, 'binary_f1_score': 0.49534884}
confusion matrix:
     0    1
0  641   12
1  422  213
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.82325584, 'precision': 0.861585, 'recall': 0.8232558, 'specificity': 0.8232558, 'f1': 0.8184445, 'auroc': 0.9333045, 'binary_precision': 0.97931033, 'binary_recall': 0.6604651, 'binary_specificity': 0.9860465, 'binary_f1_score': 0.7888889}
confusion matrix:
     0    1
0  212    3
1   73  142
new oracle model saved
early stop counter: 5
val acc:0.6630434989929199, best validation acc: 0.8175466060638428, corresponding to test acc:                         0.804651141166687 / 0.8232558369636536
after epoch: 11,now: 2024-07-27 01:28:03.768813,epoch time: 0:00:46.384902,used: 0:08:34.241142,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_01_19_28_seed_0_23090481
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 11 with time: 0:08:34.241142 at 2024-07-27 01:28:03.768813
persisted model performance metric: 

scalar performance:
{'acc': 0.80465114, 'precision': 0.82357943, 'recall': 0.80465114, 'specificity': 0.80465114, 'f1': 0.801752, 'auroc': 0.9220768, 'binary_precision': 0.74531835, 'binary_recall': 0.9255814, 'binary_specificity': 0.68372095, 'binary_f1_score': 0.8257261}
confusion matrix:
     0    1
0  147   68
1   16  199
oracle model performance metric: 

scalar performance:
{'acc': 0.82325584, 'precision': 0.861585, 'recall': 0.8232558, 'specificity': 0.8232558, 'f1': 0.8184445, 'auroc': 0.9333045, 'binary_precision': 0.97931033, 'binary_recall': 0.6604651, 'binary_specificity': 0.9860465, 'binary_f1_score': 0.7888889}
confusion matrix:
     0    1
0  212    3
1   73  142
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_diva_irm_3seeds_nofreeze_2024-07-27_01-18-02/rule_results/19.csv
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_diva_irm_3seeds_nofreeze_2024-07-27_01-18-02/rule_results/19.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_diva_irm_3seeds_nofreeze_2024-07-27_01-18-02/confusion_matrix/19.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    964 MiB |  13736 MiB |  27226 GiB |  27225 GiB |
|       from large pool |    903 MiB |  13677 MiB |  26887 GiB |  26886 GiB |
|       from small pool |     60 MiB |     97 MiB |    339 GiB |    339 GiB |
|---------------------------------------------------------------------------|
| Active memory         |    964 MiB |  13736 MiB |  27226 GiB |  27225 GiB |
|       from large pool |    903 MiB |  13677 MiB |  26887 GiB |  26886 GiB |
|       from small pool |     60 MiB |     97 MiB |    339 GiB |    339 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |    951 MiB |  13728 MiB |  27201 GiB |  27200 GiB |
|       from large pool |    891 MiB |  13669 MiB |  26863 GiB |  26862 GiB |
|       from small pool |     60 MiB |     97 MiB |    338 GiB |    338 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  14868 MiB |  14868 MiB |  14868 MiB |      0 B   |
|       from large pool |  14762 MiB |  14762 MiB |  14762 MiB |      0 B   |
|       from small pool |    106 MiB |    106 MiB |    106 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |   1821 MiB |   2290 MiB |  21446 GiB |  21444 GiB |
|       from large pool |   1812 MiB |   2283 MiB |  21106 GiB |  21104 GiB |
|       from small pool |      9 MiB |     17 MiB |    340 GiB |    340 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    1784    |    3095    |    4890 K  |    4889 K  |
|       from large pool |     265    |    1491    |    2428 K  |    2428 K  |
|       from small pool |    1519    |    2211    |    2461 K  |    2460 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    1784    |    3095    |    4890 K  |    4889 K  |
|       from large pool |     265    |    1491    |    2428 K  |    2428 K  |
|       from small pool |    1519    |    2211    |    2461 K  |    2460 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     585    |     585    |     585    |       0    |
|       from large pool |     532    |     532    |     532    |       0    |
|       from small pool |      53    |      53    |      53    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     127    |     574    |    3106 K  |    3106 K  |
|       from large pool |      52    |     528    |    1716 K  |    1716 K  |
|       from small pool |      75    |     234    |    1390 K  |    1389 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  65536 KiB |  13736 MiB |  27226 GiB |  27226 GiB |
|       from large pool |  65536 KiB |  13677 MiB |  26887 GiB |  26887 GiB |
|       from small pool |      0 KiB |     97 MiB |    339 GiB |    339 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  65536 KiB |  13736 MiB |  27226 GiB |  27226 GiB |
|       from large pool |  65536 KiB |  13677 MiB |  26887 GiB |  26887 GiB |
|       from small pool |      0 KiB |     97 MiB |    339 GiB |    339 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  65536 KiB |  13728 MiB |  27201 GiB |  27201 GiB |
|       from large pool |  65536 KiB |  13669 MiB |  26863 GiB |  26863 GiB |
|       from small pool |      0 KiB |     97 MiB |    338 GiB |    338 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2786 MiB |  14868 MiB |  14868 MiB |  12082 MiB |
|       from large pool |   2716 MiB |  14762 MiB |  14762 MiB |  12046 MiB |
|       from small pool |     70 MiB |    106 MiB |    106 MiB |     36 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  43008 KiB |   2290 MiB |  21447 GiB |  21447 GiB |
|       from large pool |  43008 KiB |   2283 MiB |  21106 GiB |  21106 GiB |
|       from small pool |      0 KiB |     41 MiB |    340 GiB |    340 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3095    |    4890 K  |    4890 K  |
|       from large pool |       2    |    1491    |    2428 K  |    2428 K  |
|       from small pool |       0    |    2211    |    2461 K  |    2461 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3095    |    4890 K  |    4890 K  |
|       from large pool |       2    |    1491    |    2428 K  |    2428 K  |
|       from small pool |       0    |    2211    |    2461 K  |    2461 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      91    |     585    |     585    |     494    |
|       from large pool |      56    |     532    |     532    |     476    |
|       from small pool |      35    |      53    |      53    |      18    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       1    |     574    |    3106 K  |    3106 K  |
|       from large pool |       1    |     528    |    1716 K  |    1716 K  |
|       from small pool |       0    |     234    |    1390 K  |    1390 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  65536 KiB |  13736 MiB |  27226 GiB |  27226 GiB |
|       from large pool |  65536 KiB |  13677 MiB |  26887 GiB |  26887 GiB |
|       from small pool |      0 KiB |     97 MiB |    339 GiB |    339 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  65536 KiB |  13736 MiB |  27226 GiB |  27226 GiB |
|       from large pool |  65536 KiB |  13677 MiB |  26887 GiB |  26887 GiB |
|       from small pool |      0 KiB |     97 MiB |    339 GiB |    339 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  65536 KiB |  13728 MiB |  27201 GiB |  27201 GiB |
|       from large pool |  65536 KiB |  13669 MiB |  26863 GiB |  26863 GiB |
|       from small pool |      0 KiB |     97 MiB |    338 GiB |    338 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2786 MiB |  14868 MiB |  14868 MiB |  12082 MiB |
|       from large pool |   2716 MiB |  14762 MiB |  14762 MiB |  12046 MiB |
|       from small pool |     70 MiB |    106 MiB |    106 MiB |     36 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  43008 KiB |   2290 MiB |  21447 GiB |  21447 GiB |
|       from large pool |  43008 KiB |   2283 MiB |  21106 GiB |  21106 GiB |
|       from small pool |      0 KiB |     41 MiB |    340 GiB |    340 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3095    |    4890 K  |    4890 K  |
|       from large pool |       2    |    1491    |    2428 K  |    2428 K  |
|       from small pool |       0    |    2211    |    2461 K  |    2461 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3095    |    4890 K  |    4890 K  |
|       from large pool |       2    |    1491    |    2428 K  |    2428 K  |
|       from small pool |       0    |    2211    |    2461 K  |    2461 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      91    |     585    |     585    |     494    |
|       from large pool |      56    |     532    |     532    |     476    |
|       from small pool |      35    |      53    |      53    |      18    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       1    |     574    |    3106 K  |    3106 K  |
|       from large pool |       1    |     528    |    1716 K  |    1716 K  |
|       from small pool |       0    |     234    |    1390 K  |    1390 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/init.py:452: UserWarning: Initializing zero-element tensors is a no-op
  warnings.warn("Initializing zero-element tensors is a no-op")
Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main

using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_01_28_29_seed_1_23090481

 Experiment start at: 2024-07-27 01:28:29.466928
before training, model accuracy: 0.5155555605888367
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9420573, 'precision': 0.94392866, 'recall': 0.9416779, 'specificity': 0.9416779, 'f1': 0.94195336, 'auroc': 0.9905309, 'binary_precision': 0.91803277, 'binary_recall': 0.97234726, 'binary_specificity': 0.9110086, 'binary_f1_score': 0.9444097}
confusion matrix:
      0     1
0  1382   135
1    43  1512
---- Validation: 
scalar performance:
{'acc': 0.7275566, 'precision': 0.78700435, 'recall': 0.731234, 'specificity': 0.731234, 'f1': 0.7146933, 'auroc': 0.8908663, 'binary_precision': 0.652221, 'binary_recall': 0.95555556, 'binary_specificity': 0.50691247, 'binary_f1_score': 0.7752737}
confusion matrix:
     0    1
0  330  321
1   28  602
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7266667, 'precision': 0.77584136, 'recall': 0.7266667, 'specificity': 0.7266667, 'f1': 0.71391654, 'auroc': 0.90945184, 'binary_precision': 0.659375, 'binary_recall': 0.93777776, 'binary_specificity': 0.51555556, 'binary_f1_score': 0.77431196}
confusion matrix:
     0    1
0  116  109
1   14  211
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-27 01:29:21.601360,epoch time: 0:00:52.134432,used: 0:00:52.134432,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_01_28_29_seed_1_23090481
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.96972656, 'precision': 0.97018343, 'recall': 0.9699836, 'specificity': 0.9699836, 'f1': 0.9697256, 'auroc': 0.9953126, 'binary_precision': 0.9886515, 'binary_recall': 0.9511882, 'binary_specificity': 0.9887789, 'binary_f1_score': 0.9695581}
confusion matrix:
      0     1
0  1498    17
1    76  1481
---- Validation: 
scalar performance:
{'acc': 0.80093676, 'precision': 0.80263996, 'recall': 0.80028164, 'specificity': 0.80028164, 'f1': 0.80037427, 'auroc': 0.88003314, 'binary_precision': 0.82161236, 'binary_recall': 0.76031744, 'binary_specificity': 0.8402458, 'binary_f1_score': 0.7897774}
confusion matrix:
     0    1
0  547  104
1  151  479
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8422222, 'precision': 0.84375, 'recall': 0.8422222, 'specificity': 0.8422222, 'f1': 0.84204674, 'auroc': 0.90328884, 'binary_precision': 0.8666667, 'binary_recall': 0.8088889, 'binary_specificity': 0.8755556, 'binary_f1_score': 0.8367816}
confusion matrix:
     0    1
0  197   28
1   43  182
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-07-27 01:30:09.182179,epoch time: 0:00:47.580819,used: 0:01:39.715251,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_01_28_29_seed_1_23090481
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.96028644, 'precision': 0.96165735, 'recall': 0.9606131, 'specificity': 0.9606131, 'f1': 0.9602723, 'auroc': 0.99206585, 'binary_precision': 0.98973304, 'binary_recall': 0.9311011, 'binary_specificity': 0.99012506, 'binary_f1_score': 0.95952225}
confusion matrix:
      0     1
0  1504    15
1   107  1446
---- Validation: 
scalar performance:
{'acc': 0.77205306, 'precision': 0.81739616, 'recall': 0.7689196, 'specificity': 0.7689196, 'f1': 0.76218057, 'auroc': 0.90667164, 'binary_precision': 0.93333334, 'binary_recall': 0.5777778, 'binary_specificity': 0.96006143, 'binary_f1_score': 0.71372557}
confusion matrix:
     0    1
0  625   26
1  266  364
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8511111, 'precision': 0.87896556, 'recall': 0.8511111, 'specificity': 0.8511111, 'f1': 0.84832406, 'auroc': 0.91652346, 'binary_precision': 0.98170733, 'binary_recall': 0.71555555, 'binary_specificity': 0.9866667, 'binary_f1_score': 0.8277635}
confusion matrix:
     0    1
0  222    3
1   64  161
new oracle model saved
early stop counter: 1
val acc:0.772053062915802, best validation acc: 0.800936758518219, corresponding to test acc:                         0.8422222137451172 / 0.851111114025116
after epoch: 3,now: 2024-07-27 01:30:56.453508,epoch time: 0:00:47.271329,used: 0:02:26.986580,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_01_28_29_seed_1_23090481
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9563802, 'precision': 0.95949215, 'recall': 0.9568299, 'specificity': 0.9568299, 'f1': 0.9563321, 'auroc': 0.99711585, 'binary_precision': 1.0, 'binary_recall': 0.9136598, 'binary_specificity': 1.0, 'binary_f1_score': 0.95488214}
confusion matrix:
      0     1
0  1520     0
1   134  1418
---- Validation: 
scalar performance:
{'acc': 0.7150664, 'precision': 0.79438245, 'recall': 0.71075267, 'specificity': 0.71075267, 'f1': 0.6917947, 'auroc': 0.88926196, 'binary_precision': 0.9431438, 'binary_recall': 0.44761905, 'binary_specificity': 0.9738863, 'binary_f1_score': 0.6071044}
confusion matrix:
     0    1
0  634   17
1  348  282
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.82222223, 'precision': 0.85898197, 'recall': 0.82222223, 'specificity': 0.82222223, 'f1': 0.81755155, 'auroc': 0.89969385, 'binary_precision': 0.9738562, 'binary_recall': 0.6622222, 'binary_specificity': 0.9822222, 'binary_f1_score': 0.7883598}
confusion matrix:
     0    1
0  221    4
1   76  149
early stop counter: 2
val acc:0.7150663733482361, best validation acc: 0.800936758518219, corresponding to test acc:                         0.8422222137451172 / 0.851111114025116
after epoch: 4,now: 2024-07-27 01:31:43.359738,epoch time: 0:00:46.906230,used: 0:03:13.892810,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_01_28_29_seed_1_23090481
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9820964, 'precision': 0.9820802, 'recall': 0.9821569, 'specificity': 0.9821569, 'f1': 0.9820951, 'auroc': 0.99838006, 'binary_precision': 0.9870214, 'binary_recall': 0.9775064, 'binary_specificity': 0.9868074, 'binary_f1_score': 0.98224086}
confusion matrix:
      0     1
0  1496    20
1    35  1521
---- Validation: 
scalar performance:
{'acc': 0.8485558, 'precision': 0.8557078, 'recall': 0.8473886, 'specificity': 0.8473886, 'f1': 0.8474513, 'auroc': 0.90066564, 'binary_precision': 0.90221405, 'binary_recall': 0.77619046, 'binary_specificity': 0.9185868, 'binary_f1_score': 0.834471}
confusion matrix:
     0    1
0  598   53
1  141  489
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.88, 'precision': 0.8824477, 'recall': 0.88, 'specificity': 0.88, 'f1': 0.8798077, 'auroc': 0.9211259, 'binary_precision': 0.9130435, 'binary_recall': 0.84, 'binary_specificity': 0.92, 'binary_f1_score': 0.875}
confusion matrix:
     0    1
0  207   18
1   36  189
new oracle model saved
better model found
persisted
after epoch: 5,now: 2024-07-27 01:32:31.163774,epoch time: 0:00:47.804036,used: 0:04:01.696846,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_01_28_29_seed_1_23090481
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9860026, 'precision': 0.98603106, 'recall': 0.98612565, 'specificity': 0.98612565, 'f1': 0.98600215, 'auroc': 0.99941075, 'binary_precision': 0.99477464, 'binary_recall': 0.9775353, 'binary_specificity': 0.994716, 'binary_f1_score': 0.98607963}
confusion matrix:
      0     1
0  1506     8
1    35  1523
---- Validation: 
scalar performance:
{'acc': 0.7619048, 'precision': 0.805842, 'recall': 0.75875574, 'specificity': 0.75875574, 'f1': 0.75151, 'auroc': 0.885134, 'binary_precision': 0.9177378, 'binary_recall': 0.56666666, 'binary_specificity': 0.9508448, 'binary_f1_score': 0.70068693}
confusion matrix:
     0    1
0  619   32
1  273  357
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8688889, 'precision': 0.8715383, 'recall': 0.86888885, 'specificity': 0.86888885, 'f1': 0.8686547, 'auroc': 0.91703707, 'binary_precision': 0.9029126, 'binary_recall': 0.82666665, 'binary_specificity': 0.9111111, 'binary_f1_score': 0.86310905}
confusion matrix:
     0    1
0  205   20
1   39  186
early stop counter: 1
val acc:0.761904776096344, best validation acc: 0.8485558032989502, corresponding to test acc:                         0.8799999952316284 / 0.8799999952316284
after epoch: 6,now: 2024-07-27 01:33:17.997375,epoch time: 0:00:46.833601,used: 0:04:48.530447,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_01_28_29_seed_1_23090481
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.98079425, 'precision': 0.9811776, 'recall': 0.98099387, 'specificity': 0.98099387, 'f1': 0.9807937, 'auroc': 0.99863505, 'binary_precision': 0.99800134, 'binary_recall': 0.963964, 'binary_specificity': 0.9980237, 'binary_f1_score': 0.9806874}
confusion matrix:
      0     1
0  1515     3
1    56  1498
---- Validation: 
scalar performance:
{'acc': 0.8360656, 'precision': 0.8497679, 'recall': 0.8344342, 'specificity': 0.8344342, 'f1': 0.8339379, 'auroc': 0.9121523, 'binary_precision': 0.91501975, 'binary_recall': 0.7349206, 'binary_specificity': 0.9339478, 'binary_f1_score': 0.81514084}
confusion matrix:
     0    1
0  608   43
1  167  463
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.86, 'precision': 0.875, 'recall': 0.86, 'specificity': 0.86, 'f1': 0.85858583, 'auroc': 0.9219556, 'binary_precision': 0.95, 'binary_recall': 0.76, 'binary_specificity': 0.96, 'binary_f1_score': 0.84444445}
confusion matrix:
     0    1
0  216    9
1   54  171
early stop counter: 2
val acc:0.8360655903816223, best validation acc: 0.8485558032989502, corresponding to test acc:                         0.8799999952316284 / 0.8799999952316284
after epoch: 7,now: 2024-07-27 01:34:05.094112,epoch time: 0:00:47.096737,used: 0:05:35.627184,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_01_28_29_seed_1_23090481
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9791667, 'precision': 0.9797468, 'recall': 0.9794345, 'specificity': 0.9794345, 'f1': 0.97916543, 'auroc': 0.9991441, 'binary_precision': 1.0, 'binary_recall': 0.9588689, 'binary_specificity': 1.0, 'binary_f1_score': 0.9790026}
confusion matrix:
      0     1
0  1516     0
1    64  1492
---- Validation: 
scalar performance:
{'acc': 0.78142077, 'precision': 0.8223424, 'recall': 0.778469, 'specificity': 0.778469, 'f1': 0.77298045, 'auroc': 0.9100627, 'binary_precision': 0.9331683, 'binary_recall': 0.5984127, 'binary_specificity': 0.95852536, 'binary_f1_score': 0.729207}
confusion matrix:
     0    1
0  624   27
1  253  377
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8066667, 'precision': 0.85771894, 'recall': 0.8066667, 'specificity': 0.8066667, 'f1': 0.7995135, 'auroc': 0.92709136, 'binary_precision': 0.99285716, 'binary_recall': 0.61777776, 'binary_specificity': 0.9955556, 'binary_f1_score': 0.7616438}
confusion matrix:
     0    1
0  224    1
1   86  139
early stop counter: 3
val acc:0.7814207673072815, best validation acc: 0.8485558032989502, corresponding to test acc:                         0.8799999952316284 / 0.8799999952316284
after epoch: 8,now: 2024-07-27 01:34:52.099954,epoch time: 0:00:47.005842,used: 0:06:22.633026,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_01_28_29_seed_1_23090481
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.98502606, 'precision': 0.9850353, 'recall': 0.9851168, 'specificity': 0.9851168, 'f1': 0.9850255, 'auroc': 0.9992852, 'binary_precision': 0.9921773, 'binary_recall': 0.9781491, 'binary_specificity': 0.99208444, 'binary_f1_score': 0.98511326}
confusion matrix:
      0     1
0  1504    12
1    34  1522
---- Validation: 
scalar performance:
{'acc': 0.86729115, 'precision': 0.8767128, 'recall': 0.866001, 'specificity': 0.866001, 'f1': 0.86613595, 'auroc': 0.9202326, 'binary_precision': 0.93233085, 'binary_recall': 0.7873016, 'binary_specificity': 0.9447005, 'binary_f1_score': 0.8537005}
confusion matrix:
     0    1
0  615   36
1  134  496
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8333333, 'precision': 0.84478176, 'recall': 0.8333334, 'specificity': 0.8333334, 'f1': 0.8319382, 'auroc': 0.9080889, 'binary_precision': 0.9076087, 'binary_recall': 0.74222225, 'binary_specificity': 0.92444444, 'binary_f1_score': 0.8166259}
confusion matrix:
     0    1
0  208   17
1   58  167
better model found
persisted
after epoch: 9,now: 2024-07-27 01:35:39.508556,epoch time: 0:00:47.408602,used: 0:07:10.041628,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_01_28_29_seed_1_23090481
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9827474, 'precision': 0.9830015, 'recall': 0.9829534, 'specificity': 0.9829534, 'f1': 0.9827473, 'auroc': 0.9987689, 'binary_precision': 0.99801326, 'binary_recall': 0.967887, 'binary_specificity': 0.9980198, 'binary_f1_score': 0.9827193}
confusion matrix:
      0     1
0  1512     3
1    50  1507
---- Validation: 
scalar performance:
{'acc': 0.77517563, 'precision': 0.8228992, 'recall': 0.77199185, 'specificity': 0.77199185, 'f1': 0.76512414, 'auroc': 0.92238134, 'binary_precision': 0.9430052, 'binary_recall': 0.5777778, 'binary_specificity': 0.96620584, 'binary_f1_score': 0.7165355}
confusion matrix:
     0    1
0  629   22
1  266  364
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.82222223, 'precision': 0.8567523, 'recall': 0.82222223, 'specificity': 0.82222223, 'f1': 0.81781375, 'auroc': 0.9164444, 'binary_precision': 0.9677419, 'binary_recall': 0.6666667, 'binary_specificity': 0.9777778, 'binary_f1_score': 0.78947365}
confusion matrix:
     0    1
0  220    5
1   75  150
early stop counter: 1
val acc:0.7751756310462952, best validation acc: 0.8672911524772644, corresponding to test acc:                         0.8333333134651184 / 0.8799999952316284
after epoch: 10,now: 2024-07-27 01:36:26.510695,epoch time: 0:00:47.002139,used: 0:07:57.043767,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_01_28_29_seed_1_23090481
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9788411, 'precision': 0.9793564, 'recall': 0.9786836, 'specificity': 0.9786836, 'f1': 0.97882783, 'auroc': 0.99889195, 'binary_precision': 0.9661654, 'binary_recall': 0.99291694, 'binary_specificity': 0.9644503, 'binary_f1_score': 0.97935855}
confusion matrix:
      0     1
0  1465    54
1    11  1542
---- Validation: 
scalar performance:
{'acc': 0.87119436, 'precision': 0.87210405, 'recall': 0.8707885, 'specificity': 0.8707885, 'f1': 0.8709978, 'auroc': 0.9189726, 'binary_precision': 0.88685524, 'binary_recall': 0.8460317, 'binary_specificity': 0.8955453, 'binary_f1_score': 0.8659626}
confusion matrix:
     0    1
0  583   68
1   97  533
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8755556, 'precision': 0.88235295, 'recall': 0.8755556, 'specificity': 0.8755556, 'f1': 0.875, 'auroc': 0.9292444, 'binary_precision': 0.93333334, 'binary_recall': 0.8088889, 'binary_specificity': 0.94222224, 'binary_f1_score': 0.8666666}
confusion matrix:
     0    1
0  212   13
1   43  182
better model found
persisted
after epoch: 11,now: 2024-07-27 01:37:13.956402,epoch time: 0:00:47.445707,used: 0:08:44.489474,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_01_28_29_seed_1_23090481
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.98079425, 'precision': 0.98117155, 'recall': 0.9806504, 'specificity': 0.9806504, 'f1': 0.98078346, 'auroc': 0.99850404, 'binary_precision': 0.97044027, 'binary_recall': 0.992283, 'binary_specificity': 0.9690178, 'binary_f1_score': 0.9812401}
confusion matrix:
      0     1
0  1470    47
1    12  1543
---- Validation: 
scalar performance:
{'acc': 0.84074944, 'precision': 0.84425974, 'recall': 0.84157705, 'specificity': 0.84157705, 'f1': 0.8405348, 'auroc': 0.9155872, 'binary_precision': 0.8051576, 'binary_recall': 0.8920635, 'binary_specificity': 0.7910906, 'binary_f1_score': 0.8463856}
confusion matrix:
     0    1
0  515  136
1   68  562
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.84, 'precision': 0.8402419, 'recall': 0.84000003, 'specificity': 0.84000003, 'f1': 0.83997154, 'auroc': 0.9140543, 'binary_precision': 0.84931505, 'binary_recall': 0.82666665, 'binary_specificity': 0.85333335, 'binary_f1_score': 0.8378378}
confusion matrix:
     0    1
0  192   33
1   39  186
early stop counter: 1
val acc:0.8407494425773621, best validation acc: 0.8711943626403809, corresponding to test acc:                         0.8755555748939514 / 0.8799999952316284
after epoch: 12,now: 2024-07-27 01:38:01.024525,epoch time: 0:00:47.068123,used: 0:09:31.557597,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_01_28_29_seed_1_23090481
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.98014325, 'precision': 0.98053694, 'recall': 0.9803318, 'specificity': 0.9803318, 'f1': 0.9801425, 'auroc': 0.99867487, 'binary_precision': 0.99733335, 'binary_recall': 0.96329683, 'binary_specificity': 0.99736667, 'binary_f1_score': 0.9800196}
confusion matrix:
      0     1
0  1515     4
1    57  1496
---- Validation: 
scalar performance:
{'acc': 0.8516784, 'precision': 0.870744, 'recall': 0.8498208, 'specificity': 0.8498208, 'f1': 0.8492374, 'auroc': 0.93634945, 'binary_precision': 0.9508197, 'binary_recall': 0.73650795, 'binary_specificity': 0.96313363, 'binary_f1_score': 0.8300537}
confusion matrix:
     0    1
0  627   24
1  166  464
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8511111, 'precision': 0.8717375, 'recall': 0.8511111, 'specificity': 0.8511111, 'f1': 0.8490167, 'auroc': 0.91630614, 'binary_precision': 0.9593023, 'binary_recall': 0.73333335, 'binary_specificity': 0.9688889, 'binary_f1_score': 0.8312342}
confusion matrix:
     0    1
0  218    7
1   60  165
early stop counter: 2
val acc:0.8516783714294434, best validation acc: 0.8711943626403809, corresponding to test acc:                         0.8755555748939514 / 0.8799999952316284
after epoch: 13,now: 2024-07-27 01:38:47.990451,epoch time: 0:00:46.965926,used: 0:10:18.523523,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_01_28_29_seed_1_23090481
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9820964, 'precision': 0.98251927, 'recall': 0.98193645, 'specificity': 0.98193645, 'f1': 0.9820851, 'auroc': 0.99945986, 'binary_precision': 0.9711237, 'binary_recall': 0.99421597, 'binary_specificity': 0.969657, 'binary_f1_score': 0.98253417}
confusion matrix:
      0     1
0  1470    46
1     9  1547
---- Validation: 
scalar performance:
{'acc': 0.8680718, 'precision': 0.8681635, 'recall': 0.8679211, 'specificity': 0.8679211, 'f1': 0.86799943, 'auroc': 0.9235681, 'binary_precision': 0.8711755, 'binary_recall': 0.85873014, 'binary_specificity': 0.87711215, 'binary_f1_score': 0.8649081}
confusion matrix:
     0    1
0  571   80
1   89  541
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8422222, 'precision': 0.8433685, 'recall': 0.8422222, 'specificity': 0.8422222, 'f1': 0.84209037, 'auroc': 0.9087012, 'binary_precision': 0.8632075, 'binary_recall': 0.81333333, 'binary_specificity': 0.8711111, 'binary_f1_score': 0.8375286}
confusion matrix:
     0    1
0  196   29
1   42  183
early stop counter: 3
val acc:0.8680717945098877, best validation acc: 0.8711943626403809, corresponding to test acc:                         0.8755555748939514 / 0.8799999952316284
after epoch: 14,now: 2024-07-27 01:39:34.820064,epoch time: 0:00:46.829613,used: 0:11:05.353136,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_01_28_29_seed_1_23090481
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9863281, 'precision': 0.9864087, 'recall': 0.98646146, 'specificity': 0.98646146, 'f1': 0.98632807, 'auroc': 0.99949807, 'binary_precision': 0.9967192, 'binary_recall': 0.9762211, 'binary_specificity': 0.99670184, 'binary_f1_score': 0.9863637}
confusion matrix:
      0     1
0  1511     5
1    37  1519
---- Validation: 
scalar performance:
{'acc': 0.8040593, 'precision': 0.84214294, 'recall': 0.80130565, 'specificity': 0.80130565, 'f1': 0.7974145, 'auroc': 0.9264599, 'binary_precision': 0.9522673, 'binary_recall': 0.6333333, 'binary_specificity': 0.96927804, 'binary_f1_score': 0.7607245}
confusion matrix:
     0    1
0  631   20
1  231  399
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8488889, 'precision': 0.8755981, 'recall': 0.8488889, 'specificity': 0.8488889, 'f1': 0.84615386, 'auroc': 0.9160888, 'binary_precision': 0.9757576, 'binary_recall': 0.71555555, 'binary_specificity': 0.9822222, 'binary_f1_score': 0.82564104}
confusion matrix:
     0    1
0  221    4
1   64  161
early stop counter: 4
val acc:0.8040593266487122, best validation acc: 0.8711943626403809, corresponding to test acc:                         0.8755555748939514 / 0.8799999952316284
after epoch: 15,now: 2024-07-27 01:40:21.656364,epoch time: 0:00:46.836300,used: 0:11:52.189436,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_01_28_29_seed_1_23090481
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9811198, 'precision': 0.98148537, 'recall': 0.9813156, 'specificity': 0.9813156, 'f1': 0.9811193, 'auroc': 0.99934167, 'binary_precision': 0.99800265, 'binary_recall': 0.9646075, 'binary_specificity': 0.9980237, 'binary_f1_score': 0.9810209}
confusion matrix:
      0     1
0  1515     3
1    55  1499
---- Validation: 
scalar performance:
{'acc': 0.7423888, 'precision': 0.8025919, 'recall': 0.73868406, 'specificity': 0.73868406, 'f1': 0.7269074, 'auroc': 0.8986974, 'binary_precision': 0.93352604, 'binary_recall': 0.5126984, 'binary_specificity': 0.96466976, 'binary_f1_score': 0.66188526}
confusion matrix:
     0    1
0  628   23
1  307  323
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.78, 'precision': 0.8319361, 'recall': 0.78, 'specificity': 0.78, 'f1': 0.77104414, 'auroc': 0.9108988, 'binary_precision': 0.9632353, 'binary_recall': 0.5822222, 'binary_specificity': 0.9777778, 'binary_f1_score': 0.7257618}
confusion matrix:
     0    1
0  220    5
1   94  131
early stop counter: 5
val acc:0.7423887848854065, best validation acc: 0.8711943626403809, corresponding to test acc:                         0.8755555748939514 / 0.8799999952316284
after epoch: 16,now: 2024-07-27 01:41:08.619647,epoch time: 0:00:46.963283,used: 0:12:39.152719,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_01_28_29_seed_1_23090481
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 16 with time: 0:12:39.152719 at 2024-07-27 01:41:08.619647
persisted model performance metric: 

scalar performance:
{'acc': 0.8755556, 'precision': 0.88235295, 'recall': 0.8755556, 'specificity': 0.8755556, 'f1': 0.875, 'auroc': 0.9292444, 'binary_precision': 0.93333334, 'binary_recall': 0.8088889, 'binary_specificity': 0.94222224, 'binary_f1_score': 0.8666666}
confusion matrix:
     0    1
0  212   13
1   43  182
oracle model performance metric: 

scalar performance:
{'acc': 0.88, 'precision': 0.8824477, 'recall': 0.88, 'specificity': 0.88, 'f1': 0.8798077, 'auroc': 0.9211259, 'binary_precision': 0.9130435, 'binary_recall': 0.84, 'binary_specificity': 0.92, 'binary_f1_score': 0.875}
confusion matrix:
     0    1
0  207   18
1   36  189
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_diva_irm_3seeds_nofreeze_2024-07-27_01-18-02/rule_results/19.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_diva_irm_3seeds_nofreeze_2024-07-27_01-18-02/confusion_matrix/19.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    964 MiB |  13737 MiB |  67723 GiB |  67722 GiB |
|       from large pool |    904 MiB |  13678 MiB |  66880 GiB |  66879 GiB |
|       from small pool |     60 MiB |    100 MiB |    843 GiB |    843 GiB |
|---------------------------------------------------------------------------|
| Active memory         |    964 MiB |  13737 MiB |  67723 GiB |  67722 GiB |
|       from large pool |    904 MiB |  13678 MiB |  66880 GiB |  66879 GiB |
|       from small pool |     60 MiB |    100 MiB |    843 GiB |    843 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |    951 MiB |  13728 MiB |  67664 GiB |  67663 GiB |
|       from large pool |    891 MiB |  13669 MiB |  66822 GiB |  66821 GiB |
|       from small pool |     60 MiB |    100 MiB |    841 GiB |    841 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  14790 MiB |  14868 MiB |  26872 MiB |  12082 MiB |
|       from large pool |  14678 MiB |  14762 MiB |  26724 MiB |  12046 MiB |
|       from small pool |    112 MiB |    112 MiB |    148 MiB |     36 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |   1481 MiB |   2736 MiB |  53909 GiB |  53907 GiB |
|       from large pool |   1469 MiB |   2727 MiB |  53061 GiB |  53060 GiB |
|       from small pool |     11 MiB |     41 MiB |    847 GiB |    847 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    1796    |    3099    |   12137 K  |   12135 K  |
|       from large pool |     265    |    1491    |    6037 K  |    6036 K  |
|       from small pool |    1531    |    2223    |    6100 K  |    6098 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    1796    |    3099    |   12137 K  |   12135 K  |
|       from large pool |     265    |    1491    |    6037 K  |    6036 K  |
|       from small pool |    1531    |    2223    |    6100 K  |    6098 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     546    |     585    |    1040    |     494    |
|       from large pool |     490    |     532    |     966    |     476    |
|       from small pool |      56    |      56    |      74    |      18    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     131    |     574    |    7752 K  |    7752 K  |
|       from large pool |      48    |     528    |    4317 K  |    4317 K  |
|       from small pool |      83    |     239    |    3434 K  |    3434 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  65536 KiB |  13737 MiB |  67723 GiB |  67723 GiB |
|       from large pool |  65536 KiB |  13678 MiB |  66880 GiB |  66880 GiB |
|       from small pool |      0 KiB |    100 MiB |    843 GiB |    843 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  65536 KiB |  13737 MiB |  67723 GiB |  67723 GiB |
|       from large pool |  65536 KiB |  13678 MiB |  66880 GiB |  66880 GiB |
|       from small pool |      0 KiB |    100 MiB |    843 GiB |    843 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  65536 KiB |  13728 MiB |  67664 GiB |  67664 GiB |
|       from large pool |  65536 KiB |  13669 MiB |  66822 GiB |  66822 GiB |
|       from small pool |      0 KiB |    100 MiB |    841 GiB |    841 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2446 MiB |  14868 MiB |  26872 MiB |  24426 MiB |
|       from large pool |   2374 MiB |  14762 MiB |  26724 MiB |  24350 MiB |
|       from small pool |     72 MiB |    112 MiB |    148 MiB |     76 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  43008 KiB |   2736 MiB |  53909 GiB |  53909 GiB |
|       from large pool |  43008 KiB |   2727 MiB |  53061 GiB |  53061 GiB |
|       from small pool |      0 KiB |     43 MiB |    847 GiB |    847 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3099    |   12137 K  |   12137 K  |
|       from large pool |       2    |    1491    |    6037 K  |    6037 K  |
|       from small pool |       0    |    2223    |    6100 K  |    6100 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3099    |   12137 K  |   12137 K  |
|       from large pool |       2    |    1491    |    6037 K  |    6037 K  |
|       from small pool |       0    |    2223    |    6100 K  |    6100 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      91    |     585    |    1040    |     949    |
|       from large pool |      55    |     532    |     966    |     911    |
|       from small pool |      36    |      56    |      74    |      38    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       1    |     574    |    7752 K  |    7752 K  |
|       from large pool |       1    |     528    |    4317 K  |    4317 K  |
|       from small pool |       0    |     239    |    3434 K  |    3434 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  65536 KiB |  13737 MiB |  67723 GiB |  67723 GiB |
|       from large pool |  65536 KiB |  13678 MiB |  66880 GiB |  66880 GiB |
|       from small pool |      0 KiB |    100 MiB |    843 GiB |    843 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  65536 KiB |  13737 MiB |  67723 GiB |  67723 GiB |
|       from large pool |  65536 KiB |  13678 MiB |  66880 GiB |  66880 GiB |
|       from small pool |      0 KiB |    100 MiB |    843 GiB |    843 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  65536 KiB |  13728 MiB |  67664 GiB |  67664 GiB |
|       from large pool |  65536 KiB |  13669 MiB |  66822 GiB |  66822 GiB |
|       from small pool |      0 KiB |    100 MiB |    841 GiB |    841 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2446 MiB |  14868 MiB |  26872 MiB |  24426 MiB |
|       from large pool |   2374 MiB |  14762 MiB |  26724 MiB |  24350 MiB |
|       from small pool |     72 MiB |    112 MiB |    148 MiB |     76 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  43008 KiB |   2736 MiB |  53909 GiB |  53909 GiB |
|       from large pool |  43008 KiB |   2727 MiB |  53061 GiB |  53061 GiB |
|       from small pool |      0 KiB |     43 MiB |    847 GiB |    847 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3099    |   12137 K  |   12137 K  |
|       from large pool |       2    |    1491    |    6037 K  |    6037 K  |
|       from small pool |       0    |    2223    |    6100 K  |    6100 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3099    |   12137 K  |   12137 K  |
|       from large pool |       2    |    1491    |    6037 K  |    6037 K  |
|       from small pool |       0    |    2223    |    6100 K  |    6100 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      91    |     585    |    1040    |     949    |
|       from large pool |      55    |     532    |     966    |     911    |
|       from small pool |      36    |      56    |      74    |      38    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       1    |     574    |    7752 K  |    7752 K  |
|       from large pool |       1    |     528    |    4317 K  |    4317 K  |
|       from small pool |       0    |     239    |    3434 K  |    3434 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/init.py:452: UserWarning: Initializing zero-element tensors is a no-op
  warnings.warn("Initializing zero-element tensors is a no-op")
Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main

using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_01_41_36_seed_2_23090481

 Experiment start at: 2024-07-27 01:41:36.393208
before training, model accuracy: 0.6134259104728699
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9518979, 'precision': 0.9521637, 'recall': 0.95200545, 'specificity': 0.95200545, 'f1': 0.95189595, 'auroc': 0.9896948, 'binary_precision': 0.96526384, 'binary_recall': 0.9383117, 'binary_specificity': 0.9656992, 'binary_f1_score': 0.9515969}
confusion matrix:
      0     1
0  1464    52
1    95  1445
---- Validation: 
scalar performance:
{'acc': 0.75039124, 'precision': 0.7701999, 'recall': 0.75386, 'specificity': 0.75386, 'f1': 0.74731547, 'auroc': 0.8492496, 'binary_precision': 0.69008785, 'binary_recall': 0.8842444, 'binary_specificity': 0.6234756, 'binary_f1_score': 0.7751938}
confusion matrix:
     0    1
0  409  247
1   72  550
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7453704, 'precision': 0.7866874, 'recall': 0.7453704, 'specificity': 0.7453704, 'f1': 0.73585325, 'auroc': 0.9236969, 'binary_precision': 0.67785233, 'binary_recall': 0.9351852, 'binary_specificity': 0.5555556, 'binary_f1_score': 0.78599215}
confusion matrix:
     0    1
0  120   96
1   14  202
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-27 01:42:26.924147,epoch time: 0:00:50.530939,used: 0:00:50.530939,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_01_41_36_seed_2_23090481
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.94600785, 'precision': 0.9479061, 'recall': 0.9462744, 'specificity': 0.9462744, 'f1': 0.94596994, 'auroc': 0.9892369, 'binary_precision': 0.9790941, 'binary_recall': 0.91233766, 'binary_specificity': 0.9802111, 'binary_f1_score': 0.9445378}
confusion matrix:
      0     1
0  1486    30
1   135  1405
---- Validation: 
scalar performance:
{'acc': 0.7668232, 'precision': 0.7865124, 'recall': 0.7631999, 'specificity': 0.7631999, 'f1': 0.76096916, 'auroc': 0.8586434, 'binary_precision': 0.8552632, 'binary_recall': 0.62700963, 'binary_specificity': 0.8993902, 'binary_f1_score': 0.72356206}
confusion matrix:
     0    1
0  590   66
1  232  390
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8009259, 'precision': 0.82261026, 'recall': 0.80092597, 'specificity': 0.80092597, 'f1': 0.7975235, 'auroc': 0.8941829, 'binary_precision': 0.90625, 'binary_recall': 0.6712963, 'binary_specificity': 0.9305556, 'binary_f1_score': 0.77127653}
confusion matrix:
     0    1
0  201   15
1   71  145
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-07-27 01:43:13.636367,epoch time: 0:00:46.712220,used: 0:01:37.243159,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_01_41_36_seed_2_23090481
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9424084, 'precision': 0.94689727, 'recall': 0.94202447, 'specificity': 0.94202447, 'f1': 0.94222534, 'auroc': 0.9967669, 'binary_precision': 0.9040284, 'binary_recall': 0.9909091, 'binary_specificity': 0.89313984, 'binary_f1_score': 0.94547707}
confusion matrix:
      0     1
0  1354   162
1    14  1526
---- Validation: 
scalar performance:
{'acc': 0.7660407, 'precision': 0.7975006, 'recall': 0.77027047, 'specificity': 0.77027047, 'f1': 0.76146525, 'auroc': 0.89441514, 'binary_precision': 0.6938776, 'binary_recall': 0.92926043, 'binary_specificity': 0.6112805, 'binary_f1_score': 0.7945018}
confusion matrix:
     0    1
0  401  255
1   44  578
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7199074, 'precision': 0.77264756, 'recall': 0.7199074, 'specificity': 0.7199074, 'f1': 0.70567405, 'auroc': 0.9012774, 'binary_precision': 0.65273315, 'binary_recall': 0.9398148, 'binary_specificity': 0.5, 'binary_f1_score': 0.7703985}
confusion matrix:
     0    1
0  108  108
1   13  203
early stop counter: 1
val acc:0.7660406827926636, best validation acc: 0.7668231725692749, corresponding to test acc:                         0.8009259104728699 / 0.8009259104728699
after epoch: 3,now: 2024-07-27 01:43:59.614095,epoch time: 0:00:45.977728,used: 0:02:23.220887,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_01_41_36_seed_2_23090481
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.8929974, 'precision': 0.9105109, 'recall': 0.8921915, 'specificity': 0.8921915, 'f1': 0.891696, 'auroc': 0.9960414, 'binary_precision': 0.82766074, 'binary_recall': 0.9948052, 'binary_specificity': 0.78957784, 'binary_f1_score': 0.9035683}
confusion matrix:
      0     1
0  1197   319
1     8  1532
---- Validation: 
scalar performance:
{'acc': 0.69874805, 'precision': 0.78572786, 'recall': 0.70592993, 'specificity': 0.70592993, 'f1': 0.6784628, 'auroc': 0.9000544, 'binary_precision': 0.6212897, 'binary_recall': 0.97588426, 'binary_specificity': 0.4359756, 'binary_f1_score': 0.7592245}
confusion matrix:
     0    1
0  286  370
1   15  607
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6759259, 'precision': 0.785993, 'recall': 0.6759259, 'specificity': 0.6759259, 'f1': 0.6414258, 'auroc': 0.93100566, 'binary_precision': 0.6085714, 'binary_recall': 0.9861111, 'binary_specificity': 0.36574075, 'binary_f1_score': 0.7526502}
confusion matrix:
    0    1
0  79  137
1   3  213
early stop counter: 2
val acc:0.6987480521202087, best validation acc: 0.7668231725692749, corresponding to test acc:                         0.8009259104728699 / 0.8009259104728699
after epoch: 4,now: 2024-07-27 01:44:45.474507,epoch time: 0:00:45.860412,used: 0:03:09.081299,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_01_41_36_seed_2_23090481
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.98134816, 'precision': 0.98134583, 'recall': 0.9813753, 'specificity': 0.9813753, 'f1': 0.9813478, 'auroc': 0.9981025, 'binary_precision': 0.9849575, 'binary_recall': 0.9779221, 'binary_specificity': 0.9848285, 'binary_f1_score': 0.9814272}
confusion matrix:
      0     1
0  1493    23
1    34  1506
---- Validation: 
scalar performance:
{'acc': 0.74334896, 'precision': 0.74627376, 'recall': 0.74166733, 'specificity': 0.74166733, 'f1': 0.7415711, 'auroc': 0.83595645, 'binary_precision': 0.7672727, 'binary_recall': 0.6784566, 'binary_specificity': 0.80487806, 'binary_f1_score': 0.7201365}
confusion matrix:
     0    1
0  528  128
1  200  422
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7546296, 'precision': 0.77591974, 'recall': 0.7546296, 'specificity': 0.7546296, 'f1': 0.7498033, 'auroc': 0.8898534, 'binary_precision': 0.6992754, 'binary_recall': 0.8935185, 'binary_specificity': 0.6157407, 'binary_f1_score': 0.7845528}
confusion matrix:
     0    1
0  133   83
1   23  193
early stop counter: 3
val acc:0.7433489561080933, best validation acc: 0.7668231725692749, corresponding to test acc:                         0.8009259104728699 / 0.8009259104728699
after epoch: 5,now: 2024-07-27 01:45:31.295656,epoch time: 0:00:45.821149,used: 0:03:54.902448,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_01_41_36_seed_2_23090481
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9558246, 'precision': 0.9591157, 'recall': 0.95616883, 'specificity': 0.95616883, 'f1': 0.95576626, 'auroc': 0.9974434, 'binary_precision': 1.0, 'binary_recall': 0.91233766, 'binary_specificity': 1.0, 'binary_f1_score': 0.9541596}
confusion matrix:
      0     1
0  1516     0
1   135  1405
---- Validation: 
scalar performance:
{'acc': 0.64788735, 'precision': 0.7832528, 'recall': 0.63847196, 'specificity': 0.63847196, 'f1': 0.59172463, 'auroc': 0.891087, 'binary_precision': 0.97252744, 'binary_recall': 0.28456593, 'binary_specificity': 0.99237806, 'binary_f1_score': 0.4402985}
confusion matrix:
     0    1
0  651    5
1  445  177
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6921296, 'precision': 0.8039159, 'recall': 0.6921296, 'specificity': 0.6921296, 'f1': 0.66095257, 'auroc': 0.917717, 'binary_precision': 0.9882353, 'binary_recall': 0.3888889, 'binary_specificity': 0.9953704, 'binary_f1_score': 0.55813956}
confusion matrix:
     0   1
0  215   1
1  132  84
early stop counter: 4
val acc:0.6478873491287231, best validation acc: 0.7668231725692749, corresponding to test acc:                         0.8009259104728699 / 0.8009259104728699
after epoch: 6,now: 2024-07-27 01:46:17.373466,epoch time: 0:00:46.077810,used: 0:04:40.980258,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_01_41_36_seed_2_23090481
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9810209, 'precision': 0.98134667, 'recall': 0.981138, 'specificity': 0.981138, 'f1': 0.98102, 'auroc': 0.99865067, 'binary_precision': 0.99598396, 'binary_recall': 0.9662338, 'binary_specificity': 0.9960422, 'binary_f1_score': 0.9808833}
confusion matrix:
      0     1
0  1510     6
1    52  1488
---- Validation: 
scalar performance:
{'acc': 0.65884197, 'precision': 0.7615428, 'recall': 0.65026766, 'specificity': 0.65026766, 'f1': 0.61436975, 'auroc': 0.8851242, 'binary_precision': 0.9189189, 'binary_recall': 0.3279743, 'binary_specificity': 0.972561, 'binary_f1_score': 0.48341233}
confusion matrix:
     0    1
0  638   18
1  418  204
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7037037, 'precision': 0.80383635, 'recall': 0.7037037, 'specificity': 0.7037037, 'f1': 0.6770999, 'auroc': 0.9063786, 'binary_precision': 0.9782609, 'binary_recall': 0.41666666, 'binary_specificity': 0.9907407, 'binary_f1_score': 0.5844156}
confusion matrix:
     0   1
0  214   2
1  126  90
early stop counter: 5
val acc:0.6588419675827026, best validation acc: 0.7668231725692749, corresponding to test acc:                         0.8009259104728699 / 0.8009259104728699
after epoch: 7,now: 2024-07-27 01:47:03.469114,epoch time: 0:00:46.095648,used: 0:05:27.075906,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_01_41_36_seed_2_23090481
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 7 with time: 0:05:27.075906 at 2024-07-27 01:47:03.469114
persisted model performance metric: 

scalar performance:
{'acc': 0.8009259, 'precision': 0.82261026, 'recall': 0.80092597, 'specificity': 0.80092597, 'f1': 0.7975235, 'auroc': 0.8941829, 'binary_precision': 0.90625, 'binary_recall': 0.6712963, 'binary_specificity': 0.9305556, 'binary_f1_score': 0.77127653}
confusion matrix:
     0    1
0  201   15
1   71  145
oracle model performance metric: 

scalar performance:
{'acc': 0.8009259, 'precision': 0.82261026, 'recall': 0.80092597, 'specificity': 0.80092597, 'f1': 0.7975235, 'auroc': 0.8941829, 'binary_precision': 0.90625, 'binary_recall': 0.6712963, 'binary_specificity': 0.9305556, 'binary_f1_score': 0.77127653}
confusion matrix:
     0    1
0  201   15
1   71  145
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_diva_irm_3seeds_nofreeze_2024-07-27_01-18-02/rule_results/19.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_diva_irm_3seeds_nofreeze_2024-07-27_01-18-02/confusion_matrix/19.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    962 MiB |  13737 MiB |  85101 GiB |  85100 GiB |
|       from large pool |    902 MiB |  13678 MiB |  84041 GiB |  84040 GiB |
|       from small pool |     60 MiB |    100 MiB |   1060 GiB |   1060 GiB |
|---------------------------------------------------------------------------|
| Active memory         |    962 MiB |  13737 MiB |  85101 GiB |  85100 GiB |
|       from large pool |    902 MiB |  13678 MiB |  84041 GiB |  84040 GiB |
|       from small pool |     60 MiB |    100 MiB |   1060 GiB |   1060 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |    951 MiB |  13728 MiB |  85025 GiB |  85024 GiB |
|       from large pool |    891 MiB |  13669 MiB |  83967 GiB |  83966 GiB |
|       from small pool |     60 MiB |    100 MiB |   1058 GiB |   1058 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  14788 MiB |  14868 MiB |  39214 MiB |  24426 MiB |
|       from large pool |  14682 MiB |  14762 MiB |  39032 MiB |  24350 MiB |
|       from small pool |    106 MiB |    112 MiB |    182 MiB |     76 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |   1501 MiB |   2736 MiB |  68546 GiB |  68545 GiB |
|       from large pool |   1491 MiB |   2727 MiB |  67481 GiB |  67480 GiB |
|       from small pool |      9 MiB |     43 MiB |   1065 GiB |   1065 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    1784    |    3099    |   15258 K  |   15256 K  |
|       from large pool |     265    |    1491    |    7586 K  |    7586 K  |
|       from small pool |    1519    |    2223    |    7671 K  |    7669 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    1784    |    3099    |   15258 K  |   15256 K  |
|       from large pool |     265    |    1491    |    7586 K  |    7586 K  |
|       from small pool |    1519    |    2223    |    7671 K  |    7669 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     547    |     585    |    1496    |     949    |
|       from large pool |     494    |     532    |    1405    |     911    |
|       from small pool |      53    |      56    |      91    |      38    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     131    |     574    |    9562 K  |    9562 K  |
|       from large pool |      52    |     528    |    5281 K  |    5281 K  |
|       from small pool |      79    |     239    |    4281 K  |    4281 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  65536 KiB |  13737 MiB |  85101 GiB |  85101 GiB |
|       from large pool |  65536 KiB |  13678 MiB |  84041 GiB |  84041 GiB |
|       from small pool |      0 KiB |    100 MiB |   1060 GiB |   1060 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  65536 KiB |  13737 MiB |  85101 GiB |  85101 GiB |
|       from large pool |  65536 KiB |  13678 MiB |  84041 GiB |  84041 GiB |
|       from small pool |      0 KiB |    100 MiB |   1060 GiB |   1060 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  65536 KiB |  13728 MiB |  85025 GiB |  85025 GiB |
|       from large pool |  65536 KiB |  13669 MiB |  83967 GiB |  83967 GiB |
|       from small pool |      0 KiB |    100 MiB |   1058 GiB |   1058 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2464 MiB |  14868 MiB |  39214 MiB |  36750 MiB |
|       from large pool |   2394 MiB |  14762 MiB |  39032 MiB |  36638 MiB |
|       from small pool |     70 MiB |    112 MiB |    182 MiB |    112 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  43008 KiB |   2736 MiB |  68547 GiB |  68547 GiB |
|       from large pool |  43008 KiB |   2727 MiB |  67482 GiB |  67481 GiB |
|       from small pool |      0 KiB |     45 MiB |   1065 GiB |   1065 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3099    |   15258 K  |   15258 K  |
|       from large pool |       2    |    1491    |    7586 K  |    7586 K  |
|       from small pool |       0    |    2223    |    7671 K  |    7671 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3099    |   15258 K  |   15258 K  |
|       from large pool |       2    |    1491    |    7586 K  |    7586 K  |
|       from small pool |       0    |    2223    |    7671 K  |    7671 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      91    |     585    |    1496    |    1405    |
|       from large pool |      56    |     532    |    1405    |    1349    |
|       from small pool |      35    |      56    |      91    |      56    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       1    |     574    |    9562 K  |    9562 K  |
|       from large pool |       1    |     528    |    5281 K  |    5281 K  |
|       from small pool |       0    |     239    |    4281 K  |    4281 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Sat Jul 27 01:47:08 2024]
Finished job 0.
1 of 1 steps (100%) done
