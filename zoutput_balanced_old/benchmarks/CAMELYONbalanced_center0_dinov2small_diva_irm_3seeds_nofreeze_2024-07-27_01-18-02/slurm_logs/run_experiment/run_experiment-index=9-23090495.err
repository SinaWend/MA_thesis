Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Sat Jul 27 02:40:21 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_diva_irm_3seeds_nofreeze_2024-07-27_01-18-02/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_diva_irm_3seeds_nofreeze_2024-07-27_01-18-02/rule_results/9.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=9
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/swiglu_ffn.py:51: UserWarning: xFormers is not available (SwiGLU)
  warnings.warn("xFormers is not available (SwiGLU)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/attention.py:33: UserWarning: xFormers is not available (Attention)
  warnings.warn("xFormers is not available (Attention)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/block.py:40: UserWarning: xFormers is not available (Block)
  warnings.warn("xFormers is not available (Block)")
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/init.py:452: UserWarning: Initializing zero-element tensors is a no-op
  warnings.warn("Initializing zero-element tensors is a no-op")
Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main

using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_02_40_56_seed_0_23090495

 Experiment start at: 2024-07-27 02:40:57.377417
hyper-parameter scheduler not set,going to use default Warmpup and epoch update
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
before training, model accuracy: 0.38604649901390076
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/autograd/graph.py:744: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9264323, 'precision': 0.93136525, 'recall': 0.9272286, 'specificity': 0.9272286, 'f1': 0.9263003, 'auroc': 0.98080516, 'binary_precision': 0.98121387, 'binary_recall': 0.8716303, 'binary_specificity': 0.98282695, 'binary_f1_score': 0.9231815}
confusion matrix:
      0     1
0  1488    26
1   200  1358
---- Validation: 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
scalar performance:
{'acc': 0.5675466, 'precision': 0.6462014, 'recall': 0.56226385, 'specificity': 0.56226385, 'f1': 0.49189162, 'auroc': 0.73614216, 'binary_precision': 0.75, 'binary_recall': 0.18425196, 'binary_specificity': 0.94027567, 'binary_f1_score': 0.29582807}
confusion matrix:
     0    1
0  614   39
1  518  117
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5767442, 'precision': 0.61888003, 'recall': 0.5767442, 'specificity': 0.5767442, 'f1': 0.5355931, 'auroc': 0.74340725, 'binary_precision': 0.6896552, 'binary_recall': 0.27906978, 'binary_specificity': 0.8744186, 'binary_f1_score': 0.39735103}
confusion matrix:
     0   1
0  188  27
1  155  60
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-27 02:43:20.531211,epoch time: 0:02:23.153794,used: 0:02:23.153794,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_02_40_56_seed_0_23090495
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9401042, 'precision': 0.94239366, 'recall': 0.939639, 'specificity': 0.939639, 'f1': 0.9399723, 'auroc': 0.99025756, 'binary_precision': 0.9138035, 'binary_recall': 0.9736673, 'binary_specificity': 0.90561056, 'binary_f1_score': 0.9427861}
confusion matrix:
      0     1
0  1372   143
1    41  1516
---- Validation: 
scalar performance:
{'acc': 0.8152174, 'precision': 0.8220426, 'recall': 0.8141829, 'specificity': 0.8141829, 'f1': 0.8138597, 'auroc': 0.89293265, 'binary_precision': 0.8655617, 'binary_recall': 0.7401575, 'binary_specificity': 0.88820827, 'binary_f1_score': 0.79796267}
confusion matrix:
     0    1
0  580   73
1  165  470
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8465116, 'precision': 0.8465116, 'recall': 0.8465116, 'specificity': 0.8465116, 'f1': 0.8465116, 'auroc': 0.9148946, 'binary_precision': 0.8465116, 'binary_recall': 0.8465116, 'binary_specificity': 0.8465116, 'binary_f1_score': 0.8465116}
confusion matrix:
     0    1
0  182   33
1   33  182
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-07-27 02:45:41.138413,epoch time: 0:02:20.607202,used: 0:04:43.760996,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_02_40_56_seed_0_23090495
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.93326825, 'precision': 0.9404416, 'recall': 0.93412596, 'specificity': 0.93412596, 'f1': 0.9330752, 'auroc': 0.9956611, 'binary_precision': 1.0, 'binary_recall': 0.8682519, 'binary_specificity': 1.0, 'binary_f1_score': 0.92948055}
confusion matrix:
      0     1
0  1516     0
1   205  1351
---- Validation: 
scalar performance:
{'acc': 0.6203416, 'precision': 0.73762, 'recall': 0.6153513, 'specificity': 0.6153513, 'f1': 0.561735, 'auroc': 0.8368523, 'binary_precision': 0.9010989, 'binary_recall': 0.25826773, 'binary_specificity': 0.97243494, 'binary_f1_score': 0.4014688}
confusion matrix:
     0    1
0  635   18
1  471  164
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.74651164, 'precision': 0.8163169, 'recall': 0.74651164, 'specificity': 0.74651164, 'f1': 0.73170996, 'auroc': 0.8962034, 'binary_precision': 0.9649123, 'binary_recall': 0.5116279, 'binary_specificity': 0.98139536, 'binary_f1_score': 0.668693}
confusion matrix:
     0    1
0  211    4
1  105  110
early stop counter: 1
val acc:0.6203415989875793, best validation acc: 0.8152173757553101, corresponding to test acc:                         0.8465116024017334 / 0.8465116024017334
after epoch: 3,now: 2024-07-27 02:48:00.061159,epoch time: 0:02:18.922746,used: 0:07:02.683742,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_02_40_56_seed_0_23090495
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.97298175, 'precision': 0.97297454, 'recall': 0.97304606, 'specificity': 0.97304606, 'f1': 0.97298056, 'auroc': 0.9966947, 'binary_precision': 0.9785436, 'binary_recall': 0.9678457, 'binary_specificity': 0.9782465, 'binary_f1_score': 0.9731653}
confusion matrix:
      0     1
0  1484    33
1    50  1505
---- Validation: 
scalar performance:
{'acc': 0.7484472, 'precision': 0.77576005, 'recall': 0.74620587, 'specificity': 0.74620587, 'f1': 0.7408876, 'auroc': 0.8505071, 'binary_precision': 0.8591224, 'binary_recall': 0.58582675, 'binary_specificity': 0.906585, 'binary_f1_score': 0.6966292}
confusion matrix:
     0    1
0  592   61
1  263  372
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.83255816, 'precision': 0.8328173, 'recall': 0.83255816, 'specificity': 0.83255816, 'f1': 0.8325255, 'auroc': 0.89611685, 'binary_precision': 0.84210527, 'binary_recall': 0.81860465, 'binary_specificity': 0.8465116, 'binary_f1_score': 0.8301887}
confusion matrix:
     0    1
0  182   33
1   39  176
early stop counter: 2
val acc:0.7484471797943115, best validation acc: 0.8152173757553101, corresponding to test acc:                         0.8465116024017334 / 0.8465116024017334
after epoch: 4,now: 2024-07-27 02:50:18.511774,epoch time: 0:02:18.450615,used: 0:09:21.134357,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_02_40_56_seed_0_23090495
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9713542, 'precision': 0.9725063, 'recall': 0.9717139, 'specificity': 0.9717139, 'f1': 0.9713477, 'auroc': 0.9986621, 'binary_precision': 0.99931973, 'binary_recall': 0.9440874, 'binary_specificity': 0.99934036, 'binary_f1_score': 0.9709187}
confusion matrix:
      0     1
0  1515     1
1    87  1469
---- Validation: 
scalar performance:
{'acc': 0.5869565, 'precision': 0.72571254, 'recall': 0.58138454, 'specificity': 0.58138454, 'f1': 0.5050333, 'auroc': 0.83688307, 'binary_precision': 0.8992248, 'binary_recall': 0.18267716, 'binary_specificity': 0.98009187, 'binary_f1_score': 0.3036649}
confusion matrix:
     0    1
0  640   13
1  519  116
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7883721, 'precision': 0.8028444, 'recall': 0.7883721, 'specificity': 0.7883721, 'f1': 0.7858132, 'auroc': 0.88378584, 'binary_precision': 0.86904764, 'binary_recall': 0.67906976, 'binary_specificity': 0.89767444, 'binary_f1_score': 0.7624021}
confusion matrix:
     0    1
0  193   22
1   69  146
early stop counter: 3
val acc:0.5869565010070801, best validation acc: 0.8152173757553101, corresponding to test acc:                         0.8465116024017334 / 0.8465116024017334
after epoch: 5,now: 2024-07-27 02:52:36.969027,epoch time: 0:02:18.457253,used: 0:11:39.591610,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_02_40_56_seed_0_23090495
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9811198, 'precision': 0.9811121, 'recall': 0.98119295, 'specificity': 0.98119295, 'f1': 0.98111886, 'auroc': 0.9982208, 'binary_precision': 0.9869961, 'binary_recall': 0.9755784, 'binary_specificity': 0.9868074, 'binary_f1_score': 0.9812541}
confusion matrix:
      0     1
0  1496    20
1    38  1518
---- Validation: 
scalar performance:
{'acc': 0.7290373, 'precision': 0.7622762, 'recall': 0.72649914, 'specificity': 0.72649914, 'f1': 0.71869195, 'auroc': 0.85069513, 'binary_precision': 0.8522167, 'binary_recall': 0.5448819, 'binary_specificity': 0.9081164, 'binary_f1_score': 0.66474545}
confusion matrix:
     0    1
0  593   60
1  289  346
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8255814, 'precision': 0.8259269, 'recall': 0.82558143, 'specificity': 0.82558143, 'f1': 0.8255352, 'auroc': 0.8967658, 'binary_precision': 0.83653843, 'binary_recall': 0.80930233, 'binary_specificity': 0.8418605, 'binary_f1_score': 0.822695}
confusion matrix:
     0    1
0  181   34
1   41  174
early stop counter: 4
val acc:0.7290372848510742, best validation acc: 0.8152173757553101, corresponding to test acc:                         0.8465116024017334 / 0.8465116024017334
after epoch: 6,now: 2024-07-27 02:54:55.139284,epoch time: 0:02:18.170257,used: 0:13:57.761867,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_02_40_56_seed_0_23090495
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.976888, 'precision': 0.97758645, 'recall': 0.9766439, 'specificity': 0.9766439, 'f1': 0.9768659, 'auroc': 0.9986628, 'binary_precision': 0.96268654, 'binary_recall': 0.9929442, 'binary_specificity': 0.96034366, 'binary_f1_score': 0.97758126}
confusion matrix:
      0     1
0  1453    60
1    11  1548
---- Validation: 
scalar performance:
{'acc': 0.7919255, 'precision': 0.79523623, 'recall': 0.7926445, 'specificity': 0.7926445, 'f1': 0.7915858, 'auroc': 0.8710133, 'binary_precision': 0.7602837, 'binary_recall': 0.8440945, 'binary_specificity': 0.7411945, 'binary_f1_score': 0.8}
confusion matrix:
     0    1
0  484  169
1   99  536
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8116279, 'precision': 0.82011116, 'recall': 0.81162786, 'specificity': 0.81162786, 'f1': 0.8103715, 'auroc': 0.9007031, 'binary_precision': 0.768, 'binary_recall': 0.89302325, 'binary_specificity': 0.73023254, 'binary_f1_score': 0.82580644}
confusion matrix:
     0    1
0  157   58
1   23  192
early stop counter: 5
val acc:0.7919254899024963, best validation acc: 0.8152173757553101, corresponding to test acc:                         0.8465116024017334 / 0.8465116024017334
after epoch: 7,now: 2024-07-27 02:57:13.751149,epoch time: 0:02:18.611865,used: 0:16:16.373732,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_02_40_56_seed_0_23090495
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 7 with time: 0:16:16.373732 at 2024-07-27 02:57:13.751149
persisted model performance metric: 

scalar performance:
{'acc': 0.8465116, 'precision': 0.8465116, 'recall': 0.8465116, 'specificity': 0.8465116, 'f1': 0.8465116, 'auroc': 0.9148946, 'binary_precision': 0.8465116, 'binary_recall': 0.8465116, 'binary_specificity': 0.8465116, 'binary_f1_score': 0.8465116}
confusion matrix:
     0    1
0  182   33
1   33  182
oracle model performance metric: 

scalar performance:
{'acc': 0.8465116, 'precision': 0.8465116, 'recall': 0.8465116, 'specificity': 0.8465116, 'f1': 0.8465116, 'auroc': 0.9148946, 'binary_precision': 0.8465116, 'binary_recall': 0.8465116, 'binary_specificity': 0.8465116, 'binary_f1_score': 0.8465116}
confusion matrix:
     0    1
0  182   33
1   33  182
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_diva_irm_3seeds_nofreeze_2024-07-27_01-18-02/rule_results/9.csv
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_diva_irm_3seeds_nofreeze_2024-07-27_01-18-02/rule_results/9.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_diva_irm_3seeds_nofreeze_2024-07-27_01-18-02/confusion_matrix/9.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   1618 MiB |   8212 MiB |  43209 GiB |  43207 GiB |
|       from large pool |   1528 MiB |   8137 MiB |  42801 GiB |  42800 GiB |
|       from small pool |     89 MiB |    126 MiB |    407 GiB |    407 GiB |
|---------------------------------------------------------------------------|
| Active memory         |   1618 MiB |   8212 MiB |  43209 GiB |  43207 GiB |
|       from large pool |   1528 MiB |   8137 MiB |  42801 GiB |  42800 GiB |
|       from small pool |     89 MiB |    126 MiB |    407 GiB |    407 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |   1603 MiB |   8203 MiB |  43160 GiB |  43159 GiB |
|       from large pool |   1513 MiB |   8128 MiB |  42753 GiB |  42752 GiB |
|       from small pool |     89 MiB |    126 MiB |    407 GiB |    406 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   8800 MiB |   8800 MiB |   8800 MiB |      0 B   |
|       from large pool |   8666 MiB |   8666 MiB |   8666 MiB |      0 B   |
|       from small pool |    134 MiB |    134 MiB |    134 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |   1239 MiB |   1781 MiB |  39226 GiB |  39225 GiB |
|       from large pool |   1225 MiB |   1778 MiB |  38805 GiB |  38804 GiB |
|       from small pool |     14 MiB |     21 MiB |    420 GiB |    420 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    2444    |    3289    |    6571 K  |    6568 K  |
|       from large pool |     382    |     808    |    3327 K  |    3326 K  |
|       from small pool |    2062    |    2754    |    3244 K  |    3242 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    2444    |    3289    |    6571 K  |    6568 K  |
|       from large pool |     382    |     808    |    3327 K  |    3326 K  |
|       from small pool |    2062    |    2754    |    3244 K  |    3242 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     268    |     268    |     268    |       0    |
|       from large pool |     201    |     201    |     201    |       0    |
|       from small pool |      67    |      67    |      67    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     150    |     304    |    3253 K  |    3253 K  |
|       from large pool |      72    |     193    |    1731 K  |    1731 K  |
|       from small pool |      78    |     232    |    1522 K  |    1522 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   8212 MiB |  43209 GiB |  43209 GiB |
|       from large pool |  16640 KiB |   8137 MiB |  42801 GiB |  42801 GiB |
|       from small pool |      0 KiB |    126 MiB |    407 GiB |    407 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   8212 MiB |  43209 GiB |  43209 GiB |
|       from large pool |  16640 KiB |   8137 MiB |  42801 GiB |  42801 GiB |
|       from small pool |      0 KiB |    126 MiB |    407 GiB |    407 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   8203 MiB |  43160 GiB |  43160 GiB |
|       from large pool |  16640 KiB |   8128 MiB |  42753 GiB |  42753 GiB |
|       from small pool |      0 KiB |    126 MiB |    407 GiB |    407 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2858 MiB |   8800 MiB |   8800 MiB |   5942 MiB |
|       from large pool |   2754 MiB |   8666 MiB |   8666 MiB |   5912 MiB |
|       from small pool |    104 MiB |    134 MiB |    134 MiB |     30 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1781 MiB |  39227 GiB |  39227 GiB |
|       from large pool |  24320 KiB |   1778 MiB |  38806 GiB |  38806 GiB |
|       from small pool |      0 KiB |     52 MiB |    420 GiB |    420 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3289    |    6571 K  |    6571 K  |
|       from large pool |       2    |     808    |    3327 K  |    3327 K  |
|       from small pool |       0    |    2754    |    3244 K  |    3244 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3289    |    6571 K  |    6571 K  |
|       from large pool |       2    |     808    |    3327 K  |    3327 K  |
|       from small pool |       0    |    2754    |    3244 K  |    3244 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     128    |     268    |     268    |     140    |
|       from large pool |      76    |     201    |     201    |     125    |
|       from small pool |      52    |      67    |      67    |      15    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     304    |    3254 K  |    3254 K  |
|       from large pool |       3    |     193    |    1731 K  |    1731 K  |
|       from small pool |       0    |     232    |    1522 K  |    1522 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   8212 MiB |  43209 GiB |  43209 GiB |
|       from large pool |  16640 KiB |   8137 MiB |  42801 GiB |  42801 GiB |
|       from small pool |      0 KiB |    126 MiB |    407 GiB |    407 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   8212 MiB |  43209 GiB |  43209 GiB |
|       from large pool |  16640 KiB |   8137 MiB |  42801 GiB |  42801 GiB |
|       from small pool |      0 KiB |    126 MiB |    407 GiB |    407 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   8203 MiB |  43160 GiB |  43160 GiB |
|       from large pool |  16640 KiB |   8128 MiB |  42753 GiB |  42753 GiB |
|       from small pool |      0 KiB |    126 MiB |    407 GiB |    407 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2858 MiB |   8800 MiB |   8800 MiB |   5942 MiB |
|       from large pool |   2754 MiB |   8666 MiB |   8666 MiB |   5912 MiB |
|       from small pool |    104 MiB |    134 MiB |    134 MiB |     30 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1781 MiB |  39227 GiB |  39227 GiB |
|       from large pool |  24320 KiB |   1778 MiB |  38806 GiB |  38806 GiB |
|       from small pool |      0 KiB |     52 MiB |    420 GiB |    420 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3289    |    6571 K  |    6571 K  |
|       from large pool |       2    |     808    |    3327 K  |    3327 K  |
|       from small pool |       0    |    2754    |    3244 K  |    3244 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3289    |    6571 K  |    6571 K  |
|       from large pool |       2    |     808    |    3327 K  |    3327 K  |
|       from small pool |       0    |    2754    |    3244 K  |    3244 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     128    |     268    |     268    |     140    |
|       from large pool |      76    |     201    |     201    |     125    |
|       from small pool |      52    |      67    |      67    |      15    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     304    |    3254 K  |    3254 K  |
|       from large pool |       3    |     193    |    1731 K  |    1731 K  |
|       from small pool |       0    |     232    |    1522 K  |    1522 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/init.py:452: UserWarning: Initializing zero-element tensors is a no-op
  warnings.warn("Initializing zero-element tensors is a no-op")
Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main

using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_02_57_51_seed_1_23090495

 Experiment start at: 2024-07-27 02:57:52.006681
hyper-parameter scheduler not set,going to use default Warmpup and epoch update
before training, model accuracy: 0.5155555605888367
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9511719, 'precision': 0.9511554, 'recall': 0.9511875, 'specificity': 0.9511875, 'f1': 0.9511678, 'auroc': 0.989095, 'binary_precision': 0.9534583, 'binary_recall': 0.9497746, 'binary_specificity': 0.9526004, 'binary_f1_score': 0.9516129}
confusion matrix:
      0     1
0  1447    72
1    78  1475
---- Validation: 
scalar performance:
{'acc': 0.8017174, 'precision': 0.82557267, 'recall': 0.80391705, 'specificity': 0.80391705, 'f1': 0.79877126, 'auroc': 0.91552675, 'binary_precision': 0.7332506, 'binary_recall': 0.9380952, 'binary_specificity': 0.6697389, 'binary_f1_score': 0.82311976}
confusion matrix:
     0    1
0  436  215
1   39  591
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.81777775, 'precision': 0.827108, 'recall': 0.81777775, 'specificity': 0.81777775, 'f1': 0.8164691, 'auroc': 0.9219753, 'binary_precision': 0.7718631, 'binary_recall': 0.9022222, 'binary_specificity': 0.73333335, 'binary_f1_score': 0.8319672}
confusion matrix:
     0    1
0  165   60
1   22  203
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-27 03:00:14.922419,epoch time: 0:02:22.915738,used: 0:02:22.915738,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_02_57_51_seed_1_23090495
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.96744794, 'precision': 0.968006, 'recall': 0.9677267, 'specificity': 0.9677267, 'f1': 0.9674462, 'auroc': 0.99486744, 'binary_precision': 0.9879437, 'binary_recall': 0.94733465, 'binary_specificity': 0.9881188, 'binary_f1_score': 0.9672131}
confusion matrix:
      0     1
0  1497    18
1    82  1475
---- Validation: 
scalar performance:
{'acc': 0.85323966, 'precision': 0.8589603, 'recall': 0.8522017, 'specificity': 0.8522017, 'f1': 0.8523578, 'auroc': 0.91320074, 'binary_precision': 0.9003623, 'binary_recall': 0.7888889, 'binary_specificity': 0.9155146, 'binary_f1_score': 0.8409475}
confusion matrix:
     0    1
0  596   55
1  133  497
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8511111, 'precision': 0.85419655, 'recall': 0.8511111, 'specificity': 0.8511111, 'f1': 0.8507862, 'auroc': 0.90862226, 'binary_precision': 0.8872549, 'binary_recall': 0.80444443, 'binary_specificity': 0.8977778, 'binary_f1_score': 0.8438229}
confusion matrix:
     0    1
0  202   23
1   44  181
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-07-27 03:02:34.679617,epoch time: 0:02:19.757198,used: 0:04:42.672936,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_02_57_51_seed_1_23090495
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9322917, 'precision': 0.9395251, 'recall': 0.9331535, 'specificity': 0.9331535, 'f1': 0.9320934, 'auroc': 0.9909134, 'binary_precision': 0.99925923, 'binary_recall': 0.8669666, 'binary_specificity': 0.99934036, 'binary_f1_score': 0.92842394}
confusion matrix:
      0     1
0  1515     1
1   207  1349
---- Validation: 
scalar performance:
{'acc': 0.75800157, 'precision': 0.80604774, 'recall': 0.7547107, 'specificity': 0.7547107, 'f1': 0.74648756, 'auroc': 0.89407504, 'binary_precision': 0.9232804, 'binary_recall': 0.55396825, 'binary_specificity': 0.95545316, 'binary_f1_score': 0.69246036}
confusion matrix:
     0    1
0  622   29
1  281  349
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7911111, 'precision': 0.8332391, 'recall': 0.7911111, 'specificity': 0.7911111, 'f1': 0.7842937, 'auroc': 0.8832395, 'binary_precision': 0.9517241, 'binary_recall': 0.61333334, 'binary_specificity': 0.9688889, 'binary_f1_score': 0.74594593}
confusion matrix:
     0    1
0  218    7
1   87  138
early stop counter: 1
val acc:0.7580015659332275, best validation acc: 0.8532396554946899, corresponding to test acc:                         0.851111114025116 / 0.851111114025116
after epoch: 3,now: 2024-07-27 03:04:53.756175,epoch time: 0:02:19.076558,used: 0:07:01.749494,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_02_57_51_seed_1_23090495
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.94954425, 'precision': 0.9535902, 'recall': 0.95008934, 'specificity': 0.95008934, 'f1': 0.94946843, 'auroc': 0.99556077, 'binary_precision': 0.9992857, 'binary_recall': 0.90083706, 'binary_specificity': 0.99934167, 'binary_f1_score': 0.94751096}
confusion matrix:
      0     1
0  1518     1
1   154  1399
---- Validation: 
scalar performance:
{'acc': 0.63856363, 'precision': 0.76855886, 'recall': 0.6327701, 'specificity': 0.6327701, 'f1': 0.58343804, 'auroc': 0.8624582, 'binary_precision': 0.95135134, 'binary_recall': 0.2793651, 'binary_specificity': 0.9861751, 'binary_f1_score': 0.43190187}
confusion matrix:
     0    1
0  642    9
1  454  176
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5377778, 'precision': 0.733545, 'recall': 0.5377778, 'specificity': 0.5377778, 'f1': 0.4152339, 'auroc': 0.85914075, 'binary_precision': 0.94736844, 'binary_recall': 0.08, 'binary_specificity': 0.9955556, 'binary_f1_score': 0.14754099}
confusion matrix:
     0   1
0  224   1
1  207  18
early stop counter: 2
val acc:0.6385636329650879, best validation acc: 0.8532396554946899, corresponding to test acc:                         0.851111114025116 / 0.851111114025116
after epoch: 4,now: 2024-07-27 03:07:12.897671,epoch time: 0:02:19.141496,used: 0:09:20.890990,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_02_57_51_seed_1_23090495
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.98079425, 'precision': 0.9809732, 'recall': 0.9809648, 'specificity': 0.9809648, 'f1': 0.98079425, 'auroc': 0.99767864, 'binary_precision': 0.9940594, 'binary_recall': 0.9678663, 'binary_specificity': 0.9940633, 'binary_f1_score': 0.980788}
confusion matrix:
      0     1
0  1507     9
1    50  1506
---- Validation: 
scalar performance:
{'acc': 0.8680718, 'precision': 0.87032044, 'recall': 0.86743474, 'specificity': 0.86743474, 'f1': 0.86769897, 'auroc': 0.916407, 'binary_precision': 0.89536875, 'binary_recall': 0.82857144, 'binary_specificity': 0.906298, 'binary_f1_score': 0.860676}
confusion matrix:
     0    1
0  590   61
1  108  522
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8466667, 'precision': 0.8467283, 'recall': 0.8466667, 'specificity': 0.8466667, 'f1': 0.84665984, 'auroc': 0.9172543, 'binary_precision': 0.8513514, 'binary_recall': 0.84, 'binary_specificity': 0.85333335, 'binary_f1_score': 0.84563756}
confusion matrix:
     0    1
0  192   33
1   36  189
better model found
persisted
after epoch: 5,now: 2024-07-27 03:09:31.555037,epoch time: 0:02:18.657366,used: 0:11:39.548356,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_02_57_51_seed_1_23090495
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.97558594, 'precision': 0.9759814, 'recall': 0.97581494, 'specificity': 0.97581494, 'f1': 0.97558534, 'auroc': 0.9965018, 'binary_precision': 0.99333775, 'binary_recall': 0.9582262, 'binary_specificity': 0.9934037, 'binary_f1_score': 0.97546613}
confusion matrix:
      0     1
0  1506    10
1    65  1491
---- Validation: 
scalar performance:
{'acc': 0.7259953, 'precision': 0.74596834, 'recall': 0.7235791, 'specificity': 0.7235791, 'f1': 0.7188655, 'auroc': 0.8503597, 'binary_precision': 0.81208056, 'binary_recall': 0.5761905, 'binary_specificity': 0.87096775, 'binary_f1_score': 0.6740947}
confusion matrix:
     0    1
0  567   84
1  267  363
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7688889, 'precision': 0.7767837, 'recall': 0.7688889, 'specificity': 0.7688889, 'f1': 0.767229, 'auroc': 0.84533334, 'binary_precision': 0.8235294, 'binary_recall': 0.6844444, 'binary_specificity': 0.85333335, 'binary_f1_score': 0.7475728}
confusion matrix:
     0    1
0  192   33
1   71  154
early stop counter: 1
val acc:0.7259953022003174, best validation acc: 0.8680717945098877, corresponding to test acc:                         0.846666693687439 / 0.851111114025116
after epoch: 6,now: 2024-07-27 03:11:49.912900,epoch time: 0:02:18.357863,used: 0:13:57.906219,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_02_57_51_seed_1_23090495
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9635417, 'precision': 0.9657905, 'recall': 0.96312004, 'specificity': 0.96312004, 'f1': 0.96346796, 'auroc': 0.998579, 'binary_precision': 0.93651754, 'binary_recall': 0.9955013, 'binary_specificity': 0.9307388, 'binary_f1_score': 0.96510905}
confusion matrix:
      0     1
0  1411   105
1     7  1549
---- Validation: 
scalar performance:
{'acc': 0.7369243, 'precision': 0.78521144, 'recall': 0.7402458, 'specificity': 0.7402458, 'f1': 0.72702026, 'auroc': 0.89980733, 'binary_precision': 0.66368717, 'binary_recall': 0.94285715, 'binary_specificity': 0.53763443, 'binary_f1_score': 0.7790164}
confusion matrix:
     0    1
0  350  301
1   36  594
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7133333, 'precision': 0.775679, 'recall': 0.71333337, 'specificity': 0.71333337, 'f1': 0.6961545, 'auroc': 0.9098272, 'binary_precision': 0.64457834, 'binary_recall': 0.95111114, 'binary_specificity': 0.47555557, 'binary_f1_score': 0.76840216}
confusion matrix:
     0    1
0  107  118
1   11  214
early stop counter: 2
val acc:0.7369242906570435, best validation acc: 0.8680717945098877, corresponding to test acc:                         0.846666693687439 / 0.851111114025116
after epoch: 7,now: 2024-07-27 03:14:08.188613,epoch time: 0:02:18.275713,used: 0:16:16.181932,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_02_57_51_seed_1_23090495
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.97005206, 'precision': 0.97123814, 'recall': 0.9697438, 'specificity': 0.9697438, 'f1': 0.9700136, 'auroc': 0.997985, 'binary_precision': 0.95076925, 'binary_recall': 0.9922929, 'binary_specificity': 0.9471947, 'binary_f1_score': 0.9710874}
confusion matrix:
      0     1
0  1435    80
1    12  1545
---- Validation: 
scalar performance:
{'acc': 0.8469945, 'precision': 0.84696674, 'recall': 0.84692776, 'specificity': 0.84692776, 'f1': 0.84694517, 'auroc': 0.91017973, 'binary_precision': 0.8455414, 'binary_recall': 0.8428571, 'binary_specificity': 0.85099846, 'binary_f1_score': 0.84419715}
confusion matrix:
     0    1
0  554   97
1   99  531
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.82222223, 'precision': 0.8222477, 'recall': 0.82222223, 'specificity': 0.82222223, 'f1': 0.82221866, 'auroc': 0.89943707, 'binary_precision': 0.81938326, 'binary_recall': 0.82666665, 'binary_specificity': 0.81777775, 'binary_f1_score': 0.82300884}
confusion matrix:
     0    1
0  184   41
1   39  186
early stop counter: 3
val acc:0.8469945192337036, best validation acc: 0.8680717945098877, corresponding to test acc:                         0.846666693687439 / 0.851111114025116
after epoch: 8,now: 2024-07-27 03:16:26.997207,epoch time: 0:02:18.808594,used: 0:18:34.990526,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_02_57_51_seed_1_23090495
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9765625, 'precision': 0.9772941, 'recall': 0.97684085, 'specificity': 0.97684085, 'f1': 0.97656, 'auroc': 0.99853706, 'binary_precision': 0.9993266, 'binary_recall': 0.9543408, 'binary_specificity': 0.99934083, 'binary_f1_score': 0.9763158}
confusion matrix:
      0     1
0  1516     1
1    71  1484
---- Validation: 
scalar performance:
{'acc': 0.7150664, 'precision': 0.79847765, 'recall': 0.7106759, 'specificity': 0.7106759, 'f1': 0.6909268, 'auroc': 0.8993685, 'binary_precision': 0.9522184, 'binary_recall': 0.44285715, 'binary_specificity': 0.97849464, 'binary_f1_score': 0.60455036}
confusion matrix:
     0    1
0  637   14
1  351  279
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7911111, 'precision': 0.84656084, 'recall': 0.7911111, 'specificity': 0.7911111, 'f1': 0.78240746, 'auroc': 0.9118123, 'binary_precision': 0.9851852, 'binary_recall': 0.5911111, 'binary_specificity': 0.9911111, 'binary_f1_score': 0.7388889}
confusion matrix:
     0    1
0  223    2
1   92  133
early stop counter: 4
val acc:0.7150663733482361, best validation acc: 0.8680717945098877, corresponding to test acc:                         0.846666693687439 / 0.851111114025116
after epoch: 9,now: 2024-07-27 03:18:45.215760,epoch time: 0:02:18.218553,used: 0:20:53.209079,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_02_57_51_seed_1_23090495
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9889323, 'precision': 0.9889416, 'recall': 0.9890237, 'specificity': 0.9890237, 'f1': 0.9889319, 'auroc': 0.9995159, 'binary_precision': 0.9960887, 'binary_recall': 0.9820051, 'binary_specificity': 0.9960422, 'binary_f1_score': 0.98899674}
confusion matrix:
      0     1
0  1510     6
1    28  1528
---- Validation: 
scalar performance:
{'acc': 0.76112413, 'precision': 0.81658417, 'recall': 0.7576549, 'specificity': 0.7576549, 'f1': 0.7484999, 'auroc': 0.91387546, 'binary_precision': 0.94505495, 'binary_recall': 0.5460318, 'binary_specificity': 0.96927804, 'binary_f1_score': 0.6921529}
confusion matrix:
     0    1
0  631   20
1  286  344
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8111111, 'precision': 0.8523805, 'recall': 0.8111111, 'specificity': 0.8111111, 'f1': 0.80541384, 'auroc': 0.90678513, 'binary_precision': 0.972973, 'binary_recall': 0.64, 'binary_specificity': 0.9822222, 'binary_f1_score': 0.772118}
confusion matrix:
     0    1
0  221    4
1   81  144
early stop counter: 5
val acc:0.7611241340637207, best validation acc: 0.8680717945098877, corresponding to test acc:                         0.846666693687439 / 0.851111114025116
after epoch: 10,now: 2024-07-27 03:21:03.853965,epoch time: 0:02:18.638205,used: 0:23:11.847284,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_02_57_51_seed_1_23090495
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 10 with time: 0:23:11.847284 at 2024-07-27 03:21:03.853965
persisted model performance metric: 

scalar performance:
{'acc': 0.8466667, 'precision': 0.8467283, 'recall': 0.8466667, 'specificity': 0.8466667, 'f1': 0.84665984, 'auroc': 0.9172543, 'binary_precision': 0.8513514, 'binary_recall': 0.84, 'binary_specificity': 0.85333335, 'binary_f1_score': 0.84563756}
confusion matrix:
     0    1
0  192   33
1   36  189
oracle model performance metric: 

scalar performance:
{'acc': 0.8511111, 'precision': 0.85419655, 'recall': 0.8511111, 'specificity': 0.8511111, 'f1': 0.8507862, 'auroc': 0.90862226, 'binary_precision': 0.8872549, 'binary_recall': 0.80444443, 'binary_specificity': 0.8977778, 'binary_f1_score': 0.8438229}
confusion matrix:
     0    1
0  202   23
1   44  181
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_diva_irm_3seeds_nofreeze_2024-07-27_01-18-02/rule_results/9.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_diva_irm_3seeds_nofreeze_2024-07-27_01-18-02/confusion_matrix/9.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   1621 MiB |   8216 MiB | 104919 GiB | 104917 GiB |
|       from large pool |   1531 MiB |   8142 MiB | 103927 GiB | 103926 GiB |
|       from small pool |     89 MiB |    130 MiB |    991 GiB |    991 GiB |
|---------------------------------------------------------------------------|
| Active memory         |   1621 MiB |   8216 MiB | 104919 GiB | 104917 GiB |
|       from large pool |   1531 MiB |   8142 MiB | 103927 GiB | 103926 GiB |
|       from small pool |     89 MiB |    130 MiB |    991 GiB |    991 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |   1603 MiB |   8203 MiB | 104759 GiB | 104757 GiB |
|       from large pool |   1513 MiB |   8128 MiB | 103769 GiB | 103768 GiB |
|       from small pool |     89 MiB |    130 MiB |    990 GiB |    989 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   8652 MiB |   8800 MiB |  14594 MiB |   5942 MiB |
|       from large pool |   8512 MiB |   8666 MiB |  14424 MiB |   5912 MiB |
|       from small pool |    140 MiB |    140 MiB |    170 MiB |     30 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |   1172 MiB |   2479 MiB |  95776 GiB |  95775 GiB |
|       from large pool |   1164 MiB |   2473 MiB |  94753 GiB |  94752 GiB |
|       from small pool |      8 MiB |     52 MiB |   1022 GiB |   1022 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    2456    |    3301    |   15952 K  |   15950 K  |
|       from large pool |     382    |     808    |    8074 K  |    8073 K  |
|       from small pool |    2074    |    2766    |    7878 K  |    7876 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    2456    |    3301    |   15952 K  |   15950 K  |
|       from large pool |     382    |     808    |    8074 K  |    8073 K  |
|       from small pool |    2074    |    2766    |    7878 K  |    7876 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     249    |     268    |     389    |     140    |
|       from large pool |     179    |     201    |     304    |     125    |
|       from small pool |      70    |      70    |      85    |      15    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     156    |     311    |    8193 K  |    8193 K  |
|       from large pool |      72    |     193    |    4318 K  |    4318 K  |
|       from small pool |      84    |     239    |    3875 K  |    3875 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   8216 MiB | 104919 GiB | 104919 GiB |
|       from large pool |  16640 KiB |   8142 MiB | 103927 GiB | 103927 GiB |
|       from small pool |      0 KiB |    130 MiB |    991 GiB |    991 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   8216 MiB | 104919 GiB | 104919 GiB |
|       from large pool |  16640 KiB |   8142 MiB | 103927 GiB | 103927 GiB |
|       from small pool |      0 KiB |    130 MiB |    991 GiB |    991 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   8203 MiB | 104759 GiB | 104759 GiB |
|       from large pool |  16640 KiB |   8128 MiB | 103769 GiB | 103769 GiB |
|       from small pool |      0 KiB |    130 MiB |    990 GiB |    990 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2794 MiB |   8800 MiB |  14594 MiB |  11800 MiB |
|       from large pool |   2696 MiB |   8666 MiB |  14424 MiB |  11728 MiB |
|       from small pool |     98 MiB |    140 MiB |    170 MiB |     72 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   2479 MiB |  95777 GiB |  95777 GiB |
|       from large pool |  24320 KiB |   2473 MiB |  94754 GiB |  94754 GiB |
|       from small pool |      0 KiB |     52 MiB |   1023 GiB |   1023 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3301    |   15952 K  |   15952 K  |
|       from large pool |       2    |     808    |    8074 K  |    8074 K  |
|       from small pool |       0    |    2766    |    7878 K  |    7878 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3301    |   15952 K  |   15952 K  |
|       from large pool |       2    |     808    |    8074 K  |    8074 K  |
|       from small pool |       0    |    2766    |    7878 K  |    7878 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     123    |     268    |     389    |     266    |
|       from large pool |      74    |     201    |     304    |     230    |
|       from small pool |      49    |      70    |      85    |      36    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     311    |    8194 K  |    8194 K  |
|       from large pool |       3    |     193    |    4318 K  |    4318 K  |
|       from small pool |       0    |     239    |    3875 K  |    3875 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   8216 MiB | 104919 GiB | 104919 GiB |
|       from large pool |  16640 KiB |   8142 MiB | 103927 GiB | 103927 GiB |
|       from small pool |      0 KiB |    130 MiB |    991 GiB |    991 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   8216 MiB | 104919 GiB | 104919 GiB |
|       from large pool |  16640 KiB |   8142 MiB | 103927 GiB | 103927 GiB |
|       from small pool |      0 KiB |    130 MiB |    991 GiB |    991 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   8203 MiB | 104759 GiB | 104759 GiB |
|       from large pool |  16640 KiB |   8128 MiB | 103769 GiB | 103769 GiB |
|       from small pool |      0 KiB |    130 MiB |    990 GiB |    990 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2794 MiB |   8800 MiB |  14594 MiB |  11800 MiB |
|       from large pool |   2696 MiB |   8666 MiB |  14424 MiB |  11728 MiB |
|       from small pool |     98 MiB |    140 MiB |    170 MiB |     72 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   2479 MiB |  95777 GiB |  95777 GiB |
|       from large pool |  24320 KiB |   2473 MiB |  94754 GiB |  94754 GiB |
|       from small pool |      0 KiB |     52 MiB |   1023 GiB |   1023 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3301    |   15952 K  |   15952 K  |
|       from large pool |       2    |     808    |    8074 K  |    8074 K  |
|       from small pool |       0    |    2766    |    7878 K  |    7878 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3301    |   15952 K  |   15952 K  |
|       from large pool |       2    |     808    |    8074 K  |    8074 K  |
|       from small pool |       0    |    2766    |    7878 K  |    7878 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     123    |     268    |     389    |     266    |
|       from large pool |      74    |     201    |     304    |     230    |
|       from small pool |      49    |      70    |      85    |      36    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     311    |    8194 K  |    8194 K  |
|       from large pool |       3    |     193    |    4318 K  |    4318 K  |
|       from small pool |       0    |     239    |    3875 K  |    3875 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/init.py:452: UserWarning: Initializing zero-element tensors is a no-op
  warnings.warn("Initializing zero-element tensors is a no-op")
Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main

using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_03_21_42_seed_2_23090495

 Experiment start at: 2024-07-27 03:21:42.977307
hyper-parameter scheduler not set,going to use default Warmpup and epoch update
before training, model accuracy: 0.6134259104728699
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.96433246, 'precision': 0.96436024, 'recall': 0.9643791, 'specificity': 0.9643791, 'f1': 0.96433234, 'auroc': 0.99443555, 'binary_precision': 0.9704142, 'binary_recall': 0.95844156, 'binary_specificity': 0.97031665, 'binary_f1_score': 0.9643907}
confusion matrix:
      0     1
0  1471    45
1    64  1476
---- Validation: 
scalar performance:
{'acc': 0.74960876, 'precision': 0.78799534, 'recall': 0.7543477, 'specificity': 0.7543477, 'f1': 0.74319303, 'auroc': 0.8882637, 'binary_precision': 0.6759907, 'binary_recall': 0.93247586, 'binary_specificity': 0.5762195, 'binary_f1_score': 0.78378373}
confusion matrix:
     0    1
0  378  278
1   42  580
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7662037, 'precision': 0.8049574, 'recall': 0.7662037, 'specificity': 0.7662037, 'f1': 0.7585324, 'auroc': 0.92575455, 'binary_precision': 0.69624573, 'binary_recall': 0.9444444, 'binary_specificity': 0.587963, 'binary_f1_score': 0.8015717}
confusion matrix:
     0    1
0  127   89
1   12  204
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-27 03:24:05.521646,epoch time: 0:02:22.544339,used: 0:02:22.544339,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_03_21_42_seed_2_23090495
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9656414, 'precision': 0.96671087, 'recall': 0.96584225, 'specificity': 0.96584225, 'f1': 0.9656302, 'auroc': 0.9935472, 'binary_precision': 0.991102, 'binary_recall': 0.94025975, 'binary_specificity': 0.9914248, 'binary_f1_score': 0.96501166}
confusion matrix:
      0     1
0  1503    13
1    92  1448
---- Validation: 
scalar performance:
{'acc': 0.74100155, 'precision': 0.7531922, 'recall': 0.7378808, 'specificity': 0.7378808, 'f1': 0.73605245, 'auroc': 0.7951092, 'binary_precision': 0.8024948, 'binary_recall': 0.62057877, 'binary_specificity': 0.85518295, 'binary_f1_score': 0.6999094}
confusion matrix:
     0    1
0  561   95
1  236  386
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7569444, 'precision': 0.75818956, 'recall': 0.7569444, 'specificity': 0.7569444, 'f1': 0.75665104, 'auroc': 0.8562671, 'binary_precision': 0.74025977, 'binary_recall': 0.7916667, 'binary_specificity': 0.7222222, 'binary_f1_score': 0.7651007}
confusion matrix:
     0    1
0  156   60
1   45  171
early stop counter: 1
val acc:0.741001546382904, best validation acc: 0.7496087551116943, corresponding to test acc:                         0.7662037014961243 / 0.7662037014961243
after epoch: 2,now: 2024-07-27 03:26:23.548326,epoch time: 0:02:18.026680,used: 0:04:40.571019,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_03_21_42_seed_2_23090495
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9496073, 'precision': 0.9535931, 'recall': 0.94924957, 'specificity': 0.94924957, 'f1': 0.94946533, 'auroc': 0.99743307, 'binary_precision': 0.91299164, 'binary_recall': 0.9948052, 'binary_specificity': 0.9036939, 'binary_f1_score': 0.9521442}
confusion matrix:
      0     1
0  1370   146
1     8  1532
---- Validation: 
scalar performance:
{'acc': 0.8482003, 'precision': 0.8495239, 'recall': 0.84905106, 'specificity': 0.84905106, 'f1': 0.84818685, 'auroc': 0.9207538, 'binary_precision': 0.8203593, 'binary_recall': 0.88102895, 'binary_specificity': 0.81707317, 'binary_f1_score': 0.84961236}
confusion matrix:
     0    1
0  536  120
1   74  548
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8773148, 'precision': 0.8773229, 'recall': 0.8773148, 'specificity': 0.8773148, 'f1': 0.87731415, 'auroc': 0.9476595, 'binary_precision': 0.875576, 'binary_recall': 0.8796296, 'binary_specificity': 0.875, 'binary_f1_score': 0.87759817}
confusion matrix:
     0    1
0  189   27
1   26  190
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-07-27 03:28:41.922949,epoch time: 0:02:18.374623,used: 0:06:58.945642,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_03_21_42_seed_2_23090495
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9649869, 'precision': 0.96672356, 'recall': 0.96523917, 'specificity': 0.96523917, 'f1': 0.9649658, 'auroc': 0.99732673, 'binary_precision': 0.99722415, 'binary_recall': 0.9331169, 'binary_specificity': 0.9973615, 'binary_f1_score': 0.9641061}
confusion matrix:
      0     1
0  1512     4
1   103  1437
---- Validation: 
scalar performance:
{'acc': 0.63693273, 'precision': 0.7783623, 'recall': 0.62721795, 'specificity': 0.62721795, 'f1': 0.57495874, 'auroc': 0.8915863, 'binary_precision': 0.9702381, 'binary_recall': 0.26205787, 'binary_specificity': 0.99237806, 'binary_f1_score': 0.41265818}
confusion matrix:
     0    1
0  651    5
1  459  163
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.537037, 'precision': 0.731884, 'recall': 0.537037, 'specificity': 0.537037, 'f1': 0.41391942, 'auroc': 0.9066787, 'binary_precision': 0.9444444, 'binary_recall': 0.0787037, 'binary_specificity': 0.9953704, 'binary_f1_score': 0.14529914}
confusion matrix:
     0   1
0  215   1
1  199  17
early stop counter: 1
val acc:0.6369327306747437, best validation acc: 0.8482003211975098, corresponding to test acc:                         0.8773148059844971 / 0.8773148059844971
after epoch: 4,now: 2024-07-27 03:30:59.494386,epoch time: 0:02:17.571437,used: 0:09:16.517079,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_03_21_42_seed_2_23090495
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9594241, 'precision': 0.9621016, 'recall': 0.95973516, 'specificity': 0.95973516, 'f1': 0.9593823, 'auroc': 0.99764633, 'binary_precision': 0.99929476, 'binary_recall': 0.9201299, 'binary_specificity': 0.99934036, 'binary_f1_score': 0.95807976}
confusion matrix:
      0     1
0  1515     1
1   123  1417
---- Validation: 
scalar performance:
{'acc': 0.57746476, 'precision': 0.7683357, 'recall': 0.5659581, 'specificity': 0.5659581, 'f1': 0.47161776, 'auroc': 0.81315434, 'binary_precision': 0.9880952, 'binary_recall': 0.13344051, 'binary_specificity': 0.9984756, 'binary_f1_score': 0.23512745}
confusion matrix:
     0   1
0  655   1
1  539  83
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5046296, 'precision': 0.62616825, 'recall': 0.5046296, 'specificity': 0.5046296, 'f1': 0.3474873, 'auroc': 0.84981567, 'binary_precision': 0.75, 'binary_recall': 0.013888889, 'binary_specificity': 0.9953704, 'binary_f1_score': 0.027272727}
confusion matrix:
     0  1
0  215  1
1  213  3
early stop counter: 2
val acc:0.577464759349823, best validation acc: 0.8482003211975098, corresponding to test acc:                         0.8773148059844971 / 0.8773148059844971
after epoch: 5,now: 2024-07-27 03:33:17.210508,epoch time: 0:02:17.716122,used: 0:11:34.233201,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_03_21_42_seed_2_23090495
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.98331153, 'precision': 0.98332953, 'recall': 0.9833542, 'specificity': 0.9833542, 'f1': 0.9833115, 'auroc': 0.9978969, 'binary_precision': 0.98883784, 'binary_recall': 0.9779221, 'binary_specificity': 0.9887863, 'binary_f1_score': 0.9833497}
confusion matrix:
      0     1
0  1499    17
1    34  1506
---- Validation: 
scalar performance:
{'acc': 0.799687, 'precision': 0.8383781, 'recall': 0.7951288, 'specificity': 0.7951288, 'f1': 0.79197943, 'auroc': 0.9119015, 'binary_precision': 0.94634145, 'binary_recall': 0.6237942, 'binary_specificity': 0.9664634, 'binary_f1_score': 0.751938}
confusion matrix:
     0    1
0  634   22
1  234  388
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6967593, 'precision': 0.80584705, 'recall': 0.6967593, 'specificity': 0.6967593, 'f1': 0.6670726, 'auroc': 0.9396219, 'binary_precision': 0.9885057, 'binary_recall': 0.39814815, 'binary_specificity': 0.9953704, 'binary_f1_score': 0.56765676}
confusion matrix:
     0   1
0  215   1
1  130  86
early stop counter: 3
val acc:0.7996870279312134, best validation acc: 0.8482003211975098, corresponding to test acc:                         0.8773148059844971 / 0.8773148059844971
after epoch: 6,now: 2024-07-27 03:35:34.677886,epoch time: 0:02:17.467378,used: 0:13:51.700579,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_03_21_42_seed_2_23090495
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9856021, 'precision': 0.98567885, 'recall': 0.98566806, 'specificity': 0.98566806, 'f1': 0.98560214, 'auroc': 0.9992273, 'binary_precision': 0.9940555, 'binary_recall': 0.97727275, 'binary_specificity': 0.9940633, 'binary_f1_score': 0.9855927}
confusion matrix:
      0     1
0  1507     9
1    35  1505
---- Validation: 
scalar performance:
{'acc': 0.79264474, 'precision': 0.8283279, 'recall': 0.7881857, 'specificity': 0.7881857, 'f1': 0.78499913, 'auroc': 0.90240777, 'binary_precision': 0.93012047, 'binary_recall': 0.62057877, 'binary_specificity': 0.95579267, 'binary_f1_score': 0.7444551}
confusion matrix:
     0    1
0  627   29
1  236  386
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7939815, 'precision': 0.8509095, 'recall': 0.7939815, 'specificity': 0.7939815, 'f1': 0.7852727, 'auroc': 0.94150805, 'binary_precision': 0.99224806, 'binary_recall': 0.5925926, 'binary_specificity': 0.9953704, 'binary_f1_score': 0.742029}
confusion matrix:
     0    1
0  215    1
1   88  128
early stop counter: 4
val acc:0.792644739151001, best validation acc: 0.8482003211975098, corresponding to test acc:                         0.8773148059844971 / 0.8773148059844971
after epoch: 7,now: 2024-07-27 03:37:51.959557,epoch time: 0:02:17.281671,used: 0:16:08.982250,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_03_21_42_seed_2_23090495
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9757853, 'precision': 0.9766745, 'recall': 0.97596884, 'specificity': 0.97596884, 'f1': 0.97577935, 'auroc': 0.9984516, 'binary_precision': 0.9993188, 'binary_recall': 0.9525974, 'binary_specificity': 0.99934036, 'binary_f1_score': 0.9753989}
confusion matrix:
      0     1
0  1515     1
1    73  1467
---- Validation: 
scalar performance:
{'acc': 0.78482, 'precision': 0.82411766, 'recall': 0.7801055, 'specificity': 0.7801055, 'f1': 0.77604306, 'auroc': 0.90241516, 'binary_precision': 0.9305211, 'binary_recall': 0.6028939, 'binary_specificity': 0.95731705, 'binary_f1_score': 0.73170733}
confusion matrix:
     0    1
0  628   28
1  247  375
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6111111, 'precision': 0.7714136, 'recall': 0.6111111, 'specificity': 0.6111111, 'f1': 0.5437423, 'auroc': 0.89028203, 'binary_precision': 0.98, 'binary_recall': 0.22685185, 'binary_specificity': 0.9953704, 'binary_f1_score': 0.36842108}
confusion matrix:
     0   1
0  215   1
1  167  49
early stop counter: 5
val acc:0.784820020198822, best validation acc: 0.8482003211975098, corresponding to test acc:                         0.8773148059844971 / 0.8773148059844971
after epoch: 8,now: 2024-07-27 03:40:09.194222,epoch time: 0:02:17.234665,used: 0:18:26.216915,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_03_21_42_seed_2_23090495
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 8 with time: 0:18:26.216915 at 2024-07-27 03:40:09.194222
persisted model performance metric: 

scalar performance:
{'acc': 0.8773148, 'precision': 0.8773229, 'recall': 0.8773148, 'specificity': 0.8773148, 'f1': 0.87731415, 'auroc': 0.9476595, 'binary_precision': 0.875576, 'binary_recall': 0.8796296, 'binary_specificity': 0.875, 'binary_f1_score': 0.87759817}
confusion matrix:
     0    1
0  189   27
1   26  190
oracle model performance metric: 

scalar performance:
{'acc': 0.8773148, 'precision': 0.8773229, 'recall': 0.8773148, 'specificity': 0.8773148, 'f1': 0.87731415, 'auroc': 0.9476595, 'binary_precision': 0.875576, 'binary_recall': 0.8796296, 'binary_specificity': 0.875, 'binary_f1_score': 0.87759817}
confusion matrix:
     0    1
0  189   27
1   26  190
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_diva_irm_3seeds_nofreeze_2024-07-27_01-18-02/rule_results/9.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_diva_irm_3seeds_nofreeze_2024-07-27_01-18-02/confusion_matrix/9.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   1622 MiB |   8217 MiB | 154021 GiB | 154019 GiB |
|       from large pool |   1532 MiB |   8142 MiB | 152567 GiB | 152565 GiB |
|       from small pool |     89 MiB |    130 MiB |   1454 GiB |   1454 GiB |
|---------------------------------------------------------------------------|
| Active memory         |   1622 MiB |   8217 MiB | 154021 GiB | 154019 GiB |
|       from large pool |   1532 MiB |   8142 MiB | 152567 GiB | 152565 GiB |
|       from small pool |     89 MiB |    130 MiB |   1454 GiB |   1454 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |   1603 MiB |   8203 MiB | 153802 GiB | 153801 GiB |
|       from large pool |   1513 MiB |   8128 MiB | 152350 GiB | 152349 GiB |
|       from small pool |     89 MiB |    130 MiB |   1451 GiB |   1451 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   8782 MiB |   8800 MiB |  20582 MiB |  11800 MiB |
|       from large pool |   8646 MiB |   8666 MiB |  20374 MiB |  11728 MiB |
|       from small pool |    136 MiB |    140 MiB |    208 MiB |     72 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |   1341 MiB |   2509 MiB | 139971 GiB | 139970 GiB |
|       from large pool |   1333 MiB |   2506 MiB | 138471 GiB | 138469 GiB |
|       from small pool |      8 MiB |     52 MiB |   1500 GiB |   1500 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    2444    |    3301    |   23414 K  |   23412 K  |
|       from large pool |     382    |     808    |   11853 K  |   11852 K  |
|       from small pool |    2062    |    2766    |   11561 K  |   11559 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    2444    |    3301    |   23414 K  |   23412 K  |
|       from large pool |     382    |     808    |   11853 K  |   11852 K  |
|       from small pool |    2062    |    2766    |   11561 K  |   11559 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     248    |     268    |     514    |     266    |
|       from large pool |     180    |     201    |     410    |     230    |
|       from small pool |      68    |      70    |     104    |      36    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     146    |     311    |   12123 K  |   12123 K  |
|       from large pool |      66    |     193    |    6374 K  |    6374 K  |
|       from small pool |      80    |     239    |    5749 K  |    5748 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   8217 MiB | 154021 GiB | 154021 GiB |
|       from large pool |  16640 KiB |   8142 MiB | 152567 GiB | 152567 GiB |
|       from small pool |      0 KiB |    130 MiB |   1454 GiB |   1454 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   8217 MiB | 154021 GiB | 154021 GiB |
|       from large pool |  16640 KiB |   8142 MiB | 152567 GiB | 152567 GiB |
|       from small pool |      0 KiB |    130 MiB |   1454 GiB |   1454 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   8203 MiB | 153802 GiB | 153802 GiB |
|       from large pool |  16640 KiB |   8128 MiB | 152350 GiB | 152350 GiB |
|       from small pool |      0 KiB |    130 MiB |   1451 GiB |   1451 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2964 MiB |   8800 MiB |  20582 MiB |  17618 MiB |
|       from large pool |   2866 MiB |   8666 MiB |  20374 MiB |  17508 MiB |
|       from small pool |     98 MiB |    140 MiB |    208 MiB |    110 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   2509 MiB | 139972 GiB | 139972 GiB |
|       from large pool |  24320 KiB |   2506 MiB | 138471 GiB | 138471 GiB |
|       from small pool |      0 KiB |     52 MiB |   1500 GiB |   1500 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3301    |   23414 K  |   23414 K  |
|       from large pool |       2    |     808    |   11853 K  |   11853 K  |
|       from small pool |       0    |    2766    |   11561 K  |   11561 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3301    |   23414 K  |   23414 K  |
|       from large pool |       2    |     808    |   11853 K  |   11853 K  |
|       from small pool |       0    |    2766    |   11561 K  |   11561 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     123    |     268    |     514    |     391    |
|       from large pool |      74    |     201    |     410    |     336    |
|       from small pool |      49    |      70    |     104    |      55    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     311    |   12123 K  |   12123 K  |
|       from large pool |       3    |     193    |    6374 K  |    6374 K  |
|       from small pool |       0    |     239    |    5749 K  |    5749 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Sat Jul 27 03:40:18 2024]
Finished job 0.
1 of 1 steps (100%) done
