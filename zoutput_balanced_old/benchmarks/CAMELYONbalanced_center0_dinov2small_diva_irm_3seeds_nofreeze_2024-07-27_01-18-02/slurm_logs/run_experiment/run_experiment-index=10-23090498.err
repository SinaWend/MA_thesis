Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Sat Jul 27 03:04:53 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_diva_irm_3seeds_nofreeze_2024-07-27_01-18-02/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_diva_irm_3seeds_nofreeze_2024-07-27_01-18-02/rule_results/10.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=10
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/swiglu_ffn.py:51: UserWarning: xFormers is not available (SwiGLU)
  warnings.warn("xFormers is not available (SwiGLU)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/attention.py:33: UserWarning: xFormers is not available (Attention)
  warnings.warn("xFormers is not available (Attention)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/block.py:40: UserWarning: xFormers is not available (Block)
  warnings.warn("xFormers is not available (Block)")
Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main

using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_03_05_30_seed_0_23090498

 Experiment start at: 2024-07-27 03:05:31.526933
hyper-parameter scheduler not set,going to use default Warmpup and epoch update
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
before training, model accuracy: 0.6069767475128174
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/autograd/graph.py:744: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.96191406, 'precision': 0.9618969, 'recall': 0.9619606, 'specificity': 0.9619606, 'f1': 0.96191156, 'auroc': 0.99335885, 'binary_precision': 0.96627754, 'binary_recall': 0.9581994, 'binary_specificity': 0.96572185, 'binary_f1_score': 0.9622215}
confusion matrix:
      0     1
0  1465    52
1    65  1490
---- Validation: 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
scalar performance:
{'acc': 0.82220495, 'precision': 0.8387896, 'recall': 0.8237438, 'specificity': 0.8237438, 'f1': 0.82045937, 'auroc': 0.92692, 'binary_precision': 0.7602564, 'binary_recall': 0.9338583, 'binary_specificity': 0.7136294, 'binary_f1_score': 0.83816254}
confusion matrix:
     0    1
0  466  187
1   42  593
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8418605, 'precision': 0.84775865, 'recall': 0.8418605, 'specificity': 0.8418605, 'f1': 0.8411871, 'auroc': 0.92696595, 'binary_precision': 0.80246913, 'binary_recall': 0.90697676, 'binary_specificity': 0.7767442, 'binary_f1_score': 0.8515284}
confusion matrix:
     0    1
0  167   48
1   20  195
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-27 03:07:58.128744,epoch time: 0:02:26.601811,used: 0:02:26.601811,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_03_05_30_seed_0_23090498
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9707031, 'precision': 0.97135365, 'recall': 0.9710003, 'specificity': 0.9710003, 'f1': 0.97070104, 'auroc': 0.99535453, 'binary_precision': 0.9926125, 'binary_recall': 0.9492614, 'binary_specificity': 0.99273926, 'binary_f1_score': 0.9704531}
confusion matrix:
      0     1
0  1504    11
1    79  1478
---- Validation: 
scalar performance:
{'acc': 0.7484472, 'precision': 0.76714355, 'recall': 0.7465532, 'specificity': 0.7465532, 'f1': 0.7429712, 'auroc': 0.866887, 'binary_precision': 0.8344086, 'binary_recall': 0.6110236, 'binary_specificity': 0.8820827, 'binary_f1_score': 0.7054545}
confusion matrix:
     0    1
0  576   77
1  247  388
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7767442, 'precision': 0.7888415, 'recall': 0.7767442, 'specificity': 0.7767442, 'f1': 0.7743819, 'auroc': 0.86481345, 'binary_precision': 0.8479532, 'binary_recall': 0.6744186, 'binary_specificity': 0.87906975, 'binary_f1_score': 0.7512954}
confusion matrix:
     0    1
0  189   26
1   70  145
early stop counter: 1
val acc:0.7484471797943115, best validation acc: 0.8222049474716187, corresponding to test acc:                         0.8418604731559753 / 0.8418604731559753
after epoch: 2,now: 2024-07-27 03:10:19.268668,epoch time: 0:02:21.139924,used: 0:04:47.741735,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_03_05_30_seed_0_23090498
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.97298175, 'precision': 0.97387594, 'recall': 0.9733036, 'specificity': 0.9733036, 'f1': 0.9729779, 'auroc': 0.99725467, 'binary_precision': 0.9979716, 'binary_recall': 0.9485861, 'binary_specificity': 0.9980211, 'binary_f1_score': 0.9726524}
confusion matrix:
      0     1
0  1513     3
1    80  1476
---- Validation: 
scalar performance:
{'acc': 0.66381985, 'precision': 0.74635434, 'recall': 0.65970623, 'specificity': 0.65970623, 'f1': 0.6296941, 'auroc': 0.86450183, 'binary_precision': 0.8854962, 'binary_recall': 0.36535433, 'binary_specificity': 0.9540582, 'binary_f1_score': 0.5172798}
confusion matrix:
     0    1
0  623   30
1  403  232
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7069768, 'precision': 0.7612572, 'recall': 0.7069768, 'specificity': 0.7069768, 'f1': 0.6909228, 'auroc': 0.8699838, 'binary_precision': 0.8803419, 'binary_recall': 0.47906977, 'binary_specificity': 0.9348837, 'binary_f1_score': 0.6204819}
confusion matrix:
     0    1
0  201   14
1  112  103
early stop counter: 2
val acc:0.6638198494911194, best validation acc: 0.8222049474716187, corresponding to test acc:                         0.8418604731559753 / 0.8418604731559753
after epoch: 3,now: 2024-07-27 03:12:40.360018,epoch time: 0:02:21.091350,used: 0:07:08.833085,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_03_05_30_seed_0_23090498
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9817708, 'precision': 0.9817537, 'recall': 0.98183864, 'specificity': 0.98183864, 'f1': 0.98176956, 'auroc': 0.9984721, 'binary_precision': 0.9870214, 'binary_recall': 0.9768786, 'binary_specificity': 0.9867987, 'binary_f1_score': 0.9819238}
confusion matrix:
      0     1
0  1495    20
1    36  1521
---- Validation: 
scalar performance:
{'acc': 0.7996894, 'precision': 0.8263209, 'recall': 0.79767513, 'specificity': 0.79767513, 'f1': 0.79474026, 'auroc': 0.91145897, 'binary_precision': 0.9161148, 'binary_recall': 0.6535433, 'binary_specificity': 0.94180703, 'binary_f1_score': 0.7628676}
confusion matrix:
     0    1
0  615   38
1  220  415
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.83488375, 'precision': 0.87587416, 'recall': 0.8348837, 'specificity': 0.8348837, 'f1': 0.8302559, 'auroc': 0.9412007, 'binary_precision': 1.0, 'binary_recall': 0.66976744, 'binary_specificity': 1.0, 'binary_f1_score': 0.80222845}
confusion matrix:
     0    1
0  215    0
1   71  144
early stop counter: 3
val acc:0.7996894121170044, best validation acc: 0.8222049474716187, corresponding to test acc:                         0.8418604731559753 / 0.8418604731559753
after epoch: 4,now: 2024-07-27 03:15:01.262699,epoch time: 0:02:20.902681,used: 0:09:29.735766,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_03_05_30_seed_0_23090498
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9720052, 'precision': 0.97198117, 'recall': 0.9720356, 'specificity': 0.9720356, 'f1': 0.9720018, 'auroc': 0.9970299, 'binary_precision': 0.97482246, 'binary_recall': 0.96981376, 'binary_specificity': 0.9742574, 'binary_f1_score': 0.9723117}
confusion matrix:
      0     1
0  1476    39
1    47  1510
---- Validation: 
scalar performance:
{'acc': 0.83462733, 'precision': 0.83651435, 'recall': 0.83514845, 'specificity': 0.83514845, 'f1': 0.83451873, 'auroc': 0.90627635, 'binary_precision': 0.8075802, 'binary_recall': 0.87244093, 'binary_specificity': 0.79785603, 'binary_f1_score': 0.8387585}
confusion matrix:
     0    1
0  521  132
1   81  554
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.872093, 'precision': 0.87229437, 'recall': 0.872093, 'specificity': 0.872093, 'f1': 0.8720757, 'auroc': 0.9359437, 'binary_precision': 0.88095236, 'binary_recall': 0.8604651, 'binary_specificity': 0.88372093, 'binary_f1_score': 0.87058824}
confusion matrix:
     0    1
0  190   25
1   30  185
new oracle model saved
better model found
persisted
after epoch: 5,now: 2024-07-27 03:17:23.545615,epoch time: 0:02:22.282916,used: 0:11:52.018682,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_03_05_30_seed_0_23090498
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9798177, 'precision': 0.9801476, 'recall': 0.97967863, 'specificity': 0.97967863, 'f1': 0.9798066, 'auroc': 0.99870193, 'binary_precision': 0.970403, 'binary_recall': 0.9903599, 'binary_specificity': 0.96899736, 'binary_f1_score': 0.98027986}
confusion matrix:
      0     1
0  1469    47
1    15  1541
---- Validation: 
scalar performance:
{'acc': 0.8245342, 'precision': 0.83183753, 'recall': 0.82556343, 'specificity': 0.82556343, 'f1': 0.82385457, 'auroc': 0.9083551, 'binary_precision': 0.77899045, 'binary_recall': 0.8992126, 'binary_specificity': 0.75191426, 'binary_f1_score': 0.8347953}
confusion matrix:
     0    1
0  491  162
1   64  571
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.89069766, 'precision': 0.8909091, 'recall': 0.89069766, 'specificity': 0.89069766, 'f1': 0.8906829, 'auroc': 0.93605196, 'binary_precision': 0.8818182, 'binary_recall': 0.9023256, 'binary_specificity': 0.87906975, 'binary_f1_score': 0.891954}
confusion matrix:
     0    1
0  189   26
1   21  194
new oracle model saved
early stop counter: 1
val acc:0.8245341777801514, best validation acc: 0.8346273303031921, corresponding to test acc:                         0.8720930218696594 / 0.8906976580619812
after epoch: 6,now: 2024-07-27 03:19:45.950148,epoch time: 0:02:22.404533,used: 0:14:14.423215,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_03_05_30_seed_0_23090498
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9749349, 'precision': 0.9752702, 'recall': 0.97479814, 'specificity': 0.97479814, 'f1': 0.9749215, 'auroc': 0.99765444, 'binary_precision': 0.96536523, 'binary_recall': 0.98585206, 'binary_specificity': 0.9637442, 'binary_f1_score': 0.9755011}
confusion matrix:
      0     1
0  1462    55
1    22  1533
---- Validation: 
scalar performance:
{'acc': 0.83462733, 'precision': 0.84147143, 'recall': 0.83362913, 'specificity': 0.83362913, 'f1': 0.8334781, 'auroc': 0.91001916, 'binary_precision': 0.8864469, 'binary_recall': 0.7622047, 'binary_specificity': 0.9050536, 'binary_f1_score': 0.81964433}
confusion matrix:
     0    1
0  591   62
1  151  484
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8534884, 'precision': 0.87285507, 'recall': 0.8534883, 'specificity': 0.8534883, 'f1': 0.85156083, 'auroc': 0.9261006, 'binary_precision': 0.9578313, 'binary_recall': 0.73953485, 'binary_specificity': 0.96744186, 'binary_f1_score': 0.8346456}
confusion matrix:
     0    1
0  208    7
1   56  159
early stop counter: 2
val acc:0.8346273303031921, best validation acc: 0.8346273303031921, corresponding to test acc:                         0.8720930218696594 / 0.8906976580619812
after epoch: 7,now: 2024-07-27 03:22:07.230129,epoch time: 0:02:21.279981,used: 0:16:35.703196,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_03_05_30_seed_0_23090498
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.96484375, 'precision': 0.966377, 'recall': 0.96525323, 'specificity': 0.96525323, 'f1': 0.96483123, 'auroc': 0.9975687, 'binary_precision': 0.99657065, 'binary_recall': 0.93380463, 'binary_specificity': 0.99670184, 'binary_f1_score': 0.96416724}
confusion matrix:
      0     1
0  1511     5
1   103  1453
---- Validation: 
scalar performance:
{'acc': 0.57375777, 'precision': 0.73688555, 'recall': 0.5678685, 'specificity': 0.5678685, 'f1': 0.47742686, 'auroc': 0.8614342, 'binary_precision': 0.93, 'binary_recall': 0.14645669, 'binary_specificity': 0.9892802, 'binary_f1_score': 0.25306123}
confusion matrix:
     0   1
0  646   7
1  542  93
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.60930234, 'precision': 0.7528652, 'recall': 0.60930234, 'specificity': 0.60930234, 'f1': 0.5446753, 'auroc': 0.8861871, 'binary_precision': 0.9433962, 'binary_recall': 0.23255815, 'binary_specificity': 0.9860465, 'binary_f1_score': 0.37313434}
confusion matrix:
     0   1
0  212   3
1  165  50
early stop counter: 3
val acc:0.5737577676773071, best validation acc: 0.8346273303031921, corresponding to test acc:                         0.8720930218696594 / 0.8906976580619812
after epoch: 8,now: 2024-07-27 03:24:28.137233,epoch time: 0:02:20.907104,used: 0:18:56.610300,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_03_05_30_seed_0_23090498
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9713542, 'precision': 0.97215223, 'recall': 0.97167826, 'specificity': 0.97167826, 'f1': 0.9713511, 'auroc': 0.99850136, 'binary_precision': 0.99527985, 'binary_recall': 0.9479769, 'binary_specificity': 0.99537957, 'binary_f1_score': 0.97105265}
confusion matrix:
      0     1
0  1508     7
1    81  1476
---- Validation: 
scalar performance:
{'acc': 0.7414596, 'precision': 0.81109166, 'recall': 0.73812085, 'specificity': 0.73812085, 'f1': 0.7243376, 'auroc': 0.91520905, 'binary_precision': 0.95481926, 'binary_recall': 0.4992126, 'binary_specificity': 0.9770291, 'binary_f1_score': 0.655636}
confusion matrix:
     0    1
0  638   15
1  318  317
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.54186046, 'precision': 0.7609223, 'recall': 0.54186046, 'specificity': 0.54186046, 'f1': 0.42015597, 'auroc': 0.9437101, 'binary_precision': 1.0, 'binary_recall': 0.08372093, 'binary_specificity': 1.0, 'binary_f1_score': 0.15450644}
confusion matrix:
     0   1
0  215   0
1  197  18
early stop counter: 4
val acc:0.7414596080780029, best validation acc: 0.8346273303031921, corresponding to test acc:                         0.8720930218696594 / 0.8906976580619812
after epoch: 9,now: 2024-07-27 03:26:49.704246,epoch time: 0:02:21.567013,used: 0:21:18.177313,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_03_05_30_seed_0_23090498
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9791667, 'precision': 0.9791994, 'recall': 0.9792733, 'specificity': 0.9792733, 'f1': 0.9791662, 'auroc': 0.99834496, 'binary_precision': 0.9875817, 'binary_recall': 0.9710797, 'binary_specificity': 0.987467, 'binary_f1_score': 0.97926116}
confusion matrix:
      0     1
0  1497    19
1    45  1511
---- Validation: 
scalar performance:
{'acc': 0.79425466, 'precision': 0.82530487, 'recall': 0.7920765, 'specificity': 0.7920765, 'f1': 0.7883574, 'auroc': 0.90576744, 'binary_precision': 0.9223744, 'binary_recall': 0.63622046, 'binary_specificity': 0.9479326, 'binary_f1_score': 0.75302887}
confusion matrix:
     0    1
0  619   34
1  231  404
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8581395, 'precision': 0.88949275, 'recall': 0.8581395, 'specificity': 0.8581395, 'f1': 0.85522604, 'auroc': 0.9259275, 'binary_precision': 1.0, 'binary_recall': 0.7162791, 'binary_specificity': 1.0, 'binary_f1_score': 0.83468837}
confusion matrix:
     0    1
0  215    0
1   61  154
early stop counter: 5
val acc:0.7942546606063843, best validation acc: 0.8346273303031921, corresponding to test acc:                         0.8720930218696594 / 0.8906976580619812
after epoch: 10,now: 2024-07-27 03:29:10.522823,epoch time: 0:02:20.818577,used: 0:23:38.995890,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_03_05_30_seed_0_23090498
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 10 with time: 0:23:38.995890 at 2024-07-27 03:29:10.522823
persisted model performance metric: 

scalar performance:
{'acc': 0.872093, 'precision': 0.87229437, 'recall': 0.872093, 'specificity': 0.872093, 'f1': 0.8720757, 'auroc': 0.9359437, 'binary_precision': 0.88095236, 'binary_recall': 0.8604651, 'binary_specificity': 0.88372093, 'binary_f1_score': 0.87058824}
confusion matrix:
     0    1
0  190   25
1   30  185
oracle model performance metric: 

scalar performance:
{'acc': 0.89069766, 'precision': 0.8909091, 'recall': 0.89069766, 'specificity': 0.89069766, 'f1': 0.8906829, 'auroc': 0.93605196, 'binary_precision': 0.8818182, 'binary_recall': 0.9023256, 'binary_specificity': 0.87906975, 'binary_f1_score': 0.891954}
confusion matrix:
     0    1
0  189   26
1   21  194
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_diva_irm_3seeds_nofreeze_2024-07-27_01-18-02/rule_results/10.csv
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_diva_irm_3seeds_nofreeze_2024-07-27_01-18-02/rule_results/10.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_diva_irm_3seeds_nofreeze_2024-07-27_01-18-02/confusion_matrix/10.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   2824 MiB |   9178 MiB |  62547 GiB |  62544 GiB |
|       from large pool |   2734 MiB |   9104 MiB |  61962 GiB |  61959 GiB |
|       from small pool |     89 MiB |    126 MiB |    584 GiB |    584 GiB |
|---------------------------------------------------------------------------|
| Active memory         |   2824 MiB |   9178 MiB |  62547 GiB |  62544 GiB |
|       from large pool |   2734 MiB |   9104 MiB |  61962 GiB |  61959 GiB |
|       from small pool |     89 MiB |    126 MiB |    584 GiB |    584 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |   2813 MiB |   9170 MiB |  62486 GiB |  62483 GiB |
|       from large pool |   2723 MiB |   9096 MiB |  61902 GiB |  61899 GiB |
|       from small pool |     89 MiB |    126 MiB |    583 GiB |    583 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   9750 MiB |   9750 MiB |   9750 MiB |      0 B   |
|       from large pool |   9616 MiB |   9616 MiB |   9616 MiB |      0 B   |
|       from small pool |    134 MiB |    134 MiB |    134 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |    971 MiB |   2180 MiB |  54380 GiB |  54379 GiB |
|       from large pool |    961 MiB |   2172 MiB |  53776 GiB |  53775 GiB |
|       from small pool |     10 MiB |     21 MiB |    603 GiB |    603 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    2464    |    3317    |    9503 K  |    9501 K  |
|       from large pool |     392    |     816    |    4752 K  |    4751 K  |
|       from small pool |    2072    |    2768    |    4751 K  |    4749 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    2464    |    3317    |    9503 K  |    9501 K  |
|       from large pool |     392    |     816    |    4752 K  |    4751 K  |
|       from small pool |    2072    |    2768    |    4751 K  |    4749 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     266    |     266    |     266    |       0    |
|       from large pool |     199    |     199    |     199    |       0    |
|       from small pool |      67    |      67    |      67    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     161    |     313    |    4931 K  |    4931 K  |
|       from large pool |      80    |     186    |    2629 K  |    2629 K  |
|       from small pool |      81    |     233    |    2302 K  |    2302 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   9178 MiB |  62547 GiB |  62547 GiB |
|       from large pool |  16640 KiB |   9104 MiB |  61962 GiB |  61962 GiB |
|       from small pool |      0 KiB |    126 MiB |    584 GiB |    584 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   9178 MiB |  62547 GiB |  62547 GiB |
|       from large pool |  16640 KiB |   9104 MiB |  61962 GiB |  61962 GiB |
|       from small pool |      0 KiB |    126 MiB |    584 GiB |    584 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   9170 MiB |  62486 GiB |  62486 GiB |
|       from large pool |  16640 KiB |   9096 MiB |  61902 GiB |  61902 GiB |
|       from small pool |      0 KiB |    126 MiB |    583 GiB |    583 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   3796 MiB |   9750 MiB |   9750 MiB |   5954 MiB |
|       from large pool |   3696 MiB |   9616 MiB |   9616 MiB |   5920 MiB |
|       from small pool |    100 MiB |    134 MiB |    134 MiB |     34 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   2180 MiB |  54381 GiB |  54381 GiB |
|       from large pool |  24320 KiB |   2172 MiB |  53777 GiB |  53777 GiB |
|       from small pool |      0 KiB |     44 MiB |    603 GiB |    603 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3317    |    9503 K  |    9503 K  |
|       from large pool |       2    |     816    |    4752 K  |    4752 K  |
|       from small pool |       0    |    2768    |    4751 K  |    4751 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3317    |    9503 K  |    9503 K  |
|       from large pool |       2    |     816    |    4752 K  |    4752 K  |
|       from small pool |       0    |    2768    |    4751 K  |    4751 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     132    |     266    |     266    |     134    |
|       from large pool |      82    |     199    |     199    |     117    |
|       from small pool |      50    |      67    |      67    |      17    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     313    |    4932 K  |    4932 K  |
|       from large pool |       3    |     186    |    2629 K  |    2629 K  |
|       from small pool |       0    |     233    |    2302 K  |    2302 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   9178 MiB |  62547 GiB |  62547 GiB |
|       from large pool |  16640 KiB |   9104 MiB |  61962 GiB |  61962 GiB |
|       from small pool |      0 KiB |    126 MiB |    584 GiB |    584 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   9178 MiB |  62547 GiB |  62547 GiB |
|       from large pool |  16640 KiB |   9104 MiB |  61962 GiB |  61962 GiB |
|       from small pool |      0 KiB |    126 MiB |    584 GiB |    584 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   9170 MiB |  62486 GiB |  62486 GiB |
|       from large pool |  16640 KiB |   9096 MiB |  61902 GiB |  61902 GiB |
|       from small pool |      0 KiB |    126 MiB |    583 GiB |    583 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   3796 MiB |   9750 MiB |   9750 MiB |   5954 MiB |
|       from large pool |   3696 MiB |   9616 MiB |   9616 MiB |   5920 MiB |
|       from small pool |    100 MiB |    134 MiB |    134 MiB |     34 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   2180 MiB |  54381 GiB |  54381 GiB |
|       from large pool |  24320 KiB |   2172 MiB |  53777 GiB |  53777 GiB |
|       from small pool |      0 KiB |     44 MiB |    603 GiB |    603 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3317    |    9503 K  |    9503 K  |
|       from large pool |       2    |     816    |    4752 K  |    4752 K  |
|       from small pool |       0    |    2768    |    4751 K  |    4751 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3317    |    9503 K  |    9503 K  |
|       from large pool |       2    |     816    |    4752 K  |    4752 K  |
|       from small pool |       0    |    2768    |    4751 K  |    4751 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     132    |     266    |     266    |     134    |
|       from large pool |      82    |     199    |     199    |     117    |
|       from small pool |      50    |      67    |      67    |      17    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     313    |    4932 K  |    4932 K  |
|       from large pool |       3    |     186    |    2629 K  |    2629 K  |
|       from small pool |       0    |     233    |    2302 K  |    2302 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main

using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_03_29_49_seed_1_23090498

 Experiment start at: 2024-07-27 03:29:50.196306
hyper-parameter scheduler not set,going to use default Warmpup and epoch update
before training, model accuracy: 0.46666666865348816
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.95703125, 'precision': 0.95748323, 'recall': 0.9572582, 'specificity': 0.9572582, 'f1': 0.95702946, 'auroc': 0.99023247, 'binary_precision': 0.9752839, 'binary_recall': 0.9389067, 'binary_specificity': 0.9756098, 'binary_f1_score': 0.9567496}
confusion matrix:
      0     1
0  1480    37
1    95  1460
---- Validation: 
scalar performance:
{'acc': 0.7712724, 'precision': 0.80027276, 'recall': 0.7737839, 'specificity': 0.7737839, 'f1': 0.76666534, 'auroc': 0.87192607, 'binary_precision': 0.7027677, 'binary_recall': 0.92698413, 'binary_specificity': 0.6205837, 'binary_f1_score': 0.79945236}
confusion matrix:
     0    1
0  404  247
1   46  584
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.80222225, 'precision': 0.8097166, 'recall': 0.80222225, 'specificity': 0.80222225, 'f1': 0.80101854, 'auroc': 0.9046321, 'binary_precision': 0.76153845, 'binary_recall': 0.88, 'binary_specificity': 0.72444445, 'binary_f1_score': 0.8164949}
confusion matrix:
     0    1
0  163   62
1   27  198
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-27 03:32:16.450147,epoch time: 0:02:26.253841,used: 0:02:26.253841,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_03_29_49_seed_1_23090498
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9658203, 'precision': 0.9659568, 'recall': 0.9659641, 'specificity': 0.9659641, 'f1': 0.9658203, 'auroc': 0.9955628, 'binary_precision': 0.9776021, 'binary_recall': 0.9543408, 'binary_specificity': 0.97758734, 'binary_f1_score': 0.96583146}
confusion matrix:
      0     1
0  1483    34
1    71  1484
---- Validation: 
scalar performance:
{'acc': 0.82045275, 'precision': 0.8204026, 'recall': 0.8204557, 'specificity': 0.8204557, 'f1': 0.8204211, 'auroc': 0.8955258, 'binary_precision': 0.8154574, 'binary_recall': 0.8206349, 'binary_specificity': 0.8202765, 'binary_f1_score': 0.8180379}
confusion matrix:
     0    1
0  534  117
1  113  517
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8377778, 'precision': 0.8413446, 'recall': 0.8377778, 'specificity': 0.8377778, 'f1': 0.8373529, 'auroc': 0.90014815, 'binary_precision': 0.87623763, 'binary_recall': 0.7866667, 'binary_specificity': 0.8888889, 'binary_f1_score': 0.8290399}
confusion matrix:
     0    1
0  200   25
1   48  177
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-07-27 03:34:40.234474,epoch time: 0:02:23.784327,used: 0:04:50.038168,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_03_29_49_seed_1_23090498
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9654948, 'precision': 0.9670819, 'recall': 0.96593344, 'specificity': 0.96593344, 'f1': 0.9654825, 'auroc': 0.9968599, 'binary_precision': 0.99794096, 'binary_recall': 0.9338471, 'binary_specificity': 0.9980198, 'binary_f1_score': 0.96483076}
confusion matrix:
      0     1
0  1512     3
1   103  1454
---- Validation: 
scalar performance:
{'acc': 0.6924278, 'precision': 0.7721898, 'recall': 0.68791604, 'specificity': 0.68791604, 'f1': 0.66492504, 'auroc': 0.8513447, 'binary_precision': 0.91549295, 'binary_recall': 0.41269842, 'binary_specificity': 0.96313363, 'binary_f1_score': 0.56892776}
confusion matrix:
     0    1
0  627   24
1  370  260
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7488889, 'precision': 0.81169605, 'recall': 0.7488889, 'specificity': 0.7488889, 'f1': 0.73556805, 'auroc': 0.89613825, 'binary_precision': 0.9516129, 'binary_recall': 0.52444446, 'binary_specificity': 0.97333336, 'binary_f1_score': 0.6762178}
confusion matrix:
     0    1
0  219    6
1  107  118
early stop counter: 1
val acc:0.6924278140068054, best validation acc: 0.8204527497291565, corresponding to test acc:                         0.8377777934074402 / 0.8377777934074402
after epoch: 3,now: 2024-07-27 03:37:01.315635,epoch time: 0:02:21.081161,used: 0:07:11.119329,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_03_29_49_seed_1_23090498
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9508464, 'precision': 0.9543321, 'recall': 0.95138514, 'specificity': 0.95138514, 'f1': 0.9507867, 'auroc': 0.9967884, 'binary_precision': 0.99716514, 'binary_recall': 0.9054054, 'binary_specificity': 0.99736494, 'binary_f1_score': 0.94907254}
confusion matrix:
      0     1
0  1514     4
1   147  1407
---- Validation: 
scalar performance:
{'acc': 0.7689305, 'precision': 0.79530185, 'recall': 0.7664362, 'specificity': 0.7664362, 'f1': 0.7624865, 'auroc': 0.8746129, 'binary_precision': 0.87954545, 'binary_recall': 0.6142857, 'binary_specificity': 0.9185868, 'binary_f1_score': 0.7233645}
confusion matrix:
     0    1
0  598   53
1  243  387
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.82222223, 'precision': 0.8253325, 'recall': 0.82222223, 'specificity': 0.82222223, 'f1': 0.8217963, 'auroc': 0.88622224, 'binary_precision': 0.85714287, 'binary_recall': 0.7733333, 'binary_specificity': 0.8711111, 'binary_f1_score': 0.81308407}
confusion matrix:
     0    1
0  196   29
1   51  174
early stop counter: 2
val acc:0.7689304947853088, best validation acc: 0.8204527497291565, corresponding to test acc:                         0.8377777934074402 / 0.8377777934074402
after epoch: 4,now: 2024-07-27 03:39:22.085903,epoch time: 0:02:20.770268,used: 0:09:31.889597,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_03_29_49_seed_1_23090498
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9707031, 'precision': 0.97154355, 'recall': 0.9709815, 'specificity': 0.9709815, 'f1': 0.9706986, 'auroc': 0.997944, 'binary_precision': 0.9945946, 'binary_recall': 0.94723296, 'binary_specificity': 0.99472994, 'binary_f1_score': 0.97033614}
confusion matrix:
      0     1
0  1510     8
1    82  1472
---- Validation: 
scalar performance:
{'acc': 0.8384075, 'precision': 0.85485774, 'recall': 0.83663595, 'specificity': 0.83663595, 'f1': 0.83597493, 'auroc': 0.91174746, 'binary_precision': 0.92727274, 'binary_recall': 0.7285714, 'binary_specificity': 0.9447005, 'binary_f1_score': 0.816}
confusion matrix:
     0    1
0  615   36
1  171  459
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8511111, 'precision': 0.87896556, 'recall': 0.8511111, 'specificity': 0.8511111, 'f1': 0.84832406, 'auroc': 0.93868643, 'binary_precision': 0.98170733, 'binary_recall': 0.71555555, 'binary_specificity': 0.9866667, 'binary_f1_score': 0.8277635}
confusion matrix:
     0    1
0  222    3
1   64  161
new oracle model saved
better model found
persisted
after epoch: 5,now: 2024-07-27 03:41:44.882664,epoch time: 0:02:22.796761,used: 0:11:54.686358,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_03_29_49_seed_1_23090498
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9905599, 'precision': 0.99054885, 'recall': 0.9906056, 'specificity': 0.9906056, 'f1': 0.99055946, 'auroc': 0.99912715, 'binary_precision': 0.9948052, 'binary_recall': 0.9864778, 'binary_specificity': 0.9947334, 'binary_f1_score': 0.99062407}
confusion matrix:
      0     1
0  1511     8
1    21  1532
---- Validation: 
scalar performance:
{'acc': 0.8251366, 'precision': 0.8487928, 'recall': 0.8229903, 'specificity': 0.8229903, 'f1': 0.82141185, 'auroc': 0.9163625, 'binary_precision': 0.93562233, 'binary_recall': 0.6920635, 'binary_specificity': 0.953917, 'binary_f1_score': 0.79562044}
confusion matrix:
     0    1
0  621   30
1  194  436
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8333333, 'precision': 0.8701957, 'recall': 0.8333333, 'specificity': 0.8333333, 'f1': 0.82907844, 'auroc': 0.91851854, 'binary_precision': 0.987013, 'binary_recall': 0.6755555, 'binary_specificity': 0.9911111, 'binary_f1_score': 0.8021108}
confusion matrix:
     0    1
0  223    2
1   73  152
early stop counter: 1
val acc:0.8251366019248962, best validation acc: 0.8384075164794922, corresponding to test acc:                         0.851111114025116 / 0.851111114025116
after epoch: 6,now: 2024-07-27 03:44:06.178847,epoch time: 0:02:21.296183,used: 0:14:15.982541,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_03_29_49_seed_1_23090498
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.98307294, 'precision': 0.98312956, 'recall': 0.9832033, 'specificity': 0.9832033, 'f1': 0.98307264, 'auroc': 0.9978074, 'binary_precision': 0.99279636, 'binary_recall': 0.9736673, 'binary_specificity': 0.99273926, 'binary_f1_score': 0.9831388}
confusion matrix:
      0     1
0  1504    11
1    41  1516
---- Validation: 
scalar performance:
{'acc': 0.7275566, 'precision': 0.79397225, 'recall': 0.72360474, 'specificity': 0.72360474, 'f1': 0.70893663, 'auroc': 0.88665783, 'binary_precision': 0.9296636, 'binary_recall': 0.48253968, 'binary_specificity': 0.96466976, 'binary_f1_score': 0.6353187}
confusion matrix:
     0    1
0  628   23
1  326  304
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.79555553, 'precision': 0.8461218, 'recall': 0.7955556, 'specificity': 0.7955556, 'f1': 0.78780544, 'auroc': 0.9071605, 'binary_precision': 0.9784173, 'binary_recall': 0.60444444, 'binary_specificity': 0.9866667, 'binary_f1_score': 0.74725276}
confusion matrix:
     0    1
0  222    3
1   89  136
early stop counter: 2
val acc:0.727556586265564, best validation acc: 0.8384075164794922, corresponding to test acc:                         0.851111114025116 / 0.851111114025116
after epoch: 7,now: 2024-07-27 03:46:28.285388,epoch time: 0:02:22.106541,used: 0:16:38.089082,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_03_29_49_seed_1_23090498
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9840495, 'precision': 0.9840414, 'recall': 0.9841311, 'specificity': 0.9841311, 'f1': 0.9840486, 'auroc': 0.9984077, 'binary_precision': 0.9902471, 'binary_recall': 0.9781631, 'binary_specificity': 0.990099, 'binary_f1_score': 0.984168}
confusion matrix:
      0     1
0  1500    15
1    34  1523
---- Validation: 
scalar performance:
{'acc': 0.85323966, 'precision': 0.8551133, 'recall': 0.85263693, 'specificity': 0.85263693, 'f1': 0.8528608, 'auroc': 0.91375905, 'binary_precision': 0.87713313, 'binary_recall': 0.815873, 'binary_specificity': 0.8894009, 'binary_f1_score': 0.8453948}
confusion matrix:
     0    1
0  579   72
1  116  514
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8155556, 'precision': 0.8263934, 'recall': 0.8155556, 'specificity': 0.8155556, 'f1': 0.8140116, 'auroc': 0.897758, 'binary_precision': 0.88586956, 'binary_recall': 0.72444445, 'binary_specificity': 0.9066667, 'binary_f1_score': 0.797066}
confusion matrix:
     0    1
0  204   21
1   62  163
better model found
persisted
after epoch: 8,now: 2024-07-27 03:48:50.760236,epoch time: 0:02:22.474848,used: 0:19:00.563930,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_03_29_49_seed_1_23090498
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.98535156, 'precision': 0.9854983, 'recall': 0.9855224, 'specificity': 0.9855224, 'f1': 0.98535156, 'auroc': 0.9992076, 'binary_precision': 0.9980237, 'binary_recall': 0.973025, 'binary_specificity': 0.9980198, 'binary_f1_score': 0.9853658}
confusion matrix:
      0     1
0  1512     3
1    42  1515
---- Validation: 
scalar performance:
{'acc': 0.7298985, 'precision': 0.8049668, 'recall': 0.72578084, 'specificity': 0.72578084, 'f1': 0.70981514, 'auroc': 0.90642846, 'binary_precision': 0.9522293, 'binary_recall': 0.47460318, 'binary_specificity': 0.9769585, 'binary_f1_score': 0.6334746}
confusion matrix:
     0    1
0  636   15
1  331  299
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.80222225, 'precision': 0.8423125, 'recall': 0.80222225, 'specificity': 0.80222225, 'f1': 0.7962568, 'auroc': 0.90380245, 'binary_precision': 0.9594595, 'binary_recall': 0.6311111, 'binary_specificity': 0.97333336, 'binary_f1_score': 0.7613941}
confusion matrix:
     0    1
0  219    6
1   83  142
early stop counter: 1
val acc:0.7298985123634338, best validation acc: 0.8532396554946899, corresponding to test acc:                         0.8155555725097656 / 0.851111114025116
after epoch: 9,now: 2024-07-27 03:51:12.000785,epoch time: 0:02:21.240549,used: 0:21:21.804479,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_03_29_49_seed_1_23090498
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9824219, 'precision': 0.98247707, 'recall': 0.9823789, 'specificity': 0.9823789, 'f1': 0.9824175, 'auroc': 0.99838865, 'binary_precision': 0.9795527, 'binary_recall': 0.98585206, 'binary_specificity': 0.97890574, 'binary_f1_score': 0.98269224}
confusion matrix:
      0     1
0  1485    32
1    22  1533
---- Validation: 
scalar performance:
{'acc': 0.88212335, 'precision': 0.88429856, 'recall': 0.8815156, 'specificity': 0.8815156, 'f1': 0.8818096, 'auroc': 0.9359813, 'binary_precision': 0.9094017, 'binary_recall': 0.84444445, 'binary_specificity': 0.9185868, 'binary_f1_score': 0.87572014}
confusion matrix:
     0    1
0  598   53
1   98  532
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8244445, 'precision': 0.8539871, 'recall': 0.8244444, 'specificity': 0.8244444, 'f1': 0.8207036, 'auroc': 0.9189926, 'binary_precision': 0.95625, 'binary_recall': 0.68, 'binary_specificity': 0.9688889, 'binary_f1_score': 0.7948052}
confusion matrix:
     0    1
0  218    7
1   72  153
better model found
persisted
after epoch: 10,now: 2024-07-27 03:53:34.782074,epoch time: 0:02:22.781289,used: 0:23:44.585768,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_03_29_49_seed_1_23090498
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9794922, 'precision': 0.97981906, 'recall': 0.97970486, 'specificity': 0.97970486, 'f1': 0.9794919, 'auroc': 0.99822795, 'binary_precision': 0.9960133, 'binary_recall': 0.9633676, 'binary_specificity': 0.9960422, 'binary_f1_score': 0.97941846}
confusion matrix:
      0     1
0  1510     6
1    57  1499
---- Validation: 
scalar performance:
{'acc': 0.86260736, 'precision': 0.8679298, 'recall': 0.86162317, 'specificity': 0.86162317, 'f1': 0.8618475, 'auroc': 0.91652644, 'binary_precision': 0.9082734, 'binary_recall': 0.8015873, 'binary_specificity': 0.921659, 'binary_f1_score': 0.851602}
confusion matrix:
     0    1
0  600   51
1  125  505
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.86, 'precision': 0.86525977, 'recall': 0.86, 'specificity': 0.86, 'f1': 0.8594942, 'auroc': 0.9160296, 'binary_precision': 0.90909094, 'binary_recall': 0.8, 'binary_specificity': 0.92, 'binary_f1_score': 0.85106385}
confusion matrix:
     0    1
0  207   18
1   45  180
new oracle model saved
early stop counter: 1
val acc:0.8626073598861694, best validation acc: 0.8821233510971069, corresponding to test acc:                         0.8244444727897644 / 0.8600000143051147
after epoch: 11,now: 2024-07-27 03:55:57.453413,epoch time: 0:02:22.671339,used: 0:26:07.257107,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_03_29_49_seed_1_23090498
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9817708, 'precision': 0.982173, 'recall': 0.98197436, 'specificity': 0.98197436, 'f1': 0.98177016, 'auroc': 0.9991691, 'binary_precision': 0.9993333, 'binary_recall': 0.9646075, 'binary_specificity': 0.99934125, 'binary_f1_score': 0.98166335}
confusion matrix:
      0     1
0  1517     1
1    55  1499
---- Validation: 
scalar performance:
{'acc': 0.77361435, 'precision': 0.8238507, 'recall': 0.7703533, 'specificity': 0.7703533, 'f1': 0.7630078, 'auroc': 0.9272938, 'binary_precision': 0.94736844, 'binary_recall': 0.5714286, 'binary_specificity': 0.96927804, 'binary_f1_score': 0.7128713}
confusion matrix:
     0    1
0  631   20
1  270  360
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.76222223, 'precision': 0.83522725, 'recall': 0.76222223, 'specificity': 0.76222223, 'f1': 0.74853116, 'auroc': 0.9190717, 'binary_precision': 0.9916667, 'binary_recall': 0.5288889, 'binary_specificity': 0.9955556, 'binary_f1_score': 0.6898551}
confusion matrix:
     0    1
0  224    1
1  106  119
early stop counter: 2
val acc:0.7736143469810486, best validation acc: 0.8821233510971069, corresponding to test acc:                         0.8244444727897644 / 0.8600000143051147
after epoch: 12,now: 2024-07-27 03:58:18.736425,epoch time: 0:02:21.283012,used: 0:28:28.540119,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_03_29_49_seed_1_23090498
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.99121094, 'precision': 0.991215, 'recall': 0.9912822, 'specificity': 0.9912822, 'f1': 0.9912107, 'auroc': 0.999527, 'binary_precision': 0.99739414, 'binary_recall': 0.9851995, 'binary_specificity': 0.99736494, 'binary_f1_score': 0.99125934}
confusion matrix:
      0     1
0  1514     4
1    23  1531
---- Validation: 
scalar performance:
{'acc': 0.84933645, 'precision': 0.8685392, 'recall': 0.84746546, 'specificity': 0.84746546, 'f1': 0.84682584, 'auroc': 0.9210714, 'binary_precision': 0.9486653, 'binary_recall': 0.73333335, 'binary_specificity': 0.96159756, 'binary_f1_score': 0.82721573}
confusion matrix:
     0    1
0  626   25
1  168  462
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7511111, 'precision': 0.8129231, 'recall': 0.75111115, 'specificity': 0.75111115, 'f1': 0.7381818, 'auroc': 0.8956444, 'binary_precision': 0.952, 'binary_recall': 0.5288889, 'binary_specificity': 0.97333336, 'binary_f1_score': 0.68000007}
confusion matrix:
     0    1
0  219    6
1  106  119
early stop counter: 3
val acc:0.8493364453315735, best validation acc: 0.8821233510971069, corresponding to test acc:                         0.8244444727897644 / 0.8600000143051147
after epoch: 13,now: 2024-07-27 04:00:40.235620,epoch time: 0:02:21.499195,used: 0:30:50.039314,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_03_29_49_seed_1_23090498
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.984375, 'precision': 0.9846523, 'recall': 0.9845388, 'specificity': 0.9845388, 'f1': 0.98437476, 'auroc': 0.99977744, 'binary_precision': 0.9993364, 'binary_recall': 0.969736, 'binary_specificity': 0.99934167, 'binary_f1_score': 0.9843137}
confusion matrix:
      0     1
0  1518     1
1    47  1506
---- Validation: 
scalar performance:
{'acc': 0.8056206, 'precision': 0.8431075, 'recall': 0.802893, 'specificity': 0.802893, 'f1': 0.7991456, 'auroc': 0.9235078, 'binary_precision': 0.9524941, 'binary_recall': 0.6365079, 'binary_specificity': 0.96927804, 'binary_f1_score': 0.76308274}
confusion matrix:
     0    1
0  631   20
1  229  401
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7511111, 'precision': 0.82628787, 'recall': 0.75111115, 'specificity': 0.75111115, 'f1': 0.73589885, 'auroc': 0.93037033, 'binary_precision': 0.982906, 'binary_recall': 0.51111114, 'binary_specificity': 0.9911111, 'binary_f1_score': 0.6725146}
confusion matrix:
     0    1
0  223    2
1  110  115
early stop counter: 4
val acc:0.8056206107139587, best validation acc: 0.8821233510971069, corresponding to test acc:                         0.8244444727897644 / 0.8600000143051147
after epoch: 14,now: 2024-07-27 04:03:01.538273,epoch time: 0:02:21.302653,used: 0:33:11.341967,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_03_29_49_seed_1_23090498
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.98828125, 'precision': 0.98832345, 'recall': 0.9882473, 'specificity': 0.9882473, 'f1': 0.9882786, 'auroc': 0.99933994, 'binary_precision': 0.9859245, 'binary_recall': 0.9909968, 'binary_specificity': 0.9854977, 'binary_f1_score': 0.9884541}
confusion matrix:
      0     1
0  1495    22
1    14  1541
---- Validation: 
scalar performance:
{'acc': 0.86416864, 'precision': 0.8687023, 'recall': 0.86326164, 'specificity': 0.86326164, 'f1': 0.8635098, 'auroc': 0.92040086, 'binary_precision': 0.90569395, 'binary_recall': 0.8079365, 'binary_specificity': 0.9185868, 'binary_f1_score': 0.85402685}
confusion matrix:
     0    1
0  598   53
1  121  509
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.86444443, 'precision': 0.86653686, 'recall': 0.86444443, 'specificity': 0.86444443, 'f1': 0.86425066, 'auroc': 0.92831606, 'binary_precision': 0.8942308, 'binary_recall': 0.82666665, 'binary_specificity': 0.9022222, 'binary_f1_score': 0.8591224}
confusion matrix:
     0    1
0  203   22
1   39  186
new oracle model saved
early stop counter: 5
val acc:0.864168643951416, best validation acc: 0.8821233510971069, corresponding to test acc:                         0.8244444727897644 / 0.8644444346427917
after epoch: 15,now: 2024-07-27 04:05:23.757935,epoch time: 0:02:22.219662,used: 0:35:33.561629,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_03_29_49_seed_1_23090498
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 15 with time: 0:35:33.561629 at 2024-07-27 04:05:23.757935
persisted model performance metric: 

scalar performance:
{'acc': 0.8244445, 'precision': 0.8539871, 'recall': 0.8244444, 'specificity': 0.8244444, 'f1': 0.8207036, 'auroc': 0.9189926, 'binary_precision': 0.95625, 'binary_recall': 0.68, 'binary_specificity': 0.9688889, 'binary_f1_score': 0.7948052}
confusion matrix:
     0    1
0  218    7
1   72  153
oracle model performance metric: 

scalar performance:
{'acc': 0.86444443, 'precision': 0.86653686, 'recall': 0.86444443, 'specificity': 0.86444443, 'f1': 0.86425066, 'auroc': 0.92831606, 'binary_precision': 0.8942308, 'binary_recall': 0.82666665, 'binary_specificity': 0.9022222, 'binary_f1_score': 0.8591224}
confusion matrix:
     0    1
0  203   22
1   39  186
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_diva_irm_3seeds_nofreeze_2024-07-27_01-18-02/rule_results/10.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_diva_irm_3seeds_nofreeze_2024-07-27_01-18-02/confusion_matrix/10.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   2826 MiB |   9180 MiB | 156327 GiB | 156324 GiB |
|       from large pool |   2736 MiB |   9105 MiB | 154862 GiB | 154860 GiB |
|       from small pool |     89 MiB |    130 MiB |   1464 GiB |   1464 GiB |
|---------------------------------------------------------------------------|
| Active memory         |   2826 MiB |   9180 MiB | 156327 GiB | 156324 GiB |
|       from large pool |   2736 MiB |   9105 MiB | 154862 GiB | 154860 GiB |
|       from small pool |     89 MiB |    130 MiB |   1464 GiB |   1464 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |   2813 MiB |   9170 MiB | 156152 GiB | 156149 GiB |
|       from large pool |   2723 MiB |   9096 MiB | 154689 GiB | 154687 GiB |
|       from small pool |     89 MiB |    130 MiB |   1462 GiB |   1462 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   9706 MiB |   9750 MiB |  15660 MiB |   5954 MiB |
|       from large pool |   9566 MiB |   9616 MiB |  15486 MiB |   5920 MiB |
|       from small pool |    140 MiB |    140 MiB |    174 MiB |     34 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |   1459 MiB |   2997 MiB | 141496 GiB | 141495 GiB |
|       from large pool |   1451 MiB |   2989 MiB | 139990 GiB | 139988 GiB |
|       from small pool |      8 MiB |     44 MiB |   1506 GiB |   1506 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    2476    |    3329    |   23759 K  |   23756 K  |
|       from large pool |     392    |     816    |   11873 K  |   11873 K  |
|       from small pool |    2084    |    2780    |   11885 K  |   11883 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    2476    |    3329    |   23759 K  |   23756 K  |
|       from large pool |     392    |     816    |   11873 K  |   11873 K  |
|       from small pool |    2084    |    2780    |   11885 K  |   11883 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     239    |     266    |     373    |     134    |
|       from large pool |     169    |     199    |     286    |     117    |
|       from small pool |      70    |      70    |      87    |      17    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     169    |     319    |   12451 K  |   12451 K  |
|       from large pool |      86    |     186    |    6681 K  |    6681 K  |
|       from small pool |      83    |     233    |    5770 K  |    5770 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   9180 MiB | 156327 GiB | 156327 GiB |
|       from large pool |  16640 KiB |   9105 MiB | 154862 GiB | 154862 GiB |
|       from small pool |      0 KiB |    130 MiB |   1464 GiB |   1464 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   9180 MiB | 156327 GiB | 156327 GiB |
|       from large pool |  16640 KiB |   9105 MiB | 154862 GiB | 154862 GiB |
|       from small pool |      0 KiB |    130 MiB |   1464 GiB |   1464 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   9170 MiB | 156152 GiB | 156152 GiB |
|       from large pool |  16640 KiB |   9096 MiB | 154689 GiB | 154689 GiB |
|       from small pool |      0 KiB |    130 MiB |   1462 GiB |   1462 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   4286 MiB |   9750 MiB |  15660 MiB |  11374 MiB |
|       from large pool |   4188 MiB |   9616 MiB |  15486 MiB |  11298 MiB |
|       from small pool |     98 MiB |    140 MiB |    174 MiB |     76 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   2997 MiB | 141497 GiB | 141497 GiB |
|       from large pool |  24320 KiB |   2989 MiB | 139991 GiB | 139991 GiB |
|       from small pool |      0 KiB |     47 MiB |   1506 GiB |   1506 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3329    |   23759 K  |   23759 K  |
|       from large pool |       2    |     816    |   11873 K  |   11873 K  |
|       from small pool |       0    |    2780    |   11885 K  |   11885 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3329    |   23759 K  |   23759 K  |
|       from large pool |       2    |     816    |   11873 K  |   11873 K  |
|       from small pool |       0    |    2780    |   11885 K  |   11885 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     131    |     266    |     373    |     242    |
|       from large pool |      82    |     199    |     286    |     204    |
|       from small pool |      49    |      70    |      87    |      38    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     319    |   12452 K  |   12452 K  |
|       from large pool |       3    |     186    |    6681 K  |    6681 K  |
|       from small pool |       0    |     233    |    5771 K  |    5771 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   9180 MiB | 156327 GiB | 156327 GiB |
|       from large pool |  16640 KiB |   9105 MiB | 154862 GiB | 154862 GiB |
|       from small pool |      0 KiB |    130 MiB |   1464 GiB |   1464 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   9180 MiB | 156327 GiB | 156327 GiB |
|       from large pool |  16640 KiB |   9105 MiB | 154862 GiB | 154862 GiB |
|       from small pool |      0 KiB |    130 MiB |   1464 GiB |   1464 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   9170 MiB | 156152 GiB | 156152 GiB |
|       from large pool |  16640 KiB |   9096 MiB | 154689 GiB | 154689 GiB |
|       from small pool |      0 KiB |    130 MiB |   1462 GiB |   1462 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   4286 MiB |   9750 MiB |  15660 MiB |  11374 MiB |
|       from large pool |   4188 MiB |   9616 MiB |  15486 MiB |  11298 MiB |
|       from small pool |     98 MiB |    140 MiB |    174 MiB |     76 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   2997 MiB | 141497 GiB | 141497 GiB |
|       from large pool |  24320 KiB |   2989 MiB | 139991 GiB | 139991 GiB |
|       from small pool |      0 KiB |     47 MiB |   1506 GiB |   1506 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3329    |   23759 K  |   23759 K  |
|       from large pool |       2    |     816    |   11873 K  |   11873 K  |
|       from small pool |       0    |    2780    |   11885 K  |   11885 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3329    |   23759 K  |   23759 K  |
|       from large pool |       2    |     816    |   11873 K  |   11873 K  |
|       from small pool |       0    |    2780    |   11885 K  |   11885 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     131    |     266    |     373    |     242    |
|       from large pool |      82    |     199    |     286    |     204    |
|       from small pool |      49    |      70    |      87    |      38    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     319    |   12452 K  |   12452 K  |
|       from large pool |       3    |     186    |    6681 K  |    6681 K  |
|       from small pool |       0    |     233    |    5771 K  |    5771 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main

using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_04_06_01_seed_2_23090498

 Experiment start at: 2024-07-27 04:06:02.330672
hyper-parameter scheduler not set,going to use default Warmpup and epoch update
before training, model accuracy: 0.46759259700775146
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9649869, 'precision': 0.9651757, 'recall': 0.96507984, 'specificity': 0.96507984, 'f1': 0.9649863, 'auroc': 0.9932687, 'binary_precision': 0.97671324, 'binary_recall': 0.9532468, 'binary_specificity': 0.9769129, 'binary_f1_score': 0.9648374}
confusion matrix:
      0     1
0  1481    35
1    72  1468
---- Validation: 
scalar performance:
{'acc': 0.74647886, 'precision': 0.7597503, 'recall': 0.7493408, 'specificity': 0.7493408, 'f1': 0.74451673, 'auroc': 0.84449506, 'binary_precision': 0.69401044, 'binary_recall': 0.8569132, 'binary_specificity': 0.6417683, 'binary_f1_score': 0.76690656}
confusion matrix:
     0    1
0  421  235
1   89  533
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7800926, 'precision': 0.7800986, 'recall': 0.7800926, 'specificity': 0.7800926, 'f1': 0.78009146, 'auroc': 0.8351766, 'binary_precision': 0.7813954, 'binary_recall': 0.7777778, 'binary_specificity': 0.7824074, 'binary_f1_score': 0.77958244}
confusion matrix:
     0    1
0  169   47
1   48  168
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-27 04:08:27.343105,epoch time: 0:02:25.012433,used: 0:02:25.012433,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_04_06_01_seed_2_23090498
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.97709423, 'precision': 0.9771656, 'recall': 0.97705686, 'specificity': 0.97705686, 'f1': 0.9770907, 'auroc': 0.99755335, 'binary_precision': 0.972973, 'binary_recall': 0.9818182, 'binary_specificity': 0.9722955, 'binary_f1_score': 0.97737557}
confusion matrix:
      0     1
0  1474    42
1    28  1512
---- Validation: 
scalar performance:
{'acc': 0.7824726, 'precision': 0.7839168, 'recall': 0.7833601, 'specificity': 0.7833601, 'f1': 0.7824385, 'auroc': 0.86161137, 'binary_precision': 0.75595236, 'binary_recall': 0.81672025, 'binary_specificity': 0.75, 'binary_f1_score': 0.78516227}
confusion matrix:
     0    1
0  492  164
1  114  508
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.837963, 'precision': 0.837963, 'recall': 0.837963, 'specificity': 0.837963, 'f1': 0.8379629, 'auroc': 0.91949594, 'binary_precision': 0.837963, 'binary_recall': 0.837963, 'binary_specificity': 0.837963, 'binary_f1_score': 0.8379629}
confusion matrix:
     0    1
0  181   35
1   35  181
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-07-27 04:10:49.662279,epoch time: 0:02:22.319174,used: 0:04:47.331607,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_04_06_01_seed_2_23090498
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9463351, 'precision': 0.950946, 'recall': 0.94674295, 'specificity': 0.94674295, 'f1': 0.9462286, 'auroc': 0.99506223, 'binary_precision': 0.9985507, 'binary_recall': 0.8948052, 'binary_specificity': 0.9986807, 'binary_f1_score': 0.9438357}
confusion matrix:
      0     1
0  1514     2
1   162  1378
---- Validation: 
scalar performance:
{'acc': 0.64241004, 'precision': 0.732134, 'recall': 0.63384485, 'specificity': 0.63384485, 'f1': 0.5960381, 'auroc': 0.8271606, 'binary_precision': 0.8699552, 'binary_recall': 0.3118971, 'binary_specificity': 0.95579267, 'binary_f1_score': 0.45917156}
confusion matrix:
     0    1
0  627   29
1  428  194
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5115741, 'precision': 0.5765415, 'recall': 0.5115741, 'specificity': 0.5115741, 'f1': 0.38001537, 'auroc': 0.8330761, 'binary_precision': 0.64705884, 'binary_recall': 0.050925925, 'binary_specificity': 0.9722222, 'binary_f1_score': 0.094420604}
confusion matrix:
     0   1
0  210   6
1  205  11
early stop counter: 1
val acc:0.6424100399017334, best validation acc: 0.7824726104736328, corresponding to test acc:                         0.8379629850387573 / 0.8379629850387573
after epoch: 3,now: 2024-07-27 04:13:09.859739,epoch time: 0:02:20.197460,used: 0:07:07.529067,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_04_06_01_seed_2_23090498
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9676047, 'precision': 0.9680859, 'recall': 0.96774405, 'specificity': 0.96774405, 'f1': 0.96760136, 'auroc': 0.995598, 'binary_precision': 0.9851852, 'binary_recall': 0.95, 'binary_specificity': 0.9854881, 'binary_f1_score': 0.96727276}
confusion matrix:
      0     1
0  1494    22
1    77  1463
---- Validation: 
scalar performance:
{'acc': 0.75273865, 'precision': 0.76076674, 'recall': 0.75493836, 'specificity': 0.75493836, 'f1': 0.75176597, 'auroc': 0.812652, 'binary_precision': 0.70788044, 'binary_recall': 0.83762056, 'binary_specificity': 0.6722561, 'binary_f1_score': 0.76730484}
confusion matrix:
     0    1
0  441  215
1  101  521
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7685185, 'precision': 0.7708405, 'recall': 0.7685185, 'specificity': 0.7685185, 'f1': 0.7680213, 'auroc': 0.8038409, 'binary_precision': 0.7457627, 'binary_recall': 0.8148148, 'binary_specificity': 0.7222222, 'binary_f1_score': 0.7787611}
confusion matrix:
     0    1
0  156   60
1   40  176
early stop counter: 2
val acc:0.7527386546134949, best validation acc: 0.7824726104736328, corresponding to test acc:                         0.8379629850387573 / 0.8379629850387573
after epoch: 4,now: 2024-07-27 04:15:30.816644,epoch time: 0:02:20.956905,used: 0:09:28.485972,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_04_06_01_seed_2_23090498
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.983966, 'precision': 0.9839941, 'recall': 0.9840138, 'specificity': 0.9840138, 'f1': 0.98396593, 'auroc': 0.9990024, 'binary_precision': 0.99013805, 'binary_recall': 0.9779221, 'binary_specificity': 0.99010557, 'binary_f1_score': 0.98399216}
confusion matrix:
      0     1
0  1501    15
1    34  1506
---- Validation: 
scalar performance:
{'acc': 0.7214398, 'precision': 0.77361375, 'recall': 0.71545124, 'specificity': 0.71545124, 'f1': 0.7037853, 'auroc': 0.8342532, 'binary_precision': 0.8866279, 'binary_recall': 0.4903537, 'binary_specificity': 0.9405488, 'binary_f1_score': 0.63146996}
confusion matrix:
     0    1
0  617   39
1  317  305
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6527778, 'precision': 0.70370376, 'recall': 0.6527778, 'specificity': 0.6527778, 'f1': 0.62962973, 'auroc': 0.83033264, 'binary_precision': 0.8055556, 'binary_recall': 0.4027778, 'binary_specificity': 0.9027778, 'binary_f1_score': 0.5370371}
confusion matrix:
     0   1
0  195  21
1  129  87
early stop counter: 3
val acc:0.721439778804779, best validation acc: 0.7824726104736328, corresponding to test acc:                         0.8379629850387573 / 0.8379629850387573
after epoch: 5,now: 2024-07-27 04:17:50.847373,epoch time: 0:02:20.030729,used: 0:11:48.516701,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_04_06_01_seed_2_23090498
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9757853, 'precision': 0.9758154, 'recall': 0.9757633, 'specificity': 0.9757633, 'f1': 0.97578263, 'auroc': 0.9972154, 'binary_precision': 0.9735142, 'binary_recall': 0.9785714, 'binary_specificity': 0.97295517, 'binary_f1_score': 0.97603625}
confusion matrix:
      0     1
0  1475    41
1    33  1507
---- Validation: 
scalar performance:
{'acc': 0.71283257, 'precision': 0.74289906, 'recall': 0.71731627, 'specificity': 0.71731627, 'f1': 0.7062719, 'auroc': 0.83987284, 'binary_precision': 0.6505313, 'binary_recall': 0.8858521, 'binary_specificity': 0.5487805, 'binary_f1_score': 0.7501702}
confusion matrix:
     0    1
0  360  296
1   71  551
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7152778, 'precision': 0.7786362, 'recall': 0.7152778, 'specificity': 0.7152778, 'f1': 0.69811666, 'auroc': 0.87107766, 'binary_precision': 0.64576805, 'binary_recall': 0.9537037, 'binary_specificity': 0.47685185, 'binary_f1_score': 0.77009344}
confusion matrix:
     0    1
0  103  113
1   10  206
early stop counter: 4
val acc:0.7128325700759888, best validation acc: 0.7824726104736328, corresponding to test acc:                         0.8379629850387573 / 0.8379629850387573
after epoch: 6,now: 2024-07-27 04:20:11.010431,epoch time: 0:02:20.163058,used: 0:14:08.679759,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_04_06_01_seed_2_23090498
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.983966, 'precision': 0.9839596, 'recall': 0.98397267, 'specificity': 0.98397267, 'f1': 0.9839652, 'auroc': 0.9986589, 'binary_precision': 0.9850358, 'binary_recall': 0.98311687, 'binary_specificity': 0.9848285, 'binary_f1_score': 0.9840754}
confusion matrix:
      0     1
0  1493    23
1    26  1514
---- Validation: 
scalar performance:
{'acc': 0.80985916, 'precision': 0.8147127, 'recall': 0.8081204, 'specificity': 0.8081204, 'f1': 0.80841386, 'auroc': 0.870368, 'binary_precision': 0.84770644, 'binary_recall': 0.74276525, 'binary_specificity': 0.8734756, 'binary_f1_score': 0.79177374}
confusion matrix:
     0    1
0  573   83
1  160  462
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7893519, 'precision': 0.8001667, 'recall': 0.7893518, 'specificity': 0.7893518, 'f1': 0.7874372, 'auroc': 0.8584962, 'binary_precision': 0.85714287, 'binary_recall': 0.6944444, 'binary_specificity': 0.8842593, 'binary_f1_score': 0.7672634}
confusion matrix:
     0    1
0  191   25
1   66  150
better model found
persisted
after epoch: 7,now: 2024-07-27 04:22:31.715560,epoch time: 0:02:20.705129,used: 0:16:29.384888,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_04_06_01_seed_2_23090498
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9849476, 'precision': 0.98498154, 'recall': 0.9849981, 'specificity': 0.9849981, 'f1': 0.98494756, 'auroc': 0.99838126, 'binary_precision': 0.9914474, 'binary_recall': 0.9785714, 'binary_specificity': 0.9914248, 'binary_f1_score': 0.9849673}
confusion matrix:
      0     1
0  1503    13
1    33  1507
---- Validation: 
scalar performance:
{'acc': 0.7683881, 'precision': 0.817472, 'recall': 0.7630578, 'specificity': 0.7630578, 'f1': 0.7565338, 'auroc': 0.8871436, 'binary_precision': 0.93582886, 'binary_recall': 0.562701, 'binary_specificity': 0.9634146, 'binary_f1_score': 0.70281124}
confusion matrix:
     0    1
0  632   24
1  272  350
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7986111, 'precision': 0.80574757, 'recall': 0.7986111, 'specificity': 0.7986111, 'f1': 0.7974291, 'auroc': 0.8893819, 'binary_precision': 0.852459, 'binary_recall': 0.7222222, 'binary_specificity': 0.875, 'binary_f1_score': 0.7819549}
confusion matrix:
     0    1
0  189   27
1   60  156
early stop counter: 1
val acc:0.7683880925178528, best validation acc: 0.8098591566085815, corresponding to test acc:                         0.7893518805503845 / 0.8379629850387573
after epoch: 8,now: 2024-07-27 04:24:51.320372,epoch time: 0:02:19.604812,used: 0:18:48.989700,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_04_06_01_seed_2_23090498
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9748037, 'precision': 0.9751429, 'recall': 0.9749229, 'specificity': 0.9749229, 'f1': 0.97480226, 'auroc': 0.9963249, 'binary_precision': 0.9899531, 'binary_recall': 0.9597403, 'binary_specificity': 0.99010557, 'binary_f1_score': 0.97461253}
confusion matrix:
      0     1
0  1501    15
1    62  1478
---- Validation: 
scalar performance:
{'acc': 0.7934272, 'precision': 0.7965708, 'recall': 0.7947391, 'specificity': 0.7947391, 'f1': 0.79326314, 'auroc': 0.874701, 'binary_precision': 0.7586705, 'binary_recall': 0.8440514, 'binary_specificity': 0.74542683, 'binary_f1_score': 0.7990867}
confusion matrix:
     0    1
0  489  167
1   97  525
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7175926, 'precision': 0.75636363, 'recall': 0.7175926, 'specificity': 0.7175926, 'f1': 0.7064955, 'auroc': 0.8964335, 'binary_precision': 0.6566667, 'binary_recall': 0.912037, 'binary_specificity': 0.5231481, 'binary_f1_score': 0.7635659}
confusion matrix:
     0    1
0  113  103
1   19  197
early stop counter: 2
val acc:0.7934272289276123, best validation acc: 0.8098591566085815, corresponding to test acc:                         0.7893518805503845 / 0.8379629850387573
after epoch: 9,now: 2024-07-27 04:27:10.423124,epoch time: 0:02:19.102752,used: 0:21:08.092452,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_04_06_01_seed_2_23090498
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.98658377, 'precision': 0.9865856, 'recall': 0.9865804, 'specificity': 0.9865804, 'f1': 0.9865829, 'auroc': 0.9983106, 'binary_precision': 0.9863725, 'binary_recall': 0.987013, 'binary_specificity': 0.98614776, 'binary_f1_score': 0.9866926}
confusion matrix:
      0     1
0  1495    21
1    20  1520
---- Validation: 
scalar performance:
{'acc': 0.75273865, 'precision': 0.7559619, 'recall': 0.7541051, 'specificity': 0.7541051, 'f1': 0.7524961, 'auroc': 0.83431196, 'binary_precision': 0.7198276, 'binary_recall': 0.80546623, 'binary_specificity': 0.7027439, 'binary_f1_score': 0.76024276}
confusion matrix:
     0    1
0  461  195
1  121  501
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7893519, 'precision': 0.789358, 'recall': 0.7893518, 'specificity': 0.7893518, 'f1': 0.78935075, 'auroc': 0.806863, 'binary_precision': 0.7906977, 'binary_recall': 0.787037, 'binary_specificity': 0.7916667, 'binary_f1_score': 0.7888631}
confusion matrix:
     0    1
0  171   45
1   46  170
early stop counter: 3
val acc:0.7527386546134949, best validation acc: 0.8098591566085815, corresponding to test acc:                         0.7893518805503845 / 0.8379629850387573
after epoch: 10,now: 2024-07-27 04:29:29.701339,epoch time: 0:02:19.278215,used: 0:23:27.370667,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_04_06_01_seed_2_23090498
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9790576, 'precision': 0.9793118, 'recall': 0.97897923, 'specificity': 0.97897923, 'f1': 0.9790511, 'auroc': 0.9983647, 'binary_precision': 0.9700637, 'binary_recall': 0.98896104, 'binary_specificity': 0.96899736, 'binary_f1_score': 0.97942126}
confusion matrix:
      0     1
0  1469    47
1    17  1523
---- Validation: 
scalar performance:
{'acc': 0.8200313, 'precision': 0.82092583, 'recall': 0.8207371, 'specificity': 0.8207371, 'f1': 0.82002735, 'auroc': 0.9023832, 'binary_precision': 0.7960725, 'binary_recall': 0.84726685, 'binary_specificity': 0.79420733, 'binary_f1_score': 0.8208722}
confusion matrix:
     0    1
0  521  135
1   95  527
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8009259, 'precision': 0.8030303, 'recall': 0.80092597, 'specificity': 0.80092597, 'f1': 0.8005797, 'auroc': 0.89954126, 'binary_precision': 0.7777778, 'binary_recall': 0.8425926, 'binary_specificity': 0.7592593, 'binary_f1_score': 0.80888885}
confusion matrix:
     0    1
0  164   52
1   34  182
better model found
persisted
after epoch: 11,now: 2024-07-27 04:31:50.309290,epoch time: 0:02:20.607951,used: 0:25:47.978618,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_04_06_01_seed_2_23090498
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.99051046, 'precision': 0.9905029, 'recall': 0.99052787, 'specificity': 0.99052787, 'f1': 0.9905102, 'auroc': 0.9996244, 'binary_precision': 0.99282455, 'binary_recall': 0.9883117, 'binary_specificity': 0.9927441, 'binary_f1_score': 0.990563}
confusion matrix:
      0     1
0  1505    11
1    18  1522
---- Validation: 
scalar performance:
{'acc': 0.80672926, 'precision': 0.82419384, 'recall': 0.8035718, 'specificity': 0.8035718, 'f1': 0.8028619, 'auroc': 0.90193665, 'binary_precision': 0.8930818, 'binary_recall': 0.68488747, 'binary_specificity': 0.9222561, 'binary_f1_score': 0.77525026}
confusion matrix:
     0    1
0  605   51
1  196  426
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7523148, 'precision': 0.82291865, 'recall': 0.7523148, 'specificity': 0.7523148, 'f1': 0.73799336, 'auroc': 0.91049385, 'binary_precision': 0.973913, 'binary_recall': 0.5185185, 'binary_specificity': 0.9861111, 'binary_f1_score': 0.6767372}
confusion matrix:
     0    1
0  213    3
1  104  112
early stop counter: 1
val acc:0.806729257106781, best validation acc: 0.8200312852859497, corresponding to test acc:                         0.8009259104728699 / 0.8379629850387573
after epoch: 12,now: 2024-07-27 04:34:10.076217,epoch time: 0:02:19.766927,used: 0:28:07.745545,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_04_06_01_seed_2_23090498
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9859293, 'precision': 0.9859693, 'recall': 0.9859824, 'specificity': 0.9859824, 'f1': 0.98592937, 'auroc': 0.99937767, 'binary_precision': 0.9927584, 'binary_recall': 0.9792208, 'binary_specificity': 0.9927441, 'binary_f1_score': 0.9859432}
confusion matrix:
      0     1
0  1505    11
1    32  1508
---- Validation: 
scalar performance:
{'acc': 0.80438185, 'precision': 0.8318187, 'recall': 0.8004936, 'specificity': 0.8004936, 'f1': 0.79873866, 'auroc': 0.8849673, 'binary_precision': 0.92081445, 'binary_recall': 0.65434086, 'binary_specificity': 0.94664633, 'binary_f1_score': 0.76503766}
confusion matrix:
     0    1
0  621   35
1  215  407
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6921296, 'precision': 0.7799938, 'recall': 0.6921296, 'specificity': 0.6921296, 'f1': 0.6659205, 'auroc': 0.8118999, 'binary_precision': 0.9368421, 'binary_recall': 0.41203704, 'binary_specificity': 0.9722222, 'binary_f1_score': 0.5723473}
confusion matrix:
     0   1
0  210   6
1  127  89
early stop counter: 2
val acc:0.8043818473815918, best validation acc: 0.8200312852859497, corresponding to test acc:                         0.8009259104728699 / 0.8379629850387573
after epoch: 13,now: 2024-07-27 04:36:30.168587,epoch time: 0:02:20.092370,used: 0:30:27.837915,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_04_06_01_seed_2_23090498
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.98920155, 'precision': 0.9892112, 'recall': 0.98923945, 'specificity': 0.98923945, 'f1': 0.9892014, 'auroc': 0.9995464, 'binary_precision': 0.99409837, 'binary_recall': 0.9844156, 'binary_specificity': 0.9940633, 'binary_f1_score': 0.98923326}
confusion matrix:
      0     1
0  1507     9
1    24  1516
---- Validation: 
scalar performance:
{'acc': 0.7370892, 'precision': 0.80573165, 'recall': 0.7306535, 'specificity': 0.7306535, 'f1': 0.7178155, 'auroc': 0.8972434, 'binary_precision': 0.94409937, 'binary_recall': 0.488746, 'binary_specificity': 0.972561, 'binary_f1_score': 0.64406776}
confusion matrix:
     0    1
0  638   18
1  318  304
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7685185, 'precision': 0.83461535, 'recall': 0.7685185, 'specificity': 0.7685185, 'f1': 0.75649345, 'auroc': 0.9096365, 'binary_precision': 0.98333335, 'binary_recall': 0.5462963, 'binary_specificity': 0.9907407, 'binary_f1_score': 0.70238096}
confusion matrix:
     0    1
0  214    2
1   98  118
early stop counter: 3
val acc:0.737089216709137, best validation acc: 0.8200312852859497, corresponding to test acc:                         0.8009259104728699 / 0.8379629850387573
after epoch: 14,now: 2024-07-27 04:38:50.121925,epoch time: 0:02:19.953338,used: 0:32:47.791253,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_04_06_01_seed_2_23090498
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.98134816, 'precision': 0.9815962, 'recall': 0.98145235, 'specificity': 0.98145235, 'f1': 0.98134756, 'auroc': 0.99876857, 'binary_precision': 0.9946631, 'binary_recall': 0.9681818, 'binary_specificity': 0.99472296, 'binary_f1_score': 0.98124385}
confusion matrix:
      0     1
0  1508     8
1    49  1491
---- Validation: 
scalar performance:
{'acc': 0.7910798, 'precision': 0.8161849, 'recall': 0.7872446, 'specificity': 0.7872446, 'f1': 0.7852254, 'auroc': 0.8883519, 'binary_precision': 0.8988764, 'binary_recall': 0.6430868, 'binary_specificity': 0.93140244, 'binary_f1_score': 0.7497657}
confusion matrix:
     0    1
0  611   45
1  222  400
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.587963, 'precision': 0.72265625, 'recall': 0.587963, 'specificity': 0.587963, 'f1': 0.51454544, 'auroc': 0.8524091, 'binary_precision': 0.8958333, 'binary_recall': 0.19907407, 'binary_specificity': 0.9768519, 'binary_f1_score': 0.32575756}
confusion matrix:
     0   1
0  211   5
1  173  43
early stop counter: 4
val acc:0.7910798192024231, best validation acc: 0.8200312852859497, corresponding to test acc:                         0.8009259104728699 / 0.8379629850387573
after epoch: 15,now: 2024-07-27 04:41:09.668248,epoch time: 0:02:19.546323,used: 0:35:07.337576,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_04_06_01_seed_2_23090498
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9849476, 'precision': 0.98497933, 'recall': 0.9849261, 'specificity': 0.9849261, 'f1': 0.984946, 'auroc': 0.99859893, 'binary_precision': 0.98255813, 'binary_recall': 0.9876623, 'binary_specificity': 0.98218995, 'binary_f1_score': 0.9851036}
confusion matrix:
      0     1
0  1489    27
1    19  1521
---- Validation: 
scalar performance:
{'acc': 0.8028169, 'precision': 0.8040496, 'recall': 0.801844, 'specificity': 0.801844, 'f1': 0.8021536, 'auroc': 0.85206556, 'binary_precision': 0.8178694, 'binary_recall': 0.76527333, 'binary_specificity': 0.8384146, 'binary_f1_score': 0.7906977}
confusion matrix:
     0    1
0  550  106
1  146  476
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7986111, 'precision': 0.79866874, 'recall': 0.79861116, 'specificity': 0.79861116, 'f1': 0.7986014, 'auroc': 0.81404316, 'binary_precision': 0.79452056, 'binary_recall': 0.8055556, 'binary_specificity': 0.7916667, 'binary_f1_score': 0.79999995}
confusion matrix:
     0    1
0  171   45
1   42  174
early stop counter: 5
val acc:0.8028169274330139, best validation acc: 0.8200312852859497, corresponding to test acc:                         0.8009259104728699 / 0.8379629850387573
after epoch: 16,now: 2024-07-27 04:43:29.289198,epoch time: 0:02:19.620950,used: 0:37:26.958526,model: dset_te_center0_diva_b8efecac6_not_commited_2024md_07md_27_04_06_01_seed_2_23090498
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 16 with time: 0:37:26.958526 at 2024-07-27 04:43:29.289198
persisted model performance metric: 

scalar performance:
{'acc': 0.8009259, 'precision': 0.8030303, 'recall': 0.80092597, 'specificity': 0.80092597, 'f1': 0.8005797, 'auroc': 0.89954126, 'binary_precision': 0.7777778, 'binary_recall': 0.8425926, 'binary_specificity': 0.7592593, 'binary_f1_score': 0.80888885}
confusion matrix:
     0    1
0  164   52
1   34  182
oracle model performance metric: 

scalar performance:
{'acc': 0.837963, 'precision': 0.837963, 'recall': 0.837963, 'specificity': 0.837963, 'f1': 0.8379629, 'auroc': 0.91949594, 'binary_precision': 0.837963, 'binary_recall': 0.837963, 'binary_specificity': 0.837963, 'binary_f1_score': 0.8379629}
confusion matrix:
     0    1
0  181   35
1   35  181
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_diva_irm_3seeds_nofreeze_2024-07-27_01-18-02/rule_results/10.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_diva_irm_3seeds_nofreeze_2024-07-27_01-18-02/confusion_matrix/10.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   2829 MiB |   9180 MiB | 255787 GiB | 255784 GiB |
|       from large pool |   2740 MiB |   9106 MiB | 253395 GiB | 253392 GiB |
|       from small pool |     89 MiB |    130 MiB |   2392 GiB |   2392 GiB |
|---------------------------------------------------------------------------|
| Active memory         |   2829 MiB |   9180 MiB | 255787 GiB | 255784 GiB |
|       from large pool |   2740 MiB |   9106 MiB | 253395 GiB | 253392 GiB |
|       from small pool |     89 MiB |    130 MiB |   2392 GiB |   2392 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |   2813 MiB |   9170 MiB | 255487 GiB | 255485 GiB |
|       from large pool |   2723 MiB |   9096 MiB | 253099 GiB | 253096 GiB |
|       from small pool |     89 MiB |    130 MiB |   2388 GiB |   2388 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   9656 MiB |   9750 MiB |  21030 MiB |  11374 MiB |
|       from large pool |   9522 MiB |   9616 MiB |  20820 MiB |  11298 MiB |
|       from small pool |    134 MiB |    140 MiB |    210 MiB |     76 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |   1148 MiB |   2997 MiB | 237175 GiB | 237174 GiB |
|       from large pool |   1139 MiB |   2989 MiB | 234718 GiB | 234717 GiB |
|       from small pool |      8 MiB |     47 MiB |   2456 GiB |   2456 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    2464    |    3329    |   38850 K  |   38848 K  |
|       from large pool |     392    |     816    |   19424 K  |   19423 K  |
|       from small pool |    2072    |    2780    |   19426 K  |   19424 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    2464    |    3329    |   38850 K  |   38848 K  |
|       from large pool |     392    |     816    |   19424 K  |   19423 K  |
|       from small pool |    2072    |    2780    |   19426 K  |   19424 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     214    |     266    |     456    |     242    |
|       from large pool |     147    |     199    |     351    |     204    |
|       from small pool |      67    |      70    |     105    |      38    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     156    |     319    |   20084 K  |   20084 K  |
|       from large pool |      75    |     186    |   10636 K  |   10636 K  |
|       from small pool |      81    |     235    |    9447 K  |    9447 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   9180 MiB | 255787 GiB | 255787 GiB |
|       from large pool |  16640 KiB |   9106 MiB | 253395 GiB | 253395 GiB |
|       from small pool |      0 KiB |    130 MiB |   2392 GiB |   2392 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   9180 MiB | 255787 GiB | 255787 GiB |
|       from large pool |  16640 KiB |   9106 MiB | 253395 GiB | 253395 GiB |
|       from small pool |      0 KiB |    130 MiB |   2392 GiB |   2392 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   9170 MiB | 255487 GiB | 255487 GiB |
|       from large pool |  16640 KiB |   9096 MiB | 253099 GiB | 253099 GiB |
|       from small pool |      0 KiB |    130 MiB |   2388 GiB |   2388 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   3978 MiB |   9750 MiB |  21030 MiB |  17052 MiB |
|       from large pool |   3880 MiB |   9616 MiB |  20820 MiB |  16940 MiB |
|       from small pool |     98 MiB |    140 MiB |    210 MiB |    112 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   2997 MiB | 237176 GiB | 237176 GiB |
|       from large pool |  24320 KiB |   2989 MiB | 234719 GiB | 234719 GiB |
|       from small pool |      0 KiB |     48 MiB |   2456 GiB |   2456 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3329    |   38850 K  |   38850 K  |
|       from large pool |       2    |     816    |   19424 K  |   19424 K  |
|       from small pool |       0    |    2780    |   19426 K  |   19426 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3329    |   38850 K  |   38850 K  |
|       from large pool |       2    |     816    |   19424 K  |   19424 K  |
|       from small pool |       0    |    2780    |   19426 K  |   19426 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     127    |     266    |     456    |     329    |
|       from large pool |      78    |     199    |     351    |     273    |
|       from small pool |      49    |      70    |     105    |      56    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     319    |   20084 K  |   20084 K  |
|       from large pool |       3    |     186    |   10636 K  |   10636 K  |
|       from small pool |       0    |     235    |    9447 K  |    9447 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Sat Jul 27 04:43:39 2024]
Finished job 0.
1 of 1 steps (100%) done
