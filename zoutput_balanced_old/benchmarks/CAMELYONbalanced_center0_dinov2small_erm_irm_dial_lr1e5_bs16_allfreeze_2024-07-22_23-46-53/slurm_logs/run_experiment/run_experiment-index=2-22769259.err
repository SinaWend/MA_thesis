Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Mon Jul 22 23:49:09 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_dial_lr1e5_bs16_allfreeze_2024-07-22_23-46-53/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_dial_lr1e5_bs16_allfreeze_2024-07-22_23-46-53/rule_results/2.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=2
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/swiglu_ffn.py:51: UserWarning: xFormers is not available (SwiGLU)
  warnings.warn("xFormers is not available (SwiGLU)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/attention.py:33: UserWarning: xFormers is not available (Attention)
  warnings.warn("xFormers is not available (Attention)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/block.py:40: UserWarning: xFormers is not available (Block)
  warnings.warn("xFormers is not available (Block)")
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'888c1ef2'
model name: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_22_23_51_17_seed_0_22769259

 Experiment start at: 2024-07-22 23:51:17.689928
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
before training, model accuracy: 0.569767415523529
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.4658203, 'precision': 0.46541998, 'recall': 0.46549657, 'specificity': 0.46549657, 'f1': 0.46530896, 'auroc': 0.4651997, 'binary_precision': 0.47361887, 'binary_recall': 0.4903599, 'binary_specificity': 0.44063324, 'binary_f1_score': 0.481844}
confusion matrix:
     0    1
0  668  848
1  793  763
---- Validation: 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
scalar performance:
{'acc': 0.6296584, 'precision': 0.6338495, 'recall': 0.6282512, 'specificity': 0.6282512, 'f1': 0.6251663, 'auroc': 0.69967324, 'binary_precision': 0.6542969, 'binary_recall': 0.52755904, 'binary_specificity': 0.72894335, 'binary_f1_score': 0.58413255}
confusion matrix:
     0    1
0  476  177
1  300  335
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6255814, 'precision': 0.62985414, 'recall': 0.6255814, 'specificity': 0.6255814, 'f1': 0.62247586, 'auroc': 0.6569605, 'binary_precision': 0.65340906, 'binary_recall': 0.53488374, 'binary_specificity': 0.7162791, 'binary_f1_score': 0.5882353}
confusion matrix:
     0    1
0  154   61
1  100  115
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-22 23:53:01.534831,epoch time: 0:01:43.844903,used: 0:01:43.844903,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_22_23_51_17_seed_0_22769259
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.4781901, 'precision': 0.47755098, 'recall': 0.47768193, 'specificity': 0.47768193, 'f1': 0.47711957, 'auroc': 0.48414427, 'binary_precision': 0.4858006, 'binary_recall': 0.5167095, 'binary_specificity': 0.43865436, 'binary_f1_score': 0.50077856}
confusion matrix:
     0    1
0  665  851
1  752  804
---- Validation: 
scalar performance:
{'acc': 0.6529503, 'precision': 0.6547773, 'recall': 0.6520469, 'specificity': 0.6520469, 'f1': 0.651052, 'auroc': 0.7175194, 'binary_precision': 0.66845876, 'binary_recall': 0.58740157, 'binary_specificity': 0.7166922, 'binary_f1_score': 0.62531435}
confusion matrix:
     0    1
0  468  185
1  262  373
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6534884, 'precision': 0.6555921, 'recall': 0.6534884, 'specificity': 0.6534884, 'f1': 0.6523131, 'auroc': 0.68389404, 'binary_precision': 0.67368424, 'binary_recall': 0.59534883, 'binary_specificity': 0.7116279, 'binary_f1_score': 0.6320988}
confusion matrix:
     0    1
0  153   62
1   87  128
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-07-22 23:54:22.527069,epoch time: 0:01:20.992238,used: 0:03:04.837141,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_22_23_51_17_seed_0_22769259
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.52278644, 'precision': 0.5224186, 'recall': 0.5222901, 'specificity': 0.5222901, 'f1': 0.5218215, 'auroc': 0.55948675, 'binary_precision': 0.5272068, 'binary_recall': 0.56041133, 'binary_specificity': 0.48416886, 'binary_f1_score': 0.5433022}
confusion matrix:
     0    1
0  734  782
1  684  872
---- Validation: 
scalar performance:
{'acc': 0.6669255, 'precision': 0.6684468, 'recall': 0.6661333, 'specificity': 0.6661333, 'f1': 0.66546845, 'auroc': 0.73171437, 'binary_precision': 0.681338, 'binary_recall': 0.6094488, 'binary_specificity': 0.7228178, 'binary_f1_score': 0.6433915}
confusion matrix:
     0    1
0  472  181
1  248  387
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6627907, 'precision': 0.6650219, 'recall': 0.66279066, 'specificity': 0.66279066, 'f1': 0.66164696, 'auroc': 0.7054192, 'binary_precision': 0.68421054, 'binary_recall': 0.60465115, 'binary_specificity': 0.7209302, 'binary_f1_score': 0.6419753}
confusion matrix:
     0    1
0  155   60
1   85  130
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-07-22 23:55:43.999663,epoch time: 0:01:21.472594,used: 0:04:26.309735,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_22_23_51_17_seed_0_22769259
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.5670573, 'precision': 0.5669073, 'recall': 0.56685174, 'specificity': 0.56685174, 'f1': 0.5668324, 'auroc': 0.6016071, 'binary_precision': 0.57160884, 'binary_recall': 0.58188826, 'binary_specificity': 0.55181515, 'binary_f1_score': 0.5767028}
confusion matrix:
     0    1
0  836  679
1  651  906
---- Validation: 
scalar performance:
{'acc': 0.6793478, 'precision': 0.6806238, 'recall': 0.6786449, 'specificity': 0.6786449, 'f1': 0.67819774, 'auroc': 0.7444719, 'binary_precision': 0.6927083, 'binary_recall': 0.62834644, 'binary_specificity': 0.72894335, 'binary_f1_score': 0.65895957}
confusion matrix:
     0    1
0  476  177
1  236  399
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.67209303, 'precision': 0.67408526, 'recall': 0.67209303, 'specificity': 0.67209303, 'f1': 0.67115223, 'auroc': 0.72352624, 'binary_precision': 0.6927083, 'binary_recall': 0.61860466, 'binary_specificity': 0.7255814, 'binary_f1_score': 0.6535627}
confusion matrix:
     0    1
0  156   59
1   82  133
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-07-22 23:57:05.387458,epoch time: 0:01:21.387795,used: 0:05:47.697530,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_22_23_51_17_seed_0_22769259
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.60872394, 'precision': 0.6093627, 'recall': 0.6079162, 'specificity': 0.6079162, 'f1': 0.6070584, 'auroc': 0.65602684, 'binary_precision': 0.60385066, 'binary_recall': 0.6643132, 'binary_specificity': 0.55151916, 'binary_f1_score': 0.63264054}
confusion matrix:
     0     1
0  835   679
1  523  1035
---- Validation: 
scalar performance:
{'acc': 0.7003106, 'precision': 0.70025647, 'recall': 0.7001869, 'specificity': 0.7001869, 'f1': 0.7002065, 'auroc': 0.75604534, 'binary_precision': 0.69793326, 'binary_recall': 0.6913386, 'binary_specificity': 0.7090352, 'binary_f1_score': 0.6946203}
confusion matrix:
     0    1
0  463  190
1  196  439
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6744186, 'precision': 0.67496365, 'recall': 0.67441857, 'specificity': 0.67441857, 'f1': 0.67416483, 'auroc': 0.7400757, 'binary_precision': 0.68472904, 'binary_recall': 0.6465116, 'binary_specificity': 0.7023256, 'binary_f1_score': 0.6650717}
confusion matrix:
     0    1
0  151   64
1   76  139
new oracle model saved
better model found
persisted
after epoch: 5,now: 2024-07-22 23:58:27.105596,epoch time: 0:01:21.718138,used: 0:07:09.415668,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_22_23_51_17_seed_0_22769259
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.6455078, 'precision': 0.64541185, 'recall': 0.6453357, 'specificity': 0.6453357, 'f1': 0.645349, 'auroc': 0.69200385, 'binary_precision': 0.6489227, 'binary_recall': 0.6568313, 'binary_specificity': 0.63384, 'binary_f1_score': 0.6528531}
confusion matrix:
     0     1
0  959   554
1  535  1024
---- Validation: 
scalar performance:
{'acc': 0.71118015, 'precision': 0.7118751, 'recall': 0.71068966, 'specificity': 0.71068966, 'f1': 0.7105932, 'auroc': 0.7649323, 'binary_precision': 0.7210084, 'binary_recall': 0.6755906, 'binary_specificity': 0.7457887, 'binary_f1_score': 0.69756097}
confusion matrix:
     0    1
0  487  166
1  206  429
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.68139535, 'precision': 0.6825366, 'recall': 0.68139535, 'specificity': 0.68139535, 'f1': 0.6808966, 'auroc': 0.7544402, 'binary_precision': 0.6969697, 'binary_recall': 0.6418605, 'binary_specificity': 0.7209302, 'binary_f1_score': 0.66828084}
confusion matrix:
     0    1
0  155   60
1   77  138
new oracle model saved
better model found
persisted
after epoch: 6,now: 2024-07-22 23:59:49.073600,epoch time: 0:01:21.968004,used: 0:08:31.383672,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_22_23_51_17_seed_0_22769259
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.6686198, 'precision': 0.6685833, 'recall': 0.6684644, 'specificity': 0.6684644, 'f1': 0.66847587, 'auroc': 0.7233641, 'binary_precision': 0.66982925, 'binary_recall': 0.68102896, 'binary_specificity': 0.6558998, 'binary_f1_score': 0.6753827}
confusion matrix:
     0     1
0  995   522
1  496  1059
---- Validation: 
scalar performance:
{'acc': 0.7197205, 'precision': 0.71983224, 'recall': 0.71945953, 'specificity': 0.71945953, 'f1': 0.719489, 'auroc': 0.7726158, 'binary_precision': 0.7224026, 'binary_recall': 0.7007874, 'binary_specificity': 0.7381317, 'binary_f1_score': 0.71143085}
confusion matrix:
     0    1
0  482  171
1  190  445
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6883721, 'precision': 0.68917423, 'recall': 0.6883721, 'specificity': 0.6883721, 'f1': 0.68804145, 'auroc': 0.76473767, 'binary_precision': 0.70149255, 'binary_recall': 0.65581393, 'binary_specificity': 0.7209302, 'binary_f1_score': 0.67788464}
confusion matrix:
     0    1
0  155   60
1   74  141
new oracle model saved
better model found
persisted
after epoch: 7,now: 2024-07-23 00:01:10.285654,epoch time: 0:01:21.212054,used: 0:09:52.595726,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_22_23_51_17_seed_0_22769259
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.6930339, 'precision': 0.6936415, 'recall': 0.6926043, 'specificity': 0.6926043, 'f1': 0.6924573, 'auroc': 0.75615966, 'binary_precision': 0.68545455, 'binary_recall': 0.72733116, 'binary_specificity': 0.6578774, 'binary_f1_score': 0.70577216}
confusion matrix:
     0     1
0  998   519
1  424  1131
---- Validation: 
scalar performance:
{'acc': 0.7204969, 'precision': 0.7204827, 'recall': 0.7203338, 'specificity': 0.7203338, 'f1': 0.72036475, 'auroc': 0.7800822, 'binary_precision': 0.72, 'binary_recall': 0.70866144, 'binary_specificity': 0.73200613, 'binary_f1_score': 0.71428573}
confusion matrix:
     0    1
0  478  175
1  185  450
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7, 'precision': 0.70021224, 'recall': 0.70000005, 'specificity': 0.70000005, 'f1': 0.69992054, 'auroc': 0.77442944, 'binary_precision': 0.7067308, 'binary_recall': 0.68372095, 'binary_specificity': 0.7162791, 'binary_f1_score': 0.6950355}
confusion matrix:
     0    1
0  154   61
1   68  147
new oracle model saved
better model found
persisted
after epoch: 8,now: 2024-07-23 00:02:31.610860,epoch time: 0:01:21.325206,used: 0:11:13.920932,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_22_23_51_17_seed_0_22769259
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.7314453, 'precision': 0.7317842, 'recall': 0.73165834, 'specificity': 0.73165834, 'f1': 0.7314328, 'auroc': 0.78830516, 'binary_precision': 0.7444816, 'binary_recall': 0.7152956, 'binary_specificity': 0.7480211, 'binary_f1_score': 0.7295969}
confusion matrix:
      0     1
0  1134   382
1   443  1113
---- Validation: 
scalar performance:
{'acc': 0.7204969, 'precision': 0.72161454, 'recall': 0.71992135, 'specificity': 0.71992135, 'f1': 0.7197611, 'auroc': 0.784621, 'binary_precision': 0.7342419, 'binary_recall': 0.67874014, 'binary_specificity': 0.7611026, 'binary_f1_score': 0.705401}
confusion matrix:
     0    1
0  497  156
1  204  431
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6976744, 'precision': 0.69906974, 'recall': 0.6976744, 'specificity': 0.6976744, 'f1': 0.69714373, 'auroc': 0.782477, 'binary_precision': 0.71573603, 'binary_recall': 0.65581393, 'binary_specificity': 0.73953485, 'binary_f1_score': 0.684466}
confusion matrix:
     0    1
0  159   56
1   74  141
early stop counter: 1
val acc:0.7204968929290771, best validation acc: 0.7204968929290771, corresponding to test acc:                         0.699999988079071 / 0.699999988079071
after epoch: 9,now: 2024-07-23 00:03:52.708876,epoch time: 0:01:21.098016,used: 0:12:35.018948,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_22_23_51_17_seed_0_22769259
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.74641925, 'precision': 0.74639887, 'recall': 0.7464328, 'specificity': 0.7464328, 'f1': 0.7464025, 'auroc': 0.8058747, 'binary_precision': 0.75162125, 'binary_recall': 0.7453376, 'binary_specificity': 0.747528, 'binary_f1_score': 0.74846625}
confusion matrix:
      0     1
0  1134   383
1   396  1159
---- Validation: 
scalar performance:
{'acc': 0.7290373, 'precision': 0.72942376, 'recall': 0.72866964, 'specificity': 0.72866964, 'f1': 0.72867596, 'auroc': 0.7907032, 'binary_precision': 0.7359736, 'binary_recall': 0.7023622, 'binary_specificity': 0.75497705, 'binary_f1_score': 0.71877515}
confusion matrix:
     0    1
0  493  160
1  189  446
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7046512, 'precision': 0.7051883, 'recall': 0.7046511, 'specificity': 0.7046511, 'f1': 0.70445776, 'auroc': 0.79043806, 'binary_precision': 0.71568626, 'binary_recall': 0.67906976, 'binary_specificity': 0.73023254, 'binary_f1_score': 0.6968973}
confusion matrix:
     0    1
0  157   58
1   69  146
new oracle model saved
better model found
persisted
after epoch: 10,now: 2024-07-23 00:05:15.703346,epoch time: 0:01:22.994470,used: 0:13:58.013418,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_22_23_51_17_seed_0_22769259
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.7561849, 'precision': 0.75615144, 'recall': 0.7561817, 'specificity': 0.7561817, 'f1': 0.7561601, 'auroc': 0.82142854, 'binary_precision': 0.7608274, 'binary_recall': 0.75642675, 'binary_specificity': 0.7559367, 'binary_f1_score': 0.75862074}
confusion matrix:
      0     1
0  1146   370
1   379  1177
---- Validation: 
scalar performance:
{'acc': 0.73136646, 'precision': 0.732011, 'recall': 0.7309233, 'specificity': 0.7309233, 'f1': 0.7308934, 'auroc': 0.79580617, 'binary_precision': 0.7412354, 'binary_recall': 0.6992126, 'binary_specificity': 0.762634, 'binary_f1_score': 0.719611}
confusion matrix:
     0    1
0  498  155
1  191  444
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7116279, 'precision': 0.71208674, 'recall': 0.7116279, 'specificity': 0.7116279, 'f1': 0.7114719, 'auroc': 0.7979448, 'binary_precision': 0.72195125, 'binary_recall': 0.6883721, 'binary_specificity': 0.7348837, 'binary_f1_score': 0.70476186}
confusion matrix:
     0    1
0  158   57
1   67  148
new oracle model saved
better model found
persisted
after epoch: 11,now: 2024-07-23 00:06:39.232877,epoch time: 0:01:23.529531,used: 0:15:21.542949,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_22_23_51_17_seed_0_22769259
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.75716144, 'precision': 0.75783956, 'recall': 0.7574811, 'specificity': 0.7574811, 'f1': 0.7571203, 'auroc': 0.82785296, 'binary_precision': 0.7749153, 'binary_recall': 0.73410404, 'binary_specificity': 0.7808581, 'binary_f1_score': 0.7539578}
confusion matrix:
      0     1
0  1183   332
1   414  1143
---- Validation: 
scalar performance:
{'acc': 0.72981364, 'precision': 0.7320026, 'recall': 0.7290664, 'specificity': 0.7290664, 'f1': 0.7287141, 'auroc': 0.7994549, 'binary_precision': 0.7513135, 'binary_recall': 0.6755906, 'binary_specificity': 0.7825421, 'binary_f1_score': 0.7114428}
confusion matrix:
     0    1
0  511  142
1  206  429
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7162791, 'precision': 0.7185676, 'recall': 0.71627903, 'specificity': 0.71627903, 'f1': 0.71553445, 'auroc': 0.8035695, 'binary_precision': 0.74093264, 'binary_recall': 0.66511625, 'binary_specificity': 0.76744187, 'binary_f1_score': 0.70098037}
confusion matrix:
     0    1
0  165   50
1   72  143
new oracle model saved
early stop counter: 1
val acc:0.7298136353492737, best validation acc: 0.7313664555549622, corresponding to test acc:                         0.7116279006004333 / 0.7162790894508362
after epoch: 12,now: 2024-07-23 00:08:01.035020,epoch time: 0:01:21.802143,used: 0:16:43.345092,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_22_23_51_17_seed_0_22769259
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.7652995, 'precision': 0.76567996, 'recall': 0.7655451, 'specificity': 0.7655451, 'f1': 0.7652905, 'auroc': 0.8350097, 'binary_precision': 0.7799331, 'binary_recall': 0.7483954, 'binary_specificity': 0.7826949, 'binary_f1_score': 0.7638389}
confusion matrix:
      0     1
0  1185   329
1   392  1166
---- Validation: 
scalar performance:
{'acc': 0.738354, 'precision': 0.7388414, 'recall': 0.7379665, 'specificity': 0.7379665, 'f1': 0.73797476, 'auroc': 0.80472445, 'binary_precision': 0.7466887, 'binary_recall': 0.7102362, 'binary_specificity': 0.76569676, 'binary_f1_score': 0.7280064}
confusion matrix:
     0    1
0  500  153
1  184  451
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7348837, 'precision': 0.7348837, 'recall': 0.7348837, 'specificity': 0.7348837, 'f1': 0.7348837, 'auroc': 0.81038404, 'binary_precision': 0.7348837, 'binary_recall': 0.7348837, 'binary_specificity': 0.7348837, 'binary_f1_score': 0.7348837}
confusion matrix:
     0    1
0  158   57
1   57  158
new oracle model saved
better model found
persisted
after epoch: 13,now: 2024-07-23 00:09:23.088563,epoch time: 0:01:22.053543,used: 0:18:05.398635,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_22_23_51_17_seed_0_22769259
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.77701825, 'precision': 0.776981, 'recall': 0.7769762, 'specificity': 0.7769762, 'f1': 0.7769785, 'auroc': 0.8538024, 'binary_precision': 0.7797046, 'binary_recall': 0.78020567, 'binary_specificity': 0.7737467, 'binary_f1_score': 0.779955}
confusion matrix:
      0     1
0  1173   343
1   342  1214
---- Validation: 
scalar performance:
{'acc': 0.742236, 'precision': 0.7427752, 'recall': 0.7418384, 'specificity': 0.7418384, 'f1': 0.741847, 'auroc': 0.8086144, 'binary_precision': 0.75124377, 'binary_recall': 0.7133858, 'binary_specificity': 0.770291, 'binary_f1_score': 0.7318255}
confusion matrix:
     0    1
0  503  150
1  182  453
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.74651164, 'precision': 0.7465596, 'recall': 0.7465116, 'specificity': 0.7465116, 'f1': 0.7464993, 'auroc': 0.8158139, 'binary_precision': 0.75, 'binary_recall': 0.73953485, 'binary_specificity': 0.75348836, 'binary_f1_score': 0.74473065}
confusion matrix:
     0    1
0  162   53
1   56  159
new oracle model saved
better model found
persisted
after epoch: 14,now: 2024-07-23 00:10:46.116756,epoch time: 0:01:23.028193,used: 0:19:28.426828,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_22_23_51_17_seed_0_22769259
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.7815755, 'precision': 0.7819059, 'recall': 0.7818142, 'specificity': 0.7818142, 'f1': 0.7815716, 'auroc': 0.8624176, 'binary_precision': 0.796, 'binary_recall': 0.7658756, 'binary_specificity': 0.7977528, 'binary_f1_score': 0.7806473}
confusion matrix:
      0     1
0  1207   306
1   365  1194
---- Validation: 
scalar performance:
{'acc': 0.746118, 'precision': 0.74649763, 'recall': 0.7457754, 'specificity': 0.7457754, 'f1': 0.7458077, 'auroc': 0.8115711, 'binary_precision': 0.75328946, 'binary_recall': 0.72125983, 'binary_specificity': 0.770291, 'binary_f1_score': 0.7369268}
confusion matrix:
     0    1
0  503  150
1  177  458
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.74651164, 'precision': 0.74651694, 'recall': 0.74651164, 'specificity': 0.74651164, 'f1': 0.74651027, 'auroc': 0.8208978, 'binary_precision': 0.74766356, 'binary_recall': 0.74418604, 'binary_specificity': 0.74883723, 'binary_f1_score': 0.7459207}
confusion matrix:
     0    1
0  161   54
1   55  160
better model found
persisted
after epoch: 15,now: 2024-07-23 00:12:06.777205,epoch time: 0:01:20.660449,used: 0:20:49.087277,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_22_23_51_17_seed_0_22769259
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.8027344, 'precision': 0.8027688, 'recall': 0.8028089, 'specificity': 0.8028089, 'f1': 0.8027314, 'auroc': 0.8744683, 'binary_precision': 0.81033355, 'binary_recall': 0.7967846, 'binary_specificity': 0.80883324, 'binary_f1_score': 0.80350196}
confusion matrix:
      0     1
0  1227   290
1   316  1239
---- Validation: 
scalar performance:
{'acc': 0.7492236, 'precision': 0.7497531, 'recall': 0.7488382, 'specificity': 0.7488382, 'f1': 0.7488601, 'auroc': 0.8139417, 'binary_precision': 0.75827813, 'binary_recall': 0.72125983, 'binary_specificity': 0.77641654, 'binary_f1_score': 0.73930585}
confusion matrix:
     0    1
0  507  146
1  177  458
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.75581396, 'precision': 0.75581944, 'recall': 0.75581396, 'specificity': 0.75581396, 'f1': 0.75581264, 'auroc': 0.8255489, 'binary_precision': 0.7546296, 'binary_recall': 0.75813955, 'binary_specificity': 0.75348836, 'binary_f1_score': 0.75638044}
confusion matrix:
     0    1
0  162   53
1   52  163
new oracle model saved
better model found
persisted
after epoch: 16,now: 2024-07-23 00:13:28.821449,epoch time: 0:01:22.044244,used: 0:22:11.131521,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_22_23_51_17_seed_0_22769259
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.80045575, 'precision': 0.80041945, 'recall': 0.80041397, 'specificity': 0.80041397, 'f1': 0.8004167, 'auroc': 0.87833333, 'binary_precision': 0.8029525, 'binary_recall': 0.8034682, 'binary_specificity': 0.79735976, 'binary_f1_score': 0.8032103}
confusion matrix:
      0     1
0  1208   307
1   306  1251
---- Validation: 
scalar performance:
{'acc': 0.7554348, 'precision': 0.75549424, 'recall': 0.7552459, 'specificity': 0.7552459, 'f1': 0.755293, 'auroc': 0.8170383, 'binary_precision': 0.75723475, 'binary_recall': 0.7417323, 'binary_specificity': 0.76875955, 'binary_f1_score': 0.74940336}
confusion matrix:
     0    1
0  502  151
1  164  471
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.75581396, 'precision': 0.756263, 'recall': 0.75581396, 'specificity': 0.75581396, 'f1': 0.75570697, 'auroc': 0.82978904, 'binary_precision': 0.74553573, 'binary_recall': 0.7767442, 'binary_specificity': 0.7348837, 'binary_f1_score': 0.76082003}
confusion matrix:
     0    1
0  158   57
1   48  167
better model found
persisted
after epoch: 17,now: 2024-07-23 00:14:50.717342,epoch time: 0:01:21.895893,used: 0:23:33.027414,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_22_23_51_17_seed_0_22769259
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.80338544, 'precision': 0.8033842, 'recall': 0.80327976, 'specificity': 0.80327976, 'f1': 0.80331534, 'auroc': 0.8805827, 'binary_precision': 0.8034351, 'binary_recall': 0.8106547, 'binary_specificity': 0.7959049, 'binary_f1_score': 0.8070288}
confusion matrix:
      0     1
0  1205   309
1   295  1263
---- Validation: 
scalar performance:
{'acc': 0.7554348, 'precision': 0.7556641, 'recall': 0.7551591, 'specificity': 0.7551591, 'f1': 0.75521034, 'auroc': 0.818941, 'binary_precision': 0.7605863, 'binary_recall': 0.73543304, 'binary_specificity': 0.7748851, 'binary_f1_score': 0.74779826}
confusion matrix:
     0    1
0  506  147
1  168  467
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.75581396, 'precision': 0.75595236, 'recall': 0.75581396, 'specificity': 0.75581396, 'f1': 0.75578094, 'auroc': 0.8332504, 'binary_precision': 0.75, 'binary_recall': 0.76744187, 'binary_specificity': 0.74418604, 'binary_f1_score': 0.75862074}
confusion matrix:
     0    1
0  160   55
1   50  165
early stop counter: 1
val acc:0.7554348111152649, best validation acc: 0.7554348111152649, corresponding to test acc:                         0.7558139562606812 / 0.7558139562606812
after epoch: 18,now: 2024-07-23 00:16:13.371651,epoch time: 0:01:22.654309,used: 0:24:55.681723,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_22_23_51_17_seed_0_22769259
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.8069661, 'precision': 0.8069906, 'recall': 0.8070394, 'specificity': 0.8070394, 'f1': 0.80696154, 'auroc': 0.8855761, 'binary_precision': 0.81450033, 'binary_recall': 0.8014139, 'binary_specificity': 0.8126649, 'binary_f1_score': 0.8079041}
confusion matrix:
      0     1
0  1232   284
1   309  1247
---- Validation: 
scalar performance:
{'acc': 0.757764, 'precision': 0.75788134, 'recall': 0.757543, 'specificity': 0.757543, 'f1': 0.75759506, 'auroc': 0.8210826, 'binary_precision': 0.76090467, 'binary_recall': 0.7417323, 'binary_specificity': 0.77335376, 'binary_f1_score': 0.7511962}
confusion matrix:
     0    1
0  505  148
1  164  471
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7627907, 'precision': 0.7629955, 'recall': 0.7627907, 'specificity': 0.7627907, 'f1': 0.7627445, 'auroc': 0.83701456, 'binary_precision': 0.7556561, 'binary_recall': 0.7767442, 'binary_specificity': 0.74883723, 'binary_f1_score': 0.766055}
confusion matrix:
     0    1
0  161   54
1   48  167
new oracle model saved
better model found
persisted
after epoch: 19,now: 2024-07-23 00:17:35.255564,epoch time: 0:01:21.883913,used: 0:26:17.565636,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_22_23_51_17_seed_0_22769259
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.81380206, 'precision': 0.81379414, 'recall': 0.8138468, 'specificity': 0.8138468, 'f1': 0.8137925, 'auroc': 0.89507085, 'binary_precision': 0.819896, 'binary_recall': 0.81041133, 'binary_specificity': 0.8172823, 'binary_f1_score': 0.81512606}
confusion matrix:
      0     1
0  1239   277
1   295  1261
---- Validation: 
scalar performance:
{'acc': 0.757764, 'precision': 0.75788134, 'recall': 0.757543, 'specificity': 0.757543, 'f1': 0.75759506, 'auroc': 0.8226477, 'binary_precision': 0.76090467, 'binary_recall': 0.7417323, 'binary_specificity': 0.77335376, 'binary_f1_score': 0.7511962}
confusion matrix:
     0    1
0  505  148
1  164  471
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.76744187, 'precision': 0.76781267, 'recall': 0.76744187, 'specificity': 0.76744187, 'f1': 0.7673614, 'auroc': 0.8403894, 'binary_precision': 0.75784755, 'binary_recall': 0.7860465, 'binary_specificity': 0.74883723, 'binary_f1_score': 0.77168953}
confusion matrix:
     0    1
0  161   54
1   46  169
new oracle model saved
early stop counter: 1
val acc:0.7577639818191528, best validation acc: 0.7577639818191528, corresponding to test acc:                         0.7627906799316406 / 0.7674418687820435
after epoch: 20,now: 2024-07-23 00:18:57.131998,epoch time: 0:01:21.876434,used: 0:27:39.442070,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_22_23_51_17_seed_0_22769259
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.8063151, 'precision': 0.8069277, 'recall': 0.8066251, 'specificity': 0.8066251, 'f1': 0.8062954, 'auroc': 0.89518416, 'binary_precision': 0.82467973, 'binary_recall': 0.7849808, 'binary_specificity': 0.8282695, 'binary_f1_score': 0.8043407}
confusion matrix:
      0     1
0  1254   260
1   335  1223
---- Validation: 
scalar performance:
{'acc': 0.7484472, 'precision': 0.7494583, 'recall': 0.74794227, 'specificity': 0.74794227, 'f1': 0.7479001, 'auroc': 0.82402956, 'binary_precision': 0.762226, 'binary_recall': 0.711811, 'binary_specificity': 0.78407353, 'binary_f1_score': 0.73615634}
confusion matrix:
     0    1
0  512  141
1  183  452
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7767442, 'precision': 0.7767442, 'recall': 0.7767442, 'specificity': 0.7767442, 'f1': 0.7767441, 'auroc': 0.84259593, 'binary_precision': 0.7767442, 'binary_recall': 0.7767442, 'binary_specificity': 0.7767442, 'binary_f1_score': 0.7767441}
confusion matrix:
     0    1
0  167   48
1   48  167
new oracle model saved
early stop counter: 2
val acc:0.7484471797943115, best validation acc: 0.7577639818191528, corresponding to test acc:                         0.7627906799316406 / 0.7767441868782043
after epoch: 21,now: 2024-07-23 00:20:19.165423,epoch time: 0:01:22.033425,used: 0:29:01.475495,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_22_23_51_17_seed_0_22769259
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.8258464, 'precision': 0.8263862, 'recall': 0.82610935, 'specificity': 0.82610935, 'f1': 0.8258308, 'auroc': 0.9057224, 'binary_precision': 0.8433087, 'binary_recall': 0.8059126, 'binary_specificity': 0.8463061, 'binary_f1_score': 0.8241866}
confusion matrix:
      0     1
0  1283   233
1   302  1254
---- Validation: 
scalar performance:
{'acc': 0.7453416, 'precision': 0.74702203, 'recall': 0.74470586, 'specificity': 0.74470586, 'f1': 0.7445433, 'auroc': 0.8249991, 'binary_precision': 0.7641997, 'binary_recall': 0.6992126, 'binary_specificity': 0.7901991, 'binary_f1_score': 0.7302632}
confusion matrix:
     0    1
0  516  137
1  191  444
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7790698, 'precision': 0.7793659, 'recall': 0.7790698, 'specificity': 0.7790698, 'f1': 0.77901125, 'auroc': 0.84458625, 'binary_precision': 0.78846157, 'binary_recall': 0.7627907, 'binary_specificity': 0.7953488, 'binary_f1_score': 0.7754137}
confusion matrix:
     0    1
0  171   44
1   51  164
new oracle model saved
early stop counter: 3
val acc:0.7453415989875793, best validation acc: 0.7577639818191528, corresponding to test acc:                         0.7627906799316406 / 0.7790697813034058
after epoch: 22,now: 2024-07-23 00:21:40.908023,epoch time: 0:01:21.742600,used: 0:30:23.218095,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_22_23_51_17_seed_0_22769259
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.8105469, 'precision': 0.8109209, 'recall': 0.8107785, 'specificity': 0.8107785, 'f1': 0.8105403, 'auroc': 0.891341, 'binary_precision': 0.8256513, 'binary_recall': 0.79383427, 'binary_specificity': 0.8277228, 'binary_f1_score': 0.8094302}
confusion matrix:
      0     1
0  1254   261
1   321  1236
---- Validation: 
scalar performance:
{'acc': 0.7468944, 'precision': 0.74822044, 'recall': 0.74632406, 'specificity': 0.74632406, 'f1': 0.7462281, 'auroc': 0.82688975, 'binary_precision': 0.7632027, 'binary_recall': 0.7055118, 'binary_specificity': 0.7871363, 'binary_f1_score': 0.7332242}
confusion matrix:
     0    1
0  514  139
1  187  448
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7767442, 'precision': 0.7767681, 'recall': 0.7767442, 'specificity': 0.7767442, 'f1': 0.77673936, 'auroc': 0.84789616, 'binary_precision': 0.7793427, 'binary_recall': 0.772093, 'binary_specificity': 0.7813954, 'binary_f1_score': 0.7757009}
confusion matrix:
     0    1
0  168   47
1   49  166
early stop counter: 4
val acc:0.7468944191932678, best validation acc: 0.7577639818191528, corresponding to test acc:                         0.7627906799316406 / 0.7790697813034058
after epoch: 23,now: 2024-07-23 00:23:02.815676,epoch time: 0:01:21.907653,used: 0:31:45.125748,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_22_23_51_17_seed_0_22769259
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.8258464, 'precision': 0.8259655, 'recall': 0.82599247, 'specificity': 0.82599247, 'f1': 0.82584584, 'auroc': 0.91012, 'binary_precision': 0.8367347, 'binary_recall': 0.81578946, 'binary_specificity': 0.8361955, 'binary_f1_score': 0.8261293}
confusion matrix:
      0     1
0  1266   248
1   287  1271
---- Validation: 
scalar performance:
{'acc': 0.7507764, 'precision': 0.7518542, 'recall': 0.75026107, 'specificity': 0.75026107, 'f1': 0.7502161, 'auroc': 0.8286238, 'binary_precision': 0.7652027, 'binary_recall': 0.7133858, 'binary_specificity': 0.7871363, 'binary_f1_score': 0.7383862}
confusion matrix:
     0    1
0  514  139
1  182  453
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7790698, 'precision': 0.7790758, 'recall': 0.7790698, 'specificity': 0.7790698, 'f1': 0.7790686, 'auroc': 0.85057867, 'binary_precision': 0.7777778, 'binary_recall': 0.7813954, 'binary_specificity': 0.7767442, 'binary_f1_score': 0.77958244}
confusion matrix:
     0    1
0  167   48
1   47  168
early stop counter: 5
val acc:0.7507764101028442, best validation acc: 0.7577639818191528, corresponding to test acc:                         0.7627906799316406 / 0.7790697813034058
after epoch: 24,now: 2024-07-23 00:24:24.386689,epoch time: 0:01:21.571013,used: 0:33:06.696761,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_22_23_51_17_seed_0_22769259
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.8378906, 'precision': 0.8382065, 'recall': 0.83767664, 'specificity': 0.83767664, 'f1': 0.8377693, 'auroc': 0.9218893, 'binary_precision': 0.830625, 'binary_recall': 0.8541131, 'binary_specificity': 0.8212401, 'binary_f1_score': 0.8422053}
confusion matrix:
      0     1
0  1245   271
1   227  1329
---- Validation: 
scalar performance:
{'acc': 0.7515528, 'precision': 0.7522964, 'recall': 0.75111353, 'specificity': 0.75111353, 'f1': 0.7511153, 'auroc': 0.83037466, 'binary_precision': 0.7629382, 'binary_recall': 0.719685, 'binary_specificity': 0.7825421, 'binary_f1_score': 0.7406807}
confusion matrix:
     0    1
0  511  142
1  178  457
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7744186, 'precision': 0.77447206, 'recall': 0.7744186, 'specificity': 0.7744186, 'f1': 0.7744076, 'auroc': 0.8531314, 'binary_precision': 0.7706422, 'binary_recall': 0.7813954, 'binary_specificity': 0.76744187, 'binary_f1_score': 0.77598155}
confusion matrix:
     0    1
0  165   50
1   47  168
early stop counter: 6
val acc:0.7515528202056885, best validation acc: 0.7577639818191528, corresponding to test acc:                         0.7627906799316406 / 0.7790697813034058
after epoch: 25,now: 2024-07-23 00:25:48.022821,epoch time: 0:01:23.636132,used: 0:34:30.332893,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_22_23_51_17_seed_0_22769259
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.8304036, 'precision': 0.830715, 'recall': 0.8305738, 'specificity': 0.8305738, 'f1': 0.8303971, 'auroc': 0.9120778, 'binary_precision': 0.844, 'binary_recall': 0.8151964, 'binary_specificity': 0.84595126, 'binary_f1_score': 0.82934815}
confusion matrix:
      0     1
0  1285   234
1   287  1266
---- Validation: 
scalar performance:
{'acc': 0.7492236, 'precision': 0.7514347, 'recall': 0.7485126, 'specificity': 0.7485126, 'f1': 0.74827665, 'auroc': 0.8312236, 'binary_precision': 0.771777, 'binary_recall': 0.6976378, 'binary_specificity': 0.79938745, 'binary_f1_score': 0.7328371}
confusion matrix:
     0    1
0  522  131
1  192  443
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7837209, 'precision': 0.784022, 'recall': 0.78372097, 'specificity': 0.78372097, 'f1': 0.78366363, 'auroc': 0.85516495, 'binary_precision': 0.7932692, 'binary_recall': 0.76744187, 'binary_specificity': 0.8, 'binary_f1_score': 0.78014183}
confusion matrix:
     0    1
0  172   43
1   50  165
new oracle model saved
early stop counter: 7
val acc:0.7492235898971558, best validation acc: 0.7577639818191528, corresponding to test acc:                         0.7627906799316406 / 0.7837209105491638
after epoch: 26,now: 2024-07-23 00:27:09.497132,epoch time: 0:01:21.474311,used: 0:35:51.807204,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_22_23_51_17_seed_0_22769259
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.8483073, 'precision': 0.8485418, 'recall': 0.84848505, 'specificity': 0.84848505, 'f1': 0.84830624, 'auroc': 0.92402846, 'binary_precision': 0.86140585, 'binary_recall': 0.8348329, 'binary_specificity': 0.8621372, 'binary_f1_score': 0.8479112}
confusion matrix:
      0     1
0  1307   209
1   257  1299
---- Validation: 
scalar performance:
{'acc': 0.7468944, 'precision': 0.7494641, 'recall': 0.7461287, 'specificity': 0.7461287, 'f1': 0.74581325, 'auroc': 0.8327863, 'binary_precision': 0.771529, 'binary_recall': 0.6913386, 'binary_specificity': 0.8009188, 'binary_f1_score': 0.7292359}
confusion matrix:
     0    1
0  523  130
1  196  439
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7860465, 'precision': 0.78666663, 'recall': 0.7860465, 'specificity': 0.7860465, 'f1': 0.78593075, 'auroc': 0.85841, 'binary_precision': 0.8, 'binary_recall': 0.7627907, 'binary_specificity': 0.80930233, 'binary_f1_score': 0.7809524}
confusion matrix:
     0    1
0  174   41
1   51  164
new oracle model saved
early stop counter: 8
val acc:0.7468944191932678, best validation acc: 0.7577639818191528, corresponding to test acc:                         0.7627906799316406 / 0.7860465049743652
after epoch: 27,now: 2024-07-23 00:28:30.962507,epoch time: 0:01:21.465375,used: 0:37:13.272579,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_22_23_51_17_seed_0_22769259
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.8326823, 'precision': 0.8328879, 'recall': 0.8328489, 'specificity': 0.8328489, 'f1': 0.83268166, 'auroc': 0.9146041, 'binary_precision': 0.8450331, 'binary_recall': 0.82005143, 'binary_specificity': 0.84564644, 'binary_f1_score': 0.83235484}
confusion matrix:
      0     1
0  1282   234
1   280  1276
---- Validation: 
scalar performance:
{'acc': 0.7492236, 'precision': 0.75128746, 'recall': 0.7485343, 'specificity': 0.7485343, 'f1': 0.74832416, 'auroc': 0.8341561, 'binary_precision': 0.7708333, 'binary_recall': 0.6992126, 'binary_specificity': 0.79785603, 'binary_f1_score': 0.7332783}
confusion matrix:
     0    1
0  521  132
1  191  444
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7883721, 'precision': 0.7886781, 'recall': 0.78837204, 'specificity': 0.78837204, 'f1': 0.78831595, 'auroc': 0.8604218, 'binary_precision': 0.7980769, 'binary_recall': 0.772093, 'binary_specificity': 0.80465114, 'binary_f1_score': 0.78486997}
confusion matrix:
     0    1
0  173   42
1   49  166
new oracle model saved
early stop counter: 9
val acc:0.7492235898971558, best validation acc: 0.7577639818191528, corresponding to test acc:                         0.7627906799316406 / 0.7883720993995667
after epoch: 28,now: 2024-07-23 00:29:54.284544,epoch time: 0:01:23.322037,used: 0:38:36.594616,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_22_23_51_17_seed_0_22769259
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.8300781, 'precision': 0.8305769, 'recall': 0.8303179, 'specificity': 0.8303179, 'f1': 0.83006406, 'auroc': 0.9152839, 'binary_precision': 0.8468771, 'binary_recall': 0.81093246, 'binary_specificity': 0.8497034, 'binary_f1_score': 0.8285151}
confusion matrix:
      0     1
0  1289   228
1   294  1261
---- Validation: 
scalar performance:
{'acc': 0.7476708, 'precision': 0.7493088, 'recall': 0.74704635, 'specificity': 0.74704635, 'f1': 0.74690175, 'auroc': 0.83521724, 'binary_precision': 0.76632303, 'binary_recall': 0.7023622, 'binary_specificity': 0.79173046, 'binary_f1_score': 0.7329499}
confusion matrix:
     0    1
0  517  136
1  189  446
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7883721, 'precision': 0.78842825, 'recall': 0.7883721, 'specificity': 0.7883721, 'f1': 0.7883618, 'auroc': 0.8622607, 'binary_precision': 0.7924528, 'binary_recall': 0.7813954, 'binary_specificity': 0.7953488, 'binary_f1_score': 0.7868852}
confusion matrix:
     0    1
0  171   44
1   47  168
early stop counter: 10
val acc:0.7476708292961121, best validation acc: 0.7577639818191528, corresponding to test acc:                         0.7627906799316406 / 0.7883720993995667
after epoch: 29,now: 2024-07-23 00:31:15.983708,epoch time: 0:01:21.699164,used: 0:39:58.293780,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_22_23_51_17_seed_0_22769259
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.8388672, 'precision': 0.83907497, 'recall': 0.83901674, 'specificity': 0.83901674, 'f1': 0.83886576, 'auroc': 0.9210546, 'binary_precision': 0.85089463, 'binary_recall': 0.82625484, 'binary_specificity': 0.8517786, 'binary_f1_score': 0.8383937}
confusion matrix:
      0     1
0  1293   225
1   270  1284
---- Validation: 
scalar performance:
{'acc': 0.7476708, 'precision': 0.7493088, 'recall': 0.74704635, 'specificity': 0.74704635, 'f1': 0.74690175, 'auroc': 0.8352823, 'binary_precision': 0.76632303, 'binary_recall': 0.7023622, 'binary_specificity': 0.79173046, 'binary_f1_score': 0.7329499}
confusion matrix:
     0    1
0  517  136
1  189  446
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7883721, 'precision': 0.78837836, 'recall': 0.7883721, 'specificity': 0.7883721, 'f1': 0.78837097, 'auroc': 0.86340725, 'binary_precision': 0.78971964, 'binary_recall': 0.7860465, 'binary_specificity': 0.7906977, 'binary_f1_score': 0.7878789}
confusion matrix:
     0    1
0  170   45
1   46  169
early stop counter: 11
val acc:0.7476708292961121, best validation acc: 0.7577639818191528, corresponding to test acc:                         0.7627906799316406 / 0.7883720993995667
after epoch: 30,now: 2024-07-23 00:32:39.054057,epoch time: 0:01:23.070349,used: 0:41:21.364129,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_22_23_51_17_seed_0_22769259
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 0:41:21.364129 at 2024-07-23 00:32:39.054057
persisted model performance metric: 

scalar performance:
{'acc': 0.7627907, 'precision': 0.7629955, 'recall': 0.7627907, 'specificity': 0.7627907, 'f1': 0.7627445, 'auroc': 0.83701456, 'binary_precision': 0.7556561, 'binary_recall': 0.7767442, 'binary_specificity': 0.74883723, 'binary_f1_score': 0.766055}
confusion matrix:
     0    1
0  161   54
1   48  167
oracle model performance metric: 

scalar performance:
{'acc': 0.7883721, 'precision': 0.7886781, 'recall': 0.78837204, 'specificity': 0.78837204, 'f1': 0.78831595, 'auroc': 0.8604218, 'binary_precision': 0.7980769, 'binary_recall': 0.772093, 'binary_specificity': 0.80465114, 'binary_f1_score': 0.78486997}
confusion matrix:
     0    1
0  173   42
1   49  166
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_dial_lr1e5_bs16_allfreeze_2024-07-22_23-46-53/rule_results/2.csv
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_dial_lr1e5_bs16_allfreeze_2024-07-22_23-46-53/rule_results/2.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_dial_lr1e5_bs16_allfreeze_2024-07-22_23-46-53/confusion_matrix/2.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 190782 KiB | 460555 KiB |  39370 GiB |  39370 GiB |
|       from large pool | 174400 KiB | 428048 KiB |  38560 GiB |  38560 GiB |
|       from small pool |  16382 KiB |  33605 KiB |    809 GiB |    809 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 190782 KiB | 460555 KiB |  39370 GiB |  39370 GiB |
|       from large pool | 174400 KiB | 428048 KiB |  38560 GiB |  38560 GiB |
|       from small pool |  16382 KiB |  33605 KiB |    809 GiB |    809 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 189009 KiB | 457291 KiB |  39366 GiB |  39366 GiB |
|       from large pool | 172814 KiB | 424940 KiB |  38558 GiB |  38558 GiB |
|       from small pool |  16195 KiB |  33422 KiB |    808 GiB |    808 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 512000 KiB | 512000 KiB | 512000 KiB |      0 B   |
|       from large pool | 473088 KiB | 473088 KiB | 473088 KiB |      0 B   |
|       from small pool |  38912 KiB |  38912 KiB |  38912 KiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |  36545 KiB |  77635 KiB |  21355 GiB |  21355 GiB |
|       from large pool |  30400 KiB |  73350 KiB |  20525 GiB |  20525 GiB |
|       from small pool |   6145 KiB |   9295 KiB |    830 GiB |    830 GiB |
|---------------------------------------------------------------------------|
| Allocations           |     776    |    1147    |    8512 K  |    8512 K  |
|       from large pool |      76    |     158    |    3806 K  |    3806 K  |
|       from small pool |     700    |     996    |    4706 K  |    4705 K  |
|---------------------------------------------------------------------------|
| Active allocs         |     776    |    1147    |    8512 K  |    8512 K  |
|       from large pool |      76    |     158    |    3806 K  |    3806 K  |
|       from small pool |     700    |     996    |    4706 K  |    4705 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      40    |      40    |      40    |       0    |
|       from large pool |      21    |      21    |      21    |       0    |
|       from small pool |      19    |      19    |      19    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      36    |     215    |    5171 K  |    5171 K  |
|       from large pool |       9    |      19    |    2359 K  |    2359 K  |
|       from small pool |      27    |     207    |    2812 K  |    2812 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  17088 KiB | 460555 KiB |  39370 GiB |  39370 GiB |
|       from large pool |  17088 KiB | 428048 KiB |  38560 GiB |  38560 GiB |
|       from small pool |      0 KiB |  33605 KiB |    809 GiB |    809 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  17088 KiB | 460555 KiB |  39370 GiB |  39370 GiB |
|       from large pool |  17088 KiB | 428048 KiB |  38560 GiB |  38560 GiB |
|       from small pool |      0 KiB |  33605 KiB |    809 GiB |    809 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB | 457291 KiB |  39366 GiB |  39366 GiB |
|       from large pool |  16640 KiB | 424940 KiB |  38558 GiB |  38558 GiB |
|       from small pool |      0 KiB |  33422 KiB |    808 GiB |    808 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 227328 KiB | 512000 KiB | 512000 KiB | 284672 KiB |
|       from large pool | 204800 KiB | 473088 KiB | 473088 KiB | 268288 KiB |
|       from small pool |  22528 KiB |  38912 KiB |  38912 KiB |  16384 KiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  23872 KiB |  77635 KiB |  21356 GiB |  21356 GiB |
|       from large pool |  23872 KiB |  73350 KiB |  20525 GiB |  20525 GiB |
|       from small pool |      0 KiB |  11196 KiB |    830 GiB |    830 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    1147    |    8512 K  |    8512 K  |
|       from large pool |       2    |     158    |    3806 K  |    3806 K  |
|       from small pool |       0    |     996    |    4706 K  |    4706 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    1147    |    8512 K  |    8512 K  |
|       from large pool |       2    |     158    |    3806 K  |    3806 K  |
|       from small pool |       0    |     996    |    4706 K  |    4706 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      21    |      40    |      40    |      19    |
|       from large pool |      10    |      21    |      21    |      11    |
|       from small pool |      11    |      19    |      19    |       8    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     215    |    5172 K  |    5172 K  |
|       from large pool |       3    |      19    |    2359 K  |    2359 K  |
|       from small pool |       0    |     207    |    2812 K  |    2812 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  17088 KiB | 460555 KiB |  39370 GiB |  39370 GiB |
|       from large pool |  17088 KiB | 428048 KiB |  38560 GiB |  38560 GiB |
|       from small pool |      0 KiB |  33605 KiB |    809 GiB |    809 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  17088 KiB | 460555 KiB |  39370 GiB |  39370 GiB |
|       from large pool |  17088 KiB | 428048 KiB |  38560 GiB |  38560 GiB |
|       from small pool |      0 KiB |  33605 KiB |    809 GiB |    809 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB | 457291 KiB |  39366 GiB |  39366 GiB |
|       from large pool |  16640 KiB | 424940 KiB |  38558 GiB |  38558 GiB |
|       from small pool |      0 KiB |  33422 KiB |    808 GiB |    808 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 227328 KiB | 512000 KiB | 512000 KiB | 284672 KiB |
|       from large pool | 204800 KiB | 473088 KiB | 473088 KiB | 268288 KiB |
|       from small pool |  22528 KiB |  38912 KiB |  38912 KiB |  16384 KiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  23872 KiB |  77635 KiB |  21356 GiB |  21356 GiB |
|       from large pool |  23872 KiB |  73350 KiB |  20525 GiB |  20525 GiB |
|       from small pool |      0 KiB |  11196 KiB |    830 GiB |    830 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    1147    |    8512 K  |    8512 K  |
|       from large pool |       2    |     158    |    3806 K  |    3806 K  |
|       from small pool |       0    |     996    |    4706 K  |    4706 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    1147    |    8512 K  |    8512 K  |
|       from large pool |       2    |     158    |    3806 K  |    3806 K  |
|       from small pool |       0    |     996    |    4706 K  |    4706 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      21    |      40    |      40    |      19    |
|       from large pool |      10    |      21    |      21    |      11    |
|       from small pool |      11    |      19    |      19    |       8    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     215    |    5172 K  |    5172 K  |
|       from large pool |       3    |      19    |    2359 K  |    2359 K  |
|       from small pool |       0    |     207    |    2812 K  |    2812 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'888c1ef2'
model name: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_00_34_15_seed_1_22769259

 Experiment start at: 2024-07-23 00:34:15.166983
before training, model accuracy: 0.6177777647972107
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.5296224, 'precision': 0.5348829, 'recall': 0.52661455, 'specificity': 0.52661455, 'f1': 0.49835095, 'auroc': 0.48145372, 'binary_precision': 0.5240806, 'binary_recall': 0.7697749, 'binary_specificity': 0.28345418, 'binary_f1_score': 0.62359995}
confusion matrix:
     0     1
0  430  1087
1  358  1197
---- Validation: 
scalar performance:
{'acc': 0.5027322, 'precision': 0.49648768, 'recall': 0.49777266, 'specificity': 0.49777266, 'f1': 0.4496016, 'auroc': 0.6253066, 'binary_precision': 0.486166, 'binary_recall': 0.1952381, 'binary_specificity': 0.8003072, 'binary_f1_score': 0.2785957}
confusion matrix:
     0    1
0  521  130
1  507  123
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5822222, 'precision': 0.5978836, 'recall': 0.5822222, 'specificity': 0.5822222, 'f1': 0.5648148, 'auroc': 0.67142713, 'binary_precision': 0.63703704, 'binary_recall': 0.38222224, 'binary_specificity': 0.7822222, 'binary_f1_score': 0.47777784}
confusion matrix:
     0   1
0  176  49
1  139  86
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-23 00:35:45.645143,epoch time: 0:01:30.478160,used: 0:01:30.478160,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_00_34_15_seed_1_22769259
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.5253906, 'precision': 0.5256425, 'recall': 0.52368295, 'specificity': 0.52368295, 'f1': 0.51526487, 'auroc': 0.48741442, 'binary_precision': 0.5247323, 'binary_recall': 0.6617363, 'binary_specificity': 0.38562953, 'binary_f1_score': 0.5853242}
confusion matrix:
     0     1
0  585   932
1  526  1029
---- Validation: 
scalar performance:
{'acc': 0.47384855, 'precision': 0.4293576, 'recall': 0.46779314, 'specificity': 0.46779314, 'f1': 0.38665116, 'auroc': 0.6313778, 'binary_precision': 0.3690476, 'binary_recall': 0.0984127, 'binary_specificity': 0.8371736, 'binary_f1_score': 0.15538847}
confusion matrix:
     0    1
0  545  106
1  568   62
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.56222224, 'precision': 0.5988825, 'recall': 0.56222224, 'specificity': 0.56222224, 'f1': 0.5175012, 'auroc': 0.681442, 'binary_precision': 0.65909094, 'binary_recall': 0.25777778, 'binary_specificity': 0.8666667, 'binary_f1_score': 0.37060705}
confusion matrix:
     0   1
0  195  30
1  167  58
early stop counter: 1
val acc:0.4738485515117645, best validation acc: 0.5027322173118591, corresponding to test acc:                         0.5822222232818604 / 0.5822222232818604
after epoch: 2,now: 2024-07-23 00:37:07.927741,epoch time: 0:01:22.282598,used: 0:02:52.760758,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_00_34_15_seed_1_22769259
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.5364583, 'precision': 0.5363915, 'recall': 0.53537077, 'specificity': 0.53537077, 'f1': 0.5326309, 'auroc': 0.5184518, 'binary_precision': 0.5367893, 'binary_recall': 0.6188946, 'binary_specificity': 0.45184696, 'binary_f1_score': 0.57492536}
confusion matrix:
     0    1
0  685  831
1  593  963
---- Validation: 
scalar performance:
{'acc': 0.46760345, 'precision': 0.40870774, 'recall': 0.46136713, 'specificity': 0.46136713, 'f1': 0.37326247, 'auroc': 0.6444932, 'binary_precision': 0.33116883, 'binary_recall': 0.08095238, 'binary_specificity': 0.84178185, 'binary_f1_score': 0.13010205}
confusion matrix:
     0    1
0  548  103
1  579   51
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.56, 'precision': 0.6036371, 'recall': 0.56, 'specificity': 0.56, 'f1': 0.5082347, 'auroc': 0.6932938, 'binary_precision': 0.6708861, 'binary_recall': 0.23555556, 'binary_specificity': 0.8844444, 'binary_f1_score': 0.34868422}
confusion matrix:
     0   1
0  199  26
1  172  53
early stop counter: 2
val acc:0.4676034450531006, best validation acc: 0.5027322173118591, corresponding to test acc:                         0.5822222232818604 / 0.5822222232818604
after epoch: 3,now: 2024-07-23 00:38:31.205741,epoch time: 0:01:23.278000,used: 0:04:16.038758,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_00_34_15_seed_1_22769259
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.55045575, 'precision': 0.55050814, 'recall': 0.54973394, 'specificity': 0.54973394, 'f1': 0.54836524, 'auroc': 0.5470629, 'binary_precision': 0.55008686, 'binary_recall': 0.6113256, 'binary_specificity': 0.48814228, 'binary_f1_score': 0.5790917}
confusion matrix:
     0    1
0  741  777
1  604  950
---- Validation: 
scalar performance:
{'acc': 0.46760345, 'precision': 0.40290606, 'recall': 0.46123913, 'specificity': 0.46123913, 'f1': 0.36871567, 'auroc': 0.65687954, 'binary_precision': 0.31944445, 'binary_recall': 0.073015876, 'binary_specificity': 0.8494624, 'binary_f1_score': 0.11886305}
confusion matrix:
     0   1
0  553  98
1  584  46
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.55777776, 'precision': 0.60747355, 'recall': 0.55777776, 'specificity': 0.55777776, 'f1': 0.4999749, 'auroc': 0.7069235, 'binary_precision': 0.6805556, 'binary_recall': 0.21777777, 'binary_specificity': 0.8977778, 'binary_f1_score': 0.32996634}
confusion matrix:
     0   1
0  202  23
1  176  49
early stop counter: 3
val acc:0.4676034450531006, best validation acc: 0.5027322173118591, corresponding to test acc:                         0.5822222232818604 / 0.5822222232818604
after epoch: 4,now: 2024-07-23 00:39:54.794494,epoch time: 0:01:23.588753,used: 0:05:39.627511,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_00_34_15_seed_1_22769259
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.57910156, 'precision': 0.57959867, 'recall': 0.578441, 'specificity': 0.578441, 'f1': 0.5772556, 'auroc': 0.5881556, 'binary_precision': 0.57549363, 'binary_recall': 0.63811976, 'binary_specificity': 0.51876235, 'binary_f1_score': 0.6051909}
confusion matrix:
     0    1
0  788  731
1  562  991
---- Validation: 
scalar performance:
{'acc': 0.47228727, 'precision': 0.41352683, 'recall': 0.4658986, 'specificity': 0.4658986, 'f1': 0.37334937, 'auroc': 0.66883427, 'binary_precision': 0.33802816, 'binary_recall': 0.07619048, 'binary_specificity': 0.85560673, 'binary_f1_score': 0.124352336}
confusion matrix:
     0   1
0  557  94
1  582  48
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.56666666, 'precision': 0.62400794, 'recall': 0.56666666, 'specificity': 0.56666666, 'f1': 0.5100256, 'auroc': 0.7197037, 'binary_precision': 0.7083333, 'binary_recall': 0.22666667, 'binary_specificity': 0.9066667, 'binary_f1_score': 0.34343433}
confusion matrix:
     0   1
0  204  21
1  174  51
early stop counter: 4
val acc:0.47228726744651794, best validation acc: 0.5027322173118591, corresponding to test acc:                         0.5822222232818604 / 0.5822222232818604
after epoch: 5,now: 2024-07-23 00:41:18.034596,epoch time: 0:01:23.240102,used: 0:07:02.867613,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_00_34_15_seed_1_22769259
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.59375, 'precision': 0.5936301, 'recall': 0.59356725, 'specificity': 0.59356725, 'f1': 0.5935624, 'auroc': 0.6256311, 'binary_precision': 0.59772295, 'binary_recall': 0.6069364, 'binary_specificity': 0.58019805, 'binary_f1_score': 0.60229445}
confusion matrix:
     0    1
0  879  636
1  612  945
---- Validation: 
scalar performance:
{'acc': 0.47697112, 'precision': 0.41895008, 'recall': 0.4704301, 'specificity': 0.4704301, 'f1': 0.373306, 'auroc': 0.67975765, 'binary_precision': 0.34615386, 'binary_recall': 0.071428575, 'binary_specificity': 0.8694316, 'binary_f1_score': 0.11842106}
confusion matrix:
     0   1
0  566  85
1  585  45
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.56222224, 'precision': 0.62126577, 'recall': 0.56222224, 'specificity': 0.56222224, 'f1': 0.50154907, 'auroc': 0.7296, 'binary_precision': 0.7058824, 'binary_recall': 0.21333334, 'binary_specificity': 0.9111111, 'binary_f1_score': 0.32764506}
confusion matrix:
     0   1
0  205  20
1  177  48
early stop counter: 5
val acc:0.4769711196422577, best validation acc: 0.5027322173118591, corresponding to test acc:                         0.5822222232818604 / 0.5822222232818604
after epoch: 6,now: 2024-07-23 00:42:41.715316,epoch time: 0:01:23.680720,used: 0:08:26.548333,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_00_34_15_seed_1_22769259
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.6204427, 'precision': 0.62062395, 'recall': 0.61997986, 'specificity': 0.61997986, 'f1': 0.61971915, 'auroc': 0.6528202, 'binary_precision': 0.6181818, 'binary_recall': 0.655527, 'binary_specificity': 0.5844327, 'binary_f1_score': 0.63630694}
confusion matrix:
     0     1
0  886   630
1  536  1020
---- Validation: 
scalar performance:
{'acc': 0.4847775, 'precision': 0.44801062, 'recall': 0.4784946, 'specificity': 0.4784946, 'f1': 0.39173788, 'auroc': 0.69131494, 'binary_precision': 0.4, 'binary_recall': 0.0952381, 'binary_specificity': 0.86175114, 'binary_f1_score': 0.15384616}
confusion matrix:
     0   1
0  561  90
1  570  60
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5777778, 'precision': 0.63709486, 'recall': 0.5777778, 'specificity': 0.5777778, 'f1': 0.5265676, 'auroc': 0.740721, 'binary_precision': 0.72727275, 'binary_recall': 0.2488889, 'binary_specificity': 0.9066667, 'binary_f1_score': 0.37086093}
confusion matrix:
     0   1
0  204  21
1  169  56
early stop counter: 6
val acc:0.4847775101661682, best validation acc: 0.5027322173118591, corresponding to test acc:                         0.5822222232818604 / 0.5822222232818604
after epoch: 7,now: 2024-07-23 00:44:04.147923,epoch time: 0:01:22.432607,used: 0:09:48.980940,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_00_34_15_seed_1_22769259
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.640625, 'precision': 0.64100254, 'recall': 0.6400949, 'specificity': 0.6400949, 'f1': 0.6398114, 'auroc': 0.67269623, 'binary_precision': 0.6363636, 'binary_recall': 0.6788696, 'binary_specificity': 0.60132015, 'binary_f1_score': 0.65692973}
confusion matrix:
     0     1
0  911   604
1  500  1057
---- Validation: 
scalar performance:
{'acc': 0.49492583, 'precision': 0.4751385, 'recall': 0.4888377, 'specificity': 0.4888377, 'f1': 0.41000313, 'auroc': 0.70086557, 'binary_precision': 0.44848484, 'binary_recall': 0.11746032, 'binary_specificity': 0.86021507, 'binary_f1_score': 0.18616351}
confusion matrix:
     0   1
0  560  91
1  556  74
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5888889, 'precision': 0.6491251, 'recall': 0.5888889, 'specificity': 0.5888889, 'f1': 0.54271054, 'auroc': 0.74972844, 'binary_precision': 0.74390244, 'binary_recall': 0.2711111, 'binary_specificity': 0.9066667, 'binary_f1_score': 0.39739412}
confusion matrix:
     0   1
0  204  21
1  164  61
new oracle model saved
early stop counter: 7
val acc:0.4949258267879486, best validation acc: 0.5027322173118591, corresponding to test acc:                         0.5822222232818604 / 0.5888888835906982
after epoch: 8,now: 2024-07-23 00:45:28.329449,epoch time: 0:01:24.181526,used: 0:11:13.162466,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_00_34_15_seed_1_22769259
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.6611328, 'precision': 0.66134536, 'recall': 0.6608355, 'specificity': 0.6608355, 'f1': 0.66073644, 'auroc': 0.71038413, 'binary_precision': 0.65763545, 'binary_recall': 0.6877012, 'binary_specificity': 0.6339697, 'binary_f1_score': 0.6723324}
confusion matrix:
     0     1
0  963   556
1  485  1068
---- Validation: 
scalar performance:
{'acc': 0.49882904, 'precision': 0.48416442, 'recall': 0.49278033, 'specificity': 0.49278033, 'f1': 0.41577157, 'auroc': 0.70913374, 'binary_precision': 0.4642857, 'binary_recall': 0.123809524, 'binary_specificity': 0.86175114, 'binary_f1_score': 0.1954887}
confusion matrix:
     0   1
0  561  90
1  552  78
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5933333, 'precision': 0.65368855, 'recall': 0.59333336, 'specificity': 0.59333336, 'f1': 0.5490612, 'auroc': 0.7580445, 'binary_precision': 0.75, 'binary_recall': 0.28, 'binary_specificity': 0.9066667, 'binary_f1_score': 0.40776703}
confusion matrix:
     0   1
0  204  21
1  162  63
new oracle model saved
early stop counter: 8
val acc:0.49882903695106506, best validation acc: 0.5027322173118591, corresponding to test acc:                         0.5822222232818604 / 0.5933333039283752
after epoch: 9,now: 2024-07-23 00:46:50.157977,epoch time: 0:01:21.828528,used: 0:12:34.990994,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_00_34_15_seed_1_22769259
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.68880206, 'precision': 0.68957514, 'recall': 0.68819594, 'specificity': 0.68819594, 'f1': 0.6879975, 'auroc': 0.73253274, 'binary_precision': 0.6806471, 'binary_recall': 0.7286722, 'binary_specificity': 0.64771974, 'binary_f1_score': 0.7038414}
confusion matrix:
     0     1
0  980   533
1  423  1136
---- Validation: 
scalar performance:
{'acc': 0.5066354, 'precision': 0.5015365, 'recall': 0.50074244, 'specificity': 0.50074244, 'f1': 0.42951128, 'auroc': 0.71795523, 'binary_precision': 0.49444443, 'binary_recall': 0.14126985, 'binary_specificity': 0.86021507, 'binary_f1_score': 0.21975309}
confusion matrix:
     0   1
0  560  91
1  541  89
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6155556, 'precision': 0.6695849, 'recall': 0.6155556, 'specificity': 0.6155556, 'f1': 0.5822848, 'auroc': 0.7668741, 'binary_precision': 0.7653061, 'binary_recall': 0.33333334, 'binary_specificity': 0.8977778, 'binary_f1_score': 0.46439627}
confusion matrix:
     0   1
0  202  23
1  150  75
new oracle model saved
better model found
persisted
after epoch: 10,now: 2024-07-23 00:48:12.401998,epoch time: 0:01:22.244021,used: 0:13:57.235015,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_00_34_15_seed_1_22769259
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.695638, 'precision': 0.6956152, 'recall': 0.69548047, 'specificity': 0.69548047, 'f1': 0.6955017, 'auroc': 0.7426059, 'binary_precision': 0.6963947, 'binary_recall': 0.70758355, 'binary_specificity': 0.6833773, 'binary_f1_score': 0.70194453}
confusion matrix:
      0     1
0  1036   480
1   455  1101
---- Validation: 
scalar performance:
{'acc': 0.51834506, 'precision': 0.5246519, 'recall': 0.5126216, 'specificity': 0.5126216, 'f1': 0.4477511, 'auroc': 0.7262039, 'binary_precision': 0.53367877, 'binary_recall': 0.16349207, 'binary_specificity': 0.86175114, 'binary_f1_score': 0.25030378}
confusion matrix:
     0    1
0  561   90
1  527  103
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.62, 'precision': 0.6735714, 'recall': 0.62, 'specificity': 0.62, 'f1': 0.5882274, 'auroc': 0.7747358, 'binary_precision': 0.77, 'binary_recall': 0.3422222, 'binary_specificity': 0.8977778, 'binary_f1_score': 0.47384614}
confusion matrix:
     0   1
0  202  23
1  148  77
new oracle model saved
better model found
persisted
after epoch: 11,now: 2024-07-23 00:49:36.049270,epoch time: 0:01:23.647272,used: 0:15:20.882287,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_00_34_15_seed_1_22769259
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.69921875, 'precision': 0.699538, 'recall': 0.69891036, 'specificity': 0.69891036, 'f1': 0.69886017, 'auroc': 0.7530539, 'binary_precision': 0.6939655, 'binary_recall': 0.7252252, 'binary_specificity': 0.6725955, 'binary_f1_score': 0.70925117}
confusion matrix:
      0     1
0  1021   497
1   427  1127
---- Validation: 
scalar performance:
{'acc': 0.529274, 'precision': 0.54407924, 'recall': 0.52370715, 'specificity': 0.52370715, 'f1': 0.46434197, 'auroc': 0.7337893, 'binary_precision': 0.56585366, 'binary_recall': 0.18412699, 'binary_specificity': 0.86328727, 'binary_f1_score': 0.2778443}
confusion matrix:
     0    1
0  562   89
1  514  116
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.62, 'precision': 0.6666027, 'recall': 0.62, 'specificity': 0.62, 'f1': 0.5914282, 'auroc': 0.780879, 'binary_precision': 0.754717, 'binary_recall': 0.35555556, 'binary_specificity': 0.8844444, 'binary_f1_score': 0.48338372}
confusion matrix:
     0   1
0  199  26
1  145  80
better model found
persisted
after epoch: 12,now: 2024-07-23 00:50:59.454108,epoch time: 0:01:23.404838,used: 0:16:44.287125,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_00_34_15_seed_1_22769259
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.7132161, 'precision': 0.7132195, 'recall': 0.71303344, 'specificity': 0.71303344, 'f1': 0.7130629, 'auroc': 0.7762461, 'binary_precision': 0.71311474, 'binary_recall': 0.7263969, 'binary_specificity': 0.69966996, 'binary_f1_score': 0.71969455}
confusion matrix:
      0     1
0  1060   455
1   426  1131
---- Validation: 
scalar performance:
{'acc': 0.5425449, 'precision': 0.56448084, 'recall': 0.53722477, 'specificity': 0.53722477, 'f1': 0.485363, 'auroc': 0.74103093, 'binary_precision': 0.59821427, 'binary_recall': 0.21269841, 'binary_specificity': 0.86175114, 'binary_f1_score': 0.31381735}
confusion matrix:
     0    1
0  561   90
1  496  134
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6377778, 'precision': 0.68425083, 'recall': 0.6377778, 'specificity': 0.6377778, 'f1': 0.61340004, 'auroc': 0.78838515, 'binary_precision': 0.77678573, 'binary_recall': 0.38666666, 'binary_specificity': 0.8888889, 'binary_f1_score': 0.51632047}
confusion matrix:
     0   1
0  200  25
1  138  87
new oracle model saved
better model found
persisted
after epoch: 13,now: 2024-07-23 00:52:22.463487,epoch time: 0:01:23.009379,used: 0:18:07.296504,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_00_34_15_seed_1_22769259
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.7311198, 'precision': 0.73107594, 'recall': 0.731025, 'specificity': 0.731025, 'f1': 0.73104274, 'auroc': 0.7949823, 'binary_precision': 0.73324823, 'binary_recall': 0.7379576, 'binary_specificity': 0.7240924, 'binary_f1_score': 0.7355954}
confusion matrix:
      0     1
0  1097   418
1   408  1149
---- Validation: 
scalar performance:
{'acc': 0.5550351, 'precision': 0.58195245, 'recall': 0.5499232, 'specificity': 0.5499232, 'f1': 0.5039741, 'auroc': 0.74702656, 'binary_precision': 0.625, 'binary_recall': 0.23809524, 'binary_specificity': 0.86175114, 'binary_f1_score': 0.3448276}
confusion matrix:
     0    1
0  561   90
1  480  150
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6533333, 'precision': 0.6949936, 'recall': 0.6533333, 'specificity': 0.6533333, 'f1': 0.63377225, 'auroc': 0.7939161, 'binary_precision': 0.78512394, 'binary_recall': 0.42222223, 'binary_specificity': 0.8844444, 'binary_f1_score': 0.54913294}
confusion matrix:
     0   1
0  199  26
1  130  95
new oracle model saved
better model found
persisted
after epoch: 14,now: 2024-07-23 00:53:46.847666,epoch time: 0:01:24.384179,used: 0:19:31.680683,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_00_34_15_seed_1_22769259
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.7532552, 'precision': 0.7538539, 'recall': 0.7529707, 'specificity': 0.7529707, 'f1': 0.75294983, 'auroc': 0.82361174, 'binary_precision': 0.7438575, 'binary_recall': 0.7802835, 'binary_specificity': 0.7256579, 'binary_f1_score': 0.7616352}
confusion matrix:
      0     1
0  1103   417
1   341  1211
---- Validation: 
scalar performance:
{'acc': 0.57533175, 'precision': 0.6071817, 'recall': 0.57055813, 'specificity': 0.57055813, 'f1': 0.5331633, 'auroc': 0.75391704, 'binary_precision': 0.6616541, 'binary_recall': 0.2793651, 'binary_specificity': 0.86175114, 'binary_f1_score': 0.39285716}
confusion matrix:
     0    1
0  561   90
1  454  176
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6755555, 'precision': 0.70899475, 'recall': 0.6755556, 'specificity': 0.6755556, 'f1': 0.662037, 'auroc': 0.8005729, 'binary_precision': 0.7925926, 'binary_recall': 0.47555557, 'binary_specificity': 0.8755556, 'binary_f1_score': 0.59444445}
confusion matrix:
     0    1
0  197   28
1  118  107
new oracle model saved
better model found
persisted
after epoch: 15,now: 2024-07-23 00:55:10.177044,epoch time: 0:01:23.329378,used: 0:20:55.010061,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_00_34_15_seed_1_22769259
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.76432294, 'precision': 0.7646054, 'recall': 0.76409215, 'specificity': 0.76409215, 'f1': 0.7641294, 'auroc': 0.82949674, 'binary_precision': 0.758406, 'binary_recall': 0.7837838, 'binary_specificity': 0.7444005, 'binary_f1_score': 0.77088606}
confusion matrix:
      0     1
0  1130   388
1   336  1218
---- Validation: 
scalar performance:
{'acc': 0.57923496, 'precision': 0.6140068, 'recall': 0.57442397, 'specificity': 0.57442397, 'f1': 0.53673434, 'auroc': 0.7587619, 'binary_precision': 0.6730038, 'binary_recall': 0.2809524, 'binary_specificity': 0.86789554, 'binary_f1_score': 0.39641657}
confusion matrix:
     0    1
0  565   86
1  453  177
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6755555, 'precision': 0.7107991, 'recall': 0.6755556, 'specificity': 0.6755556, 'f1': 0.66140306, 'auroc': 0.804484, 'binary_precision': 0.7969925, 'binary_recall': 0.47111112, 'binary_specificity': 0.88, 'binary_f1_score': 0.59217876}
confusion matrix:
     0    1
0  198   27
1  119  106
better model found
persisted
after epoch: 16,now: 2024-07-23 00:56:33.309746,epoch time: 0:01:23.132702,used: 0:22:18.142763,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_00_34_15_seed_1_22769259
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.7610677, 'precision': 0.76109064, 'recall': 0.7611278, 'specificity': 0.7611278, 'f1': 0.76106274, 'auroc': 0.82117057, 'binary_precision': 0.7681254, 'binary_recall': 0.7562701, 'binary_specificity': 0.7659855, 'binary_f1_score': 0.76215166}
confusion matrix:
      0     1
0  1162   355
1   379  1176
---- Validation: 
scalar performance:
{'acc': 0.5839188, 'precision': 0.62183344, 'recall': 0.57908344, 'specificity': 0.57908344, 'f1': 0.54141253, 'auroc': 0.76343596, 'binary_precision': 0.68582374, 'binary_recall': 0.284127, 'binary_specificity': 0.87403995, 'binary_f1_score': 0.40179574}
confusion matrix:
     0    1
0  569   82
1  451  179
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.68222225, 'precision': 0.7197684, 'recall': 0.68222225, 'specificity': 0.68222225, 'f1': 0.66804403, 'auroc': 0.80882967, 'binary_precision': 0.81060606, 'binary_recall': 0.47555557, 'binary_specificity': 0.8888889, 'binary_f1_score': 0.5994398}
confusion matrix:
     0    1
0  200   25
1  118  107
new oracle model saved
better model found
persisted
after epoch: 17,now: 2024-07-23 00:57:56.145163,epoch time: 0:01:22.835417,used: 0:23:40.978180,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_00_34_15_seed_1_22769259
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.77766925, 'precision': 0.7776977, 'recall': 0.77773595, 'specificity': 0.77773595, 'f1': 0.77766526, 'auroc': 0.836954, 'binary_precision': 0.7849673, 'binary_recall': 0.7723473, 'binary_specificity': 0.78312457, 'binary_f1_score': 0.7786061}
confusion matrix:
      0     1
0  1188   329
1   354  1201
---- Validation: 
scalar performance:
{'acc': 0.6010929, 'precision': 0.63952655, 'recall': 0.59656936, 'specificity': 0.59656936, 'f1': 0.5656345, 'auroc': 0.76910734, 'binary_precision': 0.70877194, 'binary_recall': 0.32063493, 'binary_specificity': 0.8725038, 'binary_f1_score': 0.44153005}
confusion matrix:
     0    1
0  568   83
1  428  202
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6888889, 'precision': 0.7248677, 'recall': 0.6888889, 'specificity': 0.6888889, 'f1': 0.6759259, 'auroc': 0.8138667, 'binary_precision': 0.8148148, 'binary_recall': 0.4888889, 'binary_specificity': 0.8888889, 'binary_f1_score': 0.6111111}
confusion matrix:
     0    1
0  200   25
1  115  110
new oracle model saved
better model found
persisted
after epoch: 18,now: 2024-07-23 00:59:20.222485,epoch time: 0:01:24.077322,used: 0:25:05.055502,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_00_34_15_seed_1_22769259
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.78515625, 'precision': 0.7851279, 'recall': 0.78514963, 'specificity': 0.78514963, 'f1': 0.78513575, 'auroc': 0.8590903, 'binary_precision': 0.7887597, 'binary_recall': 0.78571427, 'binary_specificity': 0.784585, 'binary_f1_score': 0.78723407}
confusion matrix:
      0     1
0  1191   327
1   333  1221
---- Validation: 
scalar performance:
{'acc': 0.60265416, 'precision': 0.6438521, 'recall': 0.5980543, 'specificity': 0.5980543, 'f1': 0.5660595, 'auroc': 0.7729256, 'binary_precision': 0.71684587, 'binary_recall': 0.31746033, 'binary_specificity': 0.8786482, 'binary_f1_score': 0.44004405}
confusion matrix:
     0    1
0  572   79
1  430  200
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6888889, 'precision': 0.72680914, 'recall': 0.6888889, 'specificity': 0.6888889, 'f1': 0.675318, 'auroc': 0.81730366, 'binary_precision': 0.81954885, 'binary_recall': 0.48444444, 'binary_specificity': 0.8933333, 'binary_f1_score': 0.6089386}
confusion matrix:
     0    1
0  201   24
1  116  109
better model found
persisted
after epoch: 19,now: 2024-07-23 01:00:42.984758,epoch time: 0:01:22.762273,used: 0:26:27.817775,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_00_34_15_seed_1_22769259
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.7874349, 'precision': 0.78742766, 'recall': 0.78734374, 'specificity': 0.78734374, 'f1': 0.78737164, 'auroc': 0.866454, 'binary_precision': 0.7877629, 'binary_recall': 0.7943445, 'binary_specificity': 0.780343, 'binary_f1_score': 0.79104}
confusion matrix:
      0     1
0  1183   333
1   320  1236
---- Validation: 
scalar performance:
{'acc': 0.61904764, 'precision': 0.6591737, 'recall': 0.6147466, 'specificity': 0.6147466, 'f1': 0.5885042, 'auroc': 0.77868235, 'binary_precision': 0.7350993, 'binary_recall': 0.35238096, 'binary_specificity': 0.87711215, 'binary_f1_score': 0.47639483}
confusion matrix:
     0    1
0  571   80
1  408  222
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6933333, 'precision': 0.7264105, 'recall': 0.6933333, 'specificity': 0.6933333, 'f1': 0.6817082, 'auroc': 0.8227358, 'binary_precision': 0.81294966, 'binary_recall': 0.50222224, 'binary_specificity': 0.8844444, 'binary_f1_score': 0.6208791}
confusion matrix:
     0    1
0  199   26
1  112  113
new oracle model saved
better model found
persisted
after epoch: 20,now: 2024-07-23 01:02:07.710858,epoch time: 0:01:24.726100,used: 0:27:52.543875,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_00_34_15_seed_1_22769259
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.79296875, 'precision': 0.7930281, 'recall': 0.7930579, 'specificity': 0.7930579, 'f1': 0.7929674, 'auroc': 0.86297286, 'binary_precision': 0.8013115, 'binary_recall': 0.7858521, 'binary_specificity': 0.8002637, 'binary_f1_score': 0.7935065}
confusion matrix:
      0     1
0  1214   303
1   333  1222
---- Validation: 
scalar performance:
{'acc': 0.62373143, 'precision': 0.66495514, 'recall': 0.61945724, 'specificity': 0.61945724, 'f1': 0.5939356, 'auroc': 0.7829468, 'binary_precision': 0.7434211, 'binary_recall': 0.35873017, 'binary_specificity': 0.88018435, 'binary_f1_score': 0.48394006}
confusion matrix:
     0    1
0  573   78
1  404  226
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.69777775, 'precision': 0.7316153, 'recall': 0.69777775, 'specificity': 0.69777775, 'f1': 0.6863211, 'auroc': 0.8273778, 'binary_precision': 0.8201439, 'binary_recall': 0.50666666, 'binary_specificity': 0.8888889, 'binary_f1_score': 0.6263736}
confusion matrix:
     0    1
0  200   25
1  111  114
new oracle model saved
better model found
persisted
after epoch: 21,now: 2024-07-23 01:03:30.916587,epoch time: 0:01:23.205729,used: 0:29:15.749604,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_00_34_15_seed_1_22769259
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.8125, 'precision': 0.81253016, 'recall': 0.81257844, 'specificity': 0.81257844, 'f1': 0.81249607, 'auroc': 0.8775971, 'binary_precision': 0.8202614, 'binary_recall': 0.8065553, 'binary_specificity': 0.8186016, 'binary_f1_score': 0.81335056}
confusion matrix:
      0     1
0  1241   275
1   301  1255
---- Validation: 
scalar performance:
{'acc': 0.63153785, 'precision': 0.6720733, 'recall': 0.6273938, 'specificity': 0.6273938, 'f1': 0.6041409, 'auroc': 0.7871114, 'binary_precision': 0.75159234, 'binary_recall': 0.37460318, 'binary_specificity': 0.88018435, 'binary_f1_score': 0.5}
confusion matrix:
     0    1
0  573   78
1  394  236
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.69777775, 'precision': 0.72807, 'recall': 0.69777775, 'specificity': 0.69777775, 'f1': 0.68739784, 'auroc': 0.831921, 'binary_precision': 0.8111888, 'binary_recall': 0.51555556, 'binary_specificity': 0.88, 'binary_f1_score': 0.6304348}
confusion matrix:
     0    1
0  198   27
1  109  116
better model found
persisted
after epoch: 22,now: 2024-07-23 01:04:46.478147,epoch time: 0:01:15.561560,used: 0:30:31.311164,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_00_34_15_seed_1_22769259
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.7988281, 'precision': 0.7990343, 'recall': 0.79897594, 'specificity': 0.79897594, 'f1': 0.798826, 'auroc': 0.8771999, 'binary_precision': 0.8103448, 'binary_recall': 0.78635776, 'binary_specificity': 0.8115942, 'binary_f1_score': 0.7981711}
confusion matrix:
      0     1
0  1232   286
1   332  1222
---- Validation: 
scalar performance:
{'acc': 0.63856363, 'precision': 0.67831755, 'recall': 0.6345366, 'specificity': 0.6345366, 'f1': 0.6132047, 'auroc': 0.7910809, 'binary_precision': 0.7585139, 'binary_recall': 0.3888889, 'binary_specificity': 0.88018435, 'binary_f1_score': 0.5141658}
confusion matrix:
     0    1
0  573   78
1  385  245
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.70666665, 'precision': 0.73489594, 'recall': 0.7066667, 'specificity': 0.7066667, 'f1': 0.69758064, 'auroc': 0.8358518, 'binary_precision': 0.81632656, 'binary_recall': 0.53333336, 'binary_specificity': 0.88, 'binary_f1_score': 0.64516133}
confusion matrix:
     0    1
0  198   27
1  105  120
new oracle model saved
better model found
persisted
after epoch: 23,now: 2024-07-23 01:06:02.340456,epoch time: 0:01:15.862309,used: 0:31:47.173473,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_00_34_15_seed_1_22769259
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.81380206, 'precision': 0.8137871, 'recall': 0.8137536, 'specificity': 0.8137536, 'f1': 0.81376725, 'auroc': 0.8866142, 'binary_precision': 0.8147436, 'binary_recall': 0.81788933, 'binary_specificity': 0.80961794, 'binary_f1_score': 0.8163134}
confusion matrix:
      0     1
0  1229   289
1   283  1271
---- Validation: 
scalar performance:
{'acc': 0.6557377, 'precision': 0.690426, 'recall': 0.6520994, 'specificity': 0.6520994, 'f1': 0.6360414, 'auroc': 0.7953625, 'binary_precision': 0.7677054, 'binary_recall': 0.43015873, 'binary_specificity': 0.87403995, 'binary_f1_score': 0.55137336}
confusion matrix:
     0    1
0  569   82
1  359  271
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.71555555, 'precision': 0.7401466, 'recall': 0.71555555, 'specificity': 0.71555555, 'f1': 0.70808244, 'auroc': 0.8401778, 'binary_precision': 0.8169935, 'binary_recall': 0.5555556, 'binary_specificity': 0.8755556, 'binary_f1_score': 0.6613757}
confusion matrix:
     0    1
0  197   28
1  100  125
new oracle model saved
better model found
persisted
after epoch: 24,now: 2024-07-23 01:07:17.151957,epoch time: 0:01:14.811501,used: 0:33:01.984974,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_00_34_15_seed_1_22769259
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.81673175, 'precision': 0.8169273, 'recall': 0.81688493, 'specificity': 0.81688493, 'f1': 0.81673086, 'auroc': 0.8916578, 'binary_precision': 0.82847685, 'binary_recall': 0.8045016, 'binary_specificity': 0.8292683, 'binary_f1_score': 0.8163132}
confusion matrix:
      0     1
0  1258   259
1   304  1251
---- Validation: 
scalar performance:
{'acc': 0.65261513, 'precision': 0.68842447, 'recall': 0.64889914, 'specificity': 0.64889914, 'f1': 0.6318835, 'auroc': 0.79781044, 'binary_precision': 0.7665706, 'binary_recall': 0.42222223, 'binary_specificity': 0.875576, 'binary_f1_score': 0.5445241}
confusion matrix:
     0    1
0  570   81
1  364  266
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7133333, 'precision': 0.74, 'recall': 0.71333337, 'specificity': 0.71333337, 'f1': 0.70514286, 'auroc': 0.84225184, 'binary_precision': 0.82, 'binary_recall': 0.5466667, 'binary_specificity': 0.88, 'binary_f1_score': 0.656}
confusion matrix:
     0    1
0  198   27
1  102  123
early stop counter: 1
val acc:0.6526151299476624, best validation acc: 0.6557376980781555, corresponding to test acc:                         0.7155555486679077 / 0.7155555486679077
after epoch: 25,now: 2024-07-23 01:08:32.206404,epoch time: 0:01:15.054447,used: 0:34:17.039421,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_00_34_15_seed_1_22769259
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.81673175, 'precision': 0.8172977, 'recall': 0.8170017, 'specificity': 0.8170017, 'f1': 0.81671315, 'auroc': 0.89268994, 'binary_precision': 0.83434343, 'binary_recall': 0.7962725, 'binary_specificity': 0.8377309, 'binary_f1_score': 0.81486356}
confusion matrix:
      0     1
0  1270   246
1   317  1239
---- Validation: 
scalar performance:
{'acc': 0.6533958, 'precision': 0.68974066, 'recall': 0.6496672, 'specificity': 0.6496672, 'f1': 0.6325662, 'auroc': 0.8008461, 'binary_precision': 0.76878613, 'binary_recall': 0.42222223, 'binary_specificity': 0.87711215, 'binary_f1_score': 0.545082}
confusion matrix:
     0    1
0  571   80
1  364  266
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7111111, 'precision': 0.7382996, 'recall': 0.71111107, 'specificity': 0.71111107, 'f1': 0.7026291, 'auroc': 0.8448395, 'binary_precision': 0.8187919, 'binary_recall': 0.5422222, 'binary_specificity': 0.88, 'binary_f1_score': 0.6524064}
confusion matrix:
     0    1
0  198   27
1  103  122
early stop counter: 2
val acc:0.6533957719802856, best validation acc: 0.6557376980781555, corresponding to test acc:                         0.7155555486679077 / 0.7155555486679077
after epoch: 26,now: 2024-07-23 01:09:46.624493,epoch time: 0:01:14.418089,used: 0:35:31.457510,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_00_34_15_seed_1_22769259
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.820638, 'precision': 0.821165, 'recall': 0.8208458, 'specificity': 0.8208458, 'f1': 0.82061476, 'auroc': 0.897679, 'binary_precision': 0.837037, 'binary_recall': 0.80090207, 'binary_specificity': 0.8407895, 'binary_f1_score': 0.818571}
confusion matrix:
      0     1
0  1278   242
1   309  1243
---- Validation: 
scalar performance:
{'acc': 0.6541764, 'precision': 0.6904007, 'recall': 0.65046084, 'specificity': 0.65046084, 'f1': 0.6335379, 'auroc': 0.803733, 'binary_precision': 0.76945245, 'binary_recall': 0.42380953, 'binary_specificity': 0.87711215, 'binary_f1_score': 0.54657114}
confusion matrix:
     0    1
0  571   80
1  363  267
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.71555555, 'precision': 0.7416997, 'recall': 0.71555555, 'specificity': 0.71555555, 'f1': 0.7076498, 'auroc': 0.84752595, 'binary_precision': 0.821192, 'binary_recall': 0.5511111, 'binary_specificity': 0.88, 'binary_f1_score': 0.65957445}
confusion matrix:
     0    1
0  198   27
1  101  124
early stop counter: 3
val acc:0.6541764140129089, best validation acc: 0.6557376980781555, corresponding to test acc:                         0.7155555486679077 / 0.7155555486679077
after epoch: 27,now: 2024-07-23 01:11:01.852973,epoch time: 0:01:15.228480,used: 0:36:46.685990,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_00_34_15_seed_1_22769259
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.83203125, 'precision': 0.8320162, 'recall': 0.83197737, 'specificity': 0.83197737, 'f1': 0.8319936, 'auroc': 0.9082172, 'binary_precision': 0.83290654, 'binary_recall': 0.8361183, 'binary_specificity': 0.8278364, 'binary_f1_score': 0.8345093}
confusion matrix:
      0     1
0  1255   261
1   255  1301
---- Validation: 
scalar performance:
{'acc': 0.68930525, 'precision': 0.7162354, 'recall': 0.68630314, 'specificity': 0.68630314, 'f1': 0.6771052, 'auroc': 0.80837786, 'binary_precision': 0.78855723, 'binary_recall': 0.5031746, 'binary_specificity': 0.8694316, 'binary_f1_score': 0.6143411}
confusion matrix:
     0    1
0  566   85
1  313  317
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.72888887, 'precision': 0.7504377, 'recall': 0.72888887, 'specificity': 0.72888887, 'f1': 0.7229288, 'auroc': 0.85181236, 'binary_precision': 0.8238994, 'binary_recall': 0.5822222, 'binary_specificity': 0.8755556, 'binary_f1_score': 0.6822917}
confusion matrix:
     0    1
0  197   28
1   94  131
new oracle model saved
better model found
persisted
after epoch: 28,now: 2024-07-23 01:12:17.740340,epoch time: 0:01:15.887367,used: 0:38:02.573357,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_00_34_15_seed_1_22769259
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.83203125, 'precision': 0.83228517, 'recall': 0.8322147, 'specificity': 0.8322147, 'f1': 0.83202946, 'auroc': 0.907132, 'binary_precision': 0.84528553, 'binary_recall': 0.8181234, 'binary_specificity': 0.8463061, 'binary_f1_score': 0.83148265}
confusion matrix:
      0     1
0  1283   233
1   283  1273
---- Validation: 
scalar performance:
{'acc': 0.6713505, 'precision': 0.7027991, 'recall': 0.66799796, 'specificity': 0.66799796, 'f1': 0.65535134, 'auroc': 0.80995536, 'binary_precision': 0.7786667, 'binary_recall': 0.46349207, 'binary_specificity': 0.8725038, 'binary_f1_score': 0.5810945}
confusion matrix:
     0    1
0  568   83
1  338  292
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.72888887, 'precision': 0.75341713, 'recall': 0.72888887, 'specificity': 0.72888887, 'f1': 0.72216594, 'auroc': 0.8531951, 'binary_precision': 0.83225805, 'binary_recall': 0.5733333, 'binary_specificity': 0.8844444, 'binary_f1_score': 0.6789473}
confusion matrix:
     0    1
0  199   26
1   96  129
early stop counter: 1
val acc:0.6713504791259766, best validation acc: 0.6893052458763123, corresponding to test acc:                         0.7288888692855835 / 0.7288888692855835
after epoch: 29,now: 2024-07-23 01:13:32.832652,epoch time: 0:01:15.092312,used: 0:39:17.665669,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_00_34_15_seed_1_22769259
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.8336589, 'precision': 0.8338013, 'recall': 0.8337848, 'specificity': 0.8337848, 'f1': 0.8336587, 'auroc': 0.9128972, 'binary_precision': 0.8442244, 'binary_recall': 0.8230373, 'binary_specificity': 0.84453225, 'binary_f1_score': 0.8334963}
confusion matrix:
      0     1
0  1282   236
1   275  1279
---- Validation: 
scalar performance:
{'acc': 0.6861827, 'precision': 0.71601915, 'recall': 0.6830261, 'specificity': 0.6830261, 'f1': 0.672591, 'auroc': 0.8124351, 'binary_precision': 0.7923077, 'binary_recall': 0.4904762, 'binary_specificity': 0.875576, 'binary_f1_score': 0.60588235}
confusion matrix:
     0    1
0  570   81
1  321  309
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7311111, 'precision': 0.75510204, 'recall': 0.7311111, 'specificity': 0.7311111, 'f1': 0.72463703, 'auroc': 0.856, 'binary_precision': 0.8333333, 'binary_recall': 0.5777778, 'binary_specificity': 0.8844444, 'binary_f1_score': 0.6824147}
confusion matrix:
     0    1
0  199   26
1   95  130
new oracle model saved
early stop counter: 2
val acc:0.6861826777458191, best validation acc: 0.6893052458763123, corresponding to test acc:                         0.7288888692855835 / 0.7311111092567444
after epoch: 30,now: 2024-07-23 01:14:48.533423,epoch time: 0:01:15.700771,used: 0:40:33.366440,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_00_34_15_seed_1_22769259
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 0:40:33.366440 at 2024-07-23 01:14:48.533423
persisted model performance metric: 

scalar performance:
{'acc': 0.72888887, 'precision': 0.7504377, 'recall': 0.72888887, 'specificity': 0.72888887, 'f1': 0.7229288, 'auroc': 0.85181236, 'binary_precision': 0.8238994, 'binary_recall': 0.5822222, 'binary_specificity': 0.8755556, 'binary_f1_score': 0.6822917}
confusion matrix:
     0    1
0  197   28
1   94  131
oracle model performance metric: 

scalar performance:
{'acc': 0.7311111, 'precision': 0.75510204, 'recall': 0.7311111, 'specificity': 0.7311111, 'f1': 0.72463703, 'auroc': 0.856, 'binary_precision': 0.8333333, 'binary_recall': 0.5777778, 'binary_specificity': 0.8844444, 'binary_f1_score': 0.6824147}
confusion matrix:
     0    1
0  199   26
1   95  130
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_dial_lr1e5_bs16_allfreeze_2024-07-22_23-46-53/rule_results/2.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_dial_lr1e5_bs16_allfreeze_2024-07-22_23-46-53/confusion_matrix/2.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 189882 KiB | 460555 KiB |  79388 GiB |  79388 GiB |
|       from large pool | 173494 KiB | 428048 KiB |  77747 GiB |  77747 GiB |
|       from small pool |  16388 KiB |  37418 KiB |   1641 GiB |   1640 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 189882 KiB | 460555 KiB |  79388 GiB |  79388 GiB |
|       from large pool | 173494 KiB | 428048 KiB |  77747 GiB |  77747 GiB |
|       from small pool |  16388 KiB |  37418 KiB |   1641 GiB |   1640 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 189010 KiB | 457292 KiB |  79382 GiB |  79382 GiB |
|       from large pool | 172814 KiB | 424940 KiB |  77745 GiB |  77744 GiB |
|       from small pool |  16196 KiB |  37230 KiB |   1637 GiB |   1637 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 530432 KiB | 530432 KiB |    796 MiB | 284672 KiB |
|       from large pool | 487424 KiB | 487424 KiB |    738 MiB | 268288 KiB |
|       from small pool |  43008 KiB |  43008 KiB |     58 MiB |  16384 KiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  37445 KiB |  84599 KiB |  44384 GiB |  44384 GiB |
|       from large pool |  31306 KiB |  79555 KiB |  42701 GiB |  42701 GiB |
|       from small pool |   6139 KiB |  11196 KiB |   1683 GiB |   1683 GiB |
|---------------------------------------------------------------------------|
| Allocations           |     788    |    1159    |   17155 K  |   17154 K  |
|       from large pool |      76    |     158    |    7673 K  |    7673 K  |
|       from small pool |     712    |    1008    |    9482 K  |    9481 K  |
|---------------------------------------------------------------------------|
| Active allocs         |     788    |    1159    |   17155 K  |   17154 K  |
|       from large pool |      76    |     158    |    7673 K  |    7673 K  |
|       from small pool |     712    |    1008    |    9482 K  |    9481 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      43    |      43    |      62    |      19    |
|       from large pool |      22    |      22    |      33    |      11    |
|       from small pool |      21    |      21    |      29    |       8    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      37    |     216    |   10273 K  |   10273 K  |
|       from large pool |      10    |      22    |    4604 K  |    4604 K  |
|       from small pool |      27    |     207    |    5669 K  |    5669 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  17088 KiB | 460555 KiB |  79388 GiB |  79388 GiB |
|       from large pool |  17088 KiB | 428048 KiB |  77747 GiB |  77747 GiB |
|       from small pool |      0 KiB |  37418 KiB |   1641 GiB |   1641 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  17088 KiB | 460555 KiB |  79388 GiB |  79388 GiB |
|       from large pool |  17088 KiB | 428048 KiB |  77747 GiB |  77747 GiB |
|       from small pool |      0 KiB |  37418 KiB |   1641 GiB |   1641 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB | 457292 KiB |  79382 GiB |  79382 GiB |
|       from large pool |  16640 KiB | 424940 KiB |  77745 GiB |  77745 GiB |
|       from small pool |      0 KiB |  37230 KiB |   1637 GiB |   1637 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 227328 KiB | 530432 KiB |    796 MiB | 587776 KiB |
|       from large pool | 204800 KiB | 487424 KiB |    738 MiB | 550912 KiB |
|       from small pool |  22528 KiB |  43008 KiB |     58 MiB |  36864 KiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  23872 KiB |  84599 KiB |  44384 GiB |  44384 GiB |
|       from large pool |  23872 KiB |  79555 KiB |  42701 GiB |  42701 GiB |
|       from small pool |      0 KiB |  11196 KiB |   1683 GiB |   1683 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    1159    |   17155 K  |   17155 K  |
|       from large pool |       2    |     158    |    7673 K  |    7673 K  |
|       from small pool |       0    |    1008    |    9482 K  |    9482 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    1159    |   17155 K  |   17155 K  |
|       from large pool |       2    |     158    |    7673 K  |    7673 K  |
|       from small pool |       0    |    1008    |    9482 K  |    9482 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      21    |      43    |      62    |      41    |
|       from large pool |      10    |      22    |      33    |      23    |
|       from small pool |      11    |      21    |      29    |      18    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     216    |   10273 K  |   10273 K  |
|       from large pool |       3    |      22    |    4604 K  |    4604 K  |
|       from small pool |       0    |     207    |    5669 K  |    5669 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  17088 KiB | 460555 KiB |  79388 GiB |  79388 GiB |
|       from large pool |  17088 KiB | 428048 KiB |  77747 GiB |  77747 GiB |
|       from small pool |      0 KiB |  37418 KiB |   1641 GiB |   1641 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  17088 KiB | 460555 KiB |  79388 GiB |  79388 GiB |
|       from large pool |  17088 KiB | 428048 KiB |  77747 GiB |  77747 GiB |
|       from small pool |      0 KiB |  37418 KiB |   1641 GiB |   1641 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB | 457292 KiB |  79382 GiB |  79382 GiB |
|       from large pool |  16640 KiB | 424940 KiB |  77745 GiB |  77745 GiB |
|       from small pool |      0 KiB |  37230 KiB |   1637 GiB |   1637 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 227328 KiB | 530432 KiB |    796 MiB | 587776 KiB |
|       from large pool | 204800 KiB | 487424 KiB |    738 MiB | 550912 KiB |
|       from small pool |  22528 KiB |  43008 KiB |     58 MiB |  36864 KiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  23872 KiB |  84599 KiB |  44384 GiB |  44384 GiB |
|       from large pool |  23872 KiB |  79555 KiB |  42701 GiB |  42701 GiB |
|       from small pool |      0 KiB |  11196 KiB |   1683 GiB |   1683 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    1159    |   17155 K  |   17155 K  |
|       from large pool |       2    |     158    |    7673 K  |    7673 K  |
|       from small pool |       0    |    1008    |    9482 K  |    9482 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    1159    |   17155 K  |   17155 K  |
|       from large pool |       2    |     158    |    7673 K  |    7673 K  |
|       from small pool |       0    |    1008    |    9482 K  |    9482 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      21    |      43    |      62    |      41    |
|       from large pool |      10    |      22    |      33    |      23    |
|       from small pool |      11    |      21    |      29    |      18    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     216    |   10273 K  |   10273 K  |
|       from large pool |       3    |      22    |    4604 K  |    4604 K  |
|       from small pool |       0    |     207    |    5669 K  |    5669 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'888c1ef2'
model name: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_01_16_12_seed_2_22769259

 Experiment start at: 2024-07-23 01:16:12.614578
before training, model accuracy: 0.41203704476356506
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.5281414, 'precision': 0.54185987, 'recall': 0.5302145, 'specificity': 0.5302145, 'f1': 0.4939828, 'auroc': 0.57540846, 'binary_precision': 0.56786704, 'binary_recall': 0.26623377, 'binary_specificity': 0.79419523, 'binary_f1_score': 0.36251104}
confusion matrix:
      0    1
0  1204  312
1  1130  410
---- Validation: 
scalar performance:
{'acc': 0.63223785, 'precision': 0.6426524, 'recall': 0.62806106, 'specificity': 0.62806106, 'f1': 0.6207955, 'auroc': 0.6600634, 'binary_precision': 0.6751152, 'binary_recall': 0.47106108, 'binary_specificity': 0.785061, 'binary_f1_score': 0.55492425}
confusion matrix:
     0    1
0  515  141
1  329  293
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.35416666, 'precision': 0.32744542, 'recall': 0.35416666, 'specificity': 0.35416666, 'f1': 0.3281568, 'auroc': 0.29608196, 'binary_precision': 0.259542, 'binary_recall': 0.1574074, 'binary_specificity': 0.5509259, 'binary_f1_score': 0.19596542}
confusion matrix:
     0   1
0  119  97
1  182  34
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-23 01:17:32.321975,epoch time: 0:01:19.707397,used: 0:01:19.707397,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_01_16_12_seed_2_22769259
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.572644, 'precision': 0.5753022, 'recall': 0.57329094, 'specificity': 0.57329094, 'f1': 0.5700362, 'auroc': 0.6134826, 'binary_precision': 0.5915493, 'binary_recall': 0.4909091, 'binary_specificity': 0.65567285, 'binary_f1_score': 0.53655076}
confusion matrix:
     0    1
0  994  522
1  784  756
---- Validation: 
scalar performance:
{'acc': 0.6549296, 'precision': 0.6546776, 'recall': 0.65466434, 'specificity': 0.65466434, 'f1': 0.6546706, 'auroc': 0.6769861, 'binary_precision': 0.6457327, 'binary_recall': 0.6446945, 'binary_specificity': 0.66463417, 'binary_f1_score': 0.6452132}
confusion matrix:
     0    1
0  436  220
1  221  401
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.36574075, 'precision': 0.36545235, 'recall': 0.36574075, 'specificity': 0.36574075, 'f1': 0.36540073, 'auroc': 0.3144933, 'binary_precision': 0.37168142, 'binary_recall': 0.3888889, 'binary_specificity': 0.3425926, 'binary_f1_score': 0.38009053}
confusion matrix:
     0    1
0   74  142
1  132   84
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-07-23 01:18:46.292078,epoch time: 0:01:13.970103,used: 0:02:33.677500,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_01_16_12_seed_2_22769259
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.6004581, 'precision': 0.60051423, 'recall': 0.600508, 'specificity': 0.600508, 'f1': 0.6004571, 'auroc': 0.63817334, 'binary_precision': 0.60555923, 'binary_recall': 0.59415585, 'binary_specificity': 0.60686016, 'binary_f1_score': 0.5998033}
confusion matrix:
     0    1
0  920  596
1  625  915
---- Validation: 
scalar performance:
{'acc': 0.64162755, 'precision': 0.6444756, 'recall': 0.6430819, 'specificity': 0.6430819, 'f1': 0.64112127, 'auroc': 0.69155115, 'binary_precision': 0.61647725, 'binary_recall': 0.6977492, 'binary_specificity': 0.5884146, 'binary_f1_score': 0.6546003}
confusion matrix:
     0    1
0  386  270
1  188  434
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.41666666, 'precision': 0.409699, 'recall': 0.4166667, 'specificity': 0.4166667, 'f1': 0.40519273, 'auroc': 0.3409422, 'binary_precision': 0.4347826, 'binary_recall': 0.5555556, 'binary_specificity': 0.2777778, 'binary_f1_score': 0.48780486}
confusion matrix:
    0    1
0  60  156
1  96  120
new oracle model saved
early stop counter: 1
val acc:0.6416275501251221, best validation acc: 0.6549295783042908, corresponding to test acc:                         0.36574074625968933 / 0.4166666567325592
after epoch: 3,now: 2024-07-23 01:19:59.818210,epoch time: 0:01:13.526132,used: 0:03:47.203632,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_01_16_12_seed_2_22769259
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.635144, 'precision': 0.6352793, 'recall': 0.635232, 'specificity': 0.635232, 'f1': 0.63512987, 'auroc': 0.6788353, 'binary_precision': 0.64195055, 'binary_recall': 0.624026, 'binary_specificity': 0.646438, 'binary_f1_score': 0.6328614}
confusion matrix:
     0    1
0  980  536
1  579  961
---- Validation: 
scalar performance:
{'acc': 0.65336466, 'precision': 0.6550156, 'recall': 0.65438986, 'specificity': 0.65438986, 'f1': 0.65320987, 'auroc': 0.70349383, 'binary_precision': 0.63103956, 'binary_recall': 0.69292605, 'binary_specificity': 0.61585367, 'binary_f1_score': 0.66053647}
confusion matrix:
     0    1
0  404  252
1  191  431
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.4398148, 'precision': 0.43547794, 'recall': 0.4398148, 'specificity': 0.4398148, 'f1': 0.43024066, 'auroc': 0.37538582, 'binary_precision': 0.4522059, 'binary_recall': 0.5694444, 'binary_specificity': 0.3101852, 'binary_f1_score': 0.50409836}
confusion matrix:
    0    1
0  67  149
1  93  123
new oracle model saved
early stop counter: 2
val acc:0.6533646583557129, best validation acc: 0.6549295783042908, corresponding to test acc:                         0.36574074625968933 / 0.43981480598449707
after epoch: 4,now: 2024-07-23 01:21:12.141868,epoch time: 0:01:12.323658,used: 0:04:59.527290,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_01_16_12_seed_2_22769259
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.6459424, 'precision': 0.6460887, 'recall': 0.64603364, 'specificity': 0.64603364, 'f1': 0.6459272, 'auroc': 0.7050522, 'binary_precision': 0.65307486, 'binary_recall': 0.63441557, 'binary_specificity': 0.6576517, 'binary_f1_score': 0.64361}
confusion matrix:
     0    1
0  997  519
1  563  977
---- Validation: 
scalar performance:
{'acc': 0.6596244, 'precision': 0.66119516, 'recall': 0.6606124, 'specificity': 0.6606124, 'f1': 0.65949416, 'auroc': 0.712873, 'binary_precision': 0.6372981, 'binary_recall': 0.6977492, 'binary_specificity': 0.6234756, 'binary_f1_score': 0.6661551}
confusion matrix:
     0    1
0  409  247
1  188  434
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.46296296, 'precision': 0.46049383, 'recall': 0.46296299, 'specificity': 0.46296299, 'f1': 0.45443857, 'auroc': 0.40397805, 'binary_precision': 0.47037038, 'binary_recall': 0.587963, 'binary_specificity': 0.33796296, 'binary_f1_score': 0.52263373}
confusion matrix:
    0    1
0  73  143
1  89  127
new oracle model saved
better model found
persisted
after epoch: 5,now: 2024-07-23 01:22:24.667138,epoch time: 0:01:12.525270,used: 0:06:12.052560,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_01_16_12_seed_2_22769259
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.6681937, 'precision': 0.6686833, 'recall': 0.6679419, 'specificity': 0.6679419, 'f1': 0.66773134, 'auroc': 0.7225323, 'binary_precision': 0.6613497, 'binary_recall': 0.7, 'binary_specificity': 0.6358839, 'binary_f1_score': 0.6801262}
confusion matrix:
     0     1
0  964   552
1  462  1078
---- Validation: 
scalar performance:
{'acc': 0.6643193, 'precision': 0.66637874, 'recall': 0.6654772, 'specificity': 0.6654772, 'f1': 0.6640953, 'auroc': 0.7209827, 'binary_precision': 0.64005804, 'binary_recall': 0.7090032, 'binary_specificity': 0.6219512, 'binary_f1_score': 0.6727689}
confusion matrix:
     0    1
0  408  248
1  181  441
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.4652778, 'precision': 0.46204934, 'recall': 0.4652778, 'specificity': 0.4652778, 'f1': 0.45365858, 'auroc': 0.42888373, 'binary_precision': 0.47311828, 'binary_recall': 0.6111111, 'binary_specificity': 0.31944445, 'binary_f1_score': 0.53333336}
confusion matrix:
    0    1
0  69  147
1  84  132
new oracle model saved
better model found
persisted
after epoch: 6,now: 2024-07-23 01:23:41.202186,epoch time: 0:01:16.535048,used: 0:07:28.587608,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_01_16_12_seed_2_22769259
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.6917539, 'precision': 0.6917386, 'recall': 0.69174516, 'specificity': 0.69174516, 'f1': 0.6917407, 'auroc': 0.76413196, 'binary_precision': 0.69466144, 'binary_recall': 0.69285715, 'binary_specificity': 0.69063324, 'binary_f1_score': 0.6937581}
confusion matrix:
      0     1
0  1047   469
1   473  1067
---- Validation: 
scalar performance:
{'acc': 0.6737089, 'precision': 0.67462707, 'recall': 0.67441523, 'specificity': 0.67441523, 'f1': 0.6736847, 'auroc': 0.7279086, 'binary_precision': 0.6536732, 'binary_recall': 0.7009646, 'binary_specificity': 0.64786583, 'binary_f1_score': 0.67649335}
confusion matrix:
     0    1
0  425  231
1  186  436
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5, 'precision': 0.5, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49374998, 'auroc': 0.45533264, 'binary_precision': 0.5, 'binary_recall': 0.6111111, 'binary_specificity': 0.3888889, 'binary_f1_score': 0.54999995}
confusion matrix:
    0    1
0  84  132
1  84  132
new oracle model saved
better model found
persisted
after epoch: 7,now: 2024-07-23 01:25:03.058261,epoch time: 0:01:21.856075,used: 0:08:50.443683,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_01_16_12_seed_2_22769259
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.7045157, 'precision': 0.7045847, 'recall': 0.704572, 'specificity': 0.704572, 'f1': 0.7045149, 'auroc': 0.77168405, 'binary_precision': 0.71078753, 'binary_recall': 0.6974026, 'binary_specificity': 0.71174145, 'binary_f1_score': 0.70403147}
confusion matrix:
      0     1
0  1079   437
1   466  1074
---- Validation: 
scalar performance:
{'acc': 0.68075114, 'precision': 0.6808176, 'recall': 0.6809417, 'specificity': 0.6809417, 'f1': 0.6807128, 'auroc': 0.7346654, 'binary_precision': 0.6666667, 'binary_recall': 0.6881029, 'binary_specificity': 0.6737805, 'binary_f1_score': 0.6772152}
confusion matrix:
     0    1
0  442  214
1  194  428
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5162037, 'precision': 0.51680934, 'recall': 0.5162037, 'specificity': 0.5162037, 'f1': 0.5118063, 'auroc': 0.48010975, 'binary_precision': 0.51361865, 'binary_recall': 0.6111111, 'binary_specificity': 0.4212963, 'binary_f1_score': 0.5581395}
confusion matrix:
    0    1
0  91  125
1  84  132
new oracle model saved
better model found
persisted
after epoch: 8,now: 2024-07-23 01:26:22.083932,epoch time: 0:01:19.025671,used: 0:10:09.469354,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_01_16_12_seed_2_22769259
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.7179319, 'precision': 0.7184797, 'recall': 0.71810985, 'specificity': 0.71810985, 'f1': 0.7178502, 'auroc': 0.7875471, 'binary_precision': 0.73155737, 'binary_recall': 0.69545454, 'binary_specificity': 0.74076515, 'binary_f1_score': 0.7130492}
confusion matrix:
      0     1
0  1123   393
1   469  1071
---- Validation: 
scalar performance:
{'acc': 0.69092333, 'precision': 0.69076186, 'recall': 0.69085026, 'specificity': 0.69085026, 'f1': 0.6907853, 'auroc': 0.7412948, 'binary_precision': 0.68044513, 'binary_recall': 0.6881029, 'binary_specificity': 0.69359756, 'binary_f1_score': 0.6842526}
confusion matrix:
     0    1
0  455  201
1  194  428
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5231481, 'precision': 0.52388746, 'recall': 0.5231482, 'specificity': 0.5231482, 'f1': 0.5194297, 'auroc': 0.50428665, 'binary_precision': 0.51968503, 'binary_recall': 0.6111111, 'binary_specificity': 0.4351852, 'binary_f1_score': 0.5617021}
confusion matrix:
    0    1
0  94  122
1  84  132
new oracle model saved
better model found
persisted
after epoch: 9,now: 2024-07-23 01:27:42.746183,epoch time: 0:01:20.662251,used: 0:11:30.131605,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_01_16_12_seed_2_22769259
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.7356021, 'precision': 0.73582554, 'recall': 0.73570913, 'specificity': 0.73570913, 'f1': 0.7355858, 'auroc': 0.8135669, 'binary_precision': 0.74530834, 'binary_recall': 0.7220779, 'binary_specificity': 0.74934036, 'binary_f1_score': 0.73350924}
confusion matrix:
      0     1
0  1136   380
1   428  1112
---- Validation: 
scalar performance:
{'acc': 0.69561815, 'precision': 0.6955426, 'recall': 0.69567335, 'specificity': 0.69567335, 'f1': 0.6955359, 'auroc': 0.7469635, 'binary_precision': 0.6834646, 'binary_recall': 0.6977492, 'binary_specificity': 0.69359756, 'binary_f1_score': 0.69053304}
confusion matrix:
     0    1
0  455  201
1  188  434
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5208333, 'precision': 0.52169305, 'recall': 0.5208334, 'specificity': 0.5208334, 'f1': 0.5160384, 'auroc': 0.5241984, 'binary_precision': 0.5173745, 'binary_recall': 0.6203704, 'binary_specificity': 0.4212963, 'binary_f1_score': 0.56421053}
confusion matrix:
    0    1
0  91  125
1  82  134
better model found
persisted
after epoch: 10,now: 2024-07-23 01:29:01.698694,epoch time: 0:01:18.952511,used: 0:12:49.084116,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_01_16_12_seed_2_22769259
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.75458115, 'precision': 0.75463855, 'recall': 0.75463283, 'specificity': 0.75463283, 'f1': 0.75458103, 'auroc': 0.83231246, 'binary_precision': 0.7608983, 'binary_recall': 0.74805194, 'binary_specificity': 0.7612137, 'binary_f1_score': 0.75442046}
confusion matrix:
      0     1
0  1154   362
1   388  1152
---- Validation: 
scalar performance:
{'acc': 0.69796556, 'precision': 0.69790745, 'recall': 0.6980433, 'specificity': 0.6980433, 'f1': 0.6978916, 'auroc': 0.75205374, 'binary_precision': 0.6855346, 'binary_recall': 0.7009646, 'binary_specificity': 0.69512194, 'binary_f1_score': 0.6931638}
confusion matrix:
     0    1
0  456  200
1  186  436
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5462963, 'precision': 0.5491445, 'recall': 0.5462963, 'specificity': 0.5462963, 'f1': 0.53962594, 'auroc': 0.5436171, 'binary_precision': 0.53731346, 'binary_recall': 0.6666667, 'binary_specificity': 0.42592594, 'binary_f1_score': 0.59504133}
confusion matrix:
    0    1
0  92  124
1  72  144
new oracle model saved
better model found
persisted
after epoch: 11,now: 2024-07-23 01:30:22.757789,epoch time: 0:01:21.059095,used: 0:14:10.143211,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_01_16_12_seed_2_22769259
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.7621073, 'precision': 0.7621448, 'recall': 0.7620387, 'specificity': 0.7620387, 'f1': 0.76205575, 'auroc': 0.83641624, 'binary_precision': 0.76041, 'binary_recall': 0.7707792, 'binary_specificity': 0.75329816, 'binary_f1_score': 0.7655595}
confusion matrix:
      0     1
0  1142   374
1   353  1187
---- Validation: 
scalar performance:
{'acc': 0.69561815, 'precision': 0.6960037, 'recall': 0.6960484, 'specificity': 0.6960484, 'f1': 0.6956165, 'auroc': 0.75680095, 'binary_precision': 0.6784074, 'binary_recall': 0.71221864, 'binary_specificity': 0.67987806, 'binary_f1_score': 0.694902}
confusion matrix:
     0    1
0  446  210
1  179  443
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5601852, 'precision': 0.5655891, 'recall': 0.5601852, 'specificity': 0.5601852, 'f1': 0.5509355, 'auroc': 0.56057096, 'binary_precision': 0.5467626, 'binary_recall': 0.7037037, 'binary_specificity': 0.41666666, 'binary_f1_score': 0.6153846}
confusion matrix:
    0    1
0  90  126
1  64  152
new oracle model saved
early stop counter: 1
val acc:0.6956181526184082, best validation acc: 0.6979655623435974, corresponding to test acc:                         0.5462962985038757 / 0.5601851940155029
after epoch: 12,now: 2024-07-23 01:31:42.832853,epoch time: 0:01:20.075064,used: 0:15:30.218275,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_01_16_12_seed_2_22769259
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.773233, 'precision': 0.7735859, 'recall': 0.7733655, 'specificity': 0.7733655, 'f1': 0.77320653, 'auroc': 0.8455436, 'binary_precision': 0.7855698, 'binary_recall': 0.7564935, 'binary_specificity': 0.7902375, 'binary_f1_score': 0.77075756}
confusion matrix:
      0     1
0  1198   318
1   375  1165
---- Validation: 
scalar performance:
{'acc': 0.7065728, 'precision': 0.7064243, 'recall': 0.7060525, 'specificity': 0.7060525, 'f1': 0.70614076, 'auroc': 0.75947475, 'binary_precision': 0.7034596, 'binary_recall': 0.6864952, 'binary_specificity': 0.7256098, 'binary_f1_score': 0.69487387}
confusion matrix:
     0    1
0  476  180
1  195  427
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5532407, 'precision': 0.5548502, 'recall': 0.5532408, 'specificity': 0.5532408, 'f1': 0.5499393, 'auroc': 0.57692474, 'binary_precision': 0.54545456, 'binary_recall': 0.6388889, 'binary_specificity': 0.4675926, 'binary_f1_score': 0.5884862}
confusion matrix:
     0    1
0  101  115
1   78  138
better model found
persisted
after epoch: 13,now: 2024-07-23 01:33:01.335825,epoch time: 0:01:18.502972,used: 0:16:48.721247,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_01_16_12_seed_2_22769259
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.779123, 'precision': 0.78083223, 'recall': 0.7794204, 'specificity': 0.7794204, 'f1': 0.77890027, 'auroc': 0.861185, 'binary_precision': 0.8047921, 'binary_recall': 0.74155843, 'binary_specificity': 0.8172823, 'binary_f1_score': 0.7718824}
confusion matrix:
      0     1
0  1239   277
1   398  1142
---- Validation: 
scalar performance:
{'acc': 0.7089202, 'precision': 0.7094778, 'recall': 0.70783913, 'specificity': 0.70783913, 'f1': 0.7078872, 'auroc': 0.76294756, 'binary_precision': 0.7155172, 'binary_recall': 0.6672026, 'binary_specificity': 0.7484756, 'binary_f1_score': 0.6905158}
confusion matrix:
     0    1
0  491  165
1  207  415
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5648148, 'precision': 0.56526804, 'recall': 0.5648148, 'specificity': 0.5648148, 'f1': 0.56405795, 'auroc': 0.59083503, 'binary_precision': 0.55982906, 'binary_recall': 0.6064815, 'binary_specificity': 0.5231481, 'binary_f1_score': 0.5822222}
confusion matrix:
     0    1
0  113  103
1   85  131
new oracle model saved
better model found
persisted
after epoch: 14,now: 2024-07-23 01:34:20.099133,epoch time: 0:01:18.763308,used: 0:18:07.484555,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_01_16_12_seed_2_22769259
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.783377, 'precision': 0.7848003, 'recall': 0.78364635, 'specificity': 0.78364635, 'f1': 0.78320533, 'auroc': 0.8605031, 'binary_precision': 0.806993, 'binary_recall': 0.74935067, 'binary_specificity': 0.81794196, 'binary_f1_score': 0.77710444}
confusion matrix:
      0     1
0  1240   276
1   386  1154
---- Validation: 
scalar performance:
{'acc': 0.70735526, 'precision': 0.70789945, 'recall': 0.7062731, 'specificity': 0.7062731, 'f1': 0.7063167, 'auroc': 0.7664816, 'binary_precision': 0.7137931, 'binary_recall': 0.6655949, 'binary_specificity': 0.7469512, 'binary_f1_score': 0.68885195}
confusion matrix:
     0    1
0  490  166
1  208  414
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5694444, 'precision': 0.570045, 'recall': 0.5694444, 'specificity': 0.5694444, 'f1': 0.5685196, 'auroc': 0.6044453, 'binary_precision': 0.5635593, 'binary_recall': 0.6157407, 'binary_specificity': 0.5231481, 'binary_f1_score': 0.58849555}
confusion matrix:
     0    1
0  113  103
1   83  133
new oracle model saved
early stop counter: 1
val acc:0.707355260848999, best validation acc: 0.7089201807975769, corresponding to test acc:                         0.5648148059844971 / 0.5694444179534912
after epoch: 15,now: 2024-07-23 01:35:38.753504,epoch time: 0:01:18.654371,used: 0:19:26.138926,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_01_16_12_seed_2_22769259
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.7971204, 'precision': 0.7971158, 'recall': 0.7971336, 'specificity': 0.7971336, 'f1': 0.79711616, 'auroc': 0.87230706, 'binary_precision': 0.8006536, 'binary_recall': 0.79545456, 'binary_specificity': 0.7988127, 'binary_f1_score': 0.7980456}
confusion matrix:
      0     1
0  1211   305
1   315  1225
---- Validation: 
scalar performance:
{'acc': 0.7089202, 'precision': 0.7088864, 'recall': 0.70825577, 'specificity': 0.70825577, 'f1': 0.7083602, 'auroc': 0.7700156, 'binary_precision': 0.7083333, 'binary_recall': 0.68327975, 'binary_specificity': 0.7332317, 'binary_f1_score': 0.695581}
confusion matrix:
     0    1
0  481  175
1  197  425
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5972222, 'precision': 0.6003274, 'recall': 0.5972222, 'specificity': 0.5972222, 'f1': 0.5940814, 'auroc': 0.61608374, 'binary_precision': 0.5826772, 'binary_recall': 0.6851852, 'binary_specificity': 0.5092593, 'binary_f1_score': 0.62978727}
confusion matrix:
     0    1
0  110  106
1   68  148
new oracle model saved
early stop counter: 2
val acc:0.7089201807975769, best validation acc: 0.7089201807975769, corresponding to test acc:                         0.5648148059844971 / 0.5972222089767456
after epoch: 16,now: 2024-07-23 01:36:57.817786,epoch time: 0:01:19.064282,used: 0:20:45.203208,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_01_16_12_seed_2_22769259
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.7967932, 'precision': 0.7968736, 'recall': 0.7968552, 'specificity': 0.7968552, 'f1': 0.7967926, 'auroc': 0.8735955, 'binary_precision': 0.80410326, 'binary_recall': 0.78896105, 'binary_specificity': 0.80474937, 'binary_f1_score': 0.7964602}
confusion matrix:
      0     1
0  1220   296
1   325  1215
---- Validation: 
scalar performance:
{'acc': 0.70422536, 'precision': 0.70452905, 'recall': 0.7032659, 'specificity': 0.7032659, 'f1': 0.7033354, 'auroc': 0.7719296, 'binary_precision': 0.7081911, 'binary_recall': 0.6672026, 'binary_specificity': 0.7393293, 'binary_f1_score': 0.6870861}
confusion matrix:
     0    1
0  485  171
1  207  415
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.599537, 'precision': 0.60067856, 'recall': 0.599537, 'specificity': 0.599537, 'f1': 0.5983987, 'auroc': 0.6278292, 'binary_precision': 0.58995813, 'binary_recall': 0.6527778, 'binary_specificity': 0.5462963, 'binary_f1_score': 0.61978024}
confusion matrix:
     0    1
0  118   98
1   75  141
new oracle model saved
early stop counter: 3
val acc:0.7042253613471985, best validation acc: 0.7089201807975769, corresponding to test acc:                         0.5648148059844971 / 0.5995370149612427
after epoch: 17,now: 2024-07-23 01:38:17.127461,epoch time: 0:01:19.309675,used: 0:22:04.512883,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_01_16_12_seed_2_22769259
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.82002616, 'precision': 0.82067484, 'recall': 0.8202001, 'specificity': 0.8202001, 'f1': 0.8199818, 'auroc': 0.8903097, 'binary_precision': 0.8371935, 'binary_recall': 0.79805195, 'binary_specificity': 0.8423483, 'binary_f1_score': 0.8171543}
confusion matrix:
      0     1
0  1277   239
1   311  1229
---- Validation: 
scalar performance:
{'acc': 0.7112676, 'precision': 0.7122557, 'recall': 0.7100007, 'specificity': 0.7100007, 'f1': 0.70998466, 'auroc': 0.77404225, 'binary_precision': 0.72154117, 'binary_recall': 0.66237944, 'binary_specificity': 0.75762194, 'binary_f1_score': 0.6906957}
confusion matrix:
     0    1
0  497  159
1  210  412
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6064815, 'precision': 0.6074023, 'recall': 0.6064815, 'specificity': 0.6064815, 'f1': 0.60563624, 'auroc': 0.63687414, 'binary_precision': 0.59745765, 'binary_recall': 0.6527778, 'binary_specificity': 0.5601852, 'binary_f1_score': 0.6238938}
confusion matrix:
     0    1
0  121   95
1   75  141
new oracle model saved
better model found
persisted
after epoch: 18,now: 2024-07-23 01:39:36.028219,epoch time: 0:01:18.900758,used: 0:23:23.413641,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_01_16_12_seed_2_22769259
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.8183901, 'precision': 0.81890994, 'recall': 0.81854594, 'specificity': 0.81854594, 'f1': 0.8183574, 'auroc': 0.8929441, 'binary_precision': 0.8338983, 'binary_recall': 0.7987013, 'binary_specificity': 0.8383905, 'binary_f1_score': 0.8159204}
confusion matrix:
      0     1
0  1271   245
1   310  1230
---- Validation: 
scalar performance:
{'acc': 0.713615, 'precision': 0.71501577, 'recall': 0.712204, 'specificity': 0.712204, 'f1': 0.7121232, 'auroc': 0.7760862, 'binary_precision': 0.72695035, 'binary_recall': 0.659164, 'binary_specificity': 0.7652439, 'binary_f1_score': 0.6913997}
confusion matrix:
     0    1
0  502  154
1  212  410
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6180556, 'precision': 0.61879134, 'recall': 0.6180556, 'specificity': 0.6180556, 'f1': 0.6174632, 'auroc': 0.6477409, 'binary_precision': 0.60944206, 'binary_recall': 0.6574074, 'binary_specificity': 0.5787037, 'binary_f1_score': 0.6325167}
confusion matrix:
     0    1
0  125   91
1   74  142
new oracle model saved
better model found
persisted
after epoch: 19,now: 2024-07-23 01:40:55.620265,epoch time: 0:01:19.592046,used: 0:24:43.005687,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_01_16_12_seed_2_22769259
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.8167539, 'precision': 0.8168596, 'recall': 0.81682485, 'specificity': 0.81682485, 'f1': 0.8167527, 'auroc': 0.8930233, 'binary_precision': 0.8249337, 'binary_recall': 0.8077922, 'binary_specificity': 0.8258575, 'binary_f1_score': 0.8162729}
confusion matrix:
      0     1
0  1252   264
1   296  1244
---- Validation: 
scalar performance:
{'acc': 0.71283257, 'precision': 0.7137388, 'recall': 0.7116084, 'specificity': 0.7116084, 'f1': 0.71161616, 'auroc': 0.77911043, 'binary_precision': 0.7225131, 'binary_recall': 0.6655949, 'binary_specificity': 0.75762194, 'binary_f1_score': 0.692887}
confusion matrix:
     0    1
0  497  159
1  208  414
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6342593, 'precision': 0.63623315, 'recall': 0.6342592, 'specificity': 0.6342592, 'f1': 0.6329297, 'auroc': 0.65770745, 'binary_precision': 0.6198347, 'binary_recall': 0.6944444, 'binary_specificity': 0.5740741, 'binary_f1_score': 0.65502185}
confusion matrix:
     0    1
0  124   92
1   66  150
new oracle model saved
early stop counter: 1
val acc:0.7128325700759888, best validation acc: 0.7136150002479553, corresponding to test acc:                         0.6180555820465088 / 0.6342592835426331
after epoch: 20,now: 2024-07-23 01:42:11.942640,epoch time: 0:01:16.322375,used: 0:25:59.328062,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_01_16_12_seed_2_22769259
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.825589, 'precision': 0.826432, 'recall': 0.8257864, 'specificity': 0.8257864, 'f1': 0.82552826, 'auroc': 0.9008361, 'binary_precision': 0.8450994, 'binary_recall': 0.80064934, 'binary_specificity': 0.8509235, 'binary_f1_score': 0.8222741}
confusion matrix:
      0     1
0  1290   226
1   307  1233
---- Validation: 
scalar performance:
{'acc': 0.71283257, 'precision': 0.7149355, 'recall': 0.7111918, 'specificity': 0.7111918, 'f1': 0.710955, 'auroc': 0.7802427, 'binary_precision': 0.7305606, 'binary_recall': 0.64951766, 'binary_specificity': 0.77286583, 'binary_f1_score': 0.68765956}
confusion matrix:
     0    1
0  507  149
1  218  404
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6319444, 'precision': 0.63258386, 'recall': 0.6319444, 'specificity': 0.6319444, 'f1': 0.6315002, 'auroc': 0.66595936, 'binary_precision': 0.6233766, 'binary_recall': 0.6666667, 'binary_specificity': 0.5972222, 'binary_f1_score': 0.6442953}
confusion matrix:
     0    1
0  129   87
1   72  144
early stop counter: 2
val acc:0.7128325700759888, best validation acc: 0.7136150002479553, corresponding to test acc:                         0.6180555820465088 / 0.6342592835426331
after epoch: 21,now: 2024-07-23 01:43:31.136593,epoch time: 0:01:19.193953,used: 0:27:18.522015,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_01_16_12_seed_2_22769259
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.8268979, 'precision': 0.8272389, 'recall': 0.82702345, 'specificity': 0.82702345, 'f1': 0.8268823, 'auroc': 0.89990366, 'binary_precision': 0.8399462, 'binary_recall': 0.811039, 'binary_specificity': 0.8430079, 'binary_f1_score': 0.8252395}
confusion matrix:
      0     1
0  1278   238
1   291  1249
---- Validation: 
scalar performance:
{'acc': 0.71283257, 'precision': 0.71440345, 'recall': 0.7113584, 'specificity': 0.7113584, 'f1': 0.71123695, 'auroc': 0.7827744, 'binary_precision': 0.72727275, 'binary_recall': 0.6559486, 'binary_specificity': 0.7667683, 'binary_f1_score': 0.6897718}
confusion matrix:
     0    1
0  503  153
1  214  408
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6365741, 'precision': 0.6374253, 'recall': 0.63657403, 'specificity': 0.63657403, 'f1': 0.6360104, 'auroc': 0.673954, 'binary_precision': 0.62660944, 'binary_recall': 0.6759259, 'binary_specificity': 0.5972222, 'binary_f1_score': 0.65033406}
confusion matrix:
     0    1
0  129   87
1   70  146
new oracle model saved
early stop counter: 3
val acc:0.7128325700759888, best validation acc: 0.7136150002479553, corresponding to test acc:                         0.6180555820465088 / 0.6365740895271301
after epoch: 22,now: 2024-07-23 01:44:50.192370,epoch time: 0:01:19.055777,used: 0:28:37.577792,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_01_16_12_seed_2_22769259
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.83278793, 'precision': 0.8330281, 'recall': 0.8328933, 'specificity': 0.8328933, 'f1': 0.8327801, 'auroc': 0.90636456, 'binary_precision': 0.84414715, 'binary_recall': 0.81948054, 'binary_specificity': 0.8463061, 'binary_f1_score': 0.831631}
confusion matrix:
      0     1
0  1283   233
1   278  1262
---- Validation: 
scalar performance:
{'acc': 0.71518, 'precision': 0.7178587, 'recall': 0.713395, 'specificity': 0.713395, 'f1': 0.7130542, 'auroc': 0.7845659, 'binary_precision': 0.73626375, 'binary_recall': 0.6463022, 'binary_specificity': 0.7804878, 'binary_f1_score': 0.68835616}
confusion matrix:
     0    1
0  512  144
1  220  402
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6388889, 'precision': 0.6393189, 'recall': 0.6388889, 'specificity': 0.6388889, 'f1': 0.63861, 'auroc': 0.6819701, 'binary_precision': 0.6315789, 'binary_recall': 0.6666667, 'binary_specificity': 0.6111111, 'binary_f1_score': 0.6486486}
confusion matrix:
     0    1
0  132   84
1   72  144
new oracle model saved
better model found
persisted
after epoch: 23,now: 2024-07-23 01:46:09.420965,epoch time: 0:01:19.228595,used: 0:29:56.806387,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_01_16_12_seed_2_22769259
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.841623, 'precision': 0.84187967, 'recall': 0.8417315, 'specificity': 0.8417315, 'f1': 0.84161484, 'auroc': 0.91628945, 'binary_precision': 0.85341364, 'binary_recall': 0.8279221, 'binary_specificity': 0.8555409, 'binary_f1_score': 0.84047467}
confusion matrix:
      0     1
0  1297   219
1   265  1275
---- Validation: 
scalar performance:
{'acc': 0.71518, 'precision': 0.7178587, 'recall': 0.713395, 'specificity': 0.713395, 'f1': 0.7130542, 'auroc': 0.7866442, 'binary_precision': 0.73626375, 'binary_recall': 0.6463022, 'binary_specificity': 0.7804878, 'binary_f1_score': 0.68835616}
confusion matrix:
     0    1
0  512  144
1  220  402
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6481481, 'precision': 0.64835167, 'recall': 0.6481482, 'specificity': 0.6481482, 'f1': 0.6480274, 'auroc': 0.6885931, 'binary_precision': 0.64285713, 'binary_recall': 0.6666667, 'binary_specificity': 0.6296296, 'binary_f1_score': 0.6545454}
confusion matrix:
     0    1
0  136   80
1   72  144
new oracle model saved
early stop counter: 1
val acc:0.715179979801178, best validation acc: 0.715179979801178, corresponding to test acc:                         0.6388888955116272 / 0.6481481194496155
after epoch: 24,now: 2024-07-23 01:47:28.401377,epoch time: 0:01:18.980412,used: 0:31:15.786799,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_01_16_12_seed_2_22769259
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.838678, 'precision': 0.84000385, 'recall': 0.8389225, 'specificity': 0.8389225, 'f1': 0.8385807, 'auroc': 0.9120344, 'binary_precision': 0.86328936, 'binary_recall': 0.8077922, 'binary_specificity': 0.87005275, 'binary_f1_score': 0.8346192}
confusion matrix:
      0     1
0  1319   197
1   296  1244
---- Validation: 
scalar performance:
{'acc': 0.7167449, 'precision': 0.72051316, 'recall': 0.71471107, 'specificity': 0.71471107, 'f1': 0.7141398, 'auroc': 0.78884745, 'binary_precision': 0.7434457, 'binary_recall': 0.63826364, 'binary_specificity': 0.79115856, 'binary_f1_score': 0.6868512}
confusion matrix:
     0    1
0  519  137
1  225  397
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.650463, 'precision': 0.65054363, 'recall': 0.650463, 'specificity': 0.650463, 'f1': 0.65041614, 'auroc': 0.69630915, 'binary_precision': 0.64705884, 'binary_recall': 0.662037, 'binary_specificity': 0.6388889, 'binary_f1_score': 0.6544623}
confusion matrix:
     0    1
0  138   78
1   73  143
new oracle model saved
better model found
persisted
after epoch: 25,now: 2024-07-23 01:48:47.006878,epoch time: 0:01:18.605501,used: 0:32:34.392300,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_01_16_12_seed_2_22769259
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.84816754, 'precision': 0.8493844, 'recall': 0.84839976, 'specificity': 0.84839976, 'f1': 0.8480878, 'auroc': 0.92031085, 'binary_precision': 0.87206084, 'binary_recall': 0.81883115, 'binary_specificity': 0.8779683, 'binary_f1_score': 0.8446081}
confusion matrix:
      0     1
0  1331   185
1   279  1261
---- Validation: 
scalar performance:
{'acc': 0.7183099, 'precision': 0.722929, 'recall': 0.71611047, 'specificity': 0.71611047, 'f1': 0.7153647, 'auroc': 0.7899895, 'binary_precision': 0.7490494, 'binary_recall': 0.6334405, 'binary_specificity': 0.7987805, 'binary_f1_score': 0.68641114}
confusion matrix:
     0    1
0  524  132
1  228  394
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6574074, 'precision': 0.6574074, 'recall': 0.6574074, 'specificity': 0.6574074, 'f1': 0.6574074, 'auroc': 0.70231056, 'binary_precision': 0.6574074, 'binary_recall': 0.6574074, 'binary_specificity': 0.6574074, 'binary_f1_score': 0.6574074}
confusion matrix:
     0    1
0  142   74
1   74  142
new oracle model saved
better model found
persisted
after epoch: 26,now: 2024-07-23 01:50:05.582197,epoch time: 0:01:18.575319,used: 0:33:52.967619,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_01_16_12_seed_2_22769259
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.83802354, 'precision': 0.8380584, 'recall': 0.83806753, 'specificity': 0.83806753, 'f1': 0.8380234, 'auroc': 0.91312146, 'binary_precision': 0.8439763, 'binary_recall': 0.83246756, 'binary_specificity': 0.84366757, 'binary_f1_score': 0.83818245}
confusion matrix:
      0     1
0  1279   237
1   258  1282
---- Validation: 
scalar performance:
{'acc': 0.7237872, 'precision': 0.7264049, 'recall': 0.7220708, 'specificity': 0.7220708, 'f1': 0.7218373, 'auroc': 0.79291576, 'binary_precision': 0.7449909, 'binary_recall': 0.6575563, 'binary_specificity': 0.7865854, 'binary_f1_score': 0.69854826}
confusion matrix:
     0    1
0  516  140
1  213  409
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6666667, 'precision': 0.66841376, 'recall': 0.6666666, 'specificity': 0.6666666, 'f1': 0.6658, 'auroc': 0.70936215, 'binary_precision': 0.6512605, 'binary_recall': 0.7175926, 'binary_specificity': 0.6157407, 'binary_f1_score': 0.6828194}
confusion matrix:
     0    1
0  133   83
1   61  155
new oracle model saved
better model found
persisted
after epoch: 27,now: 2024-07-23 01:51:24.554631,epoch time: 0:01:18.972434,used: 0:35:11.940053,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_01_16_12_seed_2_22769259
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.8439136, 'precision': 0.84390724, 'recall': 0.84392715, 'specificity': 0.84392715, 'f1': 0.84390986, 'auroc': 0.9179878, 'binary_precision': 0.84715873, 'binary_recall': 0.8422078, 'binary_specificity': 0.84564644, 'binary_f1_score': 0.84467596}
confusion matrix:
      0     1
0  1282   234
1   243  1297
---- Validation: 
scalar performance:
{'acc': 0.7230047, 'precision': 0.72675204, 'recall': 0.721017, 'specificity': 0.721017, 'f1': 0.72054076, 'auroc': 0.7938961, 'binary_precision': 0.75, 'binary_recall': 0.6463022, 'binary_specificity': 0.7957317, 'binary_f1_score': 0.6943005}
confusion matrix:
     0    1
0  522  134
1  220  402
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6666667, 'precision': 0.6671827, 'recall': 0.6666666, 'specificity': 0.6666666, 'f1': 0.66640925, 'auroc': 0.7152349, 'binary_precision': 0.65789473, 'binary_recall': 0.6944444, 'binary_specificity': 0.6388889, 'binary_f1_score': 0.6756757}
confusion matrix:
     0    1
0  138   78
1   66  150
early stop counter: 1
val acc:0.7230046987533569, best validation acc: 0.7237871885299683, corresponding to test acc:                         0.6666666865348816 / 0.6666666865348816
after epoch: 28,now: 2024-07-23 01:52:44.812526,epoch time: 0:01:20.257895,used: 0:36:32.197948,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_01_16_12_seed_2_22769259
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.8406414, 'precision': 0.8408387, 'recall': 0.84073687, 'specificity': 0.84073687, 'f1': 0.8406365, 'auroc': 0.9201119, 'binary_precision': 0.85123414, 'binary_recall': 0.82857144, 'binary_specificity': 0.85290235, 'binary_f1_score': 0.83975}
confusion matrix:
      0     1
0  1293   223
1   264  1276
---- Validation: 
scalar performance:
{'acc': 0.7214398, 'precision': 0.7255362, 'recall': 0.7193676, 'specificity': 0.7193676, 'f1': 0.71879244, 'auroc': 0.794722, 'binary_precision': 0.75, 'binary_recall': 0.6414791, 'binary_specificity': 0.7972561, 'binary_f1_score': 0.6915078}
confusion matrix:
     0    1
0  523  133
1  223  399
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6712963, 'precision': 0.6715316, 'recall': 0.6712963, 'specificity': 0.6712963, 'f1': 0.6711836, 'auroc': 0.71960735, 'binary_precision': 0.6651786, 'binary_recall': 0.6898148, 'binary_specificity': 0.6527778, 'binary_f1_score': 0.6772728}
confusion matrix:
     0    1
0  141   75
1   67  149
new oracle model saved
early stop counter: 2
val acc:0.721439778804779, best validation acc: 0.7237871885299683, corresponding to test acc:                         0.6666666865348816 / 0.6712962985038757
after epoch: 29,now: 2024-07-23 01:54:02.635334,epoch time: 0:01:17.822808,used: 0:37:50.020756,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_01_16_12_seed_2_22769259
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.8475131, 'precision': 0.84883916, 'recall': 0.84775555, 'specificity': 0.84775555, 'f1': 0.8474236, 'auroc': 0.9226432, 'binary_precision': 0.87239945, 'binary_recall': 0.8168831, 'binary_specificity': 0.87862796, 'binary_f1_score': 0.843729}
confusion matrix:
      0     1
0  1332   184
1   282  1258
---- Validation: 
scalar performance:
{'acc': 0.728482, 'precision': 0.7375479, 'recall': 0.72564405, 'specificity': 0.72564405, 'f1': 0.7241034, 'auroc': 0.79521704, 'binary_precision': 0.7777778, 'binary_recall': 0.61897105, 'binary_specificity': 0.83231705, 'binary_f1_score': 0.6893465}
confusion matrix:
     0    1
0  546  110
1  237  385
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6782407, 'precision': 0.6793517, 'recall': 0.6782408, 'specificity': 0.6782408, 'f1': 0.67774165, 'auroc': 0.7256944, 'binary_precision': 0.6934673, 'binary_recall': 0.6388889, 'binary_specificity': 0.7175926, 'binary_f1_score': 0.6650602}
confusion matrix:
     0    1
0  155   61
1   78  138
new oracle model saved
better model found
persisted
after epoch: 30,now: 2024-07-23 01:55:21.837787,epoch time: 0:01:19.202453,used: 0:39:09.223209,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_01_16_12_seed_2_22769259
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 0:39:09.223209 at 2024-07-23 01:55:21.837787
persisted model performance metric: 

scalar performance:
{'acc': 0.6782407, 'precision': 0.6793517, 'recall': 0.6782408, 'specificity': 0.6782408, 'f1': 0.67774165, 'auroc': 0.7256944, 'binary_precision': 0.6934673, 'binary_recall': 0.6388889, 'binary_specificity': 0.7175926, 'binary_f1_score': 0.6650602}
confusion matrix:
     0    1
0  155   61
1   78  138
oracle model performance metric: 

scalar performance:
{'acc': 0.6782407, 'precision': 0.6793517, 'recall': 0.6782408, 'specificity': 0.6782408, 'f1': 0.67774165, 'auroc': 0.7256944, 'binary_precision': 0.6934673, 'binary_recall': 0.6388889, 'binary_specificity': 0.7175926, 'binary_f1_score': 0.6650602}
confusion matrix:
     0    1
0  155   61
1   78  138
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_dial_lr1e5_bs16_allfreeze_2024-07-22_23-46-53/rule_results/2.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_dial_lr1e5_bs16_allfreeze_2024-07-22_23-46-53/confusion_matrix/2.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 189876 KiB | 460555 KiB | 118645 GiB | 118645 GiB |
|       from large pool | 173494 KiB | 428048 KiB | 116197 GiB | 116197 GiB |
|       from small pool |  16382 KiB |  37418 KiB |   2447 GiB |   2447 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 189876 KiB | 460555 KiB | 118645 GiB | 118645 GiB |
|       from large pool | 173494 KiB | 428048 KiB | 116197 GiB | 116197 GiB |
|       from small pool |  16382 KiB |  37418 KiB |   2447 GiB |   2447 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 189010 KiB | 457292 KiB | 118638 GiB | 118638 GiB |
|       from large pool | 172814 KiB | 424940 KiB | 116195 GiB | 116194 GiB |
|       from small pool |  16196 KiB |  37230 KiB |   2443 GiB |   2443 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 526336 KiB | 530432 KiB |   1088 MiB | 587776 KiB |
|       from large pool | 487424 KiB | 487424 KiB |   1014 MiB | 550912 KiB |
|       from small pool |  38912 KiB |  43008 KiB |     74 MiB |  36864 KiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  37451 KiB |  84605 KiB |  66958 GiB |  66958 GiB |
|       from large pool |  31306 KiB |  79555 KiB |  64448 GiB |  64448 GiB |
|       from small pool |   6145 KiB |  11196 KiB |   2510 GiB |   2510 GiB |
|---------------------------------------------------------------------------|
| Allocations           |     776    |    1159    |   25632 K  |   25631 K  |
|       from large pool |      76    |     158    |   11465 K  |   11465 K  |
|       from small pool |     700    |    1008    |   14166 K  |   14165 K  |
|---------------------------------------------------------------------------|
| Active allocs         |     776    |    1159    |   25632 K  |   25631 K  |
|       from large pool |      76    |     158    |   11465 K  |   11465 K  |
|       from small pool |     700    |    1008    |   14166 K  |   14165 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      41    |      43    |      82    |      41    |
|       from large pool |      22    |      22    |      45    |      23    |
|       from small pool |      19    |      21    |      37    |      18    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      40    |     216    |   15265 K  |   15265 K  |
|       from large pool |      10    |      22    |    6801 K  |    6801 K  |
|       from small pool |      30    |     207    |    8463 K  |    8463 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  17088 KiB | 460555 KiB | 118645 GiB | 118645 GiB |
|       from large pool |  17088 KiB | 428048 KiB | 116197 GiB | 116197 GiB |
|       from small pool |      0 KiB |  37418 KiB |   2447 GiB |   2447 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  17088 KiB | 460555 KiB | 118645 GiB | 118645 GiB |
|       from large pool |  17088 KiB | 428048 KiB | 116197 GiB | 116197 GiB |
|       from small pool |      0 KiB |  37418 KiB |   2447 GiB |   2447 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB | 457292 KiB | 118638 GiB | 118638 GiB |
|       from large pool |  16640 KiB | 424940 KiB | 116195 GiB | 116195 GiB |
|       from small pool |      0 KiB |  37230 KiB |   2443 GiB |   2443 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 227328 KiB | 530432 KiB |   1088 MiB |    866 MiB |
|       from large pool | 204800 KiB | 487424 KiB |   1014 MiB |    814 MiB |
|       from small pool |  22528 KiB |  43008 KiB |     74 MiB |     52 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  23872 KiB |  84605 KiB |  66958 GiB |  66958 GiB |
|       from large pool |  23872 KiB |  79555 KiB |  64448 GiB |  64448 GiB |
|       from small pool |      0 KiB |  11196 KiB |   2510 GiB |   2510 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    1159    |   25632 K  |   25632 K  |
|       from large pool |       2    |     158    |   11465 K  |   11465 K  |
|       from small pool |       0    |    1008    |   14166 K  |   14166 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    1159    |   25632 K  |   25632 K  |
|       from large pool |       2    |     158    |   11465 K  |   11465 K  |
|       from small pool |       0    |    1008    |   14166 K  |   14166 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      21    |      43    |      82    |      61    |
|       from large pool |      10    |      22    |      45    |      35    |
|       from small pool |      11    |      21    |      37    |      26    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     216    |   15265 K  |   15265 K  |
|       from large pool |       3    |      22    |    6801 K  |    6801 K  |
|       from small pool |       0    |     207    |    8463 K  |    8463 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Tue Jul 23 01:56:18 2024]
Finished job 0.
1 of 1 steps (100%) done
