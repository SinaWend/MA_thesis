Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Tue Jul 23 00:57:28 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_dial_lr1e5_bs16_allfreeze_2024-07-22_23-46-53/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_dial_lr1e5_bs16_allfreeze_2024-07-22_23-46-53/rule_results/6.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=6
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/swiglu_ffn.py:51: UserWarning: xFormers is not available (SwiGLU)
  warnings.warn("xFormers is not available (SwiGLU)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/attention.py:33: UserWarning: xFormers is not available (Attention)
  warnings.warn("xFormers is not available (Attention)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/block.py:40: UserWarning: xFormers is not available (Block)
  warnings.warn("xFormers is not available (Block)")
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'888c1ef2'
model name: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_01_00_38_seed_0_22769261

 Experiment start at: 2024-07-23 01:00:38.061851
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
before training, model accuracy: 0.569767415523529
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.585612, 'precision': 0.58596927, 'recall': 0.5848931, 'specificity': 0.5848931, 'f1': 0.5839699, 'auroc': 0.63432753, 'binary_precision': 0.58279693, 'binary_recall': 0.6401028, 'binary_specificity': 0.52968335, 'binary_f1_score': 0.6101072}
confusion matrix:
     0    1
0  803  713
1  560  996
---- Validation: 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
scalar performance:
{'acc': 0.6948758, 'precision': 0.6948467, 'recall': 0.6946968, 'specificity': 0.6946968, 'f1': 0.69472104, 'auroc': 0.7493603, 'binary_precision': 0.69391024, 'binary_recall': 0.6818898, 'binary_specificity': 0.70750386, 'binary_f1_score': 0.6878475}
confusion matrix:
     0    1
0  462  191
1  202  433
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.66976744, 'precision': 0.6707128, 'recall': 0.6697675, 'specificity': 0.6697675, 'f1': 0.6693096, 'auroc': 0.72765815, 'binary_precision': 0.6834171, 'binary_recall': 0.63255817, 'binary_specificity': 0.7069768, 'binary_f1_score': 0.65700483}
confusion matrix:
     0    1
0  152   63
1   79  136
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-23 01:03:22.477550,epoch time: 0:02:44.415699,used: 0:02:44.415699,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_01_00_38_seed_0_22769261
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.7294922, 'precision': 0.7297163, 'recall': 0.7291968, 'specificity': 0.7291968, 'f1': 0.7292223, 'auroc': 0.79710877, 'binary_precision': 0.7251861, 'binary_recall': 0.7508028, 'binary_specificity': 0.70759076, 'binary_f1_score': 0.7377722}
confusion matrix:
      0     1
0  1072   443
1   388  1169
---- Validation: 
scalar performance:
{'acc': 0.7158385, 'precision': 0.7168232, 'recall': 0.7152838, 'specificity': 0.7152838, 'f1': 0.7151351, 'auroc': 0.7784182, 'binary_precision': 0.72835314, 'binary_recall': 0.6755906, 'binary_specificity': 0.75497705, 'binary_f1_score': 0.70098037}
confusion matrix:
     0    1
0  493  160
1  206  429
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6883721, 'precision': 0.690749, 'recall': 0.68837214, 'specificity': 0.68837214, 'f1': 0.6873983, 'auroc': 0.768026, 'binary_precision': 0.7120419, 'binary_recall': 0.63255817, 'binary_specificity': 0.74418604, 'binary_f1_score': 0.6699508}
confusion matrix:
     0    1
0  160   55
1   79  136
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-07-23 01:05:33.475010,epoch time: 0:02:10.997460,used: 0:04:55.413159,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_01_00_38_seed_0_22769261
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.7753906, 'precision': 0.77699494, 'recall': 0.7758395, 'specificity': 0.7758395, 'f1': 0.77523047, 'auroc': 0.84591055, 'binary_precision': 0.80139375, 'binary_recall': 0.7395498, 'binary_specificity': 0.8121292, 'binary_f1_score': 0.7692308}
confusion matrix:
      0     1
0  1232   285
1   405  1150
---- Validation: 
scalar performance:
{'acc': 0.7259317, 'precision': 0.7296196, 'recall': 0.7249774, 'specificity': 0.7249774, 'f1': 0.724236, 'auroc': 0.7927144, 'binary_precision': 0.7554348, 'binary_recall': 0.6566929, 'binary_specificity': 0.7932619, 'binary_f1_score': 0.7026116}
confusion matrix:
     0    1
0  518  135
1  218  417
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7, 'precision': 0.7083334, 'recall': 0.70000005, 'specificity': 0.70000005, 'f1': 0.69696975, 'auroc': 0.79169285, 'binary_precision': 0.75, 'binary_recall': 0.6, 'binary_specificity': 0.8, 'binary_f1_score': 0.6666667}
confusion matrix:
     0    1
0  172   43
1   86  129
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-07-23 01:07:43.784944,epoch time: 0:02:10.309934,used: 0:07:05.723093,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_01_00_38_seed_0_22769261
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.80338544, 'precision': 0.80352557, 'recall': 0.80317557, 'specificity': 0.80317557, 'f1': 0.803252, 'auroc': 0.88541514, 'binary_precision': 0.7997489, 'binary_recall': 0.8171905, 'binary_specificity': 0.7891606, 'binary_f1_score': 0.80837566}
confusion matrix:
      0     1
0  1194   319
1   285  1274
---- Validation: 
scalar performance:
{'acc': 0.73990685, 'precision': 0.74040025, 'recall': 0.7395196, 'specificity': 0.7395196, 'f1': 0.73952985, 'auroc': 0.8032316, 'binary_precision': 0.74834436, 'binary_recall': 0.711811, 'binary_specificity': 0.7672282, 'binary_f1_score': 0.72962064}
confusion matrix:
     0    1
0  501  152
1  183  452
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.73953485, 'precision': 0.7400542, 'recall': 0.73953485, 'specificity': 0.73953485, 'f1': 0.73939395, 'auroc': 0.8086966, 'binary_precision': 0.7512195, 'binary_recall': 0.7162791, 'binary_specificity': 0.7627907, 'binary_f1_score': 0.7333334}
confusion matrix:
     0    1
0  164   51
1   61  154
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-07-23 01:09:54.135809,epoch time: 0:02:10.350865,used: 0:09:16.073958,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_01_00_38_seed_0_22769261
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.8261719, 'precision': 0.826135, 'recall': 0.8261914, 'specificity': 0.8261914, 'f1': 0.82615054, 'auroc': 0.904364, 'binary_precision': 0.8312864, 'binary_recall': 0.82488775, 'binary_specificity': 0.82749504, 'binary_f1_score': 0.8280747}
confusion matrix:
      0     1
0  1252   261
1   273  1286
---- Validation: 
scalar performance:
{'acc': 0.742236, 'precision': 0.7431118, 'recall': 0.74175155, 'specificity': 0.74175155, 'f1': 0.7417123, 'auroc': 0.81101394, 'binary_precision': 0.75462186, 'binary_recall': 0.7070866, 'binary_specificity': 0.77641654, 'binary_f1_score': 0.7300813}
confusion matrix:
     0    1
0  507  146
1  186  449
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.75116277, 'precision': 0.7514293, 'recall': 0.75116277, 'specificity': 0.75116277, 'f1': 0.75109684, 'auroc': 0.824013, 'binary_precision': 0.75961536, 'binary_recall': 0.7348837, 'binary_specificity': 0.76744187, 'binary_f1_score': 0.7470449}
confusion matrix:
     0    1
0  165   50
1   57  158
new oracle model saved
better model found
persisted
after epoch: 5,now: 2024-07-23 01:12:05.074389,epoch time: 0:02:10.938580,used: 0:11:27.012538,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_01_00_38_seed_0_22769261
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.8277995, 'precision': 0.8280709, 'recall': 0.82801926, 'specificity': 0.82801926, 'f1': 0.8277986, 'auroc': 0.9155996, 'binary_precision': 0.8419655, 'binary_recall': 0.8133419, 'binary_specificity': 0.8426966, 'binary_f1_score': 0.8274062}
confusion matrix:
      0     1
0  1275   238
1   291  1268
---- Validation: 
scalar performance:
{'acc': 0.73680127, 'precision': 0.7384619, 'recall': 0.73615295, 'specificity': 0.73615295, 'f1': 0.73595303, 'auroc': 0.8141732, 'binary_precision': 0.75517243, 'binary_recall': 0.6897638, 'binary_specificity': 0.7825421, 'binary_f1_score': 0.7209876}
confusion matrix:
     0    1
0  511  142
1  197  438
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.75116277, 'precision': 0.75160366, 'recall': 0.75116277, 'specificity': 0.75116277, 'f1': 0.7510537, 'auroc': 0.83195245, 'binary_precision': 0.7621359, 'binary_recall': 0.73023254, 'binary_specificity': 0.772093, 'binary_f1_score': 0.74584323}
confusion matrix:
     0    1
0  166   49
1   58  157
early stop counter: 1
val acc:0.736801266670227, best validation acc: 0.7422360181808472, corresponding to test acc:                         0.7511627674102783 / 0.7511627674102783
after epoch: 6,now: 2024-07-23 01:14:15.615185,epoch time: 0:02:10.540796,used: 0:13:37.553334,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_01_00_38_seed_0_22769261
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.84016925, 'precision': 0.84016585, 'recall': 0.8401245, 'specificity': 0.8401245, 'f1': 0.8401408, 'auroc': 0.9233894, 'binary_precision': 0.8403846, 'binary_recall': 0.8441726, 'binary_specificity': 0.8360764, 'binary_f1_score': 0.84227437}
confusion matrix:
      0     1
0  1270   249
1   242  1311
---- Validation: 
scalar performance:
{'acc': 0.73913044, 'precision': 0.739301, 'recall': 0.7388624, 'specificity': 0.7388624, 'f1': 0.73890316, 'auroc': 0.82039046, 'binary_precision': 0.74308944, 'binary_recall': 0.719685, 'binary_specificity': 0.75803983, 'binary_f1_score': 0.7312}
confusion matrix:
     0    1
0  495  158
1  178  457
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.76976746, 'precision': 0.76977324, 'recall': 0.7697674, 'specificity': 0.7697674, 'f1': 0.7697662, 'auroc': 0.84244454, 'binary_precision': 0.7685185, 'binary_recall': 0.772093, 'binary_specificity': 0.76744187, 'binary_f1_score': 0.7703016}
confusion matrix:
     0    1
0  165   50
1   49  166
new oracle model saved
early stop counter: 2
val acc:0.739130437374115, best validation acc: 0.7422360181808472, corresponding to test acc:                         0.7511627674102783 / 0.7697674632072449
after epoch: 7,now: 2024-07-23 01:16:25.872752,epoch time: 0:02:10.257567,used: 0:15:47.810901,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_01_00_38_seed_0_22769261
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.8486328, 'precision': 0.8486135, 'recall': 0.8485944, 'specificity': 0.8485944, 'f1': 0.8486031, 'auroc': 0.9309864, 'binary_precision': 0.84990376, 'binary_recall': 0.8515424, 'binary_specificity': 0.84564644, 'binary_f1_score': 0.85072225}
confusion matrix:
      0     1
0  1282   234
1   231  1325
---- Validation: 
scalar performance:
{'acc': 0.7445652, 'precision': 0.7447709, 'recall': 0.74428743, 'specificity': 0.74428743, 'f1': 0.7443309, 'auroc': 0.82479656, 'binary_precision': 0.7491857, 'binary_recall': 0.72440946, 'binary_specificity': 0.7641654, 'binary_f1_score': 0.7365893}
confusion matrix:
     0    1
0  499  154
1  175  460
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7767442, 'precision': 0.7767442, 'recall': 0.7767442, 'specificity': 0.7767442, 'f1': 0.7767441, 'auroc': 0.85057867, 'binary_precision': 0.7767442, 'binary_recall': 0.7767442, 'binary_specificity': 0.7767442, 'binary_f1_score': 0.7767441}
confusion matrix:
     0    1
0  167   48
1   48  167
new oracle model saved
better model found
persisted
after epoch: 8,now: 2024-07-23 01:18:36.564851,epoch time: 0:02:10.692099,used: 0:17:58.503000,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_01_00_38_seed_0_22769261
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.851237, 'precision': 0.85159034, 'recall': 0.8514629, 'specificity': 0.8514629, 'f1': 0.8512334, 'auroc': 0.9336763, 'binary_precision': 0.8666667, 'binary_recall': 0.834939, 'binary_specificity': 0.8679868, 'binary_f1_score': 0.850507}
confusion matrix:
      0     1
0  1315   200
1   257  1300
---- Validation: 
scalar performance:
{'acc': 0.7476708, 'precision': 0.7487283, 'recall': 0.74715483, 'specificity': 0.74715483, 'f1': 0.7471036, 'auroc': 0.8280933, 'binary_precision': 0.7618243, 'binary_recall': 0.7102362, 'binary_specificity': 0.78407353, 'binary_f1_score': 0.7351263}
confusion matrix:
     0    1
0  512  141
1  184  451
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7790698, 'precision': 0.77922076, 'recall': 0.7790698, 'specificity': 0.7790698, 'f1': 0.7790399, 'auroc': 0.8573932, 'binary_precision': 0.78571427, 'binary_recall': 0.76744187, 'binary_specificity': 0.7906977, 'binary_f1_score': 0.7764706}
confusion matrix:
     0    1
0  170   45
1   50  165
new oracle model saved
better model found
persisted
after epoch: 9,now: 2024-07-23 01:20:46.602817,epoch time: 0:02:10.037966,used: 0:20:08.540966,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_01_00_38_seed_0_22769261
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.86035156, 'precision': 0.8614662, 'recall': 0.8607394, 'specificity': 0.8607394, 'f1': 0.86031306, 'auroc': 0.94317794, 'binary_precision': 0.8852459, 'binary_recall': 0.8323699, 'binary_specificity': 0.8891089, 'binary_f1_score': 0.857994}
confusion matrix:
      0     1
0  1347   168
1   261  1296
---- Validation: 
scalar performance:
{'acc': 0.74378884, 'precision': 0.7466432, 'recall': 0.74297905, 'specificity': 0.74297905, 'f1': 0.7425872, 'auroc': 0.82861656, 'binary_precision': 0.7699115, 'binary_recall': 0.68503934, 'binary_specificity': 0.8009188, 'binary_f1_score': 0.725}
confusion matrix:
     0    1
0  523  130
1  200  435
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7837209, 'precision': 0.7851087, 'recall': 0.78372097, 'specificity': 0.78372097, 'f1': 0.7834574, 'auroc': 0.8620876, 'binary_precision': 0.805, 'binary_recall': 0.74883723, 'binary_specificity': 0.81860465, 'binary_f1_score': 0.7759036}
confusion matrix:
     0    1
0  176   39
1   54  161
new oracle model saved
early stop counter: 1
val acc:0.7437888383865356, best validation acc: 0.7476708292961121, corresponding to test acc:                         0.7790697813034058 / 0.7837209105491638
after epoch: 10,now: 2024-07-23 01:22:55.328578,epoch time: 0:02:08.725761,used: 0:22:17.266727,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_01_00_38_seed_0_22769261
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.8753255, 'precision': 0.87535536, 'recall': 0.8754071, 'specificity': 0.8754071, 'f1': 0.8753233, 'auroc': 0.951164, 'binary_precision': 0.8830065, 'binary_recall': 0.8688103, 'binary_specificity': 0.88200396, 'binary_f1_score': 0.87585086}
confusion matrix:
      0     1
0  1338   179
1   204  1351
---- Validation: 
scalar performance:
{'acc': 0.753882, 'precision': 0.7545088, 'recall': 0.7534758, 'specificity': 0.7534758, 'f1': 0.75349545, 'auroc': 0.8322268, 'binary_precision': 0.7641196, 'binary_recall': 0.72440946, 'binary_specificity': 0.7825421, 'binary_f1_score': 0.74373484}
confusion matrix:
     0    1
0  511  142
1  175  460
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7976744, 'precision': 0.79768085, 'recall': 0.7976744, 'specificity': 0.7976744, 'f1': 0.79767334, 'auroc': 0.86805844, 'binary_precision': 0.7990654, 'binary_recall': 0.7953488, 'binary_specificity': 0.8, 'binary_f1_score': 0.79720277}
confusion matrix:
     0    1
0  172   43
1   44  171
new oracle model saved
better model found
persisted
after epoch: 11,now: 2024-07-23 01:25:15.311582,epoch time: 0:02:19.983004,used: 0:24:37.249731,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_01_00_38_seed_0_22769261
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.86848956, 'precision': 0.8690443, 'recall': 0.8687677, 'specificity': 0.8687677, 'f1': 0.86848015, 'auroc': 0.9472481, 'binary_precision': 0.8871726, 'binary_recall': 0.84842646, 'binary_specificity': 0.8891089, 'binary_f1_score': 0.867367}
confusion matrix:
      0     1
0  1347   168
1   236  1321
---- Validation: 
scalar performance:
{'acc': 0.7531056, 'precision': 0.75436413, 'recall': 0.7525581, 'specificity': 0.7525581, 'f1': 0.75249445, 'auroc': 0.83305156, 'binary_precision': 0.7691002, 'binary_recall': 0.7133858, 'binary_specificity': 0.79173046, 'binary_f1_score': 0.7401961}
confusion matrix:
     0    1
0  517  136
1  182  453
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8, 'precision': 0.80041593, 'recall': 0.8, 'specificity': 0.8, 'f1': 0.7999308, 'auroc': 0.8708707, 'binary_precision': 0.8115942, 'binary_recall': 0.7813954, 'binary_specificity': 0.81860465, 'binary_f1_score': 0.79620856}
confusion matrix:
     0    1
0  176   39
1   47  168
new oracle model saved
early stop counter: 1
val acc:0.7531055808067322, best validation acc: 0.7538819909095764, corresponding to test acc:                         0.7976744174957275 / 0.800000011920929
after epoch: 12,now: 2024-07-23 01:27:35.224896,epoch time: 0:02:19.913314,used: 0:26:57.163045,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_01_00_38_seed_0_22769261
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.88378906, 'precision': 0.88446116, 'recall': 0.8840923, 'specificity': 0.8840923, 'f1': 0.88377726, 'auroc': 0.9508592, 'binary_precision': 0.9043127, 'binary_recall': 0.8619139, 'binary_specificity': 0.9062706, 'binary_f1_score': 0.8826044}
confusion matrix:
      0     1
0  1373   142
1   215  1342
---- Validation: 
scalar performance:
{'acc': 0.7523292, 'precision': 0.7541448, 'recall': 0.75168395, 'specificity': 0.75168395, 'f1': 0.751531, 'auroc': 0.8346553, 'binary_precision': 0.7724138, 'binary_recall': 0.7055118, 'binary_specificity': 0.79785603, 'binary_f1_score': 0.7374486}
confusion matrix:
     0    1
0  521  132
1  187  448
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.80697674, 'precision': 0.8077824, 'recall': 0.8069768, 'specificity': 0.8069768, 'f1': 0.8068503, 'auroc': 0.8744835, 'binary_precision': 0.8235294, 'binary_recall': 0.7813954, 'binary_specificity': 0.83255816, 'binary_f1_score': 0.80190927}
confusion matrix:
     0    1
0  179   36
1   47  168
new oracle model saved
early stop counter: 2
val acc:0.7523291707038879, best validation acc: 0.7538819909095764, corresponding to test acc:                         0.7976744174957275 / 0.8069767355918884
after epoch: 13,now: 2024-07-23 01:29:55.556619,epoch time: 0:02:20.331723,used: 0:29:17.494768,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_01_00_38_seed_0_22769261
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.88151044, 'precision': 0.88207734, 'recall': 0.881791, 'specificity': 0.881791, 'f1': 0.8815019, 'auroc': 0.9494467, 'binary_precision': 0.9006044, 'binary_recall': 0.8612717, 'binary_specificity': 0.90231025, 'binary_f1_score': 0.880499}
confusion matrix:
      0     1
0  1367   148
1   216  1341
---- Validation: 
scalar performance:
{'acc': 0.75931674, 'precision': 0.7609966, 'recall': 0.75870544, 'specificity': 0.75870544, 'f1': 0.75860375, 'auroc': 0.8375397, 'binary_precision': 0.7787307, 'binary_recall': 0.71496063, 'binary_specificity': 0.80245024, 'binary_f1_score': 0.7454844}
confusion matrix:
     0    1
0  524  129
1  181  454
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.80930233, 'precision': 0.8102689, 'recall': 0.80930233, 'specificity': 0.80930233, 'f1': 0.80915374, 'auroc': 0.87768525, 'binary_precision': 0.82758623, 'binary_recall': 0.7813954, 'binary_specificity': 0.8372093, 'binary_f1_score': 0.8038278}
confusion matrix:
     0    1
0  180   35
1   47  168
new oracle model saved
better model found
persisted
after epoch: 14,now: 2024-07-23 01:32:15.652223,epoch time: 0:02:20.095604,used: 0:31:37.590372,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_01_00_38_seed_0_22769261
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.8802083, 'precision': 0.880636, 'recall': 0.8804424, 'specificity': 0.8804424, 'f1': 0.88020325, 'auroc': 0.95508707, 'binary_precision': 0.89705884, 'binary_recall': 0.8624679, 'binary_specificity': 0.8984169, 'binary_f1_score': 0.8794233}
confusion matrix:
      0     1
0  1362   154
1   214  1342
---- Validation: 
scalar performance:
{'acc': 0.75931674, 'precision': 0.76019263, 'recall': 0.75885737, 'specificity': 0.75885737, 'f1': 0.75886095, 'auroc': 0.8400526, 'binary_precision': 0.7721943, 'binary_recall': 0.7259843, 'binary_specificity': 0.79173046, 'binary_f1_score': 0.74837667}
confusion matrix:
     0    1
0  517  136
1  174  461
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.80930233, 'precision': 0.8097311, 'recall': 0.80930233, 'specificity': 0.80930233, 'f1': 0.8092363, 'auroc': 0.88121146, 'binary_precision': 0.82125604, 'binary_recall': 0.7906977, 'binary_specificity': 0.82790697, 'binary_f1_score': 0.8056872}
confusion matrix:
     0    1
0  178   37
1   45  170
early stop counter: 1
val acc:0.7593167424201965, best validation acc: 0.7593167424201965, corresponding to test acc:                         0.8093023300170898 / 0.8093023300170898
after epoch: 15,now: 2024-07-23 01:34:32.916914,epoch time: 0:02:17.264691,used: 0:33:54.855063,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_01_00_38_seed_0_22769261
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.8889974, 'precision': 0.8894395, 'recall': 0.88924813, 'specificity': 0.88924813, 'f1': 0.88899314, 'auroc': 0.9580288, 'binary_precision': 0.90641713, 'binary_recall': 0.8709056, 'binary_specificity': 0.90759075, 'binary_f1_score': 0.88830656}
confusion matrix:
      0     1
0  1375   140
1   201  1356
---- Validation: 
scalar performance:
{'acc': 0.76086956, 'precision': 0.76156914, 'recall': 0.7604539, 'specificity': 0.7604539, 'f1': 0.7604792, 'auroc': 0.84190226, 'binary_precision': 0.77204657, 'binary_recall': 0.73070866, 'binary_specificity': 0.7901991, 'binary_f1_score': 0.7508091}
confusion matrix:
     0    1
0  516  137
1  171  464
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.80697674, 'precision': 0.8075156, 'recall': 0.80697674, 'specificity': 0.80697674, 'f1': 0.8068922, 'auroc': 0.8840238, 'binary_precision': 0.8203884, 'binary_recall': 0.7860465, 'binary_specificity': 0.82790697, 'binary_f1_score': 0.8028504}
confusion matrix:
     0    1
0  178   37
1   46  169
better model found
persisted
after epoch: 16,now: 2024-07-23 01:36:51.066539,epoch time: 0:02:18.149625,used: 0:36:13.004688,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_01_00_38_seed_0_22769261
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.8902995, 'precision': 0.8906278, 'recall': 0.89049613, 'specificity': 0.89049613, 'f1': 0.8902969, 'auroc': 0.95954806, 'binary_precision': 0.9054594, 'binary_recall': 0.8745981, 'binary_specificity': 0.9063942, 'binary_f1_score': 0.8897612}
confusion matrix:
      0     1
0  1375   142
1   195  1360
---- Validation: 
scalar performance:
{'acc': 0.7569876, 'precision': 0.75699306, 'recall': 0.75684243, 'specificity': 0.75684243, 'f1': 0.75688076, 'auroc': 0.8434217, 'binary_precision': 0.7571885, 'binary_recall': 0.7464567, 'binary_specificity': 0.7672282, 'binary_f1_score': 0.7517843}
confusion matrix:
     0    1
0  501  152
1  161  474
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8116279, 'precision': 0.81168854, 'recall': 0.81162786, 'specificity': 0.81162786, 'f1': 0.8116187, 'auroc': 0.8866631, 'binary_precision': 0.8160377, 'binary_recall': 0.80465114, 'binary_specificity': 0.81860465, 'binary_f1_score': 0.8103044}
confusion matrix:
     0    1
0  176   39
1   42  173
new oracle model saved
early stop counter: 1
val acc:0.7569875717163086, best validation acc: 0.760869562625885, corresponding to test acc:                         0.8069767355918884 / 0.8116279244422913
after epoch: 17,now: 2024-07-23 01:39:08.678272,epoch time: 0:02:17.611733,used: 0:38:30.616421,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_01_00_38_seed_0_22769261
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.8889974, 'precision': 0.88984764, 'recall': 0.8893523, 'specificity': 0.8893523, 'f1': 0.88898134, 'auroc': 0.9627287, 'binary_precision': 0.9119837, 'binary_recall': 0.86456996, 'binary_specificity': 0.91413474, 'binary_f1_score': 0.8876442}
confusion matrix:
      0     1
0  1384   130
1   211  1347
---- Validation: 
scalar performance:
{'acc': 0.761646, 'precision': 0.7626869, 'recall': 0.7611545, 'specificity': 0.7611545, 'f1': 0.76114476, 'auroc': 0.8423629, 'binary_precision': 0.77609426, 'binary_recall': 0.7259843, 'binary_specificity': 0.7963247, 'binary_f1_score': 0.75020343}
confusion matrix:
     0    1
0  520  133
1  174  461
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8116279, 'precision': 0.8121749, 'recall': 0.8116279, 'specificity': 0.8116279, 'f1': 0.8115454, 'auroc': 0.8881991, 'binary_precision': 0.8252427, 'binary_recall': 0.7906977, 'binary_specificity': 0.83255816, 'binary_f1_score': 0.807601}
confusion matrix:
     0    1
0  179   36
1   45  170
better model found
persisted
after epoch: 18,now: 2024-07-23 01:41:24.897586,epoch time: 0:02:16.219314,used: 0:40:46.835735,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_01_00_38_seed_0_22769261
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.8876953, 'precision': 0.8894867, 'recall': 0.8881992, 'specificity': 0.8881992, 'f1': 0.88763857, 'auroc': 0.95793056, 'binary_precision': 0.9197232, 'binary_recall': 0.8530167, 'binary_specificity': 0.92338175, 'binary_f1_score': 0.88511485}
confusion matrix:
      0     1
0  1398   116
1   229  1329
---- Validation: 
scalar performance:
{'acc': 0.76475155, 'precision': 0.7669904, 'recall': 0.76406527, 'specificity': 0.76406527, 'f1': 0.7639078, 'auroc': 0.84387505, 'binary_precision': 0.7881944, 'binary_recall': 0.71496063, 'binary_specificity': 0.81316996, 'binary_f1_score': 0.7497936}
confusion matrix:
     0    1
0  531  122
1  181  454
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.81627905, 'precision': 0.8171091, 'recall': 0.81627905, 'specificity': 0.81627905, 'f1': 0.8161588, 'auroc': 0.89027584, 'binary_precision': 0.8333333, 'binary_recall': 0.7906977, 'binary_specificity': 0.8418605, 'binary_f1_score': 0.81145585}
confusion matrix:
     0    1
0  181   34
1   45  170
new oracle model saved
better model found
persisted
after epoch: 19,now: 2024-07-23 01:43:43.211104,epoch time: 0:02:18.313518,used: 0:43:05.149253,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_01_00_38_seed_0_22769261
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.89746094, 'precision': 0.8975624, 'recall': 0.89759195, 'specificity': 0.89759195, 'f1': 0.8974607, 'auroc': 0.9650502, 'binary_precision': 0.9079553, 'binary_recall': 0.8875321, 'binary_specificity': 0.9076517, 'binary_f1_score': 0.89762753}
confusion matrix:
      0     1
0  1376   140
1   175  1381
---- Validation: 
scalar performance:
{'acc': 0.7663044, 'precision': 0.7665573, 'recall': 0.7660308, 'specificity': 0.7660308, 'f1': 0.7660899, 'auroc': 0.84768784, 'binary_precision': 0.77198696, 'binary_recall': 0.7464567, 'binary_specificity': 0.7856049, 'binary_f1_score': 0.7590073}
confusion matrix:
     0    1
0  513  140
1  161  474
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.81860465, 'precision': 0.81863225, 'recall': 0.81860465, 'specificity': 0.81860465, 'f1': 0.81860065, 'auroc': 0.89393187, 'binary_precision': 0.82159626, 'binary_recall': 0.81395346, 'binary_specificity': 0.82325584, 'binary_f1_score': 0.81775695}
confusion matrix:
     0    1
0  177   38
1   40  175
new oracle model saved
better model found
persisted
after epoch: 20,now: 2024-07-23 01:46:02.311749,epoch time: 0:02:19.100645,used: 0:45:24.249898,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_01_00_38_seed_0_22769261
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9010417, 'precision': 0.9011053, 'recall': 0.9011706, 'specificity': 0.9011706, 'f1': 0.9010402, 'auroc': 0.9659791, 'binary_precision': 0.9108781, 'binary_recall': 0.8921695, 'binary_specificity': 0.91017175, 'binary_f1_score': 0.90142673}
confusion matrix:
      0     1
0  1378   136
1   168  1390
---- Validation: 
scalar performance:
{'acc': 0.761646, 'precision': 0.7616066, 'recall': 0.7615669, 'specificity': 0.7615669, 'f1': 0.76158255, 'auroc': 0.849118, 'binary_precision': 0.75949365, 'binary_recall': 0.7559055, 'binary_specificity': 0.7672282, 'binary_f1_score': 0.7576953}
confusion matrix:
     0    1
0  501  152
1  155  480
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.82325584, 'precision': 0.8233677, 'recall': 0.8232558, 'specificity': 0.8232558, 'f1': 0.8232405, 'auroc': 0.89654946, 'binary_precision': 0.8173516, 'binary_recall': 0.83255816, 'binary_specificity': 0.81395346, 'binary_f1_score': 0.8248848}
confusion matrix:
     0    1
0  175   40
1   36  179
new oracle model saved
early stop counter: 1
val acc:0.7616459727287292, best validation acc: 0.7663043737411499, corresponding to test acc:                         0.8186046481132507 / 0.8232558369636536
after epoch: 21,now: 2024-07-23 01:48:21.105134,epoch time: 0:02:18.793385,used: 0:47:43.043283,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_01_00_38_seed_0_22769261
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.89453125, 'precision': 0.89512056, 'recall': 0.8948016, 'specificity': 0.8948016, 'f1': 0.89452255, 'auroc': 0.9610721, 'binary_precision': 0.9139785, 'binary_recall': 0.874036, 'binary_specificity': 0.9155673, 'binary_f1_score': 0.8935611}
confusion matrix:
      0     1
0  1388   128
1   196  1360
---- Validation: 
scalar performance:
{'acc': 0.7624224, 'precision': 0.7623774, 'recall': 0.76239765, 'specificity': 0.76239765, 'f1': 0.76238567, 'auroc': 0.85128117, 'binary_precision': 0.7582418, 'binary_recall': 0.7606299, 'binary_specificity': 0.7641654, 'binary_f1_score': 0.7594339}
confusion matrix:
     0    1
0  499  154
1  152  483
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.82790697, 'precision': 0.82836163, 'recall': 0.82790697, 'specificity': 0.82790697, 'f1': 0.82784736, 'auroc': 0.8989724, 'binary_precision': 0.8161435, 'binary_recall': 0.8465116, 'binary_specificity': 0.80930233, 'binary_f1_score': 0.8310502}
confusion matrix:
     0    1
0  174   41
1   33  182
new oracle model saved
early stop counter: 2
val acc:0.7624223828315735, best validation acc: 0.7663043737411499, corresponding to test acc:                         0.8186046481132507 / 0.8279069662094116
after epoch: 22,now: 2024-07-23 01:50:39.349848,epoch time: 0:02:18.244714,used: 0:50:01.287997,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_01_00_38_seed_0_22769261
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.90201825, 'precision': 0.90251356, 'recall': 0.90232503, 'specificity': 0.90232503, 'f1': 0.9020152, 'auroc': 0.9677011, 'binary_precision': 0.9210702, 'binary_recall': 0.88269234, 'binary_specificity': 0.9219577, 'binary_f1_score': 0.901473}
confusion matrix:
      0     1
0  1394   118
1   183  1377
---- Validation: 
scalar performance:
{'acc': 0.76319873, 'precision': 0.7631526, 'recall': 0.7631633, 'specificity': 0.7631633, 'f1': 0.7631575, 'auroc': 0.85168874, 'binary_precision': 0.759434, 'binary_recall': 0.7606299, 'binary_specificity': 0.76569676, 'binary_f1_score': 0.76003146}
confusion matrix:
     0    1
0  500  153
1  152  483
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.83023256, 'precision': 0.8310993, 'recall': 0.83023256, 'specificity': 0.83023256, 'f1': 0.8301214, 'auroc': 0.9005517, 'binary_precision': 0.8141593, 'binary_recall': 0.855814, 'binary_specificity': 0.80465114, 'binary_f1_score': 0.8344671}
confusion matrix:
     0    1
0  173   42
1   31  184
new oracle model saved
early stop counter: 3
val acc:0.763198733329773, best validation acc: 0.7663043737411499, corresponding to test acc:                         0.8186046481132507 / 0.830232560634613
after epoch: 23,now: 2024-07-23 01:52:57.705162,epoch time: 0:02:18.355314,used: 0:52:19.643311,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_01_00_38_seed_0_22769261
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.90266925, 'precision': 0.9028643, 'recall': 0.90282756, 'specificity': 0.90282756, 'f1': 0.9026691, 'auroc': 0.9654255, 'binary_precision': 0.91534394, 'binary_recall': 0.8900322, 'binary_specificity': 0.91562295, 'binary_f1_score': 0.9025107}
confusion matrix:
      0     1
0  1389   128
1   171  1384
---- Validation: 
scalar performance:
{'acc': 0.7717391, 'precision': 0.77233607, 'recall': 0.7720418, 'specificity': 0.7720418, 'f1': 0.7717122, 'auroc': 0.8526558, 'binary_precision': 0.7556222, 'binary_recall': 0.7937008, 'binary_specificity': 0.75038284, 'binary_f1_score': 0.7741935}
confusion matrix:
     0    1
0  490  163
1  131  504
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.82790697, 'precision': 0.8289317, 'recall': 0.82790697, 'specificity': 0.82790697, 'f1': 0.82777286, 'auroc': 0.9013088, 'binary_precision': 0.8105727, 'binary_recall': 0.855814, 'binary_specificity': 0.8, 'binary_f1_score': 0.8325792}
confusion matrix:
     0    1
0  172   43
1   31  184
better model found
persisted
after epoch: 24,now: 2024-07-23 01:55:16.166803,epoch time: 0:02:18.461641,used: 0:54:38.104952,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_01_00_38_seed_0_22769261
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.898112, 'precision': 0.8987571, 'recall': 0.898409, 'specificity': 0.898409, 'f1': 0.898103, 'auroc': 0.9634488, 'binary_precision': 0.9185734, 'binary_recall': 0.8766859, 'binary_specificity': 0.92013204, 'binary_f1_score': 0.89714104}
confusion matrix:
      0     1
0  1394   121
1   192  1365
---- Validation: 
scalar performance:
{'acc': 0.7748447, 'precision': 0.7752093, 'recall': 0.7745403, 'specificity': 0.7745403, 'f1': 0.77460504, 'auroc': 0.852569, 'binary_precision': 0.7823241, 'binary_recall': 0.7527559, 'binary_specificity': 0.7963247, 'binary_f1_score': 0.76725525}
confusion matrix:
     0    1
0  520  133
1  157  478
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8418605, 'precision': 0.84189004, 'recall': 0.8418604, 'specificity': 0.8418604, 'f1': 0.8418571, 'auroc': 0.9026501, 'binary_precision': 0.8450704, 'binary_recall': 0.8372093, 'binary_specificity': 0.8465116, 'binary_f1_score': 0.8411215}
confusion matrix:
     0    1
0  182   33
1   35  180
new oracle model saved
better model found
persisted
after epoch: 25,now: 2024-07-23 01:57:34.658244,epoch time: 0:02:18.491441,used: 0:56:56.596393,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_01_00_38_seed_0_22769261
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.91048175, 'precision': 0.911196, 'recall': 0.9107761, 'specificity': 0.9107761, 'f1': 0.91047144, 'auroc': 0.9732387, 'binary_precision': 0.9318948, 'binary_recall': 0.88817483, 'binary_specificity': 0.9333773, 'binary_f1_score': 0.9095097}
confusion matrix:
      0     1
0  1415   101
1   174  1382
---- Validation: 
scalar performance:
{'acc': 0.7756211, 'precision': 0.7763407, 'recall': 0.77521914, 'specificity': 0.77521914, 'f1': 0.77526873, 'auroc': 0.85253763, 'binary_precision': 0.7873754, 'binary_recall': 0.7464567, 'binary_specificity': 0.8039816, 'binary_f1_score': 0.76637024}
confusion matrix:
     0    1
0  525  128
1  161  474
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8418605, 'precision': 0.8419788, 'recall': 0.8418605, 'specificity': 0.8418605, 'f1': 0.84184676, 'auroc': 0.90332067, 'binary_precision': 0.8483412, 'binary_recall': 0.83255816, 'binary_specificity': 0.8511628, 'binary_f1_score': 0.8403756}
confusion matrix:
     0    1
0  183   32
1   36  179
better model found
persisted
after epoch: 26,now: 2024-07-23 01:59:53.135170,epoch time: 0:02:18.476926,used: 0:59:15.073319,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_01_00_38_seed_0_22769261
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.9140625, 'precision': 0.9152368, 'recall': 0.9144918, 'specificity': 0.9144918, 'f1': 0.9140432, 'auroc': 0.97236824, 'binary_precision': 0.941377, 'binary_recall': 0.88582426, 'binary_specificity': 0.9431593, 'binary_f1_score': 0.9127561}
confusion matrix:
      0     1
0  1427    86
1   178  1381
---- Validation: 
scalar performance:
{'acc': 0.7670807, 'precision': 0.769425, 'recall': 0.7663841, 'specificity': 0.7663841, 'f1': 0.76622343, 'auroc': 0.8524122, 'binary_precision': 0.79130435, 'binary_recall': 0.71653545, 'binary_specificity': 0.8162328, 'binary_f1_score': 0.75206614}
confusion matrix:
     0    1
0  533  120
1  180  455
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.83255816, 'precision': 0.8335973, 'recall': 0.83255816, 'specificity': 0.83255816, 'f1': 0.8324276, 'auroc': 0.90388316, 'binary_precision': 0.8522167, 'binary_recall': 0.80465114, 'binary_specificity': 0.8604651, 'binary_f1_score': 0.82775116}
confusion matrix:
     0    1
0  185   30
1   42  173
early stop counter: 1
val acc:0.7670807242393494, best validation acc: 0.7756211161613464, corresponding to test acc:                         0.8418604731559753 / 0.8418604731559753
after epoch: 27,now: 2024-07-23 02:02:12.283148,epoch time: 0:02:19.147978,used: 1:01:34.221297,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_01_00_38_seed_0_22769261
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.90527344, 'precision': 0.90589416, 'recall': 0.9055499, 'specificity': 0.9055499, 'f1': 0.905265, 'auroc': 0.96976805, 'binary_precision': 0.92535305, 'binary_recall': 0.88431877, 'binary_specificity': 0.926781, 'binary_f1_score': 0.9043706}
confusion matrix:
      0     1
0  1405   111
1   180  1376
---- Validation: 
scalar performance:
{'acc': 0.7748447, 'precision': 0.7750443, 'recall': 0.77501774, 'specificity': 0.77501774, 'f1': 0.77484417, 'auroc': 0.8549782, 'binary_precision': 0.7633588, 'binary_recall': 0.78740156, 'binary_specificity': 0.762634, 'binary_f1_score': 0.7751938}
confusion matrix:
     0    1
0  498  155
1  135  500
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.83488375, 'precision': 0.8354716, 'recall': 0.8348837, 'specificity': 0.8348837, 'f1': 0.83481133, 'auroc': 0.9060682, 'binary_precision': 0.8214286, 'binary_recall': 0.855814, 'binary_specificity': 0.81395346, 'binary_f1_score': 0.8382688}
confusion matrix:
     0    1
0  175   40
1   31  184
early stop counter: 2
val acc:0.7748447060585022, best validation acc: 0.7756211161613464, corresponding to test acc:                         0.8418604731559753 / 0.8418604731559753
after epoch: 28,now: 2024-07-23 02:04:31.727151,epoch time: 0:02:19.444003,used: 1:03:53.665300,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_01_00_38_seed_0_22769261
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9033203, 'precision': 0.9047893, 'recall': 0.90373206, 'specificity': 0.90373206, 'f1': 0.9032822, 'auroc': 0.969468, 'binary_precision': 0.93264604, 'binary_recall': 0.872108, 'binary_specificity': 0.9353562, 'binary_f1_score': 0.9013617}
confusion matrix:
      0     1
0  1418    98
1   199  1357
---- Validation: 
scalar performance:
{'acc': 0.7740683, 'precision': 0.7740639, 'recall': 0.7739482, 'specificity': 0.7739482, 'f1': 0.77398324, 'auroc': 0.85558593, 'binary_precision': 0.77388537, 'binary_recall': 0.76535434, 'binary_specificity': 0.7825421, 'binary_f1_score': 0.7695963}
confusion matrix:
     0    1
0  511  142
1  149  486
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8395349, 'precision': 0.83954227, 'recall': 0.8395349, 'specificity': 0.8395349, 'f1': 0.83953404, 'auroc': 0.9066955, 'binary_precision': 0.837963, 'binary_recall': 0.8418605, 'binary_specificity': 0.8372093, 'binary_f1_score': 0.8399072}
confusion matrix:
     0    1
0  180   35
1   34  181
early stop counter: 3
val acc:0.774068295955658, best validation acc: 0.7756211161613464, corresponding to test acc:                         0.8418604731559753 / 0.8418604731559753
after epoch: 29,now: 2024-07-23 02:06:52.238508,epoch time: 0:02:20.511357,used: 1:06:14.176657,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_01_00_38_seed_0_22769261
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.9091797, 'precision': 0.91060066, 'recall': 0.9095839, 'specificity': 0.9095839, 'f1': 0.9091462, 'auroc': 0.9723909, 'binary_precision': 0.93822926, 'binary_recall': 0.8785347, 'binary_specificity': 0.94063324, 'binary_f1_score': 0.90740126}
confusion matrix:
      0     1
0  1426    90
1   189  1367
---- Validation: 
scalar performance:
{'acc': 0.77329195, 'precision': 0.7732774, 'recall': 0.7731825, 'specificity': 0.7731825, 'f1': 0.77321315, 'auroc': 0.8562299, 'binary_precision': 0.772655, 'binary_recall': 0.76535434, 'binary_specificity': 0.78101075, 'binary_f1_score': 0.7689873}
confusion matrix:
     0    1
0  510  143
1  149  486
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8395349, 'precision': 0.83954227, 'recall': 0.8395349, 'specificity': 0.8395349, 'f1': 0.83953404, 'auroc': 0.90719306, 'binary_precision': 0.837963, 'binary_recall': 0.8418605, 'binary_specificity': 0.8372093, 'binary_f1_score': 0.8399072}
confusion matrix:
     0    1
0  180   35
1   34  181
early stop counter: 4
val acc:0.7732919454574585, best validation acc: 0.7756211161613464, corresponding to test acc:                         0.8418604731559753 / 0.8418604731559753
after epoch: 30,now: 2024-07-23 02:09:12.443378,epoch time: 0:02:20.204870,used: 1:08:34.381527,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_01_00_38_seed_0_22769261
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 1:08:34.381527 at 2024-07-23 02:09:12.443378
persisted model performance metric: 

scalar performance:
{'acc': 0.8418605, 'precision': 0.8419788, 'recall': 0.8418605, 'specificity': 0.8418605, 'f1': 0.84184676, 'auroc': 0.90332067, 'binary_precision': 0.8483412, 'binary_recall': 0.83255816, 'binary_specificity': 0.8511628, 'binary_f1_score': 0.8403756}
confusion matrix:
     0    1
0  183   32
1   36  179
oracle model performance metric: 

scalar performance:
{'acc': 0.8418605, 'precision': 0.84189004, 'recall': 0.8418604, 'specificity': 0.8418604, 'f1': 0.8418571, 'auroc': 0.9026501, 'binary_precision': 0.8450704, 'binary_recall': 0.8372093, 'binary_specificity': 0.8465116, 'binary_f1_score': 0.8411215}
confusion matrix:
     0    1
0  182   33
1   35  180
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_dial_lr1e5_bs16_allfreeze_2024-07-22_23-46-53/rule_results/6.csv
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_dial_lr1e5_bs16_allfreeze_2024-07-22_23-46-53/rule_results/6.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_dial_lr1e5_bs16_allfreeze_2024-07-22_23-46-53/confusion_matrix/6.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 190334 KiB |   2147 MiB | 134795 GiB | 134795 GiB |
|       from large pool | 173952 KiB |   2130 MiB | 132905 GiB | 132904 GiB |
|       from small pool |  16382 KiB |     32 MiB |   1890 GiB |   1890 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 190334 KiB |   2147 MiB | 134795 GiB | 134795 GiB |
|       from large pool | 173952 KiB |   2130 MiB | 132905 GiB | 132904 GiB |
|       from small pool |  16382 KiB |     32 MiB |   1890 GiB |   1890 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 189009 KiB |   2146 MiB | 134788 GiB | 134788 GiB |
|       from large pool | 172814 KiB |   2128 MiB | 132900 GiB | 132900 GiB |
|       from small pool |  16195 KiB |     32 MiB |   1888 GiB |   1888 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2916 MiB |   2916 MiB |   2916 MiB |      0 B   |
|       from large pool |   2878 MiB |   2878 MiB |   2878 MiB |      0 B   |
|       from small pool |     38 MiB |     38 MiB |     38 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |  55425 KiB | 233525 KiB |  71329 GiB |  71329 GiB |
|       from large pool |  51328 KiB | 232732 KiB |  69392 GiB |  69392 GiB |
|       from small pool |   4097 KiB |   9295 KiB |   1937 GiB |   1937 GiB |
|---------------------------------------------------------------------------|
| Allocations           |     776    |    1147    |   19023 K  |   19022 K  |
|       from large pool |      76    |     251    |   11945 K  |   11945 K  |
|       from small pool |     700    |     996    |    7077 K  |    7077 K  |
|---------------------------------------------------------------------------|
| Active allocs         |     776    |    1147    |   19023 K  |   19022 K  |
|       from large pool |      76    |     251    |   11945 K  |   11945 K  |
|       from small pool |     700    |     996    |    7077 K  |    7077 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     118    |     118    |     118    |       0    |
|       from large pool |      99    |      99    |      99    |       0    |
|       from small pool |      19    |      19    |      19    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      34    |     219    |   13446 K  |   13446 K  |
|       from large pool |      11    |      99    |    9148 K  |    9148 K  |
|       from small pool |      23    |     208    |    4297 K  |    4297 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   2147 MiB | 134795 GiB | 134795 GiB |
|       from large pool |  16640 KiB |   2130 MiB | 132905 GiB | 132905 GiB |
|       from small pool |      0 KiB |     32 MiB |   1890 GiB |   1890 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   2147 MiB | 134795 GiB | 134795 GiB |
|       from large pool |  16640 KiB |   2130 MiB | 132905 GiB | 132905 GiB |
|       from small pool |      0 KiB |     32 MiB |   1890 GiB |   1890 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   2146 MiB | 134788 GiB | 134788 GiB |
|       from large pool |  16640 KiB |   2128 MiB | 132900 GiB | 132900 GiB |
|       from small pool |      0 KiB |     32 MiB |   1888 GiB |   1888 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 245760 KiB |   2916 MiB |   2916 MiB |   2676 MiB |
|       from large pool | 225280 KiB |   2878 MiB |   2878 MiB |   2658 MiB |
|       from small pool |  20480 KiB |     38 MiB |     38 MiB |     18 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 233525 KiB |  71329 GiB |  71329 GiB |
|       from large pool |  24320 KiB | 232732 KiB |  69392 GiB |  69392 GiB |
|       from small pool |      0 KiB |   9295 KiB |   1937 GiB |   1937 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    1147    |   19023 K  |   19023 K  |
|       from large pool |       2    |     251    |   11945 K  |   11945 K  |
|       from small pool |       0    |     996    |    7077 K  |    7077 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    1147    |   19023 K  |   19023 K  |
|       from large pool |       2    |     251    |   11945 K  |   11945 K  |
|       from small pool |       0    |     996    |    7077 K  |    7077 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      21    |     118    |     118    |      97    |
|       from large pool |      11    |      99    |      99    |      88    |
|       from small pool |      10    |      19    |      19    |       9    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |     219    |   13447 K  |   13447 K  |
|       from large pool |       4    |      99    |    9148 K  |    9148 K  |
|       from small pool |       0    |     208    |    4298 K  |    4298 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   2147 MiB | 134795 GiB | 134795 GiB |
|       from large pool |  16640 KiB |   2130 MiB | 132905 GiB | 132905 GiB |
|       from small pool |      0 KiB |     32 MiB |   1890 GiB |   1890 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   2147 MiB | 134795 GiB | 134795 GiB |
|       from large pool |  16640 KiB |   2130 MiB | 132905 GiB | 132905 GiB |
|       from small pool |      0 KiB |     32 MiB |   1890 GiB |   1890 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   2146 MiB | 134788 GiB | 134788 GiB |
|       from large pool |  16640 KiB |   2128 MiB | 132900 GiB | 132900 GiB |
|       from small pool |      0 KiB |     32 MiB |   1888 GiB |   1888 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 245760 KiB |   2916 MiB |   2916 MiB |   2676 MiB |
|       from large pool | 225280 KiB |   2878 MiB |   2878 MiB |   2658 MiB |
|       from small pool |  20480 KiB |     38 MiB |     38 MiB |     18 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 233525 KiB |  71329 GiB |  71329 GiB |
|       from large pool |  24320 KiB | 232732 KiB |  69392 GiB |  69392 GiB |
|       from small pool |      0 KiB |   9295 KiB |   1937 GiB |   1937 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    1147    |   19023 K  |   19023 K  |
|       from large pool |       2    |     251    |   11945 K  |   11945 K  |
|       from small pool |       0    |     996    |    7077 K  |    7077 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    1147    |   19023 K  |   19023 K  |
|       from large pool |       2    |     251    |   11945 K  |   11945 K  |
|       from small pool |       0    |     996    |    7077 K  |    7077 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      21    |     118    |     118    |      97    |
|       from large pool |      11    |      99    |      99    |      88    |
|       from small pool |      10    |      19    |      19    |       9    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |     219    |   13447 K  |   13447 K  |
|       from large pool |       4    |      99    |    9148 K  |    9148 K  |
|       from small pool |       0    |     208    |    4298 K  |    4298 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'888c1ef2'
model name: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_02_10_54_seed_1_22769261

 Experiment start at: 2024-07-23 02:10:54.440532
before training, model accuracy: 0.6177777647972107
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.5735677, 'precision': 0.57378036, 'recall': 0.5728984, 'specificity': 0.5728984, 'f1': 0.5719646, 'auroc': 0.5856117, 'binary_precision': 0.5718475, 'binary_recall': 0.62700963, 'binary_specificity': 0.5187871, 'binary_f1_score': 0.59815955}
confusion matrix:
     0    1
0  787  730
1  580  975
---- Validation: 
scalar performance:
{'acc': 0.47384855, 'precision': 0.4174869, 'recall': 0.46746033, 'specificity': 0.46746033, 'f1': 0.37520334, 'auroc': 0.6712872, 'binary_precision': 0.34507042, 'binary_recall': 0.07777778, 'binary_specificity': 0.85714287, 'binary_f1_score': 0.126943}
confusion matrix:
     0   1
0  558  93
1  581  49
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.56222224, 'precision': 0.61321163, 'recall': 0.56222224, 'specificity': 0.56222224, 'f1': 0.50667506, 'auroc': 0.71952593, 'binary_precision': 0.6891892, 'binary_recall': 0.22666667, 'binary_specificity': 0.8977778, 'binary_f1_score': 0.3411371}
confusion matrix:
     0   1
0  202  23
1  174  51
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-23 02:13:32.361282,epoch time: 0:02:37.920750,used: 0:02:37.920750,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_02_10_54_seed_1_22769261
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.68652344, 'precision': 0.6899742, 'recall': 0.6855588, 'specificity': 0.6855588, 'f1': 0.6843485, 'auroc': 0.73129165, 'binary_precision': 0.66741955, 'binary_recall': 0.7596401, 'binary_specificity': 0.61147755, 'binary_f1_score': 0.71055007}
confusion matrix:
     0     1
0  927   589
1  374  1182
---- Validation: 
scalar performance:
{'acc': 0.52459013, 'precision': 0.53366137, 'recall': 0.51922685, 'specificity': 0.51922685, 'f1': 0.46421957, 'auroc': 0.71760666, 'binary_precision': 0.54751134, 'binary_recall': 0.1920635, 'binary_specificity': 0.8463902, 'binary_f1_score': 0.28437135}
confusion matrix:
     0    1
0  551  100
1  509  121
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.61777776, 'precision': 0.65303767, 'recall': 0.61777776, 'specificity': 0.61777776, 'f1': 0.59441614, 'auroc': 0.7621136, 'binary_precision': 0.72649574, 'binary_recall': 0.37777779, 'binary_specificity': 0.8577778, 'binary_f1_score': 0.497076}
confusion matrix:
     0   1
0  193  32
1  140  85
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-07-23 02:15:51.109715,epoch time: 0:02:18.748433,used: 0:04:56.669183,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_02_10_54_seed_1_22769261
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.7399089, 'precision': 0.7445485, 'recall': 0.7389618, 'specificity': 0.7389618, 'f1': 0.7381327, 'auroc': 0.8044238, 'binary_precision': 0.7139627, 'binary_recall': 0.81169665, 'binary_specificity': 0.6662269, 'binary_f1_score': 0.7596992}
confusion matrix:
      0     1
0  1010   506
1   293  1263
---- Validation: 
scalar performance:
{'acc': 0.60265416, 'precision': 0.6260389, 'recall': 0.59887356, 'specificity': 0.59887356, 'f1': 0.5782742, 'auroc': 0.7489772, 'binary_precision': 0.67638487, 'binary_recall': 0.36825398, 'binary_specificity': 0.8294931, 'binary_f1_score': 0.47687563}
confusion matrix:
     0    1
0  540  111
1  398  232
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6666667, 'precision': 0.68133855, 'recall': 0.6666667, 'specificity': 0.6666667, 'f1': 0.65978503, 'auroc': 0.7913877, 'binary_precision': 0.7329193, 'binary_recall': 0.52444446, 'binary_specificity': 0.8088889, 'binary_f1_score': 0.61139894}
confusion matrix:
     0    1
0  182   43
1  107  118
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-07-23 02:18:10.481285,epoch time: 0:02:19.371570,used: 0:07:16.040753,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_02_10_54_seed_1_22769261
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.78841144, 'precision': 0.7885997, 'recall': 0.788218, 'specificity': 0.788218, 'f1': 0.78827494, 'auroc': 0.85325754, 'binary_precision': 0.78369904, 'binary_recall': 0.8038585, 'binary_specificity': 0.77257746, 'binary_f1_score': 0.79365075}
confusion matrix:
      0     1
0  1172   345
1   305  1250
---- Validation: 
scalar performance:
{'acc': 0.62607336, 'precision': 0.65430355, 'recall': 0.62237585, 'specificity': 0.62237585, 'f1': 0.60406756, 'auroc': 0.7693902, 'binary_precision': 0.7163324, 'binary_recall': 0.3968254, 'binary_specificity': 0.84792626, 'binary_f1_score': 0.5107252}
confusion matrix:
     0    1
0  552   99
1  380  250
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6888889, 'precision': 0.71622384, 'recall': 0.6888889, 'specificity': 0.6888889, 'f1': 0.6787353, 'auroc': 0.8117728, 'binary_precision': 0.79310346, 'binary_recall': 0.51111114, 'binary_specificity': 0.8666667, 'binary_f1_score': 0.6216216}
confusion matrix:
     0    1
0  195   30
1  110  115
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-07-23 02:20:26.990712,epoch time: 0:02:16.509427,used: 0:09:32.550180,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_02_10_54_seed_1_22769261
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.8108724, 'precision': 0.81179, 'recall': 0.8105374, 'specificity': 0.8105374, 'f1': 0.81059766, 'auroc': 0.8842882, 'binary_precision': 0.79755354, 'binary_recall': 0.83912486, 'binary_specificity': 0.78194994, 'binary_f1_score': 0.8178112}
confusion matrix:
      0     1
0  1187   331
1   250  1304
---- Validation: 
scalar performance:
{'acc': 0.66978925, 'precision': 0.6905186, 'recall': 0.6669483, 'specificity': 0.6669483, 'f1': 0.65818775, 'auroc': 0.79052246, 'binary_precision': 0.7493976, 'binary_recall': 0.4936508, 'binary_specificity': 0.8402458, 'binary_f1_score': 0.59521526}
confusion matrix:
     0    1
0  547  104
1  319  311
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7111111, 'precision': 0.72845817, 'recall': 0.71111107, 'specificity': 0.71111107, 'f1': 0.7055211, 'auroc': 0.8322766, 'binary_precision': 0.79141104, 'binary_recall': 0.5733333, 'binary_specificity': 0.8488889, 'binary_f1_score': 0.6649484}
confusion matrix:
     0    1
0  191   34
1   96  129
new oracle model saved
better model found
persisted
after epoch: 5,now: 2024-07-23 02:22:45.816076,epoch time: 0:02:18.825364,used: 0:11:51.375544,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_02_10_54_seed_1_22769261
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.82096356, 'precision': 0.82119864, 'recall': 0.820752, 'specificity': 0.820752, 'f1': 0.8208359, 'auroc': 0.90282404, 'binary_precision': 0.81527865, 'binary_recall': 0.8362235, 'binary_specificity': 0.8052805, 'binary_f1_score': 0.8256182}
confusion matrix:
      0     1
0  1220   295
1   255  1302
---- Validation: 
scalar performance:
{'acc': 0.6861827, 'precision': 0.7104939, 'recall': 0.68328214, 'specificity': 0.68328214, 'f1': 0.6746677, 'auroc': 0.8041475, 'binary_precision': 0.77804875, 'binary_recall': 0.5063492, 'binary_specificity': 0.86021507, 'binary_f1_score': 0.61346155}
confusion matrix:
     0    1
0  560   91
1  311  319
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7266667, 'precision': 0.74730605, 'recall': 0.7266667, 'specificity': 0.7266667, 'f1': 0.72084224, 'auroc': 0.84638023, 'binary_precision': 0.81875, 'binary_recall': 0.5822222, 'binary_specificity': 0.8711111, 'binary_f1_score': 0.6805195}
confusion matrix:
     0    1
0  196   29
1   94  131
new oracle model saved
better model found
persisted
after epoch: 6,now: 2024-07-23 02:25:04.881864,epoch time: 0:02:19.065788,used: 0:14:10.441332,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_02_10_54_seed_1_22769261
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.84277344, 'precision': 0.8427829, 'recall': 0.8428464, 'specificity': 0.8428464, 'f1': 0.8427674, 'auroc': 0.921559, 'binary_precision': 0.8500652, 'binary_recall': 0.837508, 'binary_specificity': 0.8481848, 'binary_f1_score': 0.84373987}
confusion matrix:
      0     1
0  1285   230
1   253  1304
---- Validation: 
scalar performance:
{'acc': 0.6971116, 'precision': 0.7252984, 'recall': 0.69411165, 'specificity': 0.69411165, 'f1': 0.68521816, 'auroc': 0.8135128, 'binary_precision': 0.80099505, 'binary_recall': 0.51111114, 'binary_specificity': 0.87711215, 'binary_f1_score': 0.62403107}
confusion matrix:
     0    1
0  571   80
1  308  322
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7311111, 'precision': 0.7521552, 'recall': 0.7311111, 'specificity': 0.7311111, 'f1': 0.7253814, 'auroc': 0.85564446, 'binary_precision': 0.825, 'binary_recall': 0.58666664, 'binary_specificity': 0.8755556, 'binary_f1_score': 0.68571424}
confusion matrix:
     0    1
0  197   28
1   93  132
new oracle model saved
better model found
persisted
after epoch: 7,now: 2024-07-23 02:27:24.057844,epoch time: 0:02:19.175980,used: 0:16:29.617312,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_02_10_54_seed_1_22769261
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.85253906, 'precision': 0.85250735, 'recall': 0.8525249, 'specificity': 0.8525249, 'f1': 0.8525152, 'auroc': 0.9316893, 'binary_precision': 0.85521233, 'binary_recall': 0.85356456, 'binary_specificity': 0.85148513, 'binary_f1_score': 0.8543876}
confusion matrix:
      0     1
0  1290   225
1   228  1329
---- Validation: 
scalar performance:
{'acc': 0.71818894, 'precision': 0.7383214, 'recall': 0.71571946, 'specificity': 0.71571946, 'f1': 0.71055776, 'auroc': 0.8235803, 'binary_precision': 0.80361176, 'binary_recall': 0.5650794, 'binary_specificity': 0.8663595, 'binary_f1_score': 0.66356015}
confusion matrix:
     0    1
0  564   87
1  274  356
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7644445, 'precision': 0.7781818, 'recall': 0.7644445, 'specificity': 0.7644445, 'f1': 0.76149994, 'auroc': 0.86449385, 'binary_precision': 0.84, 'binary_recall': 0.6533333, 'binary_specificity': 0.8755556, 'binary_f1_score': 0.7349999}
confusion matrix:
     0    1
0  197   28
1   78  147
new oracle model saved
better model found
persisted
after epoch: 8,now: 2024-07-23 02:29:43.520534,epoch time: 0:02:19.462690,used: 0:18:49.080002,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_02_10_54_seed_1_22769261
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.8541667, 'precision': 0.85413134, 'recall': 0.8541554, 'specificity': 0.8541554, 'f1': 0.85414195, 'auroc': 0.93797135, 'binary_precision': 0.85714287, 'binary_recall': 0.85494226, 'binary_specificity': 0.8533686, 'binary_f1_score': 0.85604113}
confusion matrix:
      0     1
0  1292   222
1   226  1332
---- Validation: 
scalar performance:
{'acc': 0.7330211, 'precision': 0.7524766, 'recall': 0.7306708, 'specificity': 0.7306708, 'f1': 0.7264188, 'auroc': 0.83076406, 'binary_precision': 0.8185841, 'binary_recall': 0.5873016, 'binary_specificity': 0.87403995, 'binary_f1_score': 0.68391865}
confusion matrix:
     0    1
0  569   82
1  260  370
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7777778, 'precision': 0.78989464, 'recall': 0.7777778, 'specificity': 0.7777778, 'f1': 0.77543116, 'auroc': 0.87132835, 'binary_precision': 0.849162, 'binary_recall': 0.6755555, 'binary_specificity': 0.88, 'binary_f1_score': 0.7524752}
confusion matrix:
     0    1
0  198   27
1   73  152
new oracle model saved
better model found
persisted
after epoch: 9,now: 2024-07-23 02:32:03.182265,epoch time: 0:02:19.661731,used: 0:21:08.741733,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_02_10_54_seed_1_22769261
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.86360675, 'precision': 0.8636667, 'recall': 0.8637192, 'specificity': 0.8637192, 'f1': 0.863605, 'auroc': 0.9427837, 'binary_precision': 0.87287027, 'binary_recall': 0.85549134, 'binary_specificity': 0.87194717, 'binary_f1_score': 0.8640934}
confusion matrix:
      0     1
0  1321   194
1   225  1332
---- Validation: 
scalar performance:
{'acc': 0.7470726, 'precision': 0.76446986, 'recall': 0.7449053, 'specificity': 0.7449053, 'f1': 0.74168503, 'auroc': 0.83776116, 'binary_precision': 0.82832617, 'binary_recall': 0.61269844, 'binary_specificity': 0.87711215, 'binary_f1_score': 0.70437956}
confusion matrix:
     0    1
0  571   80
1  244  386
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7977778, 'precision': 0.8060541, 'recall': 0.7977778, 'specificity': 0.7977778, 'f1': 0.7964013, 'auroc': 0.87913084, 'binary_precision': 0.85638297, 'binary_recall': 0.71555555, 'binary_specificity': 0.88, 'binary_f1_score': 0.779661}
confusion matrix:
     0    1
0  198   27
1   64  161
new oracle model saved
better model found
persisted
after epoch: 10,now: 2024-07-23 02:34:24.133139,epoch time: 0:02:20.950874,used: 0:23:29.692607,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_02_10_54_seed_1_22769261
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.8701172, 'precision': 0.87009764, 'recall': 0.8701031, 'specificity': 0.8701031, 'f1': 0.8701004, 'auroc': 0.94552755, 'binary_precision': 0.8718609, 'binary_recall': 0.87129986, 'binary_specificity': 0.86890644, 'binary_f1_score': 0.87158036}
confusion matrix:
      0     1
0  1319   199
1   200  1354
---- Validation: 
scalar performance:
{'acc': 0.7689305, 'precision': 0.77989596, 'recall': 0.7672555, 'specificity': 0.7672555, 'f1': 0.7658471, 'auroc': 0.8433716, 'binary_precision': 0.8313492, 'binary_recall': 0.66507936, 'binary_specificity': 0.8694316, 'binary_f1_score': 0.7389771}
confusion matrix:
     0    1
0  566   85
1  211  419
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8088889, 'precision': 0.8124438, 'recall': 0.8088889, 'specificity': 0.8088889, 'f1': 0.80834377, 'auroc': 0.884879, 'binary_precision': 0.84577113, 'binary_recall': 0.75555557, 'binary_specificity': 0.8622222, 'binary_f1_score': 0.7981221}
confusion matrix:
     0    1
0  194   31
1   55  170
new oracle model saved
better model found
persisted
after epoch: 11,now: 2024-07-23 02:36:42.250424,epoch time: 0:02:18.117285,used: 0:25:47.809892,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_02_10_54_seed_1_22769261
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.8854167, 'precision': 0.8854409, 'recall': 0.8854958, 'specificity': 0.8854958, 'f1': 0.8854143, 'auroc': 0.95560324, 'binary_precision': 0.8928805, 'binary_recall': 0.87909967, 'binary_specificity': 0.8918919, 'binary_f1_score': 0.8859365}
confusion matrix:
      0     1
0  1353   164
1   188  1367
---- Validation: 
scalar performance:
{'acc': 0.75956285, 'precision': 0.77944577, 'recall': 0.7573221, 'specificity': 0.7573221, 'f1': 0.75409603, 'auroc': 0.84564894, 'binary_precision': 0.85, 'binary_recall': 0.6206349, 'binary_specificity': 0.89400923, 'binary_f1_score': 0.7174312}
confusion matrix:
     0    1
0  582   69
1  239  391
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.81333333, 'precision': 0.81900454, 'recall': 0.81333333, 'specificity': 0.81333333, 'f1': 0.8125, 'auroc': 0.88790125, 'binary_precision': 0.86153847, 'binary_recall': 0.74666667, 'binary_specificity': 0.88, 'binary_f1_score': 0.8}
confusion matrix:
     0    1
0  198   27
1   57  168
new oracle model saved
early stop counter: 1
val acc:0.7595628499984741, best validation acc: 0.7689304947853088, corresponding to test acc:                         0.8088889122009277 / 0.8133333325386047
after epoch: 12,now: 2024-07-23 02:39:01.327847,epoch time: 0:02:19.077423,used: 0:28:06.887315,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_02_10_54_seed_1_22769261
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.87565106, 'precision': 0.8759216, 'recall': 0.8758419, 'specificity': 0.8758419, 'f1': 0.87564975, 'auroc': 0.9504535, 'binary_precision': 0.88977426, 'binary_recall': 0.8611825, 'binary_specificity': 0.8905013, 'binary_f1_score': 0.875245}
confusion matrix:
      0     1
0  1350   166
1   216  1340
---- Validation: 
scalar performance:
{'acc': 0.765808, 'precision': 0.78232557, 'recall': 0.7637737, 'specificity': 0.7637737, 'f1': 0.7613542, 'auroc': 0.8496257, 'binary_precision': 0.8466387, 'binary_recall': 0.63968253, 'binary_specificity': 0.8878648, 'binary_f1_score': 0.72875226}
confusion matrix:
     0    1
0  578   73
1  227  403
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8111111, 'precision': 0.815, 'recall': 0.8111111, 'specificity': 0.8111111, 'f1': 0.8105264, 'auroc': 0.89248395, 'binary_precision': 0.85, 'binary_recall': 0.75555557, 'binary_specificity': 0.8666667, 'binary_f1_score': 0.8}
confusion matrix:
     0    1
0  195   30
1   55  170
early stop counter: 2
val acc:0.7658079862594604, best validation acc: 0.7689304947853088, corresponding to test acc:                         0.8088889122009277 / 0.8133333325386047
after epoch: 13,now: 2024-07-23 02:41:20.615343,epoch time: 0:02:19.287496,used: 0:30:26.174811,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_02_10_54_seed_1_22769261
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.890625, 'precision': 0.8906946, 'recall': 0.8907244, 'specificity': 0.8907244, 'f1': 0.8906245, 'auroc': 0.9587282, 'binary_precision': 0.8996063, 'binary_recall': 0.8822394, 'binary_specificity': 0.8992095, 'binary_f1_score': 0.8908382}
confusion matrix:
      0     1
0  1365   153
1   183  1371
---- Validation: 
scalar performance:
{'acc': 0.7822014, 'precision': 0.79179823, 'recall': 0.78067076, 'specificity': 0.78067076, 'f1': 0.7797185, 'auroc': 0.8535806, 'binary_precision': 0.8407767, 'binary_recall': 0.6873016, 'binary_specificity': 0.87403995, 'binary_f1_score': 0.75633186}
confusion matrix:
     0    1
0  569   82
1  197  433
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.82222223, 'precision': 0.8234746, 'recall': 0.82222223, 'specificity': 0.82222223, 'f1': 0.82205, 'auroc': 0.8976, 'binary_precision': 0.8436019, 'binary_recall': 0.7911111, 'binary_specificity': 0.85333335, 'binary_f1_score': 0.8165138}
confusion matrix:
     0    1
0  192   33
1   47  178
new oracle model saved
better model found
persisted
after epoch: 14,now: 2024-07-23 02:43:40.999115,epoch time: 0:02:20.383772,used: 0:32:46.558583,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_02_10_54_seed_1_22769261
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.89485675, 'precision': 0.8954159, 'recall': 0.89507806, 'specificity': 0.89507806, 'f1': 0.894846, 'auroc': 0.95938927, 'binary_precision': 0.9133065, 'binary_recall': 0.87508047, 'binary_specificity': 0.9150757, 'binary_f1_score': 0.8937849}
confusion matrix:
      0     1
0  1390   129
1   194  1359
---- Validation: 
scalar performance:
{'acc': 0.78298205, 'precision': 0.7988194, 'recall': 0.7810548, 'specificity': 0.7810548, 'f1': 0.7792299, 'auroc': 0.8557116, 'binary_precision': 0.8636364, 'binary_recall': 0.6634921, 'binary_specificity': 0.8986175, 'binary_f1_score': 0.7504488}
confusion matrix:
     0    1
0  585   66
1  212  418
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8244445, 'precision': 0.82589287, 'recall': 0.8244444, 'specificity': 0.8244444, 'f1': 0.82424915, 'auroc': 0.90050375, 'binary_precision': 0.84761906, 'binary_recall': 0.7911111, 'binary_specificity': 0.8577778, 'binary_f1_score': 0.8183908}
confusion matrix:
     0    1
0  193   32
1   47  178
new oracle model saved
better model found
persisted
after epoch: 15,now: 2024-07-23 02:45:59.615486,epoch time: 0:02:18.616371,used: 0:35:05.174954,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_02_10_54_seed_1_22769261
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.8935547, 'precision': 0.8956429, 'recall': 0.89412075, 'specificity': 0.89412075, 'f1': 0.8934912, 'auroc': 0.95837104, 'binary_precision': 0.92837274, 'binary_recall': 0.8563182, 'binary_specificity': 0.93192333, 'binary_f1_score': 0.8908909}
confusion matrix:
      0     1
0  1410   103
1   224  1335
---- Validation: 
scalar performance:
{'acc': 0.77517563, 'precision': 0.79431593, 'recall': 0.7730415, 'specificity': 0.7730415, 'f1': 0.77049184, 'auroc': 0.8566747, 'binary_precision': 0.86538464, 'binary_recall': 0.64285713, 'binary_specificity': 0.9032258, 'binary_f1_score': 0.73770493}
confusion matrix:
     0    1
0  588   63
1  225  405
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.82, 'precision': 0.824, 'recall': 0.82000005, 'specificity': 0.82000005, 'f1': 0.8194427, 'auroc': 0.9010963, 'binary_precision': 0.86, 'binary_recall': 0.7644445, 'binary_specificity': 0.8755556, 'binary_f1_score': 0.80941176}
confusion matrix:
     0    1
0  197   28
1   53  172
early stop counter: 1
val acc:0.7751756310462952, best validation acc: 0.7829820513725281, corresponding to test acc:                         0.8244444727897644 / 0.8244444727897644
after epoch: 16,now: 2024-07-23 02:48:18.742026,epoch time: 0:02:19.126540,used: 0:37:24.301494,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_02_10_54_seed_1_22769261
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.8935547, 'precision': 0.8952893, 'recall': 0.89395595, 'specificity': 0.89395595, 'f1': 0.8934945, 'auroc': 0.96398556, 'binary_precision': 0.92456746, 'binary_recall': 0.85971683, 'binary_specificity': 0.928195, 'binary_f1_score': 0.8909636}
confusion matrix:
      0     1
0  1409   109
1   218  1336
---- Validation: 
scalar performance:
{'acc': 0.774395, 'precision': 0.79424024, 'recall': 0.7722222, 'specificity': 0.7722222, 'f1': 0.76953614, 'auroc': 0.85730624, 'binary_precision': 0.8666667, 'binary_recall': 0.63968253, 'binary_specificity': 0.9047619, 'binary_f1_score': 0.736073}
confusion matrix:
     0    1
0  589   62
1  227  403
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.82222223, 'precision': 0.82658315, 'recall': 0.82222223, 'specificity': 0.82222223, 'f1': 0.8216268, 'auroc': 0.90170866, 'binary_precision': 0.8643216, 'binary_recall': 0.7644445, 'binary_specificity': 0.88, 'binary_f1_score': 0.8113207}
confusion matrix:
     0    1
0  198   27
1   53  172
early stop counter: 2
val acc:0.7743949890136719, best validation acc: 0.7829820513725281, corresponding to test acc:                         0.8244444727897644 / 0.8244444727897644
after epoch: 17,now: 2024-07-23 02:50:41.289775,epoch time: 0:02:22.547749,used: 0:39:46.849243,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_02_10_54_seed_1_22769261
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9095052, 'precision': 0.90976, 'recall': 0.90969336, 'specificity': 0.90969336, 'f1': 0.90950465, 'auroc': 0.96704555, 'binary_precision': 0.92374, 'binary_recall': 0.89524424, 'binary_specificity': 0.9241425, 'binary_f1_score': 0.909269}
confusion matrix:
      0     1
0  1401   115
1   163  1393
---- Validation: 
scalar performance:
{'acc': 0.78844655, 'precision': 0.80217826, 'recall': 0.7866615, 'specificity': 0.7866615, 'f1': 0.78526187, 'auroc': 0.8592788, 'binary_precision': 0.86262625, 'binary_recall': 0.67777777, 'binary_specificity': 0.8955453, 'binary_f1_score': 0.75911105}
confusion matrix:
     0    1
0  583   68
1  203  427
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.82666665, 'precision': 0.82877076, 'recall': 0.8266667, 'specificity': 0.8266667, 'f1': 0.8263889, 'auroc': 0.90305185, 'binary_precision': 0.85507244, 'binary_recall': 0.7866667, 'binary_specificity': 0.8666667, 'binary_f1_score': 0.8194445}
confusion matrix:
     0    1
0  195   30
1   48  177
new oracle model saved
better model found
persisted
after epoch: 18,now: 2024-07-23 02:53:01.029410,epoch time: 0:02:19.739635,used: 0:42:06.588878,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_02_10_54_seed_1_22769261
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9082031, 'precision': 0.9084046, 'recall': 0.9083741, 'specificity': 0.9083741, 'f1': 0.908203, 'auroc': 0.9666488, 'binary_precision': 0.9212963, 'binary_recall': 0.89524424, 'binary_specificity': 0.92150396, 'binary_f1_score': 0.9080835}
confusion matrix:
      0     1
0  1397   119
1   163  1393
---- Validation: 
scalar performance:
{'acc': 0.78844655, 'precision': 0.80260706, 'recall': 0.786636, 'specificity': 0.786636, 'f1': 0.7851784, 'auroc': 0.85883254, 'binary_precision': 0.86409736, 'binary_recall': 0.6761905, 'binary_specificity': 0.89708143, 'binary_f1_score': 0.75868213}
confusion matrix:
     0    1
0  584   67
1  204  426
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8244445, 'precision': 0.82729554, 'recall': 0.8244444, 'specificity': 0.8244444, 'f1': 0.82406133, 'auroc': 0.90433586, 'binary_precision': 0.85784316, 'binary_recall': 0.7777778, 'binary_specificity': 0.8711111, 'binary_f1_score': 0.81585085}
confusion matrix:
     0    1
0  196   29
1   50  175
early stop counter: 1
val acc:0.7884465456008911, best validation acc: 0.7884465456008911, corresponding to test acc:                         0.8266666531562805 / 0.8266666531562805
after epoch: 19,now: 2024-07-23 02:55:20.543259,epoch time: 0:02:19.513849,used: 0:44:26.102727,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_02_10_54_seed_1_22769261
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.90690106, 'precision': 0.90981984, 'recall': 0.9074702, 'specificity': 0.9074702, 'f1': 0.9068062, 'auroc': 0.96867394, 'binary_precision': 0.9478138, 'binary_recall': 0.8637532, 'binary_specificity': 0.9511873, 'binary_f1_score': 0.90383315}
confusion matrix:
      0     1
0  1442    74
1   212  1344
---- Validation: 
scalar performance:
{'acc': 0.7642467, 'precision': 0.79387486, 'recall': 0.7615975, 'specificity': 0.7615975, 'f1': 0.7568789, 'auroc': 0.8578061, 'binary_precision': 0.8831776, 'binary_recall': 0.6, 'binary_specificity': 0.92319506, 'binary_f1_score': 0.71455574}
confusion matrix:
     0    1
0  601   50
1  252  378
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8244445, 'precision': 0.837963, 'recall': 0.8244444, 'specificity': 0.8244444, 'f1': 0.8226712, 'auroc': 0.90400004, 'binary_precision': 0.90555555, 'binary_recall': 0.72444445, 'binary_specificity': 0.92444444, 'binary_f1_score': 0.80493826}
confusion matrix:
     0    1
0  208   17
1   62  163
early stop counter: 2
val acc:0.7642467021942139, best validation acc: 0.7884465456008911, corresponding to test acc:                         0.8266666531562805 / 0.8266666531562805
after epoch: 20,now: 2024-07-23 02:57:39.136937,epoch time: 0:02:18.593678,used: 0:46:44.696405,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_02_10_54_seed_1_22769261
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9095052, 'precision': 0.90995276, 'recall': 0.90974426, 'specificity': 0.90974426, 'f1': 0.9095014, 'auroc': 0.96918476, 'binary_precision': 0.92713904, 'binary_recall': 0.8913882, 'binary_specificity': 0.9281003, 'binary_f1_score': 0.90891224}
confusion matrix:
      0     1
0  1407   109
1   169  1387
---- Validation: 
scalar performance:
{'acc': 0.79703355, 'precision': 0.81016004, 'recall': 0.7953149, 'specificity': 0.7953149, 'f1': 0.7941736, 'auroc': 0.86139274, 'binary_precision': 0.87, 'binary_recall': 0.6904762, 'binary_specificity': 0.90015364, 'binary_f1_score': 0.76991147}
confusion matrix:
     0    1
0  586   65
1  195  435
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8333333, 'precision': 0.83524716, 'recall': 0.8333333, 'specificity': 0.8333333, 'f1': 0.8330951, 'auroc': 0.90721977, 'binary_precision': 0.8605769, 'binary_recall': 0.79555553, 'binary_specificity': 0.8711111, 'binary_f1_score': 0.8267898}
confusion matrix:
     0    1
0  196   29
1   46  179
new oracle model saved
better model found
persisted
after epoch: 21,now: 2024-07-23 02:59:46.716547,epoch time: 0:02:07.579610,used: 0:48:52.276015,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_02_10_54_seed_1_22769261
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.91503906, 'precision': 0.9161714, 'recall': 0.91540194, 'specificity': 0.91540194, 'f1': 0.91501737, 'auroc': 0.9750006, 'binary_precision': 0.941377, 'binary_recall': 0.8875321, 'binary_specificity': 0.94327176, 'binary_f1_score': 0.9136619}
confusion matrix:
      0     1
0  1430    86
1   175  1381
---- Validation: 
scalar performance:
{'acc': 0.7892272, 'precision': 0.8049965, 'recall': 0.7873272, 'specificity': 0.7873272, 'f1': 0.78567123, 'auroc': 0.8613416, 'binary_precision': 0.8703704, 'binary_recall': 0.67142856, 'binary_specificity': 0.9032258, 'binary_f1_score': 0.7580645}
confusion matrix:
     0    1
0  588   63
1  207  423
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8333333, 'precision': 0.8375, 'recall': 0.8333334, 'specificity': 0.8333334, 'f1': 0.8328173, 'auroc': 0.9074568, 'binary_precision': 0.875, 'binary_recall': 0.7777778, 'binary_specificity': 0.8888889, 'binary_f1_score': 0.8235294}
confusion matrix:
     0    1
0  200   25
1   50  175
early stop counter: 1
val acc:0.7892271876335144, best validation acc: 0.7970335483551025, corresponding to test acc:                         0.8333333134651184 / 0.8333333134651184
after epoch: 22,now: 2024-07-23 03:01:53.705298,epoch time: 0:02:06.988751,used: 0:50:59.264766,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_02_10_54_seed_1_22769261
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.90722656, 'precision': 0.90788126, 'recall': 0.9075253, 'specificity': 0.9075253, 'f1': 0.90721834, 'auroc': 0.9685428, 'binary_precision': 0.9279946, 'binary_recall': 0.8856776, 'binary_specificity': 0.92937297, 'binary_f1_score': 0.9063424}
confusion matrix:
      0     1
0  1408   107
1   178  1379
---- Validation: 
scalar performance:
{'acc': 0.7978142, 'precision': 0.807318, 'recall': 0.7963389, 'specificity': 0.7963389, 'f1': 0.7956443, 'auroc': 0.86298, 'binary_precision': 0.8574181, 'binary_recall': 0.7063492, 'binary_specificity': 0.8863287, 'binary_f1_score': 0.7745866}
confusion matrix:
     0    1
0  577   74
1  185  445
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8333333, 'precision': 0.83524716, 'recall': 0.8333333, 'specificity': 0.8333333, 'f1': 0.8330951, 'auroc': 0.90899754, 'binary_precision': 0.8605769, 'binary_recall': 0.79555553, 'binary_specificity': 0.8711111, 'binary_f1_score': 0.8267898}
confusion matrix:
     0    1
0  196   29
1   46  179
better model found
persisted
after epoch: 23,now: 2024-07-23 03:04:01.525280,epoch time: 0:02:07.819982,used: 0:53:07.084748,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_02_10_54_seed_1_22769261
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.914388, 'precision': 0.9147949, 'recall': 0.9146045, 'specificity': 0.9146045, 'f1': 0.9143847, 'auroc': 0.97157955, 'binary_precision': 0.93124163, 'binary_recall': 0.8971061, 'binary_specificity': 0.93210286, 'binary_f1_score': 0.91385525}
confusion matrix:
      0     1
0  1414   103
1   160  1395
---- Validation: 
scalar performance:
{'acc': 0.80483997, 'precision': 0.8118025, 'recall': 0.8035842, 'specificity': 0.8035842, 'f1': 0.80325437, 'auroc': 0.8643967, 'binary_precision': 0.8544776, 'binary_recall': 0.72698414, 'binary_specificity': 0.88018435, 'binary_f1_score': 0.78559184}
confusion matrix:
     0    1
0  573   78
1  172  458
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8333333, 'precision': 0.83482146, 'recall': 0.8333334, 'specificity': 0.8333334, 'f1': 0.83314794, 'auroc': 0.9103012, 'binary_precision': 0.85714287, 'binary_recall': 0.8, 'binary_specificity': 0.8666667, 'binary_f1_score': 0.82758623}
confusion matrix:
     0    1
0  195   30
1   45  180
better model found
persisted
after epoch: 24,now: 2024-07-23 03:06:10.015602,epoch time: 0:02:08.490322,used: 0:55:15.575070,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_02_10_54_seed_1_22769261
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.9111328, 'precision': 0.911283, 'recall': 0.9112763, 'specificity': 0.9112763, 'f1': 0.9111328, 'auroc': 0.97393143, 'binary_precision': 0.9228232, 'binary_recall': 0.89967847, 'binary_specificity': 0.9228741, 'binary_f1_score': 0.9111039}
confusion matrix:
      0     1
0  1400   117
1   156  1399
---- Validation: 
scalar performance:
{'acc': 0.80796254, 'precision': 0.8156314, 'recall': 0.8066564, 'specificity': 0.8066564, 'f1': 0.80629086, 'auroc': 0.8649916, 'binary_precision': 0.86090225, 'binary_recall': 0.72698414, 'binary_specificity': 0.8863287, 'binary_f1_score': 0.7882961}
confusion matrix:
     0    1
0  577   74
1  172  458
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.83555555, 'precision': 0.837261, 'recall': 0.83555555, 'specificity': 0.83555555, 'f1': 0.8353474, 'auroc': 0.91117036, 'binary_precision': 0.861244, 'binary_recall': 0.8, 'binary_specificity': 0.8711111, 'binary_f1_score': 0.8294931}
confusion matrix:
     0    1
0  196   29
1   45  180
new oracle model saved
better model found
persisted
after epoch: 25,now: 2024-07-23 03:08:19.014877,epoch time: 0:02:08.999275,used: 0:57:24.574345,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_02_10_54_seed_1_22769261
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.91503906, 'precision': 0.9151831, 'recall': 0.91519, 'specificity': 0.91519, 'f1': 0.91503906, 'auroc': 0.97233576, 'binary_precision': 0.9268293, 'binary_recall': 0.90359896, 'binary_specificity': 0.926781, 'binary_f1_score': 0.9150667}
confusion matrix:
      0     1
0  1405   111
1   150  1406
---- Validation: 
scalar performance:
{'acc': 0.8087432, 'precision': 0.8162768, 'recall': 0.80745006, 'specificity': 0.80745006, 'f1': 0.8071064, 'auroc': 0.8665643, 'binary_precision': 0.8611632, 'binary_recall': 0.7285714, 'binary_specificity': 0.8863287, 'binary_f1_score': 0.78933793}
confusion matrix:
     0    1
0  577   74
1  171  459
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8333333, 'precision': 0.83482146, 'recall': 0.8333334, 'specificity': 0.8333334, 'f1': 0.83314794, 'auroc': 0.9123161, 'binary_precision': 0.85714287, 'binary_recall': 0.8, 'binary_specificity': 0.8666667, 'binary_f1_score': 0.82758623}
confusion matrix:
     0    1
0  195   30
1   45  180
better model found
persisted
after epoch: 26,now: 2024-07-23 03:10:27.981118,epoch time: 0:02:08.966241,used: 0:59:33.540586,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_02_10_54_seed_1_22769261
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.9140625, 'precision': 0.9152216, 'recall': 0.9144294, 'specificity': 0.9144294, 'f1': 0.91403973, 'auroc': 0.97304964, 'binary_precision': 0.9406548, 'binary_recall': 0.8862468, 'binary_specificity': 0.9426121, 'binary_f1_score': 0.9126406}
confusion matrix:
      0     1
0  1429    87
1   177  1379
---- Validation: 
scalar performance:
{'acc': 0.79234976, 'precision': 0.80878186, 'recall': 0.790425, 'specificity': 0.790425, 'f1': 0.7887596, 'auroc': 0.86588645, 'binary_precision': 0.87603307, 'binary_recall': 0.6730159, 'binary_specificity': 0.9078341, 'binary_f1_score': 0.7612209}
confusion matrix:
     0    1
0  591   60
1  206  424
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.83555555, 'precision': 0.8408339, 'recall': 0.83555555, 'specificity': 0.83555555, 'f1': 0.8349164, 'auroc': 0.91247404, 'binary_precision': 0.88324875, 'binary_recall': 0.7733333, 'binary_specificity': 0.8977778, 'binary_f1_score': 0.8246445}
confusion matrix:
     0    1
0  202   23
1   51  174
early stop counter: 1
val acc:0.7923497557640076, best validation acc: 0.8087431788444519, corresponding to test acc:                         0.8333333134651184 / 0.8355555534362793
after epoch: 27,now: 2024-07-23 03:12:35.804604,epoch time: 0:02:07.823486,used: 1:01:41.364072,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_02_10_54_seed_1_22769261
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.9195964, 'precision': 0.9203806, 'recall': 0.9198861, 'specificity': 0.9198861, 'f1': 0.91958463, 'auroc': 0.9740311, 'binary_precision': 0.9418919, 'binary_recall': 0.89646304, 'binary_specificity': 0.9433092, 'binary_f1_score': 0.9186161}
confusion matrix:
      0     1
0  1431    86
1   161  1394
---- Validation: 
scalar performance:
{'acc': 0.7962529, 'precision': 0.8104094, 'recall': 0.7944701, 'specificity': 0.7944701, 'f1': 0.79318583, 'auroc': 0.8658303, 'binary_precision': 0.8727273, 'binary_recall': 0.6857143, 'binary_specificity': 0.9032258, 'binary_f1_score': 0.768}
confusion matrix:
     0    1
0  588   63
1  198  432
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.83555555, 'precision': 0.8394174, 'recall': 0.83555555, 'specificity': 0.83555555, 'f1': 0.8350865, 'auroc': 0.9128691, 'binary_precision': 0.8756219, 'binary_recall': 0.7822222, 'binary_specificity': 0.8888889, 'binary_f1_score': 0.82629114}
confusion matrix:
     0    1
0  200   25
1   49  176
early stop counter: 2
val acc:0.7962529063224792, best validation acc: 0.8087431788444519, corresponding to test acc:                         0.8333333134651184 / 0.8355555534362793
after epoch: 28,now: 2024-07-23 03:14:44.764806,epoch time: 0:02:08.960202,used: 1:03:50.324274,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_02_10_54_seed_1_22769261
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9199219, 'precision': 0.920568, 'recall': 0.92021847, 'specificity': 0.92021847, 'f1': 0.9199152, 'auroc': 0.9748619, 'binary_precision': 0.94082046, 'binary_recall': 0.8985228, 'binary_specificity': 0.9419142, 'binary_f1_score': 0.9191852}
confusion matrix:
      0     1
0  1427    88
1   158  1399
---- Validation: 
scalar performance:
{'acc': 0.8071819, 'precision': 0.8177761, 'recall': 0.805658, 'specificity': 0.805658, 'f1': 0.80498374, 'auroc': 0.865945, 'binary_precision': 0.87184465, 'binary_recall': 0.7126984, 'binary_specificity': 0.8986175, 'binary_f1_score': 0.78427947}
confusion matrix:
     0    1
0  585   66
1  181  449
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.83555555, 'precision': 0.83771694, 'recall': 0.83555555, 'specificity': 0.83555555, 'f1': 0.83529204, 'auroc': 0.9132049, 'binary_precision': 0.8647343, 'binary_recall': 0.79555553, 'binary_specificity': 0.8755556, 'binary_f1_score': 0.82870376}
confusion matrix:
     0    1
0  197   28
1   46  179
early stop counter: 3
val acc:0.8071818947792053, best validation acc: 0.8087431788444519, corresponding to test acc:                         0.8333333134651184 / 0.8355555534362793
after epoch: 29,now: 2024-07-23 03:16:53.348869,epoch time: 0:02:08.584063,used: 1:05:58.908337,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_02_10_54_seed_1_22769261
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.9160156, 'precision': 0.91762066, 'recall': 0.9164423, 'specificity': 0.9164423, 'f1': 0.91597915, 'auroc': 0.9744677, 'binary_precision': 0.9469697, 'binary_recall': 0.8836761, 'binary_specificity': 0.94920844, 'binary_f1_score': 0.9142287}
confusion matrix:
      0     1
0  1439    77
1   181  1375
---- Validation: 
scalar performance:
{'acc': 0.79313034, 'precision': 0.80844873, 'recall': 0.79126984, 'specificity': 0.79126984, 'f1': 0.7897681, 'auroc': 0.8661547, 'binary_precision': 0.8732106, 'binary_recall': 0.67777777, 'binary_specificity': 0.9047619, 'binary_f1_score': 0.7631813}
confusion matrix:
     0    1
0  589   62
1  203  427
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8377778, 'precision': 0.8427128, 'recall': 0.8377778, 'specificity': 0.8377778, 'f1': 0.8371917, 'auroc': 0.91251355, 'binary_precision': 0.88383836, 'binary_recall': 0.7777778, 'binary_specificity': 0.8977778, 'binary_f1_score': 0.8274232}
confusion matrix:
     0    1
0  202   23
1   50  175
new oracle model saved
early stop counter: 4
val acc:0.7931303381919861, best validation acc: 0.8087431788444519, corresponding to test acc:                         0.8333333134651184 / 0.8377777934074402
after epoch: 30,now: 2024-07-23 03:19:01.417860,epoch time: 0:02:08.068991,used: 1:08:06.977328,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_02_10_54_seed_1_22769261
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 1:08:06.977328 at 2024-07-23 03:19:01.417860
persisted model performance metric: 

scalar performance:
{'acc': 0.8333333, 'precision': 0.83482146, 'recall': 0.8333334, 'specificity': 0.8333334, 'f1': 0.83314794, 'auroc': 0.9123161, 'binary_precision': 0.85714287, 'binary_recall': 0.8, 'binary_specificity': 0.8666667, 'binary_f1_score': 0.82758623}
confusion matrix:
     0    1
0  195   30
1   45  180
oracle model performance metric: 

scalar performance:
{'acc': 0.8377778, 'precision': 0.8427128, 'recall': 0.8377778, 'specificity': 0.8377778, 'f1': 0.8371917, 'auroc': 0.91251355, 'binary_precision': 0.88383836, 'binary_recall': 0.7777778, 'binary_specificity': 0.8977778, 'binary_f1_score': 0.8274232}
confusion matrix:
     0    1
0  202   23
1   50  175
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_dial_lr1e5_bs16_allfreeze_2024-07-22_23-46-53/rule_results/6.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_dial_lr1e5_bs16_allfreeze_2024-07-22_23-46-53/confusion_matrix/6.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 189842 KiB |   2147 MiB | 269659 GiB | 269659 GiB |
|       from large pool | 173454 KiB |   2130 MiB | 265869 GiB | 265869 GiB |
|       from small pool |  16388 KiB |     36 MiB |   3790 GiB |   3790 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 189842 KiB |   2147 MiB | 269659 GiB | 269659 GiB |
|       from large pool | 173454 KiB |   2130 MiB | 265869 GiB | 265869 GiB |
|       from small pool |  16388 KiB |     36 MiB |   3790 GiB |   3790 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 189010 KiB |   2146 MiB | 269649 GiB | 269649 GiB |
|       from large pool | 172814 KiB |   2128 MiB | 265863 GiB | 265863 GiB |
|       from small pool |  16196 KiB |     36 MiB |   3785 GiB |   3785 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2898 MiB |   2916 MiB |   5574 MiB |   2676 MiB |
|       from large pool |   2856 MiB |   2878 MiB |   5514 MiB |   2658 MiB |
|       from small pool |     42 MiB |     42 MiB |     60 MiB |     18 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  37485 KiB | 233525 KiB | 141564 GiB | 141564 GiB |
|       from large pool |  31346 KiB | 232732 KiB | 137679 GiB | 137679 GiB |
|       from small pool |   6139 KiB |   9295 KiB |   3885 GiB |   3885 GiB |
|---------------------------------------------------------------------------|
| Allocations           |     788    |    1159    |   38088 K  |   38087 K  |
|       from large pool |      76    |     251    |   23896 K  |   23896 K  |
|       from small pool |     712    |    1008    |   14192 K  |   14191 K  |
|---------------------------------------------------------------------------|
| Active allocs         |     788    |    1159    |   38088 K  |   38087 K  |
|       from large pool |      76    |     251    |   23896 K  |   23896 K  |
|       from small pool |     712    |    1008    |   14192 K  |   14191 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     118    |     118    |     215    |      97    |
|       from large pool |      97    |      99    |     185    |      88    |
|       from small pool |      21    |      21    |      30    |       9    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      34    |     219    |   26265 K  |   26265 K  |
|       from large pool |      10    |      99    |   17698 K  |   17698 K  |
|       from small pool |      24    |     208    |    8566 K  |    8566 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   2147 MiB | 269659 GiB | 269659 GiB |
|       from large pool |  16640 KiB |   2130 MiB | 265869 GiB | 265869 GiB |
|       from small pool |      0 KiB |     36 MiB |   3790 GiB |   3790 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   2147 MiB | 269659 GiB | 269659 GiB |
|       from large pool |  16640 KiB |   2130 MiB | 265869 GiB | 265869 GiB |
|       from small pool |      0 KiB |     36 MiB |   3790 GiB |   3790 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   2146 MiB | 269649 GiB | 269649 GiB |
|       from large pool |  16640 KiB |   2128 MiB | 265863 GiB | 265863 GiB |
|       from small pool |      0 KiB |     36 MiB |   3785 GiB |   3785 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 227328 KiB |   2916 MiB |   5574 MiB |   5352 MiB |
|       from large pool | 204800 KiB |   2878 MiB |   5514 MiB |   5314 MiB |
|       from small pool |  22528 KiB |     42 MiB |     60 MiB |     38 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 233525 KiB | 141565 GiB | 141564 GiB |
|       from large pool |  24320 KiB | 232732 KiB | 137679 GiB | 137679 GiB |
|       from small pool |      0 KiB |  11190 KiB |   3885 GiB |   3885 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    1159    |   38088 K  |   38088 K  |
|       from large pool |       2    |     251    |   23896 K  |   23896 K  |
|       from small pool |       0    |    1008    |   14192 K  |   14192 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    1159    |   38088 K  |   38088 K  |
|       from large pool |       2    |     251    |   23896 K  |   23896 K  |
|       from small pool |       0    |    1008    |   14192 K  |   14192 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      21    |     118    |     215    |     194    |
|       from large pool |      10    |      99    |     185    |     175    |
|       from small pool |      11    |      21    |      30    |      19    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |     219    |   26265 K  |   26265 K  |
|       from large pool |       4    |      99    |   17698 K  |   17698 K  |
|       from small pool |       0    |     208    |    8567 K  |    8567 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   2147 MiB | 269659 GiB | 269659 GiB |
|       from large pool |  16640 KiB |   2130 MiB | 265869 GiB | 265869 GiB |
|       from small pool |      0 KiB |     36 MiB |   3790 GiB |   3790 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   2147 MiB | 269659 GiB | 269659 GiB |
|       from large pool |  16640 KiB |   2130 MiB | 265869 GiB | 265869 GiB |
|       from small pool |      0 KiB |     36 MiB |   3790 GiB |   3790 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   2146 MiB | 269649 GiB | 269649 GiB |
|       from large pool |  16640 KiB |   2128 MiB | 265863 GiB | 265863 GiB |
|       from small pool |      0 KiB |     36 MiB |   3785 GiB |   3785 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 227328 KiB |   2916 MiB |   5574 MiB |   5352 MiB |
|       from large pool | 204800 KiB |   2878 MiB |   5514 MiB |   5314 MiB |
|       from small pool |  22528 KiB |     42 MiB |     60 MiB |     38 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 233525 KiB | 141565 GiB | 141564 GiB |
|       from large pool |  24320 KiB | 232732 KiB | 137679 GiB | 137679 GiB |
|       from small pool |      0 KiB |  11190 KiB |   3885 GiB |   3885 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    1159    |   38088 K  |   38088 K  |
|       from large pool |       2    |     251    |   23896 K  |   23896 K  |
|       from small pool |       0    |    1008    |   14192 K  |   14192 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    1159    |   38088 K  |   38088 K  |
|       from large pool |       2    |     251    |   23896 K  |   23896 K  |
|       from small pool |       0    |    1008    |   14192 K  |   14192 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      21    |     118    |     215    |     194    |
|       from large pool |      10    |      99    |     185    |     175    |
|       from small pool |      11    |      21    |      30    |      19    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |     219    |   26265 K  |   26265 K  |
|       from large pool |       4    |      99    |   17698 K  |   17698 K  |
|       from small pool |       0    |     208    |    8567 K  |    8567 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'888c1ef2'
model name: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_03_20_24_seed_2_22769261

 Experiment start at: 2024-07-23 03:20:24.515411
before training, model accuracy: 0.41203704476356506
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.65183246, 'precision': 0.6518096, 'recall': 0.651775, 'specificity': 0.651775, 'f1': 0.6517786, 'auroc': 0.70962286, 'binary_precision': 0.6531532, 'binary_recall': 0.65909094, 'binary_specificity': 0.6444591, 'binary_f1_score': 0.65610856}
confusion matrix:
     0     1
0  977   539
1  525  1015
---- Validation: 
scalar performance:
{'acc': 0.6596244, 'precision': 0.66258764, 'recall': 0.6610707, 'specificity': 0.6610707, 'f1': 0.6591635, 'auroc': 0.7175632, 'binary_precision': 0.63300145, 'binary_recall': 0.7154341, 'binary_specificity': 0.60670733, 'binary_f1_score': 0.67169815}
confusion matrix:
     0    1
0  398  258
1  177  445
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.4537037, 'precision': 0.44827092, 'recall': 0.4537037, 'specificity': 0.4537037, 'f1': 0.43897337, 'auroc': 0.4104724, 'binary_precision': 0.46503496, 'binary_recall': 0.6157407, 'binary_specificity': 0.29166666, 'binary_f1_score': 0.5298804}
confusion matrix:
    0    1
0  63  153
1  83  133
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-23 03:22:33.557448,epoch time: 0:02:09.042037,used: 0:02:09.042037,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_03_20_24_seed_2_22769261
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.7372382, 'precision': 0.73730373, 'recall': 0.73714745, 'specificity': 0.73714745, 'f1': 0.73715913, 'auroc': 0.8219267, 'binary_precision': 0.734863, 'binary_recall': 0.7487013, 'binary_specificity': 0.7255937, 'binary_f1_score': 0.7417176}
confusion matrix:
      0     1
0  1100   416
1   387  1153
---- Validation: 
scalar performance:
{'acc': 0.68466353, 'precision': 0.6860033, 'recall': 0.68554425, 'specificity': 0.68554425, 'f1': 0.6845938, 'auroc': 0.7508529, 'binary_precision': 0.6622222, 'binary_recall': 0.7186495, 'binary_specificity': 0.652439, 'binary_f1_score': 0.6892829}
confusion matrix:
     0    1
0  428  228
1  175  447
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5277778, 'precision': 0.5308336, 'recall': 0.5277778, 'specificity': 0.5277778, 'f1': 0.5157802, 'auroc': 0.52134776, 'binary_precision': 0.52112675, 'binary_recall': 0.6851852, 'binary_specificity': 0.37037036, 'binary_f1_score': 0.592}
confusion matrix:
    0    1
0  80  136
1  68  148
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-07-23 03:24:40.171723,epoch time: 0:02:06.614275,used: 0:04:15.656312,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_03_20_24_seed_2_22769261
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.7902487, 'precision': 0.79049104, 'recall': 0.7903565, 'specificity': 0.7903565, 'f1': 0.79023683, 'auroc': 0.8688873, 'binary_precision': 0.80107164, 'binary_recall': 0.77662337, 'binary_specificity': 0.8040897, 'binary_f1_score': 0.788658}
confusion matrix:
      0     1
0  1219   297
1   344  1196
---- Validation: 
scalar performance:
{'acc': 0.70109546, 'precision': 0.70097387, 'recall': 0.70109206, 'specificity': 0.70109206, 'f1': 0.70098996, 'auroc': 0.7701994, 'binary_precision': 0.6898734, 'binary_recall': 0.7009646, 'binary_specificity': 0.7012195, 'binary_f1_score': 0.6953748}
confusion matrix:
     0    1
0  460  196
1  186  436
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5902778, 'precision': 0.5960613, 'recall': 0.5902778, 'specificity': 0.5902778, 'f1': 0.58401656, 'auroc': 0.59840107, 'binary_precision': 0.5724907, 'binary_recall': 0.712963, 'binary_specificity': 0.4675926, 'binary_f1_score': 0.63505155}
confusion matrix:
     0    1
0  101  115
1   62  154
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-07-23 03:26:46.058175,epoch time: 0:02:05.886452,used: 0:06:21.542764,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_03_20_24_seed_2_22769261
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.83311516, 'precision': 0.83312774, 'recall': 0.8330792, 'specificity': 0.8330792, 'f1': 0.8330945, 'auroc': 0.90718615, 'binary_precision': 0.83225805, 'binary_recall': 0.83766234, 'binary_specificity': 0.82849604, 'binary_f1_score': 0.83495146}
confusion matrix:
      0     1
0  1256   260
1   250  1290
---- Validation: 
scalar performance:
{'acc': 0.71283257, 'precision': 0.712658, 'recall': 0.7124, 'specificity': 0.7124, 'f1': 0.712476, 'auroc': 0.78113484, 'binary_precision': 0.7086743, 'binary_recall': 0.6961415, 'binary_specificity': 0.72865856, 'binary_f1_score': 0.702352}
confusion matrix:
     0    1
0  478  178
1  189  433
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6087963, 'precision': 0.6132859, 'recall': 0.6087963, 'specificity': 0.6087963, 'f1': 0.60488164, 'auroc': 0.64662635, 'binary_precision': 0.5907336, 'binary_recall': 0.7083333, 'binary_specificity': 0.5092593, 'binary_f1_score': 0.6442105}
confusion matrix:
     0    1
0  110  106
1   63  153
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-07-23 03:28:51.696010,epoch time: 0:02:05.637835,used: 0:08:27.180599,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_03_20_24_seed_2_22769261
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.83933246, 'precision': 0.8394182, 'recall': 0.8393971, 'specificity': 0.8393971, 'f1': 0.839332, 'auroc': 0.9162303, 'binary_precision': 0.8471211, 'binary_recall': 0.83116883, 'binary_specificity': 0.8476253, 'binary_f1_score': 0.8390692}
confusion matrix:
      0     1
0  1285   231
1   260  1280
---- Validation: 
scalar performance:
{'acc': 0.7230047, 'precision': 0.72418225, 'recall': 0.7217252, 'specificity': 0.7217252, 'f1': 0.72174466, 'auroc': 0.7881612, 'binary_precision': 0.7350877, 'binary_recall': 0.67363346, 'binary_specificity': 0.76981705, 'binary_f1_score': 0.7030201}
confusion matrix:
     0    1
0  505  151
1  203  419
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.650463, 'precision': 0.65218854, 'recall': 0.650463, 'specificity': 0.650463, 'f1': 0.6494694, 'auroc': 0.68167007, 'binary_precision': 0.6359833, 'binary_recall': 0.7037037, 'binary_specificity': 0.5972222, 'binary_f1_score': 0.6681319}
confusion matrix:
     0    1
0  129   87
1   64  152
new oracle model saved
better model found
persisted
after epoch: 5,now: 2024-07-23 03:30:57.869109,epoch time: 0:02:06.173099,used: 0:10:33.353698,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_03_20_24_seed_2_22769261
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.84522253, 'precision': 0.8452201, 'recall': 0.8452412, 'specificity': 0.8452412, 'f1': 0.84521973, 'auroc': 0.92135274, 'binary_precision': 0.8489209, 'binary_recall': 0.8428571, 'binary_specificity': 0.8476253, 'binary_f1_score': 0.8458782}
confusion matrix:
      0     1
0  1285   231
1   242  1298
---- Validation: 
scalar performance:
{'acc': 0.7230047, 'precision': 0.72429574, 'recall': 0.7216836, 'specificity': 0.7216836, 'f1': 0.72168505, 'auroc': 0.79615813, 'binary_precision': 0.7359155, 'binary_recall': 0.67202574, 'binary_specificity': 0.77134144, 'binary_f1_score': 0.70252097}
confusion matrix:
     0    1
0  506  150
1  204  418
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.662037, 'precision': 0.6637356, 'recall': 0.662037, 'specificity': 0.662037, 'f1': 0.66115826, 'auroc': 0.71159124, 'binary_precision': 0.64705884, 'binary_recall': 0.712963, 'binary_specificity': 0.6111111, 'binary_f1_score': 0.6784141}
confusion matrix:
     0    1
0  132   84
1   62  154
new oracle model saved
early stop counter: 1
val acc:0.7230046987533569, best validation acc: 0.7230046987533569, corresponding to test acc:                         0.6504629850387573 / 0.6620370149612427
after epoch: 6,now: 2024-07-23 03:33:04.603260,epoch time: 0:02:06.734151,used: 0:12:40.087849,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_03_20_24_seed_2_22769261
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.8599476, 'precision': 0.8599398, 'recall': 0.85995954, 'specificity': 0.85995954, 'f1': 0.85994387, 'auroc': 0.9316267, 'binary_precision': 0.8629243, 'binary_recall': 0.85844153, 'binary_specificity': 0.86147755, 'binary_f1_score': 0.86067706}
confusion matrix:
      0     1
0  1306   210
1   218  1322
---- Validation: 
scalar performance:
{'acc': 0.7261346, 'precision': 0.72840667, 'recall': 0.7245241, 'specificity': 0.7245241, 'f1': 0.7243788, 'auroc': 0.80359626, 'binary_precision': 0.7454874, 'binary_recall': 0.66398716, 'binary_specificity': 0.785061, 'binary_f1_score': 0.70238096}
confusion matrix:
     0    1
0  515  141
1  209  413
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6736111, 'precision': 0.6752678, 'recall': 0.6736111, 'specificity': 0.6736111, 'f1': 0.67283803, 'auroc': 0.7390475, 'binary_precision': 0.65822786, 'binary_recall': 0.7222222, 'binary_specificity': 0.625, 'binary_f1_score': 0.68874174}
confusion matrix:
     0    1
0  135   81
1   60  156
new oracle model saved
better model found
persisted
after epoch: 7,now: 2024-07-23 03:35:10.948803,epoch time: 0:02:06.345543,used: 0:14:46.433392,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_03_20_24_seed_2_22769261
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.8668194, 'precision': 0.86698186, 'recall': 0.8669062, 'specificity': 0.8669062, 'f1': 0.866817, 'auroc': 0.9389919, 'binary_precision': 0.87691283, 'binary_recall': 0.85584414, 'binary_specificity': 0.8779683, 'binary_f1_score': 0.86625046}
confusion matrix:
      0     1
0  1331   185
1   222  1318
---- Validation: 
scalar performance:
{'acc': 0.73552424, 'precision': 0.7416709, 'recall': 0.7331704, 'specificity': 0.7331704, 'f1': 0.7324041, 'auroc': 0.8083116, 'binary_precision': 0.7741313, 'binary_recall': 0.6446945, 'binary_specificity': 0.82164633, 'binary_f1_score': 0.70350873}
confusion matrix:
     0    1
0  539  117
1  221  401
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7013889, 'precision': 0.70139325, 'recall': 0.7013889, 'specificity': 0.7013889, 'f1': 0.7013873, 'auroc': 0.7589592, 'binary_precision': 0.70046085, 'binary_recall': 0.7037037, 'binary_specificity': 0.6990741, 'binary_f1_score': 0.7020785}
confusion matrix:
     0    1
0  151   65
1   64  152
new oracle model saved
better model found
persisted
after epoch: 8,now: 2024-07-23 03:37:16.399827,epoch time: 0:02:05.451024,used: 0:16:51.884416,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_03_20_24_seed_2_22769261
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.8710733, 'precision': 0.87163734, 'recall': 0.8712298, 'specificity': 0.8712298, 'f1': 0.87105125, 'auroc': 0.94202745, 'binary_precision': 0.88821137, 'binary_recall': 0.8512987, 'binary_specificity': 0.89116096, 'binary_f1_score': 0.8693634}
confusion matrix:
      0     1
0  1351   165
1   229  1311
---- Validation: 
scalar performance:
{'acc': 0.73865414, 'precision': 0.7451779, 'recall': 0.7362609, 'specificity': 0.7362609, 'f1': 0.7354798, 'auroc': 0.81280637, 'binary_precision': 0.7790698, 'binary_recall': 0.6463022, 'binary_specificity': 0.8262195, 'binary_f1_score': 0.7065026}
confusion matrix:
     0    1
0  542  114
1  220  402
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7083333, 'precision': 0.7083512, 'recall': 0.7083334, 'specificity': 0.7083334, 'f1': 0.70832705, 'auroc': 0.77427876, 'binary_precision': 0.71028036, 'binary_recall': 0.7037037, 'binary_specificity': 0.712963, 'binary_f1_score': 0.7069767}
confusion matrix:
     0    1
0  154   62
1   64  152
new oracle model saved
better model found
persisted
after epoch: 9,now: 2024-07-23 03:39:21.985080,epoch time: 0:02:05.585253,used: 0:18:57.469669,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_03_20_24_seed_2_22769261
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.8789267, 'precision': 0.8789576, 'recall': 0.8789706, 'specificity': 0.8789706, 'f1': 0.8789265, 'auroc': 0.94830847, 'binary_precision': 0.88486844, 'binary_recall': 0.8733766, 'binary_specificity': 0.88456464, 'binary_f1_score': 0.879085}
confusion matrix:
      0     1
0  1341   175
1   195  1345
---- Validation: 
scalar performance:
{'acc': 0.7425665, 'precision': 0.7493759, 'recall': 0.74015516, 'specificity': 0.74015516, 'f1': 0.7393943, 'auroc': 0.8175192, 'binary_precision': 0.784466, 'binary_recall': 0.64951766, 'binary_specificity': 0.83079267, 'binary_f1_score': 0.71064204}
confusion matrix:
     0    1
0  545  111
1  218  404
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.724537, 'precision': 0.72454184, 'recall': 0.724537, 'specificity': 0.724537, 'f1': 0.7245356, 'auroc': 0.78892314, 'binary_precision': 0.7235023, 'binary_recall': 0.7268519, 'binary_specificity': 0.7222222, 'binary_f1_score': 0.72517323}
confusion matrix:
     0    1
0  156   60
1   59  157
new oracle model saved
better model found
persisted
after epoch: 10,now: 2024-07-23 03:41:28.193324,epoch time: 0:02:06.208244,used: 0:21:03.677913,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_03_20_24_seed_2_22769261
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.8867801, 'precision': 0.8875319, 'recall': 0.8869581, 'specificity': 0.8869581, 'f1': 0.8867522, 'auroc': 0.9531354, 'binary_precision': 0.90667576, 'binary_recall': 0.8642857, 'binary_specificity': 0.9096306, 'binary_f1_score': 0.8849734}
confusion matrix:
      0     1
0  1379   137
1   209  1331
---- Validation: 
scalar performance:
{'acc': 0.74178404, 'precision': 0.752406, 'recall': 0.73885137, 'specificity': 0.73885137, 'f1': 0.7373527, 'auroc': 0.82039404, 'binary_precision': 0.7979592, 'binary_recall': 0.62861735, 'binary_specificity': 0.8490854, 'binary_f1_score': 0.70323735}
confusion matrix:
     0    1
0  557   99
1  231  391
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7268519, 'precision': 0.72733915, 'recall': 0.7268518, 'specificity': 0.7268518, 'f1': 0.72670543, 'auroc': 0.80330503, 'binary_precision': 0.7378641, 'binary_recall': 0.7037037, 'binary_specificity': 0.75, 'binary_f1_score': 0.7203792}
confusion matrix:
     0    1
0  162   54
1   64  152
new oracle model saved
early stop counter: 1
val acc:0.7417840361595154, best validation acc: 0.7425665259361267, corresponding to test acc:                         0.7245370149612427 / 0.7268518805503845
after epoch: 11,now: 2024-07-23 03:43:35.625292,epoch time: 0:02:07.431968,used: 0:23:11.109881,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_03_20_24_seed_2_22769261
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.88056284, 'precision': 0.8811576, 'recall': 0.8807225, 'specificity': 0.8807225, 'f1': 0.8805413, 'auroc': 0.9503281, 'binary_precision': 0.89830506, 'binary_recall': 0.8603896, 'binary_specificity': 0.9010554, 'binary_f1_score': 0.8789386}
confusion matrix:
      0     1
0  1366   150
1   215  1325
---- Validation: 
scalar performance:
{'acc': 0.7425665, 'precision': 0.7537609, 'recall': 0.7395719, 'specificity': 0.7395719, 'f1': 0.7379847, 'auroc': 0.8231266, 'binary_precision': 0.80082136, 'binary_recall': 0.62700963, 'binary_specificity': 0.85213417, 'binary_f1_score': 0.70333636}
confusion matrix:
     0    1
0  559   97
1  232  390
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7384259, 'precision': 0.73904586, 'recall': 0.73842597, 'specificity': 0.73842597, 'f1': 0.7382562, 'auroc': 0.8143861, 'binary_precision': 0.7512195, 'binary_recall': 0.712963, 'binary_specificity': 0.7638889, 'binary_f1_score': 0.73159146}
confusion matrix:
     0    1
0  165   51
1   62  154
new oracle model saved
early stop counter: 2
val acc:0.7425665259361267, best validation acc: 0.7425665259361267, corresponding to test acc:                         0.7245370149612427 / 0.7384259104728699
after epoch: 12,now: 2024-07-23 03:45:42.965298,epoch time: 0:02:07.340006,used: 0:25:18.449887,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_03_20_24_seed_2_22769261
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.8763089, 'precision': 0.8788716, 'recall': 0.8766354, 'specificity': 0.8766354, 'f1': 0.8761599, 'auroc': 0.94975626, 'binary_precision': 0.91205674, 'binary_recall': 0.83506495, 'binary_specificity': 0.9182058, 'binary_f1_score': 0.8718644}
confusion matrix:
      0     1
0  1392   124
1   254  1286
---- Validation: 
scalar performance:
{'acc': 0.7300469, 'precision': 0.74848366, 'recall': 0.72621024, 'specificity': 0.72621024, 'f1': 0.72262883, 'auroc': 0.8247147, 'binary_precision': 0.8098434, 'binary_recall': 0.5819936, 'binary_specificity': 0.87042683, 'binary_f1_score': 0.6772685}
confusion matrix:
     0    1
0  571   85
1  260  362
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7361111, 'precision': 0.7407553, 'recall': 0.73611116, 'specificity': 0.73611116, 'f1': 0.7348323, 'auroc': 0.82141626, 'binary_precision': 0.7741935, 'binary_recall': 0.6666667, 'binary_specificity': 0.8055556, 'binary_f1_score': 0.71641785}
confusion matrix:
     0    1
0  174   42
1   72  144
early stop counter: 3
val acc:0.7300469279289246, best validation acc: 0.7425665259361267, corresponding to test acc:                         0.7245370149612427 / 0.7384259104728699
after epoch: 13,now: 2024-07-23 03:47:49.916073,epoch time: 0:02:06.950775,used: 0:27:25.400662,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_03_20_24_seed_2_22769261
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.88579845, 'precision': 0.885796, 'recall': 0.8858197, 'specificity': 0.8858197, 'f1': 0.8857964, 'auroc': 0.9537034, 'binary_precision': 0.8894702, 'binary_recall': 0.8831169, 'binary_specificity': 0.88852245, 'binary_f1_score': 0.8862822}
confusion matrix:
      0     1
0  1347   169
1   180  1360
---- Validation: 
scalar performance:
{'acc': 0.74491394, 'precision': 0.7534145, 'recall': 0.7422751, 'specificity': 0.7422751, 'f1': 0.74125373, 'auroc': 0.82849634, 'binary_precision': 0.7936508, 'binary_recall': 0.6430868, 'binary_specificity': 0.8414634, 'binary_f1_score': 0.7104796}
confusion matrix:
     0    1
0  552  104
1  222  400
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7615741, 'precision': 0.7616246, 'recall': 0.76157403, 'specificity': 0.76157403, 'f1': 0.7615626, 'auroc': 0.8305255, 'binary_precision': 0.7579909, 'binary_recall': 0.7685185, 'binary_specificity': 0.7546296, 'binary_f1_score': 0.7632184}
confusion matrix:
     0    1
0  163   53
1   50  166
new oracle model saved
better model found
persisted
after epoch: 14,now: 2024-07-23 03:49:57.051508,epoch time: 0:02:07.135435,used: 0:29:32.536097,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_03_20_24_seed_2_22769261
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.88448954, 'precision': 0.8856113, 'recall': 0.884706, 'specificity': 0.884706, 'f1': 0.8844404, 'auroc': 0.9559487, 'binary_precision': 0.90846527, 'binary_recall': 0.85714287, 'binary_specificity': 0.9122691, 'binary_f1_score': 0.88205814}
confusion matrix:
      0     1
0  1383   133
1   220  1320
---- Validation: 
scalar performance:
{'acc': 0.74882627, 'precision': 0.76152647, 'recall': 0.7457111, 'specificity': 0.7457111, 'f1': 0.74402666, 'auroc': 0.830577, 'binary_precision': 0.8128898, 'binary_recall': 0.62861735, 'binary_specificity': 0.8628049, 'binary_f1_score': 0.70897555}
confusion matrix:
     0    1
0  566   90
1  231  391
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7546296, 'precision': 0.75541794, 'recall': 0.7546296, 'specificity': 0.7546296, 'f1': 0.7544401, 'auroc': 0.84010637, 'binary_precision': 0.76960784, 'binary_recall': 0.7268519, 'binary_specificity': 0.7824074, 'binary_f1_score': 0.74761903}
confusion matrix:
     0    1
0  169   47
1   59  157
better model found
persisted
after epoch: 15,now: 2024-07-23 03:52:02.493521,epoch time: 0:02:05.442013,used: 0:31:37.978110,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_03_20_24_seed_2_22769261
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.89757854, 'precision': 0.8987891, 'recall': 0.8978009, 'specificity': 0.8978009, 'f1': 0.89753217, 'auroc': 0.9595646, 'binary_precision': 0.92281187, 'binary_recall': 0.8694805, 'binary_specificity': 0.92612135, 'binary_f1_score': 0.8953527}
confusion matrix:
      0     1
0  1404   112
1   201  1339
---- Validation: 
scalar performance:
{'acc': 0.74491394, 'precision': 0.76264566, 'recall': 0.7412752, 'specificity': 0.7412752, 'f1': 0.73850983, 'auroc': 0.83181953, 'binary_precision': 0.8245614, 'binary_recall': 0.6045016, 'binary_specificity': 0.8780488, 'binary_f1_score': 0.6975881}
confusion matrix:
     0    1
0  576   80
1  246  376
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7592593, 'precision': 0.7610723, 'recall': 0.7592592, 'specificity': 0.7592592, 'f1': 0.75884056, 'auroc': 0.84456444, 'binary_precision': 0.7828283, 'binary_recall': 0.7175926, 'binary_specificity': 0.8009259, 'binary_f1_score': 0.7487923}
confusion matrix:
     0    1
0  173   43
1   61  155
early stop counter: 1
val acc:0.7449139356613159, best validation acc: 0.748826265335083, corresponding to test acc:                         0.7546296119689941 / 0.7615740895271301
after epoch: 16,now: 2024-07-23 03:54:07.743489,epoch time: 0:02:05.249968,used: 0:33:43.228078,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_03_20_24_seed_2_22769261
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.8929974, 'precision': 0.89360714, 'recall': 0.89315784, 'specificity': 0.89315784, 'f1': 0.89297813, 'auroc': 0.95899796, 'binary_precision': 0.91118646, 'binary_recall': 0.8727273, 'binary_specificity': 0.9135884, 'binary_f1_score': 0.8915423}
confusion matrix:
      0     1
0  1385   131
1   196  1344
---- Validation: 
scalar performance:
{'acc': 0.75195616, 'precision': 0.7652559, 'recall': 0.7488016, 'specificity': 0.7488016, 'f1': 0.74710524, 'auroc': 0.83600307, 'binary_precision': 0.8183716, 'binary_recall': 0.63022506, 'binary_specificity': 0.86737806, 'binary_f1_score': 0.7120799}
confusion matrix:
     0    1
0  569   87
1  230  392
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7638889, 'precision': 0.76500213, 'recall': 0.7638889, 'specificity': 0.7638889, 'f1': 0.76364064, 'auroc': 0.8525163, 'binary_precision': 0.7821782, 'binary_recall': 0.7314815, 'binary_specificity': 0.7962963, 'binary_f1_score': 0.7559809}
confusion matrix:
     0    1
0  172   44
1   58  158
new oracle model saved
better model found
persisted
after epoch: 17,now: 2024-07-23 03:56:13.909723,epoch time: 0:02:06.166234,used: 0:35:49.394312,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_03_20_24_seed_2_22769261
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.8900524, 'precision': 0.8907644, 'recall': 0.89022547, 'specificity': 0.89022547, 'f1': 0.8900274, 'auroc': 0.95780766, 'binary_precision': 0.9095238, 'binary_recall': 0.8681818, 'binary_specificity': 0.9122691, 'binary_f1_score': 0.88837206}
confusion matrix:
      0     1
0  1383   133
1   203  1337
---- Validation: 
scalar performance:
{'acc': 0.75195616, 'precision': 0.76486015, 'recall': 0.7488432, 'specificity': 0.7488432, 'f1': 0.74721634, 'auroc': 0.8378093, 'binary_precision': 0.81704783, 'binary_recall': 0.6318328, 'binary_specificity': 0.86585367, 'binary_f1_score': 0.71260196}
confusion matrix:
     0    1
0  568   88
1  229  393
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7731481, 'precision': 0.77373487, 'recall': 0.7731482, 'specificity': 0.7731482, 'f1': 0.7730266, 'auroc': 0.8580247, 'binary_precision': 0.78640777, 'binary_recall': 0.75, 'binary_specificity': 0.7962963, 'binary_f1_score': 0.76777256}
confusion matrix:
     0    1
0  172   44
1   54  162
new oracle model saved
early stop counter: 1
val acc:0.7519561648368835, best validation acc: 0.7519561648368835, corresponding to test acc:                         0.7638888955116272 / 0.7731481194496155
after epoch: 18,now: 2024-07-23 03:58:19.516314,epoch time: 0:02:05.606591,used: 0:37:55.000903,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_03_20_24_seed_2_22769261
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.89267015, 'precision': 0.8949206, 'recall': 0.89297193, 'specificity': 0.89297193, 'f1': 0.89256406, 'auroc': 0.9560883, 'binary_precision': 0.92676055, 'binary_recall': 0.8545455, 'binary_specificity': 0.9313984, 'binary_f1_score': 0.8891892}
confusion matrix:
      0     1
0  1412   104
1   224  1316
---- Validation: 
scalar performance:
{'acc': 0.75352114, 'precision': 0.769464, 'recall': 0.75011766, 'specificity': 0.75011766, 'f1': 0.7480099, 'auroc': 0.8387872, 'binary_precision': 0.8286938, 'binary_recall': 0.6221865, 'binary_specificity': 0.8780488, 'binary_f1_score': 0.71074384}
confusion matrix:
     0    1
0  576   80
1  235  387
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.775463, 'precision': 0.7771799, 'recall': 0.775463, 'specificity': 0.775463, 'f1': 0.77511466, 'auroc': 0.8623543, 'binary_precision': 0.79899496, 'binary_recall': 0.7361111, 'binary_specificity': 0.8148148, 'binary_f1_score': 0.76626503}
confusion matrix:
     0    1
0  176   40
1   57  159
new oracle model saved
better model found
persisted
after epoch: 19,now: 2024-07-23 04:00:25.444960,epoch time: 0:02:05.928646,used: 0:40:00.929549,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_03_20_24_seed_2_22769261
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.89659685, 'precision': 0.89750814, 'recall': 0.896791, 'specificity': 0.896791, 'f1': 0.8965646, 'auroc': 0.9649111, 'binary_precision': 0.9186047, 'binary_recall': 0.87207794, 'binary_specificity': 0.92150396, 'binary_f1_score': 0.8947369}
confusion matrix:
      0     1
0  1397   119
1   197  1343
---- Validation: 
scalar performance:
{'acc': 0.7605634, 'precision': 0.77423245, 'recall': 0.7574357, 'specificity': 0.7574357, 'f1': 0.7559346, 'auroc': 0.84059584, 'binary_precision': 0.82916665, 'binary_recall': 0.63987136, 'binary_specificity': 0.875, 'binary_f1_score': 0.72232306}
confusion matrix:
     0    1
0  574   82
1  224  398
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7824074, 'precision': 0.7827953, 'recall': 0.7824074, 'specificity': 0.7824074, 'f1': 0.7823328, 'auroc': 0.86672664, 'binary_precision': 0.7932692, 'binary_recall': 0.7638889, 'binary_specificity': 0.8009259, 'binary_f1_score': 0.7783019}
confusion matrix:
     0    1
0  173   43
1   51  165
new oracle model saved
better model found
persisted
after epoch: 20,now: 2024-07-23 04:02:31.291975,epoch time: 0:02:05.847015,used: 0:42:06.776564,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_03_20_24_seed_2_22769261
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.90772253, 'precision': 0.9089887, 'recall': 0.90794814, 'specificity': 0.90794814, 'f1': 0.9076795, 'auroc': 0.96605945, 'binary_precision': 0.9337931, 'binary_recall': 0.8792208, 'binary_specificity': 0.9366755, 'binary_f1_score': 0.90568566}
confusion matrix:
      0     1
0  1420    96
1   186  1354
---- Validation: 
scalar performance:
{'acc': 0.7574335, 'precision': 0.7767819, 'recall': 0.75376195, 'specificity': 0.75376195, 'f1': 0.7512182, 'auroc': 0.8412281, 'binary_precision': 0.8436123, 'binary_recall': 0.6157556, 'binary_specificity': 0.8917683, 'binary_f1_score': 0.7118958}
confusion matrix:
     0    1
0  585   71
1  239  383
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.787037, 'precision': 0.790625, 'recall': 0.787037, 'specificity': 0.787037, 'f1': 0.78637767, 'auroc': 0.8706275, 'binary_precision': 0.8229167, 'binary_recall': 0.7314815, 'binary_specificity': 0.8425926, 'binary_f1_score': 0.7745098}
confusion matrix:
     0    1
0  182   34
1   58  158
new oracle model saved
early stop counter: 1
val acc:0.7574334740638733, best validation acc: 0.7605633735656738, corresponding to test acc:                         0.7824074029922485 / 0.7870370149612427
after epoch: 21,now: 2024-07-23 04:04:37.727861,epoch time: 0:02:06.435886,used: 0:44:13.212450,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_03_20_24_seed_2_22769261
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.904123, 'precision': 0.90483284, 'recall': 0.90429443, 'specificity': 0.90429443, 'f1': 0.9041022, 'auroc': 0.96229696, 'binary_precision': 0.9238613, 'binary_recall': 0.8824675, 'binary_specificity': 0.92612135, 'binary_f1_score': 0.9026901}
confusion matrix:
      0     1
0  1404   112
1   181  1359
---- Validation: 
scalar performance:
{'acc': 0.7605634, 'precision': 0.77423245, 'recall': 0.7574357, 'specificity': 0.7574357, 'f1': 0.7559346, 'auroc': 0.8421447, 'binary_precision': 0.82916665, 'binary_recall': 0.63987136, 'binary_specificity': 0.875, 'binary_f1_score': 0.72232306}
confusion matrix:
     0    1
0  574   82
1  224  398
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7847222, 'precision': 0.7857573, 'recall': 0.7847222, 'specificity': 0.7847222, 'f1': 0.78452706, 'auroc': 0.87377834, 'binary_precision': 0.8029557, 'binary_recall': 0.7546296, 'binary_specificity': 0.8148148, 'binary_f1_score': 0.778043}
confusion matrix:
     0    1
0  176   40
1   53  163
early stop counter: 2
val acc:0.7605633735656738, best validation acc: 0.7605633735656738, corresponding to test acc:                         0.7824074029922485 / 0.7870370149612427
after epoch: 22,now: 2024-07-23 04:06:42.847455,epoch time: 0:02:05.119594,used: 0:46:18.332044,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_03_20_24_seed_2_22769261
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.9021597, 'precision': 0.9042613, 'recall': 0.90244925, 'specificity': 0.90244925, 'f1': 0.9020729, 'auroc': 0.9648293, 'binary_precision': 0.9354386, 'binary_recall': 0.86558443, 'binary_specificity': 0.939314, 'binary_f1_score': 0.89915687}
confusion matrix:
      0     1
0  1424    92
1   207  1333
---- Validation: 
scalar performance:
{'acc': 0.76134586, 'precision': 0.78029543, 'recall': 0.75773954, 'specificity': 0.75773954, 'f1': 0.75541556, 'auroc': 0.842608, 'binary_precision': 0.84682715, 'binary_recall': 0.6221865, 'binary_specificity': 0.89329267, 'binary_f1_score': 0.7173308}
confusion matrix:
     0    1
0  586   70
1  235  387
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7962963, 'precision': 0.79940224, 'recall': 0.7962963, 'specificity': 0.7962963, 'f1': 0.7957666, 'auroc': 0.87613595, 'binary_precision': 0.8298969, 'binary_recall': 0.7453704, 'binary_specificity': 0.8472222, 'binary_f1_score': 0.7853659}
confusion matrix:
     0    1
0  183   33
1   55  161
new oracle model saved
better model found
persisted
after epoch: 23,now: 2024-07-23 04:08:48.196848,epoch time: 0:02:05.349393,used: 0:48:23.681437,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_03_20_24_seed_2_22769261
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9064136, 'precision': 0.9066221, 'recall': 0.90651065, 'specificity': 0.90651065, 'f1': 0.90641105, 'auroc': 0.9659288, 'binary_precision': 0.918, 'binary_recall': 0.89415586, 'binary_specificity': 0.91886544, 'binary_f1_score': 0.90592104}
confusion matrix:
      0     1
0  1393   123
1   163  1377
---- Validation: 
scalar performance:
{'acc': 0.7660407, 'precision': 0.77639365, 'recall': 0.7633127, 'specificity': 0.7633127, 'f1': 0.7624557, 'auroc': 0.8453063, 'binary_precision': 0.8236473, 'binary_recall': 0.6607717, 'binary_specificity': 0.86585367, 'binary_f1_score': 0.73327386}
confusion matrix:
     0    1
0  568   88
1  211  411
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7986111, 'precision': 0.7986175, 'recall': 0.7986111, 'specificity': 0.7986111, 'f1': 0.79861003, 'auroc': 0.87920094, 'binary_precision': 0.8, 'binary_recall': 0.7962963, 'binary_specificity': 0.8009259, 'binary_f1_score': 0.79814386}
confusion matrix:
     0    1
0  173   43
1   44  172
new oracle model saved
better model found
persisted
after epoch: 24,now: 2024-07-23 04:10:53.468589,epoch time: 0:02:05.271741,used: 0:50:28.953178,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_03_20_24_seed_2_22769261
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.90804976, 'precision': 0.90987825, 'recall': 0.90831906, 'specificity': 0.90831906, 'f1': 0.9079819, 'auroc': 0.969295, 'binary_precision': 0.9392882, 'binary_recall': 0.874026, 'binary_specificity': 0.9426121, 'binary_f1_score': 0.9054827}
confusion matrix:
      0     1
0  1429    87
1   194  1346
---- Validation: 
scalar performance:
{'acc': 0.7683881, 'precision': 0.78719836, 'recall': 0.7648493, 'specificity': 0.7648493, 'f1': 0.7628092, 'auroc': 0.8455317, 'binary_precision': 0.8543478, 'binary_recall': 0.6318328, 'binary_specificity': 0.89786583, 'binary_f1_score': 0.7264325}
confusion matrix:
     0    1
0  589   67
1  229  393
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7986111, 'precision': 0.8009396, 'recall': 0.7986111, 'specificity': 0.7986111, 'f1': 0.7982208, 'auroc': 0.88113, 'binary_precision': 0.8274112, 'binary_recall': 0.7546296, 'binary_specificity': 0.8425926, 'binary_f1_score': 0.7893463}
confusion matrix:
     0    1
0  182   34
1   53  163
better model found
persisted
after epoch: 25,now: 2024-07-23 04:12:59.640385,epoch time: 0:02:06.171796,used: 0:52:35.124974,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_03_20_24_seed_2_22769261
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9103403, 'precision': 0.911866, 'recall': 0.91058666, 'specificity': 0.91058666, 'f1': 0.91028774, 'auroc': 0.9692925, 'binary_precision': 0.93897367, 'binary_recall': 0.8792208, 'binary_specificity': 0.9419525, 'binary_f1_score': 0.9081154}
confusion matrix:
      0     1
0  1428    88
1   186  1354
---- Validation: 
scalar performance:
{'acc': 0.7668232, 'precision': 0.78755707, 'recall': 0.7631166, 'specificity': 0.7631166, 'f1': 0.76072645, 'auroc': 0.84648263, 'binary_precision': 0.8584071, 'binary_recall': 0.6237942, 'binary_specificity': 0.902439, 'binary_f1_score': 0.7225326}
confusion matrix:
     0    1
0  592   64
1  234  388
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8009259, 'precision': 0.80408037, 'recall': 0.80092597, 'specificity': 0.80092597, 'f1': 0.80040836, 'auroc': 0.88346624, 'binary_precision': 0.83505154, 'binary_recall': 0.75, 'binary_specificity': 0.8518519, 'binary_f1_score': 0.7902439}
confusion matrix:
     0    1
0  184   32
1   54  162
new oracle model saved
early stop counter: 1
val acc:0.7668231725692749, best validation acc: 0.7683880925178528, corresponding to test acc:                         0.7986111044883728 / 0.8009259104728699
after epoch: 26,now: 2024-07-23 04:15:06.738908,epoch time: 0:02:07.098523,used: 0:54:42.223497,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_03_20_24_seed_2_22769261
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.90772253, 'precision': 0.90876025, 'recall': 0.9079275, 'specificity': 0.9079275, 'f1': 0.9076893, 'auroc': 0.96922004, 'binary_precision': 0.9314129, 'binary_recall': 0.8818182, 'binary_specificity': 0.9340369, 'binary_f1_score': 0.9059373}
confusion matrix:
      0     1
0  1416   100
1   182  1358
---- Validation: 
scalar performance:
{'acc': 0.7668232, 'precision': 0.7886349, 'recall': 0.7630333, 'specificity': 0.7630333, 'f1': 0.7604785, 'auroc': 0.8472644, 'binary_precision': 0.86160713, 'binary_recall': 0.62057877, 'binary_specificity': 0.9054878, 'binary_f1_score': 0.72149533}
confusion matrix:
     0    1
0  594   62
1  236  386
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8032407, 'precision': 0.8067184, 'recall': 0.8032408, 'specificity': 0.8032408, 'f1': 0.8026814, 'auroc': 0.88603824, 'binary_precision': 0.83937824, 'binary_recall': 0.75, 'binary_specificity': 0.8564815, 'binary_f1_score': 0.792176}
confusion matrix:
     0    1
0  185   31
1   54  162
new oracle model saved
early stop counter: 2
val acc:0.7668231725692749, best validation acc: 0.7683880925178528, corresponding to test acc:                         0.7986111044883728 / 0.8032407164573669
after epoch: 27,now: 2024-07-23 04:17:13.102433,epoch time: 0:02:06.363525,used: 0:56:48.587022,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_03_20_24_seed_2_22769261
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.914267, 'precision': 0.91561186, 'recall': 0.9144982, 'specificity': 0.9144982, 'f1': 0.9142245, 'auroc': 0.9739814, 'binary_precision': 0.94129837, 'binary_recall': 0.88506496, 'binary_specificity': 0.9439314, 'binary_f1_score': 0.91231596}
confusion matrix:
      0     1
0  1431    85
1   177  1363
---- Validation: 
scalar performance:
{'acc': 0.773083, 'precision': 0.79031336, 'recall': 0.7697141, 'specificity': 0.7697141, 'f1': 0.7680639, 'auroc': 0.8475733, 'binary_precision': 0.85470086, 'binary_recall': 0.6430868, 'binary_specificity': 0.89634144, 'binary_f1_score': 0.73394495}
confusion matrix:
     0    1
0  588   68
1  222  400
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8078704, 'precision': 0.80898964, 'recall': 0.8078704, 'specificity': 0.8078704, 'f1': 0.8076962, 'auroc': 0.8871528, 'binary_precision': 0.82758623, 'binary_recall': 0.7777778, 'binary_specificity': 0.837963, 'binary_f1_score': 0.80190927}
confusion matrix:
     0    1
0  181   35
1   48  168
new oracle model saved
better model found
persisted
after epoch: 28,now: 2024-07-23 04:19:19.753156,epoch time: 0:02:06.650723,used: 0:58:55.237745,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_03_20_24_seed_2_22769261
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.91099477, 'precision': 0.9121516, 'recall': 0.9112103, 'specificity': 0.9112103, 'f1': 0.9109581, 'auroc': 0.9696566, 'binary_precision': 0.9360385, 'binary_recall': 0.88376623, 'binary_specificity': 0.93865436, 'binary_f1_score': 0.9091517}
confusion matrix:
      0     1
0  1423    93
1   179  1361
---- Validation: 
scalar performance:
{'acc': 0.7707355, 'precision': 0.7899998, 'recall': 0.7671776, 'specificity': 0.7671776, 'f1': 0.76515526, 'auroc': 0.84711003, 'binary_precision': 0.8583878, 'binary_recall': 0.6334405, 'binary_specificity': 0.9009146, 'binary_f1_score': 0.7289546}
confusion matrix:
     0    1
0  591   65
1  228  394
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8055556, 'precision': 0.8072414, 'recall': 0.8055556, 'specificity': 0.8055556, 'f1': 0.80528843, 'auroc': 0.88809586, 'binary_precision': 0.83, 'binary_recall': 0.7685185, 'binary_specificity': 0.8425926, 'binary_f1_score': 0.7980769}
confusion matrix:
     0    1
0  182   34
1   50  166
early stop counter: 1
val acc:0.770735502243042, best validation acc: 0.773082971572876, corresponding to test acc:                         0.8078703880310059 / 0.8078703880310059
after epoch: 29,now: 2024-07-23 04:21:25.907420,epoch time: 0:02:06.154264,used: 1:01:01.392009,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_03_20_24_seed_2_22769261
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.91590315, 'precision': 0.91627455, 'recall': 0.916029, 'specificity': 0.916029, 'f1': 0.9158966, 'auroc': 0.97147393, 'binary_precision': 0.93082607, 'binary_recall': 0.9, 'binary_specificity': 0.93205804, 'binary_f1_score': 0.9151535}
confusion matrix:
      0     1
0  1413   103
1   154  1386
---- Validation: 
scalar performance:
{'acc': 0.7746479, 'precision': 0.7845377, 'recall': 0.7720301, 'specificity': 0.7720301, 'f1': 0.77141434, 'auroc': 0.8509283, 'binary_precision': 0.8313492, 'binary_recall': 0.67363346, 'binary_specificity': 0.87042683, 'binary_f1_score': 0.7442273}
confusion matrix:
     0    1
0  571   85
1  203  419
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8009259, 'precision': 0.8009517, 'recall': 0.80092597, 'specificity': 0.80092597, 'f1': 0.8009217, 'auroc': 0.8909036, 'binary_precision': 0.79816514, 'binary_recall': 0.8055556, 'binary_specificity': 0.7962963, 'binary_f1_score': 0.80184335}
confusion matrix:
     0    1
0  172   44
1   42  174
better model found
persisted
after epoch: 30,now: 2024-07-23 04:23:32.057279,epoch time: 0:02:06.149859,used: 1:03:07.541868,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_03_20_24_seed_2_22769261
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 1:03:07.541868 at 2024-07-23 04:23:32.057279
persisted model performance metric: 

scalar performance:
{'acc': 0.8009259, 'precision': 0.8009517, 'recall': 0.80092597, 'specificity': 0.80092597, 'f1': 0.8009217, 'auroc': 0.8909036, 'binary_precision': 0.79816514, 'binary_recall': 0.8055556, 'binary_specificity': 0.7962963, 'binary_f1_score': 0.80184335}
confusion matrix:
     0    1
0  172   44
1   42  174
oracle model performance metric: 

scalar performance:
{'acc': 0.8078704, 'precision': 0.80898964, 'recall': 0.8078704, 'specificity': 0.8078704, 'f1': 0.8076962, 'auroc': 0.8871528, 'binary_precision': 0.82758623, 'binary_recall': 0.7777778, 'binary_specificity': 0.837963, 'binary_f1_score': 0.80190927}
confusion matrix:
     0    1
0  181   35
1   48  168
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_dial_lr1e5_bs16_allfreeze_2024-07-22_23-46-53/rule_results/6.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_dial_lr1e5_bs16_allfreeze_2024-07-22_23-46-53/confusion_matrix/6.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 189836 KiB |   2147 MiB | 403755 GiB | 403755 GiB |
|       from large pool | 173454 KiB |   2130 MiB | 398085 GiB | 398085 GiB |
|       from small pool |  16382 KiB |     36 MiB |   5670 GiB |   5670 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 189836 KiB |   2147 MiB | 403755 GiB | 403755 GiB |
|       from large pool | 173454 KiB |   2130 MiB | 398085 GiB | 398085 GiB |
|       from small pool |  16382 KiB |     36 MiB |   5670 GiB |   5670 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 189010 KiB |   2146 MiB | 403742 GiB | 403741 GiB |
|       from large pool | 172814 KiB |   2128 MiB | 398078 GiB | 398078 GiB |
|       from small pool |  16196 KiB |     36 MiB |   5663 GiB |   5663 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2894 MiB |   2916 MiB |   8246 MiB |   5352 MiB |
|       from large pool |   2856 MiB |   2878 MiB |   8170 MiB |   5314 MiB |
|       from small pool |     38 MiB |     42 MiB |     76 MiB |     38 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  37491 KiB | 233525 KiB | 211394 GiB | 211394 GiB |
|       from large pool |  31346 KiB | 232732 KiB | 205583 GiB | 205583 GiB |
|       from small pool |   6145 KiB |  11190 KiB |   5811 GiB |   5811 GiB |
|---------------------------------------------------------------------------|
| Allocations           |     776    |    1159    |   57007 K  |   57006 K  |
|       from large pool |      76    |     251    |   35777 K  |   35776 K  |
|       from small pool |     700    |    1008    |   21230 K  |   21229 K  |
|---------------------------------------------------------------------------|
| Active allocs         |     776    |    1159    |   57007 K  |   57006 K  |
|       from large pool |      76    |     251    |   35777 K  |   35776 K  |
|       from small pool |     700    |    1008    |   21230 K  |   21229 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     116    |     118    |     310    |     194    |
|       from large pool |      97    |      99    |     272    |     175    |
|       from small pool |      19    |      21    |      38    |      19    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      34    |     219    |   38999 K  |   38999 K  |
|       from large pool |      10    |      99    |   26198 K  |   26198 K  |
|       from small pool |      24    |     208    |   12801 K  |   12801 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   2147 MiB | 403755 GiB | 403755 GiB |
|       from large pool |  16640 KiB |   2130 MiB | 398085 GiB | 398085 GiB |
|       from small pool |      0 KiB |     36 MiB |   5670 GiB |   5670 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   2147 MiB | 403755 GiB | 403755 GiB |
|       from large pool |  16640 KiB |   2130 MiB | 398085 GiB | 398085 GiB |
|       from small pool |      0 KiB |     36 MiB |   5670 GiB |   5670 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   2146 MiB | 403742 GiB | 403742 GiB |
|       from large pool |  16640 KiB |   2128 MiB | 398078 GiB | 398078 GiB |
|       from small pool |      0 KiB |     36 MiB |   5663 GiB |   5663 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 227328 KiB |   2916 MiB |   8246 MiB |   8024 MiB |
|       from large pool | 204800 KiB |   2878 MiB |   8170 MiB |   7970 MiB |
|       from small pool |  22528 KiB |     42 MiB |     76 MiB |     54 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 233525 KiB | 211395 GiB | 211395 GiB |
|       from large pool |  24320 KiB | 232732 KiB | 205583 GiB | 205583 GiB |
|       from small pool |      0 KiB |  11196 KiB |   5811 GiB |   5811 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    1159    |   57007 K  |   57007 K  |
|       from large pool |       2    |     251    |   35777 K  |   35777 K  |
|       from small pool |       0    |    1008    |   21230 K  |   21230 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    1159    |   57007 K  |   57007 K  |
|       from large pool |       2    |     251    |   35777 K  |   35777 K  |
|       from small pool |       0    |    1008    |   21230 K  |   21230 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      21    |     118    |     310    |     289    |
|       from large pool |      10    |      99    |     272    |     262    |
|       from small pool |      11    |      21    |      38    |      27    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |     219    |   38999 K  |   38999 K  |
|       from large pool |       4    |      99    |   26198 K  |   26198 K  |
|       from small pool |       0    |     208    |   12801 K  |   12801 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Tue Jul 23 04:24:22 2024]
Finished job 0.
1 of 1 steps (100%) done
