Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Mon Jul 22 23:55:43 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_dial_lr1e5_bs16_allfreeze_2024-07-22_23-46-53/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_dial_lr1e5_bs16_allfreeze_2024-07-22_23-46-53/rule_results/4.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=4
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/swiglu_ffn.py:51: UserWarning: xFormers is not available (SwiGLU)
  warnings.warn("xFormers is not available (SwiGLU)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/attention.py:33: UserWarning: xFormers is not available (Attention)
  warnings.warn("xFormers is not available (Attention)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/block.py:40: UserWarning: xFormers is not available (Block)
  warnings.warn("xFormers is not available (Block)")
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'888c1ef2'
model name: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_22_23_56_28_seed_0_22769260

 Experiment start at: 2024-07-22 23:56:28.961662
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
before training, model accuracy: 0.569767415523529
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.45410156, 'precision': 0.45300674, 'recall': 0.45341596, 'specificity': 0.45341596, 'f1': 0.45248353, 'auroc': 0.45123816, 'binary_precision': 0.4646044, 'binary_recall': 0.5012837, 'binary_specificity': 0.40554821, 'binary_f1_score': 0.48224762}
confusion matrix:
     0    1
0  614  900
1  777  781
---- Validation: 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
scalar performance:
{'acc': 0.636646, 'precision': 0.63933134, 'recall': 0.63551146, 'specificity': 0.63551146, 'f1': 0.6336746, 'auroc': 0.69973594, 'binary_precision': 0.6554935, 'binary_recall': 0.5543307, 'binary_specificity': 0.7166922, 'binary_f1_score': 0.6006826}
confusion matrix:
     0    1
0  468  185
1  283  352
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6302326, 'precision': 0.63420725, 'recall': 0.6302326, 'specificity': 0.6302326, 'f1': 0.6274744, 'auroc': 0.6560519, 'binary_precision': 0.6573034, 'binary_recall': 0.54418606, 'binary_specificity': 0.7162791, 'binary_f1_score': 0.5954199}
confusion matrix:
     0    1
0  154   61
1   98  117
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-22 23:57:52.570388,epoch time: 0:01:23.608726,used: 0:01:23.608726,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_22_23_56_28_seed_0_22769260
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.5022786, 'precision': 0.50127524, 'recall': 0.50124633, 'specificity': 0.50124633, 'f1': 0.49887973, 'auroc': 0.5244218, 'binary_precision': 0.50791854, 'binary_recall': 0.57675016, 'binary_specificity': 0.42574257, 'binary_f1_score': 0.5401504}
confusion matrix:
     0    1
0  645  870
1  659  898
---- Validation: 
scalar performance:
{'acc': 0.6669255, 'precision': 0.66765606, 'recall': 0.66632867, 'specificity': 0.66632867, 'f1': 0.6660217, 'auroc': 0.71637386, 'binary_precision': 0.6757679, 'binary_recall': 0.62362206, 'binary_specificity': 0.7090352, 'binary_f1_score': 0.6486486}
confusion matrix:
     0    1
0  463  190
1  239  396
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6534884, 'precision': 0.654454, 'recall': 0.6534884, 'specificity': 0.6534884, 'f1': 0.6529459, 'auroc': 0.68093026, 'binary_precision': 0.6666667, 'binary_recall': 0.6139535, 'binary_specificity': 0.69302326, 'binary_f1_score': 0.6392252}
confusion matrix:
     0    1
0  149   66
1   83  132
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-07-22 23:59:12.462764,epoch time: 0:01:19.892376,used: 0:02:43.501102,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_22_23_56_28_seed_0_22769260
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.5286458, 'precision': 0.5281992, 'recall': 0.5279746, 'specificity': 0.5279746, 'f1': 0.52733135, 'auroc': 0.5499805, 'binary_precision': 0.53313434, 'binary_recall': 0.5728031, 'binary_specificity': 0.48314607, 'binary_f1_score': 0.55225724}
confusion matrix:
     0    1
0  731  782
1  666  893
---- Validation: 
scalar performance:
{'acc': 0.66925466, 'precision': 0.6709703, 'recall': 0.6684303, 'specificity': 0.6684303, 'f1': 0.6677035, 'auroc': 0.7298453, 'binary_precision': 0.6849558, 'binary_recall': 0.6094488, 'binary_specificity': 0.7274119, 'binary_f1_score': 0.64500004}
confusion matrix:
     0    1
0  475  178
1  248  387
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.66511625, 'precision': 0.6675668, 'recall': 0.6651163, 'specificity': 0.6651163, 'f1': 0.66388744, 'auroc': 0.70431584, 'binary_precision': 0.6878307, 'binary_recall': 0.60465115, 'binary_specificity': 0.7255814, 'binary_f1_score': 0.6435643}
confusion matrix:
     0    1
0  156   59
1   85  130
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-07-23 00:00:30.398561,epoch time: 0:01:17.935797,used: 0:04:01.436899,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_22_23_56_28_seed_0_22769260
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.5641276, 'precision': 0.5639661, 'recall': 0.56364995, 'specificity': 0.56364995, 'f1': 0.5633335, 'auroc': 0.59774745, 'binary_precision': 0.5662211, 'binary_recall': 0.59858704, 'binary_specificity': 0.52871287, 'binary_f1_score': 0.5819544}
confusion matrix:
     0    1
0  801  714
1  625  932
---- Validation: 
scalar performance:
{'acc': 0.68167704, 'precision': 0.6822002, 'recall': 0.6811807, 'specificity': 0.6811807, 'f1': 0.6810302, 'auroc': 0.74248654, 'binary_precision': 0.68907565, 'binary_recall': 0.6456693, 'binary_specificity': 0.7166922, 'binary_f1_score': 0.6666666}
confusion matrix:
     0    1
0  468  185
1  225  410
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.67906976, 'precision': 0.6806328, 'recall': 0.67906976, 'specificity': 0.67906976, 'f1': 0.67837405, 'auroc': 0.72231483, 'binary_precision': 0.6974359, 'binary_recall': 0.63255817, 'binary_specificity': 0.7255814, 'binary_f1_score': 0.66341466}
confusion matrix:
     0    1
0  156   59
1   79  136
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-07-23 00:01:48.749667,epoch time: 0:01:18.351106,used: 0:05:19.788005,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_22_23_56_28_seed_0_22769260
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.60253906, 'precision': 0.6024977, 'recall': 0.6025098, 'specificity': 0.6025098, 'f1': 0.6024986, 'auroc': 0.6428673, 'binary_precision': 0.6082741, 'binary_recall': 0.60475576, 'binary_specificity': 0.60026383, 'binary_f1_score': 0.60650986}
confusion matrix:
     0    1
0  910  606
1  615  941
---- Validation: 
scalar performance:
{'acc': 0.68944097, 'precision': 0.69088364, 'recall': 0.68872917, 'specificity': 0.68872917, 'f1': 0.68829787, 'auroc': 0.75328165, 'binary_precision': 0.70434785, 'binary_recall': 0.63779527, 'binary_specificity': 0.73966306, 'binary_f1_score': 0.6694215}
confusion matrix:
     0    1
0  483  170
1  230  405
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6744186, 'precision': 0.6770072, 'recall': 0.67441857, 'specificity': 0.67441857, 'f1': 0.6732239, 'auroc': 0.7385181, 'binary_precision': 0.6984127, 'binary_recall': 0.6139535, 'binary_specificity': 0.7348837, 'binary_f1_score': 0.65346533}
confusion matrix:
     0    1
0  158   57
1   83  132
better model found
persisted
after epoch: 5,now: 2024-07-23 00:03:07.627835,epoch time: 0:01:18.878168,used: 0:06:38.666173,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_22_23_56_28_seed_0_22769260
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.6438802, 'precision': 0.64382064, 'recall': 0.6436926, 'specificity': 0.6436926, 'f1': 0.6436952, 'auroc': 0.6969459, 'binary_precision': 0.64564943, 'binary_recall': 0.6580977, 'binary_specificity': 0.6292876, 'binary_f1_score': 0.6518141}
confusion matrix:
     0     1
0  954   562
1  532  1024
---- Validation: 
scalar performance:
{'acc': 0.7088509, 'precision': 0.70935076, 'recall': 0.7084142, 'specificity': 0.7084142, 'f1': 0.7083571, 'auroc': 0.763536, 'binary_precision': 0.71666664, 'binary_recall': 0.6771653, 'binary_specificity': 0.73966306, 'binary_f1_score': 0.69635624}
confusion matrix:
     0    1
0  483  170
1  205  430
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.67906976, 'precision': 0.680067, 'recall': 0.67906976, 'specificity': 0.67906976, 'f1': 0.67862475, 'auroc': 0.7525581, 'binary_precision': 0.6934673, 'binary_recall': 0.6418605, 'binary_specificity': 0.7162791, 'binary_f1_score': 0.6666666}
confusion matrix:
     0    1
0  154   61
1   77  138
better model found
persisted
after epoch: 6,now: 2024-07-23 00:04:27.224720,epoch time: 0:01:19.596885,used: 0:07:58.263058,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_22_23_56_28_seed_0_22769260
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.66308594, 'precision': 0.66314095, 'recall': 0.6631602, 'specificity': 0.6631602, 'f1': 0.6630831, 'auroc': 0.72415066, 'binary_precision': 0.6708197, 'binary_recall': 0.657455, 'binary_specificity': 0.66886544, 'binary_f1_score': 0.6640701}
confusion matrix:
      0     1
0  1014   502
1   533  1023
---- Validation: 
scalar performance:
{'acc': 0.7204969, 'precision': 0.7207184, 'recall': 0.7201818, 'specificity': 0.7201818, 'f1': 0.7201994, 'auroc': 0.77232873, 'binary_precision': 0.7250409, 'binary_recall': 0.6976378, 'binary_specificity': 0.7427259, 'binary_f1_score': 0.7110754}
confusion matrix:
     0    1
0  485  168
1  192  443
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.68604654, 'precision': 0.6869565, 'recall': 0.6860465, 'specificity': 0.6860465, 'f1': 0.68566394, 'auroc': 0.7642834, 'binary_precision': 0.7, 'binary_recall': 0.6511628, 'binary_specificity': 0.7209302, 'binary_f1_score': 0.67469877}
confusion matrix:
     0    1
0  155   60
1   75  140
new oracle model saved
better model found
persisted
after epoch: 7,now: 2024-07-23 00:05:47.513332,epoch time: 0:01:20.288612,used: 0:09:18.551670,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_22_23_56_28_seed_0_22769260
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.6923828, 'precision': 0.69231665, 'recall': 0.6922777, 'specificity': 0.6922777, 'f1': 0.69229126, 'auroc': 0.75486064, 'binary_precision': 0.6955967, 'binary_recall': 0.6996149, 'binary_specificity': 0.6849406, 'binary_f1_score': 0.6976}
confusion matrix:
      0     1
0  1037   477
1   468  1090
---- Validation: 
scalar performance:
{'acc': 0.7173913, 'precision': 0.71734107, 'recall': 0.7173578, 'specificity': 0.7173578, 'f1': 0.71734774, 'auroc': 0.78020763, 'binary_precision': 0.71271586, 'binary_recall': 0.71496063, 'binary_specificity': 0.719755, 'binary_f1_score': 0.71383655}
confusion matrix:
     0    1
0  470  183
1  181  454
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7023256, 'precision': 0.7024833, 'recall': 0.7023256, 'specificity': 0.7023256, 'f1': 0.70226765, 'auroc': 0.7746241, 'binary_precision': 0.708134, 'binary_recall': 0.6883721, 'binary_specificity': 0.7162791, 'binary_f1_score': 0.6981132}
confusion matrix:
     0    1
0  154   61
1   67  148
new oracle model saved
early stop counter: 1
val acc:0.717391312122345, best validation acc: 0.7204968929290771, corresponding to test acc:                         0.6860465407371521 / 0.7023255825042725
after epoch: 8,now: 2024-07-23 00:07:07.124258,epoch time: 0:01:19.610926,used: 0:10:38.162596,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_22_23_56_28_seed_0_22769260
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.69954425, 'precision': 0.6995122, 'recall': 0.69938576, 'specificity': 0.69938576, 'f1': 0.6994097, 'auroc': 0.7661332, 'binary_precision': 0.7006329, 'binary_recall': 0.7109827, 'binary_specificity': 0.6877888, 'binary_f1_score': 0.7057699}
confusion matrix:
      0     1
0  1042   473
1   450  1107
---- Validation: 
scalar performance:
{'acc': 0.7259317, 'precision': 0.7260947, 'recall': 0.72608435, 'specificity': 0.72608435, 'f1': 0.7259315, 'auroc': 0.78602695, 'binary_precision': 0.7155963, 'binary_recall': 0.73700786, 'binary_specificity': 0.7151608, 'binary_f1_score': 0.7261443}
confusion matrix:
     0    1
0  467  186
1  167  468
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7046512, 'precision': 0.7046556, 'recall': 0.7046512, 'specificity': 0.7046512, 'f1': 0.70464957, 'auroc': 0.78321254, 'binary_precision': 0.7056075, 'binary_recall': 0.7023256, 'binary_specificity': 0.7069768, 'binary_f1_score': 0.70396274}
confusion matrix:
     0    1
0  152   63
1   64  151
new oracle model saved
better model found
persisted
after epoch: 9,now: 2024-07-23 00:08:26.683764,epoch time: 0:01:19.559506,used: 0:11:57.722102,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_22_23_56_28_seed_0_22769260
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.7405599, 'precision': 0.74084365, 'recall': 0.74077964, 'specificity': 0.74077964, 'f1': 0.7405566, 'auroc': 0.8069812, 'binary_precision': 0.7536618, 'binary_recall': 0.72610646, 'binary_specificity': 0.75545275, 'binary_f1_score': 0.7396276}
confusion matrix:
      0     1
0  1143   370
1   427  1132
---- Validation: 
scalar performance:
{'acc': 0.73059005, 'precision': 0.73086464, 'recall': 0.7302661, 'specificity': 0.7302661, 'f1': 0.73028946, 'auroc': 0.79049814, 'binary_precision': 0.73606557, 'binary_recall': 0.7070866, 'binary_specificity': 0.7534456, 'binary_f1_score': 0.7212851}
confusion matrix:
     0    1
0  492  161
1  186  449
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7093023, 'precision': 0.7098516, 'recall': 0.7093023, 'specificity': 0.7093023, 'f1': 0.7091119, 'auroc': 0.7899405, 'binary_precision': 0.7205882, 'binary_recall': 0.68372095, 'binary_specificity': 0.7348837, 'binary_f1_score': 0.70167065}
confusion matrix:
     0    1
0  158   57
1   68  147
new oracle model saved
better model found
persisted
after epoch: 10,now: 2024-07-23 00:09:46.354745,epoch time: 0:01:19.670981,used: 0:13:17.393083,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_22_23_56_28_seed_0_22769260
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.74283856, 'precision': 0.7429645, 'recall': 0.7429645, 'specificity': 0.7429645, 'f1': 0.7428385, 'auroc': 0.81580925, 'binary_precision': 0.7526385, 'binary_recall': 0.7332905, 'binary_specificity': 0.7526385, 'binary_f1_score': 0.7428385}
confusion matrix:
      0     1
0  1141   375
1   415  1141
---- Validation: 
scalar performance:
{'acc': 0.73680127, 'precision': 0.7369053, 'recall': 0.73656535, 'specificity': 0.73656535, 'f1': 0.7366067, 'auroc': 0.7961124, 'binary_precision': 0.7394822, 'binary_recall': 0.719685, 'binary_specificity': 0.7534456, 'binary_f1_score': 0.7294493}
confusion matrix:
     0    1
0  492  161
1  178  457
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7209302, 'precision': 0.72094935, 'recall': 0.7209302, 'specificity': 0.7209302, 'f1': 0.7209242, 'auroc': 0.79768527, 'binary_precision': 0.7230047, 'binary_recall': 0.7162791, 'binary_specificity': 0.7255814, 'binary_f1_score': 0.7196262}
confusion matrix:
     0    1
0  156   59
1   61  154
new oracle model saved
better model found
persisted
after epoch: 11,now: 2024-07-23 00:11:05.680551,epoch time: 0:01:19.325806,used: 0:14:36.718889,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_22_23_56_28_seed_0_22769260
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.75846356, 'precision': 0.7589853, 'recall': 0.7587166, 'specificity': 0.7587166, 'f1': 0.75843394, 'auroc': 0.83372813, 'binary_precision': 0.77410656, 'binary_recall': 0.73826367, 'binary_specificity': 0.77916944, 'binary_f1_score': 0.7557604}
confusion matrix:
      0     1
0  1182   335
1   407  1148
---- Validation: 
scalar performance:
{'acc': 0.742236, 'precision': 0.7425147, 'recall': 0.74192524, 'specificity': 0.74192524, 'f1': 0.74196166, 'auroc': 0.8001013, 'binary_precision': 0.7479542, 'binary_recall': 0.719685, 'binary_specificity': 0.7641654, 'binary_f1_score': 0.7335474}
confusion matrix:
     0    1
0  499  154
1  178  457
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.727907, 'precision': 0.72791195, 'recall': 0.72790694, 'specificity': 0.72790694, 'f1': 0.7279055, 'auroc': 0.8035046, 'binary_precision': 0.7268519, 'binary_recall': 0.73023254, 'binary_specificity': 0.7255814, 'binary_f1_score': 0.7285383}
confusion matrix:
     0    1
0  156   59
1   58  157
new oracle model saved
better model found
persisted
after epoch: 12,now: 2024-07-23 00:12:24.897695,epoch time: 0:01:19.217144,used: 0:15:55.936033,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_22_23_56_28_seed_0_22769260
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.7682292, 'precision': 0.76819634, 'recall': 0.76813495, 'specificity': 0.76813495, 'f1': 0.76815754, 'auroc': 0.8443348, 'binary_precision': 0.7697704, 'binary_recall': 0.7747112, 'binary_specificity': 0.7615588, 'binary_f1_score': 0.7722329}
confusion matrix:
      0     1
0  1153   361
1   351  1207
---- Validation: 
scalar performance:
{'acc': 0.7430124, 'precision': 0.7429888, 'recall': 0.7428863, 'specificity': 0.7428863, 'f1': 0.7429156, 'auroc': 0.80490285, 'binary_precision': 0.7420382, 'binary_recall': 0.7338583, 'binary_specificity': 0.75191426, 'binary_f1_score': 0.7379256}
confusion matrix:
     0    1
0  491  162
1  169  466
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.73255813, 'precision': 0.732684, 'recall': 0.73255813, 'specificity': 0.73255813, 'f1': 0.732522, 'auroc': 0.8095403, 'binary_precision': 0.72727275, 'binary_recall': 0.74418604, 'binary_specificity': 0.7209302, 'binary_f1_score': 0.7356322}
confusion matrix:
     0    1
0  155   60
1   55  160
new oracle model saved
better model found
persisted
after epoch: 13,now: 2024-07-23 00:13:45.366834,epoch time: 0:01:20.469139,used: 0:17:16.405172,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_22_23_56_28_seed_0_22769260
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.7705078, 'precision': 0.7705319, 'recall': 0.7705749, 'specificity': 0.7705749, 'f1': 0.7705023, 'auroc': 0.8451475, 'binary_precision': 0.7779229, 'binary_recall': 0.7654242, 'binary_specificity': 0.7757256, 'binary_f1_score': 0.77162296}
confusion matrix:
      0     1
0  1176   340
1   365  1191
---- Validation: 
scalar performance:
{'acc': 0.7445652, 'precision': 0.7445426, 'recall': 0.74443936, 'specificity': 0.74443936, 'f1': 0.7444689, 'auroc': 0.80863607, 'binary_precision': 0.7436306, 'binary_recall': 0.73543304, 'binary_specificity': 0.7534456, 'binary_f1_score': 0.7395091}
confusion matrix:
     0    1
0  492  161
1  168  467
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.73953485, 'precision': 0.7397216, 'recall': 0.73953485, 'specificity': 0.73953485, 'f1': 0.7394842, 'auroc': 0.81514335, 'binary_precision': 0.7330317, 'binary_recall': 0.75348836, 'binary_specificity': 0.7255814, 'binary_f1_score': 0.7431193}
confusion matrix:
     0    1
0  156   59
1   53  162
new oracle model saved
better model found
persisted
after epoch: 14,now: 2024-07-23 00:15:05.342827,epoch time: 0:01:19.975993,used: 0:18:36.381165,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_22_23_56_28_seed_0_22769260
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.79264325, 'precision': 0.79261535, 'recall': 0.7926477, 'specificity': 0.7926477, 'f1': 0.7926248, 'auroc': 0.8627461, 'binary_precision': 0.7968952, 'binary_recall': 0.79228294, 'binary_specificity': 0.7930125, 'binary_f1_score': 0.7945824}
confusion matrix:
      0     1
0  1203   314
1   323  1232
---- Validation: 
scalar performance:
{'acc': 0.75, 'precision': 0.74995357, 'recall': 0.7499729, 'specificity': 0.7499729, 'f1': 0.7499614, 'auroc': 0.8119449, 'binary_precision': 0.7456829, 'binary_recall': 0.7480315, 'binary_specificity': 0.75191426, 'binary_f1_score': 0.7468554}
confusion matrix:
     0    1
0  491  162
1  160  475
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.74883723, 'precision': 0.7491822, 'recall': 0.74883723, 'specificity': 0.74883723, 'f1': 0.7487502, 'auroc': 0.8195782, 'binary_precision': 0.7399103, 'binary_recall': 0.76744187, 'binary_specificity': 0.73023254, 'binary_f1_score': 0.75342464}
confusion matrix:
     0    1
0  157   58
1   50  165
new oracle model saved
better model found
persisted
after epoch: 15,now: 2024-07-23 00:16:23.463347,epoch time: 0:01:18.120520,used: 0:19:54.501685,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_22_23_56_28_seed_0_22769260
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.8098958, 'precision': 0.81035566, 'recall': 0.8101646, 'specificity': 0.8101646, 'f1': 0.8098861, 'auroc': 0.88428116, 'binary_precision': 0.8264075, 'binary_recall': 0.79139924, 'binary_specificity': 0.82892996, 'binary_f1_score': 0.80852467}
confusion matrix:
      0     1
0  1255   259
1   325  1233
---- Validation: 
scalar performance:
{'acc': 0.75, 'precision': 0.750736, 'recall': 0.7495605, 'specificity': 0.7495605, 'f1': 0.74955976, 'auroc': 0.8135197, 'binary_precision': 0.7612688, 'binary_recall': 0.71811026, 'binary_specificity': 0.78101075, 'binary_f1_score': 0.7390599}
confusion matrix:
     0    1
0  510  143
1  179  456
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.75116277, 'precision': 0.75116825, 'recall': 0.75116277, 'specificity': 0.75116277, 'f1': 0.75116146, 'auroc': 0.8234937, 'binary_precision': 0.75233644, 'binary_recall': 0.74883723, 'binary_specificity': 0.75348836, 'binary_f1_score': 0.75058275}
confusion matrix:
     0    1
0  162   53
1   54  161
new oracle model saved
early stop counter: 1
val acc:0.75, best validation acc: 0.75, corresponding to test acc:                         0.7488372325897217 / 0.7511627674102783
after epoch: 16,now: 2024-07-23 00:17:41.871436,epoch time: 0:01:18.408089,used: 0:21:12.909774,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_22_23_56_28_seed_0_22769260
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.79785156, 'precision': 0.7978239, 'recall': 0.79785687, 'specificity': 0.79785687, 'f1': 0.79783344, 'auroc': 0.8767736, 'binary_precision': 0.80206984, 'binary_recall': 0.79742765, 'binary_specificity': 0.7982861, 'binary_f1_score': 0.7997419}
confusion matrix:
      0     1
0  1211   306
1   315  1240
---- Validation: 
scalar performance:
{'acc': 0.7554348, 'precision': 0.75543904, 'recall': 0.7552893, 'specificity': 0.7552893, 'f1': 0.7553272, 'auroc': 0.8177521, 'binary_precision': 0.75559103, 'binary_recall': 0.74488187, 'binary_specificity': 0.76569676, 'binary_f1_score': 0.7501982}
confusion matrix:
     0    1
0  500  153
1  162  473
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.76046515, 'precision': 0.76074153, 'recall': 0.76046515, 'specificity': 0.76046515, 'f1': 0.76040167, 'auroc': 0.8286425, 'binary_precision': 0.7522523, 'binary_recall': 0.7767442, 'binary_specificity': 0.74418604, 'binary_f1_score': 0.76430213}
confusion matrix:
     0    1
0  160   55
1   48  167
new oracle model saved
better model found
persisted
after epoch: 17,now: 2024-07-23 00:19:01.318320,epoch time: 0:01:19.446884,used: 0:22:32.356658,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_22_23_56_28_seed_0_22769260
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.8001302, 'precision': 0.80032027, 'recall': 0.80026424, 'specificity': 0.80026424, 'f1': 0.8001281, 'auroc': 0.8809664, 'binary_precision': 0.8111332, 'binary_recall': 0.788152, 'binary_specificity': 0.81237656, 'binary_f1_score': 0.7994775}
confusion matrix:
      0     1
0  1234   285
1   329  1224
---- Validation: 
scalar performance:
{'acc': 0.7569876, 'precision': 0.75708425, 'recall': 0.7567773, 'specificity': 0.7567773, 'f1': 0.75682795, 'auroc': 0.82020956, 'binary_precision': 0.7596774, 'binary_recall': 0.7417323, 'binary_specificity': 0.77182233, 'binary_f1_score': 0.7505976}
confusion matrix:
     0    1
0  504  149
1  164  471
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.75813955, 'precision': 0.7583407, 'recall': 0.7581395, 'specificity': 0.7581395, 'f1': 0.7580924, 'auroc': 0.8327312, 'binary_precision': 0.75113124, 'binary_recall': 0.772093, 'binary_specificity': 0.74418604, 'binary_f1_score': 0.7614679}
confusion matrix:
     0    1
0  160   55
1   49  166
better model found
persisted
after epoch: 18,now: 2024-07-23 00:20:20.064153,epoch time: 0:01:18.745833,used: 0:23:51.102491,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_22_23_56_28_seed_0_22769260
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.8020833, 'precision': 0.8027997, 'recall': 0.8023889, 'specificity': 0.8023889, 'f1': 0.80204976, 'auroc': 0.8836702, 'binary_precision': 0.8211382, 'binary_recall': 0.7789203, 'binary_specificity': 0.8258575, 'binary_f1_score': 0.7994723}
confusion matrix:
      0     1
0  1252   264
1   344  1212
---- Validation: 
scalar performance:
{'acc': 0.75621116, 'precision': 0.75672954, 'recall': 0.755838, 'specificity': 0.755838, 'f1': 0.75587213, 'auroc': 0.82165176, 'binary_precision': 0.76528925, 'binary_recall': 0.72913384, 'binary_specificity': 0.7825421, 'binary_f1_score': 0.74677414}
confusion matrix:
     0    1
0  511  142
1  172  463
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7651163, 'precision': 0.7651679, 'recall': 0.7651163, 'specificity': 0.7651163, 'f1': 0.76510483, 'auroc': 0.8356949, 'binary_precision': 0.7614679, 'binary_recall': 0.772093, 'binary_specificity': 0.75813955, 'binary_f1_score': 0.7667436}
confusion matrix:
     0    1
0  163   52
1   49  166
new oracle model saved
early stop counter: 1
val acc:0.7562111616134644, best validation acc: 0.7569875717163086, corresponding to test acc:                         0.7581395506858826 / 0.765116274356842
after epoch: 19,now: 2024-07-23 00:21:37.981361,epoch time: 0:01:17.917208,used: 0:25:09.019699,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_22_23_56_28_seed_0_22769260
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.8105469, 'precision': 0.8108641, 'recall': 0.81076074, 'specificity': 0.81076074, 'f1': 0.81054294, 'auroc': 0.89514494, 'binary_precision': 0.8247835, 'binary_recall': 0.7951188, 'binary_specificity': 0.82640266, 'binary_f1_score': 0.8096795}
confusion matrix:
      0     1
0  1252   263
1   319  1238
---- Validation: 
scalar performance:
{'acc': 0.75621116, 'precision': 0.7562885, 'recall': 0.7560116, 'specificity': 0.7560116, 'f1': 0.7560606, 'auroc': 0.82492197, 'binary_precision': 0.7584541, 'binary_recall': 0.7417323, 'binary_specificity': 0.770291, 'binary_f1_score': 0.75}
confusion matrix:
     0    1
0  503  150
1  164  471
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.76744187, 'precision': 0.7676503, 'recall': 0.76744187, 'specificity': 0.76744187, 'f1': 0.7673966, 'auroc': 0.84049755, 'binary_precision': 0.760181, 'binary_recall': 0.7813954, 'binary_specificity': 0.75348836, 'binary_f1_score': 0.7706423}
confusion matrix:
     0    1
0  162   53
1   47  168
new oracle model saved
early stop counter: 2
val acc:0.7562111616134644, best validation acc: 0.7569875717163086, corresponding to test acc:                         0.7581395506858826 / 0.7674418687820435
after epoch: 20,now: 2024-07-23 00:22:57.856092,epoch time: 0:01:19.874731,used: 0:26:28.894430,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_22_23_56_28_seed_0_22769260
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.82161456, 'precision': 0.82172966, 'recall': 0.8217504, 'specificity': 0.8217504, 'f1': 0.82161427, 'auroc': 0.9030623, 'binary_precision': 0.8321264, 'binary_recall': 0.8118176, 'binary_specificity': 0.83168316, 'binary_f1_score': 0.82184654}
confusion matrix:
      0     1
0  1260   255
1   293  1264
---- Validation: 
scalar performance:
{'acc': 0.757764, 'precision': 0.7578433, 'recall': 0.7575647, 'specificity': 0.7575647, 'f1': 0.7576144, 'auroc': 0.82733357, 'binary_precision': 0.7600644, 'binary_recall': 0.7433071, 'binary_specificity': 0.77182233, 'binary_f1_score': 0.75159246}
confusion matrix:
     0    1
0  504  149
1  163  472
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7651163, 'precision': 0.7655816, 'recall': 0.7651163, 'specificity': 0.7651163, 'f1': 0.76501334, 'auroc': 0.84430504, 'binary_precision': 0.75446427, 'binary_recall': 0.7860465, 'binary_specificity': 0.74418604, 'binary_f1_score': 0.7699316}
confusion matrix:
     0    1
0  160   55
1   46  169
better model found
persisted
after epoch: 21,now: 2024-07-23 00:24:16.539974,epoch time: 0:01:18.683882,used: 0:27:47.578312,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_22_23_56_28_seed_0_22769260
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.8284505, 'precision': 0.8284645, 'recall': 0.8285189, 'specificity': 0.8285189, 'f1': 0.8284453, 'auroc': 0.9015132, 'binary_precision': 0.8356164, 'binary_recall': 0.8232648, 'binary_specificity': 0.8337731, 'binary_f1_score': 0.82939464}
confusion matrix:
      0     1
0  1264   252
1   275  1281
---- Validation: 
scalar performance:
{'acc': 0.7554348, 'precision': 0.7555692, 'recall': 0.75520253, 'specificity': 0.75520253, 'f1': 0.75525403, 'auroc': 0.82890356, 'binary_precision': 0.7588997, 'binary_recall': 0.7385827, 'binary_specificity': 0.77182233, 'binary_f1_score': 0.7486034}
confusion matrix:
     0    1
0  504  149
1  166  469
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.76744187, 'precision': 0.76781267, 'recall': 0.76744187, 'specificity': 0.76744187, 'f1': 0.7673614, 'auroc': 0.84694433, 'binary_precision': 0.75784755, 'binary_recall': 0.7860465, 'binary_specificity': 0.74883723, 'binary_f1_score': 0.77168953}
confusion matrix:
     0    1
0  161   54
1   46  169
early stop counter: 1
val acc:0.7554348111152649, best validation acc: 0.7577639818191528, corresponding to test acc:                         0.765116274356842 / 0.7674418687820435
after epoch: 22,now: 2024-07-23 00:25:35.764567,epoch time: 0:01:19.224593,used: 0:29:06.802905,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_22_23_56_28_seed_0_22769260
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.8232422, 'precision': 0.8232422, 'recall': 0.8233026, 'specificity': 0.8233026, 'f1': 0.82323396, 'auroc': 0.9092127, 'binary_precision': 0.8300781, 'binary_recall': 0.81888247, 'binary_specificity': 0.8277228, 'binary_f1_score': 0.8244423}
confusion matrix:
      0     1
0  1254   261
1   282  1275
---- Validation: 
scalar performance:
{'acc': 0.7531056, 'precision': 0.75354105, 'recall': 0.7527535, 'specificity': 0.7527535, 'f1': 0.75279033, 'auroc': 0.8301866, 'binary_precision': 0.76112026, 'binary_recall': 0.72755903, 'binary_specificity': 0.77794796, 'binary_f1_score': 0.74396133}
confusion matrix:
     0    1
0  508  145
1  173  462
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7767442, 'precision': 0.77684, 'recall': 0.7767442, 'specificity': 0.7767442, 'f1': 0.7767249, 'auroc': 0.84949696, 'binary_precision': 0.7716895, 'binary_recall': 0.7860465, 'binary_specificity': 0.76744187, 'binary_f1_score': 0.77880186}
confusion matrix:
     0    1
0  165   50
1   46  169
new oracle model saved
early stop counter: 2
val acc:0.7531055808067322, best validation acc: 0.7577639818191528, corresponding to test acc:                         0.765116274356842 / 0.7767441868782043
after epoch: 23,now: 2024-07-23 00:26:55.253123,epoch time: 0:01:19.488556,used: 0:30:26.291461,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_22_23_56_28_seed_0_22769260
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.82942706, 'precision': 0.82970583, 'recall': 0.8296186, 'specificity': 0.8296186, 'f1': 0.8294245, 'auroc': 0.9111644, 'binary_precision': 0.8430851, 'binary_recall': 0.81491005, 'binary_specificity': 0.84432715, 'binary_f1_score': 0.8287582}
confusion matrix:
      0     1
0  1280   236
1   288  1268
---- Validation: 
scalar performance:
{'acc': 0.7523292, 'precision': 0.75266457, 'recall': 0.7520095, 'specificity': 0.7520095, 'f1': 0.75205284, 'auroc': 0.8320242, 'binary_precision': 0.7590164, 'binary_recall': 0.72913384, 'binary_specificity': 0.7748851, 'binary_f1_score': 0.74377507}
confusion matrix:
     0    1
0  506  147
1  172  463
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.772093, 'precision': 0.77247024, 'recall': 0.77209306, 'specificity': 0.77209306, 'f1': 0.77201414, 'auroc': 0.8519632, 'binary_precision': 0.76233184, 'binary_recall': 0.7906977, 'binary_specificity': 0.75348836, 'binary_f1_score': 0.7762557}
confusion matrix:
     0    1
0  162   53
1   45  170
early stop counter: 3
val acc:0.7523291707038879, best validation acc: 0.7577639818191528, corresponding to test acc:                         0.765116274356842 / 0.7767441868782043
after epoch: 24,now: 2024-07-23 00:28:13.841953,epoch time: 0:01:18.588830,used: 0:31:44.880291,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_22_23_56_28_seed_0_22769260
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.8313802, 'precision': 0.83172166, 'recall': 0.8315799, 'specificity': 0.8315799, 'f1': 0.8313744, 'auroc': 0.9167056, 'binary_precision': 0.84589726, 'binary_recall': 0.8154341, 'binary_specificity': 0.84772575, 'binary_f1_score': 0.83038634}
confusion matrix:
      0     1
0  1286   231
1   287  1268
---- Validation: 
scalar performance:
{'acc': 0.7523292, 'precision': 0.7532151, 'recall': 0.7518576, 'specificity': 0.7518576, 'f1': 0.7518432, 'auroc': 0.8325499, 'binary_precision': 0.76510066, 'binary_recall': 0.71811026, 'binary_specificity': 0.7856049, 'binary_f1_score': 0.74086106}
confusion matrix:
     0    1
0  513  140
1  179  456
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7767442, 'precision': 0.7767442, 'recall': 0.7767442, 'specificity': 0.7767442, 'f1': 0.7767441, 'auroc': 0.8538886, 'binary_precision': 0.7767442, 'binary_recall': 0.7767442, 'binary_specificity': 0.7767442, 'binary_f1_score': 0.7767441}
confusion matrix:
     0    1
0  167   48
1   48  167
early stop counter: 4
val acc:0.7523291707038879, best validation acc: 0.7577639818191528, corresponding to test acc:                         0.765116274356842 / 0.7767441868782043
after epoch: 25,now: 2024-07-23 00:29:32.248292,epoch time: 0:01:18.406339,used: 0:33:03.286630,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_22_23_56_28_seed_0_22769260
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.83235675, 'precision': 0.8331843, 'recall': 0.8326802, 'specificity': 0.8326802, 'f1': 0.8323239, 'auroc': 0.9100253, 'binary_precision': 0.8533605, 'binary_recall': 0.80784065, 'binary_specificity': 0.8575198, 'binary_f1_score': 0.8299769}
confusion matrix:
      0     1
0  1300   216
1   299  1257
---- Validation: 
scalar performance:
{'acc': 0.7531056, 'precision': 0.7546024, 'recall': 0.7525147, 'specificity': 0.7525147, 'f1': 0.7524155, 'auroc': 0.8331746, 'binary_precision': 0.7709402, 'binary_recall': 0.7102362, 'binary_specificity': 0.79479325, 'binary_f1_score': 0.73934424}
confusion matrix:
     0    1
0  519  134
1  184  451
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7837209, 'precision': 0.78387445, 'recall': 0.7837209, 'specificity': 0.7837209, 'f1': 0.78369164, 'auroc': 0.8559221, 'binary_precision': 0.7904762, 'binary_recall': 0.772093, 'binary_specificity': 0.7953488, 'binary_f1_score': 0.7811765}
confusion matrix:
     0    1
0  171   44
1   49  166
new oracle model saved
early stop counter: 5
val acc:0.7531055808067322, best validation acc: 0.7577639818191528, corresponding to test acc:                         0.765116274356842 / 0.7837209105491638
after epoch: 26,now: 2024-07-23 00:30:50.694350,epoch time: 0:01:18.446058,used: 0:34:21.732688,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_22_23_56_28_seed_0_22769260
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.83723956, 'precision': 0.83744025, 'recall': 0.8374139, 'specificity': 0.8374139, 'f1': 0.8372393, 'auroc': 0.9169084, 'binary_precision': 0.84976834, 'binary_recall': 0.8246628, 'binary_specificity': 0.850165, 'binary_f1_score': 0.8370274}
confusion matrix:
      0     1
0  1288   227
1   273  1284
---- Validation: 
scalar performance:
{'acc': 0.7476708, 'precision': 0.748627, 'recall': 0.7471765, 'specificity': 0.7471765, 'f1': 0.7471402, 'auroc': 0.83405, 'binary_precision': 0.76094276, 'binary_recall': 0.711811, 'binary_specificity': 0.7825421, 'binary_f1_score': 0.7355574}
confusion matrix:
     0    1
0  511  142
1  183  452
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7790698, 'precision': 0.7790758, 'recall': 0.7790698, 'specificity': 0.7790698, 'f1': 0.7790686, 'auroc': 0.85815036, 'binary_precision': 0.7777778, 'binary_recall': 0.7813954, 'binary_specificity': 0.7767442, 'binary_f1_score': 0.77958244}
confusion matrix:
     0    1
0  167   48
1   47  168
early stop counter: 6
val acc:0.7476708292961121, best validation acc: 0.7577639818191528, corresponding to test acc:                         0.765116274356842 / 0.7837209105491638
after epoch: 27,now: 2024-07-23 00:32:09.248674,epoch time: 0:01:18.554324,used: 0:35:40.287012,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_22_23_56_28_seed_0_22769260
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.8483073, 'precision': 0.8486078, 'recall': 0.848528, 'specificity': 0.848528, 'f1': 0.8483057, 'auroc': 0.9229642, 'binary_precision': 0.8630319, 'binary_recall': 0.8331194, 'binary_specificity': 0.8639366, 'binary_f1_score': 0.84781194}
confusion matrix:
      0     1
0  1308   206
1   260  1298
---- Validation: 
scalar performance:
{'acc': 0.7484472, 'precision': 0.74978554, 'recall': 0.7478771, 'specificity': 0.7478771, 'f1': 0.7477849, 'auroc': 0.8349495, 'binary_precision': 0.7649063, 'binary_recall': 0.7070866, 'binary_specificity': 0.7886677, 'binary_f1_score': 0.73486084}
confusion matrix:
     0    1
0  515  138
1  186  449
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7813954, 'precision': 0.7814197, 'recall': 0.7813953, 'specificity': 0.7813953, 'f1': 0.78139055, 'auroc': 0.8597512, 'binary_precision': 0.78403753, 'binary_recall': 0.7767442, 'binary_specificity': 0.7860465, 'binary_f1_score': 0.7803738}
confusion matrix:
     0    1
0  169   46
1   48  167
early stop counter: 7
val acc:0.7484471797943115, best validation acc: 0.7577639818191528, corresponding to test acc:                         0.765116274356842 / 0.7837209105491638
after epoch: 28,now: 2024-07-23 00:33:28.312493,epoch time: 0:01:19.063819,used: 0:36:59.350831,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_22_23_56_28_seed_0_22769260
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.83496094, 'precision': 0.83568895, 'recall': 0.8352955, 'specificity': 0.8352955, 'f1': 0.8349395, 'auroc': 0.91641134, 'binary_precision': 0.85530764, 'binary_recall': 0.8119384, 'binary_specificity': 0.8586526, 'binary_f1_score': 0.8330589}
confusion matrix:
      0     1
0  1300   214
1   293  1265
---- Validation: 
scalar performance:
{'acc': 0.7484472, 'precision': 0.7502917, 'recall': 0.74779034, 'specificity': 0.74779034, 'f1': 0.74761415, 'auroc': 0.8355452, 'binary_precision': 0.7685665, 'binary_recall': 0.7007874, 'binary_specificity': 0.79479325, 'binary_f1_score': 0.7331137}
confusion matrix:
     0    1
0  519  134
1  190  445
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7883721, 'precision': 0.7886781, 'recall': 0.78837204, 'specificity': 0.78837204, 'f1': 0.78831595, 'auroc': 0.86109245, 'binary_precision': 0.7980769, 'binary_recall': 0.772093, 'binary_specificity': 0.80465114, 'binary_f1_score': 0.78486997}
confusion matrix:
     0    1
0  173   42
1   49  166
new oracle model saved
early stop counter: 8
val acc:0.7484471797943115, best validation acc: 0.7577639818191528, corresponding to test acc:                         0.765116274356842 / 0.7883720993995667
after epoch: 29,now: 2024-07-23 00:34:47.328698,epoch time: 0:01:19.016205,used: 0:38:18.367036,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_22_23_56_28_seed_0_22769260
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.83658856, 'precision': 0.836933, 'recall': 0.836789, 'specificity': 0.836789, 'f1': 0.8365829, 'auroc': 0.919888, 'binary_precision': 0.85123414, 'binary_recall': 0.82057875, 'binary_specificity': 0.8529993, 'binary_f1_score': 0.83562535}
confusion matrix:
      0     1
0  1294   223
1   279  1276
---- Validation: 
scalar performance:
{'acc': 0.7484472, 'precision': 0.7500286, 'recall': 0.7478337, 'specificity': 0.7478337, 'f1': 0.747702, 'auroc': 0.8363748, 'binary_precision': 0.7667239, 'binary_recall': 0.703937, 'binary_specificity': 0.79173046, 'binary_f1_score': 0.73399013}
confusion matrix:
     0    1
0  517  136
1  188  447
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7883721, 'precision': 0.78837836, 'recall': 0.7883721, 'specificity': 0.7883721, 'f1': 0.78837097, 'auroc': 0.86386156, 'binary_precision': 0.78971964, 'binary_recall': 0.7860465, 'binary_specificity': 0.7906977, 'binary_f1_score': 0.7878789}
confusion matrix:
     0    1
0  170   45
1   46  169
early stop counter: 9
val acc:0.7484471797943115, best validation acc: 0.7577639818191528, corresponding to test acc:                         0.765116274356842 / 0.7883720993995667
after epoch: 30,now: 2024-07-23 00:36:06.409624,epoch time: 0:01:19.080926,used: 0:39:37.447962,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_22_23_56_28_seed_0_22769260
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 0:39:37.447962 at 2024-07-23 00:36:06.409624
persisted model performance metric: 

scalar performance:
{'acc': 0.7651163, 'precision': 0.7655816, 'recall': 0.7651163, 'specificity': 0.7651163, 'f1': 0.76501334, 'auroc': 0.84430504, 'binary_precision': 0.75446427, 'binary_recall': 0.7860465, 'binary_specificity': 0.74418604, 'binary_f1_score': 0.7699316}
confusion matrix:
     0    1
0  160   55
1   46  169
oracle model performance metric: 

scalar performance:
{'acc': 0.7883721, 'precision': 0.7886781, 'recall': 0.78837204, 'specificity': 0.78837204, 'f1': 0.78831595, 'auroc': 0.86109245, 'binary_precision': 0.7980769, 'binary_recall': 0.772093, 'binary_specificity': 0.80465114, 'binary_f1_score': 0.78486997}
confusion matrix:
     0    1
0  173   42
1   49  166
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_dial_lr1e5_bs16_allfreeze_2024-07-22_23-46-53/rule_results/4.csv
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_dial_lr1e5_bs16_allfreeze_2024-07-22_23-46-53/rule_results/4.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_dial_lr1e5_bs16_allfreeze_2024-07-22_23-46-53/confusion_matrix/4.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 190782 KiB | 460555 KiB |  39370 GiB |  39370 GiB |
|       from large pool | 174400 KiB | 428048 KiB |  38560 GiB |  38560 GiB |
|       from small pool |  16382 KiB |  33605 KiB |    809 GiB |    809 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 190782 KiB | 460555 KiB |  39370 GiB |  39370 GiB |
|       from large pool | 174400 KiB | 428048 KiB |  38560 GiB |  38560 GiB |
|       from small pool |  16382 KiB |  33605 KiB |    809 GiB |    809 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 189009 KiB | 457291 KiB |  39366 GiB |  39366 GiB |
|       from large pool | 172814 KiB | 424940 KiB |  38558 GiB |  38558 GiB |
|       from small pool |  16195 KiB |  33422 KiB |    808 GiB |    808 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 512000 KiB | 512000 KiB | 512000 KiB |      0 B   |
|       from large pool | 473088 KiB | 473088 KiB | 473088 KiB |      0 B   |
|       from small pool |  38912 KiB |  38912 KiB |  38912 KiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |  36545 KiB |  77635 KiB |  21355 GiB |  21355 GiB |
|       from large pool |  30400 KiB |  73350 KiB |  20525 GiB |  20525 GiB |
|       from small pool |   6145 KiB |   9295 KiB |    830 GiB |    830 GiB |
|---------------------------------------------------------------------------|
| Allocations           |     776    |    1147    |    8512 K  |    8512 K  |
|       from large pool |      76    |     158    |    3806 K  |    3806 K  |
|       from small pool |     700    |     996    |    4706 K  |    4705 K  |
|---------------------------------------------------------------------------|
| Active allocs         |     776    |    1147    |    8512 K  |    8512 K  |
|       from large pool |      76    |     158    |    3806 K  |    3806 K  |
|       from small pool |     700    |     996    |    4706 K  |    4705 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      40    |      40    |      40    |       0    |
|       from large pool |      21    |      21    |      21    |       0    |
|       from small pool |      19    |      19    |      19    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      36    |     214    |    5171 K  |    5171 K  |
|       from large pool |       9    |      19    |    2359 K  |    2359 K  |
|       from small pool |      27    |     206    |    2812 K  |    2812 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  17088 KiB | 460555 KiB |  39370 GiB |  39370 GiB |
|       from large pool |  17088 KiB | 428048 KiB |  38560 GiB |  38560 GiB |
|       from small pool |      0 KiB |  33605 KiB |    809 GiB |    809 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  17088 KiB | 460555 KiB |  39370 GiB |  39370 GiB |
|       from large pool |  17088 KiB | 428048 KiB |  38560 GiB |  38560 GiB |
|       from small pool |      0 KiB |  33605 KiB |    809 GiB |    809 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB | 457291 KiB |  39366 GiB |  39366 GiB |
|       from large pool |  16640 KiB | 424940 KiB |  38558 GiB |  38558 GiB |
|       from small pool |      0 KiB |  33422 KiB |    808 GiB |    808 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 227328 KiB | 512000 KiB | 512000 KiB | 284672 KiB |
|       from large pool | 204800 KiB | 473088 KiB | 473088 KiB | 268288 KiB |
|       from small pool |  22528 KiB |  38912 KiB |  38912 KiB |  16384 KiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  23872 KiB |  77635 KiB |  21356 GiB |  21356 GiB |
|       from large pool |  23872 KiB |  73350 KiB |  20525 GiB |  20525 GiB |
|       from small pool |      0 KiB |  11196 KiB |    830 GiB |    830 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    1147    |    8512 K  |    8512 K  |
|       from large pool |       2    |     158    |    3806 K  |    3806 K  |
|       from small pool |       0    |     996    |    4706 K  |    4706 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    1147    |    8512 K  |    8512 K  |
|       from large pool |       2    |     158    |    3806 K  |    3806 K  |
|       from small pool |       0    |     996    |    4706 K  |    4706 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      21    |      40    |      40    |      19    |
|       from large pool |      10    |      21    |      21    |      11    |
|       from small pool |      11    |      19    |      19    |       8    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     214    |    5172 K  |    5172 K  |
|       from large pool |       3    |      19    |    2359 K  |    2359 K  |
|       from small pool |       0    |     206    |    2812 K  |    2812 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  17088 KiB | 460555 KiB |  39370 GiB |  39370 GiB |
|       from large pool |  17088 KiB | 428048 KiB |  38560 GiB |  38560 GiB |
|       from small pool |      0 KiB |  33605 KiB |    809 GiB |    809 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  17088 KiB | 460555 KiB |  39370 GiB |  39370 GiB |
|       from large pool |  17088 KiB | 428048 KiB |  38560 GiB |  38560 GiB |
|       from small pool |      0 KiB |  33605 KiB |    809 GiB |    809 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB | 457291 KiB |  39366 GiB |  39366 GiB |
|       from large pool |  16640 KiB | 424940 KiB |  38558 GiB |  38558 GiB |
|       from small pool |      0 KiB |  33422 KiB |    808 GiB |    808 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 227328 KiB | 512000 KiB | 512000 KiB | 284672 KiB |
|       from large pool | 204800 KiB | 473088 KiB | 473088 KiB | 268288 KiB |
|       from small pool |  22528 KiB |  38912 KiB |  38912 KiB |  16384 KiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  23872 KiB |  77635 KiB |  21356 GiB |  21356 GiB |
|       from large pool |  23872 KiB |  73350 KiB |  20525 GiB |  20525 GiB |
|       from small pool |      0 KiB |  11196 KiB |    830 GiB |    830 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    1147    |    8512 K  |    8512 K  |
|       from large pool |       2    |     158    |    3806 K  |    3806 K  |
|       from small pool |       0    |     996    |    4706 K  |    4706 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    1147    |    8512 K  |    8512 K  |
|       from large pool |       2    |     158    |    3806 K  |    3806 K  |
|       from small pool |       0    |     996    |    4706 K  |    4706 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      21    |      40    |      40    |      19    |
|       from large pool |      10    |      21    |      21    |      11    |
|       from small pool |      11    |      19    |      19    |       8    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     214    |    5172 K  |    5172 K  |
|       from large pool |       3    |      19    |    2359 K  |    2359 K  |
|       from small pool |       0    |     206    |    2812 K  |    2812 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'888c1ef2'
model name: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_00_37_34_seed_1_22769260

 Experiment start at: 2024-07-23 00:37:34.135424
before training, model accuracy: 0.6177777647972107
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.5296224, 'precision': 0.53415525, 'recall': 0.5263607, 'specificity': 0.5263607, 'f1': 0.4993842, 'auroc': 0.47681057, 'binary_precision': 0.5246696, 'binary_recall': 0.7649326, 'binary_specificity': 0.28778878, 'binary_f1_score': 0.62241966}
confusion matrix:
     0     1
0  436  1079
1  366  1191
---- Validation: 
scalar performance:
{'acc': 0.5027322, 'precision': 0.4966679, 'recall': 0.49784946, 'specificity': 0.49784946, 'f1': 0.45135576, 'auroc': 0.6257796, 'binary_precision': 0.4864865, 'binary_recall': 0.2, 'binary_specificity': 0.79569894, 'binary_f1_score': 0.28346458}
confusion matrix:
     0    1
0  518  133
1  504  126
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.58444446, 'precision': 0.59774554, 'recall': 0.58444446, 'specificity': 0.58444446, 'f1': 0.5698095, 'auroc': 0.6713877, 'binary_precision': 0.63380283, 'binary_recall': 0.4, 'binary_specificity': 0.7688889, 'binary_f1_score': 0.49046323}
confusion matrix:
     0   1
0  173  52
1  135  90
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-23 00:38:58.726584,epoch time: 0:01:24.591160,used: 0:01:24.591160,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_00_37_34_seed_1_22769260
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.51497394, 'precision': 0.51442194, 'recall': 0.51346517, 'specificity': 0.51346517, 'f1': 0.50600207, 'auroc': 0.48590466, 'binary_precision': 0.5165631, 'binary_recall': 0.64221364, 'binary_specificity': 0.38471672, 'binary_f1_score': 0.57257605}
confusion matrix:
     0    1
0  584  934
1  556  998
---- Validation: 
scalar performance:
{'acc': 0.47384855, 'precision': 0.43086165, 'recall': 0.46784434, 'specificity': 0.46784434, 'f1': 0.38832325, 'auroc': 0.63228977, 'binary_precision': 0.37209302, 'binary_recall': 0.1015873, 'binary_specificity': 0.8341014, 'binary_f1_score': 0.159601}
confusion matrix:
     0    1
0  543  108
1  566   64
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.56666666, 'precision': 0.6024715, 'recall': 0.56666666, 'specificity': 0.56666666, 'f1': 0.5251906, 'auroc': 0.681363, 'binary_precision': 0.6630435, 'binary_recall': 0.2711111, 'binary_specificity': 0.8622222, 'binary_f1_score': 0.38485804}
confusion matrix:
     0   1
0  194  31
1  164  61
early stop counter: 1
val acc:0.4738485515117645, best validation acc: 0.5027322173118591, corresponding to test acc:                         0.5844444632530212 / 0.5844444632530212
after epoch: 2,now: 2024-07-23 00:40:19.559137,epoch time: 0:01:20.832553,used: 0:02:45.423713,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_00_37_34_seed_1_22769260
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.5423177, 'precision': 0.5429948, 'recall': 0.5410874, 'specificity': 0.5410874, 'f1': 0.536574, 'auroc': 0.5339417, 'binary_precision': 0.53978497, 'binary_recall': 0.64607465, 'binary_specificity': 0.43610013, 'binary_f1_score': 0.58816636}
confusion matrix:
     0     1
0  662   856
1  550  1004
---- Validation: 
scalar performance:
{'acc': 0.46994534, 'precision': 0.41160148, 'recall': 0.46364567, 'specificity': 0.46364567, 'f1': 0.37377542, 'auroc': 0.6431376, 'binary_precision': 0.33557048, 'binary_recall': 0.07936508, 'binary_specificity': 0.84792626, 'binary_f1_score': 0.12836972}
confusion matrix:
     0   1
0  552  99
1  580  50
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5555556, 'precision': 0.6, 'recall': 0.5555556, 'specificity': 0.5555556, 'f1': 0.5, 'auroc': 0.691437, 'binary_precision': 0.6666667, 'binary_recall': 0.22222222, 'binary_specificity': 0.8888889, 'binary_f1_score': 0.33333334}
confusion matrix:
     0   1
0  200  25
1  175  50
early stop counter: 2
val acc:0.46994534134864807, best validation acc: 0.5027322173118591, corresponding to test acc:                         0.5844444632530212 / 0.5844444632530212
after epoch: 3,now: 2024-07-23 00:41:40.390428,epoch time: 0:01:20.831291,used: 0:04:06.255004,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_00_37_34_seed_1_22769260
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.55371094, 'precision': 0.55363405, 'recall': 0.5528499, 'specificity': 0.5528499, 'f1': 0.5516356, 'auroc': 0.54998744, 'binary_precision': 0.5542658, 'binary_recall': 0.61296535, 'binary_specificity': 0.4927345, 'binary_f1_score': 0.5821396}
confusion matrix:
     0    1
0  746  768
1  603  955
---- Validation: 
scalar performance:
{'acc': 0.47228727, 'precision': 0.4087301, 'recall': 0.4657962, 'specificity': 0.4657962, 'f1': 0.36960495, 'auroc': 0.65501666, 'binary_precision': 0.3283582, 'binary_recall': 0.06984127, 'binary_specificity': 0.86175114, 'binary_f1_score': 0.11518325}
confusion matrix:
     0   1
0  561  90
1  586  44
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.55777776, 'precision': 0.6184019, 'recall': 0.55777776, 'specificity': 0.55777776, 'f1': 0.49286157, 'auroc': 0.7046321, 'binary_precision': 0.703125, 'binary_recall': 0.2, 'binary_specificity': 0.91555554, 'binary_f1_score': 0.31141868}
confusion matrix:
     0   1
0  206  19
1  180  45
early stop counter: 3
val acc:0.47228726744651794, best validation acc: 0.5027322173118591, corresponding to test acc:                         0.5844444632530212 / 0.5844444632530212
after epoch: 4,now: 2024-07-23 00:43:00.908031,epoch time: 0:01:20.517603,used: 0:05:26.772607,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_00_37_34_seed_1_22769260
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.5810547, 'precision': 0.5809369, 'recall': 0.5808174, 'specificity': 0.5808174, 'f1': 0.5807632, 'auroc': 0.5925728, 'binary_precision': 0.5838548, 'binary_recall': 0.6, 'binary_specificity': 0.5616348, 'binary_f1_score': 0.5918173}
confusion matrix:
     0    1
0  852  665
1  622  933
---- Validation: 
scalar performance:
{'acc': 0.4730679, 'precision': 0.40890473, 'recall': 0.46653867, 'specificity': 0.46653867, 'f1': 0.3691087, 'auroc': 0.6663765, 'binary_precision': 0.32824427, 'binary_recall': 0.06825397, 'binary_specificity': 0.86482334, 'binary_f1_score': 0.11300921}
confusion matrix:
     0   1
0  563  88
1  587  43
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.55777776, 'precision': 0.61541194, 'recall': 0.55777776, 'specificity': 0.55777776, 'f1': 0.494693, 'auroc': 0.71678025, 'binary_precision': 0.6969697, 'binary_recall': 0.20444444, 'binary_specificity': 0.9111111, 'binary_f1_score': 0.3161512}
confusion matrix:
     0   1
0  205  20
1  179  46
early stop counter: 4
val acc:0.47306790947914124, best validation acc: 0.5027322173118591, corresponding to test acc:                         0.5844444632530212 / 0.5844444632530212
after epoch: 5,now: 2024-07-23 00:44:21.907521,epoch time: 0:01:20.999490,used: 0:06:47.772097,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_00_37_34_seed_1_22769260
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.5911458, 'precision': 0.5918622, 'recall': 0.5905249, 'specificity': 0.5905249, 'f1': 0.58937037, 'auroc': 0.6069307, 'binary_precision': 0.58594656, 'binary_recall': 0.65012884, 'binary_specificity': 0.53092104, 'binary_f1_score': 0.6163714}
confusion matrix:
     0     1
0  807   713
1  543  1009
---- Validation: 
scalar performance:
{'acc': 0.4785324, 'precision': 0.43290895, 'recall': 0.4722478, 'specificity': 0.4722478, 'f1': 0.38436502, 'auroc': 0.6798698, 'binary_precision': 0.37333333, 'binary_recall': 0.08888889, 'binary_specificity': 0.85560673, 'binary_f1_score': 0.14358975}
confusion matrix:
     0   1
0  557  94
1  574  56
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.57555556, 'precision': 0.6345694, 'recall': 0.57555556, 'specificity': 0.57555556, 'f1': 0.5232919, 'auroc': 0.72963953, 'binary_precision': 0.7236842, 'binary_recall': 0.24444444, 'binary_specificity': 0.9066667, 'binary_f1_score': 0.3654485}
confusion matrix:
     0   1
0  204  21
1  170  55
early stop counter: 5
val acc:0.4785324037075043, best validation acc: 0.5027322173118591, corresponding to test acc:                         0.5844444632530212 / 0.5844444632530212
after epoch: 6,now: 2024-07-23 00:45:41.750850,epoch time: 0:01:19.843329,used: 0:08:07.615426,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_00_37_34_seed_1_22769260
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.6188151, 'precision': 0.6194401, 'recall': 0.61824006, 'specificity': 0.61824006, 'f1': 0.61760235, 'auroc': 0.6469134, 'binary_precision': 0.6132466, 'binary_recall': 0.6673102, 'binary_specificity': 0.56916994, 'binary_f1_score': 0.63913715}
confusion matrix:
     0     1
0  864   654
1  517  1037
---- Validation: 
scalar performance:
{'acc': 0.48555815, 'precision': 0.45084134, 'recall': 0.47931388, 'specificity': 0.47931388, 'f1': 0.39396623, 'auroc': 0.69035184, 'binary_precision': 0.40522876, 'binary_recall': 0.0984127, 'binary_specificity': 0.86021507, 'binary_f1_score': 0.15836526}
confusion matrix:
     0   1
0  560  91
1  568  62
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.58, 'precision': 0.63957816, 'recall': 0.58000004, 'specificity': 0.58000004, 'f1': 0.52982736, 'auroc': 0.7398716, 'binary_precision': 0.7307692, 'binary_recall': 0.25333333, 'binary_specificity': 0.9066667, 'binary_f1_score': 0.3762376}
confusion matrix:
     0   1
0  204  21
1  168  57
early stop counter: 6
val acc:0.4855581521987915, best validation acc: 0.5027322173118591, corresponding to test acc:                         0.5844444632530212 / 0.5844444632530212
after epoch: 7,now: 2024-07-23 00:47:01.352975,epoch time: 0:01:19.602125,used: 0:09:27.217551,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_00_37_34_seed_1_22769260
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.6223958, 'precision': 0.62268615, 'recall': 0.62198925, 'specificity': 0.62198925, 'f1': 0.62167597, 'auroc': 0.65529525, 'binary_precision': 0.6188748, 'binary_recall': 0.658725, 'binary_specificity': 0.5852535, 'binary_f1_score': 0.6381784}
confusion matrix:
     0     1
0  889   630
1  530  1023
---- Validation: 
scalar performance:
{'acc': 0.49414518, 'precision': 0.47388816, 'recall': 0.48809525, 'specificity': 0.48809525, 'f1': 0.4103115, 'auroc': 0.70007074, 'binary_precision': 0.44642857, 'binary_recall': 0.11904762, 'binary_specificity': 0.85714287, 'binary_f1_score': 0.18796992}
confusion matrix:
     0   1
0  558  93
1  555  75
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5888889, 'precision': 0.6491251, 'recall': 0.5888889, 'specificity': 0.5888889, 'f1': 0.54271054, 'auroc': 0.7488593, 'binary_precision': 0.74390244, 'binary_recall': 0.2711111, 'binary_specificity': 0.9066667, 'binary_f1_score': 0.39739412}
confusion matrix:
     0   1
0  204  21
1  164  61
new oracle model saved
early stop counter: 7
val acc:0.4941451847553253, best validation acc: 0.5027322173118591, corresponding to test acc:                         0.5844444632530212 / 0.5888888835906982
after epoch: 8,now: 2024-07-23 00:48:22.419501,epoch time: 0:01:21.066526,used: 0:10:48.284077,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_00_37_34_seed_1_22769260
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.6666667, 'precision': 0.66752875, 'recall': 0.66608447, 'specificity': 0.66608447, 'f1': 0.6657139, 'auroc': 0.7075373, 'binary_precision': 0.65833336, 'binary_recall': 0.7107969, 'binary_specificity': 0.62137204, 'binary_f1_score': 0.68355995}
confusion matrix:
     0     1
0  942   574
1  450  1106
---- Validation: 
scalar performance:
{'acc': 0.5019516, 'precision': 0.49171054, 'recall': 0.49603176, 'specificity': 0.49603176, 'f1': 0.42332798, 'auroc': 0.7088728, 'binary_precision': 0.4775281, 'binary_recall': 0.13492064, 'binary_specificity': 0.85714287, 'binary_f1_score': 0.21039604}
confusion matrix:
     0   1
0  558  93
1  545  85
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.60444444, 'precision': 0.6592573, 'recall': 0.60444444, 'specificity': 0.60444444, 'f1': 0.56720483, 'auroc': 0.75715554, 'binary_precision': 0.75268817, 'binary_recall': 0.31111112, 'binary_specificity': 0.8977778, 'binary_f1_score': 0.4402516}
confusion matrix:
     0   1
0  202  23
1  155  70
new oracle model saved
early stop counter: 8
val acc:0.5019515752792358, best validation acc: 0.5027322173118591, corresponding to test acc:                         0.5844444632530212 / 0.6044444441795349
after epoch: 9,now: 2024-07-23 00:49:42.420522,epoch time: 0:01:20.001021,used: 0:12:08.285098,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_00_37_34_seed_1_22769260
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.664388, 'precision': 0.6651795, 'recall': 0.6638879, 'specificity': 0.6638879, 'f1': 0.6635314, 'auroc': 0.71225536, 'binary_precision': 0.656306, 'binary_recall': 0.7065637, 'binary_specificity': 0.6212121, 'binary_f1_score': 0.6805082}
confusion matrix:
     0     1
0  943   575
1  456  1098
---- Validation: 
scalar performance:
{'acc': 0.5066354, 'precision': 0.50149745, 'recall': 0.50071687, 'specificity': 0.50071687, 'f1': 0.42875126, 'auroc': 0.7165898, 'binary_precision': 0.49438202, 'binary_recall': 0.13968255, 'binary_specificity': 0.86175114, 'binary_f1_score': 0.21782179}
confusion matrix:
     0   1
0  561  90
1  542  88
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.61333334, 'precision': 0.670126, 'recall': 0.61333334, 'specificity': 0.61333334, 'f1': 0.578125, 'auroc': 0.76485926, 'binary_precision': 0.76842105, 'binary_recall': 0.32444444, 'binary_specificity': 0.9022222, 'binary_f1_score': 0.45625}
confusion matrix:
     0   1
0  203  22
1  152  73
new oracle model saved
better model found
persisted
after epoch: 10,now: 2024-07-23 00:51:02.993785,epoch time: 0:01:20.573263,used: 0:13:28.858361,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_00_37_34_seed_1_22769260
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.6777344, 'precision': 0.6776835, 'recall': 0.67762864, 'specificity': 0.67762864, 'f1': 0.67764205, 'auroc': 0.7358037, 'binary_precision': 0.68005097, 'binary_recall': 0.6861736, 'binary_specificity': 0.6690837, 'binary_f1_score': 0.6830986}
confusion matrix:
      0     1
0  1015   502
1   488  1067
---- Validation: 
scalar performance:
{'acc': 0.51288056, 'precision': 0.5142289, 'recall': 0.5070661, 'specificity': 0.5070661, 'f1': 0.43895286, 'auroc': 0.7239607, 'binary_precision': 0.516129, 'binary_recall': 0.15238096, 'binary_specificity': 0.86175114, 'binary_f1_score': 0.23529412}
confusion matrix:
     0   1
0  561  90
1  534  96
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.62, 'precision': 0.6761074, 'recall': 0.62, 'specificity': 0.62, 'f1': 0.58711386, 'auroc': 0.77200985, 'binary_precision': 0.7755102, 'binary_recall': 0.33777776, 'binary_specificity': 0.9022222, 'binary_f1_score': 0.47058824}
confusion matrix:
     0   1
0  203  22
1  149  76
new oracle model saved
better model found
persisted
after epoch: 11,now: 2024-07-23 00:52:24.296407,epoch time: 0:01:21.302622,used: 0:14:50.160983,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_00_37_34_seed_1_22769260
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.6998698, 'precision': 0.7001616, 'recall': 0.69955003, 'specificity': 0.69955003, 'f1': 0.699512, 'auroc': 0.7504925, 'binary_precision': 0.69500923, 'binary_recall': 0.72540194, 'binary_specificity': 0.67369807, 'binary_f1_score': 0.7098805}
confusion matrix:
      0     1
0  1022   495
1   427  1128
---- Validation: 
scalar performance:
{'acc': 0.5331772, 'precision': 0.5504669, 'recall': 0.5276754, 'specificity': 0.5276754, 'f1': 0.4704123, 'auroc': 0.7327603, 'binary_precision': 0.5761905, 'binary_recall': 0.1920635, 'binary_specificity': 0.86328727, 'binary_f1_score': 0.28809524}
confusion matrix:
     0    1
0  562   89
1  509  121
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6244444, 'precision': 0.6705653, 'recall': 0.6244444, 'specificity': 0.6244444, 'f1': 0.59721625, 'auroc': 0.78014815, 'binary_precision': 0.7592593, 'binary_recall': 0.36444443, 'binary_specificity': 0.8844444, 'binary_f1_score': 0.4924925}
confusion matrix:
     0   1
0  199  26
1  143  82
new oracle model saved
better model found
persisted
after epoch: 12,now: 2024-07-23 00:53:46.074805,epoch time: 0:01:21.778398,used: 0:16:11.939381,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_00_37_34_seed_1_22769260
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.7294922, 'precision': 0.7300396, 'recall': 0.72915363, 'specificity': 0.72915363, 'f1': 0.72911257, 'auroc': 0.7840029, 'binary_precision': 0.7213717, 'binary_recall': 0.75804377, 'binary_specificity': 0.7002635, 'binary_f1_score': 0.7392532}
confusion matrix:
      0     1
0  1063   455
1   376  1178
---- Validation: 
scalar performance:
{'acc': 0.5441062, 'precision': 0.56676173, 'recall': 0.5388121, 'specificity': 0.5388121, 'f1': 0.48771793, 'auroc': 0.7389657, 'binary_precision': 0.6017699, 'binary_recall': 0.21587302, 'binary_specificity': 0.86175114, 'binary_f1_score': 0.31775704}
confusion matrix:
     0    1
0  561   90
1  494  136
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6333333, 'precision': 0.67422056, 'recall': 0.6333333, 'specificity': 0.6333333, 'f1': 0.6104796, 'auroc': 0.78593576, 'binary_precision': 0.7586207, 'binary_recall': 0.3911111, 'binary_specificity': 0.8755556, 'binary_f1_score': 0.5161291}
confusion matrix:
     0   1
0  197  28
1  137  88
new oracle model saved
better model found
persisted
after epoch: 13,now: 2024-07-23 00:55:07.485486,epoch time: 0:01:21.410681,used: 0:17:33.350062,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_00_37_34_seed_1_22769260
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.72721356, 'precision': 0.7271714, 'recall': 0.7271638, 'specificity': 0.7271638, 'f1': 0.72716725, 'auroc': 0.7912935, 'binary_precision': 0.7302505, 'binary_recall': 0.7311897, 'binary_specificity': 0.7231378, 'binary_f1_score': 0.7307198}
confusion matrix:
      0     1
0  1097   420
1   418  1137
---- Validation: 
scalar performance:
{'acc': 0.54566747, 'precision': 0.5708037, 'recall': 0.540297, 'specificity': 0.540297, 'f1': 0.48767042, 'auroc': 0.7437422, 'binary_precision': 0.6090909, 'binary_recall': 0.21269841, 'binary_specificity': 0.86789554, 'binary_f1_score': 0.31529415}
confusion matrix:
     0    1
0  565   86
1  496  134
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6311111, 'precision': 0.68085337, 'recall': 0.6311111, 'specificity': 0.6311111, 'f1': 0.60387325, 'auroc': 0.79083455, 'binary_precision': 0.7757009, 'binary_recall': 0.36888888, 'binary_specificity': 0.8933333, 'binary_f1_score': 0.5}
confusion matrix:
     0   1
0  201  24
1  142  83
better model found
persisted
after epoch: 14,now: 2024-07-23 00:56:28.150011,epoch time: 0:01:20.664525,used: 0:18:54.014587,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_00_37_34_seed_1_22769260
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.74576825, 'precision': 0.7457806, 'recall': 0.7458134, 'specificity': 0.7458134, 'f1': 0.74576217, 'auroc': 0.8082949, 'binary_precision': 0.75212, 'binary_recall': 0.74195623, 'binary_specificity': 0.7496706, 'binary_f1_score': 0.74700356}
confusion matrix:
      0     1
0  1138   380
1   401  1153
---- Validation: 
scalar performance:
{'acc': 0.5511319, 'precision': 0.5812212, 'recall': 0.5457245, 'specificity': 0.5457245, 'f1': 0.49292824, 'auroc': 0.7496574, 'binary_precision': 0.6267281, 'binary_recall': 0.21587302, 'binary_specificity': 0.875576, 'binary_f1_score': 0.32113343}
confusion matrix:
     0    1
0  570   81
1  494  136
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6288889, 'precision': 0.67894363, 'recall': 0.62888885, 'specificity': 0.62888885, 'f1': 0.60098547, 'auroc': 0.79638517, 'binary_precision': 0.7735849, 'binary_recall': 0.36444443, 'binary_specificity': 0.8933333, 'binary_f1_score': 0.4954683}
confusion matrix:
     0   1
0  201  24
1  143  82
better model found
persisted
after epoch: 15,now: 2024-07-23 00:57:48.573930,epoch time: 0:01:20.423919,used: 0:20:14.438506,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_00_37_34_seed_1_22769260
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.75065106, 'precision': 0.7506168, 'recall': 0.7505888, 'specificity': 0.7505888, 'f1': 0.75059986, 'auroc': 0.82309645, 'binary_precision': 0.7527226, 'binary_recall': 0.75562704, 'binary_specificity': 0.74555045, 'binary_f1_score': 0.754172}
confusion matrix:
      0     1
0  1131   386
1   380  1175
---- Validation: 
scalar performance:
{'acc': 0.57064795, 'precision': 0.6063163, 'recall': 0.5655914, 'specificity': 0.5655914, 'f1': 0.5224401, 'auroc': 0.75626755, 'binary_precision': 0.6639344, 'binary_recall': 0.25714287, 'binary_specificity': 0.87403995, 'binary_f1_score': 0.37070942}
confusion matrix:
     0    1
0  569   82
1  468  162
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.66888887, 'precision': 0.7094356, 'recall': 0.6688889, 'specificity': 0.6688889, 'f1': 0.652048, 'auroc': 0.80268645, 'binary_precision': 0.8015873, 'binary_recall': 0.4488889, 'binary_specificity': 0.8888889, 'binary_f1_score': 0.57549864}
confusion matrix:
     0    1
0  200   25
1  124  101
new oracle model saved
better model found
persisted
after epoch: 16,now: 2024-07-23 00:59:09.373036,epoch time: 0:01:20.799106,used: 0:21:35.237612,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_00_37_34_seed_1_22769260
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.76920575, 'precision': 0.76917106, 'recall': 0.76914537, 'specificity': 0.76914537, 'f1': 0.7691562, 'auroc': 0.83739513, 'binary_precision': 0.77130044, 'binary_recall': 0.7737789, 'binary_specificity': 0.7645119, 'binary_f1_score': 0.77253765}
confusion matrix:
      0     1
0  1159   357
1   352  1204
---- Validation: 
scalar performance:
{'acc': 0.5784543, 'precision': 0.6162536, 'recall': 0.5735023, 'specificity': 0.5735023, 'f1': 0.5331633, 'auroc': 0.76113063, 'binary_precision': 0.6785714, 'binary_recall': 0.27142859, 'binary_specificity': 0.875576, 'binary_f1_score': 0.3877551}
confusion matrix:
     0    1
0  570   81
1  459  171
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6711111, 'precision': 0.7132308, 'recall': 0.6711111, 'specificity': 0.6711111, 'f1': 0.65402603, 'auroc': 0.80697286, 'binary_precision': 0.808, 'binary_recall': 0.4488889, 'binary_specificity': 0.8933333, 'binary_f1_score': 0.5771429}
confusion matrix:
     0    1
0  201   24
1  124  101
new oracle model saved
better model found
persisted
after epoch: 17,now: 2024-07-23 01:00:30.139204,epoch time: 0:01:20.766168,used: 0:22:56.003780,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_00_37_34_seed_1_22769260
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.76660156, 'precision': 0.76656735, 'recall': 0.76658595, 'specificity': 0.76658595, 'f1': 0.7665746, 'auroc': 0.8428366, 'binary_precision': 0.77032256, 'binary_recall': 0.76784563, 'binary_specificity': 0.7653263, 'binary_f1_score': 0.7690821}
confusion matrix:
      0     1
0  1161   356
1   361  1194
---- Validation: 
scalar performance:
{'acc': 0.5909446, 'precision': 0.63090485, 'recall': 0.58617514, 'specificity': 0.58617514, 'f1': 0.5503264, 'auroc': 0.766891, 'binary_precision': 0.69924814, 'binary_recall': 0.2952381, 'binary_specificity': 0.87711215, 'binary_f1_score': 0.4151786}
confusion matrix:
     0    1
0  571   80
1  444  186
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.68222225, 'precision': 0.7197684, 'recall': 0.68222225, 'specificity': 0.68222225, 'f1': 0.66804403, 'auroc': 0.8123852, 'binary_precision': 0.81060606, 'binary_recall': 0.47555557, 'binary_specificity': 0.8888889, 'binary_f1_score': 0.5994398}
confusion matrix:
     0    1
0  200   25
1  118  107
new oracle model saved
better model found
persisted
after epoch: 18,now: 2024-07-23 01:01:51.053408,epoch time: 0:01:20.914204,used: 0:24:16.917984,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_00_37_34_seed_1_22769260
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.78059894, 'precision': 0.7808906, 'recall': 0.78077483, 'specificity': 0.78077483, 'f1': 0.7805914, 'auroc': 0.8480956, 'binary_precision': 0.79333335, 'binary_recall': 0.7657658, 'binary_specificity': 0.79578394, 'binary_f1_score': 0.7793058}
confusion matrix:
      0     1
0  1208   310
1   364  1190
---- Validation: 
scalar performance:
{'acc': 0.5948478, 'precision': 0.6379298, 'recall': 0.590041, 'specificity': 0.590041, 'f1': 0.55392414, 'auroc': 0.77043617, 'binary_precision': 0.7110266, 'binary_recall': 0.2968254, 'binary_specificity': 0.88325655, 'binary_f1_score': 0.418813}
confusion matrix:
     0    1
0  575   76
1  443  187
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.67777777, 'precision': 0.7183618, 'recall': 0.67777777, 'specificity': 0.67777777, 'f1': 0.6620764, 'auroc': 0.8156642, 'binary_precision': 0.8125, 'binary_recall': 0.46222222, 'binary_specificity': 0.8933333, 'binary_f1_score': 0.5892351}
confusion matrix:
     0    1
0  201   24
1  121  104
better model found
persisted
after epoch: 19,now: 2024-07-23 01:03:11.145109,epoch time: 0:01:20.091701,used: 0:25:37.009685,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_00_37_34_seed_1_22769260
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.78515625, 'precision': 0.78528094, 'recall': 0.78527176, 'specificity': 0.78527176, 'f1': 0.78515613, 'auroc': 0.856496, 'binary_precision': 0.7948549, 'binary_recall': 0.7754183, 'binary_specificity': 0.7951252, 'binary_f1_score': 0.78501624}
confusion matrix:
      0     1
0  1207   311
1   349  1205
---- Validation: 
scalar performance:
{'acc': 0.61358315, 'precision': 0.6546614, 'recall': 0.6091654, 'specificity': 0.6091654, 'f1': 0.58084595, 'auroc': 0.77624905, 'binary_precision': 0.7303754, 'binary_recall': 0.33968255, 'binary_specificity': 0.8786482, 'binary_f1_score': 0.4637053}
confusion matrix:
     0    1
0  572   79
1  416  214
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6911111, 'precision': 0.72470737, 'recall': 0.6911111, 'specificity': 0.6911111, 'f1': 0.67911726, 'auroc': 0.8213531, 'binary_precision': 0.8115942, 'binary_recall': 0.4977778, 'binary_specificity': 0.8844444, 'binary_f1_score': 0.6170799}
confusion matrix:
     0    1
0  199   26
1  113  112
new oracle model saved
better model found
persisted
after epoch: 20,now: 2024-07-23 01:04:26.197926,epoch time: 0:01:15.052817,used: 0:26:52.062502,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_00_37_34_seed_1_22769260
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.7936198, 'precision': 0.79385114, 'recall': 0.79376745, 'specificity': 0.79376745, 'f1': 0.7936155, 'auroc': 0.8603234, 'binary_precision': 0.8053156, 'binary_recall': 0.780425, 'binary_specificity': 0.80710995, 'binary_f1_score': 0.79267496}
confusion matrix:
      0     1
0  1226   293
1   341  1212
---- Validation: 
scalar performance:
{'acc': 0.6284153, 'precision': 0.66650015, 'recall': 0.6243216, 'specificity': 0.6243216, 'f1': 0.60148543, 'auroc': 0.7818399, 'binary_precision': 0.7421384, 'binary_recall': 0.37460318, 'binary_specificity': 0.87403995, 'binary_f1_score': 0.4978903}
confusion matrix:
     0    1
0  569   82
1  394  236
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7022222, 'precision': 0.73148674, 'recall': 0.7022222, 'specificity': 0.7022222, 'f1': 0.69250387, 'auroc': 0.8273778, 'binary_precision': 0.8137931, 'binary_recall': 0.52444446, 'binary_specificity': 0.88, 'binary_f1_score': 0.6378379}
confusion matrix:
     0    1
0  198   27
1  107  118
new oracle model saved
better model found
persisted
after epoch: 21,now: 2024-07-23 01:05:38.359027,epoch time: 0:01:12.161101,used: 0:28:04.223603,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_00_37_34_seed_1_22769260
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.7942708, 'precision': 0.7944392, 'recall': 0.7944282, 'specificity': 0.7944282, 'f1': 0.79427075, 'auroc': 0.87772745, 'binary_precision': 0.8056841, 'binary_recall': 0.7829159, 'binary_specificity': 0.80594057, 'binary_f1_score': 0.7941369}
confusion matrix:
      0     1
0  1221   294
1   338  1219
---- Validation: 
scalar performance:
{'acc': 0.62763464, 'precision': 0.6685395, 'recall': 0.6234255, 'specificity': 0.6234255, 'f1': 0.5990563, 'auroc': 0.7855875, 'binary_precision': 0.74757284, 'binary_recall': 0.36666667, 'binary_specificity': 0.88018435, 'binary_f1_score': 0.49201283}
confusion matrix:
     0    1
0  573   78
1  399  231
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.69555557, 'precision': 0.72811055, 'recall': 0.69555557, 'specificity': 0.69555557, 'f1': 0.68429136, 'auroc': 0.8307556, 'binary_precision': 0.8142857, 'binary_recall': 0.50666666, 'binary_specificity': 0.8844444, 'binary_f1_score': 0.62465745}
confusion matrix:
     0    1
0  199   26
1  111  114
early stop counter: 1
val acc:0.6276346445083618, best validation acc: 0.6284152865409851, corresponding to test acc:                         0.7022222280502319 / 0.7022222280502319
after epoch: 22,now: 2024-07-23 01:06:49.910998,epoch time: 0:01:11.551971,used: 0:29:15.775574,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_00_37_34_seed_1_22769260
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.7942708, 'precision': 0.79448736, 'recall': 0.79443944, 'specificity': 0.79443944, 'f1': 0.79426944, 'auroc': 0.8686125, 'binary_precision': 0.806366, 'binary_recall': 0.781491, 'binary_specificity': 0.8073879, 'binary_f1_score': 0.79373366}
confusion matrix:
      0     1
0  1224   292
1   340  1216
---- Validation: 
scalar performance:
{'acc': 0.6479313, 'precision': 0.68442315, 'recall': 0.6441372, 'specificity': 0.6441372, 'f1': 0.62603045, 'auroc': 0.79091996, 'binary_precision': 0.76246333, 'binary_recall': 0.41269842, 'binary_specificity': 0.875576, 'binary_f1_score': 0.5355304}
confusion matrix:
     0    1
0  570   81
1  370  260
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7177778, 'precision': 0.743399, 'recall': 0.7177778, 'specificity': 0.7177778, 'f1': 0.7101501, 'auroc': 0.83638513, 'binary_precision': 0.82236844, 'binary_recall': 0.5555556, 'binary_specificity': 0.88, 'binary_f1_score': 0.66313004}
confusion matrix:
     0    1
0  198   27
1  100  125
new oracle model saved
better model found
persisted
after epoch: 23,now: 2024-07-23 01:08:01.890374,epoch time: 0:01:11.979376,used: 0:30:27.754950,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_00_37_34_seed_1_22769260
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.8069661, 'precision': 0.8074868, 'recall': 0.80722594, 'specificity': 0.80722594, 'f1': 0.80694896, 'auroc': 0.87988114, 'binary_precision': 0.82380635, 'binary_recall': 0.7872751, 'binary_specificity': 0.8271768, 'binary_f1_score': 0.80512655}
confusion matrix:
      0     1
0  1254   262
1   331  1225
---- Validation: 
scalar performance:
{'acc': 0.6557377, 'precision': 0.68979406, 'recall': 0.65212494, 'specificity': 0.65212494, 'f1': 0.63631976, 'auroc': 0.7952454, 'binary_precision': 0.7661972, 'binary_recall': 0.43174604, 'binary_specificity': 0.8725038, 'binary_f1_score': 0.5522843}
confusion matrix:
     0    1
0  568   83
1  358  272
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7177778, 'precision': 0.74186116, 'recall': 0.7177778, 'specificity': 0.7177778, 'f1': 0.71057284, 'auroc': 0.84045434, 'binary_precision': 0.8181818, 'binary_recall': 0.56, 'binary_specificity': 0.8755556, 'binary_f1_score': 0.6649077}
confusion matrix:
     0    1
0  197   28
1   99  126
better model found
persisted
after epoch: 24,now: 2024-07-23 01:09:14.013276,epoch time: 0:01:12.122902,used: 0:31:39.877852,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_00_37_34_seed_1_22769260
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.8180339, 'precision': 0.8180331, 'recall': 0.8179296, 'specificity': 0.8179296, 'f1': 0.8179667, 'auroc': 0.8901663, 'binary_precision': 0.8180662, 'binary_recall': 0.82488775, 'binary_specificity': 0.81097156, 'binary_f1_score': 0.82146287}
confusion matrix:
      0     1
0  1227   286
1   273  1286
---- Validation: 
scalar performance:
{'acc': 0.6736924, 'precision': 0.7018275, 'recall': 0.6705069, 'specificity': 0.6705069, 'f1': 0.65933275, 'auroc': 0.80077535, 'binary_precision': 0.77319586, 'binary_recall': 0.47619048, 'binary_specificity': 0.86482334, 'binary_f1_score': 0.58939093}
confusion matrix:
     0    1
0  563   88
1  330  300
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7266667, 'precision': 0.74730605, 'recall': 0.7266667, 'specificity': 0.7266667, 'f1': 0.72084224, 'auroc': 0.8453531, 'binary_precision': 0.81875, 'binary_recall': 0.5822222, 'binary_specificity': 0.8711111, 'binary_f1_score': 0.6805195}
confusion matrix:
     0    1
0  196   29
1   94  131
new oracle model saved
better model found
persisted
after epoch: 25,now: 2024-07-23 01:10:26.572218,epoch time: 0:01:12.558942,used: 0:32:52.436794,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_00_37_34_seed_1_22769260
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.8229167, 'precision': 0.8231926, 'recall': 0.8231071, 'specificity': 0.8231071, 'f1': 0.822914, 'auroc': 0.89812434, 'binary_precision': 0.83643615, 'binary_recall': 0.8084833, 'binary_specificity': 0.8377309, 'binary_f1_score': 0.8222223}
confusion matrix:
      0     1
0  1270   246
1   298  1258
---- Validation: 
scalar performance:
{'acc': 0.6651054, 'precision': 0.6976431, 'recall': 0.66164875, 'specificity': 0.66164875, 'f1': 0.6477939, 'auroc': 0.80281866, 'binary_precision': 0.773842, 'binary_recall': 0.45079365, 'binary_specificity': 0.8725038, 'binary_f1_score': 0.5697091}
confusion matrix:
     0    1
0  568   83
1  346  284
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7222222, 'precision': 0.7452904, 'recall': 0.7222222, 'specificity': 0.7222222, 'f1': 0.7155341, 'auroc': 0.8469926, 'binary_precision': 0.82051283, 'binary_recall': 0.5688889, 'binary_specificity': 0.8755556, 'binary_f1_score': 0.671916}
confusion matrix:
     0    1
0  197   28
1   97  128
early stop counter: 1
val acc:0.665105402469635, best validation acc: 0.6736924052238464, corresponding to test acc:                         0.7266666889190674 / 0.7266666889190674
after epoch: 26,now: 2024-07-23 01:11:39.170979,epoch time: 0:01:12.598761,used: 0:34:05.035555,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_00_37_34_seed_1_22769260
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.81347656, 'precision': 0.8139764, 'recall': 0.81371784, 'specificity': 0.81371784, 'f1': 0.81345993, 'auroc': 0.8906189, 'binary_precision': 0.8299731, 'binary_recall': 0.7942122, 'binary_specificity': 0.83322346, 'binary_f1_score': 0.811699}
confusion matrix:
      0     1
0  1264   253
1   320  1235
---- Validation: 
scalar performance:
{'acc': 0.6666667, 'precision': 0.69955254, 'recall': 0.66321045, 'specificity': 0.66321045, 'f1': 0.6494359, 'auroc': 0.8058835, 'binary_precision': 0.77656674, 'binary_recall': 0.45238096, 'binary_specificity': 0.87403995, 'binary_f1_score': 0.5717152}
confusion matrix:
     0    1
0  569   82
1  345  285
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7266667, 'precision': 0.7501962, 'recall': 0.7266667, 'specificity': 0.7266667, 'f1': 0.7200855, 'auroc': 0.85068643, 'binary_precision': 0.8269231, 'binary_recall': 0.5733333, 'binary_specificity': 0.88, 'binary_f1_score': 0.6771653}
confusion matrix:
     0    1
0  198   27
1   96  129
early stop counter: 2
val acc:0.6666666865348816, best validation acc: 0.6736924052238464, corresponding to test acc:                         0.7266666889190674 / 0.7266666889190674
after epoch: 27,now: 2024-07-23 01:12:51.106023,epoch time: 0:01:11.935044,used: 0:35:16.970599,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_00_37_34_seed_1_22769260
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.8248698, 'precision': 0.8250151, 'recall': 0.8250041, 'specificity': 0.8250041, 'f1': 0.82486975, 'auroc': 0.90355265, 'binary_precision': 0.8356436, 'binary_recall': 0.8141479, 'binary_specificity': 0.83586025, 'binary_f1_score': 0.8247557}
confusion matrix:
      0     1
0  1268   249
1   289  1266
---- Validation: 
scalar performance:
{'acc': 0.6869633, 'precision': 0.7149079, 'recall': 0.68389654, 'specificity': 0.68389654, 'f1': 0.67415226, 'auroc': 0.80886793, 'binary_precision': 0.7884131, 'binary_recall': 0.4968254, 'binary_specificity': 0.87096775, 'binary_f1_score': 0.60954237}
confusion matrix:
     0    1
0  567   84
1  317  313
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.72888887, 'precision': 0.7504377, 'recall': 0.72888887, 'specificity': 0.72888887, 'f1': 0.7229288, 'auroc': 0.85368896, 'binary_precision': 0.8238994, 'binary_recall': 0.5822222, 'binary_specificity': 0.8755556, 'binary_f1_score': 0.6822917}
confusion matrix:
     0    1
0  197   28
1   94  131
new oracle model saved
better model found
persisted
after epoch: 28,now: 2024-07-23 01:14:03.656006,epoch time: 0:01:12.549983,used: 0:36:29.520582,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_00_37_34_seed_1_22769260
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.8203125, 'precision': 0.8207735, 'recall': 0.82059395, 'specificity': 0.82059395, 'f1': 0.8203049, 'auroc': 0.89868355, 'binary_precision': 0.83724046, 'binary_recall': 0.801796, 'binary_specificity': 0.83939195, 'binary_f1_score': 0.819135}
confusion matrix:
      0     1
0  1270   243
1   309  1250
---- Validation: 
scalar performance:
{'acc': 0.69320846, 'precision': 0.72048473, 'recall': 0.6902202, 'specificity': 0.6902202, 'f1': 0.681262, 'auroc': 0.81140375, 'binary_precision': 0.7940447, 'binary_recall': 0.50793654, 'binary_specificity': 0.8725038, 'binary_f1_score': 0.6195547}
confusion matrix:
     0    1
0  568   83
1  310  320
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.73777777, 'precision': 0.757316, 'recall': 0.7377778, 'specificity': 0.7377778, 'f1': 0.7327038, 'auroc': 0.85590124, 'binary_precision': 0.82822084, 'binary_recall': 0.6, 'binary_specificity': 0.8755556, 'binary_f1_score': 0.6958763}
confusion matrix:
     0    1
0  197   28
1   90  135
new oracle model saved
better model found
persisted
after epoch: 29,now: 2024-07-23 01:15:16.304948,epoch time: 0:01:12.648942,used: 0:37:42.169524,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_00_37_34_seed_1_22769260
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.8225911, 'precision': 0.82365733, 'recall': 0.8229045, 'specificity': 0.8229045, 'f1': 0.82252574, 'auroc': 0.90710413, 'binary_precision': 0.8452055, 'binary_recall': 0.7945911, 'binary_specificity': 0.8512179, 'binary_f1_score': 0.8191172}
confusion matrix:
      0     1
0  1293   226
1   319  1234
---- Validation: 
scalar performance:
{'acc': 0.6752537, 'precision': 0.7097287, 'recall': 0.6718126, 'specificity': 0.6718126, 'f1': 0.65859085, 'auroc': 0.81256914, 'binary_precision': 0.7907609, 'binary_recall': 0.46190476, 'binary_specificity': 0.8817204, 'binary_f1_score': 0.58316636}
confusion matrix:
     0    1
0  574   77
1  339  291
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7266667, 'precision': 0.75173306, 'recall': 0.7266667, 'specificity': 0.7266667, 'f1': 0.71968865, 'auroc': 0.8572049, 'binary_precision': 0.83116883, 'binary_recall': 0.5688889, 'binary_specificity': 0.8844444, 'binary_f1_score': 0.6754617}
confusion matrix:
     0    1
0  199   26
1   97  128
early stop counter: 1
val acc:0.675253689289093, best validation acc: 0.6932084560394287, corresponding to test acc:                         0.7377777695655823 / 0.7377777695655823
after epoch: 30,now: 2024-07-23 01:16:28.488656,epoch time: 0:01:12.183708,used: 0:38:54.353232,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_00_37_34_seed_1_22769260
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 0:38:54.353232 at 2024-07-23 01:16:28.488656
persisted model performance metric: 

scalar performance:
{'acc': 0.73777777, 'precision': 0.757316, 'recall': 0.7377778, 'specificity': 0.7377778, 'f1': 0.7327038, 'auroc': 0.85590124, 'binary_precision': 0.82822084, 'binary_recall': 0.6, 'binary_specificity': 0.8755556, 'binary_f1_score': 0.6958763}
confusion matrix:
     0    1
0  197   28
1   90  135
oracle model performance metric: 

scalar performance:
{'acc': 0.73777777, 'precision': 0.757316, 'recall': 0.7377778, 'specificity': 0.7377778, 'f1': 0.7327038, 'auroc': 0.85590124, 'binary_precision': 0.82822084, 'binary_recall': 0.6, 'binary_specificity': 0.8755556, 'binary_f1_score': 0.6958763}
confusion matrix:
     0    1
0  197   28
1   90  135
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_dial_lr1e5_bs16_allfreeze_2024-07-22_23-46-53/rule_results/4.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_dial_lr1e5_bs16_allfreeze_2024-07-22_23-46-53/confusion_matrix/4.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 189882 KiB | 460555 KiB |  79388 GiB |  79388 GiB |
|       from large pool | 173494 KiB | 428048 KiB |  77747 GiB |  77747 GiB |
|       from small pool |  16388 KiB |  37418 KiB |   1641 GiB |   1641 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 189882 KiB | 460555 KiB |  79388 GiB |  79388 GiB |
|       from large pool | 173494 KiB | 428048 KiB |  77747 GiB |  77747 GiB |
|       from small pool |  16388 KiB |  37418 KiB |   1641 GiB |   1641 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 189010 KiB | 457292 KiB |  79383 GiB |  79382 GiB |
|       from large pool | 172814 KiB | 424940 KiB |  77745 GiB |  77745 GiB |
|       from small pool |  16196 KiB |  37230 KiB |   1637 GiB |   1637 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 530432 KiB | 530432 KiB |    796 MiB | 284672 KiB |
|       from large pool | 487424 KiB | 487424 KiB |    738 MiB | 268288 KiB |
|       from small pool |  43008 KiB |  43008 KiB |     58 MiB |  16384 KiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  37445 KiB |  84599 KiB |  44384 GiB |  44384 GiB |
|       from large pool |  31306 KiB |  79555 KiB |  42701 GiB |  42701 GiB |
|       from small pool |   6139 KiB |  11196 KiB |   1683 GiB |   1683 GiB |
|---------------------------------------------------------------------------|
| Allocations           |     788    |    1159    |   17156 K  |   17155 K  |
|       from large pool |      76    |     158    |    7673 K  |    7673 K  |
|       from small pool |     712    |    1008    |    9482 K  |    9481 K  |
|---------------------------------------------------------------------------|
| Active allocs         |     788    |    1159    |   17156 K  |   17155 K  |
|       from large pool |      76    |     158    |    7673 K  |    7673 K  |
|       from small pool |     712    |    1008    |    9482 K  |    9481 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      43    |      43    |      62    |      19    |
|       from large pool |      22    |      22    |      33    |      11    |
|       from small pool |      21    |      21    |      29    |       8    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      37    |     216    |   10273 K  |   10273 K  |
|       from large pool |      10    |      22    |    4604 K  |    4604 K  |
|       from small pool |      27    |     206    |    5669 K  |    5669 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  17088 KiB | 460555 KiB |  79388 GiB |  79388 GiB |
|       from large pool |  17088 KiB | 428048 KiB |  77747 GiB |  77747 GiB |
|       from small pool |      0 KiB |  37418 KiB |   1641 GiB |   1641 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  17088 KiB | 460555 KiB |  79388 GiB |  79388 GiB |
|       from large pool |  17088 KiB | 428048 KiB |  77747 GiB |  77747 GiB |
|       from small pool |      0 KiB |  37418 KiB |   1641 GiB |   1641 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB | 457292 KiB |  79383 GiB |  79383 GiB |
|       from large pool |  16640 KiB | 424940 KiB |  77745 GiB |  77745 GiB |
|       from small pool |      0 KiB |  37230 KiB |   1637 GiB |   1637 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 227328 KiB | 530432 KiB |    796 MiB | 587776 KiB |
|       from large pool | 204800 KiB | 487424 KiB |    738 MiB | 550912 KiB |
|       from small pool |  22528 KiB |  43008 KiB |     58 MiB |  36864 KiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  23872 KiB |  84599 KiB |  44384 GiB |  44384 GiB |
|       from large pool |  23872 KiB |  79555 KiB |  42701 GiB |  42701 GiB |
|       from small pool |      0 KiB |  11196 KiB |   1683 GiB |   1683 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    1159    |   17156 K  |   17156 K  |
|       from large pool |       2    |     158    |    7673 K  |    7673 K  |
|       from small pool |       0    |    1008    |    9482 K  |    9482 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    1159    |   17156 K  |   17156 K  |
|       from large pool |       2    |     158    |    7673 K  |    7673 K  |
|       from small pool |       0    |    1008    |    9482 K  |    9482 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      21    |      43    |      62    |      41    |
|       from large pool |      10    |      22    |      33    |      23    |
|       from small pool |      11    |      21    |      29    |      18    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     216    |   10274 K  |   10274 K  |
|       from large pool |       3    |      22    |    4604 K  |    4604 K  |
|       from small pool |       0    |     206    |    5669 K  |    5669 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  17088 KiB | 460555 KiB |  79388 GiB |  79388 GiB |
|       from large pool |  17088 KiB | 428048 KiB |  77747 GiB |  77747 GiB |
|       from small pool |      0 KiB |  37418 KiB |   1641 GiB |   1641 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  17088 KiB | 460555 KiB |  79388 GiB |  79388 GiB |
|       from large pool |  17088 KiB | 428048 KiB |  77747 GiB |  77747 GiB |
|       from small pool |      0 KiB |  37418 KiB |   1641 GiB |   1641 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB | 457292 KiB |  79383 GiB |  79383 GiB |
|       from large pool |  16640 KiB | 424940 KiB |  77745 GiB |  77745 GiB |
|       from small pool |      0 KiB |  37230 KiB |   1637 GiB |   1637 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 227328 KiB | 530432 KiB |    796 MiB | 587776 KiB |
|       from large pool | 204800 KiB | 487424 KiB |    738 MiB | 550912 KiB |
|       from small pool |  22528 KiB |  43008 KiB |     58 MiB |  36864 KiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  23872 KiB |  84599 KiB |  44384 GiB |  44384 GiB |
|       from large pool |  23872 KiB |  79555 KiB |  42701 GiB |  42701 GiB |
|       from small pool |      0 KiB |  11196 KiB |   1683 GiB |   1683 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    1159    |   17156 K  |   17156 K  |
|       from large pool |       2    |     158    |    7673 K  |    7673 K  |
|       from small pool |       0    |    1008    |    9482 K  |    9482 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    1159    |   17156 K  |   17156 K  |
|       from large pool |       2    |     158    |    7673 K  |    7673 K  |
|       from small pool |       0    |    1008    |    9482 K  |    9482 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      21    |      43    |      62    |      41    |
|       from large pool |      10    |      22    |      33    |      23    |
|       from small pool |      11    |      21    |      29    |      18    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     216    |   10274 K  |   10274 K  |
|       from large pool |       3    |      22    |    4604 K  |    4604 K  |
|       from small pool |       0    |     206    |    5669 K  |    5669 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'888c1ef2'
model name: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_01_17_48_seed_2_22769260

 Experiment start at: 2024-07-23 01:17:48.715475
before training, model accuracy: 0.41203704476356506
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.53075916, 'precision': 0.5450232, 'recall': 0.53280675, 'specificity': 0.53280675, 'f1': 0.49770027, 'auroc': 0.57357717, 'binary_precision': 0.5724044, 'binary_recall': 0.27207792, 'binary_specificity': 0.79353565, 'binary_f1_score': 0.368838}
confusion matrix:
      0    1
0  1203  313
1  1121  419
---- Validation: 
scalar performance:
{'acc': 0.63615024, 'precision': 0.64552516, 'recall': 0.6322053, 'specificity': 0.6322053, 'f1': 0.6259543, 'auroc': 0.65925467, 'binary_precision': 0.6764045, 'binary_recall': 0.48392284, 'binary_specificity': 0.7804878, 'binary_f1_score': 0.5641987}
confusion matrix:
     0    1
0  512  144
1  321  301
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.3564815, 'precision': 0.33366454, 'recall': 0.3564815, 'specificity': 0.3564815, 'f1': 0.33362925, 'auroc': 0.29325277, 'binary_precision': 0.2720588, 'binary_recall': 0.1712963, 'binary_specificity': 0.5416667, 'binary_f1_score': 0.21022727}
confusion matrix:
     0   1
0  117  99
1  179  37
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-23 01:19:02.316993,epoch time: 0:01:13.601518,used: 0:01:13.601518,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_01_17_48_seed_2_22769260
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.55399215, 'precision': 0.5559758, 'recall': 0.5546097, 'specificity': 0.5546097, 'f1': 0.5515176, 'auroc': 0.5959599, 'binary_precision': 0.5686579, 'binary_recall': 0.47597402, 'binary_specificity': 0.6332454, 'binary_f1_score': 0.51820433}
confusion matrix:
     0    1
0  960  556
1  807  733
---- Validation: 
scalar performance:
{'acc': 0.65571207, 'precision': 0.6554539, 'recall': 0.6554265, 'specificity': 0.6554265, 'f1': 0.65543866, 'auroc': 0.67603153, 'binary_precision': 0.6467742, 'binary_recall': 0.6446945, 'binary_specificity': 0.66615856, 'binary_f1_score': 0.6457327}
confusion matrix:
     0    1
0  437  219
1  221  401
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.36342594, 'precision': 0.3630708, 'recall': 0.3634259, 'specificity': 0.3634259, 'f1': 0.36301294, 'auroc': 0.31230712, 'binary_precision': 0.37004405, 'binary_recall': 0.3888889, 'binary_specificity': 0.33796296, 'binary_f1_score': 0.37923253}
confusion matrix:
     0    1
0   73  143
1  132   84
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-07-23 01:20:14.274122,epoch time: 0:01:11.957129,used: 0:02:25.558647,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_01_17_48_seed_2_22769260
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.5945681, 'precision': 0.59502506, 'recall': 0.5947769, 'specificity': 0.5947769, 'f1': 0.5943731, 'auroc': 0.6388762, 'binary_precision': 0.6038647, 'binary_recall': 0.5681818, 'binary_specificity': 0.62137204, 'binary_f1_score': 0.5854801}
confusion matrix:
     0    1
0  942  574
1  665  875
---- Validation: 
scalar performance:
{'acc': 0.64788735, 'precision': 0.6495658, 'recall': 0.6489295, 'specificity': 0.6489295, 'f1': 0.6477182, 'auroc': 0.69022036, 'binary_precision': 0.625731, 'binary_recall': 0.6881029, 'binary_specificity': 0.6097561, 'binary_f1_score': 0.65543646}
confusion matrix:
     0    1
0  400  256
1  194  428
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.41435185, 'precision': 0.40886492, 'recall': 0.41435182, 'specificity': 0.41435182, 'f1': 0.40540218, 'auroc': 0.3386274, 'binary_precision': 0.43122676, 'binary_recall': 0.537037, 'binary_specificity': 0.29166666, 'binary_f1_score': 0.47835052}
confusion matrix:
     0    1
0   63  153
1  100  116
new oracle model saved
early stop counter: 1
val acc:0.6478873491287231, best validation acc: 0.6557120680809021, corresponding to test acc:                         0.36342594027519226 / 0.41435185074806213
after epoch: 3,now: 2024-07-23 01:21:25.396193,epoch time: 0:01:11.122071,used: 0:03:36.680718,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_01_17_48_seed_2_22769260
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.627945, 'precision': 0.62800455, 'recall': 0.62799656, 'specificity': 0.62799656, 'f1': 0.627944, 'auroc': 0.6697048, 'binary_precision': 0.6333554, 'binary_recall': 0.62142855, 'binary_specificity': 0.63456464, 'binary_f1_score': 0.6273353}
confusion matrix:
     0    1
0  962  554
1  583  957
---- Validation: 
scalar performance:
{'acc': 0.6455399, 'precision': 0.64809465, 'recall': 0.6468929, 'specificity': 0.6468929, 'f1': 0.64513814, 'auroc': 0.7029228, 'binary_precision': 0.620887, 'binary_recall': 0.6977492, 'binary_specificity': 0.5960366, 'binary_f1_score': 0.65707797}
confusion matrix:
     0    1
0  391  265
1  188  434
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.4398148, 'precision': 0.43402255, 'recall': 0.4398148, 'specificity': 0.4398148, 'f1': 0.42724407, 'auroc': 0.37259945, 'binary_precision': 0.45357144, 'binary_recall': 0.587963, 'binary_specificity': 0.29166666, 'binary_f1_score': 0.5120968}
confusion matrix:
    0    1
0  63  153
1  89  127
new oracle model saved
early stop counter: 2
val acc:0.6455398797988892, best validation acc: 0.6557120680809021, corresponding to test acc:                         0.36342594027519226 / 0.43981480598449707
after epoch: 4,now: 2024-07-23 01:22:36.064035,epoch time: 0:01:10.667842,used: 0:04:47.348560,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_01_17_48_seed_2_22769260
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.6439791, 'precision': 0.6439529, 'recall': 0.64392626, 'specificity': 0.64392626, 'f1': 0.6439296, 'auroc': 0.7003174, 'binary_precision': 0.64561856, 'binary_recall': 0.65064937, 'binary_specificity': 0.63720316, 'binary_f1_score': 0.64812416}
confusion matrix:
     0     1
0  966   550
1  538  1002
---- Validation: 
scalar performance:
{'acc': 0.6596244, 'precision': 0.6617782, 'recall': 0.6608207, 'specificity': 0.6608207, 'f1': 0.659369, 'auroc': 0.71207404, 'binary_precision': 0.6353111, 'binary_recall': 0.7057878, 'binary_specificity': 0.61585367, 'binary_f1_score': 0.66869766}
confusion matrix:
     0    1
0  404  252
1  183  439
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.4513889, 'precision': 0.44686908, 'recall': 0.4513889, 'specificity': 0.4513889, 'f1': 0.43946785, 'auroc': 0.4011274, 'binary_precision': 0.4623656, 'binary_recall': 0.5972222, 'binary_specificity': 0.30555555, 'binary_f1_score': 0.5212121}
confusion matrix:
    0    1
0  66  150
1  87  129
new oracle model saved
better model found
persisted
after epoch: 5,now: 2024-07-23 01:23:51.978592,epoch time: 0:01:15.914557,used: 0:06:03.263117,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_01_17_48_seed_2_22769260
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.66066754, 'precision': 0.66070414, 'recall': 0.6607057, 'specificity': 0.6607057, 'f1': 0.66066754, 'auroc': 0.7213579, 'binary_precision': 0.66578776, 'binary_recall': 0.65584415, 'binary_specificity': 0.6655673, 'binary_f1_score': 0.6607786}
confusion matrix:
      0     1
0  1009   507
1   530  1010
---- Validation: 
scalar performance:
{'acc': 0.6658842, 'precision': 0.6677109, 'recall': 0.66695994, 'specificity': 0.66695994, 'f1': 0.6657121, 'auroc': 0.7217498, 'binary_precision': 0.6423358, 'binary_recall': 0.7073955, 'binary_specificity': 0.6265244, 'binary_f1_score': 0.67329764}
confusion matrix:
     0    1
0  411  245
1  182  440
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.4675926, 'precision': 0.46468282, 'recall': 0.4675926, 'specificity': 0.4675926, 'f1': 0.45639566, 'auroc': 0.43126285, 'binary_precision': 0.47482014, 'binary_recall': 0.6111111, 'binary_specificity': 0.32407406, 'binary_f1_score': 0.5344129}
confusion matrix:
    0    1
0  70  146
1  84  132
new oracle model saved
better model found
persisted
after epoch: 6,now: 2024-07-23 01:25:11.462688,epoch time: 0:01:19.484096,used: 0:07:22.747213,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_01_17_48_seed_2_22769260
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.69077224, 'precision': 0.6907624, 'recall': 0.6907146, 'specificity': 0.6907146, 'f1': 0.69072187, 'auroc': 0.74703896, 'binary_precision': 0.69131833, 'binary_recall': 0.6980519, 'binary_specificity': 0.6833773, 'binary_f1_score': 0.6946688}
confusion matrix:
      0     1
0  1036   480
1   465  1075
---- Validation: 
scalar performance:
{'acc': 0.6690141, 'precision': 0.6708571, 'recall': 0.67009205, 'specificity': 0.67009205, 'f1': 0.6688435, 'auroc': 0.72976387, 'binary_precision': 0.64525545, 'binary_recall': 0.7106109, 'binary_specificity': 0.62957317, 'binary_f1_score': 0.67635804}
confusion matrix:
     0    1
0  413  243
1  180  442
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.47916666, 'precision': 0.47736114, 'recall': 0.4791667, 'specificity': 0.4791667, 'f1': 0.46857077, 'auroc': 0.45619, 'binary_precision': 0.48375452, 'binary_recall': 0.6203704, 'binary_specificity': 0.33796296, 'binary_f1_score': 0.5436106}
confusion matrix:
    0    1
0  73  143
1  82  134
new oracle model saved
better model found
persisted
after epoch: 7,now: 2024-07-23 01:26:29.153956,epoch time: 0:01:17.691268,used: 0:08:40.438481,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_01_17_48_seed_2_22769260
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.6927356, 'precision': 0.6932652, 'recall': 0.6924982, 'specificity': 0.6924982, 'f1': 0.6923442, 'auroc': 0.7704078, 'binary_precision': 0.68492305, 'binary_recall': 0.7227273, 'binary_specificity': 0.6622691, 'binary_f1_score': 0.7033175}
confusion matrix:
      0     1
0  1004   512
1   427  1113
---- Validation: 
scalar performance:
{'acc': 0.6690141, 'precision': 0.6711025, 'recall': 0.6701754, 'specificity': 0.6701754, 'f1': 0.6687933, 'auroc': 0.7360599, 'binary_precision': 0.6444122, 'binary_recall': 0.71382636, 'binary_specificity': 0.6265244, 'binary_f1_score': 0.6773456}
confusion matrix:
     0    1
0  411  245
1  178  444
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5138889, 'precision': 0.5155187, 'recall': 0.5138889, 'specificity': 0.5138889, 'f1': 0.5007814, 'auroc': 0.4786737, 'binary_precision': 0.5104895, 'binary_recall': 0.6759259, 'binary_specificity': 0.35185185, 'binary_f1_score': 0.5816733}
confusion matrix:
    0    1
0  76  140
1  70  146
new oracle model saved
early stop counter: 1
val acc:0.6690140962600708, best validation acc: 0.6690140962600708, corresponding to test acc:                         0.4791666567325592 / 0.5138888955116272
after epoch: 8,now: 2024-07-23 01:27:47.973558,epoch time: 0:01:18.819602,used: 0:09:59.258083,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_01_17_48_seed_2_22769260
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.72447646, 'precision': 0.7244645, 'recall': 0.72447485, 'specificity': 0.72447485, 'f1': 0.72446686, 'auroc': 0.7947806, 'binary_precision': 0.7275098, 'binary_recall': 0.7246753, 'binary_specificity': 0.7242744, 'binary_f1_score': 0.7260898}
confusion matrix:
      0     1
0  1098   418
1   424  1116
---- Validation: 
scalar performance:
{'acc': 0.68075114, 'precision': 0.681465, 'recall': 0.68135834, 'specificity': 0.68135834, 'f1': 0.6807442, 'auroc': 0.74153256, 'binary_precision': 0.6616314, 'binary_recall': 0.70418006, 'binary_specificity': 0.6585366, 'binary_f1_score': 0.682243}
confusion matrix:
     0    1
0  432  224
1  184  438
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5231481, 'precision': 0.52481616, 'recall': 0.5231482, 'specificity': 0.5231482, 'f1': 0.5149982, 'auroc': 0.5018219, 'binary_precision': 0.5183824, 'binary_recall': 0.6527778, 'binary_specificity': 0.3935185, 'binary_f1_score': 0.5778688}
confusion matrix:
    0    1
0  85  131
1  75  141
new oracle model saved
better model found
persisted
after epoch: 9,now: 2024-07-23 01:29:06.186175,epoch time: 0:01:18.212617,used: 0:11:17.470700,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_01_17_48_seed_2_22769260
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.7388743, 'precision': 0.7388589, 'recall': 0.73886335, 'specificity': 0.73886335, 'f1': 0.73886085, 'auroc': 0.808678, 'binary_precision': 0.7412224, 'binary_recall': 0.74025977, 'binary_specificity': 0.737467, 'binary_f1_score': 0.7407408}
confusion matrix:
      0     1
0  1118   398
1   400  1140
---- Validation: 
scalar performance:
{'acc': 0.68701094, 'precision': 0.6871791, 'recall': 0.68728924, 'specificity': 0.68728924, 'f1': 0.6869918, 'auroc': 0.7476522, 'binary_precision': 0.6718266, 'binary_recall': 0.6977492, 'binary_specificity': 0.6768293, 'binary_f1_score': 0.6845426}
confusion matrix:
     0    1
0  444  212
1  188  434
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5393519, 'precision': 0.54208016, 'recall': 0.5393519, 'specificity': 0.5393519, 'f1': 0.5317622, 'auroc': 0.52436984, 'binary_precision': 0.53136533, 'binary_recall': 0.6666667, 'binary_specificity': 0.41203704, 'binary_f1_score': 0.5913758}
confusion matrix:
    0    1
0  89  127
1  72  144
new oracle model saved
better model found
persisted
after epoch: 10,now: 2024-07-23 01:30:24.796771,epoch time: 0:01:18.610596,used: 0:12:36.081296,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_01_17_48_seed_2_22769260
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.7441099, 'precision': 0.7441901, 'recall': 0.74417126, 'specificity': 0.74417126, 'f1': 0.744109, 'auroc': 0.8196, 'binary_precision': 0.7509934, 'binary_recall': 0.73636365, 'binary_specificity': 0.7519789, 'binary_f1_score': 0.74360657}
confusion matrix:
      0     1
0  1140   376
1   406  1134
---- Validation: 
scalar performance:
{'acc': 0.69640064, 'precision': 0.69627845, 'recall': 0.6963939, 'specificity': 0.6963939, 'f1': 0.69629353, 'auroc': 0.7522229, 'binary_precision': 0.6851266, 'binary_recall': 0.6961415, 'binary_specificity': 0.69664633, 'binary_f1_score': 0.69059014}
confusion matrix:
     0    1
0  457  199
1  189  433
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5439815, 'precision': 0.54657817, 'recall': 0.5439815, 'specificity': 0.5439815, 'f1': 0.537536, 'auroc': 0.5430813, 'binary_precision': 0.5355805, 'binary_recall': 0.662037, 'binary_specificity': 0.42592594, 'binary_f1_score': 0.59213245}
confusion matrix:
    0    1
0  92  124
1  73  143
new oracle model saved
better model found
persisted
after epoch: 11,now: 2024-07-23 01:31:42.953489,epoch time: 0:01:18.156718,used: 0:13:54.238014,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_01_17_48_seed_2_22769260
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.7689791, 'precision': 0.770195, 'recall': 0.7692321, 'specificity': 0.7692321, 'f1': 0.76882064, 'auroc': 0.8399248, 'binary_precision': 0.79038996, 'binary_recall': 0.737013, 'binary_specificity': 0.8014512, 'binary_f1_score': 0.7627688}
confusion matrix:
      0     1
0  1215   301
1   405  1135
---- Validation: 
scalar performance:
{'acc': 0.7026604, 'precision': 0.7024598, 'recall': 0.7022415, 'specificity': 0.7022415, 'f1': 0.7023076, 'auroc': 0.7564554, 'binary_precision': 0.6977124, 'binary_recall': 0.6864952, 'binary_specificity': 0.7179878, 'binary_f1_score': 0.6920584}
confusion matrix:
     0    1
0  471  185
1  195  427
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5439815, 'precision': 0.5454636, 'recall': 0.5439815, 'specificity': 0.5439815, 'f1': 0.5402344, 'auroc': 0.5605924, 'binary_precision': 0.5372549, 'binary_recall': 0.6342593, 'binary_specificity': 0.4537037, 'binary_f1_score': 0.581741}
confusion matrix:
    0    1
0  98  118
1  79  137
better model found
persisted
after epoch: 12,now: 2024-07-23 01:33:01.108766,epoch time: 0:01:18.155277,used: 0:15:12.393291,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_01_17_48_seed_2_22769260
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.7653796, 'precision': 0.7653883, 'recall': 0.7654036, 'specificity': 0.7654036, 'f1': 0.7653775, 'auroc': 0.84418356, 'binary_precision': 0.76983607, 'binary_recall': 0.7623377, 'binary_specificity': 0.76846963, 'binary_f1_score': 0.7660685}
confusion matrix:
      0     1
0  1165   351
1   366  1174
---- Validation: 
scalar performance:
{'acc': 0.7034429, 'precision': 0.70322996, 'recall': 0.703087, 'specificity': 0.703087, 'f1': 0.70313734, 'auroc': 0.76005316, 'binary_precision': 0.69756097, 'binary_recall': 0.6897106, 'binary_specificity': 0.7164634, 'binary_f1_score': 0.6936135}
confusion matrix:
     0    1
0  470  186
1  193  429
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5671296, 'precision': 0.5704659, 'recall': 0.5671296, 'specificity': 0.5671296, 'f1': 0.56194454, 'auroc': 0.5752529, 'binary_precision': 0.5551331, 'binary_recall': 0.6759259, 'binary_specificity': 0.45833334, 'binary_f1_score': 0.60960335}
confusion matrix:
    0    1
0  99  117
1  70  146
new oracle model saved
better model found
persisted
after epoch: 13,now: 2024-07-23 01:34:19.642515,epoch time: 0:01:18.533749,used: 0:16:30.927040,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_01_17_48_seed_2_22769260
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.78468585, 'precision': 0.7846726, 'recall': 0.7846726, 'specificity': 0.7846726, 'f1': 0.7846726, 'auroc': 0.85963535, 'binary_precision': 0.78636366, 'binary_recall': 0.78636366, 'binary_specificity': 0.7829815, 'binary_f1_score': 0.78636366}
confusion matrix:
      0     1
0  1187   329
1   329  1211
---- Validation: 
scalar performance:
{'acc': 0.71048516, 'precision': 0.71027553, 'recall': 0.71023846, 'specificity': 0.71023846, 'f1': 0.7102552, 'auroc': 0.7638194, 'binary_precision': 0.7032258, 'binary_recall': 0.7009646, 'binary_specificity': 0.7195122, 'binary_f1_score': 0.70209336}
confusion matrix:
     0    1
0  472  184
1  186  436
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5763889, 'precision': 0.5812826, 'recall': 0.5763889, 'specificity': 0.5763889, 'f1': 0.5699154, 'auroc': 0.5897205, 'binary_precision': 0.5613383, 'binary_recall': 0.6990741, 'binary_specificity': 0.4537037, 'binary_f1_score': 0.6226804}
confusion matrix:
    0    1
0  98  118
1  65  151
new oracle model saved
better model found
persisted
after epoch: 14,now: 2024-07-23 01:35:38.022816,epoch time: 0:01:18.380301,used: 0:17:49.307341,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_01_17_48_seed_2_22769260
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.77552354, 'precision': 0.7759192, 'recall': 0.775664, 'specificity': 0.775664, 'f1': 0.7754924, 'auroc': 0.8544009, 'binary_precision': 0.78851354, 'binary_recall': 0.75779223, 'binary_specificity': 0.79353565, 'binary_f1_score': 0.77284765}
confusion matrix:
      0     1
0  1203   313
1   373  1167
---- Validation: 
scalar performance:
{'acc': 0.7081377, 'precision': 0.7080487, 'recall': 0.7075352, 'specificity': 0.7075352, 'f1': 0.70763487, 'auroc': 0.766582, 'binary_precision': 0.7064677, 'binary_recall': 0.68488747, 'binary_specificity': 0.73018295, 'binary_f1_score': 0.6955102}
confusion matrix:
     0    1
0  479  177
1  196  426
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.587963, 'precision': 0.5910866, 'recall': 0.587963, 'specificity': 0.587963, 'f1': 0.5843998, 'auroc': 0.60290205, 'binary_precision': 0.57421875, 'binary_recall': 0.6805556, 'binary_specificity': 0.49537036, 'binary_f1_score': 0.62288135}
confusion matrix:
     0    1
0  107  109
1   69  147
new oracle model saved
early stop counter: 1
val acc:0.7081376910209656, best validation acc: 0.7104851603507996, corresponding to test acc:                         0.5763888955116272 / 0.5879629850387573
after epoch: 15,now: 2024-07-23 01:36:55.949475,epoch time: 0:01:17.926659,used: 0:19:07.234000,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_01_17_48_seed_2_22769260
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.789267, 'precision': 0.78990364, 'recall': 0.7894442, 'specificity': 0.7894442, 'f1': 0.78921056, 'auroc': 0.8712611, 'binary_precision': 0.80559343, 'binary_recall': 0.76688313, 'binary_specificity': 0.8120053, 'binary_f1_score': 0.7857618}
confusion matrix:
      0     1
0  1231   285
1   359  1181
---- Validation: 
scalar performance:
{'acc': 0.7057903, 'precision': 0.7059815, 'recall': 0.7049153, 'specificity': 0.7049153, 'f1': 0.7050035, 'auroc': 0.76968473, 'binary_precision': 0.7084746, 'binary_recall': 0.67202574, 'binary_specificity': 0.7378049, 'binary_f1_score': 0.68976897}
confusion matrix:
     0    1
0  484  172
1  204  418
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5925926, 'precision': 0.5952381, 'recall': 0.5925926, 'specificity': 0.5925926, 'f1': 0.5897436, 'auroc': 0.6163194, 'binary_precision': 0.5793651, 'binary_recall': 0.6759259, 'binary_specificity': 0.5092593, 'binary_f1_score': 0.6239316}
confusion matrix:
     0    1
0  110  106
1   70  146
new oracle model saved
early stop counter: 2
val acc:0.7057902812957764, best validation acc: 0.7104851603507996, corresponding to test acc:                         0.5763888955116272 / 0.5925925970077515
after epoch: 16,now: 2024-07-23 01:38:14.019743,epoch time: 0:01:18.070268,used: 0:20:25.304268,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_01_17_48_seed_2_22769260
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.80268323, 'precision': 0.8026812, 'recall': 0.8026531, 'specificity': 0.8026531, 'f1': 0.80266297, 'auroc': 0.8762045, 'binary_precision': 0.8028442, 'binary_recall': 0.8064935, 'binary_specificity': 0.7988127, 'binary_f1_score': 0.8046647}
confusion matrix:
      0     1
0  1211   305
1   298  1242
---- Validation: 
scalar performance:
{'acc': 0.71048516, 'precision': 0.71029854, 'recall': 0.7100718, 'specificity': 0.7100718, 'f1': 0.71014154, 'auroc': 0.7729467, 'binary_precision': 0.7058824, 'binary_recall': 0.69453377, 'binary_specificity': 0.7256098, 'binary_f1_score': 0.7001621}
confusion matrix:
     0    1
0  476  180
1  190  432
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6111111, 'precision': 0.61638975, 'recall': 0.6111111, 'specificity': 0.6111111, 'f1': 0.6066512, 'auroc': 0.6274005, 'binary_precision': 0.59160304, 'binary_recall': 0.7175926, 'binary_specificity': 0.5046296, 'binary_f1_score': 0.64853555}
confusion matrix:
     0    1
0  109  107
1   61  155
new oracle model saved
early stop counter: 3
val acc:0.7104851603507996, best validation acc: 0.7104851603507996, corresponding to test acc:                         0.5763888955116272 / 0.6111111044883728
after epoch: 17,now: 2024-07-23 01:39:32.269425,epoch time: 0:01:18.249682,used: 0:21:43.553950,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_01_17_48_seed_2_22769260
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.8115183, 'precision': 0.8118088, 'recall': 0.8116352, 'specificity': 0.8116352, 'f1': 0.8115046, 'auroc': 0.88064504, 'binary_precision': 0.8234899, 'binary_recall': 0.7967532, 'binary_specificity': 0.82651716, 'binary_f1_score': 0.80990094}
confusion matrix:
      0     1
0  1253   263
1   313  1227
---- Validation: 
scalar performance:
{'acc': 0.7057903, 'precision': 0.7059815, 'recall': 0.7049153, 'specificity': 0.7049153, 'f1': 0.7050035, 'auroc': 0.7742702, 'binary_precision': 0.7084746, 'binary_recall': 0.67202574, 'binary_specificity': 0.7378049, 'binary_f1_score': 0.68976897}
confusion matrix:
     0    1
0  484  172
1  204  418
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6134259, 'precision': 0.61648434, 'recall': 0.6134259, 'specificity': 0.6134259, 'f1': 0.6108717, 'auroc': 0.63676697, 'binary_precision': 0.5976096, 'binary_recall': 0.6944444, 'binary_specificity': 0.5324074, 'binary_f1_score': 0.6423983}
confusion matrix:
     0    1
0  115  101
1   66  150
new oracle model saved
early stop counter: 4
val acc:0.7057902812957764, best validation acc: 0.7104851603507996, corresponding to test acc:                         0.5763888955116272 / 0.6134259104728699
after epoch: 18,now: 2024-07-23 01:40:50.408859,epoch time: 0:01:18.139434,used: 0:23:01.693384,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_01_17_48_seed_2_22769260
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.81413615, 'precision': 0.81525475, 'recall': 0.8143662, 'specificity': 0.8143662, 'f1': 0.8140385, 'auroc': 0.8909776, 'binary_precision': 0.83609957, 'binary_recall': 0.78506494, 'binary_specificity': 0.84366757, 'binary_f1_score': 0.8097789}
confusion matrix:
      0     1
0  1279   237
1   331  1209
---- Validation: 
scalar performance:
{'acc': 0.7120501, 'precision': 0.71320426, 'recall': 0.71072125, 'specificity': 0.71072125, 'f1': 0.71067834, 'auroc': 0.77596116, 'binary_precision': 0.72359157, 'binary_recall': 0.6607717, 'binary_specificity': 0.7606707, 'binary_f1_score': 0.6907563}
confusion matrix:
     0    1
0  499  157
1  211  411
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6134259, 'precision': 0.6141329, 'recall': 0.61342597, 'specificity': 0.61342597, 'f1': 0.61282635, 'auroc': 0.64714074, 'binary_precision': 0.6051502, 'binary_recall': 0.6527778, 'binary_specificity': 0.5740741, 'binary_f1_score': 0.62806237}
confusion matrix:
     0    1
0  124   92
1   75  141
better model found
persisted
after epoch: 19,now: 2024-07-23 01:42:06.377186,epoch time: 0:01:15.968327,used: 0:24:17.661711,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_01_17_48_seed_2_22769260
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.8111911, 'precision': 0.8114444, 'recall': 0.8113003, 'specificity': 0.8113003, 'f1': 0.8111804, 'auroc': 0.8919469, 'binary_precision': 0.822505, 'binary_recall': 0.7974026, 'binary_specificity': 0.8251979, 'binary_f1_score': 0.8097593}
confusion matrix:
      0     1
0  1251   265
1   312  1228
---- Validation: 
scalar performance:
{'acc': 0.71283257, 'precision': 0.71394277, 'recall': 0.7115251, 'specificity': 0.7115251, 'f1': 0.71149564, 'auroc': 0.7789095, 'binary_precision': 0.72407734, 'binary_recall': 0.66237944, 'binary_specificity': 0.7606707, 'binary_f1_score': 0.69185567}
confusion matrix:
     0    1
0  499  157
1  210  412
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6319444, 'precision': 0.633736, 'recall': 0.6319444, 'specificity': 0.6319444, 'f1': 0.63070774, 'auroc': 0.65715015, 'binary_precision': 0.6182573, 'binary_recall': 0.6898148, 'binary_specificity': 0.5740741, 'binary_f1_score': 0.6520788}
confusion matrix:
     0    1
0  124   92
1   67  149
new oracle model saved
better model found
persisted
after epoch: 20,now: 2024-07-23 01:43:25.981002,epoch time: 0:01:19.603816,used: 0:25:37.265527,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_01_17_48_seed_2_22769260
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.8216623, 'precision': 0.82245445, 'recall': 0.82185435, 'specificity': 0.82185435, 'f1': 0.8216045, 'auroc': 0.8889979, 'binary_precision': 0.8405202, 'binary_recall': 0.7974026, 'binary_specificity': 0.8463061, 'binary_f1_score': 0.8183939}
confusion matrix:
      0     1
0  1283   233
1   312  1228
---- Validation: 
scalar performance:
{'acc': 0.7120501, 'precision': 0.7139316, 'recall': 0.7104713, 'specificity': 0.7104713, 'f1': 0.7102762, 'auroc': 0.7810466, 'binary_precision': 0.7284173, 'binary_recall': 0.65112543, 'binary_specificity': 0.76981705, 'binary_f1_score': 0.68760616}
confusion matrix:
     0    1
0  505  151
1  217  405
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6342593, 'precision': 0.6351981, 'recall': 0.6342592, 'specificity': 0.6342592, 'f1': 0.6336232, 'auroc': 0.66679525, 'binary_precision': 0.62393165, 'binary_recall': 0.6759259, 'binary_specificity': 0.5925926, 'binary_f1_score': 0.6488889}
confusion matrix:
     0    1
0  128   88
1   70  146
new oracle model saved
early stop counter: 1
val acc:0.7120500802993774, best validation acc: 0.7128325700759888, corresponding to test acc:                         0.6319444179534912 / 0.6342592835426331
after epoch: 21,now: 2024-07-23 01:44:45.122569,epoch time: 0:01:19.141567,used: 0:26:56.407094,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_01_17_48_seed_2_22769260
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.8282068, 'precision': 0.8288877, 'recall': 0.8283838, 'specificity': 0.8283838, 'f1': 0.82816267, 'auroc': 0.9018219, 'binary_precision': 0.8459441, 'binary_recall': 0.8058441, 'binary_specificity': 0.8509235, 'binary_f1_score': 0.8254074}
confusion matrix:
      0     1
0  1290   226
1   299  1241
---- Validation: 
scalar performance:
{'acc': 0.7143975, 'precision': 0.7156364, 'recall': 0.7130495, 'specificity': 0.7130495, 'f1': 0.71300566, 'auroc': 0.7839238, 'binary_precision': 0.7266314, 'binary_recall': 0.66237944, 'binary_specificity': 0.7637195, 'binary_f1_score': 0.69301933}
confusion matrix:
     0    1
0  501  155
1  210  412
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.650463, 'precision': 0.65250593, 'recall': 0.650463, 'specificity': 0.650463, 'f1': 0.6492885, 'auroc': 0.67579734, 'binary_precision': 0.6348548, 'binary_recall': 0.7083333, 'binary_specificity': 0.5925926, 'binary_f1_score': 0.6695843}
confusion matrix:
     0    1
0  128   88
1   63  153
new oracle model saved
better model found
persisted
after epoch: 22,now: 2024-07-23 01:46:04.450645,epoch time: 0:01:19.328076,used: 0:28:15.735170,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_01_17_48_seed_2_22769260
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.8278796, 'precision': 0.82820725, 'recall': 0.8280026, 'specificity': 0.8280026, 'f1': 0.8278651, 'auroc': 0.9049939, 'binary_precision': 0.8407258, 'binary_recall': 0.81233764, 'binary_specificity': 0.84366757, 'binary_f1_score': 0.8262879}
confusion matrix:
      0     1
0  1279   237
1   289  1251
---- Validation: 
scalar performance:
{'acc': 0.71596247, 'precision': 0.7177094, 'recall': 0.71444887, 'specificity': 0.71444887, 'f1': 0.71431667, 'auroc': 0.78648484, 'binary_precision': 0.7316637, 'binary_recall': 0.6575563, 'binary_specificity': 0.77134144, 'binary_f1_score': 0.6926334}
confusion matrix:
     0    1
0  506  150
1  213  409
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6550926, 'precision': 0.6571984, 'recall': 0.6550926, 'specificity': 0.6550926, 'f1': 0.65393364, 'auroc': 0.68404925, 'binary_precision': 0.6390042, 'binary_recall': 0.712963, 'binary_specificity': 0.5972222, 'binary_f1_score': 0.6739606}
confusion matrix:
     0    1
0  129   87
1   62  154
new oracle model saved
better model found
persisted
after epoch: 23,now: 2024-07-23 01:47:24.465571,epoch time: 0:01:20.014926,used: 0:29:35.750096,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_01_17_48_seed_2_22769260
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.8373691, 'precision': 0.83744013, 'recall': 0.83742845, 'specificity': 0.83742845, 'f1': 0.8373689, 'auroc': 0.91451657, 'binary_precision': 0.8446794, 'binary_recall': 0.8298701, 'binary_specificity': 0.8449868, 'binary_f1_score': 0.8372092}
confusion matrix:
      0     1
0  1281   235
1   262  1278
---- Validation: 
scalar performance:
{'acc': 0.71518, 'precision': 0.71660256, 'recall': 0.71377003, 'specificity': 0.71377003, 'f1': 0.7136963, 'auroc': 0.7887567, 'binary_precision': 0.7287234, 'binary_recall': 0.6607717, 'binary_specificity': 0.7667683, 'binary_f1_score': 0.693086}
confusion matrix:
     0    1
0  503  153
1  211  411
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6597222, 'precision': 0.6622575, 'recall': 0.6597222, 'specificity': 0.6597222, 'f1': 0.6583878, 'auroc': 0.6910579, 'binary_precision': 0.6419753, 'binary_recall': 0.7222222, 'binary_specificity': 0.5972222, 'binary_f1_score': 0.6797385}
confusion matrix:
     0    1
0  129   87
1   60  156
new oracle model saved
early stop counter: 1
val acc:0.715179979801178, best validation acc: 0.7159624695777893, corresponding to test acc:                         0.6550925970077515 / 0.6597222089767456
after epoch: 24,now: 2024-07-23 01:48:42.412750,epoch time: 0:01:17.947179,used: 0:30:53.697275,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_01_17_48_seed_2_22769260
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.8344241, 'precision': 0.8347024, 'recall': 0.83453727, 'specificity': 0.83453727, 'f1': 0.8344139, 'auroc': 0.91568685, 'binary_precision': 0.84651476, 'binary_recall': 0.8201299, 'binary_specificity': 0.8489446, 'binary_f1_score': 0.83311343}
confusion matrix:
      0     1
0  1287   229
1   277  1263
---- Validation: 
scalar performance:
{'acc': 0.7175274, 'precision': 0.7201762, 'recall': 0.71576494, 'specificity': 0.71576494, 'f1': 0.71545756, 'auroc': 0.78924936, 'binary_precision': 0.738574, 'binary_recall': 0.64951766, 'binary_specificity': 0.7820122, 'binary_f1_score': 0.69118905}
confusion matrix:
     0    1
0  513  143
1  218  404
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.662037, 'precision': 0.6634382, 'recall': 0.662037, 'specificity': 0.662037, 'f1': 0.66131103, 'auroc': 0.6967807, 'binary_precision': 0.64830506, 'binary_recall': 0.7083333, 'binary_specificity': 0.6157407, 'binary_f1_score': 0.6769911}
confusion matrix:
     0    1
0  133   83
1   63  153
new oracle model saved
better model found
persisted
after epoch: 25,now: 2024-07-23 01:50:00.828215,epoch time: 0:01:18.415465,used: 0:32:12.112740,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_01_17_48_seed_2_22769260
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.83246076, 'precision': 0.8328806, 'recall': 0.83259946, 'specificity': 0.83259946, 'f1': 0.83244, 'auroc': 0.9125518, 'binary_precision': 0.84682864, 'binary_recall': 0.8149351, 'binary_specificity': 0.85026383, 'binary_f1_score': 0.8305758}
confusion matrix:
      0     1
0  1289   227
1   285  1255
---- Validation: 
scalar performance:
{'acc': 0.7190923, 'precision': 0.7222805, 'recall': 0.717206, 'specificity': 0.717206, 'f1': 0.71679914, 'auroc': 0.790938, 'binary_precision': 0.7430684, 'binary_recall': 0.6463022, 'binary_specificity': 0.7881098, 'binary_f1_score': 0.69131553}
confusion matrix:
     0    1
0  517  139
1  220  402
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6689815, 'precision': 0.6700347, 'recall': 0.66898143, 'specificity': 0.66898143, 'f1': 0.66846806, 'auroc': 0.70398235, 'binary_precision': 0.65665233, 'binary_recall': 0.7083333, 'binary_specificity': 0.6296296, 'binary_f1_score': 0.68151444}
confusion matrix:
     0    1
0  136   80
1   63  153
new oracle model saved
better model found
persisted
after epoch: 26,now: 2024-07-23 01:51:18.439275,epoch time: 0:01:17.611060,used: 0:33:29.723800,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_01_17_48_seed_2_22769260
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.841623, 'precision': 0.8417016, 'recall': 0.84168524, 'specificity': 0.84168524, 'f1': 0.8416227, 'auroc': 0.9159857, 'binary_precision': 0.8492063, 'binary_recall': 0.8337662, 'binary_specificity': 0.84960425, 'binary_f1_score': 0.84141546}
confusion matrix:
      0     1
0  1288   228
1   256  1284
---- Validation: 
scalar performance:
{'acc': 0.7183099, 'precision': 0.7210563, 'recall': 0.7165271, 'specificity': 0.7165271, 'f1': 0.71620744, 'auroc': 0.79265356, 'binary_precision': 0.73992676, 'binary_recall': 0.64951766, 'binary_specificity': 0.7835366, 'binary_f1_score': 0.69178087}
confusion matrix:
     0    1
0  514  142
1  218  404
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6643519, 'precision': 0.6662367, 'recall': 0.6643518, 'specificity': 0.6643518, 'f1': 0.66339767, 'auroc': 0.7103909, 'binary_precision': 0.64853555, 'binary_recall': 0.7175926, 'binary_specificity': 0.6111111, 'binary_f1_score': 0.68131864}
confusion matrix:
     0    1
0  132   84
1   61  155
early stop counter: 1
val acc:0.7183098793029785, best validation acc: 0.7190923094749451, corresponding to test acc:                         0.6689814925193787 / 0.6689814925193787
after epoch: 27,now: 2024-07-23 01:52:36.577224,epoch time: 0:01:18.137949,used: 0:34:47.861749,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_01_17_48_seed_2_22769260
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.8445681, 'precision': 0.8447896, 'recall': 0.844669, 'specificity': 0.844669, 'f1': 0.84456205, 'auroc': 0.91884756, 'binary_precision': 0.8557114, 'binary_recall': 0.83181816, 'binary_specificity': 0.8575198, 'binary_f1_score': 0.8435956}
confusion matrix:
      0     1
0  1300   216
1   259  1281
---- Validation: 
scalar performance:
{'acc': 0.7230047, 'precision': 0.7263776, 'recall': 0.72110033, 'specificity': 0.72110033, 'f1': 0.7207037, 'auroc': 0.7941632, 'binary_precision': 0.74814814, 'binary_recall': 0.64951766, 'binary_specificity': 0.79268295, 'binary_f1_score': 0.69535285}
confusion matrix:
     0    1
0  520  136
1  218  404
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6759259, 'precision': 0.6768966, 'recall': 0.67592597, 'specificity': 0.67592597, 'f1': 0.6754807, 'auroc': 0.71752834, 'binary_precision': 0.6637931, 'binary_recall': 0.712963, 'binary_specificity': 0.6388889, 'binary_f1_score': 0.6875}
confusion matrix:
     0    1
0  138   78
1   62  154
new oracle model saved
better model found
persisted
after epoch: 28,now: 2024-07-23 01:53:54.283365,epoch time: 0:01:17.706141,used: 0:36:05.567890,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_01_17_48_seed_2_22769260
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.85536647, 'precision': 0.8555578, 'recall': 0.8554604, 'specificity': 0.8554604, 'f1': 0.85536253, 'auroc': 0.9260926, 'binary_precision': 0.866, 'binary_recall': 0.8435065, 'binary_specificity': 0.86741424, 'binary_f1_score': 0.85460526}
confusion matrix:
      0     1
0  1315   201
1   241  1299
---- Validation: 
scalar performance:
{'acc': 0.7222222, 'precision': 0.7270764, 'recall': 0.7200048, 'specificity': 0.7200048, 'f1': 0.7192726, 'auroc': 0.7949866, 'binary_precision': 0.7542857, 'binary_recall': 0.6366559, 'binary_specificity': 0.80335367, 'binary_f1_score': 0.6904969}
confusion matrix:
     0    1
0  527  129
1  226  396
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6851852, 'precision': 0.6853282, 'recall': 0.6851852, 'specificity': 0.6851852, 'f1': 0.6851244, 'auroc': 0.7226509, 'binary_precision': 0.6801802, 'binary_recall': 0.6990741, 'binary_specificity': 0.6712963, 'binary_f1_score': 0.6894977}
confusion matrix:
     0    1
0  145   71
1   65  151
new oracle model saved
early stop counter: 1
val acc:0.7222222089767456, best validation acc: 0.7230046987533569, corresponding to test acc:                         0.6759259104728699 / 0.6851851940155029
after epoch: 29,now: 2024-07-23 01:55:12.131975,epoch time: 0:01:17.848610,used: 0:37:23.416500,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_01_17_48_seed_2_22769260
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.85209423, 'precision': 0.85233104, 'recall': 0.85219824, 'specificity': 0.85219824, 'f1': 0.852088, 'auroc': 0.92209506, 'binary_precision': 0.8636364, 'binary_recall': 0.83896106, 'binary_specificity': 0.86543536, 'binary_f1_score': 0.85111994}
confusion matrix:
      0     1
0  1312   204
1   248  1292
---- Validation: 
scalar performance:
{'acc': 0.7230047, 'precision': 0.7265624, 'recall': 0.7210586, 'specificity': 0.7210586, 'f1': 0.72062296, 'auroc': 0.7971802, 'binary_precision': 0.74907064, 'binary_recall': 0.64790994, 'binary_specificity': 0.79420733, 'binary_f1_score': 0.6948276}
confusion matrix:
     0    1
0  521  135
1  219  403
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6851852, 'precision': 0.68596643, 'recall': 0.6851852, 'specificity': 0.6851852, 'f1': 0.68485415, 'auroc': 0.72888803, 'binary_precision': 0.67391306, 'binary_recall': 0.7175926, 'binary_specificity': 0.6527778, 'binary_f1_score': 0.6950672}
confusion matrix:
     0    1
0  141   75
1   61  155
early stop counter: 2
val acc:0.7230046987533569, best validation acc: 0.7230046987533569, corresponding to test acc:                         0.6759259104728699 / 0.6851851940155029
after epoch: 30,now: 2024-07-23 01:56:29.789541,epoch time: 0:01:17.657566,used: 0:38:41.074066,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_01_17_48_seed_2_22769260
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 0:38:41.074066 at 2024-07-23 01:56:29.789541
persisted model performance metric: 

scalar performance:
{'acc': 0.6759259, 'precision': 0.6768966, 'recall': 0.67592597, 'specificity': 0.67592597, 'f1': 0.6754807, 'auroc': 0.71752834, 'binary_precision': 0.6637931, 'binary_recall': 0.712963, 'binary_specificity': 0.6388889, 'binary_f1_score': 0.6875}
confusion matrix:
     0    1
0  138   78
1   62  154
oracle model performance metric: 

scalar performance:
{'acc': 0.6851852, 'precision': 0.6853282, 'recall': 0.6851852, 'specificity': 0.6851852, 'f1': 0.6851244, 'auroc': 0.7226509, 'binary_precision': 0.6801802, 'binary_recall': 0.6990741, 'binary_specificity': 0.6712963, 'binary_f1_score': 0.6894977}
confusion matrix:
     0    1
0  145   71
1   65  151
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_dial_lr1e5_bs16_allfreeze_2024-07-22_23-46-53/rule_results/4.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_dial_lr1e5_bs16_allfreeze_2024-07-22_23-46-53/confusion_matrix/4.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 189876 KiB | 460555 KiB | 118645 GiB | 118645 GiB |
|       from large pool | 173494 KiB | 428048 KiB | 116197 GiB | 116197 GiB |
|       from small pool |  16382 KiB |  37418 KiB |   2447 GiB |   2447 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 189876 KiB | 460555 KiB | 118645 GiB | 118645 GiB |
|       from large pool | 173494 KiB | 428048 KiB | 116197 GiB | 116197 GiB |
|       from small pool |  16382 KiB |  37418 KiB |   2447 GiB |   2447 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 189010 KiB | 457292 KiB | 118638 GiB | 118638 GiB |
|       from large pool | 172814 KiB | 424940 KiB | 116195 GiB | 116194 GiB |
|       from small pool |  16196 KiB |  37230 KiB |   2443 GiB |   2443 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 526336 KiB | 530432 KiB |   1088 MiB | 587776 KiB |
|       from large pool | 487424 KiB | 487424 KiB |   1014 MiB | 550912 KiB |
|       from small pool |  38912 KiB |  43008 KiB |     74 MiB |  36864 KiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  37451 KiB |  84605 KiB |  66958 GiB |  66958 GiB |
|       from large pool |  31306 KiB |  79555 KiB |  64448 GiB |  64448 GiB |
|       from small pool |   6145 KiB |  11196 KiB |   2510 GiB |   2510 GiB |
|---------------------------------------------------------------------------|
| Allocations           |     776    |    1159    |   25632 K  |   25632 K  |
|       from large pool |      76    |     158    |   11465 K  |   11465 K  |
|       from small pool |     700    |    1008    |   14166 K  |   14166 K  |
|---------------------------------------------------------------------------|
| Active allocs         |     776    |    1159    |   25632 K  |   25632 K  |
|       from large pool |      76    |     158    |   11465 K  |   11465 K  |
|       from small pool |     700    |    1008    |   14166 K  |   14166 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      41    |      43    |      82    |      41    |
|       from large pool |      22    |      22    |      45    |      23    |
|       from small pool |      19    |      21    |      37    |      18    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      40    |     216    |   15265 K  |   15265 K  |
|       from large pool |      10    |      22    |    6801 K  |    6801 K  |
|       from small pool |      30    |     206    |    8463 K  |    8463 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  17088 KiB | 460555 KiB | 118645 GiB | 118645 GiB |
|       from large pool |  17088 KiB | 428048 KiB | 116197 GiB | 116197 GiB |
|       from small pool |      0 KiB |  37418 KiB |   2447 GiB |   2447 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  17088 KiB | 460555 KiB | 118645 GiB | 118645 GiB |
|       from large pool |  17088 KiB | 428048 KiB | 116197 GiB | 116197 GiB |
|       from small pool |      0 KiB |  37418 KiB |   2447 GiB |   2447 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB | 457292 KiB | 118638 GiB | 118638 GiB |
|       from large pool |  16640 KiB | 424940 KiB | 116195 GiB | 116195 GiB |
|       from small pool |      0 KiB |  37230 KiB |   2443 GiB |   2443 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 227328 KiB | 530432 KiB |   1088 MiB |    866 MiB |
|       from large pool | 204800 KiB | 487424 KiB |   1014 MiB |    814 MiB |
|       from small pool |  22528 KiB |  43008 KiB |     74 MiB |     52 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  23872 KiB |  84605 KiB |  66958 GiB |  66958 GiB |
|       from large pool |  23872 KiB |  79555 KiB |  64448 GiB |  64448 GiB |
|       from small pool |      0 KiB |  11196 KiB |   2510 GiB |   2510 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    1159    |   25632 K  |   25632 K  |
|       from large pool |       2    |     158    |   11465 K  |   11465 K  |
|       from small pool |       0    |    1008    |   14166 K  |   14166 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    1159    |   25632 K  |   25632 K  |
|       from large pool |       2    |     158    |   11465 K  |   11465 K  |
|       from small pool |       0    |    1008    |   14166 K  |   14166 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      21    |      43    |      82    |      61    |
|       from large pool |      10    |      22    |      45    |      35    |
|       from small pool |      11    |      21    |      37    |      26    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     216    |   15265 K  |   15265 K  |
|       from large pool |       3    |      22    |    6801 K  |    6801 K  |
|       from small pool |       0    |     206    |    8463 K  |    8463 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Tue Jul 23 01:57:25 2024]
Finished job 0.
1 of 1 steps (100%) done
