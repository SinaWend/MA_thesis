Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Tue Jul 23 01:57:50 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_dial_lr1e5_bs16_allfreeze_2024-07-22_23-46-53/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_dial_lr1e5_bs16_allfreeze_2024-07-22_23-46-53/rule_results/3.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=3
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/swiglu_ffn.py:51: UserWarning: xFormers is not available (SwiGLU)
  warnings.warn("xFormers is not available (SwiGLU)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/attention.py:33: UserWarning: xFormers is not available (Attention)
  warnings.warn("xFormers is not available (Attention)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/block.py:40: UserWarning: xFormers is not available (Block)
  warnings.warn("xFormers is not available (Block)")
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'888c1ef2'
model name: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_01_59_53_seed_0_22769264

 Experiment start at: 2024-07-23 01:59:53.047224
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
before training, model accuracy: 0.569767415523529
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.93815106, 'precision': 0.9414011, 'recall': 0.93867666, 'specificity': 0.93867666, 'f1': 0.9380801, 'auroc': 0.9872135, 'binary_precision': 0.98231965, 'binary_recall': 0.8938224, 'binary_specificity': 0.98353094, 'binary_f1_score': 0.9359838}
confusion matrix:
      0     1
0  1493    25
1   165  1389
---- Validation: 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
scalar performance:
{'acc': 0.8330745, 'precision': 0.83454865, 'recall': 0.832597, 'specificity': 0.832597, 'f1': 0.8327235, 'auroc': 0.91290104, 'binary_precision': 0.85353535, 'binary_recall': 0.7984252, 'binary_specificity': 0.8667688, 'binary_f1_score': 0.825061}
confusion matrix:
     0    1
0  566   87
1  128  507
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8627907, 'precision': 0.86286134, 'recall': 0.8627907, 'specificity': 0.8627907, 'f1': 0.862784, 'auroc': 0.9239805, 'binary_precision': 0.8679245, 'binary_recall': 0.855814, 'binary_specificity': 0.8697674, 'binary_f1_score': 0.8618267}
confusion matrix:
     0    1
0  187   28
1   31  184
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-23 02:01:39.063719,epoch time: 0:01:46.016495,used: 0:01:46.016495,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_01_59_53_seed_0_22769264
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.95963544, 'precision': 0.9597777, 'recall': 0.9595438, 'specificity': 0.9595438, 'f1': 0.95962, 'auroc': 0.9937196, 'binary_precision': 0.9543147, 'binary_recall': 0.966581, 'binary_specificity': 0.9525066, 'binary_f1_score': 0.9604087}
confusion matrix:
      0     1
0  1444    72
1    52  1504
---- Validation: 
scalar performance:
{'acc': 0.8004658, 'precision': 0.80900145, 'recall': 0.80160975, 'specificity': 0.80160975, 'f1': 0.7994648, 'auroc': 0.8887799, 'binary_precision': 0.75403225, 'binary_recall': 0.8834646, 'binary_specificity': 0.719755, 'binary_f1_score': 0.813633}
confusion matrix:
     0    1
0  470  183
1   74  561
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.82325584, 'precision': 0.83367944, 'recall': 0.8232558, 'specificity': 0.8232558, 'f1': 0.8218646, 'auroc': 0.9222282, 'binary_precision': 0.77470356, 'binary_recall': 0.9116279, 'binary_specificity': 0.7348837, 'binary_f1_score': 0.8376068}
confusion matrix:
     0    1
0  158   57
1   19  196
early stop counter: 1
val acc:0.8004658222198486, best validation acc: 0.8330745100975037, corresponding to test acc:                         0.8627907037734985 / 0.8627907037734985
after epoch: 2,now: 2024-07-23 02:03:06.415435,epoch time: 0:01:27.351716,used: 0:03:13.368211,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_01_59_53_seed_0_22769264
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9720052, 'precision': 0.9720423, 'recall': 0.9719687, 'specificity': 0.9719687, 'f1': 0.97199893, 'auroc': 0.99648225, 'binary_precision': 0.96992964, 'binary_recall': 0.9749196, 'binary_specificity': 0.9690178, 'binary_f1_score': 0.97241825}
confusion matrix:
      0     1
0  1470    47
1    39  1516
---- Validation: 
scalar performance:
{'acc': 0.8214286, 'precision': 0.82164204, 'recall': 0.82122004, 'specificity': 0.82122004, 'f1': 0.8213041, 'auroc': 0.8901135, 'binary_precision': 0.82714057, 'binary_recall': 0.8062992, 'binary_specificity': 0.8361409, 'binary_f1_score': 0.816587}
confusion matrix:
     0    1
0  546  107
1  123  512
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.82790697, 'precision': 0.8335644, 'recall': 0.82790697, 'specificity': 0.82790697, 'f1': 0.8271742, 'auroc': 0.9340833, 'binary_precision': 0.79012346, 'binary_recall': 0.89302325, 'binary_specificity': 0.7627907, 'binary_f1_score': 0.83842796}
confusion matrix:
     0    1
0  164   51
1   23  192
early stop counter: 2
val acc:0.8214285969734192, best validation acc: 0.8330745100975037, corresponding to test acc:                         0.8627907037734985 / 0.8627907037734985
after epoch: 3,now: 2024-07-23 02:04:33.604816,epoch time: 0:01:27.189381,used: 0:04:40.557592,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_01_59_53_seed_0_22769264
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9433594, 'precision': 0.9482702, 'recall': 0.94407046, 'specificity': 0.94407046, 'f1': 0.9432577, 'auroc': 0.99757606, 'binary_precision': 0.998557, 'binary_recall': 0.88946015, 'binary_specificity': 0.9986807, 'binary_f1_score': 0.9408565}
confusion matrix:
      0     1
0  1514     2
1   172  1384
---- Validation: 
scalar performance:
{'acc': 0.5590062, 'precision': 0.7194421, 'recall': 0.5529295, 'specificity': 0.5529295, 'f1': 0.4516043, 'auroc': 0.84915894, 'binary_precision': 0.90361446, 'binary_recall': 0.11811024, 'binary_specificity': 0.98774886, 'binary_f1_score': 0.20891365}
confusion matrix:
     0   1
0  645   8
1  560  75
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7953488, 'precision': 0.84011364, 'recall': 0.7953488, 'specificity': 0.7953488, 'f1': 0.78838575, 'auroc': 0.91216874, 'binary_precision': 0.96350366, 'binary_recall': 0.6139535, 'binary_specificity': 0.9767442, 'binary_f1_score': 0.74999994}
confusion matrix:
     0    1
0  210    5
1   83  132
early stop counter: 3
val acc:0.5590062141418457, best validation acc: 0.8330745100975037, corresponding to test acc:                         0.8627907037734985 / 0.8627907037734985
after epoch: 4,now: 2024-07-23 02:06:01.871411,epoch time: 0:01:28.266595,used: 0:06:08.824187,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_01_59_53_seed_0_22769264
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9632161, 'precision': 0.96515507, 'recall': 0.963672, 'specificity': 0.963672, 'f1': 0.9631976, 'auroc': 0.9966433, 'binary_precision': 0.9986178, 'binary_recall': 0.92866325, 'binary_specificity': 0.9986807, 'binary_f1_score': 0.96237093}
confusion matrix:
      0     1
0  1514     2
1   111  1445
---- Validation: 
scalar performance:
{'acc': 0.57608694, 'precision': 0.74283284, 'recall': 0.57020897, 'specificity': 0.57020897, 'f1': 0.4807065, 'auroc': 0.8810023, 'binary_precision': 0.9405941, 'binary_recall': 0.1496063, 'binary_specificity': 0.99081165, 'binary_f1_score': 0.25815216}
confusion matrix:
     0   1
0  647   6
1  540  95
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7046512, 'precision': 0.7950349, 'recall': 0.7046512, 'specificity': 0.7046512, 'f1': 0.6801551, 'auroc': 0.8857112, 'binary_precision': 0.9583333, 'binary_recall': 0.427907, 'binary_specificity': 0.98139536, 'binary_f1_score': 0.5916399}
confusion matrix:
     0   1
0  211   4
1  123  92
early stop counter: 4
val acc:0.5760869383811951, best validation acc: 0.8330745100975037, corresponding to test acc:                         0.8627907037734985 / 0.8627907037734985
after epoch: 5,now: 2024-07-23 02:07:28.918673,epoch time: 0:01:27.047262,used: 0:07:35.871449,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_01_59_53_seed_0_22769264
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9707031, 'precision': 0.97135574, 'recall': 0.9704733, 'specificity': 0.9704733, 'f1': 0.9706769, 'auroc': 0.9966585, 'binary_precision': 0.95703614, 'binary_recall': 0.9865212, 'binary_specificity': 0.95442533, 'binary_f1_score': 0.97155505}
confusion matrix:
      0     1
0  1445    69
1    21  1537
---- Validation: 
scalar performance:
{'acc': 0.86180127, 'precision': 0.86340225, 'recall': 0.86227345, 'specificity': 0.86227345, 'f1': 0.8617359, 'auroc': 0.92463374, 'binary_precision': 0.835536, 'binary_recall': 0.89606297, 'binary_specificity': 0.82848394, 'binary_f1_score': 0.8647416}
confusion matrix:
     0    1
0  541  112
1   66  569
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8372093, 'precision': 0.8379404, 'recall': 0.8372093, 'specificity': 0.8372093, 'f1': 0.83712125, 'auroc': 0.92806923, 'binary_precision': 0.82222223, 'binary_recall': 0.8604651, 'binary_specificity': 0.81395346, 'binary_f1_score': 0.8409091}
confusion matrix:
     0    1
0  175   40
1   30  185
better model found
persisted
after epoch: 6,now: 2024-07-23 02:08:56.810931,epoch time: 0:01:27.892258,used: 0:09:03.763707,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_01_59_53_seed_0_22769264
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.984375, 'precision': 0.98436475, 'recall': 0.984437, 'specificity': 0.984437, 'f1': 0.98437417, 'auroc': 0.9988928, 'binary_precision': 0.98960364, 'binary_recall': 0.9794212, 'binary_specificity': 0.98945284, 'binary_f1_score': 0.98448604}
confusion matrix:
      0     1
0  1501    16
1    32  1523
---- Validation: 
scalar performance:
{'acc': 0.83540374, 'precision': 0.84094983, 'recall': 0.8345034, 'specificity': 0.8345034, 'f1': 0.8344453, 'auroc': 0.899801, 'binary_precision': 0.8810811, 'binary_recall': 0.7700787, 'binary_specificity': 0.89892805, 'binary_f1_score': 0.82184875}
confusion matrix:
     0    1
0  587   66
1  146  489
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8860465, 'precision': 0.8884753, 'recall': 0.8860465, 'specificity': 0.8860465, 'f1': 0.8858682, 'auroc': 0.930557, 'binary_precision': 0.9191919, 'binary_recall': 0.8465116, 'binary_specificity': 0.9255814, 'binary_f1_score': 0.88135594}
confusion matrix:
     0    1
0  199   16
1   33  182
new oracle model saved
early stop counter: 1
val acc:0.8354037404060364, best validation acc: 0.861801266670227, corresponding to test acc:                         0.8372092843055725 / 0.8860465288162231
after epoch: 7,now: 2024-07-23 02:10:24.717237,epoch time: 0:01:27.906306,used: 0:10:31.670013,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_01_59_53_seed_0_22769264
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9791667, 'precision': 0.9798477, 'recall': 0.97897303, 'specificity': 0.97897303, 'f1': 0.97915035, 'auroc': 0.99888384, 'binary_precision': 0.96446383, 'binary_recall': 0.9954955, 'binary_specificity': 0.96245056, 'binary_f1_score': 0.97973406}
confusion matrix:
      0     1
0  1461    57
1     7  1547
---- Validation: 
scalar performance:
{'acc': 0.79813665, 'precision': 0.80571175, 'recall': 0.797012, 'specificity': 0.797012, 'f1': 0.79642797, 'auroc': 0.8868071, 'binary_precision': 0.85046726, 'binary_recall': 0.71653545, 'binary_specificity': 0.8774885, 'binary_f1_score': 0.7777778}
confusion matrix:
     0    1
0  573   80
1  180  455
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8627907, 'precision': 0.8627986, 'recall': 0.8627907, 'specificity': 0.8627907, 'f1': 0.86279, 'auroc': 0.9244132, 'binary_precision': 0.864486, 'binary_recall': 0.8604651, 'binary_specificity': 0.8651163, 'binary_f1_score': 0.86247087}
confusion matrix:
     0    1
0  186   29
1   30  185
early stop counter: 2
val acc:0.7981366515159607, best validation acc: 0.861801266670227, corresponding to test acc:                         0.8372092843055725 / 0.8860465288162231
after epoch: 8,now: 2024-07-23 02:11:52.650527,epoch time: 0:01:27.933290,used: 0:11:59.603303,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_01_59_53_seed_0_22769264
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9794922, 'precision': 0.9799788, 'recall': 0.9797267, 'specificity': 0.9797267, 'f1': 0.97949123, 'auroc': 0.99905604, 'binary_precision': 0.9986631, 'binary_recall': 0.9607717, 'binary_specificity': 0.9986816, 'binary_f1_score': 0.97935104}
confusion matrix:
      0     1
0  1515     2
1    61  1494
---- Validation: 
scalar performance:
{'acc': 0.7375776, 'precision': 0.80089927, 'recall': 0.7343358, 'specificity': 0.7343358, 'f1': 0.7212193, 'auroc': 0.9169647, 'binary_precision': 0.9354839, 'binary_recall': 0.5023622, 'binary_specificity': 0.96630937, 'binary_f1_score': 0.6536885}
confusion matrix:
     0    1
0  631   22
1  316  319
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8418605, 'precision': 0.8686918, 'recall': 0.8418605, 'specificity': 0.8418605, 'f1': 0.83893, 'auroc': 0.92482424, 'binary_precision': 0.9681529, 'binary_recall': 0.7069768, 'binary_specificity': 0.9767442, 'binary_f1_score': 0.8172043}
confusion matrix:
     0    1
0  210    5
1   63  152
early stop counter: 3
val acc:0.7375776171684265, best validation acc: 0.861801266670227, corresponding to test acc:                         0.8372092843055725 / 0.8860465288162231
after epoch: 9,now: 2024-07-23 02:13:20.609960,epoch time: 0:01:27.959433,used: 0:13:27.562736,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_01_59_53_seed_0_22769264
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9866536, 'precision': 0.98662734, 'recall': 0.9867022, 'specificity': 0.9867022, 'f1': 0.98665214, 'auroc': 0.99848866, 'binary_precision': 0.9903038, 'binary_recall': 0.98331195, 'binary_specificity': 0.99009246, 'binary_f1_score': 0.9867955}
confusion matrix:
      0     1
0  1499    15
1    26  1532
---- Validation: 
scalar performance:
{'acc': 0.746118, 'precision': 0.79877734, 'recall': 0.74314916, 'specificity': 0.74314916, 'f1': 0.73285383, 'auroc': 0.90075606, 'binary_precision': 0.92076504, 'binary_recall': 0.5307087, 'binary_specificity': 0.9555896, 'binary_f1_score': 0.6733267}
confusion matrix:
     0    1
0  624   29
1  298  337
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.81860465, 'precision': 0.85638237, 'recall': 0.81860465, 'specificity': 0.81860465, 'f1': 0.8136667, 'auroc': 0.9182044, 'binary_precision': 0.9724138, 'binary_recall': 0.65581393, 'binary_specificity': 0.98139536, 'binary_f1_score': 0.7833333}
confusion matrix:
     0    1
0  211    4
1   74  141
early stop counter: 4
val acc:0.7461180090904236, best validation acc: 0.861801266670227, corresponding to test acc:                         0.8372092843055725 / 0.8860465288162231
after epoch: 10,now: 2024-07-23 02:14:47.308399,epoch time: 0:01:26.698439,used: 0:14:54.261175,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_01_59_53_seed_0_22769264
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9869792, 'precision': 0.98707306, 'recall': 0.98709947, 'specificity': 0.98709947, 'f1': 0.9869791, 'auroc': 0.99923056, 'binary_precision': 0.99737185, 'binary_recall': 0.976834, 'binary_specificity': 0.99736494, 'binary_f1_score': 0.98699605}
confusion matrix:
      0     1
0  1514     4
1    36  1518
---- Validation: 
scalar performance:
{'acc': 0.64052796, 'precision': 0.7349924, 'recall': 0.6360191, 'specificity': 0.6360191, 'f1': 0.59614116, 'auroc': 0.83447444, 'binary_precision': 0.88053095, 'binary_recall': 0.3133858, 'binary_specificity': 0.9586524, 'binary_f1_score': 0.46225315}
confusion matrix:
     0    1
0  626   27
1  436  199
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.80697674, 'precision': 0.8338509, 'recall': 0.80697674, 'specificity': 0.80697674, 'f1': 0.8030125, 'auroc': 0.90712816, 'binary_precision': 0.9285714, 'binary_recall': 0.66511625, 'binary_specificity': 0.9488372, 'binary_f1_score': 0.77506775}
confusion matrix:
     0    1
0  204   11
1   72  143
early stop counter: 5
val acc:0.6405279636383057, best validation acc: 0.861801266670227, corresponding to test acc:                         0.8372092843055725 / 0.8860465288162231
after epoch: 11,now: 2024-07-23 02:16:14.926690,epoch time: 0:01:27.618291,used: 0:16:21.879466,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_01_59_53_seed_0_22769264
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9902344, 'precision': 0.9902414, 'recall': 0.99022484, 'specificity': 0.99022484, 'f1': 0.9902327, 'auroc': 0.99965703, 'binary_precision': 0.9897238, 'binary_recall': 0.9909968, 'binary_specificity': 0.98945284, 'binary_f1_score': 0.9903599}
confusion matrix:
      0     1
0  1501    16
1    14  1541
---- Validation: 
scalar performance:
{'acc': 0.7763975, 'precision': 0.80985343, 'recall': 0.77407485, 'specificity': 0.77407485, 'f1': 0.7691642, 'auroc': 0.8878369, 'binary_precision': 0.9082353, 'binary_recall': 0.60787404, 'binary_specificity': 0.94027567, 'binary_f1_score': 0.72830194}
confusion matrix:
     0    1
0  614   39
1  249  386
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8697674, 'precision': 0.87814426, 'recall': 0.8697674, 'specificity': 0.8697674, 'f1': 0.86904216, 'auroc': 0.92108166, 'binary_precision': 0.93442625, 'binary_recall': 0.7953488, 'binary_specificity': 0.94418603, 'binary_f1_score': 0.8592965}
confusion matrix:
     0    1
0  203   12
1   44  171
early stop counter: 6
val acc:0.7763975262641907, best validation acc: 0.861801266670227, corresponding to test acc:                         0.8372092843055725 / 0.8860465288162231
after epoch: 12,now: 2024-07-23 02:17:42.350239,epoch time: 0:01:27.423549,used: 0:17:49.303015,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_01_59_53_seed_0_22769264
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9863281, 'precision': 0.98635006, 'recall': 0.98644656, 'specificity': 0.98644656, 'f1': 0.98632765, 'auroc': 0.99913216, 'binary_precision': 0.9947781, 'binary_recall': 0.97817713, 'binary_specificity': 0.994716, 'binary_f1_score': 0.98640776}
confusion matrix:
      0     1
0  1506     8
1    34  1524
---- Validation: 
scalar performance:
{'acc': 0.7810559, 'precision': 0.8229408, 'recall': 0.77851707, 'specificity': 0.77851707, 'f1': 0.77262616, 'auroc': 0.90713966, 'binary_precision': 0.93580246, 'binary_recall': 0.5968504, 'binary_specificity': 0.96018374, 'binary_f1_score': 0.7288462}
confusion matrix:
     0    1
0  627   26
1  256  379
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.83488375, 'precision': 0.87090284, 'recall': 0.8348837, 'specificity': 0.8348837, 'f1': 0.8307753, 'auroc': 0.9191996, 'binary_precision': 0.9864865, 'binary_recall': 0.67906976, 'binary_specificity': 0.9906977, 'binary_f1_score': 0.8044077}
confusion matrix:
     0    1
0  213    2
1   69  146
early stop counter: 7
val acc:0.7810559272766113, best validation acc: 0.861801266670227, corresponding to test acc:                         0.8372092843055725 / 0.8860465288162231
after epoch: 13,now: 2024-07-23 02:19:09.947632,epoch time: 0:01:27.597393,used: 0:19:16.900408,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_01_59_53_seed_0_22769264
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9827474, 'precision': 0.9830325, 'recall': 0.98296225, 'specificity': 0.98296225, 'f1': 0.9827473, 'auroc': 0.9982041, 'binary_precision': 0.99867374, 'binary_recall': 0.9672447, 'binary_specificity': 0.9986799, 'binary_f1_score': 0.982708}
confusion matrix:
      0     1
0  1513     2
1    51  1506
---- Validation: 
scalar performance:
{'acc': 0.64829195, 'precision': 0.7501175, 'recall': 0.6437629, 'specificity': 0.6437629, 'f1': 0.60440516, 'auroc': 0.89054817, 'binary_precision': 0.90625, 'binary_recall': 0.31968504, 'binary_specificity': 0.96784073, 'binary_f1_score': 0.47264263}
confusion matrix:
     0    1
0  632   21
1  432  203
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.66744184, 'precision': 0.7819056, 'recall': 0.66744184, 'specificity': 0.66744184, 'f1': 0.62987036, 'auroc': 0.8791779, 'binary_precision': 0.96153843, 'binary_recall': 0.3488372, 'binary_specificity': 0.9860465, 'binary_f1_score': 0.51194537}
confusion matrix:
     0   1
0  212   3
1  140  75
early stop counter: 8
val acc:0.6482919454574585, best validation acc: 0.861801266670227, corresponding to test acc:                         0.8372092843055725 / 0.8860465288162231
after epoch: 14,now: 2024-07-23 02:20:36.817812,epoch time: 0:01:26.870180,used: 0:20:43.770588,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_01_59_53_seed_0_22769264
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9899089, 'precision': 0.9899186, 'recall': 0.99000937, 'specificity': 0.99000937, 'f1': 0.9899085, 'auroc': 0.99884224, 'binary_precision': 0.9973924, 'binary_recall': 0.982659, 'binary_specificity': 0.99735975, 'binary_f1_score': 0.9899709}
confusion matrix:
      0     1
0  1511     4
1    27  1530
---- Validation: 
scalar performance:
{'acc': 0.6847826, 'precision': 0.75507176, 'recall': 0.6810529, 'specificity': 0.6810529, 'f1': 0.6587095, 'auroc': 0.8432341, 'binary_precision': 0.8855219, 'binary_recall': 0.41417322, 'binary_specificity': 0.9479326, 'binary_f1_score': 0.56437767}
confusion matrix:
     0    1
0  619   34
1  372  263
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8, 'precision': 0.8171526, 'recall': 0.8, 'specificity': 0.8, 'f1': 0.79725873, 'auroc': 0.9037967, 'binary_precision': 0.8909091, 'binary_recall': 0.68372095, 'binary_specificity': 0.9162791, 'binary_f1_score': 0.7736842}
confusion matrix:
     0    1
0  197   18
1   68  147
early stop counter: 9
val acc:0.6847826242446899, best validation acc: 0.861801266670227, corresponding to test acc:                         0.8372092843055725 / 0.8860465288162231
after epoch: 15,now: 2024-07-23 02:22:03.871180,epoch time: 0:01:27.053368,used: 0:22:10.823956,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_01_59_53_seed_0_22769264
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9895833, 'precision': 0.9895587, 'recall': 0.9896185, 'specificity': 0.9896185, 'f1': 0.9895818, 'auroc': 0.99933344, 'binary_precision': 0.9922581, 'binary_recall': 0.987163, 'binary_specificity': 0.99207395, 'binary_f1_score': 0.98970395}
confusion matrix:
      0     1
0  1502    12
1    20  1538
---- Validation: 
scalar performance:
{'acc': 0.8493789, 'precision': 0.8612212, 'recall': 0.8481123, 'specificity': 0.8481123, 'f1': 0.8477801, 'auroc': 0.9210259, 'binary_precision': 0.92322457, 'binary_recall': 0.7574803, 'binary_specificity': 0.93874425, 'binary_f1_score': 0.83217996}
confusion matrix:
     0    1
0  613   40
1  154  481
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.87906975, 'precision': 0.8941094, 'recall': 0.8790698, 'specificity': 0.8790698, 'f1': 0.87790495, 'auroc': 0.9424986, 'binary_precision': 0.97109824, 'binary_recall': 0.7813954, 'binary_specificity': 0.9767442, 'binary_f1_score': 0.8659794}
confusion matrix:
     0    1
0  210    5
1   47  168
early stop counter: 10
val acc:0.8493788838386536, best validation acc: 0.861801266670227, corresponding to test acc:                         0.8372092843055725 / 0.8860465288162231
after epoch: 16,now: 2024-07-23 02:23:32.219216,epoch time: 0:01:28.348036,used: 0:23:39.171992,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_01_59_53_seed_0_22769264
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9873047, 'precision': 0.987422, 'recall': 0.9874437, 'specificity': 0.9874437, 'f1': 0.9873047, 'auroc': 0.999423, 'binary_precision': 0.9986842, 'binary_recall': 0.97620577, 'binary_specificity': 0.9986816, 'binary_f1_score': 0.987317}
confusion matrix:
      0     1
0  1515     2
1    37  1518
---- Validation: 
scalar performance:
{'acc': 0.6032609, 'precision': 0.7492871, 'recall': 0.59783316, 'specificity': 0.59783316, 'f1': 0.52914786, 'auroc': 0.8448156, 'binary_precision': 0.9366197, 'binary_recall': 0.20944881, 'binary_specificity': 0.98621744, 'binary_f1_score': 0.34234232}
confusion matrix:
     0    1
0  644    9
1  502  133
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.60232556, 'precision': 0.76777625, 'recall': 0.60232556, 'specificity': 0.60232556, 'f1': 0.5296759, 'auroc': 0.8901893, 'binary_precision': 0.9782609, 'binary_recall': 0.20930232, 'binary_specificity': 0.9953488, 'binary_f1_score': 0.34482756}
confusion matrix:
     0   1
0  214   1
1  170  45
early stop counter: 11
val acc:0.60326087474823, best validation acc: 0.861801266670227, corresponding to test acc:                         0.8372092843055725 / 0.8860465288162231
after epoch: 17,now: 2024-07-23 02:24:58.836817,epoch time: 0:01:26.617601,used: 0:25:05.789593,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_01_59_53_seed_0_22769264
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9873047, 'precision': 0.9874441, 'recall': 0.9874518, 'specificity': 0.9874518, 'f1': 0.9873047, 'auroc': 0.99934244, 'binary_precision': 0.99934125, 'binary_recall': 0.9755627, 'binary_specificity': 0.99934083, 'binary_f1_score': 0.9873088}
confusion matrix:
      0     1
0  1516     1
1    38  1517
---- Validation: 
scalar performance:
{'acc': 0.63586956, 'precision': 0.7603154, 'recall': 0.6309691, 'specificity': 0.6309691, 'f1': 0.5818341, 'auroc': 0.8905596, 'binary_precision': 0.9368421, 'binary_recall': 0.28031495, 'binary_specificity': 0.9816233, 'binary_f1_score': 0.43151516}
confusion matrix:
     0    1
0  641   12
1  457  178
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.73953485, 'precision': 0.82446885, 'recall': 0.73953485, 'specificity': 0.73953485, 'f1': 0.7212963, 'auroc': 0.9075392, 'binary_precision': 0.9904762, 'binary_recall': 0.48372093, 'binary_specificity': 0.9953488, 'binary_f1_score': 0.65}
confusion matrix:
     0    1
0  214    1
1  111  104
early stop counter: 12
val acc:0.635869562625885, best validation acc: 0.861801266670227, corresponding to test acc:                         0.8372092843055725 / 0.8860465288162231
after epoch: 18,now: 2024-07-23 02:26:25.116394,epoch time: 0:01:26.279577,used: 0:26:32.069170,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_01_59_53_seed_0_22769264
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9765625, 'precision': 0.97758764, 'recall': 0.9762821, 'specificity': 0.9762821, 'f1': 0.97653556, 'auroc': 0.9991932, 'binary_precision': 0.95861644, 'binary_recall': 0.9967887, 'binary_specificity': 0.95577556, 'binary_f1_score': 0.97732997}
confusion matrix:
      0     1
0  1448    67
1     5  1552
---- Validation: 
scalar performance:
{'acc': 0.83462733, 'precision': 0.844007, 'recall': 0.83577794, 'specificity': 0.83577794, 'f1': 0.8337977, 'auroc': 0.9084468, 'binary_precision': 0.7836022, 'binary_recall': 0.91811025, 'binary_specificity': 0.7534456, 'binary_f1_score': 0.8455403}
confusion matrix:
     0    1
0  492  161
1   52  583
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.82790697, 'precision': 0.84363735, 'recall': 0.82790697, 'specificity': 0.82790697, 'f1': 0.82591474, 'auroc': 0.93914545, 'binary_precision': 0.77011496, 'binary_recall': 0.9348837, 'binary_specificity': 0.7209302, 'binary_f1_score': 0.84453785}
confusion matrix:
     0    1
0  155   60
1   14  201
early stop counter: 13
val acc:0.8346273303031921, best validation acc: 0.861801266670227, corresponding to test acc:                         0.8372092843055725 / 0.8860465288162231
after epoch: 19,now: 2024-07-23 02:27:52.206550,epoch time: 0:01:27.090156,used: 0:27:59.159326,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_01_59_53_seed_0_22769264
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.98535156, 'precision': 0.9854346, 'recall': 0.9854957, 'specificity': 0.9854957, 'f1': 0.98535144, 'auroc': 0.9993756, 'binary_precision': 0.996063, 'binary_recall': 0.9749518, 'binary_specificity': 0.9960396, 'binary_f1_score': 0.98539436}
confusion matrix:
      0     1
0  1509     6
1    39  1518
---- Validation: 
scalar performance:
{'acc': 0.67701864, 'precision': 0.7752634, 'recall': 0.67278826, 'specificity': 0.67278826, 'f1': 0.64216006, 'auroc': 0.84364593, 'binary_precision': 0.936255, 'binary_recall': 0.37007874, 'binary_specificity': 0.9754977, 'binary_f1_score': 0.530474}
confusion matrix:
     0    1
0  637   16
1  400  235
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.73953485, 'precision': 0.8164566, 'recall': 0.73953485, 'specificity': 0.73953485, 'f1': 0.72268283, 'auroc': 0.8853867, 'binary_precision': 0.9724771, 'binary_recall': 0.49302325, 'binary_specificity': 0.9860465, 'binary_f1_score': 0.65432096}
confusion matrix:
     0    1
0  212    3
1  109  106
early stop counter: 14
val acc:0.6770186424255371, best validation acc: 0.861801266670227, corresponding to test acc:                         0.8372092843055725 / 0.8860465288162231
after epoch: 20,now: 2024-07-23 02:29:19.388800,epoch time: 0:01:27.182250,used: 0:29:26.341576,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_01_59_53_seed_0_22769264
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9951172, 'precision': 0.99512964, 'recall': 0.995105, 'specificity': 0.995105, 'f1': 0.9951164, 'auroc': 0.99987876, 'binary_precision': 0.99421966, 'binary_recall': 0.996139, 'binary_specificity': 0.9940711, 'binary_f1_score': 0.9951784}
confusion matrix:
      0     1
0  1509     9
1     6  1548
---- Validation: 
scalar performance:
{'acc': 0.76785713, 'precision': 0.813058, 'recall': 0.7651746, 'specificity': 0.7651746, 'f1': 0.7579165, 'auroc': 0.8911432, 'binary_precision': 0.9285714, 'binary_recall': 0.57322836, 'binary_specificity': 0.95712095, 'binary_f1_score': 0.70886075}
confusion matrix:
     0    1
0  625   28
1  271  364
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.83255816, 'precision': 0.8627215, 'recall': 0.83255816, 'specificity': 0.83255816, 'f1': 0.8290032, 'auroc': 0.93189836, 'binary_precision': 0.96732026, 'binary_recall': 0.6883721, 'binary_specificity': 0.9767442, 'binary_f1_score': 0.8043478}
confusion matrix:
     0    1
0  210    5
1   67  148
early stop counter: 15
val acc:0.7678571343421936, best validation acc: 0.861801266670227, corresponding to test acc:                         0.8372092843055725 / 0.8860465288162231
after epoch: 21,now: 2024-07-23 02:30:45.744254,epoch time: 0:01:26.355454,used: 0:30:52.697030,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_01_59_53_seed_0_22769264
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9899089, 'precision': 0.9899871, 'recall': 0.9900322, 'specificity': 0.9900322, 'f1': 0.9899088, 'auroc': 0.99956423, 'binary_precision': 1.0, 'binary_recall': 0.98006433, 'binary_specificity': 1.0, 'binary_f1_score': 0.98993176}
confusion matrix:
      0     1
0  1517     0
1    31  1524
---- Validation: 
scalar performance:
{'acc': 0.6746894, 'precision': 0.7790679, 'recall': 0.6703609, 'specificity': 0.6703609, 'f1': 0.63780963, 'auroc': 0.8953612, 'binary_precision': 0.946281, 'binary_recall': 0.36062992, 'binary_specificity': 0.98009187, 'binary_f1_score': 0.52223486}
confusion matrix:
     0    1
0  640   13
1  406  229
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.74186045, 'precision': 0.82552993, 'recall': 0.74186045, 'specificity': 0.74186045, 'f1': 0.7241343, 'auroc': 0.912861, 'binary_precision': 0.990566, 'binary_recall': 0.4883721, 'binary_specificity': 0.9953488, 'binary_f1_score': 0.6542056}
confusion matrix:
     0    1
0  214    1
1  110  105
early stop counter: 16
val acc:0.6746894121170044, best validation acc: 0.861801266670227, corresponding to test acc:                         0.8372092843055725 / 0.8860465288162231
after epoch: 22,now: 2024-07-23 02:32:11.836163,epoch time: 0:01:26.091909,used: 0:32:18.788939,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_01_59_53_seed_0_22769264
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.9921875, 'precision': 0.9921722, 'recall': 0.9922699, 'specificity': 0.9922699, 'f1': 0.99218696, 'auroc': 0.9998678, 'binary_precision': 0.99805194, 'binary_recall': 0.9865212, 'binary_specificity': 0.9980185, 'binary_f1_score': 0.99225307}
confusion matrix:
      0     1
0  1511     3
1    21  1537
---- Validation: 
scalar performance:
{'acc': 0.66847825, 'precision': 0.76723355, 'recall': 0.6641702, 'specificity': 0.6641702, 'f1': 0.6313001, 'auroc': 0.8646996, 'binary_precision': 0.92622954, 'binary_recall': 0.3559055, 'binary_specificity': 0.97243494, 'binary_f1_score': 0.5142207}
confusion matrix:
     0    1
0  635   18
1  409  226
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7372093, 'precision': 0.8010378, 'recall': 0.7372093, 'specificity': 0.7372093, 'f1': 0.72249985, 'auroc': 0.8930881, 'binary_precision': 0.9396552, 'binary_recall': 0.5069767, 'binary_specificity': 0.96744186, 'binary_f1_score': 0.6586102}
confusion matrix:
     0    1
0  208    7
1  106  109
early stop counter: 17
val acc:0.66847825050354, best validation acc: 0.861801266670227, corresponding to test acc:                         0.8372092843055725 / 0.8860465288162231
after epoch: 23,now: 2024-07-23 02:33:38.752651,epoch time: 0:01:26.916488,used: 0:33:45.705427,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_01_59_53_seed_0_22769264
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9902344, 'precision': 0.9902509, 'recall': 0.99035895, 'specificity': 0.99035895, 'f1': 0.990234, 'auroc': 0.9994539, 'binary_precision': 0.9986954, 'binary_recall': 0.98203975, 'binary_specificity': 0.99867815, 'binary_f1_score': 0.99029756}
confusion matrix:
      0     1
0  1511     2
1    28  1531
---- Validation: 
scalar performance:
{'acc': 0.63121116, 'precision': 0.7672907, 'recall': 0.6261579, 'specificity': 0.6261579, 'f1': 0.5725907, 'auroc': 0.90534544, 'binary_precision': 0.95454544, 'binary_recall': 0.26456693, 'binary_specificity': 0.98774886, 'binary_f1_score': 0.4143033}
confusion matrix:
     0    1
0  645    8
1  467  168
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.69534886, 'precision': 0.8106936, 'recall': 0.69534886, 'specificity': 0.69534886, 'f1': 0.66418064, 'auroc': 0.90678203, 'binary_precision': 1.0, 'binary_recall': 0.3906977, 'binary_specificity': 1.0, 'binary_f1_score': 0.5618729}
confusion matrix:
     0   1
0  215   0
1  131  84
early stop counter: 18
val acc:0.6312111616134644, best validation acc: 0.861801266670227, corresponding to test acc:                         0.8372092843055725 / 0.8860465288162231
after epoch: 24,now: 2024-07-23 02:35:05.471280,epoch time: 0:01:26.718629,used: 0:35:12.424056,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_01_59_53_seed_0_22769264
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.9951172, 'precision': 0.99510086, 'recall': 0.9951376, 'specificity': 0.9951376, 'f1': 0.9951166, 'auroc': 0.9995341, 'binary_precision': 0.9967763, 'binary_recall': 0.99357325, 'binary_specificity': 0.99670184, 'binary_f1_score': 0.9951722}
confusion matrix:
      0     1
0  1511     5
1    10  1546
---- Validation: 
scalar performance:
{'acc': 0.71506214, 'precision': 0.7798458, 'recall': 0.71165305, 'specificity': 0.71165305, 'f1': 0.69543076, 'auroc': 0.87095535, 'binary_precision': 0.9110429, 'binary_recall': 0.46771654, 'binary_specificity': 0.9555896, 'binary_f1_score': 0.6181061}
confusion matrix:
     0    1
0  624   29
1  338  297
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.82325584, 'precision': 0.8348459, 'recall': 0.8232558, 'specificity': 0.8232558, 'f1': 0.82171303, 'auroc': 0.9029962, 'binary_precision': 0.8971428, 'binary_recall': 0.73023254, 'binary_specificity': 0.9162791, 'binary_f1_score': 0.80512816}
confusion matrix:
     0    1
0  197   18
1   58  157
early stop counter: 19
val acc:0.715062141418457, best validation acc: 0.861801266670227, corresponding to test acc:                         0.8372092843055725 / 0.8860465288162231
after epoch: 25,now: 2024-07-23 02:36:32.984344,epoch time: 0:01:27.513064,used: 0:36:39.937120,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_01_59_53_seed_0_22769264
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9947917, 'precision': 0.994771, 'recall': 0.9948247, 'specificity': 0.9948247, 'f1': 0.99479115, 'auroc': 0.99986684, 'binary_precision': 0.997416, 'binary_recall': 0.99228793, 'binary_specificity': 0.9973615, 'binary_f1_score': 0.9948454}
confusion matrix:
      0     1
0  1512     4
1    12  1544
---- Validation: 
scalar performance:
{'acc': 0.7554348, 'precision': 0.80449736, 'recall': 0.7525979, 'specificity': 0.7525979, 'f1': 0.7437535, 'auroc': 0.90088147, 'binary_precision': 0.9232804, 'binary_recall': 0.5496063, 'binary_specificity': 0.9555896, 'binary_f1_score': 0.68904245}
confusion matrix:
     0    1
0  624   29
1  286  349
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8395349, 'precision': 0.8565749, 'recall': 0.8395349, 'specificity': 0.8395349, 'f1': 0.8375946, 'auroc': 0.9205625, 'binary_precision': 0.9345238, 'binary_recall': 0.73023254, 'binary_specificity': 0.9488372, 'binary_f1_score': 0.8198434}
confusion matrix:
     0    1
0  204   11
1   58  157
early stop counter: 20
val acc:0.7554348111152649, best validation acc: 0.861801266670227, corresponding to test acc:                         0.8372092843055725 / 0.8860465288162231
after epoch: 26,now: 2024-07-23 02:38:00.137753,epoch time: 0:01:27.153409,used: 0:38:07.090529,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_01_59_53_seed_0_22769264
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.99641925, 'precision': 0.99644387, 'recall': 0.99639857, 'specificity': 0.99639857, 'f1': 0.9964186, 'auroc': 0.9998847, 'binary_precision': 0.9948718, 'binary_recall': 0.9980707, 'binary_specificity': 0.9947264, 'binary_f1_score': 0.99646866}
confusion matrix:
      0     1
0  1509     8
1     3  1552
---- Validation: 
scalar performance:
{'acc': 0.6537267, 'precision': 0.7660613, 'recall': 0.6491228, 'specificity': 0.6491228, 'f1': 0.6089126, 'auroc': 0.8835176, 'binary_precision': 0.9354839, 'binary_recall': 0.31968504, 'binary_specificity': 0.9785605, 'binary_f1_score': 0.4765258}
confusion matrix:
     0    1
0  639   14
1  432  203
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.75581396, 'precision': 0.8282534, 'recall': 0.75581396, 'specificity': 0.75581396, 'f1': 0.74155545, 'auroc': 0.90831804, 'binary_precision': 0.98245615, 'binary_recall': 0.52093023, 'binary_specificity': 0.9906977, 'binary_f1_score': 0.68085104}
confusion matrix:
     0    1
0  213    2
1  103  112
early stop counter: 21
val acc:0.6537266969680786, best validation acc: 0.861801266670227, corresponding to test acc:                         0.8372092843055725 / 0.8860465288162231
after epoch: 27,now: 2024-07-23 02:39:28.276543,epoch time: 0:01:28.138790,used: 0:39:35.229319,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_01_59_53_seed_0_22769264
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.9938151, 'precision': 0.99379593, 'recall': 0.99388075, 'specificity': 0.99388075, 'f1': 0.9938146, 'auroc': 0.99979824, 'binary_precision': 0.998703, 'binary_recall': 0.98908156, 'binary_specificity': 0.9986799, 'binary_f1_score': 0.993869}
confusion matrix:
      0     1
0  1513     2
1    17  1540
---- Validation: 
scalar performance:
{'acc': 0.5931677, 'precision': 0.72770816, 'recall': 0.58770543, 'specificity': 0.58770543, 'f1': 0.5161047, 'auroc': 0.8809269, 'binary_precision': 0.89928055, 'binary_recall': 0.19685039, 'binary_specificity': 0.9785605, 'binary_f1_score': 0.3229974}
confusion matrix:
     0    1
0  639   14
1  510  125
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7046512, 'precision': 0.78666663, 'recall': 0.7046512, 'specificity': 0.7046512, 'f1': 0.68189895, 'auroc': 0.8725149, 'binary_precision': 0.94, 'binary_recall': 0.4372093, 'binary_specificity': 0.97209305, 'binary_f1_score': 0.59682536}
confusion matrix:
     0   1
0  209   6
1  121  94
early stop counter: 22
val acc:0.5931677222251892, best validation acc: 0.861801266670227, corresponding to test acc:                         0.8372092843055725 / 0.8860465288162231
after epoch: 28,now: 2024-07-23 02:40:55.245742,epoch time: 0:01:26.969199,used: 0:41:02.198518,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_01_59_53_seed_0_22769264
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9866536, 'precision': 0.9868006, 'recall': 0.98682475, 'specificity': 0.98682475, 'f1': 0.9866536, 'auroc': 0.9997325, 'binary_precision': 0.99934125, 'binary_recall': 0.97430956, 'binary_specificity': 0.99933994, 'binary_f1_score': 0.9866667}
confusion matrix:
      0     1
0  1514     1
1    40  1517
---- Validation: 
scalar performance:
{'acc': 0.6180124, 'precision': 0.76329494, 'recall': 0.61275035, 'specificity': 0.61275035, 'f1': 0.5515016, 'auroc': 0.883268, 'binary_precision': 0.955414, 'binary_recall': 0.23622048, 'binary_specificity': 0.9892802, 'binary_f1_score': 0.3787879}
confusion matrix:
     0    1
0  646    7
1  485  150
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.76046515, 'precision': 0.8380503, 'recall': 0.76046515, 'specificity': 0.76046515, 'f1': 0.7458848, 'auroc': 0.91726875, 'binary_precision': 1.0, 'binary_recall': 0.52093023, 'binary_specificity': 1.0, 'binary_f1_score': 0.68501526}
confusion matrix:
     0    1
0  215    0
1  103  112
early stop counter: 23
val acc:0.6180124282836914, best validation acc: 0.861801266670227, corresponding to test acc:                         0.8372092843055725 / 0.8860465288162231
after epoch: 29,now: 2024-07-23 02:42:21.467276,epoch time: 0:01:26.221534,used: 0:42:28.420052,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_01_59_53_seed_0_22769264
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.99153644, 'precision': 0.9915271, 'recall': 0.99154377, 'specificity': 0.99154377, 'f1': 0.99153495, 'auroc': 0.99972445, 'binary_precision': 0.992283, 'binary_recall': 0.99100834, 'binary_specificity': 0.9920792, 'binary_f1_score': 0.9916452}
confusion matrix:
      0     1
0  1503    12
1    14  1543
---- Validation: 
scalar performance:
{'acc': 0.79891306, 'precision': 0.83192945, 'recall': 0.79669243, 'specificity': 0.79669243, 'f1': 0.79292643, 'auroc': 0.91775095, 'binary_precision': 0.93317974, 'binary_recall': 0.63779527, 'binary_specificity': 0.9555896, 'binary_f1_score': 0.7577175}
confusion matrix:
     0    1
0  624   29
1  230  405
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7860465, 'precision': 0.8436111, 'recall': 0.7860465, 'specificity': 0.7860465, 'f1': 0.776694, 'auroc': 0.92440784, 'binary_precision': 0.984252, 'binary_recall': 0.5813953, 'binary_specificity': 0.9906977, 'binary_f1_score': 0.7309941}
confusion matrix:
     0    1
0  213    2
1   90  125
early stop counter: 24
val acc:0.7989130616188049, best validation acc: 0.861801266670227, corresponding to test acc:                         0.8372092843055725 / 0.8860465288162231
after epoch: 30,now: 2024-07-23 02:43:49.137787,epoch time: 0:01:27.670511,used: 0:43:56.090563,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_01_59_53_seed_0_22769264
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 0:43:56.090563 at 2024-07-23 02:43:49.137787
persisted model performance metric: 

scalar performance:
{'acc': 0.8372093, 'precision': 0.8379404, 'recall': 0.8372093, 'specificity': 0.8372093, 'f1': 0.83712125, 'auroc': 0.92806923, 'binary_precision': 0.82222223, 'binary_recall': 0.8604651, 'binary_specificity': 0.81395346, 'binary_f1_score': 0.8409091}
confusion matrix:
     0    1
0  175   40
1   30  185
oracle model performance metric: 

scalar performance:
{'acc': 0.8860465, 'precision': 0.8884753, 'recall': 0.8860465, 'specificity': 0.8860465, 'f1': 0.8858682, 'auroc': 0.930557, 'binary_precision': 0.9191919, 'binary_recall': 0.8465116, 'binary_specificity': 0.9255814, 'binary_f1_score': 0.88135594}
confusion matrix:
     0    1
0  199   16
1   33  182
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_dial_lr1e5_bs16_allfreeze_2024-07-22_23-46-53/rule_results/3.csv
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_dial_lr1e5_bs16_allfreeze_2024-07-22_23-46-53/rule_results/3.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_dial_lr1e5_bs16_allfreeze_2024-07-22_23-46-53/confusion_matrix/3.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 455936 KiB |  26075 MiB |  70808 GiB |  70807 GiB |
|       from large pool | 415383 KiB |  26030 MiB |  70366 GiB |  70365 GiB |
|       from small pool |  40553 KiB |     56 MiB |    442 GiB |    442 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 455936 KiB |  26075 MiB |  70808 GiB |  70807 GiB |
|       from large pool | 415383 KiB |  26030 MiB |  70366 GiB |  70365 GiB |
|       from small pool |  40553 KiB |     56 MiB |    442 GiB |    442 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 447480 KiB |  26071 MiB |  70793 GiB |  70793 GiB |
|       from large pool | 407075 KiB |  26026 MiB |  70351 GiB |  70351 GiB |
|       from small pool |  40405 KiB |     56 MiB |    441 GiB |    441 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  27750 MiB |  27750 MiB |  27750 MiB |      0 B   |
|       from large pool |  27680 MiB |  27680 MiB |  27680 MiB |      0 B   |
|       from small pool |     70 MiB |     70 MiB |     70 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |    768 MiB |   1678 MiB |  33155 GiB |  33154 GiB |
|       from large pool |    752 MiB |   1668 MiB |  32710 GiB |  32709 GiB |
|       from small pool |     16 MiB |     21 MiB |    444 GiB |    444 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    1220    |    2568    |    6427 K  |    6425 K  |
|       from large pool |     187    |    1413    |    3247 K  |    3247 K  |
|       from small pool |    1033    |    1329    |    3179 K  |    3178 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    1220    |    2568    |    6427 K  |    6425 K  |
|       from large pool |     187    |    1413    |    3247 K  |    3247 K  |
|       from small pool |    1033    |    1329    |    3179 K  |    3178 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     835    |     835    |     835    |       0    |
|       from large pool |     800    |     800    |     800    |       0    |
|       from small pool |      35    |      35    |      35    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     102    |     852    |    4740 K  |    4740 K  |
|       from large pool |      39    |     799    |    2905 K  |    2905 K  |
|       from small pool |      63    |     146    |    1835 K  |    1835 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  26075 MiB |  70808 GiB |  70808 GiB |
|       from large pool |  16640 KiB |  26030 MiB |  70366 GiB |  70366 GiB |
|       from small pool |      0 KiB |     56 MiB |    442 GiB |    442 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  26075 MiB |  70808 GiB |  70808 GiB |
|       from large pool |  16640 KiB |  26030 MiB |  70366 GiB |  70366 GiB |
|       from small pool |      0 KiB |     56 MiB |    442 GiB |    442 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  26071 MiB |  70793 GiB |  70793 GiB |
|       from large pool |  16640 KiB |  26026 MiB |  70351 GiB |  70351 GiB |
|       from small pool |      0 KiB |     56 MiB |    441 GiB |    441 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1214 MiB |  27750 MiB |  27750 MiB |  26536 MiB |
|       from large pool |   1158 MiB |  27680 MiB |  27680 MiB |  26522 MiB |
|       from small pool |     56 MiB |     70 MiB |     70 MiB |     14 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |   3840 KiB |   1678 MiB |  33155 GiB |  33155 GiB |
|       from large pool |   3840 KiB |   1668 MiB |  32710 GiB |  32710 GiB |
|       from small pool |      0 KiB |     29 MiB |    444 GiB |    444 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    2568    |    6427 K  |    6427 K  |
|       from large pool |       2    |    1413    |    3247 K  |    3247 K  |
|       from small pool |       0    |    1329    |    3179 K  |    3179 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    2568    |    6427 K  |    6427 K  |
|       from large pool |       2    |    1413    |    3247 K  |    3247 K  |
|       from small pool |       0    |    1329    |    3179 K  |    3179 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      67    |     835    |     835    |     768    |
|       from large pool |      39    |     800    |     800    |     761    |
|       from small pool |      28    |      35    |      35    |       7    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       1    |     852    |    4741 K  |    4741 K  |
|       from large pool |       1    |     799    |    2905 K  |    2905 K  |
|       from small pool |       0    |     146    |    1835 K  |    1835 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  26075 MiB |  70808 GiB |  70808 GiB |
|       from large pool |  16640 KiB |  26030 MiB |  70366 GiB |  70366 GiB |
|       from small pool |      0 KiB |     56 MiB |    442 GiB |    442 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  26075 MiB |  70808 GiB |  70808 GiB |
|       from large pool |  16640 KiB |  26030 MiB |  70366 GiB |  70366 GiB |
|       from small pool |      0 KiB |     56 MiB |    442 GiB |    442 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  26071 MiB |  70793 GiB |  70793 GiB |
|       from large pool |  16640 KiB |  26026 MiB |  70351 GiB |  70351 GiB |
|       from small pool |      0 KiB |     56 MiB |    441 GiB |    441 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1214 MiB |  27750 MiB |  27750 MiB |  26536 MiB |
|       from large pool |   1158 MiB |  27680 MiB |  27680 MiB |  26522 MiB |
|       from small pool |     56 MiB |     70 MiB |     70 MiB |     14 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |   3840 KiB |   1678 MiB |  33155 GiB |  33155 GiB |
|       from large pool |   3840 KiB |   1668 MiB |  32710 GiB |  32710 GiB |
|       from small pool |      0 KiB |     29 MiB |    444 GiB |    444 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    2568    |    6427 K  |    6427 K  |
|       from large pool |       2    |    1413    |    3247 K  |    3247 K  |
|       from small pool |       0    |    1329    |    3179 K  |    3179 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    2568    |    6427 K  |    6427 K  |
|       from large pool |       2    |    1413    |    3247 K  |    3247 K  |
|       from small pool |       0    |    1329    |    3179 K  |    3179 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      67    |     835    |     835    |     768    |
|       from large pool |      39    |     800    |     800    |     761    |
|       from small pool |      28    |      35    |      35    |       7    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       1    |     852    |    4741 K  |    4741 K  |
|       from large pool |       1    |     799    |    2905 K  |    2905 K  |
|       from small pool |       0    |     146    |    1835 K  |    1835 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'888c1ef2'
model name: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_02_45_17_seed_1_22769264

 Experiment start at: 2024-07-23 02:45:17.717242
before training, model accuracy: 0.6177777647972107
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.92252606, 'precision': 0.9293251, 'recall': 0.9233692, 'specificity': 0.9233692, 'f1': 0.92231005, 'auroc': 0.9810258, 'binary_precision': 0.9867061, 'binary_recall': 0.8586118, 'binary_specificity': 0.98812664, 'binary_f1_score': 0.9182131}
confusion matrix:
      0     1
0  1498    18
1   220  1336
---- Validation: 
scalar performance:
{'acc': 0.8196721, 'precision': 0.8275225, 'recall': 0.818382, 'specificity': 0.818382, 'f1': 0.8181289, 'auroc': 0.8914393, 'binary_precision': 0.8742964, 'binary_recall': 0.73968256, 'binary_specificity': 0.89708143, 'binary_f1_score': 0.80137575}
confusion matrix:
     0    1
0  584   67
1  164  466
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.86, 'precision': 0.86258554, 'recall': 0.86, 'specificity': 0.86, 'f1': 0.8597499, 'auroc': 0.9193876, 'binary_precision': 0.89320385, 'binary_recall': 0.81777775, 'binary_specificity': 0.9022222, 'binary_f1_score': 0.85382825}
confusion matrix:
     0    1
0  203   22
1   41  184
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-23 02:46:51.787902,epoch time: 0:01:34.070660,used: 0:01:34.070660,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_02_45_17_seed_1_22769264
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.96516925, 'precision': 0.96532905, 'recall': 0.9653533, 'specificity': 0.9653533, 'f1': 0.96516925, 'auroc': 0.9921206, 'binary_precision': 0.9782465, 'binary_recall': 0.9525032, 'binary_specificity': 0.9782034, 'binary_f1_score': 0.9652033}
confusion matrix:
      0     1
0  1481    33
1    74  1484
---- Validation: 
scalar performance:
{'acc': 0.80249804, 'precision': 0.8111166, 'recall': 0.8038403, 'specificity': 0.8038403, 'f1': 0.80156153, 'auroc': 0.90296495, 'binary_precision': 0.75507444, 'binary_recall': 0.8857143, 'binary_specificity': 0.7219662, 'binary_f1_score': 0.81519353}
confusion matrix:
     0    1
0  470  181
1   72  558
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.77555555, 'precision': 0.7989969, 'recall': 0.77555555, 'specificity': 0.77555555, 'f1': 0.77106845, 'auroc': 0.924405, 'binary_precision': 0.7152778, 'binary_recall': 0.91555554, 'binary_specificity': 0.63555557, 'binary_f1_score': 0.8031189}
confusion matrix:
     0    1
0  143   82
1   19  206
early stop counter: 1
val acc:0.8024980425834656, best validation acc: 0.8196721076965332, corresponding to test acc:                         0.8600000143051147 / 0.8600000143051147
after epoch: 2,now: 2024-07-23 02:48:21.937258,epoch time: 0:01:30.149356,used: 0:03:04.220016,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_02_45_17_seed_1_22769264
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.96875, 'precision': 0.96873623, 'recall': 0.9688125, 'specificity': 0.9688125, 'f1': 0.9687481, 'auroc': 0.99612236, 'binary_precision': 0.97402596, 'binary_recall': 0.9640103, 'binary_specificity': 0.97361475, 'binary_f1_score': 0.96899223}
confusion matrix:
      0     1
0  1476    40
1    56  1500
---- Validation: 
scalar performance:
{'acc': 0.8017174, 'precision': 0.8057532, 'recall': 0.802637, 'specificity': 0.802637, 'f1': 0.8013512, 'auroc': 0.89110035, 'binary_precision': 0.76628894, 'binary_recall': 0.85873014, 'binary_specificity': 0.74654377, 'binary_f1_score': 0.8098802}
confusion matrix:
     0    1
0  486  165
1   89  541
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7866667, 'precision': 0.8119023, 'recall': 0.7866667, 'specificity': 0.7866667, 'f1': 0.78226244, 'auroc': 0.9331358, 'binary_precision': 0.7231834, 'binary_recall': 0.9288889, 'binary_specificity': 0.64444447, 'binary_f1_score': 0.81322956}
confusion matrix:
     0    1
0  145   80
1   16  209
early stop counter: 2
val acc:0.8017174005508423, best validation acc: 0.8196721076965332, corresponding to test acc:                         0.8600000143051147 / 0.8600000143051147
after epoch: 3,now: 2024-07-23 02:49:52.539323,epoch time: 0:01:30.602065,used: 0:04:34.822081,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_02_45_17_seed_1_22769264
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.97721356, 'precision': 0.97734463, 'recall': 0.9771334, 'specificity': 0.9771334, 'f1': 0.97720546, 'auroc': 0.9978503, 'binary_precision': 0.9720457, 'binary_recall': 0.9832905, 'binary_specificity': 0.97097623, 'binary_f1_score': 0.9776358}
confusion matrix:
      0     1
0  1472    44
1    26  1530
---- Validation: 
scalar performance:
{'acc': 0.8274785, 'precision': 0.8334925, 'recall': 0.82857144, 'specificity': 0.82857144, 'f1': 0.82699096, 'auroc': 0.9100651, 'binary_precision': 0.7844228, 'binary_recall': 0.8952381, 'binary_specificity': 0.7619048, 'binary_f1_score': 0.8361749}
confusion matrix:
     0    1
0  496  155
1   66  564
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.78444445, 'precision': 0.8103448, 'recall': 0.78444445, 'specificity': 0.78444445, 'f1': 0.7798512, 'auroc': 0.93364936, 'binary_precision': 0.72068965, 'binary_recall': 0.9288889, 'binary_specificity': 0.64, 'binary_f1_score': 0.8116505}
confusion matrix:
     0    1
0  144   81
1   16  209
better model found
persisted
after epoch: 4,now: 2024-07-23 02:51:25.151320,epoch time: 0:01:32.611997,used: 0:06:07.434078,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_02_45_17_seed_1_22769264
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9720052, 'precision': 0.97288597, 'recall': 0.97230697, 'specificity': 0.97230697, 'f1': 0.9720009, 'auroc': 0.9967587, 'binary_precision': 0.99661934, 'binary_recall': 0.94790995, 'binary_specificity': 0.99670404, 'binary_f1_score': 0.97165453}
confusion matrix:
      0     1
0  1512     5
1    81  1474
---- Validation: 
scalar performance:
{'acc': 0.77751756, 'precision': 0.80206954, 'recall': 0.77514076, 'specificity': 0.77514076, 'f1': 0.77184427, 'auroc': 0.8914368, 'binary_precision': 0.8841871, 'binary_recall': 0.6301587, 'binary_specificity': 0.92012286, 'binary_f1_score': 0.7358665}
confusion matrix:
     0    1
0  599   52
1  233  397
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8488889, 'precision': 0.8580551, 'recall': 0.8488889, 'specificity': 0.8488889, 'f1': 0.84791553, 'auroc': 0.9179457, 'binary_precision': 0.91534394, 'binary_recall': 0.7688889, 'binary_specificity': 0.9288889, 'binary_f1_score': 0.8357488}
confusion matrix:
     0    1
0  209   16
1   52  173
early stop counter: 1
val acc:0.777517557144165, best validation acc: 0.8274785280227661, corresponding to test acc:                         0.7844444513320923 / 0.8600000143051147
after epoch: 5,now: 2024-07-23 02:52:54.825688,epoch time: 0:01:29.674368,used: 0:07:37.108446,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_02_45_17_seed_1_22769264
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.97265625, 'precision': 0.97369087, 'recall': 0.9729992, 'specificity': 0.9729992, 'f1': 0.9726511, 'auroc': 0.9982115, 'binary_precision': 0.9993216, 'binary_recall': 0.9466581, 'binary_specificity': 0.99934036, 'binary_f1_score': 0.9722772}
confusion matrix:
      0     1
0  1515     1
1    83  1473
---- Validation: 
scalar performance:
{'acc': 0.80483997, 'precision': 0.8311058, 'recall': 0.80250895, 'specificity': 0.80250895, 'f1': 0.8000138, 'auroc': 0.9008436, 'binary_precision': 0.920354, 'binary_recall': 0.6603175, 'binary_specificity': 0.9447005, 'binary_f1_score': 0.7689464}
confusion matrix:
     0    1
0  615   36
1  214  416
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8422222, 'precision': 0.85519516, 'recall': 0.8422222, 'specificity': 0.8422222, 'f1': 0.84076834, 'auroc': 0.9233185, 'binary_precision': 0.9230769, 'binary_recall': 0.74666667, 'binary_specificity': 0.93777776, 'binary_f1_score': 0.8255529}
confusion matrix:
     0    1
0  211   14
1   57  168
early stop counter: 2
val acc:0.8048399686813354, best validation acc: 0.8274785280227661, corresponding to test acc:                         0.7844444513320923 / 0.8600000143051147
after epoch: 6,now: 2024-07-23 02:54:24.479267,epoch time: 0:01:29.653579,used: 0:09:06.762025,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_02_45_17_seed_1_22769264
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9791667, 'precision': 0.9794792, 'recall': 0.9790157, 'specificity': 0.9790157, 'f1': 0.9791539, 'auroc': 0.9985446, 'binary_precision': 0.9704217, 'binary_recall': 0.98909557, 'binary_specificity': 0.9689359, 'binary_f1_score': 0.97966963}
confusion matrix:
      0     1
0  1466    47
1    17  1542
---- Validation: 
scalar performance:
{'acc': 0.84387195, 'precision': 0.84406185, 'recall': 0.8436508, 'specificity': 0.8436508, 'f1': 0.84375536, 'auroc': 0.90371835, 'binary_precision': 0.84902596, 'binary_recall': 0.8301587, 'binary_specificity': 0.85714287, 'binary_f1_score': 0.83948636}
confusion matrix:
     0    1
0  558   93
1  107  523
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8688889, 'precision': 0.8688962, 'recall': 0.86888885, 'specificity': 0.86888885, 'f1': 0.86888826, 'auroc': 0.9306469, 'binary_precision': 0.86725664, 'binary_recall': 0.8711111, 'binary_specificity': 0.8666667, 'binary_f1_score': 0.86917955}
confusion matrix:
     0    1
0  195   30
1   29  196
new oracle model saved
better model found
persisted
after epoch: 7,now: 2024-07-23 02:55:54.427993,epoch time: 0:01:29.948726,used: 0:10:36.710751,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_02_45_17_seed_1_22769264
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.98046875, 'precision': 0.9807472, 'recall': 0.9806689, 'specificity': 0.9806689, 'f1': 0.98046863, 'auroc': 0.99848235, 'binary_precision': 0.9960212, 'binary_recall': 0.9652956, 'binary_specificity': 0.9960422, 'binary_f1_score': 0.9804178}
confusion matrix:
      0     1
0  1510     6
1    54  1502
---- Validation: 
scalar performance:
{'acc': 0.75800157, 'precision': 0.80604774, 'recall': 0.7547107, 'specificity': 0.7547107, 'f1': 0.74648756, 'auroc': 0.88951063, 'binary_precision': 0.9232804, 'binary_recall': 0.55396825, 'binary_specificity': 0.95545316, 'binary_f1_score': 0.69246036}
confusion matrix:
     0    1
0  622   29
1  281  349
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.81777775, 'precision': 0.83428574, 'recall': 0.81777775, 'specificity': 0.81777775, 'f1': 0.8155, 'auroc': 0.90257776, 'binary_precision': 0.9085714, 'binary_recall': 0.70666665, 'binary_specificity': 0.9288889, 'binary_f1_score': 0.79499996}
confusion matrix:
     0    1
0  209   16
1   66  159
early stop counter: 1
val acc:0.7580015659332275, best validation acc: 0.8438719511032104, corresponding to test acc:                         0.8688889145851135 / 0.8688889145851135
after epoch: 8,now: 2024-07-23 02:57:23.291954,epoch time: 0:01:28.863961,used: 0:12:05.574712,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_02_45_17_seed_1_22769264
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9863281, 'precision': 0.9863446, 'recall': 0.9863099, 'specificity': 0.9863099, 'f1': 0.9863255, 'auroc': 0.9987715, 'binary_precision': 0.98524696, 'binary_recall': 0.98778135, 'binary_specificity': 0.9848385, 'binary_f1_score': 0.9865125}
confusion matrix:
      0     1
0  1494    23
1    19  1536
---- Validation: 
scalar performance:
{'acc': 0.8376269, 'precision': 0.8376479, 'recall': 0.83773685, 'specificity': 0.83773685, 'f1': 0.8376188, 'auroc': 0.90331054, 'binary_precision': 0.8286604, 'binary_recall': 0.84444445, 'binary_specificity': 0.8310292, 'binary_f1_score': 0.836478}
confusion matrix:
     0    1
0  541  110
1   98  532
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.82, 'precision': 0.82142854, 'recall': 0.82000005, 'specificity': 0.82000005, 'f1': 0.8197998, 'auroc': 0.8983902, 'binary_precision': 0.8, 'binary_recall': 0.85333335, 'binary_specificity': 0.7866667, 'binary_f1_score': 0.8258065}
confusion matrix:
     0    1
0  177   48
1   33  192
early stop counter: 2
val acc:0.8376268744468689, best validation acc: 0.8438719511032104, corresponding to test acc:                         0.8688889145851135 / 0.8688889145851135
after epoch: 9,now: 2024-07-23 02:58:45.916728,epoch time: 0:01:22.624774,used: 0:13:28.199486,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_02_45_17_seed_1_22769264
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9814453, 'precision': 0.9819809, 'recall': 0.9812693, 'specificity': 0.9812693, 'f1': 0.9814324, 'auroc': 0.99909914, 'binary_precision': 0.9687109, 'binary_recall': 0.9954984, 'binary_specificity': 0.9670402, 'binary_f1_score': 0.981922}
confusion matrix:
      0     1
0  1467    50
1     7  1548
---- Validation: 
scalar performance:
{'acc': 0.79234976, 'precision': 0.8012129, 'recall': 0.7937276, 'specificity': 0.7937276, 'f1': 0.7912965, 'auroc': 0.87045574, 'binary_precision': 0.745283, 'binary_recall': 0.87777776, 'binary_specificity': 0.7096774, 'binary_f1_score': 0.8061225}
confusion matrix:
     0    1
0  462  189
1   77  553
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7888889, 'precision': 0.80453527, 'recall': 0.7888889, 'specificity': 0.7888889, 'f1': 0.786142, 'auroc': 0.8809482, 'binary_precision': 0.73550725, 'binary_recall': 0.9022222, 'binary_specificity': 0.6755555, 'binary_f1_score': 0.81037927}
confusion matrix:
     0    1
0  152   73
1   22  203
early stop counter: 3
val acc:0.7923497557640076, best validation acc: 0.8438719511032104, corresponding to test acc:                         0.8688889145851135 / 0.8688889145851135
after epoch: 10,now: 2024-07-23 03:00:06.491496,epoch time: 0:01:20.574768,used: 0:14:48.774254,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_02_45_17_seed_1_22769264
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.97298175, 'precision': 0.9740733, 'recall': 0.97270167, 'specificity': 0.97270167, 'f1': 0.9729502, 'auroc': 0.99882406, 'binary_precision': 0.95434916, 'binary_recall': 0.99421597, 'binary_specificity': 0.9511873, 'binary_f1_score': 0.97387475}
confusion matrix:
      0     1
0  1442    74
1     9  1547
---- Validation: 
scalar performance:
{'acc': 0.83684623, 'precision': 0.83813274, 'recall': 0.83735275, 'specificity': 0.83735275, 'f1': 0.8367981, 'auroc': 0.9028015, 'binary_precision': 0.8127786, 'binary_recall': 0.86825395, 'binary_specificity': 0.8064516, 'binary_f1_score': 0.83960086}
confusion matrix:
     0    1
0  525  126
1   83  547
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7911111, 'precision': 0.79791385, 'recall': 0.7911111, 'specificity': 0.7911111, 'f1': 0.78991187, 'auroc': 0.88466173, 'binary_precision': 0.7528958, 'binary_recall': 0.8666667, 'binary_specificity': 0.71555555, 'binary_f1_score': 0.8057852}
confusion matrix:
     0    1
0  161   64
1   30  195
early stop counter: 4
val acc:0.8368462324142456, best validation acc: 0.8438719511032104, corresponding to test acc:                         0.8688889145851135 / 0.8688889145851135
after epoch: 11,now: 2024-07-23 03:01:28.158404,epoch time: 0:01:21.666908,used: 0:16:10.441162,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_02_45_17_seed_1_22769264
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.98372394, 'precision': 0.9839251, 'recall': 0.98389065, 'specificity': 0.98389065, 'f1': 0.9837239, 'auroc': 0.99912924, 'binary_precision': 0.99735624, 'binary_recall': 0.97041804, 'binary_specificity': 0.9973632, 'binary_f1_score': 0.9837027}
confusion matrix:
      0     1
0  1513     4
1    46  1509
---- Validation: 
scalar performance:
{'acc': 0.774395, 'precision': 0.8188355, 'recall': 0.77130055, 'specificity': 0.77130055, 'f1': 0.76485664, 'auroc': 0.8868871, 'binary_precision': 0.93384224, 'binary_recall': 0.5825397, 'binary_specificity': 0.96006143, 'binary_f1_score': 0.7174975}
confusion matrix:
     0    1
0  625   26
1  263  367
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8377778, 'precision': 0.85762084, 'recall': 0.8377778, 'specificity': 0.8377778, 'f1': 0.8354958, 'auroc': 0.93104196, 'binary_precision': 0.94186044, 'binary_recall': 0.72, 'binary_specificity': 0.95555556, 'binary_f1_score': 0.8161209}
confusion matrix:
     0    1
0  215   10
1   63  162
early stop counter: 5
val acc:0.7743949890136719, best validation acc: 0.8438719511032104, corresponding to test acc:                         0.8688889145851135 / 0.8688889145851135
after epoch: 12,now: 2024-07-23 03:02:49.763253,epoch time: 0:01:21.604849,used: 0:17:32.046011,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_02_45_17_seed_1_22769264
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.98339844, 'precision': 0.9836527, 'recall': 0.98360455, 'specificity': 0.98360455, 'f1': 0.9833984, 'auroc': 0.9995718, 'binary_precision': 0.9986755, 'binary_recall': 0.9685292, 'binary_specificity': 0.9986799, 'binary_f1_score': 0.9833713}
confusion matrix:
      0     1
0  1513     2
1    49  1508
---- Validation: 
scalar performance:
{'acc': 0.7822014, 'precision': 0.825367, 'recall': 0.7791859, 'specificity': 0.7791859, 'f1': 0.77343345, 'auroc': 0.89399517, 'binary_precision': 0.9398496, 'binary_recall': 0.5952381, 'binary_specificity': 0.96313363, 'binary_f1_score': 0.728863}
confusion matrix:
     0    1
0  627   24
1  255  375
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8111111, 'precision': 0.8477128, 'recall': 0.8111111, 'specificity': 0.8111111, 'f1': 0.80600595, 'auroc': 0.9189531, 'binary_precision': 0.9605263, 'binary_recall': 0.6488889, 'binary_specificity': 0.97333336, 'binary_f1_score': 0.7745358}
confusion matrix:
     0    1
0  219    6
1   79  146
early stop counter: 6
val acc:0.7822014093399048, best validation acc: 0.8438719511032104, corresponding to test acc:                         0.8688889145851135 / 0.8688889145851135
after epoch: 13,now: 2024-07-23 03:04:11.072337,epoch time: 0:01:21.309084,used: 0:18:53.355095,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_02_45_17_seed_1_22769264
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.991862, 'precision': 0.9918574, 'recall': 0.9918647, 'specificity': 0.9918647, 'f1': 0.9918609, 'auroc': 0.99958414, 'binary_precision': 0.99227303, 'binary_recall': 0.9916345, 'binary_specificity': 0.9920949, 'binary_f1_score': 0.9919537}
confusion matrix:
      0     1
0  1506    12
1    13  1541
---- Validation: 
scalar performance:
{'acc': 0.832943, 'precision': 0.843957, 'recall': 0.8314644, 'specificity': 0.8314644, 'f1': 0.83112264, 'auroc': 0.90515935, 'binary_precision': 0.9015444, 'binary_recall': 0.7412698, 'binary_specificity': 0.921659, 'binary_f1_score': 0.81358886}
confusion matrix:
     0    1
0  600   51
1  163  467
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.84, 'precision': 0.8576623, 'recall': 0.84000003, 'specificity': 0.84000003, 'f1': 0.83800006, 'auroc': 0.91608894, 'binary_precision': 0.93714285, 'binary_recall': 0.72888887, 'binary_specificity': 0.95111114, 'binary_f1_score': 0.82}
confusion matrix:
     0    1
0  214   11
1   61  164
early stop counter: 7
val acc:0.8329430222511292, best validation acc: 0.8438719511032104, corresponding to test acc:                         0.8688889145851135 / 0.8688889145851135
after epoch: 14,now: 2024-07-23 03:05:31.290892,epoch time: 0:01:20.218555,used: 0:20:13.573650,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_02_45_17_seed_1_22769264
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9765625, 'precision': 0.97736686, 'recall': 0.97631776, 'specificity': 0.97631776, 'f1': 0.9765396, 'auroc': 0.9993921, 'binary_precision': 0.96089387, 'binary_recall': 0.99421966, 'binary_specificity': 0.95841587, 'binary_f1_score': 0.9772727}
confusion matrix:
      0     1
0  1452    63
1     9  1548
---- Validation: 
scalar performance:
{'acc': 0.8508977, 'precision': 0.8515233, 'recall': 0.85053766, 'specificity': 0.85053766, 'f1': 0.85070527, 'auroc': 0.90986514, 'binary_precision': 0.8628099, 'binary_recall': 0.82857144, 'binary_specificity': 0.8725038, 'binary_f1_score': 0.8453441}
confusion matrix:
     0    1
0  568   83
1  108  522
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.83555555, 'precision': 0.8359803, 'recall': 0.83555555, 'specificity': 0.83555555, 'f1': 0.8355036, 'auroc': 0.8960395, 'binary_precision': 0.84792626, 'binary_recall': 0.81777775, 'binary_specificity': 0.85333335, 'binary_f1_score': 0.83257914}
confusion matrix:
     0    1
0  192   33
1   41  184
better model found
persisted
after epoch: 15,now: 2024-07-23 03:06:52.225260,epoch time: 0:01:20.934368,used: 0:21:34.508018,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_02_45_17_seed_1_22769264
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9866536, 'precision': 0.986793, 'recall': 0.9868006, 'specificity': 0.9868006, 'f1': 0.9866537, 'auroc': 0.99935186, 'binary_precision': 0.9986825, 'binary_recall': 0.9749196, 'binary_specificity': 0.9986816, 'binary_f1_score': 0.98665804}
confusion matrix:
      0     1
0  1515     2
1    39  1516
---- Validation: 
scalar performance:
{'acc': 0.81576896, 'precision': 0.8451035, 'recall': 0.813364, 'specificity': 0.813364, 'f1': 0.8109268, 'auroc': 0.9176115, 'binary_precision': 0.94170403, 'binary_recall': 0.6666667, 'binary_specificity': 0.96006143, 'binary_f1_score': 0.78066915}
confusion matrix:
     0    1
0  625   26
1  210  420
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7977778, 'precision': 0.85012543, 'recall': 0.7977778, 'specificity': 0.7977778, 'f1': 0.7899257, 'auroc': 0.9437432, 'binary_precision': 0.98550725, 'binary_recall': 0.60444444, 'binary_specificity': 0.9911111, 'binary_f1_score': 0.7493113}
confusion matrix:
     0    1
0  223    2
1   89  136
early stop counter: 1
val acc:0.8157689571380615, best validation acc: 0.8508977293968201, corresponding to test acc:                         0.8355555534362793 / 0.8688889145851135
after epoch: 16,now: 2024-07-23 03:08:12.857547,epoch time: 0:01:20.632287,used: 0:22:55.140305,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_02_45_17_seed_1_22769264
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9938151, 'precision': 0.99381804, 'recall': 0.9938108, 'specificity': 0.9938108, 'f1': 0.99381435, 'auroc': 0.99974656, 'binary_precision': 0.993565, 'binary_recall': 0.99420476, 'binary_specificity': 0.9934167, 'binary_f1_score': 0.9938848}
confusion matrix:
      0     1
0  1509    10
1     9  1544
---- Validation: 
scalar performance:
{'acc': 0.8610461, 'precision': 0.8669187, 'recall': 0.86001027, 'specificity': 0.86001027, 'f1': 0.86021113, 'auroc': 0.9164411, 'binary_precision': 0.9094203, 'binary_recall': 0.7968254, 'binary_specificity': 0.92319506, 'binary_f1_score': 0.8494078}
confusion matrix:
     0    1
0  601   50
1  128  502
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8577778, 'precision': 0.8634056, 'recall': 0.8577778, 'specificity': 0.8577778, 'f1': 0.85722494, 'auroc': 0.92337775, 'binary_precision': 0.9086294, 'binary_recall': 0.79555553, 'binary_specificity': 0.92, 'binary_f1_score': 0.84834117}
confusion matrix:
     0    1
0  207   18
1   46  179
better model found
persisted
after epoch: 17,now: 2024-07-23 03:09:33.694858,epoch time: 0:01:20.837311,used: 0:24:15.977616,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_02_45_17_seed_1_22769264
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.99283856, 'precision': 0.9928309, 'recall': 0.9929136, 'specificity': 0.9929136, 'f1': 0.99283814, 'auroc': 0.9997033, 'binary_precision': 0.9986996, 'binary_recall': 0.98714656, 'binary_specificity': 0.9986807, 'binary_f1_score': 0.99288946}
confusion matrix:
      0     1
0  1514     2
1    20  1536
---- Validation: 
scalar performance:
{'acc': 0.8227947, 'precision': 0.8484527, 'recall': 0.8205581, 'specificity': 0.8205581, 'f1': 0.81872225, 'auroc': 0.90654486, 'binary_precision': 0.9389978, 'binary_recall': 0.684127, 'binary_specificity': 0.9569892, 'binary_f1_score': 0.7915518}
confusion matrix:
     0    1
0  623   28
1  199  431
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8288889, 'precision': 0.85144377, 'recall': 0.8288889, 'specificity': 0.8288889, 'f1': 0.82609874, 'auroc': 0.91085434, 'binary_precision': 0.9404762, 'binary_recall': 0.7022222, 'binary_specificity': 0.95555556, 'binary_f1_score': 0.80407125}
confusion matrix:
     0    1
0  215   10
1   67  158
early stop counter: 1
val acc:0.8227946758270264, best validation acc: 0.8610460758209229, corresponding to test acc:                         0.8577777743339539 / 0.8688889145851135
after epoch: 18,now: 2024-07-23 03:10:53.782777,epoch time: 0:01:20.087919,used: 0:25:36.065535,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_02_45_17_seed_1_22769264
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9847005, 'precision': 0.9848683, 'recall': 0.9846136, 'specificity': 0.9846136, 'f1': 0.98469484, 'auroc': 0.99939585, 'binary_precision': 0.9784264, 'binary_recall': 0.99163985, 'binary_specificity': 0.97758734, 'binary_f1_score': 0.9849888}
confusion matrix:
      0     1
0  1483    34
1    13  1542
---- Validation: 
scalar performance:
{'acc': 0.8696331, 'precision': 0.8703164, 'recall': 0.8692781, 'specificity': 0.8692781, 'f1': 0.86946476, 'auroc': 0.9228269, 'binary_precision': 0.88264465, 'binary_recall': 0.84761906, 'binary_specificity': 0.89093703, 'binary_f1_score': 0.8647773}
confusion matrix:
     0    1
0  580   71
1   96  534
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.84444445, 'precision': 0.845427, 'recall': 0.8444444, 'specificity': 0.8444444, 'f1': 0.8443337, 'auroc': 0.9157926, 'binary_precision': 0.86384976, 'binary_recall': 0.81777775, 'binary_specificity': 0.8711111, 'binary_f1_score': 0.8401826}
confusion matrix:
     0    1
0  196   29
1   41  184
better model found
persisted
after epoch: 19,now: 2024-07-23 03:12:14.357872,epoch time: 0:01:20.575095,used: 0:26:56.640630,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_02_45_17_seed_1_22769264
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.99348956, 'precision': 0.9934681, 'recall': 0.99353087, 'specificity': 0.99353087, 'f1': 0.99348897, 'auroc': 0.99980545, 'binary_precision': 0.99676585, 'binary_recall': 0.9903599, 'binary_specificity': 0.99670184, 'binary_f1_score': 0.99355257}
confusion matrix:
      0     1
0  1511     5
1    15  1541
---- Validation: 
scalar performance:
{'acc': 0.8321624, 'precision': 0.8487711, 'recall': 0.8303635, 'specificity': 0.8303635, 'f1': 0.8295696, 'auroc': 0.92287564, 'binary_precision': 0.9208925, 'binary_recall': 0.72063494, 'binary_specificity': 0.94009215, 'binary_f1_score': 0.8085485}
confusion matrix:
     0    1
0  612   39
1  176  454
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.81333333, 'precision': 0.83732057, 'recall': 0.81333333, 'specificity': 0.81333333, 'f1': 0.80995476, 'auroc': 0.9122568, 'binary_precision': 0.92727274, 'binary_recall': 0.68, 'binary_specificity': 0.94666666, 'binary_f1_score': 0.78461546}
confusion matrix:
     0    1
0  213   12
1   72  153
early stop counter: 1
val acc:0.8321623802185059, best validation acc: 0.8696330785751343, corresponding to test acc:                         0.8444444537162781 / 0.8688889145851135
after epoch: 20,now: 2024-07-23 03:13:34.162777,epoch time: 0:01:19.804905,used: 0:28:16.445535,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_02_45_17_seed_1_22769264
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.991862, 'precision': 0.99185115, 'recall': 0.99193263, 'specificity': 0.99193263, 'f1': 0.99186146, 'auroc': 0.9995553, 'binary_precision': 0.99740094, 'binary_recall': 0.98650384, 'binary_specificity': 0.9973615, 'binary_f1_score': 0.99192244}
confusion matrix:
      0     1
0  1512     4
1    21  1535
---- Validation: 
scalar performance:
{'acc': 0.85714287, 'precision': 0.86119545, 'recall': 0.8562724, 'specificity': 0.8562724, 'f1': 0.85649616, 'auroc': 0.9168581, 'binary_precision': 0.8955752, 'binary_recall': 0.8031746, 'binary_specificity': 0.9093702, 'binary_f1_score': 0.846862}
confusion matrix:
     0    1
0  592   59
1  124  506
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.85333335, 'precision': 0.8660895, 'recall': 0.85333335, 'specificity': 0.85333335, 'f1': 0.85204446, 'auroc': 0.92355555, 'binary_precision': 0.93442625, 'binary_recall': 0.76, 'binary_specificity': 0.94666666, 'binary_f1_score': 0.83823526}
confusion matrix:
     0    1
0  213   12
1   54  171
early stop counter: 2
val acc:0.8571428656578064, best validation acc: 0.8696330785751343, corresponding to test acc:                         0.8444444537162781 / 0.8688889145851135
after epoch: 21,now: 2024-07-23 03:14:53.599041,epoch time: 0:01:19.436264,used: 0:29:35.881799,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_02_45_17_seed_1_22769264
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.99121094, 'precision': 0.9912457, 'recall': 0.99118304, 'specificity': 0.99118304, 'f1': 0.99120915, 'auroc': 0.9997465, 'binary_precision': 0.9891095, 'binary_recall': 0.993565, 'binary_specificity': 0.98880106, 'binary_f1_score': 0.99133223}
confusion matrix:
      0     1
0  1501    17
1    10  1544
---- Validation: 
scalar performance:
{'acc': 0.84777516, 'precision': 0.8544326, 'recall': 0.8466462, 'specificity': 0.8466462, 'f1': 0.8467257, 'auroc': 0.9156487, 'binary_precision': 0.89908254, 'binary_recall': 0.7777778, 'binary_specificity': 0.9155146, 'binary_f1_score': 0.8340426}
confusion matrix:
     0    1
0  596   55
1  140  490
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.82, 'precision': 0.8279352, 'recall': 0.82000005, 'specificity': 0.82000005, 'f1': 0.8189045, 'auroc': 0.8941827, 'binary_precision': 0.8789474, 'binary_recall': 0.74222225, 'binary_specificity': 0.8977778, 'binary_f1_score': 0.80481935}
confusion matrix:
     0    1
0  202   23
1   58  167
early stop counter: 3
val acc:0.8477751612663269, best validation acc: 0.8696330785751343, corresponding to test acc:                         0.8444444537162781 / 0.8688889145851135
after epoch: 22,now: 2024-07-23 03:16:13.442721,epoch time: 0:01:19.843680,used: 0:30:55.725479,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_02_45_17_seed_1_22769264
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.9873047, 'precision': 0.9874598, 'recall': 0.9874679, 'specificity': 0.9874679, 'f1': 0.9873047, 'auroc': 0.9995981, 'binary_precision': 1.0, 'binary_recall': 0.9749357, 'binary_specificity': 1.0, 'binary_f1_score': 0.9873088}
confusion matrix:
      0     1
0  1516     0
1    39  1517
---- Validation: 
scalar performance:
{'acc': 0.6229508, 'precision': 0.7603617, 'recall': 0.6168971, 'specificity': 0.6168971, 'f1': 0.55955404, 'auroc': 0.9093733, 'binary_precision': 0.94545454, 'binary_recall': 0.24761905, 'binary_specificity': 0.9861751, 'binary_f1_score': 0.3924528}
confusion matrix:
     0    1
0  642    9
1  474  156
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.63555557, 'precision': 0.7742258, 'recall': 0.63555557, 'specificity': 0.63555557, 'f1': 0.5828152, 'auroc': 0.91942716, 'binary_precision': 0.9692308, 'binary_recall': 0.28, 'binary_specificity': 0.9911111, 'binary_f1_score': 0.43448278}
confusion matrix:
     0   1
0  223   2
1  162  63
early stop counter: 4
val acc:0.6229507923126221, best validation acc: 0.8696330785751343, corresponding to test acc:                         0.8444444537162781 / 0.8688889145851135
after epoch: 23,now: 2024-07-23 03:17:33.426028,epoch time: 0:01:19.983307,used: 0:32:15.708786,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_02_45_17_seed_1_22769264
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.97591144, 'precision': 0.9771045, 'recall': 0.9756191, 'specificity': 0.9756191, 'f1': 0.9758817, 'auroc': 0.99946755, 'binary_precision': 0.95628077, 'binary_recall': 0.99807197, 'binary_specificity': 0.95316625, 'binary_f1_score': 0.9767295}
confusion matrix:
      0     1
0  1445    71
1     3  1553
---- Validation: 
scalar performance:
{'acc': 0.87431693, 'precision': 0.87811387, 'recall': 0.87350225, 'specificity': 0.87350225, 'f1': 0.8737998, 'auroc': 0.92830324, 'binary_precision': 0.91212654, 'binary_recall': 0.8238095, 'binary_specificity': 0.92319506, 'binary_f1_score': 0.86572146}
confusion matrix:
     0    1
0  601   50
1  111  519
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8977778, 'precision': 0.9023557, 'recall': 0.8977778, 'specificity': 0.8977778, 'f1': 0.8974862, 'auroc': 0.948642, 'binary_precision': 0.94527364, 'binary_recall': 0.84444445, 'binary_specificity': 0.95111114, 'binary_f1_score': 0.89201874}
confusion matrix:
     0    1
0  214   11
1   35  190
new oracle model saved
better model found
persisted
after epoch: 24,now: 2024-07-23 03:18:53.939385,epoch time: 0:01:20.513357,used: 0:33:36.222143,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_02_45_17_seed_1_22769264
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.9938151, 'precision': 0.9938283, 'recall': 0.99380136, 'specificity': 0.99380136, 'f1': 0.99381393, 'auroc': 0.99989235, 'binary_precision': 0.9929442, 'binary_recall': 0.9948586, 'binary_specificity': 0.9927441, 'binary_f1_score': 0.99390054}
confusion matrix:
      0     1
0  1505    11
1     8  1548
---- Validation: 
scalar performance:
{'acc': 0.79547226, 'precision': 0.8161999, 'recall': 0.79334354, 'specificity': 0.79334354, 'f1': 0.7912113, 'auroc': 0.8997611, 'binary_precision': 0.89316237, 'binary_recall': 0.6634921, 'binary_specificity': 0.92319506, 'binary_f1_score': 0.76138437}
confusion matrix:
     0    1
0  601   50
1  212  418
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8511111, 'precision': 0.85704243, 'recall': 0.8511111, 'specificity': 0.8511111, 'f1': 0.8504901, 'auroc': 0.9107951, 'binary_precision': 0.9030612, 'binary_recall': 0.7866667, 'binary_specificity': 0.91555554, 'binary_f1_score': 0.84085506}
confusion matrix:
     0    1
0  206   19
1   48  177
early stop counter: 1
val acc:0.795472264289856, best validation acc: 0.874316930770874, corresponding to test acc:                         0.897777795791626 / 0.897777795791626
after epoch: 25,now: 2024-07-23 03:20:15.259681,epoch time: 0:01:21.320296,used: 0:34:57.542439,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_02_45_17_seed_1_22769264
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9938151, 'precision': 0.9937939, 'recall': 0.9938607, 'specificity': 0.9938607, 'f1': 0.9938145, 'auroc': 0.9998423, 'binary_precision': 0.997411, 'binary_recall': 0.9903599, 'binary_specificity': 0.9973615, 'binary_f1_score': 0.99387294}
confusion matrix:
      0     1
0  1512     4
1    15  1541
---- Validation: 
scalar performance:
{'acc': 0.80093676, 'precision': 0.8418953, 'recall': 0.79807985, 'specificity': 0.79807985, 'f1': 0.7936952, 'auroc': 0.9292438, 'binary_precision': 0.95620435, 'binary_recall': 0.6238095, 'binary_specificity': 0.97235024, 'binary_f1_score': 0.7550432}
confusion matrix:
     0    1
0  633   18
1  237  393
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.82666665, 'precision': 0.86167306, 'recall': 0.82666665, 'specificity': 0.82666665, 'f1': 0.8223684, 'auroc': 0.9355654, 'binary_precision': 0.9741936, 'binary_recall': 0.6711111, 'binary_specificity': 0.9822222, 'binary_f1_score': 0.79473686}
confusion matrix:
     0    1
0  221    4
1   74  151
early stop counter: 2
val acc:0.800936758518219, best validation acc: 0.874316930770874, corresponding to test acc:                         0.897777795791626 / 0.897777795791626
after epoch: 26,now: 2024-07-23 03:21:36.341650,epoch time: 0:01:21.081969,used: 0:36:18.624408,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_02_45_17_seed_1_22769264
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.99283856, 'precision': 0.9928385, 'recall': 0.99292207, 'specificity': 0.99292207, 'f1': 0.99283826, 'auroc': 0.99995553, 'binary_precision': 0.99934894, 'binary_recall': 0.98650384, 'binary_specificity': 0.99934036, 'binary_f1_score': 0.9928849}
confusion matrix:
      0     1
0  1515     1
1    21  1535
---- Validation: 
scalar performance:
{'acc': 0.69086653, 'precision': 0.7812155, 'recall': 0.6861495, 'specificity': 0.6861495, 'f1': 0.66051966, 'auroc': 0.9144424, 'binary_precision': 0.9365672, 'binary_recall': 0.3984127, 'binary_specificity': 0.9738863, 'binary_f1_score': 0.55902004}
confusion matrix:
     0    1
0  634   17
1  379  251
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.72, 'precision': 0.7996448, 'recall': 0.72, 'specificity': 0.72, 'f1': 0.7000698, 'auroc': 0.9141729, 'binary_precision': 0.95412844, 'binary_recall': 0.46222222, 'binary_specificity': 0.9777778, 'binary_f1_score': 0.6227545}
confusion matrix:
     0    1
0  220    5
1  121  104
early stop counter: 3
val acc:0.6908665299415588, best validation acc: 0.874316930770874, corresponding to test acc:                         0.897777795791626 / 0.897777795791626
after epoch: 27,now: 2024-07-23 03:22:57.904318,epoch time: 0:01:21.562668,used: 0:37:40.187076,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_02_45_17_seed_1_22769264
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.99088544, 'precision': 0.9909057, 'recall': 0.99098563, 'specificity': 0.99098563, 'f1': 0.99088514, 'auroc': 0.9997155, 'binary_precision': 0.99869454, 'binary_recall': 0.9832905, 'binary_specificity': 0.9986807, 'binary_f1_score': 0.99093264}
confusion matrix:
      0     1
0  1514     2
1    26  1530
---- Validation: 
scalar performance:
{'acc': 0.78688526, 'precision': 0.83728695, 'recall': 0.78369176, 'specificity': 0.78369176, 'f1': 0.77728194, 'auroc': 0.92989784, 'binary_precision': 0.96363634, 'binary_recall': 0.5888889, 'binary_specificity': 0.97849464, 'binary_f1_score': 0.73103446}
confusion matrix:
     0    1
0  637   14
1  259  371
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.73777777, 'precision': 0.8089628, 'recall': 0.73777777, 'specificity': 0.73777777, 'f1': 0.7217506, 'auroc': 0.92383206, 'binary_precision': 0.95726496, 'binary_recall': 0.4977778, 'binary_specificity': 0.9777778, 'binary_f1_score': 0.6549708}
confusion matrix:
     0    1
0  220    5
1  113  112
early stop counter: 4
val acc:0.7868852615356445, best validation acc: 0.874316930770874, corresponding to test acc:                         0.897777795791626 / 0.897777795791626
after epoch: 28,now: 2024-07-23 03:24:19.137488,epoch time: 0:01:21.233170,used: 0:39:01.420246,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_02_45_17_seed_1_22769264
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.992513, 'precision': 0.9926145, 'recall': 0.99245477, 'specificity': 0.99245477, 'f1': 0.992511, 'auroc': 0.999841, 'binary_precision': 0.98789036, 'binary_recall': 0.997426, 'binary_specificity': 0.9874835, 'binary_f1_score': 0.9926353}
confusion matrix:
      0     1
0  1499    19
1     4  1550
---- Validation: 
scalar performance:
{'acc': 0.84074944, 'precision': 0.86025465, 'recall': 0.8388377, 'specificity': 0.8388377, 'f1': 0.83799607, 'auroc': 0.9309097, 'binary_precision': 0.94008267, 'binary_recall': 0.7222222, 'binary_specificity': 0.95545316, 'binary_f1_score': 0.8168761}
confusion matrix:
     0    1
0  622   29
1  175  455
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.84444445, 'precision': 0.8515554, 'recall': 0.8444444, 'specificity': 0.8444444, 'f1': 0.8436538, 'auroc': 0.90931356, 'binary_precision': 0.9015544, 'binary_recall': 0.7733333, 'binary_specificity': 0.91555554, 'binary_f1_score': 0.83253586}
confusion matrix:
     0    1
0  206   19
1   51  174
early stop counter: 5
val acc:0.8407494425773621, best validation acc: 0.874316930770874, corresponding to test acc:                         0.897777795791626 / 0.897777795791626
after epoch: 29,now: 2024-07-23 03:25:40.678045,epoch time: 0:01:21.540557,used: 0:40:22.960803,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_02_45_17_seed_1_22769264
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.992513, 'precision': 0.9925622, 'recall': 0.99247766, 'specificity': 0.99247766, 'f1': 0.9925114, 'auroc': 0.9998466, 'binary_precision': 0.98976326, 'binary_recall': 0.9954955, 'binary_specificity': 0.9894598, 'binary_f1_score': 0.9926211}
confusion matrix:
      0     1
0  1502    16
1     7  1547
---- Validation: 
scalar performance:
{'acc': 0.8563622, 'precision': 0.8719832, 'recall': 0.85468507, 'specificity': 0.85468507, 'f1': 0.85439223, 'auroc': 0.9235005, 'binary_precision': 0.9442231, 'binary_recall': 0.75238097, 'binary_specificity': 0.9569892, 'binary_f1_score': 0.83745587}
confusion matrix:
     0    1
0  623   28
1  156  474
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8377778, 'precision': 0.86271846, 'recall': 0.83777773, 'specificity': 0.83777773, 'f1': 0.8349404, 'auroc': 0.9285333, 'binary_precision': 0.9578313, 'binary_recall': 0.70666665, 'binary_specificity': 0.9688889, 'binary_f1_score': 0.8132992}
confusion matrix:
     0    1
0  218    7
1   66  159
early stop counter: 6
val acc:0.8563622236251831, best validation acc: 0.874316930770874, corresponding to test acc:                         0.897777795791626 / 0.897777795791626
after epoch: 30,now: 2024-07-23 03:26:59.789511,epoch time: 0:01:19.111466,used: 0:41:42.072269,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_02_45_17_seed_1_22769264
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 0:41:42.072269 at 2024-07-23 03:26:59.789511
persisted model performance metric: 

scalar performance:
{'acc': 0.8977778, 'precision': 0.9023557, 'recall': 0.8977778, 'specificity': 0.8977778, 'f1': 0.8974862, 'auroc': 0.948642, 'binary_precision': 0.94527364, 'binary_recall': 0.84444445, 'binary_specificity': 0.95111114, 'binary_f1_score': 0.89201874}
confusion matrix:
     0    1
0  214   11
1   35  190
oracle model performance metric: 

scalar performance:
{'acc': 0.8977778, 'precision': 0.9023557, 'recall': 0.8977778, 'specificity': 0.8977778, 'f1': 0.8974862, 'auroc': 0.948642, 'binary_precision': 0.94527364, 'binary_recall': 0.84444445, 'binary_specificity': 0.95111114, 'binary_f1_score': 0.89201874}
confusion matrix:
     0    1
0  214   11
1   35  190
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_dial_lr1e5_bs16_allfreeze_2024-07-22_23-46-53/rule_results/3.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_dial_lr1e5_bs16_allfreeze_2024-07-22_23-46-53/confusion_matrix/3.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 453153 KiB |  26075 MiB | 145141 GiB | 145141 GiB |
|       from large pool | 412597 KiB |  26030 MiB | 144234 GiB | 144234 GiB |
|       from small pool |  40556 KiB |     60 MiB |    906 GiB |    906 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 453153 KiB |  26075 MiB | 145141 GiB | 145141 GiB |
|       from large pool | 412597 KiB |  26030 MiB | 144234 GiB | 144234 GiB |
|       from small pool |  40556 KiB |     60 MiB |    906 GiB |    906 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 447481 KiB |  26071 MiB | 145115 GiB | 145115 GiB |
|       from large pool | 407075 KiB |  26026 MiB | 144210 GiB | 144210 GiB |
|       from small pool |  40406 KiB |     60 MiB |    905 GiB |    905 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  27768 MiB |  27768 MiB |  54304 MiB |  26536 MiB |
|       from large pool |  27696 MiB |  27696 MiB |  54218 MiB |  26522 MiB |
|       from small pool |     72 MiB |     72 MiB |     86 MiB |     14 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 738782 KiB |   1678 MiB |  64539 GiB |  64538 GiB |
|       from large pool | 721995 KiB |   1668 MiB |  63626 GiB |  63625 GiB |
|       from small pool |  16787 KiB |     29 MiB |    913 GiB |    913 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    1226    |    2570    |   13122 K  |   13121 K  |
|       from large pool |     187    |    1413    |    6645 K  |    6645 K  |
|       from small pool |    1039    |    1335    |    6476 K  |    6475 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    1226    |    2570    |   13122 K  |   13121 K  |
|       from large pool |     187    |    1413    |    6645 K  |    6645 K  |
|       from small pool |    1039    |    1335    |    6476 K  |    6475 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     835    |     835    |    1603    |     768    |
|       from large pool |     799    |     800    |    1560    |     761    |
|       from small pool |      36    |      36    |      43    |       7    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     106    |     852    |    9568 K  |    9568 K  |
|       from large pool |      40    |     801    |    5873 K  |    5873 K  |
|       from small pool |      66    |     146    |    3695 K  |    3694 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  26075 MiB | 145141 GiB | 145141 GiB |
|       from large pool |  16640 KiB |  26030 MiB | 144234 GiB | 144234 GiB |
|       from small pool |      0 KiB |     60 MiB |    906 GiB |    906 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  26075 MiB | 145141 GiB | 145141 GiB |
|       from large pool |  16640 KiB |  26030 MiB | 144234 GiB | 144234 GiB |
|       from small pool |      0 KiB |     60 MiB |    906 GiB |    906 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  26071 MiB | 145115 GiB | 145115 GiB |
|       from large pool |  16640 KiB |  26026 MiB | 144210 GiB | 144210 GiB |
|       from small pool |      0 KiB |     60 MiB |    905 GiB |    905 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1164 MiB |  27768 MiB |  54304 MiB |  53140 MiB |
|       from large pool |   1108 MiB |  27696 MiB |  54218 MiB |  53110 MiB |
|       from small pool |     56 MiB |     72 MiB |     86 MiB |     30 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |   3840 KiB |   1678 MiB |  64539 GiB |  64539 GiB |
|       from large pool |   3840 KiB |   1668 MiB |  63626 GiB |  63626 GiB |
|       from small pool |      0 KiB |     34 MiB |    913 GiB |    913 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    2570    |   13122 K  |   13122 K  |
|       from large pool |       2    |    1413    |    6645 K  |    6645 K  |
|       from small pool |       0    |    1335    |    6476 K  |    6476 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    2570    |   13122 K  |   13122 K  |
|       from large pool |       2    |    1413    |    6645 K  |    6645 K  |
|       from small pool |       0    |    1335    |    6476 K  |    6476 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      69    |     835    |    1603    |    1534    |
|       from large pool |      41    |     800    |    1560    |    1519    |
|       from small pool |      28    |      36    |      43    |      15    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       1    |     852    |    9568 K  |    9568 K  |
|       from large pool |       1    |     801    |    5873 K  |    5873 K  |
|       from small pool |       0    |     146    |    3695 K  |    3695 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  26075 MiB | 145141 GiB | 145141 GiB |
|       from large pool |  16640 KiB |  26030 MiB | 144234 GiB | 144234 GiB |
|       from small pool |      0 KiB |     60 MiB |    906 GiB |    906 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  26075 MiB | 145141 GiB | 145141 GiB |
|       from large pool |  16640 KiB |  26030 MiB | 144234 GiB | 144234 GiB |
|       from small pool |      0 KiB |     60 MiB |    906 GiB |    906 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  26071 MiB | 145115 GiB | 145115 GiB |
|       from large pool |  16640 KiB |  26026 MiB | 144210 GiB | 144210 GiB |
|       from small pool |      0 KiB |     60 MiB |    905 GiB |    905 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1164 MiB |  27768 MiB |  54304 MiB |  53140 MiB |
|       from large pool |   1108 MiB |  27696 MiB |  54218 MiB |  53110 MiB |
|       from small pool |     56 MiB |     72 MiB |     86 MiB |     30 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |   3840 KiB |   1678 MiB |  64539 GiB |  64539 GiB |
|       from large pool |   3840 KiB |   1668 MiB |  63626 GiB |  63626 GiB |
|       from small pool |      0 KiB |     34 MiB |    913 GiB |    913 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    2570    |   13122 K  |   13122 K  |
|       from large pool |       2    |    1413    |    6645 K  |    6645 K  |
|       from small pool |       0    |    1335    |    6476 K  |    6476 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    2570    |   13122 K  |   13122 K  |
|       from large pool |       2    |    1413    |    6645 K  |    6645 K  |
|       from small pool |       0    |    1335    |    6476 K  |    6476 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      69    |     835    |    1603    |    1534    |
|       from large pool |      41    |     800    |    1560    |    1519    |
|       from small pool |      28    |      36    |      43    |      15    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       1    |     852    |    9568 K  |    9568 K  |
|       from large pool |       1    |     801    |    5873 K  |    5873 K  |
|       from small pool |       0    |     146    |    3695 K  |    3695 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'888c1ef2'
model name: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_03_28_17_seed_2_22769264

 Experiment start at: 2024-07-23 03:28:17.325926
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
before training, model accuracy: 0.41203704476356506
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9305921, 'precision': 0.93284714, 'recall': 0.93088645, 'specificity': 0.93088645, 'f1': 0.93052983, 'auroc': 0.9761394, 'binary_precision': 0.9661256, 'binary_recall': 0.89360315, 'binary_specificity': 0.96816975, 'binary_f1_score': 0.9284503}
confusion matrix:
      0     1
0  1460    48
1   163  1369
---- Validation: 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
scalar performance:
{'acc': 0.79264474, 'precision': 0.79299784, 'recall': 0.793102, 'specificity': 0.793102, 'f1': 0.7926415, 'auroc': 0.8802055, 'binary_precision': 0.7741935, 'binary_recall': 0.8102894, 'binary_specificity': 0.7759146, 'binary_f1_score': 0.7918303}
confusion matrix:
     0    1
0  509  147
1  118  504
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7939815, 'precision': 0.8010073, 'recall': 0.7939815, 'specificity': 0.7939815, 'f1': 0.7927722, 'auroc': 0.8965835, 'binary_precision': 0.7550201, 'binary_recall': 0.8703704, 'binary_specificity': 0.7175926, 'binary_f1_score': 0.8086021}
confusion matrix:
     0    1
0  155   61
1   28  188
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-23 03:29:36.731007,epoch time: 0:01:19.405081,used: 0:01:19.405081,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_03_28_17_seed_2_22769264
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.94177634, 'precision': 0.9457272, 'recall': 0.94219124, 'specificity': 0.94219124, 'f1': 0.9416808, 'auroc': 0.9892504, 'binary_precision': 0.9898844, 'binary_recall': 0.8936725, 'binary_specificity': 0.99071, 'binary_f1_score': 0.9393212}
confusion matrix:
      0     1
0  1493    14
1   163  1370
---- Validation: 
scalar performance:
{'acc': 0.8302034, 'precision': 0.8433442, 'recall': 0.8275626, 'specificity': 0.8275626, 'f1': 0.82766855, 'auroc': 0.9047011, 'binary_precision': 0.9041916, 'binary_recall': 0.7282958, 'binary_specificity': 0.9268293, 'binary_f1_score': 0.8067676}
confusion matrix:
     0    1
0  608   48
1  169  453
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8634259, 'precision': 0.86380804, 'recall': 0.8634259, 'specificity': 0.8634259, 'f1': 0.8633901, 'auroc': 0.9224537, 'binary_precision': 0.8755981, 'binary_recall': 0.8472222, 'binary_specificity': 0.8796296, 'binary_f1_score': 0.86117643}
confusion matrix:
     0    1
0  190   26
1   33  183
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-07-23 03:30:54.153880,epoch time: 0:01:17.422873,used: 0:02:36.827954,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_03_28_17_seed_2_22769264
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9625, 'precision': 0.96301544, 'recall': 0.9623885, 'specificity': 0.9623885, 'f1': 0.96248126, 'auroc': 0.99488723, 'binary_precision': 0.9492708, 'binary_recall': 0.97779226, 'binary_specificity': 0.94698477, 'binary_f1_score': 0.9633205}
confusion matrix:
      0     1
0  1429    80
1    34  1497
---- Validation: 
scalar performance:
{'acc': 0.7668232, 'precision': 0.7731596, 'recall': 0.76874113, 'specificity': 0.76874113, 'f1': 0.7661996, 'auroc': 0.86664283, 'binary_precision': 0.72437674, 'binary_recall': 0.840836, 'binary_specificity': 0.69664633, 'binary_f1_score': 0.7782738}
confusion matrix:
     0    1
0  457  199
1   99  523
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7361111, 'precision': 0.78571427, 'recall': 0.7361111, 'specificity': 0.7361111, 'f1': 0.7241379, 'auroc': 0.92494, 'binary_precision': 0.6666667, 'binary_recall': 0.9444444, 'binary_specificity': 0.5277778, 'binary_f1_score': 0.7816091}
confusion matrix:
     0    1
0  114  102
1   12  204
early stop counter: 1
val acc:0.7668231725692749, best validation acc: 0.8302034139633179, corresponding to test acc:                         0.8634259104728699 / 0.8634259104728699
after epoch: 3,now: 2024-07-23 03:32:11.996108,epoch time: 0:01:17.842228,used: 0:03:54.670182,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_03_28_17_seed_2_22769264
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.97598684, 'precision': 0.9763812, 'recall': 0.9761393, 'specificity': 0.9761393, 'f1': 0.9759855, 'auroc': 0.99680936, 'binary_precision': 0.9925826, 'binary_recall': 0.9595828, 'binary_specificity': 0.99269587, 'binary_f1_score': 0.97580385}
confusion matrix:
      0     1
0  1495    11
1    62  1472
---- Validation: 
scalar performance:
{'acc': 0.80359936, 'precision': 0.80760133, 'recall': 0.8019812, 'specificity': 0.8019812, 'f1': 0.80226463, 'auroc': 0.887303, 'binary_precision': 0.8366606, 'binary_recall': 0.74115753, 'binary_specificity': 0.8628049, 'binary_f1_score': 0.7860188}
confusion matrix:
     0    1
0  566   90
1  161  461
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8101852, 'precision': 0.81548655, 'recall': 0.8101852, 'specificity': 0.8101852, 'f1': 0.80938447, 'auroc': 0.91737396, 'binary_precision': 0.77459013, 'binary_recall': 0.875, 'binary_specificity': 0.7453704, 'binary_f1_score': 0.82173914}
confusion matrix:
     0    1
0  161   55
1   27  189
early stop counter: 2
val acc:0.8035993576049805, best validation acc: 0.8302034139633179, corresponding to test acc:                         0.8634259104728699 / 0.8634259104728699
after epoch: 4,now: 2024-07-23 03:33:29.962735,epoch time: 0:01:17.966627,used: 0:05:12.636809,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_03_28_17_seed_2_22769264
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9753289, 'precision': 0.9758286, 'recall': 0.97551155, 'specificity': 0.97551155, 'f1': 0.975327, 'auroc': 0.99758846, 'binary_precision': 0.9939107, 'binary_recall': 0.95700324, 'binary_specificity': 0.9940199, 'binary_f1_score': 0.97510785}
confusion matrix:
      0     1
0  1496     9
1    66  1469
---- Validation: 
scalar performance:
{'acc': 0.6744914, 'precision': 0.75562, 'recall': 0.6667614, 'specificity': 0.6667614, 'f1': 0.64030397, 'auroc': 0.85308754, 'binary_precision': 0.89312977, 'binary_recall': 0.3762058, 'binary_specificity': 0.95731705, 'binary_f1_score': 0.5294118}
confusion matrix:
     0    1
0  628   28
1  388  234
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8240741, 'precision': 0.8323077, 'recall': 0.8240741, 'specificity': 0.8240741, 'f1': 0.82297754, 'auroc': 0.89737654, 'binary_precision': 0.88461536, 'binary_recall': 0.7453704, 'binary_specificity': 0.9027778, 'binary_f1_score': 0.8090452}
confusion matrix:
     0    1
0  195   21
1   55  161
early stop counter: 3
val acc:0.6744914054870605, best validation acc: 0.8302034139633179, corresponding to test acc:                         0.8634259104728699 / 0.8634259104728699
after epoch: 5,now: 2024-07-23 03:34:47.814932,epoch time: 0:01:17.852197,used: 0:06:30.489006,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_03_28_17_seed_2_22769264
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9819079, 'precision': 0.9820924, 'recall': 0.9819828, 'specificity': 0.9819828, 'f1': 0.9819075, 'auroc': 0.99766874, 'binary_precision': 0.99331105, 'binary_recall': 0.9705882, 'binary_specificity': 0.9933775, 'binary_f1_score': 0.9818182}
confusion matrix:
      0     1
0  1500    10
1    45  1485
---- Validation: 
scalar performance:
{'acc': 0.7652582, 'precision': 0.8018469, 'recall': 0.760509, 'specificity': 0.760509, 'f1': 0.7556044, 'auroc': 0.8484874, 'binary_precision': 0.9004975, 'binary_recall': 0.5819936, 'binary_specificity': 0.9390244, 'binary_f1_score': 0.70703125}
confusion matrix:
     0    1
0  616   40
1  260  362
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8472222, 'precision': 0.866881, 'recall': 0.8472222, 'specificity': 0.8472222, 'f1': 0.8451478, 'auroc': 0.906893, 'binary_precision': 0.9518072, 'binary_recall': 0.7314815, 'binary_specificity': 0.962963, 'binary_f1_score': 0.8272251}
confusion matrix:
     0    1
0  208    8
1   58  158
early stop counter: 4
val acc:0.7652581930160522, best validation acc: 0.8302034139633179, corresponding to test acc:                         0.8634259104728699 / 0.8634259104728699
after epoch: 6,now: 2024-07-23 03:36:05.729934,epoch time: 0:01:17.915002,used: 0:07:48.404008,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_03_28_17_seed_2_22769264
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9832237, 'precision': 0.9832237, 'recall': 0.983249, 'specificity': 0.983249, 'f1': 0.98322344, 'auroc': 0.99808943, 'binary_precision': 0.9868421, 'binary_recall': 0.9797518, 'binary_specificity': 0.9867462, 'binary_f1_score': 0.9832842}
confusion matrix:
      0     1
0  1489    20
1    31  1500
---- Validation: 
scalar performance:
{'acc': 0.814554, 'precision': 0.8153341, 'recall': 0.81377685, 'specificity': 0.81377685, 'f1': 0.814073, 'auroc': 0.8745246, 'binary_precision': 0.8257191, 'binary_recall': 0.7845659, 'binary_specificity': 0.8429878, 'binary_f1_score': 0.80461663}
confusion matrix:
     0    1
0  553  103
1  134  488
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8310185, 'precision': 0.8348147, 'recall': 0.83101857, 'specificity': 0.83101857, 'f1': 0.83053815, 'auroc': 0.9233539, 'binary_precision': 0.79916316, 'binary_recall': 0.8842593, 'binary_specificity': 0.7777778, 'binary_f1_score': 0.8395604}
confusion matrix:
     0    1
0  168   48
1   25  191
early stop counter: 5
val acc:0.81455397605896, best validation acc: 0.8302034139633179, corresponding to test acc:                         0.8634259104728699 / 0.8634259104728699
after epoch: 7,now: 2024-07-23 03:37:22.357570,epoch time: 0:01:16.627636,used: 0:09:05.031644,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_03_28_17_seed_2_22769264
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.97302634, 'precision': 0.974136, 'recall': 0.97324944, 'specificity': 0.97324944, 'f1': 0.9730178, 'auroc': 0.9964372, 'binary_precision': 0.99931175, 'binary_recall': 0.94716245, 'binary_specificity': 0.9993364, 'binary_f1_score': 0.97253853}
confusion matrix:
      0     1
0  1506     1
1    81  1452
---- Validation: 
scalar performance:
{'acc': 0.7143975, 'precision': 0.79449856, 'recall': 0.70729995, 'specificity': 0.70729995, 'f1': 0.68903226, 'auroc': 0.8990765, 'binary_precision': 0.9415808, 'binary_recall': 0.44051448, 'binary_specificity': 0.9740854, 'binary_f1_score': 0.6002191}
confusion matrix:
     0    1
0  639   17
1  348  274
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6527778, 'precision': 0.795082, 'recall': 0.6527778, 'specificity': 0.6527778, 'f1': 0.60517657, 'auroc': 0.87472135, 'binary_precision': 1.0, 'binary_recall': 0.30555555, 'binary_specificity': 1.0, 'binary_f1_score': 0.46808508}
confusion matrix:
     0   1
0  216   0
1  150  66
early stop counter: 6
val acc:0.7143974900245667, best validation acc: 0.8302034139633179, corresponding to test acc:                         0.8634259104728699 / 0.8634259104728699
after epoch: 8,now: 2024-07-23 03:38:39.235212,epoch time: 0:01:16.877642,used: 0:10:21.909286,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_03_28_17_seed_2_22769264
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9858553, 'precision': 0.98588777, 'recall': 0.9858998, 'specificity': 0.9858998, 'f1': 0.9858552, 'auroc': 0.99904644, 'binary_precision': 0.99206346, 'binary_recall': 0.9797518, 'binary_specificity': 0.9920477, 'binary_f1_score': 0.98586917}
confusion matrix:
      0     1
0  1497    12
1    31  1500
---- Validation: 
scalar performance:
{'acc': 0.6697966, 'precision': 0.7470863, 'recall': 0.6621049, 'specificity': 0.6621049, 'f1': 0.6355037, 'auroc': 0.8496123, 'binary_precision': 0.8787879, 'binary_recall': 0.37299034, 'binary_specificity': 0.9512195, 'binary_f1_score': 0.52370197}
confusion matrix:
     0    1
0  624   32
1  390  232
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7731481, 'precision': 0.7886131, 'recall': 0.7731482, 'specificity': 0.7731482, 'f1': 0.77006793, 'auroc': 0.8688915, 'binary_precision': 0.85542166, 'binary_recall': 0.6574074, 'binary_specificity': 0.8888889, 'binary_f1_score': 0.74345547}
confusion matrix:
     0    1
0  192   24
1   74  142
early stop counter: 7
val acc:0.6697965860366821, best validation acc: 0.8302034139633179, corresponding to test acc:                         0.8634259104728699 / 0.8634259104728699
after epoch: 9,now: 2024-07-23 03:39:55.907777,epoch time: 0:01:16.672565,used: 0:11:38.581851,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_03_28_17_seed_2_22769264
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.98421055, 'precision': 0.98424244, 'recall': 0.9841888, 'specificity': 0.9841888, 'f1': 0.9842088, 'auroc': 0.99894595, 'binary_precision': 0.9818182, 'binary_recall': 0.98694515, 'binary_specificity': 0.9814324, 'binary_f1_score': 0.984375}
confusion matrix:
      0     1
0  1480    28
1    20  1512
---- Validation: 
scalar performance:
{'acc': 0.7214398, 'precision': 0.76642156, 'recall': 0.71578455, 'specificity': 0.71578455, 'f1': 0.7056496, 'auroc': 0.8708459, 'binary_precision': 0.86944443, 'binary_recall': 0.50321543, 'binary_specificity': 0.92835367, 'binary_f1_score': 0.6374745}
confusion matrix:
     0    1
0  609   47
1  309  313
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.849537, 'precision': 0.8508078, 'recall': 0.849537, 'specificity': 0.849537, 'f1': 0.84940064, 'auroc': 0.92504716, 'binary_precision': 0.8719212, 'binary_recall': 0.8194444, 'binary_specificity': 0.8796296, 'binary_f1_score': 0.8448687}
confusion matrix:
     0    1
0  190   26
1   39  177
early stop counter: 8
val acc:0.721439778804779, best validation acc: 0.8302034139633179, corresponding to test acc:                         0.8634259104728699 / 0.8634259104728699
after epoch: 10,now: 2024-07-23 03:41:13.835645,epoch time: 0:01:17.927868,used: 0:12:56.509719,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_03_28_17_seed_2_22769264
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.98092103, 'precision': 0.98126227, 'recall': 0.9808423, 'specificity': 0.9808423, 'f1': 0.9809146, 'auroc': 0.9990192, 'binary_precision': 0.9699872, 'binary_recall': 0.9928104, 'binary_specificity': 0.96887416, 'binary_f1_score': 0.98126614}
confusion matrix:
      0     1
0  1463    47
1    11  1519
---- Validation: 
scalar performance:
{'acc': 0.7824726, 'precision': 0.8156253, 'recall': 0.7780689, 'specificity': 0.7780689, 'f1': 0.7746575, 'auroc': 0.88162446, 'binary_precision': 0.9114832, 'binary_recall': 0.6125402, 'binary_specificity': 0.94359756, 'binary_f1_score': 0.7326923}
confusion matrix:
     0    1
0  619   37
1  241  381
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8032407, 'precision': 0.8314358, 'recall': 0.8032408, 'specificity': 0.8032408, 'f1': 0.7989653, 'auroc': 0.8839377, 'binary_precision': 0.9281046, 'binary_recall': 0.6574074, 'binary_specificity': 0.9490741, 'binary_f1_score': 0.7696477}
confusion matrix:
     0    1
0  205   11
1   74  142
early stop counter: 9
val acc:0.7824726104736328, best validation acc: 0.8302034139633179, corresponding to test acc:                         0.8634259104728699 / 0.8634259104728699
after epoch: 11,now: 2024-07-23 03:42:30.820372,epoch time: 0:01:16.984727,used: 0:14:13.494446,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_03_28_17_seed_2_22769264
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9782895, 'precision': 0.9789722, 'recall': 0.97846794, 'specificity': 0.97846794, 'f1': 0.978286, 'auroc': 0.9985833, 'binary_precision': 0.99931926, 'binary_recall': 0.95759946, 'binary_specificity': 0.9993364, 'binary_f1_score': 0.97801465}
confusion matrix:
      0     1
0  1506     1
1    65  1468
---- Validation: 
scalar performance:
{'acc': 0.5798122, 'precision': 0.7442627, 'recall': 0.56857795, 'specificity': 0.56857795, 'f1': 0.48040244, 'auroc': 0.8115736, 'binary_precision': 0.9381443, 'binary_recall': 0.14630225, 'binary_specificity': 0.99085367, 'binary_f1_score': 0.25312936}
confusion matrix:
     0   1
0  650   6
1  531  91
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5162037, 'precision': 0.63879204, 'recall': 0.5162037, 'specificity': 0.5162037, 'f1': 0.3791012, 'auroc': 0.841328, 'binary_precision': 0.7692308, 'binary_recall': 0.046296295, 'binary_specificity': 0.9861111, 'binary_f1_score': 0.08733624}
confusion matrix:
     0   1
0  213   3
1  206  10
early stop counter: 10
val acc:0.579812228679657, best validation acc: 0.8302034139633179, corresponding to test acc:                         0.8634259104728699 / 0.8634259104728699
after epoch: 12,now: 2024-07-23 03:43:47.394557,epoch time: 0:01:16.574185,used: 0:15:30.068631,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_03_28_17_seed_2_22769264
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9914474, 'precision': 0.9914429, 'recall': 0.99145484, 'specificity': 0.99145484, 'f1': 0.9914472, 'auroc': 0.99966717, 'binary_precision': 0.9927869, 'binary_recall': 0.9901897, 'binary_specificity': 0.99272007, 'binary_f1_score': 0.99148655}
confusion matrix:
      0     1
0  1500    11
1    15  1514
---- Validation: 
scalar performance:
{'acc': 0.75195616, 'precision': 0.80363977, 'recall': 0.7463434, 'specificity': 0.7463434, 'f1': 0.737996, 'auroc': 0.8763504, 'binary_precision': 0.92243767, 'binary_recall': 0.53536975, 'binary_specificity': 0.95731705, 'binary_f1_score': 0.6775178}
confusion matrix:
     0    1
0  628   28
1  289  333
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7060185, 'precision': 0.75806105, 'recall': 0.70601857, 'specificity': 0.70601857, 'f1': 0.69040996, 'auroc': 0.84516466, 'binary_precision': 0.8739496, 'binary_recall': 0.4814815, 'binary_specificity': 0.9305556, 'binary_f1_score': 0.62089556}
confusion matrix:
     0    1
0  201   15
1  112  104
early stop counter: 11
val acc:0.7519561648368835, best validation acc: 0.8302034139633179, corresponding to test acc:                         0.8634259104728699 / 0.8634259104728699
after epoch: 13,now: 2024-07-23 03:45:04.345282,epoch time: 0:01:16.950725,used: 0:16:47.019356,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_03_28_17_seed_2_22769264
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.98782897, 'precision': 0.98783803, 'recall': 0.9878196, 'specificity': 0.9878196, 'f1': 0.9878279, 'auroc': 0.99938405, 'binary_precision': 0.9869792, 'binary_recall': 0.9889106, 'binary_specificity': 0.9867286, 'binary_f1_score': 0.987944}
confusion matrix:
      0     1
0  1487    20
1    17  1516
---- Validation: 
scalar performance:
{'acc': 0.59311426, 'precision': 0.6789973, 'recall': 0.5834518, 'specificity': 0.5834518, 'f1': 0.5249845, 'auroc': 0.7445396, 'binary_precision': 0.79651165, 'binary_recall': 0.22025724, 'binary_specificity': 0.94664633, 'binary_f1_score': 0.34508815}
confusion matrix:
     0    1
0  621   35
1  485  137
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6550926, 'precision': 0.69427073, 'recall': 0.6550926, 'specificity': 0.6550926, 'f1': 0.63678026, 'auroc': 0.74830675, 'binary_precision': 0.7815126, 'binary_recall': 0.43055555, 'binary_specificity': 0.8796296, 'binary_f1_score': 0.5552239}
confusion matrix:
     0   1
0  190  26
1  123  93
early stop counter: 12
val acc:0.5931142568588257, best validation acc: 0.8302034139633179, corresponding to test acc:                         0.8634259104728699 / 0.8634259104728699
after epoch: 14,now: 2024-07-23 03:46:22.726676,epoch time: 0:01:18.381394,used: 0:18:05.400750,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_03_28_17_seed_2_22769264
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9914474, 'precision': 0.9914789, 'recall': 0.9914279, 'specificity': 0.9914279, 'f1': 0.9914465, 'auroc': 0.9995953, 'binary_precision': 0.9889539, 'binary_recall': 0.9941215, 'binary_specificity': 0.98873425, 'binary_f1_score': 0.99153095}
confusion matrix:
      0     1
0  1492    17
1     9  1522
---- Validation: 
scalar performance:
{'acc': 0.7746479, 'precision': 0.7939912, 'recall': 0.7711135, 'specificity': 0.7711135, 'f1': 0.76921976, 'auroc': 0.863246, 'binary_precision': 0.8630435, 'binary_recall': 0.63826364, 'binary_specificity': 0.9039634, 'binary_f1_score': 0.7338262}
confusion matrix:
     0    1
0  593   63
1  225  397
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7893519, 'precision': 0.78965604, 'recall': 0.7893518, 'specificity': 0.7893518, 'f1': 0.7892965, 'auroc': 0.8482939, 'binary_precision': 0.79904306, 'binary_recall': 0.7731481, 'binary_specificity': 0.8055556, 'binary_f1_score': 0.78588235}
confusion matrix:
     0    1
0  174   42
1   49  167
early stop counter: 13
val acc:0.7746478915214539, best validation acc: 0.8302034139633179, corresponding to test acc:                         0.8634259104728699 / 0.8634259104728699
after epoch: 15,now: 2024-07-23 03:47:38.648659,epoch time: 0:01:15.921983,used: 0:19:21.322733,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_03_28_17_seed_2_22769264
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9894737, 'precision': 0.98946714, 'recall': 0.98950106, 'specificity': 0.98950106, 'f1': 0.98947334, 'auroc': 0.9994923, 'binary_precision': 0.9927774, 'binary_recall': 0.98630136, 'binary_specificity': 0.99270076, 'binary_f1_score': 0.9895288}
confusion matrix:
      0     1
0  1496    11
1    21  1512
---- Validation: 
scalar performance:
{'acc': 0.64084506, 'precision': 0.76083344, 'recall': 0.6315706, 'specificity': 0.6315706, 'f1': 0.5854974, 'auroc': 0.8774085, 'binary_precision': 0.93121696, 'binary_recall': 0.2829582, 'binary_specificity': 0.98018295, 'binary_f1_score': 0.43403205}
confusion matrix:
     0    1
0  643   13
1  446  176
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6828704, 'precision': 0.7665001, 'recall': 0.6828704, 'specificity': 0.6828704, 'f1': 0.65587294, 'auroc': 0.8240955, 'binary_precision': 0.9157895, 'binary_recall': 0.4027778, 'binary_specificity': 0.962963, 'binary_f1_score': 0.55948555}
confusion matrix:
     0   1
0  208   8
1  129  87
early stop counter: 14
val acc:0.6408450603485107, best validation acc: 0.8302034139633179, corresponding to test acc:                         0.8634259104728699 / 0.8634259104728699
after epoch: 16,now: 2024-07-23 03:48:55.322399,epoch time: 0:01:16.673740,used: 0:20:37.996473,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_03_28_17_seed_2_22769264
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9868421, 'precision': 0.9869503, 'recall': 0.9867985, 'specificity': 0.9867985, 'f1': 0.9868398, 'auroc': 0.9993403, 'binary_precision': 0.98127824, 'binary_recall': 0.99281514, 'binary_specificity': 0.980782, 'binary_f1_score': 0.987013}
confusion matrix:
      0     1
0  1480    29
1    11  1520
---- Validation: 
scalar performance:
{'acc': 0.7190923, 'precision': 0.7525439, 'recall': 0.71403956, 'specificity': 0.71403956, 'f1': 0.70627177, 'auroc': 0.8208817, 'binary_precision': 0.83804625, 'binary_recall': 0.52411574, 'binary_specificity': 0.9039634, 'binary_f1_score': 0.64490604}
confusion matrix:
     0    1
0  593   63
1  296  326
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8125, 'precision': 0.8130435, 'recall': 0.8125, 'specificity': 0.8125, 'f1': 0.8124186, 'auroc': 0.880144, 'binary_precision': 0.82608694, 'binary_recall': 0.7916667, 'binary_specificity': 0.8333333, 'binary_f1_score': 0.8085106}
confusion matrix:
     0    1
0  180   36
1   45  171
early stop counter: 15
val acc:0.7190923094749451, best validation acc: 0.8302034139633179, corresponding to test acc:                         0.8634259104728699 / 0.8634259104728699
after epoch: 17,now: 2024-07-23 03:50:11.907342,epoch time: 0:01:16.584943,used: 0:21:54.581416,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_03_28_17_seed_2_22769264
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9819079, 'precision': 0.98240566, 'recall': 0.9820496, 'specificity': 0.9820496, 'f1': 0.981906, 'auroc': 0.9989633, 'binary_precision': 1.0, 'binary_recall': 0.9640992, 'binary_specificity': 1.0, 'binary_f1_score': 0.9817215}
confusion matrix:
      0     1
0  1508     0
1    55  1477
---- Validation: 
scalar performance:
{'acc': 0.5516432, 'precision': 0.73969376, 'recall': 0.53951406, 'specificity': 0.53951406, 'f1': 0.42433473, 'auroc': 0.8714653, 'binary_precision': 0.94545454, 'binary_recall': 0.08360129, 'binary_specificity': 0.99542683, 'binary_f1_score': 0.15361892}
confusion matrix:
     0   1
0  653   3
1  570  52
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5162037, 'precision': 0.6985816, 'recall': 0.5162037, 'specificity': 0.5162037, 'f1': 0.37201875, 'auroc': 0.82602453, 'binary_precision': 0.8888889, 'binary_recall': 0.037037037, 'binary_specificity': 0.9953704, 'binary_f1_score': 0.07111111}
confusion matrix:
     0  1
0  215  1
1  208  8
early stop counter: 16
val acc:0.5516431927680969, best validation acc: 0.8302034139633179, corresponding to test acc:                         0.8634259104728699 / 0.8634259104728699
after epoch: 18,now: 2024-07-23 03:51:28.331584,epoch time: 0:01:16.424242,used: 0:23:11.005658,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_03_28_17_seed_2_22769264
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.99210525, 'precision': 0.9920963, 'recall': 0.9921167, 'specificity': 0.9921167, 'f1': 0.99210477, 'auroc': 0.99974465, 'binary_precision': 0.99346405, 'binary_recall': 0.9908735, 'binary_specificity': 0.9933599, 'binary_f1_score': 0.9921671}
confusion matrix:
      0     1
0  1496    10
1    14  1520
---- Validation: 
scalar performance:
{'acc': 0.771518, 'precision': 0.82621074, 'recall': 0.7659816, 'specificity': 0.7659816, 'f1': 0.75893337, 'auroc': 0.91099775, 'binary_precision': 0.9532967, 'binary_recall': 0.55787784, 'binary_specificity': 0.9740854, 'binary_f1_score': 0.70385396}
confusion matrix:
     0    1
0  639   17
1  275  347
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6851852, 'precision': 0.7955665, 'recall': 0.6851852, 'specificity': 0.6851852, 'f1': 0.652766, 'auroc': 0.8892318, 'binary_precision': 0.97619045, 'binary_recall': 0.37962964, 'binary_specificity': 0.9907407, 'binary_f1_score': 0.5466667}
confusion matrix:
     0   1
0  214   2
1  134  82
early stop counter: 17
val acc:0.7715179920196533, best validation acc: 0.8302034139633179, corresponding to test acc:                         0.8634259104728699 / 0.8634259104728699
after epoch: 19,now: 2024-07-23 03:52:45.175262,epoch time: 0:01:16.843678,used: 0:24:27.849336,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_03_28_17_seed_2_22769264
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.98980266, 'precision': 0.9898676, 'recall': 0.9897711, 'specificity': 0.9897711, 'f1': 0.9898013, 'auroc': 0.9998035, 'binary_precision': 0.9857513, 'binary_recall': 0.9941215, 'binary_specificity': 0.9854208, 'binary_f1_score': 0.9899187}
confusion matrix:
      0     1
0  1487    22
1     9  1522
---- Validation: 
scalar performance:
{'acc': 0.726917, 'precision': 0.7883214, 'recall': 0.7206199, 'specificity': 0.7206199, 'f1': 0.7077862, 'auroc': 0.8637289, 'binary_precision': 0.9148936, 'binary_recall': 0.48392284, 'binary_specificity': 0.95731705, 'binary_f1_score': 0.63301784}
confusion matrix:
     0    1
0  628   28
1  321  301
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8125, 'precision': 0.8436167, 'recall': 0.8125, 'specificity': 0.8125, 'f1': 0.80815685, 'auroc': 0.92459714, 'binary_precision': 0.9470199, 'binary_recall': 0.662037, 'binary_specificity': 0.962963, 'binary_f1_score': 0.77929145}
confusion matrix:
     0    1
0  208    8
1   73  143
early stop counter: 18
val acc:0.726917028427124, best validation acc: 0.8302034139633179, corresponding to test acc:                         0.8634259104728699 / 0.8634259104728699
after epoch: 20,now: 2024-07-23 03:54:01.577131,epoch time: 0:01:16.401869,used: 0:25:44.251205,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_03_28_17_seed_2_22769264
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9930921, 'precision': 0.99309206, 'recall': 0.9931401, 'specificity': 0.9931401, 'f1': 0.9930919, 'auroc': 0.9998251, 'binary_precision': 0.9980263, 'binary_recall': 0.9882736, 'binary_specificity': 0.99800664, 'binary_f1_score': 0.993126}
confusion matrix:
      0     1
0  1502     3
1    18  1517
---- Validation: 
scalar performance:
{'acc': 0.670579, 'precision': 0.78898907, 'recall': 0.6618672, 'specificity': 0.6618672, 'f1': 0.62605166, 'auroc': 0.8850286, 'binary_precision': 0.96744186, 'binary_recall': 0.33440515, 'binary_specificity': 0.9893293, 'binary_f1_score': 0.49701315}
confusion matrix:
     0    1
0  649    7
1  414  208
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5833333, 'precision': 0.75968474, 'recall': 0.5833334, 'specificity': 0.5833334, 'f1': 0.49812835, 'auroc': 0.8859525, 'binary_precision': 0.9736842, 'binary_recall': 0.1712963, 'binary_specificity': 0.9953704, 'binary_f1_score': 0.29133862}
confusion matrix:
     0   1
0  215   1
1  179  37
early stop counter: 19
val acc:0.6705790162086487, best validation acc: 0.8302034139633179, corresponding to test acc:                         0.8634259104728699 / 0.8634259104728699
after epoch: 21,now: 2024-07-23 03:55:17.690864,epoch time: 0:01:16.113733,used: 0:27:00.364938,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_03_28_17_seed_2_22769264
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9848684, 'precision': 0.9852637, 'recall': 0.98476875, 'specificity': 0.98476875, 'f1': 0.9848621, 'auroc': 0.9993118, 'binary_precision': 0.9732484, 'binary_recall': 0.997389, 'binary_specificity': 0.97214854, 'binary_f1_score': 0.98517084}
confusion matrix:
      0     1
0  1466    42
1     4  1528
---- Validation: 
scalar performance:
{'acc': 0.8348983, 'precision': 0.8350122, 'recall': 0.83451056, 'specificity': 0.83451056, 'f1': 0.8346746, 'auroc': 0.89390785, 'binary_precision': 0.8374384, 'binary_recall': 0.8199357, 'binary_specificity': 0.8490854, 'binary_f1_score': 0.82859457}
confusion matrix:
     0    1
0  557   99
1  112  510
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8148148, 'precision': 0.8175372, 'recall': 0.8148148, 'specificity': 0.8148148, 'f1': 0.814417, 'auroc': 0.8813443, 'binary_precision': 0.7881356, 'binary_recall': 0.8611111, 'binary_specificity': 0.7685185, 'binary_f1_score': 0.82300884}
confusion matrix:
     0    1
0  166   50
1   30  186
better model found
persisted
after epoch: 22,now: 2024-07-23 03:56:35.686334,epoch time: 0:01:17.995470,used: 0:28:18.360408,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_03_28_17_seed_2_22769264
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.98815787, 'precision': 0.988164, 'recall': 0.98814964, 'specificity': 0.98814964, 'f1': 0.98815644, 'auroc': 0.9994767, 'binary_precision': 0.9876463, 'binary_recall': 0.9889323, 'binary_specificity': 0.98736703, 'binary_f1_score': 0.9882889}
confusion matrix:
      0     1
0  1485    19
1    17  1519
---- Validation: 
scalar performance:
{'acc': 0.81220657, 'precision': 0.8234502, 'recall': 0.8096571, 'specificity': 0.8096571, 'f1': 0.8095834, 'auroc': 0.8720248, 'binary_precision': 0.8774704, 'binary_recall': 0.71382636, 'binary_specificity': 0.9054878, 'binary_f1_score': 0.78723407}
confusion matrix:
     0    1
0  594   62
1  178  444
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7199074, 'precision': 0.7265551, 'recall': 0.7199074, 'specificity': 0.7199074, 'f1': 0.7178376, 'auroc': 0.7872299, 'binary_precision': 0.68774706, 'binary_recall': 0.8055556, 'binary_specificity': 0.6342593, 'binary_f1_score': 0.74200433}
confusion matrix:
     0    1
0  137   79
1   42  174
early stop counter: 1
val acc:0.8122065663337708, best validation acc: 0.8348982930183411, corresponding to test acc:                         0.8148148059844971 / 0.8634259104728699
after epoch: 23,now: 2024-07-23 03:57:52.663667,epoch time: 0:01:16.977333,used: 0:29:35.337741,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_03_28_17_seed_2_22769264
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9888158, 'precision': 0.9888227, 'recall': 0.98886335, 'specificity': 0.98886335, 'f1': 0.9888156, 'auroc': 0.9996252, 'binary_precision': 0.9940711, 'binary_recall': 0.9837027, 'binary_specificity': 0.9940239, 'binary_f1_score': 0.9888597}
confusion matrix:
      0     1
0  1497     9
1    25  1509
---- Validation: 
scalar performance:
{'acc': 0.7214398, 'precision': 0.79199547, 'recall': 0.71474296, 'specificity': 0.71474296, 'f1': 0.699407, 'auroc': 0.8807845, 'binary_precision': 0.92903227, 'binary_recall': 0.4630225, 'binary_specificity': 0.9664634, 'binary_f1_score': 0.6180257}
confusion matrix:
     0    1
0  634   22
1  334  288
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7152778, 'precision': 0.7786362, 'recall': 0.7152778, 'specificity': 0.7152778, 'f1': 0.69811666, 'auroc': 0.85776746, 'binary_precision': 0.91150445, 'binary_recall': 0.47685185, 'binary_specificity': 0.9537037, 'binary_f1_score': 0.6261398}
confusion matrix:
     0    1
0  206   10
1  113  103
early stop counter: 2
val acc:0.721439778804779, best validation acc: 0.8348982930183411, corresponding to test acc:                         0.8148148059844971 / 0.8634259104728699
after epoch: 24,now: 2024-07-23 03:59:09.037620,epoch time: 0:01:16.373953,used: 0:30:51.711694,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_03_28_17_seed_2_22769264
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.98453945, 'precision': 0.98481274, 'recall': 0.9846593, 'specificity': 0.9846593, 'f1': 0.98453903, 'auroc': 0.9990854, 'binary_precision': 0.9986577, 'binary_recall': 0.9706458, 'binary_specificity': 0.99867284, 'binary_f1_score': 0.98445255}
confusion matrix:
      0     1
0  1505     2
1    45  1488
---- Validation: 
scalar performance:
{'acc': 0.6737089, 'precision': 0.78842837, 'recall': 0.6651243, 'specificity': 0.6651243, 'f1': 0.6309528, 'auroc': 0.8606335, 'binary_precision': 0.9638009, 'binary_recall': 0.34244373, 'binary_specificity': 0.9878049, 'binary_f1_score': 0.5053381}
confusion matrix:
     0    1
0  648    8
1  409  213
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5162037, 'precision': 0.63879204, 'recall': 0.5162037, 'specificity': 0.5162037, 'f1': 0.3791012, 'auroc': 0.82583165, 'binary_precision': 0.7692308, 'binary_recall': 0.046296295, 'binary_specificity': 0.9861111, 'binary_f1_score': 0.08733624}
confusion matrix:
     0   1
0  213   3
1  206  10
early stop counter: 3
val acc:0.6737089157104492, best validation acc: 0.8348982930183411, corresponding to test acc:                         0.8148148059844971 / 0.8634259104728699
after epoch: 25,now: 2024-07-23 04:00:25.806077,epoch time: 0:01:16.768457,used: 0:32:08.480151,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_03_28_17_seed_2_22769264
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.99473685, 'precision': 0.99474776, 'recall': 0.99472886, 'specificity': 0.99472886, 'f1': 0.99473655, 'auroc': 0.9996797, 'binary_precision': 0.99347687, 'binary_recall': 0.99607587, 'binary_specificity': 0.99338186, 'binary_f1_score': 0.99477464}
confusion matrix:
      0     1
0  1501    10
1     6  1523
---- Validation: 
scalar performance:
{'acc': 0.73787165, 'precision': 0.8098475, 'recall': 0.73133236, 'specificity': 0.73133236, 'f1': 0.7180319, 'auroc': 0.9046986, 'binary_precision': 0.95268136, 'binary_recall': 0.48553056, 'binary_specificity': 0.97713417, 'binary_f1_score': 0.6432375}
confusion matrix:
     0    1
0  641   15
1  320  302
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6273148, 'precision': 0.74900436, 'recall': 0.6273148, 'specificity': 0.6273148, 'f1': 0.5754442, 'auroc': 0.8680073, 'binary_precision': 0.9230769, 'binary_recall': 0.2777778, 'binary_specificity': 0.9768519, 'binary_f1_score': 0.42704627}
confusion matrix:
     0   1
0  211   5
1  156  60
early stop counter: 4
val acc:0.7378716468811035, best validation acc: 0.8348982930183411, corresponding to test acc:                         0.8148148059844971 / 0.8634259104728699
after epoch: 26,now: 2024-07-23 04:01:41.578966,epoch time: 0:01:15.772889,used: 0:33:24.253040,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_03_28_17_seed_2_22769264
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.9934211, 'precision': 0.9934331, 'recall': 0.99345106, 'specificity': 0.99345106, 'f1': 0.9934211, 'auroc': 0.9998926, 'binary_precision': 0.9980211, 'binary_recall': 0.98888886, 'binary_specificity': 0.99801326, 'binary_f1_score': 0.993434}
confusion matrix:
      0     1
0  1507     3
1    17  1513
---- Validation: 
scalar performance:
{'acc': 0.64084506, 'precision': 0.7630565, 'recall': 0.6315289, 'specificity': 0.6315289, 'f1': 0.5849484, 'auroc': 0.8916782, 'binary_precision': 0.93582886, 'binary_recall': 0.2813505, 'binary_specificity': 0.98170733, 'binary_f1_score': 0.43263292}
confusion matrix:
     0    1
0  644   12
1  447  175
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5277778, 'precision': 0.60125, 'recall': 0.5277778, 'specificity': 0.5277778, 'f1': 0.42312524, 'auroc': 0.7776277, 'binary_precision': 0.6875, 'binary_recall': 0.10185185, 'binary_specificity': 0.9537037, 'binary_f1_score': 0.17741936}
confusion matrix:
     0   1
0  206  10
1  194  22
early stop counter: 5
val acc:0.6408450603485107, best validation acc: 0.8348982930183411, corresponding to test acc:                         0.8148148059844971 / 0.8634259104728699
after epoch: 27,now: 2024-07-23 04:02:58.476105,epoch time: 0:01:16.897139,used: 0:34:41.150179,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_03_28_17_seed_2_22769264
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.9930921, 'precision': 0.9931462, 'recall': 0.99313277, 'specificity': 0.99313277, 'f1': 0.99309206, 'auroc': 0.99985844, 'binary_precision': 1.0, 'binary_recall': 0.98626554, 'binary_specificity': 1.0, 'binary_f1_score': 0.99308527}
confusion matrix:
      0     1
0  1511     0
1    21  1508
---- Validation: 
scalar performance:
{'acc': 0.6251956, 'precision': 0.7700485, 'recall': 0.6152018, 'specificity': 0.6152018, 'f1': 0.557137, 'auroc': 0.89935714, 'binary_precision': 0.9612903, 'binary_recall': 0.23954985, 'binary_specificity': 0.99085367, 'binary_f1_score': 0.38352638}
confusion matrix:
     0    1
0  650    6
1  473  149
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5740741, 'precision': 0.70243675, 'recall': 0.5740741, 'specificity': 0.5740741, 'f1': 0.49383596, 'auroc': 0.8259388, 'binary_precision': 0.8636364, 'binary_recall': 0.17592593, 'binary_specificity': 0.9722222, 'binary_f1_score': 0.29230767}
confusion matrix:
     0   1
0  210   6
1  178  38
early stop counter: 6
val acc:0.6251956224441528, best validation acc: 0.8348982930183411, corresponding to test acc:                         0.8148148059844971 / 0.8634259104728699
after epoch: 28,now: 2024-07-23 04:04:15.412132,epoch time: 0:01:16.936027,used: 0:35:58.086206,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_03_28_17_seed_2_22769264
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.98157895, 'precision': 0.9821744, 'recall': 0.9814531, 'specificity': 0.9814531, 'f1': 0.98156863, 'auroc': 0.9996728, 'binary_precision': 0.9670886, 'binary_recall': 0.997389, 'binary_specificity': 0.9655172, 'binary_f1_score': 0.9820052}
confusion matrix:
      0     1
0  1456    52
1     4  1528
---- Validation: 
scalar performance:
{'acc': 0.81064165, 'precision': 0.8112484, 'recall': 0.80992424, 'specificity': 0.80992424, 'f1': 0.81019497, 'auroc': 0.87353444, 'binary_precision': 0.81986535, 'binary_recall': 0.7829582, 'binary_specificity': 0.8368902, 'binary_f1_score': 0.80098695}
confusion matrix:
     0    1
0  549  107
1  135  487
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7731481, 'precision': 0.77781653, 'recall': 0.7731482, 'specificity': 0.7731482, 'f1': 0.77219117, 'auroc': 0.8533951, 'binary_precision': 0.7418033, 'binary_recall': 0.837963, 'binary_specificity': 0.7083333, 'binary_f1_score': 0.78695655}
confusion matrix:
     0    1
0  153   63
1   35  181
early stop counter: 7
val acc:0.8106416463851929, best validation acc: 0.8348982930183411, corresponding to test acc:                         0.8148148059844971 / 0.8634259104728699
after epoch: 29,now: 2024-07-23 04:05:32.268589,epoch time: 0:01:16.856457,used: 0:37:14.942663,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_03_28_17_seed_2_22769264
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.9838816, 'precision': 0.9840518, 'recall': 0.98381567, 'specificity': 0.98381567, 'f1': 0.9838774, 'auroc': 0.9990689, 'binary_precision': 0.97686374, 'binary_recall': 0.99151987, 'binary_specificity': 0.9761115, 'binary_f1_score': 0.9841373}
confusion matrix:
      0     1
0  1471    36
1    13  1520
---- Validation: 
scalar performance:
{'acc': 0.75117373, 'precision': 0.7820411, 'recall': 0.7466228, 'specificity': 0.7466228, 'f1': 0.7417605, 'auroc': 0.87498045, 'binary_precision': 0.86893207, 'binary_recall': 0.5755627, 'binary_specificity': 0.91768295, 'binary_f1_score': 0.6924565}
confusion matrix:
     0    1
0  602   54
1  264  358
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8287037, 'precision': 0.83100235, 'recall': 0.8287037, 'specificity': 0.8287037, 'f1': 0.82840574, 'auroc': 0.90016294, 'binary_precision': 0.8034188, 'binary_recall': 0.8703704, 'binary_specificity': 0.787037, 'binary_f1_score': 0.8355555}
confusion matrix:
     0    1
0  170   46
1   28  188
early stop counter: 8
val acc:0.751173734664917, best validation acc: 0.8348982930183411, corresponding to test acc:                         0.8148148059844971 / 0.8634259104728699
after epoch: 30,now: 2024-07-23 04:06:48.474387,epoch time: 0:01:16.205798,used: 0:38:31.148461,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_03_28_17_seed_2_22769264
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 0:38:31.148461 at 2024-07-23 04:06:48.474387
persisted model performance metric: 

scalar performance:
{'acc': 0.8148148, 'precision': 0.8175372, 'recall': 0.8148148, 'specificity': 0.8148148, 'f1': 0.814417, 'auroc': 0.8813443, 'binary_precision': 0.7881356, 'binary_recall': 0.8611111, 'binary_specificity': 0.7685185, 'binary_f1_score': 0.82300884}
confusion matrix:
     0    1
0  166   50
1   30  186
oracle model performance metric: 

scalar performance:
{'acc': 0.8634259, 'precision': 0.86380804, 'recall': 0.8634259, 'specificity': 0.8634259, 'f1': 0.8633901, 'auroc': 0.9224537, 'binary_precision': 0.8755981, 'binary_recall': 0.8472222, 'binary_specificity': 0.8796296, 'binary_f1_score': 0.86117643}
confusion matrix:
     0    1
0  190   26
1   33  183
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_dial_lr1e5_bs16_allfreeze_2024-07-22_23-46-53/rule_results/3.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_dial_lr1e5_bs16_allfreeze_2024-07-22_23-46-53/confusion_matrix/3.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 451685 KiB |  26075 MiB | 215764 GiB | 215763 GiB |
|       from large pool | 411132 KiB |  26030 MiB | 214418 GiB | 214417 GiB |
|       from small pool |  40553 KiB |     60 MiB |   1346 GiB |   1346 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 451685 KiB |  26075 MiB | 215764 GiB | 215763 GiB |
|       from large pool | 411132 KiB |  26030 MiB | 214418 GiB | 214417 GiB |
|       from small pool |  40553 KiB |     60 MiB |   1346 GiB |   1346 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 447481 KiB |  26071 MiB | 215724 GiB | 215723 GiB |
|       from large pool | 407075 KiB |  26026 MiB | 214380 GiB | 214380 GiB |
|       from small pool |  40406 KiB |     60 MiB |   1343 GiB |   1343 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  27778 MiB |  27778 MiB |  80918 MiB |  53140 MiB |
|       from large pool |  27710 MiB |  27710 MiB |  80820 MiB |  53110 MiB |
|       from small pool |     68 MiB |     72 MiB |     98 MiB |     30 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 775066 KiB |   1679 MiB |  97328 GiB |  97328 GiB |
|       from large pool | 758276 KiB |   1676 MiB |  95973 GiB |  95972 GiB |
|       from small pool |  16790 KiB |     34 MiB |   1355 GiB |   1355 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    1220    |    2570    |   19511 K  |   19509 K  |
|       from large pool |     187    |    1413    |    9878 K  |    9878 K  |
|       from small pool |    1033    |    1335    |    9632 K  |    9631 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    1220    |    2570    |   19511 K  |   19509 K  |
|       from large pool |     187    |    1413    |    9878 K  |    9878 K  |
|       from small pool |    1033    |    1335    |    9632 K  |    9631 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     837    |     837    |    2371    |    1534    |
|       from large pool |     803    |     803    |    2322    |    1519    |
|       from small pool |      34    |      36    |      49    |      15    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     113    |     852    |   14250 K  |   14250 K  |
|       from large pool |      47    |     805    |    8785 K  |    8785 K  |
|       from small pool |      66    |     146    |    5464 K  |    5464 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  26075 MiB | 215764 GiB | 215764 GiB |
|       from large pool |  16640 KiB |  26030 MiB | 214418 GiB | 214418 GiB |
|       from small pool |      0 KiB |     60 MiB |   1346 GiB |   1346 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  26075 MiB | 215764 GiB | 215764 GiB |
|       from large pool |  16640 KiB |  26030 MiB | 214418 GiB | 214418 GiB |
|       from small pool |      0 KiB |     60 MiB |   1346 GiB |   1346 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  26071 MiB | 215724 GiB | 215724 GiB |
|       from large pool |  16640 KiB |  26026 MiB | 214380 GiB | 214380 GiB |
|       from small pool |      0 KiB |     60 MiB |   1343 GiB |   1343 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1198 MiB |  27778 MiB |  80918 MiB |  79720 MiB |
|       from large pool |   1142 MiB |  27710 MiB |  80820 MiB |  79678 MiB |
|       from small pool |     56 MiB |     72 MiB |     98 MiB |     42 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |   3840 KiB |   1679 MiB |  97329 GiB |  97329 GiB |
|       from large pool |   3840 KiB |   1676 MiB |  95973 GiB |  95973 GiB |
|       from small pool |      0 KiB |     34 MiB |   1355 GiB |   1355 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    2570    |   19511 K  |   19511 K  |
|       from large pool |       2    |    1413    |    9878 K  |    9878 K  |
|       from small pool |       0    |    1335    |    9632 K  |    9632 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    2570    |   19511 K  |   19511 K  |
|       from large pool |       2    |    1413    |    9878 K  |    9878 K  |
|       from small pool |       0    |    1335    |    9632 K  |    9632 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      71    |     837    |    2371    |    2300    |
|       from large pool |      43    |     803    |    2322    |    2279    |
|       from small pool |      28    |      36    |      49    |      21    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       1    |     852    |   14250 K  |   14250 K  |
|       from large pool |       1    |     805    |    8785 K  |    8785 K  |
|       from small pool |       0    |     146    |    5464 K  |    5464 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Tue Jul 23 04:07:37 2024]
Finished job 0.
1 of 1 steps (100%) done
