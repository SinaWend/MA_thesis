Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Tue Jul 23 02:41:08 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_dial_lr1e5_bs16_allfreeze_2024-07-22_23-46-53/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_dial_lr1e5_bs16_allfreeze_2024-07-22_23-46-53/rule_results/5.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=5
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/swiglu_ffn.py:51: UserWarning: xFormers is not available (SwiGLU)
  warnings.warn("xFormers is not available (SwiGLU)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/attention.py:33: UserWarning: xFormers is not available (Attention)
  warnings.warn("xFormers is not available (Attention)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/block.py:40: UserWarning: xFormers is not available (Block)
  warnings.warn("xFormers is not available (Block)")
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'888c1ef2'
model name: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_02_44_04_seed_0_22769265

 Experiment start at: 2024-07-23 02:44:04.769211
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
before training, model accuracy: 0.569767415523529
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.94433594, 'precision': 0.94476116, 'recall': 0.94455695, 'specificity': 0.94455695, 'f1': 0.9443338, 'auroc': 0.9850365, 'binary_precision': 0.9619493, 'binary_recall': 0.9266881, 'binary_specificity': 0.9624258, 'binary_f1_score': 0.9439895}
confusion matrix:
      0     1
0  1460    57
1   114  1441
---- Validation: 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
scalar performance:
{'acc': 0.80590063, 'precision': 0.81021035, 'recall': 0.8067092, 'specificity': 0.8067092, 'f1': 0.80547845, 'auroc': 0.90090317, 'binary_precision': 0.769986, 'binary_recall': 0.8645669, 'binary_specificity': 0.7488515, 'binary_f1_score': 0.81454}
confusion matrix:
     0    1
0  489  164
1   86  549
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.80697674, 'precision': 0.8126652, 'recall': 0.80697674, 'specificity': 0.80697674, 'f1': 0.80609477, 'auroc': 0.90751755, 'binary_precision': 0.7704918, 'binary_recall': 0.8744186, 'binary_specificity': 0.73953485, 'binary_f1_score': 0.81917214}
confusion matrix:
     0    1
0  159   56
1   27  188
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-23 02:45:42.677713,epoch time: 0:01:37.908502,used: 0:01:37.908502,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_02_44_04_seed_0_22769265
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9609375, 'precision': 0.9609146, 'recall': 0.96097326, 'specificity': 0.96097326, 'f1': 0.9609337, 'auroc': 0.9928247, 'binary_precision': 0.9644243, 'binary_recall': 0.9582262, 'binary_specificity': 0.9637203, 'binary_f1_score': 0.9613152}
confusion matrix:
      0     1
0  1461    55
1    65  1491
---- Validation: 
scalar performance:
{'acc': 0.80590063, 'precision': 0.8233977, 'recall': 0.8075123, 'specificity': 0.8075123, 'f1': 0.80377674, 'auroc': 0.92187, 'binary_precision': 0.74459976, 'binary_recall': 0.92283463, 'binary_specificity': 0.6921899, 'binary_f1_score': 0.8241912}
confusion matrix:
     0    1
0  452  201
1   49  586
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7976744, 'precision': 0.8126136, 'recall': 0.7976744, 'specificity': 0.7976744, 'f1': 0.795228, 'auroc': 0.9215144, 'binary_precision': 0.7442748, 'binary_recall': 0.90697676, 'binary_specificity': 0.6883721, 'binary_f1_score': 0.8176101}
confusion matrix:
     0    1
0  148   67
1   20  195
early stop counter: 1
val acc:0.8059006333351135, best validation acc: 0.8059006333351135, corresponding to test acc:                         0.8069767355918884 / 0.8069767355918884
after epoch: 2,now: 2024-07-23 02:47:10.951717,epoch time: 0:01:28.274004,used: 0:03:06.182506,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_02_44_04_seed_0_22769265
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9658203, 'precision': 0.96590215, 'recall': 0.9659608, 'specificity': 0.9659608, 'f1': 0.96582, 'auroc': 0.9943112, 'binary_precision': 0.97637796, 'binary_recall': 0.955684, 'binary_specificity': 0.9762376, 'binary_f1_score': 0.9659202}
confusion matrix:
      0     1
0  1479    36
1    69  1488
---- Validation: 
scalar performance:
{'acc': 0.7919255, 'precision': 0.791884, 'recall': 0.79190654, 'specificity': 0.79190654, 'f1': 0.79189336, 'auroc': 0.8761404, 'binary_precision': 0.78806907, 'binary_recall': 0.7905512, 'binary_specificity': 0.7932619, 'binary_f1_score': 0.78930825}
confusion matrix:
     0    1
0  518  135
1  133  502
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.82325584, 'precision': 0.825056, 'recall': 0.8232558, 'specificity': 0.8232558, 'f1': 0.8230107, 'auroc': 0.91863704, 'binary_precision': 0.8008658, 'binary_recall': 0.8604651, 'binary_specificity': 0.7860465, 'binary_f1_score': 0.8295964}
confusion matrix:
     0    1
0  169   46
1   30  185
new oracle model saved
early stop counter: 2
val acc:0.7919254899024963, best validation acc: 0.8059006333351135, corresponding to test acc:                         0.8069767355918884 / 0.8232558369636536
after epoch: 3,now: 2024-07-23 02:48:40.332447,epoch time: 0:01:29.380730,used: 0:04:35.563236,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_02_44_04_seed_0_22769265
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.96777344, 'precision': 0.9684445, 'recall': 0.96807456, 'specificity': 0.96807456, 'f1': 0.96777093, 'auroc': 0.996358, 'binary_precision': 0.98991936, 'binary_recall': 0.9460501, 'binary_specificity': 0.990099, 'binary_f1_score': 0.9674877}
confusion matrix:
      0     1
0  1500    15
1    84  1473
---- Validation: 
scalar performance:
{'acc': 0.84006214, 'precision': 0.84003085, 'recall': 0.84003085, 'specificity': 0.84003085, 'f1': 0.84003085, 'auroc': 0.90155435, 'binary_precision': 0.83779526, 'binary_recall': 0.83779526, 'binary_specificity': 0.84226644, 'binary_f1_score': 0.83779526}
confusion matrix:
     0    1
0  550  103
1  103  532
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8116279, 'precision': 0.81662124, 'recall': 0.8116279, 'specificity': 0.8116279, 'f1': 0.8108823, 'auroc': 0.91154134, 'binary_precision': 0.7768595, 'binary_recall': 0.8744186, 'binary_specificity': 0.74883723, 'binary_f1_score': 0.8227571}
confusion matrix:
     0    1
0  161   54
1   27  188
better model found
persisted
after epoch: 4,now: 2024-07-23 02:50:08.028557,epoch time: 0:01:27.696110,used: 0:06:03.259346,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_02_44_04_seed_0_22769265
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9794922, 'precision': 0.9794769, 'recall': 0.97950196, 'specificity': 0.97950196, 'f1': 0.9794885, 'auroc': 0.9974226, 'binary_precision': 0.9807074, 'binary_recall': 0.978819, 'binary_specificity': 0.9801849, 'binary_f1_score': 0.9797623}
confusion matrix:
      0     1
0  1484    30
1    33  1525
---- Validation: 
scalar performance:
{'acc': 0.81909937, 'precision': 0.8311842, 'recall': 0.81775093, 'specificity': 0.81775093, 'f1': 0.8169677, 'auroc': 0.91063654, 'binary_precision': 0.8910506, 'binary_recall': 0.72125983, 'binary_specificity': 0.91424197, 'binary_f1_score': 0.7972149}
confusion matrix:
     0    1
0  597   56
1  177  458
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8511628, 'precision': 0.8531184, 'recall': 0.8511628, 'specificity': 0.8511628, 'f1': 0.8509564, 'auroc': 0.9188101, 'binary_precision': 0.879397, 'binary_recall': 0.81395346, 'binary_specificity': 0.88837206, 'binary_f1_score': 0.8454106}
confusion matrix:
     0    1
0  191   24
1   40  175
new oracle model saved
early stop counter: 1
val acc:0.8190993666648865, best validation acc: 0.840062141418457, corresponding to test acc:                         0.8116279244422913 / 0.8511627912521362
after epoch: 5,now: 2024-07-23 02:51:38.691200,epoch time: 0:01:30.662643,used: 0:07:33.921989,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_02_44_04_seed_0_22769265
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.961263, 'precision': 0.9635409, 'recall': 0.96083677, 'specificity': 0.96083677, 'f1': 0.96118355, 'auroc': 0.9981207, 'binary_precision': 0.93413895, 'binary_recall': 0.99357325, 'binary_specificity': 0.9281003, 'binary_f1_score': 0.96293986}
confusion matrix:
      0     1
0  1407   109
1    10  1546
---- Validation: 
scalar performance:
{'acc': 0.7049689, 'precision': 0.70635545, 'recall': 0.7054757, 'specificity': 0.7054757, 'f1': 0.70476323, 'auroc': 0.8075291, 'binary_precision': 0.6855895, 'binary_recall': 0.7417323, 'binary_specificity': 0.669219, 'binary_f1_score': 0.7125567}
confusion matrix:
     0    1
0  437  216
1  164  471
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7627907, 'precision': 0.7981055, 'recall': 0.7627907, 'specificity': 0.7627907, 'f1': 0.7555511, 'auroc': 0.9239156, 'binary_precision': 0.69550174, 'binary_recall': 0.9348837, 'binary_specificity': 0.59069765, 'binary_f1_score': 0.79761904}
confusion matrix:
     0    1
0  127   88
1   14  201
early stop counter: 2
val acc:0.7049689292907715, best validation acc: 0.840062141418457, corresponding to test acc:                         0.8116279244422913 / 0.8511627912521362
after epoch: 6,now: 2024-07-23 02:53:07.475657,epoch time: 0:01:28.784457,used: 0:09:02.706446,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_02_44_04_seed_0_22769265
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9866536, 'precision': 0.9866878, 'recall': 0.98677135, 'specificity': 0.98677135, 'f1': 0.98665327, 'auroc': 0.9990308, 'binary_precision': 0.9954248, 'binary_recall': 0.9781631, 'binary_specificity': 0.99537957, 'binary_f1_score': 0.9867184}
confusion matrix:
      0     1
0  1508     7
1    34  1523
---- Validation: 
scalar performance:
{'acc': 0.7670807, 'precision': 0.7825808, 'recall': 0.7654074, 'specificity': 0.7654074, 'f1': 0.7630495, 'auroc': 0.8741267, 'binary_precision': 0.8453608, 'binary_recall': 0.6456693, 'binary_specificity': 0.8851455, 'binary_f1_score': 0.73214287}
confusion matrix:
     0    1
0  578   75
1  225  410
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.84418607, 'precision': 0.84689516, 'recall': 0.84418607, 'specificity': 0.84418607, 'f1': 0.84388125, 'auroc': 0.92233634, 'binary_precision': 0.8162393, 'binary_recall': 0.88837206, 'binary_specificity': 0.8, 'binary_f1_score': 0.85077953}
confusion matrix:
     0    1
0  172   43
1   24  191
early stop counter: 3
val acc:0.7670807242393494, best validation acc: 0.840062141418457, corresponding to test acc:                         0.8116279244422913 / 0.8511627912521362
after epoch: 7,now: 2024-07-23 02:54:36.724801,epoch time: 0:01:29.249144,used: 0:10:31.955590,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_02_44_04_seed_0_22769265
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9860026, 'precision': 0.98597884, 'recall': 0.98604006, 'specificity': 0.98604006, 'f1': 0.986001, 'auroc': 0.99880195, 'binary_precision': 0.9890181, 'binary_recall': 0.9833012, 'binary_specificity': 0.9887789, 'binary_f1_score': 0.98615134}
confusion matrix:
      0     1
0  1498    17
1    26  1531
---- Validation: 
scalar performance:
{'acc': 0.85248446, 'precision': 0.85807544, 'recall': 0.8516092, 'specificity': 0.8516092, 'f1': 0.85166043, 'auroc': 0.91383433, 'binary_precision': 0.8994614, 'binary_recall': 0.7889764, 'binary_specificity': 0.91424197, 'binary_f1_score': 0.84060407}
confusion matrix:
     0    1
0  597   56
1  134  501
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.82325584, 'precision': 0.82607746, 'recall': 0.8232558, 'specificity': 0.8232558, 'f1': 0.82287264, 'auroc': 0.90881556, 'binary_precision': 0.85641026, 'binary_recall': 0.7767442, 'binary_specificity': 0.8697674, 'binary_f1_score': 0.81463414}
confusion matrix:
     0    1
0  187   28
1   48  167
better model found
persisted
after epoch: 8,now: 2024-07-23 02:56:03.897813,epoch time: 0:01:27.173012,used: 0:11:59.128602,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_02_44_04_seed_0_22769265
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9899089, 'precision': 0.9898899, 'recall': 0.9899516, 'specificity': 0.9899516, 'f1': 0.98990804, 'auroc': 0.9994761, 'binary_precision': 0.9935233, 'binary_recall': 0.9864952, 'binary_specificity': 0.993408, 'binary_f1_score': 0.98999673}
confusion matrix:
      0     1
0  1507    10
1    21  1534
---- Validation: 
scalar performance:
{'acc': 0.8082298, 'precision': 0.8256455, 'recall': 0.80659705, 'specificity': 0.80659705, 'f1': 0.80503017, 'auroc': 0.8885266, 'binary_precision': 0.897541, 'binary_recall': 0.6897638, 'binary_specificity': 0.9234303, 'binary_f1_score': 0.78005344}
confusion matrix:
     0    1
0  603   50
1  197  438
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.855814, 'precision': 0.86030364, 'recall': 0.855814, 'specificity': 0.855814, 'f1': 0.85536337, 'auroc': 0.9188751, 'binary_precision': 0.90052354, 'binary_recall': 0.8, 'binary_specificity': 0.9116279, 'binary_f1_score': 0.84729064}
confusion matrix:
     0    1
0  196   19
1   43  172
new oracle model saved
early stop counter: 1
val acc:0.8082298040390015, best validation acc: 0.8524844646453857, corresponding to test acc:                         0.8232558369636536 / 0.8558139801025391
after epoch: 9,now: 2024-07-23 02:57:32.595370,epoch time: 0:01:28.697557,used: 0:13:27.826159,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_02_44_04_seed_0_22769265
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9827474, 'precision': 0.98308593, 'recall': 0.98295015, 'specificity': 0.98295015, 'f1': 0.9827471, 'auroc': 0.99900424, 'binary_precision': 0.9993351, 'binary_recall': 0.96655947, 'binary_specificity': 0.99934083, 'binary_f1_score': 0.98267406}
confusion matrix:
      0     1
0  1516     1
1    52  1503
---- Validation: 
scalar performance:
{'acc': 0.74378884, 'precision': 0.799317, 'recall': 0.7407435, 'specificity': 0.7407435, 'f1': 0.7297057, 'auroc': 0.90373445, 'binary_precision': 0.9247911, 'binary_recall': 0.52283466, 'binary_specificity': 0.9586524, 'binary_f1_score': 0.6680081}
confusion matrix:
     0    1
0  626   27
1  303  332
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8581395, 'precision': 0.87611324, 'recall': 0.8581395, 'specificity': 0.8581395, 'f1': 0.85642433, 'auroc': 0.9143483, 'binary_precision': 0.9583333, 'binary_recall': 0.74883723, 'binary_specificity': 0.96744186, 'binary_f1_score': 0.84073114}
confusion matrix:
     0    1
0  208    7
1   54  161
new oracle model saved
early stop counter: 2
val acc:0.7437888383865356, best validation acc: 0.8524844646453857, corresponding to test acc:                         0.8232558369636536 / 0.8581395149230957
after epoch: 10,now: 2024-07-23 02:58:54.293171,epoch time: 0:01:21.697801,used: 0:14:49.523960,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_02_44_04_seed_0_22769265
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9921875, 'precision': 0.99217933, 'recall': 0.99219435, 'specificity': 0.99219435, 'f1': 0.9921864, 'auroc': 0.99962485, 'binary_precision': 0.99291694, 'binary_recall': 0.99163985, 'binary_specificity': 0.99274886, 'binary_f1_score': 0.992278}
confusion matrix:
      0     1
0  1506    11
1    13  1542
---- Validation: 
scalar performance:
{'acc': 0.79658383, 'precision': 0.79678977, 'recall': 0.79676116, 'specificity': 0.79676116, 'f1': 0.7965834, 'auroc': 0.8708806, 'binary_precision': 0.7847328, 'binary_recall': 0.80944884, 'binary_specificity': 0.78407353, 'binary_f1_score': 0.79689926}
confusion matrix:
     0    1
0  512  141
1  121  514
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7953488, 'precision': 0.8122356, 'recall': 0.7953488, 'specificity': 0.7953488, 'f1': 0.7925438, 'auroc': 0.8915522, 'binary_precision': 0.73962265, 'binary_recall': 0.9116279, 'binary_specificity': 0.67906976, 'binary_f1_score': 0.8166666}
confusion matrix:
     0    1
0  146   69
1   19  196
early stop counter: 3
val acc:0.7965838313102722, best validation acc: 0.8524844646453857, corresponding to test acc:                         0.8232558369636536 / 0.8581395149230957
after epoch: 11,now: 2024-07-23 03:00:13.396725,epoch time: 0:01:19.103554,used: 0:16:08.627514,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_02_44_04_seed_0_22769265
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9873047, 'precision': 0.9872845, 'recall': 0.9873322, 'specificity': 0.9873322, 'f1': 0.98730326, 'auroc': 0.99905753, 'binary_precision': 0.98967075, 'binary_recall': 0.9852185, 'binary_specificity': 0.9894459, 'binary_f1_score': 0.98743963}
confusion matrix:
      0     1
0  1500    16
1    23  1533
---- Validation: 
scalar performance:
{'acc': 0.757764, 'precision': 0.790822, 'recall': 0.7553725, 'specificity': 0.7553725, 'f1': 0.7494957, 'auroc': 0.87944674, 'binary_precision': 0.88544154, 'binary_recall': 0.58425194, 'binary_specificity': 0.9264931, 'binary_f1_score': 0.7039848}
confusion matrix:
     0    1
0  605   48
1  264  371
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8534884, 'precision': 0.8562707, 'recall': 0.8534884, 'specificity': 0.8534884, 'f1': 0.85320175, 'auroc': 0.91781497, 'binary_precision': 0.8877551, 'binary_recall': 0.80930233, 'binary_specificity': 0.89767444, 'binary_f1_score': 0.84671533}
confusion matrix:
     0    1
0  193   22
1   41  174
early stop counter: 4
val acc:0.7577639818191528, best validation acc: 0.8524844646453857, corresponding to test acc:                         0.8232558369636536 / 0.8581395149230957
after epoch: 12,now: 2024-07-23 03:01:33.512992,epoch time: 0:01:20.116267,used: 0:17:28.743781,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_02_44_04_seed_0_22769265
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9892578, 'precision': 0.9892578, 'recall': 0.9893327, 'specificity': 0.9893327, 'f1': 0.98925734, 'auroc': 0.9992802, 'binary_precision': 0.9954427, 'binary_recall': 0.98327976, 'binary_specificity': 0.99538565, 'binary_f1_score': 0.9893238}
confusion matrix:
      0     1
0  1510     7
1    26  1529
---- Validation: 
scalar performance:
{'acc': 0.7996894, 'precision': 0.8215333, 'recall': 0.7978488, 'specificity': 0.7978488, 'f1': 0.7955163, 'auroc': 0.89964426, 'binary_precision': 0.90191895, 'binary_recall': 0.66614175, 'binary_specificity': 0.9295559, 'binary_f1_score': 0.7663044}
confusion matrix:
     0    1
0  607   46
1  212  423
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.82325584, 'precision': 0.8546845, 'recall': 0.82325584, 'specificity': 0.82325584, 'f1': 0.8192518, 'auroc': 0.9160627, 'binary_precision': 0.9602649, 'binary_recall': 0.6744186, 'binary_specificity': 0.97209305, 'binary_f1_score': 0.79234976}
confusion matrix:
     0    1
0  209    6
1   70  145
early stop counter: 5
val acc:0.7996894121170044, best validation acc: 0.8524844646453857, corresponding to test acc:                         0.8232558369636536 / 0.8581395149230957
after epoch: 13,now: 2024-07-23 03:02:52.661225,epoch time: 0:01:19.148233,used: 0:18:47.892014,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_02_44_04_seed_0_22769265
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9895833, 'precision': 0.98956764, 'recall': 0.9895992, 'specificity': 0.9895992, 'f1': 0.9895817, 'auroc': 0.99932253, 'binary_precision': 0.9909852, 'binary_recall': 0.9884393, 'binary_specificity': 0.9907591, 'binary_f1_score': 0.9897106}
confusion matrix:
      0     1
0  1501    14
1    18  1539
---- Validation: 
scalar performance:
{'acc': 0.8742236, 'precision': 0.87714934, 'recall': 0.873613, 'specificity': 0.873613, 'f1': 0.87382936, 'auroc': 0.9284393, 'binary_precision': 0.9070568, 'binary_recall': 0.82992125, 'binary_specificity': 0.91730475, 'binary_f1_score': 0.86677635}
confusion matrix:
     0    1
0  599   54
1  108  527
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8697674, 'precision': 0.8729951, 'recall': 0.8697674, 'specificity': 0.8697674, 'f1': 0.8694851, 'auroc': 0.92930233, 'binary_precision': 0.9076923, 'binary_recall': 0.82325584, 'binary_specificity': 0.9162791, 'binary_f1_score': 0.86341465}
confusion matrix:
     0    1
0  197   18
1   38  177
new oracle model saved
better model found
persisted
after epoch: 14,now: 2024-07-23 03:04:11.999022,epoch time: 0:01:19.337797,used: 0:20:07.229811,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_02_44_04_seed_0_22769265
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9892578, 'precision': 0.9893067, 'recall': 0.9893849, 'specificity': 0.9893849, 'f1': 0.98925763, 'auroc': 0.99974525, 'binary_precision': 0.9986911, 'binary_recall': 0.9800899, 'binary_specificity': 0.9986799, 'binary_f1_score': 0.98930305}
confusion matrix:
      0     1
0  1513     2
1    31  1526
---- Validation: 
scalar performance:
{'acc': 0.7181677, 'precision': 0.7947588, 'recall': 0.7145639, 'specificity': 0.7145639, 'f1': 0.6963841, 'auroc': 0.9092933, 'binary_precision': 0.9415584, 'binary_recall': 0.4566929, 'binary_specificity': 0.97243494, 'binary_f1_score': 0.6150583}
confusion matrix:
     0    1
0  635   18
1  345  290
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7953488, 'precision': 0.84855366, 'recall': 0.7953489, 'specificity': 0.7953489, 'f1': 0.7872293, 'auroc': 0.91469985, 'binary_precision': 0.9847328, 'binary_recall': 0.6, 'binary_specificity': 0.9906977, 'binary_f1_score': 0.7456648}
confusion matrix:
     0    1
0  213    2
1   86  129
early stop counter: 1
val acc:0.7181677222251892, best validation acc: 0.8742235898971558, corresponding to test acc:                         0.869767427444458 / 0.869767427444458
after epoch: 15,now: 2024-07-23 03:05:30.077540,epoch time: 0:01:18.078518,used: 0:21:25.308329,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_02_44_04_seed_0_22769265
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9765625, 'precision': 0.97764695, 'recall': 0.97627324, 'specificity': 0.97627324, 'f1': 0.9765346, 'auroc': 0.9996222, 'binary_precision': 0.9580506, 'binary_recall': 0.997431, 'binary_specificity': 0.9551155, 'binary_f1_score': 0.9773443}
confusion matrix:
      0     1
0  1447    68
1     4  1553
---- Validation: 
scalar performance:
{'acc': 0.882764, 'precision': 0.88368756, 'recall': 0.8824264, 'specificity': 0.8824264, 'f1': 0.88260764, 'auroc': 0.9222631, 'binary_precision': 0.8993399, 'binary_recall': 0.8582677, 'binary_specificity': 0.906585, 'binary_f1_score': 0.8783239}
confusion matrix:
     0    1
0  592   61
1   90  545
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.872093, 'precision': 0.88344926, 'recall': 0.872093, 'specificity': 0.872093, 'f1': 0.87113893, 'auroc': 0.9211465, 'binary_precision': 0.9494382, 'binary_recall': 0.7860465, 'binary_specificity': 0.95813954, 'binary_f1_score': 0.8600509}
confusion matrix:
     0    1
0  206    9
1   46  169
new oracle model saved
better model found
persisted
after epoch: 16,now: 2024-07-23 03:06:48.369195,epoch time: 0:01:18.291655,used: 0:22:43.599984,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_02_44_04_seed_0_22769265
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9876302, 'precision': 0.9877677, 'recall': 0.9875518, 'specificity': 0.9875518, 'f1': 0.98762584, 'auroc': 0.9992912, 'binary_precision': 0.98221093, 'binary_recall': 0.99357325, 'binary_specificity': 0.98153037, 'binary_f1_score': 0.9878594}
confusion matrix:
      0     1
0  1488    28
1    10  1546
---- Validation: 
scalar performance:
{'acc': 0.89829195, 'precision': 0.8989297, 'recall': 0.8980224, 'specificity': 0.8980224, 'f1': 0.8981887, 'auroc': 0.9356356, 'binary_precision': 0.9117647, 'binary_recall': 0.87874013, 'binary_specificity': 0.91730475, 'binary_f1_score': 0.8949478}
confusion matrix:
     0    1
0  599   54
1   77  558
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8651163, 'precision': 0.87338775, 'recall': 0.8651163, 'specificity': 0.8651163, 'f1': 0.8643651, 'auroc': 0.9259924, 'binary_precision': 0.92896175, 'binary_recall': 0.7906977, 'binary_specificity': 0.9395349, 'binary_f1_score': 0.8542714}
confusion matrix:
     0    1
0  202   13
1   45  170
better model found
persisted
after epoch: 17,now: 2024-07-23 03:08:06.722586,epoch time: 0:01:18.353391,used: 0:24:01.953375,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_02_44_04_seed_0_22769265
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9895833, 'precision': 0.9895973, 'recall': 0.98967034, 'specificity': 0.98967034, 'f1': 0.989583, 'auroc': 0.9988792, 'binary_precision': 0.99673843, 'binary_recall': 0.98263663, 'binary_specificity': 0.99670404, 'binary_f1_score': 0.98963726}
confusion matrix:
      0     1
0  1512     5
1    27  1528
---- Validation: 
scalar performance:
{'acc': 0.64829195, 'precision': 0.75728995, 'recall': 0.64367604, 'specificity': 0.64367604, 'f1': 0.6025382, 'auroc': 0.8780745, 'binary_precision': 0.9212963, 'binary_recall': 0.3133858, 'binary_specificity': 0.9739663, 'binary_f1_score': 0.4676851}
confusion matrix:
     0    1
0  636   17
1  436  199
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.74651164, 'precision': 0.8063172, 'recall': 0.74651164, 'specificity': 0.74651164, 'f1': 0.73350394, 'auroc': 0.89687395, 'binary_precision': 0.94166666, 'binary_recall': 0.5255814, 'binary_specificity': 0.96744186, 'binary_f1_score': 0.6746269}
confusion matrix:
     0    1
0  208    7
1  102  113
early stop counter: 1
val acc:0.6482919454574585, best validation acc: 0.8982919454574585, corresponding to test acc:                         0.8651162981987 / 0.8720930218696594
after epoch: 18,now: 2024-07-23 03:09:24.491580,epoch time: 0:01:17.768994,used: 0:25:19.722369,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_02_44_04_seed_0_22769265
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.98860675, 'precision': 0.9888307, 'recall': 0.98850435, 'specificity': 0.98850435, 'f1': 0.9886019, 'auroc': 0.99980927, 'binary_precision': 0.98101264, 'binary_recall': 0.99678457, 'binary_specificity': 0.98022413, 'binary_f1_score': 0.9888357}
confusion matrix:
      0     1
0  1487    30
1     5  1550
---- Validation: 
scalar performance:
{'acc': 0.86102486, 'precision': 0.86413324, 'recall': 0.8603791, 'specificity': 0.8603791, 'f1': 0.860552, 'auroc': 0.9122307, 'binary_precision': 0.89446366, 'binary_recall': 0.8141732, 'binary_specificity': 0.906585, 'binary_f1_score': 0.85243195}
confusion matrix:
     0    1
0  592   61
1  118  517
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8860465, 'precision': 0.8870597, 'recall': 0.8860465, 'specificity': 0.8860465, 'f1': 0.8859719, 'auroc': 0.9302325, 'binary_precision': 0.90686274, 'binary_recall': 0.8604651, 'binary_specificity': 0.9116279, 'binary_f1_score': 0.8830549}
confusion matrix:
     0    1
0  196   19
1   30  185
new oracle model saved
early stop counter: 2
val acc:0.8610248565673828, best validation acc: 0.8982919454574585, corresponding to test acc:                         0.8651162981987 / 0.8860465288162231
after epoch: 19,now: 2024-07-23 03:10:42.719237,epoch time: 0:01:18.227657,used: 0:26:37.950026,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_02_44_04_seed_0_22769265
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9902344, 'precision': 0.9902933, 'recall': 0.9903399, 'specificity': 0.9903399, 'f1': 0.9902343, 'auroc': 0.9998801, 'binary_precision': 0.9993447, 'binary_recall': 0.9813385, 'binary_specificity': 0.99934125, 'binary_f1_score': 0.99025977}
confusion matrix:
      0     1
0  1517     1
1    29  1525
---- Validation: 
scalar performance:
{'acc': 0.6498447, 'precision': 0.75458056, 'recall': 0.6452943, 'specificity': 0.6452943, 'f1': 0.6056919, 'auroc': 0.8507512, 'binary_precision': 0.9144144, 'binary_recall': 0.31968504, 'binary_specificity': 0.9709035, 'binary_f1_score': 0.47374564}
confusion matrix:
     0    1
0  634   19
1  432  203
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.772093, 'precision': 0.83639574, 'recall': 0.77209306, 'specificity': 0.77209306, 'f1': 0.7606553, 'auroc': 0.9233315, 'binary_precision': 0.9834711, 'binary_recall': 0.5534884, 'binary_specificity': 0.9906977, 'binary_f1_score': 0.7083334}
confusion matrix:
     0    1
0  213    2
1   96  119
early stop counter: 3
val acc:0.6498447060585022, best validation acc: 0.8982919454574585, corresponding to test acc:                         0.8651162981987 / 0.8860465288162231
after epoch: 20,now: 2024-07-23 03:12:00.468221,epoch time: 0:01:17.748984,used: 0:27:55.699010,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_02_44_04_seed_0_22769265
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9899089, 'precision': 0.9898894, 'recall': 0.9899622, 'specificity': 0.9899622, 'f1': 0.9899081, 'auroc': 0.9997431, 'binary_precision': 0.9941672, 'binary_recall': 0.9858612, 'binary_specificity': 0.9940633, 'binary_f1_score': 0.9899968}
confusion matrix:
      0     1
0  1507     9
1    22  1534
---- Validation: 
scalar performance:
{'acc': 0.6467391, 'precision': 0.7683524, 'recall': 0.641971, 'specificity': 0.641971, 'f1': 0.5973736, 'auroc': 0.8915912, 'binary_precision': 0.94554454, 'binary_recall': 0.3007874, 'binary_specificity': 0.98315465, 'binary_f1_score': 0.45639187}
confusion matrix:
     0    1
0  642   11
1  444  191
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7883721, 'precision': 0.8448365, 'recall': 0.7883721, 'specificity': 0.7883721, 'f1': 0.7793392, 'auroc': 0.9270308, 'binary_precision': 0.984375, 'binary_recall': 0.5860465, 'binary_specificity': 0.9906977, 'binary_f1_score': 0.7346939}
confusion matrix:
     0    1
0  213    2
1   89  126
early stop counter: 4
val acc:0.64673912525177, best validation acc: 0.8982919454574585, corresponding to test acc:                         0.8651162981987 / 0.8860465288162231
after epoch: 21,now: 2024-07-23 03:13:17.716065,epoch time: 0:01:17.247844,used: 0:29:12.946854,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_02_44_04_seed_0_22769265
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.98502606, 'precision': 0.98536193, 'recall': 0.98488784, 'specificity': 0.98488784, 'f1': 0.98501784, 'auroc': 0.99959177, 'binary_precision': 0.9754408, 'binary_recall': 0.9955013, 'binary_specificity': 0.9742744, 'binary_f1_score': 0.985369}
confusion matrix:
      0     1
0  1477    39
1     7  1549
---- Validation: 
scalar performance:
{'acc': 0.867236, 'precision': 0.87418824, 'recall': 0.86628765, 'specificity': 0.86628765, 'f1': 0.8663815, 'auroc': 0.93227375, 'binary_precision': 0.9218182, 'binary_recall': 0.7984252, 'binary_specificity': 0.9341501, 'binary_f1_score': 0.85569614}
confusion matrix:
     0    1
0  610   43
1  128  507
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8534884, 'precision': 0.86427677, 'recall': 0.8534884, 'specificity': 0.8534884, 'f1': 0.85239553, 'auroc': 0.91805303, 'binary_precision': 0.9269663, 'binary_recall': 0.76744187, 'binary_specificity': 0.9395349, 'binary_f1_score': 0.8396947}
confusion matrix:
     0    1
0  202   13
1   50  165
early stop counter: 5
val acc:0.8672360181808472, best validation acc: 0.8982919454574585, corresponding to test acc:                         0.8651162981987 / 0.8860465288162231
after epoch: 22,now: 2024-07-23 03:14:35.737721,epoch time: 0:01:18.021656,used: 0:30:30.968510,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_02_44_04_seed_0_22769265
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.99283856, 'precision': 0.9928994, 'recall': 0.99279493, 'specificity': 0.99279493, 'f1': 0.9928366, 'auroc': 0.99978167, 'binary_precision': 0.98978287, 'binary_recall': 0.99614394, 'binary_specificity': 0.9894459, 'binary_f1_score': 0.9929532}
confusion matrix:
      0     1
0  1500    16
1     6  1550
---- Validation: 
scalar performance:
{'acc': 0.86024845, 'precision': 0.86855865, 'recall': 0.8592011, 'specificity': 0.8592011, 'f1': 0.85918367, 'auroc': 0.93483984, 'binary_precision': 0.92051756, 'binary_recall': 0.784252, 'binary_specificity': 0.9341501, 'binary_f1_score': 0.8469388}
confusion matrix:
     0    1
0  610   43
1  137  498
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8511628, 'precision': 0.86129224, 'recall': 0.8511628, 'specificity': 0.8511628, 'f1': 0.8501122, 'auroc': 0.91861546, 'binary_precision': 0.92178774, 'binary_recall': 0.76744187, 'binary_specificity': 0.9348837, 'binary_f1_score': 0.83756346}
confusion matrix:
     0    1
0  201   14
1   50  165
early stop counter: 6
val acc:0.8602484464645386, best validation acc: 0.8982919454574585, corresponding to test acc:                         0.8651162981987 / 0.8860465288162231
after epoch: 23,now: 2024-07-23 03:15:54.537206,epoch time: 0:01:18.799485,used: 0:31:49.767995,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_02_44_04_seed_0_22769265
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9788411, 'precision': 0.9799145, 'recall': 0.97854304, 'specificity': 0.97854304, 'f1': 0.97881544, 'auroc': 0.99987113, 'binary_precision': 0.9605182, 'binary_recall': 0.9993582, 'binary_specificity': 0.95772785, 'binary_f1_score': 0.97955334}
confusion matrix:
      0     1
0  1450    64
1     1  1557
---- Validation: 
scalar performance:
{'acc': 0.8121118, 'precision': 0.8124307, 'recall': 0.81185806, 'specificity': 0.81185806, 'f1': 0.81194806, 'auroc': 0.88399756, 'binary_precision': 0.8195122, 'binary_recall': 0.7937008, 'binary_specificity': 0.8300153, 'binary_f1_score': 0.8064}
confusion matrix:
     0    1
0  542  111
1  131  504
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8604651, 'precision': 0.8609649, 'recall': 0.8604651, 'specificity': 0.8604651, 'f1': 0.86041677, 'auroc': 0.93313146, 'binary_precision': 0.84753364, 'binary_recall': 0.87906975, 'binary_specificity': 0.8418605, 'binary_f1_score': 0.8630137}
confusion matrix:
     0    1
0  181   34
1   26  189
early stop counter: 7
val acc:0.8121117949485779, best validation acc: 0.8982919454574585, corresponding to test acc:                         0.8651162981987 / 0.8860465288162231
after epoch: 24,now: 2024-07-23 03:17:13.373587,epoch time: 0:01:18.836381,used: 0:33:08.604376,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_02_44_04_seed_0_22769265
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.9938151, 'precision': 0.9937915, 'recall': 0.9938629, 'specificity': 0.9938629, 'f1': 0.99381447, 'auroc': 0.9997275, 'binary_precision': 0.9974127, 'binary_recall': 0.9903661, 'binary_specificity': 0.99735975, 'binary_f1_score': 0.9938769}
confusion matrix:
      0     1
0  1511     4
1    15  1542
---- Validation: 
scalar performance:
{'acc': 0.70962733, 'precision': 0.78744614, 'recall': 0.7059459, 'specificity': 0.7059459, 'f1': 0.6861893, 'auroc': 0.86934924, 'binary_precision': 0.9335548, 'binary_recall': 0.4425197, 'binary_specificity': 0.96937215, 'binary_f1_score': 0.6004273}
confusion matrix:
     0    1
0  633   20
1  354  281
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8, 'precision': 0.85404277, 'recall': 0.79999995, 'specificity': 0.79999995, 'f1': 0.79206496, 'auroc': 0.93189836, 'binary_precision': 0.99236643, 'binary_recall': 0.60465115, 'binary_specificity': 0.9953488, 'binary_f1_score': 0.7514451}
confusion matrix:
     0    1
0  214    1
1   85  130
early stop counter: 8
val acc:0.7096273303031921, best validation acc: 0.8982919454574585, corresponding to test acc:                         0.8651162981987 / 0.8860465288162231
after epoch: 25,now: 2024-07-23 03:18:32.772464,epoch time: 0:01:19.398877,used: 0:34:28.003253,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_02_44_04_seed_0_22769265
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9895833, 'precision': 0.98967075, 'recall': 0.98971057, 'specificity': 0.98971057, 'f1': 0.98958325, 'auroc': 0.99990547, 'binary_precision': 1.0, 'binary_recall': 0.9794212, 'binary_specificity': 1.0, 'binary_f1_score': 0.98960364}
confusion matrix:
      0     1
0  1517     0
1    32  1523
---- Validation: 
scalar performance:
{'acc': 0.5551242, 'precision': 0.73172516, 'recall': 0.5489274, 'specificity': 0.5489274, 'f1': 0.44147608, 'auroc': 0.89518696, 'binary_precision': 0.9305556, 'binary_recall': 0.105511814, 'binary_specificity': 0.992343, 'binary_f1_score': 0.18953325}
confusion matrix:
     0   1
0  648   5
1  568  67
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.53255814, 'precision': 0.75841343, 'recall': 0.53255814, 'specificity': 0.53255814, 'f1': 0.4018644, 'auroc': 0.9131206, 'binary_precision': 1.0, 'binary_recall': 0.06511628, 'binary_specificity': 1.0, 'binary_f1_score': 0.12227074}
confusion matrix:
     0   1
0  215   0
1  201  14
early stop counter: 9
val acc:0.5551242232322693, best validation acc: 0.8982919454574585, corresponding to test acc:                         0.8651162981987 / 0.8860465288162231
after epoch: 26,now: 2024-07-23 03:19:51.474277,epoch time: 0:01:18.701813,used: 0:35:46.705066,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_02_44_04_seed_0_22769265
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.99576825, 'precision': 0.995772, 'recall': 0.995763, 'specificity': 0.995763, 'f1': 0.9957674, 'auroc': 0.99990845, 'binary_precision': 0.99550706, 'binary_recall': 0.99614644, 'binary_specificity': 0.99537957, 'binary_f1_score': 0.99582666}
confusion matrix:
      0     1
0  1508     7
1     6  1551
---- Validation: 
scalar performance:
{'acc': 0.76086956, 'precision': 0.8194964, 'recall': 0.75784934, 'specificity': 0.75784934, 'f1': 0.7479132, 'auroc': 0.93165886, 'binary_precision': 0.9529086, 'binary_recall': 0.5417323, 'binary_specificity': 0.9739663, 'binary_f1_score': 0.69076306}
confusion matrix:
     0    1
0  636   17
1  291  344
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8, 'precision': 0.85404277, 'recall': 0.79999995, 'specificity': 0.79999995, 'f1': 0.79206496, 'auroc': 0.9276582, 'binary_precision': 0.99236643, 'binary_recall': 0.60465115, 'binary_specificity': 0.9953488, 'binary_f1_score': 0.7514451}
confusion matrix:
     0    1
0  214    1
1   85  130
early stop counter: 10
val acc:0.760869562625885, best validation acc: 0.8982919454574585, corresponding to test acc:                         0.8651162981987 / 0.8860465288162231
after epoch: 27,now: 2024-07-23 03:21:10.365133,epoch time: 0:01:18.890856,used: 0:37:05.595922,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_02_44_04_seed_0_22769265
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.99283856, 'precision': 0.9929192, 'recall': 0.9927838, 'specificity': 0.9927838, 'f1': 0.99283636, 'auroc': 0.99985504, 'binary_precision': 0.98916507, 'binary_recall': 0.9967887, 'binary_specificity': 0.9887789, 'binary_f1_score': 0.99296224}
confusion matrix:
      0     1
0  1498    17
1     5  1552
---- Validation: 
scalar performance:
{'acc': 0.83462733, 'precision': 0.8457104, 'recall': 0.8333687, 'specificity': 0.8333687, 'f1': 0.83289874, 'auroc': 0.91857624, 'binary_precision': 0.90421456, 'binary_recall': 0.7433071, 'binary_specificity': 0.9234303, 'binary_f1_score': 0.8159032}
confusion matrix:
     0    1
0  603   50
1  163  472
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.86744183, 'precision': 0.8709811, 'recall': 0.8674419, 'specificity': 0.8674419, 'f1': 0.8671249, 'auroc': 0.92558146, 'binary_precision': 0.9072165, 'binary_recall': 0.81860465, 'binary_specificity': 0.9162791, 'binary_f1_score': 0.8606357}
confusion matrix:
     0    1
0  197   18
1   39  176
early stop counter: 11
val acc:0.8346273303031921, best validation acc: 0.8982919454574585, corresponding to test acc:                         0.8651162981987 / 0.8860465288162231
after epoch: 28,now: 2024-07-23 03:22:29.430709,epoch time: 0:01:19.065576,used: 0:38:24.661498,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_02_44_04_seed_0_22769265
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9954427, 'precision': 0.9954245, 'recall': 0.99546736, 'specificity': 0.99546736, 'f1': 0.99544215, 'auroc': 0.9996965, 'binary_precision': 0.99741936, 'binary_recall': 0.99357325, 'binary_specificity': 0.9973615, 'binary_f1_score': 0.9954926}
confusion matrix:
      0     1
0  1512     4
1    10  1546
---- Validation: 
scalar performance:
{'acc': 0.72748446, 'precision': 0.7951093, 'recall': 0.7240996, 'specificity': 0.7240996, 'f1': 0.70895356, 'auroc': 0.8770882, 'binary_precision': 0.93292683, 'binary_recall': 0.48188975, 'binary_specificity': 0.96630937, 'binary_f1_score': 0.635514}
confusion matrix:
     0    1
0  631   22
1  329  306
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7976744, 'precision': 0.8364632, 'recall': 0.7976744, 'specificity': 0.7976744, 'f1': 0.79167014, 'auroc': 0.9182044, 'binary_precision': 0.9507042, 'binary_recall': 0.627907, 'binary_specificity': 0.96744186, 'binary_f1_score': 0.75630254}
confusion matrix:
     0    1
0  208    7
1   80  135
early stop counter: 12
val acc:0.7274844646453857, best validation acc: 0.8982919454574585, corresponding to test acc:                         0.8651162981987 / 0.8860465288162231
after epoch: 29,now: 2024-07-23 03:23:48.338455,epoch time: 0:01:18.907746,used: 0:39:43.569244,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_02_44_04_seed_0_22769265
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.9921875, 'precision': 0.99224424, 'recall': 0.9921483, 'specificity': 0.9921483, 'f1': 0.9921857, 'auroc': 0.9997308, 'binary_precision': 0.98913044, 'binary_recall': 0.9954955, 'binary_specificity': 0.98880106, 'binary_f1_score': 0.9923027}
confusion matrix:
      0     1
0  1501    17
1     7  1547
---- Validation: 
scalar performance:
{'acc': 0.8439441, 'precision': 0.8566444, 'recall': 0.84262216, 'specificity': 0.84262216, 'f1': 0.8421583, 'auroc': 0.9099438, 'binary_precision': 0.92054266, 'binary_recall': 0.7480315, 'binary_specificity': 0.9372129, 'binary_f1_score': 0.82536924}
confusion matrix:
     0    1
0  612   41
1  160  475
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8534884, 'precision': 0.86968327, 'recall': 0.8534884, 'specificity': 0.8534884, 'f1': 0.851866, 'auroc': 0.9251487, 'binary_precision': 0.9470588, 'binary_recall': 0.74883723, 'binary_specificity': 0.95813954, 'binary_f1_score': 0.8363636}
confusion matrix:
     0    1
0  206    9
1   54  161
early stop counter: 13
val acc:0.8439440727233887, best validation acc: 0.8982919454574585, corresponding to test acc:                         0.8651162981987 / 0.8860465288162231
after epoch: 30,now: 2024-07-23 03:25:06.868756,epoch time: 0:01:18.530301,used: 0:41:02.099545,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_02_44_04_seed_0_22769265
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 0:41:02.099545 at 2024-07-23 03:25:06.868756
persisted model performance metric: 

scalar performance:
{'acc': 0.8651163, 'precision': 0.87338775, 'recall': 0.8651163, 'specificity': 0.8651163, 'f1': 0.8643651, 'auroc': 0.9259924, 'binary_precision': 0.92896175, 'binary_recall': 0.7906977, 'binary_specificity': 0.9395349, 'binary_f1_score': 0.8542714}
confusion matrix:
     0    1
0  202   13
1   45  170
oracle model performance metric: 

scalar performance:
{'acc': 0.8860465, 'precision': 0.8870597, 'recall': 0.8860465, 'specificity': 0.8860465, 'f1': 0.8859719, 'auroc': 0.9302325, 'binary_precision': 0.90686274, 'binary_recall': 0.8604651, 'binary_specificity': 0.9116279, 'binary_f1_score': 0.8830549}
confusion matrix:
     0    1
0  196   19
1   30  185
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_dial_lr1e5_bs16_allfreeze_2024-07-22_23-46-53/rule_results/5.csv
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_dial_lr1e5_bs16_allfreeze_2024-07-22_23-46-53/rule_results/5.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_dial_lr1e5_bs16_allfreeze_2024-07-22_23-46-53/confusion_matrix/5.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 455936 KiB |  26075 MiB |  70809 GiB |  70808 GiB |
|       from large pool | 415383 KiB |  26030 MiB |  70366 GiB |  70366 GiB |
|       from small pool |  40553 KiB |     56 MiB |    442 GiB |    442 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 455936 KiB |  26075 MiB |  70809 GiB |  70808 GiB |
|       from large pool | 415383 KiB |  26030 MiB |  70366 GiB |  70366 GiB |
|       from small pool |  40553 KiB |     56 MiB |    442 GiB |    442 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 447480 KiB |  26071 MiB |  70794 GiB |  70793 GiB |
|       from large pool | 407075 KiB |  26026 MiB |  70352 GiB |  70352 GiB |
|       from small pool |  40405 KiB |     56 MiB |    441 GiB |    441 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  27748 MiB |  27748 MiB |  27748 MiB |      0 B   |
|       from large pool |  27680 MiB |  27680 MiB |  27680 MiB |      0 B   |
|       from small pool |     68 MiB |     68 MiB |     68 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory | 785151 KiB |   1678 MiB |  33156 GiB |  33155 GiB |
|       from large pool | 770409 KiB |   1668 MiB |  32711 GiB |  32710 GiB |
|       from small pool |  14742 KiB |     19 MiB |    444 GiB |    444 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    1220    |    2568    |    6430 K  |    6429 K  |
|       from large pool |     187    |    1413    |    3248 K  |    3247 K  |
|       from small pool |    1033    |    1329    |    3182 K  |    3181 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    1220    |    2568    |    6430 K  |    6429 K  |
|       from large pool |     187    |    1413    |    3248 K  |    3247 K  |
|       from small pool |    1033    |    1329    |    3182 K  |    3181 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     834    |     834    |     834    |       0    |
|       from large pool |     800    |     800    |     800    |       0    |
|       from small pool |      34    |      34    |      34    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     103    |     848    |    4735 K  |    4734 K  |
|       from large pool |      39    |     799    |    2905 K  |    2905 K  |
|       from small pool |      64    |     148    |    1829 K  |    1829 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  26075 MiB |  70809 GiB |  70809 GiB |
|       from large pool |  16640 KiB |  26030 MiB |  70366 GiB |  70366 GiB |
|       from small pool |      0 KiB |     56 MiB |    442 GiB |    442 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  26075 MiB |  70809 GiB |  70809 GiB |
|       from large pool |  16640 KiB |  26030 MiB |  70366 GiB |  70366 GiB |
|       from small pool |      0 KiB |     56 MiB |    442 GiB |    442 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  26071 MiB |  70794 GiB |  70794 GiB |
|       from large pool |  16640 KiB |  26026 MiB |  70352 GiB |  70352 GiB |
|       from small pool |      0 KiB |     56 MiB |    441 GiB |    441 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1212 MiB |  27748 MiB |  27748 MiB |  26536 MiB |
|       from large pool |   1158 MiB |  27680 MiB |  27680 MiB |  26522 MiB |
|       from small pool |     54 MiB |     68 MiB |     68 MiB |     14 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |   3840 KiB |   1678 MiB |  33156 GiB |  33156 GiB |
|       from large pool |   3840 KiB |   1668 MiB |  32711 GiB |  32711 GiB |
|       from small pool |      0 KiB |     29 MiB |    444 GiB |    444 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    2568    |    6430 K  |    6430 K  |
|       from large pool |       2    |    1413    |    3248 K  |    3248 K  |
|       from small pool |       0    |    1329    |    3182 K  |    3182 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    2568    |    6430 K  |    6430 K  |
|       from large pool |       2    |    1413    |    3248 K  |    3248 K  |
|       from small pool |       0    |    1329    |    3182 K  |    3182 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      66    |     834    |     834    |     768    |
|       from large pool |      39    |     800    |     800    |     761    |
|       from small pool |      27    |      34    |      34    |       7    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       1    |     848    |    4735 K  |    4735 K  |
|       from large pool |       1    |     799    |    2905 K  |    2905 K  |
|       from small pool |       0    |     148    |    1830 K  |    1830 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  26075 MiB |  70809 GiB |  70809 GiB |
|       from large pool |  16640 KiB |  26030 MiB |  70366 GiB |  70366 GiB |
|       from small pool |      0 KiB |     56 MiB |    442 GiB |    442 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  26075 MiB |  70809 GiB |  70809 GiB |
|       from large pool |  16640 KiB |  26030 MiB |  70366 GiB |  70366 GiB |
|       from small pool |      0 KiB |     56 MiB |    442 GiB |    442 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  26071 MiB |  70794 GiB |  70794 GiB |
|       from large pool |  16640 KiB |  26026 MiB |  70352 GiB |  70352 GiB |
|       from small pool |      0 KiB |     56 MiB |    441 GiB |    441 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1212 MiB |  27748 MiB |  27748 MiB |  26536 MiB |
|       from large pool |   1158 MiB |  27680 MiB |  27680 MiB |  26522 MiB |
|       from small pool |     54 MiB |     68 MiB |     68 MiB |     14 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |   3840 KiB |   1678 MiB |  33156 GiB |  33156 GiB |
|       from large pool |   3840 KiB |   1668 MiB |  32711 GiB |  32711 GiB |
|       from small pool |      0 KiB |     29 MiB |    444 GiB |    444 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    2568    |    6430 K  |    6430 K  |
|       from large pool |       2    |    1413    |    3248 K  |    3248 K  |
|       from small pool |       0    |    1329    |    3182 K  |    3182 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    2568    |    6430 K  |    6430 K  |
|       from large pool |       2    |    1413    |    3248 K  |    3248 K  |
|       from small pool |       0    |    1329    |    3182 K  |    3182 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      66    |     834    |     834    |     768    |
|       from large pool |      39    |     800    |     800    |     761    |
|       from small pool |      27    |      34    |      34    |       7    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       1    |     848    |    4735 K  |    4735 K  |
|       from large pool |       1    |     799    |    2905 K  |    2905 K  |
|       from small pool |       0    |     148    |    1830 K  |    1830 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'888c1ef2'
model name: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_03_26_26_seed_1_22769265

 Experiment start at: 2024-07-23 03:26:26.032968
before training, model accuracy: 0.6177777647972107
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9352214, 'precision': 0.93535393, 'recall': 0.93538994, 'specificity': 0.93538994, 'f1': 0.9352212, 'auroc': 0.9745058, 'binary_precision': 0.94733375, 'binary_recall': 0.92362005, 'binary_specificity': 0.9471598, 'binary_f1_score': 0.93532664}
confusion matrix:
      0     1
0  1434    80
1   119  1439
---- Validation: 
scalar performance:
{'acc': 0.81342703, 'precision': 0.81508255, 'recall': 0.8128008, 'specificity': 0.8128008, 'f1': 0.81293046, 'auroc': 0.89058834, 'binary_precision': 0.83418804, 'binary_recall': 0.7746032, 'binary_specificity': 0.85099846, 'binary_f1_score': 0.8032922}
confusion matrix:
     0    1
0  554   97
1  142  488
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8288889, 'precision': 0.82967687, 'recall': 0.8288889, 'specificity': 0.8288889, 'f1': 0.8287866, 'auroc': 0.9113679, 'binary_precision': 0.8457944, 'binary_recall': 0.80444443, 'binary_specificity': 0.85333335, 'binary_f1_score': 0.8246014}
confusion matrix:
     0    1
0  192   33
1   44  181
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-23 03:27:49.834922,epoch time: 0:01:23.801954,used: 0:01:23.801954,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_03_26_26_seed_1_22769265
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.95670575, 'precision': 0.9567394, 'recall': 0.9568178, 'specificity': 0.9568178, 'f1': 0.95670474, 'auroc': 0.9893813, 'binary_precision': 0.96535945, 'binary_recall': 0.9486191, 'binary_specificity': 0.9650165, 'binary_f1_score': 0.9569161}
confusion matrix:
      0     1
0  1462    53
1    80  1477
---- Validation: 
scalar performance:
{'acc': 0.79703355, 'precision': 0.7991254, 'recall': 0.7976959, 'specificity': 0.7976959, 'f1': 0.796882, 'auroc': 0.88514614, 'binary_precision': 0.7696793, 'binary_recall': 0.83809525, 'binary_specificity': 0.75729644, 'binary_f1_score': 0.8024317}
confusion matrix:
     0    1
0  493  158
1  102  528
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8111111, 'precision': 0.8128973, 'recall': 0.8111111, 'specificity': 0.8111111, 'f1': 0.8108412, 'auroc': 0.8994173, 'binary_precision': 0.7892562, 'binary_recall': 0.8488889, 'binary_specificity': 0.7733333, 'binary_f1_score': 0.8179872}
confusion matrix:
     0    1
0  174   51
1   34  191
early stop counter: 1
val acc:0.7970335483551025, best validation acc: 0.8134270310401917, corresponding to test acc:                         0.8288888931274414 / 0.8288888931274414
after epoch: 2,now: 2024-07-23 03:29:11.031131,epoch time: 0:01:21.196209,used: 0:02:44.998163,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_03_26_26_seed_1_22769265
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.97233075, 'precision': 0.9723934, 'recall': 0.97227657, 'specificity': 0.97227657, 'f1': 0.9723225, 'auroc': 0.99586666, 'binary_precision': 0.96938777, 'binary_recall': 0.97623634, 'binary_specificity': 0.96831685, 'binary_f1_score': 0.9728}
confusion matrix:
      0     1
0  1467    48
1    37  1520
---- Validation: 
scalar performance:
{'acc': 0.82591724, 'precision': 0.8259366, 'recall': 0.82578087, 'specificity': 0.82578087, 'f1': 0.82583404, 'auroc': 0.89805424, 'binary_precision': 0.82664526, 'binary_recall': 0.8174603, 'binary_specificity': 0.8341014, 'binary_f1_score': 0.8220271}
confusion matrix:
     0    1
0  543  108
1  115  515
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.82222223, 'precision': 0.8253325, 'recall': 0.82222223, 'specificity': 0.82222223, 'f1': 0.8217963, 'auroc': 0.92146176, 'binary_precision': 0.79352224, 'binary_recall': 0.8711111, 'binary_specificity': 0.7733333, 'binary_f1_score': 0.8305085}
confusion matrix:
     0    1
0  174   51
1   29  196
better model found
persisted
after epoch: 3,now: 2024-07-23 03:30:32.677855,epoch time: 0:01:21.646724,used: 0:04:06.644887,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_03_26_26_seed_1_22769265
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.97005206, 'precision': 0.9706123, 'recall': 0.9703314, 'specificity': 0.9703314, 'f1': 0.9700506, 'auroc': 0.9965564, 'binary_precision': 0.9906229, 'binary_recall': 0.94990367, 'binary_specificity': 0.9907591, 'binary_f1_score': 0.96983606}
confusion matrix:
      0     1
0  1501    14
1    78  1479
---- Validation: 
scalar performance:
{'acc': 0.79547226, 'precision': 0.8069109, 'recall': 0.7938556, 'specificity': 0.7938556, 'f1': 0.7928914, 'auroc': 0.868154, 'binary_precision': 0.86220473, 'binary_recall': 0.6952381, 'binary_specificity': 0.8924731, 'binary_f1_score': 0.7697715}
confusion matrix:
     0    1
0  581   70
1  192  438
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8377778, 'precision': 0.83890915, 'recall': 0.8377778, 'specificity': 0.8377778, 'f1': 0.8376423, 'auroc': 0.92630124, 'binary_precision': 0.8193277, 'binary_recall': 0.8666667, 'binary_specificity': 0.8088889, 'binary_f1_score': 0.8423326}
confusion matrix:
     0    1
0  182   43
1   30  195
new oracle model saved
early stop counter: 1
val acc:0.795472264289856, best validation acc: 0.8259172439575195, corresponding to test acc:                         0.8222222328186035 / 0.8377777934074402
after epoch: 4,now: 2024-07-23 03:31:54.218646,epoch time: 0:01:21.540791,used: 0:05:28.185678,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_03_26_26_seed_1_22769265
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.96744794, 'precision': 0.9688185, 'recall': 0.9671124, 'specificity': 0.9671124, 'f1': 0.9674014, 'auroc': 0.9976912, 'binary_precision': 0.9466585, 'binary_recall': 0.9916506, 'binary_specificity': 0.94257426, 'binary_f1_score': 0.96863234}
confusion matrix:
      0     1
0  1428    87
1    13  1544
---- Validation: 
scalar performance:
{'acc': 0.832943, 'precision': 0.8366093, 'recall': 0.8337942, 'specificity': 0.8337942, 'f1': 0.8326982, 'auroc': 0.9088899, 'binary_precision': 0.79714286, 'binary_recall': 0.8857143, 'binary_specificity': 0.78187406, 'binary_f1_score': 0.83909774}
confusion matrix:
     0    1
0  509  142
1   72  558
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8422222, 'precision': 0.8480034, 'recall': 0.8422222, 'specificity': 0.8422222, 'f1': 0.84156424, 'auroc': 0.93963456, 'binary_precision': 0.8031496, 'binary_recall': 0.9066667, 'binary_specificity': 0.7777778, 'binary_f1_score': 0.8517746}
confusion matrix:
     0    1
0  175   50
1   21  204
new oracle model saved
better model found
persisted
after epoch: 5,now: 2024-07-23 03:33:15.865861,epoch time: 0:01:21.647215,used: 0:06:49.832893,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_03_26_26_seed_1_22769265
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.984375, 'precision': 0.9843554, 'recall': 0.9844129, 'specificity': 0.9844129, 'f1': 0.9843737, 'auroc': 0.99874187, 'binary_precision': 0.98770225, 'binary_recall': 0.9813505, 'binary_specificity': 0.9874753, 'binary_f1_score': 0.9845161}
confusion matrix:
      0     1
0  1498    19
1    29  1526
---- Validation: 
scalar performance:
{'acc': 0.8165496, 'precision': 0.8211786, 'recall': 0.8155402, 'specificity': 0.8155402, 'f1': 0.8155135, 'auroc': 0.89599144, 'binary_precision': 0.8558559, 'binary_recall': 0.75396824, 'binary_specificity': 0.87711215, 'binary_f1_score': 0.8016878}
confusion matrix:
     0    1
0  571   80
1  155  475
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8511111, 'precision': 0.8514513, 'recall': 0.8511111, 'specificity': 0.8511111, 'f1': 0.8510751, 'auroc': 0.92705184, 'binary_precision': 0.8405172, 'binary_recall': 0.8666667, 'binary_specificity': 0.83555555, 'binary_f1_score': 0.8533917}
confusion matrix:
     0    1
0  188   37
1   30  195
new oracle model saved
early stop counter: 1
val acc:0.8165495991706848, best validation acc: 0.8329430222511292, corresponding to test acc:                         0.8422222137451172 / 0.851111114025116
after epoch: 6,now: 2024-07-23 03:34:37.101217,epoch time: 0:01:21.235356,used: 0:08:11.068249,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_03_26_26_seed_1_22769265
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.98567706, 'precision': 0.9856669, 'recall': 0.98573935, 'specificity': 0.98573935, 'f1': 0.98567635, 'auroc': 0.9983904, 'binary_precision': 0.9909032, 'binary_recall': 0.9807074, 'binary_specificity': 0.99077123, 'binary_f1_score': 0.9857789}
confusion matrix:
      0     1
0  1503    14
1    30  1525
---- Validation: 
scalar performance:
{'acc': 0.7587822, 'precision': 0.8013104, 'recall': 0.755658, 'specificity': 0.755658, 'f1': 0.7484182, 'auroc': 0.8950577, 'binary_precision': 0.9104859, 'binary_recall': 0.5650794, 'binary_specificity': 0.94623655, 'binary_f1_score': 0.6973555}
confusion matrix:
     0    1
0  616   35
1  274  356
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.84444445, 'precision': 0.8498626, 'recall': 0.84444445, 'specificity': 0.84444445, 'f1': 0.8438399, 'auroc': 0.91326416, 'binary_precision': 0.893401, 'binary_recall': 0.7822222, 'binary_specificity': 0.9066667, 'binary_f1_score': 0.83412325}
confusion matrix:
     0    1
0  204   21
1   49  176
early stop counter: 2
val acc:0.7587822079658508, best validation acc: 0.8329430222511292, corresponding to test acc:                         0.8422222137451172 / 0.851111114025116
after epoch: 7,now: 2024-07-23 03:35:57.705255,epoch time: 0:01:20.604038,used: 0:09:31.672287,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_03_26_26_seed_1_22769265
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9840495, 'precision': 0.9842744, 'recall': 0.98394084, 'specificity': 0.98394084, 'f1': 0.9840424, 'auroc': 0.99900675, 'binary_precision': 0.9765971, 'binary_recall': 0.99228793, 'binary_specificity': 0.9755937, 'binary_f1_score': 0.98438}
confusion matrix:
      0     1
0  1479    37
1    12  1544
---- Validation: 
scalar performance:
{'acc': 0.8446526, 'precision': 0.8450842, 'recall': 0.84434205, 'specificity': 0.84434205, 'f1': 0.84448546, 'auroc': 0.8980396, 'binary_precision': 0.85385877, 'binary_recall': 0.82539684, 'binary_specificity': 0.86328727, 'binary_f1_score': 0.83938664}
confusion matrix:
     0    1
0  562   89
1  110  520
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8066667, 'precision': 0.8161657, 'recall': 0.8066667, 'specificity': 0.8066667, 'f1': 0.8052035, 'auroc': 0.9201976, 'binary_precision': 0.7613636, 'binary_recall': 0.8933333, 'binary_specificity': 0.72, 'binary_f1_score': 0.82208586}
confusion matrix:
     0    1
0  162   63
1   24  201
better model found
persisted
after epoch: 8,now: 2024-07-23 03:37:19.664495,epoch time: 0:01:21.959240,used: 0:10:53.631527,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_03_26_26_seed_1_22769265
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9824219, 'precision': 0.98279613, 'recall': 0.98226726, 'specificity': 0.98226726, 'f1': 0.98241115, 'auroc': 0.9992106, 'binary_precision': 0.97234446, 'binary_recall': 0.9935774, 'binary_specificity': 0.9709571, 'binary_f1_score': 0.98284626}
confusion matrix:
      0     1
0  1471    44
1    10  1547
---- Validation: 
scalar performance:
{'acc': 0.85714287, 'precision': 0.85751164, 'recall': 0.8574245, 'specificity': 0.8574245, 'f1': 0.8571415, 'auroc': 0.91360056, 'binary_precision': 0.8412214, 'binary_recall': 0.87460315, 'binary_specificity': 0.8402458, 'binary_f1_score': 0.8575875}
confusion matrix:
     0    1
0  547  104
1   79  551
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8155556, 'precision': 0.8263934, 'recall': 0.8155556, 'specificity': 0.8155556, 'f1': 0.8140116, 'auroc': 0.92641973, 'binary_precision': 0.7669173, 'binary_recall': 0.9066667, 'binary_specificity': 0.72444445, 'binary_f1_score': 0.83095723}
confusion matrix:
     0    1
0  163   62
1   21  204
better model found
persisted
after epoch: 9,now: 2024-07-23 03:38:40.349066,epoch time: 0:01:20.684571,used: 0:12:14.316098,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_03_26_26_seed_1_22769265
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9905599, 'precision': 0.9905443, 'recall': 0.99057853, 'specificity': 0.99057853, 'f1': 0.9905588, 'auroc': 0.9994285, 'binary_precision': 0.9922581, 'binary_recall': 0.9890675, 'binary_specificity': 0.9920896, 'binary_f1_score': 0.9906602}
confusion matrix:
      0     1
0  1505    12
1    17  1538
---- Validation: 
scalar performance:
{'acc': 0.84933645, 'precision': 0.8493019, 'recall': 0.8492831, 'specificity': 0.8492831, 'f1': 0.8492919, 'auroc': 0.9030478, 'binary_precision': 0.84737676, 'binary_recall': 0.8460317, 'binary_specificity': 0.85253453, 'binary_f1_score': 0.8467037}
confusion matrix:
     0    1
0  555   96
1   97  533
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.82, 'precision': 0.82142854, 'recall': 0.82000005, 'specificity': 0.82000005, 'f1': 0.8197998, 'auroc': 0.9054222, 'binary_precision': 0.8, 'binary_recall': 0.85333335, 'binary_specificity': 0.7866667, 'binary_f1_score': 0.8258065}
confusion matrix:
     0    1
0  177   48
1   33  192
early stop counter: 1
val acc:0.8493364453315735, best validation acc: 0.8571428656578064, corresponding to test acc:                         0.8155555725097656 / 0.851111114025116
after epoch: 10,now: 2024-07-23 03:40:02.028543,epoch time: 0:01:21.679477,used: 0:13:35.995575,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_03_26_26_seed_1_22769265
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9902344, 'precision': 0.9902924, 'recall': 0.99019265, 'specificity': 0.99019265, 'f1': 0.990232, 'auroc': 0.9994447, 'binary_precision': 0.98722047, 'binary_recall': 0.99356914, 'binary_specificity': 0.9868161, 'binary_f1_score': 0.9903846}
confusion matrix:
      0     1
0  1497    20
1    10  1545
---- Validation: 
scalar performance:
{'acc': 0.8235753, 'precision': 0.8260564, 'recall': 0.82283664, 'specificity': 0.82283664, 'f1': 0.8229685, 'auroc': 0.88477063, 'binary_precision': 0.8506944, 'binary_recall': 0.7777778, 'binary_specificity': 0.86789554, 'binary_f1_score': 0.81260365}
confusion matrix:
     0    1
0  565   86
1  140  490
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.82666665, 'precision': 0.8273132, 'recall': 0.82666665, 'specificity': 0.82666665, 'f1': 0.826581, 'auroc': 0.8874469, 'binary_precision': 0.81276596, 'binary_recall': 0.8488889, 'binary_specificity': 0.80444443, 'binary_f1_score': 0.83043474}
confusion matrix:
     0    1
0  181   44
1   34  191
early stop counter: 2
val acc:0.8235753178596497, best validation acc: 0.8571428656578064, corresponding to test acc:                         0.8155555725097656 / 0.851111114025116
after epoch: 11,now: 2024-07-23 03:41:23.409890,epoch time: 0:01:21.381347,used: 0:14:57.376922,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_03_26_26_seed_1_22769265
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.98372394, 'precision': 0.98381096, 'recall': 0.98385036, 'specificity': 0.98385036, 'f1': 0.9837239, 'auroc': 0.99801266, 'binary_precision': 0.9940906, 'binary_recall': 0.97363347, 'binary_specificity': 0.99406725, 'binary_f1_score': 0.9837557}
confusion matrix:
      0     1
0  1508     9
1    41  1514
---- Validation: 
scalar performance:
{'acc': 0.79859483, 'precision': 0.8396306, 'recall': 0.7957245, 'specificity': 0.7957245, 'f1': 0.79120463, 'auroc': 0.9259405, 'binary_precision': 0.9536585, 'binary_recall': 0.6206349, 'binary_specificity': 0.9708141, 'binary_f1_score': 0.7519231}
confusion matrix:
     0    1
0  632   19
1  239  391
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.80444443, 'precision': 0.8460295, 'recall': 0.80444443, 'specificity': 0.80444443, 'f1': 0.7983871, 'auroc': 0.9127308, 'binary_precision': 0.9659864, 'binary_recall': 0.6311111, 'binary_specificity': 0.9777778, 'binary_f1_score': 0.76344085}
confusion matrix:
     0    1
0  220    5
1   83  142
early stop counter: 3
val acc:0.7985948324203491, best validation acc: 0.8571428656578064, corresponding to test acc:                         0.8155555725097656 / 0.851111114025116
after epoch: 12,now: 2024-07-23 03:42:45.364223,epoch time: 0:01:21.954333,used: 0:16:19.331255,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_03_26_26_seed_1_22769265
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9899089, 'precision': 0.9899354, 'recall': 0.9899746, 'specificity': 0.9899746, 'f1': 0.98990875, 'auroc': 0.9993838, 'binary_precision': 0.996732, 'binary_recall': 0.9832366, 'binary_specificity': 0.9967127, 'binary_f1_score': 0.9899383}
confusion matrix:
      0     1
0  1516     5
1    26  1525
---- Validation: 
scalar performance:
{'acc': 0.7626854, 'precision': 0.8098469, 'recall': 0.759447, 'specificity': 0.759447, 'f1': 0.75173783, 'auroc': 0.8969132, 'binary_precision': 0.92670155, 'binary_recall': 0.5619048, 'binary_specificity': 0.9569892, 'binary_f1_score': 0.69960475}
confusion matrix:
     0    1
0  623   28
1  276  354
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.80222225, 'precision': 0.83564407, 'recall': 0.80222225, 'specificity': 0.80222225, 'f1': 0.79717314, 'auroc': 0.9059161, 'binary_precision': 0.9415584, 'binary_recall': 0.64444447, 'binary_specificity': 0.96, 'binary_f1_score': 0.7651716}
confusion matrix:
     0    1
0  216    9
1   80  145
early stop counter: 4
val acc:0.7626854181289673, best validation acc: 0.8571428656578064, corresponding to test acc:                         0.8155555725097656 / 0.851111114025116
after epoch: 13,now: 2024-07-23 03:44:06.399825,epoch time: 0:01:21.035602,used: 0:17:40.366857,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_03_26_26_seed_1_22769265
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.991862, 'precision': 0.9918738, 'recall': 0.9918494, 'specificity': 0.9918494, 'f1': 0.9918606, 'auroc': 0.9995803, 'binary_precision': 0.99100834, 'binary_recall': 0.9929215, 'binary_specificity': 0.9907773, 'binary_f1_score': 0.991964}
confusion matrix:
      0     1
0  1504    14
1    11  1543
---- Validation: 
scalar performance:
{'acc': 0.84933645, 'precision': 0.85700285, 'recall': 0.84813106, 'specificity': 0.84813106, 'f1': 0.8481759, 'auroc': 0.91106236, 'binary_precision': 0.9053803, 'binary_recall': 0.7746032, 'binary_specificity': 0.921659, 'binary_f1_score': 0.83490163}
confusion matrix:
     0    1
0  600   51
1  142  488
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.85333335, 'precision': 0.85889125, 'recall': 0.85333335, 'specificity': 0.85333335, 'f1': 0.8527633, 'auroc': 0.92128396, 'binary_precision': 0.9035533, 'binary_recall': 0.7911111, 'binary_specificity': 0.91555554, 'binary_f1_score': 0.8436019}
confusion matrix:
     0    1
0  206   19
1   47  178
new oracle model saved
early stop counter: 5
val acc:0.8493364453315735, best validation acc: 0.8571428656578064, corresponding to test acc:                         0.8155555725097656 / 0.8533333539962769
after epoch: 14,now: 2024-07-23 03:45:28.379192,epoch time: 0:01:21.979367,used: 0:19:02.346224,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_03_26_26_seed_1_22769265
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.991862, 'precision': 0.99183977, 'recall': 0.9919183, 'specificity': 0.9919183, 'f1': 0.9918612, 'auroc': 0.99952054, 'binary_precision': 0.996114, 'binary_recall': 0.987797, 'binary_specificity': 0.9960396, 'binary_f1_score': 0.9919381}
confusion matrix:
      0     1
0  1509     6
1    19  1538
---- Validation: 
scalar performance:
{'acc': 0.8360656, 'precision': 0.8399359, 'recall': 0.83517665, 'specificity': 0.83517665, 'f1': 0.83530587, 'auroc': 0.89294374, 'binary_precision': 0.87234044, 'binary_recall': 0.7809524, 'binary_specificity': 0.8894009, 'binary_f1_score': 0.8241206}
confusion matrix:
     0    1
0  579   72
1  138  492
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8155556, 'precision': 0.8178219, 'recall': 0.8155556, 'specificity': 0.8155556, 'f1': 0.8152262, 'auroc': 0.9038222, 'binary_precision': 0.7909836, 'binary_recall': 0.8577778, 'binary_specificity': 0.7733333, 'binary_f1_score': 0.82302773}
confusion matrix:
     0    1
0  174   51
1   32  193
early stop counter: 6
val acc:0.8360655903816223, best validation acc: 0.8571428656578064, corresponding to test acc:                         0.8155555725097656 / 0.8533333539962769
after epoch: 15,now: 2024-07-23 03:46:48.708830,epoch time: 0:01:20.329638,used: 0:20:22.675862,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_03_26_26_seed_1_22769265
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9794922, 'precision': 0.9800759, 'recall': 0.9797298, 'specificity': 0.9797298, 'f1': 0.97949064, 'auroc': 0.99952173, 'binary_precision': 1.0, 'binary_recall': 0.9594595, 'binary_specificity': 1.0, 'binary_f1_score': 0.97931033}
confusion matrix:
      0     1
0  1518     0
1    63  1491
---- Validation: 
scalar performance:
{'acc': 0.6635441, 'precision': 0.77134514, 'recall': 0.6582949, 'specificity': 0.6582949, 'f1': 0.62214845, 'auroc': 0.89751303, 'binary_precision': 0.938326, 'binary_recall': 0.33809525, 'binary_specificity': 0.97849464, 'binary_f1_score': 0.49708286}
confusion matrix:
     0    1
0  637   14
1  417  213
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7644445, 'precision': 0.8175328, 'recall': 0.7644445, 'specificity': 0.7644445, 'f1': 0.75416934, 'auroc': 0.88853335, 'binary_precision': 0.94736844, 'binary_recall': 0.56, 'binary_specificity': 0.9688889, 'binary_f1_score': 0.70391065}
confusion matrix:
     0    1
0  218    7
1   99  126
early stop counter: 7
val acc:0.6635441184043884, best validation acc: 0.8571428656578064, corresponding to test acc:                         0.8155555725097656 / 0.8533333539962769
after epoch: 16,now: 2024-07-23 03:48:09.692046,epoch time: 0:01:20.983216,used: 0:21:43.659078,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_03_26_26_seed_1_22769265
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9749349, 'precision': 0.9757928, 'recall': 0.9752331, 'specificity': 0.9752331, 'f1': 0.97493124, 'auroc': 0.99912584, 'binary_precision': 0.9993243, 'binary_recall': 0.9511254, 'binary_specificity': 0.99934083, 'binary_f1_score': 0.9746293}
confusion matrix:
      0     1
0  1516     1
1    76  1479
---- Validation: 
scalar performance:
{'acc': 0.54722875, 'precision': 0.7300308, 'recall': 0.53978497, 'specificity': 0.53978497, 'f1': 0.4237392, 'auroc': 0.88398254, 'binary_precision': 0.9310345, 'binary_recall': 0.08571429, 'binary_specificity': 0.9938556, 'binary_f1_score': 0.15697674}
confusion matrix:
     0   1
0  647   4
1  576  54
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.51111114, 'precision': 0.752809, 'recall': 0.51111114, 'specificity': 0.51111114, 'f1': 0.35756, 'auroc': 0.89675057, 'binary_precision': 1.0, 'binary_recall': 0.022222223, 'binary_specificity': 1.0, 'binary_f1_score': 0.043478258}
confusion matrix:
     0  1
0  225  0
1  220  5
early stop counter: 8
val acc:0.5472287535667419, best validation acc: 0.8571428656578064, corresponding to test acc:                         0.8155555725097656 / 0.8533333539962769
after epoch: 17,now: 2024-07-23 03:49:30.998604,epoch time: 0:01:21.306558,used: 0:23:04.965636,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_03_26_26_seed_1_22769265
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.99088544, 'precision': 0.9909269, 'recall': 0.99085367, 'specificity': 0.99085367, 'f1': 0.9908835, 'auroc': 0.9996664, 'binary_precision': 0.98847634, 'binary_recall': 0.993565, 'binary_specificity': 0.9881423, 'binary_f1_score': 0.9910141}
confusion matrix:
      0     1
0  1500    18
1    10  1544
---- Validation: 
scalar performance:
{'acc': 0.83918816, 'precision': 0.85697126, 'recall': 0.83735275, 'specificity': 0.83735275, 'f1': 0.8366071, 'auroc': 0.9210446, 'binary_precision': 0.93265307, 'binary_recall': 0.7253968, 'binary_specificity': 0.94930875, 'binary_f1_score': 0.8160714}
confusion matrix:
     0    1
0  618   33
1  173  457
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.80444443, 'precision': 0.851074, 'recall': 0.80444443, 'specificity': 0.80444443, 'f1': 0.79772794, 'auroc': 0.9214815, 'binary_precision': 0.97902095, 'binary_recall': 0.62222224, 'binary_specificity': 0.9866667, 'binary_f1_score': 0.7608695}
confusion matrix:
     0    1
0  222    3
1   85  140
early stop counter: 9
val acc:0.8391881585121155, best validation acc: 0.8571428656578064, corresponding to test acc:                         0.8155555725097656 / 0.8533333539962769
after epoch: 18,now: 2024-07-23 03:50:52.087560,epoch time: 0:01:21.088956,used: 0:24:26.054592,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_03_26_26_seed_1_22769265
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9889323, 'precision': 0.98909444, 'recall': 0.9888456, 'specificity': 0.9888456, 'f1': 0.9889281, 'auroc': 0.99942935, 'binary_precision': 0.982868, 'binary_recall': 0.9955013, 'binary_specificity': 0.98218995, 'binary_f1_score': 0.9891443}
confusion matrix:
      0     1
0  1489    27
1     7  1549
---- Validation: 
scalar performance:
{'acc': 0.8579235, 'precision': 0.8670684, 'recall': 0.8566308, 'specificity': 0.8566308, 'f1': 0.8566868, 'auroc': 0.92022526, 'binary_precision': 0.92105263, 'binary_recall': 0.7777778, 'binary_specificity': 0.9354839, 'binary_f1_score': 0.84337354}
confusion matrix:
     0    1
0  609   42
1  140  490
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8422222, 'precision': 0.8592609, 'recall': 0.8422222, 'specificity': 0.8422222, 'f1': 0.84032905, 'auroc': 0.9241679, 'binary_precision': 0.9375, 'binary_recall': 0.73333335, 'binary_specificity': 0.95111114, 'binary_f1_score': 0.8229426}
confusion matrix:
     0    1
0  214   11
1   60  165
better model found
persisted
after epoch: 19,now: 2024-07-23 03:52:14.509189,epoch time: 0:01:22.421629,used: 0:25:48.476221,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_03_26_26_seed_1_22769265
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9899089, 'precision': 0.9898944, 'recall': 0.98998266, 'specificity': 0.98998266, 'f1': 0.9899082, 'auroc': 0.9995456, 'binary_precision': 0.99545455, 'binary_recall': 0.98458576, 'binary_specificity': 0.99537957, 'binary_f1_score': 0.9899903}
confusion matrix:
      0     1
0  1508     7
1    24  1533
---- Validation: 
scalar performance:
{'acc': 0.8384075, 'precision': 0.8558831, 'recall': 0.83658475, 'specificity': 0.83658475, 'f1': 0.83584666, 'auroc': 0.9189769, 'binary_precision': 0.9307536, 'binary_recall': 0.7253968, 'binary_specificity': 0.9477727, 'binary_f1_score': 0.8153435}
confusion matrix:
     0    1
0  617   34
1  173  457
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7822222, 'precision': 0.80706656, 'recall': 0.7822222, 'specificity': 0.7822222, 'f1': 0.77772623, 'auroc': 0.89040494, 'binary_precision': 0.89440995, 'binary_recall': 0.64, 'binary_specificity': 0.92444444, 'binary_f1_score': 0.746114}
confusion matrix:
     0    1
0  208   17
1   81  144
early stop counter: 1
val acc:0.8384075164794922, best validation acc: 0.8579235076904297, corresponding to test acc:                         0.8422222137451172 / 0.8533333539962769
after epoch: 20,now: 2024-07-23 03:53:35.609520,epoch time: 0:01:21.100331,used: 0:27:09.576552,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_03_26_26_seed_1_22769265
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.99348956, 'precision': 0.9934807, 'recall': 0.9935392, 'specificity': 0.9935392, 'f1': 0.99348927, 'auroc': 0.99972785, 'binary_precision': 0.9980507, 'binary_recall': 0.9890534, 'binary_specificity': 0.998025, 'binary_f1_score': 0.99353164}
confusion matrix:
      0     1
0  1516     3
1    17  1536
---- Validation: 
scalar performance:
{'acc': 0.8384075, 'precision': 0.84715253, 'recall': 0.8370968, 'specificity': 0.8370968, 'f1': 0.8369769, 'auroc': 0.9123961, 'binary_precision': 0.89830506, 'binary_recall': 0.75714284, 'binary_specificity': 0.9170507, 'binary_f1_score': 0.8217054}
confusion matrix:
     0    1
0  597   54
1  153  477
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8288889, 'precision': 0.84820986, 'recall': 0.8288889, 'specificity': 0.8288889, 'f1': 0.82648194, 'auroc': 0.91387653, 'binary_precision': 0.9302326, 'binary_recall': 0.7111111, 'binary_specificity': 0.94666666, 'binary_f1_score': 0.80604535}
confusion matrix:
     0    1
0  213   12
1   65  160
early stop counter: 2
val acc:0.8384075164794922, best validation acc: 0.8579235076904297, corresponding to test acc:                         0.8422222137451172 / 0.8533333539962769
after epoch: 21,now: 2024-07-23 03:54:57.023819,epoch time: 0:01:21.414299,used: 0:28:30.990851,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_03_26_26_seed_1_22769265
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.99316406, 'precision': 0.99314463, 'recall': 0.993218, 'specificity': 0.993218, 'f1': 0.9931636, 'auroc': 0.99966764, 'binary_precision': 0.9974077, 'binary_recall': 0.9890745, 'binary_specificity': 0.9973615, 'binary_f1_score': 0.99322367}
confusion matrix:
      0     1
0  1512     4
1    17  1539
---- Validation: 
scalar performance:
{'acc': 0.8501171, 'precision': 0.85328126, 'recall': 0.84933436, 'specificity': 0.84933436, 'f1': 0.8495449, 'auroc': 0.914649, 'binary_precision': 0.88286716, 'binary_recall': 0.8015873, 'binary_specificity': 0.89708143, 'binary_f1_score': 0.8402662}
confusion matrix:
     0    1
0  584   67
1  125  505
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8244445, 'precision': 0.84201646, 'recall': 0.8244444, 'specificity': 0.8244444, 'f1': 0.8221602, 'auroc': 0.9141728, 'binary_precision': 0.9195402, 'binary_recall': 0.7111111, 'binary_specificity': 0.93777776, 'binary_f1_score': 0.802005}
confusion matrix:
     0    1
0  211   14
1   65  160
early stop counter: 3
val acc:0.8501170873641968, best validation acc: 0.8579235076904297, corresponding to test acc:                         0.8422222137451172 / 0.8533333539962769
after epoch: 22,now: 2024-07-23 03:56:18.541605,epoch time: 0:01:21.517786,used: 0:29:52.508637,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_03_26_26_seed_1_22769265
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.99153644, 'precision': 0.9915229, 'recall': 0.9915513, 'specificity': 0.9915513, 'f1': 0.9915354, 'auroc': 0.999797, 'binary_precision': 0.9929078, 'binary_recall': 0.9903537, 'binary_specificity': 0.99274886, 'binary_f1_score': 0.9916291}
confusion matrix:
      0     1
0  1506    11
1    15  1540
---- Validation: 
scalar performance:
{'acc': 0.80796254, 'precision': 0.8274571, 'recall': 0.80593956, 'specificity': 0.80593956, 'f1': 0.80431044, 'auroc': 0.90358174, 'binary_precision': 0.9033613, 'binary_recall': 0.6825397, 'binary_specificity': 0.92933947, 'binary_f1_score': 0.77757686}
confusion matrix:
     0    1
0  605   46
1  200  430
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8422222, 'precision': 0.84650004, 'recall': 0.8422222, 'specificity': 0.8422222, 'f1': 0.8417338, 'auroc': 0.9013136, 'binary_precision': 0.885, 'binary_recall': 0.7866667, 'binary_specificity': 0.8977778, 'binary_f1_score': 0.83294123}
confusion matrix:
     0    1
0  202   23
1   48  177
early stop counter: 4
val acc:0.8079625368118286, best validation acc: 0.8579235076904297, corresponding to test acc:                         0.8422222137451172 / 0.8533333539962769
after epoch: 23,now: 2024-07-23 03:57:39.024215,epoch time: 0:01:20.482610,used: 0:31:12.991247,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_03_26_26_seed_1_22769265
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.99153644, 'precision': 0.9915288, 'recall': 0.99161136, 'specificity': 0.99161136, 'f1': 0.991536, 'auroc': 0.9996723, 'binary_precision': 0.9973992, 'binary_recall': 0.9858612, 'binary_specificity': 0.9973615, 'binary_f1_score': 0.99159664}
confusion matrix:
      0     1
0  1512     4
1    22  1534
---- Validation: 
scalar performance:
{'acc': 0.8430913, 'precision': 0.85059685, 'recall': 0.84188426, 'specificity': 0.84188426, 'f1': 0.84188265, 'auroc': 0.90675884, 'binary_precision': 0.8979592, 'binary_recall': 0.768254, 'binary_specificity': 0.9155146, 'binary_f1_score': 0.8280582}
confusion matrix:
     0    1
0  596   55
1  146  484
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.82222223, 'precision': 0.8272908, 'recall': 0.82222223, 'specificity': 0.82222223, 'f1': 0.8215313, 'auroc': 0.89609873, 'binary_precision': 0.8680203, 'binary_recall': 0.76, 'binary_specificity': 0.8844444, 'binary_f1_score': 0.8104266}
confusion matrix:
     0    1
0  199   26
1   54  171
early stop counter: 5
val acc:0.8430913090705872, best validation acc: 0.8579235076904297, corresponding to test acc:                         0.8422222137451172 / 0.8533333539962769
after epoch: 24,now: 2024-07-23 03:59:00.697203,epoch time: 0:01:21.672988,used: 0:32:34.664235,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_03_26_26_seed_1_22769265
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.99121094, 'precision': 0.9912565, 'recall': 0.99131835, 'specificity': 0.99131835, 'f1': 0.9912108, 'auroc': 0.99996734, 'binary_precision': 1.0, 'binary_recall': 0.98263663, 'binary_specificity': 1.0, 'binary_f1_score': 0.99124223}
confusion matrix:
      0     1
0  1517     0
1    27  1528
---- Validation: 
scalar performance:
{'acc': 0.68384075, 'precision': 0.7854966, 'recall': 0.67887866, 'specificity': 0.67887866, 'f1': 0.6493037, 'auroc': 0.9016129, 'binary_precision': 0.9518072, 'binary_recall': 0.37619048, 'binary_specificity': 0.98156685, 'binary_f1_score': 0.5392491}
confusion matrix:
     0    1
0  639   12
1  393  237
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5688889, 'precision': 0.74010324, 'recall': 0.5688889, 'specificity': 0.5688889, 'f1': 0.47536057, 'auroc': 0.87932837, 'binary_precision': 0.94285715, 'binary_recall': 0.14666666, 'binary_specificity': 0.9911111, 'binary_f1_score': 0.25384614}
confusion matrix:
     0   1
0  223   2
1  192  33
early stop counter: 6
val acc:0.6838407516479492, best validation acc: 0.8579235076904297, corresponding to test acc:                         0.8422222137451172 / 0.8533333539962769
after epoch: 25,now: 2024-07-23 04:00:21.948739,epoch time: 0:01:21.251536,used: 0:33:55.915771,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_03_26_26_seed_1_22769265
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9921875, 'precision': 0.9922339, 'recall': 0.9921504, 'specificity': 0.9921504, 'f1': 0.9921855, 'auroc': 0.99967694, 'binary_precision': 0.9897764, 'binary_recall': 0.9948619, 'binary_specificity': 0.98943895, 'binary_f1_score': 0.9923126}
confusion matrix:
      0     1
0  1499    16
1     8  1549
---- Validation: 
scalar performance:
{'acc': 0.8462139, 'precision': 0.8646782, 'recall': 0.8443676, 'specificity': 0.8443676, 'f1': 0.8437144, 'auroc': 0.92387784, 'binary_precision': 0.94274026, 'binary_recall': 0.731746, 'binary_specificity': 0.9569892, 'binary_f1_score': 0.82395}
confusion matrix:
     0    1
0  623   28
1  169  461
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7977778, 'precision': 0.83500004, 'recall': 0.7977778, 'specificity': 0.7977778, 'f1': 0.792, 'auroc': 0.9041976, 'binary_precision': 0.94666666, 'binary_recall': 0.6311111, 'binary_specificity': 0.96444446, 'binary_f1_score': 0.7573333}
confusion matrix:
     0    1
0  217    8
1   83  142
early stop counter: 7
val acc:0.8462138772010803, best validation acc: 0.8579235076904297, corresponding to test acc:                         0.8422222137451172 / 0.8533333539962769
after epoch: 26,now: 2024-07-23 04:01:43.389227,epoch time: 0:01:21.440488,used: 0:35:17.356259,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_03_26_26_seed_1_22769265
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.9951172, 'precision': 0.9951019, 'recall': 0.9951366, 'specificity': 0.9951366, 'f1': 0.9951166, 'auroc': 0.9999106, 'binary_precision': 0.9967742, 'binary_recall': 0.99356914, 'binary_specificity': 0.99670404, 'binary_f1_score': 0.9951691}
confusion matrix:
      0     1
0  1512     5
1    10  1545
---- Validation: 
scalar performance:
{'acc': 0.754879, 'precision': 0.81194884, 'recall': 0.75133127, 'specificity': 0.75133127, 'f1': 0.74134725, 'auroc': 0.9130447, 'binary_precision': 0.9413408, 'binary_recall': 0.53492063, 'binary_specificity': 0.9677419, 'binary_f1_score': 0.68218625}
confusion matrix:
     0    1
0  630   21
1  293  337
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.69555557, 'precision': 0.7869898, 'recall': 0.69555557, 'specificity': 0.69555557, 'f1': 0.66920817, 'auroc': 0.89151603, 'binary_precision': 0.9489796, 'binary_recall': 0.41333333, 'binary_specificity': 0.9777778, 'binary_f1_score': 0.5758514}
confusion matrix:
     0   1
0  220   5
1  132  93
early stop counter: 8
val acc:0.7548789978027344, best validation acc: 0.8579235076904297, corresponding to test acc:                         0.8422222137451172 / 0.8533333539962769
after epoch: 27,now: 2024-07-23 04:03:04.903134,epoch time: 0:01:21.513907,used: 0:36:38.870166,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_03_26_26_seed_1_22769265
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.99641925, 'precision': 0.9963962, 'recall': 0.99645865, 'specificity': 0.99645865, 'f1': 0.9964189, 'auroc': 0.999933, 'binary_precision': 0.999354, 'binary_recall': 0.9935774, 'binary_specificity': 0.99933994, 'binary_f1_score': 0.9964574}
confusion matrix:
      0     1
0  1514     1
1    10  1547
---- Validation: 
scalar performance:
{'acc': 0.8430913, 'precision': 0.8551192, 'recall': 0.84157705, 'specificity': 0.84157705, 'f1': 0.84130263, 'auroc': 0.9235413, 'binary_precision': 0.91650486, 'binary_recall': 0.74920636, 'binary_specificity': 0.9339478, 'binary_f1_score': 0.8244542}
confusion matrix:
     0    1
0  608   43
1  158  472
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.82222223, 'precision': 0.83758616, 'recall': 0.82222223, 'specificity': 0.82222223, 'f1': 0.82017624, 'auroc': 0.9170765, 'binary_precision': 0.90960455, 'binary_recall': 0.71555555, 'binary_specificity': 0.9288889, 'binary_f1_score': 0.80099505}
confusion matrix:
     0    1
0  209   16
1   64  161
early stop counter: 9
val acc:0.8430913090705872, best validation acc: 0.8579235076904297, corresponding to test acc:                         0.8422222137451172 / 0.8533333539962769
after epoch: 28,now: 2024-07-23 04:04:26.856343,epoch time: 0:01:21.953209,used: 0:38:00.823375,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_03_26_26_seed_1_22769265
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9892578, 'precision': 0.98934793, 'recall': 0.98939586, 'specificity': 0.98939586, 'f1': 0.9892578, 'auroc': 0.99987453, 'binary_precision': 1.0, 'binary_recall': 0.9787918, 'binary_specificity': 1.0, 'binary_f1_score': 0.98928225}
confusion matrix:
      0     1
0  1516     0
1    33  1523
---- Validation: 
scalar performance:
{'acc': 0.6338798, 'precision': 0.7613843, 'recall': 0.6280594, 'specificity': 0.6280594, 'f1': 0.57748544, 'auroc': 0.9188599, 'binary_precision': 0.9398907, 'binary_recall': 0.2730159, 'binary_specificity': 0.9831029, 'binary_f1_score': 0.42312422}
confusion matrix:
     0    1
0  640   11
1  458  172
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6155556, 'precision': 0.7651378, 'recall': 0.6155555, 'specificity': 0.6155555, 'f1': 0.55242926, 'auroc': 0.93242466, 'binary_precision': 0.96428573, 'binary_recall': 0.24, 'binary_specificity': 0.9911111, 'binary_f1_score': 0.38434163}
confusion matrix:
     0   1
0  223   2
1  171  54
early stop counter: 10
val acc:0.6338797807693481, best validation acc: 0.8579235076904297, corresponding to test acc:                         0.8422222137451172 / 0.8533333539962769
after epoch: 29,now: 2024-07-23 04:05:48.708391,epoch time: 0:01:21.852048,used: 0:39:22.675423,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_03_26_26_seed_1_22769265
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.98307294, 'precision': 0.9837713, 'recall': 0.98286897, 'specificity': 0.98286897, 'f1': 0.983059, 'auroc': 0.99989486, 'binary_precision': 0.9682243, 'binary_recall': 0.9993569, 'binary_specificity': 0.966381, 'binary_f1_score': 0.9835443}
confusion matrix:
      0     1
0  1466    51
1     1  1554
---- Validation: 
scalar performance:
{'acc': 0.871975, 'precision': 0.872031, 'recall': 0.8721198, 'specificity': 0.8721198, 'f1': 0.87197125, 'auroc': 0.9313407, 'binary_precision': 0.86180127, 'binary_recall': 0.88095236, 'binary_specificity': 0.86328727, 'binary_f1_score': 0.8712716}
confusion matrix:
     0    1
0  562   89
1   75  555
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.87777776, 'precision': 0.87868285, 'recall': 0.8777778, 'specificity': 0.8777778, 'f1': 0.8777047, 'auroc': 0.93351114, 'binary_precision': 0.89719623, 'binary_recall': 0.85333335, 'binary_specificity': 0.9022222, 'binary_f1_score': 0.87471527}
confusion matrix:
     0    1
0  203   22
1   33  192
new oracle model saved
better model found
persisted
after epoch: 30,now: 2024-07-23 04:07:10.906129,epoch time: 0:01:22.197738,used: 0:40:44.873161,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_03_26_26_seed_1_22769265
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 0:40:44.873161 at 2024-07-23 04:07:10.906129
persisted model performance metric: 

scalar performance:
{'acc': 0.87777776, 'precision': 0.87868285, 'recall': 0.8777778, 'specificity': 0.8777778, 'f1': 0.8777047, 'auroc': 0.93351114, 'binary_precision': 0.89719623, 'binary_recall': 0.85333335, 'binary_specificity': 0.9022222, 'binary_f1_score': 0.87471527}
confusion matrix:
     0    1
0  203   22
1   33  192
oracle model performance metric: 

scalar performance:
{'acc': 0.87777776, 'precision': 0.87868285, 'recall': 0.8777778, 'specificity': 0.8777778, 'f1': 0.8777047, 'auroc': 0.93351114, 'binary_precision': 0.89719623, 'binary_recall': 0.85333335, 'binary_specificity': 0.9022222, 'binary_f1_score': 0.87471527}
confusion matrix:
     0    1
0  203   22
1   33  192
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_dial_lr1e5_bs16_allfreeze_2024-07-22_23-46-53/rule_results/5.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_dial_lr1e5_bs16_allfreeze_2024-07-22_23-46-53/confusion_matrix/5.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 453153 KiB |  26075 MiB | 145142 GiB | 145142 GiB |
|       from large pool | 412597 KiB |  26030 MiB | 144235 GiB | 144235 GiB |
|       from small pool |  40556 KiB |     60 MiB |    906 GiB |    906 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 453153 KiB |  26075 MiB | 145142 GiB | 145142 GiB |
|       from large pool | 412597 KiB |  26030 MiB | 144235 GiB | 144235 GiB |
|       from small pool |  40556 KiB |     60 MiB |    906 GiB |    906 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 447481 KiB |  26071 MiB | 145116 GiB | 145116 GiB |
|       from large pool | 407075 KiB |  26026 MiB | 144211 GiB | 144211 GiB |
|       from small pool |  40406 KiB |     60 MiB |    905 GiB |    905 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  27768 MiB |  27768 MiB |  54304 MiB |  26536 MiB |
|       from large pool |  27696 MiB |  27696 MiB |  54218 MiB |  26522 MiB |
|       from small pool |     72 MiB |     72 MiB |     86 MiB |     14 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 738782 KiB |   1678 MiB |  64540 GiB |  64540 GiB |
|       from large pool | 721995 KiB |   1668 MiB |  63627 GiB |  63627 GiB |
|       from small pool |  16787 KiB |     29 MiB |    913 GiB |    913 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    1226    |    2570    |   13126 K  |   13125 K  |
|       from large pool |     187    |    1413    |    6646 K  |    6645 K  |
|       from small pool |    1039    |    1335    |    6480 K  |    6479 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    1226    |    2570    |   13126 K  |   13125 K  |
|       from large pool |     187    |    1413    |    6646 K  |    6645 K  |
|       from small pool |    1039    |    1335    |    6480 K  |    6479 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     835    |     835    |    1603    |     768    |
|       from large pool |     799    |     800    |    1560    |     761    |
|       from small pool |      36    |      36    |      43    |       7    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     103    |     848    |    9548 K  |    9548 K  |
|       from large pool |      40    |     801    |    5873 K  |    5873 K  |
|       from small pool |      63    |     148    |    3675 K  |    3674 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  26075 MiB | 145142 GiB | 145142 GiB |
|       from large pool |  16640 KiB |  26030 MiB | 144235 GiB | 144235 GiB |
|       from small pool |      0 KiB |     60 MiB |    906 GiB |    906 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  26075 MiB | 145142 GiB | 145142 GiB |
|       from large pool |  16640 KiB |  26030 MiB | 144235 GiB | 144235 GiB |
|       from small pool |      0 KiB |     60 MiB |    906 GiB |    906 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  26071 MiB | 145116 GiB | 145116 GiB |
|       from large pool |  16640 KiB |  26026 MiB | 144211 GiB | 144211 GiB |
|       from small pool |      0 KiB |     60 MiB |    905 GiB |    905 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1164 MiB |  27768 MiB |  54304 MiB |  53140 MiB |
|       from large pool |   1108 MiB |  27696 MiB |  54218 MiB |  53110 MiB |
|       from small pool |     56 MiB |     72 MiB |     86 MiB |     30 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |   3840 KiB |   1678 MiB |  64541 GiB |  64541 GiB |
|       from large pool |   3840 KiB |   1668 MiB |  63628 GiB |  63628 GiB |
|       from small pool |      0 KiB |     35 MiB |    913 GiB |    913 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    2570    |   13126 K  |   13126 K  |
|       from large pool |       2    |    1413    |    6646 K  |    6646 K  |
|       from small pool |       0    |    1335    |    6480 K  |    6480 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    2570    |   13126 K  |   13126 K  |
|       from large pool |       2    |    1413    |    6646 K  |    6646 K  |
|       from small pool |       0    |    1335    |    6480 K  |    6480 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      69    |     835    |    1603    |    1534    |
|       from large pool |      41    |     800    |    1560    |    1519    |
|       from small pool |      28    |      36    |      43    |      15    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       1    |     848    |    9549 K  |    9549 K  |
|       from large pool |       1    |     801    |    5873 K  |    5873 K  |
|       from small pool |       0    |     148    |    3675 K  |    3675 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  26075 MiB | 145142 GiB | 145142 GiB |
|       from large pool |  16640 KiB |  26030 MiB | 144235 GiB | 144235 GiB |
|       from small pool |      0 KiB |     60 MiB |    906 GiB |    906 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  26075 MiB | 145142 GiB | 145142 GiB |
|       from large pool |  16640 KiB |  26030 MiB | 144235 GiB | 144235 GiB |
|       from small pool |      0 KiB |     60 MiB |    906 GiB |    906 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  26071 MiB | 145116 GiB | 145116 GiB |
|       from large pool |  16640 KiB |  26026 MiB | 144211 GiB | 144211 GiB |
|       from small pool |      0 KiB |     60 MiB |    905 GiB |    905 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1164 MiB |  27768 MiB |  54304 MiB |  53140 MiB |
|       from large pool |   1108 MiB |  27696 MiB |  54218 MiB |  53110 MiB |
|       from small pool |     56 MiB |     72 MiB |     86 MiB |     30 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |   3840 KiB |   1678 MiB |  64541 GiB |  64541 GiB |
|       from large pool |   3840 KiB |   1668 MiB |  63628 GiB |  63628 GiB |
|       from small pool |      0 KiB |     35 MiB |    913 GiB |    913 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    2570    |   13126 K  |   13126 K  |
|       from large pool |       2    |    1413    |    6646 K  |    6646 K  |
|       from small pool |       0    |    1335    |    6480 K  |    6480 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    2570    |   13126 K  |   13126 K  |
|       from large pool |       2    |    1413    |    6646 K  |    6646 K  |
|       from small pool |       0    |    1335    |    6480 K  |    6480 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      69    |     835    |    1603    |    1534    |
|       from large pool |      41    |     800    |    1560    |    1519    |
|       from small pool |      28    |      36    |      43    |      15    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       1    |     848    |    9549 K  |    9549 K  |
|       from large pool |       1    |     801    |    5873 K  |    5873 K  |
|       from small pool |       0    |     148    |    3675 K  |    3675 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'888c1ef2'
model name: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_04_08_27_seed_2_22769265

 Experiment start at: 2024-07-23 04:08:27.479322
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
before training, model accuracy: 0.41203704476356506
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.925, 'precision': 0.92515206, 'recall': 0.925077, 'specificity': 0.925077, 'f1': 0.9249989, 'auroc': 0.97454154, 'binary_precision': 0.93520373, 'binary_recall': 0.914435, 'binary_specificity': 0.935719, 'binary_f1_score': 0.9247028}
confusion matrix:
      0     1
0  1412    97
1   131  1400
---- Validation: 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
scalar performance:
{'acc': 0.7809077, 'precision': 0.78776896, 'recall': 0.7828773, 'specificity': 0.7828773, 'f1': 0.7802856, 'auroc': 0.8770734, 'binary_precision': 0.7361878, 'binary_recall': 0.8569132, 'binary_specificity': 0.70884144, 'binary_f1_score': 0.7919762}
confusion matrix:
     0    1
0  465  191
1   89  533
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7731481, 'precision': 0.7886131, 'recall': 0.7731482, 'specificity': 0.7731482, 'f1': 0.77006793, 'auroc': 0.8843664, 'binary_precision': 0.7218045, 'binary_recall': 0.8888889, 'binary_specificity': 0.6574074, 'binary_f1_score': 0.79668045}
confusion matrix:
     0    1
0  142   74
1   24  192
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-23 04:09:48.909996,epoch time: 0:01:21.430674,used: 0:01:21.430674,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_04_08_27_seed_2_22769265
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.95526314, 'precision': 0.9562382, 'recall': 0.95545775, 'specificity': 0.95545775, 'f1': 0.95525, 'auroc': 0.98798406, 'binary_precision': 0.9793956, 'binary_recall': 0.9308094, 'binary_specificity': 0.9801061, 'binary_f1_score': 0.9544846}
confusion matrix:
      0     1
0  1478    30
1   106  1426
---- Validation: 
scalar performance:
{'acc': 0.8309859, 'precision': 0.83105564, 'recall': 0.83128285, 'specificity': 0.83128285, 'f1': 0.83096564, 'auroc': 0.90025043, 'binary_precision': 0.81619936, 'binary_recall': 0.8424437, 'binary_specificity': 0.82012194, 'binary_f1_score': 0.82911396}
confusion matrix:
     0    1
0  538  118
1   98  524
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.849537, 'precision': 0.8528725, 'recall': 0.849537, 'specificity': 0.849537, 'f1': 0.8491807, 'auroc': 0.9260117, 'binary_precision': 0.8185654, 'binary_recall': 0.8981481, 'binary_specificity': 0.8009259, 'binary_f1_score': 0.8565122}
confusion matrix:
     0    1
0  173   43
1   22  194
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-07-23 04:11:06.953309,epoch time: 0:01:18.043313,used: 0:02:39.473987,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_04_08_27_seed_2_22769265
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9743421, 'precision': 0.9743353, 'recall': 0.97435504, 'specificity': 0.97435504, 'f1': 0.9743414, 'auroc': 0.99594545, 'binary_precision': 0.97639346, 'binary_recall': 0.97256696, 'binary_specificity': 0.9761431, 'binary_f1_score': 0.97447646}
confusion matrix:
      0     1
0  1473    36
1    42  1489
---- Validation: 
scalar performance:
{'acc': 0.6744914, 'precision': 0.68625164, 'recall': 0.6707611, 'specificity': 0.6707611, 'f1': 0.6661509, 'auroc': 0.7573744, 'binary_precision': 0.72687227, 'binary_recall': 0.5305466, 'binary_specificity': 0.8109756, 'binary_f1_score': 0.6133829}
confusion matrix:
     0    1
0  532  124
1  292  330
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7337963, 'precision': 0.7487742, 'recall': 0.7337963, 'specificity': 0.7337963, 'f1': 0.7297283, 'auroc': 0.86644804, 'binary_precision': 0.68773234, 'binary_recall': 0.8564815, 'binary_specificity': 0.6111111, 'binary_f1_score': 0.76288664}
confusion matrix:
     0    1
0  132   84
1   31  185
early stop counter: 1
val acc:0.6744914054870605, best validation acc: 0.8309859037399292, corresponding to test acc:                         0.8495370149612427 / 0.8495370149612427
after epoch: 3,now: 2024-07-23 04:12:23.609707,epoch time: 0:01:16.656398,used: 0:03:56.130385,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_04_08_27_seed_2_22769265
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.97664475, 'precision': 0.9773019, 'recall': 0.9768203, 'specificity': 0.9768203, 'f1': 0.9766413, 'auroc': 0.9972249, 'binary_precision': 0.9972789, 'binary_recall': 0.95629483, 'binary_specificity': 0.99734575, 'binary_f1_score': 0.976357}
confusion matrix:
      0     1
0  1503     4
1    67  1466
---- Validation: 
scalar performance:
{'acc': 0.6776213, 'precision': 0.764765, 'recall': 0.6697685, 'specificity': 0.6697685, 'f1': 0.64261067, 'auroc': 0.84681106, 'binary_precision': 0.91015625, 'binary_recall': 0.37459806, 'binary_specificity': 0.964939, 'binary_f1_score': 0.5307517}
confusion matrix:
     0    1
0  633   23
1  389  233
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8055556, 'precision': 0.8187835, 'recall': 0.8055556, 'specificity': 0.8055556, 'f1': 0.8035173, 'auroc': 0.9072574, 'binary_precision': 0.88372093, 'binary_recall': 0.7037037, 'binary_specificity': 0.9074074, 'binary_f1_score': 0.78350514}
confusion matrix:
     0    1
0  196   20
1   64  152
early stop counter: 2
val acc:0.6776213049888611, best validation acc: 0.8309859037399292, corresponding to test acc:                         0.8495370149612427 / 0.8495370149612427
after epoch: 4,now: 2024-07-23 04:13:41.741524,epoch time: 0:01:18.131817,used: 0:05:14.262202,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_04_08_27_seed_2_22769265
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.97763157, 'precision': 0.977625, 'recall': 0.97763574, 'specificity': 0.97763574, 'f1': 0.9776299, 'auroc': 0.99682975, 'binary_precision': 0.97845954, 'binary_recall': 0.9771838, 'binary_specificity': 0.97808766, 'binary_f1_score': 0.9778213}
confusion matrix:
      0     1
0  1473    33
1    35  1499
---- Validation: 
scalar performance:
{'acc': 0.6455399, 'precision': 0.7514919, 'recall': 0.6366437, 'specificity': 0.6366437, 'f1': 0.595627, 'auroc': 0.8224741, 'binary_precision': 0.90821254, 'binary_recall': 0.3022508, 'binary_specificity': 0.9710366, 'binary_f1_score': 0.45355853}
confusion matrix:
     0    1
0  637   19
1  434  188
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8171296, 'precision': 0.82076657, 'recall': 0.8171296, 'specificity': 0.8171296, 'f1': 0.81660986, 'auroc': 0.8976551, 'binary_precision': 0.8549223, 'binary_recall': 0.7638889, 'binary_specificity': 0.8703704, 'binary_f1_score': 0.80684596}
confusion matrix:
     0    1
0  188   28
1   51  165
early stop counter: 3
val acc:0.6455398797988892, best validation acc: 0.8309859037399292, corresponding to test acc:                         0.8495370149612427 / 0.8495370149612427
after epoch: 5,now: 2024-07-23 04:15:00.750849,epoch time: 0:01:19.009325,used: 0:06:33.271527,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_04_08_27_seed_2_22769265
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9753289, 'precision': 0.97538626, 'recall': 0.9754252, 'specificity': 0.9754252, 'f1': 0.9753288, 'auroc': 0.99577683, 'binary_precision': 0.98410594, 'binary_recall': 0.96681845, 'binary_specificity': 0.9840319, 'binary_f1_score': 0.9753856}
confusion matrix:
      0     1
0  1479    24
1    51  1486
---- Validation: 
scalar performance:
{'acc': 0.81064165, 'precision': 0.81313133, 'recall': 0.81179905, 'specificity': 0.81179905, 'f1': 0.8105507, 'auroc': 0.8887955, 'binary_precision': 0.7777778, 'binary_recall': 0.8553055, 'binary_specificity': 0.76829267, 'binary_f1_score': 0.8147014}
confusion matrix:
     0    1
0  504  152
1   90  532
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8009259, 'precision': 0.8165585, 'recall': 0.8009259, 'specificity': 0.8009259, 'f1': 0.7984376, 'auroc': 0.9149306, 'binary_precision': 0.7462121, 'binary_recall': 0.912037, 'binary_specificity': 0.6898148, 'binary_f1_score': 0.8208334}
confusion matrix:
     0    1
0  149   67
1   19  197
early stop counter: 4
val acc:0.8106416463851929, best validation acc: 0.8309859037399292, corresponding to test acc:                         0.8495370149612427 / 0.8495370149612427
after epoch: 6,now: 2024-07-23 04:16:18.077491,epoch time: 0:01:17.326642,used: 0:07:50.598169,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_04_08_27_seed_2_22769265
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9519737, 'precision': 0.95568955, 'recall': 0.95162785, 'specificity': 0.95162785, 'f1': 0.9518469, 'auroc': 0.9981694, 'binary_precision': 0.91646636, 'binary_recall': 0.9954308, 'binary_specificity': 0.90782493, 'binary_f1_score': 0.9543179}
confusion matrix:
      0     1
0  1369   139
1     7  1525
---- Validation: 
scalar performance:
{'acc': 0.68388104, 'precision': 0.742437, 'recall': 0.6901983, 'specificity': 0.6901983, 'f1': 0.66794175, 'auroc': 0.86971366, 'binary_precision': 0.616453, 'binary_recall': 0.9276527, 'binary_specificity': 0.4527439, 'binary_f1_score': 0.74069315}
confusion matrix:
     0    1
0  297  359
1   45  577
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5555556, 'precision': 0.7291372, 'recall': 0.5555555, 'specificity': 0.5555555, 'f1': 0.45171863, 'auroc': 0.8469865, 'binary_precision': 0.52970296, 'binary_recall': 0.9907407, 'binary_specificity': 0.12037037, 'binary_f1_score': 0.6903225}
confusion matrix:
    0    1
0  26  190
1   2  214
early stop counter: 5
val acc:0.6838810443878174, best validation acc: 0.8309859037399292, corresponding to test acc:                         0.8495370149612427 / 0.8495370149612427
after epoch: 7,now: 2024-07-23 04:17:35.057506,epoch time: 0:01:16.980015,used: 0:09:07.578184,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_04_08_27_seed_2_22769265
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.97861844, 'precision': 0.9791867, 'recall': 0.97878283, 'specificity': 0.97878283, 'f1': 0.9786159, 'auroc': 0.99911356, 'binary_precision': 0.99796474, 'binary_recall': 0.9595564, 'binary_specificity': 0.99800926, 'binary_f1_score': 0.9783837}
confusion matrix:
      0     1
0  1504     3
1    62  1471
---- Validation: 
scalar performance:
{'acc': 0.6150235, 'precision': 0.7475158, 'recall': 0.60500157, 'specificity': 0.60500157, 'f1': 0.5447874, 'auroc': 0.8332263, 'binary_precision': 0.9220779, 'binary_recall': 0.22829582, 'binary_specificity': 0.98170733, 'binary_f1_score': 0.36597937}
confusion matrix:
     0    1
0  644   12
1  480  142
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5972222, 'precision': 0.6925951, 'recall': 0.5972222, 'specificity': 0.5972222, 'f1': 0.54031307, 'auroc': 0.8196373, 'binary_precision': 0.828125, 'binary_recall': 0.24537037, 'binary_specificity': 0.9490741, 'binary_f1_score': 0.37857142}
confusion matrix:
     0   1
0  205  11
1  163  53
early stop counter: 6
val acc:0.6150234937667847, best validation acc: 0.8309859037399292, corresponding to test acc:                         0.8495370149612427 / 0.8495370149612427
after epoch: 8,now: 2024-07-23 04:18:52.522160,epoch time: 0:01:17.464654,used: 0:10:25.042838,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_04_08_27_seed_2_22769265
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9875, 'precision': 0.98750526, 'recall': 0.98749346, 'specificity': 0.98749346, 'f1': 0.98749894, 'auroc': 0.99901044, 'binary_precision': 0.98697066, 'binary_recall': 0.9882583, 'binary_specificity': 0.9867286, 'binary_f1_score': 0.98761404}
confusion matrix:
      0     1
0  1487    20
1    18  1515
---- Validation: 
scalar performance:
{'acc': 0.7402191, 'precision': 0.7721328, 'recall': 0.7354938, 'specificity': 0.7354938, 'f1': 0.72970986, 'auroc': 0.8576386, 'binary_precision': 0.8589109, 'binary_recall': 0.55787784, 'binary_specificity': 0.9131098, 'binary_f1_score': 0.67641324}
confusion matrix:
     0    1
0  599   57
1  275  347
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8101852, 'precision': 0.81343675, 'recall': 0.8101852, 'specificity': 0.8101852, 'f1': 0.80969167, 'auroc': 0.90192044, 'binary_precision': 0.7815126, 'binary_recall': 0.8611111, 'binary_specificity': 0.7592593, 'binary_f1_score': 0.8193833}
confusion matrix:
     0    1
0  164   52
1   30  186
early stop counter: 7
val acc:0.7402191162109375, best validation acc: 0.8309859037399292, corresponding to test acc:                         0.8495370149612427 / 0.8495370149612427
after epoch: 9,now: 2024-07-23 04:20:09.601957,epoch time: 0:01:17.079797,used: 0:11:42.122635,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_04_08_27_seed_2_22769265
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.98717105, 'precision': 0.98717105, 'recall': 0.98723197, 'specificity': 0.98723197, 'f1': 0.98717064, 'auroc': 0.999152, 'binary_precision': 0.99276316, 'binary_recall': 0.9817827, 'binary_specificity': 0.9926813, 'binary_f1_score': 0.9872424}
confusion matrix:
      0     1
0  1492    11
1    28  1509
---- Validation: 
scalar performance:
{'acc': 0.75352114, 'precision': 0.799963, 'recall': 0.7481594, 'specificity': 0.7481594, 'f1': 0.7408117, 'auroc': 0.859761, 'binary_precision': 0.91152817, 'binary_recall': 0.54662377, 'binary_specificity': 0.9496951, 'binary_f1_score': 0.6834171}
confusion matrix:
     0    1
0  623   33
1  282  340
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8310185, 'precision': 0.84747005, 'recall': 0.8310185, 'specificity': 0.8310185, 'f1': 0.8289944, 'auroc': 0.90929353, 'binary_precision': 0.9230769, 'binary_recall': 0.7222222, 'binary_specificity': 0.9398148, 'binary_f1_score': 0.81038964}
confusion matrix:
     0    1
0  203   13
1   60  156
early stop counter: 8
val acc:0.7535211443901062, best validation acc: 0.8309859037399292, corresponding to test acc:                         0.8495370149612427 / 0.8495370149612427
after epoch: 10,now: 2024-07-23 04:21:26.875840,epoch time: 0:01:17.273883,used: 0:12:59.396518,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_04_08_27_seed_2_22769265
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.98980266, 'precision': 0.98980486, 'recall': 0.9897987, 'specificity': 0.9897987, 'f1': 0.98980176, 'auroc': 0.99960434, 'binary_precision': 0.9895765, 'binary_recall': 0.9902216, 'binary_specificity': 0.9893758, 'binary_f1_score': 0.989899}
confusion matrix:
      0     1
0  1490    16
1    15  1519
---- Validation: 
scalar performance:
{'acc': 0.7597809, 'precision': 0.77319443, 'recall': 0.75667346, 'specificity': 0.75667346, 'f1': 0.7551906, 'auroc': 0.84081393, 'binary_precision': 0.8274428, 'binary_recall': 0.63987136, 'binary_specificity': 0.8734756, 'binary_f1_score': 0.7216681}
confusion matrix:
     0    1
0  573   83
1  224  398
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7662037, 'precision': 0.77943397, 'recall': 0.7662037, 'specificity': 0.7662037, 'f1': 0.7634032, 'auroc': 0.9006773, 'binary_precision': 0.7186312, 'binary_recall': 0.875, 'binary_specificity': 0.6574074, 'binary_f1_score': 0.78914404}
confusion matrix:
     0    1
0  142   74
1   27  189
early stop counter: 9
val acc:0.7597808837890625, best validation acc: 0.8309859037399292, corresponding to test acc:                         0.8495370149612427 / 0.8495370149612427
after epoch: 11,now: 2024-07-23 04:22:43.780805,epoch time: 0:01:16.904965,used: 0:14:16.301483,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_04_08_27_seed_2_22769265
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9868421, 'precision': 0.98707175, 'recall': 0.9869537, 'specificity': 0.9869537, 'f1': 0.9868418, 'auroc': 0.9995252, 'binary_precision': 1.0, 'binary_recall': 0.97390735, 'binary_specificity': 1.0, 'binary_f1_score': 0.98678124}
confusion matrix:
      0     1
0  1507     0
1    40  1493
---- Validation: 
scalar performance:
{'acc': 0.6682316, 'precision': 0.77601063, 'recall': 0.65970564, 'specificity': 0.65970564, 'f1': 0.6254324, 'auroc': 0.87979925, 'binary_precision': 0.94196427, 'binary_recall': 0.3392283, 'binary_specificity': 0.98018295, 'binary_f1_score': 0.498818}
confusion matrix:
     0    1
0  643   13
1  411  211
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5555556, 'precision': 0.7291372, 'recall': 0.5555555, 'specificity': 0.5555555, 'f1': 0.45171863, 'auroc': 0.8483582, 'binary_precision': 0.9285714, 'binary_recall': 0.12037037, 'binary_specificity': 0.9907407, 'binary_f1_score': 0.21311477}
confusion matrix:
     0   1
0  214   2
1  190  26
early stop counter: 10
val acc:0.6682316064834595, best validation acc: 0.8309859037399292, corresponding to test acc:                         0.8495370149612427 / 0.8495370149612427
after epoch: 12,now: 2024-07-23 04:24:00.427595,epoch time: 0:01:16.646790,used: 0:15:32.948273,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_04_08_27_seed_2_22769265
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.98914474, 'precision': 0.98917186, 'recall': 0.9891259, 'specificity': 0.9891259, 'f1': 0.9891436, 'auroc': 0.9991044, 'binary_precision': 0.9870046, 'binary_recall': 0.9915144, 'binary_specificity': 0.98673743, 'binary_f1_score': 0.98925436}
confusion matrix:
      0     1
0  1488    20
1    13  1519
---- Validation: 
scalar performance:
{'acc': 0.75273865, 'precision': 0.75422996, 'recall': 0.7536468, 'specificity': 0.7536468, 'f1': 0.7526896, 'auroc': 0.8197617, 'binary_precision': 0.727003, 'binary_recall': 0.78778136, 'binary_specificity': 0.7195122, 'binary_f1_score': 0.75617284}
confusion matrix:
     0    1
0  472  184
1  132  490
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6851852, 'precision': 0.78070176, 'recall': 0.6851852, 'specificity': 0.6851852, 'f1': 0.65591395, 'auroc': 0.8482939, 'binary_precision': 0.61695904, 'binary_recall': 0.9768519, 'binary_specificity': 0.3935185, 'binary_f1_score': 0.7562724}
confusion matrix:
    0    1
0  85  131
1   5  211
early stop counter: 11
val acc:0.7527386546134949, best validation acc: 0.8309859037399292, corresponding to test acc:                         0.8495370149612427 / 0.8495370149612427
after epoch: 13,now: 2024-07-23 04:25:17.607040,epoch time: 0:01:17.179445,used: 0:16:50.127718,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_04_08_27_seed_2_22769265
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9944079, 'precision': 0.99440396, 'recall': 0.99442905, 'specificity': 0.99442905, 'f1': 0.99440783, 'auroc': 0.9998256, 'binary_precision': 0.99737185, 'binary_recall': 0.99150884, 'binary_specificity': 0.99734926, 'binary_f1_score': 0.99443173}
confusion matrix:
      0     1
0  1505     4
1    13  1518
---- Validation: 
scalar performance:
{'acc': 0.6690141, 'precision': 0.73547155, 'recall': 0.66167605, 'specificity': 0.66167605, 'f1': 0.6378315, 'auroc': 0.8180412, 'binary_precision': 0.85409254, 'binary_recall': 0.3858521, 'binary_specificity': 0.9375, 'binary_f1_score': 0.53156143}
confusion matrix:
     0    1
0  615   41
1  382  240
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7847222, 'precision': 0.7864969, 'recall': 0.7847222, 'specificity': 0.7847222, 'f1': 0.7843883, 'auroc': 0.8633188, 'binary_precision': 0.80904526, 'binary_recall': 0.7453704, 'binary_specificity': 0.8240741, 'binary_f1_score': 0.7759036}
confusion matrix:
     0    1
0  178   38
1   55  161
early stop counter: 12
val acc:0.6690140962600708, best validation acc: 0.8309859037399292, corresponding to test acc:                         0.8495370149612427 / 0.8495370149612427
after epoch: 14,now: 2024-07-23 04:26:34.564368,epoch time: 0:01:16.957328,used: 0:18:07.085046,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_04_08_27_seed_2_22769265
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9888158, 'precision': 0.9888227, 'recall': 0.98886335, 'specificity': 0.98886335, 'f1': 0.9888156, 'auroc': 0.99829835, 'binary_precision': 0.9940711, 'binary_recall': 0.9837027, 'binary_specificity': 0.9940239, 'binary_f1_score': 0.9888597}
confusion matrix:
      0     1
0  1497     9
1    25  1509
---- Validation: 
scalar performance:
{'acc': 0.7394366, 'precision': 0.7613485, 'recall': 0.7353982, 'specificity': 0.7353982, 'f1': 0.7315538, 'auroc': 0.83769906, 'binary_precision': 0.8306636, 'binary_recall': 0.5836013, 'binary_specificity': 0.8871951, 'binary_f1_score': 0.6855524}
confusion matrix:
     0    1
0  582   74
1  259  363
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.787037, 'precision': 0.7871355, 'recall': 0.787037, 'specificity': 0.787037, 'f1': 0.7870188, 'auroc': 0.8694916, 'binary_precision': 0.7818182, 'binary_recall': 0.7962963, 'binary_specificity': 0.7777778, 'binary_f1_score': 0.78899086}
confusion matrix:
     0    1
0  168   48
1   44  172
early stop counter: 13
val acc:0.7394366264343262, best validation acc: 0.8309859037399292, corresponding to test acc:                         0.8495370149612427 / 0.8495370149612427
after epoch: 15,now: 2024-07-23 04:27:50.243160,epoch time: 0:01:15.678792,used: 0:19:22.763838,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_04_08_27_seed_2_22769265
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9907895, 'precision': 0.9907889, 'recall': 0.9907889, 'specificity': 0.9907889, 'f1': 0.9907889, 'auroc': 0.9995456, 'binary_precision': 0.9908616, 'binary_recall': 0.9908616, 'binary_specificity': 0.99071616, 'binary_f1_score': 0.9908616}
confusion matrix:
      0     1
0  1494    14
1    14  1518
---- Validation: 
scalar performance:
{'acc': 0.7918623, 'precision': 0.8143605, 'recall': 0.78821516, 'specificity': 0.78821516, 'f1': 0.7865292, 'auroc': 0.8811711, 'binary_precision': 0.8920705, 'binary_recall': 0.65112543, 'binary_specificity': 0.9253049, 'binary_f1_score': 0.75278807}
confusion matrix:
     0    1
0  607   49
1  217  405
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8078704, 'precision': 0.8182453, 'recall': 0.8078704, 'specificity': 0.8078704, 'f1': 0.80629164, 'auroc': 0.88878167, 'binary_precision': 0.8757062, 'binary_recall': 0.7175926, 'binary_specificity': 0.8981481, 'binary_f1_score': 0.78880405}
confusion matrix:
     0    1
0  194   22
1   61  155
early stop counter: 14
val acc:0.7918623089790344, best validation acc: 0.8309859037399292, corresponding to test acc:                         0.8495370149612427 / 0.8495370149612427
after epoch: 16,now: 2024-07-23 04:29:07.672469,epoch time: 0:01:17.429309,used: 0:20:40.193147,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_04_08_27_seed_2_22769265
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.98618424, 'precision': 0.9862608, 'recall': 0.9862305, 'specificity': 0.9862305, 'f1': 0.9861841, 'auroc': 0.9981911, 'binary_precision': 0.9940199, 'binary_recall': 0.9784173, 'binary_specificity': 0.9940437, 'binary_f1_score': 0.9861569}
confusion matrix:
      0     1
0  1502     9
1    33  1496
---- Validation: 
scalar performance:
{'acc': 0.63302034, 'precision': 0.7562258, 'recall': 0.623532, 'specificity': 0.623532, 'f1': 0.5736227, 'auroc': 0.85858405, 'binary_precision': 0.9273743, 'binary_recall': 0.26688102, 'binary_specificity': 0.98018295, 'binary_f1_score': 0.41448188}
confusion matrix:
     0    1
0  643   13
1  456  166
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6342593, 'precision': 0.71428573, 'recall': 0.6342592, 'specificity': 0.6342592, 'f1': 0.59659576, 'auroc': 0.8489369, 'binary_precision': 0.8452381, 'binary_recall': 0.3287037, 'binary_specificity': 0.9398148, 'binary_f1_score': 0.47333333}
confusion matrix:
     0   1
0  203  13
1  145  71
early stop counter: 15
val acc:0.6330203413963318, best validation acc: 0.8309859037399292, corresponding to test acc:                         0.8495370149612427 / 0.8495370149612427
after epoch: 17,now: 2024-07-23 04:30:24.381543,epoch time: 0:01:16.709074,used: 0:21:56.902221,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_04_08_27_seed_2_22769265
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.98914474, 'precision': 0.9891392, 'recall': 0.9891513, 'specificity': 0.9891513, 'f1': 0.98914427, 'auroc': 0.99913216, 'binary_precision': 0.99018323, 'binary_recall': 0.988243, 'binary_specificity': 0.9900596, 'binary_f1_score': 0.98921216}
confusion matrix:
      0     1
0  1494    15
1    18  1513
---- Validation: 
scalar performance:
{'acc': 0.557903, 'precision': 0.73147273, 'recall': 0.54602826, 'specificity': 0.54602826, 'f1': 0.43867323, 'auroc': 0.8459839, 'binary_precision': 0.92537314, 'binary_recall': 0.09967846, 'binary_specificity': 0.99237806, 'binary_f1_score': 0.17997098}
confusion matrix:
     0   1
0  651   5
1  560  62
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5555556, 'precision': 0.71492535, 'recall': 0.5555556, 'specificity': 0.5555556, 'f1': 0.45441628, 'auroc': 0.853095, 'binary_precision': 0.9, 'binary_recall': 0.125, 'binary_specificity': 0.9861111, 'binary_f1_score': 0.2195122}
confusion matrix:
     0   1
0  213   3
1  189  27
early stop counter: 16
val acc:0.557902991771698, best validation acc: 0.8309859037399292, corresponding to test acc:                         0.8495370149612427 / 0.8495370149612427
after epoch: 18,now: 2024-07-23 04:31:40.379005,epoch time: 0:01:15.997462,used: 0:23:12.899683,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_04_08_27_seed_2_22769265
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9894737, 'precision': 0.98953485, 'recall': 0.98951614, 'specificity': 0.98951614, 'f1': 0.9894737, 'auroc': 0.9996338, 'binary_precision': 0.99668217, 'binary_recall': 0.9823414, 'binary_specificity': 0.9966909, 'binary_f1_score': 0.9894598}
confusion matrix:
      0     1
0  1506     5
1    27  1502
---- Validation: 
scalar performance:
{'acc': 0.71596247, 'precision': 0.79672337, 'recall': 0.708866, 'specificity': 0.708866, 'f1': 0.6907362, 'auroc': 0.89639235, 'binary_precision': 0.94501716, 'binary_recall': 0.4421222, 'binary_specificity': 0.9756098, 'binary_f1_score': 0.60240966}
confusion matrix:
     0    1
0  640   16
1  347  275
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6875, 'precision': 0.79659265, 'recall': 0.6875, 'specificity': 0.6875, 'f1': 0.65585405, 'auroc': 0.88925326, 'binary_precision': 0.9764706, 'binary_recall': 0.38425925, 'binary_specificity': 0.9907407, 'binary_f1_score': 0.551495}
confusion matrix:
     0   1
0  214   2
1  133  83
early stop counter: 17
val acc:0.7159624695777893, best validation acc: 0.8309859037399292, corresponding to test acc:                         0.8495370149612427 / 0.8495370149612427
after epoch: 19,now: 2024-07-23 04:32:57.174523,epoch time: 0:01:16.795518,used: 0:24:29.695201,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_04_08_27_seed_2_22769265
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.99407893, 'precision': 0.9941176, 'recall': 0.99411, 'specificity': 0.99411, 'f1': 0.994079, 'auroc': 0.99976754, 'binary_precision': 1.0, 'binary_recall': 0.9882199, 'binary_specificity': 1.0, 'binary_f1_score': 0.99407506}
confusion matrix:
      0     1
0  1512     0
1    18  1510
---- Validation: 
scalar performance:
{'acc': 0.74413145, 'precision': 0.7877519, 'recall': 0.7388048, 'specificity': 0.7388048, 'f1': 0.7311331, 'auroc': 0.8754583, 'binary_precision': 0.8933333, 'binary_recall': 0.5385852, 'binary_specificity': 0.9390244, 'binary_f1_score': 0.672016}
confusion matrix:
     0    1
0  616   40
1  287  335
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7939815, 'precision': 0.7958138, 'recall': 0.79398143, 'specificity': 0.79398143, 'f1': 0.79366195, 'auroc': 0.88721704, 'binary_precision': 0.8190955, 'binary_recall': 0.7546296, 'binary_specificity': 0.8333333, 'binary_f1_score': 0.78554213}
confusion matrix:
     0    1
0  180   36
1   53  163
early stop counter: 18
val acc:0.7441314458847046, best validation acc: 0.8309859037399292, corresponding to test acc:                         0.8495370149612427 / 0.8495370149612427
after epoch: 20,now: 2024-07-23 04:34:13.370371,epoch time: 0:01:16.195848,used: 0:25:45.891049,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_04_08_27_seed_2_22769265
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9894737, 'precision': 0.98960364, 'recall': 0.989563, 'specificity': 0.989563, 'f1': 0.98947364, 'auroc': 0.9997307, 'binary_precision': 1.0, 'binary_recall': 0.9791259, 'binary_specificity': 1.0, 'binary_f1_score': 0.98945284}
confusion matrix:
      0     1
0  1507     0
1    32  1501
---- Validation: 
scalar performance:
{'acc': 0.64397496, 'precision': 0.77896357, 'recall': 0.63449436, 'specificity': 0.63449436, 'f1': 0.5863504, 'auroc': 0.8986623, 'binary_precision': 0.96648043, 'binary_recall': 0.27813506, 'binary_specificity': 0.99085367, 'binary_f1_score': 0.43196005}
confusion matrix:
     0    1
0  650    6
1  449  173
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6597222, 'precision': 0.77831936, 'recall': 0.6597222, 'specificity': 0.6597222, 'f1': 0.6191504, 'auroc': 0.86381173, 'binary_precision': 0.96, 'binary_recall': 0.33333334, 'binary_specificity': 0.9861111, 'binary_f1_score': 0.49484536}
confusion matrix:
     0   1
0  213   3
1  144  72
early stop counter: 19
val acc:0.6439749598503113, best validation acc: 0.8309859037399292, corresponding to test acc:                         0.8495370149612427 / 0.8495370149612427
after epoch: 21,now: 2024-07-23 04:35:29.420205,epoch time: 0:01:16.049834,used: 0:27:01.940883,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_04_08_27_seed_2_22769265
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.99210525, 'precision': 0.9921106, 'recall': 0.9920996, 'specificity': 0.9920996, 'f1': 0.99210465, 'auroc': 0.99985373, 'binary_precision': 0.9915254, 'binary_recall': 0.99281985, 'binary_specificity': 0.9913793, 'binary_f1_score': 0.99217224}
confusion matrix:
      0     1
0  1495    13
1    11  1521
---- Validation: 
scalar performance:
{'acc': 0.69170576, 'precision': 0.76407826, 'recall': 0.68452966, 'specificity': 0.68452966, 'f1': 0.66383237, 'auroc': 0.85481036, 'binary_precision': 0.8958333, 'binary_recall': 0.414791, 'binary_specificity': 0.9542683, 'binary_f1_score': 0.56703293}
confusion matrix:
     0    1
0  626   30
1  364  258
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.775463, 'precision': 0.8047881, 'recall': 0.775463, 'specificity': 0.775463, 'f1': 0.76992893, 'auroc': 0.8954475, 'binary_precision': 0.8993289, 'binary_recall': 0.6203704, 'binary_specificity': 0.9305556, 'binary_f1_score': 0.73424655}
confusion matrix:
     0    1
0  201   15
1   82  134
early stop counter: 20
val acc:0.6917057633399963, best validation acc: 0.8309859037399292, corresponding to test acc:                         0.8495370149612427 / 0.8495370149612427
after epoch: 22,now: 2024-07-23 04:36:45.363033,epoch time: 0:01:15.942828,used: 0:28:17.883711,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_04_08_27_seed_2_22769265
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.97598684, 'precision': 0.97677076, 'recall': 0.97580594, 'specificity': 0.97580594, 'f1': 0.975968, 'auroc': 0.9990901, 'binary_precision': 0.95974845, 'binary_recall': 0.9941368, 'binary_specificity': 0.95747507, 'binary_f1_score': 0.9766399}
confusion matrix:
      0     1
0  1441    64
1     9  1526
---- Validation: 
scalar performance:
{'acc': 0.82159626, 'precision': 0.83367944, 'recall': 0.81901175, 'specificity': 0.81901175, 'f1': 0.8190364, 'auroc': 0.9066875, 'binary_precision': 0.890873, 'binary_recall': 0.72186494, 'binary_specificity': 0.91615856, 'binary_f1_score': 0.79751337}
confusion matrix:
     0    1
0  601   55
1  173  449
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8217593, 'precision': 0.82376474, 'recall': 0.8217592, 'specificity': 0.8217592, 'f1': 0.82148284, 'auroc': 0.89353997, 'binary_precision': 0.7982833, 'binary_recall': 0.8611111, 'binary_specificity': 0.7824074, 'binary_f1_score': 0.8285078}
confusion matrix:
     0    1
0  169   47
1   30  186
early stop counter: 21
val acc:0.8215962648391724, best validation acc: 0.8309859037399292, corresponding to test acc:                         0.8495370149612427 / 0.8495370149612427
after epoch: 23,now: 2024-07-23 04:38:01.225516,epoch time: 0:01:15.862483,used: 0:29:33.746194,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_04_08_27_seed_2_22769265
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.96842104, 'precision': 0.97, 'recall': 0.96875, 'specificity': 0.96875, 'f1': 0.96840703, 'auroc': 0.99949265, 'binary_precision': 1.0, 'binary_recall': 0.9375, 'binary_specificity': 1.0, 'binary_f1_score': 0.9677419}
confusion matrix:
      0     1
0  1504     0
1    96  1440
---- Validation: 
scalar performance:
{'acc': 0.52347416, 'precision': 0.75928855, 'recall': 0.5104502, 'specificity': 0.5104502, 'f1': 0.36196125, 'auroc': 0.8703877, 'binary_precision': 1.0, 'binary_recall': 0.020900322, 'binary_specificity': 1.0, 'binary_f1_score': 0.04094488}
confusion matrix:
     0   1
0  656   0
1  609  13
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5162037, 'precision': 0.7541176, 'recall': 0.5162037, 'specificity': 0.5162037, 'f1': 0.36836362, 'auroc': 0.8547454, 'binary_precision': 1.0, 'binary_recall': 0.032407407, 'binary_specificity': 1.0, 'binary_f1_score': 0.06278027}
confusion matrix:
     0  1
0  216  0
1  209  7
early stop counter: 22
val acc:0.5234741568565369, best validation acc: 0.8309859037399292, corresponding to test acc:                         0.8495370149612427 / 0.8495370149612427
after epoch: 24,now: 2024-07-23 04:39:18.779882,epoch time: 0:01:17.554366,used: 0:30:51.300560,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_04_08_27_seed_2_22769265
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.9904605, 'precision': 0.99050987, 'recall': 0.99052453, 'specificity': 0.99052453, 'f1': 0.9904605, 'auroc': 0.99971044, 'binary_precision': 0.99801326, 'binary_recall': 0.9830398, 'binary_specificity': 0.99800926, 'binary_f1_score': 0.9904699}
confusion matrix:
      0     1
0  1504     3
1    26  1507
---- Validation: 
scalar performance:
{'acc': 0.7942097, 'precision': 0.827827, 'recall': 0.78987676, 'specificity': 0.78987676, 'f1': 0.7870079, 'auroc': 0.9013313, 'binary_precision': 0.9263658, 'binary_recall': 0.62700963, 'binary_specificity': 0.9527439, 'binary_f1_score': 0.7478427}
confusion matrix:
     0    1
0  625   31
1  232  390
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7384259, 'precision': 0.77524436, 'recall': 0.73842597, 'specificity': 0.73842597, 'f1': 0.72937584, 'auroc': 0.8565887, 'binary_precision': 0.8759124, 'binary_recall': 0.5555556, 'binary_specificity': 0.9212963, 'binary_f1_score': 0.6798867}
confusion matrix:
     0    1
0  199   17
1   96  120
early stop counter: 23
val acc:0.7942097187042236, best validation acc: 0.8309859037399292, corresponding to test acc:                         0.8495370149612427 / 0.8495370149612427
after epoch: 25,now: 2024-07-23 04:40:35.314941,epoch time: 0:01:16.535059,used: 0:32:07.835619,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_04_08_27_seed_2_22769265
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9924342, 'precision': 0.99248385, 'recall': 0.9924793, 'specificity': 0.9924793, 'f1': 0.99243426, 'auroc': 0.99976456, 'binary_precision': 0.9993373, 'binary_recall': 0.9856209, 'binary_specificity': 0.99933773, 'binary_f1_score': 0.99243176}
confusion matrix:
      0     1
0  1509     1
1    22  1508
---- Validation: 
scalar performance:
{'acc': 0.6103286, 'precision': 0.7693162, 'recall': 0.5998451, 'specificity': 0.5998451, 'f1': 0.5315815, 'auroc': 0.90305233, 'binary_precision': 0.969697, 'binary_recall': 0.20578778, 'binary_specificity': 0.99390244, 'binary_f1_score': 0.33952254}
confusion matrix:
     0    1
0  652    4
1  494  128
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5092593, 'precision': 0.75233644, 'recall': 0.5092593, 'specificity': 0.5092593, 'f1': 0.35358554, 'auroc': 0.8230238, 'binary_precision': 1.0, 'binary_recall': 0.018518519, 'binary_specificity': 1.0, 'binary_f1_score': 0.036363635}
confusion matrix:
     0  1
0  216  0
1  212  4
early stop counter: 24
val acc:0.6103286147117615, best validation acc: 0.8309859037399292, corresponding to test acc:                         0.8495370149612427 / 0.8495370149612427
after epoch: 26,now: 2024-07-23 04:41:52.644868,epoch time: 0:01:17.329927,used: 0:33:25.165546,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_04_08_27_seed_2_22769265
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.9944079, 'precision': 0.99444216, 'recall': 0.99439013, 'specificity': 0.99439013, 'f1': 0.9944074, 'auroc': 0.9998965, 'binary_precision': 0.99154747, 'binary_recall': 0.9973839, 'binary_specificity': 0.9913964, 'binary_f1_score': 0.99445707}
confusion matrix:
      0     1
0  1498    13
1     4  1525
---- Validation: 
scalar performance:
{'acc': 0.700313, 'precision': 0.7797237, 'recall': 0.69303876, 'specificity': 0.69303876, 'f1': 0.6724075, 'auroc': 0.874081, 'binary_precision': 0.9222615, 'binary_recall': 0.41961414, 'binary_specificity': 0.9664634, 'binary_f1_score': 0.5767956}
confusion matrix:
     0    1
0  634   22
1  361  261
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7037037, 'precision': 0.74, 'recall': 0.7037037, 'specificity': 0.7037037, 'f1': 0.69206095, 'auroc': 0.8173654, 'binary_precision': 0.8333333, 'binary_recall': 0.5092593, 'binary_specificity': 0.8981481, 'binary_f1_score': 0.6321839}
confusion matrix:
     0    1
0  194   22
1  106  110
early stop counter: 25
val acc:0.7003129720687866, best validation acc: 0.8309859037399292, corresponding to test acc:                         0.8495370149612427 / 0.8495370149612427
after epoch: 27,now: 2024-07-23 04:43:08.274100,epoch time: 0:01:15.629232,used: 0:34:40.794778,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_04_08_27_seed_2_22769265
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.99276316, 'precision': 0.9927903, 'recall': 0.9928056, 'specificity': 0.9928056, 'f1': 0.99276316, 'auroc': 0.9999182, 'binary_precision': 0.99867815, 'binary_recall': 0.9869366, 'binary_specificity': 0.99867463, 'binary_f1_score': 0.9927727}
confusion matrix:
      0     1
0  1507     2
1    20  1511
---- Validation: 
scalar performance:
{'acc': 0.58450705, 'precision': 0.77099496, 'recall': 0.5731928, 'specificity': 0.5731928, 'f1': 0.4844562, 'auroc': 0.859364, 'binary_precision': 0.9892473, 'binary_recall': 0.14790997, 'binary_specificity': 0.9984756, 'binary_f1_score': 0.25734264}
confusion matrix:
     0   1
0  655   1
1  530  92
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.525463, 'precision': 0.68992805, 'recall': 0.5254629, 'specificity': 0.5254629, 'f1': 0.39434975, 'auroc': 0.7499357, 'binary_precision': 0.8666667, 'binary_recall': 0.060185187, 'binary_specificity': 0.9907407, 'binary_f1_score': 0.11255411}
confusion matrix:
     0   1
0  214   2
1  203  13
early stop counter: 26
val acc:0.5845070481300354, best validation acc: 0.8309859037399292, corresponding to test acc:                         0.8495370149612427 / 0.8495370149612427
after epoch: 28,now: 2024-07-23 04:44:24.733325,epoch time: 0:01:16.459225,used: 0:35:57.254003,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_04_08_27_seed_2_22769265
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9950658, 'precision': 0.99507546, 'recall': 0.99510443, 'specificity': 0.99510443, 'f1': 0.99506575, 'auroc': 0.9999291, 'binary_precision': 1.0, 'binary_recall': 0.99020886, 'binary_specificity': 1.0, 'binary_f1_score': 0.99508035}
confusion matrix:
      0     1
0  1508     0
1    15  1517
---- Validation: 
scalar performance:
{'acc': 0.7230047, 'precision': 0.79921085, 'recall': 0.71614236, 'specificity': 0.71614236, 'f1': 0.6999856, 'auroc': 0.8939011, 'binary_precision': 0.9437086, 'binary_recall': 0.45819935, 'binary_specificity': 0.9740854, 'binary_f1_score': 0.6168831}
confusion matrix:
     0    1
0  639   17
1  337  285
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7175926, 'precision': 0.74, 'recall': 0.7175926, 'specificity': 0.7175926, 'f1': 0.7108433, 'auroc': 0.82439554, 'binary_precision': 0.81333333, 'binary_recall': 0.5648148, 'binary_specificity': 0.8703704, 'binary_f1_score': 0.6666667}
confusion matrix:
     0    1
0  188   28
1   94  122
early stop counter: 27
val acc:0.7230046987533569, best validation acc: 0.8309859037399292, corresponding to test acc:                         0.8495370149612427 / 0.8495370149612427
after epoch: 29,now: 2024-07-23 04:45:42.249200,epoch time: 0:01:17.515875,used: 0:37:14.769878,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_04_08_27_seed_2_22769265
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.99572366, 'precision': 0.99572086, 'recall': 0.9957627, 'specificity': 0.9957627, 'f1': 0.99572355, 'auroc': 0.9997784, 'binary_precision': 1.0, 'binary_recall': 0.9915254, 'binary_specificity': 1.0, 'binary_f1_score': 0.99574465}
confusion matrix:
      0     1
0  1506     0
1    13  1521
---- Validation: 
scalar performance:
{'acc': 0.62989044, 'precision': 0.7668627, 'recall': 0.62010825, 'specificity': 0.62010825, 'f1': 0.5658004, 'auroc': 0.90209347, 'binary_precision': 0.95151514, 'binary_recall': 0.25241157, 'binary_specificity': 0.9878049, 'binary_f1_score': 0.39898348}
confusion matrix:
     0    1
0  648    8
1  465  157
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5810185, 'precision': 0.74662364, 'recall': 0.5810185, 'specificity': 0.5810185, 'f1': 0.49649376, 'auroc': 0.8362268, 'binary_precision': 0.94871795, 'binary_recall': 0.1712963, 'binary_specificity': 0.9907407, 'binary_f1_score': 0.2901961}
confusion matrix:
     0   1
0  214   2
1  179  37
early stop counter: 28
val acc:0.6298904418945312, best validation acc: 0.8309859037399292, corresponding to test acc:                         0.8495370149612427 / 0.8495370149612427
after epoch: 30,now: 2024-07-23 04:46:59.283017,epoch time: 0:01:17.033817,used: 0:38:31.803695,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_04_08_27_seed_2_22769265
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 0:38:31.803695 at 2024-07-23 04:46:59.283017
persisted model performance metric: 

scalar performance:
{'acc': 0.849537, 'precision': 0.8528725, 'recall': 0.849537, 'specificity': 0.849537, 'f1': 0.8491807, 'auroc': 0.9260117, 'binary_precision': 0.8185654, 'binary_recall': 0.8981481, 'binary_specificity': 0.8009259, 'binary_f1_score': 0.8565122}
confusion matrix:
     0    1
0  173   43
1   22  194
oracle model performance metric: 

scalar performance:
{'acc': 0.849537, 'precision': 0.8528725, 'recall': 0.849537, 'specificity': 0.849537, 'f1': 0.8491807, 'auroc': 0.9260117, 'binary_precision': 0.8185654, 'binary_recall': 0.8981481, 'binary_specificity': 0.8009259, 'binary_f1_score': 0.8565122}
confusion matrix:
     0    1
0  173   43
1   22  194
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_dial_lr1e5_bs16_allfreeze_2024-07-22_23-46-53/rule_results/5.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_dial_lr1e5_bs16_allfreeze_2024-07-22_23-46-53/confusion_matrix/5.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 451685 KiB |  26075 MiB | 215765 GiB | 215764 GiB |
|       from large pool | 411132 KiB |  26030 MiB | 214419 GiB | 214418 GiB |
|       from small pool |  40553 KiB |     60 MiB |   1346 GiB |   1346 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 451685 KiB |  26075 MiB | 215765 GiB | 215764 GiB |
|       from large pool | 411132 KiB |  26030 MiB | 214419 GiB | 214418 GiB |
|       from small pool |  40553 KiB |     60 MiB |   1346 GiB |   1346 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 447481 KiB |  26071 MiB | 215725 GiB | 215724 GiB |
|       from large pool | 407075 KiB |  26026 MiB | 214381 GiB | 214380 GiB |
|       from small pool |  40406 KiB |     60 MiB |   1343 GiB |   1343 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  27778 MiB |  27778 MiB |  80918 MiB |  53140 MiB |
|       from large pool |  27710 MiB |  27710 MiB |  80820 MiB |  53110 MiB |
|       from small pool |     68 MiB |     72 MiB |     98 MiB |     30 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 775066 KiB |   1679 MiB |  97330 GiB |  97329 GiB |
|       from large pool | 758276 KiB |   1676 MiB |  95974 GiB |  95973 GiB |
|       from small pool |  16790 KiB |     35 MiB |   1355 GiB |   1355 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    1220    |    2570    |   19515 K  |   19514 K  |
|       from large pool |     187    |    1413    |    9879 K  |    9879 K  |
|       from small pool |    1033    |    1335    |    9636 K  |    9635 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    1220    |    2570    |   19515 K  |   19514 K  |
|       from large pool |     187    |    1413    |    9879 K  |    9879 K  |
|       from small pool |    1033    |    1335    |    9636 K  |    9635 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     837    |     837    |    2371    |    1534    |
|       from large pool |     803    |     803    |    2322    |    1519    |
|       from small pool |      34    |      36    |      49    |      15    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     111    |     851    |   14239 K  |   14239 K  |
|       from large pool |      47    |     805    |    8786 K  |    8786 K  |
|       from small pool |      64    |     148    |    5453 K  |    5453 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  26075 MiB | 215765 GiB | 215765 GiB |
|       from large pool |  16640 KiB |  26030 MiB | 214419 GiB | 214419 GiB |
|       from small pool |      0 KiB |     60 MiB |   1346 GiB |   1346 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  26075 MiB | 215765 GiB | 215765 GiB |
|       from large pool |  16640 KiB |  26030 MiB | 214419 GiB | 214419 GiB |
|       from small pool |      0 KiB |     60 MiB |   1346 GiB |   1346 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  26071 MiB | 215725 GiB | 215725 GiB |
|       from large pool |  16640 KiB |  26026 MiB | 214381 GiB | 214381 GiB |
|       from small pool |      0 KiB |     60 MiB |   1343 GiB |   1343 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1198 MiB |  27778 MiB |  80918 MiB |  79720 MiB |
|       from large pool |   1142 MiB |  27710 MiB |  80820 MiB |  79678 MiB |
|       from small pool |     56 MiB |     72 MiB |     98 MiB |     42 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |   3840 KiB |   1679 MiB |  97330 GiB |  97330 GiB |
|       from large pool |   3840 KiB |   1676 MiB |  95974 GiB |  95974 GiB |
|       from small pool |      0 KiB |     35 MiB |   1355 GiB |   1355 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    2570    |   19515 K  |   19515 K  |
|       from large pool |       2    |    1413    |    9879 K  |    9879 K  |
|       from small pool |       0    |    1335    |    9636 K  |    9636 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    2570    |   19515 K  |   19515 K  |
|       from large pool |       2    |    1413    |    9879 K  |    9879 K  |
|       from small pool |       0    |    1335    |    9636 K  |    9636 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      71    |     837    |    2371    |    2300    |
|       from large pool |      43    |     803    |    2322    |    2279    |
|       from small pool |      28    |      36    |      49    |      21    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       1    |     851    |   14239 K  |   14239 K  |
|       from large pool |       1    |     805    |    8786 K  |    8786 K  |
|       from small pool |       0    |     148    |    5453 K  |    5453 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Tue Jul 23 04:47:47 2024]
Finished job 0.
1 of 1 steps (100%) done
