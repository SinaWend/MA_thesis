Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Sat Jul 20 06:05:36 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_nofreeze_2024-07-19_18-41-07/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_nofreeze_2024-07-19_18-41-07/rule_results/4.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=4
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/swiglu_ffn.py:51: UserWarning: xFormers is not available (SwiGLU)
  warnings.warn("xFormers is not available (SwiGLU)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/attention.py:33: UserWarning: xFormers is not available (Attention)
  warnings.warn("xFormers is not available (Attention)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/block.py:40: UserWarning: xFormers is not available (Block)
  warnings.warn("xFormers is not available (Block)")
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'888c1ef2'
model name: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_06_10_43_seed_0_22478444

 Experiment start at: 2024-07-20 06:10:43.796815
before training, model accuracy: 0.569767415523529
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.92545575, 'precision': 0.93069255, 'recall': 0.9247251, 'specificity': 0.9247251, 'f1': 0.9251288, 'auroc': 0.98914087, 'binary_precision': 0.88649595, 'binary_recall': 0.9781631, 'binary_specificity': 0.8712871, 'binary_f1_score': 0.93007636}
confusion matrix:
      0     1
0  1320   195
1    34  1523
---- Validation: 
scalar performance:
{'acc': 0.72748446, 'precision': 0.7914072, 'recall': 0.7307195, 'specificity': 0.7307195, 'f1': 0.7134546, 'auroc': 0.9143969, 'binary_precision': 0.6513859, 'binary_recall': 0.9622047, 'binary_specificity': 0.4992343, 'binary_f1_score': 0.77685946}
confusion matrix:
     0    1
0  326  327
1   24  611
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7255814, 'precision': 0.79110014, 'recall': 0.7255814, 'specificity': 0.7255814, 'f1': 0.7092197, 'auroc': 0.93295836, 'binary_precision': 0.65299684, 'binary_recall': 0.96279067, 'binary_specificity': 0.4883721, 'binary_f1_score': 0.77819544}
confusion matrix:
     0    1
0  105  110
1    8  207
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-20 06:13:01.099280,epoch time: 0:02:17.302465,used: 0:02:17.302465,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_06_10_43_seed_0_22478444
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.95410156, 'precision': 0.9548682, 'recall': 0.95386064, 'specificity': 0.95386064, 'f1': 0.95405763, 'auroc': 0.9927182, 'binary_precision': 0.9391682, 'binary_recall': 0.972365, 'binary_specificity': 0.9353562, 'binary_f1_score': 0.95547837}
confusion matrix:
      0     1
0  1418    98
1    43  1513
---- Validation: 
scalar performance:
{'acc': 0.78571427, 'precision': 0.785753, 'recall': 0.78580266, 'specificity': 0.78580266, 'f1': 0.7857096, 'auroc': 0.8736757, 'binary_precision': 0.7774343, 'binary_recall': 0.792126, 'binary_specificity': 0.7794793, 'binary_f1_score': 0.78471136}
confusion matrix:
     0    1
0  509  144
1  132  503
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7906977, 'precision': 0.8000715, 'recall': 0.7906977, 'specificity': 0.7906977, 'f1': 0.7890502, 'auroc': 0.89888585, 'binary_precision': 0.74703556, 'binary_recall': 0.87906975, 'binary_specificity': 0.7023256, 'binary_f1_score': 0.8076923}
confusion matrix:
     0    1
0  151   64
1   26  189
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-07-20 06:14:28.249410,epoch time: 0:01:27.150130,used: 0:03:44.452595,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_06_10_43_seed_0_22478444
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9788411, 'precision': 0.9788451, 'recall': 0.97891074, 'specificity': 0.97891074, 'f1': 0.9788405, 'auroc': 0.9979516, 'binary_precision': 0.9850163, 'binary_recall': 0.972973, 'binary_specificity': 0.9848485, 'binary_f1_score': 0.9789576}
confusion matrix:
      0     1
0  1495    23
1    42  1512
---- Validation: 
scalar performance:
{'acc': 0.7911491, 'precision': 0.80894077, 'recall': 0.7894479, 'specificity': 0.7894479, 'f1': 0.78740174, 'auroc': 0.8789259, 'binary_precision': 0.87966806, 'binary_recall': 0.66771656, 'binary_specificity': 0.9111792, 'binary_f1_score': 0.7591764}
confusion matrix:
     0    1
0  595   58
1  211  424
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.872093, 'precision': 0.8730696, 'recall': 0.872093, 'specificity': 0.872093, 'f1': 0.8720093, 'auroc': 0.928848, 'binary_precision': 0.89215684, 'binary_recall': 0.8465116, 'binary_specificity': 0.89767444, 'binary_f1_score': 0.8687351}
confusion matrix:
     0    1
0  193   22
1   33  182
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-07-20 06:15:55.045317,epoch time: 0:01:26.795907,used: 0:05:11.248502,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_06_10_43_seed_0_22478444
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9781901, 'precision': 0.97819006, 'recall': 0.978181, 'specificity': 0.978181, 'f1': 0.9781854, 'auroc': 0.9973978, 'binary_precision': 0.97819114, 'binary_recall': 0.978819, 'binary_specificity': 0.97754294, 'binary_f1_score': 0.97850496}
confusion matrix:
      0     1
0  1480    34
1    33  1525
---- Validation: 
scalar performance:
{'acc': 0.8167702, 'precision': 0.8242315, 'recall': 0.81781965, 'specificity': 0.81781965, 'f1': 0.81602454, 'auroc': 0.8970735, 'binary_precision': 0.7714286, 'binary_recall': 0.8929134, 'binary_specificity': 0.7427259, 'binary_f1_score': 0.8277373}
confusion matrix:
     0    1
0  485  168
1   68  567
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8, 'precision': 0.81573737, 'recall': 0.79999995, 'specificity': 0.79999995, 'f1': 0.7974764, 'auroc': 0.9205841, 'binary_precision': 0.7452471, 'binary_recall': 0.9116279, 'binary_specificity': 0.6883721, 'binary_f1_score': 0.8200836}
confusion matrix:
     0    1
0  148   67
1   19  196
better model found
persisted
after epoch: 4,now: 2024-07-20 06:17:21.518682,epoch time: 0:01:26.473365,used: 0:06:37.721867,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_06_10_43_seed_0_22478444
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.976888, 'precision': 0.97688854, 'recall': 0.976881, 'specificity': 0.976881, 'f1': 0.97688466, 'auroc': 0.99754596, 'binary_precision': 0.9768489, 'binary_recall': 0.9774775, 'binary_specificity': 0.97628456, 'binary_f1_score': 0.9771631}
confusion matrix:
      0     1
0  1482    36
1    35  1519
---- Validation: 
scalar performance:
{'acc': 0.7810559, 'precision': 0.81659806, 'recall': 0.7786907, 'specificity': 0.7786907, 'f1': 0.77371407, 'auroc': 0.9054129, 'binary_precision': 0.9192399, 'binary_recall': 0.6094488, 'binary_specificity': 0.9479326, 'binary_f1_score': 0.73295456}
confusion matrix:
     0    1
0  619   34
1  248  387
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8627907, 'precision': 0.88626313, 'recall': 0.8627907, 'specificity': 0.8627907, 'f1': 0.860674, 'auroc': 0.92945373, 'binary_precision': 0.9814815, 'binary_recall': 0.73953485, 'binary_specificity': 0.9860465, 'binary_f1_score': 0.8435013}
confusion matrix:
     0    1
0  212    3
1   56  159
early stop counter: 1
val acc:0.7810559272766113, best validation acc: 0.8167701959609985, corresponding to test acc:                         0.800000011920929 / 0.8720930218696594
after epoch: 5,now: 2024-07-20 06:18:48.121538,epoch time: 0:01:26.602856,used: 0:08:04.324723,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_06_10_43_seed_0_22478444
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9671224, 'precision': 0.9686971, 'recall': 0.9675365, 'specificity': 0.9675365, 'f1': 0.9671103, 'auroc': 0.998409, 'binary_precision': 0.99931365, 'binary_recall': 0.93573266, 'binary_specificity': 0.99934036, 'binary_f1_score': 0.9664786}
confusion matrix:
      0     1
0  1515     1
1   100  1456
---- Validation: 
scalar performance:
{'acc': 0.83928573, 'precision': 0.8554975, 'recall': 0.83778924, 'specificity': 0.83778924, 'f1': 0.83698547, 'auroc': 0.91677666, 'binary_precision': 0.928, 'binary_recall': 0.73070866, 'binary_specificity': 0.9448698, 'binary_f1_score': 0.8176212}
confusion matrix:
     0    1
0  617   36
1  171  464
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8488372, 'precision': 0.86200166, 'recall': 0.8488372, 'specificity': 0.8488372, 'f1': 0.8474504, 'auroc': 0.925192, 'binary_precision': 0.9310345, 'binary_recall': 0.75348836, 'binary_specificity': 0.94418603, 'binary_f1_score': 0.8329049}
confusion matrix:
     0    1
0  203   12
1   53  162
better model found
persisted
after epoch: 6,now: 2024-07-20 06:20:15.588564,epoch time: 0:01:27.467026,used: 0:09:31.791749,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_06_10_43_seed_0_22478444
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.98828125, 'precision': 0.98825955, 'recall': 0.98832166, 'specificity': 0.98832166, 'f1': 0.98828006, 'auroc': 0.99932295, 'binary_precision': 0.9915912, 'binary_recall': 0.9852185, 'binary_specificity': 0.9914248, 'binary_f1_score': 0.98839456}
confusion matrix:
      0     1
0  1503    13
1    23  1533
---- Validation: 
scalar performance:
{'acc': 0.73059005, 'precision': 0.79354405, 'recall': 0.7273143, 'specificity': 0.7273143, 'f1': 0.71345097, 'auroc': 0.8960389, 'binary_precision': 0.9260355, 'binary_recall': 0.4929134, 'binary_specificity': 0.96171516, 'binary_f1_score': 0.64337105}
confusion matrix:
     0    1
0  628   25
1  322  313
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.83255816, 'precision': 0.8627215, 'recall': 0.83255816, 'specificity': 0.83255816, 'f1': 0.8290032, 'auroc': 0.93018925, 'binary_precision': 0.96732026, 'binary_recall': 0.6883721, 'binary_specificity': 0.9767442, 'binary_f1_score': 0.8043478}
confusion matrix:
     0    1
0  210    5
1   67  148
early stop counter: 1
val acc:0.7305900454521179, best validation acc: 0.8392857313156128, corresponding to test acc:                         0.8488371968269348 / 0.8720930218696594
after epoch: 7,now: 2024-07-20 06:21:42.405430,epoch time: 0:01:26.816866,used: 0:10:58.608615,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_06_10_43_seed_0_22478444
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.98502606, 'precision': 0.9851818, 'recall': 0.98494315, 'specificity': 0.98494315, 'f1': 0.98502064, 'auroc': 0.9989338, 'binary_precision': 0.9790476, 'binary_recall': 0.99163985, 'binary_specificity': 0.9782465, 'binary_f1_score': 0.9853035}
confusion matrix:
      0     1
0  1484    33
1    13  1542
---- Validation: 
scalar performance:
{'acc': 0.8369565, 'precision': 0.85482544, 'recall': 0.83538365, 'specificity': 0.83538365, 'f1': 0.83440113, 'auroc': 0.9247519, 'binary_precision': 0.9310345, 'binary_recall': 0.72283465, 'binary_specificity': 0.9479326, 'binary_f1_score': 0.8138298}
confusion matrix:
     0    1
0  619   34
1  176  459
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8744186, 'precision': 0.88402224, 'recall': 0.8744186, 'specificity': 0.8744186, 'f1': 0.8736285, 'auroc': 0.9418929, 'binary_precision': 0.9447514, 'binary_recall': 0.7953488, 'binary_specificity': 0.95348835, 'binary_f1_score': 0.8636364}
confusion matrix:
     0    1
0  205   10
1   44  171
new oracle model saved
early stop counter: 2
val acc:0.8369565010070801, best validation acc: 0.8392857313156128, corresponding to test acc:                         0.8488371968269348 / 0.8744186162948608
after epoch: 8,now: 2024-07-20 06:23:09.136503,epoch time: 0:01:26.731073,used: 0:12:25.339688,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_06_10_43_seed_0_22478444
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9625651, 'precision': 0.96428967, 'recall': 0.9621984, 'specificity': 0.9621984, 'f1': 0.962503, 'auroc': 0.99794865, 'binary_precision': 0.9390615, 'binary_recall': 0.9903599, 'binary_specificity': 0.9340369, 'binary_f1_score': 0.9640288}
confusion matrix:
      0     1
0  1416   100
1    15  1541
---- Validation: 
scalar performance:
{'acc': 0.8416149, 'precision': 0.8489269, 'recall': 0.8426258, 'specificity': 0.8426258, 'f1': 0.84103185, 'auroc': 0.92774, 'binary_precision': 0.79480165, 'binary_recall': 0.9149606, 'binary_specificity': 0.770291, 'binary_f1_score': 0.8506588}
confusion matrix:
     0    1
0  503  150
1   54  581
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8395349, 'precision': 0.8498975, 'recall': 0.8395349, 'specificity': 0.8395349, 'f1': 0.83833796, 'auroc': 0.9424121, 'binary_precision': 0.78968257, 'binary_recall': 0.9255814, 'binary_specificity': 0.75348836, 'binary_f1_score': 0.85224843}
confusion matrix:
     0    1
0  162   53
1   16  199
better model found
persisted
after epoch: 9,now: 2024-07-20 06:24:36.548276,epoch time: 0:01:27.411773,used: 0:13:52.751461,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_06_10_43_seed_0_22478444
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9863281, 'precision': 0.9863239, 'recall': 0.98641455, 'specificity': 0.98641455, 'f1': 0.9863274, 'auroc': 0.99900246, 'binary_precision': 0.9928432, 'binary_recall': 0.9800899, 'binary_specificity': 0.99273926, 'binary_f1_score': 0.9864254}
confusion matrix:
      0     1
0  1504    11
1    31  1526
---- Validation: 
scalar performance:
{'acc': 0.867236, 'precision': 0.87418824, 'recall': 0.86628765, 'specificity': 0.86628765, 'f1': 0.8663815, 'auroc': 0.928777, 'binary_precision': 0.9218182, 'binary_recall': 0.7984252, 'binary_specificity': 0.9341501, 'binary_f1_score': 0.85569614}
confusion matrix:
     0    1
0  610   43
1  128  507
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.855814, 'precision': 0.8638747, 'recall': 0.855814, 'specificity': 0.855814, 'f1': 0.855011, 'auroc': 0.9277663, 'binary_precision': 0.91803277, 'binary_recall': 0.7813954, 'binary_specificity': 0.9302326, 'binary_f1_score': 0.8442211}
confusion matrix:
     0    1
0  200   15
1   47  168
better model found
persisted
after epoch: 10,now: 2024-07-20 06:26:03.262957,epoch time: 0:01:26.714681,used: 0:15:19.466142,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_06_10_43_seed_0_22478444
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9765625, 'precision': 0.97728014, 'recall': 0.9768553, 'specificity': 0.9768553, 'f1': 0.97656024, 'auroc': 0.99887574, 'binary_precision': 0.99932706, 'binary_recall': 0.9543702, 'binary_specificity': 0.99934036, 'binary_f1_score': 0.9763314}
confusion matrix:
      0     1
0  1515     1
1    71  1485
---- Validation: 
scalar performance:
{'acc': 0.6335404, 'precision': 0.7567823, 'recall': 0.6286286, 'specificity': 0.6286286, 'f1': 0.578889, 'auroc': 0.8874052, 'binary_precision': 0.93121696, 'binary_recall': 0.27716535, 'binary_specificity': 0.98009187, 'binary_f1_score': 0.42718443}
confusion matrix:
     0    1
0  640   13
1  459  176
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7627907, 'precision': 0.8216944, 'recall': 0.7627907, 'specificity': 0.7627907, 'f1': 0.75141126, 'auroc': 0.9045538, 'binary_precision': 0.9593496, 'binary_recall': 0.5488372, 'binary_specificity': 0.9767442, 'binary_f1_score': 0.6982248}
confusion matrix:
     0    1
0  210    5
1   97  118
early stop counter: 1
val acc:0.6335403919219971, best validation acc: 0.8672360181808472, corresponding to test acc:                         0.8558139801025391 / 0.8744186162948608
after epoch: 11,now: 2024-07-20 06:27:30.187898,epoch time: 0:01:26.924941,used: 0:16:46.391083,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_06_10_43_seed_0_22478444
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.98828125, 'precision': 0.98830867, 'recall': 0.9883948, 'specificity': 0.9883948, 'f1': 0.98828095, 'auroc': 0.9989711, 'binary_precision': 0.99673414, 'binary_recall': 0.9800899, 'binary_specificity': 0.9966997, 'binary_f1_score': 0.988342}
confusion matrix:
      0     1
0  1510     5
1    31  1526
---- Validation: 
scalar performance:
{'acc': 0.65993786, 'precision': 0.7383906, 'recall': 0.6558561, 'specificity': 0.6558561, 'f1': 0.6259984, 'auroc': 0.8525853, 'binary_precision': 0.87169814, 'binary_recall': 0.36377952, 'binary_specificity': 0.9479326, 'binary_f1_score': 0.5133333}
confusion matrix:
     0    1
0  619   34
1  404  231
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.82790697, 'precision': 0.8597878, 'recall': 0.82790697, 'specificity': 0.82790697, 'f1': 0.82400835, 'auroc': 0.941828, 'binary_precision': 0.9668874, 'binary_recall': 0.67906976, 'binary_specificity': 0.9767442, 'binary_f1_score': 0.7978142}
confusion matrix:
     0    1
0  210    5
1   69  146
early stop counter: 2
val acc:0.659937858581543, best validation acc: 0.8672360181808472, corresponding to test acc:                         0.8558139801025391 / 0.8744186162948608
after epoch: 12,now: 2024-07-20 06:28:56.721642,epoch time: 0:01:26.533744,used: 0:18:12.924827,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_06_10_43_seed_0_22478444
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.99283856, 'precision': 0.9928174, 'recall': 0.9928651, 'specificity': 0.9928651, 'f1': 0.9928374, 'auroc': 0.99975455, 'binary_precision': 0.9948454, 'binary_recall': 0.9910141, 'binary_specificity': 0.994716, 'binary_f1_score': 0.99292606}
confusion matrix:
      0     1
0  1506     8
1    14  1544
---- Validation: 
scalar performance:
{'acc': 0.83928573, 'precision': 0.84825253, 'recall': 0.83815825, 'specificity': 0.83815825, 'f1': 0.83790207, 'auroc': 0.9146544, 'binary_precision': 0.9007491, 'binary_recall': 0.7574803, 'binary_specificity': 0.9188361, 'binary_f1_score': 0.8229256}
confusion matrix:
     0    1
0  600   53
1  154  481
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8418605, 'precision': 0.8614065, 'recall': 0.8418605, 'specificity': 0.8418605, 'f1': 0.839693, 'auroc': 0.9392104, 'binary_precision': 0.94545454, 'binary_recall': 0.7255814, 'binary_specificity': 0.95813954, 'binary_f1_score': 0.8210526}
confusion matrix:
     0    1
0  206    9
1   59  156
early stop counter: 3
val acc:0.8392857313156128, best validation acc: 0.8672360181808472, corresponding to test acc:                         0.8558139801025391 / 0.8744186162948608
after epoch: 13,now: 2024-07-20 06:30:23.763793,epoch time: 0:01:27.042151,used: 0:19:39.966978,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_06_10_43_seed_0_22478444
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9749349, 'precision': 0.9759729, 'recall': 0.97466356, 'specificity': 0.97466356, 'f1': 0.9749067, 'auroc': 0.9988346, 'binary_precision': 0.95676345, 'binary_recall': 0.9955013, 'binary_specificity': 0.95382583, 'binary_f1_score': 0.975748}
confusion matrix:
      0     1
0  1446    70
1     7  1549
---- Validation: 
scalar performance:
{'acc': 0.82763976, 'precision': 0.8276061, 'recall': 0.8276061, 'specificity': 0.8276061, 'f1': 0.8276061, 'auroc': 0.89306045, 'binary_precision': 0.82519686, 'binary_recall': 0.82519686, 'binary_specificity': 0.8300153, 'binary_f1_score': 0.82519686}
confusion matrix:
     0    1
0  542  111
1  111  524
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.89534885, 'precision': 0.8953574, 'recall': 0.89534885, 'specificity': 0.89534885, 'f1': 0.8953482, 'auroc': 0.9473661, 'binary_precision': 0.89719623, 'binary_recall': 0.89302325, 'binary_specificity': 0.89767444, 'binary_f1_score': 0.8951048}
confusion matrix:
     0    1
0  193   22
1   23  192
new oracle model saved
early stop counter: 4
val acc:0.8276397585868835, best validation acc: 0.8672360181808472, corresponding to test acc:                         0.8558139801025391 / 0.895348846912384
after epoch: 14,now: 2024-07-20 06:31:51.100055,epoch time: 0:01:27.336262,used: 0:21:07.303240,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_06_10_43_seed_0_22478444
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9820964, 'precision': 0.98215103, 'recall': 0.98221624, 'specificity': 0.98221624, 'f1': 0.98209614, 'auroc': 0.9992149, 'binary_precision': 0.99148655, 'binary_recall': 0.97300774, 'binary_specificity': 0.9914248, 'binary_f1_score': 0.9821603}
confusion matrix:
      0     1
0  1503    13
1    42  1514
---- Validation: 
scalar performance:
{'acc': 0.6086956, 'precision': 0.7316549, 'recall': 0.6035186, 'specificity': 0.6035186, 'f1': 0.5431081, 'auroc': 0.8289765, 'binary_precision': 0.8969697, 'binary_recall': 0.23307087, 'binary_specificity': 0.9739663, 'binary_f1_score': 0.37}
confusion matrix:
     0    1
0  636   17
1  487  148
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.727907, 'precision': 0.8192424, 'recall': 0.72790694, 'specificity': 0.72790694, 'f1': 0.70694625, 'auroc': 0.93187666, 'binary_precision': 0.99, 'binary_recall': 0.4604651, 'binary_specificity': 0.9953488, 'binary_f1_score': 0.62857145}
confusion matrix:
     0   1
0  214   1
1  116  99
early stop counter: 5
val acc:0.6086956262588501, best validation acc: 0.8672360181808472, corresponding to test acc:                         0.8558139801025391 / 0.895348846912384
after epoch: 15,now: 2024-07-20 06:33:17.512986,epoch time: 0:01:26.412931,used: 0:22:33.716171,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_06_10_43_seed_0_22478444
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9895833, 'precision': 0.9896188, 'recall': 0.98971176, 'specificity': 0.98971176, 'f1': 0.989583, 'auroc': 0.9995985, 'binary_precision': 0.9986928, 'binary_recall': 0.98074454, 'binary_specificity': 0.998679, 'binary_f1_score': 0.9896373}
confusion matrix:
      0     1
0  1512     2
1    30  1528
---- Validation: 
scalar performance:
{'acc': 0.6925466, 'precision': 0.7764368, 'recall': 0.68864477, 'specificity': 0.68864477, 'f1': 0.6645657, 'auroc': 0.873232, 'binary_precision': 0.9252669, 'binary_recall': 0.40944883, 'binary_specificity': 0.96784073, 'binary_f1_score': 0.5676856}
confusion matrix:
     0    1
0  632   21
1  375  260
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7976744, 'precision': 0.84691405, 'recall': 0.7976744, 'specificity': 0.7976744, 'f1': 0.790231, 'auroc': 0.93847483, 'binary_precision': 0.97761196, 'binary_recall': 0.60930234, 'binary_specificity': 0.9860465, 'binary_f1_score': 0.7507164}
confusion matrix:
     0    1
0  212    3
1   84  131
early stop counter: 6
val acc:0.6925466060638428, best validation acc: 0.8672360181808472, corresponding to test acc:                         0.8558139801025391 / 0.895348846912384
after epoch: 16,now: 2024-07-20 06:34:44.829716,epoch time: 0:01:27.316730,used: 0:24:01.032901,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_06_10_43_seed_0_22478444
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.98860675, 'precision': 0.9887529, 'recall': 0.9885285, 'specificity': 0.9885285, 'f1': 0.9886029, 'auroc': 0.99925387, 'binary_precision': 0.98284626, 'binary_recall': 0.9948553, 'binary_specificity': 0.9822017, 'binary_f1_score': 0.98881435}
confusion matrix:
      0     1
0  1490    27
1     8  1547
---- Validation: 
scalar performance:
{'acc': 0.8819876, 'precision': 0.8833712, 'recall': 0.88157386, 'specificity': 0.88157386, 'f1': 0.8817798, 'auroc': 0.9355296, 'binary_precision': 0.90317196, 'binary_recall': 0.8519685, 'binary_specificity': 0.9111792, 'binary_f1_score': 0.8768233}
confusion matrix:
     0    1
0  595   58
1   94  541
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.88837206, 'precision': 0.8995749, 'recall': 0.88837206, 'specificity': 0.88837206, 'f1': 0.8875841, 'auroc': 0.9460898, 'binary_precision': 0.96648043, 'binary_recall': 0.80465114, 'binary_specificity': 0.97209305, 'binary_f1_score': 0.8781726}
confusion matrix:
     0    1
0  209    6
1   42  173
better model found
persisted
after epoch: 17,now: 2024-07-20 06:36:11.887022,epoch time: 0:01:27.057306,used: 0:25:28.090207,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_06_10_43_seed_0_22478444
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.98828125, 'precision': 0.9883686, 'recall': 0.9884083, 'specificity': 0.9884083, 'f1': 0.9882812, 'auroc': 0.99966216, 'binary_precision': 0.9986868, 'binary_recall': 0.97813505, 'binary_specificity': 0.9986816, 'binary_f1_score': 0.9883041}
confusion matrix:
      0     1
0  1515     2
1    34  1521
---- Validation: 
scalar performance:
{'acc': 0.73214287, 'precision': 0.79127854, 'recall': 0.7289542, 'specificity': 0.7289542, 'f1': 0.71600854, 'auroc': 0.88937366, 'binary_precision': 0.91907513, 'binary_recall': 0.5007874, 'binary_specificity': 0.95712095, 'binary_f1_score': 0.648318}
confusion matrix:
     0    1
0  625   28
1  317  318
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.76976746, 'precision': 0.822589, 'recall': 0.76976746, 'specificity': 0.76976746, 'f1': 0.7599405, 'auroc': 0.9140995, 'binary_precision': 0.953125, 'binary_recall': 0.5674419, 'binary_specificity': 0.97209305, 'binary_f1_score': 0.7113703}
confusion matrix:
     0    1
0  209    6
1   93  122
early stop counter: 1
val acc:0.7321428656578064, best validation acc: 0.8819875717163086, corresponding to test acc:                         0.8883720636367798 / 0.895348846912384
after epoch: 18,now: 2024-07-20 06:37:38.467089,epoch time: 0:01:26.580067,used: 0:26:54.670274,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_06_10_43_seed_0_22478444
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9869792, 'precision': 0.98731726, 'recall': 0.9868413, 'specificity': 0.9868413, 'f1': 0.986972, 'auroc': 0.9997295, 'binary_precision': 0.97732997, 'binary_recall': 0.9974293, 'binary_specificity': 0.9762533, 'binary_f1_score': 0.9872773}
confusion matrix:
      0     1
0  1480    36
1     4  1552
---- Validation: 
scalar performance:
{'acc': 0.8377329, 'precision': 0.85289115, 'recall': 0.8362796, 'specificity': 0.8362796, 'f1': 0.83553195, 'auroc': 0.9209174, 'binary_precision': 0.92261904, 'binary_recall': 0.7322835, 'binary_specificity': 0.94027567, 'binary_f1_score': 0.8165058}
confusion matrix:
     0    1
0  614   39
1  170  465
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8604651, 'precision': 0.8810749, 'recall': 0.8604651, 'specificity': 0.8604651, 'f1': 0.8585526, 'auroc': 0.93038404, 'binary_precision': 0.969697, 'binary_recall': 0.74418604, 'binary_specificity': 0.9767442, 'binary_f1_score': 0.84210527}
confusion matrix:
     0    1
0  210    5
1   55  160
early stop counter: 2
val acc:0.8377329111099243, best validation acc: 0.8819875717163086, corresponding to test acc:                         0.8883720636367798 / 0.895348846912384
after epoch: 19,now: 2024-07-20 06:39:05.706044,epoch time: 0:01:27.238955,used: 0:28:21.909229,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_06_10_43_seed_0_22478444
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9944661, 'precision': 0.994493, 'recall': 0.9944417, 'specificity': 0.9944417, 'f1': 0.99446476, 'auroc': 0.9997058, 'binary_precision': 0.99296224, 'binary_recall': 0.9961489, 'binary_specificity': 0.9927345, 'binary_f1_score': 0.99455297}
confusion matrix:
      0     1
0  1503    11
1     6  1552
---- Validation: 
scalar performance:
{'acc': 0.8369565, 'precision': 0.8624125, 'recall': 0.8351015, 'specificity': 0.8351015, 'f1': 0.83348393, 'auroc': 0.93708026, 'binary_precision': 0.9550321, 'binary_recall': 0.7023622, 'binary_specificity': 0.96784073, 'binary_f1_score': 0.8094374}
confusion matrix:
     0    1
0  632   21
1  189  446
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7883721, 'precision': 0.85130715, 'recall': 0.7883721, 'specificity': 0.7883721, 'f1': 0.77844965, 'auroc': 0.9461331, 'binary_precision': 1.0, 'binary_recall': 0.5767442, 'binary_specificity': 1.0, 'binary_f1_score': 0.73156345}
confusion matrix:
     0    1
0  215    0
1   91  124
early stop counter: 3
val acc:0.8369565010070801, best validation acc: 0.8819875717163086, corresponding to test acc:                         0.8883720636367798 / 0.895348846912384
after epoch: 20,now: 2024-07-20 06:40:32.046142,epoch time: 0:01:26.340098,used: 0:29:48.249327,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_06_10_43_seed_0_22478444
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9798177, 'precision': 0.9803804, 'recall': 0.9796277, 'specificity': 0.9796277, 'f1': 0.9798026, 'auroc': 0.99921656, 'binary_precision': 0.966875, 'binary_recall': 0.99421597, 'binary_specificity': 0.96503955, 'binary_f1_score': 0.98035485}
confusion matrix:
      0     1
0  1463    53
1     9  1547
---- Validation: 
scalar performance:
{'acc': 0.7336956, 'precision': 0.75895214, 'recall': 0.7314623, 'specificity': 0.7314623, 'f1': 0.72576743, 'auroc': 0.8560755, 'binary_precision': 0.8364055, 'binary_recall': 0.57165354, 'binary_specificity': 0.89127105, 'binary_f1_score': 0.6791394}
confusion matrix:
     0    1
0  582   71
1  272  363
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.81627905, 'precision': 0.8401899, 'recall': 0.81627905, 'specificity': 0.81627905, 'f1': 0.81299305, 'auroc': 0.9094213, 'binary_precision': 0.93037975, 'binary_recall': 0.68372095, 'binary_specificity': 0.9488372, 'binary_f1_score': 0.7882038}
confusion matrix:
     0    1
0  204   11
1   68  147
early stop counter: 4
val acc:0.7336956262588501, best validation acc: 0.8819875717163086, corresponding to test acc:                         0.8883720636367798 / 0.895348846912384
after epoch: 21,now: 2024-07-20 06:41:59.170995,epoch time: 0:01:27.124853,used: 0:31:15.374180,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_06_10_43_seed_0_22478444
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9902344, 'precision': 0.9902673, 'recall': 0.9903429, 'specificity': 0.9903429, 'f1': 0.9902342, 'auroc': 0.99987197, 'binary_precision': 0.9986928, 'binary_recall': 0.9820051, 'binary_specificity': 0.9986807, 'binary_f1_score': 0.9902787}
confusion matrix:
      0     1
0  1514     2
1    28  1528
---- Validation: 
scalar performance:
{'acc': 0.70263976, 'precision': 0.77583444, 'recall': 0.6989895, 'specificity': 0.6989895, 'f1': 0.6790774, 'auroc': 0.9060448, 'binary_precision': 0.9144737, 'binary_recall': 0.43779528, 'binary_specificity': 0.96018374, 'binary_f1_score': 0.5921193}
confusion matrix:
     0    1
0  627   26
1  357  278
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7744186, 'precision': 0.83758247, 'recall': 0.7744186, 'specificity': 0.7744186, 'f1': 0.76334894, 'auroc': 0.93416977, 'binary_precision': 0.9836066, 'binary_recall': 0.55813956, 'binary_specificity': 0.9906977, 'binary_f1_score': 0.71216625}
confusion matrix:
     0    1
0  213    2
1   95  120
early stop counter: 5
val acc:0.7026397585868835, best validation acc: 0.8819875717163086, corresponding to test acc:                         0.8883720636367798 / 0.895348846912384
after epoch: 22,now: 2024-07-20 06:43:27.277941,epoch time: 0:01:28.106946,used: 0:32:43.481126,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_06_10_43_seed_0_22478444
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.992513, 'precision': 0.99249315, 'recall': 0.99254143, 'specificity': 0.99254143, 'f1': 0.9925121, 'auroc': 0.9997359, 'binary_precision': 0.9948354, 'binary_recall': 0.9903599, 'binary_specificity': 0.99472296, 'binary_f1_score': 0.9925926}
confusion matrix:
      0     1
0  1508     8
1    15  1541
---- Validation: 
scalar performance:
{'acc': 0.72981364, 'precision': 0.804868, 'recall': 0.72630984, 'specificity': 0.72630984, 'f1': 0.710084, 'auroc': 0.9317825, 'binary_precision': 0.95268136, 'binary_recall': 0.47559056, 'binary_specificity': 0.9770291, 'binary_f1_score': 0.6344538}
confusion matrix:
     0    1
0  638   15
1  333  302
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.75581396, 'precision': 0.8320137, 'recall': 0.75581396, 'specificity': 0.75581396, 'f1': 0.74095047, 'auroc': 0.9256463, 'binary_precision': 0.9910714, 'binary_recall': 0.51627904, 'binary_specificity': 0.9953488, 'binary_f1_score': 0.67889905}
confusion matrix:
     0    1
0  214    1
1  104  111
early stop counter: 6
val acc:0.7298136353492737, best validation acc: 0.8819875717163086, corresponding to test acc:                         0.8883720636367798 / 0.895348846912384
after epoch: 23,now: 2024-07-20 06:44:54.855441,epoch time: 0:01:27.577500,used: 0:34:11.058626,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_06_10_43_seed_0_22478444
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.99348956, 'precision': 0.9934703, 'recall': 0.99352884, 'specificity': 0.99352884, 'f1': 0.993489, 'auroc': 0.9997635, 'binary_precision': 0.99676377, 'binary_recall': 0.9903537, 'binary_specificity': 0.99670404, 'binary_f1_score': 0.9935484}
confusion matrix:
      0     1
0  1512     5
1    15  1540
---- Validation: 
scalar performance:
{'acc': 0.7911491, 'precision': 0.8325101, 'recall': 0.7886665, 'specificity': 0.7886665, 'f1': 0.78344077, 'auroc': 0.92955106, 'binary_precision': 0.94634145, 'binary_recall': 0.6110236, 'binary_specificity': 0.96630937, 'binary_f1_score': 0.7425837}
confusion matrix:
     0    1
0  631   22
1  247  388
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.88139534, 'precision': 0.9005362, 'recall': 0.88139534, 'specificity': 0.88139534, 'f1': 0.87996125, 'auroc': 0.93927526, 'binary_precision': 0.9880952, 'binary_recall': 0.772093, 'binary_specificity': 0.9906977, 'binary_f1_score': 0.8668407}
confusion matrix:
     0    1
0  213    2
1   49  166
early stop counter: 7
val acc:0.7911490797996521, best validation acc: 0.8819875717163086, corresponding to test acc:                         0.8883720636367798 / 0.895348846912384
after epoch: 24,now: 2024-07-20 06:46:22.109574,epoch time: 0:01:27.254133,used: 0:35:38.312759,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_06_10_43_seed_0_22478444
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.99316406, 'precision': 0.9932493, 'recall': 0.99311066, 'specificity': 0.99311066, 'f1': 0.99316216, 'auroc': 0.9998427, 'binary_precision': 0.98915815, 'binary_recall': 0.99742764, 'binary_specificity': 0.9887937, 'binary_f1_score': 0.99327564}
confusion matrix:
      0     1
0  1500    17
1     4  1551
---- Validation: 
scalar performance:
{'acc': 0.7717391, 'precision': 0.8217561, 'recall': 0.76895976, 'specificity': 0.76895976, 'f1': 0.7612475, 'auroc': 0.9170979, 'binary_precision': 0.9451697, 'binary_recall': 0.57007873, 'binary_specificity': 0.96784073, 'binary_f1_score': 0.71119845}
confusion matrix:
     0    1
0  632   21
1  273  362
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.80930233, 'precision': 0.856182, 'recall': 0.80930233, 'specificity': 0.80930233, 'f1': 0.802814, 'auroc': 0.9327637, 'binary_precision': 0.98540145, 'binary_recall': 0.627907, 'binary_specificity': 0.9906977, 'binary_f1_score': 0.76704544}
confusion matrix:
     0    1
0  213    2
1   80  135
early stop counter: 8
val acc:0.77173912525177, best validation acc: 0.8819875717163086, corresponding to test acc:                         0.8883720636367798 / 0.895348846912384
after epoch: 25,now: 2024-07-20 06:47:48.891326,epoch time: 0:01:26.781752,used: 0:37:05.094511,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_06_10_43_seed_0_22478444
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9941406, 'precision': 0.9941588, 'recall': 0.99412364, 'specificity': 0.99412364, 'f1': 0.99413955, 'auroc': 0.9998478, 'binary_precision': 0.9929442, 'binary_recall': 0.9954984, 'binary_specificity': 0.99274886, 'binary_f1_score': 0.99421966}
confusion matrix:
      0     1
0  1506    11
1     7  1548
---- Validation: 
scalar performance:
{'acc': 0.7624224, 'precision': 0.81830555, 'recall': 0.7594675, 'specificity': 0.7594675, 'f1': 0.75010085, 'auroc': 0.91129315, 'binary_precision': 0.9482289, 'binary_recall': 0.5480315, 'binary_specificity': 0.9709035, 'binary_f1_score': 0.69461083}
confusion matrix:
     0    1
0  634   19
1  287  348
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7744186, 'precision': 0.8343085, 'recall': 0.7744186, 'specificity': 0.7744186, 'f1': 0.7638419, 'auroc': 0.930557, 'binary_precision': 0.9758065, 'binary_recall': 0.5627907, 'binary_specificity': 0.9860465, 'binary_f1_score': 0.7138643}
confusion matrix:
     0    1
0  212    3
1   94  121
early stop counter: 9
val acc:0.7624223828315735, best validation acc: 0.8819875717163086, corresponding to test acc:                         0.8883720636367798 / 0.895348846912384
after epoch: 26,now: 2024-07-20 06:49:16.597079,epoch time: 0:01:27.705753,used: 0:38:32.800264,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_06_10_43_seed_0_22478444
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.9905599, 'precision': 0.9906911, 'recall': 0.99048245, 'specificity': 0.99048245, 'f1': 0.9905564, 'auroc': 0.99975586, 'binary_precision': 0.98538756, 'binary_recall': 0.99614644, 'binary_specificity': 0.98481846, 'binary_f1_score': 0.9907378}
confusion matrix:
      0     1
0  1492    23
1     6  1551
---- Validation: 
scalar performance:
{'acc': 0.8540373, 'precision': 0.8603165, 'recall': 0.8549638, 'specificity': 0.8549638, 'f1': 0.8536049, 'auroc': 0.9295607, 'binary_precision': 0.80912864, 'binary_recall': 0.9212598, 'binary_specificity': 0.7886677, 'binary_f1_score': 0.8615612}
confusion matrix:
     0    1
0  515  138
1   50  585
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7930232, 'precision': 0.80907726, 'recall': 0.7930232, 'specificity': 0.7930232, 'f1': 0.79030025, 'auroc': 0.9300811, 'binary_precision': 0.7386364, 'binary_recall': 0.90697676, 'binary_specificity': 0.67906976, 'binary_f1_score': 0.8141962}
confusion matrix:
     0    1
0  146   69
1   20  195
early stop counter: 10
val acc:0.8540372848510742, best validation acc: 0.8819875717163086, corresponding to test acc:                         0.8883720636367798 / 0.895348846912384
after epoch: 27,now: 2024-07-20 06:50:43.173677,epoch time: 0:01:26.576598,used: 0:39:59.376862,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_06_10_43_seed_0_22478444
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.9892578, 'precision': 0.9892578, 'recall': 0.9893493, 'specificity': 0.9893493, 'f1': 0.98925734, 'auroc': 0.99971557, 'binary_precision': 0.99609375, 'binary_recall': 0.982659, 'binary_specificity': 0.9960396, 'binary_f1_score': 0.9893307}
confusion matrix:
      0     1
0  1509     6
1    27  1530
---- Validation: 
scalar performance:
{'acc': 0.7795031, 'precision': 0.8194965, 'recall': 0.7770074, 'specificity': 0.7770074, 'f1': 0.7712954, 'auroc': 0.91499925, 'binary_precision': 0.9290953, 'binary_recall': 0.5984252, 'binary_specificity': 0.9555896, 'binary_f1_score': 0.7279694}
confusion matrix:
     0    1
0  624   29
1  255  380
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.83023256, 'precision': 0.8706536, 'recall': 0.8302325, 'specificity': 0.8302325, 'f1': 0.8254744, 'auroc': 0.9377394, 'binary_precision': 0.9930556, 'binary_recall': 0.66511625, 'binary_specificity': 0.9953488, 'binary_f1_score': 0.7966574}
confusion matrix:
     0    1
0  214    1
1   72  143
early stop counter: 11
val acc:0.7795031070709229, best validation acc: 0.8819875717163086, corresponding to test acc:                         0.8883720636367798 / 0.895348846912384
after epoch: 28,now: 2024-07-20 06:52:10.645649,epoch time: 0:01:27.471972,used: 0:41:26.848834,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_06_10_43_seed_0_22478444
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.99316406, 'precision': 0.99314183, 'recall': 0.9932207, 'specificity': 0.9932207, 'f1': 0.99316347, 'auroc': 0.9998474, 'binary_precision': 0.99740934, 'binary_recall': 0.98908156, 'binary_specificity': 0.99735975, 'binary_f1_score': 0.993228}
confusion matrix:
      0     1
0  1511     4
1    17  1540
---- Validation: 
scalar performance:
{'acc': 0.7119565, 'precision': 0.79135627, 'recall': 0.7082647, 'specificity': 0.7082647, 'f1': 0.68856347, 'auroc': 0.8858726, 'binary_precision': 0.94, 'binary_recall': 0.44409448, 'binary_specificity': 0.97243494, 'binary_f1_score': 0.60320854}
confusion matrix:
     0    1
0  635   18
1  353  282
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8023256, 'precision': 0.8495148, 'recall': 0.8023256, 'specificity': 0.8023256, 'f1': 0.7954203, 'auroc': 0.9461763, 'binary_precision': 0.97794116, 'binary_recall': 0.61860466, 'binary_specificity': 0.9860465, 'binary_f1_score': 0.75783473}
confusion matrix:
     0    1
0  212    3
1   82  133
early stop counter: 12
val acc:0.7119565010070801, best validation acc: 0.8819875717163086, corresponding to test acc:                         0.8883720636367798 / 0.895348846912384
after epoch: 29,now: 2024-07-20 06:53:39.357637,epoch time: 0:01:28.711988,used: 0:42:55.560822,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_06_10_43_seed_0_22478444
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.99348956, 'precision': 0.9935219, 'recall': 0.99346167, 'specificity': 0.99346167, 'f1': 0.99348795, 'auroc': 0.9998351, 'binary_precision': 0.99168265, 'binary_recall': 0.9955042, 'binary_specificity': 0.99141914, 'binary_f1_score': 0.9935897}
confusion matrix:
      0     1
0  1502    13
1     7  1550
---- Validation: 
scalar performance:
{'acc': 0.78571427, 'precision': 0.82583845, 'recall': 0.7832415, 'specificity': 0.7832415, 'f1': 0.77787274, 'auroc': 0.92058516, 'binary_precision': 0.9367397, 'binary_recall': 0.6062992, 'binary_specificity': 0.96018374, 'binary_f1_score': 0.7361377}
confusion matrix:
     0    1
0  627   26
1  250  385
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8395349, 'precision': 0.8760542, 'recall': 0.8395349, 'specificity': 0.8395349, 'f1': 0.8355422, 'auroc': 0.95102215, 'binary_precision': 0.9932432, 'binary_recall': 0.68372095, 'binary_specificity': 0.9953488, 'binary_f1_score': 0.80991733}
confusion matrix:
     0    1
0  214    1
1   68  147
early stop counter: 13
val acc:0.7857142686843872, best validation acc: 0.8819875717163086, corresponding to test acc:                         0.8883720636367798 / 0.895348846912384
after epoch: 30,now: 2024-07-20 06:55:05.598013,epoch time: 0:01:26.240376,used: 0:44:21.801198,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_06_10_43_seed_0_22478444
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 0:44:21.801198 at 2024-07-20 06:55:05.598013
persisted model performance metric: 

scalar performance:
{'acc': 0.88837206, 'precision': 0.8995749, 'recall': 0.88837206, 'specificity': 0.88837206, 'f1': 0.8875841, 'auroc': 0.9460898, 'binary_precision': 0.96648043, 'binary_recall': 0.80465114, 'binary_specificity': 0.97209305, 'binary_f1_score': 0.8781726}
confusion matrix:
     0    1
0  209    6
1   42  173
oracle model performance metric: 

scalar performance:
{'acc': 0.89534885, 'precision': 0.8953574, 'recall': 0.89534885, 'specificity': 0.89534885, 'f1': 0.8953482, 'auroc': 0.9473661, 'binary_precision': 0.89719623, 'binary_recall': 0.89302325, 'binary_specificity': 0.89767444, 'binary_f1_score': 0.8951048}
confusion matrix:
     0    1
0  193   22
1   23  192
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_nofreeze_2024-07-19_18-41-07/rule_results/4.csv
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_nofreeze_2024-07-19_18-41-07/rule_results/4.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_nofreeze_2024-07-19_18-41-07/confusion_matrix/4.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 455454 KiB |  13219 MiB |  74168 GiB |  74168 GiB |
|       from large pool | 414861 KiB |  13181 MiB |  73287 GiB |  73286 GiB |
|       from small pool |  40592 KiB |     56 MiB |    881 GiB |    881 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 455454 KiB |  13219 MiB |  74168 GiB |  74168 GiB |
|       from large pool | 414861 KiB |  13181 MiB |  73287 GiB |  73286 GiB |
|       from small pool |  40592 KiB |     56 MiB |    881 GiB |    881 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 447480 KiB |  13213 MiB |  73659 GiB |  73658 GiB |
|       from large pool | 407075 KiB |  13175 MiB |  72779 GiB |  72778 GiB |
|       from small pool |  40405 KiB |     56 MiB |    879 GiB |    879 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  14470 MiB |  14470 MiB |  14470 MiB |      0 B   |
|       from large pool |  14404 MiB |  14404 MiB |  14404 MiB |      0 B   |
|       from small pool |     66 MiB |     66 MiB |     66 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory | 472290 KiB |   1229 MiB |  52507 GiB |  52507 GiB |
|       from large pool | 461682 KiB |   1224 MiB |  51622 GiB |  51622 GiB |
|       from small pool |  10607 KiB |     17 MiB |    884 GiB |    884 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    1298    |    2594    |   13013 K  |   13011 K  |
|       from large pool |     187    |    1413    |    6639 K  |    6639 K  |
|       from small pool |    1111    |    1407    |    6373 K  |    6372 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    1298    |    2594    |   13013 K  |   13011 K  |
|       from large pool |     187    |    1413    |    6639 K  |    6639 K  |
|       from small pool |    1111    |    1407    |    6373 K  |    6372 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     634    |     634    |     634    |       0    |
|       from large pool |     601    |     601    |     601    |       0    |
|       from small pool |      33    |      33    |      33    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     101    |     643    |    8990 K  |    8990 K  |
|       from large pool |      39    |     600    |    5427 K  |    5427 K  |
|       from small pool |      62    |     236    |    3562 K  |    3562 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13219 MiB |  74168 GiB |  74168 GiB |
|       from large pool |  16640 KiB |  13181 MiB |  73287 GiB |  73287 GiB |
|       from small pool |      0 KiB |     56 MiB |    881 GiB |    881 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13219 MiB |  74168 GiB |  74168 GiB |
|       from large pool |  16640 KiB |  13181 MiB |  73287 GiB |  73287 GiB |
|       from small pool |      0 KiB |     56 MiB |    881 GiB |    881 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13213 MiB |  73659 GiB |  73659 GiB |
|       from large pool |  16640 KiB |  13175 MiB |  72779 GiB |  72779 GiB |
|       from small pool |      0 KiB |     56 MiB |    879 GiB |    879 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    906 MiB |  14470 MiB |  14470 MiB |  13564 MiB |
|       from large pool |    856 MiB |  14404 MiB |  14404 MiB |  13548 MiB |
|       from small pool |     50 MiB |     66 MiB |     66 MiB |     16 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1229 MiB |  52508 GiB |  52508 GiB |
|       from large pool |  24320 KiB |   1224 MiB |  51623 GiB |  51623 GiB |
|       from small pool |      0 KiB |     44 MiB |    885 GiB |    885 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    2594    |   13013 K  |   13013 K  |
|       from large pool |       2    |    1413    |    6639 K  |    6639 K  |
|       from small pool |       0    |    1407    |    6373 K  |    6373 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    2594    |   13013 K  |   13013 K  |
|       from large pool |       2    |    1413    |    6639 K  |    6639 K  |
|       from small pool |       0    |    1407    |    6373 K  |    6373 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      63    |     634    |     634    |     571    |
|       from large pool |      38    |     601    |     601    |     563    |
|       from small pool |      25    |      33    |      33    |       8    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |     643    |    8990 K  |    8990 K  |
|       from large pool |       4    |     600    |    5427 K  |    5427 K  |
|       from small pool |       0    |     236    |    3562 K  |    3562 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13219 MiB |  74168 GiB |  74168 GiB |
|       from large pool |  16640 KiB |  13181 MiB |  73287 GiB |  73287 GiB |
|       from small pool |      0 KiB |     56 MiB |    881 GiB |    881 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13219 MiB |  74168 GiB |  74168 GiB |
|       from large pool |  16640 KiB |  13181 MiB |  73287 GiB |  73287 GiB |
|       from small pool |      0 KiB |     56 MiB |    881 GiB |    881 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13213 MiB |  73659 GiB |  73659 GiB |
|       from large pool |  16640 KiB |  13175 MiB |  72779 GiB |  72779 GiB |
|       from small pool |      0 KiB |     56 MiB |    879 GiB |    879 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    906 MiB |  14470 MiB |  14470 MiB |  13564 MiB |
|       from large pool |    856 MiB |  14404 MiB |  14404 MiB |  13548 MiB |
|       from small pool |     50 MiB |     66 MiB |     66 MiB |     16 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1229 MiB |  52508 GiB |  52508 GiB |
|       from large pool |  24320 KiB |   1224 MiB |  51623 GiB |  51623 GiB |
|       from small pool |      0 KiB |     44 MiB |    885 GiB |    885 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    2594    |   13013 K  |   13013 K  |
|       from large pool |       2    |    1413    |    6639 K  |    6639 K  |
|       from small pool |       0    |    1407    |    6373 K  |    6373 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    2594    |   13013 K  |   13013 K  |
|       from large pool |       2    |    1413    |    6639 K  |    6639 K  |
|       from small pool |       0    |    1407    |    6373 K  |    6373 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      63    |     634    |     634    |     571    |
|       from large pool |      38    |     601    |     601    |     563    |
|       from small pool |      25    |      33    |      33    |       8    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |     643    |    8990 K  |    8990 K  |
|       from large pool |       4    |     600    |    5427 K  |    5427 K  |
|       from small pool |       0    |     236    |    3562 K  |    3562 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'888c1ef2'
model name: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_06_56_23_seed_1_22478444

 Experiment start at: 2024-07-20 06:56:23.345058
before training, model accuracy: 0.6177777647972107
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9251302, 'precision': 0.92988694, 'recall': 0.92449856, 'specificity': 0.92449856, 'f1': 0.92483664, 'auroc': 0.9872099, 'binary_precision': 0.8876536, 'binary_recall': 0.9755627, 'binary_specificity': 0.8734344, 'binary_f1_score': 0.9295343}
confusion matrix:
      0     1
0  1325   192
1    38  1517
---- Validation: 
scalar performance:
{'acc': 0.8087432, 'precision': 0.81621444, 'recall': 0.8099847, 'specificity': 0.8099847, 'f1': 0.80799437, 'auroc': 0.90580547, 'binary_precision': 0.7633379, 'binary_recall': 0.8857143, 'binary_specificity': 0.734255, 'binary_f1_score': 0.81998533}
confusion matrix:
     0    1
0  478  173
1   72  558
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.74666667, 'precision': 0.7784343, 'recall': 0.74666667, 'specificity': 0.74666667, 'f1': 0.73922855, 'auroc': 0.92077035, 'binary_precision': 0.68438536, 'binary_recall': 0.91555554, 'binary_specificity': 0.5777778, 'binary_f1_score': 0.78326994}
confusion matrix:
     0    1
0  130   95
1   19  206
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-20 06:58:08.644591,epoch time: 0:01:45.299533,used: 0:01:45.299533,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_06_56_23_seed_1_22478444
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9788411, 'precision': 0.97890306, 'recall': 0.9787936, 'specificity': 0.9787936, 'f1': 0.9788358, 'auroc': 0.99778414, 'binary_precision': 0.97573435, 'binary_recall': 0.98263663, 'binary_specificity': 0.97495055, 'binary_f1_score': 0.97917336}
confusion matrix:
      0     1
0  1479    38
1    27  1528
---- Validation: 
scalar performance:
{'acc': 0.8462139, 'precision': 0.84621835, 'recall': 0.84610856, 'specificity': 0.84610856, 'f1': 0.8461505, 'auroc': 0.9050033, 'binary_precision': 0.8464, 'binary_recall': 0.8396825, 'binary_specificity': 0.85253453, 'binary_f1_score': 0.8430279}
confusion matrix:
     0    1
0  555   96
1  101  529
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8111111, 'precision': 0.8229047, 'recall': 0.8111111, 'specificity': 0.8111111, 'f1': 0.8093705, 'auroc': 0.9387852, 'binary_precision': 0.76119405, 'binary_recall': 0.9066667, 'binary_specificity': 0.71555555, 'binary_f1_score': 0.82758623}
confusion matrix:
     0    1
0  161   64
1   21  204
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-07-20 06:59:37.377033,epoch time: 0:01:28.732442,used: 0:03:14.031975,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_06_56_23_seed_1_22478444
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.94433594, 'precision': 0.9492537, 'recall': 0.9449731, 'specificity': 0.9449731, 'f1': 0.94423145, 'auroc': 0.9914564, 'binary_precision': 0.99927795, 'binary_recall': 0.8906049, 'binary_specificity': 0.99934125, 'binary_f1_score': 0.941817}
confusion matrix:
      0     1
0  1517     1
1   170  1384
---- Validation: 
scalar performance:
{'acc': 0.6401249, 'precision': 0.75828624, 'recall': 0.6344854, 'specificity': 0.6344854, 'f1': 0.58842874, 'auroc': 0.8663448, 'binary_precision': 0.92893404, 'binary_recall': 0.2904762, 'binary_specificity': 0.97849464, 'binary_f1_score': 0.44256353}
confusion matrix:
     0    1
0  637   14
1  447  183
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7644445, 'precision': 0.82035947, 'recall': 0.7644445, 'specificity': 0.7644445, 'f1': 0.75369716, 'auroc': 0.91909134, 'binary_precision': 0.9541985, 'binary_recall': 0.5555556, 'binary_specificity': 0.97333336, 'binary_f1_score': 0.7022472}
confusion matrix:
     0    1
0  219    6
1  100  125
early stop counter: 1
val acc:0.6401249170303345, best validation acc: 0.8462138772010803, corresponding to test acc:                         0.8111110925674438 / 0.8111110925674438
after epoch: 3,now: 2024-07-20 07:01:05.462143,epoch time: 0:01:28.085110,used: 0:04:42.117085,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_06_56_23_seed_1_22478444
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.976888, 'precision': 0.9773898, 'recall': 0.9771552, 'specificity': 0.9771552, 'f1': 0.97688717, 'auroc': 0.998297, 'binary_precision': 0.9966577, 'binary_recall': 0.9576108, 'binary_specificity': 0.9966997, 'binary_f1_score': 0.97674423}
confusion matrix:
      0     1
0  1510     5
1    66  1491
---- Validation: 
scalar performance:
{'acc': 0.7876659, 'precision': 0.81170726, 'recall': 0.78535587, 'specificity': 0.78535587, 'f1': 0.7825225, 'auroc': 0.88413674, 'binary_precision': 0.8942731, 'binary_recall': 0.64444447, 'binary_specificity': 0.92626727, 'binary_f1_score': 0.7490775}
confusion matrix:
     0    1
0  603   48
1  224  406
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.81333333, 'precision': 0.8142271, 'recall': 0.81333333, 'specificity': 0.81333333, 'f1': 0.8132005, 'auroc': 0.8818568, 'binary_precision': 0.8309859, 'binary_recall': 0.7866667, 'binary_specificity': 0.84, 'binary_f1_score': 0.80821913}
confusion matrix:
     0    1
0  189   36
1   48  177
new oracle model saved
early stop counter: 2
val acc:0.7876659035682678, best validation acc: 0.8462138772010803, corresponding to test acc:                         0.8111110925674438 / 0.8133333325386047
after epoch: 4,now: 2024-07-20 07:02:34.445143,epoch time: 0:01:28.983000,used: 0:06:11.100085,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_06_56_23_seed_1_22478444
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9710286, 'precision': 0.9722111, 'recall': 0.9713925, 'specificity': 0.9713925, 'f1': 0.9710219, 'auroc': 0.9990419, 'binary_precision': 0.99931926, 'binary_recall': 0.9434447, 'binary_specificity': 0.99934036, 'binary_f1_score': 0.9705785}
confusion matrix:
      0     1
0  1515     1
1    88  1468
---- Validation: 
scalar performance:
{'acc': 0.64246684, 'precision': 0.7705413, 'recall': 0.63673836, 'specificity': 0.63673836, 'f1': 0.58927363, 'auroc': 0.9154829, 'binary_precision': 0.9526316, 'binary_recall': 0.2873016, 'binary_specificity': 0.9861751, 'binary_f1_score': 0.4414634}
confusion matrix:
     0    1
0  642    9
1  449  181
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6711111, 'precision': 0.7843801, 'recall': 0.6711111, 'specificity': 0.6711111, 'f1': 0.63474023, 'auroc': 0.91369873, 'binary_precision': 0.96385545, 'binary_recall': 0.35555556, 'binary_specificity': 0.9866667, 'binary_f1_score': 0.5194805}
confusion matrix:
     0   1
0  222   3
1  145  80
early stop counter: 3
val acc:0.6424668431282043, best validation acc: 0.8462138772010803, corresponding to test acc:                         0.8111110925674438 / 0.8133333325386047
after epoch: 5,now: 2024-07-20 07:04:03.469488,epoch time: 0:01:29.024345,used: 0:07:40.124430,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_06_56_23_seed_1_22478444
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.98014325, 'precision': 0.980124, 'recall': 0.9801845, 'specificity': 0.9801845, 'f1': 0.9801417, 'auroc': 0.99668324, 'binary_precision': 0.9838083, 'binary_recall': 0.9768489, 'binary_specificity': 0.9835201, 'binary_f1_score': 0.9803163}
confusion matrix:
      0     1
0  1492    25
1    36  1519
---- Validation: 
scalar performance:
{'acc': 0.8290398, 'precision': 0.8378514, 'recall': 0.827701, 'specificity': 0.827701, 'f1': 0.82747495, 'auroc': 0.9080024, 'binary_precision': 0.8884688, 'binary_recall': 0.74603176, 'binary_specificity': 0.9093702, 'binary_f1_score': 0.81104404}
confusion matrix:
     0    1
0  592   59
1  160  470
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.83111113, 'precision': 0.8320556, 'recall': 0.8311111, 'specificity': 0.8311111, 'f1': 0.8309909, 'auroc': 0.9124938, 'binary_precision': 0.84976524, 'binary_recall': 0.80444443, 'binary_specificity': 0.8577778, 'binary_f1_score': 0.826484}
confusion matrix:
     0    1
0  193   32
1   44  181
new oracle model saved
early stop counter: 4
val acc:0.8290398120880127, best validation acc: 0.8462138772010803, corresponding to test acc:                         0.8111110925674438 / 0.8311111330986023
after epoch: 6,now: 2024-07-20 07:05:31.578925,epoch time: 0:01:28.109437,used: 0:09:08.233867,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_06_56_23_seed_1_22478444
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.96516925, 'precision': 0.96703637, 'recall': 0.96561694, 'specificity': 0.96561694, 'f1': 0.96515274, 'auroc': 0.9978784, 'binary_precision': 1.0, 'binary_recall': 0.93123394, 'binary_specificity': 1.0, 'binary_f1_score': 0.9643927}
confusion matrix:
      0     1
0  1516     0
1   107  1449
---- Validation: 
scalar performance:
{'acc': 0.65651834, 'precision': 0.7796523, 'recall': 0.6509985, 'specificity': 0.6509985, 'f1': 0.60937977, 'auroc': 0.9070679, 'binary_precision': 0.9611651, 'binary_recall': 0.31428573, 'binary_specificity': 0.9877112, 'binary_f1_score': 0.4736842}
confusion matrix:
     0    1
0  643    8
1  432  198
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6155556, 'precision': 0.75, 'recall': 0.6155555, 'specificity': 0.6155555, 'f1': 0.5558408, 'auroc': 0.9026765, 'binary_precision': 0.93333334, 'binary_recall': 0.2488889, 'binary_specificity': 0.9822222, 'binary_f1_score': 0.39298245}
confusion matrix:
     0   1
0  221   4
1  169  56
early stop counter: 5
val acc:0.6565183401107788, best validation acc: 0.8462138772010803, corresponding to test acc:                         0.8111110925674438 / 0.8311111330986023
after epoch: 7,now: 2024-07-20 07:07:04.489203,epoch time: 0:01:32.910278,used: 0:10:41.144145,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_06_56_23_seed_1_22478444
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.98567706, 'precision': 0.9858847, 'recall': 0.98557824, 'specificity': 0.98557824, 'f1': 0.9856713, 'auroc': 0.99950826, 'binary_precision': 0.9784674, 'binary_recall': 0.99356914, 'binary_specificity': 0.97758734, 'binary_f1_score': 0.9859604}
confusion matrix:
      0     1
0  1483    34
1    10  1545
---- Validation: 
scalar performance:
{'acc': 0.83918816, 'precision': 0.85003537, 'recall': 0.83773685, 'specificity': 0.83773685, 'f1': 0.8374886, 'auroc': 0.9052563, 'binary_precision': 0.9076923, 'binary_recall': 0.74920636, 'binary_specificity': 0.92626727, 'binary_f1_score': 0.82086957}
confusion matrix:
     0    1
0  603   48
1  158  472
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8377778, 'precision': 0.842, 'recall': 0.83777773, 'specificity': 0.83777773, 'f1': 0.83727556, 'auroc': 0.91697776, 'binary_precision': 0.88, 'binary_recall': 0.7822222, 'binary_specificity': 0.8933333, 'binary_f1_score': 0.8282353}
confusion matrix:
     0    1
0  201   24
1   49  176
new oracle model saved
early stop counter: 6
val acc:0.8391881585121155, best validation acc: 0.8462138772010803, corresponding to test acc:                         0.8111110925674438 / 0.8377777934074402
after epoch: 8,now: 2024-07-20 07:08:33.433993,epoch time: 0:01:28.944790,used: 0:12:10.088935,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_06_56_23_seed_1_22478444
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9791667, 'precision': 0.9791666, 'recall': 0.9792479, 'specificity': 0.9792479, 'f1': 0.97916573, 'auroc': 0.99846244, 'binary_precision': 0.98567706, 'binary_recall': 0.97300774, 'binary_specificity': 0.9854881, 'binary_f1_score': 0.9793014}
confusion matrix:
      0     1
0  1494    22
1    42  1514
---- Validation: 
scalar performance:
{'acc': 0.8696331, 'precision': 0.8797133, 'recall': 0.8683052, 'specificity': 0.8683052, 'f1': 0.8684398, 'auroc': 0.9301928, 'binary_precision': 0.93761814, 'binary_recall': 0.7873016, 'binary_specificity': 0.94930875, 'binary_f1_score': 0.85591024}
confusion matrix:
     0    1
0  618   33
1  134  496
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8688889, 'precision': 0.88155854, 'recall': 0.86888885, 'specificity': 0.86888885, 'f1': 0.8677914, 'auroc': 0.93044937, 'binary_precision': 0.95108694, 'binary_recall': 0.7777778, 'binary_specificity': 0.96, 'binary_f1_score': 0.85574573}
confusion matrix:
     0    1
0  216    9
1   50  175
new oracle model saved
better model found
persisted
after epoch: 9,now: 2024-07-20 07:10:01.964850,epoch time: 0:01:28.530857,used: 0:13:38.619792,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_06_56_23_seed_1_22478444
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.98535156, 'precision': 0.9853674, 'recall': 0.98546517, 'specificity': 0.98546517, 'f1': 0.985351, 'auroc': 0.9991152, 'binary_precision': 0.99347687, 'binary_recall': 0.9775353, 'binary_specificity': 0.993395, 'binary_f1_score': 0.9854417}
confusion matrix:
      0     1
0  1504    10
1    35  1523
---- Validation: 
scalar performance:
{'acc': 0.8040593, 'precision': 0.8219855, 'recall': 0.80209935, 'specificity': 0.80209935, 'f1': 0.80054665, 'auroc': 0.89105403, 'binary_precision': 0.8939709, 'binary_recall': 0.6825397, 'binary_specificity': 0.921659, 'binary_f1_score': 0.7740774}
confusion matrix:
     0    1
0  600   51
1  200  430
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.81777775, 'precision': 0.8198247, 'recall': 0.81777775, 'specificity': 0.81777775, 'f1': 0.8174858, 'auroc': 0.90362465, 'binary_precision': 0.84541065, 'binary_recall': 0.7777778, 'binary_specificity': 0.8577778, 'binary_f1_score': 0.8101852}
confusion matrix:
     0    1
0  193   32
1   50  175
early stop counter: 1
val acc:0.8040593266487122, best validation acc: 0.8696330785751343, corresponding to test acc:                         0.8688889145851135 / 0.8688889145851135
after epoch: 10,now: 2024-07-20 07:11:31.236422,epoch time: 0:01:29.271572,used: 0:15:07.891364,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_06_56_23_seed_1_22478444
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.960612, 'precision': 0.9636996, 'recall': 0.96013474, 'specificity': 0.96013474, 'f1': 0.96051145, 'auroc': 0.99903774, 'binary_precision': 0.92882776, 'binary_recall': 0.99871385, 'binary_specificity': 0.9215557, 'binary_f1_score': 0.9625039}
confusion matrix:
      0     1
0  1398   119
1     2  1553
---- Validation: 
scalar performance:
{'acc': 0.84777516, 'precision': 0.84908986, 'recall': 0.8482847, 'specificity': 0.8482847, 'f1': 0.8477303, 'auroc': 0.9043157, 'binary_precision': 0.8231798, 'binary_recall': 0.8793651, 'binary_specificity': 0.8172043, 'binary_f1_score': 0.8503454}
confusion matrix:
     0    1
0  532  119
1   76  554
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.81333333, 'precision': 0.83101356, 'recall': 0.81333333, 'specificity': 0.81333333, 'f1': 0.810807, 'auroc': 0.92456293, 'binary_precision': 0.7545126, 'binary_recall': 0.9288889, 'binary_specificity': 0.69777775, 'binary_f1_score': 0.8326693}
confusion matrix:
     0    1
0  157   68
1   16  209
early stop counter: 2
val acc:0.8477751612663269, best validation acc: 0.8696330785751343, corresponding to test acc:                         0.8688889145851135 / 0.8688889145851135
after epoch: 11,now: 2024-07-20 07:13:01.717411,epoch time: 0:01:30.480989,used: 0:16:38.372353,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_06_56_23_seed_1_22478444
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9889323, 'precision': 0.9889879, 'recall': 0.9888926, 'specificity': 0.9888926, 'f1': 0.9889298, 'auroc': 0.9996431, 'binary_precision': 0.9859335, 'binary_recall': 0.992278, 'binary_specificity': 0.98550725, 'binary_f1_score': 0.98909557}
confusion matrix:
      0     1
0  1496    22
1    12  1542
---- Validation: 
scalar performance:
{'acc': 0.8142077, 'precision': 0.83525383, 'recall': 0.8121352, 'specificity': 0.8121352, 'f1': 0.81050766, 'auroc': 0.9122547, 'binary_precision': 0.91525424, 'binary_recall': 0.6857143, 'binary_specificity': 0.9385561, 'binary_f1_score': 0.78402907}
confusion matrix:
     0    1
0  611   40
1  198  432
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.83555555, 'precision': 0.8387946, 'recall': 0.83555555, 'specificity': 0.83555555, 'f1': 0.83516157, 'auroc': 0.88861233, 'binary_precision': 0.8719212, 'binary_recall': 0.7866667, 'binary_specificity': 0.8844444, 'binary_f1_score': 0.8271028}
confusion matrix:
     0    1
0  199   26
1   48  177
early stop counter: 3
val acc:0.8142076730728149, best validation acc: 0.8696330785751343, corresponding to test acc:                         0.8688889145851135 / 0.8688889145851135
after epoch: 12,now: 2024-07-20 07:14:30.161629,epoch time: 0:01:28.444218,used: 0:18:06.816571,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_06_56_23_seed_1_22478444
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9905599, 'precision': 0.9906634, 'recall': 0.99049807, 'specificity': 0.99049807, 'f1': 0.9905571, 'auroc': 0.999434, 'binary_precision': 0.98598725, 'binary_recall': 0.9954984, 'binary_specificity': 0.9854977, 'binary_f1_score': 0.99072003}
confusion matrix:
      0     1
0  1495    22
1     7  1548
---- Validation: 
scalar performance:
{'acc': 0.8469945, 'precision': 0.8616742, 'recall': 0.8453405, 'specificity': 0.8453405, 'f1': 0.8449528, 'auroc': 0.9154414, 'binary_precision': 0.9305556, 'binary_recall': 0.74444443, 'binary_specificity': 0.94623655, 'binary_f1_score': 0.82716054}
confusion matrix:
     0    1
0  616   35
1  161  469
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8422222, 'precision': 0.8446801, 'recall': 0.8422222, 'specificity': 0.8422222, 'f1': 0.8419404, 'auroc': 0.9135605, 'binary_precision': 0.8737864, 'binary_recall': 0.8, 'binary_specificity': 0.8844444, 'binary_f1_score': 0.8352668}
confusion matrix:
     0    1
0  199   26
1   45  180
early stop counter: 4
val acc:0.8469945192337036, best validation acc: 0.8696330785751343, corresponding to test acc:                         0.8688889145851135 / 0.8688889145851135
after epoch: 13,now: 2024-07-20 07:15:58.895190,epoch time: 0:01:28.733561,used: 0:19:35.550132,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_06_56_23_seed_1_22478444
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9866536, 'precision': 0.98665, 'recall': 0.9867167, 'specificity': 0.9867167, 'f1': 0.98665315, 'auroc': 0.9992836, 'binary_precision': 0.99219257, 'binary_recall': 0.9813385, 'binary_specificity': 0.9920949, 'binary_f1_score': 0.9867357}
confusion matrix:
      0     1
0  1506    12
1    29  1525
---- Validation: 
scalar performance:
{'acc': 0.882904, 'precision': 0.8874521, 'recall': 0.8820276, 'specificity': 0.8820276, 'f1': 0.8823613, 'auroc': 0.9287226, 'binary_precision': 0.9255319, 'binary_recall': 0.82857144, 'binary_specificity': 0.9354839, 'binary_f1_score': 0.8743718}
confusion matrix:
     0    1
0  609   42
1  108  522
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.85333335, 'precision': 0.85403264, 'recall': 0.85333335, 'specificity': 0.85333335, 'f1': 0.8532609, 'auroc': 0.9194864, 'binary_precision': 0.8697674, 'binary_recall': 0.83111113, 'binary_specificity': 0.8755556, 'binary_f1_score': 0.84999996}
confusion matrix:
     0    1
0  197   28
1   38  187
better model found
persisted
after epoch: 14,now: 2024-07-20 07:17:28.327941,epoch time: 0:01:29.432751,used: 0:21:04.982883,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_06_56_23_seed_1_22478444
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9951172, 'precision': 0.9951127, 'recall': 0.99512047, 'specificity': 0.99512047, 'f1': 0.9951165, 'auroc': 0.99984694, 'binary_precision': 0.9954955, 'binary_recall': 0.9948553, 'binary_specificity': 0.99538565, 'binary_f1_score': 0.9951753}
confusion matrix:
      0     1
0  1510     7
1     8  1547
---- Validation: 
scalar performance:
{'acc': 0.81030446, 'precision': 0.8408164, 'recall': 0.80783415, 'specificity': 0.80783415, 'f1': 0.80506575, 'auroc': 0.909867, 'binary_precision': 0.93877554, 'binary_recall': 0.6571429, 'binary_specificity': 0.95852536, 'binary_f1_score': 0.7731093}
confusion matrix:
     0    1
0  624   27
1  216  414
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.84444445, 'precision': 0.8515554, 'recall': 0.8444444, 'specificity': 0.8444444, 'f1': 0.8436538, 'auroc': 0.909353, 'binary_precision': 0.9015544, 'binary_recall': 0.7733333, 'binary_specificity': 0.91555554, 'binary_f1_score': 0.83253586}
confusion matrix:
     0    1
0  206   19
1   51  174
early stop counter: 1
val acc:0.8103044629096985, best validation acc: 0.8829039931297302, corresponding to test acc:                         0.8533333539962769 / 0.8688889145851135
after epoch: 15,now: 2024-07-20 07:18:56.694969,epoch time: 0:01:28.367028,used: 0:22:33.349911,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_06_56_23_seed_1_22478444
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9625651, 'precision': 0.9654914, 'recall': 0.96207976, 'specificity': 0.96207976, 'f1': 0.962472, 'auroc': 0.9994315, 'binary_precision': 0.93169564, 'binary_recall': 0.99935734, 'binary_specificity': 0.9248021, 'binary_f1_score': 0.9643411}
confusion matrix:
      0     1
0  1402   114
1     1  1555
---- Validation: 
scalar performance:
{'acc': 0.8290398, 'precision': 0.8369245, 'recall': 0.83028674, 'specificity': 0.83028674, 'f1': 0.82837045, 'auroc': 0.9128008, 'binary_precision': 0.78112173, 'binary_recall': 0.9063492, 'binary_specificity': 0.75422424, 'binary_f1_score': 0.8390889}
confusion matrix:
     0    1
0  491  160
1   59  571
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7733333, 'precision': 0.8064852, 'recall': 0.7733333, 'specificity': 0.7733333, 'f1': 0.76703346, 'auroc': 0.9388642, 'binary_precision': 0.7056856, 'binary_recall': 0.93777776, 'binary_specificity': 0.60888886, 'binary_f1_score': 0.80534345}
confusion matrix:
     0    1
0  137   88
1   14  211
early stop counter: 2
val acc:0.8290398120880127, best validation acc: 0.8829039931297302, corresponding to test acc:                         0.8533333539962769 / 0.8688889145851135
after epoch: 16,now: 2024-07-20 07:20:24.629266,epoch time: 0:01:27.934297,used: 0:24:01.284208,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_06_56_23_seed_1_22478444
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9889323, 'precision': 0.98899233, 'recall': 0.9890139, 'specificity': 0.9890139, 'f1': 0.98893225, 'auroc': 0.9996444, 'binary_precision': 0.99737704, 'binary_recall': 0.98065764, 'binary_specificity': 0.9973701, 'binary_f1_score': 0.9889466}
confusion matrix:
      0     1
0  1517     4
1    30  1521
---- Validation: 
scalar performance:
{'acc': 0.765808, 'precision': 0.8244435, 'recall': 0.7622888, 'specificity': 0.7622888, 'f1': 0.753065, 'auroc': 0.93070245, 'binary_precision': 0.9583333, 'binary_recall': 0.54761904, 'binary_specificity': 0.9769585, 'binary_f1_score': 0.6969697}
confusion matrix:
     0    1
0  636   15
1  285  345
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.71555555, 'precision': 0.79733527, 'recall': 0.71555555, 'specificity': 0.71555555, 'f1': 0.6945529, 'auroc': 0.91851854, 'binary_precision': 0.95327103, 'binary_recall': 0.45333335, 'binary_specificity': 0.9777778, 'binary_f1_score': 0.61445785}
confusion matrix:
     0    1
0  220    5
1  123  102
early stop counter: 3
val acc:0.7658079862594604, best validation acc: 0.8829039931297302, corresponding to test acc:                         0.8533333539962769 / 0.8688889145851135
after epoch: 17,now: 2024-07-20 07:21:56.744909,epoch time: 0:01:32.115643,used: 0:25:33.399851,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_06_56_23_seed_1_22478444
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.99153644, 'precision': 0.9915432, 'recall': 0.9915282, 'specificity': 0.9915282, 'f1': 0.9915353, 'auroc': 0.9995973, 'binary_precision': 0.9909968, 'binary_recall': 0.99227303, 'binary_specificity': 0.9907834, 'binary_f1_score': 0.9916345}
confusion matrix:
      0     1
0  1505    14
1    12  1541
---- Validation: 
scalar performance:
{'acc': 0.8704137, 'precision': 0.8761676, 'recall': 0.86940604, 'specificity': 0.86940604, 'f1': 0.86966646, 'auroc': 0.9182942, 'binary_precision': 0.9187726, 'binary_recall': 0.8079365, 'binary_specificity': 0.9308756, 'binary_f1_score': 0.85979724}
confusion matrix:
     0    1
0  606   45
1  121  509
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.87333333, 'precision': 0.8837096, 'recall': 0.87333333, 'specificity': 0.87333333, 'f1': 0.8724712, 'auroc': 0.92722964, 'binary_precision': 0.9468085, 'binary_recall': 0.7911111, 'binary_specificity': 0.95555556, 'binary_f1_score': 0.86198545}
confusion matrix:
     0    1
0  215   10
1   47  178
new oracle model saved
early stop counter: 4
val acc:0.8704137206077576, best validation acc: 0.8829039931297302, corresponding to test acc:                         0.8533333539962769 / 0.8733333349227905
after epoch: 18,now: 2024-07-20 07:23:25.122982,epoch time: 0:01:28.378073,used: 0:27:01.777924,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_06_56_23_seed_1_22478444
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.98535156, 'precision': 0.98554814, 'recall': 0.985506, 'specificity': 0.985506, 'f1': 0.98535156, 'auroc': 0.9993862, 'binary_precision': 0.99867815, 'binary_recall': 0.9723295, 'binary_specificity': 0.9986825, 'binary_f1_score': 0.9853278}
confusion matrix:
      0     1
0  1516     2
1    43  1511
---- Validation: 
scalar performance:
{'acc': 0.8321624, 'precision': 0.8593056, 'recall': 0.8299027, 'specificity': 0.8299027, 'f1': 0.8282226, 'auroc': 0.9346024, 'binary_precision': 0.95404816, 'binary_recall': 0.6920635, 'binary_specificity': 0.9677419, 'binary_f1_score': 0.8022079}
confusion matrix:
     0    1
0  630   21
1  194  436
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.82, 'precision': 0.86499643, 'recall': 0.82000005, 'specificity': 0.82000005, 'f1': 0.8142761, 'auroc': 0.92965925, 'binary_precision': 0.9931507, 'binary_recall': 0.64444447, 'binary_specificity': 0.9955556, 'binary_f1_score': 0.7816712}
confusion matrix:
     0    1
0  224    1
1   80  145
early stop counter: 5
val acc:0.8321623802185059, best validation acc: 0.8829039931297302, corresponding to test acc:                         0.8533333539962769 / 0.8733333349227905
after epoch: 19,now: 2024-07-20 07:24:53.351715,epoch time: 0:01:28.228733,used: 0:28:30.006657,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_06_56_23_seed_1_22478444
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9902344, 'precision': 0.9902208, 'recall': 0.99030054, 'specificity': 0.99030054, 'f1': 0.9902338, 'auroc': 0.99945056, 'binary_precision': 0.99545455, 'binary_recall': 0.9852185, 'binary_specificity': 0.9953826, 'binary_f1_score': 0.9903101}
confusion matrix:
      0     1
0  1509     7
1    23  1533
---- Validation: 
scalar performance:
{'acc': 0.8649493, 'precision': 0.8765267, 'recall': 0.86351764, 'specificity': 0.86351764, 'f1': 0.86354387, 'auroc': 0.9309572, 'binary_precision': 0.9385797, 'binary_recall': 0.77619046, 'binary_specificity': 0.9508448, 'binary_f1_score': 0.8496959}
confusion matrix:
     0    1
0  619   32
1  141  489
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8688889, 'precision': 0.8742785, 'recall': 0.8688889, 'specificity': 0.8688889, 'f1': 0.8684152, 'auroc': 0.92389137, 'binary_precision': 0.9191919, 'binary_recall': 0.8088889, 'binary_specificity': 0.9288889, 'binary_f1_score': 0.8605201}
confusion matrix:
     0    1
0  209   16
1   43  182
early stop counter: 6
val acc:0.8649492859840393, best validation acc: 0.8829039931297302, corresponding to test acc:                         0.8533333539962769 / 0.8733333349227905
after epoch: 20,now: 2024-07-20 07:26:23.064385,epoch time: 0:01:29.712670,used: 0:29:59.719327,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_06_56_23_seed_1_22478444
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.992513, 'precision': 0.99253756, 'recall': 0.99249053, 'specificity': 0.99249053, 'f1': 0.9925114, 'auroc': 0.99979866, 'binary_precision': 0.9910314, 'binary_recall': 0.99421597, 'binary_specificity': 0.99076515, 'binary_f1_score': 0.9926211}
confusion matrix:
      0     1
0  1502    14
1     9  1547
---- Validation: 
scalar performance:
{'acc': 0.88758785, 'precision': 0.89276177, 'recall': 0.8866615, 'specificity': 0.8866615, 'f1': 0.8870177, 'auroc': 0.9410218, 'binary_precision': 0.93392855, 'binary_recall': 0.8301587, 'binary_specificity': 0.94316435, 'binary_f1_score': 0.8789916}
confusion matrix:
     0    1
0  614   37
1  107  523
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8844444, 'precision': 0.8945448, 'recall': 0.8844445, 'specificity': 0.8844445, 'f1': 0.88370013, 'auroc': 0.9334519, 'binary_precision': 0.95767194, 'binary_recall': 0.80444443, 'binary_specificity': 0.96444446, 'binary_f1_score': 0.8743961}
confusion matrix:
     0    1
0  217    8
1   44  181
new oracle model saved
better model found
persisted
after epoch: 21,now: 2024-07-20 07:27:53.009362,epoch time: 0:01:29.944977,used: 0:31:29.664304,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_06_56_23_seed_1_22478444
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9941406, 'precision': 0.99412274, 'recall': 0.9941881, 'specificity': 0.9941881, 'f1': 0.9941402, 'auroc': 0.9999186, 'binary_precision': 0.99805576, 'binary_recall': 0.9903537, 'binary_specificity': 0.99802244, 'binary_f1_score': 0.9941898}
confusion matrix:
      0     1
0  1514     3
1    15  1540
---- Validation: 
scalar performance:
{'acc': 0.75409836, 'precision': 0.81149733, 'recall': 0.75053763, 'specificity': 0.75053763, 'f1': 0.7404255, 'auroc': 0.92562723, 'binary_precision': 0.9411765, 'binary_recall': 0.53333336, 'binary_specificity': 0.9677419, 'binary_f1_score': 0.6808511}
confusion matrix:
     0    1
0  630   21
1  294  336
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.77555555, 'precision': 0.8079742, 'recall': 0.77555555, 'specificity': 0.77555555, 'f1': 0.7694894, 'auroc': 0.9057975, 'binary_precision': 0.90789473, 'binary_recall': 0.61333334, 'binary_specificity': 0.93777776, 'binary_f1_score': 0.7320955}
confusion matrix:
     0    1
0  211   14
1   87  138
early stop counter: 1
val acc:0.7540983557701111, best validation acc: 0.88758784532547, corresponding to test acc:                         0.8844444155693054 / 0.8844444155693054
after epoch: 22,now: 2024-07-20 07:29:21.490599,epoch time: 0:01:28.481237,used: 0:32:58.145541,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_06_56_23_seed_1_22478444
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.9869792, 'precision': 0.9871465, 'recall': 0.9871465, 'specificity': 0.9871465, 'f1': 0.9869792, 'auroc': 0.9995431, 'binary_precision': 1.0, 'binary_recall': 0.97429305, 'binary_specificity': 1.0, 'binary_f1_score': 0.9869792}
confusion matrix:
      0     1
0  1516     0
1    40  1516
---- Validation: 
scalar performance:
{'acc': 0.7338017, 'precision': 0.8135513, 'recall': 0.72962105, 'specificity': 0.72962105, 'f1': 0.7133715, 'auroc': 0.92753947, 'binary_precision': 0.96763754, 'binary_recall': 0.47460318, 'binary_specificity': 0.984639, 'binary_f1_score': 0.63684773}
confusion matrix:
     0    1
0  641   10
1  331  299
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7222222, 'precision': 0.8085235, 'recall': 0.7222222, 'specificity': 0.7222222, 'f1': 0.7013364, 'auroc': 0.9184346, 'binary_precision': 0.9716981, 'binary_recall': 0.45777777, 'binary_specificity': 0.9866667, 'binary_f1_score': 0.6223565}
confusion matrix:
     0    1
0  222    3
1  122  103
early stop counter: 2
val acc:0.7338017225265503, best validation acc: 0.88758784532547, corresponding to test acc:                         0.8844444155693054 / 0.8844444155693054
after epoch: 23,now: 2024-07-20 07:30:50.271467,epoch time: 0:01:28.780868,used: 0:34:26.926409,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_06_56_23_seed_1_22478444
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9827474, 'precision': 0.98275626, 'recall': 0.98282933, 'specificity': 0.98282933, 'f1': 0.98274684, 'auroc': 0.99839306, 'binary_precision': 0.9895697, 'binary_recall': 0.97620577, 'binary_specificity': 0.98945284, 'binary_f1_score': 0.9828423}
confusion matrix:
      0     1
0  1501    16
1    37  1518
---- Validation: 
scalar performance:
{'acc': 0.8891491, 'precision': 0.89351976, 'recall': 0.88830006, 'specificity': 0.88830006, 'f1': 0.8886588, 'auroc': 0.9350188, 'binary_precision': 0.9310954, 'binary_recall': 0.8365079, 'binary_specificity': 0.94009215, 'binary_f1_score': 0.8812708}
confusion matrix:
     0    1
0  612   39
1  103  527
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.82666665, 'precision': 0.8535089, 'recall': 0.8266667, 'specificity': 0.8266667, 'f1': 0.82331264, 'auroc': 0.9163852, 'binary_precision': 0.9509202, 'binary_recall': 0.6888889, 'binary_specificity': 0.96444446, 'binary_f1_score': 0.7989691}
confusion matrix:
     0    1
0  217    8
1   70  155
better model found
persisted
after epoch: 24,now: 2024-07-20 07:32:18.283673,epoch time: 0:01:28.012206,used: 0:35:54.938615,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_06_56_23_seed_1_22478444
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.9866536, 'precision': 0.9867761, 'recall': 0.9865831, 'specificity': 0.9865831, 'f1': 0.9866494, 'auroc': 0.9996083, 'binary_precision': 0.9815522, 'binary_recall': 0.992283, 'binary_specificity': 0.9808833, 'binary_f1_score': 0.98688835}
confusion matrix:
      0     1
0  1488    29
1    12  1543
---- Validation: 
scalar performance:
{'acc': 0.86260736, 'precision': 0.86821616, 'recall': 0.86159754, 'specificity': 0.86159754, 'f1': 0.861815, 'auroc': 0.9219053, 'binary_precision': 0.9097473, 'binary_recall': 0.8, 'binary_specificity': 0.92319506, 'binary_f1_score': 0.8513514}
confusion matrix:
     0    1
0  601   50
1  126  504
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.86, 'precision': 0.8660815, 'recall': 0.86, 'specificity': 0.86, 'f1': 0.8594161, 'auroc': 0.9303111, 'binary_precision': 0.9132653, 'binary_recall': 0.79555553, 'binary_specificity': 0.92444444, 'binary_f1_score': 0.8503563}
confusion matrix:
     0    1
0  208   17
1   46  179
early stop counter: 1
val acc:0.8626073598861694, best validation acc: 0.8891491293907166, corresponding to test acc:                         0.8266666531562805 / 0.8844444155693054
after epoch: 25,now: 2024-07-20 07:33:46.708384,epoch time: 0:01:28.424711,used: 0:37:23.363326,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_06_56_23_seed_1_22478444
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.99153644, 'precision': 0.99152285, 'recall': 0.99160284, 'specificity': 0.99160284, 'f1': 0.9915359, 'auroc': 0.99961805, 'binary_precision': 0.9967533, 'binary_recall': 0.98650384, 'binary_specificity': 0.99670184, 'binary_f1_score': 0.9916021}
confusion matrix:
      0     1
0  1511     5
1    21  1535
---- Validation: 
scalar performance:
{'acc': 0.80796254, 'precision': 0.83928484, 'recall': 0.8054532, 'specificity': 0.8054532, 'f1': 0.80250216, 'auroc': 0.9185947, 'binary_precision': 0.93835616, 'binary_recall': 0.65238094, 'binary_specificity': 0.95852536, 'binary_f1_score': 0.7696629}
confusion matrix:
     0    1
0  624   27
1  219  411
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.82, 'precision': 0.8576475, 'recall': 0.82, 'specificity': 0.82, 'f1': 0.8151351, 'auroc': 0.92942226, 'binary_precision': 0.9736842, 'binary_recall': 0.6577778, 'binary_specificity': 0.9822222, 'binary_f1_score': 0.7851459}
confusion matrix:
     0    1
0  221    4
1   77  148
early stop counter: 2
val acc:0.8079625368118286, best validation acc: 0.8891491293907166, corresponding to test acc:                         0.8266666531562805 / 0.8844444155693054
after epoch: 26,now: 2024-07-20 07:35:15.836781,epoch time: 0:01:29.128397,used: 0:38:52.491723,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_06_56_23_seed_1_22478444
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.99153644, 'precision': 0.9915106, 'recall': 0.9915907, 'specificity': 0.9915907, 'f1': 0.99153554, 'auroc': 0.9998287, 'binary_precision': 0.9954722, 'binary_recall': 0.9878049, 'binary_specificity': 0.99537647, 'binary_f1_score': 0.9916237}
confusion matrix:
      0     1
0  1507     7
1    19  1539
---- Validation: 
scalar performance:
{'acc': 0.8563622, 'precision': 0.8662207, 'recall': 0.8550179, 'specificity': 0.8550179, 'f1': 0.8550256, 'auroc': 0.9211579, 'binary_precision': 0.9223485, 'binary_recall': 0.77301586, 'binary_specificity': 0.93701994, 'binary_f1_score': 0.84110534}
confusion matrix:
     0    1
0  610   41
1  143  487
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.84, 'precision': 0.8562116, 'recall': 0.84000003, 'specificity': 0.84000003, 'f1': 0.8381586, 'auroc': 0.9174913, 'binary_precision': 0.9322034, 'binary_recall': 0.73333335, 'binary_specificity': 0.94666666, 'binary_f1_score': 0.82089555}
confusion matrix:
     0    1
0  213   12
1   60  165
early stop counter: 3
val acc:0.8563622236251831, best validation acc: 0.8891491293907166, corresponding to test acc:                         0.8266666531562805 / 0.8844444155693054
after epoch: 27,now: 2024-07-20 07:36:44.479853,epoch time: 0:01:28.643072,used: 0:40:21.134795,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_06_56_23_seed_1_22478444
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.9892578, 'precision': 0.98924506, 'recall': 0.9893166, 'specificity': 0.9893166, 'f1': 0.9892572, 'auroc': 0.9994714, 'binary_precision': 0.9941558, 'binary_recall': 0.9845659, 'binary_specificity': 0.99406725, 'binary_f1_score': 0.9893376}
confusion matrix:
      0     1
0  1508     9
1    24  1531
---- Validation: 
scalar performance:
{'acc': 0.7626854, 'precision': 0.8126117, 'recall': 0.7593702, 'specificity': 0.7593702, 'f1': 0.75122017, 'auroc': 0.91633385, 'binary_precision': 0.93351066, 'binary_recall': 0.55714285, 'binary_specificity': 0.96159756, 'binary_f1_score': 0.69781315}
confusion matrix:
     0    1
0  626   25
1  279  351
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8688889, 'precision': 0.88031524, 'recall': 0.86888885, 'specificity': 0.86888885, 'f1': 0.8678967, 'auroc': 0.9314766, 'binary_precision': 0.94623655, 'binary_recall': 0.7822222, 'binary_specificity': 0.95555556, 'binary_f1_score': 0.8564477}
confusion matrix:
     0    1
0  215   10
1   49  176
early stop counter: 4
val acc:0.7626854181289673, best validation acc: 0.8891491293907166, corresponding to test acc:                         0.8266666531562805 / 0.8844444155693054
after epoch: 28,now: 2024-07-20 07:38:13.089580,epoch time: 0:01:28.609727,used: 0:41:49.744522,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_06_56_23_seed_1_22478444
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.98502606, 'precision': 0.98539054, 'recall': 0.9848868, 'specificity': 0.9848868, 'f1': 0.9850178, 'auroc': 0.99945146, 'binary_precision': 0.97482693, 'binary_recall': 0.9961415, 'binary_specificity': 0.97363216, 'binary_f1_score': 0.98536897}
confusion matrix:
      0     1
0  1477    40
1     6  1549
---- Validation: 
scalar performance:
{'acc': 0.8774395, 'precision': 0.8775898, 'recall': 0.87726575, 'specificity': 0.87726575, 'f1': 0.877363, 'auroc': 0.9188281, 'binary_precision': 0.88206786, 'binary_recall': 0.8666667, 'binary_specificity': 0.8878648, 'binary_f1_score': 0.8742995}
confusion matrix:
     0    1
0  578   73
1   84  546
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8288889, 'precision': 0.83444476, 'recall': 0.8288889, 'specificity': 0.8288889, 'f1': 0.8281753, 'auroc': 0.9158716, 'binary_precision': 0.79133856, 'binary_recall': 0.8933333, 'binary_specificity': 0.7644445, 'binary_f1_score': 0.8392484}
confusion matrix:
     0    1
0  172   53
1   24  201
early stop counter: 5
val acc:0.8774394989013672, best validation acc: 0.8891491293907166, corresponding to test acc:                         0.8266666531562805 / 0.8844444155693054
after epoch: 29,now: 2024-07-20 07:39:42.456687,epoch time: 0:01:29.367107,used: 0:43:19.111629,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_06_56_23_seed_1_22478444
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.98307294, 'precision': 0.98376167, 'recall': 0.9828799, 'specificity': 0.9828799, 'f1': 0.98305964, 'auroc': 0.99987876, 'binary_precision': 0.9682045, 'binary_recall': 0.9993565, 'binary_specificity': 0.9664032, 'binary_f1_score': 0.98353386}
confusion matrix:
      0     1
0  1467    51
1     1  1553
---- Validation: 
scalar performance:
{'acc': 0.87275565, 'precision': 0.87513596, 'recall': 0.8734255, 'specificity': 0.8734255, 'f1': 0.872666, 'auroc': 0.936208, 'binary_precision': 0.8408759, 'binary_recall': 0.9142857, 'binary_specificity': 0.8325653, 'binary_f1_score': 0.87604564}
confusion matrix:
     0    1
0  542  109
1   54  576
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.85555553, 'precision': 0.8624356, 'recall': 0.85555553, 'specificity': 0.85555553, 'f1': 0.8548668, 'auroc': 0.93104196, 'binary_precision': 0.8125, 'binary_recall': 0.92444444, 'binary_specificity': 0.7866667, 'binary_f1_score': 0.8648648}
confusion matrix:
     0    1
0  177   48
1   17  208
early stop counter: 6
val acc:0.8727556467056274, best validation acc: 0.8891491293907166, corresponding to test acc:                         0.8266666531562805 / 0.8844444155693054
after epoch: 30,now: 2024-07-20 07:41:10.596018,epoch time: 0:01:28.139331,used: 0:44:47.250960,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_06_56_23_seed_1_22478444
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 0:44:47.250960 at 2024-07-20 07:41:10.596018
persisted model performance metric: 

scalar performance:
{'acc': 0.82666665, 'precision': 0.8535089, 'recall': 0.8266667, 'specificity': 0.8266667, 'f1': 0.82331264, 'auroc': 0.9163852, 'binary_precision': 0.9509202, 'binary_recall': 0.6888889, 'binary_specificity': 0.96444446, 'binary_f1_score': 0.7989691}
confusion matrix:
     0    1
0  217    8
1   70  155
oracle model performance metric: 

scalar performance:
{'acc': 0.8844444, 'precision': 0.8945448, 'recall': 0.8844445, 'specificity': 0.8844445, 'f1': 0.88370013, 'auroc': 0.9334519, 'binary_precision': 0.95767194, 'binary_recall': 0.80444443, 'binary_specificity': 0.96444446, 'binary_f1_score': 0.8743961}
confusion matrix:
     0    1
0  217    8
1   44  181
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_nofreeze_2024-07-19_18-41-07/rule_results/4.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_nofreeze_2024-07-19_18-41-07/confusion_matrix/4.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 455402 KiB |  13219 MiB | 149715 GiB | 149715 GiB |
|       from large pool | 414803 KiB |  13181 MiB | 147928 GiB | 147928 GiB |
|       from small pool |  40598 KiB |     60 MiB |   1786 GiB |   1786 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 455402 KiB |  13219 MiB | 149715 GiB | 149715 GiB |
|       from large pool | 414803 KiB |  13181 MiB | 147928 GiB | 147928 GiB |
|       from small pool |  40598 KiB |     60 MiB |   1786 GiB |   1786 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 447481 KiB |  13213 MiB | 149150 GiB | 149149 GiB |
|       from large pool | 407075 KiB |  13175 MiB | 147366 GiB | 147366 GiB |
|       from small pool |  40406 KiB |     60 MiB |   1783 GiB |   1783 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  14482 MiB |  14482 MiB |  28046 MiB |  13564 MiB |
|       from large pool |  14412 MiB |  14412 MiB |  27960 MiB |  13548 MiB |
|       from small pool |     70 MiB |     70 MiB |     86 MiB |     16 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 443670 KiB |   1236 MiB | 105308 GiB | 105308 GiB |
|       from large pool | 435116 KiB |   1229 MiB | 103511 GiB | 103510 GiB |
|       from small pool |   8553 KiB |     44 MiB |   1797 GiB |   1797 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    1310    |    2598    |   26313 K  |   26311 K  |
|       from large pool |     187    |    1413    |   13436 K  |   13436 K  |
|       from small pool |    1123    |    1419    |   12876 K  |   12875 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    1310    |    2598    |   26313 K  |   26311 K  |
|       from large pool |     187    |    1413    |   13436 K  |   13436 K  |
|       from small pool |    1123    |    1419    |   12876 K  |   12875 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     637    |     637    |    1208    |     571    |
|       from large pool |     602    |     602    |    1165    |     563    |
|       from small pool |      35    |      35    |      43    |       8    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      90    |     650    |   18144 K  |   18144 K  |
|       from large pool |      38    |     605    |   10604 K  |   10604 K  |
|       from small pool |      52    |     236    |    7540 K  |    7540 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13219 MiB | 149715 GiB | 149715 GiB |
|       from large pool |  16640 KiB |  13181 MiB | 147928 GiB | 147928 GiB |
|       from small pool |      0 KiB |     60 MiB |   1786 GiB |   1786 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13219 MiB | 149715 GiB | 149715 GiB |
|       from large pool |  16640 KiB |  13181 MiB | 147928 GiB | 147928 GiB |
|       from small pool |      0 KiB |     60 MiB |   1786 GiB |   1786 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13213 MiB | 149150 GiB | 149150 GiB |
|       from large pool |  16640 KiB |  13175 MiB | 147366 GiB | 147366 GiB |
|       from small pool |      0 KiB |     60 MiB |   1783 GiB |   1783 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    878 MiB |  14482 MiB |  28046 MiB |  27168 MiB |
|       from large pool |    830 MiB |  14412 MiB |  27960 MiB |  27130 MiB |
|       from small pool |     48 MiB |     70 MiB |     86 MiB |     38 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1236 MiB | 105309 GiB | 105309 GiB |
|       from large pool |  24320 KiB |   1229 MiB | 103511 GiB | 103511 GiB |
|       from small pool |      0 KiB |     44 MiB |   1797 GiB |   1797 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    2598    |   26313 K  |   26313 K  |
|       from large pool |       2    |    1413    |   13436 K  |   13436 K  |
|       from small pool |       0    |    1419    |   12876 K  |   12876 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    2598    |   26313 K  |   26313 K  |
|       from large pool |       2    |    1413    |   13436 K  |   13436 K  |
|       from small pool |       0    |    1419    |   12876 K  |   12876 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      61    |     637    |    1208    |    1147    |
|       from large pool |      37    |     602    |    1165    |    1128    |
|       from small pool |      24    |      35    |      43    |      19    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |     650    |   18145 K  |   18145 K  |
|       from large pool |       4    |     605    |   10604 K  |   10604 K  |
|       from small pool |       0    |     236    |    7540 K  |    7540 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13219 MiB | 149715 GiB | 149715 GiB |
|       from large pool |  16640 KiB |  13181 MiB | 147928 GiB | 147928 GiB |
|       from small pool |      0 KiB |     60 MiB |   1786 GiB |   1786 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13219 MiB | 149715 GiB | 149715 GiB |
|       from large pool |  16640 KiB |  13181 MiB | 147928 GiB | 147928 GiB |
|       from small pool |      0 KiB |     60 MiB |   1786 GiB |   1786 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13213 MiB | 149150 GiB | 149150 GiB |
|       from large pool |  16640 KiB |  13175 MiB | 147366 GiB | 147366 GiB |
|       from small pool |      0 KiB |     60 MiB |   1783 GiB |   1783 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    878 MiB |  14482 MiB |  28046 MiB |  27168 MiB |
|       from large pool |    830 MiB |  14412 MiB |  27960 MiB |  27130 MiB |
|       from small pool |     48 MiB |     70 MiB |     86 MiB |     38 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1236 MiB | 105309 GiB | 105309 GiB |
|       from large pool |  24320 KiB |   1229 MiB | 103511 GiB | 103511 GiB |
|       from small pool |      0 KiB |     44 MiB |   1797 GiB |   1797 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    2598    |   26313 K  |   26313 K  |
|       from large pool |       2    |    1413    |   13436 K  |   13436 K  |
|       from small pool |       0    |    1419    |   12876 K  |   12876 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    2598    |   26313 K  |   26313 K  |
|       from large pool |       2    |    1413    |   13436 K  |   13436 K  |
|       from small pool |       0    |    1419    |   12876 K  |   12876 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      61    |     637    |    1208    |    1147    |
|       from large pool |      37    |     602    |    1165    |    1128    |
|       from small pool |      24    |      35    |      43    |      19    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |     650    |   18145 K  |   18145 K  |
|       from large pool |       4    |     605    |   10604 K  |   10604 K  |
|       from small pool |       0    |     236    |    7540 K  |    7540 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'888c1ef2'
model name: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_07_42_36_seed_2_22478444

 Experiment start at: 2024-07-20 07:42:36.350330
before training, model accuracy: 0.41203704476356506
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.95124346, 'precision': 0.95265645, 'recall': 0.9514743, 'specificity': 0.9514743, 'f1': 0.95122, 'auroc': 0.9877686, 'binary_precision': 0.9799862, 'binary_recall': 0.9220779, 'binary_specificity': 0.9808707, 'binary_f1_score': 0.9501505}
confusion matrix:
      0     1
0  1487    29
1   120  1420
---- Validation: 
scalar performance:
{'acc': 0.81533647, 'precision': 0.8158717, 'recall': 0.814664, 'specificity': 0.814664, 'f1': 0.81492853, 'auroc': 0.8948857, 'binary_precision': 0.8238255, 'binary_recall': 0.7893891, 'binary_specificity': 0.839939, 'binary_f1_score': 0.8062398}
confusion matrix:
     0    1
0  551  105
1  131  491
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8263889, 'precision': 0.8264519, 'recall': 0.82638884, 'specificity': 0.82638884, 'f1': 0.8263805, 'auroc': 0.91285145, 'binary_precision': 0.82191783, 'binary_recall': 0.8333333, 'binary_specificity': 0.8194444, 'binary_f1_score': 0.82758623}
confusion matrix:
     0    1
0  177   39
1   36  180
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-20 07:44:18.244728,epoch time: 0:01:41.894398,used: 0:01:41.894398,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_07_42_36_seed_2_22478444
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9741492, 'precision': 0.9741888, 'recall': 0.97420156, 'specificity': 0.97420156, 'f1': 0.9741491, 'auroc': 0.9946754, 'binary_precision': 0.9809085, 'binary_recall': 0.96753246, 'binary_specificity': 0.9808707, 'binary_f1_score': 0.9741745}
confusion matrix:
      0     1
0  1487    29
1    50  1490
---- Validation: 
scalar performance:
{'acc': 0.80594677, 'precision': 0.8166833, 'recall': 0.8083508, 'specificity': 0.8083508, 'f1': 0.8050223, 'auroc': 0.8931922, 'binary_precision': 0.7513441, 'binary_recall': 0.8987138, 'binary_specificity': 0.7179878, 'binary_f1_score': 0.818448}
confusion matrix:
     0    1
0  471  185
1   63  559
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7060185, 'precision': 0.7697651, 'recall': 0.7060185, 'specificity': 0.7060185, 'f1': 0.6875608, 'auroc': 0.9113083, 'binary_precision': 0.63862926, 'binary_recall': 0.9490741, 'binary_specificity': 0.46296296, 'binary_f1_score': 0.76350087}
confusion matrix:
     0    1
0  100  116
1   11  205
early stop counter: 1
val acc:0.8059467673301697, best validation acc: 0.8153364658355713, corresponding to test acc:                         0.8263888955116272 / 0.8263888955116272
after epoch: 2,now: 2024-07-20 07:45:44.544573,epoch time: 0:01:26.299845,used: 0:03:08.194243,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_07_42_36_seed_2_22478444
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.97709423, 'precision': 0.9775243, 'recall': 0.9772265, 'specificity': 0.9772265, 'f1': 0.9770923, 'auroc': 0.9963155, 'binary_precision': 0.9939516, 'binary_recall': 0.9603896, 'binary_specificity': 0.9940633, 'binary_f1_score': 0.97688246}
confusion matrix:
      0     1
0  1507     9
1    61  1479
---- Validation: 
scalar performance:
{'acc': 0.81064165, 'precision': 0.8291533, 'recall': 0.8074244, 'specificity': 0.8074244, 'f1': 0.8067218, 'auroc': 0.89483666, 'binary_precision': 0.90084386, 'binary_recall': 0.6864952, 'binary_specificity': 0.92835367, 'binary_f1_score': 0.77919704}
confusion matrix:
     0    1
0  609   47
1  195  427
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8518519, 'precision': 0.85294116, 'recall': 0.8518518, 'specificity': 0.8518518, 'f1': 0.8517375, 'auroc': 0.91870284, 'binary_precision': 0.872549, 'binary_recall': 0.8240741, 'binary_specificity': 0.8796296, 'binary_f1_score': 0.84761906}
confusion matrix:
     0    1
0  190   26
1   38  178
new oracle model saved
early stop counter: 2
val acc:0.8106416463851929, best validation acc: 0.8153364658355713, corresponding to test acc:                         0.8263888955116272 / 0.8518518805503845
after epoch: 3,now: 2024-07-20 07:47:10.982871,epoch time: 0:01:26.438298,used: 0:04:34.632541,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_07_42_36_seed_2_22478444
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9757853, 'precision': 0.97604597, 'recall': 0.9758918, 'specificity': 0.9758918, 'f1': 0.9757845, 'auroc': 0.99710876, 'binary_precision': 0.9893191, 'binary_recall': 0.9623377, 'binary_specificity': 0.9894459, 'binary_f1_score': 0.97564185}
confusion matrix:
      0     1
0  1500    16
1    58  1482
---- Validation: 
scalar performance:
{'acc': 0.81846637, 'precision': 0.8453448, 'recall': 0.81471306, 'specificity': 0.81471306, 'f1': 0.8135269, 'auroc': 0.90665686, 'binary_precision': 0.93526787, 'binary_recall': 0.67363346, 'binary_specificity': 0.95579267, 'binary_f1_score': 0.7831776}
confusion matrix:
     0    1
0  627   29
1  203  419
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7800926, 'precision': 0.83141434, 'recall': 0.7800926, 'specificity': 0.7800926, 'f1': 0.7712362, 'auroc': 0.91280866, 'binary_precision': 0.96183205, 'binary_recall': 0.5833333, 'binary_specificity': 0.9768519, 'binary_f1_score': 0.7262248}
confusion matrix:
     0    1
0  211    5
1   90  126
better model found
persisted
after epoch: 4,now: 2024-07-20 07:48:38.864818,epoch time: 0:01:27.881947,used: 0:06:02.514488,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_07_42_36_seed_2_22478444
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.93815446, 'precision': 0.9437846, 'recall': 0.9377215, 'specificity': 0.9377215, 'f1': 0.93791187, 'auroc': 0.9966407, 'binary_precision': 0.89572346, 'binary_recall': 0.99285716, 'binary_specificity': 0.88258576, 'binary_f1_score': 0.9417924}
confusion matrix:
      0     1
0  1338   178
1    11  1529
---- Validation: 
scalar performance:
{'acc': 0.7942097, 'precision': 0.7957028, 'recall': 0.7931265, 'specificity': 0.7931265, 'f1': 0.7934203, 'auroc': 0.8558153, 'binary_precision': 0.81109184, 'binary_recall': 0.7524116, 'binary_specificity': 0.83384144, 'binary_f1_score': 0.7806505}
confusion matrix:
     0    1
0  547  109
1  154  468
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7476852, 'precision': 0.7859335, 'recall': 0.7476852, 'specificity': 0.7476852, 'f1': 0.7389555, 'auroc': 0.89523315, 'binary_precision': 0.68135595, 'binary_recall': 0.9305556, 'binary_specificity': 0.5648148, 'binary_f1_score': 0.7866928}
confusion matrix:
     0    1
0  122   94
1   15  201
early stop counter: 1
val acc:0.7942097187042236, best validation acc: 0.8184663653373718, corresponding to test acc:                         0.7800925970077515 / 0.8518518805503845
after epoch: 5,now: 2024-07-20 07:50:05.606265,epoch time: 0:01:26.741447,used: 0:07:29.255935,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_07_42_36_seed_2_22478444
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.96727747, 'precision': 0.9690594, 'recall': 0.96753246, 'specificity': 0.96753246, 'f1': 0.96725726, 'auroc': 0.9980019, 'binary_precision': 1.0, 'binary_recall': 0.9350649, 'binary_specificity': 1.0, 'binary_f1_score': 0.96644294}
confusion matrix:
      0     1
0  1516     0
1   100  1440
---- Validation: 
scalar performance:
{'acc': 0.6158059, 'precision': 0.7563354, 'recall': 0.60568047, 'specificity': 0.60568047, 'f1': 0.5440473, 'auroc': 0.8774073, 'binary_precision': 0.9395973, 'binary_recall': 0.22508039, 'binary_specificity': 0.9862805, 'binary_f1_score': 0.3631647}
confusion matrix:
     0    1
0  647    9
1  482  140
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7453704, 'precision': 0.83128834, 'recall': 0.7453704, 'specificity': 0.7453704, 'f1': 0.72771657, 'auroc': 0.9156164, 'binary_precision': 1.0, 'binary_recall': 0.49074075, 'binary_specificity': 1.0, 'binary_f1_score': 0.6583851}
confusion matrix:
     0    1
0  216    0
1  110  106
early stop counter: 2
val acc:0.6158059239387512, best validation acc: 0.8184663653373718, corresponding to test acc:                         0.7800925970077515 / 0.8518518805503845
after epoch: 6,now: 2024-07-20 07:51:31.928874,epoch time: 0:01:26.322609,used: 0:08:55.578544,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_07_42_36_seed_2_22478444
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.97971207, 'precision': 0.9797883, 'recall': 0.9797776, 'specificity': 0.9797776, 'f1': 0.979712, 'auroc': 0.9973006, 'binary_precision': 0.98811096, 'binary_recall': 0.9714286, 'binary_specificity': 0.98812664, 'binary_f1_score': 0.9796988}
confusion matrix:
      0     1
0  1498    18
1    44  1496
---- Validation: 
scalar performance:
{'acc': 0.7918623, 'precision': 0.8199242, 'recall': 0.7878401, 'specificity': 0.7878401, 'f1': 0.78550607, 'auroc': 0.8823303, 'binary_precision': 0.9082569, 'binary_recall': 0.6366559, 'binary_specificity': 0.9390244, 'binary_f1_score': 0.74858224}
confusion matrix:
     0    1
0  616   40
1  226  396
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8310185, 'precision': 0.84217346, 'recall': 0.8310185, 'specificity': 0.8310185, 'f1': 0.82963, 'auroc': 0.8778292, 'binary_precision': 0.9039548, 'binary_recall': 0.7407407, 'binary_specificity': 0.9212963, 'binary_f1_score': 0.81424934}
confusion matrix:
     0    1
0  199   17
1   56  160
early stop counter: 3
val acc:0.7918623089790344, best validation acc: 0.8184663653373718, corresponding to test acc:                         0.7800925970077515 / 0.8518518805503845
after epoch: 7,now: 2024-07-20 07:52:59.945554,epoch time: 0:01:28.016680,used: 0:10:23.595224,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_07_42_36_seed_2_22478444
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9748037, 'precision': 0.97481084, 'recall': 0.9747944, 'specificity': 0.9747944, 'f1': 0.97480166, 'auroc': 0.99574924, 'binary_precision': 0.97407645, 'binary_recall': 0.975974, 'binary_specificity': 0.97361475, 'binary_f1_score': 0.9750243}
confusion matrix:
      0     1
0  1476    40
1    37  1503
---- Validation: 
scalar performance:
{'acc': 0.7425665, 'precision': 0.74579895, 'recall': 0.74394655, 'specificity': 0.74394655, 'f1': 0.7423013, 'auroc': 0.8218914, 'binary_precision': 0.71018654, 'binary_recall': 0.79581994, 'binary_specificity': 0.69207317, 'binary_f1_score': 0.7505686}
confusion matrix:
     0    1
0  454  202
1  127  495
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6319444, 'precision': 0.6635885, 'recall': 0.6319445, 'specificity': 0.6319445, 'f1': 0.6132411, 'auroc': 0.7782922, 'binary_precision': 0.5916399, 'binary_recall': 0.8518519, 'binary_specificity': 0.41203704, 'binary_f1_score': 0.69829226}
confusion matrix:
    0    1
0  89  127
1  32  184
early stop counter: 4
val acc:0.7425665259361267, best validation acc: 0.8184663653373718, corresponding to test acc:                         0.7800925970077515 / 0.8518518805503845
after epoch: 8,now: 2024-07-20 07:54:26.671165,epoch time: 0:01:26.725611,used: 0:11:50.320835,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_07_42_36_seed_2_22478444
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9888743, 'precision': 0.98887, 'recall': 0.98889935, 'specificity': 0.98889935, 'f1': 0.9888741, 'auroc': 0.9989484, 'binary_precision': 0.99215686, 'binary_recall': 0.98571426, 'binary_specificity': 0.99208444, 'binary_f1_score': 0.98892504}
confusion matrix:
      0     1
0  1504    12
1    22  1518
---- Validation: 
scalar performance:
{'acc': 0.6690141, 'precision': 0.74788934, 'recall': 0.6612594, 'specificity': 0.6612594, 'f1': 0.63405603, 'auroc': 0.8268249, 'binary_precision': 0.88122606, 'binary_recall': 0.3697749, 'binary_specificity': 0.9527439, 'binary_f1_score': 0.5209513}
confusion matrix:
     0    1
0  625   31
1  392  230
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8333333, 'precision': 0.84643143, 'recall': 0.8333334, 'specificity': 0.8333334, 'f1': 0.83174294, 'auroc': 0.91274434, 'binary_precision': 0.9137931, 'binary_recall': 0.7361111, 'binary_specificity': 0.9305556, 'binary_f1_score': 0.8153846}
confusion matrix:
     0    1
0  201   15
1   57  159
early stop counter: 5
val acc:0.6690140962600708, best validation acc: 0.8184663653373718, corresponding to test acc:                         0.7800925970077515 / 0.8518518805503845
after epoch: 9,now: 2024-07-20 07:55:52.841031,epoch time: 0:01:26.169866,used: 0:13:16.490701,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_07_42_36_seed_2_22478444
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9826571, 'precision': 0.9828256, 'recall': 0.98274595, 'specificity': 0.98274595, 'f1': 0.98265684, 'auroc': 0.99900067, 'binary_precision': 0.9940199, 'binary_recall': 0.9714286, 'binary_specificity': 0.9940633, 'binary_f1_score': 0.98259443}
confusion matrix:
      0     1
0  1507     9
1    44  1496
---- Validation: 
scalar performance:
{'acc': 0.68701094, 'precision': 0.7763299, 'recall': 0.6792482, 'specificity': 0.6792482, 'f1': 0.6537683, 'auroc': 0.8918467, 'binary_precision': 0.9269231, 'binary_recall': 0.3874598, 'binary_specificity': 0.9710366, 'binary_f1_score': 0.5464853}
confusion matrix:
     0    1
0  637   19
1  381  241
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7569444, 'precision': 0.8252747, 'recall': 0.7569444, 'specificity': 0.7569444, 'f1': 0.74347234, 'auroc': 0.9067216, 'binary_precision': 0.974359, 'binary_recall': 0.5277778, 'binary_specificity': 0.9861111, 'binary_f1_score': 0.68468475}
confusion matrix:
     0    1
0  213    3
1  102  114
early stop counter: 6
val acc:0.6870109438896179, best validation acc: 0.8184663653373718, corresponding to test acc:                         0.7800925970077515 / 0.8518518805503845
after epoch: 10,now: 2024-07-20 07:57:19.734929,epoch time: 0:01:26.893898,used: 0:14:43.384599,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_07_42_36_seed_2_22478444
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9849476, 'precision': 0.9851549, 'recall': 0.98504436, 'specificity': 0.98504436, 'f1': 0.9849473, 'auroc': 0.99918187, 'binary_precision': 0.99733686, 'binary_recall': 0.9727273, 'binary_specificity': 0.9973615, 'binary_f1_score': 0.9848784}
confusion matrix:
      0     1
0  1512     4
1    42  1498
---- Validation: 
scalar performance:
{'acc': 0.6400626, 'precision': 0.7387373, 'recall': 0.631225, 'specificity': 0.631225, 'f1': 0.590147, 'auroc': 0.8444975, 'binary_precision': 0.8857143, 'binary_recall': 0.29903537, 'binary_specificity': 0.9634146, 'binary_f1_score': 0.44711542}
confusion matrix:
     0    1
0  632   24
1  436  186
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8101852, 'precision': 0.81474555, 'recall': 0.8101852, 'specificity': 0.8101852, 'f1': 0.8094951, 'auroc': 0.87221366, 'binary_precision': 0.85263157, 'binary_recall': 0.75, 'binary_specificity': 0.8703704, 'binary_f1_score': 0.79802954}
confusion matrix:
     0    1
0  188   28
1   54  162
early stop counter: 7
val acc:0.6400625705718994, best validation acc: 0.8184663653373718, corresponding to test acc:                         0.7800925970077515 / 0.8518518805503845
after epoch: 11,now: 2024-07-20 07:58:46.985515,epoch time: 0:01:27.250586,used: 0:16:10.635185,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_07_42_36_seed_2_22478444
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9888743, 'precision': 0.98889595, 'recall': 0.9888582, 'specificity': 0.9888582, 'f1': 0.98887324, 'auroc': 0.9994179, 'binary_precision': 0.9870634, 'binary_recall': 0.9909091, 'binary_specificity': 0.9868074, 'binary_f1_score': 0.9889825}
confusion matrix:
      0     1
0  1496    20
1    14  1526
---- Validation: 
scalar performance:
{'acc': 0.7754304, 'precision': 0.80322933, 'recall': 0.77129245, 'specificity': 0.77129245, 'f1': 0.768247, 'auroc': 0.8739609, 'binary_precision': 0.8886311, 'binary_recall': 0.6157556, 'binary_specificity': 0.9268293, 'binary_f1_score': 0.7274454}
confusion matrix:
     0    1
0  608   48
1  239  383
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8125, 'precision': 0.8125067, 'recall': 0.8125, 'specificity': 0.8125, 'f1': 0.81249905, 'auroc': 0.8796939, 'binary_precision': 0.8110599, 'binary_recall': 0.8148148, 'binary_specificity': 0.8101852, 'binary_f1_score': 0.812933}
confusion matrix:
     0    1
0  175   41
1   40  176
early stop counter: 8
val acc:0.7754303812980652, best validation acc: 0.8184663653373718, corresponding to test acc:                         0.7800925970077515 / 0.8518518805503845
after epoch: 12,now: 2024-07-20 08:00:13.101422,epoch time: 0:01:26.115907,used: 0:17:36.751092,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_07_42_36_seed_2_22478444
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9685864, 'precision': 0.9702233, 'recall': 0.9688312, 'specificity': 0.9688312, 'f1': 0.968569, 'auroc': 0.99728024, 'binary_precision': 1.0, 'binary_recall': 0.93766236, 'binary_specificity': 1.0, 'binary_f1_score': 0.96782845}
confusion matrix:
      0     1
0  1516     0
1    96  1444
---- Validation: 
scalar performance:
{'acc': 0.62441313, 'precision': 0.7853285, 'recall': 0.61418957, 'specificity': 0.61418957, 'f1': 0.55260587, 'auroc': 0.8933913, 'binary_precision': 0.9930556, 'binary_recall': 0.22990353, 'binary_specificity': 0.9984756, 'binary_f1_score': 0.37336814}
confusion matrix:
     0    1
0  655    1
1  479  143
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5208333, 'precision': 0.7553191, 'recall': 0.5208333, 'specificity': 0.5208333, 'f1': 0.37802818, 'auroc': 0.86995244, 'binary_precision': 1.0, 'binary_recall': 0.041666668, 'binary_specificity': 1.0, 'binary_f1_score': 0.080000006}
confusion matrix:
     0  1
0  216  0
1  207  9
early stop counter: 9
val acc:0.6244131326675415, best validation acc: 0.8184663653373718, corresponding to test acc:                         0.7800925970077515 / 0.8518518805503845
after epoch: 13,now: 2024-07-20 08:01:39.062159,epoch time: 0:01:25.960737,used: 0:19:02.711829,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_07_42_36_seed_2_22478444
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.989856, 'precision': 0.98992294, 'recall': 0.989822, 'specificity': 0.989822, 'f1': 0.9898546, 'auroc': 0.9997036, 'binary_precision': 0.9858339, 'binary_recall': 0.9941558, 'binary_specificity': 0.9854881, 'binary_f1_score': 0.98997736}
confusion matrix:
      0     1
0  1494    22
1     9  1531
---- Validation: 
scalar performance:
{'acc': 0.7253521, 'precision': 0.7643364, 'recall': 0.7200538, 'specificity': 0.7200538, 'f1': 0.7116076, 'auroc': 0.8473036, 'binary_precision': 0.8594164, 'binary_recall': 0.5209003, 'binary_specificity': 0.91920733, 'binary_f1_score': 0.6486486}
confusion matrix:
     0    1
0  603   53
1  298  324
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8263889, 'precision': 0.82639587, 'recall': 0.8263889, 'specificity': 0.8263889, 'f1': 0.82638794, 'auroc': 0.90239197, 'binary_precision': 0.82790697, 'binary_recall': 0.8240741, 'binary_specificity': 0.8287037, 'binary_f1_score': 0.8259861}
confusion matrix:
     0    1
0  179   37
1   38  178
early stop counter: 10
val acc:0.7253521084785461, best validation acc: 0.8184663653373718, corresponding to test acc:                         0.7800925970077515 / 0.8518518805503845
after epoch: 14,now: 2024-07-20 08:03:12.272472,epoch time: 0:01:33.210313,used: 0:20:35.922142,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_07_42_36_seed_2_22478444
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9928011, 'precision': 0.99280643, 'recall': 0.99279547, 'specificity': 0.99279547, 'f1': 0.99280053, 'auroc': 0.99954724, 'binary_precision': 0.9922179, 'binary_recall': 0.9935065, 'binary_specificity': 0.99208444, 'binary_f1_score': 0.99286175}
confusion matrix:
      0     1
0  1504    12
1    10  1530
---- Validation: 
scalar performance:
{'acc': 0.7543036, 'precision': 0.800462, 'recall': 0.7489633, 'specificity': 0.7489633, 'f1': 0.7417284, 'auroc': 0.8749271, 'binary_precision': 0.9117647, 'binary_recall': 0.5482315, 'binary_specificity': 0.9496951, 'binary_f1_score': 0.68473893}
confusion matrix:
     0    1
0  623   33
1  281  341
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.75, 'precision': 0.79709625, 'recall': 0.75, 'specificity': 0.75, 'f1': 0.73968357, 'auroc': 0.9005273, 'binary_precision': 0.9153846, 'binary_recall': 0.5509259, 'binary_specificity': 0.9490741, 'binary_f1_score': 0.68786126}
confusion matrix:
     0    1
0  205   11
1   97  119
early stop counter: 11
val acc:0.7543035745620728, best validation acc: 0.8184663653373718, corresponding to test acc:                         0.7800925970077515 / 0.8518518805503845
after epoch: 15,now: 2024-07-20 08:04:38.657012,epoch time: 0:01:26.384540,used: 0:22:02.306682,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_07_42_36_seed_2_22478444
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9872382, 'precision': 0.98738074, 'recall': 0.98718345, 'specificity': 0.98718345, 'f1': 0.9872354, 'auroc': 0.99929917, 'binary_precision': 0.98078156, 'binary_recall': 0.9941558, 'binary_specificity': 0.9802111, 'binary_f1_score': 0.98742336}
confusion matrix:
      0     1
0  1486    30
1     9  1531
---- Validation: 
scalar performance:
{'acc': 0.842723, 'precision': 0.84950507, 'recall': 0.84084094, 'specificity': 0.84084094, 'f1': 0.84134746, 'auroc': 0.90559316, 'binary_precision': 0.89199257, 'binary_recall': 0.7700965, 'binary_specificity': 0.9115854, 'binary_f1_score': 0.8265746}
confusion matrix:
     0    1
0  598   58
1  143  479
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8333333, 'precision': 0.8343653, 'recall': 0.8333334, 'specificity': 0.8333334, 'f1': 0.8332046, 'auroc': 0.906893, 'binary_precision': 0.81578946, 'binary_recall': 0.8611111, 'binary_specificity': 0.8055556, 'binary_f1_score': 0.8378378}
confusion matrix:
     0    1
0  174   42
1   30  186
better model found
persisted
after epoch: 16,now: 2024-07-20 08:06:04.944100,epoch time: 0:01:26.287088,used: 0:23:28.593770,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_07_42_36_seed_2_22478444
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.98331153, 'precision': 0.98372686, 'recall': 0.9834416, 'specificity': 0.9834416, 'f1': 0.9833102, 'auroc': 0.9996363, 'binary_precision': 1.0, 'binary_recall': 0.9668831, 'binary_specificity': 1.0, 'binary_f1_score': 0.98316276}
confusion matrix:
      0     1
0  1516     0
1    51  1489
---- Validation: 
scalar performance:
{'acc': 0.65258217, 'precision': 0.78292376, 'recall': 0.6433368, 'specificity': 0.6433368, 'f1': 0.5993074, 'auroc': 0.88482153, 'binary_precision': 0.96842104, 'binary_recall': 0.29581994, 'binary_specificity': 0.99085367, 'binary_f1_score': 0.45320198}
confusion matrix:
     0    1
0  650    6
1  438  184
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5115741, 'precision': 0.7529274, 'recall': 0.5115741, 'specificity': 0.5115741, 'f1': 0.35854977, 'auroc': 0.814638, 'binary_precision': 1.0, 'binary_recall': 0.023148147, 'binary_specificity': 1.0, 'binary_f1_score': 0.045248866}
confusion matrix:
     0  1
0  216  0
1  211  5
early stop counter: 1
val acc:0.6525821685791016, best validation acc: 0.84272301197052, corresponding to test acc:                         0.8333333134651184 / 0.8518518805503845
after epoch: 17,now: 2024-07-20 08:07:31.024694,epoch time: 0:01:26.080594,used: 0:24:54.674364,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_07_42_36_seed_2_22478444
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9878927, 'precision': 0.98790115, 'recall': 0.9878842, 'specificity': 0.9878842, 'f1': 0.9878918, 'auroc': 0.9993952, 'binary_precision': 0.98703825, 'binary_recall': 0.98896104, 'binary_specificity': 0.9868074, 'binary_f1_score': 0.9879987}
confusion matrix:
      0     1
0  1496    20
1    17  1523
---- Validation: 
scalar performance:
{'acc': 0.8333333, 'precision': 0.854328, 'recall': 0.83006966, 'specificity': 0.83006966, 'f1': 0.82976615, 'auroc': 0.9135564, 'binary_precision': 0.9341826, 'binary_recall': 0.7073955, 'binary_specificity': 0.9527439, 'binary_f1_score': 0.80512357}
confusion matrix:
     0    1
0  625   31
1  182  440
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8009259, 'precision': 0.8409422, 'recall': 0.8009259, 'specificity': 0.8009259, 'f1': 0.79490805, 'auroc': 0.9274477, 'binary_precision': 0.9577465, 'binary_recall': 0.6296296, 'binary_specificity': 0.9722222, 'binary_f1_score': 0.75977653}
confusion matrix:
     0    1
0  210    6
1   80  136
early stop counter: 2
val acc:0.8333333134651184, best validation acc: 0.84272301197052, corresponding to test acc:                         0.8333333134651184 / 0.8518518805503845
after epoch: 18,now: 2024-07-20 08:08:59.888690,epoch time: 0:01:28.863996,used: 0:26:23.538360,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_07_42_36_seed_2_22478444
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.99247384, 'precision': 0.99246776, 'recall': 0.99248105, 'specificity': 0.99248105, 'f1': 0.9924735, 'auroc': 0.9997541, 'binary_precision': 0.9934938, 'binary_recall': 0.99155843, 'binary_specificity': 0.9934037, 'binary_f1_score': 0.99252516}
confusion matrix:
      0     1
0  1506    10
1    13  1527
---- Validation: 
scalar performance:
{'acc': 0.6768388, 'precision': 0.76280785, 'recall': 0.66900635, 'specificity': 0.66900635, 'f1': 0.6419374, 'auroc': 0.87172574, 'binary_precision': 0.9066148, 'binary_recall': 0.37459806, 'binary_specificity': 0.9634146, 'binary_f1_score': 0.53014785}
confusion matrix:
     0    1
0  632   24
1  389  233
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8263889, 'precision': 0.8490179, 'recall': 0.8263889, 'specificity': 0.8263889, 'f1': 0.82352847, 'auroc': 0.921875, 'binary_precision': 0.9378882, 'binary_recall': 0.6990741, 'binary_specificity': 0.9537037, 'binary_f1_score': 0.80106103}
confusion matrix:
     0    1
0  206   10
1   65  151
early stop counter: 3
val acc:0.6768388152122498, best validation acc: 0.84272301197052, corresponding to test acc:                         0.8333333134651184 / 0.8518518805503845
after epoch: 19,now: 2024-07-20 08:10:26.392402,epoch time: 0:01:26.503712,used: 0:27:50.042072,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_07_42_36_seed_2_22478444
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.989856, 'precision': 0.9898656, 'recall': 0.9898939, 'specificity': 0.9898939, 'f1': 0.9898559, 'auroc': 0.9993652, 'binary_precision': 0.9947541, 'binary_recall': 0.9850649, 'binary_specificity': 0.99472296, 'binary_f1_score': 0.98988575}
confusion matrix:
      0     1
0  1508     8
1    23  1517
---- Validation: 
scalar performance:
{'acc': 0.74334896, 'precision': 0.8115946, 'recall': 0.73700106, 'specificity': 0.73700106, 'f1': 0.7250142, 'auroc': 0.8923259, 'binary_precision': 0.9509202, 'binary_recall': 0.49839228, 'binary_specificity': 0.9756098, 'binary_f1_score': 0.65400845}
confusion matrix:
     0    1
0  640   16
1  312  310
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7430556, 'precision': 0.81458926, 'recall': 0.7430556, 'specificity': 0.7430556, 'f1': 0.7275687, 'auroc': 0.91090107, 'binary_precision': 0.96460176, 'binary_recall': 0.5046296, 'binary_specificity': 0.9814815, 'binary_f1_score': 0.662614}
confusion matrix:
     0    1
0  212    4
1  107  109
early stop counter: 4
val acc:0.7433489561080933, best validation acc: 0.84272301197052, corresponding to test acc:                         0.8333333134651184 / 0.8518518805503845
after epoch: 20,now: 2024-07-20 08:11:53.017095,epoch time: 0:01:26.624693,used: 0:29:16.666765,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_07_42_36_seed_2_22478444
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9928011, 'precision': 0.9927968, 'recall': 0.9928263, 'specificity': 0.9928263, 'f1': 0.9928009, 'auroc': 0.9997537, 'binary_precision': 0.99607843, 'binary_recall': 0.9896104, 'binary_specificity': 0.9960422, 'binary_f1_score': 0.9928339}
confusion matrix:
      0     1
0  1510     6
1    16  1524
---- Validation: 
scalar performance:
{'acc': 0.62754303, 'precision': 0.7603471, 'recall': 0.61777997, 'specificity': 0.61777997, 'f1': 0.56335413, 'auroc': 0.86316574, 'binary_precision': 0.939759, 'binary_recall': 0.25080386, 'binary_specificity': 0.9847561, 'binary_f1_score': 0.39593908}
confusion matrix:
     0    1
0  646   10
1  466  156
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5300926, 'precision': 0.6990078, 'recall': 0.5300926, 'specificity': 0.5300926, 'f1': 0.4035219, 'auroc': 0.84383035, 'binary_precision': 0.88235295, 'binary_recall': 0.06944445, 'binary_specificity': 0.9907407, 'binary_f1_score': 0.12875538}
confusion matrix:
     0   1
0  214   2
1  201  15
early stop counter: 5
val acc:0.627543032169342, best validation acc: 0.84272301197052, corresponding to test acc:                         0.8333333134651184 / 0.8518518805503845
after epoch: 21,now: 2024-07-20 08:13:22.864562,epoch time: 0:01:29.847467,used: 0:30:46.514232,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_07_42_36_seed_2_22478444
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9931283, 'precision': 0.99313724, 'recall': 0.99312013, 'specificity': 0.99312013, 'f1': 0.9931278, 'auroc': 0.9997657, 'binary_precision': 0.99222296, 'binary_recall': 0.9941558, 'binary_specificity': 0.99208444, 'binary_f1_score': 0.9931885}
confusion matrix:
      0     1
0  1504    12
1     9  1531
---- Validation: 
scalar performance:
{'acc': 0.7222222, 'precision': 0.7741321, 'recall': 0.71625507, 'specificity': 0.71625507, 'f1': 0.7047372, 'auroc': 0.8600355, 'binary_precision': 0.8869565, 'binary_recall': 0.49196142, 'binary_specificity': 0.9405488, 'binary_f1_score': 0.6328852}
confusion matrix:
     0    1
0  617   39
1  316  306
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.724537, 'precision': 0.77563345, 'recall': 0.724537, 'specificity': 0.724537, 'f1': 0.7111504, 'auroc': 0.8666409, 'binary_precision': 0.8943089, 'binary_recall': 0.5092593, 'binary_specificity': 0.9398148, 'binary_f1_score': 0.64896756}
confusion matrix:
     0    1
0  203   13
1  106  110
early stop counter: 6
val acc:0.7222222089767456, best validation acc: 0.84272301197052, corresponding to test acc:                         0.8333333134651184 / 0.8518518805503845
after epoch: 22,now: 2024-07-20 08:14:51.903089,epoch time: 0:01:29.038527,used: 0:32:15.552759,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_07_42_36_seed_2_22478444
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.98756546, 'precision': 0.9877735, 'recall': 0.9876623, 'specificity': 0.9876623, 'f1': 0.98756516, 'auroc': 0.99970436, 'binary_precision': 1.0, 'binary_recall': 0.9753247, 'binary_specificity': 1.0, 'binary_f1_score': 0.98750824}
confusion matrix:
      0     1
0  1516     0
1    38  1502
---- Validation: 
scalar performance:
{'acc': 0.7331768, 'precision': 0.81538904, 'recall': 0.72625923, 'specificity': 0.72625923, 'f1': 0.7105938, 'auroc': 0.9146544, 'binary_precision': 0.96989965, 'binary_recall': 0.46623793, 'binary_specificity': 0.9862805, 'binary_f1_score': 0.6297503}
confusion matrix:
     0    1
0  647    9
1  332  290
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6550926, 'precision': 0.76471555, 'recall': 0.6550926, 'specificity': 0.6550926, 'f1': 0.61526096, 'auroc': 0.8931112, 'binary_precision': 0.9350649, 'binary_recall': 0.33333334, 'binary_specificity': 0.9768519, 'binary_f1_score': 0.49146757}
confusion matrix:
     0   1
0  211   5
1  144  72
early stop counter: 7
val acc:0.7331768274307251, best validation acc: 0.84272301197052, corresponding to test acc:                         0.8333333134651184 / 0.8518518805503845
after epoch: 23,now: 2024-07-20 08:16:17.939854,epoch time: 0:01:26.036765,used: 0:33:41.589524,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_07_42_36_seed_2_22478444
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9921466, 'precision': 0.99220777, 'recall': 0.99220777, 'specificity': 0.99220777, 'f1': 0.9921466, 'auroc': 0.99912024, 'binary_precision': 1.0, 'binary_recall': 0.9844156, 'binary_specificity': 1.0, 'binary_f1_score': 0.9921466}
confusion matrix:
      0     1
0  1516     0
1    24  1516
---- Validation: 
scalar performance:
{'acc': 0.63928014, 'precision': 0.77167904, 'recall': 0.62975454, 'specificity': 0.62975454, 'f1': 0.5803249, 'auroc': 0.8628288, 'binary_precision': 0.9548023, 'binary_recall': 0.27170417, 'binary_specificity': 0.9878049, 'binary_f1_score': 0.42302877}
confusion matrix:
     0    1
0  648    8
1  453  169
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6226852, 'precision': 0.776055, 'recall': 0.6226852, 'specificity': 0.6226852, 'f1': 0.5618252, 'auroc': 0.90734315, 'binary_precision': 0.9818182, 'binary_recall': 0.25, 'binary_specificity': 0.9953704, 'binary_f1_score': 0.398524}
confusion matrix:
     0   1
0  215   1
1  162  54
early stop counter: 8
val acc:0.6392801403999329, best validation acc: 0.84272301197052, corresponding to test acc:                         0.8333333134651184 / 0.8518518805503845
after epoch: 24,now: 2024-07-20 08:17:44.870303,epoch time: 0:01:26.930449,used: 0:35:08.519973,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_07_42_36_seed_2_22478444
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.99018323, 'precision': 0.9901761, 'recall': 0.9901929, 'specificity': 0.9901929, 'f1': 0.99018276, 'auroc': 0.99943554, 'binary_precision': 0.99153644, 'binary_recall': 0.98896104, 'binary_specificity': 0.9914248, 'binary_f1_score': 0.990247}
confusion matrix:
      0     1
0  1503    13
1    17  1523
---- Validation: 
scalar performance:
{'acc': 0.8231612, 'precision': 0.8340916, 'recall': 0.8207028, 'specificity': 0.8207028, 'f1': 0.8208227, 'auroc': 0.8888788, 'binary_precision': 0.8882353, 'binary_recall': 0.7282958, 'binary_specificity': 0.9131098, 'binary_f1_score': 0.80035335}
confusion matrix:
     0    1
0  599   57
1  169  453
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6898148, 'precision': 0.70349264, 'recall': 0.6898148, 'specificity': 0.6898148, 'f1': 0.68451345, 'auroc': 0.7956319, 'binary_precision': 0.75625, 'binary_recall': 0.5601852, 'binary_specificity': 0.8194444, 'binary_f1_score': 0.64361703}
confusion matrix:
     0    1
0  177   39
1   95  121
early stop counter: 9
val acc:0.8231611847877502, best validation acc: 0.84272301197052, corresponding to test acc:                         0.8333333134651184 / 0.8518518805503845
after epoch: 25,now: 2024-07-20 08:19:11.257404,epoch time: 0:01:26.387101,used: 0:36:34.907074,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_07_42_36_seed_2_22478444
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.98854715, 'precision': 0.9886513, 'recall': 0.988621, 'specificity': 0.988621, 'f1': 0.9885471, 'auroc': 0.99979955, 'binary_precision': 0.99801457, 'binary_recall': 0.9792208, 'binary_specificity': 0.9980211, 'binary_f1_score': 0.9885284}
confusion matrix:
      0     1
0  1513     3
1    32  1508
---- Validation: 
scalar performance:
{'acc': 0.71518, 'precision': 0.7883712, 'recall': 0.7083121, 'specificity': 0.7083121, 'f1': 0.6915106, 'auroc': 0.8809867, 'binary_precision': 0.92715234, 'binary_recall': 0.45016077, 'binary_specificity': 0.9664634, 'binary_f1_score': 0.60606056}
confusion matrix:
     0    1
0  634   22
1  342  280
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6689815, 'precision': 0.7116681, 'recall': 0.6689815, 'specificity': 0.6689815, 'f1': 0.6514065, 'auroc': 0.813486, 'binary_precision': 0.8067227, 'binary_recall': 0.44444445, 'binary_specificity': 0.8935185, 'binary_f1_score': 0.5731343}
confusion matrix:
     0   1
0  193  23
1  120  96
early stop counter: 10
val acc:0.715179979801178, best validation acc: 0.84272301197052, corresponding to test acc:                         0.8333333134651184 / 0.8518518805503845
after epoch: 26,now: 2024-07-20 08:20:37.258820,epoch time: 0:01:26.001416,used: 0:38:00.908490,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_07_42_36_seed_2_22478444
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.9856021, 'precision': 0.9858664, 'recall': 0.98570913, 'specificity': 0.98570913, 'f1': 0.9856016, 'auroc': 0.9990902, 'binary_precision': 0.9993324, 'binary_recall': 0.9720779, 'binary_specificity': 0.99934036, 'binary_f1_score': 0.98551685}
confusion matrix:
      0     1
0  1515     1
1    43  1497
---- Validation: 
scalar performance:
{'acc': 0.74726135, 'precision': 0.81859696, 'recall': 0.74085367, 'specificity': 0.74085367, 'f1': 0.7288523, 'auroc': 0.90142685, 'binary_precision': 0.9628483, 'binary_recall': 0.5, 'binary_specificity': 0.98170733, 'binary_f1_score': 0.65820104}
confusion matrix:
     0    1
0  644   12
1  311  311
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7199074, 'precision': 0.82047474, 'recall': 0.7199074, 'specificity': 0.7199074, 'f1': 0.696063, 'auroc': 0.9048568, 'binary_precision': 1.0, 'binary_recall': 0.4398148, 'binary_specificity': 1.0, 'binary_f1_score': 0.61093247}
confusion matrix:
     0   1
0  216   0
1  121  95
early stop counter: 11
val acc:0.7472613453865051, best validation acc: 0.84272301197052, corresponding to test acc:                         0.8333333134651184 / 0.8518518805503845
after epoch: 27,now: 2024-07-20 08:22:04.177823,epoch time: 0:01:26.919003,used: 0:39:27.827493,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_07_42_36_seed_2_22478444
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.9911649, 'precision': 0.9911591, 'recall': 0.9911875, 'specificity': 0.9911875, 'f1': 0.99116474, 'auroc': 0.9996064, 'binary_precision': 0.9941215, 'binary_recall': 0.9883117, 'binary_specificity': 0.9940633, 'binary_f1_score': 0.9912081}
confusion matrix:
      0     1
0  1507     9
1    18  1522
---- Validation: 
scalar performance:
{'acc': 0.80672926, 'precision': 0.84278077, 'recall': 0.8023635, 'specificity': 0.8023635, 'f1': 0.7998459, 'auroc': 0.9069412, 'binary_precision': 0.94749403, 'binary_recall': 0.63826364, 'binary_specificity': 0.9664634, 'binary_f1_score': 0.7627281}
confusion matrix:
     0    1
0  634   22
1  225  397
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7615741, 'precision': 0.82765055, 'recall': 0.76157403, 'specificity': 0.76157403, 'f1': 0.74891514, 'auroc': 0.91966736, 'binary_precision': 0.9747899, 'binary_recall': 0.537037, 'binary_specificity': 0.9861111, 'binary_f1_score': 0.6925373}
confusion matrix:
     0    1
0  213    3
1  100  116
early stop counter: 12
val acc:0.806729257106781, best validation acc: 0.84272301197052, corresponding to test acc:                         0.8333333134651184 / 0.8518518805503845
after epoch: 28,now: 2024-07-20 08:23:31.696260,epoch time: 0:01:27.518437,used: 0:40:55.345930,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_07_42_36_seed_2_22478444
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.997055, 'precision': 0.9970491, 'recall': 0.9970625, 'specificity': 0.9970625, 'f1': 0.9970548, 'auroc': 0.9998882, 'binary_precision': 0.9980481, 'binary_recall': 0.9961039, 'binary_specificity': 0.9980211, 'binary_f1_score': 0.9970751}
confusion matrix:
      0     1
0  1513     3
1     6  1534
---- Validation: 
scalar performance:
{'acc': 0.80203444, 'precision': 0.84065783, 'recall': 0.7974987, 'specificity': 0.7974987, 'f1': 0.7944814, 'auroc': 0.905655, 'binary_precision': 0.9489051, 'binary_recall': 0.62700963, 'binary_specificity': 0.9679878, 'binary_f1_score': 0.7550823}
confusion matrix:
     0    1
0  635   21
1  232  390
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6990741, 'precision': 0.80175436, 'recall': 0.69907403, 'specificity': 0.69907403, 'f1': 0.6710942, 'auroc': 0.89881265, 'binary_precision': 0.9777778, 'binary_recall': 0.4074074, 'binary_specificity': 0.9907407, 'binary_f1_score': 0.57516336}
confusion matrix:
     0   1
0  214   2
1  128  88
early stop counter: 13
val acc:0.8020344376564026, best validation acc: 0.84272301197052, corresponding to test acc:                         0.8333333134651184 / 0.8518518805503845
after epoch: 29,now: 2024-07-20 08:24:57.853029,epoch time: 0:01:26.156769,used: 0:42:21.502699,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_07_42_36_seed_2_22478444
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.99345547, 'precision': 0.9934485, 'recall': 0.99346536, 'specificity': 0.99346536, 'f1': 0.9934552, 'auroc': 0.9998642, 'binary_precision': 0.9947917, 'binary_recall': 0.99220777, 'binary_specificity': 0.99472296, 'binary_f1_score': 0.993498}
confusion matrix:
      0     1
0  1508     8
1    12  1528
---- Validation: 
scalar performance:
{'acc': 0.7300469, 'precision': 0.8043474, 'recall': 0.72333544, 'specificity': 0.72333544, 'f1': 0.70856154, 'auroc': 0.8910551, 'binary_precision': 0.9482201, 'binary_recall': 0.47106108, 'binary_specificity': 0.9756098, 'binary_f1_score': 0.6294307}
confusion matrix:
     0    1
0  640   16
1  329  293
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7361111, 'precision': 0.8073661, 'recall': 0.7361111, 'specificity': 0.7361111, 'f1': 0.71987617, 'auroc': 0.90577847, 'binary_precision': 0.95535713, 'binary_recall': 0.49537036, 'binary_specificity': 0.9768519, 'binary_f1_score': 0.652439}
confusion matrix:
     0    1
0  211    5
1  109  107
early stop counter: 14
val acc:0.7300469279289246, best validation acc: 0.84272301197052, corresponding to test acc:                         0.8333333134651184 / 0.8518518805503845
after epoch: 30,now: 2024-07-20 08:26:24.772611,epoch time: 0:01:26.919582,used: 0:43:48.422281,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_07_42_36_seed_2_22478444
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 0:43:48.422281 at 2024-07-20 08:26:24.772611
persisted model performance metric: 

scalar performance:
{'acc': 0.8333333, 'precision': 0.8343653, 'recall': 0.8333334, 'specificity': 0.8333334, 'f1': 0.8332046, 'auroc': 0.906893, 'binary_precision': 0.81578946, 'binary_recall': 0.8611111, 'binary_specificity': 0.8055556, 'binary_f1_score': 0.8378378}
confusion matrix:
     0    1
0  174   42
1   30  186
oracle model performance metric: 

scalar performance:
{'acc': 0.8518519, 'precision': 0.85294116, 'recall': 0.8518518, 'specificity': 0.8518518, 'f1': 0.8517375, 'auroc': 0.91870284, 'binary_precision': 0.872549, 'binary_recall': 0.8240741, 'binary_specificity': 0.8796296, 'binary_f1_score': 0.84761906}
confusion matrix:
     0    1
0  190   26
1   38  178
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_nofreeze_2024-07-19_18-41-07/rule_results/4.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_nofreeze_2024-07-19_18-41-07/confusion_matrix/4.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 455396 KiB |  13219 MiB | 223317 GiB | 223317 GiB |
|       from large pool | 414803 KiB |  13181 MiB | 220652 GiB | 220652 GiB |
|       from small pool |  40592 KiB |     60 MiB |   2665 GiB |   2665 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 455396 KiB |  13219 MiB | 223317 GiB | 223317 GiB |
|       from large pool | 414803 KiB |  13181 MiB | 220652 GiB | 220652 GiB |
|       from small pool |  40592 KiB |     60 MiB |   2665 GiB |   2665 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 447481 KiB |  13213 MiB | 222696 GiB | 222695 GiB |
|       from large pool | 407075 KiB |  13175 MiB | 220036 GiB | 220035 GiB |
|       from small pool |  40406 KiB |     60 MiB |   2659 GiB |   2659 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  14478 MiB |  14482 MiB |  41646 MiB |  27168 MiB |
|       from large pool |  14412 MiB |  14412 MiB |  41542 MiB |  27130 MiB |
|       from small pool |     66 MiB |     70 MiB |    104 MiB |     38 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 445724 KiB |   1238 MiB | 156876 GiB | 156875 GiB |
|       from large pool | 435116 KiB |   1229 MiB | 154195 GiB | 154194 GiB |
|       from small pool |  10607 KiB |     44 MiB |   2681 GiB |   2681 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    1298    |    2598    |   39285 K  |   39283 K  |
|       from large pool |     187    |    1413    |   20061 K  |   20061 K  |
|       from small pool |    1111    |    1419    |   19223 K  |   19222 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    1298    |    2598    |   39285 K  |   39283 K  |
|       from large pool |     187    |    1413    |   20061 K  |   20061 K  |
|       from small pool |    1111    |    1419    |   19223 K  |   19222 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     635    |     637    |    1782    |    1147    |
|       from large pool |     602    |     602    |    1730    |    1128    |
|       from small pool |      33    |      35    |      52    |      19    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      96    |     650    |   27108 K  |   27108 K  |
|       from large pool |      38    |     605    |   15639 K  |   15639 K  |
|       from small pool |      58    |     236    |   11469 K  |   11469 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13219 MiB | 223317 GiB | 223317 GiB |
|       from large pool |  16640 KiB |  13181 MiB | 220652 GiB | 220652 GiB |
|       from small pool |      0 KiB |     60 MiB |   2665 GiB |   2665 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13219 MiB | 223317 GiB | 223317 GiB |
|       from large pool |  16640 KiB |  13181 MiB | 220652 GiB | 220652 GiB |
|       from small pool |      0 KiB |     60 MiB |   2665 GiB |   2665 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13213 MiB | 222696 GiB | 222696 GiB |
|       from large pool |  16640 KiB |  13175 MiB | 220036 GiB | 220036 GiB |
|       from small pool |      0 KiB |     60 MiB |   2659 GiB |   2659 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    880 MiB |  14482 MiB |  41646 MiB |  40766 MiB |
|       from large pool |    830 MiB |  14412 MiB |  41542 MiB |  40712 MiB |
|       from small pool |     50 MiB |     70 MiB |    104 MiB |     54 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1238 MiB | 156876 GiB | 156876 GiB |
|       from large pool |  24320 KiB |   1229 MiB | 154195 GiB | 154195 GiB |
|       from small pool |      0 KiB |     44 MiB |   2681 GiB |   2681 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    2598    |   39285 K  |   39285 K  |
|       from large pool |       2    |    1413    |   20061 K  |   20061 K  |
|       from small pool |       0    |    1419    |   19223 K  |   19223 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    2598    |   39285 K  |   39285 K  |
|       from large pool |       2    |    1413    |   20061 K  |   20061 K  |
|       from small pool |       0    |    1419    |   19223 K  |   19223 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      62    |     637    |    1782    |    1720    |
|       from large pool |      37    |     602    |    1730    |    1693    |
|       from small pool |      25    |      35    |      52    |      27    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |     650    |   27109 K  |   27109 K  |
|       from large pool |       4    |     605    |   15639 K  |   15639 K  |
|       from small pool |       0    |     236    |   11469 K  |   11469 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Sat Jul 20 08:27:11 2024]
Finished job 0.
1 of 1 steps (100%) done
