Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Sat Jul 20 08:28:39 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_nofreeze_2024-07-19_18-41-07/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_nofreeze_2024-07-19_18-41-07/rule_results/6.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=6
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/swiglu_ffn.py:51: UserWarning: xFormers is not available (SwiGLU)
  warnings.warn("xFormers is not available (SwiGLU)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/attention.py:33: UserWarning: xFormers is not available (Attention)
  warnings.warn("xFormers is not available (Attention)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/block.py:40: UserWarning: xFormers is not available (Block)
  warnings.warn("xFormers is not available (Block)")
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'888c1ef2'
model name: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_08_33_20_seed_0_22478445

 Experiment start at: 2024-07-20 08:33:20.999616
before training, model accuracy: 0.569767415523529
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.97526044, 'precision': 0.9755817, 'recall': 0.97549784, 'specificity': 0.97549784, 'f1': 0.97526026, 'auroc': 0.99781835, 'binary_precision': 0.9920319, 'binary_recall': 0.9589217, 'binary_specificity': 0.99207395, 'binary_f1_score': 0.9751958}
confusion matrix:
      0     1
0  1502    12
1    64  1494
---- Validation: 
scalar performance:
{'acc': 0.753882, 'precision': 0.8008304, 'recall': 0.75108826, 'specificity': 0.75108826, 'f1': 0.7424817, 'auroc': 0.8754194, 'binary_precision': 0.9162304, 'binary_recall': 0.5511811, 'binary_specificity': 0.9509954, 'binary_f1_score': 0.68829894}
confusion matrix:
     0    1
0  621   32
1  285  350
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.81860465, 'precision': 0.85884845, 'recall': 0.81860465, 'specificity': 0.81860465, 'f1': 0.81337225, 'auroc': 0.9250838, 'binary_precision': 0.97902095, 'binary_recall': 0.6511628, 'binary_specificity': 0.9860465, 'binary_f1_score': 0.7821229}
confusion matrix:
     0    1
0  212    3
1   75  140
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-20 08:37:05.536032,epoch time: 0:03:44.536416,used: 0:03:44.536416,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_08_33_20_seed_0_22478445
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9664714, 'precision': 0.9667929, 'recall': 0.96668184, 'specificity': 0.96668184, 'f1': 0.96647096, 'auroc': 0.9963682, 'binary_precision': 0.98272425, 'binary_recall': 0.95051414, 'binary_specificity': 0.9828496, 'binary_f1_score': 0.96635085}
confusion matrix:
      0     1
0  1490    26
1    77  1479
---- Validation: 
scalar performance:
{'acc': 0.7127329, 'precision': 0.79178154, 'recall': 0.7090521, 'specificity': 0.7090521, 'f1': 0.6895455, 'auroc': 0.8889655, 'binary_precision': 0.9401993, 'binary_recall': 0.4456693, 'binary_specificity': 0.97243494, 'binary_f1_score': 0.60470086}
confusion matrix:
     0    1
0  635   18
1  352  283
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.80930233, 'precision': 0.8590082, 'recall': 0.80930233, 'specificity': 0.80930233, 'f1': 0.80246496, 'auroc': 0.92250943, 'binary_precision': 0.9925926, 'binary_recall': 0.6232558, 'binary_specificity': 0.9953488, 'binary_f1_score': 0.7657143}
confusion matrix:
     0    1
0  214    1
1   81  134
early stop counter: 1
val acc:0.7127329111099243, best validation acc: 0.7538819909095764, corresponding to test acc:                         0.8186046481132507 / 0.8186046481132507
after epoch: 2,now: 2024-07-20 08:39:58.434666,epoch time: 0:02:52.898634,used: 0:06:37.435050,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_08_33_20_seed_0_22478445
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9794922, 'precision': 0.97991604, 'recall': 0.97974205, 'specificity': 0.97974205, 'f1': 0.9794917, 'auroc': 0.99851406, 'binary_precision': 0.998, 'binary_recall': 0.96146435, 'binary_specificity': 0.9980198, 'binary_f1_score': 0.9793916}
confusion matrix:
      0     1
0  1512     3
1    60  1497
---- Validation: 
scalar performance:
{'acc': 0.6537267, 'precision': 0.7623014, 'recall': 0.64916617, 'specificity': 0.64916617, 'f1': 0.6098348, 'auroc': 0.88074183, 'binary_precision': 0.9276018, 'binary_recall': 0.32283464, 'binary_specificity': 0.9754977, 'binary_f1_score': 0.47897196}
confusion matrix:
     0    1
0  637   16
1  430  205
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7255814, 'precision': 0.80959594, 'recall': 0.7255814, 'specificity': 0.7255814, 'f1': 0.7056093, 'auroc': 0.90660894, 'binary_precision': 0.9708738, 'binary_recall': 0.4651163, 'binary_specificity': 0.9860465, 'binary_f1_score': 0.6289308}
confusion matrix:
     0    1
0  212    3
1  115  100
early stop counter: 2
val acc:0.6537266969680786, best validation acc: 0.7538819909095764, corresponding to test acc:                         0.8186046481132507 / 0.8186046481132507
after epoch: 3,now: 2024-07-20 08:42:52.829478,epoch time: 0:02:54.394812,used: 0:09:31.829862,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_08_33_20_seed_0_22478445
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9794922, 'precision': 0.97990453, 'recall': 0.9797538, 'specificity': 0.9797538, 'f1': 0.97949183, 'auroc': 0.9981903, 'binary_precision': 0.99800134, 'binary_recall': 0.9614891, 'binary_specificity': 0.9980185, 'binary_f1_score': 0.979405}
confusion matrix:
      0     1
0  1511     3
1    60  1498
---- Validation: 
scalar performance:
{'acc': 0.6661491, 'precision': 0.7764431, 'recall': 0.6616778, 'specificity': 0.6616778, 'f1': 0.6255733, 'auroc': 0.9200926, 'binary_precision': 0.9475983, 'binary_recall': 0.3417323, 'binary_specificity': 0.9816233, 'binary_f1_score': 0.5023148}
confusion matrix:
     0    1
0  641   12
1  418  217
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.59534883, 'precision': 0.7763496, 'recall': 0.59534883, 'specificity': 0.59534883, 'f1': 0.5161165, 'auroc': 0.92975664, 'binary_precision': 1.0, 'binary_recall': 0.19069767, 'binary_specificity': 1.0, 'binary_f1_score': 0.3203125}
confusion matrix:
     0   1
0  215   0
1  174  41
early stop counter: 3
val acc:0.6661490797996521, best validation acc: 0.7538819909095764, corresponding to test acc:                         0.8186046481132507 / 0.8186046481132507
after epoch: 4,now: 2024-07-20 08:45:46.287363,epoch time: 0:02:53.457885,used: 0:12:25.287747,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_08_33_20_seed_0_22478445
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.984375, 'precision': 0.9844746, 'recall': 0.9845165, 'specificity': 0.9845165, 'f1': 0.984375, 'auroc': 0.99928355, 'binary_precision': 0.9954008, 'binary_recall': 0.9736504, 'binary_specificity': 0.9953826, 'binary_f1_score': 0.98440546}
confusion matrix:
      0     1
0  1509     7
1    41  1515
---- Validation: 
scalar performance:
{'acc': 0.6506211, 'precision': 0.7305013, 'recall': 0.64642894, 'specificity': 0.64642894, 'f1': 0.613739, 'auroc': 0.87857676, 'binary_precision': 0.8627451, 'binary_recall': 0.3464567, 'binary_specificity': 0.94640124, 'binary_f1_score': 0.49438202}
confusion matrix:
     0    1
0  618   35
1  415  220
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6488372, 'precision': 0.77301586, 'recall': 0.6488372, 'specificity': 0.6488372, 'f1': 0.60378337, 'auroc': 0.9224013, 'binary_precision': 0.95714283, 'binary_recall': 0.3116279, 'binary_specificity': 0.9860465, 'binary_f1_score': 0.47017542}
confusion matrix:
     0   1
0  212   3
1  148  67
early stop counter: 4
val acc:0.6506211161613464, best validation acc: 0.7538819909095764, corresponding to test acc:                         0.8186046481132507 / 0.8186046481132507
after epoch: 5,now: 2024-07-20 08:48:39.790955,epoch time: 0:02:53.503592,used: 0:15:18.791339,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_08_33_20_seed_0_22478445
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9847005, 'precision': 0.9847553, 'recall': 0.98482084, 'specificity': 0.98482084, 'f1': 0.9847003, 'auroc': 0.99883926, 'binary_precision': 0.9941061, 'binary_recall': 0.9755784, 'binary_specificity': 0.9940633, 'binary_f1_score': 0.9847551}
confusion matrix:
      0     1
0  1507     9
1    38  1518
---- Validation: 
scalar performance:
{'acc': 0.8159938, 'precision': 0.82268935, 'recall': 0.81497025, 'specificity': 0.81497025, 'f1': 0.8146665, 'auroc': 0.8845185, 'binary_precision': 0.86580884, 'binary_recall': 0.7417323, 'binary_specificity': 0.88820827, 'binary_f1_score': 0.79898226}
confusion matrix:
     0    1
0  580   73
1  164  471
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.82790697, 'precision': 0.8451083, 'recall': 0.82790697, 'specificity': 0.82790697, 'f1': 0.8257355, 'auroc': 0.88417524, 'binary_precision': 0.9221557, 'binary_recall': 0.7162791, 'binary_specificity': 0.9395349, 'binary_f1_score': 0.80628276}
confusion matrix:
     0    1
0  202   13
1   61  154
new oracle model saved
better model found
persisted
after epoch: 6,now: 2024-07-20 08:51:34.821583,epoch time: 0:02:55.030628,used: 0:18:13.821967,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_08_33_20_seed_0_22478445
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.98828125, 'precision': 0.98831415, 'recall': 0.9883895, 'specificity': 0.9883895, 'f1': 0.988281, 'auroc': 0.99944085, 'binary_precision': 0.996732, 'binary_recall': 0.98007715, 'binary_specificity': 0.99670184, 'binary_f1_score': 0.9883344}
confusion matrix:
      0     1
0  1511     5
1    31  1525
---- Validation: 
scalar performance:
{'acc': 0.76397514, 'precision': 0.82661414, 'recall': 0.76089036, 'specificity': 0.76089036, 'f1': 0.7506261, 'auroc': 0.9349755, 'binary_precision': 0.9661972, 'binary_recall': 0.5401575, 'binary_specificity': 0.9816233, 'binary_f1_score': 0.6929293}
confusion matrix:
     0    1
0  641   12
1  292  343
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7767442, 'precision': 0.84565914, 'recall': 0.7767442, 'specificity': 0.7767442, 'f1': 0.76503265, 'auroc': 0.93590045, 'binary_precision': 1.0, 'binary_recall': 0.5534884, 'binary_specificity': 1.0, 'binary_f1_score': 0.71257484}
confusion matrix:
     0    1
0  215    0
1   96  119
early stop counter: 1
val acc:0.7639751434326172, best validation acc: 0.8159937858581543, corresponding to test acc:                         0.8279069662094116 / 0.8279069662094116
after epoch: 7,now: 2024-07-20 08:54:28.381155,epoch time: 0:02:53.559572,used: 0:21:07.381539,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_08_33_20_seed_0_22478445
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9866536, 'precision': 0.9866581, 'recall': 0.9867404, 'specificity': 0.9867404, 'f1': 0.98665315, 'auroc': 0.99937046, 'binary_precision': 0.99348533, 'binary_recall': 0.98007715, 'binary_specificity': 0.9934037, 'binary_f1_score': 0.9867357}
confusion matrix:
      0     1
0  1506    10
1    31  1525
---- Validation: 
scalar performance:
{'acc': 0.82841617, 'precision': 0.84132373, 'recall': 0.82704777, 'specificity': 0.82704777, 'f1': 0.8263349, 'auroc': 0.91935706, 'binary_precision': 0.9042969, 'binary_recall': 0.72913384, 'binary_specificity': 0.9249617, 'binary_f1_score': 0.8073234}
confusion matrix:
     0    1
0  604   49
1  172  463
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.84418607, 'precision': 0.8788096, 'recall': 0.84418607, 'specificity': 0.84418607, 'f1': 0.84054244, 'auroc': 0.9515414, 'binary_precision': 0.99333334, 'binary_recall': 0.69302326, 'binary_specificity': 0.9953488, 'binary_f1_score': 0.81643844}
confusion matrix:
     0    1
0  214    1
1   66  149
new oracle model saved
better model found
persisted
after epoch: 8,now: 2024-07-20 08:57:22.812158,epoch time: 0:02:54.431003,used: 0:24:01.812542,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_08_33_20_seed_0_22478445
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9791667, 'precision': 0.97935826, 'recall': 0.9793412, 'specificity': 0.9793412, 'f1': 0.9791667, 'auroc': 0.9988605, 'binary_precision': 0.9927345, 'binary_recall': 0.9659383, 'binary_specificity': 0.9927441, 'binary_f1_score': 0.97915316}
confusion matrix:
      0     1
0  1505    11
1    53  1503
---- Validation: 
scalar performance:
{'acc': 0.8385093, 'precision': 0.8539464, 'recall': 0.83704525, 'specificity': 0.83704525, 'f1': 0.8362889, 'auroc': 0.9228467, 'binary_precision': 0.92445326, 'binary_recall': 0.7322835, 'binary_specificity': 0.94180703, 'binary_f1_score': 0.8172232}
confusion matrix:
     0    1
0  615   38
1  170  465
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.83488375, 'precision': 0.87587416, 'recall': 0.8348837, 'specificity': 0.8348837, 'f1': 0.8302559, 'auroc': 0.9433856, 'binary_precision': 1.0, 'binary_recall': 0.66976744, 'binary_specificity': 1.0, 'binary_f1_score': 0.80222845}
confusion matrix:
     0    1
0  215    0
1   71  144
better model found
persisted
after epoch: 9,now: 2024-07-20 09:00:18.701288,epoch time: 0:02:55.889130,used: 0:26:57.701672,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_08_33_20_seed_0_22478445
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9921875, 'precision': 0.99217033, 'recall': 0.9922246, 'specificity': 0.9922246, 'f1': 0.9921869, 'auroc': 0.9995189, 'binary_precision': 0.9954663, 'binary_recall': 0.98906046, 'binary_specificity': 0.9953887, 'binary_f1_score': 0.992253}
confusion matrix:
      0     1
0  1511     7
1    17  1537
---- Validation: 
scalar performance:
{'acc': 0.71506214, 'precision': 0.76315856, 'recall': 0.71202207, 'specificity': 0.71202207, 'f1': 0.6995121, 'auroc': 0.8737143, 'binary_precision': 0.87222224, 'binary_recall': 0.49448818, 'binary_specificity': 0.9295559, 'binary_f1_score': 0.6311558}
confusion matrix:
     0    1
0  607   46
1  321  314
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7651163, 'precision': 0.80184734, 'recall': 0.7651163, 'specificity': 0.7651163, 'f1': 0.75774646, 'auroc': 0.88778794, 'binary_precision': 0.9071429, 'binary_recall': 0.59069765, 'binary_specificity': 0.9395349, 'binary_f1_score': 0.71549296}
confusion matrix:
     0    1
0  202   13
1   88  127
early stop counter: 1
val acc:0.715062141418457, best validation acc: 0.8385093212127686, corresponding to test acc:                         0.8348837494850159 / 0.8441860675811768
after epoch: 10,now: 2024-07-20 09:03:15.829921,epoch time: 0:02:57.128633,used: 0:29:54.830305,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_08_33_20_seed_0_22478445
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9869792, 'precision': 0.9869652, 'recall': 0.9869933, 'specificity': 0.9869933, 'f1': 0.9869776, 'auroc': 0.9992344, 'binary_precision': 0.98839456, 'binary_recall': 0.98585206, 'binary_specificity': 0.9881345, 'binary_f1_score': 0.9871217}
confusion matrix:
      0     1
0  1499    18
1    22  1533
---- Validation: 
scalar performance:
{'acc': 0.882764, 'precision': 0.88733375, 'recall': 0.8820139, 'specificity': 0.8820139, 'f1': 0.88225114, 'auroc': 0.9427959, 'binary_precision': 0.9260563, 'binary_recall': 0.82834643, 'binary_specificity': 0.93568146, 'binary_f1_score': 0.8744804}
confusion matrix:
     0    1
0  611   42
1  109  526
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8488372, 'precision': 0.88160264, 'recall': 0.8488372, 'specificity': 0.8488372, 'f1': 0.8455212, 'auroc': 0.92912924, 'binary_precision': 0.9934211, 'binary_recall': 0.7023256, 'binary_specificity': 0.9953488, 'binary_f1_score': 0.82288826}
confusion matrix:
     0    1
0  214    1
1   64  151
new oracle model saved
better model found
persisted
after epoch: 11,now: 2024-07-20 09:06:11.271655,epoch time: 0:02:55.441734,used: 0:32:50.272039,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_08_33_20_seed_0_22478445
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.98795575, 'precision': 0.9880799, 'recall': 0.9881182, 'specificity': 0.9881182, 'f1': 0.9879557, 'auroc': 0.99972016, 'binary_precision': 1.0, 'binary_recall': 0.97623634, 'binary_specificity': 1.0, 'binary_f1_score': 0.9879753}
confusion matrix:
      0     1
0  1515     0
1    37  1520
---- Validation: 
scalar performance:
{'acc': 0.6552795, 'precision': 0.7768934, 'recall': 0.65058905, 'specificity': 0.65058905, 'f1': 0.6087913, 'auroc': 0.9334369, 'binary_precision': 0.9569378, 'binary_recall': 0.31496063, 'binary_specificity': 0.98621744, 'binary_f1_score': 0.47393367}
confusion matrix:
     0    1
0  644    9
1  435  200
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5488372, 'precision': 0.7628362, 'recall': 0.5488372, 'specificity': 0.5488372, 'f1': 0.43353432, 'auroc': 0.92387235, 'binary_precision': 1.0, 'binary_recall': 0.09767442, 'binary_specificity': 1.0, 'binary_f1_score': 0.17796612}
confusion matrix:
     0   1
0  215   0
1  194  21
early stop counter: 1
val acc:0.6552795171737671, best validation acc: 0.8827639818191528, corresponding to test acc:                         0.8488371968269348 / 0.8488371968269348
after epoch: 12,now: 2024-07-20 09:09:05.472156,epoch time: 0:02:54.200501,used: 0:35:44.472540,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_08_33_20_seed_0_22478445
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9921875, 'precision': 0.99217474, 'recall': 0.9922832, 'specificity': 0.9922832, 'f1': 0.9921869, 'auroc': 0.99984396, 'binary_precision': 0.99870044, 'binary_recall': 0.98588836, 'binary_specificity': 0.99867815, 'binary_f1_score': 0.992253}
confusion matrix:
      0     1
0  1511     2
1    22  1537
---- Validation: 
scalar performance:
{'acc': 0.8206522, 'precision': 0.8450837, 'recall': 0.81878304, 'specificity': 0.81878304, 'f1': 0.8167903, 'auroc': 0.92635804, 'binary_precision': 0.9334764, 'binary_recall': 0.68503934, 'binary_specificity': 0.9525268, 'binary_f1_score': 0.79019076}
confusion matrix:
     0    1
0  622   31
1  200  435
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.86744183, 'precision': 0.88934994, 'recall': 0.8674419, 'specificity': 0.8674419, 'f1': 0.8655505, 'auroc': 0.92789614, 'binary_precision': 0.98170733, 'binary_recall': 0.74883723, 'binary_specificity': 0.9860465, 'binary_f1_score': 0.84960425}
confusion matrix:
     0    1
0  212    3
1   54  161
new oracle model saved
early stop counter: 2
val acc:0.820652186870575, best validation acc: 0.8827639818191528, corresponding to test acc:                         0.8488371968269348 / 0.8674418330192566
after epoch: 13,now: 2024-07-20 09:11:59.811107,epoch time: 0:02:54.338951,used: 0:38:38.811491,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_08_33_20_seed_0_22478445
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9899089, 'precision': 0.9898896, 'recall': 0.9899737, 'specificity': 0.9899737, 'f1': 0.9899081, 'auroc': 0.99945986, 'binary_precision': 0.99481195, 'binary_recall': 0.985228, 'binary_specificity': 0.99471945, 'binary_f1_score': 0.9899968}
confusion matrix:
      0     1
0  1507     8
1    23  1534
---- Validation: 
scalar performance:
{'acc': 0.6832298, 'precision': 0.7654573, 'recall': 0.6792828, 'specificity': 0.6792828, 'f1': 0.65371966, 'auroc': 0.8823848, 'binary_precision': 0.9097473, 'binary_recall': 0.3968504, 'binary_specificity': 0.96171516, 'binary_f1_score': 0.5526316}
confusion matrix:
     0    1
0  628   25
1  383  252
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7093023, 'precision': 0.7931818, 'recall': 0.7093023, 'specificity': 0.7093023, 'f1': 0.68690836, 'auroc': 0.89856136, 'binary_precision': 0.95, 'binary_recall': 0.44186047, 'binary_specificity': 0.9767442, 'binary_f1_score': 0.60317457}
confusion matrix:
     0   1
0  210   5
1  120  95
early stop counter: 3
val acc:0.6832298040390015, best validation acc: 0.8827639818191528, corresponding to test acc:                         0.8488371968269348 / 0.8674418330192566
after epoch: 14,now: 2024-07-20 09:14:54.137296,epoch time: 0:02:54.326189,used: 0:41:33.137680,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_08_33_20_seed_0_22478445
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.99283856, 'precision': 0.99283856, 'recall': 0.9929062, 'specificity': 0.9929062, 'f1': 0.9928383, 'auroc': 0.9997096, 'binary_precision': 0.99869794, 'binary_recall': 0.98713, 'binary_specificity': 0.9986825, 'binary_f1_score': 0.9928803}
confusion matrix:
      0     1
0  1516     2
1    20  1534
---- Validation: 
scalar performance:
{'acc': 0.6529503, 'precision': 0.76563364, 'recall': 0.64833534, 'specificity': 0.64833534, 'f1': 0.60780257, 'auroc': 0.91904354, 'binary_precision': 0.9351852, 'binary_recall': 0.31811023, 'binary_specificity': 0.9785605, 'binary_f1_score': 0.4747356}
confusion matrix:
     0    1
0  639   14
1  433  202
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6255814, 'precision': 0.7690489, 'recall': 0.6255814, 'specificity': 0.6255814, 'f1': 0.5679902, 'auroc': 0.8912277, 'binary_precision': 0.9655172, 'binary_recall': 0.26046512, 'binary_specificity': 0.9906977, 'binary_f1_score': 0.41025642}
confusion matrix:
     0   1
0  213   2
1  159  56
early stop counter: 4
val acc:0.6529502868652344, best validation acc: 0.8827639818191528, corresponding to test acc:                         0.8488371968269348 / 0.8674418330192566
after epoch: 15,now: 2024-07-20 09:17:48.561088,epoch time: 0:02:54.423792,used: 0:44:27.561472,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_08_33_20_seed_0_22478445
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.99283856, 'precision': 0.9928432, 'recall': 0.9929351, 'specificity': 0.9929351, 'f1': 0.99283826, 'auroc': 0.99992067, 'binary_precision': 1.0, 'binary_recall': 0.98587024, 'binary_specificity': 1.0, 'binary_f1_score': 0.9928849}
confusion matrix:
      0     1
0  1515     0
1    22  1535
---- Validation: 
scalar performance:
{'acc': 0.7080745, 'precision': 0.7977041, 'recall': 0.70419747, 'specificity': 0.70419747, 'f1': 0.6818173, 'auroc': 0.9301932, 'binary_precision': 0.9575972, 'binary_recall': 0.42677164, 'binary_specificity': 0.9816233, 'binary_f1_score': 0.59041387}
confusion matrix:
     0    1
0  641   12
1  364  271
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.62093025, 'precision': 0.75180185, 'recall': 0.62093025, 'specificity': 0.62093025, 'f1': 0.56432015, 'auroc': 0.901417, 'binary_precision': 0.93333334, 'binary_recall': 0.26046512, 'binary_specificity': 0.98139536, 'binary_f1_score': 0.40727273}
confusion matrix:
     0   1
0  211   4
1  159  56
early stop counter: 5
val acc:0.7080745100975037, best validation acc: 0.8827639818191528, corresponding to test acc:                         0.8488371968269348 / 0.8674418330192566
after epoch: 16,now: 2024-07-20 09:20:43.371619,epoch time: 0:02:54.810531,used: 0:47:22.372003,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_08_33_20_seed_0_22478445
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 16 with time: 0:47:22.372003 at 2024-07-20 09:20:43.371619
persisted model performance metric: 

scalar performance:
{'acc': 0.8488372, 'precision': 0.88160264, 'recall': 0.8488372, 'specificity': 0.8488372, 'f1': 0.8455212, 'auroc': 0.92912924, 'binary_precision': 0.9934211, 'binary_recall': 0.7023256, 'binary_specificity': 0.9953488, 'binary_f1_score': 0.82288826}
confusion matrix:
     0    1
0  214    1
1   64  151
oracle model performance metric: 

scalar performance:
{'acc': 0.86744183, 'precision': 0.88934994, 'recall': 0.8674419, 'specificity': 0.8674419, 'f1': 0.8655505, 'auroc': 0.92789614, 'binary_precision': 0.98170733, 'binary_recall': 0.74883723, 'binary_specificity': 0.9860465, 'binary_f1_score': 0.84960425}
confusion matrix:
     0    1
0  212    3
1   54  161
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_nofreeze_2024-07-19_18-41-07/rule_results/6.csv
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_nofreeze_2024-07-19_18-41-07/rule_results/6.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_nofreeze_2024-07-19_18-41-07/confusion_matrix/6.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 456429 KiB |   6792 MiB |  99949 GiB |  99949 GiB |
|       from large pool | 415837 KiB |   6757 MiB |  98836 GiB |  98835 GiB |
|       from small pool |  40592 KiB |     56 MiB |   1113 GiB |   1113 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 456429 KiB |   6792 MiB |  99949 GiB |  99949 GiB |
|       from large pool | 415837 KiB |   6757 MiB |  98836 GiB |  98835 GiB |
|       from small pool |  40592 KiB |     56 MiB |   1113 GiB |   1113 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 447480 KiB |   6787 MiB |  99897 GiB |  99896 GiB |
|       from large pool | 407075 KiB |   6753 MiB |  98784 GiB |  98784 GiB |
|       from small pool |  40405 KiB |     56 MiB |   1112 GiB |   1112 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   7428 MiB |   7428 MiB |   7428 MiB |      0 B   |
|       from large pool |   7364 MiB |   7364 MiB |   7364 MiB |      0 B   |
|       from small pool |     64 MiB |     64 MiB |     64 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory | 358674 KiB | 680458 KiB |  62677 GiB |  62676 GiB |
|       from large pool | 350115 KiB | 673212 KiB |  61545 GiB |  61545 GiB |
|       from small pool |   8559 KiB |  14124 KiB |   1131 GiB |   1131 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    1298    |    1698    |   14868 K  |   14867 K  |
|       from large pool |     187    |     783    |    9081 K  |    9081 K  |
|       from small pool |    1111    |    1407    |    5786 K  |    5785 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    1298    |    1698    |   14868 K  |   14867 K  |
|       from large pool |     187    |     783    |    9081 K  |    9081 K  |
|       from small pool |    1111    |    1407    |    5786 K  |    5785 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     340    |     340    |     340    |       0    |
|       from large pool |     308    |     308    |     308    |       0    |
|       from small pool |      32    |      32    |      32    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      75    |     353    |    9353 K  |    9353 K  |
|       from large pool |      35    |     304    |    6823 K  |    6823 K  |
|       from small pool |      40    |     221    |    2530 K  |    2530 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   6792 MiB |  99949 GiB |  99949 GiB |
|       from large pool |  16640 KiB |   6757 MiB |  98836 GiB |  98836 GiB |
|       from small pool |      0 KiB |     56 MiB |   1113 GiB |   1113 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   6792 MiB |  99949 GiB |  99949 GiB |
|       from large pool |  16640 KiB |   6757 MiB |  98836 GiB |  98836 GiB |
|       from small pool |      0 KiB |     56 MiB |   1113 GiB |   1113 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   6787 MiB |  99897 GiB |  99897 GiB |
|       from large pool |  16640 KiB |   6753 MiB |  98784 GiB |  98784 GiB |
|       from small pool |      0 KiB |     56 MiB |   1112 GiB |   1112 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    796 MiB |   7428 MiB |   7428 MiB |   6632 MiB |
|       from large pool |    748 MiB |   7364 MiB |   7364 MiB |   6616 MiB |
|       from small pool |     48 MiB |     64 MiB |     64 MiB |     16 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 680458 KiB |  62677 GiB |  62677 GiB |
|       from large pool |  24320 KiB | 673212 KiB |  61546 GiB |  61545 GiB |
|       from small pool |      0 KiB |  25530 KiB |   1131 GiB |   1131 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    1698    |   14868 K  |   14868 K  |
|       from large pool |       2    |     783    |    9081 K  |    9081 K  |
|       from small pool |       0    |    1407    |    5786 K  |    5786 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    1698    |   14868 K  |   14868 K  |
|       from large pool |       2    |     783    |    9081 K  |    9081 K  |
|       from small pool |       0    |    1407    |    5786 K  |    5786 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      59    |     340    |     340    |     281    |
|       from large pool |      35    |     308    |     308    |     273    |
|       from small pool |      24    |      32    |      32    |       8    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     353    |    9353 K  |    9353 K  |
|       from large pool |       3    |     304    |    6823 K  |    6823 K  |
|       from small pool |       0    |     221    |    2530 K  |    2530 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   6792 MiB |  99949 GiB |  99949 GiB |
|       from large pool |  16640 KiB |   6757 MiB |  98836 GiB |  98836 GiB |
|       from small pool |      0 KiB |     56 MiB |   1113 GiB |   1113 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   6792 MiB |  99949 GiB |  99949 GiB |
|       from large pool |  16640 KiB |   6757 MiB |  98836 GiB |  98836 GiB |
|       from small pool |      0 KiB |     56 MiB |   1113 GiB |   1113 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   6787 MiB |  99897 GiB |  99897 GiB |
|       from large pool |  16640 KiB |   6753 MiB |  98784 GiB |  98784 GiB |
|       from small pool |      0 KiB |     56 MiB |   1112 GiB |   1112 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    796 MiB |   7428 MiB |   7428 MiB |   6632 MiB |
|       from large pool |    748 MiB |   7364 MiB |   7364 MiB |   6616 MiB |
|       from small pool |     48 MiB |     64 MiB |     64 MiB |     16 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 680458 KiB |  62677 GiB |  62677 GiB |
|       from large pool |  24320 KiB | 673212 KiB |  61546 GiB |  61545 GiB |
|       from small pool |      0 KiB |  25530 KiB |   1131 GiB |   1131 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    1698    |   14868 K  |   14868 K  |
|       from large pool |       2    |     783    |    9081 K  |    9081 K  |
|       from small pool |       0    |    1407    |    5786 K  |    5786 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    1698    |   14868 K  |   14868 K  |
|       from large pool |       2    |     783    |    9081 K  |    9081 K  |
|       from small pool |       0    |    1407    |    5786 K  |    5786 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      59    |     340    |     340    |     281    |
|       from large pool |      35    |     308    |     308    |     273    |
|       from small pool |      24    |      32    |      32    |       8    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     353    |    9353 K  |    9353 K  |
|       from large pool |       3    |     304    |    6823 K  |    6823 K  |
|       from small pool |       0    |     221    |    2530 K  |    2530 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'888c1ef2'
model name: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_09_21_58_seed_1_22478445

 Experiment start at: 2024-07-20 09:21:58.346720
before training, model accuracy: 0.6177777647972107
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.97005206, 'precision': 0.9705641, 'recall': 0.9702769, 'specificity': 0.9702769, 'f1': 0.9700503, 'auroc': 0.99610126, 'binary_precision': 0.9892905, 'binary_recall': 0.951094, 'binary_specificity': 0.9894598, 'binary_f1_score': 0.96981627}
confusion matrix:
      0     1
0  1502    16
1    76  1478
---- Validation: 
scalar performance:
{'acc': 0.8321624, 'precision': 0.8384648, 'recall': 0.8310292, 'specificity': 0.8310292, 'f1': 0.8310052, 'auroc': 0.90727997, 'binary_precision': 0.88073397, 'binary_recall': 0.7619048, 'binary_specificity': 0.90015364, 'binary_f1_score': 0.8170213}
confusion matrix:
     0    1
0  586   65
1  150  480
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.80444443, 'precision': 0.8056277, 'recall': 0.80444443, 'specificity': 0.80444443, 'f1': 0.804255, 'auroc': 0.85659266, 'binary_precision': 0.82464457, 'binary_recall': 0.7733333, 'binary_specificity': 0.83555555, 'binary_f1_score': 0.79816514}
confusion matrix:
     0    1
0  188   37
1   51  174
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-20 09:25:09.406653,epoch time: 0:03:11.059933,used: 0:03:11.059933,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_09_21_58_seed_1_22478445
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9684245, 'precision': 0.96972907, 'recall': 0.9688049, 'specificity': 0.9688049, 'f1': 0.96841574, 'auroc': 0.99820256, 'binary_precision': 0.9979522, 'binary_recall': 0.93958867, 'binary_specificity': 0.9980211, 'binary_f1_score': 0.9678914}
confusion matrix:
      0     1
0  1513     3
1    94  1462
---- Validation: 
scalar performance:
{'acc': 0.7915691, 'precision': 0.828737, 'recall': 0.78878653, 'specificity': 0.78878653, 'f1': 0.7843741, 'auroc': 0.91541946, 'binary_precision': 0.9352518, 'binary_recall': 0.61904764, 'binary_specificity': 0.95852536, 'binary_f1_score': 0.74498576}
confusion matrix:
     0    1
0  624   27
1  240  390
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7222222, 'precision': 0.8085235, 'recall': 0.7222222, 'specificity': 0.7222222, 'f1': 0.7013364, 'auroc': 0.9096099, 'binary_precision': 0.9716981, 'binary_recall': 0.45777777, 'binary_specificity': 0.9866667, 'binary_f1_score': 0.6223565}
confusion matrix:
     0    1
0  222    3
1  122  103
early stop counter: 1
val acc:0.7915691137313843, best validation acc: 0.8321623802185059, corresponding to test acc:                         0.804444432258606 / 0.804444432258606
after epoch: 2,now: 2024-07-20 09:28:03.395890,epoch time: 0:02:53.989237,used: 0:06:05.049170,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_09_21_58_seed_1_22478445
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9814453, 'precision': 0.9814464, 'recall': 0.9814384, 'specificity': 0.9814384, 'f1': 0.98144233, 'auroc': 0.99856126, 'binary_precision': 0.98136246, 'binary_recall': 0.98199356, 'binary_specificity': 0.9808833, 'binary_f1_score': 0.9816779}
confusion matrix:
      0     1
0  1488    29
1    28  1527
---- Validation: 
scalar performance:
{'acc': 0.863388, 'precision': 0.8740741, 'recall': 0.86200714, 'specificity': 0.86200714, 'f1': 0.8620534, 'auroc': 0.9294077, 'binary_precision': 0.93333334, 'binary_recall': 0.7777778, 'binary_specificity': 0.94623655, 'binary_f1_score': 0.8484849}
confusion matrix:
     0    1
0  616   35
1  140  490
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8422222, 'precision': 0.8507085, 'recall': 0.8422222, 'specificity': 0.8422222, 'f1': 0.841262, 'auroc': 0.92152095, 'binary_precision': 0.9052632, 'binary_recall': 0.7644445, 'binary_specificity': 0.92, 'binary_f1_score': 0.8289157}
confusion matrix:
     0    1
0  207   18
1   53  172
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-07-20 09:30:58.009849,epoch time: 0:02:54.613959,used: 0:08:59.663129,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_09_21_58_seed_1_22478445
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9716797, 'precision': 0.9719024, 'recall': 0.97155726, 'specificity': 0.97155726, 'f1': 0.9716654, 'auroc': 0.9974724, 'binary_precision': 0.9646241, 'binary_recall': 0.9801027, 'binary_specificity': 0.96301186, 'binary_f1_score': 0.9723018}
confusion matrix:
      0     1
0  1458    56
1    31  1527
---- Validation: 
scalar performance:
{'acc': 0.7665886, 'precision': 0.785303, 'recall': 0.76443934, 'specificity': 0.76443934, 'f1': 0.7616714, 'auroc': 0.8721436, 'binary_precision': 0.8543897, 'binary_recall': 0.6333333, 'binary_specificity': 0.8955453, 'binary_f1_score': 0.72743845}
confusion matrix:
     0    1
0  583   68
1  231  399
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.77111113, 'precision': 0.8030069, 'recall': 0.77111113, 'specificity': 0.77111113, 'f1': 0.7649249, 'auroc': 0.9012345, 'binary_precision': 0.9013158, 'binary_recall': 0.60888886, 'binary_specificity': 0.93333334, 'binary_f1_score': 0.7267905}
confusion matrix:
     0    1
0  210   15
1   88  137
early stop counter: 1
val acc:0.7665886282920837, best validation acc: 0.8633880019187927, corresponding to test acc:                         0.8422222137451172 / 0.8422222137451172
after epoch: 4,now: 2024-07-20 09:33:51.548557,epoch time: 0:02:53.538708,used: 0:11:53.201837,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_09_21_58_seed_1_22478445
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9557292, 'precision': 0.9587629, 'recall': 0.9563823, 'specificity': 0.9563823, 'f1': 0.95569116, 'auroc': 0.9989501, 'binary_precision': 1.0, 'binary_recall': 0.9127646, 'binary_specificity': 1.0, 'binary_f1_score': 0.9543931}
confusion matrix:
      0     1
0  1513     0
1   136  1423
---- Validation: 
scalar performance:
{'acc': 0.5331772, 'precision': 0.73286474, 'recall': 0.525448, 'specificity': 0.525448, 'f1': 0.3933506, 'auroc': 0.86121106, 'binary_precision': 0.9444444, 'binary_recall': 0.053968254, 'binary_specificity': 0.9969278, 'binary_f1_score': 0.10210211}
confusion matrix:
     0   1
0  649   2
1  596  34
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5044444, 'precision': 0.5844595, 'recall': 0.5044444, 'specificity': 0.5044444, 'f1': 0.35064936, 'auroc': 0.8306371, 'binary_precision': 0.6666667, 'binary_recall': 0.017777778, 'binary_specificity': 0.9911111, 'binary_f1_score': 0.034632035}
confusion matrix:
     0  1
0  223  2
1  221  4
early stop counter: 2
val acc:0.5331771969795227, best validation acc: 0.8633880019187927, corresponding to test acc:                         0.8422222137451172 / 0.8422222137451172
after epoch: 5,now: 2024-07-20 09:36:47.184183,epoch time: 0:02:55.635626,used: 0:14:48.837463,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_09_21_58_seed_1_22478445
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9746094, 'precision': 0.97542584, 'recall': 0.9749187, 'specificity': 0.9749187, 'f1': 0.9746063, 'auroc': 0.99880743, 'binary_precision': 0.9986505, 'binary_recall': 0.9511568, 'binary_specificity': 0.9986807, 'binary_f1_score': 0.97432524}
confusion matrix:
      0     1
0  1514     2
1    76  1480
---- Validation: 
scalar performance:
{'acc': 0.67291176, 'precision': 0.7854824, 'recall': 0.66769075, 'specificity': 0.66769075, 'f1': 0.6330936, 'auroc': 0.9289079, 'binary_precision': 0.96069866, 'binary_recall': 0.34920636, 'binary_specificity': 0.9861751, 'binary_f1_score': 0.51222354}
confusion matrix:
     0    1
0  642    9
1  410  220
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.78, 'precision': 0.8472222, 'recall': 0.78, 'specificity': 0.78, 'f1': 0.7688104, 'auroc': 0.9457185, 'binary_precision': 1.0, 'binary_recall': 0.56, 'binary_specificity': 1.0, 'binary_f1_score': 0.71794873}
confusion matrix:
     0    1
0  225    0
1   99  126
early stop counter: 3
val acc:0.6729117631912231, best validation acc: 0.8633880019187927, corresponding to test acc:                         0.8422222137451172 / 0.8422222137451172
after epoch: 6,now: 2024-07-20 09:39:40.927789,epoch time: 0:02:53.743606,used: 0:17:42.581069,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_09_21_58_seed_1_22478445
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9765625, 'precision': 0.97726625, 'recall': 0.9768697, 'specificity': 0.9768697, 'f1': 0.97656053, 'auroc': 0.99918646, 'binary_precision': 0.9993275, 'binary_recall': 0.95439947, 'binary_specificity': 0.99933994, 'binary_f1_score': 0.9763469}
confusion matrix:
      0     1
0  1514     1
1    71  1486
---- Validation: 
scalar performance:
{'acc': 0.618267, 'precision': 0.7577944, 'recall': 0.6121352, 'specificity': 0.6121352, 'f1': 0.5522122, 'auroc': 0.91601443, 'binary_precision': 0.9433962, 'binary_recall': 0.23809524, 'binary_specificity': 0.9861751, 'binary_f1_score': 0.38022813}
confusion matrix:
     0    1
0  642    9
1  480  150
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.67333335, 'precision': 0.80241936, 'recall': 0.67333335, 'specificity': 0.67333335, 'f1': 0.6343101, 'auroc': 0.92705184, 'binary_precision': 1.0, 'binary_recall': 0.34666666, 'binary_specificity': 1.0, 'binary_f1_score': 0.51485145}
confusion matrix:
     0   1
0  225   0
1  147  78
early stop counter: 4
val acc:0.6182669997215271, best validation acc: 0.8633880019187927, corresponding to test acc:                         0.8422222137451172 / 0.8422222137451172
after epoch: 7,now: 2024-07-20 09:42:35.287298,epoch time: 0:02:54.359509,used: 0:20:36.940578,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_09_21_58_seed_1_22478445
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.98567706, 'precision': 0.98595893, 'recall': 0.9855436, 'specificity': 0.9855436, 'f1': 0.98566926, 'auroc': 0.9995587, 'binary_precision': 0.97730136, 'binary_recall': 0.99486524, 'binary_specificity': 0.9762219, 'binary_f1_score': 0.98600507}
confusion matrix:
      0     1
0  1478    36
1     8  1550
---- Validation: 
scalar performance:
{'acc': 0.8704137, 'precision': 0.87646866, 'recall': 0.8693805, 'specificity': 0.8693805, 'f1': 0.8696351, 'auroc': 0.93045866, 'binary_precision': 0.9202899, 'binary_recall': 0.8063492, 'binary_specificity': 0.9324117, 'binary_f1_score': 0.85956013}
confusion matrix:
     0    1
0  607   44
1  122  508
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.88222224, 'precision': 0.8917004, 'recall': 0.8822222, 'specificity': 0.8822222, 'f1': 0.8815054, 'auroc': 0.9294617, 'binary_precision': 0.9526316, 'binary_recall': 0.80444443, 'binary_specificity': 0.96, 'binary_f1_score': 0.8722892}
confusion matrix:
     0    1
0  216    9
1   44  181
new oracle model saved
better model found
persisted
after epoch: 8,now: 2024-07-20 09:45:29.654532,epoch time: 0:02:54.367234,used: 0:23:31.307812,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_09_21_58_seed_1_22478445
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9840495, 'precision': 0.98432314, 'recall': 0.98423636, 'specificity': 0.98423636, 'f1': 0.9840493, 'auroc': 0.99930394, 'binary_precision': 0.9993369, 'binary_recall': 0.9691318, 'binary_specificity': 0.99934083, 'binary_f1_score': 0.98400265}
confusion matrix:
      0     1
0  1516     1
1    48  1507
---- Validation: 
scalar performance:
{'acc': 0.75019515, 'precision': 0.80315197, 'recall': 0.746723, 'specificity': 0.746723, 'f1': 0.7369934, 'auroc': 0.8953686, 'binary_precision': 0.92582417, 'binary_recall': 0.53492063, 'binary_specificity': 0.95852536, 'binary_f1_score': 0.6780684}
confusion matrix:
     0    1
0  624   27
1  293  337
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.72, 'precision': 0.81596637, 'recall': 0.72, 'specificity': 0.72, 'f1': 0.6969924, 'auroc': 0.92547166, 'binary_precision': 0.990099, 'binary_recall': 0.44444445, 'binary_specificity': 0.9955556, 'binary_f1_score': 0.61349696}
confusion matrix:
     0    1
0  224    1
1  125  100
early stop counter: 1
val acc:0.7501951456069946, best validation acc: 0.8704137206077576, corresponding to test acc:                         0.8822222352027893 / 0.8822222352027893
after epoch: 9,now: 2024-07-20 09:48:22.738864,epoch time: 0:02:53.084332,used: 0:26:24.392144,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_09_21_58_seed_1_22478445
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9921875, 'precision': 0.99216354, 'recall': 0.99225116, 'specificity': 0.99225116, 'f1': 0.9921868, 'auroc': 0.99985504, 'binary_precision': 0.9967617, 'binary_recall': 0.9878049, 'binary_specificity': 0.9966975, 'binary_f1_score': 0.9922631}
confusion matrix:
      0     1
0  1509     5
1    19  1539
---- Validation: 
scalar performance:
{'acc': 0.8508977, 'precision': 0.8701956, 'recall': 0.84902716, 'specificity': 0.84902716, 'f1': 0.8484131, 'auroc': 0.9315704, 'binary_precision': 0.9507187, 'binary_recall': 0.7349206, 'binary_specificity': 0.96313363, 'binary_f1_score': 0.8290062}
confusion matrix:
     0    1
0  627   24
1  167  463
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8488889, 'precision': 0.87960196, 'recall': 0.8488889, 'specificity': 0.8488889, 'f1': 0.84576917, 'auroc': 0.94569874, 'binary_precision': 0.9875776, 'binary_recall': 0.70666665, 'binary_specificity': 0.9911111, 'binary_f1_score': 0.8238341}
confusion matrix:
     0    1
0  223    2
1   66  159
early stop counter: 2
val acc:0.8508977293968201, best validation acc: 0.8704137206077576, corresponding to test acc:                         0.8822222352027893 / 0.8822222352027893
after epoch: 10,now: 2024-07-20 09:51:17.972886,epoch time: 0:02:55.234022,used: 0:29:19.626166,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_09_21_58_seed_1_22478445
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.98535156, 'precision': 0.9854063, 'recall': 0.9853044, 'specificity': 0.9853044, 'f1': 0.9853469, 'auroc': 0.99941283, 'binary_precision': 0.98278064, 'binary_recall': 0.98845416, 'binary_specificity': 0.98215467, 'binary_f1_score': 0.9856093}
confusion matrix:
      0     1
0  1486    27
1    18  1541
---- Validation: 
scalar performance:
{'acc': 0.8610461, 'precision': 0.8615399, 'recall': 0.8613671, 'specificity': 0.8613671, 'f1': 0.86104184, 'auroc': 0.9257821, 'binary_precision': 0.84346503, 'binary_recall': 0.88095236, 'binary_specificity': 0.84178185, 'binary_f1_score': 0.86180115}
confusion matrix:
     0    1
0  548  103
1   75  555
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.81333333, 'precision': 0.8158288, 'recall': 0.81333333, 'specificity': 0.81333333, 'f1': 0.81296396, 'auroc': 0.8987259, 'binary_precision': 0.78775513, 'binary_recall': 0.8577778, 'binary_specificity': 0.7688889, 'binary_f1_score': 0.82127666}
confusion matrix:
     0    1
0  173   52
1   32  193
early stop counter: 3
val acc:0.8610460758209229, best validation acc: 0.8704137206077576, corresponding to test acc:                         0.8822222352027893 / 0.8822222352027893
after epoch: 11,now: 2024-07-20 09:54:10.749593,epoch time: 0:02:52.776707,used: 0:32:12.402873,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_09_21_58_seed_1_22478445
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9866536, 'precision': 0.9867761, 'recall': 0.9865831, 'specificity': 0.9865831, 'f1': 0.9866494, 'auroc': 0.99946165, 'binary_precision': 0.9815522, 'binary_recall': 0.992283, 'binary_specificity': 0.9808833, 'binary_f1_score': 0.98688835}
confusion matrix:
      0     1
0  1488    29
1    12  1543
---- Validation: 
scalar performance:
{'acc': 0.84074944, 'precision': 0.84622693, 'recall': 0.8397081, 'specificity': 0.8397081, 'f1': 0.8397925, 'auroc': 0.9083614, 'binary_precision': 0.88586956, 'binary_recall': 0.77619046, 'binary_specificity': 0.9032258, 'binary_f1_score': 0.8274111}
confusion matrix:
     0    1
0  588   63
1  141  489
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.82666665, 'precision': 0.8554235, 'recall': 0.82666665, 'specificity': 0.82666665, 'f1': 0.8230882, 'auroc': 0.9231012, 'binary_precision': 0.95652175, 'binary_recall': 0.6844444, 'binary_specificity': 0.9688889, 'binary_f1_score': 0.79792744}
confusion matrix:
     0    1
0  218    7
1   71  154
early stop counter: 4
val acc:0.8407494425773621, best validation acc: 0.8704137206077576, corresponding to test acc:                         0.8822222352027893 / 0.8822222352027893
after epoch: 12,now: 2024-07-20 09:57:07.519350,epoch time: 0:02:56.769757,used: 0:35:09.172630,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_09_21_58_seed_1_22478445
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.98795575, 'precision': 0.9879757, 'recall': 0.98793745, 'specificity': 0.98793745, 'f1': 0.987954, 'auroc': 0.99947476, 'binary_precision': 0.98651254, 'binary_recall': 0.9896907, 'binary_specificity': 0.98618424, 'binary_f1_score': 0.9880991}
confusion matrix:
      0     1
0  1499    21
1    16  1536
---- Validation: 
scalar performance:
{'acc': 0.8087432, 'precision': 0.80869555, 'recall': 0.808679, 'specificity': 0.808679, 'f1': 0.80868673, 'auroc': 0.88552165, 'binary_precision': 0.80604136, 'binary_recall': 0.8047619, 'binary_specificity': 0.812596, 'binary_f1_score': 0.80540115}
confusion matrix:
     0    1
0  529  122
1  123  507
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7866667, 'precision': 0.79419816, 'recall': 0.78666663, 'specificity': 0.78666663, 'f1': 0.7852925, 'auroc': 0.9204741, 'binary_precision': 0.74712646, 'binary_recall': 0.8666667, 'binary_specificity': 0.70666665, 'binary_f1_score': 0.80246913}
confusion matrix:
     0    1
0  159   66
1   30  195
early stop counter: 5
val acc:0.8087431788444519, best validation acc: 0.8704137206077576, corresponding to test acc:                         0.8822222352027893 / 0.8822222352027893
after epoch: 13,now: 2024-07-20 10:00:03.594775,epoch time: 0:02:56.075425,used: 0:38:05.248055,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_09_21_58_seed_1_22478445
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 13 with time: 0:38:05.248055 at 2024-07-20 10:00:03.594775
persisted model performance metric: 

scalar performance:
{'acc': 0.88222224, 'precision': 0.8917004, 'recall': 0.8822222, 'specificity': 0.8822222, 'f1': 0.8815054, 'auroc': 0.9294617, 'binary_precision': 0.9526316, 'binary_recall': 0.80444443, 'binary_specificity': 0.96, 'binary_f1_score': 0.8722892}
confusion matrix:
     0    1
0  216    9
1   44  181
oracle model performance metric: 

scalar performance:
{'acc': 0.88222224, 'precision': 0.8917004, 'recall': 0.8822222, 'specificity': 0.8822222, 'f1': 0.8815054, 'auroc': 0.9294617, 'binary_precision': 0.9526316, 'binary_recall': 0.80444443, 'binary_specificity': 0.96, 'binary_f1_score': 0.8722892}
confusion matrix:
     0    1
0  216    9
1   44  181
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_nofreeze_2024-07-19_18-41-07/rule_results/6.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_nofreeze_2024-07-19_18-41-07/confusion_matrix/6.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 457626 KiB |   6793 MiB | 181365 GiB | 181364 GiB |
|       from large pool | 417028 KiB |   6758 MiB | 179338 GiB | 179338 GiB |
|       from small pool |  40598 KiB |     60 MiB |   2026 GiB |   2026 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 457626 KiB |   6793 MiB | 181365 GiB | 181364 GiB |
|       from large pool | 417028 KiB |   6758 MiB | 179338 GiB | 179338 GiB |
|       from small pool |  40598 KiB |     60 MiB |   2026 GiB |   2026 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 447481 KiB |   6787 MiB | 181272 GiB | 181272 GiB |
|       from large pool | 407075 KiB |   6753 MiB | 179248 GiB | 179248 GiB |
|       from small pool |  40406 KiB |     60 MiB |   2024 GiB |   2024 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   7442 MiB |   7442 MiB |  14074 MiB |   6632 MiB |
|       from large pool |   7374 MiB |   7374 MiB |  13990 MiB |   6616 MiB |
|       from small pool |     68 MiB |     68 MiB |     84 MiB |     16 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 343141 KiB | 680458 KiB | 114213 GiB | 114212 GiB |
|       from large pool | 334588 KiB | 673212 KiB | 112157 GiB | 112156 GiB |
|       from small pool |   8553 KiB |  25530 KiB |   2056 GiB |   2056 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    1310    |    1702    |   26995 K  |   26994 K  |
|       from large pool |     187    |     783    |   16480 K  |   16479 K  |
|       from small pool |    1123    |    1419    |   10515 K  |   10514 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    1310    |    1702    |   26995 K  |   26994 K  |
|       from large pool |     187    |     783    |   16480 K  |   16479 K  |
|       from small pool |    1123    |    1419    |   10515 K  |   10514 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     344    |     344    |     625    |     281    |
|       from large pool |     310    |     310    |     583    |     273    |
|       from small pool |      34    |      34    |      42    |       8    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      73    |     354    |   16852 K  |   16852 K  |
|       from large pool |      30    |     308    |   12243 K  |   12243 K  |
|       from small pool |      43    |     221    |    4609 K  |    4609 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   6793 MiB | 181365 GiB | 181365 GiB |
|       from large pool |  16640 KiB |   6758 MiB | 179338 GiB | 179338 GiB |
|       from small pool |      0 KiB |     60 MiB |   2026 GiB |   2026 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   6793 MiB | 181365 GiB | 181365 GiB |
|       from large pool |  16640 KiB |   6758 MiB | 179338 GiB | 179338 GiB |
|       from small pool |      0 KiB |     60 MiB |   2026 GiB |   2026 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   6787 MiB | 181272 GiB | 181272 GiB |
|       from large pool |  16640 KiB |   6753 MiB | 179248 GiB | 179248 GiB |
|       from small pool |      0 KiB |     60 MiB |   2024 GiB |   2024 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    782 MiB |   7442 MiB |  14074 MiB |  13292 MiB |
|       from large pool |    734 MiB |   7374 MiB |  13990 MiB |  13256 MiB |
|       from small pool |     48 MiB |     68 MiB |     84 MiB |     36 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 680458 KiB | 114213 GiB | 114213 GiB |
|       from large pool |  24320 KiB | 673212 KiB | 112157 GiB | 112157 GiB |
|       from small pool |      0 KiB |  31668 KiB |   2056 GiB |   2056 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    1702    |   26995 K  |   26995 K  |
|       from large pool |       2    |     783    |   16480 K  |   16480 K  |
|       from small pool |       0    |    1419    |   10515 K  |   10515 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    1702    |   26995 K  |   26995 K  |
|       from large pool |       2    |     783    |   16480 K  |   16480 K  |
|       from small pool |       0    |    1419    |   10515 K  |   10515 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      58    |     344    |     625    |     567    |
|       from large pool |      34    |     310    |     583    |     549    |
|       from small pool |      24    |      34    |      42    |      18    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     354    |   16853 K  |   16853 K  |
|       from large pool |       3    |     308    |   12243 K  |   12243 K  |
|       from small pool |       0    |     221    |    4610 K  |    4610 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   6793 MiB | 181365 GiB | 181365 GiB |
|       from large pool |  16640 KiB |   6758 MiB | 179338 GiB | 179338 GiB |
|       from small pool |      0 KiB |     60 MiB |   2026 GiB |   2026 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   6793 MiB | 181365 GiB | 181365 GiB |
|       from large pool |  16640 KiB |   6758 MiB | 179338 GiB | 179338 GiB |
|       from small pool |      0 KiB |     60 MiB |   2026 GiB |   2026 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   6787 MiB | 181272 GiB | 181272 GiB |
|       from large pool |  16640 KiB |   6753 MiB | 179248 GiB | 179248 GiB |
|       from small pool |      0 KiB |     60 MiB |   2024 GiB |   2024 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    782 MiB |   7442 MiB |  14074 MiB |  13292 MiB |
|       from large pool |    734 MiB |   7374 MiB |  13990 MiB |  13256 MiB |
|       from small pool |     48 MiB |     68 MiB |     84 MiB |     36 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 680458 KiB | 114213 GiB | 114213 GiB |
|       from large pool |  24320 KiB | 673212 KiB | 112157 GiB | 112157 GiB |
|       from small pool |      0 KiB |  31668 KiB |   2056 GiB |   2056 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    1702    |   26995 K  |   26995 K  |
|       from large pool |       2    |     783    |   16480 K  |   16480 K  |
|       from small pool |       0    |    1419    |   10515 K  |   10515 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    1702    |   26995 K  |   26995 K  |
|       from large pool |       2    |     783    |   16480 K  |   16480 K  |
|       from small pool |       0    |    1419    |   10515 K  |   10515 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      58    |     344    |     625    |     567    |
|       from large pool |      34    |     310    |     583    |     549    |
|       from small pool |      24    |      34    |      42    |      18    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     354    |   16853 K  |   16853 K  |
|       from large pool |       3    |     308    |   12243 K  |   12243 K  |
|       from small pool |       0    |     221    |    4610 K  |    4610 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'888c1ef2'
model name: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_10_01_22_seed_2_22478445

 Experiment start at: 2024-07-20 10:01:22.703710
before training, model accuracy: 0.41203704476356506
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9715314, 'precision': 0.97183627, 'recall': 0.9716453, 'specificity': 0.9716453, 'f1': 0.9715301, 'auroc': 0.9953941, 'binary_precision': 0.98595315, 'binary_recall': 0.95714283, 'binary_specificity': 0.98614776, 'binary_f1_score': 0.97133446}
confusion matrix:
      0     1
0  1495    21
1    66  1474
---- Validation: 
scalar performance:
{'acc': 0.8372457, 'precision': 0.84229326, 'recall': 0.8355889, 'specificity': 0.8355889, 'f1': 0.83607507, 'auroc': 0.9051055, 'binary_precision': 0.8777372, 'binary_recall': 0.7733119, 'binary_specificity': 0.89786583, 'binary_f1_score': 0.82222223}
confusion matrix:
     0    1
0  589   67
1  141  481
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8333333, 'precision': 0.8477639, 'recall': 0.8333334, 'specificity': 0.8333334, 'f1': 0.83158624, 'auroc': 0.9016204, 'binary_precision': 0.9186047, 'binary_recall': 0.7314815, 'binary_specificity': 0.9351852, 'binary_f1_score': 0.814433}
confusion matrix:
     0    1
0  202   14
1   58  158
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-20 10:04:29.127370,epoch time: 0:03:06.423660,used: 0:03:06.423660,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_10_01_22_seed_2_22478445
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.96924084, 'precision': 0.9697037, 'recall': 0.96937776, 'specificity': 0.96937776, 'f1': 0.96923786, 'auroc': 0.9950733, 'binary_precision': 0.98654103, 'binary_recall': 0.95194805, 'binary_specificity': 0.9868074, 'binary_f1_score': 0.96893585}
confusion matrix:
      0     1
0  1496    20
1    74  1466
---- Validation: 
scalar performance:
{'acc': 0.7026604, 'precision': 0.7910149, 'recall': 0.6951587, 'specificity': 0.6951587, 'f1': 0.6731519, 'auroc': 0.87994564, 'binary_precision': 0.94485295, 'binary_recall': 0.41318327, 'binary_specificity': 0.97713417, 'binary_f1_score': 0.574944}
confusion matrix:
     0    1
0  641   15
1  365  257
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6041667, 'precision': 0.76858246, 'recall': 0.6041667, 'specificity': 0.6041667, 'f1': 0.53264207, 'auroc': 0.90678585, 'binary_precision': 0.9787234, 'binary_recall': 0.21296297, 'binary_specificity': 0.9953704, 'binary_f1_score': 0.34980989}
confusion matrix:
     0   1
0  215   1
1  170  46
early stop counter: 1
val acc:0.7026603817939758, best validation acc: 0.8372457027435303, corresponding to test acc:                         0.8333333134651184 / 0.8333333134651184
after epoch: 2,now: 2024-07-20 10:07:22.853994,epoch time: 0:02:53.726624,used: 0:06:00.150284,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_10_01_22_seed_2_22478445
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.976767, 'precision': 0.97706515, 'recall': 0.97668076, 'specificity': 0.97668076, 'f1': 0.97675896, 'auroc': 0.9983051, 'binary_precision': 0.96694213, 'binary_recall': 0.9876623, 'binary_specificity': 0.9656992, 'binary_f1_score': 0.97719246}
confusion matrix:
      0     1
0  1464    52
1    19  1521
---- Validation: 
scalar performance:
{'acc': 0.8231612, 'precision': 0.82518435, 'recall': 0.82420254, 'specificity': 0.82420254, 'f1': 0.8231088, 'auroc': 0.900645, 'binary_precision': 0.7920354, 'binary_recall': 0.8633441, 'binary_specificity': 0.785061, 'binary_f1_score': 0.8261539}
confusion matrix:
     0    1
0  515  141
1   85  537
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7939815, 'precision': 0.82131565, 'recall': 0.79398143, 'specificity': 0.79398143, 'f1': 0.78950477, 'auroc': 0.9240184, 'binary_precision': 0.72759855, 'binary_recall': 0.9398148, 'binary_specificity': 0.6481481, 'binary_f1_score': 0.82020205}
confusion matrix:
     0    1
0  140   76
1   13  203
early stop counter: 2
val acc:0.8231611847877502, best validation acc: 0.8372457027435303, corresponding to test acc:                         0.8333333134651184 / 0.8333333134651184
after epoch: 3,now: 2024-07-20 10:10:16.166031,epoch time: 0:02:53.312037,used: 0:08:53.462321,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_10_01_22_seed_2_22478445
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9754581, 'precision': 0.9763741, 'recall': 0.97564423, 'specificity': 0.97564423, 'f1': 0.9754518, 'auroc': 0.99859035, 'binary_precision': 0.99931836, 'binary_recall': 0.95194805, 'binary_specificity': 0.99934036, 'binary_f1_score': 0.97505826}
confusion matrix:
      0     1
0  1515     1
1    74  1466
---- Validation: 
scalar performance:
{'acc': 0.7261346, 'precision': 0.7867568, 'recall': 0.71985775, 'specificity': 0.71985775, 'f1': 0.7070742, 'auroc': 0.86932886, 'binary_precision': 0.91212124, 'binary_recall': 0.48392284, 'binary_specificity': 0.95579267, 'binary_f1_score': 0.632353}
confusion matrix:
     0    1
0  627   29
1  321  301
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8171296, 'precision': 0.8487073, 'recall': 0.8171296, 'specificity': 0.8171296, 'f1': 0.81289375, 'auroc': 0.90777177, 'binary_precision': 0.95364237, 'binary_recall': 0.6666667, 'binary_specificity': 0.9675926, 'binary_f1_score': 0.78474116}
confusion matrix:
     0    1
0  209    7
1   72  144
early stop counter: 3
val acc:0.7261345982551575, best validation acc: 0.8372457027435303, corresponding to test acc:                         0.8333333134651184 / 0.8333333134651184
after epoch: 4,now: 2024-07-20 10:13:09.159923,epoch time: 0:02:52.993892,used: 0:11:46.456213,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_10_01_22_seed_2_22478445
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.983966, 'precision': 0.98401654, 'recall': 0.98393667, 'specificity': 0.98393667, 'f1': 0.98396385, 'auroc': 0.9986542, 'binary_precision': 0.98065764, 'binary_recall': 0.9876623, 'binary_specificity': 0.9802111, 'binary_f1_score': 0.98414755}
confusion matrix:
      0     1
0  1486    30
1    19  1521
---- Validation: 
scalar performance:
{'acc': 0.8208138, 'precision': 0.82152236, 'recall': 0.8200828, 'specificity': 0.8200828, 'f1': 0.8203773, 'auroc': 0.8948514, 'binary_precision': 0.83136594, 'binary_recall': 0.7926045, 'binary_specificity': 0.847561, 'binary_f1_score': 0.8115226}
confusion matrix:
     0    1
0  556  100
1  129  493
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8055556, 'precision': 0.8072414, 'recall': 0.8055556, 'specificity': 0.8055556, 'f1': 0.80528843, 'auroc': 0.90084875, 'binary_precision': 0.7844828, 'binary_recall': 0.8425926, 'binary_specificity': 0.7685185, 'binary_f1_score': 0.81249994}
confusion matrix:
     0    1
0  166   50
1   34  182
early stop counter: 4
val acc:0.820813775062561, best validation acc: 0.8372457027435303, corresponding to test acc:                         0.8333333134651184 / 0.8333333134651184
after epoch: 5,now: 2024-07-20 10:16:01.026790,epoch time: 0:02:51.866867,used: 0:14:38.323080,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_10_01_22_seed_2_22478445
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.98363876, 'precision': 0.9839332, 'recall': 0.9837508, 'specificity': 0.9837508, 'f1': 0.98363805, 'auroc': 0.9992881, 'binary_precision': 0.99799466, 'binary_recall': 0.9694805, 'binary_specificity': 0.9980211, 'binary_f1_score': 0.983531}
confusion matrix:
      0     1
0  1513     3
1    47  1493
---- Validation: 
scalar performance:
{'acc': 0.76447576, 'precision': 0.8254755, 'recall': 0.7586219, 'specificity': 0.7586219, 'f1': 0.75005245, 'auroc': 0.90890664, 'binary_precision': 0.95988536, 'binary_recall': 0.5385852, 'binary_specificity': 0.97865856, 'binary_f1_score': 0.6900103}
confusion matrix:
     0    1
0  642   14
1  287  335
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7592593, 'precision': 0.81671554, 'recall': 0.7592592, 'specificity': 0.7592592, 'f1': 0.7478222, 'auroc': 0.9052855, 'binary_precision': 0.9516129, 'binary_recall': 0.5462963, 'binary_specificity': 0.9722222, 'binary_f1_score': 0.69411767}
confusion matrix:
     0    1
0  210    6
1   98  118
early stop counter: 5
val acc:0.7644757628440857, best validation acc: 0.8372457027435303, corresponding to test acc:                         0.8333333134651184 / 0.8333333134651184
after epoch: 6,now: 2024-07-20 10:18:55.197153,epoch time: 0:02:54.170363,used: 0:17:32.493443,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_10_01_22_seed_2_22478445
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 6 with time: 0:17:32.493443 at 2024-07-20 10:18:55.197153
persisted model performance metric: 

scalar performance:
{'acc': 0.8333333, 'precision': 0.8477639, 'recall': 0.8333334, 'specificity': 0.8333334, 'f1': 0.83158624, 'auroc': 0.9016204, 'binary_precision': 0.9186047, 'binary_recall': 0.7314815, 'binary_specificity': 0.9351852, 'binary_f1_score': 0.814433}
confusion matrix:
     0    1
0  202   14
1   58  158
oracle model performance metric: 

scalar performance:
{'acc': 0.8333333, 'precision': 0.8477639, 'recall': 0.8333334, 'specificity': 0.8333334, 'f1': 0.83158624, 'auroc': 0.9016204, 'binary_precision': 0.9186047, 'binary_recall': 0.7314815, 'binary_specificity': 0.9351852, 'binary_f1_score': 0.814433}
confusion matrix:
     0    1
0  202   14
1   58  158
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_nofreeze_2024-07-19_18-41-07/rule_results/6.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_nofreeze_2024-07-19_18-41-07/confusion_matrix/6.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 456428 KiB |   6793 MiB | 219224 GiB | 219224 GiB |
|       from large pool | 415836 KiB |   6758 MiB | 216770 GiB | 216770 GiB |
|       from small pool |  40592 KiB |     60 MiB |   2453 GiB |   2453 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 456428 KiB |   6793 MiB | 219224 GiB | 219224 GiB |
|       from large pool | 415836 KiB |   6758 MiB | 216770 GiB | 216770 GiB |
|       from small pool |  40592 KiB |     60 MiB |   2453 GiB |   2453 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 447481 KiB |   6787 MiB | 219112 GiB | 219111 GiB |
|       from large pool | 407075 KiB |   6753 MiB | 216661 GiB | 216661 GiB |
|       from small pool |  40406 KiB |     60 MiB |   2450 GiB |   2450 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   7450 MiB |   7450 MiB |  20742 MiB |  13292 MiB |
|       from large pool |   7386 MiB |   7386 MiB |  20642 MiB |  13256 MiB |
|       from small pool |     64 MiB |     68 MiB |    100 MiB |     36 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 370963 KiB | 680458 KiB | 137798 GiB | 137797 GiB |
|       from large pool | 362404 KiB | 674124 KiB | 135308 GiB | 135308 GiB |
|       from small pool |   8559 KiB |  31668 KiB |   2489 GiB |   2489 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    1298    |    1702    |   32631 K  |   32630 K  |
|       from large pool |     187    |     783    |   19922 K  |   19922 K  |
|       from small pool |    1111    |    1419    |   12709 K  |   12707 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    1298    |    1702    |   32631 K  |   32630 K  |
|       from large pool |     187    |     783    |   19922 K  |   19922 K  |
|       from small pool |    1111    |    1419    |   12709 K  |   12707 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     342    |     344    |     909    |     567    |
|       from large pool |     310    |     310    |     859    |     549    |
|       from small pool |      32    |      34    |      50    |      18    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      80    |     359    |   20340 K  |   20340 K  |
|       from large pool |      38    |     314    |   14768 K  |   14768 K  |
|       from small pool |      42    |     221    |    5571 K  |    5571 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   6793 MiB | 219224 GiB | 219224 GiB |
|       from large pool |  16640 KiB |   6758 MiB | 216770 GiB | 216770 GiB |
|       from small pool |      0 KiB |     60 MiB |   2453 GiB |   2453 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   6793 MiB | 219224 GiB | 219224 GiB |
|       from large pool |  16640 KiB |   6758 MiB | 216770 GiB | 216770 GiB |
|       from small pool |      0 KiB |     60 MiB |   2453 GiB |   2453 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   6787 MiB | 219112 GiB | 219112 GiB |
|       from large pool |  16640 KiB |   6753 MiB | 216661 GiB | 216661 GiB |
|       from small pool |      0 KiB |     60 MiB |   2450 GiB |   2450 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    808 MiB |   7450 MiB |  20742 MiB |  19934 MiB |
|       from large pool |    760 MiB |   7386 MiB |  20642 MiB |  19882 MiB |
|       from small pool |     48 MiB |     68 MiB |    100 MiB |     52 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 680458 KiB | 137798 GiB | 137798 GiB |
|       from large pool |  24320 KiB | 674124 KiB | 135309 GiB | 135309 GiB |
|       from small pool |      0 KiB |  32862 KiB |   2489 GiB |   2489 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    1702    |   32631 K  |   32631 K  |
|       from large pool |       2    |     783    |   19922 K  |   19922 K  |
|       from small pool |       0    |    1419    |   12709 K  |   12709 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    1702    |   32631 K  |   32631 K  |
|       from large pool |       2    |     783    |   19922 K  |   19922 K  |
|       from small pool |       0    |    1419    |   12709 K  |   12709 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      59    |     344    |     909    |     850    |
|       from large pool |      35    |     310    |     859    |     824    |
|       from small pool |      24    |      34    |      50    |      26    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     359    |   20341 K  |   20341 K  |
|       from large pool |       3    |     314    |   14768 K  |   14768 K  |
|       from small pool |       0    |     221    |    5572 K  |    5572 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Sat Jul 20 10:19:43 2024]
Finished job 0.
1 of 1 steps (100%) done
