Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Sat Jul 20 11:16:34 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_nofreeze_2024-07-19_18-41-07/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_nofreeze_2024-07-19_18-41-07/rule_results/5.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=5
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/swiglu_ffn.py:51: UserWarning: xFormers is not available (SwiGLU)
  warnings.warn("xFormers is not available (SwiGLU)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/attention.py:33: UserWarning: xFormers is not available (Attention)
  warnings.warn("xFormers is not available (Attention)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/block.py:40: UserWarning: xFormers is not available (Block)
  warnings.warn("xFormers is not available (Block)")
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'888c1ef2'
model name: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_11_19_02_seed_0_22478449

 Experiment start at: 2024-07-20 11:19:02.379725
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
before training, model accuracy: 0.569767415523529
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.94433594, 'precision': 0.94783163, 'recall': 0.94494116, 'specificity': 0.94494116, 'f1': 0.94427085, 'auroc': 0.99016404, 'binary_precision': 0.9907867, 'binary_recall': 0.8984576, 'binary_specificity': 0.9914248, 'binary_f1_score': 0.942366}
confusion matrix:
      0     1
0  1503    13
1   158  1398
---- Validation: 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
scalar performance:
{'acc': 0.5830745, 'precision': 0.7224947, 'recall': 0.57744753, 'specificity': 0.57744753, 'f1': 0.498474, 'auroc': 0.83883953, 'binary_precision': 0.8951613, 'binary_recall': 0.17480315, 'binary_specificity': 0.98009187, 'binary_f1_score': 0.29249012}
confusion matrix:
     0    1
0  640   13
1  524  111
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7813954, 'precision': 0.83208656, 'recall': 0.7813953, 'specificity': 0.7813953, 'f1': 0.77272224, 'auroc': 0.88573277, 'binary_precision': 0.96183205, 'binary_recall': 0.5860465, 'binary_specificity': 0.9767442, 'binary_f1_score': 0.72832376}
confusion matrix:
     0    1
0  210    5
1   89  126
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-20 11:20:47.816496,epoch time: 0:01:45.436771,used: 0:01:45.436771,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_11_19_02_seed_0_22478449
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.95963544, 'precision': 0.96168166, 'recall': 0.9601034, 'specificity': 0.9601034, 'f1': 0.95961326, 'auroc': 0.99617743, 'binary_precision': 0.9958449, 'binary_recall': 0.92416453, 'binary_specificity': 0.9960422, 'binary_f1_score': 0.95866674}
confusion matrix:
      0     1
0  1510     6
1   118  1438
---- Validation: 
scalar performance:
{'acc': 0.8385093, 'precision': 0.8483703, 'recall': 0.83732736, 'specificity': 0.83732736, 'f1': 0.8369985, 'auroc': 0.9048438, 'binary_precision': 0.9035917, 'binary_recall': 0.7527559, 'binary_specificity': 0.9218989, 'binary_f1_score': 0.8213059}
confusion matrix:
     0    1
0  602   51
1  157  478
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8488372, 'precision': 0.8505435, 'recall': 0.8488372, 'specificity': 0.8488372, 'f1': 0.8486531, 'auroc': 0.92123306, 'binary_precision': 0.875, 'binary_recall': 0.81395346, 'binary_specificity': 0.88372093, 'binary_f1_score': 0.84337354}
confusion matrix:
     0    1
0  190   25
1   40  175
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-07-20 11:22:11.465266,epoch time: 0:01:23.648770,used: 0:03:09.085541,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_11_19_02_seed_0_22478449
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9703776, 'precision': 0.9715925, 'recall': 0.9707055, 'specificity': 0.9707055, 'f1': 0.97036946, 'auroc': 0.9969029, 'binary_precision': 0.99863666, 'binary_recall': 0.94272846, 'binary_specificity': 0.9986825, 'binary_f1_score': 0.96987754}
confusion matrix:
      0     1
0  1516     2
1    89  1465
---- Validation: 
scalar performance:
{'acc': 0.761646, 'precision': 0.793512, 'recall': 0.75930953, 'specificity': 0.75930953, 'f1': 0.75386536, 'auroc': 0.86949635, 'binary_precision': 0.8867925, 'binary_recall': 0.592126, 'binary_specificity': 0.9264931, 'binary_f1_score': 0.71010387}
confusion matrix:
     0    1
0  605   48
1  259  376
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8744186, 'precision': 0.8907855, 'recall': 0.8744186, 'specificity': 0.8744186, 'f1': 0.8730898, 'auroc': 0.91619253, 'binary_precision': 0.9707602, 'binary_recall': 0.772093, 'binary_specificity': 0.9767442, 'binary_f1_score': 0.86010367}
confusion matrix:
     0    1
0  210    5
1   49  166
new oracle model saved
early stop counter: 1
val acc:0.7616459727287292, best validation acc: 0.8385093212127686, corresponding to test acc:                         0.8488371968269348 / 0.8744186162948608
after epoch: 3,now: 2024-07-20 11:23:34.547900,epoch time: 0:01:23.082634,used: 0:04:32.168175,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_11_19_02_seed_0_22478449
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9820964, 'precision': 0.98210084, 'recall': 0.9821824, 'specificity': 0.9821824, 'f1': 0.9820957, 'auroc': 0.9988974, 'binary_precision': 0.9889251, 'binary_recall': 0.9755784, 'binary_specificity': 0.9887863, 'binary_f1_score': 0.98220646}
confusion matrix:
      0     1
0  1499    17
1    38  1518
---- Validation: 
scalar performance:
{'acc': 0.7554348, 'precision': 0.7802987, 'recall': 0.7533142, 'specificity': 0.7533142, 'f1': 0.748821, 'auroc': 0.87808657, 'binary_precision': 0.8603604, 'binary_recall': 0.6015748, 'binary_specificity': 0.9050536, 'binary_f1_score': 0.708063}
confusion matrix:
     0    1
0  591   62
1  253  382
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.82325584, 'precision': 0.82426596, 'recall': 0.8232558, 'specificity': 0.8232558, 'f1': 0.82311803, 'auroc': 0.90985394, 'binary_precision': 0.84236455, 'binary_recall': 0.7953488, 'binary_specificity': 0.8511628, 'binary_f1_score': 0.8181818}
confusion matrix:
     0    1
0  183   32
1   44  171
early stop counter: 2
val acc:0.7554348111152649, best validation acc: 0.8385093212127686, corresponding to test acc:                         0.8488371968269348 / 0.8744186162948608
after epoch: 4,now: 2024-07-20 11:24:57.883618,epoch time: 0:01:23.335718,used: 0:05:55.503893,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_11_19_02_seed_0_22478449
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9664714, 'precision': 0.9674623, 'recall': 0.9662264, 'specificity': 0.9662264, 'f1': 0.9664365, 'auroc': 0.99697924, 'binary_precision': 0.9486704, 'binary_recall': 0.98713, 'binary_specificity': 0.9453228, 'binary_f1_score': 0.96751815}
confusion matrix:
      0     1
0  1435    83
1    20  1534
---- Validation: 
scalar performance:
{'acc': 0.86024845, 'precision': 0.8606843, 'recall': 0.8605033, 'specificity': 0.8605033, 'f1': 0.8602431, 'auroc': 0.92528725, 'binary_precision': 0.8441755, 'binary_recall': 0.87874013, 'binary_specificity': 0.84226644, 'binary_f1_score': 0.8611111}
confusion matrix:
     0    1
0  550  103
1   77  558
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.87906975, 'precision': 0.8823786, 'recall': 0.8790698, 'specificity': 0.8790698, 'f1': 0.87880754, 'auroc': 0.920887, 'binary_precision': 0.9179487, 'binary_recall': 0.83255816, 'binary_specificity': 0.9255814, 'binary_f1_score': 0.87317073}
confusion matrix:
     0    1
0  199   16
1   36  179
new oracle model saved
better model found
persisted
after epoch: 5,now: 2024-07-20 11:26:21.541027,epoch time: 0:01:23.657409,used: 0:07:19.161302,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_11_19_02_seed_0_22478449
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.98339844, 'precision': 0.98359555, 'recall': 0.9835868, 'specificity': 0.9835868, 'f1': 0.98339844, 'auroc': 0.99910593, 'binary_precision': 0.99735796, 'binary_recall': 0.96981376, 'binary_specificity': 0.99735975, 'binary_f1_score': 0.9833931}
confusion matrix:
      0     1
0  1511     4
1    47  1510
---- Validation: 
scalar performance:
{'acc': 0.82686335, 'precision': 0.850567, 'recall': 0.8250389, 'specificity': 0.8250389, 'f1': 0.82329625, 'auroc': 0.9182453, 'binary_precision': 0.93829787, 'binary_recall': 0.69448817, 'binary_specificity': 0.9555896, 'binary_f1_score': 0.79819006}
confusion matrix:
     0    1
0  624   29
1  194  441
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.855814, 'precision': 0.8858651, 'recall': 0.855814, 'specificity': 0.855814, 'f1': 0.85295093, 'auroc': 0.92276907, 'binary_precision': 0.9935484, 'binary_recall': 0.7162791, 'binary_specificity': 0.9953488, 'binary_f1_score': 0.8324325}
confusion matrix:
     0    1
0  214    1
1   61  154
early stop counter: 1
val acc:0.8268633484840393, best validation acc: 0.8602484464645386, corresponding to test acc:                         0.8790697455406189 / 0.8790697455406189
after epoch: 6,now: 2024-07-20 11:27:44.801509,epoch time: 0:01:23.260482,used: 0:08:42.421784,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_11_19_02_seed_0_22478449
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9847005, 'precision': 0.9848633, 'recall': 0.98488855, 'specificity': 0.98488855, 'f1': 0.98470044, 'auroc': 0.9989435, 'binary_precision': 0.99802244, 'binary_recall': 0.97175866, 'binary_specificity': 0.9980185, 'binary_f1_score': 0.9847154}
confusion matrix:
      0     1
0  1511     3
1    44  1514
---- Validation: 
scalar performance:
{'acc': 0.7787267, 'precision': 0.8128494, 'recall': 0.77639365, 'specificity': 0.77639365, 'f1': 0.7715037, 'auroc': 0.9013252, 'binary_precision': 0.9127358, 'binary_recall': 0.6094488, 'binary_specificity': 0.94333845, 'binary_f1_score': 0.7308781}
confusion matrix:
     0    1
0  616   37
1  248  387
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8744186, 'precision': 0.88402224, 'recall': 0.8744186, 'specificity': 0.8744186, 'f1': 0.8736285, 'auroc': 0.9263818, 'binary_precision': 0.9447514, 'binary_recall': 0.7953488, 'binary_specificity': 0.95348835, 'binary_f1_score': 0.8636364}
confusion matrix:
     0    1
0  205   10
1   44  171
early stop counter: 2
val acc:0.7787266969680786, best validation acc: 0.8602484464645386, corresponding to test acc:                         0.8790697455406189 / 0.8790697455406189
after epoch: 7,now: 2024-07-20 11:29:08.118730,epoch time: 0:01:23.317221,used: 0:10:05.739005,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_11_19_02_seed_0_22478449
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9749349, 'precision': 0.97577155, 'recall': 0.9746733, 'specificity': 0.9746733, 'f1': 0.9749088, 'auroc': 0.9987651, 'binary_precision': 0.9590825, 'binary_recall': 0.99293965, 'binary_specificity': 0.9564069, 'binary_f1_score': 0.9757175}
confusion matrix:
      0     1
0  1448    66
1    11  1547
---- Validation: 
scalar performance:
{'acc': 0.8718944, 'precision': 0.8718755, 'recall': 0.87185854, 'specificity': 0.87185854, 'f1': 0.8718665, 'auroc': 0.92173976, 'binary_precision': 0.87066245, 'binary_recall': 0.86929137, 'binary_specificity': 0.8744257, 'binary_f1_score': 0.8699764}
confusion matrix:
     0    1
0  571   82
1   83  552
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8627907, 'precision': 0.86564624, 'recall': 0.8627907, 'specificity': 0.8627907, 'f1': 0.8625223, 'auroc': 0.9289346, 'binary_precision': 0.8979592, 'binary_recall': 0.81860465, 'binary_specificity': 0.90697676, 'binary_f1_score': 0.8564477}
confusion matrix:
     0    1
0  195   20
1   39  176
better model found
persisted
after epoch: 8,now: 2024-07-20 11:30:31.603060,epoch time: 0:01:23.484330,used: 0:11:29.223335,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_11_19_02_seed_0_22478449
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.98307294, 'precision': 0.98320776, 'recall': 0.98323894, 'specificity': 0.98323894, 'f1': 0.9830729, 'auroc': 0.9990144, 'binary_precision': 0.9953917, 'binary_recall': 0.97109824, 'binary_specificity': 0.99537957, 'binary_f1_score': 0.98309493}
confusion matrix:
      0     1
0  1508     7
1    45  1512
---- Validation: 
scalar performance:
{'acc': 0.85714287, 'precision': 0.86468697, 'recall': 0.8561382, 'specificity': 0.8561382, 'f1': 0.8561313, 'auroc': 0.923194, 'binary_precision': 0.9137615, 'binary_recall': 0.784252, 'binary_specificity': 0.92802453, 'binary_f1_score': 0.84406775}
confusion matrix:
     0    1
0  606   47
1  137  498
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.89069766, 'precision': 0.8979376, 'recall': 0.8906977, 'specificity': 0.8906977, 'f1': 0.89019823, 'auroc': 0.9342996, 'binary_precision': 0.9516129, 'binary_recall': 0.82325584, 'binary_specificity': 0.95813954, 'binary_f1_score': 0.882793}
confusion matrix:
     0    1
0  206    9
1   38  177
new oracle model saved
early stop counter: 1
val acc:0.8571428656578064, best validation acc: 0.8718944191932678, corresponding to test acc:                         0.8627907037734985 / 0.8906976580619812
after epoch: 9,now: 2024-07-20 11:31:55.321928,epoch time: 0:01:23.718868,used: 0:12:52.942203,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_11_19_02_seed_0_22478449
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.99283856, 'precision': 0.9928242, 'recall': 0.99285424, 'specificity': 0.99285424, 'f1': 0.99283755, 'auroc': 0.99933064, 'binary_precision': 0.994201, 'binary_recall': 0.9916452, 'binary_specificity': 0.9940633, 'binary_f1_score': 0.9929215}
confusion matrix:
      0     1
0  1507     9
1    13  1543
---- Validation: 
scalar performance:
{'acc': 0.80667704, 'precision': 0.83115053, 'recall': 0.80476177, 'specificity': 0.80476177, 'f1': 0.8023302, 'auroc': 0.896171, 'binary_precision': 0.9177489, 'binary_recall': 0.66771656, 'binary_specificity': 0.94180703, 'binary_f1_score': 0.7730174}
confusion matrix:
     0    1
0  615   38
1  211  424
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8534884, 'precision': 0.876359, 'recall': 0.8534883, 'specificity': 0.8534883, 'f1': 0.85122824, 'auroc': 0.9221417, 'binary_precision': 0.9691358, 'binary_recall': 0.73023254, 'binary_specificity': 0.9767442, 'binary_f1_score': 0.8328913}
confusion matrix:
     0    1
0  210    5
1   58  157
early stop counter: 2
val acc:0.8066770434379578, best validation acc: 0.8718944191932678, corresponding to test acc:                         0.8627907037734985 / 0.8906976580619812
after epoch: 10,now: 2024-07-20 11:33:19.083899,epoch time: 0:01:23.761971,used: 0:14:16.704174,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_11_19_02_seed_0_22478449
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.98502606, 'precision': 0.9852911, 'recall': 0.98491096, 'specificity': 0.98491096, 'f1': 0.98501915, 'auroc': 0.9994879, 'binary_precision': 0.97662663, 'binary_recall': 0.9942122, 'binary_specificity': 0.9756098, 'binary_f1_score': 0.985341}
confusion matrix:
      0     1
0  1480    37
1     9  1546
---- Validation: 
scalar performance:
{'acc': 0.83540374, 'precision': 0.8369636, 'recall': 0.83491576, 'specificity': 0.83491576, 'f1': 0.83504575, 'auroc': 0.89694804, 'binary_precision': 0.856661, 'binary_recall': 0.8, 'binary_specificity': 0.86983156, 'binary_f1_score': 0.8273616}
confusion matrix:
     0    1
0  568   85
1  127  508
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.872093, 'precision': 0.87391305, 'recall': 0.872093, 'specificity': 0.872093, 'f1': 0.87193716, 'auroc': 0.93994594, 'binary_precision': 0.9, 'binary_recall': 0.8372093, 'binary_specificity': 0.90697676, 'binary_f1_score': 0.86746985}
confusion matrix:
     0    1
0  195   20
1   35  180
early stop counter: 3
val acc:0.8354037404060364, best validation acc: 0.8718944191932678, corresponding to test acc:                         0.8627907037734985 / 0.8906976580619812
after epoch: 11,now: 2024-07-20 11:34:42.173115,epoch time: 0:01:23.089216,used: 0:15:39.793390,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_11_19_02_seed_0_22478449
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9817708, 'precision': 0.9821656, 'recall': 0.98202825, 'specificity': 0.98202825, 'f1': 0.9817706, 'auroc': 0.99944925, 'binary_precision': 1.0, 'binary_recall': 0.9640565, 'binary_specificity': 1.0, 'binary_f1_score': 0.98169935}
confusion matrix:
      0     1
0  1514     0
1    56  1502
---- Validation: 
scalar performance:
{'acc': 0.67701864, 'precision': 0.78376865, 'recall': 0.67267966, 'specificity': 0.67267966, 'f1': 0.64020413, 'auroc': 0.88385284, 'binary_precision': 0.95435685, 'binary_recall': 0.36220473, 'binary_specificity': 0.98315465, 'binary_f1_score': 0.5251142}
confusion matrix:
     0    1
0  642   11
1  405  230
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.772093, 'precision': 0.83639574, 'recall': 0.77209306, 'specificity': 0.77209306, 'f1': 0.7606553, 'auroc': 0.92493236, 'binary_precision': 0.9834711, 'binary_recall': 0.5534884, 'binary_specificity': 0.9906977, 'binary_f1_score': 0.7083334}
confusion matrix:
     0    1
0  213    2
1   96  119
early stop counter: 4
val acc:0.6770186424255371, best validation acc: 0.8718944191932678, corresponding to test acc:                         0.8627907037734985 / 0.8906976580619812
after epoch: 12,now: 2024-07-20 11:36:05.688821,epoch time: 0:01:23.515706,used: 0:17:03.309096,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_11_19_02_seed_0_22478449
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.991862, 'precision': 0.9918982, 'recall': 0.9918325, 'specificity': 0.9918325, 'f1': 0.99186015, 'auroc': 0.9996511, 'binary_precision': 0.9897567, 'binary_recall': 0.9942122, 'binary_specificity': 0.98945284, 'binary_f1_score': 0.9919794}
confusion matrix:
      0     1
0  1501    16
1     9  1546
---- Validation: 
scalar performance:
{'acc': 0.8532609, 'precision': 0.85960144, 'recall': 0.8523314, 'specificity': 0.8523314, 'f1': 0.852353, 'auroc': 0.9237969, 'binary_precision': 0.9039855, 'binary_recall': 0.78582674, 'binary_specificity': 0.9188361, 'binary_f1_score': 0.8407751}
confusion matrix:
     0    1
0  600   53
1  136  499
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8534884, 'precision': 0.85833335, 'recall': 0.8534883, 'specificity': 0.8534883, 'f1': 0.85299146, 'auroc': 0.9231585, 'binary_precision': 0.9, 'binary_recall': 0.7953488, 'binary_specificity': 0.9116279, 'binary_f1_score': 0.84444445}
confusion matrix:
     0    1
0  196   19
1   44  171
early stop counter: 5
val acc:0.85326087474823, best validation acc: 0.8718944191932678, corresponding to test acc:                         0.8627907037734985 / 0.8906976580619812
after epoch: 13,now: 2024-07-20 11:37:28.638762,epoch time: 0:01:22.949941,used: 0:18:26.259037,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_11_19_02_seed_0_22478449
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9873047, 'precision': 0.98747826, 'recall': 0.9872135, 'specificity': 0.9872135, 'f1': 0.9872997, 'auroc': 0.9994379, 'binary_precision': 0.9809765, 'binary_recall': 0.99421597, 'binary_specificity': 0.9802111, 'binary_f1_score': 0.98755187}
confusion matrix:
      0     1
0  1486    30
1     9  1547
---- Validation: 
scalar performance:
{'acc': 0.88431674, 'precision': 0.8891796, 'recall': 0.88354534, 'specificity': 0.88354534, 'f1': 0.88378656, 'auroc': 0.9391494, 'binary_precision': 0.9293286, 'binary_recall': 0.82834643, 'binary_specificity': 0.93874425, 'binary_f1_score': 0.8759367}
confusion matrix:
     0    1
0  613   40
1  109  526
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8697674, 'precision': 0.88750595, 'recall': 0.8697674, 'specificity': 0.8697674, 'f1': 0.8682598, 'auroc': 0.93590045, 'binary_precision': 0.9704142, 'binary_recall': 0.7627907, 'binary_specificity': 0.9767442, 'binary_f1_score': 0.8541667}
confusion matrix:
     0    1
0  210    5
1   51  164
better model found
persisted
after epoch: 14,now: 2024-07-20 11:38:51.272975,epoch time: 0:01:22.634213,used: 0:19:48.893250,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_11_19_02_seed_0_22478449
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.99088544, 'precision': 0.9909035, 'recall': 0.9908669, 'specificity': 0.9908669, 'f1': 0.9908835, 'auroc': 0.9997194, 'binary_precision': 0.9897436, 'binary_recall': 0.99228793, 'binary_specificity': 0.9894459, 'binary_f1_score': 0.9910141}
confusion matrix:
      0     1
0  1500    16
1    12  1544
---- Validation: 
scalar performance:
{'acc': 0.85248446, 'precision': 0.8572573, 'recall': 0.8516743, 'specificity': 0.8516743, 'f1': 0.8517607, 'auroc': 0.9154912, 'binary_precision': 0.89520425, 'binary_recall': 0.7937008, 'binary_specificity': 0.90964776, 'binary_f1_score': 0.84140235}
confusion matrix:
     0    1
0  594   59
1  131  504
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8860465, 'precision': 0.8874631, 'recall': 0.8860465, 'specificity': 0.8860465, 'f1': 0.8859423, 'auroc': 0.9475825, 'binary_precision': 0.9108911, 'binary_recall': 0.855814, 'binary_specificity': 0.9162791, 'binary_f1_score': 0.8824941}
confusion matrix:
     0    1
0  197   18
1   31  184
early stop counter: 1
val acc:0.8524844646453857, best validation acc: 0.8843167424201965, corresponding to test acc:                         0.869767427444458 / 0.8906976580619812
after epoch: 15,now: 2024-07-20 11:40:16.463961,epoch time: 0:01:25.190986,used: 0:21:14.084236,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_11_19_02_seed_0_22478449
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9827474, 'precision': 0.98297584, 'recall': 0.9826329, 'specificity': 0.9826329, 'f1': 0.9827392, 'auroc': 0.9990623, 'binary_precision': 0.97534764, 'binary_recall': 0.99100834, 'binary_specificity': 0.9742574, 'binary_f1_score': 0.9831156}
confusion matrix:
      0     1
0  1476    39
1    14  1543
---- Validation: 
scalar performance:
{'acc': 0.8703416, 'precision': 0.87030864, 'recall': 0.8703488, 'specificity': 0.8703488, 'f1': 0.870324, 'auroc': 0.9264045, 'binary_precision': 0.86677116, 'binary_recall': 0.8708661, 'binary_specificity': 0.86983156, 'binary_f1_score': 0.8688138}
confusion matrix:
     0    1
0  568   85
1   82  553
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.855814, 'precision': 0.85584474, 'recall': 0.855814, 'specificity': 0.855814, 'f1': 0.8558109, 'auroc': 0.9298864, 'binary_precision': 0.85253453, 'binary_recall': 0.8604651, 'binary_specificity': 0.8511628, 'binary_f1_score': 0.8564815}
confusion matrix:
     0    1
0  183   32
1   30  185
early stop counter: 2
val acc:0.8703415989875793, best validation acc: 0.8843167424201965, corresponding to test acc:                         0.869767427444458 / 0.8906976580619812
after epoch: 16,now: 2024-07-20 11:41:39.094155,epoch time: 0:01:22.630194,used: 0:22:36.714430,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_11_19_02_seed_0_22478449
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.98567706, 'precision': 0.98586136, 'recall': 0.98586136, 'specificity': 0.98586136, 'f1': 0.9856771, 'auroc': 0.99978757, 'binary_precision': 0.99933994, 'binary_recall': 0.9723828, 'binary_specificity': 0.99933994, 'binary_f1_score': 0.9856771}
confusion matrix:
      0     1
0  1514     1
1    43  1514
---- Validation: 
scalar performance:
{'acc': 0.6537267, 'precision': 0.7740376, 'recall': 0.64903593, 'specificity': 0.64903593, 'f1': 0.60702914, 'auroc': 0.9161972, 'binary_precision': 0.9521531, 'binary_recall': 0.3133858, 'binary_specificity': 0.9846861, 'binary_f1_score': 0.47156397}
confusion matrix:
     0    1
0  643   10
1  436  199
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7348837, 'precision': 0.8267477, 'recall': 0.7348837, 'specificity': 0.7348837, 'f1': 0.7148408, 'auroc': 0.9163439, 'binary_precision': 1.0, 'binary_recall': 0.46976745, 'binary_specificity': 1.0, 'binary_f1_score': 0.6392405}
confusion matrix:
     0    1
0  215    0
1  114  101
early stop counter: 3
val acc:0.6537266969680786, best validation acc: 0.8843167424201965, corresponding to test acc:                         0.869767427444458 / 0.8906976580619812
after epoch: 17,now: 2024-07-20 11:43:02.045587,epoch time: 0:01:22.951432,used: 0:23:59.665862,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_11_19_02_seed_0_22478449
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.95996094, 'precision': 0.96194744, 'recall': 0.96044755, 'specificity': 0.96044755, 'f1': 0.9599407, 'auroc': 0.9974117, 'binary_precision': 0.9958506, 'binary_recall': 0.9248555, 'binary_specificity': 0.9960396, 'binary_f1_score': 0.95904094}
confusion matrix:
      0     1
0  1509     6
1   117  1440
---- Validation: 
scalar performance:
{'acc': 0.6374224, 'precision': 0.77038044, 'recall': 0.63245714, 'specificity': 0.63245714, 'f1': 0.5819992, 'auroc': 0.8947282, 'binary_precision': 0.95652175, 'binary_recall': 0.27716535, 'binary_specificity': 0.98774886, 'binary_f1_score': 0.4297924}
confusion matrix:
     0    1
0  645    8
1  459  176
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7116279, 'precision': 0.8171091, 'recall': 0.7116279, 'specificity': 0.7116279, 'f1': 0.68547225, 'auroc': 0.9102217, 'binary_precision': 1.0, 'binary_recall': 0.4232558, 'binary_specificity': 1.0, 'binary_f1_score': 0.5947712}
confusion matrix:
     0   1
0  215   0
1  124  91
early stop counter: 4
val acc:0.6374223828315735, best validation acc: 0.8843167424201965, corresponding to test acc:                         0.869767427444458 / 0.8906976580619812
after epoch: 18,now: 2024-07-20 11:44:25.619494,epoch time: 0:01:23.573907,used: 0:25:23.239769,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_11_19_02_seed_0_22478449
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9941406, 'precision': 0.99412364, 'recall': 0.9941588, 'specificity': 0.9941588, 'f1': 0.99413955, 'auroc': 0.9998796, 'binary_precision': 0.9954984, 'binary_recall': 0.9929442, 'binary_specificity': 0.9953734, 'binary_f1_score': 0.99421966}
confusion matrix:
      0     1
0  1506     7
1    11  1548
---- Validation: 
scalar performance:
{'acc': 0.82298136, 'precision': 0.8261756, 'recall': 0.82227397, 'specificity': 0.82227397, 'f1': 0.82229584, 'auroc': 0.9048661, 'binary_precision': 0.8551483, 'binary_recall': 0.77165353, 'binary_specificity': 0.87289435, 'binary_f1_score': 0.81125826}
confusion matrix:
     0    1
0  570   83
1  145  490
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.855814, 'precision': 0.8559371, 'recall': 0.855814, 'specificity': 0.855814, 'f1': 0.85580146, 'auroc': 0.92668474, 'binary_precision': 0.86255926, 'binary_recall': 0.8465116, 'binary_specificity': 0.8651163, 'binary_f1_score': 0.85446006}
confusion matrix:
     0    1
0  186   29
1   33  182
early stop counter: 5
val acc:0.8229813575744629, best validation acc: 0.8843167424201965, corresponding to test acc:                         0.869767427444458 / 0.8906976580619812
after epoch: 19,now: 2024-07-20 11:45:53.170868,epoch time: 0:01:27.551374,used: 0:26:50.791143,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_11_19_02_seed_0_22478449
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.98860675, 'precision': 0.9886969, 'recall': 0.98874474, 'specificity': 0.98874474, 'f1': 0.9886067, 'auroc': 0.9991373, 'binary_precision': 0.9993434, 'binary_recall': 0.9781491, 'binary_specificity': 0.99934036, 'binary_f1_score': 0.9886327}
confusion matrix:
      0     1
0  1515     1
1    34  1522
---- Validation: 
scalar performance:
{'acc': 0.7414596, 'precision': 0.80873597, 'recall': 0.73816425, 'specificity': 0.73816425, 'f1': 0.72478896, 'auroc': 0.91859615, 'binary_precision': 0.9494048, 'binary_recall': 0.5023622, 'binary_specificity': 0.9739663, 'binary_f1_score': 0.6570546}
confusion matrix:
     0    1
0  636   17
1  316  319
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8255814, 'precision': 0.8654332, 'recall': 0.82558143, 'specificity': 0.82558143, 'f1': 0.8206929, 'auroc': 0.9240671, 'binary_precision': 0.9861111, 'binary_recall': 0.6604651, 'binary_specificity': 0.9906977, 'binary_f1_score': 0.7910864}
confusion matrix:
     0    1
0  213    2
1   73  142
early stop counter: 6
val acc:0.7414596080780029, best validation acc: 0.8843167424201965, corresponding to test acc:                         0.869767427444458 / 0.8906976580619812
after epoch: 20,now: 2024-07-20 11:47:17.121911,epoch time: 0:01:23.951043,used: 0:28:14.742186,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_11_19_02_seed_0_22478449
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.99348956, 'precision': 0.99348855, 'recall': 0.99348855, 'specificity': 0.99348855, 'f1': 0.99348855, 'auroc': 0.99979234, 'binary_precision': 0.99356914, 'binary_recall': 0.99356914, 'binary_specificity': 0.993408, 'binary_f1_score': 0.99356914}
confusion matrix:
      0     1
0  1507    10
1    10  1545
---- Validation: 
scalar performance:
{'acc': 0.7453416, 'precision': 0.79734737, 'recall': 0.7423834, 'specificity': 0.7423834, 'f1': 0.7321342, 'auroc': 0.9076968, 'binary_precision': 0.9182561, 'binary_recall': 0.5307087, 'binary_specificity': 0.9540582, 'binary_f1_score': 0.6726547}
confusion matrix:
     0    1
0  623   30
1  298  337
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8418605, 'precision': 0.8614065, 'recall': 0.8418605, 'specificity': 0.8418605, 'f1': 0.839693, 'auroc': 0.9277015, 'binary_precision': 0.94545454, 'binary_recall': 0.7255814, 'binary_specificity': 0.95813954, 'binary_f1_score': 0.8210526}
confusion matrix:
     0    1
0  206    9
1   59  156
early stop counter: 7
val acc:0.7453415989875793, best validation acc: 0.8843167424201965, corresponding to test acc:                         0.869767427444458 / 0.8906976580619812
after epoch: 21,now: 2024-07-20 11:48:39.404676,epoch time: 0:01:22.282765,used: 0:29:37.024951,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_11_19_02_seed_0_22478449
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9791667, 'precision': 0.97975963, 'recall': 0.97942126, 'specificity': 0.97942126, 'f1': 0.9791652, 'auroc': 0.99967694, 'binary_precision': 1.0, 'binary_recall': 0.95884246, 'binary_specificity': 1.0, 'binary_f1_score': 0.9789888}
confusion matrix:
      0     1
0  1517     0
1    64  1491
---- Validation: 
scalar performance:
{'acc': 0.56832296, 'precision': 0.7421353, 'recall': 0.56231326, 'specificity': 0.56231326, 'f1': 0.46591413, 'auroc': 0.8620088, 'binary_precision': 0.94382024, 'binary_recall': 0.13228346, 'binary_specificity': 0.992343, 'binary_f1_score': 0.23204419}
confusion matrix:
     0   1
0  648   5
1  551  84
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.53953487, 'precision': 0.76029056, 'recall': 0.53953487, 'specificity': 0.53953487, 'f1': 0.41563255, 'auroc': 0.9093131, 'binary_precision': 1.0, 'binary_recall': 0.07906977, 'binary_specificity': 1.0, 'binary_f1_score': 0.14655173}
confusion matrix:
     0   1
0  215   0
1  198  17
early stop counter: 8
val acc:0.5683229565620422, best validation acc: 0.8843167424201965, corresponding to test acc:                         0.869767427444458 / 0.8906976580619812
after epoch: 22,now: 2024-07-20 11:50:03.001423,epoch time: 0:01:23.596747,used: 0:31:00.621698,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_11_19_02_seed_0_22478449
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.9827474, 'precision': 0.98326665, 'recall': 0.98255265, 'specificity': 0.98255265, 'f1': 0.98273414, 'auroc': 0.9995591, 'binary_precision': 0.9706066, 'binary_recall': 0.9961489, 'binary_specificity': 0.9689564, 'binary_f1_score': 0.9832119}
confusion matrix:
      0     1
0  1467    47
1     6  1552
---- Validation: 
scalar performance:
{'acc': 0.88586956, 'precision': 0.88629603, 'recall': 0.8856411, 'specificity': 0.8856411, 'f1': 0.8857753, 'auroc': 0.9357056, 'binary_precision': 0.8961039, 'binary_recall': 0.86929137, 'binary_specificity': 0.90199083, 'binary_f1_score': 0.88249403}
confusion matrix:
     0    1
0  589   64
1   83  552
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.89069766, 'precision': 0.90133333, 'recall': 0.8906977, 'specificity': 0.8906977, 'f1': 0.8899687, 'auroc': 0.93724173, 'binary_precision': 0.96666664, 'binary_recall': 0.80930233, 'binary_specificity': 0.97209305, 'binary_f1_score': 0.8810126}
confusion matrix:
     0    1
0  209    6
1   41  174
better model found
persisted
after epoch: 23,now: 2024-07-20 11:51:27.040620,epoch time: 0:01:24.039197,used: 0:32:24.660895,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_11_19_02_seed_0_22478449
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.99283856, 'precision': 0.9928149, 'recall': 0.9928817, 'specificity': 0.9928817, 'f1': 0.9928378, 'auroc': 0.999599, 'binary_precision': 0.9961215, 'binary_recall': 0.9897238, 'binary_specificity': 0.9960396, 'binary_f1_score': 0.99291235}
confusion matrix:
      0     1
0  1509     6
1    16  1541
---- Validation: 
scalar performance:
{'acc': 0.70652175, 'precision': 0.7831106, 'recall': 0.70283973, 'specificity': 0.70283973, 'f1': 0.682833, 'auroc': 0.88681436, 'binary_precision': 0.9269103, 'binary_recall': 0.43937007, 'binary_specificity': 0.96630937, 'binary_f1_score': 0.59615386}
confusion matrix:
     0    1
0  631   22
1  356  279
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.83255816, 'precision': 0.8671571, 'recall': 0.83255816, 'specificity': 0.83255816, 'f1': 0.8285183, 'auroc': 0.9223364, 'binary_precision': 0.9798658, 'binary_recall': 0.67906976, 'binary_specificity': 0.9860465, 'binary_f1_score': 0.8021978}
confusion matrix:
     0    1
0  212    3
1   69  146
early stop counter: 1
val acc:0.70652174949646, best validation acc: 0.885869562625885, corresponding to test acc:                         0.8906976580619812 / 0.8906976580619812
after epoch: 24,now: 2024-07-20 11:52:49.559487,epoch time: 0:01:22.518867,used: 0:33:47.179762,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_11_19_02_seed_0_22478449
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.99316406, 'precision': 0.99316406, 'recall': 0.9932563, 'specificity': 0.9932563, 'f1': 0.99316376, 'auroc': 0.99993813, 'binary_precision': 1.0, 'binary_recall': 0.98651254, 'binary_specificity': 1.0, 'binary_f1_score': 0.9932105}
confusion matrix:
      0     1
0  1515     0
1    21  1536
---- Validation: 
scalar performance:
{'acc': 0.6079193, 'precision': 0.755002, 'recall': 0.60253584, 'specificity': 0.60253584, 'f1': 0.536028, 'auroc': 0.9073863, 'binary_precision': 0.94520545, 'binary_recall': 0.21732284, 'binary_specificity': 0.98774886, 'binary_f1_score': 0.35339308}
confusion matrix:
     0    1
0  645    8
1  497  138
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6744186, 'precision': 0.79662263, 'recall': 0.67441857, 'specificity': 0.67441857, 'f1': 0.63703454, 'auroc': 0.9123526, 'binary_precision': 0.987013, 'binary_recall': 0.3534884, 'binary_specificity': 0.9953488, 'binary_f1_score': 0.520548}
confusion matrix:
     0   1
0  214   1
1  139  76
early stop counter: 2
val acc:0.6079192757606506, best validation acc: 0.885869562625885, corresponding to test acc:                         0.8906976580619812 / 0.8906976580619812
after epoch: 25,now: 2024-07-20 11:54:12.123353,epoch time: 0:01:22.563866,used: 0:35:09.743628,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_11_19_02_seed_0_22478449
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9794922, 'precision': 0.98003805, 'recall': 0.97976875, 'specificity': 0.97976875, 'f1': 0.97949123, 'auroc': 0.9996642, 'binary_precision': 1.0, 'binary_recall': 0.95953757, 'binary_specificity': 1.0, 'binary_f1_score': 0.97935104}
confusion matrix:
      0     1
0  1515     0
1    63  1494
---- Validation: 
scalar performance:
{'acc': 0.5310559, 'precision': 0.71925163, 'recall': 0.52447456, 'specificity': 0.52447456, 'f1': 0.39198178, 'auroc': 0.92069495, 'binary_precision': 0.9189189, 'binary_recall': 0.053543307, 'binary_specificity': 0.9954058, 'binary_f1_score': 0.10119048}
confusion matrix:
     0   1
0  650   3
1  601  34
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5139535, 'precision': 0.7535378, 'recall': 0.5139535, 'specificity': 0.5139535, 'f1': 0.36361253, 'auroc': 0.914186, 'binary_precision': 1.0, 'binary_recall': 0.027906977, 'binary_specificity': 1.0, 'binary_f1_score': 0.05429864}
confusion matrix:
     0  1
0  215  0
1  209  6
early stop counter: 3
val acc:0.5310559272766113, best validation acc: 0.885869562625885, corresponding to test acc:                         0.8906976580619812 / 0.8906976580619812
after epoch: 26,now: 2024-07-20 11:55:36.226997,epoch time: 0:01:24.103644,used: 0:36:33.847272,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_11_19_02_seed_0_22478449
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.9954427, 'precision': 0.99543595, 'recall': 0.99544936, 'specificity': 0.99544936, 'f1': 0.9954423, 'auroc': 0.9998406, 'binary_precision': 0.99613154, 'binary_recall': 0.99484867, 'binary_specificity': 0.99605006, 'binary_f1_score': 0.9954897}
confusion matrix:
      0     1
0  1513     6
1     8  1545
---- Validation: 
scalar performance:
{'acc': 0.70574534, 'precision': 0.7980376, 'recall': 0.7018136, 'specificity': 0.7018136, 'f1': 0.67849183, 'auroc': 0.84751415, 'binary_precision': 0.96043164, 'binary_recall': 0.42047244, 'binary_specificity': 0.98315465, 'binary_f1_score': 0.584885}
confusion matrix:
     0    1
0  642   11
1  368  267
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8581395, 'precision': 0.885215, 'recall': 0.8581395, 'specificity': 0.8581395, 'f1': 0.85560226, 'auroc': 0.93429965, 'binary_precision': 0.98734176, 'binary_recall': 0.7255814, 'binary_specificity': 0.9906977, 'binary_f1_score': 0.8364611}
confusion matrix:
     0    1
0  213    2
1   59  156
early stop counter: 4
val acc:0.7057453393936157, best validation acc: 0.885869562625885, corresponding to test acc:                         0.8906976580619812 / 0.8906976580619812
after epoch: 27,now: 2024-07-20 11:56:58.611593,epoch time: 0:01:22.384596,used: 0:37:56.231868,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_11_19_02_seed_0_22478449
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.992513, 'precision': 0.99251306, 'recall': 0.99262345, 'specificity': 0.99262345, 'f1': 0.9925126, 'auroc': 0.9999381, 'binary_precision': 1.0, 'binary_recall': 0.98524696, 'binary_specificity': 1.0, 'binary_f1_score': 0.9925687}
confusion matrix:
      0     1
0  1513     0
1    23  1536
---- Validation: 
scalar performance:
{'acc': 0.6661491, 'precision': 0.78414977, 'recall': 0.66159093, 'specificity': 0.66159093, 'f1': 0.62383175, 'auroc': 0.93625844, 'binary_precision': 0.9638009, 'binary_recall': 0.33543307, 'binary_specificity': 0.98774886, 'binary_f1_score': 0.4976636}
confusion matrix:
     0    1
0  645    8
1  422  213
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5837209, 'precision': 0.77284265, 'recall': 0.5837209, 'specificity': 0.5837209, 'f1': 0.49646407, 'auroc': 0.92452675, 'binary_precision': 1.0, 'binary_recall': 0.16744186, 'binary_specificity': 1.0, 'binary_f1_score': 0.2868526}
confusion matrix:
     0   1
0  215   0
1  179  36
early stop counter: 5
val acc:0.6661490797996521, best validation acc: 0.885869562625885, corresponding to test acc:                         0.8906976580619812 / 0.8906976580619812
after epoch: 28,now: 2024-07-20 11:58:21.451083,epoch time: 0:01:22.839490,used: 0:39:19.071358,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_11_19_02_seed_0_22478449
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9951172, 'precision': 0.9951124, 'recall': 0.99512064, 'specificity': 0.99512064, 'f1': 0.9951165, 'auroc': 0.99959683, 'binary_precision': 0.9954984, 'binary_recall': 0.9948586, 'binary_specificity': 0.9953826, 'binary_f1_score': 0.9951784}
confusion matrix:
      0     1
0  1509     7
1     8  1548
---- Validation: 
scalar performance:
{'acc': 0.8486025, 'precision': 0.8653046, 'recall': 0.8471078, 'specificity': 0.8471078, 'f1': 0.84643555, 'auroc': 0.93502605, 'binary_precision': 0.94, 'binary_recall': 0.7401575, 'binary_specificity': 0.9540582, 'binary_f1_score': 0.82819384}
confusion matrix:
     0    1
0  623   30
1  165  470
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.872093, 'precision': 0.890767, 'recall': 0.872093, 'specificity': 0.872093, 'f1': 0.87054646, 'auroc': 0.92785835, 'binary_precision': 0.97619045, 'binary_recall': 0.7627907, 'binary_specificity': 0.98139536, 'binary_f1_score': 0.85639685}
confusion matrix:
     0    1
0  211    4
1   51  164
early stop counter: 6
val acc:0.8486024737358093, best validation acc: 0.885869562625885, corresponding to test acc:                         0.8906976580619812 / 0.8906976580619812
after epoch: 29,now: 2024-07-20 11:59:43.304842,epoch time: 0:01:21.853759,used: 0:40:40.925117,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_11_19_02_seed_0_22478449
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.9944661, 'precision': 0.99455196, 'recall': 0.99441296, 'specificity': 0.99441296, 'f1': 0.99446464, 'auroc': 0.99994993, 'binary_precision': 0.9904337, 'binary_recall': 0.99871385, 'binary_specificity': 0.99011207, 'binary_f1_score': 0.9945565}
confusion matrix:
      0     1
0  1502    15
1     2  1553
---- Validation: 
scalar performance:
{'acc': 0.81832296, 'precision': 0.83989644, 'recall': 0.8165511, 'specificity': 0.8165511, 'f1': 0.8147856, 'auroc': 0.9233556, 'binary_precision': 0.92210525, 'binary_recall': 0.6897638, 'binary_specificity': 0.94333845, 'binary_f1_score': 0.78918916}
confusion matrix:
     0    1
0  616   37
1  197  438
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8418605, 'precision': 0.8568042, 'recall': 0.8418604, 'specificity': 0.8418604, 'f1': 0.84018713, 'auroc': 0.93018925, 'binary_precision': 0.9298246, 'binary_recall': 0.73953485, 'binary_specificity': 0.94418603, 'binary_f1_score': 0.8238342}
confusion matrix:
     0    1
0  203   12
1   56  159
early stop counter: 7
val acc:0.8183229565620422, best validation acc: 0.885869562625885, corresponding to test acc:                         0.8906976580619812 / 0.8906976580619812
after epoch: 30,now: 2024-07-20 12:01:07.833912,epoch time: 0:01:24.529070,used: 0:42:05.454187,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_11_19_02_seed_0_22478449
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 0:42:05.454187 at 2024-07-20 12:01:07.833912
persisted model performance metric: 

scalar performance:
{'acc': 0.89069766, 'precision': 0.90133333, 'recall': 0.8906977, 'specificity': 0.8906977, 'f1': 0.8899687, 'auroc': 0.93724173, 'binary_precision': 0.96666664, 'binary_recall': 0.80930233, 'binary_specificity': 0.97209305, 'binary_f1_score': 0.8810126}
confusion matrix:
     0    1
0  209    6
1   41  174
oracle model performance metric: 

scalar performance:
{'acc': 0.89069766, 'precision': 0.8979376, 'recall': 0.8906977, 'specificity': 0.8906977, 'f1': 0.89019823, 'auroc': 0.9342996, 'binary_precision': 0.9516129, 'binary_recall': 0.82325584, 'binary_specificity': 0.95813954, 'binary_f1_score': 0.882793}
confusion matrix:
     0    1
0  206    9
1   38  177
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_nofreeze_2024-07-19_18-41-07/rule_results/5.csv
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_nofreeze_2024-07-19_18-41-07/rule_results/5.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_nofreeze_2024-07-19_18-41-07/confusion_matrix/5.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 455454 KiB |  13219 MiB |  74552 GiB |  74552 GiB |
|       from large pool | 414861 KiB |  13181 MiB |  73670 GiB |  73670 GiB |
|       from small pool |  40592 KiB |     56 MiB |    881 GiB |    881 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 455454 KiB |  13219 MiB |  74552 GiB |  74552 GiB |
|       from large pool | 414861 KiB |  13181 MiB |  73670 GiB |  73670 GiB |
|       from small pool |  40592 KiB |     56 MiB |    881 GiB |    881 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 447480 KiB |  13213 MiB |  74062 GiB |  74061 GiB |
|       from large pool | 407075 KiB |  13175 MiB |  73181 GiB |  73181 GiB |
|       from small pool |  40405 KiB |     56 MiB |    880 GiB |    880 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  14480 MiB |  14480 MiB |  14480 MiB |      0 B   |
|       from large pool |  14414 MiB |  14414 MiB |  14414 MiB |      0 B   |
|       from small pool |     66 MiB |     66 MiB |     66 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory | 447714 KiB |   1252 MiB |  53223 GiB |  53222 GiB |
|       from large pool | 435058 KiB |   1243 MiB |  52338 GiB |  52337 GiB |
|       from small pool |  12655 KiB |     17 MiB |    885 GiB |    885 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    1298    |    2594    |   13012 K  |   13011 K  |
|       from large pool |     187    |    1413    |    6632 K  |    6632 K  |
|       from small pool |    1111    |    1407    |    6380 K  |    6378 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    1298    |    2594    |   13012 K  |   13011 K  |
|       from large pool |     187    |    1413    |    6632 K  |    6632 K  |
|       from small pool |    1111    |    1407    |    6380 K  |    6378 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     634    |     634    |     634    |       0    |
|       from large pool |     601    |     601    |     601    |       0    |
|       from small pool |      33    |      33    |      33    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      98    |     649    |    8630 K  |    8630 K  |
|       from large pool |      37    |     600    |    4956 K  |    4955 K  |
|       from small pool |      61    |     238    |    3674 K  |    3674 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13219 MiB |  74552 GiB |  74552 GiB |
|       from large pool |  16640 KiB |  13181 MiB |  73670 GiB |  73670 GiB |
|       from small pool |      0 KiB |     56 MiB |    881 GiB |    881 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13219 MiB |  74552 GiB |  74552 GiB |
|       from large pool |  16640 KiB |  13181 MiB |  73670 GiB |  73670 GiB |
|       from small pool |      0 KiB |     56 MiB |    881 GiB |    881 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13213 MiB |  74062 GiB |  74062 GiB |
|       from large pool |  16640 KiB |  13175 MiB |  73181 GiB |  73181 GiB |
|       from small pool |      0 KiB |     56 MiB |    880 GiB |    880 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    882 MiB |  14480 MiB |  14480 MiB |  13598 MiB |
|       from large pool |    830 MiB |  14414 MiB |  14414 MiB |  13584 MiB |
|       from small pool |     52 MiB |     66 MiB |     66 MiB |     14 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1252 MiB |  53223 GiB |  53223 GiB |
|       from large pool |  24320 KiB |   1243 MiB |  52338 GiB |  52338 GiB |
|       from small pool |      0 KiB |     45 MiB |    885 GiB |    885 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    2594    |   13012 K  |   13012 K  |
|       from large pool |       2    |    1413    |    6632 K  |    6632 K  |
|       from small pool |       0    |    1407    |    6380 K  |    6380 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    2594    |   13012 K  |   13012 K  |
|       from large pool |       2    |    1413    |    6632 K  |    6632 K  |
|       from small pool |       0    |    1407    |    6380 K  |    6380 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      63    |     634    |     634    |     571    |
|       from large pool |      37    |     601    |     601    |     564    |
|       from small pool |      26    |      33    |      33    |       7    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |     649    |    8630 K  |    8630 K  |
|       from large pool |       4    |     600    |    4956 K  |    4956 K  |
|       from small pool |       0    |     238    |    3674 K  |    3674 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13219 MiB |  74552 GiB |  74552 GiB |
|       from large pool |  16640 KiB |  13181 MiB |  73670 GiB |  73670 GiB |
|       from small pool |      0 KiB |     56 MiB |    881 GiB |    881 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13219 MiB |  74552 GiB |  74552 GiB |
|       from large pool |  16640 KiB |  13181 MiB |  73670 GiB |  73670 GiB |
|       from small pool |      0 KiB |     56 MiB |    881 GiB |    881 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13213 MiB |  74062 GiB |  74062 GiB |
|       from large pool |  16640 KiB |  13175 MiB |  73181 GiB |  73181 GiB |
|       from small pool |      0 KiB |     56 MiB |    880 GiB |    880 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    882 MiB |  14480 MiB |  14480 MiB |  13598 MiB |
|       from large pool |    830 MiB |  14414 MiB |  14414 MiB |  13584 MiB |
|       from small pool |     52 MiB |     66 MiB |     66 MiB |     14 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1252 MiB |  53223 GiB |  53223 GiB |
|       from large pool |  24320 KiB |   1243 MiB |  52338 GiB |  52338 GiB |
|       from small pool |      0 KiB |     45 MiB |    885 GiB |    885 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    2594    |   13012 K  |   13012 K  |
|       from large pool |       2    |    1413    |    6632 K  |    6632 K  |
|       from small pool |       0    |    1407    |    6380 K  |    6380 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    2594    |   13012 K  |   13012 K  |
|       from large pool |       2    |    1413    |    6632 K  |    6632 K  |
|       from small pool |       0    |    1407    |    6380 K  |    6380 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      63    |     634    |     634    |     571    |
|       from large pool |      37    |     601    |     601    |     564    |
|       from small pool |      26    |      33    |      33    |       7    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |     649    |    8630 K  |    8630 K  |
|       from large pool |       4    |     600    |    4956 K  |    4956 K  |
|       from small pool |       0    |     238    |    3674 K  |    3674 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'888c1ef2'
model name: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_12_02_26_seed_1_22478449

 Experiment start at: 2024-07-20 12:02:26.320535
before training, model accuracy: 0.6177777647972107
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9472656, 'precision': 0.9480994, 'recall': 0.9469976, 'specificity': 0.9469976, 'f1': 0.9472097, 'auroc': 0.9882486, 'binary_precision': 0.9318885, 'binary_recall': 0.96660244, 'binary_specificity': 0.9273927, 'binary_f1_score': 0.9489281}
confusion matrix:
      0     1
0  1405   110
1    52  1505
---- Validation: 
scalar performance:
{'acc': 0.80796254, 'precision': 0.8190584, 'recall': 0.8094726, 'specificity': 0.8094726, 'f1': 0.80676126, 'auroc': 0.9166386, 'binary_precision': 0.7553192, 'binary_recall': 0.9015873, 'binary_specificity': 0.71735793, 'binary_f1_score': 0.8219971}
confusion matrix:
     0    1
0  467  184
1   62  568
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7777778, 'precision': 0.78989464, 'recall': 0.7777778, 'specificity': 0.7777778, 'f1': 0.77543116, 'auroc': 0.9177877, 'binary_precision': 0.7306273, 'binary_recall': 0.88, 'binary_specificity': 0.6755555, 'binary_f1_score': 0.7983871}
confusion matrix:
     0    1
0  152   73
1   27  198
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-20 12:03:55.870883,epoch time: 0:01:29.550348,used: 0:01:29.550348,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_12_02_26_seed_1_22478449
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9638672, 'precision': 0.96419525, 'recall': 0.96372116, 'specificity': 0.96372116, 'f1': 0.9638468, 'auroc': 0.9941956, 'binary_precision': 0.9546885, 'binary_recall': 0.9749357, 'binary_specificity': 0.9525066, 'binary_f1_score': 0.9647059}
confusion matrix:
      0     1
0  1444    72
1    39  1517
---- Validation: 
scalar performance:
{'acc': 0.8227947, 'precision': 0.829613, 'recall': 0.82396317, 'specificity': 0.82396317, 'f1': 0.8222014, 'auroc': 0.9121541, 'binary_precision': 0.77793103, 'binary_recall': 0.8952381, 'binary_specificity': 0.75268817, 'binary_f1_score': 0.8324723}
confusion matrix:
     0    1
0  490  161
1   66  564
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.81333333, 'precision': 0.8235594, 'recall': 0.81333333, 'specificity': 0.81333333, 'f1': 0.81184673, 'auroc': 0.92397034, 'binary_precision': 0.76603776, 'binary_recall': 0.9022222, 'binary_specificity': 0.72444445, 'binary_f1_score': 0.82857144}
confusion matrix:
     0    1
0  163   62
1   22  203
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-07-20 12:05:19.946951,epoch time: 0:01:24.076068,used: 0:02:53.626416,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_12_02_26_seed_1_22478449
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.96809894, 'precision': 0.9688931, 'recall': 0.9684224, 'specificity': 0.9684224, 'f1': 0.9680955, 'auroc': 0.9971774, 'binary_precision': 0.9919083, 'binary_recall': 0.94476557, 'binary_specificity': 0.9920792, 'binary_f1_score': 0.9677631}
confusion matrix:
      0     1
0  1503    12
1    86  1471
---- Validation: 
scalar performance:
{'acc': 0.8610461, 'precision': 0.86503124, 'recall': 0.86018944, 'specificity': 0.86018944, 'f1': 0.86043155, 'auroc': 0.9164704, 'binary_precision': 0.8992933, 'binary_recall': 0.8079365, 'binary_specificity': 0.9124424, 'binary_f1_score': 0.85117054}
confusion matrix:
     0    1
0  594   57
1  121  509
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.85333335, 'precision': 0.85344505, 'recall': 0.85333335, 'specificity': 0.85333335, 'f1': 0.8533218, 'auroc': 0.91976297, 'binary_precision': 0.8597285, 'binary_recall': 0.84444445, 'binary_specificity': 0.8622222, 'binary_f1_score': 0.85201794}
confusion matrix:
     0    1
0  194   31
1   35  190
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-07-20 12:07:17.025441,epoch time: 0:01:57.078490,used: 0:04:50.704906,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_12_02_26_seed_1_22478449
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9814453, 'precision': 0.9815349, 'recall': 0.98158205, 'specificity': 0.98158205, 'f1': 0.9814452, 'auroc': 0.998345, 'binary_precision': 0.9921208, 'binary_recall': 0.9710797, 'binary_specificity': 0.99208444, 'binary_f1_score': 0.98148745}
confusion matrix:
      0     1
0  1504    12
1    45  1511
---- Validation: 
scalar performance:
{'acc': 0.8251366, 'precision': 0.845844, 'recall': 0.82311827, 'specificity': 0.82311827, 'f1': 0.8218111, 'auroc': 0.9058908, 'binary_precision': 0.9264706, 'binary_recall': 0.7, 'binary_specificity': 0.94623655, 'binary_f1_score': 0.79746836}
confusion matrix:
     0    1
0  616   35
1  189  441
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8688889, 'precision': 0.87803644, 'recall': 0.86888885, 'specificity': 0.86888885, 'f1': 0.8680909, 'auroc': 0.9257284, 'binary_precision': 0.9368421, 'binary_recall': 0.7911111, 'binary_specificity': 0.94666666, 'binary_f1_score': 0.85783136}
confusion matrix:
     0    1
0  213   12
1   47  178
new oracle model saved
early stop counter: 1
val acc:0.8251366019248962, best validation acc: 0.8610460758209229, corresponding to test acc:                         0.8533333539962769 / 0.8688889145851135
after epoch: 4,now: 2024-07-20 12:08:42.853816,epoch time: 0:01:25.828375,used: 0:06:16.533281,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_12_02_26_seed_1_22478449
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.97265625, 'precision': 0.9729638, 'recall': 0.97286355, 'specificity': 0.97286355, 'f1': 0.97265595, 'auroc': 0.99731827, 'binary_precision': 0.98871183, 'binary_recall': 0.9569409, 'binary_specificity': 0.9887863, 'binary_f1_score': 0.97256696}
confusion matrix:
      0     1
0  1499    17
1    67  1489
---- Validation: 
scalar performance:
{'acc': 0.85870415, 'precision': 0.86467946, 'recall': 0.8576549, 'specificity': 0.8576549, 'f1': 0.8578378, 'auroc': 0.9187063, 'binary_precision': 0.907441, 'binary_recall': 0.7936508, 'binary_specificity': 0.921659, 'binary_f1_score': 0.84674007}
confusion matrix:
     0    1
0  600   51
1  130  500
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.82666665, 'precision': 0.8422425, 'recall': 0.8266667, 'specificity': 0.8266667, 'f1': 0.8246718, 'auroc': 0.9053432, 'binary_precision': 0.91525424, 'binary_recall': 0.72, 'binary_specificity': 0.93333334, 'binary_f1_score': 0.80597013}
confusion matrix:
     0    1
0  210   15
1   63  162
early stop counter: 2
val acc:0.858704149723053, best validation acc: 0.8610460758209229, corresponding to test acc:                         0.8533333539962769 / 0.8688889145851135
after epoch: 5,now: 2024-07-20 12:10:07.680790,epoch time: 0:01:24.826974,used: 0:07:41.360255,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_12_02_26_seed_1_22478449
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.98535156, 'precision': 0.9854102, 'recall': 0.9854931, 'specificity': 0.9854931, 'f1': 0.9853513, 'auroc': 0.9987816, 'binary_precision': 0.99541587, 'binary_recall': 0.9756098, 'binary_specificity': 0.99537647, 'binary_f1_score': 0.9854133}
confusion matrix:
      0     1
0  1507     7
1    38  1520
---- Validation: 
scalar performance:
{'acc': 0.8657299, 'precision': 0.868855, 'recall': 0.864977, 'specificity': 0.864977, 'f1': 0.865243, 'auroc': 0.9218199, 'binary_precision': 0.8989547, 'binary_recall': 0.81904763, 'binary_specificity': 0.9109063, 'binary_f1_score': 0.85714287}
confusion matrix:
     0    1
0  593   58
1  114  516
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8577778, 'precision': 0.8591683, 'recall': 0.8577778, 'specificity': 0.8577778, 'f1': 0.85763997, 'auroc': 0.9114865, 'binary_precision': 0.8815166, 'binary_recall': 0.82666665, 'binary_specificity': 0.8888889, 'binary_f1_score': 0.853211}
confusion matrix:
     0    1
0  200   25
1   39  186
better model found
persisted
after epoch: 6,now: 2024-07-20 12:11:31.894475,epoch time: 0:01:24.213685,used: 0:09:05.573940,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_12_02_26_seed_1_22478449
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9703776, 'precision': 0.9714973, 'recall': 0.9701179, 'specificity': 0.9701179, 'f1': 0.97034425, 'auroc': 0.99795115, 'binary_precision': 0.9512647, 'binary_recall': 0.992278, 'binary_specificity': 0.9479578, 'binary_f1_score': 0.97133857}
confusion matrix:
      0     1
0  1439    79
1    12  1542
---- Validation: 
scalar performance:
{'acc': 0.88056207, 'precision': 0.8820554, 'recall': 0.8800563, 'specificity': 0.8800563, 'f1': 0.8803167, 'auroc': 0.9254992, 'binary_precision': 0.90219223, 'binary_recall': 0.8492063, 'binary_specificity': 0.9109063, 'binary_f1_score': 0.8748978}
confusion matrix:
     0    1
0  593   58
1   95  535
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8377778, 'precision': 0.83890915, 'recall': 0.8377778, 'specificity': 0.8377778, 'f1': 0.8376423, 'auroc': 0.921679, 'binary_precision': 0.8193277, 'binary_recall': 0.8666667, 'binary_specificity': 0.8088889, 'binary_f1_score': 0.8423326}
confusion matrix:
     0    1
0  182   43
1   30  195
better model found
persisted
after epoch: 7,now: 2024-07-20 12:12:57.648278,epoch time: 0:01:25.753803,used: 0:10:31.327743,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_12_02_26_seed_1_22478449
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9485677, 'precision': 0.9525748, 'recall': 0.94798243, 'specificity': 0.94798243, 'f1': 0.94839835, 'auroc': 0.9971949, 'binary_precision': 0.91312057, 'binary_recall': 0.9929306, 'binary_specificity': 0.9030343, 'binary_f1_score': 0.9513547}
confusion matrix:
      0     1
0  1369   147
1    11  1545
---- Validation: 
scalar performance:
{'acc': 0.87119436, 'precision': 0.8732869, 'recall': 0.8705837, 'specificity': 0.8705837, 'f1': 0.8708515, 'auroc': 0.9217906, 'binary_precision': 0.8974359, 'binary_recall': 0.8333333, 'binary_specificity': 0.9078341, 'binary_f1_score': 0.86419755}
confusion matrix:
     0    1
0  591   60
1  105  525
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8688889, 'precision': 0.8715383, 'recall': 0.86888885, 'specificity': 0.86888885, 'f1': 0.8686547, 'auroc': 0.92570865, 'binary_precision': 0.9029126, 'binary_recall': 0.82666665, 'binary_specificity': 0.9111111, 'binary_f1_score': 0.86310905}
confusion matrix:
     0    1
0  205   20
1   39  186
early stop counter: 1
val acc:0.8711943626403809, best validation acc: 0.8805620670318604, corresponding to test acc:                         0.8377777934074402 / 0.8688889145851135
after epoch: 8,now: 2024-07-20 12:14:21.745103,epoch time: 0:01:24.096825,used: 0:11:55.424568,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_12_02_26_seed_1_22478449
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.984375, 'precision': 0.984362, 'recall': 0.9844072, 'specificity': 0.9844072, 'f1': 0.9843742, 'auroc': 0.99885213, 'binary_precision': 0.98767835, 'binary_recall': 0.9813144, 'binary_specificity': 0.9875, 'binary_f1_score': 0.98448616}
confusion matrix:
      0     1
0  1501    19
1    29  1523
---- Validation: 
scalar performance:
{'acc': 0.78142077, 'precision': 0.83126485, 'recall': 0.778213, 'specificity': 0.778213, 'f1': 0.7714937, 'auroc': 0.9068686, 'binary_precision': 0.9557292, 'binary_recall': 0.5825397, 'binary_specificity': 0.9738863, 'binary_f1_score': 0.7238659}
confusion matrix:
     0    1
0  634   17
1  263  367
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8288889, 'precision': 0.86525977, 'recall': 0.8288889, 'specificity': 0.8288889, 'f1': 0.82452047, 'auroc': 0.92665684, 'binary_precision': 0.9805195, 'binary_recall': 0.6711111, 'binary_specificity': 0.9866667, 'binary_f1_score': 0.7968337}
confusion matrix:
     0    1
0  222    3
1   74  151
early stop counter: 2
val acc:0.7814207673072815, best validation acc: 0.8805620670318604, corresponding to test acc:                         0.8377777934074402 / 0.8688889145851135
after epoch: 9,now: 2024-07-20 12:15:46.176956,epoch time: 0:01:24.431853,used: 0:13:19.856421,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_12_02_26_seed_1_22478449
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.98046875, 'precision': 0.98062515, 'recall': 0.98038065, 'specificity': 0.98038065, 'f1': 0.9804613, 'auroc': 0.99881804, 'binary_precision': 0.97461927, 'binary_recall': 0.98714656, 'binary_specificity': 0.97361475, 'binary_f1_score': 0.98084295}
confusion matrix:
      0     1
0  1476    40
1    20  1536
---- Validation: 
scalar performance:
{'acc': 0.86260736, 'precision': 0.8673804, 'recall': 0.8616743, 'specificity': 0.8616743, 'f1': 0.86191046, 'auroc': 0.91841125, 'binary_precision': 0.9053571, 'binary_recall': 0.8047619, 'binary_specificity': 0.9185868, 'binary_f1_score': 0.85210085}
confusion matrix:
     0    1
0  598   53
1  123  507
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8244445, 'precision': 0.8355876, 'recall': 0.8244444, 'specificity': 0.8244444, 'f1': 0.8229749, 'auroc': 0.9097284, 'binary_precision': 0.8967391, 'binary_recall': 0.73333335, 'binary_specificity': 0.91555554, 'binary_f1_score': 0.80684596}
confusion matrix:
     0    1
0  206   19
1   60  165
early stop counter: 3
val acc:0.8626073598861694, best validation acc: 0.8805620670318604, corresponding to test acc:                         0.8377777934074402 / 0.8688889145851135
after epoch: 10,now: 2024-07-20 12:17:10.363514,epoch time: 0:01:24.186558,used: 0:14:44.042979,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_12_02_26_seed_1_22478449
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.98860675, 'precision': 0.9886949, 'recall': 0.9885467, 'specificity': 0.9885467, 'f1': 0.9886031, 'auroc': 0.99945223, 'binary_precision': 0.9847134, 'binary_recall': 0.9929351, 'binary_specificity': 0.9841584, 'binary_f1_score': 0.98880714}
confusion matrix:
      0     1
0  1491    24
1    11  1546
---- Validation: 
scalar performance:
{'acc': 0.84543324, 'precision': 0.8573415, 'recall': 0.8439324, 'specificity': 0.8439324, 'f1': 0.8436973, 'auroc': 0.9183308, 'binary_precision': 0.9186047, 'binary_recall': 0.75238097, 'binary_specificity': 0.9354839, 'binary_f1_score': 0.8272251}
confusion matrix:
     0    1
0  609   42
1  156  474
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.87333333, 'precision': 0.89192104, 'recall': 0.87333333, 'specificity': 0.87333333, 'f1': 0.8718134, 'auroc': 0.9510124, 'binary_precision': 0.97727275, 'binary_recall': 0.7644445, 'binary_specificity': 0.9822222, 'binary_f1_score': 0.8578554}
confusion matrix:
     0    1
0  221    4
1   53  172
new oracle model saved
early stop counter: 4
val acc:0.845433235168457, best validation acc: 0.8805620670318604, corresponding to test acc:                         0.8377777934074402 / 0.8733333349227905
after epoch: 11,now: 2024-07-20 12:18:35.965620,epoch time: 0:01:25.602106,used: 0:16:09.645085,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_12_02_26_seed_1_22478449
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9892578, 'precision': 0.9894205, 'recall': 0.9891808, 'specificity': 0.9891808, 'f1': 0.98925436, 'auroc': 0.99940485, 'binary_precision': 0.98284626, 'binary_recall': 0.9961365, 'binary_specificity': 0.9822251, 'binary_f1_score': 0.98944676}
confusion matrix:
      0     1
0  1492    27
1     6  1547
---- Validation: 
scalar performance:
{'acc': 0.86416864, 'precision': 0.87508696, 'recall': 0.8627752, 'specificity': 0.8627752, 'f1': 0.86282027, 'auroc': 0.92620635, 'binary_precision': 0.9351145, 'binary_recall': 0.7777778, 'binary_specificity': 0.9477727, 'binary_f1_score': 0.84922016}
confusion matrix:
     0    1
0  617   34
1  140  490
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8511111, 'precision': 0.87518996, 'recall': 0.8511111, 'specificity': 0.8511111, 'f1': 0.84868336, 'auroc': 0.9355456, 'binary_precision': 0.9702381, 'binary_recall': 0.72444445, 'binary_specificity': 0.9777778, 'binary_f1_score': 0.82951653}
confusion matrix:
     0    1
0  220    5
1   62  163
early stop counter: 5
val acc:0.864168643951416, best validation acc: 0.8805620670318604, corresponding to test acc:                         0.8377777934074402 / 0.8733333349227905
after epoch: 12,now: 2024-07-20 12:20:00.064520,epoch time: 0:01:24.098900,used: 0:17:33.743985,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_12_02_26_seed_1_22478449
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.976237, 'precision': 0.97717535, 'recall': 0.9759699, 'specificity': 0.9759699, 'f1': 0.9762113, 'auroc': 0.99941075, 'binary_precision': 0.9591584, 'binary_recall': 0.9955042, 'binary_specificity': 0.9564356, 'binary_f1_score': 0.97699344}
confusion matrix:
      0     1
0  1449    66
1     7  1550
---- Validation: 
scalar performance:
{'acc': 0.8501171, 'precision': 0.85867065, 'recall': 0.8488479, 'specificity': 0.8488479, 'f1': 0.8488562, 'auroc': 0.9186648, 'binary_precision': 0.9101124, 'binary_recall': 0.7714286, 'binary_specificity': 0.92626727, 'binary_f1_score': 0.83505154}
confusion matrix:
     0    1
0  603   48
1  144  486
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.88222224, 'precision': 0.8981482, 'recall': 0.8822222, 'specificity': 0.8822222, 'f1': 0.88103247, 'auroc': 0.94206417, 'binary_precision': 0.9777778, 'binary_recall': 0.7822222, 'binary_specificity': 0.9822222, 'binary_f1_score': 0.86913574}
confusion matrix:
     0    1
0  221    4
1   49  176
new oracle model saved
early stop counter: 6
val acc:0.8501170873641968, best validation acc: 0.8805620670318604, corresponding to test acc:                         0.8377777934074402 / 0.8822222352027893
after epoch: 13,now: 2024-07-20 12:21:24.628225,epoch time: 0:01:24.563705,used: 0:18:58.307690,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_12_02_26_seed_1_22478449
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.98372394, 'precision': 0.983963, 'recall': 0.983611, 'specificity': 0.983611, 'f1': 0.9837165, 'auroc': 0.9988245, 'binary_precision': 0.97597975, 'binary_recall': 0.99228793, 'binary_specificity': 0.97493404, 'binary_f1_score': 0.9840663}
confusion matrix:
      0     1
0  1478    38
1    12  1544
---- Validation: 
scalar performance:
{'acc': 0.8813427, 'precision': 0.8839946, 'recall': 0.8806708, 'specificity': 0.8806708, 'f1': 0.8809771, 'auroc': 0.93257016, 'binary_precision': 0.91206896, 'binary_recall': 0.8396825, 'binary_specificity': 0.921659, 'binary_f1_score': 0.8743802}
confusion matrix:
     0    1
0  600   51
1  101  529
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.86, 'precision': 0.86034876, 'recall': 0.86, 'specificity': 0.86, 'f1': 0.8599661, 'auroc': 0.9206519, 'binary_precision': 0.8715596, 'binary_recall': 0.84444445, 'binary_specificity': 0.8755556, 'binary_f1_score': 0.8577878}
confusion matrix:
     0    1
0  197   28
1   35  190
better model found
persisted
after epoch: 14,now: 2024-07-20 12:22:49.947191,epoch time: 0:01:25.318966,used: 0:20:23.626656,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_12_02_26_seed_1_22478449
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9817708, 'precision': 0.98209095, 'recall': 0.98164624, 'specificity': 0.98164624, 'f1': 0.9817619, 'auroc': 0.99892116, 'binary_precision': 0.97225726, 'binary_recall': 0.992278, 'binary_specificity': 0.9710145, 'binary_f1_score': 0.9821656}
confusion matrix:
      0     1
0  1474    44
1    12  1542
---- Validation: 
scalar performance:
{'acc': 0.8680718, 'precision': 0.8690902, 'recall': 0.86763954, 'specificity': 0.86763954, 'f1': 0.8678541, 'auroc': 0.90996814, 'binary_precision': 0.884808, 'binary_recall': 0.84126985, 'binary_specificity': 0.89400923, 'binary_f1_score': 0.8624899}
confusion matrix:
     0    1
0  582   69
1  100  530
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8377778, 'precision': 0.83928573, 'recall': 0.83777773, 'specificity': 0.83777773, 'f1': 0.8375973, 'auroc': 0.91851854, 'binary_precision': 0.81666666, 'binary_recall': 0.8711111, 'binary_specificity': 0.80444443, 'binary_f1_score': 0.8430107}
confusion matrix:
     0    1
0  181   44
1   29  196
early stop counter: 1
val acc:0.8680717945098877, best validation acc: 0.8813427090644836, corresponding to test acc:                         0.8600000143051147 / 0.8822222352027893
after epoch: 15,now: 2024-07-20 12:24:14.080760,epoch time: 0:01:24.133569,used: 0:21:47.760225,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_12_02_26_seed_1_22478449
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9876302, 'precision': 0.98763716, 'recall': 0.98761904, 'specificity': 0.98761904, 'f1': 0.9876277, 'auroc': 0.9996121, 'binary_precision': 0.9871713, 'binary_recall': 0.9884393, 'binary_specificity': 0.9867987, 'binary_f1_score': 0.9878049}
confusion matrix:
      0     1
0  1495    20
1    18  1539
---- Validation: 
scalar performance:
{'acc': 0.8790008, 'precision': 0.88743126, 'recall': 0.8778033, 'specificity': 0.8778033, 'f1': 0.8780687, 'auroc': 0.93060255, 'binary_precision': 0.9406308, 'binary_recall': 0.8047619, 'binary_specificity': 0.9508448, 'binary_f1_score': 0.86740804}
confusion matrix:
     0    1
0  619   32
1  123  507
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8488889, 'precision': 0.86857533, 'recall': 0.8488889, 'specificity': 0.8488889, 'f1': 0.8468438, 'auroc': 0.9184197, 'binary_precision': 0.9537572, 'binary_recall': 0.73333335, 'binary_specificity': 0.96444446, 'binary_f1_score': 0.8291457}
confusion matrix:
     0    1
0  217    8
1   60  165
early stop counter: 2
val acc:0.8790007829666138, best validation acc: 0.8813427090644836, corresponding to test acc:                         0.8600000143051147 / 0.8822222352027893
after epoch: 16,now: 2024-07-20 12:25:38.671868,epoch time: 0:01:24.591108,used: 0:23:12.351333,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_12_02_26_seed_1_22478449
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9876302, 'precision': 0.9877656, 'recall': 0.987797, 'specificity': 0.987797, 'f1': 0.98763025, 'auroc': 0.9996753, 'binary_precision': 1.0, 'binary_recall': 0.9755941, 'binary_specificity': 1.0, 'binary_f1_score': 0.98764634}
confusion matrix:
      0     1
0  1515     0
1    38  1519
---- Validation: 
scalar performance:
{'acc': 0.8235753, 'precision': 0.8537029, 'recall': 0.82117254, 'specificity': 0.82117254, 'f1': 0.8189383, 'auroc': 0.92699754, 'binary_precision': 0.9529148, 'binary_recall': 0.67460316, 'binary_specificity': 0.9677419, 'binary_f1_score': 0.78996277}
confusion matrix:
     0    1
0  630   21
1  205  425
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.81777775, 'precision': 0.85183156, 'recall': 0.81777775, 'specificity': 0.81777775, 'f1': 0.8132591, 'auroc': 0.9115457, 'binary_precision': 0.9612903, 'binary_recall': 0.6622222, 'binary_specificity': 0.97333336, 'binary_f1_score': 0.7842105}
confusion matrix:
     0    1
0  219    6
1   76  149
early stop counter: 3
val acc:0.8235753178596497, best validation acc: 0.8813427090644836, corresponding to test acc:                         0.8600000143051147 / 0.8822222352027893
after epoch: 17,now: 2024-07-20 12:27:03.253801,epoch time: 0:01:24.581933,used: 0:24:36.933266,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_12_02_26_seed_1_22478449
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.98860675, 'precision': 0.9886192, 'recall': 0.9885913, 'specificity': 0.9885913, 'f1': 0.9886043, 'auroc': 0.9995591, 'binary_precision': 0.9878205, 'binary_recall': 0.9897238, 'binary_specificity': 0.98745877, 'binary_f1_score': 0.98877126}
confusion matrix:
      0     1
0  1496    19
1    16  1541
---- Validation: 
scalar performance:
{'acc': 0.8696331, 'precision': 0.87613845, 'recall': 0.8685612, 'specificity': 0.8685612, 'f1': 0.8688013, 'auroc': 0.91697514, 'binary_precision': 0.9216758, 'binary_recall': 0.8031746, 'binary_specificity': 0.9339478, 'binary_f1_score': 0.85835457}
confusion matrix:
     0    1
0  608   43
1  124  506
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.85555553, 'precision': 0.8643725, 'recall': 0.85555553, 'specificity': 0.85555553, 'f1': 0.8546765, 'auroc': 0.9212049, 'binary_precision': 0.92105263, 'binary_recall': 0.7777778, 'binary_specificity': 0.93333334, 'binary_f1_score': 0.84337354}
confusion matrix:
     0    1
0  210   15
1   50  175
early stop counter: 4
val acc:0.8696330785751343, best validation acc: 0.8813427090644836, corresponding to test acc:                         0.8600000143051147 / 0.8822222352027893
after epoch: 18,now: 2024-07-20 12:28:28.908627,epoch time: 0:01:25.654826,used: 0:26:02.588092,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_12_02_26_seed_1_22478449
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9905599, 'precision': 0.99056256, 'recall': 0.9905541, 'specificity': 0.9905541, 'f1': 0.9905582, 'auroc': 0.99950945, 'binary_precision': 0.9903661, 'binary_recall': 0.99100256, 'binary_specificity': 0.99010557, 'binary_f1_score': 0.9906842}
confusion matrix:
      0     1
0  1501    15
1    14  1542
---- Validation: 
scalar performance:
{'acc': 0.8469945, 'precision': 0.8646983, 'recall': 0.8451869, 'specificity': 0.8451869, 'f1': 0.84460044, 'auroc': 0.9204502, 'binary_precision': 0.9410569, 'binary_recall': 0.7349206, 'binary_specificity': 0.95545316, 'binary_f1_score': 0.82531196}
confusion matrix:
     0    1
0  622   29
1  167  463
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.83555555, 'precision': 0.8631282, 'recall': 0.83555555, 'specificity': 0.83555555, 'f1': 0.8323735, 'auroc': 0.92077035, 'binary_precision': 0.9631902, 'binary_recall': 0.69777775, 'binary_specificity': 0.97333336, 'binary_f1_score': 0.8092783}
confusion matrix:
     0    1
0  219    6
1   68  157
early stop counter: 5
val acc:0.8469945192337036, best validation acc: 0.8813427090644836, corresponding to test acc:                         0.8600000143051147 / 0.8822222352027893
after epoch: 19,now: 2024-07-20 12:29:53.390912,epoch time: 0:01:24.482285,used: 0:27:27.070377,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_12_02_26_seed_1_22478449
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.98828125, 'precision': 0.98827964, 'recall': 0.98827964, 'specificity': 0.98827964, 'f1': 0.98827964, 'auroc': 0.99949265, 'binary_precision': 0.98841697, 'binary_recall': 0.98841697, 'binary_specificity': 0.9881423, 'binary_f1_score': 0.98841697}
confusion matrix:
      0     1
0  1500    18
1    18  1536
---- Validation: 
scalar performance:
{'acc': 0.8594848, 'precision': 0.8723918, 'recall': 0.85796213, 'specificity': 0.85796213, 'f1': 0.857859, 'auroc': 0.92749494, 'binary_precision': 0.9377432, 'binary_recall': 0.7650794, 'binary_specificity': 0.9508448, 'binary_f1_score': 0.8426574}
confusion matrix:
     0    1
0  619   32
1  148  482
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8155556, 'precision': 0.855, 'recall': 0.8155556, 'specificity': 0.8155556, 'f1': 0.8102857, 'auroc': 0.929837, 'binary_precision': 0.97333336, 'binary_recall': 0.6488889, 'binary_specificity': 0.9822222, 'binary_f1_score': 0.7786667}
confusion matrix:
     0    1
0  221    4
1   79  146
early stop counter: 6
val acc:0.8594847917556763, best validation acc: 0.8813427090644836, corresponding to test acc:                         0.8600000143051147 / 0.8822222352027893
after epoch: 20,now: 2024-07-20 12:31:18.528601,epoch time: 0:01:25.137689,used: 0:28:52.208066,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_12_02_26_seed_1_22478449
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.98828125, 'precision': 0.988262, 'recall': 0.98831165, 'specificity': 0.98831165, 'f1': 0.9882801, 'auroc': 0.9992848, 'binary_precision': 0.9909502, 'binary_recall': 0.98585206, 'binary_specificity': 0.99077123, 'binary_f1_score': 0.98839456}
confusion matrix:
      0     1
0  1503    14
1    22  1533
---- Validation: 
scalar performance:
{'acc': 0.84387195, 'precision': 0.8540958, 'recall': 0.84247315, 'specificity': 0.84247315, 'f1': 0.8423222, 'auroc': 0.915695, 'binary_precision': 0.9103053, 'binary_recall': 0.75714284, 'binary_specificity': 0.9278034, 'binary_f1_score': 0.8266898}
confusion matrix:
     0    1
0  604   47
1  153  477
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.83111113, 'precision': 0.8455545, 'recall': 0.8311111, 'specificity': 0.8311111, 'f1': 0.82932764, 'auroc': 0.8993975, 'binary_precision': 0.9162011, 'binary_recall': 0.72888887, 'binary_specificity': 0.93333334, 'binary_f1_score': 0.8118811}
confusion matrix:
     0    1
0  210   15
1   61  164
early stop counter: 7
val acc:0.8438719511032104, best validation acc: 0.8813427090644836, corresponding to test acc:                         0.8600000143051147 / 0.8822222352027893
after epoch: 21,now: 2024-07-20 12:32:44.378117,epoch time: 0:01:25.849516,used: 0:30:18.057582,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_12_02_26_seed_1_22478449
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.99153644, 'precision': 0.99151254, 'recall': 0.99160004, 'specificity': 0.99160004, 'f1': 0.9915356, 'auroc': 0.9993616, 'binary_precision': 0.996114, 'binary_recall': 0.987163, 'binary_specificity': 0.996037, 'binary_f1_score': 0.9916183}
confusion matrix:
      0     1
0  1508     6
1    20  1538
---- Validation: 
scalar performance:
{'acc': 0.8508977, 'precision': 0.87311864, 'recall': 0.8488991, 'specificity': 0.8488991, 'f1': 0.84809506, 'auroc': 0.93324125, 'binary_precision': 0.9601677, 'binary_recall': 0.72698414, 'binary_specificity': 0.9708141, 'binary_f1_score': 0.8274616}
confusion matrix:
     0    1
0  632   19
1  172  458
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.83111113, 'precision': 0.86439425, 'recall': 0.8311111, 'specificity': 0.8311111, 'f1': 0.8271645, 'auroc': 0.9329382, 'binary_precision': 0.9745223, 'binary_recall': 0.68, 'binary_specificity': 0.9822222, 'binary_f1_score': 0.8010471}
confusion matrix:
     0    1
0  221    4
1   72  153
early stop counter: 8
val acc:0.8508977293968201, best validation acc: 0.8813427090644836, corresponding to test acc:                         0.8600000143051147 / 0.8822222352027893
after epoch: 22,now: 2024-07-20 12:34:09.845737,epoch time: 0:01:25.467620,used: 0:31:43.525202,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_12_02_26_seed_1_22478449
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.9947917, 'precision': 0.99477446, 'recall': 0.9948214, 'specificity': 0.9948214, 'f1': 0.99479127, 'auroc': 0.9991789, 'binary_precision': 0.9974127, 'binary_recall': 0.992278, 'binary_specificity': 0.99736494, 'binary_f1_score': 0.9948387}
confusion matrix:
      0     1
0  1514     4
1    12  1542
---- Validation: 
scalar performance:
{'acc': 0.86729115, 'precision': 0.874897, 'recall': 0.86612904, 'specificity': 0.86612904, 'f1': 0.86632335, 'auroc': 0.9341209, 'binary_precision': 0.92435426, 'binary_recall': 0.7952381, 'binary_specificity': 0.93701994, 'binary_f1_score': 0.85494876}
confusion matrix:
     0    1
0  610   41
1  129  501
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.82222223, 'precision': 0.8350346, 'recall': 0.82222223, 'specificity': 0.82222223, 'f1': 0.82050616, 'auroc': 0.89724445, 'binary_precision': 0.9005525, 'binary_recall': 0.72444445, 'binary_specificity': 0.92, 'binary_f1_score': 0.8029557}
confusion matrix:
     0    1
0  207   18
1   62  163
early stop counter: 9
val acc:0.8672911524772644, best validation acc: 0.8813427090644836, corresponding to test acc:                         0.8600000143051147 / 0.8822222352027893
after epoch: 23,now: 2024-07-20 12:35:33.824158,epoch time: 0:01:23.978421,used: 0:33:07.503623,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_12_02_26_seed_1_22478449
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9938151, 'precision': 0.99379385, 'recall': 0.9938451, 'specificity': 0.9938451, 'f1': 0.9938143, 'auroc': 0.9998169, 'binary_precision': 0.99612904, 'binary_recall': 0.9916506, 'binary_specificity': 0.9960396, 'binary_f1_score': 0.99388474}
confusion matrix:
      0     1
0  1509     6
1    13  1544
---- Validation: 
scalar performance:
{'acc': 0.7010148, 'precision': 0.79114586, 'recall': 0.69639015, 'specificity': 0.69639015, 'f1': 0.6728275, 'auroc': 0.91219735, 'binary_precision': 0.9490909, 'binary_recall': 0.41428572, 'binary_specificity': 0.97849464, 'binary_f1_score': 0.5767956}
confusion matrix:
     0    1
0  637   14
1  369  261
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7311111, 'precision': 0.8019823, 'recall': 0.7311111, 'specificity': 0.7311111, 'f1': 0.71435165, 'auroc': 0.92557037, 'binary_precision': 0.94827586, 'binary_recall': 0.4888889, 'binary_specificity': 0.97333336, 'binary_f1_score': 0.6451613}
confusion matrix:
     0    1
0  219    6
1  115  110
early stop counter: 10
val acc:0.7010148167610168, best validation acc: 0.8813427090644836, corresponding to test acc:                         0.8600000143051147 / 0.8822222352027893
after epoch: 24,now: 2024-07-20 12:36:58.013871,epoch time: 0:01:24.189713,used: 0:34:31.693336,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_12_02_26_seed_1_22478449
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.9873047, 'precision': 0.987422, 'recall': 0.9874437, 'specificity': 0.9874437, 'f1': 0.9873047, 'auroc': 0.9998826, 'binary_precision': 0.9986842, 'binary_recall': 0.97620577, 'binary_specificity': 0.9986816, 'binary_f1_score': 0.987317}
confusion matrix:
      0     1
0  1515     2
1    37  1518
---- Validation: 
scalar performance:
{'acc': 0.7626854, 'precision': 0.8238074, 'recall': 0.75908864, 'specificity': 0.75908864, 'f1': 0.74920404, 'auroc': 0.9253956, 'binary_precision': 0.96045196, 'binary_recall': 0.53968257, 'binary_specificity': 0.97849464, 'binary_f1_score': 0.6910569}
confusion matrix:
     0    1
0  637   14
1  290  340
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7222222, 'precision': 0.7971788, 'recall': 0.7222222, 'specificity': 0.7222222, 'f1': 0.7035277, 'auroc': 0.90398026, 'binary_precision': 0.9464286, 'binary_recall': 0.47111112, 'binary_specificity': 0.97333336, 'binary_f1_score': 0.6290801}
confusion matrix:
     0    1
0  219    6
1  119  106
early stop counter: 11
val acc:0.7626854181289673, best validation acc: 0.8813427090644836, corresponding to test acc:                         0.8600000143051147 / 0.8822222352027893
after epoch: 25,now: 2024-07-20 12:38:25.010602,epoch time: 0:01:26.996731,used: 0:35:58.690067,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_12_02_26_seed_1_22478449
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9938151, 'precision': 0.9937977, 'recall': 0.99384856, 'specificity': 0.99384856, 'f1': 0.9938146, 'auroc': 0.99975586, 'binary_precision': 0.99676377, 'binary_recall': 0.990991, 'binary_specificity': 0.9967062, 'binary_f1_score': 0.99386895}
confusion matrix:
      0     1
0  1513     5
1    14  1540
---- Validation: 
scalar performance:
{'acc': 0.84231067, 'precision': 0.8524812, 'recall': 0.8409114, 'specificity': 0.8409114, 'f1': 0.8407454, 'auroc': 0.90915316, 'binary_precision': 0.90839696, 'binary_recall': 0.75555557, 'binary_specificity': 0.92626727, 'binary_f1_score': 0.82495666}
confusion matrix:
     0    1
0  603   48
1  154  476
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8088889, 'precision': 0.8170042, 'recall': 0.8088889, 'specificity': 0.8088889, 'f1': 0.80765796, 'auroc': 0.8970864, 'binary_precision': 0.8677249, 'binary_recall': 0.72888887, 'binary_specificity': 0.8888889, 'binary_f1_score': 0.79227054}
confusion matrix:
     0    1
0  200   25
1   61  164
early stop counter: 12
val acc:0.8423106670379639, best validation acc: 0.8813427090644836, corresponding to test acc:                         0.8600000143051147 / 0.8822222352027893
after epoch: 26,now: 2024-07-20 12:39:49.449677,epoch time: 0:01:24.439075,used: 0:37:23.129142,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_12_02_26_seed_1_22478449
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.9899089, 'precision': 0.9899186, 'recall': 0.99000937, 'specificity': 0.99000937, 'f1': 0.9899085, 'auroc': 0.99976426, 'binary_precision': 0.9973924, 'binary_recall': 0.982659, 'binary_specificity': 0.99735975, 'binary_f1_score': 0.9899709}
confusion matrix:
      0     1
0  1511     4
1    27  1530
---- Validation: 
scalar performance:
{'acc': 0.8227947, 'precision': 0.85926163, 'recall': 0.8201741, 'specificity': 0.8201741, 'f1': 0.8173078, 'auroc': 0.9277607, 'binary_precision': 0.969697, 'binary_recall': 0.6603175, 'binary_specificity': 0.9800307, 'binary_f1_score': 0.7856469}
confusion matrix:
     0    1
0  638   13
1  214  416
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7222222, 'precision': 0.81263894, 'recall': 0.7222222, 'specificity': 0.7222222, 'f1': 0.7005733, 'auroc': 0.931279, 'binary_precision': 0.9807692, 'binary_recall': 0.45333335, 'binary_specificity': 0.9911111, 'binary_f1_score': 0.6200608}
confusion matrix:
     0    1
0  223    2
1  123  102
early stop counter: 13
val acc:0.8227946758270264, best validation acc: 0.8813427090644836, corresponding to test acc:                         0.8600000143051147 / 0.8822222352027893
after epoch: 27,now: 2024-07-20 12:41:14.351670,epoch time: 0:01:24.901993,used: 0:38:48.031135,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_12_02_26_seed_1_22478449
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.9873047, 'precision': 0.9874598, 'recall': 0.9874679, 'specificity': 0.9874679, 'f1': 0.9873047, 'auroc': 0.9998745, 'binary_precision': 1.0, 'binary_recall': 0.9749357, 'binary_specificity': 1.0, 'binary_f1_score': 0.9873088}
confusion matrix:
      0     1
0  1516     0
1    39  1517
---- Validation: 
scalar performance:
{'acc': 0.70882124, 'precision': 0.7981477, 'recall': 0.7042755, 'specificity': 0.7042755, 'f1': 0.6823181, 'auroc': 0.9232805, 'binary_precision': 0.95729536, 'binary_recall': 0.42698413, 'binary_specificity': 0.98156685, 'binary_f1_score': 0.59055984}
confusion matrix:
     0    1
0  639   12
1  361  269
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.82, 'precision': 0.8624486, 'recall': 0.82, 'specificity': 0.82, 'f1': 0.8145708, 'auroc': 0.93386173, 'binary_precision': 0.9864865, 'binary_recall': 0.6488889, 'binary_specificity': 0.9911111, 'binary_f1_score': 0.78284186}
confusion matrix:
     0    1
0  223    2
1   79  146
early stop counter: 14
val acc:0.7088212370872498, best validation acc: 0.8813427090644836, corresponding to test acc:                         0.8600000143051147 / 0.8822222352027893
after epoch: 28,now: 2024-07-20 12:42:39.670761,epoch time: 0:01:25.319091,used: 0:40:13.350226,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_12_02_26_seed_1_22478449
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9905599, 'precision': 0.9907072, 'recall': 0.990482, 'specificity': 0.990482, 'f1': 0.99055666, 'auroc': 0.99988043, 'binary_precision': 0.98475224, 'binary_recall': 0.99678457, 'binary_specificity': 0.9841793, 'binary_f1_score': 0.9907319}
confusion matrix:
      0     1
0  1493    24
1     5  1550
---- Validation: 
scalar performance:
{'acc': 0.8883685, 'precision': 0.89313245, 'recall': 0.8874808, 'specificity': 0.8874808, 'f1': 0.8878392, 'auroc': 0.9334699, 'binary_precision': 0.9325044, 'binary_recall': 0.8333333, 'binary_specificity': 0.9416283, 'binary_f1_score': 0.8801341}
confusion matrix:
     0    1
0  613   38
1  105  525
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8622222, 'precision': 0.8740438, 'recall': 0.8622222, 'specificity': 0.8622222, 'f1': 0.86112493, 'auroc': 0.9240889, 'binary_precision': 0.94054055, 'binary_recall': 0.7733333, 'binary_specificity': 0.95111114, 'binary_f1_score': 0.8487805}
confusion matrix:
     0    1
0  214   11
1   51  174
better model found
persisted
after epoch: 29,now: 2024-07-20 12:44:05.397078,epoch time: 0:01:25.726317,used: 0:41:39.076543,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_12_02_26_seed_1_22478449
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.99348956, 'precision': 0.9934781, 'recall': 0.9935685, 'specificity': 0.9935685, 'f1': 0.99348915, 'auroc': 0.9998207, 'binary_precision': 0.99935025, 'binary_recall': 0.987797, 'binary_specificity': 0.99933994, 'binary_f1_score': 0.99354005}
confusion matrix:
      0     1
0  1514     1
1    19  1538
---- Validation: 
scalar performance:
{'acc': 0.81889147, 'precision': 0.84784853, 'recall': 0.81651306, 'specificity': 0.81651306, 'f1': 0.8142262, 'auroc': 0.9332236, 'binary_precision': 0.9441964, 'binary_recall': 0.67142856, 'binary_specificity': 0.96159756, 'binary_f1_score': 0.78478664}
confusion matrix:
     0    1
0  626   25
1  207  423
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8088889, 'precision': 0.8379693, 'recall': 0.8088889, 'specificity': 0.8088889, 'f1': 0.8046875, 'auroc': 0.90479016, 'binary_precision': 0.9371069, 'binary_recall': 0.6622222, 'binary_specificity': 0.95555556, 'binary_f1_score': 0.7760416}
confusion matrix:
     0    1
0  215   10
1   76  149
early stop counter: 1
val acc:0.8188914656639099, best validation acc: 0.8883684873580933, corresponding to test acc:                         0.8622221946716309 / 0.8822222352027893
after epoch: 30,now: 2024-07-20 12:45:29.999416,epoch time: 0:01:24.602338,used: 0:43:03.678881,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_12_02_26_seed_1_22478449
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 0:43:03.678881 at 2024-07-20 12:45:29.999416
persisted model performance metric: 

scalar performance:
{'acc': 0.8622222, 'precision': 0.8740438, 'recall': 0.8622222, 'specificity': 0.8622222, 'f1': 0.86112493, 'auroc': 0.9240889, 'binary_precision': 0.94054055, 'binary_recall': 0.7733333, 'binary_specificity': 0.95111114, 'binary_f1_score': 0.8487805}
confusion matrix:
     0    1
0  214   11
1   51  174
oracle model performance metric: 

scalar performance:
{'acc': 0.88222224, 'precision': 0.8981482, 'recall': 0.8822222, 'specificity': 0.8822222, 'f1': 0.88103247, 'auroc': 0.94206417, 'binary_precision': 0.9777778, 'binary_recall': 0.7822222, 'binary_specificity': 0.9822222, 'binary_f1_score': 0.86913574}
confusion matrix:
     0    1
0  221    4
1   49  176
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_nofreeze_2024-07-19_18-41-07/rule_results/5.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_nofreeze_2024-07-19_18-41-07/confusion_matrix/5.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 455130 KiB |  13219 MiB | 150512 GiB | 150511 GiB |
|       from large pool | 414531 KiB |  13181 MiB | 148725 GiB | 148724 GiB |
|       from small pool |  40598 KiB |     60 MiB |   1787 GiB |   1787 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 455130 KiB |  13219 MiB | 150512 GiB | 150511 GiB |
|       from large pool | 414531 KiB |  13181 MiB | 148725 GiB | 148724 GiB |
|       from small pool |  40598 KiB |     60 MiB |   1787 GiB |   1787 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 447481 KiB |  13213 MiB | 149970 GiB | 149969 GiB |
|       from large pool | 407075 KiB |  13175 MiB | 148186 GiB | 148186 GiB |
|       from small pool |  40406 KiB |     60 MiB |   1783 GiB |   1783 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  14478 MiB |  14480 MiB |  28076 MiB |  13598 MiB |
|       from large pool |  14408 MiB |  14414 MiB |  27992 MiB |  13584 MiB |
|       from small pool |     70 MiB |     70 MiB |     84 MiB |     14 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 448038 KiB |   1252 MiB | 107490 GiB | 107490 GiB |
|       from large pool | 435388 KiB |   1244 MiB | 105692 GiB | 105692 GiB |
|       from small pool |  12649 KiB |     45 MiB |   1798 GiB |   1798 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    1310    |    2598    |   26312 K  |   26310 K  |
|       from large pool |     187    |    1413    |   13422 K  |   13422 K  |
|       from small pool |    1123    |    1419    |   12889 K  |   12888 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    1310    |    2598    |   26312 K  |   26310 K  |
|       from large pool |     187    |    1413    |   13422 K  |   13422 K  |
|       from small pool |    1123    |    1419    |   12889 K  |   12888 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     636    |     636    |    1207    |     571    |
|       from large pool |     601    |     601    |    1165    |     564    |
|       from small pool |      35    |      35    |      42    |       7    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      97    |     651    |   17280 K  |   17280 K  |
|       from large pool |      40    |     604    |    9726 K  |    9725 K  |
|       from small pool |      57    |     238    |    7554 K  |    7554 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13219 MiB | 150512 GiB | 150512 GiB |
|       from large pool |  16640 KiB |  13181 MiB | 148725 GiB | 148724 GiB |
|       from small pool |      0 KiB |     60 MiB |   1787 GiB |   1787 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13219 MiB | 150512 GiB | 150512 GiB |
|       from large pool |  16640 KiB |  13181 MiB | 148725 GiB | 148724 GiB |
|       from small pool |      0 KiB |     60 MiB |   1787 GiB |   1787 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13213 MiB | 149970 GiB | 149970 GiB |
|       from large pool |  16640 KiB |  13175 MiB | 148186 GiB | 148186 GiB |
|       from small pool |      0 KiB |     60 MiB |   1783 GiB |   1783 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    882 MiB |  14480 MiB |  28076 MiB |  27194 MiB |
|       from large pool |    830 MiB |  14414 MiB |  27992 MiB |  27162 MiB |
|       from small pool |     52 MiB |     70 MiB |     84 MiB |     32 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1252 MiB | 107491 GiB | 107491 GiB |
|       from large pool |  24320 KiB |   1244 MiB | 105692 GiB | 105692 GiB |
|       from small pool |      0 KiB |     45 MiB |   1798 GiB |   1798 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    2598    |   26312 K  |   26312 K  |
|       from large pool |       2    |    1413    |   13422 K  |   13422 K  |
|       from small pool |       0    |    1419    |   12889 K  |   12889 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    2598    |   26312 K  |   26312 K  |
|       from large pool |       2    |    1413    |   13422 K  |   13422 K  |
|       from small pool |       0    |    1419    |   12889 K  |   12889 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      63    |     636    |    1207    |    1144    |
|       from large pool |      37    |     601    |    1165    |    1128    |
|       from small pool |      26    |      35    |      42    |      16    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |     651    |   17281 K  |   17281 K  |
|       from large pool |       4    |     604    |    9726 K  |    9726 K  |
|       from small pool |       0    |     238    |    7555 K  |    7555 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13219 MiB | 150512 GiB | 150512 GiB |
|       from large pool |  16640 KiB |  13181 MiB | 148725 GiB | 148724 GiB |
|       from small pool |      0 KiB |     60 MiB |   1787 GiB |   1787 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13219 MiB | 150512 GiB | 150512 GiB |
|       from large pool |  16640 KiB |  13181 MiB | 148725 GiB | 148724 GiB |
|       from small pool |      0 KiB |     60 MiB |   1787 GiB |   1787 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13213 MiB | 149970 GiB | 149970 GiB |
|       from large pool |  16640 KiB |  13175 MiB | 148186 GiB | 148186 GiB |
|       from small pool |      0 KiB |     60 MiB |   1783 GiB |   1783 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    882 MiB |  14480 MiB |  28076 MiB |  27194 MiB |
|       from large pool |    830 MiB |  14414 MiB |  27992 MiB |  27162 MiB |
|       from small pool |     52 MiB |     70 MiB |     84 MiB |     32 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1252 MiB | 107491 GiB | 107491 GiB |
|       from large pool |  24320 KiB |   1244 MiB | 105692 GiB | 105692 GiB |
|       from small pool |      0 KiB |     45 MiB |   1798 GiB |   1798 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    2598    |   26312 K  |   26312 K  |
|       from large pool |       2    |    1413    |   13422 K  |   13422 K  |
|       from small pool |       0    |    1419    |   12889 K  |   12889 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    2598    |   26312 K  |   26312 K  |
|       from large pool |       2    |    1413    |   13422 K  |   13422 K  |
|       from small pool |       0    |    1419    |   12889 K  |   12889 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      63    |     636    |    1207    |    1144    |
|       from large pool |      37    |     601    |    1165    |    1128    |
|       from small pool |      26    |      35    |      42    |      16    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |     651    |   17281 K  |   17281 K  |
|       from large pool |       4    |     604    |    9726 K  |    9726 K  |
|       from small pool |       0    |     238    |    7555 K  |    7555 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'888c1ef2'
model name: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_12_47_00_seed_2_22478449

 Experiment start at: 2024-07-20 12:47:00.454496
before training, model accuracy: 0.41203704476356506
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.95517015, 'precision': 0.9552091, 'recall': 0.9552214, 'specificity': 0.9552214, 'f1': 0.9551701, 'auroc': 0.98869467, 'binary_precision': 0.96181697, 'binary_recall': 0.9487013, 'binary_specificity': 0.96174145, 'binary_f1_score': 0.95521414}
confusion matrix:
      0     1
0  1458    58
1    79  1461
---- Validation: 
scalar performance:
{'acc': 0.81533647, 'precision': 0.81538236, 'recall': 0.8149557, 'specificity': 0.8149557, 'f1': 0.81509686, 'auroc': 0.8814627, 'binary_precision': 0.81639344, 'binary_recall': 0.8006431, 'binary_specificity': 0.8292683, 'binary_f1_score': 0.8084415}
confusion matrix:
     0    1
0  544  112
1  124  498
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7939815, 'precision': 0.7954061, 'recall': 0.7939815, 'specificity': 0.7939815, 'f1': 0.7937328, 'auroc': 0.89889836, 'binary_precision': 0.7748918, 'binary_recall': 0.8287037, 'binary_specificity': 0.7592593, 'binary_f1_score': 0.80089486}
confusion matrix:
     0    1
0  164   52
1   37  179
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-20 12:48:34.039254,epoch time: 0:01:33.584758,used: 0:01:33.584758,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_12_47_00_seed_2_22478449
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9515707, 'precision': 0.9554175, 'recall': 0.9519429, 'specificity': 0.9519429, 'f1': 0.9514934, 'auroc': 0.9952464, 'binary_precision': 0.99928266, 'binary_recall': 0.9045454, 'binary_specificity': 0.99934036, 'binary_f1_score': 0.9495569}
confusion matrix:
      0     1
0  1515     1
1   147  1393
---- Validation: 
scalar performance:
{'acc': 0.62910795, 'precision': 0.7126493, 'recall': 0.6204293, 'specificity': 0.6204293, 'f1': 0.57974523, 'auroc': 0.78349245, 'binary_precision': 0.8394495, 'binary_recall': 0.29421222, 'binary_specificity': 0.94664633, 'binary_f1_score': 0.4357143}
confusion matrix:
     0    1
0  621   35
1  439  183
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8055556, 'precision': 0.82757354, 'recall': 0.8055556, 'specificity': 0.8055556, 'f1': 0.8022323, 'auroc': 0.87071323, 'binary_precision': 0.9125, 'binary_recall': 0.6759259, 'binary_specificity': 0.9351852, 'binary_f1_score': 0.7765958}
confusion matrix:
     0    1
0  202   14
1   70  146
new oracle model saved
early stop counter: 1
val acc:0.6291079521179199, best validation acc: 0.8153364658355713, corresponding to test acc:                         0.7939814925193787 / 0.8055555820465088
after epoch: 2,now: 2024-07-20 12:49:56.262284,epoch time: 0:01:22.223030,used: 0:02:55.807788,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_12_47_00_seed_2_22478449
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.96924084, 'precision': 0.96923894, 'recall': 0.96923894, 'specificity': 0.96923894, 'f1': 0.96923894, 'auroc': 0.9953016, 'binary_precision': 0.9694805, 'binary_recall': 0.9694805, 'binary_specificity': 0.96899736, 'binary_f1_score': 0.9694805}
confusion matrix:
      0     1
0  1469    47
1    47  1493
---- Validation: 
scalar performance:
{'acc': 0.7809077, 'precision': 0.7960783, 'recall': 0.7838356, 'specificity': 0.7838356, 'f1': 0.77915037, 'auroc': 0.88953567, 'binary_precision': 0.7220779, 'binary_recall': 0.8938907, 'binary_specificity': 0.6737805, 'binary_f1_score': 0.79885054}
confusion matrix:
     0    1
0  442  214
1   66  556
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6643519, 'precision': 0.75547224, 'recall': 0.6643519, 'specificity': 0.6643519, 'f1': 0.63149256, 'auroc': 0.89857686, 'binary_precision': 0.60289854, 'binary_recall': 0.962963, 'binary_specificity': 0.36574075, 'binary_f1_score': 0.741533}
confusion matrix:
    0    1
0  79  137
1   8  208
early stop counter: 2
val acc:0.7809076905250549, best validation acc: 0.8153364658355713, corresponding to test acc:                         0.7939814925193787 / 0.8055555820465088
after epoch: 3,now: 2024-07-20 12:51:18.554877,epoch time: 0:01:22.292593,used: 0:04:18.100381,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_12_47_00_seed_2_22478449
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.97054976, 'precision': 0.97101355, 'recall': 0.9706867, 'specificity': 0.9706867, 'f1': 0.9705469, 'auroc': 0.9961463, 'binary_precision': 0.98788697, 'binary_recall': 0.9532468, 'binary_specificity': 0.98812664, 'binary_f1_score': 0.97025776}
confusion matrix:
      0     1
0  1498    18
1    72  1468
---- Validation: 
scalar performance:
{'acc': 0.85758996, 'precision': 0.8627747, 'recall': 0.8559892, 'specificity': 0.8559892, 'f1': 0.8566035, 'auroc': 0.9204818, 'binary_precision': 0.9, 'binary_recall': 0.79581994, 'binary_specificity': 0.91615856, 'binary_f1_score': 0.8447099}
confusion matrix:
     0    1
0  601   55
1  127  495
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8472222, 'precision': 0.86525977, 'recall': 0.8472222, 'specificity': 0.8472222, 'f1': 0.8453125, 'auroc': 0.9154664, 'binary_precision': 0.9464286, 'binary_recall': 0.7361111, 'binary_specificity': 0.9583333, 'binary_f1_score': 0.828125}
confusion matrix:
     0    1
0  207    9
1   57  159
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-07-20 12:52:41.239026,epoch time: 0:01:22.684149,used: 0:05:40.784530,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_12_47_00_seed_2_22478449
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9659686, 'precision': 0.9678229, 'recall': 0.9662286, 'specificity': 0.9662286, 'f1': 0.96594644, 'auroc': 0.9973011, 'binary_precision': 0.9993046, 'binary_recall': 0.9331169, 'binary_specificity': 0.99934036, 'binary_f1_score': 0.9650773}
confusion matrix:
      0     1
0  1515     1
1   103  1437
---- Validation: 
scalar performance:
{'acc': 0.6697966, 'precision': 0.7825657, 'recall': 0.66118836, 'specificity': 0.66118836, 'f1': 0.6263023, 'auroc': 0.899856, 'binary_precision': 0.95454544, 'binary_recall': 0.3376206, 'binary_specificity': 0.9847561, 'binary_f1_score': 0.49881235}
confusion matrix:
     0    1
0  646   10
1  412  210
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6736111, 'precision': 0.802521, 'recall': 0.6736111, 'specificity': 0.6736111, 'f1': 0.6346953, 'auroc': 0.8883102, 'binary_precision': 1.0, 'binary_recall': 0.3472222, 'binary_specificity': 1.0, 'binary_f1_score': 0.5154639}
confusion matrix:
     0   1
0  216   0
1  141  75
early stop counter: 1
val acc:0.6697965860366821, best validation acc: 0.8575899600982666, corresponding to test acc:                         0.8472222089767456 / 0.8472222089767456
after epoch: 5,now: 2024-07-20 12:54:06.471550,epoch time: 0:01:25.232524,used: 0:07:06.017054,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_12_47_00_seed_2_22478449
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9751309, 'precision': 0.97571015, 'recall': 0.975006, 'specificity': 0.975006, 'f1': 0.9751171, 'auroc': 0.9988589, 'binary_precision': 0.96095717, 'binary_recall': 0.9909091, 'binary_specificity': 0.9591029, 'binary_f1_score': 0.97570336}
confusion matrix:
      0     1
0  1454    62
1    14  1526
---- Validation: 
scalar performance:
{'acc': 0.7902973, 'precision': 0.79061246, 'recall': 0.7907321, 'specificity': 0.7907321, 'f1': 0.7902927, 'auroc': 0.8666183, 'binary_precision': 0.7723077, 'binary_recall': 0.80707395, 'binary_specificity': 0.7743902, 'binary_f1_score': 0.78930813}
confusion matrix:
     0    1
0  508  148
1  120  502
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7569444, 'precision': 0.77088463, 'recall': 0.7569444, 'specificity': 0.7569444, 'f1': 0.75377667, 'auroc': 0.8673268, 'binary_precision': 0.709434, 'binary_recall': 0.8703704, 'binary_specificity': 0.6435185, 'binary_f1_score': 0.7817048}
confusion matrix:
     0    1
0  139   77
1   28  188
early stop counter: 2
val acc:0.7902973294258118, best validation acc: 0.8575899600982666, corresponding to test acc:                         0.8472222089767456 / 0.8472222089767456
after epoch: 6,now: 2024-07-20 12:55:28.449437,epoch time: 0:01:21.977887,used: 0:08:27.994941,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_12_47_00_seed_2_22478449
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.98527485, 'precision': 0.9855544, 'recall': 0.98538446, 'specificity': 0.98538446, 'f1': 0.9852743, 'auroc': 0.9986516, 'binary_precision': 0.999332, 'binary_recall': 0.9714286, 'binary_specificity': 0.99934036, 'binary_f1_score': 0.98518276}
confusion matrix:
      0     1
0  1515     1
1    44  1496
---- Validation: 
scalar performance:
{'acc': 0.81377155, 'precision': 0.8347032, 'recall': 0.8103899, 'specificity': 0.8103899, 'f1': 0.8095624, 'auroc': 0.90627146, 'binary_precision': 0.91201717, 'binary_recall': 0.68327975, 'binary_specificity': 0.9375, 'binary_f1_score': 0.78125006}
confusion matrix:
     0    1
0  615   41
1  197  425
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8009259, 'precision': 0.8319149, 'recall': 0.8009259, 'specificity': 0.8009259, 'f1': 0.7961683, 'auroc': 0.8985554, 'binary_precision': 0.93333334, 'binary_recall': 0.6481481, 'binary_specificity': 0.9537037, 'binary_f1_score': 0.76502734}
confusion matrix:
     0    1
0  206   10
1   76  140
early stop counter: 3
val acc:0.8137715458869934, best validation acc: 0.8575899600982666, corresponding to test acc:                         0.8472222089767456 / 0.8472222089767456
after epoch: 7,now: 2024-07-20 12:56:51.203974,epoch time: 0:01:22.754537,used: 0:09:50.749478,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_12_47_00_seed_2_22478449
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9842932, 'precision': 0.98440284, 'recall': 0.984246, 'specificity': 0.984246, 'f1': 0.98429024, 'auroc': 0.99926925, 'binary_precision': 0.978819, 'binary_recall': 0.99025977, 'binary_specificity': 0.9782322, 'binary_f1_score': 0.98450613}
confusion matrix:
      0     1
0  1483    33
1    15  1525
---- Validation: 
scalar performance:
{'acc': 0.8302034, 'precision': 0.830307, 'recall': 0.8298124, 'specificity': 0.8298124, 'f1': 0.82997346, 'auroc': 0.88833964, 'binary_precision': 0.8325123, 'binary_recall': 0.81511253, 'binary_specificity': 0.8445122, 'binary_f1_score': 0.8237206}
confusion matrix:
     0    1
0  554  102
1  115  507
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7731481, 'precision': 0.79598665, 'recall': 0.7731482, 'specificity': 0.7731482, 'f1': 0.76868606, 'auroc': 0.92292523, 'binary_precision': 0.7137681, 'binary_recall': 0.912037, 'binary_specificity': 0.6342593, 'binary_f1_score': 0.800813}
confusion matrix:
     0    1
0  137   79
1   19  197
early stop counter: 4
val acc:0.8302034139633179, best validation acc: 0.8575899600982666, corresponding to test acc:                         0.8472222089767456 / 0.8472222089767456
after epoch: 8,now: 2024-07-20 12:58:13.546489,epoch time: 0:01:22.342515,used: 0:11:13.091993,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_12_47_00_seed_2_22478449
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.99149215, 'precision': 0.9914981, 'recall': 0.99152756, 'specificity': 0.99152756, 'f1': 0.9914921, 'auroc': 0.99899554, 'binary_precision': 0.9960682, 'binary_recall': 0.987013, 'binary_specificity': 0.9960422, 'binary_f1_score': 0.9915199}
confusion matrix:
      0     1
0  1510     6
1    20  1520
---- Validation: 
scalar performance:
{'acc': 0.81064165, 'precision': 0.8133977, 'recall': 0.8092993, 'specificity': 0.8092993, 'f1': 0.8096552, 'auroc': 0.88207054, 'binary_precision': 0.83687943, 'binary_recall': 0.75884247, 'binary_specificity': 0.8597561, 'binary_f1_score': 0.79595274}
confusion matrix:
     0    1
0  564   92
1  150  472
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7569444, 'precision': 0.7675475, 'recall': 0.7569444, 'specificity': 0.7569444, 'f1': 0.7545123, 'auroc': 0.8595251, 'binary_precision': 0.71428573, 'binary_recall': 0.8564815, 'binary_specificity': 0.6574074, 'binary_f1_score': 0.7789475}
confusion matrix:
     0    1
0  142   74
1   31  185
early stop counter: 5
val acc:0.8106416463851929, best validation acc: 0.8575899600982666, corresponding to test acc:                         0.8472222089767456 / 0.8472222089767456
after epoch: 9,now: 2024-07-20 12:59:35.491895,epoch time: 0:01:21.945406,used: 0:12:35.037399,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_12_47_00_seed_2_22478449
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.98756546, 'precision': 0.9875778, 'recall': 0.98755443, 'specificity': 0.98755443, 'f1': 0.98756444, 'auroc': 0.99902815, 'binary_precision': 0.98639894, 'binary_recall': 0.98896104, 'binary_specificity': 0.98614776, 'binary_f1_score': 0.98767835}
confusion matrix:
      0     1
0  1495    21
1    17  1523
---- Validation: 
scalar performance:
{'acc': 0.85054773, 'precision': 0.85397285, 'recall': 0.84921277, 'specificity': 0.84921277, 'f1': 0.84975207, 'auroc': 0.8968292, 'binary_precision': 0.8827709, 'binary_recall': 0.7990354, 'binary_specificity': 0.8993902, 'binary_f1_score': 0.83881855}
confusion matrix:
     0    1
0  590   66
1  125  497
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7986111, 'precision': 0.80763793, 'recall': 0.79861116, 'specificity': 0.79861116, 'f1': 0.79712284, 'auroc': 0.91008663, 'binary_precision': 0.7549407, 'binary_recall': 0.8842593, 'binary_specificity': 0.712963, 'binary_f1_score': 0.81449896}
confusion matrix:
     0    1
0  154   62
1   25  191
early stop counter: 6
val acc:0.850547730922699, best validation acc: 0.8575899600982666, corresponding to test acc:                         0.8472222089767456 / 0.8472222089767456
after epoch: 10,now: 2024-07-20 13:00:58.278226,epoch time: 0:01:22.786331,used: 0:13:57.823730,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_12_47_00_seed_2_22478449
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9842932, 'precision': 0.9843839, 'recall': 0.98425114, 'specificity': 0.98425114, 'f1': 0.9842905, 'auroc': 0.9991973, 'binary_precision': 0.97943443, 'binary_recall': 0.9896104, 'binary_specificity': 0.97889185, 'binary_f1_score': 0.9844961}
confusion matrix:
      0     1
0  1484    32
1    16  1524
---- Validation: 
scalar performance:
{'acc': 0.79812205, 'precision': 0.79801214, 'recall': 0.7981874, 'specificity': 0.7981874, 'f1': 0.7980508, 'auroc': 0.8649273, 'binary_precision': 0.78797466, 'binary_recall': 0.8006431, 'binary_specificity': 0.7957317, 'binary_f1_score': 0.7942583}
confusion matrix:
     0    1
0  522  134
1  124  498
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7222222, 'precision': 0.76408553, 'recall': 0.7222222, 'specificity': 0.7222222, 'f1': 0.7107595, 'auroc': 0.8679055, 'binary_precision': 0.6589404, 'binary_recall': 0.9212963, 'binary_specificity': 0.5231481, 'binary_f1_score': 0.76833975}
confusion matrix:
     0    1
0  113  103
1   17  199
early stop counter: 7
val acc:0.7981220483779907, best validation acc: 0.8575899600982666, corresponding to test acc:                         0.8472222089767456 / 0.8472222089767456
after epoch: 11,now: 2024-07-20 13:02:20.704845,epoch time: 0:01:22.426619,used: 0:15:20.250349,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_12_47_00_seed_2_22478449
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9918194, 'precision': 0.99184656, 'recall': 0.9918009, 'specificity': 0.9918009, 'f1': 0.99181855, 'auroc': 0.9993408, 'binary_precision': 0.9896574, 'binary_recall': 0.9941558, 'binary_specificity': 0.9894459, 'binary_f1_score': 0.99190146}
confusion matrix:
      0     1
0  1500    16
1     9  1531
---- Validation: 
scalar performance:
{'acc': 0.81611896, 'precision': 0.8294311, 'recall': 0.8133848, 'specificity': 0.8133848, 'f1': 0.8132279, 'auroc': 0.8849478, 'binary_precision': 0.889336, 'binary_recall': 0.7106109, 'binary_specificity': 0.91615856, 'binary_f1_score': 0.789991}
confusion matrix:
     0    1
0  601   55
1  180  442
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8171296, 'precision': 0.8171908, 'recall': 0.8171296, 'specificity': 0.8171296, 'f1': 0.8171208, 'auroc': 0.9000343, 'binary_precision': 0.8127854, 'binary_recall': 0.8240741, 'binary_specificity': 0.8101852, 'binary_f1_score': 0.81839085}
confusion matrix:
     0    1
0  175   41
1   38  178
early stop counter: 8
val acc:0.8161189556121826, best validation acc: 0.8575899600982666, corresponding to test acc:                         0.8472222089767456 / 0.8472222089767456
after epoch: 12,now: 2024-07-20 13:03:42.788593,epoch time: 0:01:22.083748,used: 0:16:42.334097,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_12_47_00_seed_2_22478449
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.98232985, 'precision': 0.9828025, 'recall': 0.98246753, 'specificity': 0.98246753, 'f1': 0.9823282, 'auroc': 0.9996252, 'binary_precision': 1.0, 'binary_recall': 0.96493506, 'binary_specificity': 1.0, 'binary_f1_score': 0.98215467}
confusion matrix:
      0     1
0  1516     0
1    54  1486
---- Validation: 
scalar performance:
{'acc': 0.74960876, 'precision': 0.82107496, 'recall': 0.74322355, 'specificity': 0.74322355, 'f1': 0.73148793, 'auroc': 0.9221434, 'binary_precision': 0.9660494, 'binary_recall': 0.50321543, 'binary_specificity': 0.9832317, 'binary_f1_score': 0.6617336}
confusion matrix:
     0    1
0  645   11
1  309  313
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6319444, 'precision': 0.788, 'recall': 0.6319444, 'specificity': 0.6319444, 'f1': 0.57427347, 'auroc': 0.90678585, 'binary_precision': 1.0, 'binary_recall': 0.2638889, 'binary_specificity': 1.0, 'binary_f1_score': 0.41758245}
confusion matrix:
     0   1
0  216   0
1  159  57
early stop counter: 9
val acc:0.7496087551116943, best validation acc: 0.8575899600982666, corresponding to test acc:                         0.8472222089767456 / 0.8472222089767456
after epoch: 13,now: 2024-07-20 13:05:05.140720,epoch time: 0:01:22.352127,used: 0:18:04.686224,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_12_47_00_seed_2_22478449
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9882199, 'precision': 0.98821294, 'recall': 0.9882397, 'specificity': 0.9882397, 'f1': 0.98821956, 'auroc': 0.99939513, 'binary_precision': 0.9908616, 'binary_recall': 0.98571426, 'binary_specificity': 0.99076515, 'binary_f1_score': 0.9882812}
confusion matrix:
      0     1
0  1502    14
1    22  1518
---- Validation: 
scalar performance:
{'acc': 0.85524255, 'precision': 0.87058717, 'recall': 0.8525361, 'specificity': 0.8525361, 'f1': 0.85296667, 'auroc': 0.926447, 'binary_precision': 0.93963784, 'binary_recall': 0.7508039, 'binary_specificity': 0.9542683, 'binary_f1_score': 0.8346738}
confusion matrix:
     0    1
0  626   30
1  155  467
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8171296, 'precision': 0.8508905, 'recall': 0.8171296, 'specificity': 0.8171296, 'f1': 0.81262255, 'auroc': 0.90586424, 'binary_precision': 0.9597315, 'binary_recall': 0.662037, 'binary_specificity': 0.9722222, 'binary_f1_score': 0.78356165}
confusion matrix:
     0    1
0  210    6
1   73  143
early stop counter: 10
val acc:0.8552425503730774, best validation acc: 0.8575899600982666, corresponding to test acc:                         0.8472222089767456 / 0.8472222089767456
after epoch: 14,now: 2024-07-20 13:06:28.395366,epoch time: 0:01:23.254646,used: 0:19:27.940870,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_12_47_00_seed_2_22478449
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9918194, 'precision': 0.9918117, 'recall': 0.9918317, 'specificity': 0.9918317, 'f1': 0.991819, 'auroc': 0.99976265, 'binary_precision': 0.99348533, 'binary_recall': 0.99025977, 'binary_specificity': 0.9934037, 'binary_f1_score': 0.9918699}
confusion matrix:
      0     1
0  1506    10
1    15  1525
---- Validation: 
scalar performance:
{'acc': 0.786385, 'precision': 0.82845664, 'recall': 0.78154653, 'specificity': 0.78154653, 'f1': 0.77723575, 'auroc': 0.90064263, 'binary_precision': 0.9395466, 'binary_recall': 0.59967846, 'binary_specificity': 0.9634146, 'binary_f1_score': 0.73209023}
confusion matrix:
     0    1
0  632   24
1  249  373
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7407407, 'precision': 0.8250376, 'recall': 0.7407408, 'specificity': 0.7407408, 'f1': 0.7227659, 'auroc': 0.8821373, 'binary_precision': 0.990566, 'binary_recall': 0.4861111, 'binary_specificity': 0.9953704, 'binary_f1_score': 0.6521739}
confusion matrix:
     0    1
0  215    1
1  111  105
early stop counter: 11
val acc:0.7863849997520447, best validation acc: 0.8575899600982666, corresponding to test acc:                         0.8472222089767456 / 0.8472222089767456
after epoch: 15,now: 2024-07-20 13:07:50.750291,epoch time: 0:01:22.354925,used: 0:20:50.295795,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_12_47_00_seed_2_22478449
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9921466, 'precision': 0.9921397, 'recall': 0.99216664, 'specificity': 0.99216664, 'f1': 0.9921464, 'auroc': 0.99950564, 'binary_precision': 0.9947781, 'binary_recall': 0.9896104, 'binary_specificity': 0.99472296, 'binary_f1_score': 0.9921875}
confusion matrix:
      0     1
0  1508     8
1    16  1524
---- Validation: 
scalar performance:
{'acc': 0.80751175, 'precision': 0.8346134, 'recall': 0.80366737, 'specificity': 0.80366737, 'f1': 0.802065, 'auroc': 0.9011009, 'binary_precision': 0.9234234, 'binary_recall': 0.659164, 'binary_specificity': 0.9481707, 'binary_f1_score': 0.7692307}
confusion matrix:
     0    1
0  622   34
1  212  410
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7407407, 'precision': 0.79698575, 'recall': 0.7407407, 'specificity': 0.7407407, 'f1': 0.7278557, 'auroc': 0.8583462, 'binary_precision': 0.92622954, 'binary_recall': 0.5231481, 'binary_specificity': 0.9583333, 'binary_f1_score': 0.66863906}
confusion matrix:
     0    1
0  207    9
1  103  113
early stop counter: 12
val acc:0.8075117468833923, best validation acc: 0.8575899600982666, corresponding to test acc:                         0.8472222089767456 / 0.8472222089767456
after epoch: 16,now: 2024-07-20 13:09:13.536723,epoch time: 0:01:22.786432,used: 0:22:13.082227,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_12_47_00_seed_2_22478449
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.989856, 'precision': 0.9898588, 'recall': 0.9898888, 'specificity': 0.9898888, 'f1': 0.9898559, 'auroc': 0.99963164, 'binary_precision': 0.9941061, 'binary_recall': 0.98571426, 'binary_specificity': 0.9940633, 'binary_f1_score': 0.9898924}
confusion matrix:
      0     1
0  1507     9
1    22  1518
---- Validation: 
scalar performance:
{'acc': 0.81298906, 'precision': 0.8416722, 'recall': 0.8090861, 'specificity': 0.8090861, 'f1': 0.80754215, 'auroc': 0.91417587, 'binary_precision': 0.93424034, 'binary_recall': 0.66237944, 'binary_specificity': 0.95579267, 'binary_f1_score': 0.77516466}
confusion matrix:
     0    1
0  627   29
1  210  412
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7893519, 'precision': 0.8340344, 'recall': 0.7893518, 'specificity': 0.7893518, 'f1': 0.7820637, 'auroc': 0.89909124, 'binary_precision': 0.95620435, 'binary_recall': 0.6064815, 'binary_specificity': 0.9722222, 'binary_f1_score': 0.7422096}
confusion matrix:
     0    1
0  210    6
1   85  131
early stop counter: 13
val acc:0.8129890561103821, best validation acc: 0.8575899600982666, corresponding to test acc:                         0.8472222089767456 / 0.8472222089767456
after epoch: 17,now: 2024-07-20 13:10:36.026782,epoch time: 0:01:22.490059,used: 0:23:35.572286,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_12_47_00_seed_2_22478449
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9941099, 'precision': 0.9941323, 'recall': 0.99409413, 'specificity': 0.99409413, 'f1': 0.9941094, 'auroc': 0.9998573, 'binary_precision': 0.99223804, 'binary_recall': 0.9961039, 'binary_specificity': 0.99208444, 'binary_f1_score': 0.9941672}
confusion matrix:
      0     1
0  1504    12
1     6  1534
---- Validation: 
scalar performance:
{'acc': 0.8544601, 'precision': 0.86628485, 'recall': 0.85206556, 'specificity': 0.85206556, 'f1': 0.8525886, 'auroc': 0.93000793, 'binary_precision': 0.92578125, 'binary_recall': 0.7620579, 'binary_specificity': 0.94207317, 'binary_f1_score': 0.83597887}
confusion matrix:
     0    1
0  618   38
1  148  474
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7893519, 'precision': 0.81816363, 'recall': 0.7893518, 'specificity': 0.7893518, 'f1': 0.78447247, 'auroc': 0.9033779, 'binary_precision': 0.9139073, 'binary_recall': 0.6388889, 'binary_specificity': 0.9398148, 'binary_f1_score': 0.7520436}
confusion matrix:
     0    1
0  203   13
1   78  138
early stop counter: 14
val acc:0.8544601202011108, best validation acc: 0.8575899600982666, corresponding to test acc:                         0.8472222089767456 / 0.8472222089767456
after epoch: 18,now: 2024-07-20 13:11:58.592117,epoch time: 0:01:22.565335,used: 0:24:58.137621,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_12_47_00_seed_2_22478449
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.99345547, 'precision': 0.99346095, 'recall': 0.9934499, 'specificity': 0.9934499, 'f1': 0.99345505, 'auroc': 0.99963933, 'binary_precision': 0.9928664, 'binary_recall': 0.9941558, 'binary_specificity': 0.9927441, 'binary_f1_score': 0.9935107}
confusion matrix:
      0     1
0  1505    11
1     9  1531
---- Validation: 
scalar performance:
{'acc': 0.8262911, 'precision': 0.8494159, 'recall': 0.82283497, 'specificity': 0.82283497, 'f1': 0.82219386, 'auroc': 0.91567814, 'binary_precision': 0.9329004, 'binary_recall': 0.69292605, 'binary_specificity': 0.9527439, 'binary_f1_score': 0.795203}
confusion matrix:
     0    1
0  625   31
1  191  431
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8449074, 'precision': 0.8605566, 'recall': 0.8449074, 'specificity': 0.8449074, 'f1': 0.84320605, 'auroc': 0.9315629, 'binary_precision': 0.9356725, 'binary_recall': 0.7407407, 'binary_specificity': 0.9490741, 'binary_f1_score': 0.82687336}
confusion matrix:
     0    1
0  205   11
1   56  160
early stop counter: 15
val acc:0.8262910842895508, best validation acc: 0.8575899600982666, corresponding to test acc:                         0.8472222089767456 / 0.8472222089767456
after epoch: 19,now: 2024-07-20 13:13:21.270752,epoch time: 0:01:22.678635,used: 0:26:20.816256,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_12_47_00_seed_2_22478449
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.99247384, 'precision': 0.99248344, 'recall': 0.99251187, 'specificity': 0.99251187, 'f1': 0.9924737, 'auroc': 0.99984276, 'binary_precision': 0.99737704, 'binary_recall': 0.9876623, 'binary_specificity': 0.9973615, 'binary_f1_score': 0.9924959}
confusion matrix:
      0     1
0  1512     4
1    19  1521
---- Validation: 
scalar performance:
{'acc': 0.7222222, 'precision': 0.78771484, 'recall': 0.71571344, 'specificity': 0.71571344, 'f1': 0.7014637, 'auroc': 0.878985, 'binary_precision': 0.9184953, 'binary_recall': 0.47106108, 'binary_specificity': 0.96036583, 'binary_f1_score': 0.6227417}
confusion matrix:
     0    1
0  630   26
1  329  293
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.712963, 'precision': 0.7805195, 'recall': 0.712963, 'specificity': 0.712963, 'f1': 0.69457436, 'auroc': 0.864519, 'binary_precision': 0.91818184, 'binary_recall': 0.4675926, 'binary_specificity': 0.9583333, 'binary_f1_score': 0.61963195}
confusion matrix:
     0    1
0  207    9
1  115  101
early stop counter: 16
val acc:0.7222222089767456, best validation acc: 0.8575899600982666, corresponding to test acc:                         0.8472222089767456 / 0.8472222089767456
after epoch: 20,now: 2024-07-20 13:14:43.495349,epoch time: 0:01:22.224597,used: 0:27:43.040853,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_12_47_00_seed_2_22478449
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9960733, 'precision': 0.9960655, 'recall': 0.9960885, 'specificity': 0.9960885, 'f1': 0.9960731, 'auroc': 0.9997383, 'binary_precision': 0.9980443, 'binary_recall': 0.9941558, 'binary_specificity': 0.9980211, 'binary_f1_score': 0.9960963}
confusion matrix:
      0     1
0  1513     3
1     9  1531
---- Validation: 
scalar performance:
{'acc': 0.7965571, 'precision': 0.82253385, 'recall': 0.79270494, 'specificity': 0.79270494, 'f1': 0.79080045, 'auroc': 0.8972336, 'binary_precision': 0.9076577, 'binary_recall': 0.64790994, 'binary_specificity': 0.9375, 'binary_f1_score': 0.7560975}
confusion matrix:
     0    1
0  615   41
1  219  403
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8101852, 'precision': 0.8223737, 'recall': 0.8101852, 'specificity': 0.8101852, 'f1': 0.8083739, 'auroc': 0.89122516, 'binary_precision': 0.88505745, 'binary_recall': 0.712963, 'binary_specificity': 0.9074074, 'binary_f1_score': 0.7897436}
confusion matrix:
     0    1
0  196   20
1   62  154
early stop counter: 17
val acc:0.7965571284294128, best validation acc: 0.8575899600982666, corresponding to test acc:                         0.8472222089767456 / 0.8472222089767456
after epoch: 21,now: 2024-07-20 13:16:06.155068,epoch time: 0:01:22.659719,used: 0:29:05.700572,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_12_47_00_seed_2_22478449
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9921466, 'precision': 0.9921526, 'recall': 0.9921821, 'specificity': 0.9921821, 'f1': 0.9921465, 'auroc': 0.99953824, 'binary_precision': 0.9967235, 'binary_recall': 0.9876623, 'binary_specificity': 0.99670184, 'binary_f1_score': 0.99217224}
confusion matrix:
      0     1
0  1511     5
1    19  1521
---- Validation: 
scalar performance:
{'acc': 0.7793427, 'precision': 0.81981784, 'recall': 0.77452016, 'specificity': 0.77452016, 'f1': 0.76996785, 'auroc': 0.88858783, 'binary_precision': 0.9271357, 'binary_recall': 0.5932476, 'binary_specificity': 0.95579267, 'binary_f1_score': 0.72352946}
confusion matrix:
     0    1
0  627   29
1  253  369
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8240741, 'precision': 0.853172, 'recall': 0.8240741, 'specificity': 0.8240741, 'f1': 0.82037425, 'auroc': 0.9245542, 'binary_precision': 0.95454544, 'binary_recall': 0.6805556, 'binary_specificity': 0.9675926, 'binary_f1_score': 0.7945946}
confusion matrix:
     0    1
0  209    7
1   69  147
early stop counter: 18
val acc:0.7793427109718323, best validation acc: 0.8575899600982666, corresponding to test acc:                         0.8472222089767456 / 0.8472222089767456
after epoch: 22,now: 2024-07-20 13:17:28.612434,epoch time: 0:01:22.457366,used: 0:30:28.157938,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_12_47_00_seed_2_22478449
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.9882199, 'precision': 0.9883119, 'recall': 0.988178, 'specificity': 0.988178, 'f1': 0.98821783, 'auroc': 0.99959826, 'binary_precision': 0.9832905, 'binary_recall': 0.9935065, 'binary_specificity': 0.9828496, 'binary_f1_score': 0.9883721}
confusion matrix:
      0     1
0  1490    26
1    10  1530
---- Validation: 
scalar performance:
{'acc': 0.85289514, 'precision': 0.854089, 'recall': 0.85208267, 'specificity': 0.85208267, 'f1': 0.85247755, 'auroc': 0.90923506, 'binary_precision': 0.86904764, 'binary_recall': 0.8215434, 'binary_specificity': 0.88262194, 'binary_f1_score': 0.8446281}
confusion matrix:
     0    1
0  579   77
1  111  511
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8263889, 'precision': 0.8315697, 'recall': 0.8263889, 'specificity': 0.8263889, 'f1': 0.8257081, 'auroc': 0.8712063, 'binary_precision': 0.8730159, 'binary_recall': 0.7638889, 'binary_specificity': 0.8888889, 'binary_f1_score': 0.81481487}
confusion matrix:
     0    1
0  192   24
1   51  165
early stop counter: 19
val acc:0.8528951406478882, best validation acc: 0.8575899600982666, corresponding to test acc:                         0.8472222089767456 / 0.8472222089767456
after epoch: 23,now: 2024-07-20 13:18:51.219995,epoch time: 0:01:22.607561,used: 0:31:50.765499,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_12_47_00_seed_2_22478449
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9911649, 'precision': 0.9911745, 'recall': 0.99120295, 'specificity': 0.99120295, 'f1': 0.9911648, 'auroc': 0.9993031, 'binary_precision': 0.99606556, 'binary_recall': 0.98636365, 'binary_specificity': 0.9960422, 'binary_f1_score': 0.99119085}
confusion matrix:
      0     1
0  1510     6
1    21  1519
---- Validation: 
scalar performance:
{'acc': 0.71048516, 'precision': 0.7882687, 'recall': 0.7034056, 'specificity': 0.7034056, 'f1': 0.68492556, 'auroc': 0.9021033, 'binary_precision': 0.9315069, 'binary_recall': 0.43729904, 'binary_specificity': 0.9695122, 'binary_f1_score': 0.595186}
confusion matrix:
     0    1
0  636   20
1  350  272
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7523148, 'precision': 0.8194139, 'recall': 0.7523148, 'specificity': 0.7523148, 'f1': 0.73858607, 'auroc': 0.8989626, 'binary_precision': 0.96581197, 'binary_recall': 0.5231481, 'binary_specificity': 0.9814815, 'binary_f1_score': 0.6786787}
confusion matrix:
     0    1
0  212    4
1  103  113
early stop counter: 20
val acc:0.7104851603507996, best validation acc: 0.8575899600982666, corresponding to test acc:                         0.8472222089767456 / 0.8472222089767456
after epoch: 24,now: 2024-07-20 13:20:13.448946,epoch time: 0:01:22.228951,used: 0:33:12.994450,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_12_47_00_seed_2_22478449
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.9941099, 'precision': 0.99411595, 'recall': 0.9941455, 'specificity': 0.9941455, 'f1': 0.99410987, 'auroc': 0.9999208, 'binary_precision': 0.9986894, 'binary_recall': 0.9896104, 'binary_specificity': 0.9986807, 'binary_f1_score': 0.9941291}
confusion matrix:
      0     1
0  1514     2
1    16  1524
---- Validation: 
scalar performance:
{'acc': 0.81611896, 'precision': 0.8386948, 'recall': 0.8126348, 'specificity': 0.8126348, 'f1': 0.8117359, 'auroc': 0.90135336, 'binary_precision': 0.9197397, 'binary_recall': 0.68167204, 'binary_specificity': 0.94359756, 'binary_f1_score': 0.7830102}
confusion matrix:
     0    1
0  619   37
1  198  424
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7476852, 'precision': 0.79833484, 'recall': 0.7476852, 'specificity': 0.7476852, 'f1': 0.73650134, 'auroc': 0.89017487, 'binary_precision': 0.9212598, 'binary_recall': 0.5416667, 'binary_specificity': 0.9537037, 'binary_f1_score': 0.68221575}
confusion matrix:
     0    1
0  206   10
1   99  117
early stop counter: 21
val acc:0.8161189556121826, best validation acc: 0.8575899600982666, corresponding to test acc:                         0.8472222089767456 / 0.8472222089767456
after epoch: 25,now: 2024-07-20 13:21:36.498102,epoch time: 0:01:23.049156,used: 0:34:36.043606,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_12_47_00_seed_2_22478449
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.99247384, 'precision': 0.9925767, 'recall': 0.9924297, 'specificity': 0.9924297, 'f1': 0.99247247, 'auroc': 0.9998706, 'binary_precision': 0.9871548, 'binary_recall': 0.99805194, 'binary_specificity': 0.9868074, 'binary_f1_score': 0.99257344}
confusion matrix:
      0     1
0  1496    20
1     3  1537
---- Validation: 
scalar performance:
{'acc': 0.8482003, 'precision': 0.8495014, 'recall': 0.84734285, 'specificity': 0.84734285, 'f1': 0.8477435, 'auroc': 0.90878904, 'binary_precision': 0.8651877, 'binary_recall': 0.81511253, 'binary_specificity': 0.87957317, 'binary_f1_score': 0.839404}
confusion matrix:
     0    1
0  577   79
1  115  507
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8101852, 'precision': 0.81114554, 'recall': 0.8101852, 'specificity': 0.8101852, 'f1': 0.8100386, 'auroc': 0.8859097, 'binary_precision': 0.79385966, 'binary_recall': 0.837963, 'binary_specificity': 0.7824074, 'binary_f1_score': 0.81531537}
confusion matrix:
     0    1
0  169   47
1   35  181
early stop counter: 22
val acc:0.8482003211975098, best validation acc: 0.8575899600982666, corresponding to test acc:                         0.8472222089767456 / 0.8472222089767456
after epoch: 26,now: 2024-07-20 13:22:59.246383,epoch time: 0:01:22.748281,used: 0:35:58.791887,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_12_47_00_seed_2_22478449
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.99345547, 'precision': 0.99345094, 'recall': 0.99346024, 'specificity': 0.99346024, 'f1': 0.9934552, 'auroc': 0.9998325, 'binary_precision': 0.99414825, 'binary_recall': 0.99285716, 'binary_specificity': 0.9940633, 'binary_f1_score': 0.99350226}
confusion matrix:
      0     1
0  1507     9
1    11  1529
---- Validation: 
scalar performance:
{'acc': 0.7363067, 'precision': 0.78255486, 'recall': 0.7307662, 'specificity': 0.7307662, 'f1': 0.72188735, 'auroc': 0.89252317, 'binary_precision': 0.89041096, 'binary_recall': 0.522508, 'binary_specificity': 0.9390244, 'binary_f1_score': 0.6585613}
confusion matrix:
     0    1
0  616   40
1  297  325
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8310185, 'precision': 0.83359975, 'recall': 0.8310185, 'specificity': 0.8310185, 'f1': 0.830691, 'auroc': 0.89523315, 'binary_precision': 0.8629442, 'binary_recall': 0.787037, 'binary_specificity': 0.875, 'binary_f1_score': 0.8232445}
confusion matrix:
     0    1
0  189   27
1   46  170
early stop counter: 23
val acc:0.7363067269325256, best validation acc: 0.8575899600982666, corresponding to test acc:                         0.8472222089767456 / 0.8472222089767456
after epoch: 27,now: 2024-07-20 13:24:21.919321,epoch time: 0:01:22.672938,used: 0:37:21.464825,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_12_47_00_seed_2_22478449
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.99640054, 'precision': 0.9964098, 'recall': 0.9963926, 'specificity': 0.9963926, 'f1': 0.99640024, 'auroc': 0.9997486, 'binary_precision': 0.9954634, 'binary_recall': 0.9974026, 'binary_specificity': 0.9953826, 'binary_f1_score': 0.996432}
confusion matrix:
      0     1
0  1509     7
1     4  1536
---- Validation: 
scalar performance:
{'acc': 0.81611896, 'precision': 0.8502588, 'recall': 0.81192654, 'specificity': 0.81192654, 'f1': 0.8100191, 'auroc': 0.9229699, 'binary_precision': 0.9531616, 'binary_recall': 0.65434086, 'binary_specificity': 0.9695122, 'binary_f1_score': 0.77597713}
confusion matrix:
     0    1
0  636   20
1  215  407
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8402778, 'precision': 0.8638697, 'recall': 0.8402778, 'specificity': 0.8402778, 'f1': 0.8376461, 'auroc': 0.91173697, 'binary_precision': 0.95652175, 'binary_recall': 0.712963, 'binary_specificity': 0.9675926, 'binary_f1_score': 0.81697613}
confusion matrix:
     0    1
0  209    7
1   62  154
early stop counter: 24
val acc:0.8161189556121826, best validation acc: 0.8575899600982666, corresponding to test acc:                         0.8472222089767456 / 0.8472222089767456
after epoch: 28,now: 2024-07-20 13:25:43.603787,epoch time: 0:01:21.684466,used: 0:38:43.149291,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_12_47_00_seed_2_22478449
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.99247384, 'precision': 0.9925129, 'recall': 0.99245024, 'specificity': 0.99245024, 'f1': 0.99247295, 'auroc': 0.999704, 'binary_precision': 0.98967075, 'binary_recall': 0.99545455, 'binary_specificity': 0.9894459, 'binary_f1_score': 0.99255425}
confusion matrix:
      0     1
0  1500    16
1     7  1533
---- Validation: 
scalar performance:
{'acc': 0.829421, 'precision': 0.8372879, 'recall': 0.8273419, 'specificity': 0.8273419, 'f1': 0.8276925, 'auroc': 0.89263093, 'binary_precision': 0.88257575, 'binary_recall': 0.7491961, 'binary_specificity': 0.9054878, 'binary_f1_score': 0.8104348}
confusion matrix:
     0    1
0  594   62
1  156  466
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.775463, 'precision': 0.79311013, 'recall': 0.775463, 'specificity': 0.775463, 'f1': 0.77203166, 'auroc': 0.8768219, 'binary_precision': 0.86503065, 'binary_recall': 0.6527778, 'binary_specificity': 0.8981481, 'binary_f1_score': 0.74406326}
confusion matrix:
     0    1
0  194   22
1   75  141
early stop counter: 25
val acc:0.8294209837913513, best validation acc: 0.8575899600982666, corresponding to test acc:                         0.8472222089767456 / 0.8472222089767456
after epoch: 29,now: 2024-07-20 13:27:06.013425,epoch time: 0:01:22.409638,used: 0:40:05.558929,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_12_47_00_seed_2_22478449
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.986911, 'precision': 0.9870216, 'recall': 0.986864, 'specificity': 0.986864, 'f1': 0.98690856, 'auroc': 0.9995995, 'binary_precision': 0.98138636, 'binary_recall': 0.99285716, 'binary_specificity': 0.9808707, 'binary_f1_score': 0.98708844}
confusion matrix:
      0     1
0  1487    29
1    11  1529
---- Validation: 
scalar performance:
{'acc': 0.8419405, 'precision': 0.86043024, 'recall': 0.8389121, 'specificity': 0.8389121, 'f1': 0.8389553, 'auroc': 0.90657043, 'binary_precision': 0.9356846, 'binary_recall': 0.7250804, 'binary_specificity': 0.9527439, 'binary_f1_score': 0.817029}
confusion matrix:
     0    1
0  625   31
1  171  451
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.849537, 'precision': 0.86010337, 'recall': 0.849537, 'specificity': 0.849537, 'f1': 0.84842515, 'auroc': 0.9024992, 'binary_precision': 0.92178774, 'binary_recall': 0.7638889, 'binary_specificity': 0.9351852, 'binary_f1_score': 0.8354431}
confusion matrix:
     0    1
0  202   14
1   51  165
new oracle model saved
early stop counter: 26
val acc:0.8419405221939087, best validation acc: 0.8575899600982666, corresponding to test acc:                         0.8472222089767456 / 0.8495370149612427
after epoch: 30,now: 2024-07-20 13:28:28.321194,epoch time: 0:01:22.307769,used: 0:41:27.866698,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_12_47_00_seed_2_22478449
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 0:41:27.866698 at 2024-07-20 13:28:28.321194
persisted model performance metric: 

scalar performance:
{'acc': 0.8472222, 'precision': 0.86525977, 'recall': 0.8472222, 'specificity': 0.8472222, 'f1': 0.8453125, 'auroc': 0.9154664, 'binary_precision': 0.9464286, 'binary_recall': 0.7361111, 'binary_specificity': 0.9583333, 'binary_f1_score': 0.828125}
confusion matrix:
     0    1
0  207    9
1   57  159
oracle model performance metric: 

scalar performance:
{'acc': 0.849537, 'precision': 0.86010337, 'recall': 0.849537, 'specificity': 0.849537, 'f1': 0.84842515, 'auroc': 0.9024992, 'binary_precision': 0.92178774, 'binary_recall': 0.7638889, 'binary_specificity': 0.9351852, 'binary_f1_score': 0.8354431}
confusion matrix:
     0    1
0  202   14
1   51  165
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_nofreeze_2024-07-19_18-41-07/rule_results/5.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_nofreeze_2024-07-19_18-41-07/confusion_matrix/5.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 455124 KiB |  13219 MiB | 224513 GiB | 224512 GiB |
|       from large pool | 414531 KiB |  13181 MiB | 221846 GiB | 221846 GiB |
|       from small pool |  40592 KiB |     60 MiB |   2666 GiB |   2666 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 455124 KiB |  13219 MiB | 224513 GiB | 224512 GiB |
|       from large pool | 414531 KiB |  13181 MiB | 221846 GiB | 221846 GiB |
|       from small pool |  40592 KiB |     60 MiB |   2666 GiB |   2666 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 447481 KiB |  13213 MiB | 223919 GiB | 223919 GiB |
|       from large pool | 407075 KiB |  13175 MiB | 221258 GiB | 221258 GiB |
|       from small pool |  40406 KiB |     60 MiB |   2660 GiB |   2660 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  14474 MiB |  14480 MiB |  41668 MiB |  27194 MiB |
|       from large pool |  14408 MiB |  14414 MiB |  41570 MiB |  27162 MiB |
|       from small pool |     66 MiB |     70 MiB |     98 MiB |     32 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 448044 KiB |   1253 MiB | 160461 GiB | 160460 GiB |
|       from large pool | 435388 KiB |   1244 MiB | 157779 GiB | 157778 GiB |
|       from small pool |  12655 KiB |     45 MiB |   2682 GiB |   2682 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    1298    |    2598    |   39284 K  |   39283 K  |
|       from large pool |     187    |    1413    |   20040 K  |   20040 K  |
|       from small pool |    1111    |    1419    |   19243 K  |   19242 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    1298    |    2598    |   39284 K  |   39283 K  |
|       from large pool |     187    |    1413    |   20040 K  |   20040 K  |
|       from small pool |    1111    |    1419    |   19243 K  |   19242 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     634    |     636    |    1778    |    1144    |
|       from large pool |     601    |     601    |    1729    |    1128    |
|       from small pool |      33    |      35    |      49    |      16    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     101    |     652    |   25578 K  |   25577 K  |
|       from large pool |      40    |     604    |   14370 K  |   14370 K  |
|       from small pool |      61    |     238    |   11207 K  |   11207 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13219 MiB | 224513 GiB | 224513 GiB |
|       from large pool |  16640 KiB |  13181 MiB | 221846 GiB | 221846 GiB |
|       from small pool |      0 KiB |     60 MiB |   2666 GiB |   2666 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13219 MiB | 224513 GiB | 224513 GiB |
|       from large pool |  16640 KiB |  13181 MiB | 221846 GiB | 221846 GiB |
|       from small pool |      0 KiB |     60 MiB |   2666 GiB |   2666 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13213 MiB | 223919 GiB | 223919 GiB |
|       from large pool |  16640 KiB |  13175 MiB | 221258 GiB | 221258 GiB |
|       from small pool |      0 KiB |     60 MiB |   2660 GiB |   2660 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    882 MiB |  14480 MiB |  41668 MiB |  40786 MiB |
|       from large pool |    830 MiB |  14414 MiB |  41570 MiB |  40740 MiB |
|       from small pool |     52 MiB |     70 MiB |     98 MiB |     46 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1253 MiB | 160461 GiB | 160461 GiB |
|       from large pool |  24320 KiB |   1244 MiB | 157779 GiB | 157779 GiB |
|       from small pool |      0 KiB |     45 MiB |   2682 GiB |   2682 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    2598    |   39284 K  |   39284 K  |
|       from large pool |       2    |    1413    |   20040 K  |   20040 K  |
|       from small pool |       0    |    1419    |   19243 K  |   19243 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    2598    |   39284 K  |   39284 K  |
|       from large pool |       2    |    1413    |   20040 K  |   20040 K  |
|       from small pool |       0    |    1419    |   19243 K  |   19243 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      63    |     636    |    1778    |    1715    |
|       from large pool |      37    |     601    |    1729    |    1692    |
|       from small pool |      26    |      35    |      49    |      23    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |     652    |   25578 K  |   25578 K  |
|       from large pool |       4    |     604    |   14370 K  |   14370 K  |
|       from small pool |       0    |     238    |   11207 K  |   11207 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Sat Jul 20 13:29:16 2024]
Finished job 0.
1 of 1 steps (100%) done
