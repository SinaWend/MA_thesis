Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Sat Jul 27 13:49:19 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_10seeds_nofreeze_2024-07-27_13-09-31/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_10seeds_nofreeze_2024-07-27_13-09-31/rule_results/3.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=3
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/swiglu_ffn.py:51: UserWarning: xFormers is not available (SwiGLU)
  warnings.warn("xFormers is not available (SwiGLU)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/attention.py:33: UserWarning: xFormers is not available (Attention)
  warnings.warn("xFormers is not available (Attention)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/block.py:40: UserWarning: xFormers is not available (Block)
  warnings.warn("xFormers is not available (Block)")
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center0_dann_b8efecac6_not_commited_2024md_07md_27_13_51_29_seed_0_23099037

 Experiment start at: 2024-07-27 13:51:29.737054
before training, model accuracy: 0.49534884095191956
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.90559894, 'precision': 0.91271937, 'recall': 0.90647316, 'specificity': 0.90647316, 'f1': 0.90530896, 'auroc': 0.95809484, 'binary_precision': 0.9702823, 'binary_recall': 0.8393316, 'binary_specificity': 0.97361475, 'binary_f1_score': 0.90006894}
confusion matrix:
      0     1
0  1476    40
1   250  1306
---- Validation: 
scalar performance:
{'acc': 0.7251553, 'precision': 0.7257668, 'recall': 0.72547054, 'specificity': 0.72547054, 'f1': 0.7251129, 'auroc': 0.77243495, 'binary_precision': 0.71001494, 'binary_recall': 0.7480315, 'binary_specificity': 0.70290965, 'binary_f1_score': 0.72852767}
confusion matrix:
     0    1
0  459  194
1  160  475
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7813954, 'precision': 0.7814197, 'recall': 0.7813953, 'specificity': 0.7813953, 'f1': 0.78139055, 'auroc': 0.8178258, 'binary_precision': 0.77880186, 'binary_recall': 0.7860465, 'binary_specificity': 0.7767442, 'binary_f1_score': 0.78240734}
confusion matrix:
     0    1
0  167   48
1   46  169
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-27 13:53:34.761332,epoch time: 0:02:05.024278,used: 0:02:05.024278,model: dset_te_center0_dann_b8efecac6_not_commited_2024md_07md_27_13_51_29_seed_0_23099037
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.92545575, 'precision': 0.9264264, 'recall': 0.9258113, 'specificity': 0.9258113, 'f1': 0.92544246, 'auroc': 0.9538053, 'binary_precision': 0.9504749, 'binary_recall': 0.89980733, 'binary_specificity': 0.9518152, 'binary_f1_score': 0.9244474}
confusion matrix:
      0     1
0  1442    73
1   156  1401
---- Validation: 
scalar performance:
{'acc': 0.54037267, 'precision': 0.5417527, 'recall': 0.5411945, 'specificity': 0.5411945, 'f1': 0.53916264, 'auroc': 0.5728322, 'binary_precision': 0.52990264, 'binary_recall': 0.6, 'binary_specificity': 0.48238897, 'binary_f1_score': 0.56277704}
confusion matrix:
     0    1
0  315  338
1  254  381
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6302326, 'precision': 0.73355055, 'recall': 0.6302326, 'specificity': 0.6302326, 'f1': 0.584253, 'auroc': 0.6353272, 'binary_precision': 0.57821226, 'binary_recall': 0.96279067, 'binary_specificity': 0.29767442, 'binary_f1_score': 0.722513}
confusion matrix:
    0    1
0  64  151
1   8  207
early stop counter: 1
val acc:0.5403726696968079, best validation acc: 0.7251552939414978, corresponding to test acc:                         0.7813953757286072 / 0.7813953757286072
after epoch: 2,now: 2024-07-27 13:55:31.976815,epoch time: 0:01:57.215483,used: 0:04:02.239761,model: dset_te_center0_dann_b8efecac6_not_commited_2024md_07md_27_13_51_29_seed_0_23099037
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.66796875, 'precision': 0.78500724, 'recall': 0.66374946, 'specificity': 0.66374946, 'f1': 0.626647, 'auroc': 0.6661468, 'binary_precision': 0.60559493, 'binary_recall': 0.9877892, 'binary_specificity': 0.33970976, 'binary_f1_score': 0.7508549}
confusion matrix:
     0     1
0  515  1001
1   19  1537
---- Validation: 
scalar performance:
{'acc': 0.71040374, 'precision': 0.7179562, 'recall': 0.71163857, 'specificity': 0.71163857, 'f1': 0.70861197, 'auroc': 0.7166765, 'binary_precision': 0.67374, 'binary_recall': 0.8, 'binary_specificity': 0.6232772, 'binary_f1_score': 0.73146147}
confusion matrix:
     0    1
0  407  246
1  127  508
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.66976744, 'precision': 0.7003498, 'recall': 0.66976744, 'specificity': 0.66976744, 'f1': 0.6566654, 'auroc': 0.66831803, 'binary_precision': 0.6220736, 'binary_recall': 0.8651163, 'binary_specificity': 0.4744186, 'binary_f1_score': 0.7237354}
confusion matrix:
     0    1
0  102  113
1   29  186
early stop counter: 2
val acc:0.7104037404060364, best validation acc: 0.7251552939414978, corresponding to test acc:                         0.7813953757286072 / 0.7813953757286072
after epoch: 3,now: 2024-07-27 13:57:30.060738,epoch time: 0:01:58.083923,used: 0:06:00.323684,model: dset_te_center0_dann_b8efecac6_not_commited_2024md_07md_27_13_51_29_seed_0_23099037
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.91829425, 'precision': 0.92705107, 'recall': 0.91929835, 'specificity': 0.91929835, 'f1': 0.91799045, 'auroc': 0.98728514, 'binary_precision': 0.99171686, 'binary_recall': 0.84585744, 'binary_specificity': 0.99273926, 'binary_f1_score': 0.9129983}
confusion matrix:
      0     1
0  1504    11
1   240  1317
---- Validation: 
scalar performance:
{'acc': 0.5947205, 'precision': 0.6553165, 'recall': 0.59021354, 'specificity': 0.59021354, 'f1': 0.5449404, 'auroc': 0.728449, 'binary_precision': 0.7488987, 'binary_recall': 0.26771653, 'binary_specificity': 0.91271055, 'binary_f1_score': 0.3944316}
confusion matrix:
     0    1
0  596   57
1  465  170
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5651163, 'precision': 0.65313387, 'recall': 0.5651163, 'specificity': 0.5651163, 'f1': 0.49213985, 'auroc': 0.8244024, 'binary_precision': 0.7692308, 'binary_recall': 0.18604651, 'binary_specificity': 0.94418603, 'binary_f1_score': 0.29962546}
confusion matrix:
     0   1
0  203  12
1  175  40
early stop counter: 3
val acc:0.5947204828262329, best validation acc: 0.7251552939414978, corresponding to test acc:                         0.7813953757286072 / 0.7813953757286072
after epoch: 4,now: 2024-07-27 13:59:27.473476,epoch time: 0:01:57.412738,used: 0:07:57.736422,model: dset_te_center0_dann_b8efecac6_not_commited_2024md_07md_27_13_51_29_seed_0_23099037
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.94596356, 'precision': 0.9476584, 'recall': 0.9463953, 'specificity': 0.9463953, 'f1': 0.94594014, 'auroc': 0.9813864, 'binary_precision': 0.97865015, 'binary_recall': 0.91323906, 'binary_specificity': 0.97955143, 'binary_f1_score': 0.94481385}
confusion matrix:
      0     1
0  1485    31
1   135  1421
---- Validation: 
scalar performance:
{'acc': 0.67624223, 'precision': 0.7542638, 'recall': 0.6800533, 'specificity': 0.6800533, 'f1': 0.652145, 'auroc': 0.6812229, 'binary_precision': 0.609879, 'binary_recall': 0.9527559, 'binary_specificity': 0.4073507, 'binary_f1_score': 0.7437}
confusion matrix:
     0    1
0  266  387
1   30  605
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.73953485, 'precision': 0.78516054, 'recall': 0.73953485, 'specificity': 0.73953485, 'f1': 0.72868216, 'auroc': 0.7493781, 'binary_precision': 0.6710963, 'binary_recall': 0.9395349, 'binary_specificity': 0.53953487, 'binary_f1_score': 0.78294575}
confusion matrix:
     0    1
0  116   99
1   13  202
early stop counter: 4
val acc:0.6762422323226929, best validation acc: 0.7251552939414978, corresponding to test acc:                         0.7813953757286072 / 0.7813953757286072
after epoch: 5,now: 2024-07-27 14:01:25.012353,epoch time: 0:01:57.538877,used: 0:09:55.275299,model: dset_te_center0_dann_b8efecac6_not_commited_2024md_07md_27_13_51_29_seed_0_23099037
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9270833, 'precision': 0.92778194, 'recall': 0.9273902, 'specificity': 0.9273902, 'f1': 0.9270764, 'auroc': 0.9650494, 'binary_precision': 0.94882154, 'binary_recall': 0.90494543, 'binary_specificity': 0.949835, 'binary_f1_score': 0.9263643}
confusion matrix:
      0     1
0  1439    76
1   148  1409
---- Validation: 
scalar performance:
{'acc': 0.63975155, 'precision': 0.73384464, 'recall': 0.64410895, 'specificity': 0.64410895, 'f1': 0.6033883, 'auroc': 0.6495653, 'binary_precision': 0.58197504, 'binary_recall': 0.9559055, 'binary_specificity': 0.3323124, 'binary_f1_score': 0.72348034}
confusion matrix:
     0    1
0  217  436
1   28  607
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7186046, 'precision': 0.7614083, 'recall': 0.7186046, 'specificity': 0.7186046, 'f1': 0.7065939, 'auroc': 0.7238291, 'binary_precision': 0.65562916, 'binary_recall': 0.9209302, 'binary_specificity': 0.51627904, 'binary_f1_score': 0.7659575}
confusion matrix:
     0    1
0  111  104
1   17  198
early stop counter: 5
val acc:0.6397515535354614, best validation acc: 0.7251552939414978, corresponding to test acc:                         0.7813953757286072 / 0.7813953757286072
after epoch: 6,now: 2024-07-27 14:03:22.324408,epoch time: 0:01:57.312055,used: 0:11:52.587354,model: dset_te_center0_dann_b8efecac6_not_commited_2024md_07md_27_13_51_29_seed_0_23099037
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 6 with time: 0:11:52.587354 at 2024-07-27 14:03:22.324408
persisted model performance metric: 

scalar performance:
{'acc': 0.7813954, 'precision': 0.7814197, 'recall': 0.7813953, 'specificity': 0.7813953, 'f1': 0.78139055, 'auroc': 0.8178258, 'binary_precision': 0.77880186, 'binary_recall': 0.7860465, 'binary_specificity': 0.7767442, 'binary_f1_score': 0.78240734}
confusion matrix:
     0    1
0  167   48
1   46  169
oracle model performance metric: 

scalar performance:
{'acc': 0.7813954, 'precision': 0.7814197, 'recall': 0.7813953, 'specificity': 0.7813953, 'f1': 0.78139055, 'auroc': 0.8178258, 'binary_precision': 0.77880186, 'binary_recall': 0.7860465, 'binary_specificity': 0.7767442, 'binary_f1_score': 0.78240734}
confusion matrix:
     0    1
0  167   48
1   46  169
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_10seeds_nofreeze_2024-07-27_13-09-31/rule_results/3.csv
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_10seeds_nofreeze_2024-07-27_13-09-31/rule_results/3.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_10seeds_nofreeze_2024-07-27_13-09-31/confusion_matrix/3.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 455608 KiB |   3602 MiB |  21674 GiB |  21674 GiB |
|       from large pool | 415006 KiB |   3568 MiB |  21427 GiB |  21426 GiB |
|       from small pool |  40602 KiB |     56 MiB |    247 GiB |    247 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 455608 KiB |   3602 MiB |  21674 GiB |  21674 GiB |
|       from large pool | 415006 KiB |   3568 MiB |  21427 GiB |  21426 GiB |
|       from small pool |  40602 KiB |     56 MiB |    247 GiB |    247 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 447481 KiB |   3596 MiB |  21582 GiB |  21582 GiB |
|       from large pool | 407075 KiB |   3563 MiB |  21335 GiB |  21334 GiB |
|       from small pool |  40406 KiB |     56 MiB |    247 GiB |    247 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   4016 MiB |   4016 MiB |   4016 MiB |      0 B   |
|       from large pool |   3952 MiB |   3952 MiB |   3952 MiB |      0 B   |
|       from small pool |     64 MiB |     64 MiB |     64 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory | 351303 KiB | 496525 KiB |  15171 GiB |  15171 GiB |
|       from large pool | 342754 KiB | 492852 KiB |  14918 GiB |  14918 GiB |
|       from small pool |   8549 KiB |  14115 KiB |    252 GiB |    252 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    1318    |    1697    |    3794 K  |    3793 K  |
|       from large pool |     187    |     468    |    1976 K  |    1975 K  |
|       from small pool |    1131    |    1435    |    1818 K  |    1817 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    1318    |    1697    |    3794 K  |    3793 K  |
|       from large pool |     187    |     468    |    1976 K  |    1975 K  |
|       from small pool |    1131    |    1435    |    1818 K  |    1817 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     198    |     198    |     198    |       0    |
|       from large pool |     166    |     166    |     166    |       0    |
|       from small pool |      32    |      32    |      32    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      81    |     251    |    2214 K  |    2214 K  |
|       from large pool |      31    |     165    |    1332 K  |    1332 K  |
|       from small pool |      50    |     220    |     881 K  |     881 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   3602 MiB |  21674 GiB |  21674 GiB |
|       from large pool |  16640 KiB |   3568 MiB |  21427 GiB |  21427 GiB |
|       from small pool |      0 KiB |     56 MiB |    247 GiB |    247 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   3602 MiB |  21674 GiB |  21674 GiB |
|       from large pool |  16640 KiB |   3568 MiB |  21427 GiB |  21427 GiB |
|       from small pool |      0 KiB |     56 MiB |    247 GiB |    247 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   3596 MiB |  21582 GiB |  21582 GiB |
|       from large pool |  16640 KiB |   3563 MiB |  21335 GiB |  21335 GiB |
|       from small pool |      0 KiB |     56 MiB |    247 GiB |    247 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    788 MiB |   4016 MiB |   4016 MiB |   3228 MiB |
|       from large pool |    740 MiB |   3952 MiB |   3952 MiB |   3212 MiB |
|       from small pool |     48 MiB |     64 MiB |     64 MiB |     16 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 496525 KiB |  15172 GiB |  15172 GiB |
|       from large pool |  24320 KiB | 492852 KiB |  14919 GiB |  14919 GiB |
|       from small pool |      0 KiB |  24365 KiB |    253 GiB |    253 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    1697    |    3794 K  |    3794 K  |
|       from large pool |       2    |     468    |    1976 K  |    1976 K  |
|       from small pool |       0    |    1435    |    1818 K  |    1818 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    1697    |    3794 K  |    3794 K  |
|       from large pool |       2    |     468    |    1976 K  |    1976 K  |
|       from small pool |       0    |    1435    |    1818 K  |    1818 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      58    |     198    |     198    |     140    |
|       from large pool |      34    |     166    |     166    |     132    |
|       from small pool |      24    |      32    |      32    |       8    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     251    |    2214 K  |    2214 K  |
|       from large pool |       3    |     165    |    1332 K  |    1332 K  |
|       from small pool |       0    |     220    |     881 K  |     881 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   3602 MiB |  21674 GiB |  21674 GiB |
|       from large pool |  16640 KiB |   3568 MiB |  21427 GiB |  21427 GiB |
|       from small pool |      0 KiB |     56 MiB |    247 GiB |    247 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   3602 MiB |  21674 GiB |  21674 GiB |
|       from large pool |  16640 KiB |   3568 MiB |  21427 GiB |  21427 GiB |
|       from small pool |      0 KiB |     56 MiB |    247 GiB |    247 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   3596 MiB |  21582 GiB |  21582 GiB |
|       from large pool |  16640 KiB |   3563 MiB |  21335 GiB |  21335 GiB |
|       from small pool |      0 KiB |     56 MiB |    247 GiB |    247 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    788 MiB |   4016 MiB |   4016 MiB |   3228 MiB |
|       from large pool |    740 MiB |   3952 MiB |   3952 MiB |   3212 MiB |
|       from small pool |     48 MiB |     64 MiB |     64 MiB |     16 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 496525 KiB |  15172 GiB |  15172 GiB |
|       from large pool |  24320 KiB | 492852 KiB |  14919 GiB |  14919 GiB |
|       from small pool |      0 KiB |  24365 KiB |    253 GiB |    253 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    1697    |    3794 K  |    3794 K  |
|       from large pool |       2    |     468    |    1976 K  |    1976 K  |
|       from small pool |       0    |    1435    |    1818 K  |    1818 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    1697    |    3794 K  |    3794 K  |
|       from large pool |       2    |     468    |    1976 K  |    1976 K  |
|       from small pool |       0    |    1435    |    1818 K  |    1818 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      58    |     198    |     198    |     140    |
|       from large pool |      34    |     166    |     166    |     132    |
|       from small pool |      24    |      32    |      32    |       8    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     251    |    2214 K  |    2214 K  |
|       from large pool |       3    |     165    |    1332 K  |    1332 K  |
|       from small pool |       0    |     220    |     881 K  |     881 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center0_dann_b8efecac6_not_commited_2024md_07md_27_14_03_53_seed_1_23099037

 Experiment start at: 2024-07-27 14:03:54.055912
before training, model accuracy: 0.5911111235618591
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.88151044, 'precision': 0.8875188, 'recall': 0.8822496, 'specificity': 0.8822496, 'f1': 0.8811799, 'auroc': 0.9023274, 'binary_precision': 0.93879056, 'binary_recall': 0.8191763, 'binary_specificity': 0.9453228, 'binary_f1_score': 0.87491405}
confusion matrix:
      0     1
0  1435    83
1   281  1273
---- Validation: 
scalar performance:
{'acc': 0.8017174, 'precision': 0.80166173, 'recall': 0.80168974, 'specificity': 0.80168974, 'f1': 0.80167377, 'auroc': 0.83004904, 'binary_precision': 0.79746836, 'binary_recall': 0.8, 'binary_specificity': 0.8033794, 'binary_f1_score': 0.79873216}
confusion matrix:
     0    1
0  523  128
1  126  504
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7977778, 'precision': 0.79910713, 'recall': 0.7977778, 'specificity': 0.7977778, 'f1': 0.7975529, 'auroc': 0.85761976, 'binary_precision': 0.77916664, 'binary_recall': 0.83111113, 'binary_specificity': 0.7644445, 'binary_f1_score': 0.8043011}
confusion matrix:
     0    1
0  172   53
1   38  187
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-27 14:05:59.048884,epoch time: 0:02:04.992972,used: 0:02:04.992972,model: dset_te_center0_dann_b8efecac6_not_commited_2024md_07md_27_14_03_53_seed_1_23099037
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.8649089, 'precision': 0.8907789, 'recall': 0.8666775, 'specificity': 0.8666775, 'f1': 0.8630173, 'auroc': 0.8681265, 'binary_precision': 0.9948007, 'binary_recall': 0.73731536, 'binary_specificity': 0.9960396, 'binary_f1_score': 0.84692}
confusion matrix:
      0     1
0  1509     6
1   409  1148
---- Validation: 
scalar performance:
{'acc': 0.5003903, 'precision': 0.3885479, 'recall': 0.49247313, 'specificity': 0.49247313, 'f1': 0.34166318, 'auroc': 0.4924122, 'binary_precision': 0.27272728, 'binary_recall': 0.00952381, 'binary_specificity': 0.97542244, 'binary_f1_score': 0.018404908}
confusion matrix:
     0   1
0  635  16
1  624   6
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.4911111, 'precision': 0.37273756, 'recall': 0.49111113, 'specificity': 0.49111113, 'f1': 0.33691955, 'auroc': 0.49109137, 'binary_precision': 0.25, 'binary_recall': 0.008888889, 'binary_specificity': 0.97333336, 'binary_f1_score': 0.017167382}
confusion matrix:
     0  1
0  219  6
1  223  2
early stop counter: 1
val acc:0.5003902912139893, best validation acc: 0.8017174005508423, corresponding to test acc:                         0.7977777719497681 / 0.7977777719497681
after epoch: 2,now: 2024-07-27 14:07:56.328898,epoch time: 0:01:57.280014,used: 0:04:02.272986,model: dset_te_center0_dann_b8efecac6_not_commited_2024md_07md_27_14_03_53_seed_1_23099037
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.8779297, 'precision': 0.90027034, 'recall': 0.8795583, 'specificity': 0.8795583, 'f1': 0.8765133, 'auroc': 0.8800179, 'binary_precision': 0.99831367, 'binary_recall': 0.7604367, 'binary_specificity': 0.9986799, 'binary_f1_score': 0.86328834}
confusion matrix:
      0     1
0  1513     2
1   373  1184
---- Validation: 
scalar performance:
{'acc': 0.51053864, 'precision': 0.51472366, 'recall': 0.5033282, 'specificity': 0.5033282, 'f1': 0.38757437, 'auroc': 0.5045035, 'binary_precision': 0.5194805, 'binary_recall': 0.06349207, 'binary_specificity': 0.94316435, 'binary_f1_score': 0.11315418}
confusion matrix:
     0   1
0  614  37
1  590  40
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.51111114, 'precision': 0.5990143, 'recall': 0.5111111, 'specificity': 0.5111111, 'f1': 0.37165198, 'auroc': 0.5108346, 'binary_precision': 0.6923077, 'binary_recall': 0.04, 'binary_specificity': 0.9822222, 'binary_f1_score': 0.07563025}
confusion matrix:
     0  1
0  221  4
1  216  9
early stop counter: 2
val acc:0.510538637638092, best validation acc: 0.8017174005508423, corresponding to test acc:                         0.7977777719497681 / 0.7977777719497681
after epoch: 3,now: 2024-07-27 14:09:54.186113,epoch time: 0:01:57.857215,used: 0:06:00.130201,model: dset_te_center0_dann_b8efecac6_not_commited_2024md_07md_27_14_03_53_seed_1_23099037
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.88216144, 'precision': 0.90149045, 'recall': 0.88345766, 'specificity': 0.88345766, 'f1': 0.8809649, 'auroc': 0.8856523, 'binary_precision': 0.992562, 'binary_recall': 0.77284425, 'binary_specificity': 0.9940711, 'binary_f1_score': 0.8690304}
confusion matrix:
      0     1
0  1509     9
1   353  1201
---- Validation: 
scalar performance:
{'acc': 0.72521466, 'precision': 0.7341002, 'recall': 0.7235279, 'specificity': 0.7235279, 'f1': 0.72154784, 'auroc': 0.7344427, 'binary_precision': 0.7757937, 'binary_recall': 0.6206349, 'binary_specificity': 0.8264209, 'binary_f1_score': 0.6895944}
confusion matrix:
     0    1
0  538  113
1  239  391
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.73777777, 'precision': 0.76325864, 'recall': 0.73777777, 'specificity': 0.73777777, 'f1': 0.7312753, 'auroc': 0.74621236, 'binary_precision': 0.8451613, 'binary_recall': 0.5822222, 'binary_specificity': 0.8933333, 'binary_f1_score': 0.6894737}
confusion matrix:
     0    1
0  201   24
1   94  131
early stop counter: 3
val acc:0.7252146601676941, best validation acc: 0.8017174005508423, corresponding to test acc:                         0.7977777719497681 / 0.7977777719497681
after epoch: 4,now: 2024-07-27 14:11:51.405090,epoch time: 0:01:57.218977,used: 0:07:57.349178,model: dset_te_center0_dann_b8efecac6_not_commited_2024md_07md_27_14_03_53_seed_1_23099037
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.85839844, 'precision': 0.88516057, 'recall': 0.85986197, 'specificity': 0.85986197, 'f1': 0.85623324, 'auroc': 0.86252713, 'binary_precision': 0.9894921, 'binary_recall': 0.72762394, 'binary_specificity': 0.99210006, 'binary_f1_score': 0.83858997}
confusion matrix:
      0     1
0  1507    12
1   423  1130
---- Validation: 
scalar performance:
{'acc': 0.5839188, 'precision': 0.6021496, 'recall': 0.58013314, 'specificity': 0.58013314, 'f1': 0.5583893, 'auroc': 0.5829445, 'binary_precision': 0.64139944, 'binary_recall': 0.34920636, 'binary_specificity': 0.8110599, 'binary_f1_score': 0.45220968}
confusion matrix:
     0    1
0  528  123
1  410  220
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7, 'precision': 0.70439684, 'recall': 0.7, 'specificity': 0.7, 'f1': 0.69837797, 'auroc': 0.7118815, 'binary_precision': 0.734375, 'binary_recall': 0.62666667, 'binary_specificity': 0.7733333, 'binary_f1_score': 0.676259}
confusion matrix:
     0    1
0  174   51
1   84  141
early stop counter: 4
val acc:0.5839188098907471, best validation acc: 0.8017174005508423, corresponding to test acc:                         0.7977777719497681 / 0.7977777719497681
after epoch: 5,now: 2024-07-27 14:13:48.835919,epoch time: 0:01:57.430829,used: 0:09:54.780007,model: dset_te_center0_dann_b8efecac6_not_commited_2024md_07md_27_14_03_53_seed_1_23099037
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.8388672, 'precision': 0.8477863, 'recall': 0.8400645, 'specificity': 0.8400645, 'f1': 0.83813226, 'auroc': 0.8690769, 'binary_precision': 0.90735066, 'binary_recall': 0.7601026, 'binary_specificity': 0.9200264, 'binary_f1_score': 0.82722515}
confusion matrix:
      0     1
0  1392   121
1   374  1185
---- Validation: 
scalar performance:
{'acc': 0.49258393, 'precision': 0.30789152, 'recall': 0.48471585, 'specificity': 0.48471585, 'f1': 0.33405903, 'auroc': 0.48469025, 'binary_precision': 0.115384616, 'binary_recall': 0.004761905, 'binary_specificity': 0.96466976, 'binary_f1_score': 0.009146342}
confusion matrix:
     0   1
0  628  23
1  627   3
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.4977778, 'precision': 0.4161074, 'recall': 0.49777776, 'specificity': 0.49777776, 'f1': 0.33623123, 'auroc': 0.49779755, 'binary_precision': 0.33333334, 'binary_recall': 0.0044444446, 'binary_specificity': 0.9911111, 'binary_f1_score': 0.00877193}
confusion matrix:
     0  1
0  223  2
1  224  1
early stop counter: 5
val acc:0.4925839304924011, best validation acc: 0.8017174005508423, corresponding to test acc:                         0.7977777719497681 / 0.7977777719497681
after epoch: 6,now: 2024-07-27 14:15:46.363266,epoch time: 0:01:57.527347,used: 0:11:52.307354,model: dset_te_center0_dann_b8efecac6_not_commited_2024md_07md_27_14_03_53_seed_1_23099037
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 6 with time: 0:11:52.307354 at 2024-07-27 14:15:46.363266
persisted model performance metric: 

scalar performance:
{'acc': 0.7977778, 'precision': 0.79910713, 'recall': 0.7977778, 'specificity': 0.7977778, 'f1': 0.7975529, 'auroc': 0.85761976, 'binary_precision': 0.77916664, 'binary_recall': 0.83111113, 'binary_specificity': 0.7644445, 'binary_f1_score': 0.8043011}
confusion matrix:
     0    1
0  172   53
1   38  187
oracle model performance metric: 

scalar performance:
{'acc': 0.7977778, 'precision': 0.79910713, 'recall': 0.7977778, 'specificity': 0.7977778, 'f1': 0.7975529, 'auroc': 0.85761976, 'binary_precision': 0.77916664, 'binary_recall': 0.83111113, 'binary_specificity': 0.7644445, 'binary_f1_score': 0.8043011}
confusion matrix:
     0    1
0  172   53
1   38  187
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_10seeds_nofreeze_2024-07-27_13-09-31/rule_results/3.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_10seeds_nofreeze_2024-07-27_13-09-31/confusion_matrix/3.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 454480 KiB |   3602 MiB |  43291 GiB |  43291 GiB |
|       from large pool | 413871 KiB |   3568 MiB |  42793 GiB |  42793 GiB |
|       from small pool |  40608 KiB |     60 MiB |    498 GiB |    497 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 454480 KiB |   3602 MiB |  43291 GiB |  43291 GiB |
|       from large pool | 413871 KiB |   3568 MiB |  42793 GiB |  42793 GiB |
|       from small pool |  40608 KiB |     60 MiB |    498 GiB |    497 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 447482 KiB |   3596 MiB |  43186 GiB |  43185 GiB |
|       from large pool | 407075 KiB |   3563 MiB |  42689 GiB |  42688 GiB |
|       from small pool |  40407 KiB |     60 MiB |    497 GiB |    497 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   4008 MiB |   4016 MiB |   7236 MiB |   3228 MiB |
|       from large pool |   3940 MiB |   3952 MiB |   7152 MiB |   3212 MiB |
|       from small pool |     68 MiB |     68 MiB |     84 MiB |     16 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 350384 KiB | 496525 KiB |  30281 GiB |  30280 GiB |
|       from large pool | 341840 KiB | 492852 KiB |  29772 GiB |  29771 GiB |
|       from small pool |   8543 KiB |  24365 KiB |    509 GiB |    509 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    1330    |    1709    |    7600 K  |    7598 K  |
|       from large pool |     187    |     468    |    3953 K  |    3953 K  |
|       from small pool |    1143    |    1447    |    3646 K  |    3645 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    1330    |    1709    |    7600 K  |    7598 K  |
|       from large pool |     187    |     468    |    3953 K  |    3953 K  |
|       from small pool |    1143    |    1447    |    3646 K  |    3645 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     200    |     200    |     340    |     140    |
|       from large pool |     166    |     166    |     298    |     132    |
|       from small pool |      34    |      34    |      42    |       8    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      81    |     253    |    4350 K  |    4350 K  |
|       from large pool |      34    |     165    |    2580 K  |    2580 K  |
|       from small pool |      47    |     220    |    1770 K  |    1770 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   3602 MiB |  43291 GiB |  43291 GiB |
|       from large pool |  16640 KiB |   3568 MiB |  42793 GiB |  42793 GiB |
|       from small pool |      0 KiB |     60 MiB |    498 GiB |    498 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   3602 MiB |  43291 GiB |  43291 GiB |
|       from large pool |  16640 KiB |   3568 MiB |  42793 GiB |  42793 GiB |
|       from small pool |      0 KiB |     60 MiB |    498 GiB |    498 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   3596 MiB |  43186 GiB |  43186 GiB |
|       from large pool |  16640 KiB |   3563 MiB |  42689 GiB |  42689 GiB |
|       from small pool |      0 KiB |     60 MiB |    497 GiB |    497 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    786 MiB |   4016 MiB |   7236 MiB |   6450 MiB |
|       from large pool |    738 MiB |   3952 MiB |   7152 MiB |   6414 MiB |
|       from small pool |     48 MiB |     68 MiB |     84 MiB |     36 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 496525 KiB |  30281 GiB |  30281 GiB |
|       from large pool |  24320 KiB | 492852 KiB |  29772 GiB |  29772 GiB |
|       from small pool |      0 KiB |  32850 KiB |    509 GiB |    509 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    1709    |    7600 K  |    7600 K  |
|       from large pool |       2    |     468    |    3953 K  |    3953 K  |
|       from small pool |       0    |    1447    |    3646 K  |    3646 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    1709    |    7600 K  |    7600 K  |
|       from large pool |       2    |     468    |    3953 K  |    3953 K  |
|       from small pool |       0    |    1447    |    3646 K  |    3646 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      57    |     200    |     340    |     283    |
|       from large pool |      33    |     166    |     298    |     265    |
|       from small pool |      24    |      34    |      42    |      18    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     253    |    4351 K  |    4351 K  |
|       from large pool |       3    |     165    |    2580 K  |    2580 K  |
|       from small pool |       0    |     220    |    1770 K  |    1770 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   3602 MiB |  43291 GiB |  43291 GiB |
|       from large pool |  16640 KiB |   3568 MiB |  42793 GiB |  42793 GiB |
|       from small pool |      0 KiB |     60 MiB |    498 GiB |    498 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   3602 MiB |  43291 GiB |  43291 GiB |
|       from large pool |  16640 KiB |   3568 MiB |  42793 GiB |  42793 GiB |
|       from small pool |      0 KiB |     60 MiB |    498 GiB |    498 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   3596 MiB |  43186 GiB |  43186 GiB |
|       from large pool |  16640 KiB |   3563 MiB |  42689 GiB |  42689 GiB |
|       from small pool |      0 KiB |     60 MiB |    497 GiB |    497 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    786 MiB |   4016 MiB |   7236 MiB |   6450 MiB |
|       from large pool |    738 MiB |   3952 MiB |   7152 MiB |   6414 MiB |
|       from small pool |     48 MiB |     68 MiB |     84 MiB |     36 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 496525 KiB |  30281 GiB |  30281 GiB |
|       from large pool |  24320 KiB | 492852 KiB |  29772 GiB |  29772 GiB |
|       from small pool |      0 KiB |  32850 KiB |    509 GiB |    509 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    1709    |    7600 K  |    7600 K  |
|       from large pool |       2    |     468    |    3953 K  |    3953 K  |
|       from small pool |       0    |    1447    |    3646 K  |    3646 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    1709    |    7600 K  |    7600 K  |
|       from large pool |       2    |     468    |    3953 K  |    3953 K  |
|       from small pool |       0    |    1447    |    3646 K  |    3646 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      57    |     200    |     340    |     283    |
|       from large pool |      33    |     166    |     298    |     265    |
|       from small pool |      24    |      34    |      42    |      18    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     253    |    4351 K  |    4351 K  |
|       from large pool |       3    |     165    |    2580 K  |    2580 K  |
|       from small pool |       0    |     220    |    1770 K  |    1770 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center0_dann_b8efecac6_not_commited_2024md_07md_27_14_16_16_seed_2_23099037

 Experiment start at: 2024-07-27 14:16:17.097426
before training, model accuracy: 0.5254629850387573
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.82918847, 'precision': 0.8442062, 'recall': 0.8283658, 'specificity': 0.8283658, 'f1': 0.8270477, 'auroc': 0.94779754, 'binary_precision': 0.7742457, 'binary_recall': 0.9331169, 'binary_specificity': 0.72361475, 'binary_f1_score': 0.84628975}
confusion matrix:
      0     1
0  1097   419
1   103  1437
---- Validation: 
scalar performance:
{'acc': 0.6001565, 'precision': 0.7499986, 'recall': 0.61018497, 'specificity': 0.61018497, 'f1': 0.540347, 'auroc': 0.7692632, 'binary_precision': 0.5496867, 'binary_recall': 0.9871383, 'binary_specificity': 0.23323171, 'binary_f1_score': 0.7061529}
confusion matrix:
     0    1
0  153  503
1    8  614
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6412037, 'precision': 0.7693927, 'recall': 0.6412037, 'specificity': 0.6412037, 'f1': 0.5927577, 'auroc': 0.84370714, 'binary_precision': 0.58356166, 'binary_recall': 0.9861111, 'binary_specificity': 0.2962963, 'binary_f1_score': 0.73321855}
confusion matrix:
    0    1
0  64  152
1   3  213
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-27 14:18:19.163544,epoch time: 0:02:02.066118,used: 0:02:02.066118,model: dset_te_center0_dann_b8efecac6_not_commited_2024md_07md_27_14_16_16_seed_2_23099037
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.7843586, 'precision': 0.79342437, 'recall': 0.78365916, 'specificity': 0.78365916, 'f1': 0.78238547, 'auroc': 0.8882415, 'binary_precision': 0.74377424, 'binary_recall': 0.8727273, 'binary_specificity': 0.69459105, 'binary_f1_score': 0.8031072}
confusion matrix:
      0     1
0  1053   463
1   196  1344
---- Validation: 
scalar performance:
{'acc': 0.48669797, 'precision': 0.24334899, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.32736844, 'auroc': 0.668249, 'binary_precision': 0.48669797, 'binary_recall': 1.0, 'binary_specificity': 0.0, 'binary_f1_score': 0.6547369}
confusion matrix:
   0    1
0  0  656
1  0  622
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5023148, 'precision': 0.7505801, 'recall': 0.5023148, 'specificity': 0.5023148, 'f1': 0.3384568, 'auroc': 0.6055277, 'binary_precision': 0.5011601, 'binary_recall': 1.0, 'binary_specificity': 0.0046296297, 'binary_f1_score': 0.667697}
confusion matrix:
   0    1
0  1  215
1  0  216
early stop counter: 1
val acc:0.4866979718208313, best validation acc: 0.6001564860343933, corresponding to test acc:                         0.6412037014961243 / 0.6412037014961243
after epoch: 2,now: 2024-07-27 14:20:15.440720,epoch time: 0:01:56.277176,used: 0:03:58.343294,model: dset_te_center0_dann_b8efecac6_not_commited_2024md_07md_27_14_16_16_seed_2_23099037
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.8599476, 'precision': 0.8844464, 'recall': 0.8609413, 'specificity': 0.8609413, 'f1': 0.85790956, 'auroc': 0.86584616, 'binary_precision': 0.98347825, 'binary_recall': 0.7344156, 'binary_specificity': 0.987467, 'binary_f1_score': 0.8408922}
confusion matrix:
      0     1
0  1497    19
1   409  1131
---- Validation: 
scalar performance:
{'acc': 0.6744914, 'precision': 0.6749486, 'recall': 0.6732609, 'specificity': 0.6732609, 'f1': 0.6731458, 'auroc': 0.69357425, 'binary_precision': 0.6794425, 'binary_recall': 0.62700963, 'binary_specificity': 0.7195122, 'binary_f1_score': 0.65217394}
confusion matrix:
     0    1
0  472  184
1  232  390
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7152778, 'precision': 0.75930035, 'recall': 0.7152778, 'specificity': 0.7152778, 'f1': 0.7026575, 'auroc': 0.7176355, 'binary_precision': 0.86614174, 'binary_recall': 0.5092593, 'binary_specificity': 0.9212963, 'binary_f1_score': 0.64139944}
confusion matrix:
     0    1
0  199   17
1  106  110
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-07-27 14:22:12.542570,epoch time: 0:01:57.101850,used: 0:05:55.445144,model: dset_te_center0_dann_b8efecac6_not_commited_2024md_07md_27_14_16_16_seed_2_23099037
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.861911, 'precision': 0.88993365, 'recall': 0.8629664, 'specificity': 0.8629664, 'f1': 0.8596248, 'auroc': 0.864385, 'binary_precision': 0.9964476, 'binary_recall': 0.7285714, 'binary_specificity': 0.9973615, 'binary_f1_score': 0.84171045}
confusion matrix:
      0     1
0  1512     4
1   418  1122
---- Validation: 
scalar performance:
{'acc': 0.5226917, 'precision': 0.54709935, 'recall': 0.51106286, 'specificity': 0.51106286, 'f1': 0.4010179, 'auroc': 0.5119426, 'binary_precision': 0.575, 'binary_recall': 0.073954985, 'binary_specificity': 0.9481707, 'binary_f1_score': 0.13105412}
confusion matrix:
     0   1
0  622  34
1  576  46
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5, 'precision': 0.5, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.3528449, 'auroc': 0.5022505, 'binary_precision': 0.5, 'binary_recall': 0.023148147, 'binary_specificity': 0.9768519, 'binary_f1_score': 0.044247787}
confusion matrix:
     0  1
0  211  5
1  211  5
early stop counter: 1
val acc:0.5226917266845703, best validation acc: 0.6744914054870605, corresponding to test acc:                         0.7152777910232544 / 0.7152777910232544
after epoch: 4,now: 2024-07-27 14:24:08.837792,epoch time: 0:01:56.295222,used: 0:07:51.740366,model: dset_te_center0_dann_b8efecac6_not_commited_2024md_07md_27_14_16_16_seed_2_23099037
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.86943716, 'precision': 0.89497304, 'recall': 0.8704392, 'specificity': 0.8704392, 'f1': 0.8675055, 'auroc': 0.87116903, 'binary_precision': 0.9973845, 'binary_recall': 0.74285716, 'binary_specificity': 0.9980211, 'binary_f1_score': 0.8515073}
confusion matrix:
      0     1
0  1513     3
1   396  1144
---- Validation: 
scalar performance:
{'acc': 0.4968701, 'precision': 0.4105565, 'recall': 0.48474383, 'specificity': 0.48474383, 'f1': 0.35522562, 'auroc': 0.48319495, 'binary_precision': 0.31578946, 'binary_recall': 0.028938906, 'binary_specificity': 0.9405488, 'binary_f1_score': 0.053019144}
confusion matrix:
     0   1
0  617  39
1  604  18
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5092593, 'precision': 0.6690141, 'recall': 0.5092593, 'specificity': 0.5092593, 'f1': 0.35741347, 'auroc': 0.5070088, 'binary_precision': 0.8333333, 'binary_recall': 0.023148147, 'binary_specificity': 0.9953704, 'binary_f1_score': 0.045045048}
confusion matrix:
     0  1
0  215  1
1  211  5
early stop counter: 2
val acc:0.49687010049819946, best validation acc: 0.6744914054870605, corresponding to test acc:                         0.7152777910232544 / 0.7152777910232544
after epoch: 5,now: 2024-07-27 14:26:05.645538,epoch time: 0:01:56.807746,used: 0:09:48.548112,model: dset_te_center0_dann_b8efecac6_not_commited_2024md_07md_27_14_16_16_seed_2_23099037
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.89561516, 'precision': 0.8956919, 'recall': 0.89567816, 'specificity': 0.89567816, 'f1': 0.8956151, 'auroc': 0.93626726, 'binary_precision': 0.903503, 'binary_recall': 0.88766235, 'binary_specificity': 0.9036939, 'binary_f1_score': 0.89551264}
confusion matrix:
      0     1
0  1370   146
1   173  1367
---- Validation: 
scalar performance:
{'acc': 0.670579, 'precision': 0.7376205, 'recall': 0.6774076, 'specificity': 0.6774076, 'f1': 0.6506834, 'auroc': 0.7083035, 'binary_precision': 0.60457855, 'binary_recall': 0.9340836, 'binary_specificity': 0.4207317, 'binary_f1_score': 0.7340492}
confusion matrix:
     0    1
0  276  380
1   41  581
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7685185, 'precision': 0.7893837, 'recall': 0.76851857, 'specificity': 0.76851857, 'f1': 0.76426935, 'auroc': 0.8207519, 'binary_precision': 0.7116788, 'binary_recall': 0.9027778, 'binary_specificity': 0.6342593, 'binary_f1_score': 0.79591835}
confusion matrix:
     0    1
0  137   79
1   21  195
new oracle model saved
early stop counter: 3
val acc:0.6705790162086487, best validation acc: 0.6744914054870605, corresponding to test acc:                         0.7152777910232544 / 0.7685185074806213
after epoch: 6,now: 2024-07-27 14:28:02.667541,epoch time: 0:01:57.022003,used: 0:11:45.570115,model: dset_te_center0_dann_b8efecac6_not_commited_2024md_07md_27_14_16_16_seed_2_23099037
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.89365184, 'precision': 0.90329874, 'recall': 0.89426464, 'specificity': 0.89426464, 'f1': 0.8931129, 'auroc': 0.905285, 'binary_precision': 0.96766746, 'binary_recall': 0.81623375, 'binary_specificity': 0.9722955, 'binary_f1_score': 0.8855231}
confusion matrix:
      0     1
0  1474    42
1   283  1257
---- Validation: 
scalar performance:
{'acc': 0.62989044, 'precision': 0.7440788, 'recall': 0.6387318, 'specificity': 0.6387318, 'f1': 0.5890242, 'auroc': 0.7079003, 'binary_precision': 0.5703494, 'binary_recall': 0.9710611, 'binary_specificity': 0.30640244, 'binary_f1_score': 0.7186199}
confusion matrix:
     0    1
0  201  455
1   18  604
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5810185, 'precision': 0.68230045, 'recall': 0.5810185, 'specificity': 0.5810185, 'f1': 0.51343787, 'auroc': 0.78716564, 'binary_precision': 0.5464191, 'binary_recall': 0.9537037, 'binary_specificity': 0.20833333, 'binary_f1_score': 0.69477236}
confusion matrix:
    0    1
0  45  171
1  10  206
early stop counter: 4
val acc:0.6298904418945312, best validation acc: 0.6744914054870605, corresponding to test acc:                         0.7152777910232544 / 0.7685185074806213
after epoch: 7,now: 2024-07-27 14:29:59.225758,epoch time: 0:01:56.558217,used: 0:13:42.128332,model: dset_te_center0_dann_b8efecac6_not_commited_2024md_07md_27_14_16_16_seed_2_23099037
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.87565446, 'precision': 0.89978904, 'recall': 0.8766234, 'specificity': 0.8766234, 'f1': 0.8739438, 'auroc': 0.876948, 'binary_precision': 1.0, 'binary_recall': 0.7532467, 'binary_specificity': 1.0, 'binary_f1_score': 0.8592592}
confusion matrix:
      0     1
0  1516     0
1   380  1160
---- Validation: 
scalar performance:
{'acc': 0.514867, 'precision': 0.63206434, 'recall': 0.5016494, 'specificity': 0.5016494, 'f1': 0.34417057, 'auroc': 0.5016531, 'binary_precision': 0.75, 'binary_recall': 0.004823151, 'binary_specificity': 0.9984756, 'binary_f1_score': 0.009584664}
confusion matrix:
     0  1
0  655  1
1  619  3
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5, 'precision': 0.25, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.33333334, 'auroc': 0.5, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
     0  1
0  216  0
1  216  0
early stop counter: 5
val acc:0.5148670077323914, best validation acc: 0.6744914054870605, corresponding to test acc:                         0.7152777910232544 / 0.7685185074806213
after epoch: 8,now: 2024-07-27 14:31:56.135066,epoch time: 0:01:56.909308,used: 0:15:39.037640,model: dset_te_center0_dann_b8efecac6_not_commited_2024md_07md_27_14_16_16_seed_2_23099037
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 8 with time: 0:15:39.037640 at 2024-07-27 14:31:56.135066
persisted model performance metric: 

scalar performance:
{'acc': 0.7152778, 'precision': 0.75930035, 'recall': 0.7152778, 'specificity': 0.7152778, 'f1': 0.7026575, 'auroc': 0.7176355, 'binary_precision': 0.86614174, 'binary_recall': 0.5092593, 'binary_specificity': 0.9212963, 'binary_f1_score': 0.64139944}
confusion matrix:
     0    1
0  199   17
1  106  110
oracle model performance metric: 

scalar performance:
{'acc': 0.7685185, 'precision': 0.7893837, 'recall': 0.76851857, 'specificity': 0.76851857, 'f1': 0.76426935, 'auroc': 0.8207519, 'binary_precision': 0.7116788, 'binary_recall': 0.9027778, 'binary_specificity': 0.6342593, 'binary_f1_score': 0.79591835}
confusion matrix:
     0    1
0  137   79
1   21  195
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_10seeds_nofreeze_2024-07-27_13-09-31/rule_results/3.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_10seeds_nofreeze_2024-07-27_13-09-31/confusion_matrix/3.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 455321 KiB |   3603 MiB |  71979 GiB |  71978 GiB |
|       from large pool | 414719 KiB |   3569 MiB |  71153 GiB |  71153 GiB |
|       from small pool |  40602 KiB |     60 MiB |    825 GiB |    825 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 455321 KiB |   3603 MiB |  71979 GiB |  71978 GiB |
|       from large pool | 414719 KiB |   3569 MiB |  71153 GiB |  71153 GiB |
|       from small pool |  40602 KiB |     60 MiB |    825 GiB |    825 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 447481 KiB |   3596 MiB |  71749 GiB |  71749 GiB |
|       from large pool | 407075 KiB |   3563 MiB |  70925 GiB |  70925 GiB |
|       from small pool |  40406 KiB |     60 MiB |    823 GiB |    823 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   4002 MiB |   4016 MiB |  10452 MiB |   6450 MiB |
|       from large pool |   3938 MiB |   3952 MiB |  10352 MiB |   6414 MiB |
|       from small pool |     64 MiB |     68 MiB |    100 MiB |     36 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 410982 KiB | 496525 KiB |  50639 GiB |  50638 GiB |
|       from large pool | 402433 KiB | 492852 KiB |  49793 GiB |  49793 GiB |
|       from small pool |   8549 KiB |  32850 KiB |    845 GiB |    845 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    1318    |    1709    |   12616 K  |   12615 K  |
|       from large pool |     187    |     468    |    6567 K  |    6567 K  |
|       from small pool |    1131    |    1447    |    6049 K  |    6048 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    1318    |    1709    |   12616 K  |   12615 K  |
|       from large pool |     187    |     468    |    6567 K  |    6567 K  |
|       from small pool |    1131    |    1447    |    6049 K  |    6048 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     197    |     200    |     480    |     283    |
|       from large pool |     165    |     166    |     430    |     265    |
|       from small pool |      32    |      34    |      50    |      18    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      83    |     253    |    7158 K  |    7158 K  |
|       from large pool |      36    |     165    |    4213 K  |    4213 K  |
|       from small pool |      47    |     220    |    2944 K  |    2944 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   3603 MiB |  71979 GiB |  71979 GiB |
|       from large pool |  16640 KiB |   3569 MiB |  71153 GiB |  71153 GiB |
|       from small pool |      0 KiB |     60 MiB |    825 GiB |    825 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   3603 MiB |  71979 GiB |  71979 GiB |
|       from large pool |  16640 KiB |   3569 MiB |  71153 GiB |  71153 GiB |
|       from small pool |      0 KiB |     60 MiB |    825 GiB |    825 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   3596 MiB |  71749 GiB |  71749 GiB |
|       from large pool |  16640 KiB |   3563 MiB |  70925 GiB |  70925 GiB |
|       from small pool |      0 KiB |     60 MiB |    823 GiB |    823 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    846 MiB |   4016 MiB |  10452 MiB |   9606 MiB |
|       from large pool |    798 MiB |   3952 MiB |  10352 MiB |   9554 MiB |
|       from small pool |     48 MiB |     68 MiB |    100 MiB |     52 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 496525 KiB |  50639 GiB |  50639 GiB |
|       from large pool |  24320 KiB | 492852 KiB |  49794 GiB |  49794 GiB |
|       from small pool |      0 KiB |  32850 KiB |    845 GiB |    845 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    1709    |   12616 K  |   12616 K  |
|       from large pool |       2    |     468    |    6567 K  |    6567 K  |
|       from small pool |       0    |    1447    |    6049 K  |    6049 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    1709    |   12616 K  |   12616 K  |
|       from large pool |       2    |     468    |    6567 K  |    6567 K  |
|       from small pool |       0    |    1447    |    6049 K  |    6049 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      60    |     200    |     480    |     420    |
|       from large pool |      36    |     166    |     430    |     394    |
|       from small pool |      24    |      34    |      50    |      26    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     253    |    7158 K  |    7158 K  |
|       from large pool |       3    |     165    |    4213 K  |    4213 K  |
|       from small pool |       0    |     220    |    2945 K  |    2945 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Sat Jul 27 14:32:03 2024]
Finished job 0.
1 of 1 steps (100%) done
