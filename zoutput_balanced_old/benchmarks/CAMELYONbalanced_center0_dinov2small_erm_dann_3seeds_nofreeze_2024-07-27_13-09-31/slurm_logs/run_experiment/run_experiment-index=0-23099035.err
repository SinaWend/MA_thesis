Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Sat Jul 27 13:49:04 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_10seeds_nofreeze_2024-07-27_13-09-31/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_10seeds_nofreeze_2024-07-27_13-09-31/rule_results/0.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=0
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/swiglu_ffn.py:51: UserWarning: xFormers is not available (SwiGLU)
  warnings.warn("xFormers is not available (SwiGLU)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/attention.py:33: UserWarning: xFormers is not available (Attention)
  warnings.warn("xFormers is not available (Attention)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/block.py:40: UserWarning: xFormers is not available (Block)
  warnings.warn("xFormers is not available (Block)")
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_13_51_28_seed_0_23099035

 Experiment start at: 2024-07-27 13:51:28.979830
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
before training, model accuracy: 0.569767415523529
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.96191406, 'precision': 0.9624173, 'recall': 0.9621662, 'specificity': 0.9621662, 'f1': 0.9619123, 'auroc': 0.9951354, 'binary_precision': 0.9812709, 'binary_recall': 0.9428021, 'binary_specificity': 0.98153037, 'binary_f1_score': 0.9616519}
confusion matrix:
      0     1
0  1488    28
1    89  1467
---- Validation: 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
scalar performance:
{'acc': 0.8043478, 'precision': 0.8180965, 'recall': 0.80578554, 'specificity': 0.80578554, 'f1': 0.80269176, 'auroc': 0.908618, 'binary_precision': 0.74837875, 'binary_recall': 0.9086614, 'binary_specificity': 0.70290965, 'binary_f1_score': 0.8207682}
confusion matrix:
     0    1
0  459  194
1   58  577
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7953488, 'precision': 0.8108422, 'recall': 0.7953489, 'specificity': 0.7953489, 'f1': 0.7927666, 'auroc': 0.9113467, 'binary_precision': 0.7414449, 'binary_recall': 0.90697676, 'binary_specificity': 0.68372095, 'binary_f1_score': 0.81589955}
confusion matrix:
     0    1
0  147   68
1   20  195
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-27 13:53:07.016678,epoch time: 0:01:38.036848,used: 0:01:38.036848,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_13_51_28_seed_0_23099035
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9511719, 'precision': 0.95455664, 'recall': 0.95176554, 'specificity': 0.95176554, 'f1': 0.951118, 'auroc': 0.9971186, 'binary_precision': 0.99717116, 'binary_recall': 0.90616965, 'binary_specificity': 0.9973615, 'binary_f1_score': 0.94949496}
confusion matrix:
      0     1
0  1512     4
1   146  1410
---- Validation: 
scalar performance:
{'acc': 0.7158385, 'precision': 0.8002219, 'recall': 0.7120932, 'specificity': 0.7120932, 'f1': 0.6920472, 'auroc': 0.91108274, 'binary_precision': 0.9559322, 'binary_recall': 0.44409448, 'binary_specificity': 0.98009187, 'binary_f1_score': 0.60645163}
confusion matrix:
     0    1
0  640   13
1  353  282
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.80697674, 'precision': 0.8607383, 'recall': 0.80697674, 'specificity': 0.80697674, 'f1': 0.7995068, 'auroc': 0.935338, 'binary_precision': 1.0, 'binary_recall': 0.6139535, 'binary_specificity': 1.0, 'binary_f1_score': 0.7608069}
confusion matrix:
     0    1
0  215    0
1   83  132
new oracle model saved
early stop counter: 1
val acc:0.7158384919166565, best validation acc: 0.804347813129425, corresponding to test acc:                         0.7953488230705261 / 0.8069767355918884
after epoch: 2,now: 2024-07-27 13:54:35.278761,epoch time: 0:01:28.262083,used: 0:03:06.298931,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_13_51_28_seed_0_23099035
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.97721356, 'precision': 0.97752285, 'recall': 0.97742164, 'specificity': 0.97742164, 'f1': 0.97721326, 'auroc': 0.99795276, 'binary_precision': 0.9933599, 'binary_recall': 0.9614396, 'binary_specificity': 0.9934037, 'binary_f1_score': 0.9771392}
confusion matrix:
      0     1
0  1506    10
1    60  1496
---- Validation: 
scalar performance:
{'acc': 0.84782606, 'precision': 0.8539051, 'recall': 0.8469064, 'specificity': 0.8469064, 'f1': 0.8469032, 'auroc': 0.90908104, 'binary_precision': 0.89692587, 'binary_recall': 0.78110236, 'binary_specificity': 0.91271055, 'binary_f1_score': 0.83501685}
confusion matrix:
     0    1
0  596   57
1  139  496
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8767442, 'precision': 0.8956516, 'recall': 0.87674415, 'specificity': 0.87674415, 'f1': 0.8752539, 'auroc': 0.94297457, 'binary_precision': 0.98214287, 'binary_recall': 0.76744187, 'binary_specificity': 0.9860465, 'binary_f1_score': 0.8616189}
confusion matrix:
     0    1
0  212    3
1   50  165
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-07-27 13:56:04.214553,epoch time: 0:01:28.935792,used: 0:04:35.234723,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_13_51_28_seed_0_23099035
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.98046875, 'precision': 0.9808594, 'recall': 0.9806832, 'specificity': 0.9806832, 'f1': 0.9804683, 'auroc': 0.99915135, 'binary_precision': 0.99800134, 'binary_recall': 0.96334404, 'binary_specificity': 0.99802244, 'binary_f1_score': 0.98036647}
confusion matrix:
      0     1
0  1514     3
1    57  1498
---- Validation: 
scalar performance:
{'acc': 0.7958075, 'precision': 0.8284543, 'recall': 0.79358625, 'specificity': 0.79358625, 'f1': 0.7897284, 'auroc': 0.89768124, 'binary_precision': 0.9285714, 'binary_recall': 0.63464564, 'binary_specificity': 0.9525268, 'binary_f1_score': 0.7539757}
confusion matrix:
     0    1
0  622   31
1  232  403
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8697674, 'precision': 0.88750595, 'recall': 0.8697674, 'specificity': 0.8697674, 'f1': 0.8682598, 'auroc': 0.947669, 'binary_precision': 0.9704142, 'binary_recall': 0.7627907, 'binary_specificity': 0.9767442, 'binary_f1_score': 0.8541667}
confusion matrix:
     0    1
0  210    5
1   51  164
early stop counter: 1
val acc:0.7958074808120728, best validation acc: 0.8478260636329651, corresponding to test acc:                         0.8767442107200623 / 0.8767442107200623
after epoch: 4,now: 2024-07-27 13:57:33.100809,epoch time: 0:01:28.886256,used: 0:06:04.120979,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_13_51_28_seed_0_23099035
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.98339844, 'precision': 0.98350114, 'recall': 0.98333204, 'specificity': 0.98333204, 'f1': 0.9833932, 'auroc': 0.9990025, 'binary_precision': 0.97899425, 'binary_recall': 0.9884319, 'binary_specificity': 0.9782322, 'binary_f1_score': 0.98369044}
confusion matrix:
      0     1
0  1483    33
1    18  1538
---- Validation: 
scalar performance:
{'acc': 0.82220495, 'precision': 0.83065844, 'recall': 0.8210741, 'specificity': 0.8210741, 'f1': 0.82067424, 'auroc': 0.88440025, 'binary_precision': 0.88014984, 'binary_recall': 0.7401575, 'binary_specificity': 0.90199083, 'binary_f1_score': 0.8041061}
confusion matrix:
     0    1
0  589   64
1  165  470
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8860465, 'precision': 0.8867242, 'recall': 0.8860465, 'specificity': 0.8860465, 'f1': 0.8859966, 'auroc': 0.93514323, 'binary_precision': 0.9029126, 'binary_recall': 0.8651163, 'binary_specificity': 0.90697676, 'binary_f1_score': 0.8836104}
confusion matrix:
     0    1
0  195   20
1   29  186
new oracle model saved
early stop counter: 2
val acc:0.8222049474716187, best validation acc: 0.8478260636329651, corresponding to test acc:                         0.8767442107200623 / 0.8860465288162231
after epoch: 5,now: 2024-07-27 13:59:02.100172,epoch time: 0:01:28.999363,used: 0:07:33.120342,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_13_51_28_seed_0_23099035
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.98339844, 'precision': 0.98348176, 'recall': 0.9833405, 'specificity': 0.9833405, 'f1': 0.9833935, 'auroc': 0.99896395, 'binary_precision': 0.97960484, 'binary_recall': 0.9877892, 'binary_specificity': 0.97889185, 'binary_f1_score': 0.98367995}
confusion matrix:
      0     1
0  1484    32
1    19  1537
---- Validation: 
scalar performance:
{'acc': 0.871118, 'precision': 0.8808455, 'recall': 0.87000763, 'specificity': 0.87000763, 'f1': 0.8700272, 'auroc': 0.939229, 'binary_precision': 0.9383178, 'binary_recall': 0.7905512, 'binary_specificity': 0.949464, 'binary_f1_score': 0.85811967}
confusion matrix:
     0    1
0  620   33
1  133  502
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.81860465, 'precision': 0.8614199, 'recall': 0.81860465, 'specificity': 0.81860465, 'f1': 0.8130685, 'auroc': 0.9474094, 'binary_precision': 0.9858156, 'binary_recall': 0.6465116, 'binary_specificity': 0.9906977, 'binary_f1_score': 0.7808988}
confusion matrix:
     0    1
0  213    2
1   76  139
better model found
persisted
after epoch: 6,now: 2024-07-27 14:00:31.193165,epoch time: 0:01:29.092993,used: 0:09:02.213335,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_13_51_28_seed_0_23099035
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9781901, 'precision': 0.97848356, 'recall': 0.97839415, 'specificity': 0.97839415, 'f1': 0.9781899, 'auroc': 0.9982712, 'binary_precision': 0.99402785, 'binary_recall': 0.9627249, 'binary_specificity': 0.9940633, 'binary_f1_score': 0.978126}
confusion matrix:
      0     1
0  1507     9
1    58  1498
---- Validation: 
scalar performance:
{'acc': 0.6871118, 'precision': 0.7854858, 'recall': 0.6829593, 'specificity': 0.6829593, 'f1': 0.6546294, 'auroc': 0.9100336, 'binary_precision': 0.9496124, 'binary_recall': 0.38582677, 'binary_specificity': 0.98009187, 'binary_f1_score': 0.5487122}
confusion matrix:
     0    1
0  640   13
1  390  245
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7209302, 'precision': 0.82089555, 'recall': 0.7209302, 'specificity': 0.7209302, 'f1': 0.6973607, 'auroc': 0.94375336, 'binary_precision': 1.0, 'binary_recall': 0.44186047, 'binary_specificity': 1.0, 'binary_f1_score': 0.61290324}
confusion matrix:
     0   1
0  215   0
1  120  95
early stop counter: 1
val acc:0.6871117949485779, best validation acc: 0.8711180090904236, corresponding to test acc:                         0.8186046481132507 / 0.8860465288162231
after epoch: 7,now: 2024-07-27 14:01:59.752095,epoch time: 0:01:28.558930,used: 0:10:30.772265,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_13_51_28_seed_0_23099035
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.98860675, 'precision': 0.9886556, 'recall': 0.98873377, 'specificity': 0.98873377, 'f1': 0.9886066, 'auroc': 0.9992725, 'binary_precision': 0.9980366, 'binary_recall': 0.97944766, 'binary_specificity': 0.9980198, 'binary_f1_score': 0.9886548}
confusion matrix:
      0     1
0  1512     3
1    32  1525
---- Validation: 
scalar performance:
{'acc': 0.69798136, 'precision': 0.75725734, 'recall': 0.694569, 'specificity': 0.694569, 'f1': 0.6771732, 'auroc': 0.87787616, 'binary_precision': 0.8773006, 'binary_recall': 0.4503937, 'binary_specificity': 0.93874425, 'binary_f1_score': 0.5952133}
confusion matrix:
     0    1
0  613   40
1  349  286
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.74651164, 'precision': 0.7730257, 'recall': 0.7465116, 'specificity': 0.7465116, 'f1': 0.7402043, 'auroc': 0.8715414, 'binary_precision': 0.8581081, 'binary_recall': 0.59069765, 'binary_specificity': 0.9023256, 'binary_f1_score': 0.69972444}
confusion matrix:
     0    1
0  194   21
1   88  127
early stop counter: 2
val acc:0.6979813575744629, best validation acc: 0.8711180090904236, corresponding to test acc:                         0.8186046481132507 / 0.8860465288162231
after epoch: 8,now: 2024-07-27 14:03:28.325740,epoch time: 0:01:28.573645,used: 0:11:59.345910,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_13_51_28_seed_0_23099035
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9814453, 'precision': 0.9817626, 'recall': 0.98166883, 'specificity': 0.98166883, 'f1': 0.9814452, 'auroc': 0.99922264, 'binary_precision': 0.99800795, 'binary_recall': 0.9653179, 'binary_specificity': 0.9980198, 'binary_f1_score': 0.9813908}
confusion matrix:
      0     1
0  1512     3
1    54  1503
---- Validation: 
scalar performance:
{'acc': 0.57220495, 'precision': 0.7401426, 'recall': 0.56627196, 'specificity': 0.56627196, 'f1': 0.47379655, 'auroc': 0.898553, 'binary_precision': 0.9375, 'binary_recall': 0.14173229, 'binary_specificity': 0.99081165, 'binary_f1_score': 0.24623804}
confusion matrix:
     0   1
0  647   6
1  545  90
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.63255817, 'precision': 0.7882037, 'recall': 0.6325581, 'specificity': 0.6325581, 'f1': 0.5752051, 'auroc': 0.92809093, 'binary_precision': 1.0, 'binary_recall': 0.26511627, 'binary_specificity': 1.0, 'binary_f1_score': 0.41911766}
confusion matrix:
     0   1
0  215   0
1  158  57
early stop counter: 3
val acc:0.5722049474716187, best validation acc: 0.8711180090904236, corresponding to test acc:                         0.8186046481132507 / 0.8860465288162231
after epoch: 9,now: 2024-07-27 14:04:58.753515,epoch time: 0:01:30.427775,used: 0:13:29.773685,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_13_51_28_seed_0_23099035
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.97558594, 'precision': 0.9764447, 'recall': 0.97588426, 'specificity': 0.97588426, 'f1': 0.9755824, 'auroc': 0.99839884, 'binary_precision': 1.0, 'binary_recall': 0.9517685, 'binary_specificity': 1.0, 'binary_f1_score': 0.97528833}
confusion matrix:
      0     1
0  1517     0
1    75  1480
---- Validation: 
scalar performance:
{'acc': 0.56444097, 'precision': 0.7203177, 'recall': 0.55846304, 'specificity': 0.55846304, 'f1': 0.4624642, 'auroc': 0.869723, 'binary_precision': 0.90217394, 'binary_recall': 0.13070866, 'binary_specificity': 0.98621744, 'binary_f1_score': 0.22833563}
confusion matrix:
     0   1
0  644   9
1  552  83
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.53488374, 'precision': 0.7590362, 'recall': 0.53488374, 'specificity': 0.53488374, 'f1': 0.40648723, 'auroc': 0.894808, 'binary_precision': 1.0, 'binary_recall': 0.069767445, 'binary_specificity': 1.0, 'binary_f1_score': 0.13043478}
confusion matrix:
     0   1
0  215   0
1  200  15
early stop counter: 4
val acc:0.5644409656524658, best validation acc: 0.8711180090904236, corresponding to test acc:                         0.8186046481132507 / 0.8860465288162231
after epoch: 10,now: 2024-07-27 14:06:28.436608,epoch time: 0:01:29.683093,used: 0:14:59.456778,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_13_51_28_seed_0_23099035
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9720052, 'precision': 0.973065, 'recall': 0.9723912, 'specificity': 0.9723912, 'f1': 0.9720005, 'auroc': 0.99917287, 'binary_precision': 0.9993216, 'binary_recall': 0.94544286, 'binary_specificity': 0.9993395, 'binary_f1_score': 0.9716359}
confusion matrix:
      0     1
0  1513     1
1    85  1473
---- Validation: 
scalar performance:
{'acc': 0.5613354, 'precision': 0.7266058, 'recall': 0.55527, 'specificity': 0.55527, 'f1': 0.4549661, 'auroc': 0.89164364, 'binary_precision': 0.9166667, 'binary_recall': 0.121259846, 'binary_specificity': 0.9892802, 'binary_f1_score': 0.21418637}
confusion matrix:
     0   1
0  646   7
1  558  77
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5488372, 'precision': 0.7628362, 'recall': 0.5488372, 'specificity': 0.5488372, 'f1': 0.43353432, 'auroc': 0.9186533, 'binary_precision': 1.0, 'binary_recall': 0.09767442, 'binary_specificity': 1.0, 'binary_f1_score': 0.17796612}
confusion matrix:
     0   1
0  215   0
1  194  21
early stop counter: 5
val acc:0.5613353848457336, best validation acc: 0.8711180090904236, corresponding to test acc:                         0.8186046481132507 / 0.8860465288162231
after epoch: 11,now: 2024-07-27 14:07:57.232346,epoch time: 0:01:28.795738,used: 0:16:28.252516,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_13_51_28_seed_0_23099035
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 11 with time: 0:16:28.252516 at 2024-07-27 14:07:57.232346
persisted model performance metric: 

scalar performance:
{'acc': 0.81860465, 'precision': 0.8614199, 'recall': 0.81860465, 'specificity': 0.81860465, 'f1': 0.8130685, 'auroc': 0.9474094, 'binary_precision': 0.9858156, 'binary_recall': 0.6465116, 'binary_specificity': 0.9906977, 'binary_f1_score': 0.7808988}
confusion matrix:
     0    1
0  213    2
1   76  139
oracle model performance metric: 

scalar performance:
{'acc': 0.8860465, 'precision': 0.8867242, 'recall': 0.8860465, 'specificity': 0.8860465, 'f1': 0.8859966, 'auroc': 0.93514323, 'binary_precision': 0.9029126, 'binary_recall': 0.8651163, 'binary_specificity': 0.90697676, 'binary_f1_score': 0.8836104}
confusion matrix:
     0    1
0  195   20
1   29  186
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_10seeds_nofreeze_2024-07-27_13-09-31/rule_results/0.csv
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_10seeds_nofreeze_2024-07-27_13-09-31/rule_results/0.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_10seeds_nofreeze_2024-07-27_13-09-31/confusion_matrix/0.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 454925 KiB |   2002 MiB |  23976 GiB |  23975 GiB |
|       from large pool | 414333 KiB |   1970 MiB |  23669 GiB |  23669 GiB |
|       from small pool |  40592 KiB |     56 MiB |    306 GiB |    306 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 454925 KiB |   2002 MiB |  23976 GiB |  23975 GiB |
|       from large pool | 414333 KiB |   1970 MiB |  23669 GiB |  23669 GiB |
|       from small pool |  40592 KiB |     56 MiB |    306 GiB |    306 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 447480 KiB |   1998 MiB |  23904 GiB |  23903 GiB |
|       from large pool | 407075 KiB |   1966 MiB |  23598 GiB |  23597 GiB |
|       from small pool |  40405 KiB |     56 MiB |    306 GiB |    306 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2276 MiB |   2276 MiB |   2276 MiB |      0 B   |
|       from large pool |   2212 MiB |   2212 MiB |   2212 MiB |      0 B   |
|       from small pool |     64 MiB |     64 MiB |     64 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory | 386802 KiB | 387009 KiB |  18602 GiB |  18601 GiB |
|       from large pool | 380291 KiB | 380291 KiB |  18279 GiB |  18279 GiB |
|       from small pool |   6511 KiB |  12075 KiB |    322 GiB |    322 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    1298    |    1669    |    4574 K  |    4573 K  |
|       from large pool |     187    |     311    |    2197 K  |    2197 K  |
|       from small pool |    1111    |    1407    |    2377 K  |    2376 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    1298    |    1669    |    4574 K  |    4573 K  |
|       from large pool |     187    |     311    |    2197 K  |    2197 K  |
|       from small pool |    1111    |    1407    |    2377 K  |    2376 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     124    |     124    |     124    |       0    |
|       from large pool |      92    |      92    |      92    |       0    |
|       from small pool |      32    |      32    |      32    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      71    |     257    |    2650 K  |    2650 K  |
|       from large pool |      35    |      90    |    1698 K  |    1698 K  |
|       from small pool |      36    |     222    |     952 K  |     952 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   2002 MiB |  23976 GiB |  23976 GiB |
|       from large pool |  16640 KiB |   1970 MiB |  23669 GiB |  23669 GiB |
|       from small pool |      0 KiB |     56 MiB |    306 GiB |    306 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   2002 MiB |  23976 GiB |  23976 GiB |
|       from large pool |  16640 KiB |   1970 MiB |  23669 GiB |  23669 GiB |
|       from small pool |      0 KiB |     56 MiB |    306 GiB |    306 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   1998 MiB |  23904 GiB |  23904 GiB |
|       from large pool |  16640 KiB |   1966 MiB |  23598 GiB |  23598 GiB |
|       from small pool |      0 KiB |     56 MiB |    306 GiB |    306 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    822 MiB |   2276 MiB |   2276 MiB |   1454 MiB |
|       from large pool |    776 MiB |   2212 MiB |   2212 MiB |   1436 MiB |
|       from small pool |     46 MiB |     64 MiB |     64 MiB |     18 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  30464 KiB | 487777 KiB |  18602 GiB |  18602 GiB |
|       from large pool |  30464 KiB | 471224 KiB |  18279 GiB |  18279 GiB |
|       from small pool |      0 KiB |  18493 KiB |    322 GiB |    322 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    1669    |    4574 K  |    4574 K  |
|       from large pool |       2    |     311    |    2197 K  |    2197 K  |
|       from small pool |       0    |    1407    |    2377 K  |    2377 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    1669    |    4574 K  |    4574 K  |
|       from large pool |       2    |     311    |    2197 K  |    2197 K  |
|       from small pool |       0    |    1407    |    2377 K  |    2377 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      57    |     124    |     124    |      67    |
|       from large pool |      34    |      92    |      92    |      58    |
|       from small pool |      23    |      32    |      32    |       9    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |     257    |    2650 K  |    2650 K  |
|       from large pool |       4    |      90    |    1698 K  |    1698 K  |
|       from small pool |       0    |     222    |     952 K  |     952 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   2002 MiB |  23976 GiB |  23976 GiB |
|       from large pool |  16640 KiB |   1970 MiB |  23669 GiB |  23669 GiB |
|       from small pool |      0 KiB |     56 MiB |    306 GiB |    306 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   2002 MiB |  23976 GiB |  23976 GiB |
|       from large pool |  16640 KiB |   1970 MiB |  23669 GiB |  23669 GiB |
|       from small pool |      0 KiB |     56 MiB |    306 GiB |    306 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   1998 MiB |  23904 GiB |  23904 GiB |
|       from large pool |  16640 KiB |   1966 MiB |  23598 GiB |  23598 GiB |
|       from small pool |      0 KiB |     56 MiB |    306 GiB |    306 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    822 MiB |   2276 MiB |   2276 MiB |   1454 MiB |
|       from large pool |    776 MiB |   2212 MiB |   2212 MiB |   1436 MiB |
|       from small pool |     46 MiB |     64 MiB |     64 MiB |     18 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  30464 KiB | 487777 KiB |  18602 GiB |  18602 GiB |
|       from large pool |  30464 KiB | 471224 KiB |  18279 GiB |  18279 GiB |
|       from small pool |      0 KiB |  18493 KiB |    322 GiB |    322 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    1669    |    4574 K  |    4574 K  |
|       from large pool |       2    |     311    |    2197 K  |    2197 K  |
|       from small pool |       0    |    1407    |    2377 K  |    2377 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    1669    |    4574 K  |    4574 K  |
|       from large pool |       2    |     311    |    2197 K  |    2197 K  |
|       from small pool |       0    |    1407    |    2377 K  |    2377 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      57    |     124    |     124    |      67    |
|       from large pool |      34    |      92    |      92    |      58    |
|       from small pool |      23    |      32    |      32    |       9    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |     257    |    2650 K  |    2650 K  |
|       from large pool |       4    |      90    |    1698 K  |    1698 K  |
|       from small pool |       0    |     222    |     952 K  |     952 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_14_08_31_seed_1_23099035

 Experiment start at: 2024-07-27 14:08:31.233818
before training, model accuracy: 0.6177777647972107
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9554036, 'precision': 0.9583152, 'recall': 0.95589733, 'specificity': 0.95589733, 'f1': 0.9553609, 'auroc': 0.99448884, 'binary_precision': 0.9978918, 'binary_recall': 0.9137709, 'binary_specificity': 0.9980237, 'binary_f1_score': 0.9539805}
confusion matrix:
      0     1
0  1515     3
1   134  1420
---- Validation: 
scalar performance:
{'acc': 0.58313817, 'precision': 0.7471583, 'recall': 0.5763441, 'specificity': 0.5763441, 'f1': 0.4918298, 'auroc': 0.8816613, 'binary_precision': 0.9444444, 'binary_recall': 0.16190477, 'binary_specificity': 0.9907834, 'binary_f1_score': 0.27642277}
confusion matrix:
     0    1
0  645    6
1  528  102
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7022222, 'precision': 0.7864357, 'recall': 0.7022222, 'specificity': 0.7022222, 'f1': 0.6785988, 'auroc': 0.8715012, 'binary_precision': 0.94174755, 'binary_recall': 0.4311111, 'binary_specificity': 0.97333336, 'binary_f1_score': 0.5914634}
confusion matrix:
     0   1
0  219   6
1  128  97
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-27 14:10:03.469483,epoch time: 0:01:32.235665,used: 0:01:32.235665,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_14_08_31_seed_1_23099035
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9667969, 'precision': 0.9683294, 'recall': 0.96648705, 'specificity': 0.96648705, 'f1': 0.96674955, 'auroc': 0.9984009, 'binary_precision': 0.94430846, 'binary_recall': 0.9929215, 'binary_specificity': 0.9400527, 'binary_f1_score': 0.96800506}
confusion matrix:
      0     1
0  1427    91
1    11  1543
---- Validation: 
scalar performance:
{'acc': 0.81576896, 'precision': 0.81848705, 'recall': 0.81651306, 'specificity': 0.81651306, 'f1': 0.81558, 'auroc': 0.8893205, 'binary_precision': 0.7846821, 'binary_recall': 0.86190474, 'binary_specificity': 0.7711213, 'binary_f1_score': 0.82148254}
confusion matrix:
     0    1
0  502  149
1   87  543
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.84, 'precision': 0.84132147, 'recall': 0.84000003, 'specificity': 0.84000003, 'f1': 0.839845, 'auroc': 0.8998518, 'binary_precision': 0.8200837, 'binary_recall': 0.8711111, 'binary_specificity': 0.8088889, 'binary_f1_score': 0.8448276}
confusion matrix:
     0    1
0  182   43
1   29  196
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-07-27 14:11:32.147520,epoch time: 0:01:28.678037,used: 0:03:00.913702,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_14_08_31_seed_1_23099035
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9820964, 'precision': 0.98217237, 'recall': 0.9822466, 'specificity': 0.9822466, 'f1': 0.9820962, 'auroc': 0.9986862, 'binary_precision': 0.9927869, 'binary_recall': 0.97175866, 'binary_specificity': 0.9927345, 'binary_f1_score': 0.9821603}
confusion matrix:
      0     1
0  1503    11
1    44  1514
---- Validation: 
scalar performance:
{'acc': 0.76502734, 'precision': 0.8014443, 'recall': 0.76213515, 'specificity': 0.76213515, 'f1': 0.7563311, 'auroc': 0.89383554, 'binary_precision': 0.90220046, 'binary_recall': 0.5857143, 'binary_specificity': 0.9385561, 'binary_f1_score': 0.71029836}
confusion matrix:
     0    1
0  611   40
1  261  369
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.82, 'precision': 0.8491379, 'recall': 0.82, 'specificity': 0.82, 'f1': 0.8161644, 'auroc': 0.9001679, 'binary_precision': 0.95, 'binary_recall': 0.6755555, 'binary_specificity': 0.96444446, 'binary_f1_score': 0.7896104}
confusion matrix:
     0    1
0  217    8
1   73  152
early stop counter: 1
val acc:0.7650273442268372, best validation acc: 0.8157689571380615, corresponding to test acc:                         0.8399999737739563 / 0.8399999737739563
after epoch: 3,now: 2024-07-27 14:13:02.744729,epoch time: 0:01:30.597209,used: 0:04:31.510911,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_14_08_31_seed_1_23099035
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.97298175, 'precision': 0.9738035, 'recall': 0.9727319, 'specificity': 0.9727319, 'f1': 0.9729548, 'auroc': 0.9983822, 'binary_precision': 0.95719606, 'binary_recall': 0.99100834, 'binary_specificity': 0.95445544, 'binary_f1_score': 0.97380877}
confusion matrix:
      0     1
0  1446    69
1    14  1543
---- Validation: 
scalar performance:
{'acc': 0.8274785, 'precision': 0.8301773, 'recall': 0.828213, 'specificity': 0.828213, 'f1': 0.82731014, 'auroc': 0.9034599, 'binary_precision': 0.7959479, 'binary_recall': 0.8730159, 'binary_specificity': 0.78341013, 'binary_f1_score': 0.8327025}
confusion matrix:
     0    1
0  510  141
1   80  550
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7822222, 'precision': 0.7994718, 'recall': 0.7822222, 'specificity': 0.7822222, 'f1': 0.7790404, 'auroc': 0.9129679, 'binary_precision': 0.72759855, 'binary_recall': 0.9022222, 'binary_specificity': 0.6622222, 'binary_f1_score': 0.8055555}
confusion matrix:
     0    1
0  149   76
1   22  203
better model found
persisted
after epoch: 4,now: 2024-07-27 14:14:34.340390,epoch time: 0:01:31.595661,used: 0:06:03.106572,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_14_08_31_seed_1_23099035
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9667969, 'precision': 0.96833515, 'recall': 0.9672067, 'specificity': 0.9672067, 'f1': 0.966785, 'auroc': 0.9972186, 'binary_precision': 0.99862826, 'binary_recall': 0.93573266, 'binary_specificity': 0.9986807, 'binary_f1_score': 0.9661579}
confusion matrix:
      0     1
0  1514     2
1   100  1456
---- Validation: 
scalar performance:
{'acc': 0.62763464, 'precision': 0.74644655, 'recall': 0.6218382, 'specificity': 0.6218382, 'f1': 0.57084227, 'auroc': 0.8792285, 'binary_precision': 0.91351354, 'binary_recall': 0.26825398, 'binary_specificity': 0.97542244, 'binary_f1_score': 0.41472396}
confusion matrix:
     0    1
0  635   16
1  461  169
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8155556, 'precision': 0.86254084, 'recall': 0.8155556, 'specificity': 0.8155556, 'f1': 0.80937946, 'auroc': 0.9430518, 'binary_precision': 0.9930556, 'binary_recall': 0.63555557, 'binary_specificity': 0.9955556, 'binary_f1_score': 0.7750678}
confusion matrix:
     0    1
0  224    1
1   82  143
early stop counter: 1
val acc:0.6276346445083618, best validation acc: 0.8274785280227661, corresponding to test acc:                         0.7822222113609314 / 0.8399999737739563
after epoch: 5,now: 2024-07-27 14:16:03.797094,epoch time: 0:01:29.456704,used: 0:07:32.563276,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_14_08_31_seed_1_23099035
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9811198, 'precision': 0.9815873, 'recall': 0.9813505, 'specificity': 0.9813505, 'f1': 0.981119, 'auroc': 0.99848235, 'binary_precision': 1.0, 'binary_recall': 0.96270096, 'binary_specificity': 1.0, 'binary_f1_score': 0.9809961}
confusion matrix:
      0     1
0  1517     0
1    58  1497
---- Validation: 
scalar performance:
{'acc': 0.6861827, 'precision': 0.78837824, 'recall': 0.681234, 'specificity': 0.681234, 'f1': 0.6520903, 'auroc': 0.8986255, 'binary_precision': 0.956, 'binary_recall': 0.3793651, 'binary_specificity': 0.9831029, 'binary_f1_score': 0.54318184}
confusion matrix:
     0    1
0  640   11
1  391  239
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.68222225, 'precision': 0.8057065, 'recall': 0.68222225, 'specificity': 0.68222225, 'f1': 0.64652765, 'auroc': 0.9214815, 'binary_precision': 1.0, 'binary_recall': 0.36444443, 'binary_specificity': 1.0, 'binary_f1_score': 0.5342019}
confusion matrix:
     0   1
0  225   0
1  143  82
early stop counter: 2
val acc:0.6861826777458191, best validation acc: 0.8274785280227661, corresponding to test acc:                         0.7822222113609314 / 0.8399999737739563
after epoch: 6,now: 2024-07-27 14:17:33.388464,epoch time: 0:01:29.591370,used: 0:09:02.154646,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_14_08_31_seed_1_23099035
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.98795575, 'precision': 0.98796844, 'recall': 0.98793924, 'specificity': 0.98793924, 'f1': 0.9879529, 'auroc': 0.99949634, 'binary_precision': 0.9871877, 'binary_recall': 0.9890886, 'binary_specificity': 0.98678994, 'binary_f1_score': 0.9881372}
confusion matrix:
      0     1
0  1494    20
1    17  1541
---- Validation: 
scalar performance:
{'acc': 0.8384075, 'precision': 0.84902763, 'recall': 0.8369688, 'specificity': 0.8369688, 'f1': 0.83672595, 'auroc': 0.9133251, 'binary_precision': 0.90595007, 'binary_recall': 0.74920636, 'binary_specificity': 0.9247312, 'binary_f1_score': 0.8201564}
confusion matrix:
     0    1
0  602   49
1  158  472
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8244445, 'precision': 0.82850003, 'recall': 0.8244444, 'specificity': 0.8244444, 'f1': 0.82390094, 'auroc': 0.90595555, 'binary_precision': 0.865, 'binary_recall': 0.7688889, 'binary_specificity': 0.88, 'binary_f1_score': 0.8141176}
confusion matrix:
     0    1
0  198   27
1   52  173
better model found
persisted
after epoch: 7,now: 2024-07-27 14:19:02.611668,epoch time: 0:01:29.223204,used: 0:10:31.377850,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_14_08_31_seed_1_23099035
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9921875, 'precision': 0.99216956, 'recall': 0.99224555, 'specificity': 0.99224555, 'f1': 0.9921869, 'auroc': 0.99962056, 'binary_precision': 0.99675745, 'binary_recall': 0.9877892, 'binary_specificity': 0.99670184, 'binary_f1_score': 0.99225307}
confusion matrix:
      0     1
0  1511     5
1    19  1537
---- Validation: 
scalar performance:
{'acc': 0.8017174, 'precision': 0.8337681, 'recall': 0.7991551, 'specificity': 0.7991551, 'f1': 0.79585934, 'auroc': 0.91394186, 'binary_precision': 0.93317974, 'binary_recall': 0.64285713, 'binary_specificity': 0.95545316, 'binary_f1_score': 0.76127815}
confusion matrix:
     0    1
0  622   29
1  225  405
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.83555555, 'precision': 0.84437144, 'recall': 0.83555555, 'specificity': 0.83555555, 'f1': 0.8344963, 'auroc': 0.9089383, 'binary_precision': 0.8994709, 'binary_recall': 0.75555557, 'binary_specificity': 0.91555554, 'binary_f1_score': 0.82125604}
confusion matrix:
     0    1
0  206   19
1   55  170
early stop counter: 1
val acc:0.8017174005508423, best validation acc: 0.8384075164794922, corresponding to test acc:                         0.8244444727897644 / 0.8399999737739563
after epoch: 8,now: 2024-07-27 14:20:32.020625,epoch time: 0:01:29.408957,used: 0:12:00.786807,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_14_08_31_seed_1_23099035
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9824219, 'precision': 0.9824404, 'recall': 0.9825034, 'specificity': 0.9825034, 'f1': 0.9824215, 'auroc': 0.99889445, 'binary_precision': 0.98955613, 'binary_recall': 0.97554696, 'binary_specificity': 0.9894598, 'binary_f1_score': 0.9825016}
confusion matrix:
      0     1
0  1502    16
1    38  1516
---- Validation: 
scalar performance:
{'acc': 0.871975, 'precision': 0.87636507, 'recall': 0.8710958, 'specificity': 0.8710958, 'f1': 0.87138176, 'auroc': 0.920969, 'binary_precision': 0.91312057, 'binary_recall': 0.8174603, 'binary_specificity': 0.9247312, 'binary_f1_score': 0.8626466}
confusion matrix:
     0    1
0  602   49
1  115  515
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.88, 'precision': 0.88687783, 'recall': 0.88, 'specificity': 0.88, 'f1': 0.87946427, 'auroc': 0.9356247, 'binary_precision': 0.93846154, 'binary_recall': 0.81333333, 'binary_specificity': 0.94666666, 'binary_f1_score': 0.8714286}
confusion matrix:
     0    1
0  213   12
1   42  183
new oracle model saved
better model found
persisted
after epoch: 9,now: 2024-07-27 14:22:01.860059,epoch time: 0:01:29.839434,used: 0:13:30.626241,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_14_08_31_seed_1_23099035
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9889323, 'precision': 0.9889238, 'recall': 0.98902327, 'specificity': 0.98902327, 'f1': 0.9889316, 'auroc': 0.99971724, 'binary_precision': 0.99544865, 'binary_recall': 0.98267007, 'binary_specificity': 0.99537647, 'binary_f1_score': 0.9890181}
confusion matrix:
      0     1
0  1507     7
1    27  1531
---- Validation: 
scalar performance:
{'acc': 0.83528495, 'precision': 0.8558419, 'recall': 0.83330774, 'specificity': 0.83330774, 'f1': 0.83226085, 'auroc': 0.93037087, 'binary_precision': 0.9373695, 'binary_recall': 0.7126984, 'binary_specificity': 0.953917, 'binary_f1_score': 0.80973846}
confusion matrix:
     0    1
0  621   30
1  181  449
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8488889, 'precision': 0.87021315, 'recall': 0.8488889, 'specificity': 0.8488889, 'f1': 0.8466811, 'auroc': 0.9168, 'binary_precision': 0.9590643, 'binary_recall': 0.72888887, 'binary_specificity': 0.9688889, 'binary_f1_score': 0.82828283}
confusion matrix:
     0    1
0  218    7
1   61  164
early stop counter: 1
val acc:0.835284948348999, best validation acc: 0.8719750046730042, corresponding to test acc:                         0.8799999952316284 / 0.8799999952316284
after epoch: 10,now: 2024-07-27 14:23:31.349848,epoch time: 0:01:29.489789,used: 0:15:00.116030,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_14_08_31_seed_1_23099035
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.98828125, 'precision': 0.9882654, 'recall': 0.98829687, 'specificity': 0.98829687, 'f1': 0.98827946, 'auroc': 0.99913347, 'binary_precision': 0.98969734, 'binary_recall': 0.9871548, 'binary_specificity': 0.98943895, 'binary_f1_score': 0.98842436}
confusion matrix:
      0     1
0  1499    16
1    20  1537
---- Validation: 
scalar performance:
{'acc': 0.863388, 'precision': 0.8740741, 'recall': 0.86200714, 'specificity': 0.86200714, 'f1': 0.8620534, 'auroc': 0.92520666, 'binary_precision': 0.93333334, 'binary_recall': 0.7777778, 'binary_specificity': 0.94623655, 'binary_f1_score': 0.8484849}
confusion matrix:
     0    1
0  616   35
1  140  490
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8422222, 'precision': 0.8639706, 'recall': 0.8422222, 'specificity': 0.8422222, 'f1': 0.83982956, 'auroc': 0.93074566, 'binary_precision': 0.9529412, 'binary_recall': 0.72, 'binary_specificity': 0.96444446, 'binary_f1_score': 0.82025313}
confusion matrix:
     0    1
0  217    8
1   63  162
early stop counter: 2
val acc:0.8633880019187927, best validation acc: 0.8719750046730042, corresponding to test acc:                         0.8799999952316284 / 0.8799999952316284
after epoch: 11,now: 2024-07-27 14:25:00.633760,epoch time: 0:01:29.283912,used: 0:16:29.399942,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_14_08_31_seed_1_23099035
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.99088544, 'precision': 0.99087775, 'recall': 0.9909602, 'specificity': 0.9909602, 'f1': 0.99088496, 'auroc': 0.99921983, 'binary_precision': 0.99674904, 'binary_recall': 0.9852185, 'binary_specificity': 0.99670184, 'binary_f1_score': 0.9909502}
confusion matrix:
      0     1
0  1511     5
1    23  1533
---- Validation: 
scalar performance:
{'acc': 0.66432476, 'precision': 0.7773971, 'recall': 0.6590118, 'specificity': 0.6590118, 'f1': 0.6219216, 'auroc': 0.9206008, 'binary_precision': 0.9504505, 'binary_recall': 0.33492064, 'binary_specificity': 0.9831029, 'binary_f1_score': 0.4953052}
confusion matrix:
     0    1
0  640   11
1  419  211
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.74444443, 'precision': 0.82689667, 'recall': 0.7444445, 'specificity': 0.7444445, 'f1': 0.7272454, 'auroc': 0.9099457, 'binary_precision': 0.9910714, 'binary_recall': 0.49333334, 'binary_specificity': 0.9955556, 'binary_f1_score': 0.6587537}
confusion matrix:
     0    1
0  224    1
1  114  111
early stop counter: 3
val acc:0.6643247604370117, best validation acc: 0.8719750046730042, corresponding to test acc:                         0.8799999952316284 / 0.8799999952316284
after epoch: 12,now: 2024-07-27 14:26:30.074574,epoch time: 0:01:29.440814,used: 0:17:58.840756,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_14_08_31_seed_1_23099035
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.99283856, 'precision': 0.9928294, 'recall': 0.99284613, 'specificity': 0.99284613, 'f1': 0.99283737, 'auroc': 0.99984866, 'binary_precision': 0.99356914, 'binary_recall': 0.9922929, 'binary_specificity': 0.9933993, 'binary_f1_score': 0.99293065}
confusion matrix:
      0     1
0  1505    10
1    12  1545
---- Validation: 
scalar performance:
{'acc': 0.8704137, 'precision': 0.8722428, 'recall': 0.8698413, 'specificity': 0.8698413, 'f1': 0.8700996, 'auroc': 0.92966616, 'binary_precision': 0.89455783, 'binary_recall': 0.83492064, 'binary_specificity': 0.9047619, 'binary_f1_score': 0.86371106}
confusion matrix:
     0    1
0  589   62
1  104  526
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.85333335, 'precision': 0.86370754, 'recall': 0.85333335, 'specificity': 0.85333335, 'f1': 0.85228, 'auroc': 0.91097283, 'binary_precision': 0.9251337, 'binary_recall': 0.7688889, 'binary_specificity': 0.93777776, 'binary_f1_score': 0.83980584}
confusion matrix:
     0    1
0  211   14
1   52  173
early stop counter: 4
val acc:0.8704137206077576, best validation acc: 0.8719750046730042, corresponding to test acc:                         0.8799999952316284 / 0.8799999952316284
after epoch: 13,now: 2024-07-27 14:27:59.452376,epoch time: 0:01:29.377802,used: 0:19:28.218558,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_14_08_31_seed_1_23099035
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9817708, 'precision': 0.9821996, 'recall': 0.98199356, 'specificity': 0.98199356, 'f1': 0.9817702, 'auroc': 0.99919456, 'binary_precision': 1.0, 'binary_recall': 0.9639871, 'binary_specificity': 1.0, 'binary_f1_score': 0.9816634}
confusion matrix:
      0     1
0  1517     0
1    56  1499
---- Validation: 
scalar performance:
{'acc': 0.67447305, 'precision': 0.77216345, 'recall': 0.6694828, 'specificity': 0.6694828, 'f1': 0.63851887, 'auroc': 0.90536106, 'binary_precision': 0.9311741, 'binary_recall': 0.36507937, 'binary_specificity': 0.9738863, 'binary_f1_score': 0.52451545}
confusion matrix:
     0    1
0  634   17
1  400  230
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6533333, 'precision': 0.7301705, 'recall': 0.6533333, 'specificity': 0.6533333, 'f1': 0.6217673, 'auroc': 0.86763453, 'binary_precision': 0.86315787, 'binary_recall': 0.36444443, 'binary_specificity': 0.94222224, 'binary_f1_score': 0.5125}
confusion matrix:
     0   1
0  212  13
1  143  82
early stop counter: 5
val acc:0.6744730472564697, best validation acc: 0.8719750046730042, corresponding to test acc:                         0.8799999952316284 / 0.8799999952316284
after epoch: 14,now: 2024-07-27 14:29:29.043925,epoch time: 0:01:29.591549,used: 0:20:57.810107,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_14_08_31_seed_1_23099035
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 14 with time: 0:20:57.810107 at 2024-07-27 14:29:29.043925
persisted model performance metric: 

scalar performance:
{'acc': 0.88, 'precision': 0.88687783, 'recall': 0.88, 'specificity': 0.88, 'f1': 0.87946427, 'auroc': 0.9356247, 'binary_precision': 0.93846154, 'binary_recall': 0.81333333, 'binary_specificity': 0.94666666, 'binary_f1_score': 0.8714286}
confusion matrix:
     0    1
0  213   12
1   42  183
oracle model performance metric: 

scalar performance:
{'acc': 0.88, 'precision': 0.88687783, 'recall': 0.88, 'specificity': 0.88, 'f1': 0.87946427, 'auroc': 0.9356247, 'binary_precision': 0.93846154, 'binary_recall': 0.81333333, 'binary_specificity': 0.94666666, 'binary_f1_score': 0.8714286}
confusion matrix:
     0    1
0  213   12
1   42  183
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_10seeds_nofreeze_2024-07-27_13-09-31/rule_results/0.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_10seeds_nofreeze_2024-07-27_13-09-31/confusion_matrix/0.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 455469 KiB |   2004 MiB |  54509 GiB |  54509 GiB |
|       from large pool | 414870 KiB |   1971 MiB |  53809 GiB |  53808 GiB |
|       from small pool |  40598 KiB |     60 MiB |    700 GiB |    700 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 455469 KiB |   2004 MiB |  54509 GiB |  54509 GiB |
|       from large pool | 414870 KiB |   1971 MiB |  53809 GiB |  53808 GiB |
|       from small pool |  40598 KiB |     60 MiB |    700 GiB |    700 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 447481 KiB |   1998 MiB |  54311 GiB |  54310 GiB |
|       from large pool | 407075 KiB |   1966 MiB |  53612 GiB |  53612 GiB |
|       from small pool |  40406 KiB |     60 MiB |    698 GiB |    698 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2262 MiB |   2276 MiB |   3716 MiB |   1454 MiB |
|       from large pool |   2192 MiB |   2212 MiB |   3628 MiB |   1436 MiB |
|       from small pool |     70 MiB |     70 MiB |     88 MiB |     18 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 398547 KiB | 487777 KiB |  41760 GiB |  41760 GiB |
|       from large pool | 392041 KiB | 471224 KiB |  41023 GiB |  41022 GiB |
|       from small pool |   6505 KiB |  18493 KiB |    737 GiB |    737 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    1310    |    1681    |   10404 K  |   10403 K  |
|       from large pool |     187    |     311    |    4991 K  |    4991 K  |
|       from small pool |    1123    |    1419    |    5412 K  |    5411 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    1310    |    1681    |   10404 K  |   10403 K  |
|       from large pool |     187    |     311    |    4991 K  |    4991 K  |
|       from small pool |    1123    |    1419    |    5412 K  |    5411 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     126    |     126    |     193    |      67    |
|       from large pool |      91    |      92    |     149    |      58    |
|       from small pool |      35    |      35    |      44    |       9    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      73    |     257    |    5760 K  |    5760 K  |
|       from large pool |      34    |      90    |    3589 K  |    3589 K  |
|       from small pool |      39    |     222    |    2171 K  |    2171 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   2004 MiB |  54509 GiB |  54509 GiB |
|       from large pool |  16640 KiB |   1971 MiB |  53809 GiB |  53809 GiB |
|       from small pool |      0 KiB |     60 MiB |    700 GiB |    700 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   2004 MiB |  54509 GiB |  54509 GiB |
|       from large pool |  16640 KiB |   1971 MiB |  53809 GiB |  53809 GiB |
|       from small pool |      0 KiB |     60 MiB |    700 GiB |    700 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   1998 MiB |  54311 GiB |  54311 GiB |
|       from large pool |  16640 KiB |   1966 MiB |  53612 GiB |  53612 GiB |
|       from small pool |      0 KiB |     60 MiB |    698 GiB |    698 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    834 MiB |   2276 MiB |   3716 MiB |   2882 MiB |
|       from large pool |    788 MiB |   2212 MiB |   3628 MiB |   2840 MiB |
|       from small pool |     46 MiB |     70 MiB |     88 MiB |     42 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  30464 KiB | 487777 KiB |  41760 GiB |  41760 GiB |
|       from large pool |  30464 KiB | 471224 KiB |  41023 GiB |  41023 GiB |
|       from small pool |      0 KiB |  20222 KiB |    737 GiB |    737 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    1681    |   10404 K  |   10404 K  |
|       from large pool |       2    |     311    |    4991 K  |    4991 K  |
|       from small pool |       0    |    1419    |    5412 K  |    5412 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    1681    |   10404 K  |   10404 K  |
|       from large pool |       2    |     311    |    4991 K  |    4991 K  |
|       from small pool |       0    |    1419    |    5412 K  |    5412 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      57    |     126    |     193    |     136    |
|       from large pool |      34    |      92    |     149    |     115    |
|       from small pool |      23    |      35    |      44    |      21    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |     257    |    5760 K  |    5760 K  |
|       from large pool |       4    |      90    |    3589 K  |    3589 K  |
|       from small pool |       0    |     222    |    2171 K  |    2171 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   2004 MiB |  54509 GiB |  54509 GiB |
|       from large pool |  16640 KiB |   1971 MiB |  53809 GiB |  53809 GiB |
|       from small pool |      0 KiB |     60 MiB |    700 GiB |    700 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   2004 MiB |  54509 GiB |  54509 GiB |
|       from large pool |  16640 KiB |   1971 MiB |  53809 GiB |  53809 GiB |
|       from small pool |      0 KiB |     60 MiB |    700 GiB |    700 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   1998 MiB |  54311 GiB |  54311 GiB |
|       from large pool |  16640 KiB |   1966 MiB |  53612 GiB |  53612 GiB |
|       from small pool |      0 KiB |     60 MiB |    698 GiB |    698 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    834 MiB |   2276 MiB |   3716 MiB |   2882 MiB |
|       from large pool |    788 MiB |   2212 MiB |   3628 MiB |   2840 MiB |
|       from small pool |     46 MiB |     70 MiB |     88 MiB |     42 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  30464 KiB | 487777 KiB |  41760 GiB |  41760 GiB |
|       from large pool |  30464 KiB | 471224 KiB |  41023 GiB |  41023 GiB |
|       from small pool |      0 KiB |  20222 KiB |    737 GiB |    737 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    1681    |   10404 K  |   10404 K  |
|       from large pool |       2    |     311    |    4991 K  |    4991 K  |
|       from small pool |       0    |    1419    |    5412 K  |    5412 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    1681    |   10404 K  |   10404 K  |
|       from large pool |       2    |     311    |    4991 K  |    4991 K  |
|       from small pool |       0    |    1419    |    5412 K  |    5412 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      57    |     126    |     193    |     136    |
|       from large pool |      34    |      92    |     149    |     115    |
|       from small pool |      23    |      35    |      44    |      21    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |     257    |    5760 K  |    5760 K  |
|       from large pool |       4    |      90    |    3589 K  |    3589 K  |
|       from small pool |       0    |     222    |    2171 K  |    2171 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_14_30_01_seed_2_23099035

 Experiment start at: 2024-07-27 14:30:02.113413
before training, model accuracy: 0.41203704476356506
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.970877, 'precision': 0.9709048, 'recall': 0.970924, 'specificity': 0.970924, 'f1': 0.9708769, 'auroc': 0.9964354, 'binary_precision': 0.97698885, 'binary_recall': 0.96493506, 'binary_specificity': 0.9769129, 'binary_f1_score': 0.97092456}
confusion matrix:
      0     1
0  1481    35
1    54  1486
---- Validation: 
scalar performance:
{'acc': 0.7856025, 'precision': 0.8214422, 'recall': 0.78107595, 'specificity': 0.78107595, 'f1': 0.7774917, 'auroc': 0.8986354, 'binary_precision': 0.9223301, 'binary_recall': 0.61093247, 'binary_specificity': 0.9512195, 'binary_f1_score': 0.7350097}
confusion matrix:
     0    1
0  624   32
1  242  380
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.75, 'precision': 0.81153846, 'recall': 0.75, 'specificity': 0.75, 'f1': 0.737013, 'auroc': 0.9132801, 'binary_precision': 0.95, 'binary_recall': 0.5277778, 'binary_specificity': 0.9722222, 'binary_f1_score': 0.67857146}
confusion matrix:
     0    1
0  210    6
1  102  114
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-27 14:31:34.291093,epoch time: 0:01:32.177680,used: 0:01:32.177680,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_14_30_01_seed_2_23099035
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9659686, 'precision': 0.96790123, 'recall': 0.96623373, 'specificity': 0.96623373, 'f1': 0.96594524, 'auroc': 0.9977894, 'binary_precision': 1.0, 'binary_recall': 0.9324675, 'binary_specificity': 1.0, 'binary_f1_score': 0.9650538}
confusion matrix:
      0     1
0  1516     0
1   104  1436
---- Validation: 
scalar performance:
{'acc': 0.5680751, 'precision': 0.7460257, 'recall': 0.5564368, 'specificity': 0.5564368, 'f1': 0.4570074, 'auroc': 0.85356295, 'binary_precision': 0.94871795, 'binary_recall': 0.118971065, 'binary_specificity': 0.99390244, 'binary_f1_score': 0.21142857}
confusion matrix:
     0   1
0  652   4
1  548  74
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.587963, 'precision': 0.75054944, 'recall': 0.5879629, 'specificity': 0.5879629, 'f1': 0.50817406, 'auroc': 0.88123715, 'binary_precision': 0.95238096, 'binary_recall': 0.18518518, 'binary_specificity': 0.9907407, 'binary_f1_score': 0.31007752}
confusion matrix:
     0   1
0  214   2
1  176  40
early stop counter: 1
val acc:0.5680751204490662, best validation acc: 0.7856025099754333, corresponding to test acc:                         0.75 / 0.75
after epoch: 2,now: 2024-07-27 14:33:03.042974,epoch time: 0:01:28.751881,used: 0:03:00.929561,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_14_30_01_seed_2_23099035
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.97938484, 'precision': 0.9794489, 'recall': 0.97935015, 'specificity': 0.97935015, 'f1': 0.9793818, 'auroc': 0.9984263, 'binary_precision': 0.9755312, 'binary_recall': 0.98376626, 'binary_specificity': 0.97493404, 'binary_f1_score': 0.9796314}
confusion matrix:
      0     1
0  1478    38
1    25  1515
---- Validation: 
scalar performance:
{'acc': 0.73239434, 'precision': 0.76374125, 'recall': 0.72762185, 'specificity': 0.72762185, 'f1': 0.721389, 'auroc': 0.8402674, 'binary_precision': 0.84825873, 'binary_recall': 0.5482315, 'binary_specificity': 0.9070122, 'binary_f1_score': 0.6660156}
confusion matrix:
     0    1
0  595   61
1  281  341
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6967593, 'precision': 0.78250504, 'recall': 0.6967592, 'specificity': 0.6967592, 'f1': 0.67186004, 'auroc': 0.8814729, 'binary_precision': 0.9381443, 'binary_recall': 0.4212963, 'binary_specificity': 0.9722222, 'binary_f1_score': 0.58146966}
confusion matrix:
     0   1
0  210   6
1  125  91
early stop counter: 2
val acc:0.7323943376541138, best validation acc: 0.7856025099754333, corresponding to test acc:                         0.75 / 0.75
after epoch: 3,now: 2024-07-27 14:34:31.506481,epoch time: 0:01:28.463507,used: 0:04:29.393068,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_14_30_01_seed_2_23099035
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9806937, 'precision': 0.9807192, 'recall': 0.9806745, 'specificity': 0.9806745, 'f1': 0.9806917, 'auroc': 0.9976716, 'binary_precision': 0.9786684, 'binary_recall': 0.98311687, 'binary_specificity': 0.9782322, 'binary_f1_score': 0.98088753}
confusion matrix:
      0     1
0  1483    33
1    26  1514
---- Validation: 
scalar performance:
{'acc': 0.7902973, 'precision': 0.81208384, 'recall': 0.7866908, 'specificity': 0.7866908, 'f1': 0.7850327, 'auroc': 0.875522, 'binary_precision': 0.8881579, 'binary_recall': 0.65112543, 'binary_specificity': 0.9222561, 'binary_f1_score': 0.75139153}
confusion matrix:
     0    1
0  605   51
1  217  405
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7592593, 'precision': 0.7715761, 'recall': 0.7592592, 'specificity': 0.7592592, 'f1': 0.7564984, 'auroc': 0.8544668, 'binary_precision': 0.82941175, 'binary_recall': 0.6527778, 'binary_specificity': 0.8657407, 'binary_f1_score': 0.73056996}
confusion matrix:
     0    1
0  187   29
1   75  141
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-07-27 14:36:00.439009,epoch time: 0:01:28.932528,used: 0:05:58.325596,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_14_30_01_seed_2_23099035
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9790576, 'precision': 0.97915125, 'recall': 0.97912824, 'specificity': 0.97912824, 'f1': 0.97905755, 'auroc': 0.997923, 'binary_precision': 0.9880952, 'binary_recall': 0.97012985, 'binary_specificity': 0.98812664, 'binary_f1_score': 0.97903013}
confusion matrix:
      0     1
0  1498    18
1    46  1494
---- Validation: 
scalar performance:
{'acc': 0.670579, 'precision': 0.745029, 'recall': 0.6629921, 'specificity': 0.6629921, 'f1': 0.6373222, 'auroc': 0.83204997, 'binary_precision': 0.87360597, 'binary_recall': 0.37781352, 'binary_specificity': 0.9481707, 'binary_f1_score': 0.52749723}
confusion matrix:
     0    1
0  622   34
1  387  235
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6365741, 'precision': 0.78156066, 'recall': 0.6365741, 'specificity': 0.6365741, 'f1': 0.58287567, 'auroc': 0.91503775, 'binary_precision': 0.9836066, 'binary_recall': 0.2777778, 'binary_specificity': 0.9953704, 'binary_f1_score': 0.433213}
confusion matrix:
     0   1
0  215   1
1  156  60
early stop counter: 1
val acc:0.6705790162086487, best validation acc: 0.7902973294258118, corresponding to test acc:                         0.7592592835426331 / 0.7592592835426331
after epoch: 5,now: 2024-07-27 14:37:29.002100,epoch time: 0:01:28.563091,used: 0:07:26.888687,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_14_30_01_seed_2_23099035
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.983966, 'precision': 0.9840344, 'recall': 0.98402923, 'specificity': 0.98402923, 'f1': 0.983966, 'auroc': 0.9986649, 'binary_precision': 0.9920792, 'binary_recall': 0.975974, 'binary_specificity': 0.99208444, 'binary_f1_score': 0.98396075}
confusion matrix:
      0     1
0  1504    12
1    37  1503
---- Validation: 
scalar performance:
{'acc': 0.6486698, 'precision': 0.75920486, 'recall': 0.63973415, 'specificity': 0.63973415, 'f1': 0.598693, 'auroc': 0.83649814, 'binary_precision': 0.92195123, 'binary_recall': 0.30385852, 'binary_specificity': 0.9756098, 'binary_f1_score': 0.45707372}
confusion matrix:
     0    1
0  640   16
1  433  189
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6689815, 'precision': 0.7944538, 'recall': 0.6689815, 'specificity': 0.6689815, 'f1': 0.62951374, 'auroc': 0.90279925, 'binary_precision': 0.9866667, 'binary_recall': 0.3425926, 'binary_specificity': 0.9953704, 'binary_f1_score': 0.50859106}
confusion matrix:
     0   1
0  215   1
1  142  74
early stop counter: 2
val acc:0.6486697793006897, best validation acc: 0.7902973294258118, corresponding to test acc:                         0.7592592835426331 / 0.7592592835426331
after epoch: 6,now: 2024-07-27 14:38:57.558714,epoch time: 0:01:28.556614,used: 0:08:55.445301,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_14_30_01_seed_2_23099035
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9872382, 'precision': 0.98726475, 'recall': 0.98721945, 'specificity': 0.98721945, 'f1': 0.98723686, 'auroc': 0.9988289, 'binary_precision': 0.9851325, 'binary_recall': 0.9896104, 'binary_specificity': 0.9848285, 'binary_f1_score': 0.9873664}
confusion matrix:
      0     1
0  1493    23
1    16  1524
---- Validation: 
scalar performance:
{'acc': 0.7394366, 'precision': 0.7395426, 'recall': 0.7387729, 'specificity': 0.7387729, 'f1': 0.73891723, 'auroc': 0.81425476, 'binary_precision': 0.7412354, 'binary_recall': 0.71382636, 'binary_specificity': 0.7637195, 'binary_f1_score': 0.72727275}
confusion matrix:
     0    1
0  501  155
1  178  444
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7939815, 'precision': 0.7940382, 'recall': 0.79398143, 'specificity': 0.79398143, 'f1': 0.79397154, 'auroc': 0.88007975, 'binary_precision': 0.78995436, 'binary_recall': 0.8009259, 'binary_specificity': 0.787037, 'binary_f1_score': 0.7954023}
confusion matrix:
     0    1
0  170   46
1   43  173
new oracle model saved
early stop counter: 3
val acc:0.7394366264343262, best validation acc: 0.7902973294258118, corresponding to test acc:                         0.7592592835426331 / 0.7939814925193787
after epoch: 7,now: 2024-07-27 14:40:26.065552,epoch time: 0:01:28.506838,used: 0:10:23.952139,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_14_30_01_seed_2_23099035
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9878927, 'precision': 0.9878954, 'recall': 0.98792535, 'specificity': 0.98792535, 'f1': 0.9878925, 'auroc': 0.99948597, 'binary_precision': 0.9921414, 'binary_recall': 0.98376626, 'binary_specificity': 0.99208444, 'binary_f1_score': 0.9879361}
confusion matrix:
      0     1
0  1504    12
1    25  1515
---- Validation: 
scalar performance:
{'acc': 0.786385, 'precision': 0.806998, 'recall': 0.7828381, 'specificity': 0.7828381, 'f1': 0.7811856, 'auroc': 0.8774067, 'binary_precision': 0.8801743, 'binary_recall': 0.64951766, 'binary_specificity': 0.91615856, 'binary_f1_score': 0.747456}
confusion matrix:
     0    1
0  601   55
1  218  404
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8171296, 'precision': 0.8201558, 'recall': 0.8171296, 'specificity': 0.8171296, 'f1': 0.8166964, 'auroc': 0.89746225, 'binary_precision': 0.85128206, 'binary_recall': 0.7685185, 'binary_specificity': 0.8657407, 'binary_f1_score': 0.80778587}
confusion matrix:
     0    1
0  187   29
1   50  166
new oracle model saved
early stop counter: 4
val acc:0.7863849997520447, best validation acc: 0.7902973294258118, corresponding to test acc:                         0.7592592835426331 / 0.8171296119689941
after epoch: 8,now: 2024-07-27 14:41:54.892699,epoch time: 0:01:28.827147,used: 0:11:52.779286,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_14_30_01_seed_2_23099035
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9888743, 'precision': 0.98891914, 'recall': 0.988848, 'specificity': 0.988848, 'f1': 0.988873, 'auroc': 0.99942565, 'binary_precision': 0.98580647, 'binary_recall': 0.99220777, 'binary_specificity': 0.9854881, 'binary_f1_score': 0.9889968}
confusion matrix:
      0     1
0  1494    22
1    12  1528
---- Validation: 
scalar performance:
{'acc': 0.8356807, 'precision': 0.84182477, 'recall': 0.83385617, 'specificity': 0.83385617, 'f1': 0.8343158, 'auroc': 0.901444, 'binary_precision': 0.88148147, 'binary_recall': 0.76527333, 'binary_specificity': 0.902439, 'binary_f1_score': 0.81927717}
confusion matrix:
     0    1
0  592   64
1  146  476
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8171296, 'precision': 0.8289828, 'recall': 0.8171296, 'specificity': 0.8171296, 'f1': 0.8154675, 'auroc': 0.89540464, 'binary_precision': 0.8914286, 'binary_recall': 0.7222222, 'binary_specificity': 0.912037, 'binary_f1_score': 0.7979539}
confusion matrix:
     0    1
0  197   19
1   60  156
better model found
persisted
after epoch: 9,now: 2024-07-27 14:43:23.630389,epoch time: 0:01:28.737690,used: 0:13:21.516976,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_14_30_01_seed_2_23099035
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9895288, 'precision': 0.9895288, 'recall': 0.98955894, 'specificity': 0.98955894, 'f1': 0.9895286, 'auroc': 0.9995446, 'binary_precision': 0.99345547, 'binary_recall': 0.98571426, 'binary_specificity': 0.9934037, 'binary_f1_score': 0.9895697}
confusion matrix:
      0     1
0  1506    10
1    22  1518
---- Validation: 
scalar performance:
{'acc': 0.6111111, 'precision': 0.7506011, 'recall': 0.600899, 'specificity': 0.600899, 'f1': 0.53710604, 'auroc': 0.86201084, 'binary_precision': 0.9310345, 'binary_recall': 0.2170418, 'binary_specificity': 0.9847561, 'binary_f1_score': 0.35202086}
confusion matrix:
     0    1
0  646   10
1  487  135
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5856481, 'precision': 0.7607164, 'recall': 0.5856482, 'specificity': 0.5856482, 'f1': 0.5020574, 'auroc': 0.8799511, 'binary_precision': 0.974359, 'binary_recall': 0.17592593, 'binary_specificity': 0.9953704, 'binary_f1_score': 0.29803923}
confusion matrix:
     0   1
0  215   1
1  178  38
early stop counter: 1
val acc:0.6111111044883728, best validation acc: 0.8356807231903076, corresponding to test acc:                         0.8171296119689941 / 0.8171296119689941
after epoch: 10,now: 2024-07-27 14:44:52.302205,epoch time: 0:01:28.671816,used: 0:14:50.188792,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_14_30_01_seed_2_23099035
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.98854715, 'precision': 0.98867154, 'recall': 0.98862606, 'specificity': 0.98862606, 'f1': 0.9885471, 'auroc': 0.9994869, 'binary_precision': 0.99867463, 'binary_recall': 0.9785714, 'binary_specificity': 0.9986807, 'binary_f1_score': 0.9885208}
confusion matrix:
      0     1
0  1514     2
1    33  1507
---- Validation: 
scalar performance:
{'acc': 0.58294207, 'precision': 0.7381196, 'recall': 0.5718767, 'specificity': 0.5718767, 'f1': 0.487717, 'auroc': 0.8736037, 'binary_precision': 0.9238095, 'binary_recall': 0.15594855, 'binary_specificity': 0.9878049, 'binary_f1_score': 0.26685005}
confusion matrix:
     0   1
0  648   8
1  525  97
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5925926, 'precision': 0.7530459, 'recall': 0.5925926, 'specificity': 0.5925926, 'f1': 0.5158431, 'auroc': 0.9101295, 'binary_precision': 0.95454544, 'binary_recall': 0.19444445, 'binary_specificity': 0.9907407, 'binary_f1_score': 0.32307693}
confusion matrix:
     0   1
0  214   2
1  174  42
early stop counter: 2
val acc:0.5829420685768127, best validation acc: 0.8356807231903076, corresponding to test acc:                         0.8171296119689941 / 0.8171296119689941
after epoch: 11,now: 2024-07-27 14:46:20.767388,epoch time: 0:01:28.465183,used: 0:16:18.653975,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_14_30_01_seed_2_23099035
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.973822, 'precision': 0.9748194, 'recall': 0.9740157, 'specificity': 0.9740157, 'f1': 0.97381437, 'auroc': 0.99861217, 'binary_precision': 0.99863386, 'binary_recall': 0.94935066, 'binary_specificity': 0.9986807, 'binary_f1_score': 0.9733689}
confusion matrix:
      0     1
0  1514     2
1    78  1462
---- Validation: 
scalar performance:
{'acc': 0.51799685, 'precision': 0.65788645, 'recall': 0.5049065, 'specificity': 0.5049065, 'f1': 0.35257506, 'auroc': 0.8725823, 'binary_precision': 0.8, 'binary_recall': 0.012861736, 'binary_specificity': 0.9969512, 'binary_f1_score': 0.025316454}
confusion matrix:
     0  1
0  654  2
1  614  8
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.49537036, 'precision': 0.2488372, 'recall': 0.49537036, 'specificity': 0.49537036, 'f1': 0.33126935, 'auroc': 0.73268175, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9907407, 'binary_f1_score': 0.0}
confusion matrix:
     0  1
0  214  2
1  216  0
early stop counter: 3
val acc:0.5179968476295471, best validation acc: 0.8356807231903076, corresponding to test acc:                         0.8171296119689941 / 0.8171296119689941
after epoch: 12,now: 2024-07-27 14:47:49.282243,epoch time: 0:01:28.514855,used: 0:17:47.168830,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_14_30_01_seed_2_23099035
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9941099, 'precision': 0.9941057, 'recall': 0.99413526, 'specificity': 0.99413526, 'f1': 0.99410987, 'auroc': 0.9998312, 'binary_precision': 0.9973856, 'binary_recall': 0.9909091, 'binary_specificity': 0.9973615, 'binary_f1_score': 0.9941368}
confusion matrix:
      0     1
0  1512     4
1    14  1526
---- Validation: 
scalar performance:
{'acc': 0.8231612, 'precision': 0.84663546, 'recall': 0.8196612, 'specificity': 0.8196612, 'f1': 0.81890166, 'auroc': 0.9106369, 'binary_precision': 0.93043476, 'binary_recall': 0.6881029, 'binary_specificity': 0.9512195, 'binary_f1_score': 0.79112756}
confusion matrix:
     0    1
0  624   32
1  194  428
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8263889, 'precision': 0.84729856, 'recall': 0.8263889, 'specificity': 0.8263889, 'f1': 0.82373583, 'auroc': 0.91045094, 'binary_precision': 0.9325153, 'binary_recall': 0.7037037, 'binary_specificity': 0.9490741, 'binary_f1_score': 0.8021108}
confusion matrix:
     0    1
0  205   11
1   64  152
new oracle model saved
early stop counter: 4
val acc:0.8231611847877502, best validation acc: 0.8356807231903076, corresponding to test acc:                         0.8171296119689941 / 0.8263888955116272
after epoch: 13,now: 2024-07-27 14:49:18.203533,epoch time: 0:01:28.921290,used: 0:19:16.090120,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_14_30_01_seed_2_23099035
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9842932, 'precision': 0.9846547, 'recall': 0.9844156, 'specificity': 0.9844156, 'f1': 0.98429227, 'auroc': 0.999812, 'binary_precision': 1.0, 'binary_recall': 0.9688312, 'binary_specificity': 1.0, 'binary_f1_score': 0.9841689}
confusion matrix:
      0     1
0  1516     0
1    48  1492
---- Validation: 
scalar performance:
{'acc': 0.64945227, 'precision': 0.7864562, 'recall': 0.640038, 'specificity': 0.640038, 'f1': 0.5935391, 'auroc': 0.91582406, 'binary_precision': 0.978022, 'binary_recall': 0.28617364, 'binary_specificity': 0.99390244, 'binary_f1_score': 0.44278604}
confusion matrix:
     0    1
0  652    4
1  444  178
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5138889, 'precision': 0.7535211, 'recall': 0.5138889, 'specificity': 0.5138889, 'f1': 0.36347565, 'auroc': 0.8735157, 'binary_precision': 1.0, 'binary_recall': 0.027777778, 'binary_specificity': 1.0, 'binary_f1_score': 0.054054055}
confusion matrix:
     0  1
0  216  0
1  210  6
early stop counter: 5
val acc:0.649452269077301, best validation acc: 0.8356807231903076, corresponding to test acc:                         0.8171296119689941 / 0.8263888955116272
after epoch: 14,now: 2024-07-27 14:50:47.023730,epoch time: 0:01:28.820197,used: 0:20:44.910317,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_14_30_01_seed_2_23099035
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 14 with time: 0:20:44.910317 at 2024-07-27 14:50:47.023730
persisted model performance metric: 

scalar performance:
{'acc': 0.8171296, 'precision': 0.8289828, 'recall': 0.8171296, 'specificity': 0.8171296, 'f1': 0.8154675, 'auroc': 0.89540464, 'binary_precision': 0.8914286, 'binary_recall': 0.7222222, 'binary_specificity': 0.912037, 'binary_f1_score': 0.7979539}
confusion matrix:
     0    1
0  197   19
1   60  156
oracle model performance metric: 

scalar performance:
{'acc': 0.8263889, 'precision': 0.84729856, 'recall': 0.8263889, 'specificity': 0.8263889, 'f1': 0.82373583, 'auroc': 0.91045094, 'binary_precision': 0.9325153, 'binary_recall': 0.7037037, 'binary_specificity': 0.9490741, 'binary_f1_score': 0.8021108}
confusion matrix:
     0    1
0  205   11
1   64  152
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_10seeds_nofreeze_2024-07-27_13-09-31/rule_results/0.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_10seeds_nofreeze_2024-07-27_13-09-31/confusion_matrix/0.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 455387 KiB |   2004 MiB |  84828 GiB |  84827 GiB |
|       from large pool | 414795 KiB |   1971 MiB |  83741 GiB |  83740 GiB |
|       from small pool |  40592 KiB |     60 MiB |   1087 GiB |   1087 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 455387 KiB |   2004 MiB |  84828 GiB |  84827 GiB |
|       from large pool | 414795 KiB |   1971 MiB |  83741 GiB |  83740 GiB |
|       from small pool |  40592 KiB |     60 MiB |   1087 GiB |   1087 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 447481 KiB |   1998 MiB |  84526 GiB |  84526 GiB |
|       from large pool | 407075 KiB |   1966 MiB |  83441 GiB |  83441 GiB |
|       from small pool |  40406 KiB |     60 MiB |   1085 GiB |   1085 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2268 MiB |   2276 MiB |   5150 MiB |   2882 MiB |
|       from large pool |   2204 MiB |   2212 MiB |   5044 MiB |   2840 MiB |
|       from small pool |     64 MiB |     70 MiB |    106 MiB |     42 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 367908 KiB | 487777 KiB |  65269 GiB |  65269 GiB |
|       from large pool | 361397 KiB | 471224 KiB |  64125 GiB |  64124 GiB |
|       from small pool |   6511 KiB |  20222 KiB |   1144 GiB |   1144 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    1298    |    1681    |   16180 K  |   16179 K  |
|       from large pool |     187    |     311    |    7767 K  |    7767 K  |
|       from small pool |    1111    |    1419    |    8412 K  |    8411 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    1298    |    1681    |   16180 K  |   16179 K  |
|       from large pool |     187    |     311    |    7767 K  |    7767 K  |
|       from small pool |    1111    |    1419    |    8412 K  |    8411 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     123    |     126    |     259    |     136    |
|       from large pool |      91    |      92    |     206    |     115    |
|       from small pool |      32    |      35    |      53    |      21    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      73    |     257    |    8682 K  |    8682 K  |
|       from large pool |      34    |      90    |    5332 K  |    5332 K  |
|       from small pool |      39    |     222    |    3349 K  |    3349 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   2004 MiB |  84828 GiB |  84828 GiB |
|       from large pool |  16640 KiB |   1971 MiB |  83741 GiB |  83741 GiB |
|       from small pool |      0 KiB |     60 MiB |   1087 GiB |   1087 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   2004 MiB |  84828 GiB |  84828 GiB |
|       from large pool |  16640 KiB |   1971 MiB |  83741 GiB |  83741 GiB |
|       from small pool |      0 KiB |     60 MiB |   1087 GiB |   1087 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   1998 MiB |  84526 GiB |  84526 GiB |
|       from large pool |  16640 KiB |   1966 MiB |  83441 GiB |  83441 GiB |
|       from small pool |      0 KiB |     60 MiB |   1085 GiB |   1085 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    804 MiB |   2276 MiB |   5150 MiB |   4346 MiB |
|       from large pool |    758 MiB |   2212 MiB |   5044 MiB |   4286 MiB |
|       from small pool |     46 MiB |     70 MiB |    106 MiB |     60 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  30464 KiB | 487777 KiB |  65269 GiB |  65269 GiB |
|       from large pool |  30464 KiB | 471224 KiB |  64125 GiB |  64125 GiB |
|       from small pool |      0 KiB |  20228 KiB |   1144 GiB |   1144 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    1681    |   16180 K  |   16180 K  |
|       from large pool |       2    |     311    |    7767 K  |    7767 K  |
|       from small pool |       0    |    1419    |    8412 K  |    8412 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    1681    |   16180 K  |   16180 K  |
|       from large pool |       2    |     311    |    7767 K  |    7767 K  |
|       from small pool |       0    |    1419    |    8412 K  |    8412 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      57    |     126    |     259    |     202    |
|       from large pool |      34    |      92    |     206    |     172    |
|       from small pool |      23    |      35    |      53    |      30    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |     257    |    8682 K  |    8682 K  |
|       from large pool |       4    |      90    |    5332 K  |    5332 K  |
|       from small pool |       0    |     222    |    3349 K  |    3349 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Sat Jul 27 14:50:53 2024]
Finished job 0.
1 of 1 steps (100%) done
