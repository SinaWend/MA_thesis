Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Sat Jul 27 13:49:04 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_10seeds_nofreeze_2024-07-27_13-09-31/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_10seeds_nofreeze_2024-07-27_13-09-31/rule_results/1.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=1
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/swiglu_ffn.py:51: UserWarning: xFormers is not available (SwiGLU)
  warnings.warn("xFormers is not available (SwiGLU)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/attention.py:33: UserWarning: xFormers is not available (Attention)
  warnings.warn("xFormers is not available (Attention)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/block.py:40: UserWarning: xFormers is not available (Block)
  warnings.warn("xFormers is not available (Block)")
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center0_dann_b8efecac6_not_commited_2024md_07md_27_13_51_29_seed_0_23099036

 Experiment start at: 2024-07-27 13:51:29.904421
before training, model accuracy: 0.49534884095191956
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9186198, 'precision': 0.9201648, 'recall': 0.9190384, 'specificity': 0.9190384, 'f1': 0.9185866, 'auroc': 0.96841025, 'binary_precision': 0.9491059, 'binary_recall': 0.88688946, 'binary_specificity': 0.9511873, 'binary_f1_score': 0.9169435}
confusion matrix:
      0     1
0  1442    74
1   176  1380
---- Validation: 
scalar performance:
{'acc': 0.68167704, 'precision': 0.76518214, 'recall': 0.6855434, 'specificity': 0.6855434, 'f1': 0.6572262, 'auroc': 0.8113215, 'binary_precision': 0.6128385, 'binary_recall': 0.9622047, 'binary_specificity': 0.40888208, 'binary_f1_score': 0.74877447}
confusion matrix:
     0    1
0  267  386
1   24  611
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.69302326, 'precision': 0.75816673, 'recall': 0.69302326, 'specificity': 0.69302326, 'f1': 0.6723545, 'auroc': 0.8393185, 'binary_precision': 0.628483, 'binary_recall': 0.94418603, 'binary_specificity': 0.44186047, 'binary_f1_score': 0.7546469}
confusion matrix:
    0    1
0  95  120
1  12  203
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-27 13:53:36.541149,epoch time: 0:02:06.636728,used: 0:02:06.636728,model: dset_te_center0_dann_b8efecac6_not_commited_2024md_07md_27_13_51_29_seed_0_23099036
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.89941406, 'precision': 0.9149519, 'recall': 0.900627, 'specificity': 0.900627, 'f1': 0.8986485, 'auroc': 0.97227776, 'binary_precision': 0.9984, 'binary_recall': 0.80257237, 'binary_specificity': 0.9986816, 'binary_f1_score': 0.8898396}
confusion matrix:
      0     1
0  1515     2
1   307  1248
---- Validation: 
scalar performance:
{'acc': 0.50621116, 'precision': 0.48060083, 'recall': 0.49934283, 'specificity': 0.49934283, 'f1': 0.34297308, 'auroc': 0.8499644, 'binary_precision': 0.45454547, 'binary_recall': 0.007874016, 'binary_specificity': 0.99081165, 'binary_f1_score': 0.015479877}
confusion matrix:
     0  1
0  647  6
1  630  5
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.4976744, 'precision': 0.24941725, 'recall': 0.4976744, 'specificity': 0.4976744, 'f1': 0.33229813, 'auroc': 0.86323416, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9953488, 'binary_f1_score': 0.0}
confusion matrix:
     0  1
0  214  1
1  215  0
early stop counter: 1
val acc:0.5062111616134644, best validation acc: 0.6816770434379578, corresponding to test acc:                         0.6930232644081116 / 0.6930232644081116
after epoch: 2,now: 2024-07-27 13:55:38.056413,epoch time: 0:02:01.515264,used: 0:04:08.151992,model: dset_te_center0_dann_b8efecac6_not_commited_2024md_07md_27_13_51_29_seed_0_23099036
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9251302, 'precision': 0.9305774, 'recall': 0.9259263, 'specificity': 0.9259263, 'f1': 0.9249743, 'auroc': 0.9818586, 'binary_precision': 0.98254544, 'binary_recall': 0.86769426, 'binary_specificity': 0.9841584, 'binary_f1_score': 0.92155516}
confusion matrix:
      0     1
0  1491    24
1   206  1351
---- Validation: 
scalar performance:
{'acc': 0.6785714, 'precision': 0.77035284, 'recall': 0.6825892, 'specificity': 0.6825892, 'f1': 0.65166, 'auroc': 0.8571644, 'binary_precision': 0.60929775, 'binary_recall': 0.97007877, 'binary_specificity': 0.39509955, 'binary_f1_score': 0.7484813}
confusion matrix:
     0    1
0  258  395
1   19  616
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7651163, 'precision': 0.7955576, 'recall': 0.7651163, 'specificity': 0.7651163, 'f1': 0.7589084, 'auroc': 0.8674202, 'binary_precision': 0.7007042, 'binary_recall': 0.9255814, 'binary_specificity': 0.60465115, 'binary_f1_score': 0.7975952}
confusion matrix:
     0    1
0  130   85
1   16  199
new oracle model saved
early stop counter: 2
val acc:0.6785714030265808, best validation acc: 0.6816770434379578, corresponding to test acc:                         0.6930232644081116 / 0.765116274356842
after epoch: 3,now: 2024-07-27 13:57:38.976905,epoch time: 0:02:00.920492,used: 0:06:09.072484,model: dset_te_center0_dann_b8efecac6_not_commited_2024md_07md_27_13_51_29_seed_0_23099036
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.93066406, 'precision': 0.93068266, 'recall': 0.93062264, 'specificity': 0.93062264, 'f1': 0.9306478, 'auroc': 0.9839251, 'binary_precision': 0.92962253, 'binary_recall': 0.93380463, 'binary_specificity': 0.92744064, 'binary_f1_score': 0.9317089}
confusion matrix:
      0     1
0  1406   110
1   103  1453
---- Validation: 
scalar performance:
{'acc': 0.5869565, 'precision': 0.7431748, 'recall': 0.59247565, 'specificity': 0.59247565, 'f1': 0.51435494, 'auroc': 0.82590103, 'binary_precision': 0.5447437, 'binary_recall': 0.98740155, 'binary_specificity': 0.19754978, 'binary_f1_score': 0.70212764}
confusion matrix:
     0    1
0  129  524
1    8  627
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.65581393, 'precision': 0.7500781, 'recall': 0.65581393, 'specificity': 0.65581393, 'f1': 0.62000525, 'auroc': 0.8457328, 'binary_precision': 0.59654176, 'binary_recall': 0.96279067, 'binary_specificity': 0.3488372, 'binary_f1_score': 0.73665476}
confusion matrix:
    0    1
0  75  140
1   8  207
early stop counter: 3
val acc:0.5869565010070801, best validation acc: 0.6816770434379578, corresponding to test acc:                         0.6930232644081116 / 0.765116274356842
after epoch: 4,now: 2024-07-27 13:59:39.018672,epoch time: 0:02:00.041767,used: 0:08:09.114251,model: dset_te_center0_dann_b8efecac6_not_commited_2024md_07md_27_13_51_29_seed_0_23099036
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.93652344, 'precision': 0.9423585, 'recall': 0.9372588, 'specificity': 0.9372588, 'f1': 0.93637776, 'auroc': 0.9894825, 'binary_precision': 0.99635035, 'binary_recall': 0.8778135, 'binary_specificity': 0.99670404, 'binary_f1_score': 0.93333334}
confusion matrix:
      0     1
0  1512     5
1   190  1365
---- Validation: 
scalar performance:
{'acc': 0.77717394, 'precision': 0.80781245, 'recall': 0.77935517, 'specificity': 0.77935517, 'f1': 0.7723758, 'auroc': 0.7840277, 'binary_precision': 0.70714283, 'binary_recall': 0.9354331, 'binary_specificity': 0.6232772, 'binary_f1_score': 0.8054237}
confusion matrix:
     0    1
0  407  246
1   41  594
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7860465, 'precision': 0.7952703, 'recall': 0.7860465, 'specificity': 0.7860465, 'f1': 0.7843625, 'auroc': 0.7994376, 'binary_precision': 0.743083, 'binary_recall': 0.8744186, 'binary_specificity': 0.6976744, 'binary_f1_score': 0.8034188}
confusion matrix:
     0    1
0  150   65
1   27  188
new oracle model saved
better model found
persisted
after epoch: 5,now: 2024-07-27 14:01:40.206097,epoch time: 0:02:01.187425,used: 0:10:10.301676,model: dset_te_center0_dann_b8efecac6_not_commited_2024md_07md_27_13_51_29_seed_0_23099036
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9485677, 'precision': 0.9495924, 'recall': 0.9488735, 'specificity': 0.9488735, 'f1': 0.9485562, 'auroc': 0.986539, 'binary_precision': 0.9741848, 'binary_recall': 0.9227799, 'binary_specificity': 0.97496706, 'binary_f1_score': 0.94778585}
confusion matrix:
      0     1
0  1480    38
1   120  1434
---- Validation: 
scalar performance:
{'acc': 0.83074534, 'precision': 0.8320037, 'recall': 0.83029985, 'specificity': 0.83029985, 'f1': 0.8304248, 'auroc': 0.87712073, 'binary_precision': 0.8492462, 'binary_recall': 0.7984252, 'binary_specificity': 0.8621746, 'binary_f1_score': 0.8230519}
confusion matrix:
     0    1
0  563   90
1  128  507
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8372093, 'precision': 0.8458586, 'recall': 0.83720934, 'specificity': 0.83720934, 'f1': 0.8361851, 'auroc': 0.87613845, 'binary_precision': 0.9005525, 'binary_recall': 0.75813955, 'binary_specificity': 0.9162791, 'binary_f1_score': 0.82323235}
confusion matrix:
     0    1
0  197   18
1   52  163
new oracle model saved
better model found
persisted
after epoch: 6,now: 2024-07-27 14:03:41.320643,epoch time: 0:02:01.114546,used: 0:12:11.416222,model: dset_te_center0_dann_b8efecac6_not_commited_2024md_07md_27_13_51_29_seed_0_23099036
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9355469, 'precision': 0.9402889, 'recall': 0.9348011, 'specificity': 0.9348011, 'f1': 0.9352834, 'auroc': 0.9898629, 'binary_precision': 0.8981861, 'binary_recall': 0.9846055, 'binary_specificity': 0.8849967, 'binary_f1_score': 0.9394125}
confusion matrix:
      0     1
0  1339   174
1    24  1535
---- Validation: 
scalar performance:
{'acc': 0.7243789, 'precision': 0.7907223, 'recall': 0.7276784, 'specificity': 0.7276784, 'f1': 0.70955294, 'auroc': 0.74675333, 'binary_precision': 0.64830506, 'binary_recall': 0.9637795, 'binary_specificity': 0.49157733, 'binary_f1_score': 0.77517414}
confusion matrix:
     0    1
0  321  332
1   23  612
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.74418604, 'precision': 0.7790551, 'recall': 0.74418604, 'specificity': 0.74418604, 'f1': 0.7359371, 'auroc': 0.7618172, 'binary_precision': 0.68041235, 'binary_recall': 0.9209302, 'binary_specificity': 0.5674419, 'binary_f1_score': 0.7826087}
confusion matrix:
     0    1
0  122   93
1   17  198
early stop counter: 1
val acc:0.7243788838386536, best validation acc: 0.8307453393936157, corresponding to test acc:                         0.8372092843055725 / 0.8372092843055725
after epoch: 7,now: 2024-07-27 14:05:42.367615,epoch time: 0:02:01.046972,used: 0:14:12.463194,model: dset_te_center0_dann_b8efecac6_not_commited_2024md_07md_27_13_51_29_seed_0_23099036
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9554036, 'precision': 0.9569472, 'recall': 0.9558158, 'specificity': 0.9558158, 'f1': 0.9553872, 'auroc': 0.9905999, 'binary_precision': 0.9869595, 'binary_recall': 0.92416453, 'binary_specificity': 0.987467, 'binary_f1_score': 0.9545304}
confusion matrix:
      0     1
0  1497    19
1   118  1438
---- Validation: 
scalar performance:
{'acc': 0.8159938, 'precision': 0.824913, 'recall': 0.81714076, 'specificity': 0.81714076, 'f1': 0.8150706, 'auroc': 0.894001, 'binary_precision': 0.7674731, 'binary_recall': 0.8992126, 'binary_specificity': 0.7350689, 'binary_f1_score': 0.8281363}
confusion matrix:
     0    1
0  480  173
1   64  571
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.83488375, 'precision': 0.8349489, 'recall': 0.8348837, 'specificity': 0.8348837, 'f1': 0.8348757, 'auroc': 0.8838507, 'binary_precision': 0.8396226, 'binary_recall': 0.82790697, 'binary_specificity': 0.8418605, 'binary_f1_score': 0.8337236}
confusion matrix:
     0    1
0  181   34
1   37  178
early stop counter: 2
val acc:0.8159937858581543, best validation acc: 0.8307453393936157, corresponding to test acc:                         0.8372092843055725 / 0.8372092843055725
after epoch: 8,now: 2024-07-27 14:07:43.315523,epoch time: 0:02:00.947908,used: 0:16:13.411102,model: dset_te_center0_dann_b8efecac6_not_commited_2024md_07md_27_13_51_29_seed_0_23099036
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9671224, 'precision': 0.9679266, 'recall': 0.9674654, 'specificity': 0.9674654, 'f1': 0.96711904, 'auroc': 0.9957682, 'binary_precision': 0.991234, 'binary_recall': 0.9435173, 'binary_specificity': 0.9914135, 'binary_f1_score': 0.9667873}
confusion matrix:
      0     1
0  1501    13
1    88  1470
---- Validation: 
scalar performance:
{'acc': 0.8586956, 'precision': 0.85868096, 'recall': 0.85864633, 'specificity': 0.85864633, 'f1': 0.85866153, 'auroc': 0.8863658, 'binary_precision': 0.8578199, 'binary_recall': 0.8551181, 'binary_specificity': 0.8621746, 'binary_f1_score': 0.8564668}
confusion matrix:
     0    1
0  563   90
1   92  543
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8395349, 'precision': 0.8441886, 'recall': 0.8395349, 'specificity': 0.8395349, 'f1': 0.8389907, 'auroc': 0.9022931, 'binary_precision': 0.8842105, 'binary_recall': 0.7813954, 'binary_specificity': 0.89767444, 'binary_f1_score': 0.82962966}
confusion matrix:
     0    1
0  193   22
1   47  168
new oracle model saved
better model found
persisted
after epoch: 9,now: 2024-07-27 14:09:45.515490,epoch time: 0:02:02.199967,used: 0:18:15.611069,model: dset_te_center0_dann_b8efecac6_not_commited_2024md_07md_27_13_51_29_seed_0_23099036
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9436849, 'precision': 0.94844824, 'recall': 0.9444962, 'specificity': 0.9444962, 'f1': 0.9435945, 'auroc': 0.991384, 'binary_precision': 0.99856114, 'binary_recall': 0.8903143, 'binary_specificity': 0.99867815, 'binary_f1_score': 0.94133604}
confusion matrix:
      0     1
0  1511     2
1   171  1388
---- Validation: 
scalar performance:
{'acc': 0.5869565, 'precision': 0.6993772, 'recall': 0.58160156, 'specificity': 0.58160156, 'f1': 0.5122768, 'auroc': 0.87063944, 'binary_precision': 0.84563756, 'binary_recall': 0.1984252, 'binary_specificity': 0.96477795, 'binary_f1_score': 0.3214286}
confusion matrix:
     0    1
0  630   23
1  509  126
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5511628, 'precision': 0.6756536, 'recall': 0.5511628, 'specificity': 0.5511628, 'f1': 0.454512, 'auroc': 0.8661547, 'binary_precision': 0.8235294, 'binary_recall': 0.13023256, 'binary_specificity': 0.97209305, 'binary_f1_score': 0.22489959}
confusion matrix:
     0   1
0  209   6
1  187  28
early stop counter: 1
val acc:0.5869565010070801, best validation acc: 0.8586956262588501, corresponding to test acc:                         0.8395348787307739 / 0.8395348787307739
after epoch: 10,now: 2024-07-27 14:11:47.133064,epoch time: 0:02:01.617574,used: 0:20:17.228643,model: dset_te_center0_dann_b8efecac6_not_commited_2024md_07md_27_13_51_29_seed_0_23099036
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.960612, 'precision': 0.96089906, 'recall': 0.9604811, 'specificity': 0.9604811, 'f1': 0.9605921, 'auroc': 0.994155, 'binary_precision': 0.9520807, 'binary_recall': 0.9710611, 'binary_specificity': 0.9499011, 'binary_f1_score': 0.9614772}
confusion matrix:
      0     1
0  1441    76
1    45  1510
---- Validation: 
scalar performance:
{'acc': 0.8159938, 'precision': 0.8347847, 'recall': 0.81763995, 'specificity': 0.81763995, 'f1': 0.81388813, 'auroc': 0.89860004, 'binary_precision': 0.7518987, 'binary_recall': 0.9354331, 'binary_specificity': 0.69984686, 'binary_f1_score': 0.83368415}
confusion matrix:
     0    1
0  457  196
1   41  594
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7976744, 'precision': 0.8169339, 'recall': 0.7976744, 'specificity': 0.7976744, 'f1': 0.7945532, 'auroc': 0.9176636, 'binary_precision': 0.73880595, 'binary_recall': 0.9209302, 'binary_specificity': 0.6744186, 'binary_f1_score': 0.8198757}
confusion matrix:
     0    1
0  145   70
1   17  198
early stop counter: 2
val acc:0.8159937858581543, best validation acc: 0.8586956262588501, corresponding to test acc:                         0.8395348787307739 / 0.8395348787307739
after epoch: 11,now: 2024-07-27 14:13:48.742882,epoch time: 0:02:01.609818,used: 0:22:18.838461,model: dset_te_center0_dann_b8efecac6_not_commited_2024md_07md_27_13_51_29_seed_0_23099036
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9625651, 'precision': 0.96273255, 'recall': 0.9627406, 'specificity': 0.9627406, 'f1': 0.9625651, 'auroc': 0.9944054, 'binary_precision': 0.9755937, 'binary_recall': 0.94990367, 'binary_specificity': 0.97557753, 'binary_f1_score': 0.96257734}
confusion matrix:
      0     1
0  1478    37
1    78  1479
---- Validation: 
scalar performance:
{'acc': 0.5714286, 'precision': 0.7023344, 'recall': 0.5769447, 'specificity': 0.5769447, 'f1': 0.49609762, 'auroc': 0.7847078, 'binary_precision': 0.5360556, 'binary_recall': 0.9716535, 'binary_specificity': 0.18223584, 'binary_f1_score': 0.6909294}
confusion matrix:
     0    1
0  119  534
1   18  617
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.52790695, 'precision': 0.65731704, 'recall': 0.527907, 'specificity': 0.527907, 'f1': 0.4056851, 'auroc': 0.7803353, 'binary_precision': 0.51463413, 'binary_recall': 0.98139536, 'binary_specificity': 0.074418604, 'binary_f1_score': 0.6752}
confusion matrix:
    0    1
0  16  199
1   4  211
early stop counter: 3
val acc:0.5714285969734192, best validation acc: 0.8586956262588501, corresponding to test acc:                         0.8395348787307739 / 0.8395348787307739
after epoch: 12,now: 2024-07-27 14:15:49.895482,epoch time: 0:02:01.152600,used: 0:24:19.991061,model: dset_te_center0_dann_b8efecac6_not_commited_2024md_07md_27_13_51_29_seed_0_23099036
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.97526044, 'precision': 0.9753871, 'recall': 0.97540164, 'specificity': 0.97540164, 'f1': 0.9752604, 'auroc': 0.99451613, 'binary_precision': 0.98683345, 'binary_recall': 0.9639871, 'binary_specificity': 0.9868161, 'binary_f1_score': 0.97527647}
confusion matrix:
      0     1
0  1497    20
1    56  1499
---- Validation: 
scalar performance:
{'acc': 0.81909937, 'precision': 0.8191228, 'recall': 0.8189881, 'specificity': 0.8189881, 'f1': 0.81903124, 'auroc': 0.88326323, 'binary_precision': 0.8200637, 'binary_recall': 0.8110236, 'binary_specificity': 0.8269525, 'binary_f1_score': 0.8155186}
confusion matrix:
     0    1
0  540  113
1  120  515
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7813954, 'precision': 0.78777015, 'recall': 0.7813954, 'specificity': 0.7813954, 'f1': 0.78017795, 'auroc': 0.84508383, 'binary_precision': 0.8306011, 'binary_recall': 0.7069768, 'binary_specificity': 0.855814, 'binary_f1_score': 0.7638191}
confusion matrix:
     0    1
0  184   31
1   63  152
early stop counter: 4
val acc:0.8190993666648865, best validation acc: 0.8586956262588501, corresponding to test acc:                         0.8395348787307739 / 0.8395348787307739
after epoch: 13,now: 2024-07-27 14:17:50.763392,epoch time: 0:02:00.867910,used: 0:26:20.858971,model: dset_te_center0_dann_b8efecac6_not_commited_2024md_07md_27_13_51_29_seed_0_23099036
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9788411, 'precision': 0.97894406, 'recall': 0.97896415, 'specificity': 0.97896415, 'f1': 0.9788411, 'auroc': 0.99734014, 'binary_precision': 0.9894806, 'binary_recall': 0.9684685, 'binary_specificity': 0.9894598, 'binary_f1_score': 0.9788618}
confusion matrix:
      0     1
0  1502    16
1    49  1505
---- Validation: 
scalar performance:
{'acc': 0.7864907, 'precision': 0.7864584, 'recall': 0.7865032, 'specificity': 0.7865032, 'f1': 0.7864689, 'auroc': 0.853196, 'binary_precision': 0.78125, 'binary_recall': 0.78740156, 'binary_specificity': 0.7856049, 'binary_f1_score': 0.78431374}
confusion matrix:
     0    1
0  513  140
1  135  500
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.83488375, 'precision': 0.8354716, 'recall': 0.8348837, 'specificity': 0.8348837, 'f1': 0.83481133, 'auroc': 0.88945377, 'binary_precision': 0.8214286, 'binary_recall': 0.855814, 'binary_specificity': 0.81395346, 'binary_f1_score': 0.8382688}
confusion matrix:
     0    1
0  175   40
1   31  184
early stop counter: 5
val acc:0.7864906787872314, best validation acc: 0.8586956262588501, corresponding to test acc:                         0.8395348787307739 / 0.8395348787307739
after epoch: 14,now: 2024-07-27 14:19:50.600336,epoch time: 0:01:59.836944,used: 0:28:20.695915,model: dset_te_center0_dann_b8efecac6_not_commited_2024md_07md_27_13_51_29_seed_0_23099036
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 14 with time: 0:28:20.695915 at 2024-07-27 14:19:50.600336
persisted model performance metric: 

scalar performance:
{'acc': 0.8395349, 'precision': 0.8441886, 'recall': 0.8395349, 'specificity': 0.8395349, 'f1': 0.8389907, 'auroc': 0.9022931, 'binary_precision': 0.8842105, 'binary_recall': 0.7813954, 'binary_specificity': 0.89767444, 'binary_f1_score': 0.82962966}
confusion matrix:
     0    1
0  193   22
1   47  168
oracle model performance metric: 

scalar performance:
{'acc': 0.8395349, 'precision': 0.8441886, 'recall': 0.8395349, 'specificity': 0.8395349, 'f1': 0.8389907, 'auroc': 0.9022931, 'binary_precision': 0.8842105, 'binary_recall': 0.7813954, 'binary_specificity': 0.89767444, 'binary_f1_score': 0.82962966}
confusion matrix:
     0    1
0  193   22
1   47  168
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_10seeds_nofreeze_2024-07-27_13-09-31/rule_results/1.csv
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_10seeds_nofreeze_2024-07-27_13-09-31/rule_results/1.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_10seeds_nofreeze_2024-07-27_13-09-31/confusion_matrix/1.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 455608 KiB |   3602 MiB |  50307 GiB |  50307 GiB |
|       from large pool | 415006 KiB |   3568 MiB |  49735 GiB |  49734 GiB |
|       from small pool |  40602 KiB |     56 MiB |    572 GiB |    572 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 455608 KiB |   3602 MiB |  50307 GiB |  50307 GiB |
|       from large pool | 415006 KiB |   3568 MiB |  49735 GiB |  49734 GiB |
|       from small pool |  40602 KiB |     56 MiB |    572 GiB |    572 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 447481 KiB |   3596 MiB |  50092 GiB |  50092 GiB |
|       from large pool | 407075 KiB |   3563 MiB |  49521 GiB |  49520 GiB |
|       from small pool |  40406 KiB |     56 MiB |    571 GiB |    571 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   4016 MiB |   4016 MiB |   4016 MiB |      0 B   |
|       from large pool |   3952 MiB |   3952 MiB |   3952 MiB |      0 B   |
|       from small pool |     64 MiB |     64 MiB |     64 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory | 349255 KiB | 496525 KiB |  35168 GiB |  35167 GiB |
|       from large pool | 342754 KiB | 492852 KiB |  34583 GiB |  34583 GiB |
|       from small pool |   6501 KiB |  14115 KiB |    584 GiB |    584 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    1318    |    1697    |    8793 K  |    8792 K  |
|       from large pool |     187    |     468    |    4584 K  |    4584 K  |
|       from small pool |    1131    |    1435    |    4208 K  |    4207 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    1318    |    1697    |    8793 K  |    8792 K  |
|       from large pool |     187    |     468    |    4584 K  |    4584 K  |
|       from small pool |    1131    |    1435    |    4208 K  |    4207 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     198    |     198    |     198    |       0    |
|       from large pool |     166    |     166    |     166    |       0    |
|       from small pool |      32    |      32    |      32    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      82    |     249    |    5157 K  |    5157 K  |
|       from large pool |      31    |     165    |    3093 K  |    3093 K  |
|       from small pool |      51    |     218    |    2064 K  |    2064 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   3602 MiB |  50307 GiB |  50307 GiB |
|       from large pool |  16640 KiB |   3568 MiB |  49735 GiB |  49735 GiB |
|       from small pool |      0 KiB |     56 MiB |    572 GiB |    572 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   3602 MiB |  50307 GiB |  50307 GiB |
|       from large pool |  16640 KiB |   3568 MiB |  49735 GiB |  49735 GiB |
|       from small pool |      0 KiB |     56 MiB |    572 GiB |    572 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   3596 MiB |  50092 GiB |  50092 GiB |
|       from large pool |  16640 KiB |   3563 MiB |  49521 GiB |  49521 GiB |
|       from small pool |      0 KiB |     56 MiB |    571 GiB |    571 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    786 MiB |   4016 MiB |   4016 MiB |   3230 MiB |
|       from large pool |    740 MiB |   3952 MiB |   3952 MiB |   3212 MiB |
|       from small pool |     46 MiB |     64 MiB |     64 MiB |     18 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 496525 KiB |  35168 GiB |  35168 GiB |
|       from large pool |  24320 KiB | 492852 KiB |  34584 GiB |  34584 GiB |
|       from small pool |      0 KiB |  22317 KiB |    584 GiB |    584 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    1697    |    8793 K  |    8793 K  |
|       from large pool |       2    |     468    |    4584 K  |    4584 K  |
|       from small pool |       0    |    1435    |    4208 K  |    4208 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    1697    |    8793 K  |    8793 K  |
|       from large pool |       2    |     468    |    4584 K  |    4584 K  |
|       from small pool |       0    |    1435    |    4208 K  |    4208 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      57    |     198    |     198    |     141    |
|       from large pool |      34    |     166    |     166    |     132    |
|       from small pool |      23    |      32    |      32    |       9    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     249    |    5157 K  |    5157 K  |
|       from large pool |       3    |     165    |    3093 K  |    3093 K  |
|       from small pool |       0    |     218    |    2064 K  |    2064 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   3602 MiB |  50307 GiB |  50307 GiB |
|       from large pool |  16640 KiB |   3568 MiB |  49735 GiB |  49735 GiB |
|       from small pool |      0 KiB |     56 MiB |    572 GiB |    572 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   3602 MiB |  50307 GiB |  50307 GiB |
|       from large pool |  16640 KiB |   3568 MiB |  49735 GiB |  49735 GiB |
|       from small pool |      0 KiB |     56 MiB |    572 GiB |    572 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   3596 MiB |  50092 GiB |  50092 GiB |
|       from large pool |  16640 KiB |   3563 MiB |  49521 GiB |  49521 GiB |
|       from small pool |      0 KiB |     56 MiB |    571 GiB |    571 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    786 MiB |   4016 MiB |   4016 MiB |   3230 MiB |
|       from large pool |    740 MiB |   3952 MiB |   3952 MiB |   3212 MiB |
|       from small pool |     46 MiB |     64 MiB |     64 MiB |     18 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 496525 KiB |  35168 GiB |  35168 GiB |
|       from large pool |  24320 KiB | 492852 KiB |  34584 GiB |  34584 GiB |
|       from small pool |      0 KiB |  22317 KiB |    584 GiB |    584 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    1697    |    8793 K  |    8793 K  |
|       from large pool |       2    |     468    |    4584 K  |    4584 K  |
|       from small pool |       0    |    1435    |    4208 K  |    4208 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    1697    |    8793 K  |    8793 K  |
|       from large pool |       2    |     468    |    4584 K  |    4584 K  |
|       from small pool |       0    |    1435    |    4208 K  |    4208 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      57    |     198    |     198    |     141    |
|       from large pool |      34    |     166    |     166    |     132    |
|       from small pool |      23    |      32    |      32    |       9    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     249    |    5157 K  |    5157 K  |
|       from large pool |       3    |     165    |    3093 K  |    3093 K  |
|       from small pool |       0    |     218    |    2064 K  |    2064 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center0_dann_b8efecac6_not_commited_2024md_07md_27_14_20_22_seed_1_23099036

 Experiment start at: 2024-07-27 14:20:22.181111
before training, model accuracy: 0.5911111235618591
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.5061849, 'precision': 0.25309244, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.3360709, 'auroc': 0.5, 'binary_precision': 0.5061849, 'binary_recall': 1.0, 'binary_specificity': 0.0, 'binary_f1_score': 0.6721418}
confusion matrix:
   0     1
0  0  1517
1  0  1555
---- Validation: 
scalar performance:
{'acc': 0.4918033, 'precision': 0.24590164, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.32967034, 'auroc': 0.5, 'binary_precision': 0.4918033, 'binary_recall': 1.0, 'binary_specificity': 0.0, 'binary_f1_score': 0.6593407}
confusion matrix:
   0    1
0  0  651
1  0  630
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5, 'precision': 0.25, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.33333334, 'auroc': 0.5, 'binary_precision': 0.5, 'binary_recall': 1.0, 'binary_specificity': 0.0, 'binary_f1_score': 0.6666667}
confusion matrix:
   0    1
0  0  225
1  0  225
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-27 14:22:26.084474,epoch time: 0:02:03.903363,used: 0:02:03.903363,model: dset_te_center0_dann_b8efecac6_not_commited_2024md_07md_27_14_20_22_seed_1_23099036
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.5055339, 'precision': 0.25276694, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.33578378, 'auroc': 0.5, 'binary_precision': 0.5055339, 'binary_recall': 1.0, 'binary_specificity': 0.0, 'binary_f1_score': 0.67156756}
confusion matrix:
   0     1
0  0  1519
1  0  1553
---- Validation: 
scalar performance:
{'acc': 0.4918033, 'precision': 0.24590164, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.32967034, 'auroc': 0.5, 'binary_precision': 0.4918033, 'binary_recall': 1.0, 'binary_specificity': 0.0, 'binary_f1_score': 0.6593407}
confusion matrix:
   0    1
0  0  651
1  0  630
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5, 'precision': 0.25, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.33333334, 'auroc': 0.5, 'binary_precision': 0.5, 'binary_recall': 1.0, 'binary_specificity': 0.0, 'binary_f1_score': 0.6666667}
confusion matrix:
   0    1
0  0  225
1  0  225
early stop counter: 1
val acc:0.49180328845977783, best validation acc: 0.49180328845977783, corresponding to test acc:                         0.5 / 0.5
after epoch: 2,now: 2024-07-27 14:24:26.637646,epoch time: 0:02:00.553172,used: 0:04:04.456535,model: dset_te_center0_dann_b8efecac6_not_commited_2024md_07md_27_14_20_22_seed_1_23099036
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.50716144, 'precision': 0.25358072, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.3365011, 'auroc': 0.5, 'binary_precision': 0.50716144, 'binary_recall': 1.0, 'binary_specificity': 0.0, 'binary_f1_score': 0.6730022}
confusion matrix:
   0     1
0  0  1514
1  0  1558
---- Validation: 
scalar performance:
{'acc': 0.4918033, 'precision': 0.24590164, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.32967034, 'auroc': 0.5, 'binary_precision': 0.4918033, 'binary_recall': 1.0, 'binary_specificity': 0.0, 'binary_f1_score': 0.6593407}
confusion matrix:
   0    1
0  0  651
1  0  630
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5, 'precision': 0.25, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.33333334, 'auroc': 0.5, 'binary_precision': 0.5, 'binary_recall': 1.0, 'binary_specificity': 0.0, 'binary_f1_score': 0.6666667}
confusion matrix:
   0    1
0  0  225
1  0  225
early stop counter: 2
val acc:0.49180328845977783, best validation acc: 0.49180328845977783, corresponding to test acc:                         0.5 / 0.5
after epoch: 3,now: 2024-07-27 14:26:27.875364,epoch time: 0:02:01.237718,used: 0:06:05.694253,model: dset_te_center0_dann_b8efecac6_not_commited_2024md_07md_27_14_20_22_seed_1_23099036
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.5061849, 'precision': 0.25309244, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.3360709, 'auroc': 0.5, 'binary_precision': 0.5061849, 'binary_recall': 1.0, 'binary_specificity': 0.0, 'binary_f1_score': 0.6721418}
confusion matrix:
   0     1
0  0  1517
1  0  1555
---- Validation: 
scalar performance:
{'acc': 0.4918033, 'precision': 0.24590164, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.32967034, 'auroc': 0.5, 'binary_precision': 0.4918033, 'binary_recall': 1.0, 'binary_specificity': 0.0, 'binary_f1_score': 0.6593407}
confusion matrix:
   0    1
0  0  651
1  0  630
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5, 'precision': 0.25, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.33333334, 'auroc': 0.5, 'binary_precision': 0.5, 'binary_recall': 1.0, 'binary_specificity': 0.0, 'binary_f1_score': 0.6666667}
confusion matrix:
   0    1
0  0  225
1  0  225
early stop counter: 3
val acc:0.49180328845977783, best validation acc: 0.49180328845977783, corresponding to test acc:                         0.5 / 0.5
after epoch: 4,now: 2024-07-27 14:28:27.868817,epoch time: 0:01:59.993453,used: 0:08:05.687706,model: dset_te_center0_dann_b8efecac6_not_commited_2024md_07md_27_14_20_22_seed_1_23099036
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.50683594, 'precision': 0.25341797, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.33635774, 'auroc': 0.5, 'binary_precision': 0.50683594, 'binary_recall': 1.0, 'binary_specificity': 0.0, 'binary_f1_score': 0.6727155}
confusion matrix:
   0     1
0  0  1515
1  0  1557
---- Validation: 
scalar performance:
{'acc': 0.4918033, 'precision': 0.24590164, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.32967034, 'auroc': 0.5, 'binary_precision': 0.4918033, 'binary_recall': 1.0, 'binary_specificity': 0.0, 'binary_f1_score': 0.6593407}
confusion matrix:
   0    1
0  0  651
1  0  630
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5, 'precision': 0.25, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.33333334, 'auroc': 0.5, 'binary_precision': 0.5, 'binary_recall': 1.0, 'binary_specificity': 0.0, 'binary_f1_score': 0.6666667}
confusion matrix:
   0    1
0  0  225
1  0  225
early stop counter: 4
val acc:0.49180328845977783, best validation acc: 0.49180328845977783, corresponding to test acc:                         0.5 / 0.5
after epoch: 5,now: 2024-07-27 14:30:28.645689,epoch time: 0:02:00.776872,used: 0:10:06.464578,model: dset_te_center0_dann_b8efecac6_not_commited_2024md_07md_27_14_20_22_seed_1_23099036
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.50683594, 'precision': 0.25341797, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.33635774, 'auroc': 0.5, 'binary_precision': 0.50683594, 'binary_recall': 1.0, 'binary_specificity': 0.0, 'binary_f1_score': 0.6727155}
confusion matrix:
   0     1
0  0  1515
1  0  1557
---- Validation: 
scalar performance:
{'acc': 0.4918033, 'precision': 0.24590164, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.32967034, 'auroc': 0.5, 'binary_precision': 0.4918033, 'binary_recall': 1.0, 'binary_specificity': 0.0, 'binary_f1_score': 0.6593407}
confusion matrix:
   0    1
0  0  651
1  0  630
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5, 'precision': 0.25, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.33333334, 'auroc': 0.5, 'binary_precision': 0.5, 'binary_recall': 1.0, 'binary_specificity': 0.0, 'binary_f1_score': 0.6666667}
confusion matrix:
   0    1
0  0  225
1  0  225
early stop counter: 5
val acc:0.49180328845977783, best validation acc: 0.49180328845977783, corresponding to test acc:                         0.5 / 0.5
after epoch: 6,now: 2024-07-27 14:32:29.280513,epoch time: 0:02:00.634824,used: 0:12:07.099402,model: dset_te_center0_dann_b8efecac6_not_commited_2024md_07md_27_14_20_22_seed_1_23099036
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 6 with time: 0:12:07.099402 at 2024-07-27 14:32:29.280513
persisted model performance metric: 

scalar performance:
{'acc': 0.5, 'precision': 0.25, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.33333334, 'auroc': 0.5, 'binary_precision': 0.5, 'binary_recall': 1.0, 'binary_specificity': 0.0, 'binary_f1_score': 0.6666667}
confusion matrix:
   0    1
0  0  225
1  0  225
oracle model performance metric: 

scalar performance:
{'acc': 0.5, 'precision': 0.25, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.33333334, 'auroc': 0.5, 'binary_precision': 0.5, 'binary_recall': 1.0, 'binary_specificity': 0.0, 'binary_f1_score': 0.6666667}
confusion matrix:
   0    1
0  0  225
1  0  225
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_10seeds_nofreeze_2024-07-27_13-09-31/rule_results/1.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_10seeds_nofreeze_2024-07-27_13-09-31/confusion_matrix/1.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 453952 KiB |   3602 MiB |  71951 GiB |  71951 GiB |
|       from large pool | 413343 KiB |   3568 MiB |  71129 GiB |  71128 GiB |
|       from small pool |  40608 KiB |     60 MiB |    822 GiB |    822 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 453952 KiB |   3602 MiB |  71951 GiB |  71951 GiB |
|       from large pool | 413343 KiB |   3568 MiB |  71129 GiB |  71128 GiB |
|       from small pool |  40608 KiB |     60 MiB |    822 GiB |    822 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 447482 KiB |   3596 MiB |  71696 GiB |  71696 GiB |
|       from large pool | 407075 KiB |   3563 MiB |  70875 GiB |  70874 GiB |
|       from small pool |  40407 KiB |     60 MiB |    821 GiB |    821 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   4008 MiB |   4016 MiB |   7238 MiB |   3230 MiB |
|       from large pool |   3940 MiB |   3952 MiB |   7152 MiB |   3212 MiB |
|       from small pool |     68 MiB |     68 MiB |     86 MiB |     18 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 350912 KiB | 496525 KiB |  50304 GiB |  50304 GiB |
|       from large pool | 342368 KiB | 492852 KiB |  49464 GiB |  49463 GiB |
|       from small pool |   8543 KiB |  22317 KiB |    840 GiB |    840 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    1330    |    1709    |   12598 K  |   12597 K  |
|       from large pool |     187    |     468    |    6562 K  |    6562 K  |
|       from small pool |    1143    |    1447    |    6036 K  |    6035 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    1330    |    1709    |   12598 K  |   12597 K  |
|       from large pool |     187    |     468    |    6562 K  |    6562 K  |
|       from small pool |    1143    |    1447    |    6036 K  |    6035 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     200    |     200    |     341    |     141    |
|       from large pool |     166    |     166    |     298    |     132    |
|       from small pool |      34    |      34    |      43    |       9    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      88    |     254    |    7310 K  |    7310 K  |
|       from large pool |      35    |     165    |    4374 K  |    4374 K  |
|       from small pool |      53    |     219    |    2935 K  |    2935 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   3602 MiB |  71951 GiB |  71951 GiB |
|       from large pool |  16640 KiB |   3568 MiB |  71129 GiB |  71129 GiB |
|       from small pool |      0 KiB |     60 MiB |    822 GiB |    822 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   3602 MiB |  71951 GiB |  71951 GiB |
|       from large pool |  16640 KiB |   3568 MiB |  71129 GiB |  71129 GiB |
|       from small pool |      0 KiB |     60 MiB |    822 GiB |    822 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   3596 MiB |  71696 GiB |  71696 GiB |
|       from large pool |  16640 KiB |   3563 MiB |  70875 GiB |  70875 GiB |
|       from small pool |      0 KiB |     60 MiB |    821 GiB |    821 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    786 MiB |   4016 MiB |   7238 MiB |   6452 MiB |
|       from large pool |    738 MiB |   3952 MiB |   7152 MiB |   6414 MiB |
|       from small pool |     48 MiB |     68 MiB |     86 MiB |     38 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 496525 KiB |  50304 GiB |  50304 GiB |
|       from large pool |  24320 KiB | 492852 KiB |  49464 GiB |  49464 GiB |
|       from small pool |      0 KiB |  32850 KiB |    840 GiB |    840 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    1709    |   12598 K  |   12598 K  |
|       from large pool |       2    |     468    |    6562 K  |    6562 K  |
|       from small pool |       0    |    1447    |    6036 K  |    6036 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    1709    |   12598 K  |   12598 K  |
|       from large pool |       2    |     468    |    6562 K  |    6562 K  |
|       from small pool |       0    |    1447    |    6036 K  |    6036 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      57    |     200    |     341    |     284    |
|       from large pool |      33    |     166    |     298    |     265    |
|       from small pool |      24    |      34    |      43    |      19    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     254    |    7310 K  |    7310 K  |
|       from large pool |       3    |     165    |    4374 K  |    4374 K  |
|       from small pool |       0    |     219    |    2935 K  |    2935 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   3602 MiB |  71951 GiB |  71951 GiB |
|       from large pool |  16640 KiB |   3568 MiB |  71129 GiB |  71129 GiB |
|       from small pool |      0 KiB |     60 MiB |    822 GiB |    822 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   3602 MiB |  71951 GiB |  71951 GiB |
|       from large pool |  16640 KiB |   3568 MiB |  71129 GiB |  71129 GiB |
|       from small pool |      0 KiB |     60 MiB |    822 GiB |    822 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   3596 MiB |  71696 GiB |  71696 GiB |
|       from large pool |  16640 KiB |   3563 MiB |  70875 GiB |  70875 GiB |
|       from small pool |      0 KiB |     60 MiB |    821 GiB |    821 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    786 MiB |   4016 MiB |   7238 MiB |   6452 MiB |
|       from large pool |    738 MiB |   3952 MiB |   7152 MiB |   6414 MiB |
|       from small pool |     48 MiB |     68 MiB |     86 MiB |     38 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 496525 KiB |  50304 GiB |  50304 GiB |
|       from large pool |  24320 KiB | 492852 KiB |  49464 GiB |  49464 GiB |
|       from small pool |      0 KiB |  32850 KiB |    840 GiB |    840 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    1709    |   12598 K  |   12598 K  |
|       from large pool |       2    |     468    |    6562 K  |    6562 K  |
|       from small pool |       0    |    1447    |    6036 K  |    6036 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    1709    |   12598 K  |   12598 K  |
|       from large pool |       2    |     468    |    6562 K  |    6562 K  |
|       from small pool |       0    |    1447    |    6036 K  |    6036 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      57    |     200    |     341    |     284    |
|       from large pool |      33    |     166    |     298    |     265    |
|       from small pool |      24    |      34    |      43    |      19    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     254    |    7310 K  |    7310 K  |
|       from large pool |       3    |     165    |    4374 K  |    4374 K  |
|       from small pool |       0    |     219    |    2935 K  |    2935 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center0_dann_b8efecac6_not_commited_2024md_07md_27_14_33_00_seed_2_23099036

 Experiment start at: 2024-07-27 14:33:00.345197
before training, model accuracy: 0.5254629850387573
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.8193717, 'precision': 0.8369479, 'recall': 0.8184714, 'specificity': 0.8184714, 'f1': 0.81668454, 'auroc': 0.93979454, 'binary_precision': 0.76193, 'binary_recall': 0.9331169, 'binary_specificity': 0.70382583, 'binary_f1_score': 0.83887917}
confusion matrix:
      0     1
0  1067   449
1   103  1437
---- Validation: 
scalar performance:
{'acc': 0.6040689, 'precision': 0.75746715, 'recall': 0.6140793, 'specificity': 0.6140793, 'f1': 0.54513943, 'auroc': 0.8198726, 'binary_precision': 0.5519713, 'binary_recall': 0.9903537, 'binary_specificity': 0.23780487, 'binary_f1_score': 0.70886075}
confusion matrix:
     0    1
0  156  500
1    6  616
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5393519, 'precision': 0.6951738, 'recall': 0.5393518, 'specificity': 0.5393518, 'f1': 0.42448202, 'auroc': 0.8615558, 'binary_precision': 0.5207824, 'binary_recall': 0.9861111, 'binary_specificity': 0.09259259, 'binary_f1_score': 0.68160003}
confusion matrix:
    0    1
0  20  196
1   3  213
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-27 14:35:06.906079,epoch time: 0:02:06.560882,used: 0:02:06.560882,model: dset_te_center0_dann_b8efecac6_not_commited_2024md_07md_27_14_33_00_seed_2_23099036
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.83213353, 'precision': 0.8454673, 'recall': 0.83135986, 'specificity': 0.83135986, 'f1': 0.83026075, 'auroc': 0.9405656, 'binary_precision': 0.77953184, 'binary_recall': 0.9298701, 'binary_specificity': 0.7328496, 'binary_f1_score': 0.84809}
confusion matrix:
      0     1
0  1111   405
1   108  1432
---- Validation: 
scalar performance:
{'acc': 0.48669797, 'precision': 0.24334899, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.32736844, 'auroc': 0.81495816, 'binary_precision': 0.48669797, 'binary_recall': 1.0, 'binary_specificity': 0.0, 'binary_f1_score': 0.6547369}
confusion matrix:
   0    1
0  0  656
1  0  622
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5, 'precision': 0.25, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.33333334, 'auroc': 0.90293854, 'binary_precision': 0.5, 'binary_recall': 1.0, 'binary_specificity': 0.0, 'binary_f1_score': 0.6666667}
confusion matrix:
   0    1
0  0  216
1  0  216
early stop counter: 1
val acc:0.4866979718208313, best validation acc: 0.6040688753128052, corresponding to test acc:                         0.5393518805503845 / 0.5393518805503845
after epoch: 2,now: 2024-07-27 14:37:10.147739,epoch time: 0:02:03.241660,used: 0:04:09.802542,model: dset_te_center0_dann_b8efecac6_not_commited_2024md_07md_27_14_33_00_seed_2_23099036
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.82918847, 'precision': 0.8450075, 'recall': 0.8283453, 'specificity': 0.8283453, 'f1': 0.8269444, 'auroc': 0.94785255, 'binary_precision': 0.77306867, 'binary_recall': 0.9357143, 'binary_specificity': 0.72097623, 'binary_f1_score': 0.846651}
confusion matrix:
      0     1
0  1093   423
1    99  1441
---- Validation: 
scalar performance:
{'acc': 0.71048516, 'precision': 0.7774583, 'recall': 0.7168629, 'specificity': 0.7168629, 'f1': 0.69566727, 'auroc': 0.83824795, 'binary_precision': 0.63432837, 'binary_recall': 0.95659167, 'binary_specificity': 0.47713414, 'binary_f1_score': 0.76282054}
confusion matrix:
     0    1
0  313  343
1   27  595
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7453704, 'precision': 0.7866874, 'recall': 0.7453704, 'specificity': 0.7453704, 'f1': 0.73585325, 'auroc': 0.8571459, 'binary_precision': 0.67785233, 'binary_recall': 0.9351852, 'binary_specificity': 0.5555556, 'binary_f1_score': 0.78599215}
confusion matrix:
     0    1
0  120   96
1   14  202
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-07-27 14:39:11.226706,epoch time: 0:02:01.078967,used: 0:06:10.881509,model: dset_te_center0_dann_b8efecac6_not_commited_2024md_07md_27_14_33_00_seed_2_23099036
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.85634816, 'precision': 0.88557816, 'recall': 0.85743153, 'specificity': 0.85743153, 'f1': 0.8538314, 'auroc': 0.8590181, 'binary_precision': 0.99372196, 'binary_recall': 0.7194805, 'binary_specificity': 0.9953826, 'binary_f1_score': 0.83465165}
confusion matrix:
      0     1
0  1509     7
1   432  1108
---- Validation: 
scalar performance:
{'acc': 0.7308294, 'precision': 0.7495796, 'recall': 0.7269724, 'specificity': 0.7269724, 'f1': 0.72335994, 'auroc': 0.72716355, 'binary_precision': 0.8116592, 'binary_recall': 0.5819936, 'binary_specificity': 0.8719512, 'binary_f1_score': 0.67790264}
confusion matrix:
     0    1
0  572   84
1  260  362
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6273148, 'precision': 0.70892686, 'recall': 0.6273148, 'specificity': 0.6273148, 'f1': 0.5869809, 'auroc': 0.63366985, 'binary_precision': 0.83950615, 'binary_recall': 0.3148148, 'binary_specificity': 0.9398148, 'binary_f1_score': 0.45791245}
confusion matrix:
     0   1
0  203  13
1  148  68
better model found
persisted
after epoch: 4,now: 2024-07-27 14:41:10.969883,epoch time: 0:01:59.743177,used: 0:08:10.624686,model: dset_te_center0_dann_b8efecac6_not_commited_2024md_07md_27_14_33_00_seed_2_23099036
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.89659685, 'precision': 0.912408, 'recall': 0.89737177, 'specificity': 0.89737177, 'f1': 0.89572144, 'auroc': 0.89924276, 'binary_precision': 0.9951456, 'binary_recall': 0.7987013, 'binary_specificity': 0.9960422, 'binary_f1_score': 0.88616717}
confusion matrix:
      0     1
0  1510     6
1   310  1230
---- Validation: 
scalar performance:
{'acc': 0.63928014, 'precision': 0.67700976, 'recall': 0.6327126, 'specificity': 0.6327126, 'f1': 0.6123234, 'auroc': 0.6372503, 'binary_precision': 0.7523511, 'binary_recall': 0.3858521, 'binary_specificity': 0.87957317, 'binary_f1_score': 0.51009566}
confusion matrix:
     0    1
0  577   79
1  382  240
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6087963, 'precision': 0.70756495, 'recall': 0.6087963, 'specificity': 0.6087963, 'f1': 0.5559745, 'auroc': 0.61908436, 'binary_precision': 0.8507463, 'binary_recall': 0.2638889, 'binary_specificity': 0.9537037, 'binary_f1_score': 0.40282685}
confusion matrix:
     0   1
0  206  10
1  159  57
early stop counter: 1
val acc:0.6392801403999329, best validation acc: 0.7308294177055359, corresponding to test acc:                         0.6273148059844971 / 0.7453703880310059
after epoch: 5,now: 2024-07-27 14:43:10.931339,epoch time: 0:01:59.961456,used: 0:10:10.586142,model: dset_te_center0_dann_b8efecac6_not_commited_2024md_07md_27_14_33_00_seed_2_23099036
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9021597, 'precision': 0.90685844, 'recall': 0.902588, 'specificity': 0.902588, 'f1': 0.9019389, 'auroc': 0.920213, 'binary_precision': 0.95258933, 'binary_recall': 0.84805197, 'binary_specificity': 0.957124, 'binary_f1_score': 0.8972861}
confusion matrix:
      0     1
0  1451    65
1   234  1306
---- Validation: 
scalar performance:
{'acc': 0.5031299, 'precision': 0.31298688, 'recall': 0.4901748, 'specificity': 0.4901748, 'f1': 0.33750653, 'auroc': 0.48938808, 'binary_precision': 0.11764706, 'binary_recall': 0.003215434, 'binary_specificity': 0.97713417, 'binary_f1_score': 0.006259781}
confusion matrix:
     0   1
0  641  15
1  620   2
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.49537036, 'precision': 0.2488372, 'recall': 0.49537036, 'specificity': 0.49537036, 'f1': 0.33126935, 'auroc': 0.49537036, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9907407, 'binary_f1_score': 0.0}
confusion matrix:
     0  1
0  214  2
1  216  0
early stop counter: 2
val acc:0.5031298995018005, best validation acc: 0.7308294177055359, corresponding to test acc:                         0.6273148059844971 / 0.7453703880310059
after epoch: 6,now: 2024-07-27 14:45:11.901895,epoch time: 0:02:00.970556,used: 0:12:11.556698,model: dset_te_center0_dann_b8efecac6_not_commited_2024md_07md_27_14_33_00_seed_2_23099036
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.86551046, 'precision': 0.8930644, 'recall': 0.8665533, 'specificity': 0.8665533, 'f1': 0.8633415, 'auroc': 0.86710954, 'binary_precision': 0.9991158, 'binary_recall': 0.73376626, 'binary_specificity': 0.99934036, 'binary_f1_score': 0.84612507}
confusion matrix:
      0     1
0  1515     1
1   410  1130
---- Validation: 
scalar performance:
{'acc': 0.5070422, 'precision': 0.33846763, 'recall': 0.49398577, 'specificity': 0.49398577, 'f1': 0.3392628, 'auroc': 0.4939686, 'binary_precision': 0.16666667, 'binary_recall': 0.003215434, 'binary_specificity': 0.9847561, 'binary_f1_score': 0.0063091484}
confusion matrix:
     0   1
0  646  10
1  620   2
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.49537036, 'precision': 0.2488372, 'recall': 0.49537036, 'specificity': 0.49537036, 'f1': 0.33126935, 'auroc': 0.49537036, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9907407, 'binary_f1_score': 0.0}
confusion matrix:
     0  1
0  214  2
1  216  0
early stop counter: 3
val acc:0.5070422291755676, best validation acc: 0.7308294177055359, corresponding to test acc:                         0.6273148059844971 / 0.7453703880310059
after epoch: 7,now: 2024-07-27 14:47:12.833140,epoch time: 0:02:00.931245,used: 0:14:12.487943,model: dset_te_center0_dann_b8efecac6_not_commited_2024md_07md_27_14_33_00_seed_2_23099036
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9100131, 'precision': 0.9220465, 'recall': 0.9106834, 'specificity': 0.9106834, 'f1': 0.9094593, 'auroc': 0.91316, 'binary_precision': 0.9953015, 'binary_recall': 0.82532465, 'binary_specificity': 0.9960422, 'binary_f1_score': 0.9023784}
confusion matrix:
      0     1
0  1510     6
1   269  1271
---- Validation: 
scalar performance:
{'acc': 0.5007825, 'precision': 0.3497481, 'recall': 0.48801318, 'specificity': 0.48801318, 'f1': 0.34052527, 'auroc': 0.4879997, 'binary_precision': 0.1923077, 'binary_recall': 0.008038585, 'binary_specificity': 0.9679878, 'binary_f1_score': 0.015432099}
confusion matrix:
     0   1
0  635  21
1  617   5
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.49074075, 'precision': 0.24766356, 'recall': 0.49074075, 'specificity': 0.49074075, 'f1': 0.32919258, 'auroc': 0.49074075, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9814815, 'binary_f1_score': 0.0}
confusion matrix:
     0  1
0  212  4
1  216  0
early stop counter: 4
val acc:0.5007824897766113, best validation acc: 0.7308294177055359, corresponding to test acc:                         0.6273148059844971 / 0.7453703880310059
after epoch: 8,now: 2024-07-27 14:49:14.103939,epoch time: 0:02:01.270799,used: 0:16:13.758742,model: dset_te_center0_dann_b8efecac6_not_commited_2024md_07md_27_14_33_00_seed_2_23099036
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.87565446, 'precision': 0.89818335, 'recall': 0.8765925, 'specificity': 0.8765925, 'f1': 0.87405866, 'auroc': 0.87807155, 'binary_precision': 0.99488056, 'binary_recall': 0.75714284, 'binary_specificity': 0.9960422, 'binary_f1_score': 0.859882}
confusion matrix:
      0     1
0  1510     6
1   374  1166
---- Validation: 
scalar performance:
{'acc': 0.70735526, 'precision': 0.70971406, 'recall': 0.7056064, 'specificity': 0.7056064, 'f1': 0.70525026, 'auroc': 0.7259431, 'binary_precision': 0.72627735, 'binary_recall': 0.63987136, 'binary_specificity': 0.77134144, 'binary_f1_score': 0.68034184}
confusion matrix:
     0    1
0  506  150
1  224  398
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7384259, 'precision': 0.7845959, 'recall': 0.7384259, 'specificity': 0.7384259, 'f1': 0.7273687, 'auroc': 0.7457348, 'binary_precision': 0.8992248, 'binary_recall': 0.537037, 'binary_specificity': 0.9398148, 'binary_f1_score': 0.6724637}
confusion matrix:
     0    1
0  203   13
1  100  116
early stop counter: 5
val acc:0.707355260848999, best validation acc: 0.7308294177055359, corresponding to test acc:                         0.6273148059844971 / 0.7453703880310059
after epoch: 9,now: 2024-07-27 14:51:16.057116,epoch time: 0:02:01.953177,used: 0:18:15.711919,model: dset_te_center0_dann_b8efecac6_not_commited_2024md_07md_27_14_33_00_seed_2_23099036
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 9 with time: 0:18:15.711919 at 2024-07-27 14:51:16.057116
persisted model performance metric: 

scalar performance:
{'acc': 0.6273148, 'precision': 0.70892686, 'recall': 0.6273148, 'specificity': 0.6273148, 'f1': 0.5869809, 'auroc': 0.63366985, 'binary_precision': 0.83950615, 'binary_recall': 0.3148148, 'binary_specificity': 0.9398148, 'binary_f1_score': 0.45791245}
confusion matrix:
     0   1
0  203  13
1  148  68
oracle model performance metric: 

scalar performance:
{'acc': 0.7453704, 'precision': 0.7866874, 'recall': 0.7453704, 'specificity': 0.7453704, 'f1': 0.73585325, 'auroc': 0.8571459, 'binary_precision': 0.67785233, 'binary_recall': 0.9351852, 'binary_specificity': 0.5555556, 'binary_f1_score': 0.78599215}
confusion matrix:
     0    1
0  120   96
1   14  202
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_10seeds_nofreeze_2024-07-27_13-09-31/rule_results/1.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_10seeds_nofreeze_2024-07-27_13-09-31/confusion_matrix/1.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 454625 KiB |   3602 MiB | 104201 GiB | 104200 GiB |
|       from large pool | 414023 KiB |   3569 MiB | 103010 GiB | 103010 GiB |
|       from small pool |  40602 KiB |     60 MiB |   1190 GiB |   1190 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 454625 KiB |   3602 MiB | 104201 GiB | 104200 GiB |
|       from large pool | 414023 KiB |   3569 MiB | 103010 GiB | 103010 GiB |
|       from small pool |  40602 KiB |     60 MiB |   1190 GiB |   1190 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 447481 KiB |   3596 MiB | 103805 GiB | 103804 GiB |
|       from large pool | 407075 KiB |   3563 MiB | 102616 GiB | 102616 GiB |
|       from small pool |  40406 KiB |     60 MiB |   1188 GiB |   1188 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   4002 MiB |   4016 MiB |  10454 MiB |   6452 MiB |
|       from large pool |   3938 MiB |   3952 MiB |  10352 MiB |   6414 MiB |
|       from small pool |     64 MiB |     68 MiB |    102 MiB |     38 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 391198 KiB | 496525 KiB |  73182 GiB |  73182 GiB |
|       from large pool | 382649 KiB | 492852 KiB |  71964 GiB |  71964 GiB |
|       from small pool |   8549 KiB |  32850 KiB |   1218 GiB |   1218 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    1318    |    1709    |   18236 K  |   18235 K  |
|       from large pool |     187    |     468    |    9500 K  |    9500 K  |
|       from small pool |    1131    |    1447    |    8736 K  |    8734 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    1318    |    1709    |   18236 K  |   18235 K  |
|       from large pool |     187    |     468    |    9500 K  |    9500 K  |
|       from small pool |    1131    |    1447    |    8736 K  |    8734 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     197    |     200    |     481    |     284    |
|       from large pool |     165    |     166    |     430    |     265    |
|       from small pool |      32    |      34    |      51    |      19    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      86    |     254    |   10442 K  |   10442 K  |
|       from large pool |      34    |     165    |    6206 K  |    6206 K  |
|       from small pool |      52    |     219    |    4236 K  |    4236 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   3602 MiB | 104201 GiB | 104201 GiB |
|       from large pool |  16640 KiB |   3569 MiB | 103010 GiB | 103010 GiB |
|       from small pool |      0 KiB |     60 MiB |   1190 GiB |   1190 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   3602 MiB | 104201 GiB | 104201 GiB |
|       from large pool |  16640 KiB |   3569 MiB | 103010 GiB | 103010 GiB |
|       from small pool |      0 KiB |     60 MiB |   1190 GiB |   1190 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   3596 MiB | 103805 GiB | 103805 GiB |
|       from large pool |  16640 KiB |   3563 MiB | 102616 GiB | 102616 GiB |
|       from small pool |      0 KiB |     60 MiB |   1188 GiB |   1188 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    826 MiB |   4016 MiB |  10454 MiB |   9628 MiB |
|       from large pool |    778 MiB |   3952 MiB |  10352 MiB |   9574 MiB |
|       from small pool |     48 MiB |     68 MiB |    102 MiB |     54 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 496525 KiB |  73182 GiB |  73182 GiB |
|       from large pool |  24320 KiB | 492852 KiB |  71964 GiB |  71964 GiB |
|       from small pool |      0 KiB |  32850 KiB |   1218 GiB |   1218 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    1709    |   18236 K  |   18236 K  |
|       from large pool |       2    |     468    |    9500 K  |    9500 K  |
|       from small pool |       0    |    1447    |    8736 K  |    8736 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    1709    |   18236 K  |   18236 K  |
|       from large pool |       2    |     468    |    9500 K  |    9500 K  |
|       from small pool |       0    |    1447    |    8736 K  |    8736 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      59    |     200    |     481    |     422    |
|       from large pool |      35    |     166    |     430    |     395    |
|       from small pool |      24    |      34    |      51    |      27    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     254    |   10442 K  |   10442 K  |
|       from large pool |       3    |     165    |    6206 K  |    6206 K  |
|       from small pool |       0    |     219    |    4236 K  |    4236 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Sat Jul 27 14:51:23 2024]
Finished job 0.
1 of 1 steps (100%) done
