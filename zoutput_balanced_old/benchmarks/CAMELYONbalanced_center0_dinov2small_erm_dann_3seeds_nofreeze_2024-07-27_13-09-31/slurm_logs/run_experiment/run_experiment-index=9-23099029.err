Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Sat Jul 27 13:10:29 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_10seeds_nofreeze_2024-07-27_13-09-31/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_10seeds_nofreeze_2024-07-27_13-09-31/rule_results/9.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=9
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/swiglu_ffn.py:51: UserWarning: xFormers is not available (SwiGLU)
  warnings.warn("xFormers is not available (SwiGLU)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/attention.py:33: UserWarning: xFormers is not available (Attention)
  warnings.warn("xFormers is not available (Attention)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/block.py:40: UserWarning: xFormers is not available (Block)
  warnings.warn("xFormers is not available (Block)")
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center0_dann_b8efecac6_not_commited_2024md_07md_27_13_11_27_seed_0_23099029

 Experiment start at: 2024-07-27 13:11:27.221626
before training, model accuracy: 0.49534884095191956
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.90494794, 'precision': 0.90781665, 'recall': 0.9044421, 'specificity': 0.9044421, 'f1': 0.9046893, 'auroc': 0.91715693, 'binary_precision': 0.8765653, 'binary_recall': 0.9453376, 'binary_specificity': 0.8635465, 'binary_f1_score': 0.9096534}
confusion matrix:
      0     1
0  1310   207
1    85  1470
---- Validation: 
scalar performance:
{'acc': 0.79891306, 'precision': 0.80985963, 'recall': 0.8002086, 'specificity': 0.8002086, 'f1': 0.7975678, 'auroc': 0.8100312, 'binary_precision': 0.7480211, 'binary_recall': 0.8929134, 'binary_specificity': 0.70750386, 'binary_f1_score': 0.8140704}
confusion matrix:
     0    1
0  462  191
1   68  567
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8, 'precision': 0.8067963, 'recall': 0.8, 'specificity': 0.8, 'f1': 0.79888624, 'auroc': 0.8214819, 'binary_precision': 0.7611336, 'binary_recall': 0.8744186, 'binary_specificity': 0.7255814, 'binary_f1_score': 0.81385285}
confusion matrix:
     0    1
0  156   59
1   27  188
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-27 13:13:43.017691,epoch time: 0:02:15.796065,used: 0:02:15.796065,model: dset_te_center0_dann_b8efecac6_not_commited_2024md_07md_27_13_11_27_seed_0_23099029
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.94596356, 'precision': 0.9459958, 'recall': 0.9460646, 'specificity': 0.9460646, 'f1': 0.9459624, 'auroc': 0.96930426, 'binary_precision': 0.95424837, 'binary_recall': 0.93830335, 'binary_specificity': 0.95382583, 'binary_f1_score': 0.9462087}
confusion matrix:
      0     1
0  1446    70
1    96  1460
---- Validation: 
scalar performance:
{'acc': 0.76785713, 'precision': 0.76789856, 'recall': 0.76769245, 'specificity': 0.76769245, 'f1': 0.7677394, 'auroc': 0.7990377, 'binary_precision': 0.7692308, 'binary_recall': 0.7559055, 'binary_specificity': 0.7794793, 'binary_f1_score': 0.76250994}
confusion matrix:
     0    1
0  509  144
1  155  480
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7837209, 'precision': 0.7864538, 'recall': 0.78372097, 'specificity': 0.78372097, 'f1': 0.78320384, 'auroc': 0.82199025, 'binary_precision': 0.7584746, 'binary_recall': 0.83255816, 'binary_specificity': 0.7348837, 'binary_f1_score': 0.7937916}
confusion matrix:
     0    1
0  158   57
1   36  179
early stop counter: 1
val acc:0.7678571343421936, best validation acc: 0.7989130616188049, corresponding to test acc:                         0.800000011920929 / 0.800000011920929
after epoch: 2,now: 2024-07-27 13:15:43.094190,epoch time: 0:02:00.076499,used: 0:04:15.872564,model: dset_te_center0_dann_b8efecac6_not_commited_2024md_07md_27_13_11_27_seed_0_23099029
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.8649089, 'precision': 0.8923755, 'recall': 0.8669019, 'specificity': 0.8669019, 'f1': 0.86293125, 'auroc': 0.98892725, 'binary_precision': 1.0, 'binary_recall': 0.73380375, 'binary_specificity': 1.0, 'binary_f1_score': 0.8464669}
confusion matrix:
      0     1
0  1513     0
1   415  1144
---- Validation: 
scalar performance:
{'acc': 0.70186335, 'precision': 0.76720804, 'recall': 0.69835407, 'specificity': 0.69835407, 'f1': 0.6800927, 'auroc': 0.84141034, 'binary_precision': 0.89589906, 'binary_recall': 0.4472441, 'binary_specificity': 0.949464, 'binary_f1_score': 0.5966386}
confusion matrix:
     0    1
0  620   33
1  351  284
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.69302326, 'precision': 0.8042626, 'recall': 0.69302326, 'specificity': 0.69302326, 'f1': 0.6621429, 'auroc': 0.8928285, 'binary_precision': 0.9882353, 'binary_recall': 0.3906977, 'binary_specificity': 0.9953488, 'binary_f1_score': 0.56}
confusion matrix:
     0   1
0  214   1
1  131  84
early stop counter: 2
val acc:0.7018633484840393, best validation acc: 0.7989130616188049, corresponding to test acc:                         0.800000011920929 / 0.800000011920929
after epoch: 3,now: 2024-07-27 13:17:43.383454,epoch time: 0:02:00.289264,used: 0:06:16.161828,model: dset_te_center0_dann_b8efecac6_not_commited_2024md_07md_27_13_11_27_seed_0_23099029
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9472656, 'precision': 0.94999385, 'recall': 0.9478611, 'specificity': 0.9478611, 'f1': 0.9472243, 'auroc': 0.99113005, 'binary_precision': 0.9887955, 'binary_recall': 0.9062901, 'binary_specificity': 0.989432, 'binary_f1_score': 0.9457469}
confusion matrix:
      0     1
0  1498    16
1   146  1412
---- Validation: 
scalar performance:
{'acc': 0.6622671, 'precision': 0.66258943, 'recall': 0.6624941, 'specificity': 0.6624941, 'f1': 0.66225064, 'auroc': 0.69124573, 'binary_precision': 0.6510574, 'binary_recall': 0.67874014, 'binary_specificity': 0.6462481, 'binary_f1_score': 0.6646107}
confusion matrix:
     0    1
0  422  231
1  204  431
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7627907, 'precision': 0.77321696, 'recall': 0.7627907, 'specificity': 0.7627907, 'f1': 0.7605058, 'auroc': 0.73210925, 'binary_precision': 0.71984434, 'binary_recall': 0.8604651, 'binary_specificity': 0.66511625, 'binary_f1_score': 0.7838983}
confusion matrix:
     0    1
0  143   72
1   30  185
early stop counter: 3
val acc:0.6622670888900757, best validation acc: 0.7989130616188049, corresponding to test acc:                         0.800000011920929 / 0.800000011920929
after epoch: 4,now: 2024-07-27 13:19:43.513926,epoch time: 0:02:00.130472,used: 0:08:16.292300,model: dset_te_center0_dann_b8efecac6_not_commited_2024md_07md_27_13_11_27_seed_0_23099029
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.93066406, 'precision': 0.9370469, 'recall': 0.9315191, 'specificity': 0.9315191, 'f1': 0.9304917, 'auroc': 0.9857708, 'binary_precision': 0.99339205, 'binary_recall': 0.8689788, 'binary_specificity': 0.9940594, 'binary_f1_score': 0.9270298}
confusion matrix:
      0     1
0  1506     9
1   204  1353
---- Validation: 
scalar performance:
{'acc': 0.66925466, 'precision': 0.670775, 'recall': 0.6698195, 'specificity': 0.6698195, 'f1': 0.66893536, 'auroc': 0.6908345, 'binary_precision': 0.6507937, 'binary_recall': 0.7102362, 'binary_specificity': 0.62940276, 'binary_f1_score': 0.67921686}
confusion matrix:
     0    1
0  411  242
1  184  451
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.74418604, 'precision': 0.748399, 'recall': 0.74418604, 'specificity': 0.74418604, 'f1': 0.7430967, 'auroc': 0.7930124, 'binary_precision': 0.7160494, 'binary_recall': 0.80930233, 'binary_specificity': 0.67906976, 'binary_f1_score': 0.7598253}
confusion matrix:
     0    1
0  146   69
1   41  174
early stop counter: 4
val acc:0.6692546606063843, best validation acc: 0.7989130616188049, corresponding to test acc:                         0.800000011920929 / 0.800000011920929
after epoch: 5,now: 2024-07-27 13:21:43.452074,epoch time: 0:01:59.938148,used: 0:10:16.230448,model: dset_te_center0_dann_b8efecac6_not_commited_2024md_07md_27_13_11_27_seed_0_23099029
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.88639325, 'precision': 0.90623844, 'recall': 0.8877733, 'specificity': 0.8877733, 'f1': 0.8852321, 'auroc': 0.97066504, 'binary_precision': 0.9991722, 'binary_recall': 0.7762058, 'binary_specificity': 0.99934083, 'binary_f1_score': 0.87368804}
confusion matrix:
      0     1
0  1516     1
1   348  1207
---- Validation: 
scalar performance:
{'acc': 0.57686335, 'precision': 0.6820109, 'recall': 0.57143044, 'specificity': 0.57143044, 'f1': 0.49781907, 'auroc': 0.82193387, 'binary_precision': 0.8169014, 'binary_recall': 0.18267716, 'binary_specificity': 0.96018374, 'binary_f1_score': 0.2985843}
confusion matrix:
     0    1
0  627   26
1  519  116
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5883721, 'precision': 0.684009, 'recall': 0.5883721, 'specificity': 0.5883721, 'f1': 0.52689976, 'auroc': 0.8371444, 'binary_precision': 0.81666666, 'binary_recall': 0.22790697, 'binary_specificity': 0.9488372, 'binary_f1_score': 0.35636362}
confusion matrix:
     0   1
0  204  11
1  166  49
early stop counter: 5
val acc:0.5768633484840393, best validation acc: 0.7989130616188049, corresponding to test acc:                         0.800000011920929 / 0.800000011920929
after epoch: 6,now: 2024-07-27 13:23:43.401649,epoch time: 0:01:59.949575,used: 0:12:16.180023,model: dset_te_center0_dann_b8efecac6_not_commited_2024md_07md_27_13_11_27_seed_0_23099029
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 6 with time: 0:12:16.180023 at 2024-07-27 13:23:43.401649
persisted model performance metric: 

scalar performance:
{'acc': 0.8, 'precision': 0.8067963, 'recall': 0.8, 'specificity': 0.8, 'f1': 0.79888624, 'auroc': 0.8214819, 'binary_precision': 0.7611336, 'binary_recall': 0.8744186, 'binary_specificity': 0.7255814, 'binary_f1_score': 0.81385285}
confusion matrix:
     0    1
0  156   59
1   27  188
oracle model performance metric: 

scalar performance:
{'acc': 0.8, 'precision': 0.8067963, 'recall': 0.8, 'specificity': 0.8, 'f1': 0.79888624, 'auroc': 0.8214819, 'binary_precision': 0.7611336, 'binary_recall': 0.8744186, 'binary_specificity': 0.7255814, 'binary_f1_score': 0.81385285}
confusion matrix:
     0    1
0  156   59
1   27  188
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_10seeds_nofreeze_2024-07-27_13-09-31/rule_results/9.csv
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_10seeds_nofreeze_2024-07-27_13-09-31/rule_results/9.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_10seeds_nofreeze_2024-07-27_13-09-31/confusion_matrix/9.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 455608 KiB |   3602 MiB |  21674 GiB |  21674 GiB |
|       from large pool | 415006 KiB |   3568 MiB |  21427 GiB |  21426 GiB |
|       from small pool |  40602 KiB |     56 MiB |    247 GiB |    247 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 455608 KiB |   3602 MiB |  21674 GiB |  21674 GiB |
|       from large pool | 415006 KiB |   3568 MiB |  21427 GiB |  21426 GiB |
|       from small pool |  40602 KiB |     56 MiB |    247 GiB |    247 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 447481 KiB |   3596 MiB |  21582 GiB |  21582 GiB |
|       from large pool | 407075 KiB |   3563 MiB |  21335 GiB |  21334 GiB |
|       from small pool |  40406 KiB |     56 MiB |    247 GiB |    247 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   4016 MiB |   4016 MiB |   4016 MiB |      0 B   |
|       from large pool |   3952 MiB |   3952 MiB |   3952 MiB |      0 B   |
|       from small pool |     64 MiB |     64 MiB |     64 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory | 349255 KiB | 496525 KiB |  15171 GiB |  15171 GiB |
|       from large pool | 342754 KiB | 492852 KiB |  14918 GiB |  14918 GiB |
|       from small pool |   6501 KiB |  14115 KiB |    252 GiB |    252 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    1318    |    1697    |    3794 K  |    3793 K  |
|       from large pool |     187    |     468    |    1976 K  |    1975 K  |
|       from small pool |    1131    |    1435    |    1818 K  |    1817 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    1318    |    1697    |    3794 K  |    3793 K  |
|       from large pool |     187    |     468    |    1976 K  |    1975 K  |
|       from small pool |    1131    |    1435    |    1818 K  |    1817 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     198    |     198    |     198    |       0    |
|       from large pool |     166    |     166    |     166    |       0    |
|       from small pool |      32    |      32    |      32    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      77    |     249    |    2198 K  |    2198 K  |
|       from large pool |      31    |     165    |    1332 K  |    1332 K  |
|       from small pool |      46    |     218    |     865 K  |     865 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   3602 MiB |  21674 GiB |  21674 GiB |
|       from large pool |  16640 KiB |   3568 MiB |  21427 GiB |  21427 GiB |
|       from small pool |      0 KiB |     56 MiB |    247 GiB |    247 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   3602 MiB |  21674 GiB |  21674 GiB |
|       from large pool |  16640 KiB |   3568 MiB |  21427 GiB |  21427 GiB |
|       from small pool |      0 KiB |     56 MiB |    247 GiB |    247 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   3596 MiB |  21582 GiB |  21582 GiB |
|       from large pool |  16640 KiB |   3563 MiB |  21335 GiB |  21335 GiB |
|       from small pool |      0 KiB |     56 MiB |    247 GiB |    247 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    786 MiB |   4016 MiB |   4016 MiB |   3230 MiB |
|       from large pool |    740 MiB |   3952 MiB |   3952 MiB |   3212 MiB |
|       from small pool |     46 MiB |     64 MiB |     64 MiB |     18 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 496525 KiB |  15172 GiB |  15172 GiB |
|       from large pool |  24320 KiB | 492852 KiB |  14919 GiB |  14919 GiB |
|       from small pool |      0 KiB |  20881 KiB |    253 GiB |    253 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    1697    |    3794 K  |    3794 K  |
|       from large pool |       2    |     468    |    1976 K  |    1976 K  |
|       from small pool |       0    |    1435    |    1818 K  |    1818 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    1697    |    3794 K  |    3794 K  |
|       from large pool |       2    |     468    |    1976 K  |    1976 K  |
|       from small pool |       0    |    1435    |    1818 K  |    1818 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      57    |     198    |     198    |     141    |
|       from large pool |      34    |     166    |     166    |     132    |
|       from small pool |      23    |      32    |      32    |       9    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     249    |    2198 K  |    2198 K  |
|       from large pool |       3    |     165    |    1332 K  |    1332 K  |
|       from small pool |       0    |     218    |     865 K  |     865 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   3602 MiB |  21674 GiB |  21674 GiB |
|       from large pool |  16640 KiB |   3568 MiB |  21427 GiB |  21427 GiB |
|       from small pool |      0 KiB |     56 MiB |    247 GiB |    247 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   3602 MiB |  21674 GiB |  21674 GiB |
|       from large pool |  16640 KiB |   3568 MiB |  21427 GiB |  21427 GiB |
|       from small pool |      0 KiB |     56 MiB |    247 GiB |    247 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   3596 MiB |  21582 GiB |  21582 GiB |
|       from large pool |  16640 KiB |   3563 MiB |  21335 GiB |  21335 GiB |
|       from small pool |      0 KiB |     56 MiB |    247 GiB |    247 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    786 MiB |   4016 MiB |   4016 MiB |   3230 MiB |
|       from large pool |    740 MiB |   3952 MiB |   3952 MiB |   3212 MiB |
|       from small pool |     46 MiB |     64 MiB |     64 MiB |     18 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 496525 KiB |  15172 GiB |  15172 GiB |
|       from large pool |  24320 KiB | 492852 KiB |  14919 GiB |  14919 GiB |
|       from small pool |      0 KiB |  20881 KiB |    253 GiB |    253 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    1697    |    3794 K  |    3794 K  |
|       from large pool |       2    |     468    |    1976 K  |    1976 K  |
|       from small pool |       0    |    1435    |    1818 K  |    1818 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    1697    |    3794 K  |    3794 K  |
|       from large pool |       2    |     468    |    1976 K  |    1976 K  |
|       from small pool |       0    |    1435    |    1818 K  |    1818 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      57    |     198    |     198    |     141    |
|       from large pool |      34    |     166    |     166    |     132    |
|       from small pool |      23    |      32    |      32    |       9    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     249    |    2198 K  |    2198 K  |
|       from large pool |       3    |     165    |    1332 K  |    1332 K  |
|       from small pool |       0    |     218    |     865 K  |     865 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center0_dann_b8efecac6_not_commited_2024md_07md_27_13_24_13_seed_1_23099029

 Experiment start at: 2024-07-27 13:24:13.422909
before training, model accuracy: 0.5911111235618591
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.5058594, 'precision': 0.2529297, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.33592737, 'auroc': 0.5, 'binary_precision': 0.5058594, 'binary_recall': 1.0, 'binary_specificity': 0.0, 'binary_f1_score': 0.67185473}
confusion matrix:
   0     1
0  0  1518
1  0  1554
---- Validation: 
scalar performance:
{'acc': 0.4918033, 'precision': 0.24590164, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.32967034, 'auroc': 0.5, 'binary_precision': 0.4918033, 'binary_recall': 1.0, 'binary_specificity': 0.0, 'binary_f1_score': 0.6593407}
confusion matrix:
   0    1
0  0  651
1  0  630
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5, 'precision': 0.25, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.33333334, 'auroc': 0.5, 'binary_precision': 0.5, 'binary_recall': 1.0, 'binary_specificity': 0.0, 'binary_f1_score': 0.6666667}
confusion matrix:
   0    1
0  0  225
1  0  225
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-27 13:26:16.741826,epoch time: 0:02:03.318917,used: 0:02:03.318917,model: dset_te_center0_dann_b8efecac6_not_commited_2024md_07md_27_13_24_13_seed_1_23099029
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.50651044, 'precision': 0.25325522, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.33621433, 'auroc': 0.5, 'binary_precision': 0.50651044, 'binary_recall': 1.0, 'binary_specificity': 0.0, 'binary_f1_score': 0.67242867}
confusion matrix:
   0     1
0  0  1516
1  0  1556
---- Validation: 
scalar performance:
{'acc': 0.4918033, 'precision': 0.24590164, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.32967034, 'auroc': 0.5, 'binary_precision': 0.4918033, 'binary_recall': 1.0, 'binary_specificity': 0.0, 'binary_f1_score': 0.6593407}
confusion matrix:
   0    1
0  0  651
1  0  630
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5, 'precision': 0.25, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.33333334, 'auroc': 0.5, 'binary_precision': 0.5, 'binary_recall': 1.0, 'binary_specificity': 0.0, 'binary_f1_score': 0.6666667}
confusion matrix:
   0    1
0  0  225
1  0  225
early stop counter: 1
val acc:0.49180328845977783, best validation acc: 0.49180328845977783, corresponding to test acc:                         0.5 / 0.5
after epoch: 2,now: 2024-07-27 13:28:16.244080,epoch time: 0:01:59.502254,used: 0:04:02.821171,model: dset_te_center0_dann_b8efecac6_not_commited_2024md_07md_27_13_24_13_seed_1_23099029
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.50651044, 'precision': 0.25325522, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.33621433, 'auroc': 0.5, 'binary_precision': 0.50651044, 'binary_recall': 1.0, 'binary_specificity': 0.0, 'binary_f1_score': 0.67242867}
confusion matrix:
   0     1
0  0  1516
1  0  1556
---- Validation: 
scalar performance:
{'acc': 0.4918033, 'precision': 0.24590164, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.32967034, 'auroc': 0.5, 'binary_precision': 0.4918033, 'binary_recall': 1.0, 'binary_specificity': 0.0, 'binary_f1_score': 0.6593407}
confusion matrix:
   0    1
0  0  651
1  0  630
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5, 'precision': 0.25, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.33333334, 'auroc': 0.5, 'binary_precision': 0.5, 'binary_recall': 1.0, 'binary_specificity': 0.0, 'binary_f1_score': 0.6666667}
confusion matrix:
   0    1
0  0  225
1  0  225
early stop counter: 2
val acc:0.49180328845977783, best validation acc: 0.49180328845977783, corresponding to test acc:                         0.5 / 0.5
after epoch: 3,now: 2024-07-27 13:30:16.316975,epoch time: 0:02:00.072895,used: 0:06:02.894066,model: dset_te_center0_dann_b8efecac6_not_commited_2024md_07md_27_13_24_13_seed_1_23099029
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.50651044, 'precision': 0.25325522, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.33621433, 'auroc': 0.5, 'binary_precision': 0.50651044, 'binary_recall': 1.0, 'binary_specificity': 0.0, 'binary_f1_score': 0.67242867}
confusion matrix:
   0     1
0  0  1516
1  0  1556
---- Validation: 
scalar performance:
{'acc': 0.4918033, 'precision': 0.24590164, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.32967034, 'auroc': 0.5, 'binary_precision': 0.4918033, 'binary_recall': 1.0, 'binary_specificity': 0.0, 'binary_f1_score': 0.6593407}
confusion matrix:
   0    1
0  0  651
1  0  630
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5, 'precision': 0.25, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.33333334, 'auroc': 0.5, 'binary_precision': 0.5, 'binary_recall': 1.0, 'binary_specificity': 0.0, 'binary_f1_score': 0.6666667}
confusion matrix:
   0    1
0  0  225
1  0  225
early stop counter: 3
val acc:0.49180328845977783, best validation acc: 0.49180328845977783, corresponding to test acc:                         0.5 / 0.5
after epoch: 4,now: 2024-07-27 13:32:15.855386,epoch time: 0:01:59.538411,used: 0:08:02.432477,model: dset_te_center0_dann_b8efecac6_not_commited_2024md_07md_27_13_24_13_seed_1_23099029
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.50651044, 'precision': 0.25325522, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.33621433, 'auroc': 0.5, 'binary_precision': 0.50651044, 'binary_recall': 1.0, 'binary_specificity': 0.0, 'binary_f1_score': 0.67242867}
confusion matrix:
   0     1
0  0  1516
1  0  1556
---- Validation: 
scalar performance:
{'acc': 0.4918033, 'precision': 0.24590164, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.32967034, 'auroc': 0.5, 'binary_precision': 0.4918033, 'binary_recall': 1.0, 'binary_specificity': 0.0, 'binary_f1_score': 0.6593407}
confusion matrix:
   0    1
0  0  651
1  0  630
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5, 'precision': 0.25, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.33333334, 'auroc': 0.5, 'binary_precision': 0.5, 'binary_recall': 1.0, 'binary_specificity': 0.0, 'binary_f1_score': 0.6666667}
confusion matrix:
   0    1
0  0  225
1  0  225
early stop counter: 4
val acc:0.49180328845977783, best validation acc: 0.49180328845977783, corresponding to test acc:                         0.5 / 0.5
after epoch: 5,now: 2024-07-27 13:34:15.830798,epoch time: 0:01:59.975412,used: 0:10:02.407889,model: dset_te_center0_dann_b8efecac6_not_commited_2024md_07md_27_13_24_13_seed_1_23099029
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.5061849, 'precision': 0.25309244, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.3360709, 'auroc': 0.5, 'binary_precision': 0.5061849, 'binary_recall': 1.0, 'binary_specificity': 0.0, 'binary_f1_score': 0.6721418}
confusion matrix:
   0     1
0  0  1517
1  0  1555
---- Validation: 
scalar performance:
{'acc': 0.4918033, 'precision': 0.24590164, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.32967034, 'auroc': 0.5, 'binary_precision': 0.4918033, 'binary_recall': 1.0, 'binary_specificity': 0.0, 'binary_f1_score': 0.6593407}
confusion matrix:
   0    1
0  0  651
1  0  630
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5, 'precision': 0.25, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.33333334, 'auroc': 0.5, 'binary_precision': 0.5, 'binary_recall': 1.0, 'binary_specificity': 0.0, 'binary_f1_score': 0.6666667}
confusion matrix:
   0    1
0  0  225
1  0  225
early stop counter: 5
val acc:0.49180328845977783, best validation acc: 0.49180328845977783, corresponding to test acc:                         0.5 / 0.5
after epoch: 6,now: 2024-07-27 13:36:15.598647,epoch time: 0:01:59.767849,used: 0:12:02.175738,model: dset_te_center0_dann_b8efecac6_not_commited_2024md_07md_27_13_24_13_seed_1_23099029
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 6 with time: 0:12:02.175738 at 2024-07-27 13:36:15.598647
persisted model performance metric: 

scalar performance:
{'acc': 0.5, 'precision': 0.25, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.33333334, 'auroc': 0.5, 'binary_precision': 0.5, 'binary_recall': 1.0, 'binary_specificity': 0.0, 'binary_f1_score': 0.6666667}
confusion matrix:
   0    1
0  0  225
1  0  225
oracle model performance metric: 

scalar performance:
{'acc': 0.5, 'precision': 0.25, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.33333334, 'auroc': 0.5, 'binary_precision': 0.5, 'binary_recall': 1.0, 'binary_specificity': 0.0, 'binary_f1_score': 0.6666667}
confusion matrix:
   0    1
0  0  225
1  0  225
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_10seeds_nofreeze_2024-07-27_13-09-31/rule_results/9.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_10seeds_nofreeze_2024-07-27_13-09-31/confusion_matrix/9.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 456707 KiB |   3602 MiB |  43297 GiB |  43297 GiB |
|       from large pool | 416099 KiB |   3568 MiB |  42799 GiB |  42799 GiB |
|       from small pool |  40608 KiB |     60 MiB |    498 GiB |    497 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 456707 KiB |   3602 MiB |  43297 GiB |  43297 GiB |
|       from large pool | 416099 KiB |   3568 MiB |  42799 GiB |  42799 GiB |
|       from small pool |  40608 KiB |     60 MiB |    498 GiB |    497 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 447482 KiB |   3596 MiB |  43186 GiB |  43185 GiB |
|       from large pool | 407075 KiB |   3563 MiB |  42689 GiB |  42688 GiB |
|       from small pool |  40407 KiB |     60 MiB |    497 GiB |    497 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   4022 MiB |   4022 MiB |   7252 MiB |   3230 MiB |
|       from large pool |   3954 MiB |   3954 MiB |   7166 MiB |   3212 MiB |
|       from small pool |     68 MiB |     68 MiB |     86 MiB |     18 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 362492 KiB | 496525 KiB |  30422 GiB |  30422 GiB |
|       from large pool | 353949 KiB | 492852 KiB |  29913 GiB |  29913 GiB |
|       from small pool |   8543 KiB |  20881 KiB |    509 GiB |    509 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    1330    |    1709    |    7600 K  |    7598 K  |
|       from large pool |     187    |     468    |    3953 K  |    3953 K  |
|       from small pool |    1143    |    1447    |    3646 K  |    3645 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    1330    |    1709    |    7600 K  |    7598 K  |
|       from large pool |     187    |     468    |    3953 K  |    3953 K  |
|       from small pool |    1143    |    1447    |    3646 K  |    3645 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     201    |     201    |     342    |     141    |
|       from large pool |     167    |     167    |     299    |     132    |
|       from small pool |      34    |      34    |      43    |       9    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      85    |     251    |    4406 K  |    4406 K  |
|       from large pool |      32    |     166    |    2669 K  |    2669 K  |
|       from small pool |      53    |     219    |    1736 K  |    1736 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   3602 MiB |  43297 GiB |  43297 GiB |
|       from large pool |  16640 KiB |   3568 MiB |  42799 GiB |  42799 GiB |
|       from small pool |      0 KiB |     60 MiB |    498 GiB |    498 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   3602 MiB |  43297 GiB |  43297 GiB |
|       from large pool |  16640 KiB |   3568 MiB |  42799 GiB |  42799 GiB |
|       from small pool |      0 KiB |     60 MiB |    498 GiB |    498 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   3596 MiB |  43186 GiB |  43186 GiB |
|       from large pool |  16640 KiB |   3563 MiB |  42689 GiB |  42689 GiB |
|       from small pool |      0 KiB |     60 MiB |    497 GiB |    497 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    800 MiB |   4022 MiB |   7252 MiB |   6452 MiB |
|       from large pool |    752 MiB |   3954 MiB |   7166 MiB |   6414 MiB |
|       from small pool |     48 MiB |     68 MiB |     86 MiB |     38 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 496525 KiB |  30423 GiB |  30423 GiB |
|       from large pool |  24320 KiB | 492852 KiB |  29913 GiB |  29913 GiB |
|       from small pool |      0 KiB |  32850 KiB |    509 GiB |    509 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    1709    |    7600 K  |    7600 K  |
|       from large pool |       2    |     468    |    3953 K  |    3953 K  |
|       from small pool |       0    |    1447    |    3646 K  |    3646 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    1709    |    7600 K  |    7600 K  |
|       from large pool |       2    |     468    |    3953 K  |    3953 K  |
|       from small pool |       0    |    1447    |    3646 K  |    3646 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      58    |     201    |     342    |     284    |
|       from large pool |      34    |     167    |     299    |     265    |
|       from small pool |      24    |      34    |      43    |      19    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     251    |    4407 K  |    4407 K  |
|       from large pool |       3    |     166    |    2670 K  |    2670 K  |
|       from small pool |       0    |     219    |    1737 K  |    1737 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   3602 MiB |  43297 GiB |  43297 GiB |
|       from large pool |  16640 KiB |   3568 MiB |  42799 GiB |  42799 GiB |
|       from small pool |      0 KiB |     60 MiB |    498 GiB |    498 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   3602 MiB |  43297 GiB |  43297 GiB |
|       from large pool |  16640 KiB |   3568 MiB |  42799 GiB |  42799 GiB |
|       from small pool |      0 KiB |     60 MiB |    498 GiB |    498 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   3596 MiB |  43186 GiB |  43186 GiB |
|       from large pool |  16640 KiB |   3563 MiB |  42689 GiB |  42689 GiB |
|       from small pool |      0 KiB |     60 MiB |    497 GiB |    497 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    800 MiB |   4022 MiB |   7252 MiB |   6452 MiB |
|       from large pool |    752 MiB |   3954 MiB |   7166 MiB |   6414 MiB |
|       from small pool |     48 MiB |     68 MiB |     86 MiB |     38 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 496525 KiB |  30423 GiB |  30423 GiB |
|       from large pool |  24320 KiB | 492852 KiB |  29913 GiB |  29913 GiB |
|       from small pool |      0 KiB |  32850 KiB |    509 GiB |    509 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    1709    |    7600 K  |    7600 K  |
|       from large pool |       2    |     468    |    3953 K  |    3953 K  |
|       from small pool |       0    |    1447    |    3646 K  |    3646 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    1709    |    7600 K  |    7600 K  |
|       from large pool |       2    |     468    |    3953 K  |    3953 K  |
|       from small pool |       0    |    1447    |    3646 K  |    3646 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      58    |     201    |     342    |     284    |
|       from large pool |      34    |     167    |     299    |     265    |
|       from small pool |      24    |      34    |      43    |      19    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     251    |    4407 K  |    4407 K  |
|       from large pool |       3    |     166    |    2670 K  |    2670 K  |
|       from small pool |       0    |     219    |    1737 K  |    1737 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center0_dann_b8efecac6_not_commited_2024md_07md_27_13_36_44_seed_2_23099029

 Experiment start at: 2024-07-27 13:36:45.102529
before training, model accuracy: 0.5254629850387573
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.5039267, 'precision': 0.25196335, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.33507395, 'auroc': 0.6098981, 'binary_precision': 0.5039267, 'binary_recall': 1.0, 'binary_specificity': 0.0, 'binary_f1_score': 0.6701479}
confusion matrix:
   0     1
0  0  1516
1  0  1540
---- Validation: 
scalar performance:
{'acc': 0.48669797, 'precision': 0.24334899, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.32736844, 'auroc': 0.7543661, 'binary_precision': 0.48669797, 'binary_recall': 1.0, 'binary_specificity': 0.0, 'binary_f1_score': 0.6547369}
confusion matrix:
   0    1
0  0  656
1  0  622
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5, 'precision': 0.25, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.33333334, 'auroc': 0.83112574, 'binary_precision': 0.5, 'binary_recall': 1.0, 'binary_specificity': 0.0, 'binary_f1_score': 0.6666667}
confusion matrix:
   0    1
0  0  216
1  0  216
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-27 13:38:47.289577,epoch time: 0:02:02.187048,used: 0:02:02.187048,model: dset_te_center0_dann_b8efecac6_not_commited_2024md_07md_27_13_36_44_seed_2_23099029
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.5039267, 'precision': 0.25196335, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.33507395, 'auroc': 0.4055233, 'binary_precision': 0.5039267, 'binary_recall': 1.0, 'binary_specificity': 0.0, 'binary_f1_score': 0.6701479}
confusion matrix:
   0     1
0  0  1516
1  0  1540
---- Validation: 
scalar performance:
{'acc': 0.48669797, 'precision': 0.24334899, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.32736844, 'auroc': 0.77838373, 'binary_precision': 0.48669797, 'binary_recall': 1.0, 'binary_specificity': 0.0, 'binary_f1_score': 0.6547369}
confusion matrix:
   0    1
0  0  656
1  0  622
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5, 'precision': 0.25, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.33333334, 'auroc': 0.8941294, 'binary_precision': 0.5, 'binary_recall': 1.0, 'binary_specificity': 0.0, 'binary_f1_score': 0.6666667}
confusion matrix:
   0    1
0  0  216
1  0  216
early stop counter: 1
val acc:0.4866979718208313, best validation acc: 0.4866979718208313, corresponding to test acc:                         0.5 / 0.5
after epoch: 2,now: 2024-07-27 13:40:46.395966,epoch time: 0:01:59.106389,used: 0:04:01.293437,model: dset_te_center0_dann_b8efecac6_not_commited_2024md_07md_27_13_36_44_seed_2_23099029
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.5039267, 'precision': 0.25196335, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.33507395, 'auroc': 0.4991838, 'binary_precision': 0.5039267, 'binary_recall': 1.0, 'binary_specificity': 0.0, 'binary_f1_score': 0.6701479}
confusion matrix:
   0     1
0  0  1516
1  0  1540
---- Validation: 
scalar performance:
{'acc': 0.48669797, 'precision': 0.24334899, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.32736844, 'auroc': 0.72986674, 'binary_precision': 0.48669797, 'binary_recall': 1.0, 'binary_specificity': 0.0, 'binary_f1_score': 0.6547369}
confusion matrix:
   0    1
0  0  656
1  0  622
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5, 'precision': 0.25, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.33333334, 'auroc': 0.6680813, 'binary_precision': 0.5, 'binary_recall': 1.0, 'binary_specificity': 0.0, 'binary_f1_score': 0.6666667}
confusion matrix:
   0    1
0  0  216
1  0  216
early stop counter: 2
val acc:0.4866979718208313, best validation acc: 0.4866979718208313, corresponding to test acc:                         0.5 / 0.5
after epoch: 3,now: 2024-07-27 13:42:45.499487,epoch time: 0:01:59.103521,used: 0:06:00.396958,model: dset_te_center0_dann_b8efecac6_not_commited_2024md_07md_27_13_36_44_seed_2_23099029
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.5039267, 'precision': 0.25196335, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.33507395, 'auroc': 0.48853552, 'binary_precision': 0.5039267, 'binary_recall': 1.0, 'binary_specificity': 0.0, 'binary_f1_score': 0.6701479}
confusion matrix:
   0     1
0  0  1516
1  0  1540
---- Validation: 
scalar performance:
{'acc': 0.48669797, 'precision': 0.24334899, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.32736844, 'auroc': 0.5543781, 'binary_precision': 0.48669797, 'binary_recall': 1.0, 'binary_specificity': 0.0, 'binary_f1_score': 0.6547369}
confusion matrix:
   0    1
0  0  656
1  0  622
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5, 'precision': 0.25, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.33333334, 'auroc': 0.5185185, 'binary_precision': 0.5, 'binary_recall': 1.0, 'binary_specificity': 0.0, 'binary_f1_score': 0.6666667}
confusion matrix:
   0    1
0  0  216
1  0  216
early stop counter: 3
val acc:0.4866979718208313, best validation acc: 0.4866979718208313, corresponding to test acc:                         0.5 / 0.5
after epoch: 4,now: 2024-07-27 13:44:44.555308,epoch time: 0:01:59.055821,used: 0:07:59.452779,model: dset_te_center0_dann_b8efecac6_not_commited_2024md_07md_27_13_36_44_seed_2_23099029
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.4960733, 'precision': 0.24803665, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.33158356, 'auroc': 0.50135756, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  1516  0
1  1540  0
---- Validation: 
scalar performance:
{'acc': 0.513302, 'precision': 0.256651, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.33919337, 'auroc': 0.48450613, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
     0  1
0  656  0
1  622  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5, 'precision': 0.25, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.33333334, 'auroc': 0.46296299, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
     0  1
0  216  0
1  216  0
better model found
persisted
after epoch: 5,now: 2024-07-27 13:46:43.656563,epoch time: 0:01:59.101255,used: 0:09:58.554034,model: dset_te_center0_dann_b8efecac6_not_commited_2024md_07md_27_13_36_44_seed_2_23099029
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.5039267, 'precision': 0.25196335, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.33507395, 'auroc': 0.47471768, 'binary_precision': 0.5039267, 'binary_recall': 1.0, 'binary_specificity': 0.0, 'binary_f1_score': 0.6701479}
confusion matrix:
   0     1
0  0  1516
1  0  1540
---- Validation: 
scalar performance:
{'acc': 0.48669797, 'precision': 0.24334899, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.32736844, 'auroc': 0.55105233, 'binary_precision': 0.48669797, 'binary_recall': 1.0, 'binary_specificity': 0.0, 'binary_f1_score': 0.6547369}
confusion matrix:
   0    1
0  0  656
1  0  622
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5, 'precision': 0.25, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.33333334, 'auroc': 0.525463, 'binary_precision': 0.5, 'binary_recall': 1.0, 'binary_specificity': 0.0, 'binary_f1_score': 0.6666667}
confusion matrix:
   0    1
0  0  216
1  0  216
early stop counter: 1
val acc:0.4866979718208313, best validation acc: 0.5133020281791687, corresponding to test acc:                         0.5 / 0.5
after epoch: 6,now: 2024-07-27 13:48:42.711759,epoch time: 0:01:59.055196,used: 0:11:57.609230,model: dset_te_center0_dann_b8efecac6_not_commited_2024md_07md_27_13_36_44_seed_2_23099029
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.5039267, 'precision': 0.25196335, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.33507395, 'auroc': 0.45978373, 'binary_precision': 0.5039267, 'binary_recall': 1.0, 'binary_specificity': 0.0, 'binary_f1_score': 0.6701479}
confusion matrix:
   0     1
0  0  1516
1  0  1540
---- Validation: 
scalar performance:
{'acc': 0.48669797, 'precision': 0.24334899, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.32736844, 'auroc': 0.4706322, 'binary_precision': 0.48669797, 'binary_recall': 1.0, 'binary_specificity': 0.0, 'binary_f1_score': 0.6547369}
confusion matrix:
   0    1
0  0  656
1  0  622
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5, 'precision': 0.25, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.33333334, 'auroc': 0.43287033, 'binary_precision': 0.5, 'binary_recall': 1.0, 'binary_specificity': 0.0, 'binary_f1_score': 0.6666667}
confusion matrix:
   0    1
0  0  216
1  0  216
early stop counter: 2
val acc:0.4866979718208313, best validation acc: 0.5133020281791687, corresponding to test acc:                         0.5 / 0.5
after epoch: 7,now: 2024-07-27 13:50:40.834587,epoch time: 0:01:58.122828,used: 0:13:55.732058,model: dset_te_center0_dann_b8efecac6_not_commited_2024md_07md_27_13_36_44_seed_2_23099029
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.4960733, 'precision': 0.24803665, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.33158356, 'auroc': 0.5043261, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  1516  0
1  1540  0
---- Validation: 
scalar performance:
{'acc': 0.513302, 'precision': 0.256651, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.33919337, 'auroc': 0.49622333, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
     0  1
0  656  0
1  622  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5, 'precision': 0.25, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.33333334, 'auroc': 0.525463, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
     0  1
0  216  0
1  216  0
early stop counter: 3
val acc:0.5133020281791687, best validation acc: 0.5133020281791687, corresponding to test acc:                         0.5 / 0.5
after epoch: 8,now: 2024-07-27 13:52:38.409253,epoch time: 0:01:57.574666,used: 0:15:53.306724,model: dset_te_center0_dann_b8efecac6_not_commited_2024md_07md_27_13_36_44_seed_2_23099029
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.4960733, 'precision': 0.24803665, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.33158356, 'auroc': 0.50367725, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  1516  0
1  1540  0
---- Validation: 
scalar performance:
{'acc': 0.513302, 'precision': 0.256651, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.33919337, 'auroc': 0.47848698, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
     0  1
0  656  0
1  622  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5, 'precision': 0.25, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.33333334, 'auroc': 0.5, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
     0  1
0  216  0
1  216  0
early stop counter: 4
val acc:0.5133020281791687, best validation acc: 0.5133020281791687, corresponding to test acc:                         0.5 / 0.5
after epoch: 9,now: 2024-07-27 13:54:36.456665,epoch time: 0:01:58.047412,used: 0:17:51.354136,model: dset_te_center0_dann_b8efecac6_not_commited_2024md_07md_27_13_36_44_seed_2_23099029
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.5039267, 'precision': 0.25196335, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.33507395, 'auroc': 0.49620798, 'binary_precision': 0.5039267, 'binary_recall': 1.0, 'binary_specificity': 0.0, 'binary_f1_score': 0.6701479}
confusion matrix:
   0     1
0  0  1516
1  0  1540
---- Validation: 
scalar performance:
{'acc': 0.48669797, 'precision': 0.24334899, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.32736844, 'auroc': 0.5023478, 'binary_precision': 0.48669797, 'binary_recall': 1.0, 'binary_specificity': 0.0, 'binary_f1_score': 0.6547369}
confusion matrix:
   0    1
0  0  656
1  0  622
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5, 'precision': 0.25, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.33333334, 'auroc': 0.5023148, 'binary_precision': 0.5, 'binary_recall': 1.0, 'binary_specificity': 0.0, 'binary_f1_score': 0.6666667}
confusion matrix:
   0    1
0  0  216
1  0  216
early stop counter: 5
val acc:0.4866979718208313, best validation acc: 0.5133020281791687, corresponding to test acc:                         0.5 / 0.5
after epoch: 10,now: 2024-07-27 13:56:33.874983,epoch time: 0:01:57.418318,used: 0:19:48.772454,model: dset_te_center0_dann_b8efecac6_not_commited_2024md_07md_27_13_36_44_seed_2_23099029
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 10 with time: 0:19:48.772454 at 2024-07-27 13:56:33.874983
persisted model performance metric: 

scalar performance:
{'acc': 0.5, 'precision': 0.25, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.33333334, 'auroc': 0.46296299, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
     0  1
0  216  0
1  216  0
oracle model performance metric: 

scalar performance:
{'acc': 0.5, 'precision': 0.25, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.33333334, 'auroc': 0.83112574, 'binary_precision': 0.5, 'binary_recall': 1.0, 'binary_specificity': 0.0, 'binary_f1_score': 0.6666667}
confusion matrix:
   0    1
0  0  216
1  0  216
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_10seeds_nofreeze_2024-07-27_13-09-31/rule_results/9.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_10seeds_nofreeze_2024-07-27_13-09-31/confusion_matrix/9.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 456462 KiB |   3602 MiB |  79027 GiB |  79026 GiB |
|       from large pool | 415860 KiB |   3568 MiB |  78121 GiB |  78121 GiB |
|       from small pool |  40602 KiB |     60 MiB |    905 GiB |    905 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 456462 KiB |   3602 MiB |  79027 GiB |  79026 GiB |
|       from large pool | 415860 KiB |   3568 MiB |  78121 GiB |  78121 GiB |
|       from small pool |  40602 KiB |     60 MiB |    905 GiB |    905 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 447481 KiB |   3596 MiB |  78840 GiB |  78839 GiB |
|       from large pool | 407075 KiB |   3563 MiB |  77935 GiB |  77935 GiB |
|       from small pool |  40406 KiB |     60 MiB |    904 GiB |    904 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   4022 MiB |   4022 MiB |  10474 MiB |   6452 MiB |
|       from large pool |   3958 MiB |   3958 MiB |  10372 MiB |   6414 MiB |
|       from small pool |     64 MiB |     68 MiB |    102 MiB |     38 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 323825 KiB | 496525 KiB |  55201 GiB |  55201 GiB |
|       from large pool | 315276 KiB | 492852 KiB |  54276 GiB |  54275 GiB |
|       from small pool |   8549 KiB |  32850 KiB |    925 GiB |    925 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    1318    |    1709    |   13858 K  |   13856 K  |
|       from large pool |     187    |     468    |    7216 K  |    7215 K  |
|       from small pool |    1131    |    1447    |    6642 K  |    6640 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    1318    |    1709    |   13858 K  |   13856 K  |
|       from large pool |     187    |     468    |    7216 K  |    7215 K  |
|       from small pool |    1131    |    1447    |    6642 K  |    6640 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     198    |     201    |     482    |     284    |
|       from large pool |     166    |     167    |     431    |     265    |
|       from small pool |      32    |      34    |      51    |      19    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      82    |     251    |    7931 K  |    7931 K  |
|       from large pool |      31    |     167    |    4761 K  |    4761 K  |
|       from small pool |      51    |     219    |    3169 K  |    3169 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   3602 MiB |  79027 GiB |  79027 GiB |
|       from large pool |  16640 KiB |   3568 MiB |  78121 GiB |  78121 GiB |
|       from small pool |      0 KiB |     60 MiB |    905 GiB |    905 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   3602 MiB |  79027 GiB |  79027 GiB |
|       from large pool |  16640 KiB |   3568 MiB |  78121 GiB |  78121 GiB |
|       from small pool |      0 KiB |     60 MiB |    905 GiB |    905 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   3596 MiB |  78840 GiB |  78840 GiB |
|       from large pool |  16640 KiB |   3563 MiB |  77935 GiB |  77935 GiB |
|       from small pool |      0 KiB |     60 MiB |    904 GiB |    904 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 780288 KiB |   4022 MiB |  10474 MiB |   9712 MiB |
|       from large pool | 731136 KiB |   3958 MiB |  10372 MiB |   9658 MiB |
|       from small pool |  49152 KiB |     68 MiB |    102 MiB |     54 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 496525 KiB |  55202 GiB |  55202 GiB |
|       from large pool |  24320 KiB | 492852 KiB |  54276 GiB |  54276 GiB |
|       from small pool |      0 KiB |  32856 KiB |    925 GiB |    925 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    1709    |   13858 K  |   13858 K  |
|       from large pool |       2    |     468    |    7216 K  |    7216 K  |
|       from small pool |       0    |    1447    |    6642 K  |    6642 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    1709    |   13858 K  |   13858 K  |
|       from large pool |       2    |     468    |    7216 K  |    7216 K  |
|       from small pool |       0    |    1447    |    6642 K  |    6642 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      57    |     201    |     482    |     425    |
|       from large pool |      33    |     167    |     431    |     398    |
|       from small pool |      24    |      34    |      51    |      27    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     251    |    7931 K  |    7931 K  |
|       from large pool |       3    |     167    |    4761 K  |    4761 K  |
|       from small pool |       0    |     219    |    3170 K  |    3170 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Sat Jul 27 13:56:42 2024]
Finished job 0.
1 of 1 steps (100%) done
