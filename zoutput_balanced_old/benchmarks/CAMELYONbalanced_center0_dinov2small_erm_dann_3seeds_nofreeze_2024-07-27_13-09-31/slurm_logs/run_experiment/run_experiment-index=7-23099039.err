Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Sat Jul 27 13:51:50 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_10seeds_nofreeze_2024-07-27_13-09-31/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_10seeds_nofreeze_2024-07-27_13-09-31/rule_results/7.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=7
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/swiglu_ffn.py:51: UserWarning: xFormers is not available (SwiGLU)
  warnings.warn("xFormers is not available (SwiGLU)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/attention.py:33: UserWarning: xFormers is not available (Attention)
  warnings.warn("xFormers is not available (Attention)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/block.py:40: UserWarning: xFormers is not available (Block)
  warnings.warn("xFormers is not available (Block)")
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center0_dann_b8efecac6_not_commited_2024md_07md_27_13_52_32_seed_0_23099039

 Experiment start at: 2024-07-27 13:52:32.643170
before training, model accuracy: 0.49534884095191956
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.50651044, 'precision': 0.25325522, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.33621433, 'auroc': 0.5, 'binary_precision': 0.50651044, 'binary_recall': 1.0, 'binary_specificity': 0.0, 'binary_f1_score': 0.67242867}
confusion matrix:
   0     1
0  0  1516
1  0  1556
---- Validation: 
scalar performance:
{'acc': 0.49301243, 'precision': 0.24650621, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.33021322, 'auroc': 0.5, 'binary_precision': 0.49301243, 'binary_recall': 1.0, 'binary_specificity': 0.0, 'binary_f1_score': 0.66042644}
confusion matrix:
   0    1
0  0  653
1  0  635
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5, 'precision': 0.25, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.33333334, 'auroc': 0.5, 'binary_precision': 0.5, 'binary_recall': 1.0, 'binary_specificity': 0.0, 'binary_f1_score': 0.6666667}
confusion matrix:
   0    1
0  0  215
1  0  215
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-27 13:54:39.536872,epoch time: 0:02:06.893702,used: 0:02:06.893702,model: dset_te_center0_dann_b8efecac6_not_commited_2024md_07md_27_13_52_32_seed_0_23099039
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.5061849, 'precision': 0.25309244, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.3360709, 'auroc': 0.5, 'binary_precision': 0.5061849, 'binary_recall': 1.0, 'binary_specificity': 0.0, 'binary_f1_score': 0.6721418}
confusion matrix:
   0     1
0  0  1517
1  0  1555
---- Validation: 
scalar performance:
{'acc': 0.49301243, 'precision': 0.24650621, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.33021322, 'auroc': 0.5, 'binary_precision': 0.49301243, 'binary_recall': 1.0, 'binary_specificity': 0.0, 'binary_f1_score': 0.66042644}
confusion matrix:
   0    1
0  0  653
1  0  635
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5, 'precision': 0.25, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.33333334, 'auroc': 0.5, 'binary_precision': 0.5, 'binary_recall': 1.0, 'binary_specificity': 0.0, 'binary_f1_score': 0.6666667}
confusion matrix:
   0    1
0  0  215
1  0  215
early stop counter: 1
val acc:0.4930124282836914, best validation acc: 0.4930124282836914, corresponding to test acc:                         0.5 / 0.5
after epoch: 2,now: 2024-07-27 13:56:41.343126,epoch time: 0:02:01.806254,used: 0:04:08.699956,model: dset_te_center0_dann_b8efecac6_not_commited_2024md_07md_27_13_52_32_seed_0_23099039
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.50651044, 'precision': 0.25325522, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.33621433, 'auroc': 0.5, 'binary_precision': 0.50651044, 'binary_recall': 1.0, 'binary_specificity': 0.0, 'binary_f1_score': 0.67242867}
confusion matrix:
   0     1
0  0  1516
1  0  1556
---- Validation: 
scalar performance:
{'acc': 0.49301243, 'precision': 0.24650621, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.33021322, 'auroc': 0.5, 'binary_precision': 0.49301243, 'binary_recall': 1.0, 'binary_specificity': 0.0, 'binary_f1_score': 0.66042644}
confusion matrix:
   0    1
0  0  653
1  0  635
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5, 'precision': 0.25, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.33333334, 'auroc': 0.5, 'binary_precision': 0.5, 'binary_recall': 1.0, 'binary_specificity': 0.0, 'binary_f1_score': 0.6666667}
confusion matrix:
   0    1
0  0  215
1  0  215
early stop counter: 2
val acc:0.4930124282836914, best validation acc: 0.4930124282836914, corresponding to test acc:                         0.5 / 0.5
after epoch: 3,now: 2024-07-27 13:58:43.552743,epoch time: 0:02:02.209617,used: 0:06:10.909573,model: dset_te_center0_dann_b8efecac6_not_commited_2024md_07md_27_13_52_32_seed_0_23099039
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.5061849, 'precision': 0.25309244, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.3360709, 'auroc': 0.5, 'binary_precision': 0.5061849, 'binary_recall': 1.0, 'binary_specificity': 0.0, 'binary_f1_score': 0.6721418}
confusion matrix:
   0     1
0  0  1517
1  0  1555
---- Validation: 
scalar performance:
{'acc': 0.49301243, 'precision': 0.24650621, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.33021322, 'auroc': 0.5, 'binary_precision': 0.49301243, 'binary_recall': 1.0, 'binary_specificity': 0.0, 'binary_f1_score': 0.66042644}
confusion matrix:
   0    1
0  0  653
1  0  635
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5, 'precision': 0.25, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.33333334, 'auroc': 0.5, 'binary_precision': 0.5, 'binary_recall': 1.0, 'binary_specificity': 0.0, 'binary_f1_score': 0.6666667}
confusion matrix:
   0    1
0  0  215
1  0  215
early stop counter: 3
val acc:0.4930124282836914, best validation acc: 0.4930124282836914, corresponding to test acc:                         0.5 / 0.5
after epoch: 4,now: 2024-07-27 14:00:44.852636,epoch time: 0:02:01.299893,used: 0:08:12.209466,model: dset_te_center0_dann_b8efecac6_not_commited_2024md_07md_27_13_52_32_seed_0_23099039
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.5061849, 'precision': 0.25309244, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.3360709, 'auroc': 0.5, 'binary_precision': 0.5061849, 'binary_recall': 1.0, 'binary_specificity': 0.0, 'binary_f1_score': 0.6721418}
confusion matrix:
   0     1
0  0  1517
1  0  1555
---- Validation: 
scalar performance:
{'acc': 0.49301243, 'precision': 0.24650621, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.33021322, 'auroc': 0.5, 'binary_precision': 0.49301243, 'binary_recall': 1.0, 'binary_specificity': 0.0, 'binary_f1_score': 0.66042644}
confusion matrix:
   0    1
0  0  653
1  0  635
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5, 'precision': 0.25, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.33333334, 'auroc': 0.5, 'binary_precision': 0.5, 'binary_recall': 1.0, 'binary_specificity': 0.0, 'binary_f1_score': 0.6666667}
confusion matrix:
   0    1
0  0  215
1  0  215
early stop counter: 4
val acc:0.4930124282836914, best validation acc: 0.4930124282836914, corresponding to test acc:                         0.5 / 0.5
after epoch: 5,now: 2024-07-27 14:02:47.167116,epoch time: 0:02:02.314480,used: 0:10:14.523946,model: dset_te_center0_dann_b8efecac6_not_commited_2024md_07md_27_13_52_32_seed_0_23099039
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.50683594, 'precision': 0.25341797, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.33635774, 'auroc': 0.5, 'binary_precision': 0.50683594, 'binary_recall': 1.0, 'binary_specificity': 0.0, 'binary_f1_score': 0.6727155}
confusion matrix:
   0     1
0  0  1515
1  0  1557
---- Validation: 
scalar performance:
{'acc': 0.49301243, 'precision': 0.24650621, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.33021322, 'auroc': 0.5, 'binary_precision': 0.49301243, 'binary_recall': 1.0, 'binary_specificity': 0.0, 'binary_f1_score': 0.66042644}
confusion matrix:
   0    1
0  0  653
1  0  635
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5, 'precision': 0.25, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.33333334, 'auroc': 0.5, 'binary_precision': 0.5, 'binary_recall': 1.0, 'binary_specificity': 0.0, 'binary_f1_score': 0.6666667}
confusion matrix:
   0    1
0  0  215
1  0  215
early stop counter: 5
val acc:0.4930124282836914, best validation acc: 0.4930124282836914, corresponding to test acc:                         0.5 / 0.5
after epoch: 6,now: 2024-07-27 14:04:48.675450,epoch time: 0:02:01.508334,used: 0:12:16.032280,model: dset_te_center0_dann_b8efecac6_not_commited_2024md_07md_27_13_52_32_seed_0_23099039
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 6 with time: 0:12:16.032280 at 2024-07-27 14:04:48.675450
persisted model performance metric: 

scalar performance:
{'acc': 0.5, 'precision': 0.25, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.33333334, 'auroc': 0.5, 'binary_precision': 0.5, 'binary_recall': 1.0, 'binary_specificity': 0.0, 'binary_f1_score': 0.6666667}
confusion matrix:
   0    1
0  0  215
1  0  215
oracle model performance metric: 

scalar performance:
{'acc': 0.5, 'precision': 0.25, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.33333334, 'auroc': 0.5, 'binary_precision': 0.5, 'binary_recall': 1.0, 'binary_specificity': 0.0, 'binary_f1_score': 0.6666667}
confusion matrix:
   0    1
0  0  215
1  0  215
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_10seeds_nofreeze_2024-07-27_13-09-31/rule_results/7.csv
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_10seeds_nofreeze_2024-07-27_13-09-31/rule_results/7.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_10seeds_nofreeze_2024-07-27_13-09-31/confusion_matrix/7.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 455608 KiB |   3602 MiB |  21674 GiB |  21674 GiB |
|       from large pool | 415006 KiB |   3568 MiB |  21427 GiB |  21426 GiB |
|       from small pool |  40602 KiB |     56 MiB |    247 GiB |    247 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 455608 KiB |   3602 MiB |  21674 GiB |  21674 GiB |
|       from large pool | 415006 KiB |   3568 MiB |  21427 GiB |  21426 GiB |
|       from small pool |  40602 KiB |     56 MiB |    247 GiB |    247 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 447481 KiB |   3596 MiB |  21582 GiB |  21582 GiB |
|       from large pool | 407075 KiB |   3563 MiB |  21335 GiB |  21334 GiB |
|       from small pool |  40406 KiB |     56 MiB |    247 GiB |    247 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   4016 MiB |   4016 MiB |   4016 MiB |      0 B   |
|       from large pool |   3952 MiB |   3952 MiB |   3952 MiB |      0 B   |
|       from small pool |     64 MiB |     64 MiB |     64 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory | 349255 KiB | 496525 KiB |  15171 GiB |  15171 GiB |
|       from large pool | 342754 KiB | 492852 KiB |  14918 GiB |  14918 GiB |
|       from small pool |   6501 KiB |  14115 KiB |    252 GiB |    252 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    1318    |    1697    |    3794 K  |    3793 K  |
|       from large pool |     187    |     468    |    1976 K  |    1975 K  |
|       from small pool |    1131    |    1435    |    1818 K  |    1817 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    1318    |    1697    |    3794 K  |    3793 K  |
|       from large pool |     187    |     468    |    1976 K  |    1975 K  |
|       from small pool |    1131    |    1435    |    1818 K  |    1817 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     198    |     198    |     198    |       0    |
|       from large pool |     166    |     166    |     166    |       0    |
|       from small pool |      32    |      32    |      32    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      82    |     249    |    2194 K  |    2194 K  |
|       from large pool |      31    |     165    |    1332 K  |    1332 K  |
|       from small pool |      51    |     218    |     861 K  |     861 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   3602 MiB |  21674 GiB |  21674 GiB |
|       from large pool |  16640 KiB |   3568 MiB |  21427 GiB |  21427 GiB |
|       from small pool |      0 KiB |     56 MiB |    247 GiB |    247 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   3602 MiB |  21674 GiB |  21674 GiB |
|       from large pool |  16640 KiB |   3568 MiB |  21427 GiB |  21427 GiB |
|       from small pool |      0 KiB |     56 MiB |    247 GiB |    247 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   3596 MiB |  21582 GiB |  21582 GiB |
|       from large pool |  16640 KiB |   3563 MiB |  21335 GiB |  21335 GiB |
|       from small pool |      0 KiB |     56 MiB |    247 GiB |    247 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    786 MiB |   4016 MiB |   4016 MiB |   3230 MiB |
|       from large pool |    740 MiB |   3952 MiB |   3952 MiB |   3212 MiB |
|       from small pool |     46 MiB |     64 MiB |     64 MiB |     18 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 496525 KiB |  15172 GiB |  15172 GiB |
|       from large pool |  24320 KiB | 492852 KiB |  14919 GiB |  14919 GiB |
|       from small pool |      0 KiB |  22317 KiB |    253 GiB |    253 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    1697    |    3794 K  |    3794 K  |
|       from large pool |       2    |     468    |    1976 K  |    1976 K  |
|       from small pool |       0    |    1435    |    1818 K  |    1818 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    1697    |    3794 K  |    3794 K  |
|       from large pool |       2    |     468    |    1976 K  |    1976 K  |
|       from small pool |       0    |    1435    |    1818 K  |    1818 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      57    |     198    |     198    |     141    |
|       from large pool |      34    |     166    |     166    |     132    |
|       from small pool |      23    |      32    |      32    |       9    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     249    |    2194 K  |    2194 K  |
|       from large pool |       3    |     165    |    1332 K  |    1332 K  |
|       from small pool |       0    |     218    |     861 K  |     861 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   3602 MiB |  21674 GiB |  21674 GiB |
|       from large pool |  16640 KiB |   3568 MiB |  21427 GiB |  21427 GiB |
|       from small pool |      0 KiB |     56 MiB |    247 GiB |    247 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   3602 MiB |  21674 GiB |  21674 GiB |
|       from large pool |  16640 KiB |   3568 MiB |  21427 GiB |  21427 GiB |
|       from small pool |      0 KiB |     56 MiB |    247 GiB |    247 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   3596 MiB |  21582 GiB |  21582 GiB |
|       from large pool |  16640 KiB |   3563 MiB |  21335 GiB |  21335 GiB |
|       from small pool |      0 KiB |     56 MiB |    247 GiB |    247 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    786 MiB |   4016 MiB |   4016 MiB |   3230 MiB |
|       from large pool |    740 MiB |   3952 MiB |   3952 MiB |   3212 MiB |
|       from small pool |     46 MiB |     64 MiB |     64 MiB |     18 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 496525 KiB |  15172 GiB |  15172 GiB |
|       from large pool |  24320 KiB | 492852 KiB |  14919 GiB |  14919 GiB |
|       from small pool |      0 KiB |  22317 KiB |    253 GiB |    253 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    1697    |    3794 K  |    3794 K  |
|       from large pool |       2    |     468    |    1976 K  |    1976 K  |
|       from small pool |       0    |    1435    |    1818 K  |    1818 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    1697    |    3794 K  |    3794 K  |
|       from large pool |       2    |     468    |    1976 K  |    1976 K  |
|       from small pool |       0    |    1435    |    1818 K  |    1818 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      57    |     198    |     198    |     141    |
|       from large pool |      34    |     166    |     166    |     132    |
|       from small pool |      23    |      32    |      32    |       9    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     249    |    2194 K  |    2194 K  |
|       from large pool |       3    |     165    |    1332 K  |    1332 K  |
|       from small pool |       0    |     218    |     861 K  |     861 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center0_dann_b8efecac6_not_commited_2024md_07md_27_14_05_19_seed_1_23099039

 Experiment start at: 2024-07-27 14:05:19.846612
before training, model accuracy: 0.5911111235618591
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.88216144, 'precision': 0.8972662, 'recall': 0.88324964, 'specificity': 0.88324964, 'f1': 0.88123035, 'auroc': 0.9736281, 'binary_precision': 0.9775461, 'binary_recall': 0.7849324, 'binary_specificity': 0.98156685, 'binary_f1_score': 0.87071425}
confusion matrix:
      0     1
0  1491    28
1   334  1219
---- Validation: 
scalar performance:
{'acc': 0.5542545, 'precision': 0.5804341, 'recall': 0.5491552, 'specificity': 0.5491552, 'f1': 0.5033809, 'auroc': 0.80522025, 'binary_precision': 0.62240666, 'binary_recall': 0.23809524, 'binary_specificity': 0.86021507, 'binary_f1_score': 0.3444317}
confusion matrix:
     0    1
0  560   91
1  480  150
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6022222, 'precision': 0.6624498, 'recall': 0.6022222, 'specificity': 0.6022222, 'f1': 0.56158733, 'auroc': 0.84432596, 'binary_precision': 0.7613636, 'binary_recall': 0.29777777, 'binary_specificity': 0.9066667, 'binary_f1_score': 0.428115}
confusion matrix:
     0   1
0  204  21
1  158  67
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-27 14:07:25.601815,epoch time: 0:02:05.755203,used: 0:02:05.755203,model: dset_te_center0_dann_b8efecac6_not_commited_2024md_07md_27_14_05_19_seed_1_23099039
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.90234375, 'precision': 0.9172331, 'recall': 0.9035289, 'specificity': 0.9035289, 'f1': 0.9016391, 'auroc': 0.9897731, 'binary_precision': 0.99920446, 'binary_recall': 0.807717, 'binary_specificity': 0.99934083, 'binary_f1_score': 0.8933143}
confusion matrix:
      0     1
0  1516     1
1   299  1256
---- Validation: 
scalar performance:
{'acc': 0.50741607, 'precision': 0.42057902, 'recall': 0.49925756, 'specificity': 0.49925756, 'f1': 0.33802354, 'auroc': 0.839051, 'binary_precision': 0.33333334, 'binary_recall': 0.0015873016, 'binary_specificity': 0.9969278, 'binary_f1_score': 0.0031595577}
confusion matrix:
     0  1
0  649  2
1  629  1
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.49333334, 'precision': 0.24832214, 'recall': 0.49333334, 'specificity': 0.49333334, 'f1': 0.33035713, 'auroc': 0.8431704, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9866667, 'binary_f1_score': 0.0}
confusion matrix:
     0  1
0  222  3
1  225  0
early stop counter: 1
val acc:0.5074160695075989, best validation acc: 0.5542544722557068, corresponding to test acc:                         0.602222204208374 / 0.602222204208374
after epoch: 2,now: 2024-07-27 14:09:27.474079,epoch time: 0:02:01.872264,used: 0:04:07.627467,model: dset_te_center0_dann_b8efecac6_not_commited_2024md_07md_27_14_05_19_seed_1_23099039
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9078776, 'precision': 0.92134523, 'recall': 0.9090617, 'specificity': 0.9090617, 'f1': 0.9072976, 'auroc': 0.9930552, 'binary_precision': 1.0, 'binary_recall': 0.8181234, 'binary_specificity': 1.0, 'binary_f1_score': 0.8999647}
confusion matrix:
      0     1
0  1516     0
1   283  1273
---- Validation: 
scalar performance:
{'acc': 0.5175644, 'precision': 0.6565424, 'recall': 0.5096262, 'specificity': 0.5096262, 'f1': 0.3630045, 'auroc': 0.8333846, 'binary_precision': 0.8, 'binary_recall': 0.025396826, 'binary_specificity': 0.9938556, 'binary_f1_score': 0.04923077}
confusion matrix:
     0   1
0  647   4
1  614  16
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.56, 'precision': 0.6666667, 'recall': 0.56, 'specificity': 0.56, 'f1': 0.4761905, 'auroc': 0.8603456, 'binary_precision': 0.8, 'binary_recall': 0.16, 'binary_specificity': 0.96, 'binary_f1_score': 0.26666668}
confusion matrix:
     0   1
0  216   9
1  189  36
early stop counter: 2
val acc:0.5175644159317017, best validation acc: 0.5542544722557068, corresponding to test acc:                         0.602222204208374 / 0.602222204208374
after epoch: 3,now: 2024-07-27 14:11:30.324046,epoch time: 0:02:02.849967,used: 0:06:10.477434,model: dset_te_center0_dann_b8efecac6_not_commited_2024md_07md_27_14_05_19_seed_1_23099039
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9534505, 'precision': 0.95576346, 'recall': 0.95394707, 'specificity': 0.95394707, 'f1': 0.9534197, 'auroc': 0.99041927, 'binary_precision': 0.99164927, 'binary_recall': 0.91580975, 'binary_specificity': 0.99208444, 'binary_f1_score': 0.9522218}
confusion matrix:
      0     1
0  1504    12
1   131  1425
---- Validation: 
scalar performance:
{'acc': 0.74395, 'precision': 0.7513027, 'recall': 0.7424731, 'specificity': 0.7424731, 'f1': 0.741244, 'auroc': 0.80662966, 'binary_precision': 0.7903846, 'binary_recall': 0.65238094, 'binary_specificity': 0.8325653, 'binary_f1_score': 0.71478266}
confusion matrix:
     0    1
0  542  109
1  219  411
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.78444445, 'precision': 0.78445005, 'recall': 0.78444445, 'specificity': 0.78444445, 'f1': 0.7844434, 'auroc': 0.8278519, 'binary_precision': 0.78571427, 'binary_recall': 0.7822222, 'binary_specificity': 0.7866667, 'binary_f1_score': 0.7839644}
confusion matrix:
     0    1
0  177   48
1   49  176
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-07-27 14:13:32.839753,epoch time: 0:02:02.515707,used: 0:08:12.993141,model: dset_te_center0_dann_b8efecac6_not_commited_2024md_07md_27_14_05_19_seed_1_23099039
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.90625, 'precision': 0.92017734, 'recall': 0.907455, 'specificity': 0.907455, 'f1': 0.905635, 'auroc': 0.9886447, 'binary_precision': 1.0, 'binary_recall': 0.81491005, 'binary_specificity': 1.0, 'binary_f1_score': 0.898017}
confusion matrix:
      0     1
0  1516     0
1   288  1268
---- Validation: 
scalar performance:
{'acc': 0.55971897, 'precision': 0.6902294, 'recall': 0.55276495, 'specificity': 0.55276495, 'f1': 0.45797545, 'auroc': 0.8155073, 'binary_precision': 0.84375, 'binary_recall': 0.12857144, 'binary_specificity': 0.9769585, 'binary_f1_score': 0.22314051}
confusion matrix:
     0   1
0  636  15
1  549  81
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6155556, 'precision': 0.7252079, 'recall': 0.6155556, 'specificity': 0.6155556, 'f1': 0.56227404, 'auroc': 0.85617775, 'binary_precision': 0.88235295, 'binary_recall': 0.26666668, 'binary_specificity': 0.96444446, 'binary_f1_score': 0.40955636}
confusion matrix:
     0   1
0  217   8
1  165  60
early stop counter: 1
val acc:0.5597189664840698, best validation acc: 0.7439500093460083, corresponding to test acc:                         0.7844444513320923 / 0.7844444513320923
after epoch: 5,now: 2024-07-27 14:15:36.225302,epoch time: 0:02:03.385549,used: 0:10:16.378690,model: dset_te_center0_dann_b8efecac6_not_commited_2024md_07md_27_14_05_19_seed_1_23099039
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9563802, 'precision': 0.9582772, 'recall': 0.95680845, 'specificity': 0.95680845, 'f1': 0.9563576, 'auroc': 0.99356276, 'binary_precision': 0.9910159, 'binary_recall': 0.9221865, 'binary_specificity': 0.99143046, 'binary_f1_score': 0.9553631}
confusion matrix:
      0     1
0  1504    13
1   121  1434
---- Validation: 
scalar performance:
{'acc': 0.8594848, 'precision': 0.87107676, 'recall': 0.8580389, 'specificity': 0.8580389, 'f1': 0.8579998, 'auroc': 0.91889644, 'binary_precision': 0.9326923, 'binary_recall': 0.76984125, 'binary_specificity': 0.94623655, 'binary_f1_score': 0.8434783}
confusion matrix:
     0    1
0  616   35
1  145  485
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8511111, 'precision': 0.88097996, 'recall': 0.8511111, 'specificity': 0.8511111, 'f1': 0.8481345, 'auroc': 0.93226665, 'binary_precision': 0.9876543, 'binary_recall': 0.7111111, 'binary_specificity': 0.9911111, 'binary_f1_score': 0.82687336}
confusion matrix:
     0    1
0  223    2
1   65  160
new oracle model saved
better model found
persisted
after epoch: 6,now: 2024-07-27 14:17:38.988296,epoch time: 0:02:02.762994,used: 0:12:19.141684,model: dset_te_center0_dann_b8efecac6_not_commited_2024md_07md_27_14_05_19_seed_1_23099039
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.95963544, 'precision': 0.9616425, 'recall': 0.96004957, 'specificity': 0.96004957, 'f1': 0.959612, 'auroc': 0.9954845, 'binary_precision': 0.99515235, 'binary_recall': 0.92471045, 'binary_specificity': 0.9953887, 'binary_f1_score': 0.95863914}
confusion matrix:
      0     1
0  1511     7
1   117  1437
---- Validation: 
scalar performance:
{'acc': 0.64949256, 'precision': 0.75064635, 'recall': 0.6441884, 'specificity': 0.6441884, 'f1': 0.60544795, 'auroc': 0.8282325, 'binary_precision': 0.9058296, 'binary_recall': 0.32063493, 'binary_specificity': 0.9677419, 'binary_f1_score': 0.47362253}
confusion matrix:
     0    1
0  630   21
1  428  202
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8333333, 'precision': 0.8472222, 'recall': 0.8333334, 'specificity': 0.8333334, 'f1': 0.83164984, 'auroc': 0.88300246, 'binary_precision': 0.9166667, 'binary_recall': 0.73333335, 'binary_specificity': 0.93333334, 'binary_f1_score': 0.8148148}
confusion matrix:
     0    1
0  210   15
1   60  165
early stop counter: 1
val acc:0.6494925618171692, best validation acc: 0.8594847917556763, corresponding to test acc:                         0.851111114025116 / 0.851111114025116
after epoch: 7,now: 2024-07-27 14:19:41.714445,epoch time: 0:02:02.726149,used: 0:14:21.867833,model: dset_te_center0_dann_b8efecac6_not_commited_2024md_07md_27_14_05_19_seed_1_23099039
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.96777344, 'precision': 0.96931624, 'recall': 0.96813905, 'specificity': 0.96813905, 'f1': 0.96776074, 'auroc': 0.997206, 'binary_precision': 0.99931365, 'binary_recall': 0.9369369, 'binary_specificity': 0.99934125, 'binary_f1_score': 0.9671205}
confusion matrix:
      0     1
0  1517     1
1    98  1456
---- Validation: 
scalar performance:
{'acc': 0.60265416, 'precision': 0.6833679, 'recall': 0.5970558, 'specificity': 0.5970558, 'f1': 0.54671764, 'auroc': 0.81832707, 'binary_precision': 0.80099505, 'binary_recall': 0.25555557, 'binary_specificity': 0.9385561, 'binary_f1_score': 0.38748497}
confusion matrix:
     0    1
0  611   40
1  469  161
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7355555, 'precision': 0.7706291, 'recall': 0.7355555, 'specificity': 0.7355555, 'f1': 0.72670066, 'auroc': 0.84200495, 'binary_precision': 0.8680556, 'binary_recall': 0.5555556, 'binary_specificity': 0.91555554, 'binary_f1_score': 0.6775068}
confusion matrix:
     0    1
0  206   19
1  100  125
early stop counter: 2
val acc:0.6026541590690613, best validation acc: 0.8594847917556763, corresponding to test acc:                         0.851111114025116 / 0.851111114025116
after epoch: 8,now: 2024-07-27 14:21:44.494803,epoch time: 0:02:02.780358,used: 0:16:24.648191,model: dset_te_center0_dann_b8efecac6_not_commited_2024md_07md_27_14_05_19_seed_1_23099039
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9749349, 'precision': 0.9749494, 'recall': 0.97502816, 'specificity': 0.97502816, 'f1': 0.9749341, 'auroc': 0.996734, 'binary_precision': 0.9823875, 'binary_recall': 0.9678663, 'binary_specificity': 0.98218995, 'binary_f1_score': 0.97507286}
confusion matrix:
      0     1
0  1489    27
1    50  1506
---- Validation: 
scalar performance:
{'acc': 0.7174083, 'precision': 0.7348008, 'recall': 0.71955967, 'specificity': 0.71955967, 'f1': 0.71331865, 'auroc': 0.78888404, 'binary_precision': 0.6666667, 'binary_recall': 0.85079366, 'binary_specificity': 0.5883257, 'binary_f1_score': 0.74755925}
confusion matrix:
     0    1
0  383  268
1   94  536
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7355555, 'precision': 0.7706291, 'recall': 0.7355555, 'specificity': 0.7355555, 'f1': 0.72670066, 'auroc': 0.8467951, 'binary_precision': 0.67320263, 'binary_recall': 0.91555554, 'binary_specificity': 0.5555556, 'binary_f1_score': 0.7758945}
confusion matrix:
     0    1
0  125  100
1   19  206
early stop counter: 3
val acc:0.717408299446106, best validation acc: 0.8594847917556763, corresponding to test acc:                         0.851111114025116 / 0.851111114025116
after epoch: 9,now: 2024-07-27 14:23:47.624356,epoch time: 0:02:03.129553,used: 0:18:27.777744,model: dset_te_center0_dann_b8efecac6_not_commited_2024md_07md_27_14_05_19_seed_1_23099039
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9781901, 'precision': 0.9784713, 'recall': 0.9783664, 'specificity': 0.9783664, 'f1': 0.97818977, 'auroc': 0.9975474, 'binary_precision': 0.9933643, 'binary_recall': 0.96332043, 'binary_specificity': 0.9934124, 'binary_f1_score': 0.9781117}
confusion matrix:
      0     1
0  1508    10
1    57  1497
---- Validation: 
scalar performance:
{'acc': 0.83138174, 'precision': 0.8444258, 'recall': 0.82977474, 'specificity': 0.82977474, 'f1': 0.829254, 'auroc': 0.90019745, 'binary_precision': 0.9074803, 'binary_recall': 0.731746, 'binary_specificity': 0.9278034, 'binary_f1_score': 0.8101933}
confusion matrix:
     0    1
0  604   47
1  169  461
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8466667, 'precision': 0.8552632, 'recall': 0.8466667, 'specificity': 0.8466667, 'f1': 0.8457334, 'auroc': 0.895921, 'binary_precision': 0.91052634, 'binary_recall': 0.7688889, 'binary_specificity': 0.92444444, 'binary_f1_score': 0.8337349}
confusion matrix:
     0    1
0  208   17
1   52  173
early stop counter: 4
val acc:0.8313817381858826, best validation acc: 0.8594847917556763, corresponding to test acc:                         0.851111114025116 / 0.851111114025116
after epoch: 10,now: 2024-07-27 14:25:49.985596,epoch time: 0:02:02.361240,used: 0:20:30.138984,model: dset_te_center0_dann_b8efecac6_not_commited_2024md_07md_27_14_05_19_seed_1_23099039
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.97265625, 'precision': 0.9726447, 'recall': 0.97273123, 'specificity': 0.97273123, 'f1': 0.9726546, 'auroc': 0.9963504, 'binary_precision': 0.9785575, 'binary_recall': 0.9672447, 'binary_specificity': 0.97821784, 'binary_f1_score': 0.97286826}
confusion matrix:
      0     1
0  1482    33
1    51  1506
---- Validation: 
scalar performance:
{'acc': 0.8618267, 'precision': 0.86270064, 'recall': 0.8614183, 'specificity': 0.8614183, 'f1': 0.8616159, 'auroc': 0.9075037, 'binary_precision': 0.8768719, 'binary_recall': 0.8365079, 'binary_specificity': 0.8863287, 'binary_f1_score': 0.8562144}
confusion matrix:
     0    1
0  577   74
1  103  527
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8288889, 'precision': 0.82894737, 'recall': 0.8288889, 'specificity': 0.8288889, 'f1': 0.8288813, 'auroc': 0.8846222, 'binary_precision': 0.8333333, 'binary_recall': 0.82222223, 'binary_specificity': 0.83555555, 'binary_f1_score': 0.82774055}
confusion matrix:
     0    1
0  188   37
1   40  185
better model found
persisted
after epoch: 11,now: 2024-07-27 14:27:53.094006,epoch time: 0:02:03.108410,used: 0:22:33.247394,model: dset_te_center0_dann_b8efecac6_not_commited_2024md_07md_27_14_05_19_seed_1_23099039
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.98014325, 'precision': 0.9801626, 'recall': 0.98023283, 'specificity': 0.98023283, 'f1': 0.9801427, 'auroc': 0.99833864, 'binary_precision': 0.9875979, 'binary_recall': 0.97299033, 'binary_specificity': 0.9874753, 'binary_f1_score': 0.9802397}
confusion matrix:
      0     1
0  1498    19
1    42  1513
---- Validation: 
scalar performance:
{'acc': 0.7946916, 'precision': 0.8105427, 'recall': 0.7965182, 'specificity': 0.7965182, 'f1': 0.792686, 'auroc': 0.87686837, 'binary_precision': 0.73616475, 'binary_recall': 0.9079365, 'binary_specificity': 0.68509984, 'binary_f1_score': 0.8130775}
confusion matrix:
     0    1
0  446  205
1   58  572
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7266667, 'precision': 0.755, 'recall': 0.7266667, 'specificity': 0.7266667, 'f1': 0.71885717, 'auroc': 0.84355557, 'binary_precision': 0.67, 'binary_recall': 0.8933333, 'binary_specificity': 0.56, 'binary_f1_score': 0.7657143}
confusion matrix:
     0    1
0  126   99
1   24  201
early stop counter: 1
val acc:0.7946916222572327, best validation acc: 0.8618267178535461, corresponding to test acc:                         0.8288888931274414 / 0.851111114025116
after epoch: 12,now: 2024-07-27 14:29:55.792981,epoch time: 0:02:02.698975,used: 0:24:35.946369,model: dset_te_center0_dann_b8efecac6_not_commited_2024md_07md_27_14_05_19_seed_1_23099039
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.97753906, 'precision': 0.9781531, 'recall': 0.9777974, 'specificity': 0.9777974, 'f1': 0.97753733, 'auroc': 0.9985548, 'binary_precision': 0.9986577, 'binary_recall': 0.9569132, 'binary_specificity': 0.9986816, 'binary_f1_score': 0.97733986}
confusion matrix:
      0     1
0  1515     2
1    67  1488
---- Validation: 
scalar performance:
{'acc': 0.7689305, 'precision': 0.81370974, 'recall': 0.7657962, 'specificity': 0.7657962, 'f1': 0.7589227, 'auroc': 0.8938215, 'binary_precision': 0.92820513, 'binary_recall': 0.5746032, 'binary_specificity': 0.9569892, 'binary_f1_score': 0.70980394}
confusion matrix:
     0    1
0  623   28
1  268  362
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.76666665, 'precision': 0.8161296, 'recall': 0.76666665, 'specificity': 0.76666665, 'f1': 0.75716805, 'auroc': 0.87842965, 'binary_precision': 0.9411765, 'binary_recall': 0.5688889, 'binary_specificity': 0.96444446, 'binary_f1_score': 0.70914125}
confusion matrix:
     0    1
0  217    8
1   97  128
early stop counter: 2
val acc:0.7689304947853088, best validation acc: 0.8618267178535461, corresponding to test acc:                         0.8288888931274414 / 0.851111114025116
after epoch: 13,now: 2024-07-27 14:31:58.898548,epoch time: 0:02:03.105567,used: 0:26:39.051936,model: dset_te_center0_dann_b8efecac6_not_commited_2024md_07md_27_14_05_19_seed_1_23099039
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9720052, 'precision': 0.97291625, 'recall': 0.9717856, 'specificity': 0.9717856, 'f1': 0.971979, 'auroc': 0.9985846, 'binary_precision': 0.9547427, 'binary_recall': 0.9916291, 'binary_specificity': 0.9519421, 'binary_f1_score': 0.97283643}
confusion matrix:
      0     1
0  1446    73
1    13  1540
---- Validation: 
scalar performance:
{'acc': 0.82591724, 'precision': 0.82587516, 'recall': 0.82585764, 'specificity': 0.82585764, 'f1': 0.82586586, 'auroc': 0.8743167, 'binary_precision': 0.8235294, 'binary_recall': 0.82222223, 'binary_specificity': 0.8294931, 'binary_f1_score': 0.82287526}
confusion matrix:
     0    1
0  540  111
1  112  518
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8155556, 'precision': 0.8263934, 'recall': 0.8155556, 'specificity': 0.8155556, 'f1': 0.8140116, 'auroc': 0.8920889, 'binary_precision': 0.7669173, 'binary_recall': 0.9066667, 'binary_specificity': 0.72444445, 'binary_f1_score': 0.83095723}
confusion matrix:
     0    1
0  163   62
1   21  204
early stop counter: 3
val acc:0.8259172439575195, best validation acc: 0.8618267178535461, corresponding to test acc:                         0.8288888931274414 / 0.851111114025116
after epoch: 14,now: 2024-07-27 14:34:01.491830,epoch time: 0:02:02.593282,used: 0:28:41.645218,model: dset_te_center0_dann_b8efecac6_not_commited_2024md_07md_27_14_05_19_seed_1_23099039
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9817708, 'precision': 0.98178804, 'recall': 0.98174727, 'specificity': 0.98174727, 'f1': 0.981766, 'auroc': 0.9985997, 'binary_precision': 0.9808061, 'binary_recall': 0.9833226, 'binary_specificity': 0.98017186, 'binary_f1_score': 0.9820627}
confusion matrix:
      0     1
0  1483    30
1    26  1533
---- Validation: 
scalar performance:
{'acc': 0.8173302, 'precision': 0.8225179, 'recall': 0.8183564, 'specificity': 0.8183564, 'f1': 0.8168873, 'auroc': 0.88141686, 'binary_precision': 0.7773109, 'binary_recall': 0.88095236, 'binary_specificity': 0.7557604, 'binary_f1_score': 0.82589287}
confusion matrix:
     0    1
0  492  159
1   75  555
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.78444445, 'precision': 0.78571427, 'recall': 0.78444445, 'specificity': 0.78444445, 'f1': 0.7842047, 'auroc': 0.8353778, 'binary_precision': 0.76666665, 'binary_recall': 0.81777775, 'binary_specificity': 0.7511111, 'binary_f1_score': 0.79139787}
confusion matrix:
     0    1
0  169   56
1   41  184
early stop counter: 4
val acc:0.8173301815986633, best validation acc: 0.8618267178535461, corresponding to test acc:                         0.8288888931274414 / 0.851111114025116
after epoch: 15,now: 2024-07-27 14:36:04.229009,epoch time: 0:02:02.737179,used: 0:30:44.382397,model: dset_te_center0_dann_b8efecac6_not_commited_2024md_07md_27_14_05_19_seed_1_23099039
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9791667, 'precision': 0.97940165, 'recall': 0.9790529, 'specificity': 0.9790529, 'f1': 0.97915703, 'auroc': 0.99840474, 'binary_precision': 0.971555, 'binary_recall': 0.9877892, 'binary_specificity': 0.97031665, 'binary_f1_score': 0.97960484}
confusion matrix:
      0     1
0  1471    45
1    19  1537
---- Validation: 
scalar performance:
{'acc': 0.83138174, 'precision': 0.83675694, 'recall': 0.83241165, 'specificity': 0.83241165, 'f1': 0.8309729, 'auroc': 0.87658787, 'binary_precision': 0.789916, 'binary_recall': 0.8952381, 'binary_specificity': 0.76958525, 'binary_f1_score': 0.8392857}
confusion matrix:
     0    1
0  501  150
1   66  564
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.82222223, 'precision': 0.8223241, 'recall': 0.82222223, 'specificity': 0.82222223, 'f1': 0.8222081, 'auroc': 0.8721185, 'binary_precision': 0.8280543, 'binary_recall': 0.81333333, 'binary_specificity': 0.83111113, 'binary_f1_score': 0.82062775}
confusion matrix:
     0    1
0  187   38
1   42  183
early stop counter: 5
val acc:0.8313817381858826, best validation acc: 0.8618267178535461, corresponding to test acc:                         0.8288888931274414 / 0.851111114025116
after epoch: 16,now: 2024-07-27 14:38:06.857661,epoch time: 0:02:02.628652,used: 0:32:47.011049,model: dset_te_center0_dann_b8efecac6_not_commited_2024md_07md_27_14_05_19_seed_1_23099039
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 16 with time: 0:32:47.011049 at 2024-07-27 14:38:06.857661
persisted model performance metric: 

scalar performance:
{'acc': 0.8288889, 'precision': 0.82894737, 'recall': 0.8288889, 'specificity': 0.8288889, 'f1': 0.8288813, 'auroc': 0.8846222, 'binary_precision': 0.8333333, 'binary_recall': 0.82222223, 'binary_specificity': 0.83555555, 'binary_f1_score': 0.82774055}
confusion matrix:
     0    1
0  188   37
1   40  185
oracle model performance metric: 

scalar performance:
{'acc': 0.8511111, 'precision': 0.88097996, 'recall': 0.8511111, 'specificity': 0.8511111, 'f1': 0.8481345, 'auroc': 0.93226665, 'binary_precision': 0.9876543, 'binary_recall': 0.7111111, 'binary_specificity': 0.9911111, 'binary_f1_score': 0.82687336}
confusion matrix:
     0    1
0  223    2
1   65  160
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_10seeds_nofreeze_2024-07-27_13-09-31/rule_results/7.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_10seeds_nofreeze_2024-07-27_13-09-31/confusion_matrix/7.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 454480 KiB |   3602 MiB |  78970 GiB |  78969 GiB |
|       from large pool | 413871 KiB |   3568 MiB |  78063 GiB |  78063 GiB |
|       from small pool |  40608 KiB |     60 MiB |    906 GiB |    906 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 454480 KiB |   3602 MiB |  78970 GiB |  78969 GiB |
|       from large pool | 413871 KiB |   3568 MiB |  78063 GiB |  78063 GiB |
|       from small pool |  40608 KiB |     60 MiB |    906 GiB |    906 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 447482 KiB |   3596 MiB |  78843 GiB |  78843 GiB |
|       from large pool | 407075 KiB |   3563 MiB |  77938 GiB |  77938 GiB |
|       from small pool |  40407 KiB |     60 MiB |    905 GiB |    905 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   4008 MiB |   4016 MiB |   7238 MiB |   3230 MiB |
|       from large pool |   3940 MiB |   3952 MiB |   7152 MiB |   3212 MiB |
|       from small pool |     68 MiB |     68 MiB |     86 MiB |     18 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 350384 KiB | 496525 KiB |  55165 GiB |  55165 GiB |
|       from large pool | 341840 KiB | 492852 KiB |  54238 GiB |  54238 GiB |
|       from small pool |   8543 KiB |  22317 KiB |    927 GiB |    927 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    1330    |    1709    |   13859 K  |   13858 K  |
|       from large pool |     187    |     468    |    7215 K  |    7215 K  |
|       from small pool |    1143    |    1447    |    6643 K  |    6642 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    1330    |    1709    |   13859 K  |   13858 K  |
|       from large pool |     187    |     468    |    7215 K  |    7215 K  |
|       from small pool |    1143    |    1447    |    6643 K  |    6642 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     200    |     200    |     341    |     141    |
|       from large pool |     166    |     166    |     298    |     132    |
|       from small pool |      34    |      34    |      43    |       9    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      83    |     249    |    7898 K  |    7898 K  |
|       from large pool |      34    |     165    |    4640 K  |    4640 K  |
|       from small pool |      49    |     218    |    3258 K  |    3258 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   3602 MiB |  78970 GiB |  78970 GiB |
|       from large pool |  16640 KiB |   3568 MiB |  78063 GiB |  78063 GiB |
|       from small pool |      0 KiB |     60 MiB |    906 GiB |    906 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   3602 MiB |  78970 GiB |  78970 GiB |
|       from large pool |  16640 KiB |   3568 MiB |  78063 GiB |  78063 GiB |
|       from small pool |      0 KiB |     60 MiB |    906 GiB |    906 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   3596 MiB |  78843 GiB |  78843 GiB |
|       from large pool |  16640 KiB |   3563 MiB |  77938 GiB |  77938 GiB |
|       from small pool |      0 KiB |     60 MiB |    905 GiB |    905 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    786 MiB |   4016 MiB |   7238 MiB |   6452 MiB |
|       from large pool |    738 MiB |   3952 MiB |   7152 MiB |   6414 MiB |
|       from small pool |     48 MiB |     68 MiB |     86 MiB |     38 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 496525 KiB |  55166 GiB |  55166 GiB |
|       from large pool |  24320 KiB | 492852 KiB |  54238 GiB |  54238 GiB |
|       from small pool |      0 KiB |  32850 KiB |    927 GiB |    927 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    1709    |   13859 K  |   13859 K  |
|       from large pool |       2    |     468    |    7215 K  |    7215 K  |
|       from small pool |       0    |    1447    |    6643 K  |    6643 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    1709    |   13859 K  |   13859 K  |
|       from large pool |       2    |     468    |    7215 K  |    7215 K  |
|       from small pool |       0    |    1447    |    6643 K  |    6643 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      57    |     200    |     341    |     284    |
|       from large pool |      33    |     166    |     298    |     265    |
|       from small pool |      24    |      34    |      43    |      19    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     249    |    7899 K  |    7899 K  |
|       from large pool |       3    |     165    |    4640 K  |    4640 K  |
|       from small pool |       0    |     218    |    3258 K  |    3258 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   3602 MiB |  78970 GiB |  78970 GiB |
|       from large pool |  16640 KiB |   3568 MiB |  78063 GiB |  78063 GiB |
|       from small pool |      0 KiB |     60 MiB |    906 GiB |    906 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   3602 MiB |  78970 GiB |  78970 GiB |
|       from large pool |  16640 KiB |   3568 MiB |  78063 GiB |  78063 GiB |
|       from small pool |      0 KiB |     60 MiB |    906 GiB |    906 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   3596 MiB |  78843 GiB |  78843 GiB |
|       from large pool |  16640 KiB |   3563 MiB |  77938 GiB |  77938 GiB |
|       from small pool |      0 KiB |     60 MiB |    905 GiB |    905 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    786 MiB |   4016 MiB |   7238 MiB |   6452 MiB |
|       from large pool |    738 MiB |   3952 MiB |   7152 MiB |   6414 MiB |
|       from small pool |     48 MiB |     68 MiB |     86 MiB |     38 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 496525 KiB |  55166 GiB |  55166 GiB |
|       from large pool |  24320 KiB | 492852 KiB |  54238 GiB |  54238 GiB |
|       from small pool |      0 KiB |  32850 KiB |    927 GiB |    927 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    1709    |   13859 K  |   13859 K  |
|       from large pool |       2    |     468    |    7215 K  |    7215 K  |
|       from small pool |       0    |    1447    |    6643 K  |    6643 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    1709    |   13859 K  |   13859 K  |
|       from large pool |       2    |     468    |    7215 K  |    7215 K  |
|       from small pool |       0    |    1447    |    6643 K  |    6643 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      57    |     200    |     341    |     284    |
|       from large pool |      33    |     166    |     298    |     265    |
|       from small pool |      24    |      34    |      43    |      19    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     249    |    7899 K  |    7899 K  |
|       from large pool |       3    |     165    |    4640 K  |    4640 K  |
|       from small pool |       0    |     218    |    3258 K  |    3258 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center0_dann_b8efecac6_not_commited_2024md_07md_27_14_38_37_seed_2_23099039

 Experiment start at: 2024-07-27 14:38:37.847199
before training, model accuracy: 0.5254629850387573
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.89757854, 'precision': 0.9011554, 'recall': 0.8979552, 'specificity': 0.8979552, 'f1': 0.8974069, 'auroc': 0.92018163, 'binary_precision': 0.9410496, 'binary_recall': 0.85, 'binary_specificity': 0.9459103, 'binary_f1_score': 0.89321053}
confusion matrix:
      0     1
0  1434    82
1   231  1309
---- Validation: 
scalar performance:
{'acc': 0.68935835, 'precision': 0.74156994, 'recall': 0.6953254, 'specificity': 0.6953254, 'f1': 0.67562103, 'auroc': 0.794994, 'binary_precision': 0.62241566, 'binary_recall': 0.91961414, 'binary_specificity': 0.47103658, 'binary_f1_score': 0.742375}
confusion matrix:
     0    1
0  309  347
1   50  572
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6712963, 'precision': 0.7407229, 'recall': 0.6712963, 'specificity': 0.6712963, 'f1': 0.64575446, 'auroc': 0.7763524, 'binary_precision': 0.6114458, 'binary_recall': 0.9398148, 'binary_specificity': 0.4027778, 'binary_f1_score': 0.74087596}
confusion matrix:
    0    1
0  87  129
1  13  203
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-27 14:40:43.028619,epoch time: 0:02:05.181420,used: 0:02:05.181420,model: dset_te_center0_dann_b8efecac6_not_commited_2024md_07md_27_14_38_37_seed_2_23099039
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.4960733, 'precision': 0.24803665, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.33158356, 'auroc': 0.5, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  1516  0
1  1540  0
---- Validation: 
scalar performance:
{'acc': 0.513302, 'precision': 0.256651, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.33919337, 'auroc': 0.5, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
     0  1
0  656  0
1  622  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5, 'precision': 0.25, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.33333334, 'auroc': 0.5, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
     0  1
0  216  0
1  216  0
early stop counter: 1
val acc:0.5133020281791687, best validation acc: 0.6893583536148071, corresponding to test acc:                         0.6712962985038757 / 0.6712962985038757
after epoch: 2,now: 2024-07-27 14:42:44.634465,epoch time: 0:02:01.605846,used: 0:04:06.787266,model: dset_te_center0_dann_b8efecac6_not_commited_2024md_07md_27_14_38_37_seed_2_23099039
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.4960733, 'precision': 0.24803665, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.33158356, 'auroc': 0.5, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  1516  0
1  1540  0
---- Validation: 
scalar performance:
{'acc': 0.513302, 'precision': 0.256651, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.33919337, 'auroc': 0.5, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
     0  1
0  656  0
1  622  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5, 'precision': 0.25, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.33333334, 'auroc': 0.5, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
     0  1
0  216  0
1  216  0
early stop counter: 2
val acc:0.5133020281791687, best validation acc: 0.6893583536148071, corresponding to test acc:                         0.6712962985038757 / 0.6712962985038757
after epoch: 3,now: 2024-07-27 14:44:46.596875,epoch time: 0:02:01.962410,used: 0:06:08.749676,model: dset_te_center0_dann_b8efecac6_not_commited_2024md_07md_27_14_38_37_seed_2_23099039
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.4960733, 'precision': 0.24803665, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.33158356, 'auroc': 0.5, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  1516  0
1  1540  0
---- Validation: 
scalar performance:
{'acc': 0.513302, 'precision': 0.256651, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.33919337, 'auroc': 0.5, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
     0  1
0  656  0
1  622  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5, 'precision': 0.25, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.33333334, 'auroc': 0.5, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
     0  1
0  216  0
1  216  0
early stop counter: 3
val acc:0.5133020281791687, best validation acc: 0.6893583536148071, corresponding to test acc:                         0.6712962985038757 / 0.6712962985038757
after epoch: 4,now: 2024-07-27 14:46:48.068677,epoch time: 0:02:01.471802,used: 0:08:10.221478,model: dset_te_center0_dann_b8efecac6_not_commited_2024md_07md_27_14_38_37_seed_2_23099039
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.4960733, 'precision': 0.24803665, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.33158356, 'auroc': 0.5, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  1516  0
1  1540  0
---- Validation: 
scalar performance:
{'acc': 0.513302, 'precision': 0.256651, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.33919337, 'auroc': 0.5, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
     0  1
0  656  0
1  622  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5, 'precision': 0.25, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.33333334, 'auroc': 0.5, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
     0  1
0  216  0
1  216  0
early stop counter: 4
val acc:0.5133020281791687, best validation acc: 0.6893583536148071, corresponding to test acc:                         0.6712962985038757 / 0.6712962985038757
after epoch: 5,now: 2024-07-27 14:48:49.126525,epoch time: 0:02:01.057848,used: 0:10:11.279326,model: dset_te_center0_dann_b8efecac6_not_commited_2024md_07md_27_14_38_37_seed_2_23099039
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.4960733, 'precision': 0.24803665, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.33158356, 'auroc': 0.5, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  1516  0
1  1540  0
---- Validation: 
scalar performance:
{'acc': 0.513302, 'precision': 0.256651, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.33919337, 'auroc': 0.5, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
     0  1
0  656  0
1  622  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5, 'precision': 0.25, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.33333334, 'auroc': 0.5, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
     0  1
0  216  0
1  216  0
early stop counter: 5
val acc:0.5133020281791687, best validation acc: 0.6893583536148071, corresponding to test acc:                         0.6712962985038757 / 0.6712962985038757
after epoch: 6,now: 2024-07-27 14:50:50.642455,epoch time: 0:02:01.515930,used: 0:12:12.795256,model: dset_te_center0_dann_b8efecac6_not_commited_2024md_07md_27_14_38_37_seed_2_23099039
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 6 with time: 0:12:12.795256 at 2024-07-27 14:50:50.642455
persisted model performance metric: 

scalar performance:
{'acc': 0.6712963, 'precision': 0.7407229, 'recall': 0.6712963, 'specificity': 0.6712963, 'f1': 0.64575446, 'auroc': 0.7763524, 'binary_precision': 0.6114458, 'binary_recall': 0.9398148, 'binary_specificity': 0.4027778, 'binary_f1_score': 0.74087596}
confusion matrix:
    0    1
0  87  129
1  13  203
oracle model performance metric: 

scalar performance:
{'acc': 0.6712963, 'precision': 0.7407229, 'recall': 0.6712963, 'specificity': 0.6712963, 'f1': 0.64575446, 'auroc': 0.7763524, 'binary_precision': 0.6114458, 'binary_recall': 0.9398148, 'binary_specificity': 0.4027778, 'binary_f1_score': 0.74087596}
confusion matrix:
    0    1
0  87  129
1  13  203
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_10seeds_nofreeze_2024-07-27_13-09-31/rule_results/7.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_10seeds_nofreeze_2024-07-27_13-09-31/confusion_matrix/7.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 454625 KiB |   3602 MiB | 100536 GiB | 100536 GiB |
|       from large pool | 414023 KiB |   3569 MiB |  99383 GiB |  99383 GiB |
|       from small pool |  40602 KiB |     60 MiB |   1153 GiB |   1153 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 454625 KiB |   3602 MiB | 100536 GiB | 100536 GiB |
|       from large pool | 414023 KiB |   3569 MiB |  99383 GiB |  99383 GiB |
|       from small pool |  40602 KiB |     60 MiB |   1153 GiB |   1153 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 447481 KiB |   3596 MiB | 100316 GiB | 100316 GiB |
|       from large pool | 407075 KiB |   3563 MiB |  99165 GiB |  99164 GiB |
|       from small pool |  40406 KiB |     60 MiB |   1151 GiB |   1151 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   4002 MiB |   4016 MiB |  10454 MiB |   6452 MiB |
|       from large pool |   3938 MiB |   3952 MiB |  10352 MiB |   6414 MiB |
|       from small pool |     64 MiB |     68 MiB |    102 MiB |     38 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 391198 KiB | 496525 KiB |  70477 GiB |  70477 GiB |
|       from large pool | 382649 KiB | 492852 KiB |  69298 GiB |  69298 GiB |
|       from small pool |   8549 KiB |  32850 KiB |   1179 GiB |   1179 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    1318    |    1709    |   17633 K  |   17631 K  |
|       from large pool |     187    |     468    |    9181 K  |    9180 K  |
|       from small pool |    1131    |    1447    |    8452 K  |    8451 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    1318    |    1709    |   17633 K  |   17631 K  |
|       from large pool |     187    |     468    |    9181 K  |    9180 K  |
|       from small pool |    1131    |    1447    |    8452 K  |    8451 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     197    |     200    |     481    |     284    |
|       from large pool |     165    |     166    |     430    |     265    |
|       from small pool |      32    |      34    |      51    |      19    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      84    |     251    |    9973 K  |    9972 K  |
|       from large pool |      34    |     165    |    5864 K  |    5864 K  |
|       from small pool |      50    |     218    |    4108 K  |    4108 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   3602 MiB | 100536 GiB | 100536 GiB |
|       from large pool |  16640 KiB |   3569 MiB |  99383 GiB |  99383 GiB |
|       from small pool |      0 KiB |     60 MiB |   1153 GiB |   1153 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   3602 MiB | 100536 GiB | 100536 GiB |
|       from large pool |  16640 KiB |   3569 MiB |  99383 GiB |  99383 GiB |
|       from small pool |      0 KiB |     60 MiB |   1153 GiB |   1153 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   3596 MiB | 100316 GiB | 100316 GiB |
|       from large pool |  16640 KiB |   3563 MiB |  99165 GiB |  99165 GiB |
|       from small pool |      0 KiB |     60 MiB |   1151 GiB |   1151 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    826 MiB |   4016 MiB |  10454 MiB |   9628 MiB |
|       from large pool |    778 MiB |   3952 MiB |  10352 MiB |   9574 MiB |
|       from small pool |     48 MiB |     68 MiB |    102 MiB |     54 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 496525 KiB |  70477 GiB |  70477 GiB |
|       from large pool |  24320 KiB | 492852 KiB |  69298 GiB |  69298 GiB |
|       from small pool |      0 KiB |  36677 KiB |   1179 GiB |   1179 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    1709    |   17633 K  |   17633 K  |
|       from large pool |       2    |     468    |    9181 K  |    9181 K  |
|       from small pool |       0    |    1447    |    8452 K  |    8452 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    1709    |   17633 K  |   17633 K  |
|       from large pool |       2    |     468    |    9181 K  |    9181 K  |
|       from small pool |       0    |    1447    |    8452 K  |    8452 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      59    |     200    |     481    |     422    |
|       from large pool |      35    |     166    |     430    |     395    |
|       from small pool |      24    |      34    |      51    |      27    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     251    |    9973 K  |    9973 K  |
|       from large pool |       3    |     165    |    5864 K  |    5864 K  |
|       from small pool |       0    |     218    |    4108 K  |    4108 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Sat Jul 27 14:50:57 2024]
Finished job 0.
1 of 1 steps (100%) done
