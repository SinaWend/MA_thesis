Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Tue Jul 23 10:49:52 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_dial_lr1e5_bs32__45_nofreeze_2024-07-23_10-43-50/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_dial_lr1e5_bs32__45_nofreeze_2024-07-23_10-43-50/rule_results/4.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=4
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/swiglu_ffn.py:51: UserWarning: xFormers is not available (SwiGLU)
  warnings.warn("xFormers is not available (SwiGLU)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/attention.py:33: UserWarning: xFormers is not available (Attention)
  warnings.warn("xFormers is not available (Attention)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/block.py:40: UserWarning: xFormers is not available (Block)
  warnings.warn("xFormers is not available (Block)")
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'888c1ef2'
model name: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_10_54_22_seed_0_22795134

 Experiment start at: 2024-07-23 10:54:22.660139
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
before training, model accuracy: 0.569767415523529
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.93847656, 'precision': 0.941581, 'recall': 0.93899083, 'specificity': 0.93899083, 'f1': 0.93841004, 'auroc': 0.98711514, 'binary_precision': 0.98165137, 'binary_recall': 0.8951094, 'binary_specificity': 0.9828722, 'binary_f1_score': 0.93638504}
confusion matrix:
      0     1
0  1492    26
1   163  1391
---- Validation: 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
scalar performance:
{'acc': 0.83618015, 'precision': 0.83740246, 'recall': 0.8357466, 'specificity': 0.8357466, 'f1': 0.8358808, 'auroc': 0.91293246, 'binary_precision': 0.8545151, 'binary_recall': 0.8047244, 'binary_specificity': 0.8667688, 'binary_f1_score': 0.8288726}
confusion matrix:
     0    1
0  566   87
1  124  511
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8604651, 'precision': 0.8604963, 'recall': 0.86046517, 'specificity': 0.86046517, 'f1': 0.8604621, 'auroc': 0.9240887, 'binary_precision': 0.86384976, 'binary_recall': 0.855814, 'binary_specificity': 0.8651163, 'binary_f1_score': 0.8598131}
confusion matrix:
     0    1
0  186   29
1   31  184
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-23 10:57:16.325550,epoch time: 0:02:53.665411,used: 0:02:53.665411,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_10_54_22_seed_0_22795134
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.960612, 'precision': 0.9607909, 'recall': 0.9605078, 'specificity': 0.9605078, 'f1': 0.9605954, 'auroc': 0.99374074, 'binary_precision': 0.9544015, 'binary_recall': 0.968509, 'binary_specificity': 0.9525066, 'binary_f1_score': 0.96140355}
confusion matrix:
      0     1
0  1444    72
1    49  1507
---- Validation: 
scalar performance:
{'acc': 0.79891306, 'precision': 0.80741024, 'recall': 0.8000567, 'specificity': 0.8000567, 'f1': 0.79790425, 'auroc': 0.8884181, 'binary_precision': 0.75268817, 'binary_recall': 0.88188976, 'binary_specificity': 0.7182236, 'binary_f1_score': 0.81218266}
confusion matrix:
     0    1
0  469  184
1   75  560
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.82325584, 'precision': 0.83367944, 'recall': 0.8232558, 'specificity': 0.8232558, 'f1': 0.8218646, 'auroc': 0.92203355, 'binary_precision': 0.77470356, 'binary_recall': 0.9116279, 'binary_specificity': 0.7348837, 'binary_f1_score': 0.8376068}
confusion matrix:
     0    1
0  158   57
1   19  196
early stop counter: 1
val acc:0.7989130616188049, best validation acc: 0.8361801505088806, corresponding to test acc:                         0.8604651093482971 / 0.8604651093482971
after epoch: 2,now: 2024-07-23 10:58:50.027586,epoch time: 0:01:33.702036,used: 0:04:27.367447,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_10_54_22_seed_0_22795134
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.97233075, 'precision': 0.97233903, 'recall': 0.9723144, 'specificity': 0.9723144, 'f1': 0.9723258, 'auroc': 0.99647385, 'binary_precision': 0.97175866, 'binary_recall': 0.97363347, 'binary_specificity': 0.97099537, 'binary_f1_score': 0.9726952}
confusion matrix:
      0     1
0  1473    44
1    41  1514
---- Validation: 
scalar performance:
{'acc': 0.8206522, 'precision': 0.82126546, 'recall': 0.8203241, 'specificity': 0.8203241, 'f1': 0.82043296, 'auroc': 0.8900483, 'binary_precision': 0.8322368, 'binary_recall': 0.7968504, 'binary_specificity': 0.84379786, 'binary_f1_score': 0.8141593}
confusion matrix:
     0    1
0  551  102
1  129  506
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.83488375, 'precision': 0.8394737, 'recall': 0.8348837, 'specificity': 0.8348837, 'f1': 0.8343237, 'auroc': 0.9332396, 'binary_precision': 0.8, 'binary_recall': 0.89302325, 'binary_specificity': 0.7767442, 'binary_f1_score': 0.84395605}
confusion matrix:
     0    1
0  167   48
1   23  192
early stop counter: 2
val acc:0.820652186870575, best validation acc: 0.8361801505088806, corresponding to test acc:                         0.8604651093482971 / 0.8604651093482971
after epoch: 3,now: 2024-07-23 11:00:07.851287,epoch time: 0:01:17.823701,used: 0:05:45.191148,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_10_54_22_seed_0_22795134
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.94596356, 'precision': 0.9504149, 'recall': 0.9466411, 'specificity': 0.9466411, 'f1': 0.94587815, 'auroc': 0.99761415, 'binary_precision': 0.99856526, 'binary_recall': 0.8946015, 'binary_specificity': 0.9986807, 'binary_f1_score': 0.9437288}
confusion matrix:
      0     1
0  1514     2
1   164  1392
---- Validation: 
scalar performance:
{'acc': 0.5659938, 'precision': 0.71763146, 'recall': 0.56005955, 'specificity': 0.56005955, 'f1': 0.46615654, 'auroc': 0.85448384, 'binary_precision': 0.8958333, 'binary_recall': 0.13543308, 'binary_specificity': 0.9846861, 'binary_f1_score': 0.23529412}
confusion matrix:
     0   1
0  643  10
1  549  86
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.80465114, 'precision': 0.8431325, 'recall': 0.80465114, 'specificity': 0.80465114, 'f1': 0.79901624, 'auroc': 0.9130557, 'binary_precision': 0.95804197, 'binary_recall': 0.6372093, 'binary_specificity': 0.97209305, 'binary_f1_score': 0.76536316}
confusion matrix:
     0    1
0  209    6
1   78  137
early stop counter: 3
val acc:0.5659937858581543, best validation acc: 0.8361801505088806, corresponding to test acc:                         0.8604651093482971 / 0.8604651093482971
after epoch: 4,now: 2024-07-23 11:01:27.433451,epoch time: 0:01:19.582164,used: 0:07:04.773312,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_10_54_22_seed_0_22795134
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.960612, 'precision': 0.9629548, 'recall': 0.96110976, 'specificity': 0.96110976, 'f1': 0.9605859, 'auroc': 0.99649924, 'binary_precision': 0.9993041, 'binary_recall': 0.92287916, 'binary_specificity': 0.99934036, 'binary_f1_score': 0.9595723}
confusion matrix:
      0     1
0  1515     1
1   120  1436
---- Validation: 
scalar performance:
{'acc': 0.5667702, 'precision': 0.7410395, 'recall': 0.56073844, 'specificity': 0.56073844, 'f1': 0.46308798, 'auroc': 0.87838566, 'binary_precision': 0.9425287, 'binary_recall': 0.12913387, 'binary_specificity': 0.992343, 'binary_f1_score': 0.22714683}
confusion matrix:
     0   1
0  648   5
1  553  82
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6976744, 'precision': 0.791551, 'recall': 0.6976744, 'specificity': 0.6976744, 'f1': 0.6712074, 'auroc': 0.8836993, 'binary_precision': 0.9569892, 'binary_recall': 0.41395348, 'binary_specificity': 0.98139536, 'binary_f1_score': 0.5779221}
confusion matrix:
     0   1
0  211   4
1  126  89
early stop counter: 4
val acc:0.5667701959609985, best validation acc: 0.8361801505088806, corresponding to test acc:                         0.8604651093482971 / 0.8604651093482971
after epoch: 5,now: 2024-07-23 11:02:42.113798,epoch time: 0:01:14.680347,used: 0:08:19.453659,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_10_54_22_seed_0_22795134
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.96809894, 'precision': 0.9689982, 'recall': 0.96782196, 'specificity': 0.96782196, 'f1': 0.9680638, 'auroc': 0.9964266, 'binary_precision': 0.9517327, 'binary_recall': 0.987163, 'binary_specificity': 0.94848084, 'binary_f1_score': 0.96912414}
confusion matrix:
      0     1
0  1436    78
1    20  1538
---- Validation: 
scalar performance:
{'acc': 0.85947204, 'precision': 0.8628231, 'recall': 0.86015, 'specificity': 0.86015, 'f1': 0.85928464, 'auroc': 0.92560565, 'binary_precision': 0.8242857, 'binary_recall': 0.9086614, 'binary_specificity': 0.8116386, 'binary_f1_score': 0.86441946}
confusion matrix:
     0    1
0  530  123
1   58  577
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.84418607, 'precision': 0.8447902, 'recall': 0.84418607, 'specificity': 0.84418607, 'f1': 0.84411776, 'auroc': 0.9291725, 'binary_precision': 0.83035713, 'binary_recall': 0.8651163, 'binary_specificity': 0.82325584, 'binary_f1_score': 0.8473804}
confusion matrix:
     0    1
0  177   38
1   29  186
better model found
persisted
after epoch: 6,now: 2024-07-23 11:03:56.630543,epoch time: 0:01:14.516745,used: 0:09:33.970404,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_10_54_22_seed_0_22795134
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9840495, 'precision': 0.9840423, 'recall': 0.9841155, 'specificity': 0.9841155, 'f1': 0.9840487, 'auroc': 0.9989152, 'binary_precision': 0.9895969, 'binary_recall': 0.9787781, 'binary_specificity': 0.98945284, 'binary_f1_score': 0.9841578}
confusion matrix:
      0     1
0  1501    16
1    33  1522
---- Validation: 
scalar performance:
{'acc': 0.8369565, 'precision': 0.8443299, 'recall': 0.83592623, 'specificity': 0.83592623, 'f1': 0.83575857, 'auroc': 0.8995141, 'binary_precision': 0.89134437, 'binary_recall': 0.7622047, 'binary_specificity': 0.90964776, 'binary_f1_score': 0.8217317}
confusion matrix:
     0    1
0  594   59
1  151  484
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.87906975, 'precision': 0.8823786, 'recall': 0.8790698, 'specificity': 0.8790698, 'f1': 0.87880754, 'auroc': 0.930622, 'binary_precision': 0.9179487, 'binary_recall': 0.83255816, 'binary_specificity': 0.9255814, 'binary_f1_score': 0.87317073}
confusion matrix:
     0    1
0  199   16
1   36  179
new oracle model saved
early stop counter: 1
val acc:0.8369565010070801, best validation acc: 0.8594720363616943, corresponding to test acc:                         0.8441860675811768 / 0.8790697455406189
after epoch: 7,now: 2024-07-23 11:05:11.488298,epoch time: 0:01:14.857755,used: 0:10:48.828159,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_10_54_22_seed_0_22795134
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.97786456, 'precision': 0.97845113, 'recall': 0.97768605, 'specificity': 0.97768605, 'f1': 0.9778488, 'auroc': 0.9986439, 'binary_precision': 0.964375, 'binary_recall': 0.9929215, 'binary_specificity': 0.96245056, 'binary_f1_score': 0.9784401}
confusion matrix:
      0     1
0  1461    57
1    11  1543
---- Validation: 
scalar performance:
{'acc': 0.7864907, 'precision': 0.80034316, 'recall': 0.7849622, 'specificity': 0.7849622, 'f1': 0.7833532, 'auroc': 0.88063085, 'binary_precision': 0.8614458, 'binary_recall': 0.6755906, 'binary_specificity': 0.89433384, 'binary_f1_score': 0.75728154}
confusion matrix:
     0    1
0  584   69
1  206  429
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8604651, 'precision': 0.86059, 'recall': 0.8604651, 'specificity': 0.8604651, 'f1': 0.860453, 'auroc': 0.9246944, 'binary_precision': 0.8672986, 'binary_recall': 0.8511628, 'binary_specificity': 0.8697674, 'binary_f1_score': 0.85915494}
confusion matrix:
     0    1
0  187   28
1   32  183
early stop counter: 2
val acc:0.7864906787872314, best validation acc: 0.8594720363616943, corresponding to test acc:                         0.8441860675811768 / 0.8790697455406189
after epoch: 8,now: 2024-07-23 11:06:26.235839,epoch time: 0:01:14.747541,used: 0:12:03.575700,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_10_54_22_seed_0_22795134
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9811198, 'precision': 0.98151076, 'recall': 0.9813343, 'specificity': 0.9813343, 'f1': 0.9811193, 'auroc': 0.9990746, 'binary_precision': 0.99866754, 'binary_recall': 0.9639871, 'binary_specificity': 0.9986816, 'binary_f1_score': 0.9810209}
confusion matrix:
      0     1
0  1515     2
1    56  1499
---- Validation: 
scalar performance:
{'acc': 0.76863354, 'precision': 0.8171147, 'recall': 0.7658752, 'specificity': 0.7658752, 'f1': 0.7581632, 'auroc': 0.9192413, 'binary_precision': 0.93766236, 'binary_recall': 0.5685039, 'binary_specificity': 0.9632466, 'binary_f1_score': 0.7078431}
confusion matrix:
     0    1
0  629   24
1  274  361
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8395349, 'precision': 0.86150265, 'recall': 0.8395349, 'specificity': 0.8395349, 'f1': 0.8370595, 'auroc': 0.92661977, 'binary_precision': 0.9506173, 'binary_recall': 0.7162791, 'binary_specificity': 0.96279067, 'binary_f1_score': 0.8169762}
confusion matrix:
     0    1
0  207    8
1   61  154
early stop counter: 3
val acc:0.7686335444450378, best validation acc: 0.8594720363616943, corresponding to test acc:                         0.8441860675811768 / 0.8790697455406189
after epoch: 9,now: 2024-07-23 11:07:41.027114,epoch time: 0:01:14.791275,used: 0:13:18.366975,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_10_54_22_seed_0_22795134
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.98535156, 'precision': 0.9853263, 'recall': 0.98540914, 'specificity': 0.98540914, 'f1': 0.9853501, 'auroc': 0.998378, 'binary_precision': 0.989644, 'binary_recall': 0.98138636, 'binary_specificity': 0.989432, 'binary_f1_score': 0.9854979}
confusion matrix:
      0     1
0  1498    16
1    29  1529
---- Validation: 
scalar performance:
{'acc': 0.7748447, 'precision': 0.81656224, 'recall': 0.77228296, 'specificity': 0.77228296, 'f1': 0.76602995, 'auroc': 0.90868795, 'binary_precision': 0.9280397, 'binary_recall': 0.5889764, 'binary_specificity': 0.9555896, 'binary_f1_score': 0.7206166}
confusion matrix:
     0    1
0  624   29
1  261  374
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.83488375, 'precision': 0.8663385, 'recall': 0.8348837, 'specificity': 0.8348837, 'f1': 0.83126163, 'auroc': 0.9224446, 'binary_precision': 0.9736842, 'binary_recall': 0.6883721, 'binary_specificity': 0.98139536, 'binary_f1_score': 0.80653954}
confusion matrix:
     0    1
0  211    4
1   67  148
early stop counter: 4
val acc:0.7748447060585022, best validation acc: 0.8594720363616943, corresponding to test acc:                         0.8441860675811768 / 0.8790697455406189
after epoch: 10,now: 2024-07-23 11:08:55.851477,epoch time: 0:01:14.824363,used: 0:14:33.191338,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_10_54_22_seed_0_22795134
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.98860675, 'precision': 0.988631, 'recall': 0.988693, 'specificity': 0.988693, 'f1': 0.9886066, 'auroc': 0.9992777, 'binary_precision': 0.996081, 'binary_recall': 0.9813385, 'binary_specificity': 0.99604744, 'binary_f1_score': 0.9886548}
confusion matrix:
      0     1
0  1512     6
1    29  1525
---- Validation: 
scalar performance:
{'acc': 0.64052796, 'precision': 0.7288271, 'recall': 0.6361059, 'specificity': 0.6361059, 'f1': 0.59798384, 'auroc': 0.8385211, 'binary_precision': 0.86752135, 'binary_recall': 0.31968504, 'binary_specificity': 0.9525268, 'binary_f1_score': 0.46720368}
confusion matrix:
     0    1
0  622   31
1  432  203
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8116279, 'precision': 0.84089833, 'recall': 0.81162786, 'specificity': 0.81162786, 'f1': 0.8074956, 'auroc': 0.91167116, 'binary_precision': 0.94078946, 'binary_recall': 0.66511625, 'binary_specificity': 0.95813954, 'binary_f1_score': 0.77929145}
confusion matrix:
     0    1
0  206    9
1   72  143
early stop counter: 5
val acc:0.6405279636383057, best validation acc: 0.8594720363616943, corresponding to test acc:                         0.8441860675811768 / 0.8790697455406189
after epoch: 11,now: 2024-07-23 11:10:10.498828,epoch time: 0:01:14.647351,used: 0:15:47.838689,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_10_54_22_seed_0_22795134
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9899089, 'precision': 0.9898976, 'recall': 0.98991936, 'specificity': 0.98991936, 'f1': 0.9899075, 'auroc': 0.9996197, 'binary_precision': 0.9909794, 'binary_recall': 0.9890675, 'binary_specificity': 0.99077123, 'binary_f1_score': 0.99002254}
confusion matrix:
      0     1
0  1503    14
1    17  1538
---- Validation: 
scalar performance:
{'acc': 0.7507764, 'precision': 0.8054862, 'recall': 0.7477867, 'specificity': 0.7477867, 'f1': 0.73756385, 'auroc': 0.88597083, 'binary_precision': 0.9313187, 'binary_recall': 0.53385824, 'binary_specificity': 0.96171516, 'binary_f1_score': 0.6786787}
confusion matrix:
     0    1
0  628   25
1  296  339
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.86744183, 'precision': 0.8858824, 'recall': 0.8674419, 'specificity': 0.8674419, 'f1': 0.865839, 'auroc': 0.92186046, 'binary_precision': 0.9702381, 'binary_recall': 0.75813955, 'binary_specificity': 0.9767442, 'binary_f1_score': 0.85117495}
confusion matrix:
     0    1
0  210    5
1   52  163
early stop counter: 6
val acc:0.7507764101028442, best validation acc: 0.8594720363616943, corresponding to test acc:                         0.8441860675811768 / 0.8790697455406189
after epoch: 12,now: 2024-07-23 11:11:26.366622,epoch time: 0:01:15.867794,used: 0:17:03.706483,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_10_54_22_seed_0_22795134
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9866536, 'precision': 0.98666954, 'recall': 0.98676753, 'specificity': 0.98676753, 'f1': 0.98665315, 'auroc': 0.9990911, 'binary_precision': 0.9947815, 'binary_recall': 0.978819, 'binary_specificity': 0.994716, 'binary_f1_score': 0.9867357}
confusion matrix:
      0     1
0  1506     8
1    33  1525
---- Validation: 
scalar performance:
{'acc': 0.8082298, 'precision': 0.8394334, 'recall': 0.80609787, 'specificity': 0.80609787, 'f1': 0.8029413, 'auroc': 0.9090714, 'binary_precision': 0.938914, 'binary_recall': 0.6535433, 'binary_specificity': 0.9586524, 'binary_f1_score': 0.7706592}
confusion matrix:
     0    1
0  626   27
1  220  415
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8581395, 'precision': 0.88131106, 'recall': 0.8581395, 'specificity': 0.8581395, 'f1': 0.8559512, 'auroc': 0.9256247, 'binary_precision': 0.97530866, 'binary_recall': 0.7348837, 'binary_specificity': 0.98139536, 'binary_f1_score': 0.8381963}
confusion matrix:
     0    1
0  211    4
1   57  158
early stop counter: 7
val acc:0.8082298040390015, best validation acc: 0.8594720363616943, corresponding to test acc:                         0.8441860675811768 / 0.8790697455406189
after epoch: 13,now: 2024-07-23 11:12:42.462213,epoch time: 0:01:16.095591,used: 0:18:19.802074,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_10_54_22_seed_0_22795134
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9860026, 'precision': 0.98617405, 'recall': 0.98618245, 'specificity': 0.98618245, 'f1': 0.98600256, 'auroc': 0.9982987, 'binary_precision': 0.99934036, 'binary_recall': 0.973025, 'binary_specificity': 0.99933994, 'binary_f1_score': 0.98600715}
confusion matrix:
      0     1
0  1514     1
1    42  1515
---- Validation: 
scalar performance:
{'acc': 0.65217394, 'precision': 0.7525432, 'recall': 0.6476999, 'specificity': 0.6476999, 'f1': 0.6098996, 'auroc': 0.8912108, 'binary_precision': 0.90829694, 'binary_recall': 0.32755905, 'binary_specificity': 0.96784073, 'binary_f1_score': 0.48148143}
confusion matrix:
     0    1
0  632   21
1  427  208
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.68139535, 'precision': 0.79383934, 'recall': 0.68139535, 'specificity': 0.68139535, 'f1': 0.64769065, 'auroc': 0.88703084, 'binary_precision': 0.9756098, 'binary_recall': 0.37209302, 'binary_specificity': 0.9906977, 'binary_f1_score': 0.53872055}
confusion matrix:
     0   1
0  213   2
1  135  80
early stop counter: 8
val acc:0.6521739363670349, best validation acc: 0.8594720363616943, corresponding to test acc:                         0.8441860675811768 / 0.8790697455406189
after epoch: 14,now: 2024-07-23 11:13:57.064796,epoch time: 0:01:14.602583,used: 0:19:34.404657,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_10_54_22_seed_0_22795134
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9892578, 'precision': 0.9892578, 'recall': 0.9893493, 'specificity': 0.9893493, 'f1': 0.98925734, 'auroc': 0.99894774, 'binary_precision': 0.99609375, 'binary_recall': 0.982659, 'binary_specificity': 0.9960396, 'binary_f1_score': 0.9893307}
confusion matrix:
      0     1
0  1509     6
1    27  1530
---- Validation: 
scalar performance:
{'acc': 0.7492236, 'precision': 0.7952481, 'recall': 0.74642897, 'specificity': 0.74642897, 'f1': 0.73760754, 'auroc': 0.8791549, 'binary_precision': 0.908377, 'binary_recall': 0.5464567, 'binary_specificity': 0.94640124, 'binary_f1_score': 0.68239915}
confusion matrix:
     0    1
0  618   35
1  288  347
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.82093024, 'precision': 0.8343023, 'recall': 0.82093024, 'specificity': 0.82093024, 'f1': 0.8191215, 'auroc': 0.89964306, 'binary_precision': 0.9011628, 'binary_recall': 0.7209302, 'binary_specificity': 0.9209302, 'binary_f1_score': 0.8010336}
confusion matrix:
     0    1
0  198   17
1   60  155
early stop counter: 9
val acc:0.7492235898971558, best validation acc: 0.8594720363616943, corresponding to test acc:                         0.8441860675811768 / 0.8790697455406189
after epoch: 15,now: 2024-07-23 11:15:12.181480,epoch time: 0:01:15.116684,used: 0:20:49.521341,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_10_54_22_seed_0_22795134
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9889323, 'precision': 0.98894244, 'recall': 0.9890419, 'specificity': 0.9890419, 'f1': 0.9889318, 'auroc': 0.9992708, 'binary_precision': 0.9967405, 'binary_recall': 0.98138636, 'binary_specificity': 0.9966975, 'binary_f1_score': 0.98900384}
confusion matrix:
      0     1
0  1509     5
1    29  1529
---- Validation: 
scalar performance:
{'acc': 0.8408385, 'precision': 0.85973865, 'recall': 0.8392338, 'specificity': 0.8392338, 'f1': 0.838248, 'auroc': 0.9213201, 'binary_precision': 0.93877554, 'binary_recall': 0.72440946, 'binary_specificity': 0.9540582, 'binary_f1_score': 0.8177778}
confusion matrix:
     0    1
0  623   30
1  175  460
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.88139534, 'precision': 0.8988688, 'recall': 0.88139534, 'specificity': 0.88139534, 'f1': 0.880082, 'auroc': 0.9416549, 'binary_precision': 0.9823529, 'binary_recall': 0.7767442, 'binary_specificity': 0.9860465, 'binary_f1_score': 0.86753243}
confusion matrix:
     0    1
0  212    3
1   48  167
new oracle model saved
early stop counter: 10
val acc:0.8408384919166565, best validation acc: 0.8594720363616943, corresponding to test acc:                         0.8441860675811768 / 0.8813953399658203
after epoch: 16,now: 2024-07-23 11:16:37.483441,epoch time: 0:01:25.301961,used: 0:22:14.823302,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_10_54_22_seed_0_22795134
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.98795575, 'precision': 0.98803383, 'recall': 0.9880787, 'specificity': 0.9880787, 'f1': 0.9879557, 'auroc': 0.999568, 'binary_precision': 0.9980315, 'binary_recall': 0.97813505, 'binary_specificity': 0.99802244, 'binary_f1_score': 0.9879831}
confusion matrix:
      0     1
0  1514     3
1    34  1521
---- Validation: 
scalar performance:
{'acc': 0.625, 'precision': 0.7541285, 'recall': 0.6199455, 'specificity': 0.6199455, 'f1': 0.5653923, 'auroc': 0.8545073, 'binary_precision': 0.9318182, 'binary_recall': 0.25826773, 'binary_specificity': 0.9816233, 'binary_f1_score': 0.404439}
confusion matrix:
     0    1
0  641   12
1  471  164
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6488372, 'precision': 0.7863803, 'recall': 0.6488372, 'specificity': 0.6488372, 'f1': 0.6009195, 'auroc': 0.891206, 'binary_precision': 0.9848485, 'binary_recall': 0.30232558, 'binary_specificity': 0.9953488, 'binary_f1_score': 0.46263346}
confusion matrix:
     0   1
0  214   1
1  150  65
early stop counter: 11
val acc:0.625, best validation acc: 0.8594720363616943, corresponding to test acc:                         0.8441860675811768 / 0.8813953399658203
after epoch: 17,now: 2024-07-23 11:18:30.347517,epoch time: 0:01:52.864076,used: 0:24:07.687378,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_10_54_22_seed_0_22795134
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9905599, 'precision': 0.99055994, 'recall': 0.990635, 'specificity': 0.990635, 'f1': 0.9905595, 'auroc': 0.9994273, 'binary_precision': 0.9967448, 'binary_recall': 0.9845659, 'binary_specificity': 0.99670404, 'binary_f1_score': 0.99061793}
confusion matrix:
      0     1
0  1512     5
1    24  1531
---- Validation: 
scalar performance:
{'acc': 0.6824534, 'precision': 0.78143513, 'recall': 0.67825663, 'specificity': 0.67825663, 'f1': 0.6487452, 'auroc': 0.89700896, 'binary_precision': 0.9448819, 'binary_recall': 0.37795275, 'binary_specificity': 0.9785605, 'binary_f1_score': 0.5399325}
confusion matrix:
     0    1
0  639   14
1  395  240
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7744186, 'precision': 0.83758247, 'recall': 0.7744186, 'specificity': 0.7744186, 'f1': 0.76334894, 'auroc': 0.9077772, 'binary_precision': 0.9836066, 'binary_recall': 0.55813956, 'binary_specificity': 0.9906977, 'binary_f1_score': 0.71216625}
confusion matrix:
     0    1
0  213    2
1   95  120
early stop counter: 12
val acc:0.6824533939361572, best validation acc: 0.8594720363616943, corresponding to test acc:                         0.8441860675811768 / 0.8813953399658203
after epoch: 18,now: 2024-07-23 11:20:23.131796,epoch time: 0:01:52.784279,used: 0:26:00.471657,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_10_54_22_seed_0_22795134
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9876302, 'precision': 0.98787785, 'recall': 0.9875122, 'specificity': 0.9875122, 'f1': 0.98762417, 'auroc': 0.99976397, 'binary_precision': 0.9797852, 'binary_recall': 0.99614644, 'binary_specificity': 0.9788779, 'binary_f1_score': 0.9878981}
confusion matrix:
      0     1
0  1483    32
1     6  1551
---- Validation: 
scalar performance:
{'acc': 0.80667704, 'precision': 0.8066927, 'recall': 0.80656326, 'specificity': 0.80656326, 'f1': 0.80660415, 'auroc': 0.87383485, 'binary_precision': 0.8073248, 'binary_recall': 0.7984252, 'binary_specificity': 0.8147014, 'binary_f1_score': 0.8028503}
confusion matrix:
     0    1
0  532  121
1  128  507
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.83488375, 'precision': 0.8357626, 'recall': 0.8348837, 'specificity': 0.8348837, 'f1': 0.83477557, 'auroc': 0.9106544, 'binary_precision': 0.8185841, 'binary_recall': 0.8604651, 'binary_specificity': 0.80930233, 'binary_f1_score': 0.83900225}
confusion matrix:
     0    1
0  174   41
1   30  185
early stop counter: 13
val acc:0.8066770434379578, best validation acc: 0.8594720363616943, corresponding to test acc:                         0.8441860675811768 / 0.8813953399658203
after epoch: 19,now: 2024-07-23 11:22:12.524145,epoch time: 0:01:49.392349,used: 0:27:49.864006,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_10_54_22_seed_0_22795134
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.99348956, 'precision': 0.9934699, 'recall': 0.9935151, 'specificity': 0.9935151, 'f1': 0.99348867, 'auroc': 0.99979013, 'binary_precision': 0.9954868, 'binary_recall': 0.9916506, 'binary_specificity': 0.99537957, 'binary_f1_score': 0.993565}
confusion matrix:
      0     1
0  1508     7
1    13  1544
---- Validation: 
scalar performance:
{'acc': 0.6700311, 'precision': 0.7697617, 'recall': 0.6657233, 'specificity': 0.6657233, 'f1': 0.6330271, 'auroc': 0.8921248, 'binary_precision': 0.9303279, 'binary_recall': 0.35748032, 'binary_specificity': 0.9739663, 'binary_f1_score': 0.51649606}
confusion matrix:
     0    1
0  636   17
1  408  227
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7139535, 'precision': 0.80844563, 'recall': 0.7139535, 'specificity': 0.7139535, 'f1': 0.69022894, 'auroc': 0.9062629, 'binary_precision': 0.9791667, 'binary_recall': 0.4372093, 'binary_specificity': 0.9906977, 'binary_f1_score': 0.6045016}
confusion matrix:
     0   1
0  213   2
1  121  94
early stop counter: 14
val acc:0.6700310707092285, best validation acc: 0.8594720363616943, corresponding to test acc:                         0.8441860675811768 / 0.8813953399658203
after epoch: 20,now: 2024-07-23 11:24:09.028845,epoch time: 0:01:56.504700,used: 0:29:46.368706,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_10_54_22_seed_0_22795134
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.99348956, 'precision': 0.9934739, 'recall': 0.99351156, 'specificity': 0.99351156, 'f1': 0.99348897, 'auroc': 0.99977326, 'binary_precision': 0.99547803, 'binary_recall': 0.9916345, 'binary_specificity': 0.9953887, 'binary_f1_score': 0.99355257}
confusion matrix:
      0     1
0  1511     7
1    13  1541
---- Validation: 
scalar performance:
{'acc': 0.7492236, 'precision': 0.80163044, 'recall': 0.746277, 'specificity': 0.746277, 'f1': 0.736313, 'auroc': 0.8950405, 'binary_precision': 0.92391306, 'binary_recall': 0.53543305, 'binary_specificity': 0.95712095, 'binary_f1_score': 0.6779661}
confusion matrix:
     0    1
0  625   28
1  295  340
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.68139535, 'precision': 0.79383934, 'recall': 0.68139535, 'specificity': 0.68139535, 'f1': 0.64769065, 'auroc': 0.9187453, 'binary_precision': 0.9756098, 'binary_recall': 0.37209302, 'binary_specificity': 0.9906977, 'binary_f1_score': 0.53872055}
confusion matrix:
     0   1
0  213   2
1  135  80
early stop counter: 15
val acc:0.7492235898971558, best validation acc: 0.8594720363616943, corresponding to test acc:                         0.8441860675811768 / 0.8813953399658203
after epoch: 21,now: 2024-07-23 11:25:54.562993,epoch time: 0:01:45.534148,used: 0:31:31.902854,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_10_54_22_seed_0_22795134
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.992513, 'precision': 0.9925058, 'recall': 0.99258035, 'specificity': 0.99258035, 'f1': 0.9925127, 'auroc': 0.99960995, 'binary_precision': 0.99804944, 'binary_recall': 0.9871383, 'binary_specificity': 0.99802244, 'binary_f1_score': 0.99256384}
confusion matrix:
      0     1
0  1514     3
1    20  1535
---- Validation: 
scalar performance:
{'acc': 0.7709627, 'precision': 0.8194312, 'recall': 0.7682158, 'specificity': 0.7682158, 'f1': 0.76067847, 'auroc': 0.9010285, 'binary_precision': 0.9404145, 'binary_recall': 0.57165354, 'binary_specificity': 0.96477795, 'binary_f1_score': 0.71106756}
confusion matrix:
     0    1
0  630   23
1  272  363
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7186046, 'precision': 0.81057906, 'recall': 0.7186047, 'specificity': 0.7186047, 'f1': 0.69610596, 'auroc': 0.90416443, 'binary_precision': 0.97959185, 'binary_recall': 0.44651163, 'binary_specificity': 0.9906977, 'binary_f1_score': 0.6134185}
confusion matrix:
     0   1
0  213   2
1  119  96
early stop counter: 16
val acc:0.7709627151489258, best validation acc: 0.8594720363616943, corresponding to test acc:                         0.8441860675811768 / 0.8813953399658203
after epoch: 22,now: 2024-07-23 11:27:36.922315,epoch time: 0:01:42.359322,used: 0:33:14.262176,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_10_54_22_seed_0_22795134
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.9944661, 'precision': 0.99446064, 'recall': 0.99446964, 'specificity': 0.99446964, 'f1': 0.9944651, 'auroc': 0.9998517, 'binary_precision': 0.9948619, 'binary_recall': 0.99422336, 'binary_specificity': 0.994716, 'binary_f1_score': 0.99454254}
confusion matrix:
      0     1
0  1506     8
1     9  1549
---- Validation: 
scalar performance:
{'acc': 0.8074534, 'precision': 0.828223, 'recall': 0.80567944, 'specificity': 0.80567944, 'f1': 0.8037044, 'auroc': 0.9121342, 'binary_precision': 0.9073684, 'binary_recall': 0.67874014, 'binary_specificity': 0.9326187, 'binary_f1_score': 0.7765766}
confusion matrix:
     0    1
0  609   44
1  204  431
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.80697674, 'precision': 0.8126652, 'recall': 0.80697674, 'specificity': 0.80697674, 'f1': 0.80609477, 'auroc': 0.89135754, 'binary_precision': 0.8548387, 'binary_recall': 0.73953485, 'binary_specificity': 0.8744186, 'binary_f1_score': 0.79301745}
confusion matrix:
     0    1
0  188   27
1   56  159
early stop counter: 17
val acc:0.8074533939361572, best validation acc: 0.8594720363616943, corresponding to test acc:                         0.8441860675811768 / 0.8813953399658203
after epoch: 23,now: 2024-07-23 11:29:17.665322,epoch time: 0:01:40.743007,used: 0:34:55.005183,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_10_54_22_seed_0_22795134
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9947917, 'precision': 0.99477476, 'recall': 0.99481, 'specificity': 0.99481, 'f1': 0.9947907, 'auroc': 0.9997121, 'binary_precision': 0.9961415, 'binary_recall': 0.99358565, 'binary_specificity': 0.9960344, 'binary_f1_score': 0.9948619}
confusion matrix:
      0     1
0  1507     6
1    10  1549
---- Validation: 
scalar performance:
{'acc': 0.6886646, 'precision': 0.78468597, 'recall': 0.6845558, 'specificity': 0.6845558, 'f1': 0.6570608, 'auroc': 0.9200975, 'binary_precision': 0.9465649, 'binary_recall': 0.39055118, 'binary_specificity': 0.9785605, 'binary_f1_score': 0.55295426}
confusion matrix:
     0    1
0  639   14
1  387  248
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.65581393, 'precision': 0.7649829, 'recall': 0.65581393, 'specificity': 0.65581393, 'f1': 0.61629367, 'auroc': 0.8762358, 'binary_precision': 0.9350649, 'binary_recall': 0.33488372, 'binary_specificity': 0.9767442, 'binary_f1_score': 0.49315068}
confusion matrix:
     0   1
0  210   5
1  143  72
early stop counter: 18
val acc:0.6886646151542664, best validation acc: 0.8594720363616943, corresponding to test acc:                         0.8441860675811768 / 0.8813953399658203
after epoch: 24,now: 2024-07-23 11:31:16.319335,epoch time: 0:01:58.654013,used: 0:36:53.659196,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_10_54_22_seed_0_22795134
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.992513, 'precision': 0.9925276, 'recall': 0.99260926, 'specificity': 0.99260926, 'f1': 0.9925128, 'auroc': 0.9997418, 'binary_precision': 1.0, 'binary_recall': 0.9852185, 'binary_specificity': 1.0, 'binary_f1_score': 0.99255425}
confusion matrix:
      0     1
0  1516     0
1    23  1533
---- Validation: 
scalar performance:
{'acc': 0.6552795, 'precision': 0.76883227, 'recall': 0.6506759, 'specificity': 0.6506759, 'f1': 0.61066633, 'auroc': 0.8531382, 'binary_precision': 0.94009215, 'binary_recall': 0.32125986, 'binary_specificity': 0.98009187, 'binary_f1_score': 0.47887325}
confusion matrix:
     0    1
0  640   13
1  431  204
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7162791, 'precision': 0.81899107, 'recall': 0.7162791, 'specificity': 0.7162791, 'f1': 0.6914408, 'auroc': 0.919589, 'binary_precision': 1.0, 'binary_recall': 0.43255815, 'binary_specificity': 1.0, 'binary_f1_score': 0.6038961}
confusion matrix:
     0   1
0  215   0
1  122  93
early stop counter: 19
val acc:0.6552795171737671, best validation acc: 0.8594720363616943, corresponding to test acc:                         0.8441860675811768 / 0.8813953399658203
after epoch: 25,now: 2024-07-23 11:33:18.349448,epoch time: 0:02:02.030113,used: 0:38:55.689309,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_10_54_22_seed_0_22795134
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9941406, 'precision': 0.9941199, 'recall': 0.9941735, 'specificity': 0.9941735, 'f1': 0.99413997, 'auroc': 0.9997889, 'binary_precision': 0.99677, 'binary_recall': 0.9916452, 'binary_specificity': 0.99670184, 'binary_f1_score': 0.994201}
confusion matrix:
      0     1
0  1511     5
1    13  1543
---- Validation: 
scalar performance:
{'acc': 0.7173913, 'precision': 0.772025, 'recall': 0.7142106, 'specificity': 0.7142106, 'f1': 0.7004858, 'auroc': 0.8533739, 'binary_precision': 0.89048994, 'binary_recall': 0.48661417, 'binary_specificity': 0.94180703, 'binary_f1_score': 0.62932795}
confusion matrix:
     0    1
0  615   38
1  326  309
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.82093024, 'precision': 0.8577802, 'recall': 0.82093024, 'specificity': 0.82093024, 'f1': 0.8161975, 'auroc': 0.9310546, 'binary_precision': 0.9726027, 'binary_recall': 0.6604651, 'binary_specificity': 0.98139536, 'binary_f1_score': 0.7867036}
confusion matrix:
     0    1
0  211    4
1   73  142
early stop counter: 20
val acc:0.717391312122345, best validation acc: 0.8594720363616943, corresponding to test acc:                         0.8441860675811768 / 0.8813953399658203
after epoch: 26,now: 2024-07-23 11:35:03.789976,epoch time: 0:01:45.440528,used: 0:40:41.129837,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_10_54_22_seed_0_22795134
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.9967448, 'precision': 0.9967636, 'recall': 0.9967282, 'specificity': 0.9967282, 'f1': 0.99674416, 'auroc': 0.99986815, 'binary_precision': 0.9955099, 'binary_recall': 0.9980707, 'binary_specificity': 0.99538565, 'binary_f1_score': 0.9967887}
confusion matrix:
      0     1
0  1510     7
1     3  1552
---- Validation: 
scalar performance:
{'acc': 0.7135093, 'precision': 0.77562785, 'recall': 0.7101433, 'specificity': 0.7101433, 'f1': 0.6942831, 'auroc': 0.8816118, 'binary_precision': 0.9030303, 'binary_recall': 0.46929133, 'binary_specificity': 0.9509954, 'binary_f1_score': 0.6176166}
confusion matrix:
     0    1
0  621   32
1  337  298
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8372093, 'precision': 0.8699945, 'recall': 0.8372093, 'specificity': 0.8372093, 'f1': 0.83352137, 'auroc': 0.9301027, 'binary_precision': 0.98013246, 'binary_recall': 0.6883721, 'binary_specificity': 0.9860465, 'binary_f1_score': 0.8087432}
confusion matrix:
     0    1
0  212    3
1   67  148
early stop counter: 21
val acc:0.7135093212127686, best validation acc: 0.8594720363616943, corresponding to test acc:                         0.8441860675811768 / 0.8813953399658203
after epoch: 27,now: 2024-07-23 11:37:04.696515,epoch time: 0:02:00.906539,used: 0:42:42.036376,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_10_54_22_seed_0_22795134
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.9973958, 'precision': 0.9973736, 'recall': 0.9974309, 'specificity': 0.9974309, 'f1': 0.9973955, 'auroc': 0.999905, 'binary_precision': 1.0, 'binary_recall': 0.9948619, 'binary_specificity': 1.0, 'binary_f1_score': 0.99742436}
confusion matrix:
      0     1
0  1515     0
1     8  1549
---- Validation: 
scalar performance:
{'acc': 0.7243789, 'precision': 0.79101884, 'recall': 0.7209934, 'specificity': 0.7209934, 'f1': 0.70563674, 'auroc': 0.893901, 'binary_precision': 0.9268293, 'binary_recall': 0.47874016, 'binary_specificity': 0.9632466, 'binary_f1_score': 0.63136035}
confusion matrix:
     0    1
0  629   24
1  331  304
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7860465, 'precision': 0.81385744, 'recall': 0.7860465, 'specificity': 0.7860465, 'f1': 0.7811996, 'auroc': 0.8926771, 'binary_precision': 0.9072848, 'binary_recall': 0.6372093, 'binary_specificity': 0.9348837, 'binary_f1_score': 0.74863386}
confusion matrix:
     0    1
0  201   14
1   78  137
early stop counter: 22
val acc:0.7243788838386536, best validation acc: 0.8594720363616943, corresponding to test acc:                         0.8441860675811768 / 0.8813953399658203
after epoch: 28,now: 2024-07-23 11:39:08.943501,epoch time: 0:02:04.246986,used: 0:44:46.283362,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_10_54_22_seed_0_22795134
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.99348956, 'precision': 0.9934659, 'recall': 0.9935329, 'specificity': 0.9935329, 'f1': 0.9934889, 'auroc': 0.9998338, 'binary_precision': 0.99676794, 'binary_recall': 0.9903661, 'binary_specificity': 0.9966997, 'binary_f1_score': 0.99355674}
confusion matrix:
      0     1
0  1510     5
1    15  1542
---- Validation: 
scalar performance:
{'acc': 0.6420807, 'precision': 0.7575157, 'recall': 0.63733345, 'specificity': 0.63733345, 'f1': 0.59256816, 'auroc': 0.85103035, 'binary_precision': 0.9264706, 'binary_recall': 0.2976378, 'binary_specificity': 0.9770291, 'binary_f1_score': 0.45053637}
confusion matrix:
     0    1
0  638   15
1  446  189
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7139535, 'precision': 0.7996969, 'recall': 0.7139535, 'specificity': 0.7139535, 'f1': 0.6919179, 'auroc': 0.8857112, 'binary_precision': 0.96, 'binary_recall': 0.44651163, 'binary_specificity': 0.98139536, 'binary_f1_score': 0.60952383}
confusion matrix:
     0   1
0  211   4
1  119  96
early stop counter: 23
val acc:0.6420807242393494, best validation acc: 0.8594720363616943, corresponding to test acc:                         0.8441860675811768 / 0.8813953399658203
after epoch: 29,now: 2024-07-23 11:41:17.412048,epoch time: 0:02:08.468547,used: 0:46:54.751909,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_10_54_22_seed_0_22795134
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.991862, 'precision': 0.99183977, 'recall': 0.9919183, 'specificity': 0.9919183, 'f1': 0.9918612, 'auroc': 0.999802, 'binary_precision': 0.996114, 'binary_recall': 0.987797, 'binary_specificity': 0.9960396, 'binary_f1_score': 0.9919381}
confusion matrix:
      0     1
0  1509     6
1    19  1538
---- Validation: 
scalar performance:
{'acc': 0.7166149, 'precision': 0.79787445, 'recall': 0.712924, 'specificity': 0.712924, 'f1': 0.6936002, 'auroc': 0.9081266, 'binary_precision': 0.95, 'binary_recall': 0.4488189, 'binary_specificity': 0.9770291, 'binary_f1_score': 0.6096257}
confusion matrix:
     0    1
0  638   15
1  350  285
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7348837, 'precision': 0.8181685, 'recall': 0.7348837, 'specificity': 0.7348837, 'f1': 0.71631944, 'auroc': 0.91054624, 'binary_precision': 0.9809524, 'binary_recall': 0.47906977, 'binary_specificity': 0.9906977, 'binary_f1_score': 0.64374995}
confusion matrix:
     0    1
0  213    2
1  112  103
early stop counter: 24
val acc:0.7166149020195007, best validation acc: 0.8594720363616943, corresponding to test acc:                         0.8441860675811768 / 0.8813953399658203
after epoch: 30,now: 2024-07-23 11:43:28.461800,epoch time: 0:02:11.049752,used: 0:49:05.801661,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_10_54_22_seed_0_22795134
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 0:49:05.801661 at 2024-07-23 11:43:28.461800
persisted model performance metric: 

scalar performance:
{'acc': 0.84418607, 'precision': 0.8447902, 'recall': 0.84418607, 'specificity': 0.84418607, 'f1': 0.84411776, 'auroc': 0.9291725, 'binary_precision': 0.83035713, 'binary_recall': 0.8651163, 'binary_specificity': 0.82325584, 'binary_f1_score': 0.8473804}
confusion matrix:
     0    1
0  177   38
1   29  186
oracle model performance metric: 

scalar performance:
{'acc': 0.88139534, 'precision': 0.8988688, 'recall': 0.88139534, 'specificity': 0.88139534, 'f1': 0.880082, 'auroc': 0.9416549, 'binary_precision': 0.9823529, 'binary_recall': 0.7767442, 'binary_specificity': 0.9860465, 'binary_f1_score': 0.86753243}
confusion matrix:
     0    1
0  212    3
1   48  167
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_dial_lr1e5_bs32__45_nofreeze_2024-07-23_10-43-50/rule_results/4.csv
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_dial_lr1e5_bs32__45_nofreeze_2024-07-23_10-43-50/rule_results/4.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_dial_lr1e5_bs32__45_nofreeze_2024-07-23_10-43-50/confusion_matrix/4.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 455936 KiB |  26075 MiB |  70808 GiB |  70808 GiB |
|       from large pool | 415383 KiB |  26030 MiB |  70366 GiB |  70365 GiB |
|       from small pool |  40553 KiB |     56 MiB |    442 GiB |    442 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 455936 KiB |  26075 MiB |  70808 GiB |  70808 GiB |
|       from large pool | 415383 KiB |  26030 MiB |  70366 GiB |  70365 GiB |
|       from small pool |  40553 KiB |     56 MiB |    442 GiB |    442 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 447480 KiB |  26071 MiB |  70793 GiB |  70793 GiB |
|       from large pool | 407075 KiB |  26026 MiB |  70352 GiB |  70351 GiB |
|       from small pool |  40405 KiB |     56 MiB |    441 GiB |    441 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  27748 MiB |  27748 MiB |  27748 MiB |      0 B   |
|       from large pool |  27680 MiB |  27680 MiB |  27680 MiB |      0 B   |
|       from small pool |     68 MiB |     68 MiB |     68 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory | 785151 KiB |   1678 MiB |  33155 GiB |  33154 GiB |
|       from large pool | 770409 KiB |   1668 MiB |  32710 GiB |  32709 GiB |
|       from small pool |  14742 KiB |     21 MiB |    444 GiB |    444 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    1220    |    2568    |    6427 K  |    6426 K  |
|       from large pool |     187    |    1413    |    3247 K  |    3247 K  |
|       from small pool |    1033    |    1329    |    3179 K  |    3178 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    1220    |    2568    |    6427 K  |    6426 K  |
|       from large pool |     187    |    1413    |    3247 K  |    3247 K  |
|       from small pool |    1033    |    1329    |    3179 K  |    3178 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     834    |     834    |     834    |       0    |
|       from large pool |     800    |     800    |     800    |       0    |
|       from small pool |      34    |      34    |      34    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     102    |     855    |    4728 K  |    4728 K  |
|       from large pool |      39    |     799    |    2905 K  |    2905 K  |
|       from small pool |      63    |     148    |    1823 K  |    1823 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  26075 MiB |  70808 GiB |  70808 GiB |
|       from large pool |  16640 KiB |  26030 MiB |  70366 GiB |  70366 GiB |
|       from small pool |      0 KiB |     56 MiB |    442 GiB |    442 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  26075 MiB |  70808 GiB |  70808 GiB |
|       from large pool |  16640 KiB |  26030 MiB |  70366 GiB |  70366 GiB |
|       from small pool |      0 KiB |     56 MiB |    442 GiB |    442 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  26071 MiB |  70793 GiB |  70793 GiB |
|       from large pool |  16640 KiB |  26026 MiB |  70352 GiB |  70352 GiB |
|       from small pool |      0 KiB |     56 MiB |    441 GiB |    441 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1212 MiB |  27748 MiB |  27748 MiB |  26536 MiB |
|       from large pool |   1158 MiB |  27680 MiB |  27680 MiB |  26522 MiB |
|       from small pool |     54 MiB |     68 MiB |     68 MiB |     14 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |   3840 KiB |   1678 MiB |  33155 GiB |  33155 GiB |
|       from large pool |   3840 KiB |   1668 MiB |  32711 GiB |  32711 GiB |
|       from small pool |      0 KiB |     31 MiB |    444 GiB |    444 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    2568    |    6427 K  |    6427 K  |
|       from large pool |       2    |    1413    |    3247 K  |    3247 K  |
|       from small pool |       0    |    1329    |    3179 K  |    3179 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    2568    |    6427 K  |    6427 K  |
|       from large pool |       2    |    1413    |    3247 K  |    3247 K  |
|       from small pool |       0    |    1329    |    3179 K  |    3179 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      66    |     834    |     834    |     768    |
|       from large pool |      39    |     800    |     800    |     761    |
|       from small pool |      27    |      34    |      34    |       7    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       1    |     855    |    4728 K  |    4728 K  |
|       from large pool |       1    |     799    |    2905 K  |    2905 K  |
|       from small pool |       0    |     148    |    1823 K  |    1823 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  26075 MiB |  70808 GiB |  70808 GiB |
|       from large pool |  16640 KiB |  26030 MiB |  70366 GiB |  70366 GiB |
|       from small pool |      0 KiB |     56 MiB |    442 GiB |    442 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  26075 MiB |  70808 GiB |  70808 GiB |
|       from large pool |  16640 KiB |  26030 MiB |  70366 GiB |  70366 GiB |
|       from small pool |      0 KiB |     56 MiB |    442 GiB |    442 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  26071 MiB |  70793 GiB |  70793 GiB |
|       from large pool |  16640 KiB |  26026 MiB |  70352 GiB |  70352 GiB |
|       from small pool |      0 KiB |     56 MiB |    441 GiB |    441 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1212 MiB |  27748 MiB |  27748 MiB |  26536 MiB |
|       from large pool |   1158 MiB |  27680 MiB |  27680 MiB |  26522 MiB |
|       from small pool |     54 MiB |     68 MiB |     68 MiB |     14 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |   3840 KiB |   1678 MiB |  33155 GiB |  33155 GiB |
|       from large pool |   3840 KiB |   1668 MiB |  32711 GiB |  32711 GiB |
|       from small pool |      0 KiB |     31 MiB |    444 GiB |    444 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    2568    |    6427 K  |    6427 K  |
|       from large pool |       2    |    1413    |    3247 K  |    3247 K  |
|       from small pool |       0    |    1329    |    3179 K  |    3179 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    2568    |    6427 K  |    6427 K  |
|       from large pool |       2    |    1413    |    3247 K  |    3247 K  |
|       from small pool |       0    |    1329    |    3179 K  |    3179 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      66    |     834    |     834    |     768    |
|       from large pool |      39    |     800    |     800    |     761    |
|       from small pool |      27    |      34    |      34    |       7    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       1    |     855    |    4728 K  |    4728 K  |
|       from large pool |       1    |     799    |    2905 K  |    2905 K  |
|       from small pool |       0    |     148    |    1823 K  |    1823 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'888c1ef2'
model name: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_11_46_12_seed_1_22795134

 Experiment start at: 2024-07-23 11:46:12.107795
before training, model accuracy: 0.6177777647972107
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.92089844, 'precision': 0.92803526, 'recall': 0.9217626, 'specificity': 0.9217626, 'f1': 0.92066395, 'auroc': 0.98085546, 'binary_precision': 0.9866568, 'binary_recall': 0.8553985, 'binary_specificity': 0.98812664, 'binary_f1_score': 0.91635114}
confusion matrix:
      0     1
0  1498    18
1   225  1331
---- Validation: 
scalar performance:
{'acc': 0.8181108, 'precision': 0.8265809, 'recall': 0.81676906, 'specificity': 0.81676906, 'f1': 0.81644595, 'auroc': 0.8912003, 'binary_precision': 0.8752363, 'binary_recall': 0.7349206, 'binary_specificity': 0.8986175, 'binary_f1_score': 0.7989646}
confusion matrix:
     0    1
0  585   66
1  167  463
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.86, 'precision': 0.86258554, 'recall': 0.86, 'specificity': 0.86, 'f1': 0.8597499, 'auroc': 0.91928893, 'binary_precision': 0.89320385, 'binary_recall': 0.81777775, 'binary_specificity': 0.9022222, 'binary_f1_score': 0.85382825}
confusion matrix:
     0    1
0  203   22
1   41  184
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-23 11:48:42.789414,epoch time: 0:02:30.681619,used: 0:02:30.681619,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_11_46_12_seed_1_22795134
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.96516925, 'precision': 0.96532905, 'recall': 0.9653533, 'specificity': 0.9653533, 'f1': 0.96516925, 'auroc': 0.99207485, 'binary_precision': 0.9782465, 'binary_recall': 0.9525032, 'binary_specificity': 0.9782034, 'binary_f1_score': 0.9652033}
confusion matrix:
      0     1
0  1481    33
1    74  1484
---- Validation: 
scalar performance:
{'acc': 0.8017174, 'precision': 0.8101522, 'recall': 0.8030466, 'specificity': 0.8030466, 'f1': 0.80079854, 'auroc': 0.90302587, 'binary_precision': 0.75474256, 'binary_recall': 0.88412696, 'binary_specificity': 0.7219662, 'binary_f1_score': 0.8143275}
confusion matrix:
     0    1
0  470  181
1   73  557
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.77555555, 'precision': 0.7989969, 'recall': 0.77555555, 'specificity': 0.77555555, 'f1': 0.77106845, 'auroc': 0.92430615, 'binary_precision': 0.7152778, 'binary_recall': 0.91555554, 'binary_specificity': 0.63555557, 'binary_f1_score': 0.8031189}
confusion matrix:
     0    1
0  143   82
1   19  206
early stop counter: 1
val acc:0.8017174005508423, best validation acc: 0.8181108236312866, corresponding to test acc:                         0.8600000143051147 / 0.8600000143051147
after epoch: 2,now: 2024-07-23 11:50:59.151791,epoch time: 0:02:16.362377,used: 0:04:47.043996,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_11_46_12_seed_1_22795134
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9690755, 'precision': 0.9690593, 'recall': 0.96913385, 'specificity': 0.96913385, 'f1': 0.9690734, 'auroc': 0.99612486, 'binary_precision': 0.97404283, 'binary_recall': 0.96465296, 'binary_specificity': 0.97361475, 'binary_f1_score': 0.9693251}
confusion matrix:
      0     1
0  1476    40
1    55  1501
---- Validation: 
scalar performance:
{'acc': 0.8001561, 'precision': 0.8044007, 'recall': 0.80110085, 'specificity': 0.80110085, 'f1': 0.7997596, 'auroc': 0.8907517, 'binary_precision': 0.7641243, 'binary_recall': 0.85873014, 'binary_specificity': 0.74347156, 'binary_f1_score': 0.8086696}
confusion matrix:
     0    1
0  484  167
1   89  541
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.78444445, 'precision': 0.8103448, 'recall': 0.78444445, 'specificity': 0.78444445, 'f1': 0.7798512, 'auroc': 0.9334716, 'binary_precision': 0.72068965, 'binary_recall': 0.9288889, 'binary_specificity': 0.64, 'binary_f1_score': 0.8116505}
confusion matrix:
     0    1
0  144   81
1   16  209
early stop counter: 2
val acc:0.8001561164855957, best validation acc: 0.8181108236312866, corresponding to test acc:                         0.8600000143051147 / 0.8600000143051147
after epoch: 3,now: 2024-07-23 11:53:18.704074,epoch time: 0:02:19.552283,used: 0:07:06.596279,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_11_46_12_seed_1_22795134
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9765625, 'precision': 0.97669315, 'recall': 0.9764823, 'specificity': 0.9764823, 'f1': 0.97655416, 'auroc': 0.99787223, 'binary_precision': 0.9714104, 'binary_recall': 0.98264784, 'binary_specificity': 0.97031665, 'binary_f1_score': 0.97699684}
confusion matrix:
      0     1
0  1471    45
1    27  1529
---- Validation: 
scalar performance:
{'acc': 0.82982045, 'precision': 0.83544767, 'recall': 0.8308756, 'specificity': 0.8308756, 'f1': 0.8293811, 'auroc': 0.9097872, 'binary_precision': 0.7877095, 'binary_recall': 0.8952381, 'binary_specificity': 0.76651305, 'binary_f1_score': 0.8380386}
confusion matrix:
     0    1
0  499  152
1   66  564
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.78444445, 'precision': 0.8103448, 'recall': 0.78444445, 'specificity': 0.78444445, 'f1': 0.7798512, 'auroc': 0.9337679, 'binary_precision': 0.72068965, 'binary_recall': 0.9288889, 'binary_specificity': 0.64, 'binary_f1_score': 0.8116505}
confusion matrix:
     0    1
0  144   81
1   16  209
better model found
persisted
after epoch: 4,now: 2024-07-23 11:55:33.206853,epoch time: 0:02:14.502779,used: 0:09:21.099058,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_11_46_12_seed_1_22795134
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9716797, 'precision': 0.9726425, 'recall': 0.9719935, 'specificity': 0.9719935, 'f1': 0.9716747, 'auroc': 0.9967829, 'binary_precision': 0.99728996, 'binary_recall': 0.9466238, 'binary_specificity': 0.9973632, 'binary_f1_score': 0.9712966}
confusion matrix:
      0     1
0  1513     4
1    83  1472
---- Validation: 
scalar performance:
{'acc': 0.77751756, 'precision': 0.80327, 'recall': 0.7750896, 'specificity': 0.7750896, 'f1': 0.77161133, 'auroc': 0.8905396, 'binary_precision': 0.8876405, 'binary_recall': 0.6269841, 'binary_specificity': 0.92319506, 'binary_f1_score': 0.7348837}
confusion matrix:
     0    1
0  601   50
1  235  395
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8488889, 'precision': 0.8580551, 'recall': 0.8488889, 'specificity': 0.8488889, 'f1': 0.84791553, 'auroc': 0.91802466, 'binary_precision': 0.91534394, 'binary_recall': 0.7688889, 'binary_specificity': 0.9288889, 'binary_f1_score': 0.8357488}
confusion matrix:
     0    1
0  209   16
1   52  173
early stop counter: 1
val acc:0.777517557144165, best validation acc: 0.829820454120636, corresponding to test acc:                         0.7844444513320923 / 0.8600000143051147
after epoch: 5,now: 2024-07-23 11:57:41.488111,epoch time: 0:02:08.281258,used: 0:11:29.380316,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_11_46_12_seed_1_22795134
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9720052, 'precision': 0.9730978, 'recall': 0.97235656, 'specificity': 0.97235656, 'f1': 0.97199947, 'auroc': 0.99816144, 'binary_precision': 0.9993206, 'binary_recall': 0.94537276, 'binary_specificity': 0.99934036, 'binary_f1_score': 0.97159845}
confusion matrix:
      0     1
0  1515     1
1    85  1471
---- Validation: 
scalar performance:
{'acc': 0.80249804, 'precision': 0.83015466, 'recall': 0.8001024, 'specificity': 0.8001024, 'f1': 0.79735893, 'auroc': 0.9008948, 'binary_precision': 0.92170024, 'binary_recall': 0.6539683, 'binary_specificity': 0.94623655, 'binary_f1_score': 0.7650882}
confusion matrix:
     0    1
0  616   35
1  218  412
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8377778, 'precision': 0.8518518, 'recall': 0.83777773, 'specificity': 0.83777773, 'f1': 0.83613914, 'auroc': 0.9228444, 'binary_precision': 0.9222222, 'binary_recall': 0.73777777, 'binary_specificity': 0.93777776, 'binary_f1_score': 0.81975305}
confusion matrix:
     0    1
0  211   14
1   59  166
early stop counter: 2
val acc:0.8024980425834656, best validation acc: 0.829820454120636, corresponding to test acc:                         0.7844444513320923 / 0.8600000143051147
after epoch: 6,now: 2024-07-23 11:59:58.701059,epoch time: 0:02:17.212948,used: 0:13:46.593264,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_11_46_12_seed_1_22795134
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9785156, 'precision': 0.9787949, 'recall': 0.9783743, 'specificity': 0.9783743, 'f1': 0.9785031, 'auroc': 0.998556, 'binary_precision': 0.97038436, 'binary_recall': 0.9878127, 'binary_specificity': 0.9689359, 'binary_f1_score': 0.9790209}
confusion matrix:
      0     1
0  1466    47
1    19  1540
---- Validation: 
scalar performance:
{'acc': 0.8399688, 'precision': 0.8401259, 'recall': 0.83975935, 'specificity': 0.83975935, 'f1': 0.8398559, 'auroc': 0.9035404, 'binary_precision': 0.84440845, 'binary_recall': 0.8269841, 'binary_specificity': 0.85253453, 'binary_f1_score': 0.83560544}
confusion matrix:
     0    1
0  555   96
1  109  521
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8666667, 'precision': 0.86669564, 'recall': 0.8666667, 'specificity': 0.8666667, 'f1': 0.86666405, 'auroc': 0.92981726, 'binary_precision': 0.8634361, 'binary_recall': 0.8711111, 'binary_specificity': 0.8622222, 'binary_f1_score': 0.86725664}
confusion matrix:
     0    1
0  194   31
1   29  196
new oracle model saved
better model found
persisted
after epoch: 7,now: 2024-07-23 12:02:15.503048,epoch time: 0:02:16.801989,used: 0:16:03.395253,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_11_46_12_seed_1_22795134
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.98046875, 'precision': 0.9807793, 'recall': 0.98067737, 'specificity': 0.98067737, 'f1': 0.9804685, 'auroc': 0.9986116, 'binary_precision': 0.99667996, 'binary_recall': 0.96465296, 'binary_specificity': 0.99670184, 'binary_f1_score': 0.980405}
confusion matrix:
      0     1
0  1511     5
1    55  1501
---- Validation: 
scalar performance:
{'acc': 0.73614365, 'precision': 0.79062676, 'recall': 0.73253965, 'specificity': 0.73253965, 'f1': 0.72115445, 'auroc': 0.88558745, 'binary_precision': 0.9124294, 'binary_recall': 0.5126984, 'binary_specificity': 0.95238096, 'binary_f1_score': 0.6565041}
confusion matrix:
     0    1
0  620   31
1  307  323
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8066667, 'precision': 0.8219351, 'recall': 0.8066666, 'specificity': 0.8066666, 'f1': 0.8043468, 'auroc': 0.8937679, 'binary_precision': 0.89204544, 'binary_recall': 0.69777775, 'binary_specificity': 0.91555554, 'binary_f1_score': 0.7830423}
confusion matrix:
     0    1
0  206   19
1   68  157
early stop counter: 1
val acc:0.7361436486244202, best validation acc: 0.8399688005447388, corresponding to test acc:                         0.8666666746139526 / 0.8666666746139526
after epoch: 8,now: 2024-07-23 12:04:28.389083,epoch time: 0:02:12.886035,used: 0:18:16.281288,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_11_46_12_seed_1_22795134
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9847005, 'precision': 0.9848012, 'recall': 0.98463774, 'specificity': 0.98463774, 'f1': 0.984696, 'auroc': 0.9988215, 'binary_precision': 0.98025477, 'binary_recall': 0.9897106, 'binary_specificity': 0.9795649, 'binary_f1_score': 0.98496}
confusion matrix:
      0     1
0  1486    31
1    16  1539
---- Validation: 
scalar performance:
{'acc': 0.8345043, 'precision': 0.8346995, 'recall': 0.83471584, 'specificity': 0.83471584, 'f1': 0.8345042, 'auroc': 0.9020603, 'binary_precision': 0.82153845, 'binary_recall': 0.84761906, 'binary_specificity': 0.82181257, 'binary_f1_score': 0.834375}
confusion matrix:
     0    1
0  535  116
1   96  534
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.80444443, 'precision': 0.8107296, 'recall': 0.80444443, 'specificity': 0.80444443, 'f1': 0.8034506, 'auroc': 0.8993778, 'binary_precision': 0.76653695, 'binary_recall': 0.8755556, 'binary_specificity': 0.73333335, 'binary_f1_score': 0.8174274}
confusion matrix:
     0    1
0  165   60
1   28  197
early stop counter: 2
val acc:0.8345043063163757, best validation acc: 0.8399688005447388, corresponding to test acc:                         0.8666666746139526 / 0.8666666746139526
after epoch: 9,now: 2024-07-23 12:06:47.154049,epoch time: 0:02:18.764966,used: 0:20:35.046254,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_11_46_12_seed_1_22795134
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9785156, 'precision': 0.9794104, 'recall': 0.97827876, 'specificity': 0.97827876, 'f1': 0.97849464, 'auroc': 0.99917924, 'binary_precision': 0.96156234, 'binary_recall': 0.99742764, 'binary_specificity': 0.95912987, 'binary_f1_score': 0.9791667}
confusion matrix:
      0     1
0  1455    62
1     4  1551
---- Validation: 
scalar performance:
{'acc': 0.78844655, 'precision': 0.79911417, 'recall': 0.7899642, 'specificity': 0.7899642, 'f1': 0.78709674, 'auroc': 0.8732743, 'binary_precision': 0.73837984, 'binary_recall': 0.8825397, 'binary_specificity': 0.69738865, 'binary_f1_score': 0.80404925}
confusion matrix:
     0    1
0  454  197
1   74  556
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7688889, 'precision': 0.79420346, 'recall': 0.7688889, 'specificity': 0.7688889, 'f1': 0.76380813, 'auroc': 0.88335806, 'binary_precision': 0.7079038, 'binary_recall': 0.91555554, 'binary_specificity': 0.62222224, 'binary_f1_score': 0.7984496}
confusion matrix:
     0    1
0  140   85
1   19  206
early stop counter: 3
val acc:0.7884465456008911, best validation acc: 0.8399688005447388, corresponding to test acc:                         0.8666666746139526 / 0.8666666746139526
after epoch: 10,now: 2024-07-23 12:09:05.206846,epoch time: 0:02:18.052797,used: 0:22:53.099051,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_11_46_12_seed_1_22795134
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9749349, 'precision': 0.9759729, 'recall': 0.97466356, 'specificity': 0.97466356, 'f1': 0.9749067, 'auroc': 0.9992441, 'binary_precision': 0.95676345, 'binary_recall': 0.9955013, 'binary_specificity': 0.95382583, 'binary_f1_score': 0.975748}
confusion matrix:
      0     1
0  1446    70
1     7  1549
---- Validation: 
scalar performance:
{'acc': 0.8384075, 'precision': 0.8413729, 'recall': 0.8391705, 'specificity': 0.8391705, 'f1': 0.8382336, 'auroc': 0.9059249, 'binary_precision': 0.8051948, 'binary_recall': 0.8857143, 'binary_specificity': 0.79262674, 'binary_f1_score': 0.8435374}
confusion matrix:
     0    1
0  516  135
1   72  558
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.77555555, 'precision': 0.78927505, 'recall': 0.77555555, 'specificity': 0.77555555, 'f1': 0.77286243, 'auroc': 0.8934518, 'binary_precision': 0.72627735, 'binary_recall': 0.8844444, 'binary_specificity': 0.6666667, 'binary_f1_score': 0.7975951}
confusion matrix:
     0    1
0  150   75
1   26  199
early stop counter: 4
val acc:0.8384075164794922, best validation acc: 0.8399688005447388, corresponding to test acc:                         0.8666666746139526 / 0.8666666746139526
after epoch: 11,now: 2024-07-23 12:11:23.923411,epoch time: 0:02:18.716565,used: 0:25:11.815616,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_11_46_12_seed_1_22795134
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9876302, 'precision': 0.9876995, 'recall': 0.9877491, 'specificity': 0.9877491, 'f1': 0.9876301, 'auroc': 0.9991933, 'binary_precision': 0.99737704, 'binary_recall': 0.97813505, 'binary_specificity': 0.9973632, 'binary_f1_score': 0.9876624}
confusion matrix:
      0     1
0  1513     4
1    34  1521
---- Validation: 
scalar performance:
{'acc': 0.82435596, 'precision': 0.83909506, 'recall': 0.82263184, 'specificity': 0.82263184, 'f1': 0.8218477, 'auroc': 0.8964548, 'binary_precision': 0.9058116, 'binary_recall': 0.71746033, 'binary_specificity': 0.9278034, 'binary_f1_score': 0.80070865}
confusion matrix:
     0    1
0  604   47
1  178  452
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8511111, 'precision': 0.85704243, 'recall': 0.8511111, 'specificity': 0.8511111, 'f1': 0.8504901, 'auroc': 0.9260839, 'binary_precision': 0.9030612, 'binary_recall': 0.7866667, 'binary_specificity': 0.91555554, 'binary_f1_score': 0.84085506}
confusion matrix:
     0    1
0  206   19
1   48  177
early stop counter: 5
val acc:0.824355959892273, best validation acc: 0.8399688005447388, corresponding to test acc:                         0.8666666746139526 / 0.8666666746139526
after epoch: 12,now: 2024-07-23 12:13:43.690702,epoch time: 0:02:19.767291,used: 0:27:31.582907,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_11_46_12_seed_1_22795134
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9869792, 'precision': 0.98698384, 'recall': 0.9870746, 'specificity': 0.9870746, 'f1': 0.9869786, 'auroc': 0.9992378, 'binary_precision': 0.9941368, 'binary_recall': 0.9800899, 'binary_specificity': 0.9940594, 'binary_f1_score': 0.9870634}
confusion matrix:
      0     1
0  1506     9
1    31  1526
---- Validation: 
scalar performance:
{'acc': 0.85870415, 'precision': 0.8704808, 'recall': 0.85724527, 'specificity': 0.85724527, 'f1': 0.85718775, 'auroc': 0.9094677, 'binary_precision': 0.93256265, 'binary_recall': 0.768254, 'binary_specificity': 0.94623655, 'binary_f1_score': 0.8424717}
confusion matrix:
     0    1
0  616   35
1  146  484
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.85555553, 'precision': 0.8818089, 'recall': 0.85555553, 'specificity': 0.85555553, 'f1': 0.8530291, 'auroc': 0.9364346, 'binary_precision': 0.9819277, 'binary_recall': 0.72444445, 'binary_specificity': 0.9866667, 'binary_f1_score': 0.83375955}
confusion matrix:
     0    1
0  222    3
1   62  163
better model found
persisted
after epoch: 13,now: 2024-07-23 12:16:04.270367,epoch time: 0:02:20.579665,used: 0:29:52.162572,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_11_46_12_seed_1_22795134
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9899089, 'precision': 0.98994577, 'recall': 0.9900029, 'specificity': 0.9900029, 'f1': 0.9899087, 'auroc': 0.99917674, 'binary_precision': 0.99803793, 'binary_recall': 0.981982, 'binary_specificity': 0.9980237, 'binary_f1_score': 0.9899449}
confusion matrix:
      0     1
0  1515     3
1    28  1526
---- Validation: 
scalar performance:
{'acc': 0.7423888, 'precision': 0.7800719, 'recall': 0.7393241, 'specificity': 0.7393241, 'f1': 0.7317594, 'auroc': 0.86735916, 'binary_precision': 0.8787879, 'binary_recall': 0.552381, 'binary_specificity': 0.92626727, 'binary_f1_score': 0.6783626}
confusion matrix:
     0    1
0  603   48
1  282  348
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.79555553, 'precision': 0.8336195, 'recall': 0.7955556, 'specificity': 0.7955556, 'f1': 0.78955287, 'auroc': 0.907279, 'binary_precision': 0.94630873, 'binary_recall': 0.62666667, 'binary_specificity': 0.96444446, 'binary_f1_score': 0.7540107}
confusion matrix:
     0    1
0  217    8
1   84  141
early stop counter: 1
val acc:0.7423887848854065, best validation acc: 0.858704149723053, corresponding to test acc:                         0.855555534362793 / 0.8666666746139526
after epoch: 14,now: 2024-07-23 12:18:29.729276,epoch time: 0:02:25.458909,used: 0:32:17.621481,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_11_46_12_seed_1_22795134
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9866536, 'precision': 0.9866352, 'recall': 0.9866734, 'specificity': 0.9866734, 'f1': 0.9866517, 'auroc': 0.99934626, 'binary_precision': 0.98840207, 'binary_recall': 0.985228, 'binary_specificity': 0.9881188, 'binary_f1_score': 0.9868125}
confusion matrix:
      0     1
0  1497    18
1    23  1534
---- Validation: 
scalar performance:
{'acc': 0.83138174, 'precision': 0.8462446, 'recall': 0.82967234, 'specificity': 0.82967234, 'f1': 0.8290058, 'auroc': 0.9116621, 'binary_precision': 0.914, 'binary_recall': 0.7253968, 'binary_specificity': 0.9339478, 'binary_f1_score': 0.8088496}
confusion matrix:
     0    1
0  608   43
1  173  457
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.79333335, 'precision': 0.8149923, 'recall': 0.7933333, 'specificity': 0.7933333, 'f1': 0.78971857, 'auroc': 0.8955852, 'binary_precision': 0.89759034, 'binary_recall': 0.6622222, 'binary_specificity': 0.92444444, 'binary_f1_score': 0.7621484}
confusion matrix:
     0    1
0  208   17
1   76  149
early stop counter: 2
val acc:0.8313817381858826, best validation acc: 0.858704149723053, corresponding to test acc:                         0.855555534362793 / 0.8666666746139526
after epoch: 15,now: 2024-07-23 12:20:52.643485,epoch time: 0:02:22.914209,used: 0:34:40.535690,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_11_46_12_seed_1_22795134
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.98502606, 'precision': 0.9850303, 'recall': 0.9851043, 'specificity': 0.9851043, 'f1': 0.9850255, 'auroc': 0.99916065, 'binary_precision': 0.99153095, 'binary_recall': 0.9787781, 'binary_specificity': 0.99143046, 'binary_f1_score': 0.98511326}
confusion matrix:
      0     1
0  1504    13
1    33  1522
---- Validation: 
scalar performance:
{'acc': 0.88368464, 'precision': 0.8856909, 'recall': 0.8831029, 'specificity': 0.8831029, 'f1': 0.8833936, 'auroc': 0.9225173, 'binary_precision': 0.9097104, 'binary_recall': 0.84761906, 'binary_specificity': 0.9185868, 'binary_f1_score': 0.8775678}
confusion matrix:
     0    1
0  598   53
1   96  534
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8622222, 'precision': 0.8632555, 'recall': 0.8622222, 'specificity': 0.8622222, 'f1': 0.86212415, 'auroc': 0.9083655, 'binary_precision': 0.8826291, 'binary_recall': 0.83555555, 'binary_specificity': 0.8888889, 'binary_f1_score': 0.85844743}
confusion matrix:
     0    1
0  200   25
1   37  188
better model found
persisted
after epoch: 16,now: 2024-07-23 12:23:11.862919,epoch time: 0:02:19.219434,used: 0:36:59.755124,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_11_46_12_seed_1_22795134
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.99121094, 'precision': 0.9911977, 'recall': 0.99122787, 'specificity': 0.99122787, 'f1': 0.9912101, 'auroc': 0.9992709, 'binary_precision': 0.99289405, 'binary_recall': 0.98969734, 'binary_specificity': 0.9927584, 'binary_f1_score': 0.9912931}
confusion matrix:
      0     1
0  1508    11
1    16  1537
---- Validation: 
scalar performance:
{'acc': 0.86026543, 'precision': 0.8626334, 'recall': 0.85960066, 'specificity': 0.85960066, 'f1': 0.85984695, 'auroc': 0.9158389, 'binary_precision': 0.8881239, 'binary_recall': 0.81904763, 'binary_specificity': 0.90015364, 'binary_f1_score': 0.8521883}
confusion matrix:
     0    1
0  586   65
1  114  516
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.84, 'precision': 0.84534824, 'recall': 0.84000003, 'specificity': 0.84000003, 'f1': 0.8393781, 'auroc': 0.92355555, 'binary_precision': 0.88832486, 'binary_recall': 0.7777778, 'binary_specificity': 0.9022222, 'binary_f1_score': 0.8293839}
confusion matrix:
     0    1
0  203   22
1   50  175
early stop counter: 1
val acc:0.8602654337882996, best validation acc: 0.8836846351623535, corresponding to test acc:                         0.8622221946716309 / 0.8666666746139526
after epoch: 17,now: 2024-07-23 12:25:29.133938,epoch time: 0:02:17.271019,used: 0:39:17.026143,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_11_46_12_seed_1_22795134
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.99088544, 'precision': 0.9908718, 'recall': 0.99095166, 'specificity': 0.99095166, 'f1': 0.9908849, 'auroc': 0.99958247, 'binary_precision': 0.9961039, 'binary_recall': 0.9858612, 'binary_specificity': 0.9960422, 'binary_f1_score': 0.99095607}
confusion matrix:
      0     1
0  1510     6
1    22  1534
---- Validation: 
scalar performance:
{'acc': 0.8618267, 'precision': 0.86848253, 'recall': 0.8607271, 'specificity': 0.8607271, 'f1': 0.86090994, 'auroc': 0.9183332, 'binary_precision': 0.9140768, 'binary_recall': 0.7936508, 'binary_specificity': 0.9278034, 'binary_f1_score': 0.84961766}
confusion matrix:
     0    1
0  604   47
1  130  500
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8666667, 'precision': 0.8724343, 'recall': 0.8666667, 'specificity': 0.8666667, 'f1': 0.8661485, 'auroc': 0.9264593, 'binary_precision': 0.9187817, 'binary_recall': 0.80444443, 'binary_specificity': 0.9288889, 'binary_f1_score': 0.8578199}
confusion matrix:
     0    1
0  209   16
1   44  181
early stop counter: 2
val acc:0.8618267178535461, best validation acc: 0.8836846351623535, corresponding to test acc:                         0.8622221946716309 / 0.8666666746139526
after epoch: 18,now: 2024-07-23 12:27:48.229979,epoch time: 0:02:19.096041,used: 0:41:36.122184,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_11_46_12_seed_1_22795134
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9817708, 'precision': 0.98241895, 'recall': 0.9815748, 'specificity': 0.9815748, 'f1': 0.98175657, 'auroc': 0.99960536, 'binary_precision': 0.9675608, 'binary_recall': 0.99742764, 'binary_specificity': 0.96572185, 'binary_f1_score': 0.98226726}
confusion matrix:
      0     1
0  1465    52
1     4  1551
---- Validation: 
scalar performance:
{'acc': 0.83684623, 'precision': 0.8378799, 'recall': 0.8373016, 'specificity': 0.8373016, 'f1': 0.83681405, 'auroc': 0.90471745, 'binary_precision': 0.81464875, 'binary_recall': 0.86507934, 'binary_specificity': 0.8095238, 'binary_f1_score': 0.83910704}
confusion matrix:
     0    1
0  527  124
1   85  545
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.79333335, 'precision': 0.79761904, 'recall': 0.79333335, 'specificity': 0.79333335, 'f1': 0.7925867, 'auroc': 0.89236546, 'binary_precision': 0.7619048, 'binary_recall': 0.85333335, 'binary_specificity': 0.73333335, 'binary_f1_score': 0.8050314}
confusion matrix:
     0    1
0  165   60
1   33  192
early stop counter: 3
val acc:0.8368462324142456, best validation acc: 0.8836846351623535, corresponding to test acc:                         0.8622221946716309 / 0.8666666746139526
after epoch: 19,now: 2024-07-23 12:30:08.554277,epoch time: 0:02:20.324298,used: 0:43:56.446482,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_11_46_12_seed_1_22795134
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.991862, 'precision': 0.9919492, 'recall': 0.99180543, 'specificity': 0.99180543, 'f1': 0.99185956, 'auroc': 0.99977154, 'binary_precision': 0.98789036, 'binary_recall': 0.99614394, 'binary_specificity': 0.987467, 'binary_f1_score': 0.992}
confusion matrix:
      0     1
0  1497    19
1     6  1550
---- Validation: 
scalar performance:
{'acc': 0.87275565, 'precision': 0.87281, 'recall': 0.87263185, 'specificity': 0.87263185, 'f1': 0.87269485, 'auroc': 0.92322433, 'binary_precision': 0.8747994, 'binary_recall': 0.86507934, 'binary_specificity': 0.88018435, 'binary_f1_score': 0.8699122}
confusion matrix:
     0    1
0  573   78
1   85  545
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.84, 'precision': 0.8404304, 'recall': 0.84000003, 'specificity': 0.84000003, 'f1': 0.8399494, 'auroc': 0.9048691, 'binary_precision': 0.82832617, 'binary_recall': 0.8577778, 'binary_specificity': 0.82222223, 'binary_f1_score': 0.8427948}
confusion matrix:
     0    1
0  185   40
1   32  193
early stop counter: 4
val acc:0.8727556467056274, best validation acc: 0.8836846351623535, corresponding to test acc:                         0.8622221946716309 / 0.8666666746139526
after epoch: 20,now: 2024-07-23 12:32:24.047699,epoch time: 0:02:15.493422,used: 0:46:11.939904,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_11_46_12_seed_1_22795134
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.98860675, 'precision': 0.9886617, 'recall': 0.9887278, 'specificity': 0.9887278, 'f1': 0.98860663, 'auroc': 0.99965155, 'binary_precision': 0.9980354, 'binary_recall': 0.97943443, 'binary_specificity': 0.9980211, 'binary_f1_score': 0.9886474}
confusion matrix:
      0     1
0  1513     3
1    32  1524
---- Validation: 
scalar performance:
{'acc': 0.80483997, 'precision': 0.8230727, 'recall': 0.8028674, 'specificity': 0.8028674, 'f1': 0.8012992, 'auroc': 0.90409327, 'binary_precision': 0.8958333, 'binary_recall': 0.6825397, 'binary_specificity': 0.92319506, 'binary_f1_score': 0.7747748}
confusion matrix:
     0    1
0  601   50
1  200  430
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.85333335, 'precision': 0.86738276, 'recall': 0.85333335, 'specificity': 0.85333335, 'f1': 0.8519176, 'auroc': 0.91986173, 'binary_precision': 0.9392265, 'binary_recall': 0.75555557, 'binary_specificity': 0.95111114, 'binary_f1_score': 0.83743846}
confusion matrix:
     0    1
0  214   11
1   55  170
early stop counter: 5
val acc:0.8048399686813354, best validation acc: 0.8836846351623535, corresponding to test acc:                         0.8622221946716309 / 0.8666666746139526
after epoch: 21,now: 2024-07-23 12:34:39.497743,epoch time: 0:02:15.450044,used: 0:48:27.389948,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_11_46_12_seed_1_22795134
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.99348956, 'precision': 0.99347717, 'recall': 0.9935039, 'specificity': 0.9935039, 'f1': 0.9934889, 'auroc': 0.99958074, 'binary_precision': 0.9948387, 'binary_recall': 0.992278, 'binary_specificity': 0.99472994, 'binary_f1_score': 0.99355674}
confusion matrix:
      0     1
0  1510     8
1    12  1542
---- Validation: 
scalar performance:
{'acc': 0.7876659, 'precision': 0.8304298, 'recall': 0.78469026, 'specificity': 0.78469026, 'f1': 0.7793281, 'auroc': 0.9113641, 'binary_precision': 0.94527364, 'binary_recall': 0.6031746, 'binary_specificity': 0.96620584, 'binary_f1_score': 0.7364341}
confusion matrix:
     0    1
0  629   22
1  250  380
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.78, 'precision': 0.8193718, 'recall': 0.78, 'specificity': 0.78, 'f1': 0.773004, 'auroc': 0.8957432, 'binary_precision': 0.9315069, 'binary_recall': 0.60444444, 'binary_specificity': 0.95555556, 'binary_f1_score': 0.7331536}
confusion matrix:
     0    1
0  215   10
1   89  136
early stop counter: 6
val acc:0.7876659035682678, best validation acc: 0.8836846351623535, corresponding to test acc:                         0.8622221946716309 / 0.8666666746139526
after epoch: 22,now: 2024-07-23 12:36:59.038556,epoch time: 0:02:19.540813,used: 0:50:46.930761,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_11_46_12_seed_1_22795134
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.9869792, 'precision': 0.98712236, 'recall': 0.98713803, 'specificity': 0.98713803, 'f1': 0.9869791, 'auroc': 0.9995353, 'binary_precision': 0.99934125, 'binary_recall': 0.9749357, 'binary_specificity': 0.99934036, 'binary_f1_score': 0.9869876}
confusion matrix:
      0     1
0  1515     1
1    39  1517
---- Validation: 
scalar performance:
{'acc': 0.74395, 'precision': 0.8149153, 'recall': 0.7400154, 'specificity': 0.7400154, 'f1': 0.7265656, 'auroc': 0.9219321, 'binary_precision': 0.96036583, 'binary_recall': 0.5, 'binary_specificity': 0.9800307, 'binary_f1_score': 0.6576201}
confusion matrix:
     0    1
0  638   13
1  315  315
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7511111, 'precision': 0.81933737, 'recall': 0.7511111, 'specificity': 0.7511111, 'f1': 0.7370673, 'auroc': 0.92798024, 'binary_precision': 0.96694213, 'binary_recall': 0.52, 'binary_specificity': 0.9822222, 'binary_f1_score': 0.6763006}
confusion matrix:
     0    1
0  221    4
1  108  117
early stop counter: 7
val acc:0.7439500093460083, best validation acc: 0.8836846351623535, corresponding to test acc:                         0.8622221946716309 / 0.8666666746139526
after epoch: 23,now: 2024-07-23 12:39:16.836188,epoch time: 0:02:17.797632,used: 0:53:04.728393,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_11_46_12_seed_1_22795134
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9746094, 'precision': 0.9757362, 'recall': 0.9743253, 'specificity': 0.9743253, 'f1': 0.9745791, 'auroc': 0.99892503, 'binary_precision': 0.95561033, 'binary_recall': 0.99614394, 'binary_specificity': 0.9525066, 'binary_f1_score': 0.97545624}
confusion matrix:
      0     1
0  1444    72
1     6  1550
---- Validation: 
scalar performance:
{'acc': 0.87119436, 'precision': 0.87120104, 'recall': 0.8713006, 'specificity': 0.8713006, 'f1': 0.8711865, 'auroc': 0.92032766, 'binary_precision': 0.8627145, 'binary_recall': 0.87777776, 'binary_specificity': 0.86482334, 'binary_f1_score': 0.87018096}
confusion matrix:
     0    1
0  563   88
1   77  553
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8755556, 'precision': 0.87701523, 'recall': 0.8755556, 'specificity': 0.8755556, 'f1': 0.87543505, 'auroc': 0.94012845, 'binary_precision': 0.8535565, 'binary_recall': 0.9066667, 'binary_specificity': 0.84444445, 'binary_f1_score': 0.8793104}
confusion matrix:
     0    1
0  190   35
1   21  204
new oracle model saved
early stop counter: 8
val acc:0.8711943626403809, best validation acc: 0.8836846351623535, corresponding to test acc:                         0.8622221946716309 / 0.8755555748939514
after epoch: 24,now: 2024-07-23 12:41:34.322928,epoch time: 0:02:17.486740,used: 0:55:22.215133,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_11_46_12_seed_1_22795134
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.9938151, 'precision': 0.9937957, 'recall': 0.9938692, 'specificity': 0.9938692, 'f1': 0.99381465, 'auroc': 0.9999135, 'binary_precision': 0.99805576, 'binary_recall': 0.98971725, 'binary_specificity': 0.9980211, 'binary_f1_score': 0.993869}
confusion matrix:
      0     1
0  1513     3
1    16  1540
---- Validation: 
scalar performance:
{'acc': 0.7392662, 'precision': 0.78523695, 'recall': 0.7359191, 'specificity': 0.7359191, 'f1': 0.72647667, 'auroc': 0.8865628, 'binary_precision': 0.8957219, 'binary_recall': 0.53174603, 'binary_specificity': 0.94009215, 'binary_f1_score': 0.6673307}
confusion matrix:
     0    1
0  612   39
1  295  335
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8333333, 'precision': 0.8499295, 'recall': 0.8333334, 'specificity': 0.8333334, 'f1': 0.8313335, 'auroc': 0.911842, 'binary_precision': 0.9261364, 'binary_recall': 0.72444445, 'binary_specificity': 0.94222224, 'binary_f1_score': 0.8129676}
confusion matrix:
     0    1
0  212   13
1   62  163
early stop counter: 9
val acc:0.7392662167549133, best validation acc: 0.8836846351623535, corresponding to test acc:                         0.8622221946716309 / 0.8755555748939514
after epoch: 25,now: 2024-07-23 12:43:51.067581,epoch time: 0:02:16.744653,used: 0:57:38.959786,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_11_46_12_seed_1_22795134
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9921875, 'precision': 0.9922324, 'recall': 0.9921523, 'specificity': 0.9921523, 'f1': 0.9921856, 'auroc': 0.9998338, 'binary_precision': 0.9897698, 'binary_recall': 0.9948586, 'binary_specificity': 0.9894459, 'binary_f1_score': 0.99230766}
confusion matrix:
      0     1
0  1500    16
1     8  1548
---- Validation: 
scalar performance:
{'acc': 0.88056207, 'precision': 0.88521004, 'recall': 0.8796723, 'specificity': 0.8796723, 'f1': 0.8799957, 'auroc': 0.92746687, 'binary_precision': 0.92362344, 'binary_recall': 0.82539684, 'binary_specificity': 0.9339478, 'binary_f1_score': 0.87175184}
confusion matrix:
     0    1
0  608   43
1  110  520
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8511111, 'precision': 0.85419655, 'recall': 0.8511111, 'specificity': 0.8511111, 'f1': 0.8507862, 'auroc': 0.92321974, 'binary_precision': 0.8872549, 'binary_recall': 0.80444443, 'binary_specificity': 0.8977778, 'binary_f1_score': 0.8438229}
confusion matrix:
     0    1
0  202   23
1   44  181
early stop counter: 10
val acc:0.8805620670318604, best validation acc: 0.8836846351623535, corresponding to test acc:                         0.8622221946716309 / 0.8755555748939514
after epoch: 26,now: 2024-07-23 12:46:02.438504,epoch time: 0:02:11.370923,used: 0:59:50.330709,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_11_46_12_seed_1_22795134
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.98828125, 'precision': 0.98838115, 'recall': 0.98842335, 'specificity': 0.98842335, 'f1': 0.98828125, 'auroc': 0.9999008, 'binary_precision': 0.999343, 'binary_recall': 0.9775064, 'binary_specificity': 0.99934036, 'binary_f1_score': 0.98830414}
confusion matrix:
      0     1
0  1515     1
1    35  1521
---- Validation: 
scalar performance:
{'acc': 0.5870414, 'precision': 0.73843277, 'recall': 0.58038914, 'specificity': 0.58038914, 'f1': 0.50097173, 'auroc': 0.90240896, 'binary_precision': 0.92436975, 'binary_recall': 0.17460318, 'binary_specificity': 0.9861751, 'binary_f1_score': 0.29372498}
confusion matrix:
     0    1
0  642    9
1  520  110
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5822222, 'precision': 0.7378436, 'recall': 0.5822222, 'specificity': 0.5822222, 'f1': 0.5005196, 'auroc': 0.9184197, 'binary_precision': 0.9302326, 'binary_recall': 0.17777778, 'binary_specificity': 0.9866667, 'binary_f1_score': 0.29850745}
confusion matrix:
     0   1
0  222   3
1  185  40
early stop counter: 11
val acc:0.5870413780212402, best validation acc: 0.8836846351623535, corresponding to test acc:                         0.8622221946716309 / 0.8755555748939514
after epoch: 27,now: 2024-07-23 12:48:18.742664,epoch time: 0:02:16.304160,used: 1:02:06.634869,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_11_46_12_seed_1_22795134
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.98339844, 'precision': 0.9836938, 'recall': 0.98360336, 'specificity': 0.98360336, 'f1': 0.9833983, 'auroc': 0.9996753, 'binary_precision': 0.9993364, 'binary_recall': 0.9678663, 'binary_specificity': 0.99934036, 'binary_f1_score': 0.9833497}
confusion matrix:
      0     1
0  1515     1
1    50  1506
---- Validation: 
scalar performance:
{'acc': 0.7962529, 'precision': 0.83907914, 'recall': 0.793318, 'specificity': 0.793318, 'f1': 0.7884513, 'auroc': 0.924747, 'binary_precision': 0.95555556, 'binary_recall': 0.6142857, 'binary_specificity': 0.97235024, 'binary_f1_score': 0.74782604}
confusion matrix:
     0    1
0  633   18
1  243  387
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.79333335, 'precision': 0.84774256, 'recall': 0.7933333, 'specificity': 0.7933333, 'f1': 0.7849202, 'auroc': 0.9398123, 'binary_precision': 0.9852941, 'binary_recall': 0.59555554, 'binary_specificity': 0.9911111, 'binary_f1_score': 0.7423822}
confusion matrix:
     0    1
0  223    2
1   91  134
early stop counter: 12
val acc:0.7962529063224792, best validation acc: 0.8836846351623535, corresponding to test acc:                         0.8622221946716309 / 0.8755555748939514
after epoch: 28,now: 2024-07-23 12:50:35.915450,epoch time: 0:02:17.172786,used: 1:04:23.807655,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_11_46_12_seed_1_22795134
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9944661, 'precision': 0.99447846, 'recall': 0.9944539, 'specificity': 0.9944539, 'f1': 0.99446523, 'auroc': 0.999733, 'binary_precision': 0.9935774, 'binary_recall': 0.9954955, 'binary_specificity': 0.9934124, 'binary_f1_score': 0.9945355}
confusion matrix:
      0     1
0  1508    10
1     7  1547
---- Validation: 
scalar performance:
{'acc': 0.84231067, 'precision': 0.86483383, 'recall': 0.84027135, 'specificity': 0.84027135, 'f1': 0.8392415, 'auroc': 0.9313047, 'binary_precision': 0.9514768, 'binary_recall': 0.715873, 'binary_specificity': 0.96466976, 'binary_f1_score': 0.81702894}
confusion matrix:
     0    1
0  628   23
1  179  451
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8511111, 'precision': 0.8734244, 'recall': 0.8511111, 'specificity': 0.8511111, 'f1': 0.8488533, 'auroc': 0.9262222, 'binary_precision': 0.9647059, 'binary_recall': 0.72888887, 'binary_specificity': 0.97333336, 'binary_f1_score': 0.8303798}
confusion matrix:
     0    1
0  219    6
1   61  164
early stop counter: 13
val acc:0.8423106670379639, best validation acc: 0.8836846351623535, corresponding to test acc:                         0.8622221946716309 / 0.8755555748939514
after epoch: 29,now: 2024-07-23 12:52:57.296559,epoch time: 0:02:21.381109,used: 1:06:45.188764,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_11_46_12_seed_1_22795134
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.9947917, 'precision': 0.994791, 'recall': 0.994791, 'specificity': 0.994791, 'f1': 0.994791, 'auroc': 0.99986815, 'binary_precision': 0.994852, 'binary_recall': 0.994852, 'binary_specificity': 0.99472994, 'binary_f1_score': 0.994852}
confusion matrix:
      0     1
0  1510     8
1     8  1546
---- Validation: 
scalar performance:
{'acc': 0.8251366, 'precision': 0.85401523, 'recall': 0.8227855, 'specificity': 0.8227855, 'f1': 0.8207228, 'auroc': 0.93035626, 'binary_precision': 0.95111114, 'binary_recall': 0.6793651, 'binary_specificity': 0.96620584, 'binary_f1_score': 0.79259264}
confusion matrix:
     0    1
0  629   22
1  202  428
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.82, 'precision': 0.8553878, 'recall': 0.82, 'specificity': 0.82, 'f1': 0.8154047, 'auroc': 0.9255309, 'binary_precision': 0.96753246, 'binary_recall': 0.6622222, 'binary_specificity': 0.9777778, 'binary_f1_score': 0.7862797}
confusion matrix:
     0    1
0  220    5
1   76  149
early stop counter: 14
val acc:0.8251366019248962, best validation acc: 0.8836846351623535, corresponding to test acc:                         0.8622221946716309 / 0.8755555748939514
after epoch: 30,now: 2024-07-23 12:55:17.179772,epoch time: 0:02:19.883213,used: 1:09:05.071977,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_11_46_12_seed_1_22795134
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 1:09:05.071977 at 2024-07-23 12:55:17.179772
persisted model performance metric: 

scalar performance:
{'acc': 0.8622222, 'precision': 0.8632555, 'recall': 0.8622222, 'specificity': 0.8622222, 'f1': 0.86212415, 'auroc': 0.9083655, 'binary_precision': 0.8826291, 'binary_recall': 0.83555555, 'binary_specificity': 0.8888889, 'binary_f1_score': 0.85844743}
confusion matrix:
     0    1
0  200   25
1   37  188
oracle model performance metric: 

scalar performance:
{'acc': 0.8755556, 'precision': 0.87701523, 'recall': 0.8755556, 'specificity': 0.8755556, 'f1': 0.87543505, 'auroc': 0.94012845, 'binary_precision': 0.8535565, 'binary_recall': 0.9066667, 'binary_specificity': 0.84444445, 'binary_f1_score': 0.8793104}
confusion matrix:
     0    1
0  190   35
1   21  204
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_dial_lr1e5_bs32__45_nofreeze_2024-07-23_10-43-50/rule_results/4.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_dial_lr1e5_bs32__45_nofreeze_2024-07-23_10-43-50/confusion_matrix/4.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 453153 KiB |  26075 MiB | 145141 GiB | 145141 GiB |
|       from large pool | 412597 KiB |  26030 MiB | 144234 GiB | 144234 GiB |
|       from small pool |  40556 KiB |     60 MiB |    906 GiB |    906 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 453153 KiB |  26075 MiB | 145141 GiB | 145141 GiB |
|       from large pool | 412597 KiB |  26030 MiB | 144234 GiB | 144234 GiB |
|       from small pool |  40556 KiB |     60 MiB |    906 GiB |    906 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 447481 KiB |  26071 MiB | 145115 GiB | 145115 GiB |
|       from large pool | 407075 KiB |  26026 MiB | 144210 GiB | 144210 GiB |
|       from small pool |  40406 KiB |     60 MiB |    905 GiB |    905 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  27768 MiB |  27768 MiB |  54304 MiB |  26536 MiB |
|       from large pool |  27696 MiB |  27696 MiB |  54218 MiB |  26522 MiB |
|       from small pool |     72 MiB |     72 MiB |     86 MiB |     14 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 738782 KiB |   1678 MiB |  64539 GiB |  64538 GiB |
|       from large pool | 721995 KiB |   1668 MiB |  63626 GiB |  63625 GiB |
|       from small pool |  16787 KiB |     31 MiB |    913 GiB |    913 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    1226    |    2570    |   13121 K  |   13120 K  |
|       from large pool |     187    |    1413    |    6645 K  |    6645 K  |
|       from small pool |    1039    |    1335    |    6476 K  |    6475 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    1226    |    2570    |   13121 K  |   13120 K  |
|       from large pool |     187    |    1413    |    6645 K  |    6645 K  |
|       from small pool |    1039    |    1335    |    6476 K  |    6475 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     835    |     835    |    1603    |     768    |
|       from large pool |     799    |     800    |    1560    |     761    |
|       from small pool |      36    |      36    |      43    |       7    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     105    |     855    |    9558 K  |    9558 K  |
|       from large pool |      40    |     801    |    5873 K  |    5873 K  |
|       from small pool |      65    |     148    |    3685 K  |    3685 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  26075 MiB | 145141 GiB | 145141 GiB |
|       from large pool |  16640 KiB |  26030 MiB | 144234 GiB | 144234 GiB |
|       from small pool |      0 KiB |     60 MiB |    906 GiB |    906 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  26075 MiB | 145141 GiB | 145141 GiB |
|       from large pool |  16640 KiB |  26030 MiB | 144234 GiB | 144234 GiB |
|       from small pool |      0 KiB |     60 MiB |    906 GiB |    906 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  26071 MiB | 145115 GiB | 145115 GiB |
|       from large pool |  16640 KiB |  26026 MiB | 144210 GiB | 144210 GiB |
|       from small pool |      0 KiB |     60 MiB |    905 GiB |    905 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1164 MiB |  27768 MiB |  54304 MiB |  53140 MiB |
|       from large pool |   1108 MiB |  27696 MiB |  54218 MiB |  53110 MiB |
|       from small pool |     56 MiB |     72 MiB |     86 MiB |     30 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |   3840 KiB |   1678 MiB |  64539 GiB |  64539 GiB |
|       from large pool |   3840 KiB |   1668 MiB |  63626 GiB |  63626 GiB |
|       from small pool |      0 KiB |     34 MiB |    913 GiB |    913 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    2570    |   13121 K  |   13121 K  |
|       from large pool |       2    |    1413    |    6645 K  |    6645 K  |
|       from small pool |       0    |    1335    |    6476 K  |    6476 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    2570    |   13121 K  |   13121 K  |
|       from large pool |       2    |    1413    |    6645 K  |    6645 K  |
|       from small pool |       0    |    1335    |    6476 K  |    6476 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      69    |     835    |    1603    |    1534    |
|       from large pool |      41    |     800    |    1560    |    1519    |
|       from small pool |      28    |      36    |      43    |      15    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       1    |     855    |    9559 K  |    9559 K  |
|       from large pool |       1    |     801    |    5873 K  |    5873 K  |
|       from small pool |       0    |     148    |    3685 K  |    3685 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  26075 MiB | 145141 GiB | 145141 GiB |
|       from large pool |  16640 KiB |  26030 MiB | 144234 GiB | 144234 GiB |
|       from small pool |      0 KiB |     60 MiB |    906 GiB |    906 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  26075 MiB | 145141 GiB | 145141 GiB |
|       from large pool |  16640 KiB |  26030 MiB | 144234 GiB | 144234 GiB |
|       from small pool |      0 KiB |     60 MiB |    906 GiB |    906 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  26071 MiB | 145115 GiB | 145115 GiB |
|       from large pool |  16640 KiB |  26026 MiB | 144210 GiB | 144210 GiB |
|       from small pool |      0 KiB |     60 MiB |    905 GiB |    905 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1164 MiB |  27768 MiB |  54304 MiB |  53140 MiB |
|       from large pool |   1108 MiB |  27696 MiB |  54218 MiB |  53110 MiB |
|       from small pool |     56 MiB |     72 MiB |     86 MiB |     30 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |   3840 KiB |   1678 MiB |  64539 GiB |  64539 GiB |
|       from large pool |   3840 KiB |   1668 MiB |  63626 GiB |  63626 GiB |
|       from small pool |      0 KiB |     34 MiB |    913 GiB |    913 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    2570    |   13121 K  |   13121 K  |
|       from large pool |       2    |    1413    |    6645 K  |    6645 K  |
|       from small pool |       0    |    1335    |    6476 K  |    6476 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    2570    |   13121 K  |   13121 K  |
|       from large pool |       2    |    1413    |    6645 K  |    6645 K  |
|       from small pool |       0    |    1335    |    6476 K  |    6476 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      69    |     835    |    1603    |    1534    |
|       from large pool |      41    |     800    |    1560    |    1519    |
|       from small pool |      28    |      36    |      43    |      15    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       1    |     855    |    9559 K  |    9559 K  |
|       from large pool |       1    |     801    |    5873 K  |    5873 K  |
|       from small pool |       0    |     148    |    3685 K  |    3685 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'888c1ef2'
model name: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_12_58_01_seed_2_22795134

 Experiment start at: 2024-07-23 12:58:01.381065
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
before training, model accuracy: 0.41203704476356506
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.92960525, 'precision': 0.93206704, 'recall': 0.92991257, 'specificity': 0.92991257, 'f1': 0.929535, 'auroc': 0.9760511, 'binary_precision': 0.9667139, 'binary_recall': 0.89099216, 'binary_specificity': 0.9688329, 'binary_f1_score': 0.92730975}
confusion matrix:
      0     1
0  1461    47
1   167  1365
---- Validation: 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
scalar performance:
{'acc': 0.79264474, 'precision': 0.79299784, 'recall': 0.793102, 'specificity': 0.793102, 'f1': 0.7926415, 'auroc': 0.87986726, 'binary_precision': 0.7741935, 'binary_recall': 0.8102894, 'binary_specificity': 0.7759146, 'binary_f1_score': 0.7918303}
confusion matrix:
     0    1
0  509  147
1  118  504
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7962963, 'precision': 0.80294526, 'recall': 0.7962963, 'specificity': 0.7962963, 'f1': 0.7951724, 'auroc': 0.896262, 'binary_precision': 0.7580645, 'binary_recall': 0.8703704, 'binary_specificity': 0.7222222, 'binary_f1_score': 0.8103448}
confusion matrix:
     0    1
0  156   60
1   28  188
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-23 13:00:27.587198,epoch time: 0:02:26.206133,used: 0:02:26.206133,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_12_58_01_seed_2_22795134
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.94177634, 'precision': 0.9457272, 'recall': 0.94219124, 'specificity': 0.94219124, 'f1': 0.9416808, 'auroc': 0.9892037, 'binary_precision': 0.9898844, 'binary_recall': 0.8936725, 'binary_specificity': 0.99071, 'binary_f1_score': 0.9393212}
confusion matrix:
      0     1
0  1493    14
1   163  1370
---- Validation: 
scalar performance:
{'acc': 0.8286385, 'precision': 0.841266, 'recall': 0.8260381, 'specificity': 0.8260381, 'f1': 0.8261468, 'auroc': 0.90488005, 'binary_precision': 0.90059644, 'binary_recall': 0.7282958, 'binary_specificity': 0.9237805, 'binary_f1_score': 0.8053334}
confusion matrix:
     0    1
0  606   50
1  169  453
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8518519, 'precision': 0.85188204, 'recall': 0.8518518, 'specificity': 0.8518518, 'f1': 0.8518487, 'auroc': 0.9221536, 'binary_precision': 0.8551402, 'binary_recall': 0.8472222, 'binary_specificity': 0.8564815, 'binary_f1_score': 0.85116285}
confusion matrix:
     0    1
0  185   31
1   33  183
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-07-23 13:02:42.499136,epoch time: 0:02:14.911938,used: 0:04:41.118071,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_12_58_01_seed_2_22795134
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9625, 'precision': 0.96301544, 'recall': 0.9623885, 'specificity': 0.9623885, 'f1': 0.96248126, 'auroc': 0.9948673, 'binary_precision': 0.9492708, 'binary_recall': 0.97779226, 'binary_specificity': 0.94698477, 'binary_f1_score': 0.9633205}
confusion matrix:
      0     1
0  1429    80
1    34  1497
---- Validation: 
scalar performance:
{'acc': 0.7683881, 'precision': 0.77587736, 'recall': 0.77047384, 'specificity': 0.77047384, 'f1': 0.76760894, 'auroc': 0.867905, 'binary_precision': 0.72328764, 'binary_recall': 0.84887457, 'binary_specificity': 0.69207317, 'binary_f1_score': 0.78106505}
confusion matrix:
     0    1
0  454  202
1   94  528
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7314815, 'precision': 0.7827817, 'recall': 0.73148143, 'specificity': 0.73148143, 'f1': 0.7187247, 'auroc': 0.92532575, 'binary_precision': 0.66233766, 'binary_recall': 0.9444444, 'binary_specificity': 0.5185185, 'binary_f1_score': 0.7786259}
confusion matrix:
     0    1
0  112  104
1   12  204
early stop counter: 1
val acc:0.7683880925178528, best validation acc: 0.82863849401474, corresponding to test acc:                         0.8518518805503845 / 0.8518518805503845
after epoch: 3,now: 2024-07-23 13:04:55.948887,epoch time: 0:02:13.449751,used: 0:06:54.567822,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_12_58_01_seed_2_22795134
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9753289, 'precision': 0.97576034, 'recall': 0.9754875, 'specificity': 0.9754875, 'f1': 0.97532725, 'auroc': 0.9967544, 'binary_precision': 0.9925726, 'binary_recall': 0.958279, 'binary_specificity': 0.99269587, 'binary_f1_score': 0.97512436}
confusion matrix:
      0     1
0  1495    11
1    64  1470
---- Validation: 
scalar performance:
{'acc': 0.80359936, 'precision': 0.8078324, 'recall': 0.80193955, 'specificity': 0.80193955, 'f1': 0.8022129, 'auroc': 0.8875891, 'binary_precision': 0.83788705, 'binary_recall': 0.7395498, 'binary_specificity': 0.8643293, 'binary_f1_score': 0.7856532}
confusion matrix:
     0    1
0  567   89
1  162  460
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8148148, 'precision': 0.8194432, 'recall': 0.8148148, 'specificity': 0.8148148, 'f1': 0.81414163, 'auroc': 0.9174812, 'binary_precision': 0.78099173, 'binary_recall': 0.875, 'binary_specificity': 0.7546296, 'binary_f1_score': 0.8253275}
confusion matrix:
     0    1
0  163   53
1   27  189
early stop counter: 2
val acc:0.8035993576049805, best validation acc: 0.82863849401474, corresponding to test acc:                         0.8518518805503845 / 0.8518518805503845
after epoch: 4,now: 2024-07-23 13:07:05.937467,epoch time: 0:02:09.988580,used: 0:09:04.556402,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_12_58_01_seed_2_22795134
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.975, 'precision': 0.97552013, 'recall': 0.9751859, 'specificity': 0.9751859, 'f1': 0.9749979, 'auroc': 0.9976058, 'binary_precision': 0.99390656, 'binary_recall': 0.9563518, 'binary_specificity': 0.9940199, 'binary_f1_score': 0.97476757}
confusion matrix:
      0     1
0  1496     9
1    67  1468
---- Validation: 
scalar performance:
{'acc': 0.6760563, 'precision': 0.75663435, 'recall': 0.6683692, 'specificity': 0.6683692, 'f1': 0.6424136, 'auroc': 0.85462415, 'binary_precision': 0.8939394, 'binary_recall': 0.37942123, 'binary_specificity': 0.95731705, 'binary_f1_score': 0.53273135}
confusion matrix:
     0    1
0  628   28
1  386  236
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8240741, 'precision': 0.8323077, 'recall': 0.8240741, 'specificity': 0.8240741, 'f1': 0.82297754, 'auroc': 0.8979981, 'binary_precision': 0.88461536, 'binary_recall': 0.7453704, 'binary_specificity': 0.9027778, 'binary_f1_score': 0.8090452}
confusion matrix:
     0    1
0  195   21
1   55  161
early stop counter: 3
val acc:0.6760563254356384, best validation acc: 0.82863849401474, corresponding to test acc:                         0.8518518805503845 / 0.8518518805503845
after epoch: 5,now: 2024-07-23 13:09:25.300191,epoch time: 0:02:19.362724,used: 0:11:23.919126,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_12_58_01_seed_2_22795134
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.98223686, 'precision': 0.98240906, 'recall': 0.9823097, 'specificity': 0.9823097, 'f1': 0.98223644, 'auroc': 0.9976834, 'binary_precision': 0.9933155, 'binary_recall': 0.97124183, 'binary_specificity': 0.9933775, 'binary_f1_score': 0.9821546}
confusion matrix:
      0     1
0  1500    10
1    44  1486
---- Validation: 
scalar performance:
{'acc': 0.7738654, 'precision': 0.80691755, 'recall': 0.7693931, 'specificity': 0.7693931, 'f1': 0.76552737, 'auroc': 0.850296, 'binary_precision': 0.9012048, 'binary_recall': 0.6012862, 'binary_specificity': 0.9375, 'binary_f1_score': 0.72131145}
confusion matrix:
     0    1
0  615   41
1  248  374
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8518519, 'precision': 0.8685676, 'recall': 0.8518518, 'specificity': 0.8518518, 'f1': 0.85015285, 'auroc': 0.90775037, 'binary_precision': 0.9470588, 'binary_recall': 0.7453704, 'binary_specificity': 0.9583333, 'binary_f1_score': 0.8341969}
confusion matrix:
     0    1
0  207    9
1   55  161
early stop counter: 4
val acc:0.7738654017448425, best validation acc: 0.82863849401474, corresponding to test acc:                         0.8518518805503845 / 0.8518518805503845
after epoch: 6,now: 2024-07-23 13:11:39.738922,epoch time: 0:02:14.438731,used: 0:13:38.357857,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_12_58_01_seed_2_22795134
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9828947, 'precision': 0.9828926, 'recall': 0.98291767, 'specificity': 0.98291767, 'f1': 0.9828945, 'auroc': 0.99802667, 'binary_precision': 0.9861933, 'binary_recall': 0.9797518, 'binary_specificity': 0.9860835, 'binary_f1_score': 0.982962}
confusion matrix:
      0     1
0  1488    21
1    31  1500
---- Validation: 
scalar performance:
{'acc': 0.81064165, 'precision': 0.8112484, 'recall': 0.80992424, 'specificity': 0.80992424, 'f1': 0.81019497, 'auroc': 0.8746667, 'binary_precision': 0.81986535, 'binary_recall': 0.7829582, 'binary_specificity': 0.8368902, 'binary_f1_score': 0.80098695}
confusion matrix:
     0    1
0  549  107
1  135  487
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8217593, 'precision': 0.8248296, 'recall': 0.8217592, 'specificity': 0.8217592, 'f1': 0.8213371, 'auroc': 0.9202889, 'binary_precision': 0.79324895, 'binary_recall': 0.8703704, 'binary_specificity': 0.7731481, 'binary_f1_score': 0.8300221}
confusion matrix:
     0    1
0  167   49
1   28  188
early stop counter: 5
val acc:0.8106416463851929, best validation acc: 0.82863849401474, corresponding to test acc:                         0.8518518805503845 / 0.8518518805503845
after epoch: 7,now: 2024-07-23 13:13:57.879859,epoch time: 0:02:18.140937,used: 0:15:56.498794,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_12_58_01_seed_2_22795134
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.97335523, 'precision': 0.97431886, 'recall': 0.9735643, 'specificity': 0.9735643, 'f1': 0.9733484, 'auroc': 0.9965091, 'binary_precision': 0.9979424, 'binary_recall': 0.9491194, 'binary_specificity': 0.99800926, 'binary_f1_score': 0.97291875}
confusion matrix:
      0     1
0  1504     3
1    78  1455
---- Validation: 
scalar performance:
{'acc': 0.7237872, 'precision': 0.79963946, 'recall': 0.71694624, 'specificity': 0.71694624, 'f1': 0.7009734, 'auroc': 0.89758396, 'binary_precision': 0.9438944, 'binary_recall': 0.45980707, 'binary_specificity': 0.9740854, 'binary_f1_score': 0.6183784}
confusion matrix:
     0    1
0  639   17
1  336  286
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6666667, 'precision': 0.7935226, 'recall': 0.6666667, 'specificity': 0.6666667, 'f1': 0.6262886, 'auroc': 0.8753215, 'binary_precision': 0.9864865, 'binary_recall': 0.33796296, 'binary_specificity': 0.9953704, 'binary_f1_score': 0.5034483}
confusion matrix:
     0   1
0  215   1
1  143  73
early stop counter: 6
val acc:0.7237871885299683, best validation acc: 0.82863849401474, corresponding to test acc:                         0.8518518805503845 / 0.8518518805503845
after epoch: 8,now: 2024-07-23 13:16:10.549204,epoch time: 0:02:12.669345,used: 0:18:09.168139,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_12_58_01_seed_2_22795134
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.98618424, 'precision': 0.9862227, 'recall': 0.9862311, 'specificity': 0.9862311, 'f1': 0.98618424, 'auroc': 0.99902606, 'binary_precision': 0.99272007, 'binary_recall': 0.9797518, 'binary_specificity': 0.9927104, 'binary_f1_score': 0.9861933}
confusion matrix:
      0     1
0  1498    11
1    31  1500
---- Validation: 
scalar performance:
{'acc': 0.6635368, 'precision': 0.7427838, 'recall': 0.65567404, 'specificity': 0.65567404, 'f1': 0.6269965, 'auroc': 0.84958285, 'binary_precision': 0.875, 'binary_recall': 0.3601286, 'binary_specificity': 0.9512195, 'binary_f1_score': 0.51025057}
confusion matrix:
     0    1
0  624   32
1  398  224
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7685185, 'precision': 0.78786767, 'recall': 0.7685185, 'specificity': 0.7685185, 'f1': 0.76456225, 'auroc': 0.86934155, 'binary_precision': 0.8625, 'binary_recall': 0.6388889, 'binary_specificity': 0.8981481, 'binary_f1_score': 0.7340425}
confusion matrix:
     0    1
0  194   22
1   78  138
early stop counter: 7
val acc:0.663536787033081, best validation acc: 0.82863849401474, corresponding to test acc:                         0.8518518805503845 / 0.8518518805503845
after epoch: 9,now: 2024-07-23 13:18:27.196681,epoch time: 0:02:16.647477,used: 0:20:25.815616,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_12_58_01_seed_2_22795134
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9855263, 'precision': 0.9855584, 'recall': 0.9855046, 'specificity': 0.9855046, 'f1': 0.98552465, 'auroc': 0.9989538, 'binary_precision': 0.98311687, 'binary_recall': 0.9882507, 'binary_specificity': 0.98275864, 'binary_f1_score': 0.98567706}
confusion matrix:
      0     1
0  1482    26
1    18  1514
---- Validation: 
scalar performance:
{'acc': 0.73239434, 'precision': 0.77481663, 'recall': 0.7269969, 'specificity': 0.7269969, 'f1': 0.71849275, 'auroc': 0.8735198, 'binary_precision': 0.8763441, 'binary_recall': 0.52411574, 'binary_specificity': 0.92987806, 'binary_f1_score': 0.65593565}
confusion matrix:
     0    1
0  610   46
1  296  326
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8564815, 'precision': 0.8579854, 'recall': 0.8564815, 'specificity': 0.8564815, 'f1': 0.85633063, 'auroc': 0.92787635, 'binary_precision': 0.8811881, 'binary_recall': 0.8240741, 'binary_specificity': 0.8888889, 'binary_f1_score': 0.8516746}
confusion matrix:
     0    1
0  192   24
1   38  178
new oracle model saved
early stop counter: 8
val acc:0.7323943376541138, best validation acc: 0.82863849401474, corresponding to test acc:                         0.8518518805503845 / 0.8564814925193787
after epoch: 10,now: 2024-07-23 13:20:48.446022,epoch time: 0:02:21.249341,used: 0:22:47.064957,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_12_58_01_seed_2_22795134
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.98125, 'precision': 0.9815747, 'recall': 0.9811734, 'specificity': 0.9811734, 'f1': 0.98124385, 'auroc': 0.9989642, 'binary_precision': 0.97060704, 'binary_recall': 0.9928104, 'binary_specificity': 0.9695364, 'binary_f1_score': 0.9815831}
confusion matrix:
      0     1
0  1464    46
1    11  1519
---- Validation: 
scalar performance:
{'acc': 0.7660407, 'precision': 0.8039168, 'recall': 0.7612295, 'specificity': 0.7612295, 'f1': 0.75618076, 'auroc': 0.87564456, 'binary_precision': 0.9047619, 'binary_recall': 0.58038586, 'binary_specificity': 0.94207317, 'binary_f1_score': 0.70714986}
confusion matrix:
     0    1
0  618   38
1  261  361
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7986111, 'precision': 0.8347831, 'recall': 0.79861116, 'specificity': 0.79861116, 'f1': 0.79302025, 'auroc': 0.8797154, 'binary_precision': 0.94482756, 'binary_recall': 0.6342593, 'binary_specificity': 0.962963, 'binary_f1_score': 0.7590028}
confusion matrix:
     0    1
0  208    8
1   79  137
early stop counter: 9
val acc:0.7660406827926636, best validation acc: 0.82863849401474, corresponding to test acc:                         0.8518518805503845 / 0.8564814925193787
after epoch: 11,now: 2024-07-23 13:23:08.957234,epoch time: 0:02:20.511212,used: 0:25:07.576169,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_12_58_01_seed_2_22795134
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9792763, 'precision': 0.97988987, 'recall': 0.9794464, 'specificity': 0.9794464, 'f1': 0.97927356, 'auroc': 0.998672, 'binary_precision': 0.9993206, 'binary_recall': 0.9595564, 'binary_specificity': 0.9993364, 'binary_f1_score': 0.9790349}
confusion matrix:
      0     1
0  1506     1
1    62  1471
---- Validation: 
scalar performance:
{'acc': 0.59546167, 'precision': 0.7542901, 'recall': 0.5846551, 'specificity': 0.5846551, 'f1': 0.50793546, 'auroc': 0.816428, 'binary_precision': 0.94871795, 'binary_recall': 0.17845659, 'binary_specificity': 0.99085367, 'binary_f1_score': 0.30040595}
confusion matrix:
     0    1
0  650    6
1  511  111
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5347222, 'precision': 0.6481482, 'recall': 0.5347222, 'specificity': 0.5347222, 'f1': 0.424584, 'auroc': 0.8298611, 'binary_precision': 0.7777778, 'binary_recall': 0.097222224, 'binary_specificity': 0.9722222, 'binary_f1_score': 0.17283951}
confusion matrix:
     0   1
0  210   6
1  195  21
early stop counter: 10
val acc:0.5954616665840149, best validation acc: 0.82863849401474, corresponding to test acc:                         0.8518518805503845 / 0.8564814925193787
after epoch: 12,now: 2024-07-23 13:25:23.042966,epoch time: 0:02:14.085732,used: 0:27:21.661901,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_12_58_01_seed_2_22795134
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.99111843, 'precision': 0.9911202, 'recall': 0.99111617, 'specificity': 0.99111617, 'f1': 0.9911181, 'auroc': 0.9996767, 'binary_precision': 0.9908497, 'binary_recall': 0.9914977, 'binary_specificity': 0.99073464, 'binary_f1_score': 0.99117357}
confusion matrix:
      0     1
0  1497    14
1    13  1516
---- Validation: 
scalar performance:
{'acc': 0.74960876, 'precision': 0.8002666, 'recall': 0.74401516, 'specificity': 0.74401516, 'f1': 0.73561716, 'auroc': 0.8791982, 'binary_precision': 0.9171271, 'binary_recall': 0.53376204, 'binary_specificity': 0.9542683, 'binary_f1_score': 0.6747967}
confusion matrix:
     0    1
0  626   30
1  290  332
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7407407, 'precision': 0.77901435, 'recall': 0.7407408, 'specificity': 0.7407408, 'f1': 0.7315341, 'auroc': 0.8602538, 'binary_precision': 0.88235295, 'binary_recall': 0.5555556, 'binary_specificity': 0.9259259, 'binary_f1_score': 0.6818182}
confusion matrix:
     0    1
0  200   16
1   96  120
early stop counter: 11
val acc:0.7496087551116943, best validation acc: 0.82863849401474, corresponding to test acc:                         0.8518518805503845 / 0.8564814925193787
after epoch: 13,now: 2024-07-23 13:27:33.233144,epoch time: 0:02:10.190178,used: 0:29:31.852079,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_12_58_01_seed_2_22795134
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.98815787, 'precision': 0.98816323, 'recall': 0.98815143, 'specificity': 0.98815143, 'f1': 0.9881569, 'auroc': 0.99941266, 'binary_precision': 0.98762214, 'binary_recall': 0.9889106, 'binary_specificity': 0.9873922, 'binary_f1_score': 0.988266}
confusion matrix:
      0     1
0  1488    19
1    17  1516
---- Validation: 
scalar performance:
{'acc': 0.58372456, 'precision': 0.67946064, 'recall': 0.57355547, 'specificity': 0.57355547, 'f1': 0.5056093, 'auroc': 0.75947225, 'binary_precision': 0.8040541, 'binary_recall': 0.19131833, 'binary_specificity': 0.95579267, 'binary_f1_score': 0.3090909}
confusion matrix:
     0    1
0  627   29
1  503  119
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6157407, 'precision': 0.66741073, 'recall': 0.6157407, 'specificity': 0.6157407, 'f1': 0.5836121, 'auroc': 0.7419839, 'binary_precision': 0.7604167, 'binary_recall': 0.33796296, 'binary_specificity': 0.8935185, 'binary_f1_score': 0.46794873}
confusion matrix:
     0   1
0  193  23
1  143  73
early stop counter: 12
val acc:0.5837245583534241, best validation acc: 0.82863849401474, corresponding to test acc:                         0.8518518805503845 / 0.8564814925193787
after epoch: 14,now: 2024-07-23 13:29:44.318269,epoch time: 0:02:11.085125,used: 0:31:42.937204,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_12_58_01_seed_2_22795134
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9884868, 'precision': 0.98860574, 'recall': 0.988441, 'specificity': 0.988441, 'f1': 0.98848474, 'auroc': 0.99951005, 'binary_precision': 0.98258066, 'binary_recall': 0.99477464, 'binary_specificity': 0.98210734, 'binary_f1_score': 0.98864007}
confusion matrix:
      0     1
0  1482    27
1     8  1523
---- Validation: 
scalar performance:
{'acc': 0.78951484, 'precision': 0.79954946, 'recall': 0.78697014, 'specificity': 0.78697014, 'f1': 0.78661436, 'auroc': 0.86253774, 'binary_precision': 0.84812623, 'binary_recall': 0.69131833, 'binary_specificity': 0.88262194, 'binary_f1_score': 0.7617361}
confusion matrix:
     0    1
0  579   77
1  192  430
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7731481, 'precision': 0.77352333, 'recall': 0.7731482, 'specificity': 0.7731482, 'f1': 0.77307034, 'auroc': 0.8441572, 'binary_precision': 0.76339287, 'binary_recall': 0.7916667, 'binary_specificity': 0.7546296, 'binary_f1_score': 0.77727276}
confusion matrix:
     0    1
0  163   53
1   45  171
early stop counter: 13
val acc:0.7895148396492004, best validation acc: 0.82863849401474, corresponding to test acc:                         0.8518518805503845 / 0.8564814925193787
after epoch: 15,now: 2024-07-23 13:32:01.476591,epoch time: 0:02:17.158322,used: 0:34:00.095526,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_12_58_01_seed_2_22795134
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9907895, 'precision': 0.9907807, 'recall': 0.9908113, 'specificity': 0.9908113, 'f1': 0.9907892, 'auroc': 0.9994745, 'binary_precision': 0.9934426, 'binary_recall': 0.9882583, 'binary_specificity': 0.9933643, 'binary_f1_score': 0.99084365}
confusion matrix:
      0     1
0  1497    10
1    18  1515
---- Validation: 
scalar performance:
{'acc': 0.6510172, 'precision': 0.7666136, 'recall': 0.6420207, 'specificity': 0.6420207, 'f1': 0.60061604, 'auroc': 0.86431706, 'binary_precision': 0.93564355, 'binary_recall': 0.30385852, 'binary_specificity': 0.98018295, 'binary_f1_score': 0.45873788}
confusion matrix:
     0    1
0  643   13
1  433  189
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6064815, 'precision': 0.7056632, 'recall': 0.6064815, 'specificity': 0.6064815, 'f1': 0.55253345, 'auroc': 0.7830504, 'binary_precision': 0.8484849, 'binary_recall': 0.25925925, 'binary_specificity': 0.9537037, 'binary_f1_score': 0.39716312}
confusion matrix:
     0   1
0  206  10
1  160  56
early stop counter: 14
val acc:0.6510171890258789, best validation acc: 0.82863849401474, corresponding to test acc:                         0.8518518805503845 / 0.8564814925193787
after epoch: 16,now: 2024-07-23 13:34:12.319632,epoch time: 0:02:10.843041,used: 0:36:10.938567,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_12_58_01_seed_2_22795134
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.98453945, 'precision': 0.98460317, 'recall': 0.9845077, 'specificity': 0.9845077, 'f1': 0.9845374, 'auroc': 0.9992529, 'binary_precision': 0.98056996, 'binary_recall': 0.98889613, 'binary_specificity': 0.9801193, 'binary_f1_score': 0.98471546}
confusion matrix:
      0     1
0  1479    30
1    17  1514
---- Validation: 
scalar performance:
{'acc': 0.7198748, 'precision': 0.7473969, 'recall': 0.7152184, 'specificity': 0.7152184, 'f1': 0.70891345, 'auroc': 0.79501367, 'binary_precision': 0.8235294, 'binary_recall': 0.5401929, 'binary_specificity': 0.8902439, 'binary_f1_score': 0.6524272}
confusion matrix:
     0    1
0  584   72
1  286  336
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6898148, 'precision': 0.6958772, 'recall': 0.6898148, 'specificity': 0.6898148, 'f1': 0.68739605, 'auroc': 0.73051697, 'binary_precision': 0.6614173, 'binary_recall': 0.7777778, 'binary_specificity': 0.6018519, 'binary_f1_score': 0.7148936}
confusion matrix:
     0    1
0  130   86
1   48  168
early stop counter: 15
val acc:0.7198747992515564, best validation acc: 0.82863849401474, corresponding to test acc:                         0.8518518805503845 / 0.8564814925193787
after epoch: 17,now: 2024-07-23 13:36:25.173634,epoch time: 0:02:12.854002,used: 0:38:23.792569,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_12_58_01_seed_2_22795134
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.98914474, 'precision': 0.9891853, 'recall': 0.98919857, 'specificity': 0.98919857, 'f1': 0.98914474, 'auroc': 0.9991373, 'binary_precision': 0.99602914, 'binary_recall': 0.982376, 'binary_specificity': 0.9960212, 'binary_f1_score': 0.9891554}
confusion matrix:
      0     1
0  1502     6
1    27  1505
---- Validation: 
scalar performance:
{'acc': 0.7097027, 'precision': 0.7933395, 'recall': 0.70243514, 'specificity': 0.70243514, 'f1': 0.6826715, 'auroc': 0.88198966, 'binary_precision': 0.9434629, 'binary_recall': 0.42926046, 'binary_specificity': 0.9756098, 'binary_f1_score': 0.5900553}
confusion matrix:
     0    1
0  640   16
1  355  267
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5949074, 'precision': 0.7542636, 'recall': 0.5949074, 'specificity': 0.5949074, 'f1': 0.5196432, 'auroc': 0.8055556, 'binary_precision': 0.95555556, 'binary_recall': 0.19907407, 'binary_specificity': 0.9907407, 'binary_f1_score': 0.32950193}
confusion matrix:
     0   1
0  214   2
1  173  43
early stop counter: 16
val acc:0.7097026705741882, best validation acc: 0.82863849401474, corresponding to test acc:                         0.8518518805503845 / 0.8564814925193787
after epoch: 18,now: 2024-07-23 13:38:40.276612,epoch time: 0:02:15.102978,used: 0:40:38.895547,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_12_58_01_seed_2_22795134
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.99276316, 'precision': 0.9927777, 'recall': 0.9927504, 'specificity': 0.9927504, 'f1': 0.9927624, 'auroc': 0.99972856, 'binary_precision': 0.99154747, 'binary_recall': 0.994133, 'binary_specificity': 0.9913679, 'binary_f1_score': 0.99283856}
confusion matrix:
      0     1
0  1493    13
1     9  1525
---- Validation: 
scalar performance:
{'acc': 0.74804384, 'precision': 0.8107233, 'recall': 0.7419492, 'specificity': 0.7419492, 'f1': 0.73141444, 'auroc': 0.90704405, 'binary_precision': 0.943787, 'binary_recall': 0.5128617, 'binary_specificity': 0.9710366, 'binary_f1_score': 0.6645833}
confusion matrix:
     0    1
0  637   19
1  303  319
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7615741, 'precision': 0.83855796, 'recall': 0.76157403, 'specificity': 0.76157403, 'f1': 0.74720335, 'auroc': 0.9005058, 'binary_precision': 1.0, 'binary_recall': 0.5231481, 'binary_specificity': 1.0, 'binary_f1_score': 0.6869301}
confusion matrix:
     0    1
0  216    0
1  103  113
early stop counter: 17
val acc:0.7480438351631165, best validation acc: 0.82863849401474, corresponding to test acc:                         0.8518518805503845 / 0.8564814925193787
after epoch: 19,now: 2024-07-23 13:40:56.622915,epoch time: 0:02:16.346303,used: 0:42:55.241850,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_12_58_01_seed_2_22795134
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9907895, 'precision': 0.99079853, 'recall': 0.9908223, 'specificity': 0.9908223, 'f1': 0.99078935, 'auroc': 0.99949574, 'binary_precision': 0.99538565, 'binary_recall': 0.9862835, 'binary_specificity': 0.99536115, 'binary_f1_score': 0.9908136}
confusion matrix:
      0     1
0  1502     7
1    21  1510
---- Validation: 
scalar performance:
{'acc': 0.6197183, 'precision': 0.7505143, 'recall': 0.6098247, 'specificity': 0.6098247, 'f1': 0.5522798, 'auroc': 0.8407778, 'binary_precision': 0.925, 'binary_recall': 0.23794213, 'binary_specificity': 0.98170733, 'binary_f1_score': 0.3785166}
confusion matrix:
     0    1
0  644   12
1  474  148
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5277778, 'precision': 0.7571429, 'recall': 0.5277778, 'specificity': 0.5277778, 'f1': 0.39225423, 'auroc': 0.8312757, 'binary_precision': 1.0, 'binary_recall': 0.055555556, 'binary_specificity': 1.0, 'binary_f1_score': 0.10526316}
confusion matrix:
     0   1
0  216   0
1  204  12
early stop counter: 18
val acc:0.6197183132171631, best validation acc: 0.82863849401474, corresponding to test acc:                         0.8518518805503845 / 0.8564814925193787
after epoch: 20,now: 2024-07-23 13:43:14.285639,epoch time: 0:02:17.662724,used: 0:45:12.904574,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_12_58_01_seed_2_22795134
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9914474, 'precision': 0.99150884, 'recall': 0.99153095, 'specificity': 0.99153095, 'f1': 0.9914473, 'auroc': 0.9996598, 'binary_precision': 1.0, 'binary_recall': 0.9830619, 'binary_specificity': 1.0, 'binary_f1_score': 0.9914586}
confusion matrix:
      0     1
0  1505     0
1    26  1509
---- Validation: 
scalar performance:
{'acc': 0.6549296, 'precision': 0.7729064, 'recall': 0.6459567, 'specificity': 0.6459567, 'f1': 0.6053443, 'auroc': 0.853389, 'binary_precision': 0.9458128, 'binary_recall': 0.30868167, 'binary_specificity': 0.9832317, 'binary_f1_score': 0.46545458}
confusion matrix:
     0    1
0  645   11
1  430  192
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5347222, 'precision': 0.7296244, 'recall': 0.5347222, 'specificity': 0.5347222, 'f1': 0.40939853, 'auroc': 0.83013976, 'binary_precision': 0.9411765, 'binary_recall': 0.074074075, 'binary_specificity': 0.9953704, 'binary_f1_score': 0.13733906}
confusion matrix:
     0   1
0  215   1
1  200  16
early stop counter: 19
val acc:0.6549295783042908, best validation acc: 0.82863849401474, corresponding to test acc:                         0.8518518805503845 / 0.8564814925193787
after epoch: 21,now: 2024-07-23 13:45:24.452341,epoch time: 0:02:10.166702,used: 0:47:23.071276,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_12_58_01_seed_2_22795134
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9914474, 'precision': 0.99154145, 'recall': 0.99140525, 'specificity': 0.99140525, 'f1': 0.9914459, 'auroc': 0.9997368, 'binary_precision': 0.9864341, 'binary_recall': 0.9967363, 'binary_specificity': 0.98607427, 'binary_f1_score': 0.99155843}
confusion matrix:
      0     1
0  1487    21
1     5  1527
---- Validation: 
scalar performance:
{'acc': 0.8372457, 'precision': 0.85050523, 'recall': 0.8346306, 'specificity': 0.8346306, 'f1': 0.83484757, 'auroc': 0.8977016, 'binary_precision': 0.9123506, 'binary_recall': 0.7363344, 'binary_specificity': 0.93292683, 'binary_f1_score': 0.81494665}
confusion matrix:
     0    1
0  612   44
1  164  458
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8333333, 'precision': 0.84916925, 'recall': 0.8333334, 'specificity': 0.8333334, 'f1': 0.831422, 'auroc': 0.9003987, 'binary_precision': 0.9235294, 'binary_recall': 0.7268519, 'binary_specificity': 0.9398148, 'binary_f1_score': 0.8134715}
confusion matrix:
     0    1
0  203   13
1   59  157
better model found
persisted
after epoch: 22,now: 2024-07-23 13:47:35.711474,epoch time: 0:02:11.259133,used: 0:49:34.330409,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_12_58_01_seed_2_22795134
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.99210525, 'precision': 0.9921044, 'recall': 0.9921044, 'specificity': 0.9921044, 'f1': 0.9921044, 'auroc': 0.9996026, 'binary_precision': 0.9921875, 'binary_recall': 0.9921875, 'binary_specificity': 0.99202126, 'binary_f1_score': 0.9921875}
confusion matrix:
      0     1
0  1492    12
1    12  1524
---- Validation: 
scalar performance:
{'acc': 0.8270736, 'precision': 0.8409548, 'recall': 0.82434714, 'specificity': 0.82434714, 'f1': 0.82435477, 'auroc': 0.8986207, 'binary_precision': 0.9034205, 'binary_recall': 0.72186494, 'binary_specificity': 0.9268293, 'binary_f1_score': 0.8025023}
confusion matrix:
     0    1
0  608   48
1  173  449
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8101852, 'precision': 0.81474555, 'recall': 0.8101852, 'specificity': 0.8101852, 'f1': 0.8094951, 'auroc': 0.8685485, 'binary_precision': 0.85263157, 'binary_recall': 0.75, 'binary_specificity': 0.8703704, 'binary_f1_score': 0.79802954}
confusion matrix:
     0    1
0  188   28
1   54  162
early stop counter: 1
val acc:0.8270735740661621, best validation acc: 0.8372457027435303, corresponding to test acc:                         0.8333333134651184 / 0.8564814925193787
after epoch: 23,now: 2024-07-23 13:49:52.578097,epoch time: 0:02:16.866623,used: 0:51:51.197032,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_12_58_01_seed_2_22795134
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9917763, 'precision': 0.99184966, 'recall': 0.99173623, 'specificity': 0.99173623, 'f1': 0.9917748, 'auroc': 0.9998498, 'binary_precision': 0.98771816, 'binary_recall': 0.9960887, 'binary_specificity': 0.9873838, 'binary_f1_score': 0.9918858}
confusion matrix:
      0     1
0  1487    19
1     6  1528
---- Validation: 
scalar performance:
{'acc': 0.7339593, 'precision': 0.8090309, 'recall': 0.72727144, 'specificity': 0.72727144, 'f1': 0.71291673, 'auroc': 0.8898389, 'binary_precision': 0.9548387, 'binary_recall': 0.47588426, 'binary_specificity': 0.97865856, 'binary_f1_score': 0.6351931}
confusion matrix:
     0    1
0  642   14
1  326  296
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6597222, 'precision': 0.7572583, 'recall': 0.6597222, 'specificity': 0.6597222, 'f1': 0.6240921, 'auroc': 0.86700535, 'binary_precision': 0.91566265, 'binary_recall': 0.35185185, 'binary_specificity': 0.9675926, 'binary_f1_score': 0.5083612}
confusion matrix:
     0   1
0  209   7
1  140  76
early stop counter: 2
val acc:0.7339593172073364, best validation acc: 0.8372457027435303, corresponding to test acc:                         0.8333333134651184 / 0.8564814925193787
after epoch: 24,now: 2024-07-23 13:52:04.292397,epoch time: 0:02:11.714300,used: 0:54:02.911332,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_12_58_01_seed_2_22795134
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.9904605, 'precision': 0.9905416, 'recall': 0.9905358, 'specificity': 0.9905358, 'f1': 0.9904605, 'auroc': 0.99983466, 'binary_precision': 0.999336, 'binary_recall': 0.98173517, 'binary_specificity': 0.9993364, 'binary_f1_score': 0.99045736}
confusion matrix:
      0     1
0  1506     1
1    28  1505
---- Validation: 
scalar performance:
{'acc': 0.6181534, 'precision': 0.77619255, 'recall': 0.607842, 'specificity': 0.607842, 'f1': 0.5437811, 'auroc': 0.9185168, 'binary_precision': 0.9785714, 'binary_recall': 0.22025724, 'binary_specificity': 0.99542683, 'binary_f1_score': 0.35958004}
confusion matrix:
     0    1
0  653    3
1  485  137
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5069444, 'precision': 0.75174826, 'recall': 0.5069444, 'specificity': 0.5069444, 'f1': 0.34858236, 'auroc': 0.8725138, 'binary_precision': 1.0, 'binary_recall': 0.013888889, 'binary_specificity': 1.0, 'binary_f1_score': 0.027397262}
confusion matrix:
     0  1
0  216  0
1  213  3
early stop counter: 3
val acc:0.6181533932685852, best validation acc: 0.8372457027435303, corresponding to test acc:                         0.8333333134651184 / 0.8564814925193787
after epoch: 25,now: 2024-07-23 13:54:18.720713,epoch time: 0:02:14.428316,used: 0:56:17.339648,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_12_58_01_seed_2_22795134
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.98651314, 'precision': 0.98673284, 'recall': 0.9865848, 'specificity': 0.9865848, 'f1': 0.98651266, 'auroc': 0.9990231, 'binary_precision': 0.9986595, 'binary_recall': 0.97449315, 'binary_specificity': 0.99867636, 'binary_f1_score': 0.9864284}
confusion matrix:
      0     1
0  1509     2
1    39  1490
---- Validation: 
scalar performance:
{'acc': 0.58059466, 'precision': 0.76414144, 'recall': 0.5692152, 'specificity': 0.5692152, 'f1': 0.4782593, 'auroc': 0.8064404, 'binary_precision': 0.9777778, 'binary_recall': 0.1414791, 'binary_specificity': 0.9969512, 'binary_f1_score': 0.24719103}
confusion matrix:
     0   1
0  654   2
1  534  88
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5023148, 'precision': 0.7505801, 'recall': 0.5023148, 'specificity': 0.5023148, 'f1': 0.3384568, 'auroc': 0.6995456, 'binary_precision': 1.0, 'binary_recall': 0.0046296297, 'binary_specificity': 1.0, 'binary_f1_score': 0.00921659}
confusion matrix:
     0  1
0  216  0
1  215  1
early stop counter: 4
val acc:0.5805946588516235, best validation acc: 0.8372457027435303, corresponding to test acc:                         0.8333333134651184 / 0.8564814925193787
after epoch: 26,now: 2024-07-23 13:56:26.526242,epoch time: 0:02:07.805529,used: 0:58:25.145177,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_12_58_01_seed_2_22795134
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.9917763, 'precision': 0.9917744, 'recall': 0.9917954, 'specificity': 0.9917954, 'f1': 0.99177617, 'auroc': 0.99960005, 'binary_precision': 0.9947403, 'binary_recall': 0.98888886, 'binary_specificity': 0.994702, 'binary_f1_score': 0.9918059}
confusion matrix:
      0     1
0  1502     8
1    17  1513
---- Validation: 
scalar performance:
{'acc': 0.7942097, 'precision': 0.8143966, 'recall': 0.7907517, 'specificity': 0.7907517, 'f1': 0.7894069, 'auroc': 0.8858154, 'binary_precision': 0.887689, 'binary_recall': 0.6607717, 'binary_specificity': 0.9207317, 'binary_f1_score': 0.7576037}
confusion matrix:
     0    1
0  604   52
1  211  411
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.724537, 'precision': 0.74844074, 'recall': 0.724537, 'specificity': 0.724537, 'f1': 0.71774775, 'auroc': 0.8277606, 'binary_precision': 0.82550335, 'binary_recall': 0.5694444, 'binary_specificity': 0.8796296, 'binary_f1_score': 0.67397255}
confusion matrix:
     0    1
0  190   26
1   93  123
early stop counter: 5
val acc:0.7942097187042236, best validation acc: 0.8372457027435303, corresponding to test acc:                         0.8333333134651184 / 0.8564814925193787
after epoch: 27,now: 2024-07-23 13:58:35.248831,epoch time: 0:02:08.722589,used: 1:00:33.867766,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_12_58_01_seed_2_22795134
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.9894737, 'precision': 0.9896306, 'recall': 0.9895356, 'specificity': 0.9895356, 'f1': 0.98947346, 'auroc': 0.9997927, 'binary_precision': 1.0, 'binary_recall': 0.97907126, 'binary_specificity': 1.0, 'binary_f1_score': 0.98942494}
confusion matrix:
      0     1
0  1511     0
1    32  1497
---- Validation: 
scalar performance:
{'acc': 0.5688576, 'precision': 0.7584871, 'recall': 0.5571573, 'specificity': 0.5571573, 'f1': 0.45653662, 'auroc': 0.90048695, 'binary_precision': 0.97333336, 'binary_recall': 0.11736334, 'binary_specificity': 0.9969512, 'binary_f1_score': 0.20946915}
confusion matrix:
     0   1
0  654   2
1  549  73
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5439815, 'precision': 0.70167077, 'recall': 0.5439815, 'specificity': 0.5439815, 'f1': 0.4331804, 'auroc': 0.790102, 'binary_precision': 0.88, 'binary_recall': 0.10185185, 'binary_specificity': 0.9861111, 'binary_f1_score': 0.18257262}
confusion matrix:
     0   1
0  213   3
1  194  22
early stop counter: 6
val acc:0.5688576102256775, best validation acc: 0.8372457027435303, corresponding to test acc:                         0.8333333134651184 / 0.8564814925193787
after epoch: 28,now: 2024-07-23 14:00:45.823702,epoch time: 0:02:10.574871,used: 1:02:44.442637,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_12_58_01_seed_2_22795134
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.99111843, 'precision': 0.991288, 'recall': 0.9910581, 'specificity': 0.9910581, 'f1': 0.9911163, 'auroc': 0.99978745, 'binary_precision': 0.98392284, 'binary_recall': 0.99869454, 'binary_specificity': 0.98342174, 'binary_f1_score': 0.9912537}
confusion matrix:
      0     1
0  1483    25
1     2  1530
---- Validation: 
scalar performance:
{'acc': 0.80829424, 'precision': 0.8195573, 'recall': 0.8057211, 'specificity': 0.8057211, 'f1': 0.80558, 'auroc': 0.87405455, 'binary_precision': 0.87326735, 'binary_recall': 0.7090032, 'binary_specificity': 0.902439, 'binary_f1_score': 0.7826086}
confusion matrix:
     0    1
0  592   64
1  181  441
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7916667, 'precision': 0.7928971, 'recall': 0.7916667, 'specificity': 0.7916667, 'f1': 0.7914476, 'auroc': 0.86601937, 'binary_precision': 0.8118812, 'binary_recall': 0.7592593, 'binary_specificity': 0.8240741, 'binary_f1_score': 0.78468895}
confusion matrix:
     0    1
0  178   38
1   52  164
early stop counter: 7
val acc:0.8082942366600037, best validation acc: 0.8372457027435303, corresponding to test acc:                         0.8333333134651184 / 0.8564814925193787
after epoch: 29,now: 2024-07-23 14:02:58.179479,epoch time: 0:02:12.355777,used: 1:04:56.798414,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_12_58_01_seed_2_22795134
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.9930921, 'precision': 0.99309456, 'recall': 0.99308884, 'specificity': 0.99308884, 'f1': 0.9930916, 'auroc': 0.9996598, 'binary_precision': 0.9928292, 'binary_recall': 0.99347687, 'binary_specificity': 0.99270076, 'binary_f1_score': 0.9931529}
confusion matrix:
      0     1
0  1496    11
1    10  1523
---- Validation: 
scalar performance:
{'acc': 0.8403756, 'precision': 0.846337, 'recall': 0.838596, 'specificity': 0.838596, 'f1': 0.83909523, 'auroc': 0.9001279, 'binary_precision': 0.88560885, 'binary_recall': 0.7717042, 'binary_specificity': 0.9054878, 'binary_f1_score': 0.8247422}
confusion matrix:
     0    1
0  594   62
1  142  480
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7638889, 'precision': 0.7698107, 'recall': 0.7638889, 'specificity': 0.7638889, 'f1': 0.76258624, 'auroc': 0.8396348, 'binary_precision': 0.8097826, 'binary_recall': 0.6898148, 'binary_specificity': 0.837963, 'binary_f1_score': 0.745}
confusion matrix:
     0    1
0  181   35
1   67  149
better model found
persisted
after epoch: 30,now: 2024-07-23 14:05:03.330074,epoch time: 0:02:05.150595,used: 1:07:01.949009,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_12_58_01_seed_2_22795134
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 1:07:01.949009 at 2024-07-23 14:05:03.330074
persisted model performance metric: 

scalar performance:
{'acc': 0.7638889, 'precision': 0.7698107, 'recall': 0.7638889, 'specificity': 0.7638889, 'f1': 0.76258624, 'auroc': 0.8396348, 'binary_precision': 0.8097826, 'binary_recall': 0.6898148, 'binary_specificity': 0.837963, 'binary_f1_score': 0.745}
confusion matrix:
     0    1
0  181   35
1   67  149
oracle model performance metric: 

scalar performance:
{'acc': 0.8564815, 'precision': 0.8579854, 'recall': 0.8564815, 'specificity': 0.8564815, 'f1': 0.85633063, 'auroc': 0.92787635, 'binary_precision': 0.8811881, 'binary_recall': 0.8240741, 'binary_specificity': 0.8888889, 'binary_f1_score': 0.8516746}
confusion matrix:
     0    1
0  192   24
1   38  178
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_dial_lr1e5_bs32__45_nofreeze_2024-07-23_10-43-50/rule_results/4.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_dial_lr1e5_bs32__45_nofreeze_2024-07-23_10-43-50/confusion_matrix/4.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 451685 KiB |  26075 MiB | 215764 GiB | 215763 GiB |
|       from large pool | 411132 KiB |  26030 MiB | 214418 GiB | 214417 GiB |
|       from small pool |  40553 KiB |     60 MiB |   1346 GiB |   1346 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 451685 KiB |  26075 MiB | 215764 GiB | 215763 GiB |
|       from large pool | 411132 KiB |  26030 MiB | 214418 GiB | 214417 GiB |
|       from small pool |  40553 KiB |     60 MiB |   1346 GiB |   1346 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 447481 KiB |  26071 MiB | 215724 GiB | 215723 GiB |
|       from large pool | 407075 KiB |  26026 MiB | 214380 GiB | 214380 GiB |
|       from small pool |  40406 KiB |     60 MiB |   1343 GiB |   1343 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  27778 MiB |  27778 MiB |  80918 MiB |  53140 MiB |
|       from large pool |  27710 MiB |  27710 MiB |  80820 MiB |  53110 MiB |
|       from small pool |     68 MiB |     72 MiB |     98 MiB |     30 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 775066 KiB |   1679 MiB |  97328 GiB |  97328 GiB |
|       from large pool | 758276 KiB |   1676 MiB |  95972 GiB |  95972 GiB |
|       from small pool |  16790 KiB |     34 MiB |   1355 GiB |   1355 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    1220    |    2570    |   19511 K  |   19510 K  |
|       from large pool |     187    |    1413    |    9878 K  |    9878 K  |
|       from small pool |    1033    |    1335    |    9632 K  |    9631 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    1220    |    2570    |   19511 K  |   19510 K  |
|       from large pool |     187    |    1413    |    9878 K  |    9878 K  |
|       from small pool |    1033    |    1335    |    9632 K  |    9631 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     837    |     837    |    2371    |    1534    |
|       from large pool |     803    |     803    |    2322    |    1519    |
|       from small pool |      34    |      36    |      49    |      15    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     111    |     855    |   14246 K  |   14246 K  |
|       from large pool |      47    |     805    |    8785 K  |    8785 K  |
|       from small pool |      64    |     148    |    5460 K  |    5460 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  26075 MiB | 215764 GiB | 215764 GiB |
|       from large pool |  16640 KiB |  26030 MiB | 214418 GiB | 214418 GiB |
|       from small pool |      0 KiB |     60 MiB |   1346 GiB |   1346 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  26075 MiB | 215764 GiB | 215764 GiB |
|       from large pool |  16640 KiB |  26030 MiB | 214418 GiB | 214418 GiB |
|       from small pool |      0 KiB |     60 MiB |   1346 GiB |   1346 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  26071 MiB | 215724 GiB | 215724 GiB |
|       from large pool |  16640 KiB |  26026 MiB | 214380 GiB | 214380 GiB |
|       from small pool |      0 KiB |     60 MiB |   1343 GiB |   1343 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1198 MiB |  27778 MiB |  80918 MiB |  79720 MiB |
|       from large pool |   1142 MiB |  27710 MiB |  80820 MiB |  79678 MiB |
|       from small pool |     56 MiB |     72 MiB |     98 MiB |     42 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |   3840 KiB |   1679 MiB |  97329 GiB |  97329 GiB |
|       from large pool |   3840 KiB |   1676 MiB |  95973 GiB |  95973 GiB |
|       from small pool |      0 KiB |     34 MiB |   1355 GiB |   1355 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    2570    |   19511 K  |   19511 K  |
|       from large pool |       2    |    1413    |    9878 K  |    9878 K  |
|       from small pool |       0    |    1335    |    9632 K  |    9632 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    2570    |   19511 K  |   19511 K  |
|       from large pool |       2    |    1413    |    9878 K  |    9878 K  |
|       from small pool |       0    |    1335    |    9632 K  |    9632 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      71    |     837    |    2371    |    2300    |
|       from large pool |      43    |     803    |    2322    |    2279    |
|       from small pool |      28    |      36    |      49    |      21    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       1    |     855    |   14246 K  |   14246 K  |
|       from large pool |       1    |     805    |    8785 K  |    8785 K  |
|       from small pool |       0    |     148    |    5460 K  |    5460 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Tue Jul 23 14:06:28 2024]
Finished job 0.
1 of 1 steps (100%) done
