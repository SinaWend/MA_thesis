Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Tue Jul 23 10:50:52 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_dial_lr1e5_bs32__45_nofreeze_2024-07-23_10-43-50/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_dial_lr1e5_bs32__45_nofreeze_2024-07-23_10-43-50/rule_results/5.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=5
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/swiglu_ffn.py:51: UserWarning: xFormers is not available (SwiGLU)
  warnings.warn("xFormers is not available (SwiGLU)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/attention.py:33: UserWarning: xFormers is not available (Attention)
  warnings.warn("xFormers is not available (Attention)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/block.py:40: UserWarning: xFormers is not available (Block)
  warnings.warn("xFormers is not available (Block)")
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'888c1ef2'
model name: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_10_54_22_seed_0_22795139

 Experiment start at: 2024-07-23 10:54:22.660081
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
before training, model accuracy: 0.569767415523529
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.93098956, 'precision': 0.93098485, 'recall': 0.9310814, 'specificity': 0.9310814, 'f1': 0.9309854, 'auroc': 0.97859645, 'binary_precision': 0.9381913, 'binary_recall': 0.9249519, 'binary_specificity': 0.93721086, 'binary_f1_score': 0.9315246}
confusion matrix:
      0     1
0  1418    95
1   117  1442
---- Validation: 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
scalar performance:
{'acc': 0.8152174, 'precision': 0.81813455, 'recall': 0.8158758, 'specificity': 0.8158758, 'f1': 0.8149814, 'auroc': 0.9041637, 'binary_precision': 0.7839771, 'binary_recall': 0.8629921, 'binary_specificity': 0.76875955, 'binary_f1_score': 0.82158923}
confusion matrix:
     0    1
0  502  151
1   87  548
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.80697674, 'precision': 0.81118417, 'recall': 0.8069768, 'specificity': 0.8069768, 'f1': 0.8063221, 'auroc': 0.907431, 'binary_precision': 0.775, 'binary_recall': 0.8651163, 'binary_specificity': 0.74883723, 'binary_f1_score': 0.8175824}
confusion matrix:
     0    1
0  161   54
1   29  186
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-23 10:57:16.272087,epoch time: 0:02:53.612006,used: 0:02:53.612006,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_10_54_22_seed_0_22795139
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9498698, 'precision': 0.95141554, 'recall': 0.9503056, 'specificity': 0.9503056, 'f1': 0.94985193, 'auroc': 0.990913, 'binary_precision': 0.9814688, 'binary_recall': 0.9184329, 'binary_specificity': 0.9821782, 'binary_f1_score': 0.9489051}
confusion matrix:
      0     1
0  1488    27
1   127  1430
---- Validation: 
scalar performance:
{'acc': 0.82763976, 'precision': 0.8276837, 'recall': 0.8275193, 'specificity': 0.8275193, 'f1': 0.8275695, 'auroc': 0.89326787, 'binary_precision': 0.8293461, 'binary_recall': 0.81889766, 'binary_specificity': 0.8361409, 'binary_f1_score': 0.8240888}
confusion matrix:
     0    1
0  546  107
1  115  520
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.82093024, 'precision': 0.82110393, 'recall': 0.82093024, 'specificity': 0.82093024, 'f1': 0.82090604, 'auroc': 0.9109573, 'binary_precision': 0.81363636, 'binary_recall': 0.83255816, 'binary_specificity': 0.80930233, 'binary_f1_score': 0.8229885}
confusion matrix:
     0    1
0  174   41
1   36  179
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-07-23 10:58:50.325412,epoch time: 0:01:34.053325,used: 0:04:27.665331,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_10_54_22_seed_0_22795139
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.95963544, 'precision': 0.9615233, 'recall': 0.9600864, 'specificity': 0.9600864, 'f1': 0.95961565, 'auroc': 0.9956628, 'binary_precision': 0.9944751, 'binary_recall': 0.92544985, 'binary_specificity': 0.99472296, 'binary_f1_score': 0.9587217}
confusion matrix:
      0     1
0  1508     8
1   116  1440
---- Validation: 
scalar performance:
{'acc': 0.7756211, 'precision': 0.77737784, 'recall': 0.7750238, 'specificity': 0.7750238, 'f1': 0.77497536, 'auroc': 0.866665, 'binary_precision': 0.7962329, 'binary_recall': 0.7322835, 'binary_specificity': 0.81776416, 'binary_f1_score': 0.7629205}
confusion matrix:
     0    1
0  534  119
1  170  465
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.82790697, 'precision': 0.82836163, 'recall': 0.82790697, 'specificity': 0.82790697, 'f1': 0.82784736, 'auroc': 0.90290964, 'binary_precision': 0.8161435, 'binary_recall': 0.8465116, 'binary_specificity': 0.80930233, 'binary_f1_score': 0.8310502}
confusion matrix:
     0    1
0  174   41
1   33  182
new oracle model saved
early stop counter: 1
val acc:0.7756211161613464, best validation acc: 0.8276397585868835, corresponding to test acc:                         0.8209302425384521 / 0.8279069662094116
after epoch: 3,now: 2024-07-23 11:00:08.761829,epoch time: 0:01:18.436417,used: 0:05:46.101748,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_10_54_22_seed_0_22795139
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.97591144, 'precision': 0.97613955, 'recall': 0.97612107, 'specificity': 0.97612107, 'f1': 0.97591144, 'auroc': 0.997224, 'binary_precision': 0.9907407, 'binary_recall': 0.9614891, 'binary_specificity': 0.990753, 'binary_f1_score': 0.97589576}
confusion matrix:
      0     1
0  1500    14
1    60  1498
---- Validation: 
scalar performance:
{'acc': 0.8082298, 'precision': 0.82025206, 'recall': 0.8068575, 'specificity': 0.8068575, 'f1': 0.8059038, 'auroc': 0.89288926, 'binary_precision': 0.87890625, 'binary_recall': 0.70866144, 'binary_specificity': 0.9050536, 'binary_f1_score': 0.78465563}
confusion matrix:
     0    1
0  591   62
1  185  450
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.82325584, 'precision': 0.82553756, 'recall': 0.82325584, 'specificity': 0.82325584, 'f1': 0.8229456, 'auroc': 0.9034289, 'binary_precision': 0.8527919, 'binary_recall': 0.7813954, 'binary_specificity': 0.8651163, 'binary_f1_score': 0.81553406}
confusion matrix:
     0    1
0  186   29
1   47  168
early stop counter: 2
val acc:0.8082298040390015, best validation acc: 0.8276397585868835, corresponding to test acc:                         0.8209302425384521 / 0.8279069662094116
after epoch: 4,now: 2024-07-23 11:01:27.435655,epoch time: 0:01:18.673826,used: 0:07:04.775574,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_10_54_22_seed_0_22795139
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9671224, 'precision': 0.9682201, 'recall': 0.9674946, 'specificity': 0.9674946, 'f1': 0.9671159, 'auroc': 0.99653566, 'binary_precision': 0.9945652, 'binary_recall': 0.94026977, 'binary_specificity': 0.99471945, 'binary_f1_score': 0.9666557}
confusion matrix:
      0     1
0  1507     8
1    93  1464
---- Validation: 
scalar performance:
{'acc': 0.6746894, 'precision': 0.7301206, 'recall': 0.6711857, 'specificity': 0.6711857, 'f1': 0.651086, 'auroc': 0.82348216, 'binary_precision': 0.8396226, 'binary_recall': 0.42047244, 'binary_specificity': 0.9218989, 'binary_f1_score': 0.56033576}
confusion matrix:
     0    1
0  602   51
1  368  267
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.81627905, 'precision': 0.81932557, 'recall': 0.81627905, 'specificity': 0.81627905, 'f1': 0.8158398, 'auroc': 0.89404, 'binary_precision': 0.8505155, 'binary_recall': 0.76744187, 'binary_specificity': 0.8651163, 'binary_f1_score': 0.80684596}
confusion matrix:
     0    1
0  186   29
1   50  165
early stop counter: 3
val acc:0.6746894121170044, best validation acc: 0.8276397585868835, corresponding to test acc:                         0.8209302425384521 / 0.8279069662094116
after epoch: 5,now: 2024-07-23 11:02:43.401055,epoch time: 0:01:15.965400,used: 0:08:20.740974,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_10_54_22_seed_0_22795139
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9749349, 'precision': 0.97528785, 'recall': 0.9747759, 'specificity': 0.9747759, 'f1': 0.9749192, 'auroc': 0.99779165, 'binary_precision': 0.96543056, 'binary_recall': 0.98587936, 'binary_specificity': 0.9636724, 'binary_f1_score': 0.97554785}
confusion matrix:
      0     1
0  1459    55
1    22  1536
---- Validation: 
scalar performance:
{'acc': 0.863354, 'precision': 0.8639689, 'recall': 0.86365294, 'specificity': 0.86365294, 'f1': 0.86334217, 'auroc': 0.92679214, 'binary_precision': 0.8451128, 'binary_recall': 0.8850394, 'binary_specificity': 0.84226644, 'binary_f1_score': 0.86461544}
confusion matrix:
     0    1
0  550  103
1   73  562
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.83023256, 'precision': 0.8392222, 'recall': 0.83023256, 'specificity': 0.83023256, 'f1': 0.8291003, 'auroc': 0.9207139, 'binary_precision': 0.784, 'binary_recall': 0.9116279, 'binary_specificity': 0.74883723, 'binary_f1_score': 0.8430107}
confusion matrix:
     0    1
0  161   54
1   19  196
new oracle model saved
better model found
persisted
after epoch: 6,now: 2024-07-23 11:03:58.427029,epoch time: 0:01:15.025974,used: 0:09:35.766948,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_10_54_22_seed_0_22795139
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9817708, 'precision': 0.98190475, 'recall': 0.9816915, 'specificity': 0.9816915, 'f1': 0.9817643, 'auroc': 0.99863493, 'binary_precision': 0.976493, 'binary_recall': 0.9877892, 'binary_specificity': 0.9755937, 'binary_f1_score': 0.9821086}
confusion matrix:
      0     1
0  1479    37
1    19  1537
---- Validation: 
scalar performance:
{'acc': 0.7950311, 'precision': 0.80282295, 'recall': 0.79388404, 'specificity': 0.79388404, 'f1': 0.79323626, 'auroc': 0.8859751, 'binary_precision': 0.84803003, 'binary_recall': 0.711811, 'binary_specificity': 0.87595713, 'binary_f1_score': 0.7739726}
confusion matrix:
     0    1
0  572   81
1  183  452
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.81860465, 'precision': 0.8208536, 'recall': 0.81860465, 'specificity': 0.81860465, 'f1': 0.81828624, 'auroc': 0.902239, 'binary_precision': 0.84771574, 'binary_recall': 0.7767442, 'binary_specificity': 0.8604651, 'binary_f1_score': 0.8106796}
confusion matrix:
     0    1
0  185   30
1   48  167
early stop counter: 1
val acc:0.7950310707092285, best validation acc: 0.8633540272712708, corresponding to test acc:                         0.830232560634613 / 0.830232560634613
after epoch: 7,now: 2024-07-23 11:05:13.190846,epoch time: 0:01:14.763817,used: 0:10:50.530765,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_10_54_22_seed_0_22795139
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9641927, 'precision': 0.966117, 'recall': 0.9638051, 'specificity': 0.9638051, 'f1': 0.9641285, 'auroc': 0.99819577, 'binary_precision': 0.93924665, 'binary_recall': 0.99357325, 'binary_specificity': 0.9340369, 'binary_f1_score': 0.9656465}
confusion matrix:
      0     1
0  1416   100
1    10  1546
---- Validation: 
scalar performance:
{'acc': 0.7958075, 'precision': 0.8205384, 'recall': 0.7977319, 'specificity': 0.7977319, 'f1': 0.792484, 'auroc': 0.9156793, 'binary_precision': 0.72794116, 'binary_recall': 0.9354331, 'binary_specificity': 0.6600306, 'binary_f1_score': 0.81874573}
confusion matrix:
     0    1
0  431  222
1   41  594
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7860465, 'precision': 0.8119912, 'recall': 0.7860465, 'specificity': 0.7860465, 'f1': 0.7815041, 'auroc': 0.9137696, 'binary_precision': 0.72202164, 'binary_recall': 0.9302326, 'binary_specificity': 0.6418605, 'binary_f1_score': 0.8130082}
confusion matrix:
     0    1
0  138   77
1   15  200
early stop counter: 2
val acc:0.7958074808120728, best validation acc: 0.8633540272712708, corresponding to test acc:                         0.830232560634613 / 0.830232560634613
after epoch: 8,now: 2024-07-23 11:06:28.429466,epoch time: 0:01:15.238620,used: 0:12:05.769385,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_10_54_22_seed_0_22795139
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.98860675, 'precision': 0.9886112, 'recall': 0.98869383, 'specificity': 0.98869383, 'f1': 0.98860633, 'auroc': 0.9986663, 'binary_precision': 0.99543977, 'binary_recall': 0.9820051, 'binary_specificity': 0.9953826, 'binary_f1_score': 0.98867685}
confusion matrix:
      0     1
0  1509     7
1    28  1528
---- Validation: 
scalar performance:
{'acc': 0.7414596, 'precision': 0.77128875, 'recall': 0.7390976, 'specificity': 0.7390976, 'f1': 0.7328671, 'auroc': 0.86263525, 'binary_precision': 0.8578199, 'binary_recall': 0.57007873, 'binary_specificity': 0.9081164, 'binary_f1_score': 0.6849574}
confusion matrix:
     0    1
0  593   60
1  273  362
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.83023256, 'precision': 0.8302397, 'recall': 0.83023256, 'specificity': 0.83023256, 'f1': 0.83023167, 'auroc': 0.9092699, 'binary_precision': 0.8317757, 'binary_recall': 0.82790697, 'binary_specificity': 0.83255816, 'binary_f1_score': 0.8298368}
confusion matrix:
     0    1
0  179   36
1   37  178
early stop counter: 3
val acc:0.7414596080780029, best validation acc: 0.8633540272712708, corresponding to test acc:                         0.830232560634613 / 0.830232560634613
after epoch: 9,now: 2024-07-23 11:07:43.249126,epoch time: 0:01:14.819660,used: 0:13:20.589045,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_10_54_22_seed_0_22795139
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9798177, 'precision': 0.9802566, 'recall': 0.98002857, 'specificity': 0.98002857, 'f1': 0.9798169, 'auroc': 0.99849254, 'binary_precision': 0.99799734, 'binary_recall': 0.96203345, 'binary_specificity': 0.9980237, 'binary_f1_score': 0.9796855}
confusion matrix:
      0     1
0  1515     3
1    59  1495
---- Validation: 
scalar performance:
{'acc': 0.64829195, 'precision': 0.7536347, 'recall': 0.6437195, 'specificity': 0.6437195, 'f1': 0.6034782, 'auroc': 0.8537724, 'binary_precision': 0.9136364, 'binary_recall': 0.31653544, 'binary_specificity': 0.9709035, 'binary_f1_score': 0.47017547}
confusion matrix:
     0    1
0  634   19
1  434  201
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7837209, 'precision': 0.83927464, 'recall': 0.7837209, 'specificity': 0.7837209, 'f1': 0.7744895, 'auroc': 0.90786374, 'binary_precision': 0.9765625, 'binary_recall': 0.5813953, 'binary_specificity': 0.9860465, 'binary_f1_score': 0.72886294}
confusion matrix:
     0    1
0  212    3
1   90  125
early stop counter: 4
val acc:0.6482919454574585, best validation acc: 0.8633540272712708, corresponding to test acc:                         0.830232560634613 / 0.830232560634613
after epoch: 10,now: 2024-07-23 11:08:58.192836,epoch time: 0:01:14.943710,used: 0:14:35.532755,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_10_54_22_seed_0_22795139
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.98307294, 'precision': 0.98313177, 'recall': 0.98302525, 'specificity': 0.98302525, 'f1': 0.98306805, 'auroc': 0.99810755, 'binary_precision': 0.980217, 'binary_recall': 0.98651254, 'binary_specificity': 0.97953796, 'binary_f1_score': 0.9833547}
confusion matrix:
      0     1
0  1484    31
1    21  1536
---- Validation: 
scalar performance:
{'acc': 0.73447204, 'precision': 0.7618476, 'recall': 0.7321629, 'specificity': 0.7321629, 'f1': 0.7260372, 'auroc': 0.81499076, 'binary_precision': 0.8430913, 'binary_recall': 0.56692916, 'binary_specificity': 0.8973966, 'binary_f1_score': 0.6779661}
confusion matrix:
     0    1
0  586   67
1  275  360
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.86744183, 'precision': 0.87744445, 'recall': 0.8674419, 'specificity': 0.8674419, 'f1': 0.8665578, 'auroc': 0.92739856, 'binary_precision': 0.9388889, 'binary_recall': 0.7860465, 'binary_specificity': 0.9488372, 'binary_f1_score': 0.8556962}
confusion matrix:
     0    1
0  204   11
1   46  169
new oracle model saved
early stop counter: 5
val acc:0.7344720363616943, best validation acc: 0.8633540272712708, corresponding to test acc:                         0.830232560634613 / 0.8674418330192566
after epoch: 11,now: 2024-07-23 11:10:13.698855,epoch time: 0:01:15.506019,used: 0:15:51.038774,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_10_54_22_seed_0_22795139
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.98079425, 'precision': 0.9812073, 'recall': 0.98105615, 'specificity': 0.98105615, 'f1': 0.98079395, 'auroc': 0.99878323, 'binary_precision': 0.9993338, 'binary_recall': 0.9627728, 'binary_specificity': 0.9993395, 'binary_f1_score': 0.98071265}
confusion matrix:
      0     1
0  1513     1
1    58  1500
---- Validation: 
scalar performance:
{'acc': 0.6700311, 'precision': 0.7559372, 'recall': 0.66591865, 'specificity': 0.66591865, 'f1': 0.6365358, 'auroc': 0.8554822, 'binary_precision': 0.90076333, 'binary_recall': 0.37165356, 'binary_specificity': 0.96018374, 'binary_f1_score': 0.5261985}
confusion matrix:
     0    1
0  627   26
1  399  236
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7860465, 'precision': 0.80686486, 'recall': 0.7860465, 'specificity': 0.7860465, 'f1': 0.7823552, 'auroc': 0.8967658, 'binary_precision': 0.8867925, 'binary_recall': 0.65581393, 'binary_specificity': 0.9162791, 'binary_f1_score': 0.75401074}
confusion matrix:
     0    1
0  197   18
1   74  141
early stop counter: 6
val acc:0.6700310707092285, best validation acc: 0.8633540272712708, corresponding to test acc:                         0.830232560634613 / 0.8674418330192566
after epoch: 12,now: 2024-07-23 11:11:29.017130,epoch time: 0:01:15.318275,used: 0:17:06.357049,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_10_54_22_seed_0_22795139
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.98372394, 'precision': 0.98396343, 'recall': 0.9839257, 'specificity': 0.9839257, 'f1': 0.98372394, 'auroc': 0.9995218, 'binary_precision': 0.99867636, 'binary_recall': 0.96917146, 'binary_specificity': 0.9986799, 'binary_f1_score': 0.9837027}
confusion matrix:
      0     1
0  1513     2
1    48  1509
---- Validation: 
scalar performance:
{'acc': 0.68090063, 'precision': 0.7490306, 'recall': 0.677181, 'specificity': 0.677181, 'f1': 0.65466666, 'auroc': 0.84944654, 'binary_precision': 0.87583894, 'binary_recall': 0.41102362, 'binary_specificity': 0.94333845, 'binary_f1_score': 0.5594855}
confusion matrix:
     0    1
0  616   37
1  374  261
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7651163, 'precision': 0.8170271, 'recall': 0.7651163, 'specificity': 0.7651163, 'f1': 0.7550907, 'auroc': 0.8866631, 'binary_precision': 0.9453125, 'binary_recall': 0.5627907, 'binary_specificity': 0.96744186, 'binary_f1_score': 0.70553935}
confusion matrix:
     0    1
0  208    7
1   94  121
early stop counter: 7
val acc:0.6809006333351135, best validation acc: 0.8633540272712708, corresponding to test acc:                         0.830232560634613 / 0.8674418330192566
after epoch: 13,now: 2024-07-23 11:12:44.995693,epoch time: 0:01:15.978563,used: 0:18:22.335612,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_10_54_22_seed_0_22795139
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9860026, 'precision': 0.9861342, 'recall': 0.98615706, 'specificity': 0.98615706, 'f1': 0.98600256, 'auroc': 0.9995799, 'binary_precision': 0.998025, 'binary_recall': 0.97429305, 'binary_specificity': 0.9980211, 'binary_f1_score': 0.9860163}
confusion matrix:
      0     1
0  1513     3
1    40  1516
---- Validation: 
scalar performance:
{'acc': 0.7259317, 'precision': 0.7908013, 'recall': 0.72258985, 'specificity': 0.72258985, 'f1': 0.70778126, 'auroc': 0.90653074, 'binary_precision': 0.92469877, 'binary_recall': 0.48346457, 'binary_specificity': 0.96171516, 'binary_f1_score': 0.6349535}
confusion matrix:
     0    1
0  628   25
1  328  307
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8395349, 'precision': 0.8633102, 'recall': 0.8395349, 'specificity': 0.8395349, 'f1': 0.83686596, 'auroc': 0.923483, 'binary_precision': 0.95625, 'binary_recall': 0.7116279, 'binary_specificity': 0.96744186, 'binary_f1_score': 0.816}
confusion matrix:
     0    1
0  208    7
1   62  153
early stop counter: 8
val acc:0.725931704044342, best validation acc: 0.8633540272712708, corresponding to test acc:                         0.830232560634613 / 0.8674418330192566
after epoch: 14,now: 2024-07-23 11:13:59.702494,epoch time: 0:01:14.706801,used: 0:19:37.042413,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_10_54_22_seed_0_22795139
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9889323, 'precision': 0.98894244, 'recall': 0.9890419, 'specificity': 0.9890419, 'f1': 0.9889318, 'auroc': 0.99966466, 'binary_precision': 0.9967405, 'binary_recall': 0.98138636, 'binary_specificity': 0.9966975, 'binary_f1_score': 0.98900384}
confusion matrix:
      0     1
0  1509     5
1    29  1529
---- Validation: 
scalar performance:
{'acc': 0.7290373, 'precision': 0.78432155, 'recall': 0.7259131, 'specificity': 0.7259131, 'f1': 0.7133841, 'auroc': 0.8892362, 'binary_precision': 0.90625, 'binary_recall': 0.5023622, 'binary_specificity': 0.949464, 'binary_f1_score': 0.6464032}
confusion matrix:
     0    1
0  620   33
1  316  319
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.872093, 'precision': 0.88914025, 'recall': 0.872093, 'specificity': 0.872093, 'f1': 0.87067664, 'auroc': 0.93557596, 'binary_precision': 0.9705882, 'binary_recall': 0.76744187, 'binary_specificity': 0.9767442, 'binary_f1_score': 0.8571428}
confusion matrix:
     0    1
0  210    5
1   50  165
new oracle model saved
early stop counter: 9
val acc:0.7290372848510742, best validation acc: 0.8633540272712708, corresponding to test acc:                         0.830232560634613 / 0.8720930218696594
after epoch: 15,now: 2024-07-23 11:15:15.148552,epoch time: 0:01:15.446058,used: 0:20:52.488471,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_10_54_22_seed_0_22795139
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9625651, 'precision': 0.96558946, 'recall': 0.96207124, 'specificity': 0.96207124, 'f1': 0.9624696, 'auroc': 0.9994807, 'binary_precision': 0.9311789, 'binary_recall': 1.0, 'binary_specificity': 0.9241425, 'binary_f1_score': 0.96436316}
confusion matrix:
      0     1
0  1401   115
1     0  1556
---- Validation: 
scalar performance:
{'acc': 0.76475155, 'precision': 0.8009509, 'recall': 0.7671474, 'specificity': 0.7671474, 'f1': 0.7585142, 'auroc': 0.8910383, 'binary_precision': 0.69302326, 'binary_recall': 0.93858266, 'binary_specificity': 0.5957121, 'binary_f1_score': 0.7973245}
confusion matrix:
     0    1
0  389  264
1   39  596
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.727907, 'precision': 0.79244393, 'recall': 0.72790694, 'specificity': 0.72790694, 'f1': 0.71201897, 'auroc': 0.9379773, 'binary_precision': 0.6550633, 'binary_recall': 0.96279067, 'binary_specificity': 0.49302325, 'binary_f1_score': 0.779661}
confusion matrix:
     0    1
0  106  109
1    8  207
early stop counter: 10
val acc:0.7647515535354614, best validation acc: 0.8633540272712708, corresponding to test acc:                         0.830232560634613 / 0.8720930218696594
after epoch: 16,now: 2024-07-23 11:16:40.511032,epoch time: 0:01:25.362480,used: 0:22:17.850951,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_10_54_22_seed_0_22795139
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9798177, 'precision': 0.9801078, 'recall': 0.98004675, 'specificity': 0.98004675, 'f1': 0.9798176, 'auroc': 0.9989715, 'binary_precision': 0.9960212, 'binary_recall': 0.9640565, 'binary_specificity': 0.996037, 'binary_f1_score': 0.9797782}
confusion matrix:
      0     1
0  1508     6
1    56  1502
---- Validation: 
scalar performance:
{'acc': 0.79347825, 'precision': 0.82993484, 'recall': 0.7911372, 'specificity': 0.7911372, 'f1': 0.7866758, 'auroc': 0.91958135, 'binary_precision': 0.9361702, 'binary_recall': 0.62362206, 'binary_specificity': 0.9586524, 'binary_f1_score': 0.74858224}
confusion matrix:
     0    1
0  626   27
1  239  396
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8488372, 'precision': 0.87140685, 'recall': 0.84883726, 'specificity': 0.84883726, 'f1': 0.8465053, 'auroc': 0.91989183, 'binary_precision': 0.962963, 'binary_recall': 0.7255814, 'binary_specificity': 0.97209305, 'binary_f1_score': 0.82758623}
confusion matrix:
     0    1
0  209    6
1   59  156
early stop counter: 11
val acc:0.79347825050354, best validation acc: 0.8633540272712708, corresponding to test acc:                         0.830232560634613 / 0.8720930218696594
after epoch: 17,now: 2024-07-23 11:18:31.907905,epoch time: 0:01:51.396873,used: 0:24:09.247824,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_10_54_22_seed_0_22795139
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9860026, 'precision': 0.9859917, 'recall': 0.9860723, 'specificity': 0.9860723, 'f1': 0.98600173, 'auroc': 0.9991038, 'binary_precision': 0.99155295, 'binary_recall': 0.9807198, 'binary_specificity': 0.9914248, 'binary_f1_score': 0.9861066}
confusion matrix:
      0     1
0  1503    13
1    30  1526
---- Validation: 
scalar performance:
{'acc': 0.79891306, 'precision': 0.8209766, 'recall': 0.79706144, 'specificity': 0.79706144, 'f1': 0.79467714, 'auroc': 0.8859365, 'binary_precision': 0.9017094, 'binary_recall': 0.66456693, 'binary_specificity': 0.9295559, 'binary_f1_score': 0.7651859}
confusion matrix:
     0    1
0  607   46
1  213  422
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.88372093, 'precision': 0.897479, 'recall': 0.88372093, 'specificity': 0.88372093, 'f1': 0.8827059, 'auroc': 0.94068146, 'binary_precision': 0.9714286, 'binary_recall': 0.7906977, 'binary_specificity': 0.9767442, 'binary_f1_score': 0.87179494}
confusion matrix:
     0    1
0  210    5
1   45  170
new oracle model saved
early stop counter: 12
val acc:0.7989130616188049, best validation acc: 0.8633540272712708, corresponding to test acc:                         0.830232560634613 / 0.8837209343910217
after epoch: 18,now: 2024-07-23 11:20:23.308470,epoch time: 0:01:51.400565,used: 0:26:00.648389,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_10_54_22_seed_0_22795139
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.98860675, 'precision': 0.9887097, 'recall': 0.9887605, 'specificity': 0.9887605, 'f1': 0.9886067, 'auroc': 0.99983805, 'binary_precision': 1.0, 'binary_recall': 0.9775209, 'binary_specificity': 1.0, 'binary_f1_score': 0.9886326}
confusion matrix:
      0     1
0  1515     0
1    35  1522
---- Validation: 
scalar performance:
{'acc': 0.8159938, 'precision': 0.83767974, 'recall': 0.8142106, 'specificity': 0.8142106, 'f1': 0.81236994, 'auroc': 0.9089484, 'binary_precision': 0.9198312, 'binary_recall': 0.68661416, 'binary_specificity': 0.94180703, 'binary_f1_score': 0.786294}
confusion matrix:
     0    1
0  615   38
1  199  436
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.872093, 'precision': 0.8780552, 'recall': 0.872093, 'specificity': 0.872093, 'f1': 0.8715868, 'auroc': 0.9307085, 'binary_precision': 0.9255319, 'binary_recall': 0.80930233, 'binary_specificity': 0.9348837, 'binary_f1_score': 0.8635236}
confusion matrix:
     0    1
0  201   14
1   41  174
early stop counter: 13
val acc:0.8159937858581543, best validation acc: 0.8633540272712708, corresponding to test acc:                         0.830232560634613 / 0.8837209343910217
after epoch: 19,now: 2024-07-23 11:22:12.524147,epoch time: 0:01:49.215677,used: 0:27:49.864066,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_10_54_22_seed_0_22795139
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9866536, 'precision': 0.9868058, 'recall': 0.98656654, 'specificity': 0.98656654, 'f1': 0.9866484, 'auroc': 0.9994892, 'binary_precision': 0.9809645, 'binary_recall': 0.9929351, 'binary_specificity': 0.980198, 'binary_f1_score': 0.9869135}
confusion matrix:
      0     1
0  1485    30
1    11  1546
---- Validation: 
scalar performance:
{'acc': 0.8206522, 'precision': 0.8293999, 'recall': 0.8194994, 'specificity': 0.8194994, 'f1': 0.8190553, 'auroc': 0.91177726, 'binary_precision': 0.87969923, 'binary_recall': 0.73700786, 'binary_specificity': 0.90199083, 'binary_f1_score': 0.80205655}
confusion matrix:
     0    1
0  589   64
1  167  468
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8465116, 'precision': 0.84844136, 'recall': 0.8465116, 'specificity': 0.8465116, 'f1': 0.8462988, 'auroc': 0.909616, 'binary_precision': 0.8743719, 'binary_recall': 0.80930233, 'binary_specificity': 0.88372093, 'binary_f1_score': 0.84057975}
confusion matrix:
     0    1
0  190   25
1   41  174
early stop counter: 14
val acc:0.820652186870575, best validation acc: 0.8633540272712708, corresponding to test acc:                         0.830232560634613 / 0.8837209343910217
after epoch: 20,now: 2024-07-23 11:24:09.723238,epoch time: 0:01:57.199091,used: 0:29:47.063157,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_10_54_22_seed_0_22795139
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9840495, 'precision': 0.9843136, 'recall': 0.984246, 'specificity': 0.984246, 'f1': 0.98404944, 'auroc': 0.99969983, 'binary_precision': 0.9993373, 'binary_recall': 0.9691517, 'binary_specificity': 0.99934036, 'binary_f1_score': 0.9840131}
confusion matrix:
      0     1
0  1515     1
1    48  1508
---- Validation: 
scalar performance:
{'acc': 0.5745342, 'precision': 0.7333169, 'recall': 0.5686776, 'specificity': 0.5686776, 'f1': 0.4796512, 'auroc': 0.85623705, 'binary_precision': 0.9223301, 'binary_recall': 0.1496063, 'binary_specificity': 0.98774886, 'binary_f1_score': 0.25745258}
confusion matrix:
     0   1
0  645   8
1  540  95
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.68372095, 'precision': 0.8062678, 'recall': 0.68372095, 'specificity': 0.68372095, 'f1': 0.6485661, 'auroc': 0.91138995, 'binary_precision': 1.0, 'binary_recall': 0.36744186, 'binary_specificity': 1.0, 'binary_f1_score': 0.53741497}
confusion matrix:
     0   1
0  215   0
1  136  79
early stop counter: 15
val acc:0.5745341777801514, best validation acc: 0.8633540272712708, corresponding to test acc:                         0.830232560634613 / 0.8837209343910217
after epoch: 21,now: 2024-07-23 11:25:55.647979,epoch time: 0:01:45.924741,used: 0:31:32.987898,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_10_54_22_seed_0_22795139
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.98860675, 'precision': 0.9886969, 'recall': 0.98874474, 'specificity': 0.98874474, 'f1': 0.9886067, 'auroc': 0.9994612, 'binary_precision': 0.9993434, 'binary_recall': 0.9781491, 'binary_specificity': 0.99934036, 'binary_f1_score': 0.9886327}
confusion matrix:
      0     1
0  1515     1
1    34  1522
---- Validation: 
scalar performance:
{'acc': 0.66071427, 'precision': 0.76804864, 'recall': 0.65623105, 'specificity': 0.65623105, 'f1': 0.6192595, 'auroc': 0.9103158, 'binary_precision': 0.93421054, 'binary_recall': 0.33543307, 'binary_specificity': 0.9770291, 'binary_f1_score': 0.4936269}
confusion matrix:
     0    1
0  638   15
1  422  213
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7255814, 'precision': 0.8228228, 'recall': 0.7255814, 'specificity': 0.7255814, 'f1': 0.7032332, 'auroc': 0.91392106, 'binary_precision': 1.0, 'binary_recall': 0.4511628, 'binary_specificity': 1.0, 'binary_f1_score': 0.6217949}
confusion matrix:
     0   1
0  215   0
1  118  97
early stop counter: 16
val acc:0.6607142686843872, best validation acc: 0.8633540272712708, corresponding to test acc:                         0.830232560634613 / 0.8837209343910217
after epoch: 22,now: 2024-07-23 11:27:38.239094,epoch time: 0:01:42.591115,used: 0:33:15.579013,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_10_54_22_seed_0_22795139
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.99576825, 'precision': 0.9957576, 'recall': 0.99577963, 'specificity': 0.99577963, 'f1': 0.9957677, 'auroc': 0.9996973, 'binary_precision': 0.99677837, 'binary_recall': 0.9948553, 'binary_specificity': 0.99670404, 'binary_f1_score': 0.9958159}
confusion matrix:
      0     1
0  1512     5
1     8  1547
---- Validation: 
scalar performance:
{'acc': 0.7290373, 'precision': 0.76363945, 'recall': 0.72645575, 'specificity': 0.72645575, 'f1': 0.7183408, 'auroc': 0.8647984, 'binary_precision': 0.8557214, 'binary_recall': 0.5417323, 'binary_specificity': 0.9111792, 'binary_f1_score': 0.66345227}
confusion matrix:
     0    1
0  595   58
1  291  344
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8465116, 'precision': 0.8475945, 'recall': 0.8465116, 'specificity': 0.8465116, 'f1': 0.84639204, 'auroc': 0.91939425, 'binary_precision': 0.8669951, 'binary_recall': 0.81860465, 'binary_specificity': 0.8744186, 'binary_f1_score': 0.84210527}
confusion matrix:
     0    1
0  188   27
1   39  176
early stop counter: 17
val acc:0.7290372848510742, best validation acc: 0.8633540272712708, corresponding to test acc:                         0.830232560634613 / 0.8837209343910217
after epoch: 23,now: 2024-07-23 11:29:18.801824,epoch time: 0:01:40.562730,used: 0:34:56.141743,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_10_54_22_seed_0_22795139
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9794922, 'precision': 0.98017794, 'recall': 0.9792702, 'specificity': 0.9792702, 'f1': 0.9794742, 'auroc': 0.99926317, 'binary_precision': 0.96513075, 'binary_recall': 0.9955042, 'binary_specificity': 0.9630363, 'binary_f1_score': 0.9800822}
confusion matrix:
      0     1
0  1459    56
1     7  1550
---- Validation: 
scalar performance:
{'acc': 0.84782606, 'precision': 0.84842443, 'recall': 0.84812194, 'specificity': 0.84812194, 'f1': 0.8478129, 'auroc': 0.9135402, 'binary_precision': 0.8300752, 'binary_recall': 0.86929137, 'binary_specificity': 0.8269525, 'binary_f1_score': 0.8492308}
confusion matrix:
     0    1
0  540  113
1   83  552
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.89069766, 'precision': 0.8907738, 'recall': 0.8906977, 'specificity': 0.8906977, 'f1': 0.89069235, 'auroc': 0.94303954, 'binary_precision': 0.8853211, 'binary_recall': 0.89767444, 'binary_specificity': 0.88372093, 'binary_f1_score': 0.891455}
confusion matrix:
     0    1
0  190   25
1   22  193
new oracle model saved
early stop counter: 18
val acc:0.8478260636329651, best validation acc: 0.8633540272712708, corresponding to test acc:                         0.830232560634613 / 0.8906976580619812
after epoch: 24,now: 2024-07-23 11:31:16.967101,epoch time: 0:01:58.165277,used: 0:36:54.307020,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_10_54_22_seed_0_22795139
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.9938151, 'precision': 0.9937939, 'recall': 0.9938607, 'specificity': 0.9938607, 'f1': 0.9938145, 'auroc': 0.99978554, 'binary_precision': 0.997411, 'binary_recall': 0.9903599, 'binary_specificity': 0.9973615, 'binary_f1_score': 0.99387294}
confusion matrix:
      0     1
0  1512     4
1    15  1541
---- Validation: 
scalar performance:
{'acc': 0.73524845, 'precision': 0.7995609, 'recall': 0.7319736, 'specificity': 0.7319736, 'f1': 0.7184057, 'auroc': 0.89231765, 'binary_precision': 0.93491125, 'binary_recall': 0.4976378, 'binary_specificity': 0.96630937, 'binary_f1_score': 0.64953756}
confusion matrix:
     0    1
0  631   22
1  319  316
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.82325584, 'precision': 0.85918605, 'recall': 0.8232558, 'specificity': 0.8232558, 'f1': 0.81872237, 'auroc': 0.9156517, 'binary_precision': 0.9727891, 'binary_recall': 0.66511625, 'binary_specificity': 0.98139536, 'binary_f1_score': 0.7900552}
confusion matrix:
     0    1
0  211    4
1   72  143
early stop counter: 19
val acc:0.7352484464645386, best validation acc: 0.8633540272712708, corresponding to test acc:                         0.830232560634613 / 0.8906976580619812
after epoch: 25,now: 2024-07-23 11:33:18.335080,epoch time: 0:02:01.367979,used: 0:38:55.674999,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_10_54_22_seed_0_22795139
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.991862, 'precision': 0.9918331, 'recall': 0.9919363, 'specificity': 0.9919363, 'f1': 0.99186105, 'auroc': 0.99951667, 'binary_precision': 0.99676377, 'binary_recall': 0.98717946, 'binary_specificity': 0.99669313, 'binary_f1_score': 0.9919485}
confusion matrix:
      0     1
0  1507     5
1    20  1540
---- Validation: 
scalar performance:
{'acc': 0.8493789, 'precision': 0.86390543, 'recall': 0.84798205, 'specificity': 0.84798205, 'f1': 0.84747237, 'auroc': 0.92357504, 'binary_precision': 0.9332024, 'binary_recall': 0.7480315, 'binary_specificity': 0.9479326, 'binary_f1_score': 0.8304196}
confusion matrix:
     0    1
0  619   34
1  160  475
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8581395, 'precision': 0.8745475, 'recall': 0.8581395, 'specificity': 0.8581395, 'f1': 0.8565687, 'auroc': 0.9164305, 'binary_precision': 0.9529412, 'binary_recall': 0.75348836, 'binary_specificity': 0.96279067, 'binary_f1_score': 0.84155846}
confusion matrix:
     0    1
0  207    8
1   53  162
early stop counter: 20
val acc:0.8493788838386536, best validation acc: 0.8633540272712708, corresponding to test acc:                         0.830232560634613 / 0.8906976580619812
after epoch: 26,now: 2024-07-23 11:35:05.127461,epoch time: 0:01:46.792381,used: 0:40:42.467380,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_10_54_22_seed_0_22795139
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.9954427, 'precision': 0.99546266, 'recall': 0.99542403, 'specificity': 0.99542403, 'f1': 0.9954417, 'auroc': 0.99978006, 'binary_precision': 0.99423444, 'binary_recall': 0.9967887, 'binary_specificity': 0.9940594, 'binary_f1_score': 0.99551}
confusion matrix:
      0     1
0  1506     9
1     5  1552
---- Validation: 
scalar performance:
{'acc': 0.76397514, 'precision': 0.806362, 'recall': 0.7613462, 'specificity': 0.7613462, 'f1': 0.7542676, 'auroc': 0.8954071, 'binary_precision': 0.91687655, 'binary_recall': 0.57322836, 'binary_specificity': 0.949464, 'binary_f1_score': 0.70542634}
confusion matrix:
     0    1
0  620   33
1  271  364
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.88139534, 'precision': 0.88949275, 'recall': 0.88139534, 'specificity': 0.88139534, 'f1': 0.8807757, 'auroc': 0.93300164, 'binary_precision': 0.9456522, 'binary_recall': 0.80930233, 'binary_specificity': 0.95348835, 'binary_f1_score': 0.8721804}
confusion matrix:
     0    1
0  205   10
1   41  174
early stop counter: 21
val acc:0.7639751434326172, best validation acc: 0.8633540272712708, corresponding to test acc:                         0.830232560634613 / 0.8906976580619812
after epoch: 27,now: 2024-07-23 11:37:05.637339,epoch time: 0:02:00.509878,used: 0:42:42.977258,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_10_54_22_seed_0_22795139
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.99316406, 'precision': 0.99316406, 'recall': 0.9932395, 'specificity': 0.9932395, 'f1': 0.9931638, 'auroc': 0.9999156, 'binary_precision': 0.99934894, 'binary_recall': 0.9871383, 'binary_specificity': 0.99934083, 'binary_f1_score': 0.9932061}
confusion matrix:
      0     1
0  1516     1
1    20  1535
---- Validation: 
scalar performance:
{'acc': 0.81909937, 'precision': 0.8479432, 'recall': 0.81707805, 'specificity': 0.81707805, 'f1': 0.81458384, 'auroc': 0.93227863, 'binary_precision': 0.9446903, 'binary_recall': 0.67244095, 'binary_specificity': 0.96171516, 'binary_f1_score': 0.7856486}
confusion matrix:
     0    1
0  628   25
1  208  427
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7744186, 'precision': 0.8409946, 'recall': 0.7744186, 'specificity': 0.7744186, 'f1': 0.7628429, 'auroc': 0.9385614, 'binary_precision': 0.9916667, 'binary_recall': 0.5534884, 'binary_specificity': 0.9953488, 'binary_f1_score': 0.7104478}
confusion matrix:
     0    1
0  214    1
1   96  119
early stop counter: 22
val acc:0.8190993666648865, best validation acc: 0.8633540272712708, corresponding to test acc:                         0.830232560634613 / 0.8906976580619812
after epoch: 28,now: 2024-07-23 11:39:08.873656,epoch time: 0:02:03.236317,used: 0:44:46.213575,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_10_54_22_seed_0_22795139
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9938151, 'precision': 0.9937918, 'recall': 0.99385405, 'specificity': 0.99385405, 'f1': 0.9938144, 'auroc': 0.9997567, 'binary_precision': 0.99677, 'binary_recall': 0.99100834, 'binary_specificity': 0.9966997, 'binary_f1_score': 0.9938808}
confusion matrix:
      0     1
0  1510     5
1    14  1543
---- Validation: 
scalar performance:
{'acc': 0.79425466, 'precision': 0.8072562, 'recall': 0.7927928, 'specificity': 0.7927928, 'f1': 0.79146385, 'auroc': 0.8889631, 'binary_precision': 0.86706346, 'binary_recall': 0.68818897, 'binary_specificity': 0.8973966, 'binary_f1_score': 0.76733977}
confusion matrix:
     0    1
0  586   67
1  198  437
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8697674, 'precision': 0.8697995, 'recall': 0.8697674, 'specificity': 0.8697674, 'f1': 0.8697647, 'auroc': 0.9343213, 'binary_precision': 0.87323946, 'binary_recall': 0.8651163, 'binary_specificity': 0.8744186, 'binary_f1_score': 0.8691589}
confusion matrix:
     0    1
0  188   27
1   29  186
early stop counter: 23
val acc:0.7942546606063843, best validation acc: 0.8633540272712708, corresponding to test acc:                         0.830232560634613 / 0.8906976580619812
after epoch: 29,now: 2024-07-23 11:41:18.790695,epoch time: 0:02:09.917039,used: 0:46:56.130614,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_10_54_22_seed_0_22795139
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.9938151, 'precision': 0.9938071, 'recall': 0.9938985, 'specificity': 0.9938985, 'f1': 0.99381477, 'auroc': 0.9998665, 'binary_precision': 1.0, 'binary_recall': 0.987797, 'binary_specificity': 1.0, 'binary_f1_score': 0.9938611}
confusion matrix:
      0     1
0  1515     0
1    19  1538
---- Validation: 
scalar performance:
{'acc': 0.6840062, 'precision': 0.78555346, 'recall': 0.679788, 'specificity': 0.679788, 'f1': 0.6500895, 'auroc': 0.8456379, 'binary_precision': 0.95238096, 'binary_recall': 0.37795275, 'binary_specificity': 0.9816233, 'binary_f1_score': 0.54115}
confusion matrix:
     0    1
0  641   12
1  395  240
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.74186045, 'precision': 0.8297546, 'recall': 0.74186045, 'specificity': 0.74186045, 'f1': 0.723431, 'auroc': 0.95208216, 'binary_precision': 1.0, 'binary_recall': 0.48372093, 'binary_specificity': 1.0, 'binary_f1_score': 0.6520376}
confusion matrix:
     0    1
0  215    0
1  111  104
early stop counter: 24
val acc:0.6840062141418457, best validation acc: 0.8633540272712708, corresponding to test acc:                         0.830232560634613 / 0.8906976580619812
after epoch: 30,now: 2024-07-23 11:43:29.362471,epoch time: 0:02:10.571776,used: 0:49:06.702390,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_10_54_22_seed_0_22795139
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 0:49:06.702390 at 2024-07-23 11:43:29.362471
persisted model performance metric: 

scalar performance:
{'acc': 0.83023256, 'precision': 0.8392222, 'recall': 0.83023256, 'specificity': 0.83023256, 'f1': 0.8291003, 'auroc': 0.9207139, 'binary_precision': 0.784, 'binary_recall': 0.9116279, 'binary_specificity': 0.74883723, 'binary_f1_score': 0.8430107}
confusion matrix:
     0    1
0  161   54
1   19  196
oracle model performance metric: 

scalar performance:
{'acc': 0.89069766, 'precision': 0.8907738, 'recall': 0.8906977, 'specificity': 0.8906977, 'f1': 0.89069235, 'auroc': 0.94303954, 'binary_precision': 0.8853211, 'binary_recall': 0.89767444, 'binary_specificity': 0.88372093, 'binary_f1_score': 0.891455}
confusion matrix:
     0    1
0  190   25
1   22  193
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_dial_lr1e5_bs32__45_nofreeze_2024-07-23_10-43-50/rule_results/5.csv
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_dial_lr1e5_bs32__45_nofreeze_2024-07-23_10-43-50/rule_results/5.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_dial_lr1e5_bs32__45_nofreeze_2024-07-23_10-43-50/confusion_matrix/5.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 455936 KiB |  26075 MiB |  70808 GiB |  70808 GiB |
|       from large pool | 415383 KiB |  26030 MiB |  70366 GiB |  70366 GiB |
|       from small pool |  40553 KiB |     56 MiB |    442 GiB |    442 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 455936 KiB |  26075 MiB |  70808 GiB |  70808 GiB |
|       from large pool | 415383 KiB |  26030 MiB |  70366 GiB |  70366 GiB |
|       from small pool |  40553 KiB |     56 MiB |    442 GiB |    442 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 447480 KiB |  26071 MiB |  70794 GiB |  70793 GiB |
|       from large pool | 407075 KiB |  26026 MiB |  70352 GiB |  70352 GiB |
|       from small pool |  40405 KiB |     56 MiB |    441 GiB |    441 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  27748 MiB |  27748 MiB |  27748 MiB |      0 B   |
|       from large pool |  27680 MiB |  27680 MiB |  27680 MiB |      0 B   |
|       from small pool |     68 MiB |     68 MiB |     68 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory | 785151 KiB |   1678 MiB |  33156 GiB |  33155 GiB |
|       from large pool | 770409 KiB |   1668 MiB |  32711 GiB |  32710 GiB |
|       from small pool |  14742 KiB |     19 MiB |    444 GiB |    444 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    1220    |    2568    |    6429 K  |    6428 K  |
|       from large pool |     187    |    1413    |    3247 K  |    3247 K  |
|       from small pool |    1033    |    1329    |    3181 K  |    3180 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    1220    |    2568    |    6429 K  |    6428 K  |
|       from large pool |     187    |    1413    |    3247 K  |    3247 K  |
|       from small pool |    1033    |    1329    |    3181 K  |    3180 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     834    |     834    |     834    |       0    |
|       from large pool |     800    |     800    |     800    |       0    |
|       from small pool |      34    |      34    |      34    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     103    |     850    |    4744 K  |    4744 K  |
|       from large pool |      39    |     799    |    2905 K  |    2905 K  |
|       from small pool |      64    |     146    |    1839 K  |    1839 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  26075 MiB |  70808 GiB |  70808 GiB |
|       from large pool |  16640 KiB |  26030 MiB |  70366 GiB |  70366 GiB |
|       from small pool |      0 KiB |     56 MiB |    442 GiB |    442 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  26075 MiB |  70808 GiB |  70808 GiB |
|       from large pool |  16640 KiB |  26030 MiB |  70366 GiB |  70366 GiB |
|       from small pool |      0 KiB |     56 MiB |    442 GiB |    442 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  26071 MiB |  70794 GiB |  70794 GiB |
|       from large pool |  16640 KiB |  26026 MiB |  70352 GiB |  70352 GiB |
|       from small pool |      0 KiB |     56 MiB |    441 GiB |    441 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1212 MiB |  27748 MiB |  27748 MiB |  26536 MiB |
|       from large pool |   1158 MiB |  27680 MiB |  27680 MiB |  26522 MiB |
|       from small pool |     54 MiB |     68 MiB |     68 MiB |     14 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |   3840 KiB |   1678 MiB |  33156 GiB |  33156 GiB |
|       from large pool |   3840 KiB |   1668 MiB |  32711 GiB |  32711 GiB |
|       from small pool |      0 KiB |     31 MiB |    444 GiB |    444 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    2568    |    6429 K  |    6429 K  |
|       from large pool |       2    |    1413    |    3247 K  |    3247 K  |
|       from small pool |       0    |    1329    |    3181 K  |    3181 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    2568    |    6429 K  |    6429 K  |
|       from large pool |       2    |    1413    |    3247 K  |    3247 K  |
|       from small pool |       0    |    1329    |    3181 K  |    3181 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      66    |     834    |     834    |     768    |
|       from large pool |      39    |     800    |     800    |     761    |
|       from small pool |      27    |      34    |      34    |       7    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       1    |     850    |    4744 K  |    4744 K  |
|       from large pool |       1    |     799    |    2905 K  |    2905 K  |
|       from small pool |       0    |     146    |    1839 K  |    1839 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  26075 MiB |  70808 GiB |  70808 GiB |
|       from large pool |  16640 KiB |  26030 MiB |  70366 GiB |  70366 GiB |
|       from small pool |      0 KiB |     56 MiB |    442 GiB |    442 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  26075 MiB |  70808 GiB |  70808 GiB |
|       from large pool |  16640 KiB |  26030 MiB |  70366 GiB |  70366 GiB |
|       from small pool |      0 KiB |     56 MiB |    442 GiB |    442 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  26071 MiB |  70794 GiB |  70794 GiB |
|       from large pool |  16640 KiB |  26026 MiB |  70352 GiB |  70352 GiB |
|       from small pool |      0 KiB |     56 MiB |    441 GiB |    441 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1212 MiB |  27748 MiB |  27748 MiB |  26536 MiB |
|       from large pool |   1158 MiB |  27680 MiB |  27680 MiB |  26522 MiB |
|       from small pool |     54 MiB |     68 MiB |     68 MiB |     14 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |   3840 KiB |   1678 MiB |  33156 GiB |  33156 GiB |
|       from large pool |   3840 KiB |   1668 MiB |  32711 GiB |  32711 GiB |
|       from small pool |      0 KiB |     31 MiB |    444 GiB |    444 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    2568    |    6429 K  |    6429 K  |
|       from large pool |       2    |    1413    |    3247 K  |    3247 K  |
|       from small pool |       0    |    1329    |    3181 K  |    3181 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    2568    |    6429 K  |    6429 K  |
|       from large pool |       2    |    1413    |    3247 K  |    3247 K  |
|       from small pool |       0    |    1329    |    3181 K  |    3181 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      66    |     834    |     834    |     768    |
|       from large pool |      39    |     800    |     800    |     761    |
|       from small pool |      27    |      34    |      34    |       7    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       1    |     850    |    4744 K  |    4744 K  |
|       from large pool |       1    |     799    |    2905 K  |    2905 K  |
|       from small pool |       0    |     146    |    1839 K  |    1839 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'888c1ef2'
model name: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_11_46_12_seed_1_22795139

 Experiment start at: 2024-07-23 11:46:12.108518
before training, model accuracy: 0.6177777647972107
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.93098956, 'precision': 0.9341992, 'recall': 0.93163764, 'specificity': 0.93163764, 'f1': 0.9309193, 'auroc': 0.97462666, 'binary_precision': 0.9752825, 'binary_recall': 0.88639283, 'binary_specificity': 0.97688246, 'binary_f1_score': 0.9287156}
confusion matrix:
      0     1
0  1479    35
1   177  1381
---- Validation: 
scalar performance:
{'acc': 0.7876659, 'precision': 0.8231417, 'recall': 0.78492063, 'specificity': 0.78492063, 'f1': 0.7805291, 'auroc': 0.8997708, 'binary_precision': 0.9261905, 'binary_recall': 0.6174603, 'binary_specificity': 0.95238096, 'binary_f1_score': 0.7409524}
confusion matrix:
     0    1
0  620   31
1  241  389
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.85555553, 'precision': 0.8732581, 'recall': 0.85555553, 'specificity': 0.85555553, 'f1': 0.85382235, 'auroc': 0.9032692, 'binary_precision': 0.95454544, 'binary_recall': 0.74666667, 'binary_specificity': 0.96444446, 'binary_f1_score': 0.83790517}
confusion matrix:
     0    1
0  217    8
1   57  168
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-23 11:48:49.126728,epoch time: 0:02:37.018210,used: 0:02:37.018210,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_11_46_12_seed_1_22795139
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9671224, 'precision': 0.9671141, 'recall': 0.96712136, 'specificity': 0.96712136, 'f1': 0.9671176, 'auroc': 0.9944153, 'binary_precision': 0.967825, 'binary_recall': 0.96720254, 'binary_specificity': 0.9670402, 'binary_f1_score': 0.9675136}
confusion matrix:
      0     1
0  1467    50
1    51  1504
---- Validation: 
scalar performance:
{'acc': 0.8142077, 'precision': 0.8247309, 'recall': 0.8156682, 'specificity': 0.8156682, 'f1': 0.8131362, 'auroc': 0.91638017, 'binary_precision': 0.7620321, 'binary_recall': 0.9047619, 'binary_specificity': 0.7265745, 'binary_f1_score': 0.8272859}
confusion matrix:
     0    1
0  473  178
1   60  570
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7733333, 'precision': 0.80080867, 'recall': 0.7733333, 'specificity': 0.7733333, 'f1': 0.7680366, 'auroc': 0.92337775, 'binary_precision': 0.70989764, 'binary_recall': 0.92444444, 'binary_specificity': 0.62222224, 'binary_f1_score': 0.8030888}
confusion matrix:
     0    1
0  140   85
1   17  208
better model found
persisted
after epoch: 2,now: 2024-07-23 11:51:05.598968,epoch time: 0:02:16.472240,used: 0:04:53.490450,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_11_46_12_seed_1_22795139
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9707031, 'precision': 0.97109926, 'recall': 0.9709051, 'specificity': 0.9709051, 'f1': 0.9707021, 'auroc': 0.9966074, 'binary_precision': 0.988, 'binary_recall': 0.95366794, 'binary_specificity': 0.9881423, 'binary_f1_score': 0.97053045}
confusion matrix:
      0     1
0  1500    18
1    72  1482
---- Validation: 
scalar performance:
{'acc': 0.86729115, 'precision': 0.86736095, 'recall': 0.86715305, 'specificity': 0.86715305, 'f1': 0.86722314, 'auroc': 0.9205154, 'binary_precision': 0.86977494, 'binary_recall': 0.85873014, 'binary_specificity': 0.875576, 'binary_f1_score': 0.8642172}
confusion matrix:
     0    1
0  570   81
1   89  541
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8488889, 'precision': 0.85113615, 'recall': 0.8488889, 'specificity': 0.8488889, 'f1': 0.84864676, 'auroc': 0.9345185, 'binary_precision': 0.82304525, 'binary_recall': 0.8888889, 'binary_specificity': 0.8088889, 'binary_f1_score': 0.8547009}
confusion matrix:
     0    1
0  182   43
1   25  200
better model found
persisted
after epoch: 3,now: 2024-07-23 11:53:23.527169,epoch time: 0:02:17.928201,used: 0:07:11.418651,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_11_46_12_seed_1_22795139
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.96451825, 'precision': 0.96623135, 'recall': 0.9649489, 'specificity': 0.9649489, 'f1': 0.9645033, 'auroc': 0.99791384, 'binary_precision': 0.9979353, 'binary_recall': 0.9318766, 'binary_specificity': 0.9980211, 'binary_f1_score': 0.96377534}
confusion matrix:
      0     1
0  1513     3
1   106  1450
---- Validation: 
scalar performance:
{'acc': 0.8212334, 'precision': 0.8408363, 'recall': 0.81925243, 'specificity': 0.81925243, 'f1': 0.8179514, 'auroc': 0.916685, 'binary_precision': 0.91858035, 'binary_recall': 0.6984127, 'binary_specificity': 0.94009215, 'binary_f1_score': 0.7935077}
confusion matrix:
     0    1
0  612   39
1  190  440
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8711111, 'precision': 0.8797833, 'recall': 0.8711111, 'specificity': 0.8711111, 'f1': 0.8703711, 'auroc': 0.92724943, 'binary_precision': 0.9371728, 'binary_recall': 0.79555553, 'binary_specificity': 0.94666666, 'binary_f1_score': 0.8605769}
confusion matrix:
     0    1
0  213   12
1   46  179
new oracle model saved
early stop counter: 1
val acc:0.8212333917617798, best validation acc: 0.8672911524772644, corresponding to test acc:                         0.8488888740539551 / 0.8711110949516296
after epoch: 4,now: 2024-07-23 11:55:35.724846,epoch time: 0:02:12.197677,used: 0:09:23.616328,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_11_46_12_seed_1_22795139
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.98046875, 'precision': 0.98060346, 'recall': 0.98060346, 'specificity': 0.98060346, 'f1': 0.98046875, 'auroc': 0.99844503, 'binary_precision': 0.9920949, 'binary_recall': 0.969112, 'binary_specificity': 0.9920949, 'binary_f1_score': 0.98046875}
confusion matrix:
      0     1
0  1506    12
1    48  1506
---- Validation: 
scalar performance:
{'acc': 0.8516784, 'precision': 0.8617745, 'recall': 0.8503072, 'specificity': 0.8503072, 'f1': 0.8502525, 'auroc': 0.9260113, 'binary_precision': 0.918251, 'binary_recall': 0.76666665, 'binary_specificity': 0.9339478, 'binary_f1_score': 0.83564013}
confusion matrix:
     0    1
0  608   43
1  147  483
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8577778, 'precision': 0.87483704, 'recall': 0.8577778, 'specificity': 0.8577778, 'f1': 0.856141, 'auroc': 0.91932845, 'binary_precision': 0.9548023, 'binary_recall': 0.7511111, 'binary_specificity': 0.96444446, 'binary_f1_score': 0.840796}
confusion matrix:
     0    1
0  217    8
1   56  169
early stop counter: 2
val acc:0.8516783714294434, best validation acc: 0.8672911524772644, corresponding to test acc:                         0.8488888740539551 / 0.8711110949516296
after epoch: 5,now: 2024-07-23 11:57:43.821071,epoch time: 0:02:08.096225,used: 0:11:31.712553,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_11_46_12_seed_1_22795139
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.96191406, 'precision': 0.9638894, 'recall': 0.9623247, 'specificity': 0.9623247, 'f1': 0.9618925, 'auroc': 0.9975126, 'binary_precision': 0.99723184, 'binary_recall': 0.9272844, 'binary_specificity': 0.99736494, 'binary_f1_score': 0.96098703}
confusion matrix:
      0     1
0  1514     4
1   113  1441
---- Validation: 
scalar performance:
{'acc': 0.626854, 'precision': 0.74814516, 'recall': 0.62101895, 'specificity': 0.62101895, 'f1': 0.56909364, 'auroc': 0.90031457, 'binary_precision': 0.9175824, 'binary_recall': 0.26507938, 'binary_specificity': 0.9769585, 'binary_f1_score': 0.41133007}
confusion matrix:
     0    1
0  636   15
1  463  167
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.76, 'precision': 0.824, 'recall': 0.76, 'specificity': 0.76, 'f1': 0.7475325, 'auroc': 0.89592594, 'binary_precision': 0.968, 'binary_recall': 0.5377778, 'binary_specificity': 0.9822222, 'binary_f1_score': 0.69142854}
confusion matrix:
     0    1
0  221    4
1  104  121
early stop counter: 3
val acc:0.6268540024757385, best validation acc: 0.8672911524772644, corresponding to test acc:                         0.8488888740539551 / 0.8711110949516296
after epoch: 6,now: 2024-07-23 12:00:00.432689,epoch time: 0:02:16.611618,used: 0:13:48.324171,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_11_46_12_seed_1_22795139
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.98567706, 'precision': 0.9857099, 'recall': 0.9857849, 'specificity': 0.9857849, 'f1': 0.98567677, 'auroc': 0.9989554, 'binary_precision': 0.9941176, 'binary_recall': 0.9775064, 'binary_specificity': 0.9940633, 'binary_f1_score': 0.98574203}
confusion matrix:
      0     1
0  1507     9
1    35  1521
---- Validation: 
scalar performance:
{'acc': 0.81030446, 'precision': 0.83306456, 'recall': 0.80814135, 'specificity': 0.80814135, 'f1': 0.8062191, 'auroc': 0.90213835, 'binary_precision': 0.91612905, 'binary_recall': 0.6761905, 'binary_specificity': 0.94009215, 'binary_f1_score': 0.77808225}
confusion matrix:
     0    1
0  612   39
1  204  426
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.83555555, 'precision': 0.852987, 'recall': 0.83555555, 'specificity': 0.83555555, 'f1': 0.83349997, 'auroc': 0.9015111, 'binary_precision': 0.93142855, 'binary_recall': 0.72444445, 'binary_specificity': 0.94666666, 'binary_f1_score': 0.815}
confusion matrix:
     0    1
0  213   12
1   62  163
early stop counter: 4
val acc:0.8103044629096985, best validation acc: 0.8672911524772644, corresponding to test acc:                         0.8488888740539551 / 0.8711110949516296
after epoch: 7,now: 2024-07-23 12:02:15.488806,epoch time: 0:02:15.056117,used: 0:16:03.380288,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_11_46_12_seed_1_22795139
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.97558594, 'precision': 0.9760782, 'recall': 0.97540796, 'specificity': 0.97540796, 'f1': 0.9755689, 'auroc': 0.9982958, 'binary_precision': 0.9636819, 'binary_recall': 0.9890745, 'binary_specificity': 0.96174145, 'binary_f1_score': 0.9762131}
confusion matrix:
      0     1
0  1458    58
1    17  1539
---- Validation: 
scalar performance:
{'acc': 0.87431693, 'precision': 0.87429047, 'recall': 0.8742703, 'specificity': 0.8742703, 'f1': 0.87427986, 'auroc': 0.927189, 'binary_precision': 0.872814, 'binary_recall': 0.87142855, 'binary_specificity': 0.87711215, 'binary_f1_score': 0.87212074}
confusion matrix:
     0    1
0  571   80
1   81  549
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.84, 'precision': 0.84132147, 'recall': 0.84000003, 'specificity': 0.84000003, 'f1': 0.839845, 'auroc': 0.9109136, 'binary_precision': 0.8200837, 'binary_recall': 0.8711111, 'binary_specificity': 0.8088889, 'binary_f1_score': 0.8448276}
confusion matrix:
     0    1
0  182   43
1   29  196
better model found
persisted
after epoch: 8,now: 2024-07-23 12:04:28.838504,epoch time: 0:02:13.349698,used: 0:18:16.729986,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_11_46_12_seed_1_22795139
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9860026, 'precision': 0.9860269, 'recall': 0.9860884, 'specificity': 0.9860884, 'f1': 0.9860023, 'auroc': 0.9986278, 'binary_precision': 0.99346834, 'binary_recall': 0.9787645, 'binary_specificity': 0.9934124, 'binary_f1_score': 0.9860616}
confusion matrix:
      0     1
0  1508    10
1    33  1521
---- Validation: 
scalar performance:
{'acc': 0.8306011, 'precision': 0.84712243, 'recall': 0.8288019, 'specificity': 0.8288019, 'f1': 0.8279842, 'auroc': 0.9129715, 'binary_precision': 0.9188641, 'binary_recall': 0.7190476, 'binary_specificity': 0.9385561, 'binary_f1_score': 0.8067675}
confusion matrix:
     0    1
0  611   40
1  177  453
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8244445, 'precision': 0.8466945, 'recall': 0.8244444, 'specificity': 0.8244444, 'f1': 0.82158184, 'auroc': 0.90621233, 'binary_precision': 0.9345238, 'binary_recall': 0.69777775, 'binary_specificity': 0.95111114, 'binary_f1_score': 0.7989822}
confusion matrix:
     0    1
0  214   11
1   68  157
early stop counter: 1
val acc:0.8306010961532593, best validation acc: 0.874316930770874, corresponding to test acc:                         0.8399999737739563 / 0.8711110949516296
after epoch: 9,now: 2024-07-23 12:06:47.513823,epoch time: 0:02:18.675319,used: 0:20:35.405305,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_11_46_12_seed_1_22795139
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.98372394, 'precision': 0.983954, 'recall': 0.9839351, 'specificity': 0.9839351, 'f1': 0.9837239, 'auroc': 0.9989838, 'binary_precision': 0.99867725, 'binary_recall': 0.96919125, 'binary_specificity': 0.998679, 'binary_f1_score': 0.9837133}
confusion matrix:
      0     1
0  1512     2
1    48  1510
---- Validation: 
scalar performance:
{'acc': 0.8251366, 'precision': 0.84818417, 'recall': 0.82301587, 'specificity': 0.82301587, 'f1': 0.8214936, 'auroc': 0.9128593, 'binary_precision': 0.9337607, 'binary_recall': 0.6936508, 'binary_specificity': 0.95238096, 'binary_f1_score': 0.7959927}
confusion matrix:
     0    1
0  620   31
1  193  437
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.84, 'precision': 0.8489327, 'recall': 0.84000003, 'specificity': 0.84000003, 'f1': 0.83896935, 'auroc': 0.90364444, 'binary_precision': 0.9047619, 'binary_recall': 0.76, 'binary_specificity': 0.92, 'binary_f1_score': 0.82608694}
confusion matrix:
     0    1
0  207   18
1   54  171
early stop counter: 2
val acc:0.8251366019248962, best validation acc: 0.874316930770874, corresponding to test acc:                         0.8399999737739563 / 0.8711110949516296
after epoch: 10,now: 2024-07-23 12:09:05.724955,epoch time: 0:02:18.211132,used: 0:22:53.616437,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_11_46_12_seed_1_22795139
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9895833, 'precision': 0.98961234, 'recall': 0.98955756, 'specificity': 0.98955756, 'f1': 0.9895812, 'auroc': 0.99958277, 'binary_precision': 0.9878283, 'binary_recall': 0.99163985, 'binary_specificity': 0.9874753, 'binary_f1_score': 0.9897304}
confusion matrix:
      0     1
0  1498    19
1    13  1542
---- Validation: 
scalar performance:
{'acc': 0.871975, 'precision': 0.87349594, 'recall': 0.8714541, 'specificity': 0.8714541, 'f1': 0.87170285, 'auroc': 0.9170336, 'binary_precision': 0.8935811, 'binary_recall': 0.8396825, 'binary_specificity': 0.9032258, 'binary_f1_score': 0.86579376}
confusion matrix:
     0    1
0  588   63
1  101  529
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8488889, 'precision': 0.8489165, 'recall': 0.8488889, 'specificity': 0.8488889, 'f1': 0.8488859, 'auroc': 0.9108149, 'binary_precision': 0.85201794, 'binary_recall': 0.84444445, 'binary_specificity': 0.85333335, 'binary_f1_score': 0.84821427}
confusion matrix:
     0    1
0  192   33
1   35  190
early stop counter: 3
val acc:0.8719750046730042, best validation acc: 0.874316930770874, corresponding to test acc:                         0.8399999737739563 / 0.8711110949516296
after epoch: 11,now: 2024-07-23 12:11:25.382993,epoch time: 0:02:19.658038,used: 0:25:13.274475,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_11_46_12_seed_1_22795139
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.98079425, 'precision': 0.98099816, 'recall': 0.9809396, 'specificity': 0.9809396, 'f1': 0.9807942, 'auroc': 0.99820685, 'binary_precision': 0.99404764, 'binary_recall': 0.96780425, 'binary_specificity': 0.99407506, 'binary_f1_score': 0.98075044}
confusion matrix:
      0     1
0  1510     9
1    50  1503
---- Validation: 
scalar performance:
{'acc': 0.81889147, 'precision': 0.8438927, 'recall': 0.81666666, 'specificity': 0.81666666, 'f1': 0.8147736, 'auroc': 0.918916, 'binary_precision': 0.9326087, 'binary_recall': 0.68095237, 'binary_specificity': 0.95238096, 'binary_f1_score': 0.7871559}
confusion matrix:
     0    1
0  620   31
1  201  429
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.83111113, 'precision': 0.86439425, 'recall': 0.8311111, 'specificity': 0.8311111, 'f1': 0.8271645, 'auroc': 0.91269624, 'binary_precision': 0.9745223, 'binary_recall': 0.68, 'binary_specificity': 0.9822222, 'binary_f1_score': 0.8010471}
confusion matrix:
     0    1
0  221    4
1   72  153
early stop counter: 4
val acc:0.8188914656639099, best validation acc: 0.874316930770874, corresponding to test acc:                         0.8399999737739563 / 0.8711110949516296
after epoch: 12,now: 2024-07-23 12:13:45.291465,epoch time: 0:02:19.908472,used: 0:27:33.182947,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_11_46_12_seed_1_22795139
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9827474, 'precision': 0.98299193, 'recall': 0.982963, 'specificity': 0.982963, 'f1': 0.9827474, 'auroc': 0.9989712, 'binary_precision': 0.99801457, 'binary_recall': 0.96790755, 'binary_specificity': 0.9980185, 'binary_f1_score': 0.9827305}
confusion matrix:
      0     1
0  1511     3
1    50  1508
---- Validation: 
scalar performance:
{'acc': 0.80640125, 'precision': 0.82226837, 'recall': 0.8045571, 'specificity': 0.8045571, 'f1': 0.80329406, 'auroc': 0.89406776, 'binary_precision': 0.8897959, 'binary_recall': 0.6920635, 'binary_specificity': 0.9170507, 'binary_f1_score': 0.7785714}
confusion matrix:
     0    1
0  597   54
1  194  436
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8288889, 'precision': 0.8352529, 'recall': 0.8288889, 'specificity': 0.8288889, 'f1': 0.828073, 'auroc': 0.90976787, 'binary_precision': 0.8814433, 'binary_recall': 0.76, 'binary_specificity': 0.8977778, 'binary_f1_score': 0.8162291}
confusion matrix:
     0    1
0  202   23
1   54  171
early stop counter: 5
val acc:0.806401252746582, best validation acc: 0.874316930770874, corresponding to test acc:                         0.8399999737739563 / 0.8711110949516296
after epoch: 13,now: 2024-07-23 12:16:05.140678,epoch time: 0:02:19.849213,used: 0:29:53.032160,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_11_46_12_seed_1_22795139
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.992513, 'precision': 0.9925078, 'recall': 0.99251604, 'specificity': 0.99251604, 'f1': 0.9925118, 'auroc': 0.9995409, 'binary_precision': 0.99292606, 'binary_recall': 0.99228793, 'binary_specificity': 0.9927441, 'binary_f1_score': 0.9926069}
confusion matrix:
      0     1
0  1505    11
1    12  1544
---- Validation: 
scalar performance:
{'acc': 0.8360656, 'precision': 0.84291506, 'recall': 0.834895, 'specificity': 0.834895, 'f1': 0.83487, 'auroc': 0.9050984, 'binary_precision': 0.88745385, 'binary_recall': 0.76349205, 'binary_specificity': 0.906298, 'binary_f1_score': 0.8208191}
confusion matrix:
     0    1
0  590   61
1  149  481
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8466667, 'precision': 0.848657, 'recall': 0.8466667, 'specificity': 0.8466667, 'f1': 0.84644747, 'auroc': 0.90467155, 'binary_precision': 0.875, 'binary_recall': 0.8088889, 'binary_specificity': 0.8844444, 'binary_f1_score': 0.8406467}
confusion matrix:
     0    1
0  199   26
1   43  182
early stop counter: 6
val acc:0.8360655903816223, best validation acc: 0.874316930770874, corresponding to test acc:                         0.8399999737739563 / 0.8711110949516296
after epoch: 14,now: 2024-07-23 12:18:30.545734,epoch time: 0:02:25.405056,used: 0:32:18.437216,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_11_46_12_seed_1_22795139
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9863281, 'precision': 0.98652005, 'recall': 0.9864706, 'specificity': 0.9864706, 'f1': 0.98632807, 'auroc': 0.99910724, 'binary_precision': 0.99933904, 'binary_recall': 0.9735995, 'binary_specificity': 0.99934167, 'binary_f1_score': 0.98630136}
confusion matrix:
      0     1
0  1518     1
1    41  1512
---- Validation: 
scalar performance:
{'acc': 0.793911, 'precision': 0.8264805, 'recall': 0.7912954, 'specificity': 0.7912954, 'f1': 0.78758895, 'auroc': 0.9051862, 'binary_precision': 0.9255814, 'binary_recall': 0.63174605, 'binary_specificity': 0.9508448, 'binary_f1_score': 0.7509434}
confusion matrix:
     0    1
0  619   32
1  232  398
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.84444445, 'precision': 0.85946935, 'recall': 0.84444445, 'specificity': 0.84444445, 'f1': 0.8428018, 'auroc': 0.92268646, 'binary_precision': 0.93296087, 'binary_recall': 0.74222225, 'binary_specificity': 0.94666666, 'binary_f1_score': 0.8267327}
confusion matrix:
     0    1
0  213   12
1   58  167
early stop counter: 7
val acc:0.7939109802246094, best validation acc: 0.874316930770874, corresponding to test acc:                         0.8399999737739563 / 0.8711110949516296
after epoch: 15,now: 2024-07-23 12:20:54.511950,epoch time: 0:02:23.966216,used: 0:34:42.403432,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_11_46_12_seed_1_22795139
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9902344, 'precision': 0.99021435, 'recall': 0.9902593, 'specificity': 0.9902593, 'f1': 0.99023306, 'auroc': 0.99959856, 'binary_precision': 0.9922631, 'binary_recall': 0.9884393, 'binary_specificity': 0.9920792, 'binary_f1_score': 0.9903475}
confusion matrix:
      0     1
0  1503    12
1    18  1539
---- Validation: 
scalar performance:
{'acc': 0.8274785, 'precision': 0.83888316, 'recall': 0.82596004, 'specificity': 0.82596004, 'f1': 0.8255118, 'auroc': 0.8973106, 'binary_precision': 0.8970874, 'binary_recall': 0.73333335, 'binary_specificity': 0.9185868, 'binary_f1_score': 0.8069869}
confusion matrix:
     0    1
0  598   53
1  168  462
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8577778, 'precision': 0.8642534, 'recall': 0.8577778, 'specificity': 0.8577778, 'f1': 0.85714287, 'auroc': 0.9287111, 'binary_precision': 0.9128205, 'binary_recall': 0.7911111, 'binary_specificity': 0.92444444, 'binary_f1_score': 0.84761906}
confusion matrix:
     0    1
0  208   17
1   47  178
early stop counter: 8
val acc:0.8274785280227661, best validation acc: 0.874316930770874, corresponding to test acc:                         0.8399999737739563 / 0.8711110949516296
after epoch: 16,now: 2024-07-23 12:23:12.265192,epoch time: 0:02:17.753242,used: 0:37:00.156674,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_11_46_12_seed_1_22795139
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9869792, 'precision': 0.98727775, 'recall': 0.98685634, 'specificity': 0.98685634, 'f1': 0.9869728, 'auroc': 0.9995519, 'binary_precision': 0.97791797, 'binary_recall': 0.99678457, 'binary_specificity': 0.9769282, 'binary_f1_score': 0.9872611}
confusion matrix:
      0     1
0  1482    35
1     5  1550
---- Validation: 
scalar performance:
{'acc': 0.8618267, 'precision': 0.8617927, 'recall': 0.8618791, 'specificity': 0.8618791, 'f1': 0.8618102, 'auroc': 0.9163655, 'binary_precision': 0.855573, 'binary_recall': 0.86507934, 'binary_specificity': 0.85867894, 'binary_f1_score': 0.8602999}
confusion matrix:
     0    1
0  559   92
1   85  545
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.85333335, 'precision': 0.85403264, 'recall': 0.85333335, 'specificity': 0.85333335, 'f1': 0.8532609, 'auroc': 0.92197526, 'binary_precision': 0.83829784, 'binary_recall': 0.8755556, 'binary_specificity': 0.83111113, 'binary_f1_score': 0.8565218}
confusion matrix:
     0    1
0  187   38
1   28  197
early stop counter: 9
val acc:0.8618267178535461, best validation acc: 0.874316930770874, corresponding to test acc:                         0.8399999737739563 / 0.8711110949516296
after epoch: 17,now: 2024-07-23 12:25:29.689895,epoch time: 0:02:17.424703,used: 0:39:17.581377,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_11_46_12_seed_1_22795139
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9869792, 'precision': 0.9869621, 'recall': 0.9870479, 'specificity': 0.9870479, 'f1': 0.9869782, 'auroc': 0.99912703, 'binary_precision': 0.99221283, 'binary_recall': 0.9820167, 'binary_specificity': 0.9920792, 'binary_f1_score': 0.9870884}
confusion matrix:
      0     1
0  1503    12
1    28  1529
---- Validation: 
scalar performance:
{'acc': 0.83372366, 'precision': 0.8358606, 'recall': 0.8330517, 'specificity': 0.8330517, 'f1': 0.8332256, 'auroc': 0.89743984, 'binary_precision': 0.858864, 'binary_recall': 0.7920635, 'binary_specificity': 0.87403995, 'binary_f1_score': 0.82411224}
confusion matrix:
     0    1
0  569   82
1  131  499
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8111111, 'precision': 0.81334555, 'recall': 0.8111111, 'specificity': 0.8111111, 'f1': 0.81077373, 'auroc': 0.8669827, 'binary_precision': 0.83980584, 'binary_recall': 0.7688889, 'binary_specificity': 0.85333335, 'binary_f1_score': 0.8027842}
confusion matrix:
     0    1
0  192   33
1   52  173
early stop counter: 10
val acc:0.8337236642837524, best validation acc: 0.874316930770874, corresponding to test acc:                         0.8399999737739563 / 0.8711110949516296
after epoch: 18,now: 2024-07-23 12:27:48.229966,epoch time: 0:02:18.540071,used: 0:41:36.121448,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_11_46_12_seed_1_22795139
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9863281, 'precision': 0.98644876, 'recall': 0.98647845, 'specificity': 0.98647845, 'f1': 0.9863281, 'auroc': 0.999624, 'binary_precision': 0.9980263, 'binary_recall': 0.9749357, 'binary_specificity': 0.9980211, 'binary_f1_score': 0.9863459}
confusion matrix:
      0     1
0  1513     3
1    39  1517
---- Validation: 
scalar performance:
{'acc': 0.8227947, 'precision': 0.83361775, 'recall': 0.82130057, 'specificity': 0.82130057, 'f1': 0.8208342, 'auroc': 0.8996245, 'binary_precision': 0.8897486, 'binary_recall': 0.73015875, 'binary_specificity': 0.9124424, 'binary_f1_score': 0.80209243}
confusion matrix:
     0    1
0  594   57
1  170  460
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.84, 'precision': 0.84002686, 'recall': 0.84000003, 'specificity': 0.84000003, 'f1': 0.8399968, 'auroc': 0.9021827, 'binary_precision': 0.84304935, 'binary_recall': 0.83555555, 'binary_specificity': 0.84444445, 'binary_f1_score': 0.83928573}
confusion matrix:
     0    1
0  190   35
1   37  188
early stop counter: 11
val acc:0.8227946758270264, best validation acc: 0.874316930770874, corresponding to test acc:                         0.8399999737739563 / 0.8711110949516296
after epoch: 19,now: 2024-07-23 12:30:09.294728,epoch time: 0:02:21.064762,used: 0:43:57.186210,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_11_46_12_seed_1_22795139
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9863281, 'precision': 0.9864198, 'recall': 0.98626965, 'specificity': 0.98626965, 'f1': 0.9863242, 'auroc': 0.998657, 'binary_precision': 0.98215425, 'binary_recall': 0.9909968, 'binary_specificity': 0.9815425, 'binary_f1_score': 0.98655576}
confusion matrix:
      0     1
0  1489    28
1    14  1541
---- Validation: 
scalar performance:
{'acc': 0.83372366, 'precision': 0.8337303, 'recall': 0.83381975, 'specificity': 0.83381975, 'f1': 0.8337135, 'auroc': 0.90032613, 'binary_precision': 0.82527304, 'binary_recall': 0.8396825, 'binary_specificity': 0.827957, 'binary_f1_score': 0.8324154}
confusion matrix:
     0    1
0  539  112
1  101  529
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7866667, 'precision': 0.78943384, 'recall': 0.78666663, 'specificity': 0.78666663, 'f1': 0.7861556, 'auroc': 0.8442272, 'binary_precision': 0.7611336, 'binary_recall': 0.83555555, 'binary_specificity': 0.73777777, 'binary_f1_score': 0.7966101}
confusion matrix:
     0    1
0  166   59
1   37  188
early stop counter: 12
val acc:0.8337236642837524, best validation acc: 0.874316930770874, corresponding to test acc:                         0.8399999737739563 / 0.8711110949516296
after epoch: 20,now: 2024-07-23 12:32:24.844614,epoch time: 0:02:15.549886,used: 0:46:12.736096,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_11_46_12_seed_1_22795139
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9895833, 'precision': 0.9895754, 'recall': 0.9895895, 'specificity': 0.9895895, 'f1': 0.98958206, 'auroc': 0.9995439, 'binary_precision': 0.99033505, 'binary_recall': 0.98906046, 'binary_specificity': 0.99011856, 'binary_f1_score': 0.98969734}
confusion matrix:
      0     1
0  1503    15
1    17  1537
---- Validation: 
scalar performance:
{'acc': 0.8594848, 'precision': 0.873312, 'recall': 0.8579109, 'specificity': 0.8579109, 'f1': 0.8577615, 'auroc': 0.9273913, 'binary_precision': 0.9411765, 'binary_recall': 0.7619048, 'binary_specificity': 0.953917, 'binary_f1_score': 0.84210527}
confusion matrix:
     0    1
0  621   30
1  150  480
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8488889, 'precision': 0.8719282, 'recall': 0.8488889, 'specificity': 0.8488889, 'f1': 0.84651196, 'auroc': 0.9217975, 'binary_precision': 0.964497, 'binary_recall': 0.72444445, 'binary_specificity': 0.97333336, 'binary_f1_score': 0.8274112}
confusion matrix:
     0    1
0  219    6
1   62  163
early stop counter: 13
val acc:0.8594847917556763, best validation acc: 0.874316930770874, corresponding to test acc:                         0.8399999737739563 / 0.8711110949516296
after epoch: 21,now: 2024-07-23 12:34:41.081685,epoch time: 0:02:16.237071,used: 0:48:28.973167,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_11_46_12_seed_1_22795139
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.98372394, 'precision': 0.9838823, 'recall': 0.9838667, 'specificity': 0.9838667, 'f1': 0.9837239, 'auroc': 0.9993142, 'binary_precision': 0.9960422, 'binary_recall': 0.97168595, 'binary_specificity': 0.99604744, 'binary_f1_score': 0.9837133}
confusion matrix:
      0     1
0  1512     6
1    44  1510
---- Validation: 
scalar performance:
{'acc': 0.8563622, 'precision': 0.8724878, 'recall': 0.8546595, 'specificity': 0.8546595, 'f1': 0.8543383, 'auroc': 0.93667865, 'binary_precision': 0.946, 'binary_recall': 0.75079364, 'binary_specificity': 0.95852536, 'binary_f1_score': 0.8371681}
confusion matrix:
     0    1
0  624   27
1  157  473
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.79333335, 'precision': 0.83458006, 'recall': 0.7933333, 'specificity': 0.7933333, 'f1': 0.7867614, 'auroc': 0.9105778, 'binary_precision': 0.9520548, 'binary_recall': 0.61777776, 'binary_specificity': 0.9688889, 'binary_f1_score': 0.74932617}
confusion matrix:
     0    1
0  218    7
1   86  139
early stop counter: 14
val acc:0.8563622236251831, best validation acc: 0.874316930770874, corresponding to test acc:                         0.8399999737739563 / 0.8711110949516296
after epoch: 22,now: 2024-07-23 12:37:00.476086,epoch time: 0:02:19.394401,used: 0:50:48.367568,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_11_46_12_seed_1_22795139
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.9703776, 'precision': 0.97172153, 'recall': 0.9707207, 'specificity': 0.9707207, 'f1': 0.9703681, 'auroc': 0.9995328, 'binary_precision': 1.0, 'binary_recall': 0.9414414, 'binary_specificity': 1.0, 'binary_f1_score': 0.96983755}
confusion matrix:
      0     1
0  1518     0
1    91  1463
---- Validation: 
scalar performance:
{'acc': 0.53629977, 'precision': 0.7483063, 'recall': 0.52859706, 'specificity': 0.52859706, 'f1': 0.39857826, 'auroc': 0.9180802, 'binary_precision': 0.9736842, 'binary_recall': 0.05873016, 'binary_specificity': 0.9984639, 'binary_f1_score': 0.11077845}
confusion matrix:
     0   1
0  650   1
1  593  37
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5644444, 'precision': 0.7511741, 'recall': 0.5644445, 'specificity': 0.5644445, 'f1': 0.46501356, 'auroc': 0.91786176, 'binary_precision': 0.9677419, 'binary_recall': 0.13333334, 'binary_specificity': 0.9955556, 'binary_f1_score': 0.23437499}
confusion matrix:
     0   1
0  224   1
1  195  30
early stop counter: 15
val acc:0.5362997651100159, best validation acc: 0.874316930770874, corresponding to test acc:                         0.8399999737739563 / 0.8711110949516296
after epoch: 23,now: 2024-07-23 12:39:19.760243,epoch time: 0:02:19.284157,used: 0:53:07.651725,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_11_46_12_seed_1_22795139
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9873047, 'precision': 0.9874288, 'recall': 0.98746705, 'specificity': 0.98746705, 'f1': 0.9873046, 'auroc': 0.99975073, 'binary_precision': 0.9993421, 'binary_recall': 0.9755941, 'binary_specificity': 0.99933994, 'binary_f1_score': 0.98732525}
confusion matrix:
      0     1
0  1514     1
1    38  1519
---- Validation: 
scalar performance:
{'acc': 0.66978925, 'precision': 0.77831167, 'recall': 0.664593, 'specificity': 0.664593, 'f1': 0.6300168, 'auroc': 0.91072893, 'binary_precision': 0.9480519, 'binary_recall': 0.34761906, 'binary_specificity': 0.98156685, 'binary_f1_score': 0.5087108}
confusion matrix:
     0    1
0  639   12
1  411  219
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.74, 'precision': 0.8101388, 'recall': 0.74, 'specificity': 0.74, 'f1': 0.7244191, 'auroc': 0.91500247, 'binary_precision': 0.9576271, 'binary_recall': 0.50222224, 'binary_specificity': 0.9777778, 'binary_f1_score': 0.65889215}
confusion matrix:
     0    1
0  220    5
1  112  113
early stop counter: 16
val acc:0.6697892546653748, best validation acc: 0.874316930770874, corresponding to test acc:                         0.8399999737739563 / 0.8711110949516296
after epoch: 24,now: 2024-07-23 12:41:36.350637,epoch time: 0:02:16.590394,used: 0:55:24.242119,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_11_46_12_seed_1_22795139
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.98372394, 'precision': 0.984046, 'recall': 0.98392284, 'specificity': 0.98392284, 'f1': 0.9837237, 'auroc': 0.9998088, 'binary_precision': 1.0, 'binary_recall': 0.9678457, 'binary_specificity': 1.0, 'binary_f1_score': 0.98366016}
confusion matrix:
      0     1
0  1517     0
1    50  1505
---- Validation: 
scalar performance:
{'acc': 0.76112413, 'precision': 0.81359506, 'recall': 0.7577317, 'specificity': 0.7577317, 'f1': 0.74904865, 'auroc': 0.90917206, 'binary_precision': 0.93783784, 'binary_recall': 0.55079365, 'binary_specificity': 0.96466976, 'binary_f1_score': 0.694}
confusion matrix:
     0    1
0  628   23
1  283  347
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.81333333, 'precision': 0.8428321, 'recall': 0.81333333, 'specificity': 0.81333333, 'f1': 0.8092296, 'auroc': 0.91115063, 'binary_precision': 0.9433962, 'binary_recall': 0.6666667, 'binary_specificity': 0.96, 'binary_f1_score': 0.78125}
confusion matrix:
     0    1
0  216    9
1   75  150
early stop counter: 17
val acc:0.7611241340637207, best validation acc: 0.874316930770874, corresponding to test acc:                         0.8399999737739563 / 0.8711110949516296
after epoch: 25,now: 2024-07-23 12:43:53.570622,epoch time: 0:02:17.219985,used: 0:57:41.462104,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_11_46_12_seed_1_22795139
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9902344, 'precision': 0.99024963, 'recall': 0.9903394, 'specificity': 0.9903394, 'f1': 0.990234, 'auroc': 0.9998351, 'binary_precision': 0.99804306, 'binary_recall': 0.982659, 'binary_specificity': 0.9980198, 'binary_f1_score': 0.99029124}
confusion matrix:
      0     1
0  1512     3
1    27  1530
---- Validation: 
scalar performance:
{'acc': 0.79703355, 'precision': 0.83222103, 'recall': 0.79434204, 'specificity': 0.79434204, 'f1': 0.79045343, 'auroc': 0.91285443, 'binary_precision': 0.9363208, 'binary_recall': 0.6301587, 'binary_specificity': 0.95852536, 'binary_f1_score': 0.75332075}
confusion matrix:
     0    1
0  624   27
1  233  397
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8288889, 'precision': 0.85317326, 'recall': 0.8288889, 'specificity': 0.8288889, 'f1': 0.825896, 'auroc': 0.9046518, 'binary_precision': 0.94578314, 'binary_recall': 0.69777775, 'binary_specificity': 0.96, 'binary_f1_score': 0.80306906}
confusion matrix:
     0    1
0  216    9
1   68  157
early stop counter: 18
val acc:0.7970335483551025, best validation acc: 0.874316930770874, corresponding to test acc:                         0.8399999737739563 / 0.8711110949516296
after epoch: 26,now: 2024-07-23 12:46:04.713362,epoch time: 0:02:11.142740,used: 0:59:52.604844,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_11_46_12_seed_1_22795139
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.9892578, 'precision': 0.9893489, 'recall': 0.9893682, 'specificity': 0.9893682, 'f1': 0.9892578, 'auroc': 0.9998144, 'binary_precision': 0.999343, 'binary_recall': 0.97939473, 'binary_specificity': 0.99934167, 'binary_f1_score': 0.9892683}
confusion matrix:
      0     1
0  1518     1
1    32  1521
---- Validation: 
scalar performance:
{'acc': 0.63856363, 'precision': 0.76622367, 'recall': 0.6327957, 'specificity': 0.6327957, 'f1': 0.5839815, 'auroc': 0.91484404, 'binary_precision': 0.9465241, 'binary_recall': 0.2809524, 'binary_specificity': 0.984639, 'binary_f1_score': 0.43329257}
confusion matrix:
     0    1
0  641   10
1  453  177
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.64444447, 'precision': 0.77174926, 'recall': 0.64444447, 'specificity': 0.64444447, 'f1': 0.59727937, 'auroc': 0.9280593, 'binary_precision': 0.9577465, 'binary_recall': 0.30222222, 'binary_specificity': 0.9866667, 'binary_f1_score': 0.45945945}
confusion matrix:
     0   1
0  222   3
1  157  68
early stop counter: 19
val acc:0.6385636329650879, best validation acc: 0.874316930770874, corresponding to test acc:                         0.8399999737739563 / 0.8711110949516296
after epoch: 27,now: 2024-07-23 12:48:20.424697,epoch time: 0:02:15.711335,used: 1:02:08.316179,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_11_46_12_seed_1_22795139
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.99121094, 'precision': 0.99123204, 'recall': 0.9913206, 'specificity': 0.9913206, 'f1': 0.9912107, 'auroc': 0.9998025, 'binary_precision': 0.99934727, 'binary_recall': 0.9833012, 'binary_specificity': 0.99933994, 'binary_f1_score': 0.99125934}
confusion matrix:
      0     1
0  1514     1
1    26  1531
---- Validation: 
scalar performance:
{'acc': 0.7533177, 'precision': 0.8198834, 'recall': 0.74953914, 'specificity': 0.74953914, 'f1': 0.7378672, 'auroc': 0.92031306, 'binary_precision': 0.9617647, 'binary_recall': 0.5190476, 'binary_specificity': 0.9800307, 'binary_f1_score': 0.6742268}
confusion matrix:
     0    1
0  638   13
1  303  327
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7822222, 'precision': 0.8331895, 'recall': 0.7822222, 'specificity': 0.7822222, 'f1': 0.7735628, 'auroc': 0.9235951, 'binary_precision': 0.96350366, 'binary_recall': 0.58666664, 'binary_specificity': 0.9777778, 'binary_f1_score': 0.7292818}
confusion matrix:
     0    1
0  220    5
1   93  132
early stop counter: 20
val acc:0.7533177137374878, best validation acc: 0.874316930770874, corresponding to test acc:                         0.8399999737739563 / 0.8711110949516296
after epoch: 28,now: 2024-07-23 12:50:37.027185,epoch time: 0:02:16.602488,used: 1:04:24.918667,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_11_46_12_seed_1_22795139
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.99348956, 'precision': 0.9935208, 'recall': 0.99346304, 'specificity': 0.99346304, 'f1': 0.9934882, 'auroc': 0.9998491, 'binary_precision': 0.99167734, 'binary_recall': 0.9955013, 'binary_specificity': 0.9914248, 'binary_f1_score': 0.99358565}
confusion matrix:
      0     1
0  1503    13
1     7  1549
---- Validation: 
scalar performance:
{'acc': 0.85323966, 'precision': 0.86502427, 'recall': 0.8517665, 'specificity': 0.8517665, 'f1': 0.85164034, 'auroc': 0.92194664, 'binary_precision': 0.9266409, 'binary_recall': 0.7619048, 'binary_specificity': 0.9416283, 'binary_f1_score': 0.8362369}
confusion matrix:
     0    1
0  613   38
1  150  480
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.82666665, 'precision': 0.8499185, 'recall': 0.82666665, 'specificity': 0.82666665, 'f1': 0.8237385, 'auroc': 0.9191506, 'binary_precision': 0.94011974, 'binary_recall': 0.69777775, 'binary_specificity': 0.95555556, 'binary_f1_score': 0.8010204}
confusion matrix:
     0    1
0  215   10
1   68  157
early stop counter: 21
val acc:0.8532396554946899, best validation acc: 0.874316930770874, corresponding to test acc:                         0.8399999737739563 / 0.8711110949516296
after epoch: 29,now: 2024-07-23 12:52:58.371232,epoch time: 0:02:21.344047,used: 1:06:46.262714,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_11_46_12_seed_1_22795139
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.9921875, 'precision': 0.9922161, 'recall': 0.99216354, 'specificity': 0.99216354, 'f1': 0.99218607, 'auroc': 0.99980164, 'binary_precision': 0.99038464, 'binary_recall': 0.9942085, 'binary_specificity': 0.99011856, 'binary_f1_score': 0.9922929}
confusion matrix:
      0     1
0  1503    15
1     9  1545
---- Validation: 
scalar performance:
{'acc': 0.8384075, 'precision': 0.8383579, 'recall': 0.83840245, 'specificity': 0.83840245, 'f1': 0.83837557, 'auroc': 0.89809084, 'binary_precision': 0.8341232, 'binary_recall': 0.83809525, 'binary_specificity': 0.83870965, 'binary_f1_score': 0.8361045}
confusion matrix:
     0    1
0  546  105
1  102  528
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7888889, 'precision': 0.7888946, 'recall': 0.78888893, 'specificity': 0.78888893, 'f1': 0.7888878, 'auroc': 0.86739755, 'binary_precision': 0.7876106, 'binary_recall': 0.7911111, 'binary_specificity': 0.7866667, 'binary_f1_score': 0.7893569}
confusion matrix:
     0    1
0  177   48
1   47  178
early stop counter: 22
val acc:0.8384075164794922, best validation acc: 0.874316930770874, corresponding to test acc:                         0.8399999737739563 / 0.8711110949516296
after epoch: 30,now: 2024-07-23 12:55:17.214595,epoch time: 0:02:18.843363,used: 1:09:05.106077,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_11_46_12_seed_1_22795139
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 1:09:05.106077 at 2024-07-23 12:55:17.214595
persisted model performance metric: 

scalar performance:
{'acc': 0.84, 'precision': 0.84132147, 'recall': 0.84000003, 'specificity': 0.84000003, 'f1': 0.839845, 'auroc': 0.9109136, 'binary_precision': 0.8200837, 'binary_recall': 0.8711111, 'binary_specificity': 0.8088889, 'binary_f1_score': 0.8448276}
confusion matrix:
     0    1
0  182   43
1   29  196
oracle model performance metric: 

scalar performance:
{'acc': 0.8711111, 'precision': 0.8797833, 'recall': 0.8711111, 'specificity': 0.8711111, 'f1': 0.8703711, 'auroc': 0.92724943, 'binary_precision': 0.9371728, 'binary_recall': 0.79555553, 'binary_specificity': 0.94666666, 'binary_f1_score': 0.8605769}
confusion matrix:
     0    1
0  213   12
1   46  179
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_dial_lr1e5_bs32__45_nofreeze_2024-07-23_10-43-50/rule_results/5.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_dial_lr1e5_bs32__45_nofreeze_2024-07-23_10-43-50/confusion_matrix/5.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 453153 KiB |  26075 MiB | 145141 GiB | 145141 GiB |
|       from large pool | 412597 KiB |  26030 MiB | 144235 GiB | 144234 GiB |
|       from small pool |  40556 KiB |     60 MiB |    906 GiB |    906 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 453153 KiB |  26075 MiB | 145141 GiB | 145141 GiB |
|       from large pool | 412597 KiB |  26030 MiB | 144235 GiB | 144234 GiB |
|       from small pool |  40556 KiB |     60 MiB |    906 GiB |    906 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 447481 KiB |  26071 MiB | 145116 GiB | 145115 GiB |
|       from large pool | 407075 KiB |  26026 MiB | 144210 GiB | 144210 GiB |
|       from small pool |  40406 KiB |     60 MiB |    905 GiB |    905 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  27768 MiB |  27768 MiB |  54304 MiB |  26536 MiB |
|       from large pool |  27696 MiB |  27696 MiB |  54218 MiB |  26522 MiB |
|       from small pool |     72 MiB |     72 MiB |     86 MiB |     14 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 738782 KiB |   1678 MiB |  64539 GiB |  64538 GiB |
|       from large pool | 721995 KiB |   1668 MiB |  63626 GiB |  63625 GiB |
|       from small pool |  16787 KiB |     31 MiB |    912 GiB |    912 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    1226    |    2570    |   13123 K  |   13122 K  |
|       from large pool |     187    |    1413    |    6645 K  |    6645 K  |
|       from small pool |    1039    |    1335    |    6477 K  |    6476 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    1226    |    2570    |   13123 K  |   13122 K  |
|       from large pool |     187    |    1413    |    6645 K  |    6645 K  |
|       from small pool |    1039    |    1335    |    6477 K  |    6476 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     835    |     835    |    1603    |     768    |
|       from large pool |     799    |     800    |    1560    |     761    |
|       from small pool |      36    |      36    |      43    |       7    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     106    |     850    |    9561 K  |    9561 K  |
|       from large pool |      40    |     801    |    5873 K  |    5873 K  |
|       from small pool |      66    |     146    |    3687 K  |    3687 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  26075 MiB | 145141 GiB | 145141 GiB |
|       from large pool |  16640 KiB |  26030 MiB | 144235 GiB | 144235 GiB |
|       from small pool |      0 KiB |     60 MiB |    906 GiB |    906 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  26075 MiB | 145141 GiB | 145141 GiB |
|       from large pool |  16640 KiB |  26030 MiB | 144235 GiB | 144235 GiB |
|       from small pool |      0 KiB |     60 MiB |    906 GiB |    906 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  26071 MiB | 145116 GiB | 145116 GiB |
|       from large pool |  16640 KiB |  26026 MiB | 144210 GiB | 144210 GiB |
|       from small pool |      0 KiB |     60 MiB |    905 GiB |    905 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1164 MiB |  27768 MiB |  54304 MiB |  53140 MiB |
|       from large pool |   1108 MiB |  27696 MiB |  54218 MiB |  53110 MiB |
|       from small pool |     56 MiB |     72 MiB |     86 MiB |     30 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |   3840 KiB |   1678 MiB |  64539 GiB |  64539 GiB |
|       from large pool |   3840 KiB |   1668 MiB |  63626 GiB |  63626 GiB |
|       from small pool |      0 KiB |     33 MiB |    912 GiB |    912 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    2570    |   13123 K  |   13123 K  |
|       from large pool |       2    |    1413    |    6645 K  |    6645 K  |
|       from small pool |       0    |    1335    |    6477 K  |    6477 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    2570    |   13123 K  |   13123 K  |
|       from large pool |       2    |    1413    |    6645 K  |    6645 K  |
|       from small pool |       0    |    1335    |    6477 K  |    6477 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      69    |     835    |    1603    |    1534    |
|       from large pool |      41    |     800    |    1560    |    1519    |
|       from small pool |      28    |      36    |      43    |      15    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       1    |     850    |    9561 K  |    9561 K  |
|       from large pool |       1    |     801    |    5873 K  |    5873 K  |
|       from small pool |       0    |     146    |    3687 K  |    3687 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  26075 MiB | 145141 GiB | 145141 GiB |
|       from large pool |  16640 KiB |  26030 MiB | 144235 GiB | 144235 GiB |
|       from small pool |      0 KiB |     60 MiB |    906 GiB |    906 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  26075 MiB | 145141 GiB | 145141 GiB |
|       from large pool |  16640 KiB |  26030 MiB | 144235 GiB | 144235 GiB |
|       from small pool |      0 KiB |     60 MiB |    906 GiB |    906 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  26071 MiB | 145116 GiB | 145116 GiB |
|       from large pool |  16640 KiB |  26026 MiB | 144210 GiB | 144210 GiB |
|       from small pool |      0 KiB |     60 MiB |    905 GiB |    905 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1164 MiB |  27768 MiB |  54304 MiB |  53140 MiB |
|       from large pool |   1108 MiB |  27696 MiB |  54218 MiB |  53110 MiB |
|       from small pool |     56 MiB |     72 MiB |     86 MiB |     30 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |   3840 KiB |   1678 MiB |  64539 GiB |  64539 GiB |
|       from large pool |   3840 KiB |   1668 MiB |  63626 GiB |  63626 GiB |
|       from small pool |      0 KiB |     33 MiB |    912 GiB |    912 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    2570    |   13123 K  |   13123 K  |
|       from large pool |       2    |    1413    |    6645 K  |    6645 K  |
|       from small pool |       0    |    1335    |    6477 K  |    6477 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    2570    |   13123 K  |   13123 K  |
|       from large pool |       2    |    1413    |    6645 K  |    6645 K  |
|       from small pool |       0    |    1335    |    6477 K  |    6477 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      69    |     835    |    1603    |    1534    |
|       from large pool |      41    |     800    |    1560    |    1519    |
|       from small pool |      28    |      36    |      43    |      15    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       1    |     850    |    9561 K  |    9561 K  |
|       from large pool |       1    |     801    |    5873 K  |    5873 K  |
|       from small pool |       0    |     146    |    3687 K  |    3687 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'888c1ef2'
model name: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_12_58_01_seed_2_22795139

 Experiment start at: 2024-07-23 12:58:01.381059
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
before training, model accuracy: 0.41203704476356506
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9144737, 'precision': 0.92419493, 'recall': 0.9151815, 'specificity': 0.9151815, 'f1': 0.91407144, 'auroc': 0.98097265, 'binary_precision': 0.990755, 'binary_recall': 0.83833116, 'binary_specificity': 0.9920319, 'binary_f1_score': 0.9081921}
confusion matrix:
      0     1
0  1494    12
1   248  1286
---- Validation: 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
scalar performance:
{'acc': 0.76447576, 'precision': 0.79097646, 'recall': 0.7603301, 'specificity': 0.7603301, 'f1': 0.756942, 'auroc': 0.87207067, 'binary_precision': 0.8723898, 'binary_recall': 0.6045016, 'binary_specificity': 0.91615856, 'binary_f1_score': 0.7141501}
confusion matrix:
     0    1
0  601   55
1  246  376
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8171296, 'precision': 0.8214356, 'recall': 0.8171296, 'specificity': 0.8171296, 'f1': 0.8165152, 'auroc': 0.8956404, 'binary_precision': 0.85863876, 'binary_recall': 0.7592593, 'binary_specificity': 0.875, 'binary_f1_score': 0.8058968}
confusion matrix:
     0    1
0  189   27
1   52  164
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-23 13:00:30.902525,epoch time: 0:02:29.521466,used: 0:02:29.521466,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_12_58_01_seed_2_22795139
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.94736844, 'precision': 0.94743365, 'recall': 0.94732517, 'specificity': 0.94732517, 'f1': 0.9473593, 'auroc': 0.98846257, 'binary_precision': 0.9437621, 'binary_recall': 0.95238096, 'binary_specificity': 0.9422694, 'binary_f1_score': 0.9480519}
confusion matrix:
      0     1
0  1420    87
1    73  1460
---- Validation: 
scalar performance:
{'acc': 0.79264474, 'precision': 0.80047894, 'recall': 0.79472685, 'specificity': 0.79472685, 'f1': 0.79196596, 'auroc': 0.8902341, 'binary_precision': 0.74485594, 'binary_recall': 0.87299037, 'binary_specificity': 0.7164634, 'binary_f1_score': 0.803849}
confusion matrix:
     0    1
0  470  186
1   79  543
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7777778, 'precision': 0.81037456, 'recall': 0.7777778, 'specificity': 0.7777778, 'f1': 0.77178574, 'auroc': 0.9154021, 'binary_precision': 0.7097902, 'binary_recall': 0.9398148, 'binary_specificity': 0.6157407, 'binary_f1_score': 0.80876493}
confusion matrix:
     0    1
0  133   83
1   13  203
better model found
persisted
after epoch: 2,now: 2024-07-23 13:02:44.375806,epoch time: 0:02:13.473281,used: 0:04:42.994747,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_12_58_01_seed_2_22795139
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9697368, 'precision': 0.96975684, 'recall': 0.96971774, 'specificity': 0.96971774, 'f1': 0.9697335, 'auroc': 0.9943118, 'binary_precision': 0.96816117, 'binary_recall': 0.9719504, 'binary_specificity': 0.9674851, 'binary_f1_score': 0.97005206}
confusion matrix:
      0     1
0  1458    49
1    43  1490
---- Validation: 
scalar performance:
{'acc': 0.7738654, 'precision': 0.782234, 'recall': 0.77605927, 'specificity': 0.77605927, 'f1': 0.77299803, 'auroc': 0.87320113, 'binary_precision': 0.7265306, 'binary_recall': 0.8585209, 'binary_specificity': 0.69359756, 'binary_f1_score': 0.7870302}
confusion matrix:
     0    1
0  455  201
1   88  534
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7708333, 'precision': 0.80575657, 'recall': 0.7708334, 'specificity': 0.7708334, 'f1': 0.7640972, 'auroc': 0.91883147, 'binary_precision': 0.70242214, 'binary_recall': 0.9398148, 'binary_specificity': 0.6018519, 'binary_f1_score': 0.8039604}
confusion matrix:
     0    1
0  130   86
1   13  203
early stop counter: 1
val acc:0.7738654017448425, best validation acc: 0.792644739151001, corresponding to test acc:                         0.7777777910232544 / 0.8171296119689941
after epoch: 3,now: 2024-07-23 13:04:57.583335,epoch time: 0:02:13.207529,used: 0:06:56.202276,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_12_58_01_seed_2_22795139
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9792763, 'precision': 0.9792744, 'recall': 0.9792949, 'specificity': 0.9792949, 'f1': 0.97927606, 'auroc': 0.99795616, 'binary_precision': 0.98224854, 'binary_recall': 0.9764706, 'binary_specificity': 0.9821192, 'binary_f1_score': 0.9793511}
confusion matrix:
      0     1
0  1483    27
1    36  1494
---- Validation: 
scalar performance:
{'acc': 0.80438185, 'precision': 0.80427265, 'recall': 0.8044516, 'specificity': 0.8044516, 'f1': 0.8043128, 'auroc': 0.87951434, 'binary_precision': 0.7943038, 'binary_recall': 0.80707395, 'binary_specificity': 0.8018293, 'binary_f1_score': 0.80063796}
confusion matrix:
     0    1
0  526  130
1  120  502
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7939815, 'precision': 0.8099311, 'recall': 0.7939815, 'specificity': 0.7939815, 'f1': 0.7912964, 'auroc': 0.88792443, 'binary_precision': 0.73962265, 'binary_recall': 0.9074074, 'binary_specificity': 0.6805556, 'binary_f1_score': 0.81496876}
confusion matrix:
     0    1
0  147   69
1   20  196
better model found
persisted
after epoch: 4,now: 2024-07-23 13:07:09.062809,epoch time: 0:02:11.479474,used: 0:09:07.681750,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_12_58_01_seed_2_22795139
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.97467107, 'precision': 0.97519124, 'recall': 0.97455263, 'specificity': 0.97455263, 'f1': 0.974658, 'auroc': 0.99848026, 'binary_precision': 0.96131897, 'binary_recall': 0.98955613, 'binary_specificity': 0.95954907, 'binary_f1_score': 0.97523326}
confusion matrix:
      0     1
0  1447    61
1    16  1516
---- Validation: 
scalar performance:
{'acc': 0.81220657, 'precision': 0.8186239, 'recall': 0.8102404, 'specificity': 0.8102404, 'f1': 0.81047946, 'auroc': 0.8878789, 'binary_precision': 0.8576779, 'binary_recall': 0.7363344, 'binary_specificity': 0.88414633, 'binary_f1_score': 0.79238755}
confusion matrix:
     0    1
0  580   76
1  164  458
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8148148, 'precision': 0.8194432, 'recall': 0.8148148, 'specificity': 0.8148148, 'f1': 0.81414163, 'auroc': 0.9192387, 'binary_precision': 0.78099173, 'binary_recall': 0.875, 'binary_specificity': 0.7546296, 'binary_f1_score': 0.8253275}
confusion matrix:
     0    1
0  163   53
1   27  189
better model found
persisted
after epoch: 5,now: 2024-07-23 13:09:26.767831,epoch time: 0:02:17.705022,used: 0:11:25.386772,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_12_58_01_seed_2_22795139
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.98125, 'precision': 0.98137593, 'recall': 0.9813553, 'specificity': 0.9813553, 'f1': 0.98125, 'auroc': 0.9980586, 'binary_precision': 0.99201065, 'binary_recall': 0.97068405, 'binary_specificity': 0.99202657, 'binary_f1_score': 0.9812315}
confusion matrix:
      0     1
0  1493    12
1    45  1490
---- Validation: 
scalar performance:
{'acc': 0.7723005, 'precision': 0.8080816, 'recall': 0.7676604, 'specificity': 0.7676604, 'f1': 0.7633157, 'auroc': 0.8930501, 'binary_precision': 0.9066339, 'binary_recall': 0.5932476, 'binary_specificity': 0.94207317, 'binary_f1_score': 0.7172012}
confusion matrix:
     0    1
0  618   38
1  253  369
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7708333, 'precision': 0.77996016, 'recall': 0.7708334, 'specificity': 0.7708334, 'f1': 0.7689503, 'auroc': 0.8648191, 'binary_precision': 0.8305085, 'binary_recall': 0.6805556, 'binary_specificity': 0.8611111, 'binary_f1_score': 0.74809164}
confusion matrix:
     0    1
0  186   30
1   69  147
early stop counter: 1
val acc:0.7723004817962646, best validation acc: 0.8122065663337708, corresponding to test acc:                         0.8148148059844971 / 0.8171296119689941
after epoch: 6,now: 2024-07-23 13:11:39.713635,epoch time: 0:02:12.945804,used: 0:13:38.332576,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_12_58_01_seed_2_22795139
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9819079, 'precision': 0.9823487, 'recall': 0.9818094, 'specificity': 0.9818094, 'f1': 0.9819001, 'auroc': 0.999323, 'binary_precision': 0.9694657, 'binary_recall': 0.99542785, 'binary_specificity': 0.96819085, 'binary_f1_score': 0.9822752}
confusion matrix:
      0     1
0  1461    48
1     7  1524
---- Validation: 
scalar performance:
{'acc': 0.82159626, 'precision': 0.82151186, 'recall': 0.8217199, 'specificity': 0.8217199, 'f1': 0.82154334, 'auroc': 0.89156246, 'binary_precision': 0.81072557, 'binary_recall': 0.82636654, 'binary_specificity': 0.81707317, 'binary_f1_score': 0.8184714}
confusion matrix:
     0    1
0  536  120
1  108  514
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7523148, 'precision': 0.7698082, 'recall': 0.7523148, 'specificity': 0.7523148, 'f1': 0.7482339, 'auroc': 0.89000344, 'binary_precision': 0.701107, 'binary_recall': 0.8796296, 'binary_specificity': 0.625, 'binary_f1_score': 0.78028744}
confusion matrix:
     0    1
0  135   81
1   26  190
better model found
persisted
after epoch: 7,now: 2024-07-23 13:13:58.803109,epoch time: 0:02:19.089474,used: 0:15:57.422050,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_12_58_01_seed_2_22795139
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9769737, 'precision': 0.97771686, 'recall': 0.97714365, 'specificity': 0.97714365, 'f1': 0.97696924, 'auroc': 0.99876076, 'binary_precision': 0.99863577, 'binary_recall': 0.95561355, 'binary_specificity': 0.99867374, 'binary_f1_score': 0.9766511}
confusion matrix:
      0     1
0  1506     2
1    68  1464
---- Validation: 
scalar performance:
{'acc': 0.63380283, 'precision': 0.7590194, 'recall': 0.62429416, 'specificity': 0.62429416, 'f1': 0.5742426, 'auroc': 0.8462081, 'binary_precision': 0.9325843, 'binary_recall': 0.26688102, 'binary_specificity': 0.98170733, 'binary_f1_score': 0.415}
confusion matrix:
     0    1
0  644   12
1  456  166
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8171296, 'precision': 0.8408667, 'recall': 0.8171296, 'specificity': 0.8171296, 'f1': 0.8138896, 'auroc': 0.91184413, 'binary_precision': 0.9308176, 'binary_recall': 0.6851852, 'binary_specificity': 0.9490741, 'binary_f1_score': 0.78933334}
confusion matrix:
     0    1
0  205   11
1   68  148
early stop counter: 1
val acc:0.6338028311729431, best validation acc: 0.8215962648391724, corresponding to test acc:                         0.7523148059844971 / 0.8171296119689941
after epoch: 8,now: 2024-07-23 13:16:10.548417,epoch time: 0:02:11.745308,used: 0:18:09.167358,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_12_58_01_seed_2_22795139
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9848684, 'precision': 0.98507, 'recall': 0.98497427, 'specificity': 0.98497427, 'f1': 0.9848682, 'auroc': 0.9987477, 'binary_precision': 0.9973244, 'binary_recall': 0.9726027, 'binary_specificity': 0.99734575, 'binary_f1_score': 0.9848085}
confusion matrix:
      0     1
0  1503     4
1    42  1491
---- Validation: 
scalar performance:
{'acc': 0.58685446, 'precision': 0.7410337, 'recall': 0.575896, 'specificity': 0.575896, 'f1': 0.49460745, 'auroc': 0.7939273, 'binary_precision': 0.92727274, 'binary_recall': 0.16398714, 'binary_specificity': 0.9878049, 'binary_f1_score': 0.27868855}
confusion matrix:
     0    1
0  648    8
1  520  102
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7222222, 'precision': 0.79271597, 'recall': 0.7222222, 'specificity': 0.7222222, 'f1': 0.70442677, 'auroc': 0.8706919, 'binary_precision': 0.93636364, 'binary_recall': 0.47685185, 'binary_specificity': 0.9675926, 'binary_f1_score': 0.63190186}
confusion matrix:
     0    1
0  209    7
1  113  103
early stop counter: 2
val acc:0.5868544578552246, best validation acc: 0.8215962648391724, corresponding to test acc:                         0.7523148059844971 / 0.8171296119689941
after epoch: 9,now: 2024-07-23 13:18:27.210155,epoch time: 0:02:16.661738,used: 0:20:25.829096,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_12_58_01_seed_2_22795139
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9707237, 'precision': 0.9714141, 'recall': 0.9706397, 'specificity': 0.9706397, 'f1': 0.9707086, 'auroc': 0.99764025, 'binary_precision': 0.954488, 'binary_recall': 0.98886704, 'binary_specificity': 0.9524124, 'binary_f1_score': 0.9713734}
confusion matrix:
      0     1
0  1441    72
1    17  1510
---- Validation: 
scalar performance:
{'acc': 0.69327074, 'precision': 0.72675216, 'recall': 0.6878872, 'specificity': 0.6878872, 'f1': 0.6775719, 'auroc': 0.8144704, 'binary_precision': 0.80748665, 'binary_recall': 0.48553056, 'binary_specificity': 0.8902439, 'binary_f1_score': 0.60642576}
confusion matrix:
     0    1
0  584   72
1  320  302
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7430556, 'precision': 0.7475172, 'recall': 0.7430556, 'specificity': 0.7430556, 'f1': 0.7418924, 'auroc': 0.8516375, 'binary_precision': 0.71428573, 'binary_recall': 0.8101852, 'binary_specificity': 0.6759259, 'binary_f1_score': 0.75921905}
confusion matrix:
     0    1
0  146   70
1   41  175
early stop counter: 3
val acc:0.693270742893219, best validation acc: 0.8215962648391724, corresponding to test acc:                         0.7523148059844971 / 0.8171296119689941
after epoch: 10,now: 2024-07-23 13:20:49.854726,epoch time: 0:02:22.644571,used: 0:22:48.473667,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_12_58_01_seed_2_22795139
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9618421, 'precision': 0.9639386, 'recall': 0.961548, 'specificity': 0.961548, 'f1': 0.9617785, 'auroc': 0.99791443, 'binary_precision': 0.9349693, 'binary_recall': 0.9934811, 'binary_specificity': 0.9296149, 'binary_f1_score': 0.96333754}
confusion matrix:
      0     1
0  1400   106
1    10  1524
---- Validation: 
scalar performance:
{'acc': 0.86228484, 'precision': 0.8624276, 'recall': 0.8619373, 'specificity': 0.8619373, 'f1': 0.8621062, 'auroc': 0.9154184, 'binary_precision': 0.86557376, 'binary_recall': 0.84887457, 'binary_specificity': 0.875, 'binary_f1_score': 0.85714287}
confusion matrix:
     0    1
0  574   82
1   94  528
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7662037, 'precision': 0.77425086, 'recall': 0.76620376, 'specificity': 0.76620376, 'f1': 0.764476, 'auroc': 0.87789357, 'binary_precision': 0.72727275, 'binary_recall': 0.8518519, 'binary_specificity': 0.6805556, 'binary_f1_score': 0.7846482}
confusion matrix:
     0    1
0  147   69
1   32  184
better model found
persisted
after epoch: 11,now: 2024-07-23 13:23:09.080835,epoch time: 0:02:19.226109,used: 0:25:07.699776,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_12_58_01_seed_2_22795139
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.98651314, 'precision': 0.98661816, 'recall': 0.98658764, 'specificity': 0.98658764, 'f1': 0.98651314, 'auroc': 0.99888885, 'binary_precision': 0.996008, 'binary_recall': 0.9771541, 'binary_specificity': 0.9960212, 'binary_f1_score': 0.98649096}
confusion matrix:
      0     1
0  1502     6
1    35  1497
---- Validation: 
scalar performance:
{'acc': 0.6071988, 'precision': 0.76430583, 'recall': 0.59667134, 'specificity': 0.59667134, 'f1': 0.52708817, 'auroc': 0.89044243, 'binary_precision': 0.96153843, 'binary_recall': 0.20096463, 'binary_specificity': 0.99237806, 'binary_f1_score': 0.33244684}
confusion matrix:
     0    1
0  651    5
1  497  125
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6388889, 'precision': 0.79032254, 'recall': 0.6388889, 'specificity': 0.6388889, 'f1': 0.58473825, 'auroc': 0.881773, 'binary_precision': 1.0, 'binary_recall': 0.2777778, 'binary_specificity': 1.0, 'binary_f1_score': 0.43478262}
confusion matrix:
     0   1
0  216   0
1  156  60
early stop counter: 1
val acc:0.6071987748146057, best validation acc: 0.8622848391532898, corresponding to test acc:                         0.7662037014961243 / 0.8171296119689941
after epoch: 12,now: 2024-07-23 13:25:23.036404,epoch time: 0:02:13.955569,used: 0:27:21.655345,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_12_58_01_seed_2_22795139
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9381579, 'precision': 0.9448161, 'recall': 0.9376072, 'specificity': 0.9376072, 'f1': 0.93786705, 'auroc': 0.99877846, 'binary_precision': 0.89264876, 'binary_recall': 0.9973924, 'binary_specificity': 0.87782204, 'binary_f1_score': 0.9421182}
confusion matrix:
      0     1
0  1322   184
1     4  1530
---- Validation: 
scalar performance:
{'acc': 0.7754304, 'precision': 0.79740727, 'recall': 0.7789585, 'specificity': 0.7789585, 'f1': 0.772583, 'auroc': 0.90073085, 'binary_precision': 0.70963705, 'binary_recall': 0.91157556, 'binary_specificity': 0.64634144, 'binary_f1_score': 0.79802954}
confusion matrix:
     0    1
0  424  232
1   55  567
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6712963, 'precision': 0.74776787, 'recall': 0.6712963, 'specificity': 0.6712963, 'f1': 0.6438127, 'auroc': 0.89116085, 'binary_precision': 0.61011904, 'binary_recall': 0.9490741, 'binary_specificity': 0.3935185, 'binary_f1_score': 0.7427536}
confusion matrix:
    0    1
0  85  131
1  11  205
early stop counter: 2
val acc:0.7754303812980652, best validation acc: 0.8622848391532898, corresponding to test acc:                         0.7662037014961243 / 0.8171296119689941
after epoch: 13,now: 2024-07-23 13:27:33.257324,epoch time: 0:02:10.220920,used: 0:29:31.876265,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_12_58_01_seed_2_22795139
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9779605, 'precision': 0.9787841, 'recall': 0.9780759, 'specificity': 0.9780759, 'f1': 0.9779543, 'auroc': 0.99857116, 'binary_precision': 1.0, 'binary_recall': 0.95615184, 'binary_specificity': 1.0, 'binary_f1_score': 0.9775845}
confusion matrix:
      0     1
0  1512     0
1    67  1461
---- Validation: 
scalar performance:
{'acc': 0.69640064, 'precision': 0.7695379, 'recall': 0.6892694, 'specificity': 0.6892694, 'f1': 0.6692759, 'auroc': 0.8528296, 'binary_precision': 0.9034483, 'binary_recall': 0.42122185, 'binary_specificity': 0.95731705, 'binary_f1_score': 0.5745614}
confusion matrix:
     0    1
0  628   28
1  360  262
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7638889, 'precision': 0.7647059, 'recall': 0.7638889, 'specificity': 0.7638889, 'f1': 0.76370656, 'auroc': 0.8511231, 'binary_precision': 0.7794118, 'binary_recall': 0.7361111, 'binary_specificity': 0.7916667, 'binary_f1_score': 0.75714284}
confusion matrix:
     0    1
0  171   45
1   57  159
early stop counter: 3
val acc:0.6964006423950195, best validation acc: 0.8622848391532898, corresponding to test acc:                         0.7662037014961243 / 0.8171296119689941
after epoch: 14,now: 2024-07-23 13:29:44.323883,epoch time: 0:02:11.066559,used: 0:31:42.942824,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_12_58_01_seed_2_22795139
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.98782897, 'precision': 0.98785603, 'recall': 0.98789597, 'specificity': 0.98789597, 'f1': 0.98782885, 'auroc': 0.9994187, 'binary_precision': 0.994716, 'binary_recall': 0.9811075, 'binary_specificity': 0.9946844, 'binary_f1_score': 0.9878649}
confusion matrix:
      0     1
0  1497     8
1    29  1506
---- Validation: 
scalar performance:
{'acc': 0.80594677, 'precision': 0.83354807, 'recall': 0.80205965, 'specificity': 0.80205965, 'f1': 0.8003487, 'auroc': 0.9129529, 'binary_precision': 0.9230769, 'binary_recall': 0.6559486, 'binary_specificity': 0.9481707, 'binary_f1_score': 0.7669173}
confusion matrix:
     0    1
0  622   34
1  214  408
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7893519, 'precision': 0.82223415, 'recall': 0.7893518, 'specificity': 0.7893518, 'f1': 0.78383726, 'auroc': 0.8946545, 'binary_precision': 0.92517006, 'binary_recall': 0.6296296, 'binary_specificity': 0.9490741, 'binary_f1_score': 0.74931127}
confusion matrix:
     0    1
0  205   11
1   80  136
early stop counter: 4
val acc:0.8059467673301697, best validation acc: 0.8622848391532898, corresponding to test acc:                         0.7662037014961243 / 0.8171296119689941
after epoch: 15,now: 2024-07-23 13:32:01.501390,epoch time: 0:02:17.177507,used: 0:34:00.120331,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_12_58_01_seed_2_22795139
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9848684, 'precision': 0.98496336, 'recall': 0.9848223, 'specificity': 0.9848223, 'f1': 0.9848655, 'auroc': 0.9988642, 'binary_precision': 0.9799871, 'binary_recall': 0.99021524, 'binary_specificity': 0.9794293, 'binary_f1_score': 0.9850746}
confusion matrix:
      0     1
0  1476    31
1    15  1518
---- Validation: 
scalar performance:
{'acc': 0.8482003, 'precision': 0.8480928, 'recall': 0.8480928, 'specificity': 0.8480928, 'f1': 0.8480928, 'auroc': 0.912073, 'binary_precision': 0.8440514, 'binary_recall': 0.8440514, 'binary_specificity': 0.85213417, 'binary_f1_score': 0.8440514}
confusion matrix:
     0    1
0  559   97
1   97  525
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7986111, 'precision': 0.8026656, 'recall': 0.7986111, 'specificity': 0.7986111, 'f1': 0.79793435, 'auroc': 0.89015347, 'binary_precision': 0.76763487, 'binary_recall': 0.8564815, 'binary_specificity': 0.7407407, 'binary_f1_score': 0.80962795}
confusion matrix:
     0    1
0  160   56
1   31  185
early stop counter: 5
val acc:0.8482003211975098, best validation acc: 0.8622848391532898, corresponding to test acc:                         0.7662037014961243 / 0.8171296119689941
after epoch: 16,now: 2024-07-23 13:34:12.310020,epoch time: 0:02:10.808630,used: 0:36:10.928961,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_12_58_01_seed_2_22795139
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9917763, 'precision': 0.99190044, 'recall': 0.99172646, 'specificity': 0.99172646, 'f1': 0.9917747, 'auroc': 0.9994464, 'binary_precision': 0.9858156, 'binary_recall': 0.99804175, 'binary_specificity': 0.98541117, 'binary_f1_score': 0.99189097}
confusion matrix:
      0     1
0  1486    22
1     3  1529
---- Validation: 
scalar performance:
{'acc': 0.8309859, 'precision': 0.83343744, 'recall': 0.82978296, 'specificity': 0.82978296, 'f1': 0.8302171, 'auroc': 0.8998338, 'binary_precision': 0.8561404, 'binary_recall': 0.7845659, 'binary_specificity': 0.875, 'binary_f1_score': 0.818792}
confusion matrix:
     0    1
0  574   82
1  134  488
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8078704, 'precision': 0.80803543, 'recall': 0.8078704, 'specificity': 0.8078704, 'f1': 0.80784464, 'auroc': 0.8969908, 'binary_precision': 0.800905, 'binary_recall': 0.8194444, 'binary_specificity': 0.7962963, 'binary_f1_score': 0.81006867}
confusion matrix:
     0    1
0  172   44
1   39  177
early stop counter: 6
val acc:0.8309859037399292, best validation acc: 0.8622848391532898, corresponding to test acc:                         0.7662037014961243 / 0.8171296119689941
after epoch: 17,now: 2024-07-23 13:36:25.222913,epoch time: 0:02:12.912893,used: 0:38:23.841854,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_12_58_01_seed_2_22795139
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9884868, 'precision': 0.9885734, 'recall': 0.98855627, 'specificity': 0.98855627, 'f1': 0.9884868, 'auroc': 0.9994823, 'binary_precision': 0.99734217, 'binary_recall': 0.979765, 'binary_specificity': 0.9973475, 'binary_f1_score': 0.98847544}
confusion matrix:
      0     1
0  1504     4
1    31  1501
---- Validation: 
scalar performance:
{'acc': 0.7339593, 'precision': 0.78559726, 'recall': 0.7281463, 'specificity': 0.7281463, 'f1': 0.71800315, 'auroc': 0.8781787, 'binary_precision': 0.9005682, 'binary_recall': 0.5096463, 'binary_specificity': 0.94664633, 'binary_f1_score': 0.650924}
confusion matrix:
     0    1
0  621   35
1  305  317
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.775463, 'precision': 0.82593644, 'recall': 0.775463, 'specificity': 0.775463, 'f1': 0.76642, 'auroc': 0.8683342, 'binary_precision': 0.9541985, 'binary_recall': 0.5787037, 'binary_specificity': 0.9722222, 'binary_f1_score': 0.720461}
confusion matrix:
     0    1
0  210    6
1   91  125
early stop counter: 7
val acc:0.7339593172073364, best validation acc: 0.8622848391532898, corresponding to test acc:                         0.7662037014961243 / 0.8171296119689941
after epoch: 18,now: 2024-07-23 13:38:40.656707,epoch time: 0:02:15.433794,used: 0:40:39.275648,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_12_58_01_seed_2_22795139
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.99407893, 'precision': 0.99409837, 'recall': 0.9941292, 'specificity': 0.9941292, 'f1': 0.9940789, 'auroc': 0.9997368, 'binary_precision': 1.0, 'binary_recall': 0.9882583, 'binary_specificity': 1.0, 'binary_f1_score': 0.99409443}
confusion matrix:
      0     1
0  1507     0
1    18  1515
---- Validation: 
scalar performance:
{'acc': 0.70500785, 'precision': 0.7983918, 'recall': 0.69740367, 'specificity': 0.69740367, 'f1': 0.6748866, 'auroc': 0.8993112, 'binary_precision': 0.9588015, 'binary_recall': 0.41157556, 'binary_specificity': 0.9832317, 'binary_f1_score': 0.575928}
confusion matrix:
     0    1
0  645   11
1  366  256
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7361111, 'precision': 0.80052376, 'recall': 0.7361111, 'specificity': 0.7361111, 'f1': 0.7211704, 'auroc': 0.8553027, 'binary_precision': 0.9396552, 'binary_recall': 0.5046296, 'binary_specificity': 0.9675926, 'binary_f1_score': 0.6566265}
confusion matrix:
     0    1
0  209    7
1  107  109
early stop counter: 8
val acc:0.7050078511238098, best validation acc: 0.8622848391532898, corresponding to test acc:                         0.7662037014961243 / 0.8171296119689941
after epoch: 19,now: 2024-07-23 13:40:58.099349,epoch time: 0:02:17.442642,used: 0:42:56.718290,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_12_58_01_seed_2_22795139
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.98782897, 'precision': 0.9880297, 'recall': 0.9878892, 'specificity': 0.9878892, 'f1': 0.9878285, 'auroc': 0.9995663, 'binary_precision': 0.9993302, 'binary_recall': 0.9764398, 'binary_specificity': 0.9993386, 'binary_f1_score': 0.98775244}
confusion matrix:
      0     1
0  1511     1
1    36  1492
---- Validation: 
scalar performance:
{'acc': 0.6087637, 'precision': 0.765092, 'recall': 0.59827906, 'specificity': 0.59827906, 'f1': 0.5297003, 'auroc': 0.8672236, 'binary_precision': 0.9621212, 'binary_recall': 0.20418006, 'binary_specificity': 0.99237806, 'binary_f1_score': 0.33687}
confusion matrix:
     0    1
0  651    5
1  495  127
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.625, 'precision': 0.7769757, 'recall': 0.625, 'specificity': 0.625, 'f1': 0.5653815, 'auroc': 0.87339246, 'binary_precision': 0.98214287, 'binary_recall': 0.25462964, 'binary_specificity': 0.9953704, 'binary_f1_score': 0.40441173}
confusion matrix:
     0   1
0  215   1
1  161  55
early stop counter: 9
val acc:0.6087636947631836, best validation acc: 0.8622848391532898, corresponding to test acc:                         0.7662037014961243 / 0.8171296119689941
after epoch: 20,now: 2024-07-23 13:43:14.349130,epoch time: 0:02:16.249781,used: 0:45:12.968071,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_12_58_01_seed_2_22795139
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.99013156, 'precision': 0.99032336, 'recall': 0.9900806, 'specificity': 0.9900806, 'f1': 0.99012953, 'auroc': 0.9997935, 'binary_precision': 0.98199356, 'binary_recall': 0.998692, 'binary_specificity': 0.9814692, 'binary_f1_score': 0.9902724}
confusion matrix:
      0     1
0  1483    28
1     2  1527
---- Validation: 
scalar performance:
{'acc': 0.842723, 'precision': 0.84802186, 'recall': 0.8410492, 'specificity': 0.8410492, 'f1': 0.8415705, 'auroc': 0.91237944, 'binary_precision': 0.8848263, 'binary_recall': 0.77813506, 'binary_specificity': 0.9039634, 'binary_f1_score': 0.8280581}
confusion matrix:
     0    1
0  593   63
1  138  484
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7916667, 'precision': 0.79595476, 'recall': 0.7916667, 'specificity': 0.7916667, 'f1': 0.7909093, 'auroc': 0.89148235, 'binary_precision': 0.76033056, 'binary_recall': 0.8518519, 'binary_specificity': 0.7314815, 'binary_f1_score': 0.8034935}
confusion matrix:
     0    1
0  158   58
1   32  184
early stop counter: 10
val acc:0.84272301197052, best validation acc: 0.8622848391532898, corresponding to test acc:                         0.7662037014961243 / 0.8171296119689941
after epoch: 21,now: 2024-07-23 13:45:25.227619,epoch time: 0:02:10.878489,used: 0:47:23.846560,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_12_58_01_seed_2_22795139
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9934211, 'precision': 0.9934683, 'recall': 0.9934598, 'specificity': 0.9934598, 'f1': 0.9934211, 'auroc': 0.9998355, 'binary_precision': 1.0, 'binary_recall': 0.9869196, 'binary_specificity': 1.0, 'binary_f1_score': 0.9934167}
confusion matrix:
      0     1
0  1511     0
1    20  1509
---- Validation: 
scalar performance:
{'acc': 0.69014084, 'precision': 0.79442, 'recall': 0.682047, 'specificity': 0.682047, 'f1': 0.6542028, 'auroc': 0.89831924, 'binary_precision': 0.96311474, 'binary_recall': 0.37781352, 'binary_specificity': 0.9862805, 'binary_f1_score': 0.54272515}
confusion matrix:
     0    1
0  647    9
1  387  235
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6388889, 'precision': 0.7617971, 'recall': 0.6388889, 'specificity': 0.6388889, 'f1': 0.59086937, 'auroc': 0.8685485, 'binary_precision': 0.9411765, 'binary_recall': 0.2962963, 'binary_specificity': 0.9814815, 'binary_f1_score': 0.45070422}
confusion matrix:
     0   1
0  212   4
1  152  64
early stop counter: 11
val acc:0.6901408433914185, best validation acc: 0.8622848391532898, corresponding to test acc:                         0.7662037014961243 / 0.8171296119689941
after epoch: 22,now: 2024-07-23 13:47:37.168438,epoch time: 0:02:11.940819,used: 0:49:35.787379,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_12_58_01_seed_2_22795139
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.99572366, 'precision': 0.99571145, 'recall': 0.995746, 'specificity': 0.995746, 'f1': 0.9957235, 'auroc': 0.99993336, 'binary_precision': 0.9980366, 'binary_recall': 0.99348533, 'binary_specificity': 0.99800664, 'binary_f1_score': 0.9957558}
confusion matrix:
      0     1
0  1502     3
1    10  1525
---- Validation: 
scalar performance:
{'acc': 0.6619718, 'precision': 0.7765894, 'recall': 0.65319145, 'specificity': 0.65319145, 'f1': 0.6155717, 'auroc': 0.88446677, 'binary_precision': 0.9481132, 'binary_recall': 0.3231511, 'binary_specificity': 0.9832317, 'binary_f1_score': 0.4820144}
confusion matrix:
     0    1
0  645   11
1  421  201
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.587963, 'precision': 0.74039364, 'recall': 0.587963, 'specificity': 0.587963, 'f1': 0.51034135, 'auroc': 0.8362, 'binary_precision': 0.9318182, 'binary_recall': 0.18981482, 'binary_specificity': 0.9861111, 'binary_f1_score': 0.31538463}
confusion matrix:
     0   1
0  213   3
1  175  41
early stop counter: 12
val acc:0.6619718074798584, best validation acc: 0.8622848391532898, corresponding to test acc:                         0.7662037014961243 / 0.8171296119689941
after epoch: 23,now: 2024-07-23 13:49:54.677570,epoch time: 0:02:17.509132,used: 0:51:53.296511,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_12_58_01_seed_2_22795139
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9707237, 'precision': 0.97244394, 'recall': 0.97044486, 'specificity': 0.97044486, 'f1': 0.9706817, 'auroc': 0.99942344, 'binary_precision': 0.9462963, 'binary_recall': 0.99869704, 'binary_specificity': 0.9421927, 'binary_f1_score': 0.9717908}
confusion matrix:
      0     1
0  1418    87
1     2  1533
---- Validation: 
scalar performance:
{'acc': 0.70187795, 'precision': 0.70266604, 'recall': 0.70064604, 'specificity': 0.70064604, 'f1': 0.70061517, 'auroc': 0.772437, 'binary_precision': 0.7102967, 'binary_recall': 0.65434086, 'binary_specificity': 0.7469512, 'binary_f1_score': 0.68117154}
confusion matrix:
     0    1
0  490  166
1  215  407
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6018519, 'precision': 0.64117646, 'recall': 0.6018518, 'specificity': 0.6018518, 'f1': 0.5720506, 'auroc': 0.70449674, 'binary_precision': 0.56666666, 'binary_recall': 0.8657407, 'binary_specificity': 0.33796296, 'binary_f1_score': 0.68498164}
confusion matrix:
    0    1
0  73  143
1  29  187
early stop counter: 13
val acc:0.7018779516220093, best validation acc: 0.8622848391532898, corresponding to test acc:                         0.7662037014961243 / 0.8171296119689941
after epoch: 24,now: 2024-07-23 13:52:04.865139,epoch time: 0:02:10.187569,used: 0:54:03.484080,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_12_58_01_seed_2_22795139
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.98421055, 'precision': 0.9846051, 'recall': 0.98411083, 'specificity': 0.98411083, 'f1': 0.984204, 'auroc': 0.9995723, 'binary_precision': 0.9726115, 'binary_recall': 0.9967363, 'binary_specificity': 0.97148544, 'binary_f1_score': 0.98452616}
confusion matrix:
      0     1
0  1465    43
1     5  1527
---- Validation: 
scalar performance:
{'acc': 0.8317684, 'precision': 0.8454354, 'recall': 0.8290869, 'specificity': 0.8290869, 'f1': 0.82919055, 'auroc': 0.9157787, 'binary_precision': 0.90781564, 'binary_recall': 0.7282958, 'binary_specificity': 0.92987806, 'binary_f1_score': 0.8082069}
confusion matrix:
     0    1
0  610   46
1  169  453
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.849537, 'precision': 0.85508525, 'recall': 0.849537, 'specificity': 0.849537, 'f1': 0.848947, 'auroc': 0.9282408, 'binary_precision': 0.8994709, 'binary_recall': 0.787037, 'binary_specificity': 0.912037, 'binary_f1_score': 0.83950615}
confusion matrix:
     0    1
0  197   19
1   46  170
new oracle model saved
early stop counter: 14
val acc:0.8317683935165405, best validation acc: 0.8622848391532898, corresponding to test acc:                         0.7662037014961243 / 0.8495370149612427
after epoch: 25,now: 2024-07-23 13:54:18.842408,epoch time: 0:02:13.977269,used: 0:56:17.461349,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_12_58_01_seed_2_22795139
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9930921, 'precision': 0.99312073, 'recall': 0.99314106, 'specificity': 0.99314106, 'f1': 0.99309206, 'auroc': 0.99970305, 'binary_precision': 0.99933904, 'binary_recall': 0.98694515, 'binary_specificity': 0.9993369, 'binary_f1_score': 0.99310344}
confusion matrix:
      0     1
0  1507     1
1    20  1512
---- Validation: 
scalar performance:
{'acc': 0.73865414, 'precision': 0.81410253, 'recall': 0.7320112, 'specificity': 0.7320112, 'f1': 0.7182398, 'auroc': 0.89242756, 'binary_precision': 0.96153843, 'binary_recall': 0.48231512, 'binary_specificity': 0.98170733, 'binary_f1_score': 0.64239824}
confusion matrix:
     0    1
0  644   12
1  322  300
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7777778, 'precision': 0.8170254, 'recall': 0.7777778, 'specificity': 0.7777778, 'f1': 0.77068037, 'auroc': 0.86334014, 'binary_precision': 0.9285714, 'binary_recall': 0.6018519, 'binary_specificity': 0.9537037, 'binary_f1_score': 0.7303371}
confusion matrix:
     0    1
0  206   10
1   86  130
early stop counter: 15
val acc:0.7386541366577148, best validation acc: 0.8622848391532898, corresponding to test acc:                         0.7662037014961243 / 0.8495370149612427
after epoch: 26,now: 2024-07-23 13:56:28.115018,epoch time: 0:02:09.272610,used: 0:58:26.733959,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_12_58_01_seed_2_22795139
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.99375, 'precision': 0.9937519, 'recall': 0.99374783, 'specificity': 0.99374783, 'f1': 0.99374974, 'auroc': 0.99974597, 'binary_precision': 0.99346405, 'binary_recall': 0.9941138, 'binary_specificity': 0.99338186, 'binary_f1_score': 0.9937888}
confusion matrix:
      0     1
0  1501    10
1     9  1520
---- Validation: 
scalar performance:
{'acc': 0.7973396, 'precision': 0.82703996, 'recall': 0.79325885, 'specificity': 0.79325885, 'f1': 0.79097533, 'auroc': 0.9051496, 'binary_precision': 0.9191686, 'binary_recall': 0.63987136, 'binary_specificity': 0.94664633, 'binary_f1_score': 0.75450236}
confusion matrix:
     0    1
0  621   35
1  224  398
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7152778, 'precision': 0.733935, 'recall': 0.7152778, 'specificity': 0.7152778, 'f1': 0.7094853, 'auroc': 0.8264532, 'binary_precision': 0.8, 'binary_recall': 0.5740741, 'binary_specificity': 0.8564815, 'binary_f1_score': 0.6684636}
confusion matrix:
     0    1
0  185   31
1   92  124
early stop counter: 16
val acc:0.7973396182060242, best validation acc: 0.8622848391532898, corresponding to test acc:                         0.7662037014961243 / 0.8495370149612427
after epoch: 27,now: 2024-07-23 13:58:36.425690,epoch time: 0:02:08.310672,used: 1:00:35.044631,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_12_58_01_seed_2_22795139
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.99111843, 'precision': 0.991115, 'recall': 0.9911207, 'specificity': 0.9911207, 'f1': 0.9911177, 'auroc': 0.9995918, 'binary_precision': 0.99151987, 'binary_recall': 0.9908735, 'binary_specificity': 0.9913679, 'binary_f1_score': 0.9911966}
confusion matrix:
      0     1
0  1493    13
1    14  1520
---- Validation: 
scalar performance:
{'acc': 0.80203444, 'precision': 0.8263713, 'recall': 0.798332, 'specificity': 0.798332, 'f1': 0.7968062, 'auroc': 0.88789606, 'binary_precision': 0.90909094, 'binary_recall': 0.659164, 'binary_specificity': 0.9375, 'binary_f1_score': 0.7642125}
confusion matrix:
     0    1
0  615   41
1  212  410
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.650463, 'precision': 0.7129402, 'recall': 0.650463, 'specificity': 0.650463, 'f1': 0.6227947, 'auroc': 0.7782707, 'binary_precision': 0.82828283, 'binary_recall': 0.37962964, 'binary_specificity': 0.9212963, 'binary_f1_score': 0.52063495}
confusion matrix:
     0   1
0  199  17
1  134  82
early stop counter: 17
val acc:0.8020344376564026, best validation acc: 0.8622848391532898, corresponding to test acc:                         0.7662037014961243 / 0.8495370149612427
after epoch: 28,now: 2024-07-23 14:00:47.999760,epoch time: 0:02:11.574070,used: 1:02:46.618701,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_12_58_01_seed_2_22795139
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.99473685, 'precision': 0.9947429, 'recall': 0.9947729, 'specificity': 0.9947729, 'f1': 0.9947368, 'auroc': 0.9999373, 'binary_precision': 0.99934125, 'binary_recall': 0.99020886, 'binary_specificity': 0.9993369, 'binary_f1_score': 0.9947541}
confusion matrix:
      0     1
0  1507     1
1    15  1517
---- Validation: 
scalar performance:
{'acc': 0.7065728, 'precision': 0.80400264, 'recall': 0.6988864, 'specificity': 0.6988864, 'f1': 0.6759273, 'auroc': 0.91380024, 'binary_precision': 0.9695817, 'binary_recall': 0.40996784, 'binary_specificity': 0.9878049, 'binary_f1_score': 0.5762712}
confusion matrix:
     0    1
0  648    8
1  367  255
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6712963, 'precision': 0.7894394, 'recall': 0.6712963, 'specificity': 0.6712963, 'f1': 0.633942, 'auroc': 0.88235164, 'binary_precision': 0.974359, 'binary_recall': 0.35185185, 'binary_specificity': 0.9907407, 'binary_f1_score': 0.51700675}
confusion matrix:
     0   1
0  214   2
1  140  76
early stop counter: 18
val acc:0.7065727710723877, best validation acc: 0.8622848391532898, corresponding to test acc:                         0.7662037014961243 / 0.8495370149612427
after epoch: 29,now: 2024-07-23 14:03:01.024440,epoch time: 0:02:13.024680,used: 1:04:59.643381,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_12_58_01_seed_2_22795139
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.99539477, 'precision': 0.99538815, 'recall': 0.9954088, 'specificity': 0.9954088, 'f1': 0.9953946, 'auroc': 0.999948, 'binary_precision': 0.99737704, 'binary_recall': 0.99346834, 'binary_specificity': 0.99734926, 'binary_f1_score': 0.9954188}
confusion matrix:
      0     1
0  1505     4
1    10  1521
---- Validation: 
scalar performance:
{'acc': 0.7801252, 'precision': 0.8292166, 'recall': 0.77490735, 'specificity': 0.77490735, 'f1': 0.76928675, 'auroc': 0.9138818, 'binary_precision': 0.9498681, 'binary_recall': 0.57877815, 'binary_specificity': 0.9710366, 'binary_f1_score': 0.7192808}
confusion matrix:
     0    1
0  637   19
1  262  360
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6782407, 'precision': 0.7306988, 'recall': 0.6782408, 'specificity': 0.6782408, 'f1': 0.6588472, 'auroc': 0.80411947, 'binary_precision': 0.84070796, 'binary_recall': 0.4398148, 'binary_specificity': 0.9166667, 'binary_f1_score': 0.57750756}
confusion matrix:
     0   1
0  198  18
1  121  95
early stop counter: 19
val acc:0.7801252007484436, best validation acc: 0.8622848391532898, corresponding to test acc:                         0.7662037014961243 / 0.8495370149612427
after epoch: 30,now: 2024-07-23 14:05:06.276182,epoch time: 0:02:05.251742,used: 1:07:04.895123,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_12_58_01_seed_2_22795139
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 1:07:04.895123 at 2024-07-23 14:05:06.276182
persisted model performance metric: 

scalar performance:
{'acc': 0.7662037, 'precision': 0.77425086, 'recall': 0.76620376, 'specificity': 0.76620376, 'f1': 0.764476, 'auroc': 0.87789357, 'binary_precision': 0.72727275, 'binary_recall': 0.8518519, 'binary_specificity': 0.6805556, 'binary_f1_score': 0.7846482}
confusion matrix:
     0    1
0  147   69
1   32  184
oracle model performance metric: 

scalar performance:
{'acc': 0.849537, 'precision': 0.85508525, 'recall': 0.849537, 'specificity': 0.849537, 'f1': 0.848947, 'auroc': 0.9282408, 'binary_precision': 0.8994709, 'binary_recall': 0.787037, 'binary_specificity': 0.912037, 'binary_f1_score': 0.83950615}
confusion matrix:
     0    1
0  197   19
1   46  170
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_dial_lr1e5_bs32__45_nofreeze_2024-07-23_10-43-50/rule_results/5.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_dial_lr1e5_bs32__45_nofreeze_2024-07-23_10-43-50/confusion_matrix/5.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 451685 KiB |  26075 MiB | 215764 GiB | 215764 GiB |
|       from large pool | 411132 KiB |  26030 MiB | 214418 GiB | 214418 GiB |
|       from small pool |  40553 KiB |     60 MiB |   1346 GiB |   1346 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 451685 KiB |  26075 MiB | 215764 GiB | 215764 GiB |
|       from large pool | 411132 KiB |  26030 MiB | 214418 GiB | 214418 GiB |
|       from small pool |  40553 KiB |     60 MiB |   1346 GiB |   1346 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 447481 KiB |  26071 MiB | 215724 GiB | 215724 GiB |
|       from large pool | 407075 KiB |  26026 MiB | 214380 GiB | 214380 GiB |
|       from small pool |  40406 KiB |     60 MiB |   1343 GiB |   1343 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  27778 MiB |  27778 MiB |  80918 MiB |  53140 MiB |
|       from large pool |  27710 MiB |  27710 MiB |  80820 MiB |  53110 MiB |
|       from small pool |     68 MiB |     72 MiB |     98 MiB |     30 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 775066 KiB |   1679 MiB |  97329 GiB |  97328 GiB |
|       from large pool | 758276 KiB |   1676 MiB |  95973 GiB |  95972 GiB |
|       from small pool |  16790 KiB |     33 MiB |   1355 GiB |   1355 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    1220    |    2570    |   19513 K  |   19512 K  |
|       from large pool |     187    |    1413    |    9879 K  |    9878 K  |
|       from small pool |    1033    |    1335    |    9634 K  |    9633 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    1220    |    2570    |   19513 K  |   19512 K  |
|       from large pool |     187    |    1413    |    9879 K  |    9878 K  |
|       from small pool |    1033    |    1335    |    9634 K  |    9633 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     837    |     837    |    2371    |    1534    |
|       from large pool |     803    |     803    |    2322    |    1519    |
|       from small pool |      34    |      36    |      49    |      15    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     115    |     851    |   14237 K  |   14237 K  |
|       from large pool |      47    |     805    |    8785 K  |    8785 K  |
|       from small pool |      68    |     146    |    5451 K  |    5451 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  26075 MiB | 215764 GiB | 215764 GiB |
|       from large pool |  16640 KiB |  26030 MiB | 214418 GiB | 214418 GiB |
|       from small pool |      0 KiB |     60 MiB |   1346 GiB |   1346 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  26075 MiB | 215764 GiB | 215764 GiB |
|       from large pool |  16640 KiB |  26030 MiB | 214418 GiB | 214418 GiB |
|       from small pool |      0 KiB |     60 MiB |   1346 GiB |   1346 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  26071 MiB | 215724 GiB | 215724 GiB |
|       from large pool |  16640 KiB |  26026 MiB | 214380 GiB | 214380 GiB |
|       from small pool |      0 KiB |     60 MiB |   1343 GiB |   1343 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1198 MiB |  27778 MiB |  80918 MiB |  79720 MiB |
|       from large pool |   1142 MiB |  27710 MiB |  80820 MiB |  79678 MiB |
|       from small pool |     56 MiB |     72 MiB |     98 MiB |     42 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |   3840 KiB |   1679 MiB |  97329 GiB |  97329 GiB |
|       from large pool |   3840 KiB |   1676 MiB |  95973 GiB |  95973 GiB |
|       from small pool |      0 KiB |     33 MiB |   1355 GiB |   1355 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    2570    |   19513 K  |   19513 K  |
|       from large pool |       2    |    1413    |    9879 K  |    9879 K  |
|       from small pool |       0    |    1335    |    9634 K  |    9634 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    2570    |   19513 K  |   19513 K  |
|       from large pool |       2    |    1413    |    9879 K  |    9879 K  |
|       from small pool |       0    |    1335    |    9634 K  |    9634 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      71    |     837    |    2371    |    2300    |
|       from large pool |      43    |     803    |    2322    |    2279    |
|       from small pool |      28    |      36    |      49    |      21    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       1    |     851    |   14237 K  |   14237 K  |
|       from large pool |       1    |     805    |    8785 K  |    8785 K  |
|       from small pool |       0    |     146    |    5451 K  |    5451 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Tue Jul 23 14:06:31 2024]
Finished job 0.
1 of 1 steps (100%) done
