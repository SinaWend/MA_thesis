Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Tue Jul 23 05:05:44 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_dial_lr1e5_bs32_nofreeze_2024-07-23_01-16-41/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_dial_lr1e5_bs32_nofreeze_2024-07-23_01-16-41/rule_results/3.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=3
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/swiglu_ffn.py:51: UserWarning: xFormers is not available (SwiGLU)
  warnings.warn("xFormers is not available (SwiGLU)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/attention.py:33: UserWarning: xFormers is not available (Attention)
  warnings.warn("xFormers is not available (Attention)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/block.py:40: UserWarning: xFormers is not available (Block)
  warnings.warn("xFormers is not available (Block)")
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'888c1ef2'
model name: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_05_06_24_seed_0_22779259

 Experiment start at: 2024-07-23 05:06:25.019876
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
before training, model accuracy: 0.569767415523529
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.91471356, 'precision': 0.91526806, 'recall': 0.9145111, 'specificity': 0.9145111, 'f1': 0.9146466, 'auroc': 0.9772197, 'binary_precision': 0.90274316, 'binary_recall': 0.9317889, 'binary_specificity': 0.8972332, 'binary_f1_score': 0.9170361}
confusion matrix:
      0     1
0  1362   156
1   106  1448
---- Validation: 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
scalar performance:
{'acc': 0.8090062, 'precision': 0.80948174, 'recall': 0.80927277, 'specificity': 0.80927277, 'f1': 0.8089947, 'auroc': 0.88821065, 'binary_precision': 0.7933635, 'binary_recall': 0.82834643, 'binary_specificity': 0.7901991, 'binary_f1_score': 0.8104777}
confusion matrix:
     0    1
0  516  137
1  109  526
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.82093024, 'precision': 0.8214936, 'recall': 0.82093024, 'specificity': 0.82093024, 'f1': 0.8208518, 'auroc': 0.8933694, 'binary_precision': 0.80803573, 'binary_recall': 0.8418605, 'binary_specificity': 0.8, 'binary_f1_score': 0.8246014}
confusion matrix:
     0    1
0  172   43
1   34  181
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-23 05:07:43.507062,epoch time: 0:01:18.487186,used: 0:01:18.487186,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_05_06_24_seed_0_22779259
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.95996094, 'precision': 0.9599359, 'recall': 0.9600024, 'specificity': 0.9600024, 'f1': 0.9599569, 'auroc': 0.99297154, 'binary_precision': 0.9637775, 'binary_recall': 0.95696855, 'binary_specificity': 0.9630363, 'binary_f1_score': 0.96036094}
confusion matrix:
      0     1
0  1459    56
1    67  1490
---- Validation: 
scalar performance:
{'acc': 0.86180127, 'precision': 0.8617766, 'recall': 0.86183935, 'specificity': 0.86183935, 'f1': 0.8617892, 'auroc': 0.91635215, 'binary_precision': 0.8564743, 'binary_recall': 0.8645669, 'binary_specificity': 0.8591118, 'binary_f1_score': 0.8605016}
confusion matrix:
     0    1
0  561   92
1   86  549
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8581395, 'precision': 0.85820925, 'recall': 0.8581395, 'specificity': 0.8581395, 'f1': 0.85813266, 'auroc': 0.92620873, 'binary_precision': 0.853211, 'binary_recall': 0.8651163, 'binary_specificity': 0.8511628, 'binary_f1_score': 0.85912246}
confusion matrix:
     0    1
0  183   32
1   29  186
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-07-23 05:08:57.734608,epoch time: 0:01:14.227546,used: 0:02:32.714732,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_05_06_24_seed_0_22779259
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9641927, 'precision': 0.9655692, 'recall': 0.96460444, 'specificity': 0.96460444, 'f1': 0.9641825, 'auroc': 0.9957492, 'binary_precision': 0.9945318, 'binary_recall': 0.9344894, 'binary_specificity': 0.99471945, 'binary_f1_score': 0.9635762}
confusion matrix:
      0     1
0  1507     8
1   102  1455
---- Validation: 
scalar performance:
{'acc': 0.73913044, 'precision': 0.76590765, 'recall': 0.73686564, 'specificity': 0.73686564, 'f1': 0.73114324, 'auroc': 0.8342284, 'binary_precision': 0.84686774, 'binary_recall': 0.5748032, 'binary_specificity': 0.89892805, 'binary_f1_score': 0.684803}
confusion matrix:
     0    1
0  587   66
1  270  365
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.82093024, 'precision': 0.8225, 'recall': 0.82093024, 'specificity': 0.82093024, 'f1': 0.8207121, 'auroc': 0.9119308, 'binary_precision': 0.845, 'binary_recall': 0.7860465, 'binary_specificity': 0.855814, 'binary_f1_score': 0.81445783}
confusion matrix:
     0    1
0  184   31
1   46  169
early stop counter: 1
val acc:0.739130437374115, best validation acc: 0.861801266670227, corresponding to test acc:                         0.8581395149230957 / 0.8581395149230957
after epoch: 3,now: 2024-07-23 05:10:11.598654,epoch time: 0:01:13.864046,used: 0:03:46.578778,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_05_06_24_seed_0_22779259
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9703776, 'precision': 0.9705866, 'recall': 0.9702724, 'specificity': 0.9702724, 'f1': 0.97036517, 'auroc': 0.99639034, 'binary_precision': 0.96329117, 'binary_recall': 0.9787781, 'binary_specificity': 0.96176666, 'binary_f1_score': 0.9709729}
confusion matrix:
      0     1
0  1459    58
1    33  1522
---- Validation: 
scalar performance:
{'acc': 0.8043478, 'precision': 0.8096094, 'recall': 0.8052429, 'specificity': 0.8052429, 'f1': 0.803801, 'auroc': 0.888927, 'binary_precision': 0.7656033, 'binary_recall': 0.86929137, 'binary_specificity': 0.7411945, 'binary_f1_score': 0.81415933}
confusion matrix:
     0    1
0  484  169
1   83  552
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8, 'precision': 0.80595696, 'recall': 0.79999995, 'specificity': 0.79999995, 'f1': 0.7990217, 'auroc': 0.90922666, 'binary_precision': 0.7632653, 'binary_recall': 0.8697674, 'binary_specificity': 0.73023254, 'binary_f1_score': 0.8130434}
confusion matrix:
     0    1
0  157   58
1   28  187
early stop counter: 2
val acc:0.804347813129425, best validation acc: 0.861801266670227, corresponding to test acc:                         0.8581395149230957 / 0.8581395149230957
after epoch: 4,now: 2024-07-23 05:11:26.078506,epoch time: 0:01:14.479852,used: 0:05:01.058630,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_05_06_24_seed_0_22779259
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9716797, 'precision': 0.9724811, 'recall': 0.97196937, 'specificity': 0.97196937, 'f1': 0.971676, 'auroc': 0.9972224, 'binary_precision': 0.99527663, 'binary_recall': 0.948553, 'binary_specificity': 0.99538565, 'binary_f1_score': 0.9713533}
confusion matrix:
      0     1
0  1510     7
1    80  1475
---- Validation: 
scalar performance:
{'acc': 0.7197205, 'precision': 0.7293295, 'recall': 0.7182224, 'specificity': 0.7182224, 'f1': 0.7158146, 'auroc': 0.82696456, 'binary_precision': 0.7729084, 'binary_recall': 0.6110236, 'binary_specificity': 0.82542115, 'binary_f1_score': 0.6824978}
confusion matrix:
     0    1
0  539  114
1  247  388
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7767442, 'precision': 0.7769599, 'recall': 0.7767442, 'specificity': 0.7767442, 'f1': 0.77670074, 'auroc': 0.8614602, 'binary_precision': 0.784689, 'binary_recall': 0.7627907, 'binary_specificity': 0.7906977, 'binary_f1_score': 0.77358496}
confusion matrix:
     0    1
0  170   45
1   51  164
early stop counter: 3
val acc:0.7197204828262329, best validation acc: 0.861801266670227, corresponding to test acc:                         0.8581395149230957 / 0.8581395149230957
after epoch: 5,now: 2024-07-23 05:12:40.321152,epoch time: 0:01:14.242646,used: 0:06:15.301276,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_05_06_24_seed_0_22779259
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.976237, 'precision': 0.97683704, 'recall': 0.9765085, 'specificity': 0.9765085, 'f1': 0.97623545, 'auroc': 0.998417, 'binary_precision': 0.99731725, 'binary_recall': 0.9556555, 'binary_specificity': 0.9973615, 'binary_f1_score': 0.97604203}
confusion matrix:
      0     1
0  1512     4
1    69  1487
---- Validation: 
scalar performance:
{'acc': 0.6847826, 'precision': 0.7719724, 'recall': 0.68077075, 'specificity': 0.68077075, 'f1': 0.6543813, 'auroc': 0.8661803, 'binary_precision': 0.92250925, 'binary_recall': 0.39370078, 'binary_specificity': 0.96784073, 'binary_f1_score': 0.55187637}
confusion matrix:
     0    1
0  632   21
1  385  250
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.83023256, 'precision': 0.8403112, 'recall': 0.83023256, 'specificity': 0.83023256, 'f1': 0.82896626, 'auroc': 0.9113034, 'binary_precision': 0.8988764, 'binary_recall': 0.74418604, 'binary_specificity': 0.9162791, 'binary_f1_score': 0.8142494}
confusion matrix:
     0    1
0  197   18
1   55  160
early stop counter: 4
val acc:0.6847826242446899, best validation acc: 0.861801266670227, corresponding to test acc:                         0.8581395149230957 / 0.8581395149230957
after epoch: 6,now: 2024-07-23 05:13:54.320497,epoch time: 0:01:13.999345,used: 0:07:29.300621,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_05_06_24_seed_0_22779259
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9814453, 'precision': 0.98142636, 'recall': 0.9814641, 'specificity': 0.9814641, 'f1': 0.9814426, 'auroc': 0.9983632, 'binary_precision': 0.9832474, 'binary_recall': 0.9800899, 'binary_specificity': 0.9828383, 'binary_f1_score': 0.9816661}
confusion matrix:
      0     1
0  1489    26
1    31  1526
---- Validation: 
scalar performance:
{'acc': 0.8214286, 'precision': 0.82290024, 'recall': 0.8209379, 'specificity': 0.8209379, 'f1': 0.82104015, 'auroc': 0.89427114, 'binary_precision': 0.84148395, 'binary_recall': 0.78582674, 'binary_specificity': 0.856049, 'binary_f1_score': 0.81270355}
confusion matrix:
     0    1
0  559   94
1  136  499
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.82325584, 'precision': 0.8233677, 'recall': 0.8232558, 'specificity': 0.8232558, 'f1': 0.8232405, 'auroc': 0.91110873, 'binary_precision': 0.8173516, 'binary_recall': 0.83255816, 'binary_specificity': 0.81395346, 'binary_f1_score': 0.8248848}
confusion matrix:
     0    1
0  175   40
1   36  179
early stop counter: 5
val acc:0.8214285969734192, best validation acc: 0.861801266670227, corresponding to test acc:                         0.8581395149230957 / 0.8581395149230957
after epoch: 7,now: 2024-07-23 05:15:08.183197,epoch time: 0:01:13.862700,used: 0:08:43.163321,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_05_06_24_seed_0_22779259
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.98339844, 'precision': 0.98356104, 'recall': 0.9835862, 'specificity': 0.9835862, 'f1': 0.98339844, 'auroc': 0.9989147, 'binary_precision': 0.99670404, 'binary_recall': 0.97047496, 'binary_specificity': 0.9966975, 'binary_f1_score': 0.98341465}
confusion matrix:
      0     1
0  1509     5
1    46  1512
---- Validation: 
scalar performance:
{'acc': 0.7818323, 'precision': 0.7958517, 'recall': 0.7802812, 'specificity': 0.7802812, 'f1': 0.7785418, 'auroc': 0.88628614, 'binary_precision': 0.85685486, 'binary_recall': 0.6692913, 'binary_specificity': 0.89127105, 'binary_f1_score': 0.7515473}
confusion matrix:
     0    1
0  582   71
1  210  425
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.83488375, 'precision': 0.8369906, 'recall': 0.8348837, 'specificity': 0.8348837, 'f1': 0.83462524, 'auroc': 0.91372633, 'binary_precision': 0.8636364, 'binary_recall': 0.7953488, 'binary_specificity': 0.8744186, 'binary_f1_score': 0.82808715}
confusion matrix:
     0    1
0  188   27
1   44  171
early stop counter: 6
val acc:0.7818322777748108, best validation acc: 0.861801266670227, corresponding to test acc:                         0.8581395149230957 / 0.8581395149230957
after epoch: 8,now: 2024-07-23 05:16:21.831102,epoch time: 0:01:13.647905,used: 0:09:56.811226,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_05_06_24_seed_0_22779259
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.98046875, 'precision': 0.98065007, 'recall': 0.9803722, 'specificity': 0.9803722, 'f1': 0.98046076, 'auroc': 0.9986439, 'binary_precision': 0.97401774, 'binary_recall': 0.9877892, 'binary_specificity': 0.97295517, 'binary_f1_score': 0.9808551}
confusion matrix:
      0     1
0  1475    41
1    19  1537
---- Validation: 
scalar performance:
{'acc': 0.8369565, 'precision': 0.83867526, 'recall': 0.8364472, 'specificity': 0.8364472, 'f1': 0.8365779, 'auroc': 0.9035391, 'binary_precision': 0.8595601, 'binary_recall': 0.8, 'binary_specificity': 0.87289435, 'binary_f1_score': 0.8287113}
confusion matrix:
     0    1
0  570   83
1  127  508
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8418605, 'precision': 0.84292877, 'recall': 0.8418604, 'specificity': 0.8418604, 'f1': 0.8417372, 'auroc': 0.917577, 'binary_precision': 0.86206895, 'binary_recall': 0.81395346, 'binary_specificity': 0.8697674, 'binary_f1_score': 0.83732057}
confusion matrix:
     0    1
0  187   28
1   40  175
early stop counter: 7
val acc:0.8369565010070801, best validation acc: 0.861801266670227, corresponding to test acc:                         0.8581395149230957 / 0.8581395149230957
after epoch: 9,now: 2024-07-23 05:17:36.227246,epoch time: 0:01:14.396144,used: 0:11:11.207370,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_05_06_24_seed_0_22779259
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9791667, 'precision': 0.9792073, 'recall': 0.9791292, 'specificity': 0.9791292, 'f1': 0.97916156, 'auroc': 0.9982581, 'binary_precision': 0.9769821, 'binary_recall': 0.9820051, 'binary_specificity': 0.9762533, 'binary_f1_score': 0.9794872}
confusion matrix:
      0     1
0  1480    36
1    28  1528
---- Validation: 
scalar performance:
{'acc': 0.7802795, 'precision': 0.7903613, 'recall': 0.77894515, 'specificity': 0.77894515, 'f1': 0.77776515, 'auroc': 0.88806844, 'binary_precision': 0.84108526, 'binary_recall': 0.6834646, 'binary_specificity': 0.8744257, 'binary_f1_score': 0.75412685}
confusion matrix:
     0    1
0  571   82
1  201  434
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.84418607, 'precision': 0.85717493, 'recall': 0.84418607, 'specificity': 0.84418607, 'f1': 0.8427565, 'auroc': 0.92030287, 'binary_precision': 0.92528737, 'binary_recall': 0.74883723, 'binary_specificity': 0.9395349, 'binary_f1_score': 0.8277635}
confusion matrix:
     0    1
0  202   13
1   54  161
early stop counter: 8
val acc:0.7802795171737671, best validation acc: 0.861801266670227, corresponding to test acc:                         0.8581395149230957 / 0.8581395149230957
after epoch: 10,now: 2024-07-23 05:18:50.260496,epoch time: 0:01:14.033250,used: 0:12:25.240620,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_05_06_24_seed_0_22779259
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.98502606, 'precision': 0.9851818, 'recall': 0.98494315, 'specificity': 0.98494315, 'f1': 0.98502064, 'auroc': 0.9991348, 'binary_precision': 0.9790476, 'binary_recall': 0.99163985, 'binary_specificity': 0.9782465, 'binary_f1_score': 0.9853035}
confusion matrix:
      0     1
0  1484    33
1    13  1542
---- Validation: 
scalar performance:
{'acc': 0.8043478, 'precision': 0.80448663, 'recall': 0.8041577, 'specificity': 0.8041577, 'f1': 0.80422693, 'auroc': 0.88056576, 'binary_precision': 0.8083736, 'binary_recall': 0.7905512, 'binary_specificity': 0.81776416, 'binary_f1_score': 0.799363}
confusion matrix:
     0    1
0  534  119
1  133  502
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7976744, 'precision': 0.8048564, 'recall': 0.7976744, 'specificity': 0.7976744, 'f1': 0.7964757, 'auroc': 0.910741, 'binary_precision': 0.7580645, 'binary_recall': 0.8744186, 'binary_specificity': 0.7209302, 'binary_f1_score': 0.812095}
confusion matrix:
     0    1
0  155   60
1   27  188
early stop counter: 9
val acc:0.804347813129425, best validation acc: 0.861801266670227, corresponding to test acc:                         0.8581395149230957 / 0.8581395149230957
after epoch: 11,now: 2024-07-23 05:20:04.712785,epoch time: 0:01:14.452289,used: 0:13:39.692909,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_05_06_24_seed_0_22779259
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.97721356, 'precision': 0.9779319, 'recall': 0.9775064, 'specificity': 0.9775064, 'f1': 0.97721136, 'auroc': 0.99829495, 'binary_precision': 1.0, 'binary_recall': 0.95501286, 'binary_specificity': 1.0, 'binary_f1_score': 0.97698885}
confusion matrix:
      0     1
0  1516     0
1    70  1486
---- Validation: 
scalar performance:
{'acc': 0.6552795, 'precision': 0.76883227, 'recall': 0.6506759, 'specificity': 0.6506759, 'f1': 0.61066633, 'auroc': 0.88874364, 'binary_precision': 0.94009215, 'binary_recall': 0.32125986, 'binary_specificity': 0.98009187, 'binary_f1_score': 0.47887325}
confusion matrix:
     0    1
0  640   13
1  431  204
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6883721, 'precision': 0.80233324, 'recall': 0.6883721, 'specificity': 0.6883721, 'f1': 0.65595067, 'auroc': 0.88601404, 'binary_precision': 0.9879518, 'binary_recall': 0.38139534, 'binary_specificity': 0.9953488, 'binary_f1_score': 0.5503356}
confusion matrix:
     0   1
0  214   1
1  133  82
early stop counter: 10
val acc:0.6552795171737671, best validation acc: 0.861801266670227, corresponding to test acc:                         0.8581395149230957 / 0.8581395149230957
after epoch: 12,now: 2024-07-23 05:21:18.911423,epoch time: 0:01:14.198638,used: 0:14:53.891547,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_05_06_24_seed_0_22779259
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9840495, 'precision': 0.9843136, 'recall': 0.984246, 'specificity': 0.984246, 'f1': 0.98404944, 'auroc': 0.9992844, 'binary_precision': 0.9993373, 'binary_recall': 0.9691517, 'binary_specificity': 0.99934036, 'binary_f1_score': 0.9840131}
confusion matrix:
      0     1
0  1515     1
1    48  1508
---- Validation: 
scalar performance:
{'acc': 0.61878884, 'precision': 0.7555442, 'recall': 0.6136029, 'specificity': 0.6136029, 'f1': 0.5545867, 'auroc': 0.85681105, 'binary_precision': 0.9390244, 'binary_recall': 0.24251969, 'binary_specificity': 0.9846861, 'binary_f1_score': 0.38548186}
confusion matrix:
     0    1
0  643   10
1  481  154
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8, 'precision': 0.8403151, 'recall': 0.8, 'specificity': 0.8, 'f1': 0.79389596, 'auroc': 0.8999892, 'binary_precision': 0.9574468, 'binary_recall': 0.627907, 'binary_specificity': 0.97209305, 'binary_f1_score': 0.7584269}
confusion matrix:
     0    1
0  209    6
1   80  135
early stop counter: 11
val acc:0.6187888383865356, best validation acc: 0.861801266670227, corresponding to test acc:                         0.8581395149230957 / 0.8581395149230957
after epoch: 13,now: 2024-07-23 05:22:33.220115,epoch time: 0:01:14.308692,used: 0:16:08.200239,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_05_06_24_seed_0_22779259
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9814453, 'precision': 0.98155487, 'recall': 0.9815905, 'specificity': 0.9815905, 'f1': 0.98144525, 'auroc': 0.9988503, 'binary_precision': 0.99276793, 'binary_recall': 0.970437, 'binary_specificity': 0.9927441, 'binary_f1_score': 0.9814755}
confusion matrix:
      0     1
0  1505    11
1    46  1510
---- Validation: 
scalar performance:
{'acc': 0.8501553, 'precision': 0.85982317, 'recall': 0.8490082, 'specificity': 0.8490082, 'f1': 0.84882104, 'auroc': 0.92613375, 'binary_precision': 0.91541356, 'binary_recall': 0.76692915, 'binary_specificity': 0.9310873, 'binary_f1_score': 0.8346187}
confusion matrix:
     0    1
0  608   45
1  148  487
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8465116, 'precision': 0.8576852, 'recall': 0.8465116, 'specificity': 0.8465116, 'f1': 0.8453035, 'auroc': 0.9140508, 'binary_precision': 0.920904, 'binary_recall': 0.75813955, 'binary_specificity': 0.9348837, 'binary_f1_score': 0.8316326}
confusion matrix:
     0    1
0  201   14
1   52  163
early stop counter: 12
val acc:0.8501552939414978, best validation acc: 0.861801266670227, corresponding to test acc:                         0.8581395149230957 / 0.8581395149230957
after epoch: 14,now: 2024-07-23 05:23:47.532732,epoch time: 0:01:14.312617,used: 0:17:22.512856,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_05_06_24_seed_0_22779259
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9863281, 'precision': 0.986307, 'recall': 0.98638785, 'specificity': 0.98638785, 'f1': 0.98632693, 'auroc': 0.99912035, 'binary_precision': 0.99092674, 'binary_recall': 0.9820167, 'binary_specificity': 0.9907591, 'binary_f1_score': 0.98645157}
confusion matrix:
      0     1
0  1501    14
1    28  1529
---- Validation: 
scalar performance:
{'acc': 0.76397514, 'precision': 0.79649353, 'recall': 0.7616283, 'specificity': 0.7616283, 'f1': 0.75620097, 'auroc': 0.88478136, 'binary_precision': 0.89125293, 'binary_recall': 0.59370077, 'binary_specificity': 0.9295559, 'binary_f1_score': 0.71266544}
confusion matrix:
     0    1
0  607   46
1  258  377
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.83023256, 'precision': 0.83405554, 'recall': 0.83023256, 'specificity': 0.83023256, 'f1': 0.8297455, 'auroc': 0.8952948, 'binary_precision': 0.8697917, 'binary_recall': 0.7767442, 'binary_specificity': 0.88372093, 'binary_f1_score': 0.82063884}
confusion matrix:
     0    1
0  190   25
1   48  167
early stop counter: 13
val acc:0.7639751434326172, best validation acc: 0.861801266670227, corresponding to test acc:                         0.8581395149230957 / 0.8581395149230957
after epoch: 15,now: 2024-07-23 05:25:01.074850,epoch time: 0:01:13.542118,used: 0:18:36.054974,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_05_06_24_seed_0_22779259
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9899089, 'precision': 0.9900632, 'recall': 0.9898224, 'specificity': 0.9898224, 'f1': 0.9899049, 'auroc': 0.9995965, 'binary_precision': 0.98413706, 'binary_recall': 0.99614644, 'binary_specificity': 0.98349833, 'binary_f1_score': 0.99010533}
confusion matrix:
      0     1
0  1490    25
1     6  1551
---- Validation: 
scalar performance:
{'acc': 0.8586956, 'precision': 0.8605627, 'recall': 0.85819054, 'specificity': 0.85819054, 'f1': 0.8583675, 'auroc': 0.9207076, 'binary_precision': 0.88324875, 'binary_recall': 0.82204723, 'binary_specificity': 0.89433384, 'binary_f1_score': 0.85154974}
confusion matrix:
     0    1
0  584   69
1  113  522
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8534884, 'precision': 0.8552174, 'recall': 0.8534883, 'specificity': 0.8534883, 'f1': 0.85330987, 'auroc': 0.9246728, 'binary_precision': 0.88, 'binary_recall': 0.81860465, 'binary_specificity': 0.88837206, 'binary_f1_score': 0.8481928}
confusion matrix:
     0    1
0  191   24
1   39  176
early stop counter: 14
val acc:0.8586956262588501, best validation acc: 0.861801266670227, corresponding to test acc:                         0.8581395149230957 / 0.8581395149230957
after epoch: 16,now: 2024-07-23 05:26:15.239642,epoch time: 0:01:14.164792,used: 0:19:50.219766,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_05_06_24_seed_0_22779259
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9889323, 'precision': 0.9889306, 'recall': 0.9889306, 'specificity': 0.9889306, 'f1': 0.9889306, 'auroc': 0.99938744, 'binary_precision': 0.9890675, 'binary_recall': 0.9890675, 'binary_specificity': 0.9887937, 'binary_f1_score': 0.9890675}
confusion matrix:
      0     1
0  1500    17
1    17  1538
---- Validation: 
scalar performance:
{'acc': 0.7911491, 'precision': 0.79249185, 'recall': 0.7906416, 'specificity': 0.7906416, 'f1': 0.7906795, 'auroc': 0.86957526, 'binary_precision': 0.8091216, 'binary_recall': 0.7543307, 'binary_specificity': 0.8269525, 'binary_f1_score': 0.78076607}
confusion matrix:
     0    1
0  540  113
1  156  479
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.82790697, 'precision': 0.82793534, 'recall': 0.82790697, 'specificity': 0.82790697, 'f1': 0.8279033, 'auroc': 0.898821, 'binary_precision': 0.8309859, 'binary_recall': 0.82325584, 'binary_specificity': 0.83255816, 'binary_f1_score': 0.8271028}
confusion matrix:
     0    1
0  179   36
1   38  177
early stop counter: 15
val acc:0.7911490797996521, best validation acc: 0.861801266670227, corresponding to test acc:                         0.8581395149230957 / 0.8581395149230957
after epoch: 17,now: 2024-07-23 05:27:28.813236,epoch time: 0:01:13.573594,used: 0:21:03.793360,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_05_06_24_seed_0_22779259
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9785156, 'precision': 0.9790952, 'recall': 0.97878325, 'specificity': 0.97878325, 'f1': 0.97851425, 'auroc': 0.9992933, 'binary_precision': 0.99932975, 'binary_recall': 0.9582262, 'binary_specificity': 0.99934036, 'binary_f1_score': 0.9783464}
confusion matrix:
      0     1
0  1515     1
1    65  1491
---- Validation: 
scalar performance:
{'acc': 0.5341615, 'precision': 0.71413094, 'recall': 0.5276459, 'specificity': 0.5276459, 'f1': 0.399461, 'auroc': 0.8768488, 'binary_precision': 0.90697676, 'binary_recall': 0.061417323, 'binary_specificity': 0.99387443, 'binary_f1_score': 0.11504424}
confusion matrix:
     0   1
0  649   4
1  596  39
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5627907, 'precision': 0.7667494, 'recall': 0.5627907, 'specificity': 0.5627907, 'f1': 0.4594667, 'auroc': 0.8912493, 'binary_precision': 1.0, 'binary_recall': 0.1255814, 'binary_specificity': 1.0, 'binary_f1_score': 0.22314051}
confusion matrix:
     0   1
0  215   0
1  188  27
early stop counter: 16
val acc:0.5341615080833435, best validation acc: 0.861801266670227, corresponding to test acc:                         0.8581395149230957 / 0.8581395149230957
after epoch: 18,now: 2024-07-23 05:28:41.743733,epoch time: 0:01:12.930497,used: 0:22:16.723857,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_05_06_24_seed_0_22779259
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9892578, 'precision': 0.9893784, 'recall': 0.9891915, 'specificity': 0.9891915, 'f1': 0.9892546, 'auroc': 0.9997058, 'binary_precision': 0.9840866, 'binary_recall': 0.994852, 'binary_specificity': 0.98353094, 'binary_f1_score': 0.98943996}
confusion matrix:
      0     1
0  1493    25
1     8  1546
---- Validation: 
scalar performance:
{'acc': 0.8113354, 'precision': 0.83876073, 'recall': 0.8093343, 'specificity': 0.8093343, 'f1': 0.80672157, 'auroc': 0.9209777, 'binary_precision': 0.93171805, 'binary_recall': 0.66614175, 'binary_specificity': 0.9525268, 'binary_f1_score': 0.7768595}
confusion matrix:
     0    1
0  622   31
1  212  423
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8395349, 'precision': 0.8736905, 'recall': 0.8395349, 'specificity': 0.8395349, 'f1': 0.8357825, 'auroc': 0.92943215, 'binary_precision': 0.9866667, 'binary_recall': 0.6883721, 'binary_specificity': 0.9906977, 'binary_f1_score': 0.81095886}
confusion matrix:
     0    1
0  213    2
1   67  148
early stop counter: 17
val acc:0.8113353848457336, best validation acc: 0.861801266670227, corresponding to test acc:                         0.8581395149230957 / 0.8581395149230957
after epoch: 19,now: 2024-07-23 05:29:54.219262,epoch time: 0:01:12.475529,used: 0:23:29.199386,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_05_06_24_seed_0_22779259
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9902344, 'precision': 0.99021876, 'recall': 0.99025035, 'specificity': 0.99025035, 'f1': 0.9902328, 'auroc': 0.9993802, 'binary_precision': 0.9916291, 'binary_recall': 0.98908156, 'binary_specificity': 0.99141914, 'binary_f1_score': 0.99035364}
confusion matrix:
      0     1
0  1502    13
1    17  1540
---- Validation: 
scalar performance:
{'acc': 0.7468944, 'precision': 0.8011883, 'recall': 0.74389315, 'specificity': 0.74389315, 'f1': 0.73337805, 'auroc': 0.9003172, 'binary_precision': 0.92561984, 'binary_recall': 0.52913386, 'binary_specificity': 0.9586524, 'binary_f1_score': 0.6733467}
confusion matrix:
     0    1
0  626   27
1  299  336
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.86744183, 'precision': 0.88934994, 'recall': 0.8674419, 'specificity': 0.8674419, 'f1': 0.8655505, 'auroc': 0.9406382, 'binary_precision': 0.98170733, 'binary_recall': 0.74883723, 'binary_specificity': 0.9860465, 'binary_f1_score': 0.84960425}
confusion matrix:
     0    1
0  212    3
1   54  161
new oracle model saved
early stop counter: 18
val acc:0.7468944191932678, best validation acc: 0.861801266670227, corresponding to test acc:                         0.8581395149230957 / 0.8674418330192566
after epoch: 20,now: 2024-07-23 05:31:07.114265,epoch time: 0:01:12.895003,used: 0:24:42.094389,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_05_06_24_seed_0_22779259
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.991862, 'precision': 0.99188143, 'recall': 0.9919534, 'specificity': 0.9919534, 'f1': 0.9918618, 'auroc': 0.99942935, 'binary_precision': 0.99934727, 'binary_recall': 0.9845659, 'binary_specificity': 0.99934083, 'binary_f1_score': 0.9919015}
confusion matrix:
      0     1
0  1516     1
1    24  1531
---- Validation: 
scalar performance:
{'acc': 0.78571427, 'precision': 0.8161296, 'recall': 0.7835237, 'specificity': 0.7835237, 'f1': 0.7795133, 'auroc': 0.90716136, 'binary_precision': 0.91075516, 'binary_recall': 0.6267716, 'binary_specificity': 0.94027567, 'binary_f1_score': 0.74253726}
confusion matrix:
     0    1
0  614   39
1  237  398
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.83023256, 'precision': 0.85519826, 'recall': 0.8302325, 'specificity': 0.8302325, 'f1': 0.82719606, 'auroc': 0.91106546, 'binary_precision': 0.9493671, 'binary_recall': 0.6976744, 'binary_specificity': 0.96279067, 'binary_f1_score': 0.80428946}
confusion matrix:
     0    1
0  207    8
1   65  150
early stop counter: 19
val acc:0.7857142686843872, best validation acc: 0.861801266670227, corresponding to test acc:                         0.8581395149230957 / 0.8674418330192566
after epoch: 21,now: 2024-07-23 05:32:20.031361,epoch time: 0:01:12.917096,used: 0:25:55.011485,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_05_06_24_seed_0_22779259
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9889323, 'precision': 0.988979, 'recall': 0.9888927, 'specificity': 0.9888927, 'f1': 0.98892915, 'auroc': 0.9996702, 'binary_precision': 0.98659, 'binary_recall': 0.99165595, 'binary_specificity': 0.98612946, 'binary_f1_score': 0.9891165}
confusion matrix:
      0     1
0  1493    21
1    13  1545
---- Validation: 
scalar performance:
{'acc': 0.8152174, 'precision': 0.82817376, 'recall': 0.8138139, 'specificity': 0.8138139, 'f1': 0.8128785, 'auroc': 0.8977126, 'binary_precision': 0.8899804, 'binary_recall': 0.7133858, 'binary_specificity': 0.91424197, 'binary_f1_score': 0.7919581}
confusion matrix:
     0    1
0  597   56
1  182  453
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.83023256, 'precision': 0.8310993, 'recall': 0.83023256, 'specificity': 0.83023256, 'f1': 0.8301214, 'auroc': 0.9071065, 'binary_precision': 0.8480392, 'binary_recall': 0.80465114, 'binary_specificity': 0.855814, 'binary_f1_score': 0.8257756}
confusion matrix:
     0    1
0  184   31
1   42  173
early stop counter: 20
val acc:0.8152173757553101, best validation acc: 0.861801266670227, corresponding to test acc:                         0.8581395149230957 / 0.8674418330192566
after epoch: 22,now: 2024-07-23 05:33:33.010181,epoch time: 0:01:12.978820,used: 0:27:07.990305,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_05_06_24_seed_0_22779259
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.9895833, 'precision': 0.9895653, 'recall': 0.98963004, 'specificity': 0.98963004, 'f1': 0.98958254, 'auroc': 0.9994668, 'binary_precision': 0.9935191, 'binary_recall': 0.98585206, 'binary_specificity': 0.993408, 'binary_f1_score': 0.98967075}
confusion matrix:
      0     1
0  1507    10
1    22  1533
---- Validation: 
scalar performance:
{'acc': 0.8043478, 'precision': 0.8447139, 'recall': 0.8019438, 'specificity': 0.8019438, 'f1': 0.7975509, 'auroc': 0.92651725, 'binary_precision': 0.9592326, 'binary_recall': 0.62992126, 'binary_specificity': 0.9739663, 'binary_f1_score': 0.76045626}
confusion matrix:
     0    1
0  636   17
1  235  400
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.81860465, 'precision': 0.8668942, 'recall': 0.81860465, 'specificity': 0.81860465, 'f1': 0.8124329, 'auroc': 0.91632235, 'binary_precision': 1.0, 'binary_recall': 0.6372093, 'binary_specificity': 1.0, 'binary_f1_score': 0.77840906}
confusion matrix:
     0    1
0  215    0
1   78  137
early stop counter: 21
val acc:0.804347813129425, best validation acc: 0.861801266670227, corresponding to test acc:                         0.8581395149230957 / 0.8674418330192566
after epoch: 23,now: 2024-07-23 05:34:45.938947,epoch time: 0:01:12.928766,used: 0:28:20.919071,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_05_06_24_seed_0_22779259
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9860026, 'precision': 0.9862014, 'recall': 0.9859027, 'specificity': 0.9859027, 'f1': 0.9859967, 'auroc': 0.9995456, 'binary_precision': 0.9791007, 'binary_recall': 0.99357325, 'binary_specificity': 0.9782322, 'binary_f1_score': 0.9862839}
confusion matrix:
      0     1
0  1483    33
1    10  1546
---- Validation: 
scalar performance:
{'acc': 0.88975155, 'precision': 0.89117324, 'recall': 0.8893393, 'specificity': 0.8893393, 'f1': 0.8895574, 'auroc': 0.93578273, 'binary_precision': 0.91151917, 'binary_recall': 0.85984254, 'binary_specificity': 0.9188361, 'binary_f1_score': 0.88492703}
confusion matrix:
     0    1
0  600   53
1   89  546
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.88139534, 'precision': 0.89437187, 'recall': 0.88139534, 'specificity': 0.88139534, 'f1': 0.8804116, 'auroc': 0.92605734, 'binary_precision': 0.96590906, 'binary_recall': 0.7906977, 'binary_specificity': 0.97209305, 'binary_f1_score': 0.8695652}
confusion matrix:
     0    1
0  209    6
1   45  170
new oracle model saved
better model found
persisted
after epoch: 24,now: 2024-07-23 05:35:59.446031,epoch time: 0:01:13.507084,used: 0:29:34.426155,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_05_06_24_seed_0_22779259
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.9899089, 'precision': 0.98997414, 'recall': 0.99004495, 'specificity': 0.99004495, 'f1': 0.98990875, 'auroc': 0.9999199, 'binary_precision': 1.0, 'binary_recall': 0.9800899, 'binary_specificity': 1.0, 'binary_f1_score': 0.9899449}
confusion matrix:
      0     1
0  1515     0
1    31  1526
---- Validation: 
scalar performance:
{'acc': 0.6125776, 'precision': 0.7604979, 'recall': 0.60723853, 'specificity': 0.60723853, 'f1': 0.54285794, 'auroc': 0.88283634, 'binary_precision': 0.9533333, 'binary_recall': 0.22519685, 'binary_specificity': 0.9892802, 'binary_f1_score': 0.3643312}
confusion matrix:
     0    1
0  646    7
1  492  143
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.60930234, 'precision': 0.78067887, 'recall': 0.60930234, 'specificity': 0.60930234, 'f1': 0.53892106, 'auroc': 0.9156301, 'binary_precision': 1.0, 'binary_recall': 0.21860465, 'binary_specificity': 1.0, 'binary_f1_score': 0.35877863}
confusion matrix:
     0   1
0  215   0
1  168  47
early stop counter: 1
val acc:0.6125776171684265, best validation acc: 0.8897515535354614, corresponding to test acc:                         0.8813953399658203 / 0.8813953399658203
after epoch: 25,now: 2024-07-23 05:37:12.559350,epoch time: 0:01:13.113319,used: 0:30:47.539474,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_05_06_24_seed_0_22779259
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.99088544, 'precision': 0.99090195, 'recall': 0.9910101, 'specificity': 0.9910101, 'f1': 0.990885, 'auroc': 0.99964297, 'binary_precision': 0.9993477, 'binary_recall': 0.9826812, 'binary_specificity': 0.99933904, 'binary_f1_score': 0.9909444}
confusion matrix:
      0     1
0  1512     1
1    27  1532
---- Validation: 
scalar performance:
{'acc': 0.5830745, 'precision': 0.7434099, 'recall': 0.5773173, 'specificity': 0.5773173, 'f1': 0.4937607, 'auroc': 0.90643907, 'binary_precision': 0.9375, 'binary_recall': 0.16535433, 'binary_specificity': 0.9892802, 'binary_f1_score': 0.2811245}
confusion matrix:
     0    1
0  646    7
1  530  105
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.627907, 'precision': 0.78666663, 'recall': 0.627907, 'specificity': 0.627907, 'f1': 0.56811047, 'auroc': 0.9106544, 'binary_precision': 1.0, 'binary_recall': 0.25581396, 'binary_specificity': 1.0, 'binary_f1_score': 0.4074074}
confusion matrix:
     0   1
0  215   0
1  160  55
early stop counter: 2
val acc:0.5830745100975037, best validation acc: 0.8897515535354614, corresponding to test acc:                         0.8813953399658203 / 0.8813953399658203
after epoch: 26,now: 2024-07-23 05:38:25.504381,epoch time: 0:01:12.945031,used: 0:32:00.484505,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_05_06_24_seed_0_22779259
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.99153644, 'precision': 0.99152875, 'recall': 0.99154294, 'specificity': 0.99154294, 'f1': 0.9915354, 'auroc': 0.99976766, 'binary_precision': 0.992268, 'binary_recall': 0.990991, 'binary_specificity': 0.9920949, 'binary_f1_score': 0.9916291}
confusion matrix:
      0     1
0  1506    12
1    14  1540
---- Validation: 
scalar performance:
{'acc': 0.70263976, 'precision': 0.7890621, 'recall': 0.6987725, 'specificity': 0.6987725, 'f1': 0.676051, 'auroc': 0.8899549, 'binary_precision': 0.943662, 'binary_recall': 0.42204726, 'binary_specificity': 0.9754977, 'binary_f1_score': 0.58324265}
confusion matrix:
     0    1
0  637   16
1  367  268
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.67906976, 'precision': 0.7985142, 'recall': 0.67906976, 'specificity': 0.67906976, 'f1': 0.643398, 'auroc': 0.87113035, 'binary_precision': 0.98734176, 'binary_recall': 0.3627907, 'binary_specificity': 0.9953488, 'binary_f1_score': 0.53061223}
confusion matrix:
     0   1
0  214   1
1  137  78
early stop counter: 3
val acc:0.7026397585868835, best validation acc: 0.8897515535354614, corresponding to test acc:                         0.8813953399658203 / 0.8813953399658203
after epoch: 27,now: 2024-07-23 05:39:38.530723,epoch time: 0:01:13.026342,used: 0:33:13.510847,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_05_06_24_seed_0_22779259
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.99153644, 'precision': 0.9916924, 'recall': 0.991459, 'specificity': 0.991459, 'f1': 0.99153364, 'auroc': 0.99992883, 'binary_precision': 0.98538756, 'binary_recall': 0.9980695, 'binary_specificity': 0.9848485, 'binary_f1_score': 0.991688}
confusion matrix:
      0     1
0  1495    23
1     3  1551
---- Validation: 
scalar performance:
{'acc': 0.8920807, 'precision': 0.8965132, 'recall': 0.89135426, 'specificity': 0.89135426, 'f1': 0.89163077, 'auroc': 0.9456078, 'binary_precision': 0.93508774, 'binary_recall': 0.8393701, 'binary_specificity': 0.94333845, 'binary_f1_score': 0.8846473}
confusion matrix:
     0    1
0  616   37
1  102  533
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.82790697, 'precision': 0.8667877, 'recall': 0.82790697, 'specificity': 0.82790697, 'f1': 0.82322216, 'auroc': 0.9140941, 'binary_precision': 0.9862069, 'binary_recall': 0.66511625, 'binary_specificity': 0.9906977, 'binary_f1_score': 0.79444444}
confusion matrix:
     0    1
0  213    2
1   72  143
better model found
persisted
after epoch: 28,now: 2024-07-23 05:40:51.853908,epoch time: 0:01:13.323185,used: 0:34:26.834032,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_05_06_24_seed_0_22779259
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.99088544, 'precision': 0.99093264, 'recall': 0.99100256, 'specificity': 0.99100256, 'f1': 0.99088526, 'auroc': 0.99982965, 'binary_precision': 1.0, 'binary_recall': 0.9820051, 'binary_specificity': 1.0, 'binary_f1_score': 0.99092084}
confusion matrix:
      0     1
0  1516     0
1    28  1528
---- Validation: 
scalar performance:
{'acc': 0.68944097, 'precision': 0.78668296, 'recall': 0.6853215, 'specificity': 0.6853215, 'f1': 0.6577381, 'auroc': 0.91800594, 'binary_precision': 0.95019156, 'binary_recall': 0.39055118, 'binary_specificity': 0.98009187, 'binary_f1_score': 0.5535714}
confusion matrix:
     0    1
0  640   13
1  387  248
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.67906976, 'precision': 0.7985142, 'recall': 0.67906976, 'specificity': 0.67906976, 'f1': 0.643398, 'auroc': 0.9101947, 'binary_precision': 0.98734176, 'binary_recall': 0.3627907, 'binary_specificity': 0.9953488, 'binary_f1_score': 0.53061223}
confusion matrix:
     0   1
0  214   1
1  137  78
early stop counter: 1
val acc:0.6894409656524658, best validation acc: 0.8920807242393494, corresponding to test acc:                         0.8279069662094116 / 0.8813953399658203
after epoch: 29,now: 2024-07-23 05:42:04.964330,epoch time: 0:01:13.110422,used: 0:35:39.944454,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_05_06_24_seed_0_22779259
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.9902344, 'precision': 0.9902618, 'recall': 0.9903483, 'specificity': 0.9903483, 'f1': 0.99023414, 'auroc': 0.9997159, 'binary_precision': 0.99869365, 'binary_recall': 0.9820167, 'binary_specificity': 0.9986799, 'binary_f1_score': 0.990285}
confusion matrix:
      0     1
0  1513     2
1    28  1529
---- Validation: 
scalar performance:
{'acc': 0.65217394, 'precision': 0.77753055, 'recall': 0.6474177, 'specificity': 0.6474177, 'f1': 0.6038131, 'auroc': 0.9116591, 'binary_precision': 0.96059114, 'binary_recall': 0.30708662, 'binary_specificity': 0.98774886, 'binary_f1_score': 0.46539375}
confusion matrix:
     0    1
0  645    8
1  440  195
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.66976744, 'precision': 0.80112046, 'recall': 0.66976744, 'specificity': 0.66976744, 'f1': 0.6293464, 'auroc': 0.9009681, 'binary_precision': 1.0, 'binary_recall': 0.33953488, 'binary_specificity': 1.0, 'binary_f1_score': 0.5069444}
confusion matrix:
     0   1
0  215   0
1  142  73
early stop counter: 2
val acc:0.6521739363670349, best validation acc: 0.8920807242393494, corresponding to test acc:                         0.8279069662094116 / 0.8813953399658203
after epoch: 30,now: 2024-07-23 05:43:17.949122,epoch time: 0:01:12.984792,used: 0:36:52.929246,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_05_06_24_seed_0_22779259
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 0:36:52.929246 at 2024-07-23 05:43:17.949122
persisted model performance metric: 

scalar performance:
{'acc': 0.82790697, 'precision': 0.8667877, 'recall': 0.82790697, 'specificity': 0.82790697, 'f1': 0.82322216, 'auroc': 0.9140941, 'binary_precision': 0.9862069, 'binary_recall': 0.66511625, 'binary_specificity': 0.9906977, 'binary_f1_score': 0.79444444}
confusion matrix:
     0    1
0  213    2
1   72  143
oracle model performance metric: 

scalar performance:
{'acc': 0.88139534, 'precision': 0.89437187, 'recall': 0.88139534, 'specificity': 0.88139534, 'f1': 0.8804116, 'auroc': 0.92605734, 'binary_precision': 0.96590906, 'binary_recall': 0.7906977, 'binary_specificity': 0.97209305, 'binary_f1_score': 0.8695652}
confusion matrix:
     0    1
0  209    6
1   45  170
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_dial_lr1e5_bs32_nofreeze_2024-07-23_01-16-41/rule_results/3.csv
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_dial_lr1e5_bs32_nofreeze_2024-07-23_01-16-41/rule_results/3.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_dial_lr1e5_bs32_nofreeze_2024-07-23_01-16-41/confusion_matrix/3.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 455936 KiB |  26075 MiB |  70808 GiB |  70808 GiB |
|       from large pool | 415383 KiB |  26030 MiB |  70366 GiB |  70365 GiB |
|       from small pool |  40553 KiB |     56 MiB |    442 GiB |    442 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 455936 KiB |  26075 MiB |  70808 GiB |  70808 GiB |
|       from large pool | 415383 KiB |  26030 MiB |  70366 GiB |  70365 GiB |
|       from small pool |  40553 KiB |     56 MiB |    442 GiB |    442 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 447480 KiB |  26071 MiB |  70793 GiB |  70793 GiB |
|       from large pool | 407075 KiB |  26026 MiB |  70352 GiB |  70351 GiB |
|       from small pool |  40405 KiB |     56 MiB |    441 GiB |    441 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  27748 MiB |  27748 MiB |  27748 MiB |      0 B   |
|       from large pool |  27680 MiB |  27680 MiB |  27680 MiB |      0 B   |
|       from small pool |     68 MiB |     68 MiB |     68 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |    770 MiB |   1678 MiB |  33155 GiB |  33154 GiB |
|       from large pool |    752 MiB |   1668 MiB |  32711 GiB |  32710 GiB |
|       from small pool |     18 MiB |     19 MiB |    444 GiB |    444 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    1220    |    2568    |    6428 K  |    6427 K  |
|       from large pool |     187    |    1413    |    3247 K  |    3247 K  |
|       from small pool |    1033    |    1329    |    3180 K  |    3179 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    1220    |    2568    |    6428 K  |    6427 K  |
|       from large pool |     187    |    1413    |    3247 K  |    3247 K  |
|       from small pool |    1033    |    1329    |    3180 K  |    3179 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     834    |     834    |     834    |       0    |
|       from large pool |     800    |     800    |     800    |       0    |
|       from small pool |      34    |      34    |      34    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     107    |     853    |    4733 K  |    4733 K  |
|       from large pool |      39    |     799    |    2905 K  |    2905 K  |
|       from small pool |      68    |     146    |    1828 K  |    1828 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  26075 MiB |  70808 GiB |  70808 GiB |
|       from large pool |  16640 KiB |  26030 MiB |  70366 GiB |  70366 GiB |
|       from small pool |      0 KiB |     56 MiB |    442 GiB |    442 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  26075 MiB |  70808 GiB |  70808 GiB |
|       from large pool |  16640 KiB |  26030 MiB |  70366 GiB |  70366 GiB |
|       from small pool |      0 KiB |     56 MiB |    442 GiB |    442 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  26071 MiB |  70793 GiB |  70793 GiB |
|       from large pool |  16640 KiB |  26026 MiB |  70352 GiB |  70352 GiB |
|       from small pool |      0 KiB |     56 MiB |    441 GiB |    441 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1216 MiB |  27748 MiB |  27748 MiB |  26532 MiB |
|       from large pool |   1158 MiB |  27680 MiB |  27680 MiB |  26522 MiB |
|       from small pool |     58 MiB |     68 MiB |     68 MiB |     10 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |   3840 KiB |   1678 MiB |  33156 GiB |  33156 GiB |
|       from large pool |   3840 KiB |   1668 MiB |  32711 GiB |  32711 GiB |
|       from small pool |      0 KiB |     31 MiB |    444 GiB |    444 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    2568    |    6428 K  |    6428 K  |
|       from large pool |       2    |    1413    |    3247 K  |    3247 K  |
|       from small pool |       0    |    1329    |    3180 K  |    3180 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    2568    |    6428 K  |    6428 K  |
|       from large pool |       2    |    1413    |    3247 K  |    3247 K  |
|       from small pool |       0    |    1329    |    3180 K  |    3180 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      68    |     834    |     834    |     766    |
|       from large pool |      39    |     800    |     800    |     761    |
|       from small pool |      29    |      34    |      34    |       5    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       1    |     853    |    4733 K  |    4733 K  |
|       from large pool |       1    |     799    |    2905 K  |    2905 K  |
|       from small pool |       0    |     146    |    1828 K  |    1828 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  26075 MiB |  70808 GiB |  70808 GiB |
|       from large pool |  16640 KiB |  26030 MiB |  70366 GiB |  70366 GiB |
|       from small pool |      0 KiB |     56 MiB |    442 GiB |    442 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  26075 MiB |  70808 GiB |  70808 GiB |
|       from large pool |  16640 KiB |  26030 MiB |  70366 GiB |  70366 GiB |
|       from small pool |      0 KiB |     56 MiB |    442 GiB |    442 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  26071 MiB |  70793 GiB |  70793 GiB |
|       from large pool |  16640 KiB |  26026 MiB |  70352 GiB |  70352 GiB |
|       from small pool |      0 KiB |     56 MiB |    441 GiB |    441 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1216 MiB |  27748 MiB |  27748 MiB |  26532 MiB |
|       from large pool |   1158 MiB |  27680 MiB |  27680 MiB |  26522 MiB |
|       from small pool |     58 MiB |     68 MiB |     68 MiB |     10 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |   3840 KiB |   1678 MiB |  33156 GiB |  33156 GiB |
|       from large pool |   3840 KiB |   1668 MiB |  32711 GiB |  32711 GiB |
|       from small pool |      0 KiB |     31 MiB |    444 GiB |    444 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    2568    |    6428 K  |    6428 K  |
|       from large pool |       2    |    1413    |    3247 K  |    3247 K  |
|       from small pool |       0    |    1329    |    3180 K  |    3180 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    2568    |    6428 K  |    6428 K  |
|       from large pool |       2    |    1413    |    3247 K  |    3247 K  |
|       from small pool |       0    |    1329    |    3180 K  |    3180 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      68    |     834    |     834    |     766    |
|       from large pool |      39    |     800    |     800    |     761    |
|       from small pool |      29    |      34    |      34    |       5    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       1    |     853    |    4733 K  |    4733 K  |
|       from large pool |       1    |     799    |    2905 K  |    2905 K  |
|       from small pool |       0    |     146    |    1828 K  |    1828 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'888c1ef2'
model name: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_05_44_30_seed_1_22779259

 Experiment start at: 2024-07-23 05:44:30.575440
before training, model accuracy: 0.6177777647972107
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9423828, 'precision': 0.9432869, 'recall': 0.94270796, 'specificity': 0.94270796, 'f1': 0.9423735, 'auroc': 0.98351175, 'binary_precision': 0.96682465, 'binary_recall': 0.9177378, 'binary_specificity': 0.9676781, 'binary_f1_score': 0.94164187}
confusion matrix:
      0     1
0  1467    49
1   128  1428
---- Validation: 
scalar performance:
{'acc': 0.8181108, 'precision': 0.82006395, 'recall': 0.81874037, 'specificity': 0.81874037, 'f1': 0.8179973, 'auroc': 0.9054642, 'binary_precision': 0.79062957, 'binary_recall': 0.85714287, 'binary_specificity': 0.7803379, 'binary_f1_score': 0.8225438}
confusion matrix:
     0    1
0  508  143
1   90  540
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.82222223, 'precision': 0.8234746, 'recall': 0.82222223, 'specificity': 0.82222223, 'f1': 0.82205, 'auroc': 0.91223705, 'binary_precision': 0.8033473, 'binary_recall': 0.85333335, 'binary_specificity': 0.7911111, 'binary_f1_score': 0.82758623}
confusion matrix:
     0    1
0  178   47
1   33  192
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-23 05:45:48.507167,epoch time: 0:01:17.931727,used: 0:01:17.931727,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_05_44_30_seed_1_22779259
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.96191406, 'precision': 0.9624405, 'recall': 0.9621416, 'specificity': 0.9621416, 'f1': 0.96191156, 'auroc': 0.9922996, 'binary_precision': 0.9812458, 'binary_recall': 0.94272846, 'binary_specificity': 0.9815547, 'binary_f1_score': 0.96160156}
confusion matrix:
      0     1
0  1490    28
1    89  1465
---- Validation: 
scalar performance:
{'acc': 0.83528495, 'precision': 0.8372672, 'recall': 0.834639, 'specificity': 0.834639, 'f1': 0.83481944, 'auroc': 0.903533, 'binary_precision': 0.8593482, 'binary_recall': 0.7952381, 'binary_specificity': 0.87403995, 'binary_f1_score': 0.82605106}
confusion matrix:
     0    1
0  569   82
1  129  501
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.84444445, 'precision': 0.8444717, 'recall': 0.8444444, 'specificity': 0.8444444, 'f1': 0.84444135, 'auroc': 0.91466665, 'binary_precision': 0.84753364, 'binary_recall': 0.84, 'binary_specificity': 0.8488889, 'binary_f1_score': 0.84375}
confusion matrix:
     0    1
0  191   34
1   36  189
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-07-23 05:47:03.874947,epoch time: 0:01:15.367780,used: 0:02:33.299507,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_05_44_30_seed_1_22779259
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9710286, 'precision': 0.9716115, 'recall': 0.9713125, 'specificity': 0.9713125, 'f1': 0.971027, 'auroc': 0.9965818, 'binary_precision': 0.9919571, 'binary_recall': 0.9505459, 'binary_specificity': 0.9920792, 'binary_f1_score': 0.9708101}
confusion matrix:
      0     1
0  1503    12
1    77  1480
---- Validation: 
scalar performance:
{'acc': 0.8345043, 'precision': 0.84261394, 'recall': 0.833231, 'specificity': 0.833231, 'f1': 0.83311206, 'auroc': 0.90464246, 'binary_precision': 0.8913858, 'binary_recall': 0.75555557, 'binary_specificity': 0.9109063, 'binary_f1_score': 0.81786937}
confusion matrix:
     0    1
0  593   58
1  154  476
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8688889, 'precision': 0.87100685, 'recall': 0.8688889, 'specificity': 0.8688889, 'f1': 0.8687015, 'auroc': 0.9279605, 'binary_precision': 0.89903843, 'binary_recall': 0.83111113, 'binary_specificity': 0.9066667, 'binary_f1_score': 0.86374134}
confusion matrix:
     0    1
0  204   21
1   38  187
new oracle model saved
early stop counter: 1
val acc:0.8345043063163757, best validation acc: 0.835284948348999, corresponding to test acc:                         0.8444444537162781 / 0.8688889145851135
after epoch: 3,now: 2024-07-23 05:48:19.160975,epoch time: 0:01:15.286028,used: 0:03:48.585535,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_05_44_30_seed_1_22779259
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.976237, 'precision': 0.97630334, 'recall': 0.97634435, 'specificity': 0.97634435, 'f1': 0.9762369, 'auroc': 0.9972373, 'binary_precision': 0.98557377, 'binary_recall': 0.96718144, 'binary_specificity': 0.98550725, 'binary_f1_score': 0.976291}
confusion matrix:
      0     1
0  1496    22
1    51  1503
---- Validation: 
scalar performance:
{'acc': 0.8017174, 'precision': 0.82237977, 'recall': 0.799616, 'specificity': 0.799616, 'f1': 0.7976782, 'auroc': 0.8962281, 'binary_precision': 0.9, 'binary_recall': 0.67142856, 'binary_specificity': 0.9278034, 'binary_f1_score': 0.76909095}
confusion matrix:
     0    1
0  604   47
1  207  423
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8333333, 'precision': 0.84259784, 'recall': 0.8333333, 'specificity': 0.8333333, 'f1': 0.83219886, 'auroc': 0.90712106, 'binary_precision': 0.89893615, 'binary_recall': 0.7511111, 'binary_specificity': 0.91555554, 'binary_f1_score': 0.81840193}
confusion matrix:
     0    1
0  206   19
1   56  169
early stop counter: 2
val acc:0.8017174005508423, best validation acc: 0.835284948348999, corresponding to test acc:                         0.8444444537162781 / 0.8688889145851135
after epoch: 4,now: 2024-07-23 05:49:33.930156,epoch time: 0:01:14.769181,used: 0:05:03.354716,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_05_44_30_seed_1_22779259
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.98046875, 'precision': 0.98065203, 'recall': 0.98065203, 'specificity': 0.98065203, 'f1': 0.98046875, 'auroc': 0.9984051, 'binary_precision': 0.9940594, 'binary_recall': 0.9672447, 'binary_specificity': 0.9940594, 'binary_f1_score': 0.98046875}
confusion matrix:
      0     1
0  1506     9
1    51  1506
---- Validation: 
scalar performance:
{'acc': 0.78454334, 'precision': 0.81811965, 'recall': 0.78184843, 'specificity': 0.78184843, 'f1': 0.7775583, 'auroc': 0.8980104, 'binary_precision': 0.9174528, 'binary_recall': 0.6174603, 'binary_specificity': 0.94623655, 'binary_f1_score': 0.73814046}
confusion matrix:
     0    1
0  616   35
1  241  389
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8111111, 'precision': 0.8324468, 'recall': 0.8111111, 'specificity': 0.8111111, 'f1': 0.8080311, 'auroc': 0.9032889, 'binary_precision': 0.9166667, 'binary_recall': 0.6844444, 'binary_specificity': 0.93777776, 'binary_f1_score': 0.783715}
confusion matrix:
     0    1
0  211   14
1   71  154
early stop counter: 3
val acc:0.7845433354377747, best validation acc: 0.835284948348999, corresponding to test acc:                         0.8444444537162781 / 0.8688889145851135
after epoch: 5,now: 2024-07-23 05:50:49.276257,epoch time: 0:01:15.346101,used: 0:06:18.700817,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_05_44_30_seed_1_22779259
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.98339844, 'precision': 0.98339117, 'recall': 0.98346436, 'specificity': 0.98346436, 'f1': 0.98339766, 'auroc': 0.9982976, 'binary_precision': 0.9889467, 'binary_recall': 0.97813505, 'binary_specificity': 0.9887937, 'binary_f1_score': 0.98351115}
confusion matrix:
      0     1
0  1500    17
1    34  1521
---- Validation: 
scalar performance:
{'acc': 0.8196721, 'precision': 0.8360682, 'recall': 0.81784433, 'specificity': 0.81784433, 'f1': 0.8168143, 'auroc': 0.90124834, 'binary_precision': 0.90631366, 'binary_recall': 0.7063492, 'binary_specificity': 0.92933947, 'binary_f1_score': 0.793934}
confusion matrix:
     0    1
0  605   46
1  185  445
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8577778, 'precision': 0.8779658, 'recall': 0.85777783, 'specificity': 0.85777783, 'f1': 0.855853, 'auroc': 0.91510123, 'binary_precision': 0.9653179, 'binary_recall': 0.74222225, 'binary_specificity': 0.97333336, 'binary_f1_score': 0.839196}
confusion matrix:
     0    1
0  219    6
1   58  167
early stop counter: 4
val acc:0.8196721076965332, best validation acc: 0.835284948348999, corresponding to test acc:                         0.8444444537162781 / 0.8688889145851135
after epoch: 6,now: 2024-07-23 05:52:04.350207,epoch time: 0:01:15.073950,used: 0:07:33.774767,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_05_44_30_seed_1_22779259
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.98502606, 'precision': 0.98504627, 'recall': 0.98512524, 'specificity': 0.98512524, 'f1': 0.98502564, 'auroc': 0.9991008, 'binary_precision': 0.99281985, 'binary_recall': 0.9775064, 'binary_specificity': 0.9927441, 'binary_f1_score': 0.98510367}
confusion matrix:
      0     1
0  1505    11
1    35  1521
---- Validation: 
scalar performance:
{'acc': 0.86729115, 'precision': 0.86812854, 'recall': 0.8668971, 'specificity': 0.8668971, 'f1': 0.8670967, 'auroc': 0.91206694, 'binary_precision': 0.8820598, 'binary_recall': 0.8428571, 'binary_specificity': 0.89093703, 'binary_f1_score': 0.862013}
confusion matrix:
     0    1
0  580   71
1   99  531
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.84, 'precision': 0.84002686, 'recall': 0.84000003, 'specificity': 0.84000003, 'f1': 0.8399968, 'auroc': 0.91960496, 'binary_precision': 0.84304935, 'binary_recall': 0.83555555, 'binary_specificity': 0.84444445, 'binary_f1_score': 0.83928573}
confusion matrix:
     0    1
0  190   35
1   37  188
better model found
persisted
after epoch: 7,now: 2024-07-23 05:53:19.453560,epoch time: 0:01:15.103353,used: 0:08:48.878120,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_05_44_30_seed_1_22779259
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9866536, 'precision': 0.98671854, 'recall': 0.9866073, 'specificity': 0.9866073, 'f1': 0.9866502, 'auroc': 0.9993637, 'binary_precision': 0.9833972, 'binary_recall': 0.9903537, 'binary_specificity': 0.9828609, 'binary_f1_score': 0.9868632}
confusion matrix:
      0     1
0  1491    26
1    15  1540
---- Validation: 
scalar performance:
{'acc': 0.84933645, 'precision': 0.8494108, 'recall': 0.8491807, 'specificity': 0.8491807, 'f1': 0.8492538, 'auroc': 0.90488875, 'binary_precision': 0.8518519, 'binary_recall': 0.8396825, 'binary_specificity': 0.85867894, 'binary_f1_score': 0.8457234}
confusion matrix:
     0    1
0  559   92
1  101  529
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8333333, 'precision': 0.83572733, 'recall': 0.8333334, 'specificity': 0.8333334, 'f1': 0.8330357, 'auroc': 0.91932845, 'binary_precision': 0.80737704, 'binary_recall': 0.8755556, 'binary_specificity': 0.7911111, 'binary_f1_score': 0.84008527}
confusion matrix:
     0    1
0  178   47
1   28  197
early stop counter: 1
val acc:0.8493364453315735, best validation acc: 0.8672911524772644, corresponding to test acc:                         0.8399999737739563 / 0.8688889145851135
after epoch: 8,now: 2024-07-23 05:54:34.195961,epoch time: 0:01:14.742401,used: 0:10:03.620521,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_05_44_30_seed_1_22779259
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9827474, 'precision': 0.9830325, 'recall': 0.98296225, 'specificity': 0.98296225, 'f1': 0.9827473, 'auroc': 0.998322, 'binary_precision': 0.99867374, 'binary_recall': 0.9672447, 'binary_specificity': 0.9986799, 'binary_f1_score': 0.982708}
confusion matrix:
      0     1
0  1513     2
1    51  1506
---- Validation: 
scalar performance:
{'acc': 0.793911, 'precision': 0.82299614, 'recall': 0.79142344, 'specificity': 0.79142344, 'f1': 0.78816366, 'auroc': 0.9065931, 'binary_precision': 0.9159091, 'binary_recall': 0.63968253, 'binary_specificity': 0.94316435, 'binary_f1_score': 0.75327104}
confusion matrix:
     0    1
0  614   37
1  227  403
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8333333, 'precision': 0.8545168, 'recall': 0.8333334, 'specificity': 0.8333334, 'f1': 0.83080584, 'auroc': 0.9056001, 'binary_precision': 0.9411765, 'binary_recall': 0.7111111, 'binary_specificity': 0.95555556, 'binary_f1_score': 0.8101266}
confusion matrix:
     0    1
0  215   10
1   65  160
early stop counter: 2
val acc:0.7939109802246094, best validation acc: 0.8672911524772644, corresponding to test acc:                         0.8399999737739563 / 0.8688889145851135
after epoch: 9,now: 2024-07-23 05:55:49.374030,epoch time: 0:01:15.178069,used: 0:11:18.798590,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_05_44_30_seed_1_22779259
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.97298175, 'precision': 0.9738133, 'recall': 0.97324145, 'specificity': 0.97324145, 'f1': 0.9729774, 'auroc': 0.9983239, 'binary_precision': 0.9966216, 'binary_recall': 0.9497746, 'binary_specificity': 0.99670833, 'binary_f1_score': 0.9726344}
confusion matrix:
      0     1
0  1514     5
1    78  1475
---- Validation: 
scalar performance:
{'acc': 0.6752537, 'precision': 0.782915, 'recall': 0.67012286, 'specificity': 0.67012286, 'f1': 0.6371737, 'auroc': 0.8866408, 'binary_precision': 0.9533898, 'binary_recall': 0.35714287, 'binary_specificity': 0.9831029, 'binary_f1_score': 0.5196305}
confusion matrix:
     0    1
0  640   11
1  405  225
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.74222225, 'precision': 0.80803335, 'recall': 0.74222225, 'specificity': 0.74222225, 'f1': 0.7276768, 'auroc': 0.90012836, 'binary_precision': 0.9504132, 'binary_recall': 0.51111114, 'binary_specificity': 0.97333336, 'binary_f1_score': 0.6647399}
confusion matrix:
     0    1
0  219    6
1  110  115
early stop counter: 3
val acc:0.675253689289093, best validation acc: 0.8672911524772644, corresponding to test acc:                         0.8399999737739563 / 0.8688889145851135
after epoch: 10,now: 2024-07-23 05:57:04.242895,epoch time: 0:01:14.868865,used: 0:12:33.667455,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_05_44_30_seed_1_22779259
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9892578, 'precision': 0.98926026, 'recall': 0.98925173, 'specificity': 0.98925173, 'f1': 0.9892559, 'auroc': 0.99927294, 'binary_precision': 0.98908156, 'binary_recall': 0.98971725, 'binary_specificity': 0.9887863, 'binary_f1_score': 0.9893993}
confusion matrix:
      0     1
0  1499    17
1    16  1540
---- Validation: 
scalar performance:
{'acc': 0.8665105, 'precision': 0.8739276, 'recall': 0.865361, 'specificity': 0.865361, 'f1': 0.86555487, 'auroc': 0.9281666, 'binary_precision': 0.92265195, 'binary_recall': 0.7952381, 'binary_specificity': 0.9354839, 'binary_f1_score': 0.8542199}
confusion matrix:
     0    1
0  609   42
1  129  501
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8577778, 'precision': 0.87964535, 'recall': 0.8577778, 'specificity': 0.8577778, 'f1': 0.85569984, 'auroc': 0.9397926, 'binary_precision': 0.9707602, 'binary_recall': 0.73777777, 'binary_specificity': 0.9777778, 'binary_f1_score': 0.8383838}
confusion matrix:
     0    1
0  220    5
1   59  166
early stop counter: 4
val acc:0.8665105104446411, best validation acc: 0.8672911524772644, corresponding to test acc:                         0.8399999737739563 / 0.8688889145851135
after epoch: 11,now: 2024-07-23 05:58:19.083692,epoch time: 0:01:14.840797,used: 0:13:48.508252,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_05_44_30_seed_1_22779259
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9847005, 'precision': 0.98489827, 'recall': 0.9846004, 'specificity': 0.9846004, 'f1': 0.98469406, 'auroc': 0.9991759, 'binary_precision': 0.97783405, 'binary_recall': 0.99228793, 'binary_specificity': 0.9769129, 'binary_f1_score': 0.98500794}
confusion matrix:
      0     1
0  1481    35
1    12  1544
---- Validation: 
scalar performance:
{'acc': 0.852459, 'precision': 0.85474086, 'recall': 0.8531234, 'specificity': 0.8531234, 'f1': 0.852355, 'auroc': 0.91535854, 'binary_precision': 0.8218978, 'binary_recall': 0.89365077, 'binary_specificity': 0.812596, 'binary_f1_score': 0.8562738}
confusion matrix:
     0    1
0  529  122
1   67  563
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8155556, 'precision': 0.8287037, 'recall': 0.8155556, 'specificity': 0.8155556, 'f1': 0.81369245, 'auroc': 0.91616786, 'binary_precision': 0.76296294, 'binary_recall': 0.91555554, 'binary_specificity': 0.71555555, 'binary_f1_score': 0.8323232}
confusion matrix:
     0    1
0  161   64
1   19  206
early stop counter: 5
val acc:0.8524590134620667, best validation acc: 0.8672911524772644, corresponding to test acc:                         0.8399999737739563 / 0.8688889145851135
after epoch: 12,now: 2024-07-23 05:59:34.558383,epoch time: 0:01:15.474691,used: 0:15:03.982943,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_05_44_30_seed_1_22779259
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9889323, 'precision': 0.9889064, 'recall': 0.988986, 'specificity': 0.988986, 'f1': 0.98893106, 'auroc': 0.999236, 'binary_precision': 0.9928849, 'binary_recall': 0.9852375, 'binary_specificity': 0.9927345, 'binary_f1_score': 0.9890464}
confusion matrix:
      0     1
0  1503    11
1    23  1535
---- Validation: 
scalar performance:
{'acc': 0.76971114, 'precision': 0.8196459, 'recall': 0.7664362, 'specificity': 0.7664362, 'f1': 0.7588382, 'auroc': 0.91164994, 'binary_precision': 0.9419525, 'binary_recall': 0.56666666, 'binary_specificity': 0.96620584, 'binary_f1_score': 0.70763135}
confusion matrix:
     0    1
0  629   22
1  273  357
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8066667, 'precision': 0.85771894, 'recall': 0.8066667, 'specificity': 0.8066667, 'f1': 0.7995135, 'auroc': 0.9302124, 'binary_precision': 0.99285716, 'binary_recall': 0.61777776, 'binary_specificity': 0.9955556, 'binary_f1_score': 0.7616438}
confusion matrix:
     0    1
0  224    1
1   86  139
early stop counter: 6
val acc:0.7697111368179321, best validation acc: 0.8672911524772644, corresponding to test acc:                         0.8399999737739563 / 0.8688889145851135
after epoch: 13,now: 2024-07-23 06:00:49.494609,epoch time: 0:01:14.936226,used: 0:16:18.919169,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_05_44_30_seed_1_22779259
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9899089, 'precision': 0.9899208, 'recall': 0.9898952, 'specificity': 0.9898952, 'f1': 0.989907, 'auroc': 0.9993988, 'binary_precision': 0.9890886, 'binary_recall': 0.9909968, 'binary_specificity': 0.9887937, 'binary_f1_score': 0.99004173}
confusion matrix:
      0     1
0  1500    17
1    14  1541
---- Validation: 
scalar performance:
{'acc': 0.8579235, 'precision': 0.861178, 'recall': 0.85714287, 'specificity': 0.85714287, 'f1': 0.8573811, 'auroc': 0.9164387, 'binary_precision': 0.8916084, 'binary_recall': 0.8095238, 'binary_specificity': 0.9047619, 'binary_f1_score': 0.8485857}
confusion matrix:
     0    1
0  589   62
1  120  510
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.82666665, 'precision': 0.82926834, 'recall': 0.82666665, 'specificity': 0.82666665, 'f1': 0.8263236, 'auroc': 0.909037, 'binary_precision': 0.8585366, 'binary_recall': 0.7822222, 'binary_specificity': 0.8711111, 'binary_f1_score': 0.8186047}
confusion matrix:
     0    1
0  196   29
1   49  176
early stop counter: 7
val acc:0.8579235076904297, best validation acc: 0.8672911524772644, corresponding to test acc:                         0.8399999737739563 / 0.8688889145851135
after epoch: 14,now: 2024-07-23 06:02:04.789169,epoch time: 0:01:15.294560,used: 0:17:34.213729,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_05_44_30_seed_1_22779259
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9817708, 'precision': 0.98175114, 'recall': 0.9818083, 'specificity': 0.9818083, 'f1': 0.9817693, 'auroc': 0.99904704, 'binary_precision': 0.98511326, 'binary_recall': 0.9787781, 'binary_specificity': 0.9848385, 'binary_f1_score': 0.98193544}
confusion matrix:
      0     1
0  1494    23
1    33  1522
---- Validation: 
scalar performance:
{'acc': 0.8555816, 'precision': 0.87192285, 'recall': 0.85386586, 'specificity': 0.85386586, 'f1': 0.8535192, 'auroc': 0.9289957, 'binary_precision': 0.9458918, 'binary_recall': 0.74920636, 'binary_specificity': 0.95852536, 'binary_f1_score': 0.8361382}
confusion matrix:
     0    1
0  624   27
1  158  472
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.86444443, 'precision': 0.8782598, 'recall': 0.86444443, 'specificity': 0.86444443, 'f1': 0.8631953, 'auroc': 0.9156346, 'binary_precision': 0.9505494, 'binary_recall': 0.7688889, 'binary_specificity': 0.96, 'binary_f1_score': 0.85012287}
confusion matrix:
     0    1
0  216    9
1   52  173
early stop counter: 8
val acc:0.8555815815925598, best validation acc: 0.8672911524772644, corresponding to test acc:                         0.8399999737739563 / 0.8688889145851135
after epoch: 15,now: 2024-07-23 06:03:19.290431,epoch time: 0:01:14.501262,used: 0:18:48.714991,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_05_44_30_seed_1_22779259
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9902344, 'precision': 0.9902134, 'recall': 0.9902667, 'specificity': 0.9902667, 'f1': 0.9902333, 'auroc': 0.99907124, 'binary_precision': 0.99289405, 'binary_recall': 0.9877892, 'binary_specificity': 0.9927441, 'binary_f1_score': 0.99033505}
confusion matrix:
      0     1
0  1505    11
1    19  1537
---- Validation: 
scalar performance:
{'acc': 0.8579235, 'precision': 0.86055684, 'recall': 0.8572197, 'specificity': 0.8572197, 'f1': 0.8574606, 'auroc': 0.9167118, 'binary_precision': 0.88754326, 'binary_recall': 0.8142857, 'binary_specificity': 0.90015364, 'binary_f1_score': 0.8493377}
confusion matrix:
     0    1
0  586   65
1  117  513
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.86, 'precision': 0.8638015, 'recall': 0.86, 'specificity': 0.86, 'f1': 0.8596333, 'auroc': 0.91836053, 'binary_precision': 0.9009901, 'binary_recall': 0.8088889, 'binary_specificity': 0.9111111, 'binary_f1_score': 0.8524591}
confusion matrix:
     0    1
0  205   20
1   43  182
early stop counter: 9
val acc:0.8579235076904297, best validation acc: 0.8672911524772644, corresponding to test acc:                         0.8399999737739563 / 0.8688889145851135
after epoch: 16,now: 2024-07-23 06:04:34.080435,epoch time: 0:01:14.790004,used: 0:20:03.504995,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_05_44_30_seed_1_22779259
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9869792, 'precision': 0.98708606, 'recall': 0.9871141, 'specificity': 0.9871141, 'f1': 0.9869791, 'auroc': 0.99872017, 'binary_precision': 0.9980276, 'binary_recall': 0.97620577, 'binary_specificity': 0.99802244, 'binary_f1_score': 0.98699605}
confusion matrix:
      0     1
0  1514     3
1    37  1518
---- Validation: 
scalar performance:
{'acc': 0.8665105, 'precision': 0.87461936, 'recall': 0.8653098, 'specificity': 0.8653098, 'f1': 0.8654822, 'auroc': 0.9241533, 'binary_precision': 0.9257885, 'binary_recall': 0.7920635, 'binary_specificity': 0.9385561, 'binary_f1_score': 0.85372114}
confusion matrix:
     0    1
0  611   40
1  131  499
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.83555555, 'precision': 0.8577144, 'recall': 0.83555555, 'specificity': 0.83555555, 'f1': 0.83296883, 'auroc': 0.92803943, 'binary_precision': 0.9467456, 'binary_recall': 0.7111111, 'binary_specificity': 0.96, 'binary_f1_score': 0.8121828}
confusion matrix:
     0    1
0  216    9
1   65  160
early stop counter: 10
val acc:0.8665105104446411, best validation acc: 0.8672911524772644, corresponding to test acc:                         0.8399999737739563 / 0.8688889145851135
after epoch: 17,now: 2024-07-23 06:05:49.151972,epoch time: 0:01:15.071537,used: 0:21:18.576532,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_05_44_30_seed_1_22779259
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.98339844, 'precision': 0.983413, 'recall': 0.9834931, 'specificity': 0.9834931, 'f1': 0.9833979, 'auroc': 0.9989779, 'binary_precision': 0.99086756, 'binary_recall': 0.9762211, 'binary_specificity': 0.99076515, 'binary_f1_score': 0.98348975}
confusion matrix:
      0     1
0  1502    14
1    37  1519
---- Validation: 
scalar performance:
{'acc': 0.8095238, 'precision': 0.83311135, 'recall': 0.8073221, 'specificity': 0.8073221, 'f1': 0.8052852, 'auroc': 0.9053714, 'binary_precision': 0.9177489, 'binary_recall': 0.6730159, 'binary_specificity': 0.9416283, 'binary_f1_score': 0.77655685}
confusion matrix:
     0    1
0  613   38
1  206  424
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7311111, 'precision': 0.80545115, 'recall': 0.7311111, 'specificity': 0.7311111, 'f1': 0.71369076, 'auroc': 0.9112692, 'binary_precision': 0.95614034, 'binary_recall': 0.48444444, 'binary_specificity': 0.9777778, 'binary_f1_score': 0.64306784}
confusion matrix:
     0    1
0  220    5
1  116  109
early stop counter: 11
val acc:0.8095238208770752, best validation acc: 0.8672911524772644, corresponding to test acc:                         0.8399999737739563 / 0.8688889145851135
after epoch: 18,now: 2024-07-23 06:07:04.087134,epoch time: 0:01:14.935162,used: 0:22:33.511694,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_05_44_30_seed_1_22779259
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.99283856, 'precision': 0.9928236, 'recall': 0.9928938, 'specificity': 0.9928938, 'f1': 0.9928381, 'auroc': 0.99973166, 'binary_precision': 0.9974043, 'binary_recall': 0.9884244, 'binary_specificity': 0.9973632, 'binary_f1_score': 0.99289405}
confusion matrix:
      0     1
0  1513     4
1    18  1537
---- Validation: 
scalar performance:
{'acc': 0.8165496, 'precision': 0.84845847, 'recall': 0.8140553, 'specificity': 0.8140553, 'f1': 0.81138355, 'auroc': 0.92019784, 'binary_precision': 0.9498861, 'binary_recall': 0.66190475, 'binary_specificity': 0.96620584, 'binary_f1_score': 0.78016835}
confusion matrix:
     0    1
0  629   22
1  213  417
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7777778, 'precision': 0.8253025, 'recall': 0.7777778, 'specificity': 0.7777778, 'f1': 0.7693538, 'auroc': 0.91770864, 'binary_precision': 0.9496403, 'binary_recall': 0.58666664, 'binary_specificity': 0.9688889, 'binary_f1_score': 0.72527474}
confusion matrix:
     0    1
0  218    7
1   93  132
early stop counter: 12
val acc:0.8165495991706848, best validation acc: 0.8672911524772644, corresponding to test acc:                         0.8399999737739563 / 0.8688889145851135
after epoch: 19,now: 2024-07-23 06:08:18.822061,epoch time: 0:01:14.734927,used: 0:23:48.246621,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_05_44_30_seed_1_22779259
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9921875, 'precision': 0.9922073, 'recall': 0.99216723, 'specificity': 0.99216723, 'f1': 0.9921856, 'auroc': 0.9997999, 'binary_precision': 0.99103713, 'binary_recall': 0.99358153, 'binary_specificity': 0.990753, 'binary_f1_score': 0.99230766}
confusion matrix:
      0     1
0  1500    14
1    10  1548
---- Validation: 
scalar performance:
{'acc': 0.82201403, 'precision': 0.8460318, 'recall': 0.81984127, 'specificity': 0.81984127, 'f1': 0.8181386, 'auroc': 0.92028624, 'binary_precision': 0.93318963, 'binary_recall': 0.6873016, 'binary_specificity': 0.95238096, 'binary_f1_score': 0.79159045}
confusion matrix:
     0    1
0  620   31
1  197  433
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8066667, 'precision': 0.84058, 'recall': 0.8066667, 'specificity': 0.8066667, 'f1': 0.801731, 'auroc': 0.9172543, 'binary_precision': 0.9480519, 'binary_recall': 0.6488889, 'binary_specificity': 0.96444446, 'binary_f1_score': 0.77044857}
confusion matrix:
     0    1
0  217    8
1   79  146
early stop counter: 13
val acc:0.8220140337944031, best validation acc: 0.8672911524772644, corresponding to test acc:                         0.8399999737739563 / 0.8688889145851135
after epoch: 20,now: 2024-07-23 06:09:33.550396,epoch time: 0:01:14.728335,used: 0:25:02.974956,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_05_44_30_seed_1_22779259
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9889323, 'precision': 0.9889891, 'recall': 0.98906374, 'specificity': 0.98906374, 'f1': 0.98893213, 'auroc': 0.99958503, 'binary_precision': 0.99869025, 'binary_recall': 0.97944766, 'binary_specificity': 0.9986799, 'binary_f1_score': 0.98897535}
confusion matrix:
      0     1
0  1513     2
1    32  1525
---- Validation: 
scalar performance:
{'acc': 0.62217015, 'precision': 0.7385385, 'recall': 0.61633384, 'specificity': 0.61633384, 'f1': 0.56368476, 'auroc': 0.8841599, 'binary_precision': 0.9010989, 'binary_recall': 0.26031747, 'binary_specificity': 0.97235024, 'binary_f1_score': 0.4039409}
confusion matrix:
     0    1
0  633   18
1  466  164
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5911111, 'precision': 0.76355636, 'recall': 0.5911111, 'specificity': 0.5911111, 'f1': 0.5111468, 'auroc': 0.9041976, 'binary_precision': 0.9767442, 'binary_recall': 0.18666667, 'binary_specificity': 0.9955556, 'binary_f1_score': 0.31343284}
confusion matrix:
     0   1
0  224   1
1  183  42
early stop counter: 14
val acc:0.6221701502799988, best validation acc: 0.8672911524772644, corresponding to test acc:                         0.8399999737739563 / 0.8688889145851135
after epoch: 21,now: 2024-07-23 06:10:48.523819,epoch time: 0:01:14.973423,used: 0:26:17.948379,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_05_44_30_seed_1_22779259
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.99088544, 'precision': 0.9909133, 'recall': 0.99095905, 'specificity': 0.99095905, 'f1': 0.99088526, 'auroc': 0.9997626, 'binary_precision': 0.9980392, 'binary_recall': 0.9838917, 'binary_specificity': 0.9980263, 'binary_f1_score': 0.99091494}
confusion matrix:
      0     1
0  1517     3
1    25  1527
---- Validation: 
scalar performance:
{'acc': 0.8384075, 'precision': 0.8558831, 'recall': 0.83658475, 'specificity': 0.83658475, 'f1': 0.83584666, 'auroc': 0.9192598, 'binary_precision': 0.9307536, 'binary_recall': 0.7253968, 'binary_specificity': 0.9477727, 'binary_f1_score': 0.8153435}
confusion matrix:
     0    1
0  617   34
1  173  457
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8333333, 'precision': 0.8513868, 'recall': 0.8333334, 'specificity': 0.8333334, 'f1': 0.8311647, 'auroc': 0.9183408, 'binary_precision': 0.9310345, 'binary_recall': 0.72, 'binary_specificity': 0.94666666, 'binary_f1_score': 0.8120301}
confusion matrix:
     0    1
0  213   12
1   63  162
early stop counter: 15
val acc:0.8384075164794922, best validation acc: 0.8672911524772644, corresponding to test acc:                         0.8399999737739563 / 0.8688889145851135
after epoch: 22,now: 2024-07-23 06:12:03.430893,epoch time: 0:01:14.907074,used: 0:27:32.855453,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_05_44_30_seed_1_22779259
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.9954427, 'precision': 0.99543446, 'recall': 0.9954504, 'specificity': 0.9954504, 'f1': 0.99544203, 'auroc': 0.999866, 'binary_precision': 0.996139, 'binary_recall': 0.9948586, 'binary_specificity': 0.9960422, 'binary_f1_score': 0.9954984}
confusion matrix:
      0     1
0  1510     6
1     8  1548
---- Validation: 
scalar performance:
{'acc': 0.83138174, 'precision': 0.8467202, 'recall': 0.8296467, 'specificity': 0.8296467, 'f1': 0.8289416, 'auroc': 0.9095878, 'binary_precision': 0.91566265, 'binary_recall': 0.72380954, 'binary_specificity': 0.9354839, 'binary_f1_score': 0.80851066}
confusion matrix:
     0    1
0  609   42
1  174  456
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.83555555, 'precision': 0.8515552, 'recall': 0.83555555, 'specificity': 0.83555555, 'f1': 0.833663, 'auroc': 0.915437, 'binary_precision': 0.92655367, 'binary_recall': 0.72888887, 'binary_specificity': 0.94222224, 'binary_f1_score': 0.8159204}
confusion matrix:
     0    1
0  212   13
1   61  164
early stop counter: 16
val acc:0.8313817381858826, best validation acc: 0.8672911524772644, corresponding to test acc:                         0.8399999737739563 / 0.8688889145851135
after epoch: 23,now: 2024-07-23 06:13:18.454007,epoch time: 0:01:15.023114,used: 0:28:47.878567,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_05_44_30_seed_1_22779259
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9895833, 'precision': 0.9896641, 'recall': 0.98971725, 'specificity': 0.98971725, 'f1': 0.98958325, 'auroc': 0.99987185, 'binary_precision': 1.0, 'binary_recall': 0.97943443, 'binary_specificity': 1.0, 'binary_f1_score': 0.9896104}
confusion matrix:
      0     1
0  1516     0
1    32  1524
---- Validation: 
scalar performance:
{'acc': 0.70335674, 'precision': 0.789449, 'recall': 0.6988223, 'specificity': 0.6988223, 'f1': 0.6765151, 'auroc': 0.91195476, 'binary_precision': 0.9432624, 'binary_recall': 0.42222223, 'binary_specificity': 0.97542244, 'binary_f1_score': 0.5833333}
confusion matrix:
     0    1
0  635   16
1  364  266
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.68222225, 'precision': 0.7946907, 'recall': 0.68222225, 'specificity': 0.68222225, 'f1': 0.6487043, 'auroc': 0.89783704, 'binary_precision': 0.9767442, 'binary_recall': 0.37333333, 'binary_specificity': 0.9911111, 'binary_f1_score': 0.54019296}
confusion matrix:
     0   1
0  223   2
1  141  84
early stop counter: 17
val acc:0.7033567428588867, best validation acc: 0.8672911524772644, corresponding to test acc:                         0.8399999737739563 / 0.8688889145851135
after epoch: 24,now: 2024-07-23 06:14:33.618857,epoch time: 0:01:15.164850,used: 0:30:03.043417,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_05_44_30_seed_1_22779259
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.99316406, 'precision': 0.99316406, 'recall': 0.9932245, 'specificity': 0.9932245, 'f1': 0.9931638, 'auroc': 0.99982536, 'binary_precision': 0.99869794, 'binary_recall': 0.9877656, 'binary_specificity': 0.99868333, 'binary_f1_score': 0.9932017}
confusion matrix:
      0     1
0  1517     2
1    19  1534
---- Validation: 
scalar performance:
{'acc': 0.7314598, 'precision': 0.8057995, 'recall': 0.7273681, 'specificity': 0.7273681, 'f1': 0.71174616, 'auroc': 0.91655636, 'binary_precision': 0.95253164, 'binary_recall': 0.47777778, 'binary_specificity': 0.9769585, 'binary_f1_score': 0.6363636}
confusion matrix:
     0    1
0  636   15
1  329  301
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.58666664, 'precision': 0.73164034, 'recall': 0.58666664, 'specificity': 0.58666664, 'f1': 0.50999904, 'auroc': 0.8788346, 'binary_precision': 0.9148936, 'binary_recall': 0.19111112, 'binary_specificity': 0.9822222, 'binary_f1_score': 0.31617647}
confusion matrix:
     0   1
0  221   4
1  182  43
early stop counter: 18
val acc:0.7314597964286804, best validation acc: 0.8672911524772644, corresponding to test acc:                         0.8399999737739563 / 0.8688889145851135
after epoch: 25,now: 2024-07-23 06:15:48.657311,epoch time: 0:01:15.038454,used: 0:31:18.081871,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_05_44_30_seed_1_22779259
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9873047, 'precision': 0.9872861, 'recall': 0.9873309, 'specificity': 0.9873309, 'f1': 0.98730344, 'auroc': 0.99932176, 'binary_precision': 0.9896641, 'binary_recall': 0.985209, 'binary_specificity': 0.98945284, 'binary_f1_score': 0.9874315}
confusion matrix:
      0     1
0  1501    16
1    23  1532
---- Validation: 
scalar performance:
{'acc': 0.7665886, 'precision': 0.81051326, 'recall': 0.7634665, 'specificity': 0.7634665, 'f1': 0.75656, 'auroc': 0.9020506, 'binary_precision': 0.9232737, 'binary_recall': 0.57301587, 'binary_specificity': 0.953917, 'binary_f1_score': 0.70714986}
confusion matrix:
     0    1
0  621   30
1  269  361
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.67333335, 'precision': 0.78542155, 'recall': 0.67333335, 'specificity': 0.67333335, 'f1': 0.6377704, 'auroc': 0.9127506, 'binary_precision': 0.96428573, 'binary_recall': 0.36, 'binary_specificity': 0.9866667, 'binary_f1_score': 0.52427185}
confusion matrix:
     0   1
0  222   3
1  144  81
early stop counter: 19
val acc:0.7665886282920837, best validation acc: 0.8672911524772644, corresponding to test acc:                         0.8399999737739563 / 0.8688889145851135
after epoch: 26,now: 2024-07-23 06:17:04.171041,epoch time: 0:01:15.513730,used: 0:32:33.595601,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_05_44_30_seed_1_22779259
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.9921875, 'precision': 0.99221504, 'recall': 0.9921649, 'specificity': 0.9921649, 'f1': 0.9921862, 'auroc': 0.99957776, 'binary_precision': 0.99037844, 'binary_recall': 0.99420476, 'binary_specificity': 0.99012506, 'binary_f1_score': 0.99228793}
confusion matrix:
      0     1
0  1504    15
1     9  1544
---- Validation: 
scalar performance:
{'acc': 0.8266979, 'precision': 0.84478223, 'recall': 0.824808, 'specificity': 0.824808, 'f1': 0.82377416, 'auroc': 0.91752064, 'binary_precision': 0.9197531, 'binary_recall': 0.7095238, 'binary_specificity': 0.94009215, 'binary_f1_score': 0.8010753}
confusion matrix:
     0    1
0  612   39
1  183  447
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8377778, 'precision': 0.84615386, 'recall': 0.83777773, 'specificity': 0.83777773, 'f1': 0.83679044, 'auroc': 0.9038222, 'binary_precision': 0.9, 'binary_recall': 0.76, 'binary_specificity': 0.91555554, 'binary_f1_score': 0.8240963}
confusion matrix:
     0    1
0  206   19
1   54  171
early stop counter: 20
val acc:0.8266978859901428, best validation acc: 0.8672911524772644, corresponding to test acc:                         0.8399999737739563 / 0.8688889145851135
after epoch: 27,now: 2024-07-23 06:18:19.086626,epoch time: 0:01:14.915585,used: 0:33:48.511186,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_05_44_30_seed_1_22779259
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.9863281, 'precision': 0.9867307, 'recall': 0.986181, 'specificity': 0.986181, 'f1': 0.9863202, 'auroc': 0.9998567, 'binary_precision': 0.9754871, 'binary_recall': 0.9980707, 'binary_specificity': 0.9742914, 'binary_f1_score': 0.9866497}
confusion matrix:
      0     1
0  1478    39
1     3  1552
---- Validation: 
scalar performance:
{'acc': 0.85870415, 'precision': 0.8598071, 'recall': 0.8582437, 'specificity': 0.8582437, 'f1': 0.85845256, 'auroc': 0.9138328, 'binary_precision': 0.8760469, 'binary_recall': 0.8301587, 'binary_specificity': 0.8863287, 'binary_f1_score': 0.8524857}
confusion matrix:
     0    1
0  577   74
1  107  523
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7888889, 'precision': 0.79017854, 'recall': 0.78888893, 'specificity': 0.78888893, 'f1': 0.7886541, 'auroc': 0.856558, 'binary_precision': 0.7708333, 'binary_recall': 0.82222223, 'binary_specificity': 0.75555557, 'binary_f1_score': 0.79569894}
confusion matrix:
     0    1
0  170   55
1   40  185
early stop counter: 21
val acc:0.858704149723053, best validation acc: 0.8672911524772644, corresponding to test acc:                         0.8399999737739563 / 0.8688889145851135
after epoch: 28,now: 2024-07-23 06:19:34.020290,epoch time: 0:01:14.933664,used: 0:35:03.444850,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_05_44_30_seed_1_22779259
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.99153644, 'precision': 0.9915245, 'recall': 0.9915887, 'specificity': 0.9915887, 'f1': 0.991536, 'auroc': 0.99963677, 'binary_precision': 0.9961039, 'binary_recall': 0.98713, 'binary_specificity': 0.99604744, 'binary_f1_score': 0.9915966}
confusion matrix:
      0     1
0  1512     6
1    20  1534
---- Validation: 
scalar performance:
{'acc': 0.75956285, 'precision': 0.80792415, 'recall': 0.75627244, 'specificity': 0.75627244, 'f1': 0.7481231, 'auroc': 0.89631885, 'binary_precision': 0.9259259, 'binary_recall': 0.5555556, 'binary_specificity': 0.9569892, 'binary_f1_score': 0.6944444}
confusion matrix:
     0    1
0  623   28
1  280  350
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8155556, 'precision': 0.8287037, 'recall': 0.8155556, 'specificity': 0.8155556, 'f1': 0.81369245, 'auroc': 0.9008, 'binary_precision': 0.89444447, 'binary_recall': 0.71555555, 'binary_specificity': 0.91555554, 'binary_f1_score': 0.79506177}
confusion matrix:
     0    1
0  206   19
1   64  161
early stop counter: 22
val acc:0.7595628499984741, best validation acc: 0.8672911524772644, corresponding to test acc:                         0.8399999737739563 / 0.8688889145851135
after epoch: 29,now: 2024-07-23 06:20:48.835888,epoch time: 0:01:14.815598,used: 0:36:18.260448,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_05_44_30_seed_1_22779259
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.9938151, 'precision': 0.9938191, 'recall': 0.9938867, 'specificity': 0.9938867, 'f1': 0.99381495, 'auroc': 0.99966633, 'binary_precision': 1.0, 'binary_recall': 0.9877735, 'binary_specificity': 1.0, 'binary_f1_score': 0.99384916}
confusion matrix:
      0     1
0  1518     0
1    19  1535
---- Validation: 
scalar performance:
{'acc': 0.5800156, 'precision': 0.7451556, 'recall': 0.57316947, 'specificity': 0.57316947, 'f1': 0.4863596, 'auroc': 0.91689646, 'binary_precision': 0.9423077, 'binary_recall': 0.15555556, 'binary_specificity': 0.9907834, 'binary_f1_score': 0.26702997}
confusion matrix:
     0   1
0  645   6
1  532  98
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5422222, 'precision': 0.7610209, 'recall': 0.5422222, 'specificity': 0.5422222, 'f1': 0.42085662, 'auroc': 0.9097827, 'binary_precision': 1.0, 'binary_recall': 0.08444444, 'binary_specificity': 1.0, 'binary_f1_score': 0.1557377}
confusion matrix:
     0   1
0  225   0
1  206  19
early stop counter: 23
val acc:0.5800155997276306, best validation acc: 0.8672911524772644, corresponding to test acc:                         0.8399999737739563 / 0.8688889145851135
after epoch: 30,now: 2024-07-23 06:22:03.394303,epoch time: 0:01:14.558415,used: 0:37:32.818863,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_05_44_30_seed_1_22779259
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 0:37:32.818863 at 2024-07-23 06:22:03.394303
persisted model performance metric: 

scalar performance:
{'acc': 0.84, 'precision': 0.84002686, 'recall': 0.84000003, 'specificity': 0.84000003, 'f1': 0.8399968, 'auroc': 0.91960496, 'binary_precision': 0.84304935, 'binary_recall': 0.83555555, 'binary_specificity': 0.84444445, 'binary_f1_score': 0.83928573}
confusion matrix:
     0    1
0  190   35
1   37  188
oracle model performance metric: 

scalar performance:
{'acc': 0.8688889, 'precision': 0.87100685, 'recall': 0.8688889, 'specificity': 0.8688889, 'f1': 0.8687015, 'auroc': 0.9279605, 'binary_precision': 0.89903843, 'binary_recall': 0.83111113, 'binary_specificity': 0.9066667, 'binary_f1_score': 0.86374134}
confusion matrix:
     0    1
0  204   21
1   38  187
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_dial_lr1e5_bs32_nofreeze_2024-07-23_01-16-41/rule_results/3.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_dial_lr1e5_bs32_nofreeze_2024-07-23_01-16-41/confusion_matrix/3.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 453153 KiB |  26075 MiB | 145141 GiB | 145141 GiB |
|       from large pool | 412597 KiB |  26030 MiB | 144234 GiB | 144234 GiB |
|       from small pool |  40556 KiB |     60 MiB |    906 GiB |    906 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 453153 KiB |  26075 MiB | 145141 GiB | 145141 GiB |
|       from large pool | 412597 KiB |  26030 MiB | 144234 GiB | 144234 GiB |
|       from small pool |  40556 KiB |     60 MiB |    906 GiB |    906 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 447481 KiB |  26071 MiB | 145115 GiB | 145115 GiB |
|       from large pool | 407075 KiB |  26026 MiB | 144210 GiB | 144210 GiB |
|       from small pool |  40406 KiB |     60 MiB |    905 GiB |    905 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  27768 MiB |  27768 MiB |  54300 MiB |  26532 MiB |
|       from large pool |  27696 MiB |  27696 MiB |  54218 MiB |  26522 MiB |
|       from small pool |     72 MiB |     72 MiB |     82 MiB |     10 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 738782 KiB |   1678 MiB |  64539 GiB |  64538 GiB |
|       from large pool | 721995 KiB |   1668 MiB |  63626 GiB |  63625 GiB |
|       from small pool |  16787 KiB |     31 MiB |    913 GiB |    913 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    1226    |    2570    |   13122 K  |   13121 K  |
|       from large pool |     187    |    1413    |    6645 K  |    6645 K  |
|       from small pool |    1039    |    1335    |    6476 K  |    6475 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    1226    |    2570    |   13122 K  |   13121 K  |
|       from large pool |     187    |    1413    |    6645 K  |    6645 K  |
|       from small pool |    1039    |    1335    |    6476 K  |    6475 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     835    |     835    |    1601    |     766    |
|       from large pool |     799    |     800    |    1560    |     761    |
|       from small pool |      36    |      36    |      41    |       5    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     108    |     853    |    9549 K  |    9549 K  |
|       from large pool |      40    |     801    |    5873 K  |    5873 K  |
|       from small pool |      68    |     146    |    3675 K  |    3675 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  26075 MiB | 145141 GiB | 145141 GiB |
|       from large pool |  16640 KiB |  26030 MiB | 144234 GiB | 144234 GiB |
|       from small pool |      0 KiB |     60 MiB |    906 GiB |    906 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  26075 MiB | 145141 GiB | 145141 GiB |
|       from large pool |  16640 KiB |  26030 MiB | 144234 GiB | 144234 GiB |
|       from small pool |      0 KiB |     60 MiB |    906 GiB |    906 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  26071 MiB | 145115 GiB | 145115 GiB |
|       from large pool |  16640 KiB |  26026 MiB | 144210 GiB | 144210 GiB |
|       from small pool |      0 KiB |     60 MiB |    905 GiB |    905 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1164 MiB |  27768 MiB |  54300 MiB |  53136 MiB |
|       from large pool |   1108 MiB |  27696 MiB |  54218 MiB |  53110 MiB |
|       from small pool |     56 MiB |     72 MiB |     82 MiB |     26 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |   3840 KiB |   1678 MiB |  64539 GiB |  64539 GiB |
|       from large pool |   3840 KiB |   1668 MiB |  63626 GiB |  63626 GiB |
|       from small pool |      0 KiB |     31 MiB |    913 GiB |    913 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    2570    |   13122 K  |   13122 K  |
|       from large pool |       2    |    1413    |    6645 K  |    6645 K  |
|       from small pool |       0    |    1335    |    6476 K  |    6476 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    2570    |   13122 K  |   13122 K  |
|       from large pool |       2    |    1413    |    6645 K  |    6645 K  |
|       from small pool |       0    |    1335    |    6476 K  |    6476 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      69    |     835    |    1601    |    1532    |
|       from large pool |      41    |     800    |    1560    |    1519    |
|       from small pool |      28    |      36    |      41    |      13    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       1    |     853    |    9549 K  |    9549 K  |
|       from large pool |       1    |     801    |    5873 K  |    5873 K  |
|       from small pool |       0    |     146    |    3676 K  |    3676 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  26075 MiB | 145141 GiB | 145141 GiB |
|       from large pool |  16640 KiB |  26030 MiB | 144234 GiB | 144234 GiB |
|       from small pool |      0 KiB |     60 MiB |    906 GiB |    906 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  26075 MiB | 145141 GiB | 145141 GiB |
|       from large pool |  16640 KiB |  26030 MiB | 144234 GiB | 144234 GiB |
|       from small pool |      0 KiB |     60 MiB |    906 GiB |    906 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  26071 MiB | 145115 GiB | 145115 GiB |
|       from large pool |  16640 KiB |  26026 MiB | 144210 GiB | 144210 GiB |
|       from small pool |      0 KiB |     60 MiB |    905 GiB |    905 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1164 MiB |  27768 MiB |  54300 MiB |  53136 MiB |
|       from large pool |   1108 MiB |  27696 MiB |  54218 MiB |  53110 MiB |
|       from small pool |     56 MiB |     72 MiB |     82 MiB |     26 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |   3840 KiB |   1678 MiB |  64539 GiB |  64539 GiB |
|       from large pool |   3840 KiB |   1668 MiB |  63626 GiB |  63626 GiB |
|       from small pool |      0 KiB |     31 MiB |    913 GiB |    913 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    2570    |   13122 K  |   13122 K  |
|       from large pool |       2    |    1413    |    6645 K  |    6645 K  |
|       from small pool |       0    |    1335    |    6476 K  |    6476 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    2570    |   13122 K  |   13122 K  |
|       from large pool |       2    |    1413    |    6645 K  |    6645 K  |
|       from small pool |       0    |    1335    |    6476 K  |    6476 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      69    |     835    |    1601    |    1532    |
|       from large pool |      41    |     800    |    1560    |    1519    |
|       from small pool |      28    |      36    |      41    |      13    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       1    |     853    |    9549 K  |    9549 K  |
|       from large pool |       1    |     801    |    5873 K  |    5873 K  |
|       from small pool |       0    |     146    |    3676 K  |    3676 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'888c1ef2'
model name: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_06_23_15_seed_2_22779259

 Experiment start at: 2024-07-23 06:23:15.253929
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
before training, model accuracy: 0.41203704476356506
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9282895, 'precision': 0.9283804, 'recall': 0.9282336, 'specificity': 0.9282336, 'f1': 0.9282744, 'auroc': 0.9754956, 'binary_precision': 0.92392004, 'binary_recall': 0.93476844, 'binary_specificity': 0.92169875, 'binary_f1_score': 0.9293126}
confusion matrix:
      0     1
0  1389   118
1   100  1433
---- Validation: 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
scalar performance:
{'acc': 0.81533647, 'precision': 0.81565905, 'recall': 0.815789, 'specificity': 0.815789, 'f1': 0.8153325, 'auroc': 0.8931701, 'binary_precision': 0.7969231, 'binary_recall': 0.8327974, 'binary_specificity': 0.7987805, 'binary_f1_score': 0.81446546}
confusion matrix:
     0    1
0  524  132
1  104  518
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8194444, 'precision': 0.8241409, 'recall': 0.8194444, 'specificity': 0.8194444, 'f1': 0.81878805, 'auroc': 0.9062286, 'binary_precision': 0.78512394, 'binary_recall': 0.8796296, 'binary_specificity': 0.7592593, 'binary_f1_score': 0.82969433}
confusion matrix:
     0    1
0  164   52
1   26  190
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-23 06:24:30.502053,epoch time: 0:01:15.248124,used: 0:01:15.248124,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_06_23_15_seed_2_22779259
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.93519735, 'precision': 0.9401202, 'recall': 0.9356979, 'specificity': 0.9356979, 'f1': 0.93506163, 'auroc': 0.98381746, 'binary_precision': 0.9890271, 'binary_recall': 0.88135594, 'binary_specificity': 0.9900398, 'binary_f1_score': 0.9320924}
confusion matrix:
      0     1
0  1491    15
1   182  1352
---- Validation: 
scalar performance:
{'acc': 0.81377155, 'precision': 0.8304515, 'recall': 0.8107232, 'specificity': 0.8107232, 'f1': 0.8102542, 'auroc': 0.90395856, 'binary_precision': 0.8983402, 'binary_recall': 0.6961415, 'binary_specificity': 0.9253049, 'binary_f1_score': 0.78442025}
confusion matrix:
     0    1
0  607   49
1  189  433
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8541667, 'precision': 0.85897547, 'recall': 0.8541666, 'specificity': 0.8541666, 'f1': 0.8536767, 'auroc': 0.91238, 'binary_precision': 0.90052354, 'binary_recall': 0.7962963, 'binary_specificity': 0.912037, 'binary_f1_score': 0.8452089}
confusion matrix:
     0    1
0  197   19
1   44  172
new oracle model saved
early stop counter: 1
val acc:0.8137715458869934, best validation acc: 0.8153364658355713, corresponding to test acc:                         0.8194444179534912 / 0.8541666865348816
after epoch: 2,now: 2024-07-23 06:25:42.475542,epoch time: 0:01:11.973489,used: 0:02:27.221613,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_06_23_15_seed_2_22779259
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.96348685, 'precision': 0.96350837, 'recall': 0.9635254, 'specificity': 0.9635254, 'f1': 0.9634868, 'auroc': 0.9934082, 'binary_precision': 0.9689564, 'binary_recall': 0.95819724, 'binary_specificity': 0.96885353, 'binary_f1_score': 0.9635468}
confusion matrix:
      0     1
0  1462    47
1    64  1467
---- Validation: 
scalar performance:
{'acc': 0.8176839, 'precision': 0.81756115, 'recall': 0.8175339, 'specificity': 0.8175339, 'f1': 0.8175471, 'auroc': 0.8896655, 'binary_precision': 0.8132045, 'binary_recall': 0.8118971, 'binary_specificity': 0.8231707, 'binary_f1_score': 0.8125503}
confusion matrix:
     0    1
0  540  116
1  117  505
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8078704, 'precision': 0.8205749, 'recall': 0.8078704, 'specificity': 0.8078704, 'f1': 0.8059478, 'auroc': 0.9150591, 'binary_precision': 0.7567568, 'binary_recall': 0.9074074, 'binary_specificity': 0.7083333, 'binary_f1_score': 0.82526314}
confusion matrix:
     0    1
0  153   63
1   20  196
better model found
persisted
after epoch: 3,now: 2024-07-23 06:26:54.612296,epoch time: 0:01:12.136754,used: 0:03:39.358367,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_06_23_15_seed_2_22779259
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.98256576, 'precision': 0.9827143, 'recall': 0.9826777, 'specificity': 0.9826777, 'f1': 0.98256576, 'auroc': 0.9981599, 'binary_precision': 0.994, 'binary_recall': 0.97133553, 'binary_specificity': 0.9940199, 'binary_f1_score': 0.98253703}
confusion matrix:
      0     1
0  1496     9
1    44  1491
---- Validation: 
scalar performance:
{'acc': 0.7918623, 'precision': 0.8105413, 'recall': 0.7885068, 'specificity': 0.7885068, 'f1': 0.7872586, 'auroc': 0.87668675, 'binary_precision': 0.8803419, 'binary_recall': 0.66237944, 'binary_specificity': 0.91463417, 'binary_f1_score': 0.7559633}
confusion matrix:
     0    1
0  600   56
1  210  412
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8240741, 'precision': 0.82418525, 'recall': 0.82407403, 'specificity': 0.82407403, 'f1': 0.82405895, 'auroc': 0.9097651, 'binary_precision': 0.8301887, 'binary_recall': 0.8148148, 'binary_specificity': 0.8333333, 'binary_f1_score': 0.82242984}
confusion matrix:
     0    1
0  180   36
1   40  176
early stop counter: 1
val acc:0.7918623089790344, best validation acc: 0.8176838755607605, corresponding to test acc:                         0.8078703880310059 / 0.8541666865348816
after epoch: 4,now: 2024-07-23 06:28:06.245878,epoch time: 0:01:11.633582,used: 0:04:50.991949,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_06_23_15_seed_2_22779259
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9753289, 'precision': 0.97604537, 'recall': 0.97549623, 'specificity': 0.97549623, 'f1': 0.97532445, 'auroc': 0.99771845, 'binary_precision': 0.9965917, 'binary_recall': 0.9543081, 'binary_specificity': 0.9966844, 'binary_f1_score': 0.9749917}
confusion matrix:
      0     1
0  1503     5
1    70  1462
---- Validation: 
scalar performance:
{'acc': 0.67527384, 'precision': 0.74225366, 'recall': 0.6680236, 'specificity': 0.6680236, 'f1': 0.64539, 'auroc': 0.8265798, 'binary_precision': 0.86315787, 'binary_recall': 0.3954984, 'binary_specificity': 0.9405488, 'binary_f1_score': 0.5424476}
confusion matrix:
     0    1
0  617   39
1  376  246
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7962963, 'precision': 0.7969327, 'recall': 0.79629624, 'specificity': 0.79629624, 'f1': 0.7961871, 'auroc': 0.8679055, 'binary_precision': 0.78318584, 'binary_recall': 0.8194444, 'binary_specificity': 0.7731481, 'binary_f1_score': 0.800905}
confusion matrix:
     0    1
0  167   49
1   39  177
early stop counter: 2
val acc:0.6752738356590271, best validation acc: 0.8176838755607605, corresponding to test acc:                         0.8078703880310059 / 0.8541666865348816
after epoch: 5,now: 2024-07-23 06:29:17.564728,epoch time: 0:01:11.318850,used: 0:06:02.310799,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_06_23_15_seed_2_22779259
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9697368, 'precision': 0.97106224, 'recall': 0.96994, 'specificity': 0.96994, 'f1': 0.96972346, 'auroc': 0.9983976, 'binary_precision': 0.99792385, 'binary_recall': 0.94186807, 'binary_specificity': 0.99801195, 'binary_f1_score': 0.96908605}
confusion matrix:
      0     1
0  1506     3
1    89  1442
---- Validation: 
scalar performance:
{'acc': 0.6682316, 'precision': 0.77056086, 'recall': 0.65983063, 'specificity': 0.65983063, 'f1': 0.6267606, 'auroc': 0.87964916, 'binary_precision': 0.93043476, 'binary_recall': 0.34405145, 'binary_specificity': 0.9756098, 'binary_f1_score': 0.50234747}
confusion matrix:
     0    1
0  640   16
1  408  214
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7986111, 'precision': 0.81931424, 'recall': 0.7986111, 'specificity': 0.7986111, 'f1': 0.795293, 'auroc': 0.8814086, 'binary_precision': 0.9006211, 'binary_recall': 0.6712963, 'binary_specificity': 0.9259259, 'binary_f1_score': 0.7692308}
confusion matrix:
     0    1
0  200   16
1   71  145
early stop counter: 3
val acc:0.6682316064834595, best validation acc: 0.8176838755607605, corresponding to test acc:                         0.8078703880310059 / 0.8541666865348816
after epoch: 6,now: 2024-07-23 06:30:29.128751,epoch time: 0:01:11.564023,used: 0:07:13.874822,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_06_23_15_seed_2_22779259
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.97302634, 'precision': 0.97359943, 'recall': 0.97291064, 'specificity': 0.97291064, 'f1': 0.97301203, 'auroc': 0.99803925, 'binary_precision': 0.9588347, 'binary_recall': 0.98889613, 'binary_specificity': 0.9569251, 'binary_f1_score': 0.97363347}
confusion matrix:
      0     1
0  1444    65
1    17  1514
---- Validation: 
scalar performance:
{'acc': 0.8435055, 'precision': 0.84481937, 'recall': 0.8443529, 'specificity': 0.8443529, 'f1': 0.8434917, 'auroc': 0.91274464, 'binary_precision': 0.81586826, 'binary_recall': 0.8762058, 'binary_specificity': 0.8125, 'binary_f1_score': 0.8449612}
confusion matrix:
     0    1
0  533  123
1   77  545
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.75, 'precision': 0.79709625, 'recall': 0.75, 'specificity': 0.75, 'f1': 0.73968357, 'auroc': 0.92258227, 'binary_precision': 0.678808, 'binary_recall': 0.9490741, 'binary_specificity': 0.5509259, 'binary_f1_score': 0.7915059}
confusion matrix:
     0    1
0  119   97
1   11  205
better model found
persisted
after epoch: 7,now: 2024-07-23 06:31:40.599329,epoch time: 0:01:11.470578,used: 0:08:25.345400,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_06_23_15_seed_2_22779259
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.97335523, 'precision': 0.97419477, 'recall': 0.97356814, 'specificity': 0.97356814, 'f1': 0.9733499, 'auroc': 0.998398, 'binary_precision': 0.9965824, 'binary_recall': 0.9504563, 'binary_specificity': 0.99667996, 'binary_f1_score': 0.97297305}
confusion matrix:
      0     1
0  1501     5
1    76  1458
---- Validation: 
scalar performance:
{'acc': 0.74178404, 'precision': 0.79441816, 'recall': 0.73601824, 'specificity': 0.73601824, 'f1': 0.7265122, 'auroc': 0.8812176, 'binary_precision': 0.9124294, 'binary_recall': 0.5192926, 'binary_specificity': 0.9527439, 'binary_f1_score': 0.66188526}
confusion matrix:
     0    1
0  625   31
1  299  323
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8171296, 'precision': 0.822951, 'recall': 0.8171296, 'specificity': 0.8171296, 'f1': 0.8163018, 'auroc': 0.89604765, 'binary_precision': 0.8663102, 'binary_recall': 0.75, 'binary_specificity': 0.8842593, 'binary_f1_score': 0.8039703}
confusion matrix:
     0    1
0  191   25
1   54  162
early stop counter: 1
val acc:0.7417840361595154, best validation acc: 0.8435055017471313, corresponding to test acc:                         0.75 / 0.8541666865348816
after epoch: 8,now: 2024-07-23 06:32:52.073893,epoch time: 0:01:11.474564,used: 0:09:36.819964,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_06_23_15_seed_2_22779259
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9832237, 'precision': 0.9834013, 'recall': 0.9833061, 'specificity': 0.9833061, 'f1': 0.9832234, 'auroc': 0.99853873, 'binary_precision': 0.9946524, 'binary_recall': 0.97191375, 'binary_specificity': 0.99469846, 'binary_f1_score': 0.9831517}
confusion matrix:
      0     1
0  1501     8
1    43  1488
---- Validation: 
scalar performance:
{'acc': 0.8325509, 'precision': 0.8499126, 'recall': 0.8295575, 'specificity': 0.8295575, 'f1': 0.8294619, 'auroc': 0.9065907, 'binary_precision': 0.9214876, 'binary_recall': 0.7170418, 'binary_specificity': 0.94207317, 'binary_f1_score': 0.80651}
confusion matrix:
     0    1
0  618   38
1  176  446
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8287037, 'precision': 0.8351692, 'recall': 0.8287037, 'specificity': 0.8287037, 'f1': 0.8278736, 'auroc': 0.8999486, 'binary_precision': 0.8817204, 'binary_recall': 0.7592593, 'binary_specificity': 0.8981481, 'binary_f1_score': 0.81592035}
confusion matrix:
     0    1
0  194   22
1   52  164
early stop counter: 2
val acc:0.8325508832931519, best validation acc: 0.8435055017471313, corresponding to test acc:                         0.75 / 0.8541666865348816
after epoch: 9,now: 2024-07-23 06:34:03.588239,epoch time: 0:01:11.514346,used: 0:10:48.334310,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_06_23_15_seed_2_22779259
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9779605, 'precision': 0.9783666, 'recall': 0.9778578, 'specificity': 0.9778578, 'f1': 0.97795105, 'auroc': 0.9989568, 'binary_precision': 0.96626353, 'binary_recall': 0.9908616, 'binary_specificity': 0.9648541, 'binary_f1_score': 0.9784079}
confusion matrix:
      0     1
0  1455    53
1    14  1518
---- Validation: 
scalar performance:
{'acc': 0.8513302, 'precision': 0.85422534, 'recall': 0.8501, 'specificity': 0.8501, 'f1': 0.85062194, 'auroc': 0.90396833, 'binary_precision': 0.8802817, 'binary_recall': 0.8038585, 'binary_specificity': 0.89634144, 'binary_f1_score': 0.84033614}
confusion matrix:
     0    1
0  588   68
1  122  500
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8009259, 'precision': 0.806845, 'recall': 0.80092597, 'specificity': 0.80092597, 'f1': 0.7999612, 'auroc': 0.9108582, 'binary_precision': 0.7642276, 'binary_recall': 0.8703704, 'binary_specificity': 0.7314815, 'binary_f1_score': 0.8138528}
confusion matrix:
     0    1
0  158   58
1   28  188
better model found
persisted
after epoch: 10,now: 2024-07-23 06:35:15.162301,epoch time: 0:01:11.574062,used: 0:11:59.908372,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_06_23_15_seed_2_22779259
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.98717105, 'precision': 0.9871893, 'recall': 0.98721445, 'specificity': 0.98721445, 'f1': 0.98717093, 'auroc': 0.99904644, 'binary_precision': 0.99273926, 'binary_recall': 0.98172325, 'binary_specificity': 0.9927056, 'binary_f1_score': 0.9872005}
confusion matrix:
      0     1
0  1497    11
1    28  1504
---- Validation: 
scalar performance:
{'acc': 0.80359936, 'precision': 0.8408172, 'recall': 0.7991481, 'specificity': 0.7991481, 'f1': 0.79635763, 'auroc': 0.9058603, 'binary_precision': 0.9469879, 'binary_recall': 0.6318328, 'binary_specificity': 0.9664634, 'binary_f1_score': 0.7579556}
confusion matrix:
     0    1
0  634   22
1  229  393
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8287037, 'precision': 0.8523897, 'recall': 0.8287037, 'specificity': 0.8287037, 'f1': 0.8257761, 'auroc': 0.8970336, 'binary_precision': 0.94375, 'binary_recall': 0.6990741, 'binary_specificity': 0.9583333, 'binary_f1_score': 0.8031915}
confusion matrix:
     0    1
0  207    9
1   65  151
early stop counter: 1
val acc:0.8035993576049805, best validation acc: 0.8513302206993103, corresponding to test acc:                         0.8009259104728699 / 0.8541666865348816
after epoch: 11,now: 2024-07-23 06:36:26.890091,epoch time: 0:01:11.727790,used: 0:13:11.636162,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_06_23_15_seed_2_22779259
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9875, 'precision': 0.9875779, 'recall': 0.98745966, 'specificity': 0.98745966, 'f1': 0.9874978, 'auroc': 0.9994827, 'binary_precision': 0.9831933, 'binary_recall': 0.9921722, 'binary_specificity': 0.9827472, 'binary_f1_score': 0.9876623}
confusion matrix:
      0     1
0  1481    26
1    12  1521
---- Validation: 
scalar performance:
{'acc': 0.799687, 'precision': 0.8253493, 'recall': 0.79587877, 'specificity': 0.79587877, 'f1': 0.79412836, 'auroc': 0.8784703, 'binary_precision': 0.9103139, 'binary_recall': 0.65273315, 'binary_specificity': 0.9390244, 'binary_f1_score': 0.7602997}
confusion matrix:
     0    1
0  616   40
1  216  406
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8263889, 'precision': 0.83518964, 'recall': 0.8263889, 'specificity': 0.8263889, 'f1': 0.8252418, 'auroc': 0.90530694, 'binary_precision': 0.88950276, 'binary_recall': 0.7453704, 'binary_specificity': 0.9074074, 'binary_f1_score': 0.8110832}
confusion matrix:
     0    1
0  196   20
1   55  161
early stop counter: 2
val acc:0.7996870279312134, best validation acc: 0.8513302206993103, corresponding to test acc:                         0.8009259104728699 / 0.8541666865348816
after epoch: 12,now: 2024-07-23 06:37:38.598125,epoch time: 0:01:11.708034,used: 0:14:23.344196,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_06_23_15_seed_2_22779259
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.98815787, 'precision': 0.98820305, 'recall': 0.98813117, 'specificity': 0.98813117, 'f1': 0.98815644, 'auroc': 0.9995637, 'binary_precision': 0.9850843, 'binary_recall': 0.9915144, 'binary_specificity': 0.984748, 'binary_f1_score': 0.9882888}
confusion matrix:
      0     1
0  1485    23
1    13  1519
---- Validation: 
scalar performance:
{'acc': 0.86619717, 'precision': 0.8787292, 'recall': 0.8637901, 'specificity': 0.8637901, 'f1': 0.86445236, 'auroc': 0.91809464, 'binary_precision': 0.9412916, 'binary_recall': 0.7733119, 'binary_specificity': 0.9542683, 'binary_f1_score': 0.8490733}
confusion matrix:
     0    1
0  626   30
1  141  481
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8287037, 'precision': 0.839202, 'recall': 0.8287037, 'specificity': 0.8287037, 'f1': 0.827368, 'auroc': 0.89514744, 'binary_precision': 0.8988764, 'binary_recall': 0.7407407, 'binary_specificity': 0.9166667, 'binary_f1_score': 0.8121827}
confusion matrix:
     0    1
0  198   18
1   56  160
better model found
persisted
after epoch: 13,now: 2024-07-23 06:38:50.346743,epoch time: 0:01:11.748618,used: 0:15:35.092814,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_06_23_15_seed_2_22779259
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9917763, 'precision': 0.9917828, 'recall': 0.99181795, 'specificity': 0.99181795, 'f1': 0.9917762, 'auroc': 0.9997386, 'binary_precision': 0.9967062, 'binary_recall': 0.9869537, 'binary_specificity': 0.99668217, 'binary_f1_score': 0.991806}
confusion matrix:
      0     1
0  1502     5
1    20  1513
---- Validation: 
scalar performance:
{'acc': 0.80203444, 'precision': 0.8398396, 'recall': 0.79754037, 'specificity': 0.79754037, 'f1': 0.7946088, 'auroc': 0.9017062, 'binary_precision': 0.9467312, 'binary_recall': 0.62861735, 'binary_specificity': 0.9664634, 'binary_f1_score': 0.75555545}
confusion matrix:
     0    1
0  634   22
1  231  391
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7638889, 'precision': 0.82554203, 'recall': 0.7638889, 'specificity': 0.7638889, 'f1': 0.75215423, 'auroc': 0.87339246, 'binary_precision': 0.9672131, 'binary_recall': 0.5462963, 'binary_specificity': 0.9814815, 'binary_f1_score': 0.69822484}
confusion matrix:
     0    1
0  212    4
1   98  118
early stop counter: 1
val acc:0.8020344376564026, best validation acc: 0.8661971688270569, corresponding to test acc:                         0.8287037014961243 / 0.8541666865348816
after epoch: 14,now: 2024-07-23 06:40:02.378000,epoch time: 0:01:12.031257,used: 0:16:47.124071,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_06_23_15_seed_2_22779259
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9832237, 'precision': 0.98334855, 'recall': 0.9833031, 'specificity': 0.9833031, 'f1': 0.98322356, 'auroc': 0.9984243, 'binary_precision': 0.99333775, 'binary_recall': 0.9732376, 'binary_specificity': 0.9933687, 'binary_f1_score': 0.9831849}
confusion matrix:
      0     1
0  1498    10
1    41  1491
---- Validation: 
scalar performance:
{'acc': 0.74882627, 'precision': 0.8258567, 'recall': 0.74225307, 'specificity': 0.74225307, 'f1': 0.72957337, 'auroc': 0.8970393, 'binary_precision': 0.9777778, 'binary_recall': 0.49517685, 'binary_specificity': 0.9893293, 'binary_f1_score': 0.6574173}
confusion matrix:
     0    1
0  649    7
1  314  308
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7546296, 'precision': 0.8053043, 'recall': 0.7546296, 'specificity': 0.7546296, 'f1': 0.7440071, 'auroc': 0.8493227, 'binary_precision': 0.9296875, 'binary_recall': 0.5509259, 'binary_specificity': 0.9583333, 'binary_f1_score': 0.6918604}
confusion matrix:
     0    1
0  207    9
1   97  119
early stop counter: 2
val acc:0.748826265335083, best validation acc: 0.8661971688270569, corresponding to test acc:                         0.8287037014961243 / 0.8541666865348816
after epoch: 15,now: 2024-07-23 06:41:14.067672,epoch time: 0:01:11.689672,used: 0:17:58.813743,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_06_23_15_seed_2_22779259
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.99210525, 'precision': 0.9921247, 'recall': 0.9921553, 'specificity': 0.9921553, 'f1': 0.9921052, 'auroc': 0.9996996, 'binary_precision': 0.9980198, 'binary_recall': 0.98630136, 'binary_specificity': 0.99800926, 'binary_f1_score': 0.992126}
confusion matrix:
      0     1
0  1504     3
1    21  1512
---- Validation: 
scalar performance:
{'acc': 0.5946792, 'precision': 0.7659013, 'recall': 0.5837263, 'specificity': 0.5837263, 'f1': 0.50417924, 'auroc': 0.87145007, 'binary_precision': 0.9727273, 'binary_recall': 0.17202573, 'binary_specificity': 0.99542683, 'binary_f1_score': 0.29234976}
confusion matrix:
     0    1
0  653    3
1  515  107
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5277778, 'precision': 0.673913, 'recall': 0.5277778, 'specificity': 0.5277778, 'f1': 0.40219778, 'auroc': 0.79072356, 'binary_precision': 0.8333333, 'binary_recall': 0.06944445, 'binary_specificity': 0.9861111, 'binary_f1_score': 0.12820514}
confusion matrix:
     0   1
0  213   3
1  201  15
early stop counter: 3
val acc:0.5946791768074036, best validation acc: 0.8661971688270569, corresponding to test acc:                         0.8287037014961243 / 0.8541666865348816
after epoch: 16,now: 2024-07-23 06:42:25.830054,epoch time: 0:01:11.762382,used: 0:19:10.576125,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_06_23_15_seed_2_22779259
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9828947, 'precision': 0.9832692, 'recall': 0.98300815, 'specificity': 0.98300815, 'f1': 0.9828935, 'auroc': 0.9995537, 'binary_precision': 0.9986514, 'binary_recall': 0.9673416, 'binary_specificity': 0.99867463, 'binary_f1_score': 0.9827472}
confusion matrix:
      0     1
0  1507     2
1    50  1481
---- Validation: 
scalar performance:
{'acc': 0.65884197, 'precision': 0.78577447, 'recall': 0.64976764, 'specificity': 0.64976764, 'f1': 0.60857034, 'auroc': 0.90699625, 'binary_precision': 0.969697, 'binary_recall': 0.30868167, 'binary_specificity': 0.99085367, 'binary_f1_score': 0.46829262}
confusion matrix:
     0    1
0  650    6
1  430  192
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6805556, 'precision': 0.7831025, 'recall': 0.6805556, 'specificity': 0.6805556, 'f1': 0.64874744, 'auroc': 0.8904749, 'binary_precision': 0.95348835, 'binary_recall': 0.37962964, 'binary_specificity': 0.9814815, 'binary_f1_score': 0.5430464}
confusion matrix:
     0   1
0  212   4
1  134  82
early stop counter: 4
val acc:0.6588419675827026, best validation acc: 0.8661971688270569, corresponding to test acc:                         0.8287037014961243 / 0.8541666865348816
after epoch: 17,now: 2024-07-23 06:43:37.358584,epoch time: 0:01:11.528530,used: 0:20:22.104655,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_06_23_15_seed_2_22779259
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9884868, 'precision': 0.98868537, 'recall': 0.98841566, 'specificity': 0.98841566, 'f1': 0.98848355, 'auroc': 0.99951047, 'binary_precision': 0.98074454, 'binary_recall': 0.99673843, 'binary_specificity': 0.9800929, 'binary_f1_score': 0.9886768}
confusion matrix:
      0     1
0  1477    30
1     5  1528
---- Validation: 
scalar performance:
{'acc': 0.8325509, 'precision': 0.84051514, 'recall': 0.83047414, 'specificity': 0.83047414, 'f1': 0.8308541, 'auroc': 0.8908689, 'binary_precision': 0.8863636, 'binary_recall': 0.7524116, 'binary_specificity': 0.9085366, 'binary_f1_score': 0.81391305}
confusion matrix:
     0    1
0  596   60
1  154  468
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8101852, 'precision': 0.81085145, 'recall': 0.8101852, 'specificity': 0.8101852, 'f1': 0.81008345, 'auroc': 0.8927469, 'binary_precision': 0.8252427, 'binary_recall': 0.787037, 'binary_specificity': 0.8333333, 'binary_f1_score': 0.80568725}
confusion matrix:
     0    1
0  180   36
1   46  170
early stop counter: 5
val acc:0.8325508832931519, best validation acc: 0.8661971688270569, corresponding to test acc:                         0.8287037014961243 / 0.8541666865348816
after epoch: 18,now: 2024-07-23 06:44:49.222058,epoch time: 0:01:11.863474,used: 0:21:33.968129,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_06_23_15_seed_2_22779259
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.98717105, 'precision': 0.98732936, 'recall': 0.98712075, 'specificity': 0.98712075, 'f1': 0.9871685, 'auroc': 0.9996611, 'binary_precision': 0.98003864, 'binary_recall': 0.99477124, 'binary_specificity': 0.9794702, 'binary_f1_score': 0.98735}
confusion matrix:
      0     1
0  1479    31
1     8  1522
---- Validation: 
scalar performance:
{'acc': 0.87010956, 'precision': 0.8747036, 'recall': 0.8686427, 'specificity': 0.8686427, 'f1': 0.8693094, 'auroc': 0.91857016, 'binary_precision': 0.91007197, 'binary_recall': 0.8135048, 'binary_specificity': 0.9237805, 'binary_f1_score': 0.8590832}
confusion matrix:
     0    1
0  606   50
1  116  506
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8194444, 'precision': 0.81947184, 'recall': 0.8194444, 'specificity': 0.8194444, 'f1': 0.8194406, 'auroc': 0.91439474, 'binary_precision': 0.8224299, 'binary_recall': 0.8148148, 'binary_specificity': 0.8240741, 'binary_f1_score': 0.81860465}
confusion matrix:
     0    1
0  178   38
1   40  176
better model found
persisted
after epoch: 19,now: 2024-07-23 06:46:00.371675,epoch time: 0:01:11.149617,used: 0:22:45.117746,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_06_23_15_seed_2_22779259
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.99539477, 'precision': 0.9953902, 'recall': 0.99539965, 'specificity': 0.99539965, 'f1': 0.9953945, 'auroc': 0.99981946, 'binary_precision': 0.99607843, 'binary_recall': 0.9947781, 'binary_specificity': 0.9960212, 'binary_f1_score': 0.99542785}
confusion matrix:
      0     1
0  1502     6
1     8  1524
---- Validation: 
scalar performance:
{'acc': 0.80594677, 'precision': 0.83772486, 'recall': 0.80180967, 'specificity': 0.80180967, 'f1': 0.7996824, 'auroc': 0.9071568, 'binary_precision': 0.9348837, 'binary_recall': 0.6463022, 'binary_specificity': 0.95731705, 'binary_f1_score': 0.7642585}
confusion matrix:
     0    1
0  628   28
1  220  402
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8333333, 'precision': 0.8477639, 'recall': 0.8333334, 'specificity': 0.8333334, 'f1': 0.83158624, 'auroc': 0.8956619, 'binary_precision': 0.9186047, 'binary_recall': 0.7314815, 'binary_specificity': 0.9351852, 'binary_f1_score': 0.814433}
confusion matrix:
     0    1
0  202   14
1   58  158
early stop counter: 1
val acc:0.8059467673301697, best validation acc: 0.8701095581054688, corresponding to test acc:                         0.8194444179534912 / 0.8541666865348816
after epoch: 20,now: 2024-07-23 06:47:11.429600,epoch time: 0:01:11.057925,used: 0:23:56.175671,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_06_23_15_seed_2_22779259
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.99276316, 'precision': 0.99276924, 'recall': 0.9927565, 'specificity': 0.9927565, 'f1': 0.99276245, 'auroc': 0.99955416, 'binary_precision': 0.9921875, 'binary_recall': 0.9934811, 'binary_specificity': 0.9920319, 'binary_f1_score': 0.9928338}
confusion matrix:
      0     1
0  1494    12
1    10  1524
---- Validation: 
scalar performance:
{'acc': 0.827856, 'precision': 0.8511109, 'recall': 0.824401, 'specificity': 0.824401, 'f1': 0.82379574, 'auroc': 0.91156816, 'binary_precision': 0.9350649, 'binary_recall': 0.69453377, 'binary_specificity': 0.9542683, 'binary_f1_score': 0.797048}
confusion matrix:
     0    1
0  626   30
1  190  432
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8078704, 'precision': 0.81275725, 'recall': 0.8078704, 'specificity': 0.8078704, 'f1': 0.8071169, 'auroc': 0.87590027, 'binary_precision': 0.8518519, 'binary_recall': 0.7453704, 'binary_specificity': 0.8703704, 'binary_f1_score': 0.7950617}
confusion matrix:
     0    1
0  188   28
1   55  161
early stop counter: 2
val acc:0.8278560042381287, best validation acc: 0.8701095581054688, corresponding to test acc:                         0.8194444179534912 / 0.8541666865348816
after epoch: 21,now: 2024-07-23 06:48:22.442367,epoch time: 0:01:11.012767,used: 0:25:07.188438,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_06_23_15_seed_2_22779259
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9930921, 'precision': 0.99308753, 'recall': 0.99310696, 'specificity': 0.99310696, 'f1': 0.993092, 'auroc': 0.99956286, 'binary_precision': 0.9954038, 'binary_recall': 0.9908497, 'binary_specificity': 0.99536425, 'binary_f1_score': 0.99312156}
confusion matrix:
      0     1
0  1503     7
1    14  1516
---- Validation: 
scalar performance:
{'acc': 0.82159626, 'precision': 0.8508411, 'recall': 0.8177202, 'specificity': 0.8177202, 'f1': 0.81644964, 'auroc': 0.8972703, 'binary_precision': 0.94570136, 'binary_recall': 0.67202574, 'binary_specificity': 0.9634146, 'binary_f1_score': 0.7857143}
confusion matrix:
     0    1
0  632   24
1  204  418
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8425926, 'precision': 0.87335324, 'recall': 0.8425926, 'specificity': 0.8425926, 'f1': 0.8392822, 'auroc': 0.9194316, 'binary_precision': 0.9805195, 'binary_recall': 0.6990741, 'binary_specificity': 0.9861111, 'binary_f1_score': 0.81621623}
confusion matrix:
     0    1
0  213    3
1   65  151
early stop counter: 3
val acc:0.8215962648391724, best validation acc: 0.8701095581054688, corresponding to test acc:                         0.8194444179534912 / 0.8541666865348816
after epoch: 22,now: 2024-07-23 06:49:34.038579,epoch time: 0:01:11.596212,used: 0:26:18.784650,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_06_23_15_seed_2_22779259
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.99013156, 'precision': 0.9901744, 'recall': 0.9901744, 'specificity': 0.9901744, 'f1': 0.99013156, 'auroc': 0.99935853, 'binary_precision': 0.9966887, 'binary_recall': 0.9836601, 'binary_specificity': 0.9966887, 'binary_f1_score': 0.99013156}
confusion matrix:
      0     1
0  1505     5
1    25  1505
---- Validation: 
scalar performance:
{'acc': 0.7902973, 'precision': 0.82020074, 'recall': 0.78614914, 'specificity': 0.78614914, 'f1': 0.78352785, 'auroc': 0.8907335, 'binary_precision': 0.9116279, 'binary_recall': 0.63022506, 'binary_specificity': 0.94207317, 'binary_f1_score': 0.7452471}
confusion matrix:
     0    1
0  618   38
1  230  392
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7986111, 'precision': 0.8040925, 'recall': 0.7986111, 'specificity': 0.7986111, 'f1': 0.79769945, 'auroc': 0.86775553, 'binary_precision': 0.8449198, 'binary_recall': 0.7314815, 'binary_specificity': 0.8657407, 'binary_f1_score': 0.7841191}
confusion matrix:
     0    1
0  187   29
1   58  158
early stop counter: 4
val acc:0.7902973294258118, best validation acc: 0.8701095581054688, corresponding to test acc:                         0.8194444179534912 / 0.8541666865348816
after epoch: 23,now: 2024-07-23 06:50:45.181594,epoch time: 0:01:11.143015,used: 0:27:29.927665,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_06_23_15_seed_2_22779259
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9917763, 'precision': 0.9917702, 'recall': 0.9917836, 'specificity': 0.9917836, 'f1': 0.991776, 'auroc': 0.9994905, 'binary_precision': 0.9928058, 'binary_recall': 0.9908616, 'binary_specificity': 0.9927056, 'binary_f1_score': 0.99183273}
confusion matrix:
      0     1
0  1497    11
1    14  1518
---- Validation: 
scalar performance:
{'acc': 0.7292645, 'precision': 0.8092433, 'recall': 0.7223649, 'specificity': 0.7223649, 'f1': 0.7064892, 'auroc': 0.90130126, 'binary_precision': 0.96, 'binary_recall': 0.4630225, 'binary_specificity': 0.98170733, 'binary_f1_score': 0.6247288}
confusion matrix:
     0    1
0  644   12
1  334  288
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6064815, 'precision': 0.75141704, 'recall': 0.6064815, 'specificity': 0.6064815, 'f1': 0.5402184, 'auroc': 0.8637689, 'binary_precision': 0.9423077, 'binary_recall': 0.22685185, 'binary_specificity': 0.9861111, 'binary_f1_score': 0.36567166}
confusion matrix:
     0   1
0  213   3
1  167  49
early stop counter: 5
val acc:0.729264497756958, best validation acc: 0.8701095581054688, corresponding to test acc:                         0.8194444179534912 / 0.8541666865348816
after epoch: 24,now: 2024-07-23 06:51:56.642793,epoch time: 0:01:11.461199,used: 0:28:41.388864,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_06_23_15_seed_2_22779259
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.99111843, 'precision': 0.99117273, 'recall': 0.99117756, 'specificity': 0.99117756, 'f1': 0.99111843, 'auroc': 0.9994228, 'binary_precision': 0.99867463, 'binary_recall': 0.98368144, 'binary_specificity': 0.99867374, 'binary_f1_score': 0.99112135}
confusion matrix:
      0     1
0  1506     2
1    25  1507
---- Validation: 
scalar performance:
{'acc': 0.6885759, 'precision': 0.78674316, 'recall': 0.68060595, 'specificity': 0.68060595, 'f1': 0.653618, 'auroc': 0.88452625, 'binary_precision': 0.948, 'binary_recall': 0.38102895, 'binary_specificity': 0.98018295, 'binary_f1_score': 0.54357797}
confusion matrix:
     0    1
0  643   13
1  385  237
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6689815, 'precision': 0.7426219, 'recall': 0.66898143, 'specificity': 0.66898143, 'f1': 0.6418014, 'auroc': 0.8640903, 'binary_precision': 0.87628865, 'binary_recall': 0.3935185, 'binary_specificity': 0.9444444, 'binary_f1_score': 0.543131}
confusion matrix:
     0   1
0  204  12
1  131  85
early stop counter: 6
val acc:0.6885759234428406, best validation acc: 0.8701095581054688, corresponding to test acc:                         0.8194444179534912 / 0.8541666865348816
after epoch: 25,now: 2024-07-23 06:53:07.636533,epoch time: 0:01:10.993740,used: 0:29:52.382604,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_06_23_15_seed_2_22779259
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.99210525, 'precision': 0.9921572, 'recall': 0.9921572, 'specificity': 0.9921572, 'f1': 0.99210525, 'auroc': 0.99965763, 'binary_precision': 0.9993373, 'binary_recall': 0.9849771, 'binary_specificity': 0.9993373, 'binary_f1_score': 0.99210525}
confusion matrix:
      0     1
0  1508     1
1    23  1508
---- Validation: 
scalar performance:
{'acc': 0.7856025, 'precision': 0.83062196, 'recall': 0.7806177, 'specificity': 0.7806177, 'f1': 0.7758939, 'auroc': 0.90064263, 'binary_precision': 0.9461538, 'binary_recall': 0.5932476, 'binary_specificity': 0.9679878, 'binary_f1_score': 0.72924906}
confusion matrix:
     0    1
0  635   21
1  253  369
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7222222, 'precision': 0.80003476, 'recall': 0.7222222, 'specificity': 0.7222222, 'f1': 0.7029635, 'auroc': 0.86496913, 'binary_precision': 0.9528302, 'binary_recall': 0.4675926, 'binary_specificity': 0.9768519, 'binary_f1_score': 0.6273292}
confusion matrix:
     0    1
0  211    5
1  115  101
early stop counter: 7
val acc:0.7856025099754333, best validation acc: 0.8701095581054688, corresponding to test acc:                         0.8194444179534912 / 0.8541666865348816
after epoch: 26,now: 2024-07-23 06:54:18.968460,epoch time: 0:01:11.331927,used: 0:31:03.714531,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_06_23_15_seed_2_22779259
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.99572366, 'precision': 0.99571824, 'recall': 0.99573433, 'specificity': 0.99573433, 'f1': 0.99572355, 'auroc': 0.9997952, 'binary_precision': 0.99737704, 'binary_recall': 0.9941176, 'binary_specificity': 0.997351, 'binary_f1_score': 0.99574465}
confusion matrix:
      0     1
0  1506     4
1     9  1521
---- Validation: 
scalar performance:
{'acc': 0.6173709, 'precision': 0.76930165, 'recall': 0.6071215, 'specificity': 0.6071215, 'f1': 0.54387623, 'auroc': 0.85891545, 'binary_precision': 0.96503496, 'binary_recall': 0.22186495, 'binary_specificity': 0.99237806, 'binary_f1_score': 0.36078432}
confusion matrix:
     0    1
0  651    5
1  484  138
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6180556, 'precision': 0.77420723, 'recall': 0.6180556, 'specificity': 0.6180556, 'f1': 0.5546531, 'auroc': 0.86769116, 'binary_precision': 0.9811321, 'binary_recall': 0.24074075, 'binary_specificity': 0.9953704, 'binary_f1_score': 0.38661712}
confusion matrix:
     0   1
0  215   1
1  164  52
early stop counter: 8
val acc:0.6173709034919739, best validation acc: 0.8701095581054688, corresponding to test acc:                         0.8194444179534912 / 0.8541666865348816
after epoch: 27,now: 2024-07-23 06:55:30.464441,epoch time: 0:01:11.495981,used: 0:32:15.210512,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_06_23_15_seed_2_22779259
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.99572366, 'precision': 0.99571455, 'recall': 0.99574304, 'specificity': 0.99574304, 'f1': 0.9957235, 'auroc': 0.9999113, 'binary_precision': 0.99803406, 'binary_recall': 0.99347687, 'binary_specificity': 0.99800926, 'binary_f1_score': 0.99575025}
confusion matrix:
      0     1
0  1504     3
1    10  1523
---- Validation: 
scalar performance:
{'acc': 0.68466353, 'precision': 0.7899553, 'recall': 0.67646164, 'specificity': 0.67646164, 'f1': 0.6470908, 'auroc': 0.9051564, 'binary_precision': 0.95815897, 'binary_recall': 0.3681672, 'binary_specificity': 0.9847561, 'binary_f1_score': 0.5319396}
confusion matrix:
     0    1
0  646   10
1  393  229
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5231481, 'precision': 0.6197339, 'recall': 0.5231481, 'specificity': 0.5231481, 'f1': 0.40269014, 'auroc': 0.80806327, 'binary_precision': 0.72727275, 'binary_recall': 0.074074075, 'binary_specificity': 0.9722222, 'binary_f1_score': 0.13445379}
confusion matrix:
     0   1
0  210   6
1  200  16
early stop counter: 9
val acc:0.6846635341644287, best validation acc: 0.8701095581054688, corresponding to test acc:                         0.8194444179534912 / 0.8541666865348816
after epoch: 28,now: 2024-07-23 06:56:41.860413,epoch time: 0:01:11.395972,used: 0:33:26.606484,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_06_23_15_seed_2_22779259
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9924342, 'precision': 0.9924362, 'recall': 0.9924317, 'specificity': 0.9924317, 'f1': 0.9924338, 'auroc': 0.9998026, 'binary_precision': 0.992162, 'binary_recall': 0.9928104, 'binary_specificity': 0.992053, 'binary_f1_score': 0.99248606}
confusion matrix:
      0     1
0  1498    12
1    11  1519
---- Validation: 
scalar performance:
{'acc': 0.6823161, 'precision': 0.7752019, 'recall': 0.6743834, 'specificity': 0.6743834, 'f1': 0.6470449, 'auroc': 0.89011586, 'binary_precision': 0.9285714, 'binary_recall': 0.3762058, 'binary_specificity': 0.972561, 'binary_f1_score': 0.5354691}
confusion matrix:
     0    1
0  638   18
1  388  234
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8055556, 'precision': 0.84375, 'recall': 0.8055556, 'specificity': 0.8055556, 'f1': 0.8000001, 'auroc': 0.91463053, 'binary_precision': 0.9583333, 'binary_recall': 0.6388889, 'binary_specificity': 0.9722222, 'binary_f1_score': 0.76666665}
confusion matrix:
     0    1
0  210    6
1   78  138
early stop counter: 10
val acc:0.6823161244392395, best validation acc: 0.8701095581054688, corresponding to test acc:                         0.8194444179534912 / 0.8541666865348816
after epoch: 29,now: 2024-07-23 06:57:53.255615,epoch time: 0:01:11.395202,used: 0:34:38.001686,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_06_23_15_seed_2_22779259
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.9924342, 'precision': 0.9925195, 'recall': 0.9923948, 'specificity': 0.9923948, 'f1': 0.99243295, 'auroc': 0.99988616, 'binary_precision': 0.98771816, 'binary_recall': 0.997389, 'binary_specificity': 0.98740053, 'binary_f1_score': 0.99253005}
confusion matrix:
      0     1
0  1489    19
1     4  1528
---- Validation: 
scalar performance:
{'acc': 0.842723, 'precision': 0.85305274, 'recall': 0.8404243, 'specificity': 0.8404243, 'f1': 0.8408402, 'auroc': 0.90562505, 'binary_precision': 0.90715665, 'binary_recall': 0.7540193, 'binary_specificity': 0.9268293, 'binary_f1_score': 0.8235294}
confusion matrix:
     0    1
0  608   48
1  153  469
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8449074, 'precision': 0.8461613, 'recall': 0.8449074, 'specificity': 0.8449074, 'f1': 0.84476686, 'auroc': 0.9001415, 'binary_precision': 0.8669951, 'binary_recall': 0.8148148, 'binary_specificity': 0.875, 'binary_f1_score': 0.84009546}
confusion matrix:
     0    1
0  189   27
1   40  176
early stop counter: 11
val acc:0.84272301197052, best validation acc: 0.8701095581054688, corresponding to test acc:                         0.8194444179534912 / 0.8541666865348816
after epoch: 30,now: 2024-07-23 06:59:05.018676,epoch time: 0:01:11.763061,used: 0:35:49.764747,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_06_23_15_seed_2_22779259
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 0:35:49.764747 at 2024-07-23 06:59:05.018676
persisted model performance metric: 

scalar performance:
{'acc': 0.8194444, 'precision': 0.81947184, 'recall': 0.8194444, 'specificity': 0.8194444, 'f1': 0.8194406, 'auroc': 0.91439474, 'binary_precision': 0.8224299, 'binary_recall': 0.8148148, 'binary_specificity': 0.8240741, 'binary_f1_score': 0.81860465}
confusion matrix:
     0    1
0  178   38
1   40  176
oracle model performance metric: 

scalar performance:
{'acc': 0.8541667, 'precision': 0.85897547, 'recall': 0.8541666, 'specificity': 0.8541666, 'f1': 0.8536767, 'auroc': 0.91238, 'binary_precision': 0.90052354, 'binary_recall': 0.7962963, 'binary_specificity': 0.912037, 'binary_f1_score': 0.8452089}
confusion matrix:
     0    1
0  197   19
1   44  172
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_dial_lr1e5_bs32_nofreeze_2024-07-23_01-16-41/rule_results/3.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_dial_lr1e5_bs32_nofreeze_2024-07-23_01-16-41/confusion_matrix/3.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 451685 KiB |  26075 MiB | 215764 GiB | 215764 GiB |
|       from large pool | 411132 KiB |  26030 MiB | 214418 GiB | 214418 GiB |
|       from small pool |  40553 KiB |     60 MiB |   1346 GiB |   1346 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 451685 KiB |  26075 MiB | 215764 GiB | 215764 GiB |
|       from large pool | 411132 KiB |  26030 MiB | 214418 GiB | 214418 GiB |
|       from small pool |  40553 KiB |     60 MiB |   1346 GiB |   1346 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 447481 KiB |  26071 MiB | 215724 GiB | 215723 GiB |
|       from large pool | 407075 KiB |  26026 MiB | 214380 GiB | 214380 GiB |
|       from small pool |  40406 KiB |     60 MiB |   1343 GiB |   1343 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  27778 MiB |  27778 MiB |  80914 MiB |  53136 MiB |
|       from large pool |  27710 MiB |  27710 MiB |  80820 MiB |  53110 MiB |
|       from small pool |     68 MiB |     72 MiB |     94 MiB |     26 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 775066 KiB |   1679 MiB |  97329 GiB |  97328 GiB |
|       from large pool | 758276 KiB |   1676 MiB |  95973 GiB |  95972 GiB |
|       from small pool |  16790 KiB |     31 MiB |   1355 GiB |   1355 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    1220    |    2570    |   19512 K  |   19511 K  |
|       from large pool |     187    |    1413    |    9879 K  |    9878 K  |
|       from small pool |    1033    |    1335    |    9633 K  |    9632 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    1220    |    2570    |   19512 K  |   19511 K  |
|       from large pool |     187    |    1413    |    9879 K  |    9878 K  |
|       from small pool |    1033    |    1335    |    9633 K  |    9632 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     837    |     837    |    2369    |    1532    |
|       from large pool |     803    |     803    |    2322    |    1519    |
|       from small pool |      34    |      36    |      47    |      13    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     115    |     853    |   14226 K  |   14226 K  |
|       from large pool |      47    |     805    |    8785 K  |    8785 K  |
|       from small pool |      68    |     146    |    5440 K  |    5440 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  26075 MiB | 215764 GiB | 215764 GiB |
|       from large pool |  16640 KiB |  26030 MiB | 214418 GiB | 214418 GiB |
|       from small pool |      0 KiB |     60 MiB |   1346 GiB |   1346 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  26075 MiB | 215764 GiB | 215764 GiB |
|       from large pool |  16640 KiB |  26030 MiB | 214418 GiB | 214418 GiB |
|       from small pool |      0 KiB |     60 MiB |   1346 GiB |   1346 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  26071 MiB | 215724 GiB | 215724 GiB |
|       from large pool |  16640 KiB |  26026 MiB | 214380 GiB | 214380 GiB |
|       from small pool |      0 KiB |     60 MiB |   1343 GiB |   1343 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1198 MiB |  27778 MiB |  80914 MiB |  79716 MiB |
|       from large pool |   1142 MiB |  27710 MiB |  80820 MiB |  79678 MiB |
|       from small pool |     56 MiB |     72 MiB |     94 MiB |     38 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |   3840 KiB |   1679 MiB |  97329 GiB |  97329 GiB |
|       from large pool |   3840 KiB |   1676 MiB |  95973 GiB |  95973 GiB |
|       from small pool |      0 KiB |     32 MiB |   1355 GiB |   1355 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    2570    |   19512 K  |   19512 K  |
|       from large pool |       2    |    1413    |    9879 K  |    9879 K  |
|       from small pool |       0    |    1335    |    9633 K  |    9633 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    2570    |   19512 K  |   19512 K  |
|       from large pool |       2    |    1413    |    9879 K  |    9879 K  |
|       from small pool |       0    |    1335    |    9633 K  |    9633 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      71    |     837    |    2369    |    2298    |
|       from large pool |      43    |     803    |    2322    |    2279    |
|       from small pool |      28    |      36    |      47    |      19    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       1    |     853    |   14226 K  |   14226 K  |
|       from large pool |       1    |     805    |    8785 K  |    8785 K  |
|       from small pool |       0    |     146    |    5440 K  |    5440 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Tue Jul 23 06:59:49 2024]
Finished job 0.
1 of 1 steps (100%) done
