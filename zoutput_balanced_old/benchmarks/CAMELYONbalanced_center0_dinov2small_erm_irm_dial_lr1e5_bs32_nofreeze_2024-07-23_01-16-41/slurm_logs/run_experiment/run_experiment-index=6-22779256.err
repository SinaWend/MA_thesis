Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Tue Jul 23 04:10:01 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_dial_lr1e5_bs32_nofreeze_2024-07-23_01-16-41/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_dial_lr1e5_bs32_nofreeze_2024-07-23_01-16-41/rule_results/6.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=6
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/swiglu_ffn.py:51: UserWarning: xFormers is not available (SwiGLU)
  warnings.warn("xFormers is not available (SwiGLU)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/attention.py:33: UserWarning: xFormers is not available (Attention)
  warnings.warn("xFormers is not available (Attention)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/block.py:40: UserWarning: xFormers is not available (Block)
  warnings.warn("xFormers is not available (Block)")
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'888c1ef2'
model name: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_04_10_30_seed_0_22779256

 Experiment start at: 2024-07-23 04:10:30.335285
before training, model accuracy: 0.569767415523529
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9716797, 'precision': 0.97204787, 'recall': 0.9718888, 'specificity': 0.9718888, 'f1': 0.971679, 'auroc': 0.9971652, 'binary_precision': 0.98868173, 'binary_recall': 0.95498395, 'binary_specificity': 0.9887937, 'binary_f1_score': 0.9715407}
confusion matrix:
      0     1
0  1500    17
1    70  1485
---- Validation: 
scalar performance:
{'acc': 0.7795031, 'precision': 0.8245681, 'recall': 0.77687716, 'specificity': 0.77687716, 'f1': 0.7704342, 'auroc': 0.9152138, 'binary_precision': 0.9420655, 'binary_recall': 0.5889764, 'binary_specificity': 0.96477795, 'binary_f1_score': 0.72480625}
confusion matrix:
     0    1
0  630   23
1  261  374
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.82093024, 'precision': 0.8602127, 'recall': 0.82093024, 'specificity': 0.82093024, 'f1': 0.8159114, 'auroc': 0.92294216, 'binary_precision': 0.9791667, 'binary_recall': 0.65581393, 'binary_specificity': 0.9860465, 'binary_f1_score': 0.7855153}
confusion matrix:
     0    1
0  212    3
1   74  141
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-23 04:13:35.894138,epoch time: 0:03:05.558853,used: 0:03:05.558853,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_04_10_30_seed_0_22779256
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.96940106, 'precision': 0.97028315, 'recall': 0.96914995, 'specificity': 0.96914995, 'f1': 0.9693699, 'auroc': 0.9975815, 'binary_precision': 0.95291203, 'binary_recall': 0.9884319, 'binary_specificity': 0.9498681, 'binary_f1_score': 0.970347}
confusion matrix:
      0     1
0  1440    76
1    18  1538
---- Validation: 
scalar performance:
{'acc': 0.7950311, 'precision': 0.8074587, 'recall': 0.79360193, 'specificity': 0.79360193, 'f1': 0.7923631, 'auroc': 0.8835249, 'binary_precision': 0.8658777, 'binary_recall': 0.6913386, 'binary_specificity': 0.89586526, 'binary_f1_score': 0.76882666}
confusion matrix:
     0    1
0  585   68
1  196  439
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.83255816, 'precision': 0.83749366, 'recall': 0.83255816, 'specificity': 0.83255816, 'f1': 0.8319437, 'auroc': 0.92095184, 'binary_precision': 0.7966805, 'binary_recall': 0.89302325, 'binary_specificity': 0.772093, 'binary_f1_score': 0.84210527}
confusion matrix:
     0    1
0  166   49
1   23  192
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-07-23 04:16:22.870239,epoch time: 0:02:46.976101,used: 0:05:52.534954,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_04_10_30_seed_0_22779256
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.96484375, 'precision': 0.96646273, 'recall': 0.96533316, 'specificity': 0.96533316, 'f1': 0.96483207, 'auroc': 0.9982618, 'binary_precision': 0.99794096, 'binary_recall': 0.93264914, 'binary_specificity': 0.9980172, 'binary_f1_score': 0.96419096}
confusion matrix:
      0     1
0  1510     3
1   105  1454
---- Validation: 
scalar performance:
{'acc': 0.67701864, 'precision': 0.7820072, 'recall': 0.6727014, 'specificity': 0.6727014, 'f1': 0.6406009, 'auroc': 0.9030206, 'binary_precision': 0.9506173, 'binary_recall': 0.36377952, 'binary_specificity': 0.9816233, 'binary_f1_score': 0.5261959}
confusion matrix:
     0    1
0  641   12
1  404  231
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.627907, 'precision': 0.78666663, 'recall': 0.627907, 'specificity': 0.627907, 'f1': 0.56811047, 'auroc': 0.89023256, 'binary_precision': 1.0, 'binary_recall': 0.25581396, 'binary_specificity': 1.0, 'binary_f1_score': 0.4074074}
confusion matrix:
     0   1
0  215   0
1  160  55
early stop counter: 1
val acc:0.6770186424255371, best validation acc: 0.7950310707092285, corresponding to test acc:                         0.8325581550598145 / 0.8325581550598145
after epoch: 3,now: 2024-07-23 04:19:09.390537,epoch time: 0:02:46.520298,used: 0:08:39.055252,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_04_10_30_seed_0_22779256
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9736328, 'precision': 0.9746082, 'recall': 0.9740051, 'specificity': 0.9740051, 'f1': 0.973629, 'auroc': 0.9995315, 'binary_precision': 1.0, 'binary_recall': 0.94801027, 'binary_specificity': 1.0, 'binary_f1_score': 0.9733114}
confusion matrix:
      0     1
0  1514     0
1    81  1477
---- Validation: 
scalar performance:
{'acc': 0.59006214, 'precision': 0.75531906, 'recall': 0.5843605, 'specificity': 0.5843605, 'f1': 0.5041993, 'auroc': 0.91315436, 'binary_precision': 0.95726496, 'binary_recall': 0.17637795, 'binary_specificity': 0.992343, 'binary_f1_score': 0.29787233}
confusion matrix:
     0    1
0  648    5
1  523  112
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6976744, 'precision': 0.8115942, 'recall': 0.6976744, 'specificity': 0.6976744, 'f1': 0.66726196, 'auroc': 0.91675496, 'binary_precision': 1.0, 'binary_recall': 0.39534885, 'binary_specificity': 1.0, 'binary_f1_score': 0.5666667}
confusion matrix:
     0   1
0  215   0
1  130  85
early stop counter: 2
val acc:0.590062141418457, best validation acc: 0.7950310707092285, corresponding to test acc:                         0.8325581550598145 / 0.8325581550598145
after epoch: 4,now: 2024-07-23 04:21:55.873646,epoch time: 0:02:46.483109,used: 0:11:25.538361,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_04_10_30_seed_0_22779256
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.98535156, 'precision': 0.9853742, 'recall': 0.9853279, 'specificity': 0.9853279, 'f1': 0.98534846, 'auroc': 0.9988613, 'binary_precision': 0.98398465, 'binary_recall': 0.98714656, 'binary_specificity': 0.98350924, 'binary_f1_score': 0.9855631}
confusion matrix:
      0     1
0  1491    25
1    20  1536
---- Validation: 
scalar performance:
{'acc': 0.6614907, 'precision': 0.75052154, 'recall': 0.6572572, 'specificity': 0.6572572, 'f1': 0.62495625, 'auroc': 0.7738216, 'binary_precision': 0.89641434, 'binary_recall': 0.35433072, 'binary_specificity': 0.96018374, 'binary_f1_score': 0.50790066}
confusion matrix:
     0    1
0  627   26
1  410  225
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8604651, 'precision': 0.8793743, 'recall': 0.86046517, 'specificity': 0.86046517, 'f1': 0.85870445, 'auroc': 0.9235262, 'binary_precision': 0.96407187, 'binary_recall': 0.74883723, 'binary_specificity': 0.97209305, 'binary_f1_score': 0.8429319}
confusion matrix:
     0    1
0  209    6
1   54  161
new oracle model saved
early stop counter: 3
val acc:0.6614906787872314, best validation acc: 0.7950310707092285, corresponding to test acc:                         0.8325581550598145 / 0.8604651093482971
after epoch: 5,now: 2024-07-23 04:24:42.437464,epoch time: 0:02:46.563818,used: 0:14:12.102179,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_04_10_30_seed_0_22779256
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.97298175, 'precision': 0.97403, 'recall': 0.9733462, 'specificity': 0.9733462, 'f1': 0.972977, 'auroc': 0.99904823, 'binary_precision': 1.0, 'binary_recall': 0.94669235, 'binary_specificity': 1.0, 'binary_f1_score': 0.9726163}
confusion matrix:
      0     1
0  1515     0
1    83  1474
---- Validation: 
scalar performance:
{'acc': 0.58540374, 'precision': 0.7527536, 'recall': 0.5796361, 'specificity': 0.5796361, 'f1': 0.49618948, 'auroc': 0.89409876, 'binary_precision': 0.954955, 'binary_recall': 0.16692914, 'binary_specificity': 0.992343, 'binary_f1_score': 0.28418234}
confusion matrix:
     0    1
0  648    5
1  529  106
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.51860464, 'precision': 0.75473934, 'recall': 0.51860464, 'specificity': 0.51860464, 'f1': 0.37339407, 'auroc': 0.9095079, 'binary_precision': 1.0, 'binary_recall': 0.037209302, 'binary_specificity': 1.0, 'binary_f1_score': 0.07174888}
confusion matrix:
     0  1
0  215  0
1  207  8
early stop counter: 4
val acc:0.5854037404060364, best validation acc: 0.7950310707092285, corresponding to test acc:                         0.8325581550598145 / 0.8604651093482971
after epoch: 6,now: 2024-07-23 04:27:28.979758,epoch time: 0:02:46.542294,used: 0:16:58.644473,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_04_10_30_seed_0_22779256
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.98567706, 'precision': 0.98577523, 'recall': 0.9858494, 'specificity': 0.9858494, 'f1': 0.98567694, 'auroc': 0.99892354, 'binary_precision': 0.9973736, 'binary_recall': 0.9743425, 'binary_specificity': 0.99735624, 'binary_f1_score': 0.98572356}
confusion matrix:
      0     1
0  1509     4
1    40  1519
---- Validation: 
scalar performance:
{'acc': 0.73602486, 'precision': 0.7642015, 'recall': 0.7336943, 'specificity': 0.7336943, 'f1': 0.7274854, 'auroc': 0.8562877, 'binary_precision': 0.84705883, 'binary_recall': 0.56692916, 'binary_specificity': 0.9004594, 'binary_f1_score': 0.6792453}
confusion matrix:
     0    1
0  588   65
1  275  360
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8, 'precision': 0.820199, 'recall': 0.8, 'specificity': 0.8, 'f1': 0.79679537, 'auroc': 0.8887615, 'binary_precision': 0.9006211, 'binary_recall': 0.6744186, 'binary_specificity': 0.9255814, 'binary_f1_score': 0.7712766}
confusion matrix:
     0    1
0  199   16
1   70  145
early stop counter: 5
val acc:0.7360248565673828, best validation acc: 0.7950310707092285, corresponding to test acc:                         0.8325581550598145 / 0.8604651093482971
after epoch: 7,now: 2024-07-23 04:30:15.530985,epoch time: 0:02:46.551227,used: 0:19:45.195700,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_04_10_30_seed_0_22779256
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 7 with time: 0:19:45.195700 at 2024-07-23 04:30:15.530985
persisted model performance metric: 

scalar performance:
{'acc': 0.83255816, 'precision': 0.83749366, 'recall': 0.83255816, 'specificity': 0.83255816, 'f1': 0.8319437, 'auroc': 0.92095184, 'binary_precision': 0.7966805, 'binary_recall': 0.89302325, 'binary_specificity': 0.772093, 'binary_f1_score': 0.84210527}
confusion matrix:
     0    1
0  166   49
1   23  192
oracle model performance metric: 

scalar performance:
{'acc': 0.8604651, 'precision': 0.8793743, 'recall': 0.86046517, 'specificity': 0.86046517, 'f1': 0.85870445, 'auroc': 0.9235262, 'binary_precision': 0.96407187, 'binary_recall': 0.74883723, 'binary_specificity': 0.97209305, 'binary_f1_score': 0.8429319}
confusion matrix:
     0    1
0  209    6
1   54  161
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_dial_lr1e5_bs32_nofreeze_2024-07-23_01-16-41/rule_results/6.csv
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_dial_lr1e5_bs32_nofreeze_2024-07-23_01-16-41/rule_results/6.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_dial_lr1e5_bs32_nofreeze_2024-07-23_01-16-41/confusion_matrix/6.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 453536 KiB |  13225 MiB |  42610 GiB |  42609 GiB |
|       from large pool | 412983 KiB |  13186 MiB |  42356 GiB |  42356 GiB |
|       from small pool |  40553 KiB |     56 MiB |    253 GiB |    253 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 453536 KiB |  13225 MiB |  42610 GiB |  42609 GiB |
|       from large pool | 412983 KiB |  13186 MiB |  42356 GiB |  42356 GiB |
|       from small pool |  40553 KiB |     56 MiB |    253 GiB |    253 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 447480 KiB |  13222 MiB |  42601 GiB |  42601 GiB |
|       from large pool | 407075 KiB |  13184 MiB |  42348 GiB |  42348 GiB |
|       from small pool |  40405 KiB |     56 MiB |    253 GiB |    253 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  14062 MiB |  14062 MiB |  14062 MiB |      0 B   |
|       from large pool |  13998 MiB |  13998 MiB |  13998 MiB |      0 B   |
|       from small pool |     64 MiB |     64 MiB |     64 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory | 537695 KiB |    873 MiB |  19856 GiB |  19856 GiB |
|       from large pool | 529097 KiB |    865 MiB |  19600 GiB |  19600 GiB |
|       from small pool |   8598 KiB |     14 MiB |    256 GiB |    256 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    1220    |    1672    |    3306 K  |    3305 K  |
|       from large pool |     187    |     783    |    2014 K  |    2014 K  |
|       from small pool |    1033    |    1329    |    1292 K  |    1291 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    1220    |    1672    |    3306 K  |    3305 K  |
|       from large pool |     187    |     783    |    2014 K  |    2014 K  |
|       from small pool |    1033    |    1329    |    1292 K  |    1291 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     440    |     440    |     440    |       0    |
|       from large pool |     408    |     408    |     408    |       0    |
|       from small pool |      32    |      32    |      32    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      78    |     459    |    2187 K  |    2187 K  |
|       from large pool |      36    |     410    |    1543 K  |    1543 K  |
|       from small pool |      42    |     124    |     644 K  |     644 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13225 MiB |  42610 GiB |  42610 GiB |
|       from large pool |  16640 KiB |  13186 MiB |  42356 GiB |  42356 GiB |
|       from small pool |      0 KiB |     56 MiB |    253 GiB |    253 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13225 MiB |  42610 GiB |  42610 GiB |
|       from large pool |  16640 KiB |  13186 MiB |  42356 GiB |  42356 GiB |
|       from small pool |      0 KiB |     56 MiB |    253 GiB |    253 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13222 MiB |  42601 GiB |  42601 GiB |
|       from large pool |  16640 KiB |  13184 MiB |  42348 GiB |  42348 GiB |
|       from small pool |      0 KiB |     56 MiB |    253 GiB |    253 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    968 MiB |  14062 MiB |  14062 MiB |  13094 MiB |
|       from large pool |    920 MiB |  13998 MiB |  13998 MiB |  13078 MiB |
|       from small pool |     48 MiB |     64 MiB |     64 MiB |     16 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |   3840 KiB |    873 MiB |  19857 GiB |  19857 GiB |
|       from large pool |   3840 KiB |    865 MiB |  19601 GiB |  19601 GiB |
|       from small pool |      0 KiB |     36 MiB |    256 GiB |    256 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    1672    |    3306 K  |    3306 K  |
|       from large pool |       2    |     783    |    2014 K  |    2014 K  |
|       from small pool |       0    |    1329    |    1292 K  |    1292 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    1672    |    3306 K  |    3306 K  |
|       from large pool |       2    |     783    |    2014 K  |    2014 K  |
|       from small pool |       0    |    1329    |    1292 K  |    1292 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      61    |     440    |     440    |     379    |
|       from large pool |      37    |     408    |     408    |     371    |
|       from small pool |      24    |      32    |      32    |       8    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       1    |     459    |    2187 K  |    2187 K  |
|       from large pool |       1    |     410    |    1543 K  |    1543 K  |
|       from small pool |       0    |     124    |     644 K  |     644 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13225 MiB |  42610 GiB |  42610 GiB |
|       from large pool |  16640 KiB |  13186 MiB |  42356 GiB |  42356 GiB |
|       from small pool |      0 KiB |     56 MiB |    253 GiB |    253 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13225 MiB |  42610 GiB |  42610 GiB |
|       from large pool |  16640 KiB |  13186 MiB |  42356 GiB |  42356 GiB |
|       from small pool |      0 KiB |     56 MiB |    253 GiB |    253 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13222 MiB |  42601 GiB |  42601 GiB |
|       from large pool |  16640 KiB |  13184 MiB |  42348 GiB |  42348 GiB |
|       from small pool |      0 KiB |     56 MiB |    253 GiB |    253 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    968 MiB |  14062 MiB |  14062 MiB |  13094 MiB |
|       from large pool |    920 MiB |  13998 MiB |  13998 MiB |  13078 MiB |
|       from small pool |     48 MiB |     64 MiB |     64 MiB |     16 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |   3840 KiB |    873 MiB |  19857 GiB |  19857 GiB |
|       from large pool |   3840 KiB |    865 MiB |  19601 GiB |  19601 GiB |
|       from small pool |      0 KiB |     36 MiB |    256 GiB |    256 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    1672    |    3306 K  |    3306 K  |
|       from large pool |       2    |     783    |    2014 K  |    2014 K  |
|       from small pool |       0    |    1329    |    1292 K  |    1292 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    1672    |    3306 K  |    3306 K  |
|       from large pool |       2    |     783    |    2014 K  |    2014 K  |
|       from small pool |       0    |    1329    |    1292 K  |    1292 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      61    |     440    |     440    |     379    |
|       from large pool |      37    |     408    |     408    |     371    |
|       from small pool |      24    |      32    |      32    |       8    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       1    |     459    |    2187 K  |    2187 K  |
|       from large pool |       1    |     410    |    1543 K  |    1543 K  |
|       from small pool |       0    |     124    |     644 K  |     644 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'888c1ef2'
model name: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_04_31_22_seed_1_22779256

 Experiment start at: 2024-07-23 04:31:22.072053
before training, model accuracy: 0.6177777647972107
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9589844, 'precision': 0.96156406, 'recall': 0.9594775, 'specificity': 0.9594775, 'f1': 0.9589522, 'auroc': 0.99464464, 'binary_precision': 0.9993012, 'binary_recall': 0.91961414, 'binary_specificity': 0.99934083, 'binary_f1_score': 0.9578031}
confusion matrix:
      0     1
0  1516     1
1   125  1430
---- Validation: 
scalar performance:
{'acc': 0.8071819, 'precision': 0.82381594, 'recall': 0.8052995, 'specificity': 0.8052995, 'f1': 0.8039689, 'auroc': 0.90495694, 'binary_precision': 0.8932238, 'binary_recall': 0.6904762, 'binary_specificity': 0.92012286, 'binary_f1_score': 0.778872}
confusion matrix:
     0    1
0  599   52
1  195  435
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8111111, 'precision': 0.83408284, 'recall': 0.8111111, 'specificity': 0.8111111, 'f1': 0.8078073, 'auroc': 0.9159703, 'binary_precision': 0.92168677, 'binary_recall': 0.68, 'binary_specificity': 0.94222224, 'binary_f1_score': 0.78260875}
confusion matrix:
     0    1
0  212   13
1   72  153
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-23 04:34:12.672022,epoch time: 0:02:50.599969,used: 0:02:50.599969,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_04_31_22_seed_1_22779256
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.94401044, 'precision': 0.94908226, 'recall': 0.9446945, 'specificity': 0.9446945, 'f1': 0.9439037, 'auroc': 0.9978334, 'binary_precision': 1.0, 'binary_recall': 0.88938904, 'binary_specificity': 1.0, 'binary_f1_score': 0.94145674}
confusion matrix:
      0     1
0  1517     0
1   172  1383
---- Validation: 
scalar performance:
{'acc': 0.57377046, 'precision': 0.7606397, 'recall': 0.56671786, 'specificity': 0.56671786, 'f1': 0.4717294, 'auroc': 0.91714704, 'binary_precision': 0.97727275, 'binary_recall': 0.13650794, 'binary_specificity': 0.9969278, 'binary_f1_score': 0.23955432}
confusion matrix:
     0   1
0  649   2
1  544  86
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.51555556, 'precision': 0.6984127, 'recall': 0.51555556, 'specificity': 0.51555556, 'f1': 0.3705244, 'auroc': 0.91431105, 'binary_precision': 0.8888889, 'binary_recall': 0.035555556, 'binary_specificity': 0.9955556, 'binary_f1_score': 0.06837607}
confusion matrix:
     0  1
0  224  1
1  217  8
early stop counter: 1
val acc:0.5737704634666443, best validation acc: 0.8071818947792053, corresponding to test acc:                         0.8111110925674438 / 0.8111110925674438
after epoch: 2,now: 2024-07-23 04:36:59.242615,epoch time: 0:02:46.570593,used: 0:05:37.170562,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_04_31_22_seed_1_22779256
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.96451825, 'precision': 0.96603405, 'recall': 0.9649035, 'specificity': 0.9649035, 'f1': 0.96450514, 'auroc': 0.99737895, 'binary_precision': 0.9958848, 'binary_recall': 0.9337621, 'binary_specificity': 0.9960448, 'binary_f1_score': 0.96382344}
confusion matrix:
      0     1
0  1511     6
1   103  1452
---- Validation: 
scalar performance:
{'acc': 0.69086653, 'precision': 0.792389, 'recall': 0.6859703, 'specificity': 0.6859703, 'f1': 0.6580205, 'auroc': 0.91579986, 'binary_precision': 0.96062994, 'binary_recall': 0.3873016, 'binary_specificity': 0.984639, 'binary_f1_score': 0.5520362}
confusion matrix:
     0    1
0  641   10
1  386  244
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.68666667, 'precision': 0.80737704, 'recall': 0.68666667, 'specificity': 0.68666667, 'f1': 0.65255535, 'auroc': 0.93127906, 'binary_precision': 1.0, 'binary_recall': 0.37333333, 'binary_specificity': 1.0, 'binary_f1_score': 0.5436893}
confusion matrix:
     0   1
0  225   0
1  141  84
early stop counter: 2
val acc:0.6908665299415588, best validation acc: 0.8071818947792053, corresponding to test acc:                         0.8111110925674438 / 0.8111110925674438
after epoch: 3,now: 2024-07-23 04:39:45.473468,epoch time: 0:02:46.230853,used: 0:08:23.401415,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_04_31_22_seed_1_22779256
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.98079425, 'precision': 0.98082733, 'recall': 0.98076314, 'specificity': 0.98076314, 'f1': 0.98079014, 'auroc': 0.9982933, 'binary_precision': 0.97887325, 'binary_recall': 0.98327976, 'binary_specificity': 0.9782465, 'binary_f1_score': 0.9810716}
confusion matrix:
      0     1
0  1484    33
1    26  1529
---- Validation: 
scalar performance:
{'acc': 0.8040593, 'precision': 0.8263125, 'recall': 0.80189455, 'specificity': 0.80189455, 'f1': 0.7998394, 'auroc': 0.9078024, 'binary_precision': 0.9075269, 'binary_recall': 0.6698413, 'binary_specificity': 0.9339478, 'binary_f1_score': 0.7707763}
confusion matrix:
     0    1
0  608   43
1  208  422
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7733333, 'precision': 0.82539684, 'recall': 0.7733333, 'specificity': 0.7733333, 'f1': 0.7638889, 'auroc': 0.910874, 'binary_precision': 0.95555556, 'binary_recall': 0.5733333, 'binary_specificity': 0.97333336, 'binary_f1_score': 0.71666664}
confusion matrix:
     0    1
0  219    6
1   96  129
early stop counter: 3
val acc:0.8040593266487122, best validation acc: 0.8071818947792053, corresponding to test acc:                         0.8111110925674438 / 0.8111110925674438
after epoch: 4,now: 2024-07-23 04:42:32.248057,epoch time: 0:02:46.774589,used: 0:11:10.176004,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_04_31_22_seed_1_22779256
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9820964, 'precision': 0.9823484, 'recall': 0.9822656, 'specificity': 0.9822656, 'f1': 0.9820962, 'auroc': 0.9992454, 'binary_precision': 0.9966865, 'binary_recall': 0.967825, 'binary_specificity': 0.9967062, 'binary_f1_score': 0.98204374}
confusion matrix:
      0     1
0  1513     5
1    50  1504
---- Validation: 
scalar performance:
{'acc': 0.7564403, 'precision': 0.8192843, 'recall': 0.75276494, 'specificity': 0.75276494, 'f1': 0.74200594, 'auroc': 0.9148514, 'binary_precision': 0.95689654, 'binary_recall': 0.5285714, 'binary_specificity': 0.9769585, 'binary_f1_score': 0.6809816}
confusion matrix:
     0    1
0  636   15
1  297  333
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.66, 'precision': 0.7849704, 'recall': 0.65999997, 'specificity': 0.65999997, 'f1': 0.6181343, 'auroc': 0.90625185, 'binary_precision': 0.9736842, 'binary_recall': 0.3288889, 'binary_specificity': 0.9911111, 'binary_f1_score': 0.49169436}
confusion matrix:
     0   1
0  223   2
1  151  74
early stop counter: 4
val acc:0.756440281867981, best validation acc: 0.8071818947792053, corresponding to test acc:                         0.8111110925674438 / 0.8111110925674438
after epoch: 5,now: 2024-07-23 04:45:18.734791,epoch time: 0:02:46.486734,used: 0:13:56.662738,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_04_31_22_seed_1_22779256
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.99348956, 'precision': 0.9934753, 'recall': 0.9935055, 'specificity': 0.9935055, 'f1': 0.99348867, 'auroc': 0.9998296, 'binary_precision': 0.9948454, 'binary_recall': 0.99228793, 'binary_specificity': 0.99472296, 'binary_f1_score': 0.993565}
confusion matrix:
      0     1
0  1508     8
1    12  1544
---- Validation: 
scalar performance:
{'acc': 0.8142077, 'precision': 0.84338367, 'recall': 0.8118024, 'specificity': 0.8118024, 'f1': 0.8093244, 'auroc': 0.9259522, 'binary_precision': 0.9394619, 'binary_recall': 0.66507936, 'binary_specificity': 0.95852536, 'binary_f1_score': 0.7788104}
confusion matrix:
     0    1
0  624   27
1  211  419
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8333333, 'precision': 0.86793566, 'recall': 0.8333334, 'specificity': 0.8333334, 'f1': 0.82932043, 'auroc': 0.9282963, 'binary_precision': 0.9807692, 'binary_recall': 0.68, 'binary_specificity': 0.9866667, 'binary_f1_score': 0.8031496}
confusion matrix:
     0    1
0  222    3
1   72  153
new oracle model saved
better model found
persisted
after epoch: 6,now: 2024-07-23 04:48:05.831545,epoch time: 0:02:47.096754,used: 0:16:43.759492,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_04_31_22_seed_1_22779256
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.98046875, 'precision': 0.9809766, 'recall': 0.9807074, 'specificity': 0.9807074, 'f1': 0.9804678, 'auroc': 0.9993777, 'binary_precision': 1.0, 'binary_recall': 0.9614148, 'binary_specificity': 1.0, 'binary_f1_score': 0.9803279}
confusion matrix:
      0     1
0  1517     0
1    60  1495
---- Validation: 
scalar performance:
{'acc': 0.55191255, 'precision': 0.7490991, 'recall': 0.54449564, 'specificity': 0.54449564, 'f1': 0.430746, 'auroc': 0.917531, 'binary_precision': 0.96666664, 'binary_recall': 0.092063494, 'binary_specificity': 0.9969278, 'binary_f1_score': 0.16811596}
confusion matrix:
     0   1
0  649   2
1  572  58
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5222222, 'precision': 0.7556818, 'recall': 0.5222222, 'specificity': 0.5222222, 'f1': 0.38089904, 'auroc': 0.9018272, 'binary_precision': 1.0, 'binary_recall': 0.044444446, 'binary_specificity': 1.0, 'binary_f1_score': 0.08510639}
confusion matrix:
     0   1
0  225   0
1  215  10
early stop counter: 1
val acc:0.5519125461578369, best validation acc: 0.8142076730728149, corresponding to test acc:                         0.8333333134651184 / 0.8333333134651184
after epoch: 7,now: 2024-07-23 04:50:53.069023,epoch time: 0:02:47.237478,used: 0:19:30.996970,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_04_31_22_seed_1_22779256
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.99121094, 'precision': 0.99136615, 'recall': 0.99112475, 'specificity': 0.99112475, 'f1': 0.9912075, 'auroc': 0.99981344, 'binary_precision': 0.9854061, 'binary_recall': 0.997431, 'binary_specificity': 0.98481846, 'binary_f1_score': 0.99138206}
confusion matrix:
      0     1
0  1492    23
1     4  1553
---- Validation: 
scalar performance:
{'acc': 0.85714287, 'precision': 0.86929226, 'recall': 0.85565794, 'specificity': 0.85565794, 'f1': 0.8555623, 'auroc': 0.9256041, 'binary_precision': 0.93230176, 'binary_recall': 0.7650794, 'binary_specificity': 0.94623655, 'binary_f1_score': 0.8404534}
confusion matrix:
     0    1
0  616   35
1  148  482
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8711111, 'precision': 0.8858675, 'recall': 0.8711111, 'specificity': 0.8711111, 'f1': 0.86986697, 'auroc': 0.93289876, 'binary_precision': 0.96132594, 'binary_recall': 0.7733333, 'binary_specificity': 0.9688889, 'binary_f1_score': 0.85714287}
confusion matrix:
     0    1
0  218    7
1   51  174
new oracle model saved
better model found
persisted
after epoch: 8,now: 2024-07-23 04:53:40.393956,epoch time: 0:02:47.324933,used: 0:22:18.321903,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_04_31_22_seed_1_22779256
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.984375, 'precision': 0.98475176, 'recall': 0.98422074, 'specificity': 0.98422074, 'f1': 0.98436546, 'auroc': 0.9993819, 'binary_precision': 0.97423005, 'binary_recall': 0.9955042, 'binary_specificity': 0.9729373, 'binary_f1_score': 0.9847523}
confusion matrix:
      0     1
0  1474    41
1     7  1550
---- Validation: 
scalar performance:
{'acc': 0.863388, 'precision': 0.87141633, 'recall': 0.8621864, 'specificity': 0.8621864, 'f1': 0.86233556, 'auroc': 0.9223368, 'binary_precision': 0.9220779, 'binary_recall': 0.7888889, 'binary_specificity': 0.9354839, 'binary_f1_score': 0.85029936}
confusion matrix:
     0    1
0  609   42
1  133  497
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8666667, 'precision': 0.870206, 'recall': 0.8666667, 'specificity': 0.8666667, 'f1': 0.8663472, 'auroc': 0.91134816, 'binary_precision': 0.90640396, 'binary_recall': 0.81777775, 'binary_specificity': 0.91555554, 'binary_f1_score': 0.8598131}
confusion matrix:
     0    1
0  206   19
1   41  184
better model found
persisted
after epoch: 9,now: 2024-07-23 04:56:27.207500,epoch time: 0:02:46.813544,used: 0:25:05.135447,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_04_31_22_seed_1_22779256
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9817708, 'precision': 0.9820819, 'recall': 0.9819797, 'specificity': 0.9819797, 'f1': 0.98177063, 'auroc': 0.9994578, 'binary_precision': 0.99800795, 'binary_recall': 0.9659383, 'binary_specificity': 0.9980211, 'binary_f1_score': 0.98171127}
confusion matrix:
      0     1
0  1513     3
1    53  1503
---- Validation: 
scalar performance:
{'acc': 0.8126464, 'precision': 0.8396525, 'recall': 0.81031746, 'specificity': 0.81031746, 'f1': 0.8080132, 'auroc': 0.91916645, 'binary_precision': 0.9314159, 'binary_recall': 0.66825396, 'binary_specificity': 0.95238096, 'binary_f1_score': 0.7781885}
confusion matrix:
     0    1
0  620   31
1  209  421
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.77111113, 'precision': 0.8361993, 'recall': 0.77111113, 'specificity': 0.77111113, 'f1': 0.7594694, 'auroc': 0.8997531, 'binary_precision': 0.984127, 'binary_recall': 0.5511111, 'binary_specificity': 0.9911111, 'binary_f1_score': 0.7065527}
confusion matrix:
     0    1
0  223    2
1  101  124
early stop counter: 1
val acc:0.8126463890075684, best validation acc: 0.8633880019187927, corresponding to test acc:                         0.8666666746139526 / 0.8711110949516296
after epoch: 10,now: 2024-07-23 04:59:14.582159,epoch time: 0:02:47.374659,used: 0:27:52.510106,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_04_31_22_seed_1_22779256
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.991862, 'precision': 0.9918649, 'recall': 0.991856, 'specificity': 0.991856, 'f1': 0.9918604, 'auroc': 0.9996223, 'binary_precision': 0.99165595, 'binary_recall': 0.9922929, 'binary_specificity': 0.99141914, 'binary_f1_score': 0.9919743}
confusion matrix:
      0     1
0  1502    13
1    12  1545
---- Validation: 
scalar performance:
{'acc': 0.84231067, 'precision': 0.84538454, 'recall': 0.84152585, 'specificity': 0.84152585, 'f1': 0.84170866, 'auroc': 0.9078609, 'binary_precision': 0.8741259, 'binary_recall': 0.7936508, 'binary_specificity': 0.8894009, 'binary_f1_score': 0.8319468}
confusion matrix:
     0    1
0  579   72
1  130  500
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.85555553, 'precision': 0.86, 'recall': 0.85555553, 'specificity': 0.85555553, 'f1': 0.8551083, 'auroc': 0.9264592, 'binary_precision': 0.9, 'binary_recall': 0.8, 'binary_specificity': 0.9111111, 'binary_f1_score': 0.8470588}
confusion matrix:
     0    1
0  205   20
1   45  180
early stop counter: 2
val acc:0.8423106670379639, best validation acc: 0.8633880019187927, corresponding to test acc:                         0.8666666746139526 / 0.8711110949516296
after epoch: 11,now: 2024-07-23 05:02:01.015274,epoch time: 0:02:46.433115,used: 0:30:38.943221,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_04_31_22_seed_1_22779256
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.97233075, 'precision': 0.97379494, 'recall': 0.9720164, 'specificity': 0.9720164, 'f1': 0.9722919, 'auroc': 0.9991857, 'binary_precision': 0.9503676, 'binary_recall': 0.99742764, 'binary_specificity': 0.94660515, 'binary_f1_score': 0.9733291}
confusion matrix:
      0     1
0  1436    81
1     4  1551
---- Validation: 
scalar performance:
{'acc': 0.8774395, 'precision': 0.88024044, 'recall': 0.8781618, 'specificity': 0.8781618, 'f1': 0.87733155, 'auroc': 0.94267976, 'binary_precision': 0.8432511, 'binary_recall': 0.9222222, 'binary_specificity': 0.8341014, 'binary_f1_score': 0.8809704}
confusion matrix:
     0    1
0  543  108
1   49  581
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.86, 'precision': 0.8601779, 'recall': 0.86, 'specificity': 0.86, 'f1': 0.8599827, 'auroc': 0.9236148, 'binary_precision': 0.8521739, 'binary_recall': 0.8711111, 'binary_specificity': 0.8488889, 'binary_f1_score': 0.8615385}
confusion matrix:
     0    1
0  191   34
1   29  196
better model found
persisted
after epoch: 12,now: 2024-07-23 05:04:48.074579,epoch time: 0:02:47.059305,used: 0:33:26.002526,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_04_31_22_seed_1_22779256
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9938151, 'precision': 0.9937939, 'recall': 0.9938607, 'specificity': 0.9938607, 'f1': 0.9938145, 'auroc': 0.9997846, 'binary_precision': 0.997411, 'binary_recall': 0.9903599, 'binary_specificity': 0.9973615, 'binary_f1_score': 0.99387294}
confusion matrix:
      0     1
0  1512     4
1    15  1541
---- Validation: 
scalar performance:
{'acc': 0.8266979, 'precision': 0.8543552, 'recall': 0.8243984, 'specificity': 0.8243984, 'f1': 0.8225, 'auroc': 0.9258504, 'binary_precision': 0.9493392, 'binary_recall': 0.684127, 'binary_specificity': 0.96466976, 'binary_f1_score': 0.7952029}
confusion matrix:
     0    1
0  628   23
1  199  431
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.84, 'precision': 0.8679378, 'recall': 0.84000003, 'specificity': 0.84000003, 'f1': 0.836904, 'auroc': 0.90791106, 'binary_precision': 0.9693251, 'binary_recall': 0.7022222, 'binary_specificity': 0.9777778, 'binary_f1_score': 0.814433}
confusion matrix:
     0    1
0  220    5
1   67  158
early stop counter: 1
val acc:0.8266978859901428, best validation acc: 0.8774394989013672, corresponding to test acc:                         0.8600000143051147 / 0.8711110949516296
after epoch: 13,now: 2024-07-23 05:07:34.254901,epoch time: 0:02:46.180322,used: 0:36:12.182848,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_04_31_22_seed_1_22779256
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.99316406, 'precision': 0.9931761, 'recall': 0.9932277, 'specificity': 0.9932277, 'f1': 0.99316394, 'auroc': 0.99984014, 'binary_precision': 0.9993477, 'binary_recall': 0.9871134, 'binary_specificity': 0.9993421, 'binary_f1_score': 0.99319285}
confusion matrix:
      0     1
0  1519     1
1    20  1532
---- Validation: 
scalar performance:
{'acc': 0.8235753, 'precision': 0.8471063, 'recall': 0.82142854, 'specificity': 0.82142854, 'f1': 0.8198173, 'auroc': 0.92949736, 'binary_precision': 0.9334764, 'binary_recall': 0.6904762, 'binary_specificity': 0.95238096, 'binary_f1_score': 0.7937956}
confusion matrix:
     0    1
0  620   31
1  195  435
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8422222, 'precision': 0.8674911, 'recall': 0.8422222, 'specificity': 0.8422222, 'f1': 0.83946264, 'auroc': 0.9225679, 'binary_precision': 0.96385545, 'binary_recall': 0.7111111, 'binary_specificity': 0.97333336, 'binary_f1_score': 0.8184144}
confusion matrix:
     0    1
0  219    6
1   65  160
early stop counter: 2
val acc:0.8235753178596497, best validation acc: 0.8774394989013672, corresponding to test acc:                         0.8600000143051147 / 0.8711110949516296
after epoch: 14,now: 2024-07-23 05:10:21.488211,epoch time: 0:02:47.233310,used: 0:38:59.416158,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_04_31_22_seed_1_22779256
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9938151, 'precision': 0.9937963, 'recall': 0.99385846, 'specificity': 0.99385846, 'f1': 0.9938146, 'auroc': 0.9995515, 'binary_precision': 0.99740934, 'binary_recall': 0.9903537, 'binary_specificity': 0.9973632, 'binary_f1_score': 0.993869}
confusion matrix:
      0     1
0  1513     4
1    15  1540
---- Validation: 
scalar performance:
{'acc': 0.83372366, 'precision': 0.8590251, 'recall': 0.83154124, 'specificity': 0.83154124, 'f1': 0.83006346, 'auroc': 0.93694925, 'binary_precision': 0.950324, 'binary_recall': 0.6984127, 'binary_specificity': 0.96466976, 'binary_f1_score': 0.8051235}
confusion matrix:
     0    1
0  628   23
1  190  440
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.83555555, 'precision': 0.86928546, 'recall': 0.83555555, 'specificity': 0.83555555, 'f1': 0.8317127, 'auroc': 0.9266765, 'binary_precision': 0.9808917, 'binary_recall': 0.6844444, 'binary_specificity': 0.9866667, 'binary_f1_score': 0.8062827}
confusion matrix:
     0    1
0  222    3
1   71  154
early stop counter: 3
val acc:0.8337236642837524, best validation acc: 0.8774394989013672, corresponding to test acc:                         0.8600000143051147 / 0.8711110949516296
after epoch: 15,now: 2024-07-23 05:13:08.761263,epoch time: 0:02:47.273052,used: 0:41:46.689210,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_04_31_22_seed_1_22779256
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9840495, 'precision': 0.98430395, 'recall': 0.9842557, 'specificity': 0.9842557, 'f1': 0.98404944, 'auroc': 0.9997083, 'binary_precision': 0.99933773, 'binary_recall': 0.96917146, 'binary_specificity': 0.99933994, 'binary_f1_score': 0.9840235}
confusion matrix:
      0     1
0  1514     1
1    48  1509
---- Validation: 
scalar performance:
{'acc': 0.6666667, 'precision': 0.7730303, 'recall': 0.6614696, 'specificity': 0.6614696, 'f1': 0.62651813, 'auroc': 0.91128725, 'binary_precision': 0.93939394, 'binary_recall': 0.34444445, 'binary_specificity': 0.97849464, 'binary_f1_score': 0.50406504}
confusion matrix:
     0    1
0  637   14
1  413  217
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7, 'precision': 0.7852434, 'recall': 0.70000005, 'specificity': 0.70000005, 'f1': 0.67577696, 'auroc': 0.90281975, 'binary_precision': 0.9411765, 'binary_recall': 0.42666668, 'binary_specificity': 0.97333336, 'binary_f1_score': 0.587156}
confusion matrix:
     0   1
0  219   6
1  129  96
early stop counter: 4
val acc:0.6666666865348816, best validation acc: 0.8774394989013672, corresponding to test acc:                         0.8600000143051147 / 0.8711110949516296
after epoch: 16,now: 2024-07-23 05:15:55.628553,epoch time: 0:02:46.867290,used: 0:44:33.556500,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_04_31_22_seed_1_22779256
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9869792, 'precision': 0.9871654, 'recall': 0.9868837, 'specificity': 0.9868837, 'f1': 0.9869739, 'auroc': 0.999267, 'binary_precision': 0.9803549, 'binary_recall': 0.99421597, 'binary_specificity': 0.97955143, 'binary_f1_score': 0.98723674}
confusion matrix:
      0     1
0  1485    31
1     9  1547
---- Validation: 
scalar performance:
{'acc': 0.8196721, 'precision': 0.8271993, 'recall': 0.81840754, 'specificity': 0.81840754, 'f1': 0.8181812, 'auroc': 0.9023724, 'binary_precision': 0.8728972, 'binary_recall': 0.7412698, 'binary_specificity': 0.8955453, 'binary_f1_score': 0.80171674}
confusion matrix:
     0    1
0  583   68
1  163  467
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.79555553, 'precision': 0.8016572, 'recall': 0.7955556, 'specificity': 0.7955556, 'f1': 0.79451644, 'auroc': 0.8537679, 'binary_precision': 0.8445596, 'binary_recall': 0.72444445, 'binary_specificity': 0.8666667, 'binary_f1_score': 0.7799043}
confusion matrix:
     0    1
0  195   30
1   62  163
early stop counter: 5
val acc:0.8196721076965332, best validation acc: 0.8774394989013672, corresponding to test acc:                         0.8600000143051147 / 0.8711110949516296
after epoch: 17,now: 2024-07-23 05:18:42.810300,epoch time: 0:02:47.181747,used: 0:47:20.738247,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_04_31_22_seed_1_22779256
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 17 with time: 0:47:20.738247 at 2024-07-23 05:18:42.810300
persisted model performance metric: 

scalar performance:
{'acc': 0.86, 'precision': 0.8601779, 'recall': 0.86, 'specificity': 0.86, 'f1': 0.8599827, 'auroc': 0.9236148, 'binary_precision': 0.8521739, 'binary_recall': 0.8711111, 'binary_specificity': 0.8488889, 'binary_f1_score': 0.8615385}
confusion matrix:
     0    1
0  191   34
1   29  196
oracle model performance metric: 

scalar performance:
{'acc': 0.8711111, 'precision': 0.8858675, 'recall': 0.8711111, 'specificity': 0.8711111, 'f1': 0.86986697, 'auroc': 0.93289876, 'binary_precision': 0.96132594, 'binary_recall': 0.7733333, 'binary_specificity': 0.9688889, 'binary_f1_score': 0.85714287}
confusion matrix:
     0    1
0  218    7
1   51  174
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_dial_lr1e5_bs32_nofreeze_2024-07-23_01-16-41/rule_results/6.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_dial_lr1e5_bs32_nofreeze_2024-07-23_01-16-41/confusion_matrix/6.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 453114 KiB |  13225 MiB | 144832 GiB | 144832 GiB |
|       from large pool | 412558 KiB |  13186 MiB | 143973 GiB | 143972 GiB |
|       from small pool |  40556 KiB |     60 MiB |    859 GiB |    859 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 453114 KiB |  13225 MiB | 144832 GiB | 144832 GiB |
|       from large pool | 412558 KiB |  13186 MiB | 143973 GiB | 143972 GiB |
|       from small pool |  40556 KiB |     60 MiB |    859 GiB |    859 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 447481 KiB |  13222 MiB | 144808 GiB | 144807 GiB |
|       from large pool | 407075 KiB |  13184 MiB | 143949 GiB | 143949 GiB |
|       from small pool |  40406 KiB |     60 MiB |    858 GiB |    858 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  14126 MiB |  14126 MiB |  27220 MiB |  13094 MiB |
|       from large pool |  14058 MiB |  14058 MiB |  27136 MiB |  13078 MiB |
|       from small pool |     68 MiB |     68 MiB |     84 MiB |     16 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 505349 KiB |    933 MiB |  65897 GiB |  65897 GiB |
|       from large pool | 496754 KiB |    925 MiB |  65028 GiB |  65028 GiB |
|       from small pool |   8595 KiB |     36 MiB |    869 GiB |    869 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    1226    |    1674    |   11240 K  |   11239 K  |
|       from large pool |     187    |     783    |    6839 K  |    6839 K  |
|       from small pool |    1039    |    1335    |    4400 K  |    4399 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    1226    |    1674    |   11240 K  |   11239 K  |
|       from large pool |     187    |     783    |    6839 K  |    6839 K  |
|       from small pool |    1039    |    1335    |    4400 K  |    4399 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     448    |     448    |     827    |     379    |
|       from large pool |     414    |     414    |     785    |     371    |
|       from small pool |      34    |      34    |      42    |       8    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      78    |     459    |    7495 K  |    7495 K  |
|       from large pool |      36    |     415    |    5339 K  |    5339 K  |
|       from small pool |      42    |     125    |    2156 K  |    2156 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13225 MiB | 144832 GiB | 144832 GiB |
|       from large pool |  16640 KiB |  13186 MiB | 143973 GiB | 143973 GiB |
|       from small pool |      0 KiB |     60 MiB |    859 GiB |    859 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13225 MiB | 144832 GiB | 144832 GiB |
|       from large pool |  16640 KiB |  13186 MiB | 143973 GiB | 143973 GiB |
|       from small pool |      0 KiB |     60 MiB |    859 GiB |    859 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13222 MiB | 144808 GiB | 144808 GiB |
|       from large pool |  16640 KiB |  13184 MiB | 143949 GiB | 143949 GiB |
|       from small pool |      0 KiB |     60 MiB |    858 GiB |    858 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    936 MiB |  14126 MiB |  27220 MiB |  26284 MiB |
|       from large pool |    888 MiB |  14058 MiB |  27136 MiB |  26248 MiB |
|       from small pool |     48 MiB |     68 MiB |     84 MiB |     36 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |   3840 KiB |    933 MiB |  65898 GiB |  65898 GiB |
|       from large pool |   3840 KiB |    925 MiB |  65029 GiB |  65028 GiB |
|       from small pool |      0 KiB |     36 MiB |    869 GiB |    869 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    1674    |   11240 K  |   11240 K  |
|       from large pool |       2    |     783    |    6839 K  |    6839 K  |
|       from small pool |       0    |    1335    |    4400 K  |    4400 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    1674    |   11240 K  |   11240 K  |
|       from large pool |       2    |     783    |    6839 K  |    6839 K  |
|       from small pool |       0    |    1335    |    4400 K  |    4400 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      63    |     448    |     827    |     764    |
|       from large pool |      39    |     414    |     785    |     746    |
|       from small pool |      24    |      34    |      42    |      18    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       1    |     459    |    7495 K  |    7495 K  |
|       from large pool |       1    |     415    |    5339 K  |    5339 K  |
|       from small pool |       0    |     125    |    2156 K  |    2156 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13225 MiB | 144832 GiB | 144832 GiB |
|       from large pool |  16640 KiB |  13186 MiB | 143973 GiB | 143973 GiB |
|       from small pool |      0 KiB |     60 MiB |    859 GiB |    859 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13225 MiB | 144832 GiB | 144832 GiB |
|       from large pool |  16640 KiB |  13186 MiB | 143973 GiB | 143973 GiB |
|       from small pool |      0 KiB |     60 MiB |    859 GiB |    859 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13222 MiB | 144808 GiB | 144808 GiB |
|       from large pool |  16640 KiB |  13184 MiB | 143949 GiB | 143949 GiB |
|       from small pool |      0 KiB |     60 MiB |    858 GiB |    858 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    936 MiB |  14126 MiB |  27220 MiB |  26284 MiB |
|       from large pool |    888 MiB |  14058 MiB |  27136 MiB |  26248 MiB |
|       from small pool |     48 MiB |     68 MiB |     84 MiB |     36 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |   3840 KiB |    933 MiB |  65898 GiB |  65898 GiB |
|       from large pool |   3840 KiB |    925 MiB |  65029 GiB |  65028 GiB |
|       from small pool |      0 KiB |     36 MiB |    869 GiB |    869 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    1674    |   11240 K  |   11240 K  |
|       from large pool |       2    |     783    |    6839 K  |    6839 K  |
|       from small pool |       0    |    1335    |    4400 K  |    4400 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    1674    |   11240 K  |   11240 K  |
|       from large pool |       2    |     783    |    6839 K  |    6839 K  |
|       from small pool |       0    |    1335    |    4400 K  |    4400 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      63    |     448    |     827    |     764    |
|       from large pool |      39    |     414    |     785    |     746    |
|       from small pool |      24    |      34    |      42    |      18    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       1    |     459    |    7495 K  |    7495 K  |
|       from large pool |       1    |     415    |    5339 K  |    5339 K  |
|       from small pool |       0    |     125    |    2156 K  |    2156 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'888c1ef2'
model name: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_05_19_49_seed_2_22779256

 Experiment start at: 2024-07-23 05:19:49.316987
before training, model accuracy: 0.41203704476356506
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9361842, 'precision': 0.94120824, 'recall': 0.9366522, 'specificity': 0.9366522, 'f1': 0.93604463, 'auroc': 0.9868213, 'binary_precision': 0.9904762, 'binary_recall': 0.8819308, 'binary_specificity': 0.9913736, 'binary_f1_score': 0.93305725}
confusion matrix:
      0     1
0  1494    13
1   181  1352
---- Validation: 
scalar performance:
{'acc': 0.80672926, 'precision': 0.8285153, 'recall': 0.8032385, 'specificity': 0.8032385, 'f1': 0.8021225, 'auroc': 0.8868716, 'binary_precision': 0.9067245, 'binary_recall': 0.67202574, 'binary_specificity': 0.9344512, 'binary_f1_score': 0.77192986}
confusion matrix:
     0    1
0  613   43
1  204  418
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8032407, 'precision': 0.852862, 'recall': 0.8032407, 'specificity': 0.8032407, 'f1': 0.7960714, 'auroc': 0.87437844, 'binary_precision': 0.9851852, 'binary_recall': 0.6157407, 'binary_specificity': 0.9907407, 'binary_f1_score': 0.75783473}
confusion matrix:
     0    1
0  214    2
1   83  133
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-23 05:22:37.140716,epoch time: 0:02:47.823729,used: 0:02:47.823729,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_05_19_49_seed_2_22779256
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9638158, 'precision': 0.96602845, 'recall': 0.9640758, 'specificity': 0.9640758, 'f1': 0.9637854, 'auroc': 0.99773145, 'binary_precision': 1.0, 'binary_recall': 0.92815155, 'binary_specificity': 1.0, 'binary_f1_score': 0.9627371}
confusion matrix:
      0     1
0  1509     0
1   110  1421
---- Validation: 
scalar performance:
{'acc': 0.68466353, 'precision': 0.78817165, 'recall': 0.6765033, 'specificity': 0.6765033, 'f1': 0.64749277, 'auroc': 0.8880799, 'binary_precision': 0.95435685, 'binary_recall': 0.3697749, 'binary_specificity': 0.9832317, 'binary_f1_score': 0.5330244}
confusion matrix:
     0    1
0  645   11
1  392  230
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6041667, 'precision': 0.76858246, 'recall': 0.6041667, 'specificity': 0.6041667, 'f1': 0.53264207, 'auroc': 0.89900553, 'binary_precision': 0.9787234, 'binary_recall': 0.21296297, 'binary_specificity': 0.9953704, 'binary_f1_score': 0.34980989}
confusion matrix:
     0   1
0  215   1
1  170  46
early stop counter: 1
val acc:0.6846635341644287, best validation acc: 0.806729257106781, corresponding to test acc:                         0.8032407164573669 / 0.8032407164573669
after epoch: 2,now: 2024-07-23 05:25:22.240400,epoch time: 0:02:45.099684,used: 0:05:32.923413,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_05_19_49_seed_2_22779256
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.97664475, 'precision': 0.97728026, 'recall': 0.97678876, 'specificity': 0.97678876, 'f1': 0.97664094, 'auroc': 0.9986595, 'binary_precision': 0.99659866, 'binary_recall': 0.95689094, 'binary_specificity': 0.9966865, 'binary_f1_score': 0.97634125}
confusion matrix:
      0     1
0  1504     5
1    66  1465
---- Validation: 
scalar performance:
{'acc': 0.713615, 'precision': 0.77247447, 'recall': 0.707246, 'specificity': 0.707246, 'f1': 0.693156, 'auroc': 0.8522836, 'binary_precision': 0.892638, 'binary_recall': 0.46784565, 'binary_specificity': 0.94664633, 'binary_f1_score': 0.613924}
confusion matrix:
     0    1
0  621   35
1  331  291
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7893519, 'precision': 0.809413, 'recall': 0.7893518, 'specificity': 0.7893518, 'f1': 0.78588116, 'auroc': 0.88479507, 'binary_precision': 0.88819873, 'binary_recall': 0.662037, 'binary_specificity': 0.9166667, 'binary_f1_score': 0.7586207}
confusion matrix:
     0    1
0  198   18
1   73  143
early stop counter: 2
val acc:0.7136150002479553, best validation acc: 0.806729257106781, corresponding to test acc:                         0.8032407164573669 / 0.8032407164573669
after epoch: 3,now: 2024-07-23 05:28:07.717728,epoch time: 0:02:45.477328,used: 0:08:18.400741,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_05_19_49_seed_2_22779256
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.98355263, 'precision': 0.98358256, 'recall': 0.9836077, 'specificity': 0.9836077, 'f1': 0.9835526, 'auroc': 0.9985621, 'binary_precision': 0.9900859, 'binary_recall': 0.977169, 'binary_specificity': 0.99004644, 'binary_f1_score': 0.98358506}
confusion matrix:
      0     1
0  1492    15
1    35  1498
---- Validation: 
scalar performance:
{'acc': 0.7793427, 'precision': 0.80537343, 'recall': 0.77535343, 'specificity': 0.77535343, 'f1': 0.77272975, 'auroc': 0.8791369, 'binary_precision': 0.88812786, 'binary_recall': 0.6254019, 'binary_specificity': 0.9253049, 'binary_f1_score': 0.73396224}
confusion matrix:
     0    1
0  607   49
1  233  389
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8171296, 'precision': 0.84269834, 'recall': 0.8171296, 'specificity': 0.8171296, 'f1': 0.8136538, 'auroc': 0.900463, 'binary_precision': 0.93630576, 'binary_recall': 0.6805556, 'binary_specificity': 0.9537037, 'binary_f1_score': 0.7882038}
confusion matrix:
     0    1
0  206   10
1   69  147
new oracle model saved
early stop counter: 3
val acc:0.7793427109718323, best validation acc: 0.806729257106781, corresponding to test acc:                         0.8032407164573669 / 0.8171296119689941
after epoch: 4,now: 2024-07-23 05:30:52.638704,epoch time: 0:02:44.920976,used: 0:11:03.321717,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_05_19_49_seed_2_22779256
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.98223686, 'precision': 0.9824319, 'recall': 0.9823818, 'specificity': 0.9823818, 'f1': 0.98223674, 'auroc': 0.9984373, 'binary_precision': 0.99532396, 'binary_recall': 0.96942097, 'binary_specificity': 0.9953427, 'binary_f1_score': 0.9822017}
confusion matrix:
      0     1
0  1496     7
1    47  1490
---- Validation: 
scalar performance:
{'acc': 0.7543036, 'precision': 0.7906264, 'recall': 0.7494633, 'specificity': 0.7494633, 'f1': 0.7438649, 'auroc': 0.8467743, 'binary_precision': 0.8869347, 'binary_recall': 0.56752414, 'binary_specificity': 0.93140244, 'binary_f1_score': 0.6921569}
confusion matrix:
     0    1
0  611   45
1  269  353
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7731481, 'precision': 0.77373487, 'recall': 0.7731482, 'specificity': 0.7731482, 'f1': 0.7730266, 'auroc': 0.8681842, 'binary_precision': 0.76106197, 'binary_recall': 0.7962963, 'binary_specificity': 0.75, 'binary_f1_score': 0.77828056}
confusion matrix:
     0    1
0  162   54
1   44  172
early stop counter: 4
val acc:0.7543035745620728, best validation acc: 0.806729257106781, corresponding to test acc:                         0.8032407164573669 / 0.8171296119689941
after epoch: 5,now: 2024-07-23 05:33:37.560862,epoch time: 0:02:44.922158,used: 0:13:48.243875,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_05_19_49_seed_2_22779256
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9875, 'precision': 0.9876513, 'recall': 0.98744696, 'specificity': 0.98744696, 'f1': 0.9874973, 'auroc': 0.99946713, 'binary_precision': 0.98068255, 'binary_recall': 0.99477464, 'binary_specificity': 0.9801193, 'binary_f1_score': 0.98767835}
confusion matrix:
      0     1
0  1479    30
1     8  1523
---- Validation: 
scalar performance:
{'acc': 0.8028169, 'precision': 0.82455885, 'recall': 0.7993025, 'specificity': 0.7993025, 'f1': 0.79806733, 'auroc': 0.9036154, 'binary_precision': 0.90217394, 'binary_recall': 0.6672026, 'binary_specificity': 0.93140244, 'binary_f1_score': 0.767098}
confusion matrix:
     0    1
0  611   45
1  207  415
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7986111, 'precision': 0.8209621, 'recall': 0.79861116, 'specificity': 0.79861116, 'f1': 0.79504293, 'auroc': 0.8961334, 'binary_precision': 0.9056604, 'binary_recall': 0.6666667, 'binary_specificity': 0.9305556, 'binary_f1_score': 0.76799995}
confusion matrix:
     0    1
0  201   15
1   72  144
early stop counter: 5
val acc:0.8028169274330139, best validation acc: 0.806729257106781, corresponding to test acc:                         0.8032407164573669 / 0.8171296119689941
after epoch: 6,now: 2024-07-23 05:36:22.362414,epoch time: 0:02:44.801552,used: 0:16:33.045427,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_05_19_49_seed_2_22779256
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 6 with time: 0:16:33.045427 at 2024-07-23 05:36:22.362414
persisted model performance metric: 

scalar performance:
{'acc': 0.8032407, 'precision': 0.852862, 'recall': 0.8032407, 'specificity': 0.8032407, 'f1': 0.7960714, 'auroc': 0.87437844, 'binary_precision': 0.9851852, 'binary_recall': 0.6157407, 'binary_specificity': 0.9907407, 'binary_f1_score': 0.75783473}
confusion matrix:
     0    1
0  214    2
1   83  133
oracle model performance metric: 

scalar performance:
{'acc': 0.8171296, 'precision': 0.84269834, 'recall': 0.8171296, 'specificity': 0.8171296, 'f1': 0.8136538, 'auroc': 0.900463, 'binary_precision': 0.93630576, 'binary_recall': 0.6805556, 'binary_specificity': 0.9537037, 'binary_f1_score': 0.7882038}
confusion matrix:
     0    1
0  206   10
1   69  147
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_dial_lr1e5_bs32_nofreeze_2024-07-23_01-16-41/rule_results/6.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_dial_lr1e5_bs32_nofreeze_2024-07-23_01-16-41/confusion_matrix/6.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 453070 KiB |  13225 MiB | 181116 GiB | 181116 GiB |
|       from large pool | 412517 KiB |  13186 MiB | 180041 GiB | 180040 GiB |
|       from small pool |  40553 KiB |     60 MiB |   1075 GiB |   1075 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 453070 KiB |  13225 MiB | 181116 GiB | 181116 GiB |
|       from large pool | 412517 KiB |  13186 MiB | 180041 GiB | 180040 GiB |
|       from small pool |  40553 KiB |     60 MiB |   1075 GiB |   1075 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 447481 KiB |  13222 MiB | 181084 GiB | 181084 GiB |
|       from large pool | 407075 KiB |  13184 MiB | 180010 GiB | 180009 GiB |
|       from small pool |  40406 KiB |     60 MiB |   1074 GiB |   1074 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  14118 MiB |  14126 MiB |  40402 MiB |  26284 MiB |
|       from large pool |  14054 MiB |  14058 MiB |  40302 MiB |  26248 MiB |
|       from small pool |     64 MiB |     68 MiB |    100 MiB |     36 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 499249 KiB |    933 MiB |  82723 GiB |  82722 GiB |
|       from large pool | 490651 KiB |    925 MiB |  81635 GiB |  81634 GiB |
|       from small pool |   8598 KiB |     36 MiB |   1087 GiB |   1087 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    1220    |    1674    |   14054 K  |   14052 K  |
|       from large pool |     187    |     783    |    8553 K  |    8553 K  |
|       from small pool |    1033    |    1335    |    5500 K  |    5499 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    1220    |    1674    |   14054 K  |   14052 K  |
|       from large pool |     187    |     783    |    8553 K  |    8553 K  |
|       from small pool |    1033    |    1335    |    5500 K  |    5499 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     450    |     450    |    1214    |     764    |
|       from large pool |     418    |     418    |    1164    |     746    |
|       from small pool |      32    |      34    |      50    |      18    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      78    |     462    |    9378 K  |    9378 K  |
|       from large pool |      38    |     420    |    6701 K  |    6701 K  |
|       from small pool |      40    |     125    |    2676 K  |    2676 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13225 MiB | 181116 GiB | 181116 GiB |
|       from large pool |  16640 KiB |  13186 MiB | 180041 GiB | 180041 GiB |
|       from small pool |      0 KiB |     60 MiB |   1075 GiB |   1075 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13225 MiB | 181116 GiB | 181116 GiB |
|       from large pool |  16640 KiB |  13186 MiB | 180041 GiB | 180041 GiB |
|       from small pool |      0 KiB |     60 MiB |   1075 GiB |   1075 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13222 MiB | 181084 GiB | 181084 GiB |
|       from large pool |  16640 KiB |  13184 MiB | 180010 GiB | 180010 GiB |
|       from small pool |      0 KiB |     60 MiB |   1074 GiB |   1074 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    930 MiB |  14126 MiB |  40402 MiB |  39472 MiB |
|       from large pool |    882 MiB |  14058 MiB |  40302 MiB |  39420 MiB |
|       from small pool |     48 MiB |     68 MiB |    100 MiB |     52 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |   3840 KiB |    933 MiB |  82723 GiB |  82723 GiB |
|       from large pool |   3840 KiB |    925 MiB |  81635 GiB |  81635 GiB |
|       from small pool |      0 KiB |     36 MiB |   1087 GiB |   1087 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    1674    |   14054 K  |   14054 K  |
|       from large pool |       2    |     783    |    8553 K  |    8553 K  |
|       from small pool |       0    |    1335    |    5500 K  |    5500 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    1674    |   14054 K  |   14054 K  |
|       from large pool |       2    |     783    |    8553 K  |    8553 K  |
|       from small pool |       0    |    1335    |    5500 K  |    5500 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      63    |     450    |    1214    |    1151    |
|       from large pool |      39    |     418    |    1164    |    1125    |
|       from small pool |      24    |      34    |      50    |      26    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       1    |     462    |    9378 K  |    9378 K  |
|       from large pool |       1    |     420    |    6701 K  |    6701 K  |
|       from small pool |       0    |     125    |    2676 K  |    2676 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Tue Jul 23 05:37:05 2024]
Finished job 0.
1 of 1 steps (100%) done
