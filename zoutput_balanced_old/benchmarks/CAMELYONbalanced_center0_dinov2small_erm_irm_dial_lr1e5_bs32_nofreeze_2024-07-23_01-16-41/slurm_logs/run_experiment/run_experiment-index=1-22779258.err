Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Tue Jul 23 04:48:10 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_dial_lr1e5_bs32_nofreeze_2024-07-23_01-16-41/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_dial_lr1e5_bs32_nofreeze_2024-07-23_01-16-41/rule_results/1.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=1
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/swiglu_ffn.py:51: UserWarning: xFormers is not available (SwiGLU)
  warnings.warn("xFormers is not available (SwiGLU)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/attention.py:33: UserWarning: xFormers is not available (Attention)
  warnings.warn("xFormers is not available (Attention)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/block.py:40: UserWarning: xFormers is not available (Block)
  warnings.warn("xFormers is not available (Block)")
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'888c1ef2'
model name: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_04_48_52_seed_0_22779258

 Experiment start at: 2024-07-23 04:48:52.794707
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
before training, model accuracy: 0.569767415523529
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.91471356, 'precision': 0.91526806, 'recall': 0.9145111, 'specificity': 0.9145111, 'f1': 0.9146466, 'auroc': 0.9772214, 'binary_precision': 0.90274316, 'binary_recall': 0.9317889, 'binary_specificity': 0.8972332, 'binary_f1_score': 0.9170361}
confusion matrix:
      0     1
0  1362   156
1   106  1448
---- Validation: 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
scalar performance:
{'acc': 0.8090062, 'precision': 0.80948174, 'recall': 0.80927277, 'specificity': 0.80927277, 'f1': 0.8089947, 'auroc': 0.8882059, 'binary_precision': 0.7933635, 'binary_recall': 0.82834643, 'binary_specificity': 0.7901991, 'binary_f1_score': 0.8104777}
confusion matrix:
     0    1
0  516  137
1  109  526
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.82093024, 'precision': 0.8214936, 'recall': 0.82093024, 'specificity': 0.82093024, 'f1': 0.8208518, 'auroc': 0.893391, 'binary_precision': 0.80803573, 'binary_recall': 0.8418605, 'binary_specificity': 0.8, 'binary_f1_score': 0.8246014}
confusion matrix:
     0    1
0  172   43
1   34  181
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-23 04:50:12.813799,epoch time: 0:01:20.019092,used: 0:01:20.019092,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_04_48_52_seed_0_22779258
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.95996094, 'precision': 0.9599359, 'recall': 0.9600024, 'specificity': 0.9600024, 'f1': 0.9599569, 'auroc': 0.992972, 'binary_precision': 0.9637775, 'binary_recall': 0.95696855, 'binary_specificity': 0.9630363, 'binary_f1_score': 0.96036094}
confusion matrix:
      0     1
0  1459    56
1    67  1490
---- Validation: 
scalar performance:
{'acc': 0.86180127, 'precision': 0.8617766, 'recall': 0.86183935, 'specificity': 0.86183935, 'f1': 0.8617892, 'auroc': 0.91635215, 'binary_precision': 0.8564743, 'binary_recall': 0.8645669, 'binary_specificity': 0.8591118, 'binary_f1_score': 0.8605016}
confusion matrix:
     0    1
0  561   92
1   86  549
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8581395, 'precision': 0.85820925, 'recall': 0.8581395, 'specificity': 0.8581395, 'f1': 0.85813266, 'auroc': 0.92620873, 'binary_precision': 0.853211, 'binary_recall': 0.8651163, 'binary_specificity': 0.8511628, 'binary_f1_score': 0.85912246}
confusion matrix:
     0    1
0  183   32
1   29  186
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-07-23 04:51:27.809359,epoch time: 0:01:14.995560,used: 0:02:35.014652,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_04_48_52_seed_0_22779258
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9641927, 'precision': 0.9655692, 'recall': 0.96460444, 'specificity': 0.96460444, 'f1': 0.9641825, 'auroc': 0.99574876, 'binary_precision': 0.9945318, 'binary_recall': 0.9344894, 'binary_specificity': 0.99471945, 'binary_f1_score': 0.9635762}
confusion matrix:
      0     1
0  1507     8
1   102  1455
---- Validation: 
scalar performance:
{'acc': 0.73913044, 'precision': 0.76590765, 'recall': 0.73686564, 'specificity': 0.73686564, 'f1': 0.73114324, 'auroc': 0.8342453, 'binary_precision': 0.84686774, 'binary_recall': 0.5748032, 'binary_specificity': 0.89892805, 'binary_f1_score': 0.684803}
confusion matrix:
     0    1
0  587   66
1  270  365
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.82093024, 'precision': 0.8225, 'recall': 0.82093024, 'specificity': 0.82093024, 'f1': 0.8207121, 'auroc': 0.9119091, 'binary_precision': 0.845, 'binary_recall': 0.7860465, 'binary_specificity': 0.855814, 'binary_f1_score': 0.81445783}
confusion matrix:
     0    1
0  184   31
1   46  169
early stop counter: 1
val acc:0.739130437374115, best validation acc: 0.861801266670227, corresponding to test acc:                         0.8581395149230957 / 0.8581395149230957
after epoch: 3,now: 2024-07-23 04:52:42.422732,epoch time: 0:01:14.613373,used: 0:03:49.628025,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_04_48_52_seed_0_22779258
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9703776, 'precision': 0.9705866, 'recall': 0.9702724, 'specificity': 0.9702724, 'f1': 0.97036517, 'auroc': 0.9963895, 'binary_precision': 0.96329117, 'binary_recall': 0.9787781, 'binary_specificity': 0.96176666, 'binary_f1_score': 0.9709729}
confusion matrix:
      0     1
0  1459    58
1    33  1522
---- Validation: 
scalar performance:
{'acc': 0.8043478, 'precision': 0.8096094, 'recall': 0.8052429, 'specificity': 0.8052429, 'f1': 0.803801, 'auroc': 0.8889462, 'binary_precision': 0.7656033, 'binary_recall': 0.86929137, 'binary_specificity': 0.7411945, 'binary_f1_score': 0.81415933}
confusion matrix:
     0    1
0  484  169
1   83  552
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8, 'precision': 0.80595696, 'recall': 0.79999995, 'specificity': 0.79999995, 'f1': 0.7990217, 'auroc': 0.90922666, 'binary_precision': 0.7632653, 'binary_recall': 0.8697674, 'binary_specificity': 0.73023254, 'binary_f1_score': 0.8130434}
confusion matrix:
     0    1
0  157   58
1   28  187
early stop counter: 2
val acc:0.804347813129425, best validation acc: 0.861801266670227, corresponding to test acc:                         0.8581395149230957 / 0.8581395149230957
after epoch: 4,now: 2024-07-23 04:53:57.421765,epoch time: 0:01:14.999033,used: 0:05:04.627058,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_04_48_52_seed_0_22779258
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9720052, 'precision': 0.97278154, 'recall': 0.9722909, 'specificity': 0.9722909, 'f1': 0.9720018, 'auroc': 0.9972241, 'binary_precision': 0.99527985, 'binary_recall': 0.94919616, 'binary_specificity': 0.99538565, 'binary_f1_score': 0.9716919}
confusion matrix:
      0     1
0  1510     7
1    79  1476
---- Validation: 
scalar performance:
{'acc': 0.7189441, 'precision': 0.728361, 'recall': 0.7174567, 'specificity': 0.7174567, 'f1': 0.7150798, 'auroc': 0.82697904, 'binary_precision': 0.7713718, 'binary_recall': 0.6110236, 'binary_specificity': 0.82388973, 'binary_f1_score': 0.68189806}
confusion matrix:
     0    1
0  538  115
1  247  388
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7744186, 'precision': 0.7745671, 'recall': 0.7744186, 'specificity': 0.7744186, 'f1': 0.7743881, 'auroc': 0.8615252, 'binary_precision': 0.7809524, 'binary_recall': 0.7627907, 'binary_specificity': 0.7860465, 'binary_f1_score': 0.77176464}
confusion matrix:
     0    1
0  169   46
1   51  164
early stop counter: 3
val acc:0.7189440727233887, best validation acc: 0.861801266670227, corresponding to test acc:                         0.8581395149230957 / 0.8581395149230957
after epoch: 5,now: 2024-07-23 04:55:11.942889,epoch time: 0:01:14.521124,used: 0:06:19.148182,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_04_48_52_seed_0_22779258
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.976237, 'precision': 0.97683704, 'recall': 0.9765085, 'specificity': 0.9765085, 'f1': 0.97623545, 'auroc': 0.9984162, 'binary_precision': 0.99731725, 'binary_recall': 0.9556555, 'binary_specificity': 0.9973615, 'binary_f1_score': 0.97604203}
confusion matrix:
      0     1
0  1512     4
1    69  1487
---- Validation: 
scalar performance:
{'acc': 0.6863354, 'precision': 0.7728685, 'recall': 0.68234557, 'specificity': 0.68234557, 'f1': 0.6564299, 'auroc': 0.86610556, 'binary_precision': 0.9230769, 'binary_recall': 0.3968504, 'binary_specificity': 0.96784073, 'binary_f1_score': 0.55506605}
confusion matrix:
     0    1
0  632   21
1  383  252
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.83023256, 'precision': 0.8403112, 'recall': 0.83023256, 'specificity': 0.83023256, 'f1': 0.82896626, 'auroc': 0.91123855, 'binary_precision': 0.8988764, 'binary_recall': 0.74418604, 'binary_specificity': 0.9162791, 'binary_f1_score': 0.8142494}
confusion matrix:
     0    1
0  197   18
1   55  160
early stop counter: 4
val acc:0.6863353848457336, best validation acc: 0.861801266670227, corresponding to test acc:                         0.8581395149230957 / 0.8581395149230957
after epoch: 6,now: 2024-07-23 04:56:26.399697,epoch time: 0:01:14.456808,used: 0:07:33.604990,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_04_48_52_seed_0_22779258
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9814453, 'precision': 0.98142636, 'recall': 0.9814641, 'specificity': 0.9814641, 'f1': 0.9814426, 'auroc': 0.99836403, 'binary_precision': 0.9832474, 'binary_recall': 0.9800899, 'binary_specificity': 0.9828383, 'binary_f1_score': 0.9816661}
confusion matrix:
      0     1
0  1489    26
1    31  1526
---- Validation: 
scalar performance:
{'acc': 0.8214286, 'precision': 0.82276547, 'recall': 0.82095957, 'specificity': 0.82095957, 'f1': 0.8210657, 'auroc': 0.894112, 'binary_precision': 0.84033614, 'binary_recall': 0.78740156, 'binary_specificity': 0.85451764, 'binary_f1_score': 0.8130081}
confusion matrix:
     0    1
0  558   95
1  135  500
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.82325584, 'precision': 0.8233677, 'recall': 0.8232558, 'specificity': 0.8232558, 'f1': 0.8232405, 'auroc': 0.9110222, 'binary_precision': 0.8173516, 'binary_recall': 0.83255816, 'binary_specificity': 0.81395346, 'binary_f1_score': 0.8248848}
confusion matrix:
     0    1
0  175   40
1   36  179
early stop counter: 5
val acc:0.8214285969734192, best validation acc: 0.861801266670227, corresponding to test acc:                         0.8581395149230957 / 0.8581395149230957
after epoch: 7,now: 2024-07-23 04:57:41.124422,epoch time: 0:01:14.724725,used: 0:08:48.329715,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_04_48_52_seed_0_22779258
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.98339844, 'precision': 0.98356104, 'recall': 0.9835862, 'specificity': 0.9835862, 'f1': 0.98339844, 'auroc': 0.9989109, 'binary_precision': 0.99670404, 'binary_recall': 0.97047496, 'binary_specificity': 0.9966975, 'binary_f1_score': 0.98341465}
confusion matrix:
      0     1
0  1509     5
1    46  1512
---- Validation: 
scalar performance:
{'acc': 0.7826087, 'precision': 0.7960433, 'recall': 0.7810903, 'specificity': 0.7810903, 'f1': 0.7794558, 'auroc': 0.8864839, 'binary_precision': 0.8557114, 'binary_recall': 0.67244095, 'binary_specificity': 0.8897397, 'binary_f1_score': 0.7530864}
confusion matrix:
     0    1
0  581   72
1  208  427
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8372093, 'precision': 0.83958954, 'recall': 0.8372093, 'specificity': 0.8372093, 'f1': 0.8369235, 'auroc': 0.9137913, 'binary_precision': 0.8680203, 'binary_recall': 0.7953488, 'binary_specificity': 0.87906975, 'binary_f1_score': 0.830097}
confusion matrix:
     0    1
0  189   26
1   44  171
early stop counter: 6
val acc:0.782608687877655, best validation acc: 0.861801266670227, corresponding to test acc:                         0.8581395149230957 / 0.8581395149230957
after epoch: 8,now: 2024-07-23 04:58:55.596124,epoch time: 0:01:14.471702,used: 0:10:02.801417,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_04_48_52_seed_0_22779258
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.98046875, 'precision': 0.98065007, 'recall': 0.9803722, 'specificity': 0.9803722, 'f1': 0.98046076, 'auroc': 0.9986422, 'binary_precision': 0.97401774, 'binary_recall': 0.9877892, 'binary_specificity': 0.97295517, 'binary_f1_score': 0.9808551}
confusion matrix:
      0     1
0  1475    41
1    19  1537
---- Validation: 
scalar performance:
{'acc': 0.8377329, 'precision': 0.8395343, 'recall': 0.83721286, 'specificity': 0.83721286, 'f1': 0.8373438, 'auroc': 0.90392256, 'binary_precision': 0.8610169, 'binary_recall': 0.8, 'binary_specificity': 0.8744257, 'binary_f1_score': 0.8293878}
confusion matrix:
     0    1
0  571   82
1  127  508
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8418605, 'precision': 0.84292877, 'recall': 0.8418604, 'specificity': 0.8418604, 'f1': 0.8417372, 'auroc': 0.917642, 'binary_precision': 0.86206895, 'binary_recall': 0.81395346, 'binary_specificity': 0.8697674, 'binary_f1_score': 0.83732057}
confusion matrix:
     0    1
0  187   28
1   40  175
early stop counter: 7
val acc:0.8377329111099243, best validation acc: 0.861801266670227, corresponding to test acc:                         0.8581395149230957 / 0.8581395149230957
after epoch: 9,now: 2024-07-23 05:00:10.630059,epoch time: 0:01:15.033935,used: 0:11:17.835352,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_04_48_52_seed_0_22779258
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9794922, 'precision': 0.9795561, 'recall': 0.9794421, 'specificity': 0.9794421, 'f1': 0.9794865, 'auroc': 0.99827075, 'binary_precision': 0.976388, 'binary_recall': 0.9832905, 'binary_specificity': 0.9755937, 'binary_f1_score': 0.9798271}
confusion matrix:
      0     1
0  1479    37
1    26  1530
---- Validation: 
scalar performance:
{'acc': 0.7779503, 'precision': 0.78742254, 'recall': 0.77664804, 'specificity': 0.77664804, 'f1': 0.7755206, 'auroc': 0.8883337, 'binary_precision': 0.8362235, 'binary_recall': 0.6834646, 'binary_specificity': 0.86983156, 'binary_f1_score': 0.7521664}
confusion matrix:
     0    1
0  568   85
1  201  434
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.84418607, 'precision': 0.85717493, 'recall': 0.84418607, 'specificity': 0.84418607, 'f1': 0.8427565, 'auroc': 0.9202163, 'binary_precision': 0.92528737, 'binary_recall': 0.74883723, 'binary_specificity': 0.9395349, 'binary_f1_score': 0.8277635}
confusion matrix:
     0    1
0  202   13
1   54  161
early stop counter: 8
val acc:0.7779502868652344, best validation acc: 0.861801266670227, corresponding to test acc:                         0.8581395149230957 / 0.8581395149230957
after epoch: 10,now: 2024-07-23 05:01:25.398796,epoch time: 0:01:14.768737,used: 0:12:32.604089,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_04_48_52_seed_0_22779258
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9847005, 'precision': 0.98484427, 'recall': 0.98462164, 'specificity': 0.98462164, 'f1': 0.9846953, 'auroc': 0.9991331, 'binary_precision': 0.9790343, 'binary_recall': 0.9909968, 'binary_specificity': 0.9782465, 'binary_f1_score': 0.9849793}
confusion matrix:
      0     1
0  1484    33
1    14  1541
---- Validation: 
scalar performance:
{'acc': 0.8035714, 'precision': 0.8037845, 'recall': 0.80334854, 'specificity': 0.80334854, 'f1': 0.80342627, 'auroc': 0.8803824, 'binary_precision': 0.80906147, 'binary_recall': 0.78740156, 'binary_specificity': 0.8192956, 'binary_f1_score': 0.79808456}
confusion matrix:
     0    1
0  535  118
1  135  500
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7976744, 'precision': 0.8048564, 'recall': 0.7976744, 'specificity': 0.7976744, 'f1': 0.7964757, 'auroc': 0.91048133, 'binary_precision': 0.7580645, 'binary_recall': 0.8744186, 'binary_specificity': 0.7209302, 'binary_f1_score': 0.812095}
confusion matrix:
     0    1
0  155   60
1   27  188
early stop counter: 9
val acc:0.8035714030265808, best validation acc: 0.861801266670227, corresponding to test acc:                         0.8581395149230957 / 0.8581395149230957
after epoch: 11,now: 2024-07-23 05:02:41.034603,epoch time: 0:01:15.635807,used: 0:13:48.239896,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_04_48_52_seed_0_22779258
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.97721356, 'precision': 0.9779319, 'recall': 0.9775064, 'specificity': 0.9775064, 'f1': 0.97721136, 'auroc': 0.9982009, 'binary_precision': 1.0, 'binary_recall': 0.95501286, 'binary_specificity': 1.0, 'binary_f1_score': 0.97698885}
confusion matrix:
      0     1
0  1516     0
1    70  1486
---- Validation: 
scalar performance:
{'acc': 0.66071427, 'precision': 0.76804864, 'recall': 0.65623105, 'specificity': 0.65623105, 'f1': 0.6192595, 'auroc': 0.889964, 'binary_precision': 0.93421054, 'binary_recall': 0.33543307, 'binary_specificity': 0.9770291, 'binary_f1_score': 0.4936269}
confusion matrix:
     0    1
0  638   15
1  422  213
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.69534886, 'precision': 0.8052325, 'recall': 0.69534886, 'specificity': 0.69534886, 'f1': 0.66521853, 'auroc': 0.8867442, 'binary_precision': 0.9883721, 'binary_recall': 0.39534885, 'binary_specificity': 0.9953488, 'binary_f1_score': 0.5647841}
confusion matrix:
     0   1
0  214   1
1  130  85
early stop counter: 10
val acc:0.6607142686843872, best validation acc: 0.861801266670227, corresponding to test acc:                         0.8581395149230957 / 0.8581395149230957
after epoch: 12,now: 2024-07-23 05:03:55.507121,epoch time: 0:01:14.472518,used: 0:15:02.712414,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_04_48_52_seed_0_22779258
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9824219, 'precision': 0.98276705, 'recall': 0.9826393, 'specificity': 0.9826393, 'f1': 0.98242164, 'auroc': 0.9992572, 'binary_precision': 0.9993351, 'binary_recall': 0.9659383, 'binary_specificity': 0.99934036, 'binary_f1_score': 0.982353}
confusion matrix:
      0     1
0  1515     1
1    53  1503
---- Validation: 
scalar performance:
{'acc': 0.613354, 'precision': 0.755169, 'recall': 0.60806936, 'specificity': 0.60806936, 'f1': 0.54539245, 'auroc': 0.8553761, 'binary_precision': 0.9419355, 'binary_recall': 0.22992127, 'binary_specificity': 0.98621744, 'binary_f1_score': 0.36962026}
confusion matrix:
     0    1
0  644    9
1  489  146
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7767442, 'precision': 0.82945734, 'recall': 0.7767442, 'specificity': 0.7767442, 'f1': 0.76744187, 'auroc': 0.8992969, 'binary_precision': 0.9612403, 'binary_recall': 0.5767442, 'binary_specificity': 0.9767442, 'binary_f1_score': 0.7209303}
confusion matrix:
     0    1
0  210    5
1   91  124
early stop counter: 11
val acc:0.6133540272712708, best validation acc: 0.861801266670227, corresponding to test acc:                         0.8581395149230957 / 0.8581395149230957
after epoch: 13,now: 2024-07-23 05:05:10.968733,epoch time: 0:01:15.461612,used: 0:16:18.174026,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_04_48_52_seed_0_22779258
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.98046875, 'precision': 0.98050153, 'recall': 0.9805757, 'specificity': 0.9805757, 'f1': 0.9804684, 'auroc': 0.99881256, 'binary_precision': 0.98888886, 'binary_recall': 0.972365, 'binary_specificity': 0.9887863, 'binary_f1_score': 0.9805574}
confusion matrix:
      0     1
0  1499    17
1    43  1513
---- Validation: 
scalar performance:
{'acc': 0.85947204, 'precision': 0.86657625, 'recall': 0.8585005, 'specificity': 0.8585005, 'f1': 0.85853195, 'auroc': 0.92596495, 'binary_precision': 0.91423357, 'binary_recall': 0.7889764, 'binary_specificity': 0.92802453, 'binary_f1_score': 0.8469992}
confusion matrix:
     0    1
0  606   47
1  134  501
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.84418607, 'precision': 0.85249025, 'recall': 0.84418607, 'specificity': 0.84418607, 'f1': 0.8432629, 'auroc': 0.9137696, 'binary_precision': 0.9065934, 'binary_recall': 0.76744187, 'binary_specificity': 0.9209302, 'binary_f1_score': 0.8312343}
confusion matrix:
     0    1
0  198   17
1   50  165
early stop counter: 12
val acc:0.8594720363616943, best validation acc: 0.861801266670227, corresponding to test acc:                         0.8581395149230957 / 0.8581395149230957
after epoch: 14,now: 2024-07-23 05:06:25.325377,epoch time: 0:01:14.356644,used: 0:17:32.530670,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_04_48_52_seed_0_22779258
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9863281, 'precision': 0.98630476, 'recall': 0.986379, 'specificity': 0.986379, 'f1': 0.9863268, 'auroc': 0.9991182, 'binary_precision': 0.99029124, 'binary_recall': 0.982659, 'binary_specificity': 0.990099, 'binary_f1_score': 0.9864604}
confusion matrix:
      0     1
0  1500    15
1    27  1530
---- Validation: 
scalar performance:
{'acc': 0.77251554, 'precision': 0.7992026, 'recall': 0.77039826, 'specificity': 0.77039826, 'f1': 0.76636374, 'auroc': 0.8880322, 'binary_precision': 0.8851351, 'binary_recall': 0.6188976, 'binary_specificity': 0.9218989, 'binary_f1_score': 0.7284522}
confusion matrix:
     0    1
0  602   51
1  242  393
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8372093, 'precision': 0.8407774, 'recall': 0.8372093, 'specificity': 0.8372093, 'f1': 0.8367821, 'auroc': 0.8958356, 'binary_precision': 0.87564766, 'binary_recall': 0.7860465, 'binary_specificity': 0.88837206, 'binary_f1_score': 0.82843137}
confusion matrix:
     0    1
0  191   24
1   46  169
early stop counter: 13
val acc:0.7725155353546143, best validation acc: 0.861801266670227, corresponding to test acc:                         0.8581395149230957 / 0.8581395149230957
after epoch: 15,now: 2024-07-23 05:07:39.538992,epoch time: 0:01:14.213615,used: 0:18:46.744285,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_04_48_52_seed_0_22779258
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9905599, 'precision': 0.990649, 'recall': 0.9905003, 'specificity': 0.9905003, 'f1': 0.9905569, 'auroc': 0.99954164, 'binary_precision': 0.9866242, 'binary_recall': 0.9948619, 'binary_specificity': 0.98613864, 'binary_f1_score': 0.99072593}
confusion matrix:
      0     1
0  1494    21
1     8  1549
---- Validation: 
scalar performance:
{'acc': 0.85481364, 'precision': 0.85690475, 'recall': 0.8542752, 'specificity': 0.8542752, 'f1': 0.85444295, 'auroc': 0.91719866, 'binary_precision': 0.88095236, 'binary_recall': 0.81574804, 'binary_specificity': 0.8928025, 'binary_f1_score': 0.8470973}
confusion matrix:
     0    1
0  583   70
1  117  518
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8511628, 'precision': 0.85164964, 'recall': 0.8511628, 'specificity': 0.8511628, 'f1': 0.8511113, 'auroc': 0.92449975, 'binary_precision': 0.8647343, 'binary_recall': 0.83255816, 'binary_specificity': 0.8697674, 'binary_f1_score': 0.8483413}
confusion matrix:
     0    1
0  187   28
1   36  179
early stop counter: 14
val acc:0.8548136353492737, best validation acc: 0.861801266670227, corresponding to test acc:                         0.8581395149230957 / 0.8581395149230957
after epoch: 16,now: 2024-07-23 05:08:54.024252,epoch time: 0:01:14.485260,used: 0:20:01.229545,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_04_48_52_seed_0_22779258
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9876302, 'precision': 0.98762, 'recall': 0.9876927, 'specificity': 0.9876927, 'f1': 0.9876296, 'auroc': 0.9993434, 'binary_precision': 0.9928525, 'binary_recall': 0.98263663, 'binary_specificity': 0.99274886, 'binary_f1_score': 0.98771816}
confusion matrix:
      0     1
0  1506    11
1    27  1528
---- Validation: 
scalar performance:
{'acc': 0.761646, 'precision': 0.77032256, 'recall': 0.7603514, 'specificity': 0.7603514, 'f1': 0.7590771, 'auroc': 0.85907686, 'binary_precision': 0.8153846, 'binary_recall': 0.66771656, 'binary_specificity': 0.8529862, 'binary_f1_score': 0.73419917}
confusion matrix:
     0    1
0  557   96
1  211  424
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.81627905, 'precision': 0.81782603, 'recall': 0.81627905, 'specificity': 0.81627905, 'f1': 0.8160552, 'auroc': 0.89317465, 'binary_precision': 0.84, 'binary_recall': 0.7813954, 'binary_specificity': 0.8511628, 'binary_f1_score': 0.8096385}
confusion matrix:
     0    1
0  183   32
1   47  168
early stop counter: 15
val acc:0.7616459727287292, best validation acc: 0.861801266670227, corresponding to test acc:                         0.8581395149230957 / 0.8581395149230957
after epoch: 17,now: 2024-07-23 05:10:07.989935,epoch time: 0:01:13.965683,used: 0:21:15.195228,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_04_48_52_seed_0_22779258
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9847005, 'precision': 0.9849349, 'recall': 0.9848887, 'specificity': 0.9848887, 'f1': 0.9847005, 'auroc': 0.9993488, 'binary_precision': 0.9993382, 'binary_recall': 0.970437, 'binary_specificity': 0.99934036, 'binary_f1_score': 0.9846756}
confusion matrix:
      0     1
0  1515     1
1    46  1510
---- Validation: 
scalar performance:
{'acc': 0.57220495, 'precision': 0.7357143, 'recall': 0.56629366, 'specificity': 0.56629366, 'f1': 0.4746628, 'auroc': 0.8931166, 'binary_precision': 0.9285714, 'binary_recall': 0.14330709, 'binary_specificity': 0.9892802, 'binary_f1_score': 0.24829471}
confusion matrix:
     0   1
0  646   7
1  544  91
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6372093, 'precision': 0.7897574, 'recall': 0.6372093, 'specificity': 0.6372093, 'f1': 0.5822227, 'auroc': 0.90150356, 'binary_precision': 1.0, 'binary_recall': 0.2744186, 'binary_specificity': 1.0, 'binary_f1_score': 0.4306569}
confusion matrix:
     0   1
0  215   0
1  156  59
early stop counter: 16
val acc:0.5722049474716187, best validation acc: 0.861801266670227, corresponding to test acc:                         0.8581395149230957 / 0.8581395149230957
after epoch: 18,now: 2024-07-23 05:11:22.423626,epoch time: 0:01:14.433691,used: 0:22:29.628919,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_04_48_52_seed_0_22779258
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9895833, 'precision': 0.989715, 'recall': 0.9895132, 'specificity': 0.9895132, 'f1': 0.98958015, 'auroc': 0.99967575, 'binary_precision': 0.9840967, 'binary_recall': 0.9954955, 'binary_specificity': 0.98353094, 'binary_f1_score': 0.9897633}
confusion matrix:
      0     1
0  1493    25
1     7  1547
---- Validation: 
scalar performance:
{'acc': 0.7996894, 'precision': 0.8119321, 'recall': 0.7982829, 'specificity': 0.7982829, 'f1': 0.79715395, 'auroc': 0.894645, 'binary_precision': 0.87033397, 'binary_recall': 0.6976378, 'binary_specificity': 0.89892805, 'binary_f1_score': 0.7744755}
confusion matrix:
     0    1
0  587   66
1  192  443
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.83255816, 'precision': 0.83255816, 'recall': 0.83255816, 'specificity': 0.83255816, 'f1': 0.83255816, 'auroc': 0.91374797, 'binary_precision': 0.83255816, 'binary_recall': 0.83255816, 'binary_specificity': 0.83255816, 'binary_f1_score': 0.83255816}
confusion matrix:
     0    1
0  179   36
1   36  179
early stop counter: 17
val acc:0.7996894121170044, best validation acc: 0.861801266670227, corresponding to test acc:                         0.8581395149230957 / 0.8581395149230957
after epoch: 19,now: 2024-07-23 05:12:36.524238,epoch time: 0:01:14.100612,used: 0:23:43.729531,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_04_48_52_seed_0_22779258
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9860026, 'precision': 0.9861053, 'recall': 0.98615575, 'specificity': 0.98615575, 'f1': 0.98600256, 'auroc': 0.99945056, 'binary_precision': 0.99737185, 'binary_recall': 0.9749518, 'binary_specificity': 0.99735975, 'binary_f1_score': 0.9860344}
confusion matrix:
      0     1
0  1511     4
1    39  1518
---- Validation: 
scalar performance:
{'acc': 0.6622671, 'precision': 0.7671271, 'recall': 0.6578276, 'specificity': 0.6578276, 'f1': 0.6218675, 'auroc': 0.89071095, 'binary_precision': 0.9310345, 'binary_recall': 0.34015748, 'binary_specificity': 0.9754977, 'binary_f1_score': 0.4982699}
confusion matrix:
     0    1
0  637   16
1  419  216
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.83023256, 'precision': 0.8681507, 'recall': 0.83023256, 'specificity': 0.83023256, 'f1': 0.8257457, 'auroc': 0.92941046, 'binary_precision': 0.98630136, 'binary_recall': 0.66976744, 'binary_specificity': 0.9906977, 'binary_f1_score': 0.797784}
confusion matrix:
     0    1
0  213    2
1   71  144
early stop counter: 18
val acc:0.6622670888900757, best validation acc: 0.861801266670227, corresponding to test acc:                         0.8581395149230957 / 0.8581395149230957
after epoch: 20,now: 2024-07-23 05:13:50.792735,epoch time: 0:01:14.268497,used: 0:24:57.998028,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_04_48_52_seed_0_22779258
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9938151, 'precision': 0.9938104, 'recall': 0.99381816, 'specificity': 0.99381816, 'f1': 0.9938142, 'auroc': 0.99976003, 'binary_precision': 0.9942085, 'binary_recall': 0.99356914, 'binary_specificity': 0.99406725, 'binary_f1_score': 0.9938887}
confusion matrix:
      0     1
0  1508     9
1    10  1545
---- Validation: 
scalar performance:
{'acc': 0.8338509, 'precision': 0.8463482, 'recall': 0.8325162, 'specificity': 0.8325162, 'f1': 0.8319214, 'auroc': 0.90830624, 'binary_precision': 0.90873784, 'binary_recall': 0.73700786, 'binary_specificity': 0.92802453, 'binary_f1_score': 0.813913}
confusion matrix:
     0    1
0  606   47
1  167  468
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.86744183, 'precision': 0.8813084, 'recall': 0.86744183, 'specificity': 0.86744183, 'f1': 0.8662257, 'auroc': 0.9325906, 'binary_precision': 0.954023, 'binary_recall': 0.772093, 'binary_specificity': 0.96279067, 'binary_f1_score': 0.8534705}
confusion matrix:
     0    1
0  207    8
1   49  166
new oracle model saved
early stop counter: 19
val acc:0.8338509202003479, best validation acc: 0.861801266670227, corresponding to test acc:                         0.8581395149230957 / 0.8674418330192566
after epoch: 21,now: 2024-07-23 05:15:04.974064,epoch time: 0:01:14.181329,used: 0:26:12.179357,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_04_48_52_seed_0_22779258
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9902344, 'precision': 0.9903161, 'recall': 0.99017644, 'specificity': 0.99017644, 'f1': 0.9902311, 'auroc': 0.9996393, 'binary_precision': 0.9866242, 'binary_recall': 0.99422336, 'binary_specificity': 0.98612946, 'binary_f1_score': 0.99040914}
confusion matrix:
      0     1
0  1493    21
1     9  1549
---- Validation: 
scalar performance:
{'acc': 0.8082298, 'precision': 0.8111464, 'recall': 0.8075304, 'specificity': 0.8075304, 'f1': 0.8075057, 'auroc': 0.87675536, 'binary_precision': 0.8379791, 'binary_recall': 0.7574803, 'binary_specificity': 0.8575804, 'binary_f1_score': 0.79569894}
confusion matrix:
     0    1
0  560   93
1  154  481
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8418605, 'precision': 0.8418605, 'recall': 0.8418605, 'specificity': 0.8418605, 'f1': 0.8418604, 'auroc': 0.92746353, 'binary_precision': 0.8418605, 'binary_recall': 0.8418605, 'binary_specificity': 0.8418605, 'binary_f1_score': 0.8418604}
confusion matrix:
     0    1
0  181   34
1   34  181
early stop counter: 20
val acc:0.8082298040390015, best validation acc: 0.861801266670227, corresponding to test acc:                         0.8581395149230957 / 0.8674418330192566
after epoch: 22,now: 2024-07-23 05:16:19.270791,epoch time: 0:01:14.296727,used: 0:27:26.476084,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_04_48_52_seed_0_22779258
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.99153644, 'precision': 0.99151933, 'recall': 0.9915593, 'specificity': 0.9915593, 'f1': 0.9915355, 'auroc': 0.9995837, 'binary_precision': 0.9935442, 'binary_recall': 0.9897106, 'binary_specificity': 0.993408, 'binary_f1_score': 0.99162364}
confusion matrix:
      0     1
0  1507    10
1    16  1539
---- Validation: 
scalar performance:
{'acc': 0.7779503, 'precision': 0.8272835, 'recall': 0.7752155, 'specificity': 0.7752155, 'f1': 0.76805764, 'auroc': 0.91270876, 'binary_precision': 0.95090437, 'binary_recall': 0.57952756, 'binary_specificity': 0.9709035, 'binary_f1_score': 0.7201565}
confusion matrix:
     0    1
0  634   19
1  267  368
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.80465114, 'precision': 0.85953176, 'recall': 0.80465114, 'specificity': 0.80465114, 'f1': 0.79690063, 'auroc': 0.93546784, 'binary_precision': 1.0, 'binary_recall': 0.60930234, 'binary_specificity': 1.0, 'binary_f1_score': 0.75722545}
confusion matrix:
     0    1
0  215    0
1   84  131
early stop counter: 21
val acc:0.7779502868652344, best validation acc: 0.861801266670227, corresponding to test acc:                         0.8581395149230957 / 0.8674418330192566
after epoch: 23,now: 2024-07-23 05:17:34.112136,epoch time: 0:01:14.841345,used: 0:28:41.317429,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_04_48_52_seed_0_22779258
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9876302, 'precision': 0.9876736, 'recall': 0.9875942, 'specificity': 0.9875942, 'f1': 0.98762715, 'auroc': 0.9996096, 'binary_precision': 0.9852941, 'binary_recall': 0.9903599, 'binary_specificity': 0.9848285, 'binary_f1_score': 0.9878205}
confusion matrix:
      0     1
0  1493    23
1    15  1541
---- Validation: 
scalar performance:
{'acc': 0.73136646, 'precision': 0.7758926, 'recall': 0.7285141, 'specificity': 0.7285141, 'f1': 0.71843755, 'auroc': 0.8781806, 'binary_precision': 0.8832891, 'binary_recall': 0.5244095, 'binary_specificity': 0.9326187, 'binary_f1_score': 0.65810275}
confusion matrix:
     0    1
0  609   44
1  302  333
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8534884, 'precision': 0.87285507, 'recall': 0.8534883, 'specificity': 0.8534883, 'f1': 0.85156083, 'auroc': 0.9268794, 'binary_precision': 0.9578313, 'binary_recall': 0.73953485, 'binary_specificity': 0.96744186, 'binary_f1_score': 0.8346456}
confusion matrix:
     0    1
0  208    7
1   56  159
early stop counter: 22
val acc:0.7313664555549622, best validation acc: 0.861801266670227, corresponding to test acc:                         0.8581395149230957 / 0.8674418330192566
after epoch: 24,now: 2024-07-23 05:18:48.865532,epoch time: 0:01:14.753396,used: 0:29:56.070825,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_04_48_52_seed_0_22779258
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.9967448, 'precision': 0.99672997, 'recall': 0.99676204, 'specificity': 0.99676204, 'f1': 0.99674433, 'auroc': 0.99993765, 'binary_precision': 0.9980683, 'binary_recall': 0.9955042, 'binary_specificity': 0.9980198, 'binary_f1_score': 0.9967846}
confusion matrix:
      0     1
0  1512     3
1     7  1550
---- Validation: 
scalar performance:
{'acc': 0.70729816, 'precision': 0.7810491, 'recall': 0.7036705, 'specificity': 0.7036705, 'f1': 0.68439066, 'auroc': 0.8827543, 'binary_precision': 0.92156863, 'binary_recall': 0.44409448, 'binary_specificity': 0.9632466, 'binary_f1_score': 0.59936243}
confusion matrix:
     0    1
0  629   24
1  353  282
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7930232, 'precision': 0.8503984, 'recall': 0.7930232, 'specificity': 0.7930232, 'f1': 0.78418887, 'auroc': 0.9382369, 'binary_precision': 0.9921875, 'binary_recall': 0.59069765, 'binary_specificity': 0.9953488, 'binary_f1_score': 0.74052477}
confusion matrix:
     0    1
0  214    1
1   88  127
early stop counter: 23
val acc:0.7072981595993042, best validation acc: 0.861801266670227, corresponding to test acc:                         0.8581395149230957 / 0.8674418330192566
after epoch: 25,now: 2024-07-23 05:20:03.468188,epoch time: 0:01:14.602656,used: 0:31:10.673481,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_04_48_52_seed_0_22779258
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.98795575, 'precision': 0.9881985, 'recall': 0.9878311, 'specificity': 0.9878311, 'f1': 0.9879493, 'auroc': 0.99951583, 'binary_precision': 0.9804293, 'binary_recall': 0.9961514, 'binary_specificity': 0.9795109, 'binary_f1_score': 0.98822784}
confusion matrix:
      0     1
0  1482    31
1     6  1553
---- Validation: 
scalar performance:
{'acc': 0.8113354, 'precision': 0.8269998, 'recall': 0.8097901, 'specificity': 0.8097901, 'f1': 0.8084899, 'auroc': 0.9002569, 'binary_precision': 0.8951613, 'binary_recall': 0.6992126, 'binary_specificity': 0.92036754, 'binary_f1_score': 0.7851459}
confusion matrix:
     0    1
0  601   52
1  191  444
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8465116, 'precision': 0.85650694, 'recall': 0.8465116, 'specificity': 0.8465116, 'f1': 0.8454282, 'auroc': 0.90314764, 'binary_precision': 0.9162011, 'binary_recall': 0.7627907, 'binary_specificity': 0.9302326, 'binary_f1_score': 0.8324873}
confusion matrix:
     0    1
0  200   15
1   51  164
early stop counter: 24
val acc:0.8113353848457336, best validation acc: 0.861801266670227, corresponding to test acc:                         0.8581395149230957 / 0.8674418330192566
after epoch: 26,now: 2024-07-23 05:21:17.689614,epoch time: 0:01:14.221426,used: 0:32:24.894907,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_04_48_52_seed_0_22779258
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.98535156, 'precision': 0.9855411, 'recall': 0.9852618, 'specificity': 0.9852618, 'f1': 0.98534614, 'auroc': 0.99924874, 'binary_precision': 0.97844005, 'binary_recall': 0.9929215, 'binary_specificity': 0.9776021, 'binary_f1_score': 0.98562753}
confusion matrix:
      0     1
0  1484    34
1    11  1543
---- Validation: 
scalar performance:
{'acc': 0.7041925, 'precision': 0.76340544, 'recall': 0.7008248, 'specificity': 0.7008248, 'f1': 0.68434113, 'auroc': 0.84776986, 'binary_precision': 0.8848485, 'binary_recall': 0.45984253, 'binary_specificity': 0.94180703, 'binary_f1_score': 0.60518134}
confusion matrix:
     0    1
0  615   38
1  343  292
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.80930233, 'precision': 0.8508675, 'recall': 0.80930233, 'specificity': 0.80930233, 'f1': 0.8034823, 'auroc': 0.91469985, 'binary_precision': 0.9716312, 'binary_recall': 0.6372093, 'binary_specificity': 0.98139536, 'binary_f1_score': 0.769663}
confusion matrix:
     0    1
0  211    4
1   78  137
early stop counter: 25
val acc:0.7041925191879272, best validation acc: 0.861801266670227, corresponding to test acc:                         0.8581395149230957 / 0.8674418330192566
after epoch: 27,now: 2024-07-23 05:22:32.057635,epoch time: 0:01:14.368021,used: 0:33:39.262928,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_04_48_52_seed_0_22779258
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.9967448, 'precision': 0.99674433, 'recall': 0.99674433, 'specificity': 0.99674433, 'f1': 0.99674433, 'auroc': 0.99995506, 'binary_precision': 0.9967825, 'binary_recall': 0.9967825, 'binary_specificity': 0.9967062, 'binary_f1_score': 0.9967825}
confusion matrix:
      0     1
0  1513     5
1     5  1549
---- Validation: 
scalar performance:
{'acc': 0.7919255, 'precision': 0.833827, 'recall': 0.78943217, 'specificity': 0.78943217, 'f1': 0.78418016, 'auroc': 0.91872096, 'binary_precision': 0.94865525, 'binary_recall': 0.6110236, 'binary_specificity': 0.96784073, 'binary_f1_score': 0.7432951}
confusion matrix:
     0    1
0  632   21
1  247  388
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8255814, 'precision': 0.8680067, 'recall': 0.8255814, 'specificity': 0.8255814, 'f1': 0.82040524, 'auroc': 0.9395781, 'binary_precision': 0.9929578, 'binary_recall': 0.65581393, 'binary_specificity': 0.9953488, 'binary_f1_score': 0.7899159}
confusion matrix:
     0    1
0  214    1
1   74  141
early stop counter: 26
val acc:0.7919254899024963, best validation acc: 0.861801266670227, corresponding to test acc:                         0.8581395149230957 / 0.8674418330192566
after epoch: 28,now: 2024-07-23 05:23:46.650129,epoch time: 0:01:14.592494,used: 0:34:53.855422,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_04_48_52_seed_0_22779258
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.99316406, 'precision': 0.993202, 'recall': 0.9931332, 'specificity': 0.9931332, 'f1': 0.99316245, 'auroc': 0.9998766, 'binary_precision': 0.99104285, 'binary_recall': 0.9955013, 'binary_specificity': 0.99076515, 'binary_f1_score': 0.99326706}
confusion matrix:
      0     1
0  1502    14
1     7  1549
---- Validation: 
scalar performance:
{'acc': 0.8175466, 'precision': 0.8268939, 'recall': 0.81634974, 'specificity': 0.81634974, 'f1': 0.81581175, 'auroc': 0.9064379, 'binary_precision': 0.8787879, 'binary_recall': 0.73070866, 'binary_specificity': 0.90199083, 'binary_f1_score': 0.7979363}
confusion matrix:
     0    1
0  589   64
1  171  464
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7883721, 'precision': 0.83887535, 'recall': 0.7883721, 'specificity': 0.7883721, 'f1': 0.7801821, 'auroc': 0.91649544, 'binary_precision': 0.969697, 'binary_recall': 0.59534883, 'binary_specificity': 0.98139536, 'binary_f1_score': 0.7377522}
confusion matrix:
     0    1
0  211    4
1   87  128
early stop counter: 27
val acc:0.8175466060638428, best validation acc: 0.861801266670227, corresponding to test acc:                         0.8581395149230957 / 0.8674418330192566
after epoch: 29,now: 2024-07-23 05:25:00.921332,epoch time: 0:01:14.271203,used: 0:36:08.126625,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_04_48_52_seed_0_22779258
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.9895833, 'precision': 0.9896247, 'recall': 0.98970604, 'specificity': 0.98970604, 'f1': 0.98958313, 'auroc': 0.9994751, 'binary_precision': 0.998692, 'binary_recall': 0.9807322, 'binary_specificity': 0.9986799, 'binary_f1_score': 0.9896306}
confusion matrix:
      0     1
0  1513     2
1    30  1527
---- Validation: 
scalar performance:
{'acc': 0.7492236, 'precision': 0.81413823, 'recall': 0.7460166, 'specificity': 0.7460166, 'f1': 0.73390865, 'auroc': 0.9141479, 'binary_precision': 0.95348835, 'binary_recall': 0.51653546, 'binary_specificity': 0.9754977, 'binary_f1_score': 0.6700715}
confusion matrix:
     0    1
0  637   16
1  307  328
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7069768, 'precision': 0.81524926, 'recall': 0.7069768, 'specificity': 0.7069768, 'f1': 0.6794538, 'auroc': 0.92276907, 'binary_precision': 1.0, 'binary_recall': 0.41395348, 'binary_specificity': 1.0, 'binary_f1_score': 0.5855263}
confusion matrix:
     0   1
0  215   0
1  126  89
early stop counter: 28
val acc:0.7492235898971558, best validation acc: 0.861801266670227, corresponding to test acc:                         0.8581395149230957 / 0.8674418330192566
after epoch: 30,now: 2024-07-23 05:26:15.585876,epoch time: 0:01:14.664544,used: 0:37:22.791169,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_04_48_52_seed_0_22779258
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 0:37:22.791169 at 2024-07-23 05:26:15.585876
persisted model performance metric: 

scalar performance:
{'acc': 0.8581395, 'precision': 0.85820925, 'recall': 0.8581395, 'specificity': 0.8581395, 'f1': 0.85813266, 'auroc': 0.92620873, 'binary_precision': 0.853211, 'binary_recall': 0.8651163, 'binary_specificity': 0.8511628, 'binary_f1_score': 0.85912246}
confusion matrix:
     0    1
0  183   32
1   29  186
oracle model performance metric: 

scalar performance:
{'acc': 0.86744183, 'precision': 0.8813084, 'recall': 0.86744183, 'specificity': 0.86744183, 'f1': 0.8662257, 'auroc': 0.9325906, 'binary_precision': 0.954023, 'binary_recall': 0.772093, 'binary_specificity': 0.96279067, 'binary_f1_score': 0.8534705}
confusion matrix:
     0    1
0  207    8
1   49  166
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_dial_lr1e5_bs32_nofreeze_2024-07-23_01-16-41/rule_results/1.csv
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_dial_lr1e5_bs32_nofreeze_2024-07-23_01-16-41/rule_results/1.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_dial_lr1e5_bs32_nofreeze_2024-07-23_01-16-41/confusion_matrix/1.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 455936 KiB |  26075 MiB |  70808 GiB |  70808 GiB |
|       from large pool | 415383 KiB |  26030 MiB |  70366 GiB |  70365 GiB |
|       from small pool |  40553 KiB |     56 MiB |    442 GiB |    442 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 455936 KiB |  26075 MiB |  70808 GiB |  70808 GiB |
|       from large pool | 415383 KiB |  26030 MiB |  70366 GiB |  70365 GiB |
|       from small pool |  40553 KiB |     56 MiB |    442 GiB |    442 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 447480 KiB |  26071 MiB |  70793 GiB |  70793 GiB |
|       from large pool | 407075 KiB |  26026 MiB |  70352 GiB |  70351 GiB |
|       from small pool |  40405 KiB |     56 MiB |    441 GiB |    441 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  27748 MiB |  27748 MiB |  27748 MiB |      0 B   |
|       from large pool |  27680 MiB |  27680 MiB |  27680 MiB |      0 B   |
|       from small pool |     68 MiB |     68 MiB |     68 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |    770 MiB |   1678 MiB |  33155 GiB |  33154 GiB |
|       from large pool |    752 MiB |   1668 MiB |  32710 GiB |  32709 GiB |
|       from small pool |     18 MiB |     21 MiB |    444 GiB |    444 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    1220    |    2568    |    6427 K  |    6426 K  |
|       from large pool |     187    |    1413    |    3247 K  |    3247 K  |
|       from small pool |    1033    |    1329    |    3179 K  |    3178 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    1220    |    2568    |    6427 K  |    6426 K  |
|       from large pool |     187    |    1413    |    3247 K  |    3247 K  |
|       from small pool |    1033    |    1329    |    3179 K  |    3178 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     834    |     834    |     834    |       0    |
|       from large pool |     800    |     800    |     800    |       0    |
|       from small pool |      34    |      34    |      34    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     104    |     852    |    4738 K  |    4738 K  |
|       from large pool |      39    |     799    |    2905 K  |    2905 K  |
|       from small pool |      65    |     146    |    1833 K  |    1833 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  26075 MiB |  70808 GiB |  70808 GiB |
|       from large pool |  16640 KiB |  26030 MiB |  70366 GiB |  70366 GiB |
|       from small pool |      0 KiB |     56 MiB |    442 GiB |    442 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  26075 MiB |  70808 GiB |  70808 GiB |
|       from large pool |  16640 KiB |  26030 MiB |  70366 GiB |  70366 GiB |
|       from small pool |      0 KiB |     56 MiB |    442 GiB |    442 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  26071 MiB |  70793 GiB |  70793 GiB |
|       from large pool |  16640 KiB |  26026 MiB |  70352 GiB |  70352 GiB |
|       from small pool |      0 KiB |     56 MiB |    441 GiB |    441 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1216 MiB |  27748 MiB |  27748 MiB |  26532 MiB |
|       from large pool |   1158 MiB |  27680 MiB |  27680 MiB |  26522 MiB |
|       from small pool |     58 MiB |     68 MiB |     68 MiB |     10 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |   3840 KiB |   1678 MiB |  33155 GiB |  33155 GiB |
|       from large pool |   3840 KiB |   1668 MiB |  32711 GiB |  32711 GiB |
|       from small pool |      0 KiB |     37 MiB |    444 GiB |    444 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    2568    |    6427 K  |    6427 K  |
|       from large pool |       2    |    1413    |    3247 K  |    3247 K  |
|       from small pool |       0    |    1329    |    3179 K  |    3179 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    2568    |    6427 K  |    6427 K  |
|       from large pool |       2    |    1413    |    3247 K  |    3247 K  |
|       from small pool |       0    |    1329    |    3179 K  |    3179 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      68    |     834    |     834    |     766    |
|       from large pool |      39    |     800    |     800    |     761    |
|       from small pool |      29    |      34    |      34    |       5    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       1    |     852    |    4738 K  |    4738 K  |
|       from large pool |       1    |     799    |    2905 K  |    2905 K  |
|       from small pool |       0    |     146    |    1833 K  |    1833 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  26075 MiB |  70808 GiB |  70808 GiB |
|       from large pool |  16640 KiB |  26030 MiB |  70366 GiB |  70366 GiB |
|       from small pool |      0 KiB |     56 MiB |    442 GiB |    442 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  26075 MiB |  70808 GiB |  70808 GiB |
|       from large pool |  16640 KiB |  26030 MiB |  70366 GiB |  70366 GiB |
|       from small pool |      0 KiB |     56 MiB |    442 GiB |    442 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  26071 MiB |  70793 GiB |  70793 GiB |
|       from large pool |  16640 KiB |  26026 MiB |  70352 GiB |  70352 GiB |
|       from small pool |      0 KiB |     56 MiB |    441 GiB |    441 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1216 MiB |  27748 MiB |  27748 MiB |  26532 MiB |
|       from large pool |   1158 MiB |  27680 MiB |  27680 MiB |  26522 MiB |
|       from small pool |     58 MiB |     68 MiB |     68 MiB |     10 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |   3840 KiB |   1678 MiB |  33155 GiB |  33155 GiB |
|       from large pool |   3840 KiB |   1668 MiB |  32711 GiB |  32711 GiB |
|       from small pool |      0 KiB |     37 MiB |    444 GiB |    444 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    2568    |    6427 K  |    6427 K  |
|       from large pool |       2    |    1413    |    3247 K  |    3247 K  |
|       from small pool |       0    |    1329    |    3179 K  |    3179 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    2568    |    6427 K  |    6427 K  |
|       from large pool |       2    |    1413    |    3247 K  |    3247 K  |
|       from small pool |       0    |    1329    |    3179 K  |    3179 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      68    |     834    |     834    |     766    |
|       from large pool |      39    |     800    |     800    |     761    |
|       from small pool |      29    |      34    |      34    |       5    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       1    |     852    |    4738 K  |    4738 K  |
|       from large pool |       1    |     799    |    2905 K  |    2905 K  |
|       from small pool |       0    |     146    |    1833 K  |    1833 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'888c1ef2'
model name: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_05_27_29_seed_1_22779258

 Experiment start at: 2024-07-23 05:27:29.611704
before training, model accuracy: 0.6177777647972107
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9423828, 'precision': 0.9432869, 'recall': 0.94270796, 'specificity': 0.94270796, 'f1': 0.9423735, 'auroc': 0.98351264, 'binary_precision': 0.96682465, 'binary_recall': 0.9177378, 'binary_specificity': 0.9676781, 'binary_f1_score': 0.94164187}
confusion matrix:
      0     1
0  1467    49
1   128  1428
---- Validation: 
scalar performance:
{'acc': 0.8181108, 'precision': 0.82006395, 'recall': 0.81874037, 'specificity': 0.81874037, 'f1': 0.8179973, 'auroc': 0.90546656, 'binary_precision': 0.79062957, 'binary_recall': 0.85714287, 'binary_specificity': 0.7803379, 'binary_f1_score': 0.8225438}
confusion matrix:
     0    1
0  508  143
1   90  540
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.82222223, 'precision': 0.8234746, 'recall': 0.82222223, 'specificity': 0.82222223, 'f1': 0.82205, 'auroc': 0.91223705, 'binary_precision': 0.8033473, 'binary_recall': 0.85333335, 'binary_specificity': 0.7911111, 'binary_f1_score': 0.82758623}
confusion matrix:
     0    1
0  178   47
1   33  192
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-23 05:28:48.601849,epoch time: 0:01:18.990145,used: 0:01:18.990145,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_05_27_29_seed_1_22779258
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.96191406, 'precision': 0.9624405, 'recall': 0.9621416, 'specificity': 0.9621416, 'f1': 0.96191156, 'auroc': 0.99230045, 'binary_precision': 0.9812458, 'binary_recall': 0.94272846, 'binary_specificity': 0.9815547, 'binary_f1_score': 0.96160156}
confusion matrix:
      0     1
0  1490    28
1    89  1465
---- Validation: 
scalar performance:
{'acc': 0.83528495, 'precision': 0.8372672, 'recall': 0.834639, 'specificity': 0.834639, 'f1': 0.83481944, 'auroc': 0.90353787, 'binary_precision': 0.8593482, 'binary_recall': 0.7952381, 'binary_specificity': 0.87403995, 'binary_f1_score': 0.82605106}
confusion matrix:
     0    1
0  569   82
1  129  501
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.84444445, 'precision': 0.8444717, 'recall': 0.8444444, 'specificity': 0.8444444, 'f1': 0.84444135, 'auroc': 0.91466665, 'binary_precision': 0.84753364, 'binary_recall': 0.84, 'binary_specificity': 0.8488889, 'binary_f1_score': 0.84375}
confusion matrix:
     0    1
0  191   34
1   36  189
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-07-23 05:30:04.651340,epoch time: 0:01:16.049491,used: 0:02:35.039636,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_05_27_29_seed_1_22779258
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9710286, 'precision': 0.9716115, 'recall': 0.9713125, 'specificity': 0.9713125, 'f1': 0.971027, 'auroc': 0.99658096, 'binary_precision': 0.9919571, 'binary_recall': 0.9505459, 'binary_specificity': 0.9920792, 'binary_f1_score': 0.9708101}
confusion matrix:
      0     1
0  1503    12
1    77  1480
---- Validation: 
scalar performance:
{'acc': 0.8345043, 'precision': 0.84261394, 'recall': 0.833231, 'specificity': 0.833231, 'f1': 0.83311206, 'auroc': 0.90463996, 'binary_precision': 0.8913858, 'binary_recall': 0.75555557, 'binary_specificity': 0.9109063, 'binary_f1_score': 0.81786937}
confusion matrix:
     0    1
0  593   58
1  154  476
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8688889, 'precision': 0.87100685, 'recall': 0.8688889, 'specificity': 0.8688889, 'f1': 0.8687015, 'auroc': 0.9279605, 'binary_precision': 0.89903843, 'binary_recall': 0.83111113, 'binary_specificity': 0.9066667, 'binary_f1_score': 0.86374134}
confusion matrix:
     0    1
0  204   21
1   38  187
new oracle model saved
early stop counter: 1
val acc:0.8345043063163757, best validation acc: 0.835284948348999, corresponding to test acc:                         0.8444444537162781 / 0.8688889145851135
after epoch: 3,now: 2024-07-23 05:31:20.678912,epoch time: 0:01:16.027572,used: 0:03:51.067208,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_05_27_29_seed_1_22779258
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.976237, 'precision': 0.97630334, 'recall': 0.97634435, 'specificity': 0.97634435, 'f1': 0.9762369, 'auroc': 0.99723697, 'binary_precision': 0.98557377, 'binary_recall': 0.96718144, 'binary_specificity': 0.98550725, 'binary_f1_score': 0.976291}
confusion matrix:
      0     1
0  1496    22
1    51  1503
---- Validation: 
scalar performance:
{'acc': 0.8017174, 'precision': 0.82237977, 'recall': 0.799616, 'specificity': 0.799616, 'f1': 0.7976782, 'auroc': 0.89623046, 'binary_precision': 0.9, 'binary_recall': 0.67142856, 'binary_specificity': 0.9278034, 'binary_f1_score': 0.76909095}
confusion matrix:
     0    1
0  604   47
1  207  423
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8333333, 'precision': 0.84259784, 'recall': 0.8333333, 'specificity': 0.8333333, 'f1': 0.83219886, 'auroc': 0.90712106, 'binary_precision': 0.89893615, 'binary_recall': 0.7511111, 'binary_specificity': 0.91555554, 'binary_f1_score': 0.81840193}
confusion matrix:
     0    1
0  206   19
1   56  169
early stop counter: 2
val acc:0.8017174005508423, best validation acc: 0.835284948348999, corresponding to test acc:                         0.8444444537162781 / 0.8688889145851135
after epoch: 4,now: 2024-07-23 05:32:36.169141,epoch time: 0:01:15.490229,used: 0:05:06.557437,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_05_27_29_seed_1_22779258
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.98046875, 'precision': 0.98065203, 'recall': 0.98065203, 'specificity': 0.98065203, 'f1': 0.98046875, 'auroc': 0.9984039, 'binary_precision': 0.9940594, 'binary_recall': 0.9672447, 'binary_specificity': 0.9940594, 'binary_f1_score': 0.98046875}
confusion matrix:
      0     1
0  1506     9
1    51  1506
---- Validation: 
scalar performance:
{'acc': 0.78454334, 'precision': 0.81811965, 'recall': 0.78184843, 'specificity': 0.78184843, 'f1': 0.7775583, 'auroc': 0.8980055, 'binary_precision': 0.9174528, 'binary_recall': 0.6174603, 'binary_specificity': 0.94623655, 'binary_f1_score': 0.73814046}
confusion matrix:
     0    1
0  616   35
1  241  389
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8111111, 'precision': 0.8324468, 'recall': 0.8111111, 'specificity': 0.8111111, 'f1': 0.8080311, 'auroc': 0.9032692, 'binary_precision': 0.9166667, 'binary_recall': 0.6844444, 'binary_specificity': 0.93777776, 'binary_f1_score': 0.783715}
confusion matrix:
     0    1
0  211   14
1   71  154
early stop counter: 3
val acc:0.7845433354377747, best validation acc: 0.835284948348999, corresponding to test acc:                         0.8444444537162781 / 0.8688889145851135
after epoch: 5,now: 2024-07-23 05:33:52.172173,epoch time: 0:01:16.003032,used: 0:06:22.560469,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_05_27_29_seed_1_22779258
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.98339844, 'precision': 0.98339117, 'recall': 0.98346436, 'specificity': 0.98346436, 'f1': 0.98339766, 'auroc': 0.9982976, 'binary_precision': 0.9889467, 'binary_recall': 0.97813505, 'binary_specificity': 0.9887937, 'binary_f1_score': 0.98351115}
confusion matrix:
      0     1
0  1500    17
1    34  1521
---- Validation: 
scalar performance:
{'acc': 0.8196721, 'precision': 0.8360682, 'recall': 0.81784433, 'specificity': 0.81784433, 'f1': 0.8168143, 'auroc': 0.9012362, 'binary_precision': 0.90631366, 'binary_recall': 0.7063492, 'binary_specificity': 0.92933947, 'binary_f1_score': 0.793934}
confusion matrix:
     0    1
0  605   46
1  185  445
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8577778, 'precision': 0.8779658, 'recall': 0.85777783, 'specificity': 0.85777783, 'f1': 0.855853, 'auroc': 0.9150617, 'binary_precision': 0.9653179, 'binary_recall': 0.74222225, 'binary_specificity': 0.97333336, 'binary_f1_score': 0.839196}
confusion matrix:
     0    1
0  219    6
1   58  167
early stop counter: 4
val acc:0.8196721076965332, best validation acc: 0.835284948348999, corresponding to test acc:                         0.8444444537162781 / 0.8688889145851135
after epoch: 6,now: 2024-07-23 05:35:07.571562,epoch time: 0:01:15.399389,used: 0:07:37.959858,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_05_27_29_seed_1_22779258
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.98502606, 'precision': 0.98504627, 'recall': 0.98512524, 'specificity': 0.98512524, 'f1': 0.98502564, 'auroc': 0.99910045, 'binary_precision': 0.99281985, 'binary_recall': 0.9775064, 'binary_specificity': 0.9927441, 'binary_f1_score': 0.98510367}
confusion matrix:
      0     1
0  1505    11
1    35  1521
---- Validation: 
scalar performance:
{'acc': 0.86729115, 'precision': 0.86812854, 'recall': 0.8668971, 'specificity': 0.8668971, 'f1': 0.8670967, 'auroc': 0.91209376, 'binary_precision': 0.8820598, 'binary_recall': 0.8428571, 'binary_specificity': 0.89093703, 'binary_f1_score': 0.862013}
confusion matrix:
     0    1
0  580   71
1   99  531
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.84, 'precision': 0.84002686, 'recall': 0.84000003, 'specificity': 0.84000003, 'f1': 0.8399968, 'auroc': 0.91954565, 'binary_precision': 0.84304935, 'binary_recall': 0.83555555, 'binary_specificity': 0.84444445, 'binary_f1_score': 0.83928573}
confusion matrix:
     0    1
0  190   35
1   37  188
better model found
persisted
after epoch: 7,now: 2024-07-23 05:36:23.219933,epoch time: 0:01:15.648371,used: 0:08:53.608229,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_05_27_29_seed_1_22779258
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9866536, 'precision': 0.98671854, 'recall': 0.9866073, 'specificity': 0.9866073, 'f1': 0.9866502, 'auroc': 0.9993633, 'binary_precision': 0.9833972, 'binary_recall': 0.9903537, 'binary_specificity': 0.9828609, 'binary_f1_score': 0.9868632}
confusion matrix:
      0     1
0  1491    26
1    15  1540
---- Validation: 
scalar performance:
{'acc': 0.84933645, 'precision': 0.8494108, 'recall': 0.8491807, 'specificity': 0.8491807, 'f1': 0.8492538, 'auroc': 0.90484965, 'binary_precision': 0.8518519, 'binary_recall': 0.8396825, 'binary_specificity': 0.85867894, 'binary_f1_score': 0.8457234}
confusion matrix:
     0    1
0  559   92
1  101  529
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8333333, 'precision': 0.83572733, 'recall': 0.8333334, 'specificity': 0.8333334, 'f1': 0.8330357, 'auroc': 0.9193679, 'binary_precision': 0.80737704, 'binary_recall': 0.8755556, 'binary_specificity': 0.7911111, 'binary_f1_score': 0.84008527}
confusion matrix:
     0    1
0  178   47
1   28  197
early stop counter: 1
val acc:0.8493364453315735, best validation acc: 0.8672911524772644, corresponding to test acc:                         0.8399999737739563 / 0.8688889145851135
after epoch: 8,now: 2024-07-23 05:37:38.499122,epoch time: 0:01:15.279189,used: 0:10:08.887418,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_05_27_29_seed_1_22779258
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9827474, 'precision': 0.9830325, 'recall': 0.98296225, 'specificity': 0.98296225, 'f1': 0.9827473, 'auroc': 0.9983276, 'binary_precision': 0.99867374, 'binary_recall': 0.9672447, 'binary_specificity': 0.9986799, 'binary_f1_score': 0.982708}
confusion matrix:
      0     1
0  1513     2
1    51  1506
---- Validation: 
scalar performance:
{'acc': 0.793911, 'precision': 0.82299614, 'recall': 0.79142344, 'specificity': 0.79142344, 'f1': 0.78816366, 'auroc': 0.90663695, 'binary_precision': 0.9159091, 'binary_recall': 0.63968253, 'binary_specificity': 0.94316435, 'binary_f1_score': 0.75327104}
confusion matrix:
     0    1
0  614   37
1  227  403
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8333333, 'precision': 0.8545168, 'recall': 0.8333334, 'specificity': 0.8333334, 'f1': 0.83080584, 'auroc': 0.9056, 'binary_precision': 0.9411765, 'binary_recall': 0.7111111, 'binary_specificity': 0.95555556, 'binary_f1_score': 0.8101266}
confusion matrix:
     0    1
0  215   10
1   65  160
early stop counter: 2
val acc:0.7939109802246094, best validation acc: 0.8672911524772644, corresponding to test acc:                         0.8399999737739563 / 0.8688889145851135
after epoch: 9,now: 2024-07-23 05:38:54.271797,epoch time: 0:01:15.772675,used: 0:11:24.660093,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_05_27_29_seed_1_22779258
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.97298175, 'precision': 0.9738133, 'recall': 0.97324145, 'specificity': 0.97324145, 'f1': 0.9729774, 'auroc': 0.9983233, 'binary_precision': 0.9966216, 'binary_recall': 0.9497746, 'binary_specificity': 0.99670833, 'binary_f1_score': 0.9726344}
confusion matrix:
      0     1
0  1514     5
1    78  1475
---- Validation: 
scalar performance:
{'acc': 0.67447305, 'precision': 0.7825231, 'recall': 0.6693292, 'specificity': 0.6693292, 'f1': 0.6360957, 'auroc': 0.8867457, 'binary_precision': 0.9531915, 'binary_recall': 0.35555556, 'binary_specificity': 0.9831029, 'binary_f1_score': 0.5179191}
confusion matrix:
     0    1
0  640   11
1  406  224
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.74222225, 'precision': 0.80803335, 'recall': 0.74222225, 'specificity': 0.74222225, 'f1': 0.7276768, 'auroc': 0.90008885, 'binary_precision': 0.9504132, 'binary_recall': 0.51111114, 'binary_specificity': 0.97333336, 'binary_f1_score': 0.6647399}
confusion matrix:
     0    1
0  219    6
1  110  115
early stop counter: 3
val acc:0.6744730472564697, best validation acc: 0.8672911524772644, corresponding to test acc:                         0.8399999737739563 / 0.8688889145851135
after epoch: 10,now: 2024-07-23 05:40:09.818173,epoch time: 0:01:15.546376,used: 0:12:40.206469,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_05_27_29_seed_1_22779258
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9892578, 'precision': 0.98926026, 'recall': 0.98925173, 'specificity': 0.98925173, 'f1': 0.9892559, 'auroc': 0.99927294, 'binary_precision': 0.98908156, 'binary_recall': 0.98971725, 'binary_specificity': 0.9887863, 'binary_f1_score': 0.9893993}
confusion matrix:
      0     1
0  1499    17
1    16  1540
---- Validation: 
scalar performance:
{'acc': 0.8665105, 'precision': 0.8739276, 'recall': 0.865361, 'specificity': 0.865361, 'f1': 0.86555487, 'auroc': 0.928135, 'binary_precision': 0.92265195, 'binary_recall': 0.7952381, 'binary_specificity': 0.9354839, 'binary_f1_score': 0.8542199}
confusion matrix:
     0    1
0  609   42
1  129  501
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.86, 'precision': 0.8828782, 'recall': 0.86, 'specificity': 0.86, 'f1': 0.8578769, 'auroc': 0.9398519, 'binary_precision': 0.9764706, 'binary_recall': 0.73777777, 'binary_specificity': 0.9822222, 'binary_f1_score': 0.84050626}
confusion matrix:
     0    1
0  221    4
1   59  166
early stop counter: 4
val acc:0.8665105104446411, best validation acc: 0.8672911524772644, corresponding to test acc:                         0.8399999737739563 / 0.8688889145851135
after epoch: 11,now: 2024-07-23 05:41:25.616946,epoch time: 0:01:15.798773,used: 0:13:56.005242,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_05_27_29_seed_1_22779258
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9847005, 'precision': 0.98489827, 'recall': 0.9846004, 'specificity': 0.9846004, 'f1': 0.98469406, 'auroc': 0.999178, 'binary_precision': 0.97783405, 'binary_recall': 0.99228793, 'binary_specificity': 0.9769129, 'binary_f1_score': 0.98500794}
confusion matrix:
      0     1
0  1481    35
1    12  1544
---- Validation: 
scalar performance:
{'acc': 0.852459, 'precision': 0.85474086, 'recall': 0.8531234, 'specificity': 0.8531234, 'f1': 0.852355, 'auroc': 0.9154537, 'binary_precision': 0.8218978, 'binary_recall': 0.89365077, 'binary_specificity': 0.812596, 'binary_f1_score': 0.8562738}
confusion matrix:
     0    1
0  529  122
1   67  563
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8155556, 'precision': 0.8287037, 'recall': 0.8155556, 'specificity': 0.8155556, 'f1': 0.81369245, 'auroc': 0.9161482, 'binary_precision': 0.76296294, 'binary_recall': 0.91555554, 'binary_specificity': 0.71555555, 'binary_f1_score': 0.8323232}
confusion matrix:
     0    1
0  161   64
1   19  206
early stop counter: 5
val acc:0.8524590134620667, best validation acc: 0.8672911524772644, corresponding to test acc:                         0.8399999737739563 / 0.8688889145851135
after epoch: 12,now: 2024-07-23 05:42:41.763487,epoch time: 0:01:16.146541,used: 0:15:12.151783,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_05_27_29_seed_1_22779258
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9889323, 'precision': 0.9889064, 'recall': 0.988986, 'specificity': 0.988986, 'f1': 0.98893106, 'auroc': 0.9992378, 'binary_precision': 0.9928849, 'binary_recall': 0.9852375, 'binary_specificity': 0.9927345, 'binary_f1_score': 0.9890464}
confusion matrix:
      0     1
0  1503    11
1    23  1535
---- Validation: 
scalar performance:
{'acc': 0.7712724, 'precision': 0.8205731, 'recall': 0.76802355, 'specificity': 0.76802355, 'f1': 0.7606388, 'auroc': 0.911806, 'binary_precision': 0.9422572, 'binary_recall': 0.56984127, 'binary_specificity': 0.96620584, 'binary_f1_score': 0.7101879}
confusion matrix:
     0    1
0  629   22
1  271  359
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8088889, 'precision': 0.8617363, 'recall': 0.8088889, 'specificity': 0.8088889, 'f1': 0.80164427, 'auroc': 0.9301926, 'binary_precision': 1.0, 'binary_recall': 0.61777776, 'binary_specificity': 1.0, 'binary_f1_score': 0.76373625}
confusion matrix:
     0    1
0  225    0
1   86  139
early stop counter: 6
val acc:0.7712724208831787, best validation acc: 0.8672911524772644, corresponding to test acc:                         0.8399999737739563 / 0.8688889145851135
after epoch: 13,now: 2024-07-23 05:43:57.600384,epoch time: 0:01:15.836897,used: 0:16:27.988680,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_05_27_29_seed_1_22779258
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9899089, 'precision': 0.9899208, 'recall': 0.9898952, 'specificity': 0.9898952, 'f1': 0.989907, 'auroc': 0.99939966, 'binary_precision': 0.9890886, 'binary_recall': 0.9909968, 'binary_specificity': 0.9887937, 'binary_f1_score': 0.99004173}
confusion matrix:
      0     1
0  1500    17
1    14  1541
---- Validation: 
scalar performance:
{'acc': 0.86026543, 'precision': 0.8636578, 'recall': 0.85947263, 'specificity': 0.85947263, 'f1': 0.8597183, 'auroc': 0.9164338, 'binary_precision': 0.8949212, 'binary_recall': 0.8111111, 'binary_specificity': 0.9078341, 'binary_f1_score': 0.8509575}
confusion matrix:
     0    1
0  591   60
1  119  511
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.82666665, 'precision': 0.82926834, 'recall': 0.82666665, 'specificity': 0.82666665, 'f1': 0.8263236, 'auroc': 0.90933335, 'binary_precision': 0.8585366, 'binary_recall': 0.7822222, 'binary_specificity': 0.8711111, 'binary_f1_score': 0.8186047}
confusion matrix:
     0    1
0  196   29
1   49  176
early stop counter: 7
val acc:0.8602654337882996, best validation acc: 0.8672911524772644, corresponding to test acc:                         0.8399999737739563 / 0.8688889145851135
after epoch: 14,now: 2024-07-23 05:45:13.249650,epoch time: 0:01:15.649266,used: 0:17:43.637946,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_05_27_29_seed_1_22779258
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9817708, 'precision': 0.98175114, 'recall': 0.9818083, 'specificity': 0.9818083, 'f1': 0.9817693, 'auroc': 0.99904704, 'binary_precision': 0.98511326, 'binary_recall': 0.9787781, 'binary_specificity': 0.9848385, 'binary_f1_score': 0.98193544}
confusion matrix:
      0     1
0  1494    23
1    33  1522
---- Validation: 
scalar performance:
{'acc': 0.8563622, 'precision': 0.8724878, 'recall': 0.8546595, 'specificity': 0.8546595, 'f1': 0.8543383, 'auroc': 0.92899084, 'binary_precision': 0.946, 'binary_recall': 0.75079364, 'binary_specificity': 0.95852536, 'binary_f1_score': 0.8371681}
confusion matrix:
     0    1
0  624   27
1  157  473
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.86444443, 'precision': 0.8782598, 'recall': 0.86444443, 'specificity': 0.86444443, 'f1': 0.8631953, 'auroc': 0.91557527, 'binary_precision': 0.9505494, 'binary_recall': 0.7688889, 'binary_specificity': 0.96, 'binary_f1_score': 0.85012287}
confusion matrix:
     0    1
0  216    9
1   52  173
early stop counter: 8
val acc:0.8563622236251831, best validation acc: 0.8672911524772644, corresponding to test acc:                         0.8399999737739563 / 0.8688889145851135
after epoch: 15,now: 2024-07-23 05:46:28.339075,epoch time: 0:01:15.089425,used: 0:18:58.727371,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_05_27_29_seed_1_22779258
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9902344, 'precision': 0.9902134, 'recall': 0.9902667, 'specificity': 0.9902667, 'f1': 0.9902333, 'auroc': 0.9990661, 'binary_precision': 0.99289405, 'binary_recall': 0.9877892, 'binary_specificity': 0.9927441, 'binary_f1_score': 0.99033505}
confusion matrix:
      0     1
0  1505    11
1    19  1537
---- Validation: 
scalar performance:
{'acc': 0.8579235, 'precision': 0.8609635, 'recall': 0.85716844, 'specificity': 0.85716844, 'f1': 0.8574083, 'auroc': 0.9164777, 'binary_precision': 0.8902439, 'binary_recall': 0.8111111, 'binary_specificity': 0.9032258, 'binary_f1_score': 0.84883714}
confusion matrix:
     0    1
0  588   63
1  119  511
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8622222, 'precision': 0.86639094, 'recall': 0.8622222, 'specificity': 0.8622222, 'f1': 0.86182916, 'auroc': 0.91759014, 'binary_precision': 0.90547264, 'binary_recall': 0.8088889, 'binary_specificity': 0.91555554, 'binary_f1_score': 0.8544601}
confusion matrix:
     0    1
0  206   19
1   43  182
early stop counter: 9
val acc:0.8579235076904297, best validation acc: 0.8672911524772644, corresponding to test acc:                         0.8399999737739563 / 0.8688889145851135
after epoch: 16,now: 2024-07-23 05:47:43.670680,epoch time: 0:01:15.331605,used: 0:20:14.058976,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_05_27_29_seed_1_22779258
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9873047, 'precision': 0.9874016, 'recall': 0.9874357, 'specificity': 0.9874357, 'f1': 0.9873047, 'auroc': 0.99872196, 'binary_precision': 0.99802893, 'binary_recall': 0.9768489, 'binary_specificity': 0.99802244, 'binary_f1_score': 0.9873254}
confusion matrix:
      0     1
0  1514     3
1    36  1519
---- Validation: 
scalar performance:
{'acc': 0.863388, 'precision': 0.8717712, 'recall': 0.8621608, 'specificity': 0.8621608, 'f1': 0.8622974, 'auroc': 0.92363644, 'binary_precision': 0.9236499, 'binary_recall': 0.7873016, 'binary_specificity': 0.93701994, 'binary_f1_score': 0.8500428}
confusion matrix:
     0    1
0  610   41
1  134  496
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.83111113, 'precision': 0.85467935, 'recall': 0.8311111, 'specificity': 0.8311111, 'f1': 0.8282581, 'auroc': 0.9280592, 'binary_precision': 0.9461078, 'binary_recall': 0.7022222, 'binary_specificity': 0.96, 'binary_f1_score': 0.8061225}
confusion matrix:
     0    1
0  216    9
1   67  158
early stop counter: 10
val acc:0.8633880019187927, best validation acc: 0.8672911524772644, corresponding to test acc:                         0.8399999737739563 / 0.8688889145851135
after epoch: 17,now: 2024-07-23 05:48:58.872906,epoch time: 0:01:15.202226,used: 0:21:29.261202,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_05_27_29_seed_1_22779258
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.98307294, 'precision': 0.98311996, 'recall': 0.98318875, 'specificity': 0.98318875, 'f1': 0.98307264, 'auroc': 0.99898934, 'binary_precision': 0.9921466, 'binary_recall': 0.97429305, 'binary_specificity': 0.99208444, 'binary_f1_score': 0.98313874}
confusion matrix:
      0     1
0  1504    12
1    40  1516
---- Validation: 
scalar performance:
{'acc': 0.81030446, 'precision': 0.8336576, 'recall': 0.8081157, 'specificity': 0.8081157, 'f1': 0.80612874, 'auroc': 0.903672, 'binary_precision': 0.91792655, 'binary_recall': 0.67460316, 'binary_specificity': 0.9416283, 'binary_f1_score': 0.7776761}
confusion matrix:
     0    1
0  613   38
1  205  425
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.71555555, 'precision': 0.79733527, 'recall': 0.71555555, 'specificity': 0.71555555, 'f1': 0.6945529, 'auroc': 0.90921485, 'binary_precision': 0.95327103, 'binary_recall': 0.45333335, 'binary_specificity': 0.9777778, 'binary_f1_score': 0.61445785}
confusion matrix:
     0    1
0  220    5
1  123  102
early stop counter: 11
val acc:0.8103044629096985, best validation acc: 0.8672911524772644, corresponding to test acc:                         0.8399999737739563 / 0.8688889145851135
after epoch: 18,now: 2024-07-23 05:50:14.312504,epoch time: 0:01:15.439598,used: 0:22:44.700800,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_05_27_29_seed_1_22779258
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.99316406, 'precision': 0.9931474, 'recall': 0.9932153, 'specificity': 0.9932153, 'f1': 0.9931636, 'auroc': 0.9997338, 'binary_precision': 0.99740595, 'binary_recall': 0.9890675, 'binary_specificity': 0.9973632, 'binary_f1_score': 0.99321926}
confusion matrix:
      0     1
0  1513     4
1    17  1538
---- Validation: 
scalar performance:
{'acc': 0.82591724, 'precision': 0.8525021, 'recall': 0.82365596, 'specificity': 0.82365596, 'f1': 0.82183087, 'auroc': 0.92103237, 'binary_precision': 0.9452954, 'binary_recall': 0.6857143, 'binary_specificity': 0.96159756, 'binary_f1_score': 0.79484826}
confusion matrix:
     0    1
0  626   25
1  198  432
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7822222, 'precision': 0.8279281, 'recall': 0.7822222, 'specificity': 0.7822222, 'f1': 0.77435994, 'auroc': 0.9175309, 'binary_precision': 0.95035464, 'binary_recall': 0.59555554, 'binary_specificity': 0.9688889, 'binary_f1_score': 0.73224044}
confusion matrix:
     0    1
0  218    7
1   91  134
early stop counter: 12
val acc:0.8259172439575195, best validation acc: 0.8672911524772644, corresponding to test acc:                         0.8399999737739563 / 0.8688889145851135
after epoch: 19,now: 2024-07-23 05:51:29.462037,epoch time: 0:01:15.149533,used: 0:23:59.850333,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_05_27_29_seed_1_22779258
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9921875, 'precision': 0.9922073, 'recall': 0.99216723, 'specificity': 0.99216723, 'f1': 0.9921856, 'auroc': 0.99980164, 'binary_precision': 0.99103713, 'binary_recall': 0.99358153, 'binary_specificity': 0.990753, 'binary_f1_score': 0.99230766}
confusion matrix:
      0     1
0  1500    14
1    10  1548
---- Validation: 
scalar performance:
{'acc': 0.81889147, 'precision': 0.84326786, 'recall': 0.81669223, 'specificity': 0.81669223, 'f1': 0.81486136, 'auroc': 0.91994673, 'binary_precision': 0.93073595, 'binary_recall': 0.6825397, 'binary_specificity': 0.9508448, 'binary_f1_score': 0.7875458}
confusion matrix:
     0    1
0  619   32
1  200  430
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.80444443, 'precision': 0.83917606, 'recall': 0.80444443, 'specificity': 0.80444443, 'f1': 0.79930675, 'auroc': 0.9162272, 'binary_precision': 0.9477124, 'binary_recall': 0.64444447, 'binary_specificity': 0.96444446, 'binary_f1_score': 0.7671958}
confusion matrix:
     0    1
0  217    8
1   80  145
early stop counter: 13
val acc:0.8188914656639099, best validation acc: 0.8672911524772644, corresponding to test acc:                         0.8399999737739563 / 0.8688889145851135
after epoch: 20,now: 2024-07-23 05:52:44.585365,epoch time: 0:01:15.123328,used: 0:25:14.973661,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_05_27_29_seed_1_22779258
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9899089, 'precision': 0.989943, 'recall': 0.9900272, 'specificity': 0.9900272, 'f1': 0.9899086, 'auroc': 0.9996104, 'binary_precision': 0.9986928, 'binary_recall': 0.98137444, 'binary_specificity': 0.9986799, 'binary_f1_score': 0.98995787}
confusion matrix:
      0     1
0  1513     2
1    29  1528
---- Validation: 
scalar performance:
{'acc': 0.6284153, 'precision': 0.7469436, 'recall': 0.62263185, 'specificity': 0.62263185, 'f1': 0.5720218, 'auroc': 0.8883842, 'binary_precision': 0.9139785, 'binary_recall': 0.26984128, 'binary_specificity': 0.97542244, 'binary_f1_score': 0.4166667}
confusion matrix:
     0    1
0  635   16
1  460  170
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5933333, 'precision': 0.77573526, 'recall': 0.59333336, 'specificity': 0.59333336, 'f1': 0.5127536, 'auroc': 0.9075358, 'binary_precision': 1.0, 'binary_recall': 0.18666667, 'binary_specificity': 1.0, 'binary_f1_score': 0.31460673}
confusion matrix:
     0   1
0  225   0
1  183  42
early stop counter: 14
val acc:0.6284152865409851, best validation acc: 0.8672911524772644, corresponding to test acc:                         0.8399999737739563 / 0.8688889145851135
after epoch: 21,now: 2024-07-23 05:53:59.862444,epoch time: 0:01:15.277079,used: 0:26:30.250740,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_05_27_29_seed_1_22779258
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.99153644, 'precision': 0.9915643, 'recall': 0.99161017, 'specificity': 0.99161017, 'f1': 0.9915364, 'auroc': 0.9997567, 'binary_precision': 0.9986928, 'binary_recall': 0.9845361, 'binary_specificity': 0.9986842, 'binary_f1_score': 0.9915639}
confusion matrix:
      0     1
0  1518     2
1    24  1528
---- Validation: 
scalar performance:
{'acc': 0.8376269, 'precision': 0.85329056, 'recall': 0.8358935, 'specificity': 0.8358935, 'f1': 0.835277, 'auroc': 0.91836977, 'binary_precision': 0.9236948, 'binary_recall': 0.73015875, 'binary_specificity': 0.9416283, 'binary_f1_score': 0.81560284}
confusion matrix:
     0    1
0  613   38
1  170  460
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.83111113, 'precision': 0.84831166, 'recall': 0.83111113, 'specificity': 0.83111113, 'f1': 0.829, 'auroc': 0.9188148, 'binary_precision': 0.9257143, 'binary_recall': 0.72, 'binary_specificity': 0.94222224, 'binary_f1_score': 0.81000006}
confusion matrix:
     0    1
0  212   13
1   63  162
early stop counter: 15
val acc:0.8376268744468689, best validation acc: 0.8672911524772644, corresponding to test acc:                         0.8399999737739563 / 0.8688889145851135
after epoch: 22,now: 2024-07-23 05:55:14.966965,epoch time: 0:01:15.104521,used: 0:27:45.355261,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_05_27_29_seed_1_22779258
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.9951172, 'precision': 0.99510574, 'recall': 0.9951291, 'specificity': 0.9951291, 'f1': 0.9951165, 'auroc': 0.9998592, 'binary_precision': 0.9961365, 'binary_recall': 0.99421597, 'binary_specificity': 0.9960422, 'binary_f1_score': 0.99517536}
confusion matrix:
      0     1
0  1510     6
1     9  1547
---- Validation: 
scalar performance:
{'acc': 0.82435596, 'precision': 0.8415249, 'recall': 0.8225038, 'specificity': 0.8225038, 'f1': 0.82150126, 'auroc': 0.9083779, 'binary_precision': 0.9141104, 'binary_recall': 0.7095238, 'binary_specificity': 0.9354839, 'binary_f1_score': 0.7989276}
confusion matrix:
     0    1
0  609   42
1  183  447
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.83555555, 'precision': 0.8515552, 'recall': 0.83555555, 'specificity': 0.83555555, 'f1': 0.833663, 'auroc': 0.9152, 'binary_precision': 0.92655367, 'binary_recall': 0.72888887, 'binary_specificity': 0.94222224, 'binary_f1_score': 0.8159204}
confusion matrix:
     0    1
0  212   13
1   61  164
early stop counter: 16
val acc:0.824355959892273, best validation acc: 0.8672911524772644, corresponding to test acc:                         0.8399999737739563 / 0.8688889145851135
after epoch: 23,now: 2024-07-23 05:56:30.236253,epoch time: 0:01:15.269288,used: 0:29:00.624549,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_05_27_29_seed_1_22779258
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.98860675, 'precision': 0.98871696, 'recall': 0.9887532, 'specificity': 0.9887532, 'f1': 0.98860675, 'auroc': 0.99988043, 'binary_precision': 1.0, 'binary_recall': 0.9775064, 'binary_specificity': 1.0, 'binary_f1_score': 0.9886253}
confusion matrix:
      0     1
0  1516     0
1    35  1521
---- Validation: 
scalar performance:
{'acc': 0.69476974, 'precision': 0.78334856, 'recall': 0.6901178, 'specificity': 0.6901178, 'f1': 0.6656574, 'auroc': 0.9130715, 'binary_precision': 0.93772894, 'binary_recall': 0.4063492, 'binary_specificity': 0.9738863, 'binary_f1_score': 0.5669989}
confusion matrix:
     0    1
0  634   17
1  374  256
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.66444445, 'precision': 0.78691065, 'recall': 0.66444445, 'specificity': 0.66444445, 'f1': 0.6243594, 'auroc': 0.90190613, 'binary_precision': 0.974359, 'binary_recall': 0.33777776, 'binary_specificity': 0.9911111, 'binary_f1_score': 0.50165015}
confusion matrix:
     0   1
0  223   2
1  149  76
early stop counter: 17
val acc:0.6947697401046753, best validation acc: 0.8672911524772644, corresponding to test acc:                         0.8399999737739563 / 0.8688889145851135
after epoch: 24,now: 2024-07-23 05:57:45.575247,epoch time: 0:01:15.338994,used: 0:30:15.963543,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_05_27_29_seed_1_22779258
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.9824219, 'precision': 0.9827987, 'recall': 0.9826071, 'specificity': 0.9826071, 'f1': 0.9824213, 'auroc': 0.99967104, 'binary_precision': 0.9993338, 'binary_recall': 0.9658725, 'binary_specificity': 0.99934167, 'binary_f1_score': 0.9823182}
confusion matrix:
      0     1
0  1518     1
1    53  1500
---- Validation: 
scalar performance:
{'acc': 0.65261513, 'precision': 0.76535714, 'recall': 0.64718384, 'specificity': 0.64718384, 'f1': 0.606626, 'auroc': 0.90025175, 'binary_precision': 0.9342723, 'binary_recall': 0.31587303, 'binary_specificity': 0.97849464, 'binary_f1_score': 0.47212338}
confusion matrix:
     0    1
0  637   14
1  431  199
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.62222224, 'precision': 0.76075685, 'recall': 0.62222224, 'specificity': 0.62222224, 'f1': 0.56436074, 'auroc': 0.8773531, 'binary_precision': 0.9508197, 'binary_recall': 0.25777778, 'binary_specificity': 0.9866667, 'binary_f1_score': 0.4055944}
confusion matrix:
     0   1
0  222   3
1  167  58
early stop counter: 18
val acc:0.6526151299476624, best validation acc: 0.8672911524772644, corresponding to test acc:                         0.8399999737739563 / 0.8688889145851135
after epoch: 25,now: 2024-07-23 05:59:00.877430,epoch time: 0:01:15.302183,used: 0:31:31.265726,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_05_27_29_seed_1_22779258
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9847005, 'precision': 0.98494416, 'recall': 0.98487943, 'specificity': 0.98487943, 'f1': 0.9847005, 'auroc': 0.9990826, 'binary_precision': 0.99933773, 'binary_recall': 0.97041804, 'binary_specificity': 0.99934083, 'binary_f1_score': 0.98466563}
confusion matrix:
      0     1
0  1516     1
1    46  1509
---- Validation: 
scalar performance:
{'acc': 0.67291176, 'precision': 0.7729548, 'recall': 0.6678699, 'specificity': 0.6678699, 'f1': 0.635985, 'auroc': 0.8766043, 'binary_precision': 0.93415636, 'binary_recall': 0.36031747, 'binary_specificity': 0.97542244, 'binary_f1_score': 0.5200458}
confusion matrix:
     0    1
0  635   16
1  403  227
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5733333, 'precision': 0.7316115, 'recall': 0.5733333, 'specificity': 0.5733333, 'f1': 0.48542026, 'auroc': 0.90449387, 'binary_precision': 0.9230769, 'binary_recall': 0.16, 'binary_specificity': 0.9866667, 'binary_f1_score': 0.27272725}
confusion matrix:
     0   1
0  222   3
1  189  36
early stop counter: 19
val acc:0.6729117631912231, best validation acc: 0.8672911524772644, corresponding to test acc:                         0.8399999737739563 / 0.8688889145851135
after epoch: 26,now: 2024-07-23 06:00:16.507189,epoch time: 0:01:15.629759,used: 0:32:46.895485,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_05_27_29_seed_1_22779258
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.9905599, 'precision': 0.9905679, 'recall': 0.99062717, 'specificity': 0.99062717, 'f1': 0.9905597, 'auroc': 0.9997537, 'binary_precision': 0.9967405, 'binary_recall': 0.98454607, 'binary_specificity': 0.99670833, 'binary_f1_score': 0.9906058}
confusion matrix:
      0     1
0  1514     5
1    24  1529
---- Validation: 
scalar performance:
{'acc': 0.8384075, 'precision': 0.86155933, 'recall': 0.83632874, 'specificity': 0.83632874, 'f1': 0.8351527, 'auroc': 0.933921, 'binary_precision': 0.9490446, 'binary_recall': 0.7095238, 'binary_specificity': 0.96313363, 'binary_f1_score': 0.81198907}
confusion matrix:
     0    1
0  627   24
1  183  447
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.79555553, 'precision': 0.8489307, 'recall': 0.7955556, 'specificity': 0.7955556, 'f1': 0.78742635, 'auroc': 0.9282568, 'binary_precision': 0.98540145, 'binary_recall': 0.6, 'binary_specificity': 0.9911111, 'binary_f1_score': 0.74585634}
confusion matrix:
     0    1
0  223    2
1   90  135
early stop counter: 20
val acc:0.8384075164794922, best validation acc: 0.8672911524772644, corresponding to test acc:                         0.8399999737739563 / 0.8688889145851135
after epoch: 27,now: 2024-07-23 06:01:31.653191,epoch time: 0:01:15.146002,used: 0:34:02.041487,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_05_27_29_seed_1_22779258
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.9951172, 'precision': 0.9951544, 'recall': 0.9950882, 'specificity': 0.9950882, 'f1': 0.9951161, 'auroc': 0.9998936, 'binary_precision': 0.9929578, 'binary_recall': 0.99742764, 'binary_specificity': 0.99274886, 'binary_f1_score': 0.9951877}
confusion matrix:
      0     1
0  1506    11
1     4  1551
---- Validation: 
scalar performance:
{'acc': 0.8430913, 'precision': 0.8564327, 'recall': 0.8415003, 'specificity': 0.8415003, 'f1': 0.8411393, 'auroc': 0.92074466, 'binary_precision': 0.92141455, 'binary_recall': 0.74444443, 'binary_specificity': 0.9385561, 'binary_f1_score': 0.8235294}
confusion matrix:
     0    1
0  611   40
1  161  469
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.82666665, 'precision': 0.84091616, 'recall': 0.8266667, 'specificity': 0.8266667, 'f1': 0.8248364, 'auroc': 0.89497286, 'binary_precision': 0.91061455, 'binary_recall': 0.72444445, 'binary_specificity': 0.9288889, 'binary_f1_score': 0.8069307}
confusion matrix:
     0    1
0  209   16
1   62  163
early stop counter: 21
val acc:0.8430913090705872, best validation acc: 0.8672911524772644, corresponding to test acc:                         0.8399999737739563 / 0.8688889145851135
after epoch: 28,now: 2024-07-23 06:02:46.952969,epoch time: 0:01:15.299778,used: 0:35:17.341265,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_05_27_29_seed_1_22779258
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.98567706, 'precision': 0.9858873, 'recall': 0.9858354, 'specificity': 0.9858354, 'f1': 0.985677, 'auroc': 0.99984103, 'binary_precision': 0.9993386, 'binary_recall': 0.9723295, 'binary_specificity': 0.99934125, 'binary_f1_score': 0.98564905}
confusion matrix:
      0     1
0  1517     1
1    43  1511
---- Validation: 
scalar performance:
{'acc': 0.6713505, 'precision': 0.78667295, 'recall': 0.66607785, 'specificity': 0.66607785, 'f1': 0.6304854, 'auroc': 0.90881306, 'binary_precision': 0.96444446, 'binary_recall': 0.34444445, 'binary_specificity': 0.9877112, 'binary_f1_score': 0.50760233}
confusion matrix:
     0    1
0  643    8
1  413  217
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6111111, 'precision': 0.721946, 'recall': 0.6111111, 'specificity': 0.6111111, 'f1': 0.55563456, 'auroc': 0.85392594, 'binary_precision': 0.8787879, 'binary_recall': 0.25777778, 'binary_specificity': 0.96444446, 'binary_f1_score': 0.3986254}
confusion matrix:
     0   1
0  217   8
1  167  58
early stop counter: 22
val acc:0.6713504791259766, best validation acc: 0.8672911524772644, corresponding to test acc:                         0.8399999737739563 / 0.8688889145851135
after epoch: 29,now: 2024-07-23 06:04:01.995693,epoch time: 0:01:15.042724,used: 0:36:32.383989,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_05_27_29_seed_1_22779258
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.9954427, 'precision': 0.9954256, 'recall': 0.99547255, 'specificity': 0.99547255, 'f1': 0.9954423, 'auroc': 0.9998766, 'binary_precision': 0.9980595, 'binary_recall': 0.9929215, 'binary_specificity': 0.9980237, 'binary_f1_score': 0.9954838}
confusion matrix:
      0     1
0  1515     3
1    11  1543
---- Validation: 
scalar performance:
{'acc': 0.78688526, 'precision': 0.83537614, 'recall': 0.78374296, 'specificity': 0.78374296, 'f1': 0.7775811, 'auroc': 0.9252932, 'binary_precision': 0.9588689, 'binary_recall': 0.5920635, 'binary_specificity': 0.97542244, 'binary_f1_score': 0.7320903}
confusion matrix:
     0    1
0  635   16
1  257  373
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6288889, 'precision': 0.7869898, 'recall': 0.6288889, 'specificity': 0.6288889, 'f1': 0.56961477, 'auroc': 0.9160888, 'binary_precision': 1.0, 'binary_recall': 0.25777778, 'binary_specificity': 1.0, 'binary_f1_score': 0.409894}
confusion matrix:
     0   1
0  225   0
1  167  58
early stop counter: 23
val acc:0.7868852615356445, best validation acc: 0.8672911524772644, corresponding to test acc:                         0.8399999737739563 / 0.8688889145851135
after epoch: 30,now: 2024-07-23 06:05:17.151280,epoch time: 0:01:15.155587,used: 0:37:47.539576,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_05_27_29_seed_1_22779258
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 0:37:47.539576 at 2024-07-23 06:05:17.151280
persisted model performance metric: 

scalar performance:
{'acc': 0.84, 'precision': 0.84002686, 'recall': 0.84000003, 'specificity': 0.84000003, 'f1': 0.8399968, 'auroc': 0.91954565, 'binary_precision': 0.84304935, 'binary_recall': 0.83555555, 'binary_specificity': 0.84444445, 'binary_f1_score': 0.83928573}
confusion matrix:
     0    1
0  190   35
1   37  188
oracle model performance metric: 

scalar performance:
{'acc': 0.8688889, 'precision': 0.87100685, 'recall': 0.8688889, 'specificity': 0.8688889, 'f1': 0.8687015, 'auroc': 0.9279605, 'binary_precision': 0.89903843, 'binary_recall': 0.83111113, 'binary_specificity': 0.9066667, 'binary_f1_score': 0.86374134}
confusion matrix:
     0    1
0  204   21
1   38  187
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_dial_lr1e5_bs32_nofreeze_2024-07-23_01-16-41/rule_results/1.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_dial_lr1e5_bs32_nofreeze_2024-07-23_01-16-41/confusion_matrix/1.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 453153 KiB |  26075 MiB | 145141 GiB | 145141 GiB |
|       from large pool | 412597 KiB |  26030 MiB | 144234 GiB | 144234 GiB |
|       from small pool |  40556 KiB |     60 MiB |    906 GiB |    906 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 453153 KiB |  26075 MiB | 145141 GiB | 145141 GiB |
|       from large pool | 412597 KiB |  26030 MiB | 144234 GiB | 144234 GiB |
|       from small pool |  40556 KiB |     60 MiB |    906 GiB |    906 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 447481 KiB |  26071 MiB | 145115 GiB | 145115 GiB |
|       from large pool | 407075 KiB |  26026 MiB | 144210 GiB | 144210 GiB |
|       from small pool |  40406 KiB |     60 MiB |    905 GiB |    905 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  27768 MiB |  27768 MiB |  54300 MiB |  26532 MiB |
|       from large pool |  27696 MiB |  27696 MiB |  54218 MiB |  26522 MiB |
|       from small pool |     72 MiB |     72 MiB |     82 MiB |     10 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 738782 KiB |   1678 MiB |  64538 GiB |  64538 GiB |
|       from large pool | 721995 KiB |   1668 MiB |  63625 GiB |  63625 GiB |
|       from small pool |  16787 KiB |     37 MiB |    912 GiB |    912 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    1226    |    2570    |   13121 K  |   13119 K  |
|       from large pool |     187    |    1413    |    6645 K  |    6645 K  |
|       from small pool |    1039    |    1335    |    6475 K  |    6474 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    1226    |    2570    |   13121 K  |   13119 K  |
|       from large pool |     187    |    1413    |    6645 K  |    6645 K  |
|       from small pool |    1039    |    1335    |    6475 K  |    6474 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     835    |     835    |    1601    |     766    |
|       from large pool |     799    |     800    |    1560    |     761    |
|       from small pool |      36    |      36    |      41    |       5    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     104    |     852    |    9554 K  |    9554 K  |
|       from large pool |      40    |     801    |    5873 K  |    5873 K  |
|       from small pool |      64    |     146    |    3680 K  |    3680 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  26075 MiB | 145141 GiB | 145141 GiB |
|       from large pool |  16640 KiB |  26030 MiB | 144234 GiB | 144234 GiB |
|       from small pool |      0 KiB |     60 MiB |    906 GiB |    906 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  26075 MiB | 145141 GiB | 145141 GiB |
|       from large pool |  16640 KiB |  26030 MiB | 144234 GiB | 144234 GiB |
|       from small pool |      0 KiB |     60 MiB |    906 GiB |    906 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  26071 MiB | 145115 GiB | 145115 GiB |
|       from large pool |  16640 KiB |  26026 MiB | 144210 GiB | 144210 GiB |
|       from small pool |      0 KiB |     60 MiB |    905 GiB |    905 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1164 MiB |  27768 MiB |  54300 MiB |  53136 MiB |
|       from large pool |   1108 MiB |  27696 MiB |  54218 MiB |  53110 MiB |
|       from small pool |     56 MiB |     72 MiB |     82 MiB |     26 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |   3840 KiB |   1678 MiB |  64539 GiB |  64539 GiB |
|       from large pool |   3840 KiB |   1668 MiB |  63626 GiB |  63626 GiB |
|       from small pool |      0 KiB |     37 MiB |    913 GiB |    913 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    2570    |   13121 K  |   13121 K  |
|       from large pool |       2    |    1413    |    6645 K  |    6645 K  |
|       from small pool |       0    |    1335    |    6475 K  |    6475 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    2570    |   13121 K  |   13121 K  |
|       from large pool |       2    |    1413    |    6645 K  |    6645 K  |
|       from small pool |       0    |    1335    |    6475 K  |    6475 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      69    |     835    |    1601    |    1532    |
|       from large pool |      41    |     800    |    1560    |    1519    |
|       from small pool |      28    |      36    |      41    |      13    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       1    |     852    |    9554 K  |    9554 K  |
|       from large pool |       1    |     801    |    5873 K  |    5873 K  |
|       from small pool |       0    |     146    |    3680 K  |    3680 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  26075 MiB | 145141 GiB | 145141 GiB |
|       from large pool |  16640 KiB |  26030 MiB | 144234 GiB | 144234 GiB |
|       from small pool |      0 KiB |     60 MiB |    906 GiB |    906 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  26075 MiB | 145141 GiB | 145141 GiB |
|       from large pool |  16640 KiB |  26030 MiB | 144234 GiB | 144234 GiB |
|       from small pool |      0 KiB |     60 MiB |    906 GiB |    906 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  26071 MiB | 145115 GiB | 145115 GiB |
|       from large pool |  16640 KiB |  26026 MiB | 144210 GiB | 144210 GiB |
|       from small pool |      0 KiB |     60 MiB |    905 GiB |    905 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1164 MiB |  27768 MiB |  54300 MiB |  53136 MiB |
|       from large pool |   1108 MiB |  27696 MiB |  54218 MiB |  53110 MiB |
|       from small pool |     56 MiB |     72 MiB |     82 MiB |     26 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |   3840 KiB |   1678 MiB |  64539 GiB |  64539 GiB |
|       from large pool |   3840 KiB |   1668 MiB |  63626 GiB |  63626 GiB |
|       from small pool |      0 KiB |     37 MiB |    913 GiB |    913 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    2570    |   13121 K  |   13121 K  |
|       from large pool |       2    |    1413    |    6645 K  |    6645 K  |
|       from small pool |       0    |    1335    |    6475 K  |    6475 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    2570    |   13121 K  |   13121 K  |
|       from large pool |       2    |    1413    |    6645 K  |    6645 K  |
|       from small pool |       0    |    1335    |    6475 K  |    6475 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      69    |     835    |    1601    |    1532    |
|       from large pool |      41    |     800    |    1560    |    1519    |
|       from small pool |      28    |      36    |      41    |      13    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       1    |     852    |    9554 K  |    9554 K  |
|       from large pool |       1    |     801    |    5873 K  |    5873 K  |
|       from small pool |       0    |     146    |    3680 K  |    3680 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'888c1ef2'
model name: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_06_06_29_seed_2_22779258

 Experiment start at: 2024-07-23 06:06:29.693876
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
before training, model accuracy: 0.41203704476356506
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9282895, 'precision': 0.9283804, 'recall': 0.9282336, 'specificity': 0.9282336, 'f1': 0.9282744, 'auroc': 0.9754956, 'binary_precision': 0.92392004, 'binary_recall': 0.93476844, 'binary_specificity': 0.92169875, 'binary_f1_score': 0.9293126}
confusion matrix:
      0     1
0  1389   118
1   100  1433
---- Validation: 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
scalar performance:
{'acc': 0.81533647, 'precision': 0.81565905, 'recall': 0.815789, 'specificity': 0.815789, 'f1': 0.8153325, 'auroc': 0.8931726, 'binary_precision': 0.7969231, 'binary_recall': 0.8327974, 'binary_specificity': 0.7987805, 'binary_f1_score': 0.81446546}
confusion matrix:
     0    1
0  524  132
1  104  518
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8194444, 'precision': 0.8241409, 'recall': 0.8194444, 'specificity': 0.8194444, 'f1': 0.81878805, 'auroc': 0.9062286, 'binary_precision': 0.78512394, 'binary_recall': 0.8796296, 'binary_specificity': 0.7592593, 'binary_f1_score': 0.82969433}
confusion matrix:
     0    1
0  164   52
1   26  190
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-23 06:07:45.368007,epoch time: 0:01:15.674131,used: 0:01:15.674131,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_06_06_29_seed_2_22779258
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.93519735, 'precision': 0.9401202, 'recall': 0.9356979, 'specificity': 0.9356979, 'f1': 0.93506163, 'auroc': 0.98381746, 'binary_precision': 0.9890271, 'binary_recall': 0.88135594, 'binary_specificity': 0.9900398, 'binary_f1_score': 0.9320924}
confusion matrix:
      0     1
0  1491    15
1   182  1352
---- Validation: 
scalar performance:
{'acc': 0.81377155, 'precision': 0.8304515, 'recall': 0.8107232, 'specificity': 0.8107232, 'f1': 0.8102542, 'auroc': 0.90395606, 'binary_precision': 0.8983402, 'binary_recall': 0.6961415, 'binary_specificity': 0.9253049, 'binary_f1_score': 0.78442025}
confusion matrix:
     0    1
0  607   49
1  189  433
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8518519, 'precision': 0.85625, 'recall': 0.8518518, 'specificity': 0.8518518, 'f1': 0.85139316, 'auroc': 0.91238, 'binary_precision': 0.8958333, 'binary_recall': 0.7962963, 'binary_specificity': 0.9074074, 'binary_f1_score': 0.84313726}
confusion matrix:
     0    1
0  196   20
1   44  172
new oracle model saved
early stop counter: 1
val acc:0.8137715458869934, best validation acc: 0.8153364658355713, corresponding to test acc:                         0.8194444179534912 / 0.8518518805503845
after epoch: 2,now: 2024-07-23 06:08:57.651536,epoch time: 0:01:12.283529,used: 0:02:27.957660,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_06_06_29_seed_2_22779258
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.96348685, 'precision': 0.96350837, 'recall': 0.9635254, 'specificity': 0.9635254, 'f1': 0.9634868, 'auroc': 0.9934082, 'binary_precision': 0.9689564, 'binary_recall': 0.95819724, 'binary_specificity': 0.96885353, 'binary_f1_score': 0.9635468}
confusion matrix:
      0     1
0  1462    47
1    64  1467
---- Validation: 
scalar performance:
{'acc': 0.8176839, 'precision': 0.81756115, 'recall': 0.8175339, 'specificity': 0.8175339, 'f1': 0.8175471, 'auroc': 0.8896533, 'binary_precision': 0.8132045, 'binary_recall': 0.8118971, 'binary_specificity': 0.8231707, 'binary_f1_score': 0.8125503}
confusion matrix:
     0    1
0  540  116
1  117  505
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8078704, 'precision': 0.8205749, 'recall': 0.8078704, 'specificity': 0.8078704, 'f1': 0.8059478, 'auroc': 0.9150591, 'binary_precision': 0.7567568, 'binary_recall': 0.9074074, 'binary_specificity': 0.7083333, 'binary_f1_score': 0.82526314}
confusion matrix:
     0    1
0  153   63
1   20  196
better model found
persisted
after epoch: 3,now: 2024-07-23 06:10:10.110359,epoch time: 0:01:12.458823,used: 0:03:40.416483,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_06_06_29_seed_2_22779258
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.98256576, 'precision': 0.9827143, 'recall': 0.9826777, 'specificity': 0.9826777, 'f1': 0.98256576, 'auroc': 0.99815905, 'binary_precision': 0.994, 'binary_recall': 0.97133553, 'binary_specificity': 0.9940199, 'binary_f1_score': 0.98253703}
confusion matrix:
      0     1
0  1496     9
1    44  1491
---- Validation: 
scalar performance:
{'acc': 0.7918623, 'precision': 0.8105413, 'recall': 0.7885068, 'specificity': 0.7885068, 'f1': 0.7872586, 'auroc': 0.8766812, 'binary_precision': 0.8803419, 'binary_recall': 0.66237944, 'binary_specificity': 0.91463417, 'binary_f1_score': 0.7559633}
confusion matrix:
     0    1
0  600   56
1  210  412
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8240741, 'precision': 0.82418525, 'recall': 0.82407403, 'specificity': 0.82407403, 'f1': 0.82405895, 'auroc': 0.90974367, 'binary_precision': 0.8301887, 'binary_recall': 0.8148148, 'binary_specificity': 0.8333333, 'binary_f1_score': 0.82242984}
confusion matrix:
     0    1
0  180   36
1   40  176
early stop counter: 1
val acc:0.7918623089790344, best validation acc: 0.8176838755607605, corresponding to test acc:                         0.8078703880310059 / 0.8518518805503845
after epoch: 4,now: 2024-07-23 06:11:22.342794,epoch time: 0:01:12.232435,used: 0:04:52.648918,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_06_06_29_seed_2_22779258
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9753289, 'precision': 0.97604537, 'recall': 0.97549623, 'specificity': 0.97549623, 'f1': 0.97532445, 'auroc': 0.9977189, 'binary_precision': 0.9965917, 'binary_recall': 0.9543081, 'binary_specificity': 0.9966844, 'binary_f1_score': 0.9749917}
confusion matrix:
      0     1
0  1503     5
1    70  1462
---- Validation: 
scalar performance:
{'acc': 0.67527384, 'precision': 0.74225366, 'recall': 0.6680236, 'specificity': 0.6680236, 'f1': 0.64539, 'auroc': 0.82655525, 'binary_precision': 0.86315787, 'binary_recall': 0.3954984, 'binary_specificity': 0.9405488, 'binary_f1_score': 0.5424476}
confusion matrix:
     0    1
0  617   39
1  376  246
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7962963, 'precision': 0.7969327, 'recall': 0.79629624, 'specificity': 0.79629624, 'f1': 0.7961871, 'auroc': 0.86788404, 'binary_precision': 0.78318584, 'binary_recall': 0.8194444, 'binary_specificity': 0.7731481, 'binary_f1_score': 0.800905}
confusion matrix:
     0    1
0  167   49
1   39  177
early stop counter: 2
val acc:0.6752738356590271, best validation acc: 0.8176838755607605, corresponding to test acc:                         0.8078703880310059 / 0.8518518805503845
after epoch: 5,now: 2024-07-23 06:12:34.316261,epoch time: 0:01:11.973467,used: 0:06:04.622385,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_06_06_29_seed_2_22779258
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9697368, 'precision': 0.97106224, 'recall': 0.96994, 'specificity': 0.96994, 'f1': 0.96972346, 'auroc': 0.99839497, 'binary_precision': 0.99792385, 'binary_recall': 0.94186807, 'binary_specificity': 0.99801195, 'binary_f1_score': 0.96908605}
confusion matrix:
      0     1
0  1506     3
1    89  1442
---- Validation: 
scalar performance:
{'acc': 0.6682316, 'precision': 0.77056086, 'recall': 0.65983063, 'specificity': 0.65983063, 'f1': 0.6267606, 'auroc': 0.8796884, 'binary_precision': 0.93043476, 'binary_recall': 0.34405145, 'binary_specificity': 0.9756098, 'binary_f1_score': 0.50234747}
confusion matrix:
     0    1
0  640   16
1  408  214
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7962963, 'precision': 0.81764704, 'recall': 0.7962963, 'specificity': 0.7962963, 'f1': 0.79281485, 'auroc': 0.8814086, 'binary_precision': 0.9, 'binary_recall': 0.6666667, 'binary_specificity': 0.9259259, 'binary_f1_score': 0.76595753}
confusion matrix:
     0    1
0  200   16
1   72  144
early stop counter: 3
val acc:0.6682316064834595, best validation acc: 0.8176838755607605, corresponding to test acc:                         0.8078703880310059 / 0.8518518805503845
after epoch: 6,now: 2024-07-23 06:13:46.735505,epoch time: 0:01:12.419244,used: 0:07:17.041629,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_06_06_29_seed_2_22779258
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.97302634, 'precision': 0.97359943, 'recall': 0.97291064, 'specificity': 0.97291064, 'f1': 0.97301203, 'auroc': 0.9980396, 'binary_precision': 0.9588347, 'binary_recall': 0.98889613, 'binary_specificity': 0.9569251, 'binary_f1_score': 0.97363347}
confusion matrix:
      0     1
0  1444    65
1    17  1514
---- Validation: 
scalar performance:
{'acc': 0.8435055, 'precision': 0.84481937, 'recall': 0.8443529, 'specificity': 0.8443529, 'f1': 0.8434917, 'auroc': 0.91278374, 'binary_precision': 0.81586826, 'binary_recall': 0.8762058, 'binary_specificity': 0.8125, 'binary_f1_score': 0.8449612}
confusion matrix:
     0    1
0  533  123
1   77  545
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.75, 'precision': 0.79709625, 'recall': 0.75, 'specificity': 0.75, 'f1': 0.73968357, 'auroc': 0.9226252, 'binary_precision': 0.678808, 'binary_recall': 0.9490741, 'binary_specificity': 0.5509259, 'binary_f1_score': 0.7915059}
confusion matrix:
     0    1
0  119   97
1   11  205
better model found
persisted
after epoch: 7,now: 2024-07-23 06:14:58.905784,epoch time: 0:01:12.170279,used: 0:08:29.211908,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_06_06_29_seed_2_22779258
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.97335523, 'precision': 0.97419477, 'recall': 0.97356814, 'specificity': 0.97356814, 'f1': 0.9733499, 'auroc': 0.99839103, 'binary_precision': 0.9965824, 'binary_recall': 0.9504563, 'binary_specificity': 0.99667996, 'binary_f1_score': 0.97297305}
confusion matrix:
      0     1
0  1501     5
1    76  1458
---- Validation: 
scalar performance:
{'acc': 0.74178404, 'precision': 0.79441816, 'recall': 0.73601824, 'specificity': 0.73601824, 'f1': 0.7265122, 'auroc': 0.88126856, 'binary_precision': 0.9124294, 'binary_recall': 0.5192926, 'binary_specificity': 0.9527439, 'binary_f1_score': 0.66188526}
confusion matrix:
     0    1
0  625   31
1  299  323
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8171296, 'precision': 0.822951, 'recall': 0.8171296, 'specificity': 0.8171296, 'f1': 0.8163018, 'auroc': 0.89621913, 'binary_precision': 0.8663102, 'binary_recall': 0.75, 'binary_specificity': 0.8842593, 'binary_f1_score': 0.8039703}
confusion matrix:
     0    1
0  191   25
1   54  162
early stop counter: 1
val acc:0.7417840361595154, best validation acc: 0.8435055017471313, corresponding to test acc:                         0.75 / 0.8518518805503845
after epoch: 8,now: 2024-07-23 06:16:11.043799,epoch time: 0:01:12.138015,used: 0:09:41.349923,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_06_06_29_seed_2_22779258
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9832237, 'precision': 0.9834013, 'recall': 0.9833061, 'specificity': 0.9833061, 'f1': 0.9832234, 'auroc': 0.99853563, 'binary_precision': 0.9946524, 'binary_recall': 0.97191375, 'binary_specificity': 0.99469846, 'binary_f1_score': 0.9831517}
confusion matrix:
      0     1
0  1501     8
1    43  1488
---- Validation: 
scalar performance:
{'acc': 0.8325509, 'precision': 0.8499126, 'recall': 0.8295575, 'specificity': 0.8295575, 'f1': 0.8294619, 'auroc': 0.9065416, 'binary_precision': 0.9214876, 'binary_recall': 0.7170418, 'binary_specificity': 0.94207317, 'binary_f1_score': 0.80651}
confusion matrix:
     0    1
0  618   38
1  176  446
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8263889, 'precision': 0.8315697, 'recall': 0.8263889, 'specificity': 0.8263889, 'f1': 0.8257081, 'auroc': 0.8998629, 'binary_precision': 0.8730159, 'binary_recall': 0.7638889, 'binary_specificity': 0.8888889, 'binary_f1_score': 0.81481487}
confusion matrix:
     0    1
0  192   24
1   51  165
early stop counter: 2
val acc:0.8325508832931519, best validation acc: 0.8435055017471313, corresponding to test acc:                         0.75 / 0.8518518805503845
after epoch: 9,now: 2024-07-23 06:17:23.092523,epoch time: 0:01:12.048724,used: 0:10:53.398647,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_06_06_29_seed_2_22779258
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9779605, 'precision': 0.9783666, 'recall': 0.9778578, 'specificity': 0.9778578, 'f1': 0.97795105, 'auroc': 0.9989568, 'binary_precision': 0.96626353, 'binary_recall': 0.9908616, 'binary_specificity': 0.9648541, 'binary_f1_score': 0.9784079}
confusion matrix:
      0     1
0  1455    53
1    14  1518
---- Validation: 
scalar performance:
{'acc': 0.8513302, 'precision': 0.85402167, 'recall': 0.85014164, 'specificity': 0.85014164, 'f1': 0.8506539, 'auroc': 0.9040173, 'binary_precision': 0.8789474, 'binary_recall': 0.80546623, 'binary_specificity': 0.89481705, 'binary_f1_score': 0.840604}
confusion matrix:
     0    1
0  587   69
1  121  501
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8032407, 'precision': 0.8096181, 'recall': 0.8032408, 'specificity': 0.8032408, 'f1': 0.8022224, 'auroc': 0.91105103, 'binary_precision': 0.7651822, 'binary_recall': 0.875, 'binary_specificity': 0.7314815, 'binary_f1_score': 0.8164147}
confusion matrix:
     0    1
0  158   58
1   27  189
better model found
persisted
after epoch: 10,now: 2024-07-23 06:18:35.292991,epoch time: 0:01:12.200468,used: 0:12:05.599115,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_06_06_29_seed_2_22779258
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.98717105, 'precision': 0.9871893, 'recall': 0.98721445, 'specificity': 0.98721445, 'f1': 0.98717093, 'auroc': 0.99904126, 'binary_precision': 0.99273926, 'binary_recall': 0.98172325, 'binary_specificity': 0.9927056, 'binary_f1_score': 0.9872005}
confusion matrix:
      0     1
0  1497    11
1    28  1504
---- Validation: 
scalar performance:
{'acc': 0.80516434, 'precision': 0.84179765, 'recall': 0.8007558, 'specificity': 0.8007558, 'f1': 0.79810333, 'auroc': 0.9060221, 'binary_precision': 0.9472422, 'binary_recall': 0.6350482, 'binary_specificity': 0.9664634, 'binary_f1_score': 0.7603464}
confusion matrix:
     0    1
0  634   22
1  227  395
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8263889, 'precision': 0.8490179, 'recall': 0.8263889, 'specificity': 0.8263889, 'f1': 0.82352847, 'auroc': 0.8970765, 'binary_precision': 0.9378882, 'binary_recall': 0.6990741, 'binary_specificity': 0.9537037, 'binary_f1_score': 0.80106103}
confusion matrix:
     0    1
0  206   10
1   65  151
early stop counter: 1
val acc:0.8051643371582031, best validation acc: 0.8513302206993103, corresponding to test acc:                         0.8032407164573669 / 0.8518518805503845
after epoch: 11,now: 2024-07-23 06:19:47.618482,epoch time: 0:01:12.325491,used: 0:13:17.924606,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_06_06_29_seed_2_22779258
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9875, 'precision': 0.9875779, 'recall': 0.98745966, 'specificity': 0.98745966, 'f1': 0.9874978, 'auroc': 0.9994819, 'binary_precision': 0.9831933, 'binary_recall': 0.9921722, 'binary_specificity': 0.9827472, 'binary_f1_score': 0.9876623}
confusion matrix:
      0     1
0  1481    26
1    12  1521
---- Validation: 
scalar performance:
{'acc': 0.799687, 'precision': 0.8253493, 'recall': 0.79587877, 'specificity': 0.79587877, 'f1': 0.79412836, 'auroc': 0.87878156, 'binary_precision': 0.9103139, 'binary_recall': 0.65273315, 'binary_specificity': 0.9390244, 'binary_f1_score': 0.7602997}
confusion matrix:
     0    1
0  616   40
1  216  406
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8263889, 'precision': 0.83518964, 'recall': 0.8263889, 'specificity': 0.8263889, 'f1': 0.8252418, 'auroc': 0.90554273, 'binary_precision': 0.88950276, 'binary_recall': 0.7453704, 'binary_specificity': 0.9074074, 'binary_f1_score': 0.8110832}
confusion matrix:
     0    1
0  196   20
1   55  161
early stop counter: 2
val acc:0.7996870279312134, best validation acc: 0.8513302206993103, corresponding to test acc:                         0.8032407164573669 / 0.8518518805503845
after epoch: 12,now: 2024-07-23 06:20:59.991378,epoch time: 0:01:12.372896,used: 0:14:30.297502,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_06_06_29_seed_2_22779258
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9884868, 'precision': 0.9885255, 'recall': 0.9884628, 'specificity': 0.9884628, 'f1': 0.98848546, 'auroc': 0.9995693, 'binary_precision': 0.98572356, 'binary_recall': 0.9915144, 'binary_specificity': 0.98541117, 'binary_f1_score': 0.98861045}
confusion matrix:
      0     1
0  1486    22
1    13  1519
---- Validation: 
scalar performance:
{'acc': 0.86463225, 'precision': 0.87848675, 'recall': 0.86209905, 'specificity': 0.86209905, 'f1': 0.8627157, 'auroc': 0.9175947, 'binary_precision': 0.94455445, 'binary_recall': 0.76688105, 'binary_specificity': 0.95731705, 'binary_f1_score': 0.8464951}
confusion matrix:
     0    1
0  628   28
1  145  477
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8263889, 'precision': 0.8373878, 'recall': 0.8263889, 'specificity': 0.8263889, 'f1': 0.8249623, 'auroc': 0.8940543, 'binary_precision': 0.89830506, 'binary_recall': 0.7361111, 'binary_specificity': 0.9166667, 'binary_f1_score': 0.8091603}
confusion matrix:
     0    1
0  198   18
1   57  159
better model found
persisted
after epoch: 13,now: 2024-07-23 06:22:12.136287,epoch time: 0:01:12.144909,used: 0:15:42.442411,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_06_06_29_seed_2_22779258
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.99210525, 'precision': 0.9921083, 'recall': 0.9921441, 'specificity': 0.9921441, 'f1': 0.9921051, 'auroc': 0.99973464, 'binary_precision': 0.99670833, 'binary_recall': 0.987606, 'binary_specificity': 0.99668217, 'binary_f1_score': 0.99213624}
confusion matrix:
      0     1
0  1502     5
1    19  1514
---- Validation: 
scalar performance:
{'acc': 0.80516434, 'precision': 0.84179765, 'recall': 0.8007558, 'specificity': 0.8007558, 'f1': 0.79810333, 'auroc': 0.90173566, 'binary_precision': 0.9472422, 'binary_recall': 0.6350482, 'binary_specificity': 0.9664634, 'binary_f1_score': 0.7603464}
confusion matrix:
     0    1
0  634   22
1  227  395
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7638889, 'precision': 0.82554203, 'recall': 0.7638889, 'specificity': 0.7638889, 'f1': 0.75215423, 'auroc': 0.8732639, 'binary_precision': 0.9672131, 'binary_recall': 0.5462963, 'binary_specificity': 0.9814815, 'binary_f1_score': 0.69822484}
confusion matrix:
     0    1
0  212    4
1   98  118
early stop counter: 1
val acc:0.8051643371582031, best validation acc: 0.864632248878479, corresponding to test acc:                         0.8263888955116272 / 0.8518518805503845
after epoch: 14,now: 2024-07-23 06:23:24.864977,epoch time: 0:01:12.728690,used: 0:16:55.171101,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_06_06_29_seed_2_22779258
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.98355263, 'precision': 0.98368835, 'recall': 0.9836347, 'specificity': 0.9836347, 'f1': 0.9835526, 'auroc': 0.9984555, 'binary_precision': 0.994, 'binary_recall': 0.9732376, 'binary_specificity': 0.99403185, 'binary_f1_score': 0.98350924}
confusion matrix:
      0     1
0  1499     9
1    41  1491
---- Validation: 
scalar performance:
{'acc': 0.74178404, 'precision': 0.8224098, 'recall': 0.7350184, 'specificity': 0.7350184, 'f1': 0.7208469, 'auroc': 0.8976821, 'binary_precision': 0.97712415, 'binary_recall': 0.4807074, 'binary_specificity': 0.9893293, 'binary_f1_score': 0.64439654}
confusion matrix:
     0    1
0  649    7
1  323  299
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7430556, 'precision': 0.79836607, 'recall': 0.7430556, 'specificity': 0.7430556, 'f1': 0.7305689, 'auroc': 0.8481653, 'binary_precision': 0.9268293, 'binary_recall': 0.5277778, 'binary_specificity': 0.9583333, 'binary_f1_score': 0.6725664}
confusion matrix:
     0    1
0  207    9
1  102  114
early stop counter: 2
val acc:0.7417840361595154, best validation acc: 0.864632248878479, corresponding to test acc:                         0.8263888955116272 / 0.8518518805503845
after epoch: 15,now: 2024-07-23 06:24:37.279338,epoch time: 0:01:12.414361,used: 0:18:07.585462,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_06_06_29_seed_2_22779258
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.99210525, 'precision': 0.9921247, 'recall': 0.9921553, 'specificity': 0.9921553, 'f1': 0.9921052, 'auroc': 0.9997004, 'binary_precision': 0.9980198, 'binary_recall': 0.98630136, 'binary_specificity': 0.99800926, 'binary_f1_score': 0.992126}
confusion matrix:
      0     1
0  1504     3
1    21  1512
---- Validation: 
scalar performance:
{'acc': 0.599374, 'precision': 0.76805, 'recall': 0.58854944, 'specificity': 0.58854944, 'f1': 0.5123024, 'auroc': 0.8717993, 'binary_precision': 0.9741379, 'binary_recall': 0.18167202, 'binary_specificity': 0.99542683, 'binary_f1_score': 0.30623305}
confusion matrix:
     0    1
0  653    3
1  509  113
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.525463, 'precision': 0.65139544, 'recall': 0.525463, 'specificity': 0.525463, 'f1': 0.4008727, 'auroc': 0.79162383, 'binary_precision': 0.7894737, 'binary_recall': 0.06944445, 'binary_specificity': 0.9814815, 'binary_f1_score': 0.12765957}
confusion matrix:
     0   1
0  212   4
1  201  15
early stop counter: 3
val acc:0.599373996257782, best validation acc: 0.864632248878479, corresponding to test acc:                         0.8263888955116272 / 0.8518518805503845
after epoch: 16,now: 2024-07-23 06:25:49.401602,epoch time: 0:01:12.122264,used: 0:19:19.707726,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_06_06_29_seed_2_22779258
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9828947, 'precision': 0.9832692, 'recall': 0.98300815, 'specificity': 0.98300815, 'f1': 0.9828935, 'auroc': 0.99955595, 'binary_precision': 0.9986514, 'binary_recall': 0.9673416, 'binary_specificity': 0.99867463, 'binary_f1_score': 0.9827472}
confusion matrix:
      0     1
0  1507     2
1    50  1481
---- Validation: 
scalar performance:
{'acc': 0.65884197, 'precision': 0.78577447, 'recall': 0.64976764, 'specificity': 0.64976764, 'f1': 0.60857034, 'auroc': 0.9063517, 'binary_precision': 0.969697, 'binary_recall': 0.30868167, 'binary_specificity': 0.99085367, 'binary_f1_score': 0.46829262}
confusion matrix:
     0    1
0  650    6
1  430  192
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6759259, 'precision': 0.7807882, 'recall': 0.6759259, 'specificity': 0.6759259, 'f1': 0.6425532, 'auroc': 0.88753855, 'binary_precision': 0.95238096, 'binary_recall': 0.37037036, 'binary_specificity': 0.9814815, 'binary_f1_score': 0.5333333}
confusion matrix:
     0   1
0  212   4
1  136  80
early stop counter: 4
val acc:0.6588419675827026, best validation acc: 0.864632248878479, corresponding to test acc:                         0.8263888955116272 / 0.8518518805503845
after epoch: 17,now: 2024-07-23 06:27:01.370830,epoch time: 0:01:11.969228,used: 0:20:31.676954,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_06_06_29_seed_2_22779258
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.98651314, 'precision': 0.98679733, 'recall': 0.9864249, 'specificity': 0.9864249, 'f1': 0.9865085, 'auroc': 0.9994927, 'binary_precision': 0.9769821, 'binary_recall': 0.99673843, 'binary_specificity': 0.9761115, 'binary_f1_score': 0.98676145}
confusion matrix:
      0     1
0  1471    36
1     5  1528
---- Validation: 
scalar performance:
{'acc': 0.8372457, 'precision': 0.84435785, 'recall': 0.8352972, 'specificity': 0.8352972, 'f1': 0.8357489, 'auroc': 0.8930501, 'binary_precision': 0.8876405, 'binary_recall': 0.7620579, 'binary_specificity': 0.9085366, 'binary_f1_score': 0.82006925}
confusion matrix:
     0    1
0  596   60
1  148  474
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8148148, 'precision': 0.815491, 'recall': 0.8148148, 'specificity': 0.8148148, 'f1': 0.81471556, 'auroc': 0.89544755, 'binary_precision': 0.8300971, 'binary_recall': 0.7916667, 'binary_specificity': 0.837963, 'binary_f1_score': 0.8104266}
confusion matrix:
     0    1
0  181   35
1   45  171
early stop counter: 5
val acc:0.8372457027435303, best validation acc: 0.864632248878479, corresponding to test acc:                         0.8263888955116272 / 0.8518518805503845
after epoch: 18,now: 2024-07-23 06:28:13.699131,epoch time: 0:01:12.328301,used: 0:21:44.005255,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_06_06_29_seed_2_22779258
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.98717105, 'precision': 0.9873537, 'recall': 0.98711634, 'specificity': 0.98711634, 'f1': 0.9871682, 'auroc': 0.9996542, 'binary_precision': 0.9794212, 'binary_recall': 0.9954248, 'binary_specificity': 0.9788079, 'binary_f1_score': 0.98735815}
confusion matrix:
      0     1
0  1478    32
1     7  1523
---- Validation: 
scalar performance:
{'acc': 0.86306727, 'precision': 0.8669106, 'recall': 0.8616996, 'specificity': 0.8616996, 'f1': 0.8623065, 'auroc': 0.9176756, 'binary_precision': 0.8983957, 'binary_recall': 0.8102894, 'binary_specificity': 0.9131098, 'binary_f1_score': 0.852071}
confusion matrix:
     0    1
0  599   57
1  118  504
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8287037, 'precision': 0.82895756, 'recall': 0.8287037, 'specificity': 0.8287037, 'f1': 0.8286707, 'auroc': 0.91595936, 'binary_precision': 0.83809525, 'binary_recall': 0.8148148, 'binary_specificity': 0.8425926, 'binary_f1_score': 0.82629114}
confusion matrix:
     0    1
0  182   34
1   40  176
early stop counter: 6
val acc:0.8630672693252563, best validation acc: 0.864632248878479, corresponding to test acc:                         0.8263888955116272 / 0.8518518805503845
after epoch: 19,now: 2024-07-23 06:29:25.694335,epoch time: 0:01:11.995204,used: 0:22:56.000459,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_06_06_29_seed_2_22779258
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9963816, 'precision': 0.9963739, 'recall': 0.9963944, 'specificity': 0.9963944, 'f1': 0.9963814, 'auroc': 0.9998225, 'binary_precision': 0.9980354, 'binary_recall': 0.9947781, 'binary_specificity': 0.99801064, 'binary_f1_score': 0.99640405}
confusion matrix:
      0     1
0  1505     3
1     8  1524
---- Validation: 
scalar performance:
{'acc': 0.79577464, 'precision': 0.8326849, 'recall': 0.79127616, 'specificity': 0.79127616, 'f1': 0.7881142, 'auroc': 0.9064314, 'binary_precision': 0.937046, 'binary_recall': 0.6221865, 'binary_specificity': 0.96036583, 'binary_f1_score': 0.7478261}
confusion matrix:
     0    1
0  630   26
1  235  387
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8263889, 'precision': 0.84565884, 'recall': 0.82638884, 'specificity': 0.82638884, 'f1': 0.82393503, 'auroc': 0.8916324, 'binary_precision': 0.92727274, 'binary_recall': 0.7083333, 'binary_specificity': 0.9444444, 'binary_f1_score': 0.8031496}
confusion matrix:
     0    1
0  204   12
1   63  153
early stop counter: 7
val acc:0.7957746386528015, best validation acc: 0.864632248878479, corresponding to test acc:                         0.8263888955116272 / 0.8518518805503845
after epoch: 20,now: 2024-07-23 06:30:37.437356,epoch time: 0:01:11.743021,used: 0:24:07.743480,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_06_06_29_seed_2_22779258
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.99276316, 'precision': 0.99276257, 'recall': 0.99276257, 'specificity': 0.99276257, 'f1': 0.99276257, 'auroc': 0.9995463, 'binary_precision': 0.9928292, 'binary_recall': 0.9928292, 'binary_specificity': 0.99269587, 'binary_f1_score': 0.9928292}
confusion matrix:
      0     1
0  1495    11
1    11  1523
---- Validation: 
scalar performance:
{'acc': 0.8176839, 'precision': 0.8448178, 'recall': 0.8139092, 'specificity': 0.8139092, 'f1': 0.812674, 'auroc': 0.9113238, 'binary_precision': 0.935123, 'binary_recall': 0.67202574, 'binary_specificity': 0.95579267, 'binary_f1_score': 0.7820393}
confusion matrix:
     0    1
0  627   29
1  204  418
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7777778, 'precision': 0.78571427, 'recall': 0.7777778, 'specificity': 0.7777778, 'f1': 0.7762238, 'auroc': 0.8697916, 'binary_precision': 0.8333333, 'binary_recall': 0.6944444, 'binary_specificity': 0.8611111, 'binary_f1_score': 0.75757575}
confusion matrix:
     0    1
0  186   30
1   66  150
early stop counter: 8
val acc:0.8176838755607605, best validation acc: 0.864632248878479, corresponding to test acc:                         0.8263888955116272 / 0.8518518805503845
after epoch: 21,now: 2024-07-23 06:31:49.232041,epoch time: 0:01:11.794685,used: 0:25:19.538165,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_06_06_29_seed_2_22779258
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9930921, 'precision': 0.99308753, 'recall': 0.99310696, 'specificity': 0.99310696, 'f1': 0.993092, 'auroc': 0.9995581, 'binary_precision': 0.9954038, 'binary_recall': 0.9908497, 'binary_specificity': 0.99536425, 'binary_f1_score': 0.99312156}
confusion matrix:
      0     1
0  1503     7
1    14  1516
---- Validation: 
scalar performance:
{'acc': 0.8200313, 'precision': 0.8512552, 'recall': 0.81602913, 'specificity': 0.81602913, 'f1': 0.81453526, 'auroc': 0.8971747, 'binary_precision': 0.9495413, 'binary_recall': 0.6655949, 'binary_specificity': 0.9664634, 'binary_f1_score': 0.7826087}
confusion matrix:
     0    1
0  634   22
1  208  414
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.849537, 'precision': 0.87983, 'recall': 0.849537, 'specificity': 0.849537, 'f1': 0.84647596, 'auroc': 0.92301095, 'binary_precision': 0.9870968, 'binary_recall': 0.7083333, 'binary_specificity': 0.9907407, 'binary_f1_score': 0.82479787}
confusion matrix:
     0    1
0  214    2
1   63  153
early stop counter: 9
val acc:0.8200312852859497, best validation acc: 0.864632248878479, corresponding to test acc:                         0.8263888955116272 / 0.8518518805503845
after epoch: 22,now: 2024-07-23 06:33:01.395579,epoch time: 0:01:12.163538,used: 0:26:31.701703,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_06_06_29_seed_2_22779258
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.98980266, 'precision': 0.98982817, 'recall': 0.98983896, 'specificity': 0.98983896, 'f1': 0.9898026, 'auroc': 0.9993741, 'binary_precision': 0.9953734, 'binary_recall': 0.9843137, 'binary_specificity': 0.99536425, 'binary_f1_score': 0.9898127}
confusion matrix:
      0     1
0  1503     7
1    24  1506
---- Validation: 
scalar performance:
{'acc': 0.7887324, 'precision': 0.82199466, 'recall': 0.7843747, 'specificity': 0.7843747, 'f1': 0.78127366, 'auroc': 0.8938123, 'binary_precision': 0.9190476, 'binary_recall': 0.62057877, 'binary_specificity': 0.9481707, 'binary_f1_score': 0.7408829}
confusion matrix:
     0    1
0  622   34
1  236  386
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8078704, 'precision': 0.8152281, 'recall': 0.8078704, 'specificity': 0.8078704, 'f1': 0.80674267, 'auroc': 0.88271606, 'binary_precision': 0.863388, 'binary_recall': 0.7314815, 'binary_specificity': 0.8842593, 'binary_f1_score': 0.79197997}
confusion matrix:
     0    1
0  191   25
1   58  158
early stop counter: 10
val acc:0.7887324094772339, best validation acc: 0.864632248878479, corresponding to test acc:                         0.8263888955116272 / 0.8518518805503845
after epoch: 23,now: 2024-07-23 06:34:13.184393,epoch time: 0:01:11.788814,used: 0:27:43.490517,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_06_06_29_seed_2_22779258
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9914474, 'precision': 0.99144685, 'recall': 0.99144685, 'specificity': 0.99144685, 'f1': 0.99144685, 'auroc': 0.99948704, 'binary_precision': 0.9915144, 'binary_recall': 0.9915144, 'binary_specificity': 0.9913793, 'binary_f1_score': 0.9915144}
confusion matrix:
      0     1
0  1495    13
1    13  1519
---- Validation: 
scalar performance:
{'acc': 0.74100155, 'precision': 0.8153241, 'recall': 0.7344228, 'specificity': 0.7344228, 'f1': 0.7211489, 'auroc': 0.8999931, 'binary_precision': 0.96190476, 'binary_recall': 0.48713827, 'binary_specificity': 0.98170733, 'binary_f1_score': 0.64674497}
confusion matrix:
     0    1
0  644   12
1  319  303
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6180556, 'precision': 0.76563776, 'recall': 0.6180555, 'specificity': 0.6180555, 'f1': 0.5564488, 'auroc': 0.8716564, 'binary_precision': 0.96363634, 'binary_recall': 0.24537037, 'binary_specificity': 0.9907407, 'binary_f1_score': 0.39114392}
confusion matrix:
     0   1
0  214   2
1  163  53
early stop counter: 11
val acc:0.741001546382904, best validation acc: 0.864632248878479, corresponding to test acc:                         0.8263888955116272 / 0.8518518805503845
after epoch: 24,now: 2024-07-23 06:35:25.255223,epoch time: 0:01:12.070830,used: 0:28:55.561347,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_06_06_29_seed_2_22779258
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.99210525, 'precision': 0.9921397, 'recall': 0.99215674, 'specificity': 0.99215674, 'f1': 0.99210525, 'auroc': 0.99949443, 'binary_precision': 0.99867725, 'binary_recall': 0.9856397, 'binary_specificity': 0.99867374, 'binary_f1_score': 0.9921157}
confusion matrix:
      0     1
0  1506     2
1    22  1510
---- Validation: 
scalar performance:
{'acc': 0.700313, 'precision': 0.7976724, 'recall': 0.69253886, 'specificity': 0.69253886, 'f1': 0.66830504, 'auroc': 0.89662397, 'binary_precision': 0.96138996, 'binary_recall': 0.40032154, 'binary_specificity': 0.9847561, 'binary_f1_score': 0.5652667}
confusion matrix:
     0    1
0  646   10
1  373  249
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6759259, 'precision': 0.7758435, 'recall': 0.67592597, 'specificity': 0.67592597, 'f1': 0.64365673, 'auroc': 0.87836504, 'binary_precision': 0.94186044, 'binary_recall': 0.375, 'binary_specificity': 0.9768519, 'binary_f1_score': 0.53642386}
confusion matrix:
     0   1
0  211   5
1  135  81
early stop counter: 12
val acc:0.7003129720687866, best validation acc: 0.864632248878479, corresponding to test acc:                         0.8263888955116272 / 0.8518518805503845
after epoch: 25,now: 2024-07-23 06:36:36.943445,epoch time: 0:01:11.688222,used: 0:30:07.249569,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_06_06_29_seed_2_22779258
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9924342, 'precision': 0.9924935, 'recall': 0.99248856, 'specificity': 0.99248856, 'f1': 0.99243414, 'auroc': 0.9997109, 'binary_precision': 1.0, 'binary_recall': 0.9849771, 'binary_specificity': 1.0, 'binary_f1_score': 0.9924317}
confusion matrix:
      0     1
0  1509     0
1    23  1508
---- Validation: 
scalar performance:
{'acc': 0.7973396, 'precision': 0.83527815, 'recall': 0.79280055, 'specificity': 0.79280055, 'f1': 0.7896075, 'auroc': 0.9063308, 'binary_precision': 0.94160587, 'binary_recall': 0.6221865, 'binary_specificity': 0.9634146, 'binary_f1_score': 0.749274}
confusion matrix:
     0    1
0  632   24
1  235  387
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7175926, 'precision': 0.8016043, 'recall': 0.7175926, 'specificity': 0.7175926, 'f1': 0.69645447, 'auroc': 0.8734782, 'binary_precision': 0.9607843, 'binary_recall': 0.4537037, 'binary_specificity': 0.9814815, 'binary_f1_score': 0.61635214}
confusion matrix:
     0   1
0  212   4
1  118  98
early stop counter: 13
val acc:0.7973396182060242, best validation acc: 0.864632248878479, corresponding to test acc:                         0.8263888955116272 / 0.8518518805503845
after epoch: 26,now: 2024-07-23 06:37:48.927865,epoch time: 0:01:11.984420,used: 0:31:19.233989,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_06_06_29_seed_2_22779258
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.9934211, 'precision': 0.9934262, 'recall': 0.9934467, 'specificity': 0.9934467, 'f1': 0.99342096, 'auroc': 0.99941784, 'binary_precision': 0.99736494, 'binary_recall': 0.9895425, 'binary_specificity': 0.997351, 'binary_f1_score': 0.99343824}
confusion matrix:
      0     1
0  1506     4
1    16  1514
---- Validation: 
scalar performance:
{'acc': 0.62676054, 'precision': 0.77081144, 'recall': 0.6168095, 'specificity': 0.6168095, 'f1': 0.55962336, 'auroc': 0.8283566, 'binary_precision': 0.96178347, 'binary_recall': 0.24276528, 'binary_specificity': 0.99085367, 'binary_f1_score': 0.38767654}
confusion matrix:
     0    1
0  650    6
1  471  151
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6342593, 'precision': 0.7887701, 'recall': 0.6342592, 'specificity': 0.6342592, 'f1': 0.5777805, 'auroc': 0.87103486, 'binary_precision': 1.0, 'binary_recall': 0.2685185, 'binary_specificity': 1.0, 'binary_f1_score': 0.42335767}
confusion matrix:
     0   1
0  216   0
1  158  58
early stop counter: 14
val acc:0.6267605423927307, best validation acc: 0.864632248878479, corresponding to test acc:                         0.8263888955116272 / 0.8518518805503845
after epoch: 27,now: 2024-07-23 06:39:01.061887,epoch time: 0:01:12.134022,used: 0:32:31.368011,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_06_06_29_seed_2_22779258
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.99539477, 'precision': 0.9953855, 'recall': 0.9954113, 'specificity': 0.9954113, 'f1': 0.9953946, 'auroc': 0.9999173, 'binary_precision': 0.9973805, 'binary_recall': 0.99347687, 'binary_specificity': 0.99734575, 'binary_f1_score': 0.99542487}
confusion matrix:
      0     1
0  1503     4
1    10  1523
---- Validation: 
scalar performance:
{'acc': 0.6729264, 'precision': 0.7860744, 'recall': 0.66436213, 'specificity': 0.66436213, 'f1': 0.6302902, 'auroc': 0.90703, 'binary_precision': 0.9594595, 'binary_recall': 0.34244373, 'binary_specificity': 0.9862805, 'binary_f1_score': 0.50473934}
confusion matrix:
     0    1
0  647    9
1  409  213
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6180556, 'precision': 0.7369338, 'recall': 0.6180556, 'specificity': 0.6180556, 'f1': 0.5632754, 'auroc': 0.8462149, 'binary_precision': 0.9047619, 'binary_recall': 0.2638889, 'binary_specificity': 0.9722222, 'binary_f1_score': 0.40860215}
confusion matrix:
     0   1
0  210   6
1  159  57
early stop counter: 15
val acc:0.6729264259338379, best validation acc: 0.864632248878479, corresponding to test acc:                         0.8263888955116272 / 0.8518518805503845
after epoch: 28,now: 2024-07-23 06:40:13.421025,epoch time: 0:01:12.359138,used: 0:33:43.727149,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_06_06_29_seed_2_22779258
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9930921, 'precision': 0.9930899, 'recall': 0.99309397, 'specificity': 0.99309397, 'f1': 0.9930918, 'auroc': 0.9997935, 'binary_precision': 0.99345976, 'binary_recall': 0.9928104, 'binary_specificity': 0.9933775, 'binary_f1_score': 0.993135}
confusion matrix:
      0     1
0  1500    10
1    11  1519
---- Validation: 
scalar performance:
{'acc': 0.6744914, 'precision': 0.77407885, 'recall': 0.6662615, 'specificity': 0.6662615, 'f1': 0.63549805, 'auroc': 0.8895792, 'binary_precision': 0.9327731, 'binary_recall': 0.35691318, 'binary_specificity': 0.9756098, 'binary_f1_score': 0.5162791}
confusion matrix:
     0    1
0  640   16
1  400  222
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7430556, 'precision': 0.8044541, 'recall': 0.7430556, 'specificity': 0.7430556, 'f1': 0.7294134, 'auroc': 0.8919753, 'binary_precision': 0.9411765, 'binary_recall': 0.5185185, 'binary_specificity': 0.9675926, 'binary_f1_score': 0.6686567}
confusion matrix:
     0    1
0  209    7
1  104  112
early stop counter: 16
val acc:0.6744914054870605, best validation acc: 0.864632248878479, corresponding to test acc:                         0.8263888955116272 / 0.8518518805503845
after epoch: 29,now: 2024-07-23 06:41:25.591025,epoch time: 0:01:12.170000,used: 0:34:55.897149,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_06_06_29_seed_2_22779258
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.99375, 'precision': 0.9938033, 'recall': 0.993721, 'specificity': 0.993721, 'f1': 0.9937492, 'auroc': 0.9999255, 'binary_precision': 0.99027866, 'binary_recall': 0.997389, 'binary_specificity': 0.99005306, 'binary_f1_score': 0.99382114}
confusion matrix:
      0     1
0  1493    15
1     4  1528
---- Validation: 
scalar performance:
{'acc': 0.8169014, 'precision': 0.8318424, 'recall': 0.81402194, 'specificity': 0.81402194, 'f1': 0.8137592, 'auroc': 0.89880204, 'binary_precision': 0.89591837, 'binary_recall': 0.7057878, 'binary_specificity': 0.9222561, 'binary_f1_score': 0.7895683}
confusion matrix:
     0    1
0  605   51
1  183  439
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7708333, 'precision': 0.79110515, 'recall': 0.7708334, 'specificity': 0.7708334, 'f1': 0.766773, 'auroc': 0.86248285, 'binary_precision': 0.8679245, 'binary_recall': 0.6388889, 'binary_specificity': 0.9027778, 'binary_f1_score': 0.736}
confusion matrix:
     0    1
0  195   21
1   78  138
early stop counter: 17
val acc:0.8169013857841492, best validation acc: 0.864632248878479, corresponding to test acc:                         0.8263888955116272 / 0.8518518805503845
after epoch: 30,now: 2024-07-23 06:42:38.287795,epoch time: 0:01:12.696770,used: 0:36:08.593919,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_06_06_29_seed_2_22779258
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 0:36:08.593919 at 2024-07-23 06:42:38.287795
persisted model performance metric: 

scalar performance:
{'acc': 0.8263889, 'precision': 0.8373878, 'recall': 0.8263889, 'specificity': 0.8263889, 'f1': 0.8249623, 'auroc': 0.8940543, 'binary_precision': 0.89830506, 'binary_recall': 0.7361111, 'binary_specificity': 0.9166667, 'binary_f1_score': 0.8091603}
confusion matrix:
     0    1
0  198   18
1   57  159
oracle model performance metric: 

scalar performance:
{'acc': 0.8518519, 'precision': 0.85625, 'recall': 0.8518518, 'specificity': 0.8518518, 'f1': 0.85139316, 'auroc': 0.91238, 'binary_precision': 0.8958333, 'binary_recall': 0.7962963, 'binary_specificity': 0.9074074, 'binary_f1_score': 0.84313726}
confusion matrix:
     0    1
0  196   20
1   44  172
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_dial_lr1e5_bs32_nofreeze_2024-07-23_01-16-41/rule_results/1.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_dial_lr1e5_bs32_nofreeze_2024-07-23_01-16-41/confusion_matrix/1.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 451685 KiB |  26075 MiB | 215765 GiB | 215764 GiB |
|       from large pool | 411132 KiB |  26030 MiB | 214419 GiB | 214418 GiB |
|       from small pool |  40553 KiB |     60 MiB |   1346 GiB |   1345 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 451685 KiB |  26075 MiB | 215765 GiB | 215764 GiB |
|       from large pool | 411132 KiB |  26030 MiB | 214419 GiB | 214418 GiB |
|       from small pool |  40553 KiB |     60 MiB |   1346 GiB |   1345 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 447481 KiB |  26071 MiB | 215723 GiB | 215723 GiB |
|       from large pool | 407075 KiB |  26026 MiB | 214380 GiB | 214379 GiB |
|       from small pool |  40406 KiB |     60 MiB |   1343 GiB |   1343 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  27778 MiB |  27778 MiB |  80914 MiB |  53136 MiB |
|       from large pool |  27710 MiB |  27710 MiB |  80820 MiB |  53110 MiB |
|       from small pool |     68 MiB |     72 MiB |     94 MiB |     26 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 775066 KiB |   1679 MiB |  98730 GiB |  98729 GiB |
|       from large pool | 758276 KiB |   1676 MiB |  97374 GiB |  97373 GiB |
|       from small pool |  16790 KiB |     37 MiB |   1355 GiB |   1355 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    1220    |    2570    |   19510 K  |   19509 K  |
|       from large pool |     187    |    1413    |    9878 K  |    9878 K  |
|       from small pool |    1033    |    1335    |    9631 K  |    9630 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    1220    |    2570    |   19510 K  |   19509 K  |
|       from large pool |     187    |    1413    |    9878 K  |    9878 K  |
|       from small pool |    1033    |    1335    |    9631 K  |    9630 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     837    |     837    |    2369    |    1532    |
|       from large pool |     803    |     803    |    2322    |    1519    |
|       from small pool |      34    |      36    |      47    |      13    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     115    |     852    |   14233 K  |   14233 K  |
|       from large pool |      47    |     805    |    8788 K  |    8788 K  |
|       from small pool |      68    |     146    |    5444 K  |    5444 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  26075 MiB | 215765 GiB | 215765 GiB |
|       from large pool |  16640 KiB |  26030 MiB | 214419 GiB | 214419 GiB |
|       from small pool |      0 KiB |     60 MiB |   1346 GiB |   1346 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  26075 MiB | 215765 GiB | 215765 GiB |
|       from large pool |  16640 KiB |  26030 MiB | 214419 GiB | 214419 GiB |
|       from small pool |      0 KiB |     60 MiB |   1346 GiB |   1346 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  26071 MiB | 215723 GiB | 215723 GiB |
|       from large pool |  16640 KiB |  26026 MiB | 214380 GiB | 214380 GiB |
|       from small pool |      0 KiB |     60 MiB |   1343 GiB |   1343 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1198 MiB |  27778 MiB |  80914 MiB |  79716 MiB |
|       from large pool |   1142 MiB |  27710 MiB |  80820 MiB |  79678 MiB |
|       from small pool |     56 MiB |     72 MiB |     94 MiB |     38 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |   3840 KiB |   1679 MiB |  98730 GiB |  98730 GiB |
|       from large pool |   3840 KiB |   1676 MiB |  97374 GiB |  97374 GiB |
|       from small pool |      0 KiB |     37 MiB |   1355 GiB |   1355 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    2570    |   19510 K  |   19510 K  |
|       from large pool |       2    |    1413    |    9878 K  |    9878 K  |
|       from small pool |       0    |    1335    |    9631 K  |    9631 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    2570    |   19510 K  |   19510 K  |
|       from large pool |       2    |    1413    |    9878 K  |    9878 K  |
|       from small pool |       0    |    1335    |    9631 K  |    9631 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      71    |     837    |    2369    |    2298    |
|       from large pool |      43    |     803    |    2322    |    2279    |
|       from small pool |      28    |      36    |      47    |      19    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       1    |     852    |   14233 K  |   14233 K  |
|       from large pool |       1    |     805    |    8788 K  |    8788 K  |
|       from small pool |       0    |     146    |    5445 K  |    5445 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Tue Jul 23 06:43:23 2024]
Finished job 0.
1 of 1 steps (100%) done
