Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Tue Jul 23 03:30:51 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_dial_lr1e5_bs32_nofreeze_2024-07-23_01-16-41/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_dial_lr1e5_bs32_nofreeze_2024-07-23_01-16-41/rule_results/2.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=2
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/swiglu_ffn.py:51: UserWarning: xFormers is not available (SwiGLU)
  warnings.warn("xFormers is not available (SwiGLU)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/attention.py:33: UserWarning: xFormers is not available (Attention)
  warnings.warn("xFormers is not available (Attention)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/block.py:40: UserWarning: xFormers is not available (Block)
  warnings.warn("xFormers is not available (Block)")
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'888c1ef2'
model name: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_03_32_15_seed_0_22779254

 Experiment start at: 2024-07-23 03:32:15.647221
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
before training, model accuracy: 0.569767415523529
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9163411, 'precision': 0.9255539, 'recall': 0.9173716, 'specificity': 0.9173716, 'f1': 0.91600966, 'auroc': 0.9812727, 'binary_precision': 0.99167925, 'binary_recall': 0.8420039, 'binary_specificity': 0.99273926, 'binary_f1_score': 0.91073287}
confusion matrix:
      0     1
0  1504    11
1   246  1311
---- Validation: 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
scalar performance:
{'acc': 0.7748447, 'precision': 0.80669504, 'recall': 0.7725651, 'specificity': 0.7725651, 'f1': 0.7678224, 'auroc': 0.8907019, 'binary_precision': 0.9020979, 'binary_recall': 0.6094488, 'binary_specificity': 0.93568146, 'binary_f1_score': 0.7274436}
confusion matrix:
     0    1
0  611   42
1  248  387
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7767442, 'precision': 0.8055363, 'recall': 0.7767442, 'specificity': 0.7767442, 'f1': 0.77135766, 'auroc': 0.88651156, 'binary_precision': 0.8993289, 'binary_recall': 0.6232558, 'binary_specificity': 0.9302326, 'binary_f1_score': 0.73626375}
confusion matrix:
     0    1
0  200   15
1   81  134
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-23 03:33:53.944359,epoch time: 0:01:38.297138,used: 0:01:38.297138,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_03_32_15_seed_0_22779254
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9427083, 'precision': 0.9463762, 'recall': 0.9432956, 'specificity': 0.9432956, 'f1': 0.9426348, 'auroc': 0.9927764, 'binary_precision': 0.9900498, 'binary_recall': 0.89581996, 'binary_specificity': 0.99077123, 'binary_f1_score': 0.9405807}
confusion matrix:
      0     1
0  1503    14
1   162  1393
---- Validation: 
scalar performance:
{'acc': 0.80590063, 'precision': 0.8153779, 'recall': 0.80466896, 'specificity': 0.80466896, 'f1': 0.8039645, 'auroc': 0.89377916, 'binary_precision': 0.8666667, 'binary_recall': 0.71653545, 'binary_specificity': 0.8928025, 'binary_f1_score': 0.7844827}
confusion matrix:
     0    1
0  583   70
1  180  455
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.82790697, 'precision': 0.8344181, 'recall': 0.82790697, 'specificity': 0.82790697, 'f1': 0.8270652, 'auroc': 0.8963115, 'binary_precision': 0.8810811, 'binary_recall': 0.75813955, 'binary_specificity': 0.89767444, 'binary_f1_score': 0.815}
confusion matrix:
     0    1
0  193   22
1   52  163
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-07-23 03:35:07.304459,epoch time: 0:01:13.360100,used: 0:02:51.657238,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_03_32_15_seed_0_22779254
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.96484375, 'precision': 0.9652158, 'recall': 0.9650667, 'specificity': 0.9650667, 'f1': 0.96484303, 'auroc': 0.99447536, 'binary_precision': 0.98202395, 'binary_recall': 0.94794345, 'binary_specificity': 0.98218995, 'binary_f1_score': 0.9646828}
confusion matrix:
      0     1
0  1489    27
1    81  1475
---- Validation: 
scalar performance:
{'acc': 0.8214286, 'precision': 0.827525, 'recall': 0.82046044, 'specificity': 0.82046044, 'f1': 0.8202567, 'auroc': 0.8926626, 'binary_precision': 0.86885244, 'binary_recall': 0.7511811, 'binary_specificity': 0.8897397, 'binary_f1_score': 0.8057433}
confusion matrix:
     0    1
0  581   72
1  158  477
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8372093, 'precision': 0.8379404, 'recall': 0.8372093, 'specificity': 0.8372093, 'f1': 0.83712125, 'auroc': 0.9121471, 'binary_precision': 0.85365856, 'binary_recall': 0.81395346, 'binary_specificity': 0.8604651, 'binary_f1_score': 0.8333333}
confusion matrix:
     0    1
0  185   30
1   40  175
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-07-23 03:36:20.909208,epoch time: 0:01:13.604749,used: 0:04:05.261987,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_03_32_15_seed_0_22779254
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.976888, 'precision': 0.9768808, 'recall': 0.9769529, 'specificity': 0.9769529, 'f1': 0.9768869, 'auroc': 0.99769557, 'binary_precision': 0.98244476, 'binary_recall': 0.9717042, 'binary_specificity': 0.9822017, 'binary_f1_score': 0.97704494}
confusion matrix:
      0     1
0  1490    27
1    44  1511
---- Validation: 
scalar performance:
{'acc': 0.73524845, 'precision': 0.7488744, 'recall': 0.73355806, 'specificity': 0.73355806, 'f1': 0.73061055, 'auroc': 0.85808206, 'binary_precision': 0.803719, 'binary_recall': 0.6125984, 'binary_specificity': 0.85451764, 'binary_f1_score': 0.6952636}
confusion matrix:
     0    1
0  558   95
1  246  389
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.82790697, 'precision': 0.82816255, 'recall': 0.82790697, 'specificity': 0.82790697, 'f1': 0.82787347, 'auroc': 0.9108491, 'binary_precision': 0.81900454, 'binary_recall': 0.8418605, 'binary_specificity': 0.81395346, 'binary_f1_score': 0.8302752}
confusion matrix:
     0    1
0  175   40
1   34  181
early stop counter: 1
val acc:0.7352484464645386, best validation acc: 0.8214285969734192, corresponding to test acc:                         0.8372092843055725 / 0.8372092843055725
after epoch: 4,now: 2024-07-23 03:37:34.957050,epoch time: 0:01:14.047842,used: 0:05:19.309829,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_03_32_15_seed_0_22779254
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.97298175, 'precision': 0.97320145, 'recall': 0.97286546, 'specificity': 0.97286546, 'f1': 0.97296894, 'auroc': 0.9973072, 'binary_precision': 0.96586597, 'binary_recall': 0.98137444, 'binary_specificity': 0.9643564, 'binary_f1_score': 0.9735585}
confusion matrix:
      0     1
0  1461    54
1    29  1528
---- Validation: 
scalar performance:
{'acc': 0.8167702, 'precision': 0.8167445, 'recall': 0.8167995, 'specificity': 0.8167995, 'f1': 0.81675434, 'auroc': 0.8942952, 'binary_precision': 0.81123245, 'binary_recall': 0.81889766, 'binary_specificity': 0.8147014, 'binary_f1_score': 0.8150471}
confusion matrix:
     0    1
0  532  121
1  115  520
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.81627905, 'precision': 0.8171091, 'recall': 0.81627905, 'specificity': 0.81627905, 'f1': 0.8161588, 'auroc': 0.91061115, 'binary_precision': 0.8333333, 'binary_recall': 0.7906977, 'binary_specificity': 0.8418605, 'binary_f1_score': 0.81145585}
confusion matrix:
     0    1
0  181   34
1   45  170
early stop counter: 2
val acc:0.8167701959609985, best validation acc: 0.8214285969734192, corresponding to test acc:                         0.8372092843055725 / 0.8372092843055725
after epoch: 5,now: 2024-07-23 03:38:49.715310,epoch time: 0:01:14.758260,used: 0:06:34.068089,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_03_32_15_seed_0_22779254
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9785156, 'precision': 0.978752, 'recall': 0.97868055, 'specificity': 0.97868055, 'f1': 0.9785155, 'auroc': 0.99841034, 'binary_precision': 0.99271524, 'binary_recall': 0.9646075, 'binary_specificity': 0.9927536, 'binary_f1_score': 0.97845954}
confusion matrix:
      0     1
0  1507    11
1    55  1499
---- Validation: 
scalar performance:
{'acc': 0.71428573, 'precision': 0.77611303, 'recall': 0.71093076, 'specificity': 0.71093076, 'f1': 0.69523805, 'auroc': 0.8547057, 'binary_precision': 0.90332323, 'binary_recall': 0.47086614, 'binary_specificity': 0.9509954, 'binary_f1_score': 0.6190476}
confusion matrix:
     0    1
0  621   32
1  336  299
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.83255816, 'precision': 0.8410881, 'recall': 0.83255816, 'specificity': 0.83255816, 'f1': 0.8315047, 'auroc': 0.8991238, 'binary_precision': 0.89502764, 'binary_recall': 0.75348836, 'binary_specificity': 0.9116279, 'binary_f1_score': 0.8181818}
confusion matrix:
     0    1
0  196   19
1   53  162
early stop counter: 3
val acc:0.7142857313156128, best validation acc: 0.8214285969734192, corresponding to test acc:                         0.8372092843055725 / 0.8372092843055725
after epoch: 6,now: 2024-07-23 03:40:03.894363,epoch time: 0:01:14.179053,used: 0:07:48.247142,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_03_32_15_seed_0_22779254
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.98079425, 'precision': 0.981101, 'recall': 0.98102814, 'specificity': 0.98102814, 'f1': 0.9807942, 'auroc': 0.9984857, 'binary_precision': 0.99734575, 'binary_recall': 0.9646983, 'binary_specificity': 0.99735796, 'binary_f1_score': 0.98075044}
confusion matrix:
      0     1
0  1510     4
1    55  1503
---- Validation: 
scalar performance:
{'acc': 0.73602486, 'precision': 0.8022584, 'recall': 0.7327176, 'specificity': 0.7327176, 'f1': 0.7188892, 'auroc': 0.91115505, 'binary_precision': 0.9402985, 'binary_recall': 0.496063, 'binary_specificity': 0.96937215, 'binary_f1_score': 0.6494845}
confusion matrix:
     0    1
0  633   20
1  320  315
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.80697674, 'precision': 0.8495074, 'recall': 0.8069768, 'specificity': 0.8069768, 'f1': 0.8009204, 'auroc': 0.910741, 'binary_precision': 0.9714286, 'binary_recall': 0.63255817, 'binary_specificity': 0.98139536, 'binary_f1_score': 0.7661972}
confusion matrix:
     0    1
0  211    4
1   79  136
early stop counter: 4
val acc:0.7360248565673828, best validation acc: 0.8214285969734192, corresponding to test acc:                         0.8372092843055725 / 0.8372092843055725
after epoch: 7,now: 2024-07-23 03:41:17.404946,epoch time: 0:01:13.510583,used: 0:09:01.757725,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_03_32_15_seed_0_22779254
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.98567706, 'precision': 0.9856499, 'recall': 0.9857421, 'specificity': 0.9857421, 'f1': 0.9856756, 'auroc': 0.99923265, 'binary_precision': 0.99029124, 'binary_recall': 0.98139834, 'binary_specificity': 0.9900859, 'binary_f1_score': 0.98582476}
confusion matrix:
      0     1
0  1498    15
1    29  1530
---- Validation: 
scalar performance:
{'acc': 0.79736024, 'precision': 0.8222208, 'recall': 0.7953998, 'specificity': 0.7953998, 'f1': 0.79260653, 'auroc': 0.906134, 'binary_precision': 0.90829694, 'binary_recall': 0.6551181, 'binary_specificity': 0.93568146, 'binary_f1_score': 0.76120764}
confusion matrix:
     0    1
0  611   42
1  219  416
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8418605, 'precision': 0.8454778, 'recall': 0.8418605, 'specificity': 0.8418605, 'f1': 0.84144545, 'auroc': 0.9197837, 'binary_precision': 0.88082904, 'binary_recall': 0.7906977, 'binary_specificity': 0.89302325, 'binary_f1_score': 0.8333334}
confusion matrix:
     0    1
0  192   23
1   45  170
new oracle model saved
early stop counter: 5
val acc:0.7973602414131165, best validation acc: 0.8214285969734192, corresponding to test acc:                         0.8372092843055725 / 0.8418604731559753
after epoch: 8,now: 2024-07-23 03:42:30.968982,epoch time: 0:01:13.564036,used: 0:10:15.321761,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_03_32_15_seed_0_22779254
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.98339844, 'precision': 0.98344785, 'recall': 0.9833574, 'specificity': 0.9833574, 'f1': 0.98339415, 'auroc': 0.99898684, 'binary_precision': 0.98083067, 'binary_recall': 0.98650384, 'binary_specificity': 0.9802111, 'binary_f1_score': 0.983659}
confusion matrix:
      0     1
0  1486    30
1    21  1535
---- Validation: 
scalar performance:
{'acc': 0.8175466, 'precision': 0.8287645, 'recall': 0.8162412, 'specificity': 0.8162412, 'f1': 0.8155199, 'auroc': 0.9003509, 'binary_precision': 0.8861004, 'binary_recall': 0.72283465, 'binary_specificity': 0.90964776, 'binary_f1_score': 0.7961838}
confusion matrix:
     0    1
0  594   59
1  176  459
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.82790697, 'precision': 0.8384806, 'recall': 0.82790697, 'specificity': 0.82790697, 'f1': 0.8265524, 'auroc': 0.9052028, 'binary_precision': 0.89830506, 'binary_recall': 0.73953485, 'binary_specificity': 0.9162791, 'binary_f1_score': 0.81122446}
confusion matrix:
     0    1
0  197   18
1   56  159
early stop counter: 6
val acc:0.8175466060638428, best validation acc: 0.8214285969734192, corresponding to test acc:                         0.8372092843055725 / 0.8418604731559753
after epoch: 9,now: 2024-07-23 03:43:44.220297,epoch time: 0:01:13.251315,used: 0:11:28.573076,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_03_32_15_seed_0_22779254
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9703776, 'precision': 0.9720347, 'recall': 0.96997607, 'specificity': 0.96997607, 'f1': 0.97032684, 'auroc': 0.999195, 'binary_precision': 0.94756097, 'binary_recall': 0.9967928, 'binary_specificity': 0.9431593, 'binary_f1_score': 0.97155356}
confusion matrix:
      0     1
0  1427    86
1     5  1554
---- Validation: 
scalar performance:
{'acc': 0.83618015, 'precision': 0.8445405, 'recall': 0.8372659, 'specificity': 0.8372659, 'f1': 0.8354635, 'auroc': 0.92035306, 'binary_precision': 0.78726286, 'binary_recall': 0.9149606, 'binary_specificity': 0.7595712, 'binary_f1_score': 0.8463219}
confusion matrix:
     0    1
0  496  157
1   54  581
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7837209, 'precision': 0.803588, 'recall': 0.7837209, 'specificity': 0.7837209, 'f1': 0.7801237, 'auroc': 0.8991022, 'binary_precision': 0.7259259, 'binary_recall': 0.9116279, 'binary_specificity': 0.65581393, 'binary_f1_score': 0.80824745}
confusion matrix:
     0    1
0  141   74
1   19  196
better model found
persisted
after epoch: 10,now: 2024-07-23 03:44:58.000624,epoch time: 0:01:13.780327,used: 0:12:42.353403,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_03_32_15_seed_0_22779254
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9814453, 'precision': 0.9818812, 'recall': 0.981269, 'specificity': 0.981269, 'f1': 0.98143244, 'auroc': 0.99934244, 'binary_precision': 0.9705329, 'binary_recall': 0.99358153, 'binary_specificity': 0.9689564, 'binary_f1_score': 0.981922}
confusion matrix:
      0     1
0  1467    47
1    10  1548
---- Validation: 
scalar performance:
{'acc': 0.88975155, 'precision': 0.89117324, 'recall': 0.8893393, 'specificity': 0.8893393, 'f1': 0.8895574, 'auroc': 0.9339427, 'binary_precision': 0.91151917, 'binary_recall': 0.85984254, 'binary_specificity': 0.9188361, 'binary_f1_score': 0.88492703}
confusion matrix:
     0    1
0  600   53
1   89  546
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.872093, 'precision': 0.87999296, 'recall': 0.872093, 'specificity': 0.872093, 'f1': 0.87142473, 'auroc': 0.92077875, 'binary_precision': 0.9347826, 'binary_recall': 0.8, 'binary_specificity': 0.94418603, 'binary_f1_score': 0.8621554}
confusion matrix:
     0    1
0  203   12
1   43  172
new oracle model saved
better model found
persisted
after epoch: 11,now: 2024-07-23 03:46:12.167611,epoch time: 0:01:14.166987,used: 0:13:56.520390,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_03_32_15_seed_0_22779254
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9899089, 'precision': 0.98993266, 'recall': 0.9898859, 'specificity': 0.9898859, 'f1': 0.98990667, 'auroc': 0.9995829, 'binary_precision': 0.98846895, 'binary_recall': 0.9916452, 'binary_specificity': 0.98812664, 'binary_f1_score': 0.9900545}
confusion matrix:
      0     1
0  1498    18
1    13  1543
---- Validation: 
scalar performance:
{'acc': 0.7872671, 'precision': 0.8185498, 'recall': 0.78505504, 'specificity': 0.78505504, 'f1': 0.7809931, 'auroc': 0.9086325, 'binary_precision': 0.9149425, 'binary_recall': 0.6267716, 'binary_specificity': 0.94333845, 'binary_f1_score': 0.74392515}
confusion matrix:
     0    1
0  616   37
1  237  398
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8465116, 'precision': 0.8717306, 'recall': 0.8465116, 'specificity': 0.8465116, 'f1': 0.8438635, 'auroc': 0.92157924, 'binary_precision': 0.9685535, 'binary_recall': 0.7162791, 'binary_specificity': 0.9767442, 'binary_f1_score': 0.8235294}
confusion matrix:
     0    1
0  210    5
1   61  154
early stop counter: 1
val acc:0.7872670888900757, best validation acc: 0.8897515535354614, corresponding to test acc:                         0.8720930218696594 / 0.8720930218696594
after epoch: 12,now: 2024-07-23 03:47:25.590272,epoch time: 0:01:13.422661,used: 0:15:09.943051,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_03_32_15_seed_0_22779254
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9902344, 'precision': 0.9902421, 'recall': 0.99022305, 'specificity': 0.99022305, 'f1': 0.9902322, 'auroc': 0.99968034, 'binary_precision': 0.9897436, 'binary_recall': 0.9910141, 'binary_specificity': 0.989432, 'binary_f1_score': 0.99037844}
confusion matrix:
      0     1
0  1498    16
1    14  1544
---- Validation: 
scalar performance:
{'acc': 0.6863354, 'precision': 0.7700565, 'recall': 0.68238896, 'specificity': 0.68238896, 'f1': 0.65711457, 'auroc': 0.8685148, 'binary_precision': 0.9169675, 'binary_recall': 0.4, 'binary_specificity': 0.96477795, 'binary_f1_score': 0.55701756}
confusion matrix:
     0    1
0  630   23
1  381  254
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.83023256, 'precision': 0.8657514, 'recall': 0.83023256, 'specificity': 0.83023256, 'f1': 0.8260084, 'auroc': 0.9209086, 'binary_precision': 0.9797297, 'binary_recall': 0.6744186, 'binary_specificity': 0.9860465, 'binary_f1_score': 0.79889804}
confusion matrix:
     0    1
0  212    3
1   70  145
early stop counter: 2
val acc:0.6863353848457336, best validation acc: 0.8897515535354614, corresponding to test acc:                         0.8720930218696594 / 0.8720930218696594
after epoch: 13,now: 2024-07-23 03:48:38.120827,epoch time: 0:01:12.530555,used: 0:16:22.473606,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_03_32_15_seed_0_22779254
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9905599, 'precision': 0.9905399, 'recall': 0.99058795, 'specificity': 0.99058795, 'f1': 0.9905588, 'auroc': 0.9993616, 'binary_precision': 0.99289864, 'binary_recall': 0.9884319, 'binary_specificity': 0.9927441, 'binary_f1_score': 0.9906602}
confusion matrix:
      0     1
0  1505    11
1    18  1538
---- Validation: 
scalar performance:
{'acc': 0.7484472, 'precision': 0.80510986, 'recall': 0.7454028, 'specificity': 0.7454028, 'f1': 0.7346201, 'auroc': 0.90743625, 'binary_precision': 0.9331476, 'binary_recall': 0.52755904, 'binary_specificity': 0.9632466, 'binary_f1_score': 0.67404425}
confusion matrix:
     0    1
0  629   24
1  300  335
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.75581396, 'precision': 0.8320137, 'recall': 0.75581396, 'specificity': 0.75581396, 'f1': 0.74095047, 'auroc': 0.90799356, 'binary_precision': 0.9910714, 'binary_recall': 0.51627904, 'binary_specificity': 0.9953488, 'binary_f1_score': 0.67889905}
confusion matrix:
     0    1
0  214    1
1  104  111
early stop counter: 3
val acc:0.7484471797943115, best validation acc: 0.8897515535354614, corresponding to test acc:                         0.8720930218696594 / 0.8720930218696594
after epoch: 14,now: 2024-07-23 03:49:51.599573,epoch time: 0:01:13.478746,used: 0:17:35.952352,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_03_32_15_seed_0_22779254
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9827474, 'precision': 0.983058, 'recall': 0.9826199, 'specificity': 0.9826199, 'f1': 0.9827387, 'auroc': 0.99906826, 'binary_precision': 0.9735183, 'binary_recall': 0.99292606, 'binary_specificity': 0.97231376, 'binary_f1_score': 0.9831264}
confusion matrix:
      0     1
0  1475    42
1    11  1544
---- Validation: 
scalar performance:
{'acc': 0.88431674, 'precision': 0.88438046, 'recall': 0.8842182, 'specificity': 0.8842182, 'f1': 0.8842732, 'auroc': 0.93045783, 'binary_precision': 0.8869427, 'binary_recall': 0.8771654, 'binary_specificity': 0.89127105, 'binary_f1_score': 0.8820269}
confusion matrix:
     0    1
0  582   71
1   78  557
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.872093, 'precision': 0.8750218, 'recall': 0.872093, 'specificity': 0.872093, 'f1': 0.87184286, 'auroc': 0.9320065, 'binary_precision': 0.90816325, 'binary_recall': 0.82790697, 'binary_specificity': 0.9162791, 'binary_f1_score': 0.86618006}
confusion matrix:
     0    1
0  197   18
1   37  178
early stop counter: 4
val acc:0.8843167424201965, best validation acc: 0.8897515535354614, corresponding to test acc:                         0.8720930218696594 / 0.8720930218696594
after epoch: 15,now: 2024-07-23 03:51:04.802036,epoch time: 0:01:13.202463,used: 0:18:49.154815,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_03_32_15_seed_0_22779254
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.98502606, 'precision': 0.9850672, 'recall': 0.98499155, 'specificity': 0.98499155, 'f1': 0.98502266, 'auroc': 0.9992789, 'binary_precision': 0.9827255, 'binary_recall': 0.98778135, 'binary_specificity': 0.9822017, 'binary_f1_score': 0.9852469}
confusion matrix:
      0     1
0  1490    27
1    19  1536
---- Validation: 
scalar performance:
{'acc': 0.84782606, 'precision': 0.8587855, 'recall': 0.8466026, 'specificity': 0.8466026, 'f1': 0.84630823, 'auroc': 0.92302394, 'binary_precision': 0.91809523, 'binary_recall': 0.75905514, 'binary_specificity': 0.9341501, 'binary_f1_score': 0.83103454}
confusion matrix:
     0    1
0  610   43
1  153  482
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8604651, 'precision': 0.8777574, 'recall': 0.8604651, 'specificity': 0.8604651, 'f1': 0.85884976, 'auroc': 0.9227258, 'binary_precision': 0.9585799, 'binary_recall': 0.75348836, 'binary_specificity': 0.96744186, 'binary_f1_score': 0.84374994}
confusion matrix:
     0    1
0  208    7
1   53  162
early stop counter: 5
val acc:0.8478260636329651, best validation acc: 0.8897515535354614, corresponding to test acc:                         0.8720930218696594 / 0.8720930218696594
after epoch: 16,now: 2024-07-23 03:52:17.798428,epoch time: 0:01:12.996392,used: 0:20:02.151207,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_03_32_15_seed_0_22779254
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.98014325, 'precision': 0.9806349, 'recall': 0.9804236, 'specificity': 0.9804236, 'f1': 0.9801426, 'auroc': 0.99966633, 'binary_precision': 1.0, 'binary_recall': 0.96084726, 'binary_specificity': 1.0, 'binary_f1_score': 0.98003274}
confusion matrix:
      0     1
0  1514     0
1    61  1497
---- Validation: 
scalar performance:
{'acc': 0.54658383, 'precision': 0.7164626, 'recall': 0.54028773, 'specificity': 0.54028773, 'f1': 0.42617732, 'auroc': 0.8625568, 'binary_precision': 0.9047619, 'binary_recall': 0.08976378, 'binary_specificity': 0.99081165, 'binary_f1_score': 0.16332379}
confusion matrix:
     0   1
0  647   6
1  578  57
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6627907, 'precision': 0.7986111, 'recall': 0.6627907, 'specificity': 0.6627907, 'f1': 0.6195271, 'auroc': 0.88008654, 'binary_precision': 1.0, 'binary_recall': 0.3255814, 'binary_specificity': 1.0, 'binary_f1_score': 0.49122807}
confusion matrix:
     0   1
0  215   0
1  145  70
early stop counter: 6
val acc:0.5465838313102722, best validation acc: 0.8897515535354614, corresponding to test acc:                         0.8720930218696594 / 0.8720930218696594
after epoch: 17,now: 2024-07-23 03:53:30.575498,epoch time: 0:01:12.777070,used: 0:21:14.928277,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_03_32_15_seed_0_22779254
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9899089, 'precision': 0.9899089, 'recall': 0.9900005, 'specificity': 0.9900005, 'f1': 0.9899084, 'auroc': 0.99965405, 'binary_precision': 0.9967448, 'binary_recall': 0.9833012, 'binary_specificity': 0.9966997, 'binary_f1_score': 0.98997736}
confusion matrix:
      0     1
0  1510     5
1    26  1531
---- Validation: 
scalar performance:
{'acc': 0.6164596, 'precision': 0.7625032, 'recall': 0.61117554, 'specificity': 0.61117554, 'f1': 0.5490439, 'auroc': 0.9003316, 'binary_precision': 0.9548387, 'binary_recall': 0.23307087, 'binary_specificity': 0.9892802, 'binary_f1_score': 0.37468353}
confusion matrix:
     0    1
0  646    7
1  487  148
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6139535, 'precision': 0.78215224, 'recall': 0.6139535, 'specificity': 0.6139535, 'f1': 0.5463443, 'auroc': 0.8523742, 'binary_precision': 1.0, 'binary_recall': 0.22790697, 'binary_specificity': 1.0, 'binary_f1_score': 0.37121212}
confusion matrix:
     0   1
0  215   0
1  166  49
early stop counter: 7
val acc:0.6164596080780029, best validation acc: 0.8897515535354614, corresponding to test acc:                         0.8720930218696594 / 0.8720930218696594
after epoch: 18,now: 2024-07-23 03:54:43.200078,epoch time: 0:01:12.624580,used: 0:22:27.552857,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_03_32_15_seed_0_22779254
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.98828125, 'precision': 0.9885549, 'recall': 0.9881606, 'specificity': 0.9881606, 'f1': 0.9882755, 'auroc': 0.99971724, 'binary_precision': 0.97979796, 'binary_recall': 0.9974293, 'binary_specificity': 0.97889185, 'binary_f1_score': 0.98853505}
confusion matrix:
      0     1
0  1484    32
1     4  1552
---- Validation: 
scalar performance:
{'acc': 0.8043478, 'precision': 0.8314285, 'recall': 0.8023345, 'specificity': 0.8023345, 'f1': 0.7995137, 'auroc': 0.9063655, 'binary_precision': 0.9227373, 'binary_recall': 0.65826774, 'binary_specificity': 0.94640124, 'binary_f1_score': 0.7683823}
confusion matrix:
     0    1
0  618   35
1  217  418
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.74418604, 'precision': 0.81159425, 'recall': 0.74418604, 'specificity': 0.74418604, 'f1': 0.7295598, 'auroc': 0.85367227, 'binary_precision': 0.95652175, 'binary_recall': 0.5116279, 'binary_specificity': 0.9767442, 'binary_f1_score': 0.6666667}
confusion matrix:
     0    1
0  210    5
1  105  110
early stop counter: 8
val acc:0.804347813129425, best validation acc: 0.8897515535354614, corresponding to test acc:                         0.8720930218696594 / 0.8720930218696594
after epoch: 19,now: 2024-07-23 03:55:55.609742,epoch time: 0:01:12.409664,used: 0:23:39.962521,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_03_32_15_seed_0_22779254
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9847005, 'precision': 0.98493075, 'recall': 0.98458636, 'specificity': 0.98458636, 'f1': 0.9846932, 'auroc': 0.9993814, 'binary_precision': 0.977244, 'binary_recall': 0.9929351, 'binary_specificity': 0.9762376, 'binary_f1_score': 0.9850271}
confusion matrix:
      0     1
0  1479    36
1    11  1546
---- Validation: 
scalar performance:
{'acc': 0.85170805, 'precision': 0.86755955, 'recall': 0.8502574, 'specificity': 0.8502574, 'f1': 0.84969664, 'auroc': 0.9363495, 'binary_precision': 0.9404762, 'binary_recall': 0.7464567, 'binary_specificity': 0.9540582, 'binary_f1_score': 0.83230907}
confusion matrix:
     0    1
0  623   30
1  161  474
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8395349, 'precision': 0.8736905, 'recall': 0.8395349, 'specificity': 0.8395349, 'f1': 0.8357825, 'auroc': 0.92449975, 'binary_precision': 0.9866667, 'binary_recall': 0.6883721, 'binary_specificity': 0.9906977, 'binary_f1_score': 0.81095886}
confusion matrix:
     0    1
0  213    2
1   67  148
early stop counter: 9
val acc:0.8517080545425415, best validation acc: 0.8897515535354614, corresponding to test acc:                         0.8720930218696594 / 0.8720930218696594
after epoch: 20,now: 2024-07-23 03:57:08.378952,epoch time: 0:01:12.769210,used: 0:24:52.731731,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_03_32_15_seed_0_22779254
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.99576825, 'precision': 0.995752, 'recall': 0.9957887, 'specificity': 0.9957887, 'f1': 0.9957677, 'auroc': 0.9999368, 'binary_precision': 0.997421, 'binary_recall': 0.99421597, 'binary_specificity': 0.9973615, 'binary_f1_score': 0.9958159}
confusion matrix:
      0     1
0  1512     4
1     9  1547
---- Validation: 
scalar performance:
{'acc': 0.7173913, 'precision': 0.8038417, 'recall': 0.7136246, 'specificity': 0.7136246, 'f1': 0.69344234, 'auroc': 0.9172957, 'binary_precision': 0.96245736, 'binary_recall': 0.44409448, 'binary_specificity': 0.98315465, 'binary_f1_score': 0.6077586}
confusion matrix:
     0    1
0  642   11
1  353  282
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.73255813, 'precision': 0.82575756, 'recall': 0.73255813, 'specificity': 0.73255813, 'f1': 0.7119557, 'auroc': 0.9125365, 'binary_precision': 1.0, 'binary_recall': 0.4651163, 'binary_specificity': 1.0, 'binary_f1_score': 0.63492066}
confusion matrix:
     0    1
0  215    0
1  115  100
early stop counter: 10
val acc:0.717391312122345, best validation acc: 0.8897515535354614, corresponding to test acc:                         0.8720930218696594 / 0.8720930218696594
after epoch: 21,now: 2024-07-23 03:58:21.320278,epoch time: 0:01:12.941326,used: 0:26:05.673057,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_03_32_15_seed_0_22779254
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.99153644, 'precision': 0.991525, 'recall': 0.991615, 'specificity': 0.991615, 'f1': 0.99153596, 'auroc': 0.9998851, 'binary_precision': 0.99740094, 'binary_recall': 0.98587024, 'binary_specificity': 0.99735975, 'binary_f1_score': 0.9916021}
confusion matrix:
      0     1
0  1511     4
1    22  1535
---- Validation: 
scalar performance:
{'acc': 0.7135093, 'precision': 0.79352903, 'recall': 0.70981777, 'specificity': 0.70981777, 'f1': 0.6902423, 'auroc': 0.91389227, 'binary_precision': 0.9433333, 'binary_recall': 0.4456693, 'binary_specificity': 0.9739663, 'binary_f1_score': 0.60534763}
confusion matrix:
     0    1
0  636   17
1  352  283
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.76046515, 'precision': 0.8342216, 'recall': 0.76046515, 'specificity': 0.76046515, 'f1': 0.7464782, 'auroc': 0.91400754, 'binary_precision': 0.99122804, 'binary_recall': 0.5255814, 'binary_specificity': 0.9953488, 'binary_f1_score': 0.6869301}
confusion matrix:
     0    1
0  214    1
1  102  113
early stop counter: 11
val acc:0.7135093212127686, best validation acc: 0.8897515535354614, corresponding to test acc:                         0.8720930218696594 / 0.8720930218696594
after epoch: 22,now: 2024-07-23 03:59:34.508927,epoch time: 0:01:13.188649,used: 0:27:18.861706,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_03_32_15_seed_0_22779254
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.9895833, 'precision': 0.98958135, 'recall': 0.98958135, 'specificity': 0.98958135, 'f1': 0.98958135, 'auroc': 0.9997189, 'binary_precision': 0.9897238, 'binary_recall': 0.9897238, 'binary_specificity': 0.98943895, 'binary_f1_score': 0.9897238}
confusion matrix:
      0     1
0  1499    16
1    16  1541
---- Validation: 
scalar performance:
{'acc': 0.76552796, 'precision': 0.8242037, 'recall': 0.7625303, 'specificity': 0.7625303, 'f1': 0.7530067, 'auroc': 0.92446196, 'binary_precision': 0.9586777, 'binary_recall': 0.5480315, 'binary_specificity': 0.9770291, 'binary_f1_score': 0.69739485}
confusion matrix:
     0    1
0  638   15
1  287  348
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.772093, 'precision': 0.8434505, 'recall': 0.77209306, 'specificity': 0.77209306, 'f1': 0.7596066, 'auroc': 0.9230719, 'binary_precision': 1.0, 'binary_recall': 0.54418606, 'binary_specificity': 1.0, 'binary_f1_score': 0.70481926}
confusion matrix:
     0    1
0  215    0
1   98  117
early stop counter: 12
val acc:0.7655279636383057, best validation acc: 0.8897515535354614, corresponding to test acc:                         0.8720930218696594 / 0.8720930218696594
after epoch: 23,now: 2024-07-23 04:00:47.492681,epoch time: 0:01:12.983754,used: 0:28:31.845460,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_03_32_15_seed_0_22779254
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9827474, 'precision': 0.98307556, 'recall': 0.9829607, 'specificity': 0.9829607, 'f1': 0.9827472, 'auroc': 0.9996562, 'binary_precision': 0.9993355, 'binary_recall': 0.966581, 'binary_specificity': 0.99934036, 'binary_f1_score': 0.98268545}
confusion matrix:
      0     1
0  1515     1
1    52  1504
---- Validation: 
scalar performance:
{'acc': 0.5986025, 'precision': 0.76338685, 'recall': 0.59300023, 'specificity': 0.59300023, 'f1': 0.51789117, 'auroc': 0.9277158, 'binary_precision': 0.96825397, 'binary_recall': 0.19212599, 'binary_specificity': 0.99387443, 'binary_f1_score': 0.32063073}
confusion matrix:
     0    1
0  649    4
1  513  122
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5744186, 'precision': 0.7701005, 'recall': 0.5744186, 'specificity': 0.5744186, 'f1': 0.48028877, 'auroc': 0.92348295, 'binary_precision': 1.0, 'binary_recall': 0.14883721, 'binary_specificity': 1.0, 'binary_f1_score': 0.25910932}
confusion matrix:
     0   1
0  215   0
1  183  32
early stop counter: 13
val acc:0.5986024737358093, best validation acc: 0.8897515535354614, corresponding to test acc:                         0.8720930218696594 / 0.8720930218696594
after epoch: 24,now: 2024-07-23 04:02:00.909794,epoch time: 0:01:13.417113,used: 0:29:45.262573,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_03_32_15_seed_0_22779254
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.98567706, 'precision': 0.9857768, 'recall': 0.98581874, 'specificity': 0.98581874, 'f1': 0.985677, 'auroc': 0.99936926, 'binary_precision': 0.99671483, 'binary_recall': 0.9749357, 'binary_specificity': 0.99670184, 'binary_f1_score': 0.9857049}
confusion matrix:
      0     1
0  1511     5
1    39  1517
---- Validation: 
scalar performance:
{'acc': 0.6490683, 'precision': 0.7615329, 'recall': 0.64442, 'specificity': 0.64442, 'f1': 0.6027035, 'auroc': 0.89820457, 'binary_precision': 0.92957747, 'binary_recall': 0.31181103, 'binary_specificity': 0.9770291, 'binary_f1_score': 0.4669811}
confusion matrix:
     0    1
0  638   15
1  437  198
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7162791, 'precision': 0.8050902, 'recall': 0.71627903, 'specificity': 0.71627903, 'f1': 0.69401085, 'auroc': 0.9166252, 'binary_precision': 0.969697, 'binary_recall': 0.44651163, 'binary_specificity': 0.9860465, 'binary_f1_score': 0.611465}
confusion matrix:
     0   1
0  212   3
1  119  96
early stop counter: 14
val acc:0.649068295955658, best validation acc: 0.8897515535354614, corresponding to test acc:                         0.8720930218696594 / 0.8720930218696594
after epoch: 25,now: 2024-07-23 04:03:13.928451,epoch time: 0:01:13.018657,used: 0:30:58.281230,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_03_32_15_seed_0_22779254
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9632161, 'precision': 0.9659364, 'recall': 0.96277153, 'specificity': 0.96277153, 'f1': 0.9631318, 'auroc': 0.99961424, 'binary_precision': 0.9332933, 'binary_recall': 0.99871385, 'binary_specificity': 0.9268293, 'binary_f1_score': 0.96489596}
confusion matrix:
      0     1
0  1406   111
1     2  1553
---- Validation: 
scalar performance:
{'acc': 0.8718944, 'precision': 0.8720926, 'recall': 0.87207556, 'specificity': 0.87207556, 'f1': 0.87189424, 'auroc': 0.91842616, 'binary_precision': 0.8593272, 'binary_recall': 0.8850394, 'binary_specificity': 0.8591118, 'binary_f1_score': 0.8719937}
confusion matrix:
     0    1
0  561   92
1   73  562
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9, 'precision': 0.90021646, 'recall': 0.9, 'specificity': 0.9, 'f1': 0.8999864, 'auroc': 0.9490752, 'binary_precision': 0.9095238, 'binary_recall': 0.88837206, 'binary_specificity': 0.9116279, 'binary_f1_score': 0.89882344}
confusion matrix:
     0    1
0  196   19
1   24  191
new oracle model saved
early stop counter: 15
val acc:0.8718944191932678, best validation acc: 0.8897515535354614, corresponding to test acc:                         0.8720930218696594 / 0.8999999761581421
after epoch: 26,now: 2024-07-23 04:04:27.257006,epoch time: 0:01:13.328555,used: 0:32:11.609785,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_03_32_15_seed_0_22779254
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.99153644, 'precision': 0.9915288, 'recall': 0.99161136, 'specificity': 0.99161136, 'f1': 0.991536, 'auroc': 0.99986476, 'binary_precision': 0.9973992, 'binary_recall': 0.9858612, 'binary_specificity': 0.9973615, 'binary_f1_score': 0.99159664}
confusion matrix:
      0     1
0  1512     4
1    22  1534
---- Validation: 
scalar performance:
{'acc': 0.7336956, 'precision': 0.7997998, 'recall': 0.7303771, 'specificity': 0.7303771, 'f1': 0.71629286, 'auroc': 0.91148484, 'binary_precision': 0.93712574, 'binary_recall': 0.4929134, 'binary_specificity': 0.96784073, 'binary_f1_score': 0.64602685}
confusion matrix:
     0    1
0  632   21
1  322  313
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.82093024, 'precision': 0.8653941, 'recall': 0.82093024, 'specificity': 0.82093024, 'f1': 0.8153117, 'auroc': 0.92571115, 'binary_precision': 0.99285716, 'binary_recall': 0.6465116, 'binary_specificity': 0.9953488, 'binary_f1_score': 0.7830986}
confusion matrix:
     0    1
0  214    1
1   76  139
early stop counter: 16
val acc:0.7336956262588501, best validation acc: 0.8897515535354614, corresponding to test acc:                         0.8720930218696594 / 0.8999999761581421
after epoch: 27,now: 2024-07-23 04:05:40.150906,epoch time: 0:01:12.893900,used: 0:33:24.503685,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_03_32_15_seed_0_22779254
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.991862, 'precision': 0.9919691, 'recall': 0.99179703, 'specificity': 0.99179703, 'f1': 0.9918593, 'auroc': 0.99989194, 'binary_precision': 0.9872693, 'binary_recall': 0.99678665, 'binary_specificity': 0.9868074, 'binary_f1_score': 0.9920051}
confusion matrix:
      0     1
0  1496    20
1     5  1551
---- Validation: 
scalar performance:
{'acc': 0.8136646, 'precision': 0.84098256, 'recall': 0.8116747, 'specificity': 0.8116747, 'f1': 0.8091545, 'auroc': 0.91561174, 'binary_precision': 0.93406594, 'binary_recall': 0.6692913, 'binary_specificity': 0.9540582, 'binary_f1_score': 0.7798165}
confusion matrix:
     0    1
0  623   30
1  210  425
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8744186, 'precision': 0.8940598, 'recall': 0.8744186, 'specificity': 0.8744186, 'f1': 0.872834, 'auroc': 0.928583, 'binary_precision': 0.98203593, 'binary_recall': 0.7627907, 'binary_specificity': 0.9860465, 'binary_f1_score': 0.85863876}
confusion matrix:
     0    1
0  212    3
1   51  164
early stop counter: 17
val acc:0.8136646151542664, best validation acc: 0.8897515535354614, corresponding to test acc:                         0.8720930218696594 / 0.8999999761581421
after epoch: 28,now: 2024-07-23 04:06:52.951472,epoch time: 0:01:12.800566,used: 0:34:37.304251,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_03_32_15_seed_0_22779254
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9941406, 'precision': 0.9942359, 'recall': 0.99408334, 'specificity': 0.99408334, 'f1': 0.9941389, 'auroc': 0.99986386, 'binary_precision': 0.9898024, 'binary_recall': 0.99871385, 'binary_specificity': 0.98945284, 'binary_f1_score': 0.99423814}
confusion matrix:
      0     1
0  1501    16
1     2  1553
---- Validation: 
scalar performance:
{'acc': 0.8493789, 'precision': 0.8560971, 'recall': 0.84841615, 'specificity': 0.84841615, 'f1': 0.84839046, 'auroc': 0.9216746, 'binary_precision': 0.90163934, 'binary_recall': 0.77952754, 'binary_specificity': 0.91730475, 'binary_f1_score': 0.8361487}
confusion matrix:
     0    1
0  599   54
1  140  495
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.88837206, 'precision': 0.8905349, 'recall': 0.88837206, 'specificity': 0.88837206, 'f1': 0.88821733, 'auroc': 0.9344077, 'binary_precision': 0.919598, 'binary_recall': 0.8511628, 'binary_specificity': 0.9255814, 'binary_f1_score': 0.884058}
confusion matrix:
     0    1
0  199   16
1   32  183
early stop counter: 18
val acc:0.8493788838386536, best validation acc: 0.8897515535354614, corresponding to test acc:                         0.8720930218696594 / 0.8999999761581421
after epoch: 29,now: 2024-07-23 04:08:05.889872,epoch time: 0:01:12.938400,used: 0:35:50.242651,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_03_32_15_seed_0_22779254
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.9951172, 'precision': 0.9951424, 'recall': 0.99509513, 'specificity': 0.99509513, 'f1': 0.9951161, 'auroc': 0.9999089, 'binary_precision': 0.9935939, 'binary_recall': 0.99678665, 'binary_specificity': 0.9934037, 'binary_f1_score': 0.9951877}
confusion matrix:
      0     1
0  1506    10
1     5  1551
---- Validation: 
scalar performance:
{'acc': 0.82298136, 'precision': 0.84432346, 'recall': 0.8212321, 'specificity': 0.8212321, 'f1': 0.81961316, 'auroc': 0.9289723, 'binary_precision': 0.9266247, 'binary_recall': 0.696063, 'binary_specificity': 0.94640124, 'binary_f1_score': 0.79496396}
confusion matrix:
     0    1
0  618   35
1  193  442
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7883721, 'precision': 0.8448365, 'recall': 0.7883721, 'specificity': 0.7883721, 'f1': 0.7793392, 'auroc': 0.92679286, 'binary_precision': 0.984375, 'binary_recall': 0.5860465, 'binary_specificity': 0.9906977, 'binary_f1_score': 0.7346939}
confusion matrix:
     0    1
0  213    2
1   89  126
early stop counter: 19
val acc:0.8229813575744629, best validation acc: 0.8897515535354614, corresponding to test acc:                         0.8720930218696594 / 0.8999999761581421
after epoch: 30,now: 2024-07-23 04:09:18.634770,epoch time: 0:01:12.744898,used: 0:37:02.987549,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_03_32_15_seed_0_22779254
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 0:37:02.987549 at 2024-07-23 04:09:18.634770
persisted model performance metric: 

scalar performance:
{'acc': 0.872093, 'precision': 0.87999296, 'recall': 0.872093, 'specificity': 0.872093, 'f1': 0.87142473, 'auroc': 0.92077875, 'binary_precision': 0.9347826, 'binary_recall': 0.8, 'binary_specificity': 0.94418603, 'binary_f1_score': 0.8621554}
confusion matrix:
     0    1
0  203   12
1   43  172
oracle model performance metric: 

scalar performance:
{'acc': 0.9, 'precision': 0.90021646, 'recall': 0.9, 'specificity': 0.9, 'f1': 0.8999864, 'auroc': 0.9490752, 'binary_precision': 0.9095238, 'binary_recall': 0.88837206, 'binary_specificity': 0.9116279, 'binary_f1_score': 0.89882344}
confusion matrix:
     0    1
0  196   19
1   24  191
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_dial_lr1e5_bs32_nofreeze_2024-07-23_01-16-41/rule_results/2.csv
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_dial_lr1e5_bs32_nofreeze_2024-07-23_01-16-41/rule_results/2.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_dial_lr1e5_bs32_nofreeze_2024-07-23_01-16-41/confusion_matrix/2.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 455936 KiB |  26075 MiB |  70808 GiB |  70808 GiB |
|       from large pool | 415383 KiB |  26030 MiB |  70366 GiB |  70366 GiB |
|       from small pool |  40553 KiB |     56 MiB |    442 GiB |    442 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 455936 KiB |  26075 MiB |  70808 GiB |  70808 GiB |
|       from large pool | 415383 KiB |  26030 MiB |  70366 GiB |  70366 GiB |
|       from small pool |  40553 KiB |     56 MiB |    442 GiB |    442 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 447480 KiB |  26071 MiB |  70794 GiB |  70793 GiB |
|       from large pool | 407075 KiB |  26026 MiB |  70352 GiB |  70352 GiB |
|       from small pool |  40405 KiB |     56 MiB |    441 GiB |    441 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  27748 MiB |  27748 MiB |  27748 MiB |      0 B   |
|       from large pool |  27680 MiB |  27680 MiB |  27680 MiB |      0 B   |
|       from small pool |     68 MiB |     68 MiB |     68 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |    768 MiB |   1678 MiB |  33156 GiB |  33155 GiB |
|       from large pool |    752 MiB |   1668 MiB |  32711 GiB |  32710 GiB |
|       from small pool |     16 MiB |     19 MiB |    444 GiB |    444 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    1220    |    2568    |    6429 K  |    6428 K  |
|       from large pool |     187    |    1413    |    3247 K  |    3247 K  |
|       from small pool |    1033    |    1329    |    3181 K  |    3180 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    1220    |    2568    |    6429 K  |    6428 K  |
|       from large pool |     187    |    1413    |    3247 K  |    3247 K  |
|       from small pool |    1033    |    1329    |    3181 K  |    3180 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     834    |     834    |     834    |       0    |
|       from large pool |     800    |     800    |     800    |       0    |
|       from small pool |      34    |      34    |      34    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     105    |     850    |    4728 K  |    4728 K  |
|       from large pool |      39    |     799    |    2905 K  |    2905 K  |
|       from small pool |      66    |     146    |    1823 K  |    1823 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  26075 MiB |  70808 GiB |  70808 GiB |
|       from large pool |  16640 KiB |  26030 MiB |  70366 GiB |  70366 GiB |
|       from small pool |      0 KiB |     56 MiB |    442 GiB |    442 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  26075 MiB |  70808 GiB |  70808 GiB |
|       from large pool |  16640 KiB |  26030 MiB |  70366 GiB |  70366 GiB |
|       from small pool |      0 KiB |     56 MiB |    442 GiB |    442 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  26071 MiB |  70794 GiB |  70794 GiB |
|       from large pool |  16640 KiB |  26026 MiB |  70352 GiB |  70352 GiB |
|       from small pool |      0 KiB |     56 MiB |    441 GiB |    441 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1214 MiB |  27748 MiB |  27748 MiB |  26534 MiB |
|       from large pool |   1158 MiB |  27680 MiB |  27680 MiB |  26522 MiB |
|       from small pool |     56 MiB |     68 MiB |     68 MiB |     12 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |   3840 KiB |   1678 MiB |  33156 GiB |  33156 GiB |
|       from large pool |   3840 KiB |   1668 MiB |  32711 GiB |  32711 GiB |
|       from small pool |      0 KiB |     27 MiB |    444 GiB |    444 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    2568    |    6429 K  |    6429 K  |
|       from large pool |       2    |    1413    |    3247 K  |    3247 K  |
|       from small pool |       0    |    1329    |    3181 K  |    3181 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    2568    |    6429 K  |    6429 K  |
|       from large pool |       2    |    1413    |    3247 K  |    3247 K  |
|       from small pool |       0    |    1329    |    3181 K  |    3181 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      67    |     834    |     834    |     767    |
|       from large pool |      39    |     800    |     800    |     761    |
|       from small pool |      28    |      34    |      34    |       6    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       1    |     850    |    4729 K  |    4729 K  |
|       from large pool |       1    |     799    |    2905 K  |    2905 K  |
|       from small pool |       0    |     146    |    1823 K  |    1823 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  26075 MiB |  70808 GiB |  70808 GiB |
|       from large pool |  16640 KiB |  26030 MiB |  70366 GiB |  70366 GiB |
|       from small pool |      0 KiB |     56 MiB |    442 GiB |    442 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  26075 MiB |  70808 GiB |  70808 GiB |
|       from large pool |  16640 KiB |  26030 MiB |  70366 GiB |  70366 GiB |
|       from small pool |      0 KiB |     56 MiB |    442 GiB |    442 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  26071 MiB |  70794 GiB |  70794 GiB |
|       from large pool |  16640 KiB |  26026 MiB |  70352 GiB |  70352 GiB |
|       from small pool |      0 KiB |     56 MiB |    441 GiB |    441 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1214 MiB |  27748 MiB |  27748 MiB |  26534 MiB |
|       from large pool |   1158 MiB |  27680 MiB |  27680 MiB |  26522 MiB |
|       from small pool |     56 MiB |     68 MiB |     68 MiB |     12 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |   3840 KiB |   1678 MiB |  33156 GiB |  33156 GiB |
|       from large pool |   3840 KiB |   1668 MiB |  32711 GiB |  32711 GiB |
|       from small pool |      0 KiB |     27 MiB |    444 GiB |    444 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    2568    |    6429 K  |    6429 K  |
|       from large pool |       2    |    1413    |    3247 K  |    3247 K  |
|       from small pool |       0    |    1329    |    3181 K  |    3181 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    2568    |    6429 K  |    6429 K  |
|       from large pool |       2    |    1413    |    3247 K  |    3247 K  |
|       from small pool |       0    |    1329    |    3181 K  |    3181 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      67    |     834    |     834    |     767    |
|       from large pool |      39    |     800    |     800    |     761    |
|       from small pool |      28    |      34    |      34    |       6    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       1    |     850    |    4729 K  |    4729 K  |
|       from large pool |       1    |     799    |    2905 K  |    2905 K  |
|       from small pool |       0    |     146    |    1823 K  |    1823 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'888c1ef2'
model name: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_04_10_36_seed_1_22779254

 Experiment start at: 2024-07-23 04:10:36.247764
before training, model accuracy: 0.6177777647972107
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.93066406, 'precision': 0.93601006, 'recall': 0.93141115, 'specificity': 0.93141115, 'f1': 0.93052185, 'auroc': 0.98129594, 'binary_precision': 0.9876543, 'binary_recall': 0.874036, 'binary_specificity': 0.9887863, 'binary_f1_score': 0.9273781}
confusion matrix:
      0     1
0  1499    17
1   196  1360
---- Validation: 
scalar performance:
{'acc': 0.7915691, 'precision': 0.8242145, 'recall': 0.7889401, 'specificity': 0.7889401, 'f1': 0.7851153, 'auroc': 0.88953257, 'binary_precision': 0.9230769, 'binary_recall': 0.62857145, 'binary_specificity': 0.94930875, 'binary_f1_score': 0.7478754}
confusion matrix:
     0    1
0  618   33
1  234  396
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.84444445, 'precision': 0.8654971, 'recall': 0.84444445, 'specificity': 0.84444445, 'f1': 0.84217167, 'auroc': 0.9061531, 'binary_precision': 0.9532164, 'binary_recall': 0.72444445, 'binary_specificity': 0.96444446, 'binary_f1_score': 0.8232323}
confusion matrix:
     0    1
0  217    8
1   62  163
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-23 04:12:02.586964,epoch time: 0:01:26.339200,used: 0:01:26.339200,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_04_10_36_seed_1_22779254
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.94954425, 'precision': 0.95116305, 'recall': 0.94914687, 'specificity': 0.94914687, 'f1': 0.9494579, 'auroc': 0.9929787, 'binary_precision': 0.92748326, 'binary_recall': 0.9768934, 'binary_specificity': 0.92140025, 'binary_f1_score': 0.9515473}
confusion matrix:
      0     1
0  1395   119
1    36  1522
---- Validation: 
scalar performance:
{'acc': 0.81342703, 'precision': 0.81505805, 'recall': 0.81400406, 'specificity': 0.81400406, 'f1': 0.8133378, 'auroc': 0.885095, 'binary_precision': 0.7879234, 'binary_recall': 0.8492063, 'binary_specificity': 0.77880186, 'binary_f1_score': 0.8174178}
confusion matrix:
     0    1
0  507  144
1   95  535
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7688889, 'precision': 0.79956424, 'recall': 0.7688889, 'specificity': 0.7688889, 'f1': 0.762817, 'auroc': 0.9201186, 'binary_precision': 0.7037037, 'binary_recall': 0.9288889, 'binary_specificity': 0.60888886, 'binary_f1_score': 0.8007662}
confusion matrix:
     0    1
0  137   88
1   16  209
better model found
persisted
after epoch: 2,now: 2024-07-23 04:13:17.890312,epoch time: 0:01:15.303348,used: 0:02:41.642548,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_04_10_36_seed_1_22779254
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.960612, 'precision': 0.9617746, 'recall': 0.9609741, 'specificity': 0.9609741, 'f1': 0.96060276, 'auroc': 0.9961698, 'binary_precision': 0.9884275, 'binary_recall': 0.933162, 'binary_specificity': 0.9887863, 'binary_f1_score': 0.96000004}
confusion matrix:
      0     1
0  1499    17
1   104  1452
---- Validation: 
scalar performance:
{'acc': 0.75409836, 'precision': 0.7918386, 'recall': 0.7511009, 'specificity': 0.7511009, 'f1': 0.74436176, 'auroc': 0.8572526, 'binary_precision': 0.8927681, 'binary_recall': 0.568254, 'binary_specificity': 0.9339478, 'binary_f1_score': 0.69447136}
confusion matrix:
     0    1
0  608   43
1  272  358
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8622222, 'precision': 0.86792, 'recall': 0.8622222, 'specificity': 0.8622222, 'f1': 0.86168677, 'auroc': 0.9174914, 'binary_precision': 0.9137056, 'binary_recall': 0.8, 'binary_specificity': 0.92444444, 'binary_f1_score': 0.85308063}
confusion matrix:
     0    1
0  208   17
1   45  180
new oracle model saved
early stop counter: 1
val acc:0.7540983557701111, best validation acc: 0.8134270310401917, corresponding to test acc:                         0.7688888907432556 / 0.8622221946716309
after epoch: 3,now: 2024-07-23 04:14:33.214838,epoch time: 0:01:15.324526,used: 0:03:56.967074,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_04_10_36_seed_1_22779254
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.97005206, 'precision': 0.9710561, 'recall': 0.9703532, 'specificity': 0.9703532, 'f1': 0.9700459, 'auroc': 0.9973103, 'binary_precision': 0.9959294, 'binary_recall': 0.94465894, 'binary_specificity': 0.99604744, 'binary_f1_score': 0.9696169}
confusion matrix:
      0     1
0  1512     6
1    86  1468
---- Validation: 
scalar performance:
{'acc': 0.8173302, 'precision': 0.8358698, 'recall': 0.8153866, 'specificity': 0.8153866, 'f1': 0.8140944, 'auroc': 0.9015336, 'binary_precision': 0.91078836, 'binary_recall': 0.6968254, 'binary_specificity': 0.9339478, 'binary_f1_score': 0.78956825}
confusion matrix:
     0    1
0  608   43
1  191  439
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.85555553, 'precision': 0.85810924, 'recall': 0.85555553, 'specificity': 0.85555553, 'f1': 0.8552976, 'auroc': 0.92106664, 'binary_precision': 0.88834953, 'binary_recall': 0.81333333, 'binary_specificity': 0.8977778, 'binary_f1_score': 0.84918797}
confusion matrix:
     0    1
0  202   23
1   42  183
better model found
persisted
after epoch: 4,now: 2024-07-23 04:15:48.640458,epoch time: 0:01:15.425620,used: 0:05:12.392694,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_04_10_36_seed_1_22779254
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.97558594, 'precision': 0.9755947, 'recall': 0.97557116, 'specificity': 0.97557116, 'f1': 0.975582, 'auroc': 0.99601984, 'binary_precision': 0.9749518, 'binary_recall': 0.976834, 'binary_specificity': 0.9743083, 'binary_f1_score': 0.975892}
confusion matrix:
      0     1
0  1479    39
1    36  1518
---- Validation: 
scalar performance:
{'acc': 0.8173302, 'precision': 0.8195733, 'recall': 0.81661546, 'specificity': 0.81661546, 'f1': 0.816735, 'auroc': 0.8871845, 'binary_precision': 0.8425605, 'binary_recall': 0.77301586, 'binary_specificity': 0.86021507, 'binary_f1_score': 0.80629134}
confusion matrix:
     0    1
0  560   91
1  143  487
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8088889, 'precision': 0.80898654, 'recall': 0.8088889, 'specificity': 0.8088889, 'f1': 0.8088738, 'auroc': 0.89355063, 'binary_precision': 0.80349344, 'binary_recall': 0.81777775, 'binary_specificity': 0.8, 'binary_f1_score': 0.8105727}
confusion matrix:
     0    1
0  180   45
1   41  184
early stop counter: 1
val acc:0.8173301815986633, best validation acc: 0.8173301815986633, corresponding to test acc:                         0.855555534362793 / 0.8622221946716309
after epoch: 5,now: 2024-07-23 04:17:03.322094,epoch time: 0:01:14.681636,used: 0:06:27.074330,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_04_10_36_seed_1_22779254
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.97786456, 'precision': 0.97786456, 'recall': 0.9779302, 'specificity': 0.9779302, 'f1': 0.9778638, 'auroc': 0.997, 'binary_precision': 0.98372394, 'binary_recall': 0.9723295, 'binary_specificity': 0.98353094, 'binary_f1_score': 0.9779935}
confusion matrix:
      0     1
0  1493    25
1    43  1511
---- Validation: 
scalar performance:
{'acc': 0.8376269, 'precision': 0.84199893, 'recall': 0.83668715, 'specificity': 0.83668715, 'f1': 0.8368033, 'auroc': 0.90000975, 'binary_precision': 0.8767857, 'binary_recall': 0.77936506, 'binary_specificity': 0.89400923, 'binary_f1_score': 0.82521003}
confusion matrix:
     0    1
0  582   69
1  139  491
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.83111113, 'precision': 0.8311373, 'recall': 0.8311111, 'specificity': 0.8311111, 'f1': 0.83110774, 'auroc': 0.8985679, 'binary_precision': 0.82819384, 'binary_recall': 0.83555555, 'binary_specificity': 0.82666665, 'binary_f1_score': 0.83185834}
confusion matrix:
     0    1
0  186   39
1   37  188
better model found
persisted
after epoch: 6,now: 2024-07-23 04:18:18.226074,epoch time: 0:01:14.903980,used: 0:07:41.978310,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_04_10_36_seed_1_22779254
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9798177, 'precision': 0.9798646, 'recall': 0.979933, 'specificity': 0.979933, 'f1': 0.9798174, 'auroc': 0.9978037, 'binary_precision': 0.9888743, 'binary_recall': 0.9710797, 'binary_specificity': 0.9887863, 'binary_f1_score': 0.97989625}
confusion matrix:
      0     1
0  1499    17
1    45  1511
---- Validation: 
scalar performance:
{'acc': 0.8345043, 'precision': 0.83555454, 'recall': 0.83402455, 'specificity': 0.83402455, 'f1': 0.83419865, 'auroc': 0.8934777, 'binary_precision': 0.8506711, 'binary_recall': 0.8047619, 'binary_specificity': 0.86328727, 'binary_f1_score': 0.82707995}
confusion matrix:
     0    1
0  562   89
1  123  507
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8666667, 'precision': 0.86902845, 'recall': 0.8666667, 'specificity': 0.8666667, 'f1': 0.866453, 'auroc': 0.916484, 'binary_precision': 0.89855075, 'binary_recall': 0.82666665, 'binary_specificity': 0.9066667, 'binary_f1_score': 0.86111116}
confusion matrix:
     0    1
0  204   21
1   39  186
new oracle model saved
early stop counter: 1
val acc:0.8345043063163757, best validation acc: 0.8376268744468689, corresponding to test acc:                         0.8311111330986023 / 0.8666666746139526
after epoch: 7,now: 2024-07-23 04:19:33.226176,epoch time: 0:01:15.000102,used: 0:08:56.978412,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_04_10_36_seed_1_22779254
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9733073, 'precision': 0.97329164, 'recall': 0.97334945, 'specificity': 0.97334945, 'f1': 0.9733056, 'auroc': 0.9968121, 'binary_precision': 0.9773022, 'binary_recall': 0.9697555, 'binary_specificity': 0.9769434, 'binary_f1_score': 0.97351414}
confusion matrix:
      0     1
0  1483    35
1    47  1507
---- Validation: 
scalar performance:
{'acc': 0.8649493, 'precision': 0.8668239, 'recall': 0.86436254, 'specificity': 0.86436254, 'f1': 0.86461127, 'auroc': 0.91781145, 'binary_precision': 0.88926744, 'binary_recall': 0.82857144, 'binary_specificity': 0.90015364, 'binary_f1_score': 0.85784715}
confusion matrix:
     0    1
0  586   65
1  108  522
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8755556, 'precision': 0.88542235, 'recall': 0.8755555, 'specificity': 0.8755555, 'f1': 0.87475395, 'auroc': 0.9282371, 'binary_precision': 0.94708997, 'binary_recall': 0.79555553, 'binary_specificity': 0.95555556, 'binary_f1_score': 0.8647343}
confusion matrix:
     0    1
0  215   10
1   46  179
new oracle model saved
better model found
persisted
after epoch: 8,now: 2024-07-23 04:20:48.989554,epoch time: 0:01:15.763378,used: 0:10:12.741790,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_04_10_36_seed_1_22779254
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.96484375, 'precision': 0.9668348, 'recall': 0.9644679, 'specificity': 0.9644679, 'f1': 0.9647807, 'auroc': 0.99860823, 'binary_precision': 0.93928355, 'binary_recall': 0.9948553, 'binary_specificity': 0.9340804, 'binary_f1_score': 0.9662711}
confusion matrix:
      0     1
0  1417   100
1     8  1547
---- Validation: 
scalar performance:
{'acc': 0.8032787, 'precision': 0.80668676, 'recall': 0.80412185, 'specificity': 0.80412185, 'f1': 0.80299044, 'auroc': 0.8853656, 'binary_precision': 0.77, 'binary_recall': 0.85555553, 'binary_specificity': 0.75268817, 'binary_f1_score': 0.8105263}
confusion matrix:
     0    1
0  490  161
1   91  539
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.80444443, 'precision': 0.8216231, 'recall': 0.80444443, 'specificity': 0.80444443, 'f1': 0.80179787, 'auroc': 0.9198222, 'binary_precision': 0.7472924, 'binary_recall': 0.92, 'binary_specificity': 0.6888889, 'binary_f1_score': 0.8247012}
confusion matrix:
     0    1
0  155   70
1   18  207
early stop counter: 1
val acc:0.8032786846160889, best validation acc: 0.8649492859840393, corresponding to test acc:                         0.8755555748939514 / 0.8755555748939514
after epoch: 9,now: 2024-07-23 04:22:03.835605,epoch time: 0:01:14.846051,used: 0:11:27.587841,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_04_10_36_seed_1_22779254
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.98372394, 'precision': 0.98383427, 'recall': 0.983657, 'specificity': 0.983657, 'f1': 0.98371893, 'auroc': 0.99887055, 'binary_precision': 0.97899425, 'binary_recall': 0.9890675, 'binary_specificity': 0.9782465, 'binary_f1_score': 0.98400515}
confusion matrix:
      0     1
0  1484    33
1    17  1538
---- Validation: 
scalar performance:
{'acc': 0.8399688, 'precision': 0.84008694, 'recall': 0.8401434, 'specificity': 0.8401434, 'f1': 0.83996713, 'auroc': 0.89860535, 'binary_precision': 0.82843894, 'binary_recall': 0.85079366, 'binary_specificity': 0.8294931, 'binary_f1_score': 0.83946747}
confusion matrix:
     0    1
0  540  111
1   94  536
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.82666665, 'precision': 0.8304262, 'recall': 0.82666665, 'specificity': 0.82666665, 'f1': 0.82617223, 'auroc': 0.91221726, 'binary_precision': 0.79518074, 'binary_recall': 0.88, 'binary_specificity': 0.7733333, 'binary_f1_score': 0.8354431}
confusion matrix:
     0    1
0  174   51
1   27  198
early stop counter: 2
val acc:0.8399688005447388, best validation acc: 0.8649492859840393, corresponding to test acc:                         0.8755555748939514 / 0.8755555748939514
after epoch: 10,now: 2024-07-23 04:23:19.279630,epoch time: 0:01:15.444025,used: 0:12:43.031866,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_04_10_36_seed_1_22779254
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9847005, 'precision': 0.98468375, 'recall': 0.9847505, 'specificity': 0.9847505, 'f1': 0.9846995, 'auroc': 0.99892235, 'binary_precision': 0.98897535, 'binary_recall': 0.9807074, 'binary_specificity': 0.9887937, 'binary_f1_score': 0.984824}
confusion matrix:
      0     1
0  1500    17
1    30  1525
---- Validation: 
scalar performance:
{'acc': 0.8110851, 'precision': 0.83480406, 'recall': 0.8088838, 'specificity': 0.8088838, 'f1': 0.8068812, 'auroc': 0.90663695, 'binary_precision': 0.9199134, 'binary_recall': 0.67460316, 'binary_specificity': 0.94316435, 'binary_f1_score': 0.7783883}
confusion matrix:
     0    1
0  614   37
1  205  425
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8666667, 'precision': 0.89088, 'recall': 0.8666667, 'specificity': 0.8666667, 'f1': 0.8645693, 'auroc': 0.9368939, 'binary_precision': 0.9881657, 'binary_recall': 0.74222225, 'binary_specificity': 0.9911111, 'binary_f1_score': 0.84771574}
confusion matrix:
     0    1
0  223    2
1   58  167
early stop counter: 3
val acc:0.8110851049423218, best validation acc: 0.8649492859840393, corresponding to test acc:                         0.8755555748939514 / 0.8755555748939514
after epoch: 11,now: 2024-07-23 04:24:34.061968,epoch time: 0:01:14.782338,used: 0:13:57.814204,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_04_10_36_seed_1_22779254
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9876302, 'precision': 0.9876387, 'recall': 0.9877048, 'specificity': 0.9877048, 'f1': 0.9876299, 'auroc': 0.9989313, 'binary_precision': 0.994133, 'binary_recall': 0.9813385, 'binary_specificity': 0.9940711, 'binary_f1_score': 0.9876943}
confusion matrix:
      0     1
0  1509     9
1    29  1525
---- Validation: 
scalar performance:
{'acc': 0.8657299, 'precision': 0.86667764, 'recall': 0.8653098, 'specificity': 0.8653098, 'f1': 0.8655167, 'auroc': 0.9202326, 'binary_precision': 0.88166666, 'binary_recall': 0.8396825, 'binary_specificity': 0.89093703, 'binary_f1_score': 0.86016256}
confusion matrix:
     0    1
0  580   71
1  101  529
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8511111, 'precision': 0.85704243, 'recall': 0.8511111, 'specificity': 0.8511111, 'f1': 0.8504901, 'auroc': 0.9147457, 'binary_precision': 0.9030612, 'binary_recall': 0.7866667, 'binary_specificity': 0.91555554, 'binary_f1_score': 0.84085506}
confusion matrix:
     0    1
0  206   19
1   48  177
better model found
persisted
after epoch: 12,now: 2024-07-23 04:25:50.060293,epoch time: 0:01:15.998325,used: 0:15:13.812529,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_04_10_36_seed_1_22779254
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9899089, 'precision': 0.9899759, 'recall': 0.9900181, 'specificity': 0.9900181, 'f1': 0.9899088, 'auroc': 0.99940443, 'binary_precision': 0.9993443, 'binary_recall': 0.980695, 'binary_specificity': 0.99934125, 'binary_f1_score': 0.98993176}
confusion matrix:
      0     1
0  1517     1
1    30  1524
---- Validation: 
scalar performance:
{'acc': 0.7993755, 'precision': 0.83525103, 'recall': 0.7966718, 'specificity': 0.7966718, 'f1': 0.792812, 'auroc': 0.9143387, 'binary_precision': 0.94089836, 'binary_recall': 0.63174605, 'binary_specificity': 0.96159756, 'binary_f1_score': 0.7559354}
confusion matrix:
     0    1
0  626   25
1  232  398
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8244445, 'precision': 0.858124, 'recall': 0.8244444, 'specificity': 0.8244444, 'f1': 0.8202176, 'auroc': 0.9235358, 'binary_precision': 0.96794873, 'binary_recall': 0.6711111, 'binary_specificity': 0.9777778, 'binary_f1_score': 0.792651}
confusion matrix:
     0    1
0  220    5
1   74  151
early stop counter: 1
val acc:0.7993754744529724, best validation acc: 0.8657299280166626, corresponding to test acc:                         0.851111114025116 / 0.8755555748939514
after epoch: 13,now: 2024-07-23 04:27:05.910023,epoch time: 0:01:15.849730,used: 0:16:29.662259,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_04_10_36_seed_1_22779254
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9895833, 'precision': 0.9895795, 'recall': 0.98965424, 'specificity': 0.98965424, 'f1': 0.9895829, 'auroc': 0.9991882, 'binary_precision': 0.99544567, 'binary_recall': 0.98392284, 'binary_specificity': 0.99538565, 'binary_f1_score': 0.9896507}
confusion matrix:
      0     1
0  1510     7
1    25  1530
---- Validation: 
scalar performance:
{'acc': 0.77205306, 'precision': 0.81828743, 'recall': 0.768894, 'specificity': 0.768894, 'f1': 0.7620219, 'auroc': 0.9049667, 'binary_precision': 0.935567, 'binary_recall': 0.5761905, 'binary_specificity': 0.96159756, 'binary_f1_score': 0.7131631}
confusion matrix:
     0    1
0  626   25
1  267  363
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7866667, 'precision': 0.83571213, 'recall': 0.78666663, 'specificity': 0.78666663, 'f1': 0.7785796, 'auroc': 0.9168, 'binary_precision': 0.9640288, 'binary_recall': 0.59555554, 'binary_specificity': 0.9777778, 'binary_f1_score': 0.7362637}
confusion matrix:
     0    1
0  220    5
1   91  134
early stop counter: 2
val acc:0.772053062915802, best validation acc: 0.8657299280166626, corresponding to test acc:                         0.851111114025116 / 0.8755555748939514
after epoch: 14,now: 2024-07-23 04:28:21.666512,epoch time: 0:01:15.756489,used: 0:17:45.418748,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_04_10_36_seed_1_22779254
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9921875, 'precision': 0.992174, 'recall': 0.9922024, 'specificity': 0.9922024, 'f1': 0.99218655, 'auroc': 0.99965405, 'binary_precision': 0.99355257, 'binary_recall': 0.9909968, 'binary_specificity': 0.993408, 'binary_f1_score': 0.9922731}
confusion matrix:
      0     1
0  1507    10
1    14  1541
---- Validation: 
scalar performance:
{'acc': 0.8508977, 'precision': 0.862383, 'recall': 0.84943676, 'specificity': 0.84943676, 'f1': 0.8492975, 'auroc': 0.91884035, 'binary_precision': 0.9229287, 'binary_recall': 0.76031744, 'binary_specificity': 0.9385561, 'binary_f1_score': 0.8337685}
confusion matrix:
     0    1
0  611   40
1  151  479
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.85555553, 'precision': 0.8677672, 'recall': 0.85555553, 'specificity': 0.85555553, 'f1': 0.85434645, 'auroc': 0.9226272, 'binary_precision': 0.9347826, 'binary_recall': 0.7644445, 'binary_specificity': 0.94666666, 'binary_f1_score': 0.84107584}
confusion matrix:
     0    1
0  213   12
1   53  172
early stop counter: 3
val acc:0.8508977293968201, best validation acc: 0.8657299280166626, corresponding to test acc:                         0.851111114025116 / 0.8755555748939514
after epoch: 15,now: 2024-07-23 04:29:37.645987,epoch time: 0:01:15.979475,used: 0:19:01.398223,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_04_10_36_seed_1_22779254
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.98502606, 'precision': 0.98506135, 'recall': 0.98511064, 'specificity': 0.98511064, 'f1': 0.9850259, 'auroc': 0.9995189, 'binary_precision': 0.9928058, 'binary_recall': 0.97746295, 'binary_specificity': 0.9927584, 'binary_f1_score': 0.98507464}
confusion matrix:
      0     1
0  1508    11
1    35  1518
---- Validation: 
scalar performance:
{'acc': 0.8430913, 'precision': 0.8641783, 'recall': 0.84111625, 'specificity': 0.84111625, 'f1': 0.84021056, 'auroc': 0.92521155, 'binary_precision': 0.9478079, 'binary_recall': 0.72063494, 'binary_specificity': 0.96159756, 'binary_f1_score': 0.8187557}
confusion matrix:
     0    1
0  626   25
1  176  454
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8377778, 'precision': 0.86651236, 'recall': 0.83777773, 'specificity': 0.83777773, 'f1': 0.83453465, 'auroc': 0.9355654, 'binary_precision': 0.9691358, 'binary_recall': 0.69777775, 'binary_specificity': 0.9777778, 'binary_f1_score': 0.81136954}
confusion matrix:
     0    1
0  220    5
1   68  157
early stop counter: 4
val acc:0.8430913090705872, best validation acc: 0.8657299280166626, corresponding to test acc:                         0.851111114025116 / 0.8755555748939514
after epoch: 16,now: 2024-07-23 04:30:53.619288,epoch time: 0:01:15.973301,used: 0:20:17.371524,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_04_10_36_seed_1_22779254
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9899089, 'precision': 0.9899169, 'recall': 0.98997605, 'specificity': 0.98997605, 'f1': 0.9899086, 'auroc': 0.99961674, 'binary_precision': 0.9960887, 'binary_recall': 0.9839021, 'binary_specificity': 0.99605006, 'binary_f1_score': 0.98995787}
confusion matrix:
      0     1
0  1513     6
1    25  1528
---- Validation: 
scalar performance:
{'acc': 0.81342703, 'precision': 0.8341349, 'recall': 0.81136715, 'specificity': 0.81136715, 'f1': 0.8097537, 'auroc': 0.9079804, 'binary_precision': 0.91331923, 'binary_recall': 0.6857143, 'binary_specificity': 0.93701994, 'binary_f1_score': 0.7833182}
confusion matrix:
     0    1
0  610   41
1  198  432
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8511111, 'precision': 0.8685924, 'recall': 0.8511111, 'specificity': 0.8511111, 'f1': 0.8493246, 'auroc': 0.91620743, 'binary_precision': 0.9488636, 'binary_recall': 0.74222225, 'binary_specificity': 0.96, 'binary_f1_score': 0.83291775}
confusion matrix:
     0    1
0  216    9
1   58  167
early stop counter: 5
val acc:0.8134270310401917, best validation acc: 0.8657299280166626, corresponding to test acc:                         0.851111114025116 / 0.8755555748939514
after epoch: 17,now: 2024-07-23 04:32:09.479337,epoch time: 0:01:15.860049,used: 0:21:33.231573,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_04_10_36_seed_1_22779254
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.99153644, 'precision': 0.9915149, 'recall': 0.9915774, 'specificity': 0.9915774, 'f1': 0.99153566, 'auroc': 0.9995582, 'binary_precision': 0.99482536, 'binary_recall': 0.9884319, 'binary_specificity': 0.99472296, 'binary_f1_score': 0.9916183}
confusion matrix:
      0     1
0  1508     8
1    18  1538
---- Validation: 
scalar performance:
{'acc': 0.6900859, 'precision': 0.77079535, 'recall': 0.6855351, 'specificity': 0.6855351, 'f1': 0.6618774, 'auroc': 0.8872967, 'binary_precision': 0.9145908, 'binary_recall': 0.4079365, 'binary_specificity': 0.96313363, 'binary_f1_score': 0.5642152}
confusion matrix:
     0    1
0  627   24
1  373  257
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7688889, 'precision': 0.83184224, 'recall': 0.7688889, 'specificity': 0.7688889, 'f1': 0.7573822, 'auroc': 0.9306865, 'binary_precision': 0.97637796, 'binary_recall': 0.5511111, 'binary_specificity': 0.9866667, 'binary_f1_score': 0.70454544}
confusion matrix:
     0    1
0  222    3
1  101  124
early stop counter: 6
val acc:0.6900858879089355, best validation acc: 0.8657299280166626, corresponding to test acc:                         0.851111114025116 / 0.8755555748939514
after epoch: 18,now: 2024-07-23 04:33:25.752198,epoch time: 0:01:16.272861,used: 0:22:49.504434,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_04_10_36_seed_1_22779254
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.98795575, 'precision': 0.98808753, 'recall': 0.98811054, 'specificity': 0.98811054, 'f1': 0.98795575, 'auroc': 0.99979997, 'binary_precision': 1.0, 'binary_recall': 0.9762211, 'binary_specificity': 1.0, 'binary_f1_score': 0.9879675}
confusion matrix:
      0     1
0  1516     0
1    37  1519
---- Validation: 
scalar performance:
{'acc': 0.63153785, 'precision': 0.76248133, 'recall': 0.62565285, 'specificity': 0.62565285, 'f1': 0.57337123, 'auroc': 0.90251386, 'binary_precision': 0.94382024, 'binary_recall': 0.26666668, 'binary_specificity': 0.984639, 'binary_f1_score': 0.4158416}
confusion matrix:
     0    1
0  641   10
1  462  168
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7355555, 'precision': 0.8011364, 'recall': 0.7355555, 'specificity': 0.7355555, 'f1': 0.72032905, 'auroc': 0.9093728, 'binary_precision': 0.94166666, 'binary_recall': 0.50222224, 'binary_specificity': 0.9688889, 'binary_f1_score': 0.65507245}
confusion matrix:
     0    1
0  218    7
1  112  113
early stop counter: 7
val acc:0.6315378546714783, best validation acc: 0.8657299280166626, corresponding to test acc:                         0.851111114025116 / 0.8755555748939514
after epoch: 19,now: 2024-07-23 04:34:42.198445,epoch time: 0:01:16.446247,used: 0:24:05.950681,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_04_10_36_seed_1_22779254
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.98795575, 'precision': 0.98817426, 'recall': 0.98785865, 'specificity': 0.98785865, 'f1': 0.98795104, 'auroc': 0.999652, 'binary_precision': 0.9803673, 'binary_recall': 0.996139, 'binary_specificity': 0.9795784, 'binary_f1_score': 0.9881903}
confusion matrix:
      0     1
0  1487    31
1     6  1548
---- Validation: 
scalar performance:
{'acc': 0.871975, 'precision': 0.87935114, 'recall': 0.8708397, 'specificity': 0.8708397, 'f1': 0.8710755, 'auroc': 0.92555046, 'binary_precision': 0.92830884, 'binary_recall': 0.8015873, 'binary_specificity': 0.94009215, 'binary_f1_score': 0.8603066}
confusion matrix:
     0    1
0  612   39
1  125  505
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.86, 'precision': 0.8631636, 'recall': 0.86, 'specificity': 0.86, 'f1': 0.8596945, 'auroc': 0.9271704, 'binary_precision': 0.89705884, 'binary_recall': 0.81333333, 'binary_specificity': 0.9066667, 'binary_f1_score': 0.85314685}
confusion matrix:
     0    1
0  204   21
1   42  183
better model found
persisted
after epoch: 20,now: 2024-07-23 04:35:58.575292,epoch time: 0:01:16.376847,used: 0:25:22.327528,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_04_10_36_seed_1_22779254
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.99121094, 'precision': 0.9912508, 'recall': 0.99132395, 'specificity': 0.99132395, 'f1': 0.99121076, 'auroc': 0.99993515, 'binary_precision': 1.0, 'binary_recall': 0.98264784, 'binary_specificity': 1.0, 'binary_f1_score': 0.99124795}
confusion matrix:
      0     1
0  1516     0
1    27  1529
---- Validation: 
scalar performance:
{'acc': 0.5589383, 'precision': 0.7466419, 'recall': 0.5516641, 'specificity': 0.5516641, 'f1': 0.44520414, 'auroc': 0.8849596, 'binary_precision': 0.9577465, 'binary_recall': 0.10793651, 'binary_specificity': 0.9953917, 'binary_f1_score': 0.19400856}
confusion matrix:
     0   1
0  648   3
1  562  68
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6155556, 'precision': 0.74318254, 'recall': 0.6155555, 'specificity': 0.6155555, 'f1': 0.5574969, 'auroc': 0.9000889, 'binary_precision': 0.91935486, 'binary_recall': 0.25333333, 'binary_specificity': 0.9777778, 'binary_f1_score': 0.39721254}
confusion matrix:
     0   1
0  220   5
1  168  57
early stop counter: 1
val acc:0.5589383244514465, best validation acc: 0.8719750046730042, corresponding to test acc:                         0.8600000143051147 / 0.8755555748939514
after epoch: 21,now: 2024-07-23 04:37:14.719324,epoch time: 0:01:16.144032,used: 0:26:38.471560,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_04_10_36_seed_1_22779254
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9827474, 'precision': 0.9833831, 'recall': 0.98254526, 'specificity': 0.98254526, 'f1': 0.9827335, 'auroc': 0.99975157, 'binary_precision': 0.9688085, 'binary_recall': 0.99807197, 'binary_specificity': 0.9670185, 'binary_f1_score': 0.98322254}
confusion matrix:
      0     1
0  1466    50
1     3  1553
---- Validation: 
scalar performance:
{'acc': 0.8797814, 'precision': 0.88119555, 'recall': 0.87928826, 'specificity': 0.87928826, 'f1': 0.87954295, 'auroc': 0.9249408, 'binary_precision': 0.9006734, 'binary_recall': 0.8492063, 'binary_specificity': 0.9093702, 'binary_f1_score': 0.874183}
confusion matrix:
     0    1
0  592   59
1   95  535
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.86444443, 'precision': 0.8697691, 'recall': 0.86444443, 'specificity': 0.86444443, 'f1': 0.86395466, 'auroc': 0.9223901, 'binary_precision': 0.9141414, 'binary_recall': 0.80444443, 'binary_specificity': 0.92444444, 'binary_f1_score': 0.855792}
confusion matrix:
     0    1
0  208   17
1   44  181
better model found
persisted
after epoch: 22,now: 2024-07-23 04:38:30.877878,epoch time: 0:01:16.158554,used: 0:27:54.630114,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_04_10_36_seed_1_22779254
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.98307294, 'precision': 0.9833522, 'recall': 0.9832735, 'specificity': 0.9832735, 'f1': 0.98307276, 'auroc': 0.99968624, 'binary_precision': 0.99867374, 'binary_recall': 0.9678663, 'binary_specificity': 0.9986807, 'binary_f1_score': 0.98302865}
confusion matrix:
      0     1
0  1514     2
1    50  1506
---- Validation: 
scalar performance:
{'acc': 0.7642467, 'precision': 0.8246614, 'recall': 0.7606759, 'specificity': 0.7606759, 'f1': 0.7510438, 'auroc': 0.92349255, 'binary_precision': 0.96067417, 'binary_recall': 0.54285717, 'binary_specificity': 0.97849464, 'binary_f1_score': 0.693712}
confusion matrix:
     0    1
0  637   14
1  288  342
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.82666665, 'precision': 0.86873734, 'recall': 0.8266667, 'specificity': 0.8266667, 'f1': 0.8215775, 'auroc': 0.93963456, 'binary_precision': 0.9932886, 'binary_recall': 0.6577778, 'binary_specificity': 0.9955556, 'binary_f1_score': 0.7914439}
confusion matrix:
     0    1
0  224    1
1   77  148
early stop counter: 1
val acc:0.7642467021942139, best validation acc: 0.8797814249992371, corresponding to test acc:                         0.8644444346427917 / 0.8755555748939514
after epoch: 23,now: 2024-07-23 04:39:46.911757,epoch time: 0:01:16.033879,used: 0:29:10.663993,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_04_10_36_seed_1_22779254
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.99283856, 'precision': 0.99283177, 'recall': 0.9928986, 'specificity': 0.9928986, 'f1': 0.99283826, 'auroc': 0.9995023, 'binary_precision': 0.99804944, 'binary_recall': 0.9877735, 'binary_specificity': 0.9980237, 'binary_f1_score': 0.9928849}
confusion matrix:
      0     1
0  1515     3
1    19  1535
---- Validation: 
scalar performance:
{'acc': 0.83918816, 'precision': 0.8544456, 'recall': 0.8374808, 'specificity': 0.8374808, 'f1': 0.83692217, 'auroc': 0.91463923, 'binary_precision': 0.924, 'binary_recall': 0.73333335, 'binary_specificity': 0.9416283, 'binary_f1_score': 0.81769913}
confusion matrix:
     0    1
0  613   38
1  168  462
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.83111113, 'precision': 0.8513488, 'recall': 0.83111113, 'specificity': 0.83111113, 'f1': 0.82864356, 'auroc': 0.9014716, 'binary_precision': 0.9356725, 'binary_recall': 0.7111111, 'binary_specificity': 0.95111114, 'binary_f1_score': 0.80808085}
confusion matrix:
     0    1
0  214   11
1   65  160
early stop counter: 2
val acc:0.8391881585121155, best validation acc: 0.8797814249992371, corresponding to test acc:                         0.8644444346427917 / 0.8755555748939514
after epoch: 24,now: 2024-07-23 04:41:03.397161,epoch time: 0:01:16.485404,used: 0:30:27.149397,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_04_10_36_seed_1_22779254
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.9905599, 'precision': 0.9905696, 'recall': 0.99066055, 'specificity': 0.99066055, 'f1': 0.9905596, 'auroc': 0.9998872, 'binary_precision': 0.9980443, 'binary_recall': 0.9833012, 'binary_specificity': 0.9980198, 'binary_f1_score': 0.99061793}
confusion matrix:
      0     1
0  1512     3
1    26  1531
---- Validation: 
scalar performance:
{'acc': 0.7080406, 'precision': 0.7992587, 'recall': 0.7034562, 'specificity': 0.7034562, 'f1': 0.6809937, 'auroc': 0.92205644, 'binary_precision': 0.96043164, 'binary_recall': 0.42380953, 'binary_specificity': 0.9831029, 'binary_f1_score': 0.5881058}
confusion matrix:
     0    1
0  640   11
1  363  267
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.68, 'precision': 0.79371476, 'recall': 0.68, 'specificity': 0.68, 'f1': 0.645708, 'auroc': 0.9070617, 'binary_precision': 0.9764706, 'binary_recall': 0.36888888, 'binary_specificity': 0.9911111, 'binary_f1_score': 0.53548384}
confusion matrix:
     0   1
0  223   2
1  142  83
early stop counter: 3
val acc:0.7080405950546265, best validation acc: 0.8797814249992371, corresponding to test acc:                         0.8644444346427917 / 0.8755555748939514
after epoch: 25,now: 2024-07-23 04:42:19.539892,epoch time: 0:01:16.142731,used: 0:31:43.292128,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_04_10_36_seed_1_22779254
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.99641925, 'precision': 0.99643195, 'recall': 0.99640733, 'specificity': 0.99640733, 'f1': 0.99641865, 'auroc': 0.99993813, 'binary_precision': 0.9955042, 'binary_recall': 0.997426, 'binary_specificity': 0.9953887, 'binary_f1_score': 0.99646413}
confusion matrix:
      0     1
0  1511     7
1     4  1550
---- Validation: 
scalar performance:
{'acc': 0.8649493, 'precision': 0.8683975, 'recall': 0.8641577, 'specificity': 0.8641577, 'f1': 0.86442053, 'auroc': 0.92254895, 'binary_precision': 0.90017515, 'binary_recall': 0.815873, 'binary_specificity': 0.9124424, 'binary_f1_score': 0.8559534}
confusion matrix:
     0    1
0  594   57
1  116  514
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.84, 'precision': 0.8479452, 'recall': 0.84000003, 'specificity': 0.84000003, 'f1': 0.8390814, 'auroc': 0.90870124, 'binary_precision': 0.90052354, 'binary_recall': 0.7644445, 'binary_specificity': 0.91555554, 'binary_f1_score': 0.82692313}
confusion matrix:
     0    1
0  206   19
1   53  172
early stop counter: 4
val acc:0.8649492859840393, best validation acc: 0.8797814249992371, corresponding to test acc:                         0.8644444346427917 / 0.8755555748939514
after epoch: 26,now: 2024-07-23 04:43:35.567933,epoch time: 0:01:16.028041,used: 0:32:59.320169,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_04_10_36_seed_1_22779254
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.99576825, 'precision': 0.99574506, 'recall': 0.9958075, 'specificity': 0.9958075, 'f1': 0.9957677, 'auroc': 0.9999428, 'binary_precision': 0.998708, 'binary_recall': 0.9929351, 'binary_specificity': 0.9986799, 'binary_f1_score': 0.99581313}
confusion matrix:
      0     1
0  1513     2
1    11  1546
---- Validation: 
scalar performance:
{'acc': 0.7822014, 'precision': 0.8298385, 'recall': 0.77905786, 'specificity': 0.77905786, 'f1': 0.7726928, 'auroc': 0.91086185, 'binary_precision': 0.9511568, 'binary_recall': 0.5873016, 'binary_specificity': 0.9708141, 'binary_f1_score': 0.7262022}
confusion matrix:
     0    1
0  632   19
1  260  370
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7688889, 'precision': 0.81007266, 'recall': 0.7688889, 'specificity': 0.7688889, 'f1': 0.7609513, 'auroc': 0.8874864, 'binary_precision': 0.9230769, 'binary_recall': 0.58666664, 'binary_specificity': 0.95111114, 'binary_f1_score': 0.71739125}
confusion matrix:
     0    1
0  214   11
1   93  132
early stop counter: 5
val acc:0.7822014093399048, best validation acc: 0.8797814249992371, corresponding to test acc:                         0.8644444346427917 / 0.8755555748939514
after epoch: 27,now: 2024-07-23 04:44:51.438380,epoch time: 0:01:15.870447,used: 0:34:15.190616,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_04_10_36_seed_1_22779254
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.9947917, 'precision': 0.99477476, 'recall': 0.99481505, 'specificity': 0.99481505, 'f1': 0.99479115, 'auroc': 0.9997796, 'binary_precision': 0.9967721, 'binary_recall': 0.99292606, 'binary_specificity': 0.99670404, 'binary_f1_score': 0.9948454}
confusion matrix:
      0     1
0  1512     5
1    11  1544
---- Validation: 
scalar performance:
{'acc': 0.832943, 'precision': 0.8447727, 'recall': 0.8314132, 'specificity': 0.8314132, 'f1': 0.8310101, 'auroc': 0.9059365, 'binary_precision': 0.9046693, 'binary_recall': 0.7380952, 'binary_specificity': 0.9247312, 'binary_f1_score': 0.812937}
confusion matrix:
     0    1
0  602   49
1  165  465
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.83111113, 'precision': 0.8419174, 'recall': 0.83111113, 'specificity': 0.83111113, 'f1': 0.8297661, 'auroc': 0.9151407, 'binary_precision': 0.9027027, 'binary_recall': 0.74222225, 'binary_specificity': 0.92, 'binary_f1_score': 0.8146342}
confusion matrix:
     0    1
0  207   18
1   58  167
early stop counter: 6
val acc:0.8329430222511292, best validation acc: 0.8797814249992371, corresponding to test acc:                         0.8644444346427917 / 0.8755555748939514
after epoch: 28,now: 2024-07-23 04:46:07.137275,epoch time: 0:01:15.698895,used: 0:35:30.889511,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_04_10_36_seed_1_22779254
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9921875, 'precision': 0.99230534, 'recall': 0.99211836, 'specificity': 0.99211836, 'f1': 0.9921849, 'auroc': 0.9997783, 'binary_precision': 0.9872773, 'binary_recall': 0.9974293, 'binary_specificity': 0.9868074, 'binary_f1_score': 0.9923274}
confusion matrix:
      0     1
0  1496    20
1     4  1552
---- Validation: 
scalar performance:
{'acc': 0.871975, 'precision': 0.8819285, 'recall': 0.87066054, 'specificity': 0.87066054, 'f1': 0.8708224, 'auroc': 0.93107, 'binary_precision': 0.93962264, 'binary_recall': 0.7904762, 'binary_specificity': 0.9508448, 'binary_f1_score': 0.8586207}
confusion matrix:
     0    1
0  619   32
1  132  498
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.84, 'precision': 0.86420095, 'recall': 0.84000003, 'specificity': 0.84000003, 'f1': 0.8372971, 'auroc': 0.90913576, 'binary_precision': 0.9580838, 'binary_recall': 0.7111111, 'binary_specificity': 0.9688889, 'binary_f1_score': 0.8163265}
confusion matrix:
     0    1
0  218    7
1   65  160
early stop counter: 7
val acc:0.8719750046730042, best validation acc: 0.8797814249992371, corresponding to test acc:                         0.8644444346427917 / 0.8755555748939514
after epoch: 29,now: 2024-07-23 04:47:22.612075,epoch time: 0:01:15.474800,used: 0:36:46.364311,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_04_10_36_seed_1_22779254
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.9947917, 'precision': 0.99479085, 'recall': 0.99479085, 'specificity': 0.99479085, 'f1': 0.99479085, 'auroc': 0.99990374, 'binary_precision': 0.9948553, 'binary_recall': 0.9948553, 'binary_specificity': 0.9947264, 'binary_f1_score': 0.9948553}
confusion matrix:
      0     1
0  1509     8
1     8  1547
---- Validation: 
scalar performance:
{'acc': 0.81030446, 'precision': 0.8415274, 'recall': 0.8078085, 'specificity': 0.8078085, 'f1': 0.8049625, 'auroc': 0.918193, 'binary_precision': 0.9407745, 'binary_recall': 0.65555555, 'binary_specificity': 0.96006143, 'binary_f1_score': 0.7726847}
confusion matrix:
     0    1
0  625   26
1  217  413
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8333333, 'precision': 0.86368537, 'recall': 0.8333334, 'specificity': 0.8333334, 'f1': 0.8297819, 'auroc': 0.9197827, 'binary_precision': 0.96875, 'binary_recall': 0.6888889, 'binary_specificity': 0.9777778, 'binary_f1_score': 0.80519485}
confusion matrix:
     0    1
0  220    5
1   70  155
early stop counter: 8
val acc:0.8103044629096985, best validation acc: 0.8797814249992371, corresponding to test acc:                         0.8644444346427917 / 0.8755555748939514
after epoch: 30,now: 2024-07-23 04:48:38.955104,epoch time: 0:01:16.343029,used: 0:38:02.707340,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_04_10_36_seed_1_22779254
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 0:38:02.707340 at 2024-07-23 04:48:38.955104
persisted model performance metric: 

scalar performance:
{'acc': 0.86444443, 'precision': 0.8697691, 'recall': 0.86444443, 'specificity': 0.86444443, 'f1': 0.86395466, 'auroc': 0.9223901, 'binary_precision': 0.9141414, 'binary_recall': 0.80444443, 'binary_specificity': 0.92444444, 'binary_f1_score': 0.855792}
confusion matrix:
     0    1
0  208   17
1   44  181
oracle model performance metric: 

scalar performance:
{'acc': 0.8755556, 'precision': 0.88542235, 'recall': 0.8755555, 'specificity': 0.8755555, 'f1': 0.87475395, 'auroc': 0.9282371, 'binary_precision': 0.94708997, 'binary_recall': 0.79555553, 'binary_specificity': 0.95555556, 'binary_f1_score': 0.8647343}
confusion matrix:
     0    1
0  215   10
1   46  179
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_dial_lr1e5_bs32_nofreeze_2024-07-23_01-16-41/rule_results/2.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_dial_lr1e5_bs32_nofreeze_2024-07-23_01-16-41/confusion_matrix/2.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 453153 KiB |  26075 MiB | 145142 GiB | 145142 GiB |
|       from large pool | 412597 KiB |  26030 MiB | 144235 GiB | 144235 GiB |
|       from small pool |  40556 KiB |     60 MiB |    906 GiB |    906 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 453153 KiB |  26075 MiB | 145142 GiB | 145142 GiB |
|       from large pool | 412597 KiB |  26030 MiB | 144235 GiB | 144235 GiB |
|       from small pool |  40556 KiB |     60 MiB |    906 GiB |    906 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 447481 KiB |  26071 MiB | 145116 GiB | 145116 GiB |
|       from large pool | 407075 KiB |  26026 MiB | 144211 GiB | 144210 GiB |
|       from small pool |  40406 KiB |     60 MiB |    905 GiB |    905 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  27768 MiB |  27768 MiB |  54302 MiB |  26534 MiB |
|       from large pool |  27696 MiB |  27696 MiB |  54218 MiB |  26522 MiB |
|       from small pool |     72 MiB |     72 MiB |     84 MiB |     12 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 738782 KiB |   1678 MiB |  64540 GiB |  64539 GiB |
|       from large pool | 721995 KiB |   1668 MiB |  63627 GiB |  63626 GiB |
|       from small pool |  16787 KiB |     27 MiB |    913 GiB |    913 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    1226    |    2570    |   13125 K  |   13124 K  |
|       from large pool |     187    |    1413    |    6645 K  |    6645 K  |
|       from small pool |    1039    |    1335    |    6479 K  |    6478 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    1226    |    2570    |   13125 K  |   13124 K  |
|       from large pool |     187    |    1413    |    6645 K  |    6645 K  |
|       from small pool |    1039    |    1335    |    6479 K  |    6478 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     835    |     835    |    1602    |     767    |
|       from large pool |     799    |     800    |    1560    |     761    |
|       from small pool |      36    |      36    |      42    |       6    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     105    |     850    |    9535 K  |    9535 K  |
|       from large pool |      40    |     801    |    5873 K  |    5873 K  |
|       from small pool |      65    |     146    |    3661 K  |    3661 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  26075 MiB | 145142 GiB | 145142 GiB |
|       from large pool |  16640 KiB |  26030 MiB | 144235 GiB | 144235 GiB |
|       from small pool |      0 KiB |     60 MiB |    906 GiB |    906 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  26075 MiB | 145142 GiB | 145142 GiB |
|       from large pool |  16640 KiB |  26030 MiB | 144235 GiB | 144235 GiB |
|       from small pool |      0 KiB |     60 MiB |    906 GiB |    906 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  26071 MiB | 145116 GiB | 145116 GiB |
|       from large pool |  16640 KiB |  26026 MiB | 144211 GiB | 144211 GiB |
|       from small pool |      0 KiB |     60 MiB |    905 GiB |    905 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1164 MiB |  27768 MiB |  54302 MiB |  53138 MiB |
|       from large pool |   1108 MiB |  27696 MiB |  54218 MiB |  53110 MiB |
|       from small pool |     56 MiB |     72 MiB |     84 MiB |     28 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |   3840 KiB |   1678 MiB |  64540 GiB |  64540 GiB |
|       from large pool |   3840 KiB |   1668 MiB |  63627 GiB |  63627 GiB |
|       from small pool |      0 KiB |     35 MiB |    913 GiB |    913 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    2570    |   13125 K  |   13125 K  |
|       from large pool |       2    |    1413    |    6645 K  |    6645 K  |
|       from small pool |       0    |    1335    |    6479 K  |    6479 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    2570    |   13125 K  |   13125 K  |
|       from large pool |       2    |    1413    |    6645 K  |    6645 K  |
|       from small pool |       0    |    1335    |    6479 K  |    6479 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      69    |     835    |    1602    |    1533    |
|       from large pool |      41    |     800    |    1560    |    1519    |
|       from small pool |      28    |      36    |      42    |      14    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       1    |     850    |    9535 K  |    9535 K  |
|       from large pool |       1    |     801    |    5873 K  |    5873 K  |
|       from small pool |       0    |     146    |    3661 K  |    3661 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  26075 MiB | 145142 GiB | 145142 GiB |
|       from large pool |  16640 KiB |  26030 MiB | 144235 GiB | 144235 GiB |
|       from small pool |      0 KiB |     60 MiB |    906 GiB |    906 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  26075 MiB | 145142 GiB | 145142 GiB |
|       from large pool |  16640 KiB |  26030 MiB | 144235 GiB | 144235 GiB |
|       from small pool |      0 KiB |     60 MiB |    906 GiB |    906 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  26071 MiB | 145116 GiB | 145116 GiB |
|       from large pool |  16640 KiB |  26026 MiB | 144211 GiB | 144211 GiB |
|       from small pool |      0 KiB |     60 MiB |    905 GiB |    905 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1164 MiB |  27768 MiB |  54302 MiB |  53138 MiB |
|       from large pool |   1108 MiB |  27696 MiB |  54218 MiB |  53110 MiB |
|       from small pool |     56 MiB |     72 MiB |     84 MiB |     28 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |   3840 KiB |   1678 MiB |  64540 GiB |  64540 GiB |
|       from large pool |   3840 KiB |   1668 MiB |  63627 GiB |  63627 GiB |
|       from small pool |      0 KiB |     35 MiB |    913 GiB |    913 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    2570    |   13125 K  |   13125 K  |
|       from large pool |       2    |    1413    |    6645 K  |    6645 K  |
|       from small pool |       0    |    1335    |    6479 K  |    6479 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    2570    |   13125 K  |   13125 K  |
|       from large pool |       2    |    1413    |    6645 K  |    6645 K  |
|       from small pool |       0    |    1335    |    6479 K  |    6479 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      69    |     835    |    1602    |    1533    |
|       from large pool |      41    |     800    |    1560    |    1519    |
|       from small pool |      28    |      36    |      42    |      14    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       1    |     850    |    9535 K  |    9535 K  |
|       from large pool |       1    |     801    |    5873 K  |    5873 K  |
|       from small pool |       0    |     146    |    3661 K  |    3661 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'888c1ef2'
model name: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_04_49_53_seed_2_22779254

 Experiment start at: 2024-07-23 04:49:53.147509
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
before training, model accuracy: 0.41203704476356506
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9289474, 'precision': 0.93335044, 'recall': 0.9293198, 'specificity': 0.9293198, 'f1': 0.92880493, 'auroc': 0.9747035, 'binary_precision': 0.9788784, 'binary_recall': 0.8778576, 'binary_specificity': 0.980782, 'binary_f1_score': 0.9256199}
confusion matrix:
      0     1
0  1480    29
1   187  1344
---- Validation: 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
scalar performance:
{'acc': 0.75586855, 'precision': 0.77989006, 'recall': 0.7518209, 'specificity': 0.7518209, 'f1': 0.74841315, 'auroc': 0.8613638, 'binary_precision': 0.8555046, 'binary_recall': 0.59967846, 'binary_specificity': 0.9039634, 'binary_f1_score': 0.705104}
confusion matrix:
     0    1
0  593   63
1  249  373
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8055556, 'precision': 0.81756216, 'recall': 0.8055556, 'specificity': 0.8055556, 'f1': 0.8037001, 'auroc': 0.87915814, 'binary_precision': 0.87931037, 'binary_recall': 0.7083333, 'binary_specificity': 0.9027778, 'binary_f1_score': 0.7846154}
confusion matrix:
     0    1
0  195   21
1   63  153
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-23 04:51:12.673927,epoch time: 0:01:19.526418,used: 0:01:19.526418,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_04_49_53_seed_2_22779254
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.95230263, 'precision': 0.95414555, 'recall': 0.9524977, 'specificity': 0.9524977, 'f1': 0.95226705, 'auroc': 0.9921911, 'binary_precision': 0.9845938, 'binary_recall': 0.91955525, 'binary_specificity': 0.98544014, 'binary_f1_score': 0.9509638}
confusion matrix:
      0     1
0  1489    22
1   123  1406
---- Validation: 
scalar performance:
{'acc': 0.7574335, 'precision': 0.80515206, 'recall': 0.75205374, 'specificity': 0.75205374, 'f1': 0.74483263, 'auroc': 0.88524187, 'binary_precision': 0.91935486, 'binary_recall': 0.5498392, 'binary_specificity': 0.9542683, 'binary_f1_score': 0.68812877}
confusion matrix:
     0    1
0  626   30
1  280  342
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8240741, 'precision': 0.853172, 'recall': 0.8240741, 'specificity': 0.8240741, 'f1': 0.82037425, 'auroc': 0.9039352, 'binary_precision': 0.95454544, 'binary_recall': 0.6805556, 'binary_specificity': 0.9675926, 'binary_f1_score': 0.7945946}
confusion matrix:
     0    1
0  209    7
1   69  147
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-07-23 04:52:26.351166,epoch time: 0:01:13.677239,used: 0:02:33.203657,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_04_49_53_seed_2_22779254
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.93421054, 'precision': 0.94140315, 'recall': 0.9345939, 'specificity': 0.9345939, 'f1': 0.9339791, 'auroc': 0.9931879, 'binary_precision': 0.9992487, 'binary_recall': 0.86984956, 'binary_specificity': 0.9993382, 'binary_f1_score': 0.93007}
confusion matrix:
      0     1
0  1510     1
1   199  1330
---- Validation: 
scalar performance:
{'acc': 0.6079812, 'precision': 0.7181492, 'recall': 0.59818345, 'specificity': 0.59818345, 'f1': 0.54009724, 'auroc': 0.8293345, 'binary_precision': 0.8666667, 'binary_recall': 0.22990353, 'binary_specificity': 0.9664634, 'binary_f1_score': 0.36340532}
confusion matrix:
     0    1
0  634   22
1  479  143
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8125, 'precision': 0.8294543, 'recall': 0.8125, 'specificity': 0.8125, 'f1': 0.8100563, 'auroc': 0.8933042, 'binary_precision': 0.9041916, 'binary_recall': 0.6990741, 'binary_specificity': 0.9259259, 'binary_f1_score': 0.78851175}
confusion matrix:
     0    1
0  200   16
1   65  151
early stop counter: 1
val acc:0.6079812049865723, best validation acc: 0.7574334740638733, corresponding to test acc:                         0.8240740895271301 / 0.8240740895271301
after epoch: 3,now: 2024-07-23 04:53:39.943772,epoch time: 0:01:13.592606,used: 0:03:46.796263,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_04_49_53_seed_2_22779254
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.97861844, 'precision': 0.9786407, 'recall': 0.9786438, 'specificity': 0.9786438, 'f1': 0.97861844, 'auroc': 0.9973601, 'binary_precision': 0.9834765, 'binary_recall': 0.973822, 'binary_specificity': 0.9834656, 'binary_f1_score': 0.9786255}
confusion matrix:
      0     1
0  1487    25
1    40  1488
---- Validation: 
scalar performance:
{'acc': 0.7856025, 'precision': 0.80482185, 'recall': 0.78215927, 'specificity': 0.78215927, 'f1': 0.7806517, 'auroc': 0.8715763, 'binary_precision': 0.875, 'binary_recall': 0.65273315, 'binary_specificity': 0.9115854, 'binary_f1_score': 0.747698}
confusion matrix:
     0    1
0  598   58
1  216  406
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8356481, 'precision': 0.83565533, 'recall': 0.8356482, 'specificity': 0.8356482, 'f1': 0.8356473, 'auroc': 0.904621, 'binary_precision': 0.8341014, 'binary_recall': 0.837963, 'binary_specificity': 0.8333333, 'binary_f1_score': 0.83602774}
confusion matrix:
     0    1
0  180   36
1   35  181
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-07-23 04:54:53.824755,epoch time: 0:01:13.880983,used: 0:05:00.677246,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_04_49_53_seed_2_22779254
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9819079, 'precision': 0.9819256, 'recall': 0.9818912, 'specificity': 0.9818912, 'f1': 0.98190576, 'auroc': 0.9985525, 'binary_precision': 0.98050684, 'binary_recall': 0.9837027, 'binary_specificity': 0.9800797, 'binary_f1_score': 0.9821022}
confusion matrix:
      0     1
0  1476    30
1    25  1509
---- Validation: 
scalar performance:
{'acc': 0.81064165, 'precision': 0.8106216, 'recall': 0.81084085, 'specificity': 0.81084085, 'f1': 0.810604, 'auroc': 0.8795241, 'binary_precision': 0.79780567, 'binary_recall': 0.81832796, 'binary_specificity': 0.80335367, 'binary_f1_score': 0.80793643}
confusion matrix:
     0    1
0  527  129
1  113  509
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7337963, 'precision': 0.7816058, 'recall': 0.7337963, 'specificity': 0.7337963, 'f1': 0.72199684, 'auroc': 0.8975909, 'binary_precision': 0.6655738, 'binary_recall': 0.9398148, 'binary_specificity': 0.5277778, 'binary_f1_score': 0.77927065}
confusion matrix:
     0    1
0  114  102
1   13  203
better model found
persisted
after epoch: 5,now: 2024-07-23 04:56:07.784708,epoch time: 0:01:13.959953,used: 0:06:14.637199,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_04_49_53_seed_2_22779254
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9773026, 'precision': 0.9779985, 'recall': 0.977438, 'specificity': 0.977438, 'f1': 0.97729814, 'auroc': 0.99860716, 'binary_precision': 0.997955, 'binary_recall': 0.95686275, 'binary_specificity': 0.99801326, 'binary_f1_score': 0.976977}
confusion matrix:
      0     1
0  1507     3
1    66  1464
---- Validation: 
scalar performance:
{'acc': 0.69014084, 'precision': 0.7709454, 'recall': 0.6826719, 'specificity': 0.6826719, 'f1': 0.65974075, 'auroc': 0.87257624, 'binary_precision': 0.91240877, 'binary_recall': 0.40192926, 'binary_specificity': 0.9634146, 'binary_f1_score': 0.55803573}
confusion matrix:
     0    1
0  632   24
1  372  250
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7384259, 'precision': 0.76552093, 'recall': 0.7384259, 'specificity': 0.7384259, 'f1': 0.7315782, 'auroc': 0.84456444, 'binary_precision': 0.8503401, 'binary_recall': 0.5787037, 'binary_specificity': 0.8981481, 'binary_f1_score': 0.68870527}
confusion matrix:
     0    1
0  194   22
1   91  125
early stop counter: 1
val acc:0.6901408433914185, best validation acc: 0.8106416463851929, corresponding to test acc:                         0.7337962985038757 / 0.8356481194496155
after epoch: 6,now: 2024-07-23 04:57:21.396433,epoch time: 0:01:13.611725,used: 0:07:28.248924,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_04_49_53_seed_2_22779254
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9832237, 'precision': 0.9832641, 'recall': 0.9832601, 'specificity': 0.9832601, 'f1': 0.9832237, 'auroc': 0.99841833, 'binary_precision': 0.98940396, 'binary_recall': 0.9771092, 'binary_specificity': 0.989411, 'binary_f1_score': 0.98321813}
confusion matrix:
      0     1
0  1495    16
1    35  1494
---- Validation: 
scalar performance:
{'acc': 0.69248825, 'precision': 0.7779888, 'recall': 0.68491685, 'specificity': 0.68491685, 'f1': 0.66144323, 'auroc': 0.8726914, 'binary_precision': 0.92565054, 'binary_recall': 0.40032154, 'binary_specificity': 0.9695122, 'binary_f1_score': 0.5589225}
confusion matrix:
     0    1
0  636   20
1  373  249
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7453704, 'precision': 0.80897117, 'recall': 0.7453704, 'specificity': 0.7453704, 'f1': 0.73155576, 'auroc': 0.87358534, 'binary_precision': 0.9491525, 'binary_recall': 0.5185185, 'binary_specificity': 0.9722222, 'binary_f1_score': 0.6706587}
confusion matrix:
     0    1
0  210    6
1  104  112
early stop counter: 2
val acc:0.6924882531166077, best validation acc: 0.8106416463851929, corresponding to test acc:                         0.7337962985038757 / 0.8356481194496155
after epoch: 7,now: 2024-07-23 04:58:35.101057,epoch time: 0:01:13.704624,used: 0:08:41.953548,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_04_49_53_seed_2_22779254
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9819079, 'precision': 0.9821578, 'recall': 0.981825, 'specificity': 0.981825, 'f1': 0.981902, 'auroc': 0.99890137, 'binary_precision': 0.9731114, 'binary_recall': 0.99151987, 'binary_specificity': 0.97213006, 'binary_f1_score': 0.9822294}
confusion matrix:
      0     1
0  1465    42
1    13  1520
---- Validation: 
scalar performance:
{'acc': 0.74413145, 'precision': 0.7533797, 'recall': 0.74138796, 'specificity': 0.74138796, 'f1': 0.74021083, 'auroc': 0.81981075, 'binary_precision': 0.7955912, 'binary_recall': 0.63826364, 'binary_specificity': 0.8445122, 'binary_f1_score': 0.7082962}
confusion matrix:
     0    1
0  554  102
1  225  397
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7337963, 'precision': 0.7603652, 'recall': 0.7337963, 'specificity': 0.7337963, 'f1': 0.7268274, 'auroc': 0.85360944, 'binary_precision': 0.677193, 'binary_recall': 0.8935185, 'binary_specificity': 0.5740741, 'binary_f1_score': 0.7704591}
confusion matrix:
     0    1
0  124   92
1   23  193
early stop counter: 3
val acc:0.7441314458847046, best validation acc: 0.8106416463851929, corresponding to test acc:                         0.7337962985038757 / 0.8356481194496155
after epoch: 8,now: 2024-07-23 04:59:49.041386,epoch time: 0:01:13.940329,used: 0:09:55.893877,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_04_49_53_seed_2_22779254
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9884868, 'precision': 0.98848224, 'recall': 0.9885015, 'specificity': 0.9885015, 'f1': 0.98848665, 'auroc': 0.9992503, 'binary_precision': 0.9908076, 'binary_recall': 0.9862745, 'binary_specificity': 0.9907285, 'binary_f1_score': 0.9885359}
confusion matrix:
      0     1
0  1496    14
1    21  1509
---- Validation: 
scalar performance:
{'acc': 0.7887324, 'precision': 0.80247974, 'recall': 0.7857913, 'specificity': 0.7857913, 'f1': 0.7850174, 'auroc': 0.8786174, 'binary_precision': 0.8606557, 'binary_recall': 0.6752412, 'binary_specificity': 0.89634144, 'binary_f1_score': 0.7567567}
confusion matrix:
     0    1
0  588   68
1  202  420
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7615741, 'precision': 0.77701735, 'recall': 0.76157403, 'specificity': 0.76157403, 'f1': 0.7582041, 'auroc': 0.8771434, 'binary_precision': 0.7116105, 'binary_recall': 0.8796296, 'binary_specificity': 0.6435185, 'binary_f1_score': 0.7867495}
confusion matrix:
     0    1
0  139   77
1   26  190
early stop counter: 4
val acc:0.7887324094772339, best validation acc: 0.8106416463851929, corresponding to test acc:                         0.7337962985038757 / 0.8356481194496155
after epoch: 9,now: 2024-07-23 05:01:02.792555,epoch time: 0:01:13.751169,used: 0:11:09.645046,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_04_49_53_seed_2_22779254
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.97960526, 'precision': 0.9801291, 'recall': 0.9797916, 'specificity': 0.9797916, 'f1': 0.9796035, 'auroc': 0.9993727, 'binary_precision': 0.9986459, 'binary_recall': 0.96091205, 'binary_specificity': 0.9986711, 'binary_f1_score': 0.97941566}
confusion matrix:
      0     1
0  1503     2
1    60  1475
---- Validation: 
scalar performance:
{'acc': 0.64162755, 'precision': 0.78312796, 'recall': 0.63199943, 'specificity': 0.63199943, 'f1': 0.58162093, 'auroc': 0.88686, 'binary_precision': 0.9767442, 'binary_recall': 0.27009645, 'binary_specificity': 0.99390244, 'binary_f1_score': 0.4231738}
confusion matrix:
     0    1
0  652    4
1  454  168
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5486111, 'precision': 0.72289926, 'recall': 0.5486111, 'specificity': 0.5486111, 'f1': 0.43893486, 'auroc': 0.7840364, 'binary_precision': 0.92, 'binary_recall': 0.106481485, 'binary_specificity': 0.9907407, 'binary_f1_score': 0.19087137}
confusion matrix:
     0   1
0  214   2
1  193  23
early stop counter: 5
val acc:0.6416275501251221, best validation acc: 0.8106416463851929, corresponding to test acc:                         0.7337962985038757 / 0.8356481194496155
after epoch: 10,now: 2024-07-23 05:02:17.472624,epoch time: 0:01:14.680069,used: 0:12:24.325115,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_04_49_53_seed_2_22779254
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.98914474, 'precision': 0.98915493, 'recall': 0.98913395, 'specificity': 0.98913395, 'f1': 0.9891435, 'auroc': 0.999165, 'binary_precision': 0.9882965, 'binary_recall': 0.990228, 'binary_specificity': 0.98803985, 'binary_f1_score': 0.9892613}
confusion matrix:
      0     1
0  1487    18
1    15  1520
---- Validation: 
scalar performance:
{'acc': 0.7824726, 'precision': 0.8269317, 'recall': 0.7774856, 'specificity': 0.7774856, 'f1': 0.7726223, 'auroc': 0.9030535, 'binary_precision': 0.9410256, 'binary_recall': 0.59003216, 'binary_specificity': 0.964939, 'binary_f1_score': 0.72529644}
confusion matrix:
     0    1
0  633   23
1  255  367
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7314815, 'precision': 0.768283, 'recall': 0.7314815, 'specificity': 0.7314815, 'f1': 0.721946, 'auroc': 0.81363595, 'binary_precision': 0.86764705, 'binary_recall': 0.5462963, 'binary_specificity': 0.9166667, 'binary_f1_score': 0.67045456}
confusion matrix:
     0    1
0  198   18
1   98  118
early stop counter: 6
val acc:0.7824726104736328, best validation acc: 0.8106416463851929, corresponding to test acc:                         0.7337962985038757 / 0.8356481194496155
after epoch: 11,now: 2024-07-23 05:03:30.772325,epoch time: 0:01:13.299701,used: 0:13:37.624816,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_04_49_53_seed_2_22779254
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.97335523, 'precision': 0.97420555, 'recall': 0.9732004, 'specificity': 0.9732004, 'f1': 0.9733354, 'auroc': 0.9987339, 'binary_precision': 0.95600253, 'binary_recall': 0.99281985, 'binary_specificity': 0.9535809, 'binary_f1_score': 0.9740634}
confusion matrix:
      0     1
0  1438    70
1    11  1521
---- Validation: 
scalar performance:
{'acc': 0.8028169, 'precision': 0.8069181, 'recall': 0.8011774, 'specificity': 0.8011774, 'f1': 0.80145097, 'auroc': 0.88088435, 'binary_precision': 0.8363636, 'binary_recall': 0.7395498, 'binary_specificity': 0.8628049, 'binary_f1_score': 0.78498286}
confusion matrix:
     0    1
0  566   90
1  162  460
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6990741, 'precision': 0.71034515, 'recall': 0.69907403, 'specificity': 0.69907403, 'f1': 0.69498813, 'auroc': 0.7851294, 'binary_precision': 0.6616541, 'binary_recall': 0.8148148, 'binary_specificity': 0.5833333, 'binary_f1_score': 0.7302904}
confusion matrix:
     0    1
0  126   90
1   40  176
early stop counter: 7
val acc:0.8028169274330139, best validation acc: 0.8106416463851929, corresponding to test acc:                         0.7337962985038757 / 0.8356481194496155
after epoch: 12,now: 2024-07-23 05:04:44.399431,epoch time: 0:01:13.627106,used: 0:14:51.251922,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_04_49_53_seed_2_22779254
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.98618424, 'precision': 0.98627967, 'recall': 0.9862561, 'specificity': 0.9862561, 'f1': 0.98618424, 'auroc': 0.9988408, 'binary_precision': 0.9953458, 'binary_recall': 0.9771541, 'binary_specificity': 0.9953581, 'binary_f1_score': 0.98616606}
confusion matrix:
      0     1
0  1501     7
1    35  1497
---- Validation: 
scalar performance:
{'acc': 0.79812205, 'precision': 0.8128741, 'recall': 0.795146, 'specificity': 0.795146, 'f1': 0.79448557, 'auroc': 0.8953097, 'binary_precision': 0.8744856, 'binary_recall': 0.68327975, 'binary_specificity': 0.9070122, 'binary_f1_score': 0.767148}
confusion matrix:
     0    1
0  595   61
1  197  425
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7523148, 'precision': 0.76376283, 'recall': 0.7523148, 'specificity': 0.7523148, 'f1': 0.7495978, 'auroc': 0.8656336, 'binary_precision': 0.8187134, 'binary_recall': 0.6481481, 'binary_specificity': 0.8564815, 'binary_f1_score': 0.7235142}
confusion matrix:
     0    1
0  185   31
1   76  140
early stop counter: 8
val acc:0.7981220483779907, best validation acc: 0.8106416463851929, corresponding to test acc:                         0.7337962985038757 / 0.8356481194496155
after epoch: 13,now: 2024-07-23 05:05:58.275897,epoch time: 0:01:13.876466,used: 0:16:05.128388,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_04_49_53_seed_2_22779254
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.99111843, 'precision': 0.99111056, 'recall': 0.9911431, 'specificity': 0.9911431, 'f1': 0.9911182, 'auroc': 0.99934375, 'binary_precision': 0.9940945, 'binary_recall': 0.9882583, 'binary_specificity': 0.99402785, 'binary_f1_score': 0.99116784}
confusion matrix:
      0     1
0  1498     9
1    18  1515
---- Validation: 
scalar performance:
{'acc': 0.7339593, 'precision': 0.7783893, 'recall': 0.7284796, 'specificity': 0.7284796, 'f1': 0.719726, 'auroc': 0.8601041, 'binary_precision': 0.8831522, 'binary_recall': 0.522508, 'binary_specificity': 0.9344512, 'binary_f1_score': 0.65656567}
confusion matrix:
     0    1
0  613   43
1  297  325
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7314815, 'precision': 0.73310024, 'recall': 0.73148143, 'specificity': 0.73148143, 'f1': 0.7310145, 'auroc': 0.81194276, 'binary_precision': 0.75252527, 'binary_recall': 0.6898148, 'binary_specificity': 0.7731481, 'binary_f1_score': 0.71980673}
confusion matrix:
     0    1
0  167   49
1   67  149
early stop counter: 9
val acc:0.7339593172073364, best validation acc: 0.8106416463851929, corresponding to test acc:                         0.7337962985038757 / 0.8356481194496155
after epoch: 14,now: 2024-07-23 05:07:11.695821,epoch time: 0:01:13.419924,used: 0:17:18.548312,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_04_49_53_seed_2_22779254
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.99013156, 'precision': 0.9901831, 'recall': 0.99020344, 'specificity': 0.99020344, 'f1': 0.99013156, 'auroc': 0.99958056, 'binary_precision': 0.99801326, 'binary_recall': 0.9823989, 'binary_specificity': 0.99800795, 'binary_f1_score': 0.99014455}
confusion matrix:
      0     1
0  1503     3
1    27  1507
---- Validation: 
scalar performance:
{'acc': 0.70500785, 'precision': 0.7952799, 'recall': 0.697487, 'specificity': 0.697487, 'f1': 0.6755644, 'auroc': 0.89461124, 'binary_precision': 0.9520295, 'binary_recall': 0.414791, 'binary_specificity': 0.98018295, 'binary_f1_score': 0.5778275}
confusion matrix:
     0    1
0  643   13
1  364  258
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5092593, 'precision': 0.60236967, 'recall': 0.5092593, 'specificity': 0.5092593, 'f1': 0.36482927, 'auroc': 0.7626243, 'binary_precision': 0.7, 'binary_recall': 0.032407407, 'binary_specificity': 0.9861111, 'binary_f1_score': 0.061946902}
confusion matrix:
     0  1
0  213  3
1  209  7
early stop counter: 10
val acc:0.7050078511238098, best validation acc: 0.8106416463851929, corresponding to test acc:                         0.7337962985038757 / 0.8356481194496155
after epoch: 15,now: 2024-07-23 05:08:25.149006,epoch time: 0:01:13.453185,used: 0:18:32.001497,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_04_49_53_seed_2_22779254
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9934211, 'precision': 0.9934112, 'recall': 0.9934334, 'specificity': 0.9934334, 'f1': 0.99342054, 'auroc': 0.99941087, 'binary_precision': 0.99477464, 'binary_recall': 0.99218243, 'binary_specificity': 0.9946844, 'binary_f1_score': 0.9934768}
confusion matrix:
      0     1
0  1497     8
1    12  1523
---- Validation: 
scalar performance:
{'acc': 0.60172147, 'precision': 0.7246703, 'recall': 0.5915443, 'specificity': 0.5915443, 'f1': 0.52663326, 'auroc': 0.81354654, 'binary_precision': 0.88435376, 'binary_recall': 0.20900321, 'binary_specificity': 0.9740854, 'binary_f1_score': 0.33810142}
confusion matrix:
     0    1
0  639   17
1  492  130
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5208333, 'precision': 0.5429499, 'recall': 0.5208333, 'specificity': 0.5208333, 'f1': 0.45003355, 'auroc': 0.6152263, 'binary_precision': 0.57377046, 'binary_recall': 0.16203703, 'binary_specificity': 0.8796296, 'binary_f1_score': 0.25270757}
confusion matrix:
     0   1
0  190  26
1  181  35
early stop counter: 11
val acc:0.601721465587616, best validation acc: 0.8106416463851929, corresponding to test acc:                         0.7337962985038757 / 0.8356481194496155
after epoch: 16,now: 2024-07-23 05:09:38.685372,epoch time: 0:01:13.536366,used: 0:19:45.537863,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_04_49_53_seed_2_22779254
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.99210525, 'precision': 0.9921, 'recall': 0.9921239, 'specificity': 0.9921239, 'f1': 0.9921051, 'auroc': 0.9997472, 'binary_precision': 0.9947472, 'binary_recall': 0.98954934, 'binary_specificity': 0.99469846, 'binary_f1_score': 0.9921415}
confusion matrix:
      0     1
0  1501     8
1    16  1515
---- Validation: 
scalar performance:
{'acc': 0.6643193, 'precision': 0.7904754, 'recall': 0.655353, 'specificity': 0.655353, 'f1': 0.61608315, 'auroc': 0.87889004, 'binary_precision': 0.97536945, 'binary_recall': 0.31832796, 'binary_specificity': 0.99237806, 'binary_f1_score': 0.48}
confusion matrix:
     0    1
0  651    5
1  424  198
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5115741, 'precision': 0.5991372, 'recall': 0.5115741, 'specificity': 0.5115741, 'f1': 0.3731596, 'auroc': 0.76101685, 'binary_precision': 0.6923077, 'binary_recall': 0.041666668, 'binary_specificity': 0.9814815, 'binary_f1_score': 0.07860262}
confusion matrix:
     0  1
0  212  4
1  207  9
early stop counter: 12
val acc:0.6643192768096924, best validation acc: 0.8106416463851929, corresponding to test acc:                         0.7337962985038757 / 0.8356481194496155
after epoch: 17,now: 2024-07-23 05:10:52.158526,epoch time: 0:01:13.473154,used: 0:20:59.011017,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_04_49_53_seed_2_22779254
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9894737, 'precision': 0.98961043, 'recall': 0.98955613, 'specificity': 0.98955613, 'f1': 0.9894736, 'auroc': 0.9996546, 'binary_precision': 1.0, 'binary_recall': 0.97911227, 'binary_specificity': 1.0, 'binary_f1_score': 0.9894459}
confusion matrix:
      0     1
0  1508     0
1    32  1500
---- Validation: 
scalar performance:
{'acc': 0.58685446, 'precision': 0.7621647, 'recall': 0.5756877, 'specificity': 0.5756877, 'f1': 0.4904014, 'auroc': 0.87642264, 'binary_precision': 0.97, 'binary_recall': 0.15594855, 'binary_specificity': 0.99542683, 'binary_f1_score': 0.26869807}
confusion matrix:
     0   1
0  653   3
1  525  97
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5023148, 'precision': 0.58391607, 'recall': 0.5023148, 'specificity': 0.5023148, 'f1': 0.34246576, 'auroc': 0.7326603, 'binary_precision': 0.6666667, 'binary_recall': 0.009259259, 'binary_specificity': 0.9953704, 'binary_f1_score': 0.01826484}
confusion matrix:
     0  1
0  215  1
1  214  2
early stop counter: 13
val acc:0.5868544578552246, best validation acc: 0.8106416463851929, corresponding to test acc:                         0.7337962985038757 / 0.8356481194496155
after epoch: 18,now: 2024-07-23 05:12:06.036762,epoch time: 0:01:13.878236,used: 0:22:12.889253,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_04_49_53_seed_2_22779254
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9782895, 'precision': 0.9789851, 'recall': 0.97845435, 'specificity': 0.97845435, 'f1': 0.97828573, 'auroc': 0.99943125, 'binary_precision': 0.9993188, 'binary_recall': 0.9575718, 'binary_specificity': 0.9993369, 'binary_f1_score': 0.978}
confusion matrix:
      0     1
0  1507     1
1    65  1467
---- Validation: 
scalar performance:
{'acc': 0.7652582, 'precision': 0.817533, 'recall': 0.75975907, 'specificity': 0.75975907, 'f1': 0.7525149, 'auroc': 0.90226805, 'binary_precision': 0.9398907, 'binary_recall': 0.5530547, 'binary_specificity': 0.9664634, 'binary_f1_score': 0.6963563}
confusion matrix:
     0    1
0  634   22
1  278  344
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7777778, 'precision': 0.81943214, 'recall': 0.7777778, 'specificity': 0.7777778, 'f1': 0.7702891, 'auroc': 0.8664695, 'binary_precision': 0.9347826, 'binary_recall': 0.5972222, 'binary_specificity': 0.9583333, 'binary_f1_score': 0.7288136}
confusion matrix:
     0    1
0  207    9
1   87  129
early stop counter: 14
val acc:0.7652581930160522, best validation acc: 0.8106416463851929, corresponding to test acc:                         0.7337962985038757 / 0.8356481194496155
after epoch: 19,now: 2024-07-23 05:13:19.764654,epoch time: 0:01:13.727892,used: 0:23:26.617145,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_04_49_53_seed_2_22779254
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9782895, 'precision': 0.9791777, 'recall': 0.97813225, 'specificity': 0.97813225, 'f1': 0.9782729, 'auroc': 0.999578, 'binary_precision': 0.96042717, 'binary_recall': 0.99804175, 'binary_specificity': 0.9582228, 'binary_f1_score': 0.97887325}
confusion matrix:
      0     1
0  1445    63
1     3  1529
---- Validation: 
scalar performance:
{'acc': 0.773083, 'precision': 0.79206467, 'recall': 0.7763803, 'specificity': 0.7763803, 'f1': 0.7706361, 'auroc': 0.8933368, 'binary_precision': 0.7106599, 'binary_recall': 0.90032154, 'binary_specificity': 0.652439, 'binary_f1_score': 0.79432625}
confusion matrix:
     0    1
0  428  228
1   62  560
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7106481, 'precision': 0.79002273, 'recall': 0.7106481, 'specificity': 0.7106481, 'f1': 0.68939626, 'auroc': 0.9050069, 'binary_precision': 0.63829786, 'binary_recall': 0.9722222, 'binary_specificity': 0.44907406, 'binary_f1_score': 0.7706421}
confusion matrix:
    0    1
0  97  119
1   6  210
early stop counter: 15
val acc:0.773082971572876, best validation acc: 0.8106416463851929, corresponding to test acc:                         0.7337962985038757 / 0.8356481194496155
after epoch: 20,now: 2024-07-23 05:14:33.245885,epoch time: 0:01:13.481231,used: 0:24:40.098376,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_04_49_53_seed_2_22779254
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9917763, 'precision': 0.9917663, 'recall': 0.9917908, 'specificity': 0.9917908, 'f1': 0.9917758, 'auroc': 0.99972296, 'binary_precision': 0.99345976, 'binary_recall': 0.9902216, 'binary_specificity': 0.9933599, 'binary_f1_score': 0.99183804}
confusion matrix:
      0     1
0  1496    10
1    15  1519
---- Validation: 
scalar performance:
{'acc': 0.7347418, 'precision': 0.7851571, 'recall': 0.72899187, 'specificity': 0.72899187, 'f1': 0.7191633, 'auroc': 0.857695, 'binary_precision': 0.8985916, 'binary_recall': 0.5128617, 'binary_specificity': 0.94512194, 'binary_f1_score': 0.6530195}
confusion matrix:
     0    1
0  620   36
1  303  319
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.662037, 'precision': 0.68633544, 'recall': 0.662037, 'specificity': 0.662037, 'f1': 0.65064806, 'auroc': 0.7834362, 'binary_precision': 0.7536232, 'binary_recall': 0.4814815, 'binary_specificity': 0.8425926, 'binary_f1_score': 0.5875706}
confusion matrix:
     0    1
0  182   34
1  112  104
early stop counter: 16
val acc:0.7347418069839478, best validation acc: 0.8106416463851929, corresponding to test acc:                         0.7337962985038757 / 0.8356481194496155
after epoch: 21,now: 2024-07-23 05:15:46.375860,epoch time: 0:01:13.129975,used: 0:25:53.228351,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_04_49_53_seed_2_22779254
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9924342, 'precision': 0.99249274, 'recall': 0.9924704, 'specificity': 0.9924704, 'f1': 0.99243414, 'auroc': 0.9998377, 'binary_precision': 0.9993364, 'binary_recall': 0.9856021, 'binary_specificity': 0.9993386, 'binary_f1_score': 0.99242175}
confusion matrix:
      0     1
0  1511     1
1    22  1506
---- Validation: 
scalar performance:
{'acc': 0.7089202, 'precision': 0.79730755, 'recall': 0.70150626, 'specificity': 0.70150626, 'f1': 0.6806897, 'auroc': 0.87550545, 'binary_precision': 0.95289856, 'binary_recall': 0.42282957, 'binary_specificity': 0.98018295, 'binary_f1_score': 0.5857461}
confusion matrix:
     0    1
0  643   13
1  359  263
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5810185, 'precision': 0.71705425, 'recall': 0.5810185, 'specificity': 0.5810185, 'f1': 0.50317377, 'auroc': 0.72845936, 'binary_precision': 0.8888889, 'binary_recall': 0.18518518, 'binary_specificity': 0.9768519, 'binary_f1_score': 0.3065134}
confusion matrix:
     0   1
0  211   5
1  176  40
early stop counter: 17
val acc:0.7089201807975769, best validation acc: 0.8106416463851929, corresponding to test acc:                         0.7337962985038757 / 0.8356481194496155
after epoch: 22,now: 2024-07-23 05:17:00.098513,epoch time: 0:01:13.722653,used: 0:27:06.951004,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_04_49_53_seed_2_22779254
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.99210525, 'precision': 0.99212873, 'recall': 0.99208784, 'specificity': 0.99208784, 'f1': 0.9921043, 'auroc': 0.9991486, 'binary_precision': 0.9902534, 'binary_recall': 0.9941292, 'binary_specificity': 0.99004644, 'binary_f1_score': 0.99218744}
confusion matrix:
      0     1
0  1492    15
1     9  1524
---- Validation: 
scalar performance:
{'acc': 0.7785602, 'precision': 0.796459, 'recall': 0.7751745, 'specificity': 0.7751745, 'f1': 0.7736089, 'auroc': 0.8691892, 'binary_precision': 0.86295503, 'binary_recall': 0.64790994, 'binary_specificity': 0.902439, 'binary_f1_score': 0.7401285}
confusion matrix:
     0    1
0  592   64
1  219  403
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7685185, 'precision': 0.771875, 'recall': 0.76851857, 'specificity': 0.76851857, 'f1': 0.7678019, 'auroc': 0.82130915, 'binary_precision': 0.8020833, 'binary_recall': 0.712963, 'binary_specificity': 0.8240741, 'binary_f1_score': 0.75490195}
confusion matrix:
     0    1
0  178   38
1   62  154
early stop counter: 18
val acc:0.778560221195221, best validation acc: 0.8106416463851929, corresponding to test acc:                         0.7337962985038757 / 0.8356481194496155
after epoch: 23,now: 2024-07-23 05:18:13.328581,epoch time: 0:01:13.230068,used: 0:28:20.181072,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_04_49_53_seed_2_22779254
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9934211, 'precision': 0.99343485, 'recall': 0.9934622, 'specificity': 0.9934622, 'f1': 0.9934211, 'auroc': 0.9998243, 'binary_precision': 0.9986807, 'binary_recall': 0.9882507, 'binary_specificity': 0.99867374, 'binary_f1_score': 0.99343836}
confusion matrix:
      0     1
0  1506     2
1    18  1514
---- Validation: 
scalar performance:
{'acc': 0.76134586, 'precision': 0.8162363, 'recall': 0.7556981, 'specificity': 0.7556981, 'f1': 0.74772096, 'auroc': 0.8847835, 'binary_precision': 0.9415042, 'binary_recall': 0.54340833, 'binary_specificity': 0.9679878, 'binary_f1_score': 0.68909276}
confusion matrix:
     0    1
0  635   21
1  284  338
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6527778, 'precision': 0.6988839, 'recall': 0.6527778, 'specificity': 0.6527778, 'f1': 0.6314161, 'auroc': 0.78047836, 'binary_precision': 0.79464287, 'binary_recall': 0.41203704, 'binary_specificity': 0.8935185, 'binary_f1_score': 0.5426829}
confusion matrix:
     0   1
0  193  23
1  127  89
early stop counter: 19
val acc:0.7613458633422852, best validation acc: 0.8106416463851929, corresponding to test acc:                         0.7337962985038757 / 0.8356481194496155
after epoch: 24,now: 2024-07-23 05:19:26.651477,epoch time: 0:01:13.322896,used: 0:29:33.503968,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_04_49_53_seed_2_22779254
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.9904605, 'precision': 0.9904789, 'recall': 0.9905041, 'specificity': 0.9905041, 'f1': 0.9904605, 'auroc': 0.9997468, 'binary_precision': 0.9960396, 'binary_recall': 0.98498696, 'binary_specificity': 0.9960212, 'binary_f1_score': 0.99048245}
confusion matrix:
      0     1
0  1502     6
1    23  1509
---- Validation: 
scalar performance:
{'acc': 0.7300469, 'precision': 0.80695665, 'recall': 0.7232521, 'specificity': 0.7232521, 'f1': 0.7080227, 'auroc': 0.8953514, 'binary_precision': 0.95409834, 'binary_recall': 0.46784565, 'binary_specificity': 0.97865856, 'binary_f1_score': 0.6278317}
confusion matrix:
     0    1
0  642   14
1  331  291
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5486111, 'precision': 0.6551831, 'recall': 0.5486111, 'specificity': 0.5486111, 'f1': 0.45505002, 'auroc': 0.80939215, 'binary_precision': 0.7837838, 'binary_recall': 0.13425925, 'binary_specificity': 0.962963, 'binary_f1_score': 0.22924902}
confusion matrix:
     0   1
0  208   8
1  187  29
early stop counter: 20
val acc:0.7300469279289246, best validation acc: 0.8106416463851929, corresponding to test acc:                         0.7337962985038757 / 0.8356481194496155
after epoch: 25,now: 2024-07-23 05:20:39.907934,epoch time: 0:01:13.256457,used: 0:30:46.760425,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_04_49_53_seed_2_22779254
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9917763, 'precision': 0.99183065, 'recall': 0.9918356, 'specificity': 0.9918356, 'f1': 0.9917763, 'auroc': 0.9998723, 'binary_precision': 0.9993373, 'binary_recall': 0.98433423, 'binary_specificity': 0.9993369, 'binary_f1_score': 0.991779}
confusion matrix:
      0     1
0  1507     1
1    24  1508
---- Validation: 
scalar performance:
{'acc': 0.685446, 'precision': 0.79215014, 'recall': 0.67722386, 'specificity': 0.67722386, 'f1': 0.6477649, 'auroc': 0.8842119, 'binary_precision': 0.96218485, 'binary_recall': 0.3681672, 'binary_specificity': 0.9862805, 'binary_f1_score': 0.5325581}
confusion matrix:
     0    1
0  647    9
1  393  229
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.537037, 'precision': 0.6102041, 'recall': 0.537037, 'specificity': 0.537037, 'f1': 0.4449013, 'auroc': 0.7576089, 'binary_precision': 0.7, 'binary_recall': 0.12962963, 'binary_specificity': 0.9444444, 'binary_f1_score': 0.21875}
confusion matrix:
     0   1
0  204  12
1  188  28
early stop counter: 21
val acc:0.68544602394104, best validation acc: 0.8106416463851929, corresponding to test acc:                         0.7337962985038757 / 0.8356481194496155
after epoch: 26,now: 2024-07-23 05:21:53.952556,epoch time: 0:01:14.044622,used: 0:32:00.805047,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_04_49_53_seed_2_22779254
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.9934211, 'precision': 0.9934331, 'recall': 0.99345106, 'specificity': 0.99345106, 'f1': 0.9934211, 'auroc': 0.99977756, 'binary_precision': 0.9980211, 'binary_recall': 0.98888886, 'binary_specificity': 0.99801326, 'binary_f1_score': 0.993434}
confusion matrix:
      0     1
0  1507     3
1    17  1513
---- Validation: 
scalar performance:
{'acc': 0.6087637, 'precision': 0.73529375, 'recall': 0.5986957, 'specificity': 0.5986957, 'f1': 0.53671074, 'auroc': 0.83262646, 'binary_precision': 0.9013158, 'binary_recall': 0.22025724, 'binary_specificity': 0.97713417, 'binary_f1_score': 0.35400516}
confusion matrix:
     0    1
0  641   15
1  485  137
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6064815, 'precision': 0.68361914, 'recall': 0.6064815, 'specificity': 0.6064815, 'f1': 0.56030273, 'auroc': 0.86008227, 'binary_precision': 0.80263156, 'binary_recall': 0.2824074, 'binary_specificity': 0.9305556, 'binary_f1_score': 0.41780823}
confusion matrix:
     0   1
0  201  15
1  155  61
early stop counter: 22
val acc:0.6087636947631836, best validation acc: 0.8106416463851929, corresponding to test acc:                         0.7337962985038757 / 0.8356481194496155
after epoch: 27,now: 2024-07-23 05:23:08.073613,epoch time: 0:01:14.121057,used: 0:33:14.926104,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_04_49_53_seed_2_22779254
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.9875, 'precision': 0.9877261, 'recall': 0.98758173, 'specificity': 0.98758173, 'f1': 0.98749954, 'auroc': 0.9996927, 'binary_precision': 1.0, 'binary_recall': 0.9751634, 'binary_specificity': 1.0, 'binary_f1_score': 0.9874255}
confusion matrix:
      0     1
0  1510     0
1    38  1492
---- Validation: 
scalar performance:
{'acc': 0.6658842, 'precision': 0.7934036, 'recall': 0.65691906, 'specificity': 0.65691906, 'f1': 0.617873, 'auroc': 0.868919, 'binary_precision': 0.98029554, 'binary_recall': 0.31993568, 'binary_specificity': 0.99390244, 'binary_f1_score': 0.4824242}
confusion matrix:
     0    1
0  652    4
1  423  199
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5416667, 'precision': 0.73592234, 'recall': 0.5416667, 'specificity': 0.5416667, 'f1': 0.42286518, 'auroc': 0.81863, 'binary_precision': 0.95, 'binary_recall': 0.08796296, 'binary_specificity': 0.9953704, 'binary_f1_score': 0.16101694}
confusion matrix:
     0   1
0  215   1
1  197  19
early stop counter: 23
val acc:0.6658841967582703, best validation acc: 0.8106416463851929, corresponding to test acc:                         0.7337962985038757 / 0.8356481194496155
after epoch: 28,now: 2024-07-23 05:24:21.121114,epoch time: 0:01:13.047501,used: 0:34:27.973605,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_04_49_53_seed_2_22779254
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9970395, 'precision': 0.9970554, 'recall': 0.9970285, 'specificity': 0.9970285, 'f1': 0.9970393, 'auroc': 0.999961, 'binary_precision': 0.99543977, 'binary_recall': 0.9986928, 'binary_specificity': 0.99536425, 'binary_f1_score': 0.99706364}
confusion matrix:
      0     1
0  1503     7
1     2  1528
---- Validation: 
scalar performance:
{'acc': 0.7918623, 'precision': 0.8361824, 'recall': 0.78696525, 'specificity': 0.78696525, 'f1': 0.7827308, 'auroc': 0.91380763, 'binary_precision': 0.9517766, 'binary_recall': 0.6028939, 'binary_specificity': 0.9710366, 'binary_f1_score': 0.7381889}
confusion matrix:
     0    1
0  637   19
1  247  375
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7662037, 'precision': 0.8236482, 'recall': 0.76620376, 'specificity': 0.76620376, 'f1': 0.75534785, 'auroc': 0.90554273, 'binary_precision': 0.96, 'binary_recall': 0.5555556, 'binary_specificity': 0.9768519, 'binary_f1_score': 0.7038123}
confusion matrix:
     0    1
0  211    5
1   96  120
early stop counter: 24
val acc:0.7918623089790344, best validation acc: 0.8106416463851929, corresponding to test acc:                         0.7337962985038757 / 0.8356481194496155
after epoch: 29,now: 2024-07-23 05:25:34.220242,epoch time: 0:01:13.099128,used: 0:35:41.072733,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_04_49_53_seed_2_22779254
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.9963816, 'precision': 0.99639094, 'recall': 0.99637353, 'specificity': 0.99637353, 'f1': 0.9963813, 'auroc': 0.9999273, 'binary_precision': 0.99543977, 'binary_recall': 0.997389, 'binary_specificity': 0.9953581, 'binary_f1_score': 0.9964134}
confusion matrix:
      0     1
0  1501     7
1     4  1528
---- Validation: 
scalar performance:
{'acc': 0.80046946, 'precision': 0.8422389, 'recall': 0.795766, 'specificity': 0.795766, 'f1': 0.79233086, 'auroc': 0.9090439, 'binary_precision': 0.95533496, 'binary_recall': 0.61897105, 'binary_specificity': 0.972561, 'binary_f1_score': 0.7512195}
confusion matrix:
     0    1
0  638   18
1  237  385
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6064815, 'precision': 0.73594224, 'recall': 0.6064815, 'specificity': 0.6064815, 'f1': 0.54391897, 'auroc': 0.83320475, 'binary_precision': 0.91071427, 'binary_recall': 0.2361111, 'binary_specificity': 0.9768519, 'binary_f1_score': 0.375}
confusion matrix:
     0   1
0  211   5
1  165  51
early stop counter: 25
val acc:0.8004694581031799, best validation acc: 0.8106416463851929, corresponding to test acc:                         0.7337962985038757 / 0.8356481194496155
after epoch: 30,now: 2024-07-23 05:26:47.337668,epoch time: 0:01:13.117426,used: 0:36:54.190159,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_04_49_53_seed_2_22779254
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 0:36:54.190159 at 2024-07-23 05:26:47.337668
persisted model performance metric: 

scalar performance:
{'acc': 0.7337963, 'precision': 0.7816058, 'recall': 0.7337963, 'specificity': 0.7337963, 'f1': 0.72199684, 'auroc': 0.8975909, 'binary_precision': 0.6655738, 'binary_recall': 0.9398148, 'binary_specificity': 0.5277778, 'binary_f1_score': 0.77927065}
confusion matrix:
     0    1
0  114  102
1   13  203
oracle model performance metric: 

scalar performance:
{'acc': 0.8356481, 'precision': 0.83565533, 'recall': 0.8356482, 'specificity': 0.8356482, 'f1': 0.8356473, 'auroc': 0.904621, 'binary_precision': 0.8341014, 'binary_recall': 0.837963, 'binary_specificity': 0.8333333, 'binary_f1_score': 0.83602774}
confusion matrix:
     0    1
0  180   36
1   35  181
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_dial_lr1e5_bs32_nofreeze_2024-07-23_01-16-41/rule_results/2.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_dial_lr1e5_bs32_nofreeze_2024-07-23_01-16-41/confusion_matrix/2.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 451685 KiB |  26075 MiB | 215765 GiB | 215764 GiB |
|       from large pool | 411132 KiB |  26030 MiB | 214419 GiB | 214418 GiB |
|       from small pool |  40553 KiB |     60 MiB |   1346 GiB |   1346 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 451685 KiB |  26075 MiB | 215765 GiB | 215764 GiB |
|       from large pool | 411132 KiB |  26030 MiB | 214419 GiB | 214418 GiB |
|       from small pool |  40553 KiB |     60 MiB |   1346 GiB |   1346 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 447481 KiB |  26071 MiB | 215724 GiB | 215724 GiB |
|       from large pool | 407075 KiB |  26026 MiB | 214381 GiB | 214380 GiB |
|       from small pool |  40406 KiB |     60 MiB |   1343 GiB |   1343 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  27778 MiB |  27778 MiB |  80916 MiB |  53138 MiB |
|       from large pool |  27710 MiB |  27710 MiB |  80820 MiB |  53110 MiB |
|       from small pool |     68 MiB |     72 MiB |     96 MiB |     28 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 775066 KiB |   1679 MiB |  97330 GiB |  97329 GiB |
|       from large pool | 758276 KiB |   1676 MiB |  95974 GiB |  95973 GiB |
|       from small pool |  16790 KiB |     35 MiB |   1355 GiB |   1355 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    1220    |    2570    |   19515 K  |   19513 K  |
|       from large pool |     187    |    1413    |    9879 K  |    9879 K  |
|       from small pool |    1033    |    1335    |    9635 K  |    9634 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    1220    |    2570    |   19515 K  |   19513 K  |
|       from large pool |     187    |    1413    |    9879 K  |    9879 K  |
|       from small pool |    1033    |    1335    |    9635 K  |    9634 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     837    |     837    |    2370    |    1533    |
|       from large pool |     803    |     803    |    2322    |    1519    |
|       from small pool |      34    |      36    |      48    |      14    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     110    |     851    |   14223 K  |   14223 K  |
|       from large pool |      47    |     805    |    8786 K  |    8785 K  |
|       from small pool |      63    |     146    |    5437 K  |    5437 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  26075 MiB | 215765 GiB | 215765 GiB |
|       from large pool |  16640 KiB |  26030 MiB | 214419 GiB | 214419 GiB |
|       from small pool |      0 KiB |     60 MiB |   1346 GiB |   1346 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  26075 MiB | 215765 GiB | 215765 GiB |
|       from large pool |  16640 KiB |  26030 MiB | 214419 GiB | 214419 GiB |
|       from small pool |      0 KiB |     60 MiB |   1346 GiB |   1346 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  26071 MiB | 215724 GiB | 215724 GiB |
|       from large pool |  16640 KiB |  26026 MiB | 214381 GiB | 214381 GiB |
|       from small pool |      0 KiB |     60 MiB |   1343 GiB |   1343 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1198 MiB |  27778 MiB |  80916 MiB |  79718 MiB |
|       from large pool |   1142 MiB |  27710 MiB |  80820 MiB |  79678 MiB |
|       from small pool |     56 MiB |     72 MiB |     96 MiB |     40 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |   3840 KiB |   1679 MiB |  97330 GiB |  97330 GiB |
|       from large pool |   3840 KiB |   1676 MiB |  95974 GiB |  95974 GiB |
|       from small pool |      0 KiB |     35 MiB |   1355 GiB |   1355 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    2570    |   19515 K  |   19515 K  |
|       from large pool |       2    |    1413    |    9879 K  |    9879 K  |
|       from small pool |       0    |    1335    |    9635 K  |    9635 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    2570    |   19515 K  |   19515 K  |
|       from large pool |       2    |    1413    |    9879 K  |    9879 K  |
|       from small pool |       0    |    1335    |    9635 K  |    9635 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      71    |     837    |    2370    |    2299    |
|       from large pool |      43    |     803    |    2322    |    2279    |
|       from small pool |      28    |      36    |      48    |      20    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       1    |     851    |   14223 K  |   14223 K  |
|       from large pool |       1    |     805    |    8786 K  |    8786 K  |
|       from small pool |       0    |     146    |    5437 K  |    5437 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Tue Jul 23 05:27:33 2024]
Finished job 0.
1 of 1 steps (100%) done
