Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Sat Jul 20 11:15:53 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_nofreeze_2024-07-19_18-41-07/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_nofreeze_2024-07-19_18-41-07/rule_results/3.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=3
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/swiglu_ffn.py:51: UserWarning: xFormers is not available (SwiGLU)
  warnings.warn("xFormers is not available (SwiGLU)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/attention.py:33: UserWarning: xFormers is not available (Attention)
  warnings.warn("xFormers is not available (Attention)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/block.py:40: UserWarning: xFormers is not available (Block)
  warnings.warn("xFormers is not available (Block)")
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'888c1ef2'
model name: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_11_19_17_seed_0_22478448

 Experiment start at: 2024-07-20 11:19:17.809601
before training, model accuracy: 0.569767415523529
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9472656, 'precision': 0.94729054, 'recall': 0.9473542, 'specificity': 0.9473542, 'f1': 0.94726455, 'auroc': 0.98761094, 'binary_precision': 0.95493144, 'binary_recall': 0.94019294, 'binary_specificity': 0.9545155, 'binary_f1_score': 0.9475049}
confusion matrix:
      0     1
0  1448    69
1    93  1462
---- Validation: 
scalar performance:
{'acc': 0.83229816, 'precision': 0.83912826, 'recall': 0.83328545, 'specificity': 0.83328545, 'f1': 0.83171225, 'auroc': 0.9174278, 'binary_precision': 0.78738, 'binary_recall': 0.903937, 'binary_specificity': 0.762634, 'binary_f1_score': 0.8416422}
confusion matrix:
     0    1
0  498  155
1   61  574
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.83255816, 'precision': 0.8500034, 'recall': 0.83255816, 'specificity': 0.83255816, 'f1': 0.8304453, 'auroc': 0.94239044, 'binary_precision': 0.7718631, 'binary_recall': 0.94418603, 'binary_specificity': 0.7209302, 'binary_f1_score': 0.8493723}
confusion matrix:
     0    1
0  155   60
1   12  203
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-20 11:20:45.701022,epoch time: 0:01:27.891421,used: 0:01:27.891421,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_11_19_17_seed_0_22478448
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9654948, 'precision': 0.9659298, 'recall': 0.9657465, 'specificity': 0.9657465, 'f1': 0.96549386, 'auroc': 0.9926833, 'binary_precision': 0.9839893, 'binary_recall': 0.94733465, 'binary_specificity': 0.9841584, 'binary_f1_score': 0.96531415}
confusion matrix:
      0     1
0  1491    24
1    82  1475
---- Validation: 
scalar performance:
{'acc': 0.71040374, 'precision': 0.7106219, 'recall': 0.71007586, 'specificity': 0.71007586, 'f1': 0.7100806, 'auroc': 0.7854216, 'binary_precision': 0.7147541, 'binary_recall': 0.68661416, 'binary_specificity': 0.7335375, 'binary_f1_score': 0.7004016}
confusion matrix:
     0    1
0  479  174
1  199  436
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8023256, 'precision': 0.8126118, 'recall': 0.8023256, 'specificity': 0.8023256, 'f1': 0.800686, 'auroc': 0.9125148, 'binary_precision': 0.7559055, 'binary_recall': 0.89302325, 'binary_specificity': 0.7116279, 'binary_f1_score': 0.8187633}
confusion matrix:
     0    1
0  153   62
1   23  192
early stop counter: 1
val acc:0.7104037404060364, best validation acc: 0.8322981595993042, corresponding to test acc:                         0.8325581550598145 / 0.8325581550598145
after epoch: 2,now: 2024-07-20 11:21:47.937922,epoch time: 0:01:02.236900,used: 0:02:30.128321,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_11_19_17_seed_0_22478448
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.97721356, 'precision': 0.97727, 'recall': 0.97734284, 'specificity': 0.97734284, 'f1': 0.9772132, 'auroc': 0.9971546, 'binary_precision': 0.9869024, 'binary_recall': 0.967887, 'binary_specificity': 0.9867987, 'binary_f1_score': 0.97730225}
confusion matrix:
      0     1
0  1495    20
1    50  1507
---- Validation: 
scalar performance:
{'acc': 0.8470497, 'precision': 0.8524009, 'recall': 0.8461842, 'specificity': 0.8461842, 'f1': 0.84621304, 'auroc': 0.9089098, 'binary_precision': 0.8924731, 'binary_recall': 0.784252, 'binary_specificity': 0.9081164, 'binary_f1_score': 0.83487004}
confusion matrix:
     0    1
0  593   60
1  137  498
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.81395346, 'precision': 0.81861293, 'recall': 0.8139535, 'specificity': 0.8139535, 'f1': 0.8132708, 'auroc': 0.8878962, 'binary_precision': 0.85714287, 'binary_recall': 0.75348836, 'binary_specificity': 0.8744186, 'binary_f1_score': 0.80198026}
confusion matrix:
     0    1
0  188   27
1   53  162
better model found
persisted
after epoch: 3,now: 2024-07-20 11:22:50.312847,epoch time: 0:01:02.374925,used: 0:03:32.503246,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_11_19_17_seed_0_22478448
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9746094, 'precision': 0.97485566, 'recall': 0.9748001, 'specificity': 0.9748001, 'f1': 0.97460926, 'auroc': 0.997782, 'binary_precision': 0.98940396, 'binary_recall': 0.96015424, 'binary_specificity': 0.9894459, 'binary_f1_score': 0.9745596}
confusion matrix:
      0     1
0  1500    16
1    62  1494
---- Validation: 
scalar performance:
{'acc': 0.8082298, 'precision': 0.8261471, 'recall': 0.8065753, 'specificity': 0.8065753, 'f1': 0.80495083, 'auroc': 0.90445554, 'binary_precision': 0.89917696, 'binary_recall': 0.68818897, 'binary_specificity': 0.9249617, 'binary_f1_score': 0.77966106}
confusion matrix:
     0    1
0  604   49
1  198  437
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8697674, 'precision': 0.88169086, 'recall': 0.8697674, 'specificity': 0.8697674, 'f1': 0.86874235, 'auroc': 0.9351217, 'binary_precision': 0.9491525, 'binary_recall': 0.7813954, 'binary_specificity': 0.95813954, 'binary_f1_score': 0.85714287}
confusion matrix:
     0    1
0  206    9
1   47  168
new oracle model saved
early stop counter: 1
val acc:0.8082298040390015, best validation acc: 0.8470497131347656, corresponding to test acc:                         0.8139534592628479 / 0.869767427444458
after epoch: 4,now: 2024-07-20 11:23:53.062545,epoch time: 0:01:02.749698,used: 0:04:35.252944,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_11_19_17_seed_0_22478448
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.98535156, 'precision': 0.98545253, 'recall': 0.9852889, 'specificity': 0.9852889, 'f1': 0.98534715, 'auroc': 0.99789274, 'binary_precision': 0.9808917, 'binary_recall': 0.9903537, 'binary_specificity': 0.98022413, 'binary_f1_score': 0.9856}
confusion matrix:
      0     1
0  1487    30
1    15  1540
---- Validation: 
scalar performance:
{'acc': 0.8385093, 'precision': 0.8385302, 'recall': 0.83841264, 'specificity': 0.83841264, 'f1': 0.83845323, 'auroc': 0.9052586, 'binary_precision': 0.83942765, 'binary_recall': 0.83149606, 'binary_specificity': 0.8453292, 'binary_f1_score': 0.835443}
confusion matrix:
     0    1
0  552  101
1  107  528
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.81395346, 'precision': 0.8141982, 'recall': 0.8139535, 'specificity': 0.8139535, 'f1': 0.8139173, 'auroc': 0.9108058, 'binary_precision': 0.8054299, 'binary_recall': 0.82790697, 'binary_specificity': 0.8, 'binary_f1_score': 0.8165138}
confusion matrix:
     0    1
0  172   43
1   37  178
early stop counter: 2
val acc:0.8385093212127686, best validation acc: 0.8470497131347656, corresponding to test acc:                         0.8139534592628479 / 0.869767427444458
after epoch: 5,now: 2024-07-20 11:24:55.386602,epoch time: 0:01:02.324057,used: 0:05:37.577001,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_11_19_17_seed_0_22478448
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9847005, 'precision': 0.9846815, 'recall': 0.9847425, 'specificity': 0.9847425, 'f1': 0.98469937, 'auroc': 0.99895287, 'binary_precision': 0.988342, 'binary_recall': 0.9813505, 'binary_specificity': 0.9881345, 'binary_f1_score': 0.98483384}
confusion matrix:
      0     1
0  1499    18
1    29  1526
---- Validation: 
scalar performance:
{'acc': 0.64285713, 'precision': 0.735042, 'recall': 0.638403, 'specificity': 0.638403, 'f1': 0.5999082, 'auroc': 0.7786063, 'binary_precision': 0.8787879, 'binary_recall': 0.31968504, 'binary_specificity': 0.95712095, 'binary_f1_score': 0.46882215}
confusion matrix:
     0    1
0  625   28
1  432  203
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8581395, 'precision': 0.8832176, 'recall': 0.8581395, 'specificity': 0.8581395, 'f1': 0.85578, 'auroc': 0.92588425, 'binary_precision': 0.98125, 'binary_recall': 0.73023254, 'binary_specificity': 0.9860465, 'binary_f1_score': 0.8373333}
confusion matrix:
     0    1
0  212    3
1   58  157
early stop counter: 3
val acc:0.6428571343421936, best validation acc: 0.8470497131347656, corresponding to test acc:                         0.8139534592628479 / 0.869767427444458
after epoch: 6,now: 2024-07-20 11:25:57.870482,epoch time: 0:01:02.483880,used: 0:06:40.060881,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_11_19_17_seed_0_22478448
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.98828125, 'precision': 0.9882982, 'recall': 0.98826337, 'specificity': 0.98826337, 'f1': 0.9882791, 'auroc': 0.9993086, 'binary_precision': 0.9871713, 'binary_recall': 0.9897106, 'binary_specificity': 0.9868161, 'binary_f1_score': 0.9884393}
confusion matrix:
      0     1
0  1497    20
1    16  1539
---- Validation: 
scalar performance:
{'acc': 0.8291925, 'precision': 0.8294177, 'recall': 0.8289856, 'specificity': 0.8289856, 'f1': 0.8290734, 'auroc': 0.89203316, 'binary_precision': 0.8352181, 'binary_recall': 0.8141732, 'binary_specificity': 0.84379786, 'binary_f1_score': 0.82456136}
confusion matrix:
     0    1
0  551  102
1  118  517
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8418605, 'precision': 0.8419788, 'recall': 0.8418605, 'specificity': 0.8418605, 'f1': 0.84184676, 'auroc': 0.91816115, 'binary_precision': 0.8356164, 'binary_recall': 0.8511628, 'binary_specificity': 0.83255816, 'binary_f1_score': 0.8433179}
confusion matrix:
     0    1
0  179   36
1   32  183
early stop counter: 4
val acc:0.8291925191879272, best validation acc: 0.8470497131347656, corresponding to test acc:                         0.8139534592628479 / 0.869767427444458
after epoch: 7,now: 2024-07-20 11:27:00.210538,epoch time: 0:01:02.340056,used: 0:07:42.400937,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_11_19_17_seed_0_22478448
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9814453, 'precision': 0.98173, 'recall': 0.98166, 'specificity': 0.98166, 'f1': 0.9814452, 'auroc': 0.9987227, 'binary_precision': 0.9973475, 'binary_recall': 0.9659602, 'binary_specificity': 0.99735975, 'binary_f1_score': 0.981403}
confusion matrix:
      0     1
0  1511     4
1    53  1504
---- Validation: 
scalar performance:
{'acc': 0.73680127, 'precision': 0.7811906, 'recall': 0.73398244, 'specificity': 0.73398244, 'f1': 0.72442067, 'auroc': 0.8648828, 'binary_precision': 0.8894737, 'binary_recall': 0.5322835, 'binary_specificity': 0.93568146, 'binary_f1_score': 0.66600984}
confusion matrix:
     0    1
0  611   42
1  297  338
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8581395, 'precision': 0.86387813, 'recall': 0.8581395, 'specificity': 0.8581395, 'f1': 0.857578, 'auroc': 0.9272904, 'binary_precision': 0.90957445, 'binary_recall': 0.7953488, 'binary_specificity': 0.9209302, 'binary_f1_score': 0.8486352}
confusion matrix:
     0    1
0  198   17
1   44  171
early stop counter: 5
val acc:0.736801266670227, best validation acc: 0.8470497131347656, corresponding to test acc:                         0.8139534592628479 / 0.869767427444458
after epoch: 8,now: 2024-07-20 11:28:02.963513,epoch time: 0:01:02.752975,used: 0:08:45.153912,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_11_19_17_seed_0_22478448
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.98567706, 'precision': 0.9858134, 'recall': 0.9855983, 'specificity': 0.9855983, 'f1': 0.985672, 'auroc': 0.99933314, 'binary_precision': 0.98030496, 'binary_recall': 0.9916452, 'binary_specificity': 0.97955143, 'binary_f1_score': 0.9859425}
confusion matrix:
      0     1
0  1485    31
1    13  1543
---- Validation: 
scalar performance:
{'acc': 0.79658383, 'precision': 0.82484365, 'recall': 0.79450387, 'specificity': 0.79450387, 'f1': 0.7912438, 'auroc': 0.90867347, 'binary_precision': 0.91722596, 'binary_recall': 0.6456693, 'binary_specificity': 0.94333845, 'binary_f1_score': 0.7578558}
confusion matrix:
     0    1
0  616   37
1  225  410
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8534884, 'precision': 0.86821705, 'recall': 0.8534883, 'specificity': 0.8534883, 'f1': 0.85200846, 'auroc': 0.9221201, 'binary_precision': 0.94186044, 'binary_recall': 0.75348836, 'binary_specificity': 0.95348835, 'binary_f1_score': 0.8372093}
confusion matrix:
     0    1
0  205   10
1   53  162
early stop counter: 6
val acc:0.7965838313102722, best validation acc: 0.8470497131347656, corresponding to test acc:                         0.8139534592628479 / 0.869767427444458
after epoch: 9,now: 2024-07-20 11:29:05.069142,epoch time: 0:01:02.105629,used: 0:09:47.259541,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_11_19_17_seed_0_22478448
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9482422, 'precision': 0.95248055, 'recall': 0.94897306, 'specificity': 0.94897306, 'f1': 0.9481695, 'auroc': 0.9985628, 'binary_precision': 1.0, 'binary_recall': 0.89794606, 'binary_specificity': 1.0, 'binary_f1_score': 0.9462292}
confusion matrix:
      0     1
0  1514     0
1   159  1399
---- Validation: 
scalar performance:
{'acc': 0.51552796, 'precision': 0.6890285, 'recall': 0.50870484, 'specificity': 0.50870484, 'f1': 0.3580062, 'auroc': 0.877002, 'binary_precision': 0.8666667, 'binary_recall': 0.02047244, 'binary_specificity': 0.9969372, 'binary_f1_score': 0.04}
confusion matrix:
     0   1
0  651   2
1  622  13
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5534884, 'precision': 0.76412773, 'recall': 0.5534884, 'specificity': 0.5534884, 'f1': 0.44229782, 'auroc': 0.89319634, 'binary_precision': 1.0, 'binary_recall': 0.10697675, 'binary_specificity': 1.0, 'binary_f1_score': 0.19327731}
confusion matrix:
     0   1
0  215   0
1  192  23
early stop counter: 7
val acc:0.5155279636383057, best validation acc: 0.8470497131347656, corresponding to test acc:                         0.8139534592628479 / 0.869767427444458
after epoch: 10,now: 2024-07-20 11:30:07.107118,epoch time: 0:01:02.037976,used: 0:10:49.297517,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_11_19_17_seed_0_22478448
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9847005, 'precision': 0.9848548, 'recall': 0.98460877, 'specificity': 0.98460877, 'f1': 0.98469406, 'auroc': 0.9988071, 'binary_precision': 0.9790742, 'binary_recall': 0.9910141, 'binary_specificity': 0.9782034, 'binary_f1_score': 0.985008}
confusion matrix:
      0     1
0  1481    33
1    14  1544
---- Validation: 
scalar performance:
{'acc': 0.86490685, 'precision': 0.86634815, 'recall': 0.8644681, 'specificity': 0.8644681, 'f1': 0.86465096, 'auroc': 0.92253315, 'binary_precision': 0.88609713, 'binary_recall': 0.8330709, 'binary_specificity': 0.89586526, 'binary_f1_score': 0.85876626}
confusion matrix:
     0    1
0  585   68
1  106  529
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.872093, 'precision': 0.8721655, 'recall': 0.872093, 'specificity': 0.872093, 'f1': 0.87208676, 'auroc': 0.9421958, 'binary_precision': 0.8773585, 'binary_recall': 0.8651163, 'binary_specificity': 0.87906975, 'binary_f1_score': 0.87119436}
confusion matrix:
     0    1
0  189   26
1   29  186
new oracle model saved
better model found
persisted
after epoch: 11,now: 2024-07-20 11:31:09.943710,epoch time: 0:01:02.836592,used: 0:11:52.134109,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_11_19_17_seed_0_22478448
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9905599, 'precision': 0.9905491, 'recall': 0.9906304, 'specificity': 0.9906304, 'f1': 0.99055934, 'auroc': 0.9997054, 'binary_precision': 0.9961014, 'binary_recall': 0.9852185, 'binary_specificity': 0.9960422, 'binary_f1_score': 0.9906301}
confusion matrix:
      0     1
0  1510     6
1    23  1533
---- Validation: 
scalar performance:
{'acc': 0.83928573, 'precision': 0.85095155, 'recall': 0.83800626, 'specificity': 0.83800626, 'f1': 0.83755356, 'auroc': 0.92327595, 'binary_precision': 0.9115385, 'binary_recall': 0.7464567, 'binary_specificity': 0.9295559, 'binary_f1_score': 0.82077914}
confusion matrix:
     0    1
0  607   46
1  161  474
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8488372, 'precision': 0.8536184, 'recall': 0.84883726, 'specificity': 0.84883726, 'f1': 0.84832454, 'auroc': 0.9203677, 'binary_precision': 0.8947368, 'binary_recall': 0.7906977, 'binary_specificity': 0.90697676, 'binary_f1_score': 0.83950615}
confusion matrix:
     0    1
0  195   20
1   45  170
early stop counter: 1
val acc:0.8392857313156128, best validation acc: 0.8649068474769592, corresponding to test acc:                         0.8720930218696594 / 0.8720930218696594
after epoch: 12,now: 2024-07-20 11:32:12.398423,epoch time: 0:01:02.454713,used: 0:12:54.588822,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_11_19_17_seed_0_22478448
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9847005, 'precision': 0.9848319, 'recall': 0.9848548, 'specificity': 0.9848548, 'f1': 0.9847005, 'auroc': 0.99945235, 'binary_precision': 0.99670833, 'binary_recall': 0.97300774, 'binary_specificity': 0.99670184, 'binary_f1_score': 0.98471546}
confusion matrix:
      0     1
0  1511     5
1    42  1514
---- Validation: 
scalar performance:
{'acc': 0.6545031, 'precision': 0.76459825, 'recall': 0.64993185, 'specificity': 0.64993185, 'f1': 0.6104808, 'auroc': 0.89242136, 'binary_precision': 0.9318182, 'binary_recall': 0.32283464, 'binary_specificity': 0.9770291, 'binary_f1_score': 0.47953212}
confusion matrix:
     0    1
0  638   15
1  430  205
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8116279, 'precision': 0.86026907, 'recall': 0.81162786, 'specificity': 0.81162786, 'f1': 0.80504763, 'auroc': 0.9258897, 'binary_precision': 0.99264705, 'binary_recall': 0.627907, 'binary_specificity': 0.9953488, 'binary_f1_score': 0.7692308}
confusion matrix:
     0    1
0  214    1
1   80  135
early stop counter: 2
val acc:0.6545031070709229, best validation acc: 0.8649068474769592, corresponding to test acc:                         0.8720930218696594 / 0.8720930218696594
after epoch: 13,now: 2024-07-20 11:33:15.537112,epoch time: 0:01:03.138689,used: 0:13:57.727511,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_11_19_17_seed_0_22478448
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.984375, 'precision': 0.9845762, 'recall': 0.9845418, 'specificity': 0.9845418, 'f1': 0.984375, 'auroc': 0.99939716, 'binary_precision': 0.9980172, 'binary_recall': 0.9710611, 'binary_specificity': 0.99802244, 'binary_f1_score': 0.9843547}
confusion matrix:
      0     1
0  1514     3
1    45  1510
---- Validation: 
scalar performance:
{'acc': 0.6576087, 'precision': 0.7822472, 'recall': 0.65290785, 'specificity': 0.65290785, 'f1': 0.6111982, 'auroc': 0.90178096, 'binary_precision': 0.96634614, 'binary_recall': 0.31653544, 'binary_specificity': 0.9892802, 'binary_f1_score': 0.47686833}
confusion matrix:
     0    1
0  646    7
1  434  201
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.74186045, 'precision': 0.8214861, 'recall': 0.74186045, 'specificity': 0.74186045, 'f1': 0.72482145, 'auroc': 0.929497, 'binary_precision': 0.9814815, 'binary_recall': 0.49302325, 'binary_specificity': 0.9906977, 'binary_f1_score': 0.65634674}
confusion matrix:
     0    1
0  213    2
1  109  106
early stop counter: 3
val acc:0.657608687877655, best validation acc: 0.8649068474769592, corresponding to test acc:                         0.8720930218696594 / 0.8720930218696594
after epoch: 14,now: 2024-07-20 11:34:17.900020,epoch time: 0:01:02.362908,used: 0:15:00.090419,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_11_19_17_seed_0_22478448
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9905599, 'precision': 0.9905652, 'recall': 0.99068475, 'specificity': 0.99068475, 'f1': 0.99055934, 'auroc': 0.99948615, 'binary_precision': 0.99869704, 'binary_recall': 0.9826923, 'binary_specificity': 0.99867725, 'binary_f1_score': 0.99063003}
confusion matrix:
      0     1
0  1510     2
1    27  1533
---- Validation: 
scalar performance:
{'acc': 0.80201864, 'precision': 0.8368976, 'recall': 0.7997552, 'specificity': 0.7997552, 'f1': 0.7959005, 'auroc': 0.92717135, 'binary_precision': 0.94186044, 'binary_recall': 0.63779527, 'binary_specificity': 0.96171516, 'binary_f1_score': 0.76056343}
confusion matrix:
     0    1
0  628   25
1  230  405
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8372093, 'precision': 0.8636756, 'recall': 0.83720934, 'specificity': 0.83720934, 'f1': 0.83419263, 'auroc': 0.9287615, 'binary_precision': 0.96178347, 'binary_recall': 0.7023256, 'binary_specificity': 0.97209305, 'binary_f1_score': 0.811828}
confusion matrix:
     0    1
0  209    6
1   64  151
early stop counter: 4
val acc:0.8020186424255371, best validation acc: 0.8649068474769592, corresponding to test acc:                         0.8720930218696594 / 0.8720930218696594
after epoch: 15,now: 2024-07-20 11:35:21.681484,epoch time: 0:01:03.781464,used: 0:16:03.871883,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_11_19_17_seed_0_22478448
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.97786456, 'precision': 0.9785218, 'recall': 0.9781631, 'specificity': 0.9781631, 'f1': 0.97786295, 'auroc': 0.9989321, 'binary_precision': 1.0, 'binary_recall': 0.95632625, 'binary_specificity': 1.0, 'binary_f1_score': 0.9776756}
confusion matrix:
      0     1
0  1515     0
1    68  1489
---- Validation: 
scalar performance:
{'acc': 0.58540374, 'precision': 0.7449275, 'recall': 0.5796795, 'specificity': 0.5796795, 'f1': 0.4977787, 'auroc': 0.889686, 'binary_precision': 0.9391304, 'binary_recall': 0.17007874, 'binary_specificity': 0.9892802, 'binary_f1_score': 0.288}
confusion matrix:
     0    1
0  646    7
1  527  108
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7116279, 'precision': 0.8171091, 'recall': 0.7116279, 'specificity': 0.7116279, 'f1': 0.68547225, 'auroc': 0.91583014, 'binary_precision': 1.0, 'binary_recall': 0.4232558, 'binary_specificity': 1.0, 'binary_f1_score': 0.5947712}
confusion matrix:
     0   1
0  215   0
1  124  91
early stop counter: 5
val acc:0.5854037404060364, best validation acc: 0.8649068474769592, corresponding to test acc:                         0.8720930218696594 / 0.8720930218696594
after epoch: 16,now: 2024-07-20 11:36:23.950485,epoch time: 0:01:02.269001,used: 0:17:06.140884,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_11_19_17_seed_0_22478448
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9876302, 'precision': 0.9876264, 'recall': 0.9877008, 'specificity': 0.9877008, 'f1': 0.98762965, 'auroc': 0.99893975, 'binary_precision': 0.9934938, 'binary_recall': 0.98199356, 'binary_specificity': 0.993408, 'binary_f1_score': 0.98771024}
confusion matrix:
      0     1
0  1507    10
1    28  1527
---- Validation: 
scalar performance:
{'acc': 0.86102486, 'precision': 0.86953354, 'recall': 0.85996675, 'specificity': 0.85996675, 'f1': 0.85994685, 'auroc': 0.9262206, 'binary_precision': 0.9222222, 'binary_recall': 0.784252, 'binary_specificity': 0.93568146, 'binary_f1_score': 0.8476596}
confusion matrix:
     0    1
0  611   42
1  137  498
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.83488375, 'precision': 0.8621561, 'recall': 0.8348837, 'specificity': 0.8348837, 'f1': 0.8317155, 'auroc': 0.93899405, 'binary_precision': 0.96153843, 'binary_recall': 0.6976744, 'binary_specificity': 0.97209305, 'binary_f1_score': 0.8086253}
confusion matrix:
     0    1
0  209    6
1   65  150
early stop counter: 6
val acc:0.8610248565673828, best validation acc: 0.8649068474769592, corresponding to test acc:                         0.8720930218696594 / 0.8720930218696594
after epoch: 17,now: 2024-07-20 11:37:27.428038,epoch time: 0:01:03.477553,used: 0:18:09.618437,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_11_19_17_seed_0_22478448
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.97526044, 'precision': 0.9766332, 'recall': 0.97495866, 'specificity': 0.97495866, 'f1': 0.9752275, 'auroc': 0.9996562, 'binary_precision': 0.95395947, 'binary_recall': 0.9993569, 'binary_specificity': 0.95056033, 'binary_f1_score': 0.97613066}
confusion matrix:
      0     1
0  1442    75
1     1  1554
---- Validation: 
scalar performance:
{'acc': 0.82298136, 'precision': 0.8285542, 'recall': 0.8220569, 'specificity': 0.8220569, 'f1': 0.8219079, 'auroc': 0.88961184, 'binary_precision': 0.86799276, 'binary_recall': 0.7559055, 'binary_specificity': 0.88820827, 'binary_f1_score': 0.8080808}
confusion matrix:
     0    1
0  580   73
1  155  480
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.87906975, 'precision': 0.87920105, 'recall': 0.87906975, 'specificity': 0.87906975, 'f1': 0.87905926, 'auroc': 0.95087075, 'binary_precision': 0.8862559, 'binary_recall': 0.8697674, 'binary_specificity': 0.88837206, 'binary_f1_score': 0.8779342}
confusion matrix:
     0    1
0  191   24
1   28  187
new oracle model saved
early stop counter: 7
val acc:0.8229813575744629, best validation acc: 0.8649068474769592, corresponding to test acc:                         0.8720930218696594 / 0.8790697455406189
after epoch: 18,now: 2024-07-20 11:38:30.684810,epoch time: 0:01:03.256772,used: 0:19:12.875209,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_11_19_17_seed_0_22478448
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9866536, 'precision': 0.9868421, 'recall': 0.98681676, 'specificity': 0.98681676, 'f1': 0.9866536, 'auroc': 0.9997295, 'binary_precision': 1.0, 'binary_recall': 0.97363347, 'binary_specificity': 1.0, 'binary_f1_score': 0.9866406}
confusion matrix:
      0     1
0  1517     0
1    41  1514
---- Validation: 
scalar performance:
{'acc': 0.6079193, 'precision': 0.74917984, 'recall': 0.60257924, 'specificity': 0.60257924, 'f1': 0.53736126, 'auroc': 0.87887585, 'binary_precision': 0.93333334, 'binary_recall': 0.22047244, 'binary_specificity': 0.9846861, 'binary_f1_score': 0.3566879}
confusion matrix:
     0    1
0  643   10
1  495  140
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6465116, 'precision': 0.7929155, 'recall': 0.6465116, 'specificity': 0.6465116, 'f1': 0.5960345, 'auroc': 0.9225581, 'binary_precision': 1.0, 'binary_recall': 0.29302326, 'binary_specificity': 1.0, 'binary_f1_score': 0.4532374}
confusion matrix:
     0   1
0  215   0
1  152  63
early stop counter: 8
val acc:0.6079192757606506, best validation acc: 0.8649068474769592, corresponding to test acc:                         0.8720930218696594 / 0.8790697455406189
after epoch: 19,now: 2024-07-20 11:39:32.862129,epoch time: 0:01:02.177319,used: 0:20:15.052528,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_11_19_17_seed_0_22478448
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.99283856, 'precision': 0.9929145, 'recall': 0.99278915, 'specificity': 0.99278915, 'f1': 0.99283665, 'auroc': 0.99986094, 'binary_precision': 0.98915124, 'binary_recall': 0.99678457, 'binary_specificity': 0.9887937, 'binary_f1_score': 0.99295324}
confusion matrix:
      0     1
0  1500    17
1     5  1550
---- Validation: 
scalar performance:
{'acc': 0.80124223, 'precision': 0.8341701, 'recall': 0.7990329, 'specificity': 0.7990329, 'f1': 0.7953805, 'auroc': 0.9185395, 'binary_precision': 0.93563217, 'binary_recall': 0.6409449, 'binary_specificity': 0.95712095, 'binary_f1_score': 0.7607477}
confusion matrix:
     0    1
0  625   28
1  228  407
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8418605, 'precision': 0.86674094, 'recall': 0.8418605, 'specificity': 0.8418605, 'f1': 0.8391321, 'auroc': 0.94171983, 'binary_precision': 0.9622642, 'binary_recall': 0.7116279, 'binary_specificity': 0.97209305, 'binary_f1_score': 0.8181819}
confusion matrix:
     0    1
0  209    6
1   62  153
early stop counter: 9
val acc:0.8012422323226929, best validation acc: 0.8649068474769592, corresponding to test acc:                         0.8720930218696594 / 0.8790697455406189
after epoch: 20,now: 2024-07-20 11:40:35.935770,epoch time: 0:01:03.073641,used: 0:21:18.126169,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_11_19_17_seed_0_22478448
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.99121094, 'precision': 0.99134254, 'recall': 0.9911336, 'specificity': 0.9911336, 'f1': 0.99120766, 'auroc': 0.9998054, 'binary_precision': 0.9860229, 'binary_recall': 0.9967887, 'binary_specificity': 0.9854785, 'binary_f1_score': 0.9913766}
confusion matrix:
      0     1
0  1493    22
1     5  1552
---- Validation: 
scalar performance:
{'acc': 0.72282606, 'precision': 0.79244304, 'recall': 0.71937513, 'specificity': 0.71937513, 'f1': 0.7032263, 'auroc': 0.86747533, 'binary_precision': 0.93167704, 'binary_recall': 0.47244096, 'binary_specificity': 0.96630937, 'binary_f1_score': 0.6269592}
confusion matrix:
     0    1
0  631   22
1  335  300
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8116279, 'precision': 0.85223496, 'recall': 0.8116279, 'specificity': 0.8116279, 'f1': 0.80603766, 'auroc': 0.9432125, 'binary_precision': 0.97183096, 'binary_recall': 0.6418605, 'binary_specificity': 0.98139536, 'binary_f1_score': 0.77310926}
confusion matrix:
     0    1
0  211    4
1   77  138
early stop counter: 10
val acc:0.7228260636329651, best validation acc: 0.8649068474769592, corresponding to test acc:                         0.8720930218696594 / 0.8790697455406189
after epoch: 21,now: 2024-07-20 11:41:38.345432,epoch time: 0:01:02.409662,used: 0:22:20.535831,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_11_19_17_seed_0_22478448
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9905599, 'precision': 0.9905863, 'recall': 0.99066424, 'specificity': 0.99066424, 'f1': 0.9905597, 'auroc': 0.99933994, 'binary_precision': 0.99869365, 'binary_recall': 0.98264784, 'binary_specificity': 0.9986807, 'binary_f1_score': 0.9906058}
confusion matrix:
      0     1
0  1514     2
1    27  1529
---- Validation: 
scalar performance:
{'acc': 0.57608694, 'precision': 0.7305942, 'recall': 0.57027406, 'specificity': 0.57027406, 'f1': 0.48322052, 'auroc': 0.88274586, 'binary_precision': 0.91588783, 'binary_recall': 0.15433072, 'binary_specificity': 0.98621744, 'binary_f1_score': 0.26415095}
confusion matrix:
     0   1
0  644   9
1  537  98
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.68604654, 'precision': 0.8013737, 'recall': 0.6860465, 'specificity': 0.6860465, 'f1': 0.6528339, 'auroc': 0.89289886, 'binary_precision': 0.9878049, 'binary_recall': 0.37674418, 'binary_specificity': 0.9953488, 'binary_f1_score': 0.54545456}
confusion matrix:
     0   1
0  214   1
1  134  81
early stop counter: 11
val acc:0.5760869383811951, best validation acc: 0.8649068474769592, corresponding to test acc:                         0.8720930218696594 / 0.8790697455406189
after epoch: 22,now: 2024-07-20 11:42:41.415540,epoch time: 0:01:03.070108,used: 0:23:23.605939,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_11_19_17_seed_0_22478448
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.9954427, 'precision': 0.9954232, 'recall': 0.9954686, 'specificity': 0.9954686, 'f1': 0.9954421, 'auroc': 0.99990463, 'binary_precision': 0.997421, 'binary_recall': 0.9935774, 'binary_specificity': 0.99735975, 'binary_f1_score': 0.9954955}
confusion matrix:
      0     1
0  1511     4
1    10  1547
---- Validation: 
scalar performance:
{'acc': 0.7507764, 'precision': 0.81727004, 'recall': 0.747548, 'specificity': 0.747548, 'f1': 0.7353464, 'auroc': 0.9143384, 'binary_precision': 0.9590643, 'binary_recall': 0.51653546, 'binary_specificity': 0.9785605, 'binary_f1_score': 0.6714432}
confusion matrix:
     0    1
0  639   14
1  307  328
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7883721, 'precision': 0.84179485, 'recall': 0.78837204, 'specificity': 0.78837204, 'f1': 0.7797664, 'auroc': 0.9293239, 'binary_precision': 0.97692305, 'binary_recall': 0.59069765, 'binary_specificity': 0.9860465, 'binary_f1_score': 0.7362318}
confusion matrix:
     0    1
0  212    3
1   88  127
early stop counter: 12
val acc:0.7507764101028442, best validation acc: 0.8649068474769592, corresponding to test acc:                         0.8720930218696594 / 0.8790697455406189
after epoch: 23,now: 2024-07-20 11:43:44.284812,epoch time: 0:01:02.869272,used: 0:24:26.475211,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_11_19_17_seed_0_22478448
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.97753906, 'precision': 0.9785031, 'recall': 0.9772464, 'specificity': 0.9772464, 'f1': 0.9775128, 'auroc': 0.9990889, 'binary_precision': 0.960445, 'binary_recall': 0.9967928, 'binary_specificity': 0.95769995, 'binary_f1_score': 0.9782814}
confusion matrix:
      0     1
0  1449    64
1     5  1554
---- Validation: 
scalar performance:
{'acc': 0.61102486, 'precision': 0.7483125, 'recall': 0.60575056, 'specificity': 0.60575056, 'f1': 0.54297614, 'auroc': 0.8263352, 'binary_precision': 0.92948717, 'binary_recall': 0.22834645, 'binary_specificity': 0.98315465, 'binary_f1_score': 0.36662453}
confusion matrix:
     0    1
0  642   11
1  490  145
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6232558, 'precision': 0.77624243, 'recall': 0.6232558, 'specificity': 0.6232558, 'f1': 0.5627119, 'auroc': 0.89068687, 'binary_precision': 0.9818182, 'binary_recall': 0.2511628, 'binary_specificity': 0.9953488, 'binary_f1_score': 0.4}
confusion matrix:
     0   1
0  214   1
1  161  54
early stop counter: 13
val acc:0.6110248565673828, best validation acc: 0.8649068474769592, corresponding to test acc:                         0.8720930218696594 / 0.8790697455406189
after epoch: 24,now: 2024-07-20 11:44:46.673509,epoch time: 0:01:02.388697,used: 0:25:28.863908,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_11_19_17_seed_0_22478448
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.9895833, 'precision': 0.9895731, 'recall': 0.9895905, 'specificity': 0.9895905, 'f1': 0.98958135, 'auroc': 0.99968326, 'binary_precision': 0.9903599, 'binary_recall': 0.9890886, 'binary_specificity': 0.99009246, 'binary_f1_score': 0.9897238}
confusion matrix:
      0     1
0  1499    15
1    17  1541
---- Validation: 
scalar performance:
{'acc': 0.74378884, 'precision': 0.8123443, 'recall': 0.74048305, 'specificity': 0.74048305, 'f1': 0.7271572, 'auroc': 0.8837805, 'binary_precision': 0.95522386, 'binary_recall': 0.503937, 'binary_specificity': 0.9770291, 'binary_f1_score': 0.65979385}
confusion matrix:
     0    1
0  638   15
1  315  320
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.81395346, 'precision': 0.85878515, 'recall': 0.8139535, 'specificity': 0.8139535, 'f1': 0.8079542, 'auroc': 0.9148512, 'binary_precision': 0.9856115, 'binary_recall': 0.6372093, 'binary_specificity': 0.9906977, 'binary_f1_score': 0.77401125}
confusion matrix:
     0    1
0  213    2
1   78  137
early stop counter: 14
val acc:0.7437888383865356, best validation acc: 0.8649068474769592, corresponding to test acc:                         0.8720930218696594 / 0.8790697455406189
after epoch: 25,now: 2024-07-20 11:45:49.158651,epoch time: 0:01:02.485142,used: 0:26:31.349050,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_11_19_17_seed_0_22478448
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.99283856, 'precision': 0.992816, 'recall': 0.99287283, 'specificity': 0.99287283, 'f1': 0.99283767, 'auroc': 0.9996214, 'binary_precision': 0.99548095, 'binary_recall': 0.9903661, 'binary_specificity': 0.99537957, 'binary_f1_score': 0.99291694}
confusion matrix:
      0     1
0  1508     7
1    15  1542
---- Validation: 
scalar performance:
{'acc': 0.68944097, 'precision': 0.7746557, 'recall': 0.68549514, 'specificity': 0.68549514, 'f1': 0.66050947, 'auroc': 0.89659774, 'binary_precision': 0.9241877, 'binary_recall': 0.4031496, 'binary_specificity': 0.96784073, 'binary_f1_score': 0.5614036}
confusion matrix:
     0    1
0  632   21
1  379  256
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.80930233, 'precision': 0.84837115, 'recall': 0.80930233, 'specificity': 0.80930233, 'f1': 0.80380154, 'auroc': 0.9299513, 'binary_precision': 0.96503496, 'binary_recall': 0.6418605, 'binary_specificity': 0.9767442, 'binary_f1_score': 0.7709497}
confusion matrix:
     0    1
0  210    5
1   77  138
early stop counter: 15
val acc:0.6894409656524658, best validation acc: 0.8649068474769592, corresponding to test acc:                         0.8720930218696594 / 0.8790697455406189
after epoch: 26,now: 2024-07-20 11:46:51.038625,epoch time: 0:01:01.879974,used: 0:27:33.229024,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_11_19_17_seed_0_22478448
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.9811198, 'precision': 0.9818635, 'recall': 0.98090744, 'specificity': 0.98090744, 'f1': 0.98110354, 'auroc': 0.9998456, 'binary_precision': 0.9657747, 'binary_recall': 0.9980707, 'binary_specificity': 0.9637442, 'binary_f1_score': 0.98165715}
confusion matrix:
      0     1
0  1462    55
1     3  1552
---- Validation: 
scalar performance:
{'acc': 0.88121116, 'precision': 0.8833204, 'recall': 0.88069963, 'specificity': 0.88069963, 'f1': 0.8809263, 'auroc': 0.9332746, 'binary_precision': 0.90847456, 'binary_recall': 0.8440945, 'binary_specificity': 0.91730475, 'binary_f1_score': 0.87510204}
confusion matrix:
     0    1
0  599   54
1   99  536
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.88139534, 'precision': 0.88581055, 'recall': 0.88139534, 'specificity': 0.88139534, 'f1': 0.881055, 'auroc': 0.91904813, 'binary_precision': 0.9270833, 'binary_recall': 0.82790697, 'binary_specificity': 0.9348837, 'binary_f1_score': 0.8746928}
confusion matrix:
     0    1
0  201   14
1   37  178
new oracle model saved
better model found
persisted
after epoch: 27,now: 2024-07-20 11:47:53.919208,epoch time: 0:01:02.880583,used: 0:28:36.109607,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_11_19_17_seed_0_22478448
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.9876302, 'precision': 0.9876368, 'recall': 0.98762023, 'specificity': 0.98762023, 'f1': 0.9876281, 'auroc': 0.9994417, 'binary_precision': 0.9871548, 'binary_recall': 0.9884244, 'binary_specificity': 0.9868161, 'binary_f1_score': 0.9877892}
confusion matrix:
      0     1
0  1497    20
1    18  1537
---- Validation: 
scalar performance:
{'acc': 0.8579193, 'precision': 0.8707441, 'recall': 0.85662174, 'specificity': 0.85662174, 'f1': 0.856341, 'auroc': 0.9159591, 'binary_precision': 0.9362934, 'binary_recall': 0.7637795, 'binary_specificity': 0.949464, 'binary_f1_score': 0.84128356}
confusion matrix:
     0    1
0  620   33
1  150  485
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8651163, 'precision': 0.8878013, 'recall': 0.86511624, 'specificity': 0.86511624, 'f1': 0.8631145, 'auroc': 0.9387777, 'binary_precision': 0.9815951, 'binary_recall': 0.74418604, 'binary_specificity': 0.9860465, 'binary_f1_score': 0.84656084}
confusion matrix:
     0    1
0  212    3
1   55  160
early stop counter: 1
val acc:0.8579192757606506, best validation acc: 0.8812111616134644, corresponding to test acc:                         0.8813953399658203 / 0.8813953399658203
after epoch: 28,now: 2024-07-20 11:48:55.932822,epoch time: 0:01:02.013614,used: 0:29:38.123221,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_11_19_17_seed_0_22478448
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.991862, 'precision': 0.99185014, 'recall': 0.9918733, 'specificity': 0.9918733, 'f1': 0.9918608, 'auroc': 0.9996524, 'binary_precision': 0.99291694, 'binary_recall': 0.99100256, 'binary_specificity': 0.9927441, 'binary_f1_score': 0.9919588}
confusion matrix:
      0     1
0  1505    11
1    14  1542
---- Validation: 
scalar performance:
{'acc': 0.85559005, 'precision': 0.8739934, 'recall': 0.85404253, 'specificity': 0.85404253, 'f1': 0.8533838, 'auroc': 0.936077, 'binary_precision': 0.9535354, 'binary_recall': 0.7433071, 'binary_specificity': 0.96477795, 'binary_f1_score': 0.83539826}
confusion matrix:
     0    1
0  630   23
1  163  472
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.82093024, 'precision': 0.8653941, 'recall': 0.82093024, 'specificity': 0.82093024, 'f1': 0.8153117, 'auroc': 0.9398378, 'binary_precision': 0.99285716, 'binary_recall': 0.6465116, 'binary_specificity': 0.9953488, 'binary_f1_score': 0.7830986}
confusion matrix:
     0    1
0  214    1
1   76  139
early stop counter: 2
val acc:0.8555900454521179, best validation acc: 0.8812111616134644, corresponding to test acc:                         0.8813953399658203 / 0.8813953399658203
after epoch: 29,now: 2024-07-20 11:49:58.126461,epoch time: 0:01:02.193639,used: 0:30:40.316860,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_11_19_17_seed_0_22478448
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.99283856, 'precision': 0.99282885, 'recall': 0.99284637, 'specificity': 0.99284637, 'f1': 0.9928372, 'auroc': 0.99985504, 'binary_precision': 0.99357325, 'binary_recall': 0.9922978, 'binary_specificity': 0.993395, 'binary_f1_score': 0.9929351}
confusion matrix:
      0     1
0  1504    10
1    12  1546
---- Validation: 
scalar performance:
{'acc': 0.7748447, 'precision': 0.8245243, 'recall': 0.7720877, 'specificity': 0.7720877, 'f1': 0.7646555, 'auroc': 0.91483283, 'binary_precision': 0.9480519, 'binary_recall': 0.5748032, 'binary_specificity': 0.96937215, 'binary_f1_score': 0.7156863}
confusion matrix:
     0    1
0  633   20
1  270  365
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7860465, 'precision': 0.85016286, 'recall': 0.7860465, 'specificity': 0.7860465, 'f1': 0.7757827, 'auroc': 0.9246728, 'binary_precision': 1.0, 'binary_recall': 0.572093, 'binary_specificity': 1.0, 'binary_f1_score': 0.7278106}
confusion matrix:
     0    1
0  215    0
1   92  123
early stop counter: 3
val acc:0.7748447060585022, best validation acc: 0.8812111616134644, corresponding to test acc:                         0.8813953399658203 / 0.8813953399658203
after epoch: 30,now: 2024-07-20 11:51:00.372809,epoch time: 0:01:02.246348,used: 0:31:42.563208,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_11_19_17_seed_0_22478448
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 0:31:42.563208 at 2024-07-20 11:51:00.372809
persisted model performance metric: 

scalar performance:
{'acc': 0.88139534, 'precision': 0.88581055, 'recall': 0.88139534, 'specificity': 0.88139534, 'f1': 0.881055, 'auroc': 0.91904813, 'binary_precision': 0.9270833, 'binary_recall': 0.82790697, 'binary_specificity': 0.9348837, 'binary_f1_score': 0.8746928}
confusion matrix:
     0    1
0  201   14
1   37  178
oracle model performance metric: 

scalar performance:
{'acc': 0.88139534, 'precision': 0.88581055, 'recall': 0.88139534, 'specificity': 0.88139534, 'f1': 0.881055, 'auroc': 0.91904813, 'binary_precision': 0.9270833, 'binary_recall': 0.82790697, 'binary_specificity': 0.9348837, 'binary_f1_score': 0.8746928}
confusion matrix:
     0    1
0  201   14
1   37  178
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_nofreeze_2024-07-19_18-41-07/rule_results/3.csv
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_nofreeze_2024-07-19_18-41-07/rule_results/3.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_nofreeze_2024-07-19_18-41-07/confusion_matrix/3.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 455454 KiB |  13219 MiB |  74700 GiB |  74699 GiB |
|       from large pool | 414861 KiB |  13181 MiB |  73818 GiB |  73818 GiB |
|       from small pool |  40592 KiB |     56 MiB |    881 GiB |    881 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 455454 KiB |  13219 MiB |  74700 GiB |  74699 GiB |
|       from large pool | 414861 KiB |  13181 MiB |  73818 GiB |  73818 GiB |
|       from small pool |  40592 KiB |     56 MiB |    881 GiB |    881 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 447480 KiB |  13213 MiB |  74209 GiB |  74208 GiB |
|       from large pool | 407075 KiB |  13175 MiB |  73329 GiB |  73329 GiB |
|       from small pool |  40405 KiB |     56 MiB |    879 GiB |    879 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  14480 MiB |  14480 MiB |  14480 MiB |      0 B   |
|       from large pool |  14414 MiB |  14414 MiB |  14414 MiB |      0 B   |
|       from small pool |     66 MiB |     66 MiB |     66 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory | 445666 KiB |   1252 MiB |  53326 GiB |  53325 GiB |
|       from large pool | 435058 KiB |   1243 MiB |  52441 GiB |  52440 GiB |
|       from small pool |  10607 KiB |     17 MiB |    885 GiB |    885 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    1298    |    2594    |   13011 K  |   13010 K  |
|       from large pool |     187    |    1413    |    6639 K  |    6639 K  |
|       from small pool |    1111    |    1407    |    6372 K  |    6371 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    1298    |    2594    |   13011 K  |   13010 K  |
|       from large pool |     187    |    1413    |    6639 K  |    6639 K  |
|       from small pool |    1111    |    1407    |    6372 K  |    6371 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     634    |     634    |     634    |       0    |
|       from large pool |     601    |     601    |     601    |       0    |
|       from small pool |      33    |      33    |      33    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      96    |     647    |    8672 K  |    8672 K  |
|       from large pool |      37    |     600    |    4958 K  |    4958 K  |
|       from small pool |      59    |     234    |    3714 K  |    3714 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13219 MiB |  74700 GiB |  74700 GiB |
|       from large pool |  16640 KiB |  13181 MiB |  73818 GiB |  73818 GiB |
|       from small pool |      0 KiB |     56 MiB |    881 GiB |    881 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13219 MiB |  74700 GiB |  74700 GiB |
|       from large pool |  16640 KiB |  13181 MiB |  73818 GiB |  73818 GiB |
|       from small pool |      0 KiB |     56 MiB |    881 GiB |    881 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13213 MiB |  74209 GiB |  74209 GiB |
|       from large pool |  16640 KiB |  13175 MiB |  73329 GiB |  73329 GiB |
|       from small pool |      0 KiB |     56 MiB |    879 GiB |    879 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    880 MiB |  14480 MiB |  14480 MiB |  13600 MiB |
|       from large pool |    830 MiB |  14414 MiB |  14414 MiB |  13584 MiB |
|       from small pool |     50 MiB |     66 MiB |     66 MiB |     16 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1252 MiB |  53326 GiB |  53326 GiB |
|       from large pool |  24320 KiB |   1243 MiB |  52441 GiB |  52441 GiB |
|       from small pool |      0 KiB |     39 MiB |    885 GiB |    885 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    2594    |   13011 K  |   13011 K  |
|       from large pool |       2    |    1413    |    6639 K  |    6639 K  |
|       from small pool |       0    |    1407    |    6372 K  |    6372 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    2594    |   13011 K  |   13011 K  |
|       from large pool |       2    |    1413    |    6639 K  |    6639 K  |
|       from small pool |       0    |    1407    |    6372 K  |    6372 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      62    |     634    |     634    |     572    |
|       from large pool |      37    |     601    |     601    |     564    |
|       from small pool |      25    |      33    |      33    |       8    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |     647    |    8672 K  |    8672 K  |
|       from large pool |       4    |     600    |    4958 K  |    4958 K  |
|       from small pool |       0    |     234    |    3714 K  |    3714 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13219 MiB |  74700 GiB |  74700 GiB |
|       from large pool |  16640 KiB |  13181 MiB |  73818 GiB |  73818 GiB |
|       from small pool |      0 KiB |     56 MiB |    881 GiB |    881 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13219 MiB |  74700 GiB |  74700 GiB |
|       from large pool |  16640 KiB |  13181 MiB |  73818 GiB |  73818 GiB |
|       from small pool |      0 KiB |     56 MiB |    881 GiB |    881 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13213 MiB |  74209 GiB |  74209 GiB |
|       from large pool |  16640 KiB |  13175 MiB |  73329 GiB |  73329 GiB |
|       from small pool |      0 KiB |     56 MiB |    879 GiB |    879 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    880 MiB |  14480 MiB |  14480 MiB |  13600 MiB |
|       from large pool |    830 MiB |  14414 MiB |  14414 MiB |  13584 MiB |
|       from small pool |     50 MiB |     66 MiB |     66 MiB |     16 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1252 MiB |  53326 GiB |  53326 GiB |
|       from large pool |  24320 KiB |   1243 MiB |  52441 GiB |  52441 GiB |
|       from small pool |      0 KiB |     39 MiB |    885 GiB |    885 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    2594    |   13011 K  |   13011 K  |
|       from large pool |       2    |    1413    |    6639 K  |    6639 K  |
|       from small pool |       0    |    1407    |    6372 K  |    6372 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    2594    |   13011 K  |   13011 K  |
|       from large pool |       2    |    1413    |    6639 K  |    6639 K  |
|       from small pool |       0    |    1407    |    6372 K  |    6372 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      62    |     634    |     634    |     572    |
|       from large pool |      37    |     601    |     601    |     564    |
|       from small pool |      25    |      33    |      33    |       8    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |     647    |    8672 K  |    8672 K  |
|       from large pool |       4    |     600    |    4958 K  |    4958 K  |
|       from small pool |       0    |     234    |    3714 K  |    3714 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'888c1ef2'
model name: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_11_52_05_seed_1_22478448

 Experiment start at: 2024-07-20 11:52:05.972484
before training, model accuracy: 0.6177777647972107
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9244792, 'precision': 0.92623293, 'recall': 0.9241384, 'specificity': 0.9241384, 'f1': 0.9243519, 'auroc': 0.9823494, 'binary_precision': 0.9015198, 'binary_recall': 0.95492595, 'binary_specificity': 0.8933509, 'binary_f1_score': 0.9274546}
confusion matrix:
      0     1
0  1357   162
1    70  1483
---- Validation: 
scalar performance:
{'acc': 0.70882124, 'precision': 0.7245281, 'recall': 0.70655406, 'specificity': 0.70655406, 'f1': 0.7021296, 'auroc': 0.82004726, 'binary_precision': 0.7799564, 'binary_recall': 0.568254, 'binary_specificity': 0.84485406, 'binary_f1_score': 0.657484}
confusion matrix:
     0    1
0  550  101
1  272  358
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.75777775, 'precision': 0.769539, 'recall': 0.75777775, 'specificity': 0.75777775, 'f1': 0.75510633, 'auroc': 0.8553284, 'binary_precision': 0.8258427, 'binary_recall': 0.6533333, 'binary_specificity': 0.8622222, 'binary_f1_score': 0.7295285}
confusion matrix:
     0    1
0  194   31
1   78  147
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-20 11:53:21.275364,epoch time: 0:01:15.302880,used: 0:01:15.302880,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_11_52_05_seed_1_22478448
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9667969, 'precision': 0.9671454, 'recall': 0.9670012, 'specificity': 0.9670012, 'f1': 0.9667963, 'auroc': 0.99413294, 'binary_precision': 0.9833666, 'binary_recall': 0.9504823, 'binary_specificity': 0.9835201, 'binary_f1_score': 0.96664494}
confusion matrix:
      0     1
0  1492    25
1    77  1478
---- Validation: 
scalar performance:
{'acc': 0.83372366, 'precision': 0.84456784, 'recall': 0.8322581, 'specificity': 0.8322581, 'f1': 0.8319391, 'auroc': 0.9029917, 'binary_precision': 0.9017341, 'binary_recall': 0.74285716, 'binary_specificity': 0.921659, 'binary_f1_score': 0.8146214}
confusion matrix:
     0    1
0  600   51
1  162  468
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8466667, 'precision': 0.8542878, 'recall': 0.8466667, 'specificity': 0.8466667, 'f1': 0.84583765, 'auroc': 0.90595555, 'binary_precision': 0.90625, 'binary_recall': 0.7733333, 'binary_specificity': 0.92, 'binary_f1_score': 0.8345324}
confusion matrix:
     0    1
0  207   18
1   51  174
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-07-20 11:54:24.787270,epoch time: 0:01:03.511906,used: 0:02:18.814786,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_11_52_05_seed_1_22478448
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.97298175, 'precision': 0.9730582, 'recall': 0.9729253, 'specificity': 0.9729253, 'f1': 0.9729743, 'auroc': 0.9956391, 'binary_precision': 0.96938777, 'binary_recall': 0.977492, 'binary_specificity': 0.9683586, 'binary_f1_score': 0.973423}
confusion matrix:
      0     1
0  1469    48
1    35  1520
---- Validation: 
scalar performance:
{'acc': 0.8126464, 'precision': 0.8133811, 'recall': 0.812212, 'specificity': 0.812212, 'f1': 0.81234896, 'auroc': 0.88875115, 'binary_precision': 0.825, 'binary_recall': 0.78571427, 'binary_specificity': 0.83870965, 'binary_f1_score': 0.8048781}
confusion matrix:
     0    1
0  546  105
1  135  495
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8088889, 'precision': 0.80977, 'recall': 0.8088889, 'specificity': 0.8088889, 'f1': 0.8087529, 'auroc': 0.9054617, 'binary_precision': 0.79324895, 'binary_recall': 0.83555555, 'binary_specificity': 0.7822222, 'binary_f1_score': 0.81385285}
confusion matrix:
     0    1
0  176   49
1   37  188
early stop counter: 1
val acc:0.8126463890075684, best validation acc: 0.8337236642837524, corresponding to test acc:                         0.846666693687439 / 0.846666693687439
after epoch: 3,now: 2024-07-20 11:55:27.845532,epoch time: 0:01:03.058262,used: 0:03:21.873048,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_11_52_05_seed_1_22478448
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9264323, 'precision': 0.9350063, 'recall': 0.92732316, 'specificity': 0.92732316, 'f1': 0.92616165, 'auroc': 0.99392676, 'binary_precision': 0.9992487, 'binary_recall': 0.8553055, 'binary_specificity': 0.99934083, 'binary_f1_score': 0.92169094}
confusion matrix:
      0     1
0  1516     1
1   225  1330
---- Validation: 
scalar performance:
{'acc': 0.51990634, 'precision': 0.64606595, 'recall': 0.5120584, 'specificity': 0.5120584, 'f1': 0.37054613, 'auroc': 0.7981317, 'binary_precision': 0.7777778, 'binary_recall': 0.033333335, 'binary_specificity': 0.9907834, 'binary_f1_score': 0.06392694}
confusion matrix:
     0   1
0  645   6
1  609  21
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6, 'precision': 0.7487837, 'recall': 0.6, 'specificity': 0.6, 'f1': 0.5296823, 'auroc': 0.83680004, 'binary_precision': 0.9411765, 'binary_recall': 0.21333334, 'binary_specificity': 0.9866667, 'binary_f1_score': 0.34782612}
confusion matrix:
     0   1
0  222   3
1  177  48
early stop counter: 2
val acc:0.5199063420295715, best validation acc: 0.8337236642837524, corresponding to test acc:                         0.846666693687439 / 0.846666693687439
after epoch: 4,now: 2024-07-20 11:56:31.163948,epoch time: 0:01:03.318416,used: 0:04:25.191464,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_11_52_05_seed_1_22478448
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.97591144, 'precision': 0.97633183, 'recall': 0.976092, 'specificity': 0.976092, 'f1': 0.9759102, 'auroc': 0.9970708, 'binary_precision': 0.99332446, 'binary_recall': 0.9587629, 'binary_specificity': 0.9934211, 'binary_f1_score': 0.97573763}
confusion matrix:
      0     1
0  1510    10
1    64  1488
---- Validation: 
scalar performance:
{'acc': 0.7946916, 'precision': 0.81508714, 'recall': 0.79257554, 'specificity': 0.79257554, 'f1': 0.790462, 'auroc': 0.885412, 'binary_precision': 0.891258, 'binary_recall': 0.6634921, 'binary_specificity': 0.921659, 'binary_f1_score': 0.7606915}
confusion matrix:
     0    1
0  600   51
1  212  418
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8288889, 'precision': 0.8425926, 'recall': 0.8288889, 'specificity': 0.8288889, 'f1': 0.8271605, 'auroc': 0.908484, 'binary_precision': 0.9111111, 'binary_recall': 0.72888887, 'binary_specificity': 0.9288889, 'binary_f1_score': 0.8098765}
confusion matrix:
     0    1
0  209   16
1   61  164
early stop counter: 3
val acc:0.7946916222572327, best validation acc: 0.8337236642837524, corresponding to test acc:                         0.846666693687439 / 0.846666693687439
after epoch: 5,now: 2024-07-20 11:57:34.998194,epoch time: 0:01:03.834246,used: 0:05:29.025710,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_11_52_05_seed_1_22478448
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9820964, 'precision': 0.98233926, 'recall': 0.9822749, 'specificity': 0.9822749, 'f1': 0.98209625, 'auroc': 0.998376, 'binary_precision': 0.9966887, 'binary_recall': 0.9678457, 'binary_specificity': 0.99670404, 'binary_f1_score': 0.9820554}
confusion matrix:
      0     1
0  1512     5
1    50  1505
---- Validation: 
scalar performance:
{'acc': 0.6971116, 'precision': 0.7451763, 'recall': 0.6933948, 'specificity': 0.6933948, 'f1': 0.6789092, 'auroc': 0.84274495, 'binary_precision': 0.849711, 'binary_recall': 0.46666667, 'binary_specificity': 0.92012286, 'binary_f1_score': 0.602459}
confusion matrix:
     0    1
0  599   52
1  336  294
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8288889, 'precision': 0.8401847, 'recall': 0.8288889, 'specificity': 0.8288889, 'f1': 0.8274566, 'auroc': 0.9171951, 'binary_precision': 0.90217394, 'binary_recall': 0.73777777, 'binary_specificity': 0.92, 'binary_f1_score': 0.8117359}
confusion matrix:
     0    1
0  207   18
1   59  166
early stop counter: 4
val acc:0.6971116065979004, best validation acc: 0.8337236642837524, corresponding to test acc:                         0.846666693687439 / 0.846666693687439
after epoch: 6,now: 2024-07-20 11:58:39.158132,epoch time: 0:01:04.159938,used: 0:06:33.185648,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_11_52_05_seed_1_22478448
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9840495, 'precision': 0.9840543, 'recall': 0.98415345, 'specificity': 0.98415345, 'f1': 0.9840487, 'auroc': 0.9988163, 'binary_precision': 0.99153095, 'binary_recall': 0.9768934, 'binary_specificity': 0.9914135, 'binary_f1_score': 0.9841578}
confusion matrix:
      0     1
0  1501    13
1    36  1522
---- Validation: 
scalar performance:
{'acc': 0.8446526, 'precision': 0.851239, 'recall': 0.8435228, 'specificity': 0.8435228, 'f1': 0.84358156, 'auroc': 0.90759516, 'binary_precision': 0.89541286, 'binary_recall': 0.7746032, 'binary_specificity': 0.9124424, 'binary_f1_score': 0.83063835}
confusion matrix:
     0    1
0  594   57
1  142  488
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.88666666, 'precision': 0.8888867, 'recall': 0.88666666, 'specificity': 0.88666666, 'f1': 0.88650465, 'auroc': 0.9385679, 'binary_precision': 0.9182692, 'binary_recall': 0.8488889, 'binary_specificity': 0.92444444, 'binary_f1_score': 0.8822171}
confusion matrix:
     0    1
0  208   17
1   34  191
new oracle model saved
better model found
persisted
after epoch: 7,now: 2024-07-20 11:59:42.542572,epoch time: 0:01:03.384440,used: 0:07:36.570088,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_11_52_05_seed_1_22478448
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.95670575, 'precision': 0.95911086, 'recall': 0.9562843, 'specificity': 0.9562843, 'f1': 0.9566143, 'auroc': 0.99654293, 'binary_precision': 0.9288299, 'binary_recall': 0.9903537, 'binary_specificity': 0.9222149, 'binary_f1_score': 0.95860565}
confusion matrix:
      0     1
0  1399   118
1    15  1540
---- Validation: 
scalar performance:
{'acc': 0.7962529, 'precision': 0.7997012, 'recall': 0.797107, 'specificity': 0.797107, 'f1': 0.79594207, 'auroc': 0.86578155, 'binary_precision': 0.76319546, 'binary_recall': 0.8492063, 'binary_specificity': 0.7450077, 'binary_f1_score': 0.80390686}
confusion matrix:
     0    1
0  485  166
1   95  535
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.82222223, 'precision': 0.83627784, 'recall': 0.82222223, 'specificity': 0.82222223, 'f1': 0.820345, 'auroc': 0.91119015, 'binary_precision': 0.7675277, 'binary_recall': 0.92444444, 'binary_specificity': 0.72, 'binary_f1_score': 0.8387097}
confusion matrix:
     0    1
0  162   63
1   17  208
early stop counter: 1
val acc:0.7962529063224792, best validation acc: 0.8446525931358337, corresponding to test acc:                         0.8866666555404663 / 0.8866666555404663
after epoch: 8,now: 2024-07-20 12:00:46.040284,epoch time: 0:01:03.497712,used: 0:08:40.067800,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_11_52_05_seed_1_22478448
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.984375, 'precision': 0.9844746, 'recall': 0.9845165, 'specificity': 0.9845165, 'f1': 0.984375, 'auroc': 0.998724, 'binary_precision': 0.9954008, 'binary_recall': 0.9736504, 'binary_specificity': 0.9953826, 'binary_f1_score': 0.98440546}
confusion matrix:
      0     1
0  1509     7
1    41  1515
---- Validation: 
scalar performance:
{'acc': 0.78142077, 'precision': 0.83126485, 'recall': 0.778213, 'specificity': 0.778213, 'f1': 0.7714937, 'auroc': 0.9227196, 'binary_precision': 0.9557292, 'binary_recall': 0.5825397, 'binary_specificity': 0.9738863, 'binary_f1_score': 0.7238659}
confusion matrix:
     0    1
0  634   17
1  263  367
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7911111, 'precision': 0.840917, 'recall': 0.7911111, 'specificity': 0.7911111, 'f1': 0.7831925, 'auroc': 0.9272099, 'binary_precision': 0.971223, 'binary_recall': 0.6, 'binary_specificity': 0.9822222, 'binary_f1_score': 0.7417582}
confusion matrix:
     0    1
0  221    4
1   90  135
early stop counter: 2
val acc:0.7814207673072815, best validation acc: 0.8446525931358337, corresponding to test acc:                         0.8866666555404663 / 0.8866666555404663
after epoch: 9,now: 2024-07-20 12:01:49.228351,epoch time: 0:01:03.188067,used: 0:09:43.255867,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_11_52_05_seed_1_22478448
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.98502606, 'precision': 0.9850952, 'recall': 0.98514456, 'specificity': 0.98514456, 'f1': 0.9850259, 'auroc': 0.9988351, 'binary_precision': 0.9947541, 'binary_recall': 0.9755627, 'binary_specificity': 0.9947264, 'binary_f1_score': 0.9850649}
confusion matrix:
      0     1
0  1509     8
1    38  1517
---- Validation: 
scalar performance:
{'acc': 0.8563622, 'precision': 0.8730016, 'recall': 0.8546339, 'specificity': 0.8546339, 'f1': 0.8542836, 'auroc': 0.9260868, 'binary_precision': 0.94779116, 'binary_recall': 0.74920636, 'binary_specificity': 0.96006143, 'binary_f1_score': 0.83687943}
confusion matrix:
     0    1
0  625   26
1  158  472
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8288889, 'precision': 0.86302984, 'recall': 0.8288889, 'specificity': 0.8288889, 'f1': 0.824769, 'auroc': 0.9265975, 'binary_precision': 0.974359, 'binary_recall': 0.6755555, 'binary_specificity': 0.9822222, 'binary_f1_score': 0.79790026}
confusion matrix:
     0    1
0  221    4
1   73  152
better model found
persisted
after epoch: 10,now: 2024-07-20 12:02:53.421124,epoch time: 0:01:04.192773,used: 0:10:47.448640,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_11_52_05_seed_1_22478448
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.97265625, 'precision': 0.97288215, 'recall': 0.9728293, 'specificity': 0.9728293, 'f1': 0.97265613, 'auroc': 0.99775326, 'binary_precision': 0.9867637, 'binary_recall': 0.95884246, 'binary_specificity': 0.9868161, 'binary_f1_score': 0.9726027}
confusion matrix:
      0     1
0  1497    20
1    64  1491
---- Validation: 
scalar performance:
{'acc': 0.77751756, 'precision': 0.7825775, 'recall': 0.7763697, 'specificity': 0.7763697, 'f1': 0.7759837, 'auroc': 0.8531051, 'binary_precision': 0.8165138, 'binary_recall': 0.7063492, 'binary_specificity': 0.8463902, 'binary_f1_score': 0.7574468}
confusion matrix:
     0    1
0  551  100
1  185  445
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.78, 'precision': 0.79516494, 'recall': 0.78, 'specificity': 0.78, 'f1': 0.7771374, 'auroc': 0.9107951, 'binary_precision': 0.7282609, 'binary_recall': 0.8933333, 'binary_specificity': 0.6666667, 'binary_f1_score': 0.80239516}
confusion matrix:
     0    1
0  150   75
1   24  201
early stop counter: 1
val acc:0.777517557144165, best validation acc: 0.8563622236251831, corresponding to test acc:                         0.8288888931274414 / 0.8866666555404663
after epoch: 11,now: 2024-07-20 12:03:57.139758,epoch time: 0:01:03.718634,used: 0:11:51.167274,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_11_52_05_seed_1_22478448
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.96972656, 'precision': 0.9714975, 'recall': 0.96942824, 'specificity': 0.96942824, 'f1': 0.9696811, 'auroc': 0.9995116, 'binary_precision': 0.94508845, 'binary_recall': 0.998067, 'binary_specificity': 0.94078946, 'binary_f1_score': 0.97085553}
confusion matrix:
      0     1
0  1430    90
1     3  1549
---- Validation: 
scalar performance:
{'acc': 0.83138174, 'precision': 0.83914924, 'recall': 0.83261645, 'specificity': 0.83261645, 'f1': 0.83073795, 'auroc': 0.9200479, 'binary_precision': 0.78356165, 'binary_recall': 0.9079365, 'binary_specificity': 0.75729644, 'binary_f1_score': 0.84117645}
confusion matrix:
     0    1
0  493  158
1   58  572
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8377778, 'precision': 0.8443138, 'recall': 0.8377778, 'specificity': 0.8377778, 'f1': 0.8370043, 'auroc': 0.92614317, 'binary_precision': 0.796875, 'binary_recall': 0.9066667, 'binary_specificity': 0.7688889, 'binary_f1_score': 0.8482328}
confusion matrix:
     0    1
0  173   52
1   21  204
early stop counter: 2
val acc:0.8313817381858826, best validation acc: 0.8563622236251831, corresponding to test acc:                         0.8288888931274414 / 0.8866666555404663
after epoch: 12,now: 2024-07-20 12:05:00.283433,epoch time: 0:01:03.143675,used: 0:12:54.310949,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_11_52_05_seed_1_22478448
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9798177, 'precision': 0.98024935, 'recall': 0.98008406, 'specificity': 0.98008406, 'f1': 0.9798173, 'auroc': 0.99945223, 'binary_precision': 0.99866664, 'binary_recall': 0.9614891, 'binary_specificity': 0.998679, 'binary_f1_score': 0.97972524}
confusion matrix:
      0     1
0  1512     2
1    60  1498
---- Validation: 
scalar performance:
{'acc': 0.6541764, 'precision': 0.77426255, 'recall': 0.6486687, 'specificity': 0.6486687, 'f1': 0.60695857, 'auroc': 0.91703784, 'binary_precision': 0.9516908, 'binary_recall': 0.31269842, 'binary_specificity': 0.984639, 'binary_f1_score': 0.47072878}
confusion matrix:
     0    1
0  641   10
1  433  197
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7266667, 'precision': 0.81889176, 'recall': 0.7266667, 'specificity': 0.7266667, 'f1': 0.7053641, 'auroc': 0.9176296, 'binary_precision': 0.99038464, 'binary_recall': 0.45777777, 'binary_specificity': 0.9955556, 'binary_f1_score': 0.62613976}
confusion matrix:
     0    1
0  224    1
1  122  103
early stop counter: 3
val acc:0.6541764140129089, best validation acc: 0.8563622236251831, corresponding to test acc:                         0.8288888931274414 / 0.8866666555404663
after epoch: 13,now: 2024-07-20 12:06:09.474725,epoch time: 0:01:09.191292,used: 0:14:03.502241,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_11_52_05_seed_1_22478448
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9899089, 'precision': 0.98990166, 'recall': 0.9899758, 'specificity': 0.9899758, 'f1': 0.9899084, 'auroc': 0.9995146, 'binary_precision': 0.99544865, 'binary_recall': 0.9845659, 'binary_specificity': 0.99538565, 'binary_f1_score': 0.9899774}
confusion matrix:
      0     1
0  1510     7
1    24  1531
---- Validation: 
scalar performance:
{'acc': 0.85480094, 'precision': 0.86210424, 'recall': 0.85363543, 'specificity': 0.85363543, 'f1': 0.853742, 'auroc': 0.9161973, 'binary_precision': 0.9095941, 'binary_recall': 0.78253967, 'binary_specificity': 0.9247312, 'binary_f1_score': 0.8412969}
confusion matrix:
     0    1
0  602   49
1  137  493
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8577778, 'precision': 0.8661384, 'recall': 0.8577778, 'specificity': 0.8577778, 'f1': 0.85696125, 'auroc': 0.9284938, 'binary_precision': 0.921466, 'binary_recall': 0.7822222, 'binary_specificity': 0.93333334, 'binary_f1_score': 0.84615386}
confusion matrix:
     0    1
0  210   15
1   49  176
early stop counter: 4
val acc:0.8548009395599365, best validation acc: 0.8563622236251831, corresponding to test acc:                         0.8288888931274414 / 0.8866666555404663
after epoch: 14,now: 2024-07-20 12:07:13.004406,epoch time: 0:01:03.529681,used: 0:15:07.031922,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_11_52_05_seed_1_22478448
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9827474, 'precision': 0.9830111, 'recall': 0.9829437, 'specificity': 0.9829437, 'f1': 0.9827473, 'auroc': 0.99925935, 'binary_precision': 0.99801195, 'binary_recall': 0.9678663, 'binary_specificity': 0.9980211, 'binary_f1_score': 0.982708}
confusion matrix:
      0     1
0  1513     3
1    50  1506
---- Validation: 
scalar performance:
{'acc': 0.7291179, 'precision': 0.8007889, 'recall': 0.72506404, 'specificity': 0.72506404, 'f1': 0.7096124, 'auroc': 0.89730513, 'binary_precision': 0.94357365, 'binary_recall': 0.47777778, 'binary_specificity': 0.97235024, 'binary_f1_score': 0.63435197}
confusion matrix:
     0    1
0  633   18
1  329  301
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.74, 'precision': 0.8068182, 'recall': 0.74, 'specificity': 0.74, 'f1': 0.72502935, 'auroc': 0.89609873, 'binary_precision': 0.95, 'binary_recall': 0.50666666, 'binary_specificity': 0.97333336, 'binary_f1_score': 0.66086954}
confusion matrix:
     0    1
0  219    6
1  111  114
early stop counter: 5
val acc:0.7291178703308105, best validation acc: 0.8563622236251831, corresponding to test acc:                         0.8288888931274414 / 0.8866666555404663
after epoch: 15,now: 2024-07-20 12:08:17.145163,epoch time: 0:01:04.140757,used: 0:16:11.172679,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_11_52_05_seed_1_22478448
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9866536, 'precision': 0.98697436, 'recall': 0.98651993, 'specificity': 0.98651993, 'f1': 0.98664653, 'auroc': 0.99965745, 'binary_precision': 0.97731566, 'binary_recall': 0.99678665, 'binary_specificity': 0.9762533, 'binary_f1_score': 0.98695517}
confusion matrix:
      0     1
0  1480    36
1     5  1551
---- Validation: 
scalar performance:
{'acc': 0.87431693, 'precision': 0.8742723, 'recall': 0.8743216, 'specificity': 0.8743216, 'f1': 0.87429214, 'auroc': 0.9255456, 'binary_precision': 0.8704581, 'binary_recall': 0.87460315, 'binary_specificity': 0.87403995, 'binary_f1_score': 0.8725257}
confusion matrix:
     0    1
0  569   82
1   79  551
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8422222, 'precision': 0.84228307, 'recall': 0.8422222, 'specificity': 0.8422222, 'f1': 0.8422152, 'auroc': 0.9175704, 'binary_precision': 0.8377193, 'binary_recall': 0.8488889, 'binary_specificity': 0.83555555, 'binary_f1_score': 0.84326714}
confusion matrix:
     0    1
0  188   37
1   34  191
better model found
persisted
after epoch: 16,now: 2024-07-20 12:09:20.770697,epoch time: 0:01:03.625534,used: 0:17:14.798213,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_11_52_05_seed_1_22478448
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9876302, 'precision': 0.9876873, 'recall': 0.98758805, 'specificity': 0.98758805, 'f1': 0.9876272, 'auroc': 0.99923354, 'binary_precision': 0.98466456, 'binary_recall': 0.9909968, 'binary_specificity': 0.9841793, 'binary_f1_score': 0.9878205}
confusion matrix:
      0     1
0  1493    24
1    14  1541
---- Validation: 
scalar performance:
{'acc': 0.81186575, 'precision': 0.8132317, 'recall': 0.8112903, 'specificity': 0.8112903, 'f1': 0.81142396, 'auroc': 0.87310123, 'binary_precision': 0.8302207, 'binary_recall': 0.77619046, 'binary_specificity': 0.8463902, 'binary_f1_score': 0.8022969}
confusion matrix:
     0    1
0  551  100
1  141  489
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7866667, 'precision': 0.7960224, 'recall': 0.78666663, 'specificity': 0.78666663, 'f1': 0.78496766, 'auroc': 0.87660253, 'binary_precision': 0.7433962, 'binary_recall': 0.8755556, 'binary_specificity': 0.69777775, 'binary_f1_score': 0.8040816}
confusion matrix:
     0    1
0  157   68
1   28  197
early stop counter: 1
val acc:0.8118657469749451, best validation acc: 0.874316930770874, corresponding to test acc:                         0.8422222137451172 / 0.8866666555404663
after epoch: 17,now: 2024-07-20 12:10:24.059916,epoch time: 0:01:03.289219,used: 0:18:18.087432,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_11_52_05_seed_1_22478448
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9661458, 'precision': 0.96830785, 'recall': 0.96575403, 'specificity': 0.96575403, 'f1': 0.96608126, 'auroc': 0.99929416, 'binary_precision': 0.93943065, 'binary_recall': 0.99742764, 'binary_specificity': 0.9340804, 'binary_f1_score': 0.9675608}
confusion matrix:
      0     1
0  1417   100
1     4  1551
---- Validation: 
scalar performance:
{'acc': 0.83138174, 'precision': 0.83789563, 'recall': 0.83251405, 'specificity': 0.83251405, 'f1': 0.83086216, 'auroc': 0.9177212, 'binary_precision': 0.7867036, 'binary_recall': 0.9015873, 'binary_specificity': 0.76344085, 'binary_f1_score': 0.8402367}
confusion matrix:
     0    1
0  497  154
1   62  568
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7511111, 'precision': 0.80420685, 'recall': 0.7511111, 'specificity': 0.7511111, 'f1': 0.73975545, 'auroc': 0.9288691, 'binary_precision': 0.677116, 'binary_recall': 0.96, 'binary_specificity': 0.5422222, 'binary_f1_score': 0.7941176}
confusion matrix:
     0    1
0  122  103
1    9  216
early stop counter: 2
val acc:0.8313817381858826, best validation acc: 0.874316930770874, corresponding to test acc:                         0.8422222137451172 / 0.8866666555404663
after epoch: 18,now: 2024-07-20 12:11:27.116637,epoch time: 0:01:03.056721,used: 0:19:21.144153,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_11_52_05_seed_1_22478448
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.991862, 'precision': 0.9918406, 'recall': 0.9918988, 'specificity': 0.9918988, 'f1': 0.99186116, 'auroc': 0.9996804, 'binary_precision': 0.9948287, 'binary_recall': 0.9890745, 'binary_specificity': 0.99472296, 'binary_f1_score': 0.9919433}
confusion matrix:
      0     1
0  1508     8
1    17  1539
---- Validation: 
scalar performance:
{'acc': 0.7283372, 'precision': 0.80035853, 'recall': 0.72427034, 'specificity': 0.72427034, 'f1': 0.70864904, 'auroc': 0.9180095, 'binary_precision': 0.9433962, 'binary_recall': 0.47619048, 'binary_specificity': 0.97235024, 'binary_f1_score': 0.63291144}
confusion matrix:
     0    1
0  633   18
1  330  300
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8244445, 'precision': 0.865, 'recall': 0.8244444, 'specificity': 0.8244444, 'f1': 0.81942856, 'auroc': 0.9263605, 'binary_precision': 0.9866667, 'binary_recall': 0.6577778, 'binary_specificity': 0.9911111, 'binary_f1_score': 0.78933334}
confusion matrix:
     0    1
0  223    2
1   77  148
early stop counter: 3
val acc:0.7283372282981873, best validation acc: 0.874316930770874, corresponding to test acc:                         0.8422222137451172 / 0.8866666555404663
after epoch: 19,now: 2024-07-20 12:12:31.103394,epoch time: 0:01:03.986757,used: 0:20:25.130910,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_11_52_05_seed_1_22478448
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9944661, 'precision': 0.99449027, 'recall': 0.9944452, 'specificity': 0.9944452, 'f1': 0.9944651, 'auroc': 0.9998771, 'binary_precision': 0.9929487, 'binary_recall': 0.9961415, 'binary_specificity': 0.99274886, 'binary_f1_score': 0.99454254}
confusion matrix:
      0     1
0  1506    11
1     6  1549
---- Validation: 
scalar performance:
{'acc': 0.863388, 'precision': 0.8753395, 'recall': 0.8619304, 'specificity': 0.8619304, 'f1': 0.8619219, 'auroc': 0.9241582, 'binary_precision': 0.938343, 'binary_recall': 0.77301586, 'binary_specificity': 0.9508448, 'binary_f1_score': 0.8476937}
confusion matrix:
     0    1
0  619   32
1  143  487
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8288889, 'precision': 0.86302984, 'recall': 0.8288889, 'specificity': 0.8288889, 'f1': 0.824769, 'auroc': 0.9294815, 'binary_precision': 0.974359, 'binary_recall': 0.6755555, 'binary_specificity': 0.9822222, 'binary_f1_score': 0.79790026}
confusion matrix:
     0    1
0  221    4
1   73  152
early stop counter: 4
val acc:0.8633880019187927, best validation acc: 0.874316930770874, corresponding to test acc:                         0.8422222137451172 / 0.8866666555404663
after epoch: 20,now: 2024-07-20 12:13:34.877658,epoch time: 0:01:03.774264,used: 0:21:28.905174,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_11_52_05_seed_1_22478448
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.98307294, 'precision': 0.98310316, 'recall': 0.98316216, 'specificity': 0.98316216, 'f1': 0.98307264, 'auroc': 0.99833995, 'binary_precision': 0.9908497, 'binary_recall': 0.97554696, 'binary_specificity': 0.9907773, 'binary_f1_score': 0.9831388}
confusion matrix:
      0     1
0  1504    14
1    38  1516
---- Validation: 
scalar performance:
{'acc': 0.8251366, 'precision': 0.8500389, 'recall': 0.82293904, 'specificity': 0.82293904, 'f1': 0.82124543, 'auroc': 0.9192811, 'binary_precision': 0.93939394, 'binary_recall': 0.6888889, 'binary_specificity': 0.9569892, 'binary_f1_score': 0.7948718}
confusion matrix:
     0    1
0  623   28
1  196  434
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.83555555, 'precision': 0.8650949, 'recall': 0.83555555, 'specificity': 0.83555555, 'f1': 0.8321606, 'auroc': 0.91363955, 'binary_precision': 0.9689441, 'binary_recall': 0.6933333, 'binary_specificity': 0.9777778, 'binary_f1_score': 0.8082901}
confusion matrix:
     0    1
0  220    5
1   69  156
early stop counter: 5
val acc:0.8251366019248962, best validation acc: 0.874316930770874, corresponding to test acc:                         0.8422222137451172 / 0.8866666555404663
after epoch: 21,now: 2024-07-20 12:14:38.212610,epoch time: 0:01:03.334952,used: 0:22:32.240126,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_11_52_05_seed_1_22478448
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9921875, 'precision': 0.9921857, 'recall': 0.9921857, 'specificity': 0.9921857, 'f1': 0.9921857, 'auroc': 0.99952555, 'binary_precision': 0.9923028, 'binary_recall': 0.9923028, 'binary_specificity': 0.9920687, 'binary_f1_score': 0.9923028}
confusion matrix:
      0     1
0  1501    12
1    12  1547
---- Validation: 
scalar performance:
{'acc': 0.84231067, 'precision': 0.8572424, 'recall': 0.8406298, 'specificity': 0.8406298, 'f1': 0.840148, 'auroc': 0.9299978, 'binary_precision': 0.9262948, 'binary_recall': 0.7380952, 'binary_specificity': 0.94316435, 'binary_f1_score': 0.8215547}
confusion matrix:
     0    1
0  614   37
1  165  465
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8577778, 'precision': 0.87483704, 'recall': 0.8577778, 'specificity': 0.8577778, 'f1': 0.856141, 'auroc': 0.9316938, 'binary_precision': 0.9548023, 'binary_recall': 0.7511111, 'binary_specificity': 0.96444446, 'binary_f1_score': 0.840796}
confusion matrix:
     0    1
0  217    8
1   56  169
early stop counter: 6
val acc:0.8423106670379639, best validation acc: 0.874316930770874, corresponding to test acc:                         0.8422222137451172 / 0.8866666555404663
after epoch: 22,now: 2024-07-20 12:15:41.897700,epoch time: 0:01:03.685090,used: 0:23:35.925216,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_11_52_05_seed_1_22478448
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.99121094, 'precision': 0.99124825, 'recall': 0.99117976, 'specificity': 0.99117976, 'f1': 0.99120885, 'auroc': 0.9993819, 'binary_precision': 0.98912346, 'binary_recall': 0.99357325, 'binary_specificity': 0.9887863, 'binary_f1_score': 0.9913433}
confusion matrix:
      0     1
0  1499    17
1    10  1546
---- Validation: 
scalar performance:
{'acc': 0.84543324, 'precision': 0.85776997, 'recall': 0.84390676, 'specificity': 0.84390676, 'f1': 0.84364486, 'auroc': 0.91676545, 'binary_precision': 0.9202335, 'binary_recall': 0.75079364, 'binary_specificity': 0.93701994, 'binary_f1_score': 0.8269231}
confusion matrix:
     0    1
0  610   41
1  157  473
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8111111, 'precision': 0.85743463, 'recall': 0.8111111, 'specificity': 0.8111111, 'f1': 0.8047862, 'auroc': 0.9430321, 'binary_precision': 0.9861111, 'binary_recall': 0.6311111, 'binary_specificity': 0.9911111, 'binary_f1_score': 0.76964766}
confusion matrix:
     0    1
0  223    2
1   83  142
early stop counter: 7
val acc:0.845433235168457, best validation acc: 0.874316930770874, corresponding to test acc:                         0.8422222137451172 / 0.8866666555404663
after epoch: 23,now: 2024-07-20 12:16:44.937870,epoch time: 0:01:03.040170,used: 0:24:38.965386,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_11_52_05_seed_1_22478448
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.99316406, 'precision': 0.99318874, 'recall': 0.9931417, 'specificity': 0.9931417, 'f1': 0.99316263, 'auroc': 0.9997609, 'binary_precision': 0.991672, 'binary_recall': 0.9948586, 'binary_specificity': 0.9914248, 'binary_f1_score': 0.99326277}
confusion matrix:
      0     1
0  1503    13
1     8  1548
---- Validation: 
scalar performance:
{'acc': 0.832943, 'precision': 0.84562063, 'recall': 0.831362, 'specificity': 0.831362, 'f1': 0.83089423, 'auroc': 0.9137859, 'binary_precision': 0.9078431, 'binary_recall': 0.7349206, 'binary_specificity': 0.9278034, 'binary_f1_score': 0.8122807}
confusion matrix:
     0    1
0  604   47
1  167  463
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.77555555, 'precision': 0.8323328, 'recall': 0.77555555, 'specificity': 0.77555555, 'f1': 0.76554155, 'auroc': 0.93046916, 'binary_precision': 0.969697, 'binary_recall': 0.5688889, 'binary_specificity': 0.9822222, 'binary_f1_score': 0.71708685}
confusion matrix:
     0    1
0  221    4
1   97  128
early stop counter: 8
val acc:0.8329430222511292, best validation acc: 0.874316930770874, corresponding to test acc:                         0.8422222137451172 / 0.8866666555404663
after epoch: 24,now: 2024-07-20 12:17:48.917565,epoch time: 0:01:03.979695,used: 0:25:42.945081,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_11_52_05_seed_1_22478448
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.97265625, 'precision': 0.97347295, 'recall': 0.9724388, 'specificity': 0.9724388, 'f1': 0.9726317, 'auroc': 0.998646, 'binary_precision': 0.95652175, 'binary_recall': 0.990991, 'binary_specificity': 0.9538867, 'binary_f1_score': 0.9734514}
confusion matrix:
      0     1
0  1448    70
1    14  1540
---- Validation: 
scalar performance:
{'acc': 0.86885244, 'precision': 0.87269986, 'recall': 0.8680235, 'specificity': 0.8680235, 'f1': 0.8682995, 'auroc': 0.9269134, 'binary_precision': 0.9066901, 'binary_recall': 0.8174603, 'binary_specificity': 0.9185868, 'binary_f1_score': 0.85976624}
confusion matrix:
     0    1
0  598   53
1  115  515
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8622222, 'precision': 0.88436145, 'recall': 0.8622222, 'specificity': 0.8622222, 'f1': 0.8602092, 'auroc': 0.9396938, 'binary_precision': 0.9766082, 'binary_recall': 0.74222225, 'binary_specificity': 0.9822222, 'binary_f1_score': 0.8434344}
confusion matrix:
     0    1
0  221    4
1   58  167
early stop counter: 9
val acc:0.868852436542511, best validation acc: 0.874316930770874, corresponding to test acc:                         0.8422222137451172 / 0.8866666555404663
after epoch: 25,now: 2024-07-20 12:18:52.317888,epoch time: 0:01:03.400323,used: 0:26:46.345404,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_11_52_05_seed_1_22478448
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9863281, 'precision': 0.9866593, 'recall': 0.9861972, 'specificity': 0.9861972, 'f1': 0.986321, 'auroc': 0.9996172, 'binary_precision': 0.9766856, 'binary_recall': 0.99678457, 'binary_specificity': 0.9756098, 'binary_f1_score': 0.9866327}
confusion matrix:
      0     1
0  1480    37
1     5  1550
---- Validation: 
scalar performance:
{'acc': 0.863388, 'precision': 0.86704695, 'recall': 0.8625704, 'specificity': 0.8625704, 'f1': 0.8628259, 'auroc': 0.9116305, 'binary_precision': 0.89982426, 'binary_recall': 0.8126984, 'binary_specificity': 0.9124424, 'binary_f1_score': 0.85404503}
confusion matrix:
     0    1
0  594   57
1  118  512
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.85333335, 'precision': 0.85403264, 'recall': 0.85333335, 'specificity': 0.85333335, 'f1': 0.8532609, 'auroc': 0.91359997, 'binary_precision': 0.8697674, 'binary_recall': 0.83111113, 'binary_specificity': 0.8755556, 'binary_f1_score': 0.84999996}
confusion matrix:
     0    1
0  197   28
1   38  187
early stop counter: 10
val acc:0.8633880019187927, best validation acc: 0.874316930770874, corresponding to test acc:                         0.8422222137451172 / 0.8866666555404663
after epoch: 26,now: 2024-07-20 12:19:55.655007,epoch time: 0:01:03.337119,used: 0:27:49.682523,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_11_52_05_seed_1_22478448
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.99153644, 'precision': 0.991528, 'recall': 0.991628, 'specificity': 0.991628, 'f1': 0.9915359, 'auroc': 0.9997643, 'binary_precision': 0.99804944, 'binary_recall': 0.9852375, 'binary_specificity': 0.9980185, 'binary_f1_score': 0.9916021}
confusion matrix:
      0     1
0  1511     3
1    23  1535
---- Validation: 
scalar performance:
{'acc': 0.7010148, 'precision': 0.79114586, 'recall': 0.69639015, 'specificity': 0.69639015, 'f1': 0.6728275, 'auroc': 0.9147557, 'binary_precision': 0.9490909, 'binary_recall': 0.41428572, 'binary_specificity': 0.97849464, 'binary_f1_score': 0.5767956}
confusion matrix:
     0    1
0  637   14
1  369  261
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7777778, 'precision': 0.8335428, 'recall': 0.7777778, 'specificity': 0.7777778, 'f1': 0.7680843, 'auroc': 0.93568397, 'binary_precision': 0.9699248, 'binary_recall': 0.5733333, 'binary_specificity': 0.9822222, 'binary_f1_score': 0.7206704}
confusion matrix:
     0    1
0  221    4
1   96  129
early stop counter: 11
val acc:0.7010148167610168, best validation acc: 0.874316930770874, corresponding to test acc:                         0.8422222137451172 / 0.8866666555404663
after epoch: 27,now: 2024-07-20 12:20:59.215952,epoch time: 0:01:03.560945,used: 0:28:53.243468,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_11_52_05_seed_1_22478448
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.9938151, 'precision': 0.9939172, 'recall': 0.993757, 'specificity': 0.993757, 'f1': 0.9938134, 'auroc': 0.9999232, 'binary_precision': 0.98916507, 'binary_recall': 0.998713, 'binary_specificity': 0.98880106, 'binary_f1_score': 0.9939161}
confusion matrix:
      0     1
0  1501    17
1     2  1552
---- Validation: 
scalar performance:
{'acc': 0.7915691, 'precision': 0.8319744, 'recall': 0.7886841, 'specificity': 0.7886841, 'f1': 0.7838551, 'auroc': 0.90749276, 'binary_precision': 0.9437653, 'binary_recall': 0.61269844, 'binary_specificity': 0.96466976, 'binary_f1_score': 0.74302214}
confusion matrix:
     0    1
0  628   23
1  244  386
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.72, 'precision': 0.7996448, 'recall': 0.72, 'specificity': 0.72, 'f1': 0.7000698, 'auroc': 0.9071013, 'binary_precision': 0.95412844, 'binary_recall': 0.46222222, 'binary_specificity': 0.9777778, 'binary_f1_score': 0.6227545}
confusion matrix:
     0    1
0  220    5
1  121  104
early stop counter: 12
val acc:0.7915691137313843, best validation acc: 0.874316930770874, corresponding to test acc:                         0.8422222137451172 / 0.8866666555404663
after epoch: 28,now: 2024-07-20 12:22:02.372927,epoch time: 0:01:03.156975,used: 0:29:56.400443,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_11_52_05_seed_1_22478448
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.99283856, 'precision': 0.99283755, 'recall': 0.99283755, 'specificity': 0.99283755, 'f1': 0.99283755, 'auroc': 0.9997643, 'binary_precision': 0.9929215, 'binary_recall': 0.9929215, 'binary_specificity': 0.9927536, 'binary_f1_score': 0.9929215}
confusion matrix:
      0     1
0  1507    11
1    11  1543
---- Validation: 
scalar performance:
{'acc': 0.81342703, 'precision': 0.844993, 'recall': 0.8109319, 'specificity': 0.8109319, 'f1': 0.80817306, 'auroc': 0.9214499, 'binary_precision': 0.9453303, 'binary_recall': 0.65873015, 'binary_specificity': 0.96313363, 'binary_f1_score': 0.77642655}
confusion matrix:
     0    1
0  627   24
1  215  415
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6933333, 'precision': 0.790215, 'recall': 0.6933333, 'specificity': 0.6933333, 'f1': 0.66540945, 'auroc': 0.9262024, 'binary_precision': 0.95789474, 'binary_recall': 0.40444446, 'binary_specificity': 0.9822222, 'binary_f1_score': 0.56875}
confusion matrix:
     0   1
0  221   4
1  134  91
early stop counter: 13
val acc:0.8134270310401917, best validation acc: 0.874316930770874, corresponding to test acc:                         0.8422222137451172 / 0.8866666555404663
after epoch: 29,now: 2024-07-20 12:23:06.265107,epoch time: 0:01:03.892180,used: 0:31:00.292623,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_11_52_05_seed_1_22478448
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.9938151, 'precision': 0.99389803, 'recall': 0.99376464, 'specificity': 0.99376464, 'f1': 0.9938135, 'auroc': 0.9999317, 'binary_precision': 0.9897894, 'binary_recall': 0.9980695, 'binary_specificity': 0.9894598, 'binary_f1_score': 0.9939122}
confusion matrix:
      0     1
0  1502    16
1     3  1551
---- Validation: 
scalar performance:
{'acc': 0.785324, 'precision': 0.8281399, 'recall': 0.7823349, 'specificity': 0.7823349, 'f1': 0.77682376, 'auroc': 0.91556275, 'binary_precision': 0.9426434, 'binary_recall': 0.6, 'binary_specificity': 0.96466976, 'binary_f1_score': 0.73326874}
confusion matrix:
     0    1
0  628   23
1  252  378
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.75777775, 'precision': 0.81662464, 'recall': 0.7577778, 'specificity': 0.7577778, 'f1': 0.74597466, 'auroc': 0.9219556, 'binary_precision': 0.953125, 'binary_recall': 0.5422222, 'binary_specificity': 0.97333336, 'binary_f1_score': 0.6912181}
confusion matrix:
     0    1
0  219    6
1  103  122
early stop counter: 14
val acc:0.785323977470398, best validation acc: 0.874316930770874, corresponding to test acc:                         0.8422222137451172 / 0.8866666555404663
after epoch: 30,now: 2024-07-20 12:24:09.460143,epoch time: 0:01:03.195036,used: 0:32:03.487659,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_11_52_05_seed_1_22478448
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 0:32:03.487659 at 2024-07-20 12:24:09.460143
persisted model performance metric: 

scalar performance:
{'acc': 0.8422222, 'precision': 0.84228307, 'recall': 0.8422222, 'specificity': 0.8422222, 'f1': 0.8422152, 'auroc': 0.9175704, 'binary_precision': 0.8377193, 'binary_recall': 0.8488889, 'binary_specificity': 0.83555555, 'binary_f1_score': 0.84326714}
confusion matrix:
     0    1
0  188   37
1   34  191
oracle model performance metric: 

scalar performance:
{'acc': 0.88666666, 'precision': 0.8888867, 'recall': 0.88666666, 'specificity': 0.88666666, 'f1': 0.88650465, 'auroc': 0.9385679, 'binary_precision': 0.9182692, 'binary_recall': 0.8488889, 'binary_specificity': 0.92444444, 'binary_f1_score': 0.8822171}
confusion matrix:
     0    1
0  208   17
1   34  191
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_nofreeze_2024-07-19_18-41-07/rule_results/3.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_nofreeze_2024-07-19_18-41-07/confusion_matrix/3.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 455130 KiB |  13219 MiB | 150811 GiB | 150811 GiB |
|       from large pool | 414531 KiB |  13181 MiB | 149024 GiB | 149024 GiB |
|       from small pool |  40598 KiB |     60 MiB |   1786 GiB |   1786 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 455130 KiB |  13219 MiB | 150811 GiB | 150811 GiB |
|       from large pool | 414531 KiB |  13181 MiB | 149024 GiB | 149024 GiB |
|       from small pool |  40598 KiB |     60 MiB |   1786 GiB |   1786 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 447481 KiB |  13213 MiB | 150269 GiB | 150268 GiB |
|       from large pool | 407075 KiB |  13175 MiB | 148486 GiB | 148485 GiB |
|       from small pool |  40406 KiB |     60 MiB |   1783 GiB |   1783 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  14478 MiB |  14480 MiB |  28078 MiB |  13600 MiB |
|       from large pool |  14408 MiB |  14414 MiB |  27992 MiB |  13584 MiB |
|       from small pool |     70 MiB |     70 MiB |     86 MiB |     16 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 445990 KiB |   1252 MiB | 107699 GiB | 107699 GiB |
|       from large pool | 435388 KiB |   1244 MiB | 105902 GiB | 105901 GiB |
|       from small pool |  10601 KiB |     39 MiB |   1797 GiB |   1797 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    1310    |    2598    |   26309 K  |   26308 K  |
|       from large pool |     187    |    1413    |   13436 K  |   13436 K  |
|       from small pool |    1123    |    1419    |   12873 K  |   12871 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    1310    |    2598    |   26309 K  |   26308 K  |
|       from large pool |     187    |    1413    |   13436 K  |   13436 K  |
|       from small pool |    1123    |    1419    |   12873 K  |   12871 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     636    |     636    |    1208    |     572    |
|       from large pool |     601    |     601    |    1165    |     564    |
|       from small pool |      35    |      35    |      43    |       8    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      95    |     647    |   17547 K  |   17547 K  |
|       from large pool |      40    |     604    |    9731 K  |    9731 K  |
|       from small pool |      55    |     234    |    7815 K  |    7815 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13219 MiB | 150811 GiB | 150811 GiB |
|       from large pool |  16640 KiB |  13181 MiB | 149024 GiB | 149024 GiB |
|       from small pool |      0 KiB |     60 MiB |   1786 GiB |   1786 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13219 MiB | 150811 GiB | 150811 GiB |
|       from large pool |  16640 KiB |  13181 MiB | 149024 GiB | 149024 GiB |
|       from small pool |      0 KiB |     60 MiB |   1786 GiB |   1786 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13213 MiB | 150269 GiB | 150269 GiB |
|       from large pool |  16640 KiB |  13175 MiB | 148486 GiB | 148486 GiB |
|       from small pool |      0 KiB |     60 MiB |   1783 GiB |   1783 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    880 MiB |  14480 MiB |  28078 MiB |  27198 MiB |
|       from large pool |    830 MiB |  14414 MiB |  27992 MiB |  27162 MiB |
|       from small pool |     50 MiB |     70 MiB |     86 MiB |     36 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1252 MiB | 107700 GiB | 107700 GiB |
|       from large pool |  24320 KiB |   1244 MiB | 105902 GiB | 105902 GiB |
|       from small pool |      0 KiB |     40 MiB |   1797 GiB |   1797 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    2598    |   26309 K  |   26309 K  |
|       from large pool |       2    |    1413    |   13436 K  |   13436 K  |
|       from small pool |       0    |    1419    |   12873 K  |   12873 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    2598    |   26309 K  |   26309 K  |
|       from large pool |       2    |    1413    |   13436 K  |   13436 K  |
|       from small pool |       0    |    1419    |   12873 K  |   12873 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      62    |     636    |    1208    |    1146    |
|       from large pool |      37    |     601    |    1165    |    1128    |
|       from small pool |      25    |      35    |      43    |      18    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |     647    |   17547 K  |   17547 K  |
|       from large pool |       4    |     604    |    9731 K  |    9731 K  |
|       from small pool |       0    |     234    |    7816 K  |    7816 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13219 MiB | 150811 GiB | 150811 GiB |
|       from large pool |  16640 KiB |  13181 MiB | 149024 GiB | 149024 GiB |
|       from small pool |      0 KiB |     60 MiB |   1786 GiB |   1786 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13219 MiB | 150811 GiB | 150811 GiB |
|       from large pool |  16640 KiB |  13181 MiB | 149024 GiB | 149024 GiB |
|       from small pool |      0 KiB |     60 MiB |   1786 GiB |   1786 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13213 MiB | 150269 GiB | 150269 GiB |
|       from large pool |  16640 KiB |  13175 MiB | 148486 GiB | 148486 GiB |
|       from small pool |      0 KiB |     60 MiB |   1783 GiB |   1783 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    880 MiB |  14480 MiB |  28078 MiB |  27198 MiB |
|       from large pool |    830 MiB |  14414 MiB |  27992 MiB |  27162 MiB |
|       from small pool |     50 MiB |     70 MiB |     86 MiB |     36 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1252 MiB | 107700 GiB | 107700 GiB |
|       from large pool |  24320 KiB |   1244 MiB | 105902 GiB | 105902 GiB |
|       from small pool |      0 KiB |     40 MiB |   1797 GiB |   1797 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    2598    |   26309 K  |   26309 K  |
|       from large pool |       2    |    1413    |   13436 K  |   13436 K  |
|       from small pool |       0    |    1419    |   12873 K  |   12873 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    2598    |   26309 K  |   26309 K  |
|       from large pool |       2    |    1413    |   13436 K  |   13436 K  |
|       from small pool |       0    |    1419    |   12873 K  |   12873 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      62    |     636    |    1208    |    1146    |
|       from large pool |      37    |     601    |    1165    |    1128    |
|       from small pool |      25    |      35    |      43    |      18    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |     647    |   17547 K  |   17547 K  |
|       from large pool |       4    |     604    |    9731 K  |    9731 K  |
|       from small pool |       0    |     234    |    7816 K  |    7816 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'888c1ef2'
model name: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_12_25_12_seed_2_22478448

 Experiment start at: 2024-07-20 12:25:12.091035
before training, model accuracy: 0.41203704476356506
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9361911, 'precision': 0.9393542, 'recall': 0.9365341, 'specificity': 0.9365341, 'f1': 0.9361068, 'auroc': 0.9870181, 'binary_precision': 0.9786477, 'binary_recall': 0.89285713, 'binary_specificity': 0.9802111, 'binary_f1_score': 0.9337861}
confusion matrix:
      0     1
0  1486    30
1   165  1375
---- Validation: 
scalar performance:
{'acc': 0.75586855, 'precision': 0.8109721, 'recall': 0.7501544, 'specificity': 0.7501544, 'f1': 0.7416315, 'auroc': 0.8975277, 'binary_precision': 0.9353933, 'binary_recall': 0.53536975, 'binary_specificity': 0.964939, 'binary_f1_score': 0.6809816}
confusion matrix:
     0    1
0  633   23
1  289  333
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7824074, 'precision': 0.82996094, 'recall': 0.7824074, 'specificity': 0.7824074, 'f1': 0.7742746, 'auroc': 0.8883959, 'binary_precision': 0.95522386, 'binary_recall': 0.5925926, 'binary_specificity': 0.9722222, 'binary_f1_score': 0.7314285}
confusion matrix:
     0    1
0  210    6
1   88  128
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-20 12:26:25.876053,epoch time: 0:01:13.785018,used: 0:01:13.785018,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_12_25_12_seed_2_22478448
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9646597, 'precision': 0.965045, 'recall': 0.96478605, 'specificity': 0.96478605, 'f1': 0.9646571, 'auroc': 0.9937558, 'binary_precision': 0.98053694, 'binary_recall': 0.9487013, 'binary_specificity': 0.9808707, 'binary_f1_score': 0.9643564}
confusion matrix:
      0     1
0  1487    29
1    79  1461
---- Validation: 
scalar performance:
{'acc': 0.827856, 'precision': 0.82783604, 'recall': 0.8280674, 'specificity': 0.8280674, 'f1': 0.82782185, 'auroc': 0.888325, 'binary_precision': 0.815047, 'binary_recall': 0.83601284, 'binary_specificity': 0.82012194, 'binary_f1_score': 0.82539684}
confusion matrix:
     0    1
0  538  118
1  102  520
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7314815, 'precision': 0.77508914, 'recall': 0.7314815, 'specificity': 0.7314815, 'f1': 0.7204008, 'auroc': 0.9010631, 'binary_precision': 0.6655629, 'binary_recall': 0.9305556, 'binary_specificity': 0.5324074, 'binary_f1_score': 0.7760618}
confusion matrix:
     0    1
0  115  101
1   15  201
better model found
persisted
after epoch: 2,now: 2024-07-20 12:27:27.862875,epoch time: 0:01:01.986822,used: 0:02:15.771840,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_12_25_12_seed_2_22478448
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9826571, 'precision': 0.9826507, 'recall': 0.98266375, 'specificity': 0.98266375, 'f1': 0.98265624, 'auroc': 0.99821645, 'binary_precision': 0.98373455, 'binary_recall': 0.9818182, 'binary_specificity': 0.98350924, 'binary_f1_score': 0.98277545}
confusion matrix:
      0     1
0  1491    25
1    28  1512
---- Validation: 
scalar performance:
{'acc': 0.799687, 'precision': 0.83071524, 'recall': 0.79554546, 'specificity': 0.79554546, 'f1': 0.7932206, 'auroc': 0.8847835, 'binary_precision': 0.9255814, 'binary_recall': 0.63987136, 'binary_specificity': 0.9512195, 'binary_f1_score': 0.75665396}
confusion matrix:
     0    1
0  624   32
1  224  398
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8009259, 'precision': 0.8015723, 'recall': 0.80092597, 'specificity': 0.80092597, 'f1': 0.80081916, 'auroc': 0.8924897, 'binary_precision': 0.815534, 'binary_recall': 0.7777778, 'binary_specificity': 0.8240741, 'binary_f1_score': 0.79620856}
confusion matrix:
     0    1
0  178   38
1   48  168
new oracle model saved
early stop counter: 1
val acc:0.7996870279312134, best validation acc: 0.8278560042381287, corresponding to test acc:                         0.7314814925193787 / 0.8009259104728699
after epoch: 3,now: 2024-07-20 12:28:29.848400,epoch time: 0:01:01.985525,used: 0:03:17.757365,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_12_25_12_seed_2_22478448
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.97316754, 'precision': 0.97416383, 'recall': 0.97336125, 'specificity': 0.97336125, 'f1': 0.97315973, 'auroc': 0.99779105, 'binary_precision': 0.9979508, 'binary_recall': 0.9487013, 'binary_specificity': 0.9980211, 'binary_f1_score': 0.97270304}
confusion matrix:
      0     1
0  1513     3
1    79  1461
---- Validation: 
scalar performance:
{'acc': 0.7691706, 'precision': 0.8228226, 'recall': 0.7636534, 'specificity': 0.7636534, 'f1': 0.7565484, 'auroc': 0.9063823, 'binary_precision': 0.9479452, 'binary_recall': 0.5562701, 'binary_specificity': 0.9710366, 'binary_f1_score': 0.70111454}
confusion matrix:
     0    1
0  637   19
1  276  346
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7592593, 'precision': 0.8375, 'recall': 0.7592592, 'specificity': 0.7592592, 'f1': 0.74444854, 'auroc': 0.90099883, 'binary_precision': 1.0, 'binary_recall': 0.5185185, 'binary_specificity': 1.0, 'binary_f1_score': 0.68292683}
confusion matrix:
     0    1
0  216    0
1  104  112
early stop counter: 2
val acc:0.7691705822944641, best validation acc: 0.8278560042381287, corresponding to test acc:                         0.7314814925193787 / 0.8009259104728699
after epoch: 4,now: 2024-07-20 12:29:31.604256,epoch time: 0:01:01.755856,used: 0:04:19.513221,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_12_25_12_seed_2_22478448
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.983966, 'precision': 0.9839822, 'recall': 0.9839521, 'specificity': 0.9839521, 'f1': 0.98396444, 'auroc': 0.99862325, 'binary_precision': 0.9825243, 'binary_recall': 0.98571426, 'binary_specificity': 0.98218995, 'binary_f1_score': 0.9841166}
confusion matrix:
      0     1
0  1489    27
1    22  1518
---- Validation: 
scalar performance:
{'acc': 0.842723, 'precision': 0.8488891, 'recall': 0.84092426, 'specificity': 0.84092426, 'f1': 0.8414391, 'auroc': 0.89479744, 'binary_precision': 0.8890943, 'binary_recall': 0.7733119, 'binary_specificity': 0.9085366, 'binary_f1_score': 0.82717115}
confusion matrix:
     0    1
0  596   60
1  141  481
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8148148, 'precision': 0.8210071, 'recall': 0.8148148, 'specificity': 0.8148148, 'f1': 0.8139174, 'auroc': 0.9104724, 'binary_precision': 0.8655914, 'binary_recall': 0.7453704, 'binary_specificity': 0.8842593, 'binary_f1_score': 0.800995}
confusion matrix:
     0    1
0  191   25
1   55  161
new oracle model saved
better model found
persisted
after epoch: 5,now: 2024-07-20 12:30:33.702464,epoch time: 0:01:02.098208,used: 0:05:21.611429,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_12_25_12_seed_2_22478448
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9698953, 'precision': 0.97132397, 'recall': 0.9701247, 'specificity': 0.9701247, 'f1': 0.9698813, 'auroc': 0.9976065, 'binary_precision': 0.9993104, 'binary_recall': 0.9409091, 'binary_specificity': 0.99934036, 'binary_f1_score': 0.96923083}
confusion matrix:
      0     1
0  1515     1
1    91  1449
---- Validation: 
scalar performance:
{'acc': 0.7394366, 'precision': 0.8094561, 'recall': 0.73298174, 'specificity': 0.73298174, 'f1': 0.7202121, 'auroc': 0.88886905, 'binary_precision': 0.95015574, 'binary_recall': 0.4903537, 'binary_specificity': 0.9756098, 'binary_f1_score': 0.6468717}
confusion matrix:
     0    1
0  640   16
1  317  305
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5717593, 'precision': 0.74095, 'recall': 0.5717592, 'specificity': 0.5717592, 'f1': 0.48057687, 'auroc': 0.8620113, 'binary_precision': 0.94285715, 'binary_recall': 0.15277778, 'binary_specificity': 0.9907407, 'binary_f1_score': 0.26294822}
confusion matrix:
     0   1
0  214   2
1  183  33
early stop counter: 1
val acc:0.7394366264343262, best validation acc: 0.84272301197052, corresponding to test acc:                         0.8148148059844971 / 0.8148148059844971
after epoch: 6,now: 2024-07-20 12:31:36.309087,epoch time: 0:01:02.606623,used: 0:06:24.218052,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_12_25_12_seed_2_22478448
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.97447646, 'precision': 0.9754751, 'recall': 0.9746702, 'specificity': 0.9746702, 'f1': 0.97446907, 'auroc': 0.9985616, 'binary_precision': 0.99931693, 'binary_recall': 0.95, 'binary_specificity': 0.99934036, 'binary_f1_score': 0.9740346}
confusion matrix:
      0     1
0  1515     1
1    77  1463
---- Validation: 
scalar performance:
{'acc': 0.7746479, 'precision': 0.81857693, 'recall': 0.7696136, 'specificity': 0.7696136, 'f1': 0.76428217, 'auroc': 0.8926003, 'binary_precision': 0.93041235, 'binary_recall': 0.58038586, 'binary_specificity': 0.95884144, 'binary_f1_score': 0.7148515}
confusion matrix:
     0    1
0  629   27
1  261  361
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7615741, 'precision': 0.81506395, 'recall': 0.7615741, 'specificity': 0.7615741, 'f1': 0.7510059, 'auroc': 0.87195647, 'binary_precision': 0.9448819, 'binary_recall': 0.5555556, 'binary_specificity': 0.9675926, 'binary_f1_score': 0.69970846}
confusion matrix:
     0    1
0  209    7
1   96  120
early stop counter: 2
val acc:0.7746478915214539, best validation acc: 0.84272301197052, corresponding to test acc:                         0.8148148059844971 / 0.8148148059844971
after epoch: 7,now: 2024-07-20 12:32:38.255371,epoch time: 0:01:01.946284,used: 0:07:26.164336,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_12_25_12_seed_2_22478448
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.96629584, 'precision': 0.96758807, 'recall': 0.966101, 'specificity': 0.966101, 'f1': 0.9662603, 'auroc': 0.9983972, 'binary_precision': 0.94489163, 'binary_recall': 0.9909091, 'binary_specificity': 0.9412929, 'binary_f1_score': 0.96735334}
confusion matrix:
      0     1
0  1427    89
1    14  1526
---- Validation: 
scalar performance:
{'acc': 0.76760566, 'precision': 0.76775414, 'recall': 0.76792014, 'specificity': 0.76792014, 'f1': 0.7675884, 'auroc': 0.84175813, 'binary_precision': 0.751938, 'binary_recall': 0.7797428, 'binary_specificity': 0.75609756, 'binary_f1_score': 0.765588}
confusion matrix:
     0    1
0  496  160
1  137  485
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6643519, 'precision': 0.6961777, 'recall': 0.6643518, 'specificity': 0.6643518, 'f1': 0.6501633, 'auroc': 0.8210091, 'binary_precision': 0.6171617, 'binary_recall': 0.8657407, 'binary_specificity': 0.46296296, 'binary_f1_score': 0.7206165}
confusion matrix:
     0    1
0  100  116
1   29  187
early stop counter: 3
val acc:0.7676056623458862, best validation acc: 0.84272301197052, corresponding to test acc:                         0.8148148059844971 / 0.8148148059844971
after epoch: 8,now: 2024-07-20 12:33:39.933127,epoch time: 0:01:01.677756,used: 0:08:27.842092,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_12_25_12_seed_2_22478448
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9878927, 'precision': 0.98801386, 'recall': 0.9878431, 'specificity': 0.9878431, 'f1': 0.98789024, 'auroc': 0.9996205, 'binary_precision': 0.98203975, 'binary_recall': 0.9941558, 'binary_specificity': 0.98153037, 'binary_f1_score': 0.98806065}
confusion matrix:
      0     1
0  1488    28
1     9  1531
---- Validation: 
scalar performance:
{'acc': 0.8458529, 'precision': 0.84669197, 'recall': 0.8451396, 'specificity': 0.8451396, 'f1': 0.8454774, 'auroc': 0.9021817, 'binary_precision': 0.8583474, 'binary_recall': 0.81832796, 'binary_specificity': 0.8719512, 'binary_f1_score': 0.8378601}
confusion matrix:
     0    1
0  572   84
1  113  509
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8263889, 'precision': 0.83082056, 'recall': 0.8263889, 'specificity': 0.8263889, 'f1': 0.82580554, 'auroc': 0.92594737, 'binary_precision': 0.79253113, 'binary_recall': 0.8842593, 'binary_specificity': 0.7685185, 'binary_f1_score': 0.8358862}
confusion matrix:
     0    1
0  166   50
1   25  191
new oracle model saved
better model found
persisted
after epoch: 9,now: 2024-07-20 12:34:42.217493,epoch time: 0:01:02.284366,used: 0:09:30.126458,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_12_25_12_seed_2_22478448
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.983966, 'precision': 0.98396015, 'recall': 0.9839881, 'specificity': 0.9839881, 'f1': 0.9839655, 'auroc': 0.9982995, 'binary_precision': 0.9869366, 'binary_recall': 0.9811688, 'binary_specificity': 0.9868074, 'binary_f1_score': 0.98404425}
confusion matrix:
      0     1
0  1496    20
1    29  1511
---- Validation: 
scalar performance:
{'acc': 0.80672926, 'precision': 0.83089304, 'recall': 0.80307186, 'specificity': 0.80307186, 'f1': 0.8017267, 'auroc': 0.89251274, 'binary_precision': 0.9139073, 'binary_recall': 0.6655949, 'binary_specificity': 0.9405488, 'binary_f1_score': 0.77023256}
confusion matrix:
     0    1
0  617   39
1  208  414
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8217593, 'precision': 0.82766557, 'recall': 0.8217592, 'specificity': 0.8217592, 'f1': 0.8209524, 'auroc': 0.8913537, 'binary_precision': 0.8716577, 'binary_recall': 0.7546296, 'binary_specificity': 0.8888889, 'binary_f1_score': 0.80893296}
confusion matrix:
     0    1
0  192   24
1   53  163
early stop counter: 1
val acc:0.806729257106781, best validation acc: 0.8458529114723206, corresponding to test acc:                         0.8263888955116272 / 0.8263888955116272
after epoch: 10,now: 2024-07-20 12:35:44.079232,epoch time: 0:01:01.861739,used: 0:10:31.988197,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_12_25_12_seed_2_22478448
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9856021, 'precision': 0.98580956, 'recall': 0.9856989, 'specificity': 0.9856989, 'f1': 0.9856018, 'auroc': 0.9981098, 'binary_precision': 0.99800265, 'binary_recall': 0.97337663, 'binary_specificity': 0.9980211, 'binary_f1_score': 0.9855358}
confusion matrix:
      0     1
0  1513     3
1    41  1499
---- Validation: 
scalar performance:
{'acc': 0.7543036, 'precision': 0.8031952, 'recall': 0.7488383, 'specificity': 0.7488383, 'f1': 0.7411587, 'auroc': 0.8776781, 'binary_precision': 0.91847825, 'binary_recall': 0.54340833, 'binary_specificity': 0.9542683, 'binary_f1_score': 0.68282825}
confusion matrix:
     0    1
0  626   30
1  284  338
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8263889, 'precision': 0.8385881, 'recall': 0.8263889, 'specificity': 0.8263889, 'f1': 0.8248109, 'auroc': 0.9023705, 'binary_precision': 0.9028571, 'binary_recall': 0.7314815, 'binary_specificity': 0.9212963, 'binary_f1_score': 0.80818415}
confusion matrix:
     0    1
0  199   17
1   58  158
early stop counter: 2
val acc:0.7543035745620728, best validation acc: 0.8458529114723206, corresponding to test acc:                         0.8263888955116272 / 0.8263888955116272
after epoch: 11,now: 2024-07-20 12:36:48.617907,epoch time: 0:01:04.538675,used: 0:11:36.526872,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_12_25_12_seed_2_22478448
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.99247384, 'precision': 0.99247605, 'recall': 0.9924708, 'specificity': 0.9924708, 'f1': 0.9924733, 'auroc': 0.99939907, 'binary_precision': 0.99221283, 'binary_recall': 0.99285716, 'binary_specificity': 0.99208444, 'binary_f1_score': 0.9925349}
confusion matrix:
      0     1
0  1504    12
1    11  1529
---- Validation: 
scalar performance:
{'acc': 0.7683881, 'precision': 0.82339144, 'recall': 0.76280785, 'specificity': 0.76280785, 'f1': 0.7554459, 'auroc': 0.90564954, 'binary_precision': 0.95027626, 'binary_recall': 0.5530547, 'binary_specificity': 0.972561, 'binary_f1_score': 0.699187}
confusion matrix:
     0    1
0  638   18
1  278  344
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7268519, 'precision': 0.8187952, 'recall': 0.7268519, 'specificity': 0.7268519, 'f1': 0.70562685, 'auroc': 0.91730964, 'binary_precision': 0.99, 'binary_recall': 0.45833334, 'binary_specificity': 0.9953704, 'binary_f1_score': 0.62658226}
confusion matrix:
     0   1
0  215   1
1  117  99
early stop counter: 3
val acc:0.7683880925178528, best validation acc: 0.8458529114723206, corresponding to test acc:                         0.8263888955116272 / 0.8263888955116272
after epoch: 12,now: 2024-07-20 12:37:50.336494,epoch time: 0:01:01.718587,used: 0:12:38.245459,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_12_25_12_seed_2_22478448
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9856021, 'precision': 0.9856932, 'recall': 0.98556006, 'specificity': 0.98556006, 'f1': 0.98559964, 'auroc': 0.99881524, 'binary_precision': 0.9807198, 'binary_recall': 0.9909091, 'binary_specificity': 0.9802111, 'binary_f1_score': 0.98578817}
confusion matrix:
      0     1
0  1486    30
1    14  1526
---- Validation: 
scalar performance:
{'acc': 0.85524255, 'precision': 0.85787976, 'recall': 0.8540776, 'specificity': 0.8540776, 'f1': 0.85459936, 'auroc': 0.90724504, 'binary_precision': 0.882662, 'binary_recall': 0.8102894, 'binary_specificity': 0.89786583, 'binary_f1_score': 0.8449287}
confusion matrix:
     0    1
0  589   67
1  118  504
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8657407, 'precision': 0.866873, 'recall': 0.8657408, 'specificity': 0.8657408, 'f1': 0.86563706, 'auroc': 0.9310057, 'binary_precision': 0.8872549, 'binary_recall': 0.837963, 'binary_specificity': 0.8935185, 'binary_f1_score': 0.8619048}
confusion matrix:
     0    1
0  193   23
1   35  181
new oracle model saved
better model found
persisted
after epoch: 13,now: 2024-07-20 12:38:52.582071,epoch time: 0:01:02.245577,used: 0:13:40.491036,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_12_25_12_seed_2_22478448
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.986911, 'precision': 0.98709285, 'recall': 0.98700273, 'specificity': 0.98700273, 'f1': 0.9869108, 'auroc': 0.9992311, 'binary_precision': 0.9986702, 'binary_recall': 0.9753247, 'binary_specificity': 0.9986807, 'binary_f1_score': 0.9868594}
confusion matrix:
      0     1
0  1514     2
1    38  1502
---- Validation: 
scalar performance:
{'acc': 0.69405323, 'precision': 0.7848527, 'recall': 0.686358, 'specificity': 0.686358, 'f1': 0.6621002, 'auroc': 0.8554378, 'binary_precision': 0.9391635, 'binary_recall': 0.3971061, 'binary_specificity': 0.9756098, 'binary_f1_score': 0.5581921}
confusion matrix:
     0    1
0  640   16
1  375  247
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6898148, 'precision': 0.8029556, 'recall': 0.6898148, 'specificity': 0.6898148, 'f1': 0.6578723, 'auroc': 0.9049211, 'binary_precision': 0.9880952, 'binary_recall': 0.38425925, 'binary_specificity': 0.9953704, 'binary_f1_score': 0.55333334}
confusion matrix:
     0   1
0  215   1
1  133  83
early stop counter: 1
val acc:0.6940532326698303, best validation acc: 0.8552425503730774, corresponding to test acc:                         0.8657407164573669 / 0.8657407164573669
after epoch: 14,now: 2024-07-20 12:39:54.511105,epoch time: 0:01:01.929034,used: 0:14:42.420070,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_12_25_12_seed_2_22478448
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9931283, 'precision': 0.9931207, 'recall': 0.9931407, 'specificity': 0.9931407, 'f1': 0.993128, 'auroc': 0.9998213, 'binary_precision': 0.9947883, 'binary_recall': 0.99155843, 'binary_specificity': 0.99472296, 'binary_f1_score': 0.99317074}
confusion matrix:
      0     1
0  1508     8
1    13  1527
---- Validation: 
scalar performance:
{'acc': 0.8231612, 'precision': 0.8478838, 'recall': 0.8195779, 'specificity': 0.8195779, 'f1': 0.81872165, 'auroc': 0.9121711, 'binary_precision': 0.93421054, 'binary_recall': 0.68488747, 'binary_specificity': 0.9542683, 'binary_f1_score': 0.7903526}
confusion matrix:
     0    1
0  626   30
1  196  426
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8402778, 'precision': 0.8505642, 'recall': 0.8402778, 'specificity': 0.8402778, 'f1': 0.83909744, 'auroc': 0.9168167, 'binary_precision': 0.91061455, 'binary_recall': 0.7546296, 'binary_specificity': 0.9259259, 'binary_f1_score': 0.8253165}
confusion matrix:
     0    1
0  200   16
1   53  163
early stop counter: 2
val acc:0.8231611847877502, best validation acc: 0.8552425503730774, corresponding to test acc:                         0.8657407164573669 / 0.8657407164573669
after epoch: 15,now: 2024-07-20 12:40:56.593574,epoch time: 0:01:02.082469,used: 0:15:44.502539,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_12_25_12_seed_2_22478448
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9947644, 'precision': 0.99475753, 'recall': 0.9947846, 'specificity': 0.9947846, 'f1': 0.9947642, 'auroc': 0.9997661, 'binary_precision': 0.997389, 'binary_recall': 0.99220777, 'binary_specificity': 0.9973615, 'binary_f1_score': 0.99479157}
confusion matrix:
      0     1
0  1512     4
1    12  1528
---- Validation: 
scalar performance:
{'acc': 0.7292645, 'precision': 0.8013816, 'recall': 0.7226149, 'specificity': 0.7226149, 'f1': 0.7081167, 'auroc': 0.88327634, 'binary_precision': 0.9423077, 'binary_recall': 0.4726688, 'binary_specificity': 0.972561, 'binary_f1_score': 0.62955034}
confusion matrix:
     0    1
0  638   18
1  328  294
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8171296, 'precision': 0.8487073, 'recall': 0.8171296, 'specificity': 0.8171296, 'f1': 0.81289375, 'auroc': 0.91248715, 'binary_precision': 0.95364237, 'binary_recall': 0.6666667, 'binary_specificity': 0.9675926, 'binary_f1_score': 0.78474116}
confusion matrix:
     0    1
0  209    7
1   72  144
early stop counter: 3
val acc:0.729264497756958, best validation acc: 0.8552425503730774, corresponding to test acc:                         0.8657407164573669 / 0.8657407164573669
after epoch: 16,now: 2024-07-20 12:41:59.051196,epoch time: 0:01:02.457622,used: 0:16:46.960161,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_12_25_12_seed_2_22478448
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9911649, 'precision': 0.9911737, 'recall': 0.9911567, 'specificity': 0.9911567, 'f1': 0.9911642, 'auroc': 0.9995502, 'binary_precision': 0.99027866, 'binary_recall': 0.99220777, 'binary_specificity': 0.99010557, 'binary_f1_score': 0.99124223}
confusion matrix:
      0     1
0  1501    15
1    12  1528
---- Validation: 
scalar performance:
{'acc': 0.7597809, 'precision': 0.82066166, 'recall': 0.75388205, 'specificity': 0.75388205, 'f1': 0.7448659, 'auroc': 0.90776646, 'binary_precision': 0.9538905, 'binary_recall': 0.5321543, 'binary_specificity': 0.9756098, 'binary_f1_score': 0.6831785}
confusion matrix:
     0    1
0  640   16
1  291  331
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.712963, 'precision': 0.8035562, 'recall': 0.712963, 'specificity': 0.712963, 'f1': 0.6898205, 'auroc': 0.9265689, 'binary_precision': 0.96938777, 'binary_recall': 0.4398148, 'binary_specificity': 0.9861111, 'binary_f1_score': 0.60509557}
confusion matrix:
     0   1
0  213   3
1  121  95
early stop counter: 4
val acc:0.7597808837890625, best validation acc: 0.8552425503730774, corresponding to test acc:                         0.8657407164573669 / 0.8657407164573669
after epoch: 17,now: 2024-07-20 12:43:00.956830,epoch time: 0:01:01.905634,used: 0:17:48.865795,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_12_25_12_seed_2_22478448
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9878927, 'precision': 0.9880624, 'recall': 0.98798186, 'specificity': 0.98798186, 'f1': 0.9878925, 'auroc': 0.9995028, 'binary_precision': 0.9993355, 'binary_recall': 0.97662336, 'binary_specificity': 0.99934036, 'binary_f1_score': 0.98784894}
confusion matrix:
      0     1
0  1515     1
1    36  1504
---- Validation: 
scalar performance:
{'acc': 0.6087637, 'precision': 0.75841534, 'recall': 0.5983624, 'specificity': 0.5983624, 'f1': 0.5311413, 'auroc': 0.89195454, 'binary_precision': 0.9485294, 'binary_recall': 0.2073955, 'binary_specificity': 0.9893293, 'binary_f1_score': 0.3403694}
confusion matrix:
     0    1
0  649    7
1  493  129
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.525463, 'precision': 0.65139544, 'recall': 0.525463, 'specificity': 0.525463, 'f1': 0.4008727, 'auroc': 0.8488083, 'binary_precision': 0.7894737, 'binary_recall': 0.06944445, 'binary_specificity': 0.9814815, 'binary_f1_score': 0.12765957}
confusion matrix:
     0   1
0  212   4
1  201  15
early stop counter: 5
val acc:0.6087636947631836, best validation acc: 0.8552425503730774, corresponding to test acc:                         0.8657407164573669 / 0.8657407164573669
after epoch: 18,now: 2024-07-20 12:44:02.798015,epoch time: 0:01:01.841185,used: 0:18:50.706980,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_12_25_12_seed_2_22478448
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.99018323, 'precision': 0.9901786, 'recall': 0.99018776, 'specificity': 0.99018776, 'f1': 0.99018276, 'auroc': 0.9996021, 'binary_precision': 0.9908973, 'binary_recall': 0.9896104, 'binary_specificity': 0.99076515, 'binary_f1_score': 0.99025345}
confusion matrix:
      0     1
0  1502    14
1    16  1524
---- Validation: 
scalar performance:
{'acc': 0.79890454, 'precision': 0.838725, 'recall': 0.7942833, 'specificity': 0.7942833, 'f1': 0.79096955, 'auroc': 0.9099238, 'binary_precision': 0.94840294, 'binary_recall': 0.62057877, 'binary_specificity': 0.9679878, 'binary_f1_score': 0.750243}
confusion matrix:
     0    1
0  635   21
1  236  386
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6689815, 'precision': 0.7827124, 'recall': 0.6689815, 'specificity': 0.6689815, 'f1': 0.6319681, 'auroc': 0.89111793, 'binary_precision': 0.96202534, 'binary_recall': 0.35185185, 'binary_specificity': 0.9861111, 'binary_f1_score': 0.5152542}
confusion matrix:
     0   1
0  213   3
1  140  76
early stop counter: 6
val acc:0.798904538154602, best validation acc: 0.8552425503730774, corresponding to test acc:                         0.8657407164573669 / 0.8657407164573669
after epoch: 19,now: 2024-07-20 12:45:04.934337,epoch time: 0:01:02.136322,used: 0:19:52.843302,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_12_25_12_seed_2_22478448
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9937827, 'precision': 0.9937751, 'recall': 0.99379516, 'specificity': 0.99379516, 'f1': 0.9937825, 'auroc': 0.9997914, 'binary_precision': 0.99543977, 'binary_recall': 0.99220777, 'binary_specificity': 0.9953826, 'binary_f1_score': 0.99382114}
confusion matrix:
      0     1
0  1509     7
1    12  1528
---- Validation: 
scalar performance:
{'acc': 0.8380282, 'precision': 0.84668946, 'recall': 0.8358928, 'specificity': 0.8358928, 'f1': 0.83630824, 'auroc': 0.91312444, 'binary_precision': 0.8952381, 'binary_recall': 0.75562704, 'binary_specificity': 0.91615856, 'binary_f1_score': 0.81952924}
confusion matrix:
     0    1
0  601   55
1  152  470
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8217593, 'precision': 0.8337854, 'recall': 0.8217593, 'specificity': 0.8217593, 'f1': 0.82013917, 'auroc': 0.9069787, 'binary_precision': 0.8971428, 'binary_recall': 0.7268519, 'binary_specificity': 0.9166667, 'binary_f1_score': 0.80306906}
confusion matrix:
     0    1
0  198   18
1   59  157
early stop counter: 7
val acc:0.8380281925201416, best validation acc: 0.8552425503730774, corresponding to test acc:                         0.8657407164573669 / 0.8657407164573669
after epoch: 20,now: 2024-07-20 12:46:08.876434,epoch time: 0:01:03.942097,used: 0:20:56.785399,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_12_25_12_seed_2_22478448
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.989856, 'precision': 0.9899604, 'recall': 0.9899299, 'specificity': 0.9899299, 'f1': 0.989856, 'auroc': 0.9998059, 'binary_precision': 0.9993382, 'binary_recall': 0.9805195, 'binary_specificity': 0.99934036, 'binary_f1_score': 0.9898394}
confusion matrix:
      0     1
0  1515     1
1    30  1510
---- Validation: 
scalar performance:
{'acc': 0.6189358, 'precision': 0.770049, 'recall': 0.60872924, 'specificity': 0.60872924, 'f1': 0.54641974, 'auroc': 0.891302, 'binary_precision': 0.9655172, 'binary_recall': 0.22508039, 'binary_specificity': 0.99237806, 'binary_f1_score': 0.36505863}
confusion matrix:
     0    1
0  651    5
1  482  140
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5138889, 'precision': 0.6285714, 'recall': 0.5138889, 'specificity': 0.5138889, 'f1': 0.37437934, 'auroc': 0.81543636, 'binary_precision': 0.75, 'binary_recall': 0.041666668, 'binary_specificity': 0.9861111, 'binary_f1_score': 0.078947365}
confusion matrix:
     0  1
0  213  3
1  207  9
early stop counter: 8
val acc:0.6189358234405518, best validation acc: 0.8552425503730774, corresponding to test acc:                         0.8657407164573669 / 0.8657407164573669
after epoch: 21,now: 2024-07-20 12:47:11.116834,epoch time: 0:01:02.240400,used: 0:21:59.025799,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_12_25_12_seed_2_22478448
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.97938484, 'precision': 0.98029345, 'recall': 0.9792268, 'specificity': 0.9792268, 'f1': 0.97936887, 'auroc': 0.9995661, 'binary_precision': 0.9612742, 'binary_recall': 0.99935067, 'binary_specificity': 0.9591029, 'binary_f1_score': 0.9799427}
confusion matrix:
      0     1
0  1454    62
1     1  1539
---- Validation: 
scalar performance:
{'acc': 0.8325509, 'precision': 0.8325826, 'recall': 0.83222395, 'specificity': 0.83222395, 'f1': 0.8323521, 'auroc': 0.89851224, 'binary_precision': 0.8333333, 'binary_recall': 0.8199357, 'binary_specificity': 0.8445122, 'binary_f1_score': 0.82658017}
confusion matrix:
     0    1
0  554  102
1  112  510
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7731481, 'precision': 0.77352333, 'recall': 0.7731482, 'specificity': 0.7731482, 'f1': 0.77307034, 'auroc': 0.856653, 'binary_precision': 0.78365386, 'binary_recall': 0.7546296, 'binary_specificity': 0.7916667, 'binary_f1_score': 0.7688679}
confusion matrix:
     0    1
0  171   45
1   53  163
early stop counter: 9
val acc:0.8325508832931519, best validation acc: 0.8552425503730774, corresponding to test acc:                         0.8657407164573669 / 0.8657407164573669
after epoch: 22,now: 2024-07-20 12:48:12.857286,epoch time: 0:01:01.740452,used: 0:23:00.766251,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_12_25_12_seed_2_22478448
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.98134816, 'precision': 0.98188174, 'recall': 0.9814935, 'specificity': 0.9814935, 'f1': 0.981346, 'auroc': 0.9990063, 'binary_precision': 1.0, 'binary_recall': 0.962987, 'binary_specificity': 1.0, 'binary_f1_score': 0.9811446}
confusion matrix:
      0     1
0  1516     0
1    57  1483
---- Validation: 
scalar performance:
{'acc': 0.6064163, 'precision': 0.75709033, 'recall': 0.59595084, 'specificity': 0.59595084, 'f1': 0.5272428, 'auroc': 0.8847713, 'binary_precision': 0.94736844, 'binary_recall': 0.20257235, 'binary_specificity': 0.9893293, 'binary_f1_score': 0.33377486}
confusion matrix:
     0    1
0  649    7
1  496  126
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5972222, 'precision': 0.74609375, 'recall': 0.5972222, 'specificity': 0.5972222, 'f1': 0.5254545, 'auroc': 0.8781507, 'binary_precision': 0.9375, 'binary_recall': 0.20833333, 'binary_specificity': 0.9861111, 'binary_f1_score': 0.3409091}
confusion matrix:
     0   1
0  213   3
1  171  45
early stop counter: 10
val acc:0.6064162850379944, best validation acc: 0.8552425503730774, corresponding to test acc:                         0.8657407164573669 / 0.8657407164573669
after epoch: 23,now: 2024-07-20 12:49:14.874756,epoch time: 0:01:02.017470,used: 0:24:02.783721,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_12_25_12_seed_2_22478448
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9780759, 'precision': 0.9790946, 'recall': 0.97790754, 'specificity': 0.97790754, 'f1': 0.97805727, 'auroc': 0.9997699, 'binary_precision': 0.9588785, 'binary_recall': 0.99935067, 'binary_specificity': 0.95646435, 'binary_f1_score': 0.97869635}
confusion matrix:
      0     1
0  1450    66
1     1  1539
---- Validation: 
scalar performance:
{'acc': 0.8403756, 'precision': 0.8426397, 'recall': 0.8414708, 'specificity': 0.8414708, 'f1': 0.84031934, 'auroc': 0.91954064, 'binary_precision': 0.80735296, 'binary_recall': 0.88263667, 'binary_specificity': 0.8003049, 'binary_f1_score': 0.84331805}
confusion matrix:
     0    1
0  525  131
1   73  549
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.849537, 'precision': 0.85044587, 'recall': 0.849537, 'specificity': 0.849537, 'f1': 0.8494394, 'auroc': 0.9354424, 'binary_precision': 0.8325991, 'binary_recall': 0.875, 'binary_specificity': 0.8240741, 'binary_f1_score': 0.8532731}
confusion matrix:
     0    1
0  178   38
1   27  189
early stop counter: 11
val acc:0.8403756022453308, best validation acc: 0.8552425503730774, corresponding to test acc:                         0.8657407164573669 / 0.8657407164573669
after epoch: 24,now: 2024-07-20 12:50:17.107518,epoch time: 0:01:02.232762,used: 0:25:05.016483,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_12_25_12_seed_2_22478448
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.99051046, 'precision': 0.9905286, 'recall': 0.99055356, 'specificity': 0.99055356, 'f1': 0.9905104, 'auroc': 0.9996381, 'binary_precision': 0.99606043, 'binary_recall': 0.9850649, 'binary_specificity': 0.9960422, 'binary_f1_score': 0.99053216}
confusion matrix:
      0     1
0  1510     6
1    23  1517
---- Validation: 
scalar performance:
{'acc': 0.63380283, 'precision': 0.7769464, 'recall': 0.6240025, 'specificity': 0.6240025, 'f1': 0.5700867, 'auroc': 0.88564134, 'binary_precision': 0.9695122, 'binary_recall': 0.255627, 'binary_specificity': 0.99237806, 'binary_f1_score': 0.40458015}
confusion matrix:
     0    1
0  651    5
1  463  159
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6643519, 'precision': 0.79916894, 'recall': 0.6643518, 'specificity': 0.6643518, 'f1': 0.6217369, 'auroc': 0.8805512, 'binary_precision': 1.0, 'binary_recall': 0.3287037, 'binary_specificity': 1.0, 'binary_f1_score': 0.49477354}
confusion matrix:
     0   1
0  216   0
1  145  71
early stop counter: 12
val acc:0.6338028311729431, best validation acc: 0.8552425503730774, corresponding to test acc:                         0.8657407164573669 / 0.8657407164573669
after epoch: 25,now: 2024-07-20 12:51:20.389408,epoch time: 0:01:03.281890,used: 0:26:08.298373,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_12_25_12_seed_2_22478448
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9931283, 'precision': 0.9931464, 'recall': 0.9931715, 'specificity': 0.9931715, 'f1': 0.99312824, 'auroc': 0.99973613, 'binary_precision': 0.9986868, 'binary_recall': 0.9876623, 'binary_specificity': 0.9986807, 'binary_f1_score': 0.993144}
confusion matrix:
      0     1
0  1514     2
1    19  1521
---- Validation: 
scalar performance:
{'acc': 0.7143975, 'precision': 0.8061688, 'recall': 0.70696664, 'specificity': 0.70696664, 'f1': 0.68653804, 'auroc': 0.89970636, 'binary_precision': 0.9672727, 'binary_recall': 0.42765275, 'binary_specificity': 0.9862805, 'binary_f1_score': 0.5930881}
confusion matrix:
     0    1
0  647    9
1  356  266
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5555556, 'precision': 0.74554753, 'recall': 0.5555556, 'specificity': 0.5555556, 'f1': 0.44896492, 'auroc': 0.87307096, 'binary_precision': 0.96153843, 'binary_recall': 0.11574074, 'binary_specificity': 0.9953704, 'binary_f1_score': 0.20661156}
confusion matrix:
     0   1
0  215   1
1  191  25
early stop counter: 13
val acc:0.7143974900245667, best validation acc: 0.8552425503730774, corresponding to test acc:                         0.8657407164573669 / 0.8657407164573669
after epoch: 26,now: 2024-07-20 12:52:22.620448,epoch time: 0:01:02.231040,used: 0:27:10.529413,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_12_25_12_seed_2_22478448
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.98756546, 'precision': 0.9877735, 'recall': 0.9876623, 'specificity': 0.9876623, 'f1': 0.98756516, 'auroc': 0.99957854, 'binary_precision': 1.0, 'binary_recall': 0.9753247, 'binary_specificity': 1.0, 'binary_f1_score': 0.98750824}
confusion matrix:
      0     1
0  1516     0
1    38  1502
---- Validation: 
scalar performance:
{'acc': 0.6181534, 'precision': 0.78671324, 'recall': 0.60771704, 'specificity': 0.60771704, 'f1': 0.5416931, 'auroc': 0.9177687, 'binary_precision': 1.0, 'binary_recall': 0.21543409, 'binary_specificity': 1.0, 'binary_f1_score': 0.35449737}
confusion matrix:
     0    1
0  656    0
1  488  134
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5300926, 'precision': 0.7244604, 'recall': 0.5300926, 'specificity': 0.5300926, 'f1': 0.40025848, 'auroc': 0.9243399, 'binary_precision': 0.93333334, 'binary_recall': 0.06481481, 'binary_specificity': 0.9953704, 'binary_f1_score': 0.121212125}
confusion matrix:
     0   1
0  215   1
1  202  14
early stop counter: 14
val acc:0.6181533932685852, best validation acc: 0.8552425503730774, corresponding to test acc:                         0.8657407164573669 / 0.8657407164573669
after epoch: 27,now: 2024-07-20 12:53:24.855215,epoch time: 0:01:02.234767,used: 0:28:12.764180,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_12_25_12_seed_2_22478448
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.98920155, 'precision': 0.98932606, 'recall': 0.9892806, 'specificity': 0.9892806, 'f1': 0.98920155, 'auroc': 0.9996543, 'binary_precision': 0.9993373, 'binary_recall': 0.9792208, 'binary_specificity': 0.99934036, 'binary_f1_score': 0.9891768}
confusion matrix:
      0     1
0  1515     1
1    32  1508
---- Validation: 
scalar performance:
{'acc': 0.64241004, 'precision': 0.7834619, 'recall': 0.6328033, 'specificity': 0.6328033, 'f1': 0.5828228, 'auroc': 0.91065466, 'binary_precision': 0.9768786, 'binary_recall': 0.27170417, 'binary_specificity': 0.99390244, 'binary_f1_score': 0.42515722}
confusion matrix:
     0    1
0  652    4
1  453  169
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5208333, 'precision': 0.7553191, 'recall': 0.5208333, 'specificity': 0.5208333, 'f1': 0.37802818, 'auroc': 0.9065286, 'binary_precision': 1.0, 'binary_recall': 0.041666668, 'binary_specificity': 1.0, 'binary_f1_score': 0.080000006}
confusion matrix:
     0  1
0  216  0
1  207  9
early stop counter: 15
val acc:0.6424100399017334, best validation acc: 0.8552425503730774, corresponding to test acc:                         0.8657407164573669 / 0.8657407164573669
after epoch: 28,now: 2024-07-20 12:54:26.580437,epoch time: 0:01:01.725222,used: 0:29:14.489402,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_12_25_12_seed_2_22478448
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9957461, 'precision': 0.9957553, 'recall': 0.99573815, 'specificity': 0.99573815, 'f1': 0.9957458, 'auroc': 0.9998681, 'binary_precision': 0.9948153, 'binary_recall': 0.9967533, 'binary_specificity': 0.99472296, 'binary_f1_score': 0.9957833}
confusion matrix:
      0     1
0  1508     8
1     5  1535
---- Validation: 
scalar performance:
{'acc': 0.81220657, 'precision': 0.8335831, 'recall': 0.80878216, 'specificity': 0.80878216, 'f1': 0.80787015, 'auroc': 0.8947092, 'binary_precision': 0.9116379, 'binary_recall': 0.6800643, 'binary_specificity': 0.9375, 'binary_f1_score': 0.7790055}
confusion matrix:
     0    1
0  615   41
1  199  423
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7685185, 'precision': 0.81910336, 'recall': 0.7685185, 'specificity': 0.7685185, 'f1': 0.7589662, 'auroc': 0.8926612, 'binary_precision': 0.9461538, 'binary_recall': 0.5694444, 'binary_specificity': 0.9675926, 'binary_f1_score': 0.71098256}
confusion matrix:
     0    1
0  209    7
1   93  123
early stop counter: 16
val acc:0.8122065663337708, best validation acc: 0.8552425503730774, corresponding to test acc:                         0.8657407164573669 / 0.8657407164573669
after epoch: 29,now: 2024-07-20 12:55:28.445500,epoch time: 0:01:01.865063,used: 0:30:16.354465,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_12_25_12_seed_2_22478448
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.9937827, 'precision': 0.99379176, 'recall': 0.99377465, 'specificity': 0.99377465, 'f1': 0.9937823, 'auroc': 0.9998578, 'binary_precision': 0.99287105, 'binary_recall': 0.9948052, 'binary_specificity': 0.9927441, 'binary_f1_score': 0.9938372}
confusion matrix:
      0     1
0  1505    11
1     8  1532
---- Validation: 
scalar performance:
{'acc': 0.7143975, 'precision': 0.8125951, 'recall': 0.7068, 'specificity': 0.7068, 'f1': 0.685235, 'auroc': 0.89948094, 'binary_precision': 0.9812734, 'binary_recall': 0.42122185, 'binary_specificity': 0.99237806, 'binary_f1_score': 0.5894263}
confusion matrix:
     0    1
0  651    5
1  360  262
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5046296, 'precision': 0.75116277, 'recall': 0.5046296, 'specificity': 0.5046296, 'f1': 0.34353966, 'auroc': 0.79286695, 'binary_precision': 1.0, 'binary_recall': 0.009259259, 'binary_specificity': 1.0, 'binary_f1_score': 0.018348625}
confusion matrix:
     0  1
0  216  0
1  214  2
early stop counter: 17
val acc:0.7143974900245667, best validation acc: 0.8552425503730774, corresponding to test acc:                         0.8657407164573669 / 0.8657407164573669
after epoch: 30,now: 2024-07-20 12:56:30.687238,epoch time: 0:01:02.241738,used: 0:31:18.596203,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_12_25_12_seed_2_22478448
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 0:31:18.596203 at 2024-07-20 12:56:30.687238
persisted model performance metric: 

scalar performance:
{'acc': 0.8657407, 'precision': 0.866873, 'recall': 0.8657408, 'specificity': 0.8657408, 'f1': 0.86563706, 'auroc': 0.9310057, 'binary_precision': 0.8872549, 'binary_recall': 0.837963, 'binary_specificity': 0.8935185, 'binary_f1_score': 0.8619048}
confusion matrix:
     0    1
0  193   23
1   35  181
oracle model performance metric: 

scalar performance:
{'acc': 0.8657407, 'precision': 0.866873, 'recall': 0.8657408, 'specificity': 0.8657408, 'f1': 0.86563706, 'auroc': 0.9310057, 'binary_precision': 0.8872549, 'binary_recall': 0.837963, 'binary_specificity': 0.8935185, 'binary_f1_score': 0.8619048}
confusion matrix:
     0    1
0  193   23
1   35  181
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_nofreeze_2024-07-19_18-41-07/rule_results/3.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_nofreeze_2024-07-19_18-41-07/confusion_matrix/3.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 455124 KiB |  13219 MiB | 224959 GiB | 224959 GiB |
|       from large pool | 414531 KiB |  13181 MiB | 222294 GiB | 222294 GiB |
|       from small pool |  40592 KiB |     60 MiB |   2665 GiB |   2665 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 455124 KiB |  13219 MiB | 224959 GiB | 224959 GiB |
|       from large pool | 414531 KiB |  13181 MiB | 222294 GiB | 222294 GiB |
|       from small pool |  40592 KiB |     60 MiB |   2665 GiB |   2665 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 447481 KiB |  13213 MiB | 224366 GiB | 224366 GiB |
|       from large pool | 407075 KiB |  13175 MiB | 221706 GiB | 221706 GiB |
|       from small pool |  40406 KiB |     60 MiB |   2659 GiB |   2659 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  14474 MiB |  14480 MiB |  41672 MiB |  27198 MiB |
|       from large pool |  14408 MiB |  14414 MiB |  41570 MiB |  27162 MiB |
|       from small pool |     66 MiB |     70 MiB |    102 MiB |     36 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 448044 KiB |   1253 MiB | 160772 GiB | 160771 GiB |
|       from large pool | 435388 KiB |   1244 MiB | 158092 GiB | 158091 GiB |
|       from small pool |  12655 KiB |     40 MiB |   2680 GiB |   2680 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    1298    |    2598    |   39283 K  |   39281 K  |
|       from large pool |     187    |    1413    |   20061 K  |   20061 K  |
|       from small pool |    1111    |    1419    |   19221 K  |   19220 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    1298    |    2598    |   39283 K  |   39281 K  |
|       from large pool |     187    |    1413    |   20061 K  |   20061 K  |
|       from small pool |    1111    |    1419    |   19221 K  |   19220 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     634    |     636    |    1780    |    1146    |
|       from large pool |     601    |     601    |    1729    |    1128    |
|       from small pool |      33    |      35    |      51    |      18    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     103    |     651    |   25743 K  |   25743 K  |
|       from large pool |      40    |     604    |   14378 K  |   14378 K  |
|       from small pool |      63    |     234    |   11364 K  |   11364 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13219 MiB | 224959 GiB | 224959 GiB |
|       from large pool |  16640 KiB |  13181 MiB | 222294 GiB | 222294 GiB |
|       from small pool |      0 KiB |     60 MiB |   2665 GiB |   2665 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13219 MiB | 224959 GiB | 224959 GiB |
|       from large pool |  16640 KiB |  13181 MiB | 222294 GiB | 222294 GiB |
|       from small pool |      0 KiB |     60 MiB |   2665 GiB |   2665 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13213 MiB | 224366 GiB | 224366 GiB |
|       from large pool |  16640 KiB |  13175 MiB | 221706 GiB | 221706 GiB |
|       from small pool |      0 KiB |     60 MiB |   2659 GiB |   2659 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    882 MiB |  14480 MiB |  41672 MiB |  40790 MiB |
|       from large pool |    830 MiB |  14414 MiB |  41570 MiB |  40740 MiB |
|       from small pool |     52 MiB |     70 MiB |    102 MiB |     50 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1253 MiB | 160772 GiB | 160772 GiB |
|       from large pool |  24320 KiB |   1244 MiB | 158092 GiB | 158092 GiB |
|       from small pool |      0 KiB |     44 MiB |   2680 GiB |   2680 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    2598    |   39283 K  |   39283 K  |
|       from large pool |       2    |    1413    |   20061 K  |   20061 K  |
|       from small pool |       0    |    1419    |   19221 K  |   19221 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    2598    |   39283 K  |   39283 K  |
|       from large pool |       2    |    1413    |   20061 K  |   20061 K  |
|       from small pool |       0    |    1419    |   19221 K  |   19221 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      63    |     636    |    1780    |    1717    |
|       from large pool |      37    |     601    |    1729    |    1692    |
|       from small pool |      26    |      35    |      51    |      25    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |     651    |   25743 K  |   25743 K  |
|       from large pool |       4    |     604    |   14378 K  |   14378 K  |
|       from small pool |       0    |     234    |   11365 K  |   11365 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Sat Jul 20 12:57:06 2024]
Finished job 0.
1 of 1 steps (100%) done
