Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Sat Jul 27 12:06:19 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_10seeds_nofreeze_2024-07-27_12-03-42/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_10seeds_nofreeze_2024-07-27_12-03-42/rule_results/0.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=0
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/swiglu_ffn.py:51: UserWarning: xFormers is not available (SwiGLU)
  warnings.warn("xFormers is not available (SwiGLU)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/attention.py:33: UserWarning: xFormers is not available (Attention)
  warnings.warn("xFormers is not available (Attention)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/block.py:40: UserWarning: xFormers is not available (Block)
  warnings.warn("xFormers is not available (Block)")
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_12_09_31_seed_0_23096844

 Experiment start at: 2024-07-27 12:09:31.727637
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
before training, model accuracy: 0.569767415523529
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9554036, 'precision': 0.9584609, 'recall': 0.9559684, 'specificity': 0.9559684, 'f1': 0.955361, 'auroc': 0.9964763, 'binary_precision': 0.99929625, 'binary_recall': 0.9125964, 'binary_specificity': 0.99934036, 'binary_f1_score': 0.9539805}
confusion matrix:
      0     1
0  1515     1
1   136  1420
---- Validation: 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
scalar performance:
{'acc': 0.57220495, 'precision': 0.74476105, 'recall': 0.56625026, 'specificity': 0.56625026, 'f1': 0.47292423, 'auroc': 0.884832, 'binary_precision': 0.9468085, 'binary_recall': 0.14015748, 'binary_specificity': 0.992343, 'binary_f1_score': 0.24417008}
confusion matrix:
     0   1
0  648   5
1  546  89
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.68139535, 'precision': 0.80539775, 'recall': 0.68139535, 'specificity': 0.68139535, 'f1': 0.6454003, 'auroc': 0.91355324, 'binary_precision': 1.0, 'binary_recall': 0.3627907, 'binary_specificity': 1.0, 'binary_f1_score': 0.5324232}
confusion matrix:
     0   1
0  215   0
1  137  78
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-27 12:11:57.922347,epoch time: 0:02:26.194710,used: 0:02:26.194710,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_12_09_31_seed_0_23096844
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.94433594, 'precision': 0.94826055, 'recall': 0.94497514, 'specificity': 0.94497514, 'f1': 0.9442606, 'auroc': 0.99386704, 'binary_precision': 0.99358517, 'binary_recall': 0.8958869, 'binary_specificity': 0.9940633, 'binary_f1_score': 0.94221026}
confusion matrix:
      0     1
0  1507     9
1   162  1394
---- Validation: 
scalar performance:
{'acc': 0.6195652, 'precision': 0.67662627, 'recall': 0.61547554, 'specificity': 0.61547554, 'f1': 0.5815964, 'auroc': 0.7706238, 'binary_precision': 0.7735849, 'binary_recall': 0.32283464, 'binary_specificity': 0.9081164, 'binary_f1_score': 0.45555553}
confusion matrix:
     0    1
0  593   60
1  430  205
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8488372, 'precision': 0.8663441, 'recall': 0.8488372, 'specificity': 0.8488372, 'f1': 0.8470094, 'auroc': 0.9017415, 'binary_precision': 0.9464286, 'binary_recall': 0.73953485, 'binary_specificity': 0.95813954, 'binary_f1_score': 0.8302873}
confusion matrix:
     0    1
0  206    9
1   56  159
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-07-27 12:13:27.886754,epoch time: 0:01:29.964407,used: 0:03:56.159117,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_12_09_31_seed_0_23096844
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9641927, 'precision': 0.96514153, 'recall': 0.96454215, 'specificity': 0.96454215, 'f1': 0.96418726, 'auroc': 0.99527097, 'binary_precision': 0.98984426, 'binary_recall': 0.9389852, 'binary_specificity': 0.990099, 'binary_f1_score': 0.9637443}
confusion matrix:
      0     1
0  1500    15
1    95  1462
---- Validation: 
scalar performance:
{'acc': 0.61024845, 'precision': 0.71979386, 'recall': 0.6052236, 'specificity': 0.6052236, 'f1': 0.54919446, 'auroc': 0.77980244, 'binary_precision': 0.87150836, 'binary_recall': 0.24566929, 'binary_specificity': 0.96477795, 'binary_f1_score': 0.38329238}
confusion matrix:
     0    1
0  630   23
1  479  156
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.74186045, 'precision': 0.8036723, 'recall': 0.74186045, 'specificity': 0.74186045, 'f1': 0.7280202, 'auroc': 0.88995135, 'binary_precision': 0.94067794, 'binary_recall': 0.51627904, 'binary_specificity': 0.96744186, 'binary_f1_score': 0.6666666}
confusion matrix:
     0    1
0  208    7
1  104  111
early stop counter: 1
val acc:0.6102484464645386, best validation acc: 0.6195651888847351, corresponding to test acc:                         0.8488371968269348 / 0.8488371968269348
after epoch: 3,now: 2024-07-27 12:14:58.648157,epoch time: 0:01:30.761403,used: 0:05:26.920520,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_12_09_31_seed_0_23096844
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.97753906, 'precision': 0.9778224, 'recall': 0.9777529, 'specificity': 0.9777529, 'f1': 0.97753894, 'auroc': 0.99864936, 'binary_precision': 0.9933687, 'binary_recall': 0.9621066, 'binary_specificity': 0.9933993, 'binary_f1_score': 0.97748774}
confusion matrix:
      0     1
0  1505    10
1    59  1498
---- Validation: 
scalar performance:
{'acc': 0.7166149, 'precision': 0.79787445, 'recall': 0.712924, 'specificity': 0.712924, 'f1': 0.6936002, 'auroc': 0.905261, 'binary_precision': 0.95, 'binary_recall': 0.4488189, 'binary_specificity': 0.9770291, 'binary_f1_score': 0.6096257}
confusion matrix:
     0    1
0  638   15
1  350  285
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7860465, 'precision': 0.85016286, 'recall': 0.7860465, 'specificity': 0.7860465, 'f1': 0.7757827, 'auroc': 0.9386479, 'binary_precision': 1.0, 'binary_recall': 0.572093, 'binary_specificity': 1.0, 'binary_f1_score': 0.7278106}
confusion matrix:
     0    1
0  215    0
1   92  123
better model found
persisted
after epoch: 4,now: 2024-07-27 12:16:27.627955,epoch time: 0:01:28.979798,used: 0:06:55.900318,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_12_09_31_seed_0_23096844
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9736328, 'precision': 0.9736185, 'recall': 0.9736476, 'specificity': 0.9736476, 'f1': 0.9736304, 'auroc': 0.9971217, 'binary_precision': 0.9754522, 'binary_recall': 0.9723117, 'binary_specificity': 0.9749835, 'binary_f1_score': 0.97387934}
confusion matrix:
      0     1
0  1481    38
1    43  1510
---- Validation: 
scalar performance:
{'acc': 0.76086956, 'precision': 0.7714286, 'recall': 0.7622119, 'specificity': 0.7622119, 'f1': 0.7591126, 'auroc': 0.82934487, 'binary_precision': 0.71428573, 'binary_recall': 0.8582677, 'binary_specificity': 0.6661562, 'binary_f1_score': 0.7796853}
confusion matrix:
     0    1
0  435  218
1   90  545
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.83255816, 'precision': 0.835461, 'recall': 0.83255816, 'specificity': 0.83255816, 'f1': 0.8321951, 'auroc': 0.92744184, 'binary_precision': 0.8042553, 'binary_recall': 0.87906975, 'binary_specificity': 0.7860465, 'binary_f1_score': 0.84}
confusion matrix:
     0    1
0  169   46
1   26  189
better model found
persisted
after epoch: 5,now: 2024-07-27 12:17:56.412223,epoch time: 0:01:28.784268,used: 0:08:24.684586,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_12_09_31_seed_0_23096844
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9401042, 'precision': 0.9463745, 'recall': 0.93939424, 'specificity': 0.93939424, 'f1': 0.93981755, 'auroc': 0.9980974, 'binary_precision': 0.896472, 'binary_recall': 0.99678457, 'binary_specificity': 0.88200396, 'binary_f1_score': 0.9439708}
confusion matrix:
      0     1
0  1338   179
1     5  1550
---- Validation: 
scalar performance:
{'acc': 0.8579193, 'precision': 0.8586494, 'recall': 0.8575985, 'specificity': 0.8575985, 'f1': 0.85774565, 'auroc': 0.9191327, 'binary_precision': 0.87171054, 'binary_recall': 0.8346457, 'binary_specificity': 0.8805513, 'binary_f1_score': 0.8527756}
confusion matrix:
     0    1
0  575   78
1  105  530
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8767442, 'precision': 0.8797096, 'recall': 0.87674415, 'specificity': 0.87674415, 'f1': 0.8765031, 'auroc': 0.94500816, 'binary_precision': 0.9132653, 'binary_recall': 0.83255816, 'binary_specificity': 0.9209302, 'binary_f1_score': 0.87104625}
confusion matrix:
     0    1
0  198   17
1   36  179
new oracle model saved
better model found
persisted
after epoch: 6,now: 2024-07-27 12:19:26.121659,epoch time: 0:01:29.709436,used: 0:09:54.394022,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_12_09_31_seed_0_23096844
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.98307294, 'precision': 0.9830549, 'recall': 0.9831294, 'specificity': 0.9831294, 'f1': 0.9830717, 'auroc': 0.9991882, 'binary_precision': 0.98767835, 'binary_recall': 0.9787918, 'binary_specificity': 0.987467, 'binary_f1_score': 0.983215}
confusion matrix:
      0     1
0  1497    19
1    33  1523
---- Validation: 
scalar performance:
{'acc': 0.86413044, 'precision': 0.87167394, 'recall': 0.8631381, 'specificity': 0.8631381, 'f1': 0.86318624, 'auroc': 0.9320085, 'binary_precision': 0.9212454, 'binary_recall': 0.792126, 'binary_specificity': 0.9341501, 'binary_f1_score': 0.85182047}
confusion matrix:
     0    1
0  610   43
1  132  503
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8767442, 'precision': 0.8940045, 'recall': 0.87674415, 'specificity': 0.87674415, 'f1': 0.8753793, 'auroc': 0.95175767, 'binary_precision': 0.9764706, 'binary_recall': 0.772093, 'binary_specificity': 0.98139536, 'binary_f1_score': 0.86233765}
confusion matrix:
     0    1
0  211    4
1   49  166
better model found
persisted
after epoch: 7,now: 2024-07-27 12:20:55.392839,epoch time: 0:01:29.271180,used: 0:11:23.665202,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_12_09_31_seed_0_23096844
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.98567706, 'precision': 0.9858665, 'recall': 0.9855765, 'specificity': 0.9855765, 'f1': 0.9856708, 'auroc': 0.9991492, 'binary_precision': 0.9791007, 'binary_recall': 0.9929351, 'binary_specificity': 0.97821784, 'binary_f1_score': 0.98596936}
confusion matrix:
      0     1
0  1482    33
1    11  1546
---- Validation: 
scalar performance:
{'acc': 0.8082298, 'precision': 0.82989573, 'recall': 0.8064234, 'specificity': 0.8064234, 'f1': 0.8043664, 'auroc': 0.9028686, 'binary_precision': 0.91101694, 'binary_recall': 0.6771653, 'binary_specificity': 0.93568146, 'binary_f1_score': 0.7768744}
confusion matrix:
     0    1
0  611   42
1  205  430
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.86744183, 'precision': 0.8742508, 'recall': 0.8674419, 'specificity': 0.8674419, 'f1': 0.8668362, 'auroc': 0.93176854, 'binary_precision': 0.9247312, 'binary_recall': 0.8, 'binary_specificity': 0.9348837, 'binary_f1_score': 0.8578554}
confusion matrix:
     0    1
0  201   14
1   43  172
early stop counter: 1
val acc:0.8082298040390015, best validation acc: 0.864130437374115, corresponding to test acc:                         0.8767442107200623 / 0.8767442107200623
after epoch: 8,now: 2024-07-27 12:22:23.904238,epoch time: 0:01:28.511399,used: 0:12:52.176601,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_12_09_31_seed_0_23096844
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9827474, 'precision': 0.98309946, 'recall': 0.98298013, 'specificity': 0.98298013, 'f1': 0.9827472, 'auroc': 0.99965453, 'binary_precision': 1.0, 'binary_recall': 0.9659602, 'binary_specificity': 1.0, 'binary_f1_score': 0.9826854}
confusion matrix:
      0     1
0  1515     0
1    53  1504
---- Validation: 
scalar performance:
{'acc': 0.5923913, 'precision': 0.7528541, 'recall': 0.5867444, 'specificity': 0.5867444, 'f1': 0.5089264, 'auroc': 0.9285611, 'binary_precision': 0.9508197, 'binary_recall': 0.18267716, 'binary_specificity': 0.99081165, 'binary_f1_score': 0.30647293}
confusion matrix:
     0    1
0  647    6
1  519  116
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5837209, 'precision': 0.75980127, 'recall': 0.5837209, 'specificity': 0.5837209, 'f1': 0.4987986, 'auroc': 0.9269876, 'binary_precision': 0.9736842, 'binary_recall': 0.17209302, 'binary_specificity': 0.9953488, 'binary_f1_score': 0.29249012}
confusion matrix:
     0   1
0  214   1
1  178  37
early stop counter: 2
val acc:0.592391312122345, best validation acc: 0.864130437374115, corresponding to test acc:                         0.8767442107200623 / 0.8767442107200623
after epoch: 9,now: 2024-07-27 12:23:53.108689,epoch time: 0:01:29.204451,used: 0:14:21.381052,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_12_09_31_seed_0_23096844
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.95703125, 'precision': 0.96042466, 'recall': 0.95655227, 'specificity': 0.95655227, 'f1': 0.9569143, 'auroc': 0.99935985, 'binary_precision': 0.9237187, 'binary_recall': 0.997426, 'binary_specificity': 0.9156785, 'binary_f1_score': 0.95915836}
confusion matrix:
      0     1
0  1390   128
1     4  1550
---- Validation: 
scalar performance:
{'acc': 0.83229816, 'precision': 0.8394369, 'recall': 0.8333072, 'specificity': 0.8333072, 'f1': 0.83168083, 'auroc': 0.91225237, 'binary_precision': 0.78659374, 'binary_recall': 0.9055118, 'binary_specificity': 0.7611026, 'binary_f1_score': 0.84187406}
confusion matrix:
     0    1
0  497  156
1   60  575
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8395349, 'precision': 0.84497535, 'recall': 0.8395349, 'specificity': 0.8395349, 'f1': 0.8388997, 'auroc': 0.933802, 'binary_precision': 0.8016529, 'binary_recall': 0.9023256, 'binary_specificity': 0.7767442, 'binary_f1_score': 0.84901524}
confusion matrix:
     0    1
0  167   48
1   21  194
early stop counter: 3
val acc:0.8322981595993042, best validation acc: 0.864130437374115, corresponding to test acc:                         0.8767442107200623 / 0.8767442107200623
after epoch: 10,now: 2024-07-27 12:25:23.804118,epoch time: 0:01:30.695429,used: 0:15:52.076481,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_12_09_31_seed_0_23096844
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.98372394, 'precision': 0.9842502, 'recall': 0.98354316, 'specificity': 0.98354316, 'f1': 0.9837124, 'auroc': 0.99961936, 'binary_precision': 0.971214, 'binary_recall': 0.9974293, 'binary_specificity': 0.969657, 'binary_f1_score': 0.98414713}
confusion matrix:
      0     1
0  1470    46
1     4  1552
---- Validation: 
scalar performance:
{'acc': 0.85559005, 'precision': 0.85556185, 'recall': 0.85556185, 'specificity': 0.85556185, 'f1': 0.85556185, 'auroc': 0.9201963, 'binary_precision': 0.8535433, 'binary_recall': 0.8535433, 'binary_specificity': 0.8575804, 'binary_f1_score': 0.8535433}
confusion matrix:
     0    1
0  560   93
1   93  542
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8488372, 'precision': 0.84902596, 'recall': 0.8488372, 'specificity': 0.8488372, 'f1': 0.84881675, 'auroc': 0.91402924, 'binary_precision': 0.85714287, 'binary_recall': 0.8372093, 'binary_specificity': 0.8604651, 'binary_f1_score': 0.84705883}
confusion matrix:
     0    1
0  185   30
1   35  180
early stop counter: 4
val acc:0.8555900454521179, best validation acc: 0.864130437374115, corresponding to test acc:                         0.8767442107200623 / 0.8767442107200623
after epoch: 11,now: 2024-07-27 12:26:53.229821,epoch time: 0:01:29.425703,used: 0:17:21.502184,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_12_09_31_seed_0_23096844
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.99153644, 'precision': 0.9915365, 'recall': 0.9916198, 'specificity': 0.9916198, 'f1': 0.99153614, 'auroc': 0.99977314, 'binary_precision': 0.9980469, 'binary_recall': 0.9852185, 'binary_specificity': 0.9980211, 'binary_f1_score': 0.9915912}
confusion matrix:
      0     1
0  1513     3
1    23  1533
---- Validation: 
scalar performance:
{'acc': 0.7569876, 'precision': 0.81314516, 'recall': 0.7539991, 'specificity': 0.7539991, 'f1': 0.74410427, 'auroc': 0.9201095, 'binary_precision': 0.9423077, 'binary_recall': 0.5401575, 'binary_specificity': 0.96784073, 'binary_f1_score': 0.6866867}
confusion matrix:
     0    1
0  632   21
1  292  343
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7162791, 'precision': 0.792967, 'recall': 0.7162791, 'specificity': 0.7162791, 'f1': 0.696412, 'auroc': 0.8973067, 'binary_precision': 0.94285715, 'binary_recall': 0.4604651, 'binary_specificity': 0.97209305, 'binary_f1_score': 0.61875}
confusion matrix:
     0   1
0  209   6
1  116  99
early stop counter: 5
val acc:0.7569875717163086, best validation acc: 0.864130437374115, corresponding to test acc:                         0.8767442107200623 / 0.8767442107200623
after epoch: 12,now: 2024-07-27 12:28:22.545807,epoch time: 0:01:29.315986,used: 0:18:50.818170,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_12_09_31_seed_0_23096844
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 12 with time: 0:18:50.818170 at 2024-07-27 12:28:22.545807
persisted model performance metric: 

scalar performance:
{'acc': 0.8767442, 'precision': 0.8940045, 'recall': 0.87674415, 'specificity': 0.87674415, 'f1': 0.8753793, 'auroc': 0.95175767, 'binary_precision': 0.9764706, 'binary_recall': 0.772093, 'binary_specificity': 0.98139536, 'binary_f1_score': 0.86233765}
confusion matrix:
     0    1
0  211    4
1   49  166
oracle model performance metric: 

scalar performance:
{'acc': 0.8767442, 'precision': 0.8797096, 'recall': 0.87674415, 'specificity': 0.87674415, 'f1': 0.8765031, 'auroc': 0.94500816, 'binary_precision': 0.9132653, 'binary_recall': 0.83255816, 'binary_specificity': 0.9209302, 'binary_f1_score': 0.87104625}
confusion matrix:
     0    1
0  198   17
1   36  179
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_10seeds_nofreeze_2024-07-27_12-03-42/rule_results/0.csv
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_10seeds_nofreeze_2024-07-27_12-03-42/rule_results/0.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_10seeds_nofreeze_2024-07-27_12-03-42/confusion_matrix/0.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 454925 KiB |   2002 MiB |  26137 GiB |  26137 GiB |
|       from large pool | 414333 KiB |   1970 MiB |  25803 GiB |  25803 GiB |
|       from small pool |  40592 KiB |     56 MiB |    334 GiB |    334 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 454925 KiB |   2002 MiB |  26137 GiB |  26137 GiB |
|       from large pool | 414333 KiB |   1970 MiB |  25803 GiB |  25803 GiB |
|       from small pool |  40592 KiB |     56 MiB |    334 GiB |    334 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 447480 KiB |   1998 MiB |  26059 GiB |  26059 GiB |
|       from large pool | 407075 KiB |   1966 MiB |  25726 GiB |  25725 GiB |
|       from small pool |  40405 KiB |     56 MiB |    333 GiB |    333 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2276 MiB |   2276 MiB |   2276 MiB |      0 B   |
|       from large pool |   2212 MiB |   2212 MiB |   2212 MiB |      0 B   |
|       from small pool |     64 MiB |     64 MiB |     64 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory | 386802 KiB | 387009 KiB |  20277 GiB |  20277 GiB |
|       from large pool | 380291 KiB | 380291 KiB |  19926 GiB |  19925 GiB |
|       from small pool |   6511 KiB |  12075 KiB |    351 GiB |    351 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    1298    |    1669    |    4987 K  |    4985 K  |
|       from large pool |     187    |     311    |    2395 K  |    2395 K  |
|       from small pool |    1111    |    1407    |    2591 K  |    2590 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    1298    |    1669    |    4987 K  |    4985 K  |
|       from large pool |     187    |     311    |    2395 K  |    2395 K  |
|       from small pool |    1111    |    1407    |    2591 K  |    2590 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     124    |     124    |     124    |       0    |
|       from large pool |      92    |      92    |      92    |       0    |
|       from small pool |      32    |      32    |      32    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      72    |     254    |    2901 K  |    2901 K  |
|       from large pool |      35    |      90    |    1851 K  |    1851 K  |
|       from small pool |      37    |     219    |    1050 K  |    1050 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   2002 MiB |  26137 GiB |  26137 GiB |
|       from large pool |  16640 KiB |   1970 MiB |  25803 GiB |  25803 GiB |
|       from small pool |      0 KiB |     56 MiB |    334 GiB |    334 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   2002 MiB |  26137 GiB |  26137 GiB |
|       from large pool |  16640 KiB |   1970 MiB |  25803 GiB |  25803 GiB |
|       from small pool |      0 KiB |     56 MiB |    334 GiB |    334 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   1998 MiB |  26059 GiB |  26059 GiB |
|       from large pool |  16640 KiB |   1966 MiB |  25726 GiB |  25726 GiB |
|       from small pool |      0 KiB |     56 MiB |    333 GiB |    333 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    822 MiB |   2276 MiB |   2276 MiB |   1454 MiB |
|       from large pool |    776 MiB |   2212 MiB |   2212 MiB |   1436 MiB |
|       from small pool |     46 MiB |     64 MiB |     64 MiB |     18 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  30464 KiB | 392712 KiB |  20277 GiB |  20277 GiB |
|       from large pool |  30464 KiB | 384405 KiB |  19926 GiB |  19926 GiB |
|       from small pool |      0 KiB |  20299 KiB |    351 GiB |    351 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    1669    |    4987 K  |    4987 K  |
|       from large pool |       2    |     311    |    2395 K  |    2395 K  |
|       from small pool |       0    |    1407    |    2591 K  |    2591 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    1669    |    4987 K  |    4987 K  |
|       from large pool |       2    |     311    |    2395 K  |    2395 K  |
|       from small pool |       0    |    1407    |    2591 K  |    2591 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      57    |     124    |     124    |      67    |
|       from large pool |      34    |      92    |      92    |      58    |
|       from small pool |      23    |      32    |      32    |       9    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |     254    |    2902 K  |    2902 K  |
|       from large pool |       4    |      90    |    1851 K  |    1851 K  |
|       from small pool |       0    |     219    |    1050 K  |    1050 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   2002 MiB |  26137 GiB |  26137 GiB |
|       from large pool |  16640 KiB |   1970 MiB |  25803 GiB |  25803 GiB |
|       from small pool |      0 KiB |     56 MiB |    334 GiB |    334 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   2002 MiB |  26137 GiB |  26137 GiB |
|       from large pool |  16640 KiB |   1970 MiB |  25803 GiB |  25803 GiB |
|       from small pool |      0 KiB |     56 MiB |    334 GiB |    334 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   1998 MiB |  26059 GiB |  26059 GiB |
|       from large pool |  16640 KiB |   1966 MiB |  25726 GiB |  25726 GiB |
|       from small pool |      0 KiB |     56 MiB |    333 GiB |    333 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    822 MiB |   2276 MiB |   2276 MiB |   1454 MiB |
|       from large pool |    776 MiB |   2212 MiB |   2212 MiB |   1436 MiB |
|       from small pool |     46 MiB |     64 MiB |     64 MiB |     18 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  30464 KiB | 392712 KiB |  20277 GiB |  20277 GiB |
|       from large pool |  30464 KiB | 384405 KiB |  19926 GiB |  19926 GiB |
|       from small pool |      0 KiB |  20299 KiB |    351 GiB |    351 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    1669    |    4987 K  |    4987 K  |
|       from large pool |       2    |     311    |    2395 K  |    2395 K  |
|       from small pool |       0    |    1407    |    2591 K  |    2591 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    1669    |    4987 K  |    4987 K  |
|       from large pool |       2    |     311    |    2395 K  |    2395 K  |
|       from small pool |       0    |    1407    |    2591 K  |    2591 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      57    |     124    |     124    |      67    |
|       from large pool |      34    |      92    |      92    |      58    |
|       from small pool |      23    |      32    |      32    |       9    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |     254    |    2902 K  |    2902 K  |
|       from large pool |       4    |      90    |    1851 K  |    1851 K  |
|       from small pool |       0    |     219    |    1050 K  |    1050 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_12_29_02_seed_1_23096844

 Experiment start at: 2024-07-27 12:29:02.200848
before training, model accuracy: 0.6177777647972107
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9436849, 'precision': 0.9486909, 'recall': 0.9443649, 'specificity': 0.9443649, 'f1': 0.94357914, 'auroc': 0.99529886, 'binary_precision': 0.9992775, 'binary_recall': 0.88938904, 'binary_specificity': 0.99934083, 'binary_f1_score': 0.9411364}
confusion matrix:
      0     1
0  1516     1
1   172  1383
---- Validation: 
scalar performance:
{'acc': 0.74863386, 'precision': 0.807286, 'recall': 0.7450077, 'specificity': 0.7450077, 'f1': 0.7341502, 'auroc': 0.91494894, 'binary_precision': 0.9375, 'binary_recall': 0.52380955, 'binary_specificity': 0.96620584, 'binary_f1_score': 0.6720978}
confusion matrix:
     0    1
0  629   22
1  300  330
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8333333, 'precision': 0.85977745, 'recall': 0.8333333, 'specificity': 0.8333333, 'f1': 0.8302134, 'auroc': 0.90921485, 'binary_precision': 0.95731705, 'binary_recall': 0.69777775, 'binary_specificity': 0.9688889, 'binary_f1_score': 0.8071979}
confusion matrix:
     0    1
0  218    7
1   68  157
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-27 12:30:44.836346,epoch time: 0:01:42.635498,used: 0:01:42.635498,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_12_29_02_seed_1_23096844
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.96809894, 'precision': 0.9689743, 'recall': 0.9684001, 'specificity': 0.9684001, 'f1': 0.96809405, 'auroc': 0.997651, 'binary_precision': 0.99256253, 'binary_recall': 0.94405144, 'binary_specificity': 0.99274886, 'binary_f1_score': 0.96769935}
confusion matrix:
      0     1
0  1506    11
1    87  1468
---- Validation: 
scalar performance:
{'acc': 0.8657299, 'precision': 0.86706954, 'recall': 0.86523294, 'specificity': 0.86523294, 'f1': 0.8654635, 'auroc': 0.9206983, 'binary_precision': 0.8855219, 'binary_recall': 0.83492064, 'binary_specificity': 0.8955453, 'binary_f1_score': 0.8594771}
confusion matrix:
     0    1
0  583   68
1  104  526
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8511111, 'precision': 0.8657408, 'recall': 0.8511111, 'specificity': 0.8511111, 'f1': 0.84960717, 'auroc': 0.91861737, 'binary_precision': 0.9388889, 'binary_recall': 0.7511111, 'binary_specificity': 0.95111114, 'binary_f1_score': 0.83456784}
confusion matrix:
     0    1
0  214   11
1   56  169
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-07-27 12:32:15.195773,epoch time: 0:01:30.359427,used: 0:03:12.994925,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_12_29_02_seed_1_23096844
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.87369794, 'precision': 0.8996321, 'recall': 0.8720486, 'specificity': 0.8720486, 'f1': 0.87124515, 'auroc': 0.997439, 'binary_precision': 0.80103093, 'binary_recall': 0.9987146, 'binary_specificity': 0.7453826, 'binary_f1_score': 0.88901603}
confusion matrix:
      0     1
0  1130   386
1     2  1554
---- Validation: 
scalar performance:
{'acc': 0.6861827, 'precision': 0.77564996, 'recall': 0.6907834, 'specificity': 0.6907834, 'f1': 0.66164017, 'auroc': 0.9265349, 'binary_precision': 0.61445785, 'binary_recall': 0.9714286, 'binary_specificity': 0.41013825, 'binary_f1_score': 0.7527675}
confusion matrix:
     0    1
0  267  384
1   18  612
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6666667, 'precision': 0.7769935, 'recall': 0.6666666, 'specificity': 0.6666666, 'f1': 0.6298043, 'auroc': 0.93977284, 'binary_precision': 0.6021798, 'binary_recall': 0.9822222, 'binary_specificity': 0.3511111, 'binary_f1_score': 0.7466216}
confusion matrix:
    0    1
0  79  146
1   4  221
early stop counter: 1
val acc:0.6861826777458191, best validation acc: 0.8657299280166626, corresponding to test acc:                         0.851111114025116 / 0.851111114025116
after epoch: 3,now: 2024-07-27 12:33:44.630161,epoch time: 0:01:29.434388,used: 0:04:42.429313,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_12_29_02_seed_1_23096844
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9785156, 'precision': 0.97885907, 'recall': 0.97873247, 'specificity': 0.97873247, 'f1': 0.97851527, 'auroc': 0.99900544, 'binary_precision': 0.9953458, 'binary_recall': 0.96208227, 'binary_specificity': 0.9953826, 'binary_f1_score': 0.9784314}
confusion matrix:
      0     1
0  1509     7
1    59  1497
---- Validation: 
scalar performance:
{'acc': 0.74473065, 'precision': 0.7626289, 'recall': 0.7425243, 'specificity': 0.7425243, 'f1': 0.73911154, 'auroc': 0.84624386, 'binary_precision': 0.8272138, 'binary_recall': 0.6079365, 'binary_specificity': 0.87711215, 'binary_f1_score': 0.7008234}
confusion matrix:
     0    1
0  571   80
1  247  383
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7822222, 'precision': 0.7840401, 'recall': 0.7822223, 'specificity': 0.7822223, 'f1': 0.7818733, 'auroc': 0.84602475, 'binary_precision': 0.8067633, 'binary_recall': 0.74222225, 'binary_specificity': 0.82222223, 'binary_f1_score': 0.77314824}
confusion matrix:
     0    1
0  185   40
1   58  167
early stop counter: 2
val acc:0.7447306513786316, best validation acc: 0.8657299280166626, corresponding to test acc:                         0.851111114025116 / 0.851111114025116
after epoch: 4,now: 2024-07-27 12:35:13.641123,epoch time: 0:01:29.010962,used: 0:06:11.440275,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_12_29_02_seed_1_23096844
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.98567706, 'precision': 0.9856855, 'recall': 0.9857514, 'specificity': 0.9857514, 'f1': 0.98567665, 'auroc': 0.9990852, 'binary_precision': 0.9921773, 'binary_recall': 0.97940797, 'binary_specificity': 0.9920949, 'binary_f1_score': 0.98575133}
confusion matrix:
      0     1
0  1506    12
1    32  1522
---- Validation: 
scalar performance:
{'acc': 0.852459, 'precision': 0.85773957, 'recall': 0.85145926, 'specificity': 0.85145926, 'f1': 0.85162574, 'auroc': 0.9196328, 'binary_precision': 0.8972973, 'binary_recall': 0.7904762, 'binary_specificity': 0.9124424, 'binary_f1_score': 0.8405064}
confusion matrix:
     0    1
0  594   57
1  132  498
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.85333335, 'precision': 0.8561473, 'recall': 0.85333335, 'specificity': 0.85333335, 'f1': 0.8530431, 'auroc': 0.9232988, 'binary_precision': 0.88780487, 'binary_recall': 0.8088889, 'binary_specificity': 0.8977778, 'binary_f1_score': 0.84651166}
confusion matrix:
     0    1
0  202   23
1   43  182
new oracle model saved
early stop counter: 3
val acc:0.8524590134620667, best validation acc: 0.8657299280166626, corresponding to test acc:                         0.851111114025116 / 0.8533333539962769
after epoch: 5,now: 2024-07-27 12:36:42.754563,epoch time: 0:01:29.113440,used: 0:07:40.553715,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_12_29_02_seed_1_23096844
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.98046875, 'precision': 0.9805577, 'recall': 0.9804094, 'specificity': 0.9804094, 'f1': 0.98046315, 'auroc': 0.99853826, 'binary_precision': 0.9764181, 'binary_recall': 0.985209, 'binary_specificity': 0.9756098, 'binary_f1_score': 0.9807939}
confusion matrix:
      0     1
0  1480    37
1    23  1532
---- Validation: 
scalar performance:
{'acc': 0.7728337, 'precision': 0.8215021, 'recall': 0.7696109, 'specificity': 0.7696109, 'f1': 0.7624356, 'auroc': 0.9130129, 'binary_precision': 0.94255877, 'binary_recall': 0.57301587, 'binary_specificity': 0.96620584, 'binary_f1_score': 0.7127344}
confusion matrix:
     0    1
0  629   22
1  269  361
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.85555553, 'precision': 0.8837626, 'recall': 0.85555553, 'specificity': 0.85555553, 'f1': 0.85285175, 'auroc': 0.9364741, 'binary_precision': 0.9878049, 'binary_recall': 0.72, 'binary_specificity': 0.9911111, 'binary_f1_score': 0.83290493}
confusion matrix:
     0    1
0  223    2
1   63  162
new oracle model saved
early stop counter: 4
val acc:0.7728337049484253, best validation acc: 0.8657299280166626, corresponding to test acc:                         0.851111114025116 / 0.855555534362793
after epoch: 6,now: 2024-07-27 12:38:12.412610,epoch time: 0:01:29.658047,used: 0:09:10.211762,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_12_29_02_seed_1_23096844
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9902344, 'precision': 0.9902386, 'recall': 0.9903134, 'specificity': 0.9903134, 'f1': 0.990234, 'auroc': 0.9996469, 'binary_precision': 0.99674267, 'binary_recall': 0.98392284, 'binary_specificity': 0.99670404, 'binary_f1_score': 0.9902913}
confusion matrix:
      0     1
0  1512     5
1    25  1530
---- Validation: 
scalar performance:
{'acc': 0.79859483, 'precision': 0.8310022, 'recall': 0.79600614, 'specificity': 0.79600614, 'f1': 0.7925311, 'auroc': 0.926196, 'binary_precision': 0.9305556, 'binary_recall': 0.63809526, 'binary_specificity': 0.953917, 'binary_f1_score': 0.75706214}
confusion matrix:
     0    1
0  621   30
1  228  402
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.81777775, 'precision': 0.83876264, 'recall': 0.81777775, 'specificity': 0.81777775, 'f1': 0.81491137, 'auroc': 0.8896592, 'binary_precision': 0.9230769, 'binary_recall': 0.6933333, 'binary_specificity': 0.94222224, 'binary_f1_score': 0.79187816}
confusion matrix:
     0    1
0  212   13
1   69  156
early stop counter: 5
val acc:0.7985948324203491, best validation acc: 0.8657299280166626, corresponding to test acc:                         0.851111114025116 / 0.855555534362793
after epoch: 7,now: 2024-07-27 12:39:41.633131,epoch time: 0:01:29.220521,used: 0:10:39.432283,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_12_29_02_seed_1_23096844
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 7 with time: 0:10:39.432283 at 2024-07-27 12:39:41.633131
persisted model performance metric: 

scalar performance:
{'acc': 0.8511111, 'precision': 0.8657408, 'recall': 0.8511111, 'specificity': 0.8511111, 'f1': 0.84960717, 'auroc': 0.91861737, 'binary_precision': 0.9388889, 'binary_recall': 0.7511111, 'binary_specificity': 0.95111114, 'binary_f1_score': 0.83456784}
confusion matrix:
     0    1
0  214   11
1   56  169
oracle model performance metric: 

scalar performance:
{'acc': 0.85555553, 'precision': 0.8837626, 'recall': 0.85555553, 'specificity': 0.85555553, 'f1': 0.85285175, 'auroc': 0.9364741, 'binary_precision': 0.9878049, 'binary_recall': 0.72, 'binary_specificity': 0.9911111, 'binary_f1_score': 0.83290493}
confusion matrix:
     0    1
0  223    2
1   63  162
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_10seeds_nofreeze_2024-07-27_12-03-42/rule_results/0.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_10seeds_nofreeze_2024-07-27_12-03-42/confusion_matrix/0.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 455469 KiB |   2004 MiB |  41508 GiB |  41507 GiB |
|       from large pool | 414870 KiB |   1971 MiB |  40974 GiB |  40974 GiB |
|       from small pool |  40598 KiB |     60 MiB |    533 GiB |    533 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 455469 KiB |   2004 MiB |  41508 GiB |  41507 GiB |
|       from large pool | 414870 KiB |   1971 MiB |  40974 GiB |  40974 GiB |
|       from small pool |  40598 KiB |     60 MiB |    533 GiB |    533 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 447481 KiB |   1998 MiB |  41366 GiB |  41366 GiB |
|       from large pool | 407075 KiB |   1966 MiB |  40834 GiB |  40833 GiB |
|       from small pool |  40406 KiB |     60 MiB |    532 GiB |    532 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2262 MiB |   2276 MiB |   3716 MiB |   1454 MiB |
|       from large pool |   2192 MiB |   2212 MiB |   3628 MiB |   1436 MiB |
|       from small pool |     70 MiB |     70 MiB |     88 MiB |     18 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 398547 KiB | 400040 KiB |  31952 GiB |  31951 GiB |
|       from large pool | 392041 KiB | 392041 KiB |  31390 GiB |  31390 GiB |
|       from small pool |   6505 KiB |  20299 KiB |    561 GiB |    561 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    1310    |    1681    |    7927 K  |    7926 K  |
|       from large pool |     187    |     311    |    3803 K  |    3802 K  |
|       from small pool |    1123    |    1419    |    4124 K  |    4123 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    1310    |    1681    |    7927 K  |    7926 K  |
|       from large pool |     187    |     311    |    3803 K  |    3802 K  |
|       from small pool |    1123    |    1419    |    4124 K  |    4123 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     126    |     126    |     193    |      67    |
|       from large pool |      91    |      92    |     149    |      58    |
|       from small pool |      35    |      35    |      44    |       9    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      74    |     257    |    4455 K  |    4455 K  |
|       from large pool |      34    |      90    |    2803 K  |    2803 K  |
|       from small pool |      40    |     223    |    1652 K  |    1652 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   2004 MiB |  41508 GiB |  41508 GiB |
|       from large pool |  16640 KiB |   1971 MiB |  40974 GiB |  40974 GiB |
|       from small pool |      0 KiB |     60 MiB |    533 GiB |    533 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   2004 MiB |  41508 GiB |  41508 GiB |
|       from large pool |  16640 KiB |   1971 MiB |  40974 GiB |  40974 GiB |
|       from small pool |      0 KiB |     60 MiB |    533 GiB |    533 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   1998 MiB |  41366 GiB |  41366 GiB |
|       from large pool |  16640 KiB |   1966 MiB |  40834 GiB |  40834 GiB |
|       from small pool |      0 KiB |     60 MiB |    532 GiB |    532 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    834 MiB |   2276 MiB |   3716 MiB |   2882 MiB |
|       from large pool |    788 MiB |   2212 MiB |   3628 MiB |   2840 MiB |
|       from small pool |     46 MiB |     70 MiB |     88 MiB |     42 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  30464 KiB | 418550 KiB |  31952 GiB |  31952 GiB |
|       from large pool |  30464 KiB | 409071 KiB |  31391 GiB |  31391 GiB |
|       from small pool |      0 KiB |  20299 KiB |    561 GiB |    561 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    1681    |    7927 K  |    7927 K  |
|       from large pool |       2    |     311    |    3803 K  |    3803 K  |
|       from small pool |       0    |    1419    |    4124 K  |    4124 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    1681    |    7927 K  |    7927 K  |
|       from large pool |       2    |     311    |    3803 K  |    3803 K  |
|       from small pool |       0    |    1419    |    4124 K  |    4124 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      57    |     126    |     193    |     136    |
|       from large pool |      34    |      92    |     149    |     115    |
|       from small pool |      23    |      35    |      44    |      21    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |     257    |    4456 K  |    4456 K  |
|       from large pool |       4    |      90    |    2803 K  |    2803 K  |
|       from small pool |       0    |     223    |    1652 K  |    1652 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   2004 MiB |  41508 GiB |  41508 GiB |
|       from large pool |  16640 KiB |   1971 MiB |  40974 GiB |  40974 GiB |
|       from small pool |      0 KiB |     60 MiB |    533 GiB |    533 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   2004 MiB |  41508 GiB |  41508 GiB |
|       from large pool |  16640 KiB |   1971 MiB |  40974 GiB |  40974 GiB |
|       from small pool |      0 KiB |     60 MiB |    533 GiB |    533 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   1998 MiB |  41366 GiB |  41366 GiB |
|       from large pool |  16640 KiB |   1966 MiB |  40834 GiB |  40834 GiB |
|       from small pool |      0 KiB |     60 MiB |    532 GiB |    532 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    834 MiB |   2276 MiB |   3716 MiB |   2882 MiB |
|       from large pool |    788 MiB |   2212 MiB |   3628 MiB |   2840 MiB |
|       from small pool |     46 MiB |     70 MiB |     88 MiB |     42 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  30464 KiB | 418550 KiB |  31952 GiB |  31952 GiB |
|       from large pool |  30464 KiB | 409071 KiB |  31391 GiB |  31391 GiB |
|       from small pool |      0 KiB |  20299 KiB |    561 GiB |    561 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    1681    |    7927 K  |    7927 K  |
|       from large pool |       2    |     311    |    3803 K  |    3803 K  |
|       from small pool |       0    |    1419    |    4124 K  |    4124 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    1681    |    7927 K  |    7927 K  |
|       from large pool |       2    |     311    |    3803 K  |    3803 K  |
|       from small pool |       0    |    1419    |    4124 K  |    4124 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      57    |     126    |     193    |     136    |
|       from large pool |      34    |      92    |     149    |     115    |
|       from small pool |      23    |      35    |      44    |      21    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |     257    |    4456 K  |    4456 K  |
|       from large pool |       4    |      90    |    2803 K  |    2803 K  |
|       from small pool |       0    |     223    |    1652 K  |    1652 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_12_40_17_seed_2_23096844

 Experiment start at: 2024-07-27 12:40:17.393527
before training, model accuracy: 0.41203704476356506
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9728403, 'precision': 0.9729426, 'recall': 0.97291315, 'specificity': 0.97291315, 'f1': 0.9728402, 'auroc': 0.997018, 'binary_precision': 0.98213106, 'binary_recall': 0.96363634, 'binary_specificity': 0.98218995, 'binary_f1_score': 0.9727958}
confusion matrix:
      0     1
0  1489    27
1    56  1484
---- Validation: 
scalar performance:
{'acc': 0.8372457, 'precision': 0.83714044, 'recall': 0.8373387, 'specificity': 0.8373387, 'f1': 0.8371883, 'auroc': 0.8910625, 'binary_precision': 0.82753164, 'binary_recall': 0.840836, 'binary_specificity': 0.83384144, 'binary_f1_score': 0.83413076}
confusion matrix:
     0    1
0  547  109
1   99  523
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.775463, 'precision': 0.7792032, 'recall': 0.775463, 'specificity': 0.775463, 'f1': 0.7747085, 'auroc': 0.8793938, 'binary_precision': 0.746888, 'binary_recall': 0.8333333, 'binary_specificity': 0.7175926, 'binary_f1_score': 0.7877462}
confusion matrix:
     0    1
0  155   61
1   36  180
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-27 12:41:56.347367,epoch time: 0:01:38.953840,used: 0:01:38.953840,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_12_40_17_seed_2_23096844
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.94502616, 'precision': 0.94885683, 'recall': 0.9446733, 'specificity': 0.9446733, 'f1': 0.94487506, 'auroc': 0.995921, 'binary_precision': 0.9093079, 'binary_recall': 0.9896104, 'binary_specificity': 0.89973617, 'binary_f1_score': 0.9477612}
confusion matrix:
      0     1
0  1364   152
1    16  1524
---- Validation: 
scalar performance:
{'acc': 0.78951484, 'precision': 0.7989172, 'recall': 0.7918031, 'specificity': 0.7918031, 'f1': 0.7886233, 'auroc': 0.87553185, 'binary_precision': 0.7388363, 'binary_recall': 0.8778135, 'binary_specificity': 0.70579267, 'binary_f1_score': 0.8023512}
confusion matrix:
     0    1
0  463  193
1   76  546
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7731481, 'precision': 0.81410825, 'recall': 0.7731482, 'specificity': 0.7731482, 'f1': 0.7655035, 'auroc': 0.9470379, 'binary_precision': 0.70068026, 'binary_recall': 0.9537037, 'binary_specificity': 0.5925926, 'binary_f1_score': 0.8078432}
confusion matrix:
     0    1
0  128   88
1   10  206
early stop counter: 1
val acc:0.7895148396492004, best validation acc: 0.8372457027435303, corresponding to test acc:                         0.7754629850387573 / 0.7754629850387573
after epoch: 2,now: 2024-07-27 12:43:26.320103,epoch time: 0:01:29.972736,used: 0:03:08.926576,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_12_40_17_seed_2_23096844
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9741492, 'precision': 0.9750631, 'recall': 0.9743352, 'specificity': 0.9743352, 'f1': 0.97414255, 'auroc': 0.9978571, 'binary_precision': 0.997955, 'binary_recall': 0.9506493, 'binary_specificity': 0.9980211, 'binary_f1_score': 0.97372794}
confusion matrix:
      0     1
0  1513     3
1    76  1464
---- Validation: 
scalar performance:
{'acc': 0.7801252, 'precision': 0.8155524, 'recall': 0.77557397, 'specificity': 0.77557397, 'f1': 0.77173626, 'auroc': 0.8876779, 'binary_precision': 0.91484183, 'binary_recall': 0.6045016, 'binary_specificity': 0.94664633, 'binary_f1_score': 0.72797674}
confusion matrix:
     0    1
0  621   35
1  246  376
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7962963, 'precision': 0.83569694, 'recall': 0.7962963, 'specificity': 0.7962963, 'f1': 0.7901385, 'auroc': 0.9003129, 'binary_precision': 0.9507042, 'binary_recall': 0.625, 'binary_specificity': 0.9675926, 'binary_f1_score': 0.7541899}
confusion matrix:
     0    1
0  209    7
1   81  135
new oracle model saved
early stop counter: 2
val acc:0.7801252007484436, best validation acc: 0.8372457027435303, corresponding to test acc:                         0.7754629850387573 / 0.7962962985038757
after epoch: 3,now: 2024-07-27 12:44:56.581355,epoch time: 0:01:30.261252,used: 0:04:39.187828,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_12_40_17_seed_2_23096844
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9790576, 'precision': 0.97941625, 'recall': 0.9791796, 'specificity': 0.9791796, 'f1': 0.9790563, 'auroc': 0.99882984, 'binary_precision': 0.9946381, 'binary_recall': 0.96363634, 'binary_specificity': 0.99472296, 'binary_f1_score': 0.97889185}
confusion matrix:
      0     1
0  1508     8
1    56  1484
---- Validation: 
scalar performance:
{'acc': 0.7769953, 'precision': 0.82269454, 'recall': 0.77190024, 'specificity': 0.77190024, 'f1': 0.7664957, 'auroc': 0.9026638, 'binary_precision': 0.93766236, 'binary_recall': 0.58038586, 'binary_specificity': 0.9634146, 'binary_f1_score': 0.7169811}
confusion matrix:
     0    1
0  632   24
1  261  361
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8217593, 'precision': 0.86586976, 'recall': 0.8217592, 'specificity': 0.8217592, 'f1': 0.81622, 'auroc': 0.94995284, 'binary_precision': 0.9929078, 'binary_recall': 0.6481481, 'binary_specificity': 0.9953704, 'binary_f1_score': 0.78431374}
confusion matrix:
     0    1
0  215    1
1   76  140
new oracle model saved
early stop counter: 3
val acc:0.7769953012466431, best validation acc: 0.8372457027435303, corresponding to test acc:                         0.7754629850387573 / 0.8217592835426331
after epoch: 4,now: 2024-07-27 12:46:26.413527,epoch time: 0:01:29.832172,used: 0:06:09.020000,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_12_40_17_seed_2_23096844
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.97840315, 'precision': 0.9785105, 'recall': 0.9783555, 'specificity': 0.9783555, 'f1': 0.97839904, 'auroc': 0.9976728, 'binary_precision': 0.97304237, 'binary_recall': 0.9844156, 'binary_specificity': 0.9722955, 'binary_f1_score': 0.97869587}
confusion matrix:
      0     1
0  1474    42
1    24  1516
---- Validation: 
scalar performance:
{'acc': 0.62128323, 'precision': 0.7465004, 'recall': 0.61151576, 'specificity': 0.61151576, 'f1': 0.5560156, 'auroc': 0.855129, 'binary_precision': 0.91566265, 'binary_recall': 0.244373, 'binary_specificity': 0.97865856, 'binary_f1_score': 0.38578683}
confusion matrix:
     0    1
0  642   14
1  470  152
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6342593, 'precision': 0.7887701, 'recall': 0.6342592, 'specificity': 0.6342592, 'f1': 0.5777805, 'auroc': 0.9240612, 'binary_precision': 1.0, 'binary_recall': 0.2685185, 'binary_specificity': 1.0, 'binary_f1_score': 0.42335767}
confusion matrix:
     0   1
0  216   0
1  158  58
early stop counter: 4
val acc:0.621283233165741, best validation acc: 0.8372457027435303, corresponding to test acc:                         0.7754629850387573 / 0.8217592835426331
after epoch: 5,now: 2024-07-27 12:47:56.854332,epoch time: 0:01:30.440805,used: 0:07:39.460805,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_12_40_17_seed_2_23096844
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.98134816, 'precision': 0.9816909, 'recall': 0.98146784, 'specificity': 0.98146784, 'f1': 0.9813471, 'auroc': 0.99924916, 'binary_precision': 0.99665105, 'binary_recall': 0.9662338, 'binary_specificity': 0.99670184, 'binary_f1_score': 0.9812067}
confusion matrix:
      0     1
0  1511     5
1    52  1488
---- Validation: 
scalar performance:
{'acc': 0.7699531, 'precision': 0.82531846, 'recall': 0.7643739, 'specificity': 0.7643739, 'f1': 0.7570983, 'auroc': 0.9149724, 'binary_precision': 0.9530387, 'binary_recall': 0.5546624, 'binary_specificity': 0.9740854, 'binary_f1_score': 0.70121956}
confusion matrix:
     0    1
0  639   17
1  277  345
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7199074, 'precision': 0.82047474, 'recall': 0.7199074, 'specificity': 0.7199074, 'f1': 0.696063, 'auroc': 0.9125086, 'binary_precision': 1.0, 'binary_recall': 0.4398148, 'binary_specificity': 1.0, 'binary_f1_score': 0.61093247}
confusion matrix:
     0   1
0  216   0
1  121  95
early stop counter: 5
val acc:0.7699530720710754, best validation acc: 0.8372457027435303, corresponding to test acc:                         0.7754629850387573 / 0.8217592835426331
after epoch: 6,now: 2024-07-27 12:49:26.981108,epoch time: 0:01:30.126776,used: 0:09:09.587581,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_12_40_17_seed_2_23096844
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 6 with time: 0:09:09.587581 at 2024-07-27 12:49:26.981108
persisted model performance metric: 

scalar performance:
{'acc': 0.775463, 'precision': 0.7792032, 'recall': 0.775463, 'specificity': 0.775463, 'f1': 0.7747085, 'auroc': 0.8793938, 'binary_precision': 0.746888, 'binary_recall': 0.8333333, 'binary_specificity': 0.7175926, 'binary_f1_score': 0.7877462}
confusion matrix:
     0    1
0  155   61
1   36  180
oracle model performance metric: 

scalar performance:
{'acc': 0.8217593, 'precision': 0.86586976, 'recall': 0.8217592, 'specificity': 0.8217592, 'f1': 0.81622, 'auroc': 0.94995284, 'binary_precision': 0.9929078, 'binary_recall': 0.6481481, 'binary_specificity': 0.9953704, 'binary_f1_score': 0.78431374}
confusion matrix:
     0    1
0  215    1
1   76  140
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_10seeds_nofreeze_2024-07-27_12-03-42/rule_results/0.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_10seeds_nofreeze_2024-07-27_12-03-42/confusion_matrix/0.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 455387 KiB |   2004 MiB |  54615 GiB |  54614 GiB |
|       from large pool | 414795 KiB |   1971 MiB |  53913 GiB |  53913 GiB |
|       from small pool |  40592 KiB |     60 MiB |    701 GiB |    701 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 455387 KiB |   2004 MiB |  54615 GiB |  54614 GiB |
|       from large pool | 414795 KiB |   1971 MiB |  53913 GiB |  53913 GiB |
|       from small pool |  40592 KiB |     60 MiB |    701 GiB |    701 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 447481 KiB |   1998 MiB |  54429 GiB |  54429 GiB |
|       from large pool | 407075 KiB |   1966 MiB |  53729 GiB |  53728 GiB |
|       from small pool |  40406 KiB |     60 MiB |    700 GiB |    700 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2268 MiB |   2276 MiB |   5150 MiB |   2882 MiB |
|       from large pool |   2204 MiB |   2212 MiB |   5044 MiB |   2840 MiB |
|       from small pool |     64 MiB |     70 MiB |    106 MiB |     42 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 367908 KiB | 418550 KiB |  42126 GiB |  42126 GiB |
|       from large pool | 361397 KiB | 409071 KiB |  41388 GiB |  41388 GiB |
|       from small pool |   6511 KiB |  20299 KiB |    738 GiB |    738 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    1298    |    1681    |   10429 K  |   10428 K  |
|       from large pool |     187    |     311    |    5003 K  |    5003 K  |
|       from small pool |    1111    |    1419    |    5425 K  |    5424 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    1298    |    1681    |   10429 K  |   10428 K  |
|       from large pool |     187    |     311    |    5003 K  |    5003 K  |
|       from small pool |    1111    |    1419    |    5425 K  |    5424 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     123    |     126    |     259    |     136    |
|       from large pool |      91    |      92    |     206    |     115    |
|       from small pool |      32    |      35    |      53    |      21    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      73    |     257    |    5726 K  |    5725 K  |
|       from large pool |      34    |      90    |    3557 K  |    3557 K  |
|       from small pool |      39    |     223    |    2168 K  |    2168 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   2004 MiB |  54615 GiB |  54615 GiB |
|       from large pool |  16640 KiB |   1971 MiB |  53913 GiB |  53913 GiB |
|       from small pool |      0 KiB |     60 MiB |    701 GiB |    701 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   2004 MiB |  54615 GiB |  54615 GiB |
|       from large pool |  16640 KiB |   1971 MiB |  53913 GiB |  53913 GiB |
|       from small pool |      0 KiB |     60 MiB |    701 GiB |    701 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   1998 MiB |  54429 GiB |  54429 GiB |
|       from large pool |  16640 KiB |   1966 MiB |  53729 GiB |  53729 GiB |
|       from small pool |      0 KiB |     60 MiB |    700 GiB |    700 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    804 MiB |   2276 MiB |   5150 MiB |   4346 MiB |
|       from large pool |    758 MiB |   2212 MiB |   5044 MiB |   4286 MiB |
|       from small pool |     46 MiB |     70 MiB |    106 MiB |     60 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  30464 KiB | 418550 KiB |  42127 GiB |  42127 GiB |
|       from large pool |  30464 KiB | 409071 KiB |  41388 GiB |  41388 GiB |
|       from small pool |      0 KiB |  20299 KiB |    738 GiB |    738 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    1681    |   10429 K  |   10429 K  |
|       from large pool |       2    |     311    |    5003 K  |    5003 K  |
|       from small pool |       0    |    1419    |    5425 K  |    5425 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    1681    |   10429 K  |   10429 K  |
|       from large pool |       2    |     311    |    5003 K  |    5003 K  |
|       from small pool |       0    |    1419    |    5425 K  |    5425 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      57    |     126    |     259    |     202    |
|       from large pool |      34    |      92    |     206    |     172    |
|       from small pool |      23    |      35    |      53    |      30    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |     257    |    5726 K  |    5726 K  |
|       from large pool |       4    |      90    |    3557 K  |    3557 K  |
|       from small pool |       0    |     223    |    2168 K  |    2168 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   2004 MiB |  54615 GiB |  54615 GiB |
|       from large pool |  16640 KiB |   1971 MiB |  53913 GiB |  53913 GiB |
|       from small pool |      0 KiB |     60 MiB |    701 GiB |    701 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   2004 MiB |  54615 GiB |  54615 GiB |
|       from large pool |  16640 KiB |   1971 MiB |  53913 GiB |  53913 GiB |
|       from small pool |      0 KiB |     60 MiB |    701 GiB |    701 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   1998 MiB |  54429 GiB |  54429 GiB |
|       from large pool |  16640 KiB |   1966 MiB |  53729 GiB |  53729 GiB |
|       from small pool |      0 KiB |     60 MiB |    700 GiB |    700 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    804 MiB |   2276 MiB |   5150 MiB |   4346 MiB |
|       from large pool |    758 MiB |   2212 MiB |   5044 MiB |   4286 MiB |
|       from small pool |     46 MiB |     70 MiB |    106 MiB |     60 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  30464 KiB | 418550 KiB |  42127 GiB |  42127 GiB |
|       from large pool |  30464 KiB | 409071 KiB |  41388 GiB |  41388 GiB |
|       from small pool |      0 KiB |  20299 KiB |    738 GiB |    738 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    1681    |   10429 K  |   10429 K  |
|       from large pool |       2    |     311    |    5003 K  |    5003 K  |
|       from small pool |       0    |    1419    |    5425 K  |    5425 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    1681    |   10429 K  |   10429 K  |
|       from large pool |       2    |     311    |    5003 K  |    5003 K  |
|       from small pool |       0    |    1419    |    5425 K  |    5425 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      57    |     126    |     259    |     202    |
|       from large pool |      34    |      92    |     206    |     172    |
|       from small pool |      23    |      35    |      53    |      30    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |     257    |    5726 K  |    5726 K  |
|       from large pool |       4    |      90    |    3557 K  |    3557 K  |
|       from small pool |       0    |     223    |    2168 K  |    2168 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_12_50_02_seed_3_23096844

 Experiment start at: 2024-07-27 12:50:03.030401
before training, model accuracy: 0.47111111879348755
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.96028644, 'precision': 0.9614655, 'recall': 0.9600139, 'specificity': 0.9600139, 'f1': 0.96023905, 'auroc': 0.995649, 'binary_precision': 0.9408867, 'binary_recall': 0.983269, 'binary_specificity': 0.9367589, 'binary_f1_score': 0.96161103}
confusion matrix:
      0     1
0  1422    96
1    26  1528
---- Validation: 
scalar performance:
{'acc': 0.7638348, 'precision': 0.78834295, 'recall': 0.7666166, 'specificity': 0.7666166, 'f1': 0.7599119, 'auroc': 0.8559166, 'binary_precision': 0.6992665, 'binary_recall': 0.90937996, 'binary_specificity': 0.6238532, 'binary_f1_score': 0.79060125}
confusion matrix:
     0    1
0  408  246
1   57  572
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.78444445, 'precision': 0.8159003, 'recall': 0.78444445, 'specificity': 0.78444445, 'f1': 0.77894145, 'auroc': 0.85366917, 'binary_precision': 0.7162162, 'binary_recall': 0.94222224, 'binary_specificity': 0.62666667, 'binary_f1_score': 0.8138196}
confusion matrix:
     0    1
0  141   84
1   13  212
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-27 12:51:42.886468,epoch time: 0:01:39.856067,used: 0:01:39.856067,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_12_50_02_seed_3_23096844
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.95442706, 'precision': 0.95661765, 'recall': 0.9549111, 'specificity': 0.9549111, 'f1': 0.9543991, 'auroc': 0.99114037, 'binary_precision': 0.9916667, 'binary_recall': 0.9177378, 'binary_specificity': 0.99208444, 'binary_f1_score': 0.953271}
confusion matrix:
      0     1
0  1504    12
1   128  1428
---- Validation: 
scalar performance:
{'acc': 0.7677319, 'precision': 0.80888975, 'recall': 0.7641188, 'specificity': 0.7641188, 'f1': 0.7580226, 'auroc': 0.8788889, 'binary_precision': 0.91687655, 'binary_recall': 0.57869637, 'binary_specificity': 0.9495413, 'binary_f1_score': 0.7095517}
confusion matrix:
     0    1
0  621   33
1  265  364
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7866667, 'precision': 0.8384366, 'recall': 0.78666663, 'specificity': 0.78666663, 'f1': 0.77818406, 'auroc': 0.9172543, 'binary_precision': 0.9708029, 'binary_recall': 0.5911111, 'binary_specificity': 0.9822222, 'binary_f1_score': 0.7348067}
confusion matrix:
     0    1
0  221    4
1   92  133
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-07-27 12:53:14.054113,epoch time: 0:01:31.167645,used: 0:03:11.023712,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_12_50_02_seed_3_23096844
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.97786456, 'precision': 0.97784364, 'recall': 0.9779117, 'specificity': 0.9779117, 'f1': 0.9778627, 'auroc': 0.9980147, 'binary_precision': 0.9818653, 'binary_recall': 0.97429305, 'binary_specificity': 0.98153037, 'binary_f1_score': 0.9780645}
confusion matrix:
      0     1
0  1488    28
1    40  1516
---- Validation: 
scalar performance:
{'acc': 0.79345286, 'precision': 0.80386925, 'recall': 0.7915968, 'specificity': 0.7915968, 'f1': 0.79089135, 'auroc': 0.8687713, 'binary_precision': 0.85546875, 'binary_recall': 0.6963434, 'binary_specificity': 0.8868502, 'binary_f1_score': 0.7677476}
confusion matrix:
     0    1
0  580   74
1  191  438
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.81333333, 'precision': 0.8153516, 'recall': 0.81333333, 'specificity': 0.81333333, 'f1': 0.8130342, 'auroc': 0.903842, 'binary_precision': 0.8405797, 'binary_recall': 0.7733333, 'binary_specificity': 0.85333335, 'binary_f1_score': 0.80555546}
confusion matrix:
     0    1
0  192   33
1   51  174
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-07-27 12:54:45.554554,epoch time: 0:01:31.500441,used: 0:04:42.524153,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_12_50_02_seed_3_23096844
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.98079425, 'precision': 0.9811591, 'recall': 0.9810581, 'specificity': 0.9810581, 'f1': 0.9807941, 'auroc': 0.9982401, 'binary_precision': 0.9986702, 'binary_recall': 0.9634381, 'binary_specificity': 0.99867815, 'binary_f1_score': 0.9807378}
confusion matrix:
      0     1
0  1511     2
1    57  1502
---- Validation: 
scalar performance:
{'acc': 0.7848792, 'precision': 0.8192487, 'recall': 0.7816373, 'specificity': 0.7816373, 'f1': 0.7775424, 'auroc': 0.88200283, 'binary_precision': 0.9192399, 'binary_recall': 0.6152623, 'binary_specificity': 0.94801223, 'binary_f1_score': 0.73714286}
confusion matrix:
     0    1
0  620   34
1  242  387
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.81333333, 'precision': 0.84482944, 'recall': 0.81333333, 'specificity': 0.81333333, 'f1': 0.8089713, 'auroc': 0.9088395, 'binary_precision': 0.9490446, 'binary_recall': 0.6622222, 'binary_specificity': 0.96444446, 'binary_f1_score': 0.7801047}
confusion matrix:
     0    1
0  217    8
1   76  149
early stop counter: 1
val acc:0.784879207611084, best validation acc: 0.7934528589248657, corresponding to test acc:                         0.8133333325386047 / 0.8133333325386047
after epoch: 4,now: 2024-07-27 12:56:16.960295,epoch time: 0:01:31.405741,used: 0:06:13.929894,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_12_50_02_seed_3_23096844
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9798177, 'precision': 0.980296, 'recall': 0.98003626, 'specificity': 0.98003626, 'f1': 0.9798167, 'auroc': 0.99938107, 'binary_precision': 0.9986631, 'binary_recall': 0.96138996, 'binary_specificity': 0.9986825, 'binary_f1_score': 0.97967213}
confusion matrix:
      0     1
0  1516     2
1    60  1494
---- Validation: 
scalar performance:
{'acc': 0.8215121, 'precision': 0.83047074, 'recall': 0.8198794, 'specificity': 0.8198794, 'f1': 0.8197177, 'auroc': 0.8964037, 'binary_precision': 0.88022816, 'binary_recall': 0.73608905, 'binary_specificity': 0.9036697, 'binary_f1_score': 0.80173165}
confusion matrix:
     0    1
0  591   63
1  166  463
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8577778, 'precision': 0.8720039, 'recall': 0.8577778, 'specificity': 0.8577778, 'f1': 0.8564049, 'auroc': 0.93560493, 'binary_precision': 0.9447514, 'binary_recall': 0.76, 'binary_specificity': 0.95555556, 'binary_f1_score': 0.8423645}
confusion matrix:
     0    1
0  215   10
1   54  171
new oracle model saved
better model found
persisted
after epoch: 5,now: 2024-07-27 12:57:48.054430,epoch time: 0:01:31.094135,used: 0:07:45.024029,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_12_50_02_seed_3_23096844
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.98567706, 'precision': 0.9857045, 'recall': 0.98579013, 'specificity': 0.98579013, 'f1': 0.9856767, 'auroc': 0.99860185, 'binary_precision': 0.9941215, 'binary_recall': 0.9775209, 'binary_specificity': 0.9940594, 'binary_f1_score': 0.98575133}
confusion matrix:
      0     1
0  1506     9
1    35  1522
---- Validation: 
scalar performance:
{'acc': 0.80358535, 'precision': 0.8267096, 'recall': 0.8009583, 'specificity': 0.8009583, 'f1': 0.7990378, 'auroc': 0.89684856, 'binary_precision': 0.9088937, 'binary_recall': 0.66613674, 'binary_specificity': 0.9357798, 'binary_f1_score': 0.76880735}
confusion matrix:
     0    1
0  612   42
1  210  419
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.76, 'precision': 0.82087225, 'recall': 0.76, 'specificity': 0.76, 'f1': 0.7480507, 'auroc': 0.9221333, 'binary_precision': 0.96062994, 'binary_recall': 0.5422222, 'binary_specificity': 0.9777778, 'binary_f1_score': 0.69318175}
confusion matrix:
     0    1
0  220    5
1  103  122
early stop counter: 1
val acc:0.8035853505134583, best validation acc: 0.8215121030807495, corresponding to test acc:                         0.8577777743339539 / 0.8577777743339539
after epoch: 6,now: 2024-07-27 12:59:18.973305,epoch time: 0:01:30.918875,used: 0:09:15.942904,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_12_50_02_seed_3_23096844
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9869792, 'precision': 0.98712236, 'recall': 0.98713803, 'specificity': 0.98713803, 'f1': 0.9869791, 'auroc': 0.9990084, 'binary_precision': 0.99934125, 'binary_recall': 0.9749357, 'binary_specificity': 0.99934036, 'binary_f1_score': 0.9869876}
confusion matrix:
      0     1
0  1515     1
1    39  1517
---- Validation: 
scalar performance:
{'acc': 0.73031956, 'precision': 0.79575837, 'recall': 0.72565913, 'specificity': 0.72565913, 'f1': 0.71182835, 'auroc': 0.88689387, 'binary_precision': 0.9300912, 'binary_recall': 0.4864865, 'binary_specificity': 0.9648318, 'binary_f1_score': 0.6388309}
confusion matrix:
     0    1
0  631   23
1  323  306
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7511111, 'precision': 0.82628787, 'recall': 0.75111115, 'specificity': 0.75111115, 'f1': 0.73589885, 'auroc': 0.9176889, 'binary_precision': 0.982906, 'binary_recall': 0.51111114, 'binary_specificity': 0.9911111, 'binary_f1_score': 0.6725146}
confusion matrix:
     0    1
0  223    2
1  110  115
early stop counter: 2
val acc:0.7303195595741272, best validation acc: 0.8215121030807495, corresponding to test acc:                         0.8577777743339539 / 0.8577777743339539
after epoch: 7,now: 2024-07-27 13:00:50.053874,epoch time: 0:01:31.080569,used: 0:10:47.023473,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_12_50_02_seed_3_23096844
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9765625, 'precision': 0.9771592, 'recall': 0.9768655, 'specificity': 0.9768655, 'f1': 0.9765613, 'auroc': 0.9986273, 'binary_precision': 0.9979893, 'binary_recall': 0.95571244, 'binary_specificity': 0.9980185, 'binary_f1_score': 0.97639346}
confusion matrix:
      0     1
0  1511     3
1    69  1489
---- Validation: 
scalar performance:
{'acc': 0.7887763, 'precision': 0.82636774, 'recall': 0.7854295, 'specificity': 0.7854295, 'f1': 0.78111714, 'auroc': 0.8946874, 'binary_precision': 0.93236715, 'binary_recall': 0.6136725, 'binary_specificity': 0.9571865, 'binary_f1_score': 0.74017256}
confusion matrix:
     0    1
0  626   28
1  243  386
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.78, 'precision': 0.837693, 'recall': 0.78, 'specificity': 0.78, 'f1': 0.77018434, 'auroc': 0.8906864, 'binary_precision': 0.97727275, 'binary_recall': 0.5733333, 'binary_specificity': 0.9866667, 'binary_f1_score': 0.7226891}
confusion matrix:
     0    1
0  222    3
1   96  129
early stop counter: 3
val acc:0.7887762784957886, best validation acc: 0.8215121030807495, corresponding to test acc:                         0.8577777743339539 / 0.8577777743339539
after epoch: 8,now: 2024-07-27 13:02:22.732882,epoch time: 0:01:32.679008,used: 0:12:19.702481,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_12_50_02_seed_3_23096844
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9817708, 'precision': 0.98211575, 'recall': 0.9819882, 'specificity': 0.9819882, 'f1': 0.9817705, 'auroc': 0.9988371, 'binary_precision': 0.9986702, 'binary_recall': 0.9652956, 'binary_specificity': 0.9986807, 'binary_f1_score': 0.9816993}
confusion matrix:
      0     1
0  1514     2
1    54  1502
---- Validation: 
scalar performance:
{'acc': 0.7607171, 'precision': 0.81355876, 'recall': 0.75666076, 'specificity': 0.75666076, 'f1': 0.7482051, 'auroc': 0.8966249, 'binary_precision': 0.9375, 'binary_recall': 0.5484897, 'binary_specificity': 0.9648318, 'binary_f1_score': 0.69207627}
confusion matrix:
     0    1
0  631   23
1  284  345
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.72444445, 'precision': 0.81366456, 'recall': 0.72444445, 'specificity': 0.72444445, 'f1': 0.70334923, 'auroc': 0.9448296, 'binary_precision': 0.9809524, 'binary_recall': 0.45777777, 'binary_specificity': 0.9911111, 'binary_f1_score': 0.6242424}
confusion matrix:
     0    1
0  223    2
1  122  103
early stop counter: 4
val acc:0.7607170939445496, best validation acc: 0.8215121030807495, corresponding to test acc:                         0.8577777743339539 / 0.8577777743339539
after epoch: 9,now: 2024-07-27 13:03:54.537010,epoch time: 0:01:31.804128,used: 0:13:51.506609,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_12_50_02_seed_3_23096844
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9876302, 'precision': 0.98760855, 'recall': 0.98765564, 'specificity': 0.98765564, 'f1': 0.98762834, 'auroc': 0.99953115, 'binary_precision': 0.9896907, 'binary_recall': 0.98587936, 'binary_specificity': 0.989432, 'binary_f1_score': 0.98778135}
confusion matrix:
      0     1
0  1498    16
1    22  1536
---- Validation: 
scalar performance:
{'acc': 0.7614965, 'precision': 0.80322355, 'recall': 0.7578203, 'specificity': 0.7578203, 'f1': 0.7512003, 'auroc': 0.89023644, 'binary_precision': 0.9109415, 'binary_recall': 0.5691574, 'binary_specificity': 0.9464832, 'binary_f1_score': 0.7005871}
confusion matrix:
     0    1
0  619   35
1  271  358
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.83555555, 'precision': 0.86928546, 'recall': 0.83555555, 'specificity': 0.83555555, 'f1': 0.8317127, 'auroc': 0.9581629, 'binary_precision': 0.9808917, 'binary_recall': 0.6844444, 'binary_specificity': 0.9866667, 'binary_f1_score': 0.8062827}
confusion matrix:
     0    1
0  222    3
1   71  154
early stop counter: 5
val acc:0.7614964842796326, best validation acc: 0.8215121030807495, corresponding to test acc:                         0.8577777743339539 / 0.8577777743339539
after epoch: 10,now: 2024-07-27 13:05:26.210932,epoch time: 0:01:31.673922,used: 0:15:23.180531,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_12_50_02_seed_3_23096844
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 10 with time: 0:15:23.180531 at 2024-07-27 13:05:26.210932
persisted model performance metric: 

scalar performance:
{'acc': 0.8577778, 'precision': 0.8720039, 'recall': 0.8577778, 'specificity': 0.8577778, 'f1': 0.8564049, 'auroc': 0.93560493, 'binary_precision': 0.9447514, 'binary_recall': 0.76, 'binary_specificity': 0.95555556, 'binary_f1_score': 0.8423645}
confusion matrix:
     0    1
0  215   10
1   54  171
oracle model performance metric: 

scalar performance:
{'acc': 0.8577778, 'precision': 0.8720039, 'recall': 0.8577778, 'specificity': 0.8577778, 'f1': 0.8564049, 'auroc': 0.93560493, 'binary_precision': 0.9447514, 'binary_recall': 0.76, 'binary_specificity': 0.95555556, 'binary_f1_score': 0.8423645}
confusion matrix:
     0    1
0  215   10
1   54  171
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_10seeds_nofreeze_2024-07-27_12-03-42/rule_results/0.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_10seeds_nofreeze_2024-07-27_12-03-42/confusion_matrix/0.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 454968 KiB |   2004 MiB |  76494 GiB |  76494 GiB |
|       from large pool | 414370 KiB |   1971 MiB |  75511 GiB |  75510 GiB |
|       from small pool |  40598 KiB |     60 MiB |    983 GiB |    983 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 454968 KiB |   2004 MiB |  76494 GiB |  76494 GiB |
|       from large pool | 414370 KiB |   1971 MiB |  75511 GiB |  75510 GiB |
|       from small pool |  40598 KiB |     60 MiB |    983 GiB |    983 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 447481 KiB |   1998 MiB |  76211 GiB |  76210 GiB |
|       from large pool | 407075 KiB |   1966 MiB |  75229 GiB |  75229 GiB |
|       from small pool |  40406 KiB |     60 MiB |    981 GiB |    981 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2290 MiB |   2290 MiB |   6636 MiB |   4346 MiB |
|       from large pool |   2220 MiB |   2220 MiB |   6506 MiB |   4286 MiB |
|       from small pool |     70 MiB |     70 MiB |    130 MiB |     60 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 368327 KiB | 418550 KiB |  59703 GiB |  59703 GiB |
|       from large pool | 361822 KiB | 409071 KiB |  58668 GiB |  58668 GiB |
|       from small pool |   6505 KiB |  20299 KiB |   1035 GiB |   1035 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    1310    |    1681    |   14608 K  |   14607 K  |
|       from large pool |     187    |     311    |    7007 K  |    7007 K  |
|       from small pool |    1123    |    1419    |    7601 K  |    7600 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    1310    |    1681    |   14608 K  |   14607 K  |
|       from large pool |     187    |     311    |    7007 K  |    7007 K  |
|       from small pool |    1123    |    1419    |    7601 K  |    7600 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     128    |     128    |     330    |     202    |
|       from large pool |      93    |      93    |     265    |     172    |
|       from small pool |      35    |      35    |      65    |      30    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      74    |     260    |    8110 K  |    8110 K  |
|       from large pool |      37    |      93    |    5073 K  |    5073 K  |
|       from small pool |      37    |     223    |    3036 K  |    3036 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   2004 MiB |  76494 GiB |  76494 GiB |
|       from large pool |  16640 KiB |   1971 MiB |  75511 GiB |  75511 GiB |
|       from small pool |      0 KiB |     60 MiB |    983 GiB |    983 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   2004 MiB |  76494 GiB |  76494 GiB |
|       from large pool |  16640 KiB |   1971 MiB |  75511 GiB |  75511 GiB |
|       from small pool |      0 KiB |     60 MiB |    983 GiB |    983 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   1998 MiB |  76211 GiB |  76211 GiB |
|       from large pool |  16640 KiB |   1966 MiB |  75229 GiB |  75229 GiB |
|       from small pool |      0 KiB |     60 MiB |    981 GiB |    981 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    804 MiB |   2290 MiB |   6636 MiB |   5832 MiB |
|       from large pool |    758 MiB |   2220 MiB |   6506 MiB |   5748 MiB |
|       from small pool |     46 MiB |     70 MiB |    130 MiB |     84 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  30464 KiB | 418550 KiB |  59703 GiB |  59703 GiB |
|       from large pool |  30464 KiB | 409071 KiB |  58668 GiB |  58668 GiB |
|       from small pool |      0 KiB |  20299 KiB |   1035 GiB |   1035 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    1681    |   14608 K  |   14608 K  |
|       from large pool |       2    |     311    |    7007 K  |    7007 K  |
|       from small pool |       0    |    1419    |    7601 K  |    7601 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    1681    |   14608 K  |   14608 K  |
|       from large pool |       2    |     311    |    7007 K  |    7007 K  |
|       from small pool |       0    |    1419    |    7601 K  |    7601 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      57    |     128    |     330    |     273    |
|       from large pool |      34    |      93    |     265    |     231    |
|       from small pool |      23    |      35    |      65    |      42    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |     260    |    8111 K  |    8111 K  |
|       from large pool |       4    |      93    |    5073 K  |    5073 K  |
|       from small pool |       0    |     223    |    3037 K  |    3037 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   2004 MiB |  76494 GiB |  76494 GiB |
|       from large pool |  16640 KiB |   1971 MiB |  75511 GiB |  75511 GiB |
|       from small pool |      0 KiB |     60 MiB |    983 GiB |    983 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   2004 MiB |  76494 GiB |  76494 GiB |
|       from large pool |  16640 KiB |   1971 MiB |  75511 GiB |  75511 GiB |
|       from small pool |      0 KiB |     60 MiB |    983 GiB |    983 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   1998 MiB |  76211 GiB |  76211 GiB |
|       from large pool |  16640 KiB |   1966 MiB |  75229 GiB |  75229 GiB |
|       from small pool |      0 KiB |     60 MiB |    981 GiB |    981 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    804 MiB |   2290 MiB |   6636 MiB |   5832 MiB |
|       from large pool |    758 MiB |   2220 MiB |   6506 MiB |   5748 MiB |
|       from small pool |     46 MiB |     70 MiB |    130 MiB |     84 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  30464 KiB | 418550 KiB |  59703 GiB |  59703 GiB |
|       from large pool |  30464 KiB | 409071 KiB |  58668 GiB |  58668 GiB |
|       from small pool |      0 KiB |  20299 KiB |   1035 GiB |   1035 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    1681    |   14608 K  |   14608 K  |
|       from large pool |       2    |     311    |    7007 K  |    7007 K  |
|       from small pool |       0    |    1419    |    7601 K  |    7601 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    1681    |   14608 K  |   14608 K  |
|       from large pool |       2    |     311    |    7007 K  |    7007 K  |
|       from small pool |       0    |    1419    |    7601 K  |    7601 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      57    |     128    |     330    |     273    |
|       from large pool |      34    |      93    |     265    |     231    |
|       from small pool |      23    |      35    |      65    |      42    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |     260    |    8111 K  |    8111 K  |
|       from large pool |       4    |      93    |    5073 K  |    5073 K  |
|       from small pool |       0    |     223    |    3037 K  |    3037 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_13_06_03_seed_4_23096844

 Experiment start at: 2024-07-27 13:06:03.356830
before training, model accuracy: 0.6350710988044739
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.94559586, 'precision': 0.9502691, 'recall': 0.94475216, 'specificity': 0.94475216, 'f1': 0.9453667, 'auroc': 0.9963423, 'binary_precision': 0.90856147, 'binary_recall': 0.99299806, 'binary_specificity': 0.89650625, 'binary_f1_score': 0.9489051}
confusion matrix:
      0     1
0  1360   157
1    11  1560
---- Validation: 
scalar performance:
{'acc': 0.75019515, 'precision': 0.805426, 'recall': 0.75299025, 'specificity': 0.75299025, 'f1': 0.7397188, 'auroc': 0.908543, 'binary_precision': 0.6721854, 'binary_recall': 0.9636076, 'binary_specificity': 0.5423729, 'binary_f1_score': 0.7919376}
confusion matrix:
     0    1
0  352  297
1   23  609
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.81042653, 'precision': 0.83049953, 'recall': 0.81042653, 'specificity': 0.81042653, 'f1': 0.8075037, 'auroc': 0.9447676, 'binary_precision': 0.7490494, 'binary_recall': 0.9336493, 'binary_specificity': 0.68720376, 'binary_f1_score': 0.8312236}
confusion matrix:
     0    1
0  145   66
1   14  197
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-27 13:07:43.868056,epoch time: 0:01:40.511226,used: 0:01:40.511226,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_13_06_03_seed_4_23096844
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.97117877, 'precision': 0.97211695, 'recall': 0.9716401, 'specificity': 0.9716401, 'f1': 0.9711762, 'auroc': 0.9973817, 'binary_precision': 0.9979839, 'binary_recall': 0.9452578, 'binary_specificity': 0.99802244, 'binary_f1_score': 0.97090554}
confusion matrix:
      0     1
0  1514     3
1    86  1485
---- Validation: 
scalar performance:
{'acc': 0.8235753, 'precision': 0.823591, 'recall': 0.8234821, 'specificity': 0.8234821, 'f1': 0.8235185, 'auroc': 0.897169, 'binary_precision': 0.82428116, 'binary_recall': 0.8164557, 'binary_specificity': 0.8305085, 'binary_f1_score': 0.8203498}
confusion matrix:
     0    1
0  539  110
1  116  516
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8483412, 'precision': 0.8657234, 'recall': 0.8483412, 'specificity': 0.8483412, 'f1': 0.84651756, 'auroc': 0.93973637, 'binary_precision': 0.94545454, 'binary_recall': 0.7393365, 'binary_specificity': 0.95734596, 'binary_f1_score': 0.82978725}
confusion matrix:
     0    1
0  202    9
1   55  156
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-07-27 13:09:15.249550,epoch time: 0:01:31.381494,used: 0:03:11.892720,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_13_06_03_seed_4_23096844
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.97506475, 'precision': 0.9754255, 'recall': 0.9753686, 'specificity': 0.9753686, 'f1': 0.97506475, 'auroc': 0.9979822, 'binary_precision': 0.9933906, 'binary_recall': 0.95732486, 'binary_specificity': 0.9934124, 'binary_f1_score': 0.9750243}
confusion matrix:
      0     1
0  1508    10
1    67  1503
---- Validation: 
scalar performance:
{'acc': 0.85714287, 'precision': 0.8577745, 'recall': 0.8568586, 'specificity': 0.8568586, 'f1': 0.8569891, 'auroc': 0.9279783, 'binary_precision': 0.8698517, 'binary_recall': 0.835443, 'binary_specificity': 0.87827426, 'binary_f1_score': 0.85230017}
confusion matrix:
     0    1
0  570   79
1  104  528
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8933649, 'precision': 0.90204316, 'recall': 0.8933649, 'specificity': 0.8933649, 'f1': 0.8927863, 'auroc': 0.95337033, 'binary_precision': 0.9611111, 'binary_recall': 0.8199052, 'binary_specificity': 0.96682465, 'binary_f1_score': 0.88491046}
confusion matrix:
     0    1
0  204    7
1   38  173
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-07-27 13:10:46.516390,epoch time: 0:01:31.266840,used: 0:04:43.159560,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_13_06_03_seed_4_23096844
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9702073, 'precision': 0.9711961, 'recall': 0.97072005, 'specificity': 0.97072005, 'f1': 0.97020483, 'auroc': 0.9985938, 'binary_precision': 0.9979825, 'binary_recall': 0.94342023, 'binary_specificity': 0.9980198, 'binary_f1_score': 0.96993464}
confusion matrix:
      0     1
0  1512     3
1    89  1484
---- Validation: 
scalar performance:
{'acc': 0.7478532, 'precision': 0.79778147, 'recall': 0.74510443, 'specificity': 0.74510443, 'f1': 0.735391, 'auroc': 0.8888724, 'binary_precision': 0.91644204, 'binary_recall': 0.53797466, 'binary_specificity': 0.9522342, 'binary_f1_score': 0.67796606}
confusion matrix:
     0    1
0  618   31
1  292  340
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8554502, 'precision': 0.8643627, 'recall': 0.8554503, 'specificity': 0.8554503, 'f1': 0.85456085, 'auroc': 0.92641675, 'binary_precision': 0.92134833, 'binary_recall': 0.7772512, 'binary_specificity': 0.9336493, 'binary_f1_score': 0.8431877}
confusion matrix:
     0    1
0  197   14
1   47  164
early stop counter: 1
val acc:0.7478532195091248, best validation acc: 0.8571428656578064, corresponding to test acc:                         0.8933649063110352 / 0.8933649063110352
after epoch: 4,now: 2024-07-27 13:12:17.897559,epoch time: 0:01:31.381169,used: 0:06:14.540729,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_13_06_03_seed_4_23096844
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9776554, 'precision': 0.97791576, 'recall': 0.97748965, 'specificity': 0.97748965, 'f1': 0.9776385, 'auroc': 0.99810284, 'binary_precision': 0.9706066, 'binary_recall': 0.9860229, 'binary_specificity': 0.9689564, 'binary_f1_score': 0.978254}
confusion matrix:
      0     1
0  1467    47
1    22  1552
---- Validation: 
scalar performance:
{'acc': 0.7876659, 'precision': 0.8023819, 'recall': 0.7861779, 'specificity': 0.7861779, 'f1': 0.7844277, 'auroc': 0.88373303, 'binary_precision': 0.86585367, 'binary_recall': 0.6740506, 'binary_specificity': 0.89830506, 'binary_f1_score': 0.75800705}
confusion matrix:
     0    1
0  583   66
1  206  426
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8649289, 'precision': 0.88398093, 'recall': 0.86492896, 'specificity': 0.86492896, 'f1': 0.8632324, 'auroc': 0.9557961, 'binary_precision': 0.9695122, 'binary_recall': 0.7535545, 'binary_specificity': 0.97630334, 'binary_f1_score': 0.848}
confusion matrix:
     0    1
0  206    5
1   52  159
early stop counter: 2
val acc:0.7876659035682678, best validation acc: 0.8571428656578064, corresponding to test acc:                         0.8933649063110352 / 0.8933649063110352
after epoch: 5,now: 2024-07-27 13:13:49.691828,epoch time: 0:01:31.794269,used: 0:07:46.334998,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_13_06_03_seed_4_23096844
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9789508, 'precision': 0.9789508, 'recall': 0.97909725, 'specificity': 0.97909725, 'f1': 0.9789492, 'auroc': 0.9978509, 'binary_precision': 0.9876943, 'binary_recall': 0.9707193, 'binary_specificity': 0.9874753, 'binary_f1_score': 0.97913325}
confusion matrix:
      0     1
0  1498    19
1    46  1525
---- Validation: 
scalar performance:
{'acc': 0.8321624, 'precision': 0.84671664, 'recall': 0.8307961, 'specificity': 0.8307961, 'f1': 0.82995355, 'auroc': 0.90980524, 'binary_precision': 0.91451293, 'binary_recall': 0.7278481, 'binary_specificity': 0.9337442, 'binary_f1_score': 0.81057274}
confusion matrix:
     0    1
0  606   43
1  172  460
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8720379, 'precision': 0.892342, 'recall': 0.8720379, 'specificity': 0.8720379, 'f1': 0.8703607, 'auroc': 0.9302352, 'binary_precision': 0.9815951, 'binary_recall': 0.75829387, 'binary_specificity': 0.98578197, 'binary_f1_score': 0.855615}
confusion matrix:
     0    1
0  208    3
1   51  160
early stop counter: 3
val acc:0.8321623802185059, best validation acc: 0.8571428656578064, corresponding to test acc:                         0.8933649063110352 / 0.8933649063110352
after epoch: 6,now: 2024-07-27 13:15:22.814399,epoch time: 0:01:33.122571,used: 0:09:19.457569,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_13_06_03_seed_4_23096844
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9876943, 'precision': 0.9877329, 'recall': 0.98765194, 'specificity': 0.98765194, 'f1': 0.98768866, 'auroc': 0.99932694, 'binary_precision': 0.98607594, 'binary_recall': 0.98983485, 'binary_specificity': 0.985469, 'binary_f1_score': 0.9879518}
confusion matrix:
      0     1
0  1492    22
1    16  1558
---- Validation: 
scalar performance:
{'acc': 0.82825917, 'precision': 0.8295142, 'recall': 0.8278352, 'specificity': 0.8278352, 'f1': 0.827942, 'auroc': 0.8997655, 'binary_precision': 0.84680134, 'binary_recall': 0.7958861, 'binary_specificity': 0.8597843, 'binary_f1_score': 0.8205547}
confusion matrix:
     0    1
0  558   91
1  129  503
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8459716, 'precision': 0.8546463, 'recall': 0.8459716, 'specificity': 0.8459716, 'f1': 0.8450239, 'auroc': 0.92282295, 'binary_precision': 0.9101124, 'binary_recall': 0.7677725, 'binary_specificity': 0.9241706, 'binary_f1_score': 0.83290493}
confusion matrix:
     0    1
0  195   16
1   49  162
early stop counter: 4
val acc:0.8282591700553894, best validation acc: 0.8571428656578064, corresponding to test acc:                         0.8933649063110352 / 0.8933649063110352
after epoch: 7,now: 2024-07-27 13:16:55.257290,epoch time: 0:01:32.442891,used: 0:10:51.900460,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_13_06_03_seed_4_23096844
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9831606, 'precision': 0.98312604, 'recall': 0.9832574, 'specificity': 0.9832574, 'f1': 0.98315835, 'auroc': 0.9988209, 'binary_precision': 0.9890534, 'binary_recall': 0.9777212, 'binary_specificity': 0.9887937, 'binary_f1_score': 0.9833547}
confusion matrix:
      0     1
0  1500    17
1    35  1536
---- Validation: 
scalar performance:
{'acc': 0.83918816, 'precision': 0.8429875, 'recall': 0.8398851, 'specificity': 0.8398851, 'f1': 0.83891237, 'auroc': 0.91620505, 'binary_precision': 0.8034188, 'binary_recall': 0.8924051, 'binary_specificity': 0.7873652, 'binary_f1_score': 0.84557724}
confusion matrix:
     0    1
0  511  138
1   68  564
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8364929, 'precision': 0.83650047, 'recall': 0.8364929, 'specificity': 0.8364929, 'f1': 0.83649194, 'auroc': 0.9183532, 'binary_precision': 0.83809525, 'binary_recall': 0.8341232, 'binary_specificity': 0.83886254, 'binary_f1_score': 0.8361045}
confusion matrix:
     0    1
0  177   34
1   35  176
early stop counter: 5
val acc:0.8391881585121155, best validation acc: 0.8571428656578064, corresponding to test acc:                         0.8933649063110352 / 0.8933649063110352
after epoch: 8,now: 2024-07-27 13:18:26.524288,epoch time: 0:01:31.266998,used: 0:12:23.167458,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_13_06_03_seed_4_23096844
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 8 with time: 0:12:23.167458 at 2024-07-27 13:18:26.524288
persisted model performance metric: 

scalar performance:
{'acc': 0.8933649, 'precision': 0.90204316, 'recall': 0.8933649, 'specificity': 0.8933649, 'f1': 0.8927863, 'auroc': 0.95337033, 'binary_precision': 0.9611111, 'binary_recall': 0.8199052, 'binary_specificity': 0.96682465, 'binary_f1_score': 0.88491046}
confusion matrix:
     0    1
0  204    7
1   38  173
oracle model performance metric: 

scalar performance:
{'acc': 0.8933649, 'precision': 0.90204316, 'recall': 0.8933649, 'specificity': 0.8933649, 'f1': 0.8927863, 'auroc': 0.95337033, 'binary_precision': 0.9611111, 'binary_recall': 0.8199052, 'binary_specificity': 0.96682465, 'binary_f1_score': 0.88491046}
confusion matrix:
     0    1
0  204    7
1   38  173
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_10seeds_nofreeze_2024-07-27_12-03-42/rule_results/0.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_10seeds_nofreeze_2024-07-27_12-03-42/confusion_matrix/0.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 454962 KiB |   2004 MiB |  94069 GiB |  94069 GiB |
|       from large pool | 414370 KiB |   1971 MiB |  92860 GiB |  92860 GiB |
|       from small pool |  40592 KiB |     60 MiB |   1209 GiB |   1209 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 454962 KiB |   2004 MiB |  94069 GiB |  94069 GiB |
|       from large pool | 414370 KiB |   1971 MiB |  92860 GiB |  92860 GiB |
|       from small pool |  40592 KiB |     60 MiB |   1209 GiB |   1209 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 447480 KiB |   1998 MiB |  93707 GiB |  93707 GiB |
|       from large pool | 407075 KiB |   1966 MiB |  92500 GiB |  92500 GiB |
|       from small pool |  40405 KiB |     60 MiB |   1206 GiB |   1206 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2284 MiB |   2290 MiB |   8116 MiB |   5832 MiB |
|       from large pool |   2220 MiB |   2220 MiB |   7968 MiB |   5748 MiB |
|       from small pool |     64 MiB |     70 MiB |    148 MiB |     84 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 368333 KiB | 418550 KiB |  73815 GiB |  73815 GiB |
|       from large pool | 361822 KiB | 409071 KiB |  72543 GiB |  72543 GiB |
|       from small pool |   6511 KiB |  20299 KiB |   1272 GiB |   1272 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    1298    |    1681    |   17962 K  |   17961 K  |
|       from large pool |     187    |     311    |    8616 K  |    8616 K  |
|       from small pool |    1111    |    1419    |    9346 K  |    9345 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    1298    |    1681    |   17962 K  |   17961 K  |
|       from large pool |     187    |     311    |    8616 K  |    8616 K  |
|       from small pool |    1111    |    1419    |    9346 K  |    9345 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     125    |     128    |     398    |     273    |
|       from large pool |      93    |      93    |     324    |     231    |
|       from small pool |      32    |      35    |      74    |      42    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      77    |     260    |   10013 K  |   10013 K  |
|       from large pool |      37    |      93    |    6290 K  |    6290 K  |
|       from small pool |      40    |     223    |    3722 K  |    3722 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   2004 MiB |  94069 GiB |  94069 GiB |
|       from large pool |  16640 KiB |   1971 MiB |  92860 GiB |  92860 GiB |
|       from small pool |      0 KiB |     60 MiB |   1209 GiB |   1209 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   2004 MiB |  94069 GiB |  94069 GiB |
|       from large pool |  16640 KiB |   1971 MiB |  92860 GiB |  92860 GiB |
|       from small pool |      0 KiB |     60 MiB |   1209 GiB |   1209 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   1998 MiB |  93707 GiB |  93707 GiB |
|       from large pool |  16640 KiB |   1966 MiB |  92500 GiB |  92500 GiB |
|       from small pool |      0 KiB |     60 MiB |   1206 GiB |   1206 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    804 MiB |   2290 MiB |   8116 MiB |   7312 MiB |
|       from large pool |    758 MiB |   2220 MiB |   7968 MiB |   7210 MiB |
|       from small pool |     46 MiB |     70 MiB |    148 MiB |    102 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  30464 KiB | 418550 KiB |  73816 GiB |  73816 GiB |
|       from large pool |  30464 KiB | 409071 KiB |  72543 GiB |  72543 GiB |
|       from small pool |      0 KiB |  20299 KiB |   1272 GiB |   1272 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    1681    |   17962 K  |   17962 K  |
|       from large pool |       2    |     311    |    8616 K  |    8616 K  |
|       from small pool |       0    |    1419    |    9346 K  |    9346 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    1681    |   17962 K  |   17962 K  |
|       from large pool |       2    |     311    |    8616 K  |    8616 K  |
|       from small pool |       0    |    1419    |    9346 K  |    9346 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      57    |     128    |     398    |     341    |
|       from large pool |      34    |      93    |     324    |     290    |
|       from small pool |      23    |      35    |      74    |      51    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |     260    |   10013 K  |   10013 K  |
|       from large pool |       4    |      93    |    6290 K  |    6290 K  |
|       from small pool |       0    |     223    |    3722 K  |    3722 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   2004 MiB |  94069 GiB |  94069 GiB |
|       from large pool |  16640 KiB |   1971 MiB |  92860 GiB |  92860 GiB |
|       from small pool |      0 KiB |     60 MiB |   1209 GiB |   1209 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   2004 MiB |  94069 GiB |  94069 GiB |
|       from large pool |  16640 KiB |   1971 MiB |  92860 GiB |  92860 GiB |
|       from small pool |      0 KiB |     60 MiB |   1209 GiB |   1209 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   1998 MiB |  93707 GiB |  93707 GiB |
|       from large pool |  16640 KiB |   1966 MiB |  92500 GiB |  92500 GiB |
|       from small pool |      0 KiB |     60 MiB |   1206 GiB |   1206 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    804 MiB |   2290 MiB |   8116 MiB |   7312 MiB |
|       from large pool |    758 MiB |   2220 MiB |   7968 MiB |   7210 MiB |
|       from small pool |     46 MiB |     70 MiB |    148 MiB |    102 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  30464 KiB | 418550 KiB |  73816 GiB |  73816 GiB |
|       from large pool |  30464 KiB | 409071 KiB |  72543 GiB |  72543 GiB |
|       from small pool |      0 KiB |  20299 KiB |   1272 GiB |   1272 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    1681    |   17962 K  |   17962 K  |
|       from large pool |       2    |     311    |    8616 K  |    8616 K  |
|       from small pool |       0    |    1419    |    9346 K  |    9346 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    1681    |   17962 K  |   17962 K  |
|       from large pool |       2    |     311    |    8616 K  |    8616 K  |
|       from small pool |       0    |    1419    |    9346 K  |    9346 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      57    |     128    |     398    |     341    |
|       from large pool |      34    |      93    |     324    |     290    |
|       from small pool |      23    |      35    |      74    |      51    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |     260    |   10013 K  |   10013 K  |
|       from large pool |       4    |      93    |    6290 K  |    6290 K  |
|       from small pool |       0    |     223    |    3722 K  |    3722 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_13_19_01_seed_5_23096844

 Experiment start at: 2024-07-27 13:19:02.061480
before training, model accuracy: 0.5476190447807312
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9584424, 'precision': 0.958587, 'recall': 0.95860994, 'specificity': 0.95860994, 'f1': 0.95844233, 'auroc': 0.99308, 'binary_precision': 0.9708609, 'binary_recall': 0.94641703, 'binary_specificity': 0.9708029, 'binary_f1_score': 0.9584831}
confusion matrix:
      0     1
0  1463    44
1    83  1466
---- Validation: 
scalar performance:
{'acc': 0.84059095, 'precision': 0.84152865, 'recall': 0.84135914, 'specificity': 0.84135914, 'f1': 0.84058857, 'auroc': 0.9056556, 'binary_precision': 0.8153153, 'binary_recall': 0.8688, 'binary_specificity': 0.8139183, 'binary_f1_score': 0.8412084}
confusion matrix:
     0    1
0  538  123
1   82  543
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.84415585, 'precision': 0.84418166, 'recall': 0.84415585, 'specificity': 0.84415585, 'f1': 0.844153, 'auroc': 0.92627573, 'binary_precision': 0.8412017, 'binary_recall': 0.8484849, 'binary_specificity': 0.8398268, 'binary_f1_score': 0.84482765}
confusion matrix:
     0    1
0  194   37
1   35  196
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-27 13:20:40.173822,epoch time: 0:01:38.112342,used: 0:01:38.112342,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_13_19_01_seed_5_23096844
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.97938484, 'precision': 0.97936845, 'recall': 0.9793949, 'specificity': 0.9793949, 'f1': 0.9793807, 'auroc': 0.9978982, 'binary_precision': 0.98062015, 'binary_recall': 0.9787234, 'binary_specificity': 0.9800664, 'binary_f1_score': 0.9796709}
confusion matrix:
      0     1
0  1475    30
1    33  1518
---- Validation: 
scalar performance:
{'acc': 0.8421462, 'precision': 0.8523624, 'recall': 0.8397349, 'specificity': 0.8397349, 'f1': 0.84022546, 'auroc': 0.9189156, 'binary_precision': 0.9057692, 'binary_recall': 0.7536, 'binary_specificity': 0.9258699, 'binary_f1_score': 0.8227074}
confusion matrix:
     0    1
0  612   49
1  154  471
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8203463, 'precision': 0.8341805, 'recall': 0.8203463, 'specificity': 0.8203463, 'f1': 0.8184676, 'auroc': 0.9123892, 'binary_precision': 0.90217394, 'binary_recall': 0.7186147, 'binary_specificity': 0.9220779, 'binary_f1_score': 0.8}
confusion matrix:
     0    1
0  213   18
1   65  166
better model found
persisted
after epoch: 2,now: 2024-07-27 13:22:12.540350,epoch time: 0:01:32.366528,used: 0:03:10.478870,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_13_19_01_seed_5_23096844
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.973822, 'precision': 0.9744041, 'recall': 0.9735993, 'specificity': 0.9735993, 'f1': 0.9737993, 'auroc': 0.9984046, 'binary_precision': 0.96112853, 'binary_recall': 0.98839456, 'binary_specificity': 0.958804, 'binary_f1_score': 0.97457093}
confusion matrix:
      0     1
0  1443    62
1    18  1533
---- Validation: 
scalar performance:
{'acc': 0.85069984, 'precision': 0.8510165, 'recall': 0.85019064, 'specificity': 0.85019064, 'f1': 0.85043615, 'auroc': 0.9080448, 'binary_precision': 0.85667217, 'binary_recall': 0.832, 'binary_specificity': 0.86838126, 'binary_f1_score': 0.84415585}
confusion matrix:
     0    1
0  574   87
1  105  520
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8549784, 'precision': 0.8747033, 'recall': 0.8549784, 'specificity': 0.8549784, 'f1': 0.8530444, 'auroc': 0.9323851, 'binary_precision': 0.96067417, 'binary_recall': 0.74025977, 'binary_specificity': 0.969697, 'binary_f1_score': 0.8361859}
confusion matrix:
     0    1
0  224    7
1   60  171
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-07-27 13:23:45.013090,epoch time: 0:01:32.472740,used: 0:04:42.951610,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_13_19_01_seed_5_23096844
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.966623, 'precision': 0.9675232, 'recall': 0.96704257, 'specificity': 0.96704257, 'f1': 0.96661985, 'auroc': 0.99567235, 'binary_precision': 0.99253225, 'binary_recall': 0.94140375, 'binary_specificity': 0.9926813, 'binary_f1_score': 0.96629214}
confusion matrix:
      0     1
0  1492    11
1    91  1462
---- Validation: 
scalar performance:
{'acc': 0.7356143, 'precision': 0.7850375, 'recall': 0.7296121, 'specificity': 0.7296121, 'f1': 0.72018284, 'auroc': 0.85685503, 'binary_precision': 0.89693594, 'binary_recall': 0.5152, 'binary_specificity': 0.9440242, 'binary_f1_score': 0.6544715}
confusion matrix:
     0    1
0  624   37
1  303  322
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8073593, 'precision': 0.80945283, 'recall': 0.80735934, 'specificity': 0.80735934, 'f1': 0.80703294, 'auroc': 0.8831356, 'binary_precision': 0.8349057, 'binary_recall': 0.76623374, 'binary_specificity': 0.8484849, 'binary_f1_score': 0.79909706}
confusion matrix:
     0    1
0  196   35
1   54  177
early stop counter: 1
val acc:0.7356142997741699, best validation acc: 0.8506998419761658, corresponding to test acc:                         0.8549783825874329 / 0.8549783825874329
after epoch: 4,now: 2024-07-27 13:25:15.971852,epoch time: 0:01:30.958762,used: 0:06:13.910372,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_13_19_01_seed_5_23096844
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9829843, 'precision': 0.9830706, 'recall': 0.983141, 'specificity': 0.983141, 'f1': 0.98298407, 'auroc': 0.99871004, 'binary_precision': 0.9940633, 'binary_recall': 0.9722581, 'binary_specificity': 0.9940239, 'binary_f1_score': 0.98303974}
confusion matrix:
      0     1
0  1497     9
1    43  1507
---- Validation: 
scalar performance:
{'acc': 0.66251945, 'precision': 0.7657095, 'recall': 0.6535407, 'specificity': 0.6535407, 'f1': 0.6186896, 'auroc': 0.8696182, 'binary_precision': 0.92444444, 'binary_recall': 0.3328, 'binary_specificity': 0.9742814, 'binary_f1_score': 0.48941174}
confusion matrix:
     0    1
0  644   17
1  417  208
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7316017, 'precision': 0.78501415, 'recall': 0.7316017, 'specificity': 0.7316017, 'f1': 0.718409, 'auroc': 0.8917749, 'binary_precision': 0.90839696, 'binary_recall': 0.5151515, 'binary_specificity': 0.9480519, 'binary_f1_score': 0.65745854}
confusion matrix:
     0    1
0  219   12
1  112  119
early stop counter: 2
val acc:0.6625194549560547, best validation acc: 0.8506998419761658, corresponding to test acc:                         0.8549783825874329 / 0.8549783825874329
after epoch: 5,now: 2024-07-27 13:26:46.050593,epoch time: 0:01:30.078741,used: 0:07:43.989113,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_13_19_01_seed_5_23096844
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9764398, 'precision': 0.9767778, 'recall': 0.9767116, 'specificity': 0.9767116, 'f1': 0.9764397, 'auroc': 0.99773633, 'binary_precision': 0.993992, 'binary_recall': 0.9594072, 'binary_specificity': 0.99401593, 'binary_f1_score': 0.97639346}
confusion matrix:
      0     1
0  1495     9
1    63  1489
---- Validation: 
scalar performance:
{'acc': 0.80793154, 'precision': 0.8331715, 'recall': 0.80401206, 'specificity': 0.80401206, 'f1': 0.8027209, 'auroc': 0.9010638, 'binary_precision': 0.9181416, 'binary_recall': 0.664, 'binary_specificity': 0.9440242, 'binary_f1_score': 0.7706592}
confusion matrix:
     0    1
0  624   37
1  210  415
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.75757575, 'precision': 0.803672, 'recall': 0.75757575, 'specificity': 0.75757575, 'f1': 0.7480131, 'auroc': 0.88971347, 'binary_precision': 0.9219858, 'binary_recall': 0.56277055, 'binary_specificity': 0.95238096, 'binary_f1_score': 0.6989247}
confusion matrix:
     0    1
0  220   11
1  101  130
early stop counter: 3
val acc:0.8079315423965454, best validation acc: 0.8506998419761658, corresponding to test acc:                         0.8549783825874329 / 0.8549783825874329
after epoch: 6,now: 2024-07-27 13:28:15.537293,epoch time: 0:01:29.486700,used: 0:09:13.475813,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_13_19_01_seed_5_23096844
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.99018323, 'precision': 0.9901548, 'recall': 0.9903119, 'specificity': 0.9903119, 'f1': 0.99018204, 'auroc': 0.99950385, 'binary_precision': 0.9973924, 'binary_recall': 0.9832905, 'binary_specificity': 0.99733335, 'binary_f1_score': 0.9902913}
confusion matrix:
      0     1
0  1496     4
1    26  1530
---- Validation: 
scalar performance:
{'acc': 0.84914464, 'precision': 0.8633207, 'recall': 0.84636855, 'specificity': 0.84636855, 'f1': 0.84683263, 'auroc': 0.92443454, 'binary_precision': 0.9284294, 'binary_recall': 0.7472, 'binary_specificity': 0.9455371, 'binary_f1_score': 0.82801425}
confusion matrix:
     0    1
0  625   36
1  158  467
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.77056277, 'precision': 0.81649387, 'recall': 0.77056277, 'specificity': 0.77056277, 'f1': 0.7619251, 'auroc': 0.90907216, 'binary_precision': 0.9370629, 'binary_recall': 0.5800866, 'binary_specificity': 0.96103895, 'binary_f1_score': 0.71657753}
confusion matrix:
     0    1
0  222    9
1   97  134
early stop counter: 4
val acc:0.8491446375846863, best validation acc: 0.8506998419761658, corresponding to test acc:                         0.8549783825874329 / 0.8549783825874329
after epoch: 7,now: 2024-07-27 13:29:45.214990,epoch time: 0:01:29.677697,used: 0:10:43.153510,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_13_19_01_seed_5_23096844
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9757853, 'precision': 0.97648776, 'recall': 0.97616446, 'specificity': 0.97616446, 'f1': 0.97578406, 'auroc': 0.9992237, 'binary_precision': 0.9993248, 'binary_recall': 0.9529942, 'binary_specificity': 0.9993347, 'binary_f1_score': 0.9756097}
confusion matrix:
      0     1
0  1502     1
1    73  1480
---- Validation: 
scalar performance:
{'acc': 0.65007776, 'precision': 0.7662792, 'recall': 0.6405664, 'specificity': 0.6405664, 'f1': 0.5987369, 'auroc': 0.9125035, 'binary_precision': 0.93532336, 'binary_recall': 0.3008, 'binary_specificity': 0.98033285, 'binary_f1_score': 0.4552058}
confusion matrix:
     0    1
0  648   13
1  437  188
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.53246754, 'precision': 0.72901523, 'recall': 0.53246754, 'specificity': 0.53246754, 'f1': 0.40475282, 'auroc': 0.91475046, 'binary_precision': 0.9411765, 'binary_recall': 0.06926407, 'binary_specificity': 0.995671, 'binary_f1_score': 0.12903225}
confusion matrix:
     0   1
0  230   1
1  215  16
early stop counter: 5
val acc:0.650077760219574, best validation acc: 0.8506998419761658, corresponding to test acc:                         0.8549783825874329 / 0.8549783825874329
after epoch: 8,now: 2024-07-27 13:31:16.781931,epoch time: 0:01:31.566941,used: 0:12:14.720451,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_13_19_01_seed_5_23096844
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 8 with time: 0:12:14.720451 at 2024-07-27 13:31:16.781931
persisted model performance metric: 

scalar performance:
{'acc': 0.8549784, 'precision': 0.8747033, 'recall': 0.8549784, 'specificity': 0.8549784, 'f1': 0.8530444, 'auroc': 0.9323851, 'binary_precision': 0.96067417, 'binary_recall': 0.74025977, 'binary_specificity': 0.969697, 'binary_f1_score': 0.8361859}
confusion matrix:
     0    1
0  224    7
1   60  171
oracle model performance metric: 

scalar performance:
{'acc': 0.8549784, 'precision': 0.8747033, 'recall': 0.8549784, 'specificity': 0.8549784, 'f1': 0.8530444, 'auroc': 0.9323851, 'binary_precision': 0.96067417, 'binary_recall': 0.74025977, 'binary_specificity': 0.969697, 'binary_f1_score': 0.8361859}
confusion matrix:
     0    1
0  224    7
1   60  171
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_10seeds_nofreeze_2024-07-27_12-03-42/rule_results/0.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_10seeds_nofreeze_2024-07-27_12-03-42/confusion_matrix/0.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 454968 KiB |   2004 MiB | 111557 GiB | 111557 GiB |
|       from large pool | 414370 KiB |   1971 MiB | 110124 GiB | 110123 GiB |
|       from small pool |  40598 KiB |     60 MiB |   1433 GiB |   1433 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 454968 KiB |   2004 MiB | 111557 GiB | 111557 GiB |
|       from large pool | 414370 KiB |   1971 MiB | 110124 GiB | 110123 GiB |
|       from small pool |  40598 KiB |     60 MiB |   1433 GiB |   1433 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 447482 KiB |   1998 MiB | 111118 GiB | 111117 GiB |
|       from large pool | 407075 KiB |   1966 MiB | 109687 GiB | 109687 GiB |
|       from small pool |  40407 KiB |     60 MiB |   1430 GiB |   1430 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2284 MiB |   2290 MiB |   9596 MiB |   7312 MiB |
|       from large pool |   2220 MiB |   2220 MiB |   9430 MiB |   7210 MiB |
|       from small pool |     64 MiB |     70 MiB |    166 MiB |    102 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 347847 KiB | 418550 KiB |  87874 GiB |  87874 GiB |
|       from large pool | 341342 KiB | 409071 KiB |  86366 GiB |  86365 GiB |
|       from small pool |   6505 KiB |  20299 KiB |   1508 GiB |   1508 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    1310    |    1681    |   21301 K  |   21300 K  |
|       from large pool |     187    |     311    |   10218 K  |   10217 K  |
|       from small pool |    1123    |    1419    |   11083 K  |   11082 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    1310    |    1681    |   21301 K  |   21300 K  |
|       from large pool |     187    |     311    |   10218 K  |   10217 K  |
|       from small pool |    1123    |    1419    |   11083 K  |   11082 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     125    |     128    |     466    |     341    |
|       from large pool |      93    |      93    |     383    |     290    |
|       from small pool |      32    |      35    |      83    |      51    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      72    |     260    |   11903 K  |   11903 K  |
|       from large pool |      35    |      93    |    7502 K  |    7502 K  |
|       from small pool |      37    |     223    |    4401 K  |    4401 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   2004 MiB | 111557 GiB | 111557 GiB |
|       from large pool |  16640 KiB |   1971 MiB | 110124 GiB | 110124 GiB |
|       from small pool |      0 KiB |     60 MiB |   1433 GiB |   1433 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   2004 MiB | 111557 GiB | 111557 GiB |
|       from large pool |  16640 KiB |   1971 MiB | 110124 GiB | 110124 GiB |
|       from small pool |      0 KiB |     60 MiB |   1433 GiB |   1433 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   1998 MiB | 111118 GiB | 111118 GiB |
|       from large pool |  16640 KiB |   1966 MiB | 109687 GiB | 109687 GiB |
|       from small pool |      0 KiB |     60 MiB |   1430 GiB |   1430 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    784 MiB |   2290 MiB |   9596 MiB |   8812 MiB |
|       from large pool |    738 MiB |   2220 MiB |   9430 MiB |   8692 MiB |
|       from small pool |     46 MiB |     70 MiB |    166 MiB |    120 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  30464 KiB | 418550 KiB |  87874 GiB |  87874 GiB |
|       from large pool |  30464 KiB | 409071 KiB |  86366 GiB |  86366 GiB |
|       from small pool |      0 KiB |  20299 KiB |   1508 GiB |   1508 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    1681    |   21301 K  |   21301 K  |
|       from large pool |       2    |     311    |   10218 K  |   10218 K  |
|       from small pool |       0    |    1419    |   11083 K  |   11083 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    1681    |   21301 K  |   21301 K  |
|       from large pool |       2    |     311    |   10218 K  |   10218 K  |
|       from small pool |       0    |    1419    |   11083 K  |   11083 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      56    |     128    |     466    |     410    |
|       from large pool |      33    |      93    |     383    |     350    |
|       from small pool |      23    |      35    |      83    |      60    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |     260    |   11904 K  |   11904 K  |
|       from large pool |       4    |      93    |    7502 K  |    7502 K  |
|       from small pool |       0    |     223    |    4401 K  |    4401 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   2004 MiB | 111557 GiB | 111557 GiB |
|       from large pool |  16640 KiB |   1971 MiB | 110124 GiB | 110124 GiB |
|       from small pool |      0 KiB |     60 MiB |   1433 GiB |   1433 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   2004 MiB | 111557 GiB | 111557 GiB |
|       from large pool |  16640 KiB |   1971 MiB | 110124 GiB | 110124 GiB |
|       from small pool |      0 KiB |     60 MiB |   1433 GiB |   1433 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   1998 MiB | 111118 GiB | 111118 GiB |
|       from large pool |  16640 KiB |   1966 MiB | 109687 GiB | 109687 GiB |
|       from small pool |      0 KiB |     60 MiB |   1430 GiB |   1430 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    784 MiB |   2290 MiB |   9596 MiB |   8812 MiB |
|       from large pool |    738 MiB |   2220 MiB |   9430 MiB |   8692 MiB |
|       from small pool |     46 MiB |     70 MiB |    166 MiB |    120 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  30464 KiB | 418550 KiB |  87874 GiB |  87874 GiB |
|       from large pool |  30464 KiB | 409071 KiB |  86366 GiB |  86366 GiB |
|       from small pool |      0 KiB |  20299 KiB |   1508 GiB |   1508 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    1681    |   21301 K  |   21301 K  |
|       from large pool |       2    |     311    |   10218 K  |   10218 K  |
|       from small pool |       0    |    1419    |   11083 K  |   11083 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    1681    |   21301 K  |   21301 K  |
|       from large pool |       2    |     311    |   10218 K  |   10218 K  |
|       from small pool |       0    |    1419    |   11083 K  |   11083 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      56    |     128    |     466    |     410    |
|       from large pool |      33    |      93    |     383    |     350    |
|       from small pool |      23    |      35    |      83    |      60    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |     260    |   11904 K  |   11904 K  |
|       from large pool |       4    |      93    |    7502 K  |    7502 K  |
|       from small pool |       0    |     223    |    4401 K  |    4401 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_13_31_51_seed_6_23096844

 Experiment start at: 2024-07-27 13:31:51.787776
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
before training, model accuracy: 0.5247747898101807
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9749349, 'precision': 0.9750949, 'recall': 0.9750576, 'specificity': 0.9750576, 'f1': 0.9749348, 'auroc': 0.99688005, 'binary_precision': 0.9867987, 'binary_recall': 0.96327317, 'binary_specificity': 0.9868421, 'binary_f1_score': 0.97489405}
confusion matrix:
      0     1
0  1500    20
1    57  1495
---- Validation: 
scalar performance:
{'acc': 0.79688716, 'precision': 0.8107773, 'recall': 0.7961414, 'specificity': 0.7961414, 'f1': 0.7943041, 'auroc': 0.86385924, 'binary_precision': 0.8747515, 'binary_recall': 0.6896552, 'binary_specificity': 0.9026275, 'binary_f1_score': 0.77125335}
confusion matrix:
     0    1
0  584   63
1  198  440
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8761261, 'precision': 0.88177323, 'recall': 0.8761261, 'specificity': 0.8761261, 'f1': 0.8756664, 'auroc': 0.9270554, 'binary_precision': 0.92820513, 'binary_recall': 0.8153153, 'binary_specificity': 0.9369369, 'binary_f1_score': 0.8681055}
confusion matrix:
     0    1
0  208   14
1   41  181
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-27 13:33:28.582909,epoch time: 0:01:36.795133,used: 0:01:36.795133,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_13_31_51_seed_6_23096844
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.97005206, 'precision': 0.97117376, 'recall': 0.97036844, 'specificity': 0.97036844, 'f1': 0.97004473, 'auroc': 0.9983764, 'binary_precision': 0.9972789, 'binary_recall': 0.94337195, 'binary_specificity': 0.99736494, 'binary_f1_score': 0.9695767}
confusion matrix:
      0     1
0  1514     4
1    88  1466
---- Validation: 
scalar performance:
{'acc': 0.67315173, 'precision': 0.7728309, 'recall': 0.6710208, 'specificity': 0.6710208, 'f1': 0.63866216, 'auroc': 0.88418514, 'binary_precision': 0.936, 'binary_recall': 0.36677116, 'binary_specificity': 0.97527045, 'binary_f1_score': 0.5270271}
confusion matrix:
     0    1
0  631   16
1  404  234
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6351351, 'precision': 0.7812025, 'recall': 0.6351351, 'specificity': 0.6351351, 'f1': 0.58068275, 'auroc': 0.9028742, 'binary_precision': 0.983871, 'binary_recall': 0.27477476, 'binary_specificity': 0.9954955, 'binary_f1_score': 0.42957744}
confusion matrix:
     0   1
0  221   1
1  161  61
early stop counter: 1
val acc:0.6731517314910889, best validation acc: 0.7968871593475342, corresponding to test acc:                         0.8761261105537415 / 0.8761261105537415
after epoch: 2,now: 2024-07-27 13:34:59.713951,epoch time: 0:01:31.131042,used: 0:03:07.926175,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_13_31_51_seed_6_23096844
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.98307294, 'precision': 0.98318636, 'recall': 0.9832003, 'specificity': 0.9832003, 'f1': 0.9830729, 'auroc': 0.9989258, 'binary_precision': 0.99407893, 'binary_recall': 0.9723295, 'binary_specificity': 0.9940711, 'binary_f1_score': 0.9830839}
confusion matrix:
      0     1
0  1509     9
1    43  1511
---- Validation: 
scalar performance:
{'acc': 0.6536965, 'precision': 0.762086, 'recall': 0.65142834, 'specificity': 0.65142834, 'f1': 0.6118328, 'auroc': 0.85071445, 'binary_precision': 0.9288889, 'binary_recall': 0.3275862, 'binary_specificity': 0.97527045, 'binary_f1_score': 0.4843569}
confusion matrix:
     0    1
0  631   16
1  429  209
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7567568, 'precision': 0.8221159, 'recall': 0.7567568, 'specificity': 0.7567568, 'f1': 0.74375856, 'auroc': 0.9008198, 'binary_precision': 0.9672131, 'binary_recall': 0.5315315, 'binary_specificity': 0.981982, 'binary_f1_score': 0.6860465}
confusion matrix:
     0    1
0  218    4
1  104  118
early stop counter: 2
val acc:0.6536964774131775, best validation acc: 0.7968871593475342, corresponding to test acc:                         0.8761261105537415 / 0.8761261105537415
after epoch: 3,now: 2024-07-27 13:36:31.114055,epoch time: 0:01:31.400104,used: 0:04:39.326279,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_13_31_51_seed_6_23096844
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9589844, 'precision': 0.96145165, 'recall': 0.9594946, 'specificity': 0.9594946, 'f1': 0.95895517, 'auroc': 0.99824286, 'binary_precision': 0.9986053, 'binary_recall': 0.9203085, 'binary_specificity': 0.9986807, 'binary_f1_score': 0.9578595}
confusion matrix:
      0     1
0  1514     2
1   124  1432
---- Validation: 
scalar performance:
{'acc': 0.6140078, 'precision': 0.73800135, 'recall': 0.6114597, 'specificity': 0.6114597, 'f1': 0.5535119, 'auroc': 0.85228604, 'binary_precision': 0.90804595, 'binary_recall': 0.24764891, 'binary_specificity': 0.97527045, 'binary_f1_score': 0.38916257}
confusion matrix:
     0    1
0  631   16
1  480  158
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.75, 'precision': 0.8120583, 'recall': 0.75, 'specificity': 0.75, 'f1': 0.73692054, 'auroc': 0.89083683, 'binary_precision': 0.9512195, 'binary_recall': 0.527027, 'binary_specificity': 0.972973, 'binary_f1_score': 0.6782609}
confusion matrix:
     0    1
0  216    6
1  105  117
early stop counter: 3
val acc:0.6140077710151672, best validation acc: 0.7968871593475342, corresponding to test acc:                         0.8761261105537415 / 0.8761261105537415
after epoch: 4,now: 2024-07-27 13:38:01.208523,epoch time: 0:01:30.094468,used: 0:06:09.420747,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_13_31_51_seed_6_23096844
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9814453, 'precision': 0.9814911, 'recall': 0.9814084, 'specificity': 0.9814084, 'f1': 0.9814414, 'auroc': 0.9985714, 'binary_precision': 0.9788868, 'binary_recall': 0.98455596, 'binary_specificity': 0.9782609, 'binary_f1_score': 0.9817132}
confusion matrix:
      0     1
0  1485    33
1    24  1530
---- Validation: 
scalar performance:
{'acc': 0.83579767, 'precision': 0.84597576, 'recall': 0.8351955, 'specificity': 0.8351955, 'f1': 0.83440125, 'auroc': 0.92064655, 'binary_precision': 0.9035917, 'binary_recall': 0.7492163, 'binary_specificity': 0.92117465, 'binary_f1_score': 0.81919456}
confusion matrix:
     0    1
0  596   51
1  160  478
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8265766, 'precision': 0.8614986, 'recall': 0.8265766, 'specificity': 0.8265766, 'f1': 0.82228464, 'auroc': 0.92873955, 'binary_precision': 0.9738562, 'binary_recall': 0.6711712, 'binary_specificity': 0.981982, 'binary_f1_score': 0.7946667}
confusion matrix:
     0    1
0  218    4
1   73  149
better model found
persisted
after epoch: 5,now: 2024-07-27 13:39:31.251408,epoch time: 0:01:30.042885,used: 0:07:39.463632,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_13_31_51_seed_6_23096844
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.98046875, 'precision': 0.9807763, 'recall': 0.98063934, 'specificity': 0.98063934, 'f1': 0.9804684, 'auroc': 0.99911237, 'binary_precision': 0.9960133, 'binary_recall': 0.9652286, 'binary_specificity': 0.99605006, 'binary_f1_score': 0.98037934}
confusion matrix:
      0     1
0  1513     6
1    54  1499
---- Validation: 
scalar performance:
{'acc': 0.68093383, 'precision': 0.7786225, 'recall': 0.6788469, 'specificity': 0.6788469, 'f1': 0.64874417, 'auroc': 0.89782846, 'binary_precision': 0.94186044, 'binary_recall': 0.38087773, 'binary_specificity': 0.97681606, 'binary_f1_score': 0.5424107}
confusion matrix:
     0    1
0  632   15
1  395  243
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6959459, 'precision': 0.78690696, 'recall': 0.695946, 'specificity': 0.695946, 'f1': 0.669772, 'auroc': 0.89499635, 'binary_precision': 0.9484536, 'binary_recall': 0.4144144, 'binary_specificity': 0.9774775, 'binary_f1_score': 0.5768025}
confusion matrix:
     0   1
0  217   5
1  130  92
early stop counter: 1
val acc:0.6809338331222534, best validation acc: 0.8357976675033569, corresponding to test acc:                         0.8265765905380249 / 0.8761261105537415
after epoch: 6,now: 2024-07-27 13:41:00.578225,epoch time: 0:01:29.326817,used: 0:09:08.790449,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_13_31_51_seed_6_23096844
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.991862, 'precision': 0.99184835, 'recall': 0.9918848, 'specificity': 0.9918848, 'f1': 0.99186146, 'auroc': 0.99968886, 'binary_precision': 0.9941748, 'binary_recall': 0.9896907, 'binary_specificity': 0.99407893, 'binary_f1_score': 0.9919277}
confusion matrix:
      0     1
0  1511     9
1    16  1536
---- Validation: 
scalar performance:
{'acc': 0.79688716, 'precision': 0.8197908, 'recall': 0.7959451, 'specificity': 0.7959451, 'f1': 0.79282194, 'auroc': 0.9091103, 'binary_precision': 0.9036403, 'binary_recall': 0.661442, 'binary_specificity': 0.93044823, 'binary_f1_score': 0.76380086}
confusion matrix:
     0    1
0  602   45
1  216  422
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8310811, 'precision': 0.8621252, 'recall': 0.8310811, 'specificity': 0.8310811, 'f1': 0.8273815, 'auroc': 0.9141506, 'binary_precision': 0.9681529, 'binary_recall': 0.6846847, 'binary_specificity': 0.9774775, 'binary_f1_score': 0.80211085}
confusion matrix:
     0    1
0  217    5
1   70  152
early stop counter: 2
val acc:0.7968871593475342, best validation acc: 0.8357976675033569, corresponding to test acc:                         0.8265765905380249 / 0.8761261105537415
after epoch: 7,now: 2024-07-27 13:42:30.305680,epoch time: 0:01:29.727455,used: 0:10:38.517904,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_13_31_51_seed_6_23096844
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9889323, 'precision': 0.98900795, 'recall': 0.98904526, 'specificity': 0.98904526, 'f1': 0.98893225, 'auroc': 0.99971724, 'binary_precision': 0.9986877, 'binary_recall': 0.97940797, 'binary_specificity': 0.9986825, 'binary_f1_score': 0.9889538}
confusion matrix:
      0     1
0  1516     2
1    32  1522
---- Validation: 
scalar performance:
{'acc': 0.7136187, 'precision': 0.7880317, 'recall': 0.7118277, 'specificity': 0.7118277, 'f1': 0.69273555, 'auroc': 0.88876927, 'binary_precision': 0.9326923, 'binary_recall': 0.45611286, 'binary_specificity': 0.9675425, 'binary_f1_score': 0.61263156}
confusion matrix:
     0    1
0  626   21
1  347  291
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6734234, 'precision': 0.7964106, 'recall': 0.6734234, 'specificity': 0.6734234, 'f1': 0.6356268, 'auroc': 0.90281326, 'binary_precision': 0.98734176, 'binary_recall': 0.35135135, 'binary_specificity': 0.9954955, 'binary_f1_score': 0.5182724}
confusion matrix:
     0   1
0  221   1
1  144  78
early stop counter: 3
val acc:0.7136186957359314, best validation acc: 0.8357976675033569, corresponding to test acc:                         0.8265765905380249 / 0.8761261105537415
after epoch: 8,now: 2024-07-27 13:43:59.515606,epoch time: 0:01:29.209926,used: 0:12:07.727830,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_13_31_51_seed_6_23096844
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.99088544, 'precision': 0.9909868, 'recall': 0.9908337, 'specificity': 0.9908337, 'f1': 0.99088335, 'auroc': 0.9996033, 'binary_precision': 0.9859604, 'binary_recall': 0.99613154, 'binary_specificity': 0.98553586, 'binary_f1_score': 0.9910199}
confusion matrix:
      0     1
0  1499    22
1     6  1545
---- Validation: 
scalar performance:
{'acc': 0.79610896, 'precision': 0.811506, 'recall': 0.7953249, 'specificity': 0.7953249, 'f1': 0.79325414, 'auroc': 0.89341146, 'binary_precision': 0.87903225, 'binary_recall': 0.68338555, 'binary_specificity': 0.9072643, 'binary_f1_score': 0.76895946}
confusion matrix:
     0    1
0  587   60
1  202  436
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7725225, 'precision': 0.8035734, 'recall': 0.7725225, 'specificity': 0.7725225, 'f1': 0.766553, 'auroc': 0.88629174, 'binary_precision': 0.90066224, 'binary_recall': 0.6126126, 'binary_specificity': 0.9324324, 'binary_f1_score': 0.7292225}
confusion matrix:
     0    1
0  207   15
1   86  136
early stop counter: 4
val acc:0.7961089611053467, best validation acc: 0.8357976675033569, corresponding to test acc:                         0.8265765905380249 / 0.8761261105537415
after epoch: 9,now: 2024-07-27 13:45:29.942459,epoch time: 0:01:30.426853,used: 0:13:38.154683,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_13_31_51_seed_6_23096844
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.961263, 'precision': 0.96358824, 'recall': 0.9616798, 'specificity': 0.9616798, 'f1': 0.96123475, 'auroc': 0.99934375, 'binary_precision': 0.99930364, 'binary_recall': 0.924018, 'binary_specificity': 0.99934167, 'binary_f1_score': 0.9601874}
confusion matrix:
      0     1
0  1518     1
1   118  1435
---- Validation: 
scalar performance:
{'acc': 0.5175097, 'precision': 0.7553276, 'recall': 0.5141066, 'specificity': 0.5141066, 'f1': 0.36547455, 'auroc': 0.9006785, 'binary_precision': 1.0, 'binary_recall': 0.028213166, 'binary_specificity': 1.0, 'binary_f1_score': 0.05487805}
confusion matrix:
     0   1
0  647   0
1  620  18
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5022523, 'precision': 0.75056434, 'recall': 0.5022523, 'specificity': 0.5022523, 'f1': 0.33831888, 'auroc': 0.8858352, 'binary_precision': 1.0, 'binary_recall': 0.0045045046, 'binary_specificity': 1.0, 'binary_f1_score': 0.008968609}
confusion matrix:
     0  1
0  222  0
1  221  1
early stop counter: 5
val acc:0.5175096988677979, best validation acc: 0.8357976675033569, corresponding to test acc:                         0.8265765905380249 / 0.8761261105537415
after epoch: 10,now: 2024-07-27 13:46:59.571301,epoch time: 0:01:29.628842,used: 0:15:07.783525,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_13_31_51_seed_6_23096844
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 10 with time: 0:15:07.783525 at 2024-07-27 13:46:59.571301
persisted model performance metric: 

scalar performance:
{'acc': 0.8265766, 'precision': 0.8614986, 'recall': 0.8265766, 'specificity': 0.8265766, 'f1': 0.82228464, 'auroc': 0.92873955, 'binary_precision': 0.9738562, 'binary_recall': 0.6711712, 'binary_specificity': 0.981982, 'binary_f1_score': 0.7946667}
confusion matrix:
     0    1
0  218    4
1   73  149
oracle model performance metric: 

scalar performance:
{'acc': 0.8761261, 'precision': 0.88177323, 'recall': 0.8761261, 'specificity': 0.8761261, 'f1': 0.8756664, 'auroc': 0.9270554, 'binary_precision': 0.92820513, 'binary_recall': 0.8153153, 'binary_specificity': 0.9369369, 'binary_f1_score': 0.8681055}
confusion matrix:
     0    1
0  208   14
1   41  181
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_10seeds_nofreeze_2024-07-27_12-03-42/rule_results/0.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_10seeds_nofreeze_2024-07-27_12-03-42/confusion_matrix/0.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 455390 KiB |   2004 MiB | 133403 GiB | 133402 GiB |
|       from large pool | 414795 KiB |   1971 MiB | 131690 GiB | 131689 GiB |
|       from small pool |  40595 KiB |     60 MiB |   1713 GiB |   1713 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 455390 KiB |   2004 MiB | 133403 GiB | 133402 GiB |
|       from large pool | 414795 KiB |   1971 MiB | 131690 GiB | 131689 GiB |
|       from small pool |  40595 KiB |     60 MiB |   1713 GiB |   1713 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 447481 KiB |   1998 MiB | 132890 GiB | 132890 GiB |
|       from large pool | 407075 KiB |   1966 MiB | 131180 GiB | 131180 GiB |
|       from small pool |  40406 KiB |     60 MiB |   1709 GiB |   1709 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2270 MiB |   2290 MiB |  11082 MiB |   8812 MiB |
|       from large pool |   2206 MiB |   2220 MiB |  10898 MiB |   8692 MiB |
|       from small pool |     64 MiB |     70 MiB |    184 MiB |    120 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 369953 KiB | 418550 KiB | 104606 GiB | 104606 GiB |
|       from large pool | 361397 KiB | 409071 KiB | 102803 GiB | 102803 GiB |
|       from small pool |   8556 KiB |  20299 KiB |   1802 GiB |   1802 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    1304    |    1681    |   25471 K  |   25470 K  |
|       from large pool |     187    |     311    |   12220 K  |   12220 K  |
|       from small pool |    1117    |    1419    |   13250 K  |   13249 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    1304    |    1681    |   25471 K  |   25470 K  |
|       from large pool |     187    |     311    |   12220 K  |   12220 K  |
|       from small pool |    1117    |    1419    |   13250 K  |   13249 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     124    |     128    |     534    |     410    |
|       from large pool |      92    |      93    |     442    |     350    |
|       from small pool |      32    |      35    |      92    |      60    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      72    |     260    |   14124 K  |   14124 K  |
|       from large pool |      34    |      93    |    8862 K  |    8862 K  |
|       from small pool |      38    |     223    |    5262 K  |    5262 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   2004 MiB | 133403 GiB | 133403 GiB |
|       from large pool |  16640 KiB |   1971 MiB | 131690 GiB | 131690 GiB |
|       from small pool |      0 KiB |     60 MiB |   1713 GiB |   1713 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   2004 MiB | 133403 GiB | 133403 GiB |
|       from large pool |  16640 KiB |   1971 MiB | 131690 GiB | 131690 GiB |
|       from small pool |      0 KiB |     60 MiB |   1713 GiB |   1713 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   1998 MiB | 132890 GiB | 132890 GiB |
|       from large pool |  16640 KiB |   1966 MiB | 131180 GiB | 131180 GiB |
|       from small pool |      0 KiB |     60 MiB |   1709 GiB |   1709 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    806 MiB |   2290 MiB |  11082 MiB |  10276 MiB |
|       from large pool |    758 MiB |   2220 MiB |  10898 MiB |  10140 MiB |
|       from small pool |     48 MiB |     70 MiB |    184 MiB |    136 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  30464 KiB | 418550 KiB | 104606 GiB | 104606 GiB |
|       from large pool |  30464 KiB | 409071 KiB | 102804 GiB | 102804 GiB |
|       from small pool |      0 KiB |  22273 KiB |   1802 GiB |   1802 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    1681    |   25471 K  |   25471 K  |
|       from large pool |       2    |     311    |   12220 K  |   12220 K  |
|       from small pool |       0    |    1419    |   13250 K  |   13250 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    1681    |   25471 K  |   25471 K  |
|       from large pool |       2    |     311    |   12220 K  |   12220 K  |
|       from small pool |       0    |    1419    |   13250 K  |   13250 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      58    |     128    |     534    |     476    |
|       from large pool |      34    |      93    |     442    |     408    |
|       from small pool |      24    |      35    |      92    |      68    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |     260    |   14124 K  |   14124 K  |
|       from large pool |       4    |      93    |    8862 K  |    8862 K  |
|       from small pool |       0    |     223    |    5262 K  |    5262 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   2004 MiB | 133403 GiB | 133403 GiB |
|       from large pool |  16640 KiB |   1971 MiB | 131690 GiB | 131690 GiB |
|       from small pool |      0 KiB |     60 MiB |   1713 GiB |   1713 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   2004 MiB | 133403 GiB | 133403 GiB |
|       from large pool |  16640 KiB |   1971 MiB | 131690 GiB | 131690 GiB |
|       from small pool |      0 KiB |     60 MiB |   1713 GiB |   1713 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   1998 MiB | 132890 GiB | 132890 GiB |
|       from large pool |  16640 KiB |   1966 MiB | 131180 GiB | 131180 GiB |
|       from small pool |      0 KiB |     60 MiB |   1709 GiB |   1709 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    806 MiB |   2290 MiB |  11082 MiB |  10276 MiB |
|       from large pool |    758 MiB |   2220 MiB |  10898 MiB |  10140 MiB |
|       from small pool |     48 MiB |     70 MiB |    184 MiB |    136 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  30464 KiB | 418550 KiB | 104606 GiB | 104606 GiB |
|       from large pool |  30464 KiB | 409071 KiB | 102804 GiB | 102804 GiB |
|       from small pool |      0 KiB |  22273 KiB |   1802 GiB |   1802 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    1681    |   25471 K  |   25471 K  |
|       from large pool |       2    |     311    |   12220 K  |   12220 K  |
|       from small pool |       0    |    1419    |   13250 K  |   13250 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    1681    |   25471 K  |   25471 K  |
|       from large pool |       2    |     311    |   12220 K  |   12220 K  |
|       from small pool |       0    |    1419    |   13250 K  |   13250 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      58    |     128    |     534    |     476    |
|       from large pool |      34    |      93    |     442    |     408    |
|       from small pool |      24    |      35    |      92    |      68    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |     260    |   14124 K  |   14124 K  |
|       from large pool |       4    |      93    |    8862 K  |    8862 K  |
|       from small pool |       0    |     223    |    5262 K  |    5262 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_13_47_34_seed_7_23096844

 Experiment start at: 2024-07-27 13:47:34.655019
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
before training, model accuracy: 0.4978165924549103
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9638672, 'precision': 0.96398926, 'recall': 0.9637719, 'specificity': 0.9637719, 'f1': 0.9638511, 'auroc': 0.9945305, 'binary_precision': 0.9594166, 'binary_recall': 0.9698718, 'binary_specificity': 0.95767194, 'binary_f1_score': 0.96461594}
confusion matrix:
      0     1
0  1448    64
1    47  1513
---- Validation: 
scalar performance:
{'acc': 0.7823077, 'precision': 0.7822652, 'recall': 0.7823154, 'specificity': 0.7823154, 'f1': 0.7822787, 'auroc': 0.85747874, 'binary_precision': 0.7767442, 'binary_recall': 0.7828125, 'binary_specificity': 0.7818182, 'binary_f1_score': 0.7797665}
confusion matrix:
     0    1
0  516  144
1  139  501
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8558952, 'precision': 0.85633004, 'recall': 0.85589516, 'specificity': 0.85589516, 'f1': 0.8558512, 'auroc': 0.9282241, 'binary_precision': 0.8687783, 'binary_recall': 0.83842796, 'binary_specificity': 0.8733624, 'binary_f1_score': 0.8533333}
confusion matrix:
     0    1
0  200   29
1   37  192
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-27 13:49:11.350842,epoch time: 0:01:36.695823,used: 0:01:36.695823,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_13_47_34_seed_7_23096844
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9736328, 'precision': 0.9740194, 'recall': 0.97391635, 'specificity': 0.97391635, 'f1': 0.9736326, 'auroc': 0.9965596, 'binary_precision': 0.99201596, 'binary_recall': 0.95576924, 'binary_specificity': 0.99206346, 'binary_f1_score': 0.9735554}
confusion matrix:
      0     1
0  1500    12
1    69  1491
---- Validation: 
scalar performance:
{'acc': 0.78615385, 'precision': 0.81672835, 'recall': 0.78373575, 'specificity': 0.78373575, 'f1': 0.77984893, 'auroc': 0.8780397, 'binary_precision': 0.91136366, 'binary_recall': 0.6265625, 'binary_specificity': 0.9409091, 'binary_f1_score': 0.7425926}
confusion matrix:
     0    1
0  621   39
1  239  401
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8624454, 'precision': 0.8756918, 'recall': 0.8624454, 'specificity': 0.8624454, 'f1': 0.86122215, 'auroc': 0.92692745, 'binary_precision': 0.94623655, 'binary_recall': 0.768559, 'binary_specificity': 0.95633185, 'binary_f1_score': 0.84819275}
confusion matrix:
     0    1
0  219   10
1   53  176
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-07-27 13:50:41.762521,epoch time: 0:01:30.411679,used: 0:03:07.107502,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_13_47_34_seed_7_23096844
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9733073, 'precision': 0.97338426, 'recall': 0.9732397, 'specificity': 0.9732397, 'f1': 0.9732971, 'auroc': 0.99743295, 'binary_precision': 0.9701018, 'binary_recall': 0.9775641, 'binary_specificity': 0.96891534, 'binary_f1_score': 0.9738186}
confusion matrix:
      0     1
0  1465    47
1    35  1525
---- Validation: 
scalar performance:
{'acc': 0.6707692, 'precision': 0.76723814, 'recall': 0.6660748, 'specificity': 0.6660748, 'f1': 0.63440436, 'auroc': 0.85967803, 'binary_precision': 0.924, 'binary_recall': 0.3609375, 'binary_specificity': 0.97121215, 'binary_f1_score': 0.51910114}
confusion matrix:
     0    1
0  641   19
1  409  231
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7510917, 'precision': 0.83003736, 'recall': 0.7510917, 'specificity': 0.7510917, 'f1': 0.7352601, 'auroc': 0.9360806, 'binary_precision': 0.991453, 'binary_recall': 0.5065502, 'binary_specificity': 0.9956332, 'binary_f1_score': 0.6705202}
confusion matrix:
     0    1
0  228    1
1  113  116
early stop counter: 1
val acc:0.670769214630127, best validation acc: 0.7861538529396057, corresponding to test acc:                         0.8624454140663147 / 0.8624454140663147
after epoch: 3,now: 2024-07-27 13:52:11.670571,epoch time: 0:01:29.908050,used: 0:04:37.015552,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_13_47_34_seed_7_23096844
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.97591144, 'precision': 0.97588074, 'recall': 0.9759768, 'specificity': 0.9759768, 'f1': 0.9759085, 'auroc': 0.9975571, 'binary_precision': 0.9805951, 'binary_recall': 0.97179484, 'binary_specificity': 0.98015875, 'binary_f1_score': 0.9761751}
confusion matrix:
      0     1
0  1482    30
1    44  1516
---- Validation: 
scalar performance:
{'acc': 0.80846155, 'precision': 0.809025, 'recall': 0.8080966, 'specificity': 0.8080966, 'f1': 0.80821085, 'auroc': 0.86765623, 'binary_precision': 0.81892335, 'binary_recall': 0.784375, 'binary_specificity': 0.83181816, 'binary_f1_score': 0.801277}
confusion matrix:
     0    1
0  549  111
1  138  502
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7991266, 'precision': 0.8117039, 'recall': 0.7991266, 'specificity': 0.7991266, 'f1': 0.7970797, 'auroc': 0.9132167, 'binary_precision': 0.7490909, 'binary_recall': 0.8995633, 'binary_specificity': 0.69868994, 'binary_f1_score': 0.8174603}
confusion matrix:
     0    1
0  160   69
1   23  206
better model found
persisted
after epoch: 4,now: 2024-07-27 13:53:41.482493,epoch time: 0:01:29.811922,used: 0:06:06.827474,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_13_47_34_seed_7_23096844
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.98860675, 'precision': 0.9886019, 'recall': 0.988721, 'specificity': 0.988721, 'f1': 0.988606, 'auroc': 0.99926066, 'binary_precision': 0.9960963, 'binary_recall': 0.98141026, 'binary_specificity': 0.99603176, 'binary_f1_score': 0.9886987}
confusion matrix:
      0     1
0  1506     6
1    29  1531
---- Validation: 
scalar performance:
{'acc': 0.74538463, 'precision': 0.81230605, 'recall': 0.74178505, 'specificity': 0.74178505, 'f1': 0.729071, 'auroc': 0.8939329, 'binary_precision': 0.95307916, 'binary_recall': 0.5078125, 'binary_specificity': 0.9757576, 'binary_f1_score': 0.6625892}
confusion matrix:
     0    1
0  644   16
1  315  325
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.79257643, 'precision': 0.8446316, 'recall': 0.79257643, 'specificity': 0.79257643, 'f1': 0.7844364, 'auroc': 0.9365954, 'binary_precision': 0.9785714, 'binary_recall': 0.59825325, 'binary_specificity': 0.98689955, 'binary_f1_score': 0.7425474}
confusion matrix:
     0    1
0  226    3
1   92  137
early stop counter: 1
val acc:0.7453846335411072, best validation acc: 0.8084615468978882, corresponding to test acc:                         0.7991266250610352 / 0.8624454140663147
after epoch: 5,now: 2024-07-27 13:55:11.166941,epoch time: 0:01:29.684448,used: 0:07:36.511922,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_13_47_34_seed_7_23096844
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9876302, 'precision': 0.9878067, 'recall': 0.98752546, 'specificity': 0.98752546, 'f1': 0.98762417, 'auroc': 0.9993607, 'binary_precision': 0.9816456, 'binary_recall': 0.99423075, 'binary_specificity': 0.9808201, 'binary_f1_score': 0.9878981}
confusion matrix:
      0     1
0  1483    29
1     9  1551
---- Validation: 
scalar performance:
{'acc': 0.8, 'precision': 0.80291104, 'recall': 0.8007339, 'specificity': 0.8007339, 'f1': 0.79974926, 'auroc': 0.8710133, 'binary_precision': 0.7691218, 'binary_recall': 0.8484375, 'binary_specificity': 0.7530303, 'binary_f1_score': 0.80683506}
confusion matrix:
     0    1
0  497  163
1   97  543
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.790393, 'precision': 0.8166996, 'recall': 0.790393, 'specificity': 0.790393, 'f1': 0.785948, 'auroc': 0.91542876, 'binary_precision': 0.72542375, 'binary_recall': 0.93449783, 'binary_specificity': 0.6462882, 'binary_f1_score': 0.8167939}
confusion matrix:
     0    1
0  148   81
1   15  214
early stop counter: 2
val acc:0.800000011920929, best validation acc: 0.8084615468978882, corresponding to test acc:                         0.7991266250610352 / 0.8624454140663147
after epoch: 6,now: 2024-07-27 13:56:41.373264,epoch time: 0:01:30.206323,used: 0:09:06.718245,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_13_47_34_seed_7_23096844
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9863281, 'precision': 0.9864122, 'recall': 0.98626375, 'specificity': 0.98626375, 'f1': 0.9863229, 'auroc': 0.99916905, 'binary_precision': 0.98282444, 'binary_recall': 0.99038464, 'binary_specificity': 0.98214287, 'binary_f1_score': 0.98659}
confusion matrix:
      0     1
0  1485    27
1    15  1545
---- Validation: 
scalar performance:
{'acc': 0.81153846, 'precision': 0.82987124, 'recall': 0.80970645, 'specificity': 0.80970645, 'f1': 0.8082202, 'auroc': 0.88738406, 'binary_precision': 0.9038855, 'binary_recall': 0.690625, 'binary_specificity': 0.9287879, 'binary_f1_score': 0.7829938}
confusion matrix:
     0    1
0  613   47
1  198  442
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8558952, 'precision': 0.8695377, 'recall': 0.8558952, 'specificity': 0.8558952, 'f1': 0.8545528, 'auroc': 0.9295208, 'binary_precision': 0.94054055, 'binary_recall': 0.75982535, 'binary_specificity': 0.9519651, 'binary_f1_score': 0.84057975}
confusion matrix:
     0    1
0  218   11
1   55  174
better model found
persisted
after epoch: 7,now: 2024-07-27 13:58:11.473694,epoch time: 0:01:30.100430,used: 0:10:36.818675,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_13_47_34_seed_7_23096844
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.98372394, 'precision': 0.98377776, 'recall': 0.9838828, 'specificity': 0.9838828, 'f1': 0.9837235, 'auroc': 0.9992712, 'binary_precision': 0.9941099, 'binary_recall': 0.9737179, 'binary_specificity': 0.99404764, 'binary_f1_score': 0.9838083}
confusion matrix:
      0     1
0  1503     9
1    41  1519
---- Validation: 
scalar performance:
{'acc': 0.74230766, 'precision': 0.7929852, 'recall': 0.7390625, 'specificity': 0.7390625, 'f1': 0.72891027, 'auroc': 0.89469695, 'binary_precision': 0.9110512, 'binary_recall': 0.528125, 'binary_specificity': 0.95, 'binary_f1_score': 0.6686449}
confusion matrix:
     0    1
0  627   33
1  302  338
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.720524, 'precision': 0.8162724, 'recall': 0.720524, 'specificity': 0.720524, 'f1': 0.6976398, 'auroc': 0.92517304, 'binary_precision': 0.99029124, 'binary_recall': 0.44541484, 'binary_specificity': 0.9956332, 'binary_f1_score': 0.6144578}
confusion matrix:
     0    1
0  228    1
1  127  102
early stop counter: 1
val acc:0.7423076629638672, best validation acc: 0.8115384578704834, corresponding to test acc:                         0.8558952212333679 / 0.8624454140663147
after epoch: 8,now: 2024-07-27 13:59:40.753193,epoch time: 0:01:29.279499,used: 0:12:06.098174,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_13_47_34_seed_7_23096844
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.98567706, 'precision': 0.9857007, 'recall': 0.985816, 'specificity': 0.985816, 'f1': 0.9856765, 'auroc': 0.998729, 'binary_precision': 0.9947781, 'binary_recall': 0.97692305, 'binary_specificity': 0.994709, 'binary_f1_score': 0.98576975}
confusion matrix:
      0     1
0  1504     8
1    36  1524
---- Validation: 
scalar performance:
{'acc': 0.8346154, 'precision': 0.8533735, 'recall': 0.83283615, 'specificity': 0.83283615, 'f1': 0.83184034, 'auroc': 0.91841614, 'binary_precision': 0.9310345, 'binary_recall': 0.7171875, 'binary_specificity': 0.94848484, 'binary_f1_score': 0.81023836}
confusion matrix:
     0    1
0  626   34
1  181  459
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.84934497, 'precision': 0.87073016, 'recall': 0.84934497, 'specificity': 0.84934497, 'f1': 0.84714055, 'auroc': 0.92889154, 'binary_precision': 0.95977014, 'binary_recall': 0.72925764, 'binary_specificity': 0.9694323, 'binary_f1_score': 0.8287841}
confusion matrix:
     0    1
0  222    7
1   62  167
better model found
persisted
after epoch: 9,now: 2024-07-27 14:01:10.053272,epoch time: 0:01:29.300079,used: 0:13:35.398253,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_13_47_34_seed_7_23096844
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9749349, 'precision': 0.9758462, 'recall': 0.9746388, 'specificity': 0.9746388, 'f1': 0.9749056, 'auroc': 0.99895835, 'binary_precision': 0.95856524, 'binary_recall': 0.99358976, 'binary_specificity': 0.9556878, 'binary_f1_score': 0.9757633}
confusion matrix:
      0     1
0  1445    67
1    10  1550
---- Validation: 
scalar performance:
{'acc': 0.8292308, 'precision': 0.8301748, 'recall': 0.82964015, 'specificity': 0.82964015, 'f1': 0.82919806, 'auroc': 0.882017, 'binary_precision': 0.8082596, 'binary_recall': 0.85625, 'binary_specificity': 0.8030303, 'binary_f1_score': 0.831563}
confusion matrix:
     0    1
0  530  130
1   92  548
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8318777, 'precision': 0.8319347, 'recall': 0.8318777, 'specificity': 0.8318777, 'f1': 0.83187056, 'auroc': 0.9123205, 'binary_precision': 0.82758623, 'binary_recall': 0.83842796, 'binary_specificity': 0.8253275, 'binary_f1_score': 0.8329718}
confusion matrix:
     0    1
0  189   40
1   37  192
early stop counter: 1
val acc:0.829230785369873, best validation acc: 0.8346154093742371, corresponding to test acc:                         0.8493449687957764 / 0.8624454140663147
after epoch: 10,now: 2024-07-27 14:02:39.249716,epoch time: 0:01:29.196444,used: 0:15:04.594697,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_13_47_34_seed_7_23096844
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9902344, 'precision': 0.99020696, 'recall': 0.9903134, 'specificity': 0.9903134, 'f1': 0.9902333, 'auroc': 0.9995303, 'binary_precision': 0.9954663, 'binary_recall': 0.98525643, 'binary_specificity': 0.9953704, 'binary_f1_score': 0.99033505}
confusion matrix:
      0     1
0  1505     7
1    23  1537
---- Validation: 
scalar performance:
{'acc': 0.7592308, 'precision': 0.7857624, 'recall': 0.7568419, 'specificity': 0.7568419, 'f1': 0.7523299, 'auroc': 0.86878073, 'binary_precision': 0.86907446, 'binary_recall': 0.6015625, 'binary_specificity': 0.91212124, 'binary_f1_score': 0.710988}
confusion matrix:
     0    1
0  602   58
1  255  385
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8209607, 'precision': 0.8300488, 'recall': 0.8209607, 'specificity': 0.8209607, 'f1': 0.8197197, 'auroc': 0.90743876, 'binary_precision': 0.88481677, 'binary_recall': 0.7379913, 'binary_specificity': 0.9039301, 'binary_f1_score': 0.80476195}
confusion matrix:
     0    1
0  207   22
1   60  169
early stop counter: 2
val acc:0.7592307925224304, best validation acc: 0.8346154093742371, corresponding to test acc:                         0.8493449687957764 / 0.8624454140663147
after epoch: 11,now: 2024-07-27 14:04:08.560143,epoch time: 0:01:29.310427,used: 0:16:33.905124,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_13_47_34_seed_7_23096844
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9847005, 'precision': 0.9849262, 'recall': 0.9849359, 'specificity': 0.9849359, 'f1': 0.98470056, 'auroc': 0.99950314, 'binary_precision': 1.0, 'binary_recall': 0.9698718, 'binary_specificity': 1.0, 'binary_f1_score': 0.98470557}
confusion matrix:
      0     1
0  1512     0
1    47  1513
---- Validation: 
scalar performance:
{'acc': 0.68923074, 'precision': 0.7852609, 'recall': 0.68470645, 'specificity': 0.68470645, 'f1': 0.6574449, 'auroc': 0.89692944, 'binary_precision': 0.9469697, 'binary_recall': 0.390625, 'binary_specificity': 0.9787879, 'binary_f1_score': 0.5530973}
confusion matrix:
     0    1
0  646   14
1  390  250
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.71834064, 'precision': 0.8068718, 'recall': 0.71834064, 'specificity': 0.71834064, 'f1': 0.69644713, 'auroc': 0.9067142, 'binary_precision': 0.9716981, 'binary_recall': 0.44978166, 'binary_specificity': 0.98689955, 'binary_f1_score': 0.6149254}
confusion matrix:
     0    1
0  226    3
1  126  103
early stop counter: 3
val acc:0.689230740070343, best validation acc: 0.8346154093742371, corresponding to test acc:                         0.8493449687957764 / 0.8624454140663147
after epoch: 12,now: 2024-07-27 14:05:38.178846,epoch time: 0:01:29.618703,used: 0:18:03.523827,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_13_47_34_seed_7_23096844
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9866536, 'precision': 0.9869983, 'recall': 0.98649263, 'specificity': 0.98649263, 'f1': 0.9866448, 'auroc': 0.9995184, 'binary_precision': 0.9773727, 'binary_recall': 0.9967949, 'binary_specificity': 0.97619045, 'binary_f1_score': 0.98698825}
confusion matrix:
      0     1
0  1476    36
1     5  1555
---- Validation: 
scalar performance:
{'acc': 0.8507692, 'precision': 0.8534383, 'recall': 0.8500947, 'specificity': 0.8500947, 'f1': 0.8502841, 'auroc': 0.9043442, 'binary_precision': 0.8805461, 'binary_recall': 0.80625, 'binary_specificity': 0.8939394, 'binary_f1_score': 0.8417618}
confusion matrix:
     0    1
0  590   70
1  124  516
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.84497815, 'precision': 0.84503734, 'recall': 0.8449782, 'specificity': 0.8449782, 'f1': 0.84497154, 'auroc': 0.9115958, 'binary_precision': 0.8495575, 'binary_recall': 0.83842796, 'binary_specificity': 0.8515284, 'binary_f1_score': 0.8439561}
confusion matrix:
     0    1
0  195   34
1   37  192
better model found
persisted
after epoch: 13,now: 2024-07-27 14:07:07.639391,epoch time: 0:01:29.460545,used: 0:19:32.984372,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_13_47_34_seed_7_23096844
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9895833, 'precision': 0.98957187, 'recall': 0.98959094, 'specificity': 0.98959094, 'f1': 0.989581, 'auroc': 0.9993721, 'binary_precision': 0.9903723, 'binary_recall': 0.98910254, 'binary_specificity': 0.99007934, 'binary_f1_score': 0.98973703}
confusion matrix:
      0     1
0  1497    15
1    17  1543
---- Validation: 
scalar performance:
{'acc': 0.84, 'precision': 0.84476364, 'recall': 0.8390862, 'specificity': 0.8390862, 'f1': 0.8391591, 'auroc': 0.8985938, 'binary_precision': 0.8816254, 'binary_recall': 0.7796875, 'binary_specificity': 0.8984848, 'binary_f1_score': 0.8275291}
confusion matrix:
     0    1
0  593   67
1  141  499
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8537118, 'precision': 0.87068343, 'recall': 0.8537118, 'specificity': 0.8537118, 'f1': 0.852018, 'auroc': 0.9291775, 'binary_precision': 0.95, 'binary_recall': 0.7467249, 'binary_specificity': 0.96069866, 'binary_f1_score': 0.8361859}
confusion matrix:
     0    1
0  220    9
1   58  171
early stop counter: 1
val acc:0.8399999737739563, best validation acc: 0.8507692217826843, corresponding to test acc:                         0.8449781537055969 / 0.8624454140663147
after epoch: 14,now: 2024-07-27 14:08:36.580827,epoch time: 0:01:28.941436,used: 0:21:01.925808,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_13_47_34_seed_7_23096844
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9899089, 'precision': 0.9898799, 'recall': 0.9899827, 'specificity': 0.9899827, 'f1': 0.98990774, 'auroc': 0.9997283, 'binary_precision': 0.994822, 'binary_recall': 0.98525643, 'binary_specificity': 0.994709, 'binary_f1_score': 0.99001616}
confusion matrix:
      0     1
0  1504     8
1    23  1537
---- Validation: 
scalar performance:
{'acc': 0.8415385, 'precision': 0.8604545, 'recall': 0.8397727, 'specificity': 0.8397727, 'f1': 0.8389119, 'auroc': 0.9198183, 'binary_precision': 0.9392713, 'binary_recall': 0.725, 'binary_specificity': 0.95454544, 'binary_f1_score': 0.81834215}
confusion matrix:
     0    1
0  630   30
1  176  464
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.84061134, 'precision': 0.8685014, 'recall': 0.84061134, 'specificity': 0.84061134, 'f1': 0.83753735, 'auroc': 0.9334109, 'binary_precision': 0.9698795, 'binary_recall': 0.70305675, 'binary_specificity': 0.9781659, 'binary_f1_score': 0.8151899}
confusion matrix:
     0    1
0  224    5
1   68  161
early stop counter: 2
val acc:0.8415384888648987, best validation acc: 0.8507692217826843, corresponding to test acc:                         0.8449781537055969 / 0.8624454140663147
after epoch: 15,now: 2024-07-27 14:10:06.483249,epoch time: 0:01:29.902422,used: 0:22:31.828230,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_13_47_34_seed_7_23096844
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9824219, 'precision': 0.9831172, 'recall': 0.9821734, 'specificity': 0.9821734, 'f1': 0.9824047, 'auroc': 0.9997473, 'binary_precision': 0.9682836, 'binary_recall': 0.9980769, 'binary_specificity': 0.96626985, 'binary_f1_score': 0.9829545}
confusion matrix:
      0     1
0  1461    51
1     3  1557
---- Validation: 
scalar performance:
{'acc': 0.85615385, 'precision': 0.85614246, 'recall': 0.8560843, 'specificity': 0.8560843, 'f1': 0.8561088, 'auroc': 0.91288114, 'binary_precision': 0.855573, 'binary_recall': 0.8515625, 'binary_specificity': 0.8606061, 'binary_f1_score': 0.8535631}
confusion matrix:
     0    1
0  568   92
1   95  545
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8689956, 'precision': 0.87183183, 'recall': 0.86899567, 'specificity': 0.86899567, 'f1': 0.8687453, 'auroc': 0.9197955, 'binary_precision': 0.83935744, 'binary_recall': 0.91266376, 'binary_specificity': 0.8253275, 'binary_f1_score': 0.87447697}
confusion matrix:
     0    1
0  189   40
1   20  209
new oracle model saved
better model found
persisted
after epoch: 16,now: 2024-07-27 14:11:36.377876,epoch time: 0:01:29.894627,used: 0:24:01.722857,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_13_47_34_seed_7_23096844
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.98339844, 'precision': 0.9835441, 'recall': 0.983603, 'specificity': 0.983603, 'f1': 0.9833983, 'auroc': 0.99913466, 'binary_precision': 0.99670833, 'binary_recall': 0.9705128, 'binary_specificity': 0.99669313, 'binary_f1_score': 0.9834361}
confusion matrix:
      0     1
0  1507     5
1    46  1514
---- Validation: 
scalar performance:
{'acc': 0.7469231, 'precision': 0.75948966, 'recall': 0.7451705, 'specificity': 0.7451705, 'f1': 0.7428808, 'auroc': 0.8456274, 'binary_precision': 0.81287724, 'binary_recall': 0.63125, 'binary_specificity': 0.8590909, 'binary_f1_score': 0.710642}
confusion matrix:
     0    1
0  567   93
1  236  404
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.76419216, 'precision': 0.80091655, 'recall': 0.76419216, 'specificity': 0.76419216, 'f1': 0.7567711, 'auroc': 0.897828, 'binary_precision': 0.90604025, 'binary_recall': 0.5895197, 'binary_specificity': 0.93886465, 'binary_f1_score': 0.71428573}
confusion matrix:
     0    1
0  215   14
1   94  135
early stop counter: 1
val acc:0.7469230890274048, best validation acc: 0.8561538457870483, corresponding to test acc:                         0.8689956068992615 / 0.8689956068992615
after epoch: 17,now: 2024-07-27 14:13:07.054425,epoch time: 0:01:30.676549,used: 0:25:32.399406,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_13_47_34_seed_7_23096844
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.99153644, 'precision': 0.9915091, 'recall': 0.9916158, 'specificity': 0.9916158, 'f1': 0.99153554, 'auroc': 0.99948406, 'binary_precision': 0.9967617, 'binary_recall': 0.98653847, 'binary_specificity': 0.99669313, 'binary_f1_score': 0.9916237}
confusion matrix:
      0     1
0  1507     5
1    21  1539
---- Validation: 
scalar performance:
{'acc': 0.7530769, 'precision': 0.7988982, 'recall': 0.75002366, 'specificity': 0.75002366, 'f1': 0.7416853, 'auroc': 0.8785044, 'binary_precision': 0.9121447, 'binary_recall': 0.5515625, 'binary_specificity': 0.94848484, 'binary_f1_score': 0.68743914}
confusion matrix:
     0    1
0  626   34
1  287  353
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.81877726, 'precision': 0.8506082, 'recall': 0.8187773, 'specificity': 0.8187773, 'f1': 0.8145686, 'auroc': 0.9181938, 'binary_precision': 0.95625, 'binary_recall': 0.6681223, 'binary_specificity': 0.9694323, 'binary_f1_score': 0.7866324}
confusion matrix:
     0    1
0  222    7
1   76  153
early stop counter: 2
val acc:0.7530769109725952, best validation acc: 0.8561538457870483, corresponding to test acc:                         0.8689956068992615 / 0.8689956068992615
after epoch: 18,now: 2024-07-27 14:14:37.615593,epoch time: 0:01:30.561168,used: 0:27:02.960574,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_13_47_34_seed_7_23096844
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.99609375, 'precision': 0.9960703, 'recall': 0.9961233, 'specificity': 0.9961233, 'f1': 0.99609303, 'auroc': 0.9999279, 'binary_precision': 0.9980695, 'binary_recall': 0.99423075, 'binary_specificity': 0.9980159, 'binary_f1_score': 0.99614644}
confusion matrix:
      0     1
0  1509     3
1     9  1551
---- Validation: 
scalar performance:
{'acc': 0.83, 'precision': 0.835773, 'recall': 0.8289772, 'specificity': 0.8289772, 'f1': 0.8289261, 'auroc': 0.89794266, 'binary_precision': 0.87612206, 'binary_recall': 0.7625, 'binary_specificity': 0.8954545, 'binary_f1_score': 0.81537175}
confusion matrix:
     0    1
0  591   69
1  152  488
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8558952, 'precision': 0.86298305, 'recall': 0.85589516, 'specificity': 0.85589516, 'f1': 0.85518825, 'auroc': 0.9283576, 'binary_precision': 0.9137056, 'binary_recall': 0.7860262, 'binary_specificity': 0.9257642, 'binary_f1_score': 0.84507036}
confusion matrix:
     0    1
0  212   17
1   49  180
early stop counter: 3
val acc:0.8299999833106995, best validation acc: 0.8561538457870483, corresponding to test acc:                         0.8689956068992615 / 0.8689956068992615
after epoch: 19,now: 2024-07-27 14:16:07.508331,epoch time: 0:01:29.892738,used: 0:28:32.853312,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_13_47_34_seed_7_23096844
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.93066406, 'precision': 0.93810874, 'recall': 0.9317206, 'specificity': 0.9317206, 'f1': 0.93046826, 'auroc': 0.99369407, 'binary_precision': 0.9992587, 'binary_recall': 0.86410254, 'binary_specificity': 0.9993386, 'binary_f1_score': 0.9267789}
confusion matrix:
      0     1
0  1511     1
1   212  1348
---- Validation: 
scalar performance:
{'acc': 0.59307694, 'precision': 0.7307147, 'recall': 0.58702654, 'specificity': 0.58702654, 'f1': 0.51449764, 'auroc': 0.8477776, 'binary_precision': 0.90510947, 'binary_recall': 0.19375, 'binary_specificity': 0.98030305, 'binary_f1_score': 0.31917632}
confusion matrix:
     0    1
0  647   13
1  516  124
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5960699, 'precision': 0.7559959, 'recall': 0.5960699, 'specificity': 0.5960699, 'f1': 0.5213076, 'auroc': 0.8917211, 'binary_precision': 0.9583333, 'binary_recall': 0.20087336, 'binary_specificity': 0.99126637, 'binary_f1_score': 0.33212996}
confusion matrix:
     0   1
0  227   2
1  183  46
early stop counter: 4
val acc:0.5930769443511963, best validation acc: 0.8561538457870483, corresponding to test acc:                         0.8689956068992615 / 0.8689956068992615
after epoch: 20,now: 2024-07-27 14:17:38.458294,epoch time: 0:01:30.949963,used: 0:30:03.803275,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_13_47_34_seed_7_23096844
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.99283856, 'precision': 0.9929694, 'recall': 0.9927554, 'specificity': 0.9927554, 'f1': 0.9928354, 'auroc': 0.99991095, 'binary_precision': 0.9879442, 'binary_recall': 0.9980769, 'binary_specificity': 0.98743385, 'binary_f1_score': 0.9929847}
confusion matrix:
      0     1
0  1493    19
1     3  1557
---- Validation: 
scalar performance:
{'acc': 0.8638462, 'precision': 0.8640889, 'recall': 0.8636364, 'specificity': 0.8636364, 'f1': 0.8637474, 'auroc': 0.91744554, 'binary_precision': 0.8704, 'binary_recall': 0.85, 'binary_specificity': 0.8772727, 'binary_f1_score': 0.86007905}
confusion matrix:
     0    1
0  579   81
1   96  544
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8668122, 'precision': 0.8755858, 'recall': 0.8668122, 'specificity': 0.8668122, 'f1': 0.86602986, 'auroc': 0.9233805, 'binary_precision': 0.9329897, 'binary_recall': 0.790393, 'binary_specificity': 0.94323146, 'binary_f1_score': 0.855792}
confusion matrix:
     0    1
0  216   13
1   48  181
better model found
persisted
after epoch: 21,now: 2024-07-27 14:19:08.150270,epoch time: 0:01:29.691976,used: 0:31:33.495251,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_13_47_34_seed_7_23096844
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9905599, 'precision': 0.99058723, 'recall': 0.99053216, 'specificity': 0.99053216, 'f1': 0.9905571, 'auroc': 0.9995887, 'binary_precision': 0.98913735, 'binary_recall': 0.99230766, 'binary_specificity': 0.9887566, 'binary_f1_score': 0.99072}
confusion matrix:
      0     1
0  1495    17
1    12  1548
---- Validation: 
scalar performance:
{'acc': 0.82461536, 'precision': 0.8430129, 'recall': 0.822822, 'specificity': 0.822822, 'f1': 0.82163656, 'auroc': 0.91571677, 'binary_precision': 0.9186992, 'binary_recall': 0.70625, 'binary_specificity': 0.93939394, 'binary_f1_score': 0.79858655}
confusion matrix:
     0    1
0  620   40
1  188  452
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.75545853, 'precision': 0.812732, 'recall': 0.7554585, 'specificity': 0.7554585, 'f1': 0.743725, 'auroc': 0.9129688, 'binary_precision': 0.9465649, 'binary_recall': 0.5414847, 'binary_specificity': 0.9694323, 'binary_f1_score': 0.68888885}
confusion matrix:
     0    1
0  222    7
1  105  124
early stop counter: 1
val acc:0.8246153593063354, best validation acc: 0.8638461828231812, corresponding to test acc:                         0.8668122291564941 / 0.8689956068992615
after epoch: 22,now: 2024-07-27 14:20:38.310781,epoch time: 0:01:30.160511,used: 0:33:03.655762,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_13_47_34_seed_7_23096844
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.9733073, 'precision': 0.9737123, 'recall': 0.97359586, 'specificity': 0.97359586, 'f1': 0.973307, 'auroc': 0.9982376, 'binary_precision': 0.99201065, 'binary_recall': 0.9551282, 'binary_specificity': 0.99206346, 'binary_f1_score': 0.97322017}
confusion matrix:
      0     1
0  1500    12
1    70  1490
---- Validation: 
scalar performance:
{'acc': 0.83615386, 'precision': 0.844553, 'recall': 0.8349432, 'specificity': 0.8349432, 'f1': 0.8347693, 'auroc': 0.914053, 'binary_precision': 0.89463955, 'binary_recall': 0.75625, 'binary_specificity': 0.9136364, 'binary_f1_score': 0.81964433}
confusion matrix:
     0    1
0  603   57
1  156  484
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8515284, 'precision': 0.85284716, 'recall': 0.8515284, 'specificity': 0.8515284, 'f1': 0.8513895, 'auroc': 0.9164394, 'binary_precision': 0.8744186, 'binary_recall': 0.8209607, 'binary_specificity': 0.88209605, 'binary_f1_score': 0.8468469}
confusion matrix:
     0    1
0  202   27
1   41  188
early stop counter: 2
val acc:0.8361538648605347, best validation acc: 0.8638461828231812, corresponding to test acc:                         0.8668122291564941 / 0.8689956068992615
after epoch: 23,now: 2024-07-27 14:22:08.221726,epoch time: 0:01:29.910945,used: 0:34:33.566707,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_13_47_34_seed_7_23096844
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.99316406, 'precision': 0.9932837, 'recall': 0.9930861, 'specificity': 0.9930861, 'f1': 0.9931612, 'auroc': 0.9998237, 'binary_precision': 0.9885714, 'binary_recall': 0.9980769, 'binary_specificity': 0.9880952, 'binary_f1_score': 0.99330145}
confusion matrix:
      0     1
0  1494    18
1     3  1557
---- Validation: 
scalar performance:
{'acc': 0.8261539, 'precision': 0.82634944, 'recall': 0.82634944, 'specificity': 0.82634944, 'f1': 0.8261538, 'auroc': 0.89999586, 'binary_precision': 0.81363636, 'binary_recall': 0.8390625, 'binary_specificity': 0.81363636, 'binary_f1_score': 0.8261538}
confusion matrix:
     0    1
0  537  123
1  103  537
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8908297, 'precision': 0.890949, 'recall': 0.8908297, 'specificity': 0.8908297, 'f1': 0.89082134, 'auroc': 0.93928415, 'binary_precision': 0.8977778, 'binary_recall': 0.88209605, 'binary_specificity': 0.8995633, 'binary_f1_score': 0.88986784}
confusion matrix:
     0    1
0  206   23
1   27  202
new oracle model saved
early stop counter: 3
val acc:0.8261538743972778, best validation acc: 0.8638461828231812, corresponding to test acc:                         0.8668122291564941 / 0.8908296823501587
after epoch: 24,now: 2024-07-27 14:23:38.585530,epoch time: 0:01:30.363804,used: 0:36:03.930511,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_13_47_34_seed_7_23096844
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.9895833, 'precision': 0.9895833, 'recall': 0.9897029, 'specificity': 0.9897029, 'f1': 0.98958266, 'auroc': 0.9997694, 'binary_precision': 0.9973958, 'binary_recall': 0.98205125, 'binary_specificity': 0.9973545, 'binary_f1_score': 0.989664}
confusion matrix:
      0     1
0  1508     4
1    28  1532
---- Validation: 
scalar performance:
{'acc': 0.7946154, 'precision': 0.830927, 'recall': 0.7920455, 'specificity': 0.7920455, 'f1': 0.7877987, 'auroc': 0.9129954, 'binary_precision': 0.9367682, 'binary_recall': 0.625, 'binary_specificity': 0.9590909, 'binary_f1_score': 0.7497657}
confusion matrix:
     0    1
0  633   27
1  240  400
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.80131006, 'precision': 0.8468783, 'recall': 0.80131006, 'specificity': 0.80131006, 'f1': 0.7945632, 'auroc': 0.93056965, 'binary_precision': 0.9726027, 'binary_recall': 0.6200873, 'binary_specificity': 0.98253274, 'binary_f1_score': 0.75733334}
confusion matrix:
     0    1
0  225    4
1   87  142
early stop counter: 4
val acc:0.7946153879165649, best validation acc: 0.8638461828231812, corresponding to test acc:                         0.8668122291564941 / 0.8908296823501587
after epoch: 25,now: 2024-07-27 14:25:08.517511,epoch time: 0:01:29.931981,used: 0:37:33.862492,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_13_47_34_seed_7_23096844
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.99316406, 'precision': 0.9931352, 'recall': 0.9932387, 'specificity': 0.9932387, 'f1': 0.9931633, 'auroc': 0.9997003, 'binary_precision': 0.99805826, 'binary_recall': 0.98846155, 'binary_specificity': 0.9980159, 'binary_f1_score': 0.9932367}
confusion matrix:
      0     1
0  1509     3
1    18  1542
---- Validation: 
scalar performance:
{'acc': 0.8076923, 'precision': 0.81891024, 'recall': 0.8062263, 'specificity': 0.8062263, 'f1': 0.8054358, 'auroc': 0.8796668, 'binary_precision': 0.875, 'binary_recall': 0.7109375, 'binary_specificity': 0.9015151, 'binary_f1_score': 0.7844828}
confusion matrix:
     0    1
0  595   65
1  185  455
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.86026204, 'precision': 0.87046295, 'recall': 0.86026204, 'specificity': 0.86026204, 'f1': 0.85929346, 'auroc': 0.929659, 'binary_precision': 0.93193716, 'binary_recall': 0.77729255, 'binary_specificity': 0.94323146, 'binary_f1_score': 0.84761906}
confusion matrix:
     0    1
0  216   13
1   51  178
early stop counter: 5
val acc:0.807692289352417, best validation acc: 0.8638461828231812, corresponding to test acc:                         0.8668122291564941 / 0.8908296823501587
after epoch: 26,now: 2024-07-27 14:26:38.836092,epoch time: 0:01:30.318581,used: 0:39:04.181073,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_13_47_34_seed_7_23096844
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 26 with time: 0:39:04.181073 at 2024-07-27 14:26:38.836092
persisted model performance metric: 

scalar performance:
{'acc': 0.8668122, 'precision': 0.8755858, 'recall': 0.8668122, 'specificity': 0.8668122, 'f1': 0.86602986, 'auroc': 0.9233805, 'binary_precision': 0.9329897, 'binary_recall': 0.790393, 'binary_specificity': 0.94323146, 'binary_f1_score': 0.855792}
confusion matrix:
     0    1
0  216   13
1   48  181
oracle model performance metric: 

scalar performance:
{'acc': 0.8908297, 'precision': 0.890949, 'recall': 0.8908297, 'specificity': 0.8908297, 'f1': 0.89082134, 'auroc': 0.93928415, 'binary_precision': 0.8977778, 'binary_recall': 0.88209605, 'binary_specificity': 0.8995633, 'binary_f1_score': 0.88986784}
confusion matrix:
     0    1
0  206   23
1   27  202
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_10seeds_nofreeze_2024-07-27_12-03-42/rule_results/0.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_10seeds_nofreeze_2024-07-27_12-03-42/confusion_matrix/0.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 454968 KiB |   2004 MiB | 190056 GiB | 190056 GiB |
|       from large pool | 414370 KiB |   1971 MiB | 187620 GiB | 187619 GiB |
|       from small pool |  40598 KiB |     60 MiB |   2436 GiB |   2436 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 454968 KiB |   2004 MiB | 190056 GiB | 190056 GiB |
|       from large pool | 414370 KiB |   1971 MiB | 187620 GiB | 187619 GiB |
|       from small pool |  40598 KiB |     60 MiB |   2436 GiB |   2436 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 447482 KiB |   1998 MiB | 189292 GiB | 189291 GiB |
|       from large pool | 407075 KiB |   1966 MiB | 186860 GiB | 186859 GiB |
|       from small pool |  40407 KiB |     60 MiB |   2431 GiB |   2431 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2284 MiB |   2290 MiB |  12560 MiB |  10276 MiB |
|       from large pool |   2220 MiB |   2220 MiB |  12360 MiB |  10140 MiB |
|       from small pool |     64 MiB |     70 MiB |    200 MiB |    136 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 347847 KiB | 418550 KiB | 150091 GiB | 150091 GiB |
|       from large pool | 341342 KiB | 409071 KiB | 147527 GiB | 147527 GiB |
|       from small pool |   6505 KiB |  22273 KiB |   2563 GiB |   2563 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    1310    |    1681    |   36272 K  |   36271 K  |
|       from large pool |     187    |     311    |   17408 K  |   17407 K  |
|       from small pool |    1123    |    1419    |   18864 K  |   18863 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    1310    |    1681    |   36272 K  |   36271 K  |
|       from large pool |     187    |     311    |   17408 K  |   17407 K  |
|       from small pool |    1123    |    1419    |   18864 K  |   18863 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     125    |     128    |     601    |     476    |
|       from large pool |      93    |      93    |     501    |     408    |
|       from small pool |      32    |      35    |     100    |      68    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      72    |     260    |   20266 K  |   20266 K  |
|       from large pool |      35    |      93    |   12793 K  |   12793 K  |
|       from small pool |      37    |     223    |    7473 K  |    7473 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   2004 MiB | 190056 GiB | 190056 GiB |
|       from large pool |  16640 KiB |   1971 MiB | 187620 GiB | 187620 GiB |
|       from small pool |      0 KiB |     60 MiB |   2436 GiB |   2436 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   2004 MiB | 190056 GiB | 190056 GiB |
|       from large pool |  16640 KiB |   1971 MiB | 187620 GiB | 187620 GiB |
|       from small pool |      0 KiB |     60 MiB |   2436 GiB |   2436 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   1998 MiB | 189292 GiB | 189292 GiB |
|       from large pool |  16640 KiB |   1966 MiB | 186860 GiB | 186860 GiB |
|       from small pool |      0 KiB |     60 MiB |   2431 GiB |   2431 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    784 MiB |   2290 MiB |  12560 MiB |  11776 MiB |
|       from large pool |    738 MiB |   2220 MiB |  12360 MiB |  11622 MiB |
|       from small pool |     46 MiB |     70 MiB |    200 MiB |    154 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  30464 KiB | 418550 KiB | 150091 GiB | 150091 GiB |
|       from large pool |  30464 KiB | 409071 KiB | 147528 GiB | 147528 GiB |
|       from small pool |      0 KiB |  22273 KiB |   2563 GiB |   2563 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    1681    |   36272 K  |   36272 K  |
|       from large pool |       2    |     311    |   17408 K  |   17408 K  |
|       from small pool |       0    |    1419    |   18864 K  |   18864 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    1681    |   36272 K  |   36272 K  |
|       from large pool |       2    |     311    |   17408 K  |   17408 K  |
|       from small pool |       0    |    1419    |   18864 K  |   18864 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      56    |     128    |     601    |     545    |
|       from large pool |      33    |      93    |     501    |     468    |
|       from small pool |      23    |      35    |     100    |      77    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |     260    |   20267 K  |   20267 K  |
|       from large pool |       4    |      93    |   12793 K  |   12793 K  |
|       from small pool |       0    |     223    |    7473 K  |    7473 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   2004 MiB | 190056 GiB | 190056 GiB |
|       from large pool |  16640 KiB |   1971 MiB | 187620 GiB | 187620 GiB |
|       from small pool |      0 KiB |     60 MiB |   2436 GiB |   2436 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   2004 MiB | 190056 GiB | 190056 GiB |
|       from large pool |  16640 KiB |   1971 MiB | 187620 GiB | 187620 GiB |
|       from small pool |      0 KiB |     60 MiB |   2436 GiB |   2436 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   1998 MiB | 189292 GiB | 189292 GiB |
|       from large pool |  16640 KiB |   1966 MiB | 186860 GiB | 186860 GiB |
|       from small pool |      0 KiB |     60 MiB |   2431 GiB |   2431 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    784 MiB |   2290 MiB |  12560 MiB |  11776 MiB |
|       from large pool |    738 MiB |   2220 MiB |  12360 MiB |  11622 MiB |
|       from small pool |     46 MiB |     70 MiB |    200 MiB |    154 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  30464 KiB | 418550 KiB | 150091 GiB | 150091 GiB |
|       from large pool |  30464 KiB | 409071 KiB | 147528 GiB | 147528 GiB |
|       from small pool |      0 KiB |  22273 KiB |   2563 GiB |   2563 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    1681    |   36272 K  |   36272 K  |
|       from large pool |       2    |     311    |   17408 K  |   17408 K  |
|       from small pool |       0    |    1419    |   18864 K  |   18864 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    1681    |   36272 K  |   36272 K  |
|       from large pool |       2    |     311    |   17408 K  |   17408 K  |
|       from small pool |       0    |    1419    |   18864 K  |   18864 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      56    |     128    |     601    |     545    |
|       from large pool |      33    |      93    |     501    |     468    |
|       from small pool |      23    |      35    |     100    |      77    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |     260    |   20267 K  |   20267 K  |
|       from large pool |       4    |      93    |   12793 K  |   12793 K  |
|       from small pool |       0    |     223    |    7473 K  |    7473 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_14_27_12_seed_8_23096844

 Experiment start at: 2024-07-27 14:27:12.472443
before training, model accuracy: 0.4931192398071289
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9319079, 'precision': 0.9394382, 'recall': 0.9327048, 'specificity': 0.9327048, 'f1': 0.93169177, 'auroc': 0.99672604, 'binary_precision': 1.0, 'binary_recall': 0.8654096, 'binary_specificity': 1.0, 'binary_f1_score': 0.9278494}
confusion matrix:
      0     1
0  1502     0
1   207  1331
---- Validation: 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
scalar performance:
{'acc': 0.5769528, 'precision': 0.7169577, 'recall': 0.5636882, 'specificity': 0.5636882, 'f1': 0.47754794, 'auroc': 0.8486284, 'binary_precision': 0.88349515, 'binary_recall': 0.14536741, 'binary_specificity': 0.982009, 'binary_f1_score': 0.24965706}
confusion matrix:
     0   1
0  655  12
1  535  91
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7408257, 'precision': 0.7864472, 'recall': 0.74082565, 'specificity': 0.74082565, 'f1': 0.7300783, 'auroc': 0.8855736, 'binary_precision': 0.90076333, 'binary_recall': 0.5412844, 'binary_specificity': 0.940367, 'binary_f1_score': 0.67621773}
confusion matrix:
     0    1
0  205   13
1  100  118
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-27 14:28:48.703687,epoch time: 0:01:36.231244,used: 0:01:36.231244,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_14_27_12_seed_8_23096844
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9819079, 'precision': 0.9818939, 'recall': 0.98193705, 'specificity': 0.98193705, 'f1': 0.9819069, 'auroc': 0.99756384, 'binary_precision': 0.9849378, 'binary_recall': 0.9791667, 'binary_specificity': 0.9847075, 'binary_f1_score': 0.9820438}
confusion matrix:
      0     1
0  1481    23
1    32  1504
---- Validation: 
scalar performance:
{'acc': 0.80510443, 'precision': 0.8178323, 'recall': 0.80181515, 'specificity': 0.80181515, 'f1': 0.8017981, 'auroc': 0.9049964, 'binary_precision': 0.874, 'binary_recall': 0.69808304, 'binary_specificity': 0.9055472, 'binary_f1_score': 0.7761989}
confusion matrix:
     0    1
0  604   63
1  189  437
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8417431, 'precision': 0.8426155, 'recall': 0.8417431, 'specificity': 0.8417431, 'f1': 0.8416424, 'auroc': 0.9080254, 'binary_precision': 0.8599034, 'binary_recall': 0.8165138, 'binary_specificity': 0.8669725, 'binary_f1_score': 0.83764714}
confusion matrix:
     0    1
0  189   29
1   40  178
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-07-27 14:30:18.550293,epoch time: 0:01:29.846606,used: 0:03:06.077850,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_14_27_12_seed_8_23096844
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9792763, 'precision': 0.9792763, 'recall': 0.9793512, 'specificity': 0.9793512, 'f1': 0.97927547, 'auroc': 0.998842, 'binary_precision': 0.9855263, 'binary_recall': 0.97335935, 'binary_specificity': 0.9853431, 'binary_f1_score': 0.97940505}
confusion matrix:
      0     1
0  1479    22
1    41  1498
---- Validation: 
scalar performance:
{'acc': 0.8221191, 'precision': 0.8495967, 'recall': 0.81761956, 'specificity': 0.81761956, 'f1': 0.81696373, 'auroc': 0.9160899, 'binary_precision': 0.94, 'binary_recall': 0.67571884, 'binary_specificity': 0.9595202, 'binary_f1_score': 0.78624535}
confusion matrix:
     0    1
0  640   27
1  203  423
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8440367, 'precision': 0.8615657, 'recall': 0.8440367, 'specificity': 0.8440367, 'f1': 0.8421232, 'auroc': 0.9133701, 'binary_precision': 0.9411765, 'binary_recall': 0.73394495, 'binary_specificity': 0.95412844, 'binary_f1_score': 0.82474226}
confusion matrix:
     0    1
0  208   10
1   58  160
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-07-27 14:31:48.740713,epoch time: 0:01:30.190420,used: 0:04:36.268270,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_14_27_12_seed_8_23096844
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9457237, 'precision': 0.9496, 'recall': 0.9462651, 'specificity': 0.9462651, 'f1': 0.9456459, 'auroc': 0.99740356, 'binary_precision': 0.9942363, 'binary_recall': 0.89785296, 'binary_specificity': 0.9946773, 'binary_f1_score': 0.94358975}
confusion matrix:
      0     1
0  1495     8
1   157  1380
---- Validation: 
scalar performance:
{'acc': 0.5119876, 'precision': 0.25698757, 'recall': 0.49625188, 'specificity': 0.49625188, 'f1': 0.3386189, 'auroc': 0.8624186, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.99250376, 'binary_f1_score': 0.0}
confusion matrix:
     0  1
0  662  5
1  626  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.4977064, 'precision': 0.24942529, 'recall': 0.4977064, 'specificity': 0.4977064, 'f1': 0.3323124, 'auroc': 0.85661983, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9954128, 'binary_f1_score': 0.0}
confusion matrix:
     0  1
0  217  1
1  218  0
early stop counter: 1
val acc:0.5119876265525818, best validation acc: 0.8221191167831421, corresponding to test acc:                         0.8440366983413696 / 0.8440366983413696
after epoch: 4,now: 2024-07-27 14:33:17.888717,epoch time: 0:01:29.148004,used: 0:06:05.416274,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_14_27_12_seed_8_23096844
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9726974, 'precision': 0.97314775, 'recall': 0.97253275, 'specificity': 0.97253275, 'f1': 0.97267985, 'auroc': 0.9983178, 'binary_precision': 0.96134347, 'binary_recall': 0.985705, 'binary_specificity': 0.9593604, 'binary_f1_score': 0.97337186}
confusion matrix:
      0     1
0  1440    61
1    22  1517
---- Validation: 
scalar performance:
{'acc': 0.77030164, 'precision': 0.772015, 'recall': 0.7687694, 'specificity': 0.7687694, 'f1': 0.76908123, 'auroc': 0.8291956, 'binary_precision': 0.78708553, 'binary_recall': 0.7204473, 'binary_specificity': 0.81709146, 'binary_f1_score': 0.75229365}
confusion matrix:
     0    1
0  545  122
1  175  451
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.73623854, 'precision': 0.7660742, 'recall': 0.73623854, 'specificity': 0.73623854, 'f1': 0.72863126, 'auroc': 0.83648264, 'binary_precision': 0.67697597, 'binary_recall': 0.9036697, 'binary_specificity': 0.56880736, 'binary_f1_score': 0.77406687}
confusion matrix:
     0    1
0  124   94
1   21  197
early stop counter: 2
val acc:0.7703016400337219, best validation acc: 0.8221191167831421, corresponding to test acc:                         0.8440366983413696 / 0.8440366983413696
after epoch: 5,now: 2024-07-27 14:34:46.754752,epoch time: 0:01:28.866035,used: 0:07:34.282309,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_14_27_12_seed_8_23096844
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.95888156, 'precision': 0.96015096, 'recall': 0.95862424, 'specificity': 0.95862424, 'f1': 0.9588325, 'auroc': 0.9953687, 'binary_precision': 0.9384711, 'binary_recall': 0.98307294, 'binary_specificity': 0.93417555, 'binary_f1_score': 0.9602544}
confusion matrix:
      0     1
0  1405    99
1    26  1510
---- Validation: 
scalar performance:
{'acc': 0.7880897, 'precision': 0.8023776, 'recall': 0.78448874, 'specificity': 0.78448874, 'f1': 0.7839491, 'auroc': 0.8690742, 'binary_precision': 0.8606557, 'binary_recall': 0.6709265, 'binary_specificity': 0.89805096, 'binary_f1_score': 0.75403947}
confusion matrix:
     0    1
0  599   68
1  206  420
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.80504584, 'precision': 0.83900803, 'recall': 0.80504584, 'specificity': 0.80504584, 'f1': 0.8000378, 'auroc': 0.90421677, 'binary_precision': 0.94630873, 'binary_recall': 0.646789, 'binary_specificity': 0.96330273, 'binary_f1_score': 0.76839244}
confusion matrix:
     0    1
0  210    8
1   77  141
early stop counter: 3
val acc:0.7880896925926208, best validation acc: 0.8221191167831421, corresponding to test acc:                         0.8440366983413696 / 0.8440366983413696
after epoch: 6,now: 2024-07-27 14:36:15.069573,epoch time: 0:01:28.314821,used: 0:09:02.597130,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_14_27_12_seed_8_23096844
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9819079, 'precision': 0.98200655, 'recall': 0.9818469, 'specificity': 0.9818469, 'f1': 0.98190284, 'auroc': 0.99861, 'binary_precision': 0.97746295, 'binary_recall': 0.9869961, 'binary_specificity': 0.97669774, 'binary_f1_score': 0.9822064}
confusion matrix:
      0     1
0  1467    35
1    20  1518
---- Validation: 
scalar performance:
{'acc': 0.84841454, 'precision': 0.86348677, 'recall': 0.8451688, 'specificity': 0.8451688, 'f1': 0.84584296, 'auroc': 0.9355682, 'binary_precision': 0.93, 'binary_recall': 0.7428115, 'binary_specificity': 0.9475262, 'binary_f1_score': 0.8259325}
confusion matrix:
     0    1
0  632   35
1  161  465
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.79357797, 'precision': 0.84768736, 'recall': 0.793578, 'specificity': 0.793578, 'f1': 0.7852217, 'auroc': 0.92309153, 'binary_precision': 0.9848485, 'binary_recall': 0.5963303, 'binary_specificity': 0.9908257, 'binary_f1_score': 0.74285716}
confusion matrix:
     0    1
0  216    2
1   88  130
better model found
persisted
after epoch: 7,now: 2024-07-27 14:37:44.145441,epoch time: 0:01:29.075868,used: 0:10:31.672998,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_14_27_12_seed_8_23096844
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.98815787, 'precision': 0.98814476, 'recall': 0.98820055, 'specificity': 0.98820055, 'f1': 0.9881573, 'auroc': 0.99946284, 'binary_precision': 0.9921312, 'binary_recall': 0.9843852, 'binary_specificity': 0.99201596, 'binary_f1_score': 0.988243}
confusion matrix:
      0     1
0  1491    12
1    24  1513
---- Validation: 
scalar performance:
{'acc': 0.86465585, 'precision': 0.86546385, 'recall': 0.8638568, 'specificity': 0.8638568, 'f1': 0.86428046, 'auroc': 0.9259021, 'binary_precision': 0.8764608, 'binary_recall': 0.83865815, 'binary_specificity': 0.8890555, 'binary_f1_score': 0.85714287}
confusion matrix:
     0    1
0  593   74
1  101  525
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8142202, 'precision': 0.8142797, 'recall': 0.8142202, 'specificity': 0.8142202, 'f1': 0.81421137, 'auroc': 0.86880314, 'binary_precision': 0.81860465, 'binary_recall': 0.80733943, 'binary_specificity': 0.8211009, 'binary_f1_score': 0.812933}
confusion matrix:
     0    1
0  179   39
1   42  176
better model found
persisted
after epoch: 8,now: 2024-07-27 14:39:12.752336,epoch time: 0:01:28.606895,used: 0:12:00.279893,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_14_27_12_seed_8_23096844
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.98980266, 'precision': 0.9898503, 'recall': 0.98976827, 'specificity': 0.98976827, 'f1': 0.9898006, 'auroc': 0.9996784, 'binary_precision': 0.9870634, 'binary_recall': 0.9928432, 'binary_specificity': 0.98669326, 'binary_f1_score': 0.9899449}
confusion matrix:
      0     1
0  1483    20
1    11  1526
---- Validation: 
scalar performance:
{'acc': 0.8638824, 'precision': 0.86560047, 'recall': 0.8627635, 'specificity': 0.8627635, 'f1': 0.8633461, 'auroc': 0.933087, 'binary_precision': 0.88395905, 'binary_recall': 0.827476, 'binary_specificity': 0.89805096, 'binary_f1_score': 0.85478544}
confusion matrix:
     0    1
0  599   68
1  108  518
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8761468, 'precision': 0.8844301, 'recall': 0.8761468, 'specificity': 0.8761468, 'f1': 0.875476, 'auroc': 0.93704236, 'binary_precision': 0.9408602, 'binary_recall': 0.8027523, 'binary_specificity': 0.9495413, 'binary_f1_score': 0.86633664}
confusion matrix:
     0    1
0  207   11
1   43  175
new oracle model saved
early stop counter: 1
val acc:0.8638824224472046, best validation acc: 0.8646558523178101, corresponding to test acc:                         0.8142201900482178 / 0.8761467933654785
after epoch: 9,now: 2024-07-27 14:40:41.864513,epoch time: 0:01:29.112177,used: 0:13:29.392070,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_14_27_12_seed_8_23096844
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9773026, 'precision': 0.97790956, 'recall': 0.9775316, 'specificity': 0.9775316, 'f1': 0.9773005, 'auroc': 0.9990209, 'binary_precision': 0.99796474, 'binary_recall': 0.9570592, 'binary_specificity': 0.998004, 'binary_f1_score': 0.977084}
confusion matrix:
      0     1
0  1500     3
1    66  1471
---- Validation: 
scalar performance:
{'acc': 0.80355763, 'precision': 0.84903145, 'recall': 0.7977629, 'specificity': 0.7977629, 'f1': 0.7946705, 'auroc': 0.9373093, 'binary_precision': 0.96733665, 'binary_recall': 0.615016, 'binary_specificity': 0.98050976, 'binary_f1_score': 0.7519531}
confusion matrix:
     0    1
0  654   13
1  241  385
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.72477067, 'precision': 0.81791663, 'recall': 0.72477067, 'specificity': 0.72477067, 'f1': 0.70301753, 'auroc': 0.92551136, 'binary_precision': 0.99, 'binary_recall': 0.45412844, 'binary_specificity': 0.9954128, 'binary_f1_score': 0.6226415}
confusion matrix:
     0   1
0  217   1
1  119  99
early stop counter: 2
val acc:0.8035576343536377, best validation acc: 0.8646558523178101, corresponding to test acc:                         0.8142201900482178 / 0.8761467933654785
after epoch: 10,now: 2024-07-27 14:42:10.686625,epoch time: 0:01:28.822112,used: 0:14:58.214182,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_14_27_12_seed_8_23096844
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9875, 'precision': 0.9875258, 'recall': 0.98759675, 'specificity': 0.98759675, 'f1': 0.9874997, 'auroc': 0.9996917, 'binary_precision': 0.99537957, 'binary_recall': 0.979857, 'binary_specificity': 0.9953364, 'binary_f1_score': 0.98755723}
confusion matrix:
      0     1
0  1494     7
1    31  1508
---- Validation: 
scalar performance:
{'acc': 0.72003096, 'precision': 0.79294056, 'recall': 0.7118937, 'specificity': 0.7118937, 'f1': 0.6963623, 'auroc': 0.89115584, 'binary_precision': 0.9313725, 'binary_recall': 0.45527157, 'binary_specificity': 0.96851575, 'binary_f1_score': 0.611588}
confusion matrix:
     0    1
0  646   21
1  341  285
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.68119264, 'precision': 0.799461, 'recall': 0.68119264, 'specificity': 0.68119264, 'f1': 0.6462671, 'auroc': 0.9197248, 'binary_precision': 0.9876543, 'binary_recall': 0.36697248, 'binary_specificity': 0.9954128, 'binary_f1_score': 0.5351171}
confusion matrix:
     0   1
0  217   1
1  138  80
early stop counter: 3
val acc:0.7200309634208679, best validation acc: 0.8646558523178101, corresponding to test acc:                         0.8142201900482178 / 0.8761467933654785
after epoch: 11,now: 2024-07-27 14:43:39.552164,epoch time: 0:01:28.865539,used: 0:16:27.079721,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_14_27_12_seed_8_23096844
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.98421055, 'precision': 0.9843204, 'recall': 0.984146, 'specificity': 0.984146, 'f1': 0.98420596, 'auroc': 0.9993628, 'binary_precision': 0.97940797, 'binary_recall': 0.9895969, 'binary_specificity': 0.9786951, 'binary_f1_score': 0.9844761}
confusion matrix:
      0     1
0  1470    32
1    16  1522
---- Validation: 
scalar performance:
{'acc': 0.8546017, 'precision': 0.86085737, 'recall': 0.8524915, 'specificity': 0.8524915, 'f1': 0.85331714, 'auroc': 0.9194087, 'binary_precision': 0.9010989, 'binary_recall': 0.7859425, 'binary_specificity': 0.9190405, 'binary_f1_score': 0.83959043}
confusion matrix:
     0    1
0  613   54
1  134  492
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.82798165, 'precision': 0.8316736, 'recall': 0.82798165, 'specificity': 0.82798165, 'f1': 0.82750165, 'auroc': 0.88774097, 'binary_precision': 0.8666667, 'binary_recall': 0.77522933, 'binary_specificity': 0.88073397, 'binary_f1_score': 0.8184019}
confusion matrix:
     0    1
0  192   26
1   49  169
early stop counter: 4
val acc:0.8546016812324524, best validation acc: 0.8646558523178101, corresponding to test acc:                         0.8142201900482178 / 0.8761467933654785
after epoch: 12,now: 2024-07-27 14:45:08.273864,epoch time: 0:01:28.721700,used: 0:17:55.801421,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_14_27_12_seed_8_23096844
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.98914474, 'precision': 0.9891931, 'recall': 0.98923016, 'specificity': 0.98923016, 'f1': 0.9891447, 'auroc': 0.9995115, 'binary_precision': 0.9973527, 'binary_recall': 0.9811198, 'binary_specificity': 0.99734044, 'binary_f1_score': 0.9891697}
confusion matrix:
      0     1
0  1500     4
1    29  1507
---- Validation: 
scalar performance:
{'acc': 0.60479504, 'precision': 0.75982565, 'recall': 0.59214765, 'specificity': 0.59214765, 'f1': 0.5213016, 'auroc': 0.9056083, 'binary_precision': 0.9527559, 'binary_recall': 0.19329074, 'binary_specificity': 0.9910045, 'binary_f1_score': 0.32138115}
confusion matrix:
     0    1
0  661    6
1  505  121
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5825688, 'precision': 0.77250004, 'recall': 0.5825688, 'specificity': 0.5825688, 'f1': 0.49448308, 'auroc': 0.9064052, 'binary_precision': 1.0, 'binary_recall': 0.16513762, 'binary_specificity': 1.0, 'binary_f1_score': 0.28346455}
confusion matrix:
     0   1
0  218   0
1  182  36
early stop counter: 5
val acc:0.6047950387001038, best validation acc: 0.8646558523178101, corresponding to test acc:                         0.8142201900482178 / 0.8761467933654785
after epoch: 13,now: 2024-07-27 14:46:36.662725,epoch time: 0:01:28.388861,used: 0:19:24.190282,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_14_27_12_seed_8_23096844
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 13 with time: 0:19:24.190282 at 2024-07-27 14:46:36.662725
persisted model performance metric: 

scalar performance:
{'acc': 0.8142202, 'precision': 0.8142797, 'recall': 0.8142202, 'specificity': 0.8142202, 'f1': 0.81421137, 'auroc': 0.86880314, 'binary_precision': 0.81860465, 'binary_recall': 0.80733943, 'binary_specificity': 0.8211009, 'binary_f1_score': 0.812933}
confusion matrix:
     0    1
0  179   39
1   42  176
oracle model performance metric: 

scalar performance:
{'acc': 0.8761468, 'precision': 0.8844301, 'recall': 0.8761468, 'specificity': 0.8761468, 'f1': 0.875476, 'auroc': 0.93704236, 'binary_precision': 0.9408602, 'binary_recall': 0.8027523, 'binary_specificity': 0.9495413, 'binary_f1_score': 0.86633664}
confusion matrix:
     0    1
0  207   11
1   43  175
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_10seeds_nofreeze_2024-07-27_12-03-42/rule_results/0.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_10seeds_nofreeze_2024-07-27_12-03-42/confusion_matrix/0.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 455390 KiB |   2004 MiB | 218134 GiB | 218134 GiB |
|       from large pool | 414795 KiB |   1971 MiB | 215338 GiB | 215337 GiB |
|       from small pool |  40595 KiB |     60 MiB |   2796 GiB |   2796 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 455390 KiB |   2004 MiB | 218134 GiB | 218134 GiB |
|       from large pool | 414795 KiB |   1971 MiB | 215338 GiB | 215337 GiB |
|       from small pool |  40595 KiB |     60 MiB |   2796 GiB |   2796 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 447481 KiB |   1998 MiB | 217274 GiB | 217274 GiB |
|       from large pool | 407075 KiB |   1966 MiB | 214484 GiB | 214483 GiB |
|       from small pool |  40406 KiB |     60 MiB |   2790 GiB |   2790 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2270 MiB |   2290 MiB |  14046 MiB |  11776 MiB |
|       from large pool |   2206 MiB |   2220 MiB |  13828 MiB |  11622 MiB |
|       from small pool |     64 MiB |     70 MiB |    218 MiB |    154 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 369953 KiB | 418550 KiB | 171593 GiB | 171592 GiB |
|       from large pool | 361397 KiB | 409071 KiB | 168651 GiB | 168651 GiB |
|       from small pool |   8556 KiB |  22273 KiB |   2941 GiB |   2941 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    1304    |    1681    |   41634 K  |   41633 K  |
|       from large pool |     187    |     311    |   19982 K  |   19981 K  |
|       from small pool |    1117    |    1419    |   21652 K  |   21651 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    1304    |    1681    |   41634 K  |   41633 K  |
|       from large pool |     187    |     311    |   19982 K  |   19981 K  |
|       from small pool |    1117    |    1419    |   21652 K  |   21651 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     124    |     128    |     669    |     545    |
|       from large pool |      92    |      93    |     560    |     468    |
|       from small pool |      32    |      35    |     109    |      77    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      74    |     260    |   23105 K  |   23105 K  |
|       from large pool |      34    |      93    |   14542 K  |   14542 K  |
|       from small pool |      40    |     223    |    8562 K  |    8562 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   2004 MiB | 218134 GiB | 218134 GiB |
|       from large pool |  16640 KiB |   1971 MiB | 215338 GiB | 215338 GiB |
|       from small pool |      0 KiB |     60 MiB |   2796 GiB |   2796 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   2004 MiB | 218134 GiB | 218134 GiB |
|       from large pool |  16640 KiB |   1971 MiB | 215338 GiB | 215338 GiB |
|       from small pool |      0 KiB |     60 MiB |   2796 GiB |   2796 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   1998 MiB | 217274 GiB | 217274 GiB |
|       from large pool |  16640 KiB |   1966 MiB | 214484 GiB | 214484 GiB |
|       from small pool |      0 KiB |     60 MiB |   2790 GiB |   2790 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    806 MiB |   2290 MiB |  14046 MiB |  13240 MiB |
|       from large pool |    758 MiB |   2220 MiB |  13828 MiB |  13070 MiB |
|       from small pool |     48 MiB |     70 MiB |    218 MiB |    170 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  30464 KiB | 418550 KiB | 171593 GiB | 171593 GiB |
|       from large pool |  30464 KiB | 409071 KiB | 168651 GiB | 168651 GiB |
|       from small pool |      0 KiB |  22273 KiB |   2941 GiB |   2941 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    1681    |   41634 K  |   41634 K  |
|       from large pool |       2    |     311    |   19982 K  |   19982 K  |
|       from small pool |       0    |    1419    |   21652 K  |   21652 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    1681    |   41634 K  |   41634 K  |
|       from large pool |       2    |     311    |   19982 K  |   19982 K  |
|       from small pool |       0    |    1419    |   21652 K  |   21652 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      58    |     128    |     669    |     611    |
|       from large pool |      34    |      93    |     560    |     526    |
|       from small pool |      24    |      35    |     109    |      85    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |     260    |   23105 K  |   23105 K  |
|       from large pool |       4    |      93    |   14542 K  |   14542 K  |
|       from small pool |       0    |     223    |    8562 K  |    8562 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   2004 MiB | 218134 GiB | 218134 GiB |
|       from large pool |  16640 KiB |   1971 MiB | 215338 GiB | 215338 GiB |
|       from small pool |      0 KiB |     60 MiB |   2796 GiB |   2796 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   2004 MiB | 218134 GiB | 218134 GiB |
|       from large pool |  16640 KiB |   1971 MiB | 215338 GiB | 215338 GiB |
|       from small pool |      0 KiB |     60 MiB |   2796 GiB |   2796 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   1998 MiB | 217274 GiB | 217274 GiB |
|       from large pool |  16640 KiB |   1966 MiB | 214484 GiB | 214484 GiB |
|       from small pool |      0 KiB |     60 MiB |   2790 GiB |   2790 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    806 MiB |   2290 MiB |  14046 MiB |  13240 MiB |
|       from large pool |    758 MiB |   2220 MiB |  13828 MiB |  13070 MiB |
|       from small pool |     48 MiB |     70 MiB |    218 MiB |    170 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  30464 KiB | 418550 KiB | 171593 GiB | 171593 GiB |
|       from large pool |  30464 KiB | 409071 KiB | 168651 GiB | 168651 GiB |
|       from small pool |      0 KiB |  22273 KiB |   2941 GiB |   2941 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    1681    |   41634 K  |   41634 K  |
|       from large pool |       2    |     311    |   19982 K  |   19982 K  |
|       from small pool |       0    |    1419    |   21652 K  |   21652 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    1681    |   41634 K  |   41634 K  |
|       from large pool |       2    |     311    |   19982 K  |   19982 K  |
|       from small pool |       0    |    1419    |   21652 K  |   21652 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      58    |     128    |     669    |     611    |
|       from large pool |      34    |      93    |     560    |     526    |
|       from small pool |      24    |      35    |     109    |      85    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |     260    |   23105 K  |   23105 K  |
|       from large pool |       4    |      93    |   14542 K  |   14542 K  |
|       from small pool |       0    |     223    |    8562 K  |    8562 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_14_47_10_seed_9_23096844

 Experiment start at: 2024-07-27 14:47:10.886621
before training, model accuracy: 0.49782606959342957
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9725131, 'precision': 0.9731603, 'recall': 0.97265774, 'specificity': 0.97265774, 'f1': 0.9725084, 'auroc': 0.9968873, 'binary_precision': 0.99255246, 'binary_recall': 0.9525666, 'binary_specificity': 0.99274886, 'binary_f1_score': 0.97214854}
confusion matrix:
      0     1
0  1506    11
1    73  1466
---- Validation: 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
scalar performance:
{'acc': 0.77220076, 'precision': 0.8209661, 'recall': 0.7702319, 'specificity': 0.7702319, 'f1': 0.76232314, 'auroc': 0.910721, 'binary_precision': 0.94358975, 'binary_recall': 0.57410294, 'binary_specificity': 0.96636087, 'binary_f1_score': 0.71387}
confusion matrix:
     0    1
0  632   22
1  273  368
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7826087, 'precision': 0.83370537, 'recall': 0.7826087, 'specificity': 0.7826087, 'f1': 0.77395576, 'auroc': 0.90962195, 'binary_precision': 0.96428573, 'binary_recall': 0.5869565, 'binary_specificity': 0.9782609, 'binary_f1_score': 0.7297297}
confusion matrix:
     0    1
0  225    5
1   95  135
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-27 14:48:46.275904,epoch time: 0:01:35.389283,used: 0:01:35.389283,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_14_47_10_seed_9_23096844
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.97971207, 'precision': 0.979831, 'recall': 0.9797816, 'specificity': 0.9797816, 'f1': 0.9797119, 'auroc': 0.9977693, 'binary_precision': 0.9893969, 'binary_recall': 0.9701105, 'binary_specificity': 0.98945284, 'binary_f1_score': 0.9796588}
confusion matrix:
      0     1
0  1501    16
1    46  1493
---- Validation: 
scalar performance:
{'acc': 0.7312741, 'precision': 0.77595526, 'recall': 0.72923136, 'specificity': 0.72923136, 'f1': 0.7187762, 'auroc': 0.8653164, 'binary_precision': 0.88451445, 'binary_recall': 0.52574104, 'binary_specificity': 0.93272173, 'binary_f1_score': 0.65949124}
confusion matrix:
     0    1
0  610   44
1  304  337
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7978261, 'precision': 0.821984, 'recall': 0.79782605, 'specificity': 0.79782605, 'f1': 0.7939614, 'auroc': 0.90555763, 'binary_precision': 0.9101796, 'binary_recall': 0.66086954, 'binary_specificity': 0.9347826, 'binary_f1_score': 0.765743}
confusion matrix:
     0    1
0  215   15
1   78  152
new oracle model saved
early stop counter: 1
val acc:0.7312741279602051, best validation acc: 0.7722007632255554, corresponding to test acc:                         0.782608687877655 / 0.7978261113166809
after epoch: 2,now: 2024-07-27 14:50:15.697034,epoch time: 0:01:29.421130,used: 0:03:04.810413,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_14_47_10_seed_9_23096844
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9532068, 'precision': 0.9556277, 'recall': 0.95297563, 'specificity': 0.95297563, 'f1': 0.95312583, 'auroc': 0.9967401, 'binary_precision': 0.9240122, 'binary_recall': 0.9882965, 'binary_specificity': 0.9176548, 'binary_f1_score': 0.95507383}
confusion matrix:
      0     1
0  1393   125
1    18  1520
---- Validation: 
scalar performance:
{'acc': 0.7945946, 'precision': 0.8063978, 'recall': 0.7935971, 'specificity': 0.7935971, 'f1': 0.79220057, 'auroc': 0.882938, 'binary_precision': 0.8640777, 'binary_recall': 0.69422776, 'binary_specificity': 0.8929664, 'binary_f1_score': 0.76989615}
confusion matrix:
     0    1
0  584   70
1  196  445
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.78695655, 'precision': 0.82874215, 'recall': 0.78695655, 'specificity': 0.78695655, 'f1': 0.77996445, 'auroc': 0.90379965, 'binary_precision': 0.9459459, 'binary_recall': 0.6086956, 'binary_specificity': 0.9652174, 'binary_f1_score': 0.7407408}
confusion matrix:
     0    1
0  222    8
1   90  140
better model found
persisted
after epoch: 3,now: 2024-07-27 14:51:45.520902,epoch time: 0:01:29.823868,used: 0:04:34.634281,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_14_47_10_seed_9_23096844
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.94698954, 'precision': 0.95175695, 'recall': 0.9473684, 'specificity': 0.9473684, 'f1': 0.9468781, 'auroc': 0.9990298, 'binary_precision': 1.0, 'binary_recall': 0.8947368, 'binary_specificity': 1.0, 'binary_f1_score': 0.9444445}
confusion matrix:
      0     1
0  1517     0
1   162  1377
---- Validation: 
scalar performance:
{'acc': 0.55135137, 'precision': 0.7647773, 'recall': 0.54680187, 'specificity': 0.54680187, 'f1': 0.43180698, 'auroc': 0.9107019, 'binary_precision': 1.0, 'binary_recall': 0.093603745, 'binary_specificity': 1.0, 'binary_f1_score': 0.17118403}
confusion matrix:
     0   1
0  654   0
1  581  60
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.53695655, 'precision': 0.75959367, 'recall': 0.53695655, 'specificity': 0.53695655, 'f1': 0.41057923, 'auroc': 0.9119849, 'binary_precision': 1.0, 'binary_recall': 0.073913045, 'binary_specificity': 1.0, 'binary_f1_score': 0.13765182}
confusion matrix:
     0   1
0  230   0
1  213  17
early stop counter: 1
val acc:0.5513513684272766, best validation acc: 0.7945945858955383, corresponding to test acc:                         0.7869565486907959 / 0.7978261113166809
after epoch: 4,now: 2024-07-27 14:53:15.197949,epoch time: 0:01:29.677047,used: 0:06:04.311328,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_14_47_10_seed_9_23096844
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.98003924, 'precision': 0.98003435, 'recall': 0.98004484, 'specificity': 0.98004484, 'f1': 0.98003864, 'auroc': 0.9978528, 'binary_precision': 0.9811075, 'binary_recall': 0.97919375, 'binary_specificity': 0.98089594, 'binary_f1_score': 0.9801497}
confusion matrix:
      0     1
0  1489    29
1    32  1506
---- Validation: 
scalar performance:
{'acc': 0.65559846, 'precision': 0.7709299, 'recall': 0.65229213, 'specificity': 0.65229213, 'f1': 0.61179596, 'auroc': 0.9105344, 'binary_precision': 0.94520545, 'binary_recall': 0.32293293, 'binary_specificity': 0.98165137, 'binary_f1_score': 0.48139536}
confusion matrix:
     0    1
0  642   12
1  434  207
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.58913046, 'precision': 0.70525885, 'recall': 0.58913046, 'specificity': 0.58913046, 'f1': 0.52144265, 'auroc': 0.8682231, 'binary_precision': 0.8596491, 'binary_recall': 0.21304348, 'binary_specificity': 0.9652174, 'binary_f1_score': 0.34146342}
confusion matrix:
     0   1
0  222   8
1  181  49
early stop counter: 2
val acc:0.6555984616279602, best validation acc: 0.7945945858955383, corresponding to test acc:                         0.7869565486907959 / 0.7978261113166809
after epoch: 5,now: 2024-07-27 14:54:44.407921,epoch time: 0:01:29.209972,used: 0:07:33.521300,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_14_47_10_seed_9_23096844
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.98036647, 'precision': 0.98053646, 'recall': 0.9804385, 'specificity': 0.9804385, 'f1': 0.9803661, 'auroc': 0.9989253, 'binary_precision': 0.9913564, 'binary_recall': 0.9694408, 'binary_specificity': 0.9914361, 'binary_f1_score': 0.98027617}
confusion matrix:
      0     1
0  1505    13
1    47  1491
---- Validation: 
scalar performance:
{'acc': 0.8069498, 'precision': 0.8370913, 'recall': 0.80544186, 'specificity': 0.80544186, 'f1': 0.80198777, 'auroc': 0.910263, 'binary_precision': 0.93541205, 'binary_recall': 0.65522623, 'binary_specificity': 0.9556575, 'binary_f1_score': 0.7706422}
confusion matrix:
     0    1
0  625   29
1  221  420
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8108696, 'precision': 0.8524507, 'recall': 0.8108696, 'specificity': 0.8108696, 'f1': 0.8051218, 'auroc': 0.89132327, 'binary_precision': 0.9735099, 'binary_recall': 0.6391304, 'binary_specificity': 0.9826087, 'binary_f1_score': 0.7716535}
confusion matrix:
     0    1
0  226    4
1   83  147
new oracle model saved
better model found
persisted
after epoch: 6,now: 2024-07-27 14:56:14.015612,epoch time: 0:01:29.607691,used: 0:09:03.128991,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_14_47_10_seed_9_23096844
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.98625654, 'precision': 0.9863913, 'recall': 0.9863379, 'specificity': 0.9863379, 'f1': 0.9862565, 'auroc': 0.9996166, 'binary_precision': 0.9966844, 'binary_recall': 0.975974, 'binary_specificity': 0.99670184, 'binary_f1_score': 0.9862205}
confusion matrix:
      0     1
0  1511     5
1    37  1503
---- Validation: 
scalar performance:
{'acc': 0.7544401, 'precision': 0.81574273, 'recall': 0.75221366, 'specificity': 0.75221366, 'f1': 0.740807, 'auroc': 0.9197713, 'binary_precision': 0.95238096, 'binary_recall': 0.5304212, 'binary_specificity': 0.9740061, 'binary_f1_score': 0.68136275}
confusion matrix:
     0    1
0  637   17
1  301  340
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7804348, 'precision': 0.847432, 'recall': 0.7804348, 'specificity': 0.7804348, 'f1': 0.7693137, 'auroc': 0.9107373, 'binary_precision': 1.0, 'binary_recall': 0.5608696, 'binary_specificity': 1.0, 'binary_f1_score': 0.718663}
confusion matrix:
     0    1
0  230    0
1  101  129
early stop counter: 1
val acc:0.7544401288032532, best validation acc: 0.80694979429245, corresponding to test acc:                         0.810869574546814 / 0.810869574546814
after epoch: 7,now: 2024-07-27 14:57:43.896227,epoch time: 0:01:29.880615,used: 0:10:33.009606,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_14_47_10_seed_9_23096844
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9918194, 'precision': 0.9918133, 'recall': 0.9918355, 'specificity': 0.9918355, 'f1': 0.9918192, 'auroc': 0.99951386, 'binary_precision': 0.9941253, 'binary_recall': 0.98960364, 'binary_specificity': 0.99406725, 'binary_f1_score': 0.9918594}
confusion matrix:
      0     1
0  1508     9
1    16  1523
---- Validation: 
scalar performance:
{'acc': 0.83011585, 'precision': 0.8482512, 'recall': 0.82896686, 'specificity': 0.82896686, 'f1': 0.82751566, 'auroc': 0.92492855, 'binary_precision': 0.9252525, 'binary_recall': 0.7145086, 'binary_specificity': 0.94342506, 'binary_f1_score': 0.806338}
confusion matrix:
     0    1
0  617   37
1  183  458
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8565217, 'precision': 0.87732077, 'recall': 0.8565217, 'specificity': 0.8565217, 'f1': 0.85451686, 'auroc': 0.92107755, 'binary_precision': 0.96590906, 'binary_recall': 0.73913044, 'binary_specificity': 0.973913, 'binary_f1_score': 0.83743846}
confusion matrix:
     0    1
0  224    6
1   60  170
new oracle model saved
better model found
persisted
after epoch: 8,now: 2024-07-27 14:59:13.812718,epoch time: 0:01:29.916491,used: 0:12:02.926097,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_14_47_10_seed_9_23096844
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9895288, 'precision': 0.989601, 'recall': 0.9894953, 'specificity': 0.9894953, 'f1': 0.98952734, 'auroc': 0.9996067, 'binary_precision': 0.98519, 'binary_recall': 0.99415207, 'binary_specificity': 0.9848385, 'binary_f1_score': 0.9896508}
confusion matrix:
      0     1
0  1494    23
1     9  1530
---- Validation: 
scalar performance:
{'acc': 0.8208494, 'precision': 0.82337785, 'recall': 0.8203972, 'specificity': 0.8203972, 'f1': 0.8203393, 'auroc': 0.9036721, 'binary_precision': 0.84957266, 'binary_recall': 0.775351, 'binary_specificity': 0.8654434, 'binary_f1_score': 0.81076664}
confusion matrix:
     0    1
0  566   88
1  144  497
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8695652, 'precision': 0.874349, 'recall': 0.86956525, 'specificity': 0.86956525, 'f1': 0.8691472, 'auroc': 0.9234594, 'binary_precision': 0.9166667, 'binary_recall': 0.8130435, 'binary_specificity': 0.92608696, 'binary_f1_score': 0.8617512}
confusion matrix:
     0    1
0  213   17
1   43  187
new oracle model saved
early stop counter: 1
val acc:0.8208494186401367, best validation acc: 0.8301158547401428, corresponding to test acc:                         0.856521725654602 / 0.8695651888847351
after epoch: 9,now: 2024-07-27 15:00:43.721868,epoch time: 0:01:29.909150,used: 0:13:32.835247,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_14_47_10_seed_9_23096844
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.986911, 'precision': 0.9869878, 'recall': 0.986977, 'specificity': 0.986977, 'f1': 0.986911, 'auroc': 0.9990517, 'binary_precision': 0.99537647, 'binary_recall': 0.9785714, 'binary_specificity': 0.9953826, 'binary_f1_score': 0.9869024}
confusion matrix:
      0     1
0  1509     7
1    33  1507
---- Validation: 
scalar performance:
{'acc': 0.7814672, 'precision': 0.8198731, 'recall': 0.7797164, 'specificity': 0.7797164, 'f1': 0.7739602, 'auroc': 0.9072872, 'binary_precision': 0.9282297, 'binary_recall': 0.60530424, 'binary_specificity': 0.95412844, 'binary_f1_score': 0.7327668}
confusion matrix:
     0    1
0  624   30
1  253  388
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.81956524, 'precision': 0.8623095, 'recall': 0.8195652, 'specificity': 0.8195652, 'f1': 0.81408167, 'auroc': 0.9233459, 'binary_precision': 0.98675495, 'binary_recall': 0.6478261, 'binary_specificity': 0.99130434, 'binary_f1_score': 0.7821522}
confusion matrix:
     0    1
0  228    2
1   81  149
early stop counter: 2
val acc:0.7814671993255615, best validation acc: 0.8301158547401428, corresponding to test acc:                         0.856521725654602 / 0.8695651888847351
after epoch: 10,now: 2024-07-27 15:02:13.650131,epoch time: 0:01:29.928263,used: 0:15:02.763510,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_14_47_10_seed_9_23096844
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.97120416, 'precision': 0.9725686, 'recall': 0.9714286, 'specificity': 0.9714286, 'f1': 0.9711915, 'auroc': 0.9994535, 'binary_precision': 1.0, 'binary_recall': 0.94285715, 'binary_specificity': 1.0, 'binary_f1_score': 0.97058827}
confusion matrix:
      0     1
0  1516     0
1    88  1452
---- Validation: 
scalar performance:
{'acc': 0.5135135, 'precision': 0.7546729, 'recall': 0.5085803, 'specificity': 0.5085803, 'f1': 0.35433245, 'auroc': 0.8864023, 'binary_precision': 1.0, 'binary_recall': 0.017160686, 'binary_specificity': 1.0, 'binary_f1_score': 0.03374233}
confusion matrix:
     0   1
0  654   0
1  630  11
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5021739, 'precision': 0.75054467, 'recall': 0.5021739, 'specificity': 0.5021739, 'f1': 0.33814612, 'auroc': 0.87973535, 'binary_precision': 1.0, 'binary_recall': 0.004347826, 'binary_specificity': 1.0, 'binary_f1_score': 0.008658009}
confusion matrix:
     0  1
0  230  0
1  229  1
early stop counter: 3
val acc:0.5135135054588318, best validation acc: 0.8301158547401428, corresponding to test acc:                         0.856521725654602 / 0.8695651888847351
after epoch: 11,now: 2024-07-27 15:03:43.625857,epoch time: 0:01:29.975726,used: 0:16:32.739236,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_14_47_10_seed_9_23096844
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9859293, 'precision': 0.9860203, 'recall': 0.9859922, 'specificity': 0.9859922, 'f1': 0.98592925, 'auroc': 0.999653, 'binary_precision': 0.994709, 'binary_recall': 0.97725797, 'binary_specificity': 0.9947264, 'binary_f1_score': 0.9859063}
confusion matrix:
      0     1
0  1509     8
1    35  1504
---- Validation: 
scalar performance:
{'acc': 0.6548263, 'precision': 0.7648372, 'recall': 0.65155864, 'specificity': 0.65155864, 'f1': 0.6120533, 'auroc': 0.89876056, 'binary_precision': 0.93303573, 'binary_recall': 0.32605305, 'binary_specificity': 0.9770642, 'binary_f1_score': 0.48323703}
confusion matrix:
     0    1
0  639   15
1  432  209
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.71304345, 'precision': 0.80863184, 'recall': 0.71304345, 'specificity': 0.71304345, 'f1': 0.6889599, 'auroc': 0.9225898, 'binary_precision': 0.98039216, 'binary_recall': 0.4347826, 'binary_specificity': 0.99130434, 'binary_f1_score': 0.6024096}
confusion matrix:
     0    1
0  228    2
1  130  100
early stop counter: 4
val acc:0.654826283454895, best validation acc: 0.8301158547401428, corresponding to test acc:                         0.856521725654602 / 0.8695651888847351
after epoch: 12,now: 2024-07-27 15:05:13.610868,epoch time: 0:01:29.985011,used: 0:18:02.724247,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_14_47_10_seed_9_23096844
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9859293, 'precision': 0.9862268, 'recall': 0.9860208, 'specificity': 0.9860208, 'f1': 0.98592854, 'auroc': 0.99978065, 'binary_precision': 1.0, 'binary_recall': 0.9720416, 'binary_specificity': 1.0, 'binary_f1_score': 0.9858226}
confusion matrix:
      0     1
0  1518     0
1    43  1495
---- Validation: 
scalar performance:
{'acc': 0.6177606, 'precision': 0.7577069, 'recall': 0.6140241, 'specificity': 0.6140241, 'f1': 0.5538911, 'auroc': 0.8977515, 'binary_precision': 0.94512194, 'binary_recall': 0.24180967, 'binary_specificity': 0.98623854, 'binary_f1_score': 0.38509315}
confusion matrix:
     0    1
0  645    9
1  486  155
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6347826, 'precision': 0.7345395, 'recall': 0.6347826, 'specificity': 0.6347826, 'f1': 0.5913273, 'auroc': 0.8538563, 'binary_precision': 0.8875, 'binary_recall': 0.30869564, 'binary_specificity': 0.96086955, 'binary_f1_score': 0.45806453}
confusion matrix:
     0   1
0  221   9
1  159  71
early stop counter: 5
val acc:0.6177605986595154, best validation acc: 0.8301158547401428, corresponding to test acc:                         0.856521725654602 / 0.8695651888847351
after epoch: 13,now: 2024-07-27 15:06:43.602632,epoch time: 0:01:29.991764,used: 0:19:32.716011,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_14_47_10_seed_9_23096844
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 13 with time: 0:19:32.716011 at 2024-07-27 15:06:43.602632
persisted model performance metric: 

scalar performance:
{'acc': 0.8565217, 'precision': 0.87732077, 'recall': 0.8565217, 'specificity': 0.8565217, 'f1': 0.85451686, 'auroc': 0.92107755, 'binary_precision': 0.96590906, 'binary_recall': 0.73913044, 'binary_specificity': 0.973913, 'binary_f1_score': 0.83743846}
confusion matrix:
     0    1
0  224    6
1   60  170
oracle model performance metric: 

scalar performance:
{'acc': 0.8695652, 'precision': 0.874349, 'recall': 0.86956525, 'specificity': 0.86956525, 'f1': 0.8691472, 'auroc': 0.9234594, 'binary_precision': 0.9166667, 'binary_recall': 0.8130435, 'binary_specificity': 0.92608696, 'binary_f1_score': 0.8617512}
confusion matrix:
     0    1
0  213   17
1   43  187
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_10seeds_nofreeze_2024-07-27_12-03-42/rule_results/0.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_10seeds_nofreeze_2024-07-27_12-03-42/confusion_matrix/0.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 454968 KiB |   2004 MiB | 246432 GiB | 246431 GiB |
|       from large pool | 414370 KiB |   1971 MiB | 243274 GiB | 243273 GiB |
|       from small pool |  40598 KiB |     60 MiB |   3158 GiB |   3157 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 454968 KiB |   2004 MiB | 246432 GiB | 246431 GiB |
|       from large pool | 414370 KiB |   1971 MiB | 243274 GiB | 243273 GiB |
|       from small pool |  40598 KiB |     60 MiB |   3158 GiB |   3157 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 447482 KiB |   1998 MiB | 245447 GiB | 245446 GiB |
|       from large pool | 407075 KiB |   1966 MiB | 242295 GiB | 242295 GiB |
|       from small pool |  40407 KiB |     60 MiB |   3151 GiB |   3151 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2284 MiB |   2290 MiB |  15524 MiB |  13240 MiB |
|       from large pool |   2220 MiB |   2220 MiB |  15290 MiB |  13070 MiB |
|       from small pool |     64 MiB |     70 MiB |    234 MiB |    170 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 347847 KiB | 418550 KiB | 194318 GiB | 194318 GiB |
|       from large pool | 341342 KiB | 409071 KiB | 190996 GiB | 190996 GiB |
|       from small pool |   6505 KiB |  22273 KiB |   3322 GiB |   3322 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    1310    |    1681    |   47029 K  |   47028 K  |
|       from large pool |     187    |     311    |   22571 K  |   22571 K  |
|       from small pool |    1123    |    1419    |   24458 K  |   24457 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    1310    |    1681    |   47029 K  |   47028 K  |
|       from large pool |     187    |     311    |   22571 K  |   22571 K  |
|       from small pool |    1123    |    1419    |   24458 K  |   24457 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     125    |     128    |     736    |     611    |
|       from large pool |      93    |      93    |     619    |     526    |
|       from small pool |      32    |      35    |     117    |      85    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      72    |     260    |   26157 K  |   26156 K  |
|       from large pool |      35    |      93    |   16502 K  |   16502 K  |
|       from small pool |      37    |     223    |    9654 K  |    9654 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   2004 MiB | 246432 GiB | 246432 GiB |
|       from large pool |  16640 KiB |   1971 MiB | 243274 GiB | 243274 GiB |
|       from small pool |      0 KiB |     60 MiB |   3158 GiB |   3158 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   2004 MiB | 246432 GiB | 246432 GiB |
|       from large pool |  16640 KiB |   1971 MiB | 243274 GiB | 243274 GiB |
|       from small pool |      0 KiB |     60 MiB |   3158 GiB |   3158 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   1998 MiB | 245447 GiB | 245447 GiB |
|       from large pool |  16640 KiB |   1966 MiB | 242295 GiB | 242295 GiB |
|       from small pool |      0 KiB |     60 MiB |   3151 GiB |   3151 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    784 MiB |   2290 MiB |  15524 MiB |  14740 MiB |
|       from large pool |    738 MiB |   2220 MiB |  15290 MiB |  14552 MiB |
|       from small pool |     46 MiB |     70 MiB |    234 MiB |    188 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  30464 KiB | 418550 KiB | 194319 GiB | 194319 GiB |
|       from large pool |  30464 KiB | 409071 KiB | 190996 GiB | 190996 GiB |
|       from small pool |      0 KiB |  22273 KiB |   3322 GiB |   3322 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    1681    |   47029 K  |   47029 K  |
|       from large pool |       2    |     311    |   22571 K  |   22571 K  |
|       from small pool |       0    |    1419    |   24458 K  |   24458 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    1681    |   47029 K  |   47029 K  |
|       from large pool |       2    |     311    |   22571 K  |   22571 K  |
|       from small pool |       0    |    1419    |   24458 K  |   24458 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      56    |     128    |     736    |     680    |
|       from large pool |      33    |      93    |     619    |     586    |
|       from small pool |      23    |      35    |     117    |      94    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |     260    |   26157 K  |   26157 K  |
|       from large pool |       4    |      93    |   16502 K  |   16502 K  |
|       from small pool |       0    |     223    |    9654 K  |    9654 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Sat Jul 27 15:06:50 2024]
Finished job 0.
1 of 1 steps (100%) done
