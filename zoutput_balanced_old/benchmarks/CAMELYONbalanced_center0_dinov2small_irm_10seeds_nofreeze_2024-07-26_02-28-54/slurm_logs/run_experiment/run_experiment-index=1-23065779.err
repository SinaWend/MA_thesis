Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Fri Jul 26 04:56:00 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_irm_10seeds_nofreeze_2024-07-26_02-28-54/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_irm_10seeds_nofreeze_2024-07-26_02-28-54/rule_results/0.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=0
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/swiglu_ffn.py:51: UserWarning: xFormers is not available (SwiGLU)
  warnings.warn("xFormers is not available (SwiGLU)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/attention.py:33: UserWarning: xFormers is not available (Attention)
  warnings.warn("xFormers is not available (Attention)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/block.py:40: UserWarning: xFormers is not available (Block)
  warnings.warn("xFormers is not available (Block)")
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'888c1ef2'
model name: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_04_56_41_seed_0_23065779

 Experiment start at: 2024-07-26 04:56:41.624842
before training, model accuracy: 0.569767415523529
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.944987, 'precision': 0.948727, 'recall': 0.94571084, 'specificity': 0.94571084, 'f1': 0.9449226, 'auroc': 0.98826635, 'binary_precision': 0.99360794, 'binary_recall': 0.8973701, 'binary_specificity': 0.9940516, 'binary_f1_score': 0.9430401}
confusion matrix:
      0     1
0  1504     9
1   160  1399
---- Validation: 
scalar performance:
{'acc': 0.79347825, 'precision': 0.8207724, 'recall': 0.7914194, 'specificity': 0.7914194, 'f1': 0.78816414, 'auroc': 0.88814676, 'binary_precision': 0.91091317, 'binary_recall': 0.64409447, 'binary_specificity': 0.93874425, 'binary_f1_score': 0.7546125}
confusion matrix:
     0    1
0  613   40
1  226  409
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.83023256, 'precision': 0.84146833, 'recall': 0.8302325, 'specificity': 0.8302325, 'f1': 0.8288244, 'auroc': 0.897696, 'binary_precision': 0.90340906, 'binary_recall': 0.73953485, 'binary_specificity': 0.9209302, 'binary_f1_score': 0.81329924}
confusion matrix:
     0    1
0  198   17
1   56  159
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-26 04:58:14.643897,epoch time: 0:01:33.019055,used: 0:01:33.019055,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_04_56_41_seed_0_23065779
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.97558594, 'precision': 0.97560525, 'recall': 0.97567487, 'specificity': 0.97567487, 'f1': 0.97558534, 'auroc': 0.9956408, 'binary_precision': 0.9830287, 'binary_recall': 0.96848875, 'binary_specificity': 0.9828609, 'binary_f1_score': 0.97570455}
confusion matrix:
      0     1
0  1491    26
1    49  1506
---- Validation: 
scalar performance:
{'acc': 0.81444097, 'precision': 0.8170725, 'recall': 0.81506675, 'specificity': 0.81506675, 'f1': 0.81423396, 'auroc': 0.8798399, 'binary_precision': 0.7844828, 'binary_recall': 0.85984254, 'binary_specificity': 0.770291, 'binary_f1_score': 0.82043576}
confusion matrix:
     0    1
0  503  150
1   89  546
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.83023256, 'precision': 0.83041126, 'recall': 0.83023256, 'specificity': 0.83023256, 'f1': 0.8302096, 'auroc': 0.9068902, 'binary_precision': 0.82272726, 'binary_recall': 0.8418605, 'binary_specificity': 0.81860465, 'binary_f1_score': 0.83218396}
confusion matrix:
     0    1
0  176   39
1   34  181
better model found
persisted
after epoch: 2,now: 2024-07-26 04:59:43.678087,epoch time: 0:01:29.034190,used: 0:03:02.053245,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_04_56_41_seed_0_23065779
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9720052, 'precision': 0.9720577, 'recall': 0.97211367, 'specificity': 0.97211367, 'f1': 0.9720049, 'auroc': 0.99616826, 'binary_precision': 0.9810085, 'binary_recall': 0.96334404, 'binary_specificity': 0.9808833, 'binary_f1_score': 0.97209597}
confusion matrix:
      0     1
0  1488    29
1    57  1498
---- Validation: 
scalar performance:
{'acc': 0.7841615, 'precision': 0.78478277, 'recall': 0.78379375, 'specificity': 0.78379375, 'f1': 0.7838613, 'auroc': 0.8633913, 'binary_precision': 0.7950413, 'binary_recall': 0.7574803, 'binary_specificity': 0.8101072, 'binary_f1_score': 0.7758064}
confusion matrix:
     0    1
0  529  124
1  154  481
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7813954, 'precision': 0.8018752, 'recall': 0.7813953, 'specificity': 0.7813953, 'f1': 0.7776238, 'auroc': 0.9179665, 'binary_precision': 0.72324723, 'binary_recall': 0.9116279, 'binary_specificity': 0.6511628, 'binary_f1_score': 0.80658436}
confusion matrix:
     0    1
0  140   75
1   19  196
early stop counter: 1
val acc:0.7841615080833435, best validation acc: 0.8144409656524658, corresponding to test acc:                         0.830232560634613 / 0.830232560634613
after epoch: 3,now: 2024-07-26 05:01:11.953821,epoch time: 0:01:28.275734,used: 0:04:30.328979,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_04_56_41_seed_0_23065779
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.95670575, 'precision': 0.95947355, 'recall': 0.9562521, 'specificity': 0.9562521, 'f1': 0.95660365, 'auroc': 0.9980042, 'binary_precision': 0.9267707, 'binary_recall': 0.99292606, 'binary_specificity': 0.91957814, 'binary_f1_score': 0.95870847}
confusion matrix:
      0     1
0  1395   122
1    11  1544
---- Validation: 
scalar performance:
{'acc': 0.7864907, 'precision': 0.8147656, 'recall': 0.78856516, 'specificity': 0.78856516, 'f1': 0.78238094, 'auroc': 0.90193534, 'binary_precision': 0.71686745, 'binary_recall': 0.93700784, 'binary_specificity': 0.64012253, 'binary_f1_score': 0.8122867}
confusion matrix:
     0    1
0  418  235
1   40  595
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7767442, 'precision': 0.8095584, 'recall': 0.7767442, 'specificity': 0.7767442, 'f1': 0.77066666, 'auroc': 0.92047596, 'binary_precision': 0.70877194, 'binary_recall': 0.9395349, 'binary_specificity': 0.6139535, 'binary_f1_score': 0.808}
confusion matrix:
     0    1
0  132   83
1   13  202
early stop counter: 2
val acc:0.7864906787872314, best validation acc: 0.8144409656524658, corresponding to test acc:                         0.830232560634613 / 0.830232560634613
after epoch: 4,now: 2024-07-26 05:02:41.078671,epoch time: 0:01:29.124850,used: 0:05:59.453829,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_04_56_41_seed_0_23065779
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9840495, 'precision': 0.98409915, 'recall': 0.98400867, 'specificity': 0.98400867, 'f1': 0.9840454, 'auroc': 0.9983789, 'binary_precision': 0.98146963, 'binary_recall': 0.98714656, 'binary_specificity': 0.9808707, 'binary_f1_score': 0.9842999}
confusion matrix:
      0     1
0  1487    29
1    20  1536
---- Validation: 
scalar performance:
{'acc': 0.8051242, 'precision': 0.80902493, 'recall': 0.8043156, 'specificity': 0.8043156, 'f1': 0.80418926, 'auroc': 0.8805489, 'binary_precision': 0.84042555, 'binary_recall': 0.7464567, 'binary_specificity': 0.8621746, 'binary_f1_score': 0.7906589}
confusion matrix:
     0    1
0  563   90
1  161  474
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.83255816, 'precision': 0.8367543, 'recall': 0.83255816, 'specificity': 0.83255816, 'f1': 0.8320349, 'auroc': 0.92467284, 'binary_precision': 0.79916316, 'binary_recall': 0.88837206, 'binary_specificity': 0.7767442, 'binary_f1_score': 0.8414096}
confusion matrix:
     0    1
0  167   48
1   24  191
new oracle model saved
early stop counter: 3
val acc:0.8051242232322693, best validation acc: 0.8144409656524658, corresponding to test acc:                         0.830232560634613 / 0.8325581550598145
after epoch: 5,now: 2024-07-26 05:04:09.449169,epoch time: 0:01:28.370498,used: 0:07:27.824327,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_04_56_41_seed_0_23065779
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9798177, 'precision': 0.980598, 'recall': 0.97955966, 'specificity': 0.97955966, 'f1': 0.9797971, 'auroc': 0.99901557, 'binary_precision': 0.96461827, 'binary_recall': 0.9967928, 'binary_specificity': 0.9623265, 'binary_f1_score': 0.9804417}
confusion matrix:
      0     1
0  1456    57
1     5  1554
---- Validation: 
scalar performance:
{'acc': 0.8625776, 'precision': 0.86573505, 'recall': 0.8632345, 'specificity': 0.8632345, 'f1': 0.8624097, 'auroc': 0.9178281, 'binary_precision': 0.82808024, 'binary_recall': 0.91023624, 'binary_specificity': 0.8162328, 'binary_f1_score': 0.8672168}
confusion matrix:
     0    1
0  533  120
1   57  578
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8418605, 'precision': 0.84292877, 'recall': 0.8418604, 'specificity': 0.8418604, 'f1': 0.8417372, 'auroc': 0.9302325, 'binary_precision': 0.8237885, 'binary_recall': 0.8697674, 'binary_specificity': 0.81395346, 'binary_f1_score': 0.84615386}
confusion matrix:
     0    1
0  175   40
1   28  187
new oracle model saved
better model found
persisted
after epoch: 6,now: 2024-07-26 05:05:38.244092,epoch time: 0:01:28.794923,used: 0:08:56.619250,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_04_56_41_seed_0_23065779
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9827474, 'precision': 0.9827758, 'recall': 0.98286974, 'specificity': 0.98286974, 'f1': 0.9827469, 'auroc': 0.9981321, 'binary_precision': 0.99150884, 'binary_recall': 0.9743261, 'binary_specificity': 0.9914135, 'binary_f1_score': 0.9828424}
confusion matrix:
      0     1
0  1501    13
1    40  1518
---- Validation: 
scalar performance:
{'acc': 0.73990685, 'precision': 0.77416444, 'recall': 0.73739254, 'specificity': 0.73739254, 'f1': 0.7301427, 'auroc': 0.87208164, 'binary_precision': 0.86764705, 'binary_recall': 0.55748034, 'binary_specificity': 0.91730475, 'binary_f1_score': 0.67881113}
confusion matrix:
     0    1
0  599   54
1  281  354
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.855814, 'precision': 0.8559371, 'recall': 0.855814, 'specificity': 0.855814, 'f1': 0.85580146, 'auroc': 0.92679286, 'binary_precision': 0.86255926, 'binary_recall': 0.8465116, 'binary_specificity': 0.8651163, 'binary_f1_score': 0.85446006}
confusion matrix:
     0    1
0  186   29
1   33  182
new oracle model saved
early stop counter: 1
val acc:0.7399068474769592, best validation acc: 0.8625776171684265, corresponding to test acc:                         0.8418604731559753 / 0.8558139801025391
after epoch: 7,now: 2024-07-26 05:07:06.736957,epoch time: 0:01:28.492865,used: 0:10:25.112115,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_04_56_41_seed_0_23065779
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.984375, 'precision': 0.9845334, 'recall': 0.9845178, 'specificity': 0.9845178, 'f1': 0.984375, 'auroc': 0.9984985, 'binary_precision': 0.99670184, 'binary_recall': 0.9723295, 'binary_specificity': 0.9967062, 'binary_f1_score': 0.9843648}
confusion matrix:
      0     1
0  1513     5
1    43  1511
---- Validation: 
scalar performance:
{'acc': 0.77251554, 'precision': 0.8159477, 'recall': 0.7698991, 'specificity': 0.7698991, 'f1': 0.7632352, 'auroc': 0.91575646, 'binary_precision': 0.9296482, 'binary_recall': 0.5826772, 'binary_specificity': 0.95712095, 'binary_f1_score': 0.71636015}
confusion matrix:
     0    1
0  625   28
1  265  370
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.83255816, 'precision': 0.8695224, 'recall': 0.83255816, 'specificity': 0.83255816, 'f1': 0.8282634, 'auroc': 0.92436993, 'binary_precision': 0.9863946, 'binary_recall': 0.6744186, 'binary_specificity': 0.9906977, 'binary_f1_score': 0.801105}
confusion matrix:
     0    1
0  213    2
1   70  145
early stop counter: 2
val acc:0.7725155353546143, best validation acc: 0.8625776171684265, corresponding to test acc:                         0.8418604731559753 / 0.8558139801025391
after epoch: 8,now: 2024-07-26 05:08:34.978656,epoch time: 0:01:28.241699,used: 0:11:53.353814,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_04_56_41_seed_0_23065779
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9899089, 'precision': 0.9898993, 'recall': 0.9899647, 'specificity': 0.9899647, 'f1': 0.98990846, 'auroc': 0.99940014, 'binary_precision': 0.9948018, 'binary_recall': 0.9851995, 'binary_specificity': 0.99472994, 'binary_f1_score': 0.9899774}
confusion matrix:
      0     1
0  1510     8
1    23  1531
---- Validation: 
scalar performance:
{'acc': 0.85636646, 'precision': 0.8598586, 'recall': 0.8556764, 'specificity': 0.8556764, 'f1': 0.855824, 'auroc': 0.9198804, 'binary_precision': 0.8919861, 'binary_recall': 0.8062992, 'binary_specificity': 0.9050536, 'binary_f1_score': 0.8469809}
confusion matrix:
     0    1
0  591   62
1  123  512
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.86744183, 'precision': 0.8709811, 'recall': 0.8674419, 'specificity': 0.8674419, 'f1': 0.8671249, 'auroc': 0.9398377, 'binary_precision': 0.9072165, 'binary_recall': 0.81860465, 'binary_specificity': 0.9162791, 'binary_f1_score': 0.8606357}
confusion matrix:
     0    1
0  197   18
1   39  176
new oracle model saved
early stop counter: 3
val acc:0.8563664555549622, best validation acc: 0.8625776171684265, corresponding to test acc:                         0.8418604731559753 / 0.8674418330192566
after epoch: 9,now: 2024-07-26 05:10:03.409515,epoch time: 0:01:28.430859,used: 0:13:21.784673,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_04_56_41_seed_0_23065779
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.97591144, 'precision': 0.97698194, 'recall': 0.97563607, 'specificity': 0.97563607, 'f1': 0.97588384, 'auroc': 0.9993633, 'binary_precision': 0.9574074, 'binary_recall': 0.99678665, 'binary_specificity': 0.9544855, 'binary_f1_score': 0.97670025}
confusion matrix:
      0     1
0  1447    69
1     5  1551
---- Validation: 
scalar performance:
{'acc': 0.882764, 'precision': 0.8829099, 'recall': 0.88292557, 'specificity': 0.88292557, 'f1': 0.882764, 'auroc': 0.92929786, 'binary_precision': 0.87116563, 'binary_recall': 0.8944882, 'binary_specificity': 0.8713629, 'binary_f1_score': 0.8826729}
confusion matrix:
     0    1
0  569   84
1   67  568
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.88837206, 'precision': 0.8911135, 'recall': 0.88837206, 'specificity': 0.88837206, 'f1': 0.88817614, 'auroc': 0.94442403, 'binary_precision': 0.92385787, 'binary_recall': 0.8465116, 'binary_specificity': 0.9302326, 'binary_f1_score': 0.8834951}
confusion matrix:
     0    1
0  200   15
1   33  182
new oracle model saved
better model found
persisted
after epoch: 10,now: 2024-07-26 05:11:31.889554,epoch time: 0:01:28.480039,used: 0:14:50.264712,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_04_56_41_seed_0_23065779
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.98014325, 'precision': 0.9808396, 'recall': 0.9799106, 'specificity': 0.9799106, 'f1': 0.98012495, 'auroc': 0.99964005, 'binary_precision': 0.9657747, 'binary_recall': 0.9961489, 'binary_specificity': 0.9636724, 'binary_f1_score': 0.98072666}
confusion matrix:
      0     1
0  1459    55
1     6  1552
---- Validation: 
scalar performance:
{'acc': 0.882764, 'precision': 0.8827362, 'recall': 0.88275194, 'specificity': 0.88275194, 'f1': 0.88274354, 'auroc': 0.9307865, 'binary_precision': 0.8805031, 'binary_recall': 0.88188976, 'binary_specificity': 0.88361406, 'binary_f1_score': 0.88119584}
confusion matrix:
     0    1
0  577   76
1   75  560
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.88837206, 'precision': 0.8971704, 'recall': 0.88837206, 'specificity': 0.88837206, 'f1': 0.8877504, 'auroc': 0.94544077, 'binary_precision': 0.95628417, 'binary_recall': 0.81395346, 'binary_specificity': 0.96279067, 'binary_f1_score': 0.8793969}
confusion matrix:
     0    1
0  207    8
1   40  175
early stop counter: 1
val acc:0.8827639818191528, best validation acc: 0.8827639818191528, corresponding to test acc:                         0.8883720636367798 / 0.8883720636367798
after epoch: 11,now: 2024-07-26 05:13:00.797183,epoch time: 0:01:28.907629,used: 0:16:19.172341,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_04_56_41_seed_0_23065779
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9905599, 'precision': 0.9905418, 'recall': 0.99063724, 'specificity': 0.99063724, 'f1': 0.99055916, 'auroc': 0.99926317, 'binary_precision': 0.99610645, 'binary_recall': 0.9852375, 'binary_specificity': 0.996037, 'binary_f1_score': 0.99064213}
confusion matrix:
      0     1
0  1508     6
1    23  1535
---- Validation: 
scalar performance:
{'acc': 0.73913044, 'precision': 0.8086417, 'recall': 0.73578036, 'specificity': 0.73578036, 'f1': 0.7217392, 'auroc': 0.92253804, 'binary_precision': 0.95166165, 'binary_recall': 0.496063, 'binary_specificity': 0.9754977, 'binary_f1_score': 0.65217394}
confusion matrix:
     0    1
0  637   16
1  320  315
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7883721, 'precision': 0.85130715, 'recall': 0.7883721, 'specificity': 0.7883721, 'f1': 0.77844965, 'auroc': 0.94812334, 'binary_precision': 1.0, 'binary_recall': 0.5767442, 'binary_specificity': 1.0, 'binary_f1_score': 0.73156345}
confusion matrix:
     0    1
0  215    0
1   91  124
early stop counter: 2
val acc:0.739130437374115, best validation acc: 0.8827639818191528, corresponding to test acc:                         0.8883720636367798 / 0.8883720636367798
after epoch: 12,now: 2024-07-26 05:14:29.051910,epoch time: 0:01:28.254727,used: 0:17:47.427068,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_04_56_41_seed_0_23065779
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.97721356, 'precision': 0.9778371, 'recall': 0.9774895, 'specificity': 0.9774895, 'f1': 0.9772119, 'auroc': 0.9987472, 'binary_precision': 0.9986577, 'binary_recall': 0.9562982, 'binary_specificity': 0.9986807, 'binary_f1_score': 0.977019}
confusion matrix:
      0     1
0  1514     2
1    68  1488
---- Validation: 
scalar performance:
{'acc': 0.7336956, 'precision': 0.8057028, 'recall': 0.73026854, 'specificity': 0.73026854, 'f1': 0.7151073, 'auroc': 0.9325681, 'binary_precision': 0.9506173, 'binary_recall': 0.48503938, 'binary_specificity': 0.9754977, 'binary_f1_score': 0.64233583}
confusion matrix:
     0    1
0  637   16
1  327  308
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7162791, 'precision': 0.81899107, 'recall': 0.7162791, 'specificity': 0.7162791, 'f1': 0.6914408, 'auroc': 0.9405949, 'binary_precision': 1.0, 'binary_recall': 0.43255815, 'binary_specificity': 1.0, 'binary_f1_score': 0.6038961}
confusion matrix:
     0   1
0  215   0
1  122  93
early stop counter: 3
val acc:0.7336956262588501, best validation acc: 0.8827639818191528, corresponding to test acc:                         0.8883720636367798 / 0.8883720636367798
after epoch: 13,now: 2024-07-26 05:15:58.147019,epoch time: 0:01:29.095109,used: 0:19:16.522177,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_04_56_41_seed_0_23065779
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9938151, 'precision': 0.9938283, 'recall': 0.99380136, 'specificity': 0.99380136, 'f1': 0.99381393, 'auroc': 0.99969435, 'binary_precision': 0.9929442, 'binary_recall': 0.9948586, 'binary_specificity': 0.9927441, 'binary_f1_score': 0.99390054}
confusion matrix:
      0     1
0  1505    11
1     8  1548
---- Validation: 
scalar performance:
{'acc': 0.82375777, 'precision': 0.84721684, 'recall': 0.8219327, 'specificity': 0.8219327, 'f1': 0.82012665, 'auroc': 0.9155419, 'binary_precision': 0.9340426, 'binary_recall': 0.6913386, 'binary_specificity': 0.9525268, 'binary_f1_score': 0.7945701}
confusion matrix:
     0    1
0  622   31
1  196  439
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7976744, 'precision': 0.84691405, 'recall': 0.7976744, 'specificity': 0.7976744, 'f1': 0.790231, 'auroc': 0.9269011, 'binary_precision': 0.97761196, 'binary_recall': 0.60930234, 'binary_specificity': 0.9860465, 'binary_f1_score': 0.7507164}
confusion matrix:
     0    1
0  212    3
1   84  131
early stop counter: 4
val acc:0.8237577676773071, best validation acc: 0.8827639818191528, corresponding to test acc:                         0.8883720636367798 / 0.8883720636367798
after epoch: 14,now: 2024-07-26 05:17:26.618730,epoch time: 0:01:28.471711,used: 0:20:44.993888,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_04_56_41_seed_0_23065779
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.98567706, 'precision': 0.98575443, 'recall': 0.985621, 'specificity': 0.985621, 'f1': 0.9856727, 'auroc': 0.99911606, 'binary_precision': 0.98215425, 'binary_recall': 0.9897238, 'binary_specificity': 0.98151815, 'binary_f1_score': 0.98592454}
confusion matrix:
      0     1
0  1487    28
1    16  1541
---- Validation: 
scalar performance:
{'acc': 0.8128882, 'precision': 0.8354913, 'recall': 0.811061, 'specificity': 0.811061, 'f1': 0.80903316, 'auroc': 0.9232856, 'binary_precision': 0.9191489, 'binary_recall': 0.68031496, 'binary_specificity': 0.94180703, 'binary_f1_score': 0.78190047}
confusion matrix:
     0    1
0  615   38
1  203  432
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.81395346, 'precision': 0.8644068, 'recall': 0.8139535, 'specificity': 0.8139535, 'f1': 0.8072829, 'auroc': 0.9376744, 'binary_precision': 1.0, 'binary_recall': 0.627907, 'binary_specificity': 1.0, 'binary_f1_score': 0.7714285}
confusion matrix:
     0    1
0  215    0
1   80  135
early stop counter: 5
val acc:0.8128882050514221, best validation acc: 0.8827639818191528, corresponding to test acc:                         0.8883720636367798 / 0.8883720636367798
after epoch: 15,now: 2024-07-26 05:18:55.627631,epoch time: 0:01:29.008901,used: 0:22:14.002789,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_04_56_41_seed_0_23065779
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9765625, 'precision': 0.97770786, 'recall': 0.97626436, 'specificity': 0.97626436, 'f1': 0.9765335, 'auroc': 0.9993849, 'binary_precision': 0.95748615, 'binary_recall': 0.9980732, 'binary_specificity': 0.95445544, 'binary_f1_score': 0.97735846}
confusion matrix:
      0     1
0  1446    69
1     3  1554
---- Validation: 
scalar performance:
{'acc': 0.88431674, 'precision': 0.88428926, 'recall': 0.884305, 'specificity': 0.884305, 'f1': 0.88429666, 'auroc': 0.92835486, 'binary_precision': 0.8820755, 'binary_recall': 0.8834646, 'binary_specificity': 0.8851455, 'binary_f1_score': 0.88276947}
confusion matrix:
     0    1
0  578   75
1   74  561
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.89302325, 'precision': 0.8942514, 'recall': 0.89302325, 'specificity': 0.89302325, 'f1': 0.89293987, 'auroc': 0.9355543, 'binary_precision': 0.9162561, 'binary_recall': 0.8651163, 'binary_specificity': 0.9209302, 'binary_f1_score': 0.8899521}
confusion matrix:
     0    1
0  198   17
1   29  186
new oracle model saved
better model found
persisted
after epoch: 16,now: 2024-07-26 05:20:24.856744,epoch time: 0:01:29.229113,used: 0:23:43.231902,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_04_56_41_seed_0_23065779
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9902344, 'precision': 0.9902786, 'recall': 0.9901988, 'specificity': 0.9901988, 'f1': 0.990232, 'auroc': 0.9995252, 'binary_precision': 0.9878517, 'binary_recall': 0.9929306, 'binary_specificity': 0.987467, 'binary_f1_score': 0.99038464}
confusion matrix:
      0     1
0  1497    19
1    11  1545
---- Validation: 
scalar performance:
{'acc': 0.85714287, 'precision': 0.86572576, 'recall': 0.85607314, 'specificity': 0.85607314, 'f1': 0.8560149, 'auroc': 0.9242581, 'binary_precision': 0.9183673, 'binary_recall': 0.77952754, 'binary_specificity': 0.9326187, 'binary_f1_score': 0.84327084}
confusion matrix:
     0    1
0  609   44
1  140  495
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.88372093, 'precision': 0.8960943, 'recall': 0.88372093, 'specificity': 0.88372093, 'f1': 0.8828057, 'auroc': 0.94111407, 'binary_precision': 0.9661017, 'binary_recall': 0.7953488, 'binary_specificity': 0.97209305, 'binary_f1_score': 0.872449}
confusion matrix:
     0    1
0  209    6
1   44  171
early stop counter: 1
val acc:0.8571428656578064, best validation acc: 0.8843167424201965, corresponding to test acc:                         0.8930232524871826 / 0.8930232524871826
after epoch: 17,now: 2024-07-26 05:21:53.324678,epoch time: 0:01:28.467934,used: 0:25:11.699836,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_04_56_41_seed_0_23065779
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9876302, 'precision': 0.9877175, 'recall': 0.9877572, 'specificity': 0.9877572, 'f1': 0.9876302, 'auroc': 0.9995159, 'binary_precision': 0.9980302, 'binary_recall': 0.977492, 'binary_specificity': 0.99802244, 'binary_f1_score': 0.9876543}
confusion matrix:
      0     1
0  1514     3
1    35  1520
---- Validation: 
scalar performance:
{'acc': 0.72748446, 'precision': 0.80235845, 'recall': 0.72396934, 'specificity': 0.72396934, 'f1': 0.7074574, 'auroc': 0.9262761, 'binary_precision': 0.9493671, 'binary_recall': 0.47244096, 'binary_specificity': 0.9754977, 'binary_f1_score': 0.63091487}
confusion matrix:
     0    1
0  637   16
1  335  300
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.74418604, 'precision': 0.8265965, 'recall': 0.74418604, 'specificity': 0.74418604, 'f1': 0.7269621, 'auroc': 0.91372633, 'binary_precision': 0.99065423, 'binary_recall': 0.49302325, 'binary_specificity': 0.9953488, 'binary_f1_score': 0.6583851}
confusion matrix:
     0    1
0  214    1
1  109  106
early stop counter: 2
val acc:0.7274844646453857, best validation acc: 0.8843167424201965, corresponding to test acc:                         0.8930232524871826 / 0.8930232524871826
after epoch: 18,now: 2024-07-26 05:23:23.245228,epoch time: 0:01:29.920550,used: 0:26:41.620386,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_04_56_41_seed_0_23065779
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.98795575, 'precision': 0.98803383, 'recall': 0.9880787, 'specificity': 0.9880787, 'f1': 0.9879557, 'auroc': 0.99963546, 'binary_precision': 0.9980315, 'binary_recall': 0.97813505, 'binary_specificity': 0.99802244, 'binary_f1_score': 0.9879831}
confusion matrix:
      0     1
0  1514     3
1    34  1521
---- Validation: 
scalar performance:
{'acc': 0.64829195, 'precision': 0.7756696, 'recall': 0.6434807, 'specificity': 0.6434807, 'f1': 0.59814286, 'auroc': 0.90882957, 'binary_precision': 0.959596, 'binary_recall': 0.2992126, 'binary_specificity': 0.98774886, 'binary_f1_score': 0.45618245}
confusion matrix:
     0    1
0  645    8
1  445  190
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7069768, 'precision': 0.81524926, 'recall': 0.7069768, 'specificity': 0.7069768, 'f1': 0.6794538, 'auroc': 0.9225311, 'binary_precision': 1.0, 'binary_recall': 0.41395348, 'binary_specificity': 1.0, 'binary_f1_score': 0.5855263}
confusion matrix:
     0   1
0  215   0
1  126  89
early stop counter: 3
val acc:0.6482919454574585, best validation acc: 0.8843167424201965, corresponding to test acc:                         0.8930232524871826 / 0.8930232524871826
after epoch: 19,now: 2024-07-26 05:24:51.304437,epoch time: 0:01:28.059209,used: 0:28:09.679595,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_04_56_41_seed_0_23065779
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9876302, 'precision': 0.98789775, 'recall': 0.98751557, 'specificity': 0.98751557, 'f1': 0.9876245, 'auroc': 0.9996829, 'binary_precision': 0.9791535, 'binary_recall': 0.99678457, 'binary_specificity': 0.9782465, 'binary_f1_score': 0.9878904}
confusion matrix:
      0     1
0  1484    33
1     5  1550
---- Validation: 
scalar performance:
{'acc': 0.7717391, 'precision': 0.8097584, 'recall': 0.7692636, 'specificity': 0.7692636, 'f1': 0.76338625, 'auroc': 0.9158306, 'binary_precision': 0.91484183, 'binary_recall': 0.592126, 'binary_specificity': 0.94640124, 'binary_f1_score': 0.71892935}
confusion matrix:
     0    1
0  618   35
1  259  376
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8488372, 'precision': 0.86200166, 'recall': 0.8488372, 'specificity': 0.8488372, 'f1': 0.8474504, 'auroc': 0.9164089, 'binary_precision': 0.9310345, 'binary_recall': 0.75348836, 'binary_specificity': 0.94418603, 'binary_f1_score': 0.8329049}
confusion matrix:
     0    1
0  203   12
1   53  162
early stop counter: 4
val acc:0.77173912525177, best validation acc: 0.8843167424201965, corresponding to test acc:                         0.8930232524871826 / 0.8930232524871826
after epoch: 20,now: 2024-07-26 05:26:19.997854,epoch time: 0:01:28.693417,used: 0:29:38.373012,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_04_56_41_seed_0_23065779
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.99121094, 'precision': 0.9912352, 'recall': 0.9912975, 'specificity': 0.9912975, 'f1': 0.99121076, 'auroc': 0.9996232, 'binary_precision': 0.99869365, 'binary_recall': 0.98391247, 'binary_specificity': 0.9986825, 'binary_f1_score': 0.99124795}
confusion matrix:
      0     1
0  1516     2
1    25  1529
---- Validation: 
scalar performance:
{'acc': 0.76785713, 'precision': 0.8072367, 'recall': 0.7653266, 'specificity': 0.7653266, 'f1': 0.7589939, 'auroc': 0.91133356, 'binary_precision': 0.9137931, 'binary_recall': 0.58425194, 'binary_specificity': 0.94640124, 'binary_f1_score': 0.7127761}
confusion matrix:
     0    1
0  618   35
1  264  371
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7976744, 'precision': 0.8414731, 'recall': 0.7976744, 'specificity': 0.7976744, 'f1': 0.79097176, 'auroc': 0.90758246, 'binary_precision': 0.9637681, 'binary_recall': 0.61860466, 'binary_specificity': 0.9767442, 'binary_f1_score': 0.7535411}
confusion matrix:
     0    1
0  210    5
1   82  133
early stop counter: 5
val acc:0.7678571343421936, best validation acc: 0.8843167424201965, corresponding to test acc:                         0.8930232524871826 / 0.8930232524871826
after epoch: 21,now: 2024-07-26 05:27:48.095570,epoch time: 0:01:28.097716,used: 0:31:06.470728,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_04_56_41_seed_0_23065779
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.99641925, 'precision': 0.9964142, 'recall': 0.9964232, 'specificity': 0.9964232, 'f1': 0.9964186, 'auroc': 0.9997995, 'binary_precision': 0.9967887, 'binary_recall': 0.9961489, 'binary_specificity': 0.9966975, 'binary_f1_score': 0.99646866}
confusion matrix:
      0     1
0  1509     5
1     6  1552
---- Validation: 
scalar performance:
{'acc': 0.8004658, 'precision': 0.8301364, 'recall': 0.798354, 'specificity': 0.798354, 'f1': 0.79506993, 'auroc': 0.919292, 'binary_precision': 0.9256757, 'binary_recall': 0.6472441, 'binary_specificity': 0.949464, 'binary_f1_score': 0.7618165}
confusion matrix:
     0    1
0  620   33
1  224  411
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8418605, 'precision': 0.8728676, 'recall': 0.8418604, 'specificity': 0.8418604, 'f1': 0.838503, 'auroc': 0.92421854, 'binary_precision': 0.98039216, 'binary_recall': 0.6976744, 'binary_specificity': 0.9860465, 'binary_f1_score': 0.81521744}
confusion matrix:
     0    1
0  212    3
1   65  150
early stop counter: 6
val acc:0.8004658222198486, best validation acc: 0.8843167424201965, corresponding to test acc:                         0.8930232524871826 / 0.8930232524871826
after epoch: 22,now: 2024-07-26 05:29:16.874632,epoch time: 0:01:28.779062,used: 0:32:35.249790,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_04_56_41_seed_0_23065779
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.9899089, 'precision': 0.98995775, 'recall': 0.9900361, 'specificity': 0.9900361, 'f1': 0.9899087, 'auroc': 0.9995582, 'binary_precision': 0.99934554, 'binary_recall': 0.9807322, 'binary_specificity': 0.99933994, 'binary_f1_score': 0.98995143}
confusion matrix:
      0     1
0  1514     1
1    30  1527
---- Validation: 
scalar performance:
{'acc': 0.7088509, 'precision': 0.7923819, 'recall': 0.7050717, 'specificity': 0.7050717, 'f1': 0.68402934, 'auroc': 0.9166609, 'binary_precision': 0.94520545, 'binary_recall': 0.43464568, 'binary_specificity': 0.9754977, 'binary_f1_score': 0.59546924}
confusion matrix:
     0    1
0  637   16
1  359  276
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.75348836, 'precision': 0.82711256, 'recall': 0.75348836, 'specificity': 0.75348836, 'f1': 0.7387906, 'auroc': 0.9188967, 'binary_precision': 0.9823009, 'binary_recall': 0.51627904, 'binary_specificity': 0.9906977, 'binary_f1_score': 0.6768292}
confusion matrix:
     0    1
0  213    2
1  104  111
early stop counter: 7
val acc:0.7088509202003479, best validation acc: 0.8843167424201965, corresponding to test acc:                         0.8930232524871826 / 0.8930232524871826
after epoch: 23,now: 2024-07-26 05:30:44.717545,epoch time: 0:01:27.842913,used: 0:34:03.092703,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_04_56_41_seed_0_23065779
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9869792, 'precision': 0.9872894, 'recall': 0.9868432, 'specificity': 0.9868432, 'f1': 0.986972, 'auroc': 0.99965024, 'binary_precision': 0.9779458, 'binary_recall': 0.9967887, 'binary_specificity': 0.9768977, 'binary_f1_score': 0.9872773}
confusion matrix:
      0     1
0  1480    35
1     5  1552
---- Validation: 
scalar performance:
{'acc': 0.88586956, 'precision': 0.88859165, 'recall': 0.88529384, 'specificity': 0.88529384, 'f1': 0.8855411, 'auroc': 0.93911624, 'binary_precision': 0.91780823, 'binary_recall': 0.8440945, 'binary_specificity': 0.9264931, 'binary_f1_score': 0.8794094}
confusion matrix:
     0    1
0  605   48
1   99  536
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8372093, 'precision': 0.8636756, 'recall': 0.83720934, 'specificity': 0.83720934, 'f1': 0.83419263, 'auroc': 0.9108058, 'binary_precision': 0.96178347, 'binary_recall': 0.7023256, 'binary_specificity': 0.97209305, 'binary_f1_score': 0.811828}
confusion matrix:
     0    1
0  209    6
1   64  151
better model found
persisted
after epoch: 24,now: 2024-07-26 05:32:13.529121,epoch time: 0:01:28.811576,used: 0:35:31.904279,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_04_56_41_seed_0_23065779
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.991862, 'precision': 0.99205124, 'recall': 0.99175775, 'specificity': 0.99175775, 'f1': 0.9918581, 'auroc': 0.99977446, 'binary_precision': 0.98544306, 'binary_recall': 0.9987171, 'binary_specificity': 0.98479843, 'binary_f1_score': 0.9920357}
confusion matrix:
      0     1
0  1490    23
1     2  1557
---- Validation: 
scalar performance:
{'acc': 0.8804348, 'precision': 0.89084154, 'recall': 0.87930447, 'specificity': 0.87930447, 'f1': 0.87938786, 'auroc': 0.9402461, 'binary_precision': 0.9512195, 'binary_recall': 0.7984252, 'binary_specificity': 0.96018374, 'binary_f1_score': 0.86815065}
confusion matrix:
     0    1
0  627   26
1  128  507
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7930232, 'precision': 0.8503984, 'recall': 0.7930232, 'specificity': 0.7930232, 'f1': 0.78418887, 'auroc': 0.9316171, 'binary_precision': 0.9921875, 'binary_recall': 0.59069765, 'binary_specificity': 0.9953488, 'binary_f1_score': 0.74052477}
confusion matrix:
     0    1
0  214    1
1   88  127
early stop counter: 1
val acc:0.8804348111152649, best validation acc: 0.885869562625885, corresponding to test acc:                         0.8372092843055725 / 0.8930232524871826
after epoch: 25,now: 2024-07-26 05:33:42.195302,epoch time: 0:01:28.666181,used: 0:37:00.570460,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_04_56_41_seed_0_23065779
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9824219, 'precision': 0.98279154, 'recall': 0.982659, 'specificity': 0.982659, 'f1': 0.98242164, 'auroc': 0.9997575, 'binary_precision': 1.0, 'binary_recall': 0.9653179, 'binary_specificity': 1.0, 'binary_f1_score': 0.9823529}
confusion matrix:
      0     1
0  1515     0
1    54  1503
---- Validation: 
scalar performance:
{'acc': 0.6513975, 'precision': 0.7749891, 'recall': 0.64665204, 'specificity': 0.64665204, 'f1': 0.60317373, 'auroc': 0.92673004, 'binary_precision': 0.9558824, 'binary_recall': 0.30708662, 'binary_specificity': 0.98621744, 'binary_f1_score': 0.4648391}
confusion matrix:
     0    1
0  644    9
1  440  195
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6976744, 'precision': 0.8115942, 'recall': 0.6976744, 'specificity': 0.6976744, 'f1': 0.66726196, 'auroc': 0.9146782, 'binary_precision': 1.0, 'binary_recall': 0.39534885, 'binary_specificity': 1.0, 'binary_f1_score': 0.5666667}
confusion matrix:
     0   1
0  215   0
1  130  85
early stop counter: 2
val acc:0.6513975262641907, best validation acc: 0.885869562625885, corresponding to test acc:                         0.8372092843055725 / 0.8930232524871826
after epoch: 26,now: 2024-07-26 05:35:09.985516,epoch time: 0:01:27.790214,used: 0:38:28.360674,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_04_56_41_seed_0_23065779
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.9944661, 'precision': 0.99444646, 'recall': 0.9944949, 'specificity': 0.9944949, 'f1': 0.9944655, 'auroc': 0.9999394, 'binary_precision': 0.9967721, 'binary_recall': 0.99228793, 'binary_specificity': 0.99670184, 'binary_f1_score': 0.994525}
confusion matrix:
      0     1
0  1511     5
1    12  1544
---- Validation: 
scalar performance:
{'acc': 0.8214286, 'precision': 0.84561574, 'recall': 0.8195705, 'specificity': 0.8195705, 'f1': 0.8176253, 'auroc': 0.9347367, 'binary_precision': 0.93361884, 'binary_recall': 0.68661416, 'binary_specificity': 0.9525268, 'binary_f1_score': 0.79128855}
confusion matrix:
     0    1
0  622   31
1  199  436
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.855814, 'precision': 0.8744792, 'recall': 0.855814, 'specificity': 0.855814, 'f1': 0.8539946, 'auroc': 0.9269064, 'binary_precision': 0.9580838, 'binary_recall': 0.74418604, 'binary_specificity': 0.96744186, 'binary_f1_score': 0.8376964}
confusion matrix:
     0    1
0  208    7
1   55  160
early stop counter: 3
val acc:0.8214285969734192, best validation acc: 0.885869562625885, corresponding to test acc:                         0.8372092843055725 / 0.8930232524871826
after epoch: 27,now: 2024-07-26 05:36:37.919862,epoch time: 0:01:27.934346,used: 0:39:56.295020,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_04_56_41_seed_0_23065779
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.991862, 'precision': 0.9919352, 'recall': 0.991809, 'specificity': 0.991809, 'f1': 0.9918594, 'auroc': 0.99983084, 'binary_precision': 0.9885277, 'binary_recall': 0.99550706, 'binary_specificity': 0.98811096, 'binary_f1_score': 0.9920051}
confusion matrix:
      0     1
0  1496    18
1     7  1551
---- Validation: 
scalar performance:
{'acc': 0.8439441, 'precision': 0.86090946, 'recall': 0.84242684, 'specificity': 0.84242684, 'f1': 0.8416509, 'auroc': 0.9251118, 'binary_precision': 0.935743, 'binary_recall': 0.7338583, 'binary_specificity': 0.9509954, 'binary_f1_score': 0.82259494}
confusion matrix:
     0    1
0  621   32
1  169  466
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7651163, 'precision': 0.822976, 'recall': 0.7651163, 'specificity': 0.7651163, 'f1': 0.75410354, 'auroc': 0.90210927, 'binary_precision': 0.9596774, 'binary_recall': 0.5534884, 'binary_specificity': 0.9767442, 'binary_f1_score': 0.70206493}
confusion matrix:
     0    1
0  210    5
1   96  119
early stop counter: 4
val acc:0.8439440727233887, best validation acc: 0.885869562625885, corresponding to test acc:                         0.8372092843055725 / 0.8930232524871826
after epoch: 28,now: 2024-07-26 05:38:05.849278,epoch time: 0:01:27.929416,used: 0:41:24.224436,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_04_56_41_seed_0_23065779
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.991862, 'precision': 0.99206537, 'recall': 0.9917631, 'specificity': 0.9917631, 'f1': 0.9918586, 'auroc': 0.9999441, 'binary_precision': 0.9848005, 'binary_recall': 0.99935734, 'binary_specificity': 0.9841689, 'binary_f1_score': 0.99202555}
confusion matrix:
      0     1
0  1492    24
1     1  1555
---- Validation: 
scalar performance:
{'acc': 0.84006214, 'precision': 0.86029965, 'recall': 0.838403, 'specificity': 0.838403, 'f1': 0.837294, 'auroc': 0.9315286, 'binary_precision': 0.942268, 'binary_recall': 0.719685, 'binary_specificity': 0.95712095, 'binary_f1_score': 0.81607145}
confusion matrix:
     0    1
0  625   28
1  178  457
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8860465, 'precision': 0.903733, 'recall': 0.8860465, 'specificity': 0.8860465, 'f1': 0.8847847, 'auroc': 0.9415684, 'binary_precision': 0.9882353, 'binary_recall': 0.7813954, 'binary_specificity': 0.9906977, 'binary_f1_score': 0.8727273}
confusion matrix:
     0    1
0  213    2
1   47  168
early stop counter: 5
val acc:0.840062141418457, best validation acc: 0.885869562625885, corresponding to test acc:                         0.8372092843055725 / 0.8930232524871826
after epoch: 29,now: 2024-07-26 05:39:33.942935,epoch time: 0:01:28.093657,used: 0:42:52.318093,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_04_56_41_seed_0_23065779
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.99316406, 'precision': 0.9931685, 'recall': 0.9932519, 'specificity': 0.9932519, 'f1': 0.9931638, 'auroc': 0.99988973, 'binary_precision': 1.0, 'binary_recall': 0.98650384, 'binary_specificity': 1.0, 'binary_f1_score': 0.9932061}
confusion matrix:
      0     1
0  1516     0
1    21  1535
---- Validation: 
scalar performance:
{'acc': 0.7181677, 'precision': 0.79605114, 'recall': 0.7145422, 'specificity': 0.7145422, 'f1': 0.6961109, 'auroc': 0.91326046, 'binary_precision': 0.9444444, 'binary_recall': 0.45511812, 'binary_specificity': 0.9739663, 'binary_f1_score': 0.61424017}
confusion matrix:
     0    1
0  636   17
1  346  289
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.75116277, 'precision': 0.8338509, 'recall': 0.75116277, 'specificity': 0.75116277, 'f1': 0.73473775, 'auroc': 0.9361601, 'binary_precision': 1.0, 'binary_recall': 0.5023256, 'binary_specificity': 1.0, 'binary_f1_score': 0.6687307}
confusion matrix:
     0    1
0  215    0
1  107  108
early stop counter: 6
val acc:0.7181677222251892, best validation acc: 0.885869562625885, corresponding to test acc:                         0.8372092843055725 / 0.8930232524871826
after epoch: 30,now: 2024-07-26 05:41:01.318266,epoch time: 0:01:27.375331,used: 0:44:19.693424,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_04_56_41_seed_0_23065779
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 0:44:19.693424 at 2024-07-26 05:41:01.318266
persisted model performance metric: 

scalar performance:
{'acc': 0.8372093, 'precision': 0.8636756, 'recall': 0.83720934, 'specificity': 0.83720934, 'f1': 0.83419263, 'auroc': 0.9108058, 'binary_precision': 0.96178347, 'binary_recall': 0.7023256, 'binary_specificity': 0.97209305, 'binary_f1_score': 0.811828}
confusion matrix:
     0    1
0  209    6
1   64  151
oracle model performance metric: 

scalar performance:
{'acc': 0.89302325, 'precision': 0.8942514, 'recall': 0.89302325, 'specificity': 0.89302325, 'f1': 0.89293987, 'auroc': 0.9355543, 'binary_precision': 0.9162561, 'binary_recall': 0.8651163, 'binary_specificity': 0.9209302, 'binary_f1_score': 0.8899521}
confusion matrix:
     0    1
0  198   17
1   29  186
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_irm_10seeds_nofreeze_2024-07-26_02-28-54/rule_results/0.csv
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_irm_10seeds_nofreeze_2024-07-26_02-28-54/rule_results/0.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_irm_10seeds_nofreeze_2024-07-26_02-28-54/confusion_matrix/0.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 455454 KiB |  13219 MiB |  73431 GiB |  73430 GiB |
|       from large pool | 414861 KiB |  13181 MiB |  72564 GiB |  72563 GiB |
|       from small pool |  40592 KiB |     56 MiB |    866 GiB |    866 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 455454 KiB |  13219 MiB |  73431 GiB |  73430 GiB |
|       from large pool | 414861 KiB |  13181 MiB |  72564 GiB |  72563 GiB |
|       from small pool |  40592 KiB |     56 MiB |    866 GiB |    866 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 447480 KiB |  13213 MiB |  72936 GiB |  72936 GiB |
|       from large pool | 407075 KiB |  13175 MiB |  72071 GiB |  72071 GiB |
|       from small pool |  40405 KiB |     56 MiB |    864 GiB |    864 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  14470 MiB |  14470 MiB |  14470 MiB |      0 B   |
|       from large pool |  14404 MiB |  14404 MiB |  14404 MiB |      0 B   |
|       from small pool |     66 MiB |     66 MiB |     66 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory | 472290 KiB |   1229 MiB |  51826 GiB |  51826 GiB |
|       from large pool | 461682 KiB |   1224 MiB |  50956 GiB |  50955 GiB |
|       from small pool |  10607 KiB |     17 MiB |    870 GiB |    870 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    1298    |    2594    |   12911 K  |   12910 K  |
|       from large pool |     187    |    1413    |    6569 K  |    6569 K  |
|       from small pool |    1111    |    1407    |    6342 K  |    6341 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    1298    |    2594    |   12911 K  |   12910 K  |
|       from large pool |     187    |    1413    |    6569 K  |    6569 K  |
|       from small pool |    1111    |    1407    |    6342 K  |    6341 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     634    |     634    |     634    |       0    |
|       from large pool |     601    |     601    |     601    |       0    |
|       from small pool |      33    |      33    |      33    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      95    |     648    |    9057 K  |    9057 K  |
|       from large pool |      39    |     600    |    5357 K  |    5357 K  |
|       from small pool |      56    |     236    |    3699 K  |    3699 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13219 MiB |  73431 GiB |  73431 GiB |
|       from large pool |  16640 KiB |  13181 MiB |  72564 GiB |  72564 GiB |
|       from small pool |      0 KiB |     56 MiB |    866 GiB |    866 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13219 MiB |  73431 GiB |  73431 GiB |
|       from large pool |  16640 KiB |  13181 MiB |  72564 GiB |  72564 GiB |
|       from small pool |      0 KiB |     56 MiB |    866 GiB |    866 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13213 MiB |  72936 GiB |  72936 GiB |
|       from large pool |  16640 KiB |  13175 MiB |  72071 GiB |  72071 GiB |
|       from small pool |      0 KiB |     56 MiB |    864 GiB |    864 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    906 MiB |  14470 MiB |  14470 MiB |  13564 MiB |
|       from large pool |    856 MiB |  14404 MiB |  14404 MiB |  13548 MiB |
|       from small pool |     50 MiB |     66 MiB |     66 MiB |     16 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1229 MiB |  51827 GiB |  51827 GiB |
|       from large pool |  24320 KiB |   1224 MiB |  50956 GiB |  50956 GiB |
|       from small pool |      0 KiB |     43 MiB |    870 GiB |    870 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    2594    |   12911 K  |   12911 K  |
|       from large pool |       2    |    1413    |    6569 K  |    6569 K  |
|       from small pool |       0    |    1407    |    6342 K  |    6342 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    2594    |   12911 K  |   12911 K  |
|       from large pool |       2    |    1413    |    6569 K  |    6569 K  |
|       from small pool |       0    |    1407    |    6342 K  |    6342 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      63    |     634    |     634    |     571    |
|       from large pool |      38    |     601    |     601    |     563    |
|       from small pool |      25    |      33    |      33    |       8    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |     648    |    9057 K  |    9057 K  |
|       from large pool |       4    |     600    |    5357 K  |    5357 K  |
|       from small pool |       0    |     236    |    3699 K  |    3699 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13219 MiB |  73431 GiB |  73431 GiB |
|       from large pool |  16640 KiB |  13181 MiB |  72564 GiB |  72564 GiB |
|       from small pool |      0 KiB |     56 MiB |    866 GiB |    866 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13219 MiB |  73431 GiB |  73431 GiB |
|       from large pool |  16640 KiB |  13181 MiB |  72564 GiB |  72564 GiB |
|       from small pool |      0 KiB |     56 MiB |    866 GiB |    866 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13213 MiB |  72936 GiB |  72936 GiB |
|       from large pool |  16640 KiB |  13175 MiB |  72071 GiB |  72071 GiB |
|       from small pool |      0 KiB |     56 MiB |    864 GiB |    864 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    906 MiB |  14470 MiB |  14470 MiB |  13564 MiB |
|       from large pool |    856 MiB |  14404 MiB |  14404 MiB |  13548 MiB |
|       from small pool |     50 MiB |     66 MiB |     66 MiB |     16 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1229 MiB |  51827 GiB |  51827 GiB |
|       from large pool |  24320 KiB |   1224 MiB |  50956 GiB |  50956 GiB |
|       from small pool |      0 KiB |     43 MiB |    870 GiB |    870 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    2594    |   12911 K  |   12911 K  |
|       from large pool |       2    |    1413    |    6569 K  |    6569 K  |
|       from small pool |       0    |    1407    |    6342 K  |    6342 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    2594    |   12911 K  |   12911 K  |
|       from large pool |       2    |    1413    |    6569 K  |    6569 K  |
|       from small pool |       0    |    1407    |    6342 K  |    6342 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      63    |     634    |     634    |     571    |
|       from large pool |      38    |     601    |     601    |     563    |
|       from small pool |      25    |      33    |      33    |       8    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |     648    |    9057 K  |    9057 K  |
|       from large pool |       4    |     600    |    5357 K  |    5357 K  |
|       from small pool |       0    |     236    |    3699 K  |    3699 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'888c1ef2'
model name: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_05_41_28_seed_1_23065779

 Experiment start at: 2024-07-26 05:41:28.875911
before training, model accuracy: 0.6177777647972107
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9472656, 'precision': 0.94815046, 'recall': 0.9475874, 'specificity': 0.9475874, 'f1': 0.94725764, 'auroc': 0.9870994, 'binary_precision': 0.97158325, 'binary_recall': 0.92287916, 'binary_specificity': 0.9722955, 'binary_f1_score': 0.9466052}
confusion matrix:
      0     1
0  1474    42
1   120  1436
---- Validation: 
scalar performance:
{'acc': 0.8071819, 'precision': 0.82688916, 'recall': 0.8051459, 'specificity': 0.8051459, 'f1': 0.8034721, 'auroc': 0.8986882, 'binary_precision': 0.9031579, 'binary_recall': 0.68095237, 'binary_specificity': 0.92933947, 'binary_f1_score': 0.7764706}
confusion matrix:
     0    1
0  605   46
1  201  429
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8577778, 'precision': 0.8706944, 'recall': 0.85777783, 'specificity': 0.85777783, 'f1': 0.8565279, 'auroc': 0.9187951, 'binary_precision': 0.9398907, 'binary_recall': 0.7644445, 'binary_specificity': 0.95111114, 'binary_f1_score': 0.8431372}
confusion matrix:
     0    1
0  214   11
1   53  172
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-26 05:43:02.000718,epoch time: 0:01:33.124807,used: 0:01:33.124807,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_05_41_28_seed_1_23065779
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.96972656, 'precision': 0.9698868, 'recall': 0.969879, 'specificity': 0.969879, 'f1': 0.96972656, 'auroc': 0.9955739, 'binary_precision': 0.98218995, 'binary_recall': 0.95755625, 'binary_specificity': 0.9822017, 'binary_f1_score': 0.96971667}
confusion matrix:
      0     1
0  1490    27
1    66  1489
---- Validation: 
scalar performance:
{'acc': 0.8290398, 'precision': 0.835872, 'recall': 0.82785463, 'specificity': 0.82785463, 'f1': 0.8277699, 'auroc': 0.90468144, 'binary_precision': 0.8798521, 'binary_recall': 0.75555557, 'binary_specificity': 0.90015364, 'binary_f1_score': 0.81298035}
confusion matrix:
     0    1
0  586   65
1  154  476
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.84, 'precision': 0.84132147, 'recall': 0.84000003, 'specificity': 0.84000003, 'f1': 0.839845, 'auroc': 0.9096297, 'binary_precision': 0.86255926, 'binary_recall': 0.8088889, 'binary_specificity': 0.8711111, 'binary_f1_score': 0.8348624}
confusion matrix:
     0    1
0  196   29
1   43  182
better model found
persisted
after epoch: 2,now: 2024-07-26 05:44:32.145786,epoch time: 0:01:30.145068,used: 0:03:03.269875,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_05_41_28_seed_1_23065779
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9742839, 'precision': 0.97433126, 'recall': 0.974239, 'specificity': 0.974239, 'f1': 0.9742768, 'auroc': 0.9961727, 'binary_precision': 0.97190297, 'binary_recall': 0.9775209, 'binary_specificity': 0.9709571, 'binary_f1_score': 0.97470385}
confusion matrix:
      0     1
0  1471    44
1    35  1522
---- Validation: 
scalar performance:
{'acc': 0.80249804, 'precision': 0.8055815, 'recall': 0.8016385, 'specificity': 0.8016385, 'f1': 0.80164516, 'auroc': 0.88216174, 'binary_precision': 0.8324515, 'binary_recall': 0.74920636, 'binary_specificity': 0.85407066, 'binary_f1_score': 0.7886383}
confusion matrix:
     0    1
0  556   95
1  158  472
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8244445, 'precision': 0.82445085, 'recall': 0.8244444, 'specificity': 0.8244444, 'f1': 0.8244436, 'auroc': 0.9212049, 'binary_precision': 0.82589287, 'binary_recall': 0.82222223, 'binary_specificity': 0.82666665, 'binary_f1_score': 0.82405347}
confusion matrix:
     0    1
0  186   39
1   40  185
early stop counter: 1
val acc:0.8024980425834656, best validation acc: 0.8290398120880127, corresponding to test acc:                         0.8399999737739563 / 0.8577777743339539
after epoch: 3,now: 2024-07-26 05:46:01.530034,epoch time: 0:01:29.384248,used: 0:04:32.654123,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_05_41_28_seed_1_23065779
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9498698, 'precision': 0.95338905, 'recall': 0.9492719, 'specificity': 0.9492719, 'f1': 0.94971573, 'auroc': 0.9964393, 'binary_precision': 0.91686463, 'binary_recall': 0.9910141, 'binary_specificity': 0.9075297, 'binary_f1_score': 0.95249844}
confusion matrix:
      0     1
0  1374   140
1    14  1544
---- Validation: 
scalar performance:
{'acc': 0.852459, 'precision': 0.8529043, 'recall': 0.85276496, 'specificity': 0.85276496, 'f1': 0.85245574, 'auroc': 0.9117377, 'binary_precision': 0.8356164, 'binary_recall': 0.87142855, 'binary_specificity': 0.8341014, 'binary_f1_score': 0.85314685}
confusion matrix:
     0    1
0  543  108
1   81  549
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8333333, 'precision': 0.83896434, 'recall': 0.8333334, 'specificity': 0.8333334, 'f1': 0.83263826, 'auroc': 0.9140346, 'binary_precision': 0.79527557, 'binary_recall': 0.8977778, 'binary_specificity': 0.7688889, 'binary_f1_score': 0.8434238}
confusion matrix:
     0    1
0  173   52
1   23  202
better model found
persisted
after epoch: 4,now: 2024-07-26 05:47:31.556412,epoch time: 0:01:30.026378,used: 0:06:02.680501,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_05_41_28_seed_1_23065779
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.97265625, 'precision': 0.9729737, 'recall': 0.9728534, 'specificity': 0.9728534, 'f1': 0.97265583, 'auroc': 0.99718046, 'binary_precision': 0.9887043, 'binary_recall': 0.9569132, 'binary_specificity': 0.9887937, 'binary_f1_score': 0.972549}
confusion matrix:
      0     1
0  1500    17
1    67  1488
---- Validation: 
scalar performance:
{'acc': 0.76971114, 'precision': 0.8168628, 'recall': 0.7665131, 'specificity': 0.7665131, 'f1': 0.759334, 'auroc': 0.90928483, 'binary_precision': 0.9350649, 'binary_recall': 0.5714286, 'binary_specificity': 0.96159756, 'binary_f1_score': 0.70935965}
confusion matrix:
     0    1
0  626   25
1  270  360
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7688889, 'precision': 0.81744826, 'recall': 0.7688889, 'specificity': 0.7688889, 'f1': 0.75969934, 'auroc': 0.91271114, 'binary_precision': 0.94160587, 'binary_recall': 0.5733333, 'binary_specificity': 0.96444446, 'binary_f1_score': 0.7127072}
confusion matrix:
     0    1
0  217    8
1   96  129
early stop counter: 1
val acc:0.7697111368179321, best validation acc: 0.8524590134620667, corresponding to test acc:                         0.8333333134651184 / 0.8577777743339539
after epoch: 5,now: 2024-07-26 05:49:01.078865,epoch time: 0:01:29.522453,used: 0:07:32.202954,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_05_41_28_seed_1_23065779
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9820964, 'precision': 0.9822351, 'recall': 0.98224264, 'specificity': 0.98224264, 'f1': 0.9820963, 'auroc': 0.99873376, 'binary_precision': 0.9940711, 'binary_recall': 0.97041804, 'binary_specificity': 0.99406725, 'binary_f1_score': 0.98210216}
confusion matrix:
      0     1
0  1508     9
1    46  1509
---- Validation: 
scalar performance:
{'acc': 0.6635441, 'precision': 0.76259756, 'recall': 0.65842295, 'specificity': 0.65842295, 'f1': 0.6243031, 'auroc': 0.88001853, 'binary_precision': 0.9198312, 'binary_recall': 0.34603176, 'binary_specificity': 0.9708141, 'binary_f1_score': 0.5028835}
confusion matrix:
     0    1
0  632   19
1  412  218
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8288889, 'precision': 0.8467016, 'recall': 0.8288889, 'specificity': 0.8288889, 'f1': 0.82666254, 'auroc': 0.90686417, 'binary_precision': 0.92528737, 'binary_recall': 0.71555555, 'binary_specificity': 0.94222224, 'binary_f1_score': 0.80701756}
confusion matrix:
     0    1
0  212   13
1   64  161
early stop counter: 2
val acc:0.6635441184043884, best validation acc: 0.8524590134620667, corresponding to test acc:                         0.8333333134651184 / 0.8577777743339539
after epoch: 6,now: 2024-07-26 05:50:31.456318,epoch time: 0:01:30.377453,used: 0:09:02.580407,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_05_41_28_seed_1_23065779
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9794922, 'precision': 0.97983885, 'recall': 0.9793488, 'specificity': 0.9793488, 'f1': 0.9794806, 'auroc': 0.9988406, 'binary_precision': 0.9697923, 'binary_recall': 0.9903599, 'binary_specificity': 0.9683377, 'binary_f1_score': 0.97996825}
confusion matrix:
      0     1
0  1468    48
1    15  1541
---- Validation: 
scalar performance:
{'acc': 0.80093676, 'precision': 0.8076455, 'recall': 0.79969275, 'specificity': 0.79969275, 'f1': 0.79934764, 'auroc': 0.87345964, 'binary_precision': 0.849162, 'binary_recall': 0.72380954, 'binary_specificity': 0.875576, 'binary_f1_score': 0.781491}
confusion matrix:
     0    1
0  570   81
1  174  456
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8111111, 'precision': 0.8143964, 'recall': 0.8111111, 'specificity': 0.8111111, 'f1': 0.8106164, 'auroc': 0.8986667, 'binary_precision': 0.7822581, 'binary_recall': 0.8622222, 'binary_specificity': 0.76, 'binary_f1_score': 0.82029605}
confusion matrix:
     0    1
0  171   54
1   31  194
early stop counter: 3
val acc:0.800936758518219, best validation acc: 0.8524590134620667, corresponding to test acc:                         0.8333333134651184 / 0.8577777743339539
after epoch: 7,now: 2024-07-26 05:52:01.083978,epoch time: 0:01:29.627660,used: 0:10:32.208067,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_05_41_28_seed_1_23065779
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.97753906, 'precision': 0.97816604, 'recall': 0.977784, 'specificity': 0.977784, 'f1': 0.9775371, 'auroc': 0.997699, 'binary_precision': 0.9986568, 'binary_recall': 0.95688546, 'binary_specificity': 0.9986825, 'binary_f1_score': 0.977325}
confusion matrix:
      0     1
0  1516     2
1    67  1487
---- Validation: 
scalar performance:
{'acc': 0.82045275, 'precision': 0.8356893, 'recall': 0.8186892, 'specificity': 0.8186892, 'f1': 0.817785, 'auroc': 0.89925456, 'binary_precision': 0.9032258, 'binary_recall': 0.7111111, 'binary_specificity': 0.92626727, 'binary_f1_score': 0.79573715}
confusion matrix:
     0    1
0  603   48
1  182  448
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8288889, 'precision': 0.82920754, 'recall': 0.8288889, 'specificity': 0.8288889, 'f1': 0.8288474, 'auroc': 0.89074564, 'binary_precision': 0.8189655, 'binary_recall': 0.84444445, 'binary_specificity': 0.81333333, 'binary_f1_score': 0.8315098}
confusion matrix:
     0    1
0  183   42
1   35  190
early stop counter: 4
val acc:0.8204527497291565, best validation acc: 0.8524590134620667, corresponding to test acc:                         0.8333333134651184 / 0.8577777743339539
after epoch: 8,now: 2024-07-26 05:53:30.930037,epoch time: 0:01:29.846059,used: 0:12:02.054126,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_05_41_28_seed_1_23065779
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9840495, 'precision': 0.9841043, 'recall': 0.9841697, 'specificity': 0.9841697, 'f1': 0.9840493, 'auroc': 0.998972, 'binary_precision': 0.99345124, 'binary_recall': 0.9749357, 'binary_specificity': 0.9934037, 'binary_f1_score': 0.9841064}
confusion matrix:
      0     1
0  1506    10
1    39  1517
---- Validation: 
scalar performance:
{'acc': 0.82982045, 'precision': 0.84507763, 'recall': 0.828085, 'specificity': 0.828085, 'f1': 0.82735765, 'auroc': 0.90357447, 'binary_precision': 0.9136546, 'binary_recall': 0.7222222, 'binary_specificity': 0.9339478, 'binary_f1_score': 0.8067376}
confusion matrix:
     0    1
0  608   43
1  175  455
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8666667, 'precision': 0.8786334, 'recall': 0.8666667, 'specificity': 0.8666667, 'f1': 0.86560476, 'auroc': 0.92580736, 'binary_precision': 0.9459459, 'binary_recall': 0.7777778, 'binary_specificity': 0.95555556, 'binary_f1_score': 0.85365856}
confusion matrix:
     0    1
0  215   10
1   50  175
new oracle model saved
early stop counter: 5
val acc:0.829820454120636, best validation acc: 0.8524590134620667, corresponding to test acc:                         0.8333333134651184 / 0.8666666746139526
after epoch: 9,now: 2024-07-26 05:55:01.162164,epoch time: 0:01:30.232127,used: 0:13:32.286253,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_05_41_28_seed_1_23065779
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9690755, 'precision': 0.97044754, 'recall': 0.96946454, 'specificity': 0.96946454, 'f1': 0.9690664, 'auroc': 0.9989813, 'binary_precision': 0.99931645, 'binary_recall': 0.93958867, 'binary_specificity': 0.99934036, 'binary_f1_score': 0.9685326}
confusion matrix:
      0     1
0  1515     1
1    94  1462
---- Validation: 
scalar performance:
{'acc': 0.6299766, 'precision': 0.76924074, 'recall': 0.62398875, 'specificity': 0.62398875, 'f1': 0.5692438, 'auroc': 0.8963444, 'binary_precision': 0.9588235, 'binary_recall': 0.25873017, 'binary_specificity': 0.9892473, 'binary_f1_score': 0.40750003}
confusion matrix:
     0    1
0  644    7
1  467  163
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.76, 'precision': 0.81219614, 'recall': 0.76, 'specificity': 0.76, 'f1': 0.74953103, 'auroc': 0.8870518, 'binary_precision': 0.9398496, 'binary_recall': 0.5555556, 'binary_specificity': 0.96444446, 'binary_f1_score': 0.6983241}
confusion matrix:
     0    1
0  217    8
1  100  125
early stop counter: 6
val acc:0.6299765706062317, best validation acc: 0.8524590134620667, corresponding to test acc:                         0.8333333134651184 / 0.8666666746139526
after epoch: 10,now: 2024-07-26 05:56:30.520510,epoch time: 0:01:29.358346,used: 0:15:01.644599,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_05_41_28_seed_1_23065779
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.98567706, 'precision': 0.98586136, 'recall': 0.98586136, 'specificity': 0.98586136, 'f1': 0.9856771, 'auroc': 0.9990275, 'binary_precision': 0.99933994, 'binary_recall': 0.9723828, 'binary_specificity': 0.99933994, 'binary_f1_score': 0.9856771}
confusion matrix:
      0     1
0  1514     1
1    43  1514
---- Validation: 
scalar performance:
{'acc': 0.7712724, 'precision': 0.82443964, 'recall': 0.76792115, 'specificity': 0.76792115, 'f1': 0.7599677, 'auroc': 0.91339576, 'binary_precision': 0.95174265, 'binary_recall': 0.56349206, 'binary_specificity': 0.97235024, 'binary_f1_score': 0.7078763}
confusion matrix:
     0    1
0  633   18
1  275  355
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8, 'precision': 0.85132664, 'recall': 0.79999995, 'specificity': 0.79999995, 'f1': 0.7924184, 'auroc': 0.92979753, 'binary_precision': 0.9856115, 'binary_recall': 0.60888886, 'binary_specificity': 0.9911111, 'binary_f1_score': 0.7527473}
confusion matrix:
     0    1
0  223    2
1   88  137
early stop counter: 7
val acc:0.7712724208831787, best validation acc: 0.8524590134620667, corresponding to test acc:                         0.8333333134651184 / 0.8666666746139526
after epoch: 11,now: 2024-07-26 05:58:00.618888,epoch time: 0:01:30.098378,used: 0:16:31.742977,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_05_41_28_seed_1_23065779
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9892578, 'precision': 0.98938495, 'recall': 0.9891839, 'specificity': 0.9891839, 'f1': 0.9892541, 'auroc': 0.99948573, 'binary_precision': 0.9841068, 'binary_recall': 0.9948586, 'binary_specificity': 0.98350924, 'binary_f1_score': 0.9894535}
confusion matrix:
      0     1
0  1491    25
1     8  1548
---- Validation: 
scalar performance:
{'acc': 0.8516784, 'precision': 0.85294354, 'recall': 0.8511777, 'specificity': 0.8511777, 'f1': 0.85138416, 'auroc': 0.9086119, 'binary_precision': 0.8703704, 'binary_recall': 0.8206349, 'binary_specificity': 0.8817204, 'binary_f1_score': 0.8447713}
confusion matrix:
     0    1
0  574   77
1  113  517
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.85555553, 'precision': 0.85759693, 'recall': 0.85555553, 'specificity': 0.85555553, 'f1': 0.8553492, 'auroc': 0.9165037, 'binary_precision': 0.88461536, 'binary_recall': 0.81777775, 'binary_specificity': 0.8933333, 'binary_f1_score': 0.84988457}
confusion matrix:
     0    1
0  201   24
1   41  184
early stop counter: 8
val acc:0.8516783714294434, best validation acc: 0.8524590134620667, corresponding to test acc:                         0.8333333134651184 / 0.8666666746139526
after epoch: 12,now: 2024-07-26 05:59:30.447611,epoch time: 0:01:29.828723,used: 0:18:01.571700,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_05_41_28_seed_1_23065779
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9921875, 'precision': 0.99216175, 'recall': 0.99224186, 'specificity': 0.99224186, 'f1': 0.99218667, 'auroc': 0.9995545, 'binary_precision': 0.996119, 'binary_recall': 0.9884467, 'binary_specificity': 0.996037, 'binary_f1_score': 0.992268}
confusion matrix:
      0     1
0  1508     6
1    18  1540
---- Validation: 
scalar performance:
{'acc': 0.84777516, 'precision': 0.86086994, 'recall': 0.84621096, 'specificity': 0.84621096, 'f1': 0.845935, 'auroc': 0.91170543, 'binary_precision': 0.925636, 'binary_recall': 0.75079364, 'binary_specificity': 0.9416283, 'binary_f1_score': 0.8290973}
confusion matrix:
     0    1
0  613   38
1  157  473
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8488889, 'precision': 0.86857533, 'recall': 0.8488889, 'specificity': 0.8488889, 'f1': 0.8468438, 'auroc': 0.9023803, 'binary_precision': 0.9537572, 'binary_recall': 0.73333335, 'binary_specificity': 0.96444446, 'binary_f1_score': 0.8291457}
confusion matrix:
     0    1
0  217    8
1   60  165
early stop counter: 9
val acc:0.8477751612663269, best validation acc: 0.8524590134620667, corresponding to test acc:                         0.8333333134651184 / 0.8666666746139526
after epoch: 13,now: 2024-07-26 06:01:00.805545,epoch time: 0:01:30.357934,used: 0:19:31.929634,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_05_41_28_seed_1_23065779
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.97721356, 'precision': 0.9779458, 'recall': 0.977492, 'specificity': 0.977492, 'f1': 0.9772111, 'auroc': 0.9989878, 'binary_precision': 1.0, 'binary_recall': 0.95498395, 'binary_specificity': 1.0, 'binary_f1_score': 0.9769737}
confusion matrix:
      0     1
0  1517     0
1    70  1485
---- Validation: 
scalar performance:
{'acc': 0.5948478, 'precision': 0.7505467, 'recall': 0.5882745, 'specificity': 0.5882745, 'f1': 0.5126832, 'auroc': 0.9154262, 'binary_precision': 0.944, 'binary_recall': 0.18730159, 'binary_specificity': 0.9892473, 'binary_f1_score': 0.3125828}
confusion matrix:
     0    1
0  644    7
1  512  118
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.58666664, 'precision': 0.77372265, 'recall': 0.58666664, 'specificity': 0.58666664, 'f1': 0.50150084, 'auroc': 0.8908296, 'binary_precision': 1.0, 'binary_recall': 0.17333333, 'binary_specificity': 1.0, 'binary_f1_score': 0.29545456}
confusion matrix:
     0   1
0  225   0
1  186  39
early stop counter: 10
val acc:0.5948477983474731, best validation acc: 0.8524590134620667, corresponding to test acc:                         0.8333333134651184 / 0.8666666746139526
after epoch: 14,now: 2024-07-26 06:02:30.395799,epoch time: 0:01:29.590254,used: 0:21:01.519888,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_05_41_28_seed_1_23065779
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.94140625, 'precision': 0.9469652, 'recall': 0.9421222, 'specificity': 0.9421222, 'f1': 0.9412808, 'auroc': 0.9981631, 'binary_precision': 1.0, 'binary_recall': 0.8842444, 'binary_specificity': 1.0, 'binary_f1_score': 0.9385665}
confusion matrix:
      0     1
0  1517     0
1   180  1375
---- Validation: 
scalar performance:
{'acc': 0.56518346, 'precision': 0.7394955, 'recall': 0.5580645, 'specificity': 0.5580645, 'f1': 0.45877495, 'auroc': 0.87481654, 'binary_precision': 0.939759, 'binary_recall': 0.123809524, 'binary_specificity': 0.9923195, 'binary_f1_score': 0.21879381}
confusion matrix:
     0   1
0  646   5
1  552  78
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5422222, 'precision': 0.7610209, 'recall': 0.5422222, 'specificity': 0.5422222, 'f1': 0.42085662, 'auroc': 0.8925432, 'binary_precision': 1.0, 'binary_recall': 0.08444444, 'binary_specificity': 1.0, 'binary_f1_score': 0.1557377}
confusion matrix:
     0   1
0  225   0
1  206  19
early stop counter: 11
val acc:0.5651834607124329, best validation acc: 0.8524590134620667, corresponding to test acc:                         0.8333333134651184 / 0.8666666746139526
after epoch: 15,now: 2024-07-26 06:03:59.889723,epoch time: 0:01:29.493924,used: 0:22:31.013812,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_05_41_28_seed_1_23065779
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.98535156, 'precision': 0.98563254, 'recall': 0.98523253, 'specificity': 0.98523253, 'f1': 0.9853446, 'auroc': 0.99941325, 'binary_precision': 0.9766414, 'binary_recall': 0.9948553, 'binary_specificity': 0.9756098, 'binary_f1_score': 0.9856642}
confusion matrix:
      0     1
0  1480    37
1     8  1547
---- Validation: 
scalar performance:
{'acc': 0.86885244, 'precision': 0.86993736, 'recall': 0.8684076, 'specificity': 0.8684076, 'f1': 0.8686276, 'auroc': 0.9216151, 'binary_precision': 0.8862876, 'binary_recall': 0.84126985, 'binary_specificity': 0.8955453, 'binary_f1_score': 0.86319226}
confusion matrix:
     0    1
0  583   68
1  100  530
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8377778, 'precision': 0.8381051, 'recall': 0.8377778, 'specificity': 0.8377778, 'f1': 0.8377385, 'auroc': 0.91527903, 'binary_precision': 0.8486239, 'binary_recall': 0.82222223, 'binary_specificity': 0.85333335, 'binary_f1_score': 0.8352145}
confusion matrix:
     0    1
0  192   33
1   40  185
better model found
persisted
after epoch: 16,now: 2024-07-26 06:05:29.553539,epoch time: 0:01:29.663816,used: 0:24:00.677628,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_05_41_28_seed_1_23065779
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.992513, 'precision': 0.992513, 'recall': 0.9926051, 'specificity': 0.9926051, 'f1': 0.99251264, 'auroc': 0.9998639, 'binary_precision': 0.99934894, 'binary_recall': 0.98587024, 'binary_specificity': 0.99933994, 'binary_f1_score': 0.9925638}
confusion matrix:
      0     1
0  1514     1
1    22  1535
---- Validation: 
scalar performance:
{'acc': 0.72521466, 'precision': 0.8024736, 'recall': 0.7210189, 'specificity': 0.7210189, 'f1': 0.70399237, 'auroc': 0.90540135, 'binary_precision': 0.9512987, 'binary_recall': 0.46507937, 'binary_specificity': 0.9769585, 'binary_f1_score': 0.6247335}
confusion matrix:
     0    1
0  636   15
1  337  293
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.79555553, 'precision': 0.8461218, 'recall': 0.7955556, 'specificity': 0.7955556, 'f1': 0.78780544, 'auroc': 0.91768885, 'binary_precision': 0.9784173, 'binary_recall': 0.60444444, 'binary_specificity': 0.9866667, 'binary_f1_score': 0.74725276}
confusion matrix:
     0    1
0  222    3
1   89  136
early stop counter: 1
val acc:0.7252146601676941, best validation acc: 0.868852436542511, corresponding to test acc:                         0.8377777934074402 / 0.8666666746139526
after epoch: 17,now: 2024-07-26 06:06:59.212799,epoch time: 0:01:29.659260,used: 0:25:30.336888,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_05_41_28_seed_1_23065779
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.99283856, 'precision': 0.9929122, 'recall': 0.9927918, 'specificity': 0.9927918, 'f1': 0.99283683, 'auroc': 0.9996872, 'binary_precision': 0.9891443, 'binary_recall': 0.9967825, 'binary_specificity': 0.98880106, 'binary_f1_score': 0.9929487}
confusion matrix:
      0     1
0  1501    17
1     5  1549
---- Validation: 
scalar performance:
{'acc': 0.78688526, 'precision': 0.8111503, 'recall': 0.78456223, 'specificity': 0.78456223, 'f1': 0.7816691, 'auroc': 0.8985827, 'binary_precision': 0.89403975, 'binary_recall': 0.64285713, 'binary_specificity': 0.92626727, 'binary_f1_score': 0.74792236}
confusion matrix:
     0    1
0  603   48
1  225  405
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8088889, 'precision': 0.8152658, 'recall': 0.8088889, 'specificity': 0.8088889, 'f1': 0.80791754, 'auroc': 0.8850963, 'binary_precision': 0.8601036, 'binary_recall': 0.73777777, 'binary_specificity': 0.88, 'binary_f1_score': 0.79425836}
confusion matrix:
     0    1
0  198   27
1   59  166
early stop counter: 2
val acc:0.7868852615356445, best validation acc: 0.868852436542511, corresponding to test acc:                         0.8377777934074402 / 0.8666666746139526
after epoch: 18,now: 2024-07-26 06:08:29.323027,epoch time: 0:01:30.110228,used: 0:27:00.447116,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_05_41_28_seed_1_23065779
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9847005, 'precision': 0.98506606, 'recall': 0.9845435, 'specificity': 0.9845435, 'f1': 0.9846909, 'auroc': 0.99958116, 'binary_precision': 0.9748586, 'binary_recall': 0.99550706, 'binary_specificity': 0.97357994, 'binary_f1_score': 0.98507464}
confusion matrix:
      0     1
0  1474    40
1     7  1551
---- Validation: 
scalar performance:
{'acc': 0.8618267, 'precision': 0.86645496, 'recall': 0.8609063, 'specificity': 0.8609063, 'f1': 0.8611413, 'auroc': 0.9185606, 'binary_precision': 0.9037433, 'binary_recall': 0.8047619, 'binary_specificity': 0.9170507, 'binary_f1_score': 0.8513854}
confusion matrix:
     0    1
0  597   54
1  123  507
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8288889, 'precision': 0.8288954, 'recall': 0.8288889, 'specificity': 0.8288889, 'f1': 0.82888806, 'auroc': 0.91618764, 'binary_precision': 0.82743365, 'binary_recall': 0.83111113, 'binary_specificity': 0.82666665, 'binary_f1_score': 0.8292683}
confusion matrix:
     0    1
0  186   39
1   38  187
early stop counter: 3
val acc:0.8618267178535461, best validation acc: 0.868852436542511, corresponding to test acc:                         0.8377777934074402 / 0.8666666746139526
after epoch: 19,now: 2024-07-26 06:09:59.736490,epoch time: 0:01:30.413463,used: 0:28:30.860579,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_05_41_28_seed_1_23065779
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.98567706, 'precision': 0.98580503, 'recall': 0.9858199, 'specificity': 0.9858199, 'f1': 0.985677, 'auroc': 0.99926573, 'binary_precision': 0.99736667, 'binary_recall': 0.97427654, 'binary_specificity': 0.9973632, 'binary_f1_score': 0.98568636}
confusion matrix:
      0     1
0  1513     4
1    40  1515
---- Validation: 
scalar performance:
{'acc': 0.6487119, 'precision': 0.77148473, 'recall': 0.64311314, 'specificity': 0.64311314, 'f1': 0.5990081, 'auroc': 0.9219339, 'binary_precision': 0.95, 'binary_recall': 0.3015873, 'binary_specificity': 0.984639, 'binary_f1_score': 0.45783132}
confusion matrix:
     0    1
0  641   10
1  440  190
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6155556, 'precision': 0.78266335, 'recall': 0.6155555, 'specificity': 0.6155555, 'f1': 0.5488813, 'auroc': 0.92691356, 'binary_precision': 1.0, 'binary_recall': 0.23111111, 'binary_specificity': 1.0, 'binary_f1_score': 0.37545127}
confusion matrix:
     0   1
0  225   0
1  173  52
early stop counter: 4
val acc:0.6487119197845459, best validation acc: 0.868852436542511, corresponding to test acc:                         0.8377777934074402 / 0.8666666746139526
after epoch: 20,now: 2024-07-26 06:11:30.880836,epoch time: 0:01:31.144346,used: 0:30:02.004925,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_05_41_28_seed_1_23065779
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.99121094, 'precision': 0.991215, 'recall': 0.9912822, 'specificity': 0.9912822, 'f1': 0.9912107, 'auroc': 0.9995817, 'binary_precision': 0.99739414, 'binary_recall': 0.9851995, 'binary_specificity': 0.99736494, 'binary_f1_score': 0.99125934}
confusion matrix:
      0     1
0  1514     4
1    23  1531
---- Validation: 
scalar performance:
{'acc': 0.8056206, 'precision': 0.8399857, 'recall': 0.8029954, 'specificity': 0.8029954, 'f1': 0.7996019, 'auroc': 0.91789186, 'binary_precision': 0.9440559, 'binary_recall': 0.64285713, 'binary_specificity': 0.96313363, 'binary_f1_score': 0.76487243}
confusion matrix:
     0    1
0  627   24
1  225  405
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8, 'precision': 0.840978, 'recall': 0.8, 'specificity': 0.8, 'f1': 0.793805, 'auroc': 0.9084642, 'binary_precision': 0.9591837, 'binary_recall': 0.62666667, 'binary_specificity': 0.97333336, 'binary_f1_score': 0.75806457}
confusion matrix:
     0    1
0  219    6
1   84  141
early stop counter: 5
val acc:0.8056206107139587, best validation acc: 0.868852436542511, corresponding to test acc:                         0.8377777934074402 / 0.8666666746139526
after epoch: 21,now: 2024-07-26 06:13:01.199223,epoch time: 0:01:30.318387,used: 0:31:32.323312,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_05_41_28_seed_1_23065779
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9947917, 'precision': 0.9948343, 'recall': 0.9947604, 'specificity': 0.9947604, 'f1': 0.99479055, 'auroc': 0.99989355, 'binary_precision': 0.99231756, 'binary_recall': 0.997426, 'binary_specificity': 0.9920949, 'binary_f1_score': 0.99486524}
confusion matrix:
      0     1
0  1506    12
1     4  1550
---- Validation: 
scalar performance:
{'acc': 0.8844653, 'precision': 0.8862199, 'recall': 0.8839222, 'specificity': 0.8839222, 'f1': 0.8842027, 'auroc': 0.9293517, 'binary_precision': 0.90847456, 'binary_recall': 0.85079366, 'binary_specificity': 0.9170507, 'binary_f1_score': 0.8786885}
confusion matrix:
     0    1
0  597   54
1   94  536
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.85333335, 'precision': 0.85560924, 'recall': 0.85333335, 'specificity': 0.85333335, 'f1': 0.8530983, 'auroc': 0.90068144, 'binary_precision': 0.884058, 'binary_recall': 0.81333333, 'binary_specificity': 0.8933333, 'binary_f1_score': 0.84722227}
confusion matrix:
     0    1
0  201   24
1   42  183
better model found
persisted
after epoch: 22,now: 2024-07-26 06:14:32.428496,epoch time: 0:01:31.229273,used: 0:33:03.552585,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_05_41_28_seed_1_23065779
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.99088544, 'precision': 0.99089205, 'recall': 0.9908771, 'specificity': 0.9908771, 'f1': 0.9908842, 'auroc': 0.9996295, 'binary_precision': 0.9903537, 'binary_recall': 0.9916291, 'binary_specificity': 0.99012506, 'binary_f1_score': 0.990991}
confusion matrix:
      0     1
0  1504    15
1    13  1540
---- Validation: 
scalar performance:
{'acc': 0.74395, 'precision': 0.80675596, 'recall': 0.74019456, 'specificity': 0.74019456, 'f1': 0.72813106, 'auroc': 0.90071625, 'binary_precision': 0.94152045, 'binary_recall': 0.51111114, 'binary_specificity': 0.96927804, 'binary_f1_score': 0.66255146}
confusion matrix:
     0    1
0  631   20
1  308  322
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.70444447, 'precision': 0.7465695, 'recall': 0.70444447, 'specificity': 0.70444447, 'f1': 0.6912577, 'auroc': 0.8523259, 'binary_precision': 0.8484849, 'binary_recall': 0.4977778, 'binary_specificity': 0.9111111, 'binary_f1_score': 0.627451}
confusion matrix:
     0    1
0  205   20
1  113  112
early stop counter: 1
val acc:0.7439500093460083, best validation acc: 0.8844652771949768, corresponding to test acc:                         0.8533333539962769 / 0.8666666746139526
after epoch: 23,now: 2024-07-26 06:16:02.128874,epoch time: 0:01:29.700378,used: 0:34:33.252963,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_05_41_28_seed_1_23065779
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9902344, 'precision': 0.9903305, 'recall': 0.99017334, 'specificity': 0.99017334, 'f1': 0.9902314, 'auroc': 0.99959815, 'binary_precision': 0.98598725, 'binary_recall': 0.9948586, 'binary_specificity': 0.9854881, 'binary_f1_score': 0.99040306}
confusion matrix:
      0     1
0  1494    22
1     8  1548
---- Validation: 
scalar performance:
{'acc': 0.8704137, 'precision': 0.8828504, 'recall': 0.86894524, 'specificity': 0.86894524, 'f1': 0.8690016, 'auroc': 0.9254962, 'binary_precision': 0.94787645, 'binary_recall': 0.77936506, 'binary_specificity': 0.95852536, 'binary_f1_score': 0.85540074}
confusion matrix:
     0    1
0  624   27
1  139  491
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8377778, 'precision': 0.8706433, 'recall': 0.8377778, 'specificity': 0.8377778, 'f1': 0.8341001, 'auroc': 0.93530864, 'binary_precision': 0.98101264, 'binary_recall': 0.6888889, 'binary_specificity': 0.9866667, 'binary_f1_score': 0.8093995}
confusion matrix:
     0    1
0  222    3
1   70  155
early stop counter: 2
val acc:0.8704137206077576, best validation acc: 0.8844652771949768, corresponding to test acc:                         0.8533333539962769 / 0.8666666746139526
after epoch: 24,now: 2024-07-26 06:17:32.483669,epoch time: 0:01:30.354795,used: 0:36:03.607758,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_05_41_28_seed_1_23065779
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.9860026, 'precision': 0.9861011, 'recall': 0.98594344, 'specificity': 0.98594344, 'f1': 0.98599875, 'auroc': 0.9993056, 'binary_precision': 0.9815169, 'binary_recall': 0.990991, 'binary_specificity': 0.98089594, 'binary_f1_score': 0.9862312}
confusion matrix:
      0     1
0  1489    29
1    14  1540
---- Validation: 
scalar performance:
{'acc': 0.85323966, 'precision': 0.8552812, 'recall': 0.85261136, 'specificity': 0.85261136, 'f1': 0.8528371, 'auroc': 0.90526175, 'binary_precision': 0.87842464, 'binary_recall': 0.8142857, 'binary_specificity': 0.89093703, 'binary_f1_score': 0.84514}
confusion matrix:
     0    1
0  580   71
1  117  513
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8155556, 'precision': 0.81606126, 'recall': 0.8155556, 'specificity': 0.8155556, 'f1': 0.8154817, 'auroc': 0.8929235, 'binary_precision': 0.8034188, 'binary_recall': 0.83555555, 'binary_specificity': 0.79555553, 'binary_f1_score': 0.8191721}
confusion matrix:
     0    1
0  179   46
1   37  188
early stop counter: 3
val acc:0.8532396554946899, best validation acc: 0.8844652771949768, corresponding to test acc:                         0.8533333539962769 / 0.8666666746139526
after epoch: 25,now: 2024-07-26 06:19:02.079865,epoch time: 0:01:29.596196,used: 0:37:33.203954,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_05_41_28_seed_1_23065779
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9785156, 'precision': 0.97925377, 'recall': 0.97830296, 'specificity': 0.97830296, 'f1': 0.97849715, 'auroc': 0.99930775, 'binary_precision': 0.9632856, 'binary_recall': 0.9954984, 'binary_specificity': 0.96110743, 'binary_f1_score': 0.9791271}
confusion matrix:
      0     1
0  1458    59
1     7  1548
---- Validation: 
scalar performance:
{'acc': 0.8844653, 'precision': 0.8845969, 'recall': 0.8843062, 'specificity': 0.8843062, 'f1': 0.8843976, 'auroc': 0.9319295, 'binary_precision': 0.88870966, 'binary_recall': 0.87460315, 'binary_specificity': 0.89400923, 'binary_f1_score': 0.8816}
confusion matrix:
     0    1
0  582   69
1   79  551
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.84, 'precision': 0.84219, 'recall': 0.84000003, 'specificity': 0.84000003, 'f1': 0.8397436, 'auroc': 0.9311012, 'binary_precision': 0.8148148, 'binary_recall': 0.88, 'binary_specificity': 0.8, 'binary_f1_score': 0.84615386}
confusion matrix:
     0    1
0  180   45
1   27  198
early stop counter: 4
val acc:0.8844652771949768, best validation acc: 0.8844652771949768, corresponding to test acc:                         0.8533333539962769 / 0.8666666746139526
after epoch: 26,now: 2024-07-26 06:20:31.443380,epoch time: 0:01:29.363515,used: 0:39:02.567469,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_05_41_28_seed_1_23065779
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.97753906, 'precision': 0.978179, 'recall': 0.9777705, 'specificity': 0.9777705, 'f1': 0.9775368, 'auroc': 0.9995193, 'binary_precision': 0.9986559, 'binary_recall': 0.9568577, 'binary_specificity': 0.99868333, 'binary_f1_score': 0.9773101}
confusion matrix:
      0     1
0  1517     2
1    67  1486
---- Validation: 
scalar performance:
{'acc': 0.64090556, 'precision': 0.7769651, 'recall': 0.63507426, 'specificity': 0.63507426, 'f1': 0.58532023, 'auroc': 0.91820157, 'binary_precision': 0.96703297, 'binary_recall': 0.2793651, 'binary_specificity': 0.9907834, 'binary_f1_score': 0.43349755}
confusion matrix:
     0    1
0  645    6
1  454  176
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6911111, 'precision': 0.80906594, 'recall': 0.6911111, 'specificity': 0.6911111, 'f1': 0.6585307, 'auroc': 0.9316691, 'binary_precision': 1.0, 'binary_recall': 0.38222224, 'binary_specificity': 1.0, 'binary_f1_score': 0.5530547}
confusion matrix:
     0   1
0  225   0
1  139  86
early stop counter: 5
val acc:0.6409055590629578, best validation acc: 0.8844652771949768, corresponding to test acc:                         0.8533333539962769 / 0.8666666746139526
after epoch: 27,now: 2024-07-26 06:22:01.719849,epoch time: 0:01:30.276469,used: 0:40:32.843938,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_05_41_28_seed_1_23065779
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.99348956, 'precision': 0.9934976, 'recall': 0.99348, 'specificity': 0.99348, 'f1': 0.9934884, 'auroc': 0.9995587, 'binary_precision': 0.99293965, 'binary_recall': 0.99421597, 'binary_specificity': 0.9927441, 'binary_f1_score': 0.99357736}
confusion matrix:
      0     1
0  1505    11
1     9  1547
---- Validation: 
scalar performance:
{'acc': 0.8868072, 'precision': 0.8892081, 'recall': 0.88617516, 'specificity': 0.88617516, 'f1': 0.88648725, 'auroc': 0.9286494, 'binary_precision': 0.91595197, 'binary_recall': 0.84761906, 'binary_specificity': 0.9247312, 'binary_f1_score': 0.88046163}
confusion matrix:
     0    1
0  602   49
1   96  534
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8622222, 'precision': 0.86639094, 'recall': 0.8622222, 'specificity': 0.8622222, 'f1': 0.86182916, 'auroc': 0.91038024, 'binary_precision': 0.90547264, 'binary_recall': 0.8088889, 'binary_specificity': 0.91555554, 'binary_f1_score': 0.8544601}
confusion matrix:
     0    1
0  206   19
1   43  182
better model found
persisted
after epoch: 28,now: 2024-07-26 06:23:31.728044,epoch time: 0:01:30.008195,used: 0:42:02.852133,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_05_41_28_seed_1_23065779
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9902344, 'precision': 0.9902874, 'recall': 0.99034566, 'specificity': 0.99034566, 'f1': 0.9902343, 'auroc': 0.99991053, 'binary_precision': 0.9993451, 'binary_recall': 0.9813505, 'binary_specificity': 0.99934083, 'binary_f1_score': 0.9902661}
confusion matrix:
      0     1
0  1516     1
1    29  1526
---- Validation: 
scalar performance:
{'acc': 0.6401249, 'precision': 0.76935446, 'recall': 0.6343574, 'specificity': 0.6343574, 'f1': 0.5857786, 'auroc': 0.9245806, 'binary_precision': 0.95187163, 'binary_recall': 0.2825397, 'binary_specificity': 0.9861751, 'binary_f1_score': 0.43574053}
confusion matrix:
     0    1
0  642    9
1  452  178
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5977778, 'precision': 0.7475, 'recall': 0.5977778, 'specificity': 0.5977778, 'f1': 0.5261091, 'auroc': 0.9128889, 'binary_precision': 0.94, 'binary_recall': 0.20888889, 'binary_specificity': 0.9866667, 'binary_f1_score': 0.34181818}
confusion matrix:
     0   1
0  222   3
1  178  47
early stop counter: 1
val acc:0.6401249170303345, best validation acc: 0.8868072032928467, corresponding to test acc:                         0.8622221946716309 / 0.8666666746139526
after epoch: 29,now: 2024-07-26 06:25:02.392247,epoch time: 0:01:30.664203,used: 0:43:33.516336,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_05_41_28_seed_1_23065779
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.9947917, 'precision': 0.99479926, 'recall': 0.9947833, 'specificity': 0.9947833, 'f1': 0.9947908, 'auroc': 0.9997134, 'binary_precision': 0.99421597, 'binary_recall': 0.9954955, 'binary_specificity': 0.9940711, 'binary_f1_score': 0.9948553}
confusion matrix:
      0     1
0  1509     9
1     7  1547
---- Validation: 
scalar performance:
{'acc': 0.83684623, 'precision': 0.8490459, 'recall': 0.8353046, 'specificity': 0.8353046, 'f1': 0.83493054, 'auroc': 0.91733533, 'binary_precision': 0.91033137, 'binary_recall': 0.7412698, 'binary_specificity': 0.92933947, 'binary_f1_score': 0.81714785}
confusion matrix:
     0    1
0  605   46
1  163  467
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.83111113, 'precision': 0.8349218, 'recall': 0.8311111, 'specificity': 0.8311111, 'f1': 0.83062935, 'auroc': 0.8949926, 'binary_precision': 0.8706468, 'binary_recall': 0.7777778, 'binary_specificity': 0.8844444, 'binary_f1_score': 0.82159626}
confusion matrix:
     0    1
0  199   26
1   50  175
early stop counter: 2
val acc:0.8368462324142456, best validation acc: 0.8868072032928467, corresponding to test acc:                         0.8622221946716309 / 0.8666666746139526
after epoch: 30,now: 2024-07-26 06:26:31.840404,epoch time: 0:01:29.448157,used: 0:45:02.964493,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_05_41_28_seed_1_23065779
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 0:45:02.964493 at 2024-07-26 06:26:31.840404
persisted model performance metric: 

scalar performance:
{'acc': 0.8622222, 'precision': 0.86639094, 'recall': 0.8622222, 'specificity': 0.8622222, 'f1': 0.86182916, 'auroc': 0.91038024, 'binary_precision': 0.90547264, 'binary_recall': 0.8088889, 'binary_specificity': 0.91555554, 'binary_f1_score': 0.8544601}
confusion matrix:
     0    1
0  206   19
1   43  182
oracle model performance metric: 

scalar performance:
{'acc': 0.8666667, 'precision': 0.8786334, 'recall': 0.8666667, 'specificity': 0.8666667, 'f1': 0.86560476, 'auroc': 0.92580736, 'binary_precision': 0.9459459, 'binary_recall': 0.7777778, 'binary_specificity': 0.95555556, 'binary_f1_score': 0.85365856}
confusion matrix:
     0    1
0  215   10
1   50  175
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_irm_10seeds_nofreeze_2024-07-26_02-28-54/rule_results/0.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_irm_10seeds_nofreeze_2024-07-26_02-28-54/confusion_matrix/0.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 455402 KiB |  13219 MiB | 148251 GiB | 148251 GiB |
|       from large pool | 414803 KiB |  13181 MiB | 146495 GiB | 146494 GiB |
|       from small pool |  40598 KiB |     60 MiB |   1756 GiB |   1756 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 455402 KiB |  13219 MiB | 148251 GiB | 148251 GiB |
|       from large pool | 414803 KiB |  13181 MiB | 146495 GiB | 146494 GiB |
|       from small pool |  40598 KiB |     60 MiB |   1756 GiB |   1756 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 447481 KiB |  13213 MiB | 147702 GiB | 147702 GiB |
|       from large pool | 407075 KiB |  13175 MiB | 145949 GiB | 145948 GiB |
|       from small pool |  40406 KiB |     60 MiB |   1753 GiB |   1753 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  14482 MiB |  14482 MiB |  28046 MiB |  13564 MiB |
|       from large pool |  14412 MiB |  14412 MiB |  27960 MiB |  13548 MiB |
|       from small pool |     70 MiB |     70 MiB |     86 MiB |     16 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 445718 KiB |   1236 MiB | 103958 GiB | 103957 GiB |
|       from large pool | 435116 KiB |   1229 MiB | 102190 GiB | 102190 GiB |
|       from small pool |  10601 KiB |     43 MiB |   1767 GiB |   1767 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    1310    |    2598    |   26107 K  |   26106 K  |
|       from large pool |     187    |    1413    |   13296 K  |   13296 K  |
|       from small pool |    1123    |    1419    |   12810 K  |   12809 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    1310    |    2598    |   26107 K  |   26106 K  |
|       from large pool |     187    |    1413    |   13296 K  |   13296 K  |
|       from small pool |    1123    |    1419    |   12810 K  |   12809 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     637    |     637    |    1208    |     571    |
|       from large pool |     602    |     602    |    1165    |     563    |
|       from small pool |      35    |      35    |      43    |       8    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      95    |     650    |   18160 K  |   18160 K  |
|       from large pool |      38    |     605    |   10485 K  |   10485 K  |
|       from small pool |      57    |     236    |    7675 K  |    7675 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13219 MiB | 148251 GiB | 148251 GiB |
|       from large pool |  16640 KiB |  13181 MiB | 146495 GiB | 146495 GiB |
|       from small pool |      0 KiB |     60 MiB |   1756 GiB |   1756 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13219 MiB | 148251 GiB | 148251 GiB |
|       from large pool |  16640 KiB |  13181 MiB | 146495 GiB | 146495 GiB |
|       from small pool |      0 KiB |     60 MiB |   1756 GiB |   1756 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13213 MiB | 147702 GiB | 147702 GiB |
|       from large pool |  16640 KiB |  13175 MiB | 145949 GiB | 145949 GiB |
|       from small pool |      0 KiB |     60 MiB |   1753 GiB |   1753 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    880 MiB |  14482 MiB |  28046 MiB |  27166 MiB |
|       from large pool |    830 MiB |  14412 MiB |  27960 MiB |  27130 MiB |
|       from small pool |     50 MiB |     70 MiB |     86 MiB |     36 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1236 MiB | 103958 GiB | 103958 GiB |
|       from large pool |  24320 KiB |   1229 MiB | 102191 GiB | 102191 GiB |
|       from small pool |      0 KiB |     43 MiB |   1767 GiB |   1767 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    2598    |   26107 K  |   26107 K  |
|       from large pool |       2    |    1413    |   13296 K  |   13296 K  |
|       from small pool |       0    |    1419    |   12810 K  |   12810 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    2598    |   26107 K  |   26107 K  |
|       from large pool |       2    |    1413    |   13296 K  |   13296 K  |
|       from small pool |       0    |    1419    |   12810 K  |   12810 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      62    |     637    |    1208    |    1146    |
|       from large pool |      37    |     602    |    1165    |    1128    |
|       from small pool |      25    |      35    |      43    |      18    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |     650    |   18160 K  |   18160 K  |
|       from large pool |       4    |     605    |   10485 K  |   10485 K  |
|       from small pool |       0    |     236    |    7675 K  |    7675 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13219 MiB | 148251 GiB | 148251 GiB |
|       from large pool |  16640 KiB |  13181 MiB | 146495 GiB | 146495 GiB |
|       from small pool |      0 KiB |     60 MiB |   1756 GiB |   1756 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13219 MiB | 148251 GiB | 148251 GiB |
|       from large pool |  16640 KiB |  13181 MiB | 146495 GiB | 146495 GiB |
|       from small pool |      0 KiB |     60 MiB |   1756 GiB |   1756 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13213 MiB | 147702 GiB | 147702 GiB |
|       from large pool |  16640 KiB |  13175 MiB | 145949 GiB | 145949 GiB |
|       from small pool |      0 KiB |     60 MiB |   1753 GiB |   1753 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    880 MiB |  14482 MiB |  28046 MiB |  27166 MiB |
|       from large pool |    830 MiB |  14412 MiB |  27960 MiB |  27130 MiB |
|       from small pool |     50 MiB |     70 MiB |     86 MiB |     36 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1236 MiB | 103958 GiB | 103958 GiB |
|       from large pool |  24320 KiB |   1229 MiB | 102191 GiB | 102191 GiB |
|       from small pool |      0 KiB |     43 MiB |   1767 GiB |   1767 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    2598    |   26107 K  |   26107 K  |
|       from large pool |       2    |    1413    |   13296 K  |   13296 K  |
|       from small pool |       0    |    1419    |   12810 K  |   12810 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    2598    |   26107 K  |   26107 K  |
|       from large pool |       2    |    1413    |   13296 K  |   13296 K  |
|       from small pool |       0    |    1419    |   12810 K  |   12810 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      62    |     637    |    1208    |    1146    |
|       from large pool |      37    |     602    |    1165    |    1128    |
|       from small pool |      25    |      35    |      43    |      18    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |     650    |   18160 K  |   18160 K  |
|       from large pool |       4    |     605    |   10485 K  |   10485 K  |
|       from small pool |       0    |     236    |    7675 K  |    7675 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'888c1ef2'
model name: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_06_26_59_seed_2_23065779

 Experiment start at: 2024-07-26 06:26:59.535055
before training, model accuracy: 0.41203704476356506
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.934555, 'precision': 0.93941414, 'recall': 0.93497753, 'specificity': 0.93497753, 'f1': 0.9344134, 'auroc': 0.9875647, 'binary_precision': 0.9876274, 'binary_recall': 0.88116884, 'binary_specificity': 0.9887863, 'binary_f1_score': 0.93136585}
confusion matrix:
      0     1
0  1499    17
1   183  1357
---- Validation: 
scalar performance:
{'acc': 0.80359936, 'precision': 0.8038135, 'recall': 0.80398107, 'specificity': 0.80398107, 'f1': 0.8035897, 'auroc': 0.885607, 'binary_precision': 0.7867079, 'binary_recall': 0.81832796, 'binary_specificity': 0.78963417, 'binary_f1_score': 0.8022065}
confusion matrix:
     0    1
0  518  138
1  113  509
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7569444, 'precision': 0.7792128, 'recall': 0.7569444, 'specificity': 0.7569444, 'f1': 0.75199974, 'auroc': 0.90239197, 'binary_precision': 0.700361, 'binary_recall': 0.8981481, 'binary_specificity': 0.6157407, 'binary_f1_score': 0.78701824}
confusion matrix:
     0    1
0  133   83
1   22  194
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-26 06:28:31.540051,epoch time: 0:01:32.004996,used: 0:01:32.004996,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_06_26_59_seed_2_23065779
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.97218585, 'precision': 0.9721954, 'recall': 0.9722227, 'specificity': 0.9722227, 'f1': 0.9721856, 'auroc': 0.99569786, 'binary_precision': 0.9770492, 'binary_recall': 0.96753246, 'binary_specificity': 0.9769129, 'binary_f1_score': 0.97226757}
confusion matrix:
      0     1
0  1481    35
1    50  1490
---- Validation: 
scalar performance:
{'acc': 0.80594677, 'precision': 0.80981624, 'recall': 0.8073926, 'specificity': 0.8073926, 'f1': 0.805737, 'auroc': 0.8865408, 'binary_precision': 0.76790833, 'binary_recall': 0.86173636, 'binary_specificity': 0.7530488, 'binary_f1_score': 0.8121213}
confusion matrix:
     0    1
0  494  162
1   86  536
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7106481, 'precision': 0.76386017, 'recall': 0.7106482, 'specificity': 0.7106482, 'f1': 0.69528544, 'auroc': 0.9140947, 'binary_precision': 0.6453674, 'binary_recall': 0.9351852, 'binary_specificity': 0.4861111, 'binary_f1_score': 0.76370513}
confusion matrix:
     0    1
0  105  111
1   14  202
better model found
persisted
after epoch: 2,now: 2024-07-26 06:29:59.684396,epoch time: 0:01:28.144345,used: 0:03:00.149341,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_06_26_59_seed_2_23065779
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9816754, 'precision': 0.9816754, 'recall': 0.98170507, 'specificity': 0.98170507, 'f1': 0.98167515, 'auroc': 0.9977251, 'binary_precision': 0.9856021, 'binary_recall': 0.9779221, 'binary_specificity': 0.9854881, 'binary_f1_score': 0.9817471}
confusion matrix:
      0     1
0  1494    22
1    34  1506
---- Validation: 
scalar performance:
{'acc': 0.8169014, 'precision': 0.81730336, 'recall': 0.81739664, 'specificity': 0.81739664, 'f1': 0.8168996, 'auroc': 0.8923001, 'binary_precision': 0.797546, 'binary_recall': 0.83601284, 'binary_specificity': 0.7987805, 'binary_f1_score': 0.8163265}
confusion matrix:
     0    1
0  524  132
1  102  520
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8287037, 'precision': 0.84161985, 'recall': 0.8287037, 'specificity': 0.8287037, 'f1': 0.8270691, 'auroc': 0.93855023, 'binary_precision': 0.7751938, 'binary_recall': 0.9259259, 'binary_specificity': 0.7314815, 'binary_f1_score': 0.84388185}
confusion matrix:
     0    1
0  158   58
1   16  200
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-07-26 06:31:27.668800,epoch time: 0:01:27.984404,used: 0:04:28.133745,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_06_26_59_seed_2_23065779
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.97022253, 'precision': 0.97161806, 'recall': 0.9704494, 'specificity': 0.9704494, 'f1': 0.970209, 'auroc': 0.9984417, 'binary_precision': 0.9993108, 'binary_recall': 0.9415584, 'binary_specificity': 0.99934036, 'binary_f1_score': 0.9695754}
confusion matrix:
      0     1
0  1515     1
1    90  1450
---- Validation: 
scalar performance:
{'acc': 0.64162755, 'precision': 0.7509184, 'recall': 0.6325828, 'specificity': 0.6325828, 'f1': 0.5893466, 'auroc': 0.8811686, 'binary_precision': 0.91, 'binary_recall': 0.2926045, 'binary_specificity': 0.972561, 'binary_f1_score': 0.44282237}
confusion matrix:
     0    1
0  638   18
1  440  182
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7893519, 'precision': 0.8423702, 'recall': 0.7893518, 'specificity': 0.7893518, 'f1': 0.7808683, 'auroc': 0.9055426, 'binary_precision': 0.97709924, 'binary_recall': 0.5925926, 'binary_specificity': 0.9861111, 'binary_f1_score': 0.7377521}
confusion matrix:
     0    1
0  213    3
1   88  128
early stop counter: 1
val acc:0.6416275501251221, best validation acc: 0.8169013857841492, corresponding to test acc:                         0.8287037014961243 / 0.8287037014961243
after epoch: 4,now: 2024-07-26 06:32:55.977491,epoch time: 0:01:28.308691,used: 0:05:56.442436,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_06_26_59_seed_2_23065779
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9826571, 'precision': 0.9827073, 'recall': 0.98262775, 'specificity': 0.98262775, 'f1': 0.98265475, 'auroc': 0.99866873, 'binary_precision': 0.97936815, 'binary_recall': 0.98636365, 'binary_specificity': 0.97889185, 'binary_f1_score': 0.9828534}
confusion matrix:
      0     1
0  1484    32
1    21  1519
---- Validation: 
scalar performance:
{'acc': 0.8239437, 'precision': 0.8331962, 'recall': 0.8216733, 'specificity': 0.8216733, 'f1': 0.821897, 'auroc': 0.88413405, 'binary_precision': 0.88246626, 'binary_recall': 0.7363344, 'binary_specificity': 0.9070122, 'binary_f1_score': 0.8028045}
confusion matrix:
     0    1
0  595   61
1  164  458
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8425926, 'precision': 0.84933126, 'recall': 0.8425926, 'specificity': 0.8425926, 'f1': 0.8418298, 'auroc': 0.9107296, 'binary_precision': 0.89784944, 'binary_recall': 0.7731481, 'binary_specificity': 0.912037, 'binary_f1_score': 0.8308457}
confusion matrix:
     0    1
0  197   19
1   49  167
new oracle model saved
better model found
persisted
after epoch: 5,now: 2024-07-26 06:34:23.578660,epoch time: 0:01:27.601169,used: 0:07:24.043605,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_06_26_59_seed_2_23065779
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9859293, 'precision': 0.9861237, 'recall': 0.98602355, 'specificity': 0.98602355, 'f1': 0.98592913, 'auroc': 0.9984212, 'binary_precision': 0.998004, 'binary_recall': 0.97402596, 'binary_specificity': 0.9980211, 'binary_f1_score': 0.9858693}
confusion matrix:
      0     1
0  1513     3
1    40  1500
---- Validation: 
scalar performance:
{'acc': 0.68701094, 'precision': 0.78100395, 'recall': 0.6791232, 'specificity': 0.6791232, 'f1': 0.6526419, 'auroc': 0.8638171, 'binary_precision': 0.93700784, 'binary_recall': 0.38263667, 'binary_specificity': 0.9756098, 'binary_f1_score': 0.543379}
confusion matrix:
     0    1
0  640   16
1  384  238
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7662037, 'precision': 0.8149806, 'recall': 0.7662037, 'specificity': 0.7662037, 'f1': 0.7567879, 'auroc': 0.8872385, 'binary_precision': 0.9389313, 'binary_recall': 0.5694444, 'binary_specificity': 0.962963, 'binary_f1_score': 0.7089337}
confusion matrix:
     0    1
0  208    8
1   93  123
early stop counter: 1
val acc:0.6870109438896179, best validation acc: 0.8239436745643616, corresponding to test acc:                         0.8425925970077515 / 0.8425925970077515
after epoch: 6,now: 2024-07-26 06:35:51.746480,epoch time: 0:01:28.167820,used: 0:08:52.211425,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_06_26_59_seed_2_23065779
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.983966, 'precision': 0.98396015, 'recall': 0.9839881, 'specificity': 0.9839881, 'f1': 0.9839655, 'auroc': 0.99858904, 'binary_precision': 0.9869366, 'binary_recall': 0.9811688, 'binary_specificity': 0.9868074, 'binary_f1_score': 0.98404425}
confusion matrix:
      0     1
0  1496    20
1    29  1511
---- Validation: 
scalar performance:
{'acc': 0.8348983, 'precision': 0.83877, 'recall': 0.8334273, 'specificity': 0.8334273, 'f1': 0.8339015, 'auroc': 0.88840824, 'binary_precision': 0.8689408, 'binary_recall': 0.77813506, 'binary_specificity': 0.8887195, 'binary_f1_score': 0.8210348}
confusion matrix:
     0    1
0  583   73
1  138  484
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7986111, 'precision': 0.80574757, 'recall': 0.7986111, 'specificity': 0.7986111, 'f1': 0.7974291, 'auroc': 0.89876974, 'binary_precision': 0.7590361, 'binary_recall': 0.875, 'binary_specificity': 0.7222222, 'binary_f1_score': 0.8129032}
confusion matrix:
     0    1
0  156   60
1   27  189
better model found
persisted
after epoch: 7,now: 2024-07-26 06:37:19.635002,epoch time: 0:01:27.888522,used: 0:10:20.099947,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_06_26_59_seed_2_23065779
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.97447646, 'precision': 0.9754751, 'recall': 0.9746702, 'specificity': 0.9746702, 'f1': 0.97446907, 'auroc': 0.9983672, 'binary_precision': 0.99931693, 'binary_recall': 0.95, 'binary_specificity': 0.99934036, 'binary_f1_score': 0.9740346}
confusion matrix:
      0     1
0  1515     1
1    77  1463
---- Validation: 
scalar performance:
{'acc': 0.7691706, 'precision': 0.80917037, 'recall': 0.7642783, 'specificity': 0.7642783, 'f1': 0.75912416, 'auroc': 0.86498606, 'binary_precision': 0.91392404, 'binary_recall': 0.58038586, 'binary_specificity': 0.9481707, 'binary_f1_score': 0.7099312}
confusion matrix:
     0    1
0  622   34
1  261  361
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7291667, 'precision': 0.7711572, 'recall': 0.7291666, 'specificity': 0.7291666, 'f1': 0.71825933, 'auroc': 0.87127054, 'binary_precision': 0.8778626, 'binary_recall': 0.5324074, 'binary_specificity': 0.9259259, 'binary_f1_score': 0.6628242}
confusion matrix:
     0    1
0  200   16
1  101  115
early stop counter: 1
val acc:0.7691705822944641, best validation acc: 0.8348982930183411, corresponding to test acc:                         0.7986111044883728 / 0.8425925970077515
after epoch: 8,now: 2024-07-26 06:38:47.837075,epoch time: 0:01:28.202073,used: 0:11:48.302020,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_06_26_59_seed_2_23065779
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9872382, 'precision': 0.9872305, 'recall': 0.98725027, 'specificity': 0.98725027, 'f1': 0.9872377, 'auroc': 0.9991288, 'binary_precision': 0.9889251, 'binary_recall': 0.98571426, 'binary_specificity': 0.9887863, 'binary_f1_score': 0.987317}
confusion matrix:
      0     1
0  1499    17
1    22  1518
---- Validation: 
scalar performance:
{'acc': 0.7832551, 'precision': 0.8010218, 'recall': 0.7799143, 'specificity': 0.7799143, 'f1': 0.778513, 'auroc': 0.86446166, 'binary_precision': 0.8678038, 'binary_recall': 0.65434086, 'binary_specificity': 0.9054878, 'binary_f1_score': 0.74610454}
confusion matrix:
     0    1
0  594   62
1  215  407
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8171296, 'precision': 0.82076657, 'recall': 0.8171296, 'specificity': 0.8171296, 'f1': 0.81660986, 'auroc': 0.8881387, 'binary_precision': 0.8549223, 'binary_recall': 0.7638889, 'binary_specificity': 0.8703704, 'binary_f1_score': 0.80684596}
confusion matrix:
     0    1
0  188   28
1   51  165
early stop counter: 2
val acc:0.7832551002502441, best validation acc: 0.8348982930183411, corresponding to test acc:                         0.7986111044883728 / 0.8425925970077515
after epoch: 9,now: 2024-07-26 06:40:15.711067,epoch time: 0:01:27.873992,used: 0:13:16.176012,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_06_26_59_seed_2_23065779
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.98756546, 'precision': 0.98755825, 'recall': 0.98757493, 'specificity': 0.98757493, 'f1': 0.9875649, 'auroc': 0.9992739, 'binary_precision': 0.9889323, 'binary_recall': 0.98636365, 'binary_specificity': 0.9887863, 'binary_f1_score': 0.9876463}
confusion matrix:
      0     1
0  1499    17
1    21  1519
---- Validation: 
scalar performance:
{'acc': 0.81220657, 'precision': 0.834748, 'recall': 0.80869883, 'specificity': 0.80869883, 'f1': 0.8076831, 'auroc': 0.90153956, 'binary_precision': 0.9152174, 'binary_recall': 0.6768489, 'binary_specificity': 0.9405488, 'binary_f1_score': 0.7781885}
confusion matrix:
     0    1
0  617   39
1  201  421
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8217593, 'precision': 0.8248296, 'recall': 0.8217592, 'specificity': 0.8217592, 'f1': 0.8213371, 'auroc': 0.8950403, 'binary_precision': 0.85641026, 'binary_recall': 0.7731481, 'binary_specificity': 0.8703704, 'binary_f1_score': 0.81265205}
confusion matrix:
     0    1
0  188   28
1   49  167
early stop counter: 3
val acc:0.8122065663337708, best validation acc: 0.8348982930183411, corresponding to test acc:                         0.7986111044883728 / 0.8425925970077515
after epoch: 10,now: 2024-07-26 06:41:44.188031,epoch time: 0:01:28.476964,used: 0:14:44.652976,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_06_26_59_seed_2_23065779
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9888743, 'precision': 0.9889885, 'recall': 0.9889507, 'specificity': 0.9889507, 'f1': 0.9888743, 'auroc': 0.9993772, 'binary_precision': 0.9986755, 'binary_recall': 0.9792208, 'binary_specificity': 0.9986807, 'binary_f1_score': 0.9888525}
confusion matrix:
      0     1
0  1514     2
1    32  1508
---- Validation: 
scalar performance:
{'acc': 0.80672926, 'precision': 0.83277607, 'recall': 0.8029468, 'specificity': 0.8029468, 'f1': 0.8014183, 'auroc': 0.8915771, 'binary_precision': 0.9194631, 'binary_recall': 0.6607717, 'binary_specificity': 0.94512194, 'binary_f1_score': 0.76894295}
confusion matrix:
     0    1
0  620   36
1  211  411
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7800926, 'precision': 0.79803634, 'recall': 0.7800926, 'specificity': 0.7800926, 'f1': 0.776732, 'auroc': 0.8484439, 'binary_precision': 0.87116563, 'binary_recall': 0.6574074, 'binary_specificity': 0.9027778, 'binary_f1_score': 0.74934036}
confusion matrix:
     0    1
0  195   21
1   74  142
early stop counter: 4
val acc:0.806729257106781, best validation acc: 0.8348982930183411, corresponding to test acc:                         0.7986111044883728 / 0.8425925970077515
after epoch: 11,now: 2024-07-26 06:43:12.114669,epoch time: 0:01:27.926638,used: 0:16:12.579614,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_06_26_59_seed_2_23065779
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.99051046, 'precision': 0.99051327, 'recall': 0.9905433, 'specificity': 0.9905433, 'f1': 0.99051034, 'auroc': 0.9993489, 'binary_precision': 0.994761, 'binary_recall': 0.98636365, 'binary_specificity': 0.99472296, 'binary_f1_score': 0.99054456}
confusion matrix:
      0     1
0  1508     8
1    21  1519
---- Validation: 
scalar performance:
{'acc': 0.81611896, 'precision': 0.8472655, 'recall': 0.81209314, 'specificity': 0.81209314, 'f1': 0.81045073, 'auroc': 0.902213, 'binary_precision': 0.94482756, 'binary_recall': 0.6607717, 'binary_specificity': 0.9634146, 'binary_f1_score': 0.77767265}
confusion matrix:
     0    1
0  632   24
1  211  411
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8032407, 'precision': 0.84738624, 'recall': 0.8032408, 'specificity': 0.8032408, 'f1': 0.79678464, 'auroc': 0.9255187, 'binary_precision': 0.971223, 'binary_recall': 0.625, 'binary_specificity': 0.9814815, 'binary_f1_score': 0.7605634}
confusion matrix:
     0    1
0  212    4
1   81  135
early stop counter: 5
val acc:0.8161189556121826, best validation acc: 0.8348982930183411, corresponding to test acc:                         0.7986111044883728 / 0.8425925970077515
after epoch: 12,now: 2024-07-26 06:44:40.118057,epoch time: 0:01:28.003388,used: 0:17:40.583002,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_06_26_59_seed_2_23065779
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.98625654, 'precision': 0.9863174, 'recall': 0.9863174, 'specificity': 0.9863174, 'f1': 0.9862565, 'auroc': 0.9993652, 'binary_precision': 0.9940633, 'binary_recall': 0.9785714, 'binary_specificity': 0.9940633, 'binary_f1_score': 0.9862565}
confusion matrix:
      0     1
0  1507     9
1    33  1507
---- Validation: 
scalar performance:
{'acc': 0.773083, 'precision': 0.79031336, 'recall': 0.7697141, 'specificity': 0.7697141, 'f1': 0.7680639, 'auroc': 0.8405052, 'binary_precision': 0.85470086, 'binary_recall': 0.6430868, 'binary_specificity': 0.89634144, 'binary_f1_score': 0.73394495}
confusion matrix:
     0    1
0  588   68
1  222  400
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8148148, 'precision': 0.83116883, 'recall': 0.8148148, 'specificity': 0.8148148, 'f1': 0.81249994, 'auroc': 0.87853646, 'binary_precision': 0.9047619, 'binary_recall': 0.7037037, 'binary_specificity': 0.9259259, 'binary_f1_score': 0.7916666}
confusion matrix:
     0    1
0  200   16
1   64  152
early stop counter: 6
val acc:0.773082971572876, best validation acc: 0.8348982930183411, corresponding to test acc:                         0.7986111044883728 / 0.8425925970077515
after epoch: 13,now: 2024-07-26 06:46:08.401576,epoch time: 0:01:28.283519,used: 0:19:08.866521,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_06_26_59_seed_2_23065779
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9895288, 'precision': 0.9896059, 'recall': 0.98959494, 'specificity': 0.98959494, 'f1': 0.9895288, 'auroc': 0.99967825, 'binary_precision': 0.9980185, 'binary_recall': 0.9811688, 'binary_specificity': 0.9980211, 'binary_f1_score': 0.989522}
confusion matrix:
      0     1
0  1513     3
1    29  1511
---- Validation: 
scalar performance:
{'acc': 0.80125195, 'precision': 0.8252105, 'recall': 0.7975698, 'specificity': 0.7975698, 'f1': 0.79605544, 'auroc': 0.86467725, 'binary_precision': 0.90707964, 'binary_recall': 0.659164, 'binary_specificity': 0.9359756, 'binary_f1_score': 0.763501}
confusion matrix:
     0    1
0  614   42
1  212  410
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7569444, 'precision': 0.77475876, 'recall': 0.7569444, 'specificity': 0.7569444, 'f1': 0.7529398, 'auroc': 0.8207947, 'binary_precision': 0.8447205, 'binary_recall': 0.6296296, 'binary_specificity': 0.8842593, 'binary_f1_score': 0.7214854}
confusion matrix:
     0    1
0  191   25
1   80  136
early stop counter: 7
val acc:0.8012519478797913, best validation acc: 0.8348982930183411, corresponding to test acc:                         0.7986111044883728 / 0.8425925970077515
after epoch: 14,now: 2024-07-26 06:47:36.162092,epoch time: 0:01:27.760516,used: 0:20:36.627037,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_06_26_59_seed_2_23065779
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9872382, 'precision': 0.9874598, 'recall': 0.98733765, 'specificity': 0.98733765, 'f1': 0.98723793, 'auroc': 0.9993866, 'binary_precision': 1.0, 'binary_recall': 0.9746753, 'binary_specificity': 1.0, 'binary_f1_score': 0.9871753}
confusion matrix:
      0     1
0  1516     0
1    39  1501
---- Validation: 
scalar performance:
{'acc': 0.6205008, 'precision': 0.7590354, 'recall': 0.6105036, 'specificity': 0.6105036, 'f1': 0.5515896, 'auroc': 0.8741447, 'binary_precision': 0.9419355, 'binary_recall': 0.23472668, 'binary_specificity': 0.9862805, 'binary_f1_score': 0.37580436}
confusion matrix:
     0    1
0  647    9
1  476  146
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5740741, 'precision': 0.67489874, 'recall': 0.5740741, 'specificity': 0.5740741, 'f1': 0.50235397, 'auroc': 0.8262174, 'binary_precision': 0.8076923, 'binary_recall': 0.19444445, 'binary_specificity': 0.9537037, 'binary_f1_score': 0.31343284}
confusion matrix:
     0   1
0  206  10
1  174  42
early stop counter: 8
val acc:0.6205008029937744, best validation acc: 0.8348982930183411, corresponding to test acc:                         0.7986111044883728 / 0.8425925970077515
after epoch: 15,now: 2024-07-26 06:49:04.333587,epoch time: 0:01:28.171495,used: 0:22:04.798532,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_06_26_59_seed_2_23065779
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.99345547, 'precision': 0.9934486, 'recall': 0.9934757, 'specificity': 0.9934757, 'f1': 0.99345535, 'auroc': 0.99973273, 'binary_precision': 0.99608356, 'binary_recall': 0.9909091, 'binary_specificity': 0.9960422, 'binary_f1_score': 0.9934896}
confusion matrix:
      0     1
0  1510     6
1    14  1526
---- Validation: 
scalar performance:
{'acc': 0.8169014, 'precision': 0.82572055, 'recall': 0.81464684, 'specificity': 0.81464684, 'f1': 0.8148042, 'auroc': 0.88066137, 'binary_precision': 0.8730769, 'binary_recall': 0.7299035, 'binary_specificity': 0.8993902, 'binary_f1_score': 0.79509634}
confusion matrix:
     0    1
0  590   66
1  168  454
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8125, 'precision': 0.81823635, 'recall': 0.8125, 'specificity': 0.8125, 'f1': 0.81165123, 'auroc': 0.8939686, 'binary_precision': 0.86096257, 'binary_recall': 0.7453704, 'binary_specificity': 0.8796296, 'binary_f1_score': 0.7990075}
confusion matrix:
     0    1
0  190   26
1   55  161
early stop counter: 9
val acc:0.8169013857841492, best validation acc: 0.8348982930183411, corresponding to test acc:                         0.7986111044883728 / 0.8425925970077515
after epoch: 16,now: 2024-07-26 06:50:31.896987,epoch time: 0:01:27.563400,used: 0:23:32.361932,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_06_26_59_seed_2_23065779
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9908377, 'precision': 0.99085957, 'recall': 0.9908217, 'specificity': 0.9908217, 'f1': 0.9908368, 'auroc': 0.9995284, 'binary_precision': 0.9890039, 'binary_recall': 0.99285716, 'binary_specificity': 0.9887863, 'binary_f1_score': 0.99092674}
confusion matrix:
      0     1
0  1499    17
1    11  1529
---- Validation: 
scalar performance:
{'acc': 0.7347418, 'precision': 0.78802884, 'recall': 0.7288668, 'specificity': 0.7288668, 'f1': 0.71849763, 'auroc': 0.87135816, 'binary_precision': 0.90544415, 'binary_recall': 0.5080386, 'binary_specificity': 0.9496951, 'binary_f1_score': 0.6508754}
confusion matrix:
     0    1
0  623   33
1  306  316
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7199074, 'precision': 0.72812676, 'recall': 0.7199074, 'specificity': 0.7199074, 'f1': 0.71736157, 'auroc': 0.8256388, 'binary_precision': 0.7714286, 'binary_recall': 0.625, 'binary_specificity': 0.8148148, 'binary_f1_score': 0.6905371}
confusion matrix:
     0    1
0  176   40
1   81  135
early stop counter: 10
val acc:0.7347418069839478, best validation acc: 0.8348982930183411, corresponding to test acc:                         0.7986111044883728 / 0.8425925970077515
after epoch: 17,now: 2024-07-26 06:51:59.625435,epoch time: 0:01:27.728448,used: 0:25:00.090380,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_06_26_59_seed_2_23065779
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9816754, 'precision': 0.9821086, 'recall': 0.9818079, 'specificity': 0.9818079, 'f1': 0.98167384, 'auroc': 0.9996016, 'binary_precision': 0.9986559, 'binary_recall': 0.96493506, 'binary_specificity': 0.9986807, 'binary_f1_score': 0.981506}
confusion matrix:
      0     1
0  1514     2
1    54  1486
---- Validation: 
scalar performance:
{'acc': 0.73239434, 'precision': 0.80690145, 'recall': 0.7257053, 'specificity': 0.7257053, 'f1': 0.711228, 'auroc': 0.8829553, 'binary_precision': 0.9516129, 'binary_recall': 0.4742765, 'binary_specificity': 0.97713417, 'binary_f1_score': 0.6330472}
confusion matrix:
     0    1
0  641   15
1  327  295
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6828704, 'precision': 0.7945421, 'recall': 0.6828704, 'specificity': 0.6828704, 'f1': 0.64966404, 'auroc': 0.83459795, 'binary_precision': 0.97590363, 'binary_recall': 0.375, 'binary_specificity': 0.9907407, 'binary_f1_score': 0.54180604}
confusion matrix:
     0   1
0  214   2
1  135  81
early stop counter: 11
val acc:0.7323943376541138, best validation acc: 0.8348982930183411, corresponding to test acc:                         0.7986111044883728 / 0.8425925970077515
after epoch: 18,now: 2024-07-26 06:53:26.857451,epoch time: 0:01:27.232016,used: 0:26:27.322396,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_06_26_59_seed_2_23065779
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.98854715, 'precision': 0.98867154, 'recall': 0.98862606, 'specificity': 0.98862606, 'f1': 0.9885471, 'auroc': 0.99967617, 'binary_precision': 0.99867463, 'binary_recall': 0.9785714, 'binary_specificity': 0.9986807, 'binary_f1_score': 0.9885208}
confusion matrix:
      0     1
0  1514     2
1    33  1507
---- Validation: 
scalar performance:
{'acc': 0.7636933, 'precision': 0.8228451, 'recall': 0.7579013, 'specificity': 0.7579013, 'f1': 0.7495204, 'auroc': 0.9091928, 'binary_precision': 0.95454544, 'binary_recall': 0.5401929, 'binary_specificity': 0.9756098, 'binary_f1_score': 0.68993837}
confusion matrix:
     0    1
0  640   16
1  286  336
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6805556, 'precision': 0.7831025, 'recall': 0.6805556, 'specificity': 0.6805556, 'f1': 0.64874744, 'auroc': 0.8945044, 'binary_precision': 0.95348835, 'binary_recall': 0.37962964, 'binary_specificity': 0.9814815, 'binary_f1_score': 0.5430464}
confusion matrix:
     0   1
0  212   4
1  134  82
early stop counter: 12
val acc:0.7636932730674744, best validation acc: 0.8348982930183411, corresponding to test acc:                         0.7986111044883728 / 0.8425925970077515
after epoch: 19,now: 2024-07-26 06:54:54.454295,epoch time: 0:01:27.596844,used: 0:27:54.919240,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_06_26_59_seed_2_23065779
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.99051046, 'precision': 0.9905046, 'recall': 0.990533, 'specificity': 0.990533, 'f1': 0.9905102, 'auroc': 0.99954677, 'binary_precision': 0.99346834, 'binary_recall': 0.9876623, 'binary_specificity': 0.9934037, 'binary_f1_score': 0.99055684}
confusion matrix:
      0     1
0  1506    10
1    19  1521
---- Validation: 
scalar performance:
{'acc': 0.74726135, 'precision': 0.79239106, 'recall': 0.7418952, 'specificity': 0.7418952, 'f1': 0.73422915, 'auroc': 0.86190796, 'binary_precision': 0.9008043, 'binary_recall': 0.5401929, 'binary_specificity': 0.94359756, 'binary_f1_score': 0.6753769}
confusion matrix:
     0    1
0  619   37
1  286  336
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.724537, 'precision': 0.8091451, 'recall': 0.724537, 'specificity': 0.724537, 'f1': 0.7043053, 'auroc': 0.89156806, 'binary_precision': 0.9708738, 'binary_recall': 0.46296296, 'binary_specificity': 0.9861111, 'binary_f1_score': 0.62695926}
confusion matrix:
     0    1
0  213    3
1  116  100
early stop counter: 13
val acc:0.7472613453865051, best validation acc: 0.8348982930183411, corresponding to test acc:                         0.7986111044883728 / 0.8425925970077515
after epoch: 20,now: 2024-07-26 06:56:22.195184,epoch time: 0:01:27.740889,used: 0:29:22.660129,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_06_26_59_seed_2_23065779
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.99247384, 'precision': 0.9924766, 'recall': 0.99250674, 'specificity': 0.99250674, 'f1': 0.9924737, 'auroc': 0.99981195, 'binary_precision': 0.9967256, 'binary_recall': 0.9883117, 'binary_specificity': 0.99670184, 'binary_f1_score': 0.99250084}
confusion matrix:
      0     1
0  1511     5
1    18  1522
---- Validation: 
scalar performance:
{'acc': 0.7918623, 'precision': 0.82940036, 'recall': 0.78729856, 'specificity': 0.78729856, 'f1': 0.78385365, 'auroc': 0.9149068, 'binary_precision': 0.93414634, 'binary_recall': 0.6157556, 'binary_specificity': 0.95884144, 'binary_f1_score': 0.74224806}
confusion matrix:
     0    1
0  629   27
1  239  383
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7939815, 'precision': 0.8509095, 'recall': 0.7939815, 'specificity': 0.7939815, 'f1': 0.7852727, 'auroc': 0.92448986, 'binary_precision': 0.99224806, 'binary_recall': 0.5925926, 'binary_specificity': 0.9953704, 'binary_f1_score': 0.742029}
confusion matrix:
     0    1
0  215    1
1   88  128
early stop counter: 14
val acc:0.7918623089790344, best validation acc: 0.8348982930183411, corresponding to test acc:                         0.7986111044883728 / 0.8425925970077515
after epoch: 21,now: 2024-07-26 06:57:49.713030,epoch time: 0:01:27.517846,used: 0:30:50.177975,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_06_26_59_seed_2_23065779
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.98854715, 'precision': 0.9886159, 'recall': 0.9886106, 'specificity': 0.9886106, 'f1': 0.98854715, 'auroc': 0.99886847, 'binary_precision': 0.9966997, 'binary_recall': 0.9805195, 'binary_specificity': 0.99670184, 'binary_f1_score': 0.98854345}
confusion matrix:
      0     1
0  1511     5
1    30  1510
---- Validation: 
scalar performance:
{'acc': 0.7198748, 'precision': 0.80299103, 'recall': 0.71276027, 'specificity': 0.71276027, 'f1': 0.6948473, 'auroc': 0.8832978, 'binary_precision': 0.9551724, 'binary_recall': 0.44533762, 'binary_specificity': 0.98018295, 'binary_f1_score': 0.60745615}
confusion matrix:
     0    1
0  643   13
1  345  277
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7546296, 'precision': 0.8141195, 'recall': 0.7546296, 'specificity': 0.7546296, 'f1': 0.74243486, 'auroc': 0.86887, 'binary_precision': 0.9508197, 'binary_recall': 0.537037, 'binary_specificity': 0.9722222, 'binary_f1_score': 0.6863905}
confusion matrix:
     0    1
0  210    6
1  100  116
early stop counter: 15
val acc:0.7198747992515564, best validation acc: 0.8348982930183411, corresponding to test acc:                         0.7986111044883728 / 0.8425925970077515
after epoch: 22,now: 2024-07-26 06:59:17.626889,epoch time: 0:01:27.913859,used: 0:32:18.091834,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_06_26_59_seed_2_23065779
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.99345547, 'precision': 0.9934512, 'recall': 0.9934808, 'specificity': 0.9934808, 'f1': 0.99345535, 'auroc': 0.99971604, 'binary_precision': 0.996732, 'binary_recall': 0.99025977, 'binary_specificity': 0.99670184, 'binary_f1_score': 0.99348533}
confusion matrix:
      0     1
0  1511     5
1    15  1525
---- Validation: 
scalar performance:
{'acc': 0.75899845, 'precision': 0.77951694, 'recall': 0.7552447, 'specificity': 0.7552447, 'f1': 0.75256974, 'auroc': 0.8406669, 'binary_precision': 0.8488889, 'binary_recall': 0.6141479, 'binary_specificity': 0.89634144, 'binary_f1_score': 0.7126866}
confusion matrix:
     0    1
0  588   68
1  240  382
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7731481, 'precision': 0.7928309, 'recall': 0.7731482, 'specificity': 0.7731482, 'f1': 0.769271, 'auroc': 0.8565886, 'binary_precision': 0.86875, 'binary_recall': 0.6435185, 'binary_specificity': 0.9027778, 'binary_f1_score': 0.73936164}
confusion matrix:
     0    1
0  195   21
1   77  139
early stop counter: 16
val acc:0.758998453617096, best validation acc: 0.8348982930183411, corresponding to test acc:                         0.7986111044883728 / 0.8425925970077515
after epoch: 23,now: 2024-07-26 07:00:45.595018,epoch time: 0:01:27.968129,used: 0:33:46.059963,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_06_26_59_seed_2_23065779
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9872382, 'precision': 0.9873842, 'recall': 0.9873222, 'specificity': 0.9873222, 'f1': 0.9872381, 'auroc': 0.9995066, 'binary_precision': 0.99800926, 'binary_recall': 0.97662336, 'binary_specificity': 0.9980211, 'binary_f1_score': 0.9872005}
confusion matrix:
      0     1
0  1513     3
1    36  1504
---- Validation: 
scalar performance:
{'acc': 0.71048516, 'precision': 0.7996181, 'recall': 0.7030723, 'specificity': 0.7030723, 'f1': 0.6824064, 'auroc': 0.893425, 'binary_precision': 0.95652175, 'binary_recall': 0.42443728, 'binary_specificity': 0.98170733, 'binary_f1_score': 0.5879733}
confusion matrix:
     0    1
0  644   12
1  358  264
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7430556, 'precision': 0.83027524, 'recall': 0.7430556, 'specificity': 0.7430556, 'f1': 0.72489285, 'auroc': 0.89306843, 'binary_precision': 1.0, 'binary_recall': 0.4861111, 'binary_specificity': 1.0, 'binary_f1_score': 0.65420556}
confusion matrix:
     0    1
0  216    0
1  111  105
early stop counter: 17
val acc:0.7104851603507996, best validation acc: 0.8348982930183411, corresponding to test acc:                         0.7986111044883728 / 0.8425925970077515
after epoch: 24,now: 2024-07-26 07:02:13.677866,epoch time: 0:01:28.082848,used: 0:35:14.142811,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_06_26_59_seed_2_23065779
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.98920155, 'precision': 0.9893684, 'recall': 0.9891418, 'specificity': 0.9891418, 'f1': 0.98919904, 'auroc': 0.9997832, 'binary_precision': 0.9820857, 'binary_recall': 0.9967533, 'binary_specificity': 0.98153037, 'binary_f1_score': 0.98936516}
confusion matrix:
      0     1
0  1488    28
1     5  1535
---- Validation: 
scalar performance:
{'acc': 0.80907667, 'precision': 0.8101926, 'recall': 0.809858, 'specificity': 0.809858, 'f1': 0.809065, 'auroc': 0.8918246, 'binary_precision': 0.7837838, 'binary_recall': 0.8392283, 'binary_specificity': 0.7804878, 'binary_f1_score': 0.810559}
confusion matrix:
     0    1
0  512  144
1  100  522
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7824074, 'precision': 0.81148934, 'recall': 0.7824074, 'specificity': 0.7824074, 'f1': 0.7772072, 'auroc': 0.901749, 'binary_precision': 0.71631205, 'binary_recall': 0.9351852, 'binary_specificity': 0.6296296, 'binary_f1_score': 0.811245}
confusion matrix:
     0    1
0  136   80
1   14  202
early stop counter: 18
val acc:0.8090766668319702, best validation acc: 0.8348982930183411, corresponding to test acc:                         0.7986111044883728 / 0.8425925970077515
after epoch: 25,now: 2024-07-26 07:03:41.112712,epoch time: 0:01:27.434846,used: 0:36:41.577657,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_06_26_59_seed_2_23065779
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.98854715, 'precision': 0.98871356, 'recall': 0.9884873, 'specificity': 0.9884873, 'f1': 0.9885444, 'auroc': 0.99907005, 'binary_precision': 0.9814459, 'binary_recall': 0.9961039, 'binary_specificity': 0.9808707, 'binary_f1_score': 0.9887206}
confusion matrix:
      0     1
0  1487    29
1     6  1534
---- Validation: 
scalar performance:
{'acc': 0.81846637, 'precision': 0.82447004, 'recall': 0.8165879, 'specificity': 0.8165879, 'f1': 0.81690544, 'auroc': 0.89368486, 'binary_precision': 0.8624535, 'binary_recall': 0.7459807, 'binary_specificity': 0.8871951, 'binary_f1_score': 0.8}
confusion matrix:
     0    1
0  582   74
1  158  464
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7662037, 'precision': 0.7662094, 'recall': 0.7662037, 'specificity': 0.7662037, 'f1': 0.76620245, 'auroc': 0.8338263, 'binary_precision': 0.76744187, 'binary_recall': 0.7638889, 'binary_specificity': 0.7685185, 'binary_f1_score': 0.76566124}
confusion matrix:
     0    1
0  166   50
1   51  165
early stop counter: 19
val acc:0.8184663653373718, best validation acc: 0.8348982930183411, corresponding to test acc:                         0.7986111044883728 / 0.8425925970077515
after epoch: 26,now: 2024-07-26 07:05:09.387412,epoch time: 0:01:28.274700,used: 0:38:09.852357,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_06_26_59_seed_2_23065779
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.98854715, 'precision': 0.98869336, 'recall': 0.98863125, 'specificity': 0.98863125, 'f1': 0.988547, 'auroc': 0.9998891, 'binary_precision': 0.9993364, 'binary_recall': 0.9779221, 'binary_specificity': 0.99934036, 'binary_f1_score': 0.98851335}
confusion matrix:
      0     1
0  1515     1
1    34  1506
---- Validation: 
scalar performance:
{'acc': 0.57589984, 'precision': 0.7564675, 'recall': 0.5644337, 'specificity': 0.5644337, 'f1': 0.47058663, 'auroc': 0.87439775, 'binary_precision': 0.96511626, 'binary_recall': 0.13344051, 'binary_specificity': 0.99542683, 'binary_f1_score': 0.23446327}
confusion matrix:
     0   1
0  653   3
1  539  83
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5231481, 'precision': 0.71428573, 'recall': 0.5231482, 'specificity': 0.5231482, 'f1': 0.38629594, 'auroc': 0.7907289, 'binary_precision': 0.9166667, 'binary_recall': 0.050925925, 'binary_specificity': 0.9953704, 'binary_f1_score': 0.09649123}
confusion matrix:
     0   1
0  215   1
1  205  11
early stop counter: 20
val acc:0.5758998394012451, best validation acc: 0.8348982930183411, corresponding to test acc:                         0.7986111044883728 / 0.8425925970077515
after epoch: 27,now: 2024-07-26 07:06:36.684796,epoch time: 0:01:27.297384,used: 0:39:37.149741,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_06_26_59_seed_2_23065779
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.99345547, 'precision': 0.9934896, 'recall': 0.9935065, 'specificity': 0.9935065, 'f1': 0.99345547, 'auroc': 0.99976397, 'binary_precision': 1.0, 'binary_recall': 0.987013, 'binary_specificity': 1.0, 'binary_f1_score': 0.99346405}
confusion matrix:
      0     1
0  1516     0
1    20  1520
---- Validation: 
scalar performance:
{'acc': 0.7699531, 'precision': 0.8138926, 'recall': 0.76487386, 'specificity': 0.76487386, 'f1': 0.75920546, 'auroc': 0.905831, 'binary_precision': 0.9248705, 'binary_recall': 0.573955, 'binary_specificity': 0.95579267, 'binary_f1_score': 0.7083333}
confusion matrix:
     0    1
0  627   29
1  265  357
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.787037, 'precision': 0.8207204, 'recall': 0.787037, 'specificity': 0.787037, 'f1': 0.7812947, 'auroc': 0.89426863, 'binary_precision': 0.9246575, 'binary_recall': 0.625, 'binary_specificity': 0.9490741, 'binary_f1_score': 0.74585634}
confusion matrix:
     0    1
0  205   11
1   81  135
early stop counter: 21
val acc:0.7699530720710754, best validation acc: 0.8348982930183411, corresponding to test acc:                         0.7986111044883728 / 0.8425925970077515
after epoch: 28,now: 2024-07-26 07:08:04.670074,epoch time: 0:01:27.985278,used: 0:41:05.135019,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_06_26_59_seed_2_23065779
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9941099, 'precision': 0.9941099, 'recall': 0.99414045, 'specificity': 0.99414045, 'f1': 0.99410987, 'auroc': 0.9999083, 'binary_precision': 0.9980366, 'binary_recall': 0.99025977, 'binary_specificity': 0.9980211, 'binary_f1_score': 0.994133}
confusion matrix:
      0     1
0  1513     3
1    15  1525
---- Validation: 
scalar performance:
{'acc': 0.7887324, 'precision': 0.8380674, 'recall': 0.78358316, 'specificity': 0.78358316, 'f1': 0.77855337, 'auroc': 0.918031, 'binary_precision': 0.960733, 'binary_recall': 0.59003216, 'binary_specificity': 0.97713417, 'binary_f1_score': 0.7310757}
confusion matrix:
     0    1
0  641   15
1  255  367
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8055556, 'precision': 0.86, 'recall': 0.8055556, 'specificity': 0.8055556, 'f1': 0.797915, 'auroc': 0.92337537, 'binary_precision': 1.0, 'binary_recall': 0.6111111, 'binary_specificity': 1.0, 'binary_f1_score': 0.7586207}
confusion matrix:
     0    1
0  216    0
1   84  132
early stop counter: 22
val acc:0.7887324094772339, best validation acc: 0.8348982930183411, corresponding to test acc:                         0.7986111044883728 / 0.8425925970077515
after epoch: 29,now: 2024-07-26 07:09:31.803627,epoch time: 0:01:27.133553,used: 0:42:32.268572,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_06_26_59_seed_2_23065779
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.99541885, 'precision': 0.99541885, 'recall': 0.9954494, 'specificity': 0.9954494, 'f1': 0.9954188, 'auroc': 0.9998951, 'binary_precision': 0.99934554, 'binary_recall': 0.99155843, 'binary_specificity': 0.99934036, 'binary_f1_score': 0.9954368}
confusion matrix:
      0     1
0  1515     1
1    13  1527
---- Validation: 
scalar performance:
{'acc': 0.5884194, 'precision': 0.7280656, 'recall': 0.5776704, 'specificity': 0.5776704, 'f1': 0.5005691, 'auroc': 0.8776867, 'binary_precision': 0.9, 'binary_recall': 0.17363344, 'binary_specificity': 0.98170733, 'binary_f1_score': 0.2911051}
confusion matrix:
     0    1
0  644   12
1  514  108
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5601852, 'precision': 0.7328358, 'recall': 0.5601852, 'specificity': 0.5601852, 'f1': 0.46009946, 'auroc': 0.8183514, 'binary_precision': 0.93333334, 'binary_recall': 0.12962963, 'binary_specificity': 0.9907407, 'binary_f1_score': 0.22764227}
confusion matrix:
     0   1
0  214   2
1  188  28
early stop counter: 23
val acc:0.5884193778038025, best validation acc: 0.8348982930183411, corresponding to test acc:                         0.7986111044883728 / 0.8425925970077515
after epoch: 30,now: 2024-07-26 07:10:59.608482,epoch time: 0:01:27.804855,used: 0:44:00.073427,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_06_26_59_seed_2_23065779
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 0:44:00.073427 at 2024-07-26 07:10:59.608482
persisted model performance metric: 

scalar performance:
{'acc': 0.7986111, 'precision': 0.80574757, 'recall': 0.7986111, 'specificity': 0.7986111, 'f1': 0.7974291, 'auroc': 0.89876974, 'binary_precision': 0.7590361, 'binary_recall': 0.875, 'binary_specificity': 0.7222222, 'binary_f1_score': 0.8129032}
confusion matrix:
     0    1
0  156   60
1   27  189
oracle model performance metric: 

scalar performance:
{'acc': 0.8425926, 'precision': 0.84933126, 'recall': 0.8425926, 'specificity': 0.8425926, 'f1': 0.8418298, 'auroc': 0.9107296, 'binary_precision': 0.89784944, 'binary_recall': 0.7731481, 'binary_specificity': 0.912037, 'binary_f1_score': 0.8308457}
confusion matrix:
     0    1
0  197   19
1   49  167
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_irm_10seeds_nofreeze_2024-07-26_02-28-54/rule_results/0.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_irm_10seeds_nofreeze_2024-07-26_02-28-54/confusion_matrix/0.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 455396 KiB |  13219 MiB | 221134 GiB | 221134 GiB |
|       from large pool | 414803 KiB |  13181 MiB | 218514 GiB | 218513 GiB |
|       from small pool |  40592 KiB |     60 MiB |   2620 GiB |   2620 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 455396 KiB |  13219 MiB | 221134 GiB | 221134 GiB |
|       from large pool | 414803 KiB |  13181 MiB | 218514 GiB | 218513 GiB |
|       from small pool |  40592 KiB |     60 MiB |   2620 GiB |   2620 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 447481 KiB |  13213 MiB | 220529 GiB | 220529 GiB |
|       from large pool | 407075 KiB |  13175 MiB | 217914 GiB | 217914 GiB |
|       from small pool |  40406 KiB |     60 MiB |   2615 GiB |   2615 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  14478 MiB |  14482 MiB |  41644 MiB |  27166 MiB |
|       from large pool |  14412 MiB |  14412 MiB |  41542 MiB |  27130 MiB |
|       from small pool |     66 MiB |     70 MiB |    102 MiB |     36 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 445724 KiB |   1236 MiB | 154862 GiB | 154861 GiB |
|       from large pool | 435116 KiB |   1229 MiB | 152226 GiB | 152225 GiB |
|       from small pool |  10607 KiB |     43 MiB |   2636 GiB |   2636 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    1298    |    2598    |   38979 K  |   38978 K  |
|       from large pool |     187    |    1413    |   19852 K  |   19851 K  |
|       from small pool |    1111    |    1419    |   19127 K  |   19126 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    1298    |    2598    |   38979 K  |   38978 K  |
|       from large pool |     187    |    1413    |   19852 K  |   19851 K  |
|       from small pool |    1111    |    1419    |   19127 K  |   19126 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     635    |     637    |    1781    |    1146    |
|       from large pool |     602    |     602    |    1730    |    1128    |
|       from small pool |      33    |      35    |      51    |      18    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      99    |     652    |   26783 K  |   26783 K  |
|       from large pool |      38    |     605    |   15471 K  |   15471 K  |
|       from small pool |      61    |     236    |   11311 K  |   11311 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13219 MiB | 221134 GiB | 221134 GiB |
|       from large pool |  16640 KiB |  13181 MiB | 218514 GiB | 218514 GiB |
|       from small pool |      0 KiB |     60 MiB |   2620 GiB |   2620 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13219 MiB | 221134 GiB | 221134 GiB |
|       from large pool |  16640 KiB |  13181 MiB | 218514 GiB | 218514 GiB |
|       from small pool |      0 KiB |     60 MiB |   2620 GiB |   2620 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13213 MiB | 220529 GiB | 220529 GiB |
|       from large pool |  16640 KiB |  13175 MiB | 217914 GiB | 217914 GiB |
|       from small pool |      0 KiB |     60 MiB |   2615 GiB |   2615 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    880 MiB |  14482 MiB |  41644 MiB |  40764 MiB |
|       from large pool |    830 MiB |  14412 MiB |  41542 MiB |  40712 MiB |
|       from small pool |     50 MiB |     70 MiB |    102 MiB |     52 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1236 MiB | 154862 GiB | 154862 GiB |
|       from large pool |  24320 KiB |   1229 MiB | 152226 GiB | 152226 GiB |
|       from small pool |      0 KiB |     43 MiB |   2636 GiB |   2636 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    2598    |   38979 K  |   38979 K  |
|       from large pool |       2    |    1413    |   19852 K  |   19852 K  |
|       from small pool |       0    |    1419    |   19127 K  |   19127 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    2598    |   38979 K  |   38979 K  |
|       from large pool |       2    |    1413    |   19852 K  |   19852 K  |
|       from small pool |       0    |    1419    |   19127 K  |   19127 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      62    |     637    |    1781    |    1719    |
|       from large pool |      37    |     602    |    1730    |    1693    |
|       from small pool |      25    |      35    |      51    |      26    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |     652    |   26784 K  |   26784 K  |
|       from large pool |       4    |     605    |   15472 K  |   15471 K  |
|       from small pool |       0    |     236    |   11312 K  |   11312 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13219 MiB | 221134 GiB | 221134 GiB |
|       from large pool |  16640 KiB |  13181 MiB | 218514 GiB | 218514 GiB |
|       from small pool |      0 KiB |     60 MiB |   2620 GiB |   2620 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13219 MiB | 221134 GiB | 221134 GiB |
|       from large pool |  16640 KiB |  13181 MiB | 218514 GiB | 218514 GiB |
|       from small pool |      0 KiB |     60 MiB |   2620 GiB |   2620 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13213 MiB | 220529 GiB | 220529 GiB |
|       from large pool |  16640 KiB |  13175 MiB | 217914 GiB | 217914 GiB |
|       from small pool |      0 KiB |     60 MiB |   2615 GiB |   2615 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    880 MiB |  14482 MiB |  41644 MiB |  40764 MiB |
|       from large pool |    830 MiB |  14412 MiB |  41542 MiB |  40712 MiB |
|       from small pool |     50 MiB |     70 MiB |    102 MiB |     52 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1236 MiB | 154862 GiB | 154862 GiB |
|       from large pool |  24320 KiB |   1229 MiB | 152226 GiB | 152226 GiB |
|       from small pool |      0 KiB |     43 MiB |   2636 GiB |   2636 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    2598    |   38979 K  |   38979 K  |
|       from large pool |       2    |    1413    |   19852 K  |   19852 K  |
|       from small pool |       0    |    1419    |   19127 K  |   19127 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    2598    |   38979 K  |   38979 K  |
|       from large pool |       2    |    1413    |   19852 K  |   19852 K  |
|       from small pool |       0    |    1419    |   19127 K  |   19127 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      62    |     637    |    1781    |    1719    |
|       from large pool |      37    |     602    |    1730    |    1693    |
|       from small pool |      25    |      35    |      51    |      26    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |     652    |   26784 K  |   26784 K  |
|       from large pool |       4    |     605    |   15472 K  |   15471 K  |
|       from small pool |       0    |     236    |   11312 K  |   11312 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'888c1ef2'
model name: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_07_11_27_seed_3_23065779

 Experiment start at: 2024-07-26 07:11:27.985832
before training, model accuracy: 0.47111111879348755
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.8531901, 'precision': 0.8838502, 'recall': 0.851262, 'specificity': 0.851262, 'f1': 0.8496866, 'auroc': 0.9879005, 'binary_precision': 0.77872986, 'binary_recall': 0.9922929, 'binary_specificity': 0.710231, 'binary_f1_score': 0.8726348}
confusion matrix:
      0     1
0  1076   439
1    12  1545
---- Validation: 
scalar performance:
{'acc': 0.6874513, 'precision': 0.7608396, 'recall': 0.69251347, 'specificity': 0.69251347, 'f1': 0.6672668, 'auroc': 0.8870325, 'binary_precision': 0.61752576, 'binary_recall': 0.95230526, 'binary_specificity': 0.4327217, 'binary_f1_score': 0.7492182}
confusion matrix:
     0    1
0  283  371
1   30  599
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7022222, 'precision': 0.77894336, 'recall': 0.7022222, 'specificity': 0.7022222, 'f1': 0.680235, 'auroc': 0.9144691, 'binary_precision': 0.63265306, 'binary_recall': 0.96444446, 'binary_specificity': 0.44, 'binary_f1_score': 0.7640845}
confusion matrix:
    0    1
0  99  126
1   8  217
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-26 07:12:59.350163,epoch time: 0:01:31.364331,used: 0:01:31.364331,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_07_11_27_seed_3_23065779
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9716797, 'precision': 0.97167563, 'recall': 0.97175545, 'specificity': 0.97175545, 'f1': 0.9716784, 'auroc': 0.9968549, 'binary_precision': 0.977879, 'binary_recall': 0.9659383, 'binary_specificity': 0.97757256, 'binary_f1_score': 0.9718719}
confusion matrix:
      0     1
0  1482    34
1    53  1503
---- Validation: 
scalar performance:
{'acc': 0.83320343, 'precision': 0.8394185, 'recall': 0.8318639, 'specificity': 0.8318639, 'f1': 0.8319907, 'auroc': 0.88982564, 'binary_precision': 0.88073397, 'binary_recall': 0.76311606, 'binary_specificity': 0.90061164, 'binary_f1_score': 0.81771713}
confusion matrix:
     0    1
0  589   65
1  149  480
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.81777775, 'precision': 0.8198247, 'recall': 0.81777775, 'specificity': 0.81777775, 'f1': 0.8174858, 'auroc': 0.9043555, 'binary_precision': 0.84541065, 'binary_recall': 0.7777778, 'binary_specificity': 0.8577778, 'binary_f1_score': 0.8101852}
confusion matrix:
     0    1
0  193   32
1   50  175
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-07-26 07:14:27.332304,epoch time: 0:01:27.982141,used: 0:02:59.346472,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_07_11_27_seed_3_23065779
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9739583, 'precision': 0.97425646, 'recall': 0.97417605, 'specificity': 0.97417605, 'f1': 0.97395813, 'auroc': 0.9963457, 'binary_precision': 0.99004644, 'binary_recall': 0.958253, 'binary_specificity': 0.990099, 'binary_f1_score': 0.9738903}
confusion matrix:
      0     1
0  1500    15
1    65  1492
---- Validation: 
scalar performance:
{'acc': 0.8090413, 'precision': 0.81568694, 'recall': 0.8075862, 'specificity': 0.8075862, 'f1': 0.80746746, 'auroc': 0.86720824, 'binary_precision': 0.8568773, 'binary_recall': 0.7329094, 'binary_specificity': 0.882263, 'binary_f1_score': 0.79006}
confusion matrix:
     0    1
0  577   77
1  168  461
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7977778, 'precision': 0.80432415, 'recall': 0.7977778, 'specificity': 0.7977778, 'f1': 0.7966844, 'auroc': 0.8966371, 'binary_precision': 0.8489583, 'binary_recall': 0.72444445, 'binary_specificity': 0.8711111, 'binary_f1_score': 0.7817746}
confusion matrix:
     0    1
0  196   29
1   62  163
early stop counter: 1
val acc:0.8090413212776184, best validation acc: 0.8332034349441528, corresponding to test acc:                         0.8177777528762817 / 0.8177777528762817
after epoch: 3,now: 2024-07-26 07:15:55.344173,epoch time: 0:01:28.011869,used: 0:04:27.358341,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_07_11_27_seed_3_23065779
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9707031, 'precision': 0.9711412, 'recall': 0.97095585, 'specificity': 0.97095585, 'f1': 0.9707023, 'auroc': 0.9965788, 'binary_precision': 0.98932624, 'binary_recall': 0.9524727, 'binary_specificity': 0.98943895, 'binary_f1_score': 0.97054976}
confusion matrix:
      0     1
0  1499    16
1    74  1483
---- Validation: 
scalar performance:
{'acc': 0.7809821, 'precision': 0.79881006, 'recall': 0.77854395, 'specificity': 0.77854395, 'f1': 0.7765846, 'auroc': 0.8617387, 'binary_precision': 0.8670886, 'binary_recall': 0.6534181, 'binary_specificity': 0.9036697, 'binary_f1_score': 0.7452403}
confusion matrix:
     0    1
0  591   63
1  218  411
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7822222, 'precision': 0.7880486, 'recall': 0.7822223, 'specificity': 0.7822223, 'f1': 0.7811154, 'auroc': 0.8785186, 'binary_precision': 0.7470817, 'binary_recall': 0.85333335, 'binary_specificity': 0.7111111, 'binary_f1_score': 0.7966805}
confusion matrix:
     0    1
0  160   65
1   33  192
early stop counter: 2
val acc:0.7809820771217346, best validation acc: 0.8332034349441528, corresponding to test acc:                         0.8177777528762817 / 0.8177777528762817
after epoch: 4,now: 2024-07-26 07:17:23.097607,epoch time: 0:01:27.753434,used: 0:05:55.111775,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_07_11_27_seed_3_23065779
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.976888, 'precision': 0.97758174, 'recall': 0.9771766, 'specificity': 0.9771766, 'f1': 0.9768859, 'auroc': 0.9975735, 'binary_precision': 0.9993275, 'binary_recall': 0.95501286, 'binary_specificity': 0.99934036, 'binary_f1_score': 0.97666776}
confusion matrix:
      0     1
0  1515     1
1    70  1486
---- Validation: 
scalar performance:
{'acc': 0.7638348, 'precision': 0.8116498, 'recall': 0.75996196, 'specificity': 0.75996196, 'f1': 0.7525488, 'auroc': 0.8717444, 'binary_precision': 0.9289474, 'binary_recall': 0.56120825, 'binary_specificity': 0.9587156, 'binary_f1_score': 0.6997026}
confusion matrix:
     0    1
0  627   27
1  276  353
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7777778, 'precision': 0.8227639, 'recall': 0.7777778, 'specificity': 0.7777778, 'f1': 0.769755, 'auroc': 0.88327897, 'binary_precision': 0.9432624, 'binary_recall': 0.5911111, 'binary_specificity': 0.96444446, 'binary_f1_score': 0.72677594}
confusion matrix:
     0    1
0  217    8
1   92  133
early stop counter: 3
val acc:0.7638347744941711, best validation acc: 0.8332034349441528, corresponding to test acc:                         0.8177777528762817 / 0.8177777528762817
after epoch: 5,now: 2024-07-26 07:18:51.239890,epoch time: 0:01:28.142283,used: 0:07:23.254058,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_07_11_27_seed_3_23065779
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9563802, 'precision': 0.958946, 'recall': 0.95698476, 'specificity': 0.95698476, 'f1': 0.95635056, 'auroc': 0.995376, 'binary_precision': 0.99720865, 'binary_recall': 0.9166132, 'binary_specificity': 0.99735624, 'binary_f1_score': 0.95521384}
confusion matrix:
      0     1
0  1509     4
1   130  1429
---- Validation: 
scalar performance:
{'acc': 0.6640686, 'precision': 0.7534615, 'recall': 0.65815234, 'specificity': 0.65815234, 'f1': 0.6266856, 'auroc': 0.8431573, 'binary_precision': 0.8991935, 'binary_recall': 0.354531, 'binary_specificity': 0.9617737, 'binary_f1_score': 0.50855184}
confusion matrix:
     0    1
0  629   25
1  406  223
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.68666667, 'precision': 0.73377204, 'recall': 0.68666667, 'specificity': 0.68666667, 'f1': 0.6700451, 'auroc': 0.81507653, 'binary_precision': 0.83870965, 'binary_recall': 0.46222222, 'binary_specificity': 0.9111111, 'binary_f1_score': 0.5959885}
confusion matrix:
     0    1
0  205   20
1  121  104
early stop counter: 4
val acc:0.6640685796737671, best validation acc: 0.8332034349441528, corresponding to test acc:                         0.8177777528762817 / 0.8177777528762817
after epoch: 6,now: 2024-07-26 07:20:19.103029,epoch time: 0:01:27.863139,used: 0:08:51.117197,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_07_11_27_seed_3_23065779
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.984375, 'precision': 0.9846052, 'recall': 0.98458636, 'specificity': 0.98458636, 'f1': 0.984375, 'auroc': 0.9984327, 'binary_precision': 0.9993386, 'binary_recall': 0.96983314, 'binary_specificity': 0.9993395, 'binary_f1_score': 0.98436487}
confusion matrix:
      0     1
0  1513     1
1    47  1511
---- Validation: 
scalar performance:
{'acc': 0.609509, 'precision': 0.7720958, 'recall': 0.60183996, 'specificity': 0.60183996, 'f1': 0.5327556, 'auroc': 0.8480599, 'binary_precision': 0.97761196, 'binary_recall': 0.2082671, 'binary_specificity': 0.9954128, 'binary_f1_score': 0.3433814}
confusion matrix:
     0    1
0  651    3
1  498  131
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6577778, 'precision': 0.78400004, 'recall': 0.6577778, 'specificity': 0.6577778, 'f1': 0.615, 'auroc': 0.8798815, 'binary_precision': 0.97333336, 'binary_recall': 0.32444444, 'binary_specificity': 0.9911111, 'binary_f1_score': 0.48666668}
confusion matrix:
     0   1
0  223   2
1  152  73
early stop counter: 5
val acc:0.6095089912414551, best validation acc: 0.8332034349441528, corresponding to test acc:                         0.8177777528762817 / 0.8177777528762817
after epoch: 7,now: 2024-07-26 07:21:47.245363,epoch time: 0:01:28.142334,used: 0:10:19.259531,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_07_11_27_seed_3_23065779
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9847005, 'precision': 0.9850191, 'recall': 0.9845665, 'specificity': 0.9845665, 'f1': 0.98469234, 'auroc': 0.9991225, 'binary_precision': 0.9754253, 'binary_recall': 0.9948586, 'binary_specificity': 0.9742744, 'binary_f1_score': 0.9850461}
confusion matrix:
      0     1
0  1477    39
1     8  1548
---- Validation: 
scalar performance:
{'acc': 0.76227593, 'precision': 0.76238275, 'recall': 0.76192737, 'specificity': 0.76192737, 'f1': 0.76202095, 'auroc': 0.8234492, 'binary_precision': 0.7647059, 'binary_recall': 0.74403816, 'binary_specificity': 0.7798165, 'binary_f1_score': 0.7542305}
confusion matrix:
     0    1
0  510  144
1  161  468
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7822222, 'precision': 0.7830273, 'recall': 0.7822223, 'specificity': 0.7822223, 'f1': 0.7820673, 'auroc': 0.86097777, 'binary_precision': 0.7679325, 'binary_recall': 0.8088889, 'binary_specificity': 0.75555557, 'binary_f1_score': 0.7878788}
confusion matrix:
     0    1
0  170   55
1   43  182
early stop counter: 6
val acc:0.7622759342193604, best validation acc: 0.8332034349441528, corresponding to test acc:                         0.8177777528762817 / 0.8177777528762817
after epoch: 8,now: 2024-07-26 07:23:15.529851,epoch time: 0:01:28.284488,used: 0:11:47.544019,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_07_11_27_seed_3_23065779
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9765625, 'precision': 0.9773254, 'recall': 0.9763152, 'specificity': 0.9763152, 'f1': 0.9765396, 'auroc': 0.99922544, 'binary_precision': 0.9614907, 'binary_recall': 0.99358153, 'binary_specificity': 0.95904887, 'binary_f1_score': 0.9772728}
confusion matrix:
      0     1
0  1452    62
1    10  1548
---- Validation: 
scalar performance:
{'acc': 0.77396727, 'precision': 0.8021389, 'recall': 0.7709339, 'specificity': 0.7709339, 'f1': 0.76718384, 'auroc': 0.8505224, 'binary_precision': 0.8896552, 'binary_recall': 0.6152623, 'binary_specificity': 0.9266055, 'binary_f1_score': 0.72744364}
confusion matrix:
     0    1
0  606   48
1  242  387
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8244445, 'precision': 0.8367435, 'recall': 0.8244444, 'specificity': 0.8244444, 'f1': 0.82282674, 'auroc': 0.87717533, 'binary_precision': 0.9010989, 'binary_recall': 0.72888887, 'binary_specificity': 0.92, 'binary_f1_score': 0.8058969}
confusion matrix:
     0    1
0  207   18
1   61  164
new oracle model saved
early stop counter: 7
val acc:0.7739672660827637, best validation acc: 0.8332034349441528, corresponding to test acc:                         0.8177777528762817 / 0.8244444727897644
after epoch: 9,now: 2024-07-26 07:24:44.072492,epoch time: 0:01:28.542641,used: 0:13:16.086660,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_07_11_27_seed_3_23065779
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.98079425, 'precision': 0.9811814, 'recall': 0.9810355, 'specificity': 0.9810355, 'f1': 0.98079395, 'auroc': 0.99913, 'binary_precision': 0.99866843, 'binary_recall': 0.9633911, 'binary_specificity': 0.9986799, 'binary_f1_score': 0.98071265}
confusion matrix:
      0     1
0  1513     2
1    57  1500
---- Validation: 
scalar performance:
{'acc': 0.7412315, 'precision': 0.81373036, 'recall': 0.73648405, 'specificity': 0.73648405, 'f1': 0.7227802, 'auroc': 0.87121505, 'binary_precision': 0.9597523, 'binary_recall': 0.49284577, 'binary_specificity': 0.9801223, 'binary_f1_score': 0.6512605}
confusion matrix:
     0    1
0  641   13
1  319  310
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.73333335, 'precision': 0.79368985, 'recall': 0.73333335, 'specificity': 0.73333335, 'f1': 0.71889055, 'auroc': 0.8962568, 'binary_precision': 0.9268293, 'binary_recall': 0.50666666, 'binary_specificity': 0.96, 'binary_f1_score': 0.6551724}
confusion matrix:
     0    1
0  216    9
1  111  114
early stop counter: 8
val acc:0.7412315011024475, best validation acc: 0.8332034349441528, corresponding to test acc:                         0.8177777528762817 / 0.8244444727897644
after epoch: 10,now: 2024-07-26 07:26:12.011203,epoch time: 0:01:27.938711,used: 0:14:44.025371,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_07_11_27_seed_3_23065779
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9899089, 'precision': 0.98988724, 'recall': 0.98993814, 'specificity': 0.98993814, 'f1': 0.9899075, 'auroc': 0.9991047, 'binary_precision': 0.9922581, 'binary_recall': 0.987797, 'binary_specificity': 0.9920792, 'binary_f1_score': 0.99002254}
confusion matrix:
      0     1
0  1503    12
1    19  1538
---- Validation: 
scalar performance:
{'acc': 0.7747467, 'precision': 0.8074032, 'recall': 0.7715161, 'specificity': 0.7715161, 'f1': 0.7671323, 'auroc': 0.8808385, 'binary_precision': 0.9028436, 'binary_recall': 0.6057234, 'binary_specificity': 0.93730885, 'binary_f1_score': 0.72502375}
confusion matrix:
     0    1
0  613   41
1  248  381
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8088889, 'precision': 0.8179581, 'recall': 0.8088889, 'specificity': 0.8088889, 'f1': 0.80751634, 'auroc': 0.9029136, 'binary_precision': 0.8716577, 'binary_recall': 0.72444445, 'binary_specificity': 0.8933333, 'binary_f1_score': 0.7912621}
confusion matrix:
     0    1
0  201   24
1   62  163
early stop counter: 9
val acc:0.7747467160224915, best validation acc: 0.8332034349441528, corresponding to test acc:                         0.8177777528762817 / 0.8244444727897644
after epoch: 11,now: 2024-07-26 07:27:40.397192,epoch time: 0:01:28.385989,used: 0:16:12.411360,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_07_11_27_seed_3_23065779
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9866536, 'precision': 0.98680866, 'recall': 0.9868167, 'specificity': 0.9868167, 'f1': 0.9866537, 'auroc': 0.9991988, 'binary_precision': 0.99934083, 'binary_recall': 0.97429305, 'binary_specificity': 0.99934036, 'binary_f1_score': 0.986658}
confusion matrix:
      0     1
0  1515     1
1    40  1516
---- Validation: 
scalar performance:
{'acc': 0.74512863, 'precision': 0.81102765, 'recall': 0.7405802, 'specificity': 0.7405802, 'f1': 0.7284463, 'auroc': 0.89010704, 'binary_precision': 0.9494048, 'binary_recall': 0.5071542, 'binary_specificity': 0.9740061, 'binary_f1_score': 0.6611399}
confusion matrix:
     0    1
0  637   17
1  310  319
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.64666665, 'precision': 0.76122296, 'recall': 0.64666665, 'specificity': 0.64666665, 'f1': 0.6031592, 'auroc': 0.90247905, 'binary_precision': 0.93421054, 'binary_recall': 0.31555554, 'binary_specificity': 0.9777778, 'binary_f1_score': 0.47176075}
confusion matrix:
     0   1
0  220   5
1  154  71
early stop counter: 10
val acc:0.7451286315917969, best validation acc: 0.8332034349441528, corresponding to test acc:                         0.8177777528762817 / 0.8244444727897644
after epoch: 12,now: 2024-07-26 07:29:08.842850,epoch time: 0:01:28.445658,used: 0:17:40.857018,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_07_11_27_seed_3_23065779
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.991862, 'precision': 0.9918499, 'recall': 0.99194896, 'specificity': 0.99194896, 'f1': 0.99186146, 'auroc': 0.99950355, 'binary_precision': 0.9980507, 'binary_recall': 0.98587936, 'binary_specificity': 0.9980185, 'binary_f1_score': 0.9919277}
confusion matrix:
      0     1
0  1511     3
1    22  1536
---- Validation: 
scalar performance:
{'acc': 0.7996882, 'precision': 0.81685364, 'recall': 0.7973787, 'specificity': 0.7973787, 'f1': 0.7960223, 'auroc': 0.87338525, 'binary_precision': 0.8858921, 'binary_recall': 0.6788553, 'binary_specificity': 0.91590214, 'binary_f1_score': 0.7686769}
confusion matrix:
     0    1
0  599   55
1  202  427
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7822222, 'precision': 0.78963697, 'recall': 0.7822222, 'specificity': 0.7822222, 'f1': 0.78081954, 'auroc': 0.8592198, 'binary_precision': 0.83597887, 'binary_recall': 0.7022222, 'binary_specificity': 0.8622222, 'binary_f1_score': 0.76328504}
confusion matrix:
     0    1
0  194   31
1   67  158
early stop counter: 11
val acc:0.7996882200241089, best validation acc: 0.8332034349441528, corresponding to test acc:                         0.8177777528762817 / 0.8244444727897644
after epoch: 13,now: 2024-07-26 07:30:36.511974,epoch time: 0:01:27.669124,used: 0:19:08.526142,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_07_11_27_seed_3_23065779
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.98567706, 'precision': 0.985837, 'recall': 0.98558986, 'specificity': 0.98558986, 'f1': 0.9856716, 'auroc': 0.99933314, 'binary_precision': 0.97969544, 'binary_recall': 0.99228793, 'binary_specificity': 0.97889185, 'binary_f1_score': 0.9859514}
confusion matrix:
      0     1
0  1484    32
1    12  1544
---- Validation: 
scalar performance:
{'acc': 0.705378, 'precision': 0.79512274, 'recall': 0.6999181, 'specificity': 0.6999181, 'f1': 0.6775353, 'auroc': 0.8635181, 'binary_precision': 0.9530686, 'binary_recall': 0.41971382, 'binary_specificity': 0.9801223, 'binary_f1_score': 0.58278143}
confusion matrix:
     0    1
0  641   13
1  365  264
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6622222, 'precision': 0.7647059, 'recall': 0.66222227, 'specificity': 0.66222227, 'f1': 0.6260252, 'auroc': 0.896237, 'binary_precision': 0.92941177, 'binary_recall': 0.3511111, 'binary_specificity': 0.97333336, 'binary_f1_score': 0.5096774}
confusion matrix:
     0   1
0  219   6
1  146  79
early stop counter: 12
val acc:0.705377995967865, best validation acc: 0.8332034349441528, corresponding to test acc:                         0.8177777528762817 / 0.8244444727897644
after epoch: 14,now: 2024-07-26 07:32:04.807150,epoch time: 0:01:28.295176,used: 0:20:36.821318,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_07_11_27_seed_3_23065779
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9902344, 'precision': 0.99021435, 'recall': 0.9902593, 'specificity': 0.9902593, 'f1': 0.99023306, 'auroc': 0.99900204, 'binary_precision': 0.9922631, 'binary_recall': 0.9884393, 'binary_specificity': 0.9920792, 'binary_f1_score': 0.9903475}
confusion matrix:
      0     1
0  1503    12
1    18  1539
---- Validation: 
scalar performance:
{'acc': 0.74512863, 'precision': 0.7590974, 'recall': 0.742768, 'specificity': 0.742768, 'f1': 0.740353, 'auroc': 0.80597085, 'binary_precision': 0.81458336, 'binary_recall': 0.6216216, 'binary_specificity': 0.8639144, 'binary_f1_score': 0.7051398}
confusion matrix:
     0    1
0  565   89
1  238  391
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5777778, 'precision': 0.62052715, 'recall': 0.5777778, 'specificity': 0.5777778, 'f1': 0.53669584, 'auroc': 0.7274272, 'binary_precision': 0.6923077, 'binary_recall': 0.28, 'binary_specificity': 0.8755556, 'binary_f1_score': 0.3987342}
confusion matrix:
     0   1
0  197  28
1  162  63
early stop counter: 13
val acc:0.7451286315917969, best validation acc: 0.8332034349441528, corresponding to test acc:                         0.8177777528762817 / 0.8244444727897644
after epoch: 15,now: 2024-07-26 07:33:32.653907,epoch time: 0:01:27.846757,used: 0:22:04.668075,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_07_11_27_seed_3_23065779
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9869792, 'precision': 0.98697495, 'recall': 0.9870658, 'specificity': 0.9870658, 'f1': 0.98697853, 'auroc': 0.9994968, 'binary_precision': 0.9934938, 'binary_recall': 0.9807322, 'binary_specificity': 0.9933993, 'binary_f1_score': 0.98707175}
confusion matrix:
      0     1
0  1505    10
1    30  1527
---- Validation: 
scalar performance:
{'acc': 0.7614965, 'precision': 0.8102175, 'recall': 0.7575772, 'specificity': 0.7575772, 'f1': 0.7498356, 'auroc': 0.88293207, 'binary_precision': 0.928382, 'binary_recall': 0.5564388, 'binary_specificity': 0.9587156, 'binary_f1_score': 0.695825}
confusion matrix:
     0    1
0  627   27
1  279  350
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7822222, 'precision': 0.8331895, 'recall': 0.7822222, 'specificity': 0.7822222, 'f1': 0.7735628, 'auroc': 0.9116839, 'binary_precision': 0.96350366, 'binary_recall': 0.58666664, 'binary_specificity': 0.9777778, 'binary_f1_score': 0.7292818}
confusion matrix:
     0    1
0  220    5
1   93  132
early stop counter: 14
val acc:0.7614964842796326, best validation acc: 0.8332034349441528, corresponding to test acc:                         0.8177777528762817 / 0.8244444727897644
after epoch: 16,now: 2024-07-26 07:35:01.031676,epoch time: 0:01:28.377769,used: 0:23:33.045844,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_07_11_27_seed_3_23065779
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9840495, 'precision': 0.98437905, 'recall': 0.9839016, 'specificity': 0.9839016, 'f1': 0.98404, 'auroc': 0.9991746, 'binary_precision': 0.97482693, 'binary_recall': 0.99422336, 'binary_specificity': 0.97357994, 'binary_f1_score': 0.98442966}
confusion matrix:
      0     1
0  1474    40
1     9  1549
---- Validation: 
scalar performance:
{'acc': 0.81995326, 'precision': 0.8201823, 'recall': 0.81962657, 'specificity': 0.81962657, 'f1': 0.8197601, 'auroc': 0.8853259, 'binary_precision': 0.8251634, 'binary_recall': 0.8028617, 'binary_specificity': 0.83639145, 'binary_f1_score': 0.8138598}
confusion matrix:
     0    1
0  547  107
1  124  505
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.85333335, 'precision': 0.85336125, 'recall': 0.85333335, 'specificity': 0.85333335, 'f1': 0.8533304, 'auroc': 0.9279407, 'binary_precision': 0.85022026, 'binary_recall': 0.8577778, 'binary_specificity': 0.8488889, 'binary_f1_score': 0.85398227}
confusion matrix:
     0    1
0  191   34
1   32  193
new oracle model saved
early stop counter: 15
val acc:0.8199532628059387, best validation acc: 0.8332034349441528, corresponding to test acc:                         0.8177777528762817 / 0.8533333539962769
after epoch: 17,now: 2024-07-26 07:36:29.006010,epoch time: 0:01:27.974334,used: 0:25:01.020178,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_07_11_27_seed_3_23065779
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9899089, 'precision': 0.98994553, 'recall': 0.99004793, 'specificity': 0.99004793, 'f1': 0.9899086, 'auroc': 0.99924326, 'binary_precision': 0.9993464, 'binary_recall': 0.9807569, 'binary_specificity': 0.99933904, 'binary_f1_score': 0.98996437}
confusion matrix:
      0     1
0  1512     1
1    30  1529
---- Validation: 
scalar performance:
{'acc': 0.6874513, 'precision': 0.7842434, 'recall': 0.6816655, 'specificity': 0.6816655, 'f1': 0.65417206, 'auroc': 0.8730085, 'binary_precision': 0.9453125, 'binary_recall': 0.38473767, 'binary_specificity': 0.9785933, 'binary_f1_score': 0.5468926}
confusion matrix:
     0    1
0  640   14
1  387  242
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.74444443, 'precision': 0.7698195, 'recall': 0.7444445, 'specificity': 0.7444445, 'f1': 0.7382914, 'auroc': 0.8416, 'binary_precision': 0.8525641, 'binary_recall': 0.5911111, 'binary_specificity': 0.8977778, 'binary_f1_score': 0.69816273}
confusion matrix:
     0    1
0  202   23
1   92  133
early stop counter: 16
val acc:0.6874513030052185, best validation acc: 0.8332034349441528, corresponding to test acc:                         0.8177777528762817 / 0.8533333539962769
after epoch: 18,now: 2024-07-26 07:37:56.838553,epoch time: 0:01:27.832543,used: 0:26:28.852721,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_07_11_27_seed_3_23065779
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9938151, 'precision': 0.9937986, 'recall': 0.9938353, 'specificity': 0.9938353, 'f1': 0.99381435, 'auroc': 0.9998936, 'binary_precision': 0.9954868, 'binary_recall': 0.99228793, 'binary_specificity': 0.9953826, 'binary_f1_score': 0.9938848}
confusion matrix:
      0     1
0  1509     7
1    12  1544
---- Validation: 
scalar performance:
{'acc': 0.7069369, 'precision': 0.7989484, 'recall': 0.7014471, 'specificity': 0.7014471, 'f1': 0.6789186, 'auroc': 0.89037985, 'binary_precision': 0.96, 'binary_recall': 0.41971382, 'binary_specificity': 0.9831804, 'binary_f1_score': 0.5840708}
confusion matrix:
     0    1
0  643   11
1  365  264
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6, 'precision': 0.76727736, 'recall': 0.6, 'specificity': 0.6, 'f1': 0.52580553, 'auroc': 0.88651854, 'binary_precision': 0.9787234, 'binary_recall': 0.20444444, 'binary_specificity': 0.9955556, 'binary_f1_score': 0.3382353}
confusion matrix:
     0   1
0  224   1
1  179  46
early stop counter: 17
val acc:0.7069368958473206, best validation acc: 0.8332034349441528, corresponding to test acc:                         0.8177777528762817 / 0.8533333539962769
after epoch: 19,now: 2024-07-26 07:39:25.250850,epoch time: 0:01:28.412297,used: 0:27:57.265018,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_07_11_27_seed_3_23065779
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9635417, 'precision': 0.96555966, 'recall': 0.9640565, 'specificity': 0.9640565, 'f1': 0.9635238, 'auroc': 0.9997401, 'binary_precision': 1.0, 'binary_recall': 0.928113, 'binary_specificity': 1.0, 'binary_f1_score': 0.9627164}
confusion matrix:
      0     1
0  1514     0
1   112  1446
---- Validation: 
scalar performance:
{'acc': 0.51130164, 'precision': 0.7552693, 'recall': 0.50158983, 'specificity': 0.50158983, 'f1': 0.34115407, 'auroc': 0.8579793, 'binary_precision': 1.0, 'binary_recall': 0.0031796503, 'binary_specificity': 1.0, 'binary_f1_score': 0.006339144}
confusion matrix:
     0  1
0  654  0
1  627  2
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5, 'precision': 0.25, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.33333334, 'auroc': 0.9006222, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
     0  1
0  225  0
1  225  0
early stop counter: 18
val acc:0.5113016366958618, best validation acc: 0.8332034349441528, corresponding to test acc:                         0.8177777528762817 / 0.8533333539962769
after epoch: 20,now: 2024-07-26 07:40:52.971546,epoch time: 0:01:27.720696,used: 0:29:24.985714,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_07_11_27_seed_3_23065779
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9905599, 'precision': 0.9905839, 'recall': 0.9905371, 'specificity': 0.9905371, 'f1': 0.9905579, 'auroc': 0.9993484, 'binary_precision': 0.9891095, 'binary_recall': 0.99228793, 'binary_specificity': 0.9887863, 'binary_f1_score': 0.9906962}
confusion matrix:
      0     1
0  1499    17
1    12  1544
---- Validation: 
scalar performance:
{'acc': 0.8215121, 'precision': 0.82880276, 'recall': 0.8200313, 'specificity': 0.8200313, 'f1': 0.8199894, 'auroc': 0.8888192, 'binary_precision': 0.8731343, 'binary_recall': 0.74403816, 'binary_specificity': 0.89602447, 'binary_f1_score': 0.8034335}
confusion matrix:
     0    1
0  586   68
1  161  468
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8088889, 'precision': 0.8092799, 'recall': 0.8088889, 'specificity': 0.8088889, 'f1': 0.8088285, 'auroc': 0.86739755, 'binary_precision': 0.8202765, 'binary_recall': 0.7911111, 'binary_specificity': 0.82666665, 'binary_f1_score': 0.8054298}
confusion matrix:
     0    1
0  186   39
1   47  178
early stop counter: 19
val acc:0.8215121030807495, best validation acc: 0.8332034349441528, corresponding to test acc:                         0.8177777528762817 / 0.8533333539962769
after epoch: 21,now: 2024-07-26 07:42:21.091295,epoch time: 0:01:28.119749,used: 0:30:53.105463,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_07_11_27_seed_3_23065779
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.99121094, 'precision': 0.99138725, 'recall': 0.99112046, 'specificity': 0.99112046, 'f1': 0.9912074, 'auroc': 0.9998791, 'binary_precision': 0.9847812, 'binary_recall': 0.99807197, 'binary_specificity': 0.9841689, 'binary_f1_score': 0.991382}
confusion matrix:
      0     1
0  1492    24
1     3  1553
---- Validation: 
scalar performance:
{'acc': 0.83320343, 'precision': 0.8487016, 'recall': 0.83113456, 'specificity': 0.83113456, 'f1': 0.8306678, 'auroc': 0.89165366, 'binary_precision': 0.917505, 'binary_recall': 0.72496027, 'binary_specificity': 0.93730885, 'binary_f1_score': 0.8099467}
confusion matrix:
     0    1
0  613   41
1  173  456
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.84, 'precision': 0.86078095, 'recall': 0.84000003, 'specificity': 0.84000003, 'f1': 0.83766234, 'auroc': 0.9269926, 'binary_precision': 0.94736844, 'binary_recall': 0.72, 'binary_specificity': 0.96, 'binary_f1_score': 0.8181819}
confusion matrix:
     0    1
0  216    9
1   63  162
early stop counter: 20
val acc:0.8332034349441528, best validation acc: 0.8332034349441528, corresponding to test acc:                         0.8177777528762817 / 0.8533333539962769
after epoch: 22,now: 2024-07-26 07:43:48.795145,epoch time: 0:01:27.703850,used: 0:32:20.809313,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_07_11_27_seed_3_23065779
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.9947917, 'precision': 0.99481297, 'recall': 0.994771, 'specificity': 0.994771, 'f1': 0.99479026, 'auroc': 0.99990165, 'binary_precision': 0.99360204, 'binary_recall': 0.9961514, 'binary_specificity': 0.9933906, 'binary_f1_score': 0.994875}
confusion matrix:
      0     1
0  1503    10
1     6  1553
---- Validation: 
scalar performance:
{'acc': 0.85970384, 'precision': 0.8625903, 'recall': 0.8588301, 'specificity': 0.8588301, 'f1': 0.85916984, 'auroc': 0.90270466, 'binary_precision': 0.8904348, 'binary_recall': 0.8139905, 'binary_specificity': 0.9036697, 'binary_f1_score': 0.8504984}
confusion matrix:
     0    1
0  591   63
1  117  512
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.87333333, 'precision': 0.875, 'recall': 0.87333333, 'specificity': 0.87333333, 'f1': 0.8731924, 'auroc': 0.94044447, 'binary_precision': 0.9, 'binary_recall': 0.84, 'binary_specificity': 0.9066667, 'binary_f1_score': 0.8689655}
confusion matrix:
     0    1
0  204   21
1   36  189
new oracle model saved
better model found
persisted
after epoch: 23,now: 2024-07-26 07:45:17.972119,epoch time: 0:01:29.176974,used: 0:33:49.986287,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_07_11_27_seed_3_23065779
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.99088544, 'precision': 0.99090064, 'recall': 0.9909905, 'specificity': 0.9909905, 'f1': 0.99088514, 'auroc': 0.9996053, 'binary_precision': 0.9986954, 'binary_recall': 0.9833012, 'binary_specificity': 0.9986799, 'binary_f1_score': 0.9909386}
confusion matrix:
      0     1
0  1513     2
1    26  1531
---- Validation: 
scalar performance:
{'acc': 0.78332037, 'precision': 0.82980573, 'recall': 0.779622, 'specificity': 0.779622, 'f1': 0.7738161, 'auroc': 0.90282136, 'binary_precision': 0.9488491, 'binary_recall': 0.5898251, 'binary_specificity': 0.96941894, 'binary_f1_score': 0.727451}
confusion matrix:
     0    1
0  634   20
1  258  371
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7977778, 'precision': 0.83500004, 'recall': 0.7977778, 'specificity': 0.7977778, 'f1': 0.792, 'auroc': 0.9191506, 'binary_precision': 0.94666666, 'binary_recall': 0.6311111, 'binary_specificity': 0.96444446, 'binary_f1_score': 0.7573333}
confusion matrix:
     0    1
0  217    8
1   83  142
early stop counter: 1
val acc:0.7833203673362732, best validation acc: 0.8597038388252258, corresponding to test acc:                         0.8733333349227905 / 0.8733333349227905
after epoch: 24,now: 2024-07-26 07:46:45.679686,epoch time: 0:01:27.707567,used: 0:35:17.693854,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_07_11_27_seed_3_23065779
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.99316406, 'precision': 0.99314284, 'recall': 0.99320954, 'specificity': 0.99320954, 'f1': 0.99316347, 'auroc': 0.99967945, 'binary_precision': 0.99676377, 'binary_recall': 0.98971725, 'binary_specificity': 0.99670184, 'binary_f1_score': 0.993228}
confusion matrix:
      0     1
0  1511     5
1    16  1540
---- Validation: 
scalar performance:
{'acc': 0.65705377, 'precision': 0.76417756, 'recall': 0.65072465, 'specificity': 0.65072465, 'f1': 0.6129713, 'auroc': 0.85185456, 'binary_precision': 0.9276018, 'binary_recall': 0.32591414, 'binary_specificity': 0.97553515, 'binary_f1_score': 0.4823529}
confusion matrix:
     0    1
0  638   16
1  424  205
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.74666667, 'precision': 0.8073846, 'recall': 0.74666667, 'specificity': 0.74666667, 'f1': 0.73350656, 'auroc': 0.9130864, 'binary_precision': 0.944, 'binary_recall': 0.52444446, 'binary_specificity': 0.9688889, 'binary_f1_score': 0.67428577}
confusion matrix:
     0    1
0  218    7
1  107  118
early stop counter: 2
val acc:0.6570537686347961, best validation acc: 0.8597038388252258, corresponding to test acc:                         0.8733333349227905 / 0.8733333349227905
after epoch: 25,now: 2024-07-26 07:48:14.315210,epoch time: 0:01:28.635524,used: 0:36:46.329378,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_07_11_27_seed_3_23065779
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9938151, 'precision': 0.9938043, 'recall': 0.9938861, 'specificity': 0.9938861, 'f1': 0.99381477, 'auroc': 0.999799, 'binary_precision': 0.99935025, 'binary_recall': 0.9884319, 'binary_specificity': 0.99934036, 'binary_f1_score': 0.9938611}
confusion matrix:
      0     1
0  1515     1
1    18  1538
---- Validation: 
scalar performance:
{'acc': 0.74045205, 'precision': 0.8084502, 'recall': 0.7358107, 'specificity': 0.7358107, 'f1': 0.7227724, 'auroc': 0.87513924, 'binary_precision': 0.94848484, 'binary_recall': 0.49761525, 'binary_specificity': 0.9740061, 'binary_f1_score': 0.65276325}
confusion matrix:
     0    1
0  637   17
1  316  313
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8111111, 'precision': 0.8523805, 'recall': 0.8111111, 'specificity': 0.8111111, 'f1': 0.80541384, 'auroc': 0.91269135, 'binary_precision': 0.972973, 'binary_recall': 0.64, 'binary_specificity': 0.9822222, 'binary_f1_score': 0.772118}
confusion matrix:
     0    1
0  221    4
1   81  144
early stop counter: 3
val acc:0.7404520511627197, best validation acc: 0.8597038388252258, corresponding to test acc:                         0.8733333349227905 / 0.8733333349227905
after epoch: 26,now: 2024-07-26 07:49:42.441811,epoch time: 0:01:28.126601,used: 0:38:14.455979,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_07_11_27_seed_3_23065779
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.9941406, 'precision': 0.9941202, 'recall': 0.99421406, 'specificity': 0.99421406, 'f1': 0.99414015, 'auroc': 0.99948406, 'binary_precision': 0.9993515, 'binary_recall': 0.9890886, 'binary_specificity': 0.9993395, 'binary_f1_score': 0.9941936}
confusion matrix:
      0     1
0  1513     1
1    17  1541
---- Validation: 
scalar performance:
{'acc': 0.6710834, 'precision': 0.77915907, 'recall': 0.6649115, 'specificity': 0.6649115, 'f1': 0.63097, 'auroc': 0.85933447, 'binary_precision': 0.9480519, 'binary_recall': 0.3481717, 'binary_specificity': 0.98165137, 'binary_f1_score': 0.5093023}
confusion matrix:
     0    1
0  642   12
1  410  219
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7511111, 'precision': 0.81606627, 'recall': 0.75111115, 'specificity': 0.75111115, 'f1': 0.7376312, 'auroc': 0.91280985, 'binary_precision': 0.9593496, 'binary_recall': 0.52444446, 'binary_specificity': 0.9777778, 'binary_f1_score': 0.6781609}
confusion matrix:
     0    1
0  220    5
1  107  118
early stop counter: 4
val acc:0.671083390712738, best validation acc: 0.8597038388252258, corresponding to test acc:                         0.8733333349227905 / 0.8733333349227905
after epoch: 27,now: 2024-07-26 07:51:11.064914,epoch time: 0:01:28.623103,used: 0:39:43.079082,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_07_11_27_seed_3_23065779
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.99153644, 'precision': 0.9915322, 'recall': 0.9916239, 'specificity': 0.9916239, 'f1': 0.991536, 'auroc': 0.99986815, 'binary_precision': 0.9980481, 'binary_recall': 0.985228, 'binary_specificity': 0.9980198, 'binary_f1_score': 0.99159664}
confusion matrix:
      0     1
0  1512     3
1    23  1534
---- Validation: 
scalar performance:
{'acc': 0.7591582, 'precision': 0.81363225, 'recall': 0.7550405, 'specificity': 0.7550405, 'f1': 0.7461909, 'auroc': 0.857594, 'binary_precision': 0.9395604, 'binary_recall': 0.5437202, 'binary_specificity': 0.96636087, 'binary_f1_score': 0.6888217}
confusion matrix:
     0    1
0  632   22
1  287  342
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7733333, 'precision': 0.8226954, 'recall': 0.7733333, 'specificity': 0.7733333, 'f1': 0.76432055, 'auroc': 0.87867653, 'binary_precision': 0.9489051, 'binary_recall': 0.5777778, 'binary_specificity': 0.9688889, 'binary_f1_score': 0.71823215}
confusion matrix:
     0    1
0  218    7
1   95  130
early stop counter: 5
val acc:0.759158194065094, best validation acc: 0.8597038388252258, corresponding to test acc:                         0.8733333349227905 / 0.8733333349227905
after epoch: 28,now: 2024-07-26 07:52:39.511859,epoch time: 0:01:28.446945,used: 0:41:11.526027,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_07_11_27_seed_3_23065779
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9944661, 'precision': 0.99444807, 'recall': 0.99454427, 'specificity': 0.99454427, 'f1': 0.9944657, 'auroc': 0.999763, 'binary_precision': 1.0, 'binary_recall': 0.9890886, 'binary_specificity': 1.0, 'binary_f1_score': 0.9945144}
confusion matrix:
      0     1
0  1514     0
1    17  1541
---- Validation: 
scalar performance:
{'acc': 0.73343724, 'precision': 0.81500053, 'recall': 0.7284134, 'specificity': 0.7284134, 'f1': 0.71213704, 'auroc': 0.8916099, 'binary_precision': 0.9704918, 'binary_recall': 0.47058824, 'binary_specificity': 0.98623854, 'binary_f1_score': 0.63383293}
confusion matrix:
     0    1
0  645    9
1  333  296
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6888889, 'precision': 0.78801847, 'recall': 0.6888889, 'specificity': 0.6888889, 'f1': 0.6595993, 'auroc': 0.9249383, 'binary_precision': 0.9569892, 'binary_recall': 0.39555556, 'binary_specificity': 0.9822222, 'binary_f1_score': 0.5597484}
confusion matrix:
     0   1
0  221   4
1  136  89
early stop counter: 6
val acc:0.7334372401237488, best validation acc: 0.8597038388252258, corresponding to test acc:                         0.8733333349227905 / 0.8733333349227905
after epoch: 29,now: 2024-07-26 07:54:07.767835,epoch time: 0:01:28.255976,used: 0:42:39.782003,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_07_11_27_seed_3_23065779
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.9947917, 'precision': 0.9948553, 'recall': 0.9947462, 'specificity': 0.9947462, 'f1': 0.9947902, 'auroc': 0.99994445, 'binary_precision': 0.99170387, 'binary_recall': 0.9980732, 'binary_specificity': 0.99141914, 'binary_f1_score': 0.99487835}
confusion matrix:
      0     1
0  1502    13
1     3  1554
---- Validation: 
scalar performance:
{'acc': 0.7653936, 'precision': 0.81633604, 'recall': 0.76143026, 'specificity': 0.76143026, 'f1': 0.75366104, 'auroc': 0.8964772, 'binary_precision': 0.93850267, 'binary_recall': 0.55802864, 'binary_specificity': 0.9648318, 'binary_f1_score': 0.6999004}
confusion matrix:
     0    1
0  631   23
1  278  351
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.76666665, 'precision': 0.82754266, 'recall': 0.76666665, 'specificity': 0.76666665, 'f1': 0.7552967, 'auroc': 0.9312, 'binary_precision': 0.96875, 'binary_recall': 0.5511111, 'binary_specificity': 0.9822222, 'binary_f1_score': 0.7025496}
confusion matrix:
     0    1
0  221    4
1  101  124
early stop counter: 7
val acc:0.7653936147689819, best validation acc: 0.8597038388252258, corresponding to test acc:                         0.8733333349227905 / 0.8733333349227905
after epoch: 30,now: 2024-07-26 07:55:36.438848,epoch time: 0:01:28.671013,used: 0:44:08.453016,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_07_11_27_seed_3_23065779
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 0:44:08.453016 at 2024-07-26 07:55:36.438848
persisted model performance metric: 

scalar performance:
{'acc': 0.87333333, 'precision': 0.875, 'recall': 0.87333333, 'specificity': 0.87333333, 'f1': 0.8731924, 'auroc': 0.94044447, 'binary_precision': 0.9, 'binary_recall': 0.84, 'binary_specificity': 0.9066667, 'binary_f1_score': 0.8689655}
confusion matrix:
     0    1
0  204   21
1   36  189
oracle model performance metric: 

scalar performance:
{'acc': 0.87333333, 'precision': 0.875, 'recall': 0.87333333, 'specificity': 0.87333333, 'f1': 0.8731924, 'auroc': 0.94044447, 'binary_precision': 0.9, 'binary_recall': 0.84, 'binary_specificity': 0.9066667, 'binary_f1_score': 0.8689655}
confusion matrix:
     0    1
0  204   21
1   36  189
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_irm_10seeds_nofreeze_2024-07-26_02-28-54/rule_results/0.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_irm_10seeds_nofreeze_2024-07-26_02-28-54/confusion_matrix/0.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 455402 KiB |  13219 MiB | 294204 GiB | 294204 GiB |
|       from large pool | 414803 KiB |  13181 MiB | 290709 GiB | 290709 GiB |
|       from small pool |  40598 KiB |     60 MiB |   3494 GiB |   3494 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 455402 KiB |  13219 MiB | 294204 GiB | 294204 GiB |
|       from large pool | 414803 KiB |  13181 MiB | 290709 GiB | 290709 GiB |
|       from small pool |  40598 KiB |     60 MiB |   3494 GiB |   3494 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 447481 KiB |  13213 MiB | 293544 GiB | 293544 GiB |
|       from large pool | 407075 KiB |  13175 MiB | 290056 GiB | 290056 GiB |
|       from small pool |  40406 KiB |     60 MiB |   3487 GiB |   3487 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  14482 MiB |  14482 MiB |  55246 MiB |  40764 MiB |
|       from large pool |  14412 MiB |  14412 MiB |  55124 MiB |  40712 MiB |
|       from small pool |     70 MiB |     70 MiB |    122 MiB |     52 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 447766 KiB |   1236 MiB | 205940 GiB | 205939 GiB |
|       from large pool | 435116 KiB |   1229 MiB | 202424 GiB | 202423 GiB |
|       from small pool |  12649 KiB |     43 MiB |   3515 GiB |   3515 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    1310    |    2598    |   51930 K  |   51929 K  |
|       from large pool |     187    |    1413    |   26431 K  |   26431 K  |
|       from small pool |    1123    |    1419    |   25499 K  |   25498 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    1310    |    2598    |   51930 K  |   51929 K  |
|       from large pool |     187    |    1413    |   26431 K  |   26431 K  |
|       from small pool |    1123    |    1419    |   25499 K  |   25498 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     637    |     637    |    2356    |    1719    |
|       from large pool |     602    |     602    |    2295    |    1693    |
|       from small pool |      35    |      35    |      61    |      26    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     104    |     653    |   35413 K  |   35412 K  |
|       from large pool |      38    |     605    |   20477 K  |   20477 K  |
|       from small pool |      66    |     236    |   14935 K  |   14935 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13219 MiB | 294204 GiB | 294204 GiB |
|       from large pool |  16640 KiB |  13181 MiB | 290709 GiB | 290709 GiB |
|       from small pool |      0 KiB |     60 MiB |   3494 GiB |   3494 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13219 MiB | 294204 GiB | 294204 GiB |
|       from large pool |  16640 KiB |  13181 MiB | 290709 GiB | 290709 GiB |
|       from small pool |      0 KiB |     60 MiB |   3494 GiB |   3494 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13213 MiB | 293544 GiB | 293544 GiB |
|       from large pool |  16640 KiB |  13175 MiB | 290056 GiB | 290056 GiB |
|       from small pool |      0 KiB |     60 MiB |   3487 GiB |   3487 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    882 MiB |  14482 MiB |  55246 MiB |  54364 MiB |
|       from large pool |    830 MiB |  14412 MiB |  55124 MiB |  54294 MiB |
|       from small pool |     52 MiB |     70 MiB |    122 MiB |     70 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1236 MiB | 205940 GiB | 205940 GiB |
|       from large pool |  24320 KiB |   1229 MiB | 202424 GiB | 202424 GiB |
|       from small pool |      0 KiB |     44 MiB |   3515 GiB |   3515 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    2598    |   51930 K  |   51930 K  |
|       from large pool |       2    |    1413    |   26431 K  |   26431 K  |
|       from small pool |       0    |    1419    |   25499 K  |   25499 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    2598    |   51930 K  |   51930 K  |
|       from large pool |       2    |    1413    |   26431 K  |   26431 K  |
|       from small pool |       0    |    1419    |   25499 K  |   25499 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      63    |     637    |    2356    |    2293    |
|       from large pool |      37    |     602    |    2295    |    2258    |
|       from small pool |      26    |      35    |      61    |      35    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |     653    |   35413 K  |   35413 K  |
|       from large pool |       4    |     605    |   20477 K  |   20477 K  |
|       from small pool |       0    |     236    |   14936 K  |   14936 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13219 MiB | 294204 GiB | 294204 GiB |
|       from large pool |  16640 KiB |  13181 MiB | 290709 GiB | 290709 GiB |
|       from small pool |      0 KiB |     60 MiB |   3494 GiB |   3494 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13219 MiB | 294204 GiB | 294204 GiB |
|       from large pool |  16640 KiB |  13181 MiB | 290709 GiB | 290709 GiB |
|       from small pool |      0 KiB |     60 MiB |   3494 GiB |   3494 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13213 MiB | 293544 GiB | 293544 GiB |
|       from large pool |  16640 KiB |  13175 MiB | 290056 GiB | 290056 GiB |
|       from small pool |      0 KiB |     60 MiB |   3487 GiB |   3487 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    882 MiB |  14482 MiB |  55246 MiB |  54364 MiB |
|       from large pool |    830 MiB |  14412 MiB |  55124 MiB |  54294 MiB |
|       from small pool |     52 MiB |     70 MiB |    122 MiB |     70 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1236 MiB | 205940 GiB | 205940 GiB |
|       from large pool |  24320 KiB |   1229 MiB | 202424 GiB | 202424 GiB |
|       from small pool |      0 KiB |     44 MiB |   3515 GiB |   3515 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    2598    |   51930 K  |   51930 K  |
|       from large pool |       2    |    1413    |   26431 K  |   26431 K  |
|       from small pool |       0    |    1419    |   25499 K  |   25499 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    2598    |   51930 K  |   51930 K  |
|       from large pool |       2    |    1413    |   26431 K  |   26431 K  |
|       from small pool |       0    |    1419    |   25499 K  |   25499 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      63    |     637    |    2356    |    2293    |
|       from large pool |      37    |     602    |    2295    |    2258    |
|       from small pool |      26    |      35    |      61    |      35    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |     653    |   35413 K  |   35413 K  |
|       from large pool |       4    |     605    |   20477 K  |   20477 K  |
|       from small pool |       0    |     236    |   14936 K  |   14936 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'888c1ef2'
model name: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_07_56_04_seed_4_23065779

 Experiment start at: 2024-07-26 07:56:04.832783
before training, model accuracy: 0.6350710988044739
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9375, 'precision': 0.9419565, 'recall': 0.93854016, 'specificity': 0.93854016, 'f1': 0.93742204, 'auroc': 0.9888256, 'binary_precision': 0.9914591, 'binary_recall': 0.88500637, 'binary_specificity': 0.99207395, 'binary_f1_score': 0.9352132}
confusion matrix:
      0     1
0  1502    12
1   181  1393
---- Validation: 
scalar performance:
{'acc': 0.8056206, 'precision': 0.8062316, 'recall': 0.8059076, 'specificity': 0.8059076, 'f1': 0.8055974, 'auroc': 0.8722353, 'binary_precision': 0.7888386, 'binary_recall': 0.82753164, 'binary_specificity': 0.7842835, 'binary_f1_score': 0.8077221}
confusion matrix:
     0    1
0  509  140
1  109  523
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8293839, 'precision': 0.8293839, 'recall': 0.8293839, 'specificity': 0.8293839, 'f1': 0.8293839, 'auroc': 0.90568495, 'binary_precision': 0.8293839, 'binary_recall': 0.8293839, 'binary_specificity': 0.8293839, 'binary_f1_score': 0.8293839}
confusion matrix:
     0    1
0  175   36
1   36  175
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-26 07:57:34.134057,epoch time: 0:01:29.301274,used: 0:01:29.301274,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_07_56_04_seed_4_23065779
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9598446, 'precision': 0.96065736, 'recall': 0.96031713, 'specificity': 0.96031713, 'f1': 0.9598425, 'auroc': 0.9944182, 'binary_precision': 0.98526454, 'binary_recall': 0.93515575, 'binary_specificity': 0.9854785, 'binary_f1_score': 0.9595564}
confusion matrix:
      0     1
0  1493    22
1   102  1471
---- Validation: 
scalar performance:
{'acc': 0.7837627, 'precision': 0.80376446, 'recall': 0.78203565, 'specificity': 0.78203565, 'f1': 0.77940714, 'auroc': 0.8718891, 'binary_precision': 0.8784648, 'binary_recall': 0.65189874, 'binary_specificity': 0.91217256, 'binary_f1_score': 0.7484105}
confusion matrix:
     0    1
0  592   57
1  220  412
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8199052, 'precision': 0.8523191, 'recall': 0.8199052, 'specificity': 0.8199052, 'f1': 0.8156655, 'auroc': 0.91552305, 'binary_precision': 0.9591837, 'binary_recall': 0.66824645, 'binary_specificity': 0.971564, 'binary_f1_score': 0.78770953}
confusion matrix:
     0    1
0  205    6
1   70  141
early stop counter: 1
val acc:0.7837626934051514, best validation acc: 0.8056206107139587, corresponding to test acc:                         0.829383909702301 / 0.829383909702301
after epoch: 2,now: 2024-07-26 07:59:00.866194,epoch time: 0:01:26.732137,used: 0:02:56.033411,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_07_56_04_seed_4_23065779
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.95595855, 'precision': 0.9559311, 'recall': 0.9559679, 'specificity': 0.9559679, 'f1': 0.95594794, 'auroc': 0.99403167, 'binary_precision': 0.9578544, 'binary_recall': 0.955414, 'binary_specificity': 0.95652175, 'binary_f1_score': 0.9566327}
confusion matrix:
      0     1
0  1452    66
1    70  1500
---- Validation: 
scalar performance:
{'acc': 0.793911, 'precision': 0.81299186, 'recall': 0.7955326, 'specificity': 0.7955326, 'f1': 0.7913104, 'auroc': 0.9032616, 'binary_precision': 0.7323232, 'binary_recall': 0.9177215, 'binary_specificity': 0.6733436, 'binary_f1_score': 0.8146068}
confusion matrix:
     0    1
0  437  212
1   52  580
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7843602, 'precision': 0.80350983, 'recall': 0.7843602, 'specificity': 0.7843602, 'f1': 0.7809043, 'auroc': 0.9036859, 'binary_precision': 0.72727275, 'binary_recall': 0.9099526, 'binary_specificity': 0.65876776, 'binary_f1_score': 0.808421}
confusion matrix:
     0    1
0  139   72
1   19  192
early stop counter: 2
val acc:0.7939109802246094, best validation acc: 0.8056206107139587, corresponding to test acc:                         0.829383909702301 / 0.829383909702301
after epoch: 3,now: 2024-07-26 08:00:26.961706,epoch time: 0:01:26.095512,used: 0:04:22.128923,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_07_56_04_seed_4_23065779
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.97700775, 'precision': 0.9771409, 'recall': 0.97725284, 'specificity': 0.97725284, 'f1': 0.9770074, 'auroc': 0.99679416, 'binary_precision': 0.9908437, 'binary_recall': 0.96374047, 'binary_specificity': 0.99076515, 'binary_f1_score': 0.9771042}
confusion matrix:
      0     1
0  1502    14
1    57  1515
---- Validation: 
scalar performance:
{'acc': 0.8017174, 'precision': 0.8091617, 'recall': 0.80066705, 'specificity': 0.80066705, 'f1': 0.8001064, 'auroc': 0.87437344, 'binary_precision': 0.85393256, 'binary_recall': 0.721519, 'binary_specificity': 0.8798151, 'binary_f1_score': 0.7821612}
confusion matrix:
     0    1
0  571   78
1  176  456
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8270142, 'precision': 0.8291508, 'recall': 0.8270142, 'specificity': 0.8270142, 'f1': 0.826733, 'auroc': 0.917567, 'binary_precision': 0.80263156, 'binary_recall': 0.8672986, 'binary_specificity': 0.7867299, 'binary_f1_score': 0.83371294}
confusion matrix:
     0    1
0  166   45
1   28  183
early stop counter: 3
val acc:0.8017174005508423, best validation acc: 0.8056206107139587, corresponding to test acc:                         0.829383909702301 / 0.829383909702301
after epoch: 4,now: 2024-07-26 08:01:53.811727,epoch time: 0:01:26.850021,used: 0:05:48.978944,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_07_56_04_seed_4_23065779
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9682642, 'precision': 0.9691942, 'recall': 0.9687642, 'specificity': 0.9687642, 'f1': 0.9682621, 'auroc': 0.9983605, 'binary_precision': 0.99529886, 'binary_recall': 0.94214875, 'binary_specificity': 0.99537957, 'binary_f1_score': 0.9679948}
confusion matrix:
      0     1
0  1508     7
1    91  1482
---- Validation: 
scalar performance:
{'acc': 0.6721311, 'precision': 0.78117573, 'recall': 0.66794944, 'specificity': 0.66794944, 'f1': 0.633685, 'auroc': 0.870692, 'binary_precision': 0.9529914, 'binary_recall': 0.3528481, 'binary_specificity': 0.9830508, 'binary_f1_score': 0.51501155}
confusion matrix:
     0    1
0  638   11
1  409  223
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7298578, 'precision': 0.8114557, 'recall': 0.7298578, 'specificity': 0.7298578, 'f1': 0.7109242, 'auroc': 0.9088969, 'binary_precision': 0.9708738, 'binary_recall': 0.47393364, 'binary_specificity': 0.98578197, 'binary_f1_score': 0.6369427}
confusion matrix:
     0    1
0  208    3
1  111  100
early stop counter: 4
val acc:0.6721311211585999, best validation acc: 0.8056206107139587, corresponding to test acc:                         0.829383909702301 / 0.829383909702301
after epoch: 5,now: 2024-07-26 08:03:20.342466,epoch time: 0:01:26.530739,used: 0:07:15.509683,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_07_56_04_seed_4_23065779
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9705311, 'precision': 0.9716687, 'recall': 0.97107434, 'specificity': 0.97107434, 'f1': 0.97052777, 'auroc': 0.99866056, 'binary_precision': 1.0, 'binary_recall': 0.94214875, 'binary_specificity': 1.0, 'binary_f1_score': 0.9702128}
confusion matrix:
      0     1
0  1515     0
1    91  1482
---- Validation: 
scalar performance:
{'acc': 0.6752537, 'precision': 0.77413106, 'recall': 0.6712177, 'specificity': 0.6712177, 'f1': 0.63997406, 'auroc': 0.8705311, 'binary_precision': 0.9354839, 'binary_recall': 0.36708862, 'binary_specificity': 0.9753467, 'binary_f1_score': 0.52727276}
confusion matrix:
     0    1
0  633   16
1  400  232
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.67535543, 'precision': 0.7909585, 'recall': 0.67535543, 'specificity': 0.67535543, 'f1': 0.63955235, 'auroc': 0.9089868, 'binary_precision': 0.974359, 'binary_recall': 0.3601896, 'binary_specificity': 0.9905213, 'binary_f1_score': 0.52595156}
confusion matrix:
     0   1
0  209   2
1  135  76
early stop counter: 5
val acc:0.675253689289093, best validation acc: 0.8056206107139587, corresponding to test acc:                         0.829383909702301 / 0.829383909702301
after epoch: 6,now: 2024-07-26 08:04:46.963496,epoch time: 0:01:26.621030,used: 0:08:42.130713,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_07_56_04_seed_4_23065779
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9779793, 'precision': 0.97809374, 'recall': 0.97829676, 'specificity': 0.97829676, 'f1': 0.9779781, 'auroc': 0.9976754, 'binary_precision': 0.99281985, 'binary_recall': 0.96387833, 'binary_specificity': 0.99271524, 'binary_f1_score': 0.97813505}
confusion matrix:
      0     1
0  1499    11
1    57  1521
---- Validation: 
scalar performance:
{'acc': 0.78454334, 'precision': 0.7978081, 'recall': 0.78311694, 'specificity': 0.78311694, 'f1': 0.7815074, 'auroc': 0.87337136, 'binary_precision': 0.85742974, 'binary_recall': 0.6756329, 'binary_specificity': 0.8906009, 'binary_f1_score': 0.7557522}
confusion matrix:
     0    1
0  578   71
1  205  427
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8672986, 'precision': 0.8674306, 'recall': 0.8672986, 'specificity': 0.8672986, 'f1': 0.8672867, 'auroc': 0.936412, 'binary_precision': 0.87439615, 'binary_recall': 0.8578199, 'binary_specificity': 0.87677723, 'binary_f1_score': 0.8660287}
confusion matrix:
     0    1
0  185   26
1   30  181
new oracle model saved
early stop counter: 6
val acc:0.7845433354377747, best validation acc: 0.8056206107139587, corresponding to test acc:                         0.829383909702301 / 0.8672986030578613
after epoch: 7,now: 2024-07-26 08:06:13.719842,epoch time: 0:01:26.756346,used: 0:10:08.887059,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_07_56_04_seed_4_23065779
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.97506475, 'precision': 0.9757385, 'recall': 0.97479093, 'specificity': 0.97479093, 'f1': 0.97503805, 'auroc': 0.9980782, 'binary_precision': 0.96168107, 'binary_recall': 0.99045193, 'binary_specificity': 0.95912987, 'binary_f1_score': 0.9758545}
confusion matrix:
      0     1
0  1455    62
1    15  1556
---- Validation: 
scalar performance:
{'acc': 0.84153, 'precision': 0.8455492, 'recall': 0.8408079, 'specificity': 0.8408079, 'f1': 0.8408457, 'auroc': 0.90923715, 'binary_precision': 0.879646, 'binary_recall': 0.7863924, 'binary_specificity': 0.89522344, 'binary_f1_score': 0.83040935}
confusion matrix:
     0    1
0  581   68
1  135  497
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8672986, 'precision': 0.87388253, 'recall': 0.8672986, 'specificity': 0.8672986, 'f1': 0.8667118, 'auroc': 0.9459356, 'binary_precision': 0.92349726, 'binary_recall': 0.80094784, 'binary_specificity': 0.9336493, 'binary_f1_score': 0.857868}
confusion matrix:
     0    1
0  197   14
1   42  169
better model found
persisted
after epoch: 8,now: 2024-07-26 08:07:40.192607,epoch time: 0:01:26.472765,used: 0:11:35.359824,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_07_56_04_seed_4_23065779
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.98639894, 'precision': 0.9864494, 'recall': 0.9863515, 'specificity': 0.9863515, 'f1': 0.9863938, 'auroc': 0.99924684, 'binary_precision': 0.98415715, 'binary_recall': 0.989172, 'binary_specificity': 0.98353094, 'binary_f1_score': 0.9866582}
confusion matrix:
      0     1
0  1493    25
1    17  1553
---- Validation: 
scalar performance:
{'acc': 0.7806401, 'precision': 0.7908443, 'recall': 0.7793684, 'specificity': 0.7793684, 'f1': 0.7781394, 'auroc': 0.8647115, 'binary_precision': 0.84210527, 'binary_recall': 0.6835443, 'binary_specificity': 0.8751926, 'binary_f1_score': 0.75458515}
confusion matrix:
     0    1
0  568   81
1  200  432
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.83886254, 'precision': 0.8413467, 'recall': 0.83886254, 'specificity': 0.83886254, 'f1': 0.83856887, 'auroc': 0.92594504, 'binary_precision': 0.8704663, 'binary_recall': 0.79620856, 'binary_specificity': 0.8815166, 'binary_f1_score': 0.8316832}
confusion matrix:
     0    1
0  186   25
1   43  168
early stop counter: 1
val acc:0.7806401252746582, best validation acc: 0.8415300250053406, corresponding to test acc:                         0.8672986030578613 / 0.8672986030578613
after epoch: 9,now: 2024-07-26 08:09:07.525382,epoch time: 0:01:27.332775,used: 0:13:02.692599,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_07_56_04_seed_4_23065779
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9860751, 'precision': 0.98613685, 'recall': 0.98629534, 'specificity': 0.98629534, 'f1': 0.98607445, 'auroc': 0.9994142, 'binary_precision': 0.9980469, 'binary_recall': 0.9745709, 'binary_specificity': 0.9980198, 'binary_f1_score': 0.98616916}
confusion matrix:
      0     1
0  1512     3
1    40  1533
---- Validation: 
scalar performance:
{'acc': 0.774395, 'precision': 0.7873311, 'recall': 0.7729565, 'specificity': 0.7729565, 'f1': 0.77117324, 'auroc': 0.8799224, 'binary_precision': 0.8450704, 'binary_recall': 0.664557, 'binary_specificity': 0.88135594, 'binary_f1_score': 0.7440213}
confusion matrix:
     0    1
0  572   77
1  212  420
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.80331755, 'precision': 0.84456015, 'recall': 0.80331755, 'specificity': 0.80331755, 'f1': 0.79725045, 'auroc': 0.9263494, 'binary_precision': 0.9637681, 'binary_recall': 0.63033175, 'binary_specificity': 0.97630334, 'binary_f1_score': 0.76217765}
confusion matrix:
     0    1
0  206    5
1   78  133
early stop counter: 2
val acc:0.7743949890136719, best validation acc: 0.8415300250053406, corresponding to test acc:                         0.8672986030578613 / 0.8672986030578613
after epoch: 10,now: 2024-07-26 08:10:33.974098,epoch time: 0:01:26.448716,used: 0:14:29.141315,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_07_56_04_seed_4_23065779
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9572539, 'precision': 0.95927304, 'recall': 0.95667124, 'specificity': 0.95667124, 'f1': 0.95715284, 'auroc': 0.9961457, 'binary_precision': 0.9332933, 'binary_recall': 0.9866582, 'binary_specificity': 0.92668426, 'binary_f1_score': 0.9592341}
confusion matrix:
      0     1
0  1403   111
1    21  1553
---- Validation: 
scalar performance:
{'acc': 0.7892272, 'precision': 0.7938583, 'recall': 0.7900397, 'specificity': 0.7900397, 'f1': 0.78868306, 'auroc': 0.87498295, 'binary_precision': 0.7535014, 'binary_recall': 0.85126585, 'binary_specificity': 0.7288136, 'binary_f1_score': 0.79940563}
confusion matrix:
     0    1
0  473  176
1   94  538
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8199052, 'precision': 0.81993395, 'recall': 0.8199052, 'specificity': 0.8199052, 'f1': 0.81990117, 'auroc': 0.8994632, 'binary_precision': 0.8169014, 'binary_recall': 0.82464457, 'binary_specificity': 0.8151659, 'binary_f1_score': 0.8207547}
confusion matrix:
     0    1
0  172   39
1   37  174
early stop counter: 3
val acc:0.7892271876335144, best validation acc: 0.8415300250053406, corresponding to test acc:                         0.8672986030578613 / 0.8672986030578613
after epoch: 11,now: 2024-07-26 08:12:01.763324,epoch time: 0:01:27.789226,used: 0:15:56.930541,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_07_56_04_seed_4_23065779
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.98704666, 'precision': 0.98701274, 'recall': 0.98715985, 'specificity': 0.98715985, 'f1': 0.9870448, 'auroc': 0.9994978, 'binary_precision': 0.9935567, 'binary_recall': 0.980916, 'binary_specificity': 0.9934037, 'binary_f1_score': 0.98719585}
confusion matrix:
      0     1
0  1506    10
1    30  1542
---- Validation: 
scalar performance:
{'acc': 0.75409836, 'precision': 0.80729675, 'recall': 0.7513092, 'specificity': 0.7513092, 'f1': 0.74157465, 'auroc': 0.89711046, 'binary_precision': 0.9318801, 'binary_recall': 0.54113925, 'binary_specificity': 0.9614792, 'binary_f1_score': 0.68468475}
confusion matrix:
     0    1
0  624   25
1  290  342
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.67772514, 'precision': 0.7978543, 'recall': 0.67772514, 'specificity': 0.67772514, 'f1': 0.6415868, 'auroc': 0.95222485, 'binary_precision': 0.987013, 'binary_recall': 0.3601896, 'binary_specificity': 0.99526066, 'binary_f1_score': 0.5277778}
confusion matrix:
     0   1
0  210   1
1  135  76
early stop counter: 4
val acc:0.7540983557701111, best validation acc: 0.8415300250053406, corresponding to test acc:                         0.8672986030578613 / 0.8672986030578613
after epoch: 12,now: 2024-07-26 08:13:27.787195,epoch time: 0:01:26.023871,used: 0:17:22.954412,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_07_56_04_seed_4_23065779
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.96988344, 'precision': 0.971136, 'recall': 0.97038215, 'specificity': 0.97038215, 'f1': 0.9698781, 'auroc': 0.9987904, 'binary_precision': 1.0, 'binary_recall': 0.9407643, 'binary_specificity': 1.0, 'binary_f1_score': 0.9694782}
confusion matrix:
      0     1
0  1518     0
1    93  1477
---- Validation: 
scalar performance:
{'acc': 0.6775956, 'precision': 0.7787199, 'recall': 0.67354965, 'specificity': 0.67354965, 'f1': 0.6423764, 'auroc': 0.89355826, 'binary_precision': 0.94331986, 'binary_recall': 0.36867088, 'binary_specificity': 0.97842836, 'binary_f1_score': 0.5301479}
confusion matrix:
     0    1
0  635   14
1  399  233
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6279621, 'precision': 0.77795666, 'recall': 0.6279621, 'specificity': 0.6279621, 'f1': 0.56994396, 'auroc': 0.9432852, 'binary_precision': 0.98214287, 'binary_recall': 0.2606635, 'binary_specificity': 0.99526066, 'binary_f1_score': 0.411985}
confusion matrix:
     0   1
0  210   1
1  156  55
early stop counter: 5
val acc:0.6775956153869629, best validation acc: 0.8415300250053406, corresponding to test acc:                         0.8672986030578613 / 0.8672986030578613
after epoch: 13,now: 2024-07-26 08:14:54.759582,epoch time: 0:01:26.972387,used: 0:18:49.926799,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_07_56_04_seed_4_23065779
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.98801816, 'precision': 0.98801243, 'recall': 0.98817277, 'specificity': 0.98817277, 'f1': 0.9880171, 'auroc': 0.9996396, 'binary_precision': 0.99676377, 'binary_recall': 0.97964376, 'binary_specificity': 0.99670184, 'binary_f1_score': 0.9881296}
confusion matrix:
      0     1
0  1511     5
1    32  1540
---- Validation: 
scalar performance:
{'acc': 0.6651054, 'precision': 0.766817, 'recall': 0.6609535, 'specificity': 0.6609535, 'f1': 0.6264664, 'auroc': 0.88014174, 'binary_precision': 0.92827004, 'binary_recall': 0.34810126, 'binary_specificity': 0.97380584, 'binary_f1_score': 0.5063291}
confusion matrix:
     0    1
0  632   17
1  412  220
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6800948, 'precision': 0.79305553, 'recall': 0.6800948, 'specificity': 0.6800948, 'f1': 0.64597976, 'auroc': 0.92342937, 'binary_precision': 0.975, 'binary_recall': 0.36966825, 'binary_specificity': 0.9905213, 'binary_f1_score': 0.53608245}
confusion matrix:
     0   1
0  209   2
1  133  78
early stop counter: 6
val acc:0.665105402469635, best validation acc: 0.8415300250053406, corresponding to test acc:                         0.8672986030578613 / 0.8672986030578613
after epoch: 14,now: 2024-07-26 08:16:21.050794,epoch time: 0:01:26.291212,used: 0:20:16.218011,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_07_56_04_seed_4_23065779
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.98704666, 'precision': 0.98700714, 'recall': 0.98710114, 'specificity': 0.98710114, 'f1': 0.98704374, 'auroc': 0.9990622, 'binary_precision': 0.9903969, 'binary_recall': 0.9840967, 'binary_specificity': 0.99010557, 'binary_f1_score': 0.98723674}
confusion matrix:
      0     1
0  1501    15
1    25  1547
---- Validation: 
scalar performance:
{'acc': 0.7564403, 'precision': 0.760924, 'recall': 0.755527, 'specificity': 0.755527, 'f1': 0.7549168, 'auroc': 0.8377762, 'binary_precision': 0.7919708, 'binary_recall': 0.68670887, 'binary_specificity': 0.8243452, 'binary_f1_score': 0.7355932}
confusion matrix:
     0    1
0  535  114
1  198  434
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8507109, 'precision': 0.85071874, 'recall': 0.85071087, 'specificity': 0.85071087, 'f1': 0.85071003, 'auroc': 0.90882957, 'binary_precision': 0.8490566, 'binary_recall': 0.8530806, 'binary_specificity': 0.8483412, 'binary_f1_score': 0.8510638}
confusion matrix:
     0    1
0  179   32
1   31  180
early stop counter: 7
val acc:0.756440281867981, best validation acc: 0.8415300250053406, corresponding to test acc:                         0.8672986030578613 / 0.8672986030578613
after epoch: 15,now: 2024-07-26 08:17:48.142467,epoch time: 0:01:27.091673,used: 0:21:43.309684,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_07_56_04_seed_4_23065779
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9906088, 'precision': 0.9906908, 'recall': 0.9905436, 'specificity': 0.9905436, 'f1': 0.9906047, 'auroc': 0.99953806, 'binary_precision': 0.9873578, 'binary_recall': 0.99427116, 'binary_specificity': 0.9868161, 'binary_f1_score': 0.99080247}
confusion matrix:
      0     1
0  1497    20
1     9  1562
---- Validation: 
scalar performance:
{'acc': 0.7907885, 'precision': 0.8207519, 'recall': 0.78874147, 'specificity': 0.78874147, 'f1': 0.784954, 'auroc': 0.9018012, 'binary_precision': 0.91552514, 'binary_recall': 0.63449365, 'binary_specificity': 0.94298923, 'binary_f1_score': 0.7495327}
confusion matrix:
     0    1
0  612   37
1  231  401
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8341232, 'precision': 0.87284756, 'recall': 0.83412325, 'specificity': 0.83412325, 'f1': 0.8297014, 'auroc': 0.9490802, 'binary_precision': 0.993007, 'binary_recall': 0.6729858, 'binary_specificity': 0.99526066, 'binary_f1_score': 0.8022599}
confusion matrix:
     0    1
0  210    1
1   69  142
early stop counter: 8
val acc:0.790788471698761, best validation acc: 0.8415300250053406, corresponding to test acc:                         0.8672986030578613 / 0.8672986030578613
after epoch: 16,now: 2024-07-26 08:19:14.248171,epoch time: 0:01:26.105704,used: 0:23:09.415388,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_07_56_04_seed_4_23065779
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.98154145, 'precision': 0.9816876, 'recall': 0.9818491, 'specificity': 0.9818491, 'f1': 0.9815409, 'auroc': 0.9988804, 'binary_precision': 0.9967299, 'binary_recall': 0.9670051, 'binary_specificity': 0.99669313, 'binary_f1_score': 0.9816425}
confusion matrix:
      0     1
0  1507     5
1    52  1524
---- Validation: 
scalar performance:
{'acc': 0.8071819, 'precision': 0.8313462, 'recall': 0.80537605, 'specificity': 0.80537605, 'f1': 0.8029374, 'auroc': 0.91196287, 'binary_precision': 0.9175705, 'binary_recall': 0.6693038, 'binary_specificity': 0.9414484, 'binary_f1_score': 0.77401644}
confusion matrix:
     0    1
0  611   38
1  209  423
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8672986, 'precision': 0.8796109, 'recall': 0.8672986, 'specificity': 0.8672986, 'f1': 0.8662138, 'auroc': 0.938748, 'binary_precision': 0.9479769, 'binary_recall': 0.7772512, 'binary_specificity': 0.95734596, 'binary_f1_score': 0.8541667}
confusion matrix:
     0    1
0  202    9
1   47  164
early stop counter: 9
val acc:0.8071818947792053, best validation acc: 0.8415300250053406, corresponding to test acc:                         0.8672986030578613 / 0.8672986030578613
after epoch: 17,now: 2024-07-26 08:20:41.417553,epoch time: 0:01:27.169382,used: 0:24:36.584770,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_07_56_04_seed_4_23065779
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.98542744, 'precision': 0.9854286, 'recall': 0.98541737, 'specificity': 0.98541737, 'f1': 0.9854228, 'auroc': 0.9985939, 'binary_precision': 0.98536897, 'binary_recall': 0.9859962, 'binary_specificity': 0.9848385, 'binary_f1_score': 0.9856824}
confusion matrix:
      0     1
0  1494    23
1    22  1549
---- Validation: 
scalar performance:
{'acc': 0.8516784, 'precision': 0.8559638, 'recall': 0.8509477, 'specificity': 0.8509477, 'f1': 0.8510225, 'auroc': 0.9152421, 'binary_precision': 0.891844, 'binary_recall': 0.7958861, 'binary_specificity': 0.90600926, 'binary_f1_score': 0.8411371}
confusion matrix:
     0    1
0  588   61
1  129  503
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8886256, 'precision': 0.8911648, 'recall': 0.8886256, 'specificity': 0.8886256, 'f1': 0.8884446, 'auroc': 0.94937223, 'binary_precision': 0.92268044, 'binary_recall': 0.8483412, 'binary_specificity': 0.92890996, 'binary_f1_score': 0.88395065}
confusion matrix:
     0    1
0  196   15
1   32  179
new oracle model saved
better model found
persisted
after epoch: 18,now: 2024-07-26 08:22:08.189948,epoch time: 0:01:26.772395,used: 0:26:03.357165,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_07_56_04_seed_4_23065779
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9876943, 'precision': 0.9877144, 'recall': 0.98788464, 'specificity': 0.98788464, 'f1': 0.9876934, 'auroc': 0.9993752, 'binary_precision': 0.9980532, 'binary_recall': 0.9777495, 'binary_specificity': 0.9980198, 'binary_f1_score': 0.9877971}
confusion matrix:
      0     1
0  1512     3
1    35  1538
---- Validation: 
scalar performance:
{'acc': 0.83684623, 'precision': 0.8521035, 'recall': 0.83546007, 'specificity': 0.83546007, 'f1': 0.83463883, 'auroc': 0.9248552, 'binary_precision': 0.9221557, 'binary_recall': 0.73101264, 'binary_specificity': 0.93990755, 'binary_f1_score': 0.81553394}
confusion matrix:
     0    1
0  610   39
1  170  462
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.80094784, 'precision': 0.8431553, 'recall': 0.8009479, 'specificity': 0.8009479, 'f1': 0.7946329, 'auroc': 0.93241394, 'binary_precision': 0.96350366, 'binary_recall': 0.6255924, 'binary_specificity': 0.97630334, 'binary_f1_score': 0.7586207}
confusion matrix:
     0    1
0  206    5
1   79  132
early stop counter: 1
val acc:0.8368462324142456, best validation acc: 0.8516783714294434, corresponding to test acc:                         0.8886256217956543 / 0.8886256217956543
after epoch: 19,now: 2024-07-26 08:23:34.724419,epoch time: 0:01:26.534471,used: 0:27:29.891636,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_07_56_04_seed_4_23065779
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9925518, 'precision': 0.9925071, 'recall': 0.9926405, 'specificity': 0.9926405, 'f1': 0.9925504, 'auroc': 0.9998275, 'binary_precision': 0.9974326, 'binary_recall': 0.9879212, 'binary_specificity': 0.99735975, 'binary_f1_score': 0.9926541}
confusion matrix:
      0     1
0  1511     4
1    19  1554
---- Validation: 
scalar performance:
{'acc': 0.7080406, 'precision': 0.79903847, 'recall': 0.7043419, 'specificity': 0.7043419, 'f1': 0.68162286, 'auroc': 0.9216473, 'binary_precision': 0.9607143, 'binary_recall': 0.42563292, 'binary_specificity': 0.9830508, 'binary_f1_score': 0.5899123}
confusion matrix:
     0    1
0  638   11
1  363  269
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6255924, 'precision': 0.77701265, 'recall': 0.6255924, 'specificity': 0.6255924, 'f1': 0.5663293, 'auroc': 0.94110644, 'binary_precision': 0.9818182, 'binary_recall': 0.25592417, 'binary_specificity': 0.99526066, 'binary_f1_score': 0.406015}
confusion matrix:
     0   1
0  210   1
1  157  54
early stop counter: 2
val acc:0.7080405950546265, best validation acc: 0.8516783714294434, corresponding to test acc:                         0.8886256217956543 / 0.8886256217956543
after epoch: 20,now: 2024-07-26 08:25:01.528993,epoch time: 0:01:26.804574,used: 0:28:56.696210,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_07_56_04_seed_4_23065779
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9857513, 'precision': 0.98591566, 'recall': 0.9856367, 'specificity': 0.9856367, 'f1': 0.9857427, 'auroc': 0.9994436, 'binary_precision': 0.9805154, 'binary_recall': 0.9917355, 'binary_specificity': 0.97953796, 'binary_f1_score': 0.9860936}
confusion matrix:
      0     1
0  1484    31
1    13  1560
---- Validation: 
scalar performance:
{'acc': 0.86416864, 'precision': 0.8674406, 'recall': 0.86354375, 'specificity': 0.86354375, 'f1': 0.8637014, 'auroc': 0.93149877, 'binary_precision': 0.8989547, 'binary_recall': 0.8164557, 'binary_specificity': 0.9106317, 'binary_f1_score': 0.85572135}
confusion matrix:
     0    1
0  591   58
1  116  516
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8815166, 'precision': 0.8988611, 'recall': 0.8815166, 'specificity': 0.8815166, 'f1': 0.88021433, 'auroc': 0.9484513, 'binary_precision': 0.98203593, 'binary_recall': 0.7772512, 'binary_specificity': 0.98578197, 'binary_f1_score': 0.8677249}
confusion matrix:
     0    1
0  208    3
1   47  164
better model found
persisted
after epoch: 21,now: 2024-07-26 08:26:28.261325,epoch time: 0:01:26.732332,used: 0:30:23.428542,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_07_56_04_seed_4_23065779
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.99093264, 'precision': 0.99090016, 'recall': 0.9910633, 'specificity': 0.9910633, 'f1': 0.99093145, 'auroc': 0.9995749, 'binary_precision': 0.99806577, 'binary_recall': 0.9841068, 'binary_specificity': 0.9980198, 'binary_f1_score': 0.9910372}
confusion matrix:
      0     1
0  1512     3
1    25  1548
---- Validation: 
scalar performance:
{'acc': 0.5448868, 'precision': 0.75361073, 'recall': 0.53878653, 'specificity': 0.53878653, 'f1': 0.41807073, 'auroc': 0.89697754, 'binary_precision': 0.98039216, 'binary_recall': 0.07911392, 'binary_specificity': 0.99845916, 'binary_f1_score': 0.14641288}
confusion matrix:
     0   1
0  648   1
1  582  50
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.50236964, 'precision': 0.7505938, 'recall': 0.50236964, 'specificity': 0.50236964, 'f1': 0.33857775, 'auroc': 0.911407, 'binary_precision': 1.0, 'binary_recall': 0.0047393367, 'binary_specificity': 1.0, 'binary_f1_score': 0.009433963}
confusion matrix:
     0  1
0  211  0
1  210  1
early stop counter: 1
val acc:0.5448868274688721, best validation acc: 0.864168643951416, corresponding to test acc:                         0.8815165758132935 / 0.8886256217956543
after epoch: 22,now: 2024-07-26 08:27:55.112185,epoch time: 0:01:26.850860,used: 0:31:50.279402,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_07_56_04_seed_4_23065779
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.97862697, 'precision': 0.9791116, 'recall': 0.9789829, 'specificity': 0.9789829, 'f1': 0.9786267, 'auroc': 0.99956656, 'binary_precision': 0.9993364, 'binary_recall': 0.9586251, 'binary_specificity': 0.99934083, 'binary_f1_score': 0.97855747}
confusion matrix:
      0     1
0  1516     1
1    65  1506
---- Validation: 
scalar performance:
{'acc': 0.7384856, 'precision': 0.8093493, 'recall': 0.7352792, 'specificity': 0.7352792, 'f1': 0.72084725, 'auroc': 0.9224672, 'binary_precision': 0.95412844, 'binary_recall': 0.49367088, 'binary_specificity': 0.9768875, 'binary_f1_score': 0.6506778}
confusion matrix:
     0    1
0  634   15
1  320  312
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6540284, 'precision': 0.7815412, 'recall': 0.6540284, 'specificity': 0.6540284, 'f1': 0.6098531, 'auroc': 0.9111656, 'binary_precision': 0.9710145, 'binary_recall': 0.31753555, 'binary_specificity': 0.9905213, 'binary_f1_score': 0.47857141}
confusion matrix:
     0   1
0  209   2
1  144  67
early stop counter: 2
val acc:0.73848557472229, best validation acc: 0.864168643951416, corresponding to test acc:                         0.8815165758132935 / 0.8886256217956543
after epoch: 23,now: 2024-07-26 08:29:21.750948,epoch time: 0:01:26.638763,used: 0:33:16.918165,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_07_56_04_seed_4_23065779
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9906088, 'precision': 0.9905767, 'recall': 0.9907136, 'specificity': 0.9907136, 'f1': 0.9906076, 'auroc': 0.9995401, 'binary_precision': 0.99677837, 'binary_recall': 0.9847231, 'binary_specificity': 0.99670404, 'binary_f1_score': 0.9907141}
confusion matrix:
      0     1
0  1512     5
1    24  1547
---- Validation: 
scalar performance:
{'acc': 0.77751756, 'precision': 0.8278376, 'recall': 0.7748983, 'specificity': 0.7748983, 'f1': 0.7674921, 'auroc': 0.9266715, 'binary_precision': 0.95300263, 'binary_recall': 0.57753164, 'binary_specificity': 0.972265, 'binary_f1_score': 0.7192118}
confusion matrix:
     0    1
0  631   18
1  267  365
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.73459715, 'precision': 0.8178775, 'recall': 0.73459715, 'specificity': 0.73459715, 'f1': 0.71599567, 'auroc': 0.93962395, 'binary_precision': 0.98058254, 'binary_recall': 0.47867298, 'binary_specificity': 0.9905213, 'binary_f1_score': 0.6433121}
confusion matrix:
     0    1
0  209    2
1  110  101
early stop counter: 3
val acc:0.777517557144165, best validation acc: 0.864168643951416, corresponding to test acc:                         0.8815165758132935 / 0.8886256217956543
after epoch: 24,now: 2024-07-26 08:30:49.158422,epoch time: 0:01:27.407474,used: 0:34:44.325639,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_07_56_04_seed_4_23065779
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.9935233, 'precision': 0.993489, 'recall': 0.99357605, 'specificity': 0.99357605, 'f1': 0.9935221, 'auroc': 0.9998343, 'binary_precision': 0.9967949, 'binary_recall': 0.99044585, 'binary_specificity': 0.9967062, 'binary_f1_score': 0.9936102}
confusion matrix:
      0     1
0  1513     5
1    15  1555
---- Validation: 
scalar performance:
{'acc': 0.8274785, 'precision': 0.85147107, 'recall': 0.8257385, 'specificity': 0.8257385, 'f1': 0.8239243, 'auroc': 0.9323527, 'binary_precision': 0.94004285, 'binary_recall': 0.69462025, 'binary_specificity': 0.9568567, 'binary_f1_score': 0.7989081}
confusion matrix:
     0    1
0  621   28
1  193  439
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8459716, 'precision': 0.8775245, 'recall': 0.8459716, 'specificity': 0.8459716, 'f1': 0.8426845, 'auroc': 0.95538616, 'binary_precision': 0.9866667, 'binary_recall': 0.7014218, 'binary_specificity': 0.9905213, 'binary_f1_score': 0.8199446}
confusion matrix:
     0    1
0  209    2
1   63  148
early stop counter: 4
val acc:0.8274785280227661, best validation acc: 0.864168643951416, corresponding to test acc:                         0.8815165758132935 / 0.8886256217956543
after epoch: 25,now: 2024-07-26 08:32:15.554040,epoch time: 0:01:26.395618,used: 0:36:10.721257,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_07_56_04_seed_4_23065779
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.99287564, 'precision': 0.9928491, 'recall': 0.9929682, 'specificity': 0.9929682, 'f1': 0.99287486, 'auroc': 0.9995384, 'binary_precision': 0.9987105, 'binary_recall': 0.987253, 'binary_specificity': 0.99868333, 'binary_f1_score': 0.9929487}
confusion matrix:
      0     1
0  1517     2
1    20  1549
---- Validation: 
scalar performance:
{'acc': 0.70725995, 'precision': 0.7971477, 'recall': 0.7035715, 'specificity': 0.7035715, 'f1': 0.6809279, 'auroc': 0.9255787, 'binary_precision': 0.95729536, 'binary_recall': 0.42563292, 'binary_specificity': 0.98151004, 'binary_f1_score': 0.5892662}
confusion matrix:
     0    1
0  637   12
1  363  269
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.53317535, 'precision': 0.7273707, 'recall': 0.53317535, 'specificity': 0.53317535, 'f1': 0.40643588, 'auroc': 0.92971855, 'binary_precision': 0.9375, 'binary_recall': 0.07109005, 'binary_specificity': 0.99526066, 'binary_f1_score': 0.13215858}
confusion matrix:
     0   1
0  210   1
1  196  15
early stop counter: 5
val acc:0.7072599530220032, best validation acc: 0.864168643951416, corresponding to test acc:                         0.8815165758132935 / 0.8886256217956543
after epoch: 26,now: 2024-07-26 08:33:42.671291,epoch time: 0:01:27.117251,used: 0:37:37.838508,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_07_56_04_seed_4_23065779
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.9957902, 'precision': 0.99576056, 'recall': 0.99582195, 'specificity': 0.99582195, 'f1': 0.99578863, 'auroc': 0.99993956, 'binary_precision': 0.99745387, 'binary_recall': 0.99428934, 'binary_specificity': 0.9973545, 'binary_f1_score': 0.9958691}
confusion matrix:
      0     1
0  1508     4
1     9  1567
---- Validation: 
scalar performance:
{'acc': 0.84387195, 'precision': 0.85021806, 'recall': 0.84297407, 'specificity': 0.84297407, 'f1': 0.8428954, 'auroc': 0.9191283, 'binary_precision': 0.89416057, 'binary_recall': 0.7753165, 'binary_specificity': 0.9106317, 'binary_f1_score': 0.83050853}
confusion matrix:
     0    1
0  591   58
1  142  490
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7535545, 'precision': 0.82329524, 'recall': 0.75355446, 'specificity': 0.75355446, 'f1': 0.7395061, 'auroc': 0.93569326, 'binary_precision': 0.9734513, 'binary_recall': 0.521327, 'binary_specificity': 0.98578197, 'binary_f1_score': 0.6790123}
confusion matrix:
     0    1
0  208    3
1  101  110
early stop counter: 6
val acc:0.8438719511032104, best validation acc: 0.864168643951416, corresponding to test acc:                         0.8815165758132935 / 0.8886256217956543
after epoch: 27,now: 2024-07-26 08:35:09.378833,epoch time: 0:01:26.707542,used: 0:39:04.546050,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_07_56_04_seed_4_23065779
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.99093264, 'precision': 0.99090016, 'recall': 0.9910633, 'specificity': 0.9910633, 'f1': 0.99093145, 'auroc': 0.9998658, 'binary_precision': 0.99806577, 'binary_recall': 0.9841068, 'binary_specificity': 0.9980198, 'binary_f1_score': 0.9910372}
confusion matrix:
      0     1
0  1512     3
1    25  1548
---- Validation: 
scalar performance:
{'acc': 0.7572209, 'precision': 0.8183932, 'recall': 0.75428724, 'specificity': 0.75428724, 'f1': 0.74352705, 'auroc': 0.9203814, 'binary_precision': 0.95467424, 'binary_recall': 0.53322786, 'binary_specificity': 0.9753467, 'binary_f1_score': 0.68426394}
confusion matrix:
     0    1
0  633   16
1  295  337
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.57345974, 'precision': 0.75477135, 'recall': 0.57345974, 'specificity': 0.57345974, 'f1': 0.48114753, 'auroc': 0.93672645, 'binary_precision': 0.969697, 'binary_recall': 0.15165877, 'binary_specificity': 0.99526066, 'binary_f1_score': 0.2622951}
confusion matrix:
     0   1
0  210   1
1  179  32
early stop counter: 7
val acc:0.7572209239006042, best validation acc: 0.864168643951416, corresponding to test acc:                         0.8815165758132935 / 0.8886256217956543
after epoch: 28,now: 2024-07-26 08:36:36.114455,epoch time: 0:01:26.735622,used: 0:40:31.281672,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_07_56_04_seed_4_23065779
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9912565, 'precision': 0.99123764, 'recall': 0.9912716, 'specificity': 0.9912716, 'f1': 0.99125373, 'auroc': 0.99971884, 'binary_precision': 0.9923567, 'binary_recall': 0.9904641, 'binary_specificity': 0.9920792, 'binary_f1_score': 0.99140954}
confusion matrix:
      0     1
0  1503    12
1    15  1558
---- Validation: 
scalar performance:
{'acc': 0.8555816, 'precision': 0.87077165, 'recall': 0.8542402, 'specificity': 0.8542402, 'f1': 0.8537333, 'auroc': 0.94259423, 'binary_precision': 0.94257426, 'binary_recall': 0.7531645, 'binary_specificity': 0.9553159, 'binary_f1_score': 0.83729106}
confusion matrix:
     0    1
0  620   29
1  156  476
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.81279624, 'precision': 0.84787166, 'recall': 0.81279624, 'specificity': 0.81279624, 'f1': 0.80795527, 'auroc': 0.9393152, 'binary_precision': 0.9583333, 'binary_recall': 0.6540284, 'binary_specificity': 0.971564, 'binary_f1_score': 0.7774648}
confusion matrix:
     0    1
0  205    6
1   73  138
early stop counter: 8
val acc:0.8555815815925598, best validation acc: 0.864168643951416, corresponding to test acc:                         0.8815165758132935 / 0.8886256217956543
after epoch: 29,now: 2024-07-26 08:38:03.112224,epoch time: 0:01:26.997769,used: 0:41:58.279441,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_07_56_04_seed_4_23065779
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.9851036, 'precision': 0.9852847, 'recall': 0.98535967, 'specificity': 0.98535967, 'f1': 0.98510355, 'auroc': 0.9997071, 'binary_precision': 1.0, 'binary_recall': 0.9707193, 'binary_specificity': 1.0, 'binary_f1_score': 0.9851421}
confusion matrix:
      0     1
0  1517     0
1    46  1525
---- Validation: 
scalar performance:
{'acc': 0.6034348, 'precision': 0.7690871, 'recall': 0.5981634, 'specificity': 0.5981634, 'f1': 0.52555555, 'auroc': 0.9163934, 'binary_precision': 0.97692305, 'binary_recall': 0.20094937, 'binary_specificity': 0.9953775, 'binary_f1_score': 0.33333334}
confusion matrix:
     0    1
0  646    3
1  505  127
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5165877, 'precision': 0.7542169, 'recall': 0.5165877, 'specificity': 0.5165877, 'f1': 0.36917078, 'auroc': 0.9223063, 'binary_precision': 1.0, 'binary_recall': 0.033175357, 'binary_specificity': 1.0, 'binary_f1_score': 0.06422018}
confusion matrix:
     0  1
0  211  0
1  204  7
early stop counter: 9
val acc:0.6034348011016846, best validation acc: 0.864168643951416, corresponding to test acc:                         0.8815165758132935 / 0.8886256217956543
after epoch: 30,now: 2024-07-26 08:39:29.285630,epoch time: 0:01:26.173406,used: 0:43:24.452847,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_07_56_04_seed_4_23065779
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 0:43:24.452847 at 2024-07-26 08:39:29.285630
persisted model performance metric: 

scalar performance:
{'acc': 0.8815166, 'precision': 0.8988611, 'recall': 0.8815166, 'specificity': 0.8815166, 'f1': 0.88021433, 'auroc': 0.9484513, 'binary_precision': 0.98203593, 'binary_recall': 0.7772512, 'binary_specificity': 0.98578197, 'binary_f1_score': 0.8677249}
confusion matrix:
     0    1
0  208    3
1   47  164
oracle model performance metric: 

scalar performance:
{'acc': 0.8886256, 'precision': 0.8911648, 'recall': 0.8886256, 'specificity': 0.8886256, 'f1': 0.8884446, 'auroc': 0.94937223, 'binary_precision': 0.92268044, 'binary_recall': 0.8483412, 'binary_specificity': 0.92890996, 'binary_f1_score': 0.88395065}
confusion matrix:
     0    1
0  196   15
1   32  179
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_irm_10seeds_nofreeze_2024-07-26_02-28-54/rule_results/0.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_irm_10seeds_nofreeze_2024-07-26_02-28-54/confusion_matrix/0.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 455396 KiB |  13219 MiB | 365434 GiB | 365433 GiB |
|       from large pool | 414803 KiB |  13181 MiB | 361084 GiB | 361083 GiB |
|       from small pool |  40592 KiB |     60 MiB |   4350 GiB |   4350 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 455396 KiB |  13219 MiB | 365434 GiB | 365433 GiB |
|       from large pool | 414803 KiB |  13181 MiB | 361084 GiB | 361083 GiB |
|       from small pool |  40592 KiB |     60 MiB |   4350 GiB |   4350 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 447480 KiB |  13213 MiB | 364721 GiB | 364721 GiB |
|       from large pool | 407075 KiB |  13175 MiB | 360380 GiB | 360380 GiB |
|       from small pool |  40405 KiB |     60 MiB |   4341 GiB |   4341 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  14478 MiB |  14482 MiB |  68842 MiB |  54364 MiB |
|       from large pool |  14412 MiB |  14412 MiB |  68706 MiB |  54294 MiB |
|       from small pool |     66 MiB |     70 MiB |    136 MiB |     70 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 445724 KiB |   1236 MiB | 255885 GiB | 255885 GiB |
|       from large pool | 435116 KiB |   1229 MiB | 251507 GiB | 251507 GiB |
|       from small pool |  10607 KiB |     44 MiB |   4377 GiB |   4377 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    1298    |    2598    |   64612 K  |   64610 K  |
|       from large pool |     187    |    1413    |   32848 K  |   32848 K  |
|       from small pool |    1111    |    1419    |   31763 K  |   31762 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    1298    |    2598    |   64612 K  |   64610 K  |
|       from large pool |     187    |    1413    |   32848 K  |   32848 K  |
|       from small pool |    1111    |    1419    |   31763 K  |   31762 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     635    |     637    |    2928    |    2293    |
|       from large pool |     602    |     602    |    2860    |    2258    |
|       from small pool |      33    |      35    |      68    |      35    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      96    |     653    |   44120 K  |   44120 K  |
|       from large pool |      38    |     605    |   25359 K  |   25359 K  |
|       from small pool |      58    |     236    |   18761 K  |   18761 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13219 MiB | 365434 GiB | 365434 GiB |
|       from large pool |  16640 KiB |  13181 MiB | 361084 GiB | 361084 GiB |
|       from small pool |      0 KiB |     60 MiB |   4350 GiB |   4350 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13219 MiB | 365434 GiB | 365434 GiB |
|       from large pool |  16640 KiB |  13181 MiB | 361084 GiB | 361084 GiB |
|       from small pool |      0 KiB |     60 MiB |   4350 GiB |   4350 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13213 MiB | 364721 GiB | 364721 GiB |
|       from large pool |  16640 KiB |  13175 MiB | 360380 GiB | 360380 GiB |
|       from small pool |      0 KiB |     60 MiB |   4341 GiB |   4341 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    880 MiB |  14482 MiB |  68842 MiB |  67962 MiB |
|       from large pool |    830 MiB |  14412 MiB |  68706 MiB |  67876 MiB |
|       from small pool |     50 MiB |     70 MiB |    136 MiB |     86 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1236 MiB | 255886 GiB | 255886 GiB |
|       from large pool |  24320 KiB |   1229 MiB | 251508 GiB | 251508 GiB |
|       from small pool |      0 KiB |     44 MiB |   4377 GiB |   4377 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    2598    |   64612 K  |   64612 K  |
|       from large pool |       2    |    1413    |   32848 K  |   32848 K  |
|       from small pool |       0    |    1419    |   31763 K  |   31763 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    2598    |   64612 K  |   64612 K  |
|       from large pool |       2    |    1413    |   32848 K  |   32848 K  |
|       from small pool |       0    |    1419    |   31763 K  |   31763 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      62    |     637    |    2928    |    2866    |
|       from large pool |      37    |     602    |    2860    |    2823    |
|       from small pool |      25    |      35    |      68    |      43    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |     653    |   44120 K  |   44120 K  |
|       from large pool |       4    |     605    |   25359 K  |   25359 K  |
|       from small pool |       0    |     236    |   18761 K  |   18761 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13219 MiB | 365434 GiB | 365434 GiB |
|       from large pool |  16640 KiB |  13181 MiB | 361084 GiB | 361084 GiB |
|       from small pool |      0 KiB |     60 MiB |   4350 GiB |   4350 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13219 MiB | 365434 GiB | 365434 GiB |
|       from large pool |  16640 KiB |  13181 MiB | 361084 GiB | 361084 GiB |
|       from small pool |      0 KiB |     60 MiB |   4350 GiB |   4350 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13213 MiB | 364721 GiB | 364721 GiB |
|       from large pool |  16640 KiB |  13175 MiB | 360380 GiB | 360380 GiB |
|       from small pool |      0 KiB |     60 MiB |   4341 GiB |   4341 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    880 MiB |  14482 MiB |  68842 MiB |  67962 MiB |
|       from large pool |    830 MiB |  14412 MiB |  68706 MiB |  67876 MiB |
|       from small pool |     50 MiB |     70 MiB |    136 MiB |     86 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1236 MiB | 255886 GiB | 255886 GiB |
|       from large pool |  24320 KiB |   1229 MiB | 251508 GiB | 251508 GiB |
|       from small pool |      0 KiB |     44 MiB |   4377 GiB |   4377 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    2598    |   64612 K  |   64612 K  |
|       from large pool |       2    |    1413    |   32848 K  |   32848 K  |
|       from small pool |       0    |    1419    |   31763 K  |   31763 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    2598    |   64612 K  |   64612 K  |
|       from large pool |       2    |    1413    |   32848 K  |   32848 K  |
|       from small pool |       0    |    1419    |   31763 K  |   31763 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      62    |     637    |    2928    |    2866    |
|       from large pool |      37    |     602    |    2860    |    2823    |
|       from small pool |      25    |      35    |      68    |      43    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |     653    |   44120 K  |   44120 K  |
|       from large pool |       4    |     605    |   25359 K  |   25359 K  |
|       from small pool |       0    |     236    |   18761 K  |   18761 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'888c1ef2'
model name: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_08_39_57_seed_5_23065779

 Experiment start at: 2024-07-26 08:39:57.862419
before training, model accuracy: 0.5476190447807312
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.95615184, 'precision': 0.95617306, 'recall': 0.9561145, 'specificity': 0.9561145, 'f1': 0.95614004, 'auroc': 0.9910191, 'binary_precision': 0.95501286, 'binary_recall': 0.95870966, 'binary_specificity': 0.9535193, 'binary_f1_score': 0.9568577}
confusion matrix:
      0     1
0  1436    70
1    64  1486
---- Validation: 
scalar performance:
{'acc': 0.7659409, 'precision': 0.80099833, 'recall': 0.77061546, 'specificity': 0.77061546, 'f1': 0.7608849, 'auroc': 0.89326954, 'binary_precision': 0.6910377, 'binary_recall': 0.9376, 'binary_specificity': 0.60363084, 'binary_f1_score': 0.7956551}
confusion matrix:
     0    1
0  399  262
1   39  586
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.77056277, 'precision': 0.78876734, 'recall': 0.77056277, 'specificity': 0.77056277, 'f1': 0.76688874, 'auroc': 0.9106276, 'binary_precision': 0.716263, 'binary_recall': 0.8961039, 'binary_specificity': 0.6450216, 'binary_f1_score': 0.79615384}
confusion matrix:
     0    1
0  149   82
1   24  207
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-26 08:41:29.074654,epoch time: 0:01:31.212235,used: 0:01:31.212235,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_08_39_57_seed_5_23065779
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9466623, 'precision': 0.9512415, 'recall': 0.946, 'specificity': 0.946, 'f1': 0.94646186, 'auroc': 0.99738085, 'binary_precision': 0.90909094, 'binary_recall': 0.9941898, 'binary_specificity': 0.8978102, 'binary_f1_score': 0.9497379}
confusion matrix:
      0     1
0  1353   154
1     9  1540
---- Validation: 
scalar performance:
{'acc': 0.7379471, 'precision': 0.78630126, 'recall': 0.7435583, 'specificity': 0.7435583, 'f1': 0.7292099, 'auroc': 0.91163206, 'binary_precision': 0.66143495, 'binary_recall': 0.944, 'binary_specificity': 0.5431165, 'binary_f1_score': 0.77785105}
confusion matrix:
     0    1
0  359  302
1   35  590
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6948052, 'precision': 0.77189267, 'recall': 0.6948052, 'specificity': 0.6948052, 'f1': 0.67152256, 'auroc': 0.9082289, 'binary_precision': 0.62711865, 'binary_recall': 0.96103895, 'binary_specificity': 0.42857143, 'binary_f1_score': 0.7589743}
confusion matrix:
    0    1
0  99  132
1   9  222
early stop counter: 1
val acc:0.7379471063613892, best validation acc: 0.7659409046173096, corresponding to test acc:                         0.7705627679824829 / 0.7705627679824829
after epoch: 2,now: 2024-07-26 08:42:56.731189,epoch time: 0:01:27.656535,used: 0:02:58.868770,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_08_39_57_seed_5_23065779
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.970877, 'precision': 0.9720031, 'recall': 0.97131705, 'specificity': 0.97131705, 'f1': 0.97087216, 'auroc': 0.9969969, 'binary_precision': 0.9993174, 'binary_recall': 0.943299, 'binary_specificity': 0.9993351, 'binary_f1_score': 0.97050047}
confusion matrix:
      0     1
0  1503     1
1    88  1464
---- Validation: 
scalar performance:
{'acc': 0.83903575, 'precision': 0.8391651, 'recall': 0.8394106, 'specificity': 0.8394106, 'f1': 0.8390193, 'auroc': 0.9014923, 'binary_precision': 0.82253087, 'binary_recall': 0.8528, 'binary_specificity': 0.8260212, 'binary_f1_score': 0.83739203}
confusion matrix:
     0    1
0  546  115
1   92  533
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.83116883, 'precision': 0.8311937, 'recall': 0.83116883, 'specificity': 0.83116883, 'f1': 0.8311657, 'auroc': 0.9102153, 'binary_precision': 0.83406115, 'binary_recall': 0.8268398, 'binary_specificity': 0.83549786, 'binary_f1_score': 0.8304348}
confusion matrix:
     0    1
0  193   38
1   40  191
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-07-26 08:44:24.909600,epoch time: 0:01:28.178411,used: 0:04:27.047181,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_08_39_57_seed_5_23065779
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.97971207, 'precision': 0.97978073, 'recall': 0.97991395, 'specificity': 0.97991395, 'f1': 0.9797114, 'auroc': 0.9980086, 'binary_precision': 0.9914417, 'binary_recall': 0.96848875, 'binary_specificity': 0.9913391, 'binary_f1_score': 0.9798309}
confusion matrix:
      0     1
0  1488    13
1    49  1506
---- Validation: 
scalar performance:
{'acc': 0.7884914, 'precision': 0.7892512, 'recall': 0.7875849, 'specificity': 0.7875849, 'f1': 0.7878629, 'auroc': 0.8775722, 'binary_precision': 0.7986464, 'binary_recall': 0.7552, 'binary_specificity': 0.8199697, 'binary_f1_score': 0.77631587}
confusion matrix:
     0    1
0  542  119
1  153  472
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.83116883, 'precision': 0.8317906, 'recall': 0.83116883, 'specificity': 0.83116883, 'f1': 0.83108974, 'auroc': 0.9026817, 'binary_precision': 0.8174274, 'binary_recall': 0.85281384, 'binary_specificity': 0.8095238, 'binary_f1_score': 0.83474576}
confusion matrix:
     0    1
0  187   44
1   34  197
early stop counter: 1
val acc:0.788491427898407, best validation acc: 0.8390357494354248, corresponding to test acc:                         0.8311688303947449 / 0.8311688303947449
after epoch: 4,now: 2024-07-26 08:45:52.589887,epoch time: 0:01:27.680287,used: 0:05:54.727468,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_08_39_57_seed_5_23065779
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9757853, 'precision': 0.97606695, 'recall': 0.9760262, 'specificity': 0.9760262, 'f1': 0.9757853, 'auroc': 0.997686, 'binary_precision': 0.99200535, 'binary_recall': 0.9600258, 'binary_specificity': 0.99202657, 'binary_f1_score': 0.9757536}
confusion matrix:
      0     1
0  1493    12
1    62  1489
---- Validation: 
scalar performance:
{'acc': 0.781493, 'precision': 0.8283535, 'recall': 0.77611494, 'specificity': 0.77611494, 'f1': 0.7710223, 'auroc': 0.8969277, 'binary_precision': 0.94559586, 'binary_recall': 0.584, 'binary_specificity': 0.96822995, 'binary_f1_score': 0.72205734}
confusion matrix:
     0    1
0  640   21
1  260  365
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.84415585, 'precision': 0.85968626, 'recall': 0.84415585, 'specificity': 0.84415585, 'f1': 0.84245527, 'auroc': 0.90920335, 'binary_precision': 0.93442625, 'binary_recall': 0.74025977, 'binary_specificity': 0.9480519, 'binary_f1_score': 0.826087}
confusion matrix:
     0    1
0  219   12
1   60  171
new oracle model saved
early stop counter: 2
val acc:0.7814930081367493, best validation acc: 0.8390357494354248, corresponding to test acc:                         0.8311688303947449 / 0.8441558480262756
after epoch: 5,now: 2024-07-26 08:47:20.666099,epoch time: 0:01:28.076212,used: 0:07:22.803680,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_08_39_57_seed_5_23065779
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9810209, 'precision': 0.98120797, 'recall': 0.98089457, 'specificity': 0.98089457, 'f1': 0.98100924, 'auroc': 0.99885434, 'binary_precision': 0.9752538, 'binary_recall': 0.9877892, 'binary_specificity': 0.974, 'binary_f1_score': 0.98148155}
confusion matrix:
      0     1
0  1461    39
1    19  1537
---- Validation: 
scalar performance:
{'acc': 0.83825815, 'precision': 0.83811474, 'recall': 0.838262, 'specificity': 0.838262, 'f1': 0.8381701, 'auroc': 0.90254766, 'binary_precision': 0.8304279, 'binary_recall': 0.8384, 'binary_specificity': 0.83812404, 'binary_f1_score': 0.83439493}
confusion matrix:
     0    1
0  554  107
1  101  524
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.85714287, 'precision': 0.86246836, 'recall': 0.85714287, 'specificity': 0.85714287, 'f1': 0.8566162, 'auroc': 0.9127265, 'binary_precision': 0.90640396, 'binary_recall': 0.7965368, 'binary_specificity': 0.9177489, 'binary_f1_score': 0.84792626}
confusion matrix:
     0    1
0  212   19
1   47  184
new oracle model saved
early stop counter: 3
val acc:0.8382581472396851, best validation acc: 0.8390357494354248, corresponding to test acc:                         0.8311688303947449 / 0.8571428656578064
after epoch: 6,now: 2024-07-26 08:48:48.671799,epoch time: 0:01:28.005700,used: 0:08:50.809380,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_08_39_57_seed_5_23065779
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9842932, 'precision': 0.98427904, 'recall': 0.9842998, 'specificity': 0.9842998, 'f1': 0.98428893, 'auroc': 0.9988835, 'binary_precision': 0.98518044, 'binary_recall': 0.98391247, 'binary_specificity': 0.9846871, 'binary_f1_score': 0.98454607}
confusion matrix:
      0     1
0  1479    23
1    25  1529
---- Validation: 
scalar performance:
{'acc': 0.84992224, 'precision': 0.8499013, 'recall': 0.8501749, 'specificity': 0.8501749, 'f1': 0.8498894, 'auroc': 0.90742266, 'binary_precision': 0.8364486, 'binary_recall': 0.8592, 'binary_specificity': 0.84114975, 'binary_f1_score': 0.8476716}
confusion matrix:
     0    1
0  556  105
1   88  537
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.84415585, 'precision': 0.844259, 'recall': 0.84415585, 'specificity': 0.84415585, 'f1': 0.84414417, 'auroc': 0.92732525, 'binary_precision': 0.83829784, 'binary_recall': 0.85281384, 'binary_specificity': 0.83549786, 'binary_f1_score': 0.84549356}
confusion matrix:
     0    1
0  193   38
1   34  197
better model found
persisted
after epoch: 7,now: 2024-07-26 08:50:16.671153,epoch time: 0:01:27.999354,used: 0:10:18.808734,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_08_39_57_seed_5_23065779
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.98003924, 'precision': 0.980023, 'recall': 0.9800495, 'specificity': 0.9800495, 'f1': 0.9800353, 'auroc': 0.9984175, 'binary_precision': 0.98126614, 'binary_recall': 0.97936815, 'binary_specificity': 0.9807309, 'binary_f1_score': 0.9803163}
confusion matrix:
      0     1
0  1476    29
1    32  1519
---- Validation: 
scalar performance:
{'acc': 0.84059095, 'precision': 0.8425306, 'recall': 0.84166414, 'specificity': 0.84166414, 'f1': 0.8405562, 'auroc': 0.8986336, 'binary_precision': 0.8088235, 'binary_recall': 0.88, 'binary_specificity': 0.8033283, 'binary_f1_score': 0.8429119}
confusion matrix:
     0    1
0  531  130
1   75  550
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8073593, 'precision': 0.8145811, 'recall': 0.80735934, 'specificity': 0.80735934, 'f1': 0.80624735, 'auroc': 0.8690617, 'binary_precision': 0.7669173, 'binary_recall': 0.8831169, 'binary_specificity': 0.7316017, 'binary_f1_score': 0.8209256}
confusion matrix:
     0    1
0  169   62
1   27  204
early stop counter: 1
val acc:0.8405909538269043, best validation acc: 0.849922239780426, corresponding to test acc:                         0.8441558480262756 / 0.8571428656578064
after epoch: 8,now: 2024-07-26 08:51:44.902361,epoch time: 0:01:28.231208,used: 0:11:47.039942,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_08_39_57_seed_5_23065779
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9856021, 'precision': 0.9855836, 'recall': 0.98561853, 'specificity': 0.98561853, 'f1': 0.9855994, 'auroc': 0.9988823, 'binary_precision': 0.98707175, 'binary_recall': 0.9845261, 'binary_specificity': 0.98671097, 'binary_f1_score': 0.9857972}
confusion matrix:
      0     1
0  1485    20
1    24  1527
---- Validation: 
scalar performance:
{'acc': 0.84758943, 'precision': 0.8491678, 'recall': 0.8465985, 'specificity': 0.8465985, 'f1': 0.84705526, 'auroc': 0.899747, 'binary_precision': 0.8666667, 'binary_recall': 0.8112, 'binary_specificity': 0.881997, 'binary_f1_score': 0.8380165}
confusion matrix:
     0    1
0  583   78
1  118  507
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.84199136, 'precision': 0.84215164, 'recall': 0.8419913, 'specificity': 0.8419913, 'f1': 0.8419728, 'auroc': 0.9110024, 'binary_precision': 0.8495575, 'binary_recall': 0.83116883, 'binary_specificity': 0.85281384, 'binary_f1_score': 0.8402626}
confusion matrix:
     0    1
0  197   34
1   39  192
early stop counter: 2
val acc:0.8475894331932068, best validation acc: 0.849922239780426, corresponding to test acc:                         0.8441558480262756 / 0.8571428656578064
after epoch: 9,now: 2024-07-26 08:53:12.576272,epoch time: 0:01:27.673911,used: 0:13:14.713853,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_08_39_57_seed_5_23065779
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.98363876, 'precision': 0.98373044, 'recall': 0.9835613, 'specificity': 0.9835613, 'f1': 0.98363066, 'auroc': 0.99910116, 'binary_precision': 0.9802296, 'binary_recall': 0.9877892, 'binary_specificity': 0.97933334, 'binary_f1_score': 0.9839949}
confusion matrix:
      0     1
0  1469    31
1    19  1537
---- Validation: 
scalar performance:
{'acc': 0.8460342, 'precision': 0.84759986, 'recall': 0.84504205, 'specificity': 0.84504205, 'f1': 0.8454946, 'auroc': 0.91161025, 'binary_precision': 0.8649573, 'binary_recall': 0.8096, 'binary_specificity': 0.8804841, 'binary_f1_score': 0.8363637}
confusion matrix:
     0    1
0  582   79
1  119  506
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8484849, 'precision': 0.8511169, 'recall': 0.8484849, 'specificity': 0.8484849, 'f1': 0.84820044, 'auroc': 0.90526795, 'binary_precision': 0.8815166, 'binary_recall': 0.8051948, 'binary_specificity': 0.8917749, 'binary_f1_score': 0.84162897}
confusion matrix:
     0    1
0  206   25
1   45  186
early stop counter: 3
val acc:0.8460342288017273, best validation acc: 0.849922239780426, corresponding to test acc:                         0.8441558480262756 / 0.8571428656578064
after epoch: 10,now: 2024-07-26 08:54:40.920935,epoch time: 0:01:28.344663,used: 0:14:43.058516,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_08_39_57_seed_5_23065779
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.98527485, 'precision': 0.98530066, 'recall': 0.9852455, 'specificity': 0.9852455, 'f1': 0.9852704, 'auroc': 0.99900866, 'binary_precision': 0.98394346, 'binary_recall': 0.9871134, 'binary_specificity': 0.98337764, 'binary_f1_score': 0.98552585}
confusion matrix:
      0     1
0  1479    25
1    20  1532
---- Validation: 
scalar performance:
{'acc': 0.8460342, 'precision': 0.85018194, 'recall': 0.8444756, 'specificity': 0.8444756, 'f1': 0.8450595, 'auroc': 0.9137186, 'binary_precision': 0.881932, 'binary_recall': 0.7888, 'binary_specificity': 0.9001513, 'binary_f1_score': 0.8327703}
confusion matrix:
     0    1
0  595   66
1  132  493
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.82900435, 'precision': 0.8572941, 'recall': 0.82900435, 'specificity': 0.82900435, 'f1': 0.8255513, 'auroc': 0.91208935, 'binary_precision': 0.9578313, 'binary_recall': 0.6883117, 'binary_specificity': 0.969697, 'binary_f1_score': 0.80100757}
confusion matrix:
     0    1
0  224    7
1   72  159
early stop counter: 4
val acc:0.8460342288017273, best validation acc: 0.849922239780426, corresponding to test acc:                         0.8441558480262756 / 0.8571428656578064
after epoch: 11,now: 2024-07-26 08:56:09.055312,epoch time: 0:01:28.134377,used: 0:16:11.192893,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_08_39_57_seed_5_23065779
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9849476, 'precision': 0.9853178, 'recall': 0.9847722, 'specificity': 0.9847722, 'f1': 0.98493683, 'auroc': 0.9993912, 'binary_precision': 0.9753943, 'binary_recall': 0.9954926, 'binary_specificity': 0.9740519, 'binary_f1_score': 0.98534095}
confusion matrix:
      0     1
0  1464    39
1     7  1546
---- Validation: 
scalar performance:
{'acc': 0.8304821, 'precision': 0.83401334, 'recall': 0.8319177, 'specificity': 0.8319177, 'f1': 0.8303492, 'auroc': 0.91209924, 'binary_precision': 0.79196554, 'binary_recall': 0.8832, 'binary_specificity': 0.7806354, 'binary_f1_score': 0.8350983}
confusion matrix:
     0    1
0  516  145
1   73  552
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8203463, 'precision': 0.82209074, 'recall': 0.82034636, 'specificity': 0.82034636, 'f1': 0.82010275, 'auroc': 0.8992523, 'binary_precision': 0.7983871, 'binary_recall': 0.85714287, 'binary_specificity': 0.7835498, 'binary_f1_score': 0.8267224}
confusion matrix:
     0    1
0  181   50
1   33  198
early stop counter: 5
val acc:0.8304821252822876, best validation acc: 0.849922239780426, corresponding to test acc:                         0.8441558480262756 / 0.8571428656578064
after epoch: 12,now: 2024-07-26 08:57:36.909910,epoch time: 0:01:27.854598,used: 0:17:39.047491,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_08_39_57_seed_5_23065779
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.98625654, 'precision': 0.9864149, 'recall': 0.9861523, 'specificity': 0.9861523, 'f1': 0.9862493, 'auroc': 0.99947, 'binary_precision': 0.980916, 'binary_recall': 0.992278, 'binary_specificity': 0.9800266, 'binary_f1_score': 0.9865643}
confusion matrix:
      0     1
0  1472    30
1    12  1542
---- Validation: 
scalar performance:
{'acc': 0.80637634, 'precision': 0.83338135, 'recall': 0.80232495, 'specificity': 0.80232495, 'f1': 0.8008088, 'auroc': 0.8904302, 'binary_precision': 0.92152464, 'binary_recall': 0.6576, 'binary_specificity': 0.9470499, 'binary_f1_score': 0.76750696}
confusion matrix:
     0    1
0  626   35
1  214  411
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8073593, 'precision': 0.8457792, 'recall': 0.80735934, 'specificity': 0.80735934, 'f1': 0.80185527, 'auroc': 0.9219092, 'binary_precision': 0.96103895, 'binary_recall': 0.64069265, 'binary_specificity': 0.97402596, 'binary_f1_score': 0.7688312}
confusion matrix:
     0    1
0  225    6
1   83  148
early stop counter: 6
val acc:0.8063763380050659, best validation acc: 0.849922239780426, corresponding to test acc:                         0.8441558480262756 / 0.8571428656578064
after epoch: 13,now: 2024-07-26 08:59:04.709132,epoch time: 0:01:27.799222,used: 0:19:06.846713,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_08_39_57_seed_5_23065779
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9718586, 'precision': 0.972973, 'recall': 0.972276, 'specificity': 0.972276, 'f1': 0.97185373, 'auroc': 0.99942076, 'binary_precision': 1.0, 'binary_recall': 0.9445519, 'binary_specificity': 1.0, 'binary_f1_score': 0.9714854}
confusion matrix:
      0     1
0  1505     0
1    86  1465
---- Validation: 
scalar performance:
{'acc': 0.62674963, 'precision': 0.7600627, 'recall': 0.6164357, 'specificity': 0.6164357, 'f1': 0.5615224, 'auroc': 0.85794854, 'binary_precision': 0.93939394, 'binary_recall': 0.248, 'binary_specificity': 0.9848714, 'binary_f1_score': 0.39240506}
confusion matrix:
     0    1
0  651   10
1  470  155
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5194805, 'precision': 0.7095344, 'recall': 0.5194805, 'specificity': 0.5194805, 'f1': 0.3785657, 'auroc': 0.8965912, 'binary_precision': 0.90909094, 'binary_recall': 0.043290045, 'binary_specificity': 0.995671, 'binary_f1_score': 0.082644634}
confusion matrix:
     0   1
0  230   1
1  221  10
early stop counter: 7
val acc:0.6267496347427368, best validation acc: 0.849922239780426, corresponding to test acc:                         0.8441558480262756 / 0.8571428656578064
after epoch: 14,now: 2024-07-26 09:00:32.770394,epoch time: 0:01:28.061262,used: 0:20:34.907975,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_08_39_57_seed_5_23065779
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9829843, 'precision': 0.98360103, 'recall': 0.9827441, 'specificity': 0.9827441, 'f1': 0.9829682, 'auroc': 0.9996315, 'binary_precision': 0.96994364, 'binary_recall': 0.99742436, 'binary_specificity': 0.9680639, 'binary_f1_score': 0.9834921}
confusion matrix:
      0     1
0  1455    48
1     4  1549
---- Validation: 
scalar performance:
{'acc': 0.7433904, 'precision': 0.77689266, 'recall': 0.74811256, 'specificity': 0.74811256, 'f1': 0.7376639, 'auroc': 0.89758307, 'binary_precision': 0.6733255, 'binary_recall': 0.9168, 'binary_specificity': 0.5794251, 'binary_f1_score': 0.77642274}
confusion matrix:
     0    1
0  383  278
1   52  573
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7229437, 'precision': 0.7824095, 'recall': 0.7229437, 'specificity': 0.7229437, 'f1': 0.7075487, 'auroc': 0.9170368, 'binary_precision': 0.652819, 'binary_recall': 0.95238096, 'binary_specificity': 0.4935065, 'binary_f1_score': 0.7746479}
confusion matrix:
     0    1
0  114  117
1   11  220
early stop counter: 8
val acc:0.7433903813362122, best validation acc: 0.849922239780426, corresponding to test acc:                         0.8441558480262756 / 0.8571428656578064
after epoch: 15,now: 2024-07-26 09:02:01.057587,epoch time: 0:01:28.287193,used: 0:22:03.195168,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_08_39_57_seed_5_23065779
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.99018323, 'precision': 0.9901415, 'recall': 0.9902759, 'specificity': 0.9902759, 'f1': 0.99018157, 'auroc': 0.99968505, 'binary_precision': 0.99545455, 'binary_recall': 0.9852185, 'binary_specificity': 0.9953333, 'binary_f1_score': 0.9903101}
confusion matrix:
      0     1
0  1493     7
1    23  1533
---- Validation: 
scalar performance:
{'acc': 0.7698289, 'precision': 0.83080566, 'recall': 0.76372284, 'specificity': 0.76372284, 'f1': 0.75582254, 'auroc': 0.9187074, 'binary_precision': 0.9660057, 'binary_recall': 0.5456, 'binary_specificity': 0.9818457, 'binary_f1_score': 0.6973415}
confusion matrix:
     0    1
0  649   12
1  284  341
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.63203466, 'precision': 0.78028405, 'recall': 0.6320346, 'specificity': 0.6320346, 'f1': 0.57596374, 'auroc': 0.92345065, 'binary_precision': 0.984127, 'binary_recall': 0.26839826, 'binary_specificity': 0.995671, 'binary_f1_score': 0.4217687}
confusion matrix:
     0   1
0  230   1
1  169  62
early stop counter: 9
val acc:0.7698289155960083, best validation acc: 0.849922239780426, corresponding to test acc:                         0.8441558480262756 / 0.8571428656578064
after epoch: 16,now: 2024-07-26 09:03:29.277788,epoch time: 0:01:28.220201,used: 0:23:31.415369,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_08_39_57_seed_5_23065779
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.989856, 'precision': 0.9899117, 'recall': 0.98981154, 'specificity': 0.98981154, 'f1': 0.98985296, 'auroc': 0.9996363, 'binary_precision': 0.9871713, 'binary_recall': 0.99290323, 'binary_specificity': 0.9867198, 'binary_f1_score': 0.9900289}
confusion matrix:
      0     1
0  1486    20
1    11  1539
---- Validation: 
scalar performance:
{'acc': 0.83670294, 'precision': 0.8511814, 'recall': 0.83382994, 'specificity': 0.83382994, 'f1': 0.8340698, 'auroc': 0.91991043, 'binary_precision': 0.9158317, 'binary_recall': 0.7312, 'binary_specificity': 0.9364599, 'binary_f1_score': 0.8131672}
confusion matrix:
     0    1
0  619   42
1  168  457
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.84199136, 'precision': 0.85202545, 'recall': 0.8419913, 'specificity': 0.8419913, 'f1': 0.84085727, 'auroc': 0.8966661, 'binary_precision': 0.9114583, 'binary_recall': 0.75757575, 'binary_specificity': 0.9264069, 'binary_f1_score': 0.82742316}
confusion matrix:
     0    1
0  214   17
1   56  175
early stop counter: 10
val acc:0.8367029428482056, best validation acc: 0.849922239780426, corresponding to test acc:                         0.8441558480262756 / 0.8571428656578064
after epoch: 17,now: 2024-07-26 09:04:57.847834,epoch time: 0:01:28.570046,used: 0:24:59.985415,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_08_39_57_seed_5_23065779
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9928011, 'precision': 0.9927783, 'recall': 0.99282897, 'specificity': 0.99282897, 'f1': 0.9927998, 'auroc': 0.9993707, 'binary_precision': 0.994822, 'binary_recall': 0.9909736, 'binary_specificity': 0.9946844, 'binary_f1_score': 0.99289405}
confusion matrix:
      0     1
0  1497     8
1    14  1537
---- Validation: 
scalar performance:
{'acc': 0.7978227, 'precision': 0.8417182, 'recall': 0.7927407, 'specificity': 0.7927407, 'f1': 0.7890675, 'auroc': 0.9227812, 'binary_precision': 0.95739347, 'binary_recall': 0.6112, 'binary_specificity': 0.9742814, 'binary_f1_score': 0.74609375}
confusion matrix:
     0    1
0  644   17
1  243  382
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6103896, 'precision': 0.73433584, 'recall': 0.6103896, 'specificity': 0.6103896, 'f1': 0.5510204, 'auroc': 0.88975096, 'binary_precision': 0.9047619, 'binary_recall': 0.24675325, 'binary_specificity': 0.97402596, 'binary_f1_score': 0.3877551}
confusion matrix:
     0   1
0  225   6
1  174  57
early stop counter: 11
val acc:0.7978227138519287, best validation acc: 0.849922239780426, corresponding to test acc:                         0.8441558480262756 / 0.8571428656578064
after epoch: 18,now: 2024-07-26 09:06:25.741314,epoch time: 0:01:27.893480,used: 0:26:27.878895,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_08_39_57_seed_5_23065779
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.99051046, 'precision': 0.99066293, 'recall': 0.9904092, 'specificity': 0.9904092, 'f1': 0.9905054, 'auroc': 0.9997057, 'binary_precision': 0.98536897, 'binary_recall': 0.9961415, 'binary_specificity': 0.9846769, 'binary_f1_score': 0.990726}
confusion matrix:
      0     1
0  1478    23
1     6  1549
---- Validation: 
scalar performance:
{'acc': 0.86780715, 'precision': 0.8680221, 'recall': 0.8673985, 'specificity': 0.8673985, 'f1': 0.86760706, 'auroc': 0.9243232, 'binary_precision': 0.87234044, 'binary_recall': 0.8528, 'binary_specificity': 0.881997, 'binary_f1_score': 0.8624596}
confusion matrix:
     0    1
0  583   78
1   92  533
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8701299, 'precision': 0.8804245, 'recall': 0.8701299, 'specificity': 0.8701299, 'f1': 0.8692453, 'auroc': 0.9269316, 'binary_precision': 0.9430052, 'binary_recall': 0.7878788, 'binary_specificity': 0.95238096, 'binary_f1_score': 0.8584905}
confusion matrix:
     0    1
0  220   11
1   49  182
new oracle model saved
better model found
persisted
after epoch: 19,now: 2024-07-26 09:07:54.318426,epoch time: 0:01:28.577112,used: 0:27:56.456007,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_08_39_57_seed_5_23065779
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9918194, 'precision': 0.99192524, 'recall': 0.99174166, 'specificity': 0.99174166, 'f1': 0.99181545, 'auroc': 0.99983937, 'binary_precision': 0.9878827, 'binary_recall': 0.9961415, 'binary_specificity': 0.98734176, 'binary_f1_score': 0.99199486}
confusion matrix:
      0     1
0  1482    19
1     6  1549
---- Validation: 
scalar performance:
{'acc': 0.86780715, 'precision': 0.87089026, 'recall': 0.8665271, 'specificity': 0.8665271, 'f1': 0.86715657, 'auroc': 0.9228829, 'binary_precision': 0.8984238, 'binary_recall': 0.8208, 'binary_specificity': 0.91225415, 'binary_f1_score': 0.8578596}
confusion matrix:
     0    1
0  603   58
1  112  513
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.84415585, 'precision': 0.8625264, 'recall': 0.84415585, 'specificity': 0.84415585, 'f1': 0.84215623, 'auroc': 0.9138509, 'binary_precision': 0.94413406, 'binary_recall': 0.7316017, 'binary_specificity': 0.95671, 'binary_f1_score': 0.82439023}
confusion matrix:
     0    1
0  221   10
1   62  169
early stop counter: 1
val acc:0.867807149887085, best validation acc: 0.867807149887085, corresponding to test acc:                         0.8701298832893372 / 0.8701298832893372
after epoch: 20,now: 2024-07-26 09:09:21.905709,epoch time: 0:01:27.587283,used: 0:29:24.043290,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_08_39_57_seed_5_23065779
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9931283, 'precision': 0.9930914, 'recall': 0.99323994, 'specificity': 0.99323994, 'f1': 0.9931272, 'auroc': 0.9998475, 'binary_precision': 0.99934936, 'binary_recall': 0.98714656, 'binary_specificity': 0.9993333, 'binary_f1_score': 0.99321043}
confusion matrix:
      0     1
0  1499     1
1    20  1536
---- Validation: 
scalar performance:
{'acc': 0.62752724, 'precision': 0.7833862, 'recall': 0.61688715, 'specificity': 0.61688715, 'f1': 0.5576901, 'auroc': 0.9043703, 'binary_precision': 0.9866667, 'binary_recall': 0.2368, 'binary_specificity': 0.9969743, 'binary_f1_score': 0.3819355}
confusion matrix:
     0    1
0  659    2
1  477  148
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.52380955, 'precision': 0.68948543, 'recall': 0.52380955, 'specificity': 0.52380955, 'f1': 0.39060363, 'auroc': 0.905638, 'binary_precision': 0.8666667, 'binary_recall': 0.056277055, 'binary_specificity': 0.991342, 'binary_f1_score': 0.10569106}
confusion matrix:
     0   1
0  229   2
1  218  13
early stop counter: 2
val acc:0.6275272369384766, best validation acc: 0.867807149887085, corresponding to test acc:                         0.8701298832893372 / 0.8701298832893372
after epoch: 21,now: 2024-07-26 09:10:50.512817,epoch time: 0:01:28.607108,used: 0:30:52.650398,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_08_39_57_seed_5_23065779
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.99247384, 'precision': 0.9924575, 'recall': 0.99256575, 'specificity': 0.99256575, 'f1': 0.99247324, 'auroc': 0.99984026, 'binary_precision': 0.99869454, 'binary_recall': 0.9864603, 'binary_specificity': 0.9986711, 'binary_f1_score': 0.99253976}
confusion matrix:
      0     1
0  1503     2
1    21  1530
---- Validation: 
scalar performance:
{'acc': 0.7838258, 'precision': 0.8405653, 'recall': 0.7780357, 'specificity': 0.7780357, 'f1': 0.77190435, 'auroc': 0.9338088, 'binary_precision': 0.97275203, 'binary_recall': 0.5712, 'binary_specificity': 0.9848714, 'binary_f1_score': 0.7197581}
confusion matrix:
     0    1
0  651   10
1  268  357
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.66450214, 'precision': 0.77645504, 'recall': 0.66450214, 'specificity': 0.66450214, 'f1': 0.6267104, 'auroc': 0.9107213, 'binary_precision': 0.95238096, 'binary_recall': 0.34632036, 'binary_specificity': 0.98268396, 'binary_f1_score': 0.50793654}
confusion matrix:
     0   1
0  227   4
1  151  80
early stop counter: 3
val acc:0.7838258147239685, best validation acc: 0.867807149887085, corresponding to test acc:                         0.8701298832893372 / 0.8701298832893372
after epoch: 22,now: 2024-07-26 09:12:18.136633,epoch time: 0:01:27.623816,used: 0:32:20.274214,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_08_39_57_seed_5_23065779
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.99345547, 'precision': 0.99348927, 'recall': 0.99342585, 'specificity': 0.99342585, 'f1': 0.99345374, 'auroc': 0.9998149, 'binary_precision': 0.9916452, 'binary_recall': 0.9954839, 'binary_specificity': 0.9913679, 'binary_f1_score': 0.99356085}
confusion matrix:
      0     1
0  1493    13
1     7  1543
---- Validation: 
scalar performance:
{'acc': 0.85614306, 'precision': 0.86859053, 'recall': 0.85356855, 'specificity': 0.85356855, 'f1': 0.85418564, 'auroc': 0.92759156, 'binary_precision': 0.9296875, 'binary_recall': 0.7616, 'binary_specificity': 0.9455371, 'binary_f1_score': 0.8372911}
confusion matrix:
     0    1
0  625   36
1  149  476
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7012987, 'precision': 0.75247383, 'recall': 0.7012987, 'specificity': 0.7012987, 'f1': 0.6853545, 'auroc': 0.86306477, 'binary_precision': 0.86614174, 'binary_recall': 0.47619048, 'binary_specificity': 0.9264069, 'binary_f1_score': 0.61452514}
confusion matrix:
     0    1
0  214   17
1  121  110
early stop counter: 4
val acc:0.856143057346344, best validation acc: 0.867807149887085, corresponding to test acc:                         0.8701298832893372 / 0.8701298832893372
after epoch: 23,now: 2024-07-26 09:13:46.228386,epoch time: 0:01:28.091753,used: 0:33:48.365967,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_08_39_57_seed_5_23065779
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9957461, 'precision': 0.99572504, 'recall': 0.9957707, 'specificity': 0.9957707, 'f1': 0.9957453, 'auroc': 0.9998834, 'binary_precision': 0.99741435, 'binary_recall': 0.994201, 'binary_specificity': 0.99734044, 'binary_f1_score': 0.99580514}
confusion matrix:
      0     1
0  1500     4
1     9  1543
---- Validation: 
scalar performance:
{'acc': 0.7527216, 'precision': 0.8279567, 'recall': 0.745905, 'specificity': 0.745905, 'f1': 0.7341379, 'auroc': 0.9257059, 'binary_precision': 0.97819316, 'binary_recall': 0.5024, 'binary_specificity': 0.98941, 'binary_f1_score': 0.66384774}
confusion matrix:
     0    1
0  654    7
1  311  314
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5281385, 'precision': 0.7239374, 'recall': 0.5281385, 'specificity': 0.5281385, 'f1': 0.3961436, 'auroc': 0.8899759, 'binary_precision': 0.93333334, 'binary_recall': 0.060606062, 'binary_specificity': 0.995671, 'binary_f1_score': 0.11382114}
confusion matrix:
     0   1
0  230   1
1  217  14
early stop counter: 5
val acc:0.7527216076850891, best validation acc: 0.867807149887085, corresponding to test acc:                         0.8701298832893372 / 0.8701298832893372
after epoch: 24,now: 2024-07-26 09:15:13.932710,epoch time: 0:01:27.704324,used: 0:35:16.070291,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_08_39_57_seed_5_23065779
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.9921466, 'precision': 0.99213713, 'recall': 0.9922578, 'specificity': 0.9922578, 'f1': 0.992146, 'auroc': 0.99988174, 'binary_precision': 0.9993464, 'binary_recall': 0.98518044, 'binary_specificity': 0.9993351, 'binary_f1_score': 0.99221283}
confusion matrix:
      0     1
0  1503     1
1    23  1529
---- Validation: 
scalar performance:
{'acc': 0.5933126, 'precision': 0.76980335, 'recall': 0.58168715, 'specificity': 0.58168715, 'f1': 0.5002285, 'auroc': 0.9203177, 'binary_precision': 0.9811321, 'binary_recall': 0.1664, 'binary_specificity': 0.9969743, 'binary_f1_score': 0.28454173}
confusion matrix:
     0    1
0  659    2
1  521  104
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.504329, 'precision': 0.58442986, 'recall': 0.504329, 'specificity': 0.504329, 'f1': 0.35021096, 'auroc': 0.8755271, 'binary_precision': 0.6666667, 'binary_recall': 0.017316017, 'binary_specificity': 0.991342, 'binary_f1_score': 0.033755273}
confusion matrix:
     0  1
0  229  2
1  227  4
early stop counter: 6
val acc:0.5933126211166382, best validation acc: 0.867807149887085, corresponding to test acc:                         0.8701298832893372 / 0.8701298832893372
after epoch: 25,now: 2024-07-26 09:16:42.689485,epoch time: 0:01:28.756775,used: 0:36:44.827066,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_08_39_57_seed_5_23065779
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.98658377, 'precision': 0.9867228, 'recall': 0.9867997, 'specificity': 0.9867997, 'f1': 0.9865837, 'auroc': 0.99985003, 'binary_precision': 1.0, 'binary_recall': 0.9735995, 'binary_specificity': 1.0, 'binary_f1_score': 0.9866232}
confusion matrix:
      0     1
0  1503     0
1    41  1512
---- Validation: 
scalar performance:
{'acc': 0.6415241, 'precision': 0.78597933, 'recall': 0.6313307, 'specificity': 0.6313307, 'f1': 0.58034986, 'auroc': 0.9228587, 'binary_precision': 0.9823529, 'binary_recall': 0.2672, 'binary_specificity': 0.9954614, 'binary_f1_score': 0.42012578}
confusion matrix:
     0    1
0  658    3
1  458  167
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5151515, 'precision': 0.63851297, 'recall': 0.5151515, 'specificity': 0.5151515, 'f1': 0.37627774, 'auroc': 0.8779446, 'binary_precision': 0.7692308, 'binary_recall': 0.043290045, 'binary_specificity': 0.987013, 'binary_f1_score': 0.08196722}
confusion matrix:
     0   1
0  228   3
1  221  10
early stop counter: 7
val acc:0.641524076461792, best validation acc: 0.867807149887085, corresponding to test acc:                         0.8701298832893372 / 0.8701298832893372
after epoch: 26,now: 2024-07-26 09:18:11.089395,epoch time: 0:01:28.399910,used: 0:38:13.226976,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_08_39_57_seed_5_23065779
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.9918194, 'precision': 0.99179006, 'recall': 0.9919082, 'specificity': 0.9919082, 'f1': 0.9918184, 'auroc': 0.9994842, 'binary_precision': 0.9973958, 'binary_recall': 0.9864778, 'binary_specificity': 0.99733865, 'binary_f1_score': 0.99190676}
confusion matrix:
      0     1
0  1499     4
1    21  1532
---- Validation: 
scalar performance:
{'acc': 0.8437014, 'precision': 0.8448909, 'recall': 0.84281635, 'specificity': 0.84281635, 'f1': 0.8432236, 'auroc': 0.9050312, 'binary_precision': 0.859322, 'binary_recall': 0.8112, 'binary_specificity': 0.8744327, 'binary_f1_score': 0.83456796}
confusion matrix:
     0    1
0  578   83
1  118  507
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.84632033, 'precision': 0.8474207, 'recall': 0.84632033, 'specificity': 0.84632033, 'f1': 0.84619856, 'auroc': 0.90734804, 'binary_precision': 0.8669725, 'binary_recall': 0.8181818, 'binary_specificity': 0.87445885, 'binary_f1_score': 0.8418708}
confusion matrix:
     0    1
0  202   29
1   42  189
early stop counter: 8
val acc:0.8437014222145081, best validation acc: 0.867807149887085, corresponding to test acc:                         0.8701298832893372 / 0.8701298832893372
after epoch: 27,now: 2024-07-26 09:19:39.250253,epoch time: 0:01:28.160858,used: 0:39:41.387834,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_08_39_57_seed_5_23065779
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.989856, 'precision': 0.9899373, 'recall': 0.98979187, 'specificity': 0.98979187, 'f1': 0.9898518, 'auroc': 0.999614, 'binary_precision': 0.98658144, 'binary_recall': 0.993565, 'binary_specificity': 0.98601866, 'binary_f1_score': 0.990061}
confusion matrix:
      0     1
0  1481    21
1    10  1544
---- Validation: 
scalar performance:
{'acc': 0.87713844, 'precision': 0.8805681, 'recall': 0.87582207, 'specificity': 0.87582207, 'f1': 0.8765064, 'auroc': 0.93230134, 'binary_precision': 0.9103691, 'binary_recall': 0.8288, 'binary_specificity': 0.9228442, 'binary_f1_score': 0.8676717}
confusion matrix:
     0    1
0  610   51
1  107  518
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7878788, 'precision': 0.82711184, 'recall': 0.78787875, 'specificity': 0.78787875, 'f1': 0.7813219, 'auroc': 0.90159476, 'binary_precision': 0.9403973, 'binary_recall': 0.6147186, 'binary_specificity': 0.96103895, 'binary_f1_score': 0.7434555}
confusion matrix:
     0    1
0  222    9
1   89  142
better model found
persisted
after epoch: 28,now: 2024-07-26 09:21:08.196060,epoch time: 0:01:28.945807,used: 0:41:10.333641,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_08_39_57_seed_5_23065779
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9941099, 'precision': 0.9940766, 'recall': 0.9941833, 'specificity': 0.9941833, 'f1': 0.99410903, 'auroc': 0.9997477, 'binary_precision': 0.99870044, 'binary_recall': 0.98969734, 'binary_specificity': 0.9986693, 'binary_f1_score': 0.9941785}
confusion matrix:
      0     1
0  1501     2
1    16  1537
---- Validation: 
scalar performance:
{'acc': 0.7029549, 'precision': 0.7959776, 'recall': 0.6949228, 'specificity': 0.6949228, 'f1': 0.672184, 'auroc': 0.916144, 'binary_precision': 0.9550562, 'binary_recall': 0.408, 'binary_specificity': 0.9818457, 'binary_f1_score': 0.57174885}
confusion matrix:
     0    1
0  649   12
1  370  255
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.51082253, 'precision': 0.5989378, 'recall': 0.5108225, 'specificity': 0.5108225, 'f1': 0.37070876, 'auroc': 0.86806846, 'binary_precision': 0.6923077, 'binary_recall': 0.038961038, 'binary_specificity': 0.98268396, 'binary_f1_score': 0.07377049}
confusion matrix:
     0  1
0  227  4
1  222  9
early stop counter: 1
val acc:0.702954888343811, best validation acc: 0.8771384358406067, corresponding to test acc:                         0.7878788113594055 / 0.8701298832893372
after epoch: 29,now: 2024-07-26 09:22:36.255213,epoch time: 0:01:28.059153,used: 0:42:38.392794,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_08_39_57_seed_5_23065779
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.98756546, 'precision': 0.9878577, 'recall': 0.9874247, 'specificity': 0.9874247, 'f1': 0.9875581, 'auroc': 0.9997742, 'binary_precision': 0.9791007, 'binary_recall': 0.9967763, 'binary_specificity': 0.97807306, 'binary_f1_score': 0.98785937}
confusion matrix:
      0     1
0  1472    33
1     5  1546
---- Validation: 
scalar performance:
{'acc': 0.85303265, 'precision': 0.8613859, 'recall': 0.85089135, 'specificity': 0.85089135, 'f1': 0.8515388, 'auroc': 0.91971135, 'binary_precision': 0.9097744, 'binary_recall': 0.7744, 'binary_specificity': 0.92738277, 'binary_f1_score': 0.83664644}
confusion matrix:
     0    1
0  613   48
1  141  484
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7965368, 'precision': 0.8087813, 'recall': 0.7965368, 'specificity': 0.7965368, 'f1': 0.7944995, 'auroc': 0.8751148, 'binary_precision': 0.87027025, 'binary_recall': 0.6969697, 'binary_specificity': 0.8961039, 'binary_f1_score': 0.77403843}
confusion matrix:
     0    1
0  207   24
1   70  161
early stop counter: 2
val acc:0.853032648563385, best validation acc: 0.8771384358406067, corresponding to test acc:                         0.7878788113594055 / 0.8701298832893372
after epoch: 30,now: 2024-07-26 09:24:04.826225,epoch time: 0:01:28.571012,used: 0:44:06.963806,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_08_39_57_seed_5_23065779
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 0:44:06.963806 at 2024-07-26 09:24:04.826225
persisted model performance metric: 

scalar performance:
{'acc': 0.7878788, 'precision': 0.82711184, 'recall': 0.78787875, 'specificity': 0.78787875, 'f1': 0.7813219, 'auroc': 0.90159476, 'binary_precision': 0.9403973, 'binary_recall': 0.6147186, 'binary_specificity': 0.96103895, 'binary_f1_score': 0.7434555}
confusion matrix:
     0    1
0  222    9
1   89  142
oracle model performance metric: 

scalar performance:
{'acc': 0.8701299, 'precision': 0.8804245, 'recall': 0.8701299, 'specificity': 0.8701299, 'f1': 0.8692453, 'auroc': 0.9269316, 'binary_precision': 0.9430052, 'binary_recall': 0.7878788, 'binary_specificity': 0.95238096, 'binary_f1_score': 0.8584905}
confusion matrix:
     0    1
0  220   11
1   49  182
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_irm_10seeds_nofreeze_2024-07-26_02-28-54/rule_results/0.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_irm_10seeds_nofreeze_2024-07-26_02-28-54/confusion_matrix/0.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 455402 KiB |  13219 MiB | 438504 GiB | 438504 GiB |
|       from large pool | 414803 KiB |  13181 MiB | 433285 GiB | 433285 GiB |
|       from small pool |  40598 KiB |     60 MiB |   5218 GiB |   5218 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 455402 KiB |  13219 MiB | 438504 GiB | 438504 GiB |
|       from large pool | 414803 KiB |  13181 MiB | 433285 GiB | 433285 GiB |
|       from small pool |  40598 KiB |     60 MiB |   5218 GiB |   5218 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 447482 KiB |  13213 MiB | 437735 GiB | 437735 GiB |
|       from large pool | 407075 KiB |  13175 MiB | 432528 GiB | 432527 GiB |
|       from small pool |  40407 KiB |     60 MiB |   5207 GiB |   5207 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  14478 MiB |  14482 MiB |  82440 MiB |  67962 MiB |
|       from large pool |  14412 MiB |  14412 MiB |  82288 MiB |  67876 MiB |
|       from small pool |     66 MiB |     70 MiB |    152 MiB |     86 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 445718 KiB |   1236 MiB | 306964 GiB | 306964 GiB |
|       from large pool | 435116 KiB |   1229 MiB | 301713 GiB | 301712 GiB |
|       from small pool |  10601 KiB |     44 MiB |   5251 GiB |   5251 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    1310    |    2598    |   77544 K  |   77543 K  |
|       from large pool |     187    |    1413    |   39426 K  |   39426 K  |
|       from small pool |    1123    |    1419    |   38118 K  |   38117 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    1310    |    2598    |   77544 K  |   77543 K  |
|       from large pool |     187    |    1413    |   39426 K  |   39426 K  |
|       from small pool |    1123    |    1419    |   38118 K  |   38117 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     635    |     637    |    3501    |    2866    |
|       from large pool |     602    |     602    |    3425    |    2823    |
|       from small pool |      33    |      35    |      76    |      43    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      94    |     653    |   52721 K  |   52721 K  |
|       from large pool |      38    |     605    |   30360 K  |   30360 K  |
|       from small pool |      56    |     236    |   22361 K  |   22361 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13219 MiB | 438504 GiB | 438504 GiB |
|       from large pool |  16640 KiB |  13181 MiB | 433285 GiB | 433285 GiB |
|       from small pool |      0 KiB |     60 MiB |   5218 GiB |   5218 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13219 MiB | 438504 GiB | 438504 GiB |
|       from large pool |  16640 KiB |  13181 MiB | 433285 GiB | 433285 GiB |
|       from small pool |      0 KiB |     60 MiB |   5218 GiB |   5218 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13213 MiB | 437735 GiB | 437735 GiB |
|       from large pool |  16640 KiB |  13175 MiB | 432528 GiB | 432528 GiB |
|       from small pool |      0 KiB |     60 MiB |   5207 GiB |   5207 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    880 MiB |  14482 MiB |  82440 MiB |  81560 MiB |
|       from large pool |    830 MiB |  14412 MiB |  82288 MiB |  81458 MiB |
|       from small pool |     50 MiB |     70 MiB |    152 MiB |    102 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1236 MiB | 306965 GiB | 306965 GiB |
|       from large pool |  24320 KiB |   1229 MiB | 301713 GiB | 301713 GiB |
|       from small pool |      0 KiB |     44 MiB |   5251 GiB |   5251 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    2598    |   77544 K  |   77544 K  |
|       from large pool |       2    |    1413    |   39426 K  |   39426 K  |
|       from small pool |       0    |    1419    |   38118 K  |   38118 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    2598    |   77544 K  |   77544 K  |
|       from large pool |       2    |    1413    |   39426 K  |   39426 K  |
|       from small pool |       0    |    1419    |   38118 K  |   38118 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      62    |     637    |    3501    |    3439    |
|       from large pool |      37    |     602    |    3425    |    3388    |
|       from small pool |      25    |      35    |      76    |      51    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |     653    |   52722 K  |   52722 K  |
|       from large pool |       4    |     605    |   30360 K  |   30360 K  |
|       from small pool |       0    |     236    |   22361 K  |   22361 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13219 MiB | 438504 GiB | 438504 GiB |
|       from large pool |  16640 KiB |  13181 MiB | 433285 GiB | 433285 GiB |
|       from small pool |      0 KiB |     60 MiB |   5218 GiB |   5218 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13219 MiB | 438504 GiB | 438504 GiB |
|       from large pool |  16640 KiB |  13181 MiB | 433285 GiB | 433285 GiB |
|       from small pool |      0 KiB |     60 MiB |   5218 GiB |   5218 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13213 MiB | 437735 GiB | 437735 GiB |
|       from large pool |  16640 KiB |  13175 MiB | 432528 GiB | 432528 GiB |
|       from small pool |      0 KiB |     60 MiB |   5207 GiB |   5207 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    880 MiB |  14482 MiB |  82440 MiB |  81560 MiB |
|       from large pool |    830 MiB |  14412 MiB |  82288 MiB |  81458 MiB |
|       from small pool |     50 MiB |     70 MiB |    152 MiB |    102 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1236 MiB | 306965 GiB | 306965 GiB |
|       from large pool |  24320 KiB |   1229 MiB | 301713 GiB | 301713 GiB |
|       from small pool |      0 KiB |     44 MiB |   5251 GiB |   5251 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    2598    |   77544 K  |   77544 K  |
|       from large pool |       2    |    1413    |   39426 K  |   39426 K  |
|       from small pool |       0    |    1419    |   38118 K  |   38118 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    2598    |   77544 K  |   77544 K  |
|       from large pool |       2    |    1413    |   39426 K  |   39426 K  |
|       from small pool |       0    |    1419    |   38118 K  |   38118 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      62    |     637    |    3501    |    3439    |
|       from large pool |      37    |     602    |    3425    |    3388    |
|       from small pool |      25    |      35    |      76    |      51    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |     653    |   52722 K  |   52722 K  |
|       from large pool |       4    |     605    |   30360 K  |   30360 K  |
|       from small pool |       0    |     236    |   22361 K  |   22361 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'888c1ef2'
model name: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_09_24_32_seed_6_23065779

 Experiment start at: 2024-07-26 09:24:32.492566
before training, model accuracy: 0.5247747898101807
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.94889325, 'precision': 0.9489107, 'recall': 0.9489626, 'specificity': 0.9489626, 'f1': 0.94889235, 'auroc': 0.987602, 'binary_precision': 0.95561355, 'binary_recall': 0.94269156, 'binary_specificity': 0.9552337, 'binary_f1_score': 0.9491086}
confusion matrix:
      0     1
0  1451    68
1    89  1464
---- Validation: 
scalar performance:
{'acc': 0.78988326, 'precision': 0.8137046, 'recall': 0.7908432, 'specificity': 0.7908432, 'f1': 0.7861849, 'auroc': 0.90688396, 'binary_precision': 0.7254902, 'binary_recall': 0.92789966, 'binary_specificity': 0.6537867, 'binary_f1_score': 0.81430537}
confusion matrix:
     0    1
0  423  224
1   46  592
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7815315, 'precision': 0.81360894, 'recall': 0.7815315, 'specificity': 0.7815315, 'f1': 0.77579844, 'auroc': 0.9162811, 'binary_precision': 0.7133106, 'binary_recall': 0.9414414, 'binary_specificity': 0.6216216, 'binary_f1_score': 0.8116505}
confusion matrix:
     0    1
0  138   84
1   13  209
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-26 09:26:03.654523,epoch time: 0:01:31.161957,used: 0:01:31.161957,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_09_24_32_seed_6_23065779
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.97005206, 'precision': 0.97020805, 'recall': 0.9701929, 'specificity': 0.9701929, 'f1': 0.970052, 'auroc': 0.99594104, 'binary_precision': 0.98218995, 'binary_recall': 0.95817244, 'binary_specificity': 0.98221344, 'binary_f1_score': 0.9700325}
confusion matrix:
      0     1
0  1491    27
1    65  1489
---- Validation: 
scalar performance:
{'acc': 0.85214007, 'precision': 0.8535489, 'recall': 0.85236174, 'specificity': 0.85236174, 'f1': 0.85204256, 'auroc': 0.91815853, 'binary_precision': 0.82941175, 'binary_recall': 0.8840125, 'binary_specificity': 0.82071096, 'binary_f1_score': 0.85584223}
confusion matrix:
     0    1
0  531  116
1   74  564
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8445946, 'precision': 0.8514476, 'recall': 0.8445946, 'specificity': 0.8445946, 'f1': 0.8438333, 'auroc': 0.9402443, 'binary_precision': 0.80237156, 'binary_recall': 0.9144144, 'binary_specificity': 0.7747748, 'binary_f1_score': 0.85473686}
confusion matrix:
     0    1
0  172   50
1   19  203
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-07-26 09:27:32.228373,epoch time: 0:01:28.573850,used: 0:02:59.735807,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_09_24_32_seed_6_23065779
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9684245, 'precision': 0.9691628, 'recall': 0.96865505, 'specificity': 0.96865505, 'f1': 0.9684199, 'auroc': 0.99726546, 'binary_precision': 0.9905597, 'binary_recall': 0.9465206, 'binary_specificity': 0.9907895, 'binary_f1_score': 0.9680395}
confusion matrix:
      0     1
0  1506    14
1    83  1469
---- Validation: 
scalar performance:
{'acc': 0.8319066, 'precision': 0.84332615, 'recall': 0.83126605, 'specificity': 0.83126605, 'f1': 0.8303008, 'auroc': 0.9128846, 'binary_precision': 0.90421456, 'binary_recall': 0.7398119, 'binary_specificity': 0.92272025, 'binary_f1_score': 0.81379306}
confusion matrix:
     0    1
0  597   50
1  166  472
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8423423, 'precision': 0.8496063, 'recall': 0.8423424, 'specificity': 0.8423424, 'f1': 0.8415191, 'auroc': 0.9218408, 'binary_precision': 0.9, 'binary_recall': 0.7702703, 'binary_specificity': 0.9144144, 'binary_f1_score': 0.83009714}
confusion matrix:
     0    1
0  203   19
1   51  171
early stop counter: 1
val acc:0.8319066166877747, best validation acc: 0.8521400690078735, corresponding to test acc:                         0.8445945978164673 / 0.8445945978164673
after epoch: 3,now: 2024-07-26 09:29:00.664066,epoch time: 0:01:28.435693,used: 0:04:28.171500,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_09_24_32_seed_6_23065779
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9736328, 'precision': 0.9739876, 'recall': 0.9738133, 'specificity': 0.9738133, 'f1': 0.97363204, 'auroc': 0.9977257, 'binary_precision': 0.9900133, 'binary_recall': 0.9575016, 'binary_specificity': 0.99012506, 'binary_f1_score': 0.9734861}
confusion matrix:
      0     1
0  1504    15
1    66  1487
---- Validation: 
scalar performance:
{'acc': 0.82723737, 'precision': 0.8384867, 'recall': 0.8265966, 'specificity': 0.8265966, 'f1': 0.825587, 'auroc': 0.8927022, 'binary_precision': 0.8984674, 'binary_recall': 0.73510975, 'binary_specificity': 0.9180835, 'binary_f1_score': 0.80862075}
confusion matrix:
     0    1
0  594   53
1  169  469
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8536036, 'precision': 0.8541857, 'recall': 0.8536036, 'specificity': 0.8536036, 'f1': 0.8535434, 'auroc': 0.9328991, 'binary_precision': 0.8685446, 'binary_recall': 0.8333333, 'binary_specificity': 0.8738739, 'binary_f1_score': 0.85057473}
confusion matrix:
     0    1
0  194   28
1   37  185
new oracle model saved
early stop counter: 2
val acc:0.8272373676300049, best validation acc: 0.8521400690078735, corresponding to test acc:                         0.8445945978164673 / 0.8536036014556885
after epoch: 4,now: 2024-07-26 09:30:29.026237,epoch time: 0:01:28.362171,used: 0:05:56.533671,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_09_24_32_seed_6_23065779
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9788411, 'precision': 0.9792129, 'recall': 0.97905135, 'specificity': 0.97905135, 'f1': 0.9788407, 'auroc': 0.9978138, 'binary_precision': 0.9960053, 'binary_recall': 0.9620579, 'binary_specificity': 0.9960448, 'binary_f1_score': 0.97873735}
confusion matrix:
      0     1
0  1511     6
1    59  1496
---- Validation: 
scalar performance:
{'acc': 0.8420234, 'precision': 0.84800076, 'recall': 0.8415632, 'specificity': 0.8415632, 'f1': 0.8412094, 'auroc': 0.9099461, 'binary_precision': 0.8918919, 'binary_recall': 0.7758621, 'binary_specificity': 0.9072643, 'binary_f1_score': 0.8298408}
confusion matrix:
     0    1
0  587   60
1  143  495
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8423423, 'precision': 0.8577001, 'recall': 0.8423423, 'specificity': 0.8423423, 'f1': 0.8406317, 'auroc': 0.9175391, 'binary_precision': 0.9318182, 'binary_recall': 0.7387387, 'binary_specificity': 0.9459459, 'binary_f1_score': 0.8241206}
confusion matrix:
     0    1
0  210   12
1   58  164
early stop counter: 3
val acc:0.8420233726501465, best validation acc: 0.8521400690078735, corresponding to test acc:                         0.8445945978164673 / 0.8536036014556885
after epoch: 5,now: 2024-07-26 09:31:57.824663,epoch time: 0:01:28.798426,used: 0:07:25.332097,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_09_24_32_seed_6_23065779
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9583333, 'precision': 0.9608269, 'recall': 0.9579693, 'specificity': 0.9579693, 'f1': 0.9582491, 'auroc': 0.9974663, 'binary_precision': 0.92943305, 'binary_recall': 0.99291235, 'binary_specificity': 0.9230263, 'binary_f1_score': 0.9601246}
confusion matrix:
      0     1
0  1403   117
1    11  1541
---- Validation: 
scalar performance:
{'acc': 0.80544746, 'precision': 0.80901605, 'recall': 0.8058195, 'specificity': 0.8058195, 'f1': 0.80500805, 'auroc': 0.88629216, 'binary_precision': 0.7740113, 'binary_recall': 0.85893416, 'binary_specificity': 0.7527048, 'binary_f1_score': 0.8142645}
confusion matrix:
     0    1
0  487  160
1   90  548
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7432432, 'precision': 0.7755356, 'recall': 0.7432432, 'specificity': 0.7432432, 'f1': 0.7354933, 'auroc': 0.88099587, 'binary_precision': 0.6812081, 'binary_recall': 0.9144144, 'binary_specificity': 0.5720721, 'binary_f1_score': 0.7807692}
confusion matrix:
     0    1
0  127   95
1   19  203
early stop counter: 4
val acc:0.8054474592208862, best validation acc: 0.8521400690078735, corresponding to test acc:                         0.8445945978164673 / 0.8536036014556885
after epoch: 6,now: 2024-07-26 09:33:25.344206,epoch time: 0:01:27.519543,used: 0:08:52.851640,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_09_24_32_seed_6_23065779
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.98860675, 'precision': 0.9887205, 'recall': 0.98854786, 'specificity': 0.98854786, 'f1': 0.98860383, 'auroc': 0.99950874, 'binary_precision': 0.98342896, 'binary_recall': 0.994201, 'binary_specificity': 0.9828947, 'binary_f1_score': 0.9887857}
confusion matrix:
      0     1
0  1494    26
1     9  1543
---- Validation: 
scalar performance:
{'acc': 0.8404669, 'precision': 0.84046066, 'recall': 0.84047544, 'specificity': 0.84047544, 'f1': 0.8404634, 'auroc': 0.90298116, 'binary_precision': 0.83775353, 'binary_recall': 0.8416928, 'binary_specificity': 0.83925813, 'binary_f1_score': 0.8397185}
confusion matrix:
     0    1
0  543  104
1  101  537
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7995495, 'precision': 0.8063181, 'recall': 0.7995496, 'specificity': 0.7995496, 'f1': 0.79843605, 'auroc': 0.8921354, 'binary_precision': 0.7607843, 'binary_recall': 0.8738739, 'binary_specificity': 0.7252252, 'binary_f1_score': 0.8134172}
confusion matrix:
     0    1
0  161   61
1   28  194
early stop counter: 5
val acc:0.8404669165611267, best validation acc: 0.8521400690078735, corresponding to test acc:                         0.8445945978164673 / 0.8536036014556885
after epoch: 7,now: 2024-07-26 09:34:53.598568,epoch time: 0:01:28.254362,used: 0:10:21.106002,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_09_24_32_seed_6_23065779
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.976888, 'precision': 0.9775742, 'recall': 0.9771266, 'specificity': 0.9771266, 'f1': 0.9768853, 'auroc': 0.99823487, 'binary_precision': 0.9986541, 'binary_recall': 0.95556986, 'binary_specificity': 0.99868333, 'binary_f1_score': 0.97663707}
confusion matrix:
      0     1
0  1517     2
1    69  1484
---- Validation: 
scalar performance:
{'acc': 0.785214, 'precision': 0.8175148, 'recall': 0.78409153, 'specificity': 0.78409153, 'f1': 0.77914584, 'auroc': 0.89272165, 'binary_precision': 0.9170507, 'binary_recall': 0.6238245, 'binary_specificity': 0.9443586, 'binary_f1_score': 0.7425374}
confusion matrix:
     0    1
0  611   36
1  240  398
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.704955, 'precision': 0.79574, 'recall': 0.704955, 'specificity': 0.704955, 'f1': 0.6804299, 'auroc': 0.8823148, 'binary_precision': 0.959596, 'binary_recall': 0.42792794, 'binary_specificity': 0.981982, 'binary_f1_score': 0.59190035}
confusion matrix:
     0   1
0  218   4
1  127  95
early stop counter: 6
val acc:0.7852140069007874, best validation acc: 0.8521400690078735, corresponding to test acc:                         0.8445945978164673 / 0.8536036014556885
after epoch: 8,now: 2024-07-26 09:36:21.134793,epoch time: 0:01:27.536225,used: 0:11:48.642227,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_09_24_32_seed_6_23065779
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.96484375, 'precision': 0.96713257, 'recall': 0.96447915, 'specificity': 0.96447915, 'f1': 0.96477675, 'auroc': 0.9993819, 'binary_precision': 0.9370841, 'binary_recall': 0.99742436, 'binary_specificity': 0.93153393, 'binary_f1_score': 0.9663132}
confusion matrix:
      0     1
0  1415   104
1     4  1549
---- Validation: 
scalar performance:
{'acc': 0.833463, 'precision': 0.83759606, 'recall': 0.8330733, 'specificity': 0.8330733, 'f1': 0.83283126, 'auroc': 0.8957596, 'binary_precision': 0.87323946, 'binary_recall': 0.77742946, 'binary_specificity': 0.8887172, 'binary_f1_score': 0.82255393}
confusion matrix:
     0    1
0  575   72
1  142  496
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8310811, 'precision': 0.8310878, 'recall': 0.83108103, 'specificity': 0.83108103, 'f1': 0.8310802, 'auroc': 0.9076779, 'binary_precision': 0.8325792, 'binary_recall': 0.8288288, 'binary_specificity': 0.8333333, 'binary_f1_score': 0.8306998}
confusion matrix:
     0    1
0  185   37
1   38  184
early stop counter: 7
val acc:0.8334630131721497, best validation acc: 0.8521400690078735, corresponding to test acc:                         0.8445945978164673 / 0.8536036014556885
after epoch: 9,now: 2024-07-26 09:37:49.027656,epoch time: 0:01:27.892863,used: 0:13:16.535090,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_09_24_32_seed_6_23065779
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9840495, 'precision': 0.9843614, 'recall': 0.9841974, 'specificity': 0.9841974, 'f1': 0.98404896, 'auroc': 0.999479, 'binary_precision': 0.9993351, 'binary_recall': 0.9690522, 'binary_specificity': 0.99934256, 'binary_f1_score': 0.9839607}
confusion matrix:
      0     1
0  1520     1
1    48  1503
---- Validation: 
scalar performance:
{'acc': 0.7003891, 'precision': 0.7874298, 'recall': 0.69845027, 'specificity': 0.69845027, 'f1': 0.67456174, 'auroc': 0.90957355, 'binary_precision': 0.94385964, 'binary_recall': 0.42163008, 'binary_specificity': 0.97527045, 'binary_f1_score': 0.58288187}
confusion matrix:
     0    1
0  631   16
1  369  269
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5427928, 'precision': 0.76117647, 'recall': 0.5427928, 'specificity': 0.5427928, 'f1': 0.42196026, 'auroc': 0.9030314, 'binary_precision': 1.0, 'binary_recall': 0.08558559, 'binary_specificity': 1.0, 'binary_f1_score': 0.15767635}
confusion matrix:
     0   1
0  222   0
1  203  19
early stop counter: 8
val acc:0.7003890872001648, best validation acc: 0.8521400690078735, corresponding to test acc:                         0.8445945978164673 / 0.8536036014556885
after epoch: 10,now: 2024-07-26 09:39:16.688058,epoch time: 0:01:27.660402,used: 0:14:44.195492,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_09_24_32_seed_6_23065779
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.98502606, 'precision': 0.9851327, 'recall': 0.9851607, 'specificity': 0.9851607, 'f1': 0.985026, 'auroc': 0.99889106, 'binary_precision': 0.99605525, 'binary_recall': 0.97427654, 'binary_specificity': 0.9960448, 'binary_f1_score': 0.9850455}
confusion matrix:
      0     1
0  1511     6
1    40  1515
---- Validation: 
scalar performance:
{'acc': 0.633463, 'precision': 0.7523701, 'recall': 0.6310413, 'specificity': 0.6310413, 'f1': 0.5822292, 'auroc': 0.8089324, 'binary_precision': 0.92385787, 'binary_recall': 0.28526646, 'binary_specificity': 0.97681606, 'binary_f1_score': 0.43592814}
confusion matrix:
     0    1
0  632   15
1  456  182
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6779279, 'precision': 0.8041096, 'recall': 0.6779279, 'specificity': 0.6779279, 'f1': 0.6406527, 'auroc': 0.9099099, 'binary_precision': 1.0, 'binary_recall': 0.35585585, 'binary_specificity': 1.0, 'binary_f1_score': 0.52491695}
confusion matrix:
     0   1
0  222   0
1  143  79
early stop counter: 9
val acc:0.6334630250930786, best validation acc: 0.8521400690078735, corresponding to test acc:                         0.8445945978164673 / 0.8536036014556885
after epoch: 11,now: 2024-07-26 09:40:44.826411,epoch time: 0:01:28.138353,used: 0:16:12.333845,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_09_24_32_seed_6_23065779
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9899089, 'precision': 0.98989606, 'recall': 0.9899677, 'specificity': 0.9899677, 'f1': 0.9899083, 'auroc': 0.9990848, 'binary_precision': 0.9948052, 'binary_recall': 0.985209, 'binary_specificity': 0.9947264, 'binary_f1_score': 0.98998386}
confusion matrix:
      0     1
0  1509     8
1    23  1532
---- Validation: 
scalar performance:
{'acc': 0.7167315, 'precision': 0.78737855, 'recall': 0.7149843, 'specificity': 0.7149843, 'f1': 0.6971177, 'auroc': 0.89366585, 'binary_precision': 0.928125, 'binary_recall': 0.46551725, 'binary_specificity': 0.9644513, 'binary_f1_score': 0.6200418}
confusion matrix:
     0    1
0  624   23
1  341  297
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8648649, 'precision': 0.8896594, 'recall': 0.8648648, 'specificity': 0.8648648, 'f1': 0.86268044, 'auroc': 0.92916566, 'binary_precision': 0.9879518, 'binary_recall': 0.7387387, 'binary_specificity': 0.990991, 'binary_f1_score': 0.8453608}
confusion matrix:
     0    1
0  220    2
1   58  164
new oracle model saved
early stop counter: 10
val acc:0.7167314887046814, best validation acc: 0.8521400690078735, corresponding to test acc:                         0.8445945978164673 / 0.8648648858070374
after epoch: 12,now: 2024-07-26 09:42:13.306795,epoch time: 0:01:28.480384,used: 0:17:40.814229,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_09_24_32_seed_6_23065779
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.99348956, 'precision': 0.9935468, 'recall': 0.9934505, 'specificity': 0.9934505, 'f1': 0.99348813, 'auroc': 0.9998219, 'binary_precision': 0.9904092, 'binary_recall': 0.9967825, 'binary_specificity': 0.99011856, 'binary_f1_score': 0.99358565}
confusion matrix:
      0     1
0  1503    15
1     5  1549
---- Validation: 
scalar performance:
{'acc': 0.7867704, 'precision': 0.8145348, 'recall': 0.7857243, 'specificity': 0.7857243, 'f1': 0.7815309, 'auroc': 0.89576197, 'binary_precision': 0.90625, 'binary_recall': 0.6363636, 'binary_specificity': 0.935085, 'binary_f1_score': 0.747698}
confusion matrix:
     0    1
0  605   42
1  232  406
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8378378, 'precision': 0.84696174, 'recall': 0.8378378, 'specificity': 0.8378378, 'f1': 0.8367647, 'auroc': 0.91110706, 'binary_precision': 0.9032258, 'binary_recall': 0.7567568, 'binary_specificity': 0.9189189, 'binary_f1_score': 0.8235294}
confusion matrix:
     0    1
0  204   18
1   54  168
early stop counter: 11
val acc:0.7867704033851624, best validation acc: 0.8521400690078735, corresponding to test acc:                         0.8445945978164673 / 0.8648648858070374
after epoch: 13,now: 2024-07-26 09:43:41.361290,epoch time: 0:01:28.054495,used: 0:19:08.868724,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_09_24_32_seed_6_23065779
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9938151, 'precision': 0.99382627, 'recall': 0.9938043, 'specificity': 0.9938043, 'f1': 0.9938143, 'auroc': 0.999763, 'binary_precision': 0.99292606, 'binary_recall': 0.9948454, 'binary_specificity': 0.99276316, 'binary_f1_score': 0.9938848}
confusion matrix:
      0     1
0  1509    11
1     8  1544
---- Validation: 
scalar performance:
{'acc': 0.6124514, 'precision': 0.75735277, 'recall': 0.6098051, 'specificity': 0.6098051, 'f1': 0.54619527, 'auroc': 0.89711195, 'binary_precision': 0.94871795, 'binary_recall': 0.23197491, 'binary_specificity': 0.98763525, 'binary_f1_score': 0.37279594}
confusion matrix:
     0    1
0  639    8
1  490  148
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5788288, 'precision': 0.77139366, 'recall': 0.5788288, 'specificity': 0.5788288, 'f1': 0.48800927, 'auroc': 0.9162811, 'binary_precision': 1.0, 'binary_recall': 0.15765765, 'binary_specificity': 1.0, 'binary_f1_score': 0.27237353}
confusion matrix:
     0   1
0  222   0
1  187  35
early stop counter: 12
val acc:0.6124513745307922, best validation acc: 0.8521400690078735, corresponding to test acc:                         0.8445945978164673 / 0.8648648858070374
after epoch: 14,now: 2024-07-26 09:45:09.880808,epoch time: 0:01:28.519518,used: 0:20:37.388242,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_09_24_32_seed_6_23065779
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.991862, 'precision': 0.9918588, 'recall': 0.991912, 'specificity': 0.991912, 'f1': 0.9918617, 'auroc': 0.9994625, 'binary_precision': 0.9967469, 'binary_recall': 0.9871134, 'binary_specificity': 0.99671054, 'binary_f1_score': 0.99190676}
confusion matrix:
      0     1
0  1515     5
1    20  1532
---- Validation: 
scalar performance:
{'acc': 0.7143969, 'precision': 0.7989647, 'recall': 0.7125242, 'specificity': 0.7125242, 'f1': 0.6915109, 'auroc': 0.8951048, 'binary_precision': 0.956229, 'binary_recall': 0.44514108, 'binary_specificity': 0.9799073, 'binary_f1_score': 0.60748667}
confusion matrix:
     0    1
0  634   13
1  354  284
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6216216, 'precision': 0.74025977, 'recall': 0.6216216, 'specificity': 0.6216216, 'f1': 0.5683333, 'auroc': 0.890715, 'binary_precision': 0.90909094, 'binary_recall': 0.27027026, 'binary_specificity': 0.972973, 'binary_f1_score': 0.41666663}
confusion matrix:
     0   1
0  216   6
1  162  60
early stop counter: 13
val acc:0.7143968939781189, best validation acc: 0.8521400690078735, corresponding to test acc:                         0.8445945978164673 / 0.8648648858070374
after epoch: 15,now: 2024-07-26 09:46:38.034703,epoch time: 0:01:28.153895,used: 0:22:05.542137,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_09_24_32_seed_6_23065779
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.98828125, 'precision': 0.9883317, 'recall': 0.98835146, 'specificity': 0.98835146, 'f1': 0.98828125, 'auroc': 0.9995558, 'binary_precision': 0.9960682, 'binary_recall': 0.9806452, 'binary_specificity': 0.9960578, 'binary_f1_score': 0.9882965}
confusion matrix:
      0     1
0  1516     6
1    30  1520
---- Validation: 
scalar performance:
{'acc': 0.6342412, 'precision': 0.75282955, 'recall': 0.631825, 'specificity': 0.631825, 'f1': 0.58337474, 'auroc': 0.8885815, 'binary_precision': 0.92424244, 'binary_recall': 0.28683385, 'binary_specificity': 0.97681606, 'binary_f1_score': 0.43779907}
confusion matrix:
     0    1
0  632   15
1  455  183
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7454955, 'precision': 0.8197832, 'recall': 0.7454955, 'specificity': 0.7454955, 'f1': 0.7298034, 'auroc': 0.9239713, 'binary_precision': 0.973913, 'binary_recall': 0.5045045, 'binary_specificity': 0.9864865, 'binary_f1_score': 0.6646884}
confusion matrix:
     0    1
0  219    3
1  110  112
early stop counter: 14
val acc:0.6342412233352661, best validation acc: 0.8521400690078735, corresponding to test acc:                         0.8445945978164673 / 0.8648648858070374
after epoch: 16,now: 2024-07-26 09:48:06.526291,epoch time: 0:01:28.491588,used: 0:23:34.033725,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_09_24_32_seed_6_23065779
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.98307294, 'precision': 0.98336196, 'recall': 0.9832636, 'specificity': 0.9832636, 'f1': 0.98307276, 'auroc': 0.9993157, 'binary_precision': 0.99867284, 'binary_recall': 0.9678457, 'binary_specificity': 0.9986816, 'binary_f1_score': 0.9830176}
confusion matrix:
      0     1
0  1515     2
1    50  1505
---- Validation: 
scalar performance:
{'acc': 0.6910506, 'precision': 0.7839618, 'recall': 0.689035, 'specificity': 0.689035, 'f1': 0.6621218, 'auroc': 0.91309, 'binary_precision': 0.94464946, 'binary_recall': 0.4012539, 'binary_specificity': 0.97681606, 'binary_f1_score': 0.5632563}
confusion matrix:
     0    1
0  632   15
1  382  256
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5247748, 'precision': 0.75635105, 'recall': 0.5247748, 'specificity': 0.5247748, 'f1': 0.38614163, 'auroc': 0.92673075, 'binary_precision': 1.0, 'binary_recall': 0.04954955, 'binary_specificity': 1.0, 'binary_f1_score': 0.0944206}
confusion matrix:
     0   1
0  222   0
1  211  11
early stop counter: 15
val acc:0.6910505890846252, best validation acc: 0.8521400690078735, corresponding to test acc:                         0.8445945978164673 / 0.8648648858070374
after epoch: 17,now: 2024-07-26 09:49:34.182930,epoch time: 0:01:27.656639,used: 0:25:01.690364,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_09_24_32_seed_6_23065779
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9941406, 'precision': 0.9941257, 'recall': 0.9941759, 'specificity': 0.9941759, 'f1': 0.99414027, 'auroc': 0.99969995, 'binary_precision': 0.9974077, 'binary_recall': 0.9909852, 'binary_specificity': 0.99736667, 'binary_f1_score': 0.9941861}
confusion matrix:
      0     1
0  1515     4
1    14  1539
---- Validation: 
scalar performance:
{'acc': 0.67159534, 'precision': 0.782436, 'recall': 0.669388, 'specificity': 0.669388, 'f1': 0.6341709, 'auroc': 0.9064001, 'binary_precision': 0.9576271, 'binary_recall': 0.35423198, 'binary_specificity': 0.98454404, 'binary_f1_score': 0.5171625}
confusion matrix:
     0    1
0  637   10
1  412  226
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5833333, 'precision': 0.77272725, 'recall': 0.5833333, 'specificity': 0.5833333, 'f1': 0.49579835, 'auroc': 0.92553365, 'binary_precision': 1.0, 'binary_recall': 0.16666667, 'binary_specificity': 1.0, 'binary_f1_score': 0.2857143}
confusion matrix:
     0   1
0  222   0
1  185  37
early stop counter: 16
val acc:0.6715953350067139, best validation acc: 0.8521400690078735, corresponding to test acc:                         0.8445945978164673 / 0.8648648858070374
after epoch: 18,now: 2024-07-26 09:51:01.973337,epoch time: 0:01:27.790407,used: 0:26:29.480771,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_09_24_32_seed_6_23065779
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.98828125, 'precision': 0.98844683, 'recall': 0.98819005, 'specificity': 0.98819005, 'f1': 0.9882765, 'auroc': 0.9995698, 'binary_precision': 0.9822448, 'binary_recall': 0.9948619, 'binary_specificity': 0.98151815, 'binary_f1_score': 0.9885131}
confusion matrix:
      0     1
0  1487    28
1     8  1549
---- Validation: 
scalar performance:
{'acc': 0.80544746, 'precision': 0.8293389, 'recall': 0.80450034, 'specificity': 0.80450034, 'f1': 0.8015093, 'auroc': 0.91223776, 'binary_precision': 0.916309, 'binary_recall': 0.669279, 'binary_specificity': 0.93972176, 'binary_f1_score': 0.7735507}
confusion matrix:
     0    1
0  608   39
1  211  427
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8243243, 'precision': 0.8648648, 'recall': 0.82432437, 'specificity': 0.82432437, 'f1': 0.81930506, 'auroc': 0.9326962, 'binary_precision': 0.9864865, 'binary_recall': 0.6576577, 'binary_specificity': 0.990991, 'binary_f1_score': 0.7891892}
confusion matrix:
     0    1
0  220    2
1   76  146
early stop counter: 17
val acc:0.8054474592208862, best validation acc: 0.8521400690078735, corresponding to test acc:                         0.8445945978164673 / 0.8648648858070374
after epoch: 19,now: 2024-07-26 09:52:29.700222,epoch time: 0:01:27.726885,used: 0:27:57.207656,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_09_24_32_seed_6_23065779
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9814453, 'precision': 0.981829, 'recall': 0.981645, 'specificity': 0.981645, 'f1': 0.9814448, 'auroc': 0.99961424, 'binary_precision': 0.99866754, 'binary_recall': 0.9646075, 'binary_specificity': 0.9986825, 'binary_f1_score': 0.9813421}
confusion matrix:
      0     1
0  1516     2
1    55  1499
---- Validation: 
scalar performance:
{'acc': 0.6249027, 'precision': 0.75399697, 'recall': 0.6223879, 'specificity': 0.6223879, 'f1': 0.5678219, 'auroc': 0.87392676, 'binary_precision': 0.93333334, 'binary_recall': 0.2633229, 'binary_specificity': 0.9814529, 'binary_f1_score': 0.41075793}
confusion matrix:
     0    1
0  635   12
1  470  168
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6644144, 'precision': 0.79279137, 'recall': 0.6644144, 'specificity': 0.6644144, 'f1': 0.6231007, 'auroc': 0.9140492, 'binary_precision': 0.9866667, 'binary_recall': 0.33333334, 'binary_specificity': 0.9954955, 'binary_f1_score': 0.4983165}
confusion matrix:
     0   1
0  221   1
1  148  74
early stop counter: 18
val acc:0.6249027252197266, best validation acc: 0.8521400690078735, corresponding to test acc:                         0.8445945978164673 / 0.8648648858070374
after epoch: 20,now: 2024-07-26 09:53:57.685635,epoch time: 0:01:27.985413,used: 0:29:25.193069,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_09_24_32_seed_6_23065779
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9938151, 'precision': 0.9938612, 'recall': 0.99378395, 'specificity': 0.99378395, 'f1': 0.993814, 'auroc': 0.99985075, 'binary_precision': 0.9910314, 'binary_recall': 0.99677837, 'binary_specificity': 0.9907895, 'binary_f1_score': 0.9938966}
confusion matrix:
      0     1
0  1506    14
1     5  1547
---- Validation: 
scalar performance:
{'acc': 0.76731515, 'precision': 0.79718053, 'recall': 0.7661972, 'specificity': 0.7661972, 'f1': 0.76080465, 'auroc': 0.88417727, 'binary_precision': 0.8896552, 'binary_recall': 0.60658306, 'binary_specificity': 0.9258114, 'binary_f1_score': 0.7213421}
confusion matrix:
     0    1
0  599   48
1  251  387
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6306306, 'precision': 0.77942705, 'recall': 0.6306306, 'specificity': 0.6306306, 'f1': 0.5739063, 'auroc': 0.8999473, 'binary_precision': 0.98333335, 'binary_recall': 0.26576576, 'binary_specificity': 0.9954955, 'binary_f1_score': 0.4184397}
confusion matrix:
     0   1
0  221   1
1  163  59
early stop counter: 19
val acc:0.767315149307251, best validation acc: 0.8521400690078735, corresponding to test acc:                         0.8445945978164673 / 0.8648648858070374
after epoch: 21,now: 2024-07-26 09:55:25.595813,epoch time: 0:01:27.910178,used: 0:30:53.103247,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_09_24_32_seed_6_23065779
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.99088544, 'precision': 0.99101424, 'recall': 0.99081945, 'specificity': 0.99081945, 'f1': 0.99088275, 'auroc': 0.99971515, 'binary_precision': 0.98535967, 'binary_recall': 0.9967804, 'binary_specificity': 0.98485845, 'binary_f1_score': 0.99103713}
confusion matrix:
      0     1
0  1496    23
1     5  1548
---- Validation: 
scalar performance:
{'acc': 0.8249027, 'precision': 0.8426391, 'recall': 0.8241038, 'specificity': 0.8241038, 'f1': 0.8223512, 'auroc': 0.9238013, 'binary_precision': 0.9188641, 'binary_recall': 0.71003133, 'binary_specificity': 0.9381762, 'binary_f1_score': 0.80106103}
confusion matrix:
     0    1
0  607   40
1  185  453
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7747748, 'precision': 0.8447205, 'recall': 0.7747748, 'specificity': 0.7747748, 'f1': 0.76273936, 'auroc': 0.94249654, 'binary_precision': 1.0, 'binary_recall': 0.5495495, 'binary_specificity': 1.0, 'binary_f1_score': 0.70930225}
confusion matrix:
     0    1
0  222    0
1  100  122
early stop counter: 20
val acc:0.8249027132987976, best validation acc: 0.8521400690078735, corresponding to test acc:                         0.8445945978164673 / 0.8648648858070374
after epoch: 22,now: 2024-07-26 09:56:53.189988,epoch time: 0:01:27.594175,used: 0:32:20.697422,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_09_24_32_seed_6_23065779
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.991862, 'precision': 0.9918664, 'recall': 0.9919496, 'specificity': 0.9919496, 'f1': 0.99186164, 'auroc': 0.9998839, 'binary_precision': 0.99869704, 'binary_recall': 0.9852185, 'binary_specificity': 0.9986807, 'binary_f1_score': 0.991912}
confusion matrix:
      0     1
0  1514     2
1    23  1533
---- Validation: 
scalar performance:
{'acc': 0.7291829, 'precision': 0.7979692, 'recall': 0.7274908, 'specificity': 0.7274908, 'f1': 0.71163374, 'auroc': 0.898901, 'binary_precision': 0.93939394, 'binary_recall': 0.48589343, 'binary_specificity': 0.9690881, 'binary_f1_score': 0.6404959}
confusion matrix:
     0    1
0  627   20
1  328  310
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7094595, 'precision': 0.81135577, 'recall': 0.7094594, 'specificity': 0.7094594, 'f1': 0.6835702, 'auroc': 0.9251684, 'binary_precision': 0.9894737, 'binary_recall': 0.4234234, 'binary_specificity': 0.9954955, 'binary_f1_score': 0.5930599}
confusion matrix:
     0   1
0  221   1
1  128  94
early stop counter: 21
val acc:0.7291828989982605, best validation acc: 0.8521400690078735, corresponding to test acc:                         0.8445945978164673 / 0.8648648858070374
after epoch: 23,now: 2024-07-26 09:58:21.130618,epoch time: 0:01:27.940630,used: 0:33:48.638052,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_09_24_32_seed_6_23065779
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.99121094, 'precision': 0.9911977, 'recall': 0.99122787, 'specificity': 0.99122787, 'f1': 0.9912101, 'auroc': 0.9996207, 'binary_precision': 0.99289405, 'binary_recall': 0.98969734, 'binary_specificity': 0.9927584, 'binary_f1_score': 0.9912931}
confusion matrix:
      0     1
0  1508    11
1    16  1537
---- Validation: 
scalar performance:
{'acc': 0.76575875, 'precision': 0.8131212, 'recall': 0.76439, 'specificity': 0.76439, 'f1': 0.7559194, 'auroc': 0.90919745, 'binary_precision': 0.933162, 'binary_recall': 0.5689655, 'binary_specificity': 0.95981455, 'binary_f1_score': 0.70691335}
confusion matrix:
     0    1
0  621   26
1  275  363
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7545045, 'precision': 0.8209324, 'recall': 0.7545045, 'specificity': 0.7545045, 'f1': 0.7411078, 'auroc': 0.8973906, 'binary_precision': 0.96694213, 'binary_recall': 0.527027, 'binary_specificity': 0.981982, 'binary_f1_score': 0.6822157}
confusion matrix:
     0    1
0  218    4
1  105  117
early stop counter: 22
val acc:0.765758752822876, best validation acc: 0.8521400690078735, corresponding to test acc:                         0.8445945978164673 / 0.8648648858070374
after epoch: 24,now: 2024-07-26 09:59:49.104405,epoch time: 0:01:27.973787,used: 0:35:16.611839,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_09_24_32_seed_6_23065779
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.9899089, 'precision': 0.99010617, 'recall': 0.98981464, 'specificity': 0.98981464, 'f1': 0.9899048, 'auroc': 0.9995998, 'binary_precision': 0.9828897, 'binary_recall': 0.99742764, 'binary_specificity': 0.9822017, 'binary_f1_score': 0.9901053}
confusion matrix:
      0     1
0  1490    27
1     4  1551
---- Validation: 
scalar performance:
{'acc': 0.8070039, 'precision': 0.8275808, 'recall': 0.8061223, 'specificity': 0.8061223, 'f1': 0.80360687, 'auroc': 0.9075653, 'binary_precision': 0.9079498, 'binary_recall': 0.68025076, 'binary_specificity': 0.93199384, 'binary_f1_score': 0.77777773}
confusion matrix:
     0    1
0  603   44
1  204  434
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8198198, 'precision': 0.8266059, 'recall': 0.8198198, 'specificity': 0.8198198, 'f1': 0.818879, 'auroc': 0.9096867, 'binary_precision': 0.8736842, 'binary_recall': 0.7477477, 'binary_specificity': 0.8918919, 'binary_f1_score': 0.80582523}
confusion matrix:
     0    1
0  198   24
1   56  166
early stop counter: 23
val acc:0.807003915309906, best validation acc: 0.8521400690078735, corresponding to test acc:                         0.8445945978164673 / 0.8648648858070374
after epoch: 25,now: 2024-07-26 10:01:16.983614,epoch time: 0:01:27.879209,used: 0:36:44.491048,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_09_24_32_seed_6_23065779
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9944661, 'precision': 0.9944544, 'recall': 0.99450284, 'specificity': 0.99450284, 'f1': 0.9944659, 'auroc': 0.9999118, 'binary_precision': 0.9980532, 'binary_recall': 0.9909794, 'binary_specificity': 0.9980263, 'binary_f1_score': 0.99450374}
confusion matrix:
      0     1
0  1517     3
1    14  1538
---- Validation: 
scalar performance:
{'acc': 0.7385214, 'precision': 0.807804, 'recall': 0.7368515, 'specificity': 0.7368515, 'f1': 0.7220291, 'auroc': 0.91681707, 'binary_precision': 0.9520958, 'binary_recall': 0.4984326, 'binary_specificity': 0.97527045, 'binary_f1_score': 0.654321}
confusion matrix:
     0    1
0  631   16
1  320  318
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6103604, 'precision': 0.762462, 'recall': 0.6103604, 'specificity': 0.6103604, 'f1': 0.54434526, 'auroc': 0.8935963, 'binary_precision': 0.9622642, 'binary_recall': 0.22972973, 'binary_specificity': 0.990991, 'binary_f1_score': 0.3709091}
confusion matrix:
     0   1
0  220   2
1  171  51
early stop counter: 24
val acc:0.7385213971138, best validation acc: 0.8521400690078735, corresponding to test acc:                         0.8445945978164673 / 0.8648648858070374
after epoch: 26,now: 2024-07-26 10:02:44.647986,epoch time: 0:01:27.664372,used: 0:38:12.155420,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_09_24_32_seed_6_23065779
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.97753906, 'precision': 0.97849196, 'recall': 0.9773165, 'specificity': 0.9773165, 'f1': 0.9775176, 'auroc': 0.99952316, 'binary_precision': 0.9597274, 'binary_recall': 0.99742436, 'binary_specificity': 0.9572087, 'binary_f1_score': 0.97821283}
confusion matrix:
      0     1
0  1454    65
1     4  1549
---- Validation: 
scalar performance:
{'acc': 0.8459144, 'precision': 0.8492938, 'recall': 0.8455689, 'specificity': 0.8455689, 'f1': 0.8454426, 'auroc': 0.91568995, 'binary_precision': 0.8819444, 'binary_recall': 0.79623824, 'binary_specificity': 0.89489955, 'binary_f1_score': 0.83690286}
confusion matrix:
     0    1
0  579   68
1  130  508
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8265766, 'precision': 0.83077127, 'recall': 0.8265766, 'specificity': 0.8265766, 'f1': 0.82602495, 'auroc': 0.9189189, 'binary_precision': 0.8680203, 'binary_recall': 0.7702703, 'binary_specificity': 0.8828829, 'binary_f1_score': 0.81622905}
confusion matrix:
     0    1
0  196   26
1   51  171
early stop counter: 25
val acc:0.8459144234657288, best validation acc: 0.8521400690078735, corresponding to test acc:                         0.8445945978164673 / 0.8648648858070374
after epoch: 27,now: 2024-07-26 10:04:12.624222,epoch time: 0:01:27.976236,used: 0:39:40.131656,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_09_24_32_seed_6_23065779
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.9866536, 'precision': 0.9866556, 'recall': 0.9866471, 'specificity': 0.9866471, 'f1': 0.9866513, 'auroc': 0.9990665, 'binary_precision': 0.98651254, 'binary_recall': 0.98714656, 'binary_specificity': 0.98614776, 'binary_f1_score': 0.9868295}
confusion matrix:
      0     1
0  1495    21
1    20  1536
---- Validation: 
scalar performance:
{'acc': 0.83735406, 'precision': 0.84917873, 'recall': 0.83670837, 'specificity': 0.83670837, 'f1': 0.83577514, 'auroc': 0.90082026, 'binary_precision': 0.91170824, 'binary_recall': 0.7445141, 'binary_specificity': 0.9289026, 'binary_f1_score': 0.81967217}
confusion matrix:
     0    1
0  601   46
1  163  475
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8265766, 'precision': 0.8419012, 'recall': 0.8265766, 'specificity': 0.8265766, 'f1': 0.8246113, 'auroc': 0.88781345, 'binary_precision': 0.9142857, 'binary_recall': 0.7207207, 'binary_specificity': 0.9324324, 'binary_f1_score': 0.80604535}
confusion matrix:
     0    1
0  207   15
1   62  160
early stop counter: 26
val acc:0.8373540639877319, best validation acc: 0.8521400690078735, corresponding to test acc:                         0.8445945978164673 / 0.8648648858070374
after epoch: 28,now: 2024-07-26 10:05:40.440010,epoch time: 0:01:27.815788,used: 0:41:07.947444,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_09_24_32_seed_6_23065779
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9905599, 'precision': 0.9905915, 'recall': 0.9906591, 'specificity': 0.9906591, 'f1': 0.99055976, 'auroc': 0.9997342, 'binary_precision': 0.9986928, 'binary_recall': 0.98263663, 'binary_specificity': 0.9986816, 'binary_f1_score': 0.9905997}
confusion matrix:
      0     1
0  1515     2
1    27  1528
---- Validation: 
scalar performance:
{'acc': 0.6918288, 'precision': 0.771686, 'recall': 0.6899168, 'specificity': 0.6899168, 'f1': 0.6660533, 'auroc': 0.8524587, 'binary_precision': 0.9172414, 'binary_recall': 0.4169279, 'binary_specificity': 0.9629057, 'binary_f1_score': 0.57327586}
confusion matrix:
     0    1
0  623   24
1  372  266
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5810811, 'precision': 0.74727726, 'recall': 0.5810811, 'specificity': 0.5810811, 'f1': 0.49647588, 'auroc': 0.7897847, 'binary_precision': 0.95, 'binary_recall': 0.17117117, 'binary_specificity': 0.990991, 'binary_f1_score': 0.29007635}
confusion matrix:
     0   1
0  220   2
1  184  38
early stop counter: 27
val acc:0.6918287873268127, best validation acc: 0.8521400690078735, corresponding to test acc:                         0.8445945978164673 / 0.8648648858070374
after epoch: 29,now: 2024-07-26 10:07:08.674687,epoch time: 0:01:28.234677,used: 0:42:36.182121,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_09_24_32_seed_6_23065779
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.9889323, 'precision': 0.9889184, 'recall': 0.98895824, 'specificity': 0.98895824, 'f1': 0.98893166, 'auroc': 0.9994032, 'binary_precision': 0.9915803, 'binary_recall': 0.9864691, 'binary_specificity': 0.9914474, 'binary_f1_score': 0.9890181}
confusion matrix:
      0     1
0  1507    13
1    21  1531
---- Validation: 
scalar performance:
{'acc': 0.77509725, 'precision': 0.81234324, 'recall': 0.7738816, 'specificity': 0.7738816, 'f1': 0.7676536, 'auroc': 0.8949504, 'binary_precision': 0.91846526, 'binary_recall': 0.6003135, 'binary_specificity': 0.94744974, 'binary_f1_score': 0.72606635}
confusion matrix:
     0    1
0  613   34
1  255  383
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6238739, 'precision': 0.76876515, 'recall': 0.6238739, 'specificity': 0.6238739, 'f1': 0.5652852, 'auroc': 0.9129941, 'binary_precision': 0.9661017, 'binary_recall': 0.25675675, 'binary_specificity': 0.990991, 'binary_f1_score': 0.40569395}
confusion matrix:
     0   1
0  220   2
1  165  57
early stop counter: 28
val acc:0.7750972509384155, best validation acc: 0.8521400690078735, corresponding to test acc:                         0.8445945978164673 / 0.8648648858070374
after epoch: 30,now: 2024-07-26 10:08:36.405951,epoch time: 0:01:27.731264,used: 0:44:03.913385,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_09_24_32_seed_6_23065779
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 0:44:03.913385 at 2024-07-26 10:08:36.405951
persisted model performance metric: 

scalar performance:
{'acc': 0.8445946, 'precision': 0.8514476, 'recall': 0.8445946, 'specificity': 0.8445946, 'f1': 0.8438333, 'auroc': 0.9402443, 'binary_precision': 0.80237156, 'binary_recall': 0.9144144, 'binary_specificity': 0.7747748, 'binary_f1_score': 0.85473686}
confusion matrix:
     0    1
0  172   50
1   19  203
oracle model performance metric: 

scalar performance:
{'acc': 0.8648649, 'precision': 0.8896594, 'recall': 0.8648648, 'specificity': 0.8648648, 'f1': 0.86268044, 'auroc': 0.92916566, 'binary_precision': 0.9879518, 'binary_recall': 0.7387387, 'binary_specificity': 0.990991, 'binary_f1_score': 0.8453608}
confusion matrix:
     0    1
0  220    2
1   58  164
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_irm_10seeds_nofreeze_2024-07-26_02-28-54/rule_results/0.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_irm_10seeds_nofreeze_2024-07-26_02-28-54/confusion_matrix/0.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 455399 KiB |  13219 MiB | 511551 GiB | 511551 GiB |
|       from large pool | 414803 KiB |  13181 MiB | 505464 GiB | 505464 GiB |
|       from small pool |  40595 KiB |     60 MiB |   6087 GiB |   6087 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 455399 KiB |  13219 MiB | 511551 GiB | 511551 GiB |
|       from large pool | 414803 KiB |  13181 MiB | 505464 GiB | 505464 GiB |
|       from small pool |  40595 KiB |     60 MiB |   6087 GiB |   6087 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 447481 KiB |  13213 MiB | 510728 GiB | 510728 GiB |
|       from large pool | 407075 KiB |  13175 MiB | 504654 GiB | 504653 GiB |
|       from small pool |  40406 KiB |     60 MiB |   6074 GiB |   6074 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  14478 MiB |  14482 MiB |  96038 MiB |  81560 MiB |
|       from large pool |  14412 MiB |  14412 MiB |  95870 MiB |  81458 MiB |
|       from small pool |     66 MiB |     70 MiB |    168 MiB |    102 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 447769 KiB |   1236 MiB | 358001 GiB | 358001 GiB |
|       from large pool | 435116 KiB |   1229 MiB | 351876 GiB | 351876 GiB |
|       from small pool |  12652 KiB |     44 MiB |   6124 GiB |   6124 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    1304    |    2598    |   90474 K  |   90473 K  |
|       from large pool |     187    |    1413    |   46003 K  |   46003 K  |
|       from small pool |    1117    |    1419    |   44471 K  |   44470 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    1304    |    2598    |   90474 K  |   90473 K  |
|       from large pool |     187    |    1413    |   46003 K  |   46003 K  |
|       from small pool |    1117    |    1419    |   44471 K  |   44470 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     635    |     637    |    4074    |    3439    |
|       from large pool |     602    |     602    |    3990    |    3388    |
|       from small pool |      33    |      35    |      84    |      51    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     101    |     654    |   61390 K  |   61390 K  |
|       from large pool |      38    |     605    |   35359 K  |   35359 K  |
|       from small pool |      63    |     236    |   26030 K  |   26030 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13219 MiB | 511551 GiB | 511551 GiB |
|       from large pool |  16640 KiB |  13181 MiB | 505464 GiB | 505464 GiB |
|       from small pool |      0 KiB |     60 MiB |   6087 GiB |   6087 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13219 MiB | 511551 GiB | 511551 GiB |
|       from large pool |  16640 KiB |  13181 MiB | 505464 GiB | 505464 GiB |
|       from small pool |      0 KiB |     60 MiB |   6087 GiB |   6087 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13213 MiB | 510728 GiB | 510728 GiB |
|       from large pool |  16640 KiB |  13175 MiB | 504654 GiB | 504654 GiB |
|       from small pool |      0 KiB |     60 MiB |   6074 GiB |   6074 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    882 MiB |  14482 MiB |  96038 MiB |  95156 MiB |
|       from large pool |    830 MiB |  14412 MiB |  95870 MiB |  95040 MiB |
|       from small pool |     52 MiB |     70 MiB |    168 MiB |    116 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1236 MiB | 358001 GiB | 358001 GiB |
|       from large pool |  24320 KiB |   1229 MiB | 351876 GiB | 351876 GiB |
|       from small pool |      0 KiB |     47 MiB |   6125 GiB |   6125 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    2598    |   90474 K  |   90474 K  |
|       from large pool |       2    |    1413    |   46003 K  |   46003 K  |
|       from small pool |       0    |    1419    |   44471 K  |   44471 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    2598    |   90474 K  |   90474 K  |
|       from large pool |       2    |    1413    |   46003 K  |   46003 K  |
|       from small pool |       0    |    1419    |   44471 K  |   44471 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      63    |     637    |    4074    |    4011    |
|       from large pool |      37    |     602    |    3990    |    3953    |
|       from small pool |      26    |      35    |      84    |      58    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |     654    |   61391 K  |   61391 K  |
|       from large pool |       4    |     605    |   35359 K  |   35359 K  |
|       from small pool |       0    |     236    |   26031 K  |   26031 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13219 MiB | 511551 GiB | 511551 GiB |
|       from large pool |  16640 KiB |  13181 MiB | 505464 GiB | 505464 GiB |
|       from small pool |      0 KiB |     60 MiB |   6087 GiB |   6087 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13219 MiB | 511551 GiB | 511551 GiB |
|       from large pool |  16640 KiB |  13181 MiB | 505464 GiB | 505464 GiB |
|       from small pool |      0 KiB |     60 MiB |   6087 GiB |   6087 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13213 MiB | 510728 GiB | 510728 GiB |
|       from large pool |  16640 KiB |  13175 MiB | 504654 GiB | 504654 GiB |
|       from small pool |      0 KiB |     60 MiB |   6074 GiB |   6074 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    882 MiB |  14482 MiB |  96038 MiB |  95156 MiB |
|       from large pool |    830 MiB |  14412 MiB |  95870 MiB |  95040 MiB |
|       from small pool |     52 MiB |     70 MiB |    168 MiB |    116 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1236 MiB | 358001 GiB | 358001 GiB |
|       from large pool |  24320 KiB |   1229 MiB | 351876 GiB | 351876 GiB |
|       from small pool |      0 KiB |     47 MiB |   6125 GiB |   6125 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    2598    |   90474 K  |   90474 K  |
|       from large pool |       2    |    1413    |   46003 K  |   46003 K  |
|       from small pool |       0    |    1419    |   44471 K  |   44471 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    2598    |   90474 K  |   90474 K  |
|       from large pool |       2    |    1413    |   46003 K  |   46003 K  |
|       from small pool |       0    |    1419    |   44471 K  |   44471 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      63    |     637    |    4074    |    4011    |
|       from large pool |      37    |     602    |    3990    |    3953    |
|       from small pool |      26    |      35    |      84    |      58    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |     654    |   61391 K  |   61391 K  |
|       from large pool |       4    |     605    |   35359 K  |   35359 K  |
|       from small pool |       0    |     236    |   26031 K  |   26031 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'888c1ef2'
model name: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_10_09_04_seed_7_23065779

 Experiment start at: 2024-07-26 10:09:04.765282
before training, model accuracy: 0.4978165924549103
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9576823, 'precision': 0.957811, 'recall': 0.9575804, 'specificity': 0.9575804, 'f1': 0.9576628, 'auroc': 0.99198675, 'binary_precision': 0.9531052, 'binary_recall': 0.96410257, 'binary_specificity': 0.9510582, 'binary_f1_score': 0.9585724}
confusion matrix:
      0     1
0  1438    74
1    56  1504
---- Validation: 
scalar performance:
{'acc': 0.85307693, 'precision': 0.8562751, 'recall': 0.85234374, 'specificity': 0.85234374, 'f1': 0.8525324, 'auroc': 0.90132105, 'binary_precision': 0.8864027, 'binary_recall': 0.8046875, 'binary_specificity': 0.9, 'binary_f1_score': 0.8435709}
confusion matrix:
     0    1
0  594   66
1  125  515
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8689956, 'precision': 0.8703799, 'recall': 0.86899567, 'specificity': 0.86899567, 'f1': 0.8688731, 'auroc': 0.9388646, 'binary_precision': 0.89302325, 'binary_recall': 0.83842796, 'binary_specificity': 0.8995633, 'binary_f1_score': 0.8648648}
confusion matrix:
     0    1
0  206   23
1   37  192
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-26 10:10:36.052927,epoch time: 0:01:31.287645,used: 0:01:31.287645,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_10_09_04_seed_7_23065779
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9505208, 'precision': 0.95110166, 'recall': 0.9502747, 'specificity': 0.9502747, 'f1': 0.9504745, 'auroc': 0.9890988, 'binary_precision': 0.93835616, 'binary_recall': 0.96602565, 'binary_specificity': 0.9345238, 'binary_f1_score': 0.95198995}
confusion matrix:
      0     1
0  1413    99
1    53  1507
---- Validation: 
scalar performance:
{'acc': 0.8353846, 'precision': 0.8379031, 'recall': 0.8347064, 'specificity': 0.8347064, 'f1': 0.8348495, 'auroc': 0.9051823, 'binary_precision': 0.8634812, 'binary_recall': 0.790625, 'binary_specificity': 0.8787879, 'binary_f1_score': 0.82544863}
confusion matrix:
     0    1
0  580   80
1  134  506
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.84934497, 'precision': 0.8496717, 'recall': 0.84934497, 'specificity': 0.84934497, 'f1': 0.8493098, 'auroc': 0.9329913, 'binary_precision': 0.83898306, 'binary_recall': 0.8646288, 'binary_specificity': 0.83406115, 'binary_f1_score': 0.8516129}
confusion matrix:
     0    1
0  191   38
1   31  198
early stop counter: 1
val acc:0.8353846073150635, best validation acc: 0.8530769348144531, corresponding to test acc:                         0.8689956068992615 / 0.8689956068992615
after epoch: 2,now: 2024-07-26 10:12:04.526609,epoch time: 0:01:28.473682,used: 0:02:59.761327,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_10_09_04_seed_7_23065779
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9733073, 'precision': 0.97354496, 'recall': 0.97354496, 'specificity': 0.97354496, 'f1': 0.9733073, 'auroc': 0.9970683, 'binary_precision': 0.9887566, 'binary_recall': 0.9583333, 'binary_specificity': 0.9887566, 'binary_f1_score': 0.9733073}
confusion matrix:
      0     1
0  1495    17
1    65  1495
---- Validation: 
scalar performance:
{'acc': 0.79923075, 'precision': 0.82565784, 'recall': 0.79701704, 'specificity': 0.79701704, 'f1': 0.7942128, 'auroc': 0.8832836, 'binary_precision': 0.9146608, 'binary_recall': 0.653125, 'binary_specificity': 0.9409091, 'binary_f1_score': 0.7620784}
confusion matrix:
     0    1
0  621   39
1  222  418
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8733624, 'precision': 0.8839344, 'recall': 0.8733624, 'specificity': 0.8733624, 'f1': 0.8724847, 'auroc': 0.9429835, 'binary_precision': 0.947644, 'binary_recall': 0.790393, 'binary_specificity': 0.95633185, 'binary_f1_score': 0.86190474}
confusion matrix:
     0    1
0  219   10
1   48  181
new oracle model saved
early stop counter: 2
val acc:0.7992307543754578, best validation acc: 0.8530769348144531, corresponding to test acc:                         0.8689956068992615 / 0.8733624219894409
after epoch: 3,now: 2024-07-26 10:13:33.855028,epoch time: 0:01:29.328419,used: 0:04:29.089746,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_10_09_04_seed_7_23065779
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9313151, 'precision': 0.93912804, 'recall': 0.93030626, 'specificity': 0.93030626, 'f1': 0.93088263, 'auroc': 0.9963031, 'binary_precision': 0.8843305, 'binary_recall': 0.9948718, 'binary_specificity': 0.8657407, 'binary_f1_score': 0.9363499}
confusion matrix:
      0     1
0  1309   203
1     8  1552
---- Validation: 
scalar performance:
{'acc': 0.76153845, 'precision': 0.7755939, 'recall': 0.7632339, 'specificity': 0.7632339, 'f1': 0.75920403, 'auroc': 0.8690933, 'binary_precision': 0.7093909, 'binary_recall': 0.8734375, 'binary_specificity': 0.6530303, 'binary_f1_score': 0.7829132}
confusion matrix:
     0    1
0  431  229
1   81  559
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7248908, 'precision': 0.7862153, 'recall': 0.7248908, 'specificity': 0.7248908, 'f1': 0.7093206, 'auroc': 0.91619146, 'binary_precision': 0.65373135, 'binary_recall': 0.95633185, 'binary_specificity': 0.49344978, 'binary_f1_score': 0.7765958}
confusion matrix:
     0    1
0  113  116
1   10  219
early stop counter: 3
val acc:0.7615384459495544, best validation acc: 0.8530769348144531, corresponding to test acc:                         0.8689956068992615 / 0.8733624219894409
after epoch: 4,now: 2024-07-26 10:15:00.868786,epoch time: 0:01:27.013758,used: 0:05:56.103504,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_10_09_04_seed_7_23065779
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9811198, 'precision': 0.98118263, 'recall': 0.9810643, 'specificity': 0.9810643, 'f1': 0.9811131, 'auroc': 0.9982554, 'binary_precision': 0.97834396, 'binary_recall': 0.9846154, 'binary_specificity': 0.97751325, 'binary_f1_score': 0.9814697}
confusion matrix:
      0     1
0  1478    34
1    24  1536
---- Validation: 
scalar performance:
{'acc': 0.83076924, 'precision': 0.847008, 'recall': 0.8290956, 'specificity': 0.8290956, 'f1': 0.82823193, 'auroc': 0.90660036, 'binary_precision': 0.9183267, 'binary_recall': 0.7203125, 'binary_specificity': 0.9378788, 'binary_f1_score': 0.80735546}
confusion matrix:
     0    1
0  619   41
1  179  461
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8646288, 'precision': 0.8878207, 'recall': 0.8646288, 'specificity': 0.8646288, 'f1': 0.86257434, 'auroc': 0.9410385, 'binary_precision': 0.982659, 'binary_recall': 0.7423581, 'binary_specificity': 0.98689955, 'binary_f1_score': 0.8457712}
confusion matrix:
     0    1
0  226    3
1   59  170
early stop counter: 4
val acc:0.8307692408561707, best validation acc: 0.8530769348144531, corresponding to test acc:                         0.8689956068992615 / 0.8733624219894409
after epoch: 5,now: 2024-07-26 10:16:27.674886,epoch time: 0:01:26.806100,used: 0:07:22.909604,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_10_09_04_seed_7_23065779
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9824219, 'precision': 0.98281527, 'recall': 0.9822446, 'specificity': 0.9822446, 'f1': 0.98240936, 'auroc': 0.9990529, 'binary_precision': 0.9723965, 'binary_recall': 0.99358976, 'binary_specificity': 0.97089946, 'binary_f1_score': 0.9828789}
confusion matrix:
      0     1
0  1468    44
1    10  1550
---- Validation: 
scalar performance:
{'acc': 0.8384615, 'precision': 0.8403249, 'recall': 0.8378788, 'specificity': 0.8378788, 'f1': 0.83804405, 'auroc': 0.90036464, 'binary_precision': 0.86195284, 'binary_recall': 0.8, 'binary_specificity': 0.8757576, 'binary_f1_score': 0.8298217}
confusion matrix:
     0    1
0  578   82
1  128  512
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8624454, 'precision': 0.86681724, 'recall': 0.8624454, 'specificity': 0.8624454, 'f1': 0.8620343, 'auroc': 0.92858636, 'binary_precision': 0.90686274, 'binary_recall': 0.80786026, 'binary_specificity': 0.9170306, 'binary_f1_score': 0.8545034}
confusion matrix:
     0    1
0  210   19
1   44  185
early stop counter: 5
val acc:0.8384615182876587, best validation acc: 0.8530769348144531, corresponding to test acc:                         0.8689956068992615 / 0.8733624219894409
after epoch: 6,now: 2024-07-26 10:17:54.466140,epoch time: 0:01:26.791254,used: 0:08:49.700858,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_10_09_04_seed_7_23065779
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9814453, 'precision': 0.98143625, 'recall': 0.9814459, 'specificity': 0.9814459, 'f1': 0.981441, 'auroc': 0.9983555, 'binary_precision': 0.98203975, 'binary_recall': 0.98141026, 'binary_specificity': 0.9814815, 'binary_f1_score': 0.981725}
confusion matrix:
      0     1
0  1484    28
1    29  1531
---- Validation: 
scalar performance:
{'acc': 0.82153845, 'precision': 0.834154, 'recall': 0.8200284, 'specificity': 0.8200284, 'f1': 0.8193216, 'auroc': 0.8948816, 'binary_precision': 0.89534885, 'binary_recall': 0.721875, 'binary_specificity': 0.91818184, 'binary_f1_score': 0.79930794}
confusion matrix:
     0    1
0  606   54
1  178  462
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8646288, 'precision': 0.86743146, 'recall': 0.8646288, 'specificity': 0.8646288, 'f1': 0.8643702, 'auroc': 0.9313133, 'binary_precision': 0.8995215, 'binary_recall': 0.8209607, 'binary_specificity': 0.90829694, 'binary_f1_score': 0.8584475}
confusion matrix:
     0    1
0  208   21
1   41  188
early stop counter: 6
val acc:0.8215384483337402, best validation acc: 0.8530769348144531, corresponding to test acc:                         0.8689956068992615 / 0.8733624219894409
after epoch: 7,now: 2024-07-26 10:19:21.413128,epoch time: 0:01:26.946988,used: 0:10:16.647846,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_10_09_04_seed_7_23065779
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9820964, 'precision': 0.98240113, 'recall': 0.98194444, 'specificity': 0.98194444, 'f1': 0.9820851, 'auroc': 0.9991483, 'binary_precision': 0.97356826, 'binary_recall': 0.9916667, 'binary_specificity': 0.9722222, 'binary_f1_score': 0.98253405}
confusion matrix:
      0     1
0  1470    42
1    13  1547
---- Validation: 
scalar performance:
{'acc': 0.8353846, 'precision': 0.8412213, 'recall': 0.8363873, 'specificity': 0.8363873, 'f1': 0.8349329, 'auroc': 0.90587187, 'binary_precision': 0.7925824, 'binary_recall': 0.9015625, 'binary_specificity': 0.7712121, 'binary_f1_score': 0.84356725}
confusion matrix:
     0    1
0  509  151
1   63  577
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.77074236, 'precision': 0.79608774, 'recall': 0.77074236, 'specificity': 0.77074236, 'f1': 0.7657289, 'auroc': 0.91110003, 'binary_precision': 0.7094595, 'binary_recall': 0.9170306, 'binary_specificity': 0.62445414, 'binary_f1_score': 0.79999995}
confusion matrix:
     0    1
0  143   86
1   19  210
early stop counter: 7
val acc:0.8353846073150635, best validation acc: 0.8530769348144531, corresponding to test acc:                         0.8689956068992615 / 0.8733624219894409
after epoch: 8,now: 2024-07-26 10:20:48.298980,epoch time: 0:01:26.885852,used: 0:11:43.533698,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_10_09_04_seed_7_23065779
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9794922, 'precision': 0.97946656, 'recall': 0.97957367, 'specificity': 0.97957367, 'f1': 0.97949004, 'auroc': 0.9983957, 'binary_precision': 0.98509395, 'binary_recall': 0.974359, 'binary_specificity': 0.98478836, 'binary_f1_score': 0.97969705}
confusion matrix:
      0     1
0  1489    23
1    40  1520
---- Validation: 
scalar performance:
{'acc': 0.73307693, 'precision': 0.7726602, 'recall': 0.73008996, 'specificity': 0.73008996, 'f1': 0.72132146, 'auroc': 0.83550835, 'binary_precision': 0.8727735, 'binary_recall': 0.5359375, 'binary_specificity': 0.92424244, 'binary_f1_score': 0.6640852}
confusion matrix:
     0    1
0  610   50
1  297  343
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.84497815, 'precision': 0.8451427, 'recall': 0.8449782, 'specificity': 0.8449782, 'f1': 0.84495974, 'auroc': 0.9200053, 'binary_precision': 0.8526786, 'binary_recall': 0.83406115, 'binary_specificity': 0.8558952, 'binary_f1_score': 0.8432672}
confusion matrix:
     0    1
0  196   33
1   38  191
early stop counter: 8
val acc:0.7330769300460815, best validation acc: 0.8530769348144531, corresponding to test acc:                         0.8689956068992615 / 0.8733624219894409
after epoch: 9,now: 2024-07-26 10:22:15.011430,epoch time: 0:01:26.712450,used: 0:13:10.246148,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_10_09_04_seed_7_23065779
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9827474, 'precision': 0.9832399, 'recall': 0.9825448, 'specificity': 0.9825448, 'f1': 0.9827336, 'auroc': 0.9994484, 'binary_precision': 0.971232, 'binary_recall': 0.99551284, 'binary_specificity': 0.9695767, 'binary_f1_score': 0.98322254}
confusion matrix:
      0     1
0  1466    46
1     7  1553
---- Validation: 
scalar performance:
{'acc': 0.81846154, 'precision': 0.83804005, 'recall': 0.8165957, 'specificity': 0.8165957, 'f1': 0.81514996, 'auroc': 0.89018226, 'binary_precision': 0.91563785, 'binary_recall': 0.6953125, 'binary_specificity': 0.9378788, 'binary_f1_score': 0.7904085}
confusion matrix:
     0    1
0  619   41
1  195  445
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.84934497, 'precision': 0.86911666, 'recall': 0.84934497, 'specificity': 0.84934497, 'f1': 0.8473001, 'auroc': 0.9241433, 'binary_precision': 0.95454544, 'binary_recall': 0.73362446, 'binary_specificity': 0.9650655, 'binary_f1_score': 0.8296296}
confusion matrix:
     0    1
0  221    8
1   61  168
early stop counter: 9
val acc:0.818461537361145, best validation acc: 0.8530769348144531, corresponding to test acc:                         0.8689956068992615 / 0.8733624219894409
after epoch: 10,now: 2024-07-26 10:23:41.788363,epoch time: 0:01:26.776933,used: 0:14:37.023081,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_10_09_04_seed_7_23065779
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.94889325, 'precision': 0.9535239, 'recall': 0.94814306, 'specificity': 0.94814306, 'f1': 0.9486907, 'auroc': 0.99758303, 'binary_precision': 0.911437, 'binary_recall': 0.99615383, 'binary_specificity': 0.9001323, 'binary_f1_score': 0.95191425}
confusion matrix:
      0     1
0  1361   151
1     6  1554
---- Validation: 
scalar performance:
{'acc': 0.77384615, 'precision': 0.7864699, 'recall': 0.77542615, 'specificity': 0.77542615, 'f1': 0.7719674, 'auroc': 0.87118846, 'binary_precision': 0.722365, 'binary_recall': 0.878125, 'binary_specificity': 0.6727273, 'binary_f1_score': 0.7926657}
confusion matrix:
     0    1
0  444  216
1   78  562
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8165939, 'precision': 0.8338058, 'recall': 0.8165939, 'specificity': 0.8165939, 'f1': 0.81419873, 'auroc': 0.9315994, 'binary_precision': 0.7580071, 'binary_recall': 0.930131, 'binary_specificity': 0.70305675, 'binary_f1_score': 0.8352941}
confusion matrix:
     0    1
0  161   68
1   16  213
early stop counter: 10
val acc:0.7738461494445801, best validation acc: 0.8530769348144531, corresponding to test acc:                         0.8689956068992615 / 0.8733624219894409
after epoch: 11,now: 2024-07-26 10:25:09.121851,epoch time: 0:01:27.333488,used: 0:16:04.356569,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_10_09_04_seed_7_23065779
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9866536, 'precision': 0.98662376, 'recall': 0.9866961, 'specificity': 0.9866961, 'f1': 0.9866515, 'auroc': 0.9992878, 'binary_precision': 0.98968405, 'binary_recall': 0.98397434, 'binary_specificity': 0.98941797, 'binary_f1_score': 0.986821}
confusion matrix:
      0     1
0  1496    16
1    25  1535
---- Validation: 
scalar performance:
{'acc': 0.78, 'precision': 0.7837446, 'recall': 0.7790719, 'specificity': 0.7790719, 'f1': 0.7788437, 'auroc': 0.8523656, 'binary_precision': 0.81272084, 'binary_recall': 0.71875, 'binary_specificity': 0.8393939, 'binary_f1_score': 0.76285243}
confusion matrix:
     0    1
0  554  106
1  180  460
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8231441, 'precision': 0.823644, 'recall': 0.8231441, 'specificity': 0.8231441, 'f1': 0.8230758, 'auroc': 0.90240455, 'binary_precision': 0.8363636, 'binary_recall': 0.80349344, 'binary_specificity': 0.8427948, 'binary_f1_score': 0.8195991}
confusion matrix:
     0    1
0  193   36
1   45  184
early stop counter: 11
val acc:0.7799999713897705, best validation acc: 0.8530769348144531, corresponding to test acc:                         0.8689956068992615 / 0.8733624219894409
after epoch: 12,now: 2024-07-26 10:26:36.056379,epoch time: 0:01:26.934528,used: 0:17:31.291097,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_10_09_04_seed_7_23065779
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9873047, 'precision': 0.9873456, 'recall': 0.98726594, 'specificity': 0.98726594, 'f1': 0.98730063, 'auroc': 0.99935603, 'binary_precision': 0.9853223, 'binary_recall': 0.9897436, 'binary_specificity': 0.98478836, 'binary_f1_score': 0.98752797}
confusion matrix:
      0     1
0  1489    23
1    16  1544
---- Validation: 
scalar performance:
{'acc': 0.68, 'precision': 0.78379124, 'recall': 0.6752841, 'specificity': 0.6752841, 'f1': 0.6442704, 'auroc': 0.885206, 'binary_precision': 0.9516129, 'binary_recall': 0.36875, 'binary_specificity': 0.9818182, 'binary_f1_score': 0.5315315}
confusion matrix:
     0    1
0  648   12
1  404  236
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6943231, 'precision': 0.8002062, 'recall': 0.6943231, 'specificity': 0.6943231, 'f1': 0.66476357, 'auroc': 0.936195, 'binary_precision': 0.97849464, 'binary_recall': 0.3973799, 'binary_specificity': 0.99126637, 'binary_f1_score': 0.56521744}
confusion matrix:
     0   1
0  227   2
1  138  91
early stop counter: 12
val acc:0.6800000071525574, best validation acc: 0.8530769348144531, corresponding to test acc:                         0.8689956068992615 / 0.8733624219894409
after epoch: 13,now: 2024-07-26 10:28:03.024735,epoch time: 0:01:26.968356,used: 0:18:58.259453,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_10_09_04_seed_7_23065779
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9811198, 'precision': 0.98149157, 'recall': 0.9814001, 'specificity': 0.9814001, 'f1': 0.98111963, 'auroc': 0.99966466, 'binary_precision': 0.9993351, 'binary_recall': 0.9634615, 'binary_specificity': 0.9993386, 'binary_f1_score': 0.98107046}
confusion matrix:
      0     1
0  1511     1
1    57  1503
---- Validation: 
scalar performance:
{'acc': 0.55538464, 'precision': 0.7380953, 'recall': 0.5485322, 'specificity': 0.5485322, 'f1': 0.4400477, 'auroc': 0.8888885, 'binary_precision': 0.94285715, 'binary_recall': 0.103125, 'binary_specificity': 0.9939394, 'binary_f1_score': 0.18591549}
confusion matrix:
     0   1
0  656   4
1  574  66
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.55676854, 'precision': 0.7650463, 'recall': 0.55676854, 'specificity': 0.55676854, 'f1': 0.44840556, 'auroc': 0.9367671, 'binary_precision': 1.0, 'binary_recall': 0.11353712, 'binary_specificity': 1.0, 'binary_f1_score': 0.20392157}
confusion matrix:
     0   1
0  229   0
1  203  26
early stop counter: 13
val acc:0.555384635925293, best validation acc: 0.8530769348144531, corresponding to test acc:                         0.8689956068992615 / 0.8733624219894409
after epoch: 14,now: 2024-07-26 10:29:30.153295,epoch time: 0:01:27.128560,used: 0:20:25.388013,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_10_09_04_seed_7_23065779
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9847005, 'precision': 0.9846843, 'recall': 0.984712, 'specificity': 0.984712, 'f1': 0.9846972, 'auroc': 0.99880314, 'binary_precision': 0.98587024, 'binary_recall': 0.98397434, 'binary_specificity': 0.98544973, 'binary_f1_score': 0.9849214}
confusion matrix:
      0     1
0  1490    22
1    25  1535
---- Validation: 
scalar performance:
{'acc': 0.8038462, 'precision': 0.80834043, 'recall': 0.8028883, 'specificity': 0.8028883, 'f1': 0.80274796, 'auroc': 0.8699621, 'binary_precision': 0.8419183, 'binary_recall': 0.740625, 'binary_specificity': 0.8651515, 'binary_f1_score': 0.7880299}
confusion matrix:
     0    1
0  571   89
1  166  474
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7882096, 'precision': 0.78865546, 'recall': 0.7882096, 'specificity': 0.7882096, 'f1': 0.7881278, 'auroc': 0.87509775, 'binary_precision': 0.8, 'binary_recall': 0.768559, 'binary_specificity': 0.80786026, 'binary_f1_score': 0.7839644}
confusion matrix:
     0    1
0  185   44
1   53  176
early stop counter: 14
val acc:0.8038461804389954, best validation acc: 0.8530769348144531, corresponding to test acc:                         0.8689956068992615 / 0.8733624219894409
after epoch: 15,now: 2024-07-26 10:30:57.121822,epoch time: 0:01:26.968527,used: 0:21:52.356540,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_10_09_04_seed_7_23065779
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.98828125, 'precision': 0.9883721, 'recall': 0.9884615, 'specificity': 0.9884615, 'f1': 0.9882811, 'auroc': 0.9998033, 'binary_precision': 1.0, 'binary_recall': 0.97692305, 'binary_specificity': 1.0, 'binary_f1_score': 0.98832685}
confusion matrix:
      0     1
0  1512     0
1    36  1524
---- Validation: 
scalar performance:
{'acc': 0.7592308, 'precision': 0.8098903, 'recall': 0.75608426, 'specificity': 0.75608426, 'f1': 0.7474301, 'auroc': 0.8853036, 'binary_precision': 0.9313984, 'binary_recall': 0.5515625, 'binary_specificity': 0.96060604, 'binary_f1_score': 0.69283605}
confusion matrix:
     0    1
0  634   26
1  287  353
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.75545853, 'precision': 0.81565, 'recall': 0.7554585, 'specificity': 0.7554585, 'f1': 0.743217, 'auroc': 0.9165729, 'binary_precision': 0.95348835, 'binary_recall': 0.5371179, 'binary_specificity': 0.9737991, 'binary_f1_score': 0.68715084}
confusion matrix:
     0    1
0  223    6
1  106  123
early stop counter: 15
val acc:0.7592307925224304, best validation acc: 0.8530769348144531, corresponding to test acc:                         0.8689956068992615 / 0.8733624219894409
after epoch: 16,now: 2024-07-26 10:32:23.940209,epoch time: 0:01:26.818387,used: 0:23:19.174927,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_10_09_04_seed_7_23065779
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9947917, 'precision': 0.9947616, 'recall': 0.9948413, 'specificity': 0.9948413, 'f1': 0.99479085, 'auroc': 0.9998071, 'binary_precision': 0.9980645, 'binary_recall': 0.9916667, 'binary_specificity': 0.9980159, 'binary_f1_score': 0.99485534}
confusion matrix:
      0     1
0  1509     3
1    13  1547
---- Validation: 
scalar performance:
{'acc': 0.8130769, 'precision': 0.83202755, 'recall': 0.8112216, 'specificity': 0.8112216, 'f1': 0.8097069, 'auroc': 0.8871118, 'binary_precision': 0.90759754, 'binary_recall': 0.690625, 'binary_specificity': 0.9318182, 'binary_f1_score': 0.7843833}
confusion matrix:
     0    1
0  615   45
1  198  442
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.79694325, 'precision': 0.8165555, 'recall': 0.79694325, 'specificity': 0.79694325, 'f1': 0.7937486, 'auroc': 0.90295756, 'binary_precision': 0.89534885, 'binary_recall': 0.6724891, 'binary_specificity': 0.9213974, 'binary_f1_score': 0.7680798}
confusion matrix:
     0    1
0  211   18
1   75  154
early stop counter: 16
val acc:0.813076913356781, best validation acc: 0.8530769348144531, corresponding to test acc:                         0.8689956068992615 / 0.8733624219894409
after epoch: 17,now: 2024-07-26 10:33:50.954785,epoch time: 0:01:27.014576,used: 0:24:46.189503,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_10_09_04_seed_7_23065779
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.98307294, 'precision': 0.9837215, 'recall': 0.98283476, 'specificity': 0.98283476, 'f1': 0.983057, 'auroc': 0.9997232, 'binary_precision': 0.9694894, 'binary_recall': 0.9980769, 'binary_specificity': 0.9675926, 'binary_f1_score': 0.98357546}
confusion matrix:
      0     1
0  1463    49
1     3  1557
---- Validation: 
scalar performance:
{'acc': 0.83692306, 'precision': 0.84215295, 'recall': 0.83596116, 'specificity': 0.83596116, 'f1': 0.8359911, 'auroc': 0.8963754, 'binary_precision': 0.8807829, 'binary_recall': 0.7734375, 'binary_specificity': 0.8984848, 'binary_f1_score': 0.82362735}
confusion matrix:
     0    1
0  593   67
1  145  495
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8646288, 'precision': 0.8786061, 'recall': 0.8646288, 'specificity': 0.8646288, 'f1': 0.8633678, 'auroc': 0.9384451, 'binary_precision': 0.95135134, 'binary_recall': 0.768559, 'binary_specificity': 0.96069866, 'binary_f1_score': 0.85024154}
confusion matrix:
     0    1
0  220    9
1   53  176
early stop counter: 17
val acc:0.8369230628013611, best validation acc: 0.8530769348144531, corresponding to test acc:                         0.8689956068992615 / 0.8733624219894409
after epoch: 18,now: 2024-07-26 10:35:17.826063,epoch time: 0:01:26.871278,used: 0:26:13.060781,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_10_09_04_seed_7_23065779
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9814453, 'precision': 0.9821143, 'recall': 0.98120165, 'specificity': 0.98120165, 'f1': 0.98142755, 'auroc': 0.9994947, 'binary_precision': 0.9676416, 'binary_recall': 0.9967949, 'binary_specificity': 0.9656085, 'binary_f1_score': 0.9820019}
confusion matrix:
      0     1
0  1460    52
1     5  1555
---- Validation: 
scalar performance:
{'acc': 0.8546154, 'precision': 0.8600358, 'recall': 0.8536695, 'specificity': 0.8536695, 'f1': 0.8538015, 'auroc': 0.9114554, 'binary_precision': 0.90053284, 'binary_recall': 0.7921875, 'binary_specificity': 0.91515154, 'binary_f1_score': 0.84289277}
confusion matrix:
     0    1
0  604   56
1  133  507
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.87554586, 'precision': 0.89063, 'recall': 0.87554586, 'specificity': 0.87554586, 'f1': 0.87433267, 'auroc': 0.9412101, 'binary_precision': 0.9673913, 'binary_recall': 0.77729255, 'binary_specificity': 0.9737991, 'binary_f1_score': 0.86198545}
confusion matrix:
     0    1
0  223    6
1   51  178
new oracle model saved
better model found
persisted
after epoch: 19,now: 2024-07-26 10:36:45.092685,epoch time: 0:01:27.266622,used: 0:27:40.327403,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_10_09_04_seed_7_23065779
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.97753906, 'precision': 0.9780228, 'recall': 0.9773352, 'specificity': 0.9773352, 'f1': 0.97752106, 'auroc': 0.9984335, 'binary_precision': 0.9662289, 'binary_recall': 0.99038464, 'binary_specificity': 0.96428573, 'binary_f1_score': 0.97815764}
confusion matrix:
      0     1
0  1458    54
1    15  1545
---- Validation: 
scalar performance:
{'acc': 0.6830769, 'precision': 0.70474106, 'recall': 0.6804688, 'specificity': 0.6804688, 'f1': 0.6724648, 'auroc': 0.789652, 'binary_precision': 0.76760566, 'binary_recall': 0.5109375, 'binary_specificity': 0.85, 'binary_f1_score': 0.61350846}
confusion matrix:
     0    1
0  561   99
1  313  327
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6419214, 'precision': 0.6496371, 'recall': 0.6419214, 'specificity': 0.6419214, 'f1': 0.6372452, 'auroc': 0.7272935, 'binary_precision': 0.6836158, 'binary_recall': 0.52838427, 'binary_specificity': 0.75545853, 'binary_f1_score': 0.5960591}
confusion matrix:
     0    1
0  173   56
1  108  121
early stop counter: 1
val acc:0.6830769181251526, best validation acc: 0.8546153903007507, corresponding to test acc:                         0.875545859336853 / 0.875545859336853
after epoch: 20,now: 2024-07-26 10:38:12.079774,epoch time: 0:01:26.987089,used: 0:29:07.314492,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_10_09_04_seed_7_23065779
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9765625, 'precision': 0.97727275, 'recall': 0.9769231, 'specificity': 0.9769231, 'f1': 0.97656107, 'auroc': 0.9991648, 'binary_precision': 1.0, 'binary_recall': 0.95384616, 'binary_specificity': 1.0, 'binary_f1_score': 0.9763779}
confusion matrix:
      0     1
0  1512     0
1    72  1488
---- Validation: 
scalar performance:
{'acc': 0.6746154, 'precision': 0.7793059, 'recall': 0.669839, 'specificity': 0.669839, 'f1': 0.6372957, 'auroc': 0.89827645, 'binary_precision': 0.94650203, 'binary_recall': 0.359375, 'binary_specificity': 0.98030305, 'binary_f1_score': 0.52095133}
confusion matrix:
     0    1
0  647   13
1  410  230
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5458515, 'precision': 0.74032986, 'recall': 0.5458515, 'specificity': 0.5458515, 'f1': 0.43067506, 'auroc': 0.921569, 'binary_precision': 0.95652175, 'binary_recall': 0.09606987, 'binary_specificity': 0.9956332, 'binary_f1_score': 0.17460318}
confusion matrix:
     0   1
0  228   1
1  207  22
early stop counter: 2
val acc:0.6746153831481934, best validation acc: 0.8546153903007507, corresponding to test acc:                         0.875545859336853 / 0.875545859336853
after epoch: 21,now: 2024-07-26 10:39:38.895877,epoch time: 0:01:26.816103,used: 0:30:34.130595,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_10_09_04_seed_7_23065779
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9860026, 'precision': 0.9861736, 'recall': 0.986218, 'specificity': 0.986218, 'f1': 0.98600256, 'auroc': 0.9996803, 'binary_precision': 1.0, 'binary_recall': 0.9724359, 'binary_specificity': 1.0, 'binary_f1_score': 0.98602533}
confusion matrix:
      0     1
0  1512     0
1    43  1517
---- Validation: 
scalar performance:
{'acc': 0.63769233, 'precision': 0.75942683, 'recall': 0.632339, 'specificity': 0.632339, 'f1': 0.5845363, 'auroc': 0.8944058, 'binary_precision': 0.93333334, 'binary_recall': 0.284375, 'binary_specificity': 0.98030305, 'binary_f1_score': 0.43592817}
confusion matrix:
     0    1
0  647   13
1  458  182
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.73580784, 'precision': 0.80822533, 'recall': 0.73580784, 'specificity': 0.73580784, 'f1': 0.71932155, 'auroc': 0.9200959, 'binary_precision': 0.9576271, 'binary_recall': 0.49344978, 'binary_specificity': 0.9781659, 'binary_f1_score': 0.65129685}
confusion matrix:
     0    1
0  224    5
1  116  113
early stop counter: 3
val acc:0.6376923322677612, best validation acc: 0.8546153903007507, corresponding to test acc:                         0.875545859336853 / 0.875545859336853
after epoch: 22,now: 2024-07-26 10:41:05.574051,epoch time: 0:01:26.678174,used: 0:32:00.808769,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_10_09_04_seed_7_23065779
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.99283856, 'precision': 0.9928083, 'recall': 0.9928877, 'specificity': 0.9928877, 'f1': 0.9928374, 'auroc': 0.999495, 'binary_precision': 0.99612904, 'binary_recall': 0.9897436, 'binary_specificity': 0.99603176, 'binary_f1_score': 0.99292606}
confusion matrix:
      0     1
0  1506     6
1    16  1544
---- Validation: 
scalar performance:
{'acc': 0.75461537, 'precision': 0.8130872, 'recall': 0.75125474, 'specificity': 0.75125474, 'f1': 0.74090946, 'auroc': 0.8955498, 'binary_precision': 0.9445983, 'binary_recall': 0.5328125, 'binary_specificity': 0.969697, 'binary_f1_score': 0.68131864}
confusion matrix:
     0    1
0  640   20
1  299  341
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.75982535, 'precision': 0.82733935, 'recall': 0.75982535, 'specificity': 0.75982535, 'f1': 0.746768, 'auroc': 0.9258214, 'binary_precision': 0.976, 'binary_recall': 0.5327511, 'binary_specificity': 0.98689955, 'binary_f1_score': 0.6892655}
confusion matrix:
     0    1
0  226    3
1  107  122
early stop counter: 4
val acc:0.7546153664588928, best validation acc: 0.8546153903007507, corresponding to test acc:                         0.875545859336853 / 0.875545859336853
after epoch: 23,now: 2024-07-26 10:42:32.741949,epoch time: 0:01:27.167898,used: 0:33:27.976667,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_10_09_04_seed_7_23065779
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.991862, 'precision': 0.9918651, 'recall': 0.9918549, 'specificity': 0.9918549, 'f1': 0.9918599, 'auroc': 0.9997494, 'binary_precision': 0.991672, 'binary_recall': 0.99230766, 'binary_specificity': 0.9914021, 'binary_f1_score': 0.99198973}
confusion matrix:
      0     1
0  1499    13
1    12  1548
---- Validation: 
scalar performance:
{'acc': 0.76384616, 'precision': 0.8100003, 'recall': 0.7608428, 'specificity': 0.7608428, 'f1': 0.7532824, 'auroc': 0.8927474, 'binary_precision': 0.9258312, 'binary_recall': 0.565625, 'binary_specificity': 0.9560606, 'binary_f1_score': 0.7022309}
confusion matrix:
     0    1
0  631   29
1  278  362
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6877729, 'precision': 0.77910995, 'recall': 0.6877729, 'specificity': 0.6877729, 'f1': 0.65995336, 'auroc': 0.9028241, 'binary_precision': 0.93877554, 'binary_recall': 0.40174672, 'binary_specificity': 0.9737991, 'binary_f1_score': 0.56269115}
confusion matrix:
     0   1
0  223   6
1  137  92
early stop counter: 5
val acc:0.7638461589813232, best validation acc: 0.8546153903007507, corresponding to test acc:                         0.875545859336853 / 0.875545859336853
after epoch: 24,now: 2024-07-26 10:43:59.612866,epoch time: 0:01:26.870917,used: 0:34:54.847584,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_10_09_04_seed_7_23065779
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.9938151, 'precision': 0.9937845, 'recall': 0.99387974, 'specificity': 0.99387974, 'f1': 0.9938143, 'auroc': 0.9998593, 'binary_precision': 0.99806076, 'binary_recall': 0.9897436, 'binary_specificity': 0.9980159, 'binary_f1_score': 0.99388474}
confusion matrix:
      0     1
0  1509     3
1    16  1544
---- Validation: 
scalar performance:
{'acc': 0.76076925, 'precision': 0.81365764, 'recall': 0.75757575, 'specificity': 0.75757575, 'f1': 0.7486907, 'auroc': 0.90841615, 'binary_precision': 0.93866664, 'binary_recall': 0.55, 'binary_specificity': 0.9651515, 'binary_f1_score': 0.693596}
confusion matrix:
     0    1
0  637   23
1  288  352
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.77292573, 'precision': 0.8372328, 'recall': 0.77292573, 'specificity': 0.77292573, 'f1': 0.76155865, 'auroc': 0.9381019, 'binary_precision': 0.9844961, 'binary_recall': 0.55458516, 'binary_specificity': 0.99126637, 'binary_f1_score': 0.7094972}
confusion matrix:
     0    1
0  227    2
1  102  127
early stop counter: 6
val acc:0.760769248008728, best validation acc: 0.8546153903007507, corresponding to test acc:                         0.875545859336853 / 0.875545859336853
after epoch: 25,now: 2024-07-26 10:45:26.688372,epoch time: 0:01:27.075506,used: 0:36:21.923090,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_10_09_04_seed_7_23065779
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9811198, 'precision': 0.9811735, 'recall': 0.98127794, 'specificity': 0.98127794, 'f1': 0.9811193, 'auroc': 0.9988481, 'binary_precision': 0.99149215, 'binary_recall': 0.97115386, 'binary_specificity': 0.9914021, 'binary_f1_score': 0.9812176}
confusion matrix:
      0     1
0  1499    13
1    45  1515
---- Validation: 
scalar performance:
{'acc': 0.72923076, 'precision': 0.80233455, 'recall': 0.7254025, 'specificity': 0.7254025, 'f1': 0.70959973, 'auroc': 0.90035987, 'binary_precision': 0.94720495, 'binary_recall': 0.4765625, 'binary_specificity': 0.97424245, 'binary_f1_score': 0.63409567}
confusion matrix:
     0    1
0  643   17
1  335  305
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7620087, 'precision': 0.82845664, 'recall': 0.7620087, 'specificity': 0.7620087, 'f1': 0.74933094, 'auroc': 0.9421445, 'binary_precision': 0.97619045, 'binary_recall': 0.5371179, 'binary_specificity': 0.98689955, 'binary_f1_score': 0.69295776}
confusion matrix:
     0    1
0  226    3
1  106  123
early stop counter: 7
val acc:0.7292307615280151, best validation acc: 0.8546153903007507, corresponding to test acc:                         0.875545859336853 / 0.875545859336853
after epoch: 26,now: 2024-07-26 10:46:53.241885,epoch time: 0:01:26.553513,used: 0:37:48.476603,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_10_09_04_seed_7_23065779
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.98795575, 'precision': 0.98800147, 'recall': 0.98811054, 'specificity': 0.98811054, 'f1': 0.9879554, 'auroc': 0.9997435, 'binary_precision': 0.99803793, 'binary_recall': 0.97820514, 'binary_specificity': 0.9980159, 'binary_f1_score': 0.988022}
confusion matrix:
      0     1
0  1509     3
1    34  1526
---- Validation: 
scalar performance:
{'acc': 0.5946154, 'precision': 0.75792456, 'recall': 0.58839965, 'specificity': 0.58839965, 'f1': 0.51121235, 'auroc': 0.9090483, 'binary_precision': 0.9593496, 'binary_recall': 0.184375, 'binary_specificity': 0.99242425, 'binary_f1_score': 0.30930537}
confusion matrix:
     0    1
0  655    5
1  522  118
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.52401745, 'precision': 0.75615215, 'recall': 0.52401745, 'specificity': 0.52401745, 'f1': 0.38459074, 'auroc': 0.94815123, 'binary_precision': 1.0, 'binary_recall': 0.048034936, 'binary_specificity': 1.0, 'binary_f1_score': 0.09166667}
confusion matrix:
     0   1
0  229   0
1  218  11
early stop counter: 8
val acc:0.5946153998374939, best validation acc: 0.8546153903007507, corresponding to test acc:                         0.875545859336853 / 0.875545859336853
after epoch: 27,now: 2024-07-26 10:48:20.147985,epoch time: 0:01:26.906100,used: 0:39:15.382703,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_10_09_04_seed_7_23065779
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.9876302, 'precision': 0.98786247, 'recall': 0.9875051, 'specificity': 0.9875051, 'f1': 0.98762345, 'auroc': 0.99963033, 'binary_precision': 0.9804293, 'binary_recall': 0.99551284, 'binary_specificity': 0.9794974, 'binary_f1_score': 0.9879135}
confusion matrix:
      0     1
0  1481    31
1     7  1553
---- Validation: 
scalar performance:
{'acc': 0.8030769, 'precision': 0.8103671, 'recall': 0.8018702, 'specificity': 0.8018702, 'f1': 0.80144095, 'auroc': 0.8694105, 'binary_precision': 0.8542435, 'binary_recall': 0.7234375, 'binary_specificity': 0.880303, 'binary_f1_score': 0.78341794}
confusion matrix:
     0    1
0  581   79
1  177  463
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.87117904, 'precision': 0.88474464, 'recall': 0.871179, 'specificity': 0.871179, 'f1': 0.8700334, 'auroc': 0.93995154, 'binary_precision': 0.9569892, 'binary_recall': 0.77729255, 'binary_specificity': 0.9650655, 'binary_f1_score': 0.8578313}
confusion matrix:
     0    1
0  221    8
1   51  178
early stop counter: 9
val acc:0.8030769228935242, best validation acc: 0.8546153903007507, corresponding to test acc:                         0.875545859336853 / 0.875545859336853
after epoch: 28,now: 2024-07-26 10:49:47.107940,epoch time: 0:01:26.959955,used: 0:40:42.342658,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_10_09_04_seed_7_23065779
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9921875, 'precision': 0.9922086, 'recall': 0.9921652, 'specificity': 0.9921652, 'f1': 0.99218524, 'auroc': 0.99976724, 'binary_precision': 0.9910486, 'binary_recall': 0.99358976, 'binary_specificity': 0.9907407, 'binary_f1_score': 0.99231756}
confusion matrix:
      0     1
0  1498    14
1    10  1550
---- Validation: 
scalar performance:
{'acc': 0.7969231, 'precision': 0.8247099, 'recall': 0.7946496, 'specificity': 0.7946496, 'f1': 0.7915878, 'auroc': 0.90291965, 'binary_precision': 0.9159292, 'binary_recall': 0.646875, 'binary_specificity': 0.94242424, 'binary_f1_score': 0.75824183}
confusion matrix:
     0    1
0  622   38
1  226  414
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8165939, 'precision': 0.845274, 'recall': 0.8165939, 'specificity': 0.8165939, 'f1': 0.81270444, 'auroc': 0.9248107, 'binary_precision': 0.9447853, 'binary_recall': 0.6724891, 'binary_specificity': 0.96069866, 'binary_f1_score': 0.78571427}
confusion matrix:
     0    1
0  220    9
1   75  154
early stop counter: 10
val acc:0.7969231009483337, best validation acc: 0.8546153903007507, corresponding to test acc:                         0.875545859336853 / 0.875545859336853
after epoch: 29,now: 2024-07-26 10:51:14.334766,epoch time: 0:01:27.226826,used: 0:42:09.569484,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_10_09_04_seed_7_23065779
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.9954427, 'precision': 0.9954416, 'recall': 0.9954416, 'specificity': 0.9954416, 'f1': 0.9954416, 'auroc': 0.9999207, 'binary_precision': 0.99551284, 'binary_recall': 0.99551284, 'binary_specificity': 0.9953704, 'binary_f1_score': 0.99551284}
confusion matrix:
      0     1
0  1505     7
1     7  1553
---- Validation: 
scalar performance:
{'acc': 0.73846155, 'precision': 0.8039216, 'recall': 0.7348485, 'specificity': 0.7348485, 'f1': 0.72159237, 'auroc': 0.9153942, 'binary_precision': 0.9411765, 'binary_recall': 0.5, 'binary_specificity': 0.969697, 'binary_f1_score': 0.6530613}
confusion matrix:
     0    1
0  640   20
1  320  320
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8100437, 'precision': 0.85192645, 'recall': 0.8100437, 'specificity': 0.8100437, 'f1': 0.80421865, 'auroc': 0.9452909, 'binary_precision': 0.97333336, 'binary_recall': 0.6375546, 'binary_specificity': 0.98253274, 'binary_f1_score': 0.7704485}
confusion matrix:
     0    1
0  225    4
1   83  146
early stop counter: 11
val acc:0.7384615540504456, best validation acc: 0.8546153903007507, corresponding to test acc:                         0.875545859336853 / 0.875545859336853
after epoch: 30,now: 2024-07-26 10:52:41.444753,epoch time: 0:01:27.109987,used: 0:43:36.679471,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_10_09_04_seed_7_23065779
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 0:43:36.679471 at 2024-07-26 10:52:41.444753
persisted model performance metric: 

scalar performance:
{'acc': 0.87554586, 'precision': 0.89063, 'recall': 0.87554586, 'specificity': 0.87554586, 'f1': 0.87433267, 'auroc': 0.9412101, 'binary_precision': 0.9673913, 'binary_recall': 0.77729255, 'binary_specificity': 0.9737991, 'binary_f1_score': 0.86198545}
confusion matrix:
     0    1
0  223    6
1   51  178
oracle model performance metric: 

scalar performance:
{'acc': 0.87554586, 'precision': 0.89063, 'recall': 0.87554586, 'specificity': 0.87554586, 'f1': 0.87433267, 'auroc': 0.9412101, 'binary_precision': 0.9673913, 'binary_recall': 0.77729255, 'binary_specificity': 0.9737991, 'binary_f1_score': 0.86198545}
confusion matrix:
     0    1
0  223    6
1   51  178
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_irm_10seeds_nofreeze_2024-07-26_02-28-54/rule_results/0.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_irm_10seeds_nofreeze_2024-07-26_02-28-54/confusion_matrix/0.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 455402 KiB |  13219 MiB | 584737 GiB | 584736 GiB |
|       from large pool | 414803 KiB |  13181 MiB | 577778 GiB | 577778 GiB |
|       from small pool |  40598 KiB |     60 MiB |   6958 GiB |   6958 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 455402 KiB |  13219 MiB | 584737 GiB | 584736 GiB |
|       from large pool | 414803 KiB |  13181 MiB | 577778 GiB | 577778 GiB |
|       from small pool |  40598 KiB |     60 MiB |   6958 GiB |   6958 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 447482 KiB |  13213 MiB | 583859 GiB | 583858 GiB |
|       from large pool | 407075 KiB |  13175 MiB | 576915 GiB | 576914 GiB |
|       from small pool |  40407 KiB |     60 MiB |   6944 GiB |   6944 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  14478 MiB |  14482 MiB | 109634 MiB |  95156 MiB |
|       from large pool |  14412 MiB |  14412 MiB | 109452 MiB |  95040 MiB |
|       from small pool |     66 MiB |     70 MiB |    182 MiB |    116 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 447766 KiB |   1236 MiB | 409188 GiB | 409187 GiB |
|       from large pool | 435116 KiB |   1229 MiB | 402186 GiB | 402186 GiB |
|       from small pool |  12649 KiB |     47 MiB |   7001 GiB |   7001 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    1310    |    2598    |  103443 K  |  103442 K  |
|       from large pool |     187    |    1413    |   52595 K  |   52594 K  |
|       from small pool |    1123    |    1419    |   50848 K  |   50847 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    1310    |    2598    |  103443 K  |  103442 K  |
|       from large pool |     187    |    1413    |   52595 K  |   52594 K  |
|       from small pool |    1123    |    1419    |   50848 K  |   50847 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     635    |     637    |    4646    |    4011    |
|       from large pool |     602    |     602    |    4555    |    3953    |
|       from small pool |      33    |      35    |      91    |      58    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      97    |     654    |   70086 K  |   70086 K  |
|       from large pool |      38    |     605    |   40374 K  |   40374 K  |
|       from small pool |      59    |     236    |   29712 K  |   29712 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13219 MiB | 584737 GiB | 584737 GiB |
|       from large pool |  16640 KiB |  13181 MiB | 577778 GiB | 577778 GiB |
|       from small pool |      0 KiB |     60 MiB |   6958 GiB |   6958 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13219 MiB | 584737 GiB | 584737 GiB |
|       from large pool |  16640 KiB |  13181 MiB | 577778 GiB | 577778 GiB |
|       from small pool |      0 KiB |     60 MiB |   6958 GiB |   6958 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13213 MiB | 583859 GiB | 583859 GiB |
|       from large pool |  16640 KiB |  13175 MiB | 576915 GiB | 576915 GiB |
|       from small pool |      0 KiB |     60 MiB |   6944 GiB |   6944 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    882 MiB |  14482 MiB | 109634 MiB | 108752 MiB |
|       from large pool |    830 MiB |  14412 MiB | 109452 MiB | 108622 MiB |
|       from small pool |     52 MiB |     70 MiB |    182 MiB |    130 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1236 MiB | 409188 GiB | 409188 GiB |
|       from large pool |  24320 KiB |   1229 MiB | 402186 GiB | 402186 GiB |
|       from small pool |      0 KiB |     47 MiB |   7001 GiB |   7001 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    2598    |  103443 K  |  103443 K  |
|       from large pool |       2    |    1413    |   52595 K  |   52595 K  |
|       from small pool |       0    |    1419    |   50848 K  |   50848 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    2598    |  103443 K  |  103443 K  |
|       from large pool |       2    |    1413    |   52595 K  |   52595 K  |
|       from small pool |       0    |    1419    |   50848 K  |   50848 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      63    |     637    |    4646    |    4583    |
|       from large pool |      37    |     602    |    4555    |    4518    |
|       from small pool |      26    |      35    |      91    |      65    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |     654    |   70086 K  |   70086 K  |
|       from large pool |       4    |     605    |   40374 K  |   40374 K  |
|       from small pool |       0    |     236    |   29712 K  |   29712 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13219 MiB | 584737 GiB | 584737 GiB |
|       from large pool |  16640 KiB |  13181 MiB | 577778 GiB | 577778 GiB |
|       from small pool |      0 KiB |     60 MiB |   6958 GiB |   6958 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13219 MiB | 584737 GiB | 584737 GiB |
|       from large pool |  16640 KiB |  13181 MiB | 577778 GiB | 577778 GiB |
|       from small pool |      0 KiB |     60 MiB |   6958 GiB |   6958 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13213 MiB | 583859 GiB | 583859 GiB |
|       from large pool |  16640 KiB |  13175 MiB | 576915 GiB | 576915 GiB |
|       from small pool |      0 KiB |     60 MiB |   6944 GiB |   6944 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    882 MiB |  14482 MiB | 109634 MiB | 108752 MiB |
|       from large pool |    830 MiB |  14412 MiB | 109452 MiB | 108622 MiB |
|       from small pool |     52 MiB |     70 MiB |    182 MiB |    130 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1236 MiB | 409188 GiB | 409188 GiB |
|       from large pool |  24320 KiB |   1229 MiB | 402186 GiB | 402186 GiB |
|       from small pool |      0 KiB |     47 MiB |   7001 GiB |   7001 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    2598    |  103443 K  |  103443 K  |
|       from large pool |       2    |    1413    |   52595 K  |   52595 K  |
|       from small pool |       0    |    1419    |   50848 K  |   50848 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    2598    |  103443 K  |  103443 K  |
|       from large pool |       2    |    1413    |   52595 K  |   52595 K  |
|       from small pool |       0    |    1419    |   50848 K  |   50848 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      63    |     637    |    4646    |    4583    |
|       from large pool |      37    |     602    |    4555    |    4518    |
|       from small pool |      26    |      35    |      91    |      65    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |     654    |   70086 K  |   70086 K  |
|       from large pool |       4    |     605    |   40374 K  |   40374 K  |
|       from small pool |       0    |     236    |   29712 K  |   29712 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'888c1ef2'
model name: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_10_53_11_seed_8_23065779

 Experiment start at: 2024-07-26 10:53:11.754415
before training, model accuracy: 0.4931192398071289
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9335526, 'precision': 0.93604165, 'recall': 0.93314695, 'specificity': 0.93314695, 'f1': 0.93340737, 'auroc': 0.9892274, 'binary_precision': 0.90577507, 'binary_recall': 0.96942097, 'binary_specificity': 0.89687294, 'binary_f1_score': 0.93651795}
confusion matrix:
      0     1
0  1348   155
1    47  1490
---- Validation: 
scalar performance:
{'acc': 0.804331, 'precision': 0.8315741, 'recall': 0.8088228, 'specificity': 0.8088228, 'f1': 0.80166173, 'auroc': 0.92909694, 'binary_precision': 0.72827417, 'binary_recall': 0.9504792, 'binary_specificity': 0.6671664, 'binary_f1_score': 0.82467085}
confusion matrix:
     0    1
0  445  222
1   31  595
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.79357797, 'precision': 0.8098792, 'recall': 0.793578, 'specificity': 0.793578, 'f1': 0.79082716, 'auroc': 0.9123601, 'binary_precision': 0.73880595, 'binary_recall': 0.9082569, 'binary_specificity': 0.6788991, 'binary_f1_score': 0.8148148}
confusion matrix:
     0    1
0  148   70
1   20  198
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-26 10:54:41.752975,epoch time: 0:01:29.998560,used: 0:01:29.998560,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_10_53_11_seed_8_23065779
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9680921, 'precision': 0.96833605, 'recall': 0.9682722, 'specificity': 0.9682722, 'f1': 0.96809196, 'auroc': 0.99645853, 'binary_precision': 0.98259705, 'binary_recall': 0.9538661, 'binary_specificity': 0.98267823, 'binary_f1_score': 0.9680185}
confusion matrix:
      0     1
0  1475    26
1    71  1468
---- Validation: 
scalar performance:
{'acc': 0.808198, 'precision': 0.82424617, 'recall': 0.8045682, 'specificity': 0.8045682, 'f1': 0.8043643, 'auroc': 0.9018793, 'binary_precision': 0.8888889, 'binary_recall': 0.69009584, 'binary_specificity': 0.9190405, 'binary_f1_score': 0.7769784}
confusion matrix:
     0    1
0  613   54
1  194  432
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.83715594, 'precision': 0.8460766, 'recall': 0.83715594, 'specificity': 0.83715594, 'f1': 0.83609974, 'auroc': 0.9138751, 'binary_precision': 0.90163934, 'binary_recall': 0.75688076, 'binary_specificity': 0.9174312, 'binary_f1_score': 0.8229427}
confusion matrix:
     0    1
0  200   18
1   53  165
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-07-26 10:56:08.497000,epoch time: 0:01:26.744025,used: 0:02:56.742585,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_10_53_11_seed_8_23065779
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9773026, 'precision': 0.9774213, 'recall': 0.97744304, 'specificity': 0.97744304, 'f1': 0.9773026, 'auroc': 0.99785197, 'binary_precision': 0.9886968, 'binary_recall': 0.96621186, 'binary_specificity': 0.9886742, 'binary_f1_score': 0.977325}
confusion matrix:
      0     1
0  1484    17
1    52  1487
---- Validation: 
scalar performance:
{'acc': 0.8692962, 'precision': 0.8729867, 'recall': 0.8677163, 'specificity': 0.8677163, 'f1': 0.86850965, 'auroc': 0.9310417, 'binary_precision': 0.9029982, 'binary_recall': 0.81789136, 'binary_specificity': 0.9175412, 'binary_f1_score': 0.85834026}
confusion matrix:
     0    1
0  612   55
1  114  512
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.86926603, 'precision': 0.8768872, 'recall': 0.86926603, 'specificity': 0.86926603, 'f1': 0.8686018, 'auroc': 0.926353, 'binary_precision': 0.93048126, 'binary_recall': 0.79816514, 'binary_specificity': 0.940367, 'binary_f1_score': 0.85925925}
confusion matrix:
     0    1
0  205   13
1   44  174
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-07-26 10:57:35.433292,epoch time: 0:01:26.936292,used: 0:04:23.678877,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_10_53_11_seed_8_23065779
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.94375, 'precision': 0.94836617, 'recall': 0.9432021, 'specificity': 0.9432021, 'f1': 0.94354993, 'auroc': 0.9967772, 'binary_precision': 0.90558195, 'binary_recall': 0.99219257, 'binary_specificity': 0.8942116, 'binary_f1_score': 0.946911}
confusion matrix:
      0     1
0  1344   159
1    12  1525
---- Validation: 
scalar performance:
{'acc': 0.71616393, 'precision': 0.76157904, 'recall': 0.7225309, 'specificity': 0.7225309, 'f1': 0.7068895, 'auroc': 0.8787427, 'binary_precision': 0.64437014, 'binary_recall': 0.9233227, 'binary_specificity': 0.5217391, 'binary_f1_score': 0.7590283}
confusion matrix:
     0    1
0  348  319
1   48  578
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.67201835, 'precision': 0.7740071, 'recall': 0.67201835, 'specificity': 0.67201835, 'f1': 0.6383673, 'auroc': 0.9222077, 'binary_precision': 0.60683763, 'binary_recall': 0.9770642, 'binary_specificity': 0.36697248, 'binary_f1_score': 0.74868184}
confusion matrix:
    0    1
0  80  138
1   5  213
early stop counter: 1
val acc:0.7161639332771301, best validation acc: 0.8692961931228638, corresponding to test acc:                         0.8692660331726074 / 0.8692660331726074
after epoch: 4,now: 2024-07-26 10:59:01.860651,epoch time: 0:01:26.427359,used: 0:05:50.106236,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_10_53_11_seed_8_23065779
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.98157895, 'precision': 0.9815867, 'recall': 0.98163927, 'specificity': 0.98163927, 'f1': 0.9815785, 'auroc': 0.9988187, 'binary_precision': 0.9874835, 'binary_recall': 0.97591144, 'binary_specificity': 0.98736703, 'binary_f1_score': 0.98166335}
confusion matrix:
      0     1
0  1485    19
1    37  1499
---- Validation: 
scalar performance:
{'acc': 0.6550657, 'precision': 0.70303655, 'recall': 0.64686304, 'specificity': 0.64686304, 'f1': 0.6259049, 'auroc': 0.8228346, 'binary_precision': 0.7941176, 'binary_recall': 0.3881789, 'binary_specificity': 0.9055472, 'binary_f1_score': 0.5214592}
confusion matrix:
     0    1
0  604   63
1  383  243
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7798165, 'precision': 0.798108, 'recall': 0.7798165, 'specificity': 0.7798165, 'f1': 0.7763864, 'auroc': 0.88189125, 'binary_precision': 0.8719512, 'binary_recall': 0.6559633, 'binary_specificity': 0.9036697, 'binary_f1_score': 0.74869114}
confusion matrix:
     0    1
0  197   21
1   75  143
early stop counter: 2
val acc:0.6550657153129578, best validation acc: 0.8692961931228638, corresponding to test acc:                         0.8692660331726074 / 0.8692660331726074
after epoch: 5,now: 2024-07-26 11:00:28.405346,epoch time: 0:01:26.544695,used: 0:07:16.650931,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_10_53_11_seed_8_23065779
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.97467107, 'precision': 0.9754188, 'recall': 0.97492176, 'specificity': 0.97492176, 'f1': 0.97466767, 'auroc': 0.9983369, 'binary_precision': 0.99727523, 'binary_recall': 0.9525049, 'binary_specificity': 0.99733865, 'binary_f1_score': 0.974376}
confusion matrix:
      0     1
0  1499     4
1    73  1464
---- Validation: 
scalar performance:
{'acc': 0.6071152, 'precision': 0.7172446, 'recall': 0.59532934, 'specificity': 0.59532934, 'f1': 0.53639686, 'auroc': 0.8253182, 'binary_precision': 0.86419755, 'binary_recall': 0.22364217, 'binary_specificity': 0.9670165, 'binary_f1_score': 0.35532993}
confusion matrix:
     0    1
0  645   22
1  486  140
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.61926603, 'precision': 0.7444368, 'recall': 0.61926603, 'specificity': 0.61926603, 'f1': 0.5633688, 'auroc': 0.87071794, 'binary_precision': 0.91935486, 'binary_recall': 0.2614679, 'binary_specificity': 0.9770642, 'binary_f1_score': 0.4071429}
confusion matrix:
     0   1
0  213   5
1  161  57
early stop counter: 3
val acc:0.6071152091026306, best validation acc: 0.8692961931228638, corresponding to test acc:                         0.8692660331726074 / 0.8692660331726074
after epoch: 6,now: 2024-07-26 11:01:54.416557,epoch time: 0:01:26.011211,used: 0:08:42.662142,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_10_53_11_seed_8_23065779
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.97105265, 'precision': 0.97220004, 'recall': 0.9713758, 'specificity': 0.9713758, 'f1': 0.9710454, 'auroc': 0.9984771, 'binary_precision': 0.9986245, 'binary_recall': 0.9440832, 'binary_specificity': 0.99866843, 'binary_f1_score': 0.9705882}
confusion matrix:
      0     1
0  1500     2
1    86  1452
---- Validation: 
scalar performance:
{'acc': 0.5931941, 'precision': 0.74186444, 'recall': 0.5803141, 'specificity': 0.5803141, 'f1': 0.50372577, 'auroc': 0.843017, 'binary_precision': 0.9237288, 'binary_recall': 0.17412141, 'binary_specificity': 0.98650676, 'binary_f1_score': 0.29301074}
confusion matrix:
     0    1
0  658    9
1  517  109
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5206422, 'precision': 0.7552693, 'recall': 0.5206422, 'specificity': 0.5206422, 'f1': 0.37763208, 'auroc': 0.88908756, 'binary_precision': 1.0, 'binary_recall': 0.041284405, 'binary_specificity': 1.0, 'binary_f1_score': 0.07929515}
confusion matrix:
     0  1
0  218  0
1  209  9
early stop counter: 4
val acc:0.5931941270828247, best validation acc: 0.8692961931228638, corresponding to test acc:                         0.8692660331726074 / 0.8692660331726074
after epoch: 7,now: 2024-07-26 11:03:20.597072,epoch time: 0:01:26.180515,used: 0:10:08.842657,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_10_53_11_seed_8_23065779
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9773026, 'precision': 0.97751, 'recall': 0.9774506, 'specificity': 0.9774506, 'f1': 0.9773025, 'auroc': 0.9977534, 'binary_precision': 0.9906417, 'binary_recall': 0.964216, 'binary_specificity': 0.9906853, 'binary_f1_score': 0.9772502}
confusion matrix:
      0     1
0  1489    14
1    55  1482
---- Validation: 
scalar performance:
{'acc': 0.8491879, 'precision': 0.8511864, 'recall': 0.84793144, 'specificity': 0.84793144, 'f1': 0.8485178, 'auroc': 0.9141859, 'binary_precision': 0.8709122, 'binary_recall': 0.8083067, 'binary_specificity': 0.8875562, 'binary_f1_score': 0.83844244}
confusion matrix:
     0    1
0  592   75
1  120  506
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8486239, 'precision': 0.8573154, 'recall': 0.8486239, 'specificity': 0.8486239, 'f1': 0.8476976, 'auroc': 0.9252589, 'binary_precision': 0.9130435, 'binary_recall': 0.7706422, 'binary_specificity': 0.9266055, 'binary_f1_score': 0.83582085}
confusion matrix:
     0    1
0  202   16
1   50  168
early stop counter: 5
val acc:0.8491879105567932, best validation acc: 0.8692961931228638, corresponding to test acc:                         0.8692660331726074 / 0.8692660331726074
after epoch: 8,now: 2024-07-26 11:04:46.608129,epoch time: 0:01:26.011057,used: 0:11:34.853714,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_10_53_11_seed_8_23065779
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9828947, 'precision': 0.9829478, 'recall': 0.9828558, 'specificity': 0.9828558, 'f1': 0.98289114, 'auroc': 0.9990338, 'binary_precision': 0.9799612, 'binary_recall': 0.986337, 'binary_specificity': 0.9793746, 'binary_f1_score': 0.98313874}
confusion matrix:
      0     1
0  1472    31
1    21  1516
---- Validation: 
scalar performance:
{'acc': 0.8368136, 'precision': 0.8436797, 'recall': 0.83451366, 'specificity': 0.83451366, 'f1': 0.8351986, 'auroc': 0.90314984, 'binary_precision': 0.88497216, 'binary_recall': 0.76198083, 'binary_specificity': 0.9070465, 'binary_f1_score': 0.81888413}
confusion matrix:
     0    1
0  605   62
1  149  477
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8119266, 'precision': 0.8119266, 'recall': 0.8119266, 'specificity': 0.8119266, 'f1': 0.8119266, 'auroc': 0.8866888, 'binary_precision': 0.8119266, 'binary_recall': 0.8119266, 'binary_specificity': 0.8119266, 'binary_f1_score': 0.8119266}
confusion matrix:
     0    1
0  177   41
1   41  177
early stop counter: 6
val acc:0.8368136286735535, best validation acc: 0.8692961931228638, corresponding to test acc:                         0.8692660331726074 / 0.8692660331726074
after epoch: 9,now: 2024-07-26 11:06:12.832074,epoch time: 0:01:26.223945,used: 0:13:01.077659,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_10_53_11_seed_8_23065779
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.98651314, 'precision': 0.9865078, 'recall': 0.98651516, 'specificity': 0.98651516, 'f1': 0.98651135, 'auroc': 0.9994256, 'binary_precision': 0.98698765, 'binary_recall': 0.9863459, 'binary_specificity': 0.98668444, 'binary_f1_score': 0.9866666}
confusion matrix:
      0     1
0  1482    20
1    21  1517
---- Validation: 
scalar performance:
{'acc': 0.8561485, 'precision': 0.85721666, 'recall': 0.8552182, 'specificity': 0.8552182, 'f1': 0.85568845, 'auroc': 0.923682, 'binary_precision': 0.8703704, 'binary_recall': 0.8258786, 'binary_specificity': 0.8845577, 'binary_f1_score': 0.847541}
confusion matrix:
     0    1
0  590   77
1  109  517
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.82568806, 'precision': 0.8263748, 'recall': 0.8256881, 'specificity': 0.8256881, 'f1': 0.82559633, 'auroc': 0.90400636, 'binary_precision': 0.84134614, 'binary_recall': 0.8027523, 'binary_specificity': 0.8486239, 'binary_f1_score': 0.8215962}
confusion matrix:
     0    1
0  185   33
1   43  175
early stop counter: 7
val acc:0.8561484813690186, best validation acc: 0.8692961931228638, corresponding to test acc:                         0.8692660331726074 / 0.8692660331726074
after epoch: 10,now: 2024-07-26 11:07:39.021136,epoch time: 0:01:26.189062,used: 0:14:27.266721,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_10_53_11_seed_8_23065779
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9723684, 'precision': 0.9734571, 'recall': 0.972684, 'specificity': 0.972684, 'f1': 0.97236204, 'auroc': 0.9992928, 'binary_precision': 0.9993132, 'binary_recall': 0.94603384, 'binary_specificity': 0.9993342, 'binary_f1_score': 0.97194386}
confusion matrix:
      0     1
0  1501     1
1    83  1455
---- Validation: 
scalar performance:
{'acc': 0.6921887, 'precision': 0.807093, 'recall': 0.6822559, 'specificity': 0.6822559, 'f1': 0.65330917, 'auroc': 0.9324427, 'binary_precision': 0.98717946, 'binary_recall': 0.36900958, 'binary_specificity': 0.99550223, 'binary_f1_score': 0.5372093}
confusion matrix:
     0    1
0  664    3
1  395  231
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.54816514, 'precision': 0.7626506, 'recall': 0.54816514, 'specificity': 0.54816514, 'f1': 0.4322579, 'auroc': 0.91916716, 'binary_precision': 1.0, 'binary_recall': 0.09633028, 'binary_specificity': 1.0, 'binary_f1_score': 0.17573223}
confusion matrix:
     0   1
0  218   0
1  197  21
early stop counter: 8
val acc:0.6921886801719666, best validation acc: 0.8692961931228638, corresponding to test acc:                         0.8692660331726074 / 0.8692660331726074
after epoch: 11,now: 2024-07-26 11:09:05.612424,epoch time: 0:01:26.591288,used: 0:15:53.858009,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_10_53_11_seed_8_23065779
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9763158, 'precision': 0.9770267, 'recall': 0.9765774, 'specificity': 0.9765774, 'f1': 0.9763131, 'auroc': 0.9993857, 'binary_precision': 0.99863946, 'binary_recall': 0.95448637, 'binary_specificity': 0.99866843, 'binary_f1_score': 0.97606385}
confusion matrix:
      0     1
0  1500     2
1    70  1468
---- Validation: 
scalar performance:
{'acc': 0.65274554, 'precision': 0.7883769, 'recall': 0.6415702, 'specificity': 0.6415702, 'f1': 0.5967024, 'auroc': 0.91471756, 'binary_precision': 0.97837836, 'binary_recall': 0.2891374, 'binary_specificity': 0.994003, 'binary_f1_score': 0.4463625}
confusion matrix:
     0    1
0  663    4
1  445  181
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6559633, 'precision': 0.7893052, 'recall': 0.6559633, 'specificity': 0.6559633, 'f1': 0.61115867, 'auroc': 0.9069102, 'binary_precision': 0.98571426, 'binary_recall': 0.31651375, 'binary_specificity': 0.9954128, 'binary_f1_score': 0.47916666}
confusion matrix:
     0   1
0  217   1
1  149  69
early stop counter: 9
val acc:0.6527455449104309, best validation acc: 0.8692961931228638, corresponding to test acc:                         0.8692660331726074 / 0.8692660331726074
after epoch: 12,now: 2024-07-26 11:10:31.703293,epoch time: 0:01:26.090869,used: 0:17:19.948878,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_10_53_11_seed_8_23065779
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9888158, 'precision': 0.9888519, 'recall': 0.9889027, 'specificity': 0.9889027, 'f1': 0.98881567, 'auroc': 0.99959695, 'binary_precision': 0.9966953, 'binary_recall': 0.9811321, 'binary_specificity': 0.99667335, 'binary_f1_score': 0.9888525}
confusion matrix:
      0     1
0  1498     5
1    29  1508
---- Validation: 
scalar performance:
{'acc': 0.83294666, 'precision': 0.8562932, 'recall': 0.82885075, 'specificity': 0.82885075, 'f1': 0.82880974, 'auroc': 0.9288, 'binary_precision': 0.93991417, 'binary_recall': 0.6996805, 'binary_specificity': 0.958021, 'binary_f1_score': 0.8021978}
confusion matrix:
     0    1
0  639   28
1  188  438
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7201835, 'precision': 0.7788615, 'recall': 0.7201835, 'specificity': 0.7201835, 'f1': 0.7046464, 'auroc': 0.89352745, 'binary_precision': 0.90677965, 'binary_recall': 0.49082568, 'binary_specificity': 0.9495413, 'binary_f1_score': 0.6369048}
confusion matrix:
     0    1
0  207   11
1  111  107
early stop counter: 10
val acc:0.8329466581344604, best validation acc: 0.8692961931228638, corresponding to test acc:                         0.8692660331726074 / 0.8692660331726074
after epoch: 13,now: 2024-07-26 11:11:58.042375,epoch time: 0:01:26.339082,used: 0:18:46.287960,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_10_53_11_seed_8_23065779
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.99013156, 'precision': 0.9902033, 'recall': 0.9900862, 'specificity': 0.9900862, 'f1': 0.99012935, 'auroc': 0.99974453, 'binary_precision': 0.98644286, 'binary_recall': 0.99414444, 'binary_specificity': 0.98602796, 'binary_f1_score': 0.9902787}
confusion matrix:
      0     1
0  1482    21
1     9  1528
---- Validation: 
scalar performance:
{'acc': 0.82675946, 'precision': 0.84157956, 'recall': 0.8233938, 'specificity': 0.8233938, 'f1': 0.8236755, 'auroc': 0.9110742, 'binary_precision': 0.9052419, 'binary_recall': 0.7172524, 'binary_specificity': 0.9295352, 'binary_f1_score': 0.8003565}
confusion matrix:
     0    1
0  620   47
1  177  449
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.80504584, 'precision': 0.83900803, 'recall': 0.80504584, 'specificity': 0.80504584, 'f1': 0.8000378, 'auroc': 0.8980094, 'binary_precision': 0.94630873, 'binary_recall': 0.646789, 'binary_specificity': 0.96330273, 'binary_f1_score': 0.76839244}
confusion matrix:
     0    1
0  210    8
1   77  141
early stop counter: 11
val acc:0.8267594575881958, best validation acc: 0.8692961931228638, corresponding to test acc:                         0.8692660331726074 / 0.8692660331726074
after epoch: 14,now: 2024-07-26 11:13:24.375313,epoch time: 0:01:26.332938,used: 0:20:12.620898,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_10_53_11_seed_8_23065779
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9894737, 'precision': 0.9894575, 'recall': 0.9894956, 'specificity': 0.9894956, 'f1': 0.9894726, 'auroc': 0.9994905, 'binary_precision': 0.9915144, 'binary_recall': 0.9876463, 'binary_specificity': 0.99134487, 'binary_f1_score': 0.9895766}
confusion matrix:
      0     1
0  1489    13
1    19  1519
---- Validation: 
scalar performance:
{'acc': 0.8159319, 'precision': 0.8483568, 'recall': 0.81103337, 'specificity': 0.81103337, 'f1': 0.8097542, 'auroc': 0.9064262, 'binary_precision': 0.9470046, 'binary_recall': 0.6565495, 'binary_specificity': 0.9655172, 'binary_f1_score': 0.7754717}
confusion matrix:
     0    1
0  644   23
1  215  411
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7385321, 'precision': 0.82000905, 'recall': 0.7385321, 'specificity': 0.7385321, 'f1': 0.72075784, 'auroc': 0.9097509, 'binary_precision': 0.9814815, 'binary_recall': 0.48623854, 'binary_specificity': 0.9908257, 'binary_f1_score': 0.65030676}
confusion matrix:
     0    1
0  216    2
1  112  106
early stop counter: 12
val acc:0.8159319162368774, best validation acc: 0.8692961931228638, corresponding to test acc:                         0.8692660331726074 / 0.8692660331726074
after epoch: 15,now: 2024-07-26 11:14:50.750218,epoch time: 0:01:26.374905,used: 0:21:38.995803,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_10_53_11_seed_8_23065779
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.98453945, 'precision': 0.98485243, 'recall': 0.9844165, 'specificity': 0.9844165, 'f1': 0.98453194, 'auroc': 0.9996333, 'binary_precision': 0.97514343, 'binary_recall': 0.9947984, 'binary_specificity': 0.9740346, 'binary_f1_score': 0.9848729}
confusion matrix:
      0     1
0  1463    39
1     8  1530
---- Validation: 
scalar performance:
{'acc': 0.84532094, 'precision': 0.8463549, 'recall': 0.8462454, 'specificity': 0.8462454, 'f1': 0.8453201, 'auroc': 0.9175389, 'binary_precision': 0.81791043, 'binary_recall': 0.87539935, 'binary_specificity': 0.81709146, 'binary_f1_score': 0.845679}
confusion matrix:
     0    1
0  545  122
1   78  548
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.82798165, 'precision': 0.82915217, 'recall': 0.82798165, 'specificity': 0.82798165, 'f1': 0.82782865, 'auroc': 0.90949833, 'binary_precision': 0.8095238, 'binary_recall': 0.85779816, 'binary_specificity': 0.79816514, 'binary_f1_score': 0.8329622}
confusion matrix:
     0    1
0  174   44
1   31  187
early stop counter: 13
val acc:0.8453209400177002, best validation acc: 0.8692961931228638, corresponding to test acc:                         0.8692660331726074 / 0.8692660331726074
after epoch: 16,now: 2024-07-26 11:16:17.192163,epoch time: 0:01:26.441945,used: 0:23:05.437748,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_10_53_11_seed_8_23065779
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.97664475, 'precision': 0.97739476, 'recall': 0.9768957, 'specificity': 0.9768957, 'f1': 0.97664165, 'auroc': 0.9991784, 'binary_precision': 0.9993188, 'binary_recall': 0.95445675, 'binary_specificity': 0.9993347, 'binary_f1_score': 0.9763727}
confusion matrix:
      0     1
0  1502     1
1    70  1467
---- Validation: 
scalar performance:
{'acc': 0.671307, 'precision': 0.7745004, 'recall': 0.66127956, 'specificity': 0.66127956, 'f1': 0.6291386, 'auroc': 0.9076159, 'binary_precision': 0.9350649, 'binary_recall': 0.34504792, 'binary_specificity': 0.9775112, 'binary_f1_score': 0.504084}
confusion matrix:
     0    1
0  652   15
1  410  216
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.646789, 'precision': 0.76617825, 'recall': 0.64678895, 'specificity': 0.64678895, 'f1': 0.60218036, 'auroc': 0.88616276, 'binary_precision': 0.9444444, 'binary_recall': 0.3119266, 'binary_specificity': 0.98165137, 'binary_f1_score': 0.4689655}
confusion matrix:
     0   1
0  214   4
1  150  68
early stop counter: 14
val acc:0.6713070273399353, best validation acc: 0.8692961931228638, corresponding to test acc:                         0.8692660331726074 / 0.8692660331726074
after epoch: 17,now: 2024-07-26 11:17:43.716537,epoch time: 0:01:26.524374,used: 0:24:31.962122,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_10_53_11_seed_8_23065779
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9756579, 'precision': 0.97630787, 'recall': 0.9754567, 'specificity': 0.9754567, 'f1': 0.9756384, 'auroc': 0.99889183, 'binary_precision': 0.9615627, 'binary_recall': 0.99155295, 'binary_specificity': 0.9593604, 'binary_f1_score': 0.97632754}
confusion matrix:
      0     1
0  1440    61
1    13  1526
---- Validation: 
scalar performance:
{'acc': 0.84377414, 'precision': 0.8453666, 'recall': 0.84489346, 'specificity': 0.84489346, 'f1': 0.8437629, 'auroc': 0.9118939, 'binary_precision': 0.81268436, 'binary_recall': 0.8801917, 'binary_specificity': 0.8095952, 'binary_f1_score': 0.845092}
confusion matrix:
     0    1
0  540  127
1   75  551
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.82798165, 'precision': 0.82854164, 'recall': 0.82798165, 'specificity': 0.82798165, 'f1': 0.8279083, 'auroc': 0.9045534, 'binary_precision': 0.81497794, 'binary_recall': 0.8486239, 'binary_specificity': 0.80733943, 'binary_f1_score': 0.83146065}
confusion matrix:
     0    1
0  176   42
1   33  185
early stop counter: 15
val acc:0.843774139881134, best validation acc: 0.8692961931228638, corresponding to test acc:                         0.8692660331726074 / 0.8692660331726074
after epoch: 18,now: 2024-07-26 11:19:09.928230,epoch time: 0:01:26.211693,used: 0:25:58.173815,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_10_53_11_seed_8_23065779
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9894737, 'precision': 0.9894656, 'recall': 0.98948, 'specificity': 0.98948, 'f1': 0.9894724, 'auroc': 0.99934375, 'binary_precision': 0.9902344, 'binary_recall': 0.9889467, 'binary_specificity': 0.9900133, 'binary_f1_score': 0.9895901}
confusion matrix:
      0     1
0  1487    15
1    17  1521
---- Validation: 
scalar performance:
{'acc': 0.8561485, 'precision': 0.86590517, 'recall': 0.8535489, 'specificity': 0.8535489, 'f1': 0.85441726, 'auroc': 0.93602324, 'binary_precision': 0.918251, 'binary_recall': 0.7715655, 'binary_specificity': 0.9355322, 'binary_f1_score': 0.8385417}
confusion matrix:
     0    1
0  624   43
1  143  483
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8119266, 'precision': 0.8278195, 'recall': 0.8119266, 'specificity': 0.8119266, 'f1': 0.8096192, 'auroc': 0.90314364, 'binary_precision': 0.9, 'binary_recall': 0.70183486, 'binary_specificity': 0.92201835, 'binary_f1_score': 0.7886598}
confusion matrix:
     0    1
0  201   17
1   65  153
early stop counter: 16
val acc:0.8561484813690186, best validation acc: 0.8692961931228638, corresponding to test acc:                         0.8692660331726074 / 0.8692660331726074
after epoch: 19,now: 2024-07-26 11:20:36.328632,epoch time: 0:01:26.400402,used: 0:27:24.574217,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_10_53_11_seed_8_23065779
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.98223686, 'precision': 0.9825581, 'recall': 0.9821169, 'specificity': 0.9821169, 'f1': 0.98222846, 'auroc': 0.9994767, 'binary_precision': 0.972594, 'binary_recall': 0.9928432, 'binary_specificity': 0.97139055, 'binary_f1_score': 0.98261434}
confusion matrix:
      0     1
0  1460    43
1    11  1526
---- Validation: 
scalar performance:
{'acc': 0.8205723, 'precision': 0.82041925, 'recall': 0.82068634, 'specificity': 0.82068634, 'f1': 0.820482, 'auroc': 0.8977564, 'binary_precision': 0.80877745, 'binary_recall': 0.82428116, 'binary_specificity': 0.81709146, 'binary_f1_score': 0.8164557}
confusion matrix:
     0    1
0  545  122
1  110  516
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7912844, 'precision': 0.791585, 'recall': 0.7912844, 'specificity': 0.7912844, 'f1': 0.79123056, 'auroc': 0.8390287, 'binary_precision': 0.7822222, 'binary_recall': 0.80733943, 'binary_specificity': 0.77522933, 'binary_f1_score': 0.79458237}
confusion matrix:
     0    1
0  169   49
1   42  176
early stop counter: 17
val acc:0.8205723166465759, best validation acc: 0.8692961931228638, corresponding to test acc:                         0.8692660331726074 / 0.8692660331726074
after epoch: 20,now: 2024-07-26 11:22:02.961478,epoch time: 0:01:26.632846,used: 0:28:51.207063,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_10_53_11_seed_8_23065779
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.98355263, 'precision': 0.98388135, 'recall': 0.9837557, 'specificity': 0.9837557, 'f1': 0.98355234, 'auroc': 0.999684, 'binary_precision': 1.0, 'binary_recall': 0.96751136, 'binary_specificity': 1.0, 'binary_f1_score': 0.9834874}
confusion matrix:
      0     1
0  1501     0
1    50  1489
---- Validation: 
scalar performance:
{'acc': 0.837587, 'precision': 0.8594985, 'recall': 0.8336431, 'specificity': 0.8336431, 'f1': 0.83380705, 'auroc': 0.9301052, 'binary_precision': 0.94067794, 'binary_recall': 0.7092652, 'binary_specificity': 0.958021, 'binary_f1_score': 0.8087431}
confusion matrix:
     0    1
0  639   28
1  182  444
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8027523, 'precision': 0.8353846, 'recall': 0.8027523, 'specificity': 0.8027523, 'f1': 0.79783475, 'auroc': 0.91526914, 'binary_precision': 0.94, 'binary_recall': 0.646789, 'binary_specificity': 0.9587156, 'binary_f1_score': 0.7663044}
confusion matrix:
     0    1
0  209    9
1   77  141
early stop counter: 18
val acc:0.8375869989395142, best validation acc: 0.8692961931228638, corresponding to test acc:                         0.8692660331726074 / 0.8692660331726074
after epoch: 21,now: 2024-07-26 11:23:29.543892,epoch time: 0:01:26.582414,used: 0:30:17.789477,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_10_53_11_seed_8_23065779
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9779605, 'precision': 0.97867596, 'recall': 0.97819006, 'specificity': 0.97819006, 'f1': 0.9779576, 'auroc': 0.99950397, 'binary_precision': 1.0, 'binary_recall': 0.9563802, 'binary_specificity': 1.0, 'binary_f1_score': 0.97770387}
confusion matrix:
      0     1
0  1504     0
1    67  1469
---- Validation: 
scalar performance:
{'acc': 0.67208046, 'precision': 0.7922834, 'recall': 0.6616365, 'specificity': 0.6616365, 'f1': 0.62619865, 'auroc': 0.91239864, 'binary_precision': 0.97196263, 'binary_recall': 0.33226836, 'binary_specificity': 0.9910045, 'binary_f1_score': 0.4952381}
confusion matrix:
     0    1
0  661    6
1  418  208
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5022936, 'precision': 0.7505747, 'recall': 0.5022936, 'specificity': 0.5022936, 'f1': 0.33841002, 'auroc': 0.8959526, 'binary_precision': 1.0, 'binary_recall': 0.0045871558, 'binary_specificity': 1.0, 'binary_f1_score': 0.00913242}
confusion matrix:
     0  1
0  218  0
1  217  1
early stop counter: 19
val acc:0.6720804572105408, best validation acc: 0.8692961931228638, corresponding to test acc:                         0.8692660331726074 / 0.8692660331726074
after epoch: 22,now: 2024-07-26 11:24:56.384836,epoch time: 0:01:26.840944,used: 0:31:44.630421,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_10_53_11_seed_8_23065779
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.98980266, 'precision': 0.989789, 'recall': 0.98981977, 'specificity': 0.98981977, 'f1': 0.9898017, 'auroc': 0.99965024, 'binary_precision': 0.9915144, 'binary_recall': 0.9882889, 'binary_specificity': 0.99135065, 'binary_f1_score': 0.989899}
confusion matrix:
      0     1
0  1490    13
1    18  1519
---- Validation: 
scalar performance:
{'acc': 0.7610209, 'precision': 0.8135673, 'recall': 0.7543732, 'specificity': 0.7543732, 'f1': 0.7472317, 'auroc': 0.9085655, 'binary_precision': 0.9342466, 'binary_recall': 0.54472846, 'binary_specificity': 0.964018, 'binary_f1_score': 0.6881938}
confusion matrix:
     0    1
0  643   24
1  285  341
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.82798165, 'precision': 0.8621936, 'recall': 0.82798165, 'specificity': 0.82798165, 'f1': 0.8238213, 'auroc': 0.93319166, 'binary_precision': 0.9735099, 'binary_recall': 0.67431194, 'binary_specificity': 0.98165137, 'binary_f1_score': 0.796748}
confusion matrix:
     0    1
0  214    4
1   71  147
early stop counter: 20
val acc:0.7610208988189697, best validation acc: 0.8692961931228638, corresponding to test acc:                         0.8692660331726074 / 0.8692660331726074
after epoch: 23,now: 2024-07-26 11:26:22.913201,epoch time: 0:01:26.528365,used: 0:33:11.158786,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_10_53_11_seed_8_23065779
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.98618424, 'precision': 0.9862732, 'recall': 0.98631364, 'specificity': 0.98631364, 'f1': 0.9861841, 'auroc': 0.99954545, 'binary_precision': 0.99668217, 'binary_recall': 0.9759584, 'binary_specificity': 0.9966689, 'binary_f1_score': 0.9862114}
confusion matrix:
      0     1
0  1496     5
1    37  1502
---- Validation: 
scalar performance:
{'acc': 0.7579273, 'precision': 0.83219486, 'recall': 0.75029457, 'specificity': 0.75029457, 'f1': 0.7397177, 'auroc': 0.92050564, 'binary_precision': 0.9815385, 'binary_recall': 0.50958467, 'binary_specificity': 0.9910045, 'binary_f1_score': 0.67087275}
confusion matrix:
     0    1
0  661    6
1  307  319
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.56880736, 'precision': 0.7684729, 'recall': 0.56880736, 'specificity': 0.56880736, 'f1': 0.47032672, 'auroc': 0.9152744, 'binary_precision': 1.0, 'binary_recall': 0.13761468, 'binary_specificity': 1.0, 'binary_f1_score': 0.24193548}
confusion matrix:
     0   1
0  218   0
1  188  30
early stop counter: 21
val acc:0.7579272985458374, best validation acc: 0.8692961931228638, corresponding to test acc:                         0.8692660331726074 / 0.8692660331726074
after epoch: 24,now: 2024-07-26 11:27:49.332275,epoch time: 0:01:26.419074,used: 0:34:37.577860,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_10_53_11_seed_8_23065779
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.98618424, 'precision': 0.9863802, 'recall': 0.9863297, 'specificity': 0.9863297, 'f1': 0.9861842, 'auroc': 0.9997277, 'binary_precision': 0.999332, 'binary_recall': 0.97332466, 'binary_specificity': 0.9993347, 'binary_f1_score': 0.9861569}
confusion matrix:
      0     1
0  1502     1
1    41  1496
---- Validation: 
scalar performance:
{'acc': 0.62103635, 'precision': 0.77788144, 'recall': 0.60877347, 'specificity': 0.60877347, 'f1': 0.5462261, 'auroc': 0.91116583, 'binary_precision': 0.97887325, 'binary_recall': 0.22204472, 'binary_specificity': 0.99550223, 'binary_f1_score': 0.36197916}
confusion matrix:
     0    1
0  664    3
1  487  139
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5642202, 'precision': 0.76715684, 'recall': 0.5642202, 'specificity': 0.5642202, 'f1': 0.46206397, 'auroc': 0.89520556, 'binary_precision': 1.0, 'binary_recall': 0.12844037, 'binary_specificity': 1.0, 'binary_f1_score': 0.22764227}
confusion matrix:
     0   1
0  218   0
1  190  28
early stop counter: 22
val acc:0.6210363507270813, best validation acc: 0.8692961931228638, corresponding to test acc:                         0.8692660331726074 / 0.8692660331726074
after epoch: 25,now: 2024-07-26 11:29:16.119476,epoch time: 0:01:26.787201,used: 0:36:04.365061,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_10_53_11_seed_8_23065779
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9917763, 'precision': 0.99178994, 'recall': 0.99185693, 'specificity': 0.99185693, 'f1': 0.9917761, 'auroc': 0.9996134, 'binary_precision': 0.9986816, 'binary_recall': 0.9850455, 'binary_specificity': 0.99866843, 'binary_f1_score': 0.9918167}
confusion matrix:
      0     1
0  1500     2
1    23  1515
---- Validation: 
scalar performance:
{'acc': 0.8174787, 'precision': 0.8531524, 'recall': 0.8123853, 'specificity': 0.8123853, 'f1': 0.8109096, 'auroc': 0.9333954, 'binary_precision': 0.9577465, 'binary_recall': 0.6517572, 'binary_specificity': 0.9730135, 'binary_f1_score': 0.7756654}
confusion matrix:
     0    1
0  649   18
1  218  408
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6261468, 'precision': 0.769523, 'recall': 0.6261468, 'specificity': 0.6261468, 'f1': 0.56880134, 'auroc': 0.91486406, 'binary_precision': 0.9661017, 'binary_recall': 0.2614679, 'binary_specificity': 0.9908257, 'binary_f1_score': 0.41155234}
confusion matrix:
     0   1
0  216   2
1  161  57
early stop counter: 23
val acc:0.8174787163734436, best validation acc: 0.8692961931228638, corresponding to test acc:                         0.8692660331726074 / 0.8692660331726074
after epoch: 26,now: 2024-07-26 11:30:42.519779,epoch time: 0:01:26.400303,used: 0:37:30.765364,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_10_53_11_seed_8_23065779
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.99276316, 'precision': 0.9928359, 'recall': 0.9927181, 'specificity': 0.9927181, 'f1': 0.9927615, 'auroc': 0.99981344, 'binary_precision': 0.9890252, 'binary_recall': 0.9967469, 'binary_specificity': 0.9886893, 'binary_f1_score': 0.992871}
confusion matrix:
      0     1
0  1486    17
1     5  1532
---- Validation: 
scalar performance:
{'acc': 0.8491879, 'precision': 0.87170374, 'recall': 0.84528023, 'specificity': 0.84528023, 'f1': 0.8457147, 'auroc': 0.94471455, 'binary_precision': 0.9556025, 'binary_recall': 0.7220447, 'binary_specificity': 0.96851575, 'binary_f1_score': 0.8225659}
confusion matrix:
     0    1
0  646   21
1  174  452
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8142202, 'precision': 0.86172277, 'recall': 0.8142202, 'specificity': 0.8142202, 'f1': 0.80791384, 'auroc': 0.9199141, 'binary_precision': 0.9928058, 'binary_recall': 0.6330275, 'binary_specificity': 0.9954128, 'binary_f1_score': 0.7731092}
confusion matrix:
     0    1
0  217    1
1   80  138
early stop counter: 24
val acc:0.8491879105567932, best validation acc: 0.8692961931228638, corresponding to test acc:                         0.8692660331726074 / 0.8692660331726074
after epoch: 27,now: 2024-07-26 11:32:08.932456,epoch time: 0:01:26.412677,used: 0:38:57.178041,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_10_53_11_seed_8_23065779
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.99671054, 'precision': 0.99669904, 'recall': 0.99672484, 'specificity': 0.99672484, 'f1': 0.9967102, 'auroc': 0.9998139, 'binary_precision': 0.99804306, 'binary_recall': 0.99544567, 'binary_specificity': 0.998004, 'binary_f1_score': 0.99674267}
confusion matrix:
      0     1
0  1500     3
1     7  1530
---- Validation: 
scalar performance:
{'acc': 0.77880895, 'precision': 0.8393018, 'recall': 0.77200735, 'specificity': 0.77200735, 'f1': 0.7654114, 'auroc': 0.9322164, 'binary_precision': 0.9748603, 'binary_recall': 0.557508, 'binary_specificity': 0.98650676, 'binary_f1_score': 0.70934963}
confusion matrix:
     0    1
0  658    9
1  277  349
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.63073397, 'precision': 0.7793238, 'recall': 0.63073397, 'specificity': 0.63073397, 'f1': 0.57409215, 'auroc': 0.9065683, 'binary_precision': 0.9830508, 'binary_recall': 0.26605505, 'binary_specificity': 0.9954128, 'binary_f1_score': 0.41877255}
confusion matrix:
     0   1
0  217   1
1  160  58
early stop counter: 25
val acc:0.7788089513778687, best validation acc: 0.8692961931228638, corresponding to test acc:                         0.8692660331726074 / 0.8692660331726074
after epoch: 28,now: 2024-07-26 11:33:35.489405,epoch time: 0:01:26.556949,used: 0:40:23.734990,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_10_53_11_seed_8_23065779
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.99473685, 'precision': 0.9947293, 'recall': 0.99474394, 'specificity': 0.99474394, 'f1': 0.9947362, 'auroc': 0.9998832, 'binary_precision': 0.9954427, 'binary_recall': 0.99414825, 'binary_specificity': 0.9953396, 'binary_f1_score': 0.9947951}
confusion matrix:
      0     1
0  1495     7
1     9  1529
---- Validation: 
scalar performance:
{'acc': 0.82830626, 'precision': 0.85311866, 'recall': 0.8240584, 'specificity': 0.8240584, 'f1': 0.8237901, 'auroc': 0.931435, 'binary_precision': 0.9391304, 'binary_recall': 0.69009584, 'binary_specificity': 0.958021, 'binary_f1_score': 0.79558015}
confusion matrix:
     0    1
0  639   28
1  194  432
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.80504584, 'precision': 0.81862235, 'recall': 0.80504584, 'specificity': 0.80504584, 'f1': 0.80294675, 'auroc': 0.8774935, 'binary_precision': 0.88439304, 'binary_recall': 0.70183486, 'binary_specificity': 0.9082569, 'binary_f1_score': 0.7826087}
confusion matrix:
     0    1
0  198   20
1   65  153
early stop counter: 26
val acc:0.828306257724762, best validation acc: 0.8692961931228638, corresponding to test acc:                         0.8692660331726074 / 0.8692660331726074
after epoch: 29,now: 2024-07-26 11:35:01.860444,epoch time: 0:01:26.371039,used: 0:41:50.106029,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_10_53_11_seed_8_23065779
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.96414477, 'precision': 0.9661701, 'recall': 0.9645644, 'specificity': 0.9645644, 'f1': 0.9641241, 'auroc': 0.9996532, 'binary_precision': 1.0, 'binary_recall': 0.92912877, 'binary_specificity': 1.0, 'binary_f1_score': 0.96326256}
confusion matrix:
      0     1
0  1502     0
1   109  1429
---- Validation: 
scalar performance:
{'acc': 0.68058777, 'precision': 0.8044065, 'recall': 0.670226, 'specificity': 0.670226, 'f1': 0.6365676, 'auroc': 0.93377554, 'binary_precision': 0.9907834, 'binary_recall': 0.3434505, 'binary_specificity': 0.9970015, 'binary_f1_score': 0.510083}
confusion matrix:
     0    1
0  665    2
1  411  215
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5229358, 'precision': 0.75586855, 'recall': 0.5229358, 'specificity': 0.5229358, 'f1': 0.38236898, 'auroc': 0.913328, 'binary_precision': 1.0, 'binary_recall': 0.04587156, 'binary_specificity': 1.0, 'binary_f1_score': 0.08771929}
confusion matrix:
     0   1
0  218   0
1  208  10
early stop counter: 27
val acc:0.6805877685546875, best validation acc: 0.8692961931228638, corresponding to test acc:                         0.8692660331726074 / 0.8692660331726074
after epoch: 30,now: 2024-07-26 11:36:28.086540,epoch time: 0:01:26.226096,used: 0:43:16.332125,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_10_53_11_seed_8_23065779
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 0:43:16.332125 at 2024-07-26 11:36:28.086540
persisted model performance metric: 

scalar performance:
{'acc': 0.86926603, 'precision': 0.8768872, 'recall': 0.86926603, 'specificity': 0.86926603, 'f1': 0.8686018, 'auroc': 0.926353, 'binary_precision': 0.93048126, 'binary_recall': 0.79816514, 'binary_specificity': 0.940367, 'binary_f1_score': 0.85925925}
confusion matrix:
     0    1
0  205   13
1   44  174
oracle model performance metric: 

scalar performance:
{'acc': 0.86926603, 'precision': 0.8768872, 'recall': 0.86926603, 'specificity': 0.86926603, 'f1': 0.8686018, 'auroc': 0.926353, 'binary_precision': 0.93048126, 'binary_recall': 0.79816514, 'binary_specificity': 0.940367, 'binary_f1_score': 0.85925925}
confusion matrix:
     0    1
0  205   13
1   44  174
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_irm_10seeds_nofreeze_2024-07-26_02-28-54/rule_results/0.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_irm_10seeds_nofreeze_2024-07-26_02-28-54/confusion_matrix/0.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 455399 KiB |  13219 MiB | 657636 GiB | 657635 GiB |
|       from large pool | 414803 KiB |  13181 MiB | 649812 GiB | 649811 GiB |
|       from small pool |  40595 KiB |     60 MiB |   7824 GiB |   7824 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 455399 KiB |  13219 MiB | 657636 GiB | 657635 GiB |
|       from large pool | 414803 KiB |  13181 MiB | 649812 GiB | 649811 GiB |
|       from small pool |  40595 KiB |     60 MiB |   7824 GiB |   7824 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 447481 KiB |  13213 MiB | 656703 GiB | 656703 GiB |
|       from large pool | 407075 KiB |  13175 MiB | 648896 GiB | 648895 GiB |
|       from small pool |  40406 KiB |     60 MiB |   7807 GiB |   7807 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  14478 MiB |  14482 MiB | 123230 MiB | 108752 MiB |
|       from large pool |  14412 MiB |  14412 MiB | 123034 MiB | 108622 MiB |
|       from small pool |     66 MiB |     70 MiB |    196 MiB |    130 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 445721 KiB |   1236 MiB | 460085 GiB | 460085 GiB |
|       from large pool | 435116 KiB |   1229 MiB | 452213 GiB | 452212 GiB |
|       from small pool |  10604 KiB |     47 MiB |   7872 GiB |   7872 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    1304    |    2598    |  116335 K  |  116334 K  |
|       from large pool |     187    |    1413    |   59158 K  |   59157 K  |
|       from small pool |    1117    |    1419    |   57177 K  |   57176 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    1304    |    2598    |  116335 K  |  116334 K  |
|       from large pool |     187    |    1413    |   59158 K  |   59157 K  |
|       from small pool |    1117    |    1419    |   57177 K  |   57176 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     635    |     637    |    5218    |    4583    |
|       from large pool |     602    |     602    |    5120    |    4518    |
|       from small pool |      33    |      35    |      98    |      65    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     100    |     654    |   78765 K  |   78765 K  |
|       from large pool |      38    |     605    |   45365 K  |   45365 K  |
|       from small pool |      62    |     236    |   33399 K  |   33399 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13219 MiB | 657636 GiB | 657636 GiB |
|       from large pool |  16640 KiB |  13181 MiB | 649812 GiB | 649812 GiB |
|       from small pool |      0 KiB |     60 MiB |   7824 GiB |   7824 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13219 MiB | 657636 GiB | 657636 GiB |
|       from large pool |  16640 KiB |  13181 MiB | 649812 GiB | 649812 GiB |
|       from small pool |      0 KiB |     60 MiB |   7824 GiB |   7824 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13213 MiB | 656703 GiB | 656703 GiB |
|       from large pool |  16640 KiB |  13175 MiB | 648896 GiB | 648896 GiB |
|       from small pool |      0 KiB |     60 MiB |   7807 GiB |   7807 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    880 MiB |  14482 MiB | 123230 MiB | 122350 MiB |
|       from large pool |    830 MiB |  14412 MiB | 123034 MiB | 122204 MiB |
|       from small pool |     50 MiB |     70 MiB |    196 MiB |    146 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1236 MiB | 460085 GiB | 460085 GiB |
|       from large pool |  24320 KiB |   1229 MiB | 452213 GiB | 452213 GiB |
|       from small pool |      0 KiB |     47 MiB |   7872 GiB |   7872 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    2598    |  116335 K  |  116335 K  |
|       from large pool |       2    |    1413    |   59158 K  |   59158 K  |
|       from small pool |       0    |    1419    |   57177 K  |   57177 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    2598    |  116335 K  |  116335 K  |
|       from large pool |       2    |    1413    |   59158 K  |   59158 K  |
|       from small pool |       0    |    1419    |   57177 K  |   57177 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      62    |     637    |    5218    |    5156    |
|       from large pool |      37    |     602    |    5120    |    5083    |
|       from small pool |      25    |      35    |      98    |      73    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |     654    |   78765 K  |   78765 K  |
|       from large pool |       4    |     605    |   45365 K  |   45365 K  |
|       from small pool |       0    |     236    |   33399 K  |   33399 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13219 MiB | 657636 GiB | 657636 GiB |
|       from large pool |  16640 KiB |  13181 MiB | 649812 GiB | 649812 GiB |
|       from small pool |      0 KiB |     60 MiB |   7824 GiB |   7824 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13219 MiB | 657636 GiB | 657636 GiB |
|       from large pool |  16640 KiB |  13181 MiB | 649812 GiB | 649812 GiB |
|       from small pool |      0 KiB |     60 MiB |   7824 GiB |   7824 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13213 MiB | 656703 GiB | 656703 GiB |
|       from large pool |  16640 KiB |  13175 MiB | 648896 GiB | 648896 GiB |
|       from small pool |      0 KiB |     60 MiB |   7807 GiB |   7807 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    880 MiB |  14482 MiB | 123230 MiB | 122350 MiB |
|       from large pool |    830 MiB |  14412 MiB | 123034 MiB | 122204 MiB |
|       from small pool |     50 MiB |     70 MiB |    196 MiB |    146 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1236 MiB | 460085 GiB | 460085 GiB |
|       from large pool |  24320 KiB |   1229 MiB | 452213 GiB | 452213 GiB |
|       from small pool |      0 KiB |     47 MiB |   7872 GiB |   7872 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    2598    |  116335 K  |  116335 K  |
|       from large pool |       2    |    1413    |   59158 K  |   59158 K  |
|       from small pool |       0    |    1419    |   57177 K  |   57177 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    2598    |  116335 K  |  116335 K  |
|       from large pool |       2    |    1413    |   59158 K  |   59158 K  |
|       from small pool |       0    |    1419    |   57177 K  |   57177 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      62    |     637    |    5218    |    5156    |
|       from large pool |      37    |     602    |    5120    |    5083    |
|       from small pool |      25    |      35    |      98    |      73    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |     654    |   78765 K  |   78765 K  |
|       from large pool |       4    |     605    |   45365 K  |   45365 K  |
|       from small pool |       0    |     236    |   33399 K  |   33399 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'888c1ef2'
model name: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_11_36_56_seed_9_23065779

 Experiment start at: 2024-07-26 11:36:56.261617
before training, model accuracy: 0.49782606959342957
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9443717, 'precision': 0.94633913, 'recall': 0.94459635, 'specificity': 0.94459635, 'f1': 0.9443276, 'auroc': 0.99181855, 'binary_precision': 0.9776536, 'binary_recall': 0.9102731, 'binary_specificity': 0.9789196, 'binary_f1_score': 0.94276094}
confusion matrix:
      0     1
0  1486    32
1   138  1400
---- Validation: 
scalar performance:
{'acc': 0.84092665, 'precision': 0.8547548, 'recall': 0.83993375, 'specificity': 0.83993375, 'f1': 0.8390726, 'auroc': 0.9182303, 'binary_precision': 0.9223301, 'binary_recall': 0.7410296, 'binary_specificity': 0.93883795, 'binary_f1_score': 0.8217993}
confusion matrix:
     0    1
0  614   40
1  166  475
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.84130436, 'precision': 0.87092966, 'recall': 0.8413043, 'specificity': 0.8413043, 'f1': 0.8380711, 'auroc': 0.9146881, 'binary_precision': 0.9757576, 'binary_recall': 0.7, 'binary_specificity': 0.9826087, 'binary_f1_score': 0.81518984}
confusion matrix:
     0    1
0  226    4
1   69  161
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-26 11:38:29.225313,epoch time: 0:01:32.963696,used: 0:01:32.963696,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_11_36_56_seed_9_23065779
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.97316754, 'precision': 0.97347844, 'recall': 0.9730785, 'specificity': 0.9730785, 'f1': 0.9731579, 'auroc': 0.99710786, 'binary_precision': 0.9631512, 'binary_recall': 0.9844156, 'binary_specificity': 0.96174145, 'binary_f1_score': 0.9736674}
confusion matrix:
      0     1
0  1458    58
1    24  1516
---- Validation: 
scalar performance:
{'acc': 0.8648649, 'precision': 0.864952, 'recall': 0.864952, 'specificity': 0.864952, 'f1': 0.8648648, 'auroc': 0.9356701, 'binary_precision': 0.8562691, 'binary_recall': 0.87363493, 'binary_specificity': 0.8562691, 'binary_f1_score': 0.8648648}
confusion matrix:
     0    1
0  560   94
1   81  560
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8282609, 'precision': 0.82901347, 'recall': 0.8282609, 'specificity': 0.8282609, 'f1': 0.82816255, 'auroc': 0.89954627, 'binary_precision': 0.84474885, 'binary_recall': 0.8043478, 'binary_specificity': 0.8521739, 'binary_f1_score': 0.8240534}
confusion matrix:
     0    1
0  196   34
1   45  185
better model found
persisted
after epoch: 2,now: 2024-07-26 11:39:59.253375,epoch time: 0:01:30.028062,used: 0:03:02.991758,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_11_36_56_seed_9_23065779
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.96924084, 'precision': 0.9693447, 'recall': 0.9691927, 'specificity': 0.9691927, 'f1': 0.96923506, 'auroc': 0.99692845, 'binary_precision': 0.9640565, 'binary_recall': 0.9753247, 'binary_specificity': 0.9630607, 'binary_f1_score': 0.9696579}
confusion matrix:
      0     1
0  1460    56
1    38  1502
---- Validation: 
scalar performance:
{'acc': 0.7814672, 'precision': 0.7819623, 'recall': 0.7812358, 'specificity': 0.7812358, 'f1': 0.7812585, 'auroc': 0.85539126, 'binary_precision': 0.79153097, 'binary_recall': 0.75819033, 'binary_specificity': 0.80428135, 'binary_f1_score': 0.7745021}
confusion matrix:
     0    1
0  526  128
1  155  486
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8043478, 'precision': 0.8062234, 'recall': 0.8043478, 'specificity': 0.8043478, 'f1': 0.8040478, 'auroc': 0.889017, 'binary_precision': 0.7822581, 'binary_recall': 0.84347826, 'binary_specificity': 0.76521736, 'binary_f1_score': 0.8117155}
confusion matrix:
     0    1
0  176   54
1   36  194
early stop counter: 1
val acc:0.7814671993255615, best validation acc: 0.8648648858070374, corresponding to test acc:                         0.8282608985900879 / 0.841304361820221
after epoch: 3,now: 2024-07-26 11:41:28.792390,epoch time: 0:01:29.539015,used: 0:04:32.530773,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_11_36_56_seed_9_23065779
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.96433246, 'precision': 0.9662394, 'recall': 0.96457326, 'specificity': 0.96457326, 'f1': 0.9643074, 'auroc': 0.99750453, 'binary_precision': 0.99791086, 'binary_recall': 0.9311241, 'binary_specificity': 0.99802244, 'binary_f1_score': 0.9633613}
confusion matrix:
      0     1
0  1514     3
1   106  1433
---- Validation: 
scalar performance:
{'acc': 0.71196914, 'precision': 0.800935, 'recall': 0.7092189, 'specificity': 0.7092189, 'f1': 0.6872606, 'auroc': 0.90911806, 'binary_precision': 0.962069, 'binary_recall': 0.4352574, 'binary_specificity': 0.9831804, 'binary_f1_score': 0.5993555}
confusion matrix:
     0    1
0  643   11
1  362  279
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7847826, 'precision': 0.84954405, 'recall': 0.78478265, 'specificity': 0.78478265, 'f1': 0.7743299, 'auroc': 0.90686196, 'binary_precision': 1.0, 'binary_recall': 0.56956524, 'binary_specificity': 1.0, 'binary_f1_score': 0.7257618}
confusion matrix:
     0    1
0  230    0
1   99  131
early stop counter: 2
val acc:0.7119691371917725, best validation acc: 0.8648648858070374, corresponding to test acc:                         0.8282608985900879 / 0.841304361820221
after epoch: 4,now: 2024-07-26 11:42:58.835228,epoch time: 0:01:30.042838,used: 0:06:02.573611,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_11_36_56_seed_9_23065779
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.97938484, 'precision': 0.97964036, 'recall': 0.9794804, 'specificity': 0.9794804, 'f1': 0.97938406, 'auroc': 0.99878263, 'binary_precision': 0.9926569, 'binary_recall': 0.96621186, 'binary_specificity': 0.99274886, 'binary_f1_score': 0.9792559}
confusion matrix:
      0     1
0  1506    11
1    52  1487
---- Validation: 
scalar performance:
{'acc': 0.6972973, 'precision': 0.7905793, 'recall': 0.69442934, 'specificity': 0.69442934, 'f1': 0.6689414, 'auroc': 0.8889803, 'binary_precision': 0.95272726, 'binary_recall': 0.40873635, 'binary_specificity': 0.9801223, 'binary_f1_score': 0.5720524}
confusion matrix:
     0    1
0  641   13
1  379  262
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.67826086, 'precision': 0.7831832, 'recall': 0.67826086, 'specificity': 0.67826086, 'f1': 0.6454166, 'auroc': 0.9018904, 'binary_precision': 0.95555556, 'binary_recall': 0.37391305, 'binary_specificity': 0.9826087, 'binary_f1_score': 0.53749996}
confusion matrix:
     0   1
0  226   4
1  144  86
early stop counter: 3
val acc:0.6972972750663757, best validation acc: 0.8648648858070374, corresponding to test acc:                         0.8282608985900879 / 0.841304361820221
after epoch: 5,now: 2024-07-26 11:44:28.588033,epoch time: 0:01:29.752805,used: 0:07:32.326416,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_11_36_56_seed_9_23065779
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9826571, 'precision': 0.9828931, 'recall': 0.98273987, 'specificity': 0.98273987, 'f1': 0.9826565, 'auroc': 0.9990915, 'binary_precision': 0.9953302, 'binary_recall': 0.97009104, 'binary_specificity': 0.9953887, 'binary_f1_score': 0.9825486}
confusion matrix:
      0     1
0  1511     7
1    46  1492
---- Validation: 
scalar performance:
{'acc': 0.77837837, 'precision': 0.82376397, 'recall': 0.7764877, 'specificity': 0.7764877, 'f1': 0.7695114, 'auroc': 0.9288621, 'binary_precision': 0.9425, 'binary_recall': 0.5881435, 'binary_specificity': 0.9648318, 'binary_f1_score': 0.7243036}
confusion matrix:
     0    1
0  631   23
1  264  377
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7826087, 'precision': 0.83370537, 'recall': 0.7826087, 'specificity': 0.7826087, 'f1': 0.77395576, 'auroc': 0.9106616, 'binary_precision': 0.96428573, 'binary_recall': 0.5869565, 'binary_specificity': 0.9782609, 'binary_f1_score': 0.7297297}
confusion matrix:
     0    1
0  225    5
1   95  135
early stop counter: 4
val acc:0.7783783674240112, best validation acc: 0.8648648858070374, corresponding to test acc:                         0.8282608985900879 / 0.841304361820221
after epoch: 6,now: 2024-07-26 11:45:58.417345,epoch time: 0:01:29.829312,used: 0:09:02.155728,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_11_36_56_seed_9_23065779
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9859293, 'precision': 0.98593485, 'recall': 0.98595923, 'specificity': 0.98595923, 'f1': 0.9859292, 'auroc': 0.9988868, 'binary_precision': 0.99017036, 'binary_recall': 0.9818064, 'binary_specificity': 0.99011207, 'binary_f1_score': 0.9859706}
confusion matrix:
      0     1
0  1502    15
1    28  1511
---- Validation: 
scalar performance:
{'acc': 0.8316602, 'precision': 0.85435086, 'recall': 0.83038735, 'specificity': 0.83038735, 'f1': 0.8285289, 'auroc': 0.928094, 'binary_precision': 0.9415449, 'binary_recall': 0.7035881, 'binary_specificity': 0.9571865, 'binary_f1_score': 0.8053571}
confusion matrix:
     0    1
0  626   28
1  190  451
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8369565, 'precision': 0.86820143, 'recall': 0.8369565, 'specificity': 0.8369565, 'f1': 0.8334226, 'auroc': 0.9189414, 'binary_precision': 0.9754601, 'binary_recall': 0.6913043, 'binary_specificity': 0.9826087, 'binary_f1_score': 0.80916023}
confusion matrix:
     0    1
0  226    4
1   71  159
early stop counter: 5
val acc:0.8316602110862732, best validation acc: 0.8648648858070374, corresponding to test acc:                         0.8282608985900879 / 0.841304361820221
after epoch: 7,now: 2024-07-26 11:47:28.545015,epoch time: 0:01:30.127670,used: 0:10:32.283398,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_11_36_56_seed_9_23065779
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9806937, 'precision': 0.9807297, 'recall': 0.9807336, 'specificity': 0.9807336, 'f1': 0.9806937, 'auroc': 0.99876595, 'binary_precision': 0.98683345, 'binary_recall': 0.9746424, 'binary_specificity': 0.98682475, 'binary_f1_score': 0.9807}
confusion matrix:
      0     1
0  1498    20
1    39  1499
---- Validation: 
scalar performance:
{'acc': 0.8069498, 'precision': 0.8444836, 'recall': 0.8052868, 'specificity': 0.8052868, 'f1': 0.80094075, 'auroc': 0.9366338, 'binary_precision': 0.95571095, 'binary_recall': 0.6396256, 'binary_specificity': 0.97094804, 'binary_f1_score': 0.76635516}
confusion matrix:
     0    1
0  635   19
1  231  410
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7673913, 'precision': 0.837791, 'recall': 0.7673913, 'specificity': 0.7673913, 'f1': 0.75460553, 'auroc': 0.9282608, 'binary_precision': 0.992, 'binary_recall': 0.53913045, 'binary_specificity': 0.9956522, 'binary_f1_score': 0.69859153}
confusion matrix:
     0    1
0  229    1
1  106  124
early stop counter: 6
val acc:0.80694979429245, best validation acc: 0.8648648858070374, corresponding to test acc:                         0.8282608985900879 / 0.841304361820221
after epoch: 8,now: 2024-07-26 11:48:58.550098,epoch time: 0:01:30.005083,used: 0:12:02.288481,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_11_36_56_seed_9_23065779
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.96629584, 'precision': 0.96798086, 'recall': 0.9665226, 'specificity': 0.9665226, 'f1': 0.9662755, 'auroc': 0.99832654, 'binary_precision': 0.99791956, 'binary_recall': 0.9350228, 'binary_specificity': 0.99802244, 'binary_f1_score': 0.96544784}
confusion matrix:
      0     1
0  1514     3
1   100  1439
---- Validation: 
scalar performance:
{'acc': 0.77220076, 'precision': 0.8277137, 'recall': 0.77012336, 'specificity': 0.77012336, 'f1': 0.7611957, 'auroc': 0.9104992, 'binary_precision': 0.9601064, 'binary_recall': 0.56318253, 'binary_specificity': 0.9770642, 'binary_f1_score': 0.7099312}
confusion matrix:
     0    1
0  639   15
1  280  361
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7804348, 'precision': 0.847432, 'recall': 0.7804348, 'specificity': 0.7804348, 'f1': 0.7693137, 'auroc': 0.9218714, 'binary_precision': 1.0, 'binary_recall': 0.5608696, 'binary_specificity': 1.0, 'binary_f1_score': 0.718663}
confusion matrix:
     0    1
0  230    0
1  101  129
early stop counter: 7
val acc:0.7722007632255554, best validation acc: 0.8648648858070374, corresponding to test acc:                         0.8282608985900879 / 0.841304361820221
after epoch: 9,now: 2024-07-26 11:50:28.535729,epoch time: 0:01:29.985631,used: 0:13:32.274112,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_11_36_56_seed_9_23065779
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.98854715, 'precision': 0.9885433, 'recall': 0.9885677, 'specificity': 0.9885677, 'f1': 0.98854697, 'auroc': 0.9993061, 'binary_precision': 0.99150324, 'binary_recall': 0.985705, 'binary_specificity': 0.99143046, 'binary_f1_score': 0.98859566}
confusion matrix:
      0     1
0  1504    13
1    22  1517
---- Validation: 
scalar performance:
{'acc': 0.7899614, 'precision': 0.8203285, 'recall': 0.7884052, 'specificity': 0.7884052, 'f1': 0.78423333, 'auroc': 0.8979805, 'binary_precision': 0.9164786, 'binary_recall': 0.63338536, 'binary_specificity': 0.94342506, 'binary_f1_score': 0.7490775}
confusion matrix:
     0    1
0  617   37
1  235  406
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8630435, 'precision': 0.88181674, 'recall': 0.8630434, 'specificity': 0.8630434, 'f1': 0.86133903, 'auroc': 0.9253875, 'binary_precision': 0.96648043, 'binary_recall': 0.7521739, 'binary_specificity': 0.973913, 'binary_f1_score': 0.84596574}
confusion matrix:
     0    1
0  224    6
1   57  173
new oracle model saved
early stop counter: 8
val acc:0.7899613976478577, best validation acc: 0.8648648858070374, corresponding to test acc:                         0.8282608985900879 / 0.863043487071991
after epoch: 10,now: 2024-07-26 11:51:58.560098,epoch time: 0:01:30.024369,used: 0:15:02.298481,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_11_36_56_seed_9_23065779
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.986911, 'precision': 0.9869987, 'recall': 0.98696613, 'specificity': 0.98696613, 'f1': 0.986911, 'auroc': 0.9995961, 'binary_precision': 0.9953704, 'binary_recall': 0.9785436, 'binary_specificity': 0.9953887, 'binary_f1_score': 0.9868853}
confusion matrix:
      0     1
0  1511     7
1    33  1505
---- Validation: 
scalar performance:
{'acc': 0.8015444, 'precision': 0.8411766, 'recall': 0.7998266, 'specificity': 0.7998266, 'f1': 0.79496384, 'auroc': 0.9379022, 'binary_precision': 0.9549763, 'binary_recall': 0.62870514, 'binary_specificity': 0.97094804, 'binary_f1_score': 0.75823146}
confusion matrix:
     0    1
0  635   19
1  238  403
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8282609, 'precision': 0.85869944, 'recall': 0.8282609, 'specificity': 0.8282609, 'f1': 0.8245385, 'auroc': 0.9153687, 'binary_precision': 0.9631902, 'binary_recall': 0.6826087, 'binary_specificity': 0.973913, 'binary_f1_score': 0.7989822}
confusion matrix:
     0    1
0  224    6
1   73  157
early stop counter: 9
val acc:0.8015444278717041, best validation acc: 0.8648648858070374, corresponding to test acc:                         0.8282608985900879 / 0.863043487071991
after epoch: 11,now: 2024-07-26 11:53:28.839382,epoch time: 0:01:30.279284,used: 0:16:32.577765,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_11_36_56_seed_9_23065779
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9882199, 'precision': 0.98825216, 'recall': 0.98819864, 'specificity': 0.98819864, 'f1': 0.9882186, 'auroc': 0.999462, 'binary_precision': 0.9857881, 'binary_recall': 0.9909091, 'binary_specificity': 0.9854881, 'binary_f1_score': 0.988342}
confusion matrix:
      0     1
0  1494    22
1    14  1526
---- Validation: 
scalar performance:
{'acc': 0.85559845, 'precision': 0.8571523, 'recall': 0.8552661, 'specificity': 0.8552661, 'f1': 0.8553469, 'auroc': 0.91949457, 'binary_precision': 0.87833333, 'binary_recall': 0.8221529, 'binary_specificity': 0.8883792, 'binary_f1_score': 0.8493151}
confusion matrix:
     0    1
0  581   73
1  114  527
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8630435, 'precision': 0.86671054, 'recall': 0.8630435, 'specificity': 0.8630435, 'f1': 0.8627002, 'auroc': 0.9222684, 'binary_precision': 0.90338165, 'binary_recall': 0.8130435, 'binary_specificity': 0.9130435, 'binary_f1_score': 0.8558352}
confusion matrix:
     0    1
0  210   20
1   43  187
early stop counter: 10
val acc:0.8555984497070312, best validation acc: 0.8648648858070374, corresponding to test acc:                         0.8282608985900879 / 0.863043487071991
after epoch: 12,now: 2024-07-26 11:54:58.829576,epoch time: 0:01:29.990194,used: 0:18:02.567959,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_11_36_56_seed_9_23065779
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9921466, 'precision': 0.99216366, 'recall': 0.9921839, 'specificity': 0.9921839, 'f1': 0.9921466, 'auroc': 0.999683, 'binary_precision': 0.9973736, 'binary_recall': 0.9870046, 'binary_specificity': 0.9973632, 'binary_f1_score': 0.99216205}
confusion matrix:
      0     1
0  1513     4
1    20  1519
---- Validation: 
scalar performance:
{'acc': 0.78069496, 'precision': 0.82345414, 'recall': 0.7788588, 'specificity': 0.7788588, 'f1': 0.77241564, 'auroc': 0.9143659, 'binary_precision': 0.9385749, 'binary_recall': 0.5959438, 'binary_specificity': 0.9617737, 'binary_f1_score': 0.7290076}
confusion matrix:
     0    1
0  629   25
1  259  382
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.75869566, 'precision': 0.8092586, 'recall': 0.7586956, 'specificity': 0.7586956, 'f1': 0.7484122, 'auroc': 0.89272213, 'binary_precision': 0.93430656, 'binary_recall': 0.5565217, 'binary_specificity': 0.96086955, 'binary_f1_score': 0.6975477}
confusion matrix:
     0    1
0  221    9
1  102  128
early stop counter: 11
val acc:0.7806949615478516, best validation acc: 0.8648648858070374, corresponding to test acc:                         0.8282608985900879 / 0.863043487071991
after epoch: 13,now: 2024-07-26 11:56:28.611818,epoch time: 0:01:29.782242,used: 0:19:32.350201,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_11_36_56_seed_9_23065779
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.98854715, 'precision': 0.9886513, 'recall': 0.988621, 'specificity': 0.988621, 'f1': 0.9885471, 'auroc': 0.9995717, 'binary_precision': 0.99801457, 'binary_recall': 0.9792208, 'binary_specificity': 0.9980211, 'binary_f1_score': 0.9885284}
confusion matrix:
      0     1
0  1513     3
1    32  1508
---- Validation: 
scalar performance:
{'acc': 0.7081081, 'precision': 0.80514455, 'recall': 0.7052567, 'specificity': 0.7052567, 'f1': 0.6810794, 'auroc': 0.9029207, 'binary_precision': 0.97472924, 'binary_recall': 0.42121685, 'binary_specificity': 0.9892966, 'binary_f1_score': 0.5882353}
confusion matrix:
     0    1
0  647    7
1  371  270
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6913043, 'precision': 0.798913, 'recall': 0.6913043, 'specificity': 0.6913043, 'f1': 0.660774, 'auroc': 0.9213611, 'binary_precision': 0.9782609, 'binary_recall': 0.39130434, 'binary_specificity': 0.99130434, 'binary_f1_score': 0.55900615}
confusion matrix:
     0   1
0  228   2
1  140  90
early stop counter: 12
val acc:0.708108127117157, best validation acc: 0.8648648858070374, corresponding to test acc:                         0.8282608985900879 / 0.863043487071991
after epoch: 14,now: 2024-07-26 11:57:58.688153,epoch time: 0:01:30.076335,used: 0:21:02.426536,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_11_36_56_seed_9_23065779
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.986911, 'precision': 0.9869987, 'recall': 0.98696613, 'specificity': 0.98696613, 'f1': 0.986911, 'auroc': 0.9991828, 'binary_precision': 0.9953704, 'binary_recall': 0.9785436, 'binary_specificity': 0.9953887, 'binary_f1_score': 0.9868853}
confusion matrix:
      0     1
0  1511     7
1    33  1505
---- Validation: 
scalar performance:
{'acc': 0.61235523, 'precision': 0.7547295, 'recall': 0.6085639, 'specificity': 0.6085639, 'f1': 0.5453967, 'auroc': 0.8929384, 'binary_precision': 0.9426752, 'binary_recall': 0.23088923, 'binary_specificity': 0.98623854, 'binary_f1_score': 0.3709273}
confusion matrix:
     0    1
0  645    9
1  493  148
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.526087, 'precision': 0.673454, 'recall': 0.526087, 'specificity': 0.526087, 'f1': 0.39828148, 'auroc': 0.9089792, 'binary_precision': 0.8333333, 'binary_recall': 0.06521739, 'binary_specificity': 0.98695654, 'binary_f1_score': 0.120967746}
confusion matrix:
     0   1
0  227   3
1  215  15
early stop counter: 13
val acc:0.6123552322387695, best validation acc: 0.8648648858070374, corresponding to test acc:                         0.8282608985900879 / 0.863043487071991
after epoch: 15,now: 2024-07-26 11:59:28.351022,epoch time: 0:01:29.662869,used: 0:22:32.089405,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_11_36_56_seed_9_23065779
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9878927, 'precision': 0.98801696, 'recall': 0.9879716, 'specificity': 0.9879716, 'f1': 0.9878926, 'auroc': 0.999689, 'binary_precision': 0.99801195, 'binary_recall': 0.9779221, 'binary_specificity': 0.9980211, 'binary_f1_score': 0.98786485}
confusion matrix:
      0     1
0  1513     3
1    34  1506
---- Validation: 
scalar performance:
{'acc': 0.6525096, 'precision': 0.7581052, 'recall': 0.64926505, 'specificity': 0.64926505, 'f1': 0.61012137, 'auroc': 0.912138, 'binary_precision': 0.92070484, 'binary_recall': 0.32605305, 'binary_specificity': 0.9724771, 'binary_f1_score': 0.48156682}
confusion matrix:
     0    1
0  636   18
1  432  209
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6956522, 'precision': 0.7834374, 'recall': 0.6956521, 'specificity': 0.6956521, 'f1': 0.67010903, 'auroc': 0.8887713, 'binary_precision': 0.9411765, 'binary_recall': 0.4173913, 'binary_specificity': 0.973913, 'binary_f1_score': 0.5783133}
confusion matrix:
     0   1
0  224   6
1  134  96
early stop counter: 14
val acc:0.6525096297264099, best validation acc: 0.8648648858070374, corresponding to test acc:                         0.8282608985900879 / 0.863043487071991
after epoch: 16,now: 2024-07-26 12:00:58.091819,epoch time: 0:01:29.740797,used: 0:24:01.830202,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_11_36_56_seed_9_23065779
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.98232985, 'precision': 0.98273623, 'recall': 0.98244673, 'specificity': 0.98244673, 'f1': 0.9823283, 'auroc': 0.99952286, 'binary_precision': 0.9986568, 'binary_recall': 0.96621186, 'binary_specificity': 0.9986816, 'binary_f1_score': 0.9821664}
confusion matrix:
      0     1
0  1515     2
1    52  1487
---- Validation: 
scalar performance:
{'acc': 0.7073359, 'precision': 0.79427004, 'recall': 0.70458525, 'specificity': 0.70458525, 'f1': 0.68223, 'auroc': 0.9093685, 'binary_precision': 0.9517241, 'binary_recall': 0.43057722, 'binary_specificity': 0.9785933, 'binary_f1_score': 0.5929108}
confusion matrix:
     0    1
0  640   14
1  365  276
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7826087, 'precision': 0.8310745, 'recall': 0.7826087, 'specificity': 0.7826087, 'f1': 0.7743505, 'auroc': 0.90803874, 'binary_precision': 0.9577465, 'binary_recall': 0.59130436, 'binary_specificity': 0.973913, 'binary_f1_score': 0.7311829}
confusion matrix:
     0    1
0  224    6
1   94  136
early stop counter: 15
val acc:0.707335889339447, best validation acc: 0.8648648858070374, corresponding to test acc:                         0.8282608985900879 / 0.863043487071991
after epoch: 17,now: 2024-07-26 12:02:28.045312,epoch time: 0:01:29.953493,used: 0:25:31.783695,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_11_36_56_seed_9_23065779
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.989856, 'precision': 0.989905, 'recall': 0.9899006, 'specificity': 0.9899006, 'f1': 0.989856, 'auroc': 0.99962264, 'binary_precision': 0.99670404, 'binary_recall': 0.98309493, 'binary_specificity': 0.9967062, 'binary_f1_score': 0.98985267}
confusion matrix:
      0     1
0  1513     5
1    26  1512
---- Validation: 
scalar performance:
{'acc': 0.66872585, 'precision': 0.7658278, 'recall': 0.6656612, 'specificity': 0.6656612, 'f1': 0.63300854, 'auroc': 0.8579818, 'binary_precision': 0.924, 'binary_recall': 0.36037442, 'binary_specificity': 0.97094804, 'binary_f1_score': 0.5185185}
confusion matrix:
     0    1
0  635   19
1  410  231
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6173913, 'precision': 0.7832512, 'recall': 0.6173913, 'specificity': 0.6173913, 'f1': 0.55177605, 'auroc': 0.9087335, 'binary_precision': 1.0, 'binary_recall': 0.2347826, 'binary_specificity': 1.0, 'binary_f1_score': 0.3802817}
confusion matrix:
     0   1
0  230   0
1  176  54
early stop counter: 16
val acc:0.668725848197937, best validation acc: 0.8648648858070374, corresponding to test acc:                         0.8282608985900879 / 0.863043487071991
after epoch: 18,now: 2024-07-26 12:03:57.982340,epoch time: 0:01:29.937028,used: 0:27:01.720723,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_11_36_56_seed_9_23065779
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.98920155, 'precision': 0.9891957, 'recall': 0.9892241, 'specificity': 0.9892241, 'f1': 0.9892013, 'auroc': 0.99949884, 'binary_precision': 0.992162, 'binary_recall': 0.98636365, 'binary_specificity': 0.99208444, 'binary_f1_score': 0.9892543}
confusion matrix:
      0     1
0  1504    12
1    21  1519
---- Validation: 
scalar performance:
{'acc': 0.81621623, 'precision': 0.836671, 'recall': 0.81497276, 'specificity': 0.81497276, 'f1': 0.81295484, 'auroc': 0.9084668, 'binary_precision': 0.9171843, 'binary_recall': 0.69110763, 'binary_specificity': 0.93883795, 'binary_f1_score': 0.7882562}
confusion matrix:
     0    1
0  614   40
1  198  443
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8043478, 'precision': 0.82989097, 'recall': 0.8043479, 'specificity': 0.8043479, 'f1': 0.80048573, 'auroc': 0.8784499, 'binary_precision': 0.92168677, 'binary_recall': 0.6652174, 'binary_specificity': 0.9434783, 'binary_f1_score': 0.77272725}
confusion matrix:
     0    1
0  217   13
1   77  153
early stop counter: 17
val acc:0.816216230392456, best validation acc: 0.8648648858070374, corresponding to test acc:                         0.8282608985900879 / 0.863043487071991
after epoch: 19,now: 2024-07-26 12:05:27.806218,epoch time: 0:01:29.823878,used: 0:28:31.544601,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_11_36_56_seed_9_23065779
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9895288, 'precision': 0.98954934, 'recall': 0.9895141, 'specificity': 0.9895141, 'f1': 0.98952794, 'auroc': 0.9994633, 'binary_precision': 0.98770225, 'binary_recall': 0.99155295, 'binary_specificity': 0.9874753, 'binary_f1_score': 0.98962384}
confusion matrix:
      0     1
0  1498    19
1    13  1526
---- Validation: 
scalar performance:
{'acc': 0.8378378, 'precision': 0.852911, 'recall': 0.8367982, 'specificity': 0.8367982, 'f1': 0.83577895, 'auroc': 0.90818477, 'binary_precision': 0.9233792, 'binary_recall': 0.73322934, 'binary_specificity': 0.940367, 'binary_f1_score': 0.8173913}
confusion matrix:
     0    1
0  615   39
1  171  470
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.85, 'precision': 0.8712281, 'recall': 0.85, 'specificity': 0.85, 'f1': 0.8478245, 'auroc': 0.9292061, 'binary_precision': 0.96, 'binary_recall': 0.7304348, 'binary_specificity': 0.9695652, 'binary_f1_score': 0.8296296}
confusion matrix:
     0    1
0  223    7
1   62  168
early stop counter: 18
val acc:0.837837815284729, best validation acc: 0.8648648858070374, corresponding to test acc:                         0.8282608985900879 / 0.863043487071991
after epoch: 20,now: 2024-07-26 12:06:58.488589,epoch time: 0:01:30.682371,used: 0:30:02.226972,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_11_36_56_seed_9_23065779
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.99051046, 'precision': 0.9905846, 'recall': 0.9905689, 'specificity': 0.9905689, 'f1': 0.99051046, 'auroc': 0.9996629, 'binary_precision': 0.998679, 'binary_recall': 0.98245615, 'binary_specificity': 0.9986816, 'binary_f1_score': 0.99050117}
confusion matrix:
      0     1
0  1515     2
1    27  1512
---- Validation: 
scalar performance:
{'acc': 0.66640925, 'precision': 0.7881013, 'recall': 0.66311955, 'specificity': 0.66311955, 'f1': 0.6244199, 'auroc': 0.9333563, 'binary_precision': 0.9728507, 'binary_recall': 0.33541343, 'binary_specificity': 0.9908257, 'binary_f1_score': 0.4988399}
confusion matrix:
     0    1
0  648    6
1  426  215
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5782609, 'precision': 0.73581684, 'recall': 0.5782609, 'specificity': 0.5782609, 'f1': 0.49369097, 'auroc': 0.90200377, 'binary_precision': 0.9285714, 'binary_recall': 0.16956522, 'binary_specificity': 0.98695654, 'binary_f1_score': 0.28676468}
confusion matrix:
     0   1
0  227   3
1  191  39
early stop counter: 19
val acc:0.6664092540740967, best validation acc: 0.8648648858070374, corresponding to test acc:                         0.8282608985900879 / 0.863043487071991
after epoch: 21,now: 2024-07-26 12:08:28.143923,epoch time: 0:01:29.655334,used: 0:31:31.882306,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_11_36_56_seed_9_23065779
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9928011, 'precision': 0.9927959, 'recall': 0.9928136, 'specificity': 0.9928136, 'f1': 0.99280095, 'auroc': 0.99942905, 'binary_precision': 0.9947781, 'binary_recall': 0.9908973, 'binary_specificity': 0.99472994, 'binary_f1_score': 0.9928339}
confusion matrix:
      0     1
0  1510     8
1    14  1524
---- Validation: 
scalar performance:
{'acc': 0.8007722, 'precision': 0.8352312, 'recall': 0.7991551, 'specificity': 0.7991551, 'f1': 0.7949068, 'auroc': 0.93492407, 'binary_precision': 0.9402299, 'binary_recall': 0.6380655, 'binary_specificity': 0.96024466, 'binary_f1_score': 0.76022303}
confusion matrix:
     0    1
0  628   26
1  232  409
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8021739, 'precision': 0.8449578, 'recall': 0.8021739, 'specificity': 0.8021739, 'f1': 0.7958437, 'auroc': 0.9251796, 'binary_precision': 0.96644294, 'binary_recall': 0.62608695, 'binary_specificity': 0.9782609, 'binary_f1_score': 0.7598945}
confusion matrix:
     0    1
0  225    5
1   86  144
early stop counter: 20
val acc:0.8007721900939941, best validation acc: 0.8648648858070374, corresponding to test acc:                         0.8282608985900879 / 0.863043487071991
after epoch: 22,now: 2024-07-26 12:09:57.979679,epoch time: 0:01:29.835756,used: 0:33:01.718062,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_11_36_56_seed_9_23065779
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.9872382, 'precision': 0.98735166, 'recall': 0.987197, 'specificity': 0.987197, 'f1': 0.98723614, 'auroc': 0.99952066, 'binary_precision': 0.98137444, 'binary_recall': 0.993498, 'binary_specificity': 0.98089594, 'binary_f1_score': 0.98739904}
confusion matrix:
      0     1
0  1489    29
1    10  1528
---- Validation: 
scalar performance:
{'acc': 0.87027025, 'precision': 0.87693214, 'recall': 0.869606, 'specificity': 0.869606, 'f1': 0.8695383, 'auroc': 0.946516, 'binary_precision': 0.9245961, 'binary_recall': 0.80343217, 'binary_specificity': 0.9357798, 'binary_f1_score': 0.8597663}
confusion matrix:
     0    1
0  612   42
1  126  515
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8086957, 'precision': 0.84881234, 'recall': 0.8086957, 'specificity': 0.8086957, 'f1': 0.8030323, 'auroc': 0.9097543, 'binary_precision': 0.96710527, 'binary_recall': 0.6391304, 'binary_specificity': 0.9782609, 'binary_f1_score': 0.7696334}
confusion matrix:
     0    1
0  225    5
1   83  147
better model found
persisted
after epoch: 23,now: 2024-07-26 12:11:28.081031,epoch time: 0:01:30.101352,used: 0:34:31.819414,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_11_36_56_seed_9_23065779
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.99018323, 'precision': 0.99022835, 'recall': 0.99015695, 'specificity': 0.99015695, 'f1': 0.99018204, 'auroc': 0.9996762, 'binary_precision': 0.9870968, 'binary_recall': 0.9935065, 'binary_specificity': 0.9868074, 'binary_f1_score': 0.9902913}
confusion matrix:
      0     1
0  1496    20
1    10  1530
---- Validation: 
scalar performance:
{'acc': 0.8084942, 'precision': 0.84465474, 'recall': 0.80686235, 'specificity': 0.80686235, 'f1': 0.8027496, 'auroc': 0.9309255, 'binary_precision': 0.95381063, 'binary_recall': 0.64430577, 'binary_specificity': 0.96941894, 'binary_f1_score': 0.76908755}
confusion matrix:
     0    1
0  634   20
1  228  413
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7782609, 'precision': 0.825981, 'recall': 0.7782608, 'specificity': 0.7782608, 'f1': 0.7698375, 'auroc': 0.905898, 'binary_precision': 0.9507042, 'binary_recall': 0.5869565, 'binary_specificity': 0.9695652, 'binary_f1_score': 0.7258064}
confusion matrix:
     0    1
0  223    7
1   95  135
early stop counter: 1
val acc:0.8084942102432251, best validation acc: 0.8702702522277832, corresponding to test acc:                         0.8086956739425659 / 0.863043487071991
after epoch: 24,now: 2024-07-26 12:12:58.138887,epoch time: 0:01:30.057856,used: 0:36:01.877270,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_11_36_56_seed_9_23065779
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.99018323, 'precision': 0.9901881, 'recall': 0.990178, 'specificity': 0.990178, 'f1': 0.99018264, 'auroc': 0.99966764, 'binary_precision': 0.9896171, 'binary_recall': 0.9909032, 'binary_specificity': 0.98945284, 'binary_f1_score': 0.99025977}
confusion matrix:
      0     1
0  1501    16
1    14  1525
---- Validation: 
scalar performance:
{'acc': 0.8756757, 'precision': 0.88932884, 'recall': 0.8747406, 'specificity': 0.8747406, 'f1': 0.87437046, 'auroc': 0.9489926, 'binary_precision': 0.95977014, 'binary_recall': 0.78159124, 'binary_specificity': 0.9678899, 'binary_f1_score': 0.86156493}
confusion matrix:
     0    1
0  633   21
1  140  501
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7543478, 'precision': 0.83157545, 'recall': 0.7543478, 'specificity': 0.7543478, 'f1': 0.7391597, 'auroc': 0.93459356, 'binary_precision': 0.99159664, 'binary_recall': 0.51304346, 'binary_specificity': 0.9956522, 'binary_f1_score': 0.6762178}
confusion matrix:
     0    1
0  229    1
1  112  118
better model found
persisted
after epoch: 25,now: 2024-07-26 12:14:27.839023,epoch time: 0:01:29.700136,used: 0:37:31.577406,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_11_36_56_seed_9_23065779
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9911649, 'precision': 0.9912296, 'recall': 0.9911338, 'specificity': 0.9911338, 'f1': 0.99116373, 'auroc': 0.99980295, 'binary_precision': 0.9871134, 'binary_recall': 0.99545157, 'binary_specificity': 0.9868161, 'binary_f1_score': 0.99126494}
confusion matrix:
      0     1
0  1497    20
1     7  1532
---- Validation: 
scalar performance:
{'acc': 0.850193, 'precision': 0.8706316, 'recall': 0.84901506, 'specificity': 0.84901506, 'f1': 0.8477814, 'auroc': 0.95087945, 'binary_precision': 0.95519346, 'binary_recall': 0.73166925, 'binary_specificity': 0.96636087, 'binary_f1_score': 0.82862186}
confusion matrix:
     0    1
0  632   22
1  172  469
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7673913, 'precision': 0.83127236, 'recall': 0.7673913, 'specificity': 0.7673913, 'f1': 0.7556095, 'auroc': 0.9111153, 'binary_precision': 0.9767442, 'binary_recall': 0.5478261, 'binary_specificity': 0.98695654, 'binary_f1_score': 0.7019499}
confusion matrix:
     0    1
0  227    3
1  104  126
early stop counter: 1
val acc:0.8501930236816406, best validation acc: 0.8756756782531738, corresponding to test acc:                         0.7543478012084961 / 0.863043487071991
after epoch: 26,now: 2024-07-26 12:15:57.414821,epoch time: 0:01:29.575798,used: 0:39:01.153204,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_11_36_56_seed_9_23065779
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.99345547, 'precision': 0.9934555, 'recall': 0.9934859, 'specificity': 0.9934859, 'f1': 0.9934554, 'auroc': 0.999701, 'binary_precision': 0.9973822, 'binary_recall': 0.9896104, 'binary_specificity': 0.9973615, 'binary_f1_score': 0.9934811}
confusion matrix:
      0     1
0  1512     4
1    16  1524
---- Validation: 
scalar performance:
{'acc': 0.7675676, 'precision': 0.82723504, 'recall': 0.7654122, 'specificity': 0.7654122, 'f1': 0.7554735, 'auroc': 0.939482, 'binary_precision': 0.9644809, 'binary_recall': 0.55070204, 'binary_specificity': 0.9801223, 'binary_f1_score': 0.7010923}
confusion matrix:
     0    1
0  641   13
1  288  353
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7695652, 'precision': 0.83556104, 'recall': 0.7695652, 'specificity': 0.7695652, 'f1': 0.7576493, 'auroc': 0.9356711, 'binary_precision': 0.984375, 'binary_recall': 0.5478261, 'binary_specificity': 0.99130434, 'binary_f1_score': 0.7039107}
confusion matrix:
     0    1
0  228    2
1  104  126
early stop counter: 2
val acc:0.7675675749778748, best validation acc: 0.8756756782531738, corresponding to test acc:                         0.7543478012084961 / 0.863043487071991
after epoch: 27,now: 2024-07-26 12:17:27.089195,epoch time: 0:01:29.674374,used: 0:40:30.827578,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_11_36_56_seed_9_23065779
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.98527485, 'precision': 0.98556316, 'recall': 0.9853754, 'specificity': 0.9853754, 'f1': 0.9852742, 'auroc': 0.9997349, 'binary_precision': 0.99933153, 'binary_recall': 0.97141004, 'binary_specificity': 0.99934083, 'binary_f1_score': 0.98517305}
confusion matrix:
      0     1
0  1516     1
1    44  1495
---- Validation: 
scalar performance:
{'acc': 0.5235521, 'precision': 0.7572777, 'recall': 0.51872075, 'specificity': 0.51872075, 'f1': 0.37583047, 'auroc': 0.92962307, 'binary_precision': 1.0, 'binary_recall': 0.037441496, 'binary_specificity': 1.0, 'binary_f1_score': 0.07218045}
confusion matrix:
     0   1
0  654   0
1  617  24
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5, 'precision': 0.25, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.33333334, 'auroc': 0.9292108, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
     0  1
0  230  0
1  230  0
early stop counter: 3
val acc:0.5235521197319031, best validation acc: 0.8756756782531738, corresponding to test acc:                         0.7543478012084961 / 0.863043487071991
after epoch: 28,now: 2024-07-26 12:18:57.078667,epoch time: 0:01:29.989472,used: 0:42:00.817050,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_11_36_56_seed_9_23065779
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9787304, 'precision': 0.9797255, 'recall': 0.97859025, 'specificity': 0.97859025, 'f1': 0.97871387, 'auroc': 0.9999281, 'binary_precision': 0.959451, 'binary_recall': 1.0, 'binary_specificity': 0.9571805, 'binary_f1_score': 0.979306}
confusion matrix:
      0     1
0  1453    65
1     0  1538
---- Validation: 
scalar performance:
{'acc': 0.82007724, 'precision': 0.82268846, 'recall': 0.81961715, 'specificity': 0.81961715, 'f1': 0.81955, 'auroc': 0.8857886, 'binary_precision': 0.84931505, 'binary_recall': 0.77379096, 'binary_specificity': 0.8654434, 'binary_f1_score': 0.8097959}
confusion matrix:
     0    1
0  566   88
1  145  496
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8521739, 'precision': 0.8668478, 'recall': 0.8521739, 'specificity': 0.8521739, 'f1': 0.8506807, 'auroc': 0.9328923, 'binary_precision': 0.9402174, 'binary_recall': 0.7521739, 'binary_specificity': 0.9521739, 'binary_f1_score': 0.8357488}
confusion matrix:
     0    1
0  219   11
1   57  173
early stop counter: 4
val acc:0.8200772404670715, best validation acc: 0.8756756782531738, corresponding to test acc:                         0.7543478012084961 / 0.863043487071991
after epoch: 29,now: 2024-07-26 12:20:27.080818,epoch time: 0:01:30.002151,used: 0:43:30.819201,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_11_36_56_seed_9_23065779
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.99051046, 'precision': 0.9905256, 'recall': 0.9904994, 'specificity': 0.9904994, 'f1': 0.9905098, 'auroc': 0.999668, 'binary_precision': 0.9889825, 'binary_recall': 0.99219763, 'binary_specificity': 0.98880106, 'binary_f1_score': 0.9905874}
confusion matrix:
      0     1
0  1501    17
1    12  1526
---- Validation: 
scalar performance:
{'acc': 0.6996139, 'precision': 0.7859388, 'recall': 0.69683146, 'specificity': 0.69683146, 'f1': 0.67322606, 'auroc': 0.9269532, 'binary_precision': 0.94055945, 'binary_recall': 0.41965678, 'binary_specificity': 0.9740061, 'binary_f1_score': 0.58036673}
confusion matrix:
     0    1
0  637   17
1  372  269
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.726087, 'precision': 0.8146044, 'recall': 0.726087, 'specificity': 0.726087, 'f1': 0.705362, 'auroc': 0.9216068, 'binary_precision': 0.9814815, 'binary_recall': 0.46086955, 'binary_specificity': 0.99130434, 'binary_f1_score': 0.6272189}
confusion matrix:
     0    1
0  228    2
1  124  106
early stop counter: 5
val acc:0.6996139287948608, best validation acc: 0.8756756782531738, corresponding to test acc:                         0.7543478012084961 / 0.863043487071991
after epoch: 30,now: 2024-07-26 12:21:56.376427,epoch time: 0:01:29.295609,used: 0:45:00.114810,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_11_36_56_seed_9_23065779
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 0:45:00.114810 at 2024-07-26 12:21:56.376427
persisted model performance metric: 

scalar performance:
{'acc': 0.7543478, 'precision': 0.83157545, 'recall': 0.7543478, 'specificity': 0.7543478, 'f1': 0.7391597, 'auroc': 0.93459356, 'binary_precision': 0.99159664, 'binary_recall': 0.51304346, 'binary_specificity': 0.9956522, 'binary_f1_score': 0.6762178}
confusion matrix:
     0    1
0  229    1
1  112  118
oracle model performance metric: 

scalar performance:
{'acc': 0.8630435, 'precision': 0.88181674, 'recall': 0.8630434, 'specificity': 0.8630434, 'f1': 0.86133903, 'auroc': 0.9253875, 'binary_precision': 0.96648043, 'binary_recall': 0.7521739, 'binary_specificity': 0.973913, 'binary_f1_score': 0.84596574}
confusion matrix:
     0    1
0  224    6
1   57  173
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_irm_10seeds_nofreeze_2024-07-26_02-28-54/rule_results/0.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_irm_10seeds_nofreeze_2024-07-26_02-28-54/confusion_matrix/0.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 455402 KiB |  13219 MiB | 734259 GiB | 734258 GiB |
|       from large pool | 414803 KiB |  13181 MiB | 725537 GiB | 725537 GiB |
|       from small pool |  40598 KiB |     60 MiB |   8721 GiB |   8721 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 455402 KiB |  13219 MiB | 734259 GiB | 734258 GiB |
|       from large pool | 414803 KiB |  13181 MiB | 725537 GiB | 725537 GiB |
|       from small pool |  40598 KiB |     60 MiB |   8721 GiB |   8721 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 447482 KiB |  13213 MiB | 733269 GiB | 733269 GiB |
|       from large pool | 407075 KiB |  13175 MiB | 724566 GiB | 724565 GiB |
|       from small pool |  40407 KiB |     60 MiB |   8703 GiB |   8703 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  14476 MiB |  14482 MiB | 136826 MiB | 122350 MiB |
|       from large pool |  14412 MiB |  14412 MiB | 136616 MiB | 122204 MiB |
|       from small pool |     64 MiB |     70 MiB |    210 MiB |    146 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 445718 KiB |   1236 MiB | 513295 GiB | 513294 GiB |
|       from large pool | 435116 KiB |   1229 MiB | 504519 GiB | 504518 GiB |
|       from small pool |  10601 KiB |     47 MiB |   8776 GiB |   8776 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    1310    |    2598    |  129759 K  |  129757 K  |
|       from large pool |     187    |    1413    |   66042 K  |   66042 K  |
|       from small pool |    1123    |    1419    |   63716 K  |   63715 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    1310    |    2598    |  129759 K  |  129757 K  |
|       from large pool |     187    |    1413    |   66042 K  |   66042 K  |
|       from small pool |    1123    |    1419    |   63716 K  |   63715 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     634    |     637    |    5790    |    5156    |
|       from large pool |     602    |     602    |    5685    |    5083    |
|       from small pool |      32    |      35    |     105    |      73    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      95    |     654    |   87977 K  |   87977 K  |
|       from large pool |      38    |     605    |   50599 K  |   50599 K  |
|       from small pool |      57    |     236    |   37378 K  |   37378 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13219 MiB | 734259 GiB | 734259 GiB |
|       from large pool |  16640 KiB |  13181 MiB | 725537 GiB | 725537 GiB |
|       from small pool |      0 KiB |     60 MiB |   8721 GiB |   8721 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13219 MiB | 734259 GiB | 734259 GiB |
|       from large pool |  16640 KiB |  13181 MiB | 725537 GiB | 725537 GiB |
|       from small pool |      0 KiB |     60 MiB |   8721 GiB |   8721 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13213 MiB | 733269 GiB | 733269 GiB |
|       from large pool |  16640 KiB |  13175 MiB | 724566 GiB | 724566 GiB |
|       from small pool |      0 KiB |     60 MiB |   8703 GiB |   8703 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    880 MiB |  14482 MiB | 136826 MiB | 135946 MiB |
|       from large pool |    830 MiB |  14412 MiB | 136616 MiB | 135786 MiB |
|       from small pool |     50 MiB |     70 MiB |    210 MiB |    160 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1236 MiB | 513295 GiB | 513295 GiB |
|       from large pool |  24320 KiB |   1229 MiB | 504519 GiB | 504519 GiB |
|       from small pool |      0 KiB |     47 MiB |   8776 GiB |   8776 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    2598    |  129759 K  |  129759 K  |
|       from large pool |       2    |    1413    |   66042 K  |   66042 K  |
|       from small pool |       0    |    1419    |   63716 K  |   63716 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    2598    |  129759 K  |  129759 K  |
|       from large pool |       2    |    1413    |   66042 K  |   66042 K  |
|       from small pool |       0    |    1419    |   63716 K  |   63716 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      62    |     637    |    5790    |    5728    |
|       from large pool |      37    |     602    |    5685    |    5648    |
|       from small pool |      25    |      35    |     105    |      80    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |     654    |   87978 K  |   87978 K  |
|       from large pool |       4    |     605    |   50599 K  |   50599 K  |
|       from small pool |       0    |     236    |   37378 K  |   37378 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Fri Jul 26 12:22:04 2024]
Finished job 0.
1 of 1 steps (100%) done
