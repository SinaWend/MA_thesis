Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Fri Jul 26 04:47:30 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_irm_10seeds_nofreeze_2024-07-26_02-28-54/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_irm_10seeds_nofreeze_2024-07-26_02-28-54/rule_results/1.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=1
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/swiglu_ffn.py:51: UserWarning: xFormers is not available (SwiGLU)
  warnings.warn("xFormers is not available (SwiGLU)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/attention.py:33: UserWarning: xFormers is not available (Attention)
  warnings.warn("xFormers is not available (Attention)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/block.py:40: UserWarning: xFormers is not available (Block)
  warnings.warn("xFormers is not available (Block)")
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'888c1ef2'
model name: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_04_48_08_seed_0_23065778

 Experiment start at: 2024-07-26 04:48:08.619607
before training, model accuracy: 0.569767415523529
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9534505, 'precision': 0.9536321, 'recall': 0.9536085, 'specificity': 0.9536085, 'f1': 0.95345044, 'auroc': 0.99028254, 'binary_precision': 0.9663144, 'binary_recall': 0.940836, 'binary_specificity': 0.966381, 'binary_f1_score': 0.953405}
confusion matrix:
      0     1
0  1466    51
1    92  1463
---- Validation: 
scalar performance:
{'acc': 0.82763976, 'precision': 0.83296955, 'recall': 0.8285177, 'specificity': 0.8285177, 'f1': 0.827186, 'auroc': 0.90972006, 'binary_precision': 0.78720444, 'binary_recall': 0.8913386, 'binary_specificity': 0.76569676, 'binary_f1_score': 0.83604133}
confusion matrix:
     0    1
0  500  153
1   69  566
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8116279, 'precision': 0.82113874, 'recall': 0.8116279, 'specificity': 0.8116279, 'f1': 0.8102228, 'auroc': 0.92774475, 'binary_precision': 0.765873, 'binary_recall': 0.89767444, 'binary_specificity': 0.7255814, 'binary_f1_score': 0.82655245}
confusion matrix:
     0    1
0  156   59
1   22  193
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-26 04:49:42.022361,epoch time: 0:01:33.402754,used: 0:01:33.402754,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_04_48_08_seed_0_23065778
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.95735675, 'precision': 0.95986116, 'recall': 0.95787096, 'specificity': 0.95787096, 'f1': 0.9573256, 'auroc': 0.9958688, 'binary_precision': 0.99720865, 'binary_recall': 0.91838044, 'binary_specificity': 0.9973615, 'binary_f1_score': 0.9561726}
confusion matrix:
      0     1
0  1512     4
1   127  1429
---- Validation: 
scalar performance:
{'acc': 0.66381985, 'precision': 0.7477327, 'recall': 0.65968454, 'specificity': 0.65968454, 'f1': 0.62930816, 'auroc': 0.8300925, 'binary_precision': 0.88846153, 'binary_recall': 0.36377952, 'binary_specificity': 0.9555896, 'binary_f1_score': 0.5162011}
confusion matrix:
     0    1
0  624   29
1  404  231
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7767442, 'precision': 0.8018452, 'recall': 0.7767442, 'specificity': 0.7767442, 'f1': 0.77200425, 'auroc': 0.8847593, 'binary_precision': 0.8888889, 'binary_recall': 0.63255817, 'binary_specificity': 0.9209302, 'binary_f1_score': 0.73913044}
confusion matrix:
     0    1
0  198   17
1   79  136
early stop counter: 1
val acc:0.6638198494911194, best validation acc: 0.8276397585868835, corresponding to test acc:                         0.8116279244422913 / 0.8116279244422913
after epoch: 2,now: 2024-07-26 04:51:09.256948,epoch time: 0:01:27.234587,used: 0:03:00.637341,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_04_48_08_seed_0_23065778
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9511719, 'precision': 0.95458215, 'recall': 0.9517363, 'specificity': 0.9517363, 'f1': 0.95111585, 'auroc': 0.9947871, 'binary_precision': 0.99716914, 'binary_recall': 0.90610933, 'binary_specificity': 0.9973632, 'binary_f1_score': 0.9494609}
confusion matrix:
      0     1
0  1513     4
1   146  1409
---- Validation: 
scalar performance:
{'acc': 0.6746894, 'precision': 0.7631244, 'recall': 0.67057794, 'specificity': 0.67057794, 'f1': 0.641667, 'auroc': 0.8241236, 'binary_precision': 0.91221374, 'binary_recall': 0.37637794, 'binary_specificity': 0.96477795, 'binary_f1_score': 0.5328874}
confusion matrix:
     0    1
0  630   23
1  396  239
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8, 'precision': 0.8403151, 'recall': 0.8, 'specificity': 0.8, 'f1': 0.79389596, 'auroc': 0.89996755, 'binary_precision': 0.9574468, 'binary_recall': 0.627907, 'binary_specificity': 0.97209305, 'binary_f1_score': 0.7584269}
confusion matrix:
     0    1
0  209    6
1   80  135
early stop counter: 2
val acc:0.6746894121170044, best validation acc: 0.8276397585868835, corresponding to test acc:                         0.8116279244422913 / 0.8116279244422913
after epoch: 3,now: 2024-07-26 04:52:36.193690,epoch time: 0:01:26.936742,used: 0:04:27.574083,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_04_48_08_seed_0_23065778
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9749349, 'precision': 0.9749547, 'recall': 0.9749094, 'specificity': 0.9749094, 'f1': 0.9749296, 'auroc': 0.9970431, 'binary_precision': 0.9737348, 'binary_recall': 0.97686374, 'binary_specificity': 0.97295517, 'binary_f1_score': 0.9752968}
confusion matrix:
      0     1
0  1475    41
1    36  1520
---- Validation: 
scalar performance:
{'acc': 0.70652175, 'precision': 0.73031735, 'recall': 0.7042071, 'specificity': 0.7042071, 'f1': 0.697199, 'auroc': 0.8116024, 'binary_precision': 0.80093676, 'binary_recall': 0.5385827, 'binary_specificity': 0.86983156, 'binary_f1_score': 0.64406776}
confusion matrix:
     0    1
0  568   85
1  293  342
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8465116, 'precision': 0.85088396, 'recall': 0.8465116, 'specificity': 0.8465116, 'f1': 0.846032, 'auroc': 0.92620873, 'binary_precision': 0.8117155, 'binary_recall': 0.9023256, 'binary_specificity': 0.7906977, 'binary_f1_score': 0.8546256}
confusion matrix:
     0    1
0  170   45
1   21  194
new oracle model saved
early stop counter: 3
val acc:0.70652174949646, best validation acc: 0.8276397585868835, corresponding to test acc:                         0.8116279244422913 / 0.8465116024017334
after epoch: 4,now: 2024-07-26 04:54:03.355987,epoch time: 0:01:27.162297,used: 0:05:54.736380,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_04_48_08_seed_0_23065778
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9827474, 'precision': 0.98276997, 'recall': 0.9827219, 'specificity': 0.9827219, 'f1': 0.9827433, 'auroc': 0.9988754, 'binary_precision': 0.98143405, 'binary_recall': 0.98458576, 'binary_specificity': 0.9808581, 'binary_f1_score': 0.9830073}
confusion matrix:
      0     1
0  1486    29
1    24  1533
---- Validation: 
scalar performance:
{'acc': 0.76552796, 'precision': 0.7671857, 'recall': 0.76604646, 'specificity': 0.76604646, 'f1': 0.7653644, 'auroc': 0.84118605, 'binary_precision': 0.7423581, 'binary_recall': 0.8031496, 'binary_specificity': 0.72894335, 'binary_f1_score': 0.7715583}
confusion matrix:
     0    1
0  476  177
1  125  510
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.82093024, 'precision': 0.830725, 'recall': 0.82093024, 'specificity': 0.82093024, 'f1': 0.8195945, 'auroc': 0.93743646, 'binary_precision': 0.77380955, 'binary_recall': 0.90697676, 'binary_specificity': 0.7348837, 'binary_f1_score': 0.83511776}
confusion matrix:
     0    1
0  158   57
1   20  195
early stop counter: 4
val acc:0.7655279636383057, best validation acc: 0.8276397585868835, corresponding to test acc:                         0.8116279244422913 / 0.8465116024017334
after epoch: 5,now: 2024-07-26 04:55:30.559507,epoch time: 0:01:27.203520,used: 0:07:21.939900,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_04_48_08_seed_0_23065778
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.98502606, 'precision': 0.9850422, 'recall': 0.98500764, 'specificity': 0.98500764, 'f1': 0.98502326, 'auroc': 0.99915004, 'binary_precision': 0.9839641, 'binary_recall': 0.9864952, 'binary_specificity': 0.9835201, 'binary_f1_score': 0.985228}
confusion matrix:
      0     1
0  1492    25
1    21  1534
---- Validation: 
scalar performance:
{'acc': 0.85636646, 'precision': 0.8592198, 'recall': 0.8557415, 'specificity': 0.8557415, 'f1': 0.85590357, 'auroc': 0.9184165, 'binary_precision': 0.88793105, 'binary_recall': 0.8110236, 'binary_specificity': 0.9004594, 'binary_f1_score': 0.8477366}
confusion matrix:
     0    1
0  588   65
1  120  515
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8581395, 'precision': 0.8594537, 'recall': 0.8581395, 'specificity': 0.8581395, 'f1': 0.85800976, 'auroc': 0.9289346, 'binary_precision': 0.8811881, 'binary_recall': 0.82790697, 'binary_specificity': 0.88837206, 'binary_f1_score': 0.853717}
confusion matrix:
     0    1
0  191   24
1   37  178
new oracle model saved
better model found
persisted
after epoch: 6,now: 2024-07-26 04:56:57.982970,epoch time: 0:01:27.423463,used: 0:08:49.363363,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_04_48_08_seed_0_23065778
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9720052, 'precision': 0.9728185, 'recall': 0.9723141, 'specificity': 0.9723141, 'f1': 0.9720018, 'auroc': 0.9975679, 'binary_precision': 0.9959514, 'binary_recall': 0.9485861, 'binary_specificity': 0.9960422, 'binary_f1_score': 0.9716919}
confusion matrix:
      0     1
0  1510     6
1    80  1476
---- Validation: 
scalar performance:
{'acc': 0.7864907, 'precision': 0.8288177, 'recall': 0.7839638, 'specificity': 0.7839638, 'f1': 0.77833897, 'auroc': 0.9239006, 'binary_precision': 0.9433498, 'binary_recall': 0.6031496, 'binary_specificity': 0.96477795, 'binary_f1_score': 0.73583096}
confusion matrix:
     0    1
0  630   23
1  252  383
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7813954, 'precision': 0.84789646, 'recall': 0.7813953, 'specificity': 0.7813953, 'f1': 0.77042437, 'auroc': 0.9535316, 'binary_precision': 1.0, 'binary_recall': 0.5627907, 'binary_specificity': 1.0, 'binary_f1_score': 0.7202381}
confusion matrix:
     0    1
0  215    0
1   94  121
early stop counter: 1
val acc:0.7864906787872314, best validation acc: 0.8563664555549622, corresponding to test acc:                         0.8581395149230957 / 0.8581395149230957
after epoch: 7,now: 2024-07-26 04:58:25.150246,epoch time: 0:01:27.167276,used: 0:10:16.530639,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_04_48_08_seed_0_23065778
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9788411, 'precision': 0.9791533, 'recall': 0.9787061, 'specificity': 0.9787061, 'f1': 0.97882986, 'auroc': 0.9984963, 'binary_precision': 0.9697543, 'binary_recall': 0.9890745, 'binary_specificity': 0.9683377, 'binary_f1_score': 0.9793191}
confusion matrix:
      0     1
0  1468    48
1    17  1539
---- Validation: 
scalar performance:
{'acc': 0.8214286, 'precision': 0.8213937, 'recall': 0.8213937, 'specificity': 0.8213937, 'f1': 0.82139367, 'auroc': 0.8912276, 'binary_precision': 0.81889766, 'binary_recall': 0.81889766, 'binary_specificity': 0.82388973, 'binary_f1_score': 0.81889766}
confusion matrix:
     0    1
0  538  115
1  115  520
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.82790697, 'precision': 0.83022153, 'recall': 0.82790697, 'specificity': 0.82790697, 'f1': 0.8276049, 'auroc': 0.91262305, 'binary_precision': 0.8025751, 'binary_recall': 0.8697674, 'binary_specificity': 0.7860465, 'binary_f1_score': 0.83482146}
confusion matrix:
     0    1
0  169   46
1   28  187
early stop counter: 2
val acc:0.8214285969734192, best validation acc: 0.8563664555549622, corresponding to test acc:                         0.8581395149230957 / 0.8581395149230957
after epoch: 8,now: 2024-07-26 04:59:52.300528,epoch time: 0:01:27.150282,used: 0:11:43.680921,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_04_48_08_seed_0_23065778
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9827474, 'precision': 0.98311025, 'recall': 0.98296916, 'specificity': 0.98296916, 'f1': 0.9827471, 'auroc': 0.9992933, 'binary_precision': 1.0, 'binary_recall': 0.9659383, 'binary_specificity': 1.0, 'binary_f1_score': 0.98267406}
confusion matrix:
      0     1
0  1516     0
1    53  1503
---- Validation: 
scalar performance:
{'acc': 0.79658383, 'precision': 0.82755005, 'recall': 0.794417, 'specificity': 0.794417, 'f1': 0.79080904, 'auroc': 0.91156024, 'binary_precision': 0.9248292, 'binary_recall': 0.6393701, 'binary_specificity': 0.949464, 'binary_f1_score': 0.7560522}
confusion matrix:
     0    1
0  620   33
1  229  406
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7953488, 'precision': 0.8516058, 'recall': 0.7953488, 'specificity': 0.7953488, 'f1': 0.7868217, 'auroc': 0.91863716, 'binary_precision': 0.99224806, 'binary_recall': 0.59534883, 'binary_specificity': 0.9953488, 'binary_f1_score': 0.74418604}
confusion matrix:
     0    1
0  214    1
1   87  128
early stop counter: 3
val acc:0.7965838313102722, best validation acc: 0.8563664555549622, corresponding to test acc:                         0.8581395149230957 / 0.8581395149230957
after epoch: 9,now: 2024-07-26 05:01:19.428897,epoch time: 0:01:27.128369,used: 0:13:10.809290,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_04_48_08_seed_0_23065778
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.98014325, 'precision': 0.9802327, 'recall': 0.98027974, 'specificity': 0.98027974, 'f1': 0.9801431, 'auroc': 0.9985553, 'binary_precision': 0.9908076, 'binary_recall': 0.96979433, 'binary_specificity': 0.99076515, 'binary_f1_score': 0.9801883}
confusion matrix:
      0     1
0  1502    14
1    47  1509
---- Validation: 
scalar performance:
{'acc': 0.8781056, 'precision': 0.88162255, 'recall': 0.87744147, 'specificity': 0.87744147, 'f1': 0.8776684, 'auroc': 0.9287311, 'binary_precision': 0.9149306, 'binary_recall': 0.82992125, 'binary_specificity': 0.9249617, 'binary_f1_score': 0.87035507}
confusion matrix:
     0    1
0  604   49
1  108  527
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8604651, 'precision': 0.8866996, 'recall': 0.8604651, 'specificity': 0.8604651, 'f1': 0.8580577, 'auroc': 0.9416333, 'binary_precision': 0.9874214, 'binary_recall': 0.73023254, 'binary_specificity': 0.9906977, 'binary_f1_score': 0.83957213}
confusion matrix:
     0    1
0  213    2
1   58  157
new oracle model saved
better model found
persisted
after epoch: 10,now: 2024-07-26 05:02:47.106958,epoch time: 0:01:27.678061,used: 0:14:38.487351,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_04_48_08_seed_0_23065778
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9873047, 'precision': 0.98733526, 'recall': 0.98744917, 'specificity': 0.98744917, 'f1': 0.9873042, 'auroc': 0.9993992, 'binary_precision': 0.99673414, 'binary_recall': 0.97820514, 'binary_specificity': 0.99669313, 'binary_f1_score': 0.9873827}
confusion matrix:
      0     1
0  1507     5
1    34  1526
---- Validation: 
scalar performance:
{'acc': 0.78493786, 'precision': 0.8313913, 'recall': 0.78230214, 'specificity': 0.78230214, 'f1': 0.77602035, 'auroc': 0.9169086, 'binary_precision': 0.9520202, 'binary_recall': 0.59370077, 'binary_specificity': 0.9709035, 'binary_f1_score': 0.7313287}
confusion matrix:
     0    1
0  634   19
1  258  377
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7976744, 'precision': 0.8528205, 'recall': 0.7976744, 'specificity': 0.7976744, 'f1': 0.789447, 'auroc': 0.9341482, 'binary_precision': 0.99230766, 'binary_recall': 0.6, 'binary_specificity': 0.9953488, 'binary_f1_score': 0.74782604}
confusion matrix:
     0    1
0  214    1
1   86  129
early stop counter: 1
val acc:0.784937858581543, best validation acc: 0.8781055808067322, corresponding to test acc:                         0.8604651093482971 / 0.8604651093482971
after epoch: 11,now: 2024-07-26 05:04:14.424829,epoch time: 0:01:27.317871,used: 0:16:05.805222,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_04_48_08_seed_0_23065778
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9905599, 'precision': 0.9905627, 'recall': 0.99055326, 'specificity': 0.99055326, 'f1': 0.9905579, 'auroc': 0.9993421, 'binary_precision': 0.99037844, 'binary_recall': 0.9910141, 'binary_specificity': 0.99009246, 'binary_f1_score': 0.9906962}
confusion matrix:
      0     1
0  1499    15
1    14  1544
---- Validation: 
scalar performance:
{'acc': 0.8439441, 'precision': 0.85990137, 'recall': 0.8424702, 'specificity': 0.8424702, 'f1': 0.84176934, 'auroc': 0.9259722, 'binary_precision': 0.93227094, 'binary_recall': 0.73700786, 'binary_specificity': 0.9479326, 'binary_f1_score': 0.82321894}
confusion matrix:
     0    1
0  619   34
1  167  468
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8534884, 'precision': 0.8668283, 'recall': 0.8534884, 'specificity': 0.8534884, 'f1': 0.8521441, 'auroc': 0.9256463, 'binary_precision': 0.9367816, 'binary_recall': 0.75813955, 'binary_specificity': 0.9488372, 'binary_f1_score': 0.83804625}
confusion matrix:
     0    1
0  204   11
1   52  163
early stop counter: 2
val acc:0.8439440727233887, best validation acc: 0.8781055808067322, corresponding to test acc:                         0.8604651093482971 / 0.8604651093482971
after epoch: 12,now: 2024-07-26 05:05:41.593127,epoch time: 0:01:27.168298,used: 0:17:32.973520,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_04_48_08_seed_0_23065778
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9921875, 'precision': 0.99216163, 'recall': 0.99223256, 'specificity': 0.99223256, 'f1': 0.99218655, 'auroc': 0.9996829, 'binary_precision': 0.99547803, 'binary_recall': 0.9890886, 'binary_specificity': 0.99537647, 'binary_f1_score': 0.99227303}
confusion matrix:
      0     1
0  1507     7
1    17  1541
---- Validation: 
scalar performance:
{'acc': 0.7958075, 'precision': 0.8299154, 'recall': 0.79354286, 'specificity': 0.79354286, 'f1': 0.7894974, 'auroc': 0.90291446, 'binary_precision': 0.9325581, 'binary_recall': 0.6314961, 'binary_specificity': 0.9555896, 'binary_f1_score': 0.7530516}
confusion matrix:
     0    1
0  624   29
1  234  401
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.89069766, 'precision': 0.9054418, 'recall': 0.89069766, 'specificity': 0.89069766, 'f1': 0.8896948, 'auroc': 0.9473012, 'binary_precision': 0.98275864, 'binary_recall': 0.7953488, 'binary_specificity': 0.9860465, 'binary_f1_score': 0.8791774}
confusion matrix:
     0    1
0  212    3
1   44  171
new oracle model saved
early stop counter: 3
val acc:0.7958074808120728, best validation acc: 0.8781055808067322, corresponding to test acc:                         0.8604651093482971 / 0.8906976580619812
after epoch: 13,now: 2024-07-26 05:07:09.198132,epoch time: 0:01:27.605005,used: 0:19:00.578525,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_04_48_08_seed_0_23065778
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9902344, 'precision': 0.9902207, 'recall': 0.990249, 'specificity': 0.990249, 'f1': 0.9902332, 'auroc': 0.99963164, 'binary_precision': 0.99161834, 'binary_recall': 0.9890675, 'binary_specificity': 0.99143046, 'binary_f1_score': 0.99034125}
confusion matrix:
      0     1
0  1504    13
1    17  1538
---- Validation: 
scalar performance:
{'acc': 0.8408385, 'precision': 0.8475193, 'recall': 0.83986324, 'specificity': 0.83986324, 'f1': 0.83977365, 'auroc': 0.9123802, 'binary_precision': 0.8923358, 'binary_recall': 0.7700787, 'binary_specificity': 0.90964776, 'binary_f1_score': 0.8267117}
confusion matrix:
     0    1
0  594   59
1  146  489
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8651163, 'precision': 0.8796023, 'recall': 0.86511624, 'specificity': 0.86511624, 'f1': 0.8638171, 'auroc': 0.93484044, 'binary_precision': 0.9537572, 'binary_recall': 0.76744187, 'binary_specificity': 0.96279067, 'binary_f1_score': 0.8505155}
confusion matrix:
     0    1
0  207    8
1   50  165
early stop counter: 4
val acc:0.8408384919166565, best validation acc: 0.8781055808067322, corresponding to test acc:                         0.8604651093482971 / 0.8906976580619812
after epoch: 14,now: 2024-07-26 05:08:36.529061,epoch time: 0:01:27.330929,used: 0:20:27.909454,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_04_48_08_seed_0_23065778
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.99088544, 'precision': 0.9908675, 'recall': 0.9909432, 'specificity': 0.9909432, 'f1': 0.9908848, 'auroc': 0.99947894, 'binary_precision': 0.99546045, 'binary_recall': 0.98650384, 'binary_specificity': 0.9953826, 'binary_f1_score': 0.9909619}
confusion matrix:
      0     1
0  1509     7
1    21  1535
---- Validation: 
scalar performance:
{'acc': 0.83618015, 'precision': 0.84081596, 'recall': 0.8353559, 'specificity': 0.8353559, 'f1': 0.8353583, 'auroc': 0.90957546, 'binary_precision': 0.8772242, 'binary_recall': 0.776378, 'binary_specificity': 0.89433384, 'binary_f1_score': 0.82372606}
confusion matrix:
     0    1
0  584   69
1  142  493
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.88372093, 'precision': 0.88492, 'recall': 0.88372093, 'specificity': 0.88372093, 'f1': 0.8836303, 'auroc': 0.9352082, 'binary_precision': 0.90640396, 'binary_recall': 0.855814, 'binary_specificity': 0.9116279, 'binary_f1_score': 0.8803828}
confusion matrix:
     0    1
0  196   19
1   31  184
early stop counter: 5
val acc:0.8361801505088806, best validation acc: 0.8781055808067322, corresponding to test acc:                         0.8604651093482971 / 0.8906976580619812
after epoch: 15,now: 2024-07-26 05:10:03.548951,epoch time: 0:01:27.019890,used: 0:21:54.929344,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_04_48_08_seed_0_23065778
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.99283856, 'precision': 0.9928299, 'recall': 0.9928458, 'specificity': 0.9928458, 'f1': 0.9928375, 'auroc': 0.9995926, 'binary_precision': 0.993565, 'binary_recall': 0.99228793, 'binary_specificity': 0.9934037, 'binary_f1_score': 0.9929261}
confusion matrix:
      0     1
0  1506    10
1    12  1544
---- Validation: 
scalar performance:
{'acc': 0.8416149, 'precision': 0.846733, 'recall': 0.84075916, 'specificity': 0.84075916, 'f1': 0.8407668, 'auroc': 0.91754353, 'binary_precision': 0.88550985, 'binary_recall': 0.77952754, 'binary_specificity': 0.90199083, 'binary_f1_score': 0.8291457}
confusion matrix:
     0    1
0  589   64
1  140  495
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.88837206, 'precision': 0.89608383, 'recall': 0.88837206, 'specificity': 0.88837206, 'f1': 0.8878261, 'auroc': 0.9430395, 'binary_precision': 0.95135134, 'binary_recall': 0.81860465, 'binary_specificity': 0.95813954, 'binary_f1_score': 0.88}
confusion matrix:
     0    1
0  206    9
1   39  176
early stop counter: 6
val acc:0.8416149020195007, best validation acc: 0.8781055808067322, corresponding to test acc:                         0.8604651093482971 / 0.8906976580619812
after epoch: 16,now: 2024-07-26 05:11:30.732411,epoch time: 0:01:27.183460,used: 0:23:22.112804,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_04_48_08_seed_0_23065778
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9869792, 'precision': 0.98718786, 'recall': 0.98688054, 'specificity': 0.98688054, 'f1': 0.98697376, 'auroc': 0.99947906, 'binary_precision': 0.979734, 'binary_recall': 0.9948553, 'binary_specificity': 0.97890574, 'binary_f1_score': 0.9872367}
confusion matrix:
      0     1
0  1485    32
1     8  1547
---- Validation: 
scalar performance:
{'acc': 0.8097826, 'precision': 0.8199409, 'recall': 0.8085191, 'specificity': 0.8085191, 'f1': 0.80779433, 'auroc': 0.89040285, 'binary_precision': 0.87356323, 'binary_recall': 0.71811026, 'binary_specificity': 0.89892805, 'binary_f1_score': 0.7882455}
confusion matrix:
     0    1
0  587   66
1  179  456
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.88837206, 'precision': 0.9008955, 'recall': 0.88837206, 'specificity': 0.88837206, 'f1': 0.88749343, 'auroc': 0.94239044, 'binary_precision': 0.9717514, 'binary_recall': 0.8, 'binary_specificity': 0.9767442, 'binary_f1_score': 0.877551}
confusion matrix:
     0    1
0  210    5
1   43  172
early stop counter: 7
val acc:0.8097826242446899, best validation acc: 0.8781055808067322, corresponding to test acc:                         0.8604651093482971 / 0.8906976580619812
after epoch: 17,now: 2024-07-26 05:12:57.848810,epoch time: 0:01:27.116399,used: 0:24:49.229203,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_04_48_08_seed_0_23065778
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9863281, 'precision': 0.98644876, 'recall': 0.98647845, 'specificity': 0.98647845, 'f1': 0.9863281, 'auroc': 0.9996469, 'binary_precision': 0.9980263, 'binary_recall': 0.9749357, 'binary_specificity': 0.9980211, 'binary_f1_score': 0.9863459}
confusion matrix:
      0     1
0  1513     3
1    39  1517
---- Validation: 
scalar performance:
{'acc': 0.7088509, 'precision': 0.79958194, 'recall': 0.70496315, 'specificity': 0.70496315, 'f1': 0.68250895, 'auroc': 0.91813314, 'binary_precision': 0.96099293, 'binary_recall': 0.42677164, 'binary_specificity': 0.98315465, 'binary_f1_score': 0.5910578}
confusion matrix:
     0    1
0  642   11
1  364  271
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7860465, 'precision': 0.85016286, 'recall': 0.7860465, 'specificity': 0.7860465, 'f1': 0.7757827, 'auroc': 0.9454624, 'binary_precision': 1.0, 'binary_recall': 0.572093, 'binary_specificity': 1.0, 'binary_f1_score': 0.7278106}
confusion matrix:
     0    1
0  215    0
1   92  123
early stop counter: 8
val acc:0.7088509202003479, best validation acc: 0.8781055808067322, corresponding to test acc:                         0.8604651093482971 / 0.8906976580619812
after epoch: 18,now: 2024-07-26 05:14:24.966126,epoch time: 0:01:27.117316,used: 0:26:16.346519,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_04_48_08_seed_0_23065778
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.99088544, 'precision': 0.9908701, 'recall': 0.9909675, 'specificity': 0.9909675, 'f1': 0.9908848, 'auroc': 0.99949086, 'binary_precision': 0.9967533, 'binary_recall': 0.9852375, 'binary_specificity': 0.9966975, 'binary_f1_score': 0.9909619}
confusion matrix:
      0     1
0  1509     5
1    23  1535
---- Validation: 
scalar performance:
{'acc': 0.75621116, 'precision': 0.8068259, 'recall': 0.7533419, 'specificity': 0.7533419, 'f1': 0.74429905, 'auroc': 0.88909876, 'binary_precision': 0.928, 'binary_recall': 0.5480315, 'binary_specificity': 0.9586524, 'binary_f1_score': 0.6891089}
confusion matrix:
     0    1
0  626   27
1  287  348
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.76744187, 'precision': 0.84126985, 'recall': 0.76744187, 'specificity': 0.76744187, 'f1': 0.75414526, 'auroc': 0.93094647, 'binary_precision': 1.0, 'binary_recall': 0.53488374, 'binary_specificity': 1.0, 'binary_f1_score': 0.6969697}
confusion matrix:
     0    1
0  215    0
1  100  115
early stop counter: 9
val acc:0.7562111616134644, best validation acc: 0.8781055808067322, corresponding to test acc:                         0.8604651093482971 / 0.8906976580619812
after epoch: 19,now: 2024-07-26 05:15:51.802627,epoch time: 0:01:26.836501,used: 0:27:43.183020,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_04_48_08_seed_0_23065778
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.96875, 'precision': 0.9702418, 'recall': 0.9691318, 'specificity': 0.9691318, 'f1': 0.96873885, 'auroc': 0.99913013, 'binary_precision': 1.0, 'binary_recall': 0.93826365, 'binary_specificity': 1.0, 'binary_f1_score': 0.96814865}
confusion matrix:
      0     1
0  1517     0
1    96  1459
---- Validation: 
scalar performance:
{'acc': 0.7468944, 'precision': 0.8175841, 'recall': 0.7435676, 'specificity': 0.7435676, 'f1': 0.73024344, 'auroc': 0.931903, 'binary_precision': 0.963964, 'binary_recall': 0.5055118, 'binary_specificity': 0.9816233, 'binary_f1_score': 0.66322315}
confusion matrix:
     0    1
0  641   12
1  314  321
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7116279, 'precision': 0.8171091, 'recall': 0.7116279, 'specificity': 0.7116279, 'f1': 0.68547225, 'auroc': 0.95130336, 'binary_precision': 1.0, 'binary_recall': 0.4232558, 'binary_specificity': 1.0, 'binary_f1_score': 0.5947712}
confusion matrix:
     0   1
0  215   0
1  124  91
early stop counter: 10
val acc:0.7468944191932678, best validation acc: 0.8781055808067322, corresponding to test acc:                         0.8604651093482971 / 0.8906976580619812
after epoch: 20,now: 2024-07-26 05:17:19.045663,epoch time: 0:01:27.243036,used: 0:29:10.426056,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_04_48_08_seed_0_23065778
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9840495, 'precision': 0.984475, 'recall': 0.98388994, 'specificity': 0.98388994, 'f1': 0.9840394, 'auroc': 0.9991076, 'binary_precision': 0.9730069, 'binary_recall': 0.99614394, 'binary_specificity': 0.9716359, 'binary_f1_score': 0.9844395}
confusion matrix:
      0     1
0  1473    43
1     6  1550
---- Validation: 
scalar performance:
{'acc': 0.8819876, 'precision': 0.88352036, 'recall': 0.8815521, 'specificity': 0.8815521, 'f1': 0.88176405, 'auroc': 0.92397296, 'binary_precision': 0.9045226, 'binary_recall': 0.8503937, 'binary_specificity': 0.91271055, 'binary_f1_score': 0.8766234}
confusion matrix:
     0    1
0  596   57
1   95  540
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.89069766, 'precision': 0.896958, 'recall': 0.89069766, 'specificity': 0.89069766, 'f1': 0.89026505, 'auroc': 0.9377177, 'binary_precision': 0.9468085, 'binary_recall': 0.82790697, 'binary_specificity': 0.95348835, 'binary_f1_score': 0.88337475}
confusion matrix:
     0    1
0  205   10
1   37  178
better model found
persisted
after epoch: 21,now: 2024-07-26 05:18:46.072546,epoch time: 0:01:27.026883,used: 0:30:37.452939,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_04_48_08_seed_0_23065778
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9869792, 'precision': 0.9872407, 'recall': 0.9868705, 'specificity': 0.9868705, 'f1': 0.98697346, 'auroc': 0.99959564, 'binary_precision': 0.97850823, 'binary_recall': 0.996139, 'binary_specificity': 0.9776021, 'binary_f1_score': 0.98724484}
confusion matrix:
      0     1
0  1484    34
1     6  1548
---- Validation: 
scalar performance:
{'acc': 0.8742236, 'precision': 0.8747556, 'recall': 0.87396026, 'specificity': 0.87396026, 'f1': 0.87410223, 'auroc': 0.9219465, 'binary_precision': 0.8858075, 'binary_recall': 0.8551181, 'binary_specificity': 0.8928025, 'binary_f1_score': 0.8701923}
confusion matrix:
     0    1
0  583   70
1   92  543
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.89534885, 'precision': 0.9026749, 'recall': 0.8953488, 'specificity': 0.8953488, 'f1': 0.8948707, 'auroc': 0.94730127, 'binary_precision': 0.9569892, 'binary_recall': 0.82790697, 'binary_specificity': 0.96279067, 'binary_f1_score': 0.8877806}
confusion matrix:
     0    1
0  207    8
1   37  178
new oracle model saved
early stop counter: 1
val acc:0.8742235898971558, best validation acc: 0.8819875717163086, corresponding to test acc:                         0.8906976580619812 / 0.895348846912384
after epoch: 22,now: 2024-07-26 05:20:13.131902,epoch time: 0:01:27.059356,used: 0:32:04.512295,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_04_48_08_seed_0_23065778
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.9941406, 'precision': 0.9941287, 'recall': 0.99419326, 'specificity': 0.99419326, 'f1': 0.9941404, 'auroc': 0.99978673, 'binary_precision': 0.9987013, 'binary_recall': 0.989704, 'binary_specificity': 0.9986825, 'binary_f1_score': 0.9941823}
confusion matrix:
      0     1
0  1516     2
1    16  1538
---- Validation: 
scalar performance:
{'acc': 0.8369565, 'precision': 0.8599081, 'recall': 0.83518827, 'specificity': 0.83518827, 'f1': 0.83378196, 'auroc': 0.92363775, 'binary_precision': 0.94736844, 'binary_recall': 0.70866144, 'binary_specificity': 0.96171516, 'binary_f1_score': 0.8108108}
confusion matrix:
     0    1
0  628   25
1  185  450
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.80465114, 'precision': 0.8455913, 'recall': 0.80465114, 'specificity': 0.80465114, 'f1': 0.7986892, 'auroc': 0.9298864, 'binary_precision': 0.964539, 'binary_recall': 0.63255817, 'binary_specificity': 0.9767442, 'binary_f1_score': 0.764045}
confusion matrix:
     0    1
0  210    5
1   79  136
early stop counter: 2
val acc:0.8369565010070801, best validation acc: 0.8819875717163086, corresponding to test acc:                         0.8906976580619812 / 0.895348846912384
after epoch: 23,now: 2024-07-26 05:21:40.197702,epoch time: 0:01:27.065800,used: 0:33:31.578095,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_04_48_08_seed_0_23065778
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.98795575, 'precision': 0.98801064, 'recall': 0.9880766, 'specificity': 0.9880766, 'f1': 0.98795563, 'auroc': 0.99929285, 'binary_precision': 0.9973805, 'binary_recall': 0.9787918, 'binary_specificity': 0.9973615, 'binary_f1_score': 0.9879987}
confusion matrix:
      0     1
0  1512     4
1    33  1523
---- Validation: 
scalar performance:
{'acc': 0.7243789, 'precision': 0.7933315, 'recall': 0.72094995, 'specificity': 0.72094995, 'f1': 0.7051402, 'auroc': 0.90669346, 'binary_precision': 0.93209875, 'binary_recall': 0.47559056, 'binary_specificity': 0.96630937, 'binary_f1_score': 0.62982273}
confusion matrix:
     0    1
0  631   22
1  333  302
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8372093, 'precision': 0.8699945, 'recall': 0.8372093, 'specificity': 0.8372093, 'f1': 0.83352137, 'auroc': 0.9384316, 'binary_precision': 0.98013246, 'binary_recall': 0.6883721, 'binary_specificity': 0.9860465, 'binary_f1_score': 0.8087432}
confusion matrix:
     0    1
0  212    3
1   67  148
early stop counter: 3
val acc:0.7243788838386536, best validation acc: 0.8819875717163086, corresponding to test acc:                         0.8906976580619812 / 0.895348846912384
after epoch: 24,now: 2024-07-26 05:23:07.230101,epoch time: 0:01:27.032399,used: 0:34:58.610494,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_04_48_08_seed_0_23065778
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.99609375, 'precision': 0.9961023, 'recall': 0.99608463, 'specificity': 0.99608463, 'f1': 0.99609303, 'auroc': 0.999961, 'binary_precision': 0.99550706, 'binary_recall': 0.99678665, 'binary_specificity': 0.9953826, 'binary_f1_score': 0.99614644}
confusion matrix:
      0     1
0  1509     7
1     5  1551
---- Validation: 
scalar performance:
{'acc': 0.8431677, 'precision': 0.8630408, 'recall': 0.8415309, 'specificity': 0.8415309, 'f1': 0.8405186, 'auroc': 0.9327537, 'binary_precision': 0.9445585, 'binary_recall': 0.72440946, 'binary_specificity': 0.9586524, 'binary_f1_score': 0.81996435}
confusion matrix:
     0    1
0  626   27
1  175  460
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.80697674, 'precision': 0.85489196, 'recall': 0.80697674, 'specificity': 0.80697674, 'f1': 0.80023396, 'auroc': 0.9434018, 'binary_precision': 0.9852941, 'binary_recall': 0.6232558, 'binary_specificity': 0.9906977, 'binary_f1_score': 0.76353276}
confusion matrix:
     0    1
0  213    2
1   81  134
early stop counter: 4
val acc:0.8431677222251892, best validation acc: 0.8819875717163086, corresponding to test acc:                         0.8906976580619812 / 0.895348846912384
after epoch: 25,now: 2024-07-26 05:24:34.585427,epoch time: 0:01:27.355326,used: 0:36:25.965820,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_04_48_08_seed_0_23065778
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9970703, 'precision': 0.9970508, 'recall': 0.9970995, 'specificity': 0.9970995, 'f1': 0.99706995, 'auroc': 0.9997227, 'binary_precision': 0.9993544, 'binary_recall': 0.9948586, 'binary_specificity': 0.99934036, 'binary_f1_score': 0.9971014}
confusion matrix:
      0     1
0  1515     1
1     8  1548
---- Validation: 
scalar performance:
{'acc': 0.70341617, 'precision': 0.7909112, 'recall': 0.6995382, 'specificity': 0.6995382, 'f1': 0.67673993, 'auroc': 0.91317666, 'binary_precision': 0.94699645, 'binary_recall': 0.42204726, 'binary_specificity': 0.9770291, 'binary_f1_score': 0.583878}
confusion matrix:
     0    1
0  638   15
1  367  268
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6418605, 'precision': 0.78361666, 'recall': 0.6418605, 'specificity': 0.6418605, 'f1': 0.59071916, 'auroc': 0.93128717, 'binary_precision': 0.984127, 'binary_recall': 0.2883721, 'binary_specificity': 0.9953488, 'binary_f1_score': 0.44604316}
confusion matrix:
     0   1
0  214   1
1  153  62
early stop counter: 5
val acc:0.7034161686897278, best validation acc: 0.8819875717163086, corresponding to test acc:                         0.8906976580619812 / 0.895348846912384
after epoch: 26,now: 2024-07-26 05:26:01.292522,epoch time: 0:01:26.707095,used: 0:37:52.672915,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_04_48_08_seed_0_23065778
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.9941406, 'precision': 0.99412274, 'recall': 0.994199, 'specificity': 0.994199, 'f1': 0.9941402, 'auroc': 0.99967015, 'binary_precision': 0.998703, 'binary_recall': 0.98971725, 'binary_specificity': 0.9986807, 'binary_f1_score': 0.99418986}
confusion matrix:
      0     1
0  1514     2
1    16  1540
---- Validation: 
scalar performance:
{'acc': 0.7795031, 'precision': 0.8291304, 'recall': 0.7767687, 'specificity': 0.7767687, 'f1': 0.76967967, 'auroc': 0.93022335, 'binary_precision': 0.95348835, 'binary_recall': 0.5811024, 'binary_specificity': 0.97243494, 'binary_f1_score': 0.7221135}
confusion matrix:
     0    1
0  635   18
1  266  369
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7255814, 'precision': 0.80959594, 'recall': 0.7255814, 'specificity': 0.7255814, 'f1': 0.7056093, 'auroc': 0.9312277, 'binary_precision': 0.9708738, 'binary_recall': 0.4651163, 'binary_specificity': 0.9860465, 'binary_f1_score': 0.6289308}
confusion matrix:
     0    1
0  212    3
1  115  100
early stop counter: 6
val acc:0.7795031070709229, best validation acc: 0.8819875717163086, corresponding to test acc:                         0.8906976580619812 / 0.895348846912384
after epoch: 27,now: 2024-07-26 05:27:28.249721,epoch time: 0:01:26.957199,used: 0:39:19.630114,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_04_48_08_seed_0_23065778
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.9947917, 'precision': 0.994839, 'recall': 0.9947551, 'specificity': 0.9947551, 'f1': 0.9947903, 'auroc': 0.99979484, 'binary_precision': 0.9923323, 'binary_recall': 0.997431, 'binary_specificity': 0.9920792, 'binary_f1_score': 0.9948751}
confusion matrix:
      0     1
0  1503    12
1     4  1553
---- Validation: 
scalar performance:
{'acc': 0.8408385, 'precision': 0.8614109, 'recall': 0.83916867, 'specificity': 0.83916867, 'f1': 0.8380503, 'auroc': 0.93310344, 'binary_precision': 0.9442149, 'binary_recall': 0.719685, 'binary_specificity': 0.9586524, 'binary_f1_score': 0.8168007}
confusion matrix:
     0    1
0  626   27
1  178  457
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8697674, 'precision': 0.89274144, 'recall': 0.8697674, 'specificity': 0.8697674, 'f1': 0.8678347, 'auroc': 0.9434289, 'binary_precision': 0.9877301, 'binary_recall': 0.74883723, 'binary_specificity': 0.9906977, 'binary_f1_score': 0.8518519}
confusion matrix:
     0    1
0  213    2
1   54  161
early stop counter: 7
val acc:0.8408384919166565, best validation acc: 0.8819875717163086, corresponding to test acc:                         0.8906976580619812 / 0.895348846912384
after epoch: 28,now: 2024-07-26 05:28:55.404442,epoch time: 0:01:27.154721,used: 0:40:46.784835,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_04_48_08_seed_0_23065778
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.98046875, 'precision': 0.9812721, 'recall': 0.98023653, 'specificity': 0.98023653, 'f1': 0.9804504, 'auroc': 0.999799, 'binary_precision': 0.9645963, 'binary_recall': 0.99807197, 'binary_specificity': 0.96240103, 'binary_f1_score': 0.98104864}
confusion matrix:
      0     1
0  1459    57
1     3  1553
---- Validation: 
scalar performance:
{'acc': 0.8835404, 'precision': 0.8835556, 'recall': 0.88347423, 'specificity': 0.88347423, 'f1': 0.8835064, 'auroc': 0.9286853, 'binary_precision': 0.8843106, 'binary_recall': 0.87874013, 'binary_specificity': 0.88820827, 'binary_f1_score': 0.8815166}
confusion matrix:
     0    1
0  580   73
1   77  558
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.89302325, 'precision': 0.8979825, 'recall': 0.89302325, 'specificity': 0.89302325, 'f1': 0.892689, 'auroc': 0.9324608, 'binary_precision': 0.9424084, 'binary_recall': 0.8372093, 'binary_specificity': 0.9488372, 'binary_f1_score': 0.8866995}
confusion matrix:
     0    1
0  204   11
1   35  180
better model found
persisted
after epoch: 29,now: 2024-07-26 05:30:22.182866,epoch time: 0:01:26.778424,used: 0:42:13.563259,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_04_48_08_seed_0_23065778
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.9905599, 'precision': 0.99060273, 'recall': 0.9906932, 'specificity': 0.9906932, 'f1': 0.99055964, 'auroc': 0.9998398, 'binary_precision': 1.0, 'binary_recall': 0.98138636, 'binary_specificity': 1.0, 'binary_f1_score': 0.9906057}
confusion matrix:
      0     1
0  1514     0
1    29  1529
---- Validation: 
scalar performance:
{'acc': 0.6708075, 'precision': 0.77186286, 'recall': 0.666489, 'specificity': 0.666489, 'f1': 0.63368934, 'auroc': 0.9132598, 'binary_precision': 0.93415636, 'binary_recall': 0.35748032, 'binary_specificity': 0.9754977, 'binary_f1_score': 0.51708424}
confusion matrix:
     0    1
0  637   16
1  408  227
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.66511625, 'precision': 0.7866667, 'recall': 0.6651163, 'specificity': 0.6651163, 'f1': 0.6254084, 'auroc': 0.9249216, 'binary_precision': 0.97333336, 'binary_recall': 0.33953488, 'binary_specificity': 0.9906977, 'binary_f1_score': 0.5034483}
confusion matrix:
     0   1
0  213   2
1  142  73
early stop counter: 1
val acc:0.6708074808120728, best validation acc: 0.8835403919219971, corresponding to test acc:                         0.8930232524871826 / 0.895348846912384
after epoch: 30,now: 2024-07-26 05:31:49.222470,epoch time: 0:01:27.039604,used: 0:43:40.602863,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_04_48_08_seed_0_23065778
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 0:43:40.602863 at 2024-07-26 05:31:49.222470
persisted model performance metric: 

scalar performance:
{'acc': 0.89302325, 'precision': 0.8979825, 'recall': 0.89302325, 'specificity': 0.89302325, 'f1': 0.892689, 'auroc': 0.9324608, 'binary_precision': 0.9424084, 'binary_recall': 0.8372093, 'binary_specificity': 0.9488372, 'binary_f1_score': 0.8866995}
confusion matrix:
     0    1
0  204   11
1   35  180
oracle model performance metric: 

scalar performance:
{'acc': 0.89534885, 'precision': 0.9026749, 'recall': 0.8953488, 'specificity': 0.8953488, 'f1': 0.8948707, 'auroc': 0.94730127, 'binary_precision': 0.9569892, 'binary_recall': 0.82790697, 'binary_specificity': 0.96279067, 'binary_f1_score': 0.8877806}
confusion matrix:
     0    1
0  207    8
1   37  178
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_irm_10seeds_nofreeze_2024-07-26_02-28-54/rule_results/1.csv
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_irm_10seeds_nofreeze_2024-07-26_02-28-54/rule_results/1.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_irm_10seeds_nofreeze_2024-07-26_02-28-54/confusion_matrix/1.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 455454 KiB |  13219 MiB |  73430 GiB |  73430 GiB |
|       from large pool | 414861 KiB |  13181 MiB |  72564 GiB |  72563 GiB |
|       from small pool |  40592 KiB |     56 MiB |    866 GiB |    866 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 455454 KiB |  13219 MiB |  73430 GiB |  73430 GiB |
|       from large pool | 414861 KiB |  13181 MiB |  72564 GiB |  72563 GiB |
|       from small pool |  40592 KiB |     56 MiB |    866 GiB |    866 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 447480 KiB |  13213 MiB |  72936 GiB |  72935 GiB |
|       from large pool | 407075 KiB |  13175 MiB |  72071 GiB |  72070 GiB |
|       from small pool |  40405 KiB |     56 MiB |    864 GiB |    864 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  14470 MiB |  14470 MiB |  14470 MiB |      0 B   |
|       from large pool |  14404 MiB |  14404 MiB |  14404 MiB |      0 B   |
|       from small pool |     66 MiB |     66 MiB |     66 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory | 474338 KiB |   1229 MiB |  51826 GiB |  51825 GiB |
|       from large pool | 461682 KiB |   1224 MiB |  50956 GiB |  50955 GiB |
|       from small pool |  12655 KiB |     17 MiB |    870 GiB |    870 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    1298    |    2594    |   12911 K  |   12909 K  |
|       from large pool |     187    |    1413    |    6569 K  |    6569 K  |
|       from small pool |    1111    |    1407    |    6341 K  |    6340 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    1298    |    2594    |   12911 K  |   12909 K  |
|       from large pool |     187    |    1413    |    6569 K  |    6569 K  |
|       from small pool |    1111    |    1407    |    6341 K  |    6340 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     634    |     634    |     634    |       0    |
|       from large pool |     601    |     601    |     601    |       0    |
|       from small pool |      33    |      33    |      33    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      98    |     650    |    8968 K  |    8968 K  |
|       from large pool |      39    |     600    |    5357 K  |    5357 K  |
|       from small pool |      59    |     234    |    3610 K  |    3610 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13219 MiB |  73430 GiB |  73430 GiB |
|       from large pool |  16640 KiB |  13181 MiB |  72564 GiB |  72564 GiB |
|       from small pool |      0 KiB |     56 MiB |    866 GiB |    866 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13219 MiB |  73430 GiB |  73430 GiB |
|       from large pool |  16640 KiB |  13181 MiB |  72564 GiB |  72564 GiB |
|       from small pool |      0 KiB |     56 MiB |    866 GiB |    866 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13213 MiB |  72936 GiB |  72936 GiB |
|       from large pool |  16640 KiB |  13175 MiB |  72071 GiB |  72071 GiB |
|       from small pool |      0 KiB |     56 MiB |    864 GiB |    864 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    908 MiB |  14470 MiB |  14470 MiB |  13562 MiB |
|       from large pool |    856 MiB |  14404 MiB |  14404 MiB |  13548 MiB |
|       from small pool |     52 MiB |     66 MiB |     66 MiB |     14 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1229 MiB |  51826 GiB |  51826 GiB |
|       from large pool |  24320 KiB |   1224 MiB |  50956 GiB |  50956 GiB |
|       from small pool |      0 KiB |     42 MiB |    870 GiB |    870 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    2594    |   12911 K  |   12911 K  |
|       from large pool |       2    |    1413    |    6569 K  |    6569 K  |
|       from small pool |       0    |    1407    |    6341 K  |    6341 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    2594    |   12911 K  |   12911 K  |
|       from large pool |       2    |    1413    |    6569 K  |    6569 K  |
|       from small pool |       0    |    1407    |    6341 K  |    6341 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      64    |     634    |     634    |     570    |
|       from large pool |      38    |     601    |     601    |     563    |
|       from small pool |      26    |      33    |      33    |       7    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |     650    |    8968 K  |    8968 K  |
|       from large pool |       4    |     600    |    5357 K  |    5357 K  |
|       from small pool |       0    |     234    |    3610 K  |    3610 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13219 MiB |  73430 GiB |  73430 GiB |
|       from large pool |  16640 KiB |  13181 MiB |  72564 GiB |  72564 GiB |
|       from small pool |      0 KiB |     56 MiB |    866 GiB |    866 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13219 MiB |  73430 GiB |  73430 GiB |
|       from large pool |  16640 KiB |  13181 MiB |  72564 GiB |  72564 GiB |
|       from small pool |      0 KiB |     56 MiB |    866 GiB |    866 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13213 MiB |  72936 GiB |  72936 GiB |
|       from large pool |  16640 KiB |  13175 MiB |  72071 GiB |  72071 GiB |
|       from small pool |      0 KiB |     56 MiB |    864 GiB |    864 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    908 MiB |  14470 MiB |  14470 MiB |  13562 MiB |
|       from large pool |    856 MiB |  14404 MiB |  14404 MiB |  13548 MiB |
|       from small pool |     52 MiB |     66 MiB |     66 MiB |     14 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1229 MiB |  51826 GiB |  51826 GiB |
|       from large pool |  24320 KiB |   1224 MiB |  50956 GiB |  50956 GiB |
|       from small pool |      0 KiB |     42 MiB |    870 GiB |    870 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    2594    |   12911 K  |   12911 K  |
|       from large pool |       2    |    1413    |    6569 K  |    6569 K  |
|       from small pool |       0    |    1407    |    6341 K  |    6341 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    2594    |   12911 K  |   12911 K  |
|       from large pool |       2    |    1413    |    6569 K  |    6569 K  |
|       from small pool |       0    |    1407    |    6341 K  |    6341 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      64    |     634    |     634    |     570    |
|       from large pool |      38    |     601    |     601    |     563    |
|       from small pool |      26    |      33    |      33    |       7    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |     650    |    8968 K  |    8968 K  |
|       from large pool |       4    |     600    |    5357 K  |    5357 K  |
|       from small pool |       0    |     234    |    3610 K  |    3610 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'888c1ef2'
model name: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_05_32_16_seed_1_23065778

 Experiment start at: 2024-07-26 05:32:16.083265
before training, model accuracy: 0.6177777647972107
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9554036, 'precision': 0.9576812, 'recall': 0.9559494, 'specificity': 0.9559494, 'f1': 0.9553771, 'auroc': 0.9911875, 'binary_precision': 0.9937457, 'binary_recall': 0.9178434, 'binary_specificity': 0.9940555, 'binary_f1_score': 0.95428765}
confusion matrix:
      0     1
0  1505     9
1   128  1430
---- Validation: 
scalar performance:
{'acc': 0.7876659, 'precision': 0.78919315, 'recall': 0.78701997, 'specificity': 0.78701997, 'f1': 0.78708345, 'auroc': 0.87591743, 'binary_precision': 0.8065069, 'binary_recall': 0.74761903, 'binary_specificity': 0.8264209, 'binary_f1_score': 0.7759473}
confusion matrix:
     0    1
0  538  113
1  159  471
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7977778, 'precision': 0.79849124, 'recall': 0.7977778, 'specificity': 0.7977778, 'f1': 0.7976568, 'auroc': 0.88122475, 'binary_precision': 0.7838983, 'binary_recall': 0.82222223, 'binary_specificity': 0.7733333, 'binary_f1_score': 0.80260295}
confusion matrix:
     0    1
0  174   51
1   40  185
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-26 05:33:48.393607,epoch time: 0:01:32.310342,used: 0:01:32.310342,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_05_32_16_seed_1_23065778
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9707031, 'precision': 0.97096646, 'recall': 0.9708746, 'specificity': 0.9708746, 'f1': 0.9707028, 'auroc': 0.99615806, 'binary_precision': 0.98541117, 'binary_recall': 0.95624197, 'binary_specificity': 0.98550725, 'binary_f1_score': 0.97060746}
confusion matrix:
      0     1
0  1496    22
1    68  1486
---- Validation: 
scalar performance:
{'acc': 0.79703355, 'precision': 0.7971548, 'recall': 0.7967998, 'specificity': 0.7967998, 'f1': 0.7968819, 'auroc': 0.8848926, 'binary_precision': 0.8003247, 'binary_recall': 0.78253967, 'binary_specificity': 0.8110599, 'binary_f1_score': 0.79133224}
confusion matrix:
     0    1
0  528  123
1  137  493
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8111111, 'precision': 0.8111664, 'recall': 0.8111111, 'specificity': 0.8111111, 'f1': 0.8111027, 'auroc': 0.900721, 'binary_precision': 0.80701756, 'binary_recall': 0.81777775, 'binary_specificity': 0.80444443, 'binary_f1_score': 0.812362}
confusion matrix:
     0    1
0  181   44
1   41  184
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-07-26 05:35:17.081203,epoch time: 0:01:28.687596,used: 0:03:00.997938,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_05_32_16_seed_1_23065778
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.97005206, 'precision': 0.97111416, 'recall': 0.9703608, 'specificity': 0.9703608, 'f1': 0.9700453, 'auroc': 0.99696183, 'binary_precision': 0.99660325, 'binary_recall': 0.94401544, 'binary_specificity': 0.9967062, 'binary_f1_score': 0.96959674}
confusion matrix:
      0     1
0  1513     5
1    87  1467
---- Validation: 
scalar performance:
{'acc': 0.7564403, 'precision': 0.79732347, 'recall': 0.75335383, 'specificity': 0.75335383, 'f1': 0.74622583, 'auroc': 0.8689269, 'binary_precision': 0.9035533, 'binary_recall': 0.5650794, 'binary_specificity': 0.9416283, 'binary_f1_score': 0.6953125}
confusion matrix:
     0    1
0  613   38
1  274  356
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.82, 'precision': 0.8210718, 'recall': 0.82, 'specificity': 0.82, 'f1': 0.8198496, 'auroc': 0.9012939, 'binary_precision': 0.8396226, 'binary_recall': 0.7911111, 'binary_specificity': 0.8488889, 'binary_f1_score': 0.8146453}
confusion matrix:
     0    1
0  191   34
1   47  178
new oracle model saved
early stop counter: 1
val acc:0.756440281867981, best validation acc: 0.7970335483551025, corresponding to test acc:                         0.8111110925674438 / 0.8199999928474426
after epoch: 3,now: 2024-07-26 05:36:45.702162,epoch time: 0:01:28.620959,used: 0:04:29.618897,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_05_32_16_seed_1_23065778
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9114583, 'precision': 0.92305315, 'recall': 0.91034675, 'specificity': 0.91034675, 'f1': 0.91067326, 'auroc': 0.99441636, 'binary_precision': 0.85635054, 'binary_recall': 0.9916506, 'binary_specificity': 0.8290429, 'binary_f1_score': 0.9190476}
confusion matrix:
      0     1
0  1256   259
1    13  1544
---- Validation: 
scalar performance:
{'acc': 0.84153, 'precision': 0.84718055, 'recall': 0.84257555, 'specificity': 0.84257555, 'f1': 0.8411335, 'auroc': 0.9237559, 'binary_precision': 0.7986014, 'binary_recall': 0.9063492, 'binary_specificity': 0.77880186, 'binary_f1_score': 0.8490706}
confusion matrix:
     0    1
0  507  144
1   59  571
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8488889, 'precision': 0.8491372, 'recall': 0.8488889, 'specificity': 0.8488889, 'f1': 0.848862, 'auroc': 0.9323259, 'binary_precision': 0.8398268, 'binary_recall': 0.8622222, 'binary_specificity': 0.83555555, 'binary_f1_score': 0.85087717}
confusion matrix:
     0    1
0  188   37
1   31  194
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-07-26 05:38:14.633317,epoch time: 0:01:28.931155,used: 0:05:58.550052,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_05_32_16_seed_1_23065778
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9313151, 'precision': 0.9387592, 'recall': 0.93218946, 'specificity': 0.93218946, 'f1': 0.9311066, 'auroc': 0.99722457, 'binary_precision': 0.9992576, 'binary_recall': 0.8650386, 'binary_specificity': 0.99934036, 'binary_f1_score': 0.9273166}
confusion matrix:
      0     1
0  1515     1
1   210  1346
---- Validation: 
scalar performance:
{'acc': 0.55737704, 'precision': 0.72198737, 'recall': 0.55017924, 'specificity': 0.55017924, 'f1': 0.44617972, 'auroc': 0.88641834, 'binary_precision': 0.90909094, 'binary_recall': 0.11111111, 'binary_specificity': 0.9892473, 'binary_f1_score': 0.1980198}
confusion matrix:
     0   1
0  644   7
1  560  70
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.72, 'precision': 0.8116169, 'recall': 0.72, 'specificity': 0.72, 'f1': 0.69778705, 'auroc': 0.9002272, 'binary_precision': 0.98058254, 'binary_recall': 0.4488889, 'binary_specificity': 0.9911111, 'binary_f1_score': 0.61585367}
confusion matrix:
     0    1
0  223    2
1  124  101
early stop counter: 1
val acc:0.5573770403862, best validation acc: 0.8415300250053406, corresponding to test acc:                         0.8488888740539551 / 0.8488888740539551
after epoch: 5,now: 2024-07-26 05:39:43.101495,epoch time: 0:01:28.468178,used: 0:07:27.018230,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_05_32_16_seed_1_23065778
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9791667, 'precision': 0.97953486, 'recall': 0.97940314, 'specificity': 0.97940314, 'f1': 0.9791663, 'auroc': 0.99898803, 'binary_precision': 0.99667335, 'binary_recall': 0.9621066, 'binary_specificity': 0.9966997, 'binary_f1_score': 0.97908497}
confusion matrix:
      0     1
0  1510     5
1    59  1498
---- Validation: 
scalar performance:
{'acc': 0.7712724, 'precision': 0.81346095, 'recall': 0.76822835, 'specificity': 0.76822835, 'f1': 0.76191175, 'auroc': 0.9030484, 'binary_precision': 0.92443323, 'binary_recall': 0.5825397, 'binary_specificity': 0.953917, 'binary_f1_score': 0.714703}
confusion matrix:
     0    1
0  621   30
1  263  367
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.81777775, 'precision': 0.83876264, 'recall': 0.81777775, 'specificity': 0.81777775, 'f1': 0.81491137, 'auroc': 0.90204936, 'binary_precision': 0.9230769, 'binary_recall': 0.6933333, 'binary_specificity': 0.94222224, 'binary_f1_score': 0.79187816}
confusion matrix:
     0    1
0  212   13
1   69  156
early stop counter: 2
val acc:0.7712724208831787, best validation acc: 0.8415300250053406, corresponding to test acc:                         0.8488888740539551 / 0.8488888740539551
after epoch: 6,now: 2024-07-26 05:41:11.993886,epoch time: 0:01:28.892391,used: 0:08:55.910621,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_05_32_16_seed_1_23065778
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.98079425, 'precision': 0.9809909, 'recall': 0.98098207, 'specificity': 0.98098207, 'f1': 0.9807943, 'auroc': 0.99817324, 'binary_precision': 0.994716, 'binary_recall': 0.9672447, 'binary_specificity': 0.99471945, 'binary_f1_score': 0.98078805}
confusion matrix:
      0     1
0  1507     8
1    51  1506
---- Validation: 
scalar performance:
{'acc': 0.77907884, 'precision': 0.81840813, 'recall': 0.7761649, 'specificity': 0.7761649, 'f1': 0.77076185, 'auroc': 0.8871455, 'binary_precision': 0.9262899, 'binary_recall': 0.5984127, 'binary_specificity': 0.953917, 'binary_f1_score': 0.7270974}
confusion matrix:
     0    1
0  621   30
1  253  377
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7911111, 'precision': 0.7913183, 'recall': 0.7911111, 'specificity': 0.7911111, 'f1': 0.79107404, 'auroc': 0.8783407, 'binary_precision': 0.79908675, 'binary_recall': 0.7777778, 'binary_specificity': 0.80444443, 'binary_f1_score': 0.78828835}
confusion matrix:
     0    1
0  181   44
1   50  175
early stop counter: 3
val acc:0.7790788412094116, best validation acc: 0.8415300250053406, corresponding to test acc:                         0.8488888740539551 / 0.8488888740539551
after epoch: 7,now: 2024-07-26 05:42:40.335432,epoch time: 0:01:28.341546,used: 0:10:24.252167,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_05_32_16_seed_1_23065778
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9749349, 'precision': 0.9755338, 'recall': 0.9752062, 'specificity': 0.9752062, 'f1': 0.97493327, 'auroc': 0.99910253, 'binary_precision': 0.99597585, 'binary_recall': 0.9543702, 'binary_specificity': 0.9960422, 'binary_f1_score': 0.9747293}
confusion matrix:
      0     1
0  1510     6
1    71  1485
---- Validation: 
scalar performance:
{'acc': 0.63700235, 'precision': 0.76083636, 'recall': 0.6312596, 'specificity': 0.6312596, 'f1': 0.58272654, 'auroc': 0.8928724, 'binary_precision': 0.93650794, 'binary_recall': 0.2809524, 'binary_specificity': 0.98156685, 'binary_f1_score': 0.43223444}
confusion matrix:
     0    1
0  639   12
1  453  177
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.77555555, 'precision': 0.8266673, 'recall': 0.7755556, 'specificity': 0.7755556, 'f1': 0.7664188, 'auroc': 0.8899555, 'binary_precision': 0.9558824, 'binary_recall': 0.5777778, 'binary_specificity': 0.97333336, 'binary_f1_score': 0.72022164}
confusion matrix:
     0    1
0  219    6
1   95  130
early stop counter: 4
val acc:0.6370023488998413, best validation acc: 0.8415300250053406, corresponding to test acc:                         0.8488888740539551 / 0.8488888740539551
after epoch: 8,now: 2024-07-26 05:44:08.151001,epoch time: 0:01:27.815569,used: 0:11:52.067736,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_05_32_16_seed_1_23065778
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9889323, 'precision': 0.9889306, 'recall': 0.9889306, 'specificity': 0.9889306, 'f1': 0.9889306, 'auroc': 0.9995091, 'binary_precision': 0.9890675, 'binary_recall': 0.9890675, 'binary_specificity': 0.9887937, 'binary_f1_score': 0.9890675}
confusion matrix:
      0     1
0  1500    17
1    17  1538
---- Validation: 
scalar performance:
{'acc': 0.6705699, 'precision': 0.7666961, 'recall': 0.6655658, 'specificity': 0.6655658, 'f1': 0.6339841, 'auroc': 0.8912394, 'binary_precision': 0.92276424, 'binary_recall': 0.36031747, 'binary_specificity': 0.9708141, 'binary_f1_score': 0.51826483}
confusion matrix:
     0    1
0  632   19
1  403  227
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.77111113, 'precision': 0.8213985, 'recall': 0.77111113, 'specificity': 0.77111113, 'f1': 0.76179343, 'auroc': 0.8965728, 'binary_precision': 0.9485294, 'binary_recall': 0.5733333, 'binary_specificity': 0.9688889, 'binary_f1_score': 0.71468145}
confusion matrix:
     0    1
0  218    7
1   96  129
early stop counter: 5
val acc:0.670569896697998, best validation acc: 0.8415300250053406, corresponding to test acc:                         0.8488888740539551 / 0.8488888740539551
after epoch: 9,now: 2024-07-26 05:45:35.874002,epoch time: 0:01:27.723001,used: 0:13:19.790737,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_05_32_16_seed_1_23065778
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.98795575, 'precision': 0.9879557, 'recall': 0.98803043, 'specificity': 0.98803043, 'f1': 0.9879553, 'auroc': 0.99943876, 'binary_precision': 0.9941406, 'binary_recall': 0.98199356, 'binary_specificity': 0.99406725, 'binary_f1_score': 0.9880298}
confusion matrix:
      0     1
0  1508     9
1    28  1527
---- Validation: 
scalar performance:
{'acc': 0.6088993, 'precision': 0.73625267, 'recall': 0.60276496, 'specificity': 0.60276496, 'f1': 0.5412236, 'auroc': 0.8890468, 'binary_precision': 0.9056604, 'binary_recall': 0.22857143, 'binary_specificity': 0.9769585, 'binary_f1_score': 0.36501902}
confusion matrix:
     0    1
0  636   15
1  486  144
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.70444447, 'precision': 0.7915821, 'recall': 0.7044444, 'specificity': 0.7044444, 'f1': 0.6805802, 'auroc': 0.8907901, 'binary_precision': 0.95098037, 'binary_recall': 0.4311111, 'binary_specificity': 0.9777778, 'binary_f1_score': 0.5932721}
confusion matrix:
     0   1
0  220   5
1  128  97
early stop counter: 6
val acc:0.6088992953300476, best validation acc: 0.8415300250053406, corresponding to test acc:                         0.8488888740539551 / 0.8488888740539551
after epoch: 10,now: 2024-07-26 05:47:04.118807,epoch time: 0:01:28.244805,used: 0:14:48.035542,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_05_32_16_seed_1_23065778
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9716797, 'precision': 0.9728679, 'recall': 0.97196484, 'specificity': 0.97196484, 'f1': 0.9716712, 'auroc': 0.9985706, 'binary_precision': 0.99931836, 'binary_recall': 0.94458765, 'binary_specificity': 0.9993421, 'binary_f1_score': 0.9711825}
confusion matrix:
      0     1
0  1519     1
1    86  1466
---- Validation: 
scalar performance:
{'acc': 0.61904764, 'precision': 0.7582265, 'recall': 0.6129288, 'specificity': 0.6129288, 'f1': 0.55344176, 'auroc': 0.9051672, 'binary_precision': 0.94375, 'binary_recall': 0.23968254, 'binary_specificity': 0.9861751, 'binary_f1_score': 0.38227847}
confusion matrix:
     0    1
0  642    9
1  479  151
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7, 'precision': 0.7979343, 'recall': 0.7, 'specificity': 0.7, 'f1': 0.67313933, 'auroc': 0.89318025, 'binary_precision': 0.96875, 'binary_recall': 0.41333333, 'binary_specificity': 0.9866667, 'binary_f1_score': 0.5794393}
confusion matrix:
     0   1
0  222   3
1  132  93
early stop counter: 7
val acc:0.6190476417541504, best validation acc: 0.8415300250053406, corresponding to test acc:                         0.8488888740539551 / 0.8488888740539551
after epoch: 11,now: 2024-07-26 05:48:32.533755,epoch time: 0:01:28.414948,used: 0:16:16.450490,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_05_32_16_seed_1_23065778
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9781901, 'precision': 0.97883064, 'recall': 0.9784216, 'specificity': 0.9784216, 'f1': 0.97818786, 'auroc': 0.9992794, 'binary_precision': 0.99932796, 'binary_recall': 0.9575016, 'binary_specificity': 0.99934167, 'binary_f1_score': 0.97796774}
confusion matrix:
      0     1
0  1518     1
1    66  1487
---- Validation: 
scalar performance:
{'acc': 0.7205308, 'precision': 0.7973504, 'recall': 0.71630824, 'specificity': 0.71630824, 'f1': 0.69867456, 'auroc': 0.9151318, 'binary_precision': 0.9444444, 'binary_recall': 0.45873016, 'binary_specificity': 0.9738863, 'binary_f1_score': 0.61752135}
confusion matrix:
     0    1
0  634   17
1  341  289
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.59555554, 'precision': 0.7654321, 'recall': 0.59555554, 'specificity': 0.59555554, 'f1': 0.5185185, 'auroc': 0.897442, 'binary_precision': 0.9777778, 'binary_recall': 0.19555555, 'binary_specificity': 0.9955556, 'binary_f1_score': 0.32592592}
confusion matrix:
     0   1
0  224   1
1  181  44
early stop counter: 8
val acc:0.7205308079719543, best validation acc: 0.8415300250053406, corresponding to test acc:                         0.8488888740539551 / 0.8488888740539551
after epoch: 12,now: 2024-07-26 05:50:00.806831,epoch time: 0:01:28.273076,used: 0:17:44.723566,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_05_32_16_seed_1_23065778
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.98502606, 'precision': 0.98525524, 'recall': 0.985201, 'specificity': 0.985201, 'f1': 0.985026, 'auroc': 0.9993764, 'binary_precision': 0.9993382, 'binary_recall': 0.9710611, 'binary_specificity': 0.99934083, 'binary_f1_score': 0.98499674}
confusion matrix:
      0     1
0  1516     1
1    45  1510
---- Validation: 
scalar performance:
{'acc': 0.6807182, 'precision': 0.77099955, 'recall': 0.67590886, 'specificity': 0.67590886, 'f1': 0.64810085, 'auroc': 0.91575354, 'binary_precision': 0.9233717, 'binary_recall': 0.3825397, 'binary_specificity': 0.96927804, 'binary_f1_score': 0.54096526}
confusion matrix:
     0    1
0  631   20
1  389  241
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7177778, 'precision': 0.7947861, 'recall': 0.7177778, 'specificity': 0.7177778, 'f1': 0.69805837, 'auroc': 0.9063901, 'binary_precision': 0.94545454, 'binary_recall': 0.46222222, 'binary_specificity': 0.97333336, 'binary_f1_score': 0.6208955}
confusion matrix:
     0    1
0  219    6
1  121  104
early stop counter: 9
val acc:0.680718183517456, best validation acc: 0.8415300250053406, corresponding to test acc:                         0.8488888740539551 / 0.8488888740539551
after epoch: 13,now: 2024-07-26 05:51:28.798766,epoch time: 0:01:27.991935,used: 0:19:12.715501,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_05_32_16_seed_1_23065778
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9791667, 'precision': 0.97972816, 'recall': 0.9794004, 'specificity': 0.9794004, 'f1': 0.9791652, 'auroc': 0.99977404, 'binary_precision': 0.99932975, 'binary_recall': 0.9594595, 'binary_specificity': 0.99934125, 'binary_f1_score': 0.9789888}
confusion matrix:
      0     1
0  1517     1
1    63  1491
---- Validation: 
scalar performance:
{'acc': 0.64246684, 'precision': 0.7776792, 'recall': 0.6366615, 'specificity': 0.6366615, 'f1': 0.58766633, 'auroc': 0.922371, 'binary_precision': 0.9673913, 'binary_recall': 0.2825397, 'binary_specificity': 0.9907834, 'binary_f1_score': 0.4373465}
confusion matrix:
     0    1
0  645    6
1  452  178
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.64, 'precision': 0.7761973, 'recall': 0.64, 'specificity': 0.64, 'f1': 0.589379, 'auroc': 0.9001877, 'binary_precision': 0.9701493, 'binary_recall': 0.2888889, 'binary_specificity': 0.9911111, 'binary_f1_score': 0.44520548}
confusion matrix:
     0   1
0  223   2
1  160  65
early stop counter: 10
val acc:0.6424668431282043, best validation acc: 0.8415300250053406, corresponding to test acc:                         0.8488888740539551 / 0.8488888740539551
after epoch: 14,now: 2024-07-26 05:52:56.722228,epoch time: 0:01:27.923462,used: 0:20:40.638963,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_05_32_16_seed_1_23065778
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9847005, 'precision': 0.98474586, 'recall': 0.9848069, 'specificity': 0.9848069, 'f1': 0.9847003, 'auroc': 0.9991822, 'binary_precision': 0.99345547, 'binary_recall': 0.97620577, 'binary_specificity': 0.993408, 'binary_f1_score': 0.9847551}
confusion matrix:
      0     1
0  1507    10
1    37  1518
---- Validation: 
scalar performance:
{'acc': 0.8852459, 'precision': 0.88869905, 'recall': 0.8844854, 'specificity': 0.8844854, 'f1': 0.88481885, 'auroc': 0.93485236, 'binary_precision': 0.921466, 'binary_recall': 0.83809525, 'binary_specificity': 0.9308756, 'binary_f1_score': 0.8778055}
confusion matrix:
     0    1
0  606   45
1  102  528
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.85555553, 'precision': 0.8703704, 'recall': 0.85555553, 'specificity': 0.85555553, 'f1': 0.85409653, 'auroc': 0.93345183, 'binary_precision': 0.9444444, 'binary_recall': 0.75555557, 'binary_specificity': 0.95555556, 'binary_f1_score': 0.83950615}
confusion matrix:
     0    1
0  215   10
1   55  170
new oracle model saved
better model found
persisted
after epoch: 15,now: 2024-07-26 05:54:24.972362,epoch time: 0:01:28.250134,used: 0:22:08.889097,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_05_32_16_seed_1_23065778
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9921875, 'precision': 0.9921746, 'recall': 0.9922206, 'specificity': 0.9922206, 'f1': 0.9921871, 'auroc': 0.99978125, 'binary_precision': 0.99546045, 'binary_recall': 0.9890464, 'binary_specificity': 0.99539477, 'binary_f1_score': 0.99224305}
confusion matrix:
      0     1
0  1513     7
1    17  1535
---- Validation: 
scalar performance:
{'acc': 0.82825917, 'precision': 0.8439144, 'recall': 0.8264977, 'specificity': 0.8264977, 'f1': 0.82570744, 'auroc': 0.9237144, 'binary_precision': 0.9133065, 'binary_recall': 0.7190476, 'binary_specificity': 0.9339478, 'binary_f1_score': 0.8046182}
confusion matrix:
     0    1
0  608   43
1  177  453
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8066667, 'precision': 0.81719923, 'recall': 0.8066667, 'specificity': 0.8066667, 'f1': 0.80504835, 'auroc': 0.8781432, 'binary_precision': 0.875, 'binary_recall': 0.71555555, 'binary_specificity': 0.8977778, 'binary_f1_score': 0.78728604}
confusion matrix:
     0    1
0  202   23
1   64  161
early stop counter: 1
val acc:0.8282591700553894, best validation acc: 0.8852459192276001, corresponding to test acc:                         0.855555534362793 / 0.855555534362793
after epoch: 16,now: 2024-07-26 05:55:52.986204,epoch time: 0:01:28.013842,used: 0:23:36.902939,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_05_32_16_seed_1_23065778
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.98535156, 'precision': 0.98549926, 'recall': 0.98526853, 'specificity': 0.98526853, 'f1': 0.98534614, 'auroc': 0.99954045, 'binary_precision': 0.97968256, 'binary_recall': 0.9916452, 'binary_specificity': 0.97889185, 'binary_f1_score': 0.9856276}
confusion matrix:
      0     1
0  1484    32
1    13  1543
---- Validation: 
scalar performance:
{'acc': 0.871975, 'precision': 0.8768984, 'recall': 0.8710445, 'specificity': 0.8710445, 'f1': 0.8713256, 'auroc': 0.9285202, 'binary_precision': 0.9160714, 'binary_recall': 0.8142857, 'binary_specificity': 0.9278034, 'binary_f1_score': 0.8621848}
confusion matrix:
     0    1
0  604   47
1  117  513
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.84444445, 'precision': 0.8568797, 'recall': 0.8444444, 'specificity': 0.8444444, 'f1': 0.8430774, 'auroc': 0.9212642, 'binary_precision': 0.92349726, 'binary_recall': 0.7511111, 'binary_specificity': 0.93777776, 'binary_f1_score': 0.82843137}
confusion matrix:
     0    1
0  211   14
1   56  169
early stop counter: 2
val acc:0.8719750046730042, best validation acc: 0.8852459192276001, corresponding to test acc:                         0.855555534362793 / 0.855555534362793
after epoch: 17,now: 2024-07-26 05:57:21.276444,epoch time: 0:01:28.290240,used: 0:25:05.193179,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_05_32_16_seed_1_23065778
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9905599, 'precision': 0.9905915, 'recall': 0.9906591, 'specificity': 0.9906591, 'f1': 0.99055976, 'auroc': 0.99942094, 'binary_precision': 0.9986928, 'binary_recall': 0.98263663, 'binary_specificity': 0.9986816, 'binary_f1_score': 0.9905997}
confusion matrix:
      0     1
0  1515     2
1    27  1528
---- Validation: 
scalar performance:
{'acc': 0.676815, 'precision': 0.76280504, 'recall': 0.672043, 'specificity': 0.672043, 'f1': 0.64435565, 'auroc': 0.9049405, 'binary_precision': 0.90909094, 'binary_recall': 0.3809524, 'binary_specificity': 0.96313363, 'binary_f1_score': 0.53691274}
confusion matrix:
     0    1
0  627   24
1  390  240
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6311111, 'precision': 0.7264663, 'recall': 0.63111115, 'specificity': 0.63111115, 'f1': 0.5877119, 'auroc': 0.8836938, 'binary_precision': 0.87341774, 'binary_recall': 0.30666667, 'binary_specificity': 0.95555556, 'binary_f1_score': 0.45394734}
confusion matrix:
     0   1
0  215  10
1  156  69
early stop counter: 3
val acc:0.6768149733543396, best validation acc: 0.8852459192276001, corresponding to test acc:                         0.855555534362793 / 0.855555534362793
after epoch: 18,now: 2024-07-26 05:58:49.681577,epoch time: 0:01:28.405133,used: 0:26:33.598312,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_05_32_16_seed_1_23065778
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.99088544, 'precision': 0.99088156, 'recall': 0.99095654, 'specificity': 0.99095654, 'f1': 0.990885, 'auroc': 0.99965024, 'binary_precision': 0.9967469, 'binary_recall': 0.985209, 'binary_specificity': 0.99670404, 'binary_f1_score': 0.9909443}
confusion matrix:
      0     1
0  1512     5
1    23  1532
---- Validation: 
scalar performance:
{'acc': 0.8126464, 'precision': 0.8459649, 'recall': 0.8100871, 'specificity': 0.8100871, 'f1': 0.80711126, 'auroc': 0.91810215, 'binary_precision': 0.94930875, 'binary_recall': 0.6539683, 'binary_specificity': 0.96620584, 'binary_f1_score': 0.7744361}
confusion matrix:
     0    1
0  629   22
1  218  412
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.77111113, 'precision': 0.79112935, 'recall': 0.77111113, 'specificity': 0.77111113, 'f1': 0.76710767, 'auroc': 0.8691556, 'binary_precision': 0.8674699, 'binary_recall': 0.64, 'binary_specificity': 0.9022222, 'binary_f1_score': 0.73657286}
confusion matrix:
     0    1
0  203   22
1   81  144
early stop counter: 4
val acc:0.8126463890075684, best validation acc: 0.8852459192276001, corresponding to test acc:                         0.855555534362793 / 0.855555534362793
after epoch: 19,now: 2024-07-26 06:00:17.833845,epoch time: 0:01:28.152268,used: 0:28:01.750580,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_05_32_16_seed_1_23065778
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9791667, 'precision': 0.9797011, 'recall': 0.97896653, 'specificity': 0.97896653, 'f1': 0.9791503, 'auroc': 0.9990461, 'binary_precision': 0.966875, 'binary_recall': 0.99293965, 'binary_specificity': 0.9649934, 'binary_f1_score': 0.979734}
confusion matrix:
      0     1
0  1461    53
1    11  1547
---- Validation: 
scalar performance:
{'acc': 0.863388, 'precision': 0.8635224, 'recall': 0.86321044, 'specificity': 0.86321044, 'f1': 0.8633027, 'auroc': 0.90817547, 'binary_precision': 0.86752826, 'binary_recall': 0.85238093, 'binary_specificity': 0.87403995, 'binary_f1_score': 0.85988784}
confusion matrix:
     0    1
0  569   82
1   93  537
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.76, 'precision': 0.7955142, 'recall': 0.76, 'specificity': 0.76, 'f1': 0.752566, 'auroc': 0.8903309, 'binary_precision': 0.6930693, 'binary_recall': 0.93333334, 'binary_specificity': 0.58666664, 'binary_f1_score': 0.7954545}
confusion matrix:
     0    1
0  132   93
1   15  210
early stop counter: 5
val acc:0.8633880019187927, best validation acc: 0.8852459192276001, corresponding to test acc:                         0.855555534362793 / 0.855555534362793
after epoch: 20,now: 2024-07-26 06:01:46.161798,epoch time: 0:01:28.327953,used: 0:29:30.078533,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_05_32_16_seed_1_23065778
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9905599, 'precision': 0.990541, 'recall': 0.99060273, 'specificity': 0.99060273, 'f1': 0.9905592, 'auroc': 0.99970376, 'binary_precision': 0.99417096, 'binary_recall': 0.9871383, 'binary_specificity': 0.99406725, 'binary_f1_score': 0.9906422}
confusion matrix:
      0     1
0  1508     9
1    20  1535
---- Validation: 
scalar performance:
{'acc': 0.7759563, 'precision': 0.8242898, 'recall': 0.77275985, 'specificity': 0.77275985, 'f1': 0.76586044, 'auroc': 0.91841185, 'binary_precision': 0.94545454, 'binary_recall': 0.5777778, 'binary_specificity': 0.9677419, 'binary_f1_score': 0.71724135}
confusion matrix:
     0    1
0  630   21
1  266  364
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6755555, 'precision': 0.7814192, 'recall': 0.6755555, 'specificity': 0.6755555, 'f1': 0.641876, 'auroc': 0.894479, 'binary_precision': 0.954023, 'binary_recall': 0.36888888, 'binary_specificity': 0.9822222, 'binary_f1_score': 0.53205127}
confusion matrix:
     0   1
0  221   4
1  142  83
early stop counter: 6
val acc:0.7759562730789185, best validation acc: 0.8852459192276001, corresponding to test acc:                         0.855555534362793 / 0.855555534362793
after epoch: 21,now: 2024-07-26 06:03:14.500326,epoch time: 0:01:28.338528,used: 0:30:58.417061,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_05_32_16_seed_1_23065778
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9905599, 'precision': 0.9906242, 'recall': 0.99051666, 'specificity': 0.99051666, 'f1': 0.9905577, 'auroc': 0.99965537, 'binary_precision': 0.98722047, 'binary_recall': 0.9942085, 'binary_specificity': 0.98682475, 'binary_f1_score': 0.9907022}
confusion matrix:
      0     1
0  1498    20
1     9  1545
---- Validation: 
scalar performance:
{'acc': 0.8797814, 'precision': 0.8798616, 'recall': 0.87964666, 'specificity': 0.87964666, 'f1': 0.87971973, 'auroc': 0.9297418, 'binary_precision': 0.88263667, 'binary_recall': 0.87142855, 'binary_specificity': 0.8878648, 'binary_f1_score': 0.87699676}
confusion matrix:
     0    1
0  578   73
1   81  549
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8288889, 'precision': 0.83077717, 'recall': 0.8288889, 'specificity': 0.8288889, 'f1': 0.8286443, 'auroc': 0.8965333, 'binary_precision': 0.8557692, 'binary_recall': 0.7911111, 'binary_specificity': 0.8666667, 'binary_f1_score': 0.82217085}
confusion matrix:
     0    1
0  195   30
1   47  178
early stop counter: 7
val acc:0.8797814249992371, best validation acc: 0.8852459192276001, corresponding to test acc:                         0.855555534362793 / 0.855555534362793
after epoch: 22,now: 2024-07-26 06:04:43.357166,epoch time: 0:01:28.856840,used: 0:32:27.273901,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_05_32_16_seed_1_23065778
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.99348956, 'precision': 0.99347425, 'recall': 0.99353445, 'specificity': 0.99353445, 'f1': 0.99348915, 'auroc': 0.99969864, 'binary_precision': 0.99740595, 'binary_recall': 0.989704, 'binary_specificity': 0.99736494, 'binary_f1_score': 0.99354005}
confusion matrix:
      0     1
0  1514     4
1    16  1538
---- Validation: 
scalar performance:
{'acc': 0.84231067, 'precision': 0.8524812, 'recall': 0.8409114, 'specificity': 0.8409114, 'f1': 0.8407454, 'auroc': 0.9175676, 'binary_precision': 0.90839696, 'binary_recall': 0.75555557, 'binary_specificity': 0.92626727, 'binary_f1_score': 0.82495666}
confusion matrix:
     0    1
0  603   48
1  154  476
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.80444443, 'precision': 0.8068691, 'recall': 0.80444443, 'specificity': 0.80444443, 'f1': 0.8040574, 'auroc': 0.868879, 'binary_precision': 0.8341463, 'binary_recall': 0.76, 'binary_specificity': 0.8488889, 'binary_f1_score': 0.7953488}
confusion matrix:
     0    1
0  191   34
1   54  171
early stop counter: 8
val acc:0.8423106670379639, best validation acc: 0.8852459192276001, corresponding to test acc:                         0.855555534362793 / 0.855555534362793
after epoch: 23,now: 2024-07-26 06:06:11.704742,epoch time: 0:01:28.347576,used: 0:33:55.621477,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_05_32_16_seed_1_23065778
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9869792, 'precision': 0.98712236, 'recall': 0.98713803, 'specificity': 0.98713803, 'f1': 0.9869791, 'auroc': 0.99955356, 'binary_precision': 0.99934125, 'binary_recall': 0.9749357, 'binary_specificity': 0.99934036, 'binary_f1_score': 0.9869876}
confusion matrix:
      0     1
0  1515     1
1    39  1517
---- Validation: 
scalar performance:
{'acc': 0.81576896, 'precision': 0.8517697, 'recall': 0.8131336, 'specificity': 0.8131336, 'f1': 0.81001127, 'auroc': 0.9341995, 'binary_precision': 0.96028036, 'binary_recall': 0.65238094, 'binary_specificity': 0.9738863, 'binary_f1_score': 0.77693754}
confusion matrix:
     0    1
0  634   17
1  219  411
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.77555555, 'precision': 0.8294445, 'recall': 0.77555555, 'specificity': 0.77555555, 'f1': 0.76598585, 'auroc': 0.91155064, 'binary_precision': 0.96268654, 'binary_recall': 0.5733333, 'binary_specificity': 0.9777778, 'binary_f1_score': 0.718663}
confusion matrix:
     0    1
0  220    5
1   96  129
early stop counter: 9
val acc:0.8157689571380615, best validation acc: 0.8852459192276001, corresponding to test acc:                         0.855555534362793 / 0.855555534362793
after epoch: 24,now: 2024-07-26 06:07:39.927136,epoch time: 0:01:28.222394,used: 0:35:23.843871,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_05_32_16_seed_1_23065778
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.9905599, 'precision': 0.990621, 'recall': 0.9906752, 'specificity': 0.9906752, 'f1': 0.9905598, 'auroc': 0.99977577, 'binary_precision': 1.0, 'binary_recall': 0.9813505, 'binary_specificity': 1.0, 'binary_f1_score': 0.9905875}
confusion matrix:
      0     1
0  1517     0
1    29  1526
---- Validation: 
scalar performance:
{'acc': 0.7236534, 'precision': 0.80033636, 'recall': 0.71945727, 'specificity': 0.71945727, 'f1': 0.7023105, 'auroc': 0.91676724, 'binary_precision': 0.9480519, 'binary_recall': 0.46349207, 'binary_specificity': 0.97542244, 'binary_f1_score': 0.62260133}
confusion matrix:
     0    1
0  635   16
1  338  292
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7822222, 'precision': 0.82544816, 'recall': 0.7822223, 'specificity': 0.7822223, 'f1': 0.7747425, 'auroc': 0.90506667, 'binary_precision': 0.9440559, 'binary_recall': 0.6, 'binary_specificity': 0.96444446, 'binary_f1_score': 0.7336956}
confusion matrix:
     0    1
0  217    8
1   90  135
early stop counter: 10
val acc:0.7236533761024475, best validation acc: 0.8852459192276001, corresponding to test acc:                         0.855555534362793 / 0.855555534362793
after epoch: 25,now: 2024-07-26 06:09:08.310604,epoch time: 0:01:28.383468,used: 0:36:52.227339,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_05_32_16_seed_1_23065778
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.99153644, 'precision': 0.99152267, 'recall': 0.99156266, 'specificity': 0.99156266, 'f1': 0.9915359, 'auroc': 0.9997338, 'binary_precision': 0.99417096, 'binary_recall': 0.9890464, 'binary_specificity': 0.99407893, 'binary_f1_score': 0.99160206}
confusion matrix:
      0     1
0  1511     9
1    17  1535
---- Validation: 
scalar performance:
{'acc': 0.87119436, 'precision': 0.8834373, 'recall': 0.8697389, 'specificity': 0.8697389, 'f1': 0.869812, 'auroc': 0.93733084, 'binary_precision': 0.9479769, 'binary_recall': 0.7809524, 'binary_specificity': 0.95852536, 'binary_f1_score': 0.85639685}
confusion matrix:
     0    1
0  624   27
1  138  492
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8711111, 'precision': 0.8888061, 'recall': 0.87111115, 'specificity': 0.87111115, 'f1': 0.86962783, 'auroc': 0.934242, 'binary_precision': 0.9717514, 'binary_recall': 0.7644445, 'binary_specificity': 0.9777778, 'binary_f1_score': 0.8557215}
confusion matrix:
     0    1
0  220    5
1   53  172
new oracle model saved
early stop counter: 11
val acc:0.8711943626403809, best validation acc: 0.8852459192276001, corresponding to test acc:                         0.855555534362793 / 0.8711110949516296
after epoch: 26,now: 2024-07-26 06:10:36.688497,epoch time: 0:01:28.377893,used: 0:38:20.605232,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_05_32_16_seed_1_23065778
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.99088544, 'precision': 0.99086446, 'recall': 0.99094605, 'specificity': 0.99094605, 'f1': 0.99088466, 'auroc': 0.9995812, 'binary_precision': 0.9954634, 'binary_recall': 0.98651254, 'binary_specificity': 0.99537957, 'binary_f1_score': 0.99096775}
confusion matrix:
      0     1
0  1508     7
1    21  1536
---- Validation: 
scalar performance:
{'acc': 0.7915691, 'precision': 0.8371867, 'recall': 0.78853047, 'specificity': 0.78853047, 'f1': 0.78303903, 'auroc': 0.9391723, 'binary_precision': 0.95717883, 'binary_recall': 0.6031746, 'binary_specificity': 0.9738863, 'binary_f1_score': 0.74001944}
confusion matrix:
     0    1
0  634   17
1  250  380
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.81777775, 'precision': 0.8637648, 'recall': 0.81777775, 'specificity': 0.81777775, 'f1': 0.81183076, 'auroc': 0.93347156, 'binary_precision': 0.99310344, 'binary_recall': 0.64, 'binary_specificity': 0.9955556, 'binary_f1_score': 0.7783784}
confusion matrix:
     0    1
0  224    1
1   81  144
early stop counter: 12
val acc:0.7915691137313843, best validation acc: 0.8852459192276001, corresponding to test acc:                         0.855555534362793 / 0.8711110949516296
after epoch: 27,now: 2024-07-26 06:12:05.183403,epoch time: 0:01:28.494906,used: 0:39:49.100138,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_05_32_16_seed_1_23065778
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.9921875, 'precision': 0.99218327, 'recall': 0.99227506, 'specificity': 0.99227506, 'f1': 0.9921871, 'auroc': 0.99978125, 'binary_precision': 0.9986988, 'binary_recall': 0.98587024, 'binary_specificity': 0.9986799, 'binary_f1_score': 0.992243}
confusion matrix:
      0     1
0  1513     2
1    22  1535
---- Validation: 
scalar performance:
{'acc': 0.68384075, 'precision': 0.78381234, 'recall': 0.67890424, 'specificity': 0.67890424, 'f1': 0.64968354, 'auroc': 0.9249086, 'binary_precision': 0.9482072, 'binary_recall': 0.37777779, 'binary_specificity': 0.9800307, 'binary_f1_score': 0.5402951}
confusion matrix:
     0    1
0  638   13
1  392  238
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6111111, 'precision': 0.74740505, 'recall': 0.6111111, 'specificity': 0.6111111, 'f1': 0.54899746, 'auroc': 0.9006765, 'binary_precision': 0.9310345, 'binary_recall': 0.24, 'binary_specificity': 0.9822222, 'binary_f1_score': 0.38162544}
confusion matrix:
     0   1
0  221   4
1  171  54
early stop counter: 13
val acc:0.6838407516479492, best validation acc: 0.8852459192276001, corresponding to test acc:                         0.855555534362793 / 0.8711110949516296
after epoch: 28,now: 2024-07-26 06:13:33.314435,epoch time: 0:01:28.131032,used: 0:41:17.231170,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_05_32_16_seed_1_23065778
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.99609375, 'precision': 0.9960749, 'recall': 0.99612534, 'specificity': 0.99612534, 'f1': 0.99609333, 'auroc': 0.999972, 'binary_precision': 0.9987072, 'binary_recall': 0.99356914, 'binary_specificity': 0.9986816, 'binary_f1_score': 0.9961315}
confusion matrix:
      0     1
0  1515     2
1    10  1545
---- Validation: 
scalar performance:
{'acc': 0.60967994, 'precision': 0.7652279, 'recall': 0.6033026, 'specificity': 0.6033026, 'f1': 0.5358157, 'auroc': 0.93338513, 'binary_precision': 0.96428573, 'binary_recall': 0.21428572, 'binary_specificity': 0.9923195, 'binary_f1_score': 0.35064936}
confusion matrix:
     0    1
0  646    5
1  495  135
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.56222224, 'precision': 0.75, 'recall': 0.56222224, 'specificity': 0.56222224, 'f1': 0.46101233, 'auroc': 0.897679, 'binary_precision': 0.96666664, 'binary_recall': 0.12888889, 'binary_specificity': 0.9955556, 'binary_f1_score': 0.22745097}
confusion matrix:
     0   1
0  224   1
1  196  29
early stop counter: 14
val acc:0.6096799373626709, best validation acc: 0.8852459192276001, corresponding to test acc:                         0.855555534362793 / 0.8711110949516296
after epoch: 29,now: 2024-07-26 06:15:01.358299,epoch time: 0:01:28.043864,used: 0:42:45.275034,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_05_32_16_seed_1_23065778
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.9967448, 'precision': 0.9967443, 'recall': 0.9967443, 'specificity': 0.9967443, 'f1': 0.9967443, 'auroc': 0.9998189, 'binary_precision': 0.99678665, 'binary_recall': 0.99678665, 'binary_specificity': 0.99670184, 'binary_f1_score': 0.99678665}
confusion matrix:
      0     1
0  1511     5
1     5  1551
---- Validation: 
scalar performance:
{'acc': 0.73224044, 'precision': 0.80748796, 'recall': 0.7281362, 'specificity': 0.7281362, 'f1': 0.7124579, 'auroc': 0.94289196, 'binary_precision': 0.95555556, 'binary_recall': 0.47777778, 'binary_specificity': 0.97849464, 'binary_f1_score': 0.637037}
confusion matrix:
     0    1
0  637   14
1  329  301
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.72888887, 'precision': 0.8157271, 'recall': 0.72888887, 'specificity': 0.72888887, 'f1': 0.7088707, 'auroc': 0.9299358, 'binary_precision': 0.9813084, 'binary_recall': 0.46666667, 'binary_specificity': 0.9911111, 'binary_f1_score': 0.63253015}
confusion matrix:
     0    1
0  223    2
1  120  105
early stop counter: 15
val acc:0.7322404384613037, best validation acc: 0.8852459192276001, corresponding to test acc:                         0.855555534362793 / 0.8711110949516296
after epoch: 30,now: 2024-07-26 06:16:29.408981,epoch time: 0:01:28.050682,used: 0:44:13.325716,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_05_32_16_seed_1_23065778
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 0:44:13.325716 at 2024-07-26 06:16:29.408981
persisted model performance metric: 

scalar performance:
{'acc': 0.85555553, 'precision': 0.8703704, 'recall': 0.85555553, 'specificity': 0.85555553, 'f1': 0.85409653, 'auroc': 0.93345183, 'binary_precision': 0.9444444, 'binary_recall': 0.75555557, 'binary_specificity': 0.95555556, 'binary_f1_score': 0.83950615}
confusion matrix:
     0    1
0  215   10
1   55  170
oracle model performance metric: 

scalar performance:
{'acc': 0.8711111, 'precision': 0.8888061, 'recall': 0.87111115, 'specificity': 0.87111115, 'f1': 0.86962783, 'auroc': 0.934242, 'binary_precision': 0.9717514, 'binary_recall': 0.7644445, 'binary_specificity': 0.9777778, 'binary_f1_score': 0.8557215}
confusion matrix:
     0    1
0  220    5
1   53  172
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_irm_10seeds_nofreeze_2024-07-26_02-28-54/rule_results/1.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_irm_10seeds_nofreeze_2024-07-26_02-28-54/confusion_matrix/1.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 455402 KiB |  13219 MiB | 148251 GiB | 148251 GiB |
|       from large pool | 414803 KiB |  13181 MiB | 146495 GiB | 146494 GiB |
|       from small pool |  40598 KiB |     60 MiB |   1756 GiB |   1756 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 455402 KiB |  13219 MiB | 148251 GiB | 148251 GiB |
|       from large pool | 414803 KiB |  13181 MiB | 146495 GiB | 146494 GiB |
|       from small pool |  40598 KiB |     60 MiB |   1756 GiB |   1756 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 447481 KiB |  13213 MiB | 147702 GiB | 147702 GiB |
|       from large pool | 407075 KiB |  13175 MiB | 145949 GiB | 145948 GiB |
|       from small pool |  40406 KiB |     60 MiB |   1753 GiB |   1753 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  14482 MiB |  14482 MiB |  28044 MiB |  13562 MiB |
|       from large pool |  14412 MiB |  14412 MiB |  27960 MiB |  13548 MiB |
|       from small pool |     70 MiB |     70 MiB |     84 MiB |     14 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 445718 KiB |   1232 MiB | 103958 GiB | 103958 GiB |
|       from large pool | 435116 KiB |   1229 MiB | 102190 GiB | 102190 GiB |
|       from small pool |  10601 KiB |     42 MiB |   1767 GiB |   1767 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    1310    |    2598    |   26107 K  |   26106 K  |
|       from large pool |     187    |    1413    |   13296 K  |   13296 K  |
|       from small pool |    1123    |    1419    |   12810 K  |   12809 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    1310    |    2598    |   26107 K  |   26106 K  |
|       from large pool |     187    |    1413    |   13296 K  |   13296 K  |
|       from small pool |    1123    |    1419    |   12810 K  |   12809 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     637    |     637    |    1207    |     570    |
|       from large pool |     602    |     602    |    1165    |     563    |
|       from small pool |      35    |      35    |      42    |       7    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      96    |     650    |   18198 K  |   18198 K  |
|       from large pool |      38    |     605    |   10485 K  |   10485 K  |
|       from small pool |      58    |     235    |    7713 K  |    7713 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13219 MiB | 148251 GiB | 148251 GiB |
|       from large pool |  16640 KiB |  13181 MiB | 146495 GiB | 146495 GiB |
|       from small pool |      0 KiB |     60 MiB |   1756 GiB |   1756 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13219 MiB | 148251 GiB | 148251 GiB |
|       from large pool |  16640 KiB |  13181 MiB | 146495 GiB | 146495 GiB |
|       from small pool |      0 KiB |     60 MiB |   1756 GiB |   1756 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13213 MiB | 147702 GiB | 147702 GiB |
|       from large pool |  16640 KiB |  13175 MiB | 145949 GiB | 145949 GiB |
|       from small pool |      0 KiB |     60 MiB |   1753 GiB |   1753 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    880 MiB |  14482 MiB |  28044 MiB |  27164 MiB |
|       from large pool |    830 MiB |  14412 MiB |  27960 MiB |  27130 MiB |
|       from small pool |     50 MiB |     70 MiB |     84 MiB |     34 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1232 MiB | 103959 GiB | 103959 GiB |
|       from large pool |  24320 KiB |   1229 MiB | 102191 GiB | 102191 GiB |
|       from small pool |      0 KiB |     42 MiB |   1767 GiB |   1767 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    2598    |   26107 K  |   26107 K  |
|       from large pool |       2    |    1413    |   13296 K  |   13296 K  |
|       from small pool |       0    |    1419    |   12810 K  |   12810 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    2598    |   26107 K  |   26107 K  |
|       from large pool |       2    |    1413    |   13296 K  |   13296 K  |
|       from small pool |       0    |    1419    |   12810 K  |   12810 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      62    |     637    |    1207    |    1145    |
|       from large pool |      37    |     602    |    1165    |    1128    |
|       from small pool |      25    |      35    |      42    |      17    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |     650    |   18198 K  |   18198 K  |
|       from large pool |       4    |     605    |   10485 K  |   10485 K  |
|       from small pool |       0    |     235    |    7713 K  |    7713 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13219 MiB | 148251 GiB | 148251 GiB |
|       from large pool |  16640 KiB |  13181 MiB | 146495 GiB | 146495 GiB |
|       from small pool |      0 KiB |     60 MiB |   1756 GiB |   1756 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13219 MiB | 148251 GiB | 148251 GiB |
|       from large pool |  16640 KiB |  13181 MiB | 146495 GiB | 146495 GiB |
|       from small pool |      0 KiB |     60 MiB |   1756 GiB |   1756 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13213 MiB | 147702 GiB | 147702 GiB |
|       from large pool |  16640 KiB |  13175 MiB | 145949 GiB | 145949 GiB |
|       from small pool |      0 KiB |     60 MiB |   1753 GiB |   1753 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    880 MiB |  14482 MiB |  28044 MiB |  27164 MiB |
|       from large pool |    830 MiB |  14412 MiB |  27960 MiB |  27130 MiB |
|       from small pool |     50 MiB |     70 MiB |     84 MiB |     34 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1232 MiB | 103959 GiB | 103959 GiB |
|       from large pool |  24320 KiB |   1229 MiB | 102191 GiB | 102191 GiB |
|       from small pool |      0 KiB |     42 MiB |   1767 GiB |   1767 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    2598    |   26107 K  |   26107 K  |
|       from large pool |       2    |    1413    |   13296 K  |   13296 K  |
|       from small pool |       0    |    1419    |   12810 K  |   12810 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    2598    |   26107 K  |   26107 K  |
|       from large pool |       2    |    1413    |   13296 K  |   13296 K  |
|       from small pool |       0    |    1419    |   12810 K  |   12810 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      62    |     637    |    1207    |    1145    |
|       from large pool |      37    |     602    |    1165    |    1128    |
|       from small pool |      25    |      35    |      42    |      17    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |     650    |   18198 K  |   18198 K  |
|       from large pool |       4    |     605    |   10485 K  |   10485 K  |
|       from small pool |       0    |     235    |    7713 K  |    7713 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'888c1ef2'
model name: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_06_16_57_seed_2_23065778

 Experiment start at: 2024-07-26 06:16:57.611167
before training, model accuracy: 0.41203704476356506
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9401178, 'precision': 0.9446106, 'recall': 0.94052273, 'specificity': 0.94052273, 'f1': 0.9400008, 'auroc': 0.9890989, 'binary_precision': 0.99131066, 'binary_recall': 0.888961, 'binary_specificity': 0.99208444, 'binary_f1_score': 0.9373502}
confusion matrix:
      0     1
0  1504    12
1   171  1369
---- Validation: 
scalar performance:
{'acc': 0.80046946, 'precision': 0.8097962, 'recall': 0.80272377, 'specificity': 0.80272377, 'f1': 0.79966474, 'auroc': 0.8950622, 'binary_precision': 0.74898237, 'binary_recall': 0.8874598, 'binary_specificity': 0.7179878, 'binary_f1_score': 0.812362}
confusion matrix:
     0    1
0  471  185
1   70  552
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7453704, 'precision': 0.7689849, 'recall': 0.7453704, 'specificity': 0.7453704, 'f1': 0.7396564, 'auroc': 0.8995199, 'binary_precision': 0.6892857, 'binary_recall': 0.8935185, 'binary_specificity': 0.5972222, 'binary_f1_score': 0.77822584}
confusion matrix:
     0    1
0  129   87
1   23  193
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-26 06:18:27.227257,epoch time: 0:01:29.616090,used: 0:01:29.616090,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_06_16_57_seed_2_23065778
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.96825916, 'precision': 0.9686647, 'recall': 0.96838826, 'specificity': 0.96838826, 'f1': 0.9682567, 'auroc': 0.99637973, 'binary_precision': 0.9845534, 'binary_recall': 0.95194805, 'binary_specificity': 0.9848285, 'binary_f1_score': 0.9679762}
confusion matrix:
      0     1
0  1493    23
1    74  1466
---- Validation: 
scalar performance:
{'acc': 0.7973396, 'precision': 0.8158953, 'recall': 0.80050826, 'specificity': 0.80050826, 'f1': 0.7953821, 'auroc': 0.9064412, 'binary_precision': 0.73239434, 'binary_recall': 0.91961414, 'binary_specificity': 0.68140244, 'binary_f1_score': 0.81539553}
confusion matrix:
     0    1
0  447  209
1   50  572
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6712963, 'precision': 0.7640064, 'recall': 0.6712963, 'specificity': 0.6712963, 'f1': 0.63966167, 'auroc': 0.89501894, 'binary_precision': 0.60755813, 'binary_recall': 0.9675926, 'binary_specificity': 0.375, 'binary_f1_score': 0.74642855}
confusion matrix:
    0    1
0  81  135
1   7  209
early stop counter: 1
val acc:0.7973396182060242, best validation acc: 0.8004694581031799, corresponding to test acc:                         0.7453703880310059 / 0.7453703880310059
after epoch: 2,now: 2024-07-26 06:19:53.447124,epoch time: 0:01:26.219867,used: 0:02:55.835957,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_06_16_57_seed_2_23065778
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.94404453, 'precision': 0.948694, 'recall': 0.9444548, 'specificity': 0.9444548, 'f1': 0.9439318, 'auroc': 0.9953513, 'binary_precision': 0.9963742, 'binary_recall': 0.8922078, 'binary_specificity': 0.99670184, 'binary_f1_score': 0.9414183}
confusion matrix:
      0     1
0  1511     5
1   166  1374
---- Validation: 
scalar performance:
{'acc': 0.773083, 'precision': 0.78891146, 'recall': 0.7698391, 'specificity': 0.7698391, 'f1': 0.76838565, 'auroc': 0.85775137, 'binary_precision': 0.85021096, 'binary_recall': 0.64790994, 'binary_specificity': 0.8917683, 'binary_f1_score': 0.7354014}
confusion matrix:
     0    1
0  585   71
1  219  403
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8101852, 'precision': 0.8128675, 'recall': 0.8101852, 'specificity': 0.8101852, 'f1': 0.8097775, 'auroc': 0.9123585, 'binary_precision': 0.7838983, 'binary_recall': 0.8564815, 'binary_specificity': 0.7638889, 'binary_f1_score': 0.8185841}
confusion matrix:
     0    1
0  165   51
1   31  185
new oracle model saved
early stop counter: 2
val acc:0.773082971572876, best validation acc: 0.8004694581031799, corresponding to test acc:                         0.7453703880310059 / 0.8101851940155029
after epoch: 3,now: 2024-07-26 06:21:19.617627,epoch time: 0:01:26.170503,used: 0:04:22.006460,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_06_16_57_seed_2_23065778
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9725131, 'precision': 0.97293997, 'recall': 0.97264504, 'specificity': 0.97264504, 'f1': 0.9725108, 'auroc': 0.99694383, 'binary_precision': 0.9892473, 'binary_recall': 0.95584416, 'binary_specificity': 0.9894459, 'binary_f1_score': 0.9722589}
confusion matrix:
      0     1
0  1500    16
1    68  1472
---- Validation: 
scalar performance:
{'acc': 0.80046946, 'precision': 0.8020221, 'recall': 0.79939073, 'specificity': 0.79939073, 'f1': 0.79970413, 'auroc': 0.8665669, 'binary_precision': 0.8180243, 'binary_recall': 0.75884247, 'binary_specificity': 0.839939, 'binary_f1_score': 0.78732276}
confusion matrix:
     0    1
0  551  105
1  150  472
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7569444, 'precision': 0.78252923, 'recall': 0.7569444, 'specificity': 0.7569444, 'f1': 0.7513144, 'auroc': 0.89926267, 'binary_precision': 0.6975089, 'binary_recall': 0.9074074, 'binary_specificity': 0.6064815, 'binary_f1_score': 0.78873235}
confusion matrix:
     0    1
0  131   85
1   20  196
early stop counter: 3
val acc:0.8004694581031799, best validation acc: 0.8004694581031799, corresponding to test acc:                         0.7453703880310059 / 0.8101851940155029
after epoch: 4,now: 2024-07-26 06:22:45.949840,epoch time: 0:01:26.332213,used: 0:05:48.338673,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_06_16_57_seed_2_23065778
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.976767, 'precision': 0.9772966, 'recall': 0.9769121, 'specificity': 0.9769121, 'f1': 0.9767643, 'auroc': 0.99774957, 'binary_precision': 0.99527985, 'binary_recall': 0.95844156, 'binary_specificity': 0.9953826, 'binary_f1_score': 0.9765134}
confusion matrix:
      0     1
0  1509     7
1    64  1476
---- Validation: 
scalar performance:
{'acc': 0.7308294, 'precision': 0.804772, 'recall': 0.7241393, 'specificity': 0.7241393, 'f1': 0.7095393, 'auroc': 0.8758559, 'binary_precision': 0.9483871, 'binary_recall': 0.4726688, 'binary_specificity': 0.9756098, 'binary_f1_score': 0.6309012}
confusion matrix:
     0    1
0  640   16
1  328  294
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7824074, 'precision': 0.8386102, 'recall': 0.7824074, 'specificity': 0.7824074, 'f1': 0.7729875, 'auroc': 0.89315414, 'binary_precision': 0.9765625, 'binary_recall': 0.5787037, 'binary_specificity': 0.9861111, 'binary_f1_score': 0.7267442}
confusion matrix:
     0    1
0  213    3
1   91  125
early stop counter: 4
val acc:0.7308294177055359, best validation acc: 0.8004694581031799, corresponding to test acc:                         0.7453703880310059 / 0.8101851940155029
after epoch: 5,now: 2024-07-26 06:24:12.057292,epoch time: 0:01:26.107452,used: 0:07:14.446125,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_06_16_57_seed_2_23065778
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9764398, 'precision': 0.9764956, 'recall': 0.9764075, 'specificity': 0.9764075, 'f1': 0.9764365, 'auroc': 0.99749297, 'binary_precision': 0.9729381, 'binary_recall': 0.9805195, 'binary_specificity': 0.9722955, 'binary_f1_score': 0.97671413}
confusion matrix:
      0     1
0  1474    42
1    30  1510
---- Validation: 
scalar performance:
{'acc': 0.7762128, 'precision': 0.8222176, 'recall': 0.77109635, 'specificity': 0.77109635, 'f1': 0.76559484, 'auroc': 0.89422643, 'binary_precision': 0.9375, 'binary_recall': 0.57877815, 'binary_specificity': 0.9634146, 'binary_f1_score': 0.71570575}
confusion matrix:
     0    1
0  632   24
1  262  360
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7962963, 'precision': 0.81764704, 'recall': 0.7962963, 'specificity': 0.7962963, 'f1': 0.79281485, 'auroc': 0.8888031, 'binary_precision': 0.9, 'binary_recall': 0.6666667, 'binary_specificity': 0.9259259, 'binary_f1_score': 0.76595753}
confusion matrix:
     0    1
0  200   16
1   72  144
early stop counter: 5
val acc:0.7762128114700317, best validation acc: 0.8004694581031799, corresponding to test acc:                         0.7453703880310059 / 0.8101851940155029
after epoch: 6,now: 2024-07-26 06:25:38.229128,epoch time: 0:01:26.171836,used: 0:08:40.617961,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_06_16_57_seed_2_23065778
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9764398, 'precision': 0.97647, 'recall': 0.9764178, 'specificity': 0.9764178, 'f1': 0.9764372, 'auroc': 0.99685264, 'binary_precision': 0.9741602, 'binary_recall': 0.9792208, 'binary_specificity': 0.97361475, 'binary_f1_score': 0.9766839}
confusion matrix:
      0     1
0  1476    40
1    32  1508
---- Validation: 
scalar performance:
{'acc': 0.85524255, 'precision': 0.86140114, 'recall': 0.85349435, 'specificity': 0.85349435, 'f1': 0.85410196, 'auroc': 0.9301673, 'binary_precision': 0.9023941, 'binary_recall': 0.78778136, 'binary_specificity': 0.91920733, 'binary_f1_score': 0.8412017}
confusion matrix:
     0    1
0  603   53
1  132  490
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8657407, 'precision': 0.8831163, 'recall': 0.8657408, 'specificity': 0.8657408, 'f1': 0.864201, 'auroc': 0.9349923, 'binary_precision': 0.9647059, 'binary_recall': 0.7592593, 'binary_specificity': 0.9722222, 'binary_f1_score': 0.8497409}
confusion matrix:
     0    1
0  210    6
1   52  164
new oracle model saved
better model found
persisted
after epoch: 7,now: 2024-07-26 06:27:04.434032,epoch time: 0:01:26.204904,used: 0:10:06.822865,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_06_16_57_seed_2_23065778
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.97447646, 'precision': 0.9747571, 'recall': 0.97439265, 'specificity': 0.97439265, 'f1': 0.9744679, 'auroc': 0.9978896, 'binary_precision': 0.9650127, 'binary_recall': 0.9850649, 'binary_specificity': 0.9637203, 'binary_f1_score': 0.97493577}
confusion matrix:
      0     1
0  1461    55
1    23  1517
---- Validation: 
scalar performance:
{'acc': 0.8395931, 'precision': 0.84286106, 'recall': 0.8382504, 'specificity': 0.8382504, 'f1': 0.83873916, 'auroc': 0.90068674, 'binary_precision': 0.8703375, 'binary_recall': 0.78778136, 'binary_specificity': 0.8887195, 'binary_f1_score': 0.8270042}
confusion matrix:
     0    1
0  583   73
1  132  490
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8333333, 'precision': 0.83621585, 'recall': 0.8333333, 'specificity': 0.8333333, 'f1': 0.8329754, 'auroc': 0.9335134, 'binary_precision': 0.80508476, 'binary_recall': 0.8796296, 'binary_specificity': 0.787037, 'binary_f1_score': 0.84070796}
confusion matrix:
     0    1
0  170   46
1   26  190
early stop counter: 1
val acc:0.8395931124687195, best validation acc: 0.8552425503730774, corresponding to test acc:                         0.8657407164573669 / 0.8657407164573669
after epoch: 8,now: 2024-07-26 06:28:30.457506,epoch time: 0:01:26.023474,used: 0:11:32.846339,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_06_16_57_seed_2_23065778
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9856021, 'precision': 0.98559517, 'recall': 0.98562175, 'specificity': 0.98562175, 'f1': 0.98560166, 'auroc': 0.9988966, 'binary_precision': 0.9882507, 'binary_recall': 0.98311687, 'binary_specificity': 0.98812664, 'binary_f1_score': 0.98567706}
confusion matrix:
      0     1
0  1498    18
1    26  1514
---- Validation: 
scalar performance:
{'acc': 0.69327074, 'precision': 0.7891886, 'recall': 0.6854291, 'specificity': 0.6854291, 'f1': 0.6599597, 'auroc': 0.86909366, 'binary_precision': 0.94921875, 'binary_recall': 0.39067525, 'binary_specificity': 0.98018295, 'binary_f1_score': 0.5535307}
confusion matrix:
     0    1
0  643   13
1  379  243
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7800926, 'precision': 0.7995118, 'recall': 0.7800926, 'specificity': 0.7800926, 'f1': 0.77646935, 'auroc': 0.8716564, 'binary_precision': 0.8757764, 'binary_recall': 0.6527778, 'binary_specificity': 0.9074074, 'binary_f1_score': 0.74801064}
confusion matrix:
     0    1
0  196   20
1   75  141
early stop counter: 2
val acc:0.693270742893219, best validation acc: 0.8552425503730774, corresponding to test acc:                         0.8657407164573669 / 0.8657407164573669
after epoch: 9,now: 2024-07-26 06:29:56.275805,epoch time: 0:01:25.818299,used: 0:12:58.664638,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_06_16_57_seed_2_23065778
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.98363876, 'precision': 0.9836964, 'recall': 0.9836069, 'specificity': 0.9836069, 'f1': 0.9836365, 'auroc': 0.99864686, 'binary_precision': 0.98002577, 'binary_recall': 0.9876623, 'binary_specificity': 0.97955143, 'binary_f1_score': 0.98382926}
confusion matrix:
      0     1
0  1485    31
1    19  1521
---- Validation: 
scalar performance:
{'acc': 0.75508606, 'precision': 0.80461776, 'recall': 0.7496005, 'specificity': 0.7496005, 'f1': 0.741887, 'auroc': 0.8936726, 'binary_precision': 0.92098093, 'binary_recall': 0.54340833, 'binary_specificity': 0.95579267, 'binary_f1_score': 0.6835187}
confusion matrix:
     0    1
0  627   29
1  284  338
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7731481, 'precision': 0.8336824, 'recall': 0.7731482, 'specificity': 0.7731482, 'f1': 0.76237094, 'auroc': 0.9117584, 'binary_precision': 0.9758065, 'binary_recall': 0.5601852, 'binary_specificity': 0.9861111, 'binary_f1_score': 0.71176475}
confusion matrix:
     0    1
0  213    3
1   95  121
early stop counter: 3
val acc:0.7550860643386841, best validation acc: 0.8552425503730774, corresponding to test acc:                         0.8657407164573669 / 0.8657407164573669
after epoch: 10,now: 2024-07-26 06:31:22.128862,epoch time: 0:01:25.853057,used: 0:14:24.517695,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_06_16_57_seed_2_23065778
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.98658377, 'precision': 0.9866663, 'recall': 0.9865444, 'specificity': 0.9865444, 'f1': 0.98658156, 'auroc': 0.99926543, 'binary_precision': 0.98199356, 'binary_recall': 0.99155843, 'binary_specificity': 0.98153037, 'binary_f1_score': 0.9867528}
confusion matrix:
      0     1
0  1488    28
1    13  1527
---- Validation: 
scalar performance:
{'acc': 0.8176839, 'precision': 0.8454901, 'recall': 0.81386757, 'specificity': 0.81386757, 'f1': 0.8125749, 'auroc': 0.91092426, 'binary_precision': 0.93707865, 'binary_recall': 0.670418, 'binary_specificity': 0.95731705, 'binary_f1_score': 0.78163075}
confusion matrix:
     0    1
0  628   28
1  205  417
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7986111, 'precision': 0.82449055, 'recall': 0.7986111, 'specificity': 0.7986111, 'f1': 0.79451406, 'auroc': 0.91240144, 'binary_precision': 0.91612905, 'binary_recall': 0.6574074, 'binary_specificity': 0.9398148, 'binary_f1_score': 0.76549864}
confusion matrix:
     0    1
0  203   13
1   74  142
early stop counter: 4
val acc:0.8176838755607605, best validation acc: 0.8552425503730774, corresponding to test acc:                         0.8657407164573669 / 0.8657407164573669
after epoch: 11,now: 2024-07-26 06:32:48.662068,epoch time: 0:01:26.533206,used: 0:15:51.050901,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_06_16_57_seed_2_23065778
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.98625654, 'precision': 0.9863913, 'recall': 0.9863379, 'specificity': 0.9863379, 'f1': 0.9862565, 'auroc': 0.9987878, 'binary_precision': 0.9966844, 'binary_recall': 0.975974, 'binary_specificity': 0.99670184, 'binary_f1_score': 0.9862205}
confusion matrix:
      0     1
0  1511     5
1    37  1503
---- Validation: 
scalar performance:
{'acc': 0.7816901, 'precision': 0.8273562, 'recall': 0.77664006, 'specificity': 0.77664006, 'f1': 0.7715697, 'auroc': 0.89961696, 'binary_precision': 0.9431524, 'binary_recall': 0.5868167, 'binary_specificity': 0.9664634, 'binary_f1_score': 0.72348857}
confusion matrix:
     0    1
0  634   22
1  257  365
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5787037, 'precision': 0.7241758, 'recall': 0.5787037, 'specificity': 0.5787037, 'f1': 0.4971218, 'auroc': 0.8451646, 'binary_precision': 0.9047619, 'binary_recall': 0.17592593, 'binary_specificity': 0.9814815, 'binary_f1_score': 0.29457363}
confusion matrix:
     0   1
0  212   4
1  178  38
early stop counter: 5
val acc:0.7816901206970215, best validation acc: 0.8552425503730774, corresponding to test acc:                         0.8657407164573669 / 0.8657407164573669
after epoch: 12,now: 2024-07-26 06:34:14.769534,epoch time: 0:01:26.107466,used: 0:17:17.158367,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_06_16_57_seed_2_23065778
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.986911, 'precision': 0.9870248, 'recall': 0.9869873, 'specificity': 0.9869873, 'f1': 0.98691094, 'auroc': 0.99947697, 'binary_precision': 0.9966887, 'binary_recall': 0.97727275, 'binary_specificity': 0.99670184, 'binary_f1_score': 0.98688525}
confusion matrix:
      0     1
0  1511     5
1    35  1505
---- Validation: 
scalar performance:
{'acc': 0.80594677, 'precision': 0.84072286, 'recall': 0.801643, 'specificity': 0.801643, 'f1': 0.79921544, 'auroc': 0.899704, 'binary_precision': 0.943128, 'binary_recall': 0.63987136, 'binary_specificity': 0.9634146, 'binary_f1_score': 0.76245207}
confusion matrix:
     0    1
0  632   24
1  224  398
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7314815, 'precision': 0.78846157, 'recall': 0.7314815, 'specificity': 0.7314815, 'f1': 0.7175325, 'auroc': 0.8750857, 'binary_precision': 0.9166667, 'binary_recall': 0.5092593, 'binary_specificity': 0.9537037, 'binary_f1_score': 0.6547619}
confusion matrix:
     0    1
0  206   10
1  106  110
early stop counter: 6
val acc:0.8059467673301697, best validation acc: 0.8552425503730774, corresponding to test acc:                         0.8657407164573669 / 0.8657407164573669
after epoch: 13,now: 2024-07-26 06:35:41.170075,epoch time: 0:01:26.400541,used: 0:18:43.558908,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_06_16_57_seed_2_23065778
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.99018323, 'precision': 0.99017537, 'recall': 0.9901981, 'specificity': 0.9901981, 'f1': 0.99018294, 'auroc': 0.99953187, 'binary_precision': 0.9921773, 'binary_recall': 0.9883117, 'binary_specificity': 0.99208444, 'binary_f1_score': 0.99024075}
confusion matrix:
      0     1
0  1504    12
1    18  1522
---- Validation: 
scalar performance:
{'acc': 0.6682316, 'precision': 0.79439574, 'recall': 0.6593306, 'specificity': 0.6593306, 'f1': 0.6212762, 'auroc': 0.9153847, 'binary_precision': 0.98058254, 'binary_recall': 0.32475883, 'binary_specificity': 0.99390244, 'binary_f1_score': 0.4879227}
confusion matrix:
     0    1
0  652    4
1  420  202
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5740741, 'precision': 0.77, 'recall': 0.5740741, 'specificity': 0.5740741, 'f1': 0.47968164, 'auroc': 0.9127872, 'binary_precision': 1.0, 'binary_recall': 0.14814815, 'binary_specificity': 1.0, 'binary_f1_score': 0.2580645}
confusion matrix:
     0   1
0  216   0
1  184  32
early stop counter: 7
val acc:0.6682316064834595, best validation acc: 0.8552425503730774, corresponding to test acc:                         0.8657407164573669 / 0.8657407164573669
after epoch: 14,now: 2024-07-26 06:37:07.222063,epoch time: 0:01:26.051988,used: 0:20:09.610896,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_06_16_57_seed_2_23065778
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.97840315, 'precision': 0.97909164, 'recall': 0.9785663, 'specificity': 0.9785663, 'f1': 0.9783994, 'auroc': 0.99936783, 'binary_precision': 0.9993225, 'binary_recall': 0.9577922, 'binary_specificity': 0.99934036, 'binary_f1_score': 0.97811675}
confusion matrix:
      0     1
0  1515     1
1    65  1475
---- Validation: 
scalar performance:
{'acc': 0.6611894, 'precision': 0.78683877, 'recall': 0.65217924, 'specificity': 0.65217924, 'f1': 0.6120101, 'auroc': 0.9116025, 'binary_precision': 0.9701493, 'binary_recall': 0.31350482, 'binary_specificity': 0.99085367, 'binary_f1_score': 0.47387606}
confusion matrix:
     0    1
0  650    6
1  427  195
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6574074, 'precision': 0.78981847, 'recall': 0.6574074, 'specificity': 0.6574074, 'f1': 0.61323106, 'auroc': 0.8940544, 'binary_precision': 0.98571426, 'binary_recall': 0.31944445, 'binary_specificity': 0.9953704, 'binary_f1_score': 0.48251745}
confusion matrix:
     0   1
0  215   1
1  147  69
early stop counter: 8
val acc:0.6611893773078918, best validation acc: 0.8552425503730774, corresponding to test acc:                         0.8657407164573669 / 0.8657407164573669
after epoch: 15,now: 2024-07-26 06:38:33.598569,epoch time: 0:01:26.376506,used: 0:21:35.987402,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_06_16_57_seed_2_23065778
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.98134816, 'precision': 0.9813403, 'recall': 0.98135984, 'specificity': 0.98135984, 'f1': 0.98134744, 'auroc': 0.9979581, 'binary_precision': 0.9830619, 'binary_recall': 0.97987014, 'binary_specificity': 0.9828496, 'binary_f1_score': 0.9814634}
confusion matrix:
      0     1
0  1490    26
1    31  1509
---- Validation: 
scalar performance:
{'acc': 0.8403756, 'precision': 0.85769737, 'recall': 0.8374294, 'specificity': 0.8374294, 'f1': 0.8375002, 'auroc': 0.9169183, 'binary_precision': 0.93004113, 'binary_recall': 0.7266881, 'binary_specificity': 0.9481707, 'binary_f1_score': 0.8158844}
confusion matrix:
     0    1
0  622   34
1  170  452
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7893519, 'precision': 0.8340344, 'recall': 0.7893518, 'specificity': 0.7893518, 'f1': 0.7820637, 'auroc': 0.89889836, 'binary_precision': 0.95620435, 'binary_recall': 0.6064815, 'binary_specificity': 0.9722222, 'binary_f1_score': 0.7422096}
confusion matrix:
     0    1
0  210    6
1   85  131
early stop counter: 9
val acc:0.8403756022453308, best validation acc: 0.8552425503730774, corresponding to test acc:                         0.8657407164573669 / 0.8657407164573669
after epoch: 16,now: 2024-07-26 06:39:59.570754,epoch time: 0:01:25.972185,used: 0:23:01.959587,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_06_16_57_seed_2_23065778
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.98658377, 'precision': 0.9867078, 'recall': 0.9866626, 'specificity': 0.9866626, 'f1': 0.9865837, 'auroc': 0.9990332, 'binary_precision': 0.9966865, 'binary_recall': 0.97662336, 'binary_specificity': 0.99670184, 'binary_f1_score': 0.98655295}
confusion matrix:
      0     1
0  1511     5
1    36  1504
---- Validation: 
scalar performance:
{'acc': 0.79264474, 'precision': 0.83755124, 'recall': 0.7877275, 'specificity': 0.7877275, 'f1': 0.783475, 'auroc': 0.9095322, 'binary_precision': 0.9541985, 'binary_recall': 0.6028939, 'binary_specificity': 0.972561, 'binary_f1_score': 0.7389162}
confusion matrix:
     0    1
0  638   18
1  247  375
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7037037, 'precision': 0.8087719, 'recall': 0.7037037, 'specificity': 0.7037037, 'f1': 0.6761544, 'auroc': 0.9012774, 'binary_precision': 0.98888886, 'binary_recall': 0.41203704, 'binary_specificity': 0.9953704, 'binary_f1_score': 0.5816994}
confusion matrix:
     0   1
0  215   1
1  127  89
early stop counter: 10
val acc:0.792644739151001, best validation acc: 0.8552425503730774, corresponding to test acc:                         0.8657407164573669 / 0.8657407164573669
after epoch: 17,now: 2024-07-26 06:41:25.516223,epoch time: 0:01:25.945469,used: 0:24:27.905056,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_06_16_57_seed_2_23065778
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.989856, 'precision': 0.98990965, 'recall': 0.98991454, 'specificity': 0.98991454, 'f1': 0.989856, 'auroc': 0.9989853, 'binary_precision': 0.9973632, 'binary_recall': 0.98246753, 'binary_specificity': 0.9973615, 'binary_f1_score': 0.98985934}
confusion matrix:
      0     1
0  1512     4
1    27  1513
---- Validation: 
scalar performance:
{'acc': 0.6658842, 'precision': 0.78060114, 'recall': 0.65716904, 'specificity': 0.65716904, 'f1': 0.62072223, 'auroc': 0.89750075, 'binary_precision': 0.95348835, 'binary_recall': 0.329582, 'binary_specificity': 0.9847561, 'binary_f1_score': 0.4898447}
confusion matrix:
     0    1
0  646   10
1  417  205
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6967593, 'precision': 0.8112392, 'recall': 0.6967592, 'specificity': 0.6967592, 'f1': 0.66605103, 'auroc': 0.91688097, 'binary_precision': 1.0, 'binary_recall': 0.3935185, 'binary_specificity': 1.0, 'binary_f1_score': 0.56478405}
confusion matrix:
     0   1
0  216   0
1  131  85
early stop counter: 11
val acc:0.6658841967582703, best validation acc: 0.8552425503730774, corresponding to test acc:                         0.8657407164573669 / 0.8657407164573669
after epoch: 18,now: 2024-07-26 06:42:51.512027,epoch time: 0:01:25.995804,used: 0:25:53.900860,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_06_16_57_seed_2_23065778
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9826571, 'precision': 0.98311025, 'recall': 0.9827922, 'specificity': 0.9827922, 'f1': 0.9826555, 'auroc': 0.99951124, 'binary_precision': 1.0, 'binary_recall': 0.9655844, 'binary_specificity': 1.0, 'binary_f1_score': 0.9824909}
confusion matrix:
      0     1
0  1516     0
1    53  1487
---- Validation: 
scalar performance:
{'acc': 0.62441313, 'precision': 0.772629, 'recall': 0.6143562, 'specificity': 0.6143562, 'f1': 0.55524236, 'auroc': 0.856086, 'binary_precision': 0.96710527, 'binary_recall': 0.2363344, 'binary_specificity': 0.99237806, 'binary_f1_score': 0.37984493}
confusion matrix:
     0    1
0  651    5
1  475  147
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.650463, 'precision': 0.7942779, 'recall': 0.650463, 'specificity': 0.650463, 'f1': 0.60181415, 'auroc': 0.89941275, 'binary_precision': 1.0, 'binary_recall': 0.30092594, 'binary_specificity': 1.0, 'binary_f1_score': 0.46263346}
confusion matrix:
     0   1
0  216   0
1  151  65
early stop counter: 12
val acc:0.6244131326675415, best validation acc: 0.8552425503730774, corresponding to test acc:                         0.8657407164573669 / 0.8657407164573669
after epoch: 19,now: 2024-07-26 06:44:17.536060,epoch time: 0:01:26.024033,used: 0:27:19.924893,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_06_16_57_seed_2_23065778
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.99018323, 'precision': 0.9902584, 'recall': 0.99014664, 'specificity': 0.99014664, 'f1': 0.99018174, 'auroc': 0.99944746, 'binary_precision': 0.985843, 'binary_recall': 0.9948052, 'binary_specificity': 0.9854881, 'binary_f1_score': 0.9903038}
confusion matrix:
      0     1
0  1494    22
1     8  1532
---- Validation: 
scalar performance:
{'acc': 0.8200313, 'precision': 0.8403176, 'recall': 0.8167374, 'specificity': 0.8167374, 'f1': 0.8161368, 'auroc': 0.9005152, 'binary_precision': 0.9170213, 'binary_recall': 0.69292605, 'binary_specificity': 0.9405488, 'binary_f1_score': 0.78937733}
confusion matrix:
     0    1
0  617   39
1  191  431
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7777778, 'precision': 0.8245517, 'recall': 0.7777778, 'specificity': 0.7777778, 'f1': 0.76947194, 'auroc': 0.8937543, 'binary_precision': 0.9477612, 'binary_recall': 0.587963, 'binary_specificity': 0.9675926, 'binary_f1_score': 0.72571427}
confusion matrix:
     0    1
0  209    7
1   89  127
early stop counter: 13
val acc:0.8200312852859497, best validation acc: 0.8552425503730774, corresponding to test acc:                         0.8657407164573669 / 0.8657407164573669
after epoch: 20,now: 2024-07-26 06:45:43.704812,epoch time: 0:01:26.168752,used: 0:28:46.093645,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_06_16_57_seed_2_23065778
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9947644, 'precision': 0.99477804, 'recall': 0.9948052, 'specificity': 0.9948052, 'f1': 0.9947643, 'auroc': 0.99983895, 'binary_precision': 1.0, 'binary_recall': 0.9896104, 'binary_specificity': 1.0, 'binary_f1_score': 0.99477804}
confusion matrix:
      0     1
0  1516     0
1    16  1524
---- Validation: 
scalar performance:
{'acc': 0.6486698, 'precision': 0.778717, 'recall': 0.6393592, 'specificity': 0.6393592, 'f1': 0.5939909, 'auroc': 0.8927351, 'binary_precision': 0.96256685, 'binary_recall': 0.28938907, 'binary_specificity': 0.9893293, 'binary_f1_score': 0.4449938}
confusion matrix:
     0    1
0  649    7
1  442  180
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6481481, 'precision': 0.79347825, 'recall': 0.6481482, 'specificity': 0.6481482, 'f1': 0.59843445, 'auroc': 0.91244423, 'binary_precision': 1.0, 'binary_recall': 0.2962963, 'binary_specificity': 1.0, 'binary_f1_score': 0.45714283}
confusion matrix:
     0   1
0  216   0
1  152  64
early stop counter: 14
val acc:0.6486697793006897, best validation acc: 0.8552425503730774, corresponding to test acc:                         0.8657407164573669 / 0.8657407164573669
after epoch: 21,now: 2024-07-26 06:47:09.745453,epoch time: 0:01:26.040641,used: 0:30:12.134286,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_06_16_57_seed_2_23065778
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9947644, 'precision': 0.9947566, 'recall': 0.99477947, 'specificity': 0.99477947, 'f1': 0.9947642, 'auroc': 0.99987537, 'binary_precision': 0.9967405, 'binary_recall': 0.99285716, 'binary_specificity': 0.99670184, 'binary_f1_score': 0.9947951}
confusion matrix:
      0     1
0  1511     5
1    11  1529
---- Validation: 
scalar performance:
{'acc': 0.6737089, 'precision': 0.7967136, 'recall': 0.66495764, 'specificity': 0.66495764, 'f1': 0.6291489, 'auroc': 0.9041282, 'binary_precision': 0.98122066, 'binary_recall': 0.33601287, 'binary_specificity': 0.99390244, 'binary_f1_score': 0.5005988}
confusion matrix:
     0    1
0  652    4
1  413  209
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5509259, 'precision': 0.72508526, 'recall': 0.5509259, 'specificity': 0.5509259, 'f1': 0.443225, 'auroc': 0.8513589, 'binary_precision': 0.9230769, 'binary_recall': 0.11111111, 'binary_specificity': 0.9907407, 'binary_f1_score': 0.1983471}
confusion matrix:
     0   1
0  214   2
1  192  24
early stop counter: 15
val acc:0.6737089157104492, best validation acc: 0.8552425503730774, corresponding to test acc:                         0.8657407164573669 / 0.8657407164573669
after epoch: 22,now: 2024-07-26 06:48:35.924942,epoch time: 0:01:26.179489,used: 0:31:38.313775,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_06_16_57_seed_2_23065778
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.9921466, 'precision': 0.99218065, 'recall': 0.9921975, 'specificity': 0.9921975, 'f1': 0.99214655, 'auroc': 0.99981534, 'binary_precision': 0.9986842, 'binary_recall': 0.98571426, 'binary_specificity': 0.9986807, 'binary_f1_score': 0.99215686}
confusion matrix:
      0     1
0  1514     2
1    22  1518
---- Validation: 
scalar performance:
{'acc': 0.68388104, 'precision': 0.78777695, 'recall': 0.6756995, 'specificity': 0.6756995, 'f1': 0.64641684, 'auroc': 0.90931714, 'binary_precision': 0.95416665, 'binary_recall': 0.3681672, 'binary_specificity': 0.9832317, 'binary_f1_score': 0.5313225}
confusion matrix:
     0    1
0  645   11
1  393  229
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6087963, 'precision': 0.7704748, 'recall': 0.6087963, 'specificity': 0.6087963, 'f1': 0.5400636, 'auroc': 0.85471857, 'binary_precision': 0.97959185, 'binary_recall': 0.22222222, 'binary_specificity': 0.9953704, 'binary_f1_score': 0.36226416}
confusion matrix:
     0   1
0  215   1
1  168  48
early stop counter: 16
val acc:0.6838810443878174, best validation acc: 0.8552425503730774, corresponding to test acc:                         0.8657407164573669 / 0.8657407164573669
after epoch: 23,now: 2024-07-26 06:50:02.066585,epoch time: 0:01:26.141643,used: 0:33:04.455418,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_06_16_57_seed_2_23065778
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.99443716, 'precision': 0.99443483, 'recall': 0.9944651, 'specificity': 0.9944651, 'f1': 0.9944371, 'auroc': 0.99977684, 'binary_precision': 0.99803793, 'binary_recall': 0.9909091, 'binary_specificity': 0.9980211, 'binary_f1_score': 0.9944607}
confusion matrix:
      0     1
0  1513     3
1    14  1526
---- Validation: 
scalar performance:
{'acc': 0.62910795, 'precision': 0.7562555, 'recall': 0.619471, 'specificity': 0.619471, 'f1': 0.5670051, 'auroc': 0.8775892, 'binary_precision': 0.9302326, 'binary_recall': 0.25723472, 'binary_specificity': 0.98170733, 'binary_f1_score': 0.40302265}
confusion matrix:
     0    1
0  644   12
1  462  160
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6458333, 'precision': 0.7926829, 'recall': 0.6458333, 'specificity': 0.6458333, 'f1': 0.5950372, 'auroc': 0.90391374, 'binary_precision': 1.0, 'binary_recall': 0.29166666, 'binary_specificity': 1.0, 'binary_f1_score': 0.4516129}
confusion matrix:
     0   1
0  216   0
1  153  63
early stop counter: 17
val acc:0.6291079521179199, best validation acc: 0.8552425503730774, corresponding to test acc:                         0.8657407164573669 / 0.8657407164573669
after epoch: 24,now: 2024-07-26 06:51:28.000536,epoch time: 0:01:25.933951,used: 0:34:30.389369,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_06_16_57_seed_2_23065778
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.9928011, 'precision': 0.9928006, 'recall': 0.9928006, 'specificity': 0.9928006, 'f1': 0.9928006, 'auroc': 0.99927956, 'binary_precision': 0.99285716, 'binary_recall': 0.99285716, 'binary_specificity': 0.9927441, 'binary_f1_score': 0.99285716}
confusion matrix:
      0     1
0  1505    11
1    11  1529
---- Validation: 
scalar performance:
{'acc': 0.7824726, 'precision': 0.821807, 'recall': 0.7777356, 'specificity': 0.7777356, 'f1': 0.7735268, 'auroc': 0.89209545, 'binary_precision': 0.9278607, 'binary_recall': 0.59967846, 'binary_specificity': 0.95579267, 'binary_f1_score': 0.7285156}
confusion matrix:
     0    1
0  627   29
1  249  373
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7800926, 'precision': 0.8140214, 'recall': 0.7800926, 'specificity': 0.7800926, 'f1': 0.77398765, 'auroc': 0.8745713, 'binary_precision': 0.9172414, 'binary_recall': 0.6157407, 'binary_specificity': 0.9444444, 'binary_f1_score': 0.7368421}
confusion matrix:
     0    1
0  204   12
1   83  133
early stop counter: 18
val acc:0.7824726104736328, best validation acc: 0.8552425503730774, corresponding to test acc:                         0.8657407164573669 / 0.8657407164573669
after epoch: 25,now: 2024-07-26 06:52:54.131514,epoch time: 0:01:26.130978,used: 0:35:56.520347,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_06_16_57_seed_2_23065778
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9931283, 'precision': 0.99313104, 'recall': 0.99316126, 'specificity': 0.99316126, 'f1': 0.9931282, 'auroc': 0.9997297, 'binary_precision': 0.9973805, 'binary_recall': 0.98896104, 'binary_specificity': 0.9973615, 'binary_f1_score': 0.9931529}
confusion matrix:
      0     1
0  1512     4
1    17  1523
---- Validation: 
scalar performance:
{'acc': 0.80046946, 'precision': 0.8388646, 'recall': 0.79593265, 'specificity': 0.79593265, 'f1': 0.79285675, 'auroc': 0.91023934, 'binary_precision': 0.94647205, 'binary_recall': 0.6254019, 'binary_specificity': 0.9664634, 'binary_f1_score': 0.75314623}
confusion matrix:
     0    1
0  634   22
1  233  389
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8263889, 'precision': 0.84565884, 'recall': 0.82638884, 'specificity': 0.82638884, 'f1': 0.82393503, 'auroc': 0.896755, 'binary_precision': 0.92727274, 'binary_recall': 0.7083333, 'binary_specificity': 0.9444444, 'binary_f1_score': 0.8031496}
confusion matrix:
     0    1
0  204   12
1   63  153
early stop counter: 19
val acc:0.8004694581031799, best validation acc: 0.8552425503730774, corresponding to test acc:                         0.8657407164573669 / 0.8657407164573669
after epoch: 26,now: 2024-07-26 06:54:19.995370,epoch time: 0:01:25.863856,used: 0:37:22.384203,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_06_16_57_seed_2_23065778
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.99247384, 'precision': 0.992514, 'recall': 0.9925273, 'specificity': 0.9925273, 'f1': 0.9924738, 'auroc': 0.9997597, 'binary_precision': 0.99934167, 'binary_recall': 0.98571426, 'binary_specificity': 0.99934036, 'binary_f1_score': 0.9924812}
confusion matrix:
      0     1
0  1515     1
1    22  1518
---- Validation: 
scalar performance:
{'acc': 0.6197183, 'precision': 0.7614285, 'recall': 0.60965806, 'specificity': 0.60965806, 'f1': 0.54968286, 'auroc': 0.8768301, 'binary_precision': 0.94736844, 'binary_recall': 0.23151125, 'binary_specificity': 0.9878049, 'binary_f1_score': 0.372093}
confusion matrix:
     0    1
0  648    8
1  478  144
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.587963, 'precision': 0.75054944, 'recall': 0.5879629, 'specificity': 0.5879629, 'f1': 0.50817406, 'auroc': 0.8715278, 'binary_precision': 0.95238096, 'binary_recall': 0.18518518, 'binary_specificity': 0.9907407, 'binary_f1_score': 0.31007752}
confusion matrix:
     0   1
0  214   2
1  176  40
early stop counter: 20
val acc:0.6197183132171631, best validation acc: 0.8552425503730774, corresponding to test acc:                         0.8657407164573669 / 0.8657407164573669
after epoch: 27,now: 2024-07-26 06:55:45.803771,epoch time: 0:01:25.808401,used: 0:38:48.192604,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_06_16_57_seed_2_23065778
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.9856021, 'precision': 0.9858974, 'recall': 0.9857143, 'specificity': 0.9857143, 'f1': 0.9856014, 'auroc': 0.99990493, 'binary_precision': 1.0, 'binary_recall': 0.9714286, 'binary_specificity': 1.0, 'binary_f1_score': 0.9855072}
confusion matrix:
      0     1
0  1516     0
1    44  1496
---- Validation: 
scalar performance:
{'acc': 0.62676054, 'precision': 0.7797734, 'recall': 0.6166845, 'specificity': 0.6166845, 'f1': 0.5576985, 'auroc': 0.9191877, 'binary_precision': 0.98013246, 'binary_recall': 0.23794213, 'binary_specificity': 0.99542683, 'binary_f1_score': 0.3829237}
confusion matrix:
     0    1
0  653    3
1  474  148
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.525463, 'precision': 0.7565321, 'recall': 0.525463, 'specificity': 0.525463, 'f1': 0.38754764, 'auroc': 0.904171, 'binary_precision': 1.0, 'binary_recall': 0.050925925, 'binary_specificity': 1.0, 'binary_f1_score': 0.096916296}
confusion matrix:
     0   1
0  216   0
1  205  11
early stop counter: 21
val acc:0.6267605423927307, best validation acc: 0.8552425503730774, corresponding to test acc:                         0.8657407164573669 / 0.8657407164573669
after epoch: 28,now: 2024-07-26 06:57:11.598591,epoch time: 0:01:25.794820,used: 0:40:13.987424,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_06_16_57_seed_2_23065778
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.99051046, 'precision': 0.9906149, 'recall': 0.9905844, 'specificity': 0.9905844, 'f1': 0.99051046, 'auroc': 0.99992204, 'binary_precision': 1.0, 'binary_recall': 0.9811688, 'binary_specificity': 1.0, 'binary_f1_score': 0.99049497}
confusion matrix:
      0     1
0  1516     0
1    29  1511
---- Validation: 
scalar performance:
{'acc': 0.7363067, 'precision': 0.81975496, 'recall': 0.72939134, 'specificity': 0.72939134, 'f1': 0.7139886, 'auroc': 0.9134817, 'binary_precision': 0.9765886, 'binary_recall': 0.46945336, 'binary_specificity': 0.9893293, 'binary_f1_score': 0.63409334}
confusion matrix:
     0    1
0  649    7
1  330  292
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5810185, 'precision': 0.7586384, 'recall': 0.5810185, 'specificity': 0.5810185, 'f1': 0.49417466, 'auroc': 0.90594995, 'binary_precision': 0.972973, 'binary_recall': 0.16666667, 'binary_specificity': 0.9953704, 'binary_f1_score': 0.284585}
confusion matrix:
     0   1
0  215   1
1  180  36
early stop counter: 22
val acc:0.7363067269325256, best validation acc: 0.8552425503730774, corresponding to test acc:                         0.8657407164573669 / 0.8657407164573669
after epoch: 29,now: 2024-07-26 06:58:37.550686,epoch time: 0:01:25.952095,used: 0:41:39.939519,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_06_16_57_seed_2_23065778
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.9941099, 'precision': 0.9941559, 'recall': 0.9940839, 'specificity': 0.9940839, 'f1': 0.9941093, 'auroc': 0.99980855, 'binary_precision': 0.99096775, 'binary_recall': 0.9974026, 'binary_specificity': 0.99076515, 'binary_f1_score': 0.9941748}
confusion matrix:
      0     1
0  1502    14
1     4  1536
---- Validation: 
scalar performance:
{'acc': 0.842723, 'precision': 0.8488891, 'recall': 0.84092426, 'specificity': 0.84092426, 'f1': 0.8414391, 'auroc': 0.912747, 'binary_precision': 0.8890943, 'binary_recall': 0.7733119, 'binary_specificity': 0.9085366, 'binary_f1_score': 0.82717115}
confusion matrix:
     0    1
0  596   60
1  141  481
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.724537, 'precision': 0.7975545, 'recall': 0.724537, 'specificity': 0.724537, 'f1': 0.7065335, 'auroc': 0.9037851, 'binary_precision': 0.94495416, 'binary_recall': 0.47685185, 'binary_specificity': 0.9722222, 'binary_f1_score': 0.63384616}
confusion matrix:
     0    1
0  210    6
1  113  103
early stop counter: 23
val acc:0.84272301197052, best validation acc: 0.8552425503730774, corresponding to test acc:                         0.8657407164573669 / 0.8657407164573669
after epoch: 30,now: 2024-07-26 07:00:03.508448,epoch time: 0:01:25.957762,used: 0:43:05.897281,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_06_16_57_seed_2_23065778
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 0:43:05.897281 at 2024-07-26 07:00:03.508448
persisted model performance metric: 

scalar performance:
{'acc': 0.8657407, 'precision': 0.8831163, 'recall': 0.8657408, 'specificity': 0.8657408, 'f1': 0.864201, 'auroc': 0.9349923, 'binary_precision': 0.9647059, 'binary_recall': 0.7592593, 'binary_specificity': 0.9722222, 'binary_f1_score': 0.8497409}
confusion matrix:
     0    1
0  210    6
1   52  164
oracle model performance metric: 

scalar performance:
{'acc': 0.8657407, 'precision': 0.8831163, 'recall': 0.8657408, 'specificity': 0.8657408, 'f1': 0.864201, 'auroc': 0.9349923, 'binary_precision': 0.9647059, 'binary_recall': 0.7592593, 'binary_specificity': 0.9722222, 'binary_f1_score': 0.8497409}
confusion matrix:
     0    1
0  210    6
1   52  164
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_irm_10seeds_nofreeze_2024-07-26_02-28-54/rule_results/1.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_irm_10seeds_nofreeze_2024-07-26_02-28-54/confusion_matrix/1.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 455396 KiB |  13219 MiB | 221134 GiB | 221134 GiB |
|       from large pool | 414803 KiB |  13181 MiB | 218514 GiB | 218513 GiB |
|       from small pool |  40592 KiB |     60 MiB |   2620 GiB |   2620 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 455396 KiB |  13219 MiB | 221134 GiB | 221134 GiB |
|       from large pool | 414803 KiB |  13181 MiB | 218514 GiB | 218513 GiB |
|       from small pool |  40592 KiB |     60 MiB |   2620 GiB |   2620 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 447481 KiB |  13213 MiB | 220529 GiB | 220529 GiB |
|       from large pool | 407075 KiB |  13175 MiB | 217914 GiB | 217914 GiB |
|       from small pool |  40406 KiB |     60 MiB |   2615 GiB |   2615 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  14478 MiB |  14482 MiB |  41642 MiB |  27164 MiB |
|       from large pool |  14412 MiB |  14412 MiB |  41542 MiB |  27130 MiB |
|       from small pool |     66 MiB |     70 MiB |    100 MiB |     34 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 447772 KiB |   1236 MiB | 154862 GiB | 154862 GiB |
|       from large pool | 435116 KiB |   1229 MiB | 152225 GiB | 152225 GiB |
|       from small pool |  12655 KiB |     42 MiB |   2636 GiB |   2636 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    1298    |    2598    |   38978 K  |   38977 K  |
|       from large pool |     187    |    1413    |   19852 K  |   19851 K  |
|       from small pool |    1111    |    1419    |   19126 K  |   19125 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    1298    |    2598    |   38978 K  |   38977 K  |
|       from large pool |     187    |    1413    |   19852 K  |   19851 K  |
|       from small pool |    1111    |    1419    |   19126 K  |   19125 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     635    |     637    |    1780    |    1145    |
|       from large pool |     602    |     602    |    1730    |    1128    |
|       from small pool |      33    |      35    |      50    |      17    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     106    |     652    |   26755 K  |   26754 K  |
|       from large pool |      38    |     605    |   15471 K  |   15471 K  |
|       from small pool |      68    |     235    |   11283 K  |   11283 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13219 MiB | 221134 GiB | 221134 GiB |
|       from large pool |  16640 KiB |  13181 MiB | 218514 GiB | 218514 GiB |
|       from small pool |      0 KiB |     60 MiB |   2620 GiB |   2620 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13219 MiB | 221134 GiB | 221134 GiB |
|       from large pool |  16640 KiB |  13181 MiB | 218514 GiB | 218514 GiB |
|       from small pool |      0 KiB |     60 MiB |   2620 GiB |   2620 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13213 MiB | 220529 GiB | 220529 GiB |
|       from large pool |  16640 KiB |  13175 MiB | 217914 GiB | 217914 GiB |
|       from small pool |      0 KiB |     60 MiB |   2615 GiB |   2615 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    882 MiB |  14482 MiB |  41642 MiB |  40760 MiB |
|       from large pool |    830 MiB |  14412 MiB |  41542 MiB |  40712 MiB |
|       from small pool |     52 MiB |     70 MiB |    100 MiB |     48 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1236 MiB | 154863 GiB | 154862 GiB |
|       from large pool |  24320 KiB |   1229 MiB | 152226 GiB | 152226 GiB |
|       from small pool |      0 KiB |     44 MiB |   2636 GiB |   2636 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    2598    |   38978 K  |   38978 K  |
|       from large pool |       2    |    1413    |   19852 K  |   19852 K  |
|       from small pool |       0    |    1419    |   19126 K  |   19126 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    2598    |   38978 K  |   38978 K  |
|       from large pool |       2    |    1413    |   19852 K  |   19852 K  |
|       from small pool |       0    |    1419    |   19126 K  |   19126 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      63    |     637    |    1780    |    1717    |
|       from large pool |      37    |     602    |    1730    |    1693    |
|       from small pool |      26    |      35    |      50    |      24    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |     652    |   26755 K  |   26755 K  |
|       from large pool |       4    |     605    |   15471 K  |   15471 K  |
|       from small pool |       0    |     235    |   11283 K  |   11283 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13219 MiB | 221134 GiB | 221134 GiB |
|       from large pool |  16640 KiB |  13181 MiB | 218514 GiB | 218514 GiB |
|       from small pool |      0 KiB |     60 MiB |   2620 GiB |   2620 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13219 MiB | 221134 GiB | 221134 GiB |
|       from large pool |  16640 KiB |  13181 MiB | 218514 GiB | 218514 GiB |
|       from small pool |      0 KiB |     60 MiB |   2620 GiB |   2620 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13213 MiB | 220529 GiB | 220529 GiB |
|       from large pool |  16640 KiB |  13175 MiB | 217914 GiB | 217914 GiB |
|       from small pool |      0 KiB |     60 MiB |   2615 GiB |   2615 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    882 MiB |  14482 MiB |  41642 MiB |  40760 MiB |
|       from large pool |    830 MiB |  14412 MiB |  41542 MiB |  40712 MiB |
|       from small pool |     52 MiB |     70 MiB |    100 MiB |     48 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1236 MiB | 154863 GiB | 154862 GiB |
|       from large pool |  24320 KiB |   1229 MiB | 152226 GiB | 152226 GiB |
|       from small pool |      0 KiB |     44 MiB |   2636 GiB |   2636 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    2598    |   38978 K  |   38978 K  |
|       from large pool |       2    |    1413    |   19852 K  |   19852 K  |
|       from small pool |       0    |    1419    |   19126 K  |   19126 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    2598    |   38978 K  |   38978 K  |
|       from large pool |       2    |    1413    |   19852 K  |   19852 K  |
|       from small pool |       0    |    1419    |   19126 K  |   19126 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      63    |     637    |    1780    |    1717    |
|       from large pool |      37    |     602    |    1730    |    1693    |
|       from small pool |      26    |      35    |      50    |      24    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |     652    |   26755 K  |   26755 K  |
|       from large pool |       4    |     605    |   15471 K  |   15471 K  |
|       from small pool |       0    |     235    |   11283 K  |   11283 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'888c1ef2'
model name: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_07_00_32_seed_3_23065778

 Experiment start at: 2024-07-26 07:00:32.072096
before training, model accuracy: 0.47111111879348755
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9469401, 'precision': 0.9477302, 'recall': 0.9467024, 'specificity': 0.9467024, 'f1': 0.94688934, 'auroc': 0.99142873, 'binary_precision': 0.9317618, 'binary_recall': 0.9659164, 'binary_specificity': 0.92748845, 'binary_f1_score': 0.9485318}
confusion matrix:
      0     1
0  1407   110
1    53  1502
---- Validation: 
scalar performance:
{'acc': 0.75058454, 'precision': 0.7945671, 'recall': 0.7542882, 'specificity': 0.7542882, 'f1': 0.7426705, 'auroc': 0.89923084, 'binary_precision': 0.6757679, 'binary_recall': 0.94435614, 'binary_specificity': 0.5642202, 'binary_f1_score': 0.7877984}
confusion matrix:
     0    1
0  369  285
1   35  594
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.74222225, 'precision': 0.78366375, 'recall': 0.7422222, 'specificity': 0.7422222, 'f1': 0.73245037, 'auroc': 0.9117234, 'binary_precision': 0.6752412, 'binary_recall': 0.93333334, 'binary_specificity': 0.5511111, 'binary_f1_score': 0.78358215}
confusion matrix:
     0    1
0  124  101
1   15  210
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-26 07:02:02.764960,epoch time: 0:01:30.692864,used: 0:01:30.692864,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_07_00_32_seed_3_23065778
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9641927, 'precision': 0.96425855, 'recall': 0.96413577, 'specificity': 0.96413577, 'f1': 0.9641825, 'auroc': 0.9953364, 'binary_precision': 0.96109694, 'binary_recall': 0.968509, 'binary_specificity': 0.9597625, 'binary_f1_score': 0.96478873}
confusion matrix:
      0     1
0  1455    61
1    49  1507
---- Validation: 
scalar performance:
{'acc': 0.80124706, 'precision': 0.80125487, 'recall': 0.8013691, 'specificity': 0.8013691, 'f1': 0.80122966, 'auroc': 0.8767934, 'binary_precision': 0.7912772, 'binary_recall': 0.80763113, 'binary_specificity': 0.795107, 'binary_f1_score': 0.7993705}
confusion matrix:
     0    1
0  520  134
1  121  508
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7822222, 'precision': 0.7934441, 'recall': 0.7822222, 'specificity': 0.7822222, 'f1': 0.78012, 'auroc': 0.8970666, 'binary_precision': 0.7360595, 'binary_recall': 0.88, 'binary_specificity': 0.6844444, 'binary_f1_score': 0.80161935}
confusion matrix:
     0    1
0  154   71
1   27  198
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-07-26 07:03:29.650326,epoch time: 0:01:26.885366,used: 0:02:57.578230,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_07_00_32_seed_3_23065778
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9716797, 'precision': 0.9724811, 'recall': 0.97196937, 'specificity': 0.97196937, 'f1': 0.971676, 'auroc': 0.99801266, 'binary_precision': 0.99527663, 'binary_recall': 0.948553, 'binary_specificity': 0.99538565, 'binary_f1_score': 0.9713533}
confusion matrix:
      0     1
0  1510     7
1    80  1475
---- Validation: 
scalar performance:
{'acc': 0.6944661, 'precision': 0.7398993, 'recall': 0.6900959, 'specificity': 0.6900959, 'f1': 0.67616534, 'auroc': 0.8128407, 'binary_precision': 0.83954155, 'binary_recall': 0.46581876, 'binary_specificity': 0.9143731, 'binary_f1_score': 0.599182}
confusion matrix:
     0    1
0  598   56
1  336  293
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7911111, 'precision': 0.8118322, 'recall': 0.7911111, 'specificity': 0.7911111, 'f1': 0.78758234, 'auroc': 0.85880494, 'binary_precision': 0.89221555, 'binary_recall': 0.6622222, 'binary_specificity': 0.92, 'binary_f1_score': 0.760204}
confusion matrix:
     0    1
0  207   18
1   76  149
new oracle model saved
early stop counter: 1
val acc:0.6944661140441895, best validation acc: 0.8012470602989197, corresponding to test acc:                         0.7822222113609314 / 0.7911111116409302
after epoch: 3,now: 2024-07-26 07:04:56.199810,epoch time: 0:01:26.549484,used: 0:04:24.127714,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_07_00_32_seed_3_23065778
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9316406, 'precision': 0.9391657, 'recall': 0.9325193, 'specificity': 0.9325193, 'f1': 0.93143064, 'auroc': 0.99298686, 'binary_precision': 1.0, 'binary_recall': 0.8650386, 'binary_specificity': 1.0, 'binary_f1_score': 0.9276361}
confusion matrix:
      0     1
0  1516     0
1   210  1346
---- Validation: 
scalar performance:
{'acc': 0.52611065, 'precision': 0.7191415, 'recall': 0.516754, 'specificity': 0.516754, 'f1': 0.3761724, 'auroc': 0.8278674, 'binary_precision': 0.92, 'binary_recall': 0.036565978, 'binary_specificity': 0.9969419, 'binary_f1_score': 0.070336394}
confusion matrix:
     0   1
0  652   2
1  606  23
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.66888887, 'precision': 0.794665, 'recall': 0.6688889, 'specificity': 0.6688889, 'f1': 0.6293348, 'auroc': 0.86972845, 'binary_precision': 0.98717946, 'binary_recall': 0.3422222, 'binary_specificity': 0.9955556, 'binary_f1_score': 0.5082508}
confusion matrix:
     0   1
0  224   1
1  148  77
early stop counter: 2
val acc:0.5261106491088867, best validation acc: 0.8012470602989197, corresponding to test acc:                         0.7822222113609314 / 0.7911111116409302
after epoch: 4,now: 2024-07-26 07:06:22.738673,epoch time: 0:01:26.538863,used: 0:05:50.666577,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_07_00_32_seed_3_23065778
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.97591144, 'precision': 0.9760817, 'recall': 0.97582424, 'specificity': 0.97582424, 'f1': 0.9759028, 'auroc': 0.9982225, 'binary_precision': 0.96954316, 'binary_recall': 0.983269, 'binary_specificity': 0.96837944, 'binary_f1_score': 0.97635776}
confusion matrix:
      0     1
0  1470    48
1    26  1528
---- Validation: 
scalar performance:
{'acc': 0.79111457, 'precision': 0.79106057, 'recall': 0.79115677, 'specificity': 0.79115677, 'f1': 0.79107785, 'auroc': 0.8632945, 'binary_precision': 0.78335947, 'binary_recall': 0.79332274, 'binary_specificity': 0.78899086, 'binary_f1_score': 0.7883096}
confusion matrix:
     0    1
0  516  138
1  130  499
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.82, 'precision': 0.8228121, 'recall': 0.82, 'specificity': 0.82, 'f1': 0.81960714, 'auroc': 0.9006617, 'binary_precision': 0.79268295, 'binary_recall': 0.8666667, 'binary_specificity': 0.7733333, 'binary_f1_score': 0.82802546}
confusion matrix:
     0    1
0  174   51
1   30  195
new oracle model saved
early stop counter: 3
val acc:0.7911145687103271, best validation acc: 0.8012470602989197, corresponding to test acc:                         0.7822222113609314 / 0.8199999928474426
after epoch: 5,now: 2024-07-26 07:07:49.473938,epoch time: 0:01:26.735265,used: 0:07:17.401842,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_07_00_32_seed_3_23065778
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.98307294, 'precision': 0.98311996, 'recall': 0.98318875, 'specificity': 0.98318875, 'f1': 0.98307264, 'auroc': 0.99830043, 'binary_precision': 0.9921466, 'binary_recall': 0.97429305, 'binary_specificity': 0.99208444, 'binary_f1_score': 0.98313874}
confusion matrix:
      0     1
0  1504    12
1    40  1516
---- Validation: 
scalar performance:
{'acc': 0.766173, 'precision': 0.78134704, 'recall': 0.7638356, 'specificity': 0.7638356, 'f1': 0.76184285, 'auroc': 0.86134493, 'binary_precision': 0.84199584, 'binary_recall': 0.6438792, 'binary_specificity': 0.88379204, 'binary_f1_score': 0.7297297}
confusion matrix:
     0    1
0  578   76
1  224  405
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8, 'precision': 0.80009484, 'recall': 0.8, 'specificity': 0.8, 'f1': 0.7999842, 'auroc': 0.85706663, 'binary_precision': 0.8054299, 'binary_recall': 0.7911111, 'binary_specificity': 0.8088889, 'binary_f1_score': 0.79820627}
confusion matrix:
     0    1
0  182   43
1   47  178
early stop counter: 4
val acc:0.7661730051040649, best validation acc: 0.8012470602989197, corresponding to test acc:                         0.7822222113609314 / 0.8199999928474426
after epoch: 6,now: 2024-07-26 07:09:15.908828,epoch time: 0:01:26.434890,used: 0:08:43.836732,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_07_00_32_seed_3_23065778
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9860026, 'precision': 0.985996, 'recall': 0.9860045, 'specificity': 0.9860045, 'f1': 0.98600006, 'auroc': 0.99905926, 'binary_precision': 0.98650384, 'binary_recall': 0.98587024, 'binary_specificity': 0.98613864, 'binary_f1_score': 0.9861869}
confusion matrix:
      0     1
0  1494    21
1    22  1535
---- Validation: 
scalar performance:
{'acc': 0.8051442, 'precision': 0.8187063, 'recall': 0.8030951, 'specificity': 0.8030951, 'f1': 0.80225813, 'auroc': 0.8750626, 'binary_precision': 0.8797595, 'binary_recall': 0.69793326, 'binary_specificity': 0.9082569, 'binary_f1_score': 0.77836883}
confusion matrix:
     0    1
0  594   60
1  190  439
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8288889, 'precision': 0.8294159, 'recall': 0.8288889, 'specificity': 0.8288889, 'f1': 0.8288204, 'auroc': 0.90872097, 'binary_precision': 0.8425926, 'binary_recall': 0.8088889, 'binary_specificity': 0.8488889, 'binary_f1_score': 0.82539684}
confusion matrix:
     0    1
0  191   34
1   43  182
new oracle model saved
better model found
persisted
after epoch: 7,now: 2024-07-26 07:10:42.727879,epoch time: 0:01:26.819051,used: 0:10:10.655783,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_07_00_32_seed_3_23065778
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9860026, 'precision': 0.9861495, 'recall': 0.9861736, 'specificity': 0.9861736, 'f1': 0.98600256, 'auroc': 0.9993408, 'binary_precision': 0.9986825, 'binary_recall': 0.9736673, 'binary_specificity': 0.9986799, 'binary_f1_score': 0.9860163}
confusion matrix:
      0     1
0  1513     2
1    41  1516
---- Validation: 
scalar performance:
{'acc': 0.7022603, 'precision': 0.78207827, 'recall': 0.69698155, 'specificity': 0.69698155, 'f1': 0.6760409, 'auroc': 0.85232854, 'binary_precision': 0.9273356, 'binary_recall': 0.42607313, 'binary_specificity': 0.9678899, 'binary_f1_score': 0.583878}
confusion matrix:
     0    1
0  633   21
1  361  268
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.80222225, 'precision': 0.8185907, 'recall': 0.80222225, 'specificity': 0.80222225, 'f1': 0.79964876, 'auroc': 0.8951901, 'binary_precision': 0.8908046, 'binary_recall': 0.6888889, 'binary_specificity': 0.91555554, 'binary_f1_score': 0.7769423}
confusion matrix:
     0    1
0  206   19
1   70  155
early stop counter: 1
val acc:0.7022603154182434, best validation acc: 0.805144190788269, corresponding to test acc:                         0.8288888931274414 / 0.8288888931274414
after epoch: 8,now: 2024-07-26 07:12:08.945083,epoch time: 0:01:26.217204,used: 0:11:36.872987,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_07_00_32_seed_3_23065778
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.98339844, 'precision': 0.98368526, 'recall': 0.98365384, 'specificity': 0.98365384, 'f1': 0.98339844, 'auroc': 0.9986433, 'binary_precision': 1.0, 'binary_recall': 0.9673077, 'binary_specificity': 1.0, 'binary_f1_score': 0.9833822}
confusion matrix:
      0     1
0  1512     0
1    51  1509
---- Validation: 
scalar performance:
{'acc': 0.5728761, 'precision': 0.74972236, 'recall': 0.56450945, 'specificity': 0.56450945, 'f1': 0.470116, 'auroc': 0.87049305, 'binary_precision': 0.9550562, 'binary_recall': 0.13513513, 'binary_specificity': 0.9938838, 'binary_f1_score': 0.23676878}
confusion matrix:
     0   1
0  650   4
1  544  85
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5555556, 'precision': 0.7647059, 'recall': 0.5555556, 'specificity': 0.5555556, 'f1': 0.44615385, 'auroc': 0.8949728, 'binary_precision': 1.0, 'binary_recall': 0.11111111, 'binary_specificity': 1.0, 'binary_f1_score': 0.19999999}
confusion matrix:
     0   1
0  225   0
1  200  25
early stop counter: 2
val acc:0.5728760957717896, best validation acc: 0.805144190788269, corresponding to test acc:                         0.8288888931274414 / 0.8288888931274414
after epoch: 9,now: 2024-07-26 07:13:35.526732,epoch time: 0:01:26.581649,used: 0:13:03.454636,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_07_00_32_seed_3_23065778
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9794922, 'precision': 0.9799788, 'recall': 0.9797267, 'specificity': 0.9797267, 'f1': 0.97949123, 'auroc': 0.9992331, 'binary_precision': 0.9986631, 'binary_recall': 0.9607717, 'binary_specificity': 0.9986816, 'binary_f1_score': 0.97935104}
confusion matrix:
      0     1
0  1515     2
1    61  1494
---- Validation: 
scalar performance:
{'acc': 0.6975838, 'precision': 0.774081, 'recall': 0.6923336, 'specificity': 0.6923336, 'f1': 0.671269, 'auroc': 0.850103, 'binary_precision': 0.9140893, 'binary_recall': 0.4228935, 'binary_specificity': 0.9617737, 'binary_f1_score': 0.5782609}
confusion matrix:
     0    1
0  629   25
1  363  266
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8066667, 'precision': 0.8182918, 'recall': 0.8066667, 'specificity': 0.8066667, 'f1': 0.80488515, 'auroc': 0.87796545, 'binary_precision': 0.8791209, 'binary_recall': 0.7111111, 'binary_specificity': 0.9022222, 'binary_f1_score': 0.7862408}
confusion matrix:
     0    1
0  203   22
1   65  160
early stop counter: 3
val acc:0.697583794593811, best validation acc: 0.805144190788269, corresponding to test acc:                         0.8288888931274414 / 0.8288888931274414
after epoch: 10,now: 2024-07-26 07:15:01.859420,epoch time: 0:01:26.332688,used: 0:14:29.787324,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_07_00_32_seed_3_23065778
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9847005, 'precision': 0.984926, 'recall': 0.98459196, 'specificity': 0.98459196, 'f1': 0.98469365, 'auroc': 0.9992628, 'binary_precision': 0.9772296, 'binary_recall': 0.9929306, 'binary_specificity': 0.9762533, 'binary_f1_score': 0.98501754}
confusion matrix:
      0     1
0  1480    36
1    11  1545
---- Validation: 
scalar performance:
{'acc': 0.76695246, 'precision': 0.77871996, 'recall': 0.7648736, 'specificity': 0.7648736, 'f1': 0.76345533, 'auroc': 0.8534565, 'binary_precision': 0.8313253, 'binary_recall': 0.6581876, 'binary_specificity': 0.8715596, 'binary_f1_score': 0.7346939}
confusion matrix:
     0    1
0  570   84
1  215  414
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.79555553, 'precision': 0.7979094, 'recall': 0.79555553, 'specificity': 0.79555553, 'f1': 0.79515094, 'auroc': 0.87215805, 'binary_precision': 0.7714286, 'binary_recall': 0.84, 'binary_specificity': 0.7511111, 'binary_f1_score': 0.80425537}
confusion matrix:
     0    1
0  169   56
1   36  189
early stop counter: 4
val acc:0.7669524550437927, best validation acc: 0.805144190788269, corresponding to test acc:                         0.8288888931274414 / 0.8288888931274414
after epoch: 11,now: 2024-07-26 07:16:28.281449,epoch time: 0:01:26.422029,used: 0:15:56.209353,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_07_00_32_seed_3_23065778
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.94596356, 'precision': 0.95052195, 'recall': 0.94533545, 'specificity': 0.94533545, 'f1': 0.9457648, 'auroc': 0.99728096, 'binary_precision': 0.90834314, 'binary_recall': 0.99357325, 'binary_specificity': 0.89709765, 'binary_f1_score': 0.9490485}
confusion matrix:
      0     1
0  1360   156
1    10  1546
---- Validation: 
scalar performance:
{'acc': 0.7856586, 'precision': 0.791471, 'recall': 0.78699017, 'specificity': 0.78699017, 'f1': 0.7850548, 'auroc': 0.8698993, 'binary_precision': 0.74515235, 'binary_recall': 0.85532594, 'binary_specificity': 0.71865445, 'binary_f1_score': 0.79644704}
confusion matrix:
     0    1
0  470  184
1   91  538
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7311111, 'precision': 0.78387034, 'recall': 0.7311111, 'specificity': 0.7311111, 'f1': 0.7180086, 'auroc': 0.89189136, 'binary_precision': 0.6614907, 'binary_recall': 0.94666666, 'binary_specificity': 0.51555556, 'binary_f1_score': 0.7787934}
confusion matrix:
     0    1
0  116  109
1   12  213
early stop counter: 5
val acc:0.785658597946167, best validation acc: 0.805144190788269, corresponding to test acc:                         0.8288888931274414 / 0.8288888931274414
after epoch: 12,now: 2024-07-26 07:17:54.950052,epoch time: 0:01:26.668603,used: 0:17:22.877956,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_07_00_32_seed_3_23065778
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.99121094, 'precision': 0.99118584, 'recall': 0.9912697, 'specificity': 0.9912697, 'f1': 0.99121004, 'auroc': 0.9994277, 'binary_precision': 0.9954693, 'binary_recall': 0.987163, 'binary_specificity': 0.99537647, 'binary_f1_score': 0.99129874}
confusion matrix:
      0     1
0  1507     7
1    20  1538
---- Validation: 
scalar performance:
{'acc': 0.7887763, 'precision': 0.8203904, 'recall': 0.78567266, 'specificity': 0.78567266, 'f1': 0.78213537, 'auroc': 0.8759742, 'binary_precision': 0.9162791, 'binary_recall': 0.6263911, 'binary_specificity': 0.94495416, 'binary_f1_score': 0.74409825}
confusion matrix:
     0    1
0  618   36
1  235  394
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.83555555, 'precision': 0.8454078, 'recall': 0.83555555, 'specificity': 0.83555555, 'f1': 0.8343745, 'auroc': 0.89635557, 'binary_precision': 0.9037433, 'binary_recall': 0.7511111, 'binary_specificity': 0.92, 'binary_f1_score': 0.8203883}
confusion matrix:
     0    1
0  207   18
1   56  169
new oracle model saved
early stop counter: 6
val acc:0.7887762784957886, best validation acc: 0.805144190788269, corresponding to test acc:                         0.8288888931274414 / 0.8355555534362793
after epoch: 13,now: 2024-07-26 07:19:21.639519,epoch time: 0:01:26.689467,used: 0:18:49.567423,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_07_00_32_seed_3_23065778
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9895833, 'precision': 0.9896641, 'recall': 0.98971725, 'specificity': 0.98971725, 'f1': 0.98958325, 'auroc': 0.9994993, 'binary_precision': 1.0, 'binary_recall': 0.97943443, 'binary_specificity': 1.0, 'binary_f1_score': 0.9896104}
confusion matrix:
      0     1
0  1516     0
1    32  1524
---- Validation: 
scalar performance:
{'acc': 0.61574435, 'precision': 0.73169625, 'recall': 0.6086855, 'specificity': 0.6086855, 'f1': 0.55320764, 'auroc': 0.80806994, 'binary_precision': 0.8908046, 'binary_recall': 0.24642289, 'binary_specificity': 0.97094804, 'binary_f1_score': 0.38605228}
confusion matrix:
     0    1
0  635   19
1  474  155
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.74666667, 'precision': 0.77480686, 'recall': 0.74666667, 'specificity': 0.74666667, 'f1': 0.7400109, 'auroc': 0.8678124, 'binary_precision': 0.8627451, 'binary_recall': 0.58666664, 'binary_specificity': 0.9066667, 'binary_f1_score': 0.69841266}
confusion matrix:
     0    1
0  204   21
1   93  132
early stop counter: 7
val acc:0.6157443523406982, best validation acc: 0.805144190788269, corresponding to test acc:                         0.8288888931274414 / 0.8355555534362793
after epoch: 14,now: 2024-07-26 07:20:47.958419,epoch time: 0:01:26.318900,used: 0:20:15.886323,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_07_00_32_seed_3_23065778
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9889323, 'precision': 0.9889525, 'recall': 0.98903215, 'specificity': 0.98903215, 'f1': 0.988932, 'auroc': 0.9997325, 'binary_precision': 0.9967363, 'binary_recall': 0.98136246, 'binary_specificity': 0.99670184, 'binary_f1_score': 0.98898965}
confusion matrix:
      0     1
0  1511     5
1    29  1527
---- Validation: 
scalar performance:
{'acc': 0.72564304, 'precision': 0.7942144, 'recall': 0.7208593, 'specificity': 0.7208593, 'f1': 0.7058259, 'auroc': 0.87335366, 'binary_precision': 0.9314642, 'binary_recall': 0.4753577, 'binary_specificity': 0.96636087, 'binary_f1_score': 0.6294736}
confusion matrix:
     0    1
0  632   22
1  330  299
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7, 'precision': 0.78137505, 'recall': 0.7, 'specificity': 0.7, 'f1': 0.6766192, 'auroc': 0.88320005, 'binary_precision': 0.9326923, 'binary_recall': 0.4311111, 'binary_specificity': 0.9688889, 'binary_f1_score': 0.58966565}
confusion matrix:
     0   1
0  218   7
1  128  97
early stop counter: 8
val acc:0.7256430387496948, best validation acc: 0.805144190788269, corresponding to test acc:                         0.8288888931274414 / 0.8355555534362793
after epoch: 15,now: 2024-07-26 07:22:14.271871,epoch time: 0:01:26.313452,used: 0:21:42.199775,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_07_00_32_seed_3_23065778
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9889323, 'precision': 0.98890764, 'recall': 0.9889673, 'specificity': 0.9889673, 'f1': 0.98893076, 'auroc': 0.9994548, 'binary_precision': 0.9916129, 'binary_recall': 0.9865212, 'binary_specificity': 0.9914135, 'binary_f1_score': 0.98906046}
confusion matrix:
      0     1
0  1501    13
1    21  1537
---- Validation: 
scalar performance:
{'acc': 0.71083397, 'precision': 0.75750124, 'recall': 0.70657635, 'specificity': 0.70657635, 'f1': 0.6943443, 'auroc': 0.80634767, 'binary_precision': 0.8623595, 'binary_recall': 0.4880763, 'binary_specificity': 0.9250764, 'binary_f1_score': 0.6233502}
confusion matrix:
     0    1
0  605   49
1  322  307
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.78, 'precision': 0.79061425, 'recall': 0.78, 'specificity': 0.78, 'f1': 0.7779727, 'auroc': 0.8327704, 'binary_precision': 0.84615386, 'binary_recall': 0.6844444, 'binary_specificity': 0.8755556, 'binary_f1_score': 0.7567568}
confusion matrix:
     0    1
0  197   28
1   71  154
early stop counter: 9
val acc:0.7108339667320251, best validation acc: 0.805144190788269, corresponding to test acc:                         0.8288888931274414 / 0.8355555534362793
after epoch: 16,now: 2024-07-26 07:23:40.761438,epoch time: 0:01:26.489567,used: 0:23:08.689342,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_07_00_32_seed_3_23065778
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9860026, 'precision': 0.98609805, 'recall': 0.9861629, 'specificity': 0.9861629, 'f1': 0.98600245, 'auroc': 0.9994426, 'binary_precision': 0.9973736, 'binary_recall': 0.9749679, 'binary_specificity': 0.99735796, 'binary_f1_score': 0.98604345}
confusion matrix:
      0     1
0  1510     4
1    39  1519
---- Validation: 
scalar performance:
{'acc': 0.7708496, 'precision': 0.8125373, 'recall': 0.76723766, 'specificity': 0.76723766, 'f1': 0.76127064, 'auroc': 0.8933201, 'binary_precision': 0.92191434, 'binary_recall': 0.581876, 'binary_specificity': 0.9525994, 'binary_f1_score': 0.7134503}
confusion matrix:
     0    1
0  623   31
1  263  366
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.79333335, 'precision': 0.81344986, 'recall': 0.79333335, 'specificity': 0.79333335, 'f1': 0.7899634, 'auroc': 0.88807905, 'binary_precision': 0.89285713, 'binary_recall': 0.6666667, 'binary_specificity': 0.92, 'binary_f1_score': 0.7633588}
confusion matrix:
     0    1
0  207   18
1   75  150
early stop counter: 10
val acc:0.7708495855331421, best validation acc: 0.805144190788269, corresponding to test acc:                         0.8288888931274414 / 0.8355555534362793
after epoch: 17,now: 2024-07-26 07:25:07.306449,epoch time: 0:01:26.545011,used: 0:24:35.234353,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_07_00_32_seed_3_23065778
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.991862, 'precision': 0.9919373, 'recall': 0.9918065, 'specificity': 0.9918065, 'f1': 0.9918592, 'auroc': 0.99979055, 'binary_precision': 0.98853505, 'binary_recall': 0.9955099, 'binary_specificity': 0.9881031, 'binary_f1_score': 0.99201024}
confusion matrix:
      0     1
0  1495    18
1     7  1552
---- Validation: 
scalar performance:
{'acc': 0.8222915, 'precision': 0.8279735, 'recall': 0.82097816, 'specificity': 0.82097816, 'f1': 0.8210468, 'auroc': 0.88812155, 'binary_precision': 0.8665448, 'binary_recall': 0.7535771, 'binary_specificity': 0.8883792, 'binary_f1_score': 0.8061224}
confusion matrix:
     0    1
0  581   73
1  155  474
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.83111113, 'precision': 0.8320556, 'recall': 0.8311111, 'specificity': 0.8311111, 'f1': 0.8309909, 'auroc': 0.91358024, 'binary_precision': 0.814346, 'binary_recall': 0.8577778, 'binary_specificity': 0.80444443, 'binary_f1_score': 0.83549786}
confusion matrix:
     0    1
0  181   44
1   32  193
better model found
persisted
after epoch: 18,now: 2024-07-26 07:26:34.345786,epoch time: 0:01:27.039337,used: 0:26:02.273690,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_07_00_32_seed_3_23065778
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.992513, 'precision': 0.9925009, 'recall': 0.9926001, 'specificity': 0.9926001, 'f1': 0.9925125, 'auroc': 0.99980927, 'binary_precision': 0.99870044, 'binary_recall': 0.9865212, 'binary_specificity': 0.998679, 'binary_f1_score': 0.99257344}
confusion matrix:
      0     1
0  1512     2
1    21  1537
---- Validation: 
scalar performance:
{'acc': 0.6804365, 'precision': 0.78933007, 'recall': 0.6743593, 'specificity': 0.6743593, 'f1': 0.6426912, 'auroc': 0.86738086, 'binary_precision': 0.96202534, 'binary_recall': 0.36248013, 'binary_specificity': 0.98623854, 'binary_f1_score': 0.5265589}
confusion matrix:
     0    1
0  645    9
1  401  228
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6711111, 'precision': 0.78982234, 'recall': 0.6711111, 'specificity': 0.6711111, 'f1': 0.6335908, 'auroc': 0.9106568, 'binary_precision': 0.97530866, 'binary_recall': 0.3511111, 'binary_specificity': 0.9911111, 'binary_f1_score': 0.51633984}
confusion matrix:
     0   1
0  223   2
1  146  79
early stop counter: 1
val acc:0.6804364919662476, best validation acc: 0.8222914934158325, corresponding to test acc:                         0.8311111330986023 / 0.8355555534362793
after epoch: 19,now: 2024-07-26 07:28:01.039996,epoch time: 0:01:26.694210,used: 0:27:28.967900,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_07_00_32_seed_3_23065778
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.98502606, 'precision': 0.98552805, 'recall': 0.98483646, 'specificity': 0.98483646, 'f1': 0.9850148, 'auroc': 0.9998313, 'binary_precision': 0.97309136, 'binary_recall': 0.9980745, 'binary_specificity': 0.9715984, 'binary_f1_score': 0.9854246}
confusion matrix:
      0     1
0  1471    43
1     3  1555
---- Validation: 
scalar performance:
{'acc': 0.791894, 'precision': 0.8115569, 'recall': 0.7893992, 'specificity': 0.7893992, 'f1': 0.78752387, 'auroc': 0.8646631, 'binary_precision': 0.8851064, 'binary_recall': 0.66136724, 'binary_specificity': 0.9174312, 'binary_f1_score': 0.7570519}
confusion matrix:
     0    1
0  600   54
1  213  416
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.82666665, 'precision': 0.82708013, 'recall': 0.8266667, 'specificity': 0.8266667, 'f1': 0.8266119, 'auroc': 0.90050364, 'binary_precision': 0.83870965, 'binary_recall': 0.8088889, 'binary_specificity': 0.84444445, 'binary_f1_score': 0.8235294}
confusion matrix:
     0    1
0  190   35
1   43  182
early stop counter: 2
val acc:0.7918940186500549, best validation acc: 0.8222914934158325, corresponding to test acc:                         0.8311111330986023 / 0.8355555534362793
after epoch: 20,now: 2024-07-26 07:29:27.267985,epoch time: 0:01:26.227989,used: 0:28:55.195889,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_07_00_32_seed_3_23065778
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.98372394, 'precision': 0.9843019, 'recall': 0.98352504, 'specificity': 0.98352504, 'f1': 0.9837111, 'auroc': 0.99974906, 'binary_precision': 0.97064334, 'binary_recall': 0.9980732, 'binary_specificity': 0.9689769, 'binary_f1_score': 0.98416716}
confusion matrix:
      0     1
0  1468    47
1     3  1554
---- Validation: 
scalar performance:
{'acc': 0.80358535, 'precision': 0.8049257, 'recall': 0.80420965, 'specificity': 0.80420965, 'f1': 0.80353266, 'auroc': 0.87827384, 'binary_precision': 0.77925926, 'binary_recall': 0.83624804, 'binary_specificity': 0.77217126, 'binary_f1_score': 0.8067484}
confusion matrix:
     0    1
0  505  149
1  103  526
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.86, 'precision': 0.866966, 'recall': 0.86, 'specificity': 0.86, 'f1': 0.85933244, 'auroc': 0.9471803, 'binary_precision': 0.81640625, 'binary_recall': 0.9288889, 'binary_specificity': 0.7911111, 'binary_f1_score': 0.8690229}
confusion matrix:
     0    1
0  178   47
1   16  209
new oracle model saved
early stop counter: 3
val acc:0.8035853505134583, best validation acc: 0.8222914934158325, corresponding to test acc:                         0.8311111330986023 / 0.8600000143051147
after epoch: 21,now: 2024-07-26 07:30:53.790337,epoch time: 0:01:26.522352,used: 0:30:21.718241,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_07_00_32_seed_3_23065778
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9895833, 'precision': 0.98962593, 'recall': 0.9895495, 'specificity': 0.9895495, 'f1': 0.989581, 'auroc': 0.9994252, 'binary_precision': 0.9872041, 'binary_recall': 0.992283, 'binary_specificity': 0.9868161, 'binary_f1_score': 0.98973703}
confusion matrix:
      0     1
0  1497    20
1    12  1543
---- Validation: 
scalar performance:
{'acc': 0.7482463, 'precision': 0.77867913, 'recall': 0.74494493, 'specificity': 0.74494493, 'f1': 0.73942983, 'auroc': 0.82109606, 'binary_precision': 0.8660287, 'binary_recall': 0.5755167, 'binary_specificity': 0.9143731, 'binary_f1_score': 0.69149953}
confusion matrix:
     0    1
0  598   56
1  267  362
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.81777775, 'precision': 0.8243382, 'recall': 0.81777775, 'specificity': 0.81777775, 'f1': 0.8168516, 'auroc': 0.89874566, 'binary_precision': 0.8704663, 'binary_recall': 0.74666667, 'binary_specificity': 0.8888889, 'binary_f1_score': 0.80382776}
confusion matrix:
     0    1
0  200   25
1   57  168
early stop counter: 4
val acc:0.7482463121414185, best validation acc: 0.8222914934158325, corresponding to test acc:                         0.8311111330986023 / 0.8600000143051147
after epoch: 22,now: 2024-07-26 07:32:20.125360,epoch time: 0:01:26.335023,used: 0:31:48.053264,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_07_00_32_seed_3_23065778
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.9899089, 'precision': 0.9901339, 'recall': 0.98980665, 'specificity': 0.98980665, 'f1': 0.98990464, 'auroc': 0.9998635, 'binary_precision': 0.98227847, 'binary_recall': 0.9980707, 'binary_specificity': 0.9815425, 'binary_f1_score': 0.99011165}
confusion matrix:
      0     1
0  1489    28
1     3  1552
---- Validation: 
scalar performance:
{'acc': 0.7996882, 'precision': 0.80334663, 'recall': 0.79856384, 'specificity': 0.79856384, 'f1': 0.7986072, 'auroc': 0.86330664, 'binary_precision': 0.83214283, 'binary_recall': 0.7408585, 'binary_specificity': 0.8562691, 'binary_f1_score': 0.7838519}
confusion matrix:
     0    1
0  560   94
1  163  466
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8288889, 'precision': 0.8294159, 'recall': 0.8288889, 'specificity': 0.8288889, 'f1': 0.8288204, 'auroc': 0.90121484, 'binary_precision': 0.8425926, 'binary_recall': 0.8088889, 'binary_specificity': 0.8488889, 'binary_f1_score': 0.82539684}
confusion matrix:
     0    1
0  191   34
1   43  182
early stop counter: 5
val acc:0.7996882200241089, best validation acc: 0.8222914934158325, corresponding to test acc:                         0.8311111330986023 / 0.8600000143051147
after epoch: 23,now: 2024-07-26 07:33:47.034888,epoch time: 0:01:26.909528,used: 0:33:14.962792,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_07_00_32_seed_3_23065778
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9869792, 'precision': 0.987079, 'recall': 0.9871211, 'specificity': 0.9871211, 'f1': 0.9869791, 'auroc': 0.99955654, 'binary_precision': 0.99802893, 'binary_recall': 0.9762211, 'binary_specificity': 0.9980211, 'binary_f1_score': 0.9870045}
confusion matrix:
      0     1
0  1513     3
1    37  1519
---- Validation: 
scalar performance:
{'acc': 0.64302415, 'precision': 0.7483156, 'recall': 0.6365378, 'specificity': 0.6365378, 'f1': 0.5947043, 'auroc': 0.83419937, 'binary_precision': 0.9052133, 'binary_recall': 0.3036566, 'binary_specificity': 0.96941894, 'binary_f1_score': 0.45476192}
confusion matrix:
     0    1
0  634   20
1  438  191
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.77111113, 'precision': 0.79579747, 'recall': 0.77111113, 'specificity': 0.77111113, 'f1': 0.7662338, 'auroc': 0.89376795, 'binary_precision': 0.88125, 'binary_recall': 0.62666667, 'binary_specificity': 0.91555554, 'binary_f1_score': 0.73246753}
confusion matrix:
     0    1
0  206   19
1   84  141
early stop counter: 6
val acc:0.6430241465568542, best validation acc: 0.8222914934158325, corresponding to test acc:                         0.8311111330986023 / 0.8600000143051147
after epoch: 24,now: 2024-07-26 07:35:13.535839,epoch time: 0:01:26.500951,used: 0:34:41.463743,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_07_00_32_seed_3_23065778
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.99576825, 'precision': 0.995752, 'recall': 0.9957887, 'specificity': 0.9957887, 'f1': 0.9957677, 'auroc': 0.9998101, 'binary_precision': 0.997421, 'binary_recall': 0.99421597, 'binary_specificity': 0.9973615, 'binary_f1_score': 0.9958159}
confusion matrix:
      0     1
0  1512     4
1     9  1547
---- Validation: 
scalar performance:
{'acc': 0.85424787, 'precision': 0.8655144, 'recall': 0.85253644, 'specificity': 0.85253644, 'f1': 0.8526404, 'auroc': 0.9032686, 'binary_precision': 0.925, 'binary_recall': 0.7647059, 'binary_specificity': 0.940367, 'binary_f1_score': 0.8372498}
confusion matrix:
     0    1
0  615   39
1  148  481
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8711111, 'precision': 0.8858675, 'recall': 0.8711111, 'specificity': 0.8711111, 'f1': 0.86986697, 'auroc': 0.94326913, 'binary_precision': 0.96132594, 'binary_recall': 0.7733333, 'binary_specificity': 0.9688889, 'binary_f1_score': 0.85714287}
confusion matrix:
     0    1
0  218    7
1   51  174
new oracle model saved
better model found
persisted
after epoch: 25,now: 2024-07-26 07:36:40.179854,epoch time: 0:01:26.644015,used: 0:36:08.107758,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_07_00_32_seed_3_23065778
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9824219, 'precision': 0.9830712, 'recall': 0.9822259, 'specificity': 0.9822259, 'f1': 0.98240805, 'auroc': 0.99980587, 'binary_precision': 0.96818465, 'binary_recall': 0.9980707, 'binary_specificity': 0.966381, 'binary_f1_score': 0.98290056}
confusion matrix:
      0     1
0  1466    51
1     3  1552
---- Validation: 
scalar performance:
{'acc': 0.82073265, 'precision': 0.82072526, 'recall': 0.8208469, 'specificity': 0.8208469, 'f1': 0.82071424, 'auroc': 0.8869401, 'binary_precision': 0.81123245, 'binary_recall': 0.8267091, 'binary_specificity': 0.81498474, 'binary_f1_score': 0.8188976}
confusion matrix:
     0    1
0  533  121
1  109  520
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8422222, 'precision': 0.8446801, 'recall': 0.8422222, 'specificity': 0.8422222, 'f1': 0.8419404, 'auroc': 0.93684936, 'binary_precision': 0.81557375, 'binary_recall': 0.8844444, 'binary_specificity': 0.8, 'binary_f1_score': 0.84861404}
confusion matrix:
     0    1
0  180   45
1   26  199
early stop counter: 1
val acc:0.8207326531410217, best validation acc: 0.8542478680610657, corresponding to test acc:                         0.8711110949516296 / 0.8711110949516296
after epoch: 26,now: 2024-07-26 07:38:06.639694,epoch time: 0:01:26.459840,used: 0:37:34.567598,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_07_00_32_seed_3_23065778
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.992513, 'precision': 0.9925075, 'recall': 0.99251604, 'specificity': 0.99251604, 'f1': 0.99251163, 'auroc': 0.99951243, 'binary_precision': 0.9929306, 'binary_recall': 0.9922929, 'binary_specificity': 0.99273926, 'binary_f1_score': 0.9926116}
confusion matrix:
      0     1
0  1504    11
1    12  1545
---- Validation: 
scalar performance:
{'acc': 0.82073265, 'precision': 0.83510387, 'recall': 0.81868947, 'specificity': 0.81868947, 'f1': 0.81807745, 'auroc': 0.8873874, 'binary_precision': 0.8997996, 'binary_recall': 0.7138315, 'binary_specificity': 0.9235474, 'binary_f1_score': 0.7960993}
confusion matrix:
     0    1
0  604   50
1  180  449
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.83111113, 'precision': 0.8468989, 'recall': 0.8311111, 'specificity': 0.8311111, 'f1': 0.8291674, 'auroc': 0.92003953, 'binary_precision': 0.920904, 'binary_recall': 0.72444445, 'binary_specificity': 0.93777776, 'binary_f1_score': 0.8109453}
confusion matrix:
     0    1
0  211   14
1   62  163
early stop counter: 2
val acc:0.8207326531410217, best validation acc: 0.8542478680610657, corresponding to test acc:                         0.8711110949516296 / 0.8711110949516296
after epoch: 27,now: 2024-07-26 07:39:33.119151,epoch time: 0:01:26.479457,used: 0:39:01.047055,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_07_00_32_seed_3_23065778
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.99121094, 'precision': 0.9911895, 'recall': 0.9912476, 'specificity': 0.9912476, 'f1': 0.9912101, 'auroc': 0.9995048, 'binary_precision': 0.9941823, 'binary_recall': 0.9884319, 'binary_specificity': 0.9940633, 'binary_f1_score': 0.99129874}
confusion matrix:
      0     1
0  1507     9
1    18  1538
---- Validation: 
scalar performance:
{'acc': 0.80436474, 'precision': 0.82845306, 'recall': 0.8016924, 'specificity': 0.8016924, 'f1': 0.79969, 'auroc': 0.887859, 'binary_precision': 0.91266376, 'binary_recall': 0.6645469, 'binary_specificity': 0.93883795, 'binary_f1_score': 0.7690893}
confusion matrix:
     0    1
0  614   40
1  211  418
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.85555553, 'precision': 0.8556188, 'recall': 0.85555553, 'specificity': 0.85555553, 'f1': 0.85554916, 'auroc': 0.9257877, 'binary_precision': 0.8603604, 'binary_recall': 0.8488889, 'binary_specificity': 0.8622222, 'binary_f1_score': 0.8545862}
confusion matrix:
     0    1
0  194   31
1   34  191
early stop counter: 3
val acc:0.8043647408485413, best validation acc: 0.8542478680610657, corresponding to test acc:                         0.8711110949516296 / 0.8711110949516296
after epoch: 28,now: 2024-07-26 07:40:59.553790,epoch time: 0:01:26.434639,used: 0:40:27.481694,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_07_00_32_seed_3_23065778
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.97753906, 'precision': 0.978481, 'recall': 0.9772723, 'specificity': 0.9772723, 'f1': 0.97751474, 'auroc': 0.99927545, 'binary_precision': 0.96039605, 'binary_recall': 0.9967887, 'binary_specificity': 0.9577558, 'binary_f1_score': 0.978254}
confusion matrix:
      0     1
0  1451    64
1     5  1552
---- Validation: 
scalar performance:
{'acc': 0.8222915, 'precision': 0.8223463, 'recall': 0.822072, 'specificity': 0.822072, 'f1': 0.8221592, 'auroc': 0.88226485, 'binary_precision': 0.8239095, 'binary_recall': 0.8108108, 'binary_specificity': 0.8333333, 'binary_f1_score': 0.81730765}
confusion matrix:
     0    1
0  545  109
1  119  510
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.79333335, 'precision': 0.8055556, 'recall': 0.7933333, 'specificity': 0.7933333, 'f1': 0.7912458, 'auroc': 0.9317136, 'binary_precision': 0.74444443, 'binary_recall': 0.8933333, 'binary_specificity': 0.6933333, 'binary_f1_score': 0.8121212}
confusion matrix:
     0    1
0  156   69
1   24  201
early stop counter: 4
val acc:0.8222914934158325, best validation acc: 0.8542478680610657, corresponding to test acc:                         0.8711110949516296 / 0.8711110949516296
after epoch: 29,now: 2024-07-26 07:42:26.248170,epoch time: 0:01:26.694380,used: 0:41:54.176074,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_07_00_32_seed_3_23065778
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.9860026, 'precision': 0.9861418, 'recall': 0.9861495, 'specificity': 0.9861495, 'f1': 0.98600256, 'auroc': 0.999451, 'binary_precision': 0.9980237, 'binary_recall': 0.97427654, 'binary_specificity': 0.99802244, 'binary_f1_score': 0.98600715}
confusion matrix:
      0     1
0  1514     3
1    40  1515
---- Validation: 
scalar performance:
{'acc': 0.81371784, 'precision': 0.83740926, 'recall': 0.81110984, 'specificity': 0.81110984, 'f1': 0.8094505, 'auroc': 0.8760495, 'binary_precision': 0.9220779, 'binary_recall': 0.6772655, 'binary_specificity': 0.94495416, 'binary_f1_score': 0.78093493}
confusion matrix:
     0    1
0  618   36
1  203  426
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8288889, 'precision': 0.83802986, 'recall': 0.8288889, 'specificity': 0.8288889, 'f1': 0.8277242, 'auroc': 0.909116, 'binary_precision': 0.89361703, 'binary_recall': 0.74666667, 'binary_specificity': 0.9111111, 'binary_f1_score': 0.81355935}
confusion matrix:
     0    1
0  205   20
1   57  168
early stop counter: 5
val acc:0.8137178421020508, best validation acc: 0.8542478680610657, corresponding to test acc:                         0.8711110949516296 / 0.8711110949516296
after epoch: 30,now: 2024-07-26 07:43:53.023212,epoch time: 0:01:26.775042,used: 0:43:20.951116,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_07_00_32_seed_3_23065778
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 0:43:20.951116 at 2024-07-26 07:43:53.023212
persisted model performance metric: 

scalar performance:
{'acc': 0.8711111, 'precision': 0.8858675, 'recall': 0.8711111, 'specificity': 0.8711111, 'f1': 0.86986697, 'auroc': 0.94326913, 'binary_precision': 0.96132594, 'binary_recall': 0.7733333, 'binary_specificity': 0.9688889, 'binary_f1_score': 0.85714287}
confusion matrix:
     0    1
0  218    7
1   51  174
oracle model performance metric: 

scalar performance:
{'acc': 0.8711111, 'precision': 0.8858675, 'recall': 0.8711111, 'specificity': 0.8711111, 'f1': 0.86986697, 'auroc': 0.94326913, 'binary_precision': 0.96132594, 'binary_recall': 0.7733333, 'binary_specificity': 0.9688889, 'binary_f1_score': 0.85714287}
confusion matrix:
     0    1
0  218    7
1   51  174
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_irm_10seeds_nofreeze_2024-07-26_02-28-54/rule_results/1.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_irm_10seeds_nofreeze_2024-07-26_02-28-54/confusion_matrix/1.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 455402 KiB |  13219 MiB | 294204 GiB | 294204 GiB |
|       from large pool | 414803 KiB |  13181 MiB | 290709 GiB | 290709 GiB |
|       from small pool |  40598 KiB |     60 MiB |   3494 GiB |   3494 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 455402 KiB |  13219 MiB | 294204 GiB | 294204 GiB |
|       from large pool | 414803 KiB |  13181 MiB | 290709 GiB | 290709 GiB |
|       from small pool |  40598 KiB |     60 MiB |   3494 GiB |   3494 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 447481 KiB |  13213 MiB | 293544 GiB | 293544 GiB |
|       from large pool | 407075 KiB |  13175 MiB | 290057 GiB | 290056 GiB |
|       from small pool |  40406 KiB |     60 MiB |   3487 GiB |   3487 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  14482 MiB |  14482 MiB |  55242 MiB |  40760 MiB |
|       from large pool |  14412 MiB |  14412 MiB |  55124 MiB |  40712 MiB |
|       from small pool |     70 MiB |     70 MiB |    118 MiB |     48 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 445718 KiB |   1236 MiB | 205941 GiB | 205940 GiB |
|       from large pool | 435116 KiB |   1229 MiB | 202424 GiB | 202424 GiB |
|       from small pool |  10601 KiB |     44 MiB |   3516 GiB |   3516 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    1310    |    2598    |   51931 K  |   51930 K  |
|       from large pool |     187    |    1413    |   26431 K  |   26431 K  |
|       from small pool |    1123    |    1419    |   25500 K  |   25499 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    1310    |    2598    |   51931 K  |   51930 K  |
|       from large pool |     187    |    1413    |   26431 K  |   26431 K  |
|       from small pool |    1123    |    1419    |   25500 K  |   25499 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     637    |     637    |    2354    |    1717    |
|       from large pool |     602    |     602    |    2295    |    1693    |
|       from small pool |      35    |      35    |      59    |      24    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      98    |     652    |   35473 K  |   35473 K  |
|       from large pool |      38    |     605    |   20477 K  |   20477 K  |
|       from small pool |      60    |     237    |   14996 K  |   14996 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13219 MiB | 294204 GiB | 294204 GiB |
|       from large pool |  16640 KiB |  13181 MiB | 290709 GiB | 290709 GiB |
|       from small pool |      0 KiB |     60 MiB |   3494 GiB |   3494 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13219 MiB | 294204 GiB | 294204 GiB |
|       from large pool |  16640 KiB |  13181 MiB | 290709 GiB | 290709 GiB |
|       from small pool |      0 KiB |     60 MiB |   3494 GiB |   3494 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13213 MiB | 293544 GiB | 293544 GiB |
|       from large pool |  16640 KiB |  13175 MiB | 290057 GiB | 290057 GiB |
|       from small pool |      0 KiB |     60 MiB |   3487 GiB |   3487 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    880 MiB |  14482 MiB |  55242 MiB |  54362 MiB |
|       from large pool |    830 MiB |  14412 MiB |  55124 MiB |  54294 MiB |
|       from small pool |     50 MiB |     70 MiB |    118 MiB |     68 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1236 MiB | 205941 GiB | 205941 GiB |
|       from large pool |  24320 KiB |   1229 MiB | 202424 GiB | 202424 GiB |
|       from small pool |      0 KiB |     44 MiB |   3516 GiB |   3516 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    2598    |   51931 K  |   51931 K  |
|       from large pool |       2    |    1413    |   26431 K  |   26431 K  |
|       from small pool |       0    |    1419    |   25500 K  |   25500 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    2598    |   51931 K  |   51931 K  |
|       from large pool |       2    |    1413    |   26431 K  |   26431 K  |
|       from small pool |       0    |    1419    |   25500 K  |   25500 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      62    |     637    |    2354    |    2292    |
|       from large pool |      37    |     602    |    2295    |    2258    |
|       from small pool |      25    |      35    |      59    |      34    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |     652    |   35474 K  |   35474 K  |
|       from large pool |       4    |     605    |   20477 K  |   20477 K  |
|       from small pool |       0    |     237    |   14996 K  |   14996 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13219 MiB | 294204 GiB | 294204 GiB |
|       from large pool |  16640 KiB |  13181 MiB | 290709 GiB | 290709 GiB |
|       from small pool |      0 KiB |     60 MiB |   3494 GiB |   3494 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13219 MiB | 294204 GiB | 294204 GiB |
|       from large pool |  16640 KiB |  13181 MiB | 290709 GiB | 290709 GiB |
|       from small pool |      0 KiB |     60 MiB |   3494 GiB |   3494 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13213 MiB | 293544 GiB | 293544 GiB |
|       from large pool |  16640 KiB |  13175 MiB | 290057 GiB | 290057 GiB |
|       from small pool |      0 KiB |     60 MiB |   3487 GiB |   3487 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    880 MiB |  14482 MiB |  55242 MiB |  54362 MiB |
|       from large pool |    830 MiB |  14412 MiB |  55124 MiB |  54294 MiB |
|       from small pool |     50 MiB |     70 MiB |    118 MiB |     68 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1236 MiB | 205941 GiB | 205941 GiB |
|       from large pool |  24320 KiB |   1229 MiB | 202424 GiB | 202424 GiB |
|       from small pool |      0 KiB |     44 MiB |   3516 GiB |   3516 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    2598    |   51931 K  |   51931 K  |
|       from large pool |       2    |    1413    |   26431 K  |   26431 K  |
|       from small pool |       0    |    1419    |   25500 K  |   25500 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    2598    |   51931 K  |   51931 K  |
|       from large pool |       2    |    1413    |   26431 K  |   26431 K  |
|       from small pool |       0    |    1419    |   25500 K  |   25500 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      62    |     637    |    2354    |    2292    |
|       from large pool |      37    |     602    |    2295    |    2258    |
|       from small pool |      25    |      35    |      59    |      34    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |     652    |   35474 K  |   35474 K  |
|       from large pool |       4    |     605    |   20477 K  |   20477 K  |
|       from small pool |       0    |     237    |   14996 K  |   14996 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'888c1ef2'
model name: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_07_44_21_seed_4_23065778

 Experiment start at: 2024-07-26 07:44:21.407032
before training, model accuracy: 0.6350710988044739
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.93911916, 'precision': 0.9399377, 'recall': 0.93955374, 'specificity': 0.93955374, 'f1': 0.93911487, 'auroc': 0.98413444, 'binary_precision': 0.96378267, 'binary_recall': 0.914704, 'binary_specificity': 0.96440345, 'binary_f1_score': 0.93860227}
confusion matrix:
      0     1
0  1463    54
1   134  1437
---- Validation: 
scalar performance:
{'acc': 0.8040593, 'precision': 0.8044323, 'recall': 0.80428386, 'specificity': 0.80428386, 'f1': 0.80405164, 'auroc': 0.8726156, 'binary_precision': 0.78995436, 'binary_recall': 0.8212025, 'binary_specificity': 0.7873652, 'binary_f1_score': 0.8052754}
confusion matrix:
     0    1
0  511  138
1  113  519
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8364929, 'precision': 0.83656096, 'recall': 0.8364929, 'specificity': 0.8364929, 'f1': 0.8364847, 'auroc': 0.9084252, 'binary_precision': 0.84134614, 'binary_recall': 0.8293839, 'binary_specificity': 0.8436019, 'binary_f1_score': 0.8353222}
confusion matrix:
     0    1
0  178   33
1   36  175
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-26 07:45:50.062812,epoch time: 0:01:28.655780,used: 0:01:28.655780,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_07_44_21_seed_4_23065778
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.94948184, 'precision': 0.9494666, 'recall': 0.94960237, 'specificity': 0.94960237, 'f1': 0.9494771, 'auroc': 0.98671746, 'binary_precision': 0.9573368, 'binary_recall': 0.94271165, 'binary_specificity': 0.9564931, 'binary_f1_score': 0.94996786}
confusion matrix:
      0     1
0  1451    66
1    90  1481
---- Validation: 
scalar performance:
{'acc': 0.7806401, 'precision': 0.79185784, 'recall': 0.7819174, 'specificity': 0.7819174, 'f1': 0.77901065, 'auroc': 0.8854835, 'binary_precision': 0.7312253, 'binary_recall': 0.8781645, 'binary_specificity': 0.68567026, 'binary_f1_score': 0.7979871}
confusion matrix:
     0    1
0  445  204
1   77  555
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.83886254, 'precision': 0.8449367, 'recall': 0.83886254, 'specificity': 0.83886254, 'f1': 0.83815, 'auroc': 0.9148941, 'binary_precision': 0.79916316, 'binary_recall': 0.9052133, 'binary_specificity': 0.77251184, 'binary_f1_score': 0.8488889}
confusion matrix:
     0    1
0  163   48
1   20  191
new oracle model saved
early stop counter: 1
val acc:0.7806401252746582, best validation acc: 0.8040593266487122, corresponding to test acc:                         0.8364928960800171 / 0.8388625383377075
after epoch: 2,now: 2024-07-26 07:47:14.899438,epoch time: 0:01:24.836626,used: 0:02:53.492406,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_07_44_21_seed_4_23065778
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.96243525, 'precision': 0.9635638, 'recall': 0.96293354, 'specificity': 0.96293354, 'f1': 0.9624301, 'auroc': 0.9948486, 'binary_precision': 0.99122214, 'binary_recall': 0.9344367, 'binary_specificity': 0.99143046, 'binary_f1_score': 0.96199214}
confusion matrix:
      0     1
0  1504    13
1   103  1468
---- Validation: 
scalar performance:
{'acc': 0.8196721, 'precision': 0.81967425, 'recall': 0.81958854, 'specificity': 0.81958854, 'f1': 0.81961894, 'auroc': 0.89386547, 'binary_precision': 0.8197767, 'binary_recall': 0.81329113, 'binary_specificity': 0.82588595, 'binary_f1_score': 0.81652105}
confusion matrix:
     0    1
0  536  113
1  118  514
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.86255926, 'precision': 0.86259186, 'recall': 0.86255926, 'specificity': 0.86255926, 'f1': 0.8625562, 'auroc': 0.9255632, 'binary_precision': 0.85915494, 'binary_recall': 0.8672986, 'binary_specificity': 0.8578199, 'binary_f1_score': 0.8632076}
confusion matrix:
     0    1
0  181   30
1   28  183
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-07-26 07:48:40.048183,epoch time: 0:01:25.148745,used: 0:04:18.641151,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_07_44_21_seed_4_23065778
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9737694, 'precision': 0.9737285, 'recall': 0.97387576, 'specificity': 0.97387576, 'f1': 0.97376525, 'auroc': 0.99608374, 'binary_precision': 0.98005146, 'binary_recall': 0.9682136, 'binary_specificity': 0.97953796, 'binary_f1_score': 0.97409654}
confusion matrix:
      0     1
0  1484    31
1    50  1523
---- Validation: 
scalar performance:
{'acc': 0.7907885, 'precision': 0.7947614, 'recall': 0.7915391, 'specificity': 0.7915391, 'f1': 0.7903437, 'auroc': 0.8920491, 'binary_precision': 0.75706214, 'binary_recall': 0.84810126, 'binary_specificity': 0.7349769, 'binary_f1_score': 0.8}
confusion matrix:
     0    1
0  477  172
1   96  536
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.82227486, 'precision': 0.8284799, 'recall': 0.8222749, 'specificity': 0.8222749, 'f1': 0.82143164, 'auroc': 0.91294, 'binary_precision': 0.78333336, 'binary_recall': 0.89099526, 'binary_specificity': 0.7535545, 'binary_f1_score': 0.8337029}
confusion matrix:
     0    1
0  159   52
1   23  188
early stop counter: 1
val acc:0.790788471698761, best validation acc: 0.8196721076965332, corresponding to test acc:                         0.8625592589378357 / 0.8625592589378357
after epoch: 4,now: 2024-07-26 07:50:04.927363,epoch time: 0:01:24.879180,used: 0:05:43.520331,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_07_44_21_seed_4_23065778
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9802461, 'precision': 0.98030204, 'recall': 0.98019147, 'specificity': 0.98019147, 'f1': 0.98023844, 'auroc': 0.99821967, 'binary_precision': 0.97783405, 'binary_recall': 0.9834395, 'binary_specificity': 0.9769434, 'binary_f1_score': 0.9806288}
confusion matrix:
      0     1
0  1483    35
1    26  1544
---- Validation: 
scalar performance:
{'acc': 0.7946916, 'precision': 0.7995157, 'recall': 0.7955155, 'specificity': 0.7955155, 'f1': 0.7941452, 'auroc': 0.87453187, 'binary_precision': 0.758042, 'binary_recall': 0.8575949, 'binary_specificity': 0.73343605, 'binary_f1_score': 0.80475134}
confusion matrix:
     0    1
0  476  173
1   90  542
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7677725, 'precision': 0.79681313, 'recall': 0.7677725, 'specificity': 0.7677725, 'f1': 0.7619497, 'auroc': 0.88818765, 'binary_precision': 0.70397115, 'binary_recall': 0.9241706, 'binary_specificity': 0.6113744, 'binary_f1_score': 0.7991804}
confusion matrix:
     0    1
0  129   82
1   16  195
early stop counter: 2
val acc:0.7946916222572327, best validation acc: 0.8196721076965332, corresponding to test acc:                         0.8625592589378357 / 0.8625592589378357
after epoch: 5,now: 2024-07-26 07:51:29.682225,epoch time: 0:01:24.754862,used: 0:07:08.275193,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_07_44_21_seed_4_23065778
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9692358, 'precision': 0.9699472, 'recall': 0.96966624, 'specificity': 0.96966624, 'f1': 0.9692346, 'auroc': 0.9958786, 'binary_precision': 0.99332, 'binary_recall': 0.94592875, 'binary_specificity': 0.9934037, 'binary_f1_score': 0.9690453}
confusion matrix:
      0     1
0  1506    10
1    85  1487
---- Validation: 
scalar performance:
{'acc': 0.7665886, 'precision': 0.7680261, 'recall': 0.7660605, 'specificity': 0.7660605, 'f1': 0.76600456, 'auroc': 0.8304134, 'binary_precision': 0.7846154, 'binary_recall': 0.72626585, 'binary_specificity': 0.80585515, 'binary_f1_score': 0.75431395}
confusion matrix:
     0    1
0  523  126
1  173  459
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.82464457, 'precision': 0.83329874, 'recall': 0.82464457, 'specificity': 0.82464457, 'f1': 0.82349885, 'auroc': 0.9084477, 'binary_precision': 0.8870056, 'binary_recall': 0.74407583, 'binary_specificity': 0.9052133, 'binary_f1_score': 0.8092783}
confusion matrix:
     0    1
0  191   20
1   54  157
early stop counter: 3
val acc:0.7665886282920837, best validation acc: 0.8196721076965332, corresponding to test acc:                         0.8625592589378357 / 0.8625592589378357
after epoch: 6,now: 2024-07-26 07:52:54.643256,epoch time: 0:01:24.961031,used: 0:08:33.236224,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_07_44_21_seed_4_23065778
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.97959846, 'precision': 0.9795872, 'recall': 0.97959787, 'specificity': 0.97959787, 'f1': 0.97959244, 'auroc': 0.9981051, 'binary_precision': 0.98025477, 'binary_recall': 0.9796308, 'binary_specificity': 0.9795649, 'binary_f1_score': 0.97994274}
confusion matrix:
      0     1
0  1486    31
1    32  1539
---- Validation: 
scalar performance:
{'acc': 0.765808, 'precision': 0.77973104, 'recall': 0.76725876, 'specificity': 0.76725876, 'f1': 0.7634832, 'auroc': 0.87078464, 'binary_precision': 0.71391755, 'binary_recall': 0.87658226, 'binary_specificity': 0.65793526, 'binary_f1_score': 0.7869318}
confusion matrix:
     0    1
0  427  222
1   78  554
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7132701, 'precision': 0.7734735, 'recall': 0.7132701, 'specificity': 0.7132701, 'f1': 0.69657063, 'auroc': 0.91134524, 'binary_precision': 0.6451613, 'binary_recall': 0.9478673, 'binary_specificity': 0.47867298, 'binary_f1_score': 0.7677543}
confusion matrix:
     0    1
0  101  110
1   11  200
early stop counter: 4
val acc:0.7658079862594604, best validation acc: 0.8196721076965332, corresponding to test acc:                         0.8625592589378357 / 0.8625592589378357
after epoch: 7,now: 2024-07-26 07:54:19.561804,epoch time: 0:01:24.918548,used: 0:09:58.154772,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_07_44_21_seed_4_23065778
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9773316, 'precision': 0.9773691, 'recall': 0.9775566, 'specificity': 0.9775566, 'f1': 0.97733, 'auroc': 0.9975728, 'binary_precision': 0.9889539, 'binary_recall': 0.9663492, 'binary_specificity': 0.98876405, 'binary_f1_score': 0.9775209}
confusion matrix:
      0     1
0  1496    17
1    53  1522
---- Validation: 
scalar performance:
{'acc': 0.6939891, 'precision': 0.70945776, 'recall': 0.6921115, 'specificity': 0.6921115, 'f1': 0.6868814, 'auroc': 0.78442, 'binary_precision': 0.7631579, 'binary_recall': 0.5506329, 'binary_specificity': 0.83359015, 'binary_f1_score': 0.63970584}
confusion matrix:
     0    1
0  541  108
1  284  348
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.69905216, 'precision': 0.7421311, 'recall': 0.6990521, 'specificity': 0.6990521, 'f1': 0.6850432, 'auroc': 0.7993082, 'binary_precision': 0.8442623, 'binary_recall': 0.48815167, 'binary_specificity': 0.9099526, 'binary_f1_score': 0.61861867}
confusion matrix:
     0    1
0  192   19
1  108  103
early stop counter: 5
val acc:0.693989098072052, best validation acc: 0.8196721076965332, corresponding to test acc:                         0.8625592589378357 / 0.8625592589378357
after epoch: 8,now: 2024-07-26 07:55:44.522677,epoch time: 0:01:24.960873,used: 0:11:23.115645,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_07_44_21_seed_4_23065778
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.98251295, 'precision': 0.98258054, 'recall': 0.98245096, 'specificity': 0.98245096, 'f1': 0.98250544, 'auroc': 0.9980027, 'binary_precision': 0.97975963, 'binary_recall': 0.9859962, 'binary_specificity': 0.97890574, 'binary_f1_score': 0.982868}
confusion matrix:
      0     1
0  1485    32
1    22  1549
---- Validation: 
scalar performance:
{'acc': 0.80640125, 'precision': 0.8140626, 'recall': 0.807424, 'specificity': 0.807424, 'f1': 0.8055451, 'auroc': 0.9015013, 'binary_precision': 0.7615804, 'binary_recall': 0.88449365, 'binary_specificity': 0.73035437, 'binary_f1_score': 0.818448}
confusion matrix:
     0    1
0  474  175
1   73  559
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.82464457, 'precision': 0.83437824, 'recall': 0.82464457, 'specificity': 0.82464457, 'f1': 0.823359, 'auroc': 0.9222165, 'binary_precision': 0.77732795, 'binary_recall': 0.9099526, 'binary_specificity': 0.7393365, 'binary_f1_score': 0.83842796}
confusion matrix:
     0    1
0  156   55
1   19  192
early stop counter: 6
val acc:0.806401252746582, best validation acc: 0.8196721076965332, corresponding to test acc:                         0.8625592589378357 / 0.8625592589378357
after epoch: 9,now: 2024-07-26 07:57:09.450035,epoch time: 0:01:24.927358,used: 0:12:48.043003,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_07_44_21_seed_4_23065778
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.98251295, 'precision': 0.98247737, 'recall': 0.98266196, 'specificity': 0.98266196, 'f1': 0.9825103, 'auroc': 0.9985514, 'binary_precision': 0.99032885, 'binary_recall': 0.9752381, 'binary_specificity': 0.9900859, 'binary_f1_score': 0.98272556}
confusion matrix:
      0     1
0  1498    15
1    39  1536
---- Validation: 
scalar performance:
{'acc': 0.7236534, 'precision': 0.7722392, 'recall': 0.7208071, 'specificity': 0.7208071, 'f1': 0.7090489, 'auroc': 0.87098765, 'binary_precision': 0.8839779, 'binary_recall': 0.5063291, 'binary_specificity': 0.93528503, 'binary_f1_score': 0.6438632}
confusion matrix:
     0    1
0  607   42
1  312  320
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7914692, 'precision': 0.8433209, 'recall': 0.7914692, 'specificity': 0.7914692, 'f1': 0.7832867, 'auroc': 0.91945374, 'binary_precision': 0.9767442, 'binary_recall': 0.5971564, 'binary_specificity': 0.98578197, 'binary_f1_score': 0.7411765}
confusion matrix:
     0    1
0  208    3
1   85  126
early stop counter: 7
val acc:0.7236533761024475, best validation acc: 0.8196721076965332, corresponding to test acc:                         0.8625592589378357 / 0.8625592589378357
after epoch: 10,now: 2024-07-26 07:58:34.336756,epoch time: 0:01:24.886721,used: 0:14:12.929724,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_07_44_21_seed_4_23065778
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9828368, 'precision': 0.983251, 'recall': 0.98261523, 'specificity': 0.98261523, 'f1': 0.9828206, 'auroc': 0.999086, 'binary_precision': 0.97325873, 'binary_recall': 0.9936508, 'binary_specificity': 0.9715797, 'binary_f1_score': 0.9833491}
confusion matrix:
      0     1
0  1470    43
1    10  1565
---- Validation: 
scalar performance:
{'acc': 0.79547226, 'precision': 0.7956867, 'recall': 0.79564345, 'specificity': 0.79564345, 'f1': 0.79547113, 'auroc': 0.8824579, 'binary_precision': 0.7837423, 'binary_recall': 0.8085443, 'binary_specificity': 0.7827427, 'binary_f1_score': 0.7959501}
confusion matrix:
     0    1
0  508  141
1  121  511
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8483412, 'precision': 0.84947157, 'recall': 0.8483412, 'specificity': 0.8483412, 'f1': 0.84821844, 'auroc': 0.92244107, 'binary_precision': 0.8295964, 'binary_recall': 0.87677723, 'binary_specificity': 0.8199052, 'binary_f1_score': 0.8525345}
confusion matrix:
     0    1
0  173   38
1   26  185
early stop counter: 8
val acc:0.795472264289856, best validation acc: 0.8196721076965332, corresponding to test acc:                         0.8625592589378357 / 0.8625592589378357
after epoch: 11,now: 2024-07-26 07:59:59.869000,epoch time: 0:01:25.532244,used: 0:15:38.461968,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_07_44_21_seed_4_23065778
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9821891, 'precision': 0.9824623, 'recall': 0.9824519, 'specificity': 0.9824519, 'f1': 0.9821892, 'auroc': 0.99886215, 'binary_precision': 0.9986825, 'binary_recall': 0.9662205, 'binary_specificity': 0.99868333, 'binary_f1_score': 0.9821834}
confusion matrix:
      0     1
0  1517     2
1    53  1516
---- Validation: 
scalar performance:
{'acc': 0.7915691, 'precision': 0.8155699, 'recall': 0.7897191, 'specificity': 0.7897191, 'f1': 0.78677917, 'auroc': 0.8903352, 'binary_precision': 0.89934355, 'binary_recall': 0.6503165, 'binary_specificity': 0.92912173, 'binary_f1_score': 0.754821}
confusion matrix:
     0    1
0  603   46
1  221  411
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.80094784, 'precision': 0.8458123, 'recall': 0.8009479, 'specificity': 0.8009479, 'f1': 0.79427534, 'auroc': 0.9178815, 'binary_precision': 0.97037035, 'binary_recall': 0.62085307, 'binary_specificity': 0.9810427, 'binary_f1_score': 0.7572254}
confusion matrix:
     0    1
0  207    4
1   80  131
early stop counter: 9
val acc:0.7915691137313843, best validation acc: 0.8196721076965332, corresponding to test acc:                         0.8625592589378357 / 0.8625592589378357
after epoch: 12,now: 2024-07-26 08:01:24.841722,epoch time: 0:01:24.972722,used: 0:17:03.434690,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_07_44_21_seed_4_23065778
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9867228, 'precision': 0.9867241, 'recall': 0.98671204, 'specificity': 0.98671204, 'f1': 0.98671794, 'auroc': 0.99919474, 'binary_precision': 0.9866582, 'binary_recall': 0.98728544, 'binary_specificity': 0.98613864, 'binary_f1_score': 0.9869717}
confusion matrix:
      0     1
0  1494    21
1    20  1553
---- Validation: 
scalar performance:
{'acc': 0.8235753, 'precision': 0.8235413, 'recall': 0.823565, 'specificity': 0.823565, 'f1': 0.8235511, 'auroc': 0.88740706, 'binary_precision': 0.8201893, 'binary_recall': 0.8227848, 'binary_specificity': 0.8243452, 'binary_f1_score': 0.8214849}
confusion matrix:
     0    1
0  535  114
1  112  520
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8744076, 'precision': 0.87509, 'recall': 0.8744076, 'specificity': 0.8744076, 'f1': 0.87435037, 'auroc': 0.92803395, 'binary_precision': 0.8590909, 'binary_recall': 0.8957346, 'binary_specificity': 0.8530806, 'binary_f1_score': 0.87703013}
confusion matrix:
     0    1
0  180   31
1   22  189
new oracle model saved
better model found
persisted
after epoch: 13,now: 2024-07-26 08:02:50.035308,epoch time: 0:01:25.193586,used: 0:18:28.628276,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_07_44_21_seed_4_23065778
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9886658, 'precision': 0.9886601, 'recall': 0.9888207, 'specificity': 0.9888207, 'f1': 0.9886648, 'auroc': 0.9995321, 'binary_precision': 0.997411, 'binary_recall': 0.9802799, 'binary_specificity': 0.9973615, 'binary_f1_score': 0.9887713}
confusion matrix:
      0     1
0  1512     4
1    31  1541
---- Validation: 
scalar performance:
{'acc': 0.754879, 'precision': 0.8067968, 'recall': 0.7521211, 'specificity': 0.7521211, 'f1': 0.7426723, 'auroc': 0.89963627, 'binary_precision': 0.9297297, 'binary_recall': 0.5443038, 'binary_specificity': 0.95993835, 'binary_f1_score': 0.68662673}
confusion matrix:
     0    1
0  623   26
1  288  344
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7843602, 'precision': 0.8230251, 'recall': 0.7843602, 'specificity': 0.7843602, 'f1': 0.7777083, 'auroc': 0.8832011, 'binary_precision': 0.9347826, 'binary_recall': 0.6113744, 'binary_specificity': 0.95734596, 'binary_f1_score': 0.739255}
confusion matrix:
     0    1
0  202    9
1   82  129
early stop counter: 1
val acc:0.7548789978027344, best validation acc: 0.8235753178596497, corresponding to test acc:                         0.8744075894355774 / 0.8744075894355774
after epoch: 14,now: 2024-07-26 08:04:15.172042,epoch time: 0:01:25.136734,used: 0:19:53.765010,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_07_44_21_seed_4_23065778
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9857513, 'precision': 0.9857889, 'recall': 0.9857081, 'specificity': 0.9857081, 'f1': 0.9857448, 'auroc': 0.9989803, 'binary_precision': 0.98417723, 'binary_recall': 0.98792887, 'binary_specificity': 0.9834874, 'binary_f1_score': 0.9860495}
confusion matrix:
      0     1
0  1489    25
1    19  1555
---- Validation: 
scalar performance:
{'acc': 0.7915691, 'precision': 0.8062842, 'recall': 0.7900921, 'specificity': 0.7900921, 'f1': 0.7884314, 'auroc': 0.88505197, 'binary_precision': 0.8701826, 'binary_recall': 0.6787975, 'binary_specificity': 0.90138674, 'binary_f1_score': 0.7626667}
confusion matrix:
     0    1
0  585   64
1  203  429
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8507109, 'precision': 0.8595045, 'recall': 0.85071087, 'specificity': 0.85071087, 'f1': 0.84979236, 'auroc': 0.9344579, 'binary_precision': 0.91573036, 'binary_recall': 0.77251184, 'binary_specificity': 0.92890996, 'binary_f1_score': 0.83804625}
confusion matrix:
     0    1
0  196   15
1   48  163
early stop counter: 2
val acc:0.7915691137313843, best validation acc: 0.8235753178596497, corresponding to test acc:                         0.8744075894355774 / 0.8744075894355774
after epoch: 15,now: 2024-07-26 08:05:40.146498,epoch time: 0:01:24.974456,used: 0:21:18.739466,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_07_44_21_seed_4_23065778
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9838083, 'precision': 0.9837829, 'recall': 0.9839128, 'specificity': 0.9839128, 'f1': 0.98380655, 'auroc': 0.998852, 'binary_precision': 0.9903226, 'binary_recall': 0.977707, 'binary_specificity': 0.99011856, 'binary_f1_score': 0.98397434}
confusion matrix:
      0     1
0  1503    15
1    35  1535
---- Validation: 
scalar performance:
{'acc': 0.852459, 'precision': 0.8528245, 'recall': 0.85223615, 'specificity': 0.85223615, 'f1': 0.85234237, 'auroc': 0.915854, 'binary_precision': 0.86133766, 'binary_recall': 0.835443, 'binary_specificity': 0.8690293, 'binary_f1_score': 0.84819275}
confusion matrix:
     0    1
0  564   85
1  104  528
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8507109, 'precision': 0.86311626, 'recall': 0.8507109, 'specificity': 0.8507109, 'f1': 0.8494249, 'auroc': 0.92210424, 'binary_precision': 0.9302326, 'binary_recall': 0.75829387, 'binary_specificity': 0.943128, 'binary_f1_score': 0.83550924}
confusion matrix:
     0    1
0  199   12
1   51  160
better model found
persisted
after epoch: 16,now: 2024-07-26 08:07:05.576017,epoch time: 0:01:25.429519,used: 0:22:44.168985,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_07_44_21_seed_4_23065778
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.98801816, 'precision': 0.98799, 'recall': 0.9881184, 'specificity': 0.9881184, 'f1': 0.9880167, 'auroc': 0.999609, 'binary_precision': 0.9941973, 'binary_recall': 0.98216563, 'binary_specificity': 0.9940711, 'binary_f1_score': 0.9881448}
confusion matrix:
      0     1
0  1509     9
1    28  1542
---- Validation: 
scalar performance:
{'acc': 0.7876659, 'precision': 0.8302409, 'recall': 0.78526604, 'specificity': 0.78526604, 'f1': 0.77960396, 'auroc': 0.91135156, 'binary_precision': 0.94554454, 'binary_recall': 0.6044304, 'binary_specificity': 0.9661017, 'binary_f1_score': 0.73745173}
confusion matrix:
     0    1
0  627   22
1  250  382
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.72511846, 'precision': 0.8134284, 'recall': 0.72511846, 'specificity': 0.72511846, 'f1': 0.704289, 'auroc': 0.9188248, 'binary_precision': 0.97979796, 'binary_recall': 0.45971563, 'binary_specificity': 0.9905213, 'binary_f1_score': 0.62580645}
confusion matrix:
     0   1
0  209   2
1  114  97
early stop counter: 1
val acc:0.7876659035682678, best validation acc: 0.8524590134620667, corresponding to test acc:                         0.850710928440094 / 0.8744075894355774
after epoch: 17,now: 2024-07-26 08:08:30.688854,epoch time: 0:01:25.112837,used: 0:24:09.281822,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_07_44_21_seed_4_23065778
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.98348445, 'precision': 0.9837172, 'recall': 0.98374707, 'specificity': 0.98374707, 'f1': 0.98348445, 'auroc': 0.9996975, 'binary_precision': 0.99934256, 'binary_recall': 0.9681529, 'binary_specificity': 0.99934125, 'binary_f1_score': 0.9835005}
confusion matrix:
      0     1
0  1517     1
1    50  1520
---- Validation: 
scalar performance:
{'acc': 0.72521466, 'precision': 0.7997138, 'recall': 0.72187126, 'specificity': 0.72187126, 'f1': 0.7050426, 'auroc': 0.91878265, 'binary_precision': 0.94585985, 'binary_recall': 0.4699367, 'binary_specificity': 0.97380584, 'binary_f1_score': 0.627907}
confusion matrix:
     0    1
0  632   17
1  335  297
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.60189575, 'precision': 0.7783641, 'recall': 0.60189575, 'specificity': 0.60189575, 'f1': 0.5269185, 'auroc': 0.92562497, 'binary_precision': 1.0, 'binary_recall': 0.20379147, 'binary_specificity': 1.0, 'binary_f1_score': 0.33858266}
confusion matrix:
     0   1
0  211   0
1  168  43
early stop counter: 2
val acc:0.7252146601676941, best validation acc: 0.8524590134620667, corresponding to test acc:                         0.850710928440094 / 0.8744075894355774
after epoch: 18,now: 2024-07-26 08:09:55.341675,epoch time: 0:01:24.652821,used: 0:25:33.934643,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_07_44_21_seed_4_23065778
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.99093264, 'precision': 0.9908816, 'recall': 0.9910201, 'specificity': 0.9910201, 'f1': 0.99093044, 'auroc': 0.9995162, 'binary_precision': 0.9955157, 'binary_recall': 0.9866667, 'binary_specificity': 0.9953734, 'binary_f1_score': 0.9910714}
confusion matrix:
      0     1
0  1506     7
1    21  1554
---- Validation: 
scalar performance:
{'acc': 0.7619048, 'precision': 0.8231542, 'recall': 0.7589927, 'specificity': 0.7589927, 'f1': 0.748666, 'auroc': 0.9089763, 'binary_precision': 0.96056336, 'binary_recall': 0.539557, 'binary_specificity': 0.97842836, 'binary_f1_score': 0.69098276}
confusion matrix:
     0    1
0  635   14
1  291  341
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5947867, 'precision': 0.776178, 'recall': 0.59478676, 'specificity': 0.59478676, 'f1': 0.5151804, 'auroc': 0.9023831, 'binary_precision': 1.0, 'binary_recall': 0.18957347, 'binary_specificity': 1.0, 'binary_f1_score': 0.31872508}
confusion matrix:
     0   1
0  211   0
1  171  40
early stop counter: 3
val acc:0.761904776096344, best validation acc: 0.8524590134620667, corresponding to test acc:                         0.850710928440094 / 0.8744075894355774
after epoch: 19,now: 2024-07-26 08:11:20.255378,epoch time: 0:01:24.913703,used: 0:26:58.848346,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_07_44_21_seed_4_23065778
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.990285, 'precision': 0.9902706, 'recall': 0.99029374, 'specificity': 0.99029374, 'f1': 0.9902818, 'auroc': 0.9997109, 'binary_precision': 0.99108845, 'binary_recall': 0.98982835, 'binary_specificity': 0.9907591, 'binary_f1_score': 0.9904581}
confusion matrix:
      0     1
0  1501    14
1    16  1557
---- Validation: 
scalar performance:
{'acc': 0.7220921, 'precision': 0.7711998, 'recall': 0.7192248, 'specificity': 0.7192248, 'f1': 0.7071887, 'auroc': 0.839517, 'binary_precision': 0.8833333, 'binary_recall': 0.5031645, 'binary_specificity': 0.93528503, 'binary_f1_score': 0.641129}
confusion matrix:
     0    1
0  607   42
1  314  318
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7488152, 'precision': 0.8072219, 'recall': 0.7488152, 'specificity': 0.7488152, 'f1': 0.7362811, 'auroc': 0.9044496, 'binary_precision': 0.9411765, 'binary_recall': 0.5308057, 'binary_specificity': 0.96682465, 'binary_f1_score': 0.6787879}
confusion matrix:
     0    1
0  204    7
1   99  112
early stop counter: 4
val acc:0.7220920920372009, best validation acc: 0.8524590134620667, corresponding to test acc:                         0.850710928440094 / 0.8744075894355774
after epoch: 20,now: 2024-07-26 08:12:45.119374,epoch time: 0:01:24.863996,used: 0:28:23.712342,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_07_44_21_seed_4_23065778
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9893135, 'precision': 0.9892924, 'recall': 0.9894618, 'specificity': 0.9894618, 'f1': 0.9893123, 'auroc': 0.9994981, 'binary_precision': 0.997416, 'binary_recall': 0.98156387, 'binary_specificity': 0.99735975, 'binary_f1_score': 0.9894265}
confusion matrix:
      0     1
0  1511     4
1    29  1544
---- Validation: 
scalar performance:
{'acc': 0.7665886, 'precision': 0.809518, 'recall': 0.7640918, 'specificity': 0.7640918, 'f1': 0.7570362, 'auroc': 0.8907911, 'binary_precision': 0.921519, 'binary_recall': 0.5759494, 'binary_specificity': 0.9522342, 'binary_f1_score': 0.7088607}
confusion matrix:
     0    1
0  618   31
1  268  364
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6824645, 'precision': 0.79979336, 'recall': 0.6824645, 'specificity': 0.6824645, 'f1': 0.64802694, 'auroc': 0.90629137, 'binary_precision': 0.98734176, 'binary_recall': 0.36966825, 'binary_specificity': 0.99526066, 'binary_f1_score': 0.537931}
confusion matrix:
     0   1
0  210   1
1  133  78
early stop counter: 5
val acc:0.7665886282920837, best validation acc: 0.8524590134620667, corresponding to test acc:                         0.850710928440094 / 0.8744075894355774
after epoch: 21,now: 2024-07-26 08:14:09.866634,epoch time: 0:01:24.747260,used: 0:29:48.459602,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_07_44_21_seed_4_23065778
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9876943, 'precision': 0.98773944, 'recall': 0.98791623, 'specificity': 0.98791623, 'f1': 0.98769355, 'auroc': 0.9994754, 'binary_precision': 0.99934983, 'binary_recall': 0.976493, 'binary_specificity': 0.9993395, 'binary_f1_score': 0.9877892}
confusion matrix:
      0     1
0  1513     1
1    37  1537
---- Validation: 
scalar performance:
{'acc': 0.74160814, 'precision': 0.80197656, 'recall': 0.73860955, 'specificity': 0.73860955, 'f1': 0.7264017, 'auroc': 0.8988055, 'binary_precision': 0.9337176, 'binary_recall': 0.51265824, 'binary_specificity': 0.96456087, 'binary_f1_score': 0.6618999}
confusion matrix:
     0    1
0  626   23
1  308  324
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6540284, 'precision': 0.7691643, 'recall': 0.6540284, 'specificity': 0.6540284, 'f1': 0.6126006, 'auroc': 0.8973967, 'binary_precision': 0.94520545, 'binary_recall': 0.3270142, 'binary_specificity': 0.9810427, 'binary_f1_score': 0.48591548}
confusion matrix:
     0   1
0  207   4
1  142  69
early stop counter: 6
val acc:0.7416081428527832, best validation acc: 0.8524590134620667, corresponding to test acc:                         0.850710928440094 / 0.8744075894355774
after epoch: 22,now: 2024-07-26 08:15:35.452924,epoch time: 0:01:25.586290,used: 0:31:14.045892,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_07_44_21_seed_4_23065778
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.99319947, 'precision': 0.9931812, 'recall': 0.9932153, 'specificity': 0.9932153, 'f1': 0.9931973, 'auroc': 0.9997742, 'binary_precision': 0.9942675, 'binary_recall': 0.99237126, 'binary_specificity': 0.9940594, 'binary_f1_score': 0.9933185}
confusion matrix:
      0     1
0  1506     9
1    12  1561
---- Validation: 
scalar performance:
{'acc': 0.80249804, 'precision': 0.80500925, 'recall': 0.8018727, 'specificity': 0.8018727, 'f1': 0.8018367, 'auroc': 0.8766457, 'binary_precision': 0.8295652, 'binary_recall': 0.75474685, 'binary_specificity': 0.8489985, 'binary_f1_score': 0.7903894}
confusion matrix:
     0    1
0  551   98
1  155  477
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7701422, 'precision': 0.77235055, 'recall': 0.7701422, 'specificity': 0.7701422, 'f1': 0.7696753, 'auroc': 0.83403337, 'binary_precision': 0.796875, 'binary_recall': 0.72511846, 'binary_specificity': 0.8151659, 'binary_f1_score': 0.75930524}
confusion matrix:
     0    1
0  172   39
1   58  153
early stop counter: 7
val acc:0.8024980425834656, best validation acc: 0.8524590134620667, corresponding to test acc:                         0.850710928440094 / 0.8744075894355774
after epoch: 23,now: 2024-07-26 08:17:00.709700,epoch time: 0:01:25.256776,used: 0:32:39.302668,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_07_44_21_seed_4_23065778
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9860751, 'precision': 0.9861407, 'recall': 0.9862621, 'specificity': 0.9862621, 'f1': 0.9860747, 'auroc': 0.9995208, 'binary_precision': 0.99739414, 'binary_recall': 0.9751592, 'binary_specificity': 0.99736494, 'binary_f1_score': 0.9861514}
confusion matrix:
      0     1
0  1514     4
1    39  1531
---- Validation: 
scalar performance:
{'acc': 0.73458236, 'precision': 0.8060297, 'recall': 0.7313442, 'specificity': 0.7313442, 'f1': 0.71632266, 'auroc': 0.91609836, 'binary_precision': 0.9506173, 'binary_recall': 0.48734176, 'binary_specificity': 0.9753467, 'binary_f1_score': 0.6443515}
confusion matrix:
     0    1
0  633   16
1  324  308
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.56398106, 'precision': 0.7499342, 'recall': 0.56398106, 'specificity': 0.56398106, 'f1': 0.4643488, 'auroc': 0.9346601, 'binary_precision': 0.9655172, 'binary_recall': 0.13270143, 'binary_specificity': 0.99526066, 'binary_f1_score': 0.23333335}
confusion matrix:
     0   1
0  210   1
1  183  28
early stop counter: 8
val acc:0.7345823645591736, best validation acc: 0.8524590134620667, corresponding to test acc:                         0.850710928440094 / 0.8744075894355774
after epoch: 24,now: 2024-07-26 08:18:25.903160,epoch time: 0:01:25.193460,used: 0:34:04.496128,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_07_44_21_seed_4_23065778
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.99384713, 'precision': 0.99384063, 'recall': 0.9938508, 'specificity': 0.9938508, 'f1': 0.99384564, 'auroc': 0.99970293, 'binary_precision': 0.9942602, 'binary_recall': 0.99362653, 'binary_specificity': 0.99407506, 'binary_f1_score': 0.99394333}
confusion matrix:
      0     1
0  1510     9
1    10  1559
---- Validation: 
scalar performance:
{'acc': 0.8235753, 'precision': 0.82893854, 'recall': 0.8227153, 'specificity': 0.8227153, 'f1': 0.8225579, 'auroc': 0.90369314, 'binary_precision': 0.8677536, 'binary_recall': 0.7579114, 'binary_specificity': 0.88751924, 'binary_f1_score': 0.8091216}
confusion matrix:
     0    1
0  576   73
1  153  479
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8578199, 'precision': 0.86735845, 'recall': 0.8578199, 'specificity': 0.8578199, 'f1': 0.8568909, 'auroc': 0.9275398, 'binary_precision': 0.92655367, 'binary_recall': 0.7772512, 'binary_specificity': 0.93838865, 'binary_f1_score': 0.8453609}
confusion matrix:
     0    1
0  198   13
1   47  164
early stop counter: 9
val acc:0.8235753178596497, best validation acc: 0.8524590134620667, corresponding to test acc:                         0.850710928440094 / 0.8744075894355774
after epoch: 25,now: 2024-07-26 08:19:50.787396,epoch time: 0:01:24.884236,used: 0:35:29.380364,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_07_44_21_seed_4_23065778
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9896373, 'precision': 0.9898087, 'recall': 0.9895201, 'specificity': 0.9895201, 'f1': 0.9896307, 'auroc': 0.99971807, 'binary_precision': 0.9842965, 'binary_recall': 0.9955527, 'binary_specificity': 0.9834874, 'binary_f1_score': 0.9898926}
confusion matrix:
      0     1
0  1489    25
1     7  1567
---- Validation: 
scalar performance:
{'acc': 0.8610461, 'precision': 0.8659934, 'recall': 0.86027557, 'specificity': 0.86027557, 'f1': 0.86037207, 'auroc': 0.9177721, 'binary_precision': 0.9053571, 'binary_recall': 0.8022152, 'binary_specificity': 0.9183359, 'binary_f1_score': 0.8506711}
confusion matrix:
     0    1
0  596   53
1  125  507
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.81279624, 'precision': 0.8413235, 'recall': 0.81279624, 'specificity': 0.81279624, 'f1': 0.8088012, 'auroc': 0.9166461, 'binary_precision': 0.94, 'binary_recall': 0.66824645, 'binary_specificity': 0.95734596, 'binary_f1_score': 0.78116345}
confusion matrix:
     0    1
0  202    9
1   70  141
better model found
persisted
after epoch: 26,now: 2024-07-26 08:21:16.012287,epoch time: 0:01:25.224891,used: 0:36:54.605255,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_07_44_21_seed_4_23065778
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.990285, 'precision': 0.99027133, 'recall': 0.9902935, 'specificity': 0.9902935, 'f1': 0.99028206, 'auroc': 0.99927396, 'binary_precision': 0.9910828, 'binary_recall': 0.9898219, 'binary_specificity': 0.99076515, 'binary_f1_score': 0.990452}
confusion matrix:
      0     1
0  1502    14
1    16  1556
---- Validation: 
scalar performance:
{'acc': 0.83372366, 'precision': 0.8437037, 'recall': 0.8325857, 'specificity': 0.8325857, 'f1': 0.8321509, 'auroc': 0.91606426, 'binary_precision': 0.8990476, 'binary_recall': 0.7468355, 'binary_specificity': 0.9183359, 'binary_f1_score': 0.81590325}
confusion matrix:
     0    1
0  596   53
1  160  472
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.86255926, 'precision': 0.8734297, 'recall': 0.8625592, 'specificity': 0.8625592, 'f1': 0.86155164, 'auroc': 0.92814624, 'binary_precision': 0.93714285, 'binary_recall': 0.7772512, 'binary_specificity': 0.9478673, 'binary_f1_score': 0.8497409}
confusion matrix:
     0    1
0  200   11
1   47  164
early stop counter: 1
val acc:0.8337236642837524, best validation acc: 0.8610460758209229, corresponding to test acc:                         0.8127962350845337 / 0.8744075894355774
after epoch: 27,now: 2024-07-26 08:22:40.817941,epoch time: 0:01:24.805654,used: 0:38:19.410909,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_07_44_21_seed_4_23065778
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.9789508, 'precision': 0.9800117, 'recall': 0.9785988, 'specificity': 0.9785988, 'f1': 0.97892153, 'auroc': 0.9996207, 'binary_precision': 0.96139705, 'binary_recall': 0.9987269, 'binary_specificity': 0.95847064, 'binary_f1_score': 0.9797065}
confusion matrix:
      0     1
0  1454    63
1     2  1569
---- Validation: 
scalar performance:
{'acc': 0.7962529, 'precision': 0.7975975, 'recall': 0.7966833, 'specificity': 0.7966833, 'f1': 0.7961556, 'auroc': 0.8906765, 'binary_precision': 0.77400297, 'binary_recall': 0.8291139, 'binary_specificity': 0.7642527, 'binary_f1_score': 0.80061114}
confusion matrix:
     0    1
0  496  153
1  108  524
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8056872, 'precision': 0.82387376, 'recall': 0.8056872, 'specificity': 0.8056872, 'f1': 0.8029205, 'auroc': 0.90404534, 'binary_precision': 0.74712646, 'binary_recall': 0.9241706, 'binary_specificity': 0.68720376, 'binary_f1_score': 0.8262712}
confusion matrix:
     0    1
0  145   66
1   16  195
early stop counter: 2
val acc:0.7962529063224792, best validation acc: 0.8610460758209229, corresponding to test acc:                         0.8127962350845337 / 0.8744075894355774
after epoch: 28,now: 2024-07-26 08:24:05.617113,epoch time: 0:01:24.799172,used: 0:39:44.210081,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_07_44_21_seed_4_23065778
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9935233, 'precision': 0.9936627, 'recall': 0.99343073, 'specificity': 0.99343073, 'f1': 0.9935199, 'auroc': 0.99992573, 'binary_precision': 0.98865783, 'binary_recall': 0.9987269, 'binary_specificity': 0.9881345, 'binary_f1_score': 0.9936668}
confusion matrix:
      0     1
0  1499    18
1     2  1569
---- Validation: 
scalar performance:
{'acc': 0.82982045, 'precision': 0.830957, 'recall': 0.82941747, 'specificity': 0.82941747, 'f1': 0.82952857, 'auroc': 0.90008724, 'binary_precision': 0.84731543, 'binary_recall': 0.7990506, 'binary_specificity': 0.8597843, 'binary_f1_score': 0.8224755}
confusion matrix:
     0    1
0  558   91
1  127  505
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8341232, 'precision': 0.8401125, 'recall': 0.83412325, 'specificity': 0.83412325, 'f1': 0.83338976, 'auroc': 0.88461626, 'binary_precision': 0.8852459, 'binary_recall': 0.7677725, 'binary_specificity': 0.90047395, 'binary_f1_score': 0.822335}
confusion matrix:
     0    1
0  190   21
1   49  162
early stop counter: 3
val acc:0.829820454120636, best validation acc: 0.8610460758209229, corresponding to test acc:                         0.8127962350845337 / 0.8744075894355774
after epoch: 29,now: 2024-07-26 08:25:30.857785,epoch time: 0:01:25.240672,used: 0:41:09.450753,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_07_44_21_seed_4_23065778
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.9886658, 'precision': 0.9886719, 'recall': 0.9888325, 'specificity': 0.9888325, 'f1': 0.988665, 'auroc': 0.9996177, 'binary_precision': 0.99805576, 'binary_recall': 0.97964376, 'binary_specificity': 0.9980211, 'binary_f1_score': 0.98876405}
confusion matrix:
      0     1
0  1513     3
1    32  1540
---- Validation: 
scalar performance:
{'acc': 0.79234976, 'precision': 0.82752883, 'recall': 0.7901579, 'specificity': 0.7901579, 'f1': 0.7857396, 'auroc': 0.90540767, 'binary_precision': 0.9316038, 'binary_recall': 0.625, 'binary_specificity': 0.9553159, 'binary_f1_score': 0.74810606}
confusion matrix:
     0    1
0  620   29
1  237  395
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8530806, 'precision': 0.8676474, 'recall': 0.8530806, 'specificity': 0.8530806, 'f1': 0.8516107, 'auroc': 0.93638957, 'binary_precision': 0.9408284, 'binary_recall': 0.7535545, 'binary_specificity': 0.9526066, 'binary_f1_score': 0.8368421}
confusion matrix:
     0    1
0  201   10
1   52  159
early stop counter: 4
val acc:0.7923497557640076, best validation acc: 0.8610460758209229, corresponding to test acc:                         0.8127962350845337 / 0.8744075894355774
after epoch: 30,now: 2024-07-26 08:26:56.299207,epoch time: 0:01:25.441422,used: 0:42:34.892175,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_07_44_21_seed_4_23065778
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 0:42:34.892175 at 2024-07-26 08:26:56.299207
persisted model performance metric: 

scalar performance:
{'acc': 0.81279624, 'precision': 0.8413235, 'recall': 0.81279624, 'specificity': 0.81279624, 'f1': 0.8088012, 'auroc': 0.9166461, 'binary_precision': 0.94, 'binary_recall': 0.66824645, 'binary_specificity': 0.95734596, 'binary_f1_score': 0.78116345}
confusion matrix:
     0    1
0  202    9
1   70  141
oracle model performance metric: 

scalar performance:
{'acc': 0.8744076, 'precision': 0.87509, 'recall': 0.8744076, 'specificity': 0.8744076, 'f1': 0.87435037, 'auroc': 0.92803395, 'binary_precision': 0.8590909, 'binary_recall': 0.8957346, 'binary_specificity': 0.8530806, 'binary_f1_score': 0.87703013}
confusion matrix:
     0    1
0  180   31
1   22  189
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_irm_10seeds_nofreeze_2024-07-26_02-28-54/rule_results/1.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_irm_10seeds_nofreeze_2024-07-26_02-28-54/confusion_matrix/1.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 455396 KiB |  13219 MiB | 365434 GiB | 365434 GiB |
|       from large pool | 414803 KiB |  13181 MiB | 361084 GiB | 361084 GiB |
|       from small pool |  40592 KiB |     60 MiB |   4350 GiB |   4350 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 455396 KiB |  13219 MiB | 365434 GiB | 365434 GiB |
|       from large pool | 414803 KiB |  13181 MiB | 361084 GiB | 361084 GiB |
|       from small pool |  40592 KiB |     60 MiB |   4350 GiB |   4350 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 447480 KiB |  13213 MiB | 364722 GiB | 364721 GiB |
|       from large pool | 407075 KiB |  13175 MiB | 360380 GiB | 360380 GiB |
|       from small pool |  40405 KiB |     60 MiB |   4341 GiB |   4341 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  14478 MiB |  14482 MiB |  68840 MiB |  54362 MiB |
|       from large pool |  14412 MiB |  14412 MiB |  68706 MiB |  54294 MiB |
|       from small pool |     66 MiB |     70 MiB |    134 MiB |     68 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 445724 KiB |   1236 MiB | 255887 GiB | 255886 GiB |
|       from large pool | 435116 KiB |   1229 MiB | 251508 GiB | 251507 GiB |
|       from small pool |  10607 KiB |     44 MiB |   4378 GiB |   4378 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    1298    |    2598    |   64613 K  |   64612 K  |
|       from large pool |     187    |    1413    |   32848 K  |   32848 K  |
|       from small pool |    1111    |    1419    |   31764 K  |   31763 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    1298    |    2598    |   64613 K  |   64612 K  |
|       from large pool |     187    |    1413    |   32848 K  |   32848 K  |
|       from small pool |    1111    |    1419    |   31764 K  |   31763 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     635    |     637    |    2927    |    2292    |
|       from large pool |     602    |     602    |    2860    |    2258    |
|       from small pool |      33    |      35    |      67    |      34    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      97    |     652    |   44200 K  |   44200 K  |
|       from large pool |      38    |     605    |   25359 K  |   25359 K  |
|       from small pool |      59    |     237    |   18841 K  |   18841 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13219 MiB | 365434 GiB | 365434 GiB |
|       from large pool |  16640 KiB |  13181 MiB | 361084 GiB | 361084 GiB |
|       from small pool |      0 KiB |     60 MiB |   4350 GiB |   4350 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13219 MiB | 365434 GiB | 365434 GiB |
|       from large pool |  16640 KiB |  13181 MiB | 361084 GiB | 361084 GiB |
|       from small pool |      0 KiB |     60 MiB |   4350 GiB |   4350 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13213 MiB | 364722 GiB | 364722 GiB |
|       from large pool |  16640 KiB |  13175 MiB | 360380 GiB | 360380 GiB |
|       from small pool |      0 KiB |     60 MiB |   4341 GiB |   4341 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    880 MiB |  14482 MiB |  68840 MiB |  67960 MiB |
|       from large pool |    830 MiB |  14412 MiB |  68706 MiB |  67876 MiB |
|       from small pool |     50 MiB |     70 MiB |    134 MiB |     84 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1236 MiB | 255887 GiB | 255887 GiB |
|       from large pool |  24320 KiB |   1229 MiB | 251508 GiB | 251508 GiB |
|       from small pool |      0 KiB |     44 MiB |   4378 GiB |   4378 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    2598    |   64613 K  |   64613 K  |
|       from large pool |       2    |    1413    |   32848 K  |   32848 K  |
|       from small pool |       0    |    1419    |   31764 K  |   31764 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    2598    |   64613 K  |   64613 K  |
|       from large pool |       2    |    1413    |   32848 K  |   32848 K  |
|       from small pool |       0    |    1419    |   31764 K  |   31764 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      62    |     637    |    2927    |    2865    |
|       from large pool |      37    |     602    |    2860    |    2823    |
|       from small pool |      25    |      35    |      67    |      42    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |     652    |   44200 K  |   44200 K  |
|       from large pool |       4    |     605    |   25359 K  |   25359 K  |
|       from small pool |       0    |     237    |   18841 K  |   18841 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13219 MiB | 365434 GiB | 365434 GiB |
|       from large pool |  16640 KiB |  13181 MiB | 361084 GiB | 361084 GiB |
|       from small pool |      0 KiB |     60 MiB |   4350 GiB |   4350 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13219 MiB | 365434 GiB | 365434 GiB |
|       from large pool |  16640 KiB |  13181 MiB | 361084 GiB | 361084 GiB |
|       from small pool |      0 KiB |     60 MiB |   4350 GiB |   4350 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13213 MiB | 364722 GiB | 364722 GiB |
|       from large pool |  16640 KiB |  13175 MiB | 360380 GiB | 360380 GiB |
|       from small pool |      0 KiB |     60 MiB |   4341 GiB |   4341 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    880 MiB |  14482 MiB |  68840 MiB |  67960 MiB |
|       from large pool |    830 MiB |  14412 MiB |  68706 MiB |  67876 MiB |
|       from small pool |     50 MiB |     70 MiB |    134 MiB |     84 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1236 MiB | 255887 GiB | 255887 GiB |
|       from large pool |  24320 KiB |   1229 MiB | 251508 GiB | 251508 GiB |
|       from small pool |      0 KiB |     44 MiB |   4378 GiB |   4378 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    2598    |   64613 K  |   64613 K  |
|       from large pool |       2    |    1413    |   32848 K  |   32848 K  |
|       from small pool |       0    |    1419    |   31764 K  |   31764 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    2598    |   64613 K  |   64613 K  |
|       from large pool |       2    |    1413    |   32848 K  |   32848 K  |
|       from small pool |       0    |    1419    |   31764 K  |   31764 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      62    |     637    |    2927    |    2865    |
|       from large pool |      37    |     602    |    2860    |    2823    |
|       from small pool |      25    |      35    |      67    |      42    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |     652    |   44200 K  |   44200 K  |
|       from large pool |       4    |     605    |   25359 K  |   25359 K  |
|       from small pool |       0    |     237    |   18841 K  |   18841 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'888c1ef2'
model name: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_08_27_25_seed_5_23065778

 Experiment start at: 2024-07-26 08:27:25.048311
before training, model accuracy: 0.5476190447807312
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9554974, 'precision': 0.9555575, 'recall': 0.95564497, 'specificity': 0.95564497, 'f1': 0.95549643, 'auroc': 0.9906766, 'binary_precision': 0.96576697, 'binary_recall': 0.9458414, 'binary_specificity': 0.9654485, 'binary_f1_score': 0.95570034}
confusion matrix:
      0     1
0  1453    52
1    84  1467
---- Validation: 
scalar performance:
{'acc': 0.84836704, 'precision': 0.8482393, 'recall': 0.84844416, 'specificity': 0.84844416, 'f1': 0.8483001, 'auroc': 0.91353226, 'binary_precision': 0.8391167, 'binary_recall': 0.8512, 'binary_specificity': 0.84568834, 'binary_f1_score': 0.8451151}
confusion matrix:
     0    1
0  559  102
1   93  532
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.82900435, 'precision': 0.8307959, 'recall': 0.8290043, 'specificity': 0.8290043, 'f1': 0.82877254, 'auroc': 0.9127828, 'binary_precision': 0.8064516, 'binary_recall': 0.86580086, 'binary_specificity': 0.7922078, 'binary_f1_score': 0.8350731}
confusion matrix:
     0    1
0  183   48
1   31  200
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-26 08:28:55.282865,epoch time: 0:01:30.234554,used: 0:01:30.234554,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_08_27_25_seed_5_23065778
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.96433246, 'precision': 0.96477926, 'recall': 0.9641503, 'specificity': 0.9641503, 'f1': 0.96430737, 'auroc': 0.99431276, 'binary_precision': 0.9534005, 'binary_recall': 0.9774048, 'binary_specificity': 0.95089585, 'binary_f1_score': 0.9652534}
confusion matrix:
      0     1
0  1433    74
1    35  1514
---- Validation: 
scalar performance:
{'acc': 0.85225505, 'precision': 0.8526391, 'recall': 0.85279274, 'specificity': 0.85279274, 'f1': 0.85225177, 'auroc': 0.9120654, 'binary_precision': 0.83206105, 'binary_recall': 0.872, 'binary_specificity': 0.8335855, 'binary_f1_score': 0.85156244}
confusion matrix:
     0    1
0  551  110
1   80  545
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.83766234, 'precision': 0.84047616, 'recall': 0.83766234, 'specificity': 0.83766234, 'f1': 0.8373262, 'auroc': 0.928712, 'binary_precision': 0.8095238, 'binary_recall': 0.8831169, 'binary_specificity': 0.7922078, 'binary_f1_score': 0.8447205}
confusion matrix:
     0    1
0  183   48
1   27  204
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-07-26 08:30:21.881897,epoch time: 0:01:26.599032,used: 0:02:56.833586,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_08_27_25_seed_5_23065778
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.97218585, 'precision': 0.97226214, 'recall': 0.9723356, 'specificity': 0.9723356, 'f1': 0.9721855, 'auroc': 0.99630165, 'binary_precision': 0.9828609, 'binary_recall': 0.96193546, 'binary_specificity': 0.98273575, 'binary_f1_score': 0.9722856}
confusion matrix:
      0     1
0  1480    26
1    59  1491
---- Validation: 
scalar performance:
{'acc': 0.82115084, 'precision': 0.8296852, 'recall': 0.81883204, 'specificity': 0.81883204, 'f1': 0.819128, 'auroc': 0.8896872, 'binary_precision': 0.8761905, 'binary_recall': 0.736, 'binary_specificity': 0.90166414, 'binary_f1_score': 0.8}
confusion matrix:
     0    1
0  596   65
1  165  460
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8398268, 'precision': 0.84107965, 'recall': 0.8398268, 'specificity': 0.8398268, 'f1': 0.8396796, 'auroc': 0.9208973, 'binary_precision': 0.82040817, 'binary_recall': 0.8701299, 'binary_specificity': 0.8095238, 'binary_f1_score': 0.8445378}
confusion matrix:
     0    1
0  187   44
1   30  201
new oracle model saved
early stop counter: 1
val acc:0.8211508393287659, best validation acc: 0.8522550463676453, corresponding to test acc:                         0.8376623392105103 / 0.8398268222808838
after epoch: 3,now: 2024-07-26 08:31:48.293196,epoch time: 0:01:26.411299,used: 0:04:23.244885,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_08_27_25_seed_5_23065778
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.983966, 'precision': 0.98398197, 'recall': 0.98408043, 'specificity': 0.98408043, 'f1': 0.98396534, 'auroc': 0.998094, 'binary_precision': 0.9921312, 'binary_recall': 0.97612906, 'binary_specificity': 0.9920319, 'binary_f1_score': 0.984065}
confusion matrix:
      0     1
0  1494    12
1    37  1513
---- Validation: 
scalar performance:
{'acc': 0.7986003, 'precision': 0.81580377, 'recall': 0.7952399, 'specificity': 0.7952399, 'f1': 0.7944377, 'auroc': 0.8870439, 'binary_precision': 0.88284516, 'binary_recall': 0.6752, 'binary_specificity': 0.91527987, 'binary_f1_score': 0.76518583}
confusion matrix:
     0    1
0  605   56
1  203  422
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.82251084, 'precision': 0.8442106, 'recall': 0.82251084, 'specificity': 0.82251084, 'f1': 0.8196687, 'auroc': 0.9145256, 'binary_precision': 0.9306358, 'binary_recall': 0.6969697, 'binary_specificity': 0.9480519, 'binary_f1_score': 0.79702973}
confusion matrix:
     0    1
0  219   12
1   70  161
early stop counter: 2
val acc:0.7986003160476685, best validation acc: 0.8522550463676453, corresponding to test acc:                         0.8376623392105103 / 0.8398268222808838
after epoch: 4,now: 2024-07-26 08:33:14.922354,epoch time: 0:01:26.629158,used: 0:05:49.874043,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_08_27_25_seed_5_23065778
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.97938484, 'precision': 0.9793626, 'recall': 0.97946393, 'specificity': 0.97946393, 'f1': 0.97938293, 'auroc': 0.99735975, 'binary_precision': 0.9850065, 'binary_recall': 0.9742102, 'binary_specificity': 0.9847176, 'binary_f1_score': 0.9795786}
confusion matrix:
      0     1
0  1482    23
1    40  1511
---- Validation: 
scalar performance:
{'acc': 0.8304821, 'precision': 0.83052886, 'recall': 0.83078486, 'specificity': 0.83078486, 'f1': 0.83045584, 'auroc': 0.8949374, 'binary_precision': 0.8155039, 'binary_recall': 0.8416, 'binary_specificity': 0.8199697, 'binary_f1_score': 0.82834643}
confusion matrix:
     0    1
0  542  119
1   99  526
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.84632033, 'precision': 0.84637874, 'recall': 0.84632033, 'specificity': 0.84632033, 'f1': 0.84631383, 'auroc': 0.91743034, 'binary_precision': 0.85087717, 'binary_recall': 0.8398268, 'binary_specificity': 0.85281384, 'binary_f1_score': 0.8453159}
confusion matrix:
     0    1
0  197   34
1   37  194
new oracle model saved
early stop counter: 3
val acc:0.8304821252822876, best validation acc: 0.8522550463676453, corresponding to test acc:                         0.8376623392105103 / 0.8463203310966492
after epoch: 5,now: 2024-07-26 08:34:41.409200,epoch time: 0:01:26.486846,used: 0:07:16.360889,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_08_27_25_seed_5_23065778
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.98232985, 'precision': 0.98253345, 'recall': 0.9825715, 'specificity': 0.9825715, 'f1': 0.98232985, 'auroc': 0.9990091, 'binary_precision': 0.99734575, 'binary_recall': 0.96780425, 'binary_specificity': 0.99733865, 'binary_f1_score': 0.982353}
confusion matrix:
      0     1
0  1499     4
1    50  1503
---- Validation: 
scalar performance:
{'acc': 0.79004663, 'precision': 0.7916831, 'recall': 0.7888363, 'specificity': 0.7888363, 'f1': 0.789147, 'auroc': 0.8703661, 'binary_precision': 0.80762565, 'binary_recall': 0.7456, 'binary_specificity': 0.8320726, 'binary_f1_score': 0.7753744}
confusion matrix:
     0    1
0  550  111
1  159  466
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.82900435, 'precision': 0.8307959, 'recall': 0.8290043, 'specificity': 0.8290043, 'f1': 0.82877254, 'auroc': 0.8862653, 'binary_precision': 0.8551402, 'binary_recall': 0.7922078, 'binary_specificity': 0.86580086, 'binary_f1_score': 0.822472}
confusion matrix:
     0    1
0  200   31
1   48  183
early stop counter: 4
val acc:0.7900466322898865, best validation acc: 0.8522550463676453, corresponding to test acc:                         0.8376623392105103 / 0.8463203310966492
after epoch: 6,now: 2024-07-26 08:36:07.628421,epoch time: 0:01:26.219221,used: 0:08:42.580110,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_08_27_25_seed_5_23065778
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9826571, 'precision': 0.98289454, 'recall': 0.98292494, 'specificity': 0.98292494, 'f1': 0.9826571, 'auroc': 0.99921465, 'binary_precision': 0.9986711, 'binary_recall': 0.96718144, 'binary_specificity': 0.99866843, 'binary_f1_score': 0.9826741}
confusion matrix:
      0     1
0  1500     2
1    51  1503
---- Validation: 
scalar performance:
{'acc': 0.5785381, 'precision': 0.7266042, 'recall': 0.5668357, 'specificity': 0.5668357, 'f1': 0.48078412, 'auroc': 0.8689501, 'binary_precision': 0.9029126, 'binary_recall': 0.1488, 'binary_specificity': 0.9848714, 'binary_f1_score': 0.2554945}
confusion matrix:
     0   1
0  651  10
1  532  93
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5649351, 'precision': 0.67436594, 'recall': 0.5649351, 'specificity': 0.5649351, 'f1': 0.483971, 'auroc': 0.8643953, 'binary_precision': 0.8125, 'binary_recall': 0.16883117, 'binary_specificity': 0.96103895, 'binary_f1_score': 0.2795699}
confusion matrix:
     0   1
0  222   9
1  192  39
early stop counter: 5
val acc:0.5785381197929382, best validation acc: 0.8522550463676453, corresponding to test acc:                         0.8376623392105103 / 0.8463203310966492
after epoch: 7,now: 2024-07-26 08:37:33.941210,epoch time: 0:01:26.312789,used: 0:10:08.892899,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_08_27_25_seed_5_23065778
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.98920155, 'precision': 0.9891971, 'recall': 0.98929834, 'specificity': 0.98929834, 'f1': 0.989201, 'auroc': 0.99923915, 'binary_precision': 0.99607587, 'binary_recall': 0.98258066, 'binary_specificity': 0.99601597, 'binary_f1_score': 0.98928225}
confusion matrix:
      0     1
0  1500     6
1    27  1523
---- Validation: 
scalar performance:
{'acc': 0.84914464, 'precision': 0.8531022, 'recall': 0.84763205, 'specificity': 0.84763205, 'f1': 0.8482269, 'auroc': 0.91620934, 'binary_precision': 0.8841355, 'binary_recall': 0.7936, 'binary_specificity': 0.90166414, 'binary_f1_score': 0.83642495}
confusion matrix:
     0    1
0  596   65
1  129  496
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.84415585, 'precision': 0.85968626, 'recall': 0.84415585, 'specificity': 0.84415585, 'f1': 0.84245527, 'auroc': 0.92327726, 'binary_precision': 0.93442625, 'binary_recall': 0.74025977, 'binary_specificity': 0.9480519, 'binary_f1_score': 0.826087}
confusion matrix:
     0    1
0  219   12
1   60  171
early stop counter: 6
val acc:0.8491446375846863, best validation acc: 0.8522550463676453, corresponding to test acc:                         0.8376623392105103 / 0.8463203310966492
after epoch: 8,now: 2024-07-26 08:39:00.249676,epoch time: 0:01:26.308466,used: 0:11:35.201365,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_08_27_25_seed_5_23065778
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.98658377, 'precision': 0.9865936, 'recall': 0.9866847, 'specificity': 0.9866847, 'f1': 0.98658323, 'auroc': 0.99945503, 'binary_precision': 0.99410224, 'binary_recall': 0.9793415, 'binary_specificity': 0.99402785, 'binary_f1_score': 0.9866667}
confusion matrix:
      0     1
0  1498     9
1    32  1517
---- Validation: 
scalar performance:
{'acc': 0.7534992, 'precision': 0.8077562, 'recall': 0.7474893, 'specificity': 0.7474893, 'f1': 0.73901063, 'auroc': 0.90050954, 'binary_precision': 0.9301676, 'binary_recall': 0.5328, 'binary_specificity': 0.9621785, 'binary_f1_score': 0.67751783}
confusion matrix:
     0    1
0  636   25
1  292  333
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.82900435, 'precision': 0.8655063, 'recall': 0.8290043, 'specificity': 0.8290043, 'f1': 0.82462585, 'auroc': 0.92348343, 'binary_precision': 0.98101264, 'binary_recall': 0.67099565, 'binary_specificity': 0.987013, 'binary_f1_score': 0.7969152}
confusion matrix:
     0    1
0  228    3
1   76  155
early stop counter: 7
val acc:0.7534992098808289, best validation acc: 0.8522550463676453, corresponding to test acc:                         0.8376623392105103 / 0.8463203310966492
after epoch: 9,now: 2024-07-26 08:40:26.736739,epoch time: 0:01:26.487063,used: 0:13:01.688428,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_08_27_25_seed_5_23065778
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.983966, 'precision': 0.9841069, 'recall': 0.9838706, 'specificity': 0.9838706, 'f1': 0.98395824, 'auroc': 0.9994148, 'binary_precision': 0.9789809, 'binary_recall': 0.98969734, 'binary_specificity': 0.9780439, 'binary_f1_score': 0.9843099}
confusion matrix:
      0     1
0  1470    33
1    16  1537
---- Validation: 
scalar performance:
{'acc': 0.83514774, 'precision': 0.8456787, 'recall': 0.8326657, 'specificity': 0.8326657, 'f1': 0.83305454, 'auroc': 0.9161755, 'binary_precision': 0.8994197, 'binary_recall': 0.744, 'binary_specificity': 0.9213313, 'binary_f1_score': 0.8143608}
confusion matrix:
     0    1
0  609   52
1  160  465
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.82251084, 'precision': 0.8475473, 'recall': 0.82251084, 'specificity': 0.82251084, 'f1': 0.8192557, 'auroc': 0.91982913, 'binary_precision': 0.9408284, 'binary_recall': 0.6883117, 'binary_specificity': 0.95671, 'binary_f1_score': 0.79499996}
confusion matrix:
     0    1
0  221   10
1   72  159
early stop counter: 8
val acc:0.8351477384567261, best validation acc: 0.8522550463676453, corresponding to test acc:                         0.8376623392105103 / 0.8463203310966492
after epoch: 10,now: 2024-07-26 08:41:52.799434,epoch time: 0:01:26.062695,used: 0:14:27.751123,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_08_27_25_seed_5_23065778
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.973822, 'precision': 0.97456574, 'recall': 0.97415584, 'specificity': 0.97415584, 'f1': 0.97381973, 'auroc': 0.9986197, 'binary_precision': 0.99729365, 'binary_recall': 0.9509677, 'binary_specificity': 0.99734396, 'binary_f1_score': 0.9735799}
confusion matrix:
      0     1
0  1502     4
1    76  1474
---- Validation: 
scalar performance:
{'acc': 0.80482113, 'precision': 0.83942837, 'recall': 0.8002893, 'specificity': 0.8002893, 'f1': 0.7979591, 'auroc': 0.91258097, 'binary_precision': 0.9410377, 'binary_recall': 0.6384, 'binary_specificity': 0.9621785, 'binary_f1_score': 0.7607245}
confusion matrix:
     0    1
0  636   25
1  226  399
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.83549786, 'precision': 0.87622154, 'recall': 0.83549786, 'specificity': 0.83549786, 'f1': 0.83092237, 'auroc': 0.92500603, 'binary_precision': 1.0, 'binary_recall': 0.67099565, 'binary_specificity': 1.0, 'binary_f1_score': 0.80310875}
confusion matrix:
     0    1
0  231    0
1   76  155
early stop counter: 9
val acc:0.8048211336135864, best validation acc: 0.8522550463676453, corresponding to test acc:                         0.8376623392105103 / 0.8463203310966492
after epoch: 11,now: 2024-07-26 08:43:19.279966,epoch time: 0:01:26.480532,used: 0:15:54.231655,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_08_27_25_seed_5_23065778
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.98854715, 'precision': 0.98851395, 'recall': 0.9886385, 'specificity': 0.9886385, 'f1': 0.98854566, 'auroc': 0.9994435, 'binary_precision': 0.99414444, 'binary_recall': 0.983269, 'binary_specificity': 0.994008, 'binary_f1_score': 0.98867685}
confusion matrix:
      0     1
0  1493     9
1    26  1528
---- Validation: 
scalar performance:
{'acc': 0.8017107, 'precision': 0.8374436, 'recall': 0.7970893, 'specificity': 0.7970893, 'f1': 0.79449344, 'auroc': 0.92429173, 'binary_precision': 0.9404762, 'binary_recall': 0.632, 'binary_specificity': 0.9621785, 'binary_f1_score': 0.7559809}
confusion matrix:
     0    1
0  636   25
1  230  395
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.65800864, 'precision': 0.7786628, 'recall': 0.65800864, 'specificity': 0.65800864, 'f1': 0.61649674, 'auroc': 0.9193231, 'binary_precision': 0.96202534, 'binary_recall': 0.32900432, 'binary_specificity': 0.987013, 'binary_f1_score': 0.49032256}
confusion matrix:
     0   1
0  228   3
1  155  76
early stop counter: 10
val acc:0.8017107248306274, best validation acc: 0.8522550463676453, corresponding to test acc:                         0.8376623392105103 / 0.8463203310966492
after epoch: 12,now: 2024-07-26 08:44:45.839737,epoch time: 0:01:26.559771,used: 0:17:20.791426,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_08_27_25_seed_5_23065778
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9888743, 'precision': 0.9888412, 'recall': 0.9889249, 'specificity': 0.9889249, 'f1': 0.9888724, 'auroc': 0.99888146, 'binary_precision': 0.99222296, 'binary_recall': 0.9858339, 'binary_specificity': 0.99201596, 'binary_f1_score': 0.9890181}
confusion matrix:
      0     1
0  1491    12
1    22  1531
---- Validation: 
scalar performance:
{'acc': 0.6866252, 'precision': 0.7733388, 'recall': 0.67851496, 'specificity': 0.67851496, 'f1': 0.65361416, 'auroc': 0.8898711, 'binary_precision': 0.92045456, 'binary_recall': 0.3888, 'binary_specificity': 0.96822995, 'binary_f1_score': 0.54668164}
confusion matrix:
     0    1
0  640   21
1  382  243
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7878788, 'precision': 0.84214985, 'recall': 0.78787875, 'specificity': 0.78787875, 'f1': 0.77911997, 'auroc': 0.92648184, 'binary_precision': 0.9784173, 'binary_recall': 0.5887446, 'binary_specificity': 0.987013, 'binary_f1_score': 0.7351352}
confusion matrix:
     0    1
0  228    3
1   95  136
early stop counter: 11
val acc:0.6866251826286316, best validation acc: 0.8522550463676453, corresponding to test acc:                         0.8376623392105103 / 0.8463203310966492
after epoch: 13,now: 2024-07-26 08:46:12.264928,epoch time: 0:01:26.425191,used: 0:18:47.216617,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_08_27_25_seed_5_23065778
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.98625654, 'precision': 0.9863693, 'recall': 0.9864485, 'specificity': 0.9864485, 'f1': 0.98625636, 'auroc': 0.9995489, 'binary_precision': 0.998679, 'binary_recall': 0.97422683, 'binary_specificity': 0.9986702, 'binary_f1_score': 0.98630136}
confusion matrix:
      0     1
0  1502     2
1    40  1512
---- Validation: 
scalar performance:
{'acc': 0.6415241, 'precision': 0.7805962, 'recall': 0.6314179, 'specificity': 0.6314179, 'f1': 0.5815087, 'auroc': 0.8809198, 'binary_precision': 0.97126436, 'binary_recall': 0.2704, 'binary_specificity': 0.9924357, 'binary_f1_score': 0.42302874}
confusion matrix:
     0    1
0  656    5
1  456  169
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.64069265, 'precision': 0.790932, 'recall': 0.64069265, 'specificity': 0.64069265, 'f1': 0.587429, 'auroc': 0.9074558, 'binary_precision': 1.0, 'binary_recall': 0.28138527, 'binary_specificity': 1.0, 'binary_f1_score': 0.43918917}
confusion matrix:
     0   1
0  231   0
1  166  65
early stop counter: 12
val acc:0.641524076461792, best validation acc: 0.8522550463676453, corresponding to test acc:                         0.8376623392105103 / 0.8463203310966492
after epoch: 14,now: 2024-07-26 08:47:38.538177,epoch time: 0:01:26.273249,used: 0:20:13.489866,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_08_27_25_seed_5_23065778
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.96727747, 'precision': 0.9695221, 'recall': 0.96672356, 'specificity': 0.96672356, 'f1': 0.9672006, 'auroc': 0.9995438, 'binary_precision': 0.9411765, 'binary_recall': 0.9980707, 'binary_specificity': 0.9353764, 'binary_f1_score': 0.96878904}
confusion matrix:
      0     1
0  1404    97
1     3  1552
---- Validation: 
scalar performance:
{'acc': 0.8584759, 'precision': 0.8592001, 'recall': 0.85779846, 'specificity': 0.85779846, 'f1': 0.8581462, 'auroc': 0.91584873, 'binary_precision': 0.869783, 'binary_recall': 0.8336, 'binary_specificity': 0.881997, 'binary_f1_score': 0.8513072}
confusion matrix:
     0    1
0  583   78
1  104  521
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8549784, 'precision': 0.85739625, 'recall': 0.8549783, 'specificity': 0.8549783, 'f1': 0.8547327, 'auroc': 0.9194168, 'binary_precision': 0.8867925, 'binary_recall': 0.8138528, 'binary_specificity': 0.8961039, 'binary_f1_score': 0.8487585}
confusion matrix:
     0    1
0  207   24
1   43  188
new oracle model saved
better model found
persisted
after epoch: 15,now: 2024-07-26 08:49:05.093645,epoch time: 0:01:26.555468,used: 0:21:40.045334,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_08_27_25_seed_5_23065778
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9921466, 'precision': 0.9921559, 'recall': 0.99213314, 'specificity': 0.99213314, 'f1': 0.9921441, 'auroc': 0.9996538, 'binary_precision': 0.9916452, 'binary_recall': 0.9929215, 'binary_specificity': 0.99134487, 'binary_f1_score': 0.9922829}
confusion matrix:
      0     1
0  1489    13
1    11  1543
---- Validation: 
scalar performance:
{'acc': 0.777605, 'precision': 0.82150054, 'recall': 0.7723328, 'specificity': 0.7723328, 'f1': 0.76734966, 'auroc': 0.9168139, 'binary_precision': 0.9335038, 'binary_recall': 0.584, 'binary_specificity': 0.96066564, 'binary_f1_score': 0.71850395}
confusion matrix:
     0    1
0  635   26
1  260  365
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.75974023, 'precision': 0.815344, 'recall': 0.75974023, 'specificity': 0.75974023, 'f1': 0.74866074, 'auroc': 0.90867394, 'binary_precision': 0.9477612, 'binary_recall': 0.5497835, 'binary_specificity': 0.969697, 'binary_f1_score': 0.69589037}
confusion matrix:
     0    1
0  224    7
1  104  127
early stop counter: 1
val acc:0.7776049971580505, best validation acc: 0.858475923538208, corresponding to test acc:                         0.8549783825874329 / 0.8549783825874329
after epoch: 16,now: 2024-07-26 08:50:31.434679,epoch time: 0:01:26.341034,used: 0:23:06.386368,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_08_27_25_seed_5_23065778
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.98658377, 'precision': 0.98684216, 'recall': 0.98644066, 'specificity': 0.98644066, 'f1': 0.98657525, 'auroc': 0.9994178, 'binary_precision': 0.9791007, 'binary_recall': 0.994852, 'binary_specificity': 0.9780293, 'binary_f1_score': 0.9869135}
confusion matrix:
      0     1
0  1469    33
1     8  1546
---- Validation: 
scalar performance:
{'acc': 0.84914464, 'precision': 0.85179013, 'recall': 0.8478935, 'specificity': 0.8478935, 'f1': 0.8484349, 'auroc': 0.9042088, 'binary_precision': 0.87609076, 'binary_recall': 0.8032, 'binary_specificity': 0.892587, 'binary_f1_score': 0.8380634}
confusion matrix:
     0    1
0  590   71
1  123  502
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.84199136, 'precision': 0.85202545, 'recall': 0.8419913, 'specificity': 0.8419913, 'f1': 0.84085727, 'auroc': 0.9202976, 'binary_precision': 0.9114583, 'binary_recall': 0.75757575, 'binary_specificity': 0.9264069, 'binary_f1_score': 0.82742316}
confusion matrix:
     0    1
0  214   17
1   56  175
early stop counter: 2
val acc:0.8491446375846863, best validation acc: 0.858475923538208, corresponding to test acc:                         0.8549783825874329 / 0.8549783825874329
after epoch: 17,now: 2024-07-26 08:51:57.627454,epoch time: 0:01:26.192775,used: 0:24:32.579143,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_08_27_25_seed_5_23065778
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9878927, 'precision': 0.9879236, 'recall': 0.9880388, 'specificity': 0.9880388, 'f1': 0.9878922, 'auroc': 0.99963546, 'binary_precision': 0.9973736, 'binary_recall': 0.9787371, 'binary_specificity': 0.99734044, 'binary_f1_score': 0.9879675}
confusion matrix:
      0     1
0  1500     4
1    33  1519
---- Validation: 
scalar performance:
{'acc': 0.62674963, 'precision': 0.7600627, 'recall': 0.6164357, 'specificity': 0.6164357, 'f1': 0.5615224, 'auroc': 0.8980188, 'binary_precision': 0.93939394, 'binary_recall': 0.248, 'binary_specificity': 0.9848714, 'binary_f1_score': 0.39240506}
confusion matrix:
     0    1
0  651   10
1  470  155
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7077922, 'precision': 0.7978083, 'recall': 0.70779216, 'specificity': 0.70779216, 'f1': 0.68390644, 'auroc': 0.9106276, 'binary_precision': 0.96153843, 'binary_recall': 0.43290043, 'binary_specificity': 0.98268396, 'binary_f1_score': 0.5970149}
confusion matrix:
     0    1
0  227    4
1  131  100
early stop counter: 3
val acc:0.6267496347427368, best validation acc: 0.858475923538208, corresponding to test acc:                         0.8549783825874329 / 0.8549783825874329
after epoch: 18,now: 2024-07-26 08:53:23.807262,epoch time: 0:01:26.179808,used: 0:25:58.758951,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_08_27_25_seed_5_23065778
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.98331153, 'precision': 0.98357815, 'recall': 0.98351, 'specificity': 0.98351, 'f1': 0.9833114, 'auroc': 0.9995463, 'binary_precision': 0.99866754, 'binary_recall': 0.96834624, 'binary_specificity': 0.99867374, 'binary_f1_score': 0.9832732}
confusion matrix:
      0     1
0  1506     2
1    49  1499
---- Validation: 
scalar performance:
{'acc': 0.8157076, 'precision': 0.8464612, 'recall': 0.8114892, 'specificity': 0.8114892, 'f1': 0.8099942, 'auroc': 0.9219135, 'binary_precision': 0.94292235, 'binary_recall': 0.6608, 'binary_specificity': 0.9621785, 'binary_f1_score': 0.777046}
confusion matrix:
     0    1
0  636   25
1  212  413
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7900433, 'precision': 0.84908426, 'recall': 0.79004323, 'specificity': 0.79004323, 'f1': 0.78077376, 'auroc': 0.9349525, 'binary_precision': 0.99264705, 'binary_recall': 0.58441556, 'binary_specificity': 0.995671, 'binary_f1_score': 0.73569477}
confusion matrix:
     0    1
0  230    1
1   96  135
early stop counter: 4
val acc:0.8157076239585876, best validation acc: 0.858475923538208, corresponding to test acc:                         0.8549783825874329 / 0.8549783825874329
after epoch: 19,now: 2024-07-26 08:54:49.969855,epoch time: 0:01:26.162593,used: 0:27:24.921544,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_08_27_25_seed_5_23065778
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.98920155, 'precision': 0.9892246, 'recall': 0.98933214, 'specificity': 0.98933214, 'f1': 0.9892012, 'auroc': 0.9997344, 'binary_precision': 0.9980315, 'binary_recall': 0.98065764, 'binary_specificity': 0.99800664, 'binary_f1_score': 0.9892683}
confusion matrix:
      0     1
0  1502     3
1    30  1521
---- Validation: 
scalar performance:
{'acc': 0.6998445, 'precision': 0.79280764, 'recall': 0.69176644, 'specificity': 0.69176644, 'f1': 0.6684017, 'auroc': 0.9131583, 'binary_precision': 0.9509434, 'binary_recall': 0.4032, 'binary_specificity': 0.98033285, 'binary_f1_score': 0.56629217}
confusion matrix:
     0    1
0  648   13
1  373  252
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.72727275, 'precision': 0.80751574, 'recall': 0.72727275, 'specificity': 0.72727275, 'f1': 0.7082398, 'auroc': 0.9027941, 'binary_precision': 0.96460176, 'binary_recall': 0.47186148, 'binary_specificity': 0.98268396, 'binary_f1_score': 0.63372093}
confusion matrix:
     0    1
0  227    4
1  122  109
early stop counter: 5
val acc:0.699844479560852, best validation acc: 0.858475923538208, corresponding to test acc:                         0.8549783825874329 / 0.8549783825874329
after epoch: 20,now: 2024-07-26 08:56:16.075670,epoch time: 0:01:26.105815,used: 0:28:51.027359,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_08_27_25_seed_5_23065778
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.99247384, 'precision': 0.99246395, 'recall': 0.99259496, 'specificity': 0.99259496, 'f1': 0.99247324, 'auroc': 0.9997078, 'binary_precision': 1.0, 'binary_recall': 0.98519, 'binary_specificity': 1.0, 'binary_f1_score': 0.99253976}
confusion matrix:
      0     1
0  1503     0
1    23  1530
---- Validation: 
scalar performance:
{'acc': 0.6967341, 'precision': 0.78353846, 'recall': 0.68878424, 'specificity': 0.68878424, 'f1': 0.66601765, 'auroc': 0.91385174, 'binary_precision': 0.9335793, 'binary_recall': 0.4048, 'binary_specificity': 0.97276855, 'binary_f1_score': 0.56473213}
confusion matrix:
     0    1
0  643   18
1  372  253
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5649351, 'precision': 0.7381116, 'recall': 0.5649351, 'specificity': 0.5649351, 'f1': 0.46825096, 'auroc': 0.89531684, 'binary_precision': 0.9411765, 'binary_recall': 0.13852814, 'binary_specificity': 0.991342, 'binary_f1_score': 0.24150942}
confusion matrix:
     0   1
0  229   2
1  199  32
early stop counter: 6
val acc:0.6967340707778931, best validation acc: 0.858475923538208, corresponding to test acc:                         0.8549783825874329 / 0.8549783825874329
after epoch: 21,now: 2024-07-26 08:57:42.482757,epoch time: 0:01:26.407087,used: 0:30:17.434446,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_08_27_25_seed_5_23065778
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.99345547, 'precision': 0.993434, 'recall': 0.99356085, 'specificity': 0.99356085, 'f1': 0.9934549, 'auroc': 0.9999242, 'binary_precision': 1.0, 'binary_recall': 0.9871217, 'binary_specificity': 1.0, 'binary_f1_score': 0.9935191}
confusion matrix:
      0     1
0  1503     0
1    20  1533
---- Validation: 
scalar performance:
{'acc': 0.7566096, 'precision': 0.8261347, 'recall': 0.7500357, 'specificity': 0.7500357, 'f1': 0.73956406, 'auroc': 0.9264896, 'binary_precision': 0.9698795, 'binary_recall': 0.5152, 'binary_specificity': 0.9848714, 'binary_f1_score': 0.67293626}
confusion matrix:
     0    1
0  651   10
1  303  322
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.63419914, 'precision': 0.78875, 'recall': 0.63419914, 'specificity': 0.63419914, 'f1': 0.57768965, 'auroc': 0.9132325, 'binary_precision': 1.0, 'binary_recall': 0.26839826, 'binary_specificity': 1.0, 'binary_f1_score': 0.42320818}
confusion matrix:
     0   1
0  231   0
1  169  62
early stop counter: 7
val acc:0.7566096186637878, best validation acc: 0.858475923538208, corresponding to test acc:                         0.8549783825874329 / 0.8549783825874329
after epoch: 22,now: 2024-07-26 08:59:08.703727,epoch time: 0:01:26.220970,used: 0:31:43.655416,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_08_27_25_seed_5_23065778
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.98854715, 'precision': 0.9886483, 'recall': 0.9884714, 'specificity': 0.9884714, 'f1': 0.9885419, 'auroc': 0.999539, 'binary_precision': 0.9846841, 'binary_recall': 0.9929215, 'binary_specificity': 0.9840213, 'binary_f1_score': 0.9887856}
confusion matrix:
      0     1
0  1478    24
1    11  1543
---- Validation: 
scalar performance:
{'acc': 0.7978227, 'precision': 0.8365909, 'recall': 0.7930021, 'specificity': 0.7930021, 'f1': 0.78988194, 'auroc': 0.9284121, 'binary_precision': 0.9440389, 'binary_recall': 0.6208, 'binary_specificity': 0.96520424, 'binary_f1_score': 0.7490348}
confusion matrix:
     0    1
0  638   23
1  237  388
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7316017, 'precision': 0.8133732, 'recall': 0.7316017, 'specificity': 0.7316017, 'f1': 0.71287084, 'auroc': 0.9494761, 'binary_precision': 0.9734513, 'binary_recall': 0.47619048, 'binary_specificity': 0.987013, 'binary_f1_score': 0.6395349}
confusion matrix:
     0    1
0  228    3
1  121  110
early stop counter: 8
val acc:0.7978227138519287, best validation acc: 0.858475923538208, corresponding to test acc:                         0.8549783825874329 / 0.8549783825874329
after epoch: 23,now: 2024-07-26 09:00:35.469614,epoch time: 0:01:26.765887,used: 0:33:10.421303,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_08_27_25_seed_5_23065778
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.99018323, 'precision': 0.9903449, 'recall': 0.9900801, 'specificity': 0.9900801, 'f1': 0.9901781, 'auroc': 0.9996144, 'binary_precision': 0.9847328, 'binary_recall': 0.996139, 'binary_specificity': 0.9840213, 'binary_f1_score': 0.99040306}
confusion matrix:
      0     1
0  1478    24
1     6  1548
---- Validation: 
scalar performance:
{'acc': 0.8102644, 'precision': 0.83125085, 'recall': 0.8066735, 'specificity': 0.8066735, 'f1': 0.805846, 'auroc': 0.91076064, 'binary_precision': 0.9079229, 'binary_recall': 0.6784, 'binary_specificity': 0.9349471, 'binary_f1_score': 0.7765568}
confusion matrix:
     0    1
0  618   43
1  201  424
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8160173, 'precision': 0.8397059, 'recall': 0.81601727, 'specificity': 0.81601727, 'f1': 0.81275296, 'auroc': 0.9022694, 'binary_precision': 0.92941177, 'binary_recall': 0.6839827, 'binary_specificity': 0.9480519, 'binary_f1_score': 0.7880299}
confusion matrix:
     0    1
0  219   12
1   73  158
early stop counter: 9
val acc:0.8102644085884094, best validation acc: 0.858475923538208, corresponding to test acc:                         0.8549783825874329 / 0.8549783825874329
after epoch: 24,now: 2024-07-26 09:02:01.881326,epoch time: 0:01:26.411712,used: 0:34:36.833015,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_08_27_25_seed_5_23065778
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.99443716, 'precision': 0.9944226, 'recall': 0.9944512, 'specificity': 0.9944512, 'f1': 0.99443597, 'auroc': 0.9997541, 'binary_precision': 0.99548095, 'binary_recall': 0.9935567, 'binary_specificity': 0.9953458, 'binary_f1_score': 0.9945179}
confusion matrix:
      0     1
0  1497     7
1    10  1542
---- Validation: 
scalar performance:
{'acc': 0.8125972, 'precision': 0.8182508, 'recall': 0.81064206, 'specificity': 0.81064206, 'f1': 0.8109787, 'auroc': 0.8835994, 'binary_precision': 0.8542435, 'binary_recall': 0.7408, 'binary_specificity': 0.8804841, 'binary_f1_score': 0.7934876}
confusion matrix:
     0    1
0  582   79
1  162  463
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7900433, 'precision': 0.8149829, 'recall': 0.7900433, 'specificity': 0.7900433, 'f1': 0.7858034, 'auroc': 0.8868649, 'binary_precision': 0.90361446, 'binary_recall': 0.64935064, 'binary_specificity': 0.93073595, 'binary_f1_score': 0.75566745}
confusion matrix:
     0    1
0  215   16
1   81  150
early stop counter: 10
val acc:0.8125972151756287, best validation acc: 0.858475923538208, corresponding to test acc:                         0.8549783825874329 / 0.8549783825874329
after epoch: 25,now: 2024-07-26 09:03:28.354217,epoch time: 0:01:26.472891,used: 0:36:03.305906,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_08_27_25_seed_5_23065778
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.97316754, 'precision': 0.9741488, 'recall': 0.9735825, 'specificity': 0.9735825, 'f1': 0.9731642, 'auroc': 0.999557, 'binary_precision': 1.0, 'binary_recall': 0.94716495, 'binary_specificity': 1.0, 'binary_f1_score': 0.97286564}
confusion matrix:
      0     1
0  1504     0
1    82  1470
---- Validation: 
scalar performance:
{'acc': 0.62908244, 'precision': 0.763963, 'recall': 0.6187921, 'specificity': 0.6187921, 'f1': 0.56456935, 'auroc': 0.88470566, 'binary_precision': 0.94578314, 'binary_recall': 0.2512, 'binary_specificity': 0.9863843, 'binary_f1_score': 0.39696586}
confusion matrix:
     0    1
0  652    9
1  468  157
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6818182, 'precision': 0.80003715, 'recall': 0.6818182, 'specificity': 0.6818182, 'f1': 0.6470515, 'auroc': 0.9220966, 'binary_precision': 0.9883721, 'binary_recall': 0.36796537, 'binary_specificity': 0.995671, 'binary_f1_score': 0.53627765}
confusion matrix:
     0   1
0  230   1
1  146  85
early stop counter: 11
val acc:0.629082441329956, best validation acc: 0.858475923538208, corresponding to test acc:                         0.8549783825874329 / 0.8549783825874329
after epoch: 26,now: 2024-07-26 09:04:54.612100,epoch time: 0:01:26.257883,used: 0:37:29.563789,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_08_27_25_seed_5_23065778
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.9928011, 'precision': 0.9927665, 'recall': 0.9928881, 'specificity': 0.9928881, 'f1': 0.9928, 'auroc': 0.9996239, 'binary_precision': 0.99804944, 'binary_recall': 0.9877735, 'binary_specificity': 0.99800265, 'binary_f1_score': 0.9928849}
confusion matrix:
      0     1
0  1499     3
1    19  1535
---- Validation: 
scalar performance:
{'acc': 0.8157076, 'precision': 0.8457501, 'recall': 0.81153286, 'specificity': 0.81153286, 'f1': 0.8100993, 'auroc': 0.921715, 'binary_precision': 0.9409091, 'binary_recall': 0.6624, 'binary_specificity': 0.96066564, 'binary_f1_score': 0.77746475}
confusion matrix:
     0    1
0  635   26
1  211  414
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.82251084, 'precision': 0.8593923, 'recall': 0.82251084, 'specificity': 0.82251084, 'f1': 0.81783736, 'auroc': 0.9225652, 'binary_precision': 0.9745223, 'binary_recall': 0.66233766, 'binary_specificity': 0.98268396, 'binary_f1_score': 0.7886598}
confusion matrix:
     0    1
0  227    4
1   78  153
early stop counter: 12
val acc:0.8157076239585876, best validation acc: 0.858475923538208, corresponding to test acc:                         0.8549783825874329 / 0.8549783825874329
after epoch: 27,now: 2024-07-26 09:06:20.792302,epoch time: 0:01:26.180202,used: 0:38:55.743991,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_08_27_25_seed_5_23065778
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.9950916, 'precision': 0.99512655, 'recall': 0.9950576, 'specificity': 0.9950576, 'f1': 0.9950894, 'auroc': 0.9998895, 'binary_precision': 0.99360204, 'binary_recall': 0.99679077, 'binary_specificity': 0.99332446, 'binary_f1_score': 0.99519384}
confusion matrix:
      0     1
0  1488    10
1     5  1553
---- Validation: 
scalar performance:
{'acc': 0.7643857, 'precision': 0.8245176, 'recall': 0.7582536, 'specificity': 0.7582536, 'f1': 0.74994916, 'auroc': 0.91944325, 'binary_precision': 0.9573864, 'binary_recall': 0.5392, 'binary_specificity': 0.9773071, 'binary_f1_score': 0.68986696}
confusion matrix:
     0    1
0  646   15
1  288  337
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6515151, 'precision': 0.76456153, 'recall': 0.6515151, 'specificity': 0.6515151, 'f1': 0.60983616, 'auroc': 0.91180825, 'binary_precision': 0.9375, 'binary_recall': 0.32467532, 'binary_specificity': 0.978355, 'binary_f1_score': 0.4823151}
confusion matrix:
     0   1
0  226   5
1  156  75
early stop counter: 13
val acc:0.7643857002258301, best validation acc: 0.858475923538208, corresponding to test acc:                         0.8549783825874329 / 0.8549783825874329
after epoch: 28,now: 2024-07-26 09:07:47.023555,epoch time: 0:01:26.231253,used: 0:40:21.975244,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_08_27_25_seed_5_23065778
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.98854715, 'precision': 0.9885868, 'recall': 0.98871005, 'specificity': 0.98871005, 'f1': 0.9885467, 'auroc': 0.99975276, 'binary_precision': 0.99868596, 'binary_recall': 0.9787508, 'binary_specificity': 0.9986693, 'binary_f1_score': 0.9886179}
confusion matrix:
      0     1
0  1501     2
1    33  1520
---- Validation: 
scalar performance:
{'acc': 0.5482115, 'precision': 0.7552595, 'recall': 0.5352436, 'specificity': 0.5352436, 'f1': 0.41424975, 'auroc': 0.88697064, 'binary_precision': 0.9782609, 'binary_recall': 0.072, 'binary_specificity': 0.9984871, 'binary_f1_score': 0.13412815}
confusion matrix:
     0   1
0  660   1
1  580  45
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5151515, 'precision': 0.75384617, 'recall': 0.5151515, 'specificity': 0.5151515, 'f1': 0.36614648, 'auroc': 0.86807317, 'binary_precision': 1.0, 'binary_recall': 0.030303031, 'binary_specificity': 1.0, 'binary_f1_score': 0.058823533}
confusion matrix:
     0  1
0  231  0
1  224  7
early stop counter: 14
val acc:0.5482115149497986, best validation acc: 0.858475923538208, corresponding to test acc:                         0.8549783825874329 / 0.8549783825874329
after epoch: 29,now: 2024-07-26 09:09:13.226331,epoch time: 0:01:26.202776,used: 0:41:48.178020,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_08_27_25_seed_5_23065778
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.9937827, 'precision': 0.99375, 'recall': 0.99389064, 'specificity': 0.99389064, 'f1': 0.9937819, 'auroc': 0.9999516, 'binary_precision': 1.0, 'binary_recall': 0.98778135, 'binary_specificity': 1.0, 'binary_f1_score': 0.99385315}
confusion matrix:
      0     1
0  1501     0
1    19  1536
---- Validation: 
scalar performance:
{'acc': 0.64930016, 'precision': 0.78913504, 'recall': 0.6393307, 'specificity': 0.6393307, 'f1': 0.5922584, 'auroc': 0.9175286, 'binary_precision': 0.98333335, 'binary_recall': 0.2832, 'binary_specificity': 0.9954614, 'binary_f1_score': 0.43975154}
confusion matrix:
     0    1
0  658    3
1  448  177
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.54761904, 'precision': 0.7417238, 'recall': 0.54761904, 'specificity': 0.54761904, 'f1': 0.43399277, 'auroc': 0.8705983, 'binary_precision': 0.9583333, 'binary_recall': 0.0995671, 'binary_specificity': 0.995671, 'binary_f1_score': 0.18039215}
confusion matrix:
     0   1
0  230   1
1  208  23
early stop counter: 15
val acc:0.6493001580238342, best validation acc: 0.858475923538208, corresponding to test acc:                         0.8549783825874329 / 0.8549783825874329
after epoch: 30,now: 2024-07-26 09:10:39.433304,epoch time: 0:01:26.206973,used: 0:43:14.384993,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_08_27_25_seed_5_23065778
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 0:43:14.384993 at 2024-07-26 09:10:39.433304
persisted model performance metric: 

scalar performance:
{'acc': 0.8549784, 'precision': 0.85739625, 'recall': 0.8549783, 'specificity': 0.8549783, 'f1': 0.8547327, 'auroc': 0.9194168, 'binary_precision': 0.8867925, 'binary_recall': 0.8138528, 'binary_specificity': 0.8961039, 'binary_f1_score': 0.8487585}
confusion matrix:
     0    1
0  207   24
1   43  188
oracle model performance metric: 

scalar performance:
{'acc': 0.8549784, 'precision': 0.85739625, 'recall': 0.8549783, 'specificity': 0.8549783, 'f1': 0.8547327, 'auroc': 0.9194168, 'binary_precision': 0.8867925, 'binary_recall': 0.8138528, 'binary_specificity': 0.8961039, 'binary_f1_score': 0.8487585}
confusion matrix:
     0    1
0  207   24
1   43  188
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_irm_10seeds_nofreeze_2024-07-26_02-28-54/rule_results/1.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_irm_10seeds_nofreeze_2024-07-26_02-28-54/confusion_matrix/1.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 455402 KiB |  13219 MiB | 438504 GiB | 438504 GiB |
|       from large pool | 414803 KiB |  13181 MiB | 433285 GiB | 433285 GiB |
|       from small pool |  40598 KiB |     60 MiB |   5218 GiB |   5218 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 455402 KiB |  13219 MiB | 438504 GiB | 438504 GiB |
|       from large pool | 414803 KiB |  13181 MiB | 433285 GiB | 433285 GiB |
|       from small pool |  40598 KiB |     60 MiB |   5218 GiB |   5218 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 447482 KiB |  13213 MiB | 437736 GiB | 437735 GiB |
|       from large pool | 407075 KiB |  13175 MiB | 432528 GiB | 432527 GiB |
|       from small pool |  40407 KiB |     60 MiB |   5207 GiB |   5207 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  14478 MiB |  14482 MiB |  82438 MiB |  67960 MiB |
|       from large pool |  14412 MiB |  14412 MiB |  82288 MiB |  67876 MiB |
|       from small pool |     66 MiB |     70 MiB |    150 MiB |     84 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 447766 KiB |   1236 MiB | 306965 GiB | 306965 GiB |
|       from large pool | 435116 KiB |   1229 MiB | 301713 GiB | 301713 GiB |
|       from small pool |  12649 KiB |     44 MiB |   5252 GiB |   5252 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    1310    |    2598    |   77545 K  |   77544 K  |
|       from large pool |     187    |    1413    |   39426 K  |   39426 K  |
|       from small pool |    1123    |    1419    |   38119 K  |   38117 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    1310    |    2598    |   77545 K  |   77544 K  |
|       from large pool |     187    |    1413    |   39426 K  |   39426 K  |
|       from small pool |    1123    |    1419    |   38119 K  |   38117 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     635    |     637    |    3500    |    2865    |
|       from large pool |     602    |     602    |    3425    |    2823    |
|       from small pool |      33    |      35    |      75    |      42    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     102    |     652    |   52867 K  |   52867 K  |
|       from large pool |      38    |     605    |   30360 K  |   30360 K  |
|       from small pool |      64    |     237    |   22507 K  |   22506 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13219 MiB | 438504 GiB | 438504 GiB |
|       from large pool |  16640 KiB |  13181 MiB | 433285 GiB | 433285 GiB |
|       from small pool |      0 KiB |     60 MiB |   5218 GiB |   5218 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13219 MiB | 438504 GiB | 438504 GiB |
|       from large pool |  16640 KiB |  13181 MiB | 433285 GiB | 433285 GiB |
|       from small pool |      0 KiB |     60 MiB |   5218 GiB |   5218 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13213 MiB | 437736 GiB | 437736 GiB |
|       from large pool |  16640 KiB |  13175 MiB | 432528 GiB | 432528 GiB |
|       from small pool |      0 KiB |     60 MiB |   5207 GiB |   5207 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    882 MiB |  14482 MiB |  82438 MiB |  81556 MiB |
|       from large pool |    830 MiB |  14412 MiB |  82288 MiB |  81458 MiB |
|       from small pool |     52 MiB |     70 MiB |    150 MiB |     98 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1236 MiB | 306966 GiB | 306966 GiB |
|       from large pool |  24320 KiB |   1229 MiB | 301713 GiB | 301713 GiB |
|       from small pool |      0 KiB |     44 MiB |   5252 GiB |   5252 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    2598    |   77545 K  |   77545 K  |
|       from large pool |       2    |    1413    |   39426 K  |   39426 K  |
|       from small pool |       0    |    1419    |   38119 K  |   38119 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    2598    |   77545 K  |   77545 K  |
|       from large pool |       2    |    1413    |   39426 K  |   39426 K  |
|       from small pool |       0    |    1419    |   38119 K  |   38119 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      63    |     637    |    3500    |    3437    |
|       from large pool |      37    |     602    |    3425    |    3388    |
|       from small pool |      26    |      35    |      75    |      49    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |     652    |   52867 K  |   52867 K  |
|       from large pool |       4    |     605    |   30360 K  |   30360 K  |
|       from small pool |       0    |     237    |   22507 K  |   22507 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13219 MiB | 438504 GiB | 438504 GiB |
|       from large pool |  16640 KiB |  13181 MiB | 433285 GiB | 433285 GiB |
|       from small pool |      0 KiB |     60 MiB |   5218 GiB |   5218 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13219 MiB | 438504 GiB | 438504 GiB |
|       from large pool |  16640 KiB |  13181 MiB | 433285 GiB | 433285 GiB |
|       from small pool |      0 KiB |     60 MiB |   5218 GiB |   5218 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13213 MiB | 437736 GiB | 437736 GiB |
|       from large pool |  16640 KiB |  13175 MiB | 432528 GiB | 432528 GiB |
|       from small pool |      0 KiB |     60 MiB |   5207 GiB |   5207 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    882 MiB |  14482 MiB |  82438 MiB |  81556 MiB |
|       from large pool |    830 MiB |  14412 MiB |  82288 MiB |  81458 MiB |
|       from small pool |     52 MiB |     70 MiB |    150 MiB |     98 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1236 MiB | 306966 GiB | 306966 GiB |
|       from large pool |  24320 KiB |   1229 MiB | 301713 GiB | 301713 GiB |
|       from small pool |      0 KiB |     44 MiB |   5252 GiB |   5252 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    2598    |   77545 K  |   77545 K  |
|       from large pool |       2    |    1413    |   39426 K  |   39426 K  |
|       from small pool |       0    |    1419    |   38119 K  |   38119 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    2598    |   77545 K  |   77545 K  |
|       from large pool |       2    |    1413    |   39426 K  |   39426 K  |
|       from small pool |       0    |    1419    |   38119 K  |   38119 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      63    |     637    |    3500    |    3437    |
|       from large pool |      37    |     602    |    3425    |    3388    |
|       from small pool |      26    |      35    |      75    |      49    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |     652    |   52867 K  |   52867 K  |
|       from large pool |       4    |     605    |   30360 K  |   30360 K  |
|       from small pool |       0    |     237    |   22507 K  |   22507 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'888c1ef2'
model name: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_09_11_15_seed_6_23065778

 Experiment start at: 2024-07-26 09:11:15.554768
before training, model accuracy: 0.5247747898101807
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.93815106, 'precision': 0.9425627, 'recall': 0.938794, 'specificity': 0.938794, 'f1': 0.9380501, 'auroc': 0.9908925, 'binary_precision': 0.98994976, 'binary_recall': 0.88681674, 'binary_specificity': 0.99077123, 'binary_f1_score': 0.93554956}
confusion matrix:
      0     1
0  1503    14
1   176  1379
---- Validation: 
scalar performance:
{'acc': 0.8163424, 'precision': 0.82224256, 'recall': 0.8158646, 'specificity': 0.8158646, 'f1': 0.81533307, 'auroc': 0.90142107, 'binary_precision': 0.86413044, 'binary_recall': 0.7476489, 'binary_specificity': 0.88408035, 'binary_f1_score': 0.8016807}
confusion matrix:
     0    1
0  572   75
1  161  477
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8581081, 'precision': 0.86723614, 'recall': 0.8581081, 'specificity': 0.8581081, 'f1': 0.8572209, 'auroc': 0.91240567, 'binary_precision': 0.9251337, 'binary_recall': 0.7792793, 'binary_specificity': 0.9369369, 'binary_f1_score': 0.8459658}
confusion matrix:
     0    1
0  208   14
1   49  173
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-26 09:12:46.111173,epoch time: 0:01:30.556405,used: 0:01:30.556405,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_09_11_15_seed_6_23065778
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.95963544, 'precision': 0.9598291, 'recall': 0.9597667, 'specificity': 0.9597667, 'f1': 0.95963514, 'auroc': 0.9937814, 'binary_precision': 0.9722222, 'binary_recall': 0.94716495, 'binary_specificity': 0.9723684, 'binary_f1_score': 0.95953006}
confusion matrix:
      0     1
0  1478    42
1    82  1470
---- Validation: 
scalar performance:
{'acc': 0.8389105, 'precision': 0.84051275, 'recall': 0.8386682, 'specificity': 0.8386682, 'f1': 0.8386463, 'auroc': 0.9009923, 'binary_precision': 0.8621849, 'binary_recall': 0.80407524, 'binary_specificity': 0.8732612, 'binary_f1_score': 0.8321168}
confusion matrix:
     0    1
0  565   82
1  125  513
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8423423, 'precision': 0.8451436, 'recall': 0.8423424, 'specificity': 0.8423424, 'f1': 0.8420218, 'auroc': 0.93040335, 'binary_precision': 0.87623763, 'binary_recall': 0.7972973, 'binary_specificity': 0.8873874, 'binary_f1_score': 0.8349057}
confusion matrix:
     0    1
0  197   25
1   45  177
better model found
persisted
after epoch: 2,now: 2024-07-26 09:14:12.274799,epoch time: 0:01:26.163626,used: 0:02:56.720031,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_09_11_15_seed_6_23065778
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.97786456, 'precision': 0.97788477, 'recall': 0.97796255, 'specificity': 0.97796255, 'f1': 0.97786397, 'auroc': 0.9975035, 'binary_precision': 0.9856397, 'binary_recall': 0.970437, 'binary_specificity': 0.9854881, 'binary_f1_score': 0.97797924}
confusion matrix:
      0     1
0  1494    22
1    46  1510
---- Validation: 
scalar performance:
{'acc': 0.8163424, 'precision': 0.81637084, 'recall': 0.81637704, 'specificity': 0.81637704, 'f1': 0.8163423, 'auroc': 0.8992044, 'binary_precision': 0.8111455, 'binary_recall': 0.8213166, 'binary_specificity': 0.8114374, 'binary_f1_score': 0.81619936}
confusion matrix:
     0    1
0  525  122
1  114  524
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8198198, 'precision': 0.8224368, 'recall': 0.8198198, 'specificity': 0.8198198, 'f1': 0.8194535, 'auroc': 0.9177218, 'binary_precision': 0.7933884, 'binary_recall': 0.8648649, 'binary_specificity': 0.7747748, 'binary_f1_score': 0.82758623}
confusion matrix:
     0    1
0  172   50
1   30  192
early stop counter: 1
val acc:0.8163424134254456, best validation acc: 0.8389105200767517, corresponding to test acc:                         0.8423423171043396 / 0.8581081032752991
after epoch: 3,now: 2024-07-26 09:15:38.435668,epoch time: 0:01:26.160869,used: 0:04:22.880900,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_09_11_15_seed_6_23065778
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9635417, 'precision': 0.96478665, 'recall': 0.9639355, 'specificity': 0.9639355, 'f1': 0.9635328, 'auroc': 0.9956237, 'binary_precision': 0.9925017, 'binary_recall': 0.93513167, 'binary_specificity': 0.99273926, 'binary_f1_score': 0.962963}
confusion matrix:
      0     1
0  1504    11
1   101  1456
---- Validation: 
scalar performance:
{'acc': 0.81167316, 'precision': 0.83148384, 'recall': 0.81081355, 'specificity': 0.81081355, 'f1': 0.80851597, 'auroc': 0.91254735, 'binary_precision': 0.91078836, 'binary_recall': 0.68808776, 'binary_specificity': 0.9335394, 'binary_f1_score': 0.7839285}
confusion matrix:
     0    1
0  604   43
1  199  439
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8423423, 'precision': 0.8656063, 'recall': 0.8423424, 'specificity': 0.8423424, 'f1': 0.8397938, 'auroc': 0.91281146, 'binary_precision': 0.9578313, 'binary_recall': 0.7162162, 'binary_specificity': 0.9684685, 'binary_f1_score': 0.81958765}
confusion matrix:
     0    1
0  215    7
1   63  159
early stop counter: 2
val acc:0.8116731643676758, best validation acc: 0.8389105200767517, corresponding to test acc:                         0.8423423171043396 / 0.8581081032752991
after epoch: 4,now: 2024-07-26 09:17:04.921642,epoch time: 0:01:26.485974,used: 0:05:49.366874,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_09_11_15_seed_6_23065778
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9817708, 'precision': 0.9818084, 'recall': 0.98173976, 'specificity': 0.98173976, 'f1': 0.9817674, 'auroc': 0.99853504, 'binary_precision': 0.9795003, 'binary_recall': 0.98454607, 'binary_specificity': 0.9789335, 'binary_f1_score': 0.9820167}
confusion matrix:
      0     1
0  1487    32
1    24  1529
---- Validation: 
scalar performance:
{'acc': 0.82801557, 'precision': 0.8280355, 'recall': 0.8279799, 'specificity': 0.8279799, 'f1': 0.8279952, 'auroc': 0.89287424, 'binary_precision': 0.8293839, 'binary_recall': 0.822884, 'binary_specificity': 0.83307576, 'binary_f1_score': 0.8261212}
confusion matrix:
     0    1
0  539  108
1  113  525
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8558559, 'precision': 0.8558848, 'recall': 0.8558559, 'specificity': 0.8558559, 'f1': 0.85585296, 'auroc': 0.92900336, 'binary_precision': 0.8590909, 'binary_recall': 0.8513514, 'binary_specificity': 0.8603604, 'binary_f1_score': 0.8552037}
confusion matrix:
     0    1
0  191   31
1   33  189
early stop counter: 3
val acc:0.8280155658721924, best validation acc: 0.8389105200767517, corresponding to test acc:                         0.8423423171043396 / 0.8581081032752991
after epoch: 5,now: 2024-07-26 09:18:31.270312,epoch time: 0:01:26.348670,used: 0:07:15.715544,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_09_11_15_seed_6_23065778
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9684245, 'precision': 0.96952605, 'recall': 0.9681792, 'specificity': 0.9681792, 'f1': 0.96839035, 'auroc': 0.99811363, 'binary_precision': 0.9493827, 'binary_recall': 0.99034125, 'binary_specificity': 0.94601715, 'binary_f1_score': 0.96942955}
confusion matrix:
      0     1
0  1437    82
1    15  1538
---- Validation: 
scalar performance:
{'acc': 0.8085603, 'precision': 0.81195354, 'recall': 0.8089216, 'specificity': 0.8089216, 'f1': 0.8081559, 'auroc': 0.8861202, 'binary_precision': 0.7776204, 'binary_recall': 0.8605016, 'binary_specificity': 0.75734156, 'binary_f1_score': 0.81696427}
confusion matrix:
     0    1
0  490  157
1   89  549
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7815315, 'precision': 0.7816744, 'recall': 0.7815316, 'specificity': 0.7815316, 'f1': 0.7815038, 'auroc': 0.88742805, 'binary_precision': 0.7753304, 'binary_recall': 0.7927928, 'binary_specificity': 0.7702703, 'binary_f1_score': 0.78396434}
confusion matrix:
     0    1
0  171   51
1   46  176
early stop counter: 4
val acc:0.808560311794281, best validation acc: 0.8389105200767517, corresponding to test acc:                         0.8423423171043396 / 0.8581081032752991
after epoch: 6,now: 2024-07-26 09:19:57.426898,epoch time: 0:01:26.156586,used: 0:08:41.872130,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_09_11_15_seed_6_23065778
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.97591144, 'precision': 0.976331, 'recall': 0.9757632, 'specificity': 0.9757632, 'f1': 0.97589743, 'auroc': 0.9981475, 'binary_precision': 0.96482414, 'binary_recall': 0.98841697, 'binary_specificity': 0.9631094, 'binary_f1_score': 0.9764781}
confusion matrix:
      0     1
0  1462    56
1    18  1536
---- Validation: 
scalar performance:
{'acc': 0.82801557, 'precision': 0.8280562, 'recall': 0.8280562, 'specificity': 0.8280562, 'f1': 0.82801557, 'auroc': 0.89038694, 'binary_precision': 0.82225657, 'binary_recall': 0.8338558, 'binary_specificity': 0.82225657, 'binary_f1_score': 0.82801557}
confusion matrix:
     0    1
0  532  115
1  106  532
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8333333, 'precision': 0.83357704, 'recall': 0.8333333, 'specificity': 0.8333333, 'f1': 0.8333029, 'auroc': 0.89523983, 'binary_precision': 0.8425926, 'binary_recall': 0.8198198, 'binary_specificity': 0.8468468, 'binary_f1_score': 0.8310502}
confusion matrix:
     0    1
0  188   34
1   40  182
early stop counter: 5
val acc:0.8280155658721924, best validation acc: 0.8389105200767517, corresponding to test acc:                         0.8423423171043396 / 0.8581081032752991
after epoch: 7,now: 2024-07-26 09:21:23.566926,epoch time: 0:01:26.140028,used: 0:10:08.012158,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_09_11_15_seed_6_23065778
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9869792, 'precision': 0.9869977, 'recall': 0.98706126, 'specificity': 0.98706126, 'f1': 0.9869789, 'auroc': 0.9991416, 'binary_precision': 0.9941253, 'binary_recall': 0.98005146, 'binary_specificity': 0.9940711, 'binary_f1_score': 0.9870382}
confusion matrix:
      0     1
0  1509     9
1    31  1523
---- Validation: 
scalar performance:
{'acc': 0.73463035, 'precision': 0.7875173, 'recall': 0.73311836, 'specificity': 0.73311836, 'f1': 0.7210024, 'auroc': 0.89131176, 'binary_precision': 0.90909094, 'binary_recall': 0.51724136, 'binary_specificity': 0.94899535, 'binary_f1_score': 0.6593407}
confusion matrix:
     0    1
0  614   33
1  308  330
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8220721, 'precision': 0.84480286, 'recall': 0.8220721, 'specificity': 0.8220721, 'f1': 0.8190905, 'auroc': 0.914455, 'binary_precision': 0.93333334, 'binary_recall': 0.6936937, 'binary_specificity': 0.9504505, 'binary_f1_score': 0.79586565}
confusion matrix:
     0    1
0  211   11
1   68  154
early stop counter: 6
val acc:0.7346303462982178, best validation acc: 0.8389105200767517, corresponding to test acc:                         0.8423423171043396 / 0.8581081032752991
after epoch: 8,now: 2024-07-26 09:22:49.870552,epoch time: 0:01:26.303626,used: 0:11:34.315784,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_09_11_15_seed_6_23065778
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.98046875, 'precision': 0.98060703, 'recall': 0.9804033, 'specificity': 0.9804033, 'f1': 0.98046356, 'auroc': 0.99872744, 'binary_precision': 0.9745385, 'binary_recall': 0.9871051, 'binary_specificity': 0.97370154, 'binary_f1_score': 0.9807815}
confusion matrix:
      0     1
0  1481    40
1    20  1531
---- Validation: 
scalar performance:
{'acc': 0.81945527, 'precision': 0.8200971, 'recall': 0.81929374, 'specificity': 0.81929374, 'f1': 0.8193054, 'auroc': 0.88907576, 'binary_precision': 0.83278686, 'binary_recall': 0.79623824, 'binary_specificity': 0.8423493, 'binary_f1_score': 0.81410253}
confusion matrix:
     0    1
0  545  102
1  130  508
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8198198, 'precision': 0.8202357, 'recall': 0.8198198, 'specificity': 0.8198198, 'f1': 0.8197613, 'auroc': 0.9058721, 'binary_precision': 0.8086957, 'binary_recall': 0.8378378, 'binary_specificity': 0.8018018, 'binary_f1_score': 0.82300884}
confusion matrix:
     0    1
0  178   44
1   36  186
early stop counter: 7
val acc:0.8194552659988403, best validation acc: 0.8389105200767517, corresponding to test acc:                         0.8423423171043396 / 0.8581081032752991
after epoch: 9,now: 2024-07-26 09:24:16.248657,epoch time: 0:01:26.378105,used: 0:13:00.693889,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_09_11_15_seed_6_23065778
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9889323, 'precision': 0.98904526, 'recall': 0.98886615, 'specificity': 0.98886615, 'f1': 0.9889289, 'auroc': 0.99930096, 'binary_precision': 0.9840866, 'binary_recall': 0.9942122, 'binary_specificity': 0.9835201, 'binary_f1_score': 0.98912346}
confusion matrix:
      0     1
0  1492    25
1     9  1546
---- Validation: 
scalar performance:
{'acc': 0.7945525, 'precision': 0.8089745, 'recall': 0.7937902, 'specificity': 0.7937902, 'f1': 0.7918283, 'auroc': 0.8689805, 'binary_precision': 0.874, 'binary_recall': 0.684953, 'binary_specificity': 0.9026275, 'binary_f1_score': 0.768014}
confusion matrix:
     0    1
0  584   63
1  201  437
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8175676, 'precision': 0.8183491, 'recall': 0.8175676, 'specificity': 0.8175676, 'f1': 0.81745553, 'auroc': 0.9058112, 'binary_precision': 0.8025751, 'binary_recall': 0.8423423, 'binary_specificity': 0.7927928, 'binary_f1_score': 0.821978}
confusion matrix:
     0    1
0  176   46
1   35  187
early stop counter: 8
val acc:0.7945525050163269, best validation acc: 0.8389105200767517, corresponding to test acc:                         0.8423423171043396 / 0.8581081032752991
after epoch: 10,now: 2024-07-26 09:25:42.813996,epoch time: 0:01:26.565339,used: 0:14:27.259228,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_09_11_15_seed_6_23065778
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.960612, 'precision': 0.96308726, 'recall': 0.9610682, 'specificity': 0.9610682, 'f1': 0.9605818, 'auroc': 0.99866736, 'binary_precision': 1.0, 'binary_recall': 0.9221364, 'binary_specificity': 1.0, 'binary_f1_score': 0.95949113}
confusion matrix:
      0     1
0  1518     0
1   121  1433
---- Validation: 
scalar performance:
{'acc': 0.6996109, 'precision': 0.7992339, 'recall': 0.6975794, 'specificity': 0.6975794, 'f1': 0.67099017, 'auroc': 0.89207304, 'binary_precision': 0.9701493, 'binary_recall': 0.4075235, 'binary_specificity': 0.98763525, 'binary_f1_score': 0.5739515}
confusion matrix:
     0    1
0  639    8
1  378  260
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6599099, 'precision': 0.79758716, 'recall': 0.6599099, 'specificity': 0.6599099, 'f1': 0.61543, 'auroc': 0.90205747, 'binary_precision': 1.0, 'binary_recall': 0.3198198, 'binary_specificity': 1.0, 'binary_f1_score': 0.4846416}
confusion matrix:
     0   1
0  222   0
1  151  71
early stop counter: 9
val acc:0.6996108889579773, best validation acc: 0.8389105200767517, corresponding to test acc:                         0.8423423171043396 / 0.8581081032752991
after epoch: 11,now: 2024-07-26 09:27:09.584425,epoch time: 0:01:26.770429,used: 0:15:54.029657,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_09_11_15_seed_6_23065778
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.98339844, 'precision': 0.98366094, 'recall': 0.9832983, 'specificity': 0.9832983, 'f1': 0.9833919, 'auroc': 0.99911404, 'binary_precision': 0.97469956, 'binary_recall': 0.99291235, 'binary_specificity': 0.9736842, 'binary_f1_score': 0.9837217}
confusion matrix:
      0     1
0  1480    40
1    11  1541
---- Validation: 
scalar performance:
{'acc': 0.81867707, 'precision': 0.83978975, 'recall': 0.8178015, 'specificity': 0.8178015, 'f1': 0.81552386, 'auroc': 0.9090183, 'binary_precision': 0.9227557, 'binary_recall': 0.69279, 'binary_specificity': 0.942813, 'binary_f1_score': 0.7914055}
confusion matrix:
     0    1
0  610   37
1  196  442
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8220721, 'precision': 0.85651237, 'recall': 0.8220721, 'specificity': 0.8220721, 'f1': 0.8176686, 'auroc': 0.91853344, 'binary_precision': 0.96732026, 'binary_recall': 0.6666667, 'binary_specificity': 0.9774775, 'binary_f1_score': 0.78933334}
confusion matrix:
     0    1
0  217    5
1   74  148
early stop counter: 10
val acc:0.8186770677566528, best validation acc: 0.8389105200767517, corresponding to test acc:                         0.8423423171043396 / 0.8581081032752991
after epoch: 12,now: 2024-07-26 09:28:35.994956,epoch time: 0:01:26.410531,used: 0:17:20.440188,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_09_11_15_seed_6_23065778
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9895833, 'precision': 0.98971844, 'recall': 0.98952746, 'specificity': 0.98952746, 'f1': 0.989581, 'auroc': 0.99946463, 'binary_precision': 0.98342896, 'binary_recall': 0.99612653, 'binary_specificity': 0.98292845, 'binary_f1_score': 0.98973703}
confusion matrix:
      0     1
0  1497    26
1     6  1543
---- Validation: 
scalar performance:
{'acc': 0.81945527, 'precision': 0.829289, 'recall': 0.8188468, 'specificity': 0.8188468, 'f1': 0.8178935, 'auroc': 0.900062, 'binary_precision': 0.8844697, 'binary_recall': 0.7319749, 'binary_specificity': 0.9057187, 'binary_f1_score': 0.80102915}
confusion matrix:
     0    1
0  586   61
1  171  467
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8761261, 'precision': 0.88360614, 'recall': 0.8761261, 'specificity': 0.8761261, 'f1': 0.8755193, 'auroc': 0.94276035, 'binary_precision': 0.9371728, 'binary_recall': 0.8063063, 'binary_specificity': 0.9459459, 'binary_f1_score': 0.86682814}
confusion matrix:
     0    1
0  210   12
1   43  179
new oracle model saved
early stop counter: 11
val acc:0.8194552659988403, best validation acc: 0.8389105200767517, corresponding to test acc:                         0.8423423171043396 / 0.8761261105537415
after epoch: 13,now: 2024-07-26 09:30:02.584169,epoch time: 0:01:26.589213,used: 0:18:47.029401,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_09_11_15_seed_6_23065778
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9899089, 'precision': 0.9899113, 'recall': 0.9899037, 'specificity': 0.9899037, 'f1': 0.9899074, 'auroc': 0.9995189, 'binary_precision': 0.9897106, 'binary_recall': 0.9903475, 'binary_specificity': 0.9894598, 'binary_f1_score': 0.9900289}
confusion matrix:
      0     1
0  1502    16
1    15  1539
---- Validation: 
scalar performance:
{'acc': 0.78287935, 'precision': 0.82529956, 'recall': 0.7816096, 'specificity': 0.7816096, 'f1': 0.7750318, 'auroc': 0.89275557, 'binary_precision': 0.94103193, 'binary_recall': 0.6003135, 'binary_specificity': 0.9629057, 'binary_f1_score': 0.7330144}
confusion matrix:
     0    1
0  623   24
1  255  383
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8558559, 'precision': 0.878235, 'recall': 0.8558558, 'specificity': 0.8558558, 'f1': 0.8536917, 'auroc': 0.91877687, 'binary_precision': 0.9702381, 'binary_recall': 0.7342342, 'binary_specificity': 0.9774775, 'binary_f1_score': 0.83589745}
confusion matrix:
     0    1
0  217    5
1   59  163
early stop counter: 12
val acc:0.7828793525695801, best validation acc: 0.8389105200767517, corresponding to test acc:                         0.8423423171043396 / 0.8761261105537415
after epoch: 14,now: 2024-07-26 09:31:29.044821,epoch time: 0:01:26.460652,used: 0:20:13.490053,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_09_11_15_seed_6_23065778
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.99316406, 'precision': 0.99319804, 'recall': 0.99313796, 'specificity': 0.99313796, 'f1': 0.9931629, 'auroc': 0.99981177, 'binary_precision': 0.9910256, 'binary_recall': 0.9954926, 'binary_specificity': 0.9907834, 'binary_f1_score': 0.9932541}
confusion matrix:
      0     1
0  1505    14
1     7  1546
---- Validation: 
scalar performance:
{'acc': 0.83579767, 'precision': 0.83939004, 'recall': 0.8354353, 'specificity': 0.8354353, 'f1': 0.83525133, 'auroc': 0.8991051, 'binary_precision': 0.8726004, 'binary_recall': 0.78369904, 'binary_specificity': 0.88717157, 'binary_f1_score': 0.8257639}
confusion matrix:
     0    1
0  574   73
1  138  500
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8581081, 'precision': 0.86075056, 'recall': 0.8581081, 'specificity': 0.8581081, 'f1': 0.8578478, 'auroc': 0.9184725, 'binary_precision': 0.89162564, 'binary_recall': 0.8153153, 'binary_specificity': 0.9009009, 'binary_f1_score': 0.85176474}
confusion matrix:
     0    1
0  200   22
1   41  181
early stop counter: 13
val acc:0.8357976675033569, best validation acc: 0.8389105200767517, corresponding to test acc:                         0.8423423171043396 / 0.8761261105537415
after epoch: 15,now: 2024-07-26 09:32:55.230619,epoch time: 0:01:26.185798,used: 0:21:39.675851,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_09_11_15_seed_6_23065778
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9899089, 'precision': 0.9899713, 'recall': 0.9899993, 'specificity': 0.9899993, 'f1': 0.9899088, 'auroc': 0.9995803, 'binary_precision': 0.9986885, 'binary_recall': 0.9813144, 'binary_specificity': 0.9986842, 'binary_f1_score': 0.98992527}
confusion matrix:
      0     1
0  1518     2
1    29  1523
---- Validation: 
scalar performance:
{'acc': 0.74319065, 'precision': 0.81149596, 'recall': 0.7415428, 'specificity': 0.7415428, 'f1': 0.7274294, 'auroc': 0.906245, 'binary_precision': 0.9556213, 'binary_recall': 0.5062696, 'binary_specificity': 0.97681606, 'binary_f1_score': 0.6618852}
confusion matrix:
     0    1
0  632   15
1  315  323
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6891892, 'precision': 0.80833334, 'recall': 0.6891892, 'specificity': 0.6891892, 'f1': 0.6559531, 'auroc': 0.9223683, 'binary_precision': 1.0, 'binary_recall': 0.3783784, 'binary_specificity': 1.0, 'binary_f1_score': 0.54901963}
confusion matrix:
     0   1
0  222   0
1  138  84
early stop counter: 14
val acc:0.7431906461715698, best validation acc: 0.8389105200767517, corresponding to test acc:                         0.8423423171043396 / 0.8761261105537415
after epoch: 16,now: 2024-07-26 09:34:21.618307,epoch time: 0:01:26.387688,used: 0:23:06.063539,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_09_11_15_seed_6_23065778
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.99348956, 'precision': 0.9935448, 'recall': 0.9934527, 'specificity': 0.9934527, 'f1': 0.9934882, 'auroc': 0.99978507, 'binary_precision': 0.99040306, 'binary_recall': 0.9967804, 'binary_specificity': 0.99012506, 'binary_f1_score': 0.9935815}
confusion matrix:
      0     1
0  1504    15
1     5  1548
---- Validation: 
scalar performance:
{'acc': 0.8093385, 'precision': 0.8332461, 'recall': 0.80839705, 'specificity': 0.80839705, 'f1': 0.80552256, 'auroc': 0.8857132, 'binary_precision': 0.9207709, 'binary_recall': 0.6739812, 'binary_specificity': 0.942813, 'binary_f1_score': 0.77828056}
confusion matrix:
     0    1
0  610   37
1  208  430
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8040541, 'precision': 0.83656764, 'recall': 0.804054, 'specificity': 0.804054, 'f1': 0.79920465, 'auroc': 0.91147226, 'binary_precision': 0.9411765, 'binary_recall': 0.6486486, 'binary_specificity': 0.9594595, 'binary_f1_score': 0.76799995}
confusion matrix:
     0    1
0  213    9
1   78  144
early stop counter: 15
val acc:0.8093385100364685, best validation acc: 0.8389105200767517, corresponding to test acc:                         0.8423423171043396 / 0.8761261105537415
after epoch: 17,now: 2024-07-26 09:35:48.109122,epoch time: 0:01:26.490815,used: 0:24:32.554354,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_09_11_15_seed_6_23065778
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9941406, 'precision': 0.9941292, 'recall': 0.99415433, 'specificity': 0.99415433, 'f1': 0.99414, 'auroc': 0.99981225, 'binary_precision': 0.99548095, 'binary_recall': 0.99291694, 'binary_specificity': 0.9953917, 'binary_f1_score': 0.9941973}
confusion matrix:
      0     1
0  1512     7
1    11  1542
---- Validation: 
scalar performance:
{'acc': 0.76653695, 'precision': 0.81011313, 'recall': 0.7652173, 'specificity': 0.7652173, 'f1': 0.75742877, 'auroc': 0.8807009, 'binary_precision': 0.92462313, 'binary_recall': 0.5768025, 'binary_specificity': 0.9536322, 'binary_f1_score': 0.71042466}
confusion matrix:
     0    1
0  617   30
1  270  368
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8288288, 'precision': 0.8495083, 'recall': 0.8288288, 'specificity': 0.8288288, 'f1': 0.8262589, 'auroc': 0.90497935, 'binary_precision': 0.9345238, 'binary_recall': 0.7072072, 'binary_specificity': 0.9504505, 'binary_f1_score': 0.8051282}
confusion matrix:
     0    1
0  211   11
1   65  157
early stop counter: 16
val acc:0.7665369510650635, best validation acc: 0.8389105200767517, corresponding to test acc:                         0.8423423171043396 / 0.8761261105537415
after epoch: 18,now: 2024-07-26 09:37:14.487513,epoch time: 0:01:26.378391,used: 0:25:58.932745,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_09_11_15_seed_6_23065778
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.98828125, 'precision': 0.9883459, 'recall': 0.9883807, 'specificity': 0.9883807, 'f1': 0.9882812, 'auroc': 0.99961424, 'binary_precision': 0.99737704, 'binary_recall': 0.97939473, 'binary_specificity': 0.99736667, 'binary_f1_score': 0.9883041}
confusion matrix:
      0     1
0  1515     4
1    32  1521
---- Validation: 
scalar performance:
{'acc': 0.6233463, 'precision': 0.76301765, 'recall': 0.6207769, 'specificity': 0.6207769, 'f1': 0.5631511, 'auroc': 0.84675354, 'binary_precision': 0.9529412, 'binary_recall': 0.2539185, 'binary_specificity': 0.98763525, 'binary_f1_score': 0.4009901}
confusion matrix:
     0    1
0  639    8
1  476  162
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6081081, 'precision': 0.780303, 'recall': 0.6081081, 'specificity': 0.6081081, 'f1': 0.5370011, 'auroc': 0.9156521, 'binary_precision': 1.0, 'binary_recall': 0.21621622, 'binary_specificity': 1.0, 'binary_f1_score': 0.35555556}
confusion matrix:
     0   1
0  222   0
1  174  48
early stop counter: 17
val acc:0.6233463287353516, best validation acc: 0.8389105200767517, corresponding to test acc:                         0.8423423171043396 / 0.8761261105537415
after epoch: 19,now: 2024-07-26 09:38:41.041190,epoch time: 0:01:26.553677,used: 0:27:25.486422,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_09_11_15_seed_6_23065778
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9921875, 'precision': 0.9923022, 'recall': 0.9921219, 'specificity': 0.9921219, 'f1': 0.9921851, 'auroc': 0.9999, 'binary_precision': 0.9872693, 'binary_recall': 0.99742764, 'binary_specificity': 0.9868161, 'binary_f1_score': 0.99232244}
confusion matrix:
      0     1
0  1497    20
1     4  1551
---- Validation: 
scalar performance:
{'acc': 0.86070037, 'precision': 0.8627503, 'recall': 0.8604374, 'specificity': 0.8604374, 'f1': 0.8604353, 'auroc': 0.90704626, 'binary_precision': 0.88832486, 'binary_recall': 0.822884, 'binary_specificity': 0.8979907, 'binary_f1_score': 0.85435313}
confusion matrix:
     0    1
0  581   66
1  113  525
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8558559, 'precision': 0.8582108, 'recall': 0.8558558, 'specificity': 0.8558558, 'f1': 0.85561854, 'auroc': 0.91693044, 'binary_precision': 0.8872549, 'binary_recall': 0.8153153, 'binary_specificity': 0.8963964, 'binary_f1_score': 0.84976524}
confusion matrix:
     0    1
0  199   23
1   41  181
better model found
persisted
after epoch: 20,now: 2024-07-26 09:40:07.559372,epoch time: 0:01:26.518182,used: 0:28:52.004604,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_09_11_15_seed_6_23065778
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9742839, 'precision': 0.97516, 'recall': 0.97449833, 'specificity': 0.97449833, 'f1': 0.97427833, 'auroc': 0.99815357, 'binary_precision': 0.99796885, 'binary_recall': 0.9509677, 'binary_specificity': 0.99802893, 'binary_f1_score': 0.97390157}
confusion matrix:
      0     1
0  1519     3
1    76  1474
---- Validation: 
scalar performance:
{'acc': 0.7003891, 'precision': 0.7792585, 'recall': 0.6985157, 'specificity': 0.6985157, 'f1': 0.67638063, 'auroc': 0.878047, 'binary_precision': 0.9259259, 'binary_recall': 0.43103448, 'binary_specificity': 0.9659969, 'binary_f1_score': 0.58823526}
confusion matrix:
     0    1
0  625   22
1  363  275
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5630631, 'precision': 0.7668269, 'recall': 0.5630631, 'specificity': 0.5630631, 'f1': 0.45996237, 'auroc': 0.88349164, 'binary_precision': 1.0, 'binary_recall': 0.12612613, 'binary_specificity': 1.0, 'binary_f1_score': 0.22399999}
confusion matrix:
     0   1
0  222   0
1  194  28
early stop counter: 1
val acc:0.7003890872001648, best validation acc: 0.8607003688812256, corresponding to test acc:                         0.8558558821678162 / 0.8761261105537415
after epoch: 21,now: 2024-07-26 09:41:33.866961,epoch time: 0:01:26.307589,used: 0:30:18.312193,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_09_11_15_seed_6_23065778
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.99316406, 'precision': 0.9931546, 'recall': 0.9931741, 'specificity': 0.9931741, 'f1': 0.99316335, 'auroc': 0.9997991, 'binary_precision': 0.99419355, 'binary_recall': 0.99227303, 'binary_specificity': 0.99407506, 'binary_f1_score': 0.99323237}
confusion matrix:
      0     1
0  1510     9
1    12  1541
---- Validation: 
scalar performance:
{'acc': 0.82879376, 'precision': 0.83819485, 'recall': 0.8282076, 'specificity': 0.8282076, 'f1': 0.8274115, 'auroc': 0.9185195, 'binary_precision': 0.89285713, 'binary_recall': 0.7445141, 'binary_specificity': 0.91190106, 'binary_f1_score': 0.81196576}
confusion matrix:
     0    1
0  590   57
1  163  475
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8265766, 'precision': 0.8593035, 'recall': 0.8265766, 'specificity': 0.8265766, 'f1': 0.8225355, 'auroc': 0.9302816, 'binary_precision': 0.9677419, 'binary_recall': 0.6756757, 'binary_specificity': 0.9774775, 'binary_f1_score': 0.795756}
confusion matrix:
     0    1
0  217    5
1   72  150
early stop counter: 2
val acc:0.8287937641143799, best validation acc: 0.8607003688812256, corresponding to test acc:                         0.8558558821678162 / 0.8761261105537415
after epoch: 22,now: 2024-07-26 09:43:00.297431,epoch time: 0:01:26.430470,used: 0:31:44.742663,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_09_11_15_seed_6_23065778
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.9847005, 'precision': 0.98500323, 'recall': 0.9848583, 'specificity': 0.9848583, 'f1': 0.9847001, 'auroc': 0.99984825, 'binary_precision': 1.0, 'binary_recall': 0.9697165, 'binary_specificity': 1.0, 'binary_f1_score': 0.9846254}
confusion matrix:
      0     1
0  1520     0
1    47  1505
---- Validation: 
scalar performance:
{'acc': 0.7315175, 'precision': 0.80043954, 'recall': 0.729831, 'specificity': 0.729831, 'f1': 0.71423626, 'auroc': 0.9188901, 'binary_precision': 0.94259816, 'binary_recall': 0.48902822, 'binary_specificity': 0.9706337, 'binary_f1_score': 0.64396286}
confusion matrix:
     0    1
0  628   19
1  326  312
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5810811, 'precision': 0.77205884, 'recall': 0.5810811, 'specificity': 0.5810811, 'f1': 0.49191582, 'auroc': 0.9180465, 'binary_precision': 1.0, 'binary_recall': 0.16216215, 'binary_specificity': 1.0, 'binary_f1_score': 0.27906975}
confusion matrix:
     0   1
0  222   0
1  186  36
early stop counter: 3
val acc:0.731517493724823, best validation acc: 0.8607003688812256, corresponding to test acc:                         0.8558558821678162 / 0.8761261105537415
after epoch: 23,now: 2024-07-26 09:44:26.418288,epoch time: 0:01:26.120857,used: 0:33:10.863520,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_09_11_15_seed_6_23065778
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9944661, 'precision': 0.9944544, 'recall': 0.99450284, 'specificity': 0.99450284, 'f1': 0.9944659, 'auroc': 0.9998894, 'binary_precision': 0.9980532, 'binary_recall': 0.9909794, 'binary_specificity': 0.9980263, 'binary_f1_score': 0.99450374}
confusion matrix:
      0     1
0  1517     3
1    14  1538
---- Validation: 
scalar performance:
{'acc': 0.7782101, 'precision': 0.82074213, 'recall': 0.77692926, 'specificity': 0.77692926, 'f1': 0.7700546, 'auroc': 0.9175886, 'binary_precision': 0.93580246, 'binary_recall': 0.5940439, 'binary_specificity': 0.95981455, 'binary_f1_score': 0.7267497}
confusion matrix:
     0    1
0  621   26
1  259  379
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7184685, 'precision': 0.81079876, 'recall': 0.7184685, 'specificity': 0.7184685, 'f1': 0.6958821, 'auroc': 0.91593623, 'binary_precision': 0.980198, 'binary_recall': 0.44594595, 'binary_specificity': 0.990991, 'binary_f1_score': 0.6130031}
confusion matrix:
     0   1
0  220   2
1  123  99
early stop counter: 4
val acc:0.7782101035118103, best validation acc: 0.8607003688812256, corresponding to test acc:                         0.8558558821678162 / 0.8761261105537415
after epoch: 24,now: 2024-07-26 09:45:52.852804,epoch time: 0:01:26.434516,used: 0:34:37.298036,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_09_11_15_seed_6_23065778
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.9947917, 'precision': 0.9947761, 'recall': 0.9948138, 'specificity': 0.9948138, 'f1': 0.99479115, 'auroc': 0.99991226, 'binary_precision': 0.99677, 'binary_recall': 0.9929215, 'binary_specificity': 0.9967062, 'binary_f1_score': 0.99484205}
confusion matrix:
      0     1
0  1513     5
1    11  1543
---- Validation: 
scalar performance:
{'acc': 0.785214, 'precision': 0.82348526, 'recall': 0.78400433, 'specificity': 0.78400433, 'f1': 0.7781689, 'auroc': 0.90962446, 'binary_precision': 0.93301433, 'binary_recall': 0.61128527, 'binary_specificity': 0.95672333, 'binary_f1_score': 0.7386363}
confusion matrix:
     0    1
0  619   28
1  248  390
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7342342, 'precision': 0.8222061, 'recall': 0.7342342, 'specificity': 0.7342342, 'f1': 0.7147648, 'auroc': 0.9249046, 'binary_precision': 0.990566, 'binary_recall': 0.47297296, 'binary_specificity': 0.9954955, 'binary_f1_score': 0.6402438}
confusion matrix:
     0    1
0  221    1
1  117  105
early stop counter: 5
val acc:0.7852140069007874, best validation acc: 0.8607003688812256, corresponding to test acc:                         0.8558558821678162 / 0.8761261105537415
after epoch: 25,now: 2024-07-26 09:47:19.011076,epoch time: 0:01:26.158272,used: 0:36:03.456308,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_09_11_15_seed_6_23065778
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.991862, 'precision': 0.99185705, 'recall': 0.99186474, 'specificity': 0.99186474, 'f1': 0.9918608, 'auroc': 0.9996159, 'binary_precision': 0.992278, 'binary_recall': 0.99163985, 'binary_specificity': 0.9920896, 'binary_f1_score': 0.9919588}
confusion matrix:
      0     1
0  1505    12
1    13  1542
---- Validation: 
scalar performance:
{'acc': 0.75642025, 'precision': 0.81976223, 'recall': 0.7548548, 'specificity': 0.7548548, 'f1': 0.74296534, 'auroc': 0.91519094, 'binary_precision': 0.96033996, 'binary_recall': 0.531348, 'binary_specificity': 0.97836167, 'binary_f1_score': 0.68415743}
confusion matrix:
     0    1
0  633   14
1  299  339
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5540541, 'precision': 0.74512327, 'recall': 0.5540541, 'specificity': 0.5540541, 'f1': 0.44611895, 'auroc': 0.9102955, 'binary_precision': 0.96153843, 'binary_recall': 0.11261261, 'binary_specificity': 0.9954955, 'binary_f1_score': 0.2016129}
confusion matrix:
     0   1
0  221   1
1  197  25
early stop counter: 6
val acc:0.7564202547073364, best validation acc: 0.8607003688812256, corresponding to test acc:                         0.8558558821678162 / 0.8761261105537415
after epoch: 26,now: 2024-07-26 09:48:45.475666,epoch time: 0:01:26.464590,used: 0:37:29.920898,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_09_11_15_seed_6_23065778
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.99316406, 'precision': 0.99329007, 'recall': 0.99309456, 'specificity': 0.99309456, 'f1': 0.9931619, 'auroc': 0.9999203, 'binary_precision': 0.9879135, 'binary_recall': 0.99871385, 'binary_specificity': 0.9874753, 'binary_f1_score': 0.99328434}
confusion matrix:
      0     1
0  1498    19
1     2  1553
---- Validation: 
scalar performance:
{'acc': 0.80389106, 'precision': 0.8201861, 'recall': 0.80309653, 'specificity': 0.80309653, 'f1': 0.8010708, 'auroc': 0.90049326, 'binary_precision': 0.89068824, 'binary_recall': 0.6896552, 'binary_specificity': 0.9165379, 'binary_f1_score': 0.7773851}
confusion matrix:
     0    1
0  593   54
1  198  440
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7567568, 'precision': 0.80209124, 'recall': 0.7567568, 'specificity': 0.7567568, 'f1': 0.7472752, 'auroc': 0.89688337, 'binary_precision': 0.9191176, 'binary_recall': 0.5630631, 'binary_specificity': 0.9504505, 'binary_f1_score': 0.698324}
confusion matrix:
     0    1
0  211   11
1   97  125
early stop counter: 7
val acc:0.8038910627365112, best validation acc: 0.8607003688812256, corresponding to test acc:                         0.8558558821678162 / 0.8761261105537415
after epoch: 27,now: 2024-07-26 09:50:11.671562,epoch time: 0:01:26.195896,used: 0:38:56.116794,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_09_11_15_seed_6_23065778
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.99283856, 'precision': 0.9929953, 'recall': 0.99276125, 'specificity': 0.99276125, 'f1': 0.9928362, 'auroc': 0.99993813, 'binary_precision': 0.9866582, 'binary_recall': 0.9993565, 'binary_specificity': 0.986166, 'binary_f1_score': 0.9929668}
confusion matrix:
      0     1
0  1497    21
1     1  1553
---- Validation: 
scalar performance:
{'acc': 0.8575876, 'precision': 0.8616769, 'recall': 0.8572154, 'specificity': 0.8572154, 'f1': 0.8570876, 'auroc': 0.92567396, 'binary_precision': 0.8984238, 'binary_recall': 0.80407524, 'binary_specificity': 0.9103555, 'binary_f1_score': 0.8486352}
confusion matrix:
     0    1
0  589   58
1  125  513
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8445946, 'precision': 0.8622422, 'recall': 0.8445946, 'specificity': 0.8445946, 'f1': 0.84267855, 'auroc': 0.92139435, 'binary_precision': 0.94219655, 'binary_recall': 0.7342342, 'binary_specificity': 0.954955, 'binary_f1_score': 0.8253165}
confusion matrix:
     0    1
0  212   10
1   59  163
early stop counter: 8
val acc:0.8575875759124756, best validation acc: 0.8607003688812256, corresponding to test acc:                         0.8558558821678162 / 0.8761261105537415
after epoch: 28,now: 2024-07-26 09:51:38.041989,epoch time: 0:01:26.370427,used: 0:40:22.487221,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_09_11_15_seed_6_23065778
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9899089, 'precision': 0.99007607, 'recall': 0.98982733, 'specificity': 0.98982733, 'f1': 0.98990536, 'auroc': 0.99986815, 'binary_precision': 0.9834921, 'binary_recall': 0.9967825, 'binary_specificity': 0.9828722, 'binary_f1_score': 0.9900927}
confusion matrix:
      0     1
0  1492    26
1     5  1549
---- Validation: 
scalar performance:
{'acc': 0.82023346, 'precision': 0.82385445, 'recall': 0.81985945, 'specificity': 0.81985945, 'f1': 0.8196025, 'auroc': 0.90988064, 'binary_precision': 0.8563923, 'binary_recall': 0.7664577, 'binary_specificity': 0.8732612, 'binary_f1_score': 0.808933}
confusion matrix:
     0    1
0  565   82
1  149  489
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8490991, 'precision': 0.85604167, 'recall': 0.8490991, 'specificity': 0.8490991, 'f1': 0.8483598, 'auroc': 0.9230785, 'binary_precision': 0.90575916, 'binary_recall': 0.7792793, 'binary_specificity': 0.9189189, 'binary_f1_score': 0.83777237}
confusion matrix:
     0    1
0  204   18
1   49  173
early stop counter: 9
val acc:0.8202334642410278, best validation acc: 0.8607003688812256, corresponding to test acc:                         0.8558558821678162 / 0.8761261105537415
after epoch: 29,now: 2024-07-26 09:53:04.366446,epoch time: 0:01:26.324457,used: 0:41:48.811678,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_09_11_15_seed_6_23065778
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.99348956, 'precision': 0.99349296, 'recall': 0.9935398, 'specificity': 0.9935398, 'f1': 0.9934894, 'auroc': 0.99991345, 'binary_precision': 0.99869704, 'binary_recall': 0.98839456, 'binary_specificity': 0.99868506, 'binary_f1_score': 0.9935191}
confusion matrix:
      0     1
0  1519     2
1    18  1533
---- Validation: 
scalar performance:
{'acc': 0.7058366, 'precision': 0.7975453, 'recall': 0.7038817, 'specificity': 0.7038817, 'f1': 0.68001974, 'auroc': 0.9117261, 'binary_precision': 0.96099293, 'binary_recall': 0.4247649, 'binary_specificity': 0.98299843, 'binary_f1_score': 0.58913046}
confusion matrix:
     0    1
0  636   11
1  367  271
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7635135, 'precision': 0.8256928, 'recall': 0.7635135, 'specificity': 0.7635135, 'f1': 0.7516606, 'auroc': 0.91588044, 'binary_precision': 0.968, 'binary_recall': 0.545045, 'binary_specificity': 0.981982, 'binary_f1_score': 0.6974063}
confusion matrix:
     0    1
0  218    4
1  101  121
early stop counter: 10
val acc:0.7058365941047668, best validation acc: 0.8607003688812256, corresponding to test acc:                         0.8558558821678162 / 0.8761261105537415
after epoch: 30,now: 2024-07-26 09:54:30.822963,epoch time: 0:01:26.456517,used: 0:43:15.268195,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_09_11_15_seed_6_23065778
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 0:43:15.268195 at 2024-07-26 09:54:30.822963
persisted model performance metric: 

scalar performance:
{'acc': 0.8558559, 'precision': 0.8582108, 'recall': 0.8558558, 'specificity': 0.8558558, 'f1': 0.85561854, 'auroc': 0.91693044, 'binary_precision': 0.8872549, 'binary_recall': 0.8153153, 'binary_specificity': 0.8963964, 'binary_f1_score': 0.84976524}
confusion matrix:
     0    1
0  199   23
1   41  181
oracle model performance metric: 

scalar performance:
{'acc': 0.8761261, 'precision': 0.88360614, 'recall': 0.8761261, 'specificity': 0.8761261, 'f1': 0.8755193, 'auroc': 0.94276035, 'binary_precision': 0.9371728, 'binary_recall': 0.8063063, 'binary_specificity': 0.9459459, 'binary_f1_score': 0.86682814}
confusion matrix:
     0    1
0  210   12
1   43  179
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_irm_10seeds_nofreeze_2024-07-26_02-28-54/rule_results/1.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_irm_10seeds_nofreeze_2024-07-26_02-28-54/confusion_matrix/1.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 455399 KiB |  13219 MiB | 511551 GiB | 511551 GiB |
|       from large pool | 414803 KiB |  13181 MiB | 505464 GiB | 505464 GiB |
|       from small pool |  40595 KiB |     60 MiB |   6087 GiB |   6087 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 455399 KiB |  13219 MiB | 511551 GiB | 511551 GiB |
|       from large pool | 414803 KiB |  13181 MiB | 505464 GiB | 505464 GiB |
|       from small pool |  40595 KiB |     60 MiB |   6087 GiB |   6087 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 447481 KiB |  13213 MiB | 510728 GiB | 510728 GiB |
|       from large pool | 407075 KiB |  13175 MiB | 504654 GiB | 504654 GiB |
|       from small pool |  40406 KiB |     60 MiB |   6074 GiB |   6074 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  14478 MiB |  14482 MiB |  96034 MiB |  81556 MiB |
|       from large pool |  14412 MiB |  14412 MiB |  95870 MiB |  81458 MiB |
|       from small pool |     66 MiB |     70 MiB |    164 MiB |     98 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 445721 KiB |   1236 MiB | 358002 GiB | 358001 GiB |
|       from large pool | 435116 KiB |   1229 MiB | 351876 GiB | 351876 GiB |
|       from small pool |  10604 KiB |     44 MiB |   6125 GiB |   6125 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    1304    |    2598    |   90475 K  |   90473 K  |
|       from large pool |     187    |    1413    |   46003 K  |   46003 K  |
|       from small pool |    1117    |    1419    |   44471 K  |   44470 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    1304    |    2598    |   90475 K  |   90473 K  |
|       from large pool |     187    |    1413    |   46003 K  |   46003 K  |
|       from small pool |    1117    |    1419    |   44471 K  |   44470 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     635    |     637    |    4072    |    3437    |
|       from large pool |     602    |     602    |    3990    |    3388    |
|       from small pool |      33    |      35    |      82    |      49    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      93    |     652    |   61419 K  |   61419 K  |
|       from large pool |      38    |     605    |   35359 K  |   35359 K  |
|       from small pool |      55    |     237    |   26059 K  |   26059 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13219 MiB | 511551 GiB | 511551 GiB |
|       from large pool |  16640 KiB |  13181 MiB | 505464 GiB | 505464 GiB |
|       from small pool |      0 KiB |     60 MiB |   6087 GiB |   6087 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13219 MiB | 511551 GiB | 511551 GiB |
|       from large pool |  16640 KiB |  13181 MiB | 505464 GiB | 505464 GiB |
|       from small pool |      0 KiB |     60 MiB |   6087 GiB |   6087 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13213 MiB | 510728 GiB | 510728 GiB |
|       from large pool |  16640 KiB |  13175 MiB | 504654 GiB | 504654 GiB |
|       from small pool |      0 KiB |     60 MiB |   6074 GiB |   6074 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    880 MiB |  14482 MiB |  96034 MiB |  95154 MiB |
|       from large pool |    830 MiB |  14412 MiB |  95870 MiB |  95040 MiB |
|       from small pool |     50 MiB |     70 MiB |    164 MiB |    114 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1236 MiB | 358002 GiB | 358002 GiB |
|       from large pool |  24320 KiB |   1229 MiB | 351876 GiB | 351876 GiB |
|       from small pool |      0 KiB |     44 MiB |   6125 GiB |   6125 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    2598    |   90475 K  |   90475 K  |
|       from large pool |       2    |    1413    |   46003 K  |   46003 K  |
|       from small pool |       0    |    1419    |   44471 K  |   44471 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    2598    |   90475 K  |   90475 K  |
|       from large pool |       2    |    1413    |   46003 K  |   46003 K  |
|       from small pool |       0    |    1419    |   44471 K  |   44471 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      62    |     637    |    4072    |    4010    |
|       from large pool |      37    |     602    |    3990    |    3953    |
|       from small pool |      25    |      35    |      82    |      57    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |     652    |   61419 K  |   61419 K  |
|       from large pool |       4    |     605    |   35359 K  |   35359 K  |
|       from small pool |       0    |     237    |   26059 K  |   26059 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13219 MiB | 511551 GiB | 511551 GiB |
|       from large pool |  16640 KiB |  13181 MiB | 505464 GiB | 505464 GiB |
|       from small pool |      0 KiB |     60 MiB |   6087 GiB |   6087 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13219 MiB | 511551 GiB | 511551 GiB |
|       from large pool |  16640 KiB |  13181 MiB | 505464 GiB | 505464 GiB |
|       from small pool |      0 KiB |     60 MiB |   6087 GiB |   6087 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13213 MiB | 510728 GiB | 510728 GiB |
|       from large pool |  16640 KiB |  13175 MiB | 504654 GiB | 504654 GiB |
|       from small pool |      0 KiB |     60 MiB |   6074 GiB |   6074 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    880 MiB |  14482 MiB |  96034 MiB |  95154 MiB |
|       from large pool |    830 MiB |  14412 MiB |  95870 MiB |  95040 MiB |
|       from small pool |     50 MiB |     70 MiB |    164 MiB |    114 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1236 MiB | 358002 GiB | 358002 GiB |
|       from large pool |  24320 KiB |   1229 MiB | 351876 GiB | 351876 GiB |
|       from small pool |      0 KiB |     44 MiB |   6125 GiB |   6125 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    2598    |   90475 K  |   90475 K  |
|       from large pool |       2    |    1413    |   46003 K  |   46003 K  |
|       from small pool |       0    |    1419    |   44471 K  |   44471 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    2598    |   90475 K  |   90475 K  |
|       from large pool |       2    |    1413    |   46003 K  |   46003 K  |
|       from small pool |       0    |    1419    |   44471 K  |   44471 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      62    |     637    |    4072    |    4010    |
|       from large pool |      37    |     602    |    3990    |    3953    |
|       from small pool |      25    |      35    |      82    |      57    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |     652    |   61419 K  |   61419 K  |
|       from large pool |       4    |     605    |   35359 K  |   35359 K  |
|       from small pool |       0    |     237    |   26059 K  |   26059 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'888c1ef2'
model name: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_09_55_03_seed_7_23065778

 Experiment start at: 2024-07-26 09:55:03.166804
before training, model accuracy: 0.4978165924549103
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.94466144, 'precision': 0.9469436, 'recall': 0.9441392, 'specificity': 0.9441392, 'f1': 0.94453275, 'auroc': 0.99213636, 'binary_precision': 0.9186747, 'binary_recall': 0.9775641, 'binary_specificity': 0.91071427, 'binary_f1_score': 0.947205}
confusion matrix:
      0     1
0  1377   135
1    35  1525
---- Validation: 
scalar performance:
{'acc': 0.84076923, 'precision': 0.8473569, 'recall': 0.8397017, 'specificity': 0.8397017, 'f1': 0.8396832, 'auroc': 0.89867896, 'binary_precision': 0.8915009, 'binary_recall': 0.7703125, 'binary_specificity': 0.90909094, 'binary_f1_score': 0.82648784}
confusion matrix:
     0    1
0  600   60
1  147  493
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.88209605, 'precision': 0.88352954, 'recall': 0.88209605, 'specificity': 0.88209605, 'f1': 0.8819858, 'auroc': 0.93691957, 'binary_precision': 0.90697676, 'binary_recall': 0.8515284, 'binary_specificity': 0.91266376, 'binary_f1_score': 0.8783784}
confusion matrix:
     0    1
0  209   20
1   34  195
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-26 09:56:33.796855,epoch time: 0:01:30.630051,used: 0:01:30.630051,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_09_55_03_seed_7_23065778
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.97005206, 'precision': 0.9700427, 'recall': 0.97015667, 'specificity': 0.97015667, 'f1': 0.97005, 'auroc': 0.9937453, 'binary_precision': 0.9772432, 'binary_recall': 0.9634615, 'binary_specificity': 0.9768519, 'binary_f1_score': 0.9703034}
confusion matrix:
      0     1
0  1477    35
1    57  1503
---- Validation: 
scalar performance:
{'acc': 0.83384615, 'precision': 0.8478942, 'recall': 0.83229166, 'specificity': 0.83229166, 'f1': 0.8316643, 'auroc': 0.9028598, 'binary_precision': 0.9140625, 'binary_recall': 0.73125, 'binary_specificity': 0.93333334, 'binary_f1_score': 0.8125}
confusion matrix:
     0    1
0  616   44
1  172  468
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.88646287, 'precision': 0.89625573, 'recall': 0.88646287, 'specificity': 0.88646287, 'f1': 0.8857571, 'auroc': 0.9473885, 'binary_precision': 0.9585492, 'binary_recall': 0.80786026, 'binary_specificity': 0.9650655, 'binary_f1_score': 0.8767773}
confusion matrix:
     0    1
0  221    8
1   44  185
new oracle model saved
early stop counter: 1
val acc:0.8338461518287659, best validation acc: 0.8407692313194275, corresponding to test acc:                         0.8820960521697998 / 0.8864628672599792
after epoch: 2,now: 2024-07-26 09:58:00.525087,epoch time: 0:01:26.728232,used: 0:02:57.358283,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_09_55_03_seed_7_23065778
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9707031, 'precision': 0.97126913, 'recall': 0.9710317, 'specificity': 0.9710317, 'f1': 0.9707021, 'auroc': 0.9970933, 'binary_precision': 0.99196786, 'binary_recall': 0.95, 'binary_specificity': 0.99206346, 'binary_f1_score': 0.97053045}
confusion matrix:
      0     1
0  1500    12
1    78  1482
---- Validation: 
scalar performance:
{'acc': 0.7792308, 'precision': 0.8067473, 'recall': 0.776894, 'specificity': 0.776894, 'f1': 0.7731406, 'auroc': 0.84861743, 'binary_precision': 0.8948546, 'binary_recall': 0.625, 'binary_specificity': 0.9287879, 'binary_f1_score': 0.7359706}
confusion matrix:
     0    1
0  613   47
1  240  400
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.88646287, 'precision': 0.8894333, 'recall': 0.8864629, 'specificity': 0.8864629, 'f1': 0.88624597, 'auroc': 0.9425068, 'binary_precision': 0.923445, 'binary_recall': 0.8427948, 'binary_specificity': 0.930131, 'binary_f1_score': 0.8812785}
confusion matrix:
     0    1
0  213   16
1   36  193
early stop counter: 2
val acc:0.7792307734489441, best validation acc: 0.8407692313194275, corresponding to test acc:                         0.8820960521697998 / 0.8864628672599792
after epoch: 3,now: 2024-07-26 09:59:27.046928,epoch time: 0:01:26.521841,used: 0:04:23.880124,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_09_55_03_seed_7_23065778
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.96516925, 'precision': 0.96704376, 'recall': 0.96471816, 'specificity': 0.96471816, 'f1': 0.9651019, 'auroc': 0.9978128, 'binary_precision': 0.94110507, 'binary_recall': 0.99358976, 'binary_specificity': 0.93584657, 'binary_f1_score': 0.9666355}
confusion matrix:
      0     1
0  1415    97
1    10  1550
---- Validation: 
scalar performance:
{'acc': 0.8546154, 'precision': 0.8548472, 'recall': 0.85482955, 'specificity': 0.85482955, 'f1': 0.85461533, 'auroc': 0.89633286, 'binary_precision': 0.84114975, 'binary_recall': 0.86875, 'binary_specificity': 0.84090906, 'binary_f1_score': 0.85472715}
confusion matrix:
     0    1
0  555  105
1   84  556
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.88209605, 'precision': 0.8870859, 'recall': 0.88209605, 'specificity': 0.88209605, 'f1': 0.8817149, 'auroc': 0.95656073, 'binary_precision': 0.84313726, 'binary_recall': 0.93886465, 'binary_specificity': 0.8253275, 'binary_f1_score': 0.8884297}
confusion matrix:
     0    1
0  189   40
1   14  215
better model found
persisted
after epoch: 4,now: 2024-07-26 10:00:54.008199,epoch time: 0:01:26.961271,used: 0:05:50.841395,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_09_55_03_seed_7_23065778
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.97753906, 'precision': 0.9776486, 'recall': 0.9774573, 'specificity': 0.9774573, 'f1': 0.9775296, 'auroc': 0.996752, 'binary_precision': 0.97333336, 'binary_recall': 0.9826923, 'binary_specificity': 0.9722222, 'binary_f1_score': 0.97799045}
confusion matrix:
      0     1
0  1470    42
1    27  1533
---- Validation: 
scalar performance:
{'acc': 0.8138462, 'precision': 0.83820784, 'recall': 0.8117661, 'specificity': 0.8117661, 'f1': 0.80969507, 'auroc': 0.8983499, 'binary_precision': 0.9252137, 'binary_recall': 0.6765625, 'binary_specificity': 0.9469697, 'binary_f1_score': 0.7815885}
confusion matrix:
     0    1
0  625   35
1  207  433
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8362445, 'precision': 0.8552748, 'recall': 0.8362446, 'specificity': 0.8362446, 'f1': 0.8340219, 'auroc': 0.9224843, 'binary_precision': 0.9375, 'binary_recall': 0.720524, 'binary_specificity': 0.9519651, 'binary_f1_score': 0.8148148}
confusion matrix:
     0    1
0  218   11
1   64  165
early stop counter: 1
val acc:0.8138461709022522, best validation acc: 0.8546153903007507, corresponding to test acc:                         0.8820960521697998 / 0.8864628672599792
after epoch: 5,now: 2024-07-26 10:02:20.399195,epoch time: 0:01:26.390996,used: 0:07:17.232391,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_09_55_03_seed_7_23065778
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9860026, 'precision': 0.98597264, 'recall': 0.986045, 'specificity': 0.986045, 'f1': 0.98600036, 'auroc': 0.99917793, 'binary_precision': 0.9890393, 'binary_recall': 0.98333335, 'binary_specificity': 0.9887566, 'binary_f1_score': 0.9861781}
confusion matrix:
      0     1
0  1495    17
1    26  1534
---- Validation: 
scalar performance:
{'acc': 0.8223077, 'precision': 0.8343375, 'recall': 0.8208333, 'specificity': 0.8208333, 'f1': 0.82019246, 'auroc': 0.89448154, 'binary_precision': 0.894027, 'binary_recall': 0.725, 'binary_specificity': 0.9166667, 'binary_f1_score': 0.80069023}
confusion matrix:
     0    1
0  605   55
1  176  464
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.86026204, 'precision': 0.863031, 'recall': 0.86026204, 'specificity': 0.86026204, 'f1': 0.859995, 'auroc': 0.92038673, 'binary_precision': 0.8947368, 'binary_recall': 0.8165939, 'binary_specificity': 0.9039301, 'binary_f1_score': 0.8538813}
confusion matrix:
     0    1
0  207   22
1   42  187
early stop counter: 2
val acc:0.8223077058792114, best validation acc: 0.8546153903007507, corresponding to test acc:                         0.8820960521697998 / 0.8864628672599792
after epoch: 6,now: 2024-07-26 10:03:46.690396,epoch time: 0:01:26.291201,used: 0:08:43.523592,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_09_55_03_seed_7_23065778
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9628906, 'precision': 0.96494466, 'recall': 0.9634615, 'specificity': 0.9634615, 'f1': 0.9628735, 'auroc': 0.9974773, 'binary_precision': 1.0, 'binary_recall': 0.9269231, 'binary_specificity': 1.0, 'binary_f1_score': 0.9620759}
confusion matrix:
      0     1
0  1512     0
1   114  1446
---- Validation: 
scalar performance:
{'acc': 0.7, 'precision': 0.7923672, 'recall': 0.6956203, 'specificity': 0.6956203, 'f1': 0.67132217, 'auroc': 0.8986162, 'binary_precision': 0.95289856, 'binary_recall': 0.4109375, 'binary_specificity': 0.98030305, 'binary_f1_score': 0.5742358}
confusion matrix:
     0    1
0  647   13
1  377  263
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.84061134, 'precision': 0.87462246, 'recall': 0.84061134, 'specificity': 0.84061134, 'f1': 0.8369097, 'auroc': 0.92851484, 'binary_precision': 0.9875, 'binary_recall': 0.6899563, 'binary_specificity': 0.99126637, 'binary_f1_score': 0.8123393}
confusion matrix:
     0    1
0  227    2
1   71  158
early stop counter: 3
val acc:0.699999988079071, best validation acc: 0.8546153903007507, corresponding to test acc:                         0.8820960521697998 / 0.8864628672599792
after epoch: 7,now: 2024-07-26 10:05:13.337054,epoch time: 0:01:26.646658,used: 0:10:10.170250,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_09_55_03_seed_7_23065778
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.97786456, 'precision': 0.97783864, 'recall': 0.9778897, 'specificity': 0.9778897, 'f1': 0.97786045, 'auroc': 0.996621, 'binary_precision': 0.98005146, 'binary_recall': 0.97628206, 'binary_specificity': 0.9794974, 'binary_f1_score': 0.9781631}
confusion matrix:
      0     1
0  1481    31
1    37  1523
---- Validation: 
scalar performance:
{'acc': 0.7753846, 'precision': 0.7878058, 'recall': 0.7737453, 'specificity': 0.7737453, 'f1': 0.7721877, 'auroc': 0.8654847, 'binary_precision': 0.8438735, 'binary_recall': 0.6671875, 'binary_specificity': 0.880303, 'binary_f1_score': 0.7452007}
confusion matrix:
     0    1
0  581   79
1  213  427
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8537118, 'precision': 0.85404265, 'recall': 0.8537118, 'specificity': 0.8537118, 'f1': 0.85367763, 'auroc': 0.9307412, 'binary_precision': 0.8648649, 'binary_recall': 0.83842796, 'binary_specificity': 0.8689956, 'binary_f1_score': 0.85144126}
confusion matrix:
     0    1
0  199   30
1   37  192
early stop counter: 4
val acc:0.7753846049308777, best validation acc: 0.8546153903007507, corresponding to test acc:                         0.8820960521697998 / 0.8864628672599792
after epoch: 8,now: 2024-07-26 10:06:39.898788,epoch time: 0:01:26.561734,used: 0:11:36.731984,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_09_55_03_seed_7_23065778
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.98502606, 'precision': 0.9851842, 'recall': 0.98523605, 'specificity': 0.98523605, 'f1': 0.985026, 'auroc': 0.9995667, 'binary_precision': 0.9986825, 'binary_recall': 0.97179484, 'binary_specificity': 0.99867725, 'binary_f1_score': 0.9850552}
confusion matrix:
      0     1
0  1510     2
1    44  1516
---- Validation: 
scalar performance:
{'acc': 0.81, 'precision': 0.8331464, 'recall': 0.80795455, 'specificity': 0.80795455, 'f1': 0.80589736, 'auroc': 0.8974136, 'binary_precision': 0.91719747, 'binary_recall': 0.675, 'binary_specificity': 0.9409091, 'binary_f1_score': 0.77767783}
confusion matrix:
     0    1
0  621   39
1  208  432
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8624454, 'precision': 0.87983614, 'recall': 0.8624454, 'specificity': 0.8624454, 'f1': 0.8608527, 'auroc': 0.9411338, 'binary_precision': 0.9611111, 'binary_recall': 0.75545853, 'binary_specificity': 0.9694323, 'binary_f1_score': 0.84596574}
confusion matrix:
     0    1
0  222    7
1   56  173
early stop counter: 5
val acc:0.8100000023841858, best validation acc: 0.8546153903007507, corresponding to test acc:                         0.8820960521697998 / 0.8864628672599792
after epoch: 9,now: 2024-07-26 10:08:06.584200,epoch time: 0:01:26.685412,used: 0:13:03.417396,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_09_55_03_seed_7_23065778
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9892578, 'precision': 0.98924243, 'recall': 0.98927045, 'specificity': 0.98927045, 'f1': 0.98925555, 'auroc': 0.99948573, 'binary_precision': 0.9903661, 'binary_recall': 0.98846155, 'binary_specificity': 0.99007934, 'binary_f1_score': 0.9894129}
confusion matrix:
      0     1
0  1497    15
1    18  1542
---- Validation: 
scalar performance:
{'acc': 0.77384615, 'precision': 0.79227626, 'recall': 0.771875, 'specificity': 0.771875, 'f1': 0.76932496, 'auroc': 0.8690051, 'binary_precision': 0.8619247, 'binary_recall': 0.64375, 'binary_specificity': 0.9, 'binary_f1_score': 0.73703045}
confusion matrix:
     0    1
0  594   66
1  228  412
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8362445, 'precision': 0.8390962, 'recall': 0.8362445, 'specificity': 0.8362445, 'f1': 0.83589953, 'auroc': 0.92195034, 'binary_precision': 0.8701923, 'binary_recall': 0.790393, 'binary_specificity': 0.88209605, 'binary_f1_score': 0.8283753}
confusion matrix:
     0    1
0  202   27
1   48  181
early stop counter: 6
val acc:0.7738461494445801, best validation acc: 0.8546153903007507, corresponding to test acc:                         0.8820960521697998 / 0.8864628672599792
after epoch: 10,now: 2024-07-26 10:09:33.142370,epoch time: 0:01:26.558170,used: 0:14:29.975566,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_09_55_03_seed_7_23065778
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.98535156, 'precision': 0.9853382, 'recall': 0.9854548, 'specificity': 0.9854548, 'f1': 0.9853504, 'auroc': 0.99910414, 'binary_precision': 0.99220276, 'binary_recall': 0.97884613, 'binary_specificity': 0.99206346, 'binary_f1_score': 0.9854792}
confusion matrix:
      0     1
0  1500    12
1    33  1527
---- Validation: 
scalar performance:
{'acc': 0.7346154, 'precision': 0.7818018, 'recall': 0.73141575, 'specificity': 0.73141575, 'f1': 0.72121644, 'auroc': 0.8770242, 'binary_precision': 0.8933333, 'binary_recall': 0.5234375, 'binary_specificity': 0.93939394, 'binary_f1_score': 0.6600985}
confusion matrix:
     0    1
0  620   40
1  305  335
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.82969433, 'precision': 0.855773, 'recall': 0.8296943, 'specificity': 0.8296943, 'f1': 0.8265151, 'auroc': 0.92496324, 'binary_precision': 0.9520958, 'binary_recall': 0.6943231, 'binary_specificity': 0.9650655, 'binary_f1_score': 0.80303025}
confusion matrix:
     0    1
0  221    8
1   70  159
early stop counter: 7
val acc:0.7346153855323792, best validation acc: 0.8546153903007507, corresponding to test acc:                         0.8820960521697998 / 0.8864628672599792
after epoch: 11,now: 2024-07-26 10:10:59.795278,epoch time: 0:01:26.652908,used: 0:15:56.628474,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_09_55_03_seed_7_23065778
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9827474, 'precision': 0.98286974, 'recall': 0.9829416, 'specificity': 0.9829416, 'f1': 0.9827473, 'auroc': 0.9993763, 'binary_precision': 0.99539775, 'binary_recall': 0.9705128, 'binary_specificity': 0.9953704, 'binary_f1_score': 0.9827978}
confusion matrix:
      0     1
0  1505     7
1    46  1514
---- Validation: 
scalar performance:
{'acc': 0.78307694, 'precision': 0.8197163, 'recall': 0.7804451, 'specificity': 0.7804451, 'f1': 0.77555406, 'auroc': 0.8887127, 'binary_precision': 0.9241706, 'binary_recall': 0.609375, 'binary_specificity': 0.95151514, 'binary_f1_score': 0.7344632}
confusion matrix:
     0    1
0  628   32
1  250  390
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.82969433, 'precision': 0.86157644, 'recall': 0.82969433, 'specificity': 0.82969433, 'f1': 0.8258555, 'auroc': 0.94317424, 'binary_precision': 0.9689441, 'binary_recall': 0.68122274, 'binary_specificity': 0.9781659, 'binary_f1_score': 0.8}
confusion matrix:
     0    1
0  224    5
1   73  156
early stop counter: 8
val acc:0.7830769419670105, best validation acc: 0.8546153903007507, corresponding to test acc:                         0.8820960521697998 / 0.8864628672599792
after epoch: 12,now: 2024-07-26 10:12:26.360687,epoch time: 0:01:26.565409,used: 0:17:23.193883,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_09_55_03_seed_7_23065778
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.98339844, 'precision': 0.9836122, 'recall': 0.9832773, 'specificity': 0.9832773, 'f1': 0.9833895, 'auroc': 0.9987726, 'binary_precision': 0.97662663, 'binary_recall': 0.9910256, 'binary_specificity': 0.9755291, 'binary_f1_score': 0.9837734}
confusion matrix:
      0     1
0  1475    37
1    14  1546
---- Validation: 
scalar performance:
{'acc': 0.82076925, 'precision': 0.8371787, 'recall': 0.81905776, 'specificity': 0.81905776, 'f1': 0.8179774, 'auroc': 0.9069508, 'binary_precision': 0.90781564, 'binary_recall': 0.7078125, 'binary_specificity': 0.93030304, 'binary_f1_score': 0.79543453}
confusion matrix:
     0    1
0  614   46
1  187  453
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8689956, 'precision': 0.89072186, 'recall': 0.86899567, 'specificity': 0.86899567, 'f1': 0.86714876, 'auroc': 0.94536716, 'binary_precision': 0.98285717, 'binary_recall': 0.7510917, 'binary_specificity': 0.98689955, 'binary_f1_score': 0.85148513}
confusion matrix:
     0    1
0  226    3
1   57  172
early stop counter: 9
val acc:0.8207692503929138, best validation acc: 0.8546153903007507, corresponding to test acc:                         0.8820960521697998 / 0.8864628672599792
after epoch: 13,now: 2024-07-26 10:13:52.759936,epoch time: 0:01:26.399249,used: 0:18:49.593132,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_09_55_03_seed_7_23065778
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.99316406, 'precision': 0.99314284, 'recall': 0.99318784, 'specificity': 0.99318784, 'f1': 0.99316275, 'auroc': 0.9994634, 'binary_precision': 0.9948553, 'binary_recall': 0.9916667, 'binary_specificity': 0.994709, 'binary_f1_score': 0.9932584}
confusion matrix:
      0     1
0  1504     8
1    13  1547
---- Validation: 
scalar performance:
{'acc': 0.83076924, 'precision': 0.85289633, 'recall': 0.82883525, 'specificity': 0.82883525, 'f1': 0.82746136, 'auroc': 0.9101805, 'binary_precision': 0.9375, 'binary_recall': 0.703125, 'binary_specificity': 0.95454544, 'binary_f1_score': 0.8035714}
confusion matrix:
     0    1
0  630   30
1  190  450
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8471616, 'precision': 0.87462187, 'recall': 0.84716153, 'specificity': 0.84716153, 'f1': 0.8443085, 'auroc': 0.9406762, 'binary_precision': 0.97604793, 'binary_recall': 0.7117904, 'binary_specificity': 0.98253274, 'binary_f1_score': 0.82323235}
confusion matrix:
     0    1
0  225    4
1   66  163
early stop counter: 10
val acc:0.8307692408561707, best validation acc: 0.8546153903007507, corresponding to test acc:                         0.8820960521697998 / 0.8864628672599792
after epoch: 14,now: 2024-07-26 10:15:19.360692,epoch time: 0:01:26.600756,used: 0:20:16.193888,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_09_55_03_seed_7_23065778
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.98567706, 'precision': 0.98567706, 'recall': 0.98579574, 'specificity': 0.98579574, 'f1': 0.9856763, 'auroc': 0.9992144, 'binary_precision': 0.99348956, 'binary_recall': 0.97820514, 'binary_specificity': 0.99338627, 'binary_f1_score': 0.98578817}
confusion matrix:
      0     1
0  1502    10
1    34  1526
---- Validation: 
scalar performance:
{'acc': 0.81, 'precision': 0.8415468, 'recall': 0.80764675, 'specificity': 0.80764675, 'f1': 0.804657, 'auroc': 0.9100355, 'binary_precision': 0.941573, 'binary_recall': 0.6546875, 'binary_specificity': 0.96060604, 'binary_f1_score': 0.77235025}
confusion matrix:
     0    1
0  634   26
1  221  419
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8558952, 'precision': 0.88029015, 'recall': 0.85589516, 'specificity': 0.85589516, 'f1': 0.8535465, 'auroc': 0.94132453, 'binary_precision': 0.9766082, 'binary_recall': 0.72925764, 'binary_specificity': 0.98253274, 'binary_f1_score': 0.83500004}
confusion matrix:
     0    1
0  225    4
1   62  167
early stop counter: 11
val acc:0.8100000023841858, best validation acc: 0.8546153903007507, corresponding to test acc:                         0.8820960521697998 / 0.8864628672599792
after epoch: 15,now: 2024-07-26 10:16:45.924916,epoch time: 0:01:26.564224,used: 0:21:42.758112,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_09_55_03_seed_7_23065778
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.99121094, 'precision': 0.99122536, 'recall': 0.99119353, 'specificity': 0.99119353, 'f1': 0.99120855, 'auroc': 0.9996036, 'binary_precision': 0.99040306, 'binary_recall': 0.99230766, 'binary_specificity': 0.99007934, 'binary_f1_score': 0.99135447}
confusion matrix:
      0     1
0  1497    15
1    12  1548
---- Validation: 
scalar performance:
{'acc': 0.6515385, 'precision': 0.76134264, 'recall': 0.6464726, 'specificity': 0.6464726, 'f1': 0.6062237, 'auroc': 0.8757428, 'binary_precision': 0.9269406, 'binary_recall': 0.3171875, 'binary_specificity': 0.9757576, 'binary_f1_score': 0.4726426}
confusion matrix:
     0    1
0  644   16
1  437  203
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.779476, 'precision': 0.8469697, 'recall': 0.779476, 'specificity': 0.779476, 'f1': 0.7682035, 'auroc': 0.9541008, 'binary_precision': 1.0, 'binary_recall': 0.558952, 'binary_specificity': 1.0, 'binary_f1_score': 0.71708685}
confusion matrix:
     0    1
0  229    0
1  101  128
early stop counter: 12
val acc:0.6515384912490845, best validation acc: 0.8546153903007507, corresponding to test acc:                         0.8820960521697998 / 0.8864628672599792
after epoch: 16,now: 2024-07-26 10:18:12.319199,epoch time: 0:01:26.394283,used: 0:23:09.152395,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_09_55_03_seed_7_23065778
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9902344, 'precision': 0.9902102, 'recall': 0.9902625, 'specificity': 0.9902625, 'f1': 0.9902325, 'auroc': 0.99965113, 'binary_precision': 0.992278, 'binary_recall': 0.98846155, 'binary_specificity': 0.99206346, 'binary_f1_score': 0.99036604}
confusion matrix:
      0     1
0  1500    12
1    18  1542
---- Validation: 
scalar performance:
{'acc': 0.79615384, 'precision': 0.8254994, 'recall': 0.793821, 'specificity': 0.793821, 'f1': 0.79053056, 'auroc': 0.9001018, 'binary_precision': 0.9194631, 'binary_recall': 0.6421875, 'binary_specificity': 0.94545454, 'binary_f1_score': 0.7562098}
confusion matrix:
     0    1
0  624   36
1  229  411
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8558952, 'precision': 0.8695377, 'recall': 0.8558952, 'specificity': 0.8558952, 'f1': 0.8545528, 'auroc': 0.93951297, 'binary_precision': 0.94054055, 'binary_recall': 0.75982535, 'binary_specificity': 0.9519651, 'binary_f1_score': 0.84057975}
confusion matrix:
     0    1
0  218   11
1   55  174
early stop counter: 13
val acc:0.7961538434028625, best validation acc: 0.8546153903007507, corresponding to test acc:                         0.8820960521697998 / 0.8864628672599792
after epoch: 17,now: 2024-07-26 10:19:38.680635,epoch time: 0:01:26.361436,used: 0:24:35.513831,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_09_55_03_seed_7_23065778
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9873047, 'precision': 0.9873309, 'recall': 0.98727614, 'specificity': 0.98727614, 'f1': 0.9873009, 'auroc': 0.9994302, 'binary_precision': 0.9859425, 'binary_recall': 0.98910254, 'binary_specificity': 0.98544973, 'binary_f1_score': 0.98752}
confusion matrix:
      0     1
0  1490    22
1    17  1543
---- Validation: 
scalar performance:
{'acc': 0.7853846, 'precision': 0.8284074, 'recall': 0.7825757, 'specificity': 0.7825757, 'f1': 0.77693605, 'auroc': 0.89694726, 'binary_precision': 0.94348896, 'binary_recall': 0.6, 'binary_specificity': 0.9651515, 'binary_f1_score': 0.7335244}
confusion matrix:
     0    1
0  637   23
1  256  384
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7489083, 'precision': 0.815168, 'recall': 0.7489083, 'specificity': 0.7489083, 'f1': 0.73497903, 'auroc': 0.9278808, 'binary_precision': 0.9596774, 'binary_recall': 0.51965064, 'binary_specificity': 0.9781659, 'binary_f1_score': 0.674221}
confusion matrix:
     0    1
0  224    5
1  110  119
early stop counter: 14
val acc:0.7853845953941345, best validation acc: 0.8546153903007507, corresponding to test acc:                         0.8820960521697998 / 0.8864628672599792
after epoch: 18,now: 2024-07-26 10:21:05.427627,epoch time: 0:01:26.746992,used: 0:26:02.260823,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_09_55_03_seed_7_23065778
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.97721356, 'precision': 0.9775483, 'recall': 0.9774827, 'specificity': 0.9774827, 'f1': 0.97721344, 'auroc': 0.9990389, 'binary_precision': 0.9946879, 'binary_recall': 0.9602564, 'binary_specificity': 0.994709, 'binary_f1_score': 0.9771689}
confusion matrix:
      0     1
0  1504     8
1    62  1498
---- Validation: 
scalar performance:
{'acc': 0.8007692, 'precision': 0.8126584, 'recall': 0.7992424, 'specificity': 0.7992424, 'f1': 0.7982594, 'auroc': 0.88198864, 'binary_precision': 0.8699029, 'binary_recall': 0.7, 'binary_specificity': 0.8984848, 'binary_f1_score': 0.77575755}
confusion matrix:
     0    1
0  593   67
1  192  448
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.87554586, 'precision': 0.8764144, 'recall': 0.87554586, 'specificity': 0.87554586, 'f1': 0.87547404, 'auroc': 0.9467783, 'binary_precision': 0.8944954, 'binary_recall': 0.8515284, 'binary_specificity': 0.8995633, 'binary_f1_score': 0.87248325}
confusion matrix:
     0    1
0  206   23
1   34  195
early stop counter: 15
val acc:0.8007692098617554, best validation acc: 0.8546153903007507, corresponding to test acc:                         0.8820960521697998 / 0.8864628672599792
after epoch: 19,now: 2024-07-26 10:22:31.646642,epoch time: 0:01:26.219015,used: 0:27:28.479838,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_09_55_03_seed_7_23065778
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9902344, 'precision': 0.99028444, 'recall': 0.9901913, 'specificity': 0.9901913, 'f1': 0.99023116, 'auroc': 0.9995586, 'binary_precision': 0.9878827, 'binary_recall': 0.9929487, 'binary_specificity': 0.98743385, 'binary_f1_score': 0.9904092}
confusion matrix:
      0     1
0  1493    19
1    11  1549
---- Validation: 
scalar performance:
{'acc': 0.78307694, 'precision': 0.81465024, 'recall': 0.7806108, 'specificity': 0.7806108, 'f1': 0.7764394, 'auroc': 0.8936026, 'binary_precision': 0.9105505, 'binary_recall': 0.6203125, 'binary_specificity': 0.9409091, 'binary_f1_score': 0.7379182}
confusion matrix:
     0    1
0  621   39
1  243  397
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.83406115, 'precision': 0.86636555, 'recall': 0.83406115, 'specificity': 0.83406115, 'f1': 0.8303207, 'auroc': 0.93615675, 'binary_precision': 0.9751553, 'binary_recall': 0.6855895, 'binary_specificity': 0.98253274, 'binary_f1_score': 0.80512816}
confusion matrix:
     0    1
0  225    4
1   72  157
early stop counter: 16
val acc:0.7830769419670105, best validation acc: 0.8546153903007507, corresponding to test acc:                         0.8820960521697998 / 0.8864628672599792
after epoch: 20,now: 2024-07-26 10:23:57.936613,epoch time: 0:01:26.289971,used: 0:28:54.769809,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_09_55_03_seed_7_23065778
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9899089, 'precision': 0.98996717, 'recall': 0.9898606, 'specificity': 0.9898606, 'f1': 0.98990536, 'auroc': 0.99966335, 'binary_precision': 0.987253, 'binary_recall': 0.9929487, 'binary_specificity': 0.9867725, 'binary_f1_score': 0.9900927}
confusion matrix:
      0     1
0  1492    20
1    11  1549
---- Validation: 
scalar performance:
{'acc': 0.78384614, 'precision': 0.8249503, 'recall': 0.7810843, 'specificity': 0.7810843, 'f1': 0.77561414, 'auroc': 0.9057623, 'binary_precision': 0.9367397, 'binary_recall': 0.6015625, 'binary_specificity': 0.96060604, 'binary_f1_score': 0.73263556}
confusion matrix:
     0    1
0  634   26
1  255  385
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8144105, 'precision': 0.86195993, 'recall': 0.81441045, 'specificity': 0.81441045, 'f1': 0.80810845, 'auroc': 0.9383879, 'binary_precision': 0.9931507, 'binary_recall': 0.6331878, 'binary_specificity': 0.9956332, 'binary_f1_score': 0.7733333}
confusion matrix:
     0    1
0  228    1
1   84  145
early stop counter: 17
val acc:0.7838461399078369, best validation acc: 0.8546153903007507, corresponding to test acc:                         0.8820960521697998 / 0.8864628672599792
after epoch: 21,now: 2024-07-26 10:25:24.381069,epoch time: 0:01:26.444456,used: 0:30:21.214265,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_09_55_03_seed_7_23065778
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.99153644, 'precision': 0.99155736, 'recall': 0.991514, 'specificity': 0.991514, 'f1': 0.991534, 'auroc': 0.99971974, 'binary_precision': 0.9904092, 'binary_recall': 0.9929487, 'binary_specificity': 0.99007934, 'binary_f1_score': 0.99167734}
confusion matrix:
      0     1
0  1497    15
1    11  1549
---- Validation: 
scalar performance:
{'acc': 0.7323077, 'precision': 0.8028079, 'recall': 0.72855115, 'specificity': 0.72855115, 'f1': 0.71363026, 'auroc': 0.8864962, 'binary_precision': 0.94512194, 'binary_recall': 0.484375, 'binary_specificity': 0.9727273, 'binary_f1_score': 0.64049584}
confusion matrix:
     0    1
0  642   18
1  330  310
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7379913, 'precision': 0.82402575, 'recall': 0.7379913, 'specificity': 0.7379913, 'f1': 0.71936274, 'auroc': 0.90429246, 'binary_precision': 0.990991, 'binary_recall': 0.48034933, 'binary_specificity': 0.9956332, 'binary_f1_score': 0.64705884}
confusion matrix:
     0    1
0  228    1
1  119  110
early stop counter: 18
val acc:0.7323076725006104, best validation acc: 0.8546153903007507, corresponding to test acc:                         0.8820960521697998 / 0.8864628672599792
after epoch: 22,now: 2024-07-26 10:26:50.664844,epoch time: 0:01:26.283775,used: 0:31:47.498040,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_09_55_03_seed_7_23065778
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.99153644, 'precision': 0.99150646, 'recall': 0.99160564, 'specificity': 0.99160564, 'f1': 0.9915354, 'auroc': 0.9996689, 'binary_precision': 0.996119, 'binary_recall': 0.98717946, 'binary_specificity': 0.99603176, 'binary_f1_score': 0.99162906}
confusion matrix:
      0     1
0  1506     6
1    20  1540
---- Validation: 
scalar performance:
{'acc': 0.6861538, 'precision': 0.7702769, 'recall': 0.6817945, 'specificity': 0.6817945, 'f1': 0.6564936, 'auroc': 0.8830895, 'binary_precision': 0.9172662, 'binary_recall': 0.3984375, 'binary_specificity': 0.9651515, 'binary_f1_score': 0.5555556}
confusion matrix:
     0    1
0  637   23
1  385  255
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8100437, 'precision': 0.85438097, 'recall': 0.8100437, 'specificity': 0.8100437, 'f1': 0.8039104, 'auroc': 0.9380256, 'binary_precision': 0.9797297, 'binary_recall': 0.6331878, 'binary_specificity': 0.98689955, 'binary_f1_score': 0.7692308}
confusion matrix:
     0    1
0  226    3
1   84  145
early stop counter: 19
val acc:0.6861538290977478, best validation acc: 0.8546153903007507, corresponding to test acc:                         0.8820960521697998 / 0.8864628672599792
after epoch: 23,now: 2024-07-26 10:28:17.369985,epoch time: 0:01:26.705141,used: 0:33:14.203181,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_09_55_03_seed_7_23065778
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9944661, 'precision': 0.99450994, 'recall': 0.9944292, 'specificity': 0.9944292, 'f1': 0.9944644, 'auroc': 0.9998584, 'binary_precision': 0.99234205, 'binary_recall': 0.9967949, 'binary_specificity': 0.99206346, 'binary_f1_score': 0.9945635}
confusion matrix:
      0     1
0  1500    12
1     5  1555
---- Validation: 
scalar performance:
{'acc': 0.82, 'precision': 0.84133637, 'recall': 0.81806344, 'specificity': 0.81806344, 'f1': 0.8164816, 'auroc': 0.905602, 'binary_precision': 0.92291665, 'binary_recall': 0.6921875, 'binary_specificity': 0.9439394, 'binary_f1_score': 0.7910714}
confusion matrix:
     0    1
0  623   37
1  197  443
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8209607, 'precision': 0.8540418, 'recall': 0.8209607, 'specificity': 0.8209607, 'f1': 0.8166784, 'auroc': 0.9373772, 'binary_precision': 0.9622642, 'binary_recall': 0.6681223, 'binary_specificity': 0.9737991, 'binary_f1_score': 0.7886598}
confusion matrix:
     0    1
0  223    6
1   76  153
early stop counter: 20
val acc:0.8199999928474426, best validation acc: 0.8546153903007507, corresponding to test acc:                         0.8820960521697998 / 0.8864628672599792
after epoch: 24,now: 2024-07-26 10:29:44.009798,epoch time: 0:01:26.639813,used: 0:34:40.842994,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_09_55_03_seed_7_23065778
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.9892578, 'precision': 0.98928475, 'recall': 0.98922974, 'specificity': 0.98922974, 'f1': 0.9892546, 'auroc': 0.9996468, 'binary_precision': 0.9878594, 'binary_recall': 0.9910256, 'binary_specificity': 0.98743385, 'binary_f1_score': 0.98944}
confusion matrix:
      0     1
0  1493    19
1    14  1546
---- Validation: 
scalar performance:
{'acc': 0.7907692, 'precision': 0.831703, 'recall': 0.78804445, 'specificity': 0.78804445, 'f1': 0.7829988, 'auroc': 0.9131919, 'binary_precision': 0.9444444, 'binary_recall': 0.6109375, 'binary_specificity': 0.9651515, 'binary_f1_score': 0.7419355}
confusion matrix:
     0    1
0  637   23
1  249  391
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.69650656, 'precision': 0.7965297, 'recall': 0.69650656, 'specificity': 0.69650656, 'f1': 0.6685566, 'auroc': 0.93455505, 'binary_precision': 0.96875, 'binary_recall': 0.40611354, 'binary_specificity': 0.98689955, 'binary_f1_score': 0.5723077}
confusion matrix:
     0   1
0  226   3
1  136  93
early stop counter: 21
val acc:0.7907692193984985, best validation acc: 0.8546153903007507, corresponding to test acc:                         0.8820960521697998 / 0.8864628672599792
after epoch: 25,now: 2024-07-26 10:31:10.389055,epoch time: 0:01:26.379257,used: 0:36:07.222251,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_09_55_03_seed_7_23065778
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.99283856, 'precision': 0.9928112, 'recall': 0.9929182, 'specificity': 0.9929182, 'f1': 0.9928378, 'auroc': 0.99984443, 'binary_precision': 0.998057, 'binary_recall': 0.9878205, 'binary_specificity': 0.9980159, 'binary_f1_score': 0.99291235}
confusion matrix:
      0     1
0  1509     3
1    19  1541
---- Validation: 
scalar performance:
{'acc': 0.7323077, 'precision': 0.8089895, 'recall': 0.7284328, 'specificity': 0.7284328, 'f1': 0.7124033, 'auroc': 0.9082055, 'binary_precision': 0.9591195, 'binary_recall': 0.4765625, 'binary_specificity': 0.98030305, 'binary_f1_score': 0.6367432}
confusion matrix:
     0    1
0  647   13
1  335  305
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6331878, 'precision': 0.7806711, 'recall': 0.6331878, 'specificity': 0.6331878, 'f1': 0.5777134, 'auroc': 0.93619496, 'binary_precision': 0.984127, 'binary_recall': 0.27074236, 'binary_specificity': 0.9956332, 'binary_f1_score': 0.42465752}
confusion matrix:
     0   1
0  228   1
1  167  62
early stop counter: 22
val acc:0.7323076725006104, best validation acc: 0.8546153903007507, corresponding to test acc:                         0.8820960521697998 / 0.8864628672599792
after epoch: 26,now: 2024-07-26 10:32:36.998364,epoch time: 0:01:26.609309,used: 0:37:33.831560,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_09_55_03_seed_7_23065778
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.992513, 'precision': 0.99248374, 'recall': 0.992557, 'specificity': 0.992557, 'f1': 0.9925118, 'auroc': 0.99970406, 'binary_precision': 0.9954868, 'binary_recall': 0.9897436, 'binary_specificity': 0.9953704, 'binary_f1_score': 0.9926069}
confusion matrix:
      0     1
0  1505     7
1    16  1544
---- Validation: 
scalar performance:
{'acc': 0.8153846, 'precision': 0.84174854, 'recall': 0.81323385, 'specificity': 0.81323385, 'f1': 0.8110003, 'auroc': 0.8981155, 'binary_precision': 0.9329004, 'binary_recall': 0.6734375, 'binary_specificity': 0.9530303, 'binary_f1_score': 0.78221416}
confusion matrix:
     0    1
0  629   31
1  209  431
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.83842796, 'precision': 0.8651974, 'recall': 0.8384279, 'specificity': 0.8384279, 'f1': 0.8354118, 'auroc': 0.92629814, 'binary_precision': 0.96407187, 'binary_recall': 0.70305675, 'binary_specificity': 0.9737991, 'binary_f1_score': 0.81313133}
confusion matrix:
     0    1
0  223    6
1   68  161
early stop counter: 23
val acc:0.8153846263885498, best validation acc: 0.8546153903007507, corresponding to test acc:                         0.8820960521697998 / 0.8864628672599792
after epoch: 27,now: 2024-07-26 10:34:03.558705,epoch time: 0:01:26.560341,used: 0:39:00.391901,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_09_55_03_seed_7_23065778
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.99348956, 'precision': 0.9934726, 'recall': 0.99358976, 'specificity': 0.99358976, 'f1': 0.993489, 'auroc': 0.9998779, 'binary_precision': 1.0, 'binary_recall': 0.98717946, 'binary_specificity': 1.0, 'binary_f1_score': 0.99354833}
confusion matrix:
      0     1
0  1512     0
1    20  1540
---- Validation: 
scalar performance:
{'acc': 0.77307695, 'precision': 0.8328164, 'recall': 0.76979166, 'specificity': 0.76979166, 'f1': 0.76093274, 'auroc': 0.9296336, 'binary_precision': 0.97002727, 'binary_recall': 0.55625, 'binary_specificity': 0.98333335, 'binary_f1_score': 0.7070506}
confusion matrix:
     0    1
0  649   11
1  284  356
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7751092, 'precision': 0.8415483, 'recall': 0.7751092, 'specificity': 0.7751092, 'f1': 0.76361346, 'auroc': 0.95066845, 'binary_precision': 0.9921875, 'binary_recall': 0.55458516, 'binary_specificity': 0.9956332, 'binary_f1_score': 0.71148455}
confusion matrix:
     0    1
0  228    1
1  102  127
early stop counter: 24
val acc:0.7730769515037537, best validation acc: 0.8546153903007507, corresponding to test acc:                         0.8820960521697998 / 0.8864628672599792
after epoch: 28,now: 2024-07-26 10:35:30.024292,epoch time: 0:01:26.465587,used: 0:40:26.857488,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_09_55_03_seed_7_23065778
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9905599, 'precision': 0.9906564, 'recall': 0.99049145, 'specificity': 0.99049145, 'f1': 0.99055624, 'auroc': 0.99976724, 'binary_precision': 0.9866497, 'binary_recall': 0.9948718, 'binary_specificity': 0.9861111, 'binary_f1_score': 0.9907437}
confusion matrix:
      0     1
0  1491    21
1     8  1552
---- Validation: 
scalar performance:
{'acc': 0.8230769, 'precision': 0.82708484, 'recall': 0.82220644, 'specificity': 0.82220644, 'f1': 0.82222486, 'auroc': 0.89967805, 'binary_precision': 0.8596491, 'binary_recall': 0.765625, 'binary_specificity': 0.8787879, 'binary_f1_score': 0.80991733}
confusion matrix:
     0    1
0  580   80
1  150  490
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.83406115, 'precision': 0.8346994, 'recall': 0.83406115, 'specificity': 0.83406115, 'f1': 0.833982, 'auroc': 0.91754544, 'binary_precision': 0.84931505, 'binary_recall': 0.8122271, 'binary_specificity': 0.8558952, 'binary_f1_score': 0.83035713}
confusion matrix:
     0    1
0  196   33
1   43  186
early stop counter: 25
val acc:0.8230769038200378, best validation acc: 0.8546153903007507, corresponding to test acc:                         0.8820960521697998 / 0.8864628672599792
after epoch: 29,now: 2024-07-26 10:36:56.748747,epoch time: 0:01:26.724455,used: 0:41:53.581943,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_09_55_03_seed_7_23065778
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.99088544, 'precision': 0.99088544, 'recall': 0.9910053, 'specificity': 0.9910053, 'f1': 0.9908849, 'auroc': 0.99980414, 'binary_precision': 0.99869794, 'binary_recall': 0.98333335, 'binary_specificity': 0.99867725, 'binary_f1_score': 0.99095607}
confusion matrix:
      0     1
0  1510     2
1    26  1534
---- Validation: 
scalar performance:
{'acc': 0.76153845, 'precision': 0.817059, 'recall': 0.758286, 'specificity': 0.758286, 'f1': 0.7490504, 'auroc': 0.9073017, 'binary_precision': 0.9459459, 'binary_recall': 0.546875, 'binary_specificity': 0.969697, 'binary_f1_score': 0.6930693}
confusion matrix:
     0    1
0  640   20
1  290  350
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7838428, 'precision': 0.8399023, 'recall': 0.7838428, 'specificity': 0.7838428, 'f1': 0.77454686, 'auroc': 0.93798745, 'binary_precision': 0.97794116, 'binary_recall': 0.58078605, 'binary_specificity': 0.98689955, 'binary_f1_score': 0.7287671}
confusion matrix:
     0    1
0  226    3
1   96  133
early stop counter: 26
val acc:0.7615384459495544, best validation acc: 0.8546153903007507, corresponding to test acc:                         0.8820960521697998 / 0.8864628672599792
after epoch: 30,now: 2024-07-26 10:38:23.055388,epoch time: 0:01:26.306641,used: 0:43:19.888584,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_09_55_03_seed_7_23065778
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 0:43:19.888584 at 2024-07-26 10:38:23.055388
persisted model performance metric: 

scalar performance:
{'acc': 0.88209605, 'precision': 0.8870859, 'recall': 0.88209605, 'specificity': 0.88209605, 'f1': 0.8817149, 'auroc': 0.95656073, 'binary_precision': 0.84313726, 'binary_recall': 0.93886465, 'binary_specificity': 0.8253275, 'binary_f1_score': 0.8884297}
confusion matrix:
     0    1
0  189   40
1   14  215
oracle model performance metric: 

scalar performance:
{'acc': 0.88646287, 'precision': 0.89625573, 'recall': 0.88646287, 'specificity': 0.88646287, 'f1': 0.8857571, 'auroc': 0.9473885, 'binary_precision': 0.9585492, 'binary_recall': 0.80786026, 'binary_specificity': 0.9650655, 'binary_f1_score': 0.8767773}
confusion matrix:
     0    1
0  221    8
1   44  185
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_irm_10seeds_nofreeze_2024-07-26_02-28-54/rule_results/1.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_irm_10seeds_nofreeze_2024-07-26_02-28-54/confusion_matrix/1.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 455402 KiB |  13219 MiB | 584737 GiB | 584736 GiB |
|       from large pool | 414803 KiB |  13181 MiB | 577778 GiB | 577778 GiB |
|       from small pool |  40598 KiB |     60 MiB |   6958 GiB |   6958 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 455402 KiB |  13219 MiB | 584737 GiB | 584736 GiB |
|       from large pool | 414803 KiB |  13181 MiB | 577778 GiB | 577778 GiB |
|       from small pool |  40598 KiB |     60 MiB |   6958 GiB |   6958 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 447482 KiB |  13213 MiB | 583859 GiB | 583858 GiB |
|       from large pool | 407075 KiB |  13175 MiB | 576915 GiB | 576914 GiB |
|       from small pool |  40407 KiB |     60 MiB |   6944 GiB |   6944 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  14478 MiB |  14482 MiB | 109632 MiB |  95154 MiB |
|       from large pool |  14412 MiB |  14412 MiB | 109452 MiB |  95040 MiB |
|       from small pool |     66 MiB |     70 MiB |    180 MiB |    114 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 445718 KiB |   1236 MiB | 409188 GiB | 409188 GiB |
|       from large pool | 435116 KiB |   1229 MiB | 402186 GiB | 402185 GiB |
|       from small pool |  10601 KiB |     44 MiB |   7002 GiB |   7002 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    1310    |    2598    |  103443 K  |  103442 K  |
|       from large pool |     187    |    1413    |   52595 K  |   52594 K  |
|       from small pool |    1123    |    1419    |   50848 K  |   50847 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    1310    |    2598    |  103443 K  |  103442 K  |
|       from large pool |     187    |    1413    |   52595 K  |   52594 K  |
|       from small pool |    1123    |    1419    |   50848 K  |   50847 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     635    |     637    |    4645    |    4010    |
|       from large pool |     602    |     602    |    4555    |    3953    |
|       from small pool |      33    |      35    |      90    |      57    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      97    |     652    |   70074 K  |   70074 K  |
|       from large pool |      38    |     605    |   40374 K  |   40374 K  |
|       from small pool |      59    |     237    |   29700 K  |   29700 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13219 MiB | 584737 GiB | 584737 GiB |
|       from large pool |  16640 KiB |  13181 MiB | 577778 GiB | 577778 GiB |
|       from small pool |      0 KiB |     60 MiB |   6958 GiB |   6958 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13219 MiB | 584737 GiB | 584737 GiB |
|       from large pool |  16640 KiB |  13181 MiB | 577778 GiB | 577778 GiB |
|       from small pool |      0 KiB |     60 MiB |   6958 GiB |   6958 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13213 MiB | 583859 GiB | 583859 GiB |
|       from large pool |  16640 KiB |  13175 MiB | 576915 GiB | 576915 GiB |
|       from small pool |      0 KiB |     60 MiB |   6944 GiB |   6944 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    880 MiB |  14482 MiB | 109632 MiB | 108752 MiB |
|       from large pool |    830 MiB |  14412 MiB | 109452 MiB | 108622 MiB |
|       from small pool |     50 MiB |     70 MiB |    180 MiB |    130 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1236 MiB | 409189 GiB | 409189 GiB |
|       from large pool |  24320 KiB |   1229 MiB | 402186 GiB | 402186 GiB |
|       from small pool |      0 KiB |     44 MiB |   7002 GiB |   7002 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    2598    |  103443 K  |  103443 K  |
|       from large pool |       2    |    1413    |   52595 K  |   52595 K  |
|       from small pool |       0    |    1419    |   50848 K  |   50848 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    2598    |  103443 K  |  103443 K  |
|       from large pool |       2    |    1413    |   52595 K  |   52595 K  |
|       from small pool |       0    |    1419    |   50848 K  |   50848 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      62    |     637    |    4645    |    4583    |
|       from large pool |      37    |     602    |    4555    |    4518    |
|       from small pool |      25    |      35    |      90    |      65    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |     652    |   70075 K  |   70075 K  |
|       from large pool |       4    |     605    |   40374 K  |   40374 K  |
|       from small pool |       0    |     237    |   29700 K  |   29700 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13219 MiB | 584737 GiB | 584737 GiB |
|       from large pool |  16640 KiB |  13181 MiB | 577778 GiB | 577778 GiB |
|       from small pool |      0 KiB |     60 MiB |   6958 GiB |   6958 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13219 MiB | 584737 GiB | 584737 GiB |
|       from large pool |  16640 KiB |  13181 MiB | 577778 GiB | 577778 GiB |
|       from small pool |      0 KiB |     60 MiB |   6958 GiB |   6958 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13213 MiB | 583859 GiB | 583859 GiB |
|       from large pool |  16640 KiB |  13175 MiB | 576915 GiB | 576915 GiB |
|       from small pool |      0 KiB |     60 MiB |   6944 GiB |   6944 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    880 MiB |  14482 MiB | 109632 MiB | 108752 MiB |
|       from large pool |    830 MiB |  14412 MiB | 109452 MiB | 108622 MiB |
|       from small pool |     50 MiB |     70 MiB |    180 MiB |    130 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1236 MiB | 409189 GiB | 409189 GiB |
|       from large pool |  24320 KiB |   1229 MiB | 402186 GiB | 402186 GiB |
|       from small pool |      0 KiB |     44 MiB |   7002 GiB |   7002 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    2598    |  103443 K  |  103443 K  |
|       from large pool |       2    |    1413    |   52595 K  |   52595 K  |
|       from small pool |       0    |    1419    |   50848 K  |   50848 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    2598    |  103443 K  |  103443 K  |
|       from large pool |       2    |    1413    |   52595 K  |   52595 K  |
|       from small pool |       0    |    1419    |   50848 K  |   50848 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      62    |     637    |    4645    |    4583    |
|       from large pool |      37    |     602    |    4555    |    4518    |
|       from small pool |      25    |      35    |      90    |      65    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |     652    |   70075 K  |   70075 K  |
|       from large pool |       4    |     605    |   40374 K  |   40374 K  |
|       from small pool |       0    |     237    |   29700 K  |   29700 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'888c1ef2'
model name: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_10_38_57_seed_8_23065778

 Experiment start at: 2024-07-26 10:38:57.480695
before training, model accuracy: 0.4931192398071289
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9546053, 'precision': 0.95463574, 'recall': 0.9546924, 'specificity': 0.9546924, 'f1': 0.9546046, 'auroc': 0.99248815, 'binary_precision': 0.9623514, 'binary_recall': 0.94733423, 'binary_specificity': 0.9620506, 'binary_f1_score': 0.9547838}
confusion matrix:
      0     1
0  1445    57
1    81  1457
---- Validation: 
scalar performance:
{'acc': 0.84841454, 'precision': 0.84969985, 'recall': 0.84737825, 'specificity': 0.84737825, 'f1': 0.84787506, 'auroc': 0.91672933, 'binary_precision': 0.86440676, 'binary_recall': 0.8146965, 'binary_specificity': 0.88005996, 'binary_f1_score': 0.8388158}
confusion matrix:
     0    1
0  587   80
1  116  510
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.85091746, 'precision': 0.85258675, 'recall': 0.85091746, 'specificity': 0.85091746, 'f1': 0.8507408, 'auroc': 0.9180414, 'binary_precision': 0.87684727, 'binary_recall': 0.8165138, 'binary_specificity': 0.8853211, 'binary_f1_score': 0.84560573}
confusion matrix:
     0    1
0  193   25
1   40  178
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-26 10:40:29.902848,epoch time: 0:01:32.422153,used: 0:01:32.422153,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_10_38_57_seed_8_23065778
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.95625, 'precision': 0.9570802, 'recall': 0.9560088, 'specificity': 0.9560088, 'f1': 0.9562072, 'auroc': 0.99419796, 'binary_precision': 0.9404762, 'binary_recall': 0.97530866, 'binary_specificity': 0.93670887, 'binary_f1_score': 0.95757574}
confusion matrix:
      0     1
0  1406    95
1    38  1501
---- Validation: 
scalar performance:
{'acc': 0.8097448, 'precision': 0.8173928, 'recall': 0.81215537, 'specificity': 0.81215537, 'f1': 0.8092627, 'auroc': 0.89326584, 'binary_precision': 0.75956285, 'binary_recall': 0.8881789, 'binary_specificity': 0.7361319, 'binary_f1_score': 0.8188512}
confusion matrix:
     0    1
0  491  176
1   70  556
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8486239, 'precision': 0.851583, 'recall': 0.8486239, 'specificity': 0.8486239, 'f1': 0.8483046, 'auroc': 0.92889905, 'binary_precision': 0.8193277, 'binary_recall': 0.8944954, 'binary_specificity': 0.8027523, 'binary_f1_score': 0.8552632}
confusion matrix:
     0    1
0  175   43
1   23  195
early stop counter: 1
val acc:0.8097447752952576, best validation acc: 0.8484145402908325, corresponding to test acc:                         0.8509174585342407 / 0.8509174585342407
after epoch: 2,now: 2024-07-26 10:41:56.150132,epoch time: 0:01:26.247284,used: 0:02:58.669437,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_10_38_57_seed_8_23065778
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.93519735, 'precision': 0.94259953, 'recall': 0.93445194, 'specificity': 0.93445194, 'f1': 0.93484044, 'auroc': 0.9972425, 'binary_precision': 0.8882455, 'binary_recall': 0.9973992, 'binary_specificity': 0.87150466, 'binary_f1_score': 0.9396631}
confusion matrix:
      0     1
0  1309   193
1     4  1534
---- Validation: 
scalar performance:
{'acc': 0.76411444, 'precision': 0.7918465, 'recall': 0.76886034, 'specificity': 0.76886034, 'f1': 0.7603526, 'auroc': 0.8655249, 'binary_precision': 0.69360673, 'binary_recall': 0.91853034, 'binary_specificity': 0.6191904, 'binary_f1_score': 0.79037803}
confusion matrix:
     0    1
0  413  254
1   51  575
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7408257, 'precision': 0.78899324, 'recall': 0.7408257, 'specificity': 0.7408257, 'f1': 0.7295568, 'auroc': 0.9093721, 'binary_precision': 0.6710098, 'binary_recall': 0.94495416, 'binary_specificity': 0.53669727, 'binary_f1_score': 0.78476197}
confusion matrix:
     0    1
0  117  101
1   12  206
early stop counter: 2
val acc:0.7641144394874573, best validation acc: 0.8484145402908325, corresponding to test acc:                         0.8509174585342407 / 0.8509174585342407
after epoch: 3,now: 2024-07-26 10:43:22.084718,epoch time: 0:01:25.934586,used: 0:04:24.604023,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_10_38_57_seed_8_23065778
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9694079, 'precision': 0.9695872, 'recall': 0.96954757, 'specificity': 0.96954757, 'f1': 0.9694078, 'auroc': 0.9968461, 'binary_precision': 0.981976, 'binary_recall': 0.9570592, 'binary_specificity': 0.98203593, 'binary_f1_score': 0.9693575}
confusion matrix:
      0     1
0  1476    27
1    66  1471
---- Validation: 
scalar performance:
{'acc': 0.79350346, 'precision': 0.8074785, 'recall': 0.7899816, 'specificity': 0.7899816, 'f1': 0.78960526, 'auroc': 0.8876664, 'binary_precision': 0.86558044, 'binary_recall': 0.6789137, 'binary_specificity': 0.9010495, 'binary_f1_score': 0.76096684}
confusion matrix:
     0    1
0  601   66
1  201  425
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.82798165, 'precision': 0.8323525, 'recall': 0.82798165, 'specificity': 0.82798165, 'f1': 0.8274142, 'auroc': 0.90813065, 'binary_precision': 0.8704663, 'binary_recall': 0.7706422, 'binary_specificity': 0.8853211, 'binary_f1_score': 0.81751823}
confusion matrix:
     0    1
0  193   25
1   50  168
early stop counter: 3
val acc:0.79350346326828, best validation acc: 0.8484145402908325, corresponding to test acc:                         0.8509174585342407 / 0.8509174585342407
after epoch: 4,now: 2024-07-26 10:44:48.180807,epoch time: 0:01:26.096089,used: 0:05:50.700112,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_10_38_57_seed_8_23065778
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.98059213, 'precision': 0.9809637, 'recall': 0.9804609, 'specificity': 0.9804609, 'f1': 0.9805821, 'auroc': 0.9986572, 'binary_precision': 0.9701018, 'binary_recall': 0.99219257, 'binary_specificity': 0.9687292, 'binary_f1_score': 0.98102283}
confusion matrix:
      0     1
0  1456    47
1    12  1525
---- Validation: 
scalar performance:
{'acc': 0.8159319, 'precision': 0.8214997, 'recall': 0.8137337, 'specificity': 0.8137337, 'f1': 0.8142511, 'auroc': 0.8985252, 'binary_precision': 0.8566176, 'binary_recall': 0.74440897, 'binary_specificity': 0.8830585, 'binary_f1_score': 0.79658127}
confusion matrix:
     0    1
0  589   78
1  160  466
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8348624, 'precision': 0.8389708, 'recall': 0.83486235, 'specificity': 0.83486235, 'f1': 0.8343605, 'auroc': 0.9131807, 'binary_precision': 0.87628865, 'binary_recall': 0.7798165, 'binary_specificity': 0.88990825, 'binary_f1_score': 0.8252427}
confusion matrix:
     0    1
0  194   24
1   48  170
early stop counter: 4
val acc:0.8159319162368774, best validation acc: 0.8484145402908325, corresponding to test acc:                         0.8509174585342407 / 0.8509174585342407
after epoch: 5,now: 2024-07-26 10:46:14.125493,epoch time: 0:01:25.944686,used: 0:07:16.644798,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_10_38_57_seed_8_23065778
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.97598684, 'precision': 0.9765481, 'recall': 0.97620827, 'specificity': 0.97620827, 'f1': 0.97598493, 'auroc': 0.99912906, 'binary_precision': 0.99593496, 'binary_recall': 0.95640856, 'binary_specificity': 0.996008, 'binary_f1_score': 0.97577167}
confusion matrix:
      0     1
0  1497     6
1    67  1470
---- Validation: 
scalar performance:
{'acc': 0.63805103, 'precision': 0.75091535, 'recall': 0.62703276, 'specificity': 0.62703276, 'f1': 0.5815835, 'auroc': 0.88773346, 'binary_precision': 0.9114583, 'binary_recall': 0.27955273, 'binary_specificity': 0.97451276, 'binary_f1_score': 0.42787284}
confusion matrix:
     0    1
0  650   17
1  451  175
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7844037, 'precision': 0.8397687, 'recall': 0.7844037, 'specificity': 0.7844037, 'f1': 0.77524793, 'auroc': 0.9238069, 'binary_precision': 0.97692305, 'binary_recall': 0.5825688, 'binary_specificity': 0.98623854, 'binary_f1_score': 0.7298851}
confusion matrix:
     0    1
0  215    3
1   91  127
early stop counter: 5
val acc:0.6380510330200195, best validation acc: 0.8484145402908325, corresponding to test acc:                         0.8509174585342407 / 0.8509174585342407
after epoch: 6,now: 2024-07-26 10:47:40.154704,epoch time: 0:01:26.029211,used: 0:08:42.674009,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_10_38_57_seed_8_23065778
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9819079, 'precision': 0.9818903, 'recall': 0.98193264, 'specificity': 0.98193264, 'f1': 0.9819063, 'auroc': 0.9990585, 'binary_precision': 0.984324, 'binary_recall': 0.979844, 'binary_specificity': 0.9840213, 'binary_f1_score': 0.98207885}
confusion matrix:
      0     1
0  1478    24
1    31  1507
---- Validation: 
scalar performance:
{'acc': 0.8012374, 'precision': 0.8322345, 'recall': 0.7962995, 'specificity': 0.7962995, 'f1': 0.79450715, 'auroc': 0.92121565, 'binary_precision': 0.926097, 'binary_recall': 0.64057505, 'binary_specificity': 0.952024, 'binary_f1_score': 0.75731814}
confusion matrix:
     0    1
0  635   32
1  225  401
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8394495, 'precision': 0.85526776, 'recall': 0.8394495, 'specificity': 0.8394495, 'f1': 0.8376423, 'auroc': 0.9272578, 'binary_precision': 0.9302326, 'binary_recall': 0.73394495, 'binary_specificity': 0.94495416, 'binary_f1_score': 0.82051283}
confusion matrix:
     0    1
0  206   12
1   58  160
early stop counter: 6
val acc:0.8012374043464661, best validation acc: 0.8484145402908325, corresponding to test acc:                         0.8509174585342407 / 0.8509174585342407
after epoch: 7,now: 2024-07-26 10:49:06.227054,epoch time: 0:01:26.072350,used: 0:10:08.746359,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_10_38_57_seed_8_23065778
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9858553, 'precision': 0.9859823, 'recall': 0.98598963, 'specificity': 0.98598963, 'f1': 0.9858553, 'auroc': 0.99929094, 'binary_precision': 0.99733865, 'binary_recall': 0.9746424, 'binary_specificity': 0.99733686, 'binary_f1_score': 0.98585993}
confusion matrix:
      0     1
0  1498     4
1    39  1499
---- Validation: 
scalar performance:
{'acc': 0.8174787, 'precision': 0.84130824, 'recall': 0.81321996, 'specificity': 0.81321996, 'f1': 0.8126777, 'auroc': 0.9233898, 'binary_precision': 0.92391306, 'binary_recall': 0.6789137, 'binary_specificity': 0.9475262, 'binary_f1_score': 0.7826887}
confusion matrix:
     0    1
0  632   35
1  201  425
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.83715594, 'precision': 0.85667694, 'recall': 0.83715594, 'specificity': 0.83715594, 'f1': 0.8348969, 'auroc': 0.919851, 'binary_precision': 0.94011974, 'binary_recall': 0.7201835, 'binary_specificity': 0.95412844, 'binary_f1_score': 0.81558436}
confusion matrix:
     0    1
0  208   10
1   61  157
early stop counter: 7
val acc:0.8174787163734436, best validation acc: 0.8484145402908325, corresponding to test acc:                         0.8509174585342407 / 0.8509174585342407
after epoch: 8,now: 2024-07-26 10:50:32.346842,epoch time: 0:01:26.119788,used: 0:11:34.866147,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_10_38_57_seed_8_23065778
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.96907896, 'precision': 0.97051835, 'recall': 0.9693941, 'specificity': 0.9693941, 'f1': 0.9690669, 'auroc': 0.99948186, 'binary_precision': 0.99930745, 'binary_recall': 0.9394531, 'binary_specificity': 0.9993351, 'binary_f1_score': 0.9684564}
confusion matrix:
      0     1
0  1503     1
1    93  1443
---- Validation: 
scalar performance:
{'acc': 0.76334107, 'precision': 0.8288182, 'recall': 0.7561311, 'specificity': 0.7561311, 'f1': 0.747381, 'auroc': 0.92189705, 'binary_precision': 0.96783626, 'binary_recall': 0.528754, 'binary_specificity': 0.9835082, 'binary_f1_score': 0.6838843}
confusion matrix:
     0    1
0  656   11
1  295  331
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6766055, 'precision': 0.7717676, 'recall': 0.6766055, 'specificity': 0.6766055, 'f1': 0.6455795, 'auroc': 0.90400636, 'binary_precision': 0.9325843, 'binary_recall': 0.38073394, 'binary_specificity': 0.9724771, 'binary_f1_score': 0.5407166}
confusion matrix:
     0   1
0  212   6
1  135  83
early stop counter: 8
val acc:0.7633410692214966, best validation acc: 0.8484145402908325, corresponding to test acc:                         0.8509174585342407 / 0.8509174585342407
after epoch: 9,now: 2024-07-26 10:51:58.238415,epoch time: 0:01:25.891573,used: 0:13:00.757720,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_10_38_57_seed_8_23065778
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.98815787, 'precision': 0.98814374, 'recall': 0.98817253, 'specificity': 0.98817253, 'f1': 0.98815644, 'auroc': 0.99944806, 'binary_precision': 0.9895765, 'binary_recall': 0.9870046, 'binary_specificity': 0.9893404, 'binary_f1_score': 0.9882889}
confusion matrix:
      0     1
0  1485    16
1    20  1519
---- Validation: 
scalar performance:
{'acc': 0.80046403, 'precision': 0.83243555, 'recall': 0.7954517, 'specificity': 0.7954517, 'f1': 0.79352725, 'auroc': 0.91361344, 'binary_precision': 0.927907, 'binary_recall': 0.6373802, 'binary_specificity': 0.9535232, 'binary_f1_score': 0.7556819}
confusion matrix:
     0    1
0  636   31
1  227  399
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7821101, 'precision': 0.8448746, 'recall': 0.7821101, 'specificity': 0.7821101, 'f1': 0.771724, 'auroc': 0.92662656, 'binary_precision': 0.992, 'binary_recall': 0.56880736, 'binary_specificity': 0.9954128, 'binary_f1_score': 0.7230321}
confusion matrix:
     0    1
0  217    1
1   94  124
early stop counter: 9
val acc:0.8004640340805054, best validation acc: 0.8484145402908325, corresponding to test acc:                         0.8509174585342407 / 0.8509174585342407
after epoch: 10,now: 2024-07-26 10:53:24.229541,epoch time: 0:01:25.991126,used: 0:14:26.748846,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_10_38_57_seed_8_23065778
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9769737, 'precision': 0.97786117, 'recall': 0.9767574, 'specificity': 0.9767574, 'f1': 0.97695255, 'auroc': 0.9991524, 'binary_precision': 0.95987463, 'binary_recall': 0.9960963, 'binary_specificity': 0.9574185, 'binary_f1_score': 0.97765005}
confusion matrix:
      0     1
0  1439    64
1     6  1531
---- Validation: 
scalar performance:
{'acc': 0.8422274, 'precision': 0.84568393, 'recall': 0.84383607, 'specificity': 0.84383607, 'f1': 0.8421366, 'auroc': 0.9133022, 'binary_precision': 0.8022923, 'binary_recall': 0.8945687, 'binary_specificity': 0.79310346, 'binary_f1_score': 0.8459214}
confusion matrix:
     0    1
0  529  138
1   66  560
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.78899086, 'precision': 0.7980469, 'recall': 0.78899086, 'specificity': 0.78899086, 'f1': 0.7873757, 'auroc': 0.8866888, 'binary_precision': 0.74609375, 'binary_recall': 0.8761468, 'binary_specificity': 0.70183486, 'binary_f1_score': 0.8059072}
confusion matrix:
     0    1
0  153   65
1   27  191
early stop counter: 10
val acc:0.8422273993492126, best validation acc: 0.8484145402908325, corresponding to test acc:                         0.8509174585342407 / 0.8509174585342407
after epoch: 11,now: 2024-07-26 10:54:50.424660,epoch time: 0:01:26.195119,used: 0:15:52.943965,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_10_38_57_seed_8_23065778
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9799342, 'precision': 0.9804435, 'recall': 0.98016125, 'specificity': 0.98016125, 'f1': 0.979933, 'auroc': 0.9995706, 'binary_precision': 0.99932384, 'binary_recall': 0.9609883, 'binary_specificity': 0.9993342, 'binary_f1_score': 0.97978127}
confusion matrix:
      0     1
0  1501     1
1    60  1478
---- Validation: 
scalar performance:
{'acc': 0.61098224, 'precision': 0.76318365, 'recall': 0.5985374, 'specificity': 0.5985374, 'f1': 0.5317056, 'auroc': 0.9243741, 'binary_precision': 0.95555556, 'binary_recall': 0.20607029, 'binary_specificity': 0.9910045, 'binary_f1_score': 0.33902758}
confusion matrix:
     0    1
0  661    6
1  497  129
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.55733943, 'precision': 0.7652068, 'recall': 0.55733943, 'specificity': 0.55733943, 'f1': 0.44946253, 'auroc': 0.9307034, 'binary_precision': 1.0, 'binary_recall': 0.1146789, 'binary_specificity': 1.0, 'binary_f1_score': 0.20576131}
confusion matrix:
     0   1
0  218   0
1  193  25
early stop counter: 11
val acc:0.6109822392463684, best validation acc: 0.8484145402908325, corresponding to test acc:                         0.8509174585342407 / 0.8509174585342407
after epoch: 12,now: 2024-07-26 10:56:16.235170,epoch time: 0:01:25.810510,used: 0:17:18.754475,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_10_38_57_seed_8_23065778
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9726974, 'precision': 0.97383356, 'recall': 0.97299933, 'specificity': 0.97299933, 'f1': 0.9726902, 'auroc': 0.99940306, 'binary_precision': 1.0, 'binary_recall': 0.9459987, 'binary_specificity': 1.0, 'binary_f1_score': 0.9722501}
confusion matrix:
      0     1
0  1503     0
1    83  1454
---- Validation: 
scalar performance:
{'acc': 0.8074246, 'precision': 0.8486528, 'recall': 0.8019037, 'specificity': 0.8019037, 'f1': 0.7994393, 'auroc': 0.94127774, 'binary_precision': 0.9608802, 'binary_recall': 0.6277955, 'binary_specificity': 0.976012, 'binary_f1_score': 0.75942034}
confusion matrix:
     0    1
0  651   16
1  233  393
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7224771, 'precision': 0.8215339, 'recall': 0.7224771, 'specificity': 0.7224771, 'f1': 0.6993189, 'auroc': 0.940367, 'binary_precision': 1.0, 'binary_recall': 0.44495413, 'binary_specificity': 1.0, 'binary_f1_score': 0.615873}
confusion matrix:
     0   1
0  218   0
1  121  97
early stop counter: 12
val acc:0.8074246048927307, best validation acc: 0.8484145402908325, corresponding to test acc:                         0.8509174585342407 / 0.8509174585342407
after epoch: 13,now: 2024-07-26 10:57:41.985546,epoch time: 0:01:25.750376,used: 0:18:44.504851,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_10_38_57_seed_8_23065778
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9914474, 'precision': 0.9914646, 'recall': 0.9914306, 'specificity': 0.9914306, 'f1': 0.9914459, 'auroc': 0.9996814, 'binary_precision': 0.9902724, 'binary_recall': 0.99284786, 'binary_specificity': 0.9900133, 'binary_f1_score': 0.9915585}
confusion matrix:
      0     1
0  1487    15
1    11  1527
---- Validation: 
scalar performance:
{'acc': 0.84764117, 'precision': 0.854494, 'recall': 0.84540117, 'specificity': 0.84540117, 'f1': 0.84618044, 'auroc': 0.92689836, 'binary_precision': 0.896488, 'binary_recall': 0.77476037, 'binary_specificity': 0.916042, 'binary_f1_score': 0.83119106}
confusion matrix:
     0    1
0  611   56
1  141  485
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8348624, 'precision': 0.8377048, 'recall': 0.8348624, 'specificity': 0.8348624, 'f1': 0.83451426, 'auroc': 0.914843, 'binary_precision': 0.86868685, 'binary_recall': 0.78899086, 'binary_specificity': 0.88073397, 'binary_f1_score': 0.82692313}
confusion matrix:
     0    1
0  192   26
1   46  172
early stop counter: 13
val acc:0.8476411700248718, best validation acc: 0.8484145402908325, corresponding to test acc:                         0.8509174585342407 / 0.8509174585342407
after epoch: 14,now: 2024-07-26 10:59:08.106328,epoch time: 0:01:26.120782,used: 0:20:10.625633,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_10_38_57_seed_8_23065778
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9888158, 'precision': 0.9888076, 'recall': 0.988822, 'specificity': 0.988822, 'f1': 0.9888144, 'auroc': 0.9995026, 'binary_precision': 0.9895833, 'binary_recall': 0.9882965, 'binary_specificity': 0.9893475, 'binary_f1_score': 0.9889395}
confusion matrix:
      0     1
0  1486    16
1    18  1520
---- Validation: 
scalar performance:
{'acc': 0.80510443, 'precision': 0.83148646, 'recall': 0.80053866, 'specificity': 0.80053866, 'f1': 0.79934824, 'auroc': 0.9100354, 'binary_precision': 0.91741073, 'binary_recall': 0.6565495, 'binary_specificity': 0.94452775, 'binary_f1_score': 0.7653631}
confusion matrix:
     0    1
0  630   37
1  215  411
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.78899086, 'precision': 0.8001311, 'recall': 0.78899086, 'specificity': 0.78899086, 'f1': 0.78701437, 'auroc': 0.8673513, 'binary_precision': 0.85795456, 'binary_recall': 0.69266057, 'binary_specificity': 0.8853211, 'binary_f1_score': 0.7664975}
confusion matrix:
     0    1
0  193   25
1   67  151
early stop counter: 14
val acc:0.8051044344902039, best validation acc: 0.8484145402908325, corresponding to test acc:                         0.8509174585342407 / 0.8509174585342407
after epoch: 15,now: 2024-07-26 11:00:34.218378,epoch time: 0:01:26.112050,used: 0:21:36.737683,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_10_38_57_seed_8_23065778
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9875, 'precision': 0.9875361, 'recall': 0.98758674, 'specificity': 0.98758674, 'f1': 0.98749995, 'auroc': 0.99963856, 'binary_precision': 0.9953734, 'binary_recall': 0.97983086, 'binary_specificity': 0.9953427, 'binary_f1_score': 0.9875411}
confusion matrix:
      0     1
0  1496     7
1    31  1506
---- Validation: 
scalar performance:
{'acc': 0.6550657, 'precision': 0.78223175, 'recall': 0.64411366, 'specificity': 0.64411366, 'f1': 0.6017747, 'auroc': 0.91549647, 'binary_precision': 0.96391755, 'binary_recall': 0.29872206, 'binary_specificity': 0.98950523, 'binary_f1_score': 0.45609754}
confusion matrix:
     0    1
0  660    7
1  439  187
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6766055, 'precision': 0.8036212, 'recall': 0.6766055, 'specificity': 0.6766055, 'f1': 0.6388332, 'auroc': 0.909451, 'binary_precision': 1.0, 'binary_recall': 0.35321102, 'binary_specificity': 1.0, 'binary_f1_score': 0.5220339}
confusion matrix:
     0   1
0  218   0
1  141  77
early stop counter: 15
val acc:0.6550657153129578, best validation acc: 0.8484145402908325, corresponding to test acc:                         0.8509174585342407 / 0.8509174585342407
after epoch: 16,now: 2024-07-26 11:02:00.214465,epoch time: 0:01:25.996087,used: 0:23:02.733770,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_10_38_57_seed_8_23065778
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.98980266, 'precision': 0.98994505, 'recall': 0.98973143, 'specificity': 0.98973143, 'f1': 0.9897995, 'auroc': 0.9997771, 'binary_precision': 0.98393315, 'binary_recall': 0.9960963, 'binary_specificity': 0.9833666, 'binary_f1_score': 0.98997736}
confusion matrix:
      0     1
0  1478    25
1     6  1531
---- Validation: 
scalar performance:
{'acc': 0.84841454, 'precision': 0.8542216, 'recall': 0.8463472, 'specificity': 0.8463472, 'f1': 0.84711957, 'auroc': 0.9224342, 'binary_precision': 0.8923358, 'binary_recall': 0.78115016, 'binary_specificity': 0.9115442, 'binary_f1_score': 0.8330494}
confusion matrix:
     0    1
0  608   59
1  137  489
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8233945, 'precision': 0.83915925, 'recall': 0.8233945, 'specificity': 0.8233945, 'f1': 0.82131815, 'auroc': 0.90272284, 'binary_precision': 0.9122807, 'binary_recall': 0.7155963, 'binary_specificity': 0.93119264, 'binary_f1_score': 0.80205655}
confusion matrix:
     0    1
0  203   15
1   62  156
early stop counter: 16
val acc:0.8484145402908325, best validation acc: 0.8484145402908325, corresponding to test acc:                         0.8509174585342407 / 0.8509174585342407
after epoch: 17,now: 2024-07-26 11:03:26.430913,epoch time: 0:01:26.216448,used: 0:24:28.950218,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_10_38_57_seed_8_23065778
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.98914474, 'precision': 0.9891695, 'recall': 0.9892328, 'specificity': 0.9892328, 'f1': 0.98914456, 'auroc': 0.9991139, 'binary_precision': 0.9966997, 'binary_recall': 0.98179454, 'binary_specificity': 0.9966711, 'binary_f1_score': 0.989191}
confusion matrix:
      0     1
0  1497     5
1    28  1510
---- Validation: 
scalar performance:
{'acc': 0.74555296, 'precision': 0.82080495, 'recall': 0.7377114, 'specificity': 0.7377114, 'f1': 0.725435, 'auroc': 0.9069644, 'binary_precision': 0.96845424, 'binary_recall': 0.49041533, 'binary_specificity': 0.9850075, 'binary_f1_score': 0.65111345}
confusion matrix:
     0    1
0  657   10
1  319  307
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5206422, 'precision': 0.5954745, 'recall': 0.52064216, 'specificity': 0.52064216, 'f1': 0.4038221, 'auroc': 0.8596288, 'binary_precision': 0.68, 'binary_recall': 0.07798165, 'binary_specificity': 0.96330273, 'binary_f1_score': 0.13991769}
confusion matrix:
     0   1
0  210   8
1  201  17
early stop counter: 17
val acc:0.7455529570579529, best validation acc: 0.8484145402908325, corresponding to test acc:                         0.8509174585342407 / 0.8509174585342407
after epoch: 18,now: 2024-07-26 11:04:52.481099,epoch time: 0:01:26.050186,used: 0:25:55.000404,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_10_38_57_seed_8_23065778
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9888158, 'precision': 0.98886603, 'recall': 0.9889101, 'specificity': 0.9889101, 'f1': 0.98881567, 'auroc': 0.9995935, 'binary_precision': 0.9973527, 'binary_recall': 0.98048145, 'binary_specificity': 0.99733865, 'binary_f1_score': 0.9888451}
confusion matrix:
      0     1
0  1499     4
1    30  1507
---- Validation: 
scalar performance:
{'acc': 0.6914153, 'precision': 0.78709626, 'recall': 0.6819973, 'specificity': 0.6819973, 'f1': 0.65654397, 'auroc': 0.9028984, 'binary_precision': 0.94509804, 'binary_recall': 0.38498402, 'binary_specificity': 0.9790105, 'binary_f1_score': 0.54710555}
confusion matrix:
     0    1
0  653   14
1  385  241
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6788991, 'precision': 0.7824584, 'recall': 0.67889905, 'specificity': 0.67889905, 'f1': 0.64649737, 'auroc': 0.8942219, 'binary_precision': 0.95348835, 'binary_recall': 0.3761468, 'binary_specificity': 0.98165137, 'binary_f1_score': 0.53947365}
confusion matrix:
     0   1
0  214   4
1  136  82
early stop counter: 18
val acc:0.6914153099060059, best validation acc: 0.8484145402908325, corresponding to test acc:                         0.8509174585342407 / 0.8509174585342407
after epoch: 19,now: 2024-07-26 11:06:18.411319,epoch time: 0:01:25.930220,used: 0:27:20.930624,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_10_38_57_seed_8_23065778
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9917763, 'precision': 0.9917804, 'recall': 0.9918492, 'specificity': 0.9918492, 'f1': 0.99177605, 'auroc': 0.9996619, 'binary_precision': 0.998025, 'binary_recall': 0.9856957, 'binary_specificity': 0.99800265, 'binary_f1_score': 0.991822}
confusion matrix:
      0     1
0  1499     3
1    22  1516
---- Validation: 
scalar performance:
{'acc': 0.7679814, 'precision': 0.82165277, 'recall': 0.7613653, 'specificity': 0.7613653, 'f1': 0.7546874, 'auroc': 0.92769885, 'binary_precision': 0.9453552, 'binary_recall': 0.55271566, 'binary_specificity': 0.970015, 'binary_f1_score': 0.69758064}
confusion matrix:
     0    1
0  647   20
1  280  346
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.71100914, 'precision': 0.78308487, 'recall': 0.71100914, 'specificity': 0.71100914, 'f1': 0.6913638, 'auroc': 0.8916757, 'binary_precision': 0.9259259, 'binary_recall': 0.4587156, 'binary_specificity': 0.96330273, 'binary_f1_score': 0.6134969}
confusion matrix:
     0    1
0  210    8
1  118  100
early stop counter: 19
val acc:0.7679814100265503, best validation acc: 0.8484145402908325, corresponding to test acc:                         0.8509174585342407 / 0.8509174585342407
after epoch: 20,now: 2024-07-26 11:07:44.553946,epoch time: 0:01:26.142627,used: 0:28:47.073251,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_10_38_57_seed_8_23065778
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9917763, 'precision': 0.99178994, 'recall': 0.99185693, 'specificity': 0.99185693, 'f1': 0.9917761, 'auroc': 0.9998243, 'binary_precision': 0.9986816, 'binary_recall': 0.9850455, 'binary_specificity': 0.99866843, 'binary_f1_score': 0.9918167}
confusion matrix:
      0     1
0  1500     2
1    23  1515
---- Validation: 
scalar performance:
{'acc': 0.76643467, 'precision': 0.8259914, 'recall': 0.7595224, 'specificity': 0.7595224, 'f1': 0.75189596, 'auroc': 0.9185537, 'binary_precision': 0.9576271, 'binary_recall': 0.5415335, 'binary_specificity': 0.9775112, 'binary_f1_score': 0.6918367}
confusion matrix:
     0    1
0  652   15
1  287  339
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.70642203, 'precision': 0.7919643, 'recall': 0.706422, 'specificity': 0.706422, 'f1': 0.68321866, 'auroc': 0.89927197, 'binary_precision': 0.95, 'binary_recall': 0.4357798, 'binary_specificity': 0.9770642, 'binary_f1_score': 0.59748423}
confusion matrix:
     0   1
0  213   5
1  123  95
early stop counter: 20
val acc:0.7664346694946289, best validation acc: 0.8484145402908325, corresponding to test acc:                         0.8509174585342407 / 0.8509174585342407
after epoch: 21,now: 2024-07-26 11:09:10.604082,epoch time: 0:01:26.050136,used: 0:30:13.123387,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_10_38_57_seed_8_23065778
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9944079, 'precision': 0.99439454, 'recall': 0.9944256, 'specificity': 0.9944256, 'f1': 0.9944074, 'auroc': 0.9998957, 'binary_precision': 0.99608356, 'binary_recall': 0.9928432, 'binary_specificity': 0.996008, 'binary_f1_score': 0.9944607}
confusion matrix:
      0     1
0  1497     6
1    11  1526
---- Validation: 
scalar performance:
{'acc': 0.76566124, 'precision': 0.8108355, 'recall': 0.75946015, 'specificity': 0.75946015, 'f1': 0.75378287, 'auroc': 0.9013896, 'binary_precision': 0.92167103, 'binary_recall': 0.5638978, 'binary_specificity': 0.9550225, 'binary_f1_score': 0.6997027}
confusion matrix:
     0    1
0  637   30
1  273  353
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.80504584, 'precision': 0.8485275, 'recall': 0.80504584, 'specificity': 0.80504584, 'f1': 0.7987696, 'auroc': 0.9303931, 'binary_precision': 0.9716312, 'binary_recall': 0.6284404, 'binary_specificity': 0.98165137, 'binary_f1_score': 0.76323116}
confusion matrix:
     0    1
0  214    4
1   81  137
early stop counter: 21
val acc:0.7656612396240234, best validation acc: 0.8484145402908325, corresponding to test acc:                         0.8509174585342407 / 0.8509174585342407
after epoch: 22,now: 2024-07-26 11:10:36.555361,epoch time: 0:01:25.951279,used: 0:31:39.074666,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_10_38_57_seed_8_23065778
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.99407893, 'precision': 0.99407893, 'recall': 0.99414825, 'specificity': 0.99414825, 'f1': 0.99407876, 'auroc': 0.9997256, 'binary_precision': 1.0, 'binary_recall': 0.9882965, 'binary_specificity': 1.0, 'binary_f1_score': 0.9941138}
confusion matrix:
      0     1
0  1502     0
1    18  1520
---- Validation: 
scalar performance:
{'acc': 0.81825215, 'precision': 0.8520882, 'recall': 0.81328225, 'specificity': 0.81328225, 'f1': 0.8119887, 'auroc': 0.9326439, 'binary_precision': 0.9535963, 'binary_recall': 0.6565495, 'binary_specificity': 0.970015, 'binary_f1_score': 0.77767265}
confusion matrix:
     0    1
0  647   20
1  215  411
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6284404, 'precision': 0.74995905, 'recall': 0.6284404, 'specificity': 0.6284404, 'f1': 0.57703364, 'auroc': 0.91678417, 'binary_precision': 0.92424244, 'binary_recall': 0.2798165, 'binary_specificity': 0.9770642, 'binary_f1_score': 0.4295775}
confusion matrix:
     0   1
0  213   5
1  157  61
early stop counter: 22
val acc:0.8182521462440491, best validation acc: 0.8484145402908325, corresponding to test acc:                         0.8509174585342407 / 0.8509174585342407
after epoch: 23,now: 2024-07-26 11:12:02.971245,epoch time: 0:01:26.415884,used: 0:33:05.490550,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_10_38_57_seed_8_23065778
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.99375, 'precision': 0.99378896, 'recall': 0.9937186, 'specificity': 0.9937186, 'f1': 0.9937485, 'auroc': 0.99990344, 'binary_precision': 0.99159664, 'binary_recall': 0.9961039, 'binary_specificity': 0.9913333, 'binary_f1_score': 0.99384516}
confusion matrix:
      0     1
0  1487    13
1     6  1534
---- Validation: 
scalar performance:
{'acc': 0.8576953, 'precision': 0.8675076, 'recall': 0.85509723, 'specificity': 0.85509723, 'f1': 0.85598266, 'auroc': 0.9315691, 'binary_precision': 0.92015207, 'binary_recall': 0.77316296, 'binary_specificity': 0.9370315, 'binary_f1_score': 0.8402778}
confusion matrix:
     0    1
0  625   42
1  142  484
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8004587, 'precision': 0.8259822, 'recall': 0.8004587, 'specificity': 0.8004587, 'f1': 0.7964749, 'auroc': 0.9136226, 'binary_precision': 0.91719747, 'binary_recall': 0.6605505, 'binary_specificity': 0.940367, 'binary_f1_score': 0.768}
confusion matrix:
     0    1
0  205   13
1   74  144
better model found
persisted
after epoch: 24,now: 2024-07-26 11:13:29.333308,epoch time: 0:01:26.362063,used: 0:34:31.852613,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_10_38_57_seed_8_23065778
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.9944079, 'precision': 0.9943981, 'recall': 0.9944656, 'specificity': 0.9944656, 'f1': 0.99440765, 'auroc': 0.99977183, 'binary_precision': 0.9993434, 'binary_recall': 0.9895969, 'binary_specificity': 0.9993342, 'binary_f1_score': 0.99444634}
confusion matrix:
      0     1
0  1501     1
1    16  1522
---- Validation: 
scalar performance:
{'acc': 0.72235113, 'precision': 0.8020567, 'recall': 0.7139952, 'specificity': 0.7139952, 'f1': 0.69758797, 'auroc': 0.90740275, 'binary_precision': 0.94949496, 'binary_recall': 0.45047924, 'binary_specificity': 0.9775112, 'binary_f1_score': 0.6110509}
confusion matrix:
     0    1
0  652   15
1  344  282
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6972477, 'precision': 0.80102766, 'recall': 0.69724774, 'specificity': 0.69724774, 'f1': 0.668693, 'auroc': 0.92612153, 'binary_precision': 0.9777778, 'binary_recall': 0.40366971, 'binary_specificity': 0.9908257, 'binary_f1_score': 0.57142854}
confusion matrix:
     0   1
0  216   2
1  130  88
early stop counter: 1
val acc:0.7223511338233948, best validation acc: 0.8576952815055847, corresponding to test acc:                         0.8004587292671204 / 0.8509174585342407
after epoch: 25,now: 2024-07-26 11:14:55.345950,epoch time: 0:01:26.012642,used: 0:35:57.865255,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_10_38_57_seed_8_23065778
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9914474, 'precision': 0.9914321, 'recall': 0.9914831, 'specificity': 0.9914831, 'f1': 0.9914468, 'auroc': 0.99957323, 'binary_precision': 0.994761, 'binary_recall': 0.9882889, 'binary_specificity': 0.9946773, 'binary_f1_score': 0.9915143}
confusion matrix:
      0     1
0  1495     8
1    18  1519
---- Validation: 
scalar performance:
{'acc': 0.8352668, 'precision': 0.8644341, 'recall': 0.83075595, 'specificity': 0.83075595, 'f1': 0.8304471, 'auroc': 0.9437398, 'binary_precision': 0.9599109, 'binary_recall': 0.6884984, 'binary_specificity': 0.9730135, 'binary_f1_score': 0.80186045}
confusion matrix:
     0    1
0  649   18
1  195  431
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8463303, 'precision': 0.8824562, 'recall': 0.8463303, 'specificity': 0.8463303, 'f1': 0.8426137, 'auroc': 0.9463429, 'binary_precision': 1.0, 'binary_recall': 0.69266057, 'binary_specificity': 1.0, 'binary_f1_score': 0.8184282}
confusion matrix:
     0    1
0  218    0
1   67  151
early stop counter: 2
val acc:0.8352668285369873, best validation acc: 0.8576952815055847, corresponding to test acc:                         0.8004587292671204 / 0.8509174585342407
after epoch: 26,now: 2024-07-26 11:16:21.371034,epoch time: 0:01:26.025084,used: 0:37:23.890339,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_10_38_57_seed_8_23065778
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.9924342, 'precision': 0.9924196, 'recall': 0.9924526, 'specificity': 0.9924526, 'f1': 0.9924334, 'auroc': 0.9998187, 'binary_precision': 0.9941292, 'binary_recall': 0.9908973, 'binary_specificity': 0.994008, 'binary_f1_score': 0.9925106}
confusion matrix:
      0     1
0  1493     9
1    14  1524
---- Validation: 
scalar performance:
{'acc': 0.8677494, 'precision': 0.87052804, 'recall': 0.86636436, 'specificity': 0.86636436, 'f1': 0.8670765, 'auroc': 0.9372201, 'binary_precision': 0.8956522, 'binary_recall': 0.8226837, 'binary_specificity': 0.91004497, 'binary_f1_score': 0.8576187}
confusion matrix:
     0    1
0  607   60
1  111  515
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8669725, 'precision': 0.87505376, 'recall': 0.86697245, 'specificity': 0.86697245, 'f1': 0.86625206, 'auroc': 0.93072975, 'binary_precision': 0.93010753, 'binary_recall': 0.79357797, 'binary_specificity': 0.940367, 'binary_f1_score': 0.85643566}
confusion matrix:
     0    1
0  205   13
1   45  173
new oracle model saved
better model found
persisted
after epoch: 27,now: 2024-07-26 11:17:47.613264,epoch time: 0:01:26.242230,used: 0:38:50.132569,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_10_38_57_seed_8_23065778
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.99210525, 'precision': 0.99220157, 'recall': 0.9920465, 'specificity': 0.9920465, 'f1': 0.992103, 'auroc': 0.9998394, 'binary_precision': 0.9877656, 'binary_recall': 0.9967511, 'binary_specificity': 0.98734176, 'binary_f1_score': 0.99223804}
confusion matrix:
      0     1
0  1482    19
1     5  1534
---- Validation: 
scalar performance:
{'acc': 0.88321733, 'precision': 0.88846743, 'recall': 0.88140595, 'specificity': 0.88140595, 'f1': 0.88236594, 'auroc': 0.941164, 'binary_precision': 0.92639136, 'binary_recall': 0.82428116, 'binary_specificity': 0.93853074, 'binary_f1_score': 0.8723584}
confusion matrix:
     0    1
0  626   41
1  110  516
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.82568806, 'precision': 0.8358941, 'recall': 0.8256881, 'specificity': 0.8256881, 'f1': 0.82435393, 'auroc': 0.9084726, 'binary_precision': 0.89444447, 'binary_recall': 0.7385321, 'binary_specificity': 0.91284406, 'binary_f1_score': 0.8090453}
confusion matrix:
     0    1
0  199   19
1   57  161
better model found
persisted
after epoch: 28,now: 2024-07-26 11:19:13.773270,epoch time: 0:01:26.160006,used: 0:40:16.292575,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_10_38_57_seed_8_23065778
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.99013156, 'precision': 0.9901488, 'recall': 0.99019974, 'specificity': 0.99019974, 'f1': 0.9901314, 'auroc': 0.99971735, 'binary_precision': 0.99670184, 'binary_recall': 0.98372394, 'binary_specificity': 0.99667555, 'binary_f1_score': 0.99017036}
confusion matrix:
      0     1
0  1499     5
1    25  1511
---- Validation: 
scalar performance:
{'acc': 0.7447796, 'precision': 0.8230612, 'recall': 0.7368145, 'specificity': 0.7368145, 'f1': 0.72397244, 'auroc': 0.9356376, 'binary_precision': 0.974359, 'binary_recall': 0.485623, 'binary_specificity': 0.988006, 'binary_f1_score': 0.6481877}
confusion matrix:
     0    1
0  659    8
1  322  304
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.79816514, 'precision': 0.85620916, 'recall': 0.79816514, 'specificity': 0.79816514, 'f1': 0.78959376, 'auroc': 0.9315188, 'binary_precision': 1.0, 'binary_recall': 0.5963303, 'binary_specificity': 1.0, 'binary_f1_score': 0.74712646}
confusion matrix:
     0    1
0  218    0
1   88  130
early stop counter: 1
val acc:0.7447795867919922, best validation acc: 0.8832173347473145, corresponding to test acc:                         0.8256880640983582 / 0.8669725060462952
after epoch: 29,now: 2024-07-26 11:20:39.854581,epoch time: 0:01:26.081311,used: 0:41:42.373886,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_10_38_57_seed_8_23065778
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.9907895, 'precision': 0.9908453, 'recall': 0.99087846, 'specificity': 0.99087846, 'f1': 0.9907894, 'auroc': 0.9999165, 'binary_precision': 0.99933773, 'binary_recall': 0.9824219, 'binary_specificity': 0.9993351, 'binary_f1_score': 0.9908076}
confusion matrix:
      0     1
0  1503     1
1    27  1509
---- Validation: 
scalar performance:
{'acc': 0.6148492, 'precision': 0.76846415, 'recall': 0.6024819, 'specificity': 0.6024819, 'f1': 0.5374208, 'auroc': 0.92610323, 'binary_precision': 0.9637681, 'binary_recall': 0.21246007, 'binary_specificity': 0.99250376, 'binary_f1_score': 0.34816757}
confusion matrix:
     0    1
0  662    5
1  493  133
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.55504584, 'precision': 0.7147783, 'recall': 0.5550459, 'specificity': 0.5550459, 'f1': 0.4534222, 'auroc': 0.91412234, 'binary_precision': 0.9, 'binary_recall': 0.123853214, 'binary_specificity': 0.98623854, 'binary_f1_score': 0.21774194}
confusion matrix:
     0   1
0  215   3
1  191  27
early stop counter: 2
val acc:0.6148492097854614, best validation acc: 0.8832173347473145, corresponding to test acc:                         0.8256880640983582 / 0.8669725060462952
after epoch: 30,now: 2024-07-26 11:22:06.126271,epoch time: 0:01:26.271690,used: 0:43:08.645576,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_10_38_57_seed_8_23065778
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 0:43:08.645576 at 2024-07-26 11:22:06.126271
persisted model performance metric: 

scalar performance:
{'acc': 0.82568806, 'precision': 0.8358941, 'recall': 0.8256881, 'specificity': 0.8256881, 'f1': 0.82435393, 'auroc': 0.9084726, 'binary_precision': 0.89444447, 'binary_recall': 0.7385321, 'binary_specificity': 0.91284406, 'binary_f1_score': 0.8090453}
confusion matrix:
     0    1
0  199   19
1   57  161
oracle model performance metric: 

scalar performance:
{'acc': 0.8669725, 'precision': 0.87505376, 'recall': 0.86697245, 'specificity': 0.86697245, 'f1': 0.86625206, 'auroc': 0.93072975, 'binary_precision': 0.93010753, 'binary_recall': 0.79357797, 'binary_specificity': 0.940367, 'binary_f1_score': 0.85643566}
confusion matrix:
     0    1
0  205   13
1   45  173
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_irm_10seeds_nofreeze_2024-07-26_02-28-54/rule_results/1.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_irm_10seeds_nofreeze_2024-07-26_02-28-54/confusion_matrix/1.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 455399 KiB |  13219 MiB | 657636 GiB | 657635 GiB |
|       from large pool | 414803 KiB |  13181 MiB | 649812 GiB | 649811 GiB |
|       from small pool |  40595 KiB |     60 MiB |   7824 GiB |   7824 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 455399 KiB |  13219 MiB | 657636 GiB | 657635 GiB |
|       from large pool | 414803 KiB |  13181 MiB | 649812 GiB | 649811 GiB |
|       from small pool |  40595 KiB |     60 MiB |   7824 GiB |   7824 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 447481 KiB |  13213 MiB | 656703 GiB | 656703 GiB |
|       from large pool | 407075 KiB |  13175 MiB | 648896 GiB | 648895 GiB |
|       from small pool |  40406 KiB |     60 MiB |   7807 GiB |   7807 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  14478 MiB |  14482 MiB | 123230 MiB | 108752 MiB |
|       from large pool |  14412 MiB |  14412 MiB | 123034 MiB | 108622 MiB |
|       from small pool |     66 MiB |     70 MiB |    196 MiB |    130 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 447769 KiB |   1236 MiB | 460086 GiB | 460085 GiB |
|       from large pool | 435116 KiB |   1229 MiB | 452212 GiB | 452212 GiB |
|       from small pool |  12652 KiB |     44 MiB |   7873 GiB |   7873 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    1304    |    2598    |  116335 K  |  116334 K  |
|       from large pool |     187    |    1413    |   59158 K  |   59157 K  |
|       from small pool |    1117    |    1419    |   57177 K  |   57176 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    1304    |    2598    |  116335 K  |  116334 K  |
|       from large pool |     187    |    1413    |   59158 K  |   59157 K  |
|       from small pool |    1117    |    1419    |   57177 K  |   57176 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     635    |     637    |    5218    |    4583    |
|       from large pool |     602    |     602    |    5120    |    4518    |
|       from small pool |      33    |      35    |      98    |      65    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     100    |     652    |   78674 K  |   78674 K  |
|       from large pool |      38    |     605    |   45365 K  |   45365 K  |
|       from small pool |      62    |     237    |   33308 K  |   33308 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13219 MiB | 657636 GiB | 657636 GiB |
|       from large pool |  16640 KiB |  13181 MiB | 649812 GiB | 649812 GiB |
|       from small pool |      0 KiB |     60 MiB |   7824 GiB |   7824 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13219 MiB | 657636 GiB | 657636 GiB |
|       from large pool |  16640 KiB |  13181 MiB | 649812 GiB | 649812 GiB |
|       from small pool |      0 KiB |     60 MiB |   7824 GiB |   7824 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13213 MiB | 656703 GiB | 656703 GiB |
|       from large pool |  16640 KiB |  13175 MiB | 648896 GiB | 648896 GiB |
|       from small pool |      0 KiB |     60 MiB |   7807 GiB |   7807 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    882 MiB |  14482 MiB | 123230 MiB | 122348 MiB |
|       from large pool |    830 MiB |  14412 MiB | 123034 MiB | 122204 MiB |
|       from small pool |     52 MiB |     70 MiB |    196 MiB |    144 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1236 MiB | 460086 GiB | 460086 GiB |
|       from large pool |  24320 KiB |   1229 MiB | 452213 GiB | 452213 GiB |
|       from small pool |      0 KiB |     46 MiB |   7873 GiB |   7873 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    2598    |  116335 K  |  116335 K  |
|       from large pool |       2    |    1413    |   59158 K  |   59158 K  |
|       from small pool |       0    |    1419    |   57177 K  |   57177 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    2598    |  116335 K  |  116335 K  |
|       from large pool |       2    |    1413    |   59158 K  |   59158 K  |
|       from small pool |       0    |    1419    |   57177 K  |   57177 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      63    |     637    |    5218    |    5155    |
|       from large pool |      37    |     602    |    5120    |    5083    |
|       from small pool |      26    |      35    |      98    |      72    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |     652    |   78674 K  |   78674 K  |
|       from large pool |       4    |     605    |   45365 K  |   45365 K  |
|       from small pool |       0    |     237    |   33308 K  |   33308 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13219 MiB | 657636 GiB | 657636 GiB |
|       from large pool |  16640 KiB |  13181 MiB | 649812 GiB | 649812 GiB |
|       from small pool |      0 KiB |     60 MiB |   7824 GiB |   7824 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13219 MiB | 657636 GiB | 657636 GiB |
|       from large pool |  16640 KiB |  13181 MiB | 649812 GiB | 649812 GiB |
|       from small pool |      0 KiB |     60 MiB |   7824 GiB |   7824 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13213 MiB | 656703 GiB | 656703 GiB |
|       from large pool |  16640 KiB |  13175 MiB | 648896 GiB | 648896 GiB |
|       from small pool |      0 KiB |     60 MiB |   7807 GiB |   7807 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    882 MiB |  14482 MiB | 123230 MiB | 122348 MiB |
|       from large pool |    830 MiB |  14412 MiB | 123034 MiB | 122204 MiB |
|       from small pool |     52 MiB |     70 MiB |    196 MiB |    144 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1236 MiB | 460086 GiB | 460086 GiB |
|       from large pool |  24320 KiB |   1229 MiB | 452213 GiB | 452213 GiB |
|       from small pool |      0 KiB |     46 MiB |   7873 GiB |   7873 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    2598    |  116335 K  |  116335 K  |
|       from large pool |       2    |    1413    |   59158 K  |   59158 K  |
|       from small pool |       0    |    1419    |   57177 K  |   57177 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    2598    |  116335 K  |  116335 K  |
|       from large pool |       2    |    1413    |   59158 K  |   59158 K  |
|       from small pool |       0    |    1419    |   57177 K  |   57177 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      63    |     637    |    5218    |    5155    |
|       from large pool |      37    |     602    |    5120    |    5083    |
|       from small pool |      26    |      35    |      98    |      72    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |     652    |   78674 K  |   78674 K  |
|       from large pool |       4    |     605    |   45365 K  |   45365 K  |
|       from small pool |       0    |     237    |   33308 K  |   33308 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'888c1ef2'
model name: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_11_22_39_seed_9_23065778

 Experiment start at: 2024-07-26 11:22:39.872190
before training, model accuracy: 0.49782606959342957
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9034686, 'precision': 0.9179584, 'recall': 0.9041444, 'specificity': 0.9041444, 'f1': 0.90272605, 'auroc': 0.9910368, 'binary_precision': 0.9976, 'binary_recall': 0.81026644, 'binary_specificity': 0.99802244, 'binary_f1_score': 0.8942274}
confusion matrix:
      0     1
0  1514     3
1   292  1247
---- Validation: 
scalar performance:
{'acc': 0.7799228, 'precision': 0.8301388, 'recall': 0.7779547, 'specificity': 0.7779547, 'f1': 0.7703799, 'auroc': 0.92081845, 'binary_precision': 0.9564102, 'binary_recall': 0.5819033, 'binary_specificity': 0.9740061, 'binary_f1_score': 0.72356933}
confusion matrix:
     0    1
0  637   17
1  268  373
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7826087, 'precision': 0.83927923, 'recall': 0.78260875, 'specificity': 0.78260875, 'f1': 0.7731353, 'auroc': 0.90366733, 'binary_precision': 0.97794116, 'binary_recall': 0.5782609, 'binary_specificity': 0.98695654, 'binary_f1_score': 0.726776}
confusion matrix:
     0    1
0  227    3
1   97  133
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-26 11:24:17.822797,epoch time: 0:01:37.950607,used: 0:01:37.950607,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_11_22_39_seed_9_23065778
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9532068, 'precision': 0.9566084, 'recall': 0.95352715, 'specificity': 0.95352715, 'f1': 0.95314044, 'auroc': 0.995587, 'binary_precision': 0.9978602, 'binary_recall': 0.90903187, 'binary_specificity': 0.99802244, 'binary_f1_score': 0.9513771}
confusion matrix:
      0     1
0  1514     3
1   140  1399
---- Validation: 
scalar performance:
{'acc': 0.76216215, 'precision': 0.80948484, 'recall': 0.7601845, 'specificity': 0.7601845, 'f1': 0.75176746, 'auroc': 0.90827835, 'binary_precision': 0.92802054, 'binary_recall': 0.56318253, 'binary_specificity': 0.9571865, 'binary_f1_score': 0.7009708}
confusion matrix:
     0    1
0  626   28
1  280  361
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.84565216, 'precision': 0.8718051, 'recall': 0.84565216, 'specificity': 0.84565216, 'f1': 0.84288937, 'auroc': 0.9065974, 'binary_precision': 0.9704142, 'binary_recall': 0.71304345, 'binary_specificity': 0.9782609, 'binary_f1_score': 0.82205516}
confusion matrix:
     0    1
0  225    5
1   66  164
new oracle model saved
early stop counter: 1
val acc:0.7621621489524841, best validation acc: 0.7799227833747864, corresponding to test acc:                         0.782608687877655 / 0.845652163028717
after epoch: 2,now: 2024-07-26 11:25:47.352122,epoch time: 0:01:29.529325,used: 0:03:07.479932,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_11_22_39_seed_9_23065778
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9751309, 'precision': 0.97534287, 'recall': 0.97521913, 'specificity': 0.97521913, 'f1': 0.97513026, 'auroc': 0.99668694, 'binary_precision': 0.98734176, 'binary_recall': 0.962963, 'binary_specificity': 0.9874753, 'binary_f1_score': 0.975}
confusion matrix:
      0     1
0  1498    19
1    57  1482
---- Validation: 
scalar performance:
{'acc': 0.8277992, 'precision': 0.82979196, 'recall': 0.827402, 'specificity': 0.827402, 'f1': 0.8274036, 'auroc': 0.899147, 'binary_precision': 0.8530405, 'binary_recall': 0.7878315, 'binary_specificity': 0.8669725, 'binary_f1_score': 0.8191403}
confusion matrix:
     0    1
0  567   87
1  136  505
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8326087, 'precision': 0.832615, 'recall': 0.8326087, 'specificity': 0.8326087, 'f1': 0.83260787, 'auroc': 0.91729677, 'binary_precision': 0.83116883, 'binary_recall': 0.8347826, 'binary_specificity': 0.8304348, 'binary_f1_score': 0.83297175}
confusion matrix:
     0    1
0  191   39
1   38  192
better model found
persisted
after epoch: 3,now: 2024-07-26 11:27:16.737139,epoch time: 0:01:29.385017,used: 0:04:36.864949,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_11_22_39_seed_9_23065778
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.97742146, 'precision': 0.97773945, 'recall': 0.9773455, 'specificity': 0.9773455, 'f1': 0.97741413, 'auroc': 0.99786437, 'binary_precision': 0.96694213, 'binary_recall': 0.9889467, 'binary_specificity': 0.9657444, 'binary_f1_score': 0.97782063}
confusion matrix:
      0     1
0  1466    52
1    17  1521
---- Validation: 
scalar performance:
{'acc': 0.77451736, 'precision': 0.81230783, 'recall': 0.77275807, 'specificity': 0.77275807, 'f1': 0.76670355, 'auroc': 0.8966566, 'binary_precision': 0.91846526, 'binary_recall': 0.5975039, 'binary_specificity': 0.94801223, 'binary_f1_score': 0.7240076}
confusion matrix:
     0    1
0  620   34
1  258  383
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8282609, 'precision': 0.86072624, 'recall': 0.8282609, 'specificity': 0.8282609, 'f1': 0.8243078, 'auroc': 0.9092249, 'binary_precision': 0.9689441, 'binary_recall': 0.67826086, 'binary_specificity': 0.9782609, 'binary_f1_score': 0.79795396}
confusion matrix:
     0    1
0  225    5
1   74  156
early stop counter: 1
val acc:0.7745173573493958, best validation acc: 0.8277992010116577, corresponding to test acc:                         0.832608699798584 / 0.845652163028717
after epoch: 4,now: 2024-07-26 11:28:46.143481,epoch time: 0:01:29.406342,used: 0:06:06.271291,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_11_22_39_seed_9_23065778
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9810209, 'precision': 0.9810623, 'recall': 0.9809964, 'specificity': 0.9809964, 'f1': 0.9810189, 'auroc': 0.99889696, 'binary_precision': 0.97805035, 'binary_recall': 0.98440546, 'binary_specificity': 0.97758734, 'binary_f1_score': 0.9812177}
confusion matrix:
      0     1
0  1483    34
1    24  1515
---- Validation: 
scalar performance:
{'acc': 0.7969112, 'precision': 0.81577814, 'recall': 0.7956736, 'specificity': 0.7956736, 'f1': 0.79335, 'auroc': 0.90529895, 'binary_precision': 0.8904959, 'binary_recall': 0.6723869, 'binary_specificity': 0.9189603, 'binary_f1_score': 0.7662222}
confusion matrix:
     0    1
0  601   53
1  210  431
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8152174, 'precision': 0.82030964, 'recall': 0.8152174, 'specificity': 0.8152174, 'f1': 0.81448007, 'auroc': 0.88862, 'binary_precision': 0.8606965, 'binary_recall': 0.7521739, 'binary_specificity': 0.87826085, 'binary_f1_score': 0.8027842}
confusion matrix:
     0    1
0  202   28
1   57  173
early stop counter: 2
val acc:0.7969111800193787, best validation acc: 0.8277992010116577, corresponding to test acc:                         0.832608699798584 / 0.845652163028717
after epoch: 5,now: 2024-07-26 11:30:15.725419,epoch time: 0:01:29.581938,used: 0:07:35.853229,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_11_22_39_seed_9_23065778
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.97316754, 'precision': 0.9739111, 'recall': 0.9733216, 'specificity': 0.9733216, 'f1': 0.97316194, 'auroc': 0.9985882, 'binary_precision': 0.9945689, 'binary_recall': 0.9519168, 'binary_specificity': 0.9947264, 'binary_f1_score': 0.9727755}
confusion matrix:
      0     1
0  1509     8
1    74  1465
---- Validation: 
scalar performance:
{'acc': 0.7853282, 'precision': 0.8279774, 'recall': 0.78350794, 'specificity': 0.78350794, 'f1': 0.77735925, 'auroc': 0.91702807, 'binary_precision': 0.9437653, 'binary_recall': 0.6021841, 'binary_specificity': 0.9648318, 'binary_f1_score': 0.7352381}
confusion matrix:
     0    1
0  631   23
1  255  386
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8543478, 'precision': 0.87119544, 'recall': 0.8543478, 'specificity': 0.8543478, 'f1': 0.85267615, 'auroc': 0.9111153, 'binary_precision': 0.95027626, 'binary_recall': 0.7478261, 'binary_specificity': 0.96086955, 'binary_f1_score': 0.83698297}
confusion matrix:
     0    1
0  221    9
1   58  172
new oracle model saved
early stop counter: 3
val acc:0.785328209400177, best validation acc: 0.8277992010116577, corresponding to test acc:                         0.832608699798584 / 0.854347825050354
after epoch: 6,now: 2024-07-26 11:31:45.201696,epoch time: 0:01:29.476277,used: 0:09:05.329506,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_11_22_39_seed_9_23065778
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9754581, 'precision': 0.9763885, 'recall': 0.97562885, 'specificity': 0.97562885, 'f1': 0.97545123, 'auroc': 0.99914885, 'binary_precision': 0.9993179, 'binary_recall': 0.9519168, 'binary_specificity': 0.99934083, 'binary_f1_score': 0.97504157}
confusion matrix:
      0     1
0  1516     1
1    74  1465
---- Validation: 
scalar performance:
{'acc': 0.6880309, 'precision': 0.8032378, 'recall': 0.6849139, 'specificity': 0.6849139, 'f1': 0.6530876, 'auroc': 0.9323019, 'binary_precision': 0.9876543, 'binary_recall': 0.37441498, 'binary_specificity': 0.9954128, 'binary_f1_score': 0.5429864}
confusion matrix:
     0    1
0  651    3
1  401  240
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5565217, 'precision': 0.764977, 'recall': 0.5565217, 'specificity': 0.5565217, 'f1': 0.447948, 'auroc': 0.9212855, 'binary_precision': 1.0, 'binary_recall': 0.11304348, 'binary_specificity': 1.0, 'binary_f1_score': 0.20312501}
confusion matrix:
     0   1
0  230   0
1  204  26
early stop counter: 4
val acc:0.6880308985710144, best validation acc: 0.8277992010116577, corresponding to test acc:                         0.832608699798584 / 0.854347825050354
after epoch: 7,now: 2024-07-26 11:33:14.558628,epoch time: 0:01:29.356932,used: 0:10:34.686438,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_11_22_39_seed_9_23065778
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9878927, 'precision': 0.98795104, 'recall': 0.9879463, 'specificity': 0.9879463, 'f1': 0.9878926, 'auroc': 0.9995365, 'binary_precision': 0.9953826, 'binary_recall': 0.98050684, 'binary_specificity': 0.99538565, 'binary_f1_score': 0.9878887}
confusion matrix:
      0     1
0  1510     7
1    30  1509
---- Validation: 
scalar performance:
{'acc': 0.7776062, 'precision': 0.8317367, 'recall': 0.7755681, 'specificity': 0.7755681, 'f1': 0.76726305, 'auroc': 0.92488086, 'binary_precision': 0.9632546, 'binary_recall': 0.5725429, 'binary_specificity': 0.9785933, 'binary_f1_score': 0.7181996}
confusion matrix:
     0    1
0  640   14
1  274  367
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.74347824, 'precision': 0.8123484, 'recall': 0.7434783, 'specificity': 0.7434783, 'f1': 0.7285131, 'auroc': 0.90446126, 'binary_precision': 0.9590164, 'binary_recall': 0.50869566, 'binary_specificity': 0.9782609, 'binary_f1_score': 0.66477275}
confusion matrix:
     0    1
0  225    5
1  113  117
early stop counter: 5
val acc:0.777606189250946, best validation acc: 0.8277992010116577, corresponding to test acc:                         0.832608699798584 / 0.854347825050354
after epoch: 8,now: 2024-07-26 11:34:44.035014,epoch time: 0:01:29.476386,used: 0:12:04.162824,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_11_22_39_seed_9_23065778
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.989856, 'precision': 0.98984945, 'recall': 0.98986727, 'specificity': 0.98986727, 'f1': 0.98985565, 'auroc': 0.99932146, 'binary_precision': 0.9915254, 'binary_recall': 0.9883041, 'binary_specificity': 0.99143046, 'binary_f1_score': 0.9899121}
confusion matrix:
      0     1
0  1504    13
1    18  1521
---- Validation: 
scalar performance:
{'acc': 0.7876448, 'precision': 0.829392, 'recall': 0.785848, 'specificity': 0.785848, 'f1': 0.77996075, 'auroc': 0.9209497, 'binary_precision': 0.94417477, 'binary_recall': 0.6068643, 'binary_specificity': 0.9648318, 'binary_f1_score': 0.7388415}
confusion matrix:
     0    1
0  631   23
1  252  389
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7021739, 'precision': 0.7992529, 'recall': 0.70217395, 'specificity': 0.70217395, 'f1': 0.67588806, 'auroc': 0.89699435, 'binary_precision': 0.969697, 'binary_recall': 0.4173913, 'binary_specificity': 0.98695654, 'binary_f1_score': 0.58358663}
confusion matrix:
     0   1
0  227   3
1  134  96
early stop counter: 6
val acc:0.7876448035240173, best validation acc: 0.8277992010116577, corresponding to test acc:                         0.832608699798584 / 0.854347825050354
after epoch: 9,now: 2024-07-26 11:36:13.389590,epoch time: 0:01:29.354576,used: 0:13:33.517400,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_11_22_39_seed_9_23065778
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9679319, 'precision': 0.96965945, 'recall': 0.9681611, 'specificity': 0.9681611, 'f1': 0.9679121, 'auroc': 0.9985484, 'binary_precision': 1.0, 'binary_recall': 0.9363223, 'binary_specificity': 1.0, 'binary_f1_score': 0.9671141}
confusion matrix:
      0     1
0  1517     0
1    98  1441
---- Validation: 
scalar performance:
{'acc': 0.55057913, 'precision': 0.74873734, 'recall': 0.5460529, 'specificity': 0.5460529, 'f1': 0.43235293, 'auroc': 0.877584, 'binary_precision': 0.96825397, 'binary_recall': 0.09516381, 'binary_specificity': 0.9969419, 'binary_f1_score': 0.17329545}
confusion matrix:
     0   1
0  652   2
1  580  61
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.51086956, 'precision': 0.7527473, 'recall': 0.51086956, 'specificity': 0.51086956, 'f1': 0.35704303, 'auroc': 0.90896034, 'binary_precision': 1.0, 'binary_recall': 0.02173913, 'binary_specificity': 1.0, 'binary_f1_score': 0.042553194}
confusion matrix:
     0  1
0  230  0
1  225  5
early stop counter: 7
val acc:0.5505791306495667, best validation acc: 0.8277992010116577, corresponding to test acc:                         0.832608699798584 / 0.854347825050354
after epoch: 10,now: 2024-07-26 11:37:42.962779,epoch time: 0:01:29.573189,used: 0:15:03.090589,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_11_22_39_seed_9_23065778
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.99345547, 'precision': 0.9934503, 'recall': 0.99346375, 'specificity': 0.99346375, 'f1': 0.9934553, 'auroc': 0.9996766, 'binary_precision': 0.9947849, 'binary_recall': 0.99219763, 'binary_specificity': 0.99472994, 'binary_f1_score': 0.99348956}
confusion matrix:
      0     1
0  1510     8
1    12  1526
---- Validation: 
scalar performance:
{'acc': 0.7297297, 'precision': 0.7940997, 'recall': 0.7273612, 'specificity': 0.7273612, 'f1': 0.7127329, 'auroc': 0.90160155, 'binary_precision': 0.9292035, 'binary_recall': 0.49141964, 'binary_specificity': 0.96330273, 'binary_f1_score': 0.64285713}
confusion matrix:
     0    1
0  630   24
1  326  315
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7543478, 'precision': 0.8181528, 'recall': 0.7543478, 'specificity': 0.7543478, 'f1': 0.7413814, 'auroc': 0.9190548, 'binary_precision': 0.96062994, 'binary_recall': 0.5304348, 'binary_specificity': 0.9782609, 'binary_f1_score': 0.68347335}
confusion matrix:
     0    1
0  225    5
1  108  122
early stop counter: 8
val acc:0.7297297120094299, best validation acc: 0.8277992010116577, corresponding to test acc:                         0.832608699798584 / 0.854347825050354
after epoch: 11,now: 2024-07-26 11:39:12.596540,epoch time: 0:01:29.633761,used: 0:16:32.724350,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_11_22_39_seed_9_23065778
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.99345547, 'precision': 0.99348617, 'recall': 0.9934938, 'specificity': 0.9934938, 'f1': 0.9934555, 'auroc': 0.99988866, 'binary_precision': 0.9993421, 'binary_recall': 0.9876463, 'binary_specificity': 0.99934125, 'binary_f1_score': 0.99345976}
confusion matrix:
      0     1
0  1517     1
1    19  1519
---- Validation: 
scalar performance:
{'acc': 0.81389964, 'precision': 0.8487889, 'recall': 0.8123071, 'specificity': 0.8123071, 'f1': 0.808574, 'auroc': 0.9336425, 'binary_precision': 0.956621, 'binary_recall': 0.65366614, 'binary_specificity': 0.97094804, 'binary_f1_score': 0.77664506}
confusion matrix:
     0    1
0  635   19
1  222  419
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7717391, 'precision': 0.83665895, 'recall': 0.7717391, 'specificity': 0.7717391, 'f1': 0.7601775, 'auroc': 0.91493857, 'binary_precision': 0.9844961, 'binary_recall': 0.5521739, 'binary_specificity': 0.99130434, 'binary_f1_score': 0.7075209}
confusion matrix:
     0    1
0  228    2
1  103  127
early stop counter: 9
val acc:0.8138996362686157, best validation acc: 0.8277992010116577, corresponding to test acc:                         0.832608699798584 / 0.854347825050354
after epoch: 12,now: 2024-07-26 11:40:41.823965,epoch time: 0:01:29.227425,used: 0:18:01.951775,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_11_22_39_seed_9_23065778
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9846204, 'precision': 0.9848492, 'recall': 0.9847115, 'specificity': 0.9847115, 'f1': 0.98462, 'auroc': 0.99882174, 'binary_precision': 0.99733335, 'binary_recall': 0.9720598, 'binary_specificity': 0.9973632, 'binary_f1_score': 0.9845344}
confusion matrix:
      0     1
0  1513     4
1    43  1496
---- Validation: 
scalar performance:
{'acc': 0.7027027, 'precision': 0.78760505, 'recall': 0.6999516, 'specificity': 0.6999516, 'f1': 0.6771993, 'auroc': 0.9037442, 'binary_precision': 0.9413793, 'binary_recall': 0.42589703, 'binary_specificity': 0.9740061, 'binary_f1_score': 0.58646613}
confusion matrix:
     0    1
0  637   17
1  368  273
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8043478, 'precision': 0.84866595, 'recall': 0.8043478, 'specificity': 0.8043478, 'f1': 0.79792655, 'auroc': 0.9145794, 'binary_precision': 0.972973, 'binary_recall': 0.62608695, 'binary_specificity': 0.9826087, 'binary_f1_score': 0.7619047}
confusion matrix:
     0    1
0  226    4
1   86  144
early stop counter: 10
val acc:0.7027027010917664, best validation acc: 0.8277992010116577, corresponding to test acc:                         0.832608699798584 / 0.854347825050354
after epoch: 13,now: 2024-07-26 11:42:11.411963,epoch time: 0:01:29.587998,used: 0:19:31.539773,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_11_22_39_seed_9_23065778
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9878927, 'precision': 0.9880234, 'recall': 0.9879651, 'specificity': 0.9879651, 'f1': 0.9878926, 'auroc': 0.99949586, 'binary_precision': 0.99801064, 'binary_recall': 0.9779077, 'binary_specificity': 0.99802244, 'binary_f1_score': 0.9878569}
confusion matrix:
      0     1
0  1514     3
1    34  1505
---- Validation: 
scalar performance:
{'acc': 0.71814674, 'precision': 0.8128643, 'recall': 0.7153661, 'specificity': 0.7153661, 'f1': 0.693387, 'auroc': 0.925439, 'binary_precision': 0.9825175, 'binary_recall': 0.43837753, 'binary_specificity': 0.99235475, 'binary_f1_score': 0.6062568}
confusion matrix:
     0    1
0  649    5
1  360  281
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6934783, 'precision': 0.809973, 'recall': 0.6934782, 'specificity': 0.6934782, 'f1': 0.6616924, 'auroc': 0.9178072, 'binary_precision': 1.0, 'binary_recall': 0.3869565, 'binary_specificity': 1.0, 'binary_f1_score': 0.55799377}
confusion matrix:
     0   1
0  230   0
1  141  89
early stop counter: 11
val acc:0.7181467413902283, best validation acc: 0.8277992010116577, corresponding to test acc:                         0.832608699798584 / 0.854347825050354
after epoch: 14,now: 2024-07-26 11:43:40.925904,epoch time: 0:01:29.513941,used: 0:21:01.053714,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_11_22_39_seed_9_23065778
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9921466, 'precision': 0.99214447, 'recall': 0.99216974, 'specificity': 0.99216974, 'f1': 0.9921465, 'auroc': 0.9997542, 'binary_precision': 0.9954218, 'binary_recall': 0.9889539, 'binary_specificity': 0.99538565, 'binary_f1_score': 0.9921773}
confusion matrix:
      0     1
0  1510     7
1    17  1522
---- Validation: 
scalar performance:
{'acc': 0.75212353, 'precision': 0.8112596, 'recall': 0.74992007, 'specificity': 0.74992007, 'f1': 0.73865336, 'auroc': 0.9087632, 'binary_precision': 0.9444444, 'binary_recall': 0.5304212, 'binary_specificity': 0.96941894, 'binary_f1_score': 0.6793206}
confusion matrix:
     0    1
0  634   20
1  301  340
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.73695654, 'precision': 0.81594205, 'recall': 0.73695654, 'specificity': 0.73695654, 'f1': 0.7194203, 'auroc': 0.911621, 'binary_precision': 0.973913, 'binary_recall': 0.4869565, 'binary_specificity': 0.98695654, 'binary_f1_score': 0.6492753}
confusion matrix:
     0    1
0  227    3
1  118  112
early stop counter: 12
val acc:0.7521235346794128, best validation acc: 0.8277992010116577, corresponding to test acc:                         0.832608699798584 / 0.854347825050354
after epoch: 15,now: 2024-07-26 11:45:10.531564,epoch time: 0:01:29.605660,used: 0:22:30.659374,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_11_22_39_seed_9_23065778
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.99345547, 'precision': 0.9934765, 'recall': 0.993441, 'specificity': 0.993441, 'f1': 0.99345493, 'auroc': 0.99956095, 'binary_precision': 0.99158573, 'binary_recall': 0.99545157, 'binary_specificity': 0.99143046, 'binary_f1_score': 0.9935149}
confusion matrix:
      0     1
0  1504    13
1     7  1532
---- Validation: 
scalar performance:
{'acc': 0.8208494, 'precision': 0.8524327, 'recall': 0.81934285, 'specificity': 0.81934285, 'f1': 0.8162446, 'auroc': 0.92505556, 'binary_precision': 0.95545655, 'binary_recall': 0.66926676, 'binary_specificity': 0.96941894, 'binary_f1_score': 0.787156}
confusion matrix:
     0    1
0  634   20
1  212  429
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8065217, 'precision': 0.85500824, 'recall': 0.8065218, 'specificity': 0.8065218, 'f1': 0.7996819, 'auroc': 0.91429114, 'binary_precision': 0.9862069, 'binary_recall': 0.62173915, 'binary_specificity': 0.99130434, 'binary_f1_score': 0.76266664}
confusion matrix:
     0    1
0  228    2
1   87  143
early stop counter: 13
val acc:0.8208494186401367, best validation acc: 0.8277992010116577, corresponding to test acc:                         0.832608699798584 / 0.854347825050354
after epoch: 16,now: 2024-07-26 11:46:40.229968,epoch time: 0:01:29.698404,used: 0:24:00.357778,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_11_22_39_seed_9_23065778
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9872382, 'precision': 0.9875138, 'recall': 0.98715776, 'specificity': 0.98715776, 'f1': 0.9872341, 'auroc': 0.99968904, 'binary_precision': 0.9777212, 'binary_recall': 0.9974026, 'binary_specificity': 0.9769129, 'binary_f1_score': 0.98746383}
confusion matrix:
      0     1
0  1481    35
1     4  1536
---- Validation: 
scalar performance:
{'acc': 0.8749035, 'precision': 0.88103306, 'recall': 0.8742707, 'specificity': 0.8742707, 'f1': 0.87425494, 'auroc': 0.9410826, 'binary_precision': 0.92691624, 'binary_recall': 0.81123245, 'binary_specificity': 0.93730885, 'binary_f1_score': 0.86522466}
confusion matrix:
     0    1
0  613   41
1  121  520
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8086957, 'precision': 0.8536469, 'recall': 0.8086957, 'specificity': 0.8086957, 'f1': 0.80241704, 'auroc': 0.9101323, 'binary_precision': 0.9797297, 'binary_recall': 0.6304348, 'binary_specificity': 0.98695654, 'binary_f1_score': 0.76719576}
confusion matrix:
     0    1
0  227    3
1   85  145
better model found
persisted
after epoch: 17,now: 2024-07-26 11:48:10.094321,epoch time: 0:01:29.864353,used: 0:25:30.222131,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_11_22_39_seed_9_23065778
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.97611254, 'precision': 0.9769753, 'recall': 0.97629356, 'specificity': 0.97629356, 'f1': 0.9761069, 'auroc': 0.999164, 'binary_precision': 0.99931926, 'binary_recall': 0.9532468, 'binary_specificity': 0.99934036, 'binary_f1_score': 0.9757395}
confusion matrix:
      0     1
0  1515     1
1    72  1468
---- Validation: 
scalar performance:
{'acc': 0.62702703, 'precision': 0.78759897, 'recall': 0.62324494, 'specificity': 0.62324494, 'f1': 0.56290627, 'auroc': 0.9389047, 'binary_precision': 1.0, 'binary_recall': 0.24648985, 'binary_specificity': 1.0, 'binary_f1_score': 0.39549434}
confusion matrix:
     0    1
0  654    0
1  483  158
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5, 'precision': 0.25, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.33333334, 'auroc': 0.8959783, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
     0  1
0  230  0
1  230  0
early stop counter: 1
val acc:0.6270270347595215, best validation acc: 0.8749035000801086, corresponding to test acc:                         0.8086956739425659 / 0.854347825050354
after epoch: 18,now: 2024-07-26 11:49:39.582054,epoch time: 0:01:29.487733,used: 0:26:59.709864,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_11_22_39_seed_9_23065778
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9947644, 'precision': 0.9948199, 'recall': 0.99473846, 'specificity': 0.99473846, 'f1': 0.99476385, 'auroc': 0.9999126, 'binary_precision': 0.99096775, 'binary_recall': 0.9986996, 'binary_specificity': 0.9907773, 'binary_f1_score': 0.9948186}
confusion matrix:
      0     1
0  1504    14
1     2  1536
---- Validation: 
scalar performance:
{'acc': 0.86640924, 'precision': 0.87924874, 'recall': 0.86548877, 'specificity': 0.86548877, 'f1': 0.86504936, 'auroc': 0.93733037, 'binary_precision': 0.9465649, 'binary_recall': 0.77379096, 'binary_specificity': 0.9571865, 'binary_f1_score': 0.8515022}
confusion matrix:
     0    1
0  626   28
1  145  496
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.84565216, 'precision': 0.8607149, 'recall': 0.84565216, 'specificity': 0.84565216, 'f1': 0.8440239, 'auroc': 0.9180529, 'binary_precision': 0.93442625, 'binary_recall': 0.74347824, 'binary_specificity': 0.9478261, 'binary_f1_score': 0.82808715}
confusion matrix:
     0    1
0  218   12
1   59  171
early stop counter: 2
val acc:0.8664092421531677, best validation acc: 0.8749035000801086, corresponding to test acc:                         0.8086956739425659 / 0.854347825050354
after epoch: 19,now: 2024-07-26 11:51:08.974260,epoch time: 0:01:29.392206,used: 0:28:29.102070,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_11_22_39_seed_9_23065778
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.99640054, 'precision': 0.9963945, 'recall': 0.9964168, 'specificity': 0.9964168, 'f1': 0.9964005, 'auroc': 0.9998882, 'binary_precision': 0.99869454, 'binary_recall': 0.99415207, 'binary_specificity': 0.9986816, 'binary_f1_score': 0.9964181}
confusion matrix:
      0     1
0  1515     2
1     9  1530
---- Validation: 
scalar performance:
{'acc': 0.8779923, 'precision': 0.8865249, 'recall': 0.87725127, 'specificity': 0.87725127, 'f1': 0.87715364, 'auroc': 0.94788337, 'binary_precision': 0.9414991, 'binary_recall': 0.80343217, 'binary_specificity': 0.9510703, 'binary_f1_score': 0.86700344}
confusion matrix:
     0    1
0  622   32
1  126  515
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8565217, 'precision': 0.87732077, 'recall': 0.8565217, 'specificity': 0.8565217, 'f1': 0.85451686, 'auroc': 0.91746694, 'binary_precision': 0.96590906, 'binary_recall': 0.73913044, 'binary_specificity': 0.973913, 'binary_f1_score': 0.83743846}
confusion matrix:
     0    1
0  224    6
1   60  170
new oracle model saved
better model found
persisted
after epoch: 20,now: 2024-07-26 11:52:38.679283,epoch time: 0:01:29.705023,used: 0:29:58.807093,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_11_22_39_seed_9_23065778
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9957461, 'precision': 0.99574006, 'recall': 0.99576235, 'specificity': 0.99576235, 'f1': 0.99574596, 'auroc': 0.99982786, 'binary_precision': 0.99804175, 'binary_recall': 0.99350226, 'binary_specificity': 0.99802244, 'binary_f1_score': 0.9957668}
confusion matrix:
      0     1
0  1514     3
1    10  1529
---- Validation: 
scalar performance:
{'acc': 0.7335907, 'precision': 0.81177294, 'recall': 0.7310598, 'specificity': 0.7310598, 'f1': 0.7143618, 'auroc': 0.93638813, 'binary_precision': 0.9654088, 'binary_recall': 0.47893915, 'binary_specificity': 0.9831804, 'binary_f1_score': 0.6402502}
confusion matrix:
     0    1
0  643   11
1  334  307
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.66086954, 'precision': 0.78560877, 'recall': 0.66086954, 'specificity': 0.66086954, 'f1': 0.6193023, 'auroc': 0.9100945, 'binary_precision': 0.974359, 'binary_recall': 0.33043477, 'binary_specificity': 0.99130434, 'binary_f1_score': 0.4935065}
confusion matrix:
     0   1
0  228   2
1  154  76
early stop counter: 1
val acc:0.7335907220840454, best validation acc: 0.8779922723770142, corresponding to test acc:                         0.856521725654602 / 0.856521725654602
after epoch: 21,now: 2024-07-26 11:54:08.270646,epoch time: 0:01:29.591363,used: 0:31:28.398456,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_11_22_39_seed_9_23065778
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.98658377, 'precision': 0.9867936, 'recall': 0.98666245, 'specificity': 0.98666245, 'f1': 0.98658335, 'auroc': 0.9997889, 'binary_precision': 0.99866754, 'binary_recall': 0.9746424, 'binary_specificity': 0.9986825, 'binary_f1_score': 0.98650867}
confusion matrix:
      0     1
0  1516     2
1    39  1499
---- Validation: 
scalar performance:
{'acc': 0.67258686, 'precision': 0.7832508, 'recall': 0.66942185, 'specificity': 0.66942185, 'f1': 0.6347104, 'auroc': 0.88318014, 'binary_precision': 0.95780593, 'binary_recall': 0.35413417, 'binary_specificity': 0.9847095, 'binary_f1_score': 0.5170843}
confusion matrix:
     0    1
0  644   10
1  414  227
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.55, 'precision': 0.7432184, 'recall': 0.55, 'specificity': 0.55, 'f1': 0.4384786, 'auroc': 0.8679962, 'binary_precision': 0.96, 'binary_recall': 0.104347825, 'binary_specificity': 0.9956522, 'binary_f1_score': 0.18823531}
confusion matrix:
     0   1
0  229   1
1  206  24
early stop counter: 2
val acc:0.6725868582725525, best validation acc: 0.8779922723770142, corresponding to test acc:                         0.856521725654602 / 0.856521725654602
after epoch: 22,now: 2024-07-26 11:55:38.220778,epoch time: 0:01:29.950132,used: 0:32:58.348588,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_11_22_39_seed_9_23065778
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.9947644, 'precision': 0.9947856, 'recall': 0.99475, 'specificity': 0.99475, 'f1': 0.994764, 'auroc': 0.9999207, 'binary_precision': 0.9928803, 'binary_recall': 0.9967511, 'binary_specificity': 0.99274886, 'binary_f1_score': 0.99481195}
confusion matrix:
      0     1
0  1506    11
1     5  1534
---- Validation: 
scalar performance:
{'acc': 0.8625483, 'precision': 0.87035537, 'recall': 0.8618212, 'specificity': 0.8618212, 'f1': 0.86163867, 'auroc': 0.93541247, 'binary_precision': 0.9216758, 'binary_recall': 0.7893916, 'binary_specificity': 0.9342508, 'binary_f1_score': 0.8504202}
confusion matrix:
     0    1
0  611   43
1  135  506
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8043478, 'precision': 0.8538151, 'recall': 0.8043478, 'specificity': 0.8043478, 'f1': 0.7972615, 'auroc': 0.9188658, 'binary_precision': 0.9861111, 'binary_recall': 0.6173913, 'binary_specificity': 0.99130434, 'binary_f1_score': 0.7593582}
confusion matrix:
     0    1
0  228    2
1   88  142
early stop counter: 3
val acc:0.862548291683197, best validation acc: 0.8779922723770142, corresponding to test acc:                         0.856521725654602 / 0.856521725654602
after epoch: 23,now: 2024-07-26 11:57:07.869263,epoch time: 0:01:29.648485,used: 0:34:27.997073,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_11_22_39_seed_9_23065778
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.99345547, 'precision': 0.993467, 'recall': 0.99344665, 'specificity': 0.99344665, 'f1': 0.99345505, 'auroc': 0.9996295, 'binary_precision': 0.9922179, 'binary_recall': 0.9947984, 'binary_specificity': 0.9920949, 'binary_f1_score': 0.9935065}
confusion matrix:
      0     1
0  1506    12
1     8  1530
---- Validation: 
scalar performance:
{'acc': 0.8208494, 'precision': 0.84636617, 'recall': 0.81948245, 'specificity': 0.81948245, 'f1': 0.81703424, 'auroc': 0.92852575, 'binary_precision': 0.9379015, 'binary_recall': 0.68330735, 'binary_specificity': 0.9556575, 'binary_f1_score': 0.7906137}
confusion matrix:
     0    1
0  625   29
1  203  438
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8173913, 'precision': 0.8610753, 'recall': 0.8173913, 'specificity': 0.8173913, 'f1': 0.8116959, 'auroc': 0.91446596, 'binary_precision': 0.9866667, 'binary_recall': 0.6434783, 'binary_specificity': 0.99130434, 'binary_f1_score': 0.77894735}
confusion matrix:
     0    1
0  228    2
1   82  148
early stop counter: 4
val acc:0.8208494186401367, best validation acc: 0.8779922723770142, corresponding to test acc:                         0.856521725654602 / 0.856521725654602
after epoch: 24,now: 2024-07-26 11:58:37.481596,epoch time: 0:01:29.612333,used: 0:35:57.609406,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_11_22_39_seed_9_23065778
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.98756546, 'precision': 0.9875649, 'recall': 0.9875649, 'specificity': 0.9875649, 'f1': 0.9875649, 'auroc': 0.99946976, 'binary_precision': 0.9876463, 'binary_recall': 0.9876463, 'binary_specificity': 0.9874835, 'binary_f1_score': 0.9876463}
confusion matrix:
      0     1
0  1499    19
1    19  1519
---- Validation: 
scalar performance:
{'acc': 0.8293436, 'precision': 0.85999334, 'recall': 0.8278767, 'specificity': 0.8278767, 'f1': 0.8251737, 'auroc': 0.93878543, 'binary_precision': 0.96255505, 'binary_recall': 0.68174726, 'binary_specificity': 0.9740061, 'binary_f1_score': 0.7981734}
confusion matrix:
     0    1
0  637   17
1  204  437
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6695652, 'precision': 0.78939223, 'recall': 0.6695652, 'specificity': 0.6695652, 'f1': 0.63141024, 'auroc': 0.9056711, 'binary_precision': 0.9756098, 'binary_recall': 0.3478261, 'binary_specificity': 0.99130434, 'binary_f1_score': 0.5128205}
confusion matrix:
     0   1
0  228   2
1  150  80
early stop counter: 5
val acc:0.8293436169624329, best validation acc: 0.8779922723770142, corresponding to test acc:                         0.856521725654602 / 0.856521725654602
after epoch: 25,now: 2024-07-26 12:00:07.059104,epoch time: 0:01:29.577508,used: 0:37:27.186914,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_11_22_39_seed_9_23065778
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.99018323, 'precision': 0.9902528, 'recall': 0.99015284, 'specificity': 0.99015284, 'f1': 0.990182, 'auroc': 0.9996244, 'binary_precision': 0.98582476, 'binary_recall': 0.9947984, 'binary_specificity': 0.98550725, 'binary_f1_score': 0.99029124}
confusion matrix:
      0     1
0  1496    22
1     8  1530
---- Validation: 
scalar performance:
{'acc': 0.83861005, 'precision': 0.8564534, 'recall': 0.83748513, 'specificity': 0.83748513, 'f1': 0.83623356, 'auroc': 0.9314121, 'binary_precision': 0.93373495, 'binary_recall': 0.725429, 'binary_specificity': 0.9495413, 'binary_f1_score': 0.8165057}
confusion matrix:
     0    1
0  621   33
1  176  465
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.78913045, 'precision': 0.8348659, 'recall': 0.78913045, 'specificity': 0.78913045, 'f1': 0.7816758, 'auroc': 0.906862, 'binary_precision': 0.95862067, 'binary_recall': 0.6043478, 'binary_specificity': 0.973913, 'binary_f1_score': 0.74133337}
confusion matrix:
     0    1
0  224    6
1   91  139
early stop counter: 6
val acc:0.838610053062439, best validation acc: 0.8779922723770142, corresponding to test acc:                         0.856521725654602 / 0.856521725654602
after epoch: 26,now: 2024-07-26 12:01:36.604227,epoch time: 0:01:29.545123,used: 0:38:56.732037,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_11_22_39_seed_9_23065778
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.98625654, 'precision': 0.9866134, 'recall': 0.98616314, 'specificity': 0.98616314, 'f1': 0.98625124, 'auroc': 0.9997965, 'binary_precision': 0.9752538, 'binary_recall': 0.99805194, 'binary_specificity': 0.9742744, 'binary_f1_score': 0.98652124}
confusion matrix:
      0     1
0  1477    39
1     3  1537
---- Validation: 
scalar performance:
{'acc': 0.8911197, 'precision': 0.89303297, 'recall': 0.8907753, 'specificity': 0.8907753, 'f1': 0.8909157, 'auroc': 0.9475304, 'binary_precision': 0.9180602, 'binary_recall': 0.8564743, 'binary_specificity': 0.9250764, 'binary_f1_score': 0.8861986}
confusion matrix:
     0    1
0  605   49
1   92  549
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.84347826, 'precision': 0.8591193, 'recall': 0.84347826, 'specificity': 0.84347826, 'f1': 0.8417553, 'auroc': 0.9108649, 'binary_precision': 0.93406594, 'binary_recall': 0.73913044, 'binary_specificity': 0.9478261, 'binary_f1_score': 0.82524276}
confusion matrix:
     0    1
0  218   12
1   60  170
better model found
persisted
after epoch: 27,now: 2024-07-26 12:03:06.284945,epoch time: 0:01:29.680718,used: 0:40:26.412755,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_11_22_39_seed_9_23065778
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.99443716, 'precision': 0.99443996, 'recall': 0.99447024, 'specificity': 0.99447024, 'f1': 0.9944371, 'auroc': 0.99989593, 'binary_precision': 0.99869025, 'binary_recall': 0.99025977, 'binary_specificity': 0.9986807, 'binary_f1_score': 0.9944571}
confusion matrix:
      0     1
0  1514     2
1    15  1525
---- Validation: 
scalar performance:
{'acc': 0.74054056, 'precision': 0.82048315, 'recall': 0.73801804, 'specificity': 0.73801804, 'f1': 0.72193253, 'auroc': 0.9393352, 'binary_precision': 0.97805643, 'binary_recall': 0.48673946, 'binary_specificity': 0.9892966, 'binary_f1_score': 0.65000004}
confusion matrix:
     0    1
0  647    7
1  329  312
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6630435, 'precision': 0.78655434, 'recall': 0.6630435, 'specificity': 0.6630435, 'f1': 0.6223497, 'auroc': 0.90867674, 'binary_precision': 0.9746835, 'binary_recall': 0.3347826, 'binary_specificity': 0.99130434, 'binary_f1_score': 0.49838188}
confusion matrix:
     0   1
0  228   2
1  153  77
early stop counter: 1
val acc:0.7405405640602112, best validation acc: 0.8911197185516357, corresponding to test acc:                         0.843478262424469 / 0.856521725654602
after epoch: 28,now: 2024-07-26 12:04:35.980527,epoch time: 0:01:29.695582,used: 0:41:56.108337,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_11_22_39_seed_9_23065778
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9957461, 'precision': 0.9957402, 'recall': 0.9957535, 'specificity': 0.9957535, 'f1': 0.9957459, 'auroc': 0.9999028, 'binary_precision': 0.9967469, 'binary_recall': 0.9948052, 'binary_specificity': 0.99670184, 'binary_f1_score': 0.99577516}
confusion matrix:
      0     1
0  1511     5
1     8  1532
---- Validation: 
scalar performance:
{'acc': 0.84864867, 'precision': 0.8725733, 'recall': 0.8473775, 'specificity': 0.8473775, 'f1': 0.8458333, 'auroc': 0.939346, 'binary_precision': 0.96450937, 'binary_recall': 0.72074884, 'binary_specificity': 0.9740061, 'binary_f1_score': 0.82500005}
confusion matrix:
     0    1
0  637   17
1  179  462
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7478261, 'precision': 0.8213235, 'recall': 0.7478261, 'specificity': 0.7478261, 'f1': 0.7325313, 'auroc': 0.91132796, 'binary_precision': 0.975, 'binary_recall': 0.50869566, 'binary_specificity': 0.98695654, 'binary_f1_score': 0.6685714}
confusion matrix:
     0    1
0  227    3
1  113  117
early stop counter: 2
val acc:0.8486486673355103, best validation acc: 0.8911197185516357, corresponding to test acc:                         0.843478262424469 / 0.856521725654602
after epoch: 29,now: 2024-07-26 12:06:06.764494,epoch time: 0:01:30.783967,used: 0:43:26.892304,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_11_22_39_seed_9_23065778
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.9957461, 'precision': 0.99574083, 'recall': 0.99575293, 'specificity': 0.99575293, 'f1': 0.9957459, 'auroc': 0.99978924, 'binary_precision': 0.9967448, 'binary_recall': 0.9948018, 'binary_specificity': 0.99670404, 'binary_f1_score': 0.99577236}
confusion matrix:
      0     1
0  1512     5
1     8  1531
---- Validation: 
scalar performance:
{'acc': 0.85714287, 'precision': 0.8709781, 'recall': 0.8561749, 'specificity': 0.8561749, 'f1': 0.8555497, 'auroc': 0.94208145, 'binary_precision': 0.94015443, 'binary_recall': 0.75975037, 'binary_specificity': 0.9525994, 'binary_f1_score': 0.84037966}
confusion matrix:
     0    1
0  623   31
1  154  487
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7673913, 'precision': 0.8281979, 'recall': 0.7673913, 'specificity': 0.7673913, 'f1': 0.756094, 'auroc': 0.9040265, 'binary_precision': 0.9694657, 'binary_recall': 0.5521739, 'binary_specificity': 0.9826087, 'binary_f1_score': 0.7036011}
confusion matrix:
     0    1
0  226    4
1  103  127
early stop counter: 3
val acc:0.8571428656578064, best validation acc: 0.8911197185516357, corresponding to test acc:                         0.843478262424469 / 0.856521725654602
after epoch: 30,now: 2024-07-26 12:07:36.169769,epoch time: 0:01:29.405275,used: 0:44:56.297579,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_11_22_39_seed_9_23065778
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 0:44:56.297579 at 2024-07-26 12:07:36.169769
persisted model performance metric: 

scalar performance:
{'acc': 0.84347826, 'precision': 0.8591193, 'recall': 0.84347826, 'specificity': 0.84347826, 'f1': 0.8417553, 'auroc': 0.9108649, 'binary_precision': 0.93406594, 'binary_recall': 0.73913044, 'binary_specificity': 0.9478261, 'binary_f1_score': 0.82524276}
confusion matrix:
     0    1
0  218   12
1   60  170
oracle model performance metric: 

scalar performance:
{'acc': 0.8565217, 'precision': 0.87732077, 'recall': 0.8565217, 'specificity': 0.8565217, 'f1': 0.85451686, 'auroc': 0.91746694, 'binary_precision': 0.96590906, 'binary_recall': 0.73913044, 'binary_specificity': 0.973913, 'binary_f1_score': 0.83743846}
confusion matrix:
     0    1
0  224    6
1   60  170
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_irm_10seeds_nofreeze_2024-07-26_02-28-54/rule_results/1.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_irm_10seeds_nofreeze_2024-07-26_02-28-54/confusion_matrix/1.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 455402 KiB |  13219 MiB | 734259 GiB | 734258 GiB |
|       from large pool | 414803 KiB |  13181 MiB | 725537 GiB | 725537 GiB |
|       from small pool |  40598 KiB |     60 MiB |   8721 GiB |   8721 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 455402 KiB |  13219 MiB | 734259 GiB | 734258 GiB |
|       from large pool | 414803 KiB |  13181 MiB | 725537 GiB | 725537 GiB |
|       from small pool |  40598 KiB |     60 MiB |   8721 GiB |   8721 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 447482 KiB |  13213 MiB | 733269 GiB | 733269 GiB |
|       from large pool | 407075 KiB |  13175 MiB | 724566 GiB | 724566 GiB |
|       from small pool |  40407 KiB |     60 MiB |   8703 GiB |   8703 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  14478 MiB |  14482 MiB | 136826 MiB | 122348 MiB |
|       from large pool |  14412 MiB |  14412 MiB | 136616 MiB | 122204 MiB |
|       from small pool |     66 MiB |     70 MiB |    210 MiB |    144 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 445718 KiB |   1236 MiB | 513296 GiB | 513295 GiB |
|       from large pool | 435116 KiB |   1229 MiB | 504519 GiB | 504518 GiB |
|       from small pool |  10601 KiB |     46 MiB |   8776 GiB |   8776 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    1310    |    2598    |  129760 K  |  129758 K  |
|       from large pool |     187    |    1413    |   66042 K  |   66042 K  |
|       from small pool |    1123    |    1419    |   63717 K  |   63716 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    1310    |    2598    |  129760 K  |  129758 K  |
|       from large pool |     187    |    1413    |   66042 K  |   66042 K  |
|       from small pool |    1123    |    1419    |   63717 K  |   63716 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     635    |     637    |    5790    |    5155    |
|       from large pool |     602    |     602    |    5685    |    5083    |
|       from small pool |      33    |      35    |     105    |      72    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      94    |     652    |   87984 K  |   87984 K  |
|       from large pool |      38    |     605    |   50599 K  |   50599 K  |
|       from small pool |      56    |     237    |   37385 K  |   37385 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13219 MiB | 734259 GiB | 734259 GiB |
|       from large pool |  16640 KiB |  13181 MiB | 725537 GiB | 725537 GiB |
|       from small pool |      0 KiB |     60 MiB |   8721 GiB |   8721 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13219 MiB | 734259 GiB | 734259 GiB |
|       from large pool |  16640 KiB |  13181 MiB | 725537 GiB | 725537 GiB |
|       from small pool |      0 KiB |     60 MiB |   8721 GiB |   8721 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13213 MiB | 733269 GiB | 733269 GiB |
|       from large pool |  16640 KiB |  13175 MiB | 724566 GiB | 724566 GiB |
|       from small pool |      0 KiB |     60 MiB |   8703 GiB |   8703 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    880 MiB |  14482 MiB | 136826 MiB | 135946 MiB |
|       from large pool |    830 MiB |  14412 MiB | 136616 MiB | 135786 MiB |
|       from small pool |     50 MiB |     70 MiB |    210 MiB |    160 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1236 MiB | 513296 GiB | 513296 GiB |
|       from large pool |  24320 KiB |   1229 MiB | 504519 GiB | 504519 GiB |
|       from small pool |      0 KiB |     46 MiB |   8776 GiB |   8776 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    2598    |  129760 K  |  129760 K  |
|       from large pool |       2    |    1413    |   66042 K  |   66042 K  |
|       from small pool |       0    |    1419    |   63717 K  |   63717 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    2598    |  129760 K  |  129760 K  |
|       from large pool |       2    |    1413    |   66042 K  |   66042 K  |
|       from small pool |       0    |    1419    |   63717 K  |   63717 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      62    |     637    |    5790    |    5728    |
|       from large pool |      37    |     602    |    5685    |    5648    |
|       from small pool |      25    |      35    |     105    |      80    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |     652    |   87985 K  |   87985 K  |
|       from large pool |       4    |     605    |   50599 K  |   50599 K  |
|       from small pool |       0    |     237    |   37385 K  |   37385 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Fri Jul 26 12:07:43 2024]
Finished job 0.
1 of 1 steps (100%) done
