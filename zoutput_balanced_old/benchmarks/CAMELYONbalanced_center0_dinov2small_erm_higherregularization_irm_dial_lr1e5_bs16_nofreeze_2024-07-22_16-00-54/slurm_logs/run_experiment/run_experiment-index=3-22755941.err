Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Mon Jul 22 22:33:42 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_higherregularization_irm_dial_lr1e5_bs16_nofreeze_2024-07-22_16-00-54/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_higherregularization_irm_dial_lr1e5_bs16_nofreeze_2024-07-22_16-00-54/rule_results/3.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=3
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/swiglu_ffn.py:51: UserWarning: xFormers is not available (SwiGLU)
  warnings.warn("xFormers is not available (SwiGLU)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/attention.py:33: UserWarning: xFormers is not available (Attention)
  warnings.warn("xFormers is not available (Attention)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/block.py:40: UserWarning: xFormers is not available (Block)
  warnings.warn("xFormers is not available (Block)")
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'888c1ef2'
model name: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_22_22_37_22_seed_0_22755941

 Experiment start at: 2024-07-22 22:37:22.482411
before training, model accuracy: 0.569767415523529
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9684245, 'precision': 0.9685369, 'recall': 0.9683512, 'specificity': 0.9683512, 'f1': 0.9684143, 'auroc': 0.996601, 'binary_precision': 0.96374047, 'binary_recall': 0.97427654, 'binary_specificity': 0.9624258, 'binary_f1_score': 0.96897984}
confusion matrix:
      0     1
0  1460    57
1    40  1515
---- Validation: 
scalar performance:
{'acc': 0.73524845, 'precision': 0.7361293, 'recall': 0.7347518, 'specificity': 0.7347518, 'f1': 0.73469174, 'auroc': 0.8360734, 'binary_precision': 0.74747473, 'binary_recall': 0.6992126, 'binary_specificity': 0.770291, 'binary_f1_score': 0.72253865}
confusion matrix:
     0    1
0  503  150
1  191  444
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.80697674, 'precision': 0.8105304, 'recall': 0.80697674, 'specificity': 0.80697674, 'f1': 0.80642295, 'auroc': 0.90520275, 'binary_precision': 0.7773109, 'binary_recall': 0.8604651, 'binary_specificity': 0.75348836, 'binary_f1_score': 0.81677705}
confusion matrix:
     0    1
0  162   53
1   30  185
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-22 22:42:02.399393,epoch time: 0:04:39.916982,used: 0:04:39.916982,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_22_22_37_22_seed_0_22755941
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9749349, 'precision': 0.9750823, 'recall': 0.9748411, 'specificity': 0.9748411, 'f1': 0.9749243, 'auroc': 0.99714303, 'binary_precision': 0.9695625, 'binary_recall': 0.98138636, 'binary_specificity': 0.96829593, 'binary_f1_score': 0.9754386}
confusion matrix:
      0     1
0  1466    48
1    29  1529
---- Validation: 
scalar performance:
{'acc': 0.73136646, 'precision': 0.7523911, 'recall': 0.72929543, 'specificity': 0.72929543, 'f1': 0.72445416, 'auroc': 0.8369199, 'binary_precision': 0.8218263, 'binary_recall': 0.5811024, 'binary_specificity': 0.8774885, 'binary_f1_score': 0.6808118}
confusion matrix:
     0    1
0  573   80
1  266  369
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8511628, 'precision': 0.8522601, 'recall': 0.8511628, 'specificity': 0.8511628, 'f1': 0.85104674, 'auroc': 0.93114114, 'binary_precision': 0.8325991, 'binary_recall': 0.87906975, 'binary_specificity': 0.82325584, 'binary_f1_score': 0.85520357}
confusion matrix:
     0    1
0  177   38
1   26  189
new oracle model saved
early stop counter: 1
val acc:0.7313664555549622, best validation acc: 0.7352484464645386, corresponding to test acc:                         0.8069767355918884 / 0.8511627912521362
after epoch: 2,now: 2024-07-22 22:46:07.062651,epoch time: 0:04:04.663258,used: 0:08:44.580240,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_22_22_37_22_seed_0_22755941
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.976237, 'precision': 0.9768889, 'recall': 0.9765681, 'specificity': 0.9765681, 'f1': 0.9762356, 'auroc': 0.99884427, 'binary_precision': 0.9986577, 'binary_recall': 0.954458, 'binary_specificity': 0.99867815, 'binary_f1_score': 0.97605777}
confusion matrix:
      0     1
0  1511     2
1    71  1488
---- Validation: 
scalar performance:
{'acc': 0.5954969, 'precision': 0.75110453, 'recall': 0.5899157, 'specificity': 0.5899157, 'f1': 0.5149, 'auroc': 0.9212098, 'binary_precision': 0.9453125, 'binary_recall': 0.19055118, 'binary_specificity': 0.9892802, 'binary_f1_score': 0.31716907}
confusion matrix:
     0    1
0  646    7
1  514  121
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.51627904, 'precision': 0.75413716, 'recall': 0.51627904, 'specificity': 0.51627904, 'f1': 0.36852214, 'auroc': 0.928372, 'binary_precision': 1.0, 'binary_recall': 0.03255814, 'binary_specificity': 1.0, 'binary_f1_score': 0.06306306}
confusion matrix:
     0  1
0  215  0
1  208  7
early stop counter: 2
val acc:0.5954968929290771, best validation acc: 0.7352484464645386, corresponding to test acc:                         0.8069767355918884 / 0.8511627912521362
after epoch: 3,now: 2024-07-22 22:50:11.843382,epoch time: 0:04:04.780731,used: 0:12:49.360971,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_22_22_37_22_seed_0_22755941
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.97721356, 'precision': 0.977928, 'recall': 0.9769757, 'specificity': 0.9769757, 'f1': 0.97719216, 'auroc': 0.99902534, 'binary_precision': 0.96268654, 'binary_recall': 0.99358153, 'binary_specificity': 0.9603699, 'binary_f1_score': 0.9778901}
confusion matrix:
      0     1
0  1454    60
1    10  1548
---- Validation: 
scalar performance:
{'acc': 0.8175466, 'precision': 0.834399, 'recall': 0.8191062, 'specificity': 0.8191062, 'f1': 0.81569785, 'auroc': 0.9286804, 'binary_precision': 0.7557545, 'binary_recall': 0.93070865, 'binary_specificity': 0.70750386, 'binary_f1_score': 0.83415663}
confusion matrix:
     0    1
0  462  191
1   44  591
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.83255816, 'precision': 0.84709525, 'recall': 0.83255816, 'specificity': 0.83255816, 'f1': 0.83078635, 'auroc': 0.95011353, 'binary_precision': 0.7760618, 'binary_recall': 0.9348837, 'binary_specificity': 0.73023254, 'binary_f1_score': 0.84810126}
confusion matrix:
     0    1
0  157   58
1   14  201
better model found
persisted
after epoch: 4,now: 2024-07-22 22:54:17.017648,epoch time: 0:04:05.174266,used: 0:16:54.535237,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_22_22_37_22_seed_0_22755941
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.98307294, 'precision': 0.98305213, 'recall': 0.9831209, 'specificity': 0.9831209, 'f1': 0.98307145, 'auroc': 0.9990678, 'binary_precision': 0.98704666, 'binary_recall': 0.97943443, 'binary_specificity': 0.9868074, 'binary_f1_score': 0.98322576}
confusion matrix:
      0     1
0  1496    20
1    32  1524
---- Validation: 
scalar performance:
{'acc': 0.86180127, 'precision': 0.86672384, 'recall': 0.86099285, 'specificity': 0.86099285, 'f1': 0.8611232, 'auroc': 0.9221159, 'binary_precision': 0.90586144, 'binary_recall': 0.8031496, 'binary_specificity': 0.9188361, 'binary_f1_score': 0.851419}
confusion matrix:
     0    1
0  600   53
1  125  510
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.89534885, 'precision': 0.90741485, 'recall': 0.89534885, 'specificity': 0.89534885, 'f1': 0.8945682, 'auroc': 0.95314217, 'binary_precision': 0.9775281, 'binary_recall': 0.80930233, 'binary_specificity': 0.98139536, 'binary_f1_score': 0.8854962}
confusion matrix:
     0    1
0  211    4
1   41  174
new oracle model saved
better model found
persisted
after epoch: 5,now: 2024-07-22 22:58:22.824605,epoch time: 0:04:05.806957,used: 0:21:00.342194,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_22_22_37_22_seed_0_22755941
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.99153644, 'precision': 0.991544, 'recall': 0.99152654, 'specificity': 0.99152654, 'f1': 0.9915348, 'auroc': 0.9995752, 'binary_precision': 0.9910141, 'binary_recall': 0.99228793, 'binary_specificity': 0.99076515, 'binary_f1_score': 0.9916506}
confusion matrix:
      0     1
0  1502    14
1    12  1544
---- Validation: 
scalar performance:
{'acc': 0.85559005, 'precision': 0.8634333, 'recall': 0.8545635, 'specificity': 0.8545635, 'f1': 0.854529, 'auroc': 0.91876864, 'binary_precision': 0.9134438, 'binary_recall': 0.78110236, 'binary_specificity': 0.92802453, 'binary_f1_score': 0.8421052}
confusion matrix:
     0    1
0  606   47
1  139  496
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.88837206, 'precision': 0.89176214, 'recall': 0.88837206, 'specificity': 0.88837206, 'f1': 0.88813007, 'auroc': 0.9435587, 'binary_precision': 0.92820513, 'binary_recall': 0.8418605, 'binary_specificity': 0.9348837, 'binary_f1_score': 0.8829269}
confusion matrix:
     0    1
0  201   14
1   34  181
early stop counter: 1
val acc:0.8555900454521179, best validation acc: 0.861801266670227, corresponding to test acc:                         0.895348846912384 / 0.895348846912384
after epoch: 6,now: 2024-07-22 23:02:27.124792,epoch time: 0:04:04.300187,used: 0:25:04.642381,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_22_22_37_22_seed_0_22755941
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.99153644, 'precision': 0.99151796, 'recall': 0.99156046, 'specificity': 0.99156046, 'f1': 0.9915354, 'auroc': 0.99947476, 'binary_precision': 0.9935484, 'binary_recall': 0.98971725, 'binary_specificity': 0.9934037, 'binary_f1_score': 0.9916291}
confusion matrix:
      0     1
0  1506    10
1    16  1540
---- Validation: 
scalar performance:
{'acc': 0.83152175, 'precision': 0.85815173, 'recall': 0.8296114, 'specificity': 0.8296114, 'f1': 0.8277335, 'auroc': 0.93838733, 'binary_precision': 0.95238096, 'binary_recall': 0.6929134, 'binary_specificity': 0.96630937, 'binary_f1_score': 0.80218774}
confusion matrix:
     0    1
0  631   22
1  195  440
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7348837, 'precision': 0.8181685, 'recall': 0.7348837, 'specificity': 0.7348837, 'f1': 0.71631944, 'auroc': 0.9440563, 'binary_precision': 0.9809524, 'binary_recall': 0.47906977, 'binary_specificity': 0.9906977, 'binary_f1_score': 0.64374995}
confusion matrix:
     0    1
0  213    2
1  112  103
early stop counter: 2
val acc:0.83152174949646, best validation acc: 0.861801266670227, corresponding to test acc:                         0.895348846912384 / 0.895348846912384
after epoch: 7,now: 2024-07-22 23:06:31.210827,epoch time: 0:04:04.086035,used: 0:29:08.728416,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_22_22_37_22_seed_0_22755941
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9742839, 'precision': 0.97519493, 'recall': 0.97459006, 'specificity': 0.97459006, 'f1': 0.9742797, 'auroc': 0.99958885, 'binary_precision': 0.9993234, 'binary_recall': 0.94983923, 'binary_specificity': 0.99934083, 'binary_f1_score': 0.9739531}
confusion matrix:
      0     1
0  1516     1
1    78  1477
---- Validation: 
scalar performance:
{'acc': 0.7212733, 'precision': 0.81157833, 'recall': 0.71747476, 'specificity': 0.71747476, 'f1': 0.6972239, 'auroc': 0.93949366, 'binary_precision': 0.9758621, 'binary_recall': 0.4456693, 'binary_specificity': 0.9892802, 'binary_f1_score': 0.61189187}
confusion matrix:
     0    1
0  646    7
1  352  283
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.73255813, 'precision': 0.82575756, 'recall': 0.73255813, 'specificity': 0.73255813, 'f1': 0.7119557, 'auroc': 0.92941046, 'binary_precision': 1.0, 'binary_recall': 0.4651163, 'binary_specificity': 1.0, 'binary_f1_score': 0.63492066}
confusion matrix:
     0    1
0  215    0
1  115  100
early stop counter: 3
val acc:0.7212733030319214, best validation acc: 0.861801266670227, corresponding to test acc:                         0.895348846912384 / 0.895348846912384
after epoch: 8,now: 2024-07-22 23:10:38.627617,epoch time: 0:04:07.416790,used: 0:33:16.145206,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_22_22_37_22_seed_0_22755941
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9889323, 'precision': 0.98891854, 'recall': 0.9889467, 'specificity': 0.9889467, 'f1': 0.98893094, 'auroc': 0.999359, 'binary_precision': 0.99032885, 'binary_recall': 0.98778135, 'binary_specificity': 0.99011207, 'binary_f1_score': 0.9890535}
confusion matrix:
      0     1
0  1502    15
1    19  1536
---- Validation: 
scalar performance:
{'acc': 0.9006211, 'precision': 0.9042699, 'recall': 0.89997226, 'specificity': 0.89997226, 'f1': 0.9002739, 'auroc': 0.95012486, 'binary_precision': 0.9393414, 'binary_recall': 0.8535433, 'binary_specificity': 0.94640124, 'binary_f1_score': 0.8943894}
confusion matrix:
     0    1
0  618   35
1   93  542
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.82790697, 'precision': 0.8667877, 'recall': 0.82790697, 'specificity': 0.82790697, 'f1': 0.82322216, 'auroc': 0.9253651, 'binary_precision': 0.9862069, 'binary_recall': 0.66511625, 'binary_specificity': 0.9906977, 'binary_f1_score': 0.79444444}
confusion matrix:
     0    1
0  213    2
1   72  143
better model found
persisted
after epoch: 9,now: 2024-07-22 23:14:45.345995,epoch time: 0:04:06.718378,used: 0:37:22.863584,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_22_22_37_22_seed_0_22755941
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9892578, 'precision': 0.9892945, 'recall': 0.98922634, 'specificity': 0.98922634, 'f1': 0.9892553, 'auroc': 0.9995053, 'binary_precision': 0.9872041, 'binary_recall': 0.9916452, 'binary_specificity': 0.9868074, 'binary_f1_score': 0.9894197}
confusion matrix:
      0     1
0  1496    20
1    13  1543
---- Validation: 
scalar performance:
{'acc': 0.86413044, 'precision': 0.8795831, 'recall': 0.8627256, 'specificity': 0.8627256, 'f1': 0.86238635, 'auroc': 0.94553304, 'binary_precision': 0.9527559, 'binary_recall': 0.7622047, 'binary_specificity': 0.9632466, 'binary_f1_score': 0.84689415}
confusion matrix:
     0    1
0  629   24
1  151  484
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7976744, 'precision': 0.8528205, 'recall': 0.7976744, 'specificity': 0.7976744, 'f1': 0.789447, 'auroc': 0.93529475, 'binary_precision': 0.99230766, 'binary_recall': 0.6, 'binary_specificity': 0.9953488, 'binary_f1_score': 0.74782604}
confusion matrix:
     0    1
0  214    1
1   86  129
early stop counter: 1
val acc:0.864130437374115, best validation acc: 0.9006211161613464, corresponding to test acc:                         0.8279069662094116 / 0.895348846912384
after epoch: 10,now: 2024-07-22 23:18:52.235181,epoch time: 0:04:06.889186,used: 0:41:29.752770,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_22_22_37_22_seed_0_22755941
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9889323, 'precision': 0.989074, 'recall': 0.9888501, 'specificity': 0.9888501, 'f1': 0.9889281, 'auroc': 0.99952054, 'binary_precision': 0.9834921, 'binary_recall': 0.9948619, 'binary_specificity': 0.9828383, 'binary_f1_score': 0.9891443}
confusion matrix:
      0     1
0  1489    26
1     8  1549
---- Validation: 
scalar performance:
{'acc': 0.8462733, 'precision': 0.85885096, 'recall': 0.8449627, 'specificity': 0.8449627, 'f1': 0.84454, 'auroc': 0.92960227, 'binary_precision': 0.92263055, 'binary_recall': 0.7511811, 'binary_specificity': 0.93874425, 'binary_f1_score': 0.828125}
confusion matrix:
     0    1
0  613   40
1  158  477
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8581395, 'precision': 0.879493, 'recall': 0.8581395, 'specificity': 0.8581395, 'f1': 0.85611546, 'auroc': 0.92783123, 'binary_precision': 0.9695122, 'binary_recall': 0.73953485, 'binary_specificity': 0.9767442, 'binary_f1_score': 0.8390501}
confusion matrix:
     0    1
0  210    5
1   56  159
early stop counter: 2
val acc:0.8462733030319214, best validation acc: 0.9006211161613464, corresponding to test acc:                         0.8279069662094116 / 0.895348846912384
after epoch: 11,now: 2024-07-22 23:22:56.539978,epoch time: 0:04:04.304797,used: 0:45:34.057567,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_22_22_37_22_seed_0_22755941
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.99153644, 'precision': 0.99151945, 'recall': 0.9916061, 'specificity': 0.9916061, 'f1': 0.9915359, 'auroc': 0.9997088, 'binary_precision': 0.99675536, 'binary_recall': 0.98651254, 'binary_specificity': 0.9966997, 'binary_f1_score': 0.9916075}
confusion matrix:
      0     1
0  1510     5
1    21  1536
---- Validation: 
scalar performance:
{'acc': 0.64751554, 'precision': 0.7666689, 'recall': 0.6427802, 'specificity': 0.6427802, 'f1': 0.5990015, 'auroc': 0.9169599, 'binary_precision': 0.9414634, 'binary_recall': 0.30393702, 'binary_specificity': 0.9816233, 'binary_f1_score': 0.4595238}
confusion matrix:
     0    1
0  641   12
1  442  193
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.60697675, 'precision': 0.7799479, 'recall': 0.60697675, 'specificity': 0.60697675, 'f1': 0.53517675, 'auroc': 0.9367442, 'binary_precision': 1.0, 'binary_recall': 0.2139535, 'binary_specificity': 1.0, 'binary_f1_score': 0.35249043}
confusion matrix:
     0   1
0  215   0
1  169  46
early stop counter: 3
val acc:0.6475155353546143, best validation acc: 0.9006211161613464, corresponding to test acc:                         0.8279069662094116 / 0.895348846912384
after epoch: 12,now: 2024-07-22 23:27:03.142596,epoch time: 0:04:06.602618,used: 0:49:40.660185,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_22_22_37_22_seed_0_22755941
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9895833, 'precision': 0.9896465, 'recall': 0.9897088, 'specificity': 0.9897088, 'f1': 0.98958325, 'auroc': 0.99962485, 'binary_precision': 0.9993447, 'binary_recall': 0.98007715, 'binary_specificity': 0.99934036, 'binary_f1_score': 0.98961717}
confusion matrix:
      0     1
0  1515     1
1    31  1525
---- Validation: 
scalar performance:
{'acc': 0.7236025, 'precision': 0.7952774, 'recall': 0.7201191, 'specificity': 0.7201191, 'f1': 0.7036761, 'auroc': 0.92883056, 'binary_precision': 0.9373041, 'binary_recall': 0.47086614, 'binary_specificity': 0.96937215, 'binary_f1_score': 0.6268344}
confusion matrix:
     0    1
0  633   20
1  336  299
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.67906976, 'precision': 0.7874032, 'recall': 0.67906976, 'specificity': 0.67906976, 'f1': 0.64568055, 'auroc': 0.9179448, 'binary_precision': 0.96385545, 'binary_recall': 0.37209302, 'binary_specificity': 0.9860465, 'binary_f1_score': 0.53691274}
confusion matrix:
     0   1
0  212   3
1  135  80
early stop counter: 4
val acc:0.7236024737358093, best validation acc: 0.9006211161613464, corresponding to test acc:                         0.8279069662094116 / 0.895348846912384
after epoch: 13,now: 2024-07-22 23:31:09.123282,epoch time: 0:04:05.980686,used: 0:53:46.640871,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_22_22_37_22_seed_0_22755941
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.98567706, 'precision': 0.98576975, 'recall': 0.9858258, 'specificity': 0.9858258, 'f1': 0.985677, 'auroc': 0.9983382, 'binary_precision': 0.996717, 'binary_recall': 0.9749518, 'binary_specificity': 0.9966997, 'binary_f1_score': 0.9857143}
confusion matrix:
      0     1
0  1510     5
1    39  1518
---- Validation: 
scalar performance:
{'acc': 0.7282609, 'precision': 0.80404246, 'recall': 0.724735, 'specificity': 0.724735, 'f1': 0.70816344, 'auroc': 0.92743003, 'binary_precision': 0.95238096, 'binary_recall': 0.47244096, 'binary_specificity': 0.9770291, 'binary_f1_score': 0.631579}
confusion matrix:
     0    1
0  638   15
1  335  300
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.80930233, 'precision': 0.8590082, 'recall': 0.80930233, 'specificity': 0.80930233, 'f1': 0.80246496, 'auroc': 0.9204976, 'binary_precision': 0.9925926, 'binary_recall': 0.6232558, 'binary_specificity': 0.9953488, 'binary_f1_score': 0.7657143}
confusion matrix:
     0    1
0  214    1
1   81  134
early stop counter: 5
val acc:0.72826087474823, best validation acc: 0.9006211161613464, corresponding to test acc:                         0.8279069662094116 / 0.895348846912384
after epoch: 14,now: 2024-07-22 23:35:15.252347,epoch time: 0:04:06.129065,used: 0:57:52.769936,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_22_22_37_22_seed_0_22755941
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 14 with time: 0:57:52.769936 at 2024-07-22 23:35:15.252347
persisted model performance metric: 

scalar performance:
{'acc': 0.82790697, 'precision': 0.8667877, 'recall': 0.82790697, 'specificity': 0.82790697, 'f1': 0.82322216, 'auroc': 0.9253651, 'binary_precision': 0.9862069, 'binary_recall': 0.66511625, 'binary_specificity': 0.9906977, 'binary_f1_score': 0.79444444}
confusion matrix:
     0    1
0  213    2
1   72  143
oracle model performance metric: 

scalar performance:
{'acc': 0.89534885, 'precision': 0.90741485, 'recall': 0.89534885, 'specificity': 0.89534885, 'f1': 0.8945682, 'auroc': 0.95314217, 'binary_precision': 0.9775281, 'binary_recall': 0.80930233, 'binary_specificity': 0.98139536, 'binary_f1_score': 0.8854962}
confusion matrix:
     0    1
0  211    4
1   41  174
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_higherregularization_irm_dial_lr1e5_bs16_nofreeze_2024-07-22_16-00-54/rule_results/3.csv
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_higherregularization_irm_dial_lr1e5_bs16_nofreeze_2024-07-22_16-00-54/rule_results/3.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_higherregularization_irm_dial_lr1e5_bs16_nofreeze_2024-07-22_16-00-54/confusion_matrix/3.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 457222 KiB |   8393 MiB | 124212 GiB | 124211 GiB |
|       from large pool | 416629 KiB |   8356 MiB | 122836 GiB | 122836 GiB |
|       from small pool |  40592 KiB |     56 MiB |   1375 GiB |   1375 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 457222 KiB |   8393 MiB | 124212 GiB | 124211 GiB |
|       from large pool | 416629 KiB |   8356 MiB | 122836 GiB | 122836 GiB |
|       from small pool |  40592 KiB |     56 MiB |   1375 GiB |   1375 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 447480 KiB |   8387 MiB | 124176 GiB | 124175 GiB |
|       from large pool | 407075 KiB |   8350 MiB | 122801 GiB | 122801 GiB |
|       from small pool |  40405 KiB |     56 MiB |   1374 GiB |   1374 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   9162 MiB |   9162 MiB |   9162 MiB |      0 B   |
|       from large pool |   9098 MiB |   9098 MiB |   9098 MiB |      0 B   |
|       from small pool |     64 MiB |     64 MiB |     64 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory | 323066 KiB |    808 MiB |  73759 GiB |  73759 GiB |
|       from large pool | 314506 KiB |    802 MiB |  72368 GiB |  72367 GiB |
|       from small pool |   8559 KiB |     13 MiB |   1391 GiB |   1391 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    1298    |    1910    |   17229 K  |   17227 K  |
|       from large pool |     187    |     940    |   11253 K  |   11253 K  |
|       from small pool |    1111    |    1407    |    5975 K  |    5974 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    1298    |    1910    |   17229 K  |   17227 K  |
|       from large pool |     187    |     940    |   11253 K  |   11253 K  |
|       from small pool |    1111    |    1407    |    5975 K  |    5974 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     412    |     412    |     412    |       0    |
|       from large pool |     380    |     380    |     380    |       0    |
|       from small pool |      32    |      32    |      32    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      73    |     434    |    9958 K  |    9958 K  |
|       from large pool |      27    |     383    |    7499 K  |    7499 K  |
|       from small pool |      46    |     222    |    2459 K  |    2459 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   8393 MiB | 124212 GiB | 124212 GiB |
|       from large pool |  16640 KiB |   8356 MiB | 122836 GiB | 122836 GiB |
|       from small pool |      0 KiB |     56 MiB |   1375 GiB |   1375 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   8393 MiB | 124212 GiB | 124212 GiB |
|       from large pool |  16640 KiB |   8356 MiB | 122836 GiB | 122836 GiB |
|       from small pool |      0 KiB |     56 MiB |   1375 GiB |   1375 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   8387 MiB | 124176 GiB | 124176 GiB |
|       from large pool |  16640 KiB |   8350 MiB | 122801 GiB | 122801 GiB |
|       from small pool |      0 KiB |     56 MiB |   1374 GiB |   1374 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 780288 KiB |   9162 MiB |   9162 MiB |   8400 MiB |
|       from large pool | 731136 KiB |   9098 MiB |   9098 MiB |   8384 MiB |
|       from small pool |  49152 KiB |     64 MiB |     64 MiB |     16 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |    808 MiB |  73759 GiB |  73759 GiB |
|       from large pool |  24320 KiB |    802 MiB |  72368 GiB |  72368 GiB |
|       from small pool |      0 KiB |     24 MiB |   1391 GiB |   1391 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    1910    |   17229 K  |   17229 K  |
|       from large pool |       2    |     940    |   11253 K  |   11253 K  |
|       from small pool |       0    |    1407    |    5975 K  |    5975 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    1910    |   17229 K  |   17229 K  |
|       from large pool |       2    |     940    |   11253 K  |   11253 K  |
|       from small pool |       0    |    1407    |    5975 K  |    5975 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      57    |     412    |     412    |     355    |
|       from large pool |      33    |     380    |     380    |     347    |
|       from small pool |      24    |      32    |      32    |       8    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     434    |    9959 K  |    9959 K  |
|       from large pool |       3    |     383    |    7499 K  |    7499 K  |
|       from small pool |       0    |     222    |    2460 K  |    2460 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   8393 MiB | 124212 GiB | 124212 GiB |
|       from large pool |  16640 KiB |   8356 MiB | 122836 GiB | 122836 GiB |
|       from small pool |      0 KiB |     56 MiB |   1375 GiB |   1375 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   8393 MiB | 124212 GiB | 124212 GiB |
|       from large pool |  16640 KiB |   8356 MiB | 122836 GiB | 122836 GiB |
|       from small pool |      0 KiB |     56 MiB |   1375 GiB |   1375 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   8387 MiB | 124176 GiB | 124176 GiB |
|       from large pool |  16640 KiB |   8350 MiB | 122801 GiB | 122801 GiB |
|       from small pool |      0 KiB |     56 MiB |   1374 GiB |   1374 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 780288 KiB |   9162 MiB |   9162 MiB |   8400 MiB |
|       from large pool | 731136 KiB |   9098 MiB |   9098 MiB |   8384 MiB |
|       from small pool |  49152 KiB |     64 MiB |     64 MiB |     16 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |    808 MiB |  73759 GiB |  73759 GiB |
|       from large pool |  24320 KiB |    802 MiB |  72368 GiB |  72368 GiB |
|       from small pool |      0 KiB |     24 MiB |   1391 GiB |   1391 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    1910    |   17229 K  |   17229 K  |
|       from large pool |       2    |     940    |   11253 K  |   11253 K  |
|       from small pool |       0    |    1407    |    5975 K  |    5975 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    1910    |   17229 K  |   17229 K  |
|       from large pool |       2    |     940    |   11253 K  |   11253 K  |
|       from small pool |       0    |    1407    |    5975 K  |    5975 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      57    |     412    |     412    |     355    |
|       from large pool |      33    |     380    |     380    |     347    |
|       from small pool |      24    |      32    |      32    |       8    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     434    |    9959 K  |    9959 K  |
|       from large pool |       3    |     383    |    7499 K  |    7499 K  |
|       from small pool |       0    |     222    |    2460 K  |    2460 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'888c1ef2'
model name: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_22_23_36_32_seed_1_22755941

 Experiment start at: 2024-07-22 23:36:32.365728
before training, model accuracy: 0.6177777647972107
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.93391925, 'precision': 0.94098836, 'recall': 0.9347267, 'specificity': 0.9347267, 'f1': 0.9337281, 'auroc': 0.99697113, 'binary_precision': 1.0, 'binary_recall': 0.8694534, 'binary_specificity': 1.0, 'binary_f1_score': 0.9301685}
confusion matrix:
      0     1
0  1517     0
1   203  1352
---- Validation: 
scalar performance:
{'acc': 0.5480094, 'precision': 0.7308316, 'recall': 0.5405786, 'specificity': 0.5405786, 'f1': 0.42526096, 'auroc': 0.91041374, 'binary_precision': 0.9322034, 'binary_recall': 0.08730159, 'binary_specificity': 0.9938556, 'binary_f1_score': 0.15965167}
confusion matrix:
     0   1
0  647   4
1  575  55
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5377778, 'precision': 0.7598152, 'recall': 0.5377778, 'specificity': 0.5377778, 'f1': 0.41219324, 'auroc': 0.9133827, 'binary_precision': 1.0, 'binary_recall': 0.075555556, 'binary_specificity': 1.0, 'binary_f1_score': 0.14049587}
confusion matrix:
     0   1
0  225   0
1  208  17
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-22 23:40:53.593476,epoch time: 0:04:21.227748,used: 0:04:21.227748,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_22_23_36_32_seed_1_22755941
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9576823, 'precision': 0.9605044, 'recall': 0.9572247, 'specificity': 0.9572247, 'f1': 0.95758116, 'auroc': 0.99780834, 'binary_precision': 0.92741454, 'binary_recall': 0.9942122, 'binary_specificity': 0.9202373, 'binary_f1_score': 0.95965236}
confusion matrix:
      0     1
0  1396   121
1     9  1546
---- Validation: 
scalar performance:
{'acc': 0.8001561, 'precision': 0.8169776, 'recall': 0.8020225, 'specificity': 0.8020225, 'f1': 0.79810876, 'auroc': 0.9013581, 'binary_precision': 0.7397436, 'binary_recall': 0.915873, 'binary_specificity': 0.68817204, 'binary_f1_score': 0.8184397}
confusion matrix:
     0    1
0  448  203
1   53  577
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7355555, 'precision': 0.7792479, 'recall': 0.7355555, 'specificity': 0.7355555, 'f1': 0.72479045, 'auroc': 0.9046518, 'binary_precision': 0.6687898, 'binary_recall': 0.93333334, 'binary_specificity': 0.5377778, 'binary_f1_score': 0.77922076}
confusion matrix:
     0    1
0  121  104
1   15  210
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-07-22 23:44:58.195108,epoch time: 0:04:04.601632,used: 0:08:25.829380,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_22_23_36_32_seed_1_22755941
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.98567706, 'precision': 0.9856833, 'recall': 0.9856669, 'specificity': 0.9856669, 'f1': 0.9856747, 'auroc': 0.99941623, 'binary_precision': 0.985228, 'binary_recall': 0.9864952, 'binary_specificity': 0.9848385, 'binary_f1_score': 0.9858612}
confusion matrix:
      0     1
0  1494    23
1    21  1534
---- Validation: 
scalar performance:
{'acc': 0.8516784, 'precision': 0.8621694, 'recall': 0.8502816, 'specificity': 0.8502816, 'f1': 0.8502061, 'auroc': 0.91346407, 'binary_precision': 0.9198473, 'binary_recall': 0.7650794, 'binary_specificity': 0.9354839, 'binary_f1_score': 0.8353553}
confusion matrix:
     0    1
0  609   42
1  148  482
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.82666665, 'precision': 0.8334106, 'recall': 0.8266667, 'specificity': 0.8266667, 'f1': 0.82578576, 'auroc': 0.8925234, 'binary_precision': 0.88082904, 'binary_recall': 0.75555557, 'binary_specificity': 0.8977778, 'binary_f1_score': 0.81339717}
confusion matrix:
     0    1
0  202   23
1   55  170
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-07-22 23:49:02.962016,epoch time: 0:04:04.766908,used: 0:12:30.596288,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_22_23_36_32_seed_1_22755941
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9863281, 'precision': 0.9863467, 'recall': 0.98641014, 'specificity': 0.98641014, 'f1': 0.9863279, 'auroc': 0.999225, 'binary_precision': 0.9934726, 'binary_recall': 0.97940797, 'binary_specificity': 0.9934124, 'binary_f1_score': 0.9863901}
confusion matrix:
      0     1
0  1508    10
1    32  1522
---- Validation: 
scalar performance:
{'acc': 0.7665886, 'precision': 0.8187661, 'recall': 0.76323605, 'specificity': 0.76323605, 'f1': 0.7550523, 'auroc': 0.9197352, 'binary_precision': 0.9436997, 'binary_recall': 0.5587302, 'binary_specificity': 0.9677419, 'binary_f1_score': 0.70189434}
confusion matrix:
     0    1
0  630   21
1  278  352
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7688889, 'precision': 0.83184224, 'recall': 0.7688889, 'specificity': 0.7688889, 'f1': 0.7573822, 'auroc': 0.9276247, 'binary_precision': 0.97637796, 'binary_recall': 0.5511111, 'binary_specificity': 0.9866667, 'binary_f1_score': 0.70454544}
confusion matrix:
     0    1
0  222    3
1  101  124
early stop counter: 1
val acc:0.7665886282920837, best validation acc: 0.8516783714294434, corresponding to test acc:                         0.8266666531562805 / 0.8266666531562805
after epoch: 4,now: 2024-07-22 23:53:06.231125,epoch time: 0:04:03.269109,used: 0:16:33.865397,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_22_23_36_32_seed_1_22755941
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9889323, 'precision': 0.98891354, 'recall': 0.98895586, 'specificity': 0.98895586, 'f1': 0.98893094, 'auroc': 0.9992679, 'binary_precision': 0.99096775, 'binary_recall': 0.98714656, 'binary_specificity': 0.99076515, 'binary_f1_score': 0.9890534}
confusion matrix:
      0     1
0  1502    14
1    20  1536
---- Validation: 
scalar performance:
{'acc': 0.82201403, 'precision': 0.8460318, 'recall': 0.81984127, 'specificity': 0.81984127, 'f1': 0.8181386, 'auroc': 0.9197645, 'binary_precision': 0.93318963, 'binary_recall': 0.6873016, 'binary_specificity': 0.95238096, 'binary_f1_score': 0.79159045}
confusion matrix:
     0    1
0  620   31
1  197  433
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.82666665, 'precision': 0.8499185, 'recall': 0.82666665, 'specificity': 0.82666665, 'f1': 0.8237385, 'auroc': 0.9306667, 'binary_precision': 0.94011974, 'binary_recall': 0.69777775, 'binary_specificity': 0.95555556, 'binary_f1_score': 0.8010204}
confusion matrix:
     0    1
0  215   10
1   68  157
early stop counter: 2
val acc:0.8220140337944031, best validation acc: 0.8516783714294434, corresponding to test acc:                         0.8266666531562805 / 0.8266666531562805
after epoch: 5,now: 2024-07-22 23:57:10.756393,epoch time: 0:04:04.525268,used: 0:20:38.390665,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_22_23_36_32_seed_1_22755941
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9889323, 'precision': 0.9889815, 'recall': 0.98902464, 'specificity': 0.98902464, 'f1': 0.98893225, 'auroc': 0.99950063, 'binary_precision': 0.9973805, 'binary_recall': 0.98068255, 'binary_specificity': 0.99736667, 'binary_f1_score': 0.98896104}
confusion matrix:
      0     1
0  1515     4
1    30  1523
---- Validation: 
scalar performance:
{'acc': 0.6455894, 'precision': 0.77211237, 'recall': 0.63991296, 'specificity': 0.63991296, 'f1': 0.5939047, 'auroc': 0.93396664, 'binary_precision': 0.9536083, 'binary_recall': 0.2936508, 'binary_specificity': 0.9861751, 'binary_f1_score': 0.44902912}
confusion matrix:
     0    1
0  642    9
1  445  185
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6711111, 'precision': 0.80160856, 'recall': 0.6711111, 'specificity': 0.6711111, 'f1': 0.63122106, 'auroc': 0.93750125, 'binary_precision': 1.0, 'binary_recall': 0.3422222, 'binary_specificity': 1.0, 'binary_f1_score': 0.50993377}
confusion matrix:
     0   1
0  225   0
1  148  77
early stop counter: 3
val acc:0.6455894112586975, best validation acc: 0.8516783714294434, corresponding to test acc:                         0.8266666531562805 / 0.8266666531562805
after epoch: 6,now: 2024-07-23 00:01:14.929009,epoch time: 0:04:04.172616,used: 0:24:42.563281,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_22_23_36_32_seed_1_22755941
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.99088544, 'precision': 0.9909474, 'recall': 0.99083924, 'specificity': 0.99083924, 'f1': 0.9908829, 'auroc': 0.9992484, 'binary_precision': 0.9878749, 'binary_recall': 0.99421966, 'binary_specificity': 0.98745877, 'binary_f1_score': 0.9910372}
confusion matrix:
      0     1
0  1496    19
1     9  1548
---- Validation: 
scalar performance:
{'acc': 0.8306011, 'precision': 0.8514073, 'recall': 0.828597, 'specificity': 0.828597, 'f1': 0.8274169, 'auroc': 0.92695487, 'binary_precision': 0.932914, 'binary_recall': 0.7063492, 'binary_specificity': 0.9508448, 'binary_f1_score': 0.80397475}
confusion matrix:
     0    1
0  619   32
1  185  445
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8488889, 'precision': 0.86857533, 'recall': 0.8488889, 'specificity': 0.8488889, 'f1': 0.8468438, 'auroc': 0.9229827, 'binary_precision': 0.9537572, 'binary_recall': 0.73333335, 'binary_specificity': 0.96444446, 'binary_f1_score': 0.8291457}
confusion matrix:
     0    1
0  217    8
1   60  165
new oracle model saved
early stop counter: 4
val acc:0.8306010961532593, best validation acc: 0.8516783714294434, corresponding to test acc:                         0.8266666531562805 / 0.8488888740539551
after epoch: 7,now: 2024-07-23 00:05:19.371319,epoch time: 0:04:04.442310,used: 0:28:47.005591,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_22_23_36_32_seed_1_22755941
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.97753906, 'precision': 0.97810304, 'recall': 0.9773643, 'specificity': 0.9773643, 'f1': 0.9775234, 'auroc': 0.9985256, 'binary_precision': 0.9643527, 'binary_recall': 0.992278, 'binary_specificity': 0.96245056, 'binary_f1_score': 0.97811604}
confusion matrix:
      0     1
0  1461    57
1    12  1542
---- Validation: 
scalar performance:
{'acc': 0.8462139, 'precision': 0.8592421, 'recall': 0.84464926, 'specificity': 0.84464926, 'f1': 0.8443548, 'auroc': 0.92800087, 'binary_precision': 0.92367905, 'binary_recall': 0.74920636, 'binary_specificity': 0.94009215, 'binary_f1_score': 0.8273444}
confusion matrix:
     0    1
0  612   39
1  158  472
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8466667, 'precision': 0.8563018, 'recall': 0.8466667, 'specificity': 0.8466667, 'f1': 0.845623, 'auroc': 0.9237926, 'binary_precision': 0.9148936, 'binary_recall': 0.7644445, 'binary_specificity': 0.9288889, 'binary_f1_score': 0.8329298}
confusion matrix:
     0    1
0  209   16
1   53  172
early stop counter: 5
val acc:0.8462138772010803, best validation acc: 0.8516783714294434, corresponding to test acc:                         0.8266666531562805 / 0.8488888740539551
after epoch: 8,now: 2024-07-23 00:09:26.220125,epoch time: 0:04:06.848806,used: 0:32:53.854397,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_22_23_36_32_seed_1_22755941
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 8 with time: 0:32:53.854397 at 2024-07-23 00:09:26.220125
persisted model performance metric: 

scalar performance:
{'acc': 0.82666665, 'precision': 0.8334106, 'recall': 0.8266667, 'specificity': 0.8266667, 'f1': 0.82578576, 'auroc': 0.8925234, 'binary_precision': 0.88082904, 'binary_recall': 0.75555557, 'binary_specificity': 0.8977778, 'binary_f1_score': 0.81339717}
confusion matrix:
     0    1
0  202   23
1   55  170
oracle model performance metric: 

scalar performance:
{'acc': 0.8488889, 'precision': 0.86857533, 'recall': 0.8488889, 'specificity': 0.8488889, 'f1': 0.8468438, 'auroc': 0.9229827, 'binary_precision': 0.9537572, 'binary_recall': 0.73333335, 'binary_specificity': 0.96444446, 'binary_f1_score': 0.8291457}
confusion matrix:
     0    1
0  217    8
1   60  165
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_higherregularization_irm_dial_lr1e5_bs16_nofreeze_2024-07-22_16-00-54/rule_results/3.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_higherregularization_irm_dial_lr1e5_bs16_nofreeze_2024-07-22_16-00-54/confusion_matrix/3.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 455922 KiB |   8393 MiB | 195608 GiB | 195608 GiB |
|       from large pool | 415323 KiB |   8356 MiB | 193435 GiB | 193434 GiB |
|       from small pool |  40598 KiB |     60 MiB |   2173 GiB |   2173 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 455922 KiB |   8393 MiB | 195608 GiB | 195608 GiB |
|       from large pool | 415323 KiB |   8356 MiB | 193435 GiB | 193434 GiB |
|       from small pool |  40598 KiB |     60 MiB |   2173 GiB |   2173 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 447481 KiB |   8387 MiB | 195554 GiB | 195554 GiB |
|       from large pool | 407075 KiB |   8350 MiB | 193383 GiB | 193383 GiB |
|       from small pool |  40406 KiB |     60 MiB |   2171 GiB |   2171 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   9176 MiB |   9176 MiB |  17576 MiB |   8400 MiB |
|       from large pool |   9108 MiB |   9108 MiB |  17492 MiB |   8384 MiB |
|       from small pool |     68 MiB |     68 MiB |     84 MiB |     16 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 398094 KiB |    808 MiB | 115445 GiB | 115445 GiB |
|       from large pool | 389540 KiB |    802 MiB | 113249 GiB | 113249 GiB |
|       from small pool |   8553 KiB |     24 MiB |   2196 GiB |   2196 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    1310    |    1914    |   27152 K  |   27150 K  |
|       from large pool |     187    |     940    |   17723 K  |   17723 K  |
|       from small pool |    1123    |    1419    |    9428 K  |    9427 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    1310    |    1914    |   27152 K  |   27150 K  |
|       from large pool |     187    |     940    |   17723 K  |   17723 K  |
|       from small pool |    1123    |    1419    |    9428 K  |    9427 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     416    |     416    |     771    |     355    |
|       from large pool |     382    |     382    |     729    |     347    |
|       from small pool |      34    |      34    |      42    |       8    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      84    |     434    |   15989 K  |   15989 K  |
|       from large pool |      37    |     383    |   12116 K  |   12116 K  |
|       from small pool |      47    |     223    |    3873 K  |    3873 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   8393 MiB | 195608 GiB | 195608 GiB |
|       from large pool |  16640 KiB |   8356 MiB | 193435 GiB | 193435 GiB |
|       from small pool |      0 KiB |     60 MiB |   2173 GiB |   2173 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   8393 MiB | 195608 GiB | 195608 GiB |
|       from large pool |  16640 KiB |   8356 MiB | 193435 GiB | 193435 GiB |
|       from small pool |      0 KiB |     60 MiB |   2173 GiB |   2173 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   8387 MiB | 195554 GiB | 195554 GiB |
|       from large pool |  16640 KiB |   8350 MiB | 193383 GiB | 193383 GiB |
|       from small pool |      0 KiB |     60 MiB |   2171 GiB |   2171 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    834 MiB |   9176 MiB |  17576 MiB |  16742 MiB |
|       from large pool |    786 MiB |   9108 MiB |  17492 MiB |  16706 MiB |
|       from small pool |     48 MiB |     68 MiB |     84 MiB |     36 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |    808 MiB | 115445 GiB | 115445 GiB |
|       from large pool |  24320 KiB |    802 MiB | 113249 GiB | 113249 GiB |
|       from small pool |      0 KiB |     32 MiB |   2196 GiB |   2196 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    1914    |   27152 K  |   27152 K  |
|       from large pool |       2    |     940    |   17723 K  |   17723 K  |
|       from small pool |       0    |    1419    |    9428 K  |    9428 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    1914    |   27152 K  |   27152 K  |
|       from large pool |       2    |     940    |   17723 K  |   17723 K  |
|       from small pool |       0    |    1419    |    9428 K  |    9428 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      60    |     416    |     771    |     711    |
|       from large pool |      36    |     382    |     729    |     693    |
|       from small pool |      24    |      34    |      42    |      18    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     434    |   15989 K  |   15989 K  |
|       from large pool |       3    |     383    |   12116 K  |   12116 K  |
|       from small pool |       0    |     223    |    3873 K  |    3873 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   8393 MiB | 195608 GiB | 195608 GiB |
|       from large pool |  16640 KiB |   8356 MiB | 193435 GiB | 193435 GiB |
|       from small pool |      0 KiB |     60 MiB |   2173 GiB |   2173 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   8393 MiB | 195608 GiB | 195608 GiB |
|       from large pool |  16640 KiB |   8356 MiB | 193435 GiB | 193435 GiB |
|       from small pool |      0 KiB |     60 MiB |   2173 GiB |   2173 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   8387 MiB | 195554 GiB | 195554 GiB |
|       from large pool |  16640 KiB |   8350 MiB | 193383 GiB | 193383 GiB |
|       from small pool |      0 KiB |     60 MiB |   2171 GiB |   2171 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    834 MiB |   9176 MiB |  17576 MiB |  16742 MiB |
|       from large pool |    786 MiB |   9108 MiB |  17492 MiB |  16706 MiB |
|       from small pool |     48 MiB |     68 MiB |     84 MiB |     36 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |    808 MiB | 115445 GiB | 115445 GiB |
|       from large pool |  24320 KiB |    802 MiB | 113249 GiB | 113249 GiB |
|       from small pool |      0 KiB |     32 MiB |   2196 GiB |   2196 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    1914    |   27152 K  |   27152 K  |
|       from large pool |       2    |     940    |   17723 K  |   17723 K  |
|       from small pool |       0    |    1419    |    9428 K  |    9428 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    1914    |   27152 K  |   27152 K  |
|       from large pool |       2    |     940    |   17723 K  |   17723 K  |
|       from small pool |       0    |    1419    |    9428 K  |    9428 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      60    |     416    |     771    |     711    |
|       from large pool |      36    |     382    |     729    |     693    |
|       from small pool |      24    |      34    |      42    |      18    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     434    |   15989 K  |   15989 K  |
|       from large pool |       3    |     383    |   12116 K  |   12116 K  |
|       from small pool |       0    |     223    |    3873 K  |    3873 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'888c1ef2'
model name: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_00_10_38_seed_2_22755941

 Experiment start at: 2024-07-23 00:10:38.201609
before training, model accuracy: 0.41203704476356506
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9748037, 'precision': 0.9757186, 'recall': 0.9749897, 'specificity': 0.9749897, 'f1': 0.9747972, 'auroc': 0.9960778, 'binary_precision': 0.99863666, 'binary_recall': 0.9512987, 'binary_specificity': 0.9986807, 'binary_f1_score': 0.97439307}
confusion matrix:
      0     1
0  1514     2
1    75  1465
---- Validation: 
scalar performance:
{'acc': 0.7175274, 'precision': 0.7760416, 'recall': 0.7112236, 'specificity': 0.7112236, 'f1': 0.69773877, 'auroc': 0.847762, 'binary_precision': 0.8966565, 'binary_recall': 0.4742765, 'binary_specificity': 0.9481707, 'binary_f1_score': 0.6203996}
confusion matrix:
     0    1
0  622   34
1  327  295
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5092593, 'precision': 0.557971, 'recall': 0.5092593, 'specificity': 0.5092593, 'f1': 0.37875456, 'auroc': 0.8151363, 'binary_precision': 0.6111111, 'binary_recall': 0.050925925, 'binary_specificity': 0.9675926, 'binary_f1_score': 0.094017096}
confusion matrix:
     0   1
0  209   7
1  205  11
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-23 00:14:50.191246,epoch time: 0:04:11.989637,used: 0:04:11.989637,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_00_10_38_seed_2_22755941
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9718586, 'precision': 0.97253954, 'recall': 0.9720214, 'specificity': 0.9720214, 'f1': 0.9718538, 'auroc': 0.9974159, 'binary_precision': 0.99254745, 'binary_recall': 0.9512987, 'binary_specificity': 0.9927441, 'binary_f1_score': 0.9714854}
confusion matrix:
      0     1
0  1505    11
1    75  1465
---- Validation: 
scalar performance:
{'acc': 0.80594677, 'precision': 0.8202579, 'recall': 0.8030596, 'specificity': 0.8030596, 'f1': 0.80261666, 'auroc': 0.8849772, 'binary_precision': 0.8816326, 'binary_recall': 0.69453377, 'binary_specificity': 0.9115854, 'binary_f1_score': 0.77697843}
confusion matrix:
     0    1
0  598   58
1  190  432
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7268519, 'precision': 0.7953125, 'recall': 0.7268518, 'specificity': 0.7268518, 'f1': 0.71004736, 'auroc': 0.8917396, 'binary_precision': 0.9375, 'binary_recall': 0.4861111, 'binary_specificity': 0.9675926, 'binary_f1_score': 0.6402439}
confusion matrix:
     0    1
0  209    7
1  111  105
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-07-23 00:18:52.528731,epoch time: 0:04:02.337485,used: 0:08:14.327122,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_00_10_38_seed_2_22755941
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.963678, 'precision': 0.96580446, 'recall': 0.9639559, 'specificity': 0.9639559, 'f1': 0.96364987, 'auroc': 0.99740946, 'binary_precision': 0.9993012, 'binary_recall': 0.9285714, 'binary_specificity': 0.99934036, 'binary_f1_score': 0.9626388}
confusion matrix:
      0     1
0  1515     1
1   110  1430
---- Validation: 
scalar performance:
{'acc': 0.6729264, 'precision': 0.7822226, 'recall': 0.66444546, 'specificity': 0.66444546, 'f1': 0.6311724, 'auroc': 0.8895749, 'binary_precision': 0.95132744, 'binary_recall': 0.34565917, 'binary_specificity': 0.9832317, 'binary_f1_score': 0.5070755}
confusion matrix:
     0    1
0  645   11
1  407  215
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5717593, 'precision': 0.74095, 'recall': 0.5717592, 'specificity': 0.5717592, 'f1': 0.48057687, 'auroc': 0.87506425, 'binary_precision': 0.94285715, 'binary_recall': 0.15277778, 'binary_specificity': 0.9907407, 'binary_f1_score': 0.26294822}
confusion matrix:
     0   1
0  214   2
1  183  33
early stop counter: 1
val acc:0.6729264259338379, best validation acc: 0.8059467673301697, corresponding to test acc:                         0.7268518805503845 / 0.7268518805503845
after epoch: 3,now: 2024-07-23 00:22:55.678752,epoch time: 0:04:03.150021,used: 0:12:17.477143,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_00_10_38_seed_2_22755941
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9856021, 'precision': 0.9856629, 'recall': 0.9856629, 'specificity': 0.9856629, 'f1': 0.9856021, 'auroc': 0.99899596, 'binary_precision': 0.9934037, 'binary_recall': 0.9779221, 'binary_specificity': 0.9934037, 'binary_f1_score': 0.9856021}
confusion matrix:
      0     1
0  1506    10
1    34  1506
---- Validation: 
scalar performance:
{'acc': 0.58607197, 'precision': 0.6677994, 'recall': 0.5763004, 'specificity': 0.5763004, 'f1': 0.5150768, 'auroc': 0.82206047, 'binary_precision': 0.7784431, 'binary_recall': 0.20900321, 'binary_specificity': 0.94359756, 'binary_f1_score': 0.32953104}
confusion matrix:
     0    1
0  619   37
1  492  130
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6921296, 'precision': 0.7200997, 'recall': 0.6921296, 'specificity': 0.6921296, 'f1': 0.6820277, 'auroc': 0.7990612, 'binary_precision': 0.79856116, 'binary_recall': 0.5138889, 'binary_specificity': 0.8703704, 'binary_f1_score': 0.62535214}
confusion matrix:
     0    1
0  188   28
1  105  111
early stop counter: 2
val acc:0.5860719680786133, best validation acc: 0.8059467673301697, corresponding to test acc:                         0.7268518805503845 / 0.7268518805503845
after epoch: 4,now: 2024-07-23 00:26:58.348801,epoch time: 0:04:02.670049,used: 0:16:20.147192,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_00_10_38_seed_2_22755941
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9777487, 'precision': 0.9778372, 'recall': 0.9777062, 'specificity': 0.9777062, 'f1': 0.97774494, 'auroc': 0.99767375, 'binary_precision': 0.97300774, 'binary_recall': 0.98311687, 'binary_specificity': 0.9722955, 'binary_f1_score': 0.9780362}
confusion matrix:
      0     1
0  1474    42
1    26  1514
---- Validation: 
scalar performance:
{'acc': 0.6611894, 'precision': 0.76119447, 'recall': 0.65272087, 'specificity': 0.65272087, 'f1': 0.6181634, 'auroc': 0.88745, 'binary_precision': 0.9162996, 'binary_recall': 0.33440515, 'binary_specificity': 0.9710366, 'binary_f1_score': 0.4899882}
confusion matrix:
     0    1
0  637   19
1  414  208
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5, 'precision': 0.5, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.3374045, 'auroc': 0.81980884, 'binary_precision': 0.5, 'binary_recall': 0.0046296297, 'binary_specificity': 0.9953704, 'binary_f1_score': 0.009174312}
confusion matrix:
     0  1
0  215  1
1  215  1
early stop counter: 3
val acc:0.6611893773078918, best validation acc: 0.8059467673301697, corresponding to test acc:                         0.7268518805503845 / 0.7268518805503845
after epoch: 5,now: 2024-07-23 00:31:02.383742,epoch time: 0:04:04.034941,used: 0:20:24.182133,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_00_10_38_seed_2_22755941
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9888743, 'precision': 0.9889333, 'recall': 0.98884284, 'specificity': 0.98884284, 'f1': 0.98887277, 'auroc': 0.99968517, 'binary_precision': 0.98518044, 'binary_recall': 0.99285716, 'binary_specificity': 0.9848285, 'binary_f1_score': 0.9890039}
confusion matrix:
      0     1
0  1493    23
1    11  1529
---- Validation: 
scalar performance:
{'acc': 0.8114241, 'precision': 0.8379369, 'recall': 0.80764496, 'specificity': 0.80764496, 'f1': 0.8062422, 'auroc': 0.9064804, 'binary_precision': 0.9261745, 'binary_recall': 0.6655949, 'binary_specificity': 0.9496951, 'binary_f1_score': 0.7745557}
confusion matrix:
     0    1
0  623   33
1  208  414
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6180556, 'precision': 0.6867435, 'recall': 0.6180556, 'specificity': 0.6180556, 'f1': 0.57937723, 'auroc': 0.8164866, 'binary_precision': 0.8, 'binary_recall': 0.3148148, 'binary_specificity': 0.9212963, 'binary_f1_score': 0.4518273}
confusion matrix:
     0   1
0  199  17
1  148  68
better model found
persisted
after epoch: 6,now: 2024-07-23 00:35:05.120707,epoch time: 0:04:02.736965,used: 0:24:26.919098,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_00_10_38_seed_2_22755941
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9810209, 'precision': 0.98145366, 'recall': 0.9811534, 'specificity': 0.9811534, 'f1': 0.9810194, 'auroc': 0.9988332, 'binary_precision': 0.9979839, 'binary_recall': 0.96428573, 'binary_specificity': 0.9980211, 'binary_f1_score': 0.98084545}
confusion matrix:
      0     1
0  1513     3
1    55  1485
---- Validation: 
scalar performance:
{'acc': 0.7081377, 'precision': 0.78693485, 'recall': 0.7009941, 'specificity': 0.7009941, 'f1': 0.6819061, 'auroc': 0.89672375, 'binary_precision': 0.93079585, 'binary_recall': 0.4324759, 'binary_specificity': 0.9695122, 'binary_f1_score': 0.59055984}
confusion matrix:
     0    1
0  636   20
1  353  269
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5694444, 'precision': 0.753125, 'recall': 0.5694445, 'specificity': 0.5694445, 'f1': 0.47402596, 'auroc': 0.87521434, 'binary_precision': 0.96875, 'binary_recall': 0.14351852, 'binary_specificity': 0.9953704, 'binary_f1_score': 0.25}
confusion matrix:
     0   1
0  215   1
1  185  31
early stop counter: 1
val acc:0.7081376910209656, best validation acc: 0.8114240765571594, corresponding to test acc:                         0.6180555820465088 / 0.7268518805503845
after epoch: 7,now: 2024-07-23 00:39:09.448596,epoch time: 0:04:04.327889,used: 0:28:31.246987,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_00_10_38_seed_2_22755941
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9846204, 'precision': 0.9849932, 'recall': 0.98452437, 'specificity': 0.98452437, 'f1': 0.9846143, 'auroc': 0.99922, 'binary_precision': 0.97336715, 'binary_recall': 0.9967533, 'binary_specificity': 0.9722955, 'binary_f1_score': 0.98492146}
confusion matrix:
      0     1
0  1474    42
1     5  1535
---- Validation: 
scalar performance:
{'acc': 0.80594677, 'precision': 0.8138886, 'recall': 0.8080175, 'specificity': 0.8080175, 'f1': 0.8053289, 'auroc': 0.90105677, 'binary_precision': 0.7568681, 'binary_recall': 0.8858521, 'binary_specificity': 0.73018295, 'binary_f1_score': 0.8162963}
confusion matrix:
     0    1
0  479  177
1   71  551
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7592593, 'precision': 0.78595746, 'recall': 0.7592592, 'specificity': 0.7592592, 'f1': 0.7535058, 'auroc': 0.8716564, 'binary_precision': 0.6985816, 'binary_recall': 0.912037, 'binary_specificity': 0.6064815, 'binary_f1_score': 0.79116464}
confusion matrix:
     0    1
0  131   85
1   19  197
new oracle model saved
early stop counter: 2
val acc:0.8059467673301697, best validation acc: 0.8114240765571594, corresponding to test acc:                         0.6180555820465088 / 0.7592592835426331
after epoch: 8,now: 2024-07-23 00:43:10.693157,epoch time: 0:04:01.244561,used: 0:32:32.491548,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_00_10_38_seed_2_22755941
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9888743, 'precision': 0.989136, 'recall': 0.9887966, 'specificity': 0.9887966, 'f1': 0.98887086, 'auroc': 0.9998702, 'binary_precision': 0.97961783, 'binary_recall': 0.9987013, 'binary_specificity': 0.97889185, 'binary_f1_score': 0.9890675}
confusion matrix:
      0     1
0  1484    32
1     2  1538
---- Validation: 
scalar performance:
{'acc': 0.7942097, 'precision': 0.7997233, 'recall': 0.79229325, 'specificity': 0.79229325, 'f1': 0.79240984, 'auroc': 0.8723893, 'binary_precision': 0.83426446, 'binary_recall': 0.7202572, 'binary_specificity': 0.8643293, 'binary_f1_score': 0.7730802}
confusion matrix:
     0    1
0  567   89
1  174  448
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7523148, 'precision': 0.7529709, 'recall': 0.7523148, 'specificity': 0.7523148, 'f1': 0.7521541, 'auroc': 0.8314043, 'binary_precision': 0.7400881, 'binary_recall': 0.7777778, 'binary_specificity': 0.7268519, 'binary_f1_score': 0.75846505}
confusion matrix:
     0    1
0  157   59
1   48  168
early stop counter: 3
val acc:0.7942097187042236, best validation acc: 0.8114240765571594, corresponding to test acc:                         0.6180555820465088 / 0.7592592835426331
after epoch: 9,now: 2024-07-23 00:47:13.742212,epoch time: 0:04:03.049055,used: 0:36:35.540603,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_00_10_38_seed_2_22755941
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.98854715, 'precision': 0.98867154, 'recall': 0.98862606, 'specificity': 0.98862606, 'f1': 0.9885471, 'auroc': 0.9997395, 'binary_precision': 0.99867463, 'binary_recall': 0.9785714, 'binary_specificity': 0.9986807, 'binary_f1_score': 0.9885208}
confusion matrix:
      0     1
0  1514     2
1    33  1507
---- Validation: 
scalar performance:
{'acc': 0.63380283, 'precision': 0.7741939, 'recall': 0.6240442, 'specificity': 0.6240442, 'f1': 0.5706928, 'auroc': 0.90024495, 'binary_precision': 0.96385545, 'binary_recall': 0.25723472, 'binary_specificity': 0.99085367, 'binary_f1_score': 0.40609136}
confusion matrix:
     0    1
0  650    6
1  462  160
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5393519, 'precision': 0.7127216, 'recall': 0.5393518, 'specificity': 0.5393518, 'f1': 0.4214766, 'auroc': 0.8555169, 'binary_precision': 0.9047619, 'binary_recall': 0.08796296, 'binary_specificity': 0.9907407, 'binary_f1_score': 0.16033755}
confusion matrix:
     0   1
0  214   2
1  197  19
early stop counter: 4
val acc:0.6338028311729431, best validation acc: 0.8114240765571594, corresponding to test acc:                         0.6180555820465088 / 0.7592592835426331
after epoch: 10,now: 2024-07-23 00:51:16.655466,epoch time: 0:04:02.913254,used: 0:40:38.453857,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_00_10_38_seed_2_22755941
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9931283, 'precision': 0.99313056, 'recall': 0.9931253, 'specificity': 0.9931253, 'f1': 0.9931279, 'auroc': 0.9998008, 'binary_precision': 0.9928618, 'binary_recall': 0.9935065, 'binary_specificity': 0.9927441, 'binary_f1_score': 0.9931841}
confusion matrix:
      0     1
0  1505    11
1    10  1530
---- Validation: 
scalar performance:
{'acc': 0.7809077, 'precision': 0.8208115, 'recall': 0.7761278, 'specificity': 0.7761278, 'f1': 0.771749, 'auroc': 0.90565443, 'binary_precision': 0.9275, 'binary_recall': 0.596463, 'binary_specificity': 0.95579267, 'binary_f1_score': 0.7260274}
confusion matrix:
     0    1
0  627   29
1  251  371
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5555556, 'precision': 0.7647059, 'recall': 0.5555556, 'specificity': 0.5555556, 'f1': 0.44615385, 'auroc': 0.9007201, 'binary_precision': 1.0, 'binary_recall': 0.11111111, 'binary_specificity': 1.0, 'binary_f1_score': 0.19999999}
confusion matrix:
     0   1
0  216   0
1  192  24
early stop counter: 5
val acc:0.7809076905250549, best validation acc: 0.8114240765571594, corresponding to test acc:                         0.6180555820465088 / 0.7592592835426331
after epoch: 11,now: 2024-07-23 00:55:20.315446,epoch time: 0:04:03.659980,used: 0:44:42.113837,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_00_10_38_seed_2_22755941
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 11 with time: 0:44:42.113837 at 2024-07-23 00:55:20.315446
persisted model performance metric: 

scalar performance:
{'acc': 0.6180556, 'precision': 0.6867435, 'recall': 0.6180556, 'specificity': 0.6180556, 'f1': 0.57937723, 'auroc': 0.8164866, 'binary_precision': 0.8, 'binary_recall': 0.3148148, 'binary_specificity': 0.9212963, 'binary_f1_score': 0.4518273}
confusion matrix:
     0   1
0  199  17
1  148  68
oracle model performance metric: 

scalar performance:
{'acc': 0.7592593, 'precision': 0.78595746, 'recall': 0.7592592, 'specificity': 0.7592592, 'f1': 0.7535058, 'auroc': 0.8716564, 'binary_precision': 0.6985816, 'binary_recall': 0.912037, 'binary_specificity': 0.6064815, 'binary_f1_score': 0.79116464}
confusion matrix:
     0    1
0  131   85
1   19  197
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_higherregularization_irm_dial_lr1e5_bs16_nofreeze_2024-07-22_16-00-54/rule_results/3.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_higherregularization_irm_dial_lr1e5_bs16_nofreeze_2024-07-22_16-00-54/confusion_matrix/3.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 455916 KiB |   8393 MiB | 292891 GiB | 292891 GiB |
|       from large pool | 415323 KiB |   8356 MiB | 289639 GiB | 289638 GiB |
|       from small pool |  40592 KiB |     60 MiB |   3252 GiB |   3252 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 455916 KiB |   8393 MiB | 292891 GiB | 292891 GiB |
|       from large pool | 415323 KiB |   8356 MiB | 289639 GiB | 289638 GiB |
|       from small pool |  40592 KiB |     60 MiB |   3252 GiB |   3252 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 447481 KiB |   8387 MiB | 292812 GiB | 292812 GiB |
|       from large pool | 407075 KiB |   8350 MiB | 289563 GiB | 289562 GiB |
|       from small pool |  40406 KiB |     60 MiB |   3249 GiB |   3249 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   9172 MiB |   9176 MiB |  25914 MiB |  16742 MiB |
|       from large pool |   9108 MiB |   9108 MiB |  25814 MiB |  16706 MiB |
|       from small pool |     64 MiB |     68 MiB |    100 MiB |     36 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 398100 KiB |    808 MiB | 172123 GiB | 172123 GiB |
|       from large pool | 389540 KiB |    802 MiB | 168838 GiB | 168838 GiB |
|       from small pool |   8559 KiB |     32 MiB |   3284 GiB |   3284 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    1298    |    1914    |   40647 K  |   40646 K  |
|       from large pool |     187    |     940    |   26537 K  |   26537 K  |
|       from small pool |    1111    |    1419    |   14109 K  |   14108 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    1298    |    1914    |   40647 K  |   40646 K  |
|       from large pool |     187    |     940    |   26537 K  |   26537 K  |
|       from small pool |    1111    |    1419    |   14109 K  |   14108 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     414    |     416    |    1125    |     711    |
|       from large pool |     382    |     382    |    1075    |     693    |
|       from small pool |      32    |      34    |      50    |      18    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      81    |     434    |   24177 K  |   24177 K  |
|       from large pool |      37    |     383    |   18389 K  |   18389 K  |
|       from small pool |      44    |     223    |    5788 K  |    5788 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   8393 MiB | 292891 GiB | 292891 GiB |
|       from large pool |  16640 KiB |   8356 MiB | 289639 GiB | 289639 GiB |
|       from small pool |      0 KiB |     60 MiB |   3252 GiB |   3252 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   8393 MiB | 292891 GiB | 292891 GiB |
|       from large pool |  16640 KiB |   8356 MiB | 289639 GiB | 289639 GiB |
|       from small pool |      0 KiB |     60 MiB |   3252 GiB |   3252 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   8387 MiB | 292812 GiB | 292812 GiB |
|       from large pool |  16640 KiB |   8350 MiB | 289563 GiB | 289563 GiB |
|       from small pool |      0 KiB |     60 MiB |   3249 GiB |   3249 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    834 MiB |   9176 MiB |  25914 MiB |  25080 MiB |
|       from large pool |    786 MiB |   9108 MiB |  25814 MiB |  25028 MiB |
|       from small pool |     48 MiB |     68 MiB |    100 MiB |     52 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |    808 MiB | 172123 GiB | 172123 GiB |
|       from large pool |  24320 KiB |    802 MiB | 168839 GiB | 168839 GiB |
|       from small pool |      0 KiB |     32 MiB |   3284 GiB |   3284 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    1914    |   40647 K  |   40647 K  |
|       from large pool |       2    |     940    |   26537 K  |   26537 K  |
|       from small pool |       0    |    1419    |   14109 K  |   14109 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    1914    |   40647 K  |   40647 K  |
|       from large pool |       2    |     940    |   26537 K  |   26537 K  |
|       from small pool |       0    |    1419    |   14109 K  |   14109 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      60    |     416    |    1125    |    1065    |
|       from large pool |      36    |     382    |    1075    |    1039    |
|       from small pool |      24    |      34    |      50    |      26    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     434    |   24177 K  |   24177 K  |
|       from large pool |       3    |     383    |   18389 K  |   18389 K  |
|       from small pool |       0    |     223    |    5788 K  |    5788 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Tue Jul 23 00:56:07 2024]
Finished job 0.
1 of 1 steps (100%) done
