Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Mon Jul 22 20:46:53 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_higherregularization_irm_dial_lr1e5_bs16_nofreeze_2024-07-22_16-00-54/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_higherregularization_irm_dial_lr1e5_bs16_nofreeze_2024-07-22_16-00-54/rule_results/1.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=1
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/swiglu_ffn.py:51: UserWarning: xFormers is not available (SwiGLU)
  warnings.warn("xFormers is not available (SwiGLU)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/attention.py:33: UserWarning: xFormers is not available (Attention)
  warnings.warn("xFormers is not available (Attention)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/block.py:40: UserWarning: xFormers is not available (Block)
  warnings.warn("xFormers is not available (Block)")
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'888c1ef2'
model name: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_22_20_47_41_seed_0_22755939

 Experiment start at: 2024-07-22 20:47:41.747509
before training, model accuracy: 0.569767415523529
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9140625, 'precision': 0.92487615, 'recall': 0.9151771, 'specificity': 0.9151771, 'f1': 0.9136512, 'auroc': 0.98141384, 'binary_precision': 0.9961627, 'binary_recall': 0.83365446, 'binary_specificity': 0.9966997, 'binary_f1_score': 0.9076923}
confusion matrix:
      0     1
0  1510     5
1   259  1298
---- Validation: 
scalar performance:
{'acc': 0.58540374, 'precision': 0.71560717, 'recall': 0.5798749, 'specificity': 0.5798749, 'f1': 0.50466675, 'auroc': 0.81183875, 'binary_precision': 0.87969923, 'binary_recall': 0.18425196, 'binary_specificity': 0.9754977, 'binary_f1_score': 0.30468747}
confusion matrix:
     0    1
0  637   16
1  518  117
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7232558, 'precision': 0.8043889, 'recall': 0.7232558, 'specificity': 0.7232558, 'f1': 0.7034981, 'auroc': 0.8701352, 'binary_precision': 0.96153843, 'binary_recall': 0.4651163, 'binary_specificity': 0.98139536, 'binary_f1_score': 0.62695926}
confusion matrix:
     0    1
0  211    4
1  115  100
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-22 20:49:53.862372,epoch time: 0:02:12.114863,used: 0:02:12.114863,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_22_20_47_41_seed_0_22755939
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9329427, 'precision': 0.9386656, 'recall': 0.9322926, 'specificity': 0.9322926, 'f1': 0.9326457, 'auroc': 0.9926837, 'binary_precision': 0.89140534, 'binary_recall': 0.9877735, 'binary_specificity': 0.8768116, 'binary_f1_score': 0.9371185}
confusion matrix:
      0     1
0  1331   187
1    19  1535
---- Validation: 
scalar performance:
{'acc': 0.7189441, 'precision': 0.77142, 'recall': 0.7219713, 'specificity': 0.7219713, 'f1': 0.7064227, 'auroc': 0.88816965, 'binary_precision': 0.648531, 'binary_recall': 0.93858266, 'binary_specificity': 0.5053599, 'binary_f1_score': 0.7670528}
confusion matrix:
     0    1
0  330  323
1   39  596
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.75348836, 'precision': 0.7991524, 'recall': 0.7534884, 'specificity': 0.7534884, 'f1': 0.743708, 'auroc': 0.91703624, 'binary_precision': 0.6822742, 'binary_recall': 0.9488372, 'binary_specificity': 0.55813956, 'binary_f1_score': 0.79377437}
confusion matrix:
     0    1
0  120   95
1   11  204
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-07-22 20:51:23.514041,epoch time: 0:01:29.651669,used: 0:03:41.766532,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_22_20_47_41_seed_0_22755939
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.96158856, 'precision': 0.9620884, 'recall': 0.9618698, 'specificity': 0.9618698, 'f1': 0.9615872, 'auroc': 0.99344075, 'binary_precision': 0.9812834, 'binary_recall': 0.9422336, 'binary_specificity': 0.98150593, 'binary_f1_score': 0.9613621}
confusion matrix:
      0     1
0  1486    28
1    90  1468
---- Validation: 
scalar performance:
{'acc': 0.8369565, 'precision': 0.83833563, 'recall': 0.8374022, 'specificity': 0.8374022, 'f1': 0.8368901, 'auroc': 0.9150939, 'binary_precision': 0.8129602, 'binary_recall': 0.86929137, 'binary_specificity': 0.805513, 'binary_f1_score': 0.84018266}
confusion matrix:
     0    1
0  526  127
1   83  552
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.83023256, 'precision': 0.83184785, 'recall': 0.83023256, 'specificity': 0.83023256, 'f1': 0.83002573, 'auroc': 0.919827, 'binary_precision': 0.8086957, 'binary_recall': 0.8651163, 'binary_specificity': 0.7953488, 'binary_f1_score': 0.83595514}
confusion matrix:
     0    1
0  171   44
1   29  186
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-07-22 20:52:53.148842,epoch time: 0:01:29.634801,used: 0:05:11.401333,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_22_20_47_41_seed_0_22755939
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.96972656, 'precision': 0.96996593, 'recall': 0.9699032, 'specificity': 0.9699032, 'f1': 0.9697264, 'auroc': 0.9952198, 'binary_precision': 0.98410594, 'binary_recall': 0.955627, 'binary_specificity': 0.9841793, 'binary_f1_score': 0.96965736}
confusion matrix:
      0     1
0  1493    24
1    69  1486
---- Validation: 
scalar performance:
{'acc': 0.8299689, 'precision': 0.83468264, 'recall': 0.830793, 'specificity': 0.830793, 'f1': 0.8295866, 'auroc': 0.9095199, 'binary_precision': 0.7913165, 'binary_recall': 0.8897638, 'binary_specificity': 0.77182233, 'binary_f1_score': 0.83765745}
confusion matrix:
     0    1
0  504  149
1   70  565
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.81860465, 'precision': 0.82677674, 'recall': 0.81860465, 'specificity': 0.81860465, 'f1': 0.81746346, 'auroc': 0.9187453, 'binary_precision': 0.7751004, 'binary_recall': 0.89767444, 'binary_specificity': 0.73953485, 'binary_f1_score': 0.8318966}
confusion matrix:
     0    1
0  159   56
1   22  193
early stop counter: 1
val acc:0.8299689292907715, best validation acc: 0.8369565010070801, corresponding to test acc:                         0.830232560634613 / 0.830232560634613
after epoch: 4,now: 2024-07-22 20:54:24.606606,epoch time: 0:01:31.457764,used: 0:06:42.859097,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_22_20_47_41_seed_0_22755939
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9713542, 'precision': 0.97239655, 'recall': 0.9717573, 'specificity': 0.9717573, 'f1': 0.9713498, 'auroc': 0.9966637, 'binary_precision': 0.99864405, 'binary_recall': 0.94483644, 'binary_specificity': 0.99867815, 'binary_f1_score': 0.97099537}
confusion matrix:
      0     1
0  1511     2
1    86  1473
---- Validation: 
scalar performance:
{'acc': 0.58074534, 'precision': 0.73796564, 'recall': 0.5749768, 'specificity': 0.5749768, 'f1': 0.4905287, 'auroc': 0.84493375, 'binary_precision': 0.9279279, 'binary_recall': 0.16220473, 'binary_specificity': 0.98774886, 'binary_f1_score': 0.2761394}
confusion matrix:
     0    1
0  645    8
1  532  103
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.727907, 'precision': 0.8237952, 'recall': 0.72790694, 'specificity': 0.72790694, 'f1': 0.7061521, 'auroc': 0.8968524, 'binary_precision': 1.0, 'binary_recall': 0.45581394, 'binary_specificity': 1.0, 'binary_f1_score': 0.6261981}
confusion matrix:
     0   1
0  215   0
1  117  98
early stop counter: 2
val acc:0.5807453393936157, best validation acc: 0.8369565010070801, corresponding to test acc:                         0.830232560634613 / 0.830232560634613
after epoch: 5,now: 2024-07-22 20:56:01.136969,epoch time: 0:01:36.530363,used: 0:08:19.389460,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_22_20_47_41_seed_0_22755939
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.96972656, 'precision': 0.9697548, 'recall': 0.96984625, 'specificity': 0.96984625, 'f1': 0.9697256, 'auroc': 0.9968077, 'binary_precision': 0.9784455, 'binary_recall': 0.9614891, 'binary_specificity': 0.9782034, 'binary_f1_score': 0.9698932}
confusion matrix:
      0     1
0  1481    33
1    60  1498
---- Validation: 
scalar performance:
{'acc': 0.8214286, 'precision': 0.8346704, 'recall': 0.8200263, 'specificity': 0.8200263, 'f1': 0.8191682, 'auroc': 0.90396833, 'binary_precision': 0.8978389, 'binary_recall': 0.719685, 'binary_specificity': 0.92036754, 'binary_f1_score': 0.798951}
confusion matrix:
     0    1
0  601   52
1  178  457
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8604651, 'precision': 0.88286114, 'recall': 0.8604651, 'specificity': 0.8604651, 'f1': 0.85839427, 'auroc': 0.94485664, 'binary_precision': 0.9754601, 'binary_recall': 0.73953485, 'binary_specificity': 0.98139536, 'binary_f1_score': 0.84126985}
confusion matrix:
     0    1
0  211    4
1   56  159
new oracle model saved
early stop counter: 3
val acc:0.8214285969734192, best validation acc: 0.8369565010070801, corresponding to test acc:                         0.830232560634613 / 0.8604651093482971
after epoch: 6,now: 2024-07-22 20:57:30.906261,epoch time: 0:01:29.769292,used: 0:09:49.158752,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_22_20_47_41_seed_0_22755939
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9785156, 'precision': 0.9786777, 'recall': 0.97841793, 'specificity': 0.97841793, 'f1': 0.9785063, 'auroc': 0.99782306, 'binary_precision': 0.9727503, 'binary_recall': 0.9852375, 'binary_specificity': 0.9715984, 'binary_f1_score': 0.9789541}
confusion matrix:
      0     1
0  1471    43
1    23  1535
---- Validation: 
scalar performance:
{'acc': 0.7507764, 'precision': 0.77932906, 'recall': 0.75297415, 'specificity': 0.75297415, 'f1': 0.74529195, 'auroc': 0.88107944, 'binary_precision': 0.6864608, 'binary_recall': 0.91023624, 'binary_specificity': 0.5957121, 'binary_f1_score': 0.7826676}
confusion matrix:
     0    1
0  389  264
1   57  578
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.772093, 'precision': 0.8158192, 'recall': 0.77209306, 'specificity': 0.77209306, 'f1': 0.76392156, 'auroc': 0.9417631, 'binary_precision': 0.6983051, 'binary_recall': 0.95813954, 'binary_specificity': 0.5860465, 'binary_f1_score': 0.80784315}
confusion matrix:
     0    1
0  126   89
1    9  206
early stop counter: 4
val acc:0.7507764101028442, best validation acc: 0.8369565010070801, corresponding to test acc:                         0.830232560634613 / 0.8604651093482971
after epoch: 7,now: 2024-07-22 20:59:03.941913,epoch time: 0:01:33.035652,used: 0:11:22.194404,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_22_20_47_41_seed_0_22755939
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9860026, 'precision': 0.98597884, 'recall': 0.98604006, 'specificity': 0.98604006, 'f1': 0.986001, 'auroc': 0.9989936, 'binary_precision': 0.9890181, 'binary_recall': 0.9833012, 'binary_specificity': 0.9887789, 'binary_f1_score': 0.98615134}
confusion matrix:
      0     1
0  1498    17
1    26  1531
---- Validation: 
scalar performance:
{'acc': 0.8664596, 'precision': 0.8687297, 'recall': 0.8659127, 'specificity': 0.8659127, 'f1': 0.86610806, 'auroc': 0.91495585, 'binary_precision': 0.8943782, 'binary_recall': 0.8267717, 'binary_specificity': 0.9050536, 'binary_f1_score': 0.85924715}
confusion matrix:
     0    1
0  591   62
1  110  525
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8627907, 'precision': 0.8634275, 'recall': 0.8627907, 'specificity': 0.8627907, 'f1': 0.86273056, 'auroc': 0.92867494, 'binary_precision': 0.8786408, 'binary_recall': 0.8418605, 'binary_specificity': 0.88372093, 'binary_f1_score': 0.8598575}
confusion matrix:
     0    1
0  190   25
1   34  181
new oracle model saved
better model found
persisted
after epoch: 8,now: 2024-07-22 21:00:47.379772,epoch time: 0:01:43.437859,used: 0:13:05.632263,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_22_20_47_41_seed_0_22755939
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.96223956, 'precision': 0.9627718, 'recall': 0.9620466, 'specificity': 0.9620466, 'f1': 0.9622113, 'auroc': 0.9953258, 'binary_precision': 0.95, 'binary_recall': 0.97686374, 'binary_specificity': 0.94722956, 'binary_f1_score': 0.9632446}
confusion matrix:
      0     1
0  1436    80
1    36  1520
---- Validation: 
scalar performance:
{'acc': 0.7049689, 'precision': 0.78095365, 'recall': 0.7085577, 'specificity': 0.7085577, 'f1': 0.68581736, 'auroc': 0.85300064, 'binary_precision': 0.63130796, 'binary_recall': 0.9653543, 'binary_specificity': 0.4517611, 'binary_f1_score': 0.7633873}
confusion matrix:
     0    1
0  295  358
1   22  613
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7139535, 'precision': 0.79170597, 'recall': 0.7139535, 'specificity': 0.7139535, 'f1': 0.69353163, 'auroc': 0.9181179, 'binary_precision': 0.6411043, 'binary_recall': 0.97209305, 'binary_specificity': 0.45581394, 'binary_f1_score': 0.7726432}
confusion matrix:
    0    1
0  98  117
1   6  209
early stop counter: 1
val acc:0.7049689292907715, best validation acc: 0.8664596080780029, corresponding to test acc:                         0.8627907037734985 / 0.8627907037734985
after epoch: 9,now: 2024-07-22 21:02:17.976931,epoch time: 0:01:30.597159,used: 0:14:36.229422,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_22_20_47_41_seed_0_22755939
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9664714, 'precision': 0.96715975, 'recall': 0.96626085, 'specificity': 0.96626085, 'f1': 0.9664432, 'auroc': 0.9957243, 'binary_precision': 0.9520548, 'binary_recall': 0.98327976, 'binary_specificity': 0.94924194, 'binary_f1_score': 0.9674154}
confusion matrix:
      0     1
0  1440    77
1    26  1529
---- Validation: 
scalar performance:
{'acc': 0.79347825, 'precision': 0.8227176, 'recall': 0.795565, 'specificity': 0.795565, 'f1': 0.7894571, 'auroc': 0.9282006, 'binary_precision': 0.72202164, 'binary_recall': 0.9448819, 'binary_specificity': 0.6462481, 'binary_f1_score': 0.81855386}
confusion matrix:
     0    1
0  422  231
1   35  600
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.80465114, 'precision': 0.83427095, 'recall': 0.80465114, 'specificity': 0.80465114, 'f1': 0.8002257, 'auroc': 0.94872904, 'binary_precision': 0.734767, 'binary_recall': 0.95348835, 'binary_specificity': 0.65581393, 'binary_f1_score': 0.8299596}
confusion matrix:
     0    1
0  141   74
1   10  205
early stop counter: 2
val acc:0.79347825050354, best validation acc: 0.8664596080780029, corresponding to test acc:                         0.8627907037734985 / 0.8627907037734985
after epoch: 10,now: 2024-07-22 21:03:50.855861,epoch time: 0:01:32.878930,used: 0:16:09.108352,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_22_20_47_41_seed_0_22755939
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9742839, 'precision': 0.97469354, 'recall': 0.9745444, 'specificity': 0.9745444, 'f1': 0.97428334, 'auroc': 0.9971024, 'binary_precision': 0.99267155, 'binary_recall': 0.9563543, 'binary_specificity': 0.9927345, 'binary_f1_score': 0.97417456}
confusion matrix:
      0     1
0  1503    11
1    68  1490
---- Validation: 
scalar performance:
{'acc': 0.79736024, 'precision': 0.7975405, 'recall': 0.79752684, 'specificity': 0.79752684, 'f1': 0.7973602, 'auroc': 0.8701662, 'binary_precision': 0.7859327, 'binary_recall': 0.80944884, 'binary_specificity': 0.7856049, 'binary_f1_score': 0.79751754}
confusion matrix:
     0    1
0  513  140
1  121  514
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8255814, 'precision': 0.8316147, 'recall': 0.82558143, 'specificity': 0.82558143, 'f1': 0.82478446, 'auroc': 0.9290211, 'binary_precision': 0.78688526, 'binary_recall': 0.89302325, 'binary_specificity': 0.75813955, 'binary_f1_score': 0.8366013}
confusion matrix:
     0    1
0  163   52
1   23  192
early stop counter: 3
val acc:0.7973602414131165, best validation acc: 0.8664596080780029, corresponding to test acc:                         0.8627907037734985 / 0.8627907037734985
after epoch: 11,now: 2024-07-22 21:05:29.937581,epoch time: 0:01:39.081720,used: 0:17:48.190072,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_22_20_47_41_seed_0_22755939
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.97265625, 'precision': 0.9733336, 'recall': 0.97245073, 'specificity': 0.97245073, 'f1': 0.97263384, 'auroc': 0.9979478, 'binary_precision': 0.95825547, 'binary_recall': 0.9890675, 'binary_specificity': 0.9558339, 'binary_f1_score': 0.97341776}
confusion matrix:
      0     1
0  1450    67
1    17  1538
---- Validation: 
scalar performance:
{'acc': 0.76086956, 'precision': 0.7801242, 'recall': 0.7626678, 'specificity': 0.7626678, 'f1': 0.7574922, 'auroc': 0.86725354, 'binary_precision': 0.70310557, 'binary_recall': 0.8913386, 'binary_specificity': 0.63399696, 'binary_f1_score': 0.78611106}
confusion matrix:
     0    1
0  414  239
1   69  566
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.75581396, 'precision': 0.8059033, 'recall': 0.75581396, 'specificity': 0.75581396, 'f1': 0.74539137, 'auroc': 0.93994594, 'binary_precision': 0.6821192, 'binary_recall': 0.95813954, 'binary_specificity': 0.5534884, 'binary_f1_score': 0.79690516}
confusion matrix:
     0    1
0  119   96
1    9  206
early stop counter: 4
val acc:0.760869562625885, best validation acc: 0.8664596080780029, corresponding to test acc:                         0.8627907037734985 / 0.8627907037734985
after epoch: 12,now: 2024-07-22 21:06:59.061427,epoch time: 0:01:29.123846,used: 0:19:17.313918,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_22_20_47_41_seed_0_22755939
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9765625, 'precision': 0.97711957, 'recall': 0.976372, 'specificity': 0.976372, 'f1': 0.976545, 'auroc': 0.99887955, 'binary_precision': 0.96375, 'binary_recall': 0.99100256, 'binary_specificity': 0.96174145, 'binary_f1_score': 0.9771863}
confusion matrix:
      0     1
0  1458    58
1    14  1542
---- Validation: 
scalar performance:
{'acc': 0.7841615, 'precision': 0.8106656, 'recall': 0.7861813, 'specificity': 0.7861813, 'f1': 0.78024256, 'auroc': 0.9048655, 'binary_precision': 0.7163636, 'binary_recall': 0.93070865, 'binary_specificity': 0.6416539, 'binary_f1_score': 0.809589}
confusion matrix:
     0    1
0  419  234
1   44  591
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7744186, 'precision': 0.8124384, 'recall': 0.7744186, 'specificity': 0.7744186, 'f1': 0.76734066, 'auroc': 0.9263818, 'binary_precision': 0.7034483, 'binary_recall': 0.9488372, 'binary_specificity': 0.6, 'binary_f1_score': 0.8079208}
confusion matrix:
     0    1
0  129   86
1   11  204
early stop counter: 5
val acc:0.7841615080833435, best validation acc: 0.8664596080780029, corresponding to test acc:                         0.8627907037734985 / 0.8627907037734985
after epoch: 13,now: 2024-07-22 21:08:31.273537,epoch time: 0:01:32.212110,used: 0:20:49.526028,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_22_20_47_41_seed_0_22755939
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.98860675, 'precision': 0.98860097, 'recall': 0.9886091, 'specificity': 0.9886091, 'f1': 0.9886049, 'auroc': 0.9993094, 'binary_precision': 0.9890675, 'binary_recall': 0.9884319, 'binary_specificity': 0.9887863, 'binary_f1_score': 0.98874956}
confusion matrix:
      0     1
0  1499    17
1    18  1538
---- Validation: 
scalar performance:
{'acc': 0.81832296, 'precision': 0.81828797, 'recall': 0.8183309, 'specificity': 0.8183309, 'f1': 0.81830156, 'auroc': 0.89387083, 'binary_precision': 0.81377155, 'binary_recall': 0.81889766, 'binary_specificity': 0.81776416, 'binary_f1_score': 0.81632656}
confusion matrix:
     0    1
0  534  119
1  115  520
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.81860465, 'precision': 0.83002806, 'recall': 0.81860465, 'specificity': 0.81860465, 'f1': 0.8170213, 'auroc': 0.9358572, 'binary_precision': 0.76862746, 'binary_recall': 0.9116279, 'binary_specificity': 0.7255814, 'binary_f1_score': 0.83404255}
confusion matrix:
     0    1
0  156   59
1   19  196
early stop counter: 6
val acc:0.8183229565620422, best validation acc: 0.8664596080780029, corresponding to test acc:                         0.8627907037734985 / 0.8627907037734985
after epoch: 14,now: 2024-07-22 21:10:01.984201,epoch time: 0:01:30.710664,used: 0:22:20.236692,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_22_20_47_41_seed_0_22755939
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9869792, 'precision': 0.98712236, 'recall': 0.98713803, 'specificity': 0.98713803, 'f1': 0.9869791, 'auroc': 0.999228, 'binary_precision': 0.99934125, 'binary_recall': 0.9749357, 'binary_specificity': 0.99934036, 'binary_f1_score': 0.9869876}
confusion matrix:
      0     1
0  1515     1
1    39  1517
---- Validation: 
scalar performance:
{'acc': 0.8082298, 'precision': 0.8126373, 'recall': 0.8073784, 'specificity': 0.8073784, 'f1': 0.80722475, 'auroc': 0.88414216, 'binary_precision': 0.8464286, 'binary_recall': 0.7464567, 'binary_specificity': 0.86830014, 'binary_f1_score': 0.79330546}
confusion matrix:
     0    1
0  567   86
1  161  474
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8395349, 'precision': 0.84078074, 'recall': 0.8395349, 'specificity': 0.8395349, 'f1': 0.8393881, 'auroc': 0.9100487, 'binary_precision': 0.8201754, 'binary_recall': 0.8697674, 'binary_specificity': 0.80930233, 'binary_f1_score': 0.84424376}
confusion matrix:
     0    1
0  174   41
1   28  187
early stop counter: 7
val acc:0.8082298040390015, best validation acc: 0.8664596080780029, corresponding to test acc:                         0.8627907037734985 / 0.8627907037734985
after epoch: 15,now: 2024-07-22 21:11:32.717307,epoch time: 0:01:30.733106,used: 0:23:50.969798,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_22_20_47_41_seed_0_22755939
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9873047, 'precision': 0.98731685, 'recall': 0.98728895, 'specificity': 0.98728895, 'f1': 0.987302, 'auroc': 0.9989393, 'binary_precision': 0.98653847, 'binary_recall': 0.9884393, 'binary_specificity': 0.98613864, 'binary_f1_score': 0.98748803}
confusion matrix:
      0     1
0  1494    21
1    18  1539
---- Validation: 
scalar performance:
{'acc': 0.7709627, 'precision': 0.78100276, 'recall': 0.76960486, 'specificity': 0.76960486, 'f1': 0.7682638, 'auroc': 0.8624085, 'binary_precision': 0.8307393, 'binary_recall': 0.67244095, 'binary_specificity': 0.8667688, 'binary_f1_score': 0.743255}
confusion matrix:
     0    1
0  566   87
1  208  427
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8372093, 'precision': 0.8390872, 'recall': 0.83720934, 'specificity': 0.83720934, 'f1': 0.83698356, 'auroc': 0.90849113, 'binary_precision': 0.8643216, 'binary_recall': 0.8, 'binary_specificity': 0.8744186, 'binary_f1_score': 0.83091784}
confusion matrix:
     0    1
0  188   27
1   43  172
early stop counter: 8
val acc:0.7709627151489258, best validation acc: 0.8664596080780029, corresponding to test acc:                         0.8627907037734985 / 0.8627907037734985
after epoch: 16,now: 2024-07-22 21:13:02.706033,epoch time: 0:01:29.988726,used: 0:25:20.958524,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_22_20_47_41_seed_0_22755939
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.98046875, 'precision': 0.9809241, 'recall': 0.98071134, 'specificity': 0.98071134, 'f1': 0.9804681, 'auroc': 0.99955446, 'binary_precision': 0.9993324, 'binary_recall': 0.96208227, 'binary_specificity': 0.99934036, 'binary_f1_score': 0.98035365}
confusion matrix:
      0     1
0  1515     1
1    59  1497
---- Validation: 
scalar performance:
{'acc': 0.5838509, 'precision': 0.74015343, 'recall': 0.57812643, 'specificity': 0.57812643, 'f1': 0.49589774, 'auroc': 0.8747344, 'binary_precision': 0.93043476, 'binary_recall': 0.16850394, 'binary_specificity': 0.98774886, 'binary_f1_score': 0.28533334}
confusion matrix:
     0    1
0  645    8
1  528  107
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.772093, 'precision': 0.8434505, 'recall': 0.77209306, 'specificity': 0.77209306, 'f1': 0.7596066, 'auroc': 0.91554356, 'binary_precision': 1.0, 'binary_recall': 0.54418606, 'binary_specificity': 1.0, 'binary_f1_score': 0.70481926}
confusion matrix:
     0    1
0  215    0
1   98  117
early stop counter: 9
val acc:0.5838509202003479, best validation acc: 0.8664596080780029, corresponding to test acc:                         0.8627907037734985 / 0.8627907037734985
after epoch: 17,now: 2024-07-22 21:14:34.747501,epoch time: 0:01:32.041468,used: 0:26:52.999992,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_22_20_47_41_seed_0_22755939
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9905599, 'precision': 0.9905407, 'recall': 0.9906249, 'specificity': 0.9906249, 'f1': 0.9905592, 'auroc': 0.9994645, 'binary_precision': 0.99546045, 'binary_recall': 0.98587024, 'binary_specificity': 0.99537957, 'binary_f1_score': 0.99064213}
confusion matrix:
      0     1
0  1508     7
1    22  1535
---- Validation: 
scalar performance:
{'acc': 0.81909937, 'precision': 0.83519673, 'recall': 0.81755555, 'specificity': 0.81755555, 'f1': 0.81637096, 'auroc': 0.90471596, 'binary_precision': 0.9052419, 'binary_recall': 0.7070866, 'binary_specificity': 0.92802453, 'binary_f1_score': 0.79398763}
confusion matrix:
     0    1
0  606   47
1  186  449
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8627907, 'precision': 0.86507314, 'recall': 0.8627907, 'specificity': 0.8627907, 'f1': 0.8625759, 'auroc': 0.9276582, 'binary_precision': 0.8939394, 'binary_recall': 0.82325584, 'binary_specificity': 0.9023256, 'binary_f1_score': 0.85714287}
confusion matrix:
     0    1
0  194   21
1   38  177
early stop counter: 10
val acc:0.8190993666648865, best validation acc: 0.8664596080780029, corresponding to test acc:                         0.8627907037734985 / 0.8627907037734985
after epoch: 18,now: 2024-07-22 21:16:03.942872,epoch time: 0:01:29.195371,used: 0:28:22.195363,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_22_20_47_41_seed_0_22755939
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9899089, 'precision': 0.9899037, 'recall': 0.9899113, 'specificity': 0.9899113, 'f1': 0.9899074, 'auroc': 0.9995023, 'binary_precision': 0.9903475, 'binary_recall': 0.9897106, 'binary_specificity': 0.99011207, 'binary_f1_score': 0.9900289}
confusion matrix:
      0     1
0  1502    15
1    16  1539
---- Validation: 
scalar performance:
{'acc': 0.88819873, 'precision': 0.8896128, 'recall': 0.88778627, 'specificity': 0.88778627, 'f1': 0.8880019, 'auroc': 0.93198204, 'binary_precision': 0.90984976, 'binary_recall': 0.8582677, 'binary_specificity': 0.91730475, 'binary_f1_score': 0.8833064}
confusion matrix:
     0    1
0  599   54
1   90  545
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.86744183, 'precision': 0.87247807, 'recall': 0.8674419, 'specificity': 0.8674419, 'f1': 0.86699224, 'auroc': 0.9279611, 'binary_precision': 0.9157895, 'binary_recall': 0.80930233, 'binary_specificity': 0.9255814, 'binary_f1_score': 0.85925925}
confusion matrix:
     0    1
0  199   16
1   41  174
new oracle model saved
better model found
persisted
after epoch: 19,now: 2024-07-22 21:17:34.064772,epoch time: 0:01:30.121900,used: 0:29:52.317263,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_22_20_47_41_seed_0_22755939
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9892578, 'precision': 0.9892863, 'recall': 0.98938155, 'specificity': 0.98938155, 'f1': 0.98925745, 'auroc': 0.99927855, 'binary_precision': 0.9980405, 'binary_recall': 0.98074454, 'binary_specificity': 0.9980185, 'binary_f1_score': 0.98931694}
confusion matrix:
      0     1
0  1511     3
1    30  1528
---- Validation: 
scalar performance:
{'acc': 0.78571427, 'precision': 0.8292019, 'recall': 0.7831547, 'specificity': 0.7831547, 'f1': 0.77732515, 'auroc': 0.9231554, 'binary_precision': 0.9454094, 'binary_recall': 0.6, 'binary_specificity': 0.96630937, 'binary_f1_score': 0.73410404}
confusion matrix:
     0    1
0  631   22
1  254  381
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7883721, 'precision': 0.83887535, 'recall': 0.7883721, 'specificity': 0.7883721, 'f1': 0.7801821, 'auroc': 0.91662526, 'binary_precision': 0.969697, 'binary_recall': 0.59534883, 'binary_specificity': 0.98139536, 'binary_f1_score': 0.7377522}
confusion matrix:
     0    1
0  211    4
1   87  128
early stop counter: 1
val acc:0.7857142686843872, best validation acc: 0.888198733329773, corresponding to test acc:                         0.8674418330192566 / 0.8674418330192566
after epoch: 20,now: 2024-07-22 21:19:06.070505,epoch time: 0:01:32.005733,used: 0:31:24.322996,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_22_20_47_41_seed_0_22755939
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.98567706, 'precision': 0.9859859, 'recall': 0.98554087, 'specificity': 0.98554087, 'f1': 0.9856692, 'auroc': 0.9992187, 'binary_precision': 0.9766856, 'binary_recall': 0.9955042, 'binary_specificity': 0.97557753, 'binary_f1_score': 0.9860051}
confusion matrix:
      0     1
0  1478    37
1     7  1550
---- Validation: 
scalar performance:
{'acc': 0.8586956, 'precision': 0.8621038, 'recall': 0.8580169, 'specificity': 0.8580169, 'f1': 0.8581755, 'auroc': 0.92710805, 'binary_precision': 0.89391303, 'binary_recall': 0.80944884, 'binary_specificity': 0.906585, 'binary_f1_score': 0.8495868}
confusion matrix:
     0    1
0  592   61
1  121  514
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.87906975, 'precision': 0.8802543, 'recall': 0.8790698, 'specificity': 0.8790698, 'f1': 0.8789755, 'auroc': 0.93667924, 'binary_precision': 0.9014778, 'binary_recall': 0.8511628, 'binary_specificity': 0.90697676, 'binary_f1_score': 0.8755981}
confusion matrix:
     0    1
0  195   20
1   32  183
new oracle model saved
early stop counter: 2
val acc:0.8586956262588501, best validation acc: 0.888198733329773, corresponding to test acc:                         0.8674418330192566 / 0.8790697455406189
after epoch: 21,now: 2024-07-22 21:20:35.436317,epoch time: 0:01:29.365812,used: 0:32:53.688808,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_22_20_47_41_seed_0_22755939
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9270833, 'precision': 0.9367629, 'recall': 0.92609036, 'specificity': 0.92609036, 'f1': 0.9265491, 'auroc': 0.9979744, 'binary_precision': 0.87507033, 'binary_recall': 0.99871546, 'binary_specificity': 0.8534653, 'binary_f1_score': 0.9328134}
confusion matrix:
      0     1
0  1293   222
1     2  1555
---- Validation: 
scalar performance:
{'acc': 0.76940995, 'precision': 0.8077066, 'recall': 0.7718501, 'specificity': 0.7718501, 'f1': 0.7630509, 'auroc': 0.93062913, 'binary_precision': 0.6956019, 'binary_recall': 0.9464567, 'binary_specificity': 0.5972435, 'binary_f1_score': 0.8018679}
confusion matrix:
     0    1
0  390  263
1   34  601
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.772093, 'precision': 0.8109471, 'recall': 0.77209306, 'specificity': 0.77209306, 'f1': 0.764744, 'auroc': 0.93659276, 'binary_precision': 0.7010309, 'binary_recall': 0.9488372, 'binary_specificity': 0.59534883, 'binary_f1_score': 0.8063241}
confusion matrix:
     0    1
0  128   87
1   11  204
early stop counter: 3
val acc:0.7694099545478821, best validation acc: 0.888198733329773, corresponding to test acc:                         0.8674418330192566 / 0.8790697455406189
after epoch: 22,now: 2024-07-22 21:22:05.999709,epoch time: 0:01:30.563392,used: 0:34:24.252200,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_22_20_47_41_seed_0_22755939
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.98046875, 'precision': 0.98079205, 'recall': 0.9807072, 'specificity': 0.9807072, 'f1': 0.98046863, 'auroc': 0.9981432, 'binary_precision': 0.99734396, 'binary_recall': 0.9640565, 'binary_specificity': 0.99735796, 'binary_f1_score': 0.9804177}
confusion matrix:
      0     1
0  1510     4
1    56  1502
---- Validation: 
scalar performance:
{'acc': 0.6917702, 'precision': 0.78476, 'recall': 0.68772715, 'specificity': 0.68772715, 'f1': 0.66152805, 'auroc': 0.91637385, 'binary_precision': 0.94402987, 'binary_recall': 0.3984252, 'binary_specificity': 0.9770291, 'binary_f1_score': 0.56035435}
confusion matrix:
     0    1
0  638   15
1  382  253
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8488372, 'precision': 0.88392854, 'recall': 0.8488372, 'specificity': 0.8488372, 'f1': 0.84530234, 'auroc': 0.95316386, 'binary_precision': 1.0, 'binary_recall': 0.6976744, 'binary_specificity': 1.0, 'binary_f1_score': 0.8219178}
confusion matrix:
     0    1
0  215    0
1   65  150
early stop counter: 4
val acc:0.6917701959609985, best validation acc: 0.888198733329773, corresponding to test acc:                         0.8674418330192566 / 0.8790697455406189
after epoch: 23,now: 2024-07-22 21:23:39.279145,epoch time: 0:01:33.279436,used: 0:35:57.531636,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_22_20_47_41_seed_0_22755939
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.98795575, 'precision': 0.9880636, 'recall': 0.98788667, 'specificity': 0.98788667, 'f1': 0.9879516, 'auroc': 0.9990347, 'binary_precision': 0.98346055, 'binary_recall': 0.9929351, 'binary_specificity': 0.9828383, 'binary_f1_score': 0.98817515}
confusion matrix:
      0     1
0  1489    26
1    11  1546
---- Validation: 
scalar performance:
{'acc': 0.88819873, 'precision': 0.8882159, 'recall': 0.8881335, 'specificity': 0.8881335, 'f1': 0.8881662, 'auroc': 0.93703926, 'binary_precision': 0.88906497, 'binary_recall': 0.8834646, 'binary_specificity': 0.8928025, 'binary_f1_score': 0.8862559}
confusion matrix:
     0    1
0  583   70
1   74  561
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.90465117, 'precision': 0.90854883, 'recall': 0.90465117, 'specificity': 0.90465117, 'f1': 0.90442324, 'auroc': 0.9588102, 'binary_precision': 0.9484536, 'binary_recall': 0.855814, 'binary_specificity': 0.95348835, 'binary_f1_score': 0.8997555}
confusion matrix:
     0    1
0  205   10
1   31  184
new oracle model saved
early stop counter: 5
val acc:0.888198733329773, best validation acc: 0.888198733329773, corresponding to test acc:                         0.8674418330192566 / 0.9046511650085449
after epoch: 24,now: 2024-07-22 21:25:09.372209,epoch time: 0:01:30.093064,used: 0:37:27.624700,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_22_20_47_41_seed_0_22755939
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.9921875, 'precision': 0.9921682, 'recall': 0.9922266, 'specificity': 0.9922266, 'f1': 0.99218684, 'auroc': 0.9996197, 'binary_precision': 0.9954693, 'binary_recall': 0.9890675, 'binary_specificity': 0.99538565, 'binary_f1_score': 0.9922581}
confusion matrix:
      0     1
0  1510     7
1    17  1538
---- Validation: 
scalar performance:
{'acc': 0.88586956, 'precision': 0.890219, 'recall': 0.88514185, 'specificity': 0.88514185, 'f1': 0.8853936, 'auroc': 0.93988264, 'binary_precision': 0.9280702, 'binary_recall': 0.8330709, 'binary_specificity': 0.9372129, 'binary_f1_score': 0.8780083}
confusion matrix:
     0    1
0  612   41
1  106  529
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9, 'precision': 0.9074123, 'recall': 0.9, 'specificity': 0.9, 'f1': 0.89954305, 'auroc': 0.9532287, 'binary_precision': 0.96236557, 'binary_recall': 0.83255816, 'binary_specificity': 0.96744186, 'binary_f1_score': 0.892768}
confusion matrix:
     0    1
0  208    7
1   36  179
early stop counter: 6
val acc:0.885869562625885, best validation acc: 0.888198733329773, corresponding to test acc:                         0.8674418330192566 / 0.9046511650085449
after epoch: 25,now: 2024-07-22 21:26:39.771221,epoch time: 0:01:30.399012,used: 0:38:58.023712,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_22_20_47_41_seed_0_22755939
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.992513, 'precision': 0.99252594, 'recall': 0.992499, 'specificity': 0.992499, 'f1': 0.9925116, 'auroc': 0.9993683, 'binary_precision': 0.9916613, 'binary_recall': 0.99357325, 'binary_specificity': 0.9914248, 'binary_f1_score': 0.99261636}
confusion matrix:
      0     1
0  1503    13
1    10  1546
---- Validation: 
scalar performance:
{'acc': 0.7919255, 'precision': 0.8281747, 'recall': 0.7895841, 'specificity': 0.7895841, 'f1': 0.78507185, 'auroc': 0.9264883, 'binary_precision': 0.9338061, 'binary_recall': 0.62204725, 'binary_specificity': 0.95712095, 'binary_f1_score': 0.7466919}
confusion matrix:
     0    1
0  625   28
1  240  395
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.89302325, 'precision': 0.90711486, 'recall': 0.89302325, 'specificity': 0.89302325, 'f1': 0.8920895, 'auroc': 0.95130336, 'binary_precision': 0.98285717, 'binary_recall': 0.8, 'binary_specificity': 0.9860465, 'binary_f1_score': 0.8820513}
confusion matrix:
     0    1
0  212    3
1   43  172
early stop counter: 7
val acc:0.7919254899024963, best validation acc: 0.888198733329773, corresponding to test acc:                         0.8674418330192566 / 0.9046511650085449
after epoch: 26,now: 2024-07-22 21:28:12.927319,epoch time: 0:01:33.156098,used: 0:40:31.179810,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_22_20_47_41_seed_0_22755939
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.99153644, 'precision': 0.99151516, 'recall': 0.9915627, 'specificity': 0.9915627, 'f1': 0.9915351, 'auroc': 0.99945486, 'binary_precision': 0.9935567, 'binary_recall': 0.9897304, 'binary_specificity': 0.993395, 'binary_f1_score': 0.99163985}
confusion matrix:
      0     1
0  1504    10
1    16  1542
---- Validation: 
scalar performance:
{'acc': 0.7779503, 'precision': 0.8094957, 'recall': 0.77569306, 'specificity': 0.77569306, 'f1': 0.77115166, 'auroc': 0.91061187, 'binary_precision': 0.9048724, 'binary_recall': 0.61417323, 'binary_specificity': 0.9372129, 'binary_f1_score': 0.73170733}
confusion matrix:
     0    1
0  612   41
1  245  390
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.87906975, 'precision': 0.89129317, 'recall': 0.8790698, 'specificity': 0.8790698, 'f1': 0.8781179, 'auroc': 0.94336396, 'binary_precision': 0.96045196, 'binary_recall': 0.7906977, 'binary_specificity': 0.96744186, 'binary_f1_score': 0.86734694}
confusion matrix:
     0    1
0  208    7
1   45  170
early stop counter: 8
val acc:0.7779502868652344, best validation acc: 0.888198733329773, corresponding to test acc:                         0.8674418330192566 / 0.9046511650085449
after epoch: 27,now: 2024-07-22 21:29:42.906702,epoch time: 0:01:29.979383,used: 0:42:01.159193,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_22_20_47_41_seed_0_22755939
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.99121094, 'precision': 0.9912056, 'recall': 0.9912137, 'specificity': 0.9912137, 'f1': 0.9912095, 'auroc': 0.99971044, 'binary_precision': 0.99163985, 'binary_recall': 0.99100256, 'binary_specificity': 0.9914248, 'binary_f1_score': 0.9913211}
confusion matrix:
      0     1
0  1503    13
1    14  1542
---- Validation: 
scalar performance:
{'acc': 0.79347825, 'precision': 0.8347718, 'recall': 0.791007, 'specificity': 0.791007, 'f1': 0.78592086, 'auroc': 0.93215805, 'binary_precision': 0.9489051, 'binary_recall': 0.61417323, 'binary_specificity': 0.96784073, 'binary_f1_score': 0.74569786}
confusion matrix:
     0    1
0  632   21
1  245  390
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8372093, 'precision': 0.877193, 'recall': 0.83720934, 'specificity': 0.83720934, 'f1': 0.83277774, 'auroc': 0.9423905, 'binary_precision': 1.0, 'binary_recall': 0.6744186, 'binary_specificity': 1.0, 'binary_f1_score': 0.8055555}
confusion matrix:
     0    1
0  215    0
1   70  145
early stop counter: 9
val acc:0.79347825050354, best validation acc: 0.888198733329773, corresponding to test acc:                         0.8674418330192566 / 0.9046511650085449
after epoch: 28,now: 2024-07-22 21:31:12.163949,epoch time: 0:01:29.257247,used: 0:43:30.416440,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_22_20_47_41_seed_0_22755939
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9938151, 'precision': 0.9937963, 'recall': 0.99385846, 'specificity': 0.99385846, 'f1': 0.9938146, 'auroc': 0.9997511, 'binary_precision': 0.99740934, 'binary_recall': 0.9903537, 'binary_specificity': 0.9973632, 'binary_f1_score': 0.993869}
confusion matrix:
      0     1
0  1513     4
1    15  1540
---- Validation: 
scalar performance:
{'acc': 0.7841615, 'precision': 0.8232446, 'recall': 0.7817101, 'specificity': 0.7817101, 'f1': 0.7763978, 'auroc': 0.91278774, 'binary_precision': 0.9322034, 'binary_recall': 0.6062992, 'binary_specificity': 0.95712095, 'binary_f1_score': 0.7347328}
confusion matrix:
     0    1
0  625   28
1  250  385
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.86744183, 'precision': 0.887573, 'recall': 0.8674419, 'specificity': 0.8674419, 'f1': 0.86569786, 'auroc': 0.9383018, 'binary_precision': 0.97590363, 'binary_recall': 0.75348836, 'binary_specificity': 0.98139536, 'binary_f1_score': 0.85039365}
confusion matrix:
     0    1
0  211    4
1   53  162
early stop counter: 10
val acc:0.7841615080833435, best validation acc: 0.888198733329773, corresponding to test acc:                         0.8674418330192566 / 0.9046511650085449
after epoch: 29,now: 2024-07-22 21:32:44.754405,epoch time: 0:01:32.590456,used: 0:45:03.006896,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_22_20_47_41_seed_0_22755939
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.9840495, 'precision': 0.9841448, 'recall': 0.9842094, 'specificity': 0.9842094, 'f1': 0.9840493, 'auroc': 0.9990618, 'binary_precision': 0.9954038, 'binary_recall': 0.97304237, 'binary_specificity': 0.99537647, 'binary_f1_score': 0.98409605}
confusion matrix:
      0     1
0  1507     7
1    42  1516
---- Validation: 
scalar performance:
{'acc': 0.8695652, 'precision': 0.8740775, 'recall': 0.8688018, 'specificity': 0.8688018, 'f1': 0.8689811, 'auroc': 0.93105114, 'binary_precision': 0.9118166, 'binary_recall': 0.8141732, 'binary_specificity': 0.9234303, 'binary_f1_score': 0.860233}
confusion matrix:
     0    1
0  603   50
1  118  517
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.89534885, 'precision': 0.8972826, 'recall': 0.89534885, 'specificity': 0.89534885, 'f1': 0.8952213, 'auroc': 0.9580097, 'binary_precision': 0.925, 'binary_recall': 0.8604651, 'binary_specificity': 0.9302326, 'binary_f1_score': 0.8915662}
confusion matrix:
     0    1
0  200   15
1   30  185
early stop counter: 11
val acc:0.8695651888847351, best validation acc: 0.888198733329773, corresponding to test acc:                         0.8674418330192566 / 0.9046511650085449
after epoch: 30,now: 2024-07-22 21:34:14.518164,epoch time: 0:01:29.763759,used: 0:46:32.770655,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_22_20_47_41_seed_0_22755939
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 0:46:32.770655 at 2024-07-22 21:34:14.518164
persisted model performance metric: 

scalar performance:
{'acc': 0.86744183, 'precision': 0.87247807, 'recall': 0.8674419, 'specificity': 0.8674419, 'f1': 0.86699224, 'auroc': 0.9279611, 'binary_precision': 0.9157895, 'binary_recall': 0.80930233, 'binary_specificity': 0.9255814, 'binary_f1_score': 0.85925925}
confusion matrix:
     0    1
0  199   16
1   41  174
oracle model performance metric: 

scalar performance:
{'acc': 0.90465117, 'precision': 0.90854883, 'recall': 0.90465117, 'specificity': 0.90465117, 'f1': 0.90442324, 'auroc': 0.9588102, 'binary_precision': 0.9484536, 'binary_recall': 0.855814, 'binary_specificity': 0.95348835, 'binary_f1_score': 0.8997555}
confusion matrix:
     0    1
0  205   10
1   31  184
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_higherregularization_irm_dial_lr1e5_bs16_nofreeze_2024-07-22_16-00-54/rule_results/1.csv
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_higherregularization_irm_dial_lr1e5_bs16_nofreeze_2024-07-22_16-00-54/rule_results/1.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_higherregularization_irm_dial_lr1e5_bs16_nofreeze_2024-07-22_16-00-54/confusion_matrix/1.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 455454 KiB |  13219 MiB |  74168 GiB |  74168 GiB |
|       from large pool | 414861 KiB |  13181 MiB |  73287 GiB |  73286 GiB |
|       from small pool |  40592 KiB |     56 MiB |    881 GiB |    881 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 455454 KiB |  13219 MiB |  74168 GiB |  74168 GiB |
|       from large pool | 414861 KiB |  13181 MiB |  73287 GiB |  73286 GiB |
|       from small pool |  40592 KiB |     56 MiB |    881 GiB |    881 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 447480 KiB |  13213 MiB |  73659 GiB |  73658 GiB |
|       from large pool | 407075 KiB |  13175 MiB |  72779 GiB |  72778 GiB |
|       from small pool |  40405 KiB |     56 MiB |    879 GiB |    879 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  14470 MiB |  14470 MiB |  14470 MiB |      0 B   |
|       from large pool |  14404 MiB |  14404 MiB |  14404 MiB |      0 B   |
|       from small pool |     66 MiB |     66 MiB |     66 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory | 470242 KiB |   1229 MiB |  52507 GiB |  52507 GiB |
|       from large pool | 461682 KiB |   1224 MiB |  51622 GiB |  51622 GiB |
|       from small pool |   8559 KiB |     17 MiB |    884 GiB |    884 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    1298    |    2594    |   13013 K  |   13011 K  |
|       from large pool |     187    |    1413    |    6639 K  |    6639 K  |
|       from small pool |    1111    |    1407    |    6373 K  |    6372 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    1298    |    2594    |   13013 K  |   13011 K  |
|       from large pool |     187    |    1413    |    6639 K  |    6639 K  |
|       from small pool |    1111    |    1407    |    6373 K  |    6372 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     634    |     634    |     634    |       0    |
|       from large pool |     601    |     601    |     601    |       0    |
|       from small pool |      33    |      33    |      33    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      93    |     650    |    9102 K  |    9101 K  |
|       from large pool |      39    |     600    |    5427 K  |    5427 K  |
|       from small pool |      54    |     234    |    3674 K  |    3674 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13219 MiB |  74168 GiB |  74168 GiB |
|       from large pool |  16640 KiB |  13181 MiB |  73287 GiB |  73287 GiB |
|       from small pool |      0 KiB |     56 MiB |    881 GiB |    881 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13219 MiB |  74168 GiB |  74168 GiB |
|       from large pool |  16640 KiB |  13181 MiB |  73287 GiB |  73287 GiB |
|       from small pool |      0 KiB |     56 MiB |    881 GiB |    881 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13213 MiB |  73659 GiB |  73659 GiB |
|       from large pool |  16640 KiB |  13175 MiB |  72779 GiB |  72779 GiB |
|       from small pool |      0 KiB |     56 MiB |    879 GiB |    879 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    904 MiB |  14470 MiB |  14470 MiB |  13566 MiB |
|       from large pool |    856 MiB |  14404 MiB |  14404 MiB |  13548 MiB |
|       from small pool |     48 MiB |     66 MiB |     66 MiB |     18 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1229 MiB |  52508 GiB |  52508 GiB |
|       from large pool |  24320 KiB |   1224 MiB |  51623 GiB |  51623 GiB |
|       from small pool |      0 KiB |     42 MiB |    885 GiB |    885 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    2594    |   13013 K  |   13013 K  |
|       from large pool |       2    |    1413    |    6639 K  |    6639 K  |
|       from small pool |       0    |    1407    |    6373 K  |    6373 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    2594    |   13013 K  |   13013 K  |
|       from large pool |       2    |    1413    |    6639 K  |    6639 K  |
|       from small pool |       0    |    1407    |    6373 K  |    6373 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      62    |     634    |     634    |     572    |
|       from large pool |      38    |     601    |     601    |     563    |
|       from small pool |      24    |      33    |      33    |       9    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |     650    |    9102 K  |    9102 K  |
|       from large pool |       4    |     600    |    5427 K  |    5427 K  |
|       from small pool |       0    |     234    |    3674 K  |    3674 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13219 MiB |  74168 GiB |  74168 GiB |
|       from large pool |  16640 KiB |  13181 MiB |  73287 GiB |  73287 GiB |
|       from small pool |      0 KiB |     56 MiB |    881 GiB |    881 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13219 MiB |  74168 GiB |  74168 GiB |
|       from large pool |  16640 KiB |  13181 MiB |  73287 GiB |  73287 GiB |
|       from small pool |      0 KiB |     56 MiB |    881 GiB |    881 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13213 MiB |  73659 GiB |  73659 GiB |
|       from large pool |  16640 KiB |  13175 MiB |  72779 GiB |  72779 GiB |
|       from small pool |      0 KiB |     56 MiB |    879 GiB |    879 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    904 MiB |  14470 MiB |  14470 MiB |  13566 MiB |
|       from large pool |    856 MiB |  14404 MiB |  14404 MiB |  13548 MiB |
|       from small pool |     48 MiB |     66 MiB |     66 MiB |     18 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1229 MiB |  52508 GiB |  52508 GiB |
|       from large pool |  24320 KiB |   1224 MiB |  51623 GiB |  51623 GiB |
|       from small pool |      0 KiB |     42 MiB |    885 GiB |    885 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    2594    |   13013 K  |   13013 K  |
|       from large pool |       2    |    1413    |    6639 K  |    6639 K  |
|       from small pool |       0    |    1407    |    6373 K  |    6373 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    2594    |   13013 K  |   13013 K  |
|       from large pool |       2    |    1413    |    6639 K  |    6639 K  |
|       from small pool |       0    |    1407    |    6373 K  |    6373 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      62    |     634    |     634    |     572    |
|       from large pool |      38    |     601    |     601    |     563    |
|       from small pool |      24    |      33    |      33    |       9    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |     650    |    9102 K  |    9102 K  |
|       from large pool |       4    |     600    |    5427 K  |    5427 K  |
|       from small pool |       0    |     234    |    3674 K  |    3674 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'888c1ef2'
model name: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_22_21_35_26_seed_1_22755939

 Experiment start at: 2024-07-22 21:35:26.426640
before training, model accuracy: 0.6177777647972107
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.83951825, 'precision': 0.86820114, 'recall': 0.84124553, 'specificity': 0.84124553, 'f1': 0.8367925, 'auroc': 0.91556406, 'binary_precision': 0.97410715, 'binary_recall': 0.7016077, 'binary_specificity': 0.9808833, 'binary_f1_score': 0.81570095}
confusion matrix:
      0     1
0  1488    29
1   464  1091
---- Validation: 
scalar performance:
{'acc': 0.51600313, 'precision': 0.51738876, 'recall': 0.51105994, 'specificity': 0.51105994, 'f1': 0.46457756, 'auroc': 0.6868383, 'binary_precision': 0.51968503, 'binary_recall': 0.20952381, 'binary_specificity': 0.812596, 'binary_f1_score': 0.29864255}
confusion matrix:
     0    1
0  529  122
1  498  132
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5911111, 'precision': 0.61586577, 'recall': 0.5911111, 'specificity': 0.5911111, 'f1': 0.56803906, 'auroc': 0.75794566, 'binary_precision': 0.6694215, 'binary_recall': 0.36, 'binary_specificity': 0.82222223, 'binary_f1_score': 0.46820807}
confusion matrix:
     0   1
0  185  40
1  144  81
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-22 21:37:07.503699,epoch time: 0:01:41.077059,used: 0:01:41.077059,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_22_21_35_26_seed_1_22755939
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9000651, 'precision': 0.9117206, 'recall': 0.9012349, 'specificity': 0.9012349, 'f1': 0.8995261, 'auroc': 0.96747065, 'binary_precision': 0.9844961, 'binary_recall': 0.81567115, 'binary_specificity': 0.9867987, 'binary_f1_score': 0.89216715}
confusion matrix:
      0     1
0  1495    20
1   287  1270
---- Validation: 
scalar performance:
{'acc': 0.73458236, 'precision': 0.78373754, 'recall': 0.7379416, 'specificity': 0.7379416, 'f1': 0.7243334, 'auroc': 0.8509009, 'binary_precision': 0.66146994, 'binary_recall': 0.94285715, 'binary_specificity': 0.5330261, 'binary_f1_score': 0.7774869}
confusion matrix:
     0    1
0  347  304
1   36  594
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.72, 'precision': 0.7741538, 'recall': 0.72, 'specificity': 0.72, 'f1': 0.7054546, 'auroc': 0.88250864, 'binary_precision': 0.6523077, 'binary_recall': 0.94222224, 'binary_specificity': 0.4977778, 'binary_f1_score': 0.77090913}
confusion matrix:
     0    1
0  112  113
1   13  212
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-07-22 21:38:42.323330,epoch time: 0:01:34.819631,used: 0:03:15.896690,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_22_21_35_26_seed_1_22755939
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9355469, 'precision': 0.9356971, 'recall': 0.935683, 'specificity': 0.935683, 'f1': 0.9355469, 'auroc': 0.97824395, 'binary_precision': 0.94722956, 'binary_recall': 0.9240669, 'binary_specificity': 0.94729906, 'binary_f1_score': 0.9355049}
confusion matrix:
      0     1
0  1438    80
1   118  1436
---- Validation: 
scalar performance:
{'acc': 0.7275566, 'precision': 0.7880246, 'recall': 0.7312596, 'specificity': 0.7312596, 'f1': 0.71449435, 'auroc': 0.8880062, 'binary_precision': 0.6518919, 'binary_recall': 0.95714283, 'binary_specificity': 0.50537634, 'binary_f1_score': 0.77556264}
confusion matrix:
     0    1
0  329  322
1   27  603
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.73333335, 'precision': 0.7777778, 'recall': 0.73333335, 'specificity': 0.73333335, 'f1': 0.7222222, 'auroc': 0.90538275, 'binary_precision': 0.6666667, 'binary_recall': 0.93333334, 'binary_specificity': 0.53333336, 'binary_f1_score': 0.7777778}
confusion matrix:
     0    1
0  120  105
1   15  210
new oracle model saved
early stop counter: 1
val acc:0.727556586265564, best validation acc: 0.7345823645591736, corresponding to test acc:                         0.7200000286102295 / 0.7333333492279053
after epoch: 3,now: 2024-07-22 21:40:13.970440,epoch time: 0:01:31.647110,used: 0:04:47.543800,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_22_21_35_26_seed_1_22755939
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.94401044, 'precision': 0.94406754, 'recall': 0.94395006, 'specificity': 0.94395006, 'f1': 0.9439944, 'auroc': 0.98425746, 'binary_precision': 0.94132656, 'binary_recall': 0.9485861, 'binary_specificity': 0.939314, 'binary_f1_score': 0.9449424}
confusion matrix:
      0     1
0  1424    92
1    80  1476
---- Validation: 
scalar performance:
{'acc': 0.7673693, 'precision': 0.8009823, 'recall': 0.7700717, 'specificity': 0.7700717, 'f1': 0.7618507, 'auroc': 0.90811443, 'binary_precision': 0.6962175, 'binary_recall': 0.9349206, 'binary_specificity': 0.60522276, 'binary_f1_score': 0.7981029}
confusion matrix:
     0    1
0  394  257
1   41  589
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.74, 'precision': 0.77995396, 'recall': 0.74, 'specificity': 0.74, 'f1': 0.7303803, 'auroc': 0.9144099, 'binary_precision': 0.67419356, 'binary_recall': 0.9288889, 'binary_specificity': 0.5511111, 'binary_f1_score': 0.7813085}
confusion matrix:
     0    1
0  124  101
1   16  209
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-07-22 21:41:45.882469,epoch time: 0:01:31.912029,used: 0:06:19.455829,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_22_21_35_26_seed_1_22755939
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9550781, 'precision': 0.9551756, 'recall': 0.95500267, 'specificity': 0.95500267, 'f1': 0.9550632, 'auroc': 0.99116874, 'binary_precision': 0.9510178, 'binary_recall': 0.9607969, 'binary_specificity': 0.94920844, 'binary_f1_score': 0.9558824}
confusion matrix:
      0     1
0  1439    77
1    61  1495
---- Validation: 
scalar performance:
{'acc': 0.8126464, 'precision': 0.8210049, 'recall': 0.8139529, 'specificity': 0.8139529, 'f1': 0.81181777, 'auroc': 0.9041401, 'binary_precision': 0.7649456, 'binary_recall': 0.89365077, 'binary_specificity': 0.734255, 'binary_f1_score': 0.82430446}
confusion matrix:
     0    1
0  478  173
1   67  563
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8066667, 'precision': 0.8105, 'recall': 0.8066666, 'specificity': 0.8066666, 'f1': 0.8060681, 'auroc': 0.91247404, 'binary_precision': 0.776, 'binary_recall': 0.8622222, 'binary_specificity': 0.7511111, 'binary_f1_score': 0.8168421}
confusion matrix:
     0    1
0  169   56
1   31  194
new oracle model saved
better model found
persisted
after epoch: 5,now: 2024-07-22 21:43:18.348459,epoch time: 0:01:32.465990,used: 0:07:51.921819,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_22_21_35_26_seed_1_22755939
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.95214844, 'precision': 0.95471835, 'recall': 0.9526702, 'specificity': 0.9526702, 'f1': 0.9521118, 'auroc': 0.9938378, 'binary_precision': 0.9923131, 'binary_recall': 0.9125964, 'binary_specificity': 0.9927441, 'binary_f1_score': 0.95078677}
confusion matrix:
      0     1
0  1505    11
1   136  1420
---- Validation: 
scalar performance:
{'acc': 0.7892272, 'precision': 0.78962594, 'recall': 0.7888633, 'specificity': 0.7888633, 'f1': 0.7889667, 'auroc': 0.8718309, 'binary_precision': 0.7970297, 'binary_recall': 0.76666665, 'binary_specificity': 0.8110599, 'binary_f1_score': 0.7815534}
confusion matrix:
     0    1
0  528  123
1  147  483
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8244445, 'precision': 0.82475877, 'recall': 0.8244444, 'specificity': 0.8244444, 'f1': 0.824402, 'auroc': 0.9097482, 'binary_precision': 0.8146552, 'binary_recall': 0.84, 'binary_specificity': 0.8088889, 'binary_f1_score': 0.8271334}
confusion matrix:
     0    1
0  182   43
1   36  189
new oracle model saved
early stop counter: 1
val acc:0.7892271876335144, best validation acc: 0.8126463890075684, corresponding to test acc:                         0.8066666722297668 / 0.8244444727897644
after epoch: 6,now: 2024-07-22 21:44:49.577471,epoch time: 0:01:31.229012,used: 0:09:23.150831,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_22_21_35_26_seed_1_22755939
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9625651, 'precision': 0.9625454, 'recall': 0.9626037, 'specificity': 0.9626037, 'f1': 0.9625622, 'auroc': 0.99346745, 'binary_precision': 0.96632123, 'binary_recall': 0.95948553, 'binary_specificity': 0.96572185, 'binary_f1_score': 0.9628912}
confusion matrix:
      0     1
0  1465    52
1    63  1492
---- Validation: 
scalar performance:
{'acc': 0.8095238, 'precision': 0.8202863, 'recall': 0.8110087, 'specificity': 0.8110087, 'f1': 0.80837935, 'auroc': 0.91792595, 'binary_precision': 0.75733334, 'binary_recall': 0.9015873, 'binary_specificity': 0.72043014, 'binary_f1_score': 0.8231884}
confusion matrix:
     0    1
0  469  182
1   62  568
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.81333333, 'precision': 0.81900454, 'recall': 0.81333333, 'specificity': 0.81333333, 'f1': 0.8125, 'auroc': 0.923121, 'binary_precision': 0.7764706, 'binary_recall': 0.88, 'binary_specificity': 0.74666667, 'binary_f1_score': 0.82500005}
confusion matrix:
     0    1
0  168   57
1   27  198
early stop counter: 2
val acc:0.8095238208770752, best validation acc: 0.8126463890075684, corresponding to test acc:                         0.8066666722297668 / 0.8244444727897644
after epoch: 7,now: 2024-07-22 21:46:20.692085,epoch time: 0:01:31.114614,used: 0:10:54.265445,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_22_21_35_26_seed_1_22755939
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9742839, 'precision': 0.9748008, 'recall': 0.97458524, 'specificity': 0.97458524, 'f1': 0.9742831, 'auroc': 0.99577534, 'binary_precision': 0.9946524, 'binary_recall': 0.954458, 'binary_specificity': 0.9947125, 'binary_f1_score': 0.97414076}
confusion matrix:
      0     1
0  1505     8
1    71  1488
---- Validation: 
scalar performance:
{'acc': 0.7876659, 'precision': 0.80333877, 'recall': 0.7857655, 'specificity': 0.7857655, 'f1': 0.7840836, 'auroc': 0.8764148, 'binary_precision': 0.8683128, 'binary_recall': 0.6698413, 'binary_specificity': 0.9016897, 'binary_f1_score': 0.7562724}
confusion matrix:
     0    1
0  587   64
1  208  422
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8466667, 'precision': 0.84915644, 'recall': 0.8466667, 'specificity': 0.8466667, 'f1': 0.84639287, 'auroc': 0.91014326, 'binary_precision': 0.8786408, 'binary_recall': 0.80444443, 'binary_specificity': 0.8888889, 'binary_f1_score': 0.83990717}
confusion matrix:
     0    1
0  200   25
1   44  181
new oracle model saved
early stop counter: 3
val acc:0.7876659035682678, best validation acc: 0.8126463890075684, corresponding to test acc:                         0.8066666722297668 / 0.846666693687439
after epoch: 8,now: 2024-07-22 21:47:54.337422,epoch time: 0:01:33.645337,used: 0:12:27.910782,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_22_21_35_26_seed_1_22755939
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9671224, 'precision': 0.96825266, 'recall': 0.9674597, 'specificity': 0.9674597, 'f1': 0.9671147, 'auroc': 0.9963724, 'binary_precision': 0.9945578, 'binary_recall': 0.94019294, 'binary_specificity': 0.9947264, 'binary_f1_score': 0.96661156}
confusion matrix:
      0     1
0  1509     8
1    93  1462
---- Validation: 
scalar performance:
{'acc': 0.8508977, 'precision': 0.8579444, 'recall': 0.84974396, 'specificity': 0.84974396, 'f1': 0.8498303, 'auroc': 0.9080535, 'binary_precision': 0.9042357, 'binary_recall': 0.77936506, 'binary_specificity': 0.92012286, 'binary_f1_score': 0.83716965}
confusion matrix:
     0    1
0  599   52
1  139  491
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.84444445, 'precision': 0.85249346, 'recall': 0.84444445, 'specificity': 0.84444445, 'f1': 0.84355134, 'auroc': 0.912, 'binary_precision': 0.90575916, 'binary_recall': 0.7688889, 'binary_specificity': 0.92, 'binary_f1_score': 0.8317308}
confusion matrix:
     0    1
0  207   18
1   52  173
better model found
persisted
after epoch: 9,now: 2024-07-22 21:49:25.493902,epoch time: 0:01:31.156480,used: 0:13:59.067262,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_22_21_35_26_seed_1_22755939
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9632161, 'precision': 0.9647132, 'recall': 0.96289235, 'specificity': 0.96289235, 'f1': 0.9631627, 'auroc': 0.9974501, 'binary_precision': 0.9412485, 'binary_recall': 0.9890675, 'binary_specificity': 0.9367172, 'binary_f1_score': 0.9645657}
confusion matrix:
      0     1
0  1421    96
1    17  1538
---- Validation: 
scalar performance:
{'acc': 0.80483997, 'precision': 0.8204708, 'recall': 0.80663085, 'specificity': 0.80663085, 'f1': 0.80302393, 'auroc': 0.9104991, 'binary_precision': 0.74547803, 'binary_recall': 0.915873, 'binary_specificity': 0.69738865, 'binary_f1_score': 0.8219374}
confusion matrix:
     0    1
0  454  197
1   53  577
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7511111, 'precision': 0.79177856, 'recall': 0.7511111, 'specificity': 0.7511111, 'f1': 0.7421256, 'auroc': 0.9153383, 'binary_precision': 0.6828479, 'binary_recall': 0.93777776, 'binary_specificity': 0.5644444, 'binary_f1_score': 0.79026216}
confusion matrix:
     0    1
0  127   98
1   14  211
early stop counter: 1
val acc:0.8048399686813354, best validation acc: 0.8508977293968201, corresponding to test acc:                         0.8444444537162781 / 0.846666693687439
after epoch: 10,now: 2024-07-22 21:50:56.812635,epoch time: 0:01:31.318733,used: 0:15:30.385995,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_22_21_35_26_seed_1_22755939
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9742839, 'precision': 0.97433, 'recall': 0.9742413, 'specificity': 0.9742413, 'f1': 0.97427726, 'auroc': 0.9967896, 'binary_precision': 0.97188497, 'binary_recall': 0.9775064, 'binary_specificity': 0.97097623, 'binary_f1_score': 0.9746876}
confusion matrix:
      0     1
0  1472    44
1    35  1521
---- Validation: 
scalar performance:
{'acc': 0.8446526, 'precision': 0.845461, 'recall': 0.8442396, 'specificity': 0.8442396, 'f1': 0.84441555, 'auroc': 0.9077512, 'binary_precision': 0.858569, 'binary_recall': 0.81904763, 'binary_specificity': 0.8694316, 'binary_f1_score': 0.83834285}
confusion matrix:
     0    1
0  566   85
1  114  516
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8511111, 'precision': 0.8519523, 'recall': 0.8511111, 'specificity': 0.8511111, 'f1': 0.8510221, 'auroc': 0.9169185, 'binary_precision': 0.86915886, 'binary_recall': 0.82666665, 'binary_specificity': 0.8755556, 'binary_f1_score': 0.8473804}
confusion matrix:
     0    1
0  197   28
1   39  186
new oracle model saved
early stop counter: 2
val acc:0.8446525931358337, best validation acc: 0.8508977293968201, corresponding to test acc:                         0.8444444537162781 / 0.851111114025116
after epoch: 11,now: 2024-07-22 21:52:32.472665,epoch time: 0:01:35.660030,used: 0:17:06.046025,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_22_21_35_26_seed_1_22755939
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.97005206, 'precision': 0.97019494, 'recall': 0.96997166, 'specificity': 0.96997166, 'f1': 0.9700421, 'auroc': 0.9966028, 'binary_precision': 0.96442187, 'binary_recall': 0.976834, 'binary_specificity': 0.9631094, 'binary_f1_score': 0.97058827}
confusion matrix:
      0     1
0  1462    56
1    36  1518
---- Validation: 
scalar performance:
{'acc': 0.8399688, 'precision': 0.8442856, 'recall': 0.8408858, 'specificity': 0.8408858, 'f1': 0.83968383, 'auroc': 0.92493844, 'binary_precision': 0.8014184, 'binary_recall': 0.8968254, 'binary_specificity': 0.78494626, 'binary_f1_score': 0.84644186}
confusion matrix:
     0    1
0  511  140
1   65  565
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8066667, 'precision': 0.81340843, 'recall': 0.8066667, 'specificity': 0.8066667, 'f1': 0.8056214, 'auroc': 0.91468644, 'binary_precision': 0.76744187, 'binary_recall': 0.88, 'binary_specificity': 0.73333335, 'binary_f1_score': 0.8198758}
confusion matrix:
     0    1
0  165   60
1   27  198
early stop counter: 3
val acc:0.8399688005447388, best validation acc: 0.8508977293968201, corresponding to test acc:                         0.8444444537162781 / 0.851111114025116
after epoch: 12,now: 2024-07-22 21:54:03.364607,epoch time: 0:01:30.891942,used: 0:18:36.937967,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_22_21_35_26_seed_1_22755939
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.95670575, 'precision': 0.9594579, 'recall': 0.9572718, 'specificity': 0.9572718, 'f1': 0.95667094, 'auroc': 0.99664116, 'binary_precision': 0.9985994, 'binary_recall': 0.9158638, 'binary_specificity': 0.9986799, 'binary_f1_score': 0.9554438}
confusion matrix:
      0     1
0  1513     2
1   131  1426
---- Validation: 
scalar performance:
{'acc': 0.7798595, 'precision': 0.82221055, 'recall': 0.7768561, 'specificity': 0.7768561, 'f1': 0.7710703, 'auroc': 0.9031087, 'binary_precision': 0.935, 'binary_recall': 0.5936508, 'binary_specificity': 0.96006143, 'binary_f1_score': 0.7262137}
confusion matrix:
     0    1
0  625   26
1  256  374
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8088889, 'precision': 0.8463532, 'recall': 0.8088889, 'specificity': 0.8088889, 'f1': 0.8035773, 'auroc': 0.89993083, 'binary_precision': 0.9602649, 'binary_recall': 0.64444447, 'binary_specificity': 0.97333336, 'binary_f1_score': 0.7712766}
confusion matrix:
     0    1
0  219    6
1   80  145
early stop counter: 4
val acc:0.7798594832420349, best validation acc: 0.8508977293968201, corresponding to test acc:                         0.8444444537162781 / 0.851111114025116
after epoch: 13,now: 2024-07-22 21:55:34.921261,epoch time: 0:01:31.556654,used: 0:20:08.494621,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_22_21_35_26_seed_1_22755939
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9625651, 'precision': 0.962589, 'recall': 0.96264774, 'specificity': 0.96264774, 'f1': 0.96256447, 'auroc': 0.99423265, 'binary_precision': 0.96995425, 'binary_recall': 0.9555985, 'binary_specificity': 0.969697, 'binary_f1_score': 0.96272284}
confusion matrix:
      0     1
0  1472    46
1    69  1485
---- Validation: 
scalar performance:
{'acc': 0.8087432, 'precision': 0.8337923, 'recall': 0.8064772, 'specificity': 0.8064772, 'f1': 0.8042537, 'auroc': 0.9055836, 'binary_precision': 0.92122537, 'binary_recall': 0.66825396, 'binary_specificity': 0.9447005, 'binary_f1_score': 0.774609}
confusion matrix:
     0    1
0  615   36
1  209  421
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.85333335, 'precision': 0.8749293, 'recall': 0.85333335, 'specificity': 0.85333335, 'f1': 0.8511905, 'auroc': 0.930153, 'binary_precision': 0.9649123, 'binary_recall': 0.73333335, 'binary_specificity': 0.97333336, 'binary_f1_score': 0.8333334}
confusion matrix:
     0    1
0  219    6
1   60  165
new oracle model saved
early stop counter: 5
val acc:0.8087431788444519, best validation acc: 0.8508977293968201, corresponding to test acc:                         0.8444444537162781 / 0.8533333539962769
after epoch: 14,now: 2024-07-22 21:57:08.435436,epoch time: 0:01:33.514175,used: 0:21:42.008796,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_22_21_35_26_seed_1_22755939
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9423828, 'precision': 0.94767815, 'recall': 0.94173366, 'specificity': 0.94173366, 'f1': 0.94214493, 'auroc': 0.9966214, 'binary_precision': 0.9019837, 'binary_recall': 0.9942122, 'binary_specificity': 0.8892551, 'binary_f1_score': 0.945855}
confusion matrix:
      0     1
0  1349   168
1     9  1546
---- Validation: 
scalar performance:
{'acc': 0.8290398, 'precision': 0.8356646, 'recall': 0.83018434, 'specificity': 0.83018434, 'f1': 0.828498, 'auroc': 0.9071562, 'binary_precision': 0.7842324, 'binary_recall': 0.9, 'binary_specificity': 0.76036865, 'binary_f1_score': 0.83813745}
confusion matrix:
     0    1
0  495  156
1   63  567
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.81777775, 'precision': 0.8372005, 'recall': 0.81777775, 'specificity': 0.81777775, 'f1': 0.8151154, 'auroc': 0.9299358, 'binary_precision': 0.7562724, 'binary_recall': 0.93777776, 'binary_specificity': 0.69777775, 'binary_f1_score': 0.83730155}
confusion matrix:
     0    1
0  157   68
1   14  211
early stop counter: 6
val acc:0.8290398120880127, best validation acc: 0.8508977293968201, corresponding to test acc:                         0.8444444537162781 / 0.8533333539962769
after epoch: 15,now: 2024-07-22 21:58:39.950621,epoch time: 0:01:31.515185,used: 0:23:13.523981,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_22_21_35_26_seed_1_22755939
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.98339844, 'precision': 0.98347247, 'recall': 0.98335254, 'specificity': 0.98335254, 'f1': 0.98339486, 'auroc': 0.9982997, 'binary_precision': 0.9795527, 'binary_recall': 0.98775774, 'binary_specificity': 0.97894734, 'binary_f1_score': 0.9836381}
confusion matrix:
      0     1
0  1488    32
1    19  1533
---- Validation: 
scalar performance:
{'acc': 0.8360656, 'precision': 0.8390671, 'recall': 0.8352791, 'specificity': 0.8352791, 'f1': 0.8354397, 'auroc': 0.9086168, 'binary_precision': 0.86713284, 'binary_recall': 0.7873016, 'binary_specificity': 0.88325655, 'binary_f1_score': 0.8252912}
confusion matrix:
     0    1
0  575   76
1  134  496
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.84444445, 'precision': 0.84488046, 'recall': 0.8444444, 'specificity': 0.8444444, 'f1': 0.8443953, 'auroc': 0.91678023, 'binary_precision': 0.85714287, 'binary_recall': 0.82666665, 'binary_specificity': 0.8622222, 'binary_f1_score': 0.84162897}
confusion matrix:
     0    1
0  194   31
1   39  186
early stop counter: 7
val acc:0.8360655903816223, best validation acc: 0.8508977293968201, corresponding to test acc:                         0.8444444537162781 / 0.8533333539962769
after epoch: 16,now: 2024-07-22 22:00:11.444913,epoch time: 0:01:31.494292,used: 0:24:45.018273,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_22_21_35_26_seed_1_22755939
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9866536, 'precision': 0.9866536, 'recall': 0.98674464, 'specificity': 0.98674464, 'f1': 0.98665303, 'auroc': 0.9987714, 'binary_precision': 0.99348956, 'binary_recall': 0.9800899, 'binary_specificity': 0.9933993, 'binary_f1_score': 0.9867443}
confusion matrix:
      0     1
0  1505    10
1    31  1526
---- Validation: 
scalar performance:
{'acc': 0.8126464, 'precision': 0.81661755, 'recall': 0.8116999, 'specificity': 0.8116999, 'f1': 0.81169605, 'auroc': 0.88794285, 'binary_precision': 0.84821427, 'binary_recall': 0.75396824, 'binary_specificity': 0.8694316, 'binary_f1_score': 0.7983193}
confusion matrix:
     0    1
0  566   85
1  155  475
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.80444443, 'precision': 0.80504704, 'recall': 0.80444443, 'specificity': 0.80444443, 'f1': 0.8043479, 'auroc': 0.8884148, 'binary_precision': 0.81860465, 'binary_recall': 0.7822222, 'binary_specificity': 0.82666665, 'binary_f1_score': 0.8}
confusion matrix:
     0    1
0  186   39
1   49  176
early stop counter: 8
val acc:0.8126463890075684, best validation acc: 0.8508977293968201, corresponding to test acc:                         0.8444444537162781 / 0.8533333539962769
after epoch: 17,now: 2024-07-22 22:01:47.789541,epoch time: 0:01:36.344628,used: 0:26:21.362901,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_22_21_35_26_seed_1_22755939
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9866536, 'precision': 0.9866934, 'recall': 0.98676586, 'specificity': 0.98676586, 'f1': 0.9866534, 'auroc': 0.9991094, 'binary_precision': 0.9954218, 'binary_recall': 0.9781491, 'binary_specificity': 0.9953826, 'binary_f1_score': 0.9867099}
confusion matrix:
      0     1
0  1509     7
1    34  1522
---- Validation: 
scalar performance:
{'acc': 0.8446526, 'precision': 0.85034806, 'recall': 0.84359956, 'specificity': 0.84359956, 'f1': 0.84370005, 'auroc': 0.90824866, 'binary_precision': 0.8911071, 'binary_recall': 0.77936506, 'binary_specificity': 0.9078341, 'binary_f1_score': 0.8314987}
confusion matrix:
     0    1
0  591   60
1  139  491
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.82, 'precision': 0.8254057, 'recall': 0.82, 'specificity': 0.82, 'f1': 0.81924933, 'auroc': 0.88851357, 'binary_precision': 0.86734694, 'binary_recall': 0.75555557, 'binary_specificity': 0.8844444, 'binary_f1_score': 0.807601}
confusion matrix:
     0    1
0  199   26
1   55  170
early stop counter: 9
val acc:0.8446525931358337, best validation acc: 0.8508977293968201, corresponding to test acc:                         0.8444444537162781 / 0.8533333539962769
after epoch: 18,now: 2024-07-22 22:03:18.748497,epoch time: 0:01:30.958956,used: 0:27:52.321857,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_22_21_35_26_seed_1_22755939
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9840495, 'precision': 0.98439527, 'recall': 0.98391414, 'specificity': 0.98391414, 'f1': 0.984041, 'auroc': 0.99947894, 'binary_precision': 0.97418135, 'binary_recall': 0.9948553, 'binary_specificity': 0.972973, 'binary_f1_score': 0.98440987}
confusion matrix:
      0     1
0  1476    41
1     8  1547
---- Validation: 
scalar performance:
{'acc': 0.8227947, 'precision': 0.8244597, 'recall': 0.8233743, 'specificity': 0.8233743, 'f1': 0.8227099, 'auroc': 0.89990246, 'binary_precision': 0.79675996, 'binary_recall': 0.85873014, 'binary_specificity': 0.7880184, 'binary_f1_score': 0.8265851}
confusion matrix:
     0    1
0  513  138
1   89  541
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7977778, 'precision': 0.8080051, 'recall': 0.7977778, 'specificity': 0.7977778, 'f1': 0.79608506, 'auroc': 0.9110321, 'binary_precision': 0.7518797, 'binary_recall': 0.8888889, 'binary_specificity': 0.70666665, 'binary_f1_score': 0.814664}
confusion matrix:
     0    1
0  159   66
1   25  200
early stop counter: 10
val acc:0.8227946758270264, best validation acc: 0.8508977293968201, corresponding to test acc:                         0.8444444537162781 / 0.8533333539962769
after epoch: 19,now: 2024-07-22 22:04:49.856455,epoch time: 0:01:31.107958,used: 0:29:23.429815,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_22_21_35_26_seed_1_22755939
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.976888, 'precision': 0.97732073, 'recall': 0.97674465, 'specificity': 0.97674465, 'f1': 0.97687495, 'auroc': 0.99785507, 'binary_precision': 0.96545225, 'binary_recall': 0.98969734, 'binary_specificity': 0.96379197, 'binary_f1_score': 0.97742444}
confusion matrix:
      0     1
0  1464    55
1    16  1537
---- Validation: 
scalar performance:
{'acc': 0.84387195, 'precision': 0.8452308, 'recall': 0.84334356, 'specificity': 0.84334356, 'f1': 0.8435401, 'auroc': 0.90731233, 'binary_precision': 0.8631757, 'binary_recall': 0.8111111, 'binary_specificity': 0.875576, 'binary_f1_score': 0.8363338}
confusion matrix:
     0    1
0  570   81
1  119  511
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8066667, 'precision': 0.8093616, 'recall': 0.8066667, 'specificity': 0.8066667, 'f1': 0.80624473, 'auroc': 0.87644446, 'binary_precision': 0.8382353, 'binary_recall': 0.76, 'binary_specificity': 0.85333335, 'binary_f1_score': 0.7972028}
confusion matrix:
     0    1
0  192   33
1   54  171
early stop counter: 11
val acc:0.8438719511032104, best validation acc: 0.8508977293968201, corresponding to test acc:                         0.8444444537162781 / 0.8533333539962769
after epoch: 20,now: 2024-07-22 22:06:23.993492,epoch time: 0:01:34.137037,used: 0:30:57.566852,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_22_21_35_26_seed_1_22755939
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.984375, 'precision': 0.9844657, 'recall': 0.98431623, 'specificity': 0.98431623, 'f1': 0.98437047, 'auroc': 0.9991602, 'binary_precision': 0.9802422, 'binary_recall': 0.9890675, 'binary_specificity': 0.9795649, 'binary_f1_score': 0.98463506}
confusion matrix:
      0     1
0  1486    31
1    17  1538
---- Validation: 
scalar performance:
{'acc': 0.85323966, 'precision': 0.8539219, 'recall': 0.85286736, 'specificity': 0.85286736, 'f1': 0.85304177, 'auroc': 0.92036915, 'binary_precision': 0.865894, 'binary_recall': 0.8301587, 'binary_specificity': 0.875576, 'binary_f1_score': 0.8476499}
confusion matrix:
     0    1
0  570   81
1  107  523
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8288889, 'precision': 0.833, 'recall': 0.8288889, 'specificity': 0.8288889, 'f1': 0.8283591, 'auroc': 0.910637, 'binary_precision': 0.87, 'binary_recall': 0.7733333, 'binary_specificity': 0.8844444, 'binary_f1_score': 0.8188235}
confusion matrix:
     0    1
0  199   26
1   51  174
better model found
persisted
after epoch: 21,now: 2024-07-22 22:07:55.412244,epoch time: 0:01:31.418752,used: 0:32:28.985604,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_22_21_35_26_seed_1_22755939
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9889323, 'precision': 0.988917, 'recall': 0.98901397, 'specificity': 0.98901397, 'f1': 0.9889315, 'auroc': 0.99937546, 'binary_precision': 0.9948052, 'binary_recall': 0.98331195, 'binary_specificity': 0.994716, 'binary_f1_score': 0.9890251}
confusion matrix:
      0     1
0  1506     8
1    26  1532
---- Validation: 
scalar performance:
{'acc': 0.8657299, 'precision': 0.8743577, 'recall': 0.8644905, 'specificity': 0.8644905, 'f1': 0.86463904, 'auroc': 0.91909397, 'binary_precision': 0.9272388, 'binary_recall': 0.7888889, 'binary_specificity': 0.94009215, 'binary_f1_score': 0.8524872}
confusion matrix:
     0    1
0  612   39
1  133  497
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.82666665, 'precision': 0.8318051, 'recall': 0.8266667, 'specificity': 0.8266667, 'f1': 0.825993, 'auroc': 0.9022025, 'binary_precision': 0.87309647, 'binary_recall': 0.7644445, 'binary_specificity': 0.8888889, 'binary_f1_score': 0.8151659}
confusion matrix:
     0    1
0  200   25
1   53  172
better model found
persisted
after epoch: 22,now: 2024-07-22 22:09:26.929540,epoch time: 0:01:31.517296,used: 0:34:00.502900,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_22_21_35_26_seed_1_22755939
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.97005206, 'precision': 0.9712018, 'recall': 0.9704116, 'specificity': 0.9704116, 'f1': 0.9700453, 'auroc': 0.9969443, 'binary_precision': 0.9979592, 'binary_recall': 0.9428021, 'binary_specificity': 0.9980211, 'binary_f1_score': 0.9695968}
confusion matrix:
      0     1
0  1513     3
1    89  1467
---- Validation: 
scalar performance:
{'acc': 0.6518345, 'precision': 0.7365088, 'recall': 0.64682543, 'specificity': 0.64682543, 'f1': 0.6131681, 'auroc': 0.83862925, 'binary_precision': 0.87398374, 'binary_recall': 0.34126985, 'binary_specificity': 0.95238096, 'binary_f1_score': 0.49086758}
confusion matrix:
     0    1
0  620   31
1  415  215
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.66, 'precision': 0.75426924, 'recall': 0.66, 'specificity': 0.66, 'f1': 0.6252674, 'auroc': 0.9014716, 'binary_precision': 0.90909094, 'binary_recall': 0.35555556, 'binary_specificity': 0.96444446, 'binary_f1_score': 0.5111821}
confusion matrix:
     0   1
0  217   8
1  145  80
early stop counter: 1
val acc:0.6518344879150391, best validation acc: 0.8657299280166626, corresponding to test acc:                         0.8266666531562805 / 0.8533333539962769
after epoch: 23,now: 2024-07-22 22:10:59.665435,epoch time: 0:01:32.735895,used: 0:35:33.238795,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_22_21_35_26_seed_1_22755939
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9860026, 'precision': 0.98612463, 'recall': 0.985932, 'specificity': 0.985932, 'f1': 0.9859981, 'auroc': 0.99933577, 'binary_precision': 0.980916, 'binary_recall': 0.99163985, 'binary_specificity': 0.98022413, 'binary_f1_score': 0.9862488}
confusion matrix:
      0     1
0  1487    30
1    13  1542
---- Validation: 
scalar performance:
{'acc': 0.85714287, 'precision': 0.85727024, 'recall': 0.85696363, 'specificity': 0.85696363, 'f1': 0.85705364, 'auroc': 0.91499037, 'binary_precision': 0.8610662, 'binary_recall': 0.8460317, 'binary_specificity': 0.86789554, 'binary_f1_score': 0.8534827}
confusion matrix:
     0    1
0  565   86
1   97  533
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.79333335, 'precision': 0.7982886, 'recall': 0.7933333, 'specificity': 0.7933333, 'f1': 0.7924715, 'auroc': 0.902637, 'binary_precision': 0.7598425, 'binary_recall': 0.8577778, 'binary_specificity': 0.72888887, 'binary_f1_score': 0.80584556}
confusion matrix:
     0    1
0  164   61
1   32  193
early stop counter: 2
val acc:0.8571428656578064, best validation acc: 0.8657299280166626, corresponding to test acc:                         0.8266666531562805 / 0.8533333539962769
after epoch: 24,now: 2024-07-22 22:12:31.734203,epoch time: 0:01:32.068768,used: 0:37:05.307563,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_22_21_35_26_seed_1_22755939
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.9690755, 'precision': 0.97014946, 'recall': 0.96940506, 'specificity': 0.96940506, 'f1': 0.9690689, 'auroc': 0.9984243, 'binary_precision': 0.99592394, 'binary_recall': 0.9427653, 'binary_specificity': 0.9960448, 'binary_f1_score': 0.96861583}
confusion matrix:
      0     1
0  1511     6
1    89  1466
---- Validation: 
scalar performance:
{'acc': 0.7119438, 'precision': 0.7887162, 'recall': 0.7076549, 'specificity': 0.7076549, 'f1': 0.6887052, 'auroc': 0.89891195, 'binary_precision': 0.9335548, 'binary_recall': 0.44603175, 'binary_specificity': 0.96927804, 'binary_f1_score': 0.603652}
confusion matrix:
     0    1
0  631   20
1  349  281
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7222222, 'precision': 0.8085235, 'recall': 0.7222222, 'specificity': 0.7222222, 'f1': 0.7013364, 'auroc': 0.90723956, 'binary_precision': 0.9716981, 'binary_recall': 0.45777777, 'binary_specificity': 0.9866667, 'binary_f1_score': 0.6223565}
confusion matrix:
     0    1
0  222    3
1  122  103
early stop counter: 3
val acc:0.7119438052177429, best validation acc: 0.8657299280166626, corresponding to test acc:                         0.8266666531562805 / 0.8533333539962769
after epoch: 25,now: 2024-07-22 22:14:02.820428,epoch time: 0:01:31.086225,used: 0:38:36.393788,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_22_21_35_26_seed_1_22755939
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9824219, 'precision': 0.9826891, 'recall': 0.98259497, 'specificity': 0.98259497, 'f1': 0.98242164, 'auroc': 0.9991704, 'binary_precision': 0.9973475, 'binary_recall': 0.967825, 'binary_specificity': 0.99736494, 'binary_f1_score': 0.9823645}
confusion matrix:
      0     1
0  1514     4
1    50  1504
---- Validation: 
scalar performance:
{'acc': 0.8345043, 'precision': 0.8552942, 'recall': 0.83251405, 'specificity': 0.83251405, 'f1': 0.8314298, 'auroc': 0.91527563, 'binary_precision': 0.9372385, 'binary_recall': 0.7111111, 'binary_specificity': 0.953917, 'binary_f1_score': 0.80866426}
confusion matrix:
     0    1
0  621   30
1  182  448
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.83555555, 'precision': 0.84766996, 'recall': 0.83555555, 'specificity': 0.83555555, 'f1': 0.8341105, 'auroc': 0.9012543, 'binary_precision': 0.91256833, 'binary_recall': 0.74222225, 'binary_specificity': 0.9288889, 'binary_f1_score': 0.8186275}
confusion matrix:
     0    1
0  209   16
1   58  167
early stop counter: 4
val acc:0.8345043063163757, best validation acc: 0.8657299280166626, corresponding to test acc:                         0.8266666531562805 / 0.8533333539962769
after epoch: 26,now: 2024-07-22 22:15:33.857080,epoch time: 0:01:31.036652,used: 0:40:07.430440,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_22_21_35_26_seed_1_22755939
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.98046875, 'precision': 0.98094076, 'recall': 0.98030466, 'specificity': 0.98030466, 'f1': 0.9804561, 'auroc': 0.9994786, 'binary_precision': 0.968652, 'binary_recall': 0.99356914, 'binary_specificity': 0.9670402, 'binary_f1_score': 0.9809524}
confusion matrix:
      0     1
0  1467    50
1    10  1545
---- Validation: 
scalar performance:
{'acc': 0.86260736, 'precision': 0.86267316, 'recall': 0.862468, 'specificity': 0.862468, 'f1': 0.8625369, 'auroc': 0.9187087, 'binary_precision': 0.8649518, 'binary_recall': 0.85396826, 'binary_specificity': 0.87096775, 'binary_f1_score': 0.85942495}
confusion matrix:
     0    1
0  567   84
1   92  538
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.85333335, 'precision': 0.8537806, 'recall': 0.85333335, 'specificity': 0.85333335, 'f1': 0.853287, 'auroc': 0.918005, 'binary_precision': 0.8412017, 'binary_recall': 0.8711111, 'binary_specificity': 0.83555555, 'binary_f1_score': 0.8558952}
confusion matrix:
     0    1
0  188   37
1   29  196
early stop counter: 5
val acc:0.8626073598861694, best validation acc: 0.8657299280166626, corresponding to test acc:                         0.8266666531562805 / 0.8533333539962769
after epoch: 27,now: 2024-07-22 22:17:09.337619,epoch time: 0:01:35.480539,used: 0:41:42.910979,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_22_21_35_26_seed_1_22755939
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.98502606, 'precision': 0.98500645, 'recall': 0.985064, 'specificity': 0.985064, 'f1': 0.9850248, 'auroc': 0.99881685, 'binary_precision': 0.9883495, 'binary_recall': 0.98199356, 'binary_specificity': 0.9881345, 'binary_f1_score': 0.98516124}
confusion matrix:
      0     1
0  1499    18
1    28  1527
---- Validation: 
scalar performance:
{'acc': 0.81030446, 'precision': 0.8222029, 'recall': 0.80870456, 'specificity': 0.80870456, 'f1': 0.8079445, 'auroc': 0.88589716, 'binary_precision': 0.8801572, 'binary_recall': 0.7111111, 'binary_specificity': 0.906298, 'binary_f1_score': 0.78665495}
confusion matrix:
     0    1
0  590   61
1  182  448
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8466667, 'precision': 0.84821427, 'recall': 0.8466667, 'specificity': 0.8466667, 'f1': 0.8464961, 'auroc': 0.9178271, 'binary_precision': 0.87142855, 'binary_recall': 0.81333333, 'binary_specificity': 0.88, 'binary_f1_score': 0.8413793}
confusion matrix:
     0    1
0  198   27
1   42  183
early stop counter: 6
val acc:0.8103044629096985, best validation acc: 0.8657299280166626, corresponding to test acc:                         0.8266666531562805 / 0.8533333539962769
after epoch: 28,now: 2024-07-22 22:18:40.646383,epoch time: 0:01:31.308764,used: 0:43:14.219743,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_22_21_35_26_seed_1_22755939
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9860026, 'precision': 0.9861736, 'recall': 0.9861495, 'specificity': 0.9861495, 'f1': 0.98600256, 'auroc': 0.99930143, 'binary_precision': 0.9986799, 'binary_recall': 0.9736165, 'binary_specificity': 0.9986825, 'binary_f1_score': 0.9859889}
confusion matrix:
      0     1
0  1516     2
1    41  1513
---- Validation: 
scalar performance:
{'acc': 0.70882124, 'precision': 0.7831096, 'recall': 0.7045571, 'specificity': 0.7045571, 'f1': 0.68561983, 'auroc': 0.87828493, 'binary_precision': 0.9240924, 'binary_recall': 0.44444445, 'binary_specificity': 0.96466976, 'binary_f1_score': 0.60021436}
confusion matrix:
     0    1
0  628   23
1  350  280
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8333333, 'precision': 0.85794586, 'recall': 0.8333334, 'specificity': 0.8333334, 'f1': 0.8304182, 'auroc': 0.8879802, 'binary_precision': 0.9518072, 'binary_recall': 0.7022222, 'binary_specificity': 0.96444446, 'binary_f1_score': 0.8081842}
confusion matrix:
     0    1
0  217    8
1   67  158
early stop counter: 7
val acc:0.7088212370872498, best validation acc: 0.8657299280166626, corresponding to test acc:                         0.8266666531562805 / 0.8533333539962769
after epoch: 29,now: 2024-07-22 22:20:12.178136,epoch time: 0:01:31.531753,used: 0:44:45.751496,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_22_21_35_26_seed_1_22755939
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.9889323, 'precision': 0.98900163, 'recall': 0.9890514, 'specificity': 0.9890514, 'f1': 0.98893225, 'auroc': 0.99963796, 'binary_precision': 0.9986885, 'binary_recall': 0.9794212, 'binary_specificity': 0.9986816, 'binary_f1_score': 0.98896104}
confusion matrix:
      0     1
0  1515     2
1    32  1523
---- Validation: 
scalar performance:
{'acc': 0.76112413, 'precision': 0.8155738, 'recall': 0.7576805, 'specificity': 0.7576805, 'f1': 0.7486844, 'auroc': 0.90461314, 'binary_precision': 0.94262296, 'binary_recall': 0.54761904, 'binary_specificity': 0.9677419, 'binary_f1_score': 0.6927711}
confusion matrix:
     0    1
0  630   21
1  285  345
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8333333, 'precision': 0.8657664, 'recall': 0.8333333, 'specificity': 0.8333333, 'f1': 0.8295549, 'auroc': 0.8924643, 'binary_precision': 0.9746835, 'binary_recall': 0.6844444, 'binary_specificity': 0.9822222, 'binary_f1_score': 0.8041775}
confusion matrix:
     0    1
0  221    4
1   71  154
early stop counter: 8
val acc:0.7611241340637207, best validation acc: 0.8657299280166626, corresponding to test acc:                         0.8266666531562805 / 0.8533333539962769
after epoch: 30,now: 2024-07-22 22:21:46.119440,epoch time: 0:01:33.941304,used: 0:46:19.692800,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_22_21_35_26_seed_1_22755939
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 0:46:19.692800 at 2024-07-22 22:21:46.119440
persisted model performance metric: 

scalar performance:
{'acc': 0.82666665, 'precision': 0.8318051, 'recall': 0.8266667, 'specificity': 0.8266667, 'f1': 0.825993, 'auroc': 0.9022025, 'binary_precision': 0.87309647, 'binary_recall': 0.7644445, 'binary_specificity': 0.8888889, 'binary_f1_score': 0.8151659}
confusion matrix:
     0    1
0  200   25
1   53  172
oracle model performance metric: 

scalar performance:
{'acc': 0.85333335, 'precision': 0.8749293, 'recall': 0.85333335, 'specificity': 0.85333335, 'f1': 0.8511905, 'auroc': 0.930153, 'binary_precision': 0.9649123, 'binary_recall': 0.73333335, 'binary_specificity': 0.97333336, 'binary_f1_score': 0.8333334}
confusion matrix:
     0    1
0  219    6
1   60  165
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_higherregularization_irm_dial_lr1e5_bs16_nofreeze_2024-07-22_16-00-54/rule_results/1.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_higherregularization_irm_dial_lr1e5_bs16_nofreeze_2024-07-22_16-00-54/confusion_matrix/1.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 455402 KiB |  13219 MiB | 149715 GiB | 149715 GiB |
|       from large pool | 414803 KiB |  13181 MiB | 147928 GiB | 147928 GiB |
|       from small pool |  40598 KiB |     60 MiB |   1786 GiB |   1786 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 455402 KiB |  13219 MiB | 149715 GiB | 149715 GiB |
|       from large pool | 414803 KiB |  13181 MiB | 147928 GiB | 147928 GiB |
|       from small pool |  40598 KiB |     60 MiB |   1786 GiB |   1786 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 447481 KiB |  13213 MiB | 149150 GiB | 149149 GiB |
|       from large pool | 407075 KiB |  13175 MiB | 147367 GiB | 147366 GiB |
|       from small pool |  40406 KiB |     60 MiB |   1783 GiB |   1783 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  14482 MiB |  14482 MiB |  28048 MiB |  13566 MiB |
|       from large pool |  14412 MiB |  14412 MiB |  27960 MiB |  13548 MiB |
|       from small pool |     70 MiB |     70 MiB |     88 MiB |     18 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 445718 KiB |   1238 MiB | 105307 GiB | 105307 GiB |
|       from large pool | 435116 KiB |   1229 MiB | 103511 GiB | 103511 GiB |
|       from small pool |  10601 KiB |     42 MiB |   1796 GiB |   1796 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    1310    |    2598    |   26313 K  |   26312 K  |
|       from large pool |     187    |    1413    |   13437 K  |   13436 K  |
|       from small pool |    1123    |    1419    |   12876 K  |   12875 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    1310    |    2598    |   26313 K  |   26312 K  |
|       from large pool |     187    |    1413    |   13437 K  |   13436 K  |
|       from small pool |    1123    |    1419    |   12876 K  |   12875 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     637    |     637    |    1209    |     572    |
|       from large pool |     602    |     602    |    1165    |     563    |
|       from small pool |      35    |      35    |      44    |       9    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      96    |     652    |   18312 K  |   18312 K  |
|       from large pool |      38    |     605    |   10604 K  |   10604 K  |
|       from small pool |      58    |     234    |    7707 K  |    7707 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13219 MiB | 149715 GiB | 149715 GiB |
|       from large pool |  16640 KiB |  13181 MiB | 147928 GiB | 147928 GiB |
|       from small pool |      0 KiB |     60 MiB |   1786 GiB |   1786 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13219 MiB | 149715 GiB | 149715 GiB |
|       from large pool |  16640 KiB |  13181 MiB | 147928 GiB | 147928 GiB |
|       from small pool |      0 KiB |     60 MiB |   1786 GiB |   1786 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13213 MiB | 149150 GiB | 149150 GiB |
|       from large pool |  16640 KiB |  13175 MiB | 147367 GiB | 147367 GiB |
|       from small pool |      0 KiB |     60 MiB |   1783 GiB |   1783 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    880 MiB |  14482 MiB |  28048 MiB |  27168 MiB |
|       from large pool |    830 MiB |  14412 MiB |  27960 MiB |  27130 MiB |
|       from small pool |     50 MiB |     70 MiB |     88 MiB |     38 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1238 MiB | 105308 GiB | 105308 GiB |
|       from large pool |  24320 KiB |   1229 MiB | 103511 GiB | 103511 GiB |
|       from small pool |      0 KiB |     42 MiB |   1796 GiB |   1796 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    2598    |   26313 K  |   26313 K  |
|       from large pool |       2    |    1413    |   13437 K  |   13437 K  |
|       from small pool |       0    |    1419    |   12876 K  |   12876 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    2598    |   26313 K  |   26313 K  |
|       from large pool |       2    |    1413    |   13437 K  |   13437 K  |
|       from small pool |       0    |    1419    |   12876 K  |   12876 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      62    |     637    |    1209    |    1147    |
|       from large pool |      37    |     602    |    1165    |    1128    |
|       from small pool |      25    |      35    |      44    |      19    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |     652    |   18312 K  |   18312 K  |
|       from large pool |       4    |     605    |   10604 K  |   10604 K  |
|       from small pool |       0    |     234    |    7708 K  |    7708 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13219 MiB | 149715 GiB | 149715 GiB |
|       from large pool |  16640 KiB |  13181 MiB | 147928 GiB | 147928 GiB |
|       from small pool |      0 KiB |     60 MiB |   1786 GiB |   1786 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13219 MiB | 149715 GiB | 149715 GiB |
|       from large pool |  16640 KiB |  13181 MiB | 147928 GiB | 147928 GiB |
|       from small pool |      0 KiB |     60 MiB |   1786 GiB |   1786 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13213 MiB | 149150 GiB | 149150 GiB |
|       from large pool |  16640 KiB |  13175 MiB | 147367 GiB | 147367 GiB |
|       from small pool |      0 KiB |     60 MiB |   1783 GiB |   1783 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    880 MiB |  14482 MiB |  28048 MiB |  27168 MiB |
|       from large pool |    830 MiB |  14412 MiB |  27960 MiB |  27130 MiB |
|       from small pool |     50 MiB |     70 MiB |     88 MiB |     38 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1238 MiB | 105308 GiB | 105308 GiB |
|       from large pool |  24320 KiB |   1229 MiB | 103511 GiB | 103511 GiB |
|       from small pool |      0 KiB |     42 MiB |   1796 GiB |   1796 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    2598    |   26313 K  |   26313 K  |
|       from large pool |       2    |    1413    |   13437 K  |   13437 K  |
|       from small pool |       0    |    1419    |   12876 K  |   12876 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    2598    |   26313 K  |   26313 K  |
|       from large pool |       2    |    1413    |   13437 K  |   13437 K  |
|       from small pool |       0    |    1419    |   12876 K  |   12876 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      62    |     637    |    1209    |    1147    |
|       from large pool |      37    |     602    |    1165    |    1128    |
|       from small pool |      25    |      35    |      44    |      19    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |     652    |   18312 K  |   18312 K  |
|       from large pool |       4    |     605    |   10604 K  |   10604 K  |
|       from small pool |       0    |     234    |    7708 K  |    7708 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'888c1ef2'
model name: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_22_22_23_08_seed_2_22755939

 Experiment start at: 2024-07-22 22:23:08.441629
before training, model accuracy: 0.41203704476356506
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.88645285, 'precision': 0.9063728, 'recall': 0.8873274, 'specificity': 0.8873274, 'f1': 0.88520205, 'auroc': 0.9514786, 'binary_precision': 0.99832916, 'binary_recall': 0.77597404, 'binary_specificity': 0.9986807, 'binary_f1_score': 0.8732189}
confusion matrix:
      0     1
0  1514     2
1   345  1195
---- Validation: 
scalar performance:
{'acc': 0.5164319, 'precision': 0.5388744, 'recall': 0.5037987, 'specificity': 0.5037987, 'f1': 0.36506236, 'auroc': 0.79124427, 'binary_precision': 0.5625, 'binary_recall': 0.028938906, 'binary_specificity': 0.97865856, 'binary_f1_score': 0.055045873}
confusion matrix:
     0   1
0  642  14
1  604  18
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5185185, 'precision': 0.6298077, 'recall': 0.5185185, 'specificity': 0.5185185, 'f1': 0.38716716, 'auroc': 0.81155694, 'binary_precision': 0.75, 'binary_recall': 0.055555556, 'binary_specificity': 0.9814815, 'binary_f1_score': 0.10344828}
confusion matrix:
     0   1
0  212   4
1  204  12
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-22 22:24:49.958822,epoch time: 0:01:41.517193,used: 0:01:41.517193,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_22_22_23_08_seed_2_22755939
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9263743, 'precision': 0.92742217, 'recall': 0.92618734, 'specificity': 0.92618734, 'f1': 0.9263031, 'auroc': 0.98200625, 'binary_precision': 0.9081316, 'binary_recall': 0.95, 'binary_specificity': 0.9023747, 'binary_f1_score': 0.92859405}
confusion matrix:
      0     1
0  1368   148
1    77  1463
---- Validation: 
scalar performance:
{'acc': 0.7425665, 'precision': 0.78111863, 'recall': 0.747363, 'specificity': 0.747363, 'f1': 0.7357677, 'auroc': 0.85694504, 'binary_precision': 0.670151, 'binary_recall': 0.9276527, 'binary_specificity': 0.56707317, 'binary_f1_score': 0.7781524}
confusion matrix:
     0    1
0  372  284
1   45  577
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.75, 'precision': 0.7793371, 'recall': 0.75, 'specificity': 0.75, 'f1': 0.74325895, 'auroc': 0.87414265, 'binary_precision': 0.6888112, 'binary_recall': 0.912037, 'binary_specificity': 0.587963, 'binary_f1_score': 0.7848605}
confusion matrix:
     0    1
0  127   89
1   19  197
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-07-22 22:26:21.266203,epoch time: 0:01:31.307381,used: 0:03:12.824574,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_22_22_23_08_seed_2_22755939
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.93095547, 'precision': 0.935146, 'recall': 0.9305786, 'specificity': 0.9305786, 'f1': 0.9307437, 'auroc': 0.9896258, 'binary_precision': 0.89436203, 'binary_recall': 0.9785714, 'binary_specificity': 0.88258576, 'binary_f1_score': 0.93457365}
confusion matrix:
      0     1
0  1338   178
1    33  1507
---- Validation: 
scalar performance:
{'acc': 0.75665104, 'precision': 0.7794655, 'recall': 0.7603325, 'specificity': 0.7603325, 'f1': 0.7532058, 'auroc': 0.8436128, 'binary_precision': 0.69268894, 'binary_recall': 0.8987138, 'binary_specificity': 0.6219512, 'binary_f1_score': 0.7823653}
confusion matrix:
     0    1
0  408  248
1   63  559
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7685185, 'precision': 0.7926282, 'recall': 0.7685185, 'specificity': 0.7685185, 'f1': 0.7636503, 'auroc': 0.8840449, 'binary_precision': 0.70863307, 'binary_recall': 0.912037, 'binary_specificity': 0.625, 'binary_f1_score': 0.7975708}
confusion matrix:
     0    1
0  135   81
1   19  197
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-07-22 22:27:50.364272,epoch time: 0:01:29.098069,used: 0:04:41.922643,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_22_22_23_08_seed_2_22755939
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9554974, 'precision': 0.9555143, 'recall': 0.95547926, 'specificity': 0.95547926, 'f1': 0.9554931, 'auroc': 0.9913546, 'binary_precision': 0.95407504, 'binary_recall': 0.9577922, 'binary_specificity': 0.95316625, 'binary_f1_score': 0.95593005}
confusion matrix:
      0     1
0  1445    71
1    65  1475
---- Validation: 
scalar performance:
{'acc': 0.81298906, 'precision': 0.82157, 'recall': 0.81512725, 'specificity': 0.81512725, 'f1': 0.81234276, 'auroc': 0.90295553, 'binary_precision': 0.7619699, 'binary_recall': 0.8954984, 'binary_specificity': 0.7347561, 'binary_f1_score': 0.8233555}
confusion matrix:
     0    1
0  482  174
1   65  557
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7800926, 'precision': 0.7995118, 'recall': 0.7800926, 'specificity': 0.7800926, 'f1': 0.77646935, 'auroc': 0.91615224, 'binary_precision': 0.72324723, 'binary_recall': 0.9074074, 'binary_specificity': 0.6527778, 'binary_f1_score': 0.8049281}
confusion matrix:
     0    1
0  141   75
1   20  196
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-07-22 22:29:20.277150,epoch time: 0:01:29.912878,used: 0:06:11.835521,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_22_22_23_08_seed_2_22755939
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9545157, 'precision': 0.95749867, 'recall': 0.9548444, 'specificity': 0.9548444, 'f1': 0.95446193, 'auroc': 0.99239373, 'binary_precision': 0.9964564, 'binary_recall': 0.912987, 'binary_specificity': 0.99670184, 'binary_f1_score': 0.9528973}
confusion matrix:
      0     1
0  1511     5
1   134  1406
---- Validation: 
scalar performance:
{'acc': 0.69483566, 'precision': 0.77112675, 'recall': 0.68757844, 'specificity': 0.68757844, 'f1': 0.6665864, 'auroc': 0.86408174, 'binary_precision': 0.9084507, 'binary_recall': 0.414791, 'binary_specificity': 0.96036583, 'binary_f1_score': 0.5695364}
confusion matrix:
     0    1
0  630   26
1  364  258
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7824074, 'precision': 0.8177084, 'recall': 0.7824074, 'specificity': 0.7824074, 'f1': 0.7761905, 'auroc': 0.8931112, 'binary_precision': 0.9236111, 'binary_recall': 0.6157407, 'binary_specificity': 0.9490741, 'binary_f1_score': 0.73888886}
confusion matrix:
     0    1
0  205   11
1   83  133
new oracle model saved
early stop counter: 1
val acc:0.6948356628417969, best validation acc: 0.8129890561103821, corresponding to test acc:                         0.7800925970077515 / 0.7824074029922485
after epoch: 5,now: 2024-07-22 22:30:52.474050,epoch time: 0:01:32.196900,used: 0:07:44.032421,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_22_22_23_08_seed_2_22755939
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.960733, 'precision': 0.9629729, 'recall': 0.96101844, 'specificity': 0.96101844, 'f1': 0.9607004, 'auroc': 0.9921311, 'binary_precision': 0.9971989, 'binary_recall': 0.92467535, 'binary_specificity': 0.9973615, 'binary_f1_score': 0.95956874}
confusion matrix:
      0     1
0  1512     4
1   116  1424
---- Validation: 
scalar performance:
{'acc': 0.7777778, 'precision': 0.7846017, 'recall': 0.77557886, 'specificity': 0.77557886, 'f1': 0.7753815, 'auroc': 0.84676933, 'binary_precision': 0.82251906, 'binary_recall': 0.69292605, 'binary_specificity': 0.8582317, 'binary_f1_score': 0.7521815}
confusion matrix:
     0    1
0  563   93
1  191  431
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8055556, 'precision': 0.8057915, 'recall': 0.8055556, 'specificity': 0.8055556, 'f1': 0.80551803, 'auroc': 0.8737997, 'binary_precision': 0.8142857, 'binary_recall': 0.7916667, 'binary_specificity': 0.8194444, 'binary_f1_score': 0.80281687}
confusion matrix:
     0    1
0  177   39
1   45  171
new oracle model saved
early stop counter: 2
val acc:0.7777777910232544, best validation acc: 0.8129890561103821, corresponding to test acc:                         0.7800925970077515 / 0.8055555820465088
after epoch: 6,now: 2024-07-22 22:32:21.296475,epoch time: 0:01:28.822425,used: 0:09:12.854846,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_22_22_23_08_seed_2_22755939
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9751309, 'precision': 0.9752431, 'recall': 0.97520643, 'specificity': 0.97520643, 'f1': 0.97513074, 'auroc': 0.9969212, 'binary_precision': 0.9847682, 'binary_recall': 0.9655844, 'binary_specificity': 0.9848285, 'binary_f1_score': 0.9750819}
confusion matrix:
      0     1
0  1493    23
1    53  1487
---- Validation: 
scalar performance:
{'acc': 0.85680753, 'precision': 0.85703677, 'recall': 0.8563936, 'specificity': 0.8563936, 'f1': 0.8565967, 'auroc': 0.9095782, 'binary_precision': 0.8616145, 'binary_recall': 0.840836, 'binary_specificity': 0.8719512, 'binary_f1_score': 0.8510985}
confusion matrix:
     0    1
0  572   84
1   99  523
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8287037, 'precision': 0.83281255, 'recall': 0.8287037, 'specificity': 0.8287037, 'f1': 0.8281734, 'auroc': 0.928798, 'binary_precision': 0.79583335, 'binary_recall': 0.8842593, 'binary_specificity': 0.7731481, 'binary_f1_score': 0.8377193}
confusion matrix:
     0    1
0  167   49
1   25  191
new oracle model saved
better model found
persisted
after epoch: 7,now: 2024-07-22 22:33:51.013807,epoch time: 0:01:29.717332,used: 0:10:42.572178,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_22_22_23_08_seed_2_22755939
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9777487, 'precision': 0.9777715, 'recall': 0.9777936, 'specificity': 0.9777936, 'f1': 0.9777486, 'auroc': 0.9975846, 'binary_precision': 0.9835743, 'binary_recall': 0.9720779, 'binary_specificity': 0.98350924, 'binary_f1_score': 0.97779226}
confusion matrix:
      0     1
0  1491    25
1    43  1497
---- Validation: 
scalar performance:
{'acc': 0.8176839, 'precision': 0.817711, 'recall': 0.8173256, 'specificity': 0.8173256, 'f1': 0.81745756, 'auroc': 0.8883078, 'binary_precision': 0.8183306, 'binary_recall': 0.8038585, 'binary_specificity': 0.83079267, 'binary_f1_score': 0.81103003}
confusion matrix:
     0    1
0  545  111
1  122  500
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8148148, 'precision': 0.8218794, 'recall': 0.8148148, 'specificity': 0.8148148, 'f1': 0.8137931, 'auroc': 0.917374, 'binary_precision': 0.7741935, 'binary_recall': 0.8888889, 'binary_specificity': 0.7407407, 'binary_f1_score': 0.82758623}
confusion matrix:
     0    1
0  160   56
1   24  192
early stop counter: 1
val acc:0.8176838755607605, best validation acc: 0.8568075299263, corresponding to test acc:                         0.8287037014961243 / 0.8287037014961243
after epoch: 8,now: 2024-07-22 22:35:22.731107,epoch time: 0:01:31.717300,used: 0:12:14.289478,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_22_22_23_08_seed_2_22755939
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9820026, 'precision': 0.9819962, 'recall': 0.9820092, 'specificity': 0.9820092, 'f1': 0.9820018, 'auroc': 0.9982648, 'binary_precision': 0.9830839, 'binary_recall': 0.9811688, 'binary_specificity': 0.9828496, 'binary_f1_score': 0.9821254}
confusion matrix:
      0     1
0  1490    26
1    29  1511
---- Validation: 
scalar performance:
{'acc': 0.80985916, 'precision': 0.80990386, 'recall': 0.8101203, 'specificity': 0.8101203, 'f1': 0.809833, 'auroc': 0.87376726, 'binary_precision': 0.7956318, 'binary_recall': 0.8199357, 'binary_specificity': 0.8003049, 'binary_f1_score': 0.807601}
confusion matrix:
     0    1
0  525  131
1  112  510
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7453704, 'precision': 0.7942023, 'recall': 0.7453704, 'specificity': 0.7453704, 'f1': 0.73434705, 'auroc': 0.904321, 'binary_precision': 0.6743421, 'binary_recall': 0.9490741, 'binary_specificity': 0.5416667, 'binary_f1_score': 0.7884615}
confusion matrix:
     0    1
0  117   99
1   11  205
early stop counter: 2
val acc:0.8098591566085815, best validation acc: 0.8568075299263, corresponding to test acc:                         0.8287037014961243 / 0.8287037014961243
after epoch: 9,now: 2024-07-22 22:36:52.124937,epoch time: 0:01:29.393830,used: 0:13:43.683308,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_22_22_23_08_seed_2_22755939
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9816754, 'precision': 0.981969, 'recall': 0.9817873, 'specificity': 0.9817873, 'f1': 0.9816747, 'auroc': 0.99890137, 'binary_precision': 0.9959893, 'binary_recall': 0.96753246, 'binary_specificity': 0.9960422, 'binary_f1_score': 0.98155475}
confusion matrix:
      0     1
0  1510     6
1    50  1490
---- Validation: 
scalar performance:
{'acc': 0.8372457, 'precision': 0.84016556, 'recall': 0.83596385, 'specificity': 0.83596385, 'f1': 0.8364345, 'auroc': 0.901944, 'binary_precision': 0.8657244, 'binary_recall': 0.78778136, 'binary_specificity': 0.88414633, 'binary_f1_score': 0.8249158}
confusion matrix:
     0    1
0  580   76
1  132  490
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8263889, 'precision': 0.82673204, 'recall': 0.8263889, 'specificity': 0.8263889, 'f1': 0.8263433, 'auroc': 0.91580933, 'binary_precision': 0.8161435, 'binary_recall': 0.8425926, 'binary_specificity': 0.8101852, 'binary_f1_score': 0.8291572}
confusion matrix:
     0    1
0  175   41
1   34  182
early stop counter: 3
val acc:0.8372457027435303, best validation acc: 0.8568075299263, corresponding to test acc:                         0.8287037014961243 / 0.8287037014961243
after epoch: 10,now: 2024-07-22 22:38:21.906443,epoch time: 0:01:29.781506,used: 0:15:13.464814,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_22_22_23_08_seed_2_22755939
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9777487, 'precision': 0.9777622, 'recall': 0.97778845, 'specificity': 0.97778845, 'f1': 0.9777485, 'auroc': 0.99752164, 'binary_precision': 0.98293966, 'binary_recall': 0.9727273, 'binary_specificity': 0.9828496, 'binary_f1_score': 0.9778068}
confusion matrix:
      0     1
0  1490    26
1    42  1498
---- Validation: 
scalar performance:
{'acc': 0.81533647, 'precision': 0.8170161, 'recall': 0.81628895, 'specificity': 0.81628895, 'f1': 0.81529987, 'auroc': 0.88018584, 'binary_precision': 0.78635013, 'binary_recall': 0.85209006, 'binary_specificity': 0.7804878, 'binary_f1_score': 0.8179013}
confusion matrix:
     0    1
0  512  144
1   92  530
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7523148, 'precision': 0.7936027, 'recall': 0.7523148, 'specificity': 0.7523148, 'f1': 0.7432898, 'auroc': 0.90479255, 'binary_precision': 0.68350166, 'binary_recall': 0.9398148, 'binary_specificity': 0.5648148, 'binary_f1_score': 0.79142296}
confusion matrix:
     0    1
0  122   94
1   13  203
early stop counter: 4
val acc:0.8153364658355713, best validation acc: 0.8568075299263, corresponding to test acc:                         0.8287037014961243 / 0.8287037014961243
after epoch: 11,now: 2024-07-22 22:39:54.780494,epoch time: 0:01:32.874051,used: 0:16:46.338865,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_22_22_23_08_seed_2_22755939
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.976767, 'precision': 0.97690463, 'recall': 0.97671163, 'specificity': 0.97671163, 'f1': 0.97676194, 'auroc': 0.9983753, 'binary_precision': 0.9705317, 'binary_recall': 0.98376626, 'binary_specificity': 0.969657, 'binary_f1_score': 0.9771041}
confusion matrix:
      0     1
0  1470    46
1    25  1515
---- Validation: 
scalar performance:
{'acc': 0.80751175, 'precision': 0.80777335, 'recall': 0.8069588, 'specificity': 0.8069588, 'f1': 0.8071675, 'auroc': 0.86996603, 'binary_precision': 0.81229234, 'binary_recall': 0.78617364, 'binary_specificity': 0.8277439, 'binary_f1_score': 0.7990197}
confusion matrix:
     0    1
0  543  113
1  133  489
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.787037, 'precision': 0.8146616, 'recall': 0.787037, 'specificity': 0.787037, 'f1': 0.78225803, 'auroc': 0.9044496, 'binary_precision': 0.7214286, 'binary_recall': 0.9351852, 'binary_specificity': 0.6388889, 'binary_f1_score': 0.8145161}
confusion matrix:
     0    1
0  138   78
1   14  202
early stop counter: 5
val acc:0.8075117468833923, best validation acc: 0.8568075299263, corresponding to test acc:                         0.8287037014961243 / 0.8287037014961243
after epoch: 12,now: 2024-07-22 22:41:23.775743,epoch time: 0:01:28.995249,used: 0:18:15.334114,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_22_22_23_08_seed_2_22755939
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.98036647, 'precision': 0.9807615, 'recall': 0.9804938, 'specificity': 0.9804938, 'f1': 0.98036504, 'auroc': 0.99835485, 'binary_precision': 0.9966443, 'binary_recall': 0.96428573, 'binary_specificity': 0.99670184, 'binary_f1_score': 0.980198}
confusion matrix:
      0     1
0  1511     5
1    55  1485
---- Validation: 
scalar performance:
{'acc': 0.8239437, 'precision': 0.8321419, 'recall': 0.82179826, 'specificity': 0.82179826, 'f1': 0.8220742, 'auroc': 0.88402134, 'binary_precision': 0.8780952, 'binary_recall': 0.74115753, 'binary_specificity': 0.902439, 'binary_f1_score': 0.8038361}
confusion matrix:
     0    1
0  592   64
1  161  461
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8472222, 'precision': 0.8472222, 'recall': 0.8472222, 'specificity': 0.8472222, 'f1': 0.8472222, 'auroc': 0.92249656, 'binary_precision': 0.8472222, 'binary_recall': 0.8472222, 'binary_specificity': 0.8472222, 'binary_f1_score': 0.8472222}
confusion matrix:
     0    1
0  183   33
1   33  183
new oracle model saved
early stop counter: 6
val acc:0.8239436745643616, best validation acc: 0.8568075299263, corresponding to test acc:                         0.8287037014961243 / 0.8472222089767456
after epoch: 13,now: 2024-07-22 22:42:52.380830,epoch time: 0:01:28.605087,used: 0:19:43.939201,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_22_22_23_08_seed_2_22755939
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.98658377, 'precision': 0.986578, 'recall': 0.9866061, 'specificity': 0.9866061, 'f1': 0.9865835, 'auroc': 0.99895525, 'binary_precision': 0.98954934, 'binary_recall': 0.98376626, 'binary_specificity': 0.9894459, 'binary_f1_score': 0.98664933}
confusion matrix:
      0     1
0  1500    16
1    25  1515
---- Validation: 
scalar performance:
{'acc': 0.8302034, 'precision': 0.83931804, 'recall': 0.8279792, 'specificity': 0.8279792, 'f1': 0.8282874, 'auroc': 0.89546657, 'binary_precision': 0.88867563, 'binary_recall': 0.74437296, 'binary_specificity': 0.9115854, 'binary_f1_score': 0.8101488}
confusion matrix:
     0    1
0  598   58
1  159  463
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8657407, 'precision': 0.86775863, 'recall': 0.8657408, 'specificity': 0.8657408, 'f1': 0.86555636, 'auroc': 0.93578535, 'binary_precision': 0.895, 'binary_recall': 0.8287037, 'binary_specificity': 0.9027778, 'binary_f1_score': 0.8605769}
confusion matrix:
     0    1
0  195   21
1   37  179
new oracle model saved
early stop counter: 7
val acc:0.8302034139633179, best validation acc: 0.8568075299263, corresponding to test acc:                         0.8287037014961243 / 0.8657407164573669
after epoch: 14,now: 2024-07-22 22:44:24.543503,epoch time: 0:01:32.162673,used: 0:21:16.101874,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_22_22_23_08_seed_2_22755939
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9888743, 'precision': 0.98888034, 'recall': 0.9889096, 'specificity': 0.9889096, 'f1': 0.9888742, 'auroc': 0.9987831, 'binary_precision': 0.99344695, 'binary_recall': 0.9844156, 'binary_specificity': 0.9934037, 'binary_f1_score': 0.9889106}
confusion matrix:
      0     1
0  1506    10
1    24  1516
---- Validation: 
scalar performance:
{'acc': 0.842723, 'precision': 0.8458203, 'recall': 0.8414242, 'specificity': 0.8414242, 'f1': 0.84192157, 'auroc': 0.89818203, 'binary_precision': 0.87256634, 'binary_recall': 0.7926045, 'binary_specificity': 0.8902439, 'binary_f1_score': 0.8306655}
confusion matrix:
     0    1
0  584   72
1  129  493
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8194444, 'precision': 0.8198832, 'recall': 0.8194444, 'specificity': 0.8194444, 'f1': 0.81938255, 'auroc': 0.92166066, 'binary_precision': 0.80803573, 'binary_recall': 0.837963, 'binary_specificity': 0.8009259, 'binary_f1_score': 0.8227273}
confusion matrix:
     0    1
0  173   43
1   35  181
early stop counter: 8
val acc:0.84272301197052, best validation acc: 0.8568075299263, corresponding to test acc:                         0.8287037014961243 / 0.8657407164573669
after epoch: 15,now: 2024-07-22 22:45:54.654524,epoch time: 0:01:30.111021,used: 0:22:46.212895,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_22_22_23_08_seed_2_22755939
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9878927, 'precision': 0.9878903, 'recall': 0.98792017, 'specificity': 0.98792017, 'f1': 0.9878924, 'auroc': 0.99919724, 'binary_precision': 0.9914977, 'binary_recall': 0.9844156, 'binary_specificity': 0.9914248, 'binary_f1_score': 0.98794395}
confusion matrix:
      0     1
0  1503    13
1    24  1516
---- Validation: 
scalar performance:
{'acc': 0.829421, 'precision': 0.82931477, 'recall': 0.8295084, 'specificity': 0.8295084, 'f1': 0.8293607, 'auroc': 0.87913203, 'binary_precision': 0.81962025, 'binary_recall': 0.8327974, 'binary_specificity': 0.8262195, 'binary_f1_score': 0.82615626}
confusion matrix:
     0    1
0  542  114
1  104  518
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7847222, 'precision': 0.81307304, 'recall': 0.7847222, 'specificity': 0.7847222, 'f1': 0.7797357, 'auroc': 0.8839163, 'binary_precision': 0.7188612, 'binary_recall': 0.9351852, 'binary_specificity': 0.6342593, 'binary_f1_score': 0.8128773}
confusion matrix:
     0    1
0  137   79
1   14  202
early stop counter: 9
val acc:0.8294209837913513, best validation acc: 0.8568075299263, corresponding to test acc:                         0.8287037014961243 / 0.8657407164573669
after epoch: 16,now: 2024-07-22 22:47:23.512750,epoch time: 0:01:28.858226,used: 0:24:15.071121,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_22_22_23_08_seed_2_22755939
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.98854715, 'precision': 0.98855674, 'recall': 0.988585, 'specificity': 0.988585, 'f1': 0.988547, 'auroc': 0.9994697, 'binary_precision': 0.9934426, 'binary_recall': 0.98376626, 'binary_specificity': 0.9934037, 'binary_f1_score': 0.98858076}
confusion matrix:
      0     1
0  1506    10
1    25  1515
---- Validation: 
scalar performance:
{'acc': 0.8489828, 'precision': 0.85082686, 'recall': 0.84798, 'specificity': 0.84798, 'f1': 0.84843254, 'auroc': 0.9072524, 'binary_precision': 0.8704663, 'binary_recall': 0.8102894, 'binary_specificity': 0.8856707, 'binary_f1_score': 0.8393006}
confusion matrix:
     0    1
0  581   75
1  118  504
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7916667, 'precision': 0.7947241, 'recall': 0.7916666, 'specificity': 0.7916666, 'f1': 0.79112494, 'auroc': 0.8755144, 'binary_precision': 0.82474226, 'binary_recall': 0.7407407, 'binary_specificity': 0.8425926, 'binary_f1_score': 0.78048784}
confusion matrix:
     0    1
0  182   34
1   56  160
early stop counter: 10
val acc:0.8489828109741211, best validation acc: 0.8568075299263, corresponding to test acc:                         0.8287037014961243 / 0.8657407164573669
after epoch: 17,now: 2024-07-22 22:48:53.229839,epoch time: 0:01:29.717089,used: 0:25:44.788210,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_22_22_23_08_seed_2_22755939
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9908377, 'precision': 0.9908308, 'recall': 0.9908577, 'specificity': 0.9908577, 'f1': 0.99083745, 'auroc': 0.9994693, 'binary_precision': 0.9934726, 'binary_recall': 0.9883117, 'binary_specificity': 0.9934037, 'binary_f1_score': 0.9908854}
confusion matrix:
      0     1
0  1506    10
1    18  1522
---- Validation: 
scalar performance:
{'acc': 0.85289514, 'precision': 0.858554, 'recall': 0.85120773, 'specificity': 0.85120773, 'f1': 0.8517972, 'auroc': 0.9116491, 'binary_precision': 0.8974359, 'binary_recall': 0.78778136, 'binary_specificity': 0.91463417, 'binary_f1_score': 0.8390411}
confusion matrix:
     0    1
0  600   56
1  132  490
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8055556, 'precision': 0.8055818, 'recall': 0.8055556, 'specificity': 0.8055556, 'f1': 0.8055514, 'auroc': 0.8892962, 'binary_precision': 0.80841124, 'binary_recall': 0.8009259, 'binary_specificity': 0.8101852, 'binary_f1_score': 0.8046512}
confusion matrix:
     0    1
0  175   41
1   43  173
early stop counter: 11
val acc:0.8528951406478882, best validation acc: 0.8568075299263, corresponding to test acc:                         0.8287037014961243 / 0.8657407164573669
after epoch: 18,now: 2024-07-22 22:50:24.749851,epoch time: 0:01:31.520012,used: 0:27:16.308222,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_22_22_23_08_seed_2_22755939
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.95746076, 'precision': 0.9607613, 'recall': 0.95713943, 'specificity': 0.95713943, 'f1': 0.9573607, 'auroc': 0.9991784, 'binary_precision': 0.92367786, 'binary_recall': 0.99805194, 'binary_specificity': 0.9162269, 'binary_f1_score': 0.9594257}
confusion matrix:
      0     1
0  1389   127
1     3  1537
---- Validation: 
scalar performance:
{'acc': 0.70187795, 'precision': 0.7484173, 'recall': 0.70743716, 'specificity': 0.70743716, 'f1': 0.6906954, 'auroc': 0.87829876, 'binary_precision': 0.6340378, 'binary_recall': 0.9163987, 'binary_specificity': 0.4984756, 'binary_f1_score': 0.74950683}
confusion matrix:
     0    1
0  327  329
1   52  570
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5740741, 'precision': 0.74242425, 'recall': 0.57407403, 'specificity': 0.57407403, 'f1': 0.4845938, 'auroc': 0.89096797, 'binary_precision': 0.540404, 'binary_recall': 0.9907407, 'binary_specificity': 0.1574074, 'binary_f1_score': 0.69934636}
confusion matrix:
    0    1
0  34  182
1   2  214
early stop counter: 12
val acc:0.7018779516220093, best validation acc: 0.8568075299263, corresponding to test acc:                         0.8287037014961243 / 0.8657407164573669
after epoch: 19,now: 2024-07-22 22:51:53.305697,epoch time: 0:01:28.555846,used: 0:28:44.864068,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_22_22_23_08_seed_2_22755939
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9777487, 'precision': 0.97843647, 'recall': 0.9779118, 'specificity': 0.9779118, 'f1': 0.9777449, 'auroc': 0.9989416, 'binary_precision': 0.998645, 'binary_recall': 0.95714283, 'binary_specificity': 0.9986807, 'binary_f1_score': 0.97745353}
confusion matrix:
      0     1
0  1514     2
1    66  1474
---- Validation: 
scalar performance:
{'acc': 0.7456964, 'precision': 0.81288093, 'recall': 0.7394126, 'specificity': 0.7394126, 'f1': 0.72788113, 'auroc': 0.9050368, 'binary_precision': 0.9513678, 'binary_recall': 0.50321543, 'binary_specificity': 0.9756098, 'binary_f1_score': 0.6582545}
confusion matrix:
     0    1
0  640   16
1  309  313
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5949074, 'precision': 0.77621484, 'recall': 0.5949074, 'specificity': 0.5949074, 'f1': 0.5153815, 'auroc': 0.9018775, 'binary_precision': 1.0, 'binary_recall': 0.18981482, 'binary_specificity': 1.0, 'binary_f1_score': 0.31906617}
confusion matrix:
     0   1
0  216   0
1  175  41
early stop counter: 13
val acc:0.7456964254379272, best validation acc: 0.8568075299263, corresponding to test acc:                         0.8287037014961243 / 0.8657407164573669
after epoch: 20,now: 2024-07-22 22:53:22.003035,epoch time: 0:01:28.697338,used: 0:30:13.561406,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_22_22_23_08_seed_2_22755939
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9790576, 'precision': 0.97947925, 'recall': 0.9789535, 'specificity': 0.9789535, 'f1': 0.9790484, 'auroc': 0.9987861, 'binary_precision': 0.9670886, 'binary_recall': 0.99220777, 'binary_specificity': 0.9656992, 'binary_f1_score': 0.9794872}
confusion matrix:
      0     1
0  1464    52
1    12  1528
---- Validation: 
scalar performance:
{'acc': 0.85289514, 'precision': 0.85383236, 'recall': 0.8536242, 'specificity': 0.8536242, 'f1': 0.8528919, 'auroc': 0.9187932, 'binary_precision': 0.82779455, 'binary_recall': 0.88102895, 'binary_specificity': 0.8262195, 'binary_f1_score': 0.8535826}
confusion matrix:
     0    1
0  542  114
1   74  548
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8333333, 'precision': 0.8408135, 'recall': 0.8333334, 'specificity': 0.8333334, 'f1': 0.8324138, 'auroc': 0.9162166, 'binary_precision': 0.7903226, 'binary_recall': 0.9074074, 'binary_specificity': 0.7592593, 'binary_f1_score': 0.8448276}
confusion matrix:
     0    1
0  164   52
1   20  196
early stop counter: 14
val acc:0.8528951406478882, best validation acc: 0.8568075299263, corresponding to test acc:                         0.8287037014961243 / 0.8657407164573669
after epoch: 21,now: 2024-07-22 22:54:53.739194,epoch time: 0:01:31.736159,used: 0:31:45.297565,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_22_22_23_08_seed_2_22755939
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.98232985, 'precision': 0.9826562, 'recall': 0.98244697, 'specificity': 0.98244697, 'f1': 0.9823289, 'auroc': 0.9990139, 'binary_precision': 0.9973226, 'binary_recall': 0.96753246, 'binary_specificity': 0.9973615, 'binary_f1_score': 0.9822017}
confusion matrix:
      0     1
0  1512     4
1    50  1490
---- Validation: 
scalar performance:
{'acc': 0.7065728, 'precision': 0.7976214, 'recall': 0.69905305, 'specificity': 0.69905305, 'f1': 0.67728555, 'auroc': 0.9174305, 'binary_precision': 0.95571953, 'binary_recall': 0.4163987, 'binary_specificity': 0.98170733, 'binary_f1_score': 0.58006716}
confusion matrix:
     0    1
0  644   12
1  363  259
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6388889, 'precision': 0.79032254, 'recall': 0.6388889, 'specificity': 0.6388889, 'f1': 0.58473825, 'auroc': 0.92974114, 'binary_precision': 1.0, 'binary_recall': 0.2777778, 'binary_specificity': 1.0, 'binary_f1_score': 0.43478262}
confusion matrix:
     0   1
0  216   0
1  156  60
early stop counter: 15
val acc:0.7065727710723877, best validation acc: 0.8568075299263, corresponding to test acc:                         0.8287037014961243 / 0.8657407164573669
after epoch: 22,now: 2024-07-22 22:56:22.332262,epoch time: 0:01:28.593068,used: 0:33:13.890633,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_22_22_23_08_seed_2_22755939
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.989856, 'precision': 0.9899806, 'recall': 0.98993504, 'specificity': 0.98993504, 'f1': 0.989856, 'auroc': 0.9998021, 'binary_precision': 1.0, 'binary_recall': 0.97987014, 'binary_specificity': 1.0, 'binary_f1_score': 0.98983276}
confusion matrix:
      0     1
0  1516     0
1    31  1509
---- Validation: 
scalar performance:
{'acc': 0.7965571, 'precision': 0.8426055, 'recall': 0.79162174, 'specificity': 0.79162174, 'f1': 0.7874888, 'auroc': 0.91832745, 'binary_precision': 0.9617347, 'binary_recall': 0.6061093, 'binary_specificity': 0.97713417, 'binary_f1_score': 0.74358976}
confusion matrix:
     0    1
0  641   15
1  245  377
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7083333, 'precision': 0.80133927, 'recall': 0.7083333, 'specificity': 0.7083333, 'f1': 0.6839465, 'auroc': 0.9021133, 'binary_precision': 0.96875, 'binary_recall': 0.43055555, 'binary_specificity': 0.9861111, 'binary_f1_score': 0.59615386}
confusion matrix:
     0   1
0  213   3
1  123  93
early stop counter: 16
val acc:0.7965571284294128, best validation acc: 0.8568075299263, corresponding to test acc:                         0.8287037014961243 / 0.8657407164573669
after epoch: 23,now: 2024-07-22 22:57:51.753175,epoch time: 0:01:29.420913,used: 0:34:43.311546,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_22_22_23_08_seed_2_22755939
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9937827, 'precision': 0.993785, 'recall': 0.9937798, 'specificity': 0.9937798, 'f1': 0.9937823, 'auroc': 0.99962264, 'binary_precision': 0.9935107, 'binary_recall': 0.9941558, 'binary_specificity': 0.9934037, 'binary_f1_score': 0.9938331}
confusion matrix:
      0     1
0  1506    10
1     9  1531
---- Validation: 
scalar performance:
{'acc': 0.81846637, 'precision': 0.8473825, 'recall': 0.81458807, 'specificity': 0.81458807, 'f1': 0.81322944, 'auroc': 0.9147273, 'binary_precision': 0.9411765, 'binary_recall': 0.6688103, 'binary_specificity': 0.96036583, 'binary_f1_score': 0.7819549}
confusion matrix:
     0    1
0  630   26
1  206  416
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8402778, 'precision': 0.8557169, 'recall': 0.8402778, 'specificity': 0.8402778, 'f1': 0.83852565, 'auroc': 0.929934, 'binary_precision': 0.9298246, 'binary_recall': 0.7361111, 'binary_specificity': 0.9444444, 'binary_f1_score': 0.8217054}
confusion matrix:
     0    1
0  204   12
1   57  159
early stop counter: 17
val acc:0.8184663653373718, best validation acc: 0.8568075299263, corresponding to test acc:                         0.8287037014961243 / 0.8657407164573669
after epoch: 24,now: 2024-07-22 22:59:22.380468,epoch time: 0:01:30.627293,used: 0:36:13.938839,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_22_22_23_08_seed_2_22755939
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.95811516, 'precision': 0.9606942, 'recall': 0.958421, 'specificity': 0.958421, 'f1': 0.95807374, 'auroc': 0.9956014, 'binary_precision': 0.9971831, 'binary_recall': 0.9194805, 'binary_specificity': 0.9973615, 'binary_f1_score': 0.9567567}
confusion matrix:
      0     1
0  1512     4
1   124  1416
---- Validation: 
scalar performance:
{'acc': 0.80829424, 'precision': 0.81151146, 'recall': 0.806846, 'specificity': 0.806846, 'f1': 0.8071835, 'auroc': 0.87280405, 'binary_precision': 0.8372093, 'binary_recall': 0.7524116, 'binary_specificity': 0.8612805, 'binary_f1_score': 0.7925487}
confusion matrix:
     0    1
0  565   91
1  154  468
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8101852, 'precision': 0.8102118, 'recall': 0.8101852, 'specificity': 0.8101852, 'f1': 0.81018114, 'auroc': 0.8913537, 'binary_precision': 0.80733943, 'binary_recall': 0.8148148, 'binary_specificity': 0.8055556, 'binary_f1_score': 0.81105995}
confusion matrix:
     0    1
0  174   42
1   40  176
early stop counter: 18
val acc:0.8082942366600037, best validation acc: 0.8568075299263, corresponding to test acc:                         0.8287037014961243 / 0.8657407164573669
after epoch: 25,now: 2024-07-22 23:00:51.384352,epoch time: 0:01:29.003884,used: 0:37:42.942723,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_22_22_23_08_seed_2_22755939
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9787304, 'precision': 0.9788333, 'recall': 0.9788036, 'specificity': 0.9788036, 'f1': 0.9787303, 'auroc': 0.99787164, 'binary_precision': 0.98808736, 'binary_recall': 0.9694805, 'binary_specificity': 0.98812664, 'binary_f1_score': 0.9786955}
confusion matrix:
      0     1
0  1498    18
1    47  1493
---- Validation: 
scalar performance:
{'acc': 0.8482003, 'precision': 0.84826005, 'recall': 0.8478845, 'specificity': 0.8478845, 'f1': 0.8480201, 'auroc': 0.90988696, 'binary_precision': 0.8496732, 'binary_recall': 0.83601284, 'binary_specificity': 0.8597561, 'binary_f1_score': 0.8427876}
confusion matrix:
     0    1
0  564   92
1  102  520
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8657407, 'precision': 0.8660232, 'recall': 0.8657408, 'specificity': 0.8657408, 'f1': 0.8657148, 'auroc': 0.9231181, 'binary_precision': 0.8761905, 'binary_recall': 0.8518519, 'binary_specificity': 0.8796296, 'binary_f1_score': 0.86384976}
confusion matrix:
     0    1
0  190   26
1   32  184
early stop counter: 19
val acc:0.8482003211975098, best validation acc: 0.8568075299263, corresponding to test acc:                         0.8287037014961243 / 0.8657407164573669
after epoch: 26,now: 2024-07-22 23:02:20.660315,epoch time: 0:01:29.275963,used: 0:39:12.218686,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_22_22_23_08_seed_2_22755939
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.98232985, 'precision': 0.98272604, 'recall': 0.9824573, 'specificity': 0.9824573, 'f1': 0.98232853, 'auroc': 0.9989468, 'binary_precision': 0.9986577, 'binary_recall': 0.9662338, 'binary_specificity': 0.9986807, 'binary_f1_score': 0.9821782}
confusion matrix:
      0     1
0  1514     2
1    52  1488
---- Validation: 
scalar performance:
{'acc': 0.7902973, 'precision': 0.82089335, 'recall': 0.7861074, 'specificity': 0.7861074, 'f1': 0.7834035, 'auroc': 0.8967728, 'binary_precision': 0.9135514, 'binary_recall': 0.62861735, 'binary_specificity': 0.94359756, 'binary_f1_score': 0.7447619}
confusion matrix:
     0    1
0  619   37
1  231  391
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7893519, 'precision': 0.82666296, 'recall': 0.7893518, 'specificity': 0.7893518, 'f1': 0.78316003, 'auroc': 0.8948045, 'binary_precision': 0.9370629, 'binary_recall': 0.6203704, 'binary_specificity': 0.9583333, 'binary_f1_score': 0.7465181}
confusion matrix:
     0    1
0  207    9
1   82  134
early stop counter: 20
val acc:0.7902973294258118, best validation acc: 0.8568075299263, corresponding to test acc:                         0.8287037014961243 / 0.8657407164573669
after epoch: 27,now: 2024-07-22 23:03:51.431141,epoch time: 0:01:30.770826,used: 0:40:42.989512,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_22_22_23_08_seed_2_22755939
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.98232985, 'precision': 0.98272604, 'recall': 0.9824573, 'specificity': 0.9824573, 'f1': 0.98232853, 'auroc': 0.9994517, 'binary_precision': 0.9986577, 'binary_recall': 0.9662338, 'binary_specificity': 0.9986807, 'binary_f1_score': 0.9821782}
confusion matrix:
      0     1
0  1514     2
1    52  1488
---- Validation: 
scalar performance:
{'acc': 0.6111111, 'precision': 0.7018453, 'recall': 0.6018155, 'specificity': 0.6018155, 'f1': 0.5511813, 'auroc': 0.8109193, 'binary_precision': 0.8306878, 'binary_recall': 0.25241157, 'binary_specificity': 0.9512195, 'binary_f1_score': 0.38717633}
confusion matrix:
     0    1
0  624   32
1  465  157
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8009259, 'precision': 0.8076788, 'recall': 0.80092597, 'specificity': 0.80092597, 'f1': 0.7998276, 'auroc': 0.8607682, 'binary_precision': 0.8532609, 'binary_recall': 0.7268519, 'binary_specificity': 0.875, 'binary_f1_score': 0.785}
confusion matrix:
     0    1
0  189   27
1   59  157
early stop counter: 21
val acc:0.6111111044883728, best validation acc: 0.8568075299263, corresponding to test acc:                         0.8287037014961243 / 0.8657407164573669
after epoch: 28,now: 2024-07-22 23:05:20.502366,epoch time: 0:01:29.071225,used: 0:42:12.060737,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_22_22_23_08_seed_2_22755939
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9878927, 'precision': 0.98791075, 'recall': 0.9879356, 'specificity': 0.9879356, 'f1': 0.98789257, 'auroc': 0.9984306, 'binary_precision': 0.993434, 'binary_recall': 0.98246753, 'binary_specificity': 0.9934037, 'binary_f1_score': 0.9879203}
confusion matrix:
      0     1
0  1506    10
1    27  1513
---- Validation: 
scalar performance:
{'acc': 0.71283257, 'precision': 0.74928683, 'recall': 0.7075254, 'specificity': 0.7075254, 'f1': 0.69846153, 'auroc': 0.85869735, 'binary_precision': 0.8381963, 'binary_recall': 0.5080386, 'binary_specificity': 0.9070122, 'binary_f1_score': 0.6326327}
confusion matrix:
     0    1
0  595   61
1  306  316
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7546296, 'precision': 0.7603437, 'recall': 0.7546296, 'specificity': 0.7546296, 'f1': 0.7532759, 'auroc': 0.85322356, 'binary_precision': 0.7217742, 'binary_recall': 0.8287037, 'binary_specificity': 0.6805556, 'binary_f1_score': 0.7715517}
confusion matrix:
     0    1
0  147   69
1   37  179
early stop counter: 22
val acc:0.7128325700759888, best validation acc: 0.8568075299263, corresponding to test acc:                         0.8287037014961243 / 0.8657407164573669
after epoch: 29,now: 2024-07-22 23:06:49.764554,epoch time: 0:01:29.262188,used: 0:43:41.322925,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_22_22_23_08_seed_2_22755939
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.9878927, 'precision': 0.9879309, 'recall': 0.9878688, 'specificity': 0.9878688, 'f1': 0.98789126, 'auroc': 0.9992534, 'binary_precision': 0.9851517, 'binary_recall': 0.9909091, 'binary_specificity': 0.9848285, 'binary_f1_score': 0.988022}
confusion matrix:
      0     1
0  1493    23
1    14  1526
---- Validation: 
scalar performance:
{'acc': 0.8255086, 'precision': 0.84536, 'recall': 0.8222811, 'specificity': 0.8222811, 'f1': 0.8218559, 'auroc': 0.90001035, 'binary_precision': 0.9217759, 'binary_recall': 0.7009646, 'binary_specificity': 0.94359756, 'binary_f1_score': 0.796347}
confusion matrix:
     0    1
0  619   37
1  186  436
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8449074, 'precision': 0.8531503, 'recall': 0.8449074, 'specificity': 0.8449074, 'f1': 0.84399706, 'auroc': 0.9080504, 'binary_precision': 0.90710384, 'binary_recall': 0.7685185, 'binary_specificity': 0.9212963, 'binary_f1_score': 0.8320802}
confusion matrix:
     0    1
0  199   17
1   50  166
early stop counter: 23
val acc:0.8255085945129395, best validation acc: 0.8568075299263, corresponding to test acc:                         0.8287037014961243 / 0.8657407164573669
after epoch: 30,now: 2024-07-22 23:08:23.970973,epoch time: 0:01:34.206419,used: 0:45:15.529344,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_22_22_23_08_seed_2_22755939
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 0:45:15.529344 at 2024-07-22 23:08:23.970973
persisted model performance metric: 

scalar performance:
{'acc': 0.8287037, 'precision': 0.83281255, 'recall': 0.8287037, 'specificity': 0.8287037, 'f1': 0.8281734, 'auroc': 0.928798, 'binary_precision': 0.79583335, 'binary_recall': 0.8842593, 'binary_specificity': 0.7731481, 'binary_f1_score': 0.8377193}
confusion matrix:
     0    1
0  167   49
1   25  191
oracle model performance metric: 

scalar performance:
{'acc': 0.8657407, 'precision': 0.86775863, 'recall': 0.8657408, 'specificity': 0.8657408, 'f1': 0.86555636, 'auroc': 0.93578535, 'binary_precision': 0.895, 'binary_recall': 0.8287037, 'binary_specificity': 0.9027778, 'binary_f1_score': 0.8605769}
confusion matrix:
     0    1
0  195   21
1   37  179
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_higherregularization_irm_dial_lr1e5_bs16_nofreeze_2024-07-22_16-00-54/rule_results/1.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_higherregularization_irm_dial_lr1e5_bs16_nofreeze_2024-07-22_16-00-54/confusion_matrix/1.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 455396 KiB |  13219 MiB | 223318 GiB | 223318 GiB |
|       from large pool | 414803 KiB |  13181 MiB | 220653 GiB | 220653 GiB |
|       from small pool |  40592 KiB |     60 MiB |   2665 GiB |   2665 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 455396 KiB |  13219 MiB | 223318 GiB | 223318 GiB |
|       from large pool | 414803 KiB |  13181 MiB | 220653 GiB | 220653 GiB |
|       from small pool |  40592 KiB |     60 MiB |   2665 GiB |   2665 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 447481 KiB |  13213 MiB | 222697 GiB | 222696 GiB |
|       from large pool | 407075 KiB |  13175 MiB | 220037 GiB | 220036 GiB |
|       from small pool |  40406 KiB |     60 MiB |   2659 GiB |   2659 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  14478 MiB |  14482 MiB |  41646 MiB |  27168 MiB |
|       from large pool |  14412 MiB |  14412 MiB |  41542 MiB |  27130 MiB |
|       from small pool |     66 MiB |     70 MiB |    104 MiB |     38 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 447772 KiB |   1238 MiB | 156875 GiB | 156875 GiB |
|       from large pool | 435116 KiB |   1229 MiB | 154195 GiB | 154195 GiB |
|       from small pool |  12655 KiB |     42 MiB |   2679 GiB |   2679 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    1298    |    2598    |   39288 K  |   39287 K  |
|       from large pool |     187    |    1413    |   20062 K  |   20061 K  |
|       from small pool |    1111    |    1419    |   19226 K  |   19225 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    1298    |    2598    |   39288 K  |   39287 K  |
|       from large pool |     187    |    1413    |   20062 K  |   20061 K  |
|       from small pool |    1111    |    1419    |   19226 K  |   19225 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     635    |     637    |    1782    |    1147    |
|       from large pool |     602    |     602    |    1730    |    1128    |
|       from small pool |      33    |      35    |      52    |      19    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     100    |     652    |   27014 K  |   27014 K  |
|       from large pool |      38    |     605    |   15639 K  |   15639 K  |
|       from small pool |      62    |     234    |   11375 K  |   11375 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13219 MiB | 223318 GiB | 223318 GiB |
|       from large pool |  16640 KiB |  13181 MiB | 220653 GiB | 220653 GiB |
|       from small pool |      0 KiB |     60 MiB |   2665 GiB |   2665 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13219 MiB | 223318 GiB | 223318 GiB |
|       from large pool |  16640 KiB |  13181 MiB | 220653 GiB | 220653 GiB |
|       from small pool |      0 KiB |     60 MiB |   2665 GiB |   2665 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13213 MiB | 222697 GiB | 222697 GiB |
|       from large pool |  16640 KiB |  13175 MiB | 220037 GiB | 220037 GiB |
|       from small pool |      0 KiB |     60 MiB |   2659 GiB |   2659 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    882 MiB |  14482 MiB |  41646 MiB |  40764 MiB |
|       from large pool |    830 MiB |  14412 MiB |  41542 MiB |  40712 MiB |
|       from small pool |     52 MiB |     70 MiB |    104 MiB |     52 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1238 MiB | 156876 GiB | 156876 GiB |
|       from large pool |  24320 KiB |   1229 MiB | 154196 GiB | 154196 GiB |
|       from small pool |      0 KiB |     45 MiB |   2679 GiB |   2679 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    2598    |   39288 K  |   39288 K  |
|       from large pool |       2    |    1413    |   20062 K  |   20062 K  |
|       from small pool |       0    |    1419    |   19226 K  |   19226 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    2598    |   39288 K  |   39288 K  |
|       from large pool |       2    |    1413    |   20062 K  |   20062 K  |
|       from small pool |       0    |    1419    |   19226 K  |   19226 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      63    |     637    |    1782    |    1719    |
|       from large pool |      37    |     602    |    1730    |    1693    |
|       from small pool |      26    |      35    |      52    |      26    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |     652    |   27015 K  |   27015 K  |
|       from large pool |       4    |     605    |   15639 K  |   15639 K  |
|       from small pool |       0    |     234    |   11375 K  |   11375 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Mon Jul 22 23:09:13 2024]
Finished job 0.
1 of 1 steps (100%) done
