Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Mon Jul 22 23:10:27 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_higherregularization_irm_dial_lr1e5_bs16_nofreeze_2024-07-22_16-00-54/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_higherregularization_irm_dial_lr1e5_bs16_nofreeze_2024-07-22_16-00-54/rule_results/0.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=0
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/swiglu_ffn.py:51: UserWarning: xFormers is not available (SwiGLU)
  warnings.warn("xFormers is not available (SwiGLU)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/attention.py:33: UserWarning: xFormers is not available (Attention)
  warnings.warn("xFormers is not available (Attention)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/block.py:40: UserWarning: xFormers is not available (Block)
  warnings.warn("xFormers is not available (Block)")
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'888c1ef2'
model name: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_22_23_14_11_seed_0_22755942

 Experiment start at: 2024-07-22 23:14:11.756637
before training, model accuracy: 0.569767415523529
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9534505, 'precision': 0.953696, 'recall': 0.9533335, 'specificity': 0.9533335, 'f1': 0.9534296, 'auroc': 0.9913242, 'binary_precision': 0.94567275, 'binary_recall': 0.96332043, 'binary_specificity': 0.9433465, 'binary_f1_score': 0.95441496}
confusion matrix:
      0     1
0  1432    86
1    57  1497
---- Validation: 
scalar performance:
{'acc': 0.7709627, 'precision': 0.8094646, 'recall': 0.77340317, 'specificity': 0.77340317, 'f1': 0.76464653, 'auroc': 0.9189085, 'binary_precision': 0.6967593, 'binary_recall': 0.9480315, 'binary_specificity': 0.5987749, 'binary_f1_score': 0.80320215}
confusion matrix:
     0    1
0  391  262
1   33  602
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7744186, 'precision': 0.8039342, 'recall': 0.7744186, 'specificity': 0.7744186, 'f1': 0.7688057, 'auroc': 0.92724717, 'binary_precision': 0.7092199, 'binary_recall': 0.9302326, 'binary_specificity': 0.61860466, 'binary_f1_score': 0.804829}
confusion matrix:
     0    1
0  133   82
1   15  200
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-22 23:16:07.364623,epoch time: 0:01:55.607986,used: 0:01:55.607986,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_22_23_14_11_seed_0_22755942
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.96028644, 'precision': 0.960788, 'recall': 0.9600824, 'specificity': 0.9600824, 'f1': 0.96025527, 'auroc': 0.99318385, 'binary_precision': 0.94875, 'binary_recall': 0.9743261, 'binary_specificity': 0.9458388, 'binary_f1_score': 0.9613679}
confusion matrix:
      0     1
0  1432    82
1    40  1518
---- Validation: 
scalar performance:
{'acc': 0.76940995, 'precision': 0.810846, 'recall': 0.7719369, 'specificity': 0.7719369, 'f1': 0.762545, 'auroc': 0.92048085, 'binary_precision': 0.69380736, 'binary_recall': 0.9527559, 'binary_specificity': 0.5911179, 'binary_f1_score': 0.80291975}
confusion matrix:
     0    1
0  386  267
1   30  605
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.74651164, 'precision': 0.8063172, 'recall': 0.74651164, 'specificity': 0.74651164, 'f1': 0.73350394, 'auroc': 0.9324824, 'binary_precision': 0.67096776, 'binary_recall': 0.96744186, 'binary_specificity': 0.5255814, 'binary_f1_score': 0.792381}
confusion matrix:
     0    1
0  113  102
1    7  208
early stop counter: 1
val acc:0.7694099545478821, best validation acc: 0.7709627151489258, corresponding to test acc:                         0.7744185924530029 / 0.7744185924530029
after epoch: 2,now: 2024-07-22 23:17:36.855442,epoch time: 0:01:29.490819,used: 0:03:25.098805,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_22_23_14_11_seed_0_22755942
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9707031, 'precision': 0.97128206, 'recall': 0.9710183, 'specificity': 0.9710183, 'f1': 0.9707019, 'auroc': 0.99588937, 'binary_precision': 0.9919625, 'binary_recall': 0.9499679, 'binary_specificity': 0.9920687, 'binary_f1_score': 0.97051114}
confusion matrix:
      0     1
0  1501    12
1    78  1481
---- Validation: 
scalar performance:
{'acc': 0.7484472, 'precision': 0.7734113, 'recall': 0.7462927, 'specificity': 0.7462927, 'f1': 0.7414423, 'auroc': 0.83846813, 'binary_precision': 0.8526077, 'binary_recall': 0.592126, 'binary_specificity': 0.9004594, 'binary_f1_score': 0.6988848}
confusion matrix:
     0    1
0  588   65
1  259  376
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8465116, 'precision': 0.8479872, 'recall': 0.8465116, 'specificity': 0.8465116, 'f1': 0.84634876, 'auroc': 0.9030611, 'binary_precision': 0.8706468, 'binary_recall': 0.81395346, 'binary_specificity': 0.87906975, 'binary_f1_score': 0.84134614}
confusion matrix:
     0    1
0  189   26
1   40  175
new oracle model saved
early stop counter: 2
val acc:0.7484471797943115, best validation acc: 0.7709627151489258, corresponding to test acc:                         0.7744185924530029 / 0.8465116024017334
after epoch: 3,now: 2024-07-22 23:19:08.929287,epoch time: 0:01:32.073845,used: 0:04:57.172650,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_22_23_14_11_seed_0_22755942
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9661458, 'precision': 0.96775377, 'recall': 0.966564, 'specificity': 0.966564, 'f1': 0.9661329, 'auroc': 0.9966574, 'binary_precision': 0.99862635, 'binary_recall': 0.9344473, 'binary_specificity': 0.9986807, 'binary_f1_score': 0.96547145}
confusion matrix:
      0     1
0  1514     2
1   102  1454
---- Validation: 
scalar performance:
{'acc': 0.67158383, 'precision': 0.76899815, 'recall': 0.66731983, 'specificity': 0.66731983, 'f1': 0.63554955, 'auroc': 0.87381077, 'binary_precision': 0.92741936, 'binary_recall': 0.36220473, 'binary_specificity': 0.97243494, 'binary_f1_score': 0.52095133}
confusion matrix:
     0    1
0  635   18
1  405  230
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8023256, 'precision': 0.8442118, 'recall': 0.8023256, 'specificity': 0.8023256, 'f1': 0.79612327, 'auroc': 0.8920714, 'binary_precision': 0.96428573, 'binary_recall': 0.627907, 'binary_specificity': 0.9767442, 'binary_f1_score': 0.76056343}
confusion matrix:
     0    1
0  210    5
1   80  135
early stop counter: 3
val acc:0.6715838313102722, best validation acc: 0.7709627151489258, corresponding to test acc:                         0.7744185924530029 / 0.8465116024017334
after epoch: 4,now: 2024-07-22 23:20:38.858236,epoch time: 0:01:29.928949,used: 0:06:27.101599,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_22_23_14_11_seed_0_22755942
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.930013, 'precision': 0.93824136, 'recall': 0.92901736, 'specificity': 0.92901736, 'f1': 0.9295576, 'auroc': 0.99704933, 'binary_precision': 0.8818182, 'binary_recall': 0.9955099, 'binary_specificity': 0.8625248, 'binary_f1_score': 0.93522143}
confusion matrix:
      0     1
0  1305   208
1     7  1552
---- Validation: 
scalar performance:
{'acc': 0.8128882, 'precision': 0.83203, 'recall': 0.81455547, 'specificity': 0.81455547, 'f1': 0.81068337, 'auroc': 0.92937505, 'binary_precision': 0.7487374, 'binary_recall': 0.9338583, 'binary_specificity': 0.69525266, 'binary_f1_score': 0.83111423}
confusion matrix:
     0    1
0  454  199
1   42  593
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8581395, 'precision': 0.8587682, 'recall': 0.8581395, 'specificity': 0.8581395, 'f1': 0.8580773, 'auroc': 0.9424338, 'binary_precision': 0.84375, 'binary_recall': 0.87906975, 'binary_specificity': 0.8372093, 'binary_f1_score': 0.86104774}
confusion matrix:
     0    1
0  180   35
1   26  189
new oracle model saved
better model found
persisted
after epoch: 5,now: 2024-07-22 23:22:09.093267,epoch time: 0:01:30.235031,used: 0:07:57.336630,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_22_23_14_11_seed_0_22755942
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9817708, 'precision': 0.9817631, 'recall': 0.98184407, 'specificity': 0.98184407, 'f1': 0.9817699, 'auroc': 0.9982288, 'binary_precision': 0.9876463, 'binary_recall': 0.9762211, 'binary_specificity': 0.987467, 'binary_f1_score': 0.9819004}
confusion matrix:
      0     1
0  1497    19
1    37  1519
---- Validation: 
scalar performance:
{'acc': 0.8035714, 'precision': 0.81703514, 'recall': 0.8021114, 'specificity': 0.8021114, 'f1': 0.800907, 'auroc': 0.8838167, 'binary_precision': 0.87896824, 'binary_recall': 0.6976378, 'binary_specificity': 0.906585, 'binary_f1_score': 0.7778753}
confusion matrix:
     0    1
0  592   61
1  192  443
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8697674, 'precision': 0.8723775, 'recall': 0.8697674, 'specificity': 0.8697674, 'f1': 0.8695388, 'auroc': 0.94115734, 'binary_precision': 0.9035533, 'binary_recall': 0.82790697, 'binary_specificity': 0.9116279, 'binary_f1_score': 0.8640776}
confusion matrix:
     0    1
0  196   19
1   37  178
new oracle model saved
early stop counter: 1
val acc:0.8035714030265808, best validation acc: 0.8128882050514221, corresponding to test acc:                         0.8581395149230957 / 0.869767427444458
after epoch: 6,now: 2024-07-22 23:23:42.715539,epoch time: 0:01:33.622272,used: 0:09:30.958902,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_22_23_14_11_seed_0_22755942
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9749349, 'precision': 0.97556615, 'recall': 0.9752284, 'specificity': 0.9752284, 'f1': 0.97493327, 'auroc': 0.99864006, 'binary_precision': 0.9966443, 'binary_recall': 0.9537572, 'binary_specificity': 0.9966997, 'binary_f1_score': 0.97472924}
confusion matrix:
      0     1
0  1510     5
1    72  1485
---- Validation: 
scalar performance:
{'acc': 0.6902174, 'precision': 0.7808957, 'recall': 0.68619573, 'specificity': 0.68619573, 'f1': 0.6601684, 'auroc': 0.8959466, 'binary_precision': 0.93703705, 'binary_recall': 0.3984252, 'binary_specificity': 0.9739663, 'binary_f1_score': 0.55911607}
confusion matrix:
     0    1
0  636   17
1  382  253
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8488372, 'precision': 0.8772459, 'recall': 0.8488372, 'specificity': 0.8488372, 'f1': 0.8459368, 'auroc': 0.93365604, 'binary_precision': 0.9807692, 'binary_recall': 0.7116279, 'binary_specificity': 0.9860465, 'binary_f1_score': 0.8247978}
confusion matrix:
     0    1
0  212    3
1   62  153
early stop counter: 2
val acc:0.6902173757553101, best validation acc: 0.8128882050514221, corresponding to test acc:                         0.8581395149230957 / 0.869767427444458
after epoch: 7,now: 2024-07-22 23:25:12.268209,epoch time: 0:01:29.552670,used: 0:11:00.511572,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_22_23_14_11_seed_0_22755942
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.98014325, 'precision': 0.9806241, 'recall': 0.97994864, 'specificity': 0.97994864, 'f1': 0.98012805, 'auroc': 0.9988998, 'binary_precision': 0.9687109, 'binary_recall': 0.9929442, 'binary_specificity': 0.9669531, 'binary_f1_score': 0.98067784}
confusion matrix:
      0     1
0  1463    50
1    11  1548
---- Validation: 
scalar performance:
{'acc': 0.871118, 'precision': 0.87259257, 'recall': 0.87068045, 'specificity': 0.87068045, 'f1': 0.8708739, 'auroc': 0.91677654, 'binary_precision': 0.8927973, 'binary_recall': 0.8393701, 'binary_specificity': 0.90199083, 'binary_f1_score': 0.8652597}
confusion matrix:
     0    1
0  589   64
1  102  533
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.87906975, 'precision': 0.8802543, 'recall': 0.8790698, 'specificity': 0.8790698, 'f1': 0.8789755, 'auroc': 0.9398594, 'binary_precision': 0.9014778, 'binary_recall': 0.8511628, 'binary_specificity': 0.90697676, 'binary_f1_score': 0.8755981}
confusion matrix:
     0    1
0  195   20
1   32  183
new oracle model saved
better model found
persisted
after epoch: 8,now: 2024-07-22 23:26:41.982613,epoch time: 0:01:29.714404,used: 0:12:30.225976,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_22_23_14_11_seed_0_22755942
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9827474, 'precision': 0.98307556, 'recall': 0.9829607, 'specificity': 0.9829607, 'f1': 0.9827472, 'auroc': 0.99959135, 'binary_precision': 0.9993355, 'binary_recall': 0.966581, 'binary_specificity': 0.99934036, 'binary_f1_score': 0.98268545}
confusion matrix:
      0     1
0  1515     1
1    52  1504
---- Validation: 
scalar performance:
{'acc': 0.70652175, 'precision': 0.793983, 'recall': 0.70266604, 'specificity': 0.70266604, 'f1': 0.6804347, 'auroc': 0.9223758, 'binary_precision': 0.9508772, 'binary_recall': 0.42677164, 'binary_specificity': 0.9785605, 'binary_f1_score': 0.5891304}
confusion matrix:
     0    1
0  639   14
1  364  271
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7790698, 'precision': 0.8367795, 'recall': 0.7790698, 'specificity': 0.7790698, 'f1': 0.7691816, 'auroc': 0.92512715, 'binary_precision': 0.97619045, 'binary_recall': 0.572093, 'binary_specificity': 0.9860465, 'binary_f1_score': 0.7214076}
confusion matrix:
     0    1
0  212    3
1   92  123
early stop counter: 1
val acc:0.70652174949646, best validation acc: 0.8711180090904236, corresponding to test acc:                         0.8790697455406189 / 0.8790697455406189
after epoch: 9,now: 2024-07-22 23:28:14.061838,epoch time: 0:01:32.079225,used: 0:14:02.305201,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_22_23_14_11_seed_0_22755942
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.96972656, 'precision': 0.971784, 'recall': 0.96934736, 'specificity': 0.96934736, 'f1': 0.96967137, 'auroc': 0.99959517, 'binary_precision': 0.94356793, 'binary_recall': 1.0, 'binary_specificity': 0.9386948, 'binary_f1_score': 0.97096467}
confusion matrix:
      0     1
0  1424    93
1     0  1555
---- Validation: 
scalar performance:
{'acc': 0.8586956, 'precision': 0.86013913, 'recall': 0.8591455, 'specificity': 0.8591455, 'f1': 0.85863805, 'auroc': 0.9169382, 'binary_precision': 0.83357877, 'binary_recall': 0.8913386, 'binary_specificity': 0.8269525, 'binary_f1_score': 0.8614916}
confusion matrix:
     0    1
0  540  113
1   69  566
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.84418607, 'precision': 0.84635144, 'recall': 0.84418607, 'specificity': 0.84418607, 'f1': 0.8439421, 'auroc': 0.9349487, 'binary_precision': 0.8189655, 'binary_recall': 0.88372093, 'binary_specificity': 0.80465114, 'binary_f1_score': 0.85011184}
confusion matrix:
     0    1
0  173   42
1   25  190
early stop counter: 2
val acc:0.8586956262588501, best validation acc: 0.8711180090904236, corresponding to test acc:                         0.8790697455406189 / 0.8790697455406189
after epoch: 10,now: 2024-07-22 23:29:43.695585,epoch time: 0:01:29.633747,used: 0:15:31.938948,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_22_23_14_11_seed_0_22755942
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.98079425, 'precision': 0.98120356, 'recall': 0.9810128, 'specificity': 0.9810128, 'f1': 0.9807937, 'auroc': 0.9986205, 'binary_precision': 0.99866664, 'binary_recall': 0.96334404, 'binary_specificity': 0.9986816, 'binary_f1_score': 0.98068744}
confusion matrix:
      0     1
0  1515     2
1    57  1498
---- Validation: 
scalar performance:
{'acc': 0.6840062, 'precision': 0.78555346, 'recall': 0.679788, 'specificity': 0.679788, 'f1': 0.6500895, 'auroc': 0.92952454, 'binary_precision': 0.95238096, 'binary_recall': 0.37795275, 'binary_specificity': 0.9816233, 'binary_f1_score': 0.54115}
confusion matrix:
     0    1
0  641   12
1  395  240
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.75116277, 'precision': 0.8338509, 'recall': 0.75116277, 'specificity': 0.75116277, 'f1': 0.73473775, 'auroc': 0.91723096, 'binary_precision': 1.0, 'binary_recall': 0.5023256, 'binary_specificity': 1.0, 'binary_f1_score': 0.6687307}
confusion matrix:
     0    1
0  215    0
1  107  108
early stop counter: 3
val acc:0.6840062141418457, best validation acc: 0.8711180090904236, corresponding to test acc:                         0.8790697455406189 / 0.8790697455406189
after epoch: 11,now: 2024-07-22 23:31:12.752869,epoch time: 0:01:29.057284,used: 0:17:00.996232,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_22_23_14_11_seed_0_22755942
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9811198, 'precision': 0.9816079, 'recall': 0.9809382, 'specificity': 0.9809382, 'f1': 0.98110634, 'auroc': 0.9992547, 'binary_precision': 0.9693175, 'binary_recall': 0.99421966, 'binary_specificity': 0.9676568, 'binary_f1_score': 0.98161066}
confusion matrix:
      0     1
0  1466    49
1     9  1548
---- Validation: 
scalar performance:
{'acc': 0.80124223, 'precision': 0.8028544, 'recall': 0.8007042, 'specificity': 0.8007042, 'f1': 0.80075026, 'auroc': 0.87599325, 'binary_precision': 0.82173175, 'binary_recall': 0.7622047, 'binary_specificity': 0.83920366, 'binary_f1_score': 0.7908497}
confusion matrix:
     0    1
0  548  105
1  151  484
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8511628, 'precision': 0.8536415, 'recall': 0.8511628, 'specificity': 0.8511628, 'f1': 0.8509015, 'auroc': 0.9298432, 'binary_precision': 0.82403433, 'binary_recall': 0.89302325, 'binary_specificity': 0.80930233, 'binary_f1_score': 0.85714287}
confusion matrix:
     0    1
0  174   41
1   23  192
early stop counter: 4
val acc:0.8012422323226929, best validation acc: 0.8711180090904236, corresponding to test acc:                         0.8790697455406189 / 0.8790697455406189
after epoch: 12,now: 2024-07-22 23:32:46.139063,epoch time: 0:01:33.386194,used: 0:18:34.382426,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_22_23_14_11_seed_0_22755942
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9899089, 'precision': 0.9899235, 'recall': 0.99000466, 'specificity': 0.99000466, 'f1': 0.9899086, 'auroc': 0.9995799, 'binary_precision': 0.99739075, 'binary_recall': 0.98264784, 'binary_specificity': 0.9973615, 'binary_f1_score': 0.9899644}
confusion matrix:
      0     1
0  1512     4
1    27  1529
---- Validation: 
scalar performance:
{'acc': 0.73447204, 'precision': 0.78967136, 'recall': 0.73138154, 'specificity': 0.73138154, 'f1': 0.7194543, 'auroc': 0.91258514, 'binary_precision': 0.91267604, 'binary_recall': 0.5102362, 'binary_specificity': 0.9525268, 'binary_f1_score': 0.6545454}
confusion matrix:
     0    1
0  622   31
1  311  324
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7744186, 'precision': 0.83758247, 'recall': 0.7744186, 'specificity': 0.7744186, 'f1': 0.76334894, 'auroc': 0.9180963, 'binary_precision': 0.9836066, 'binary_recall': 0.55813956, 'binary_specificity': 0.9906977, 'binary_f1_score': 0.71216625}
confusion matrix:
     0    1
0  213    2
1   95  120
early stop counter: 5
val acc:0.7344720363616943, best validation acc: 0.8711180090904236, corresponding to test acc:                         0.8790697455406189 / 0.8790697455406189
after epoch: 13,now: 2024-07-22 23:34:16.091784,epoch time: 0:01:29.952721,used: 0:20:04.335147,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_22_23_14_11_seed_0_22755942
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.98795575, 'precision': 0.9879863, 'recall': 0.9881003, 'specificity': 0.9881003, 'f1': 0.9879553, 'auroc': 0.99906766, 'binary_precision': 0.99738735, 'binary_recall': 0.97884613, 'binary_specificity': 0.9973545, 'binary_f1_score': 0.9880298}
confusion matrix:
      0     1
0  1508     4
1    33  1527
---- Validation: 
scalar performance:
{'acc': 0.6708075, 'precision': 0.7752871, 'recall': 0.6664456, 'specificity': 0.6664456, 'f1': 0.6328778, 'auroc': 0.9294112, 'binary_precision': 0.9414226, 'binary_recall': 0.35433072, 'binary_specificity': 0.9785605, 'binary_f1_score': 0.5148742}
confusion matrix:
     0    1
0  639   14
1  410  225
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5767442, 'precision': 0.77078086, 'recall': 0.5767442, 'specificity': 0.5767442, 'f1': 0.4843717, 'auroc': 0.92941046, 'binary_precision': 1.0, 'binary_recall': 0.15348837, 'binary_specificity': 1.0, 'binary_f1_score': 0.26612902}
confusion matrix:
     0   1
0  215   0
1  182  33
early stop counter: 6
val acc:0.6708074808120728, best validation acc: 0.8711180090904236, corresponding to test acc:                         0.8790697455406189 / 0.8790697455406189
after epoch: 14,now: 2024-07-22 23:35:45.483612,epoch time: 0:01:29.391828,used: 0:21:33.726975,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_22_23_14_11_seed_0_22755942
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9788411, 'precision': 0.9797311, 'recall': 0.97858346, 'specificity': 0.97858346, 'f1': 0.97881913, 'auroc': 0.999465, 'binary_precision': 0.9622057, 'binary_recall': 0.997431, 'binary_specificity': 0.959736, 'binary_f1_score': 0.9795017}
confusion matrix:
      0     1
0  1454    61
1     4  1553
---- Validation: 
scalar performance:
{'acc': 0.8470497, 'precision': 0.8502165, 'recall': 0.8463795, 'specificity': 0.8463795, 'f1': 0.8465011, 'auroc': 0.90925467, 'binary_precision': 0.8802083, 'binary_recall': 0.7984252, 'binary_specificity': 0.89433384, 'binary_f1_score': 0.83732456}
confusion matrix:
     0    1
0  584   69
1  128  507
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.88139534, 'precision': 0.8972868, 'recall': 0.88139534, 'specificity': 0.88139534, 'f1': 0.8801973, 'auroc': 0.9571444, 'binary_precision': 0.9767442, 'binary_recall': 0.7813954, 'binary_specificity': 0.98139536, 'binary_f1_score': 0.86821705}
confusion matrix:
     0    1
0  211    4
1   47  168
new oracle model saved
early stop counter: 7
val acc:0.8470497131347656, best validation acc: 0.8711180090904236, corresponding to test acc:                         0.8790697455406189 / 0.8813953399658203
after epoch: 15,now: 2024-07-22 23:37:18.607649,epoch time: 0:01:33.124037,used: 0:23:06.851012,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_22_23_14_11_seed_0_22755942
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9866536, 'precision': 0.98671234, 'recall': 0.9867954, 'specificity': 0.9867954, 'f1': 0.98665345, 'auroc': 0.99959856, 'binary_precision': 0.9967256, 'binary_recall': 0.9768934, 'binary_specificity': 0.9966975, 'binary_f1_score': 0.9867099}
confusion matrix:
      0     1
0  1509     5
1    36  1522
---- Validation: 
scalar performance:
{'acc': 0.6459627, 'precision': 0.75403893, 'recall': 0.6413356, 'specificity': 0.6413356, 'f1': 0.59966743, 'auroc': 0.88537216, 'binary_precision': 0.9162791, 'binary_recall': 0.31023622, 'binary_specificity': 0.97243494, 'binary_f1_score': 0.4635294}
confusion matrix:
     0    1
0  635   18
1  438  197
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.68139535, 'precision': 0.7834302, 'recall': 0.68139535, 'specificity': 0.68139535, 'f1': 0.649885, 'auroc': 0.89298, 'binary_precision': 0.95348835, 'binary_recall': 0.38139534, 'binary_specificity': 0.98139536, 'binary_f1_score': 0.54485047}
confusion matrix:
     0   1
0  211   4
1  133  82
early stop counter: 8
val acc:0.6459627151489258, best validation acc: 0.8711180090904236, corresponding to test acc:                         0.8790697455406189 / 0.8813953399658203
after epoch: 16,now: 2024-07-22 23:38:48.444466,epoch time: 0:01:29.836817,used: 0:24:36.687829,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_22_23_14_11_seed_0_22755942
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.99121094, 'precision': 0.99141836, 'recall': 0.99110687, 'specificity': 0.99110687, 'f1': 0.991207, 'auroc': 0.99988127, 'binary_precision': 0.98417723, 'binary_recall': 0.99871546, 'binary_specificity': 0.98349833, 'binary_f1_score': 0.991393}
confusion matrix:
      0     1
0  1490    25
1     2  1555
---- Validation: 
scalar performance:
{'acc': 0.8501553, 'precision': 0.85944873, 'recall': 0.8490299, 'specificity': 0.8490299, 'f1': 0.8488652, 'auroc': 0.91985744, 'binary_precision': 0.9138577, 'binary_recall': 0.76850396, 'binary_specificity': 0.9295559, 'binary_f1_score': 0.8349017}
confusion matrix:
     0    1
0  607   46
1  147  488
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8744186, 'precision': 0.8907855, 'recall': 0.8744186, 'specificity': 0.8744186, 'f1': 0.8730898, 'auroc': 0.9414386, 'binary_precision': 0.9707602, 'binary_recall': 0.772093, 'binary_specificity': 0.9767442, 'binary_f1_score': 0.86010367}
confusion matrix:
     0    1
0  210    5
1   49  166
early stop counter: 9
val acc:0.8501552939414978, best validation acc: 0.8711180090904236, corresponding to test acc:                         0.8790697455406189 / 0.8813953399658203
after epoch: 17,now: 2024-07-22 23:40:17.674649,epoch time: 0:01:29.230183,used: 0:26:05.918012,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_22_23_14_11_seed_0_22755942
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9899089, 'precision': 0.98988724, 'recall': 0.98993814, 'specificity': 0.98993814, 'f1': 0.9899075, 'auroc': 0.9997524, 'binary_precision': 0.9922581, 'binary_recall': 0.987797, 'binary_specificity': 0.9920792, 'binary_f1_score': 0.99002254}
confusion matrix:
      0     1
0  1503    12
1    19  1538
---- Validation: 
scalar performance:
{'acc': 0.68167704, 'precision': 0.78783727, 'recall': 0.6773824, 'specificity': 0.6773824, 'f1': 0.64617276, 'auroc': 0.91704607, 'binary_precision': 0.9591837, 'binary_recall': 0.37007874, 'binary_specificity': 0.9846861, 'binary_f1_score': 0.5340909}
confusion matrix:
     0    1
0  643   10
1  400  235
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6581395, 'precision': 0.7969613, 'recall': 0.6581395, 'specificity': 0.6581395, 'f1': 0.6128997, 'auroc': 0.908318, 'binary_precision': 1.0, 'binary_recall': 0.31627908, 'binary_specificity': 1.0, 'binary_f1_score': 0.4805654}
confusion matrix:
     0   1
0  215   0
1  147  68
early stop counter: 10
val acc:0.6816770434379578, best validation acc: 0.8711180090904236, corresponding to test acc:                         0.8790697455406189 / 0.8813953399658203
after epoch: 18,now: 2024-07-22 23:41:48.624126,epoch time: 0:01:30.949477,used: 0:27:36.867489,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_22_23_14_11_seed_0_22755942
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9895833, 'precision': 0.9895973, 'recall': 0.98967034, 'specificity': 0.98967034, 'f1': 0.989583, 'auroc': 0.99970967, 'binary_precision': 0.99673843, 'binary_recall': 0.98263663, 'binary_specificity': 0.99670404, 'binary_f1_score': 0.98963726}
confusion matrix:
      0     1
0  1512     5
1    27  1528
---- Validation: 
scalar performance:
{'acc': 0.71506214, 'precision': 0.79982275, 'recall': 0.7113058, 'specificity': 0.7113058, 'f1': 0.69106114, 'auroc': 0.9345745, 'binary_precision': 0.9557823, 'binary_recall': 0.4425197, 'binary_specificity': 0.98009187, 'binary_f1_score': 0.6049516}
confusion matrix:
     0    1
0  640   13
1  354  281
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7023256, 'precision': 0.7938727, 'recall': 0.7023256, 'specificity': 0.7023256, 'f1': 0.67718476, 'auroc': 0.90430504, 'binary_precision': 0.95789474, 'binary_recall': 0.4232558, 'binary_specificity': 0.98139536, 'binary_f1_score': 0.5870968}
confusion matrix:
     0   1
0  211   4
1  124  91
early stop counter: 11
val acc:0.715062141418457, best validation acc: 0.8711180090904236, corresponding to test acc:                         0.8790697455406189 / 0.8813953399658203
after epoch: 19,now: 2024-07-22 23:43:19.686642,epoch time: 0:01:31.062516,used: 0:29:07.930005,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_22_23_14_11_seed_0_22755942
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.99283856, 'precision': 0.992816, 'recall': 0.99287283, 'specificity': 0.99287283, 'f1': 0.99283767, 'auroc': 0.99934584, 'binary_precision': 0.99548095, 'binary_recall': 0.9903661, 'binary_specificity': 0.99537957, 'binary_f1_score': 0.99291694}
confusion matrix:
      0     1
0  1508     7
1    15  1542
---- Validation: 
scalar performance:
{'acc': 0.7088509, 'precision': 0.791008, 'recall': 0.7050934, 'specificity': 0.7050934, 'f1': 0.68432677, 'auroc': 0.9287691, 'binary_precision': 0.9421769, 'binary_recall': 0.43622047, 'binary_specificity': 0.9739663, 'binary_f1_score': 0.5963401}
confusion matrix:
     0    1
0  636   17
1  358  277
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8372093, 'precision': 0.8636756, 'recall': 0.83720934, 'specificity': 0.83720934, 'f1': 0.83419263, 'auroc': 0.9186209, 'binary_precision': 0.96178347, 'binary_recall': 0.7023256, 'binary_specificity': 0.97209305, 'binary_f1_score': 0.811828}
confusion matrix:
     0    1
0  209    6
1   64  151
early stop counter: 12
val acc:0.7088509202003479, best validation acc: 0.8711180090904236, corresponding to test acc:                         0.8790697455406189 / 0.8813953399658203
after epoch: 20,now: 2024-07-22 23:44:48.998452,epoch time: 0:01:29.311810,used: 0:30:37.241815,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_22_23_14_11_seed_0_22755942
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.99283856, 'precision': 0.9928385, 'recall': 0.99292207, 'specificity': 0.99292207, 'f1': 0.99283826, 'auroc': 0.9994289, 'binary_precision': 0.99934894, 'binary_recall': 0.98650384, 'binary_specificity': 0.99934036, 'binary_f1_score': 0.9928849}
confusion matrix:
      0     1
0  1515     1
1    21  1535
---- Validation: 
scalar performance:
{'acc': 0.70652175, 'precision': 0.793983, 'recall': 0.70266604, 'specificity': 0.70266604, 'f1': 0.6804347, 'auroc': 0.93774825, 'binary_precision': 0.9508772, 'binary_recall': 0.42677164, 'binary_specificity': 0.9785605, 'binary_f1_score': 0.5891304}
confusion matrix:
     0    1
0  639   14
1  364  271
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6883721, 'precision': 0.7969309, 'recall': 0.6883721, 'specificity': 0.6883721, 'f1': 0.6570238, 'auroc': 0.9207139, 'binary_precision': 0.9764706, 'binary_recall': 0.3860465, 'binary_specificity': 0.9906977, 'binary_f1_score': 0.5533333}
confusion matrix:
     0   1
0  213   2
1  132  83
early stop counter: 13
val acc:0.70652174949646, best validation acc: 0.8711180090904236, corresponding to test acc:                         0.8790697455406189 / 0.8813953399658203
after epoch: 21,now: 2024-07-22 23:46:18.207180,epoch time: 0:01:29.208728,used: 0:32:06.450543,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_22_23_14_11_seed_0_22755942
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9902344, 'precision': 0.9902523, 'recall': 0.9902158, 'specificity': 0.9902158, 'f1': 0.99023235, 'auroc': 0.99964094, 'binary_precision': 0.98910254, 'binary_recall': 0.9916452, 'binary_specificity': 0.9887863, 'binary_f1_score': 0.99037224}
confusion matrix:
      0     1
0  1499    17
1    13  1543
---- Validation: 
scalar performance:
{'acc': 0.8035714, 'precision': 0.8378872, 'recall': 0.80133003, 'specificity': 0.80133003, 'f1': 0.7976129, 'auroc': 0.92556524, 'binary_precision': 0.9421296, 'binary_recall': 0.6409449, 'binary_specificity': 0.96171516, 'binary_f1_score': 0.7628866}
confusion matrix:
     0    1
0  628   25
1  228  407
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.82093024, 'precision': 0.8627494, 'recall': 0.82093024, 'specificity': 0.82093024, 'f1': 0.81561613, 'auroc': 0.9315306, 'binary_precision': 0.9859155, 'binary_recall': 0.6511628, 'binary_specificity': 0.9906977, 'binary_f1_score': 0.78431374}
confusion matrix:
     0    1
0  213    2
1   75  140
early stop counter: 14
val acc:0.8035714030265808, best validation acc: 0.8711180090904236, corresponding to test acc:                         0.8790697455406189 / 0.8813953399658203
after epoch: 22,now: 2024-07-22 23:47:49.576063,epoch time: 0:01:31.368883,used: 0:33:37.819426,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_22_23_14_11_seed_0_22755942
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.976237, 'precision': 0.9772906, 'recall': 0.9759521, 'specificity': 0.9759521, 'f1': 0.97620916, 'auroc': 0.9987892, 'binary_precision': 0.9580247, 'binary_recall': 0.9967887, 'binary_specificity': 0.9551155, 'binary_f1_score': 0.97702235}
confusion matrix:
      0     1
0  1447    68
1     5  1552
---- Validation: 
scalar performance:
{'acc': 0.82220495, 'precision': 0.84999156, 'recall': 0.8202276, 'specificity': 0.8202276, 'f1': 0.817946, 'auroc': 0.93627477, 'binary_precision': 0.9451754, 'binary_recall': 0.67874014, 'binary_specificity': 0.96171516, 'binary_f1_score': 0.7901008}
confusion matrix:
     0    1
0  628   25
1  204  431
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.82790697, 'precision': 0.86435425, 'recall': 0.82790697, 'specificity': 0.82790697, 'f1': 0.8234929, 'auroc': 0.9121903, 'binary_precision': 0.97959185, 'binary_recall': 0.66976744, 'binary_specificity': 0.9860465, 'binary_f1_score': 0.79558015}
confusion matrix:
     0    1
0  212    3
1   71  144
early stop counter: 15
val acc:0.8222049474716187, best validation acc: 0.8711180090904236, corresponding to test acc:                         0.8790697455406189 / 0.8813953399658203
after epoch: 23,now: 2024-07-22 23:49:16.862463,epoch time: 0:01:27.286400,used: 0:35:05.105826,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_22_23_14_11_seed_0_22755942
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9863281, 'precision': 0.98644865, 'recall': 0.9862507, 'specificity': 0.9862507, 'f1': 0.9863229, 'auroc': 0.99932384, 'binary_precision': 0.9815756, 'binary_recall': 0.99165595, 'binary_specificity': 0.98084545, 'binary_f1_score': 0.98659}
confusion matrix:
      0     1
0  1485    29
1    13  1545
---- Validation: 
scalar performance:
{'acc': 0.8586956, 'precision': 0.8662773, 'recall': 0.8576913, 'specificity': 0.8576913, 'f1': 0.8576951, 'auroc': 0.93282425, 'binary_precision': 0.9155963, 'binary_recall': 0.78582674, 'binary_specificity': 0.9295559, 'binary_f1_score': 0.84576267}
confusion matrix:
     0    1
0  607   46
1  136  499
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7837209, 'precision': 0.8254665, 'recall': 0.7837209, 'specificity': 0.7837209, 'f1': 0.77655596, 'auroc': 0.9136398, 'binary_precision': 0.942029, 'binary_recall': 0.60465115, 'binary_specificity': 0.96279067, 'binary_f1_score': 0.7365439}
confusion matrix:
     0    1
0  207    8
1   85  130
early stop counter: 16
val acc:0.8586956262588501, best validation acc: 0.8711180090904236, corresponding to test acc:                         0.8790697455406189 / 0.8813953399658203
after epoch: 24,now: 2024-07-22 23:50:43.644816,epoch time: 0:01:26.782353,used: 0:36:31.888179,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_22_23_14_11_seed_0_22755942
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.98502606, 'precision': 0.98526585, 'recall': 0.985228, 'specificity': 0.985228, 'f1': 0.985026, 'auroc': 0.99965453, 'binary_precision': 1.0, 'binary_recall': 0.970456, 'binary_specificity': 1.0, 'binary_f1_score': 0.9850065}
confusion matrix:
      0     1
0  1515     0
1    46  1511
---- Validation: 
scalar performance:
{'acc': 0.6886646, 'precision': 0.7800483, 'recall': 0.684621, 'specificity': 0.684621, 'f1': 0.6581178, 'auroc': 0.91986895, 'binary_precision': 0.9365672, 'binary_recall': 0.3952756, 'binary_specificity': 0.9739663, 'binary_f1_score': 0.5559247}
confusion matrix:
     0    1
0  636   17
1  384  251
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7232558, 'precision': 0.8127273, 'recall': 0.7232558, 'specificity': 0.7232558, 'f1': 0.7019368, 'auroc': 0.9176853, 'binary_precision': 0.98, 'binary_recall': 0.45581394, 'binary_specificity': 0.9906977, 'binary_f1_score': 0.62222224}
confusion matrix:
     0   1
0  213   2
1  117  98
early stop counter: 17
val acc:0.6886646151542664, best validation acc: 0.8711180090904236, corresponding to test acc:                         0.8790697455406189 / 0.8813953399658203
after epoch: 25,now: 2024-07-22 23:52:11.057980,epoch time: 0:01:27.413164,used: 0:37:59.301343,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_22_23_14_11_seed_0_22755942
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9921875, 'precision': 0.992174, 'recall': 0.9922024, 'specificity': 0.9922024, 'f1': 0.99218655, 'auroc': 0.9998046, 'binary_precision': 0.99355257, 'binary_recall': 0.9909968, 'binary_specificity': 0.993408, 'binary_f1_score': 0.9922731}
confusion matrix:
      0     1
0  1507    10
1    14  1541
---- Validation: 
scalar performance:
{'acc': 0.8113354, 'precision': 0.8338163, 'recall': 0.8095079, 'specificity': 0.8095079, 'f1': 0.8074484, 'auroc': 0.91029954, 'binary_precision': 0.9170213, 'binary_recall': 0.67874014, 'binary_specificity': 0.94027567, 'binary_f1_score': 0.7800905}
confusion matrix:
     0    1
0  614   39
1  204  431
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8488372, 'precision': 0.8732639, 'recall': 0.8488372, 'specificity': 0.8488372, 'f1': 0.846323, 'auroc': 0.9503299, 'binary_precision': 0.96875, 'binary_recall': 0.7209302, 'binary_specificity': 0.9767442, 'binary_f1_score': 0.82666665}
confusion matrix:
     0    1
0  210    5
1   60  155
early stop counter: 18
val acc:0.8113353848457336, best validation acc: 0.8711180090904236, corresponding to test acc:                         0.8790697455406189 / 0.8813953399658203
after epoch: 26,now: 2024-07-22 23:53:37.851337,epoch time: 0:01:26.793357,used: 0:39:26.094700,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_22_23_14_11_seed_0_22755942
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.991862, 'precision': 0.9919331, 'recall': 0.9918115, 'specificity': 0.9918115, 'f1': 0.99185956, 'auroc': 0.9996944, 'binary_precision': 0.9885204, 'binary_recall': 0.9955042, 'binary_specificity': 0.9881188, 'binary_f1_score': 0.99200004}
confusion matrix:
      0     1
0  1497    18
1     7  1550
---- Validation: 
scalar performance:
{'acc': 0.8509317, 'precision': 0.8650588, 'recall': 0.84955686, 'specificity': 0.84955686, 'f1': 0.8490975, 'auroc': 0.9242792, 'binary_precision': 0.9334638, 'binary_recall': 0.7511811, 'binary_specificity': 0.9479326, 'binary_f1_score': 0.83246076}
confusion matrix:
     0    1
0  619   34
1  158  477
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8534884, 'precision': 0.876359, 'recall': 0.8534883, 'specificity': 0.8534883, 'f1': 0.85122824, 'auroc': 0.92210376, 'binary_precision': 0.9691358, 'binary_recall': 0.73023254, 'binary_specificity': 0.9767442, 'binary_f1_score': 0.8328913}
confusion matrix:
     0    1
0  210    5
1   58  157
early stop counter: 19
val acc:0.850931704044342, best validation acc: 0.8711180090904236, corresponding to test acc:                         0.8790697455406189 / 0.8813953399658203
after epoch: 27,now: 2024-07-22 23:55:04.511596,epoch time: 0:01:26.660259,used: 0:40:52.754959,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_22_23_14_11_seed_0_22755942
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.9941406, 'precision': 0.9942415, 'recall': 0.9940772, 'specificity': 0.9940772, 'f1': 0.99413866, 'auroc': 0.99990547, 'binary_precision': 0.9898154, 'binary_recall': 0.99871546, 'binary_specificity': 0.98943895, 'binary_f1_score': 0.99424547}
confusion matrix:
      0     1
0  1499    16
1     2  1555
---- Validation: 
scalar performance:
{'acc': 0.8470497, 'precision': 0.861705, 'recall': 0.84564155, 'specificity': 0.84564155, 'f1': 0.84508634, 'auroc': 0.9287896, 'binary_precision': 0.93110234, 'binary_recall': 0.74488187, 'binary_specificity': 0.94640124, 'binary_f1_score': 0.82764655}
confusion matrix:
     0    1
0  618   35
1  162  473
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8534884, 'precision': 0.86968327, 'recall': 0.8534884, 'specificity': 0.8534884, 'f1': 0.851866, 'auroc': 0.9481882, 'binary_precision': 0.9470588, 'binary_recall': 0.74883723, 'binary_specificity': 0.95813954, 'binary_f1_score': 0.8363636}
confusion matrix:
     0    1
0  206    9
1   54  161
early stop counter: 20
val acc:0.8470497131347656, best validation acc: 0.8711180090904236, corresponding to test acc:                         0.8790697455406189 / 0.8813953399658203
after epoch: 28,now: 2024-07-22 23:56:31.415696,epoch time: 0:01:26.904100,used: 0:42:19.659059,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_22_23_14_11_seed_0_22755942
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.98046875, 'precision': 0.98067665, 'recall': 0.9803637, 'specificity': 0.9803637, 'f1': 0.9804603, 'auroc': 0.9990814, 'binary_precision': 0.9734177, 'binary_recall': 0.9884319, 'binary_specificity': 0.9722955, 'binary_f1_score': 0.9808673}
confusion matrix:
      0     1
0  1474    42
1    18  1538
---- Validation: 
scalar performance:
{'acc': 0.88431674, 'precision': 0.8942323, 'recall': 0.8832198, 'specificity': 0.8832198, 'f1': 0.8833542, 'auroc': 0.9376259, 'binary_precision': 0.95335823, 'binary_recall': 0.8047244, 'binary_specificity': 0.96171516, 'binary_f1_score': 0.8727583}
confusion matrix:
     0    1
0  628   25
1  124  511
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.855814, 'precision': 0.88170993, 'recall': 0.855814, 'specificity': 0.855814, 'f1': 0.8533263, 'auroc': 0.9330016, 'binary_precision': 0.9811321, 'binary_recall': 0.7255814, 'binary_specificity': 0.9860465, 'binary_f1_score': 0.8342246}
confusion matrix:
     0    1
0  212    3
1   59  156
better model found
persisted
after epoch: 29,now: 2024-07-22 23:57:57.919828,epoch time: 0:01:26.504132,used: 0:43:46.163191,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_22_23_14_11_seed_0_22755942
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.9938151, 'precision': 0.99388707, 'recall': 0.993765, 'specificity': 0.993765, 'f1': 0.9938133, 'auroc': 0.9998746, 'binary_precision': 0.9904337, 'binary_recall': 0.997431, 'binary_specificity': 0.990099, 'binary_f1_score': 0.99391997}
confusion matrix:
      0     1
0  1500    15
1     4  1553
---- Validation: 
scalar performance:
{'acc': 0.8385093, 'precision': 0.8603756, 'recall': 0.8367848, 'specificity': 0.8367848, 'f1': 0.8355073, 'auroc': 0.93803096, 'binary_precision': 0.94572026, 'binary_recall': 0.7133858, 'binary_specificity': 0.96018374, 'binary_f1_score': 0.81328547}
confusion matrix:
     0    1
0  627   26
1  182  453
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8627907, 'precision': 0.88819444, 'recall': 0.8627907, 'specificity': 0.8627907, 'f1': 0.86050856, 'auroc': 0.9430395, 'binary_precision': 0.9875, 'binary_recall': 0.7348837, 'binary_specificity': 0.9906977, 'binary_f1_score': 0.8426667}
confusion matrix:
     0    1
0  213    2
1   57  158
early stop counter: 1
val acc:0.8385093212127686, best validation acc: 0.8843167424201965, corresponding to test acc:                         0.8558139801025391 / 0.8813953399658203
after epoch: 30,now: 2024-07-22 23:59:24.318613,epoch time: 0:01:26.398785,used: 0:45:12.561976,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_22_23_14_11_seed_0_22755942
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 0:45:12.561976 at 2024-07-22 23:59:24.318613
persisted model performance metric: 

scalar performance:
{'acc': 0.855814, 'precision': 0.88170993, 'recall': 0.855814, 'specificity': 0.855814, 'f1': 0.8533263, 'auroc': 0.9330016, 'binary_precision': 0.9811321, 'binary_recall': 0.7255814, 'binary_specificity': 0.9860465, 'binary_f1_score': 0.8342246}
confusion matrix:
     0    1
0  212    3
1   59  156
oracle model performance metric: 

scalar performance:
{'acc': 0.88139534, 'precision': 0.8972868, 'recall': 0.88139534, 'specificity': 0.88139534, 'f1': 0.8801973, 'auroc': 0.9571444, 'binary_precision': 0.9767442, 'binary_recall': 0.7813954, 'binary_specificity': 0.98139536, 'binary_f1_score': 0.86821705}
confusion matrix:
     0    1
0  211    4
1   47  168
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_higherregularization_irm_dial_lr1e5_bs16_nofreeze_2024-07-22_16-00-54/rule_results/0.csv
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_higherregularization_irm_dial_lr1e5_bs16_nofreeze_2024-07-22_16-00-54/rule_results/0.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_higherregularization_irm_dial_lr1e5_bs16_nofreeze_2024-07-22_16-00-54/confusion_matrix/0.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 455454 KiB |  13219 MiB |  74168 GiB |  74168 GiB |
|       from large pool | 414861 KiB |  13181 MiB |  73287 GiB |  73286 GiB |
|       from small pool |  40592 KiB |     56 MiB |    881 GiB |    881 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 455454 KiB |  13219 MiB |  74168 GiB |  74168 GiB |
|       from large pool | 414861 KiB |  13181 MiB |  73287 GiB |  73286 GiB |
|       from small pool |  40592 KiB |     56 MiB |    881 GiB |    881 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 447480 KiB |  13213 MiB |  73658 GiB |  73658 GiB |
|       from large pool | 407075 KiB |  13175 MiB |  72779 GiB |  72778 GiB |
|       from small pool |  40405 KiB |     56 MiB |    879 GiB |    879 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  14470 MiB |  14470 MiB |  14470 MiB |      0 B   |
|       from large pool |  14404 MiB |  14404 MiB |  14404 MiB |      0 B   |
|       from small pool |     66 MiB |     66 MiB |     66 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory | 474338 KiB |   1229 MiB |  52507 GiB |  52507 GiB |
|       from large pool | 461682 KiB |   1224 MiB |  51622 GiB |  51622 GiB |
|       from small pool |  12655 KiB |     17 MiB |    885 GiB |    885 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    1298    |    2594    |   13012 K  |   13010 K  |
|       from large pool |     187    |    1413    |    6639 K  |    6639 K  |
|       from small pool |    1111    |    1407    |    6372 K  |    6371 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    1298    |    2594    |   13012 K  |   13010 K  |
|       from large pool |     187    |    1413    |    6639 K  |    6639 K  |
|       from small pool |    1111    |    1407    |    6372 K  |    6371 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     634    |     634    |     634    |       0    |
|       from large pool |     601    |     601    |     601    |       0    |
|       from small pool |      33    |      33    |      33    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     103    |     646    |    9131 K  |    9131 K  |
|       from large pool |      39    |     600    |    5427 K  |    5427 K  |
|       from small pool |      64    |     234    |    3703 K  |    3703 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13219 MiB |  74168 GiB |  74168 GiB |
|       from large pool |  16640 KiB |  13181 MiB |  73287 GiB |  73287 GiB |
|       from small pool |      0 KiB |     56 MiB |    881 GiB |    881 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13219 MiB |  74168 GiB |  74168 GiB |
|       from large pool |  16640 KiB |  13181 MiB |  73287 GiB |  73287 GiB |
|       from small pool |      0 KiB |     56 MiB |    881 GiB |    881 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13213 MiB |  73658 GiB |  73658 GiB |
|       from large pool |  16640 KiB |  13175 MiB |  72779 GiB |  72779 GiB |
|       from small pool |      0 KiB |     56 MiB |    879 GiB |    879 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    908 MiB |  14470 MiB |  14470 MiB |  13562 MiB |
|       from large pool |    856 MiB |  14404 MiB |  14404 MiB |  13548 MiB |
|       from small pool |     52 MiB |     66 MiB |     66 MiB |     14 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1229 MiB |  52508 GiB |  52508 GiB |
|       from large pool |  24320 KiB |   1224 MiB |  51622 GiB |  51622 GiB |
|       from small pool |      0 KiB |     43 MiB |    885 GiB |    885 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    2594    |   13012 K  |   13012 K  |
|       from large pool |       2    |    1413    |    6639 K  |    6639 K  |
|       from small pool |       0    |    1407    |    6372 K  |    6372 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    2594    |   13012 K  |   13012 K  |
|       from large pool |       2    |    1413    |    6639 K  |    6639 K  |
|       from small pool |       0    |    1407    |    6372 K  |    6372 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      64    |     634    |     634    |     570    |
|       from large pool |      38    |     601    |     601    |     563    |
|       from small pool |      26    |      33    |      33    |       7    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |     646    |    9131 K  |    9131 K  |
|       from large pool |       4    |     600    |    5427 K  |    5427 K  |
|       from small pool |       0    |     234    |    3703 K  |    3703 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13219 MiB |  74168 GiB |  74168 GiB |
|       from large pool |  16640 KiB |  13181 MiB |  73287 GiB |  73287 GiB |
|       from small pool |      0 KiB |     56 MiB |    881 GiB |    881 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13219 MiB |  74168 GiB |  74168 GiB |
|       from large pool |  16640 KiB |  13181 MiB |  73287 GiB |  73287 GiB |
|       from small pool |      0 KiB |     56 MiB |    881 GiB |    881 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13213 MiB |  73658 GiB |  73658 GiB |
|       from large pool |  16640 KiB |  13175 MiB |  72779 GiB |  72779 GiB |
|       from small pool |      0 KiB |     56 MiB |    879 GiB |    879 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    908 MiB |  14470 MiB |  14470 MiB |  13562 MiB |
|       from large pool |    856 MiB |  14404 MiB |  14404 MiB |  13548 MiB |
|       from small pool |     52 MiB |     66 MiB |     66 MiB |     14 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1229 MiB |  52508 GiB |  52508 GiB |
|       from large pool |  24320 KiB |   1224 MiB |  51622 GiB |  51622 GiB |
|       from small pool |      0 KiB |     43 MiB |    885 GiB |    885 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    2594    |   13012 K  |   13012 K  |
|       from large pool |       2    |    1413    |    6639 K  |    6639 K  |
|       from small pool |       0    |    1407    |    6372 K  |    6372 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    2594    |   13012 K  |   13012 K  |
|       from large pool |       2    |    1413    |    6639 K  |    6639 K  |
|       from small pool |       0    |    1407    |    6372 K  |    6372 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      64    |     634    |     634    |     570    |
|       from large pool |      38    |     601    |     601    |     563    |
|       from small pool |      26    |      33    |      33    |       7    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |     646    |    9131 K  |    9131 K  |
|       from large pool |       4    |     600    |    5427 K  |    5427 K  |
|       from small pool |       0    |     234    |    3703 K  |    3703 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'888c1ef2'
model name: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_00_00_30_seed_1_22755942

 Experiment start at: 2024-07-23 00:00:30.339861
before training, model accuracy: 0.6177777647972107
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.94628906, 'precision': 0.94917405, 'recall': 0.9467545, 'specificity': 0.9467545, 'f1': 0.9462355, 'auroc': 0.9905435, 'binary_precision': 0.98804504, 'binary_recall': 0.9047006, 'binary_specificity': 0.98880845, 'binary_f1_score': 0.9445378}
confusion matrix:
      0     1
0  1502    17
1   148  1405
---- Validation: 
scalar performance:
{'acc': 0.8142077, 'precision': 0.8146665, 'recall': 0.8145161, 'specificity': 0.8145161, 'f1': 0.8142021, 'auroc': 0.8906542, 'binary_precision': 0.79787236, 'binary_recall': 0.8333333, 'binary_specificity': 0.79569894, 'binary_f1_score': 0.8152174}
confusion matrix:
     0    1
0  518  133
1  105  525
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8111111, 'precision': 0.81882596, 'recall': 0.8111111, 'specificity': 0.8111111, 'f1': 0.8099615, 'auroc': 0.9122963, 'binary_precision': 0.7692308, 'binary_recall': 0.8888889, 'binary_specificity': 0.73333335, 'binary_f1_score': 0.82474226}
confusion matrix:
     0    1
0  165   60
1   25  200
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-23 00:02:02.318293,epoch time: 0:01:31.978432,used: 0:01:31.978432,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_00_00_30_seed_1_22755942
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9508464, 'precision': 0.9534774, 'recall': 0.9512907, 'specificity': 0.9512907, 'f1': 0.95080316, 'auroc': 0.9917245, 'binary_precision': 0.99089634, 'binary_recall': 0.9111397, 'binary_specificity': 0.9914417, 'binary_f1_score': 0.9493458}
confusion matrix:
      0     1
0  1506    13
1   138  1415
---- Validation: 
scalar performance:
{'acc': 0.8360656, 'precision': 0.8367201, 'recall': 0.83643115, 'specificity': 0.83643115, 'f1': 0.8360535, 'auroc': 0.9072318, 'binary_precision': 0.81722057, 'binary_recall': 0.85873014, 'binary_specificity': 0.8141321, 'binary_f1_score': 0.83746123}
confusion matrix:
     0    1
0  530  121
1   89  541
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.83555555, 'precision': 0.8359803, 'recall': 0.83555555, 'specificity': 0.83555555, 'f1': 0.8355036, 'auroc': 0.92397034, 'binary_precision': 0.82403433, 'binary_recall': 0.85333335, 'binary_specificity': 0.81777775, 'binary_f1_score': 0.83842796}
confusion matrix:
     0    1
0  184   41
1   33  192
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-07-23 00:03:30.714632,epoch time: 0:01:28.396339,used: 0:03:00.374771,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_00_00_30_seed_1_22755942
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.96451825, 'precision': 0.964839, 'recall': 0.9647284, 'specificity': 0.9647284, 'f1': 0.9645178, 'auroc': 0.994107, 'binary_precision': 0.9807309, 'binary_recall': 0.9485861, 'binary_specificity': 0.9808707, 'binary_f1_score': 0.9643907}
confusion matrix:
      0     1
0  1487    29
1    80  1476
---- Validation: 
scalar performance:
{'acc': 0.793911, 'precision': 0.80275774, 'recall': 0.79247314, 'specificity': 0.79247314, 'f1': 0.79179966, 'auroc': 0.8735962, 'binary_precision': 0.85057473, 'binary_recall': 0.7047619, 'binary_specificity': 0.88018435, 'binary_f1_score': 0.7708333}
confusion matrix:
     0    1
0  573   78
1  186  444
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.83111113, 'precision': 0.8371041, 'recall': 0.83111113, 'specificity': 0.83111113, 'f1': 0.8303571, 'auroc': 0.9036642, 'binary_precision': 0.8820513, 'binary_recall': 0.7644445, 'binary_specificity': 0.8977778, 'binary_f1_score': 0.8190476}
confusion matrix:
     0    1
0  202   23
1   53  172
early stop counter: 1
val acc:0.7939109802246094, best validation acc: 0.8360655903816223, corresponding to test acc:                         0.8355555534362793 / 0.8355555534362793
after epoch: 3,now: 2024-07-23 00:04:58.408824,epoch time: 0:01:27.694192,used: 0:04:28.068963,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_00_00_30_seed_1_22755942
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.97265625, 'precision': 0.9726316, 'recall': 0.97269565, 'specificity': 0.97269565, 'f1': 0.97265327, 'auroc': 0.99747634, 'binary_precision': 0.97608274, 'binary_recall': 0.96981376, 'binary_specificity': 0.97557753, 'binary_f1_score': 0.9729382}
confusion matrix:
      0     1
0  1478    37
1    47  1510
---- Validation: 
scalar performance:
{'acc': 0.85480094, 'precision': 0.86278, 'recall': 0.85358423, 'specificity': 0.85358423, 'f1': 0.85366225, 'auroc': 0.9154146, 'binary_precision': 0.9126394, 'binary_recall': 0.77936506, 'binary_specificity': 0.9278034, 'binary_f1_score': 0.84075344}
confusion matrix:
     0    1
0  604   47
1  139  491
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8711111, 'precision': 0.8753821, 'recall': 0.8711111, 'specificity': 0.8711111, 'f1': 0.8707434, 'auroc': 0.932879, 'binary_precision': 0.91542286, 'binary_recall': 0.81777775, 'binary_specificity': 0.92444444, 'binary_f1_score': 0.86384976}
confusion matrix:
     0    1
0  208   17
1   41  184
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-07-23 00:06:26.476939,epoch time: 0:01:28.068115,used: 0:05:56.137078,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_00_00_30_seed_1_22755942
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9746094, 'precision': 0.9749177, 'recall': 0.97481704, 'specificity': 0.97481704, 'f1': 0.97460914, 'auroc': 0.9978744, 'binary_precision': 0.9907039, 'binary_recall': 0.9588689, 'binary_specificity': 0.99076515, 'binary_f1_score': 0.97452646}
confusion matrix:
      0     1
0  1502    14
1    64  1492
---- Validation: 
scalar performance:
{'acc': 0.87119436, 'precision': 0.87596923, 'recall': 0.87027645, 'specificity': 0.87027645, 'f1': 0.8705554, 'auroc': 0.91164505, 'binary_precision': 0.9144385, 'binary_recall': 0.8142857, 'binary_specificity': 0.92626727, 'binary_f1_score': 0.8614609}
confusion matrix:
     0    1
0  603   48
1  117  513
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8755556, 'precision': 0.88235295, 'recall': 0.8755556, 'specificity': 0.8755556, 'f1': 0.875, 'auroc': 0.9322074, 'binary_precision': 0.93333334, 'binary_recall': 0.8088889, 'binary_specificity': 0.94222224, 'binary_f1_score': 0.8666666}
confusion matrix:
     0    1
0  212   13
1   43  182
new oracle model saved
better model found
persisted
after epoch: 5,now: 2024-07-23 00:07:55.314810,epoch time: 0:01:28.837871,used: 0:07:24.974949,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_00_00_30_seed_1_22755942
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9791667, 'precision': 0.97939694, 'recall': 0.97905874, 'specificity': 0.97905874, 'f1': 0.97915757, 'auroc': 0.99849844, 'binary_precision': 0.971537, 'binary_recall': 0.98778135, 'binary_specificity': 0.9703362, 'binary_f1_score': 0.9795918}
confusion matrix:
      0     1
0  1472    45
1    19  1536
---- Validation: 
scalar performance:
{'acc': 0.86260736, 'precision': 0.8663738, 'recall': 0.8617767, 'specificity': 0.8617767, 'f1': 0.8620281, 'auroc': 0.9136201, 'binary_precision': 0.8996479, 'binary_recall': 0.8111111, 'binary_specificity': 0.9124424, 'binary_f1_score': 0.8530885}
confusion matrix:
     0    1
0  594   57
1  119  511
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.82666665, 'precision': 0.82832694, 'recall': 0.82666665, 'specificity': 0.82666665, 'f1': 0.82644725, 'auroc': 0.91107166, 'binary_precision': 0.8516746, 'binary_recall': 0.7911111, 'binary_specificity': 0.8622222, 'binary_f1_score': 0.82027644}
confusion matrix:
     0    1
0  194   31
1   47  178
early stop counter: 1
val acc:0.8626073598861694, best validation acc: 0.8711943626403809, corresponding to test acc:                         0.8755555748939514 / 0.8755555748939514
after epoch: 6,now: 2024-07-23 00:09:23.147329,epoch time: 0:01:27.832519,used: 0:08:52.807468,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_00_00_30_seed_1_22755942
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.95996094, 'precision': 0.9624771, 'recall': 0.96047556, 'specificity': 0.96047556, 'f1': 0.9599317, 'auroc': 0.99790037, 'binary_precision': 1.0, 'binary_recall': 0.9209511, 'binary_specificity': 1.0, 'binary_f1_score': 0.9588491}
confusion matrix:
      0     1
0  1516     0
1   123  1433
---- Validation: 
scalar performance:
{'acc': 0.5604996, 'precision': 0.6697043, 'recall': 0.5537378, 'specificity': 0.5537378, 'f1': 0.4655226, 'auroc': 0.82365406, 'binary_precision': 0.8018018, 'binary_recall': 0.14126985, 'binary_specificity': 0.96620584, 'binary_f1_score': 0.24021593}
confusion matrix:
     0   1
0  629  22
1  541  89
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.80222225, 'precision': 0.81601125, 'recall': 0.80222225, 'specificity': 0.80222225, 'f1': 0.80004096, 'auroc': 0.87472594, 'binary_precision': 0.8820225, 'binary_recall': 0.69777775, 'binary_specificity': 0.9066667, 'binary_f1_score': 0.7791563}
confusion matrix:
     0    1
0  204   21
1   68  157
early stop counter: 2
val acc:0.5604996085166931, best validation acc: 0.8711943626403809, corresponding to test acc:                         0.8755555748939514 / 0.8755555748939514
after epoch: 7,now: 2024-07-23 00:10:50.890357,epoch time: 0:01:27.743028,used: 0:10:20.550496,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_00_00_30_seed_1_22755942
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.98307294, 'precision': 0.98325217, 'recall': 0.98298174, 'specificity': 0.98298174, 'f1': 0.98306644, 'auroc': 0.99905974, 'binary_precision': 0.9765377, 'binary_recall': 0.9903537, 'binary_specificity': 0.9756098, 'binary_f1_score': 0.9833972}
confusion matrix:
      0     1
0  1480    37
1    15  1540
---- Validation: 
scalar performance:
{'acc': 0.882904, 'precision': 0.88368285, 'recall': 0.8825397, 'specificity': 0.8825397, 'f1': 0.8827461, 'auroc': 0.92112255, 'binary_precision': 0.89735097, 'binary_recall': 0.86031747, 'binary_specificity': 0.9047619, 'binary_f1_score': 0.878444}
confusion matrix:
     0    1
0  589   62
1   88  542
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8511111, 'precision': 0.8516738, 'recall': 0.8511111, 'specificity': 0.8511111, 'f1': 0.85105157, 'auroc': 0.9242469, 'binary_precision': 0.8657407, 'binary_recall': 0.83111113, 'binary_specificity': 0.8711111, 'binary_f1_score': 0.8480726}
confusion matrix:
     0    1
0  196   29
1   38  187
better model found
persisted
after epoch: 8,now: 2024-07-23 00:12:19.769967,epoch time: 0:01:28.879610,used: 0:11:49.430106,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_00_00_30_seed_1_22755942
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9739583, 'precision': 0.974687, 'recall': 0.97423625, 'specificity': 0.97423625, 'f1': 0.9739556, 'auroc': 0.9983734, 'binary_precision': 0.996633, 'binary_recall': 0.9517685, 'binary_specificity': 0.99670404, 'binary_f1_score': 0.9736843}
confusion matrix:
      0     1
0  1512     5
1    75  1480
---- Validation: 
scalar performance:
{'acc': 0.81030446, 'precision': 0.8476045, 'recall': 0.8076037, 'specificity': 0.8076037, 'f1': 0.8040985, 'auroc': 0.9267616, 'binary_precision': 0.9574468, 'binary_recall': 0.64285713, 'binary_specificity': 0.97235024, 'binary_f1_score': 0.7692308}
confusion matrix:
     0    1
0  633   18
1  225  405
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.82222223, 'precision': 0.8637205, 'recall': 0.82222223, 'specificity': 0.82222223, 'f1': 0.81700253, 'auroc': 0.9168395, 'binary_precision': 0.98657715, 'binary_recall': 0.6533333, 'binary_specificity': 0.9911111, 'binary_f1_score': 0.7860963}
confusion matrix:
     0    1
0  223    2
1   78  147
early stop counter: 1
val acc:0.8103044629096985, best validation acc: 0.8829039931297302, corresponding to test acc:                         0.851111114025116 / 0.8755555748939514
after epoch: 9,now: 2024-07-23 00:13:47.494430,epoch time: 0:01:27.724463,used: 0:13:17.154569,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_00_00_30_seed_1_22755942
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.98795575, 'precision': 0.9880251, 'recall': 0.9879045, 'specificity': 0.9879045, 'f1': 0.9879521, 'auroc': 0.999326, 'binary_precision': 0.9846939, 'binary_recall': 0.9916506, 'binary_specificity': 0.9841584, 'binary_f1_score': 0.98816}
confusion matrix:
      0     1
0  1491    24
1    13  1544
---- Validation: 
scalar performance:
{'acc': 0.8813427, 'precision': 0.881328, 'recall': 0.8812852, 'specificity': 0.8812852, 'f1': 0.88130444, 'auroc': 0.92998624, 'binary_precision': 0.8805733, 'binary_recall': 0.87777776, 'binary_specificity': 0.8847926, 'binary_f1_score': 0.8791732}
confusion matrix:
     0    1
0  576   75
1   77  553
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8333333, 'precision': 0.8344498, 'recall': 0.8333333, 'specificity': 0.8333333, 'f1': 0.83319414, 'auroc': 0.92337775, 'binary_precision': 0.81512606, 'binary_recall': 0.8622222, 'binary_specificity': 0.80444443, 'binary_f1_score': 0.83801293}
confusion matrix:
     0    1
0  181   44
1   31  194
early stop counter: 2
val acc:0.8813427090644836, best validation acc: 0.8829039931297302, corresponding to test acc:                         0.851111114025116 / 0.8755555748939514
after epoch: 10,now: 2024-07-23 00:15:15.694685,epoch time: 0:01:28.200255,used: 0:14:45.354824,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_00_00_30_seed_1_22755942
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9892578, 'precision': 0.9892578, 'recall': 0.9893327, 'specificity': 0.9893327, 'f1': 0.98925734, 'auroc': 0.9997431, 'binary_precision': 0.9954427, 'binary_recall': 0.98327976, 'binary_specificity': 0.99538565, 'binary_f1_score': 0.9893238}
confusion matrix:
      0     1
0  1510     7
1    26  1529
---- Validation: 
scalar performance:
{'acc': 0.8704137, 'precision': 0.8717782, 'recall': 0.8699181, 'specificity': 0.8699181, 'f1': 0.87015665, 'auroc': 0.9222344, 'binary_precision': 0.89057237, 'binary_recall': 0.8396825, 'binary_specificity': 0.90015364, 'binary_f1_score': 0.86437905}
confusion matrix:
     0    1
0  586   65
1  101  529
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.80222225, 'precision': 0.804878, 'recall': 0.80222225, 'specificity': 0.80222225, 'f1': 0.80179054, 'auroc': 0.90234077, 'binary_precision': 0.77642274, 'binary_recall': 0.8488889, 'binary_specificity': 0.75555557, 'binary_f1_score': 0.8110403}
confusion matrix:
     0    1
0  170   55
1   34  191
early stop counter: 3
val acc:0.8704137206077576, best validation acc: 0.8829039931297302, corresponding to test acc:                         0.851111114025116 / 0.8755555748939514
after epoch: 11,now: 2024-07-23 00:16:43.955297,epoch time: 0:01:28.260612,used: 0:16:13.615436,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_00_00_30_seed_1_22755942
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.976888, 'precision': 0.97711134, 'recall': 0.97708404, 'specificity': 0.97708404, 'f1': 0.976888, 'auroc': 0.9984866, 'binary_precision': 0.9914021, 'binary_recall': 0.9627489, 'binary_specificity': 0.99141914, 'binary_f1_score': 0.9768654}
confusion matrix:
      0     1
0  1502    13
1    58  1499
---- Validation: 
scalar performance:
{'acc': 0.86260736, 'precision': 0.8770474, 'recall': 0.8610087, 'specificity': 0.8610087, 'f1': 0.86087364, 'auroc': 0.93595934, 'binary_precision': 0.9468504, 'binary_recall': 0.76349205, 'binary_specificity': 0.95852536, 'binary_f1_score': 0.84534276}
confusion matrix:
     0    1
0  624   27
1  149  481
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8422222, 'precision': 0.8713349, 'recall': 0.8422222, 'specificity': 0.8422222, 'f1': 0.83906794, 'auroc': 0.92709136, 'binary_precision': 0.97530866, 'binary_recall': 0.7022222, 'binary_specificity': 0.9822222, 'binary_f1_score': 0.8165375}
confusion matrix:
     0    1
0  221    4
1   67  158
early stop counter: 4
val acc:0.8626073598861694, best validation acc: 0.8829039931297302, corresponding to test acc:                         0.851111114025116 / 0.8755555748939514
after epoch: 12,now: 2024-07-23 00:18:12.455974,epoch time: 0:01:28.500677,used: 0:17:42.116113,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_00_00_30_seed_1_22755942
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9863281, 'precision': 0.9864954, 'recall': 0.9864954, 'specificity': 0.9864954, 'f1': 0.9863281, 'auroc': 0.9994446, 'binary_precision': 0.99934036, 'binary_recall': 0.9736504, 'binary_specificity': 0.99934036, 'binary_f1_score': 0.9863281}
confusion matrix:
      0     1
0  1515     1
1    41  1515
---- Validation: 
scalar performance:
{'acc': 0.8017174, 'precision': 0.83750904, 'recall': 0.79902714, 'specificity': 0.79902714, 'f1': 0.7952891, 'auroc': 0.9143881, 'binary_precision': 0.9433962, 'binary_recall': 0.63492066, 'binary_specificity': 0.96313363, 'binary_f1_score': 0.75901324}
confusion matrix:
     0    1
0  627   24
1  230  400
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.82666665, 'precision': 0.8384601, 'recall': 0.8266667, 'specificity': 0.8266667, 'f1': 0.82514346, 'auroc': 0.9055605, 'binary_precision': 0.90163934, 'binary_recall': 0.73333335, 'binary_specificity': 0.92, 'binary_f1_score': 0.8088235}
confusion matrix:
     0    1
0  207   18
1   60  165
early stop counter: 5
val acc:0.8017174005508423, best validation acc: 0.8829039931297302, corresponding to test acc:                         0.851111114025116 / 0.8755555748939514
after epoch: 13,now: 2024-07-23 00:19:40.563453,epoch time: 0:01:28.107479,used: 0:19:10.223592,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_00_00_30_seed_1_22755942
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.98828125, 'precision': 0.9883686, 'recall': 0.9884083, 'specificity': 0.9884083, 'f1': 0.9882812, 'auroc': 0.99942136, 'binary_precision': 0.9986868, 'binary_recall': 0.97813505, 'binary_specificity': 0.9986816, 'binary_f1_score': 0.9883041}
confusion matrix:
      0     1
0  1515     2
1    34  1521
---- Validation: 
scalar performance:
{'acc': 0.8173302, 'precision': 0.84613216, 'recall': 0.81495136, 'specificity': 0.81495136, 'f1': 0.8126247, 'auroc': 0.92438984, 'binary_precision': 0.94196427, 'binary_recall': 0.6698413, 'binary_specificity': 0.96006143, 'binary_f1_score': 0.7829313}
confusion matrix:
     0    1
0  625   26
1  208  422
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.83111113, 'precision': 0.84831166, 'recall': 0.83111113, 'specificity': 0.83111113, 'f1': 0.829, 'auroc': 0.91097283, 'binary_precision': 0.9257143, 'binary_recall': 0.72, 'binary_specificity': 0.94222224, 'binary_f1_score': 0.81000006}
confusion matrix:
     0    1
0  212   13
1   63  162
early stop counter: 6
val acc:0.8173301815986633, best validation acc: 0.8829039931297302, corresponding to test acc:                         0.851111114025116 / 0.8755555748939514
after epoch: 14,now: 2024-07-23 00:21:09.107765,epoch time: 0:01:28.544312,used: 0:20:38.767904,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_00_00_30_seed_1_22755942
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9899089, 'precision': 0.98992217, 'recall': 0.9899876, 'specificity': 0.9899876, 'f1': 0.98990864, 'auroc': 0.9995765, 'binary_precision': 0.99673843, 'binary_recall': 0.983269, 'binary_specificity': 0.9967062, 'binary_f1_score': 0.9899579}
confusion matrix:
      0     1
0  1513     5
1    26  1528
---- Validation: 
scalar performance:
{'acc': 0.8953942, 'precision': 0.9022671, 'recall': 0.89434206, 'specificity': 0.89434206, 'f1': 0.89473987, 'auroc': 0.9384122, 'binary_precision': 0.9509091, 'binary_recall': 0.8301587, 'binary_specificity': 0.95852536, 'binary_f1_score': 0.88644063}
confusion matrix:
     0    1
0  624   27
1  107  523
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8377778, 'precision': 0.85762084, 'recall': 0.8377778, 'specificity': 0.8377778, 'f1': 0.8354958, 'auroc': 0.91385186, 'binary_precision': 0.94186044, 'binary_recall': 0.72, 'binary_specificity': 0.95555556, 'binary_f1_score': 0.8161209}
confusion matrix:
     0    1
0  215   10
1   63  162
better model found
persisted
after epoch: 15,now: 2024-07-23 00:22:37.487308,epoch time: 0:01:28.379543,used: 0:22:07.147447,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_00_00_30_seed_1_22755942
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9863281, 'precision': 0.9865298, 'recall': 0.98649514, 'specificity': 0.98649514, 'f1': 0.9863281, 'auroc': 0.99972826, 'binary_precision': 1.0, 'binary_recall': 0.97299033, 'binary_specificity': 1.0, 'binary_f1_score': 0.9863103}
confusion matrix:
      0     1
0  1517     0
1    42  1513
---- Validation: 
scalar performance:
{'acc': 0.7369243, 'precision': 0.8151206, 'recall': 0.7327957, 'specificity': 0.7327957, 'f1': 0.7172384, 'auroc': 0.92898536, 'binary_precision': 0.96805114, 'binary_recall': 0.48095238, 'binary_specificity': 0.984639, 'binary_f1_score': 0.64263}
confusion matrix:
     0    1
0  641   10
1  327  303
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.77111113, 'precision': 0.83952606, 'recall': 0.77111113, 'specificity': 0.77111113, 'f1': 0.7589691, 'auroc': 0.91863704, 'binary_precision': 0.9919355, 'binary_recall': 0.5466667, 'binary_specificity': 0.9955556, 'binary_f1_score': 0.7048711}
confusion matrix:
     0    1
0  224    1
1  102  123
early stop counter: 1
val acc:0.7369242906570435, best validation acc: 0.8953942060470581, corresponding to test acc:                         0.8377777934074402 / 0.8755555748939514
after epoch: 16,now: 2024-07-23 00:24:05.420091,epoch time: 0:01:27.932783,used: 0:23:35.080230,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_00_00_30_seed_1_22755942
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.99316406, 'precision': 0.993159, 'recall': 0.99316716, 'specificity': 0.99316716, 'f1': 0.993163, 'auroc': 0.999819, 'binary_precision': 0.99356914, 'binary_recall': 0.9929306, 'binary_specificity': 0.9934037, 'binary_f1_score': 0.9932498}
confusion matrix:
      0     1
0  1506    10
1    11  1545
---- Validation: 
scalar performance:
{'acc': 0.8212334, 'precision': 0.8419459, 'recall': 0.81920123, 'specificity': 0.81920123, 'f1': 0.81779397, 'auroc': 0.9148295, 'binary_precision': 0.92210525, 'binary_recall': 0.6952381, 'binary_specificity': 0.94316435, 'binary_f1_score': 0.79276013}
confusion matrix:
     0    1
0  614   37
1  192  438
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.86444443, 'precision': 0.869, 'recall': 0.8644445, 'specificity': 0.8644445, 'f1': 0.86402476, 'auroc': 0.927842, 'binary_precision': 0.91, 'binary_recall': 0.8088889, 'binary_specificity': 0.92, 'binary_f1_score': 0.8564706}
confusion matrix:
     0    1
0  207   18
1   43  182
early stop counter: 2
val acc:0.8212333917617798, best validation acc: 0.8953942060470581, corresponding to test acc:                         0.8377777934074402 / 0.8755555748939514
after epoch: 17,now: 2024-07-23 00:25:33.640523,epoch time: 0:01:28.220432,used: 0:25:03.300662,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_00_00_30_seed_1_22755942
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.99153644, 'precision': 0.9915458, 'recall': 0.9916283, 'specificity': 0.9916283, 'f1': 0.9915361, 'auroc': 0.9998169, 'binary_precision': 0.9986962, 'binary_recall': 0.9845758, 'binary_specificity': 0.9986807, 'binary_f1_score': 0.9915857}
confusion matrix:
      0     1
0  1514     2
1    24  1532
---- Validation: 
scalar performance:
{'acc': 0.80483997, 'precision': 0.8410344, 'recall': 0.80215055, 'specificity': 0.80215055, 'f1': 0.79851294, 'auroc': 0.918285, 'binary_precision': 0.9481132, 'binary_recall': 0.63809526, 'binary_specificity': 0.96620584, 'binary_f1_score': 0.7628084}
confusion matrix:
     0    1
0  629   22
1  228  402
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8333333, 'precision': 0.8513868, 'recall': 0.8333334, 'specificity': 0.8333334, 'f1': 0.8311647, 'auroc': 0.90874076, 'binary_precision': 0.9310345, 'binary_recall': 0.72, 'binary_specificity': 0.94666666, 'binary_f1_score': 0.8120301}
confusion matrix:
     0    1
0  213   12
1   63  162
early stop counter: 3
val acc:0.8048399686813354, best validation acc: 0.8953942060470581, corresponding to test acc:                         0.8377777934074402 / 0.8755555748939514
after epoch: 18,now: 2024-07-23 00:27:01.358261,epoch time: 0:01:27.717738,used: 0:26:31.018400,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_00_00_30_seed_1_22755942
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9902344, 'precision': 0.9902111, 'recall': 0.990286, 'specificity': 0.990286, 'f1': 0.9902334, 'auroc': 0.9995192, 'binary_precision': 0.9941748, 'binary_recall': 0.98651254, 'binary_specificity': 0.9940594, 'binary_f1_score': 0.9903288}
confusion matrix:
      0     1
0  1506     9
1    21  1536
---- Validation: 
scalar performance:
{'acc': 0.7806401, 'precision': 0.8210257, 'recall': 0.77770096, 'specificity': 0.77770096, 'f1': 0.77224076, 'auroc': 0.90619624, 'binary_precision': 0.9308642, 'binary_recall': 0.5984127, 'binary_specificity': 0.9569892, 'binary_f1_score': 0.72850245}
confusion matrix:
     0    1
0  623   28
1  253  377
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.84444445, 'precision': 0.85067874, 'recall': 0.84444445, 'specificity': 0.84444445, 'f1': 0.84375, 'auroc': 0.91016304, 'binary_precision': 0.8974359, 'binary_recall': 0.7777778, 'binary_specificity': 0.9111111, 'binary_f1_score': 0.8333334}
confusion matrix:
     0    1
0  205   20
1   50  175
early stop counter: 4
val acc:0.7806401252746582, best validation acc: 0.8953942060470581, corresponding to test acc:                         0.8377777934074402 / 0.8755555748939514
after epoch: 19,now: 2024-07-23 00:28:29.370708,epoch time: 0:01:28.012447,used: 0:27:59.030847,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_00_00_30_seed_1_22755942
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.992513, 'precision': 0.99249005, 'recall': 0.9925442, 'specificity': 0.9925442, 'f1': 0.9925119, 'auroc': 0.999694, 'binary_precision': 0.99484205, 'binary_recall': 0.9903723, 'binary_specificity': 0.994716, 'binary_f1_score': 0.9926021}
confusion matrix:
      0     1
0  1506     8
1    15  1543
---- Validation: 
scalar performance:
{'acc': 0.8126464, 'precision': 0.8409833, 'recall': 0.81026626, 'specificity': 0.81026626, 'f1': 0.8078202, 'auroc': 0.9164021, 'binary_precision': 0.93526787, 'binary_recall': 0.66507936, 'binary_specificity': 0.95545316, 'binary_f1_score': 0.77736545}
confusion matrix:
     0    1
0  622   29
1  211  419
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.82666665, 'precision': 0.8554235, 'recall': 0.82666665, 'specificity': 0.82666665, 'f1': 0.8230882, 'auroc': 0.90990615, 'binary_precision': 0.95652175, 'binary_recall': 0.6844444, 'binary_specificity': 0.9688889, 'binary_f1_score': 0.79792744}
confusion matrix:
     0    1
0  218    7
1   71  154
early stop counter: 5
val acc:0.8126463890075684, best validation acc: 0.8953942060470581, corresponding to test acc:                         0.8377777934074402 / 0.8755555748939514
after epoch: 20,now: 2024-07-23 00:29:57.590758,epoch time: 0:01:28.220050,used: 0:29:27.250897,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_00_00_30_seed_1_22755942
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.99609375, 'precision': 0.9960856, 'recall': 0.99610156, 'specificity': 0.99610156, 'f1': 0.99609315, 'auroc': 0.99986774, 'binary_precision': 0.9967825, 'binary_recall': 0.9955013, 'binary_specificity': 0.99670184, 'binary_f1_score': 0.99614143}
confusion matrix:
      0     1
0  1511     5
1     7  1549
---- Validation: 
scalar performance:
{'acc': 0.87275565, 'precision': 0.87998104, 'recall': 0.8716334, 'specificity': 0.8716334, 'f1': 0.8718784, 'auroc': 0.9284885, 'binary_precision': 0.9284404, 'binary_recall': 0.8031746, 'binary_specificity': 0.94009215, 'binary_f1_score': 0.86127657}
confusion matrix:
     0    1
0  612   39
1  124  506
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.86, 'precision': 0.87115103, 'recall': 0.86, 'specificity': 0.86, 'f1': 0.8589405, 'auroc': 0.9110123, 'binary_precision': 0.9354839, 'binary_recall': 0.7733333, 'binary_specificity': 0.94666666, 'binary_f1_score': 0.8467153}
confusion matrix:
     0    1
0  213   12
1   51  174
early stop counter: 6
val acc:0.8727556467056274, best validation acc: 0.8953942060470581, corresponding to test acc:                         0.8377777934074402 / 0.8755555748939514
after epoch: 21,now: 2024-07-23 00:31:25.759900,epoch time: 0:01:28.169142,used: 0:30:55.420039,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_00_00_30_seed_1_22755942
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9947917, 'precision': 0.9948513, 'recall': 0.9947506, 'specificity': 0.9947506, 'f1': 0.99479043, 'auroc': 0.99975157, 'binary_precision': 0.9916933, 'binary_recall': 0.9980707, 'binary_specificity': 0.99143046, 'binary_f1_score': 0.99487185}
confusion matrix:
      0     1
0  1504    13
1     3  1552
---- Validation: 
scalar performance:
{'acc': 0.8758782, 'precision': 0.8785815, 'recall': 0.87519205, 'specificity': 0.87519205, 'f1': 0.8754849, 'auroc': 0.92060816, 'binary_precision': 0.9067358, 'binary_recall': 0.8333333, 'binary_specificity': 0.9170507, 'binary_f1_score': 0.86848634}
confusion matrix:
     0    1
0  597   54
1  105  525
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.82666665, 'precision': 0.82877076, 'recall': 0.8266667, 'specificity': 0.8266667, 'f1': 0.8263889, 'auroc': 0.92782223, 'binary_precision': 0.85507244, 'binary_recall': 0.7866667, 'binary_specificity': 0.8666667, 'binary_f1_score': 0.8194445}
confusion matrix:
     0    1
0  195   30
1   48  177
early stop counter: 7
val acc:0.8758782148361206, best validation acc: 0.8953942060470581, corresponding to test acc:                         0.8377777934074402 / 0.8755555748939514
after epoch: 22,now: 2024-07-23 00:32:54.740299,epoch time: 0:01:28.980399,used: 0:32:24.400438,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_00_00_30_seed_1_22755942
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.9869792, 'precision': 0.9871217, 'recall': 0.9871713, 'specificity': 0.9871713, 'f1': 0.9869791, 'auroc': 0.99986684, 'binary_precision': 1.0, 'binary_recall': 0.9743425, 'binary_specificity': 1.0, 'binary_f1_score': 0.9870045}
confusion matrix:
      0     1
0  1513     0
1    40  1519
---- Validation: 
scalar performance:
{'acc': 0.62138957, 'precision': 0.76497495, 'recall': 0.6152586, 'specificity': 0.6152586, 'f1': 0.55587506, 'auroc': 0.9053575, 'binary_precision': 0.9559748, 'binary_recall': 0.24126984, 'binary_specificity': 0.9892473, 'binary_f1_score': 0.38529783}
confusion matrix:
     0    1
0  644    7
1  478  152
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.64, 'precision': 0.76959944, 'recall': 0.64, 'specificity': 0.64, 'f1': 0.59082645, 'auroc': 0.90504694, 'binary_precision': 0.95652175, 'binary_recall': 0.29333332, 'binary_specificity': 0.9866667, 'binary_f1_score': 0.44897962}
confusion matrix:
     0   1
0  222   3
1  159  66
early stop counter: 8
val acc:0.6213895678520203, best validation acc: 0.8953942060470581, corresponding to test acc:                         0.8377777934074402 / 0.8755555748939514
after epoch: 23,now: 2024-07-23 00:34:22.959065,epoch time: 0:01:28.218766,used: 0:33:52.619204,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_00_00_30_seed_1_22755942
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9941406, 'precision': 0.99412704, 'recall': 0.99420744, 'specificity': 0.99420744, 'f1': 0.99414027, 'auroc': 0.99984956, 'binary_precision': 0.99935067, 'binary_recall': 0.9890745, 'binary_specificity': 0.99934036, 'binary_f1_score': 0.994186}
confusion matrix:
      0     1
0  1515     1
1    17  1539
---- Validation: 
scalar performance:
{'acc': 0.7572209, 'precision': 0.81971174, 'recall': 0.75355864, 'specificity': 0.75355864, 'f1': 0.7429333, 'auroc': 0.9303727, 'binary_precision': 0.95702004, 'binary_recall': 0.53015876, 'binary_specificity': 0.9769585, 'binary_f1_score': 0.68232894}
confusion matrix:
     0    1
0  636   15
1  296  334
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8088889, 'precision': 0.8535896, 'recall': 0.8088889, 'specificity': 0.8088889, 'f1': 0.80265176, 'auroc': 0.9194864, 'binary_precision': 0.97931033, 'binary_recall': 0.6311111, 'binary_specificity': 0.9866667, 'binary_f1_score': 0.7675676}
confusion matrix:
     0    1
0  222    3
1   83  142
early stop counter: 9
val acc:0.7572209239006042, best validation acc: 0.8953942060470581, corresponding to test acc:                         0.8377777934074402 / 0.8755555748939514
after epoch: 24,now: 2024-07-23 00:35:51.148056,epoch time: 0:01:28.188991,used: 0:35:20.808195,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_00_00_30_seed_1_22755942
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.9889323, 'precision': 0.98891723, 'recall': 0.98896694, 'specificity': 0.98896694, 'f1': 0.9889316, 'auroc': 0.9995867, 'binary_precision': 0.99222296, 'binary_recall': 0.9858339, 'binary_specificity': 0.99210006, 'binary_f1_score': 0.9890181}
confusion matrix:
      0     1
0  1507    12
1    22  1531
---- Validation: 
scalar performance:
{'acc': 0.86260736, 'precision': 0.8795719, 'recall': 0.86088073, 'specificity': 0.86088073, 'f1': 0.86061907, 'auroc': 0.93801844, 'binary_precision': 0.9558233, 'binary_recall': 0.75555557, 'binary_specificity': 0.96620584, 'binary_f1_score': 0.84397167}
confusion matrix:
     0    1
0  629   22
1  154  476
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8377778, 'precision': 0.8728414, 'recall': 0.83777773, 'specificity': 0.83777773, 'f1': 0.8338719, 'auroc': 0.92952096, 'binary_precision': 0.98717946, 'binary_recall': 0.6844444, 'binary_specificity': 0.9911111, 'binary_f1_score': 0.8083989}
confusion matrix:
     0    1
0  223    2
1   71  154
early stop counter: 10
val acc:0.8626073598861694, best validation acc: 0.8953942060470581, corresponding to test acc:                         0.8377777934074402 / 0.8755555748939514
after epoch: 25,now: 2024-07-23 00:37:19.501195,epoch time: 0:01:28.353139,used: 0:36:49.161334,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_00_00_30_seed_1_22755942
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9967448, 'precision': 0.99674445, 'recall': 0.99674445, 'specificity': 0.99674445, 'f1': 0.99674445, 'auroc': 0.9999466, 'binary_precision': 0.99677837, 'binary_recall': 0.99677837, 'binary_specificity': 0.99671054, 'binary_f1_score': 0.99677837}
confusion matrix:
      0     1
0  1515     5
1     5  1547
---- Validation: 
scalar performance:
{'acc': 0.871975, 'precision': 0.8800458, 'recall': 0.8707885, 'specificity': 0.8707885, 'f1': 0.8710065, 'auroc': 0.9231634, 'binary_precision': 0.9314815, 'binary_recall': 0.7984127, 'binary_specificity': 0.94316435, 'binary_f1_score': 0.85982907}
confusion matrix:
     0    1
0  614   37
1  127  503
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8422222, 'precision': 0.8480034, 'recall': 0.8422222, 'specificity': 0.8422222, 'f1': 0.84156424, 'auroc': 0.918321, 'binary_precision': 0.89285713, 'binary_recall': 0.7777778, 'binary_specificity': 0.9066667, 'binary_f1_score': 0.8313539}
confusion matrix:
     0    1
0  204   21
1   50  175
early stop counter: 11
val acc:0.8719750046730042, best validation acc: 0.8953942060470581, corresponding to test acc:                         0.8377777934074402 / 0.8755555748939514
after epoch: 26,now: 2024-07-23 00:38:47.754113,epoch time: 0:01:28.252918,used: 0:38:17.414252,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_00_00_30_seed_1_22755942
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.9954427, 'precision': 0.99545, 'recall': 0.99543494, 'specificity': 0.99543494, 'f1': 0.99544203, 'auroc': 0.9999144, 'binary_precision': 0.9948553, 'binary_recall': 0.9961365, 'binary_specificity': 0.9947334, 'binary_f1_score': 0.99549544}
confusion matrix:
      0     1
0  1511     8
1     6  1547
---- Validation: 
scalar performance:
{'acc': 0.71818894, 'precision': 0.7987453, 'recall': 0.71387607, 'specificity': 0.71387607, 'f1': 0.6951723, 'auroc': 0.9075701, 'binary_precision': 0.9498328, 'binary_recall': 0.45079365, 'binary_specificity': 0.9769585, 'binary_f1_score': 0.61141014}
confusion matrix:
     0    1
0  636   15
1  346  284
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8333333, 'precision': 0.8513868, 'recall': 0.8333334, 'specificity': 0.8333334, 'f1': 0.8311647, 'auroc': 0.91490376, 'binary_precision': 0.9310345, 'binary_recall': 0.72, 'binary_specificity': 0.94666666, 'binary_f1_score': 0.8120301}
confusion matrix:
     0    1
0  213   12
1   63  162
early stop counter: 12
val acc:0.7181889414787292, best validation acc: 0.8953942060470581, corresponding to test acc:                         0.8377777934074402 / 0.8755555748939514
after epoch: 27,now: 2024-07-23 00:40:15.543087,epoch time: 0:01:27.788974,used: 0:39:45.203226,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_00_00_30_seed_1_22755942
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.992513, 'precision': 0.9925022, 'recall': 0.9925839, 'specificity': 0.9925839, 'f1': 0.9925126, 'auroc': 0.9997969, 'binary_precision': 0.9980507, 'binary_recall': 0.98714656, 'binary_specificity': 0.9980211, 'binary_f1_score': 0.9925686}
confusion matrix:
      0     1
0  1513     3
1    20  1536
---- Validation: 
scalar performance:
{'acc': 0.79313034, 'precision': 0.8281919, 'recall': 0.790425, 'specificity': 0.790425, 'f1': 0.7863625, 'auroc': 0.9179894, 'binary_precision': 0.9314421, 'binary_recall': 0.62539685, 'binary_specificity': 0.95545316, 'binary_f1_score': 0.7483381}
confusion matrix:
     0    1
0  622   29
1  236  394
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8488889, 'precision': 0.8560916, 'recall': 0.8488889, 'specificity': 0.8488889, 'f1': 0.84812087, 'auroc': 0.91867656, 'binary_precision': 0.9067358, 'binary_recall': 0.7777778, 'binary_specificity': 0.92, 'binary_f1_score': 0.83732057}
confusion matrix:
     0    1
0  207   18
1   50  175
early stop counter: 13
val acc:0.7931303381919861, best validation acc: 0.8953942060470581, corresponding to test acc:                         0.8377777934074402 / 0.8755555748939514
after epoch: 28,now: 2024-07-23 00:41:44.084054,epoch time: 0:01:28.540967,used: 0:41:13.744193,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_00_00_30_seed_1_22755942
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.99283856, 'precision': 0.99281764, 'recall': 0.99289954, 'specificity': 0.99289954, 'f1': 0.9928379, 'auroc': 0.9997897, 'binary_precision': 0.9974077, 'binary_recall': 0.9884393, 'binary_specificity': 0.99735975, 'binary_f1_score': 0.99290323}
confusion matrix:
      0     1
0  1511     4
1    18  1539
---- Validation: 
scalar performance:
{'acc': 0.8345043, 'precision': 0.8433083, 'recall': 0.8331797, 'specificity': 0.8331797, 'f1': 0.8330144, 'auroc': 0.9123144, 'binary_precision': 0.8943396, 'binary_recall': 0.75238097, 'binary_specificity': 0.9139785, 'binary_f1_score': 0.8172414}
confusion matrix:
     0    1
0  595   56
1  156  474
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.81777775, 'precision': 0.81818, 'recall': 0.81777775, 'specificity': 0.81777775, 'f1': 0.8177202, 'auroc': 0.9048296, 'binary_precision': 0.8294931, 'binary_recall': 0.8, 'binary_specificity': 0.83555555, 'binary_f1_score': 0.81447965}
confusion matrix:
     0    1
0  188   37
1   45  180
early stop counter: 14
val acc:0.8345043063163757, best validation acc: 0.8953942060470581, corresponding to test acc:                         0.8377777934074402 / 0.8755555748939514
after epoch: 29,now: 2024-07-23 00:43:12.085288,epoch time: 0:01:28.001234,used: 0:42:41.745427,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_00_00_30_seed_1_22755942
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.992513, 'precision': 0.9925227, 'recall': 0.99261403, 'specificity': 0.99261403, 'f1': 0.9925127, 'auroc': 0.9999126, 'binary_precision': 1.0, 'binary_recall': 0.985228, 'binary_specificity': 1.0, 'binary_f1_score': 0.992559}
confusion matrix:
      0     1
0  1515     0
1    23  1534
---- Validation: 
scalar performance:
{'acc': 0.66978925, 'precision': 0.78397727, 'recall': 0.66451615, 'specificity': 0.66451615, 'f1': 0.62873, 'auroc': 0.91871476, 'binary_precision': 0.96, 'binary_recall': 0.34285715, 'binary_specificity': 0.9861751, 'binary_f1_score': 0.50526315}
confusion matrix:
     0    1
0  642    9
1  414  216
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.74222225, 'precision': 0.8182998, 'recall': 0.74222225, 'specificity': 0.74222225, 'f1': 0.72584033, 'auroc': 0.9205333, 'binary_precision': 0.973913, 'binary_recall': 0.4977778, 'binary_specificity': 0.9866667, 'binary_f1_score': 0.65882355}
confusion matrix:
     0    1
0  222    3
1  113  112
early stop counter: 15
val acc:0.6697892546653748, best validation acc: 0.8953942060470581, corresponding to test acc:                         0.8377777934074402 / 0.8755555748939514
after epoch: 30,now: 2024-07-23 00:44:39.902598,epoch time: 0:01:27.817310,used: 0:44:09.562737,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_00_00_30_seed_1_22755942
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 0:44:09.562737 at 2024-07-23 00:44:39.902598
persisted model performance metric: 

scalar performance:
{'acc': 0.8377778, 'precision': 0.85762084, 'recall': 0.8377778, 'specificity': 0.8377778, 'f1': 0.8354958, 'auroc': 0.91385186, 'binary_precision': 0.94186044, 'binary_recall': 0.72, 'binary_specificity': 0.95555556, 'binary_f1_score': 0.8161209}
confusion matrix:
     0    1
0  215   10
1   63  162
oracle model performance metric: 

scalar performance:
{'acc': 0.8755556, 'precision': 0.88235295, 'recall': 0.8755556, 'specificity': 0.8755556, 'f1': 0.875, 'auroc': 0.9322074, 'binary_precision': 0.93333334, 'binary_recall': 0.8088889, 'binary_specificity': 0.94222224, 'binary_f1_score': 0.8666666}
confusion matrix:
     0    1
0  212   13
1   43  182
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_higherregularization_irm_dial_lr1e5_bs16_nofreeze_2024-07-22_16-00-54/rule_results/0.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_higherregularization_irm_dial_lr1e5_bs16_nofreeze_2024-07-22_16-00-54/confusion_matrix/0.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 455402 KiB |  13219 MiB | 149714 GiB | 149714 GiB |
|       from large pool | 414803 KiB |  13181 MiB | 147928 GiB | 147927 GiB |
|       from small pool |  40598 KiB |     60 MiB |   1786 GiB |   1786 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 455402 KiB |  13219 MiB | 149714 GiB | 149714 GiB |
|       from large pool | 414803 KiB |  13181 MiB | 147928 GiB | 147927 GiB |
|       from small pool |  40598 KiB |     60 MiB |   1786 GiB |   1786 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 447481 KiB |  13213 MiB | 149149 GiB | 149149 GiB |
|       from large pool | 407075 KiB |  13175 MiB | 147366 GiB | 147366 GiB |
|       from small pool |  40406 KiB |     60 MiB |   1783 GiB |   1783 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  14482 MiB |  14482 MiB |  28044 MiB |  13562 MiB |
|       from large pool |  14412 MiB |  14412 MiB |  27960 MiB |  13548 MiB |
|       from small pool |     70 MiB |     70 MiB |     84 MiB |     14 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 445718 KiB |   1232 MiB | 105308 GiB | 105308 GiB |
|       from large pool | 435116 KiB |   1229 MiB | 103510 GiB | 103510 GiB |
|       from small pool |  10601 KiB |     43 MiB |   1797 GiB |   1797 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    1310    |    2598    |   26310 K  |   26309 K  |
|       from large pool |     187    |    1413    |   13436 K  |   13436 K  |
|       from small pool |    1123    |    1419    |   12874 K  |   12872 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    1310    |    2598    |   26310 K  |   26309 K  |
|       from large pool |     187    |    1413    |   13436 K  |   13436 K  |
|       from small pool |    1123    |    1419    |   12874 K  |   12872 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     637    |     637    |    1207    |     570    |
|       from large pool |     602    |     602    |    1165    |     563    |
|       from small pool |      35    |      35    |      42    |       7    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      98    |     650    |   18399 K  |   18399 K  |
|       from large pool |      38    |     605    |   10604 K  |   10604 K  |
|       from small pool |      60    |     234    |    7795 K  |    7795 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13219 MiB | 149714 GiB | 149714 GiB |
|       from large pool |  16640 KiB |  13181 MiB | 147928 GiB | 147928 GiB |
|       from small pool |      0 KiB |     60 MiB |   1786 GiB |   1786 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13219 MiB | 149714 GiB | 149714 GiB |
|       from large pool |  16640 KiB |  13181 MiB | 147928 GiB | 147928 GiB |
|       from small pool |      0 KiB |     60 MiB |   1786 GiB |   1786 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13213 MiB | 149149 GiB | 149149 GiB |
|       from large pool |  16640 KiB |  13175 MiB | 147366 GiB | 147366 GiB |
|       from small pool |      0 KiB |     60 MiB |   1783 GiB |   1783 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    880 MiB |  14482 MiB |  28044 MiB |  27164 MiB |
|       from large pool |    830 MiB |  14412 MiB |  27960 MiB |  27130 MiB |
|       from small pool |     50 MiB |     70 MiB |     84 MiB |     34 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1232 MiB | 105309 GiB | 105309 GiB |
|       from large pool |  24320 KiB |   1229 MiB | 103511 GiB | 103511 GiB |
|       from small pool |      0 KiB |     43 MiB |   1797 GiB |   1797 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    2598    |   26310 K  |   26310 K  |
|       from large pool |       2    |    1413    |   13436 K  |   13436 K  |
|       from small pool |       0    |    1419    |   12874 K  |   12874 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    2598    |   26310 K  |   26310 K  |
|       from large pool |       2    |    1413    |   13436 K  |   13436 K  |
|       from small pool |       0    |    1419    |   12874 K  |   12874 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      62    |     637    |    1207    |    1145    |
|       from large pool |      37    |     602    |    1165    |    1128    |
|       from small pool |      25    |      35    |      42    |      17    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |     650    |   18399 K  |   18399 K  |
|       from large pool |       4    |     605    |   10604 K  |   10604 K  |
|       from small pool |       0    |     234    |    7795 K  |    7795 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13219 MiB | 149714 GiB | 149714 GiB |
|       from large pool |  16640 KiB |  13181 MiB | 147928 GiB | 147928 GiB |
|       from small pool |      0 KiB |     60 MiB |   1786 GiB |   1786 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13219 MiB | 149714 GiB | 149714 GiB |
|       from large pool |  16640 KiB |  13181 MiB | 147928 GiB | 147928 GiB |
|       from small pool |      0 KiB |     60 MiB |   1786 GiB |   1786 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13213 MiB | 149149 GiB | 149149 GiB |
|       from large pool |  16640 KiB |  13175 MiB | 147366 GiB | 147366 GiB |
|       from small pool |      0 KiB |     60 MiB |   1783 GiB |   1783 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    880 MiB |  14482 MiB |  28044 MiB |  27164 MiB |
|       from large pool |    830 MiB |  14412 MiB |  27960 MiB |  27130 MiB |
|       from small pool |     50 MiB |     70 MiB |     84 MiB |     34 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1232 MiB | 105309 GiB | 105309 GiB |
|       from large pool |  24320 KiB |   1229 MiB | 103511 GiB | 103511 GiB |
|       from small pool |      0 KiB |     43 MiB |   1797 GiB |   1797 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    2598    |   26310 K  |   26310 K  |
|       from large pool |       2    |    1413    |   13436 K  |   13436 K  |
|       from small pool |       0    |    1419    |   12874 K  |   12874 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    2598    |   26310 K  |   26310 K  |
|       from large pool |       2    |    1413    |   13436 K  |   13436 K  |
|       from small pool |       0    |    1419    |   12874 K  |   12874 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      62    |     637    |    1207    |    1145    |
|       from large pool |      37    |     602    |    1165    |    1128    |
|       from small pool |      25    |      35    |      42    |      17    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |     650    |   18399 K  |   18399 K  |
|       from large pool |       4    |     605    |   10604 K  |   10604 K  |
|       from small pool |       0    |     234    |    7795 K  |    7795 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'888c1ef2'
model name: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_00_45_46_seed_2_22755942

 Experiment start at: 2024-07-23 00:45:46.719106
before training, model accuracy: 0.41203704476356506
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.94829845, 'precision': 0.9494215, 'recall': 0.948506, 'specificity': 0.948506, 'f1': 0.94827986, 'auroc': 0.98522687, 'binary_precision': 0.9739369, 'binary_recall': 0.9220779, 'binary_specificity': 0.97493404, 'binary_f1_score': 0.9472982}
confusion matrix:
      0     1
0  1478    38
1   120  1420
---- Validation: 
scalar performance:
{'acc': 0.80672926, 'precision': 0.80845773, 'recall': 0.80769646, 'specificity': 0.80769646, 'f1': 0.8066865, 'auroc': 0.8951602, 'binary_precision': 0.7777778, 'binary_recall': 0.8440514, 'binary_specificity': 0.77134144, 'binary_f1_score': 0.8095605}
confusion matrix:
     0    1
0  506  150
1   97  525
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7893519, 'precision': 0.7954371, 'recall': 0.7893518, 'specificity': 0.7893518, 'f1': 0.78826153, 'auroc': 0.89926267, 'binary_precision': 0.75303644, 'binary_recall': 0.8611111, 'binary_specificity': 0.7175926, 'binary_f1_score': 0.8034557}
confusion matrix:
     0    1
0  155   61
1   30  186
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-23 00:47:16.382701,epoch time: 0:01:29.663595,used: 0:01:29.663595,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_00_45_46_seed_2_22755942
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9715314, 'precision': 0.97154605, 'recall': 0.97151685, 'specificity': 0.97151685, 'f1': 0.9715288, 'auroc': 0.9954486, 'binary_precision': 0.9702265, 'binary_recall': 0.97337663, 'binary_specificity': 0.969657, 'binary_f1_score': 0.971799}
confusion matrix:
      0     1
0  1470    46
1    41  1499
---- Validation: 
scalar performance:
{'acc': 0.771518, 'precision': 0.7730658, 'recall': 0.7724394, 'specificity': 0.7724394, 'f1': 0.7714727, 'auroc': 0.8464042, 'binary_precision': 0.7448071, 'binary_recall': 0.80707395, 'binary_specificity': 0.7378049, 'binary_f1_score': 0.7746914}
confusion matrix:
     0    1
0  484  172
1  120  502
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7685185, 'precision': 0.7761905, 'recall': 0.76851857, 'specificity': 0.76851857, 'f1': 0.7668998, 'auroc': 0.8683342, 'binary_precision': 0.73015875, 'binary_recall': 0.8518519, 'binary_specificity': 0.6851852, 'binary_f1_score': 0.7863248}
confusion matrix:
     0    1
0  148   68
1   32  184
early stop counter: 1
val acc:0.7715179920196533, best validation acc: 0.806729257106781, corresponding to test acc:                         0.7893518805503845 / 0.7893518805503845
after epoch: 2,now: 2024-07-23 00:48:42.506472,epoch time: 0:01:26.123771,used: 0:02:55.787366,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_00_45_46_seed_2_22755942
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9695681, 'precision': 0.969872, 'recall': 0.96968186, 'specificity': 0.96968186, 'f1': 0.96956664, 'auroc': 0.9962153, 'binary_precision': 0.9839465, 'binary_recall': 0.95519483, 'binary_specificity': 0.9841689, 'binary_f1_score': 0.96935755}
confusion matrix:
      0     1
0  1492    24
1    69  1471
---- Validation: 
scalar performance:
{'acc': 0.75586855, 'precision': 0.79971576, 'recall': 0.75065434, 'specificity': 0.75065434, 'f1': 0.7439253, 'auroc': 0.8692554, 'binary_precision': 0.90789473, 'binary_recall': 0.5546624, 'binary_specificity': 0.94664633, 'binary_f1_score': 0.68862283}
confusion matrix:
     0    1
0  621   35
1  277  345
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8101852, 'precision': 0.8223737, 'recall': 0.8101852, 'specificity': 0.8101852, 'f1': 0.8083739, 'auroc': 0.8947831, 'binary_precision': 0.88505745, 'binary_recall': 0.712963, 'binary_specificity': 0.9074074, 'binary_f1_score': 0.7897436}
confusion matrix:
     0    1
0  196   20
1   62  154
new oracle model saved
early stop counter: 2
val acc:0.7558685541152954, best validation acc: 0.806729257106781, corresponding to test acc:                         0.7893518805503845 / 0.8101851940155029
after epoch: 3,now: 2024-07-23 00:50:08.659275,epoch time: 0:01:26.152803,used: 0:04:21.940169,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_00_45_46_seed_2_22755942
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9849476, 'precision': 0.9849613, 'recall': 0.98498785, 'specificity': 0.98498785, 'f1': 0.98494756, 'auroc': 0.99822074, 'binary_precision': 0.9901575, 'binary_recall': 0.97987014, 'binary_specificity': 0.99010557, 'binary_f1_score': 0.9849869}
confusion matrix:
      0     1
0  1501    15
1    31  1509
---- Validation: 
scalar performance:
{'acc': 0.75508606, 'precision': 0.75779223, 'recall': 0.7535169, 'specificity': 0.7535169, 'f1': 0.75354683, 'auroc': 0.8319789, 'binary_precision': 0.77837837, 'binary_recall': 0.69453377, 'binary_specificity': 0.8125, 'binary_f1_score': 0.7340697}
confusion matrix:
     0    1
0  533  123
1  190  432
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7638889, 'precision': 0.79485583, 'recall': 0.7638889, 'specificity': 0.7638889, 'f1': 0.7575224, 'auroc': 0.89347565, 'binary_precision': 0.6993007, 'binary_recall': 0.9259259, 'binary_specificity': 0.6018519, 'binary_f1_score': 0.7968127}
confusion matrix:
     0    1
0  130   86
1   16  200
early stop counter: 3
val acc:0.7550860643386841, best validation acc: 0.806729257106781, corresponding to test acc:                         0.7893518805503845 / 0.8101851940155029
after epoch: 4,now: 2024-07-23 00:51:35.280978,epoch time: 0:01:26.621703,used: 0:05:48.561872,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_00_45_46_seed_2_22755942
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.97971207, 'precision': 0.9798249, 'recall': 0.9797879, 'specificity': 0.9797879, 'f1': 0.97971195, 'auroc': 0.99711263, 'binary_precision': 0.98940396, 'binary_recall': 0.97012985, 'binary_specificity': 0.9894459, 'binary_f1_score': 0.97967213}
confusion matrix:
      0     1
0  1500    16
1    46  1494
---- Validation: 
scalar performance:
{'acc': 0.63849765, 'precision': 0.748906, 'recall': 0.62936735, 'specificity': 0.62936735, 'f1': 0.5846925, 'auroc': 0.8474041, 'binary_precision': 0.90816325, 'binary_recall': 0.28617364, 'binary_specificity': 0.972561, 'binary_f1_score': 0.4352078}
confusion matrix:
     0    1
0  638   18
1  444  178
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6851852, 'precision': 0.78541225, 'recall': 0.6851852, 'specificity': 0.6851852, 'f1': 0.6548872, 'auroc': 0.87952244, 'binary_precision': 0.95454544, 'binary_recall': 0.3888889, 'binary_specificity': 0.9814815, 'binary_f1_score': 0.5526316}
confusion matrix:
     0   1
0  212   4
1  132  84
early stop counter: 4
val acc:0.6384976506233215, best validation acc: 0.806729257106781, corresponding to test acc:                         0.7893518805503845 / 0.8101851940155029
after epoch: 5,now: 2024-07-23 00:53:01.281263,epoch time: 0:01:26.000285,used: 0:07:14.562157,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_00_45_46_seed_2_22755942
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.97742146, 'precision': 0.9777527, 'recall': 0.9773301, 'specificity': 0.9773301, 'f1': 0.97741306, 'auroc': 0.9978206, 'binary_precision': 0.96698415, 'binary_recall': 0.98896104, 'binary_specificity': 0.9656992, 'binary_f1_score': 0.9778491}
confusion matrix:
      0     1
0  1464    52
1    17  1523
---- Validation: 
scalar performance:
{'acc': 0.8223787, 'precision': 0.82224256, 'recall': 0.82235706, 'specificity': 0.82235706, 'f1': 0.8222872, 'auroc': 0.8907194, 'binary_precision': 0.814992, 'binary_recall': 0.8215434, 'binary_specificity': 0.8231707, 'binary_f1_score': 0.8182546}
confusion matrix:
     0    1
0  540  116
1  111  511
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7800926, 'precision': 0.7895314, 'recall': 0.7800926, 'specificity': 0.7800926, 'f1': 0.7782856, 'auroc': 0.89381856, 'binary_precision': 0.7372549, 'binary_recall': 0.8703704, 'binary_specificity': 0.6898148, 'binary_f1_score': 0.7983015}
confusion matrix:
     0    1
0  149   67
1   28  188
better model found
persisted
after epoch: 6,now: 2024-07-23 00:54:27.336959,epoch time: 0:01:26.055696,used: 0:08:40.617853,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_00_45_46_seed_2_22755942
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9718586, 'precision': 0.9729701, 'recall': 0.97206247, 'specificity': 0.97206247, 'f1': 0.9718492, 'auroc': 0.99812263, 'binary_precision': 0.9979452, 'binary_recall': 0.9461039, 'binary_specificity': 0.9980211, 'binary_f1_score': 0.97133327}
confusion matrix:
      0     1
0  1513     3
1    83  1457
---- Validation: 
scalar performance:
{'acc': 0.773083, 'precision': 0.8221859, 'recall': 0.7677976, 'specificity': 0.7677976, 'f1': 0.7616414, 'auroc': 0.8851683, 'binary_precision': 0.94148934, 'binary_recall': 0.56913185, 'binary_specificity': 0.9664634, 'binary_f1_score': 0.70941883}
confusion matrix:
     0    1
0  634   22
1  268  354
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.787037, 'precision': 0.83007985, 'recall': 0.787037, 'specificity': 0.787037, 'f1': 0.77986044, 'auroc': 0.8788152, 'binary_precision': 0.9492754, 'binary_recall': 0.6064815, 'binary_specificity': 0.9675926, 'binary_f1_score': 0.740113}
confusion matrix:
     0    1
0  209    7
1   85  131
early stop counter: 1
val acc:0.773082971572876, best validation acc: 0.8223786950111389, corresponding to test acc:                         0.7800925970077515 / 0.8101851940155029
after epoch: 7,now: 2024-07-23 00:55:53.638834,epoch time: 0:01:26.301875,used: 0:10:06.919728,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_00_45_46_seed_2_22755942
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.98658377, 'precision': 0.98658144, 'recall': 0.98661125, 'specificity': 0.98661125, 'f1': 0.98658353, 'auroc': 0.99899256, 'binary_precision': 0.9901897, 'binary_recall': 0.98311687, 'binary_specificity': 0.99010557, 'binary_f1_score': 0.98664063}
confusion matrix:
      0     1
0  1501    15
1    26  1514
---- Validation: 
scalar performance:
{'acc': 0.8114241, 'precision': 0.82449245, 'recall': 0.8086866, 'specificity': 0.8086866, 'f1': 0.8084593, 'auroc': 0.87522364, 'binary_precision': 0.8832998, 'binary_recall': 0.7057878, 'binary_specificity': 0.9115854, 'binary_f1_score': 0.7846291}
confusion matrix:
     0    1
0  598   58
1  183  439
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7939815, 'precision': 0.7962739, 'recall': 0.7939815, 'specificity': 0.7939815, 'f1': 0.7935822, 'auroc': 0.8840878, 'binary_precision': 0.822335, 'binary_recall': 0.75, 'binary_specificity': 0.837963, 'binary_f1_score': 0.78450364}
confusion matrix:
     0    1
0  181   35
1   54  162
early stop counter: 2
val acc:0.8114240765571594, best validation acc: 0.8223786950111389, corresponding to test acc:                         0.7800925970077515 / 0.8101851940155029
after epoch: 8,now: 2024-07-23 00:57:19.781685,epoch time: 0:01:26.142851,used: 0:11:33.062579,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_00_45_46_seed_2_22755942
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.98527485, 'precision': 0.9853602, 'recall': 0.98534334, 'specificity': 0.98534334, 'f1': 0.9852748, 'auroc': 0.9987505, 'binary_precision': 0.9940516, 'binary_recall': 0.97662336, 'binary_specificity': 0.9940633, 'binary_f1_score': 0.98526037}
confusion matrix:
      0     1
0  1507     9
1    36  1504
---- Validation: 
scalar performance:
{'acc': 0.7026604, 'precision': 0.7065834, 'recall': 0.70049167, 'specificity': 0.70049167, 'f1': 0.6996475, 'auroc': 0.780429, 'binary_precision': 0.7291667, 'binary_recall': 0.61897105, 'binary_specificity': 0.7820122, 'binary_f1_score': 0.6695652}
confusion matrix:
     0    1
0  513  143
1  237  385
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7939815, 'precision': 0.8010073, 'recall': 0.7939815, 'specificity': 0.7939815, 'f1': 0.7927722, 'auroc': 0.89043206, 'binary_precision': 0.7550201, 'binary_recall': 0.8703704, 'binary_specificity': 0.7175926, 'binary_f1_score': 0.8086021}
confusion matrix:
     0    1
0  155   61
1   28  188
early stop counter: 3
val acc:0.7026603817939758, best validation acc: 0.8223786950111389, corresponding to test acc:                         0.7800925970077515 / 0.8101851940155029
after epoch: 9,now: 2024-07-23 00:58:47.737073,epoch time: 0:01:27.955388,used: 0:13:01.017967,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_00_45_46_seed_2_22755942
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9895288, 'precision': 0.9895209, 'recall': 0.98954356, 'specificity': 0.98954356, 'f1': 0.9895284, 'auroc': 0.9984182, 'binary_precision': 0.9915254, 'binary_recall': 0.9876623, 'binary_specificity': 0.9914248, 'binary_f1_score': 0.9895901}
confusion matrix:
      0     1
0  1503    13
1    19  1521
---- Validation: 
scalar performance:
{'acc': 0.7801252, 'precision': 0.7880868, 'recall': 0.77778214, 'specificity': 0.77778214, 'f1': 0.777493, 'auroc': 0.87203944, 'binary_precision': 0.82978725, 'binary_recall': 0.6897106, 'binary_specificity': 0.86585367, 'binary_f1_score': 0.7532924}
confusion matrix:
     0    1
0  568   88
1  193  429
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7893519, 'precision': 0.79715395, 'recall': 0.7893518, 'specificity': 0.7893518, 'f1': 0.78796, 'auroc': 0.8835305, 'binary_precision': 0.749004, 'binary_recall': 0.8703704, 'binary_specificity': 0.7083333, 'binary_f1_score': 0.8051392}
confusion matrix:
     0    1
0  153   63
1   28  188
early stop counter: 4
val acc:0.7801252007484436, best validation acc: 0.8223786950111389, corresponding to test acc:                         0.7800925970077515 / 0.8101851940155029
after epoch: 10,now: 2024-07-23 01:00:16.878253,epoch time: 0:01:29.141180,used: 0:14:30.159147,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_00_45_46_seed_2_22755942
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.98854715, 'precision': 0.9885413, 'recall': 0.9885695, 'specificity': 0.9885695, 'f1': 0.9885468, 'auroc': 0.9991219, 'binary_precision': 0.99150884, 'binary_recall': 0.98571426, 'binary_specificity': 0.9914248, 'binary_f1_score': 0.988603}
confusion matrix:
      0     1
0  1503    13
1    22  1518
---- Validation: 
scalar performance:
{'acc': 0.7887324, 'precision': 0.81094426, 'recall': 0.78508306, 'specificity': 0.78508306, 'f1': 0.7833191, 'auroc': 0.8666526, 'binary_precision': 0.8876652, 'binary_recall': 0.64790994, 'binary_specificity': 0.9222561, 'binary_f1_score': 0.74907064}
confusion matrix:
     0    1
0  605   51
1  219  403
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8217593, 'precision': 0.8326022, 'recall': 0.8217592, 'specificity': 0.8217592, 'f1': 0.8202946, 'auroc': 0.903828, 'binary_precision': 0.8926554, 'binary_recall': 0.7314815, 'binary_specificity': 0.912037, 'binary_f1_score': 0.80407125}
confusion matrix:
     0    1
0  197   19
1   58  158
new oracle model saved
early stop counter: 5
val acc:0.7887324094772339, best validation acc: 0.8223786950111389, corresponding to test acc:                         0.7800925970077515 / 0.8217592835426331
after epoch: 11,now: 2024-07-23 01:01:47.308576,epoch time: 0:01:30.430323,used: 0:16:00.589470,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_00_45_46_seed_2_22755942
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.98625654, 'precision': 0.98641396, 'recall': 0.9863431, 'specificity': 0.9863431, 'f1': 0.9862565, 'auroc': 0.999238, 'binary_precision': 0.99734396, 'binary_recall': 0.9753247, 'binary_specificity': 0.9973615, 'binary_f1_score': 0.9862115}
confusion matrix:
      0     1
0  1512     4
1    38  1502
---- Validation: 
scalar performance:
{'acc': 0.7363067, 'precision': 0.79835546, 'recall': 0.73009956, 'specificity': 0.73009956, 'f1': 0.71831346, 'auroc': 0.8735596, 'binary_precision': 0.9279279, 'binary_recall': 0.49678457, 'binary_specificity': 0.9634146, 'binary_f1_score': 0.6471204}
confusion matrix:
     0    1
0  632   24
1  313  309
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7037037, 'precision': 0.786265, 'recall': 0.7037037, 'specificity': 0.7037037, 'f1': 0.68068, 'auroc': 0.8591392, 'binary_precision': 0.94, 'binary_recall': 0.4351852, 'binary_specificity': 0.9722222, 'binary_f1_score': 0.59493667}
confusion matrix:
     0   1
0  210   6
1  122  94
early stop counter: 6
val acc:0.7363067269325256, best validation acc: 0.8223786950111389, corresponding to test acc:                         0.7800925970077515 / 0.8217592835426331
after epoch: 12,now: 2024-07-23 01:03:17.249435,epoch time: 0:01:29.940859,used: 0:17:30.530329,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_00_45_46_seed_2_22755942
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9888743, 'precision': 0.98888034, 'recall': 0.9889096, 'specificity': 0.9889096, 'f1': 0.9888742, 'auroc': 0.9990264, 'binary_precision': 0.99344695, 'binary_recall': 0.9844156, 'binary_specificity': 0.9934037, 'binary_f1_score': 0.9889106}
confusion matrix:
      0     1
0  1506    10
1    24  1516
---- Validation: 
scalar performance:
{'acc': 0.79812205, 'precision': 0.8242595, 'recall': 0.794271, 'specificity': 0.794271, 'f1': 0.79240966, 'auroc': 0.89493287, 'binary_precision': 0.9099099, 'binary_recall': 0.64951766, 'binary_specificity': 0.9390244, 'binary_f1_score': 0.75797373}
confusion matrix:
     0    1
0  616   40
1  218  404
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7962963, 'precision': 0.81307185, 'recall': 0.7962963, 'specificity': 0.7962963, 'f1': 0.79353046, 'auroc': 0.88961756, 'binary_precision': 0.88554215, 'binary_recall': 0.6805556, 'binary_specificity': 0.912037, 'binary_f1_score': 0.76963353}
confusion matrix:
     0    1
0  197   19
1   69  147
early stop counter: 7
val acc:0.7981220483779907, best validation acc: 0.8223786950111389, corresponding to test acc:                         0.7800925970077515 / 0.8217592835426331
after epoch: 13,now: 2024-07-23 01:04:46.786467,epoch time: 0:01:29.537032,used: 0:19:00.067361,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_00_45_46_seed_2_22755942
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9849476, 'precision': 0.9851244, 'recall': 0.98488504, 'specificity': 0.98488504, 'f1': 0.984944, 'auroc': 0.99937075, 'binary_precision': 0.9776215, 'binary_recall': 0.99285716, 'binary_specificity': 0.9769129, 'binary_f1_score': 0.98518044}
confusion matrix:
      0     1
0  1481    35
1    11  1529
---- Validation: 
scalar performance:
{'acc': 0.8458529, 'precision': 0.84970444, 'recall': 0.8472644, 'specificity': 0.8472644, 'f1': 0.8457092, 'auroc': 0.91669774, 'binary_precision': 0.8057554, 'binary_recall': 0.90032154, 'binary_specificity': 0.79420733, 'binary_f1_score': 0.8504177}
confusion matrix:
     0    1
0  521  135
1   62  560
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7777778, 'precision': 0.80100334, 'recall': 0.7777778, 'specificity': 0.7777778, 'f1': 0.77340674, 'auroc': 0.9091649, 'binary_precision': 0.7173913, 'binary_recall': 0.9166667, 'binary_specificity': 0.6388889, 'binary_f1_score': 0.804878}
confusion matrix:
     0    1
0  138   78
1   18  198
better model found
persisted
after epoch: 14,now: 2024-07-23 01:06:16.730857,epoch time: 0:01:29.944390,used: 0:20:30.011751,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_00_45_46_seed_2_22755942
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9895288, 'precision': 0.98953474, 'recall': 0.9895641, 'specificity': 0.9895641, 'f1': 0.98952866, 'auroc': 0.9995322, 'binary_precision': 0.99410224, 'binary_recall': 0.9850649, 'binary_specificity': 0.9940633, 'binary_f1_score': 0.9895629}
confusion matrix:
      0     1
0  1507     9
1    23  1517
---- Validation: 
scalar performance:
{'acc': 0.7879499, 'precision': 0.8320395, 'recall': 0.78302926, 'specificity': 0.78302926, 'f1': 0.77857256, 'auroc': 0.9103888, 'binary_precision': 0.9465649, 'binary_recall': 0.59807074, 'binary_specificity': 0.9679878, 'binary_f1_score': 0.7330049}
confusion matrix:
     0    1
0  635   21
1  250  372
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.75, 'precision': 0.81480086, 'recall': 0.75, 'specificity': 0.75, 'f1': 0.7364366, 'auroc': 0.9030564, 'binary_precision': 0.9576271, 'binary_recall': 0.5231481, 'binary_specificity': 0.9768519, 'binary_f1_score': 0.6766467}
confusion matrix:
     0    1
0  211    5
1  103  113
early stop counter: 1
val acc:0.7879499197006226, best validation acc: 0.8458529114723206, corresponding to test acc:                         0.7777777910232544 / 0.8217592835426331
after epoch: 15,now: 2024-07-23 01:07:46.454116,epoch time: 0:01:29.723259,used: 0:21:59.735010,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_00_45_46_seed_2_22755942
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.98756546, 'precision': 0.98762405, 'recall': 0.9875338, 'specificity': 0.9875338, 'f1': 0.98756367, 'auroc': 0.99968773, 'binary_precision': 0.9838917, 'binary_recall': 0.99155843, 'binary_specificity': 0.98350924, 'binary_f1_score': 0.9877102}
confusion matrix:
      0     1
0  1491    25
1    13  1527
---- Validation: 
scalar performance:
{'acc': 0.7801252, 'precision': 0.787776, 'recall': 0.7778238, 'specificity': 0.7778238, 'f1': 0.7775691, 'auroc': 0.854509, 'binary_precision': 0.82851636, 'binary_recall': 0.69131833, 'binary_specificity': 0.8643293, 'binary_f1_score': 0.7537248}
confusion matrix:
     0    1
0  567   89
1  192  430
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7638889, 'precision': 0.7829044, 'recall': 0.7638889, 'specificity': 0.7638889, 'f1': 0.7598535, 'auroc': 0.89156806, 'binary_precision': 0.70955884, 'binary_recall': 0.8935185, 'binary_specificity': 0.6342593, 'binary_f1_score': 0.79098356}
confusion matrix:
     0    1
0  137   79
1   23  193
early stop counter: 2
val acc:0.7801252007484436, best validation acc: 0.8458529114723206, corresponding to test acc:                         0.7777777910232544 / 0.8217592835426331
after epoch: 16,now: 2024-07-23 01:09:15.886824,epoch time: 0:01:29.432708,used: 0:23:29.167718,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_00_45_46_seed_2_22755942
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9921466, 'precision': 0.992152, 'recall': 0.992141, 'specificity': 0.992141, 'f1': 0.992146, 'auroc': 0.99982476, 'binary_precision': 0.9915694, 'binary_recall': 0.99285716, 'binary_specificity': 0.9914248, 'binary_f1_score': 0.9922129}
confusion matrix:
      0     1
0  1503    13
1    11  1529
---- Validation: 
scalar performance:
{'acc': 0.8435055, 'precision': 0.8544676, 'recall': 0.8411448, 'specificity': 0.8411448, 'f1': 0.84154934, 'auroc': 0.9107472, 'binary_precision': 0.91050583, 'binary_recall': 0.7524116, 'binary_specificity': 0.92987806, 'binary_f1_score': 0.82394373}
confusion matrix:
     0    1
0  610   46
1  154  468
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8310185, 'precision': 0.83262265, 'recall': 0.8310185, 'specificity': 0.8310185, 'f1': 0.83081454, 'auroc': 0.91229427, 'binary_precision': 0.8557214, 'binary_recall': 0.7962963, 'binary_specificity': 0.8657407, 'binary_f1_score': 0.8249401}
confusion matrix:
     0    1
0  187   29
1   44  172
new oracle model saved
early stop counter: 3
val acc:0.8435055017471313, best validation acc: 0.8458529114723206, corresponding to test acc:                         0.7777777910232544 / 0.8310185074806213
after epoch: 17,now: 2024-07-23 01:10:45.440468,epoch time: 0:01:29.553644,used: 0:24:58.721362,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_00_45_46_seed_2_22755942
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.99443716, 'precision': 0.9944468, 'recall': 0.99447536, 'specificity': 0.99447536, 'f1': 0.9944371, 'auroc': 0.99983644, 'binary_precision': 0.9993443, 'binary_recall': 0.9896104, 'binary_specificity': 0.99934036, 'binary_f1_score': 0.9944535}
confusion matrix:
      0     1
0  1515     1
1    16  1524
---- Validation: 
scalar performance:
{'acc': 0.74882627, 'precision': 0.81343913, 'recall': 0.7426697, 'specificity': 0.7426697, 'f1': 0.73191315, 'auroc': 0.88303614, 'binary_precision': 0.94925374, 'binary_recall': 0.511254, 'binary_specificity': 0.9740854, 'binary_f1_score': 0.66457677}
confusion matrix:
     0    1
0  639   17
1  304  318
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6180556, 'precision': 0.77420723, 'recall': 0.6180556, 'specificity': 0.6180556, 'f1': 0.5546531, 'auroc': 0.88809586, 'binary_precision': 0.9811321, 'binary_recall': 0.24074075, 'binary_specificity': 0.9953704, 'binary_f1_score': 0.38661712}
confusion matrix:
     0   1
0  215   1
1  164  52
early stop counter: 4
val acc:0.748826265335083, best validation acc: 0.8458529114723206, corresponding to test acc:                         0.7777777910232544 / 0.8310185074806213
after epoch: 18,now: 2024-07-23 01:12:15.204309,epoch time: 0:01:29.763841,used: 0:26:28.485203,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_00_45_46_seed_2_22755942
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.99247384, 'precision': 0.9924766, 'recall': 0.99250674, 'specificity': 0.99250674, 'f1': 0.9924737, 'auroc': 0.99901474, 'binary_precision': 0.9967256, 'binary_recall': 0.9883117, 'binary_specificity': 0.99670184, 'binary_f1_score': 0.99250084}
confusion matrix:
      0     1
0  1511     5
1    18  1522
---- Validation: 
scalar performance:
{'acc': 0.80985916, 'precision': 0.8355721, 'recall': 0.80612063, 'specificity': 0.80612063, 'f1': 0.8047364, 'auroc': 0.87247324, 'binary_precision': 0.922049, 'binary_recall': 0.6655949, 'binary_specificity': 0.94664633, 'binary_f1_score': 0.7731092}
confusion matrix:
     0    1
0  621   35
1  208  414
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7847222, 'precision': 0.79647154, 'recall': 0.7847222, 'specificity': 0.7847222, 'f1': 0.782568, 'auroc': 0.8579604, 'binary_precision': 0.85549134, 'binary_recall': 0.6851852, 'binary_specificity': 0.8842593, 'binary_f1_score': 0.7609255}
confusion matrix:
     0    1
0  191   25
1   68  148
early stop counter: 5
val acc:0.8098591566085815, best validation acc: 0.8458529114723206, corresponding to test acc:                         0.7777777910232544 / 0.8310185074806213
after epoch: 19,now: 2024-07-23 01:13:45.040752,epoch time: 0:01:29.836443,used: 0:27:58.321646,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_00_45_46_seed_2_22755942
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9816754, 'precision': 0.9818266, 'recall': 0.9816177, 'specificity': 0.9816177, 'f1': 0.9816712, 'auroc': 0.9991729, 'binary_precision': 0.97503203, 'binary_recall': 0.98896104, 'binary_specificity': 0.9742744, 'binary_f1_score': 0.9819471}
confusion matrix:
      0     1
0  1477    39
1    17  1523
---- Validation: 
scalar performance:
{'acc': 0.7543036, 'precision': 0.7906264, 'recall': 0.7494633, 'specificity': 0.7494633, 'f1': 0.7438649, 'auroc': 0.8546101, 'binary_precision': 0.8869347, 'binary_recall': 0.56752414, 'binary_specificity': 0.93140244, 'binary_f1_score': 0.6921569}
confusion matrix:
     0    1
0  611   45
1  269  353
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.775463, 'precision': 0.8109832, 'recall': 0.775463, 'specificity': 0.775463, 'f1': 0.76886296, 'auroc': 0.85405946, 'binary_precision': 0.91608393, 'binary_recall': 0.6064815, 'binary_specificity': 0.9444444, 'binary_f1_score': 0.72980505}
confusion matrix:
     0    1
0  204   12
1   85  131
early stop counter: 6
val acc:0.7543035745620728, best validation acc: 0.8458529114723206, corresponding to test acc:                         0.7777777910232544 / 0.8310185074806213
after epoch: 20,now: 2024-07-23 01:15:14.237134,epoch time: 0:01:29.196382,used: 0:29:27.518028,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_00_45_46_seed_2_22755942
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9908377, 'precision': 0.99087167, 'recall': 0.99088854, 'specificity': 0.99088854, 'f1': 0.9908377, 'auroc': 0.9992282, 'binary_precision': 0.9973684, 'binary_recall': 0.9844156, 'binary_specificity': 0.9973615, 'binary_f1_score': 0.9908497}
confusion matrix:
      0     1
0  1512     4
1    24  1516
---- Validation: 
scalar performance:
{'acc': 0.79890454, 'precision': 0.83789223, 'recall': 0.79432493, 'specificity': 0.79432493, 'f1': 0.7911014, 'auroc': 0.8982825, 'binary_precision': 0.94621027, 'binary_recall': 0.6221865, 'binary_specificity': 0.9664634, 'binary_f1_score': 0.7507274}
confusion matrix:
     0    1
0  634   22
1  235  387
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8449074, 'precision': 0.8475969, 'recall': 0.8449074, 'specificity': 0.8449074, 'f1': 0.8446068, 'auroc': 0.91128683, 'binary_precision': 0.8781726, 'binary_recall': 0.8009259, 'binary_specificity': 0.8888889, 'binary_f1_score': 0.8377724}
confusion matrix:
     0    1
0  192   24
1   43  173
new oracle model saved
early stop counter: 7
val acc:0.798904538154602, best validation acc: 0.8458529114723206, corresponding to test acc:                         0.7777777910232544 / 0.8449074029922485
after epoch: 21,now: 2024-07-23 01:16:44.683820,epoch time: 0:01:30.446686,used: 0:30:57.964714,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_00_45_46_seed_2_22755942
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9921466, 'precision': 0.99219334, 'recall': 0.99220264, 'specificity': 0.99220264, 'f1': 0.9921466, 'auroc': 0.9998715, 'binary_precision': 0.99934125, 'binary_recall': 0.9850649, 'binary_specificity': 0.99934036, 'binary_f1_score': 0.9921517}
confusion matrix:
      0     1
0  1515     1
1    23  1517
---- Validation: 
scalar performance:
{'acc': 0.75117373, 'precision': 0.82188934, 'recall': 0.7448313, 'specificity': 0.7448313, 'f1': 0.73339784, 'auroc': 0.90496516, 'binary_precision': 0.9662577, 'binary_recall': 0.50643086, 'binary_specificity': 0.9832317, 'binary_f1_score': 0.664557}
confusion matrix:
     0    1
0  645   11
1  307  315
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7361111, 'precision': 0.7781818, 'recall': 0.73611116, 'specificity': 0.73611116, 'f1': 0.7257418, 'auroc': 0.8655907, 'binary_precision': 0.8863636, 'binary_recall': 0.5416667, 'binary_specificity': 0.9305556, 'binary_f1_score': 0.6724138}
confusion matrix:
     0    1
0  201   15
1   99  117
early stop counter: 8
val acc:0.751173734664917, best validation acc: 0.8458529114723206, corresponding to test acc:                         0.7777777910232544 / 0.8449074029922485
after epoch: 22,now: 2024-07-23 01:18:15.115715,epoch time: 0:01:30.431895,used: 0:32:28.396609,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_00_45_46_seed_2_22755942
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.9849476, 'precision': 0.9851048, 'recall': 0.9850341, 'specificity': 0.9850341, 'f1': 0.98494744, 'auroc': 0.9990323, 'binary_precision': 0.99601597, 'binary_recall': 0.97402596, 'binary_specificity': 0.9960422, 'binary_f1_score': 0.9848982}
confusion matrix:
      0     1
0  1510     6
1    40  1500
---- Validation: 
scalar performance:
{'acc': 0.771518, 'precision': 0.8222157, 'recall': 0.7661482, 'specificity': 0.7661482, 'f1': 0.75964886, 'auroc': 0.8886307, 'binary_precision': 0.9435484, 'binary_recall': 0.5643087, 'binary_specificity': 0.9679878, 'binary_f1_score': 0.7062375}
confusion matrix:
     0    1
0  635   21
1  271  351
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5439815, 'precision': 0.7181355, 'recall': 0.5439815, 'specificity': 0.5439815, 'f1': 0.43026608, 'auroc': 0.8297968, 'binary_precision': 0.9130435, 'binary_recall': 0.097222224, 'binary_specificity': 0.9907407, 'binary_f1_score': 0.17573223}
confusion matrix:
     0   1
0  214   2
1  195  21
early stop counter: 9
val acc:0.7715179920196533, best validation acc: 0.8458529114723206, corresponding to test acc:                         0.7777777910232544 / 0.8449074029922485
after epoch: 23,now: 2024-07-23 01:19:44.130962,epoch time: 0:01:29.015247,used: 0:33:57.411856,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_00_45_46_seed_2_22755942
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9931283, 'precision': 0.99316746, 'recall': 0.9931047, 'specificity': 0.9931047, 'f1': 0.99312747, 'auroc': 0.9998038, 'binary_precision': 0.99031633, 'binary_recall': 0.9961039, 'binary_specificity': 0.99010557, 'binary_f1_score': 0.99320173}
confusion matrix:
      0     1
0  1501    15
1     6  1534
---- Validation: 
scalar performance:
{'acc': 0.84428793, 'precision': 0.8563299, 'recall': 0.8418237, 'specificity': 0.8418237, 'f1': 0.84220016, 'auroc': 0.905826, 'binary_precision': 0.9155206, 'binary_recall': 0.7491961, 'binary_specificity': 0.9344512, 'binary_f1_score': 0.82404953}
confusion matrix:
     0    1
0  613   43
1  156  466
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8402778, 'precision': 0.8441802, 'recall': 0.8402778, 'specificity': 0.8402778, 'f1': 0.8398237, 'auroc': 0.92138207, 'binary_precision': 0.88082904, 'binary_recall': 0.787037, 'binary_specificity': 0.8935185, 'binary_f1_score': 0.83129585}
confusion matrix:
     0    1
0  193   23
1   46  170
early stop counter: 10
val acc:0.8442879319190979, best validation acc: 0.8458529114723206, corresponding to test acc:                         0.7777777910232544 / 0.8449074029922485
after epoch: 24,now: 2024-07-23 01:21:13.800394,epoch time: 0:01:29.669432,used: 0:35:27.081288,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_00_45_46_seed_2_22755942
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.99345547, 'precision': 0.9934555, 'recall': 0.9934859, 'specificity': 0.9934859, 'f1': 0.9934554, 'auroc': 0.99988306, 'binary_precision': 0.9973822, 'binary_recall': 0.9896104, 'binary_specificity': 0.9973615, 'binary_f1_score': 0.9934811}
confusion matrix:
      0     1
0  1512     4
1    16  1524
---- Validation: 
scalar performance:
{'acc': 0.74334896, 'precision': 0.81654876, 'recall': 0.7368344, 'specificity': 0.7368344, 'f1': 0.72404677, 'auroc': 0.9065882, 'binary_precision': 0.9622642, 'binary_recall': 0.49196142, 'binary_specificity': 0.98170733, 'binary_f1_score': 0.65106386}
confusion matrix:
     0    1
0  644   12
1  316  306
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7476852, 'precision': 0.80404925, 'recall': 0.7476852, 'specificity': 0.7476852, 'f1': 0.7354235, 'auroc': 0.87669325, 'binary_precision': 0.93495935, 'binary_recall': 0.5324074, 'binary_specificity': 0.962963, 'binary_f1_score': 0.6784661}
confusion matrix:
     0    1
0  208    8
1  101  115
early stop counter: 11
val acc:0.7433489561080933, best validation acc: 0.8458529114723206, corresponding to test acc:                         0.7777777910232544 / 0.8449074029922485
after epoch: 25,now: 2024-07-23 01:22:44.231413,epoch time: 0:01:30.431019,used: 0:36:57.512307,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_00_45_46_seed_2_22755942
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9931283, 'precision': 0.99313724, 'recall': 0.99312013, 'specificity': 0.99312013, 'f1': 0.9931278, 'auroc': 0.9996046, 'binary_precision': 0.99222296, 'binary_recall': 0.9941558, 'binary_specificity': 0.99208444, 'binary_f1_score': 0.9931885}
confusion matrix:
      0     1
0  1504    12
1     9  1531
---- Validation: 
scalar performance:
{'acc': 0.85367763, 'precision': 0.8562969, 'recall': 0.8525115, 'specificity': 0.8525115, 'f1': 0.85302746, 'auroc': 0.9148768, 'binary_precision': 0.8809107, 'binary_recall': 0.80868167, 'binary_specificity': 0.89634144, 'binary_f1_score': 0.84325236}
confusion matrix:
     0    1
0  588   68
1  119  503
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8194444, 'precision': 0.81947184, 'recall': 0.8194444, 'specificity': 0.8194444, 'f1': 0.8194406, 'auroc': 0.8860382, 'binary_precision': 0.8224299, 'binary_recall': 0.8148148, 'binary_specificity': 0.8240741, 'binary_f1_score': 0.81860465}
confusion matrix:
     0    1
0  178   38
1   40  176
better model found
persisted
after epoch: 26,now: 2024-07-23 01:24:13.505300,epoch time: 0:01:29.273887,used: 0:38:26.786194,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_00_45_46_seed_2_22755942
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.9908377, 'precision': 0.99091494, 'recall': 0.990904, 'specificity': 0.990904, 'f1': 0.9908377, 'auroc': 0.999776, 'binary_precision': 0.9993395, 'binary_recall': 0.98246753, 'binary_specificity': 0.99934036, 'binary_f1_score': 0.99083173}
confusion matrix:
      0     1
0  1515     1
1    27  1513
---- Validation: 
scalar performance:
{'acc': 0.6040689, 'precision': 0.7663666, 'recall': 0.59341425, 'specificity': 0.59341425, 'f1': 0.52107894, 'auroc': 0.8962306, 'binary_precision': 0.9677419, 'binary_recall': 0.19292605, 'binary_specificity': 0.99390244, 'binary_f1_score': 0.32171583}
confusion matrix:
     0    1
0  652    4
1  502  120
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5648148, 'precision': 0.7673267, 'recall': 0.5648148, 'specificity': 0.5648148, 'f1': 0.4631412, 'auroc': 0.9115441, 'binary_precision': 1.0, 'binary_recall': 0.12962963, 'binary_specificity': 1.0, 'binary_f1_score': 0.22950819}
confusion matrix:
     0   1
0  216   0
1  188  28
early stop counter: 1
val acc:0.6040688753128052, best validation acc: 0.8536776304244995, corresponding to test acc:                         0.8194444179534912 / 0.8449074029922485
after epoch: 27,now: 2024-07-23 01:25:43.432729,epoch time: 0:01:29.927429,used: 0:39:56.713623,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_00_45_46_seed_2_22755942
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.9947644, 'precision': 0.99475753, 'recall': 0.9947846, 'specificity': 0.9947846, 'f1': 0.9947642, 'auroc': 0.99991345, 'binary_precision': 0.997389, 'binary_recall': 0.99220777, 'binary_specificity': 0.9973615, 'binary_f1_score': 0.99479157}
confusion matrix:
      0     1
0  1512     4
1    12  1528
---- Validation: 
scalar performance:
{'acc': 0.771518, 'precision': 0.8148761, 'recall': 0.7664815, 'specificity': 0.7664815, 'f1': 0.76100826, 'auroc': 0.89247906, 'binary_precision': 0.92525774, 'binary_recall': 0.57717043, 'binary_specificity': 0.95579267, 'binary_f1_score': 0.71089107}
confusion matrix:
     0    1
0  627   29
1  263  359
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8333333, 'precision': 0.838234, 'recall': 0.8333333, 'specificity': 0.8333333, 'f1': 0.83272743, 'auroc': 0.9026706, 'binary_precision': 0.8789474, 'binary_recall': 0.7731481, 'binary_specificity': 0.8935185, 'binary_f1_score': 0.82266}
confusion matrix:
     0    1
0  193   23
1   49  167
early stop counter: 2
val acc:0.7715179920196533, best validation acc: 0.8536776304244995, corresponding to test acc:                         0.8194444179534912 / 0.8449074029922485
after epoch: 28,now: 2024-07-23 01:27:12.906049,epoch time: 0:01:29.473320,used: 0:41:26.186943,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_00_45_46_seed_2_22755942
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9941099, 'precision': 0.9941031, 'recall': 0.99413013, 'specificity': 0.99413013, 'f1': 0.99410975, 'auroc': 0.9997002, 'binary_precision': 0.9967363, 'binary_recall': 0.99155843, 'binary_specificity': 0.99670184, 'binary_f1_score': 0.9941406}
confusion matrix:
      0     1
0  1511     5
1    13  1527
---- Validation: 
scalar performance:
{'acc': 0.7394366, 'precision': 0.76296985, 'recall': 0.73527324, 'specificity': 0.73527324, 'f1': 0.7311019, 'auroc': 0.850948, 'binary_precision': 0.8352668, 'binary_recall': 0.57877815, 'binary_specificity': 0.8917683, 'binary_f1_score': 0.6837607}
confusion matrix:
     0    1
0  585   71
1  262  360
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8310185, 'precision': 0.83119595, 'recall': 0.8310185, 'specificity': 0.8310185, 'f1': 0.8309959, 'auroc': 0.9117584, 'binary_precision': 0.8235294, 'binary_recall': 0.8425926, 'binary_specificity': 0.8194444, 'binary_f1_score': 0.832952}
confusion matrix:
     0    1
0  177   39
1   34  182
early stop counter: 3
val acc:0.7394366264343262, best validation acc: 0.8536776304244995, corresponding to test acc:                         0.8194444179534912 / 0.8449074029922485
after epoch: 29,now: 2024-07-23 01:28:43.051325,epoch time: 0:01:30.145276,used: 0:42:56.332219,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_00_45_46_seed_2_22755942
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.9918194, 'precision': 0.9918717, 'recall': 0.9917906, 'specificity': 0.9917906, 'f1': 0.9918183, 'auroc': 0.99983335, 'binary_precision': 0.98839456, 'binary_recall': 0.99545455, 'binary_specificity': 0.98812664, 'binary_f1_score': 0.991912}
confusion matrix:
      0     1
0  1498    18
1     7  1533
---- Validation: 
scalar performance:
{'acc': 0.82472616, 'precision': 0.8421099, 'recall': 0.82168555, 'specificity': 0.82168555, 'f1': 0.8214157, 'auroc': 0.9075955, 'binary_precision': 0.9128631, 'binary_recall': 0.7073955, 'binary_specificity': 0.9359756, 'binary_f1_score': 0.79710144}
confusion matrix:
     0    1
0  614   42
1  182  440
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8009259, 'precision': 0.8018576, 'recall': 0.8009259, 'specificity': 0.8009259, 'f1': 0.80077213, 'auroc': 0.85819614, 'binary_precision': 0.8186275, 'binary_recall': 0.7731481, 'binary_specificity': 0.8287037, 'binary_f1_score': 0.795238}
confusion matrix:
     0    1
0  179   37
1   49  167
early stop counter: 4
val acc:0.8247261643409729, best validation acc: 0.8536776304244995, corresponding to test acc:                         0.8194444179534912 / 0.8449074029922485
after epoch: 30,now: 2024-07-23 01:30:14.021129,epoch time: 0:01:30.969804,used: 0:44:27.302023,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_23_00_45_46_seed_2_22755942
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 0:44:27.302023 at 2024-07-23 01:30:14.021129
persisted model performance metric: 

scalar performance:
{'acc': 0.8194444, 'precision': 0.81947184, 'recall': 0.8194444, 'specificity': 0.8194444, 'f1': 0.8194406, 'auroc': 0.8860382, 'binary_precision': 0.8224299, 'binary_recall': 0.8148148, 'binary_specificity': 0.8240741, 'binary_f1_score': 0.81860465}
confusion matrix:
     0    1
0  178   38
1   40  176
oracle model performance metric: 

scalar performance:
{'acc': 0.8449074, 'precision': 0.8475969, 'recall': 0.8449074, 'specificity': 0.8449074, 'f1': 0.8446068, 'auroc': 0.91128683, 'binary_precision': 0.8781726, 'binary_recall': 0.8009259, 'binary_specificity': 0.8888889, 'binary_f1_score': 0.8377724}
confusion matrix:
     0    1
0  192   24
1   43  173
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_higherregularization_irm_dial_lr1e5_bs16_nofreeze_2024-07-22_16-00-54/rule_results/0.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_higherregularization_irm_dial_lr1e5_bs16_nofreeze_2024-07-22_16-00-54/confusion_matrix/0.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 455396 KiB |  13219 MiB | 223317 GiB | 223317 GiB |
|       from large pool | 414803 KiB |  13181 MiB | 220652 GiB | 220651 GiB |
|       from small pool |  40592 KiB |     60 MiB |   2665 GiB |   2665 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 455396 KiB |  13219 MiB | 223317 GiB | 223317 GiB |
|       from large pool | 414803 KiB |  13181 MiB | 220652 GiB | 220651 GiB |
|       from small pool |  40592 KiB |     60 MiB |   2665 GiB |   2665 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 447481 KiB |  13213 MiB | 222695 GiB | 222695 GiB |
|       from large pool | 407075 KiB |  13175 MiB | 220036 GiB | 220035 GiB |
|       from small pool |  40406 KiB |     60 MiB |   2659 GiB |   2659 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  14478 MiB |  14482 MiB |  41642 MiB |  27164 MiB |
|       from large pool |  14412 MiB |  14412 MiB |  41542 MiB |  27130 MiB |
|       from small pool |     66 MiB |     70 MiB |    100 MiB |     34 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 445724 KiB |   1236 MiB | 156876 GiB | 156876 GiB |
|       from large pool | 435116 KiB |   1229 MiB | 154194 GiB | 154194 GiB |
|       from small pool |  10607 KiB |     43 MiB |   2681 GiB |   2681 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    1298    |    2598    |   39283 K  |   39282 K  |
|       from large pool |     187    |    1413    |   20061 K  |   20061 K  |
|       from small pool |    1111    |    1419    |   19222 K  |   19221 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    1298    |    2598    |   39283 K  |   39282 K  |
|       from large pool |     187    |    1413    |   20061 K  |   20061 K  |
|       from small pool |    1111    |    1419    |   19222 K  |   19221 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     635    |     637    |    1780    |    1145    |
|       from large pool |     602    |     602    |    1730    |    1128    |
|       from small pool |      33    |      35    |      50    |      17    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      96    |     652    |   27118 K  |   27118 K  |
|       from large pool |      38    |     605    |   15639 K  |   15639 K  |
|       from small pool |      58    |     235    |   11479 K  |   11478 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13219 MiB | 223317 GiB | 223317 GiB |
|       from large pool |  16640 KiB |  13181 MiB | 220652 GiB | 220652 GiB |
|       from small pool |      0 KiB |     60 MiB |   2665 GiB |   2665 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13219 MiB | 223317 GiB | 223317 GiB |
|       from large pool |  16640 KiB |  13181 MiB | 220652 GiB | 220652 GiB |
|       from small pool |      0 KiB |     60 MiB |   2665 GiB |   2665 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13213 MiB | 222695 GiB | 222695 GiB |
|       from large pool |  16640 KiB |  13175 MiB | 220036 GiB | 220036 GiB |
|       from small pool |      0 KiB |     60 MiB |   2659 GiB |   2659 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    880 MiB |  14482 MiB |  41642 MiB |  40762 MiB |
|       from large pool |    830 MiB |  14412 MiB |  41542 MiB |  40712 MiB |
|       from small pool |     50 MiB |     70 MiB |    100 MiB |     50 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1236 MiB | 156876 GiB | 156876 GiB |
|       from large pool |  24320 KiB |   1229 MiB | 154195 GiB | 154195 GiB |
|       from small pool |      0 KiB |     43 MiB |   2681 GiB |   2681 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    2598    |   39283 K  |   39283 K  |
|       from large pool |       2    |    1413    |   20061 K  |   20061 K  |
|       from small pool |       0    |    1419    |   19222 K  |   19222 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    2598    |   39283 K  |   39283 K  |
|       from large pool |       2    |    1413    |   20061 K  |   20061 K  |
|       from small pool |       0    |    1419    |   19222 K  |   19222 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      62    |     637    |    1780    |    1718    |
|       from large pool |      37    |     602    |    1730    |    1693    |
|       from small pool |      25    |      35    |      50    |      25    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |     652    |   27118 K  |   27118 K  |
|       from large pool |       4    |     605    |   15639 K  |   15639 K  |
|       from small pool |       0    |     235    |   11479 K  |   11479 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Tue Jul 23 01:31:01 2024]
Finished job 0.
1 of 1 steps (100%) done
