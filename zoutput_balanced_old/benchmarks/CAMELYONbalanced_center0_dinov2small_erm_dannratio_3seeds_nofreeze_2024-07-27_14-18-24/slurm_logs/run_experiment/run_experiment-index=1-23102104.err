Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Sat Jul 27 14:20:52 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_dannratio_10seeds_nofreeze_2024-07-27_14-18-24/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_dannratio_10seeds_nofreeze_2024-07-27_14-18-24/rule_results/1.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=1
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/swiglu_ffn.py:51: UserWarning: xFormers is not available (SwiGLU)
  warnings.warn("xFormers is not available (SwiGLU)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/attention.py:33: UserWarning: xFormers is not available (Attention)
  warnings.warn("xFormers is not available (Attention)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/block.py:40: UserWarning: xFormers is not available (Block)
  warnings.warn("xFormers is not available (Block)")
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center0_dann_b8efecac6_not_commited_2024md_07md_27_14_22_39_seed_0_23102104

 Experiment start at: 2024-07-27 14:22:39.339816
before training, model accuracy: 0.49534884095191956
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.8902995, 'precision': 0.8931753, 'recall': 0.88977927, 'specificity': 0.88977927, 'f1': 0.88998973, 'auroc': 0.97026885, 'binary_precision': 0.8625, 'binary_recall': 0.9318328, 'binary_specificity': 0.84772575, 'binary_f1_score': 0.89582694}
confusion matrix:
      0     1
0  1286   231
1   106  1449
---- Validation: 
scalar performance:
{'acc': 0.70574534, 'precision': 0.7393215, 'recall': 0.70830333, 'specificity': 0.70830333, 'f1': 0.69665205, 'auroc': 0.6765721, 'binary_precision': 0.6461187, 'binary_recall': 0.8913386, 'binary_specificity': 0.525268, 'binary_f1_score': 0.74917275}
confusion matrix:
     0    1
0  343  310
1   69  566
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7348837, 'precision': 0.7726303, 'recall': 0.73488367, 'specificity': 0.73488367, 'f1': 0.72537816, 'auroc': 0.78578687, 'binary_precision': 0.67118645, 'binary_recall': 0.9209302, 'binary_specificity': 0.5488372, 'binary_f1_score': 0.77647066}
confusion matrix:
     0    1
0  118   97
1   17  198
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-27 14:25:19.954311,epoch time: 0:02:40.614495,used: 0:02:40.614495,model: dset_te_center0_dann_b8efecac6_not_commited_2024md_07md_27_14_22_39_seed_0_23102104
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9248047, 'precision': 0.932879, 'recall': 0.9257655, 'specificity': 0.9257655, 'f1': 0.9245543, 'auroc': 0.9853387, 'binary_precision': 0.9955157, 'binary_recall': 0.85549134, 'binary_specificity': 0.9960396, 'binary_f1_score': 0.9202073}
confusion matrix:
      0     1
0  1509     6
1   225  1332
---- Validation: 
scalar performance:
{'acc': 0.73136646, 'precision': 0.73177433, 'recall': 0.73161787, 'specificity': 0.73161787, 'f1': 0.7313503, 'auroc': 0.77846646, 'binary_precision': 0.71794873, 'binary_recall': 0.7496063, 'binary_specificity': 0.7136294, 'binary_f1_score': 0.7334361}
confusion matrix:
     0    1
0  466  187
1  159  476
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7186046, 'precision': 0.72324586, 'recall': 0.7186047, 'specificity': 0.7186047, 'f1': 0.71713454, 'auroc': 0.75701463, 'binary_precision': 0.6910569, 'binary_recall': 0.7906977, 'binary_specificity': 0.6465116, 'binary_f1_score': 0.7375272}
confusion matrix:
     0    1
0  139   76
1   45  170
better model found
persisted
after epoch: 2,now: 2024-07-27 14:27:17.274026,epoch time: 0:01:57.319715,used: 0:04:37.934210,model: dset_te_center0_dann_b8efecac6_not_commited_2024md_07md_27_14_22_39_seed_0_23102104
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.95963544, 'precision': 0.9596251, 'recall': 0.9596937, 'specificity': 0.9596937, 'f1': 0.95963335, 'auroc': 0.9921397, 'binary_precision': 0.9649123, 'binary_recall': 0.95498395, 'binary_specificity': 0.96440345, 'binary_f1_score': 0.9599225}
confusion matrix:
      0     1
0  1463    54
1    70  1485
---- Validation: 
scalar performance:
{'acc': 0.7329193, 'precision': 0.76476145, 'recall': 0.73529804, 'specificity': 0.73529804, 'f1': 0.7259079, 'auroc': 0.8318518, 'binary_precision': 0.669383, 'binary_recall': 0.9055118, 'binary_specificity': 0.5650842, 'binary_f1_score': 0.7697456}
confusion matrix:
     0    1
0  369  284
1   60  575
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7627907, 'precision': 0.7981055, 'recall': 0.7627907, 'specificity': 0.7627907, 'f1': 0.7555511, 'auroc': 0.90429413, 'binary_precision': 0.69550174, 'binary_recall': 0.9348837, 'binary_specificity': 0.59069765, 'binary_f1_score': 0.79761904}
confusion matrix:
     0    1
0  127   88
1   14  201
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-07-27 14:29:14.863824,epoch time: 0:01:57.589798,used: 0:06:35.524008,model: dset_te_center0_dann_b8efecac6_not_commited_2024md_07md_27_14_22_39_seed_0_23102104
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9638672, 'precision': 0.9639423, 'recall': 0.9640137, 'specificity': 0.9640137, 'f1': 0.9638667, 'auroc': 0.9928167, 'binary_precision': 0.9744262, 'binary_recall': 0.9537869, 'binary_specificity': 0.9742404, 'binary_f1_score': 0.9639961}
confusion matrix:
      0     1
0  1475    39
1    72  1486
---- Validation: 
scalar performance:
{'acc': 0.6568323, 'precision': 0.66844857, 'recall': 0.65487695, 'specificity': 0.65487695, 'f1': 0.6490334, 'auroc': 0.7310077, 'binary_precision': 0.7093276, 'binary_recall': 0.51496065, 'binary_specificity': 0.79479325, 'binary_f1_score': 0.5967154}
confusion matrix:
     0    1
0  519  134
1  308  327
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.74651164, 'precision': 0.7465596, 'recall': 0.7465116, 'specificity': 0.7465116, 'f1': 0.7464993, 'auroc': 0.80633855, 'binary_precision': 0.75, 'binary_recall': 0.73953485, 'binary_specificity': 0.75348836, 'binary_f1_score': 0.74473065}
confusion matrix:
     0    1
0  162   53
1   56  159
early stop counter: 1
val acc:0.6568322777748108, best validation acc: 0.7329192757606506, corresponding to test acc:                         0.7627906799316406 / 0.7627906799316406
after epoch: 4,now: 2024-07-27 14:31:11.572720,epoch time: 0:01:56.708896,used: 0:08:32.232904,model: dset_te_center0_dann_b8efecac6_not_commited_2024md_07md_27_14_22_39_seed_0_23102104
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9479167, 'precision': 0.9512807, 'recall': 0.9485098, 'specificity': 0.9485098, 'f1': 0.94785917, 'auroc': 0.9925847, 'binary_precision': 0.99363506, 'binary_recall': 0.9029563, 'binary_specificity': 0.9940633, 'binary_f1_score': 0.9461279}
confusion matrix:
      0     1
0  1507     9
1   151  1405
---- Validation: 
scalar performance:
{'acc': 0.5333851, 'precision': 0.6096525, 'recall': 0.52733594, 'specificity': 0.52733594, 'f1': 0.42122316, 'auroc': 0.7389685, 'binary_precision': 0.6976744, 'binary_recall': 0.09448819, 'binary_specificity': 0.96018374, 'binary_f1_score': 0.16643551}
confusion matrix:
     0   1
0  627  26
1  575  60
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.48604652, 'precision': 0.4338054, 'recall': 0.48604652, 'specificity': 0.48604652, 'f1': 0.35971808, 'auroc': 0.8062087, 'binary_precision': 0.375, 'binary_recall': 0.041860465, 'binary_specificity': 0.9302326, 'binary_f1_score': 0.07531381}
confusion matrix:
     0   1
0  200  15
1  206   9
early stop counter: 2
val acc:0.5333850979804993, best validation acc: 0.7329192757606506, corresponding to test acc:                         0.7627906799316406 / 0.7627906799316406
after epoch: 5,now: 2024-07-27 14:33:08.992340,epoch time: 0:01:57.419620,used: 0:10:29.652524,model: dset_te_center0_dann_b8efecac6_not_commited_2024md_07md_27_14_22_39_seed_0_23102104
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9632161, 'precision': 0.9649255, 'recall': 0.96364653, 'specificity': 0.96364653, 'f1': 0.9632007, 'auroc': 0.9951842, 'binary_precision': 0.99655885, 'binary_recall': 0.9305913, 'binary_specificity': 0.99670184, 'binary_f1_score': 0.962446}
confusion matrix:
      0     1
0  1511     5
1   108  1448
---- Validation: 
scalar performance:
{'acc': 0.63509315, 'precision': 0.66989005, 'recall': 0.6318096, 'specificity': 0.6318096, 'f1': 0.61203533, 'auroc': 0.7388661, 'binary_precision': 0.74336284, 'binary_recall': 0.3968504, 'binary_specificity': 0.8667688, 'binary_f1_score': 0.51745385}
confusion matrix:
     0    1
0  566   87
1  383  252
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7627907, 'precision': 0.77321696, 'recall': 0.7627907, 'specificity': 0.7627907, 'f1': 0.7605058, 'auroc': 0.7646836, 'binary_precision': 0.71984434, 'binary_recall': 0.8604651, 'binary_specificity': 0.66511625, 'binary_f1_score': 0.7838983}
confusion matrix:
     0    1
0  143   72
1   30  185
early stop counter: 3
val acc:0.6350931525230408, best validation acc: 0.7329192757606506, corresponding to test acc:                         0.7627906799316406 / 0.7627906799316406
after epoch: 6,now: 2024-07-27 14:35:05.705063,epoch time: 0:01:56.712723,used: 0:12:26.365247,model: dset_te_center0_dann_b8efecac6_not_commited_2024md_07md_27_14_22_39_seed_0_23102104
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9661458, 'precision': 0.9661255, 'recall': 0.9661728, 'specificity': 0.9661728, 'f1': 0.9661426, 'auroc': 0.993294, 'binary_precision': 0.9689722, 'binary_recall': 0.9639871, 'binary_specificity': 0.9683586, 'binary_f1_score': 0.9664732}
confusion matrix:
      0     1
0  1469    48
1    56  1499
---- Validation: 
scalar performance:
{'acc': 0.632764, 'precision': 0.63985616, 'recall': 0.6310319, 'specificity': 0.6310319, 'f1': 0.6261748, 'auroc': 0.7219906, 'binary_precision': 0.6680498, 'binary_recall': 0.50708663, 'binary_specificity': 0.75497705, 'binary_f1_score': 0.57654434}
confusion matrix:
     0    1
0  493  160
1  313  322
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.76046515, 'precision': 0.7609223, 'recall': 0.76046515, 'specificity': 0.76046515, 'f1': 0.7603601, 'auroc': 0.77717686, 'binary_precision': 0.75, 'binary_recall': 0.7813954, 'binary_specificity': 0.73953485, 'binary_f1_score': 0.7653758}
confusion matrix:
     0    1
0  159   56
1   47  168
early stop counter: 4
val acc:0.6327639818191528, best validation acc: 0.7329192757606506, corresponding to test acc:                         0.7627906799316406 / 0.7627906799316406
after epoch: 7,now: 2024-07-27 14:37:02.362059,epoch time: 0:01:56.656996,used: 0:14:23.022243,model: dset_te_center0_dann_b8efecac6_not_commited_2024md_07md_27_14_22_39_seed_0_23102104
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.97265625, 'precision': 0.97267014, 'recall': 0.97274065, 'specificity': 0.97274065, 'f1': 0.9726555, 'auroc': 0.9960779, 'binary_precision': 0.97977823, 'binary_recall': 0.9659164, 'binary_specificity': 0.9795649, 'binary_f1_score': 0.9727979}
confusion matrix:
      0     1
0  1486    31
1    53  1502
---- Validation: 
scalar performance:
{'acc': 0.73990685, 'precision': 0.760522, 'recall': 0.73789173, 'specificity': 0.73789173, 'f1': 0.73354626, 'auroc': 0.85133183, 'binary_precision': 0.8303965, 'binary_recall': 0.59370077, 'binary_specificity': 0.8820827, 'binary_f1_score': 0.6923783}
confusion matrix:
     0    1
0  576   77
1  258  377
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.74418604, 'precision': 0.76792705, 'recall': 0.74418604, 'specificity': 0.74418604, 'f1': 0.7383907, 'auroc': 0.84056246, 'binary_precision': 0.8476821, 'binary_recall': 0.59534883, 'binary_specificity': 0.89302325, 'binary_f1_score': 0.69945353}
confusion matrix:
     0    1
0  192   23
1   87  128
better model found
persisted
after epoch: 8,now: 2024-07-27 14:38:59.846735,epoch time: 0:01:57.484676,used: 0:16:20.506919,model: dset_te_center0_dann_b8efecac6_not_commited_2024md_07md_27_14_22_39_seed_0_23102104
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9625651, 'precision': 0.96349907, 'recall': 0.96289366, 'specificity': 0.96289366, 'f1': 0.96255904, 'auroc': 0.9954817, 'binary_precision': 0.9878131, 'binary_recall': 0.9376607, 'binary_specificity': 0.98812664, 'binary_f1_score': 0.96208376}
confusion matrix:
      0     1
0  1498    18
1    97  1459
---- Validation: 
scalar performance:
{'acc': 0.7259317, 'precision': 0.7486707, 'recall': 0.7237619, 'specificity': 0.7237619, 'f1': 0.71822566, 'auroc': 0.82502323, 'binary_precision': 0.82045454, 'binary_recall': 0.5685039, 'binary_specificity': 0.8790199, 'binary_f1_score': 0.6716279}
confusion matrix:
     0    1
0  574   79
1  274  361
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7883721, 'precision': 0.79018635, 'recall': 0.7883721, 'specificity': 0.7883721, 'f1': 0.78804076, 'auroc': 0.86393726, 'binary_precision': 0.76724136, 'binary_recall': 0.82790697, 'binary_specificity': 0.74883723, 'binary_f1_score': 0.7964206}
confusion matrix:
     0    1
0  161   54
1   37  178
new oracle model saved
early stop counter: 1
val acc:0.725931704044342, best validation acc: 0.7399068474769592, corresponding to test acc:                         0.7441860437393188 / 0.7883720993995667
after epoch: 9,now: 2024-07-27 14:40:56.637893,epoch time: 0:01:56.791158,used: 0:18:17.298077,model: dset_te_center0_dann_b8efecac6_not_commited_2024md_07md_27_14_22_39_seed_0_23102104
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9641927, 'precision': 0.96525025, 'recall': 0.9638869, 'specificity': 0.9638869, 'f1': 0.9641484, 'auroc': 0.99700147, 'binary_precision': 0.9463625, 'binary_recall': 0.9852375, 'binary_specificity': 0.94253635, 'binary_f1_score': 0.9654088}
confusion matrix:
      0     1
0  1427    87
1    23  1535
---- Validation: 
scalar performance:
{'acc': 0.71040374, 'precision': 0.710346, 'recall': 0.7103363, 'specificity': 0.7103363, 'f1': 0.71034074, 'auroc': 0.7744293, 'binary_precision': 0.7066246, 'binary_recall': 0.7055118, 'binary_specificity': 0.7151608, 'binary_f1_score': 0.7060678}
confusion matrix:
     0    1
0  467  186
1  187  448
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.727907, 'precision': 0.75760466, 'recall': 0.727907, 'specificity': 0.727907, 'f1': 0.7198323, 'auroc': 0.81038404, 'binary_precision': 0.6701389, 'binary_recall': 0.89767444, 'binary_specificity': 0.55813956, 'binary_f1_score': 0.7673956}
confusion matrix:
     0    1
0  120   95
1   22  193
early stop counter: 2
val acc:0.7104037404060364, best validation acc: 0.7399068474769592, corresponding to test acc:                         0.7441860437393188 / 0.7883720993995667
after epoch: 10,now: 2024-07-27 14:42:53.091736,epoch time: 0:01:56.453843,used: 0:20:13.751920,model: dset_te_center0_dann_b8efecac6_not_commited_2024md_07md_27_14_22_39_seed_0_23102104
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9788411, 'precision': 0.97903734, 'recall': 0.9790286, 'specificity': 0.9790286, 'f1': 0.9788412, 'auroc': 0.9981345, 'binary_precision': 0.9927345, 'binary_recall': 0.9653179, 'binary_specificity': 0.99273926, 'binary_f1_score': 0.9788343}
confusion matrix:
      0     1
0  1504    11
1    54  1503
---- Validation: 
scalar performance:
{'acc': 0.5621118, 'precision': 0.69800615, 'recall': 0.5562094, 'specificity': 0.5562094, 'f1': 0.46270934, 'auroc': 0.8390541, 'binary_precision': 0.85858583, 'binary_recall': 0.13385826, 'binary_specificity': 0.9785605, 'binary_f1_score': 0.23160763}
confusion matrix:
     0   1
0  639  14
1  550  85
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5790698, 'precision': 0.66463965, 'recall': 0.5790698, 'specificity': 0.5790698, 'f1': 0.51620823, 'auroc': 0.8441969, 'binary_precision': 0.78333336, 'binary_recall': 0.21860465, 'binary_specificity': 0.9395349, 'binary_f1_score': 0.34181818}
confusion matrix:
     0   1
0  202  13
1  168  47
early stop counter: 3
val acc:0.5621117949485779, best validation acc: 0.7399068474769592, corresponding to test acc:                         0.7441860437393188 / 0.7883720993995667
after epoch: 11,now: 2024-07-27 14:44:49.634623,epoch time: 0:01:56.542887,used: 0:22:10.294807,model: dset_te_center0_dann_b8efecac6_not_commited_2024md_07md_27_14_22_39_seed_0_23102104
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9827474, 'precision': 0.9827758, 'recall': 0.98286974, 'specificity': 0.98286974, 'f1': 0.9827469, 'auroc': 0.9968331, 'binary_precision': 0.99150884, 'binary_recall': 0.9743261, 'binary_specificity': 0.9914135, 'binary_f1_score': 0.9828424}
confusion matrix:
      0     1
0  1501    13
1    40  1518
---- Validation: 
scalar performance:
{'acc': 0.6498447, 'precision': 0.71546763, 'recall': 0.64590204, 'specificity': 0.64590204, 'f1': 0.61741376, 'auroc': 0.82509315, 'binary_precision': 0.83093524, 'binary_recall': 0.36377952, 'binary_specificity': 0.92802453, 'binary_f1_score': 0.50602406}
confusion matrix:
     0    1
0  606   47
1  404  231
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.76744187, 'precision': 0.77913254, 'recall': 0.76744187, 'specificity': 0.76744187, 'f1': 0.76498115, 'auroc': 0.83238506, 'binary_precision': 0.83625734, 'binary_recall': 0.66511625, 'binary_specificity': 0.8697674, 'binary_f1_score': 0.7409327}
confusion matrix:
     0    1
0  187   28
1   72  143
early stop counter: 4
val acc:0.6498447060585022, best validation acc: 0.7399068474769592, corresponding to test acc:                         0.7441860437393188 / 0.7883720993995667
after epoch: 12,now: 2024-07-27 14:46:46.174076,epoch time: 0:01:56.539453,used: 0:24:06.834260,model: dset_te_center0_dann_b8efecac6_not_commited_2024md_07md_27_14_22_39_seed_0_23102104
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.95214844, 'precision': 0.95354605, 'recall': 0.9518139, 'specificity': 0.9518139, 'f1': 0.95207894, 'auroc': 0.99531984, 'binary_precision': 0.9314146, 'binary_recall': 0.9775064, 'binary_specificity': 0.92612135, 'binary_f1_score': 0.9539041}
confusion matrix:
      0     1
0  1404   112
1    35  1521
---- Validation: 
scalar performance:
{'acc': 0.7445652, 'precision': 0.7795454, 'recall': 0.74205184, 'specificity': 0.74205184, 'f1': 0.73497593, 'auroc': 0.85240495, 'binary_precision': 0.875, 'binary_recall': 0.5622047, 'binary_specificity': 0.9218989, 'binary_f1_score': 0.68456376}
confusion matrix:
     0    1
0  602   51
1  278  357
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.727907, 'precision': 0.8029388, 'recall': 0.72790694, 'specificity': 0.72790694, 'f1': 0.7099469, 'auroc': 0.8952298, 'binary_precision': 0.9537037, 'binary_recall': 0.47906977, 'binary_specificity': 0.9767442, 'binary_f1_score': 0.6377709}
confusion matrix:
     0    1
0  210    5
1  112  103
better model found
persisted
after epoch: 13,now: 2024-07-27 14:48:42.968784,epoch time: 0:01:56.794708,used: 0:26:03.628968,model: dset_te_center0_dann_b8efecac6_not_commited_2024md_07md_27_14_22_39_seed_0_23102104
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9827474, 'precision': 0.9829712, 'recall': 0.9826385, 'specificity': 0.9826385, 'f1': 0.9827397, 'auroc': 0.9989724, 'binary_precision': 0.9753321, 'binary_recall': 0.99100256, 'binary_specificity': 0.9742744, 'binary_f1_score': 0.98310494}
confusion matrix:
      0     1
0  1477    39
1    14  1542
---- Validation: 
scalar performance:
{'acc': 0.7531056, 'precision': 0.77076817, 'recall': 0.75127757, 'specificity': 0.75127757, 'f1': 0.7480755, 'auroc': 0.8602525, 'binary_precision': 0.83651805, 'binary_recall': 0.62047243, 'binary_specificity': 0.8820827, 'binary_f1_score': 0.71247745}
confusion matrix:
     0    1
0  576   77
1  241  394
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7767442, 'precision': 0.7822394, 'recall': 0.7767442, 'specificity': 0.7767442, 'f1': 0.77565217, 'auroc': 0.83813953, 'binary_precision': 0.8216216, 'binary_recall': 0.7069768, 'binary_specificity': 0.8465116, 'binary_f1_score': 0.76000005}
confusion matrix:
     0    1
0  182   33
1   63  152
better model found
persisted
after epoch: 14,now: 2024-07-27 14:50:39.315526,epoch time: 0:01:56.346742,used: 0:27:59.975710,model: dset_te_center0_dann_b8efecac6_not_commited_2024md_07md_27_14_22_39_seed_0_23102104
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9593099, 'precision': 0.960467, 'recall': 0.95902574, 'specificity': 0.95902574, 'f1': 0.95926046, 'auroc': 0.99602365, 'binary_precision': 0.94027096, 'binary_recall': 0.98199356, 'binary_specificity': 0.936058, 'binary_f1_score': 0.9606794}
confusion matrix:
      0     1
0  1420    97
1    28  1527
---- Validation: 
scalar performance:
{'acc': 0.7919255, 'precision': 0.82101595, 'recall': 0.7898011, 'specificity': 0.7898011, 'f1': 0.7862431, 'auroc': 0.8901689, 'binary_precision': 0.9142212, 'binary_recall': 0.63779527, 'binary_specificity': 0.94180703, 'binary_f1_score': 0.7513914}
confusion matrix:
     0    1
0  615   38
1  230  405
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7744186, 'precision': 0.8409946, 'recall': 0.7744186, 'specificity': 0.7744186, 'f1': 0.7628429, 'auroc': 0.9086858, 'binary_precision': 0.9916667, 'binary_recall': 0.5534884, 'binary_specificity': 0.9953488, 'binary_f1_score': 0.7104478}
confusion matrix:
     0    1
0  214    1
1   96  119
better model found
persisted
after epoch: 15,now: 2024-07-27 14:52:36.007999,epoch time: 0:01:56.692473,used: 0:29:56.668183,model: dset_te_center0_dann_b8efecac6_not_commited_2024md_07md_27_14_22_39_seed_0_23102104
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9589844, 'precision': 0.9616555, 'recall': 0.95948553, 'specificity': 0.95948553, 'f1': 0.9589507, 'auroc': 0.9968651, 'binary_precision': 1.0, 'binary_recall': 0.91897106, 'binary_specificity': 1.0, 'binary_f1_score': 0.9577748}
confusion matrix:
      0     1
0  1517     0
1   126  1429
---- Validation: 
scalar performance:
{'acc': 0.5085404, 'precision': 0.54558516, 'recall': 0.5016833, 'specificity': 0.5016833, 'f1': 0.34674454, 'auroc': 0.73194337, 'binary_precision': 0.5833333, 'binary_recall': 0.011023622, 'binary_specificity': 0.992343, 'binary_f1_score': 0.02163833}
confusion matrix:
     0  1
0  648  5
1  628  7
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.49069768, 'precision': 0.33097485, 'recall': 0.49069768, 'specificity': 0.49069768, 'f1': 0.33316338, 'auroc': 0.7635046, 'binary_precision': 0.16666667, 'binary_recall': 0.004651163, 'binary_specificity': 0.9767442, 'binary_f1_score': 0.009049773}
confusion matrix:
     0  1
0  210  5
1  214  1
early stop counter: 1
val acc:0.5085403919219971, best validation acc: 0.7919254899024963, corresponding to test acc:                         0.7744185924530029 / 0.7883720993995667
after epoch: 16,now: 2024-07-27 14:54:32.453959,epoch time: 0:01:56.445960,used: 0:31:53.114143,model: dset_te_center0_dann_b8efecac6_not_commited_2024md_07md_27_14_22_39_seed_0_23102104
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9817708, 'precision': 0.98217696, 'recall': 0.9820167, 'specificity': 0.9820167, 'f1': 0.9817705, 'auroc': 0.99843657, 'binary_precision': 1.0, 'binary_recall': 0.9640334, 'binary_specificity': 1.0, 'binary_f1_score': 0.9816874}
confusion matrix:
      0     1
0  1515     0
1    56  1501
---- Validation: 
scalar performance:
{'acc': 0.56832296, 'precision': 0.71989024, 'recall': 0.5624218, 'specificity': 0.5624218, 'f1': 0.47033045, 'auroc': 0.8342815, 'binary_precision': 0.8989899, 'binary_recall': 0.14015748, 'binary_specificity': 0.9846861, 'binary_f1_score': 0.2425068}
confusion matrix:
     0   1
0  643  10
1  546  89
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5023256, 'precision': 0.52332395, 'recall': 0.5023256, 'specificity': 0.5023256, 'f1': 0.357779, 'auroc': 0.8491076, 'binary_precision': 0.54545456, 'binary_recall': 0.027906977, 'binary_specificity': 0.9767442, 'binary_f1_score': 0.05309735}
confusion matrix:
     0  1
0  210  5
1  209  6
early stop counter: 2
val acc:0.5683229565620422, best validation acc: 0.7919254899024963, corresponding to test acc:                         0.7744185924530029 / 0.7883720993995667
after epoch: 17,now: 2024-07-27 14:56:28.827618,epoch time: 0:01:56.373659,used: 0:33:49.487802,model: dset_te_center0_dann_b8efecac6_not_commited_2024md_07md_27_14_22_39_seed_0_23102104
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9791667, 'precision': 0.97953486, 'recall': 0.97940314, 'specificity': 0.97940314, 'f1': 0.9791663, 'auroc': 0.9987004, 'binary_precision': 0.99667335, 'binary_recall': 0.9621066, 'binary_specificity': 0.9966997, 'binary_f1_score': 0.97908497}
confusion matrix:
      0     1
0  1510     5
1    59  1498
---- Validation: 
scalar performance:
{'acc': 0.6583851, 'precision': 0.73731244, 'recall': 0.65428126, 'specificity': 0.65428126, 'f1': 0.6239027, 'auroc': 0.8405639, 'binary_precision': 0.8707224, 'binary_recall': 0.36062992, 'binary_specificity': 0.9479326, 'binary_f1_score': 0.5100223}
confusion matrix:
     0    1
0  619   34
1  406  229
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6395349, 'precision': 0.7143142, 'recall': 0.6395349, 'specificity': 0.6395349, 'f1': 0.60508615, 'auroc': 0.85416985, 'binary_precision': 0.84090906, 'binary_recall': 0.34418604, 'binary_specificity': 0.9348837, 'binary_f1_score': 0.48844883}
confusion matrix:
     0   1
0  201  14
1  141  74
early stop counter: 3
val acc:0.6583850979804993, best validation acc: 0.7919254899024963, corresponding to test acc:                         0.7744185924530029 / 0.7883720993995667
after epoch: 18,now: 2024-07-27 14:58:26.037603,epoch time: 0:01:57.209985,used: 0:35:46.697787,model: dset_te_center0_dann_b8efecac6_not_commited_2024md_07md_27_14_22_39_seed_0_23102104
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9746094, 'precision': 0.97520703, 'recall': 0.97441006, 'specificity': 0.97441006, 'f1': 0.97458947, 'auroc': 0.9981108, 'binary_precision': 0.9612984, 'binary_recall': 0.98971725, 'binary_specificity': 0.9591029, 'binary_f1_score': 0.97530085}
confusion matrix:
      0     1
0  1454    62
1    16  1540
---- Validation: 
scalar performance:
{'acc': 0.72981364, 'precision': 0.7326147, 'recall': 0.72897947, 'specificity': 0.72897947, 'f1': 0.72848797, 'auroc': 0.81637025, 'binary_precision': 0.75488454, 'binary_recall': 0.6692913, 'binary_specificity': 0.7886677, 'binary_f1_score': 0.70951587}
confusion matrix:
     0    1
0  515  138
1  210  425
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7953488, 'precision': 0.8095173, 'recall': 0.7953488, 'specificity': 0.7953488, 'f1': 0.7929797, 'auroc': 0.8987236, 'binary_precision': 0.743295, 'binary_recall': 0.9023256, 'binary_specificity': 0.6883721, 'binary_f1_score': 0.81512606}
confusion matrix:
     0    1
0  148   67
1   21  194
new oracle model saved
early stop counter: 4
val acc:0.7298136353492737, best validation acc: 0.7919254899024963, corresponding to test acc:                         0.7744185924530029 / 0.7953488230705261
after epoch: 19,now: 2024-07-27 15:00:22.754438,epoch time: 0:01:56.716835,used: 0:37:43.414622,model: dset_te_center0_dann_b8efecac6_not_commited_2024md_07md_27_14_22_39_seed_0_23102104
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.98372394, 'precision': 0.9837193, 'recall': 0.9838276, 'specificity': 0.9838276, 'f1': 0.9837229, 'auroc': 0.9982735, 'binary_precision': 0.99089134, 'binary_recall': 0.97690827, 'binary_specificity': 0.99074686, 'binary_f1_score': 0.9838501}
confusion matrix:
      0     1
0  1499    14
1    36  1523
---- Validation: 
scalar performance:
{'acc': 0.6661491, 'precision': 0.66771114, 'recall': 0.6653459, 'specificity': 0.6653459, 'f1': 0.664654, 'auroc': 0.7403673, 'binary_precision': 0.680776, 'binary_recall': 0.60787404, 'binary_specificity': 0.7228178, 'binary_f1_score': 0.6422629}
confusion matrix:
     0    1
0  472  181
1  249  386
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.74186045, 'precision': 0.7753694, 'recall': 0.7418605, 'specificity': 0.7418605, 'f1': 0.73376095, 'auroc': 0.9060898, 'binary_precision': 0.6793103, 'binary_recall': 0.9162791, 'binary_specificity': 0.5674419, 'binary_f1_score': 0.780198}
confusion matrix:
     0    1
0  122   93
1   18  197
early stop counter: 5
val acc:0.6661490797996521, best validation acc: 0.7919254899024963, corresponding to test acc:                         0.7744185924530029 / 0.7953488230705261
after epoch: 20,now: 2024-07-27 15:02:19.302298,epoch time: 0:01:56.547860,used: 0:39:39.962482,model: dset_te_center0_dann_b8efecac6_not_commited_2024md_07md_27_14_22_39_seed_0_23102104
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 20 with time: 0:39:39.962482 at 2024-07-27 15:02:19.302298
persisted model performance metric: 

scalar performance:
{'acc': 0.7744186, 'precision': 0.8409946, 'recall': 0.7744186, 'specificity': 0.7744186, 'f1': 0.7628429, 'auroc': 0.9086858, 'binary_precision': 0.9916667, 'binary_recall': 0.5534884, 'binary_specificity': 0.9953488, 'binary_f1_score': 0.7104478}
confusion matrix:
     0    1
0  214    1
1   96  119
oracle model performance metric: 

scalar performance:
{'acc': 0.7953488, 'precision': 0.8095173, 'recall': 0.7953488, 'specificity': 0.7953488, 'f1': 0.7929797, 'auroc': 0.8987236, 'binary_precision': 0.743295, 'binary_recall': 0.9023256, 'binary_specificity': 0.6883721, 'binary_f1_score': 0.81512606}
confusion matrix:
     0    1
0  148   67
1   21  194
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_dannratio_10seeds_nofreeze_2024-07-27_14-18-24/rule_results/1.csv
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_dannratio_10seeds_nofreeze_2024-07-27_14-18-24/rule_results/1.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_dannratio_10seeds_nofreeze_2024-07-27_14-18-24/confusion_matrix/1.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 455608 KiB |   3602 MiB |  72679 GiB |  72678 GiB |
|       from large pool | 415006 KiB |   3568 MiB |  71844 GiB |  71843 GiB |
|       from small pool |  40602 KiB |     56 MiB |    835 GiB |    834 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 455608 KiB |   3602 MiB |  72679 GiB |  72678 GiB |
|       from large pool | 415006 KiB |   3568 MiB |  71844 GiB |  71843 GiB |
|       from small pool |  40602 KiB |     56 MiB |    835 GiB |    834 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 447481 KiB |   3596 MiB |  72371 GiB |  72371 GiB |
|       from large pool | 407075 KiB |   3563 MiB |  71538 GiB |  71537 GiB |
|       from small pool |  40406 KiB |     56 MiB |    833 GiB |    833 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   4016 MiB |   4016 MiB |   4016 MiB |      0 B   |
|       from large pool |   3952 MiB |   3952 MiB |   3952 MiB |      0 B   |
|       from small pool |     64 MiB |     64 MiB |     64 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory | 349255 KiB | 496525 KiB |  50742 GiB |  50742 GiB |
|       from large pool | 342754 KiB | 492852 KiB |  49890 GiB |  49890 GiB |
|       from small pool |   6501 KiB |  14115 KiB |    852 GiB |    852 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    1318    |    1697    |   12670 K  |   12669 K  |
|       from large pool |     187    |     468    |    6627 K  |    6627 K  |
|       from small pool |    1131    |    1435    |    6043 K  |    6041 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    1318    |    1697    |   12670 K  |   12669 K  |
|       from large pool |     187    |     468    |    6627 K  |    6627 K  |
|       from small pool |    1131    |    1435    |    6043 K  |    6041 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     198    |     198    |     198    |       0    |
|       from large pool |     166    |     166    |     166    |       0    |
|       from small pool |      32    |      32    |      32    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      82    |     249    |    7489 K  |    7489 K  |
|       from large pool |      31    |     165    |    4469 K  |    4469 K  |
|       from small pool |      51    |     218    |    3020 K  |    3020 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   3602 MiB |  72679 GiB |  72679 GiB |
|       from large pool |  16640 KiB |   3568 MiB |  71844 GiB |  71844 GiB |
|       from small pool |      0 KiB |     56 MiB |    835 GiB |    835 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   3602 MiB |  72679 GiB |  72679 GiB |
|       from large pool |  16640 KiB |   3568 MiB |  71844 GiB |  71844 GiB |
|       from small pool |      0 KiB |     56 MiB |    835 GiB |    835 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   3596 MiB |  72371 GiB |  72371 GiB |
|       from large pool |  16640 KiB |   3563 MiB |  71538 GiB |  71538 GiB |
|       from small pool |      0 KiB |     56 MiB |    833 GiB |    833 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    786 MiB |   4016 MiB |   4016 MiB |   3230 MiB |
|       from large pool |    740 MiB |   3952 MiB |   3952 MiB |   3212 MiB |
|       from small pool |     46 MiB |     64 MiB |     64 MiB |     18 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 496525 KiB |  50743 GiB |  50743 GiB |
|       from large pool |  24320 KiB | 492852 KiB |  49891 GiB |  49890 GiB |
|       from small pool |      0 KiB |  24365 KiB |    852 GiB |    852 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    1697    |   12670 K  |   12670 K  |
|       from large pool |       2    |     468    |    6627 K  |    6627 K  |
|       from small pool |       0    |    1435    |    6043 K  |    6043 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    1697    |   12670 K  |   12670 K  |
|       from large pool |       2    |     468    |    6627 K  |    6627 K  |
|       from small pool |       0    |    1435    |    6043 K  |    6043 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      57    |     198    |     198    |     141    |
|       from large pool |      34    |     166    |     166    |     132    |
|       from small pool |      23    |      32    |      32    |       9    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     249    |    7489 K  |    7489 K  |
|       from large pool |       3    |     165    |    4469 K  |    4469 K  |
|       from small pool |       0    |     218    |    3020 K  |    3020 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   3602 MiB |  72679 GiB |  72679 GiB |
|       from large pool |  16640 KiB |   3568 MiB |  71844 GiB |  71844 GiB |
|       from small pool |      0 KiB |     56 MiB |    835 GiB |    835 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   3602 MiB |  72679 GiB |  72679 GiB |
|       from large pool |  16640 KiB |   3568 MiB |  71844 GiB |  71844 GiB |
|       from small pool |      0 KiB |     56 MiB |    835 GiB |    835 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   3596 MiB |  72371 GiB |  72371 GiB |
|       from large pool |  16640 KiB |   3563 MiB |  71538 GiB |  71538 GiB |
|       from small pool |      0 KiB |     56 MiB |    833 GiB |    833 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    786 MiB |   4016 MiB |   4016 MiB |   3230 MiB |
|       from large pool |    740 MiB |   3952 MiB |   3952 MiB |   3212 MiB |
|       from small pool |     46 MiB |     64 MiB |     64 MiB |     18 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 496525 KiB |  50743 GiB |  50743 GiB |
|       from large pool |  24320 KiB | 492852 KiB |  49891 GiB |  49890 GiB |
|       from small pool |      0 KiB |  24365 KiB |    852 GiB |    852 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    1697    |   12670 K  |   12670 K  |
|       from large pool |       2    |     468    |    6627 K  |    6627 K  |
|       from small pool |       0    |    1435    |    6043 K  |    6043 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    1697    |   12670 K  |   12670 K  |
|       from large pool |       2    |     468    |    6627 K  |    6627 K  |
|       from small pool |       0    |    1435    |    6043 K  |    6043 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      57    |     198    |     198    |     141    |
|       from large pool |      34    |     166    |     166    |     132    |
|       from small pool |      23    |      32    |      32    |       9    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     249    |    7489 K  |    7489 K  |
|       from large pool |       3    |     165    |    4469 K  |    4469 K  |
|       from small pool |       0    |     218    |    3020 K  |    3020 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center0_dann_b8efecac6_not_commited_2024md_07md_27_15_02_47_seed_1_23102104

 Experiment start at: 2024-07-27 15:02:47.864616
before training, model accuracy: 0.5911111235618591
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.50651044, 'precision': 0.25325522, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.33621433, 'auroc': 0.5, 'binary_precision': 0.50651044, 'binary_recall': 1.0, 'binary_specificity': 0.0, 'binary_f1_score': 0.67242867}
confusion matrix:
   0     1
0  0  1516
1  0  1556
---- Validation: 
scalar performance:
{'acc': 0.4918033, 'precision': 0.24590164, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.32967034, 'auroc': 0.5, 'binary_precision': 0.4918033, 'binary_recall': 1.0, 'binary_specificity': 0.0, 'binary_f1_score': 0.6593407}
confusion matrix:
   0    1
0  0  651
1  0  630
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5, 'precision': 0.25, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.33333334, 'auroc': 0.5, 'binary_precision': 0.5, 'binary_recall': 1.0, 'binary_specificity': 0.0, 'binary_f1_score': 0.6666667}
confusion matrix:
   0    1
0  0  225
1  0  225
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-27 15:05:24.565982,epoch time: 0:02:36.701366,used: 0:02:36.701366,model: dset_te_center0_dann_b8efecac6_not_commited_2024md_07md_27_15_02_47_seed_1_23102104
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.5061849, 'precision': 0.25309244, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.3360709, 'auroc': 0.5, 'binary_precision': 0.5061849, 'binary_recall': 1.0, 'binary_specificity': 0.0, 'binary_f1_score': 0.6721418}
confusion matrix:
   0     1
0  0  1517
1  0  1555
---- Validation: 
scalar performance:
{'acc': 0.4918033, 'precision': 0.24590164, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.32967034, 'auroc': 0.5, 'binary_precision': 0.4918033, 'binary_recall': 1.0, 'binary_specificity': 0.0, 'binary_f1_score': 0.6593407}
confusion matrix:
   0    1
0  0  651
1  0  630
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5, 'precision': 0.25, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.33333334, 'auroc': 0.5, 'binary_precision': 0.5, 'binary_recall': 1.0, 'binary_specificity': 0.0, 'binary_f1_score': 0.6666667}
confusion matrix:
   0    1
0  0  225
1  0  225
early stop counter: 1
val acc:0.49180328845977783, best validation acc: 0.49180328845977783, corresponding to test acc:                         0.5 / 0.5
after epoch: 2,now: 2024-07-27 15:07:20.959905,epoch time: 0:01:56.393923,used: 0:04:33.095289,model: dset_te_center0_dann_b8efecac6_not_commited_2024md_07md_27_15_02_47_seed_1_23102104
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.50651044, 'precision': 0.25325522, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.33621433, 'auroc': 0.5, 'binary_precision': 0.50651044, 'binary_recall': 1.0, 'binary_specificity': 0.0, 'binary_f1_score': 0.67242867}
confusion matrix:
   0     1
0  0  1516
1  0  1556
---- Validation: 
scalar performance:
{'acc': 0.4918033, 'precision': 0.24590164, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.32967034, 'auroc': 0.5, 'binary_precision': 0.4918033, 'binary_recall': 1.0, 'binary_specificity': 0.0, 'binary_f1_score': 0.6593407}
confusion matrix:
   0    1
0  0  651
1  0  630
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5, 'precision': 0.25, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.33333334, 'auroc': 0.5, 'binary_precision': 0.5, 'binary_recall': 1.0, 'binary_specificity': 0.0, 'binary_f1_score': 0.6666667}
confusion matrix:
   0    1
0  0  225
1  0  225
early stop counter: 2
val acc:0.49180328845977783, best validation acc: 0.49180328845977783, corresponding to test acc:                         0.5 / 0.5
after epoch: 3,now: 2024-07-27 15:09:17.533750,epoch time: 0:01:56.573845,used: 0:06:29.669134,model: dset_te_center0_dann_b8efecac6_not_commited_2024md_07md_27_15_02_47_seed_1_23102104
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.50683594, 'precision': 0.25341797, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.33635774, 'auroc': 0.5, 'binary_precision': 0.50683594, 'binary_recall': 1.0, 'binary_specificity': 0.0, 'binary_f1_score': 0.6727155}
confusion matrix:
   0     1
0  0  1515
1  0  1557
---- Validation: 
scalar performance:
{'acc': 0.4918033, 'precision': 0.24590164, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.32967034, 'auroc': 0.5, 'binary_precision': 0.4918033, 'binary_recall': 1.0, 'binary_specificity': 0.0, 'binary_f1_score': 0.6593407}
confusion matrix:
   0    1
0  0  651
1  0  630
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5, 'precision': 0.25, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.33333334, 'auroc': 0.5, 'binary_precision': 0.5, 'binary_recall': 1.0, 'binary_specificity': 0.0, 'binary_f1_score': 0.6666667}
confusion matrix:
   0    1
0  0  225
1  0  225
early stop counter: 3
val acc:0.49180328845977783, best validation acc: 0.49180328845977783, corresponding to test acc:                         0.5 / 0.5
after epoch: 4,now: 2024-07-27 15:11:14.082125,epoch time: 0:01:56.548375,used: 0:08:26.217509,model: dset_te_center0_dann_b8efecac6_not_commited_2024md_07md_27_15_02_47_seed_1_23102104
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.50716144, 'precision': 0.25358072, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.3365011, 'auroc': 0.5, 'binary_precision': 0.50716144, 'binary_recall': 1.0, 'binary_specificity': 0.0, 'binary_f1_score': 0.6730022}
confusion matrix:
   0     1
0  0  1514
1  0  1558
---- Validation: 
scalar performance:
{'acc': 0.4918033, 'precision': 0.24590164, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.32967034, 'auroc': 0.5, 'binary_precision': 0.4918033, 'binary_recall': 1.0, 'binary_specificity': 0.0, 'binary_f1_score': 0.6593407}
confusion matrix:
   0    1
0  0  651
1  0  630
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5, 'precision': 0.25, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.33333334, 'auroc': 0.5, 'binary_precision': 0.5, 'binary_recall': 1.0, 'binary_specificity': 0.0, 'binary_f1_score': 0.6666667}
confusion matrix:
   0    1
0  0  225
1  0  225
early stop counter: 4
val acc:0.49180328845977783, best validation acc: 0.49180328845977783, corresponding to test acc:                         0.5 / 0.5
after epoch: 5,now: 2024-07-27 15:13:11.220413,epoch time: 0:01:57.138288,used: 0:10:23.355797,model: dset_te_center0_dann_b8efecac6_not_commited_2024md_07md_27_15_02_47_seed_1_23102104
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.5061849, 'precision': 0.25309244, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.3360709, 'auroc': 0.5, 'binary_precision': 0.5061849, 'binary_recall': 1.0, 'binary_specificity': 0.0, 'binary_f1_score': 0.6721418}
confusion matrix:
   0     1
0  0  1517
1  0  1555
---- Validation: 
scalar performance:
{'acc': 0.4918033, 'precision': 0.24590164, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.32967034, 'auroc': 0.5, 'binary_precision': 0.4918033, 'binary_recall': 1.0, 'binary_specificity': 0.0, 'binary_f1_score': 0.6593407}
confusion matrix:
   0    1
0  0  651
1  0  630
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5, 'precision': 0.25, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.33333334, 'auroc': 0.5, 'binary_precision': 0.5, 'binary_recall': 1.0, 'binary_specificity': 0.0, 'binary_f1_score': 0.6666667}
confusion matrix:
   0    1
0  0  225
1  0  225
early stop counter: 5
val acc:0.49180328845977783, best validation acc: 0.49180328845977783, corresponding to test acc:                         0.5 / 0.5
after epoch: 6,now: 2024-07-27 15:15:08.026638,epoch time: 0:01:56.806225,used: 0:12:20.162022,model: dset_te_center0_dann_b8efecac6_not_commited_2024md_07md_27_15_02_47_seed_1_23102104
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 6 with time: 0:12:20.162022 at 2024-07-27 15:15:08.026638
persisted model performance metric: 

scalar performance:
{'acc': 0.5, 'precision': 0.25, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.33333334, 'auroc': 0.5, 'binary_precision': 0.5, 'binary_recall': 1.0, 'binary_specificity': 0.0, 'binary_f1_score': 0.6666667}
confusion matrix:
   0    1
0  0  225
1  0  225
oracle model performance metric: 

scalar performance:
{'acc': 0.5, 'precision': 0.25, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.33333334, 'auroc': 0.5, 'binary_precision': 0.5, 'binary_recall': 1.0, 'binary_specificity': 0.0, 'binary_f1_score': 0.6666667}
confusion matrix:
   0    1
0  0  225
1  0  225
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_dannratio_10seeds_nofreeze_2024-07-27_14-18-24/rule_results/1.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_dannratio_10seeds_nofreeze_2024-07-27_14-18-24/confusion_matrix/1.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 454480 KiB |   3602 MiB |  95192 GiB |  95191 GiB |
|       from large pool | 413871 KiB |   3568 MiB |  94088 GiB |  94087 GiB |
|       from small pool |  40608 KiB |     60 MiB |   1103 GiB |   1103 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 454480 KiB |   3602 MiB |  95192 GiB |  95191 GiB |
|       from large pool | 413871 KiB |   3568 MiB |  94088 GiB |  94087 GiB |
|       from small pool |  40608 KiB |     60 MiB |   1103 GiB |   1103 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 447482 KiB |   3596 MiB |  94871 GiB |  94871 GiB |
|       from large pool | 407075 KiB |   3563 MiB |  93769 GiB |  93769 GiB |
|       from small pool |  40407 KiB |     60 MiB |   1102 GiB |   1102 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   4008 MiB |   4016 MiB |   7238 MiB |   3230 MiB |
|       from large pool |   3940 MiB |   3952 MiB |   7152 MiB |   3212 MiB |
|       from small pool |     68 MiB |     68 MiB |     86 MiB |     18 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 350384 KiB | 496525 KiB |  66426 GiB |  66425 GiB |
|       from large pool | 341840 KiB | 492852 KiB |  65298 GiB |  65298 GiB |
|       from small pool |   8543 KiB |  24365 KiB |   1127 GiB |   1127 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    1330    |    1709    |   16605 K  |   16604 K  |
|       from large pool |     187    |     468    |    8691 K  |    8691 K  |
|       from small pool |    1143    |    1447    |    7913 K  |    7912 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    1330    |    1709    |   16605 K  |   16604 K  |
|       from large pool |     187    |     468    |    8691 K  |    8691 K  |
|       from small pool |    1143    |    1447    |    7913 K  |    7912 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     200    |     200    |     341    |     141    |
|       from large pool |     166    |     166    |     298    |     132    |
|       from small pool |      34    |      34    |      43    |       9    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      87    |     253    |    9693 K  |    9693 K  |
|       from large pool |      34    |     165    |    5772 K  |    5772 K  |
|       from small pool |      53    |     219    |    3920 K  |    3920 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   3602 MiB |  95192 GiB |  95192 GiB |
|       from large pool |  16640 KiB |   3568 MiB |  94088 GiB |  94088 GiB |
|       from small pool |      0 KiB |     60 MiB |   1103 GiB |   1103 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   3602 MiB |  95192 GiB |  95192 GiB |
|       from large pool |  16640 KiB |   3568 MiB |  94088 GiB |  94088 GiB |
|       from small pool |      0 KiB |     60 MiB |   1103 GiB |   1103 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   3596 MiB |  94871 GiB |  94871 GiB |
|       from large pool |  16640 KiB |   3563 MiB |  93769 GiB |  93769 GiB |
|       from small pool |      0 KiB |     60 MiB |   1102 GiB |   1102 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    786 MiB |   4016 MiB |   7238 MiB |   6452 MiB |
|       from large pool |    738 MiB |   3952 MiB |   7152 MiB |   6414 MiB |
|       from small pool |     48 MiB |     68 MiB |     86 MiB |     38 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 496525 KiB |  66426 GiB |  66426 GiB |
|       from large pool |  24320 KiB | 492852 KiB |  65299 GiB |  65298 GiB |
|       from small pool |      0 KiB |  32850 KiB |   1127 GiB |   1127 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    1709    |   16605 K  |   16605 K  |
|       from large pool |       2    |     468    |    8691 K  |    8691 K  |
|       from small pool |       0    |    1447    |    7913 K  |    7913 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    1709    |   16605 K  |   16605 K  |
|       from large pool |       2    |     468    |    8691 K  |    8691 K  |
|       from small pool |       0    |    1447    |    7913 K  |    7913 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      57    |     200    |     341    |     284    |
|       from large pool |      33    |     166    |     298    |     265    |
|       from small pool |      24    |      34    |      43    |      19    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     253    |    9693 K  |    9693 K  |
|       from large pool |       3    |     165    |    5772 K  |    5772 K  |
|       from small pool |       0    |     219    |    3920 K  |    3920 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   3602 MiB |  95192 GiB |  95192 GiB |
|       from large pool |  16640 KiB |   3568 MiB |  94088 GiB |  94088 GiB |
|       from small pool |      0 KiB |     60 MiB |   1103 GiB |   1103 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   3602 MiB |  95192 GiB |  95192 GiB |
|       from large pool |  16640 KiB |   3568 MiB |  94088 GiB |  94088 GiB |
|       from small pool |      0 KiB |     60 MiB |   1103 GiB |   1103 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   3596 MiB |  94871 GiB |  94871 GiB |
|       from large pool |  16640 KiB |   3563 MiB |  93769 GiB |  93769 GiB |
|       from small pool |      0 KiB |     60 MiB |   1102 GiB |   1102 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    786 MiB |   4016 MiB |   7238 MiB |   6452 MiB |
|       from large pool |    738 MiB |   3952 MiB |   7152 MiB |   6414 MiB |
|       from small pool |     48 MiB |     68 MiB |     86 MiB |     38 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 496525 KiB |  66426 GiB |  66426 GiB |
|       from large pool |  24320 KiB | 492852 KiB |  65299 GiB |  65298 GiB |
|       from small pool |      0 KiB |  32850 KiB |   1127 GiB |   1127 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    1709    |   16605 K  |   16605 K  |
|       from large pool |       2    |     468    |    8691 K  |    8691 K  |
|       from small pool |       0    |    1447    |    7913 K  |    7913 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    1709    |   16605 K  |   16605 K  |
|       from large pool |       2    |     468    |    8691 K  |    8691 K  |
|       from small pool |       0    |    1447    |    7913 K  |    7913 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      57    |     200    |     341    |     284    |
|       from large pool |      33    |     166    |     298    |     265    |
|       from small pool |      24    |      34    |      43    |      19    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     253    |    9693 K  |    9693 K  |
|       from large pool |       3    |     165    |    5772 K  |    5772 K  |
|       from small pool |       0    |     219    |    3920 K  |    3920 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center0_dann_b8efecac6_not_commited_2024md_07md_27_15_15_37_seed_2_23102104

 Experiment start at: 2024-07-27 15:15:37.246175
before training, model accuracy: 0.5254629850387573
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.8769634, 'precision': 0.8822488, 'recall': 0.87742865, 'specificity': 0.87742865, 'f1': 0.8766252, 'auroc': 0.899755, 'binary_precision': 0.9292035, 'binary_recall': 0.8181818, 'binary_specificity': 0.9366755, 'binary_f1_score': 0.87016577}
confusion matrix:
      0     1
0  1420    96
1   280  1260
---- Validation: 
scalar performance:
{'acc': 0.54147106, 'precision': 0.73775065, 'recall': 0.5532287, 'specificity': 0.5532287, 'f1': 0.43909085, 'auroc': 0.85953677, 'binary_precision': 0.5149751, 'binary_recall': 0.99517685, 'binary_specificity': 0.111280486, 'binary_f1_score': 0.67872816}
confusion matrix:
    0    1
0  73  583
1   3  619
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5208333, 'precision': 0.7098899, 'recall': 0.5208333, 'specificity': 0.5208333, 'f1': 0.3815725, 'auroc': 0.7764703, 'binary_precision': 0.51068884, 'binary_recall': 0.9953704, 'binary_specificity': 0.046296295, 'binary_f1_score': 0.6750393}
confusion matrix:
    0    1
0  10  206
1   1  215
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-27 15:18:13.481619,epoch time: 0:02:36.235444,used: 0:02:36.235444,model: dset_te_center0_dann_b8efecac6_not_commited_2024md_07md_27_15_15_37_seed_2_23102104
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.8812173, 'precision': 0.8912386, 'recall': 0.8818499, 'specificity': 0.8818499, 'f1': 0.88056993, 'auroc': 0.89623237, 'binary_precision': 0.95584816, 'binary_recall': 0.8012987, 'binary_specificity': 0.96240103, 'binary_f1_score': 0.87177676}
confusion matrix:
      0     1
0  1459    57
1   306  1234
---- Validation: 
scalar performance:
{'acc': 0.6768388, 'precision': 0.7657762, 'recall': 0.6843385, 'specificity': 0.6843385, 'f1': 0.65268886, 'auroc': 0.8311138, 'binary_precision': 0.60523665, 'binary_recall': 0.96623796, 'binary_specificity': 0.40243903, 'binary_f1_score': 0.7442725}
confusion matrix:
     0    1
0  264  392
1   21  601
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7407407, 'precision': 0.7708334, 'recall': 0.7407408, 'specificity': 0.7407408, 'f1': 0.73333335, 'auroc': 0.85363084, 'binary_precision': 0.6805556, 'binary_recall': 0.9074074, 'binary_specificity': 0.5740741, 'binary_f1_score': 0.7777778}
confusion matrix:
     0    1
0  124   92
1   20  196
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-07-27 15:20:09.617407,epoch time: 0:01:56.135788,used: 0:04:32.371232,model: dset_te_center0_dann_b8efecac6_not_commited_2024md_07md_27_15_15_37_seed_2_23102104
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.4960733, 'precision': 0.24803665, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.33158356, 'auroc': 0.5, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  1516  0
1  1540  0
---- Validation: 
scalar performance:
{'acc': 0.513302, 'precision': 0.256651, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.33919337, 'auroc': 0.5, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
     0  1
0  656  0
1  622  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5, 'precision': 0.25, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.33333334, 'auroc': 0.5, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
     0  1
0  216  0
1  216  0
early stop counter: 1
val acc:0.5133020281791687, best validation acc: 0.6768388152122498, corresponding to test acc:                         0.7407407164573669 / 0.7407407164573669
after epoch: 3,now: 2024-07-27 15:22:05.709292,epoch time: 0:01:56.091885,used: 0:06:28.463117,model: dset_te_center0_dann_b8efecac6_not_commited_2024md_07md_27_15_15_37_seed_2_23102104
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.4960733, 'precision': 0.24803665, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.33158356, 'auroc': 0.5, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  1516  0
1  1540  0
---- Validation: 
scalar performance:
{'acc': 0.513302, 'precision': 0.256651, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.33919337, 'auroc': 0.5, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
     0  1
0  656  0
1  622  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5, 'precision': 0.25, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.33333334, 'auroc': 0.5, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
     0  1
0  216  0
1  216  0
early stop counter: 2
val acc:0.5133020281791687, best validation acc: 0.6768388152122498, corresponding to test acc:                         0.7407407164573669 / 0.7407407164573669
after epoch: 4,now: 2024-07-27 15:24:01.691957,epoch time: 0:01:55.982665,used: 0:08:24.445782,model: dset_te_center0_dann_b8efecac6_not_commited_2024md_07md_27_15_15_37_seed_2_23102104
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.4960733, 'precision': 0.24803665, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.33158356, 'auroc': 0.5, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  1516  0
1  1540  0
---- Validation: 
scalar performance:
{'acc': 0.513302, 'precision': 0.256651, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.33919337, 'auroc': 0.5, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
     0  1
0  656  0
1  622  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5, 'precision': 0.25, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.33333334, 'auroc': 0.5, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
     0  1
0  216  0
1  216  0
early stop counter: 3
val acc:0.5133020281791687, best validation acc: 0.6768388152122498, corresponding to test acc:                         0.7407407164573669 / 0.7407407164573669
after epoch: 5,now: 2024-07-27 15:25:58.163631,epoch time: 0:01:56.471674,used: 0:10:20.917456,model: dset_te_center0_dann_b8efecac6_not_commited_2024md_07md_27_15_15_37_seed_2_23102104
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.4960733, 'precision': 0.24803665, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.33158356, 'auroc': 0.5, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  1516  0
1  1540  0
---- Validation: 
scalar performance:
{'acc': 0.513302, 'precision': 0.256651, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.33919337, 'auroc': 0.5, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
     0  1
0  656  0
1  622  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5, 'precision': 0.25, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.33333334, 'auroc': 0.5, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
     0  1
0  216  0
1  216  0
early stop counter: 4
val acc:0.5133020281791687, best validation acc: 0.6768388152122498, corresponding to test acc:                         0.7407407164573669 / 0.7407407164573669
after epoch: 6,now: 2024-07-27 15:27:54.354867,epoch time: 0:01:56.191236,used: 0:12:17.108692,model: dset_te_center0_dann_b8efecac6_not_commited_2024md_07md_27_15_15_37_seed_2_23102104
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.4960733, 'precision': 0.24803665, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.33158356, 'auroc': 0.5, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  1516  0
1  1540  0
---- Validation: 
scalar performance:
{'acc': 0.513302, 'precision': 0.256651, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.33919337, 'auroc': 0.5, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
     0  1
0  656  0
1  622  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5, 'precision': 0.25, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.33333334, 'auroc': 0.5, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
     0  1
0  216  0
1  216  0
early stop counter: 5
val acc:0.5133020281791687, best validation acc: 0.6768388152122498, corresponding to test acc:                         0.7407407164573669 / 0.7407407164573669
after epoch: 7,now: 2024-07-27 15:29:50.247649,epoch time: 0:01:55.892782,used: 0:14:13.001474,model: dset_te_center0_dann_b8efecac6_not_commited_2024md_07md_27_15_15_37_seed_2_23102104
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 7 with time: 0:14:13.001474 at 2024-07-27 15:29:50.247649
persisted model performance metric: 

scalar performance:
{'acc': 0.7407407, 'precision': 0.7708334, 'recall': 0.7407408, 'specificity': 0.7407408, 'f1': 0.73333335, 'auroc': 0.85363084, 'binary_precision': 0.6805556, 'binary_recall': 0.9074074, 'binary_specificity': 0.5740741, 'binary_f1_score': 0.7777778}
confusion matrix:
     0    1
0  124   92
1   20  196
oracle model performance metric: 

scalar performance:
{'acc': 0.7407407, 'precision': 0.7708334, 'recall': 0.7407408, 'specificity': 0.7407408, 'f1': 0.73333335, 'auroc': 0.85363084, 'binary_precision': 0.6805556, 'binary_recall': 0.9074074, 'binary_specificity': 0.5740741, 'binary_f1_score': 0.7777778}
confusion matrix:
     0    1
0  124   92
1   20  196
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_dannratio_10seeds_nofreeze_2024-07-27_14-18-24/rule_results/1.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_dannratio_10seeds_nofreeze_2024-07-27_14-18-24/confusion_matrix/1.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 454625 KiB |   3602 MiB | 121216 GiB | 121215 GiB |
|       from large pool | 414023 KiB |   3569 MiB | 119806 GiB | 119806 GiB |
|       from small pool |  40602 KiB |     60 MiB |   1409 GiB |   1409 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 454625 KiB |   3602 MiB | 121216 GiB | 121215 GiB |
|       from large pool | 414023 KiB |   3569 MiB | 119806 GiB | 119806 GiB |
|       from small pool |  40602 KiB |     60 MiB |   1409 GiB |   1409 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 447481 KiB |   3596 MiB | 120786 GiB | 120786 GiB |
|       from large pool | 407075 KiB |   3563 MiB | 119379 GiB | 119378 GiB |
|       from small pool |  40406 KiB |     60 MiB |   1407 GiB |   1407 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   4002 MiB |   4016 MiB |  10454 MiB |   6452 MiB |
|       from large pool |   3938 MiB |   3952 MiB |  10352 MiB |   6414 MiB |
|       from small pool |     64 MiB |     68 MiB |    102 MiB |     38 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 391198 KiB | 496525 KiB |  84841 GiB |  84841 GiB |
|       from large pool | 382649 KiB | 492852 KiB |  83401 GiB |  83401 GiB |
|       from small pool |   8549 KiB |  32850 KiB |   1439 GiB |   1439 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    1318    |    1709    |   21130 K  |   21128 K  |
|       from large pool |     187    |     468    |   11068 K  |   11067 K  |
|       from small pool |    1131    |    1447    |   10062 K  |   10060 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    1318    |    1709    |   21130 K  |   21128 K  |
|       from large pool |     187    |     468    |   11068 K  |   11067 K  |
|       from small pool |    1131    |    1447    |   10062 K  |   10060 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     197    |     200    |     481    |     284    |
|       from large pool |     165    |     166    |     430    |     265    |
|       from small pool |      32    |      34    |      51    |      19    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      87    |     253    |   12203 K  |   12203 K  |
|       from large pool |      34    |     165    |    7254 K  |    7254 K  |
|       from small pool |      53    |     219    |    4948 K  |    4948 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   3602 MiB | 121216 GiB | 121216 GiB |
|       from large pool |  16640 KiB |   3569 MiB | 119806 GiB | 119806 GiB |
|       from small pool |      0 KiB |     60 MiB |   1409 GiB |   1409 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   3602 MiB | 121216 GiB | 121216 GiB |
|       from large pool |  16640 KiB |   3569 MiB | 119806 GiB | 119806 GiB |
|       from small pool |      0 KiB |     60 MiB |   1409 GiB |   1409 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   3596 MiB | 120786 GiB | 120786 GiB |
|       from large pool |  16640 KiB |   3563 MiB | 119379 GiB | 119379 GiB |
|       from small pool |      0 KiB |     60 MiB |   1407 GiB |   1407 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    826 MiB |   4016 MiB |  10454 MiB |   9628 MiB |
|       from large pool |    778 MiB |   3952 MiB |  10352 MiB |   9574 MiB |
|       from small pool |     48 MiB |     68 MiB |    102 MiB |     54 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 496525 KiB |  84841 GiB |  84841 GiB |
|       from large pool |  24320 KiB | 492852 KiB |  83402 GiB |  83402 GiB |
|       from small pool |      0 KiB |  32856 KiB |   1439 GiB |   1439 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    1709    |   21130 K  |   21130 K  |
|       from large pool |       2    |     468    |   11068 K  |   11068 K  |
|       from small pool |       0    |    1447    |   10062 K  |   10062 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    1709    |   21130 K  |   21130 K  |
|       from large pool |       2    |     468    |   11068 K  |   11068 K  |
|       from small pool |       0    |    1447    |   10062 K  |   10062 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      59    |     200    |     481    |     422    |
|       from large pool |      35    |     166    |     430    |     395    |
|       from small pool |      24    |      34    |      51    |      27    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     253    |   12203 K  |   12203 K  |
|       from large pool |       3    |     165    |    7254 K  |    7254 K  |
|       from small pool |       0    |     219    |    4948 K  |    4948 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Sat Jul 27 15:29:57 2024]
Finished job 0.
1 of 1 steps (100%) done
