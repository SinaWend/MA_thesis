Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Sat Jul 27 14:51:27 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_dannratio_10seeds_nofreeze_2024-07-27_14-18-24/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_dannratio_10seeds_nofreeze_2024-07-27_14-18-24/rule_results/0.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=0
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/swiglu_ffn.py:51: UserWarning: xFormers is not available (SwiGLU)
  warnings.warn("xFormers is not available (SwiGLU)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/attention.py:33: UserWarning: xFormers is not available (Attention)
  warnings.warn("xFormers is not available (Attention)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/block.py:40: UserWarning: xFormers is not available (Block)
  warnings.warn("xFormers is not available (Block)")
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_14_52_08_seed_0_23102107

 Experiment start at: 2024-07-27 14:52:08.636163
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
before training, model accuracy: 0.569767415523529
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.97233075, 'precision': 0.97234523, 'recall': 0.97242355, 'specificity': 0.97242355, 'f1': 0.97232985, 'auroc': 0.9959553, 'binary_precision': 0.97977823, 'binary_recall': 0.9652956, 'binary_specificity': 0.97955143, 'binary_f1_score': 0.972483}
confusion matrix:
      0     1
0  1485    31
1    54  1502
---- Validation: 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
scalar performance:
{'acc': 0.7569876, 'precision': 0.76271045, 'recall': 0.7559091, 'specificity': 0.7559091, 'f1': 0.7551026, 'auroc': 0.84563315, 'binary_precision': 0.79814816, 'binary_recall': 0.67874014, 'binary_specificity': 0.8330781, 'binary_f1_score': 0.733617}
confusion matrix:
     0    1
0  544  109
1  204  431
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7930232, 'precision': 0.7992444, 'recall': 0.7930232, 'specificity': 0.7930232, 'f1': 0.7919419, 'auroc': 0.9000108, 'binary_precision': 0.8423913, 'binary_recall': 0.7209302, 'binary_specificity': 0.8651163, 'binary_f1_score': 0.7769423}
confusion matrix:
     0    1
0  186   29
1   60  155
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-27 14:53:44.330569,epoch time: 0:01:35.694406,used: 0:01:35.694406,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_14_52_08_seed_0_23102107
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9820964, 'precision': 0.9821416, 'recall': 0.98220235, 'specificity': 0.98220235, 'f1': 0.98209614, 'auroc': 0.9980809, 'binary_precision': 0.9908377, 'binary_recall': 0.97363347, 'binary_specificity': 0.99077123, 'binary_f1_score': 0.9821603}
confusion matrix:
      0     1
0  1503    14
1    41  1514
---- Validation: 
scalar performance:
{'acc': 0.76319873, 'precision': 0.8026242, 'recall': 0.7606456, 'specificity': 0.7606456, 'f1': 0.754005, 'auroc': 0.8910492, 'binary_precision': 0.90841585, 'binary_recall': 0.57795274, 'binary_specificity': 0.94333845, 'binary_f1_score': 0.7064485}
confusion matrix:
     0    1
0  616   37
1  268  367
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.83023256, 'precision': 0.84832513, 'recall': 0.83023256, 'specificity': 0.83023256, 'f1': 0.82799906, 'auroc': 0.92062736, 'binary_precision': 0.92771083, 'binary_recall': 0.7162791, 'binary_specificity': 0.94418603, 'binary_f1_score': 0.80839896}
confusion matrix:
     0    1
0  203   12
1   61  154
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-07-27 14:55:13.854196,epoch time: 0:01:29.523627,used: 0:03:05.218033,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_14_52_08_seed_0_23102107
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9814453, 'precision': 0.98143446, 'recall': 0.9815142, 'specificity': 0.9815142, 'f1': 0.98144424, 'auroc': 0.9982288, 'binary_precision': 0.9870046, 'binary_recall': 0.9762211, 'binary_specificity': 0.9868074, 'binary_f1_score': 0.98158324}
confusion matrix:
      0     1
0  1496    20
1    37  1519
---- Validation: 
scalar performance:
{'acc': 0.82298136, 'precision': 0.8231971, 'recall': 0.82277316, 'specificity': 0.82277316, 'f1': 0.8228579, 'auroc': 0.8974184, 'binary_precision': 0.82875603, 'binary_recall': 0.807874, 'binary_specificity': 0.8376723, 'binary_f1_score': 0.8181818}
confusion matrix:
     0    1
0  547  106
1  122  513
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.83488375, 'precision': 0.8349489, 'recall': 0.8348837, 'specificity': 0.8348837, 'f1': 0.8348757, 'auroc': 0.9054624, 'binary_precision': 0.8396226, 'binary_recall': 0.82790697, 'binary_specificity': 0.8418605, 'binary_f1_score': 0.8337236}
confusion matrix:
     0    1
0  181   34
1   37  178
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-07-27 14:56:43.421157,epoch time: 0:01:29.566961,used: 0:04:34.784994,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_14_52_08_seed_0_23102107
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.984375, 'precision': 0.98441595, 'recall': 0.9843404, 'specificity': 0.9843404, 'f1': 0.98437154, 'auroc': 0.99880666, 'binary_precision': 0.9820857, 'binary_recall': 0.9871383, 'binary_specificity': 0.9815425, 'binary_f1_score': 0.98460555}
confusion matrix:
      0     1
0  1489    28
1    20  1535
---- Validation: 
scalar performance:
{'acc': 0.8338509, 'precision': 0.8472171, 'recall': 0.8324728, 'specificity': 0.8324728, 'f1': 0.8318066, 'auroc': 0.91013736, 'binary_precision': 0.91193736, 'binary_recall': 0.7338583, 'binary_specificity': 0.9310873, 'binary_f1_score': 0.81326354}
confusion matrix:
     0    1
0  608   45
1  169  466
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.86744183, 'precision': 0.8813084, 'recall': 0.86744183, 'specificity': 0.86744183, 'f1': 0.8662257, 'auroc': 0.9304056, 'binary_precision': 0.954023, 'binary_recall': 0.772093, 'binary_specificity': 0.96279067, 'binary_f1_score': 0.8534705}
confusion matrix:
     0    1
0  207    8
1   49  166
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-07-27 14:58:13.102044,epoch time: 0:01:29.680887,used: 0:06:04.465881,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_14_52_08_seed_0_23102107
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9794922, 'precision': 0.98006797, 'recall': 0.97930783, 'specificity': 0.97930783, 'f1': 0.97947717, 'auroc': 0.9990666, 'binary_precision': 0.96625, 'binary_recall': 0.9942122, 'binary_specificity': 0.96440345, 'binary_f1_score': 0.98003167}
confusion matrix:
      0     1
0  1463    54
1     9  1546
---- Validation: 
scalar performance:
{'acc': 0.77018636, 'precision': 0.77015966, 'recall': 0.7702066, 'specificity': 0.7702066, 'f1': 0.7701664, 'auroc': 0.85006094, 'binary_precision': 0.7644306, 'binary_recall': 0.77165353, 'binary_specificity': 0.76875955, 'binary_f1_score': 0.7680251}
confusion matrix:
     0    1
0  502  151
1  145  490
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7883721, 'precision': 0.79232454, 'recall': 0.78837204, 'specificity': 0.78837204, 'f1': 0.7876543, 'auroc': 0.8616117, 'binary_precision': 0.7583333, 'binary_recall': 0.8465116, 'binary_specificity': 0.73023254, 'binary_f1_score': 0.8}
confusion matrix:
     0    1
0  157   58
1   33  182
early stop counter: 1
val acc:0.7701863646507263, best validation acc: 0.8338509202003479, corresponding to test acc:                         0.8674418330192566 / 0.8674418330192566
after epoch: 5,now: 2024-07-27 14:59:42.566584,epoch time: 0:01:29.464540,used: 0:07:33.930421,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_14_52_08_seed_0_23102107
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9863281, 'precision': 0.98646337, 'recall': 0.9864947, 'specificity': 0.9864947, 'f1': 0.9863281, 'auroc': 0.9992479, 'binary_precision': 0.99868333, 'binary_recall': 0.97430956, 'binary_specificity': 0.9986799, 'binary_f1_score': 0.98634595}
confusion matrix:
      0     1
0  1513     2
1    40  1517
---- Validation: 
scalar performance:
{'acc': 0.7282609, 'precision': 0.80404246, 'recall': 0.724735, 'specificity': 0.724735, 'f1': 0.70816344, 'auroc': 0.9100312, 'binary_precision': 0.95238096, 'binary_recall': 0.47244096, 'binary_specificity': 0.9770291, 'binary_f1_score': 0.631579}
confusion matrix:
     0    1
0  638   15
1  335  300
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.75348836, 'precision': 0.82711256, 'recall': 0.75348836, 'specificity': 0.75348836, 'f1': 0.7387906, 'auroc': 0.93233097, 'binary_precision': 0.9823009, 'binary_recall': 0.51627904, 'binary_specificity': 0.9906977, 'binary_f1_score': 0.6768292}
confusion matrix:
     0    1
0  213    2
1  104  111
early stop counter: 2
val acc:0.72826087474823, best validation acc: 0.8338509202003479, corresponding to test acc:                         0.8674418330192566 / 0.8674418330192566
after epoch: 6,now: 2024-07-27 15:01:11.861877,epoch time: 0:01:29.295293,used: 0:09:03.225714,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_14_52_08_seed_0_23102107
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.98307294, 'precision': 0.98318577, 'recall': 0.98323, 'specificity': 0.98323, 'f1': 0.9830729, 'auroc': 0.99884224, 'binary_precision': 0.9947403, 'binary_recall': 0.97174054, 'binary_specificity': 0.99471945, 'binary_f1_score': 0.98310596}
confusion matrix:
      0     1
0  1507     8
1    44  1513
---- Validation: 
scalar performance:
{'acc': 0.7492236, 'precision': 0.8152795, 'recall': 0.74599487, 'specificity': 0.74599487, 'f1': 0.7336974, 'auroc': 0.91855645, 'binary_precision': 0.95614034, 'binary_recall': 0.51496065, 'binary_specificity': 0.9770291, 'binary_f1_score': 0.6693961}
confusion matrix:
     0    1
0  638   15
1  308  327
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.76046515, 'precision': 0.8342216, 'recall': 0.76046515, 'specificity': 0.76046515, 'f1': 0.7464782, 'auroc': 0.9375014, 'binary_precision': 0.99122804, 'binary_recall': 0.5255814, 'binary_specificity': 0.9953488, 'binary_f1_score': 0.6869301}
confusion matrix:
     0    1
0  214    1
1  102  113
early stop counter: 3
val acc:0.7492235898971558, best validation acc: 0.8338509202003479, corresponding to test acc:                         0.8674418330192566 / 0.8674418330192566
after epoch: 7,now: 2024-07-27 15:02:40.755299,epoch time: 0:01:28.893422,used: 0:10:32.119136,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_14_52_08_seed_0_23102107
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9895833, 'precision': 0.9896018, 'recall': 0.9895636, 'specificity': 0.9895636, 'f1': 0.989581, 'auroc': 0.99966085, 'binary_precision': 0.98846895, 'binary_recall': 0.99100834, 'binary_specificity': 0.9881188, 'binary_f1_score': 0.98973703}
confusion matrix:
      0     1
0  1497    18
1    14  1543
---- Validation: 
scalar performance:
{'acc': 0.83229816, 'precision': 0.8567419, 'recall': 0.8304639, 'specificity': 0.8304639, 'f1': 0.8288044, 'auroc': 0.92691755, 'binary_precision': 0.9466951, 'binary_recall': 0.6992126, 'binary_specificity': 0.96171516, 'binary_f1_score': 0.8043479}
confusion matrix:
     0    1
0  628   25
1  191  444
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.83488375, 'precision': 0.864201, 'recall': 0.8348837, 'specificity': 0.8348837, 'f1': 0.83149266, 'auroc': 0.918226, 'binary_precision': 0.96753246, 'binary_recall': 0.69302326, 'binary_specificity': 0.9767442, 'binary_f1_score': 0.8075881}
confusion matrix:
     0    1
0  210    5
1   66  149
early stop counter: 4
val acc:0.8322981595993042, best validation acc: 0.8338509202003479, corresponding to test acc:                         0.8674418330192566 / 0.8674418330192566
after epoch: 8,now: 2024-07-27 15:04:10.186519,epoch time: 0:01:29.431220,used: 0:12:01.550356,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_14_52_08_seed_0_23102107
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9824219, 'precision': 0.98290443, 'recall': 0.9822493, 'specificity': 0.9822493, 'f1': 0.98240995, 'auroc': 0.99940944, 'binary_precision': 0.9705514, 'binary_recall': 0.9955013, 'binary_specificity': 0.96899736, 'binary_f1_score': 0.982868}
confusion matrix:
      0     1
0  1469    47
1     7  1549
---- Validation: 
scalar performance:
{'acc': 0.8625776, 'precision': 0.86396104, 'recall': 0.86301744, 'specificity': 0.86301744, 'f1': 0.8625258, 'auroc': 0.93103904, 'binary_precision': 0.8377581, 'binary_recall': 0.8944882, 'binary_specificity': 0.8315467, 'binary_f1_score': 0.8651942}
confusion matrix:
     0    1
0  543  110
1   67  568
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8418605, 'precision': 0.84292877, 'recall': 0.8418604, 'specificity': 0.8418604, 'f1': 0.8417372, 'auroc': 0.92270416, 'binary_precision': 0.86206895, 'binary_recall': 0.81395346, 'binary_specificity': 0.8697674, 'binary_f1_score': 0.83732057}
confusion matrix:
     0    1
0  187   28
1   40  175
better model found
persisted
after epoch: 9,now: 2024-07-27 15:05:39.681902,epoch time: 0:01:29.495383,used: 0:13:31.045739,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_14_52_08_seed_0_23102107
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.97298175, 'precision': 0.9740463, 'recall': 0.97332907, 'specificity': 0.97332907, 'f1': 0.97297645, 'auroc': 0.9989639, 'binary_precision': 1.0, 'binary_recall': 0.9466581, 'binary_specificity': 1.0, 'binary_f1_score': 0.9725982}
confusion matrix:
      0     1
0  1516     0
1    83  1473
---- Validation: 
scalar performance:
{'acc': 0.75931674, 'precision': 0.81349766, 'recall': 0.75638306, 'specificity': 0.75638306, 'f1': 0.747017, 'auroc': 0.92397296, 'binary_precision': 0.9403794, 'binary_recall': 0.5464567, 'binary_specificity': 0.96630937, 'binary_f1_score': 0.69123507}
confusion matrix:
     0    1
0  631   22
1  288  347
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8418605, 'precision': 0.8686918, 'recall': 0.8418605, 'specificity': 0.8418605, 'f1': 0.83893, 'auroc': 0.91675496, 'binary_precision': 0.9681529, 'binary_recall': 0.7069768, 'binary_specificity': 0.9767442, 'binary_f1_score': 0.8172043}
confusion matrix:
     0    1
0  210    5
1   63  152
early stop counter: 1
val acc:0.7593167424201965, best validation acc: 0.8625776171684265, corresponding to test acc:                         0.8418604731559753 / 0.8674418330192566
after epoch: 10,now: 2024-07-27 15:07:09.101623,epoch time: 0:01:29.419721,used: 0:15:00.465460,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_14_52_08_seed_0_23102107
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9820964, 'precision': 0.9825064, 'recall': 0.9823151, 'specificity': 0.9823151, 'f1': 0.9820958, 'auroc': 0.99940765, 'binary_precision': 1.0, 'binary_recall': 0.96463025, 'binary_specificity': 1.0, 'binary_f1_score': 0.9819967}
confusion matrix:
      0     1
0  1517     0
1    55  1500
---- Validation: 
scalar performance:
{'acc': 0.79270184, 'precision': 0.8351493, 'recall': 0.79019785, 'specificity': 0.79019785, 'f1': 0.7849196, 'auroc': 0.93435025, 'binary_precision': 0.95098037, 'binary_recall': 0.6110236, 'binary_specificity': 0.96937215, 'binary_f1_score': 0.74400765}
confusion matrix:
     0    1
0  633   20
1  247  388
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.83023256, 'precision': 0.8732639, 'recall': 0.83023256, 'specificity': 0.83023256, 'f1': 0.8251945, 'auroc': 0.9431044, 'binary_precision': 1.0, 'binary_recall': 0.6604651, 'binary_specificity': 1.0, 'binary_f1_score': 0.7955182}
confusion matrix:
     0    1
0  215    0
1   73  142
early stop counter: 2
val acc:0.7927018404006958, best validation acc: 0.8625776171684265, corresponding to test acc:                         0.8418604731559753 / 0.8674418330192566
after epoch: 11,now: 2024-07-27 15:08:37.940239,epoch time: 0:01:28.838616,used: 0:16:29.304076,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_14_52_08_seed_0_23102107
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9892578, 'precision': 0.9893296, 'recall': 0.9893874, 'specificity': 0.9893874, 'f1': 0.9892577, 'auroc': 0.9997338, 'binary_precision': 0.9993443, 'binary_recall': 0.97943443, 'binary_specificity': 0.99934036, 'binary_f1_score': 0.98928916}
confusion matrix:
      0     1
0  1515     1
1    32  1524
---- Validation: 
scalar performance:
{'acc': 0.6281056, 'precision': 0.74699223, 'recall': 0.62318194, 'specificity': 0.62318194, 'f1': 0.57236856, 'auroc': 0.88033426, 'binary_precision': 0.9148936, 'binary_recall': 0.27086616, 'binary_specificity': 0.9754977, 'binary_f1_score': 0.417983}
confusion matrix:
     0    1
0  637   16
1  463  172
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6976744, 'precision': 0.7712954, 'recall': 0.6976744, 'specificity': 0.6976744, 'f1': 0.67567134, 'auroc': 0.8857112, 'binary_precision': 0.9126214, 'binary_recall': 0.4372093, 'binary_specificity': 0.95813954, 'binary_f1_score': 0.59119505}
confusion matrix:
     0   1
0  206   9
1  121  94
early stop counter: 3
val acc:0.6281055808067322, best validation acc: 0.8625776171684265, corresponding to test acc:                         0.8418604731559753 / 0.8674418330192566
after epoch: 12,now: 2024-07-27 15:10:09.585728,epoch time: 0:01:31.645489,used: 0:18:00.949565,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_14_52_08_seed_0_23102107
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9938151, 'precision': 0.9937915, 'recall': 0.9938629, 'specificity': 0.9938629, 'f1': 0.99381447, 'auroc': 0.9996486, 'binary_precision': 0.9974127, 'binary_recall': 0.9903661, 'binary_specificity': 0.99735975, 'binary_f1_score': 0.9938769}
confusion matrix:
      0     1
0  1511     4
1    15  1542
---- Validation: 
scalar performance:
{'acc': 0.80667704, 'precision': 0.82254815, 'recall': 0.8051091, 'specificity': 0.8051091, 'f1': 0.8036853, 'auroc': 0.91275156, 'binary_precision': 0.89068824, 'binary_recall': 0.6929134, 'binary_specificity': 0.91730475, 'binary_f1_score': 0.77945083}
confusion matrix:
     0    1
0  599   54
1  195  440
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8511628, 'precision': 0.86248636, 'recall': 0.8511628, 'specificity': 0.8511628, 'f1': 0.84999126, 'auroc': 0.9251487, 'binary_precision': 0.92655367, 'binary_recall': 0.7627907, 'binary_specificity': 0.9395349, 'binary_f1_score': 0.83673465}
confusion matrix:
     0    1
0  202   13
1   51  164
early stop counter: 4
val acc:0.8066770434379578, best validation acc: 0.8625776171684265, corresponding to test acc:                         0.8418604731559753 / 0.8674418330192566
after epoch: 13,now: 2024-07-27 15:11:39.661787,epoch time: 0:01:30.076059,used: 0:19:31.025624,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_14_52_08_seed_0_23102107
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9873047, 'precision': 0.98728865, 'recall': 0.98736614, 'specificity': 0.98736614, 'f1': 0.98730385, 'auroc': 0.9993391, 'binary_precision': 0.99221283, 'binary_recall': 0.98264784, 'binary_specificity': 0.99208444, 'binary_f1_score': 0.98740715}
confusion matrix:
      0     1
0  1504    12
1    27  1529
---- Validation: 
scalar performance:
{'acc': 0.746118, 'precision': 0.81477594, 'recall': 0.7428236, 'specificity': 0.7428236, 'f1': 0.7297477, 'auroc': 0.9242792, 'binary_precision': 0.9583333, 'binary_recall': 0.50708663, 'binary_specificity': 0.9785605, 'binary_f1_score': 0.66323376}
confusion matrix:
     0    1
0  639   14
1  313  322
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7162791, 'precision': 0.8008667, 'recall': 0.7162791, 'specificity': 0.7162791, 'f1': 0.6948297, 'auroc': 0.9002271, 'binary_precision': 0.96039605, 'binary_recall': 0.4511628, 'binary_specificity': 0.98139536, 'binary_f1_score': 0.613924}
confusion matrix:
     0   1
0  211   4
1  118  97
early stop counter: 5
val acc:0.7461180090904236, best validation acc: 0.8625776171684265, corresponding to test acc:                         0.8418604731559753 / 0.8674418330192566
after epoch: 14,now: 2024-07-27 15:13:09.032021,epoch time: 0:01:29.370234,used: 0:21:00.395858,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_14_52_08_seed_0_23102107
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 14 with time: 0:21:00.395858 at 2024-07-27 15:13:09.032021
persisted model performance metric: 

scalar performance:
{'acc': 0.8418605, 'precision': 0.84292877, 'recall': 0.8418604, 'specificity': 0.8418604, 'f1': 0.8417372, 'auroc': 0.92270416, 'binary_precision': 0.86206895, 'binary_recall': 0.81395346, 'binary_specificity': 0.8697674, 'binary_f1_score': 0.83732057}
confusion matrix:
     0    1
0  187   28
1   40  175
oracle model performance metric: 

scalar performance:
{'acc': 0.86744183, 'precision': 0.8813084, 'recall': 0.86744183, 'specificity': 0.86744183, 'f1': 0.8662257, 'auroc': 0.9304056, 'binary_precision': 0.954023, 'binary_recall': 0.772093, 'binary_specificity': 0.96279067, 'binary_f1_score': 0.8534705}
confusion matrix:
     0    1
0  207    8
1   49  166
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_dannratio_10seeds_nofreeze_2024-07-27_14-18-24/rule_results/0.csv
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_dannratio_10seeds_nofreeze_2024-07-27_14-18-24/rule_results/0.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_dannratio_10seeds_nofreeze_2024-07-27_14-18-24/confusion_matrix/0.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 454925 KiB |   2002 MiB |  30461 GiB |  30460 GiB |
|       from large pool | 414333 KiB |   1970 MiB |  30071 GiB |  30071 GiB |
|       from small pool |  40592 KiB |     56 MiB |    389 GiB |    389 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 454925 KiB |   2002 MiB |  30461 GiB |  30460 GiB |
|       from large pool | 414333 KiB |   1970 MiB |  30071 GiB |  30071 GiB |
|       from small pool |  40592 KiB |     56 MiB |    389 GiB |    389 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 447480 KiB |   1998 MiB |  30369 GiB |  30369 GiB |
|       from large pool | 407075 KiB |   1966 MiB |  29981 GiB |  29981 GiB |
|       from small pool |  40405 KiB |     56 MiB |    388 GiB |    388 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2276 MiB |   2276 MiB |   2276 MiB |      0 B   |
|       from large pool |   2212 MiB |   2212 MiB |   2212 MiB |      0 B   |
|       from small pool |     64 MiB |     64 MiB |     64 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory | 386802 KiB | 387009 KiB |  23628 GiB |  23627 GiB |
|       from large pool | 380291 KiB | 380291 KiB |  23218 GiB |  23218 GiB |
|       from small pool |   6511 KiB |  12075 KiB |    409 GiB |    409 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    1298    |    1669    |    5809 K  |    5808 K  |
|       from large pool |     187    |     311    |    2791 K  |    2791 K  |
|       from small pool |    1111    |    1407    |    3018 K  |    3017 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    1298    |    1669    |    5809 K  |    5808 K  |
|       from large pool |     187    |     311    |    2791 K  |    2791 K  |
|       from small pool |    1111    |    1407    |    3018 K  |    3017 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     124    |     124    |     124    |       0    |
|       from large pool |      92    |      92    |      92    |       0    |
|       from small pool |      32    |      32    |      32    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      72    |     257    |    3375 K  |    3375 K  |
|       from large pool |      35    |      90    |    2157 K  |    2157 K  |
|       from small pool |      37    |     222    |    1217 K  |    1217 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   2002 MiB |  30461 GiB |  30461 GiB |
|       from large pool |  16640 KiB |   1970 MiB |  30071 GiB |  30071 GiB |
|       from small pool |      0 KiB |     56 MiB |    389 GiB |    389 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   2002 MiB |  30461 GiB |  30461 GiB |
|       from large pool |  16640 KiB |   1970 MiB |  30071 GiB |  30071 GiB |
|       from small pool |      0 KiB |     56 MiB |    389 GiB |    389 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   1998 MiB |  30369 GiB |  30369 GiB |
|       from large pool |  16640 KiB |   1966 MiB |  29981 GiB |  29981 GiB |
|       from small pool |      0 KiB |     56 MiB |    388 GiB |    388 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    822 MiB |   2276 MiB |   2276 MiB |   1454 MiB |
|       from large pool |    776 MiB |   2212 MiB |   2212 MiB |   1436 MiB |
|       from small pool |     46 MiB |     64 MiB |     64 MiB |     18 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  30464 KiB | 392712 KiB |  23628 GiB |  23628 GiB |
|       from large pool |  30464 KiB | 384405 KiB |  23219 GiB |  23219 GiB |
|       from small pool |      0 KiB |  20299 KiB |    409 GiB |    409 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    1669    |    5809 K  |    5809 K  |
|       from large pool |       2    |     311    |    2791 K  |    2791 K  |
|       from small pool |       0    |    1407    |    3018 K  |    3018 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    1669    |    5809 K  |    5809 K  |
|       from large pool |       2    |     311    |    2791 K  |    2791 K  |
|       from small pool |       0    |    1407    |    3018 K  |    3018 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      57    |     124    |     124    |      67    |
|       from large pool |      34    |      92    |      92    |      58    |
|       from small pool |      23    |      32    |      32    |       9    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |     257    |    3375 K  |    3375 K  |
|       from large pool |       4    |      90    |    2157 K  |    2157 K  |
|       from small pool |       0    |     222    |    1217 K  |    1217 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   2002 MiB |  30461 GiB |  30461 GiB |
|       from large pool |  16640 KiB |   1970 MiB |  30071 GiB |  30071 GiB |
|       from small pool |      0 KiB |     56 MiB |    389 GiB |    389 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   2002 MiB |  30461 GiB |  30461 GiB |
|       from large pool |  16640 KiB |   1970 MiB |  30071 GiB |  30071 GiB |
|       from small pool |      0 KiB |     56 MiB |    389 GiB |    389 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   1998 MiB |  30369 GiB |  30369 GiB |
|       from large pool |  16640 KiB |   1966 MiB |  29981 GiB |  29981 GiB |
|       from small pool |      0 KiB |     56 MiB |    388 GiB |    388 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    822 MiB |   2276 MiB |   2276 MiB |   1454 MiB |
|       from large pool |    776 MiB |   2212 MiB |   2212 MiB |   1436 MiB |
|       from small pool |     46 MiB |     64 MiB |     64 MiB |     18 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  30464 KiB | 392712 KiB |  23628 GiB |  23628 GiB |
|       from large pool |  30464 KiB | 384405 KiB |  23219 GiB |  23219 GiB |
|       from small pool |      0 KiB |  20299 KiB |    409 GiB |    409 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    1669    |    5809 K  |    5809 K  |
|       from large pool |       2    |     311    |    2791 K  |    2791 K  |
|       from small pool |       0    |    1407    |    3018 K  |    3018 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    1669    |    5809 K  |    5809 K  |
|       from large pool |       2    |     311    |    2791 K  |    2791 K  |
|       from small pool |       0    |    1407    |    3018 K  |    3018 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      57    |     124    |     124    |      67    |
|       from large pool |      34    |      92    |      92    |      58    |
|       from small pool |      23    |      32    |      32    |       9    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |     257    |    3375 K  |    3375 K  |
|       from large pool |       4    |      90    |    2157 K  |    2157 K  |
|       from small pool |       0    |     222    |    1217 K  |    1217 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_15_13_42_seed_1_23102107

 Experiment start at: 2024-07-27 15:13:42.375713
before training, model accuracy: 0.6177777647972107
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9641927, 'precision': 0.96442497, 'recall': 0.9643557, 'specificity': 0.9643557, 'f1': 0.96419245, 'auroc': 0.99245214, 'binary_precision': 0.9781457, 'binary_recall': 0.9504505, 'binary_specificity': 0.9782609, 'binary_f1_score': 0.9640992}
confusion matrix:
      0     1
0  1485    33
1    77  1477
---- Validation: 
scalar performance:
{'acc': 0.793911, 'precision': 0.79973936, 'recall': 0.79272914, 'specificity': 0.79272914, 'f1': 0.792408, 'auroc': 0.87734133, 'binary_precision': 0.8376384, 'binary_recall': 0.72063494, 'binary_specificity': 0.86482334, 'binary_f1_score': 0.77474403}
confusion matrix:
     0    1
0  563   88
1  176  454
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7888889, 'precision': 0.7988109, 'recall': 0.7888889, 'specificity': 0.7888889, 'f1': 0.7871217, 'auroc': 0.8781827, 'binary_precision': 0.8532609, 'binary_recall': 0.69777775, 'binary_specificity': 0.88, 'binary_f1_score': 0.7677261}
confusion matrix:
     0    1
0  198   27
1   68  157
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-27 15:15:15.582483,epoch time: 0:01:33.206770,used: 0:01:33.206770,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_15_13_42_seed_1_23102107
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9635417, 'precision': 0.96368957, 'recall': 0.9634458, 'specificity': 0.9634458, 'f1': 0.96352684, 'auroc': 0.99476314, 'binary_precision': 0.95814836, 'binary_recall': 0.970456, 'binary_specificity': 0.9564356, 'binary_f1_score': 0.9642629}
confusion matrix:
      0     1
0  1449    66
1    46  1511
---- Validation: 
scalar performance:
{'acc': 0.8196721, 'precision': 0.8267384, 'recall': 0.82086533, 'specificity': 0.82086533, 'f1': 0.8190352, 'auroc': 0.90440106, 'binary_precision': 0.77441543, 'binary_recall': 0.89365077, 'binary_specificity': 0.7480799, 'binary_f1_score': 0.8297715}
confusion matrix:
     0    1
0  487  164
1   67  563
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8288889, 'precision': 0.8290514, 'recall': 0.8288889, 'specificity': 0.8288889, 'f1': 0.8288677, 'auroc': 0.90504694, 'binary_precision': 0.82173914, 'binary_recall': 0.84, 'binary_specificity': 0.81777775, 'binary_f1_score': 0.8307692}
confusion matrix:
     0    1
0  184   41
1   36  189
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-07-27 15:16:45.815408,epoch time: 0:01:30.232925,used: 0:03:03.439695,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_15_13_42_seed_1_23102107
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9824219, 'precision': 0.9825568, 'recall': 0.9825568, 'specificity': 0.9825568, 'f1': 0.9824218, 'auroc': 0.9980136, 'binary_precision': 0.9940711, 'binary_recall': 0.97104245, 'binary_specificity': 0.9940711, 'binary_f1_score': 0.9824218}
confusion matrix:
      0     1
0  1509     9
1    45  1509
---- Validation: 
scalar performance:
{'acc': 0.8306011, 'precision': 0.830675, 'recall': 0.83074754, 'specificity': 0.83074754, 'f1': 0.8305974, 'auroc': 0.8916173, 'binary_precision': 0.820155, 'binary_recall': 0.8396825, 'binary_specificity': 0.82181257, 'binary_f1_score': 0.82980394}
confusion matrix:
     0    1
0  535  116
1  101  529
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8, 'precision': 0.8070104, 'recall': 0.8, 'specificity': 0.8, 'f1': 0.7988517, 'auroc': 0.8907062, 'binary_precision': 0.76061773, 'binary_recall': 0.8755556, 'binary_specificity': 0.72444445, 'binary_f1_score': 0.8140496}
confusion matrix:
     0    1
0  163   62
1   28  197
better model found
persisted
after epoch: 3,now: 2024-07-27 15:18:15.489720,epoch time: 0:01:29.674312,used: 0:04:33.114007,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_15_13_42_seed_1_23102107
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.98079425, 'precision': 0.9808451, 'recall': 0.9808947, 'specificity': 0.9808947, 'f1': 0.98079413, 'auroc': 0.9976969, 'binary_precision': 0.9895219, 'binary_recall': 0.9723295, 'binary_specificity': 0.9894598, 'binary_f1_score': 0.9808504}
confusion matrix:
      0     1
0  1502    16
1    43  1511
---- Validation: 
scalar performance:
{'acc': 0.8001561, 'precision': 0.80588603, 'recall': 0.8012545, 'specificity': 0.8012545, 'f1': 0.7995746, 'auroc': 0.8598542, 'binary_precision': 0.75972223, 'binary_recall': 0.86825395, 'binary_specificity': 0.734255, 'binary_f1_score': 0.8103704}
confusion matrix:
     0    1
0  478  173
1   83  547
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.76, 'precision': 0.7758913, 'recall': 0.76, 'specificity': 0.76, 'f1': 0.7564935, 'auroc': 0.84171855, 'binary_precision': 0.7096774, 'binary_recall': 0.88, 'binary_specificity': 0.64, 'binary_f1_score': 0.7857143}
confusion matrix:
     0    1
0  144   81
1   27  198
early stop counter: 1
val acc:0.8001561164855957, best validation acc: 0.8306010961532593, corresponding to test acc:                         0.800000011920929 / 0.8288888931274414
after epoch: 4,now: 2024-07-27 15:19:45.187155,epoch time: 0:01:29.697435,used: 0:06:02.811442,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_15_13_42_seed_1_23102107
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9811198, 'precision': 0.9810964, 'recall': 0.9811519, 'specificity': 0.9811519, 'f1': 0.9811175, 'auroc': 0.9981792, 'binary_precision': 0.98386055, 'binary_recall': 0.9788054, 'binary_specificity': 0.98349833, 'binary_f1_score': 0.98132646}
confusion matrix:
      0     1
0  1490    25
1    33  1524
---- Validation: 
scalar performance:
{'acc': 0.71272445, 'precision': 0.7817632, 'recall': 0.70860213, 'specificity': 0.70860213, 'f1': 0.69136417, 'auroc': 0.89122474, 'binary_precision': 0.91719747, 'binary_recall': 0.45714286, 'binary_specificity': 0.96006143, 'binary_f1_score': 0.61016953}
confusion matrix:
     0    1
0  625   26
1  342  288
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.79333335, 'precision': 0.8200431, 'recall': 0.7933333, 'specificity': 0.7933333, 'f1': 0.78892946, 'auroc': 0.8892247, 'binary_precision': 0.9125, 'binary_recall': 0.6488889, 'binary_specificity': 0.93777776, 'binary_f1_score': 0.7584415}
confusion matrix:
     0    1
0  211   14
1   79  146
early stop counter: 2
val acc:0.7127244472503662, best validation acc: 0.8306010961532593, corresponding to test acc:                         0.800000011920929 / 0.8288888931274414
after epoch: 5,now: 2024-07-27 15:21:14.835098,epoch time: 0:01:29.647943,used: 0:07:32.459385,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_15_13_42_seed_1_23102107
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.95996094, 'precision': 0.96204704, 'recall': 0.9595722, 'specificity': 0.9595722, 'f1': 0.9598857, 'auroc': 0.99724025, 'binary_precision': 0.9339394, 'binary_recall': 0.9909968, 'binary_specificity': 0.9281477, 'binary_f1_score': 0.9616224}
confusion matrix:
      0     1
0  1408   109
1    14  1541
---- Validation: 
scalar performance:
{'acc': 0.7782982, 'precision': 0.7949393, 'recall': 0.7802099, 'specificity': 0.7802099, 'f1': 0.7758823, 'auroc': 0.8877819, 'binary_precision': 0.72066325, 'binary_recall': 0.8968254, 'binary_specificity': 0.6635945, 'binary_f1_score': 0.7991513}
confusion matrix:
     0    1
0  432  219
1   65  565
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7355555, 'precision': 0.7893294, 'recall': 0.7355555, 'specificity': 0.7355555, 'f1': 0.7226696, 'auroc': 0.9193481, 'binary_precision': 0.66459626, 'binary_recall': 0.95111114, 'binary_specificity': 0.52, 'binary_f1_score': 0.7824498}
confusion matrix:
     0    1
0  117  108
1   11  214
early stop counter: 3
val acc:0.7782981991767883, best validation acc: 0.8306010961532593, corresponding to test acc:                         0.800000011920929 / 0.8288888931274414
after epoch: 6,now: 2024-07-27 15:22:44.641019,epoch time: 0:01:29.805921,used: 0:09:02.265306,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_15_13_42_seed_1_23102107
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.98828125, 'precision': 0.9882653, 'recall': 0.9883025, 'specificity': 0.9883025, 'f1': 0.98828006, 'auroc': 0.99941325, 'binary_precision': 0.9903101, 'binary_recall': 0.9864865, 'binary_specificity': 0.99011856, 'binary_f1_score': 0.98839456}
confusion matrix:
      0     1
0  1503    15
1    21  1533
---- Validation: 
scalar performance:
{'acc': 0.8469945, 'precision': 0.8510231, 'recall': 0.84610856, 'specificity': 0.84610856, 'f1': 0.84628546, 'auroc': 0.9096141, 'binary_precision': 0.8847518, 'binary_recall': 0.7920635, 'binary_specificity': 0.90015364, 'binary_f1_score': 0.8358459}
confusion matrix:
     0    1
0  586   65
1  131  499
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.79333335, 'precision': 0.7933855, 'recall': 0.79333335, 'specificity': 0.79333335, 'f1': 0.7933241, 'auroc': 0.8649876, 'binary_precision': 0.7972973, 'binary_recall': 0.7866667, 'binary_specificity': 0.8, 'binary_f1_score': 0.7919463}
confusion matrix:
     0    1
0  180   45
1   48  177
better model found
persisted
after epoch: 7,now: 2024-07-27 15:24:14.189234,epoch time: 0:01:29.548215,used: 0:10:31.813521,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_15_13_42_seed_1_23102107
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.98372394, 'precision': 0.98371476, 'recall': 0.98372954, 'specificity': 0.98372954, 'f1': 0.98372173, 'auroc': 0.998484, 'binary_precision': 0.98454607, 'binary_recall': 0.98327976, 'binary_specificity': 0.9841793, 'binary_f1_score': 0.98391247}
confusion matrix:
      0     1
0  1493    24
1    26  1529
---- Validation: 
scalar performance:
{'acc': 0.8594848, 'precision': 0.85963005, 'recall': 0.85967743, 'specificity': 0.85967743, 'f1': 0.85948396, 'auroc': 0.9192232, 'binary_precision': 0.8472222, 'binary_recall': 0.87142855, 'binary_specificity': 0.84792626, 'binary_f1_score': 0.85915494}
confusion matrix:
     0    1
0  552   99
1   81  549
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.85333335, 'precision': 0.8537806, 'recall': 0.85333335, 'specificity': 0.85333335, 'f1': 0.853287, 'auroc': 0.9146272, 'binary_precision': 0.8663595, 'binary_recall': 0.83555555, 'binary_specificity': 0.8711111, 'binary_f1_score': 0.8506788}
confusion matrix:
     0    1
0  196   29
1   37  188
new oracle model saved
better model found
persisted
after epoch: 8,now: 2024-07-27 15:25:43.597305,epoch time: 0:01:29.408071,used: 0:12:01.221592,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_15_13_42_seed_1_23102107
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9892578, 'precision': 0.9892724, 'recall': 0.9893535, 'specificity': 0.9893535, 'f1': 0.9892575, 'auroc': 0.99933016, 'binary_precision': 0.99673843, 'binary_recall': 0.9820051, 'binary_specificity': 0.99670184, 'binary_f1_score': 0.98931694}
confusion matrix:
      0     1
0  1511     5
1    28  1528
---- Validation: 
scalar performance:
{'acc': 0.8196721, 'precision': 0.82387304, 'recall': 0.8187148, 'specificity': 0.8187148, 'f1': 0.8187372, 'auroc': 0.89248526, 'binary_precision': 0.8568873, 'binary_recall': 0.76031744, 'binary_specificity': 0.87711215, 'binary_f1_score': 0.80571914}
confusion matrix:
     0    1
0  571   80
1  151  479
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.80222225, 'precision': 0.8097166, 'recall': 0.80222225, 'specificity': 0.80222225, 'f1': 0.80101854, 'auroc': 0.85657287, 'binary_precision': 0.8578947, 'binary_recall': 0.72444445, 'binary_specificity': 0.88, 'binary_f1_score': 0.7855422}
confusion matrix:
     0    1
0  198   27
1   62  163
early stop counter: 1
val acc:0.8196721076965332, best validation acc: 0.8594847917556763, corresponding to test acc:                         0.8533333539962769 / 0.8533333539962769
after epoch: 9,now: 2024-07-27 15:27:12.671070,epoch time: 0:01:29.073765,used: 0:13:30.295357,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_15_13_42_seed_1_23102107
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9820964, 'precision': 0.9824841, 'recall': 0.98233783, 'specificity': 0.98233783, 'f1': 0.982096, 'auroc': 0.9993293, 'binary_precision': 1.0, 'binary_recall': 0.96467566, 'binary_specificity': 1.0, 'binary_f1_score': 0.98202026}
confusion matrix:
      0     1
0  1515     0
1    55  1502
---- Validation: 
scalar performance:
{'acc': 0.5331772, 'precision': 0.6846418, 'recall': 0.52557606, 'specificity': 0.52557606, 'f1': 0.39915574, 'auroc': 0.8983615, 'binary_precision': 0.84782606, 'binary_recall': 0.061904762, 'binary_specificity': 0.9892473, 'binary_f1_score': 0.115384616}
confusion matrix:
     0   1
0  644   7
1  591  39
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.4977778, 'precision': 0.47670326, 'recall': 0.4977778, 'specificity': 0.4977778, 'f1': 0.3510057, 'auroc': 0.867437, 'binary_precision': 0.45454547, 'binary_recall': 0.022222223, 'binary_specificity': 0.97333336, 'binary_f1_score': 0.042372882}
confusion matrix:
     0  1
0  219  6
1  220  5
early stop counter: 2
val acc:0.5331771969795227, best validation acc: 0.8594847917556763, corresponding to test acc:                         0.8533333539962769 / 0.8533333539962769
after epoch: 10,now: 2024-07-27 15:28:42.094224,epoch time: 0:01:29.423154,used: 0:14:59.718511,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_15_13_42_seed_1_23102107
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.98795575, 'precision': 0.9880663, 'recall': 0.9880731, 'specificity': 0.9880731, 'f1': 0.98795575, 'auroc': 0.9996041, 'binary_precision': 0.9986842, 'binary_recall': 0.97746295, 'binary_specificity': 0.99868333, 'binary_f1_score': 0.9879597}
confusion matrix:
      0     1
0  1517     2
1    35  1518
---- Validation: 
scalar performance:
{'acc': 0.6128025, 'precision': 0.7547171, 'recall': 0.6065796, 'specificity': 0.6065796, 'f1': 0.54353863, 'auroc': 0.9238657, 'binary_precision': 0.94078946, 'binary_recall': 0.22698413, 'binary_specificity': 0.9861751, 'binary_f1_score': 0.3657289}
confusion matrix:
     0    1
0  642    9
1  487  143
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.52444446, 'precision': 0.7178314, 'recall': 0.52444446, 'specificity': 0.52444446, 'f1': 0.38878876, 'auroc': 0.91766906, 'binary_precision': 0.9230769, 'binary_recall': 0.053333335, 'binary_specificity': 0.9955556, 'binary_f1_score': 0.10084034}
confusion matrix:
     0   1
0  224   1
1  213  12
early stop counter: 3
val acc:0.6128025054931641, best validation acc: 0.8594847917556763, corresponding to test acc:                         0.8533333539962769 / 0.8533333539962769
after epoch: 11,now: 2024-07-27 15:30:11.037500,epoch time: 0:01:28.943276,used: 0:16:28.661787,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_15_13_42_seed_1_23102107
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.98828125, 'precision': 0.9885092, 'recall': 0.9881861, 'specificity': 0.9881861, 'f1': 0.9882768, 'auroc': 0.99944425, 'binary_precision': 0.9803673, 'binary_recall': 0.9967804, 'binary_specificity': 0.97959185, 'binary_f1_score': 0.9885057}
confusion matrix:
      0     1
0  1488    31
1     5  1548
---- Validation: 
scalar performance:
{'acc': 0.7798595, 'precision': 0.82221055, 'recall': 0.7768561, 'specificity': 0.7768561, 'f1': 0.7710703, 'auroc': 0.92376566, 'binary_precision': 0.935, 'binary_recall': 0.5936508, 'binary_specificity': 0.96006143, 'binary_f1_score': 0.7262137}
confusion matrix:
     0    1
0  625   26
1  256  374
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.81777775, 'precision': 0.85632014, 'recall': 0.81777775, 'specificity': 0.81777775, 'f1': 0.81271315, 'auroc': 0.9143506, 'binary_precision': 0.9735099, 'binary_recall': 0.6533333, 'binary_specificity': 0.9822222, 'binary_f1_score': 0.7819149}
confusion matrix:
     0    1
0  221    4
1   78  147
early stop counter: 4
val acc:0.7798594832420349, best validation acc: 0.8594847917556763, corresponding to test acc:                         0.8533333539962769 / 0.8533333539962769
after epoch: 12,now: 2024-07-27 15:31:40.379585,epoch time: 0:01:29.342085,used: 0:17:58.003872,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_15_13_42_seed_1_23102107
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.991862, 'precision': 0.9918453, 'recall': 0.9918818, 'specificity': 0.9918818, 'f1': 0.99186087, 'auroc': 0.9996625, 'binary_precision': 0.99355257, 'binary_recall': 0.9903599, 'binary_specificity': 0.9934037, 'binary_f1_score': 0.9919537}
confusion matrix:
      0     1
0  1506    10
1    15  1541
---- Validation: 
scalar performance:
{'acc': 0.76502734, 'precision': 0.81040704, 'recall': 0.7618536, 'specificity': 0.7618536, 'f1': 0.75460476, 'auroc': 0.9086728, 'binary_precision': 0.9250646, 'binary_recall': 0.568254, 'binary_specificity': 0.95545316, 'binary_f1_score': 0.7040315}
confusion matrix:
     0    1
0  622   29
1  272  358
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.75777775, 'precision': 0.7919724, 'recall': 0.7577778, 'specificity': 0.7577778, 'f1': 0.75047183, 'auroc': 0.87725437, 'binary_precision': 0.8918919, 'binary_recall': 0.58666664, 'binary_specificity': 0.9288889, 'binary_f1_score': 0.7077748}
confusion matrix:
     0    1
0  209   16
1   93  132
early stop counter: 5
val acc:0.7650273442268372, best validation acc: 0.8594847917556763, corresponding to test acc:                         0.8533333539962769 / 0.8533333539962769
after epoch: 13,now: 2024-07-27 15:33:10.277451,epoch time: 0:01:29.897866,used: 0:19:27.901738,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_15_13_42_seed_1_23102107
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 13 with time: 0:19:27.901738 at 2024-07-27 15:33:10.277451
persisted model performance metric: 

scalar performance:
{'acc': 0.85333335, 'precision': 0.8537806, 'recall': 0.85333335, 'specificity': 0.85333335, 'f1': 0.853287, 'auroc': 0.9146272, 'binary_precision': 0.8663595, 'binary_recall': 0.83555555, 'binary_specificity': 0.8711111, 'binary_f1_score': 0.8506788}
confusion matrix:
     0    1
0  196   29
1   37  188
oracle model performance metric: 

scalar performance:
{'acc': 0.85333335, 'precision': 0.8537806, 'recall': 0.85333335, 'specificity': 0.85333335, 'f1': 0.853287, 'auroc': 0.9146272, 'binary_precision': 0.8663595, 'binary_recall': 0.83555555, 'binary_specificity': 0.8711111, 'binary_f1_score': 0.8506788}
confusion matrix:
     0    1
0  196   29
1   37  188
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_dannratio_10seeds_nofreeze_2024-07-27_14-18-24/rule_results/0.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_dannratio_10seeds_nofreeze_2024-07-27_14-18-24/confusion_matrix/0.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 455469 KiB |   2004 MiB |  58828 GiB |  58827 GiB |
|       from large pool | 414870 KiB |   1971 MiB |  58073 GiB |  58072 GiB |
|       from small pool |  40598 KiB |     60 MiB |    755 GiB |    755 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 455469 KiB |   2004 MiB |  58828 GiB |  58827 GiB |
|       from large pool | 414870 KiB |   1971 MiB |  58073 GiB |  58072 GiB |
|       from small pool |  40598 KiB |     60 MiB |    755 GiB |    755 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 447481 KiB |   1998 MiB |  58619 GiB |  58619 GiB |
|       from large pool | 407075 KiB |   1966 MiB |  57866 GiB |  57865 GiB |
|       from small pool |  40406 KiB |     60 MiB |    753 GiB |    753 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2262 MiB |   2276 MiB |   3716 MiB |   1454 MiB |
|       from large pool |   2192 MiB |   2212 MiB |   3628 MiB |   1436 MiB |
|       from small pool |     70 MiB |     70 MiB |     88 MiB |     18 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 398547 KiB | 400040 KiB |  45146 GiB |  45145 GiB |
|       from large pool | 392041 KiB | 392041 KiB |  44351 GiB |  44351 GiB |
|       from small pool |   6505 KiB |  20299 KiB |    794 GiB |    794 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    1310    |    1681    |   11227 K  |   11225 K  |
|       from large pool |     187    |     311    |    5387 K  |    5387 K  |
|       from small pool |    1123    |    1419    |    5839 K  |    5838 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    1310    |    1681    |   11227 K  |   11225 K  |
|       from large pool |     187    |     311    |    5387 K  |    5387 K  |
|       from small pool |    1123    |    1419    |    5839 K  |    5838 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     126    |     126    |     193    |      67    |
|       from large pool |      91    |      92    |     149    |      58    |
|       from small pool |      35    |      35    |      44    |       9    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      71    |     257    |    6230 K  |    6230 K  |
|       from large pool |      34    |      90    |    3914 K  |    3914 K  |
|       from small pool |      37    |     222    |    2315 K  |    2315 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   2004 MiB |  58828 GiB |  58828 GiB |
|       from large pool |  16640 KiB |   1971 MiB |  58073 GiB |  58073 GiB |
|       from small pool |      0 KiB |     60 MiB |    755 GiB |    755 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   2004 MiB |  58828 GiB |  58828 GiB |
|       from large pool |  16640 KiB |   1971 MiB |  58073 GiB |  58073 GiB |
|       from small pool |      0 KiB |     60 MiB |    755 GiB |    755 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   1998 MiB |  58619 GiB |  58619 GiB |
|       from large pool |  16640 KiB |   1966 MiB |  57866 GiB |  57866 GiB |
|       from small pool |      0 KiB |     60 MiB |    753 GiB |    753 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    834 MiB |   2276 MiB |   3716 MiB |   2882 MiB |
|       from large pool |    788 MiB |   2212 MiB |   3628 MiB |   2840 MiB |
|       from small pool |     46 MiB |     70 MiB |     88 MiB |     42 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  30464 KiB | 418550 KiB |  45146 GiB |  45146 GiB |
|       from large pool |  30464 KiB | 409071 KiB |  44351 GiB |  44351 GiB |
|       from small pool |      0 KiB |  20299 KiB |    794 GiB |    794 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    1681    |   11227 K  |   11227 K  |
|       from large pool |       2    |     311    |    5387 K  |    5387 K  |
|       from small pool |       0    |    1419    |    5839 K  |    5839 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    1681    |   11227 K  |   11227 K  |
|       from large pool |       2    |     311    |    5387 K  |    5387 K  |
|       from small pool |       0    |    1419    |    5839 K  |    5839 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      57    |     126    |     193    |     136    |
|       from large pool |      34    |      92    |     149    |     115    |
|       from small pool |      23    |      35    |      44    |      21    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |     257    |    6230 K  |    6230 K  |
|       from large pool |       4    |      90    |    3914 K  |    3914 K  |
|       from small pool |       0    |     222    |    2315 K  |    2315 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   2004 MiB |  58828 GiB |  58828 GiB |
|       from large pool |  16640 KiB |   1971 MiB |  58073 GiB |  58073 GiB |
|       from small pool |      0 KiB |     60 MiB |    755 GiB |    755 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   2004 MiB |  58828 GiB |  58828 GiB |
|       from large pool |  16640 KiB |   1971 MiB |  58073 GiB |  58073 GiB |
|       from small pool |      0 KiB |     60 MiB |    755 GiB |    755 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   1998 MiB |  58619 GiB |  58619 GiB |
|       from large pool |  16640 KiB |   1966 MiB |  57866 GiB |  57866 GiB |
|       from small pool |      0 KiB |     60 MiB |    753 GiB |    753 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    834 MiB |   2276 MiB |   3716 MiB |   2882 MiB |
|       from large pool |    788 MiB |   2212 MiB |   3628 MiB |   2840 MiB |
|       from small pool |     46 MiB |     70 MiB |     88 MiB |     42 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  30464 KiB | 418550 KiB |  45146 GiB |  45146 GiB |
|       from large pool |  30464 KiB | 409071 KiB |  44351 GiB |  44351 GiB |
|       from small pool |      0 KiB |  20299 KiB |    794 GiB |    794 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    1681    |   11227 K  |   11227 K  |
|       from large pool |       2    |     311    |    5387 K  |    5387 K  |
|       from small pool |       0    |    1419    |    5839 K  |    5839 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    1681    |   11227 K  |   11227 K  |
|       from large pool |       2    |     311    |    5387 K  |    5387 K  |
|       from small pool |       0    |    1419    |    5839 K  |    5839 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      57    |     126    |     193    |     136    |
|       from large pool |      34    |      92    |     149    |     115    |
|       from small pool |      23    |      35    |      44    |      21    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |     257    |    6230 K  |    6230 K  |
|       from large pool |       4    |      90    |    3914 K  |    3914 K  |
|       from small pool |       0    |     222    |    2315 K  |    2315 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_15_33_43_seed_2_23102107

 Experiment start at: 2024-07-27 15:33:43.815449
before training, model accuracy: 0.41203704476356506
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.97022253, 'precision': 0.97113013, 'recall': 0.9704083, 'specificity': 0.9704083, 'f1': 0.97021484, 'auroc': 0.9955963, 'binary_precision': 0.993865, 'binary_recall': 0.94675326, 'binary_specificity': 0.9940633, 'binary_f1_score': 0.9697373}
confusion matrix:
      0     1
0  1507     9
1    82  1458
---- Validation: 
scalar performance:
{'acc': 0.7918623, 'precision': 0.8090324, 'recall': 0.7886318, 'specificity': 0.7886318, 'f1': 0.7875537, 'auroc': 0.87222636, 'binary_precision': 0.87552744, 'binary_recall': 0.6672026, 'binary_specificity': 0.910061, 'binary_f1_score': 0.75729924}
confusion matrix:
     0    1
0  597   59
1  207  415
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7893519, 'precision': 0.79010427, 'recall': 0.7893518, 'specificity': 0.7893518, 'f1': 0.7892152, 'auroc': 0.8585605, 'binary_precision': 0.80487806, 'binary_recall': 0.7638889, 'binary_specificity': 0.8148148, 'binary_f1_score': 0.783848}
confusion matrix:
     0    1
0  176   40
1   51  165
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-27 15:35:15.243600,epoch time: 0:01:31.428151,used: 0:01:31.428151,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_15_33_43_seed_2_23102107
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9597513, 'precision': 0.96238434, 'recall': 0.96005976, 'specificity': 0.96005976, 'f1': 0.9597108, 'auroc': 0.99694157, 'binary_precision': 0.9992953, 'binary_recall': 0.9207792, 'binary_specificity': 0.99934036, 'binary_f1_score': 0.95843196}
confusion matrix:
      0     1
0  1515     1
1   122  1418
---- Validation: 
scalar performance:
{'acc': 0.59311426, 'precision': 0.741861, 'recall': 0.58236855, 'specificity': 0.58236855, 'f1': 0.50626606, 'auroc': 0.83098876, 'binary_precision': 0.925, 'binary_recall': 0.17845659, 'binary_specificity': 0.9862805, 'binary_f1_score': 0.2991914}
confusion matrix:
     0    1
0  647    9
1  511  111
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5833333, 'precision': 0.77272725, 'recall': 0.5833333, 'specificity': 0.5833333, 'f1': 0.49579835, 'auroc': 0.88951045, 'binary_precision': 1.0, 'binary_recall': 0.16666667, 'binary_specificity': 1.0, 'binary_f1_score': 0.2857143}
confusion matrix:
     0   1
0  216   0
1  180  36
early stop counter: 1
val acc:0.5931142568588257, best validation acc: 0.7918623089790344, corresponding to test acc:                         0.7893518805503845 / 0.7893518805503845
after epoch: 2,now: 2024-07-27 15:36:43.665142,epoch time: 0:01:28.421542,used: 0:02:59.849693,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_15_33_43_seed_2_23102107
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.983966, 'precision': 0.98401934, 'recall': 0.98402405, 'specificity': 0.98402405, 'f1': 0.983966, 'auroc': 0.99859303, 'binary_precision': 0.99143046, 'binary_recall': 0.97662336, 'binary_specificity': 0.9914248, 'binary_f1_score': 0.98397124}
confusion matrix:
      0     1
0  1503    13
1    36  1504
---- Validation: 
scalar performance:
{'acc': 0.7363067, 'precision': 0.7961746, 'recall': 0.7301829, 'specificity': 0.7301829, 'f1': 0.71878576, 'auroc': 0.88909936, 'binary_precision': 0.92284864, 'binary_recall': 0.5, 'binary_specificity': 0.96036583, 'binary_f1_score': 0.64859223}
confusion matrix:
     0    1
0  630   26
1  311  311
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7430556, 'precision': 0.8110684, 'recall': 0.7430556, 'specificity': 0.7430556, 'f1': 0.72819877, 'auroc': 0.89083934, 'binary_precision': 0.95652175, 'binary_recall': 0.5092593, 'binary_specificity': 0.9768519, 'binary_f1_score': 0.66465265}
confusion matrix:
     0    1
0  211    5
1  106  110
early stop counter: 2
val acc:0.7363067269325256, best validation acc: 0.7918623089790344, corresponding to test acc:                         0.7893518805503845 / 0.7893518805503845
after epoch: 3,now: 2024-07-27 15:38:12.115893,epoch time: 0:01:28.450751,used: 0:04:28.300444,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_15_33_43_seed_2_23102107
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.98363876, 'precision': 0.9839999, 'recall': 0.9837611, 'specificity': 0.9837611, 'f1': 0.98363775, 'auroc': 0.99871504, 'binary_precision': 0.99932975, 'binary_recall': 0.9681818, 'binary_specificity': 0.99934036, 'binary_f1_score': 0.98350924}
confusion matrix:
      0     1
0  1515     1
1    49  1491
---- Validation: 
scalar performance:
{'acc': 0.7425665, 'precision': 0.80423474, 'recall': 0.7364471, 'specificity': 0.7364471, 'f1': 0.7254615, 'auroc': 0.89191294, 'binary_precision': 0.9347181, 'binary_recall': 0.50643086, 'binary_specificity': 0.9664634, 'binary_f1_score': 0.65693426}
confusion matrix:
     0    1
0  634   22
1  307  315
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6759259, 'precision': 0.7583407, 'recall': 0.6759259, 'specificity': 0.6759259, 'f1': 0.6478398, 'auroc': 0.87497854, 'binary_precision': 0.90425533, 'binary_recall': 0.3935185, 'binary_specificity': 0.9583333, 'binary_f1_score': 0.5483871}
confusion matrix:
     0   1
0  207   9
1  131  85
early stop counter: 3
val acc:0.7425665259361267, best validation acc: 0.7918623089790344, corresponding to test acc:                         0.7893518805503845 / 0.7893518805503845
after epoch: 4,now: 2024-07-27 15:39:40.706897,epoch time: 0:01:28.591004,used: 0:05:56.891448,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_15_33_43_seed_2_23102107
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.986911, 'precision': 0.9869038, 'recall': 0.9869205, 'specificity': 0.9869205, 'f1': 0.98691046, 'auroc': 0.9990641, 'binary_precision': 0.98828125, 'binary_recall': 0.98571426, 'binary_specificity': 0.98812664, 'binary_f1_score': 0.9869961}
confusion matrix:
      0     1
0  1498    18
1    22  1518
---- Validation: 
scalar performance:
{'acc': 0.8208138, 'precision': 0.82288444, 'recall': 0.81966615, 'specificity': 0.81966615, 'f1': 0.82005477, 'auroc': 0.88556045, 'binary_precision': 0.8429319, 'binary_recall': 0.77652735, 'binary_specificity': 0.8628049, 'binary_f1_score': 0.8083682}
confusion matrix:
     0    1
0  566   90
1  139  483
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7222222, 'precision': 0.7596414, 'recall': 0.7222222, 'specificity': 0.7222222, 'f1': 0.71183985, 'auroc': 0.8850094, 'binary_precision': 0.6610738, 'binary_recall': 0.912037, 'binary_specificity': 0.5324074, 'binary_f1_score': 0.7665369}
confusion matrix:
     0    1
0  115  101
1   19  197
better model found
persisted
after epoch: 5,now: 2024-07-27 15:41:09.946358,epoch time: 0:01:29.239461,used: 0:07:26.130909,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_15_33_43_seed_2_23102107
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9888743, 'precision': 0.98893535, 'recall': 0.98893535, 'specificity': 0.98893535, 'f1': 0.9888743, 'auroc': 0.99966073, 'binary_precision': 0.99670184, 'binary_recall': 0.9811688, 'binary_specificity': 0.99670184, 'binary_f1_score': 0.9888743}
confusion matrix:
      0     1
0  1511     5
1    29  1511
---- Validation: 
scalar performance:
{'acc': 0.7300469, 'precision': 0.8096468, 'recall': 0.7231688, 'specificity': 0.7231688, 'f1': 0.70747566, 'auroc': 0.91288865, 'binary_precision': 0.9601329, 'binary_recall': 0.46463022, 'binary_specificity': 0.98170733, 'binary_f1_score': 0.62621886}
confusion matrix:
     0    1
0  644   12
1  333  289
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5532407, 'precision': 0.74412775, 'recall': 0.5532408, 'specificity': 0.5532408, 'f1': 0.4446894, 'auroc': 0.91396606, 'binary_precision': 0.96, 'binary_recall': 0.11111111, 'binary_specificity': 0.9953704, 'binary_f1_score': 0.19917013}
confusion matrix:
     0   1
0  215   1
1  192  24
early stop counter: 1
val acc:0.7300469279289246, best validation acc: 0.820813775062561, corresponding to test acc:                         0.7222222089767456 / 0.7893518805503845
after epoch: 6,now: 2024-07-27 15:42:38.292673,epoch time: 0:01:28.346315,used: 0:08:54.477224,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_15_33_43_seed_2_23102107
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9751309, 'precision': 0.97548735, 'recall': 0.97525275, 'specificity': 0.97525275, 'f1': 0.97512937, 'auroc': 0.9971764, 'binary_precision': 0.9906166, 'binary_recall': 0.9597403, 'binary_specificity': 0.99076515, 'binary_f1_score': 0.97493404}
confusion matrix:
      0     1
0  1502    14
1    62  1478
---- Validation: 
scalar performance:
{'acc': 0.7363067, 'precision': 0.80529594, 'recall': 0.72984964, 'specificity': 0.72984964, 'f1': 0.71685123, 'auroc': 0.9111099, 'binary_precision': 0.94392526, 'binary_recall': 0.48713827, 'binary_specificity': 0.972561, 'binary_f1_score': 0.6426299}
confusion matrix:
     0    1
0  638   18
1  319  303
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5138889, 'precision': 0.7535211, 'recall': 0.5138889, 'specificity': 0.5138889, 'f1': 0.36347565, 'auroc': 0.8847736, 'binary_precision': 1.0, 'binary_recall': 0.027777778, 'binary_specificity': 1.0, 'binary_f1_score': 0.054054055}
confusion matrix:
     0  1
0  216  0
1  210  6
early stop counter: 2
val acc:0.7363067269325256, best validation acc: 0.820813775062561, corresponding to test acc:                         0.7222222089767456 / 0.7893518805503845
after epoch: 7,now: 2024-07-27 15:44:06.721044,epoch time: 0:01:28.428371,used: 0:10:22.905595,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_15_33_43_seed_2_23102107
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.983966, 'precision': 0.9839941, 'recall': 0.9840138, 'specificity': 0.9840138, 'f1': 0.98396593, 'auroc': 0.9992838, 'binary_precision': 0.99013805, 'binary_recall': 0.9779221, 'binary_specificity': 0.99010557, 'binary_f1_score': 0.98399216}
confusion matrix:
      0     1
0  1501    15
1    34  1506
---- Validation: 
scalar performance:
{'acc': 0.74413145, 'precision': 0.81445384, 'recall': 0.73772156, 'specificity': 0.73772156, 'f1': 0.7254943, 'auroc': 0.90492904, 'binary_precision': 0.95665634, 'binary_recall': 0.49678457, 'binary_specificity': 0.97865856, 'binary_f1_score': 0.6539682}
confusion matrix:
     0    1
0  642   14
1  313  309
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6805556, 'precision': 0.7991477, 'recall': 0.6805556, 'specificity': 0.6805556, 'f1': 0.645413, 'auroc': 0.9191101, 'binary_precision': 0.9875, 'binary_recall': 0.36574075, 'binary_specificity': 0.9953704, 'binary_f1_score': 0.5337838}
confusion matrix:
     0   1
0  215   1
1  137  79
early stop counter: 3
val acc:0.7441314458847046, best validation acc: 0.820813775062561, corresponding to test acc:                         0.7222222089767456 / 0.7893518805503845
after epoch: 8,now: 2024-07-27 15:45:35.069324,epoch time: 0:01:28.348280,used: 0:11:51.253875,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_15_33_43_seed_2_23102107
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.960733, 'precision': 0.96332514, 'recall': 0.96103895, 'specificity': 0.96103895, 'f1': 0.9606942, 'auroc': 0.99912447, 'binary_precision': 1.0, 'binary_recall': 0.9220779, 'binary_specificity': 1.0, 'binary_f1_score': 0.9594594}
confusion matrix:
      0     1
0  1516     0
1   120  1420
---- Validation: 
scalar performance:
{'acc': 0.56416273, 'precision': 0.7559787, 'recall': 0.55233413, 'specificity': 0.55233413, 'f1': 0.44763118, 'auroc': 0.8793042, 'binary_precision': 0.9710145, 'binary_recall': 0.107717045, 'binary_specificity': 0.9969512, 'binary_f1_score': 0.19392186}
confusion matrix:
     0   1
0  654   2
1  555  67
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5, 'precision': 0.25, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.33333334, 'auroc': 0.8386917, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
     0  1
0  216  0
1  216  0
early stop counter: 4
val acc:0.5641627311706543, best validation acc: 0.820813775062561, corresponding to test acc:                         0.7222222089767456 / 0.7893518805503845
after epoch: 9,now: 2024-07-27 15:47:03.521604,epoch time: 0:01:28.452280,used: 0:13:19.706155,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_15_33_43_seed_2_23102107
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9872382, 'precision': 0.98732376, 'recall': 0.98730683, 'specificity': 0.98730683, 'f1': 0.98723817, 'auroc': 0.9994354, 'binary_precision': 0.9960344, 'binary_recall': 0.9785714, 'binary_specificity': 0.9960422, 'binary_f1_score': 0.9872257}
confusion matrix:
      0     1
0  1510     6
1    33  1507
---- Validation: 
scalar performance:
{'acc': 0.7292645, 'precision': 0.7941998, 'recall': 0.72286487, 'specificity': 0.72286487, 'f1': 0.7096713, 'auroc': 0.8471198, 'binary_precision': 0.9259259, 'binary_recall': 0.48231512, 'binary_specificity': 0.9634146, 'binary_f1_score': 0.63424945}
confusion matrix:
     0    1
0  632   24
1  322  300
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7847222, 'precision': 0.81307304, 'recall': 0.7847222, 'specificity': 0.7847222, 'f1': 0.7797357, 'auroc': 0.87247086, 'binary_precision': 0.9072848, 'binary_recall': 0.6342593, 'binary_specificity': 0.9351852, 'binary_f1_score': 0.7465941}
confusion matrix:
     0    1
0  202   14
1   79  137
early stop counter: 5
val acc:0.729264497756958, best validation acc: 0.820813775062561, corresponding to test acc:                         0.7222222089767456 / 0.7893518805503845
after epoch: 10,now: 2024-07-27 15:48:32.381626,epoch time: 0:01:28.860022,used: 0:14:48.566177,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_15_33_43_seed_2_23102107
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 10 with time: 0:14:48.566177 at 2024-07-27 15:48:32.381626
persisted model performance metric: 

scalar performance:
{'acc': 0.7222222, 'precision': 0.7596414, 'recall': 0.7222222, 'specificity': 0.7222222, 'f1': 0.71183985, 'auroc': 0.8850094, 'binary_precision': 0.6610738, 'binary_recall': 0.912037, 'binary_specificity': 0.5324074, 'binary_f1_score': 0.7665369}
confusion matrix:
     0    1
0  115  101
1   19  197
oracle model performance metric: 

scalar performance:
{'acc': 0.7893519, 'precision': 0.79010427, 'recall': 0.7893518, 'specificity': 0.7893518, 'f1': 0.7892152, 'auroc': 0.8585605, 'binary_precision': 0.80487806, 'binary_recall': 0.7638889, 'binary_specificity': 0.8148148, 'binary_f1_score': 0.783848}
confusion matrix:
     0    1
0  176   40
1   51  165
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_dannratio_10seeds_nofreeze_2024-07-27_14-18-24/rule_results/0.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_dannratio_10seeds_nofreeze_2024-07-27_14-18-24/confusion_matrix/0.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 455387 KiB |   2004 MiB |  80541 GiB |  80540 GiB |
|       from large pool | 414795 KiB |   1971 MiB |  79508 GiB |  79508 GiB |
|       from small pool |  40592 KiB |     60 MiB |   1032 GiB |   1032 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 455387 KiB |   2004 MiB |  80541 GiB |  80540 GiB |
|       from large pool | 414795 KiB |   1971 MiB |  79508 GiB |  79508 GiB |
|       from small pool |  40592 KiB |     60 MiB |   1032 GiB |   1032 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 447481 KiB |   1998 MiB |  80258 GiB |  80258 GiB |
|       from large pool | 407075 KiB |   1966 MiB |  79228 GiB |  79227 GiB |
|       from small pool |  40406 KiB |     60 MiB |   1030 GiB |   1030 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2268 MiB |   2276 MiB |   5150 MiB |   2882 MiB |
|       from large pool |   2204 MiB |   2212 MiB |   5044 MiB |   2840 MiB |
|       from small pool |     64 MiB |     70 MiB |    106 MiB |     42 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 367908 KiB | 418550 KiB |  61987 GiB |  61987 GiB |
|       from large pool | 361397 KiB | 409071 KiB |  60901 GiB |  60900 GiB |
|       from small pool |   6511 KiB |  20299 KiB |   1086 GiB |   1086 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    1298    |    1681    |   15365 K  |   15363 K  |
|       from large pool |     187    |     311    |    7375 K  |    7375 K  |
|       from small pool |    1111    |    1419    |    7989 K  |    7987 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    1298    |    1681    |   15365 K  |   15363 K  |
|       from large pool |     187    |     311    |    7375 K  |    7375 K  |
|       from small pool |    1111    |    1419    |    7989 K  |    7987 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     123    |     126    |     259    |     136    |
|       from large pool |      91    |      92    |     206    |     115    |
|       from small pool |      32    |      35    |      53    |      21    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      72    |     257    |    8328 K  |    8328 K  |
|       from large pool |      34    |      90    |    5163 K  |    5163 K  |
|       from small pool |      38    |     222    |    3165 K  |    3165 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   2004 MiB |  80541 GiB |  80541 GiB |
|       from large pool |  16640 KiB |   1971 MiB |  79508 GiB |  79508 GiB |
|       from small pool |      0 KiB |     60 MiB |   1032 GiB |   1032 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   2004 MiB |  80541 GiB |  80541 GiB |
|       from large pool |  16640 KiB |   1971 MiB |  79508 GiB |  79508 GiB |
|       from small pool |      0 KiB |     60 MiB |   1032 GiB |   1032 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   1998 MiB |  80258 GiB |  80258 GiB |
|       from large pool |  16640 KiB |   1966 MiB |  79228 GiB |  79227 GiB |
|       from small pool |      0 KiB |     60 MiB |   1030 GiB |   1030 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    804 MiB |   2276 MiB |   5150 MiB |   4346 MiB |
|       from large pool |    758 MiB |   2212 MiB |   5044 MiB |   4286 MiB |
|       from small pool |     46 MiB |     70 MiB |    106 MiB |     60 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  30464 KiB | 418550 KiB |  61988 GiB |  61988 GiB |
|       from large pool |  30464 KiB | 409071 KiB |  60901 GiB |  60901 GiB |
|       from small pool |      0 KiB |  20299 KiB |   1086 GiB |   1086 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    1681    |   15365 K  |   15365 K  |
|       from large pool |       2    |     311    |    7375 K  |    7375 K  |
|       from small pool |       0    |    1419    |    7989 K  |    7989 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    1681    |   15365 K  |   15365 K  |
|       from large pool |       2    |     311    |    7375 K  |    7375 K  |
|       from small pool |       0    |    1419    |    7989 K  |    7989 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      57    |     126    |     259    |     202    |
|       from large pool |      34    |      92    |     206    |     172    |
|       from small pool |      23    |      35    |      53    |      30    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |     257    |    8328 K  |    8328 K  |
|       from large pool |       4    |      90    |    5163 K  |    5163 K  |
|       from small pool |       0    |     222    |    3165 K  |    3165 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Sat Jul 27 15:48:39 2024]
Finished job 0.
1 of 1 steps (100%) done
