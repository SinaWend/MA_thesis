Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Sat Jul 27 04:00:36 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_dial_3seeds_nofreeze_2024-07-27_01-29-56/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_dial_3seeds_nofreeze_2024-07-27_01-29-56/rule_results/1.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=1
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/swiglu_ffn.py:51: UserWarning: xFormers is not available (SwiGLU)
  warnings.warn("xFormers is not available (SwiGLU)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/attention.py:33: UserWarning: xFormers is not available (Attention)
  warnings.warn("xFormers is not available (Attention)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/block.py:40: UserWarning: xFormers is not available (Block)
  warnings.warn("xFormers is not available (Block)")
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_04_01_32_seed_0_23093153

 Experiment start at: 2024-07-27 04:01:32.597389
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
before training, model accuracy: 0.569767415523529
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9713542, 'precision': 0.97133404, 'recall': 0.971382, 'specificity': 0.971382, 'f1': 0.9713514, 'auroc': 0.9960668, 'binary_precision': 0.9741435, 'binary_recall': 0.9691318, 'binary_specificity': 0.97363216, 'binary_f1_score': 0.9716312}
confusion matrix:
      0     1
0  1477    40
1    48  1507
---- Validation: 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
scalar performance:
{'acc': 0.7996894, 'precision': 0.814108, 'recall': 0.80116963, 'specificity': 0.80116963, 'f1': 0.797876, 'auroc': 0.89326787, 'binary_precision': 0.7432258, 'binary_recall': 0.9070866, 'binary_specificity': 0.69525266, 'binary_f1_score': 0.8170213}
confusion matrix:
     0    1
0  454  199
1   59  576
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7976744, 'precision': 0.8126136, 'recall': 0.7976744, 'specificity': 0.7976744, 'f1': 0.795228, 'auroc': 0.9228556, 'binary_precision': 0.7442748, 'binary_recall': 0.90697676, 'binary_specificity': 0.6883721, 'binary_f1_score': 0.8176101}
confusion matrix:
     0    1
0  148   67
1   20  195
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-27 04:04:02.212217,epoch time: 0:02:29.614828,used: 0:02:29.614828,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_04_01_32_seed_0_23093153
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.96809894, 'precision': 0.9682438, 'recall': 0.9680135, 'specificity': 0.9680135, 'f1': 0.9680876, 'auroc': 0.9956056, 'binary_precision': 0.9625397, 'binary_recall': 0.9749196, 'binary_specificity': 0.96110743, 'binary_f1_score': 0.96869016}
confusion matrix:
      0     1
0  1458    59
1    39  1516
---- Validation: 
scalar performance:
{'acc': 0.7810559, 'precision': 0.80165637, 'recall': 0.782858, 'specificity': 0.782858, 'f1': 0.77796364, 'auroc': 0.8941313, 'binary_precision': 0.7192547, 'binary_recall': 0.911811, 'binary_specificity': 0.65390503, 'binary_f1_score': 0.8041667}
confusion matrix:
     0    1
0  427  226
1   56  579
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7883721, 'precision': 0.79925466, 'recall': 0.7883721, 'specificity': 0.7883721, 'f1': 0.7864305, 'auroc': 0.9153056, 'binary_precision': 0.7421875, 'binary_recall': 0.88372093, 'binary_specificity': 0.69302326, 'binary_f1_score': 0.8067941}
confusion matrix:
     0    1
0  149   66
1   25  190
early stop counter: 1
val acc:0.7810559272766113, best validation acc: 0.7996894121170044, corresponding to test acc:                         0.7976744174957275 / 0.7976744174957275
after epoch: 2,now: 2024-07-27 04:06:27.173760,epoch time: 0:02:24.961543,used: 0:04:54.576371,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_04_01_32_seed_0_23093153
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9798177, 'precision': 0.9798316, 'recall': 0.9799032, 'specificity': 0.9799032, 'f1': 0.97981715, 'auroc': 0.9979873, 'binary_precision': 0.9869537, 'binary_recall': 0.97299033, 'binary_specificity': 0.9868161, 'binary_f1_score': 0.9799223}
confusion matrix:
      0     1
0  1497    20
1    42  1513
---- Validation: 
scalar performance:
{'acc': 0.80124223, 'precision': 0.80234265, 'recall': 0.800791, 'specificity': 0.800791, 'f1': 0.80086577, 'auroc': 0.87773454, 'binary_precision': 0.8174204, 'binary_recall': 0.76850396, 'binary_specificity': 0.8330781, 'binary_f1_score': 0.7922078}
confusion matrix:
     0    1
0  544  109
1  147  488
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8627907, 'precision': 0.8634275, 'recall': 0.8627907, 'specificity': 0.8627907, 'f1': 0.86273056, 'auroc': 0.940292, 'binary_precision': 0.84821427, 'binary_recall': 0.88372093, 'binary_specificity': 0.8418605, 'binary_f1_score': 0.8656036}
confusion matrix:
     0    1
0  181   34
1   25  190
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-07-27 04:08:52.637411,epoch time: 0:02:25.463651,used: 0:07:20.040022,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_04_01_32_seed_0_23093153
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9583333, 'precision': 0.9610245, 'recall': 0.9588083, 'specificity': 0.9588083, 'f1': 0.95829755, 'auroc': 0.9985384, 'binary_precision': 0.9992997, 'binary_recall': 0.9182754, 'binary_specificity': 0.99934125, 'binary_f1_score': 0.9570758}
confusion matrix:
      0     1
0  1517     1
1   127  1427
---- Validation: 
scalar performance:
{'acc': 0.65993786, 'precision': 0.74804735, 'recall': 0.65570414, 'specificity': 0.65570414, 'f1': 0.6232359, 'auroc': 0.8782023, 'binary_precision': 0.8924303, 'binary_recall': 0.3527559, 'binary_specificity': 0.9586524, 'binary_f1_score': 0.50564337}
confusion matrix:
     0    1
0  626   27
1  411  224
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8465116, 'precision': 0.8779406, 'recall': 0.8465116, 'specificity': 0.8465116, 'f1': 0.84325296, 'auroc': 0.9256679, 'binary_precision': 0.9869281, 'binary_recall': 0.7023256, 'binary_specificity': 0.9906977, 'binary_f1_score': 0.8206522}
confusion matrix:
     0    1
0  213    2
1   64  151
early stop counter: 1
val acc:0.659937858581543, best validation acc: 0.8012422323226929, corresponding to test acc:                         0.8627907037734985 / 0.8627907037734985
after epoch: 4,now: 2024-07-27 04:11:18.518445,epoch time: 0:02:25.881034,used: 0:09:45.921056,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_04_01_32_seed_0_23093153
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9814453, 'precision': 0.98141986, 'recall': 0.9815022, 'specificity': 0.9815022, 'f1': 0.9814434, 'auroc': 0.99861455, 'binary_precision': 0.9857605, 'binary_recall': 0.9775353, 'binary_specificity': 0.985469, 'binary_f1_score': 0.9816307}
confusion matrix:
      0     1
0  1492    22
1    35  1523
---- Validation: 
scalar performance:
{'acc': 0.871118, 'precision': 0.87380993, 'recall': 0.87052846, 'specificity': 0.87052846, 'f1': 0.87073624, 'auroc': 0.9315382, 'binary_precision': 0.90222985, 'binary_recall': 0.82834643, 'binary_specificity': 0.91271055, 'binary_f1_score': 0.863711}
confusion matrix:
     0    1
0  596   57
1  109  526
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8581395, 'precision': 0.885215, 'recall': 0.8581395, 'specificity': 0.8581395, 'f1': 0.85560226, 'auroc': 0.9289778, 'binary_precision': 0.98734176, 'binary_recall': 0.7255814, 'binary_specificity': 0.9906977, 'binary_f1_score': 0.8364611}
confusion matrix:
     0    1
0  213    2
1   59  156
better model found
persisted
after epoch: 5,now: 2024-07-27 04:13:43.561681,epoch time: 0:02:25.043236,used: 0:12:10.964292,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_04_01_32_seed_0_23093153
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9876302, 'precision': 0.987689, 'recall': 0.98773533, 'specificity': 0.98773533, 'f1': 0.9876301, 'auroc': 0.9993391, 'binary_precision': 0.9967235, 'binary_recall': 0.9787645, 'binary_specificity': 0.9967062, 'binary_f1_score': 0.9876623}
confusion matrix:
      0     1
0  1513     5
1    33  1521
---- Validation: 
scalar performance:
{'acc': 0.742236, 'precision': 0.7935368, 'recall': 0.73927724, 'specificity': 0.73927724, 'f1': 0.72886753, 'auroc': 0.8967793, 'binary_precision': 0.9128065, 'binary_recall': 0.52755904, 'binary_specificity': 0.9509954, 'binary_f1_score': 0.66866267}
confusion matrix:
     0    1
0  621   32
1  300  335
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6883721, 'precision': 0.7969309, 'recall': 0.6883721, 'specificity': 0.6883721, 'f1': 0.6570238, 'auroc': 0.9322877, 'binary_precision': 0.9764706, 'binary_recall': 0.3860465, 'binary_specificity': 0.9906977, 'binary_f1_score': 0.5533333}
confusion matrix:
     0   1
0  213   2
1  132  83
early stop counter: 1
val acc:0.7422360181808472, best validation acc: 0.8711180090904236, corresponding to test acc:                         0.8581395149230957 / 0.8627907037734985
after epoch: 6,now: 2024-07-27 04:16:08.519779,epoch time: 0:02:24.958098,used: 0:14:35.922390,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_04_01_32_seed_0_23093153
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.984375, 'precision': 0.98439527, 'recall': 0.98447406, 'specificity': 0.98447406, 'f1': 0.9843745, 'auroc': 0.9993844, 'binary_precision': 0.9921671, 'binary_recall': 0.97686374, 'binary_specificity': 0.99208444, 'binary_f1_score': 0.98445594}
confusion matrix:
      0     1
0  1504    12
1    36  1520
---- Validation: 
scalar performance:
{'acc': 0.71040374, 'precision': 0.7945962, 'recall': 0.70662475, 'specificity': 0.70662475, 'f1': 0.6857145, 'auroc': 0.92691517, 'binary_precision': 0.94863015, 'binary_recall': 0.43622047, 'binary_specificity': 0.9770291, 'binary_f1_score': 0.59762675}
confusion matrix:
     0    1
0  638   15
1  358  277
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6511628, 'precision': 0.78730315, 'recall': 0.65116274, 'specificity': 0.65116274, 'f1': 0.60428476, 'auroc': 0.926582, 'binary_precision': 0.98507464, 'binary_recall': 0.30697674, 'binary_specificity': 0.9953488, 'binary_f1_score': 0.4680851}
confusion matrix:
     0   1
0  214   1
1  149  66
early stop counter: 2
val acc:0.7104037404060364, best validation acc: 0.8711180090904236, corresponding to test acc:                         0.8581395149230957 / 0.8627907037734985
after epoch: 7,now: 2024-07-27 04:18:33.676442,epoch time: 0:02:25.156663,used: 0:17:01.079053,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_04_01_32_seed_0_23093153
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.95996094, 'precision': 0.96236575, 'recall': 0.9604921, 'specificity': 0.9604921, 'f1': 0.9599345, 'auroc': 0.9987507, 'binary_precision': 0.99930364, 'binary_recall': 0.9216442, 'binary_specificity': 0.99933994, 'binary_f1_score': 0.95890415}
confusion matrix:
      0     1
0  1514     1
1   122  1435
---- Validation: 
scalar performance:
{'acc': 0.60947204, 'precision': 0.7558677, 'recall': 0.60411066, 'specificity': 0.60411066, 'f1': 0.5385318, 'auroc': 0.9103447, 'binary_precision': 0.9459459, 'binary_recall': 0.22047244, 'binary_specificity': 0.98774886, 'binary_f1_score': 0.357599}
confusion matrix:
     0    1
0  645    8
1  495  140
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7139535, 'precision': 0.81804734, 'recall': 0.7139535, 'specificity': 0.7139535, 'f1': 0.68846273, 'auroc': 0.9462412, 'binary_precision': 1.0, 'binary_recall': 0.427907, 'binary_specificity': 1.0, 'binary_f1_score': 0.59934855}
confusion matrix:
     0   1
0  215   0
1  123  92
early stop counter: 3
val acc:0.6094720363616943, best validation acc: 0.8711180090904236, corresponding to test acc:                         0.8581395149230957 / 0.8627907037734985
after epoch: 8,now: 2024-07-27 04:20:59.364900,epoch time: 0:02:25.688458,used: 0:19:26.767511,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_04_01_32_seed_0_23093153
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9902344, 'precision': 0.990239, 'recall': 0.99033046, 'specificity': 0.99033046, 'f1': 0.9902339, 'auroc': 0.99967146, 'binary_precision': 0.99739414, 'binary_recall': 0.9833012, 'binary_specificity': 0.99735975, 'binary_f1_score': 0.99029756}
confusion matrix:
      0     1
0  1511     4
1    26  1531
---- Validation: 
scalar performance:
{'acc': 0.77251554, 'precision': 0.80799377, 'recall': 0.7701161, 'specificity': 0.7701161, 'f1': 0.764682, 'auroc': 0.9077172, 'binary_precision': 0.90909094, 'binary_recall': 0.5984252, 'binary_specificity': 0.94180703, 'binary_f1_score': 0.7217474}
confusion matrix:
     0    1
0  615   38
1  255  380
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9162791, 'precision': 0.9171816, 'recall': 0.9162791, 'specificity': 0.9162791, 'f1': 0.9162338, 'auroc': 0.9563873, 'binary_precision': 0.93658537, 'binary_recall': 0.89302325, 'binary_specificity': 0.9395349, 'binary_f1_score': 0.9142857}
confusion matrix:
     0    1
0  202   13
1   23  192
new oracle model saved
early stop counter: 4
val acc:0.7725155353546143, best validation acc: 0.8711180090904236, corresponding to test acc:                         0.8581395149230957 / 0.9162790775299072
after epoch: 9,now: 2024-07-27 04:23:24.665890,epoch time: 0:02:25.300990,used: 0:21:52.068501,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_04_01_32_seed_0_23093153
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.99153644, 'precision': 0.9915987, 'recall': 0.99149036, 'specificity': 0.99149036, 'f1': 0.991534, 'auroc': 0.99978805, 'binary_precision': 0.9885131, 'binary_recall': 0.9948619, 'binary_specificity': 0.9881188, 'binary_f1_score': 0.9916773}
confusion matrix:
      0     1
0  1497    18
1     8  1549
---- Validation: 
scalar performance:
{'acc': 0.8291925, 'precision': 0.8380304, 'recall': 0.8280522, 'specificity': 0.8280522, 'f1': 0.8276969, 'auroc': 0.90822005, 'binary_precision': 0.88930583, 'binary_recall': 0.7464567, 'binary_specificity': 0.90964776, 'binary_f1_score': 0.81164384}
confusion matrix:
     0    1
0  594   59
1  161  474
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.88837206, 'precision': 0.9037808, 'recall': 0.88837206, 'specificity': 0.88837206, 'f1': 0.88729686, 'auroc': 0.9474094, 'binary_precision': 0.982659, 'binary_recall': 0.7906977, 'binary_specificity': 0.9860465, 'binary_f1_score': 0.87628865}
confusion matrix:
     0    1
0  212    3
1   45  170
early stop counter: 5
val acc:0.8291925191879272, best validation acc: 0.8711180090904236, corresponding to test acc:                         0.8581395149230957 / 0.9162790775299072
after epoch: 10,now: 2024-07-27 04:25:49.886504,epoch time: 0:02:25.220614,used: 0:24:17.289115,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_04_01_32_seed_0_23093153
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 10 with time: 0:24:17.289115 at 2024-07-27 04:25:49.886504
persisted model performance metric: 

scalar performance:
{'acc': 0.8581395, 'precision': 0.885215, 'recall': 0.8581395, 'specificity': 0.8581395, 'f1': 0.85560226, 'auroc': 0.9289778, 'binary_precision': 0.98734176, 'binary_recall': 0.7255814, 'binary_specificity': 0.9906977, 'binary_f1_score': 0.8364611}
confusion matrix:
     0    1
0  213    2
1   59  156
oracle model performance metric: 

scalar performance:
{'acc': 0.9162791, 'precision': 0.9171816, 'recall': 0.9162791, 'specificity': 0.9162791, 'f1': 0.9162338, 'auroc': 0.9563873, 'binary_precision': 0.93658537, 'binary_recall': 0.89302325, 'binary_specificity': 0.9395349, 'binary_f1_score': 0.9142857}
confusion matrix:
     0    1
0  202   13
1   23  192
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_dial_3seeds_nofreeze_2024-07-27_01-29-56/rule_results/1.csv
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_dial_3seeds_nofreeze_2024-07-27_01-29-56/rule_results/1.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_dial_3seeds_nofreeze_2024-07-27_01-29-56/confusion_matrix/1.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 455874 KiB |   6793 MiB |  64290 GiB |  64289 GiB |
|       from large pool | 415281 KiB |   6758 MiB |  63601 GiB |  63601 GiB |
|       from small pool |  40592 KiB |     56 MiB |    688 GiB |    688 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 455874 KiB |   6793 MiB |  64290 GiB |  64289 GiB |
|       from large pool | 415281 KiB |   6758 MiB |  63601 GiB |  63601 GiB |
|       from small pool |  40592 KiB |     56 MiB |    688 GiB |    688 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 447480 KiB |   6787 MiB |  64213 GiB |  64213 GiB |
|       from large pool | 407075 KiB |   6753 MiB |  63525 GiB |  63525 GiB |
|       from small pool |  40405 KiB |     56 MiB |    687 GiB |    687 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   7958 MiB |   7958 MiB |   7958 MiB |      0 B   |
|       from large pool |   7894 MiB |   7894 MiB |   7894 MiB |      0 B   |
|       from small pool |     64 MiB |     64 MiB |     64 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory | 359230 KiB |   1135 MiB |  84305 GiB |  84304 GiB |
|       from large pool | 350670 KiB |   1126 MiB |  83606 GiB |  83605 GiB |
|       from small pool |   8559 KiB |     13 MiB |    698 GiB |    698 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    1298    |    1698    |    9249 K  |    9247 K  |
|       from large pool |     187    |     783    |    5637 K  |    5637 K  |
|       from small pool |    1111    |    1407    |    3611 K  |    3610 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    1298    |    1698    |    9249 K  |    9247 K  |
|       from large pool |     187    |     783    |    5637 K  |    5637 K  |
|       from small pool |    1111    |    1407    |    3611 K  |    3610 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     321    |     321    |     321    |       0    |
|       from large pool |     289    |     289    |     289    |       0    |
|       from small pool |      32    |      32    |      32    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      78    |     340    |    5287 K  |    5287 K  |
|       from large pool |      33    |     290    |    3681 K  |    3681 K  |
|       from small pool |      45    |     219    |    1606 K  |    1606 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   6793 MiB |  64290 GiB |  64290 GiB |
|       from large pool |  16640 KiB |   6758 MiB |  63601 GiB |  63601 GiB |
|       from small pool |      0 KiB |     56 MiB |    688 GiB |    688 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   6793 MiB |  64290 GiB |  64290 GiB |
|       from large pool |  16640 KiB |   6758 MiB |  63601 GiB |  63601 GiB |
|       from small pool |      0 KiB |     56 MiB |    688 GiB |    688 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   6787 MiB |  64213 GiB |  64213 GiB |
|       from large pool |  16640 KiB |   6753 MiB |  63525 GiB |  63525 GiB |
|       from small pool |      0 KiB |     56 MiB |    687 GiB |    687 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    796 MiB |   7958 MiB |   7958 MiB |   7162 MiB |
|       from large pool |    748 MiB |   7894 MiB |   7894 MiB |   7146 MiB |
|       from small pool |     48 MiB |     64 MiB |     64 MiB |     16 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1135 MiB |  84305 GiB |  84305 GiB |
|       from large pool |  24320 KiB |   1126 MiB |  83606 GiB |  83606 GiB |
|       from small pool |      0 KiB |     28 MiB |    698 GiB |    698 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    1698    |    9249 K  |    9249 K  |
|       from large pool |       2    |     783    |    5637 K  |    5637 K  |
|       from small pool |       0    |    1407    |    3611 K  |    3611 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    1698    |    9249 K  |    9249 K  |
|       from large pool |       2    |     783    |    5637 K  |    5637 K  |
|       from small pool |       0    |    1407    |    3611 K  |    3611 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      59    |     321    |     321    |     262    |
|       from large pool |      35    |     289    |     289    |     254    |
|       from small pool |      24    |      32    |      32    |       8    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |     340    |    5288 K  |    5288 K  |
|       from large pool |       4    |     290    |    3681 K  |    3681 K  |
|       from small pool |       0    |     219    |    1607 K  |    1607 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   6793 MiB |  64290 GiB |  64290 GiB |
|       from large pool |  16640 KiB |   6758 MiB |  63601 GiB |  63601 GiB |
|       from small pool |      0 KiB |     56 MiB |    688 GiB |    688 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   6793 MiB |  64290 GiB |  64290 GiB |
|       from large pool |  16640 KiB |   6758 MiB |  63601 GiB |  63601 GiB |
|       from small pool |      0 KiB |     56 MiB |    688 GiB |    688 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   6787 MiB |  64213 GiB |  64213 GiB |
|       from large pool |  16640 KiB |   6753 MiB |  63525 GiB |  63525 GiB |
|       from small pool |      0 KiB |     56 MiB |    687 GiB |    687 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    796 MiB |   7958 MiB |   7958 MiB |   7162 MiB |
|       from large pool |    748 MiB |   7894 MiB |   7894 MiB |   7146 MiB |
|       from small pool |     48 MiB |     64 MiB |     64 MiB |     16 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1135 MiB |  84305 GiB |  84305 GiB |
|       from large pool |  24320 KiB |   1126 MiB |  83606 GiB |  83606 GiB |
|       from small pool |      0 KiB |     28 MiB |    698 GiB |    698 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    1698    |    9249 K  |    9249 K  |
|       from large pool |       2    |     783    |    5637 K  |    5637 K  |
|       from small pool |       0    |    1407    |    3611 K  |    3611 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    1698    |    9249 K  |    9249 K  |
|       from large pool |       2    |     783    |    5637 K  |    5637 K  |
|       from small pool |       0    |    1407    |    3611 K  |    3611 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      59    |     321    |     321    |     262    |
|       from large pool |      35    |     289    |     289    |     254    |
|       from small pool |      24    |      32    |      32    |       8    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |     340    |    5288 K  |    5288 K  |
|       from large pool |       4    |     290    |    3681 K  |    3681 K  |
|       from small pool |       0    |     219    |    1607 K  |    1607 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_04_26_22_seed_1_23093153

 Experiment start at: 2024-07-27 04:26:22.353202
before training, model accuracy: 0.6177777647972107
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.92903644, 'precision': 0.9369134, 'recall': 0.92818505, 'specificity': 0.92818505, 'f1': 0.92860794, 'auroc': 0.9954907, 'binary_precision': 0.88141394, 'binary_recall': 0.99357325, 'binary_specificity': 0.86279684, 'binary_f1_score': 0.934139}
confusion matrix:
      0     1
0  1308   208
1    10  1546
---- Validation: 
scalar performance:
{'acc': 0.7423888, 'precision': 0.7903789, 'recall': 0.7456733, 'specificity': 0.7456733, 'f1': 0.7329362, 'auroc': 0.91202784, 'binary_precision': 0.66816145, 'binary_recall': 0.94603175, 'binary_specificity': 0.5453149, 'binary_f1_score': 0.78318006}
confusion matrix:
     0    1
0  355  296
1   34  596
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7266667, 'precision': 0.78977275, 'recall': 0.7266667, 'specificity': 0.7266667, 'f1': 0.7109283, 'auroc': 0.9305482, 'binary_precision': 0.6545454, 'binary_recall': 0.96, 'binary_specificity': 0.49333334, 'binary_f1_score': 0.7783784}
confusion matrix:
     0    1
0  111  114
1    9  216
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-27 04:28:50.574245,epoch time: 0:02:28.221043,used: 0:02:28.221043,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_04_26_22_seed_1_23093153
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9736328, 'precision': 0.97372556, 'recall': 0.97357196, 'specificity': 0.97357196, 'f1': 0.97362554, 'auroc': 0.9977405, 'binary_precision': 0.96940726, 'binary_recall': 0.9787645, 'binary_specificity': 0.96837944, 'binary_f1_score': 0.9740634}
confusion matrix:
      0     1
0  1470    48
1    33  1521
---- Validation: 
scalar performance:
{'acc': 0.85323966, 'precision': 0.86634046, 'recall': 0.8516897, 'specificity': 0.8516897, 'f1': 0.8514911, 'auroc': 0.91879404, 'binary_precision': 0.9316406, 'binary_recall': 0.75714284, 'binary_specificity': 0.94623655, 'binary_f1_score': 0.83537656}
confusion matrix:
     0    1
0  616   35
1  153  477
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8666667, 'precision': 0.87743235, 'recall': 0.8666667, 'specificity': 0.8666667, 'f1': 0.86570907, 'auroc': 0.920158, 'binary_precision': 0.9411765, 'binary_recall': 0.7822222, 'binary_specificity': 0.95111114, 'binary_f1_score': 0.8543689}
confusion matrix:
     0    1
0  214   11
1   49  176
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-07-27 04:31:15.930494,epoch time: 0:02:25.356249,used: 0:04:53.577292,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_04_26_22_seed_1_23093153
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9847005, 'precision': 0.98471993, 'recall': 0.9847908, 'specificity': 0.9847908, 'f1': 0.9847002, 'auroc': 0.9990351, 'binary_precision': 0.9921671, 'binary_recall': 0.977492, 'binary_specificity': 0.9920896, 'binary_f1_score': 0.9847749}
confusion matrix:
      0     1
0  1505    12
1    35  1520
---- Validation: 
scalar performance:
{'acc': 0.74629194, 'precision': 0.8114443, 'recall': 0.74249876, 'specificity': 0.74249876, 'f1': 0.73029256, 'auroc': 0.9033575, 'binary_precision': 0.9498525, 'binary_recall': 0.51111114, 'binary_specificity': 0.9738863, 'binary_f1_score': 0.6646027}
confusion matrix:
     0    1
0  634   17
1  308  322
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.84444445, 'precision': 0.8727475, 'recall': 0.8444444, 'specificity': 0.8444444, 'f1': 0.8414345, 'auroc': 0.9135802, 'binary_precision': 0.9754601, 'binary_recall': 0.70666665, 'binary_specificity': 0.9822222, 'binary_f1_score': 0.81958765}
confusion matrix:
     0    1
0  221    4
1   66  159
early stop counter: 1
val acc:0.7462919354438782, best validation acc: 0.8532396554946899, corresponding to test acc:                         0.8666666746139526 / 0.8666666746139526
after epoch: 3,now: 2024-07-27 04:33:41.790950,epoch time: 0:02:25.860456,used: 0:07:19.437748,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_04_26_22_seed_1_23093153
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.97233075, 'precision': 0.9734103, 'recall': 0.9726608, 'specificity': 0.9726608, 'f1': 0.97232485, 'auroc': 0.9987998, 'binary_precision': 0.9993206, 'binary_recall': 0.9459807, 'binary_specificity': 0.99934083, 'binary_f1_score': 0.9719194}
confusion matrix:
      0     1
0  1516     1
1    84  1471
---- Validation: 
scalar performance:
{'acc': 0.65495706, 'precision': 0.78333485, 'recall': 0.64935994, 'specificity': 0.64935994, 'f1': 0.6061368, 'auroc': 0.91605103, 'binary_precision': 0.97, 'binary_recall': 0.30793652, 'binary_specificity': 0.9907834, 'binary_f1_score': 0.46746987}
confusion matrix:
     0    1
0  645    6
1  436  194
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5466667, 'precision': 0.7622378, 'recall': 0.5466667, 'specificity': 0.5466667, 'f1': 0.42940253, 'auroc': 0.9156099, 'binary_precision': 1.0, 'binary_recall': 0.093333334, 'binary_specificity': 1.0, 'binary_f1_score': 0.17073171}
confusion matrix:
     0   1
0  225   0
1  204  21
early stop counter: 2
val acc:0.6549570560455322, best validation acc: 0.8532396554946899, corresponding to test acc:                         0.8666666746139526 / 0.8666666746139526
after epoch: 4,now: 2024-07-27 04:36:08.022475,epoch time: 0:02:26.231525,used: 0:09:45.669273,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_04_26_22_seed_1_23093153
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9840495, 'precision': 0.98439527, 'recall': 0.98391414, 'specificity': 0.98391414, 'f1': 0.984041, 'auroc': 0.99939376, 'binary_precision': 0.97418135, 'binary_recall': 0.9948553, 'binary_specificity': 0.972973, 'binary_f1_score': 0.98440987}
confusion matrix:
      0     1
0  1476    41
1     8  1547
---- Validation: 
scalar performance:
{'acc': 0.84074944, 'precision': 0.857582, 'recall': 0.8389657, 'specificity': 0.8389657, 'f1': 0.83832085, 'auroc': 0.9219272, 'binary_precision': 0.9311741, 'binary_recall': 0.73015875, 'binary_specificity': 0.9477727, 'binary_f1_score': 0.8185054}
confusion matrix:
     0    1
0  617   34
1  170  460
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8066667, 'precision': 0.85771894, 'recall': 0.8066667, 'specificity': 0.8066667, 'f1': 0.7995135, 'auroc': 0.9340444, 'binary_precision': 0.99285716, 'binary_recall': 0.61777776, 'binary_specificity': 0.9955556, 'binary_f1_score': 0.7616438}
confusion matrix:
     0    1
0  224    1
1   86  139
early stop counter: 3
val acc:0.8407494425773621, best validation acc: 0.8532396554946899, corresponding to test acc:                         0.8666666746139526 / 0.8666666746139526
after epoch: 5,now: 2024-07-27 04:38:33.302709,epoch time: 0:02:25.280234,used: 0:12:10.949507,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_04_26_22_seed_1_23093153
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.98860675, 'precision': 0.98859715, 'recall': 0.9886624, 'specificity': 0.9886624, 'f1': 0.9886062, 'auroc': 0.9996443, 'binary_precision': 0.99350226, 'binary_recall': 0.98391247, 'binary_specificity': 0.9934124, 'binary_f1_score': 0.9886841}
confusion matrix:
      0     1
0  1508    10
1    25  1529
---- Validation: 
scalar performance:
{'acc': 0.8649493, 'precision': 0.87074876, 'recall': 0.86392725, 'specificity': 0.86392725, 'f1': 0.8641542, 'auroc': 0.9179529, 'binary_precision': 0.91320074, 'binary_recall': 0.8015873, 'binary_specificity': 0.92626727, 'binary_f1_score': 0.8537617}
confusion matrix:
     0    1
0  603   48
1  125  505
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8511111, 'precision': 0.853127, 'recall': 0.8511111, 'specificity': 0.8511111, 'f1': 0.8508984, 'auroc': 0.90791106, 'binary_precision': 0.8798077, 'binary_recall': 0.81333333, 'binary_specificity': 0.8888889, 'binary_f1_score': 0.8452656}
confusion matrix:
     0    1
0  200   25
1   42  183
better model found
persisted
after epoch: 6,now: 2024-07-27 04:40:58.318532,epoch time: 0:02:25.015823,used: 0:14:35.965330,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_04_26_22_seed_1_23093153
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.98079425, 'precision': 0.9807803, 'recall': 0.9808413, 'specificity': 0.9808413, 'f1': 0.98079324, 'auroc': 0.9990318, 'binary_precision': 0.98507464, 'binary_recall': 0.976834, 'binary_specificity': 0.9848485, 'binary_f1_score': 0.98093706}
confusion matrix:
      0     1
0  1495    23
1    36  1518
---- Validation: 
scalar performance:
{'acc': 0.8540203, 'precision': 0.8669286, 'recall': 0.8524834, 'specificity': 0.8524834, 'f1': 0.85230625, 'auroc': 0.93616176, 'binary_precision': 0.9317739, 'binary_recall': 0.7587302, 'binary_specificity': 0.94623655, 'binary_f1_score': 0.83639544}
confusion matrix:
     0    1
0  616   35
1  152  478
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8422222, 'precision': 0.8623264, 'recall': 0.8422222, 'specificity': 0.8422222, 'f1': 0.8400028, 'auroc': 0.92784196, 'binary_precision': 0.9476744, 'binary_recall': 0.72444445, 'binary_specificity': 0.96, 'binary_f1_score': 0.82115865}
confusion matrix:
     0    1
0  216    9
1   62  163
early stop counter: 1
val acc:0.8540202975273132, best validation acc: 0.8649492859840393, corresponding to test acc:                         0.851111114025116 / 0.8666666746139526
after epoch: 7,now: 2024-07-27 04:43:23.043400,epoch time: 0:02:24.724868,used: 0:17:00.690198,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_04_26_22_seed_1_23093153
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.98860675, 'precision': 0.98861206, 'recall': 0.98873115, 'specificity': 0.98873115, 'f1': 0.98860615, 'auroc': 0.9993259, 'binary_precision': 0.99674267, 'binary_recall': 0.9807692, 'binary_specificity': 0.99669313, 'binary_f1_score': 0.98869145}
confusion matrix:
      0     1
0  1507     5
1    30  1530
---- Validation: 
scalar performance:
{'acc': 0.74629194, 'precision': 0.8007903, 'recall': 0.74275476, 'specificity': 0.74275476, 'f1': 0.7323868, 'auroc': 0.89369226, 'binary_precision': 0.9247911, 'binary_recall': 0.52698416, 'binary_specificity': 0.95852536, 'binary_f1_score': 0.6713852}
confusion matrix:
     0    1
0  624   27
1  298  332
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7088889, 'precision': 0.81601125, 'recall': 0.7088889, 'specificity': 0.7088889, 'f1': 0.68193424, 'auroc': 0.9323852, 'binary_precision': 1.0, 'binary_recall': 0.41777778, 'binary_specificity': 1.0, 'binary_f1_score': 0.5893417}
confusion matrix:
     0   1
0  225   0
1  131  94
early stop counter: 2
val acc:0.7462919354438782, best validation acc: 0.8649492859840393, corresponding to test acc:                         0.851111114025116 / 0.8666666746139526
after epoch: 8,now: 2024-07-27 04:45:47.405639,epoch time: 0:02:24.362239,used: 0:19:25.052437,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_04_26_22_seed_1_23093153
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9899089, 'precision': 0.9899113, 'recall': 0.989904, 'specificity': 0.989904, 'f1': 0.9899075, 'auroc': 0.9996172, 'binary_precision': 0.989704, 'binary_recall': 0.99034125, 'binary_specificity': 0.9894667, 'binary_f1_score': 0.9900225}
confusion matrix:
      0     1
0  1503    16
1    15  1538
---- Validation: 
scalar performance:
{'acc': 0.8555816, 'precision': 0.86767066, 'recall': 0.8540963, 'specificity': 0.8540963, 'f1': 0.8539839, 'auroc': 0.9280131, 'binary_precision': 0.9303675, 'binary_recall': 0.76349205, 'binary_specificity': 0.9447005, 'binary_f1_score': 0.8387097}
confusion matrix:
     0    1
0  615   36
1  149  481
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8466667, 'precision': 0.86869746, 'recall': 0.8466667, 'specificity': 0.8466667, 'f1': 0.84434134, 'auroc': 0.9184593, 'binary_precision': 0.9588235, 'binary_recall': 0.72444445, 'binary_specificity': 0.9688889, 'binary_f1_score': 0.8253164}
confusion matrix:
     0    1
0  218    7
1   62  163
early stop counter: 3
val acc:0.8555815815925598, best validation acc: 0.8649492859840393, corresponding to test acc:                         0.851111114025116 / 0.8666666746139526
after epoch: 9,now: 2024-07-27 04:48:12.193840,epoch time: 0:02:24.788201,used: 0:21:49.840638,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_04_26_22_seed_1_23093153
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.98795575, 'precision': 0.9880551, 'recall': 0.9878968, 'specificity': 0.9878968, 'f1': 0.9879524, 'auroc': 0.99940646, 'binary_precision': 0.98342896, 'binary_recall': 0.9929215, 'binary_specificity': 0.9828722, 'binary_f1_score': 0.98815244}
confusion matrix:
      0     1
0  1492    26
1    11  1543
---- Validation: 
scalar performance:
{'acc': 0.774395, 'precision': 0.7969268, 'recall': 0.77209425, 'specificity': 0.77209425, 'f1': 0.7689868, 'auroc': 0.88778865, 'binary_precision': 0.8747253, 'binary_recall': 0.63174605, 'binary_specificity': 0.9124424, 'binary_f1_score': 0.73364055}
confusion matrix:
     0    1
0  594   57
1  232  398
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.85555553, 'precision': 0.8633721, 'recall': 0.85555553, 'specificity': 0.85555553, 'f1': 0.8547746, 'auroc': 0.9062518, 'binary_precision': 0.9166667, 'binary_recall': 0.7822222, 'binary_specificity': 0.9288889, 'binary_f1_score': 0.8441247}
confusion matrix:
     0    1
0  209   16
1   49  176
early stop counter: 4
val acc:0.7743949890136719, best validation acc: 0.8649492859840393, corresponding to test acc:                         0.851111114025116 / 0.8666666746139526
after epoch: 10,now: 2024-07-27 04:50:36.465283,epoch time: 0:02:24.271443,used: 0:24:14.112081,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_04_26_22_seed_1_23093153
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.99153644, 'precision': 0.99152195, 'recall': 0.991552, 'specificity': 0.991552, 'f1': 0.9915353, 'auroc': 0.99970585, 'binary_precision': 0.99291235, 'binary_recall': 0.9903599, 'binary_specificity': 0.9927441, 'binary_f1_score': 0.9916344}
confusion matrix:
      0     1
0  1505    11
1    15  1541
---- Validation: 
scalar performance:
{'acc': 0.80249804, 'precision': 0.836481, 'recall': 0.799872, 'specificity': 0.799872, 'f1': 0.79638267, 'auroc': 0.9275553, 'binary_precision': 0.93939394, 'binary_recall': 0.63968253, 'binary_specificity': 0.96006143, 'binary_f1_score': 0.76109535}
confusion matrix:
     0    1
0  625   26
1  227  403
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8755556, 'precision': 0.889114, 'recall': 0.8755555, 'specificity': 0.8755555, 'f1': 0.874462, 'auroc': 0.9293037, 'binary_precision': 0.96174866, 'binary_recall': 0.7822222, 'binary_specificity': 0.9688889, 'binary_f1_score': 0.8627451}
confusion matrix:
     0    1
0  218    7
1   49  176
new oracle model saved
early stop counter: 5
val acc:0.8024980425834656, best validation acc: 0.8649492859840393, corresponding to test acc:                         0.851111114025116 / 0.8755555748939514
after epoch: 11,now: 2024-07-27 04:53:00.241119,epoch time: 0:02:23.775836,used: 0:26:37.887917,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_04_26_22_seed_1_23093153
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 11 with time: 0:26:37.887917 at 2024-07-27 04:53:00.241119
persisted model performance metric: 

scalar performance:
{'acc': 0.8511111, 'precision': 0.853127, 'recall': 0.8511111, 'specificity': 0.8511111, 'f1': 0.8508984, 'auroc': 0.90791106, 'binary_precision': 0.8798077, 'binary_recall': 0.81333333, 'binary_specificity': 0.8888889, 'binary_f1_score': 0.8452656}
confusion matrix:
     0    1
0  200   25
1   42  183
oracle model performance metric: 

scalar performance:
{'acc': 0.8755556, 'precision': 0.889114, 'recall': 0.8755555, 'specificity': 0.8755555, 'f1': 0.874462, 'auroc': 0.9293037, 'binary_precision': 0.96174866, 'binary_recall': 0.7822222, 'binary_specificity': 0.9688889, 'binary_f1_score': 0.8627451}
confusion matrix:
     0    1
0  218    7
1   49  176
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_dial_3seeds_nofreeze_2024-07-27_01-29-56/rule_results/1.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_dial_3seeds_nofreeze_2024-07-27_01-29-56/confusion_matrix/1.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 456522 KiB |   6793 MiB | 135031 GiB | 135031 GiB |
|       from large pool | 415924 KiB |   6758 MiB | 133582 GiB | 133581 GiB |
|       from small pool |  40598 KiB |     60 MiB |   1449 GiB |   1449 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 456522 KiB |   6793 MiB | 135031 GiB | 135031 GiB |
|       from large pool | 415924 KiB |   6758 MiB | 133582 GiB | 133581 GiB |
|       from small pool |  40598 KiB |     60 MiB |   1449 GiB |   1449 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 447481 KiB |   6787 MiB | 134858 GiB | 134858 GiB |
|       from large pool | 407075 KiB |   6753 MiB | 133410 GiB | 133410 GiB |
|       from small pool |  40406 KiB |     60 MiB |   1447 GiB |   1447 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   7958 MiB |   7958 MiB |  15120 MiB |   7162 MiB |
|       from large pool |   7890 MiB |   7894 MiB |  15036 MiB |   7146 MiB |
|       from small pool |     68 MiB |     68 MiB |     84 MiB |     16 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 364725 KiB |   1135 MiB | 176862 GiB | 176862 GiB |
|       from large pool | 356172 KiB |   1126 MiB | 175391 GiB | 175391 GiB |
|       from small pool |   8553 KiB |     28 MiB |   1471 GiB |   1471 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    1310    |    1702    |   19434 K  |   19433 K  |
|       from large pool |     187    |     783    |   11838 K  |   11838 K  |
|       from small pool |    1123    |    1419    |    7595 K  |    7594 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    1310    |    1702    |   19434 K  |   19433 K  |
|       from large pool |     187    |     783    |   11838 K  |   11838 K  |
|       from small pool |    1123    |    1419    |    7595 K  |    7594 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     324    |     324    |     586    |     262    |
|       from large pool |     290    |     290    |     544    |     254    |
|       from small pool |      34    |      34    |      42    |       8    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      74    |     341    |   11492 K  |   11492 K  |
|       from large pool |      35    |     294    |    8118 K  |    8118 K  |
|       from small pool |      39    |     220    |    3373 K  |    3373 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   6793 MiB | 135031 GiB | 135031 GiB |
|       from large pool |  16640 KiB |   6758 MiB | 133582 GiB | 133582 GiB |
|       from small pool |      0 KiB |     60 MiB |   1449 GiB |   1449 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   6793 MiB | 135031 GiB | 135031 GiB |
|       from large pool |  16640 KiB |   6758 MiB | 133582 GiB | 133582 GiB |
|       from small pool |      0 KiB |     60 MiB |   1449 GiB |   1449 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   6787 MiB | 134858 GiB | 134858 GiB |
|       from large pool |  16640 KiB |   6753 MiB | 133410 GiB | 133410 GiB |
|       from small pool |      0 KiB |     60 MiB |   1447 GiB |   1447 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    802 MiB |   7958 MiB |  15120 MiB |  14318 MiB |
|       from large pool |    754 MiB |   7894 MiB |  15036 MiB |  14282 MiB |
|       from small pool |     48 MiB |     68 MiB |     84 MiB |     36 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1135 MiB | 176863 GiB | 176863 GiB |
|       from large pool |  24320 KiB |   1126 MiB | 175391 GiB | 175391 GiB |
|       from small pool |      0 KiB |     30 MiB |   1471 GiB |   1471 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    1702    |   19434 K  |   19434 K  |
|       from large pool |       2    |     783    |   11838 K  |   11838 K  |
|       from small pool |       0    |    1419    |    7595 K  |    7595 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    1702    |   19434 K  |   19434 K  |
|       from large pool |       2    |     783    |   11838 K  |   11838 K  |
|       from small pool |       0    |    1419    |    7595 K  |    7595 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      59    |     324    |     586    |     527    |
|       from large pool |      35    |     290    |     544    |     509    |
|       from small pool |      24    |      34    |      42    |      18    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |     341    |   11492 K  |   11492 K  |
|       from large pool |       4    |     294    |    8118 K  |    8118 K  |
|       from small pool |       0    |     220    |    3374 K  |    3374 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   6793 MiB | 135031 GiB | 135031 GiB |
|       from large pool |  16640 KiB |   6758 MiB | 133582 GiB | 133582 GiB |
|       from small pool |      0 KiB |     60 MiB |   1449 GiB |   1449 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   6793 MiB | 135031 GiB | 135031 GiB |
|       from large pool |  16640 KiB |   6758 MiB | 133582 GiB | 133582 GiB |
|       from small pool |      0 KiB |     60 MiB |   1449 GiB |   1449 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   6787 MiB | 134858 GiB | 134858 GiB |
|       from large pool |  16640 KiB |   6753 MiB | 133410 GiB | 133410 GiB |
|       from small pool |      0 KiB |     60 MiB |   1447 GiB |   1447 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    802 MiB |   7958 MiB |  15120 MiB |  14318 MiB |
|       from large pool |    754 MiB |   7894 MiB |  15036 MiB |  14282 MiB |
|       from small pool |     48 MiB |     68 MiB |     84 MiB |     36 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1135 MiB | 176863 GiB | 176863 GiB |
|       from large pool |  24320 KiB |   1126 MiB | 175391 GiB | 175391 GiB |
|       from small pool |      0 KiB |     30 MiB |   1471 GiB |   1471 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    1702    |   19434 K  |   19434 K  |
|       from large pool |       2    |     783    |   11838 K  |   11838 K  |
|       from small pool |       0    |    1419    |    7595 K  |    7595 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    1702    |   19434 K  |   19434 K  |
|       from large pool |       2    |     783    |   11838 K  |   11838 K  |
|       from small pool |       0    |    1419    |    7595 K  |    7595 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      59    |     324    |     586    |     527    |
|       from large pool |      35    |     290    |     544    |     509    |
|       from small pool |      24    |      34    |      42    |      18    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |     341    |   11492 K  |   11492 K  |
|       from large pool |       4    |     294    |    8118 K  |    8118 K  |
|       from small pool |       0    |     220    |    3374 K  |    3374 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_04_53_32_seed_2_23093153

 Experiment start at: 2024-07-27 04:53:32.434178
before training, model accuracy: 0.41203704476356506
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.96629584, 'precision': 0.9664506, 'recall': 0.9662346, 'specificity': 0.9662346, 'f1': 0.96628785, 'auroc': 0.9946489, 'binary_precision': 0.9596929, 'binary_recall': 0.97402596, 'binary_specificity': 0.9584433, 'binary_f1_score': 0.9668063}
confusion matrix:
      0     1
0  1453    63
1    40  1500
---- Validation: 
scalar performance:
{'acc': 0.84741783, 'precision': 0.8473058, 'recall': 0.8474973, 'specificity': 0.8474973, 'f1': 0.8473595, 'auroc': 0.9099899, 'binary_precision': 0.83835185, 'binary_recall': 0.85048234, 'binary_specificity': 0.8445122, 'binary_f1_score': 0.8443735}
confusion matrix:
     0    1
0  554  102
1   93  529
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8518519, 'precision': 0.8519726, 'recall': 0.8518518, 'specificity': 0.8518518, 'f1': 0.8518392, 'auroc': 0.9283908, 'binary_precision': 0.8454546, 'binary_recall': 0.8611111, 'binary_specificity': 0.8425926, 'binary_f1_score': 0.85321105}
confusion matrix:
     0    1
0  182   34
1   30  186
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-27 04:55:58.014204,epoch time: 0:02:25.580026,used: 0:02:25.580026,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_04_53_32_seed_2_23093153
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.97316754, 'precision': 0.97399956, 'recall': 0.97334576, 'specificity': 0.97334576, 'f1': 0.9731614, 'auroc': 0.9975594, 'binary_precision': 0.9959184, 'binary_recall': 0.9506493, 'binary_specificity': 0.9960422, 'binary_f1_score': 0.9727574}
confusion matrix:
      0     1
0  1510     6
1    76  1464
---- Validation: 
scalar performance:
{'acc': 0.7292645, 'precision': 0.7941998, 'recall': 0.72286487, 'specificity': 0.72286487, 'f1': 0.7096713, 'auroc': 0.8687309, 'binary_precision': 0.9259259, 'binary_recall': 0.48231512, 'binary_specificity': 0.9634146, 'binary_f1_score': 0.63424945}
confusion matrix:
     0    1
0  632   24
1  322  300
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8055556, 'precision': 0.82592595, 'recall': 0.8055556, 'specificity': 0.8055556, 'f1': 0.80246913, 'auroc': 0.8897891, 'binary_precision': 0.9074074, 'binary_recall': 0.6805556, 'binary_specificity': 0.9305556, 'binary_f1_score': 0.7777778}
confusion matrix:
     0    1
0  201   15
1   69  147
early stop counter: 1
val acc:0.729264497756958, best validation acc: 0.8474178314208984, corresponding to test acc:                         0.8518518805503845 / 0.8518518805503845
after epoch: 2,now: 2024-07-27 04:58:20.630514,epoch time: 0:02:22.616310,used: 0:04:48.196336,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_04_53_32_seed_2_23093153
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9718586, 'precision': 0.97194517, 'recall': 0.9718158, 'specificity': 0.9718158, 'f1': 0.97185385, 'auroc': 0.9962722, 'binary_precision': 0.96722364, 'binary_recall': 0.97727275, 'binary_specificity': 0.96635884, 'binary_f1_score': 0.97222227}
confusion matrix:
      0     1
0  1465    51
1    35  1505
---- Validation: 
scalar performance:
{'acc': 0.7699531, 'precision': 0.79885375, 'recall': 0.77399814, 'specificity': 0.77399814, 'f1': 0.7659078, 'auroc': 0.9091395, 'binary_precision': 0.69902915, 'binary_recall': 0.926045, 'binary_specificity': 0.6219512, 'binary_f1_score': 0.7966805}
confusion matrix:
     0    1
0  408  248
1   46  576
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7847222, 'precision': 0.7976407, 'recall': 0.7847222, 'specificity': 0.7847222, 'f1': 0.7823607, 'auroc': 0.8828232, 'binary_precision': 0.7356322, 'binary_recall': 0.8888889, 'binary_specificity': 0.6805556, 'binary_f1_score': 0.8050315}
confusion matrix:
     0    1
0  147   69
1   24  192
early stop counter: 2
val acc:0.7699530720710754, best validation acc: 0.8474178314208984, corresponding to test acc:                         0.8518518805503845 / 0.8518518805503845
after epoch: 3,now: 2024-07-27 05:00:43.443408,epoch time: 0:02:22.812894,used: 0:07:11.009230,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_04_53_32_seed_2_23093153
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.97840315, 'precision': 0.9789554, 'recall': 0.9785509, 'specificity': 0.9785509, 'f1': 0.97840047, 'auroc': 0.9983213, 'binary_precision': 0.9973009, 'binary_recall': 0.9597403, 'binary_specificity': 0.9973615, 'binary_f1_score': 0.97816014}
confusion matrix:
      0     1
0  1512     4
1    62  1478
---- Validation: 
scalar performance:
{'acc': 0.7832551, 'precision': 0.8052459, 'recall': 0.779581, 'specificity': 0.779581, 'f1': 0.77764493, 'auroc': 0.87367415, 'binary_precision': 0.8807947, 'binary_recall': 0.6414791, 'binary_specificity': 0.91768295, 'binary_f1_score': 0.7423256}
confusion matrix:
     0    1
0  602   54
1  223  399
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.724537, 'precision': 0.74689496, 'recall': 0.724537, 'specificity': 0.724537, 'f1': 0.71815634, 'auroc': 0.87677896, 'binary_precision': 0.6725979, 'binary_recall': 0.875, 'binary_specificity': 0.5740741, 'binary_f1_score': 0.7605634}
confusion matrix:
     0    1
0  124   92
1   27  189
early stop counter: 3
val acc:0.7832551002502441, best validation acc: 0.8474178314208984, corresponding to test acc:                         0.8518518805503845 / 0.8518518805503845
after epoch: 4,now: 2024-07-27 05:03:06.684021,epoch time: 0:02:23.240613,used: 0:09:34.249843,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_04_53_32_seed_2_23093153
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.99345547, 'precision': 0.9934485, 'recall': 0.99346536, 'specificity': 0.99346536, 'f1': 0.9934552, 'auroc': 0.9996792, 'binary_precision': 0.9947917, 'binary_recall': 0.99220777, 'binary_specificity': 0.99472296, 'binary_f1_score': 0.993498}
confusion matrix:
      0     1
0  1508     8
1    12  1528
---- Validation: 
scalar performance:
{'acc': 0.78716743, 'precision': 0.82894015, 'recall': 0.7823504, 'specificity': 0.7823504, 'f1': 0.778125, 'auroc': 0.88889104, 'binary_precision': 0.9396985, 'binary_recall': 0.6012862, 'binary_specificity': 0.9634146, 'binary_f1_score': 0.73333335}
confusion matrix:
     0    1
0  632   24
1  248  374
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6550926, 'precision': 0.76471555, 'recall': 0.6550926, 'specificity': 0.6550926, 'f1': 0.61526096, 'auroc': 0.85513115, 'binary_precision': 0.9350649, 'binary_recall': 0.33333334, 'binary_specificity': 0.9768519, 'binary_f1_score': 0.49146757}
confusion matrix:
     0   1
0  211   5
1  144  72
early stop counter: 4
val acc:0.7871674299240112, best validation acc: 0.8474178314208984, corresponding to test acc:                         0.8518518805503845 / 0.8518518805503845
after epoch: 5,now: 2024-07-27 05:05:30.326102,epoch time: 0:02:23.642081,used: 0:11:57.891924,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_04_53_32_seed_2_23093153
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.98232985, 'precision': 0.98244303, 'recall': 0.9824059, 'specificity': 0.9824059, 'f1': 0.9823297, 'auroc': 0.99821603, 'binary_precision': 0.992053, 'binary_recall': 0.9727273, 'binary_specificity': 0.99208444, 'binary_f1_score': 0.98229504}
confusion matrix:
      0     1
0  1504    12
1    42  1498
---- Validation: 
scalar performance:
{'acc': 0.786385, 'precision': 0.8048949, 'recall': 0.78300476, 'specificity': 0.78300476, 'f1': 0.78160864, 'auroc': 0.8643783, 'binary_precision': 0.8736617, 'binary_recall': 0.6559486, 'binary_specificity': 0.910061, 'binary_f1_score': 0.7493113}
confusion matrix:
     0    1
0  597   59
1  214  408
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5763889, 'precision': 0.72231925, 'recall': 0.5763889, 'specificity': 0.5763889, 'f1': 0.49322757, 'auroc': 0.8279964, 'binary_precision': 0.902439, 'binary_recall': 0.1712963, 'binary_specificity': 0.9814815, 'binary_f1_score': 0.28793776}
confusion matrix:
     0   1
0  212   4
1  179  37
early stop counter: 5
val acc:0.7863849997520447, best validation acc: 0.8474178314208984, corresponding to test acc:                         0.8518518805503845 / 0.8518518805503845
after epoch: 6,now: 2024-07-27 05:07:53.921671,epoch time: 0:02:23.595569,used: 0:14:21.487493,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_04_53_32_seed_2_23093153
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 6 with time: 0:14:21.487493 at 2024-07-27 05:07:53.921671
persisted model performance metric: 

scalar performance:
{'acc': 0.8518519, 'precision': 0.8519726, 'recall': 0.8518518, 'specificity': 0.8518518, 'f1': 0.8518392, 'auroc': 0.9283908, 'binary_precision': 0.8454546, 'binary_recall': 0.8611111, 'binary_specificity': 0.8425926, 'binary_f1_score': 0.85321105}
confusion matrix:
     0    1
0  182   34
1   30  186
oracle model performance metric: 

scalar performance:
{'acc': 0.8518519, 'precision': 0.8519726, 'recall': 0.8518518, 'specificity': 0.8518518, 'f1': 0.8518392, 'auroc': 0.9283908, 'binary_precision': 0.8454546, 'binary_recall': 0.8611111, 'binary_specificity': 0.8425926, 'binary_f1_score': 0.85321105}
confusion matrix:
     0    1
0  182   34
1   30  186
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_dial_3seeds_nofreeze_2024-07-27_01-29-56/rule_results/1.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_dial_3seeds_nofreeze_2024-07-27_01-29-56/confusion_matrix/1.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 458732 KiB |   6793 MiB | 173477 GiB | 173477 GiB |
|       from large pool | 418140 KiB |   6758 MiB | 171615 GiB | 171614 GiB |
|       from small pool |  40592 KiB |     60 MiB |   1862 GiB |   1862 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 458732 KiB |   6793 MiB | 173477 GiB | 173477 GiB |
|       from large pool | 418140 KiB |   6758 MiB | 171615 GiB | 171614 GiB |
|       from small pool |  40592 KiB |     60 MiB |   1862 GiB |   1862 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 447481 KiB |   6787 MiB | 173274 GiB | 173273 GiB |
|       from large pool | 407075 KiB |   6753 MiB | 171413 GiB | 171413 GiB |
|       from small pool |  40406 KiB |     60 MiB |   1860 GiB |   1860 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   7954 MiB |   7958 MiB |  22272 MiB |  14318 MiB |
|       from large pool |   7890 MiB |   7894 MiB |  22172 MiB |  14282 MiB |
|       from small pool |     64 MiB |     68 MiB |    100 MiB |     36 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 382995 KiB |   1135 MiB | 227180 GiB | 227179 GiB |
|       from large pool | 374436 KiB |   1126 MiB | 225289 GiB | 225289 GiB |
|       from small pool |   8559 KiB |     30 MiB |   1890 GiB |   1890 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    1298    |    1702    |   24972 K  |   24971 K  |
|       from large pool |     187    |     783    |   15211 K  |   15211 K  |
|       from small pool |    1111    |    1419    |    9760 K  |    9759 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    1298    |    1702    |   24972 K  |   24971 K  |
|       from large pool |     187    |     783    |   15211 K  |   15211 K  |
|       from small pool |    1111    |    1419    |    9760 K  |    9759 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     322    |     324    |     849    |     527    |
|       from large pool |     290    |     290    |     799    |     509    |
|       from small pool |      32    |      34    |      50    |      18    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      81    |     341    |   14886 K  |   14886 K  |
|       from large pool |      36    |     294    |   10541 K  |   10540 K  |
|       from small pool |      45    |     221    |    4345 K  |    4345 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   6793 MiB | 173477 GiB | 173477 GiB |
|       from large pool |  16640 KiB |   6758 MiB | 171615 GiB | 171615 GiB |
|       from small pool |      0 KiB |     60 MiB |   1862 GiB |   1862 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   6793 MiB | 173477 GiB | 173477 GiB |
|       from large pool |  16640 KiB |   6758 MiB | 171615 GiB | 171615 GiB |
|       from small pool |      0 KiB |     60 MiB |   1862 GiB |   1862 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   6787 MiB | 173274 GiB | 173274 GiB |
|       from large pool |  16640 KiB |   6753 MiB | 171413 GiB | 171413 GiB |
|       from small pool |      0 KiB |     60 MiB |   1860 GiB |   1860 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    822 MiB |   7958 MiB |  22272 MiB |  21450 MiB |
|       from large pool |    774 MiB |   7894 MiB |  22172 MiB |  21398 MiB |
|       from small pool |     48 MiB |     68 MiB |    100 MiB |     52 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1135 MiB | 227180 GiB | 227180 GiB |
|       from large pool |  24320 KiB |   1126 MiB | 225290 GiB | 225290 GiB |
|       from small pool |      0 KiB |     32 MiB |   1890 GiB |   1890 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    1702    |   24972 K  |   24972 K  |
|       from large pool |       2    |     783    |   15211 K  |   15211 K  |
|       from small pool |       0    |    1419    |    9760 K  |    9760 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    1702    |   24972 K  |   24972 K  |
|       from large pool |       2    |     783    |   15211 K  |   15211 K  |
|       from small pool |       0    |    1419    |    9760 K  |    9760 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      60    |     324    |     849    |     789    |
|       from large pool |      36    |     290    |     799    |     763    |
|       from small pool |      24    |      34    |      50    |      26    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |     341    |   14886 K  |   14886 K  |
|       from large pool |       4    |     294    |   10541 K  |   10541 K  |
|       from small pool |       0    |     221    |    4345 K  |    4345 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Sat Jul 27 05:08:01 2024]
Finished job 0.
1 of 1 steps (100%) done
