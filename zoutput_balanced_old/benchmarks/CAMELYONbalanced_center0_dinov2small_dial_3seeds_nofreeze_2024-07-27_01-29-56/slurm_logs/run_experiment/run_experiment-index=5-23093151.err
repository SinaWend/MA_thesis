Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Sat Jul 27 03:40:30 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_dial_3seeds_nofreeze_2024-07-27_01-29-56/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_dial_3seeds_nofreeze_2024-07-27_01-29-56/rule_results/4.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=4
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/swiglu_ffn.py:51: UserWarning: xFormers is not available (SwiGLU)
  warnings.warn("xFormers is not available (SwiGLU)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/attention.py:33: UserWarning: xFormers is not available (Attention)
  warnings.warn("xFormers is not available (Attention)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/block.py:40: UserWarning: xFormers is not available (Block)
  warnings.warn("xFormers is not available (Block)")
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_03_41_16_seed_0_23093151

 Experiment start at: 2024-07-27 03:41:16.190023
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
before training, model accuracy: 0.569767415523529
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.96484375, 'precision': 0.9648788, 'recall': 0.96496713, 'specificity': 0.96496713, 'f1': 0.9648428, 'auroc': 0.9955189, 'binary_precision': 0.9738562, 'binary_recall': 0.9563543, 'binary_specificity': 0.97357994, 'binary_f1_score': 0.9650259}
confusion matrix:
      0     1
0  1474    40
1    68  1490
---- Validation: 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
scalar performance:
{'acc': 0.7748447, 'precision': 0.8069243, 'recall': 0.7770797, 'specificity': 0.7770797, 'f1': 0.76972777, 'auroc': 0.91328454, 'binary_precision': 0.70414203, 'binary_recall': 0.93700784, 'binary_specificity': 0.6171516, 'binary_f1_score': 0.804054}
confusion matrix:
     0    1
0  403  250
1   40  595
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7767442, 'precision': 0.7984648, 'recall': 0.7767442, 'specificity': 0.7767442, 'f1': 0.7726071, 'auroc': 0.9218389, 'binary_precision': 0.71794873, 'binary_recall': 0.9116279, 'binary_specificity': 0.6418605, 'binary_f1_score': 0.8032787}
confusion matrix:
     0    1
0  138   77
1   19  196
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-27 03:43:46.922905,epoch time: 0:02:30.732882,used: 0:02:30.732882,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_03_41_16_seed_0_23093151
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.960612, 'precision': 0.9625421, 'recall': 0.9610674, 'specificity': 0.9610674, 'f1': 0.96059215, 'auroc': 0.9952389, 'binary_precision': 0.9958535, 'binary_recall': 0.92609257, 'binary_specificity': 0.9960422, 'binary_f1_score': 0.959707}
confusion matrix:
      0     1
0  1510     6
1   115  1441
---- Validation: 
scalar performance:
{'acc': 0.6902174, 'precision': 0.76456356, 'recall': 0.6864562, 'specificity': 0.6864562, 'f1': 0.66412365, 'auroc': 0.8064753, 'binary_precision': 0.9013606, 'binary_recall': 0.41732284, 'binary_specificity': 0.9555896, 'binary_f1_score': 0.5705059}
confusion matrix:
     0    1
0  624   29
1  370  265
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.76976746, 'precision': 0.8318608, 'recall': 0.7697674, 'specificity': 0.7697674, 'f1': 0.75846946, 'auroc': 0.8956193, 'binary_precision': 0.97540987, 'binary_recall': 0.5534884, 'binary_specificity': 0.9860465, 'binary_f1_score': 0.7062315}
confusion matrix:
     0    1
0  212    3
1   96  119
early stop counter: 1
val acc:0.6902173757553101, best validation acc: 0.7748447060585022, corresponding to test acc:                         0.7767441868782043 / 0.7767441868782043
after epoch: 2,now: 2024-07-27 03:46:12.367121,epoch time: 0:02:25.444216,used: 0:04:56.177098,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_03_41_16_seed_0_23093151
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.97265625, 'precision': 0.9729539, 'recall': 0.9728737, 'specificity': 0.9728737, 'f1': 0.9726561, 'auroc': 0.9967065, 'binary_precision': 0.9887193, 'binary_recall': 0.95696855, 'binary_specificity': 0.9887789, 'binary_f1_score': 0.9725849}
confusion matrix:
      0     1
0  1498    17
1    67  1490
---- Validation: 
scalar performance:
{'acc': 0.7569876, 'precision': 0.771209, 'recall': 0.7553448, 'specificity': 0.7553448, 'f1': 0.7529329, 'auroc': 0.8378893, 'binary_precision': 0.829918, 'binary_recall': 0.63779527, 'binary_specificity': 0.87289435, 'binary_f1_score': 0.72128224}
confusion matrix:
     0    1
0  570   83
1  230  405
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8418605, 'precision': 0.84292877, 'recall': 0.8418604, 'specificity': 0.8418604, 'f1': 0.8417372, 'auroc': 0.9110005, 'binary_precision': 0.8237885, 'binary_recall': 0.8697674, 'binary_specificity': 0.81395346, 'binary_f1_score': 0.84615386}
confusion matrix:
     0    1
0  175   40
1   28  187
new oracle model saved
early stop counter: 2
val acc:0.7569875717163086, best validation acc: 0.7748447060585022, corresponding to test acc:                         0.7767441868782043 / 0.8418604731559753
after epoch: 3,now: 2024-07-27 03:48:37.446947,epoch time: 0:02:25.079826,used: 0:07:21.256924,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_03_41_16_seed_0_23093151
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.97233075, 'precision': 0.97339416, 'recall': 0.9726779, 'specificity': 0.9726779, 'f1': 0.97232527, 'auroc': 0.99823856, 'binary_precision': 0.9993211, 'binary_recall': 0.9460154, 'binary_specificity': 0.99934036, 'binary_f1_score': 0.9719379}
confusion matrix:
      0     1
0  1515     1
1    84  1472
---- Validation: 
scalar performance:
{'acc': 0.6878882, 'precision': 0.76065, 'recall': 0.6841374, 'specificity': 0.6841374, 'f1': 0.66175675, 'auroc': 0.8763695, 'binary_precision': 0.8949153, 'binary_recall': 0.41574803, 'binary_specificity': 0.9525268, 'binary_f1_score': 0.56774193}
confusion matrix:
     0    1
0  622   31
1  371  264
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.73023254, 'precision': 0.7818384, 'recall': 0.73023254, 'specificity': 0.73023254, 'f1': 0.71729124, 'auroc': 0.88568956, 'binary_precision': 0.902439, 'binary_recall': 0.51627904, 'binary_specificity': 0.94418603, 'binary_f1_score': 0.6568047}
confusion matrix:
     0    1
0  203   12
1  104  111
early stop counter: 3
val acc:0.6878882050514221, best validation acc: 0.7748447060585022, corresponding to test acc:                         0.7767441868782043 / 0.8418604731559753
after epoch: 4,now: 2024-07-27 03:51:02.384307,epoch time: 0:02:24.937360,used: 0:09:46.194284,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_03_41_16_seed_0_23093151
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.96484375, 'precision': 0.9651035, 'recall': 0.96470594, 'specificity': 0.96470594, 'f1': 0.96482444, 'auroc': 0.9957017, 'binary_precision': 0.9571248, 'binary_recall': 0.9743261, 'binary_specificity': 0.9550859, 'binary_f1_score': 0.9656489}
confusion matrix:
      0     1
0  1446    68
1    40  1518
---- Validation: 
scalar performance:
{'acc': 0.77717394, 'precision': 0.7814734, 'recall': 0.7780094, 'specificity': 0.7780094, 'f1': 0.7766396, 'auroc': 0.8299068, 'binary_precision': 0.7430168, 'binary_recall': 0.83779526, 'binary_specificity': 0.7182236, 'binary_f1_score': 0.7875648}
confusion matrix:
     0    1
0  469  184
1  103  532
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.80465114, 'precision': 0.8084953, 'recall': 0.80465114, 'specificity': 0.80465114, 'f1': 0.8040407, 'auroc': 0.8795457, 'binary_precision': 0.8429319, 'binary_recall': 0.74883723, 'binary_specificity': 0.8604651, 'binary_f1_score': 0.7931034}
confusion matrix:
     0    1
0  185   30
1   54  161
better model found
persisted
after epoch: 5,now: 2024-07-27 03:53:27.274183,epoch time: 0:02:24.889876,used: 0:12:11.084160,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_03_41_16_seed_0_23093151
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9788411, 'precision': 0.9788238, 'recall': 0.97886497, 'specificity': 0.97886497, 'f1': 0.9788393, 'auroc': 0.9978677, 'binary_precision': 0.98125404, 'binary_recall': 0.976834, 'binary_specificity': 0.98089594, 'binary_f1_score': 0.979039}
confusion matrix:
      0     1
0  1489    29
1    36  1518
---- Validation: 
scalar performance:
{'acc': 0.8035714, 'precision': 0.82220227, 'recall': 0.8018726, 'specificity': 0.8018726, 'f1': 0.800047, 'auroc': 0.91522837, 'binary_precision': 0.89626557, 'binary_recall': 0.68031496, 'binary_specificity': 0.9234303, 'binary_f1_score': 0.77350044}
confusion matrix:
     0    1
0  603   50
1  203  432
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.83023256, 'precision': 0.8681507, 'recall': 0.83023256, 'specificity': 0.83023256, 'f1': 0.8257457, 'auroc': 0.92201185, 'binary_precision': 0.98630136, 'binary_recall': 0.66976744, 'binary_specificity': 0.9906977, 'binary_f1_score': 0.797784}
confusion matrix:
     0    1
0  213    2
1   71  144
better model found
persisted
after epoch: 6,now: 2024-07-27 03:55:53.071597,epoch time: 0:02:25.797414,used: 0:14:36.881574,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_03_41_16_seed_0_23093151
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9863281, 'precision': 0.9864067, 'recall': 0.98649085, 'specificity': 0.98649085, 'f1': 0.9863279, 'auroc': 0.99960744, 'binary_precision': 0.99737704, 'binary_recall': 0.9756254, 'binary_specificity': 0.99735624, 'binary_f1_score': 0.98638135}
confusion matrix:
      0     1
0  1509     4
1    38  1521
---- Validation: 
scalar performance:
{'acc': 0.60481364, 'precision': 0.7337252, 'recall': 0.59953815, 'specificity': 0.59953815, 'f1': 0.5356784, 'auroc': 0.89208376, 'binary_precision': 0.90384614, 'binary_recall': 0.22204724, 'binary_specificity': 0.9770291, 'binary_f1_score': 0.35651076}
confusion matrix:
     0    1
0  638   15
1  494  141
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6372093, 'precision': 0.77431774, 'recall': 0.6372093, 'specificity': 0.6372093, 'f1': 0.58540386, 'auroc': 0.91846406, 'binary_precision': 0.96825397, 'binary_recall': 0.28372094, 'binary_specificity': 0.9906977, 'binary_f1_score': 0.43884894}
confusion matrix:
     0   1
0  213   2
1  154  61
early stop counter: 1
val acc:0.6048136353492737, best validation acc: 0.8035714030265808, corresponding to test acc:                         0.830232560634613 / 0.8418604731559753
after epoch: 7,now: 2024-07-27 03:58:17.664900,epoch time: 0:02:24.593303,used: 0:17:01.474877,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_03_41_16_seed_0_23093151
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.98567706, 'precision': 0.9857509, 'recall': 0.98581684, 'specificity': 0.98581684, 'f1': 0.98567694, 'auroc': 0.99914443, 'binary_precision': 0.99606556, 'binary_recall': 0.9755941, 'binary_specificity': 0.9960396, 'binary_f1_score': 0.98572356}
confusion matrix:
      0     1
0  1509     6
1    38  1519
---- Validation: 
scalar performance:
{'acc': 0.8486025, 'precision': 0.85245323, 'recall': 0.8478675, 'specificity': 0.8478675, 'f1': 0.84797114, 'auroc': 0.9233098, 'binary_precision': 0.88596493, 'binary_recall': 0.79527557, 'binary_specificity': 0.9004594, 'binary_f1_score': 0.8381742}
confusion matrix:
     0    1
0  588   65
1  130  505
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.81395346, 'precision': 0.8252101, 'recall': 0.8139535, 'specificity': 0.8139535, 'f1': 0.81232953, 'auroc': 0.89336944, 'binary_precision': 0.8857143, 'binary_recall': 0.7209302, 'binary_specificity': 0.90697676, 'binary_f1_score': 0.79487175}
confusion matrix:
     0    1
0  195   20
1   60  155
better model found
persisted
after epoch: 8,now: 2024-07-27 04:00:42.727865,epoch time: 0:02:25.062965,used: 0:19:26.537842,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_03_41_16_seed_0_23093151
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9733073, 'precision': 0.9745043, 'recall': 0.97299963, 'specificity': 0.97299963, 'f1': 0.97327304, 'auroc': 0.9991454, 'binary_precision': 0.95384616, 'binary_recall': 0.9955042, 'binary_specificity': 0.95049506, 'binary_f1_score': 0.97423005}
confusion matrix:
      0     1
0  1440    75
1     7  1550
---- Validation: 
scalar performance:
{'acc': 0.8454969, 'precision': 0.846515, 'recall': 0.8451086, 'specificity': 0.8451086, 'f1': 0.8452543, 'auroc': 0.90992993, 'binary_precision': 0.86212623, 'binary_recall': 0.81732285, 'binary_specificity': 0.87289435, 'binary_f1_score': 0.8391269}
confusion matrix:
     0    1
0  570   83
1  116  519
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7976744, 'precision': 0.8048564, 'recall': 0.7976744, 'specificity': 0.7976744, 'f1': 0.7964757, 'auroc': 0.8848026, 'binary_precision': 0.85164833, 'binary_recall': 0.7209302, 'binary_specificity': 0.8744186, 'binary_f1_score': 0.78085643}
confusion matrix:
     0    1
0  188   27
1   60  155
early stop counter: 1
val acc:0.8454968929290771, best validation acc: 0.8486024737358093, corresponding to test acc:                         0.8139534592628479 / 0.8418604731559753
after epoch: 9,now: 2024-07-27 04:03:07.698888,epoch time: 0:02:24.971023,used: 0:21:51.508865,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_03_41_16_seed_0_23093151
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9749349, 'precision': 0.97558564, 'recall': 0.9752657, 'specificity': 0.9752657, 'f1': 0.9749335, 'auroc': 0.9985316, 'binary_precision': 0.9973154, 'binary_recall': 0.9531751, 'binary_specificity': 0.99735624, 'binary_f1_score': 0.97474587}
confusion matrix:
      0     1
0  1509     4
1    73  1486
---- Validation: 
scalar performance:
{'acc': 0.81832296, 'precision': 0.848827, 'recall': 0.8162472, 'specificity': 0.8162472, 'f1': 0.8135537, 'auroc': 0.92460966, 'binary_precision': 0.9485459, 'binary_recall': 0.66771656, 'binary_specificity': 0.96477795, 'binary_f1_score': 0.78373384}
confusion matrix:
     0    1
0  630   23
1  211  424
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7930232, 'precision': 0.8387605, 'recall': 0.7930232, 'specificity': 0.7930232, 'f1': 0.78579307, 'auroc': 0.9185289, 'binary_precision': 0.9632353, 'binary_recall': 0.60930234, 'binary_specificity': 0.9767442, 'binary_f1_score': 0.7464388}
confusion matrix:
     0    1
0  210    5
1   84  131
early stop counter: 2
val acc:0.8183229565620422, best validation acc: 0.8486024737358093, corresponding to test acc:                         0.8139534592628479 / 0.8418604731559753
after epoch: 10,now: 2024-07-27 04:05:32.437141,epoch time: 0:02:24.738253,used: 0:24:16.247118,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_03_41_16_seed_0_23093151
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.98014325, 'precision': 0.98086977, 'recall': 0.97992367, 'specificity': 0.97992367, 'f1': 0.9801258, 'auroc': 0.99952984, 'binary_precision': 0.96515244, 'binary_recall': 0.99678665, 'binary_specificity': 0.9630607, 'binary_f1_score': 0.98071456}
confusion matrix:
      0     1
0  1460    56
1     5  1551
---- Validation: 
scalar performance:
{'acc': 0.85714287, 'precision': 0.85718316, 'recall': 0.8572452, 'specificity': 0.8572452, 'f1': 0.85713977, 'auroc': 0.9141407, 'binary_precision': 0.84853166, 'binary_recall': 0.8645669, 'binary_specificity': 0.84992343, 'binary_f1_score': 0.8564743}
confusion matrix:
     0    1
0  555   98
1   86  549
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.83255816, 'precision': 0.8325869, 'recall': 0.83255816, 'specificity': 0.83255816, 'f1': 0.8325545, 'auroc': 0.88839376, 'binary_precision': 0.8356807, 'binary_recall': 0.82790697, 'binary_specificity': 0.8372093, 'binary_f1_score': 0.8317757}
confusion matrix:
     0    1
0  180   35
1   37  178
better model found
persisted
after epoch: 11,now: 2024-07-27 04:07:57.256897,epoch time: 0:02:24.819756,used: 0:26:41.066874,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_03_41_16_seed_0_23093151
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.98860675, 'precision': 0.9889174, 'recall': 0.98848695, 'specificity': 0.98848695, 'f1': 0.9886014, 'auroc': 0.99978596, 'binary_precision': 0.9791798, 'binary_recall': 0.998713, 'binary_specificity': 0.9782609, 'binary_f1_score': 0.98884994}
confusion matrix:
      0     1
0  1485    33
1     2  1552
---- Validation: 
scalar performance:
{'acc': 0.8781056, 'precision': 0.87807333, 'recall': 0.87811434, 'specificity': 0.87811434, 'f1': 0.8780891, 'auroc': 0.9322859, 'binary_precision': 0.87460816, 'binary_recall': 0.87874013, 'binary_specificity': 0.8774885, 'binary_f1_score': 0.8766693}
confusion matrix:
     0    1
0  573   80
1   77  558
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8697674, 'precision': 0.87443316, 'recall': 0.8697674, 'specificity': 0.8697674, 'f1': 0.86936045, 'auroc': 0.92616546, 'binary_precision': 0.9162304, 'binary_recall': 0.81395346, 'binary_specificity': 0.9255814, 'binary_f1_score': 0.86206895}
confusion matrix:
     0    1
0  199   16
1   40  175
new oracle model saved
better model found
persisted
after epoch: 12,now: 2024-07-27 04:10:22.561039,epoch time: 0:02:25.304142,used: 0:29:06.371016,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_03_41_16_seed_0_23093151
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.98795575, 'precision': 0.98800457, 'recall': 0.9880826, 'specificity': 0.9880826, 'f1': 0.9879556, 'auroc': 0.999365, 'binary_precision': 0.9973822, 'binary_recall': 0.9788054, 'binary_specificity': 0.99735975, 'binary_f1_score': 0.9880065}
confusion matrix:
      0     1
0  1511     4
1    33  1524
---- Validation: 
scalar performance:
{'acc': 0.6902174, 'precision': 0.7903327, 'recall': 0.6860655, 'specificity': 0.6860655, 'f1': 0.65805745, 'auroc': 0.92825603, 'binary_precision': 0.9573643, 'binary_recall': 0.38897637, 'binary_specificity': 0.98315465, 'binary_f1_score': 0.5531915}
confusion matrix:
     0    1
0  642   11
1  388  247
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.54651165, 'precision': 0.7621951, 'recall': 0.54651165, 'specificity': 0.54651165, 'f1': 0.42910635, 'auroc': 0.92421854, 'binary_precision': 1.0, 'binary_recall': 0.093023255, 'binary_specificity': 1.0, 'binary_f1_score': 0.17021276}
confusion matrix:
     0   1
0  215   0
1  195  20
early stop counter: 1
val acc:0.6902173757553101, best validation acc: 0.8781055808067322, corresponding to test acc:                         0.869767427444458 / 0.869767427444458
after epoch: 13,now: 2024-07-27 04:12:47.430134,epoch time: 0:02:24.869095,used: 0:31:31.240111,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_03_41_16_seed_0_23093151
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.984375, 'precision': 0.984586, 'recall': 0.98456794, 'specificity': 0.98456794, 'f1': 0.984375, 'auroc': 0.99973, 'binary_precision': 0.99867815, 'binary_recall': 0.970456, 'binary_specificity': 0.9986799, 'binary_f1_score': 0.98436487}
confusion matrix:
      0     1
0  1513     2
1    46  1511
---- Validation: 
scalar performance:
{'acc': 0.6459627, 'precision': 0.75975895, 'recall': 0.64127046, 'specificity': 0.64127046, 'f1': 0.5982181, 'auroc': 0.9101349, 'binary_precision': 0.9282297, 'binary_recall': 0.3055118, 'binary_specificity': 0.9770291, 'binary_f1_score': 0.45971563}
confusion matrix:
     0    1
0  638   15
1  441  194
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7883721, 'precision': 0.85130715, 'recall': 0.7883721, 'specificity': 0.7883721, 'f1': 0.77844965, 'auroc': 0.9407896, 'binary_precision': 1.0, 'binary_recall': 0.5767442, 'binary_specificity': 1.0, 'binary_f1_score': 0.73156345}
confusion matrix:
     0    1
0  215    0
1   91  124
early stop counter: 2
val acc:0.6459627151489258, best validation acc: 0.8781055808067322, corresponding to test acc:                         0.869767427444458 / 0.869767427444458
after epoch: 14,now: 2024-07-27 04:15:13.065238,epoch time: 0:02:25.635104,used: 0:33:56.875215,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_03_41_16_seed_0_23093151
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9941406, 'precision': 0.99410975, 'recall': 0.9942002, 'specificity': 0.9942002, 'f1': 0.99413985, 'auroc': 0.99984777, 'binary_precision': 0.998062, 'binary_recall': 0.99038464, 'binary_specificity': 0.9980159, 'binary_f1_score': 0.9942085}
confusion matrix:
      0     1
0  1509     3
1    15  1545
---- Validation: 
scalar performance:
{'acc': 0.8198758, 'precision': 0.82681847, 'recall': 0.8188422, 'specificity': 0.8188422, 'f1': 0.8185523, 'auroc': 0.89801395, 'binary_precision': 0.87108654, 'binary_recall': 0.74488187, 'binary_specificity': 0.8928025, 'binary_f1_score': 0.803056}
confusion matrix:
     0    1
0  583   70
1  162  473
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8, 'precision': 0.8454697, 'recall': 0.8, 'specificity': 0.8, 'f1': 0.79319525, 'auroc': 0.9148296, 'binary_precision': 0.9708029, 'binary_recall': 0.61860466, 'binary_specificity': 0.98139536, 'binary_f1_score': 0.7556818}
confusion matrix:
     0    1
0  211    4
1   82  133
early stop counter: 3
val acc:0.8198757767677307, best validation acc: 0.8781055808067322, corresponding to test acc:                         0.869767427444458 / 0.869767427444458
after epoch: 15,now: 2024-07-27 04:17:38.127212,epoch time: 0:02:25.061974,used: 0:36:21.937189,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_03_41_16_seed_0_23093151
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.98535156, 'precision': 0.98534435, 'recall': 0.9854178, 'specificity': 0.9854178, 'f1': 0.9853509, 'auroc': 0.99923396, 'binary_precision': 0.9908973, 'binary_recall': 0.98006433, 'binary_specificity': 0.99077123, 'binary_f1_score': 0.9854511}
confusion matrix:
      0     1
0  1503    14
1    31  1524
---- Validation: 
scalar performance:
{'acc': 0.8439441, 'precision': 0.8647208, 'recall': 0.8422749, 'specificity': 0.8422749, 'f1': 0.8412103, 'auroc': 0.9341856, 'binary_precision': 0.9483471, 'binary_recall': 0.72283465, 'binary_specificity': 0.96171516, 'binary_f1_score': 0.8203753}
confusion matrix:
     0    1
0  628   25
1  176  459
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8488372, 'precision': 0.88392854, 'recall': 0.8488372, 'specificity': 0.8488372, 'f1': 0.84530234, 'auroc': 0.93419147, 'binary_precision': 1.0, 'binary_recall': 0.6976744, 'binary_specificity': 1.0, 'binary_f1_score': 0.8219178}
confusion matrix:
     0    1
0  215    0
1   65  150
early stop counter: 4
val acc:0.8439440727233887, best validation acc: 0.8781055808067322, corresponding to test acc:                         0.869767427444458 / 0.869767427444458
after epoch: 16,now: 2024-07-27 04:20:03.059125,epoch time: 0:02:24.931913,used: 0:38:46.869102,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_03_41_16_seed_0_23093151
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.98372394, 'precision': 0.9839839, 'recall': 0.9839445, 'specificity': 0.9839445, 'f1': 0.98372394, 'auroc': 0.9996897, 'binary_precision': 0.99933773, 'binary_recall': 0.96854943, 'binary_specificity': 0.9993395, 'binary_f1_score': 0.9837027}
confusion matrix:
      0     1
0  1513     1
1    49  1509
---- Validation: 
scalar performance:
{'acc': 0.6964286, 'precision': 0.79026777, 'recall': 0.69240814, 'specificity': 0.69240814, 'f1': 0.6669821, 'auroc': 0.9221859, 'binary_precision': 0.95185184, 'binary_recall': 0.40472442, 'binary_specificity': 0.98009187, 'binary_f1_score': 0.56795585}
confusion matrix:
     0    1
0  640   13
1  378  257
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.75348836, 'precision': 0.83091867, 'recall': 0.75348836, 'specificity': 0.75348836, 'f1': 0.73817235, 'auroc': 0.93109787, 'binary_precision': 0.990991, 'binary_recall': 0.5116279, 'binary_specificity': 0.9953488, 'binary_f1_score': 0.6748466}
confusion matrix:
     0    1
0  214    1
1  105  110
early stop counter: 5
val acc:0.6964285969734192, best validation acc: 0.8781055808067322, corresponding to test acc:                         0.869767427444458 / 0.869767427444458
after epoch: 17,now: 2024-07-27 04:22:27.885426,epoch time: 0:02:24.826301,used: 0:41:11.695403,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_03_41_16_seed_0_23093151
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 17 with time: 0:41:11.695403 at 2024-07-27 04:22:27.885426
persisted model performance metric: 

scalar performance:
{'acc': 0.8697674, 'precision': 0.87443316, 'recall': 0.8697674, 'specificity': 0.8697674, 'f1': 0.86936045, 'auroc': 0.92616546, 'binary_precision': 0.9162304, 'binary_recall': 0.81395346, 'binary_specificity': 0.9255814, 'binary_f1_score': 0.86206895}
confusion matrix:
     0    1
0  199   16
1   40  175
oracle model performance metric: 

scalar performance:
{'acc': 0.8697674, 'precision': 0.87443316, 'recall': 0.8697674, 'specificity': 0.8697674, 'f1': 0.86936045, 'auroc': 0.92616546, 'binary_precision': 0.9162304, 'binary_recall': 0.81395346, 'binary_specificity': 0.9255814, 'binary_f1_score': 0.86206895}
confusion matrix:
     0    1
0  199   16
1   40  175
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_dial_3seeds_nofreeze_2024-07-27_01-29-56/rule_results/4.csv
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_dial_3seeds_nofreeze_2024-07-27_01-29-56/rule_results/4.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_dial_3seeds_nofreeze_2024-07-27_01-29-56/confusion_matrix/4.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 455874 KiB |   6793 MiB | 109143 GiB | 109142 GiB |
|       from large pool | 415281 KiB |   6758 MiB | 107975 GiB | 107975 GiB |
|       from small pool |  40592 KiB |     56 MiB |   1167 GiB |   1167 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 455874 KiB |   6793 MiB | 109143 GiB | 109142 GiB |
|       from large pool | 415281 KiB |   6758 MiB | 107975 GiB | 107975 GiB |
|       from small pool |  40592 KiB |     56 MiB |   1167 GiB |   1167 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 447480 KiB |   6787 MiB | 109012 GiB | 109012 GiB |
|       from large pool | 407075 KiB |   6753 MiB | 107846 GiB | 107846 GiB |
|       from small pool |  40405 KiB |     56 MiB |   1166 GiB |   1166 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   7958 MiB |   7958 MiB |   7958 MiB |      0 B   |
|       from large pool |   7894 MiB |   7894 MiB |   7894 MiB |      0 B   |
|       from small pool |     64 MiB |     64 MiB |     64 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory | 359230 KiB |   1135 MiB | 143190 GiB | 143190 GiB |
|       from large pool | 350670 KiB |   1126 MiB | 142006 GiB | 142006 GiB |
|       from small pool |   8559 KiB |     13 MiB |   1184 GiB |   1184 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    1298    |    1698    |   15689 K  |   15688 K  |
|       from large pool |     187    |     783    |    9569 K  |    9569 K  |
|       from small pool |    1111    |    1407    |    6120 K  |    6119 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    1298    |    1698    |   15689 K  |   15688 K  |
|       from large pool |     187    |     783    |    9569 K  |    9569 K  |
|       from small pool |    1111    |    1407    |    6120 K  |    6119 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     321    |     321    |     321    |       0    |
|       from large pool |     289    |     289    |     289    |       0    |
|       from small pool |      32    |      32    |      32    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      79    |     340    |    8991 K  |    8990 K  |
|       from large pool |      33    |     290    |    6248 K  |    6248 K  |
|       from small pool |      46    |     220    |    2742 K  |    2742 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   6793 MiB | 109143 GiB | 109143 GiB |
|       from large pool |  16640 KiB |   6758 MiB | 107975 GiB | 107975 GiB |
|       from small pool |      0 KiB |     56 MiB |   1167 GiB |   1167 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   6793 MiB | 109143 GiB | 109143 GiB |
|       from large pool |  16640 KiB |   6758 MiB | 107975 GiB | 107975 GiB |
|       from small pool |      0 KiB |     56 MiB |   1167 GiB |   1167 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   6787 MiB | 109012 GiB | 109012 GiB |
|       from large pool |  16640 KiB |   6753 MiB | 107846 GiB | 107846 GiB |
|       from small pool |      0 KiB |     56 MiB |   1166 GiB |   1166 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    796 MiB |   7958 MiB |   7958 MiB |   7162 MiB |
|       from large pool |    748 MiB |   7894 MiB |   7894 MiB |   7146 MiB |
|       from small pool |     48 MiB |     64 MiB |     64 MiB |     16 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1135 MiB | 143191 GiB | 143191 GiB |
|       from large pool |  24320 KiB |   1126 MiB | 142006 GiB | 142006 GiB |
|       from small pool |      0 KiB |     29 MiB |   1184 GiB |   1184 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    1698    |   15689 K  |   15689 K  |
|       from large pool |       2    |     783    |    9569 K  |    9569 K  |
|       from small pool |       0    |    1407    |    6120 K  |    6120 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    1698    |   15689 K  |   15689 K  |
|       from large pool |       2    |     783    |    9569 K  |    9569 K  |
|       from small pool |       0    |    1407    |    6120 K  |    6120 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      59    |     321    |     321    |     262    |
|       from large pool |      35    |     289    |     289    |     254    |
|       from small pool |      24    |      32    |      32    |       8    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |     340    |    8991 K  |    8991 K  |
|       from large pool |       4    |     290    |    6248 K  |    6248 K  |
|       from small pool |       0    |     220    |    2742 K  |    2742 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   6793 MiB | 109143 GiB | 109143 GiB |
|       from large pool |  16640 KiB |   6758 MiB | 107975 GiB | 107975 GiB |
|       from small pool |      0 KiB |     56 MiB |   1167 GiB |   1167 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   6793 MiB | 109143 GiB | 109143 GiB |
|       from large pool |  16640 KiB |   6758 MiB | 107975 GiB | 107975 GiB |
|       from small pool |      0 KiB |     56 MiB |   1167 GiB |   1167 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   6787 MiB | 109012 GiB | 109012 GiB |
|       from large pool |  16640 KiB |   6753 MiB | 107846 GiB | 107846 GiB |
|       from small pool |      0 KiB |     56 MiB |   1166 GiB |   1166 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    796 MiB |   7958 MiB |   7958 MiB |   7162 MiB |
|       from large pool |    748 MiB |   7894 MiB |   7894 MiB |   7146 MiB |
|       from small pool |     48 MiB |     64 MiB |     64 MiB |     16 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1135 MiB | 143191 GiB | 143191 GiB |
|       from large pool |  24320 KiB |   1126 MiB | 142006 GiB | 142006 GiB |
|       from small pool |      0 KiB |     29 MiB |   1184 GiB |   1184 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    1698    |   15689 K  |   15689 K  |
|       from large pool |       2    |     783    |    9569 K  |    9569 K  |
|       from small pool |       0    |    1407    |    6120 K  |    6120 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    1698    |   15689 K  |   15689 K  |
|       from large pool |       2    |     783    |    9569 K  |    9569 K  |
|       from small pool |       0    |    1407    |    6120 K  |    6120 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      59    |     321    |     321    |     262    |
|       from large pool |      35    |     289    |     289    |     254    |
|       from small pool |      24    |      32    |      32    |       8    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |     340    |    8991 K  |    8991 K  |
|       from large pool |       4    |     290    |    6248 K  |    6248 K  |
|       from small pool |       0    |     220    |    2742 K  |    2742 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_04_23_05_seed_1_23093151

 Experiment start at: 2024-07-27 04:23:05.586142
before training, model accuracy: 0.6177777647972107
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.96875, 'precision': 0.9699072, 'recall': 0.96847135, 'specificity': 0.96847135, 'f1': 0.96871275, 'auroc': 0.9978473, 'binary_precision': 0.9494763, 'binary_recall': 0.9909968, 'binary_specificity': 0.9459459, 'binary_f1_score': 0.96979237}
confusion matrix:
      0     1
0  1435    82
1    14  1541
---- Validation: 
scalar performance:
{'acc': 0.86729115, 'precision': 0.8678223, 'recall': 0.8669739, 'specificity': 0.8669739, 'f1': 0.8671414, 'auroc': 0.9106966, 'binary_precision': 0.87828946, 'binary_recall': 0.84761906, 'binary_specificity': 0.8863287, 'binary_f1_score': 0.8626817}
confusion matrix:
     0    1
0  577   74
1   96  534
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.88222224, 'precision': 0.88283473, 'recall': 0.8822222, 'specificity': 0.8822222, 'f1': 0.8821751, 'auroc': 0.9361778, 'binary_precision': 0.8981481, 'binary_recall': 0.8622222, 'binary_specificity': 0.9022222, 'binary_f1_score': 0.87981856}
confusion matrix:
     0    1
0  203   22
1   31  194
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-27 04:25:36.287586,epoch time: 0:02:30.701444,used: 0:02:30.701444,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_04_23_05_seed_1_23093151
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9788411, 'precision': 0.9788283, 'recall': 0.9788983, 'specificity': 0.9788983, 'f1': 0.97884, 'auroc': 0.99793005, 'binary_precision': 0.98376626, 'binary_recall': 0.97427654, 'binary_specificity': 0.9835201, 'binary_f1_score': 0.97899836}
confusion matrix:
      0     1
0  1492    25
1    40  1515
---- Validation: 
scalar performance:
{'acc': 0.7946916, 'precision': 0.8161844, 'recall': 0.79252434, 'specificity': 0.79252434, 'f1': 0.79027, 'auroc': 0.9001585, 'binary_precision': 0.89462364, 'binary_recall': 0.6603175, 'binary_specificity': 0.9247312, 'binary_f1_score': 0.7598173}
confusion matrix:
     0    1
0  602   49
1  214  416
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7911111, 'precision': 0.8118322, 'recall': 0.7911111, 'specificity': 0.7911111, 'f1': 0.78758234, 'auroc': 0.89066666, 'binary_precision': 0.89221555, 'binary_recall': 0.6622222, 'binary_specificity': 0.92, 'binary_f1_score': 0.760204}
confusion matrix:
     0    1
0  207   18
1   76  149
early stop counter: 1
val acc:0.7946916222572327, best validation acc: 0.8672911524772644, corresponding to test acc:                         0.8822222352027893 / 0.8822222352027893
after epoch: 2,now: 2024-07-27 04:28:00.013710,epoch time: 0:02:23.726124,used: 0:04:54.427568,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_04_23_05_seed_1_23093151
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9690755, 'precision': 0.9708913, 'recall': 0.96872044, 'specificity': 0.96872044, 'f1': 0.9690242, 'auroc': 0.9991254, 'binary_precision': 0.9445798, 'binary_recall': 0.99742764, 'binary_specificity': 0.9400132, 'binary_f1_score': 0.97028464}
confusion matrix:
      0     1
0  1426    91
1     4  1551
---- Validation: 
scalar performance:
{'acc': 0.863388, 'precision': 0.8634635, 'recall': 0.8635433, 'specificity': 0.8635433, 'f1': 0.863385, 'auroc': 0.92102015, 'binary_precision': 0.85271317, 'binary_recall': 0.8730159, 'binary_specificity': 0.85407066, 'binary_f1_score': 0.86274517}
confusion matrix:
     0    1
0  556   95
1   80  550
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8577778, 'precision': 0.85848594, 'recall': 0.8577778, 'specificity': 0.8577778, 'f1': 0.8577075, 'auroc': 0.92351604, 'binary_precision': 0.8744186, 'binary_recall': 0.83555555, 'binary_specificity': 0.88, 'binary_f1_score': 0.8545455}
confusion matrix:
     0    1
0  198   27
1   37  188
early stop counter: 2
val acc:0.8633880019187927, best validation acc: 0.8672911524772644, corresponding to test acc:                         0.8822222352027893 / 0.8822222352027893
after epoch: 3,now: 2024-07-27 04:30:24.510925,epoch time: 0:02:24.497215,used: 0:07:18.924783,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_04_23_05_seed_1_23093151
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9713542, 'precision': 0.9725063, 'recall': 0.9717139, 'specificity': 0.9717139, 'f1': 0.9713477, 'auroc': 0.9985676, 'binary_precision': 0.99931973, 'binary_recall': 0.9440874, 'binary_specificity': 0.99934036, 'binary_f1_score': 0.9709187}
confusion matrix:
      0     1
0  1515     1
1    87  1469
---- Validation: 
scalar performance:
{'acc': 0.71818894, 'precision': 0.80010986, 'recall': 0.7138505, 'specificity': 0.7138505, 'f1': 0.6948883, 'auroc': 0.90265465, 'binary_precision': 0.95286196, 'binary_recall': 0.44920635, 'binary_specificity': 0.97849464, 'binary_f1_score': 0.61057174}
confusion matrix:
     0    1
0  637   14
1  347  283
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7777778, 'precision': 0.8335428, 'recall': 0.7777778, 'specificity': 0.7777778, 'f1': 0.7680843, 'auroc': 0.891595, 'binary_precision': 0.9699248, 'binary_recall': 0.5733333, 'binary_specificity': 0.9822222, 'binary_f1_score': 0.7206704}
confusion matrix:
     0    1
0  221    4
1   96  129
early stop counter: 3
val acc:0.7181889414787292, best validation acc: 0.8672911524772644, corresponding to test acc:                         0.8822222352027893 / 0.8822222352027893
after epoch: 4,now: 2024-07-27 04:32:49.470483,epoch time: 0:02:24.959558,used: 0:09:43.884341,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_04_23_05_seed_1_23093151
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9765625, 'precision': 0.97726625, 'recall': 0.9768697, 'specificity': 0.9768697, 'f1': 0.97656053, 'auroc': 0.998932, 'binary_precision': 0.9993275, 'binary_recall': 0.95439947, 'binary_specificity': 0.99933994, 'binary_f1_score': 0.9763469}
confusion matrix:
      0     1
0  1514     1
1    71  1486
---- Validation: 
scalar performance:
{'acc': 0.676815, 'precision': 0.7801665, 'recall': 0.6717614, 'specificity': 0.6717614, 'f1': 0.6401295, 'auroc': 0.90908, 'binary_precision': 0.946281, 'binary_recall': 0.36349207, 'binary_specificity': 0.9800307, 'binary_f1_score': 0.5252294}
confusion matrix:
     0    1
0  638   13
1  401  229
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.69777775, 'precision': 0.8064832, 'recall': 0.6977778, 'specificity': 0.6977778, 'f1': 0.6683718, 'auroc': 0.91442966, 'binary_precision': 0.989011, 'binary_recall': 0.4, 'binary_specificity': 0.9955556, 'binary_f1_score': 0.56962025}
confusion matrix:
     0   1
0  224   1
1  135  90
early stop counter: 4
val acc:0.6768149733543396, best validation acc: 0.8672911524772644, corresponding to test acc:                         0.8822222352027893 / 0.8822222352027893
after epoch: 5,now: 2024-07-27 04:35:13.928216,epoch time: 0:02:24.457733,used: 0:12:08.342074,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_04_23_05_seed_1_23093151
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9827474, 'precision': 0.98287076, 'recall': 0.9826724, 'specificity': 0.9826724, 'f1': 0.9827415, 'auroc': 0.99909365, 'binary_precision': 0.9777495, 'binary_recall': 0.9884319, 'binary_specificity': 0.9769129, 'binary_f1_score': 0.9830617}
confusion matrix:
      0     1
0  1481    35
1    18  1538
---- Validation: 
scalar performance:
{'acc': 0.87822014, 'precision': 0.8819454, 'recall': 0.87741935, 'specificity': 0.87741935, 'f1': 0.87773126, 'auroc': 0.9235657, 'binary_precision': 0.9157895, 'binary_recall': 0.82857144, 'binary_specificity': 0.92626727, 'binary_f1_score': 0.87}
confusion matrix:
     0    1
0  603   48
1  108  522
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8933333, 'precision': 0.8986566, 'recall': 0.8933333, 'specificity': 0.8933333, 'f1': 0.89297605, 'auroc': 0.92454326, 'binary_precision': 0.9447236, 'binary_recall': 0.83555555, 'binary_specificity': 0.95111114, 'binary_f1_score': 0.8867924}
confusion matrix:
     0    1
0  214   11
1   37  188
new oracle model saved
better model found
persisted
after epoch: 6,now: 2024-07-27 04:37:40.972455,epoch time: 0:02:27.044239,used: 0:14:35.386313,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_04_23_05_seed_1_23093151
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.98795575, 'precision': 0.98802716, 'recall': 0.9879019, 'specificity': 0.9879019, 'f1': 0.9879519, 'auroc': 0.99950445, 'binary_precision': 0.98470366, 'binary_recall': 0.99165595, 'binary_specificity': 0.98414797, 'binary_f1_score': 0.9881676}
confusion matrix:
      0     1
0  1490    24
1    13  1545
---- Validation: 
scalar performance:
{'acc': 0.8790008, 'precision': 0.8809742, 'recall': 0.87841785, 'specificity': 0.87841785, 'f1': 0.878698, 'auroc': 0.9377271, 'binary_precision': 0.90459967, 'binary_recall': 0.8428571, 'binary_specificity': 0.9139785, 'binary_f1_score': 0.8726376}
confusion matrix:
     0    1
0  595   56
1   99  531
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8622222, 'precision': 0.86792, 'recall': 0.8622222, 'specificity': 0.8622222, 'f1': 0.86168677, 'auroc': 0.9200642, 'binary_precision': 0.9137056, 'binary_recall': 0.8, 'binary_specificity': 0.92444444, 'binary_f1_score': 0.85308063}
confusion matrix:
     0    1
0  208   17
1   45  180
better model found
persisted
after epoch: 7,now: 2024-07-27 04:40:06.439071,epoch time: 0:02:25.466616,used: 0:17:00.852929,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_04_23_05_seed_1_23093151
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.98502606, 'precision': 0.98526585, 'recall': 0.985228, 'specificity': 0.985228, 'f1': 0.985026, 'auroc': 0.9996567, 'binary_precision': 1.0, 'binary_recall': 0.970456, 'binary_specificity': 1.0, 'binary_f1_score': 0.9850065}
confusion matrix:
      0     1
0  1515     0
1    46  1511
---- Validation: 
scalar performance:
{'acc': 0.6651054, 'precision': 0.78171194, 'recall': 0.6597542, 'specificity': 0.6597542, 'f1': 0.62213093, 'auroc': 0.90921724, 'binary_precision': 0.9589041, 'binary_recall': 0.33333334, 'binary_specificity': 0.9861751, 'binary_f1_score': 0.49469966}
confusion matrix:
     0    1
0  642    9
1  420  210
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6066667, 'precision': 0.77, 'recall': 0.6066667, 'specificity': 0.6066667, 'f1': 0.5365819, 'auroc': 0.93627656, 'binary_precision': 0.98, 'binary_recall': 0.21777777, 'binary_specificity': 0.9955556, 'binary_f1_score': 0.35636365}
confusion matrix:
     0   1
0  224   1
1  176  49
early stop counter: 1
val acc:0.665105402469635, best validation acc: 0.8790007829666138, corresponding to test acc:                         0.8622221946716309 / 0.8933333158493042
after epoch: 8,now: 2024-07-27 04:42:30.712136,epoch time: 0:02:24.273065,used: 0:19:25.125994,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_04_23_05_seed_1_23093151
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9814453, 'precision': 0.9818216, 'recall': 0.98169804, 'specificity': 0.98169804, 'f1': 0.9814451, 'auroc': 0.9990686, 'binary_precision': 0.9993347, 'binary_recall': 0.9640565, 'binary_specificity': 0.9993395, 'binary_f1_score': 0.9813786}
confusion matrix:
      0     1
0  1513     1
1    56  1502
---- Validation: 
scalar performance:
{'acc': 0.8126464, 'precision': 0.84671915, 'recall': 0.81006145, 'specificity': 0.81006145, 'f1': 0.80700564, 'auroc': 0.9277576, 'binary_precision': 0.9513889, 'binary_recall': 0.65238094, 'binary_specificity': 0.9677419, 'binary_f1_score': 0.7740113}
confusion matrix:
     0    1
0  630   21
1  219  411
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8244445, 'precision': 0.8603238, 'recall': 0.8244444, 'specificity': 0.8244444, 'f1': 0.8199626, 'auroc': 0.913995, 'binary_precision': 0.97402596, 'binary_recall': 0.6666667, 'binary_specificity': 0.9822222, 'binary_f1_score': 0.7915567}
confusion matrix:
     0    1
0  221    4
1   75  150
early stop counter: 2
val acc:0.8126463890075684, best validation acc: 0.8790007829666138, corresponding to test acc:                         0.8622221946716309 / 0.8933333158493042
after epoch: 9,now: 2024-07-27 04:44:54.808825,epoch time: 0:02:24.096689,used: 0:21:49.222683,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_04_23_05_seed_1_23093151
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.99088544, 'precision': 0.99090195, 'recall': 0.9910101, 'specificity': 0.9910101, 'f1': 0.990885, 'auroc': 0.9998194, 'binary_precision': 0.9993477, 'binary_recall': 0.9826812, 'binary_specificity': 0.99933904, 'binary_f1_score': 0.9909444}
confusion matrix:
      0     1
0  1512     1
1    27  1532
---- Validation: 
scalar performance:
{'acc': 0.6971116, 'precision': 0.7938176, 'recall': 0.69234514, 'specificity': 0.69234514, 'f1': 0.6666908, 'auroc': 0.9284154, 'binary_precision': 0.9583333, 'binary_recall': 0.4015873, 'binary_specificity': 0.9831029, 'binary_f1_score': 0.5659955}
confusion matrix:
     0    1
0  640   11
1  377  253
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.68666667, 'precision': 0.80737704, 'recall': 0.68666667, 'specificity': 0.68666667, 'f1': 0.65255535, 'auroc': 0.9275062, 'binary_precision': 1.0, 'binary_recall': 0.37333333, 'binary_specificity': 1.0, 'binary_f1_score': 0.5436893}
confusion matrix:
     0   1
0  225   0
1  141  84
early stop counter: 3
val acc:0.6971116065979004, best validation acc: 0.8790007829666138, corresponding to test acc:                         0.8622221946716309 / 0.8933333158493042
after epoch: 10,now: 2024-07-27 04:47:19.790286,epoch time: 0:02:24.981461,used: 0:24:14.204144,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_04_23_05_seed_1_23093151
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9902344, 'precision': 0.99021715, 'recall': 0.9902712, 'specificity': 0.9902712, 'f1': 0.99023366, 'auroc': 0.99951255, 'binary_precision': 0.9935233, 'binary_recall': 0.98713, 'binary_specificity': 0.9934124, 'binary_f1_score': 0.9903163}
confusion matrix:
      0     1
0  1508    10
1    20  1534
---- Validation: 
scalar performance:
{'acc': 0.78688526, 'precision': 0.83444065, 'recall': 0.78376853, 'specificity': 0.78376853, 'f1': 0.7777287, 'auroc': 0.9185691, 'binary_precision': 0.95652175, 'binary_recall': 0.5936508, 'binary_specificity': 0.9738863, 'binary_f1_score': 0.7326151}
confusion matrix:
     0    1
0  634   17
1  256  374
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.82666665, 'precision': 0.85950303, 'recall': 0.82666665, 'specificity': 0.82666665, 'f1': 0.82261616, 'auroc': 0.8977975, 'binary_precision': 0.9681529, 'binary_recall': 0.6755555, 'binary_specificity': 0.9777778, 'binary_f1_score': 0.7958115}
confusion matrix:
     0    1
0  220    5
1   73  152
early stop counter: 4
val acc:0.7868852615356445, best validation acc: 0.8790007829666138, corresponding to test acc:                         0.8622221946716309 / 0.8933333158493042
after epoch: 11,now: 2024-07-27 04:49:44.071666,epoch time: 0:02:24.281380,used: 0:26:38.485524,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_04_23_05_seed_1_23093151
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9798177, 'precision': 0.9803424, 'recall': 0.9800899, 'specificity': 0.9800899, 'f1': 0.97981685, 'auroc': 0.99956715, 'binary_precision': 1.0, 'binary_recall': 0.9601798, 'binary_specificity': 1.0, 'binary_f1_score': 0.9796854}
confusion matrix:
      0     1
0  1515     0
1    62  1495
---- Validation: 
scalar performance:
{'acc': 0.53786105, 'precision': 0.70198214, 'recall': 0.53031236, 'specificity': 0.53031236, 'f1': 0.40742642, 'auroc': 0.89976597, 'binary_precision': 0.88, 'binary_recall': 0.06984127, 'binary_specificity': 0.9907834, 'binary_f1_score': 0.12941177}
confusion matrix:
     0   1
0  645   6
1  586  44
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.52444446, 'precision': 0.7178314, 'recall': 0.52444446, 'specificity': 0.52444446, 'f1': 0.38878876, 'auroc': 0.8924247, 'binary_precision': 0.9230769, 'binary_recall': 0.053333335, 'binary_specificity': 0.9955556, 'binary_f1_score': 0.10084034}
confusion matrix:
     0   1
0  224   1
1  213  12
early stop counter: 5
val acc:0.5378610491752625, best validation acc: 0.8790007829666138, corresponding to test acc:                         0.8622221946716309 / 0.8933333158493042
after epoch: 12,now: 2024-07-27 04:52:09.323368,epoch time: 0:02:25.251702,used: 0:29:03.737226,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_04_23_05_seed_1_23093151
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 12 with time: 0:29:03.737226 at 2024-07-27 04:52:09.323368
persisted model performance metric: 

scalar performance:
{'acc': 0.8622222, 'precision': 0.86792, 'recall': 0.8622222, 'specificity': 0.8622222, 'f1': 0.86168677, 'auroc': 0.9200642, 'binary_precision': 0.9137056, 'binary_recall': 0.8, 'binary_specificity': 0.92444444, 'binary_f1_score': 0.85308063}
confusion matrix:
     0    1
0  208   17
1   45  180
oracle model performance metric: 

scalar performance:
{'acc': 0.8933333, 'precision': 0.8986566, 'recall': 0.8933333, 'specificity': 0.8933333, 'f1': 0.89297605, 'auroc': 0.92454326, 'binary_precision': 0.9447236, 'binary_recall': 0.83555555, 'binary_specificity': 0.95111114, 'binary_f1_score': 0.8867924}
confusion matrix:
     0    1
0  214   11
1   37  188
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_dial_3seeds_nofreeze_2024-07-27_01-29-56/rule_results/4.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_dial_3seeds_nofreeze_2024-07-27_01-29-56/confusion_matrix/4.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 456522 KiB |   6793 MiB | 186295 GiB | 186294 GiB |
|       from large pool | 415924 KiB |   6758 MiB | 184297 GiB | 184297 GiB |
|       from small pool |  40598 KiB |     60 MiB |   1997 GiB |   1997 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 456522 KiB |   6793 MiB | 186295 GiB | 186294 GiB |
|       from large pool | 415924 KiB |   6758 MiB | 184297 GiB | 184297 GiB |
|       from small pool |  40598 KiB |     60 MiB |   1997 GiB |   1997 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 447481 KiB |   6787 MiB | 186059 GiB | 186059 GiB |
|       from large pool | 407075 KiB |   6753 MiB | 184064 GiB | 184064 GiB |
|       from small pool |  40406 KiB |     60 MiB |   1995 GiB |   1995 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   7958 MiB |   7958 MiB |  15120 MiB |   7162 MiB |
|       from large pool |   7890 MiB |   7894 MiB |  15036 MiB |   7146 MiB |
|       from small pool |     68 MiB |     68 MiB |     84 MiB |     16 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 364725 KiB |   1135 MiB | 244145 GiB | 244145 GiB |
|       from large pool | 356172 KiB |   1126 MiB | 242118 GiB | 242118 GiB |
|       from small pool |   8553 KiB |     29 MiB |   2026 GiB |   2026 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    1310    |    1702    |   26795 K  |   26794 K  |
|       from large pool |     187    |     783    |   16332 K  |   16332 K  |
|       from small pool |    1123    |    1419    |   10463 K  |   10462 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    1310    |    1702    |   26795 K  |   26794 K  |
|       from large pool |     187    |     783    |   16332 K  |   16332 K  |
|       from small pool |    1123    |    1419    |   10463 K  |   10462 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     324    |     324    |     586    |     262    |
|       from large pool |     290    |     290    |     544    |     254    |
|       from small pool |      34    |      34    |      42    |       8    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      80    |     340    |   15760 K  |   15759 K  |
|       from large pool |      35    |     294    |   11088 K  |   11088 K  |
|       from small pool |      45    |     220    |    4672 K  |    4671 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   6793 MiB | 186295 GiB | 186295 GiB |
|       from large pool |  16640 KiB |   6758 MiB | 184297 GiB | 184297 GiB |
|       from small pool |      0 KiB |     60 MiB |   1997 GiB |   1997 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   6793 MiB | 186295 GiB | 186295 GiB |
|       from large pool |  16640 KiB |   6758 MiB | 184297 GiB | 184297 GiB |
|       from small pool |      0 KiB |     60 MiB |   1997 GiB |   1997 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   6787 MiB | 186059 GiB | 186059 GiB |
|       from large pool |  16640 KiB |   6753 MiB | 184064 GiB | 184064 GiB |
|       from small pool |      0 KiB |     60 MiB |   1995 GiB |   1995 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    802 MiB |   7958 MiB |  15120 MiB |  14318 MiB |
|       from large pool |    754 MiB |   7894 MiB |  15036 MiB |  14282 MiB |
|       from small pool |     48 MiB |     68 MiB |     84 MiB |     36 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1135 MiB | 244145 GiB | 244145 GiB |
|       from large pool |  24320 KiB |   1126 MiB | 242119 GiB | 242119 GiB |
|       from small pool |      0 KiB |     32 MiB |   2026 GiB |   2026 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    1702    |   26795 K  |   26795 K  |
|       from large pool |       2    |     783    |   16332 K  |   16332 K  |
|       from small pool |       0    |    1419    |   10463 K  |   10463 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    1702    |   26795 K  |   26795 K  |
|       from large pool |       2    |     783    |   16332 K  |   16332 K  |
|       from small pool |       0    |    1419    |   10463 K  |   10463 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      59    |     324    |     586    |     527    |
|       from large pool |      35    |     290    |     544    |     509    |
|       from small pool |      24    |      34    |      42    |      18    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |     340    |   15760 K  |   15760 K  |
|       from large pool |       4    |     294    |   11088 K  |   11088 K  |
|       from small pool |       0    |     220    |    4672 K  |    4672 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   6793 MiB | 186295 GiB | 186295 GiB |
|       from large pool |  16640 KiB |   6758 MiB | 184297 GiB | 184297 GiB |
|       from small pool |      0 KiB |     60 MiB |   1997 GiB |   1997 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   6793 MiB | 186295 GiB | 186295 GiB |
|       from large pool |  16640 KiB |   6758 MiB | 184297 GiB | 184297 GiB |
|       from small pool |      0 KiB |     60 MiB |   1997 GiB |   1997 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   6787 MiB | 186059 GiB | 186059 GiB |
|       from large pool |  16640 KiB |   6753 MiB | 184064 GiB | 184064 GiB |
|       from small pool |      0 KiB |     60 MiB |   1995 GiB |   1995 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    802 MiB |   7958 MiB |  15120 MiB |  14318 MiB |
|       from large pool |    754 MiB |   7894 MiB |  15036 MiB |  14282 MiB |
|       from small pool |     48 MiB |     68 MiB |     84 MiB |     36 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1135 MiB | 244145 GiB | 244145 GiB |
|       from large pool |  24320 KiB |   1126 MiB | 242119 GiB | 242119 GiB |
|       from small pool |      0 KiB |     32 MiB |   2026 GiB |   2026 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    1702    |   26795 K  |   26795 K  |
|       from large pool |       2    |     783    |   16332 K  |   16332 K  |
|       from small pool |       0    |    1419    |   10463 K  |   10463 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    1702    |   26795 K  |   26795 K  |
|       from large pool |       2    |     783    |   16332 K  |   16332 K  |
|       from small pool |       0    |    1419    |   10463 K  |   10463 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      59    |     324    |     586    |     527    |
|       from large pool |      35    |     290    |     544    |     509    |
|       from small pool |      24    |      34    |      42    |      18    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |     340    |   15760 K  |   15760 K  |
|       from large pool |       4    |     294    |   11088 K  |   11088 K  |
|       from small pool |       0    |     220    |    4672 K  |    4672 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_04_52_44_seed_2_23093151

 Experiment start at: 2024-07-27 04:52:44.731091
before training, model accuracy: 0.41203704476356506
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9594241, 'precision': 0.9599791, 'recall': 0.95929825, 'specificity': 0.95929825, 'f1': 0.9594015, 'auroc': 0.9951967, 'binary_precision': 0.9458438, 'binary_recall': 0.9753247, 'binary_specificity': 0.94327176, 'binary_f1_score': 0.960358}
confusion matrix:
      0     1
0  1430    86
1    38  1502
---- Validation: 
scalar performance:
{'acc': 0.76760566, 'precision': 0.77355874, 'recall': 0.7694617, 'specificity': 0.7694617, 'f1': 0.76703954, 'auroc': 0.8568176, 'binary_precision': 0.72600836, 'binary_recall': 0.8392283, 'binary_specificity': 0.6996951, 'binary_f1_score': 0.7785235}
confusion matrix:
     0    1
0  459  197
1  100  522
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7291667, 'precision': 0.77861893, 'recall': 0.7291666, 'specificity': 0.7291666, 'f1': 0.71659106, 'auroc': 0.89375424, 'binary_precision': 0.6612378, 'binary_recall': 0.9398148, 'binary_specificity': 0.5185185, 'binary_f1_score': 0.77629066}
confusion matrix:
     0    1
0  112  104
1   13  203
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-27 04:55:12.790972,epoch time: 0:02:28.059881,used: 0:02:28.059881,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_04_52_44_seed_2_23093151
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.98363876, 'precision': 0.9836315, 'recall': 0.983648, 'specificity': 0.983648, 'f1': 0.98363805, 'auroc': 0.99877924, 'binary_precision': 0.98502606, 'binary_recall': 0.98246753, 'binary_specificity': 0.9848285, 'binary_f1_score': 0.9837452}
confusion matrix:
      0     1
0  1493    23
1    27  1513
---- Validation: 
scalar performance:
{'acc': 0.84428793, 'precision': 0.84643084, 'recall': 0.84319854, 'specificity': 0.84319854, 'f1': 0.84366, 'auroc': 0.90165234, 'binary_precision': 0.8678261, 'binary_recall': 0.8022508, 'binary_specificity': 0.88414633, 'binary_f1_score': 0.8337511}
confusion matrix:
     0    1
0  580   76
1  123  499
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8356481, 'precision': 0.8382655, 'recall': 0.8356482, 'specificity': 0.8356482, 'f1': 0.8353296, 'auroc': 0.9042567, 'binary_precision': 0.8680203, 'binary_recall': 0.7916667, 'binary_specificity': 0.8796296, 'binary_f1_score': 0.8280871}
confusion matrix:
     0    1
0  190   26
1   45  171
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-07-27 04:57:36.924583,epoch time: 0:02:24.133611,used: 0:04:52.193492,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_04_52_44_seed_2_23093151
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9842932, 'precision': 0.98440665, 'recall': 0.9843693, 'specificity': 0.9843693, 'f1': 0.9842931, 'auroc': 0.99856937, 'binary_precision': 0.9940397, 'binary_recall': 0.9746753, 'binary_specificity': 0.9940633, 'binary_f1_score': 0.9842623}
confusion matrix:
      0     1
0  1507     9
1    39  1501
---- Validation: 
scalar performance:
{'acc': 0.7276995, 'precision': 0.7877207, 'recall': 0.72146547, 'specificity': 0.72146547, 'f1': 0.7089958, 'auroc': 0.876139, 'binary_precision': 0.9126506, 'binary_recall': 0.48713827, 'binary_specificity': 0.95579267, 'binary_f1_score': 0.6352201}
confusion matrix:
     0    1
0  627   29
1  319  303
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7523148, 'precision': 0.8067622, 'recall': 0.7523148, 'specificity': 0.7523148, 'f1': 0.7408141, 'auroc': 0.88801014, 'binary_precision': 0.936, 'binary_recall': 0.5416667, 'binary_specificity': 0.962963, 'binary_f1_score': 0.68621707}
confusion matrix:
     0    1
0  208    8
1   99  117
early stop counter: 1
val acc:0.7276995182037354, best validation acc: 0.8442879319190979, corresponding to test acc:                         0.8356481194496155 / 0.8356481194496155
after epoch: 3,now: 2024-07-27 05:00:00.917023,epoch time: 0:02:23.992440,used: 0:07:16.185932,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_04_52_44_seed_2_23093151
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9820026, 'precision': 0.9820041, 'recall': 0.9819989, 'specificity': 0.9819989, 'f1': 0.9820014, 'auroc': 0.99762404, 'binary_precision': 0.98183, 'binary_recall': 0.98246753, 'binary_specificity': 0.98153037, 'binary_f1_score': 0.9821487}
confusion matrix:
      0     1
0  1488    28
1    27  1513
---- Validation: 
scalar performance:
{'acc': 0.86306727, 'precision': 0.8638766, 'recall': 0.8624078, 'specificity': 0.8624078, 'f1': 0.8627546, 'auroc': 0.9203206, 'binary_precision': 0.87563026, 'binary_recall': 0.83762056, 'binary_specificity': 0.8871951, 'binary_f1_score': 0.85620373}
confusion matrix:
     0    1
0  582   74
1  101  521
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8217593, 'precision': 0.82944894, 'recall': 0.8217592, 'specificity': 0.8217592, 'f1': 0.82071304, 'auroc': 0.90534973, 'binary_precision': 0.8797814, 'binary_recall': 0.7453704, 'binary_specificity': 0.8981481, 'binary_f1_score': 0.80701756}
confusion matrix:
     0    1
0  194   22
1   55  161
better model found
persisted
after epoch: 4,now: 2024-07-27 05:02:25.996760,epoch time: 0:02:25.079737,used: 0:09:41.265669,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_04_52_44_seed_2_23093151
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.97611254, 'precision': 0.97664165, 'recall': 0.97625756, 'specificity': 0.97625756, 'f1': 0.97610974, 'auroc': 0.99773324, 'binary_precision': 0.99460554, 'binary_recall': 0.9577922, 'binary_specificity': 0.99472296, 'binary_f1_score': 0.9758518}
confusion matrix:
      0     1
0  1508     8
1    65  1475
---- Validation: 
scalar performance:
{'acc': 0.80516434, 'precision': 0.8251412, 'recall': 0.8017974, 'specificity': 0.8017974, 'f1': 0.8008079, 'auroc': 0.8805486, 'binary_precision': 0.8993576, 'binary_recall': 0.6752412, 'binary_specificity': 0.92835367, 'binary_f1_score': 0.7713499}
confusion matrix:
     0    1
0  609   47
1  202  420
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8472222, 'precision': 0.84796804, 'recall': 0.8472222, 'specificity': 0.8472222, 'f1': 0.8471403, 'auroc': 0.88243747, 'binary_precision': 0.8640777, 'binary_recall': 0.8240741, 'binary_specificity': 0.8703704, 'binary_f1_score': 0.8436019}
confusion matrix:
     0    1
0  188   28
1   38  178
new oracle model saved
early stop counter: 1
val acc:0.8051643371582031, best validation acc: 0.8630672693252563, corresponding to test acc:                         0.8217592835426331 / 0.8472222089767456
after epoch: 5,now: 2024-07-27 05:04:51.186714,epoch time: 0:02:25.189954,used: 0:12:06.455623,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_04_52_44_seed_2_23093151
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9846204, 'precision': 0.98481447, 'recall': 0.98471457, 'specificity': 0.98471457, 'f1': 0.9846201, 'auroc': 0.9993018, 'binary_precision': 0.99667335, 'binary_recall': 0.9727273, 'binary_specificity': 0.99670184, 'binary_f1_score': 0.9845547}
confusion matrix:
      0     1
0  1511     5
1    42  1498
---- Validation: 
scalar performance:
{'acc': 0.7723005, 'precision': 0.8023516, 'recall': 0.7679937, 'specificity': 0.7679937, 'f1': 0.7644717, 'auroc': 0.8828205, 'binary_precision': 0.89125293, 'binary_recall': 0.6061093, 'binary_specificity': 0.92987806, 'binary_f1_score': 0.7215311}
confusion matrix:
     0    1
0  610   46
1  245  377
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7291667, 'precision': 0.7870567, 'recall': 0.7291666, 'specificity': 0.7291666, 'f1': 0.7147871, 'auroc': 0.86413324, 'binary_precision': 0.9159664, 'binary_recall': 0.5046296, 'binary_specificity': 0.9537037, 'binary_f1_score': 0.6507463}
confusion matrix:
     0    1
0  206   10
1  107  109
early stop counter: 2
val acc:0.7723004817962646, best validation acc: 0.8630672693252563, corresponding to test acc:                         0.8217592835426331 / 0.8472222089767456
after epoch: 6,now: 2024-07-27 05:07:18.083686,epoch time: 0:02:26.896972,used: 0:14:33.352595,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_04_52_44_seed_2_23093151
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9859293, 'precision': 0.98596716, 'recall': 0.9859053, 'specificity': 0.9859053, 'f1': 0.9859277, 'auroc': 0.9991249, 'binary_precision': 0.983215, 'binary_recall': 0.98896104, 'binary_specificity': 0.9828496, 'binary_f1_score': 0.98607963}
confusion matrix:
      0     1
0  1490    26
1    17  1523
---- Validation: 
scalar performance:
{'acc': 0.8169014, 'precision': 0.81764144, 'recall': 0.8161468, 'specificity': 0.8161468, 'f1': 0.81644106, 'auroc': 0.8819088, 'binary_precision': 0.8277027, 'binary_recall': 0.78778136, 'binary_specificity': 0.8445122, 'binary_f1_score': 0.80724883}
confusion matrix:
     0    1
0  554  102
1  132  490
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8101852, 'precision': 0.8123543, 'recall': 0.8101852, 'specificity': 0.8101852, 'f1': 0.8098551, 'auroc': 0.8927683, 'binary_precision': 0.7863248, 'binary_recall': 0.8518519, 'binary_specificity': 0.7685185, 'binary_f1_score': 0.81777775}
confusion matrix:
     0    1
0  166   50
1   32  184
early stop counter: 3
val acc:0.8169013857841492, best validation acc: 0.8630672693252563, corresponding to test acc:                         0.8217592835426331 / 0.8472222089767456
after epoch: 7,now: 2024-07-27 05:09:41.566949,epoch time: 0:02:23.483263,used: 0:16:56.835858,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_04_52_44_seed_2_23093151
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9846204, 'precision': 0.9847241, 'recall': 0.984694, 'specificity': 0.984694, 'f1': 0.98462033, 'auroc': 0.9987004, 'binary_precision': 0.9940437, 'binary_recall': 0.9753247, 'binary_specificity': 0.9940633, 'binary_f1_score': 0.98459524}
confusion matrix:
      0     1
0  1507     9
1    38  1502
---- Validation: 
scalar performance:
{'acc': 0.84428793, 'precision': 0.8488159, 'recall': 0.8427403, 'specificity': 0.8427403, 'f1': 0.8432699, 'auroc': 0.9116466, 'binary_precision': 0.88245934, 'binary_recall': 0.7845659, 'binary_specificity': 0.9009146, 'binary_f1_score': 0.8306383}
confusion matrix:
     0    1
0  591   65
1  134  488
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8078704, 'precision': 0.84756935, 'recall': 0.8078704, 'specificity': 0.8078704, 'f1': 0.8022229, 'auroc': 0.9135803, 'binary_precision': 0.96503496, 'binary_recall': 0.6388889, 'binary_specificity': 0.9768519, 'binary_f1_score': 0.7688023}
confusion matrix:
     0    1
0  211    5
1   78  138
early stop counter: 4
val acc:0.8442879319190979, best validation acc: 0.8630672693252563, corresponding to test acc:                         0.8217592835426331 / 0.8472222089767456
after epoch: 8,now: 2024-07-27 05:12:04.855935,epoch time: 0:02:23.288986,used: 0:19:20.124844,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_04_52_44_seed_2_23093151
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.97938484, 'precision': 0.97959703, 'recall': 0.9793142, 'specificity': 0.9793142, 'f1': 0.97937906, 'auroc': 0.9986812, 'binary_precision': 0.9712827, 'binary_recall': 0.9883117, 'binary_specificity': 0.97031665, 'binary_f1_score': 0.97972316}
confusion matrix:
      0     1
0  1471    45
1    18  1522
---- Validation: 
scalar performance:
{'acc': 0.78716743, 'precision': 0.79622483, 'recall': 0.7847252, 'specificity': 0.7847252, 'f1': 0.7844306, 'auroc': 0.8555432, 'binary_precision': 0.8417969, 'binary_recall': 0.69292605, 'binary_specificity': 0.8765244, 'binary_f1_score': 0.7601411}
confusion matrix:
     0    1
0  575   81
1  191  431
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7916667, 'precision': 0.79327583, 'recall': 0.7916666, 'specificity': 0.7916666, 'f1': 0.79138047, 'auroc': 0.8564815, 'binary_precision': 0.815, 'binary_recall': 0.7546296, 'binary_specificity': 0.8287037, 'binary_f1_score': 0.7836538}
confusion matrix:
     0    1
0  179   37
1   53  163
early stop counter: 5
val acc:0.7871674299240112, best validation acc: 0.8630672693252563, corresponding to test acc:                         0.8217592835426331 / 0.8472222089767456
after epoch: 9,now: 2024-07-27 05:14:28.024223,epoch time: 0:02:23.168288,used: 0:21:43.293132,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_04_52_44_seed_2_23093151
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 9 with time: 0:21:43.293132 at 2024-07-27 05:14:28.024223
persisted model performance metric: 

scalar performance:
{'acc': 0.8217593, 'precision': 0.82944894, 'recall': 0.8217592, 'specificity': 0.8217592, 'f1': 0.82071304, 'auroc': 0.90534973, 'binary_precision': 0.8797814, 'binary_recall': 0.7453704, 'binary_specificity': 0.8981481, 'binary_f1_score': 0.80701756}
confusion matrix:
     0    1
0  194   22
1   55  161
oracle model performance metric: 

scalar performance:
{'acc': 0.8472222, 'precision': 0.84796804, 'recall': 0.8472222, 'specificity': 0.8472222, 'f1': 0.8471403, 'auroc': 0.88243747, 'binary_precision': 0.8640777, 'binary_recall': 0.8240741, 'binary_specificity': 0.8703704, 'binary_f1_score': 0.8436019}
confusion matrix:
     0    1
0  188   28
1   38  178
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_dial_3seeds_nofreeze_2024-07-27_01-29-56/rule_results/4.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_dial_3seeds_nofreeze_2024-07-27_01-29-56/confusion_matrix/4.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 458732 KiB |   6793 MiB | 243856 GiB | 243856 GiB |
|       from large pool | 418140 KiB |   6758 MiB | 241242 GiB | 241241 GiB |
|       from small pool |  40592 KiB |     60 MiB |   2614 GiB |   2614 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 458732 KiB |   6793 MiB | 243856 GiB | 243856 GiB |
|       from large pool | 418140 KiB |   6758 MiB | 241242 GiB | 241241 GiB |
|       from small pool |  40592 KiB |     60 MiB |   2614 GiB |   2614 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 447481 KiB |   6787 MiB | 243575 GiB | 243574 GiB |
|       from large pool | 407075 KiB |   6753 MiB | 240964 GiB | 240963 GiB |
|       from small pool |  40406 KiB |     60 MiB |   2611 GiB |   2611 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   7954 MiB |   7958 MiB |  22272 MiB |  14318 MiB |
|       from large pool |   7890 MiB |   7894 MiB |  22172 MiB |  14282 MiB |
|       from small pool |     64 MiB |     68 MiB |    100 MiB |     36 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 382995 KiB |   1135 MiB | 319526 GiB | 319525 GiB |
|       from large pool | 374436 KiB |   1126 MiB | 316873 GiB | 316873 GiB |
|       from small pool |   8559 KiB |     32 MiB |   2652 GiB |   2652 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    1298    |    1702    |   35079 K  |   35078 K  |
|       from large pool |     187    |     783    |   21380 K  |   21380 K  |
|       from small pool |    1111    |    1419    |   13698 K  |   13697 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    1298    |    1702    |   35079 K  |   35078 K  |
|       from large pool |     187    |     783    |   21380 K  |   21380 K  |
|       from small pool |    1111    |    1419    |   13698 K  |   13697 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     322    |     324    |     849    |     527    |
|       from large pool |     290    |     290    |     799    |     509    |
|       from small pool |      32    |      34    |      50    |      18    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      79    |     340    |   20832 K  |   20832 K  |
|       from large pool |      36    |     294    |   14715 K  |   14715 K  |
|       from small pool |      43    |     221    |    6116 K  |    6116 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   6793 MiB | 243856 GiB | 243856 GiB |
|       from large pool |  16640 KiB |   6758 MiB | 241242 GiB | 241242 GiB |
|       from small pool |      0 KiB |     60 MiB |   2614 GiB |   2614 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   6793 MiB | 243856 GiB | 243856 GiB |
|       from large pool |  16640 KiB |   6758 MiB | 241242 GiB | 241242 GiB |
|       from small pool |      0 KiB |     60 MiB |   2614 GiB |   2614 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   6787 MiB | 243575 GiB | 243575 GiB |
|       from large pool |  16640 KiB |   6753 MiB | 240964 GiB | 240964 GiB |
|       from small pool |      0 KiB |     60 MiB |   2611 GiB |   2611 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    822 MiB |   7958 MiB |  22272 MiB |  21450 MiB |
|       from large pool |    774 MiB |   7894 MiB |  22172 MiB |  21398 MiB |
|       from small pool |     48 MiB |     68 MiB |    100 MiB |     52 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1135 MiB | 319526 GiB | 319526 GiB |
|       from large pool |  24320 KiB |   1126 MiB | 316873 GiB | 316873 GiB |
|       from small pool |      0 KiB |     32 MiB |   2652 GiB |   2652 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    1702    |   35079 K  |   35079 K  |
|       from large pool |       2    |     783    |   21380 K  |   21380 K  |
|       from small pool |       0    |    1419    |   13698 K  |   13698 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    1702    |   35079 K  |   35079 K  |
|       from large pool |       2    |     783    |   21380 K  |   21380 K  |
|       from small pool |       0    |    1419    |   13698 K  |   13698 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      60    |     324    |     849    |     789    |
|       from large pool |      36    |     290    |     799    |     763    |
|       from small pool |      24    |      34    |      50    |      26    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |     340    |   20832 K  |   20832 K  |
|       from large pool |       4    |     294    |   14715 K  |   14715 K  |
|       from small pool |       0    |     221    |    6116 K  |    6116 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Sat Jul 27 05:14:35 2024]
Finished job 0.
1 of 1 steps (100%) done
