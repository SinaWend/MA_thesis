Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Sat Jul 27 03:42:30 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_dial_3seeds_nofreeze_2024-07-27_01-29-56/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_dial_3seeds_nofreeze_2024-07-27_01-29-56/rule_results/0.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=0
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/swiglu_ffn.py:51: UserWarning: xFormers is not available (SwiGLU)
  warnings.warn("xFormers is not available (SwiGLU)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/attention.py:33: UserWarning: xFormers is not available (Attention)
  warnings.warn("xFormers is not available (Attention)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/block.py:40: UserWarning: xFormers is not available (Block)
  warnings.warn("xFormers is not available (Block)")
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_03_43_08_seed_0_23093152

 Experiment start at: 2024-07-27 03:43:08.882164
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
before training, model accuracy: 0.569767415523529
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9270833, 'precision': 0.92868745, 'recall': 0.9266869, 'specificity': 0.9266869, 'f1': 0.92695653, 'auroc': 0.9867101, 'binary_precision': 0.9056604, 'binary_recall': 0.955684, 'binary_specificity': 0.89768976, 'binary_f1_score': 0.93}
confusion matrix:
      0     1
0  1360   155
1    69  1488
---- Validation: 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
scalar performance:
{'acc': 0.7864907, 'precision': 0.790467, 'recall': 0.7872846, 'specificity': 0.7872846, 'f1': 0.78604174, 'auroc': 0.85880065, 'binary_precision': 0.752809, 'binary_recall': 0.8440945, 'binary_specificity': 0.7304747, 'binary_f1_score': 0.79584265}
confusion matrix:
     0    1
0  477  176
1   99  536
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8023256, 'precision': 0.80248916, 'recall': 0.8023256, 'specificity': 0.8023256, 'f1': 0.80229884, 'auroc': 0.8840455, 'binary_precision': 0.79545456, 'binary_recall': 0.81395346, 'binary_specificity': 0.7906977, 'binary_f1_score': 0.8045977}
confusion matrix:
     0    1
0  170   45
1   40  175
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-27 03:45:37.269729,epoch time: 0:02:28.387565,used: 0:02:28.387565,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_03_43_08_seed_0_23093152
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.976888, 'precision': 0.9771712, 'recall': 0.9771018, 'specificity': 0.9771018, 'f1': 0.9768879, 'auroc': 0.9977646, 'binary_precision': 0.9927056, 'binary_recall': 0.96146435, 'binary_specificity': 0.99273926, 'binary_f1_score': 0.9768352}
confusion matrix:
      0     1
0  1504    11
1    60  1497
---- Validation: 
scalar performance:
{'acc': 0.6467391, 'precision': 0.76625246, 'recall': 0.64199275, 'specificity': 0.64199275, 'f1': 0.59787095, 'auroc': 0.8717127, 'binary_precision': 0.9411765, 'binary_recall': 0.3023622, 'binary_specificity': 0.9816233, 'binary_f1_score': 0.45768777}
confusion matrix:
     0    1
0  641   12
1  443  192
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.80465114, 'precision': 0.85651, 'recall': 0.80465114, 'specificity': 0.80465114, 'f1': 0.79727906, 'auroc': 0.922012, 'binary_precision': 0.99248123, 'binary_recall': 0.6139535, 'binary_specificity': 0.9953488, 'binary_f1_score': 0.7586207}
confusion matrix:
     0    1
0  214    1
1   83  132
new oracle model saved
early stop counter: 1
val acc:0.64673912525177, best validation acc: 0.7864906787872314, corresponding to test acc:                         0.8023256063461304 / 0.804651141166687
after epoch: 2,now: 2024-07-27 03:48:01.948546,epoch time: 0:02:24.678817,used: 0:04:53.066382,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_03_43_08_seed_0_23093152
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.96484375, 'precision': 0.96646714, 'recall': 0.9652411, 'specificity': 0.9652411, 'f1': 0.96482944, 'auroc': 0.9972216, 'binary_precision': 0.99725085, 'binary_recall': 0.933119, 'binary_specificity': 0.9973632, 'binary_f1_score': 0.9641196}
confusion matrix:
      0     1
0  1513     4
1   104  1451
---- Validation: 
scalar performance:
{'acc': 0.61102486, 'precision': 0.73333335, 'recall': 0.6058808, 'specificity': 0.6058808, 'f1': 0.5467589, 'auroc': 0.85398704, 'binary_precision': 0.89880955, 'binary_recall': 0.23779528, 'binary_specificity': 0.9739663, 'binary_f1_score': 0.3760897}
confusion matrix:
     0    1
0  636   17
1  484  151
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7860465, 'precision': 0.83201504, 'recall': 0.7860465, 'specificity': 0.7860465, 'f1': 0.7783754, 'auroc': 0.90338564, 'binary_precision': 0.95555556, 'binary_recall': 0.6, 'binary_specificity': 0.97209305, 'binary_f1_score': 0.7371429}
confusion matrix:
     0    1
0  209    6
1   86  129
early stop counter: 2
val acc:0.6110248565673828, best validation acc: 0.7864906787872314, corresponding to test acc:                         0.8023256063461304 / 0.804651141166687
after epoch: 3,now: 2024-07-27 03:50:25.837880,epoch time: 0:02:23.889334,used: 0:07:16.955716,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_03_43_08_seed_0_23093152
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.87630206, 'precision': 0.9014765, 'recall': 0.87484294, 'specificity': 0.87484294, 'f1': 0.87401396, 'auroc': 0.9968779, 'binary_precision': 0.8038302, 'binary_recall': 0.9993565, 'binary_specificity': 0.7503294, 'binary_f1_score': 0.8909926}
confusion matrix:
      0     1
0  1139   379
1     1  1553
---- Validation: 
scalar performance:
{'acc': 0.6886646, 'precision': 0.7692106, 'recall': 0.69243467, 'specificity': 0.69243467, 'f1': 0.6660751, 'auroc': 0.886001, 'binary_precision': 0.6184211, 'binary_recall': 0.9622047, 'binary_specificity': 0.4226646, 'binary_f1_score': 0.75292665}
confusion matrix:
     0    1
0  276  377
1   24  611
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5767442, 'precision': 0.7566004, 'recall': 0.5767442, 'specificity': 0.5767442, 'f1': 0.48681965, 'auroc': 0.92863166, 'binary_precision': 0.5417721, 'binary_recall': 0.9953488, 'binary_specificity': 0.15813954, 'binary_f1_score': 0.7016393}
confusion matrix:
    0    1
0  34  181
1   1  214
early stop counter: 3
val acc:0.6886646151542664, best validation acc: 0.7864906787872314, corresponding to test acc:                         0.8023256063461304 / 0.804651141166687
after epoch: 4,now: 2024-07-27 03:52:49.691455,epoch time: 0:02:23.853575,used: 0:09:40.809291,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_03_43_08_seed_0_23093152
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.97786456, 'precision': 0.97802615, 'recall': 0.97776675, 'specificity': 0.97776675, 'f1': 0.97785497, 'auroc': 0.9978905, 'binary_precision': 0.9721166, 'binary_recall': 0.98459566, 'binary_specificity': 0.9709379, 'binary_f1_score': 0.9783163}
confusion matrix:
      0     1
0  1470    44
1    24  1534
---- Validation: 
scalar performance:
{'acc': 0.8152174, 'precision': 0.81518126, 'recall': 0.81518126, 'specificity': 0.81518126, 'f1': 0.81518126, 'auroc': 0.89826, 'binary_precision': 0.8125984, 'binary_recall': 0.8125984, 'binary_specificity': 0.81776416, 'binary_f1_score': 0.8125984}
confusion matrix:
     0    1
0  534  119
1  119  516
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8116279, 'precision': 0.8131522, 'recall': 0.81162786, 'specificity': 0.81162786, 'f1': 0.8113984, 'auroc': 0.87885344, 'binary_precision': 0.79130435, 'binary_recall': 0.8465116, 'binary_specificity': 0.7767442, 'binary_f1_score': 0.81797755}
confusion matrix:
     0    1
0  167   48
1   33  182
new oracle model saved
better model found
persisted
after epoch: 5,now: 2024-07-27 03:55:13.956022,epoch time: 0:02:24.264567,used: 0:12:05.073858,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_03_43_08_seed_0_23093152
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.98307294, 'precision': 0.9830698, 'recall': 0.9830698, 'specificity': 0.9830698, 'f1': 0.9830698, 'auroc': 0.9982716, 'binary_precision': 0.9833012, 'binary_recall': 0.9833012, 'binary_specificity': 0.9828383, 'binary_f1_score': 0.9833012}
confusion matrix:
      0     1
0  1489    26
1    26  1531
---- Validation: 
scalar performance:
{'acc': 0.7414596, 'precision': 0.79367614, 'recall': 0.74437183, 'specificity': 0.74437183, 'f1': 0.7309123, 'auroc': 0.9109832, 'binary_precision': 0.6662996, 'binary_recall': 0.9527559, 'binary_specificity': 0.53598773, 'binary_f1_score': 0.78418666}
confusion matrix:
     0    1
0  350  303
1   30  605
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7651163, 'precision': 0.81994045, 'recall': 0.76511633, 'specificity': 0.76511633, 'f1': 0.7546037, 'auroc': 0.93791234, 'binary_precision': 0.6875, 'binary_recall': 0.97209305, 'binary_specificity': 0.55813956, 'binary_f1_score': 0.805395}
confusion matrix:
     0    1
0  120   95
1    6  209
early stop counter: 1
val acc:0.7414596080780029, best validation acc: 0.8152173757553101, corresponding to test acc:                         0.8116279244422913 / 0.8116279244422913
after epoch: 6,now: 2024-07-27 03:57:37.634974,epoch time: 0:02:23.678952,used: 0:14:28.752810,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_03_43_08_seed_0_23093152
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9749349, 'precision': 0.9759151, 'recall': 0.9746721, 'specificity': 0.9746721, 'f1': 0.97490776, 'auroc': 0.9989177, 'binary_precision': 0.9573284, 'binary_recall': 0.9948586, 'binary_specificity': 0.9544855, 'binary_f1_score': 0.97573274}
confusion matrix:
      0     1
0  1447    69
1     8  1548
---- Validation: 
scalar performance:
{'acc': 0.77251554, 'precision': 0.7909448, 'recall': 0.7707239, 'specificity': 0.7707239, 'f1': 0.7680353, 'auroc': 0.88759327, 'binary_precision': 0.8607595, 'binary_recall': 0.6425197, 'binary_specificity': 0.89892805, 'binary_f1_score': 0.735798}
confusion matrix:
     0    1
0  587   66
1  227  408
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8255814, 'precision': 0.8466464, 'recall': 0.82558143, 'specificity': 0.82558143, 'f1': 0.82289076, 'auroc': 0.92478096, 'binary_precision': 0.93209875, 'binary_recall': 0.7023256, 'binary_specificity': 0.9488372, 'binary_f1_score': 0.80106103}
confusion matrix:
     0    1
0  204   11
1   64  151
new oracle model saved
early stop counter: 2
val acc:0.7725155353546143, best validation acc: 0.8152173757553101, corresponding to test acc:                         0.8116279244422913 / 0.8255813717842102
after epoch: 7,now: 2024-07-27 04:00:01.327613,epoch time: 0:02:23.692639,used: 0:16:52.445449,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_03_43_08_seed_0_23093152
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9840495, 'precision': 0.98430395, 'recall': 0.9842557, 'specificity': 0.9842557, 'f1': 0.98404944, 'auroc': 0.9990182, 'binary_precision': 0.99933773, 'binary_recall': 0.96917146, 'binary_specificity': 0.99933994, 'binary_f1_score': 0.9840235}
confusion matrix:
      0     1
0  1514     1
1    48  1509
---- Validation: 
scalar performance:
{'acc': 0.7243789, 'precision': 0.8019823, 'recall': 0.720798, 'specificity': 0.720798, 'f1': 0.70334035, 'auroc': 0.9194294, 'binary_precision': 0.9516129, 'binary_recall': 0.46456692, 'binary_specificity': 0.9770291, 'binary_f1_score': 0.6243386}
confusion matrix:
     0    1
0  638   15
1  340  295
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7255814, 'precision': 0.81380725, 'recall': 0.7255814, 'specificity': 0.7255814, 'f1': 0.7048353, 'auroc': 0.9216658, 'binary_precision': 0.980198, 'binary_recall': 0.4604651, 'binary_specificity': 0.9906977, 'binary_f1_score': 0.62658226}
confusion matrix:
     0   1
0  213   2
1  116  99
early stop counter: 3
val acc:0.7243788838386536, best validation acc: 0.8152173757553101, corresponding to test acc:                         0.8116279244422913 / 0.8255813717842102
after epoch: 8,now: 2024-07-27 04:02:26.187101,epoch time: 0:02:24.859488,used: 0:19:17.304937,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_03_43_08_seed_0_23093152
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.984375, 'precision': 0.984624, 'recall': 0.98456734, 'specificity': 0.98456734, 'f1': 0.98437494, 'auroc': 0.99898005, 'binary_precision': 0.99933773, 'binary_recall': 0.96979433, 'binary_specificity': 0.99934036, 'binary_f1_score': 0.9843444}
confusion matrix:
      0     1
0  1515     1
1    47  1509
---- Validation: 
scalar performance:
{'acc': 0.7880435, 'precision': 0.8272947, 'recall': 0.78560364, 'specificity': 0.78560364, 'f1': 0.7804851, 'auroc': 0.9222396, 'binary_precision': 0.93719804, 'binary_recall': 0.6110236, 'binary_specificity': 0.96018374, 'binary_f1_score': 0.7397522}
confusion matrix:
     0    1
0  627   26
1  247  388
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.81395346, 'precision': 0.84447765, 'recall': 0.81395346, 'specificity': 0.81395346, 'f1': 0.8097387, 'auroc': 0.91439694, 'binary_precision': 0.9470199, 'binary_recall': 0.66511625, 'binary_specificity': 0.96279067, 'binary_f1_score': 0.7814207}
confusion matrix:
     0    1
0  207    8
1   72  143
early stop counter: 4
val acc:0.7880434989929199, best validation acc: 0.8152173757553101, corresponding to test acc:                         0.8116279244422913 / 0.8255813717842102
after epoch: 9,now: 2024-07-27 04:04:50.304456,epoch time: 0:02:24.117355,used: 0:21:41.422292,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_03_43_08_seed_0_23093152
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9905599, 'precision': 0.99053377, 'recall': 0.9906093, 'specificity': 0.9906093, 'f1': 0.99055874, 'auroc': 0.9997639, 'binary_precision': 0.9941823, 'binary_recall': 0.987163, 'binary_specificity': 0.9940555, 'binary_f1_score': 0.9906602}
confusion matrix:
      0     1
0  1505     9
1    20  1538
---- Validation: 
scalar performance:
{'acc': 0.81444097, 'precision': 0.8463223, 'recall': 0.8123102, 'specificity': 0.8123102, 'f1': 0.8093238, 'auroc': 0.9247422, 'binary_precision': 0.9479638, 'binary_recall': 0.6598425, 'binary_specificity': 0.96477795, 'binary_f1_score': 0.77808726}
confusion matrix:
     0    1
0  630   23
1  216  419
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8767442, 'precision': 0.8992069, 'recall': 0.87674415, 'specificity': 0.87674415, 'f1': 0.8749856, 'auroc': 0.9509573, 'binary_precision': 0.99390244, 'binary_recall': 0.75813955, 'binary_specificity': 0.9953488, 'binary_f1_score': 0.86015826}
confusion matrix:
     0    1
0  214    1
1   52  163
new oracle model saved
early stop counter: 5
val acc:0.8144409656524658, best validation acc: 0.8152173757553101, corresponding to test acc:                         0.8116279244422913 / 0.8767442107200623
after epoch: 10,now: 2024-07-27 04:07:14.255092,epoch time: 0:02:23.950636,used: 0:24:05.372928,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_03_43_08_seed_0_23093152
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 10 with time: 0:24:05.372928 at 2024-07-27 04:07:14.255092
persisted model performance metric: 

scalar performance:
{'acc': 0.8116279, 'precision': 0.8131522, 'recall': 0.81162786, 'specificity': 0.81162786, 'f1': 0.8113984, 'auroc': 0.87885344, 'binary_precision': 0.79130435, 'binary_recall': 0.8465116, 'binary_specificity': 0.7767442, 'binary_f1_score': 0.81797755}
confusion matrix:
     0    1
0  167   48
1   33  182
oracle model performance metric: 

scalar performance:
{'acc': 0.8767442, 'precision': 0.8992069, 'recall': 0.87674415, 'specificity': 0.87674415, 'f1': 0.8749856, 'auroc': 0.9509573, 'binary_precision': 0.99390244, 'binary_recall': 0.75813955, 'binary_specificity': 0.9953488, 'binary_f1_score': 0.86015826}
confusion matrix:
     0    1
0  214    1
1   52  163
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_dial_3seeds_nofreeze_2024-07-27_01-29-56/rule_results/0.csv
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_dial_3seeds_nofreeze_2024-07-27_01-29-56/rule_results/0.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_dial_3seeds_nofreeze_2024-07-27_01-29-56/confusion_matrix/0.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 455874 KiB |   6793 MiB |  64290 GiB |  64290 GiB |
|       from large pool | 415281 KiB |   6758 MiB |  63601 GiB |  63601 GiB |
|       from small pool |  40592 KiB |     56 MiB |    688 GiB |    688 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 455874 KiB |   6793 MiB |  64290 GiB |  64290 GiB |
|       from large pool | 415281 KiB |   6758 MiB |  63601 GiB |  63601 GiB |
|       from small pool |  40592 KiB |     56 MiB |    688 GiB |    688 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 447480 KiB |   6787 MiB |  64213 GiB |  64213 GiB |
|       from large pool | 407075 KiB |   6753 MiB |  63525 GiB |  63525 GiB |
|       from small pool |  40405 KiB |     56 MiB |    687 GiB |    687 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   7958 MiB |   7958 MiB |   7958 MiB |      0 B   |
|       from large pool |   7894 MiB |   7894 MiB |   7894 MiB |      0 B   |
|       from small pool |     64 MiB |     64 MiB |     64 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory | 359230 KiB |   1135 MiB |  84305 GiB |  84304 GiB |
|       from large pool | 350670 KiB |   1126 MiB |  83606 GiB |  83605 GiB |
|       from small pool |   8559 KiB |     13 MiB |    698 GiB |    698 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    1298    |    1698    |    9249 K  |    9248 K  |
|       from large pool |     187    |     783    |    5637 K  |    5637 K  |
|       from small pool |    1111    |    1407    |    3611 K  |    3610 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    1298    |    1698    |    9249 K  |    9248 K  |
|       from large pool |     187    |     783    |    5637 K  |    5637 K  |
|       from small pool |    1111    |    1407    |    3611 K  |    3610 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     321    |     321    |     321    |       0    |
|       from large pool |     289    |     289    |     289    |       0    |
|       from small pool |      32    |      32    |      32    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      78    |     340    |    5288 K  |    5288 K  |
|       from large pool |      33    |     290    |    3681 K  |    3681 K  |
|       from small pool |      45    |     219    |    1607 K  |    1606 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   6793 MiB |  64290 GiB |  64290 GiB |
|       from large pool |  16640 KiB |   6758 MiB |  63601 GiB |  63601 GiB |
|       from small pool |      0 KiB |     56 MiB |    688 GiB |    688 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   6793 MiB |  64290 GiB |  64290 GiB |
|       from large pool |  16640 KiB |   6758 MiB |  63601 GiB |  63601 GiB |
|       from small pool |      0 KiB |     56 MiB |    688 GiB |    688 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   6787 MiB |  64213 GiB |  64213 GiB |
|       from large pool |  16640 KiB |   6753 MiB |  63525 GiB |  63525 GiB |
|       from small pool |      0 KiB |     56 MiB |    687 GiB |    687 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    796 MiB |   7958 MiB |   7958 MiB |   7162 MiB |
|       from large pool |    748 MiB |   7894 MiB |   7894 MiB |   7146 MiB |
|       from small pool |     48 MiB |     64 MiB |     64 MiB |     16 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1135 MiB |  84305 GiB |  84305 GiB |
|       from large pool |  24320 KiB |   1126 MiB |  83606 GiB |  83606 GiB |
|       from small pool |      0 KiB |     28 MiB |    698 GiB |    698 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    1698    |    9249 K  |    9249 K  |
|       from large pool |       2    |     783    |    5637 K  |    5637 K  |
|       from small pool |       0    |    1407    |    3611 K  |    3611 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    1698    |    9249 K  |    9249 K  |
|       from large pool |       2    |     783    |    5637 K  |    5637 K  |
|       from small pool |       0    |    1407    |    3611 K  |    3611 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      59    |     321    |     321    |     262    |
|       from large pool |      35    |     289    |     289    |     254    |
|       from small pool |      24    |      32    |      32    |       8    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |     340    |    5288 K  |    5288 K  |
|       from large pool |       4    |     290    |    3681 K  |    3681 K  |
|       from small pool |       0    |     219    |    1607 K  |    1607 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   6793 MiB |  64290 GiB |  64290 GiB |
|       from large pool |  16640 KiB |   6758 MiB |  63601 GiB |  63601 GiB |
|       from small pool |      0 KiB |     56 MiB |    688 GiB |    688 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   6793 MiB |  64290 GiB |  64290 GiB |
|       from large pool |  16640 KiB |   6758 MiB |  63601 GiB |  63601 GiB |
|       from small pool |      0 KiB |     56 MiB |    688 GiB |    688 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   6787 MiB |  64213 GiB |  64213 GiB |
|       from large pool |  16640 KiB |   6753 MiB |  63525 GiB |  63525 GiB |
|       from small pool |      0 KiB |     56 MiB |    687 GiB |    687 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    796 MiB |   7958 MiB |   7958 MiB |   7162 MiB |
|       from large pool |    748 MiB |   7894 MiB |   7894 MiB |   7146 MiB |
|       from small pool |     48 MiB |     64 MiB |     64 MiB |     16 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1135 MiB |  84305 GiB |  84305 GiB |
|       from large pool |  24320 KiB |   1126 MiB |  83606 GiB |  83606 GiB |
|       from small pool |      0 KiB |     28 MiB |    698 GiB |    698 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    1698    |    9249 K  |    9249 K  |
|       from large pool |       2    |     783    |    5637 K  |    5637 K  |
|       from small pool |       0    |    1407    |    3611 K  |    3611 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    1698    |    9249 K  |    9249 K  |
|       from large pool |       2    |     783    |    5637 K  |    5637 K  |
|       from small pool |       0    |    1407    |    3611 K  |    3611 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      59    |     321    |     321    |     262    |
|       from large pool |      35    |     289    |     289    |     254    |
|       from small pool |      24    |      32    |      32    |       8    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |     340    |    5288 K  |    5288 K  |
|       from large pool |       4    |     290    |    3681 K  |    3681 K  |
|       from small pool |       0    |     219    |    1607 K  |    1607 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_04_07_49_seed_1_23093152

 Experiment start at: 2024-07-27 04:07:49.648193
before training, model accuracy: 0.6177777647972107
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9111328, 'precision': 0.923743, 'recall': 0.9122187, 'specificity': 0.9122187, 'f1': 0.9106097, 'auroc': 0.9956802, 'binary_precision': 1.0, 'binary_recall': 0.8244373, 'binary_specificity': 1.0, 'binary_f1_score': 0.9037716}
confusion matrix:
      0     1
0  1517     0
1   273  1282
---- Validation: 
scalar performance:
{'acc': 0.55971897, 'precision': 0.7243599, 'recall': 0.55256015, 'specificity': 0.55256015, 'f1': 0.4505491, 'auroc': 0.8696511, 'binary_precision': 0.9125, 'binary_recall': 0.11587302, 'binary_specificity': 0.9892473, 'binary_f1_score': 0.20563382}
confusion matrix:
     0   1
0  644   7
1  557  73
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.72, 'precision': 0.81596637, 'recall': 0.72, 'specificity': 0.72, 'f1': 0.6969924, 'auroc': 0.9106568, 'binary_precision': 0.990099, 'binary_recall': 0.44444445, 'binary_specificity': 0.9955556, 'binary_f1_score': 0.61349696}
confusion matrix:
     0    1
0  224    1
1  125  100
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-27 04:10:17.251501,epoch time: 0:02:27.603308,used: 0:02:27.603308,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_04_07_49_seed_1_23093152
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9560547, 'precision': 0.9587808, 'recall': 0.9565332, 'specificity': 0.9565332, 'f1': 0.95601606, 'auroc': 0.99716866, 'binary_precision': 0.9971969, 'binary_recall': 0.9157014, 'binary_specificity': 0.99736494, 'binary_f1_score': 0.95471317}
confusion matrix:
      0     1
0  1514     4
1   131  1423
---- Validation: 
scalar performance:
{'acc': 0.7080406, 'precision': 0.7865208, 'recall': 0.70368665, 'specificity': 0.70368665, 'f1': 0.683753, 'auroc': 0.9013508, 'binary_precision': 0.9324324, 'binary_recall': 0.43809524, 'binary_specificity': 0.96927804, 'binary_f1_score': 0.5961123}
confusion matrix:
     0    1
0  631   20
1  354  276
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7355555, 'precision': 0.8150095, 'recall': 0.7355555, 'specificity': 0.7355555, 'f1': 0.7177583, 'auroc': 0.903842, 'binary_precision': 0.97321427, 'binary_recall': 0.48444444, 'binary_specificity': 0.9866667, 'binary_f1_score': 0.64688426}
confusion matrix:
     0    1
0  222    3
1  116  109
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-07-27 04:12:42.268416,epoch time: 0:02:25.016915,used: 0:04:52.620223,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_04_07_49_seed_1_23093152
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9811198, 'precision': 0.98128617, 'recall': 0.98128617, 'specificity': 0.98128617, 'f1': 0.9811198, 'auroc': 0.99816656, 'binary_precision': 0.9940633, 'binary_recall': 0.968509, 'binary_specificity': 0.9940633, 'binary_f1_score': 0.9811198}
confusion matrix:
      0     1
0  1507     9
1    49  1507
---- Validation: 
scalar performance:
{'acc': 0.8540203, 'precision': 0.85932916, 'recall': 0.853021, 'specificity': 0.853021, 'f1': 0.8531958, 'auroc': 0.91652644, 'binary_precision': 0.8990991, 'binary_recall': 0.7920635, 'binary_specificity': 0.9139785, 'binary_f1_score': 0.8421941}
confusion matrix:
     0    1
0  595   56
1  131  499
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.83555555, 'precision': 0.8365128, 'recall': 0.83555555, 'specificity': 0.83555555, 'f1': 0.83543855, 'auroc': 0.9184593, 'binary_precision': 0.8544601, 'binary_recall': 0.8088889, 'binary_specificity': 0.8622222, 'binary_f1_score': 0.8310502}
confusion matrix:
     0    1
0  194   31
1   43  182
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-07-27 04:15:07.565854,epoch time: 0:02:25.297438,used: 0:07:17.917661,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_04_07_49_seed_1_23093152
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9765625, 'precision': 0.97689474, 'recall': 0.9767896, 'specificity': 0.9767896, 'f1': 0.97656226, 'auroc': 0.99819577, 'binary_precision': 0.99335545, 'binary_recall': 0.9601798, 'binary_specificity': 0.9933993, 'binary_f1_score': 0.9764859}
confusion matrix:
      0     1
0  1505    10
1    62  1495
---- Validation: 
scalar performance:
{'acc': 0.82045275, 'precision': 0.8386693, 'recall': 0.81853557, 'specificity': 0.81853557, 'f1': 0.81734854, 'auroc': 0.90419376, 'binary_precision': 0.91322315, 'binary_recall': 0.7015873, 'binary_specificity': 0.9354839, 'binary_f1_score': 0.7935368}
confusion matrix:
     0    1
0  609   42
1  188  442
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.85555553, 'precision': 0.8677672, 'recall': 0.85555553, 'specificity': 0.85555553, 'f1': 0.85434645, 'auroc': 0.91723454, 'binary_precision': 0.9347826, 'binary_recall': 0.7644445, 'binary_specificity': 0.94666666, 'binary_f1_score': 0.84107584}
confusion matrix:
     0    1
0  213   12
1   53  172
new oracle model saved
early stop counter: 1
val acc:0.8204527497291565, best validation acc: 0.8540202975273132, corresponding to test acc:                         0.8355555534362793 / 0.855555534362793
after epoch: 4,now: 2024-07-27 04:17:32.909649,epoch time: 0:02:25.343795,used: 0:09:43.261456,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_04_07_49_seed_1_23093152
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.97558594, 'precision': 0.9761854, 'recall': 0.9758574, 'specificity': 0.9758574, 'f1': 0.9755843, 'auroc': 0.9980762, 'binary_precision': 0.9966465, 'binary_recall': 0.95501286, 'binary_specificity': 0.99670184, 'binary_f1_score': 0.9753856}
confusion matrix:
      0     1
0  1511     5
1    70  1486
---- Validation: 
scalar performance:
{'acc': 0.7978142, 'precision': 0.8179091, 'recall': 0.7957245, 'specificity': 0.7957245, 'f1': 0.7937417, 'auroc': 0.8906249, 'binary_precision': 0.8938429, 'binary_recall': 0.66825396, 'binary_specificity': 0.92319506, 'binary_f1_score': 0.7647593}
confusion matrix:
     0    1
0  601   50
1  209  421
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8488889, 'precision': 0.8543769, 'recall': 0.8488889, 'specificity': 0.8488889, 'f1': 0.84830153, 'auroc': 0.9257679, 'binary_precision': 0.89847714, 'binary_recall': 0.7866667, 'binary_specificity': 0.9111111, 'binary_f1_score': 0.83886254}
confusion matrix:
     0    1
0  205   20
1   48  177
early stop counter: 2
val acc:0.7978141903877258, best validation acc: 0.8540202975273132, corresponding to test acc:                         0.8355555534362793 / 0.855555534362793
after epoch: 5,now: 2024-07-27 04:19:58.745911,epoch time: 0:02:25.836262,used: 0:12:09.097718,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_04_07_49_seed_1_23093152
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9899089, 'precision': 0.98989797, 'recall': 0.9899792, 'specificity': 0.9899792, 'f1': 0.9899083, 'auroc': 0.9995328, 'binary_precision': 0.99545157, 'binary_recall': 0.9845758, 'binary_specificity': 0.9953826, 'binary_f1_score': 0.9899838}
confusion matrix:
      0     1
0  1509     7
1    24  1532
---- Validation: 
scalar performance:
{'acc': 0.80249804, 'precision': 0.83878064, 'recall': 0.7997952, 'specificity': 0.7997952, 'f1': 0.7960367, 'auroc': 0.928452, 'binary_precision': 0.9456265, 'binary_recall': 0.63492066, 'binary_specificity': 0.96466976, 'binary_f1_score': 0.75973415}
confusion matrix:
     0    1
0  628   23
1  230  400
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7977778, 'precision': 0.84735024, 'recall': 0.7977778, 'specificity': 0.7977778, 'f1': 0.7902957, 'auroc': 0.92598516, 'binary_precision': 0.9785714, 'binary_recall': 0.60888886, 'binary_specificity': 0.9866667, 'binary_f1_score': 0.7506849}
confusion matrix:
     0    1
0  222    3
1   88  137
early stop counter: 3
val acc:0.8024980425834656, best validation acc: 0.8540202975273132, corresponding to test acc:                         0.8355555534362793 / 0.855555534362793
after epoch: 6,now: 2024-07-27 04:22:24.902845,epoch time: 0:02:26.156934,used: 0:14:35.254652,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_04_07_49_seed_1_23093152
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9866536, 'precision': 0.98677087, 'recall': 0.98679256, 'specificity': 0.98679256, 'f1': 0.9866536, 'auroc': 0.9991746, 'binary_precision': 0.9980263, 'binary_recall': 0.9755627, 'binary_specificity': 0.99802244, 'binary_f1_score': 0.9866667}
confusion matrix:
      0     1
0  1514     3
1    38  1517
---- Validation: 
scalar performance:
{'acc': 0.81186575, 'precision': 0.8454685, 'recall': 0.8092934, 'specificity': 0.8092934, 'f1': 0.8062546, 'auroc': 0.92677444, 'binary_precision': 0.9491917, 'binary_recall': 0.65238094, 'binary_specificity': 0.96620584, 'binary_f1_score': 0.7732831}
confusion matrix:
     0    1
0  629   22
1  219  411
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8, 'precision': 0.8434143, 'recall': 0.8, 'specificity': 0.8, 'f1': 0.7934727, 'auroc': 0.9034469, 'binary_precision': 0.9655172, 'binary_recall': 0.62222224, 'binary_specificity': 0.9777778, 'binary_f1_score': 0.7567568}
confusion matrix:
     0    1
0  220    5
1   85  140
early stop counter: 4
val acc:0.8118657469749451, best validation acc: 0.8540202975273132, corresponding to test acc:                         0.8355555534362793 / 0.855555534362793
after epoch: 7,now: 2024-07-27 04:24:49.765097,epoch time: 0:02:24.862252,used: 0:17:00.116904,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_04_07_49_seed_1_23093152
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9889323, 'precision': 0.9890393, 'recall': 0.98906755, 'specificity': 0.98906755, 'f1': 0.98893225, 'auroc': 0.9994968, 'binary_precision': 1.0, 'binary_recall': 0.97813505, 'binary_specificity': 1.0, 'binary_f1_score': 0.9889467}
confusion matrix:
      0     1
0  1517     0
1    34  1521
---- Validation: 
scalar performance:
{'acc': 0.7189696, 'precision': 0.79392457, 'recall': 0.7147721, 'specificity': 0.7147721, 'f1': 0.6972649, 'auroc': 0.9057908, 'binary_precision': 0.9383117, 'binary_recall': 0.45873016, 'binary_specificity': 0.9708141, 'binary_f1_score': 0.61620474}
confusion matrix:
     0    1
0  632   19
1  341  289
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7822222, 'precision': 0.8207719, 'recall': 0.7822222, 'specificity': 0.7822222, 'f1': 0.7754766, 'auroc': 0.88645923, 'binary_precision': 0.9319728, 'binary_recall': 0.60888886, 'binary_specificity': 0.95555556, 'binary_f1_score': 0.73655915}
confusion matrix:
     0    1
0  215   10
1   88  137
early stop counter: 5
val acc:0.7189695835113525, best validation acc: 0.8540202975273132, corresponding to test acc:                         0.8355555534362793 / 0.855555534362793
after epoch: 8,now: 2024-07-27 04:27:15.230990,epoch time: 0:02:25.465893,used: 0:19:25.582797,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_04_07_49_seed_1_23093152
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 8 with time: 0:19:25.582797 at 2024-07-27 04:27:15.230990
persisted model performance metric: 

scalar performance:
{'acc': 0.83555555, 'precision': 0.8365128, 'recall': 0.83555555, 'specificity': 0.83555555, 'f1': 0.83543855, 'auroc': 0.9184593, 'binary_precision': 0.8544601, 'binary_recall': 0.8088889, 'binary_specificity': 0.8622222, 'binary_f1_score': 0.8310502}
confusion matrix:
     0    1
0  194   31
1   43  182
oracle model performance metric: 

scalar performance:
{'acc': 0.85555553, 'precision': 0.8677672, 'recall': 0.85555553, 'specificity': 0.85555553, 'f1': 0.85434645, 'auroc': 0.91723454, 'binary_precision': 0.9347826, 'binary_recall': 0.7644445, 'binary_specificity': 0.94666666, 'binary_f1_score': 0.84107584}
confusion matrix:
     0    1
0  213   12
1   53  172
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_dial_3seeds_nofreeze_2024-07-27_01-29-56/rule_results/0.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_dial_3seeds_nofreeze_2024-07-27_01-29-56/confusion_matrix/0.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 456522 KiB |   6793 MiB | 115800 GiB | 115799 GiB |
|       from large pool | 415924 KiB |   6758 MiB | 114556 GiB | 114556 GiB |
|       from small pool |  40598 KiB |     60 MiB |   1243 GiB |   1243 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 456522 KiB |   6793 MiB | 115800 GiB | 115799 GiB |
|       from large pool | 415924 KiB |   6758 MiB | 114556 GiB | 114556 GiB |
|       from small pool |  40598 KiB |     60 MiB |   1243 GiB |   1243 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 447481 KiB |   6787 MiB | 115653 GiB | 115652 GiB |
|       from large pool | 407075 KiB |   6753 MiB | 114411 GiB | 114410 GiB |
|       from small pool |  40406 KiB |     60 MiB |   1242 GiB |   1242 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   7958 MiB |   7958 MiB |  15120 MiB |   7162 MiB |
|       from large pool |   7890 MiB |   7894 MiB |  15036 MiB |   7146 MiB |
|       from small pool |     68 MiB |     68 MiB |     84 MiB |     16 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 364725 KiB |   1135 MiB | 151672 GiB | 151671 GiB |
|       from large pool | 356172 KiB |   1126 MiB | 150409 GiB | 150409 GiB |
|       from small pool |   8553 KiB |     28 MiB |   1262 GiB |   1262 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    1310    |    1702    |   16672 K  |   16670 K  |
|       from large pool |     187    |     783    |   10153 K  |   10153 K  |
|       from small pool |    1123    |    1419    |    6518 K  |    6517 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    1310    |    1702    |   16672 K  |   16670 K  |
|       from large pool |     187    |     783    |   10153 K  |   10153 K  |
|       from small pool |    1123    |    1419    |    6518 K  |    6517 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     324    |     324    |     586    |     262    |
|       from large pool |     290    |     290    |     544    |     254    |
|       from small pool |      34    |      34    |      42    |       8    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      79    |     340    |    9816 K  |    9816 K  |
|       from large pool |      35    |     294    |    6911 K  |    6911 K  |
|       from small pool |      44    |     219    |    2904 K  |    2904 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   6793 MiB | 115800 GiB | 115799 GiB |
|       from large pool |  16640 KiB |   6758 MiB | 114556 GiB | 114556 GiB |
|       from small pool |      0 KiB |     60 MiB |   1243 GiB |   1243 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   6793 MiB | 115800 GiB | 115799 GiB |
|       from large pool |  16640 KiB |   6758 MiB | 114556 GiB | 114556 GiB |
|       from small pool |      0 KiB |     60 MiB |   1243 GiB |   1243 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   6787 MiB | 115653 GiB | 115653 GiB |
|       from large pool |  16640 KiB |   6753 MiB | 114411 GiB | 114411 GiB |
|       from small pool |      0 KiB |     60 MiB |   1242 GiB |   1242 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    802 MiB |   7958 MiB |  15120 MiB |  14318 MiB |
|       from large pool |    754 MiB |   7894 MiB |  15036 MiB |  14282 MiB |
|       from small pool |     48 MiB |     68 MiB |     84 MiB |     36 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1135 MiB | 151672 GiB | 151672 GiB |
|       from large pool |  24320 KiB |   1126 MiB | 150410 GiB | 150410 GiB |
|       from small pool |      0 KiB |     32 MiB |   1262 GiB |   1262 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    1702    |   16672 K  |   16672 K  |
|       from large pool |       2    |     783    |   10153 K  |   10153 K  |
|       from small pool |       0    |    1419    |    6518 K  |    6518 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    1702    |   16672 K  |   16672 K  |
|       from large pool |       2    |     783    |   10153 K  |   10153 K  |
|       from small pool |       0    |    1419    |    6518 K  |    6518 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      59    |     324    |     586    |     527    |
|       from large pool |      35    |     290    |     544    |     509    |
|       from small pool |      24    |      34    |      42    |      18    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |     340    |    9816 K  |    9816 K  |
|       from large pool |       4    |     294    |    6911 K  |    6911 K  |
|       from small pool |       0    |     219    |    2905 K  |    2905 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   6793 MiB | 115800 GiB | 115799 GiB |
|       from large pool |  16640 KiB |   6758 MiB | 114556 GiB | 114556 GiB |
|       from small pool |      0 KiB |     60 MiB |   1243 GiB |   1243 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   6793 MiB | 115800 GiB | 115799 GiB |
|       from large pool |  16640 KiB |   6758 MiB | 114556 GiB | 114556 GiB |
|       from small pool |      0 KiB |     60 MiB |   1243 GiB |   1243 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   6787 MiB | 115653 GiB | 115653 GiB |
|       from large pool |  16640 KiB |   6753 MiB | 114411 GiB | 114411 GiB |
|       from small pool |      0 KiB |     60 MiB |   1242 GiB |   1242 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    802 MiB |   7958 MiB |  15120 MiB |  14318 MiB |
|       from large pool |    754 MiB |   7894 MiB |  15036 MiB |  14282 MiB |
|       from small pool |     48 MiB |     68 MiB |     84 MiB |     36 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1135 MiB | 151672 GiB | 151672 GiB |
|       from large pool |  24320 KiB |   1126 MiB | 150410 GiB | 150410 GiB |
|       from small pool |      0 KiB |     32 MiB |   1262 GiB |   1262 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    1702    |   16672 K  |   16672 K  |
|       from large pool |       2    |     783    |   10153 K  |   10153 K  |
|       from small pool |       0    |    1419    |    6518 K  |    6518 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    1702    |   16672 K  |   16672 K  |
|       from large pool |       2    |     783    |   10153 K  |   10153 K  |
|       from small pool |       0    |    1419    |    6518 K  |    6518 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      59    |     324    |     586    |     527    |
|       from large pool |      35    |     290    |     544    |     509    |
|       from small pool |      24    |      34    |      42    |      18    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |     340    |    9816 K  |    9816 K  |
|       from large pool |       4    |     294    |    6911 K  |    6911 K  |
|       from small pool |       0    |     219    |    2905 K  |    2905 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_04_27_49_seed_2_23093152

 Experiment start at: 2024-07-27 04:27:50.153487
before training, model accuracy: 0.41203704476356506
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9659686, 'precision': 0.9668426, 'recall': 0.96615154, 'specificity': 0.96615154, 'f1': 0.96596014, 'auroc': 0.99510026, 'binary_precision': 0.9891008, 'binary_recall': 0.94285715, 'binary_specificity': 0.9894459, 'binary_f1_score': 0.96542555}
confusion matrix:
      0     1
0  1500    16
1    88  1452
---- Validation: 
scalar performance:
{'acc': 0.80125195, 'precision': 0.81317735, 'recall': 0.7985697, 'specificity': 0.7985697, 'f1': 0.79824585, 'auroc': 0.87767136, 'binary_precision': 0.868, 'binary_recall': 0.6977492, 'binary_specificity': 0.8993902, 'binary_f1_score': 0.7736186}
confusion matrix:
     0    1
0  590   66
1  188  434
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8587963, 'precision': 0.8673711, 'recall': 0.8587963, 'specificity': 0.8587963, 'f1': 0.8579675, 'auroc': 0.9212749, 'binary_precision': 0.92349726, 'binary_recall': 0.7824074, 'binary_specificity': 0.9351852, 'binary_f1_score': 0.8471178}
confusion matrix:
     0    1
0  202   14
1   47  169
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-27 04:30:18.667576,epoch time: 0:02:28.514089,used: 0:02:28.514089,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_04_27_49_seed_2_23093152
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9597513, 'precision': 0.9622932, 'recall': 0.96005464, 'specificity': 0.96005464, 'f1': 0.9597124, 'auroc': 0.9973842, 'binary_precision': 0.99859256, 'binary_recall': 0.92142856, 'binary_specificity': 0.9986807, 'binary_f1_score': 0.95846}
confusion matrix:
      0     1
0  1514     2
1   121  1419
---- Validation: 
scalar performance:
{'acc': 0.62676054, 'precision': 0.6996676, 'recall': 0.618351, 'specificity': 0.618351, 'f1': 0.5803516, 'auroc': 0.79893243, 'binary_precision': 0.8138528, 'binary_recall': 0.3022508, 'binary_specificity': 0.9344512, 'binary_f1_score': 0.44079715}
confusion matrix:
     0    1
0  613   43
1  434  188
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7268519, 'precision': 0.81443846, 'recall': 0.7268518, 'specificity': 0.7268518, 'f1': 0.70640683, 'auroc': 0.9299554, 'binary_precision': 0.98039216, 'binary_recall': 0.46296296, 'binary_specificity': 0.9907407, 'binary_f1_score': 0.6289308}
confusion matrix:
     0    1
0  214    2
1  116  100
early stop counter: 1
val acc:0.6267605423927307, best validation acc: 0.8012519478797913, corresponding to test acc:                         0.8587962985038757 / 0.8587962985038757
after epoch: 2,now: 2024-07-27 04:32:42.791423,epoch time: 0:02:24.123847,used: 0:04:52.637936,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_04_27_49_seed_2_23093152
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.94731677, 'precision': 0.9500071, 'recall': 0.9470231, 'specificity': 0.9470231, 'f1': 0.94721067, 'auroc': 0.99360156, 'binary_precision': 0.9171204, 'binary_recall': 0.9844156, 'binary_specificity': 0.9096306, 'binary_f1_score': 0.9495772}
confusion matrix:
      0     1
0  1379   137
1    24  1516
---- Validation: 
scalar performance:
{'acc': 0.8176839, 'precision': 0.82220197, 'recall': 0.8160341, 'specificity': 0.8160341, 'f1': 0.81639683, 'auroc': 0.88982236, 'binary_precision': 0.85428053, 'binary_recall': 0.7540193, 'binary_specificity': 0.8780488, 'binary_f1_score': 0.80102473}
confusion matrix:
     0    1
0  576   80
1  153  469
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8472222, 'precision': 0.8474903, 'recall': 0.8472222, 'specificity': 0.8472222, 'f1': 0.84719276, 'auroc': 0.90826476, 'binary_precision': 0.85714287, 'binary_recall': 0.8333333, 'binary_specificity': 0.8611111, 'binary_f1_score': 0.8450704}
confusion matrix:
     0    1
0  186   30
1   36  180
better model found
persisted
after epoch: 3,now: 2024-07-27 04:35:06.496931,epoch time: 0:02:23.705508,used: 0:07:16.343444,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_04_27_49_seed_2_23093152
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9856021, 'precision': 0.9857329, 'recall': 0.9855498, 'specificity': 0.9855498, 'f1': 0.9855991, 'auroc': 0.99911463, 'binary_precision': 0.9794872, 'binary_recall': 0.99220777, 'binary_specificity': 0.97889185, 'binary_f1_score': 0.98580647}
confusion matrix:
      0     1
0  1484    32
1    12  1528
---- Validation: 
scalar performance:
{'acc': 0.80203444, 'precision': 0.80576086, 'recall': 0.8034566, 'specificity': 0.8034566, 'f1': 0.80183053, 'auroc': 0.8804604, 'binary_precision': 0.7647059, 'binary_recall': 0.8569132, 'binary_specificity': 0.75, 'binary_f1_score': 0.8081881}
confusion matrix:
     0    1
0  492  164
1   89  533
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8842593, 'precision': 0.8850846, 'recall': 0.8842592, 'specificity': 0.8842592, 'f1': 0.88419724, 'auroc': 0.93672836, 'binary_precision': 0.9029126, 'binary_recall': 0.8611111, 'binary_specificity': 0.9074074, 'binary_f1_score': 0.8815166}
confusion matrix:
     0    1
0  196   20
1   30  186
new oracle model saved
early stop counter: 1
val acc:0.8020344376564026, best validation acc: 0.8176838755607605, corresponding to test acc:                         0.8472222089767456 / 0.8842592835426331
after epoch: 4,now: 2024-07-27 04:37:29.784100,epoch time: 0:02:23.287169,used: 0:09:39.630613,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_04_27_49_seed_2_23093152
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9820026, 'precision': 0.98201215, 'recall': 0.98204005, 'specificity': 0.98204005, 'f1': 0.9820025, 'auroc': 0.99782455, 'binary_precision': 0.98688525, 'binary_recall': 0.97727275, 'binary_specificity': 0.9868074, 'binary_f1_score': 0.9820555}
confusion matrix:
      0     1
0  1496    20
1    35  1505
---- Validation: 
scalar performance:
{'acc': 0.814554, 'precision': 0.8170808, 'recall': 0.8132769, 'specificity': 0.8132769, 'f1': 0.81365025, 'auroc': 0.8927952, 'binary_precision': 0.83950615, 'binary_recall': 0.76527333, 'binary_specificity': 0.8612805, 'binary_f1_score': 0.8006728}
confusion matrix:
     0    1
0  565   91
1  146  476
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7800926, 'precision': 0.7805797, 'recall': 0.7800926, 'specificity': 0.7800926, 'f1': 0.7799971, 'auroc': 0.87594306, 'binary_precision': 0.79227054, 'binary_recall': 0.7592593, 'binary_specificity': 0.8009259, 'binary_f1_score': 0.7754137}
confusion matrix:
     0    1
0  173   43
1   52  164
early stop counter: 2
val acc:0.81455397605896, best validation acc: 0.8176838755607605, corresponding to test acc:                         0.8472222089767456 / 0.8842592835426331
after epoch: 5,now: 2024-07-27 04:39:53.900849,epoch time: 0:02:24.116749,used: 0:12:03.747362,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_04_27_49_seed_2_23093152
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.97840315, 'precision': 0.97879696, 'recall': 0.9785303, 'specificity': 0.9785303, 'f1': 0.9784016, 'auroc': 0.9980635, 'binary_precision': 0.9946309, 'binary_recall': 0.9623377, 'binary_specificity': 0.99472296, 'binary_f1_score': 0.97821784}
confusion matrix:
      0     1
0  1508     8
1    58  1482
---- Validation: 
scalar performance:
{'acc': 0.74100155, 'precision': 0.7989975, 'recall': 0.7350061, 'specificity': 0.7350061, 'f1': 0.7244748, 'auroc': 0.8949274, 'binary_precision': 0.92419827, 'binary_recall': 0.5096463, 'binary_specificity': 0.96036583, 'binary_f1_score': 0.6569948}
confusion matrix:
     0    1
0  630   26
1  305  317
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7638889, 'precision': 0.83228976, 'recall': 0.76388884, 'specificity': 0.76388884, 'f1': 0.75107896, 'auroc': 0.8942044, 'binary_precision': 0.9830508, 'binary_recall': 0.537037, 'binary_specificity': 0.9907407, 'binary_f1_score': 0.6946107}
confusion matrix:
     0    1
0  214    2
1  100  116
early stop counter: 3
val acc:0.741001546382904, best validation acc: 0.8176838755607605, corresponding to test acc:                         0.8472222089767456 / 0.8842592835426331
after epoch: 6,now: 2024-07-27 04:42:17.544472,epoch time: 0:02:23.643623,used: 0:14:27.390985,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_04_27_49_seed_2_23093152
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.94600785, 'precision': 0.9509221, 'recall': 0.94642854, 'specificity': 0.94642854, 'f1': 0.9458927, 'auroc': 0.9987737, 'binary_precision': 1.0, 'binary_recall': 0.89285713, 'binary_specificity': 1.0, 'binary_f1_score': 0.9433963}
confusion matrix:
      0     1
0  1516     0
1   165  1375
---- Validation: 
scalar performance:
{'acc': 0.5508607, 'precision': 0.76666665, 'recall': 0.5385852, 'specificity': 0.5385852, 'f1': 0.41946793, 'auroc': 0.9087652, 'binary_precision': 1.0, 'binary_recall': 0.07717042, 'binary_specificity': 1.0, 'binary_f1_score': 0.14328359}
confusion matrix:
     0   1
0  656   0
1  574  48
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5069444, 'precision': 0.75174826, 'recall': 0.5069444, 'specificity': 0.5069444, 'f1': 0.34858236, 'auroc': 0.87488747, 'binary_precision': 1.0, 'binary_recall': 0.013888889, 'binary_specificity': 1.0, 'binary_f1_score': 0.027397262}
confusion matrix:
     0  1
0  216  0
1  213  3
early stop counter: 4
val acc:0.5508607029914856, best validation acc: 0.8176838755607605, corresponding to test acc:                         0.8472222089767456 / 0.8842592835426331
after epoch: 7,now: 2024-07-27 04:44:41.290423,epoch time: 0:02:23.745951,used: 0:16:51.136936,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_04_27_49_seed_2_23093152
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.99051046, 'precision': 0.9905028, 'recall': 0.99052274, 'specificity': 0.99052274, 'f1': 0.9905101, 'auroc': 0.9994183, 'binary_precision': 0.99218243, 'binary_recall': 0.98896104, 'binary_specificity': 0.99208444, 'binary_f1_score': 0.9905691}
confusion matrix:
      0     1
0  1504    12
1    17  1523
---- Validation: 
scalar performance:
{'acc': 0.8270736, 'precision': 0.8464823, 'recall': 0.8238888, 'specificity': 0.8238888, 'f1': 0.8235339, 'auroc': 0.91650164, 'binary_precision': 0.92210525, 'binary_recall': 0.70418006, 'binary_specificity': 0.94359756, 'binary_f1_score': 0.7985414}
confusion matrix:
     0    1
0  619   37
1  184  438
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6018519, 'precision': 0.69198453, 'recall': 0.6018518, 'specificity': 0.6018518, 'f1': 0.5489072, 'auroc': 0.81228566, 'binary_precision': 0.8235294, 'binary_recall': 0.25925925, 'binary_specificity': 0.9444444, 'binary_f1_score': 0.39436617}
confusion matrix:
     0   1
0  204  12
1  160  56
better model found
persisted
after epoch: 8,now: 2024-07-27 04:47:05.418448,epoch time: 0:02:24.128025,used: 0:19:15.264961,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_04_27_49_seed_2_23093152
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9816754, 'precision': 0.9818559, 'recall': 0.98176676, 'specificity': 0.98176676, 'f1': 0.9816751, 'auroc': 0.99877924, 'binary_precision': 0.99335104, 'binary_recall': 0.97012985, 'binary_specificity': 0.9934037, 'binary_f1_score': 0.9816031}
confusion matrix:
      0     1
0  1506    10
1    46  1494
---- Validation: 
scalar performance:
{'acc': 0.8325509, 'precision': 0.85319847, 'recall': 0.8293075, 'specificity': 0.8293075, 'f1': 0.8290063, 'auroc': 0.91848433, 'binary_precision': 0.9322034, 'binary_recall': 0.7073955, 'binary_specificity': 0.9512195, 'binary_f1_score': 0.80438757}
confusion matrix:
     0    1
0  624   32
1  182  440
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.75, 'precision': 0.8333334, 'recall': 0.75, 'specificity': 0.75, 'f1': 0.73333335, 'auroc': 0.8975694, 'binary_precision': 1.0, 'binary_recall': 0.5, 'binary_specificity': 1.0, 'binary_f1_score': 0.6666667}
confusion matrix:
     0    1
0  216    0
1  108  108
better model found
persisted
after epoch: 9,now: 2024-07-27 04:49:31.068293,epoch time: 0:02:25.649845,used: 0:21:40.914806,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_04_27_49_seed_2_23093152
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.97611254, 'precision': 0.9768717, 'recall': 0.9762833, 'specificity': 0.9762833, 'f1': 0.97610784, 'auroc': 0.99941826, 'binary_precision': 0.99796337, 'binary_recall': 0.95454544, 'binary_specificity': 0.9980211, 'binary_f1_score': 0.97577167}
confusion matrix:
      0     1
0  1513     3
1    70  1470
---- Validation: 
scalar performance:
{'acc': 0.6541471, 'precision': 0.77680975, 'recall': 0.6450695, 'specificity': 0.6450695, 'f1': 0.6031836, 'auroc': 0.9198396, 'binary_precision': 0.95454544, 'binary_recall': 0.30385852, 'binary_specificity': 0.9862805, 'binary_f1_score': 0.46097556}
confusion matrix:
     0    1
0  647    9
1  433  189
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5393519, 'precision': 0.760241, 'recall': 0.5393518, 'specificity': 0.5393518, 'f1': 0.41527516, 'auroc': 0.9121871, 'binary_precision': 1.0, 'binary_recall': 0.0787037, 'binary_specificity': 1.0, 'binary_f1_score': 0.14592275}
confusion matrix:
     0   1
0  216   0
1  199  17
early stop counter: 1
val acc:0.6541470885276794, best validation acc: 0.8325508832931519, corresponding to test acc:                         0.75 / 0.8842592835426331
after epoch: 10,now: 2024-07-27 04:52:01.028094,epoch time: 0:02:29.959801,used: 0:24:10.874607,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_04_27_49_seed_2_23093152
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9908377, 'precision': 0.99087036, 'recall': 0.9908166, 'specificity': 0.9908166, 'f1': 0.99083674, 'auroc': 0.99943924, 'binary_precision': 0.9883721, 'binary_recall': 0.9935065, 'binary_specificity': 0.98812664, 'binary_f1_score': 0.9909327}
confusion matrix:
      0     1
0  1498    18
1    10  1530
---- Validation: 
scalar performance:
{'acc': 0.84663534, 'precision': 0.86277384, 'recall': 0.8438186, 'specificity': 0.8438186, 'f1': 0.8440676, 'auroc': 0.92638505, 'binary_precision': 0.93292683, 'binary_recall': 0.7379421, 'binary_specificity': 0.9496951, 'binary_f1_score': 0.82405746}
confusion matrix:
     0    1
0  623   33
1  163  459
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8148148, 'precision': 0.8620231, 'recall': 0.8148148, 'specificity': 0.8148148, 'f1': 0.8085743, 'auroc': 0.9339849, 'binary_precision': 0.9927536, 'binary_recall': 0.6342593, 'binary_specificity': 0.9953704, 'binary_f1_score': 0.7740113}
confusion matrix:
     0    1
0  215    1
1   79  137
better model found
persisted
after epoch: 11,now: 2024-07-27 04:54:29.396147,epoch time: 0:02:28.368053,used: 0:26:39.242660,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_04_27_49_seed_2_23093152
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.99345547, 'precision': 0.9934485, 'recall': 0.99346536, 'specificity': 0.99346536, 'f1': 0.9934552, 'auroc': 0.9996594, 'binary_precision': 0.9947917, 'binary_recall': 0.99220777, 'binary_specificity': 0.99472296, 'binary_f1_score': 0.993498}
confusion matrix:
      0     1
0  1508     8
1    12  1528
---- Validation: 
scalar performance:
{'acc': 0.84741783, 'precision': 0.8571401, 'recall': 0.8452058, 'specificity': 0.8452058, 'f1': 0.845696, 'auroc': 0.9263636, 'binary_precision': 0.90978885, 'binary_recall': 0.7620579, 'binary_specificity': 0.92835367, 'binary_f1_score': 0.8293963}
confusion matrix:
     0    1
0  609   47
1  148  474
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8148148, 'precision': 0.8494481, 'recall': 0.8148148, 'specificity': 0.8148148, 'f1': 0.8101099, 'auroc': 0.9243399, 'binary_precision': 0.9594595, 'binary_recall': 0.6574074, 'binary_specificity': 0.9722222, 'binary_f1_score': 0.78021985}
confusion matrix:
     0    1
0  210    6
1   74  142
better model found
persisted
after epoch: 12,now: 2024-07-27 04:56:55.209052,epoch time: 0:02:25.812905,used: 0:29:05.055565,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_04_27_49_seed_2_23093152
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9911649, 'precision': 0.99115735, 'recall': 0.9911823, 'specificity': 0.9911823, 'f1': 0.9911647, 'auroc': 0.9995138, 'binary_precision': 0.99347687, 'binary_recall': 0.98896104, 'binary_specificity': 0.9934037, 'binary_f1_score': 0.99121386}
confusion matrix:
      0     1
0  1506    10
1    17  1523
---- Validation: 
scalar performance:
{'acc': 0.75273865, 'precision': 0.80128706, 'recall': 0.74727225, 'specificity': 0.74727225, 'f1': 0.73951006, 'auroc': 0.88129365, 'binary_precision': 0.9157609, 'binary_recall': 0.5418006, 'binary_specificity': 0.9527439, 'binary_f1_score': 0.68080807}
confusion matrix:
     0    1
0  625   31
1  285  337
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5231481, 'precision': 0.584375, 'recall': 0.5231482, 'specificity': 0.5231482, 'f1': 0.41746962, 'auroc': 0.76225996, 'binary_precision': 0.65625, 'binary_recall': 0.097222224, 'binary_specificity': 0.9490741, 'binary_f1_score': 0.16935484}
confusion matrix:
     0   1
0  205  11
1  195  21
early stop counter: 1
val acc:0.7527386546134949, best validation acc: 0.8474178314208984, corresponding to test acc:                         0.8148148059844971 / 0.8842592835426331
after epoch: 13,now: 2024-07-27 04:59:21.462855,epoch time: 0:02:26.253803,used: 0:31:31.309368,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_04_27_49_seed_2_23093152
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.989856, 'precision': 0.9898656, 'recall': 0.9898939, 'specificity': 0.9898939, 'f1': 0.9898559, 'auroc': 0.9996749, 'binary_precision': 0.9947541, 'binary_recall': 0.9850649, 'binary_specificity': 0.99472296, 'binary_f1_score': 0.98988575}
confusion matrix:
      0     1
0  1508     8
1    23  1517
---- Validation: 
scalar performance:
{'acc': 0.69796556, 'precision': 0.7797302, 'recall': 0.6905855, 'specificity': 0.6905855, 'f1': 0.6690097, 'auroc': 0.8779826, 'binary_precision': 0.9244604, 'binary_recall': 0.41318327, 'binary_specificity': 0.9679878, 'binary_f1_score': 0.5711111}
confusion matrix:
     0    1
0  635   21
1  365  257
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.525463, 'precision': 0.6683912, 'recall': 0.525463, 'specificity': 0.525463, 'f1': 0.39764526, 'auroc': 0.84089935, 'binary_precision': 0.8235294, 'binary_recall': 0.06481481, 'binary_specificity': 0.9861111, 'binary_f1_score': 0.12017167}
confusion matrix:
     0   1
0  213   3
1  202  14
early stop counter: 2
val acc:0.6979655623435974, best validation acc: 0.8474178314208984, corresponding to test acc:                         0.8148148059844971 / 0.8842592835426331
after epoch: 14,now: 2024-07-27 05:01:47.196067,epoch time: 0:02:25.733212,used: 0:33:57.042580,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_04_27_49_seed_2_23093152
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9911649, 'precision': 0.9911737, 'recall': 0.9911567, 'specificity': 0.9911567, 'f1': 0.9911642, 'auroc': 0.99948084, 'binary_precision': 0.99027866, 'binary_recall': 0.99220777, 'binary_specificity': 0.99010557, 'binary_f1_score': 0.99124223}
confusion matrix:
      0     1
0  1501    15
1    12  1528
---- Validation: 
scalar performance:
{'acc': 0.7942097, 'precision': 0.8301121, 'recall': 0.78975177, 'specificity': 0.78975177, 'f1': 0.7866218, 'auroc': 0.91978264, 'binary_precision': 0.9325301, 'binary_recall': 0.6221865, 'binary_specificity': 0.95731705, 'binary_f1_score': 0.7463838}
confusion matrix:
     0    1
0  628   28
1  235  387
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.724537, 'precision': 0.80125093, 'recall': 0.724537, 'specificity': 0.724537, 'f1': 0.705808, 'auroc': 0.9067644, 'binary_precision': 0.95327103, 'binary_recall': 0.4722222, 'binary_specificity': 0.9768519, 'binary_f1_score': 0.631579}
confusion matrix:
     0    1
0  211    5
1  114  102
early stop counter: 3
val acc:0.7942097187042236, best validation acc: 0.8474178314208984, corresponding to test acc:                         0.8148148059844971 / 0.8842592835426331
after epoch: 15,now: 2024-07-27 05:04:15.685229,epoch time: 0:02:28.489162,used: 0:36:25.531742,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_04_27_49_seed_2_23093152
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9888743, 'precision': 0.9890533, 'recall': 0.98881197, 'specificity': 0.98881197, 'f1': 0.9888716, 'auroc': 0.99970365, 'binary_precision': 0.9814578, 'binary_recall': 0.9967533, 'binary_specificity': 0.9808707, 'binary_f1_score': 0.9890464}
confusion matrix:
      0     1
0  1487    29
1     5  1535
---- Validation: 
scalar performance:
{'acc': 0.8685446, 'precision': 0.8718783, 'recall': 0.8672849, 'specificity': 0.8672849, 'f1': 0.8678894, 'auroc': 0.9342871, 'binary_precision': 0.90106004, 'binary_recall': 0.8199357, 'binary_specificity': 0.91463417, 'binary_f1_score': 0.85858583}
confusion matrix:
     0    1
0  600   56
1  112  510
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8472222, 'precision': 0.8491379, 'recall': 0.8472222, 'specificity': 0.8472222, 'f1': 0.8470124, 'auroc': 0.9270619, 'binary_precision': 0.875, 'binary_recall': 0.8101852, 'binary_specificity': 0.8842593, 'binary_f1_score': 0.84134614}
confusion matrix:
     0    1
0  191   25
1   41  175
better model found
persisted
after epoch: 16,now: 2024-07-27 05:06:44.351911,epoch time: 0:02:28.666682,used: 0:38:54.198424,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_04_27_49_seed_2_23093152
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9810209, 'precision': 0.9815756, 'recall': 0.98116887, 'specificity': 0.98116887, 'f1': 0.98101854, 'auroc': 0.99891114, 'binary_precision': 1.0, 'binary_recall': 0.9623377, 'binary_specificity': 1.0, 'binary_f1_score': 0.98080736}
confusion matrix:
      0     1
0  1516     0
1    58  1482
---- Validation: 
scalar performance:
{'acc': 0.771518, 'precision': 0.821252, 'recall': 0.76618993, 'specificity': 0.76618993, 'f1': 0.75982386, 'auroc': 0.9025383, 'binary_precision': 0.9411765, 'binary_recall': 0.5659164, 'binary_specificity': 0.9664634, 'binary_f1_score': 0.7068273}
confusion matrix:
     0    1
0  634   22
1  270  352
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5162037, 'precision': 0.7541176, 'recall': 0.5162037, 'specificity': 0.5162037, 'f1': 0.36836362, 'auroc': 0.84645057, 'binary_precision': 1.0, 'binary_recall': 0.032407407, 'binary_specificity': 1.0, 'binary_f1_score': 0.06278027}
confusion matrix:
     0  1
0  216  0
1  209  7
early stop counter: 1
val acc:0.7715179920196533, best validation acc: 0.8685445785522461, corresponding to test acc:                         0.8472222089767456 / 0.8842592835426331
after epoch: 17,now: 2024-07-27 05:09:10.550205,epoch time: 0:02:26.198294,used: 0:41:20.396718,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_04_27_49_seed_2_23093152
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9908377, 'precision': 0.99094987, 'recall': 0.99079084, 'specificity': 0.99079084, 'f1': 0.990836, 'auroc': 0.99954677, 'binary_precision': 0.9852375, 'binary_recall': 0.9967533, 'binary_specificity': 0.9848285, 'binary_f1_score': 0.9909619}
confusion matrix:
      0     1
0  1493    23
1     5  1535
---- Validation: 
scalar performance:
{'acc': 0.86697966, 'precision': 0.8732519, 'recall': 0.8652606, 'specificity': 0.8652606, 'f1': 0.8659501, 'auroc': 0.92351335, 'binary_precision': 0.91544116, 'binary_recall': 0.8006431, 'binary_specificity': 0.92987806, 'binary_f1_score': 0.8542024}
confusion matrix:
     0    1
0  610   46
1  124  498
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7962963, 'precision': 0.8006525, 'recall': 0.7962963, 'specificity': 0.7962963, 'f1': 0.7955558, 'auroc': 0.8985982, 'binary_precision': 0.7644628, 'binary_recall': 0.8564815, 'binary_specificity': 0.7361111, 'binary_f1_score': 0.8078603}
confusion matrix:
     0    1
0  159   57
1   31  185
early stop counter: 2
val acc:0.8669796586036682, best validation acc: 0.8685445785522461, corresponding to test acc:                         0.8472222089767456 / 0.8842592835426331
after epoch: 18,now: 2024-07-27 05:11:36.539731,epoch time: 0:02:25.989526,used: 0:43:46.386244,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_04_27_49_seed_2_23093152
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9888743, 'precision': 0.9890095, 'recall': 0.98895586, 'specificity': 0.98895586, 'f1': 0.9888742, 'auroc': 0.99962056, 'binary_precision': 0.9993369, 'binary_recall': 0.9785714, 'binary_specificity': 0.99934036, 'binary_f1_score': 0.9888451}
confusion matrix:
      0     1
0  1515     1
1    33  1507
---- Validation: 
scalar performance:
{'acc': 0.69953054, 'precision': 0.7893417, 'recall': 0.6919433, 'specificity': 0.6919433, 'f1': 0.6690236, 'auroc': 0.91929305, 'binary_precision': 0.94402987, 'binary_recall': 0.4067524, 'binary_specificity': 0.97713417, 'binary_f1_score': 0.5685393}
confusion matrix:
     0    1
0  641   15
1  369  253
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6481481, 'precision': 0.7861401, 'recall': 0.6481482, 'specificity': 0.6481482, 'f1': 0.5999122, 'auroc': 0.9013846, 'binary_precision': 0.9848485, 'binary_recall': 0.30092594, 'binary_specificity': 0.9953704, 'binary_f1_score': 0.4609929}
confusion matrix:
     0   1
0  215   1
1  151  65
early stop counter: 3
val acc:0.6995305418968201, best validation acc: 0.8685445785522461, corresponding to test acc:                         0.8472222089767456 / 0.8842592835426331
after epoch: 19,now: 2024-07-27 05:14:03.338748,epoch time: 0:02:26.799017,used: 0:46:13.185261,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_04_27_49_seed_2_23093152
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9895288, 'precision': 0.9895282, 'recall': 0.9895282, 'specificity': 0.9895282, 'f1': 0.9895282, 'auroc': 0.9994252, 'binary_precision': 0.9896104, 'binary_recall': 0.9896104, 'binary_specificity': 0.9894459, 'binary_f1_score': 0.9896104}
confusion matrix:
      0     1
0  1500    16
1    16  1524
---- Validation: 
scalar performance:
{'acc': 0.7668232, 'precision': 0.79784966, 'recall': 0.7624084, 'specificity': 0.7624084, 'f1': 0.7584458, 'auroc': 0.88389885, 'binary_precision': 0.88755983, 'binary_recall': 0.596463, 'binary_specificity': 0.92835367, 'binary_f1_score': 0.7134615}
confusion matrix:
     0    1
0  609   47
1  251  371
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7268519, 'precision': 0.7589041, 'recall': 0.7268518, 'specificity': 0.7268518, 'f1': 0.71812797, 'auroc': 0.8445002, 'binary_precision': 0.85, 'binary_recall': 0.5509259, 'binary_specificity': 0.9027778, 'binary_f1_score': 0.66853935}
confusion matrix:
     0    1
0  195   21
1   97  119
early stop counter: 4
val acc:0.7668231725692749, best validation acc: 0.8685445785522461, corresponding to test acc:                         0.8472222089767456 / 0.8842592835426331
after epoch: 20,now: 2024-07-27 05:16:29.197298,epoch time: 0:02:25.858550,used: 0:48:39.043811,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_04_27_49_seed_2_23093152
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9888743, 'precision': 0.9889333, 'recall': 0.98884284, 'specificity': 0.98884284, 'f1': 0.98887277, 'auroc': 0.99938357, 'binary_precision': 0.98518044, 'binary_recall': 0.99285716, 'binary_specificity': 0.9848285, 'binary_f1_score': 0.9890039}
confusion matrix:
      0     1
0  1493    23
1    11  1529
---- Validation: 
scalar performance:
{'acc': 0.8317684, 'precision': 0.8405771, 'recall': 0.82958686, 'specificity': 0.82958686, 'f1': 0.8299265, 'auroc': 0.9052697, 'binary_precision': 0.8891013, 'binary_recall': 0.7475884, 'binary_specificity': 0.9115854, 'binary_f1_score': 0.81222713}
confusion matrix:
     0    1
0  598   58
1  157  465
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7384259, 'precision': 0.8018315, 'recall': 0.73842597, 'specificity': 0.73842597, 'f1': 0.7239273, 'auroc': 0.8955976, 'binary_precision': 0.94017094, 'binary_recall': 0.5092593, 'binary_specificity': 0.9675926, 'binary_f1_score': 0.6606607}
confusion matrix:
     0    1
0  209    7
1  106  110
early stop counter: 5
val acc:0.8317683935165405, best validation acc: 0.8685445785522461, corresponding to test acc:                         0.8472222089767456 / 0.8842592835426331
after epoch: 21,now: 2024-07-27 05:18:55.326677,epoch time: 0:02:26.129379,used: 0:51:05.173190,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_04_27_49_seed_2_23093152
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 21 with time: 0:51:05.173190 at 2024-07-27 05:18:55.326677
persisted model performance metric: 

scalar performance:
{'acc': 0.8472222, 'precision': 0.8491379, 'recall': 0.8472222, 'specificity': 0.8472222, 'f1': 0.8470124, 'auroc': 0.9270619, 'binary_precision': 0.875, 'binary_recall': 0.8101852, 'binary_specificity': 0.8842593, 'binary_f1_score': 0.84134614}
confusion matrix:
     0    1
0  191   25
1   41  175
oracle model performance metric: 

scalar performance:
{'acc': 0.8842593, 'precision': 0.8850846, 'recall': 0.8842592, 'specificity': 0.8842592, 'f1': 0.88419724, 'auroc': 0.93672836, 'binary_precision': 0.9029126, 'binary_recall': 0.8611111, 'binary_specificity': 0.9074074, 'binary_f1_score': 0.8815166}
confusion matrix:
     0    1
0  196   20
1   30  186
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_dial_3seeds_nofreeze_2024-07-27_01-29-56/rule_results/0.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_dial_3seeds_nofreeze_2024-07-27_01-29-56/confusion_matrix/0.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 458732 KiB |   6793 MiB | 249821 GiB | 249821 GiB |
|       from large pool | 418140 KiB |   6758 MiB | 247144 GiB | 247144 GiB |
|       from small pool |  40592 KiB |     60 MiB |   2677 GiB |   2677 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 458732 KiB |   6793 MiB | 249821 GiB | 249821 GiB |
|       from large pool | 418140 KiB |   6758 MiB | 247144 GiB | 247144 GiB |
|       from small pool |  40592 KiB |     60 MiB |   2677 GiB |   2677 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 447481 KiB |   6787 MiB | 249568 GiB | 249568 GiB |
|       from large pool | 407075 KiB |   6753 MiB | 246894 GiB | 246894 GiB |
|       from small pool |  40406 KiB |     60 MiB |   2674 GiB |   2674 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   7954 MiB |   7958 MiB |  22272 MiB |  14318 MiB |
|       from large pool |   7890 MiB |   7894 MiB |  22172 MiB |  14282 MiB |
|       from small pool |     64 MiB |     68 MiB |    100 MiB |     36 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 382995 KiB |   1135 MiB | 327305 GiB | 327304 GiB |
|       from large pool | 374436 KiB |   1126 MiB | 324588 GiB | 324588 GiB |
|       from small pool |   8559 KiB |     32 MiB |   2716 GiB |   2716 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    1298    |    1702    |   35934 K  |   35933 K  |
|       from large pool |     187    |     783    |   21905 K  |   21905 K  |
|       from small pool |    1111    |    1419    |   14028 K  |   14027 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    1298    |    1702    |   35934 K  |   35933 K  |
|       from large pool |     187    |     783    |   21905 K  |   21905 K  |
|       from small pool |    1111    |    1419    |   14028 K  |   14027 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     322    |     324    |     849    |     527    |
|       from large pool |     290    |     290    |     799    |     509    |
|       from small pool |      32    |      34    |      50    |      18    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      77    |     340    |   21646 K  |   21646 K  |
|       from large pool |      36    |     294    |   15357 K  |   15357 K  |
|       from small pool |      41    |     221    |    6289 K  |    6289 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   6793 MiB | 249821 GiB | 249821 GiB |
|       from large pool |  16640 KiB |   6758 MiB | 247144 GiB | 247144 GiB |
|       from small pool |      0 KiB |     60 MiB |   2677 GiB |   2677 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   6793 MiB | 249821 GiB | 249821 GiB |
|       from large pool |  16640 KiB |   6758 MiB | 247144 GiB | 247144 GiB |
|       from small pool |      0 KiB |     60 MiB |   2677 GiB |   2677 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   6787 MiB | 249568 GiB | 249568 GiB |
|       from large pool |  16640 KiB |   6753 MiB | 246894 GiB | 246894 GiB |
|       from small pool |      0 KiB |     60 MiB |   2674 GiB |   2674 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    822 MiB |   7958 MiB |  22272 MiB |  21450 MiB |
|       from large pool |    774 MiB |   7894 MiB |  22172 MiB |  21398 MiB |
|       from small pool |     48 MiB |     68 MiB |    100 MiB |     52 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1135 MiB | 327305 GiB | 327305 GiB |
|       from large pool |  24320 KiB |   1126 MiB | 324589 GiB | 324589 GiB |
|       from small pool |      0 KiB |     32 MiB |   2716 GiB |   2716 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    1702    |   35934 K  |   35934 K  |
|       from large pool |       2    |     783    |   21905 K  |   21905 K  |
|       from small pool |       0    |    1419    |   14028 K  |   14028 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    1702    |   35934 K  |   35934 K  |
|       from large pool |       2    |     783    |   21905 K  |   21905 K  |
|       from small pool |       0    |    1419    |   14028 K  |   14028 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      60    |     324    |     849    |     789    |
|       from large pool |      36    |     290    |     799    |     763    |
|       from small pool |      24    |      34    |      50    |      26    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |     340    |   21647 K  |   21647 K  |
|       from large pool |       4    |     294    |   15357 K  |   15357 K  |
|       from small pool |       0    |     221    |    6289 K  |    6289 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Sat Jul 27 05:19:02 2024]
Finished job 0.
1 of 1 steps (100%) done
