Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Sat Jul 27 03:37:07 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_dial_3seeds_nofreeze_2024-07-27_01-29-56/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_dial_3seeds_nofreeze_2024-07-27_01-29-56/rule_results/2.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=2
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/swiglu_ffn.py:51: UserWarning: xFormers is not available (SwiGLU)
  warnings.warn("xFormers is not available (SwiGLU)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/attention.py:33: UserWarning: xFormers is not available (Attention)
  warnings.warn("xFormers is not available (Attention)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/block.py:40: UserWarning: xFormers is not available (Block)
  warnings.warn("xFormers is not available (Block)")
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_03_38_05_seed_0_23093150

 Experiment start at: 2024-07-27 03:38:05.809963
before training, model accuracy: 0.569767415523529
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.92089844, 'precision': 0.9309267, 'recall': 0.9219152, 'specificity': 0.9219152, 'f1': 0.9205515, 'auroc': 0.9960592, 'binary_precision': 1.0, 'binary_recall': 0.84383035, 'binary_specificity': 1.0, 'binary_f1_score': 0.9153015}
confusion matrix:
      0     1
0  1516     0
1   243  1313
---- Validation: 
scalar performance:
{'acc': 0.5419255, 'precision': 0.7173192, 'recall': 0.5355416, 'specificity': 0.5355416, 'f1': 0.4160481, 'auroc': 0.8236793, 'binary_precision': 0.90909094, 'binary_recall': 0.07874016, 'binary_specificity': 0.992343, 'binary_f1_score': 0.14492753}
confusion matrix:
     0   1
0  648   5
1  585  50
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.59069765, 'precision': 0.7749361, 'recall': 0.59069765, 'specificity': 0.59069765, 'f1': 0.5083288, 'auroc': 0.87666845, 'binary_precision': 1.0, 'binary_recall': 0.18139535, 'binary_specificity': 1.0, 'binary_f1_score': 0.30708665}
confusion matrix:
     0   1
0  215   0
1  176  39
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-27 03:40:05.906728,epoch time: 0:02:00.096765,used: 0:02:00.096765,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_03_38_05_seed_0_23093150
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.96972656, 'precision': 0.9699862, 'recall': 0.96992064, 'specificity': 0.96992064, 'f1': 0.96972644, 'auroc': 0.9973602, 'binary_precision': 0.98475814, 'binary_recall': 0.95501286, 'binary_specificity': 0.9848285, 'binary_f1_score': 0.9696575}
confusion matrix:
      0     1
0  1493    23
1    70  1486
---- Validation: 
scalar performance:
{'acc': 0.6467391, 'precision': 0.64718807, 'recall': 0.64618176, 'specificity': 0.64618176, 'f1': 0.6458919, 'auroc': 0.7294353, 'binary_precision': 0.65254235, 'binary_recall': 0.6062992, 'binary_specificity': 0.6860643, 'binary_f1_score': 0.62857145}
confusion matrix:
     0    1
0  448  205
1  250  385
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.73255813, 'precision': 0.76677585, 'recall': 0.73255813, 'specificity': 0.73255813, 'f1': 0.72369826, 'auroc': 0.8580854, 'binary_precision': 0.6712329, 'binary_recall': 0.9116279, 'binary_specificity': 0.5534884, 'binary_f1_score': 0.7731756}
confusion matrix:
     0    1
0  119   96
1   19  196
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-07-27 03:41:59.032508,epoch time: 0:01:53.125780,used: 0:03:53.222545,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_03_38_05_seed_0_23093150
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9814453, 'precision': 0.9815763, 'recall': 0.981599, 'specificity': 0.981599, 'f1': 0.98144525, 'auroc': 0.998456, 'binary_precision': 0.9934167, 'binary_recall': 0.96979433, 'binary_specificity': 0.9934037, 'binary_f1_score': 0.9814634}
confusion matrix:
      0     1
0  1506    10
1    47  1509
---- Validation: 
scalar performance:
{'acc': 0.80201864, 'precision': 0.8190471, 'recall': 0.80038464, 'specificity': 0.80038464, 'f1': 0.79871535, 'auroc': 0.9023212, 'binary_precision': 0.8893443, 'binary_recall': 0.6834646, 'binary_specificity': 0.91730475, 'binary_f1_score': 0.77292967}
confusion matrix:
     0    1
0  599   54
1  201  434
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.83255816, 'precision': 0.84009206, 'recall': 0.83255816, 'specificity': 0.83255816, 'f1': 0.8316257, 'auroc': 0.9182693, 'binary_precision': 0.89071035, 'binary_recall': 0.75813955, 'binary_specificity': 0.90697676, 'binary_f1_score': 0.8190955}
confusion matrix:
     0    1
0  195   20
1   52  163
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-07-27 03:43:52.879898,epoch time: 0:01:53.847390,used: 0:05:47.069935,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_03_38_05_seed_0_23093150
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9791667, 'precision': 0.9792193, 'recall': 0.9792763, 'specificity': 0.9792763, 'f1': 0.97916645, 'auroc': 0.9984082, 'binary_precision': 0.98821217, 'binary_recall': 0.97041804, 'binary_specificity': 0.9881345, 'binary_f1_score': 0.9792343}
confusion matrix:
      0     1
0  1499    18
1    46  1509
---- Validation: 
scalar performance:
{'acc': 0.8447205, 'precision': 0.854406, 'recall': 0.84356153, 'specificity': 0.84356153, 'f1': 0.8433147, 'auroc': 0.9202639, 'binary_precision': 0.90960455, 'binary_recall': 0.7606299, 'binary_specificity': 0.9264931, 'binary_f1_score': 0.8284734}
confusion matrix:
     0    1
0  605   48
1  152  483
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8023256, 'precision': 0.81492245, 'recall': 0.8023256, 'specificity': 0.8023256, 'f1': 0.80032885, 'auroc': 0.9021958, 'binary_precision': 0.877907, 'binary_recall': 0.7023256, 'binary_specificity': 0.9023256, 'binary_f1_score': 0.7803618}
confusion matrix:
     0    1
0  194   21
1   64  151
better model found
persisted
after epoch: 4,now: 2024-07-27 03:45:46.082134,epoch time: 0:01:53.202236,used: 0:07:40.272171,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_03_38_05_seed_0_23093150
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.97265625, 'precision': 0.9726647, 'recall': 0.9727288, 'specificity': 0.9727288, 'f1': 0.97265553, 'auroc': 0.99654603, 'binary_precision': 0.9791395, 'binary_recall': 0.96653795, 'binary_specificity': 0.9789196, 'binary_f1_score': 0.9727979}
confusion matrix:
      0     1
0  1486    32
1    52  1502
---- Validation: 
scalar performance:
{'acc': 0.8416149, 'precision': 0.8636993, 'recall': 0.839891, 'specificity': 0.839891, 'f1': 0.8386707, 'auroc': 0.93340486, 'binary_precision': 0.9498956, 'binary_recall': 0.71653545, 'binary_specificity': 0.9632466, 'binary_f1_score': 0.8168762}
confusion matrix:
     0    1
0  629   24
1  180  455
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.80697674, 'precision': 0.8607383, 'recall': 0.80697674, 'specificity': 0.80697674, 'f1': 0.7995068, 'auroc': 0.9268145, 'binary_precision': 1.0, 'binary_recall': 0.6139535, 'binary_specificity': 1.0, 'binary_f1_score': 0.7608069}
confusion matrix:
     0    1
0  215    0
1   83  132
early stop counter: 1
val acc:0.8416149020195007, best validation acc: 0.8447204828262329, corresponding to test acc:                         0.8023256063461304 / 0.8325581550598145
after epoch: 5,now: 2024-07-27 03:47:38.916296,epoch time: 0:01:52.834162,used: 0:09:33.106333,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_03_38_05_seed_0_23093150
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.98372394, 'precision': 0.9837127, 'recall': 0.98372996, 'specificity': 0.98372996, 'f1': 0.9837209, 'auroc': 0.99859214, 'binary_precision': 0.9845758, 'binary_recall': 0.98331195, 'binary_specificity': 0.98414797, 'binary_f1_score': 0.98394346}
confusion matrix:
      0     1
0  1490    24
1    26  1532
---- Validation: 
scalar performance:
{'acc': 0.8136646, 'precision': 0.8348935, 'recall': 0.8118918, 'specificity': 0.8118918, 'f1': 0.8100365, 'auroc': 0.9263725, 'binary_precision': 0.9157895, 'binary_recall': 0.68503934, 'binary_specificity': 0.93874425, 'binary_f1_score': 0.78378373}
confusion matrix:
     0    1
0  613   40
1  200  435
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.83255816, 'precision': 0.8695224, 'recall': 0.83255816, 'specificity': 0.83255816, 'f1': 0.8282634, 'auroc': 0.9320714, 'binary_precision': 0.9863946, 'binary_recall': 0.6744186, 'binary_specificity': 0.9906977, 'binary_f1_score': 0.801105}
confusion matrix:
     0    1
0  213    2
1   70  145
early stop counter: 2
val acc:0.8136646151542664, best validation acc: 0.8447204828262329, corresponding to test acc:                         0.8023256063461304 / 0.8325581550598145
after epoch: 6,now: 2024-07-27 03:49:32.883892,epoch time: 0:01:53.967596,used: 0:11:27.073929,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_03_38_05_seed_0_23093150
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9814453, 'precision': 0.98187023, 'recall': 0.98169553, 'specificity': 0.98169553, 'f1': 0.9814449, 'auroc': 0.999624, 'binary_precision': 1.0, 'binary_recall': 0.9633911, 'binary_specificity': 1.0, 'binary_f1_score': 0.9813543}
confusion matrix:
      0     1
0  1515     0
1    57  1500
---- Validation: 
scalar performance:
{'acc': 0.54736024, 'precision': 0.73836553, 'recall': 0.54100996, 'specificity': 0.54100996, 'f1': 0.4245589, 'auroc': 0.92107415, 'binary_precision': 0.94827586, 'binary_recall': 0.08661418, 'binary_specificity': 0.9954058, 'binary_f1_score': 0.15873016}
confusion matrix:
     0   1
0  650   3
1  580  55
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.54186046, 'precision': 0.7609223, 'recall': 0.54186046, 'specificity': 0.54186046, 'f1': 0.42015597, 'auroc': 0.9001838, 'binary_precision': 1.0, 'binary_recall': 0.08372093, 'binary_specificity': 1.0, 'binary_f1_score': 0.15450644}
confusion matrix:
     0   1
0  215   0
1  197  18
early stop counter: 3
val acc:0.5473602414131165, best validation acc: 0.8447204828262329, corresponding to test acc:                         0.8023256063461304 / 0.8325581550598145
after epoch: 7,now: 2024-07-27 03:51:25.930619,epoch time: 0:01:53.046727,used: 0:13:20.120656,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_03_38_05_seed_0_23093150
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9814453, 'precision': 0.981677, 'recall': 0.981598, 'specificity': 0.981598, 'f1': 0.98144513, 'auroc': 0.9988313, 'binary_precision': 0.99536425, 'binary_recall': 0.96780425, 'binary_specificity': 0.9953917, 'binary_f1_score': 0.9813908}
confusion matrix:
      0     1
0  1512     7
1    50  1503
---- Validation: 
scalar performance:
{'acc': 0.5248447, 'precision': 0.6936382, 'recall': 0.51819706, 'specificity': 0.51819706, 'f1': 0.38033113, 'auroc': 0.90042627, 'binary_precision': 0.87096775, 'binary_recall': 0.042519685, 'binary_specificity': 0.99387443, 'binary_f1_score': 0.081081085}
confusion matrix:
     0   1
0  649   4
1  608  27
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.4976744, 'precision': 0.24941725, 'recall': 0.4976744, 'specificity': 0.4976744, 'f1': 0.33229813, 'auroc': 0.9265549, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9953488, 'binary_f1_score': 0.0}
confusion matrix:
     0  1
0  214  1
1  215  0
early stop counter: 4
val acc:0.5248447060585022, best validation acc: 0.8447204828262329, corresponding to test acc:                         0.8023256063461304 / 0.8325581550598145
after epoch: 8,now: 2024-07-27 03:53:20.487883,epoch time: 0:01:54.557264,used: 0:15:14.677920,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_03_38_05_seed_0_23093150
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.99153644, 'precision': 0.9915407, 'recall': 0.9916157, 'specificity': 0.9916157, 'f1': 0.99153614, 'auroc': 0.99963504, 'binary_precision': 0.9980456, 'binary_recall': 0.985209, 'binary_specificity': 0.99802244, 'binary_f1_score': 0.99158573}
confusion matrix:
      0     1
0  1514     3
1    23  1532
---- Validation: 
scalar performance:
{'acc': 0.76785713, 'precision': 0.8072367, 'recall': 0.7653266, 'specificity': 0.7653266, 'f1': 0.7589939, 'auroc': 0.8978982, 'binary_precision': 0.9137931, 'binary_recall': 0.58425194, 'binary_specificity': 0.94640124, 'binary_f1_score': 0.7127761}
confusion matrix:
     0    1
0  618   35
1  264  371
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7860465, 'precision': 0.84681964, 'recall': 0.7860465, 'specificity': 0.7860465, 'f1': 0.77624434, 'auroc': 0.91848564, 'binary_precision': 0.992, 'binary_recall': 0.5767442, 'binary_specificity': 0.9953488, 'binary_f1_score': 0.7294118}
confusion matrix:
     0    1
0  214    1
1   91  124
early stop counter: 5
val acc:0.7678571343421936, best validation acc: 0.8447204828262329, corresponding to test acc:                         0.8023256063461304 / 0.8325581550598145
after epoch: 9,now: 2024-07-27 03:55:13.847795,epoch time: 0:01:53.359912,used: 0:17:08.037832,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_03_38_05_seed_0_23093150
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 9 with time: 0:17:08.037832 at 2024-07-27 03:55:13.847795
persisted model performance metric: 

scalar performance:
{'acc': 0.8023256, 'precision': 0.81492245, 'recall': 0.8023256, 'specificity': 0.8023256, 'f1': 0.80032885, 'auroc': 0.9021958, 'binary_precision': 0.877907, 'binary_recall': 0.7023256, 'binary_specificity': 0.9023256, 'binary_f1_score': 0.7803618}
confusion matrix:
     0    1
0  194   21
1   64  151
oracle model performance metric: 

scalar performance:
{'acc': 0.83255816, 'precision': 0.84009206, 'recall': 0.83255816, 'specificity': 0.83255816, 'f1': 0.8316257, 'auroc': 0.9182693, 'binary_precision': 0.89071035, 'binary_recall': 0.75813955, 'binary_specificity': 0.90697676, 'binary_f1_score': 0.8190955}
confusion matrix:
     0    1
0  195   20
1   52  163
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_dial_3seeds_nofreeze_2024-07-27_01-29-56/rule_results/2.csv
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_dial_3seeds_nofreeze_2024-07-27_01-29-56/rule_results/2.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_dial_3seeds_nofreeze_2024-07-27_01-29-56/confusion_matrix/2.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 459377 KiB |   6793 MiB |  56199 GiB |  56199 GiB |
|       from large pool | 418785 KiB |   6758 MiB |  55579 GiB |  55579 GiB |
|       from small pool |  40592 KiB |     56 MiB |    620 GiB |    620 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 459377 KiB |   6793 MiB |  56199 GiB |  56199 GiB |
|       from large pool | 418785 KiB |   6758 MiB |  55579 GiB |  55579 GiB |
|       from small pool |  40592 KiB |     56 MiB |    620 GiB |    620 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 447480 KiB |   6787 MiB |  56163 GiB |  56162 GiB |
|       from large pool | 407075 KiB |   6753 MiB |  55543 GiB |  55543 GiB |
|       from small pool |  40405 KiB |     56 MiB |    619 GiB |    619 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   7442 MiB |   7442 MiB |   7442 MiB |      0 B   |
|       from large pool |   7378 MiB |   7378 MiB |   7378 MiB |      0 B   |
|       from small pool |     64 MiB |     64 MiB |     64 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory | 402830 KiB | 694866 KiB |  34988 GiB |  34988 GiB |
|       from large pool | 394271 KiB | 685572 KiB |  34359 GiB |  34358 GiB |
|       from small pool |   8559 KiB |  14124 KiB |    629 GiB |    629 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    1298    |    1698    |    8329 K  |    8328 K  |
|       from large pool |     187    |     783    |    5079 K  |    5079 K  |
|       from small pool |    1111    |    1407    |    3250 K  |    3249 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    1298    |    1698    |    8329 K  |    8328 K  |
|       from large pool |     187    |     783    |    5079 K  |    5079 K  |
|       from small pool |    1111    |    1407    |    3250 K  |    3249 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     340    |     340    |     340    |       0    |
|       from large pool |     308    |     308    |     308    |       0    |
|       from small pool |      32    |      32    |      32    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      82    |     359    |    5158 K  |    5158 K  |
|       from large pool |      39    |     309    |    3711 K  |    3711 K  |
|       from small pool |      43    |     219    |    1447 K  |    1446 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   6793 MiB |  56199 GiB |  56199 GiB |
|       from large pool |  16640 KiB |   6758 MiB |  55579 GiB |  55579 GiB |
|       from small pool |      0 KiB |     56 MiB |    620 GiB |    620 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   6793 MiB |  56199 GiB |  56199 GiB |
|       from large pool |  16640 KiB |   6758 MiB |  55579 GiB |  55579 GiB |
|       from small pool |      0 KiB |     56 MiB |    620 GiB |    620 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   6787 MiB |  56163 GiB |  56163 GiB |
|       from large pool |  16640 KiB |   6753 MiB |  55543 GiB |  55543 GiB |
|       from small pool |      0 KiB |     56 MiB |    619 GiB |    619 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    842 MiB |   7442 MiB |   7442 MiB |   6600 MiB |
|       from large pool |    794 MiB |   7378 MiB |   7378 MiB |   6584 MiB |
|       from small pool |     48 MiB |     64 MiB |     64 MiB |     16 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 694866 KiB |  34988 GiB |  34988 GiB |
|       from large pool |  24320 KiB | 685572 KiB |  34359 GiB |  34359 GiB |
|       from small pool |      0 KiB |  25530 KiB |    629 GiB |    629 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    1698    |    8329 K  |    8329 K  |
|       from large pool |       2    |     783    |    5079 K  |    5079 K  |
|       from small pool |       0    |    1407    |    3250 K  |    3250 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    1698    |    8329 K  |    8329 K  |
|       from large pool |       2    |     783    |    5079 K  |    5079 K  |
|       from small pool |       0    |    1407    |    3250 K  |    3250 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      61    |     340    |     340    |     279    |
|       from large pool |      37    |     308    |     308    |     271    |
|       from small pool |      24    |      32    |      32    |       8    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |     359    |    5159 K  |    5159 K  |
|       from large pool |       4    |     309    |    3711 K  |    3711 K  |
|       from small pool |       0    |     219    |    1447 K  |    1447 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   6793 MiB |  56199 GiB |  56199 GiB |
|       from large pool |  16640 KiB |   6758 MiB |  55579 GiB |  55579 GiB |
|       from small pool |      0 KiB |     56 MiB |    620 GiB |    620 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   6793 MiB |  56199 GiB |  56199 GiB |
|       from large pool |  16640 KiB |   6758 MiB |  55579 GiB |  55579 GiB |
|       from small pool |      0 KiB |     56 MiB |    620 GiB |    620 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   6787 MiB |  56163 GiB |  56163 GiB |
|       from large pool |  16640 KiB |   6753 MiB |  55543 GiB |  55543 GiB |
|       from small pool |      0 KiB |     56 MiB |    619 GiB |    619 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    842 MiB |   7442 MiB |   7442 MiB |   6600 MiB |
|       from large pool |    794 MiB |   7378 MiB |   7378 MiB |   6584 MiB |
|       from small pool |     48 MiB |     64 MiB |     64 MiB |     16 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 694866 KiB |  34988 GiB |  34988 GiB |
|       from large pool |  24320 KiB | 685572 KiB |  34359 GiB |  34359 GiB |
|       from small pool |      0 KiB |  25530 KiB |    629 GiB |    629 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    1698    |    8329 K  |    8329 K  |
|       from large pool |       2    |     783    |    5079 K  |    5079 K  |
|       from small pool |       0    |    1407    |    3250 K  |    3250 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    1698    |    8329 K  |    8329 K  |
|       from large pool |       2    |     783    |    5079 K  |    5079 K  |
|       from small pool |       0    |    1407    |    3250 K  |    3250 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      61    |     340    |     340    |     279    |
|       from large pool |      37    |     308    |     308    |     271    |
|       from small pool |      24    |      32    |      32    |       8    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |     359    |    5159 K  |    5159 K  |
|       from large pool |       4    |     309    |    3711 K  |    3711 K  |
|       from small pool |       0    |     219    |    1447 K  |    1447 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_03_55_41_seed_1_23093150

 Experiment start at: 2024-07-27 03:55:41.309934
before training, model accuracy: 0.6177777647972107
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.945638, 'precision': 0.9499711, 'recall': 0.94637764, 'specificity': 0.94637764, 'f1': 0.945559, 'auroc': 0.99493814, 'binary_precision': 0.99785256, 'binary_recall': 0.8947368, 'binary_specificity': 0.9980185, 'binary_f1_score': 0.9434856}
confusion matrix:
      0     1
0  1511     3
1   164  1394
---- Validation: 
scalar performance:
{'acc': 0.8142077, 'precision': 0.84338367, 'recall': 0.8118024, 'specificity': 0.8118024, 'f1': 0.8093244, 'auroc': 0.908551, 'binary_precision': 0.9394619, 'binary_recall': 0.66507936, 'binary_specificity': 0.95852536, 'binary_f1_score': 0.7788104}
confusion matrix:
     0    1
0  624   27
1  211  419
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8088889, 'precision': 0.8399383, 'recall': 0.8088889, 'specificity': 0.8088889, 'f1': 0.804423, 'auroc': 0.9048691, 'binary_precision': 0.9426752, 'binary_recall': 0.6577778, 'binary_specificity': 0.96, 'binary_f1_score': 0.7748692}
confusion matrix:
     0    1
0  216    9
1   77  148
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-27 03:57:38.523114,epoch time: 0:01:57.213180,used: 0:01:57.213180,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_03_55_41_seed_1_23093150
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9785156, 'precision': 0.9790889, 'recall': 0.9787364, 'specificity': 0.9787364, 'f1': 0.97851384, 'auroc': 0.99886227, 'binary_precision': 0.9986586, 'binary_recall': 0.95878947, 'binary_specificity': 0.99868333, 'binary_f1_score': 0.97831804}
confusion matrix:
      0     1
0  1517     2
1    64  1489
---- Validation: 
scalar performance:
{'acc': 0.6814988, 'precision': 0.779276, 'recall': 0.67657447, 'specificity': 0.67657447, 'f1': 0.6472789, 'auroc': 0.8761027, 'binary_precision': 0.9404762, 'binary_recall': 0.37619048, 'binary_specificity': 0.9769585, 'binary_f1_score': 0.53741497}
confusion matrix:
     0    1
0  636   15
1  393  237
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7177778, 'precision': 0.7878289, 'recall': 0.7177778, 'specificity': 0.7177778, 'f1': 0.69949365, 'auroc': 0.88592595, 'binary_precision': 0.9298246, 'binary_recall': 0.47111112, 'binary_specificity': 0.96444446, 'binary_f1_score': 0.6253688}
confusion matrix:
     0    1
0  217    8
1  119  106
early stop counter: 1
val acc:0.6814988255500793, best validation acc: 0.8142076730728149, corresponding to test acc:                         0.8088889122009277 / 0.8088889122009277
after epoch: 2,now: 2024-07-27 03:59:31.516621,epoch time: 0:01:52.993507,used: 0:03:50.206687,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_03_55_41_seed_1_23093150
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.97786456, 'precision': 0.9783184, 'recall': 0.97810674, 'specificity': 0.97810674, 'f1': 0.9778638, 'auroc': 0.9987977, 'binary_precision': 0.9966622, 'binary_recall': 0.9595116, 'binary_specificity': 0.99670184, 'binary_f1_score': 0.9777341}
confusion matrix:
      0     1
0  1511     5
1    63  1493
---- Validation: 
scalar performance:
{'acc': 0.6635441, 'precision': 0.71487236, 'recall': 0.65942144, 'specificity': 0.65942144, 'f1': 0.6386862, 'auroc': 0.8541999, 'binary_precision': 0.815873, 'binary_recall': 0.4079365, 'binary_specificity': 0.9109063, 'binary_f1_score': 0.5439154}
confusion matrix:
     0    1
0  593   58
1  373  257
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.68666667, 'precision': 0.71, 'recall': 0.68666667, 'specificity': 0.68666667, 'f1': 0.6777143, 'auroc': 0.810963, 'binary_precision': 0.78, 'binary_recall': 0.52, 'binary_specificity': 0.85333335, 'binary_f1_score': 0.624}
confusion matrix:
     0    1
0  192   33
1  108  117
early stop counter: 2
val acc:0.6635441184043884, best validation acc: 0.8142076730728149, corresponding to test acc:                         0.8088889122009277 / 0.8088889122009277
after epoch: 3,now: 2024-07-27 04:01:25.442968,epoch time: 0:01:53.926347,used: 0:05:44.133034,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_03_55_41_seed_1_23093150
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.984375, 'precision': 0.984391, 'recall': 0.9843565, 'specificity': 0.9843565, 'f1': 0.9843721, 'auroc': 0.99910724, 'binary_precision': 0.9833226, 'binary_recall': 0.98585206, 'binary_specificity': 0.9828609, 'binary_f1_score': 0.98458576}
confusion matrix:
      0     1
0  1491    26
1    22  1533
---- Validation: 
scalar performance:
{'acc': 0.70569867, 'precision': 0.7921355, 'recall': 0.70117766, 'specificity': 0.70117766, 'f1': 0.6792261, 'auroc': 0.91078436, 'binary_precision': 0.94699645, 'binary_recall': 0.42539683, 'binary_specificity': 0.9769585, 'binary_f1_score': 0.5870756}
confusion matrix:
     0    1
0  636   15
1  362  268
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7222222, 'precision': 0.81263894, 'recall': 0.7222222, 'specificity': 0.7222222, 'f1': 0.7005733, 'auroc': 0.91190124, 'binary_precision': 0.9807692, 'binary_recall': 0.45333335, 'binary_specificity': 0.9911111, 'binary_f1_score': 0.6200608}
confusion matrix:
     0    1
0  223    2
1  123  102
early stop counter: 3
val acc:0.7056986689567566, best validation acc: 0.8142076730728149, corresponding to test acc:                         0.8088889122009277 / 0.8088889122009277
after epoch: 4,now: 2024-07-27 04:03:18.830105,epoch time: 0:01:53.387137,used: 0:07:37.520171,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_03_55_41_seed_1_23093150
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.97298175, 'precision': 0.9740787, 'recall': 0.97329473, 'specificity': 0.97329473, 'f1': 0.9729755, 'auroc': 0.99944854, 'binary_precision': 1.0, 'binary_recall': 0.94658947, 'binary_specificity': 1.0, 'binary_f1_score': 0.972562}
confusion matrix:
      0     1
0  1518     0
1    83  1471
---- Validation: 
scalar performance:
{'acc': 0.5690867, 'precision': 0.7374475, 'recall': 0.5620584, 'specificity': 0.5620584, 'f1': 0.46682957, 'auroc': 0.90704405, 'binary_precision': 0.93333334, 'binary_recall': 0.13333334, 'binary_specificity': 0.9907834, 'binary_f1_score': 0.23333333}
confusion matrix:
     0   1
0  645   6
1  546  84
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.52666664, 'precision': 0.7568493, 'recall': 0.52666664, 'specificity': 0.52666664, 'f1': 0.38999945, 'auroc': 0.91583216, 'binary_precision': 1.0, 'binary_recall': 0.053333335, 'binary_specificity': 1.0, 'binary_f1_score': 0.10126583}
confusion matrix:
     0   1
0  225   0
1  213  12
early stop counter: 4
val acc:0.5690866708755493, best validation acc: 0.8142076730728149, corresponding to test acc:                         0.8088889122009277 / 0.8088889122009277
after epoch: 5,now: 2024-07-27 04:05:12.013394,epoch time: 0:01:53.183289,used: 0:09:30.703460,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_03_55_41_seed_1_23093150
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.99088544, 'precision': 0.99093133, 'recall': 0.9908481, 'specificity': 0.9908481, 'f1': 0.990883, 'auroc': 0.9996625, 'binary_precision': 0.9884984, 'binary_recall': 0.9935774, 'binary_specificity': 0.9881188, 'binary_f1_score': 0.99103135}
confusion matrix:
      0     1
0  1497    18
1    10  1547
---- Validation: 
scalar performance:
{'acc': 0.8540203, 'precision': 0.85551023, 'recall': 0.85348177, 'specificity': 0.85348177, 'f1': 0.8536993, 'auroc': 0.9205063, 'binary_precision': 0.8747885, 'binary_recall': 0.8206349, 'binary_specificity': 0.8863287, 'binary_f1_score': 0.8468469}
confusion matrix:
     0    1
0  577   74
1  113  517
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8333333, 'precision': 0.8336563, 'recall': 0.8333333, 'specificity': 0.8333333, 'f1': 0.83329296, 'auroc': 0.9117037, 'binary_precision': 0.82327586, 'binary_recall': 0.8488889, 'binary_specificity': 0.81777775, 'binary_f1_score': 0.83588624}
confusion matrix:
     0    1
0  184   41
1   34  191
new oracle model saved
better model found
persisted
after epoch: 6,now: 2024-07-27 04:07:06.350169,epoch time: 0:01:54.336775,used: 0:11:25.040235,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_03_55_41_seed_1_23093150
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.98502606, 'precision': 0.9851539, 'recall': 0.98516876, 'specificity': 0.98516876, 'f1': 0.985026, 'auroc': 0.9991598, 'binary_precision': 0.99670833, 'binary_recall': 0.97363347, 'binary_specificity': 0.99670404, 'binary_f1_score': 0.9850358}
confusion matrix:
      0     1
0  1512     5
1    41  1514
---- Validation: 
scalar performance:
{'acc': 0.7619048, 'precision': 0.81405765, 'recall': 0.7585254, 'specificity': 0.7585254, 'f1': 0.7499586, 'auroc': 0.9157828, 'binary_precision': 0.9380054, 'binary_recall': 0.552381, 'binary_specificity': 0.96466976, 'binary_f1_score': 0.6953047}
confusion matrix:
     0    1
0  628   23
1  282  348
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8422222, 'precision': 0.8639706, 'recall': 0.8422222, 'specificity': 0.8422222, 'f1': 0.83982956, 'auroc': 0.9201976, 'binary_precision': 0.9529412, 'binary_recall': 0.72, 'binary_specificity': 0.96444446, 'binary_f1_score': 0.82025313}
confusion matrix:
     0    1
0  217    8
1   63  162
new oracle model saved
early stop counter: 1
val acc:0.761904776096344, best validation acc: 0.8540202975273132, corresponding to test acc:                         0.8333333134651184 / 0.8422222137451172
after epoch: 7,now: 2024-07-27 04:09:00.028222,epoch time: 0:01:53.678053,used: 0:13:18.718288,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_03_55_41_seed_1_23093150
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.96809894, 'precision': 0.96965134, 'recall': 0.9677719, 'specificity': 0.9677719, 'f1': 0.9680518, 'auroc': 0.9984671, 'binary_precision': 0.94556576, 'binary_recall': 0.9942122, 'binary_specificity': 0.94133157, 'binary_f1_score': 0.969279}
confusion matrix:
      0     1
0  1428    89
1     9  1546
---- Validation: 
scalar performance:
{'acc': 0.73458236, 'precision': 0.780426, 'recall': 0.7312084, 'specificity': 0.7312084, 'f1': 0.721365, 'auroc': 0.8856095, 'binary_precision': 0.88978493, 'binary_recall': 0.5253968, 'binary_specificity': 0.93701994, 'binary_f1_score': 0.6606786}
confusion matrix:
     0    1
0  610   41
1  299  331
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8066667, 'precision': 0.8246821, 'recall': 0.8066667, 'specificity': 0.8066667, 'f1': 0.8039471, 'auroc': 0.87782717, 'binary_precision': 0.9011628, 'binary_recall': 0.6888889, 'binary_specificity': 0.92444444, 'binary_f1_score': 0.78085643}
confusion matrix:
     0    1
0  208   17
1   70  155
early stop counter: 2
val acc:0.7345823645591736, best validation acc: 0.8540202975273132, corresponding to test acc:                         0.8333333134651184 / 0.8422222137451172
after epoch: 8,now: 2024-07-27 04:10:53.918711,epoch time: 0:01:53.890489,used: 0:15:12.608777,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_03_55_41_seed_1_23093150
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9866536, 'precision': 0.9868167, 'recall': 0.98680866, 'specificity': 0.98680866, 'f1': 0.9866537, 'auroc': 0.9993789, 'binary_precision': 0.99934036, 'binary_recall': 0.97427654, 'binary_specificity': 0.99934083, 'binary_f1_score': 0.98664933}
confusion matrix:
      0     1
0  1516     1
1    40  1515
---- Validation: 
scalar performance:
{'acc': 0.6010929, 'precision': 0.75091136, 'recall': 0.59464926, 'specificity': 0.59464926, 'f1': 0.5238317, 'auroc': 0.91843563, 'binary_precision': 0.94074076, 'binary_recall': 0.2015873, 'binary_specificity': 0.9877112, 'binary_f1_score': 0.33202618}
confusion matrix:
     0    1
0  643    8
1  503  127
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.58, 'precision': 0.7469512, 'recall': 0.58, 'specificity': 0.58, 'f1': 0.49457732, 'auroc': 0.89467657, 'binary_precision': 0.95, 'binary_recall': 0.16888888, 'binary_specificity': 0.9911111, 'binary_f1_score': 0.28679246}
confusion matrix:
     0   1
0  223   2
1  187  38
early stop counter: 3
val acc:0.6010928750038147, best validation acc: 0.8540202975273132, corresponding to test acc:                         0.8333333134651184 / 0.8422222137451172
after epoch: 9,now: 2024-07-27 04:12:47.025731,epoch time: 0:01:53.107020,used: 0:17:05.715797,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_03_55_41_seed_1_23093150
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9899089, 'precision': 0.9901943, 'recall': 0.98979056, 'specificity': 0.98979056, 'f1': 0.98990405, 'auroc': 0.99989784, 'binary_precision': 0.9810606, 'binary_recall': 0.9993569, 'binary_specificity': 0.98022413, 'binary_f1_score': 0.9901243}
confusion matrix:
      0     1
0  1487    30
1     1  1554
---- Validation: 
scalar performance:
{'acc': 0.86026543, 'precision': 0.8613756, 'recall': 0.85980546, 'specificity': 0.85980546, 'f1': 0.8600167, 'auroc': 0.9240656, 'binary_precision': 0.87772197, 'binary_recall': 0.83174604, 'binary_specificity': 0.8878648, 'binary_f1_score': 0.8541157}
confusion matrix:
     0    1
0  578   73
1  106  524
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.82, 'precision': 0.82183725, 'recall': 0.82, 'specificity': 0.82, 'f1': 0.81974274, 'auroc': 0.8676741, 'binary_precision': 0.84615386, 'binary_recall': 0.7822222, 'binary_specificity': 0.8577778, 'binary_f1_score': 0.812933}
confusion matrix:
     0    1
0  193   32
1   49  176
better model found
persisted
after epoch: 10,now: 2024-07-27 04:14:40.336548,epoch time: 0:01:53.310817,used: 0:18:59.026614,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_03_55_41_seed_1_23093150
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.98567706, 'precision': 0.9859859, 'recall': 0.98554087, 'specificity': 0.98554087, 'f1': 0.9856692, 'auroc': 0.9992416, 'binary_precision': 0.9766856, 'binary_recall': 0.9955042, 'binary_specificity': 0.97557753, 'binary_f1_score': 0.9860051}
confusion matrix:
      0     1
0  1478    37
1     7  1550
---- Validation: 
scalar performance:
{'acc': 0.85714287, 'precision': 0.8653586, 'recall': 0.855914, 'specificity': 0.855914, 'f1': 0.85600245, 'auroc': 0.92863727, 'binary_precision': 0.9162011, 'binary_recall': 0.7809524, 'binary_specificity': 0.9308756, 'binary_f1_score': 0.8431877}
confusion matrix:
     0    1
0  606   45
1  138  492
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.85555553, 'precision': 0.85810924, 'recall': 0.85555553, 'specificity': 0.85555553, 'f1': 0.8552976, 'auroc': 0.90374327, 'binary_precision': 0.88834953, 'binary_recall': 0.81333333, 'binary_specificity': 0.8977778, 'binary_f1_score': 0.84918797}
confusion matrix:
     0    1
0  202   23
1   42  183
new oracle model saved
early stop counter: 1
val acc:0.8571428656578064, best validation acc: 0.8602654337882996, corresponding to test acc:                         0.8199999928474426 / 0.855555534362793
after epoch: 11,now: 2024-07-27 04:16:34.280470,epoch time: 0:01:53.943922,used: 0:20:52.970536,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_03_55_41_seed_1_23093150
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9658203, 'precision': 0.9681078, 'recall': 0.9654164, 'specificity': 0.9654164, 'f1': 0.9657522, 'auroc': 0.99923146, 'binary_precision': 0.9383313, 'binary_recall': 0.9980707, 'binary_specificity': 0.932762, 'binary_f1_score': 0.9672795}
confusion matrix:
      0     1
0  1415   102
1     3  1552
---- Validation: 
scalar performance:
{'acc': 0.7915691, 'precision': 0.8232293, 'recall': 0.7941116, 'specificity': 0.7941116, 'f1': 0.7872751, 'auroc': 0.9116987, 'binary_precision': 0.71788716, 'binary_recall': 0.94920635, 'binary_specificity': 0.6390169, 'binary_f1_score': 0.8174983}
confusion matrix:
     0    1
0  416  235
1   32  598
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7644445, 'precision': 0.80727124, 'recall': 0.7644445, 'specificity': 0.7644445, 'f1': 0.7559403, 'auroc': 0.8724543, 'binary_precision': 0.6925566, 'binary_recall': 0.95111114, 'binary_specificity': 0.5777778, 'binary_f1_score': 0.8014982}
confusion matrix:
     0    1
0  130   95
1   11  214
early stop counter: 2
val acc:0.7915691137313843, best validation acc: 0.8602654337882996, corresponding to test acc:                         0.8199999928474426 / 0.855555534362793
after epoch: 12,now: 2024-07-27 04:18:27.728817,epoch time: 0:01:53.448347,used: 0:22:46.418883,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_03_55_41_seed_1_23093150
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9941406, 'precision': 0.9942, 'recall': 0.99409944, 'specificity': 0.99409944, 'f1': 0.9941392, 'auroc': 0.99984145, 'binary_precision': 0.9910543, 'binary_recall': 0.99742764, 'binary_specificity': 0.99077123, 'binary_f1_score': 0.99423075}
confusion matrix:
      0     1
0  1503    14
1     4  1551
---- Validation: 
scalar performance:
{'acc': 0.7993755, 'precision': 0.8100291, 'recall': 0.79782385, 'specificity': 0.79782385, 'f1': 0.79701984, 'auroc': 0.8931339, 'binary_precision': 0.86354774, 'binary_recall': 0.7031746, 'binary_specificity': 0.8924731, 'binary_f1_score': 0.77515304}
confusion matrix:
     0    1
0  581   70
1  187  443
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.83555555, 'precision': 0.8357943, 'recall': 0.83555555, 'specificity': 0.83555555, 'f1': 0.83552635, 'auroc': 0.88189626, 'binary_precision': 0.84474885, 'binary_recall': 0.82222223, 'binary_specificity': 0.8488889, 'binary_f1_score': 0.8333334}
confusion matrix:
     0    1
0  191   34
1   40  185
early stop counter: 3
val acc:0.7993754744529724, best validation acc: 0.8602654337882996, corresponding to test acc:                         0.8199999928474426 / 0.855555534362793
after epoch: 13,now: 2024-07-27 04:20:21.324768,epoch time: 0:01:53.595951,used: 0:24:40.014834,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_03_55_41_seed_1_23093150
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.98860675, 'precision': 0.9888356, 'recall': 0.98849887, 'specificity': 0.98849887, 'f1': 0.9886016, 'auroc': 0.9998486, 'binary_precision': 0.9810247, 'binary_recall': 0.99678665, 'binary_specificity': 0.9802111, 'binary_f1_score': 0.98884284}
confusion matrix:
      0     1
0  1486    30
1     5  1551
---- Validation: 
scalar performance:
{'acc': 0.79234976, 'precision': 0.8117707, 'recall': 0.7902714, 'specificity': 0.7902714, 'f1': 0.78821445, 'auroc': 0.8985419, 'binary_precision': 0.88559324, 'binary_recall': 0.6634921, 'binary_specificity': 0.9170507, 'binary_f1_score': 0.7586207}
confusion matrix:
     0    1
0  597   54
1  212  418
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7822222, 'precision': 0.7924111, 'recall': 0.7822223, 'specificity': 0.7822223, 'f1': 0.7803085, 'auroc': 0.8790716, 'binary_precision': 0.8469945, 'binary_recall': 0.6888889, 'binary_specificity': 0.8755556, 'binary_f1_score': 0.75980395}
confusion matrix:
     0    1
0  197   28
1   70  155
early stop counter: 4
val acc:0.7923497557640076, best validation acc: 0.8602654337882996, corresponding to test acc:                         0.8199999928474426 / 0.855555534362793
after epoch: 14,now: 2024-07-27 04:22:15.311403,epoch time: 0:01:53.986635,used: 0:26:34.001469,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_03_55_41_seed_1_23093150
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9869792, 'precision': 0.98710006, 'recall': 0.98710006, 'specificity': 0.98710006, 'f1': 0.9869791, 'auroc': 0.99972993, 'binary_precision': 0.998025, 'binary_recall': 0.9761751, 'binary_specificity': 0.998025, 'binary_f1_score': 0.9869791}
confusion matrix:
      0     1
0  1516     3
1    37  1516
---- Validation: 
scalar performance:
{'acc': 0.7494145, 'precision': 0.81780636, 'recall': 0.7455709, 'specificity': 0.7455709, 'f1': 0.73317784, 'auroc': 0.92745227, 'binary_precision': 0.96119404, 'binary_recall': 0.51111114, 'binary_specificity': 0.9800307, 'binary_f1_score': 0.66735756}
confusion matrix:
     0    1
0  638   13
1  308  322
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.79333335, 'precision': 0.84774256, 'recall': 0.7933333, 'specificity': 0.7933333, 'f1': 0.7849202, 'auroc': 0.93842965, 'binary_precision': 0.9852941, 'binary_recall': 0.59555554, 'binary_specificity': 0.9911111, 'binary_f1_score': 0.7423822}
confusion matrix:
     0    1
0  223    2
1   91  134
early stop counter: 5
val acc:0.7494145035743713, best validation acc: 0.8602654337882996, corresponding to test acc:                         0.8199999928474426 / 0.855555534362793
after epoch: 15,now: 2024-07-27 04:24:08.975415,epoch time: 0:01:53.664012,used: 0:28:27.665481,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_03_55_41_seed_1_23093150
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 15 with time: 0:28:27.665481 at 2024-07-27 04:24:08.975415
persisted model performance metric: 

scalar performance:
{'acc': 0.82, 'precision': 0.82183725, 'recall': 0.82, 'specificity': 0.82, 'f1': 0.81974274, 'auroc': 0.8676741, 'binary_precision': 0.84615386, 'binary_recall': 0.7822222, 'binary_specificity': 0.8577778, 'binary_f1_score': 0.812933}
confusion matrix:
     0    1
0  193   32
1   49  176
oracle model performance metric: 

scalar performance:
{'acc': 0.85555553, 'precision': 0.85810924, 'recall': 0.85555553, 'specificity': 0.85555553, 'f1': 0.8552976, 'auroc': 0.90374327, 'binary_precision': 0.88834953, 'binary_recall': 0.81333333, 'binary_specificity': 0.8977778, 'binary_f1_score': 0.84918797}
confusion matrix:
     0    1
0  202   23
1   42  183
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_dial_3seeds_nofreeze_2024-07-27_01-29-56/rule_results/2.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_dial_3seeds_nofreeze_2024-07-27_01-29-56/confusion_matrix/2.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 456522 KiB |   6793 MiB | 149826 GiB | 149826 GiB |
|       from large pool | 415924 KiB |   6758 MiB | 148170 GiB | 148170 GiB |
|       from small pool |  40598 KiB |     60 MiB |   1655 GiB |   1655 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 456522 KiB |   6793 MiB | 149826 GiB | 149826 GiB |
|       from large pool | 415924 KiB |   6758 MiB | 148170 GiB | 148170 GiB |
|       from small pool |  40598 KiB |     60 MiB |   1655 GiB |   1655 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 447481 KiB |   6787 MiB | 149664 GiB | 149664 GiB |
|       from large pool | 407075 KiB |   6753 MiB | 148011 GiB | 148010 GiB |
|       from small pool |  40406 KiB |     60 MiB |   1653 GiB |   1653 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   7436 MiB |   7442 MiB |  14036 MiB |   6600 MiB |
|       from large pool |   7368 MiB |   7378 MiB |  13952 MiB |   6584 MiB |
|       from small pool |     68 MiB |     68 MiB |     84 MiB |     16 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 385205 KiB | 694866 KiB |  92904 GiB |  92903 GiB |
|       from large pool | 376652 KiB | 685572 KiB |  91225 GiB |  91225 GiB |
|       from small pool |   8553 KiB |  25530 KiB |   1678 GiB |   1678 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    1310    |    1702    |   22200 K  |   22198 K  |
|       from large pool |     187    |     783    |   13533 K  |   13533 K  |
|       from small pool |    1123    |    1419    |    8666 K  |    8665 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    1310    |    1702    |   22200 K  |   22198 K  |
|       from large pool |     187    |     783    |   13533 K  |   13533 K  |
|       from small pool |    1123    |    1419    |    8666 K  |    8665 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     343    |     343    |     622    |     279    |
|       from large pool |     309    |     309    |     580    |     271    |
|       from small pool |      34    |      34    |      42    |       8    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      77    |     359    |   13683 K  |   13683 K  |
|       from large pool |      37    |     311    |    9835 K  |    9835 K  |
|       from small pool |      40    |     224    |    3847 K  |    3847 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   6793 MiB | 149826 GiB | 149826 GiB |
|       from large pool |  16640 KiB |   6758 MiB | 148170 GiB | 148170 GiB |
|       from small pool |      0 KiB |     60 MiB |   1655 GiB |   1655 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   6793 MiB | 149826 GiB | 149826 GiB |
|       from large pool |  16640 KiB |   6758 MiB | 148170 GiB | 148170 GiB |
|       from small pool |      0 KiB |     60 MiB |   1655 GiB |   1655 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   6787 MiB | 149664 GiB | 149664 GiB |
|       from large pool |  16640 KiB |   6753 MiB | 148011 GiB | 148011 GiB |
|       from small pool |      0 KiB |     60 MiB |   1653 GiB |   1653 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    822 MiB |   7442 MiB |  14036 MiB |  13214 MiB |
|       from large pool |    774 MiB |   7378 MiB |  13952 MiB |  13178 MiB |
|       from small pool |     48 MiB |     68 MiB |     84 MiB |     36 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 694866 KiB |  92904 GiB |  92904 GiB |
|       from large pool |  24320 KiB | 685572 KiB |  91226 GiB |  91226 GiB |
|       from small pool |      0 KiB |  32856 KiB |   1678 GiB |   1678 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    1702    |   22200 K  |   22200 K  |
|       from large pool |       2    |     783    |   13533 K  |   13533 K  |
|       from small pool |       0    |    1419    |    8666 K  |    8666 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    1702    |   22200 K  |   22200 K  |
|       from large pool |       2    |     783    |   13533 K  |   13533 K  |
|       from small pool |       0    |    1419    |    8666 K  |    8666 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      60    |     343    |     622    |     562    |
|       from large pool |      36    |     309    |     580    |     544    |
|       from small pool |      24    |      34    |      42    |      18    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |     359    |   13683 K  |   13683 K  |
|       from large pool |       4    |     311    |    9835 K  |    9835 K  |
|       from small pool |       0    |     224    |    3847 K  |    3847 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   6793 MiB | 149826 GiB | 149826 GiB |
|       from large pool |  16640 KiB |   6758 MiB | 148170 GiB | 148170 GiB |
|       from small pool |      0 KiB |     60 MiB |   1655 GiB |   1655 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   6793 MiB | 149826 GiB | 149826 GiB |
|       from large pool |  16640 KiB |   6758 MiB | 148170 GiB | 148170 GiB |
|       from small pool |      0 KiB |     60 MiB |   1655 GiB |   1655 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   6787 MiB | 149664 GiB | 149664 GiB |
|       from large pool |  16640 KiB |   6753 MiB | 148011 GiB | 148011 GiB |
|       from small pool |      0 KiB |     60 MiB |   1653 GiB |   1653 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    822 MiB |   7442 MiB |  14036 MiB |  13214 MiB |
|       from large pool |    774 MiB |   7378 MiB |  13952 MiB |  13178 MiB |
|       from small pool |     48 MiB |     68 MiB |     84 MiB |     36 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 694866 KiB |  92904 GiB |  92904 GiB |
|       from large pool |  24320 KiB | 685572 KiB |  91226 GiB |  91226 GiB |
|       from small pool |      0 KiB |  32856 KiB |   1678 GiB |   1678 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    1702    |   22200 K  |   22200 K  |
|       from large pool |       2    |     783    |   13533 K  |   13533 K  |
|       from small pool |       0    |    1419    |    8666 K  |    8666 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    1702    |   22200 K  |   22200 K  |
|       from large pool |       2    |     783    |   13533 K  |   13533 K  |
|       from small pool |       0    |    1419    |    8666 K  |    8666 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      60    |     343    |     622    |     562    |
|       from large pool |      36    |     309    |     580    |     544    |
|       from small pool |      24    |      34    |      42    |      18    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |     359    |   13683 K  |   13683 K  |
|       from large pool |       4    |     311    |    9835 K  |    9835 K  |
|       from small pool |       0    |     224    |    3847 K  |    3847 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_04_24_36_seed_2_23093150

 Experiment start at: 2024-07-27 04:24:36.663833
before training, model accuracy: 0.41203704476356506
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.947644, 'precision': 0.95113873, 'recall': 0.94800055, 'specificity': 0.94800055, 'f1': 0.9475684, 'auroc': 0.99260783, 'binary_precision': 0.99285716, 'binary_recall': 0.9025974, 'binary_specificity': 0.9934037, 'binary_f1_score': 0.9455782}
confusion matrix:
      0     1
0  1506    10
1   150  1390
---- Validation: 
scalar performance:
{'acc': 0.8239437, 'precision': 0.8314766, 'recall': 0.8218816, 'specificity': 0.8218816, 'f1': 0.8221877, 'auroc': 0.89354265, 'binary_precision': 0.8752363, 'binary_recall': 0.74437296, 'binary_specificity': 0.8993902, 'binary_f1_score': 0.80451775}
confusion matrix:
     0    1
0  590   66
1  159  463
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8009259, 'precision': 0.8053502, 'recall': 0.8009259, 'specificity': 0.8009259, 'f1': 0.80020225, 'auroc': 0.8783008, 'binary_precision': 0.84210527, 'binary_recall': 0.7407407, 'binary_specificity': 0.8611111, 'binary_f1_score': 0.7881774}
confusion matrix:
     0    1
0  186   30
1   56  160
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-27 04:26:34.827975,epoch time: 0:01:58.164142,used: 0:01:58.164142,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_04_24_36_seed_2_23093150
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9816754, 'precision': 0.98168707, 'recall': 0.98166394, 'specificity': 0.98166394, 'f1': 0.98167384, 'auroc': 0.9980335, 'binary_precision': 0.98056996, 'binary_recall': 0.98311687, 'binary_specificity': 0.9802111, 'binary_f1_score': 0.9818418}
confusion matrix:
      0     1
0  1486    30
1    26  1514
---- Validation: 
scalar performance:
{'acc': 0.7394366, 'precision': 0.7829262, 'recall': 0.73406494, 'specificity': 0.73406494, 'f1': 0.7260009, 'auroc': 0.87775713, 'binary_precision': 0.88739944, 'binary_recall': 0.5321543, 'binary_specificity': 0.9359756, 'binary_f1_score': 0.6653266}
confusion matrix:
     0    1
0  614   42
1  291  331
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5532407, 'precision': 0.66206694, 'recall': 0.5532408, 'specificity': 0.5532408, 'f1': 0.46311212, 'auroc': 0.8097565, 'binary_precision': 0.7948718, 'binary_recall': 0.14351852, 'binary_specificity': 0.962963, 'binary_f1_score': 0.24313727}
confusion matrix:
     0   1
0  208   8
1  185  31
early stop counter: 1
val acc:0.7394366264343262, best validation acc: 0.8239436745643616, corresponding to test acc:                         0.8009259104728699 / 0.8009259104728699
after epoch: 2,now: 2024-07-27 04:28:27.634915,epoch time: 0:01:52.806940,used: 0:03:50.971082,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_04_24_36_seed_2_23093150
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9826571, 'precision': 0.9827975, 'recall': 0.982602, 'specificity': 0.982602, 'f1': 0.9826533, 'auroc': 0.9980228, 'binary_precision': 0.97629726, 'binary_recall': 0.9896104, 'binary_specificity': 0.9755937, 'binary_f1_score': 0.9829088}
confusion matrix:
      0     1
0  1479    37
1    16  1524
---- Validation: 
scalar performance:
{'acc': 0.7809077, 'precision': 0.8208115, 'recall': 0.7761278, 'specificity': 0.7761278, 'f1': 0.771749, 'auroc': 0.89288586, 'binary_precision': 0.9275, 'binary_recall': 0.596463, 'binary_specificity': 0.95579267, 'binary_f1_score': 0.7260274}
confusion matrix:
     0    1
0  627   29
1  251  371
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7175926, 'precision': 0.81473213, 'recall': 0.7175926, 'specificity': 0.7175926, 'f1': 0.69398, 'auroc': 0.8971622, 'binary_precision': 0.9895833, 'binary_recall': 0.4398148, 'binary_specificity': 0.9953704, 'binary_f1_score': 0.60897434}
confusion matrix:
     0   1
0  215   1
1  121  95
early stop counter: 2
val acc:0.7809076905250549, best validation acc: 0.8239436745643616, corresponding to test acc:                         0.8009259104728699 / 0.8009259104728699
after epoch: 3,now: 2024-07-27 04:30:20.121763,epoch time: 0:01:52.486848,used: 0:05:43.457930,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_04_24_36_seed_2_23093150
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.97742146, 'precision': 0.97768927, 'recall': 0.9773404, 'specificity': 0.9773404, 'f1': 0.97741413, 'auroc': 0.99868625, 'binary_precision': 0.96817315, 'binary_recall': 0.9876623, 'binary_specificity': 0.9670185, 'binary_f1_score': 0.97782063}
confusion matrix:
      0     1
0  1466    50
1    19  1521
---- Validation: 
scalar performance:
{'acc': 0.81377155, 'precision': 0.81841934, 'recall': 0.8153478, 'specificity': 0.8153478, 'f1': 0.81350845, 'auroc': 0.90189004, 'binary_precision': 0.77272725, 'binary_recall': 0.8745981, 'binary_specificity': 0.75609756, 'binary_f1_score': 0.82051283}
confusion matrix:
     0    1
0  496  160
1   78  544
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7800926, 'precision': 0.7966292, 'recall': 0.7800926, 'specificity': 0.7800926, 'f1': 0.7769844, 'auroc': 0.8787937, 'binary_precision': 0.72659177, 'binary_recall': 0.8981481, 'binary_specificity': 0.662037, 'binary_f1_score': 0.80331266}
confusion matrix:
     0    1
0  143   73
1   22  194
early stop counter: 3
val acc:0.8137715458869934, best validation acc: 0.8239436745643616, corresponding to test acc:                         0.8009259104728699 / 0.8009259104728699
after epoch: 4,now: 2024-07-27 04:32:13.362899,epoch time: 0:01:53.241136,used: 0:07:36.699066,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_04_24_36_seed_2_23093150
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.96138746, 'precision': 0.96342504, 'recall': 0.96113837, 'specificity': 0.96113837, 'f1': 0.96132785, 'auroc': 0.99748135, 'binary_precision': 0.9345966, 'binary_recall': 0.99285716, 'binary_specificity': 0.9294195, 'binary_f1_score': 0.9628464}
confusion matrix:
      0     1
0  1409   107
1    11  1529
---- Validation: 
scalar performance:
{'acc': 0.7363067, 'precision': 0.7449604, 'recall': 0.73864055, 'specificity': 0.73864055, 'f1': 0.73507905, 'auroc': 0.81873727, 'binary_precision': 0.69179004, 'binary_recall': 0.82636654, 'binary_specificity': 0.6509146, 'binary_f1_score': 0.75311357}
confusion matrix:
     0    1
0  427  229
1  108  514
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6203704, 'precision': 0.72162586, 'recall': 0.6203704, 'specificity': 0.6203704, 'f1': 0.57141817, 'auroc': 0.804441, 'binary_precision': 0.5718232, 'binary_recall': 0.9583333, 'binary_specificity': 0.2824074, 'binary_f1_score': 0.71626294}
confusion matrix:
    0    1
0  61  155
1   9  207
early stop counter: 4
val acc:0.7363067269325256, best validation acc: 0.8239436745643616, corresponding to test acc:                         0.8009259104728699 / 0.8009259104728699
after epoch: 5,now: 2024-07-27 04:34:06.108006,epoch time: 0:01:52.745107,used: 0:09:29.444173,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_04_24_36_seed_2_23093150
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9846204, 'precision': 0.98462856, 'recall': 0.98461175, 'specificity': 0.98461175, 'f1': 0.9846192, 'auroc': 0.9983436, 'binary_precision': 0.9837978, 'binary_recall': 0.98571426, 'binary_specificity': 0.98350924, 'binary_f1_score': 0.9847551}
confusion matrix:
      0     1
0  1491    25
1    22  1518
---- Validation: 
scalar performance:
{'acc': 0.76760566, 'precision': 0.79660845, 'recall': 0.77166986, 'specificity': 0.77166986, 'f1': 0.76346946, 'auroc': 0.8571534, 'binary_precision': 0.6969697, 'binary_recall': 0.9244373, 'binary_specificity': 0.61890244, 'binary_f1_score': 0.7947477}
confusion matrix:
     0    1
0  406  250
1   47  575
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6666667, 'precision': 0.74107146, 'recall': 0.6666666, 'specificity': 0.6666666, 'f1': 0.638796, 'auroc': 0.8288109, 'binary_precision': 0.60714287, 'binary_recall': 0.9444444, 'binary_specificity': 0.3888889, 'binary_f1_score': 0.73913044}
confusion matrix:
    0    1
0  84  132
1  12  204
early stop counter: 5
val acc:0.7676056623458862, best validation acc: 0.8239436745643616, corresponding to test acc:                         0.8009259104728699 / 0.8009259104728699
after epoch: 6,now: 2024-07-27 04:35:59.992712,epoch time: 0:01:53.884706,used: 0:11:23.328879,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_04_24_36_seed_2_23093150
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 6 with time: 0:11:23.328879 at 2024-07-27 04:35:59.992712
persisted model performance metric: 

scalar performance:
{'acc': 0.8009259, 'precision': 0.8053502, 'recall': 0.8009259, 'specificity': 0.8009259, 'f1': 0.80020225, 'auroc': 0.8783008, 'binary_precision': 0.84210527, 'binary_recall': 0.7407407, 'binary_specificity': 0.8611111, 'binary_f1_score': 0.7881774}
confusion matrix:
     0    1
0  186   30
1   56  160
oracle model performance metric: 

scalar performance:
{'acc': 0.8009259, 'precision': 0.8053502, 'recall': 0.8009259, 'specificity': 0.8009259, 'f1': 0.80020225, 'auroc': 0.8783008, 'binary_precision': 0.84210527, 'binary_recall': 0.7407407, 'binary_specificity': 0.8611111, 'binary_f1_score': 0.7881774}
confusion matrix:
     0    1
0  186   30
1   56  160
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_dial_3seeds_nofreeze_2024-07-27_01-29-56/rule_results/2.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_dial_3seeds_nofreeze_2024-07-27_01-29-56/confusion_matrix/2.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 456516 KiB |   6793 MiB | 187199 GiB | 187198 GiB |
|       from large pool | 415924 KiB |   6758 MiB | 185130 GiB | 185130 GiB |
|       from small pool |  40592 KiB |     60 MiB |   2068 GiB |   2068 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 456516 KiB |   6793 MiB | 187199 GiB | 187198 GiB |
|       from large pool | 415924 KiB |   6758 MiB | 185130 GiB | 185130 GiB |
|       from small pool |  40592 KiB |     60 MiB |   2068 GiB |   2068 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 447481 KiB |   6787 MiB | 186985 GiB | 186984 GiB |
|       from large pool | 407075 KiB |   6753 MiB | 184919 GiB | 184919 GiB |
|       from small pool |  40406 KiB |     60 MiB |   2065 GiB |   2065 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   7438 MiB |   7442 MiB |  20652 MiB |  13214 MiB |
|       from large pool |   7374 MiB |   7378 MiB |  20552 MiB |  13178 MiB |
|       from small pool |     64 MiB |     68 MiB |    100 MiB |     36 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 364731 KiB | 695287 KiB | 115997 GiB | 115997 GiB |
|       from large pool | 356172 KiB | 685993 KiB | 113902 GiB | 113901 GiB |
|       from small pool |   8559 KiB |  32856 KiB |   2095 GiB |   2095 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    1298    |    1702    |   27737 K  |   27736 K  |
|       from large pool |     187    |     783    |   16908 K  |   16908 K  |
|       from small pool |    1111    |    1419    |   10829 K  |   10828 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    1298    |    1702    |   27737 K  |   27736 K  |
|       from large pool |     187    |     783    |   16908 K  |   16908 K  |
|       from small pool |    1111    |    1419    |   10829 K  |   10828 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     341    |     343    |     903    |     562    |
|       from large pool |     309    |     309    |     853    |     544    |
|       from small pool |      32    |      34    |      50    |      18    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      79    |     359    |   17114 K  |   17114 K  |
|       from large pool |      35    |     311    |   12326 K  |   12326 K  |
|       from small pool |      44    |     224    |    4788 K  |    4788 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   6793 MiB | 187199 GiB | 187199 GiB |
|       from large pool |  16640 KiB |   6758 MiB | 185130 GiB | 185130 GiB |
|       from small pool |      0 KiB |     60 MiB |   2068 GiB |   2068 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   6793 MiB | 187199 GiB | 187199 GiB |
|       from large pool |  16640 KiB |   6758 MiB | 185130 GiB | 185130 GiB |
|       from small pool |      0 KiB |     60 MiB |   2068 GiB |   2068 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   6787 MiB | 186985 GiB | 186985 GiB |
|       from large pool |  16640 KiB |   6753 MiB | 184919 GiB | 184919 GiB |
|       from small pool |      0 KiB |     60 MiB |   2065 GiB |   2065 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    802 MiB |   7442 MiB |  20652 MiB |  19850 MiB |
|       from large pool |    754 MiB |   7378 MiB |  20552 MiB |  19798 MiB |
|       from small pool |     48 MiB |     68 MiB |    100 MiB |     52 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 695287 KiB | 115998 GiB | 115998 GiB |
|       from large pool |  24320 KiB | 685993 KiB | 113902 GiB | 113902 GiB |
|       from small pool |      0 KiB |  32862 KiB |   2095 GiB |   2095 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    1702    |   27737 K  |   27737 K  |
|       from large pool |       2    |     783    |   16908 K  |   16908 K  |
|       from small pool |       0    |    1419    |   10829 K  |   10829 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    1702    |   27737 K  |   27737 K  |
|       from large pool |       2    |     783    |   16908 K  |   16908 K  |
|       from small pool |       0    |    1419    |   10829 K  |   10829 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      59    |     343    |     903    |     844    |
|       from large pool |      35    |     309    |     853    |     818    |
|       from small pool |      24    |      34    |      50    |      26    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |     359    |   17114 K  |   17114 K  |
|       from large pool |       4    |     311    |   12326 K  |   12326 K  |
|       from small pool |       0    |     224    |    4788 K  |    4788 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Sat Jul 27 04:36:05 2024]
Finished job 0.
1 of 1 steps (100%) done
