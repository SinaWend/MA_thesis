Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Sat Jul 27 04:11:28 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_dial_3seeds_nofreeze_2024-07-27_01-29-56/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_dial_3seeds_nofreeze_2024-07-27_01-29-56/rule_results/3.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=3
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/swiglu_ffn.py:51: UserWarning: xFormers is not available (SwiGLU)
  warnings.warn("xFormers is not available (SwiGLU)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/attention.py:33: UserWarning: xFormers is not available (Attention)
  warnings.warn("xFormers is not available (Attention)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/block.py:40: UserWarning: xFormers is not available (Block)
  warnings.warn("xFormers is not available (Block)")
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_04_12_11_seed_0_23093154

 Experiment start at: 2024-07-27 04:12:12.041003
before training, model accuracy: 0.569767415523529
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9654948, 'precision': 0.96580935, 'recall': 0.96569085, 'specificity': 0.96569085, 'f1': 0.9654943, 'auroc': 0.9943657, 'binary_precision': 0.98139536, 'binary_recall': 0.94983923, 'binary_specificity': 0.9815425, 'binary_f1_score': 0.9653595}
confusion matrix:
      0     1
0  1489    28
1    78  1477
---- Validation: 
scalar performance:
{'acc': 0.7756211, 'precision': 0.78081965, 'recall': 0.7746331, 'specificity': 0.7746331, 'f1': 0.77412, 'auroc': 0.8740157, 'binary_precision': 0.81569344, 'binary_recall': 0.703937, 'binary_specificity': 0.8453292, 'binary_f1_score': 0.7557059}
confusion matrix:
     0    1
0  552  101
1  188  447
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.83255816, 'precision': 0.8335973, 'recall': 0.83255816, 'specificity': 0.83255816, 'f1': 0.8324276, 'auroc': 0.90269333, 'binary_precision': 0.81497794, 'binary_recall': 0.8604651, 'binary_specificity': 0.80465114, 'binary_f1_score': 0.8371041}
confusion matrix:
     0    1
0  173   42
1   30  185
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-27 04:15:16.380488,epoch time: 0:03:04.339485,used: 0:03:04.339485,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_04_12_11_seed_0_23093154
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9716797, 'precision': 0.97208166, 'recall': 0.9715264, 'specificity': 0.9715264, 'f1': 0.9716628, 'auroc': 0.99708766, 'binary_precision': 0.9610553, 'binary_recall': 0.98392284, 'binary_specificity': 0.95912987, 'binary_f1_score': 0.97235465}
confusion matrix:
      0     1
0  1455    62
1    25  1530
---- Validation: 
scalar performance:
{'acc': 0.86180127, 'precision': 0.8642513, 'recall': 0.86238194, 'specificity': 0.86238194, 'f1': 0.86168087, 'auroc': 0.92730343, 'binary_precision': 0.8306802, 'binary_recall': 0.903937, 'binary_specificity': 0.82082695, 'binary_f1_score': 0.8657617}
confusion matrix:
     0    1
0  536  117
1   61  574
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8255814, 'precision': 0.82677615, 'recall': 0.82558143, 'specificity': 0.82558143, 'f1': 0.8254218, 'auroc': 0.92125475, 'binary_precision': 0.84653467, 'binary_recall': 0.7953488, 'binary_specificity': 0.855814, 'binary_f1_score': 0.8201439}
confusion matrix:
     0    1
0  184   31
1   44  171
better model found
persisted
after epoch: 2,now: 2024-07-27 04:18:13.525374,epoch time: 0:02:57.144886,used: 0:06:01.484371,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_04_12_11_seed_0_23093154
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.98079425, 'precision': 0.9808395, 'recall': 0.98090005, 'specificity': 0.98090005, 'f1': 0.980794, 'auroc': 0.9987342, 'binary_precision': 0.9895288, 'binary_recall': 0.97234726, 'binary_specificity': 0.98945284, 'binary_f1_score': 0.9808628}
confusion matrix:
      0     1
0  1501    16
1    43  1512
---- Validation: 
scalar performance:
{'acc': 0.7181677, 'precision': 0.7619442, 'recall': 0.7152585, 'specificity': 0.7152585, 'f1': 0.7040829, 'auroc': 0.8598497, 'binary_precision': 0.8655914, 'binary_recall': 0.50708663, 'binary_specificity': 0.9234303, 'binary_f1_score': 0.6395233}
confusion matrix:
     0    1
0  603   50
1  313  322
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8372093, 'precision': 0.86175126, 'recall': 0.83720934, 'specificity': 0.83720934, 'f1': 0.83440065, 'auroc': 0.92964846, 'binary_precision': 0.9559748, 'binary_recall': 0.7069768, 'binary_specificity': 0.96744186, 'binary_f1_score': 0.81283426}
confusion matrix:
     0    1
0  208    7
1   63  152
new oracle model saved
early stop counter: 1
val acc:0.7181677222251892, best validation acc: 0.861801266670227, corresponding to test acc:                         0.8255813717842102 / 0.8372092843055725
after epoch: 3,now: 2024-07-27 04:21:11.023354,epoch time: 0:02:57.497980,used: 0:08:58.982351,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_04_12_11_seed_0_23093154
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9560547, 'precision': 0.9590666, 'recall': 0.9565561, 'specificity': 0.9565561, 'f1': 0.9560108, 'auroc': 0.99882245, 'binary_precision': 0.99929625, 'binary_recall': 0.9137709, 'binary_specificity': 0.99934125, 'binary_f1_score': 0.95462185}
confusion matrix:
      0     1
0  1517     1
1   134  1420
---- Validation: 
scalar performance:
{'acc': 0.5504658, 'precision': 0.71518886, 'recall': 0.54424644, 'specificity': 0.54424644, 'f1': 0.43463165, 'auroc': 0.8984481, 'binary_precision': 0.9, 'binary_recall': 0.0992126, 'binary_specificity': 0.9892802, 'binary_f1_score': 0.17872341}
confusion matrix:
     0   1
0  646   7
1  572  63
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5116279, 'precision': 0.7529412, 'recall': 0.5116279, 'specificity': 0.5116279, 'f1': 0.35866478, 'auroc': 0.9073229, 'binary_precision': 1.0, 'binary_recall': 0.023255814, 'binary_specificity': 1.0, 'binary_f1_score': 0.045454543}
confusion matrix:
     0  1
0  215  0
1  210  5
early stop counter: 2
val acc:0.5504658222198486, best validation acc: 0.861801266670227, corresponding to test acc:                         0.8255813717842102 / 0.8372092843055725
after epoch: 4,now: 2024-07-27 04:24:08.943561,epoch time: 0:02:57.920207,used: 0:11:56.902558,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_04_12_11_seed_0_23093154
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.976888, 'precision': 0.97783923, 'recall': 0.97660816, 'specificity': 0.97660816, 'f1': 0.97686195, 'auroc': 0.9992157, 'binary_precision': 0.9598021, 'binary_recall': 0.9961489, 'binary_specificity': 0.9570674, 'binary_f1_score': 0.97763777}
confusion matrix:
      0     1
0  1449    65
1     6  1552
---- Validation: 
scalar performance:
{'acc': 0.8781056, 'precision': 0.8791261, 'recall': 0.8784833, 'specificity': 0.8784833, 'f1': 0.87807906, 'auroc': 0.9378061, 'binary_precision': 0.8556548, 'binary_recall': 0.9055118, 'binary_specificity': 0.8514548, 'binary_f1_score': 0.87987757}
confusion matrix:
     0    1
0  556   97
1   60  575
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.90697676, 'precision': 0.9130168, 'recall': 0.9069767, 'specificity': 0.9069767, 'f1': 0.9066354, 'auroc': 0.9468037, 'binary_precision': 0.962963, 'binary_recall': 0.8465116, 'binary_specificity': 0.96744186, 'binary_f1_score': 0.90099007}
confusion matrix:
     0    1
0  208    7
1   33  182
new oracle model saved
better model found
persisted
after epoch: 5,now: 2024-07-27 04:27:06.226775,epoch time: 0:02:57.283214,used: 0:14:54.185772,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_04_12_11_seed_0_23093154
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.97753906, 'precision': 0.9782126, 'recall': 0.9777916, 'specificity': 0.9777916, 'f1': 0.97753674, 'auroc': 0.9991259, 'binary_precision': 0.9993275, 'binary_recall': 0.95624197, 'binary_specificity': 0.99934125, 'binary_f1_score': 0.97731006}
confusion matrix:
      0     1
0  1517     1
1    68  1486
---- Validation: 
scalar performance:
{'acc': 0.5364907, 'precision': 0.669734, 'recall': 0.53016, 'specificity': 0.53016, 'f1': 0.4118114, 'auroc': 0.8940559, 'binary_precision': 0.81666666, 'binary_recall': 0.07716536, 'binary_specificity': 0.98315465, 'binary_f1_score': 0.1410072}
confusion matrix:
     0   1
0  642  11
1  586  49
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.52093023, 'precision': 0.7553444, 'recall': 0.52093023, 'specificity': 0.52093023, 'f1': 0.3782289, 'auroc': 0.90680367, 'binary_precision': 1.0, 'binary_recall': 0.041860465, 'binary_specificity': 1.0, 'binary_f1_score': 0.08035714}
confusion matrix:
     0  1
0  215  0
1  206  9
early stop counter: 1
val acc:0.5364906787872314, best validation acc: 0.8781055808067322, corresponding to test acc:                         0.9069767594337463 / 0.9069767594337463
after epoch: 6,now: 2024-07-27 04:30:02.565063,epoch time: 0:02:56.338288,used: 0:17:50.524060,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_04_12_11_seed_0_23093154
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.97233075, 'precision': 0.9738797, 'recall': 0.9719911, 'specificity': 0.9719911, 'f1': 0.9722891, 'auroc': 0.99954295, 'binary_precision': 0.9498471, 'binary_recall': 0.99807197, 'binary_specificity': 0.9459103, 'binary_f1_score': 0.9733625}
confusion matrix:
      0     1
0  1434    82
1     3  1553
---- Validation: 
scalar performance:
{'acc': 0.85481364, 'precision': 0.8567869, 'recall': 0.8553388, 'specificity': 0.8553388, 'f1': 0.8547183, 'auroc': 0.9247712, 'binary_precision': 0.82653064, 'binary_recall': 0.8929134, 'binary_specificity': 0.81776416, 'binary_f1_score': 0.85844064}
confusion matrix:
     0    1
0  534  119
1   68  567
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.872093, 'precision': 0.8780552, 'recall': 0.872093, 'specificity': 0.872093, 'f1': 0.8715868, 'auroc': 0.936636, 'binary_precision': 0.9255319, 'binary_recall': 0.80930233, 'binary_specificity': 0.9348837, 'binary_f1_score': 0.8635236}
confusion matrix:
     0    1
0  201   14
1   41  174
early stop counter: 2
val acc:0.8548136353492737, best validation acc: 0.8781055808067322, corresponding to test acc:                         0.9069767594337463 / 0.9069767594337463
after epoch: 7,now: 2024-07-27 04:32:59.908307,epoch time: 0:02:57.343244,used: 0:20:47.867304,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_04_12_11_seed_0_23093154
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.97753906, 'precision': 0.97808343, 'recall': 0.9778153, 'specificity': 0.9778153, 'f1': 0.977538, 'auroc': 0.9988464, 'binary_precision': 0.997992, 'binary_recall': 0.9576108, 'binary_specificity': 0.9980198, 'binary_f1_score': 0.97738445}
confusion matrix:
      0     1
0  1512     3
1    66  1491
---- Validation: 
scalar performance:
{'acc': 0.6335404, 'precision': 0.76845616, 'recall': 0.62852013, 'specificity': 0.62852013, 'f1': 0.57613504, 'auroc': 0.9172975, 'binary_precision': 0.95530725, 'binary_recall': 0.26929134, 'binary_specificity': 0.98774886, 'binary_f1_score': 0.42014742}
confusion matrix:
     0    1
0  645    8
1  464  171
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7860465, 'precision': 0.84681964, 'recall': 0.7860465, 'specificity': 0.7860465, 'f1': 0.77624434, 'auroc': 0.9333694, 'binary_precision': 0.992, 'binary_recall': 0.5767442, 'binary_specificity': 0.9953488, 'binary_f1_score': 0.7294118}
confusion matrix:
     0    1
0  214    1
1   91  124
early stop counter: 3
val acc:0.6335403919219971, best validation acc: 0.8781055808067322, corresponding to test acc:                         0.9069767594337463 / 0.9069767594337463
after epoch: 8,now: 2024-07-27 04:35:56.991089,epoch time: 0:02:57.082782,used: 0:23:44.950086,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_04_12_11_seed_0_23093154
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9895833, 'precision': 0.989588, 'recall': 0.98967934, 'specificity': 0.98967934, 'f1': 0.98958296, 'auroc': 0.99948364, 'binary_precision': 0.99674267, 'binary_recall': 0.982659, 'binary_specificity': 0.9966997, 'binary_f1_score': 0.9896508}
confusion matrix:
      0     1
0  1510     5
1    27  1530
---- Validation: 
scalar performance:
{'acc': 0.74378884, 'precision': 0.80555356, 'recall': 0.7406133, 'specificity': 0.7406133, 'f1': 0.7284624, 'auroc': 0.92217684, 'binary_precision': 0.93948126, 'binary_recall': 0.51338583, 'binary_specificity': 0.96784073, 'binary_f1_score': 0.66395116}
confusion matrix:
     0    1
0  632   21
1  309  326
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.83023256, 'precision': 0.86345243, 'recall': 0.83023256, 'specificity': 0.83023256, 'f1': 0.82626265, 'auroc': 0.93869114, 'binary_precision': 0.97333336, 'binary_recall': 0.67906976, 'binary_specificity': 0.98139536, 'binary_f1_score': 0.8}
confusion matrix:
     0    1
0  211    4
1   69  146
early stop counter: 4
val acc:0.7437888383865356, best validation acc: 0.8781055808067322, corresponding to test acc:                         0.9069767594337463 / 0.9069767594337463
after epoch: 9,now: 2024-07-27 04:38:54.017026,epoch time: 0:02:57.025937,used: 0:26:41.976023,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_04_12_11_seed_0_23093154
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9892578, 'precision': 0.9894636, 'recall': 0.9891534, 'specificity': 0.9891534, 'f1': 0.98925304, 'auroc': 0.99970925, 'binary_precision': 0.98227847, 'binary_recall': 0.9967887, 'binary_specificity': 0.98151815, 'binary_f1_score': 0.98948044}
confusion matrix:
      0     1
0  1487    28
1     5  1552
---- Validation: 
scalar performance:
{'acc': 0.8439441, 'precision': 0.8468712, 'recall': 0.84329504, 'specificity': 0.84329504, 'f1': 0.8434131, 'auroc': 0.9180765, 'binary_precision': 0.87543255, 'binary_recall': 0.7968504, 'binary_specificity': 0.8897397, 'binary_f1_score': 0.8342951}
confusion matrix:
     0    1
0  581   72
1  129  506
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.87906975, 'precision': 0.8791026, 'recall': 0.8790698, 'specificity': 0.8790698, 'f1': 0.8790672, 'auroc': 0.94256353, 'binary_precision': 0.8826291, 'binary_recall': 0.8744186, 'binary_specificity': 0.88372093, 'binary_f1_score': 0.8785047}
confusion matrix:
     0    1
0  190   25
1   27  188
early stop counter: 5
val acc:0.8439440727233887, best validation acc: 0.8781055808067322, corresponding to test acc:                         0.9069767594337463 / 0.9069767594337463
after epoch: 10,now: 2024-07-27 04:41:51.230372,epoch time: 0:02:57.213346,used: 0:29:39.189369,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_04_12_11_seed_0_23093154
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 10 with time: 0:29:39.189369 at 2024-07-27 04:41:51.230372
persisted model performance metric: 

scalar performance:
{'acc': 0.90697676, 'precision': 0.9130168, 'recall': 0.9069767, 'specificity': 0.9069767, 'f1': 0.9066354, 'auroc': 0.9468037, 'binary_precision': 0.962963, 'binary_recall': 0.8465116, 'binary_specificity': 0.96744186, 'binary_f1_score': 0.90099007}
confusion matrix:
     0    1
0  208    7
1   33  182
oracle model performance metric: 

scalar performance:
{'acc': 0.90697676, 'precision': 0.9130168, 'recall': 0.9069767, 'specificity': 0.9069767, 'f1': 0.9066354, 'auroc': 0.9468037, 'binary_precision': 0.962963, 'binary_recall': 0.8465116, 'binary_specificity': 0.96744186, 'binary_f1_score': 0.90099007}
confusion matrix:
     0    1
0  208    7
1   33  182
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_dial_3seeds_nofreeze_2024-07-27_01-29-56/rule_results/3.csv
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_dial_3seeds_nofreeze_2024-07-27_01-29-56/rule_results/3.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_dial_3seeds_nofreeze_2024-07-27_01-29-56/confusion_matrix/3.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 459377 KiB |   6793 MiB |  62116 GiB |  62116 GiB |
|       from large pool | 418785 KiB |   6758 MiB |  61427 GiB |  61427 GiB |
|       from small pool |  40592 KiB |     56 MiB |    688 GiB |    688 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 459377 KiB |   6793 MiB |  62116 GiB |  62116 GiB |
|       from large pool | 418785 KiB |   6758 MiB |  61427 GiB |  61427 GiB |
|       from small pool |  40592 KiB |     56 MiB |    688 GiB |    688 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 447480 KiB |   6787 MiB |  62075 GiB |  62075 GiB |
|       from large pool | 407075 KiB |   6753 MiB |  61388 GiB |  61387 GiB |
|       from small pool |  40405 KiB |     56 MiB |    687 GiB |    687 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   7460 MiB |   7460 MiB |   7460 MiB |      0 B   |
|       from large pool |   7396 MiB |   7396 MiB |   7396 MiB |      0 B   |
|       from small pool |     64 MiB |     64 MiB |     64 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory | 402830 KiB | 685265 KiB |  38630 GiB |  38630 GiB |
|       from large pool | 394271 KiB | 679932 KiB |  37931 GiB |  37931 GiB |
|       from small pool |   8559 KiB |  14124 KiB |    698 GiB |    698 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    1298    |    1698    |    9249 K  |    9247 K  |
|       from large pool |     187    |     783    |    5641 K  |    5641 K  |
|       from small pool |    1111    |    1407    |    3607 K  |    3606 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    1298    |    1698    |    9249 K  |    9247 K  |
|       from large pool |     187    |     783    |    5641 K  |    5641 K  |
|       from small pool |    1111    |    1407    |    3607 K  |    3606 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     341    |     341    |     341    |       0    |
|       from large pool |     309    |     309    |     309    |       0    |
|       from small pool |      32    |      32    |      32    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      83    |     359    |    5585 K  |    5585 K  |
|       from large pool |      39    |     309    |    3978 K  |    3978 K  |
|       from small pool |      44    |     219    |    1606 K  |    1606 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   6793 MiB |  62116 GiB |  62116 GiB |
|       from large pool |  16640 KiB |   6758 MiB |  61427 GiB |  61427 GiB |
|       from small pool |      0 KiB |     56 MiB |    688 GiB |    688 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   6793 MiB |  62116 GiB |  62116 GiB |
|       from large pool |  16640 KiB |   6758 MiB |  61427 GiB |  61427 GiB |
|       from small pool |      0 KiB |     56 MiB |    688 GiB |    688 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   6787 MiB |  62075 GiB |  62075 GiB |
|       from large pool |  16640 KiB |   6753 MiB |  61388 GiB |  61388 GiB |
|       from small pool |      0 KiB |     56 MiB |    687 GiB |    687 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    842 MiB |   7460 MiB |   7460 MiB |   6618 MiB |
|       from large pool |    794 MiB |   7396 MiB |   7396 MiB |   6602 MiB |
|       from small pool |     48 MiB |     64 MiB |     64 MiB |     16 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 685265 KiB |  38630 GiB |  38630 GiB |
|       from large pool |  24320 KiB | 679932 KiB |  37932 GiB |  37932 GiB |
|       from small pool |      0 KiB |  29626 KiB |    698 GiB |    698 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    1698    |    9249 K  |    9249 K  |
|       from large pool |       2    |     783    |    5641 K  |    5641 K  |
|       from small pool |       0    |    1407    |    3607 K  |    3607 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    1698    |    9249 K  |    9249 K  |
|       from large pool |       2    |     783    |    5641 K  |    5641 K  |
|       from small pool |       0    |    1407    |    3607 K  |    3607 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      61    |     341    |     341    |     280    |
|       from large pool |      37    |     309    |     309    |     272    |
|       from small pool |      24    |      32    |      32    |       8    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |     359    |    5586 K  |    5586 K  |
|       from large pool |       4    |     309    |    3978 K  |    3978 K  |
|       from small pool |       0    |     219    |    1607 K  |    1607 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   6793 MiB |  62116 GiB |  62116 GiB |
|       from large pool |  16640 KiB |   6758 MiB |  61427 GiB |  61427 GiB |
|       from small pool |      0 KiB |     56 MiB |    688 GiB |    688 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   6793 MiB |  62116 GiB |  62116 GiB |
|       from large pool |  16640 KiB |   6758 MiB |  61427 GiB |  61427 GiB |
|       from small pool |      0 KiB |     56 MiB |    688 GiB |    688 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   6787 MiB |  62075 GiB |  62075 GiB |
|       from large pool |  16640 KiB |   6753 MiB |  61388 GiB |  61388 GiB |
|       from small pool |      0 KiB |     56 MiB |    687 GiB |    687 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    842 MiB |   7460 MiB |   7460 MiB |   6618 MiB |
|       from large pool |    794 MiB |   7396 MiB |   7396 MiB |   6602 MiB |
|       from small pool |     48 MiB |     64 MiB |     64 MiB |     16 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 685265 KiB |  38630 GiB |  38630 GiB |
|       from large pool |  24320 KiB | 679932 KiB |  37932 GiB |  37932 GiB |
|       from small pool |      0 KiB |  29626 KiB |    698 GiB |    698 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    1698    |    9249 K  |    9249 K  |
|       from large pool |       2    |     783    |    5641 K  |    5641 K  |
|       from small pool |       0    |    1407    |    3607 K  |    3607 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    1698    |    9249 K  |    9249 K  |
|       from large pool |       2    |     783    |    5641 K  |    5641 K  |
|       from small pool |       0    |    1407    |    3607 K  |    3607 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      61    |     341    |     341    |     280    |
|       from large pool |      37    |     309    |     309    |     272    |
|       from small pool |      24    |      32    |      32    |       8    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |     359    |    5586 K  |    5586 K  |
|       from large pool |       4    |     309    |    3978 K  |    3978 K  |
|       from small pool |       0    |     219    |    1607 K  |    1607 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_04_42_22_seed_1_23093154

 Experiment start at: 2024-07-27 04:42:22.507252
before training, model accuracy: 0.6177777647972107
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.961263, 'precision': 0.96243834, 'recall': 0.96096396, 'specificity': 0.96096396, 'f1': 0.9612142, 'auroc': 0.9955691, 'binary_precision': 0.9421539, 'binary_recall': 0.98393315, 'binary_specificity': 0.9379947, 'binary_f1_score': 0.9625904}
confusion matrix:
      0     1
0  1422    94
1    25  1531
---- Validation: 
scalar performance:
{'acc': 0.82591724, 'precision': 0.8337383, 'recall': 0.82716334, 'specificity': 0.82716334, 'f1': 0.82523566, 'auroc': 0.9132397, 'binary_precision': 0.77838576, 'binary_recall': 0.9031746, 'binary_specificity': 0.7511521, 'binary_f1_score': 0.83614993}
confusion matrix:
     0    1
0  489  162
1   61  569
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.82222223, 'precision': 0.8272908, 'recall': 0.82222223, 'specificity': 0.82222223, 'f1': 0.8215313, 'auroc': 0.92258763, 'binary_precision': 0.78656125, 'binary_recall': 0.8844444, 'binary_specificity': 0.76, 'binary_f1_score': 0.83263594}
confusion matrix:
     0    1
0  171   54
1   26  199
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-27 04:45:24.962538,epoch time: 0:03:02.455286,used: 0:03:02.455286,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_04_42_22_seed_1_23093154
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.97233075, 'precision': 0.97319984, 'recall': 0.9726131, 'specificity': 0.9726131, 'f1': 0.9723263, 'auroc': 0.99794745, 'binary_precision': 0.99661934, 'binary_recall': 0.94851995, 'binary_specificity': 0.9967062, 'binary_f1_score': 0.97197497}
confusion matrix:
      0     1
0  1513     5
1    80  1474
---- Validation: 
scalar performance:
{'acc': 0.7626854, 'precision': 0.8216406, 'recall': 0.7591398, 'specificity': 0.7591398, 'f1': 0.7495846, 'auroc': 0.91740423, 'binary_precision': 0.95530725, 'binary_recall': 0.54285717, 'binary_specificity': 0.97542244, 'binary_f1_score': 0.6923077}
confusion matrix:
     0    1
0  635   16
1  288  342
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.62222224, 'precision': 0.7848101, 'recall': 0.62222224, 'specificity': 0.62222224, 'f1': 0.5593318, 'auroc': 0.94129384, 'binary_precision': 1.0, 'binary_recall': 0.24444444, 'binary_specificity': 1.0, 'binary_f1_score': 0.39285713}
confusion matrix:
     0   1
0  225   0
1  170  55
early stop counter: 1
val acc:0.7626854181289673, best validation acc: 0.8259172439575195, corresponding to test acc:                         0.8222222328186035 / 0.8222222328186035
after epoch: 2,now: 2024-07-27 04:48:19.937947,epoch time: 0:02:54.975409,used: 0:05:57.430695,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_04_42_22_seed_1_23093154
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.98079425, 'precision': 0.9809815, 'recall': 0.98095644, 'specificity': 0.98095644, 'f1': 0.98079425, 'auroc': 0.99877787, 'binary_precision': 0.9940555, 'binary_recall': 0.9678457, 'binary_specificity': 0.99406725, 'binary_f1_score': 0.98077554}
confusion matrix:
      0     1
0  1508     9
1    50  1505
---- Validation: 
scalar performance:
{'acc': 0.64637, 'precision': 0.7794566, 'recall': 0.64062977, 'specificity': 0.64062977, 'f1': 0.59349483, 'auroc': 0.91164446, 'binary_precision': 0.96825397, 'binary_recall': 0.2904762, 'binary_specificity': 0.9907834, 'binary_f1_score': 0.44688645}
confusion matrix:
     0    1
0  645    6
1  447  183
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.62222224, 'precision': 0.7848101, 'recall': 0.62222224, 'specificity': 0.62222224, 'f1': 0.5593318, 'auroc': 0.904963, 'binary_precision': 1.0, 'binary_recall': 0.24444444, 'binary_specificity': 1.0, 'binary_f1_score': 0.39285713}
confusion matrix:
     0   1
0  225   0
1  170  55
early stop counter: 2
val acc:0.646369993686676, best validation acc: 0.8259172439575195, corresponding to test acc:                         0.8222222328186035 / 0.8222222328186035
after epoch: 3,now: 2024-07-27 04:51:15.654014,epoch time: 0:02:55.716067,used: 0:08:53.146762,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_04_42_22_seed_1_23093154
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.98502606, 'precision': 0.9851171, 'recall': 0.98496735, 'specificity': 0.98496735, 'f1': 0.98502177, 'auroc': 0.9992399, 'binary_precision': 0.98087955, 'binary_recall': 0.9897106, 'binary_specificity': 0.98022413, 'binary_f1_score': 0.9852753}
confusion matrix:
      0     1
0  1487    30
1    16  1539
---- Validation: 
scalar performance:
{'acc': 0.8797814, 'precision': 0.891234, 'recall': 0.8783922, 'specificity': 0.8783922, 'f1': 0.8785881, 'auroc': 0.9406651, 'binary_precision': 0.9541985, 'binary_recall': 0.7936508, 'binary_specificity': 0.96313363, 'binary_f1_score': 0.86655116}
confusion matrix:
     0    1
0  627   24
1  130  500
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.81777775, 'precision': 0.85632014, 'recall': 0.81777775, 'specificity': 0.81777775, 'f1': 0.81271315, 'auroc': 0.92616296, 'binary_precision': 0.9735099, 'binary_recall': 0.6533333, 'binary_specificity': 0.9822222, 'binary_f1_score': 0.7819149}
confusion matrix:
     0    1
0  221    4
1   78  147
better model found
persisted
after epoch: 4,now: 2024-07-27 04:54:10.875940,epoch time: 0:02:55.221926,used: 0:11:48.368688,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_04_42_22_seed_1_23093154
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9899089, 'precision': 0.98989046, 'recall': 0.9899355, 'specificity': 0.9899355, 'f1': 0.98990786, 'auroc': 0.9996625, 'binary_precision': 0.99224806, 'binary_recall': 0.98778135, 'binary_specificity': 0.9920896, 'binary_f1_score': 0.99000967}
confusion matrix:
      0     1
0  1505    12
1    19  1536
---- Validation: 
scalar performance:
{'acc': 0.84231067, 'precision': 0.861915, 'recall': 0.8403994, 'specificity': 0.8403994, 'f1': 0.83958435, 'auroc': 0.9347987, 'binary_precision': 0.94214875, 'binary_recall': 0.72380954, 'binary_specificity': 0.9569892, 'binary_f1_score': 0.81867146}
confusion matrix:
     0    1
0  623   28
1  174  456
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.83111113, 'precision': 0.86439425, 'recall': 0.8311111, 'specificity': 0.8311111, 'f1': 0.8271645, 'auroc': 0.9279012, 'binary_precision': 0.9745223, 'binary_recall': 0.68, 'binary_specificity': 0.9822222, 'binary_f1_score': 0.8010471}
confusion matrix:
     0    1
0  221    4
1   72  153
new oracle model saved
early stop counter: 1
val acc:0.8423106670379639, best validation acc: 0.8797814249992371, corresponding to test acc:                         0.8177777528762817 / 0.8311111330986023
after epoch: 5,now: 2024-07-27 04:57:05.691834,epoch time: 0:02:54.815894,used: 0:14:43.184582,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_04_42_22_seed_1_23093154
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.98339844, 'precision': 0.983516, 'recall': 0.9833313, 'specificity': 0.9833313, 'f1': 0.98339343, 'auroc': 0.99919623, 'binary_precision': 0.97835773, 'binary_recall': 0.98906046, 'binary_specificity': 0.9776021, 'binary_f1_score': 0.98367995}
confusion matrix:
      0     1
0  1484    34
1    17  1537
---- Validation: 
scalar performance:
{'acc': 0.87431693, 'precision': 0.87887216, 'recall': 0.8734255, 'specificity': 0.8734255, 'f1': 0.873721, 'auroc': 0.93186796, 'binary_precision': 0.9165186, 'binary_recall': 0.81904763, 'binary_specificity': 0.9278034, 'binary_f1_score': 0.8650461}
confusion matrix:
     0    1
0  604   47
1  114  516
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.83111113, 'precision': 0.8468989, 'recall': 0.8311111, 'specificity': 0.8311111, 'f1': 0.8291674, 'auroc': 0.91361976, 'binary_precision': 0.920904, 'binary_recall': 0.72444445, 'binary_specificity': 0.93777776, 'binary_f1_score': 0.8109453}
confusion matrix:
     0    1
0  211   14
1   62  163
early stop counter: 2
val acc:0.874316930770874, best validation acc: 0.8797814249992371, corresponding to test acc:                         0.8177777528762817 / 0.8311111330986023
after epoch: 6,now: 2024-07-27 05:00:00.649134,epoch time: 0:02:54.957300,used: 0:17:38.141882,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_04_42_22_seed_1_23093154
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.98860675, 'precision': 0.9885899, 'recall': 0.9886319, 'specificity': 0.9886319, 'f1': 0.98860574, 'auroc': 0.99925685, 'binary_precision': 0.9909502, 'binary_recall': 0.9864865, 'binary_specificity': 0.9907773, 'binary_f1_score': 0.9887133}
confusion matrix:
      0     1
0  1504    14
1    21  1533
---- Validation: 
scalar performance:
{'acc': 0.7626854, 'precision': 0.82058, 'recall': 0.7591654, 'specificity': 0.7591654, 'f1': 0.74977255, 'auroc': 0.9334705, 'binary_precision': 0.9527778, 'binary_recall': 0.54444444, 'binary_specificity': 0.9738863, 'binary_f1_score': 0.6929293}
confusion matrix:
     0    1
0  634   17
1  287  343
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8288889, 'precision': 0.8568673, 'recall': 0.8288889, 'specificity': 0.8288889, 'f1': 0.82546806, 'auroc': 0.91998017, 'binary_precision': 0.95679015, 'binary_recall': 0.6888889, 'binary_specificity': 0.9688889, 'binary_f1_score': 0.8010336}
confusion matrix:
     0    1
0  218    7
1   70  155
early stop counter: 3
val acc:0.7626854181289673, best validation acc: 0.8797814249992371, corresponding to test acc:                         0.8177777528762817 / 0.8311111330986023
after epoch: 7,now: 2024-07-27 05:02:55.343107,epoch time: 0:02:54.693973,used: 0:20:32.835855,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_04_42_22_seed_1_23093154
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9892578, 'precision': 0.98923236, 'recall': 0.9893417, 'specificity': 0.9893417, 'f1': 0.98925674, 'auroc': 0.9994323, 'binary_precision': 0.9948153, 'binary_recall': 0.98397434, 'binary_specificity': 0.994709, 'binary_f1_score': 0.98936516}
confusion matrix:
      0     1
0  1504     8
1    25  1535
---- Validation: 
scalar performance:
{'acc': 0.68540204, 'precision': 0.7829779, 'recall': 0.6805172, 'specificity': 0.6805172, 'f1': 0.65216136, 'auroc': 0.89846873, 'binary_precision': 0.94509804, 'binary_recall': 0.3825397, 'binary_specificity': 0.97849464, 'binary_f1_score': 0.5446328}
confusion matrix:
     0    1
0  637   14
1  389  241
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8, 'precision': 0.848585, 'recall': 0.8, 'specificity': 0.8, 'f1': 0.7927795, 'auroc': 0.9166815, 'binary_precision': 0.9787234, 'binary_recall': 0.61333334, 'binary_specificity': 0.9866667, 'binary_f1_score': 0.75409836}
confusion matrix:
     0    1
0  222    3
1   87  138
early stop counter: 4
val acc:0.6854020357131958, best validation acc: 0.8797814249992371, corresponding to test acc:                         0.8177777528762817 / 0.8311111330986023
after epoch: 8,now: 2024-07-27 05:05:50.326369,epoch time: 0:02:54.983262,used: 0:23:27.819117,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_04_42_22_seed_1_23093154
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9941406, 'precision': 0.9941317, 'recall': 0.99419034, 'specificity': 0.99419034, 'f1': 0.9941404, 'auroc': 0.99975455, 'binary_precision': 0.99870044, 'binary_recall': 0.98969734, 'binary_specificity': 0.99868333, 'binary_f1_score': 0.9941785}
confusion matrix:
      0     1
0  1517     2
1    16  1537
---- Validation: 
scalar performance:
{'acc': 0.8360656, 'precision': 0.8547286, 'recall': 0.8341782, 'specificity': 0.8341782, 'f1': 0.8332999, 'auroc': 0.9206245, 'binary_precision': 0.93209875, 'binary_recall': 0.7190476, 'binary_specificity': 0.94930875, 'binary_f1_score': 0.8118279}
confusion matrix:
     0    1
0  618   33
1  177  453
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.84444445, 'precision': 0.860868, 'recall': 0.84444445, 'specificity': 0.84444445, 'f1': 0.8426542, 'auroc': 0.9223901, 'binary_precision': 0.9378531, 'binary_recall': 0.73777777, 'binary_specificity': 0.95111114, 'binary_f1_score': 0.8258707}
confusion matrix:
     0    1
0  214   11
1   59  166
new oracle model saved
early stop counter: 5
val acc:0.8360655903816223, best validation acc: 0.8797814249992371, corresponding to test acc:                         0.8177777528762817 / 0.8444444537162781
after epoch: 9,now: 2024-07-27 05:08:44.914440,epoch time: 0:02:54.588071,used: 0:26:22.407188,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_04_42_22_seed_1_23093154
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 9 with time: 0:26:22.407188 at 2024-07-27 05:08:44.914440
persisted model performance metric: 

scalar performance:
{'acc': 0.81777775, 'precision': 0.85632014, 'recall': 0.81777775, 'specificity': 0.81777775, 'f1': 0.81271315, 'auroc': 0.92616296, 'binary_precision': 0.9735099, 'binary_recall': 0.6533333, 'binary_specificity': 0.9822222, 'binary_f1_score': 0.7819149}
confusion matrix:
     0    1
0  221    4
1   78  147
oracle model performance metric: 

scalar performance:
{'acc': 0.84444445, 'precision': 0.860868, 'recall': 0.84444445, 'specificity': 0.84444445, 'f1': 0.8426542, 'auroc': 0.9223901, 'binary_precision': 0.9378531, 'binary_recall': 0.73777777, 'binary_specificity': 0.95111114, 'binary_f1_score': 0.8258707}
confusion matrix:
     0    1
0  214   11
1   59  166
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_dial_3seeds_nofreeze_2024-07-27_01-29-56/rule_results/3.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_dial_3seeds_nofreeze_2024-07-27_01-29-56/confusion_matrix/3.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 456522 KiB |   6793 MiB | 118108 GiB | 118107 GiB |
|       from large pool | 415924 KiB |   6758 MiB | 116796 GiB | 116796 GiB |
|       from small pool |  40598 KiB |     60 MiB |   1311 GiB |   1311 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 456522 KiB |   6793 MiB | 118108 GiB | 118107 GiB |
|       from large pool | 415924 KiB |   6758 MiB | 116796 GiB | 116796 GiB |
|       from small pool |  40598 KiB |     60 MiB |   1311 GiB |   1311 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 447481 KiB |   6787 MiB | 117992 GiB | 117992 GiB |
|       from large pool | 407075 KiB |   6753 MiB | 116682 GiB | 116682 GiB |
|       from small pool |  40406 KiB |     60 MiB |   1310 GiB |   1310 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   7454 MiB |   7460 MiB |  14072 MiB |   6618 MiB |
|       from large pool |   7386 MiB |   7396 MiB |  13988 MiB |   6602 MiB |
|       from small pool |     68 MiB |     68 MiB |     84 MiB |     16 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 385205 KiB | 685265 KiB |  73256 GiB |  73255 GiB |
|       from large pool | 376652 KiB | 679932 KiB |  71926 GiB |  71925 GiB |
|       from small pool |   8553 KiB |  29626 KiB |   1330 GiB |   1330 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    1310    |    1702    |   17592 K  |   17590 K  |
|       from large pool |     187    |     783    |   10722 K  |   10722 K  |
|       from small pool |    1123    |    1419    |    6869 K  |    6868 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    1310    |    1702    |   17592 K  |   17590 K  |
|       from large pool |     187    |     783    |   10722 K  |   10722 K  |
|       from small pool |    1123    |    1419    |    6869 K  |    6868 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     344    |     344    |     624    |     280    |
|       from large pool |     310    |     310    |     582    |     272    |
|       from small pool |      34    |      34    |      42    |       8    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      81    |     359    |   10580 K  |   10580 K  |
|       from large pool |      37    |     311    |    7534 K  |    7534 K  |
|       from small pool |      44    |     222    |    3046 K  |    3046 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   6793 MiB | 118108 GiB | 118108 GiB |
|       from large pool |  16640 KiB |   6758 MiB | 116796 GiB | 116796 GiB |
|       from small pool |      0 KiB |     60 MiB |   1311 GiB |   1311 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   6793 MiB | 118108 GiB | 118108 GiB |
|       from large pool |  16640 KiB |   6758 MiB | 116796 GiB | 116796 GiB |
|       from small pool |      0 KiB |     60 MiB |   1311 GiB |   1311 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   6787 MiB | 117992 GiB | 117992 GiB |
|       from large pool |  16640 KiB |   6753 MiB | 116682 GiB | 116682 GiB |
|       from small pool |      0 KiB |     60 MiB |   1310 GiB |   1310 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    822 MiB |   7460 MiB |  14072 MiB |  13250 MiB |
|       from large pool |    774 MiB |   7396 MiB |  13988 MiB |  13214 MiB |
|       from small pool |     48 MiB |     68 MiB |     84 MiB |     36 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 685265 KiB |  73256 GiB |  73256 GiB |
|       from large pool |  24320 KiB | 679932 KiB |  71926 GiB |  71926 GiB |
|       from small pool |      0 KiB |  32856 KiB |   1330 GiB |   1330 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    1702    |   17592 K  |   17592 K  |
|       from large pool |       2    |     783    |   10722 K  |   10722 K  |
|       from small pool |       0    |    1419    |    6869 K  |    6869 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    1702    |   17592 K  |   17592 K  |
|       from large pool |       2    |     783    |   10722 K  |   10722 K  |
|       from small pool |       0    |    1419    |    6869 K  |    6869 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      60    |     344    |     624    |     564    |
|       from large pool |      36    |     310    |     582    |     546    |
|       from small pool |      24    |      34    |      42    |      18    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |     359    |   10580 K  |   10580 K  |
|       from large pool |       4    |     311    |    7534 K  |    7534 K  |
|       from small pool |       0    |     222    |    3046 K  |    3046 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   6793 MiB | 118108 GiB | 118108 GiB |
|       from large pool |  16640 KiB |   6758 MiB | 116796 GiB | 116796 GiB |
|       from small pool |      0 KiB |     60 MiB |   1311 GiB |   1311 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   6793 MiB | 118108 GiB | 118108 GiB |
|       from large pool |  16640 KiB |   6758 MiB | 116796 GiB | 116796 GiB |
|       from small pool |      0 KiB |     60 MiB |   1311 GiB |   1311 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   6787 MiB | 117992 GiB | 117992 GiB |
|       from large pool |  16640 KiB |   6753 MiB | 116682 GiB | 116682 GiB |
|       from small pool |      0 KiB |     60 MiB |   1310 GiB |   1310 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    822 MiB |   7460 MiB |  14072 MiB |  13250 MiB |
|       from large pool |    774 MiB |   7396 MiB |  13988 MiB |  13214 MiB |
|       from small pool |     48 MiB |     68 MiB |     84 MiB |     36 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 685265 KiB |  73256 GiB |  73256 GiB |
|       from large pool |  24320 KiB | 679932 KiB |  71926 GiB |  71926 GiB |
|       from small pool |      0 KiB |  32856 KiB |   1330 GiB |   1330 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    1702    |   17592 K  |   17592 K  |
|       from large pool |       2    |     783    |   10722 K  |   10722 K  |
|       from small pool |       0    |    1419    |    6869 K  |    6869 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    1702    |   17592 K  |   17592 K  |
|       from large pool |       2    |     783    |   10722 K  |   10722 K  |
|       from small pool |       0    |    1419    |    6869 K  |    6869 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      60    |     344    |     624    |     564    |
|       from large pool |      36    |     310    |     582    |     546    |
|       from small pool |      24    |      34    |      42    |      18    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |     359    |   10580 K  |   10580 K  |
|       from large pool |       4    |     311    |    7534 K  |    7534 K  |
|       from small pool |       0    |     222    |    3046 K  |    3046 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_05_09_13_seed_2_23093154

 Experiment start at: 2024-07-27 05:09:13.456999
before training, model accuracy: 0.41203704476356506
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9656414, 'precision': 0.9658714, 'recall': 0.9655647, 'specificity': 0.9655647, 'f1': 0.965631, 'auroc': 0.9941952, 'binary_precision': 0.9572976, 'binary_recall': 0.9753247, 'binary_specificity': 0.95580477, 'binary_f1_score': 0.96622705}
confusion matrix:
      0     1
0  1449    67
1    38  1502
---- Validation: 
scalar performance:
{'acc': 0.8380282, 'precision': 0.83797085, 'recall': 0.8378093, 'specificity': 0.8378093, 'f1': 0.8378773, 'auroc': 0.90776217, 'binary_precision': 0.8363047, 'binary_recall': 0.829582, 'binary_specificity': 0.8460366, 'binary_f1_score': 0.83292985}
confusion matrix:
     0    1
0  555  101
1  106  516
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8703704, 'precision': 0.8704021, 'recall': 0.8703704, 'specificity': 0.8703704, 'f1': 0.87036765, 'auroc': 0.93261313, 'binary_precision': 0.87383175, 'binary_recall': 0.8657407, 'binary_specificity': 0.875, 'binary_f1_score': 0.8697674}
confusion matrix:
     0    1
0  189   27
1   29  187
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-27 05:12:12.071217,epoch time: 0:02:58.614218,used: 0:02:58.614218,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_05_09_13_seed_2_23093154
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9695681, 'precision': 0.9710302, 'recall': 0.96980006, 'specificity': 0.96980006, 'f1': 0.9695535, 'auroc': 0.9968535, 'binary_precision': 0.9993099, 'binary_recall': 0.94025975, 'binary_specificity': 0.99934036, 'binary_f1_score': 0.9688859}
confusion matrix:
      0     1
0  1515     1
1    92  1448
---- Validation: 
scalar performance:
{'acc': 0.5344288, 'precision': 0.6853852, 'recall': 0.5219542, 'specificity': 0.5219542, 'f1': 0.39293227, 'auroc': 0.81966615, 'binary_precision': 0.84615386, 'binary_recall': 0.05305466, 'binary_specificity': 0.99085367, 'binary_f1_score': 0.0998487}
confusion matrix:
     0   1
0  650   6
1  589  33
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5625, 'precision': 0.70985967, 'recall': 0.5625, 'specificity': 0.5625, 'f1': 0.46934614, 'auroc': 0.85279495, 'binary_precision': 0.8857143, 'binary_recall': 0.14351852, 'binary_specificity': 0.9814815, 'binary_f1_score': 0.24701196}
confusion matrix:
     0   1
0  212   4
1  185  31
early stop counter: 1
val acc:0.5344287753105164, best validation acc: 0.8380281925201416, corresponding to test acc:                         0.8703703880310059 / 0.8703703880310059
after epoch: 2,now: 2024-07-27 05:15:05.924804,epoch time: 0:02:53.853587,used: 0:05:52.467805,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_05_09_13_seed_2_23093154
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.97611254, 'precision': 0.9761374, 'recall': 0.97609305, 'specificity': 0.97609305, 'f1': 0.9761101, 'auroc': 0.99762785, 'binary_precision': 0.9741435, 'binary_recall': 0.9785714, 'binary_specificity': 0.97361475, 'binary_f1_score': 0.97635245}
confusion matrix:
      0     1
0  1476    40
1    33  1507
---- Validation: 
scalar performance:
{'acc': 0.80359936, 'precision': 0.8156272, 'recall': 0.8061476, 'specificity': 0.8061476, 'f1': 0.8025081, 'auroc': 0.8976894, 'binary_precision': 0.747004, 'binary_recall': 0.90192926, 'binary_specificity': 0.71036583, 'binary_f1_score': 0.8171887}
confusion matrix:
     0    1
0  466  190
1   61  561
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8194444, 'precision': 0.82043344, 'recall': 0.8194444, 'specificity': 0.8194444, 'f1': 0.819305, 'auroc': 0.90432096, 'binary_precision': 0.80263156, 'binary_recall': 0.8472222, 'binary_specificity': 0.7916667, 'binary_f1_score': 0.8243243}
confusion matrix:
     0    1
0  171   45
1   33  183
early stop counter: 2
val acc:0.8035993576049805, best validation acc: 0.8380281925201416, corresponding to test acc:                         0.8703703880310059 / 0.8703703880310059
after epoch: 3,now: 2024-07-27 05:17:59.460476,epoch time: 0:02:53.535672,used: 0:08:46.003477,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_05_09_13_seed_2_23093154
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9829843, 'precision': 0.9830449, 'recall': 0.9830449, 'specificity': 0.9830449, 'f1': 0.9829843, 'auroc': 0.9975602, 'binary_precision': 0.99076515, 'binary_recall': 0.9753247, 'binary_specificity': 0.99076515, 'binary_f1_score': 0.9829843}
confusion matrix:
      0     1
0  1502    14
1    38  1502
---- Validation: 
scalar performance:
{'acc': 0.74178404, 'precision': 0.7642245, 'recall': 0.73772645, 'specificity': 0.73772645, 'f1': 0.7338985, 'auroc': 0.8344811, 'binary_precision': 0.8348624, 'binary_recall': 0.585209, 'binary_specificity': 0.8902439, 'binary_f1_score': 0.6880908}
confusion matrix:
     0    1
0  584   72
1  258  364
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8263889, 'precision': 0.8264519, 'recall': 0.82638884, 'specificity': 0.82638884, 'f1': 0.8263805, 'auroc': 0.8912895, 'binary_precision': 0.82191783, 'binary_recall': 0.8333333, 'binary_specificity': 0.8194444, 'binary_f1_score': 0.82758623}
confusion matrix:
     0    1
0  177   39
1   36  180
early stop counter: 3
val acc:0.7417840361595154, best validation acc: 0.8380281925201416, corresponding to test acc:                         0.8703703880310059 / 0.8703703880310059
after epoch: 4,now: 2024-07-27 05:20:54.096137,epoch time: 0:02:54.635661,used: 0:11:40.639138,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_05_09_13_seed_2_23093154
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9908377, 'precision': 0.99084294, 'recall': 0.990832, 'specificity': 0.990832, 'f1': 0.99083704, 'auroc': 0.99972415, 'binary_precision': 0.9902724, 'binary_recall': 0.99155843, 'binary_specificity': 0.99010557, 'binary_f1_score': 0.990915}
confusion matrix:
      0     1
0  1501    15
1    13  1527
---- Validation: 
scalar performance:
{'acc': 0.7276995, 'precision': 0.8070654, 'recall': 0.72079885, 'specificity': 0.72079885, 'f1': 0.70479274, 'auroc': 0.89884615, 'binary_precision': 0.95666665, 'binary_recall': 0.46141478, 'binary_specificity': 0.98018295, 'binary_f1_score': 0.62255967}
confusion matrix:
     0    1
0  643   13
1  335  287
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5625, 'precision': 0.76666665, 'recall': 0.5625, 'specificity': 0.5625, 'f1': 0.45893723, 'auroc': 0.90543556, 'binary_precision': 1.0, 'binary_recall': 0.125, 'binary_specificity': 1.0, 'binary_f1_score': 0.22222222}
confusion matrix:
     0   1
0  216   0
1  189  27
early stop counter: 4
val acc:0.7276995182037354, best validation acc: 0.8380281925201416, corresponding to test acc:                         0.8703703880310059 / 0.8703703880310059
after epoch: 5,now: 2024-07-27 05:23:48.401249,epoch time: 0:02:54.305112,used: 0:14:34.944250,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_05_09_13_seed_2_23093154
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9695681, 'precision': 0.96957475, 'recall': 0.9695585, 'specificity': 0.9695585, 'f1': 0.96956563, 'auroc': 0.9943495, 'binary_precision': 0.96889174, 'binary_recall': 0.97077924, 'binary_specificity': 0.9683377, 'binary_f1_score': 0.96983457}
confusion matrix:
      0     1
0  1468    48
1    45  1495
---- Validation: 
scalar performance:
{'acc': 0.7425665, 'precision': 0.77875966, 'recall': 0.73761374, 'specificity': 0.73761374, 'f1': 0.7311822, 'auroc': 0.8279277, 'binary_precision': 0.8727735, 'binary_recall': 0.551447, 'binary_specificity': 0.9237805, 'binary_f1_score': 0.6758621}
confusion matrix:
     0    1
0  606   50
1  279  343
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6226852, 'precision': 0.72332335, 'recall': 0.6226852, 'specificity': 0.6226852, 'f1': 0.57478005, 'auroc': 0.81421465, 'binary_precision': 0.87323946, 'binary_recall': 0.28703704, 'binary_specificity': 0.9583333, 'binary_f1_score': 0.43205574}
confusion matrix:
     0   1
0  207   9
1  154  62
early stop counter: 5
val acc:0.7425665259361267, best validation acc: 0.8380281925201416, corresponding to test acc:                         0.8703703880310059 / 0.8703703880310059
after epoch: 6,now: 2024-07-27 05:26:42.251942,epoch time: 0:02:53.850693,used: 0:17:28.794943,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_05_09_13_seed_2_23093154
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 6 with time: 0:17:28.794943 at 2024-07-27 05:26:42.251942
persisted model performance metric: 

scalar performance:
{'acc': 0.8703704, 'precision': 0.8704021, 'recall': 0.8703704, 'specificity': 0.8703704, 'f1': 0.87036765, 'auroc': 0.93261313, 'binary_precision': 0.87383175, 'binary_recall': 0.8657407, 'binary_specificity': 0.875, 'binary_f1_score': 0.8697674}
confusion matrix:
     0    1
0  189   27
1   29  187
oracle model performance metric: 

scalar performance:
{'acc': 0.8703704, 'precision': 0.8704021, 'recall': 0.8703704, 'specificity': 0.8703704, 'f1': 0.87036765, 'auroc': 0.93261313, 'binary_precision': 0.87383175, 'binary_recall': 0.8657407, 'binary_specificity': 0.875, 'binary_f1_score': 0.8697674}
confusion matrix:
     0    1
0  189   27
1   29  187
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_dial_3seeds_nofreeze_2024-07-27_01-29-56/rule_results/3.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_dial_3seeds_nofreeze_2024-07-27_01-29-56/confusion_matrix/3.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 456516 KiB |   6793 MiB | 155300 GiB | 155300 GiB |
|       from large pool | 415924 KiB |   6758 MiB | 153576 GiB | 153575 GiB |
|       from small pool |  40592 KiB |     60 MiB |   1724 GiB |   1724 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 456516 KiB |   6793 MiB | 155300 GiB | 155300 GiB |
|       from large pool | 415924 KiB |   6758 MiB | 153576 GiB | 153575 GiB |
|       from small pool |  40592 KiB |     60 MiB |   1724 GiB |   1724 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 447481 KiB |   6787 MiB | 155131 GiB | 155131 GiB |
|       from large pool | 407075 KiB |   6753 MiB | 153409 GiB | 153409 GiB |
|       from small pool |  40406 KiB |     60 MiB |   1722 GiB |   1722 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   7436 MiB |   7460 MiB |  20686 MiB |  13250 MiB |
|       from large pool |   7372 MiB |   7396 MiB |  20586 MiB |  13214 MiB |
|       from small pool |     64 MiB |     68 MiB |    100 MiB |     36 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 364731 KiB | 689624 KiB |  96495 GiB |  96494 GiB |
|       from large pool | 356172 KiB | 680330 KiB |  94747 GiB |  94746 GiB |
|       from small pool |   8559 KiB |  32856 KiB |   1747 GiB |   1747 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    1298    |    1702    |   23129 K  |   23128 K  |
|       from large pool |     187    |     783    |   14097 K  |   14097 K  |
|       from small pool |    1111    |    1419    |    9032 K  |    9031 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    1298    |    1702    |   23129 K  |   23128 K  |
|       from large pool |     187    |     783    |   14097 K  |   14097 K  |
|       from small pool |    1111    |    1419    |    9032 K  |    9031 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     341    |     344    |     905    |     564    |
|       from large pool |     309    |     310    |     855    |     546    |
|       from small pool |      32    |      34    |      50    |      18    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      80    |     359    |   13949 K  |   13949 K  |
|       from large pool |      35    |     311    |    9958 K  |    9958 K  |
|       from small pool |      45    |     222    |    3990 K  |    3990 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   6793 MiB | 155300 GiB | 155300 GiB |
|       from large pool |  16640 KiB |   6758 MiB | 153576 GiB | 153576 GiB |
|       from small pool |      0 KiB |     60 MiB |   1724 GiB |   1724 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   6793 MiB | 155300 GiB | 155300 GiB |
|       from large pool |  16640 KiB |   6758 MiB | 153576 GiB | 153576 GiB |
|       from small pool |      0 KiB |     60 MiB |   1724 GiB |   1724 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   6787 MiB | 155131 GiB | 155131 GiB |
|       from large pool |  16640 KiB |   6753 MiB | 153409 GiB | 153409 GiB |
|       from small pool |      0 KiB |     60 MiB |   1722 GiB |   1722 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    802 MiB |   7460 MiB |  20686 MiB |  19884 MiB |
|       from large pool |    754 MiB |   7396 MiB |  20586 MiB |  19832 MiB |
|       from small pool |     48 MiB |     68 MiB |    100 MiB |     52 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 689624 KiB |  96495 GiB |  96495 GiB |
|       from large pool |  24320 KiB | 680330 KiB |  94747 GiB |  94747 GiB |
|       from small pool |      0 KiB |  32862 KiB |   1747 GiB |   1747 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    1702    |   23129 K  |   23129 K  |
|       from large pool |       2    |     783    |   14097 K  |   14097 K  |
|       from small pool |       0    |    1419    |    9032 K  |    9032 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    1702    |   23129 K  |   23129 K  |
|       from large pool |       2    |     783    |   14097 K  |   14097 K  |
|       from small pool |       0    |    1419    |    9032 K  |    9032 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      59    |     344    |     905    |     846    |
|       from large pool |      35    |     310    |     855    |     820    |
|       from small pool |      24    |      34    |      50    |      26    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |     359    |   13949 K  |   13949 K  |
|       from large pool |       4    |     311    |    9958 K  |    9958 K  |
|       from small pool |       0    |     222    |    3991 K  |    3991 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Sat Jul 27 05:26:50 2024]
Finished job 0.
1 of 1 steps (100%) done
