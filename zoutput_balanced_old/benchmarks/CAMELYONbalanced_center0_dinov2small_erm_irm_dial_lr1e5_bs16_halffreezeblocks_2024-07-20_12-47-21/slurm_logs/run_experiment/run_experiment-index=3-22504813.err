Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Sat Jul 20 14:59:54 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_halffreezeblocks_2024-07-20_12-47-21/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_halffreezeblocks_2024-07-20_12-47-21/rule_results/3.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=3
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/swiglu_ffn.py:51: UserWarning: xFormers is not available (SwiGLU)
  warnings.warn("xFormers is not available (SwiGLU)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/attention.py:33: UserWarning: xFormers is not available (Attention)
  warnings.warn("xFormers is not available (Attention)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/block.py:40: UserWarning: xFormers is not available (Block)
  warnings.warn("xFormers is not available (Block)")
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'888c1ef2'
model name: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_15_02_23_seed_0_22504813

 Experiment start at: 2024-07-20 15:02:23.340134
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
before training, model accuracy: 0.569767415523529
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.5530599, 'precision': 0.55338323, 'recall': 0.55210954, 'specificity': 0.55210954, 'f1': 0.54990983, 'auroc': 0.58951414, 'binary_precision': 0.55129653, 'binary_recall': 0.6289389, 'binary_specificity': 0.47528017, 'binary_f1_score': 0.5875639}
confusion matrix:
     0    1
0  721  796
1  577  978
---- Validation: 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
scalar performance:
{'acc': 0.6319876, 'precision': 0.63871825, 'recall': 0.6302878, 'specificity': 0.6302878, 'f1': 0.6256181, 'auroc': 0.7017858, 'binary_precision': 0.6659794, 'binary_recall': 0.5086614, 'binary_specificity': 0.75191426, 'binary_f1_score': 0.5767857}
confusion matrix:
     0    1
0  491  162
1  312  323
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.63255817, 'precision': 0.6401372, 'recall': 0.6325581, 'specificity': 0.6325581, 'f1': 0.62752193, 'auroc': 0.6673229, 'binary_precision': 0.6727273, 'binary_recall': 0.51627904, 'binary_specificity': 0.74883723, 'binary_f1_score': 0.5842105}
confusion matrix:
     0    1
0  161   54
1  104  111
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-20 15:03:54.096295,epoch time: 0:01:30.756161,used: 0:01:30.756161,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_15_02_23_seed_0_22504813
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.67578125, 'precision': 0.6801081, 'recall': 0.6746167, 'specificity': 0.6746167, 'f1': 0.672866, 'auroc': 0.75601375, 'binary_precision': 0.65540165, 'binary_recall': 0.7597945, 'binary_specificity': 0.5894389, 'binary_f1_score': 0.70374775}
confusion matrix:
     0     1
0  893   622
1  374  1183
---- Validation: 
scalar performance:
{'acc': 0.625, 'precision': 0.64108837, 'recall': 0.622485, 'specificity': 0.622485, 'f1': 0.61115944, 'auroc': 0.71067035, 'binary_precision': 0.68536586, 'binary_recall': 0.4425197, 'binary_specificity': 0.80245024, 'binary_f1_score': 0.53779906}
confusion matrix:
     0    1
0  524  129
1  354  281
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6255814, 'precision': 0.6451831, 'recall': 0.6255814, 'specificity': 0.6255814, 'f1': 0.61250204, 'auroc': 0.6923094, 'binary_precision': 0.6985294, 'binary_recall': 0.44186047, 'binary_specificity': 0.80930233, 'binary_f1_score': 0.54131055}
confusion matrix:
     0   1
0  174  41
1  120  95
early stop counter: 1
val acc:0.625, best validation acc: 0.6319875717163086, corresponding to test acc:                         0.6325581669807434 / 0.6325581669807434
after epoch: 2,now: 2024-07-20 15:05:12.512468,epoch time: 0:01:18.416173,used: 0:02:49.172334,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_15_02_23_seed_0_22504813
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.74902344, 'precision': 0.7489903, 'recall': 0.7490132, 'specificity': 0.7490132, 'f1': 0.7489979, 'auroc': 0.81042933, 'binary_precision': 0.75323, 'binary_recall': 0.74983925, 'binary_specificity': 0.7481872, 'binary_f1_score': 0.7515308}
confusion matrix:
      0     1
0  1135   382
1   389  1166
---- Validation: 
scalar performance:
{'acc': 0.6032609, 'precision': 0.62772226, 'recall': 0.6000253, 'specificity': 0.6000253, 'f1': 0.57903194, 'auroc': 0.7147412, 'binary_precision': 0.6802326, 'binary_recall': 0.36850393, 'binary_specificity': 0.8315467, 'binary_f1_score': 0.4780388}
confusion matrix:
     0    1
0  543  110
1  401  234
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.61162794, 'precision': 0.64166486, 'recall': 0.61162794, 'specificity': 0.61162794, 'f1': 0.58988917, 'auroc': 0.71007025, 'binary_precision': 0.70689654, 'binary_recall': 0.38139534, 'binary_specificity': 0.8418605, 'binary_f1_score': 0.49546826}
confusion matrix:
     0   1
0  181  34
1  133  82
early stop counter: 2
val acc:0.60326087474823, best validation acc: 0.6319875717163086, corresponding to test acc:                         0.6325581669807434 / 0.6325581669807434
after epoch: 3,now: 2024-07-20 15:06:31.280736,epoch time: 0:01:18.768268,used: 0:04:07.940602,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_15_02_23_seed_0_22504813
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.78971356, 'precision': 0.79016876, 'recall': 0.78995764, 'specificity': 0.78995764, 'f1': 0.7896985, 'auroc': 0.8459673, 'binary_precision': 0.80536914, 'binary_recall': 0.7712082, 'binary_specificity': 0.8087071, 'binary_f1_score': 0.7879185}
confusion matrix:
      0     1
0  1226   290
1   356  1200
---- Validation: 
scalar performance:
{'acc': 0.6032609, 'precision': 0.63099575, 'recall': 0.59987336, 'specificity': 0.59987336, 'f1': 0.57663596, 'auroc': 0.72062314, 'binary_precision': 0.6878788, 'binary_recall': 0.35748032, 'binary_specificity': 0.84226644, 'binary_f1_score': 0.47046632}
confusion matrix:
     0    1
0  550  103
1  408  227
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.62093025, 'precision': 0.65183616, 'recall': 0.6209302, 'specificity': 0.6209302, 'f1': 0.6006063, 'auroc': 0.7232666, 'binary_precision': 0.720339, 'binary_recall': 0.39534885, 'binary_specificity': 0.8465116, 'binary_f1_score': 0.5105105}
confusion matrix:
     0   1
0  182  33
1  130  85
early stop counter: 3
val acc:0.60326087474823, best validation acc: 0.6319875717163086, corresponding to test acc:                         0.6325581669807434 / 0.6325581669807434
after epoch: 4,now: 2024-07-20 15:07:51.593143,epoch time: 0:01:20.312407,used: 0:05:28.253009,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_15_02_23_seed_0_22504813
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.82128906, 'precision': 0.8273748, 'recall': 0.8222127, 'specificity': 0.8222127, 'f1': 0.82072055, 'auroc': 0.875206, 'binary_precision': 0.87555885, 'binary_recall': 0.7546564, 'binary_specificity': 0.88976896, 'binary_f1_score': 0.8106244}
confusion matrix:
      0     1
0  1348   167
1   382  1175
---- Validation: 
scalar performance:
{'acc': 0.58074534, 'precision': 0.61541617, 'recall': 0.57671314, 'specificity': 0.57671314, 'f1': 0.5403101, 'auroc': 0.7243974, 'binary_precision': 0.67527676, 'binary_recall': 0.28818896, 'binary_specificity': 0.86523736, 'binary_f1_score': 0.4039735}
confusion matrix:
     0    1
0  565   88
1  452  183
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5883721, 'precision': 0.62933767, 'recall': 0.5883721, 'specificity': 0.5883721, 'f1': 0.5529752, 'auroc': 0.7343645, 'binary_precision': 0.70212764, 'binary_recall': 0.30697674, 'binary_specificity': 0.8697674, 'binary_f1_score': 0.42718446}
confusion matrix:
     0   1
0  187  28
1  149  66
early stop counter: 4
val acc:0.5807453393936157, best validation acc: 0.6319875717163086, corresponding to test acc:                         0.6325581669807434 / 0.6325581669807434
after epoch: 5,now: 2024-07-20 15:09:09.589230,epoch time: 0:01:17.996087,used: 0:06:46.249096,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_15_02_23_seed_0_22504813
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.8385417, 'precision': 0.8427046, 'recall': 0.83932924, 'specificity': 0.83932924, 'f1': 0.838243, 'auroc': 0.89842725, 'binary_precision': 0.8842258, 'binary_recall': 0.7843389, 'binary_specificity': 0.89431965, 'binary_f1_score': 0.8312925}
confusion matrix:
      0     1
0  1354   160
1   336  1222
---- Validation: 
scalar performance:
{'acc': 0.5916149, 'precision': 0.6272691, 'recall': 0.5877368, 'specificity': 0.5877368, 'f1': 0.555314, 'auroc': 0.7296765, 'binary_precision': 0.6912281, 'binary_recall': 0.31023622, 'binary_specificity': 0.86523736, 'binary_f1_score': 0.42826083}
confusion matrix:
     0    1
0  565   88
1  438  197
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.60232556, 'precision': 0.6395116, 'recall': 0.60232556, 'specificity': 0.60232556, 'f1': 0.57393426, 'auroc': 0.7402921, 'binary_precision': 0.71153843, 'binary_recall': 0.34418604, 'binary_specificity': 0.8604651, 'binary_f1_score': 0.46394983}
confusion matrix:
     0   1
0  185  30
1  141  74
early stop counter: 5
val acc:0.5916149020195007, best validation acc: 0.6319875717163086, corresponding to test acc:                         0.6325581669807434 / 0.6325581669807434
after epoch: 6,now: 2024-07-20 15:10:27.789755,epoch time: 0:01:18.200525,used: 0:08:04.449621,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_15_02_23_seed_0_22504813
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.8460286, 'precision': 0.8502698, 'recall': 0.84670985, 'specificity': 0.84670985, 'f1': 0.84572184, 'auroc': 0.90246046, 'binary_precision': 0.892029, 'binary_recall': 0.79163986, 'binary_specificity': 0.90177983, 'binary_f1_score': 0.8388416}
confusion matrix:
      0     1
0  1368   149
1   324  1231
---- Validation: 
scalar performance:
{'acc': 0.5931677, 'precision': 0.6289077, 'recall': 0.5893116, 'specificity': 0.5893116, 'f1': 0.5574312, 'auroc': 0.7357056, 'binary_precision': 0.6933798, 'binary_recall': 0.3133858, 'binary_specificity': 0.86523736, 'binary_f1_score': 0.43167028}
confusion matrix:
     0    1
0  565   88
1  436  199
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.61860466, 'precision': 0.6586325, 'recall': 0.61860466, 'specificity': 0.61860466, 'f1': 0.59292525, 'auroc': 0.7499189, 'binary_precision': 0.7383177, 'binary_recall': 0.36744186, 'binary_specificity': 0.8697674, 'binary_f1_score': 0.49068323}
confusion matrix:
     0   1
0  187  28
1  136  79
early stop counter: 6
val acc:0.5931677222251892, best validation acc: 0.6319875717163086, corresponding to test acc:                         0.6325581669807434 / 0.6325581669807434
after epoch: 7,now: 2024-07-20 15:11:48.728914,epoch time: 0:01:20.939159,used: 0:09:25.388780,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_15_02_23_seed_0_22504813
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.8496094, 'precision': 0.85447204, 'recall': 0.8503354, 'specificity': 0.8503354, 'f1': 0.8492595, 'auroc': 0.90942144, 'binary_precision': 0.8991965, 'binary_recall': 0.79163986, 'binary_specificity': 0.909031, 'binary_f1_score': 0.8419972}
confusion matrix:
      0     1
0  1379   138
1   324  1231
---- Validation: 
scalar performance:
{'acc': 0.6079193, 'precision': 0.6414909, 'recall': 0.60435903, 'specificity': 0.60435903, 'f1': 0.57873684, 'auroc': 0.74353373, 'binary_precision': 0.7070064, 'binary_recall': 0.3496063, 'binary_specificity': 0.8591118, 'binary_f1_score': 0.4678609}
confusion matrix:
     0    1
0  561   92
1  413  222
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.63255817, 'precision': 0.6655679, 'recall': 0.63255817, 'specificity': 0.63255817, 'f1': 0.6132829, 'auroc': 0.7583343, 'binary_precision': 0.7394958, 'binary_recall': 0.40930232, 'binary_specificity': 0.855814, 'binary_f1_score': 0.5269461}
confusion matrix:
     0   1
0  184  31
1  127  88
early stop counter: 7
val acc:0.6079192757606506, best validation acc: 0.6319875717163086, corresponding to test acc:                         0.6325581669807434 / 0.6325581669807434
after epoch: 8,now: 2024-07-20 15:13:09.494979,epoch time: 0:01:20.766065,used: 0:10:46.154845,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_15_02_23_seed_0_22504813
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.85839844, 'precision': 0.864025, 'recall': 0.8591306, 'specificity': 0.8591306, 'f1': 0.8580084, 'auroc': 0.9216188, 'binary_precision': 0.91230655, 'binary_recall': 0.7966538, 'binary_specificity': 0.9216074, 'binary_f1_score': 0.8505668}
confusion matrix:
      0     1
0  1399   119
1   316  1238
---- Validation: 
scalar performance:
{'acc': 0.6040373, 'precision': 0.6400415, 'recall': 0.60033524, 'specificity': 0.60033524, 'f1': 0.5720763, 'auroc': 0.7466303, 'binary_precision': 0.7076412, 'binary_recall': 0.33543307, 'binary_specificity': 0.86523736, 'binary_f1_score': 0.45512822}
confusion matrix:
     0    1
0  565   88
1  422  213
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6348837, 'precision': 0.66935575, 'recall': 0.6348837, 'specificity': 0.6348837, 'f1': 0.6153079, 'auroc': 0.76737696, 'binary_precision': 0.7457627, 'binary_recall': 0.40930232, 'binary_specificity': 0.8604651, 'binary_f1_score': 0.5285285}
confusion matrix:
     0   1
0  185  30
1  127  88
new oracle model saved
early stop counter: 8
val acc:0.6040372848510742, best validation acc: 0.6319875717163086, corresponding to test acc:                         0.6325581669807434 / 0.6348837018013
after epoch: 9,now: 2024-07-20 15:14:28.883852,epoch time: 0:01:19.388873,used: 0:12:05.543718,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_15_02_23_seed_0_22504813
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.8623047, 'precision': 0.86648655, 'recall': 0.86300623, 'specificity': 0.86300623, 'f1': 0.8620538, 'auroc': 0.919737, 'binary_precision': 0.90902525, 'binary_recall': 0.80912596, 'binary_specificity': 0.91688657, 'binary_f1_score': 0.85617137}
confusion matrix:
      0     1
0  1390   126
1   297  1259
---- Validation: 
scalar performance:
{'acc': 0.60481364, 'precision': 0.64143723, 'recall': 0.6011009, 'specificity': 0.6011009, 'f1': 0.5727191, 'auroc': 0.750911, 'binary_precision': 0.71, 'binary_recall': 0.33543307, 'binary_specificity': 0.8667688, 'binary_f1_score': 0.45561495}
confusion matrix:
     0    1
0  566   87
1  422  213
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6372093, 'precision': 0.673193, 'recall': 0.6372093, 'specificity': 0.6372093, 'f1': 0.61733294, 'auroc': 0.7747323, 'binary_precision': 0.75213677, 'binary_recall': 0.40930232, 'binary_specificity': 0.8651163, 'binary_f1_score': 0.5301205}
confusion matrix:
     0   1
0  186  29
1  127  88
new oracle model saved
early stop counter: 9
val acc:0.6048136353492737, best validation acc: 0.6319875717163086, corresponding to test acc:                         0.6325581669807434 / 0.6372092962265015
after epoch: 10,now: 2024-07-20 15:15:49.969498,epoch time: 0:01:21.085646,used: 0:13:26.629364,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_15_02_23_seed_0_22504813
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.86848956, 'precision': 0.8776226, 'recall': 0.8695102, 'specificity': 0.8695102, 'f1': 0.86789554, 'auroc': 0.923331, 'binary_precision': 0.93969464, 'binary_recall': 0.7911311, 'binary_specificity': 0.9478892, 'binary_f1_score': 0.859037}
confusion matrix:
      0     1
0  1437    79
1   325  1231
---- Validation: 
scalar performance:
{'acc': 0.61490685, 'precision': 0.6538632, 'recall': 0.61125034, 'specificity': 0.61125034, 'f1': 0.584581, 'auroc': 0.75897074, 'binary_precision': 0.72786885, 'binary_recall': 0.3496063, 'binary_specificity': 0.87289435, 'binary_f1_score': 0.47234043}
confusion matrix:
     0    1
0  570   83
1  413  222
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6511628, 'precision': 0.69289166, 'recall': 0.6511628, 'specificity': 0.6511628, 'f1': 0.63121784, 'auroc': 0.78383994, 'binary_precision': 0.7826087, 'binary_recall': 0.41860464, 'binary_specificity': 0.88372093, 'binary_f1_score': 0.54545456}
confusion matrix:
     0   1
0  190  25
1  125  90
new oracle model saved
early stop counter: 10
val acc:0.6149068474769592, best validation acc: 0.6319875717163086, corresponding to test acc:                         0.6325581669807434 / 0.6511628031730652
after epoch: 11,now: 2024-07-20 15:17:07.206373,epoch time: 0:01:17.236875,used: 0:14:43.866239,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_15_02_23_seed_0_22504813
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.8808594, 'precision': 0.8850616, 'recall': 0.8815514, 'specificity': 0.8815514, 'f1': 0.8806521, 'auroc': 0.9387951, 'binary_precision': 0.92867434, 'binary_recall': 0.82840616, 'binary_specificity': 0.93469656, 'binary_f1_score': 0.8756793}
confusion matrix:
      0     1
0  1417    99
1   267  1289
---- Validation: 
scalar performance:
{'acc': 0.6125776, 'precision': 0.6490435, 'recall': 0.60897493, 'specificity': 0.60897493, 'f1': 0.58300525, 'auroc': 0.7605792, 'binary_precision': 0.71935487, 'binary_recall': 0.3511811, 'binary_specificity': 0.8667688, 'binary_f1_score': 0.47195768}
confusion matrix:
     0    1
0  566   87
1  412  223
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.65581393, 'precision': 0.6946148, 'recall': 0.65581393, 'specificity': 0.65581393, 'f1': 0.6377586, 'auroc': 0.7905462, 'binary_precision': 0.7815126, 'binary_recall': 0.43255815, 'binary_specificity': 0.87906975, 'binary_f1_score': 0.5568862}
confusion matrix:
     0   1
0  189  26
1  122  93
new oracle model saved
early stop counter: 11
val acc:0.6125776171684265, best validation acc: 0.6319875717163086, corresponding to test acc:                         0.6325581669807434 / 0.6558139324188232
after epoch: 12,now: 2024-07-20 15:18:23.253465,epoch time: 0:01:16.047092,used: 0:15:59.913331,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_15_02_23_seed_0_22504813
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.87402344, 'precision': 0.88316935, 'recall': 0.8750905, 'specificity': 0.8750905, 'f1': 0.8734709, 'auroc': 0.93814373, 'binary_precision': 0.94588417, 'binary_recall': 0.7970456, 'binary_specificity': 0.9531353, 'binary_f1_score': 0.8651098}
confusion matrix:
      0     1
0  1444    71
1   316  1241
---- Validation: 
scalar performance:
{'acc': 0.6273292, 'precision': 0.6641425, 'recall': 0.6238922, 'specificity': 0.6238922, 'f1': 0.60148513, 'auroc': 0.76548696, 'binary_precision': 0.73846155, 'binary_recall': 0.37795275, 'binary_specificity': 0.86983156, 'binary_f1_score': 0.5}
confusion matrix:
     0    1
0  568   85
1  395  240
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.66744184, 'precision': 0.70398486, 'recall': 0.66744184, 'specificity': 0.66744184, 'f1': 0.6518495, 'auroc': 0.79770684, 'binary_precision': 0.7903226, 'binary_recall': 0.45581394, 'binary_specificity': 0.87906975, 'binary_f1_score': 0.57817113}
confusion matrix:
     0   1
0  189  26
1  117  98
new oracle model saved
early stop counter: 12
val acc:0.6273291707038879, best validation acc: 0.6319875717163086, corresponding to test acc:                         0.6325581669807434 / 0.6674418449401855
after epoch: 13,now: 2024-07-20 15:19:43.916805,epoch time: 0:01:20.663340,used: 0:17:20.576671,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_15_02_23_seed_0_22504813
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.88704425, 'precision': 0.8963436, 'recall': 0.88805526, 'specificity': 0.88805526, 'f1': 0.8865489, 'auroc': 0.9453698, 'binary_precision': 0.96039605, 'binary_recall': 0.81041133, 'binary_specificity': 0.9656992, 'binary_f1_score': 0.8790519}
confusion matrix:
      0     1
0  1464    52
1   295  1261
---- Validation: 
scalar performance:
{'acc': 0.6304348, 'precision': 0.6689199, 'recall': 0.6269766, 'specificity': 0.6269766, 'f1': 0.6044706, 'auroc': 0.76955056, 'binary_precision': 0.74613005, 'binary_recall': 0.37952757, 'binary_specificity': 0.8744257, 'binary_f1_score': 0.50313157}
confusion matrix:
     0    1
0  571   82
1  394  241
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6744186, 'precision': 0.7114754, 'recall': 0.6744186, 'specificity': 0.6744186, 'f1': 0.65950227, 'auroc': 0.8039156, 'binary_precision': 0.8, 'binary_recall': 0.4651163, 'binary_specificity': 0.88372093, 'binary_f1_score': 0.5882353}
confusion matrix:
     0    1
0  190   25
1  115  100
new oracle model saved
early stop counter: 13
val acc:0.6304348111152649, best validation acc: 0.6319875717163086, corresponding to test acc:                         0.6325581669807434 / 0.6744186282157898
after epoch: 14,now: 2024-07-20 15:21:02.295721,epoch time: 0:01:18.378916,used: 0:18:38.955587,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_15_02_23_seed_0_22504813
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.89908856, 'precision': 0.9055824, 'recall': 0.8998866, 'specificity': 0.8998866, 'f1': 0.89880013, 'auroc': 0.9508952, 'binary_precision': 0.9600887, 'binary_recall': 0.83536977, 'binary_specificity': 0.96440345, 'binary_f1_score': 0.8933975}
confusion matrix:
      0     1
0  1463    54
1   256  1299
---- Validation: 
scalar performance:
{'acc': 0.6506211, 'precision': 0.6834587, 'recall': 0.6475576, 'specificity': 0.6475576, 'f1': 0.6314168, 'auroc': 0.7737709, 'binary_precision': 0.75766015, 'binary_recall': 0.42834646, 'binary_specificity': 0.8667688, 'binary_f1_score': 0.5472837}
confusion matrix:
     0    1
0  566   87
1  363  272
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.67209303, 'precision': 0.702232, 'recall': 0.67209303, 'specificity': 0.67209303, 'f1': 0.6594031, 'auroc': 0.8104056, 'binary_precision': 0.780303, 'binary_recall': 0.47906977, 'binary_specificity': 0.8651163, 'binary_f1_score': 0.59366}
confusion matrix:
     0    1
0  186   29
1  112  103
better model found
persisted
after epoch: 15,now: 2024-07-20 15:22:18.622865,epoch time: 0:01:16.327144,used: 0:19:55.282731,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_15_02_23_seed_0_22504813
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.89485675, 'precision': 0.90383667, 'recall': 0.8958436, 'specificity': 0.8958436, 'f1': 0.8944226, 'auroc': 0.9535482, 'binary_precision': 0.96739954, 'binary_recall': 0.82005143, 'binary_specificity': 0.9716359, 'binary_f1_score': 0.88765216}
confusion matrix:
      0     1
0  1473    43
1   280  1276
---- Validation: 
scalar performance:
{'acc': 0.6568323, 'precision': 0.6864432, 'recall': 0.65394366, 'specificity': 0.65394366, 'f1': 0.64006424, 'auroc': 0.77806246, 'binary_precision': 0.75733334, 'binary_recall': 0.4472441, 'binary_specificity': 0.8606432, 'binary_f1_score': 0.56237626}
confusion matrix:
     0    1
0  562   91
1  351  284
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.68372095, 'precision': 0.71156675, 'recall': 0.68372095, 'specificity': 0.68372095, 'f1': 0.6729599, 'auroc': 0.8158356, 'binary_precision': 0.7883212, 'binary_recall': 0.5023256, 'binary_specificity': 0.8651163, 'binary_f1_score': 0.6136364}
confusion matrix:
     0    1
0  186   29
1  107  108
new oracle model saved
better model found
persisted
after epoch: 16,now: 2024-07-20 15:23:38.041591,epoch time: 0:01:19.418726,used: 0:21:14.701457,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_15_02_23_seed_0_22504813
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.8909505, 'precision': 0.8995682, 'recall': 0.89187217, 'specificity': 0.89187217, 'f1': 0.89050937, 'auroc': 0.94917786, 'binary_precision': 0.9614221, 'binary_recall': 0.8173633, 'binary_specificity': 0.966381, 'binary_f1_score': 0.8835592}
confusion matrix:
      0     1
0  1466    51
1   284  1271
---- Validation: 
scalar performance:
{'acc': 0.6785714, 'precision': 0.70357007, 'recall': 0.67603433, 'specificity': 0.67603433, 'f1': 0.6664023, 'auroc': 0.78223825, 'binary_precision': 0.7714988, 'binary_recall': 0.49448818, 'binary_specificity': 0.8575804, 'binary_f1_score': 0.6026872}
confusion matrix:
     0    1
0  560   93
1  321  314
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.68372095, 'precision': 0.70550513, 'recall': 0.68372095, 'specificity': 0.68372095, 'f1': 0.67511106, 'auroc': 0.82083285, 'binary_precision': 0.7724138, 'binary_recall': 0.52093023, 'binary_specificity': 0.8465116, 'binary_f1_score': 0.62222224}
confusion matrix:
     0    1
0  182   33
1  103  112
better model found
persisted
after epoch: 17,now: 2024-07-20 15:24:55.289922,epoch time: 0:01:17.248331,used: 0:22:31.949788,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_15_02_23_seed_0_22504813
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.89713544, 'precision': 0.90390337, 'recall': 0.89790726, 'specificity': 0.89790726, 'f1': 0.8968195, 'auroc': 0.9536027, 'binary_precision': 0.95919883, 'binary_recall': 0.83204633, 'binary_specificity': 0.9637681, 'binary_f1_score': 0.8911095}
confusion matrix:
      0     1
0  1463    55
1   261  1293
---- Validation: 
scalar performance:
{'acc': 0.6801242, 'precision': 0.7033522, 'recall': 0.6776742, 'specificity': 0.6776742, 'f1': 0.6688161, 'auroc': 0.78564835, 'binary_precision': 0.7686747, 'binary_recall': 0.5023622, 'binary_specificity': 0.8529862, 'binary_f1_score': 0.60761905}
confusion matrix:
     0    1
0  557   96
1  316  319
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7023256, 'precision': 0.7233753, 'recall': 0.7023256, 'specificity': 0.7023256, 'f1': 0.6951436, 'auroc': 0.8258302, 'binary_precision': 0.7919463, 'binary_recall': 0.5488372, 'binary_specificity': 0.855814, 'binary_f1_score': 0.64835167}
confusion matrix:
     0    1
0  184   31
1   97  118
new oracle model saved
better model found
persisted
after epoch: 18,now: 2024-07-20 15:26:11.621401,epoch time: 0:01:16.331479,used: 0:23:48.281267,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_15_02_23_seed_0_22504813
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9016927, 'precision': 0.90702796, 'recall': 0.90245605, 'specificity': 0.90245605, 'f1': 0.90147626, 'auroc': 0.95900583, 'binary_precision': 0.9569971, 'binary_recall': 0.84383035, 'binary_specificity': 0.9610818, 'binary_f1_score': 0.8968579}
confusion matrix:
      0     1
0  1457    59
1   243  1313
---- Validation: 
scalar performance:
{'acc': 0.6871118, 'precision': 0.7081884, 'recall': 0.6848042, 'specificity': 0.6848042, 'f1': 0.677263, 'auroc': 0.79004234, 'binary_precision': 0.77102804, 'binary_recall': 0.51968503, 'binary_specificity': 0.84992343, 'binary_f1_score': 0.62088424}
confusion matrix:
     0    1
0  555   98
1  305  330
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7116279, 'precision': 0.7308228, 'recall': 0.71162796, 'specificity': 0.71162796, 'f1': 0.7055055, 'auroc': 0.83030826, 'binary_precision': 0.79738563, 'binary_recall': 0.5674419, 'binary_specificity': 0.855814, 'binary_f1_score': 0.6630435}
confusion matrix:
     0    1
0  184   31
1   93  122
new oracle model saved
better model found
persisted
after epoch: 19,now: 2024-07-20 15:27:29.479092,epoch time: 0:01:17.857691,used: 0:25:06.138958,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_15_02_23_seed_0_22504813
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9065755, 'precision': 0.9105032, 'recall': 0.90726584, 'specificity': 0.90726584, 'f1': 0.9064398, 'auroc': 0.9599933, 'binary_precision': 0.9542203, 'binary_recall': 0.8567759, 'binary_specificity': 0.9577558, 'binary_f1_score': 0.9028765}
confusion matrix:
      0     1
0  1451    64
1   223  1334
---- Validation: 
scalar performance:
{'acc': 0.6995342, 'precision': 0.7163001, 'recall': 0.6975112, 'specificity': 0.6975112, 'f1': 0.69218624, 'auroc': 0.7940384, 'binary_precision': 0.77312773, 'binary_recall': 0.5527559, 'binary_specificity': 0.84226644, 'binary_f1_score': 0.6446281}
confusion matrix:
     0    1
0  550  103
1  284  351
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.73255813, 'precision': 0.74529934, 'recall': 0.73255813, 'specificity': 0.73255813, 'f1': 0.72903955, 'auroc': 0.83671176, 'binary_precision': 0.8012048, 'binary_recall': 0.61860466, 'binary_specificity': 0.8465116, 'binary_f1_score': 0.69816273}
confusion matrix:
     0    1
0  182   33
1   82  133
new oracle model saved
better model found
persisted
after epoch: 20,now: 2024-07-20 15:28:47.374972,epoch time: 0:01:17.895880,used: 0:26:24.034838,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_15_02_23_seed_0_22504813
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.91341144, 'precision': 0.92080027, 'recall': 0.9142955, 'specificity': 0.9142955, 'f1': 0.91313916, 'auroc': 0.9677459, 'binary_precision': 0.97991073, 'binary_recall': 0.84640104, 'binary_specificity': 0.98218995, 'binary_f1_score': 0.90827584}
confusion matrix:
      0     1
0  1489    27
1   239  1317
---- Validation: 
scalar performance:
{'acc': 0.6878882, 'precision': 0.71123093, 'recall': 0.6854831, 'specificity': 0.6854831, 'f1': 0.6772349, 'auroc': 0.7974461, 'binary_precision': 0.778043, 'binary_recall': 0.51338583, 'binary_specificity': 0.8575804, 'binary_f1_score': 0.61859584}
confusion matrix:
     0    1
0  560   93
1  309  326
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7255814, 'precision': 0.74463344, 'recall': 0.7255814, 'specificity': 0.7255814, 'f1': 0.72013235, 'auroc': 0.8415792, 'binary_precision': 0.8129032, 'binary_recall': 0.5860465, 'binary_specificity': 0.8651163, 'binary_f1_score': 0.68108106}
confusion matrix:
     0    1
0  186   29
1   89  126
early stop counter: 1
val acc:0.6878882050514221, best validation acc: 0.6995341777801514, corresponding to test acc:                         0.7325581312179565 / 0.7325581312179565
after epoch: 21,now: 2024-07-20 15:30:03.532194,epoch time: 0:01:16.157222,used: 0:27:40.192060,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_15_02_23_seed_0_22504813
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9042969, 'precision': 0.9122509, 'recall': 0.9052671, 'specificity': 0.9052671, 'f1': 0.90396714, 'auroc': 0.96255815, 'binary_precision': 0.9730337, 'binary_recall': 0.8342967, 'binary_specificity': 0.9762376, 'binary_f1_score': 0.8983402}
confusion matrix:
      0     1
0  1479    36
1   258  1299
---- Validation: 
scalar performance:
{'acc': 0.7173913, 'precision': 0.7307483, 'recall': 0.71564317, 'specificity': 0.71564317, 'f1': 0.7121378, 'auroc': 0.805718, 'binary_precision': 0.782881, 'binary_recall': 0.5905512, 'binary_specificity': 0.8407351, 'binary_f1_score': 0.6732496}
confusion matrix:
     0    1
0  549  104
1  260  375
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.75581396, 'precision': 0.76362133, 'recall': 0.75581396, 'specificity': 0.75581396, 'f1': 0.7539925, 'auroc': 0.8478097, 'binary_precision': 0.80898875, 'binary_recall': 0.66976744, 'binary_specificity': 0.8418605, 'binary_f1_score': 0.7328244}
confusion matrix:
     0    1
0  181   34
1   71  144
new oracle model saved
better model found
persisted
after epoch: 22,now: 2024-07-20 15:31:21.184471,epoch time: 0:01:17.652277,used: 0:28:57.844337,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_15_02_23_seed_0_22504813
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.9078776, 'precision': 0.91254306, 'recall': 0.9087004, 'specificity': 0.9087004, 'f1': 0.90771985, 'auroc': 0.96642274, 'binary_precision': 0.96031743, 'binary_recall': 0.85375243, 'binary_specificity': 0.9636484, 'binary_f1_score': 0.9039049}
confusion matrix:
      0     1
0  1458    55
1   228  1331
---- Validation: 
scalar performance:
{'acc': 0.7236025, 'precision': 0.7345409, 'recall': 0.72202915, 'specificity': 0.72202915, 'f1': 0.71937966, 'auroc': 0.80963206, 'binary_precision': 0.7818182, 'binary_recall': 0.6094488, 'binary_specificity': 0.8346095, 'binary_f1_score': 0.6849557}
confusion matrix:
     0    1
0  545  108
1  248  387
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7651163, 'precision': 0.770745, 'recall': 0.7651163, 'specificity': 0.7651163, 'f1': 0.7638891, 'auroc': 0.8537588, 'binary_precision': 0.8097826, 'binary_recall': 0.69302326, 'binary_specificity': 0.8372093, 'binary_f1_score': 0.7468671}
confusion matrix:
     0    1
0  180   35
1   66  149
new oracle model saved
better model found
persisted
after epoch: 23,now: 2024-07-20 15:32:41.392592,epoch time: 0:01:20.208121,used: 0:30:18.052458,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_15_02_23_seed_0_22504813
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9108073, 'precision': 0.91833484, 'recall': 0.9116555, 'specificity': 0.9116555, 'f1': 0.91051364, 'auroc': 0.9659198, 'binary_precision': 0.97762865, 'binary_recall': 0.84308684, 'binary_specificity': 0.98022413, 'binary_f1_score': 0.9053868}
confusion matrix:
      0     1
0  1487    30
1   244  1311
---- Validation: 
scalar performance:
{'acc': 0.7243789, 'precision': 0.7369257, 'recall': 0.722708, 'specificity': 0.722708, 'f1': 0.71966606, 'auroc': 0.81450844, 'binary_precision': 0.78806585, 'binary_recall': 0.6031496, 'binary_specificity': 0.84226644, 'binary_f1_score': 0.68331844}
confusion matrix:
     0    1
0  550  103
1  252  383
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7744186, 'precision': 0.7818889, 'recall': 0.7744186, 'specificity': 0.7744186, 'f1': 0.7729141, 'auroc': 0.8585181, 'binary_precision': 0.8277778, 'binary_recall': 0.69302326, 'binary_specificity': 0.855814, 'binary_f1_score': 0.75443035}
confusion matrix:
     0    1
0  184   31
1   66  149
new oracle model saved
better model found
persisted
after epoch: 24,now: 2024-07-20 15:33:58.527291,epoch time: 0:01:17.134699,used: 0:31:35.187157,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_15_02_23_seed_0_22504813
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.9121094, 'precision': 0.9159231, 'recall': 0.9127873, 'specificity': 0.9127873, 'f1': 0.91198814, 'auroc': 0.96607673, 'binary_precision': 0.95931476, 'binary_recall': 0.86319846, 'binary_specificity': 0.96237624, 'binary_f1_score': 0.9087221}
confusion matrix:
      0     1
0  1458    57
1   213  1344
---- Validation: 
scalar performance:
{'acc': 0.73990685, 'precision': 0.7458871, 'recall': 0.73875993, 'specificity': 0.73875993, 'f1': 0.73766756, 'auroc': 0.8173566, 'binary_precision': 0.78089887, 'binary_recall': 0.6566929, 'binary_specificity': 0.82082695, 'binary_f1_score': 0.7134303}
confusion matrix:
     0    1
0  536  117
1  218  417
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7744186, 'precision': 0.7781798, 'recall': 0.7744186, 'specificity': 0.7744186, 'f1': 0.7736535, 'auroc': 0.8625202, 'binary_precision': 0.8105263, 'binary_recall': 0.7162791, 'binary_specificity': 0.83255816, 'binary_f1_score': 0.7604939}
confusion matrix:
     0    1
0  179   36
1   61  154
better model found
persisted
after epoch: 25,now: 2024-07-20 15:35:16.762385,epoch time: 0:01:18.235094,used: 0:32:53.422251,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_15_02_23_seed_0_22504813
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9169922, 'precision': 0.9213618, 'recall': 0.91767764, 'specificity': 0.91767764, 'f1': 0.9168545, 'auroc': 0.9707524, 'binary_precision': 0.96764916, 'binary_recall': 0.8650386, 'binary_specificity': 0.97031665, 'binary_f1_score': 0.91347134}
confusion matrix:
      0     1
0  1471    45
1   210  1346
---- Validation: 
scalar performance:
{'acc': 0.75621116, 'precision': 0.7600125, 'recall': 0.7553171, 'specificity': 0.7553171, 'f1': 0.7548493, 'auroc': 0.82494605, 'binary_precision': 0.7881508, 'binary_recall': 0.6913386, 'binary_specificity': 0.8192956, 'binary_f1_score': 0.7365772}
confusion matrix:
     0    1
0  535  118
1  196  439
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7813954, 'precision': 0.78338164, 'recall': 0.7813953, 'specificity': 0.7813953, 'f1': 0.78101164, 'auroc': 0.8686425, 'binary_precision': 0.8071066, 'binary_recall': 0.73953485, 'binary_specificity': 0.82325584, 'binary_f1_score': 0.7718447}
confusion matrix:
     0    1
0  177   38
1   56  159
new oracle model saved
better model found
persisted
after epoch: 26,now: 2024-07-20 15:36:39.134987,epoch time: 0:01:22.372602,used: 0:34:15.794853,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_15_02_23_seed_0_22504813
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.9166667, 'precision': 0.92253387, 'recall': 0.91749686, 'specificity': 0.91749686, 'f1': 0.9164728, 'auroc': 0.96890485, 'binary_precision': 0.9758595, 'binary_recall': 0.8567759, 'binary_specificity': 0.97821784, 'binary_f1_score': 0.9124487}
confusion matrix:
      0     1
0  1482    33
1   223  1334
---- Validation: 
scalar performance:
{'acc': 0.753882, 'precision': 0.7597695, 'recall': 0.7527813, 'specificity': 0.7527813, 'f1': 0.75190413, 'auroc': 0.82666314, 'binary_precision': 0.795539, 'binary_recall': 0.67401576, 'binary_specificity': 0.8315467, 'binary_f1_score': 0.7297528}
confusion matrix:
     0    1
0  543  110
1  207  428
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7883721, 'precision': 0.79171044, 'recall': 0.7883721, 'specificity': 0.7883721, 'f1': 0.7877649, 'auroc': 0.8714981, 'binary_precision': 0.8229167, 'binary_recall': 0.7348837, 'binary_specificity': 0.8418605, 'binary_f1_score': 0.7764128}
confusion matrix:
     0    1
0  181   34
1   57  158
new oracle model saved
early stop counter: 1
val acc:0.7538819909095764, best validation acc: 0.7562111616134644, corresponding to test acc:                         0.7813953757286072 / 0.7883720993995667
after epoch: 27,now: 2024-07-20 15:37:54.938303,epoch time: 0:01:15.803316,used: 0:35:31.598169,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_15_02_23_seed_0_22504813
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.9140625, 'precision': 0.91878176, 'recall': 0.9148121, 'specificity': 0.9148121, 'f1': 0.9139083, 'auroc': 0.9701024, 'binary_precision': 0.966787, 'binary_recall': 0.85998714, 'binary_specificity': 0.969637, 'binary_f1_score': 0.9102651}
confusion matrix:
      0     1
0  1469    46
1   218  1339
---- Validation: 
scalar performance:
{'acc': 0.753882, 'precision': 0.76081795, 'recall': 0.7526944, 'specificity': 0.7526944, 'f1': 0.75161684, 'auroc': 0.826141, 'binary_precision': 0.8, 'binary_recall': 0.66771656, 'binary_specificity': 0.8376723, 'binary_f1_score': 0.727897}
confusion matrix:
     0    1
0  547  106
1  211  424
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7883721, 'precision': 0.79232454, 'recall': 0.78837204, 'specificity': 0.78837204, 'f1': 0.7876543, 'auroc': 0.87242836, 'binary_precision': 0.82631576, 'binary_recall': 0.73023254, 'binary_specificity': 0.8465116, 'binary_f1_score': 0.7753086}
confusion matrix:
     0    1
0  182   33
1   58  157
early stop counter: 2
val acc:0.7538819909095764, best validation acc: 0.7562111616134644, corresponding to test acc:                         0.7813953757286072 / 0.7883720993995667
after epoch: 28,now: 2024-07-20 15:39:11.188441,epoch time: 0:01:16.250138,used: 0:36:47.848307,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_15_02_23_seed_0_22504813
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9140625, 'precision': 0.920772, 'recall': 0.9148629, 'specificity': 0.9148629, 'f1': 0.9138168, 'auroc': 0.97342575, 'binary_precision': 0.977088, 'binary_recall': 0.8501608, 'binary_specificity': 0.9795649, 'binary_f1_score': 0.9092159}
confusion matrix:
      0     1
0  1486    31
1   233  1322
---- Validation: 
scalar performance:
{'acc': 0.7585404, 'precision': 0.7638164, 'recall': 0.75750566, 'specificity': 0.75750566, 'f1': 0.7567986, 'auroc': 0.8312501, 'binary_precision': 0.7977941, 'binary_recall': 0.6834646, 'binary_specificity': 0.8315467, 'binary_f1_score': 0.73621714}
confusion matrix:
     0    1
0  543  110
1  201  434
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7930232, 'precision': 0.7948668, 'recall': 0.7930232, 'specificity': 0.7930232, 'f1': 0.7926992, 'auroc': 0.8758681, 'binary_precision': 0.8181818, 'binary_recall': 0.75348836, 'binary_specificity': 0.83255816, 'binary_f1_score': 0.78450364}
confusion matrix:
     0    1
0  179   36
1   53  162
new oracle model saved
better model found
persisted
after epoch: 29,now: 2024-07-20 15:40:27.739216,epoch time: 0:01:16.550775,used: 0:38:04.399082,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_15_02_23_seed_0_22504813
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.9160156, 'precision': 0.91980207, 'recall': 0.916623, 'specificity': 0.916623, 'f1': 0.9158957, 'auroc': 0.96858454, 'binary_precision': 0.96288365, 'binary_recall': 0.8675241, 'binary_specificity': 0.96572185, 'binary_f1_score': 0.9127199}
confusion matrix:
      0     1
0  1465    52
1   206  1349
---- Validation: 
scalar performance:
{'acc': 0.76552796, 'precision': 0.76801527, 'recall': 0.7648093, 'specificity': 0.7648093, 'f1': 0.7646199, 'auroc': 0.8341103, 'binary_precision': 0.7905759, 'binary_recall': 0.7133858, 'binary_specificity': 0.8162328, 'binary_f1_score': 0.74999994}
confusion matrix:
     0    1
0  533  120
1  182  453
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.80465114, 'precision': 0.8063477, 'recall': 0.80465114, 'specificity': 0.80465114, 'f1': 0.8043803, 'auroc': 0.8792645, 'binary_precision': 0.8291457, 'binary_recall': 0.76744187, 'binary_specificity': 0.8418605, 'binary_f1_score': 0.7971014}
confusion matrix:
     0    1
0  181   34
1   50  165
new oracle model saved
better model found
persisted
after epoch: 30,now: 2024-07-20 15:41:43.829320,epoch time: 0:01:16.090104,used: 0:39:20.489186,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_15_02_23_seed_0_22504813
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 0:39:20.489186 at 2024-07-20 15:41:43.829320
persisted model performance metric: 

scalar performance:
{'acc': 0.80465114, 'precision': 0.8063477, 'recall': 0.80465114, 'specificity': 0.80465114, 'f1': 0.8043803, 'auroc': 0.8792645, 'binary_precision': 0.8291457, 'binary_recall': 0.76744187, 'binary_specificity': 0.8418605, 'binary_f1_score': 0.7971014}
confusion matrix:
     0    1
0  181   34
1   50  165
oracle model performance metric: 

scalar performance:
{'acc': 0.80465114, 'precision': 0.8063477, 'recall': 0.80465114, 'specificity': 0.80465114, 'f1': 0.8043803, 'auroc': 0.8792645, 'binary_precision': 0.8291457, 'binary_recall': 0.76744187, 'binary_specificity': 0.8418605, 'binary_f1_score': 0.7971014}
confusion matrix:
     0    1
0  181   34
1   50  165
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_halffreezeblocks_2024-07-20_12-47-21/rule_results/3.csv
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_halffreezeblocks_2024-07-20_12-47-21/rule_results/3.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_halffreezeblocks_2024-07-20_12-47-21/confusion_matrix/3.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 197058 KiB |   7828 MiB |  61331 GiB |  61331 GiB |
|       from large pool | 180662 KiB |   7805 MiB |  60516 GiB |  60516 GiB |
|       from small pool |  16396 KiB |     32 MiB |    815 GiB |    815 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 197058 KiB |   7828 MiB |  61331 GiB |  61331 GiB |
|       from large pool | 180662 KiB |   7805 MiB |  60516 GiB |  60516 GiB |
|       from small pool |  16396 KiB |     32 MiB |    815 GiB |    815 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 195188 KiB |   7827 MiB |  61326 GiB |  61326 GiB |
|       from large pool | 178979 KiB |   7804 MiB |  60513 GiB |  60512 GiB |
|       from small pool |  16209 KiB |     32 MiB |    813 GiB |    813 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   8524 MiB |   8524 MiB |   8524 MiB |      0 B   |
|       from large pool |   8486 MiB |   8486 MiB |   8486 MiB |      0 B   |
|       from small pool |     38 MiB |     38 MiB |     38 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |  56894 KiB | 732464 KiB |  34525 GiB |  34525 GiB |
|       from large pool |  50762 KiB | 730714 KiB |  33707 GiB |  33707 GiB |
|       from small pool |   6132 KiB |   9662 KiB |    817 GiB |    817 GiB |
|---------------------------------------------------------------------------|
| Allocations           |     788    |    1675    |   10386 K  |   10386 K  |
|       from large pool |      79    |     762    |    5637 K  |    5637 K  |
|       from small pool |     709    |    1005    |    4749 K  |    4748 K  |
|---------------------------------------------------------------------------|
| Active allocs         |     788    |    1675    |   10386 K  |   10386 K  |
|       from large pool |      79    |     762    |    5637 K  |    5637 K  |
|       from small pool |     709    |    1005    |    4749 K  |    4748 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     368    |     368    |     368    |       0    |
|       from large pool |     349    |     349    |     349    |       0    |
|       from small pool |      19    |      19    |      19    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      40    |     383    |    6398 K  |    6398 K  |
|       from large pool |      10    |     350    |    4321 K  |    4321 K  |
|       from small pool |      30    |     213    |    2077 K  |    2077 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   7828 MiB |  61331 GiB |  61331 GiB |
|       from large pool |  16640 KiB |   7805 MiB |  60516 GiB |  60516 GiB |
|       from small pool |      0 KiB |     32 MiB |    815 GiB |    815 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   7828 MiB |  61331 GiB |  61331 GiB |
|       from large pool |  16640 KiB |   7805 MiB |  60516 GiB |  60516 GiB |
|       from small pool |      0 KiB |     32 MiB |    815 GiB |    815 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   7827 MiB |  61326 GiB |  61326 GiB |
|       from large pool |  16640 KiB |   7804 MiB |  60513 GiB |  60513 GiB |
|       from small pool |      0 KiB |     32 MiB |    813 GiB |    813 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 253952 KiB |   8524 MiB |   8524 MiB |   8276 MiB |
|       from large pool | 231424 KiB |   8486 MiB |   8486 MiB |   8260 MiB |
|       from small pool |  22528 KiB |     38 MiB |     38 MiB |     16 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  30464 KiB | 732464 KiB |  34525 GiB |  34525 GiB |
|       from large pool |  30464 KiB | 730714 KiB |  33707 GiB |  33707 GiB |
|       from small pool |      0 KiB |  19386 KiB |    817 GiB |    817 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    1675    |   10386 K  |   10386 K  |
|       from large pool |       2    |     762    |    5637 K  |    5637 K  |
|       from small pool |       0    |    1005    |    4749 K  |    4749 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    1675    |   10386 K  |   10386 K  |
|       from large pool |       2    |     762    |    5637 K  |    5637 K  |
|       from small pool |       0    |    1005    |    4749 K  |    4749 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      22    |     368    |     368    |     346    |
|       from large pool |      11    |     349    |     349    |     338    |
|       from small pool |      11    |      19    |      19    |       8    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     383    |    6398 K  |    6398 K  |
|       from large pool |       3    |     350    |    4321 K  |    4321 K  |
|       from small pool |       0    |     213    |    2077 K  |    2077 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   7828 MiB |  61331 GiB |  61331 GiB |
|       from large pool |  16640 KiB |   7805 MiB |  60516 GiB |  60516 GiB |
|       from small pool |      0 KiB |     32 MiB |    815 GiB |    815 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   7828 MiB |  61331 GiB |  61331 GiB |
|       from large pool |  16640 KiB |   7805 MiB |  60516 GiB |  60516 GiB |
|       from small pool |      0 KiB |     32 MiB |    815 GiB |    815 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   7827 MiB |  61326 GiB |  61326 GiB |
|       from large pool |  16640 KiB |   7804 MiB |  60513 GiB |  60513 GiB |
|       from small pool |      0 KiB |     32 MiB |    813 GiB |    813 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 253952 KiB |   8524 MiB |   8524 MiB |   8276 MiB |
|       from large pool | 231424 KiB |   8486 MiB |   8486 MiB |   8260 MiB |
|       from small pool |  22528 KiB |     38 MiB |     38 MiB |     16 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  30464 KiB | 732464 KiB |  34525 GiB |  34525 GiB |
|       from large pool |  30464 KiB | 730714 KiB |  33707 GiB |  33707 GiB |
|       from small pool |      0 KiB |  19386 KiB |    817 GiB |    817 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    1675    |   10386 K  |   10386 K  |
|       from large pool |       2    |     762    |    5637 K  |    5637 K  |
|       from small pool |       0    |    1005    |    4749 K  |    4749 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    1675    |   10386 K  |   10386 K  |
|       from large pool |       2    |     762    |    5637 K  |    5637 K  |
|       from small pool |       0    |    1005    |    4749 K  |    4749 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      22    |     368    |     368    |     346    |
|       from large pool |      11    |     349    |     349    |     338    |
|       from small pool |      11    |      19    |      19    |       8    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     383    |    6398 K  |    6398 K  |
|       from large pool |       3    |     350    |    4321 K  |    4321 K  |
|       from small pool |       0    |     213    |    2077 K  |    2077 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'888c1ef2'
model name: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_15_43_00_seed_1_22504813

 Experiment start at: 2024-07-20 15:43:00.981666
before training, model accuracy: 0.6177777647972107
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.54589844, 'precision': 0.55117685, 'recall': 0.54365754, 'specificity': 0.54365754, 'f1': 0.52744895, 'auroc': 0.5355015, 'binary_precision': 0.53741175, 'binary_recall': 0.7348777, 'binary_specificity': 0.3524374, 'binary_f1_score': 0.6208208}
confusion matrix:
     0     1
0  535   983
1  412  1142
---- Validation: 
scalar performance:
{'acc': 0.48946136, 'precision': 0.4712597, 'recall': 0.48399898, 'specificity': 0.48399898, 'f1': 0.42222166, 'auroc': 0.62196374, 'binary_precision': 0.44392523, 'binary_recall': 0.15079366, 'binary_specificity': 0.8172043, 'binary_f1_score': 0.2251185}
confusion matrix:
     0    1
0  532  119
1  535   95
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.56, 'precision': 0.5771154, 'recall': 0.56, 'specificity': 0.56, 'f1': 0.5341518, 'auroc': 0.667595, 'binary_precision': 0.6134454, 'binary_recall': 0.32444444, 'binary_specificity': 0.79555553, 'binary_f1_score': 0.42441863}
confusion matrix:
     0   1
0  179  46
1  152  73
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-20 15:44:21.758837,epoch time: 0:01:20.777171,used: 0:01:20.777171,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_15_43_00_seed_1_22504813
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.58984375, 'precision': 0.5903114, 'recall': 0.5891527, 'specificity': 0.5891527, 'f1': 0.58820146, 'auroc': 0.6050018, 'binary_precision': 0.5862069, 'binary_recall': 0.6450161, 'binary_specificity': 0.5332894, 'binary_f1_score': 0.61420697}
confusion matrix:
     0     1
0  809   708
1  552  1003
---- Validation: 
scalar performance:
{'acc': 0.47540984, 'precision': 0.41706464, 'recall': 0.4689196, 'specificity': 0.4689196, 'f1': 0.37333512, 'auroc': 0.6302953, 'binary_precision': 0.3432836, 'binary_recall': 0.073015876, 'binary_specificity': 0.86482334, 'binary_f1_score': 0.120418854}
confusion matrix:
     0   1
0  563  88
1  584  46
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.54, 'precision': 0.57990056, 'recall': 0.53999996, 'specificity': 0.53999996, 'f1': 0.47437912, 'auroc': 0.67760986, 'binary_precision': 0.6363636, 'binary_recall': 0.18666667, 'binary_specificity': 0.8933333, 'binary_f1_score': 0.28865978}
confusion matrix:
     0   1
0  201  24
1  183  42
early stop counter: 1
val acc:0.4754098355770111, best validation acc: 0.48946136236190796, corresponding to test acc:                         0.5600000023841858 / 0.5600000023841858
after epoch: 2,now: 2024-07-20 15:45:38.716158,epoch time: 0:01:16.957321,used: 0:02:37.734492,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_15_43_00_seed_1_22504813
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.66276044, 'precision': 0.6629493, 'recall': 0.6623461, 'specificity': 0.6623461, 'f1': 0.66226214, 'auroc': 0.70651925, 'binary_precision': 0.6599265, 'binary_recall': 0.6912709, 'binary_specificity': 0.6334214, 'binary_f1_score': 0.67523515}
confusion matrix:
     0     1
0  959   555
1  481  1077
---- Validation: 
scalar performance:
{'acc': 0.47619048, 'precision': 0.42081183, 'recall': 0.46973887, 'specificity': 0.46973887, 'f1': 0.37567338, 'auroc': 0.6488358, 'binary_precision': 0.35036495, 'binary_recall': 0.07619048, 'binary_specificity': 0.86328727, 'binary_f1_score': 0.12516297}
confusion matrix:
     0   1
0  562  89
1  582  48
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.53555554, 'precision': 0.5728627, 'recall': 0.53555554, 'specificity': 0.53555554, 'f1': 0.4673772, 'auroc': 0.69627655, 'binary_precision': 0.625, 'binary_recall': 0.17777778, 'binary_specificity': 0.8933333, 'binary_f1_score': 0.2768166}
confusion matrix:
     0   1
0  201  24
1  185  40
early stop counter: 2
val acc:0.4761904776096344, best validation acc: 0.48946136236190796, corresponding to test acc:                         0.5600000023841858 / 0.5600000023841858
after epoch: 3,now: 2024-07-20 15:46:55.827387,epoch time: 0:01:17.111229,used: 0:03:54.845721,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_15_43_00_seed_1_22504813
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.7236328, 'precision': 0.7236154, 'recall': 0.72353, 'specificity': 0.72353, 'f1': 0.72355056, 'auroc': 0.7835827, 'binary_precision': 0.72437936, 'binary_recall': 0.73230374, 'binary_specificity': 0.71475625, 'binary_f1_score': 0.72832}
confusion matrix:
      0     1
0  1085   433
1   416  1138
---- Validation: 
scalar performance:
{'acc': 0.48711944, 'precision': 0.44941872, 'recall': 0.48067078, 'specificity': 0.48067078, 'f1': 0.38869962, 'auroc': 0.6635213, 'binary_precision': 0.40145984, 'binary_recall': 0.08730159, 'binary_specificity': 0.87403995, 'binary_f1_score': 0.14341591}
confusion matrix:
     0   1
0  569  82
1  575  55
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5311111, 'precision': 0.5736532, 'recall': 0.5311111, 'specificity': 0.5311111, 'f1': 0.45197648, 'auroc': 0.7145481, 'binary_precision': 0.6296296, 'binary_recall': 0.15111111, 'binary_specificity': 0.9111111, 'binary_f1_score': 0.2437276}
confusion matrix:
     0   1
0  205  20
1  191  34
early stop counter: 3
val acc:0.4871194362640381, best validation acc: 0.48946136236190796, corresponding to test acc:                         0.5600000023841858 / 0.5600000023841858
after epoch: 4,now: 2024-07-20 15:48:12.940562,epoch time: 0:01:17.113175,used: 0:05:11.958896,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_15_43_00_seed_1_22504813
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.7708333, 'precision': 0.77081823, 'recall': 0.77086234, 'specificity': 0.77086234, 'f1': 0.77081937, 'auroc': 0.8394618, 'binary_precision': 0.77662337, 'binary_recall': 0.76863754, 'binary_specificity': 0.7730871, 'binary_f1_score': 0.77260983}
confusion matrix:
      0     1
0  1172   344
1   360  1196
---- Validation: 
scalar performance:
{'acc': 0.49570647, 'precision': 0.4725241, 'recall': 0.48929852, 'specificity': 0.48929852, 'f1': 0.40027392, 'auroc': 0.68221295, 'binary_precision': 0.44285715, 'binary_recall': 0.0984127, 'binary_specificity': 0.88018435, 'binary_f1_score': 0.16103896}
confusion matrix:
     0   1
0  573  78
1  568  62
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.53333336, 'precision': 0.58020055, 'recall': 0.5333333, 'specificity': 0.5333333, 'f1': 0.45349184, 'auroc': 0.731042, 'binary_precision': 0.6415094, 'binary_recall': 0.15111111, 'binary_specificity': 0.91555554, 'binary_f1_score': 0.2446043}
confusion matrix:
     0   1
0  206  19
1  191  34
better model found
persisted
after epoch: 5,now: 2024-07-20 15:49:30.426892,epoch time: 0:01:17.486330,used: 0:06:29.445226,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_15_43_00_seed_1_22504813
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.79296875, 'precision': 0.7930193, 'recall': 0.79304713, 'specificity': 0.79304713, 'f1': 0.7929673, 'auroc': 0.871302, 'binary_precision': 0.8007864, 'binary_recall': 0.78635776, 'binary_specificity': 0.7997365, 'binary_f1_score': 0.7935065}
confusion matrix:
      0     1
0  1214   304
1   332  1222
---- Validation: 
scalar performance:
{'acc': 0.5066354, 'precision': 0.5006492, 'recall': 0.500256, 'specificity': 0.500256, 'f1': 0.41413724, 'auroc': 0.6985761, 'binary_precision': 0.49295774, 'binary_recall': 0.11111111, 'binary_specificity': 0.8894009, 'binary_f1_score': 0.18134713}
confusion matrix:
     0   1
0  579  72
1  560  70
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.54, 'precision': 0.5890658, 'recall': 0.54, 'specificity': 0.54, 'f1': 0.46652845, 'auroc': 0.7423605, 'binary_precision': 0.6551724, 'binary_recall': 0.16888888, 'binary_specificity': 0.9111111, 'binary_f1_score': 0.26855123}
confusion matrix:
     0   1
0  205  20
1  187  38
better model found
persisted
after epoch: 6,now: 2024-07-20 15:50:47.531958,epoch time: 0:01:17.105066,used: 0:07:46.550292,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_15_43_00_seed_1_22504813
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.8069661, 'precision': 0.80702853, 'recall': 0.80706483, 'specificity': 0.80706483, 'f1': 0.80696446, 'auroc': 0.8822272, 'binary_precision': 0.8157377, 'binary_recall': 0.79948586, 'binary_specificity': 0.8146438, 'binary_f1_score': 0.80753}
confusion matrix:
      0     1
0  1235   281
1   312  1244
---- Validation: 
scalar performance:
{'acc': 0.5136612, 'precision': 0.5177841, 'recall': 0.50739884, 'specificity': 0.50739884, 'f1': 0.42625064, 'auroc': 0.71365416, 'binary_precision': 0.5231788, 'binary_recall': 0.12539683, 'binary_specificity': 0.8894009, 'binary_f1_score': 0.20230475}
confusion matrix:
     0   1
0  579  72
1  551  79
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5422222, 'precision': 0.59265685, 'recall': 0.5422222, 'specificity': 0.5422222, 'f1': 0.47011614, 'auroc': 0.75437033, 'binary_precision': 0.66101694, 'binary_recall': 0.17333333, 'binary_specificity': 0.9111111, 'binary_f1_score': 0.27464786}
confusion matrix:
     0   1
0  205  20
1  186  39
better model found
persisted
after epoch: 7,now: 2024-07-20 15:52:05.418936,epoch time: 0:01:17.886978,used: 0:09:04.437270,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_15_43_00_seed_1_22504813
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.8186849, 'precision': 0.8197564, 'recall': 0.8190739, 'specificity': 0.8190739, 'f1': 0.81863093, 'auroc': 0.8844334, 'binary_precision': 0.84199727, 'binary_recall': 0.790623, 'binary_specificity': 0.84752476, 'binary_f1_score': 0.8155018}
confusion matrix:
      0     1
0  1284   231
1   326  1231
---- Validation: 
scalar performance:
{'acc': 0.5230289, 'precision': 0.54113126, 'recall': 0.51671785, 'specificity': 0.51671785, 'f1': 0.43567267, 'auroc': 0.7272841, 'binary_precision': 0.56462586, 'binary_recall': 0.13174604, 'binary_specificity': 0.9016897, 'binary_f1_score': 0.21364222}
confusion matrix:
     0   1
0  587  64
1  547  83
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.55777776, 'precision': 0.62865055, 'recall': 0.55777776, 'specificity': 0.55777776, 'f1': 0.48714572, 'auroc': 0.7678222, 'binary_precision': 0.7241379, 'binary_recall': 0.18666667, 'binary_specificity': 0.9288889, 'binary_f1_score': 0.2968198}
confusion matrix:
     0   1
0  209  16
1  183  42
better model found
persisted
after epoch: 8,now: 2024-07-20 15:53:22.371877,epoch time: 0:01:16.952941,used: 0:10:21.390211,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_15_43_00_seed_1_22504813
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.8453776, 'precision': 0.8471201, 'recall': 0.8458171, 'specificity': 0.8458171, 'f1': 0.8452804, 'auroc': 0.9081838, 'binary_precision': 0.875, 'binary_recall': 0.8102894, 'binary_specificity': 0.88134474, 'binary_f1_score': 0.84140235}
confusion matrix:
      0     1
0  1337   180
1   295  1260
---- Validation: 
scalar performance:
{'acc': 0.529274, 'precision': 0.5526397, 'recall': 0.5231439, 'specificity': 0.5231439, 'f1': 0.44859412, 'auroc': 0.7383146, 'binary_precision': 0.5838509, 'binary_recall': 0.14920636, 'binary_specificity': 0.89708143, 'binary_f1_score': 0.23767383}
confusion matrix:
     0   1
0  584  67
1  536  94
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5688889, 'precision': 0.64697206, 'recall': 0.5688889, 'specificity': 0.5688889, 'f1': 0.5028587, 'auroc': 0.77795553, 'binary_precision': 0.75409836, 'binary_recall': 0.20444444, 'binary_specificity': 0.93333334, 'binary_f1_score': 0.3216783}
confusion matrix:
     0   1
0  210  15
1  179  46
new oracle model saved
better model found
persisted
after epoch: 9,now: 2024-07-20 15:54:39.491835,epoch time: 0:01:17.119958,used: 0:11:38.510169,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_15_43_00_seed_1_22504813
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.8570964, 'precision': 0.8600801, 'recall': 0.85772395, 'specificity': 0.85772395, 'f1': 0.8569292, 'auroc': 0.9223615, 'binary_precision': 0.8964539, 'binary_recall': 0.8118176, 'binary_specificity': 0.9036304, 'binary_f1_score': 0.8520391}
confusion matrix:
      0     1
0  1369   146
1   293  1264
---- Validation: 
scalar performance:
{'acc': 0.5277127, 'precision': 0.5532267, 'recall': 0.5213774, 'specificity': 0.5213774, 'f1': 0.44039935, 'auroc': 0.7469412, 'binary_precision': 0.5862069, 'binary_recall': 0.13492064, 'binary_specificity': 0.9078341, 'binary_f1_score': 0.21935485}
confusion matrix:
     0   1
0  591  60
1  545  85
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.56, 'precision': 0.6398159, 'recall': 0.56, 'specificity': 0.56, 'f1': 0.48675114, 'auroc': 0.7860148, 'binary_precision': 0.74545455, 'binary_recall': 0.18222222, 'binary_specificity': 0.93777776, 'binary_f1_score': 0.2928571}
confusion matrix:
     0   1
0  211  14
1  184  41
early stop counter: 1
val acc:0.5277127027511597, best validation acc: 0.5292739868164062, corresponding to test acc:                         0.5688889026641846 / 0.5688889026641846
after epoch: 10,now: 2024-07-20 15:55:56.598238,epoch time: 0:01:17.106403,used: 0:12:55.616572,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_15_43_00_seed_1_22504813
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.85807294, 'precision': 0.8607836, 'recall': 0.85864234, 'specificity': 0.85864234, 'f1': 0.8579224, 'auroc': 0.9188107, 'binary_precision': 0.8954802, 'binary_recall': 0.81491005, 'binary_specificity': 0.9023747, 'binary_f1_score': 0.8532975}
confusion matrix:
      0     1
0  1368   148
1   288  1268
---- Validation: 
scalar performance:
{'acc': 0.53629977, 'precision': 0.5634811, 'recall': 0.53038913, 'specificity': 0.53038913, 'f1': 0.46309847, 'auroc': 0.7542608, 'binary_precision': 0.6011236, 'binary_recall': 0.16984127, 'binary_specificity': 0.89093703, 'binary_f1_score': 0.26485148}
confusion matrix:
     0    1
0  580   71
1  523  107
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5688889, 'precision': 0.64697206, 'recall': 0.5688889, 'specificity': 0.5688889, 'f1': 0.5028587, 'auroc': 0.7932445, 'binary_precision': 0.75409836, 'binary_recall': 0.20444444, 'binary_specificity': 0.93333334, 'binary_f1_score': 0.3216783}
confusion matrix:
     0   1
0  210  15
1  179  46
better model found
persisted
after epoch: 11,now: 2024-07-20 15:57:13.610102,epoch time: 0:01:17.011864,used: 0:14:12.628436,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_15_43_00_seed_1_22504813
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.8613281, 'precision': 0.8655133, 'recall': 0.8621018, 'specificity': 0.8621018, 'f1': 0.861087, 'auroc': 0.92383623, 'binary_precision': 0.9083694, 'binary_recall': 0.8080873, 'binary_specificity': 0.91611624, 'binary_f1_score': 0.855299}
confusion matrix:
      0     1
0  1387   127
1   299  1259
---- Validation: 
scalar performance:
{'acc': 0.53942233, 'precision': 0.5694066, 'recall': 0.53353816, 'specificity': 0.53353816, 'f1': 0.4674235, 'auroc': 0.7581377, 'binary_precision': 0.6111111, 'binary_recall': 0.17460318, 'binary_specificity': 0.8924731, 'binary_f1_score': 0.27160496}
confusion matrix:
     0    1
0  581   70
1  520  110
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5711111, 'precision': 0.6496508, 'recall': 0.5711111, 'specificity': 0.5711111, 'f1': 0.50634056, 'auroc': 0.79913086, 'binary_precision': 0.7580645, 'binary_recall': 0.20888889, 'binary_specificity': 0.93333334, 'binary_f1_score': 0.32752615}
confusion matrix:
     0   1
0  210  15
1  178  47
new oracle model saved
better model found
persisted
after epoch: 12,now: 2024-07-20 15:58:31.021222,epoch time: 0:01:17.411120,used: 0:15:30.039556,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_15_43_00_seed_1_22504813
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.87630206, 'precision': 0.87885547, 'recall': 0.8768754, 'specificity': 0.8768754, 'f1': 0.876191, 'auroc': 0.9382335, 'binary_precision': 0.9135629, 'binary_recall': 0.834939, 'binary_specificity': 0.91881186, 'binary_f1_score': 0.8724832}
confusion matrix:
      0     1
0  1392   123
1   257  1300
---- Validation: 
scalar performance:
{'acc': 0.54879, 'precision': 0.58584607, 'recall': 0.5430108, 'specificity': 0.5430108, 'f1': 0.4809883, 'auroc': 0.76290685, 'binary_precision': 0.63829786, 'binary_recall': 0.1904762, 'binary_specificity': 0.8955453, 'binary_f1_score': 0.29339856}
confusion matrix:
     0    1
0  583   68
1  510  120
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.57555556, 'precision': 0.659004, 'recall': 0.57555556, 'specificity': 0.57555556, 'f1': 0.51145613, 'auroc': 0.80355555, 'binary_precision': 0.7741935, 'binary_recall': 0.21333334, 'binary_specificity': 0.93777776, 'binary_f1_score': 0.33449477}
confusion matrix:
     0   1
0  211  14
1  177  48
new oracle model saved
better model found
persisted
after epoch: 13,now: 2024-07-20 15:59:49.167922,epoch time: 0:01:18.146700,used: 0:16:48.186256,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_15_43_00_seed_1_22504813
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.88216144, 'precision': 0.88468146, 'recall': 0.88270104, 'specificity': 0.88270104, 'f1': 0.8820557, 'auroc': 0.9436567, 'binary_precision': 0.91924155, 'binary_recall': 0.84125966, 'binary_specificity': 0.9241425, 'binary_f1_score': 0.8785235}
confusion matrix:
      0     1
0  1401   115
1   247  1309
---- Validation: 
scalar performance:
{'acc': 0.55581576, 'precision': 0.5934423, 'recall': 0.550256, 'specificity': 0.550256, 'f1': 0.4945449, 'auroc': 0.7678809, 'binary_precision': 0.64878047, 'binary_recall': 0.21111111, 'binary_specificity': 0.8894009, 'binary_f1_score': 0.31856287}
confusion matrix:
     0    1
0  579   72
1  497  133
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5822222, 'precision': 0.654688, 'recall': 0.5822222, 'specificity': 0.5822222, 'f1': 0.5268033, 'auroc': 0.8088889, 'binary_precision': 0.7605634, 'binary_recall': 0.24, 'binary_specificity': 0.92444444, 'binary_f1_score': 0.36486486}
confusion matrix:
     0   1
0  208  17
1  171  54
new oracle model saved
better model found
persisted
after epoch: 14,now: 2024-07-20 16:01:06.929733,epoch time: 0:01:17.761811,used: 0:18:05.948067,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_15_43_00_seed_1_22504813
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.8886719, 'precision': 0.89207095, 'recall': 0.8892288, 'specificity': 0.8892288, 'f1': 0.88851833, 'auroc': 0.94202816, 'binary_precision': 0.93162394, 'binary_recall': 0.8416988, 'binary_specificity': 0.9367589, 'binary_f1_score': 0.8843813}
confusion matrix:
      0     1
0  1422    96
1   246  1308
---- Validation: 
scalar performance:
{'acc': 0.5526932, 'precision': 0.5924972, 'recall': 0.54695344, 'specificity': 0.54695344, 'f1': 0.48647475, 'auroc': 0.77099943, 'binary_precision': 0.6492147, 'binary_recall': 0.1968254, 'binary_specificity': 0.89708143, 'binary_f1_score': 0.30207068}
confusion matrix:
     0    1
0  584   67
1  506  124
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5777778, 'precision': 0.653443, 'recall': 0.5777778, 'specificity': 0.5777778, 'f1': 0.5184075, 'auroc': 0.8114766, 'binary_precision': 0.76119405, 'binary_recall': 0.22666667, 'binary_specificity': 0.9288889, 'binary_f1_score': 0.34931508}
confusion matrix:
     0   1
0  209  16
1  174  51
early stop counter: 1
val acc:0.5526931881904602, best validation acc: 0.5558157563209534, corresponding to test acc:                         0.5822222232818604 / 0.5822222232818604
after epoch: 15,now: 2024-07-20 16:02:24.422951,epoch time: 0:01:17.493218,used: 0:19:23.441285,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_15_43_00_seed_1_22504813
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.8828125, 'precision': 0.8868647, 'recall': 0.88342214, 'specificity': 0.88342214, 'f1': 0.88260865, 'auroc': 0.9411994, 'binary_precision': 0.9294964, 'binary_recall': 0.83140284, 'binary_specificity': 0.9354414, 'binary_f1_score': 0.8777174}
confusion matrix:
      0     1
0  1420    98
1   262  1292
---- Validation: 
scalar performance:
{'acc': 0.55191255, 'precision': 0.5952619, 'recall': 0.5460318, 'specificity': 0.5460318, 'f1': 0.48186624, 'auroc': 0.773623, 'binary_precision': 0.65555555, 'binary_recall': 0.18730159, 'binary_specificity': 0.9047619, 'binary_f1_score': 0.29135802}
confusion matrix:
     0    1
0  589   62
1  512  118
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5733333, 'precision': 0.6609303, 'recall': 0.5733333, 'specificity': 0.5733333, 'f1': 0.50612766, 'auroc': 0.8153876, 'binary_precision': 0.779661, 'binary_recall': 0.20444444, 'binary_specificity': 0.94222224, 'binary_f1_score': 0.32394364}
confusion matrix:
     0   1
0  212  13
1  179  46
early stop counter: 2
val acc:0.5519125461578369, best validation acc: 0.5558157563209534, corresponding to test acc:                         0.5822222232818604 / 0.5822222232818604
after epoch: 16,now: 2024-07-20 16:03:41.323685,epoch time: 0:01:16.900734,used: 0:20:40.342019,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_15_43_00_seed_1_22504813
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.8880208, 'precision': 0.89353704, 'recall': 0.8888457, 'specificity': 0.8888457, 'f1': 0.88776034, 'auroc': 0.9432305, 'binary_precision': 0.9436723, 'binary_recall': 0.82851636, 'binary_specificity': 0.94917494, 'binary_f1_score': 0.88235295}
confusion matrix:
      0     1
0  1438    77
1   267  1290
---- Validation: 
scalar performance:
{'acc': 0.56128025, 'precision': 0.60809803, 'recall': 0.55558115, 'specificity': 0.55558115, 'f1': 0.4973005, 'auroc': 0.7780137, 'binary_precision': 0.67525774, 'binary_recall': 0.20793651, 'binary_specificity': 0.9032258, 'binary_f1_score': 0.31796116}
confusion matrix:
     0    1
0  588   63
1  499  131
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5822222, 'precision': 0.6622112, 'recall': 0.5822222, 'specificity': 0.5822222, 'f1': 0.52347696, 'auroc': 0.8198519, 'binary_precision': 0.7761194, 'binary_recall': 0.23111111, 'binary_specificity': 0.93333334, 'binary_f1_score': 0.3561644}
confusion matrix:
     0   1
0  210  15
1  173  52
better model found
persisted
after epoch: 17,now: 2024-07-20 16:04:58.731849,epoch time: 0:01:17.408164,used: 0:21:57.750183,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_15_43_00_seed_1_22504813
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.890625, 'precision': 0.89689153, 'recall': 0.89137304, 'specificity': 0.89137304, 'f1': 0.8903123, 'auroc': 0.9479811, 'binary_precision': 0.94977844, 'binary_recall': 0.8275418, 'binary_specificity': 0.9552042, 'binary_f1_score': 0.88445663}
confusion matrix:
      0     1
0  1450    68
1   268  1286
---- Validation: 
scalar performance:
{'acc': 0.56518346, 'precision': 0.6152288, 'recall': 0.5594982, 'specificity': 0.5594982, 'f1': 0.50209033, 'auroc': 0.7822788, 'binary_precision': 0.6871795, 'binary_recall': 0.21269841, 'binary_specificity': 0.906298, 'binary_f1_score': 0.32484847}
confusion matrix:
     0    1
0  590   61
1  496  134
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.58444446, 'precision': 0.664575, 'recall': 0.58444446, 'specificity': 0.58444446, 'f1': 0.5268511, 'auroc': 0.82317036, 'binary_precision': 0.7794118, 'binary_recall': 0.23555556, 'binary_specificity': 0.93333334, 'binary_f1_score': 0.36177474}
confusion matrix:
     0   1
0  210  15
1  172  53
new oracle model saved
better model found
persisted
after epoch: 18,now: 2024-07-20 16:06:15.893315,epoch time: 0:01:17.161466,used: 0:23:14.911649,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_15_43_00_seed_1_22504813
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.8958333, 'precision': 0.900627, 'recall': 0.89656174, 'specificity': 0.89656174, 'f1': 0.8956288, 'auroc': 0.952947, 'binary_precision': 0.9478261, 'binary_recall': 0.84061694, 'binary_specificity': 0.9525066, 'binary_f1_score': 0.89100814}
confusion matrix:
      0     1
0  1444    72
1   248  1308
---- Validation: 
scalar performance:
{'acc': 0.5698673, 'precision': 0.6204817, 'recall': 0.5642857, 'specificity': 0.5642857, 'f1': 0.50992703, 'auroc': 0.78428304, 'binary_precision': 0.6945813, 'binary_recall': 0.22380953, 'binary_specificity': 0.9047619, 'binary_f1_score': 0.3385354}
confusion matrix:
     0    1
0  589   62
1  489  141
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5933333, 'precision': 0.67361116, 'recall': 0.59333336, 'specificity': 0.59333336, 'f1': 0.5401779, 'auroc': 0.8267852, 'binary_precision': 0.7916667, 'binary_recall': 0.25333333, 'binary_specificity': 0.93333334, 'binary_f1_score': 0.38383836}
confusion matrix:
     0   1
0  210  15
1  168  57
new oracle model saved
better model found
persisted
after epoch: 19,now: 2024-07-20 16:07:33.514172,epoch time: 0:01:17.620857,used: 0:24:32.532506,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_15_43_00_seed_1_22504813
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.8929036, 'precision': 0.8983455, 'recall': 0.8936404, 'specificity': 0.8936404, 'f1': 0.8926511, 'auroc': 0.9496082, 'binary_precision': 0.94809943, 'binary_recall': 0.8340836, 'binary_specificity': 0.9531971, 'binary_f1_score': 0.88744444}
confusion matrix:
      0     1
0  1446    71
1   258  1297
---- Validation: 
scalar performance:
{'acc': 0.5761124, 'precision': 0.62831426, 'recall': 0.5706349, 'specificity': 0.5706349, 'f1': 0.51941293, 'auroc': 0.78736496, 'binary_precision': 0.70616114, 'binary_recall': 0.23650794, 'binary_specificity': 0.9047619, 'binary_f1_score': 0.35434008}
confusion matrix:
     0    1
0  589   62
1  481  149
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6, 'precision': 0.67272854, 'recall': 0.6, 'specificity': 0.6, 'f1': 0.55294067, 'auroc': 0.8294519, 'binary_precision': 0.7848101, 'binary_recall': 0.27555555, 'binary_specificity': 0.92444444, 'binary_f1_score': 0.40789476}
confusion matrix:
     0   1
0  208  17
1  163  62
new oracle model saved
better model found
persisted
after epoch: 20,now: 2024-07-20 16:08:51.695964,epoch time: 0:01:18.181792,used: 0:25:50.714298,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_15_43_00_seed_1_22504813
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9033203, 'precision': 0.90804213, 'recall': 0.9040022, 'specificity': 0.9040022, 'f1': 0.9031332, 'auroc': 0.9549216, 'binary_precision': 0.9551375, 'binary_recall': 0.84887457, 'binary_specificity': 0.95912987, 'binary_f1_score': 0.89887637}
confusion matrix:
      0     1
0  1455    62
1   235  1320
---- Validation: 
scalar performance:
{'acc': 0.60031223, 'precision': 0.65534645, 'recall': 0.5952381, 'specificity': 0.5952381, 'f1': 0.5549427, 'auroc': 0.79203427, 'binary_precision': 0.74380165, 'binary_recall': 0.2857143, 'binary_specificity': 0.9047619, 'binary_f1_score': 0.41284406}
confusion matrix:
     0    1
0  589   62
1  450  180
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6244444, 'precision': 0.69128, 'recall': 0.6244445, 'specificity': 0.6244445, 'f1': 0.5884985, 'auroc': 0.8334222, 'binary_precision': 0.8043478, 'binary_recall': 0.3288889, 'binary_specificity': 0.92, 'binary_f1_score': 0.46687698}
confusion matrix:
     0   1
0  207  18
1  151  74
new oracle model saved
better model found
persisted
after epoch: 21,now: 2024-07-20 16:10:09.352716,epoch time: 0:01:17.656752,used: 0:27:08.371050,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_15_43_00_seed_1_22504813
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9173177, 'precision': 0.92149705, 'recall': 0.91802335, 'specificity': 0.91802335, 'f1': 0.9171914, 'auroc': 0.9617225, 'binary_precision': 0.9670251, 'binary_recall': 0.8664098, 'binary_specificity': 0.969637, 'binary_f1_score': 0.9139567}
confusion matrix:
      0     1
0  1469    46
1   208  1349
---- Validation: 
scalar performance:
{'acc': 0.5964091, 'precision': 0.6503506, 'recall': 0.5912954, 'specificity': 0.5912954, 'f1': 0.5498441, 'auroc': 0.79352885, 'binary_precision': 0.7364017, 'binary_recall': 0.2793651, 'binary_specificity': 0.9032258, 'binary_f1_score': 0.40506333}
confusion matrix:
     0    1
0  588   63
1  454  176
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.62222224, 'precision': 0.692583, 'recall': 0.6222222, 'specificity': 0.6222222, 'f1': 0.5842482, 'auroc': 0.8345877, 'binary_precision': 0.80898875, 'binary_recall': 0.32, 'binary_specificity': 0.92444444, 'binary_f1_score': 0.4585987}
confusion matrix:
     0   1
0  208  17
1  153  72
early stop counter: 1
val acc:0.5964090824127197, best validation acc: 0.6003122329711914, corresponding to test acc:                         0.6244444251060486 / 0.6244444251060486
after epoch: 22,now: 2024-07-20 16:11:26.758645,epoch time: 0:01:17.405929,used: 0:28:25.776979,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_15_43_00_seed_1_22504813
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.89453125, 'precision': 0.90093166, 'recall': 0.89536965, 'specificity': 0.89536965, 'f1': 0.89423716, 'auroc': 0.9517194, 'binary_precision': 0.9549483, 'binary_recall': 0.83097684, 'binary_specificity': 0.9597625, 'binary_f1_score': 0.8886598}
confusion matrix:
      0     1
0  1455    61
1   263  1293
---- Validation: 
scalar performance:
{'acc': 0.5995316, 'precision': 0.6545424, 'recall': 0.59444445, 'specificity': 0.59444445, 'f1': 0.5538255, 'auroc': 0.7954917, 'binary_precision': 0.7427386, 'binary_recall': 0.284127, 'binary_specificity': 0.9047619, 'binary_f1_score': 0.41102183}
confusion matrix:
     0    1
0  589   62
1  451  179
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.62666667, 'precision': 0.69628704, 'recall': 0.62666667, 'specificity': 0.62666667, 'f1': 0.5903416, 'auroc': 0.83802474, 'binary_precision': 0.8131868, 'binary_recall': 0.3288889, 'binary_specificity': 0.92444444, 'binary_f1_score': 0.46835443}
confusion matrix:
     0   1
0  208  17
1  151  74
new oracle model saved
early stop counter: 2
val acc:0.5995315909385681, best validation acc: 0.6003122329711914, corresponding to test acc:                         0.6244444251060486 / 0.6266666650772095
after epoch: 23,now: 2024-07-20 16:12:44.170723,epoch time: 0:01:17.412078,used: 0:29:43.189057,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_15_43_00_seed_1_22504813
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9124349, 'precision': 0.91534066, 'recall': 0.9130008, 'specificity': 0.9130008, 'f1': 0.9123475, 'auroc': 0.9595374, 'binary_precision': 0.95348835, 'binary_recall': 0.8695373, 'binary_specificity': 0.95646435, 'binary_f1_score': 0.9095798}
confusion matrix:
      0     1
0  1450    66
1   203  1353
---- Validation: 
scalar performance:
{'acc': 0.5979703, 'precision': 0.6558333, 'recall': 0.59278035, 'specificity': 0.59278035, 'f1': 0.55006254, 'auroc': 0.79725945, 'binary_precision': 0.7467811, 'binary_recall': 0.2761905, 'binary_specificity': 0.9093702, 'binary_f1_score': 0.4032445}
confusion matrix:
     0    1
0  592   59
1  456  174
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.63555557, 'precision': 0.70669556, 'recall': 0.63555557, 'specificity': 0.63555557, 'f1': 0.6012449, 'auroc': 0.84179753, 'binary_precision': 0.827957, 'binary_recall': 0.3422222, 'binary_specificity': 0.9288889, 'binary_f1_score': 0.48427677}
confusion matrix:
     0   1
0  209  16
1  148  77
new oracle model saved
early stop counter: 3
val acc:0.5979703068733215, best validation acc: 0.6003122329711914, corresponding to test acc:                         0.6244444251060486 / 0.6355555653572083
after epoch: 24,now: 2024-07-20 16:14:01.675834,epoch time: 0:01:17.505111,used: 0:31:00.694168,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_15_43_00_seed_1_22504813
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.9114583, 'precision': 0.9141944, 'recall': 0.9119231, 'specificity': 0.9119231, 'f1': 0.91136813, 'auroc': 0.9638115, 'binary_precision': 0.9507389, 'binary_recall': 0.8699292, 'binary_specificity': 0.953917, 'binary_f1_score': 0.9085407}
confusion matrix:
      0     1
0  1449    70
1   202  1351
---- Validation: 
scalar performance:
{'acc': 0.61904764, 'precision': 0.6717881, 'recall': 0.6143369, 'specificity': 0.6143369, 'f1': 0.5820778, 'auroc': 0.8007535, 'binary_precision': 0.76296294, 'binary_recall': 0.32698414, 'binary_specificity': 0.9016897, 'binary_f1_score': 0.45777777}
confusion matrix:
     0    1
0  587   64
1  424  206
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6577778, 'precision': 0.7148968, 'recall': 0.6577778, 'specificity': 0.6577778, 'f1': 0.6334187, 'auroc': 0.8444642, 'binary_precision': 0.82568806, 'binary_recall': 0.4, 'binary_specificity': 0.91555554, 'binary_f1_score': 0.53892213}
confusion matrix:
     0   1
0  206  19
1  135  90
new oracle model saved
better model found
persisted
after epoch: 25,now: 2024-07-20 16:15:19.066295,epoch time: 0:01:17.390461,used: 0:32:18.084629,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_15_43_00_seed_1_22504813
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.90527344, 'precision': 0.9110933, 'recall': 0.9060671, 'specificity': 0.9060671, 'f1': 0.90504396, 'auroc': 0.9605671, 'binary_precision': 0.96336997, 'binary_recall': 0.84511566, 'binary_specificity': 0.9670185, 'binary_f1_score': 0.90037656}
confusion matrix:
      0     1
0  1466    50
1   241  1315
---- Validation: 
scalar performance:
{'acc': 0.62217015, 'precision': 0.6746714, 'recall': 0.6175115, 'specificity': 0.6175115, 'f1': 0.58634186, 'auroc': 0.8046473, 'binary_precision': 0.76642334, 'binary_recall': 0.33333334, 'binary_specificity': 0.9016897, 'binary_f1_score': 0.46460176}
confusion matrix:
     0    1
0  587   64
1  420  210
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6666667, 'precision': 0.7242286, 'recall': 0.6666667, 'specificity': 0.6666667, 'f1': 0.64380705, 'auroc': 0.84847414, 'binary_precision': 0.8378378, 'binary_recall': 0.41333333, 'binary_specificity': 0.92, 'binary_f1_score': 0.55357146}
confusion matrix:
     0   1
0  207  18
1  132  93
new oracle model saved
better model found
persisted
after epoch: 26,now: 2024-07-20 16:16:36.416019,epoch time: 0:01:17.349724,used: 0:33:35.434353,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_15_43_00_seed_1_22504813
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.9091797, 'precision': 0.9135035, 'recall': 0.9098303, 'specificity': 0.9098303, 'f1': 0.90902424, 'auroc': 0.9586835, 'binary_precision': 0.9589928, 'binary_recall': 0.8572347, 'binary_specificity': 0.9624258, 'binary_f1_score': 0.9052632}
confusion matrix:
      0     1
0  1460    57
1   222  1333
---- Validation: 
scalar performance:
{'acc': 0.62763464, 'precision': 0.6805099, 'recall': 0.62304145, 'specificity': 0.62304145, 'f1': 0.59334064, 'auroc': 0.8076732, 'binary_precision': 0.7741935, 'binary_recall': 0.34285715, 'binary_specificity': 0.9032258, 'binary_f1_score': 0.47524753}
confusion matrix:
     0    1
0  588   63
1  414  216
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6755555, 'precision': 0.73338413, 'recall': 0.6755556, 'specificity': 0.6755556, 'f1': 0.65413046, 'auroc': 0.85224694, 'binary_precision': 0.8495575, 'binary_recall': 0.42666668, 'binary_specificity': 0.92444444, 'binary_f1_score': 0.56804734}
confusion matrix:
     0   1
0  208  17
1  129  96
new oracle model saved
better model found
persisted
after epoch: 27,now: 2024-07-20 16:17:54.341600,epoch time: 0:01:17.925581,used: 0:34:53.359934,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_15_43_00_seed_1_22504813
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.9091797, 'precision': 0.91451156, 'recall': 0.9099773, 'specificity': 0.9099773, 'f1': 0.90898794, 'auroc': 0.9608577, 'binary_precision': 0.9650655, 'binary_recall': 0.8516378, 'binary_specificity': 0.96831685, 'binary_f1_score': 0.9048106}
confusion matrix:
      0     1
0  1467    48
1   231  1326
---- Validation: 
scalar performance:
{'acc': 0.61904764, 'precision': 0.6736064, 'recall': 0.6142857, 'specificity': 0.6142857, 'f1': 0.58122, 'auroc': 0.8093702, 'binary_precision': 0.7669173, 'binary_recall': 0.32380953, 'binary_specificity': 0.9047619, 'binary_f1_score': 0.45535713}
confusion matrix:
     0    1
0  589   62
1  426  204
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6666667, 'precision': 0.72989833, 'recall': 0.6666667, 'specificity': 0.6666667, 'f1': 0.6420542, 'auroc': 0.8526025, 'binary_precision': 0.85046726, 'binary_recall': 0.40444446, 'binary_specificity': 0.9288889, 'binary_f1_score': 0.5481928}
confusion matrix:
     0   1
0  209  16
1  134  91
early stop counter: 1
val acc:0.6190476417541504, best validation acc: 0.6276346445083618, corresponding to test acc:                         0.6755555272102356 / 0.6755555272102356
after epoch: 28,now: 2024-07-20 16:19:11.995913,epoch time: 0:01:17.654313,used: 0:36:11.014247,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_15_43_00_seed_1_22504813
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.91829425, 'precision': 0.9229317, 'recall': 0.91896236, 'specificity': 0.91896236, 'f1': 0.9181454, 'auroc': 0.9673073, 'binary_precision': 0.97041845, 'binary_recall': 0.8649518, 'binary_specificity': 0.972973, 'binary_f1_score': 0.91465485}
confusion matrix:
      0     1
0  1476    41
1   210  1345
---- Validation: 
scalar performance:
{'acc': 0.63153785, 'precision': 0.68396914, 'recall': 0.62700975, 'specificity': 0.62700975, 'f1': 0.59859043, 'auroc': 0.8112793, 'binary_precision': 0.77816904, 'binary_recall': 0.35079366, 'binary_specificity': 0.9032258, 'binary_f1_score': 0.4835886}
confusion matrix:
     0    1
0  588   63
1  409  221
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.68666667, 'precision': 0.74390876, 'recall': 0.68666667, 'specificity': 0.68666667, 'f1': 0.667137, 'auroc': 0.85360986, 'binary_precision': 0.86206895, 'binary_recall': 0.44444445, 'binary_specificity': 0.9288889, 'binary_f1_score': 0.58651024}
confusion matrix:
     0    1
0  209   16
1  125  100
new oracle model saved
better model found
persisted
after epoch: 29,now: 2024-07-20 16:20:29.530727,epoch time: 0:01:17.534814,used: 0:37:28.549061,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_15_43_00_seed_1_22504813
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.913737, 'precision': 0.9190507, 'recall': 0.9144527, 'specificity': 0.9144527, 'f1': 0.91354966, 'auroc': 0.96646667, 'binary_precision': 0.9694323, 'binary_recall': 0.85659164, 'binary_specificity': 0.97231376, 'binary_f1_score': 0.90952545}
confusion matrix:
      0     1
0  1475    42
1   223  1332
---- Validation: 
scalar performance:
{'acc': 0.6338798, 'precision': 0.6869108, 'recall': 0.6293651, 'specificity': 0.6293651, 'f1': 0.60133576, 'auroc': 0.8136103, 'binary_precision': 0.78245616, 'binary_recall': 0.35396826, 'binary_specificity': 0.9047619, 'binary_f1_score': 0.48743168}
confusion matrix:
     0    1
0  589   62
1  407  223
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6844444, 'precision': 0.73966277, 'recall': 0.6844444, 'specificity': 0.6844444, 'f1': 0.6651575, 'auroc': 0.8566321, 'binary_precision': 0.85470086, 'binary_recall': 0.44444445, 'binary_specificity': 0.92444444, 'binary_f1_score': 0.5847953}
confusion matrix:
     0    1
0  208   17
1  125  100
better model found
persisted
after epoch: 30,now: 2024-07-20 16:21:47.542150,epoch time: 0:01:18.011423,used: 0:38:46.560484,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_15_43_00_seed_1_22504813
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 0:38:46.560484 at 2024-07-20 16:21:47.542150
persisted model performance metric: 

scalar performance:
{'acc': 0.6844444, 'precision': 0.73966277, 'recall': 0.6844444, 'specificity': 0.6844444, 'f1': 0.6651575, 'auroc': 0.8566321, 'binary_precision': 0.85470086, 'binary_recall': 0.44444445, 'binary_specificity': 0.92444444, 'binary_f1_score': 0.5847953}
confusion matrix:
     0    1
0  208   17
1  125  100
oracle model performance metric: 

scalar performance:
{'acc': 0.68666667, 'precision': 0.74390876, 'recall': 0.68666667, 'specificity': 0.68666667, 'f1': 0.667137, 'auroc': 0.85360986, 'binary_precision': 0.86206895, 'binary_recall': 0.44444445, 'binary_specificity': 0.9288889, 'binary_f1_score': 0.58651024}
confusion matrix:
     0    1
0  209   16
1  125  100
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_halffreezeblocks_2024-07-20_12-47-21/rule_results/3.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_halffreezeblocks_2024-07-20_12-47-21/confusion_matrix/3.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 195613 KiB |   7828 MiB | 124075 GiB | 124075 GiB |
|       from large pool | 179211 KiB |   7805 MiB | 122423 GiB | 122423 GiB |
|       from small pool |  16402 KiB |     36 MiB |   1652 GiB |   1652 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 195613 KiB |   7828 MiB | 124075 GiB | 124075 GiB |
|       from large pool | 179211 KiB |   7805 MiB | 122423 GiB | 122423 GiB |
|       from small pool |  16402 KiB |     36 MiB |   1652 GiB |   1652 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 195189 KiB |   7827 MiB | 124060 GiB | 124060 GiB |
|       from large pool | 178979 KiB |   7804 MiB | 122412 GiB | 122411 GiB |
|       from small pool |  16210 KiB |     36 MiB |   1648 GiB |   1648 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   8516 MiB |   8524 MiB |  16792 MiB |   8276 MiB |
|       from large pool |   8472 MiB |   8486 MiB |  16732 MiB |   8260 MiB |
|       from small pool |     44 MiB |     44 MiB |     60 MiB |     16 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  37859 KiB | 732464 KiB |  67125 GiB |  67125 GiB |
|       from large pool |  31733 KiB | 730714 KiB |  65468 GiB |  65468 GiB |
|       from small pool |   6126 KiB |  19386 KiB |   1657 GiB |   1657 GiB |
|---------------------------------------------------------------------------|
| Allocations           |     800    |    1679    |   20970 K  |   20969 K  |
|       from large pool |      79    |     762    |   11399 K  |   11399 K  |
|       from small pool |     721    |    1017    |    9571 K  |    9570 K  |
|---------------------------------------------------------------------------|
| Active allocs         |     800    |    1679    |   20970 K  |   20969 K  |
|       from large pool |      79    |     762    |   11399 K  |   11399 K  |
|       from small pool |     721    |    1017    |    9571 K  |    9570 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     370    |     370    |     716    |     346    |
|       from large pool |     348    |     349    |     686    |     338    |
|       from small pool |      22    |      22    |      30    |       8    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      45    |     383    |   12576 K  |   12576 K  |
|       from large pool |      11    |     351    |    8265 K  |    8265 K  |
|       from small pool |      34    |     215    |    4310 K  |    4310 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   7828 MiB | 124075 GiB | 124075 GiB |
|       from large pool |  16640 KiB |   7805 MiB | 122423 GiB | 122423 GiB |
|       from small pool |      0 KiB |     36 MiB |   1652 GiB |   1652 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   7828 MiB | 124075 GiB | 124075 GiB |
|       from large pool |  16640 KiB |   7805 MiB | 122423 GiB | 122423 GiB |
|       from small pool |      0 KiB |     36 MiB |   1652 GiB |   1652 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   7827 MiB | 124060 GiB | 124060 GiB |
|       from large pool |  16640 KiB |   7804 MiB | 122412 GiB | 122411 GiB |
|       from small pool |      0 KiB |     36 MiB |   1648 GiB |   1648 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 233472 KiB |   8524 MiB |  16792 MiB |  16564 MiB |
|       from large pool | 210944 KiB |   8486 MiB |  16732 MiB |  16526 MiB |
|       from small pool |  22528 KiB |     44 MiB |     60 MiB |     38 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  30464 KiB | 732464 KiB |  67125 GiB |  67125 GiB |
|       from large pool |  30464 KiB | 730714 KiB |  65468 GiB |  65468 GiB |
|       from small pool |      0 KiB |  20265 KiB |   1657 GiB |   1657 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    1679    |   20970 K  |   20970 K  |
|       from large pool |       2    |     762    |   11399 K  |   11399 K  |
|       from small pool |       0    |    1017    |    9571 K  |    9571 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    1679    |   20970 K  |   20970 K  |
|       from large pool |       2    |     762    |   11399 K  |   11399 K  |
|       from small pool |       0    |    1017    |    9571 K  |    9571 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      21    |     370    |     716    |     695    |
|       from large pool |      10    |     349    |     686    |     676    |
|       from small pool |      11    |      22    |      30    |      19    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     383    |   12576 K  |   12576 K  |
|       from large pool |       3    |     351    |    8265 K  |    8265 K  |
|       from small pool |       0    |     215    |    4310 K  |    4310 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   7828 MiB | 124075 GiB | 124075 GiB |
|       from large pool |  16640 KiB |   7805 MiB | 122423 GiB | 122423 GiB |
|       from small pool |      0 KiB |     36 MiB |   1652 GiB |   1652 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   7828 MiB | 124075 GiB | 124075 GiB |
|       from large pool |  16640 KiB |   7805 MiB | 122423 GiB | 122423 GiB |
|       from small pool |      0 KiB |     36 MiB |   1652 GiB |   1652 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   7827 MiB | 124060 GiB | 124060 GiB |
|       from large pool |  16640 KiB |   7804 MiB | 122412 GiB | 122411 GiB |
|       from small pool |      0 KiB |     36 MiB |   1648 GiB |   1648 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 233472 KiB |   8524 MiB |  16792 MiB |  16564 MiB |
|       from large pool | 210944 KiB |   8486 MiB |  16732 MiB |  16526 MiB |
|       from small pool |  22528 KiB |     44 MiB |     60 MiB |     38 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  30464 KiB | 732464 KiB |  67125 GiB |  67125 GiB |
|       from large pool |  30464 KiB | 730714 KiB |  65468 GiB |  65468 GiB |
|       from small pool |      0 KiB |  20265 KiB |   1657 GiB |   1657 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    1679    |   20970 K  |   20970 K  |
|       from large pool |       2    |     762    |   11399 K  |   11399 K  |
|       from small pool |       0    |    1017    |    9571 K  |    9571 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    1679    |   20970 K  |   20970 K  |
|       from large pool |       2    |     762    |   11399 K  |   11399 K  |
|       from small pool |       0    |    1017    |    9571 K  |    9571 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      21    |     370    |     716    |     695    |
|       from large pool |      10    |     349    |     686    |     676    |
|       from small pool |      11    |      22    |      30    |      19    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     383    |   12576 K  |   12576 K  |
|       from large pool |       3    |     351    |    8265 K  |    8265 K  |
|       from small pool |       0    |     215    |    4310 K  |    4310 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'888c1ef2'
model name: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_16_23_01_seed_2_22504813

 Experiment start at: 2024-07-20 16:23:01.616090
before training, model accuracy: 0.41203704476356506
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.5804974, 'precision': 0.59650457, 'recall': 0.5820238, 'specificity': 0.5820238, 'f1': 0.5648221, 'auroc': 0.63847274, 'binary_precision': 0.63782054, 'binary_recall': 0.38766235, 'binary_specificity': 0.77638525, 'binary_f1_score': 0.4822294}
confusion matrix:
      0    1
0  1177  339
1   943  597
---- Validation: 
scalar performance:
{'acc': 0.6486698, 'precision': 0.6561853, 'recall': 0.6452337, 'specificity': 0.6452337, 'f1': 0.6409831, 'auroc': 0.67276835, 'binary_precision': 0.68443495, 'binary_recall': 0.51607716, 'binary_specificity': 0.7743902, 'binary_f1_score': 0.5884509}
confusion matrix:
     0    1
0  508  148
1  301  321
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.3773148, 'precision': 0.3614949, 'recall': 0.3773148, 'specificity': 0.3773148, 'f1': 0.35901153, 'auroc': 0.3123071, 'binary_precision': 0.3146853, 'binary_recall': 0.20833333, 'binary_specificity': 0.5462963, 'binary_f1_score': 0.25069636}
confusion matrix:
     0   1
0  118  98
1  171  45
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-20 16:24:20.790507,epoch time: 0:01:19.174417,used: 0:01:19.174417,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_16_23_01_seed_2_22504813
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.6623037, 'precision': 0.66295594, 'recall': 0.6625193, 'specificity': 0.6625193, 'f1': 0.6621364, 'auroc': 0.7200289, 'binary_precision': 0.6754144, 'binary_recall': 0.63506496, 'binary_specificity': 0.6899736, 'binary_f1_score': 0.65461844}
confusion matrix:
      0    1
0  1046  470
1   562  978
---- Validation: 
scalar performance:
{'acc': 0.6643193, 'precision': 0.66412973, 'recall': 0.66360235, 'specificity': 0.66360235, 'f1': 0.66365016, 'auroc': 0.6955655, 'binary_precision': 0.6611018, 'binary_recall': 0.6366559, 'binary_specificity': 0.6905488, 'binary_f1_score': 0.6486486}
confusion matrix:
     0    1
0  453  203
1  226  396
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.4212963, 'precision': 0.4212693, 'recall': 0.4212963, 'specificity': 0.4212963, 'f1': 0.42124668, 'auroc': 0.34790808, 'binary_precision': 0.4227273, 'binary_recall': 0.43055555, 'binary_specificity': 0.41203704, 'binary_f1_score': 0.42660552}
confusion matrix:
     0    1
0   89  127
1  123   93
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-07-20 16:25:36.856389,epoch time: 0:01:16.065882,used: 0:02:35.240299,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_16_23_01_seed_2_22504813
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.7097513, 'precision': 0.7097737, 'recall': 0.70978224, 'specificity': 0.70978224, 'f1': 0.70975053, 'auroc': 0.77150524, 'binary_precision': 0.7146614, 'binary_recall': 0.70584416, 'binary_specificity': 0.7137203, 'binary_f1_score': 0.71022546}
confusion matrix:
      0     1
0  1082   434
1   453  1087
---- Validation: 
scalar performance:
{'acc': 0.6737089, 'precision': 0.6742668, 'recall': 0.6724154, 'specificity': 0.6724154, 'f1': 0.6722591, 'auroc': 0.70830226, 'binary_precision': 0.67950964, 'binary_recall': 0.6237942, 'binary_specificity': 0.7210366, 'binary_f1_score': 0.650461}
confusion matrix:
     0    1
0  473  183
1  234  388
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.4675926, 'precision': 0.46749225, 'recall': 0.4675926, 'specificity': 0.4675926, 'f1': 0.46718144, 'auroc': 0.3835734, 'binary_precision': 0.46568626, 'binary_recall': 0.4398148, 'binary_specificity': 0.49537036, 'binary_f1_score': 0.45238096}
confusion matrix:
     0    1
0  107  109
1  121   95
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-07-20 16:26:52.591210,epoch time: 0:01:15.734821,used: 0:03:50.975120,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_16_23_01_seed_2_22504813
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.7447644, 'precision': 0.74627227, 'recall': 0.74505705, 'specificity': 0.74505705, 'f1': 0.7445123, 'auroc': 0.82119024, 'binary_precision': 0.76760566, 'binary_recall': 0.7077922, 'binary_specificity': 0.7823219, 'binary_f1_score': 0.73648655}
confusion matrix:
      0     1
0  1186   330
1   450  1090
---- Validation: 
scalar performance:
{'acc': 0.6776213, 'precision': 0.681983, 'recall': 0.6751431, 'specificity': 0.6751431, 'f1': 0.67359155, 'auroc': 0.71679914, 'binary_precision': 0.70428014, 'binary_recall': 0.5819936, 'binary_specificity': 0.76829267, 'binary_f1_score': 0.6373239}
confusion matrix:
     0    1
0  504  152
1  260  362
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.4513889, 'precision': 0.44975075, 'recall': 0.4513889, 'specificity': 0.4513889, 'f1': 0.44688094, 'auroc': 0.41722393, 'binary_precision': 0.44067797, 'binary_recall': 0.3611111, 'binary_specificity': 0.5416667, 'binary_f1_score': 0.39694655}
confusion matrix:
     0   1
0  117  99
1  138  78
better model found
persisted
after epoch: 4,now: 2024-07-20 16:28:08.335538,epoch time: 0:01:15.744328,used: 0:05:06.719448,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_16_23_01_seed_2_22504813
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.7709424, 'precision': 0.7723144, 'recall': 0.77121097, 'specificity': 0.77121097, 'f1': 0.7707609, 'auroc': 0.85702294, 'binary_precision': 0.7937063, 'binary_recall': 0.737013, 'binary_specificity': 0.80540895, 'binary_f1_score': 0.76430976}
confusion matrix:
      0     1
0  1221   295
1   405  1135
---- Validation: 
scalar performance:
{'acc': 0.6830986, 'precision': 0.69047177, 'recall': 0.68010354, 'specificity': 0.68010354, 'f1': 0.67759335, 'auroc': 0.72349966, 'binary_precision': 0.7218814, 'binary_recall': 0.56752414, 'binary_specificity': 0.79268295, 'binary_f1_score': 0.63546354}
confusion matrix:
     0    1
0  520  136
1  269  353
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.4652778, 'precision': 0.46305335, 'recall': 0.4652778, 'specificity': 0.4652778, 'f1': 0.45710635, 'auroc': 0.44918126, 'binary_precision': 0.45398772, 'binary_recall': 0.3425926, 'binary_specificity': 0.587963, 'binary_f1_score': 0.39050132}
confusion matrix:
     0   1
0  127  89
1  142  74
better model found
persisted
after epoch: 5,now: 2024-07-20 16:29:24.053342,epoch time: 0:01:15.717804,used: 0:06:22.437252,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_16_23_01_seed_2_22504813
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.8151178, 'precision': 0.81756425, 'recall': 0.8154585, 'specificity': 0.8154585, 'f1': 0.81486464, 'auroc': 0.88750863, 'binary_precision': 0.8474697, 'binary_recall': 0.7720779, 'binary_specificity': 0.85883904, 'binary_f1_score': 0.808019}
confusion matrix:
      0     1
0  1302   214
1   351  1189
---- Validation: 
scalar performance:
{'acc': 0.6823161, 'precision': 0.69316065, 'recall': 0.6787997, 'specificity': 0.6787997, 'f1': 0.6749803, 'auroc': 0.728411, 'binary_precision': 0.73275864, 'binary_recall': 0.54662377, 'binary_specificity': 0.8109756, 'binary_f1_score': 0.62615097}
confusion matrix:
     0    1
0  532  124
1  282  340
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.4675926, 'precision': 0.46447366, 'recall': 0.4675926, 'specificity': 0.4675926, 'f1': 0.45564514, 'auroc': 0.47545868, 'binary_precision': 0.45394737, 'binary_recall': 0.31944445, 'binary_specificity': 0.6157407, 'binary_f1_score': 0.37499997}
confusion matrix:
     0   1
0  133  83
1  147  69
early stop counter: 1
val acc:0.6823161244392395, best validation acc: 0.6830986142158508, corresponding to test acc:                         0.4652777910232544 / 0.46759259700775146
after epoch: 6,now: 2024-07-20 16:30:39.634851,epoch time: 0:01:15.581509,used: 0:07:38.018761,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_16_23_01_seed_2_22504813
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.8246073, 'precision': 0.82665014, 'recall': 0.8249152, 'specificity': 0.8249152, 'f1': 0.8244194, 'auroc': 0.9028989, 'binary_precision': 0.8545198, 'binary_recall': 0.78571427, 'binary_specificity': 0.8641161, 'binary_f1_score': 0.81867397}
confusion matrix:
      0     1
0  1310   206
1   330  1210
---- Validation: 
scalar performance:
{'acc': 0.68075114, 'precision': 0.69411844, 'recall': 0.6769003, 'specificity': 0.6769003, 'f1': 0.67206454, 'auroc': 0.73323417, 'binary_precision': 0.73883927, 'binary_recall': 0.5321543, 'binary_specificity': 0.82164633, 'binary_f1_score': 0.61869156}
confusion matrix:
     0    1
0  539  117
1  291  331
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.4837963, 'precision': 0.48195487, 'recall': 0.4837963, 'specificity': 0.4837963, 'f1': 0.47028255, 'auroc': 0.49817815, 'binary_precision': 0.47619048, 'binary_recall': 0.32407406, 'binary_specificity': 0.6435185, 'binary_f1_score': 0.38567492}
confusion matrix:
     0   1
0  139  77
1  146  70
new oracle model saved
early stop counter: 2
val acc:0.6807511448860168, best validation acc: 0.6830986142158508, corresponding to test acc:                         0.4652777910232544 / 0.48379629850387573
after epoch: 7,now: 2024-07-20 16:31:55.196339,epoch time: 0:01:15.561488,used: 0:08:53.580249,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_16_23_01_seed_2_22504813
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.8475131, 'precision': 0.8483778, 'recall': 0.8477093, 'specificity': 0.8477093, 'f1': 0.8474618, 'auroc': 0.9161729, 'binary_precision': 0.8678082, 'binary_recall': 0.82272726, 'binary_specificity': 0.8726913, 'binary_f1_score': 0.8446666}
confusion matrix:
      0     1
0  1323   193
1   273  1267
---- Validation: 
scalar performance:
{'acc': 0.67840374, 'precision': 0.69676715, 'recall': 0.6739888, 'specificity': 0.6739888, 'f1': 0.6671493, 'auroc': 0.73531246, 'binary_precision': 0.75059384, 'binary_recall': 0.5080386, 'binary_specificity': 0.839939, 'binary_f1_score': 0.6059444}
confusion matrix:
     0    1
0  551  105
1  306  316
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.49305555, 'precision': 0.4919192, 'recall': 0.49305558, 'specificity': 0.49305558, 'f1': 0.4745839, 'auroc': 0.5133959, 'binary_precision': 0.4888889, 'binary_recall': 0.30555555, 'binary_specificity': 0.6805556, 'binary_f1_score': 0.37606835}
confusion matrix:
     0   1
0  147  69
1  150  66
new oracle model saved
early stop counter: 3
val acc:0.6784037351608276, best validation acc: 0.6830986142158508, corresponding to test acc:                         0.4652777910232544 / 0.4930555522441864
after epoch: 8,now: 2024-07-20 16:33:11.007824,epoch time: 0:01:15.811485,used: 0:10:09.391734,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_16_23_01_seed_2_22504813
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.85438484, 'precision': 0.8587818, 'recall': 0.8548205, 'specificity': 0.8548205, 'f1': 0.8540379, 'auroc': 0.92646015, 'binary_precision': 0.9005121, 'binary_recall': 0.7993507, 'binary_specificity': 0.91029024, 'binary_f1_score': 0.8469213}
confusion matrix:
      0     1
0  1380   136
1   309  1231
---- Validation: 
scalar performance:
{'acc': 0.6658842, 'precision': 0.6956768, 'recall': 0.6603355, 'specificity': 0.6603355, 'f1': 0.64787775, 'auroc': 0.73671675, 'binary_precision': 0.76566756, 'binary_recall': 0.4517685, 'binary_specificity': 0.86890244, 'binary_f1_score': 0.5682507}
confusion matrix:
     0    1
0  570   86
1  341  281
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.49074075, 'precision': 0.48794645, 'recall': 0.49074075, 'specificity': 0.49074075, 'f1': 0.45941025, 'auroc': 0.52739197, 'binary_precision': 0.48214287, 'binary_recall': 0.25, 'binary_specificity': 0.7314815, 'binary_f1_score': 0.3292683}
confusion matrix:
     0   1
0  158  58
1  162  54
early stop counter: 4
val acc:0.6658841967582703, best validation acc: 0.6830986142158508, corresponding to test acc:                         0.4652777910232544 / 0.4930555522441864
after epoch: 9,now: 2024-07-20 16:34:26.693142,epoch time: 0:01:15.685318,used: 0:11:25.077052,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_16_23_01_seed_2_22504813
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.8632199, 'precision': 0.8647787, 'recall': 0.8634788, 'specificity': 0.8634788, 'f1': 0.8631261, 'auroc': 0.9353994, 'binary_precision': 0.8906685, 'binary_recall': 0.8305195, 'binary_specificity': 0.896438, 'binary_f1_score': 0.85954297}
confusion matrix:
      0     1
0  1359   157
1   261  1279
---- Validation: 
scalar performance:
{'acc': 0.6666667, 'precision': 0.69813204, 'recall': 0.6610143, 'specificity': 0.6610143, 'f1': 0.6480404, 'auroc': 0.73980963, 'binary_precision': 0.7707182, 'binary_recall': 0.44855306, 'binary_specificity': 0.8734756, 'binary_f1_score': 0.56707317}
confusion matrix:
     0    1
0  573   83
1  343  279
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.4976852, 'precision': 0.4970039, 'recall': 0.4976852, 'specificity': 0.4976852, 'f1': 0.467409, 'auroc': 0.5450532, 'binary_precision': 0.49557522, 'binary_recall': 0.25925925, 'binary_specificity': 0.7361111, 'binary_f1_score': 0.34042552}
confusion matrix:
     0   1
0  159  57
1  160  56
new oracle model saved
early stop counter: 5
val acc:0.6666666865348816, best validation acc: 0.6830986142158508, corresponding to test acc:                         0.4652777910232544 / 0.49768519401550293
after epoch: 10,now: 2024-07-20 16:35:42.432518,epoch time: 0:01:15.739376,used: 0:12:40.816428,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_16_23_01_seed_2_22504813
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.8753272, 'precision': 0.8774531, 'recall': 0.8756254, 'specificity': 0.8756254, 'f1': 0.8752066, 'auroc': 0.9402362, 'binary_precision': 0.9078114, 'binary_recall': 0.83766234, 'binary_specificity': 0.9135884, 'binary_f1_score': 0.8713272}
confusion matrix:
      0     1
0  1385   131
1   250  1290
---- Validation: 
scalar performance:
{'acc': 0.6580595, 'precision': 0.69473743, 'recall': 0.65192187, 'specificity': 0.65192187, 'f1': 0.63564205, 'auroc': 0.73965275, 'binary_precision': 0.77286136, 'binary_recall': 0.42122185, 'binary_specificity': 0.88262194, 'binary_f1_score': 0.5452653}
confusion matrix:
     0    1
0  579   77
1  360  262
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5138889, 'precision': 0.51899624, 'recall': 0.5138889, 'specificity': 0.5138889, 'f1': 0.47886026, 'auroc': 0.5539051, 'binary_precision': 0.52884614, 'binary_recall': 0.25462964, 'binary_specificity': 0.7731481, 'binary_f1_score': 0.34375}
confusion matrix:
     0   1
0  167  49
1  161  55
new oracle model saved
early stop counter: 6
val acc:0.6580594778060913, best validation acc: 0.6830986142158508, corresponding to test acc:                         0.4652777910232544 / 0.5138888955116272
after epoch: 11,now: 2024-07-20 16:36:58.117140,epoch time: 0:01:15.684622,used: 0:13:56.501050,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_16_23_01_seed_2_22504813
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.8700916, 'precision': 0.8733529, 'recall': 0.87046134, 'specificity': 0.87046134, 'f1': 0.8698808, 'auroc': 0.9373865, 'binary_precision': 0.9102656, 'binary_recall': 0.8233766, 'binary_specificity': 0.91754615, 'binary_f1_score': 0.8646437}
confusion matrix:
      0     1
0  1391   125
1   272  1268
---- Validation: 
scalar performance:
{'acc': 0.6541471, 'precision': 0.6972386, 'recall': 0.6475693, 'specificity': 0.6475693, 'f1': 0.62813616, 'auroc': 0.7418095, 'binary_precision': 0.7830189, 'binary_recall': 0.40032154, 'binary_specificity': 0.89481705, 'binary_f1_score': 0.52978724}
confusion matrix:
     0    1
0  587   69
1  373  249
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5162037, 'precision': 0.5236139, 'recall': 0.5162037, 'specificity': 0.5162037, 'f1': 0.4750179, 'auroc': 0.56295013, 'binary_precision': 0.5368421, 'binary_recall': 0.2361111, 'binary_specificity': 0.7962963, 'binary_f1_score': 0.3279743}
confusion matrix:
     0   1
0  172  44
1  165  51
new oracle model saved
early stop counter: 7
val acc:0.6541470885276794, best validation acc: 0.6830986142158508, corresponding to test acc:                         0.4652777910232544 / 0.5162037014961243
after epoch: 12,now: 2024-07-20 16:38:14.011803,epoch time: 0:01:15.894663,used: 0:15:12.395713,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_16_23_01_seed_2_22504813
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.8792539, 'precision': 0.8818759, 'recall': 0.8795831, 'specificity': 0.8795831, 'f1': 0.87910575, 'auroc': 0.9411807, 'binary_precision': 0.91554296, 'binary_recall': 0.83766234, 'binary_specificity': 0.92150396, 'binary_f1_score': 0.87487286}
confusion matrix:
      0     1
0  1397   119
1   250  1290
---- Validation: 
scalar performance:
{'acc': 0.6510172, 'precision': 0.6953734, 'recall': 0.6443122, 'specificity': 0.6443122, 'f1': 0.62375736, 'auroc': 0.74519646, 'binary_precision': 0.78205127, 'binary_recall': 0.39228296, 'binary_specificity': 0.89634144, 'binary_f1_score': 0.5224839}
confusion matrix:
     0    1
0  588   68
1  378  244
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5231481, 'precision': 0.5329952, 'recall': 0.5231482, 'specificity': 0.5231482, 'f1': 0.48470175, 'auroc': 0.57726765, 'binary_precision': 0.5510204, 'binary_recall': 0.25, 'binary_specificity': 0.7962963, 'binary_f1_score': 0.34394905}
confusion matrix:
     0   1
0  172  44
1  162  54
new oracle model saved
early stop counter: 8
val acc:0.6510171890258789, best validation acc: 0.6830986142158508, corresponding to test acc:                         0.4652777910232544 / 0.5231481194496155
after epoch: 13,now: 2024-07-20 16:39:30.712009,epoch time: 0:01:16.700206,used: 0:16:29.095919,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_16_23_01_seed_2_22504813
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.891034, 'precision': 0.89485985, 'recall': 0.89142567, 'specificity': 0.89142567, 'f1': 0.89083344, 'auroc': 0.95162725, 'binary_precision': 0.93574005, 'binary_recall': 0.84155846, 'binary_specificity': 0.9412929, 'binary_f1_score': 0.8861539}
confusion matrix:
      0     1
0  1427    89
1   244  1296
---- Validation: 
scalar performance:
{'acc': 0.64319247, 'precision': 0.6955081, 'recall': 0.6359403, 'specificity': 0.6359403, 'f1': 0.61054915, 'auroc': 0.74709827, 'binary_precision': 0.7902098, 'binary_recall': 0.36334404, 'binary_specificity': 0.9085366, 'binary_f1_score': 0.49779734}
confusion matrix:
     0    1
0  596   60
1  396  226
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5115741, 'precision': 0.51830816, 'recall': 0.5115741, 'specificity': 0.5115741, 'f1': 0.46211267, 'auroc': 0.58395493, 'binary_precision': 0.5294118, 'binary_recall': 0.20833333, 'binary_specificity': 0.8148148, 'binary_f1_score': 0.29900333}
confusion matrix:
     0   1
0  176  40
1  171  45
early stop counter: 9
val acc:0.6431924700737, best validation acc: 0.6830986142158508, corresponding to test acc:                         0.4652777910232544 / 0.5231481194496155
after epoch: 14,now: 2024-07-20 16:40:46.403936,epoch time: 0:01:15.691927,used: 0:17:44.787846,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_16_23_01_seed_2_22504813
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.8923429, 'precision': 0.8968246, 'recall': 0.8927655, 'specificity': 0.8927655, 'f1': 0.8921067, 'auroc': 0.9471383, 'binary_precision': 0.9410051, 'binary_recall': 0.83896106, 'binary_specificity': 0.9465699, 'binary_f1_score': 0.8870581}
confusion matrix:
      0     1
0  1435    81
1   248  1292
---- Validation: 
scalar performance:
{'acc': 0.64162755, 'precision': 0.6979519, 'recall': 0.63416594, 'specificity': 0.63416594, 'f1': 0.60687065, 'auroc': 0.75002694, 'binary_precision': 0.79710144, 'binary_recall': 0.35369775, 'binary_specificity': 0.91463417, 'binary_f1_score': 0.48997772}
confusion matrix:
     0    1
0  600   56
1  402  220
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5115741, 'precision': 0.51864195, 'recall': 0.51157403, 'specificity': 0.51157403, 'f1': 0.46043155, 'auroc': 0.59443593, 'binary_precision': 0.5301205, 'binary_recall': 0.2037037, 'binary_specificity': 0.8194444, 'binary_f1_score': 0.29431438}
confusion matrix:
     0   1
0  177  39
1  172  44
early stop counter: 10
val acc:0.6416275501251221, best validation acc: 0.6830986142158508, corresponding to test acc:                         0.4652777910232544 / 0.5231481194496155
after epoch: 15,now: 2024-07-20 16:42:02.690520,epoch time: 0:01:16.286584,used: 0:19:01.074430,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_16_23_01_seed_2_22504813
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.8802356, 'precision': 0.8841177, 'recall': 0.88063425, 'specificity': 0.88063425, 'f1': 0.8800049, 'auroc': 0.94525826, 'binary_precision': 0.92474675, 'binary_recall': 0.8298701, 'binary_specificity': 0.9313984, 'binary_f1_score': 0.87474334}
confusion matrix:
      0     1
0  1412   104
1   262  1278
---- Validation: 
scalar performance:
{'acc': 0.6400626, 'precision': 0.696615, 'recall': 0.6325582, 'specificity': 0.6325582, 'f1': 0.6047493, 'auroc': 0.75117147, 'binary_precision': 0.79562044, 'binary_recall': 0.3504823, 'binary_specificity': 0.91463417, 'binary_f1_score': 0.4866071}
confusion matrix:
     0    1
0  600   56
1  404  218
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5208333, 'precision': 0.5335554, 'recall': 0.5208333, 'specificity': 0.5208333, 'f1': 0.47066033, 'auroc': 0.60588133, 'binary_precision': 0.55421686, 'binary_recall': 0.21296297, 'binary_specificity': 0.8287037, 'binary_f1_score': 0.30769232}
confusion matrix:
     0   1
0  179  37
1  170  46
early stop counter: 11
val acc:0.6400625705718994, best validation acc: 0.6830986142158508, corresponding to test acc:                         0.4652777910232544 / 0.5231481194496155
after epoch: 16,now: 2024-07-20 16:43:18.652562,epoch time: 0:01:15.962042,used: 0:20:17.036472,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_16_23_01_seed_2_22504813
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.8900524, 'precision': 0.89381844, 'recall': 0.8904413, 'specificity': 0.8904413, 'f1': 0.889853, 'auroc': 0.94607437, 'binary_precision': 0.93434346, 'binary_recall': 0.84090906, 'binary_specificity': 0.9399736, 'binary_f1_score': 0.8851674}
confusion matrix:
      0     1
0  1425    91
1   245  1295
---- Validation: 
scalar performance:
{'acc': 0.64319247, 'precision': 0.6973639, 'recall': 0.635857, 'specificity': 0.635857, 'f1': 0.6097731, 'auroc': 0.75330365, 'binary_precision': 0.79432625, 'binary_recall': 0.3601286, 'binary_specificity': 0.9115854, 'binary_f1_score': 0.49557525}
confusion matrix:
     0    1
0  598   58
1  398  224
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5277778, 'precision': 0.54210526, 'recall': 0.5277778, 'specificity': 0.5277778, 'f1': 0.48387098, 'auroc': 0.6108539, 'binary_precision': 0.56666666, 'binary_recall': 0.2361111, 'binary_specificity': 0.8194444, 'binary_f1_score': 0.3333333}
confusion matrix:
     0   1
0  177  39
1  165  51
new oracle model saved
early stop counter: 12
val acc:0.6431924700737, best validation acc: 0.6830986142158508, corresponding to test acc:                         0.4652777910232544 / 0.5277777910232544
after epoch: 17,now: 2024-07-20 16:44:34.222936,epoch time: 0:01:15.570374,used: 0:21:32.606846,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_16_23_01_seed_2_22504813
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.8995419, 'precision': 0.90556765, 'recall': 0.90002656, 'specificity': 0.90002656, 'f1': 0.899241, 'auroc': 0.9523858, 'binary_precision': 0.9570052, 'binary_recall': 0.8383117, 'binary_specificity': 0.96174145, 'binary_f1_score': 0.8937348}
confusion matrix:
      0     1
0  1458    58
1   249  1291
---- Validation: 
scalar performance:
{'acc': 0.6228482, 'precision': 0.68774086, 'recall': 0.61462337, 'specificity': 0.61462337, 'f1': 0.5781508, 'auroc': 0.7518945, 'binary_precision': 0.7916667, 'binary_recall': 0.30546623, 'binary_specificity': 0.9237805, 'binary_f1_score': 0.44083527}
confusion matrix:
     0    1
0  606   50
1  432  190
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5162037, 'precision': 0.52949554, 'recall': 0.5162037, 'specificity': 0.5162037, 'f1': 0.45477927, 'auroc': 0.6111754, 'binary_precision': 0.5492958, 'binary_recall': 0.18055555, 'binary_specificity': 0.8518519, 'binary_f1_score': 0.271777}
confusion matrix:
     0   1
0  184  32
1  177  39
early stop counter: 13
val acc:0.6228482127189636, best validation acc: 0.6830986142158508, corresponding to test acc:                         0.4652777910232544 / 0.5277777910232544
after epoch: 18,now: 2024-07-20 16:45:49.965573,epoch time: 0:01:15.742637,used: 0:22:48.349483,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_16_23_01_seed_2_22504813
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.88841623, 'precision': 0.8920175, 'recall': 0.8887974, 'specificity': 0.8887974, 'f1': 0.8882232, 'auroc': 0.9488071, 'binary_precision': 0.93160546, 'binary_recall': 0.84025973, 'binary_specificity': 0.9373351, 'binary_f1_score': 0.883578}
confusion matrix:
      0     1
0  1421    95
1   246  1294
---- Validation: 
scalar performance:
{'acc': 0.62989044, 'precision': 0.6897507, 'recall': 0.6220248, 'specificity': 0.6220248, 'f1': 0.5899186, 'auroc': 0.755222, 'binary_precision': 0.78988326, 'binary_recall': 0.32636657, 'binary_specificity': 0.91768295, 'binary_f1_score': 0.46188852}
confusion matrix:
     0    1
0  602   54
1  419  203
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5347222, 'precision': 0.5569801, 'recall': 0.5347222, 'specificity': 0.5347222, 'f1': 0.4843675, 'auroc': 0.6212063, 'binary_precision': 0.5925926, 'binary_recall': 0.22222222, 'binary_specificity': 0.8472222, 'binary_f1_score': 0.32323232}
confusion matrix:
     0   1
0  183  33
1  168  48
new oracle model saved
early stop counter: 14
val acc:0.6298904418945312, best validation acc: 0.6830986142158508, corresponding to test acc:                         0.4652777910232544 / 0.5347222089767456
after epoch: 19,now: 2024-07-20 16:47:05.466657,epoch time: 0:01:15.501084,used: 0:24:03.850567,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_16_23_01_seed_2_22504813
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.8972513, 'precision': 0.9038479, 'recall': 0.89775896, 'specificity': 0.89775896, 'f1': 0.89690936, 'auroc': 0.9592545, 'binary_precision': 0.95746267, 'binary_recall': 0.8331169, 'binary_specificity': 0.96240103, 'binary_f1_score': 0.8909722}
confusion matrix:
      0     1
0  1459    57
1   257  1283
---- Validation: 
scalar performance:
{'acc': 0.6150235, 'precision': 0.68522215, 'recall': 0.60641813, 'specificity': 0.60641813, 'f1': 0.5648392, 'auroc': 0.7563059, 'binary_precision': 0.7927928, 'binary_recall': 0.2829582, 'binary_specificity': 0.92987806, 'binary_f1_score': 0.4170616}
confusion matrix:
     0    1
0  610   46
1  446  176
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.525463, 'precision': 0.5463501, 'recall': 0.525463, 'specificity': 0.525463, 'f1': 0.4652142, 'auroc': 0.6257502, 'binary_precision': 0.57746476, 'binary_recall': 0.18981482, 'binary_specificity': 0.8611111, 'binary_f1_score': 0.2857143}
confusion matrix:
     0   1
0  186  30
1  175  41
early stop counter: 15
val acc:0.6150234937667847, best validation acc: 0.6830986142158508, corresponding to test acc:                         0.4652777910232544 / 0.5347222089767456
after epoch: 20,now: 2024-07-20 16:48:21.372987,epoch time: 0:01:15.906330,used: 0:25:19.756897,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_16_23_01_seed_2_22504813
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.904123, 'precision': 0.90872717, 'recall': 0.9045463, 'specificity': 0.9045463, 'f1': 0.90391266, 'auroc': 0.95947385, 'binary_precision': 0.9541151, 'binary_recall': 0.85064936, 'binary_specificity': 0.9584433, 'binary_f1_score': 0.8994164}
confusion matrix:
      0     1
0  1453    63
1   230  1310
---- Validation: 
scalar performance:
{'acc': 0.6118936, 'precision': 0.6822313, 'recall': 0.6032027, 'specificity': 0.6032027, 'f1': 0.5602398, 'auroc': 0.75789154, 'binary_precision': 0.78899086, 'binary_recall': 0.27652735, 'binary_specificity': 0.92987806, 'binary_f1_score': 0.40952384}
confusion matrix:
     0    1
0  610   46
1  450  172
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5277778, 'precision': 0.54999995, 'recall': 0.5277778, 'specificity': 0.5277778, 'f1': 0.46875, 'auroc': 0.63614535, 'binary_precision': 0.5833333, 'binary_recall': 0.19444445, 'binary_specificity': 0.8611111, 'binary_f1_score': 0.29166666}
confusion matrix:
     0   1
0  186  30
1  174  42
early stop counter: 16
val acc:0.6118935942649841, best validation acc: 0.6830986142158508, corresponding to test acc:                         0.4652777910232544 / 0.5347222089767456
after epoch: 21,now: 2024-07-20 16:49:36.848168,epoch time: 0:01:15.475181,used: 0:26:35.232078,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_16_23_01_seed_2_22504813
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9051047, 'precision': 0.9097768, 'recall': 0.9055306, 'specificity': 0.9055306, 'f1': 0.9048935, 'auroc': 0.9561533, 'binary_precision': 0.95553935, 'binary_recall': 0.8512987, 'binary_specificity': 0.9597625, 'binary_f1_score': 0.9004121}
confusion matrix:
      0     1
0  1455    61
1   229  1311
---- Validation: 
scalar performance:
{'acc': 0.6134585, 'precision': 0.6862837, 'recall': 0.6047271, 'specificity': 0.6047271, 'f1': 0.5614788, 'auroc': 0.7591071, 'binary_precision': 0.7962963, 'binary_recall': 0.27652735, 'binary_specificity': 0.93292683, 'binary_f1_score': 0.4105012}
confusion matrix:
     0    1
0  612   44
1  450  172
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5324074, 'precision': 0.55966854, 'recall': 0.5324074, 'specificity': 0.5324074, 'f1': 0.47211272, 'auroc': 0.64375424, 'binary_precision': 0.6, 'binary_recall': 0.19444445, 'binary_specificity': 0.8703704, 'binary_f1_score': 0.29370633}
confusion matrix:
     0   1
0  188  28
1  174  42
early stop counter: 17
val acc:0.613458514213562, best validation acc: 0.6830986142158508, corresponding to test acc:                         0.4652777910232544 / 0.5347222089767456
after epoch: 22,now: 2024-07-20 16:50:52.609721,epoch time: 0:01:15.761553,used: 0:27:50.993631,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_16_23_01_seed_2_22504813
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.91361254, 'precision': 0.9186137, 'recall': 0.91404927, 'specificity': 0.91404927, 'f1': 0.9134095, 'auroc': 0.96388906, 'binary_precision': 0.9663743, 'binary_recall': 0.85844153, 'binary_specificity': 0.969657, 'binary_f1_score': 0.909216}
confusion matrix:
      0     1
0  1470    46
1   218  1322
---- Validation: 
scalar performance:
{'acc': 0.6095462, 'precision': 0.6879895, 'recall': 0.6005411, 'specificity': 0.6005411, 'f1': 0.55343944, 'auroc': 0.76056963, 'binary_precision': 0.8029557, 'binary_recall': 0.26205787, 'binary_specificity': 0.9390244, 'binary_f1_score': 0.39515153}
confusion matrix:
     0    1
0  616   40
1  459  163
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.537037, 'precision': 0.56666666, 'recall': 0.537037, 'specificity': 0.537037, 'f1': 0.47916663, 'auroc': 0.6433042, 'binary_precision': 0.6111111, 'binary_recall': 0.2037037, 'binary_specificity': 0.8703704, 'binary_f1_score': 0.30555555}
confusion matrix:
     0   1
0  188  28
1  172  44
new oracle model saved
early stop counter: 18
val acc:0.6095461845397949, best validation acc: 0.6830986142158508, corresponding to test acc:                         0.4652777910232544 / 0.5370370149612427
after epoch: 23,now: 2024-07-20 16:52:08.011842,epoch time: 0:01:15.402121,used: 0:29:06.395752,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_16_23_01_seed_2_22504813
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.91099477, 'precision': 0.91505104, 'recall': 0.9113902, 'specificity': 0.9113902, 'f1': 0.9108284, 'auroc': 0.9627352, 'binary_precision': 0.9580925, 'binary_recall': 0.861039, 'binary_specificity': 0.96174145, 'binary_f1_score': 0.90697676}
confusion matrix:
      0     1
0  1458    58
1   214  1326
---- Validation: 
scalar performance:
{'acc': 0.6220657, 'precision': 0.6929765, 'recall': 0.6136112, 'specificity': 0.6136112, 'f1': 0.574574, 'auroc': 0.7627294, 'binary_precision': 0.80349344, 'binary_recall': 0.29581994, 'binary_specificity': 0.93140244, 'binary_f1_score': 0.4324324}
confusion matrix:
     0    1
0  611   45
1  438  184
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5462963, 'precision': 0.57526135, 'recall': 0.5462963, 'specificity': 0.5462963, 'f1': 0.49799606, 'auroc': 0.6496271, 'binary_precision': 0.6219512, 'binary_recall': 0.2361111, 'binary_specificity': 0.8564815, 'binary_f1_score': 0.34228188}
confusion matrix:
     0   1
0  185  31
1  165  51
new oracle model saved
early stop counter: 19
val acc:0.6220657229423523, best validation acc: 0.6830986142158508, corresponding to test acc:                         0.4652777910232544 / 0.5462962985038757
after epoch: 24,now: 2024-07-20 16:53:23.775156,epoch time: 0:01:15.763314,used: 0:30:22.159066,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_16_23_01_seed_2_22504813
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.908377, 'precision': 0.9124098, 'recall': 0.90877223, 'specificity': 0.90877223, 'f1': 0.90820575, 'auroc': 0.96138376, 'binary_precision': 0.95520234, 'binary_recall': 0.85844153, 'binary_specificity': 0.9591029, 'binary_f1_score': 0.9042408}
confusion matrix:
      0     1
0  1454    62
1   218  1322
---- Validation: 
scalar performance:
{'acc': 0.6197183, 'precision': 0.69084173, 'recall': 0.6111996, 'specificity': 0.6111996, 'f1': 0.57117176, 'auroc': 0.76290584, 'binary_precision': 0.80088496, 'binary_recall': 0.2909968, 'binary_specificity': 0.93140244, 'binary_f1_score': 0.4268868}
confusion matrix:
     0    1
0  611   45
1  441  181
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5416667, 'precision': 0.5690341, 'recall': 0.5416667, 'specificity': 0.5416667, 'f1': 0.4912448, 'auroc': 0.6537851, 'binary_precision': 0.6125, 'binary_recall': 0.22685185, 'binary_specificity': 0.8564815, 'binary_f1_score': 0.33108106}
confusion matrix:
     0   1
0  185  31
1  167  49
early stop counter: 20
val acc:0.6197183132171631, best validation acc: 0.6830986142158508, corresponding to test acc:                         0.4652777910232544 / 0.5462962985038757
after epoch: 25,now: 2024-07-20 16:54:39.660773,epoch time: 0:01:15.885617,used: 0:31:38.044683,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_16_23_01_seed_2_22504813
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9070681, 'precision': 0.91286904, 'recall': 0.9075403, 'specificity': 0.9075403, 'f1': 0.9068062, 'auroc': 0.9617783, 'binary_precision': 0.9638109, 'binary_recall': 0.8474026, 'binary_specificity': 0.9676781, 'binary_f1_score': 0.9018659}
confusion matrix:
      0     1
0  1467    49
1   235  1305
---- Validation: 
scalar performance:
{'acc': 0.6189358, 'precision': 0.6940057, 'recall': 0.61027074, 'specificity': 0.61027074, 'f1': 0.56848127, 'auroc': 0.76399887, 'binary_precision': 0.8082192, 'binary_recall': 0.28456593, 'binary_specificity': 0.9359756, 'binary_f1_score': 0.4209275}
confusion matrix:
     0    1
0  614   42
1  445  177
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5486111, 'precision': 0.5813282, 'recall': 0.5486111, 'specificity': 0.5486111, 'f1': 0.49813825, 'auroc': 0.65942216, 'binary_precision': 0.6329114, 'binary_recall': 0.23148148, 'binary_specificity': 0.8657407, 'binary_f1_score': 0.33898303}
confusion matrix:
     0   1
0  187  29
1  166  50
new oracle model saved
early stop counter: 21
val acc:0.6189358234405518, best validation acc: 0.6830986142158508, corresponding to test acc:                         0.4652777910232544 / 0.5486111044883728
after epoch: 26,now: 2024-07-20 16:55:55.269276,epoch time: 0:01:15.608503,used: 0:32:53.653186,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_16_23_01_seed_2_22504813
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.908377, 'precision': 0.91332, 'recall': 0.90881336, 'specificity': 0.90881336, 'f1': 0.9081615, 'auroc': 0.95976424, 'binary_precision': 0.9605263, 'binary_recall': 0.85324675, 'binary_specificity': 0.96437997, 'binary_f1_score': 0.9037139}
confusion matrix:
      0     1
0  1462    54
1   226  1314
---- Validation: 
scalar performance:
{'acc': 0.6126761, 'precision': 0.6953325, 'recall': 0.60363156, 'specificity': 0.60363156, 'f1': 0.556455, 'auroc': 0.764516, 'binary_precision': 0.8159204, 'binary_recall': 0.2636656, 'binary_specificity': 0.94359756, 'binary_f1_score': 0.3985419}
confusion matrix:
     0    1
0  619   37
1  458  164
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5439815, 'precision': 0.5766387, 'recall': 0.5439815, 'specificity': 0.5439815, 'f1': 0.48960978, 'auroc': 0.6609439, 'binary_precision': 0.62666667, 'binary_recall': 0.2175926, 'binary_specificity': 0.8703704, 'binary_f1_score': 0.32302403}
confusion matrix:
     0   1
0  188  28
1  169  47
early stop counter: 22
val acc:0.6126760840415955, best validation acc: 0.6830986142158508, corresponding to test acc:                         0.4652777910232544 / 0.5486111044883728
after epoch: 27,now: 2024-07-20 16:57:11.039539,epoch time: 0:01:15.770263,used: 0:34:09.423449,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_16_23_01_seed_2_22504813
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.91721207, 'precision': 0.92243814, 'recall': 0.91765666, 'specificity': 0.91765666, 'f1': 0.9170094, 'auroc': 0.9633609, 'binary_precision': 0.9714286, 'binary_recall': 0.861039, 'binary_specificity': 0.9742744, 'binary_f1_score': 0.9129088}
confusion matrix:
      0     1
0  1477    39
1   214  1326
---- Validation: 
scalar performance:
{'acc': 0.6071988, 'precision': 0.69328076, 'recall': 0.59792125, 'specificity': 0.59792125, 'f1': 0.54696465, 'auroc': 0.7644793, 'binary_precision': 0.81578946, 'binary_recall': 0.24919614, 'binary_specificity': 0.94664633, 'binary_f1_score': 0.38177338}
confusion matrix:
     0    1
0  621   35
1  467  155
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5486111, 'precision': 0.5927417, 'recall': 0.5486111, 'specificity': 0.5486111, 'f1': 0.4876629, 'auroc': 0.6670953, 'binary_precision': 0.6567164, 'binary_recall': 0.2037037, 'binary_specificity': 0.8935185, 'binary_f1_score': 0.31095406}
confusion matrix:
     0   1
0  193  23
1  172  44
early stop counter: 23
val acc:0.6071987748146057, best validation acc: 0.6830986142158508, corresponding to test acc:                         0.4652777910232544 / 0.5486111044883728
after epoch: 28,now: 2024-07-20 16:58:27.523312,epoch time: 0:01:16.483773,used: 0:35:25.907222,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_16_23_01_seed_2_22504813
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.91688484, 'precision': 0.92121685, 'recall': 0.9172909, 'specificity': 0.9172909, 'f1': 0.9167199, 'auroc': 0.9653514, 'binary_precision': 0.965942, 'binary_recall': 0.86558443, 'binary_specificity': 0.96899736, 'binary_f1_score': 0.9130137}
confusion matrix:
      0     1
0  1469    47
1   207  1333
---- Validation: 
scalar performance:
{'acc': 0.6079812, 'precision': 0.6940255, 'recall': 0.5987251, 'specificity': 0.5987251, 'f1': 0.5481642, 'auroc': 0.76661146, 'binary_precision': 0.8167539, 'binary_recall': 0.25080386, 'binary_specificity': 0.94664633, 'binary_f1_score': 0.38376385}
confusion matrix:
     0    1
0  621   35
1  466  156
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5555556, 'precision': 0.60730255, 'recall': 0.5555556, 'specificity': 0.5555556, 'f1': 0.494626, 'auroc': 0.67408264, 'binary_precision': 0.6818182, 'binary_recall': 0.20833333, 'binary_specificity': 0.9027778, 'binary_f1_score': 0.31914893}
confusion matrix:
     0   1
0  195  21
1  171  45
new oracle model saved
early stop counter: 24
val acc:0.6079812049865723, best validation acc: 0.6830986142158508, corresponding to test acc:                         0.4652777910232544 / 0.5555555820465088
after epoch: 29,now: 2024-07-20 16:59:43.391475,epoch time: 0:01:15.868163,used: 0:36:41.775385,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_16_23_01_seed_2_22504813
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.9139398, 'precision': 0.91950583, 'recall': 0.9143996, 'specificity': 0.9143996, 'f1': 0.913712, 'auroc': 0.96601874, 'binary_precision': 0.96983075, 'binary_recall': 0.85584414, 'binary_specificity': 0.97295517, 'binary_f1_score': 0.90927905}
confusion matrix:
      0     1
0  1475    41
1   222  1318
---- Validation: 
scalar performance:
{'acc': 0.6126761, 'precision': 0.6923897, 'recall': 0.6037149, 'specificity': 0.6037149, 'f1': 0.55757916, 'auroc': 0.7694789, 'binary_precision': 0.8097561, 'binary_recall': 0.26688102, 'binary_specificity': 0.9405488, 'binary_f1_score': 0.401451}
confusion matrix:
     0    1
0  617   39
1  456  166
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5578704, 'precision': 0.59496677, 'recall': 0.5578704, 'specificity': 0.5578704, 'f1': 0.51002085, 'auroc': 0.6809628, 'binary_precision': 0.654321, 'binary_recall': 0.24537037, 'binary_specificity': 0.8703704, 'binary_f1_score': 0.35690236}
confusion matrix:
     0   1
0  188  28
1  163  53
new oracle model saved
early stop counter: 25
val acc:0.6126760840415955, best validation acc: 0.6830986142158508, corresponding to test acc:                         0.4652777910232544 / 0.5578703880310059
after epoch: 30,now: 2024-07-20 17:00:59.328167,epoch time: 0:01:15.936692,used: 0:37:57.712077,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_16_23_01_seed_2_22504813
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 0:37:57.712077 at 2024-07-20 17:00:59.328167
persisted model performance metric: 

scalar performance:
{'acc': 0.4652778, 'precision': 0.46305335, 'recall': 0.4652778, 'specificity': 0.4652778, 'f1': 0.45710635, 'auroc': 0.44918126, 'binary_precision': 0.45398772, 'binary_recall': 0.3425926, 'binary_specificity': 0.587963, 'binary_f1_score': 0.39050132}
confusion matrix:
     0   1
0  127  89
1  142  74
oracle model performance metric: 

scalar performance:
{'acc': 0.5578704, 'precision': 0.59496677, 'recall': 0.5578704, 'specificity': 0.5578704, 'f1': 0.51002085, 'auroc': 0.6809628, 'binary_precision': 0.654321, 'binary_recall': 0.24537037, 'binary_specificity': 0.8703704, 'binary_f1_score': 0.35690236}
confusion matrix:
     0   1
0  188  28
1  163  53
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_halffreezeblocks_2024-07-20_12-47-21/rule_results/3.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_halffreezeblocks_2024-07-20_12-47-21/confusion_matrix/3.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 195607 KiB |   7828 MiB | 185299 GiB | 185298 GiB |
|       from large pool | 179211 KiB |   7805 MiB | 182834 GiB | 182834 GiB |
|       from small pool |  16396 KiB |     36 MiB |   2464 GiB |   2464 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 195607 KiB |   7828 MiB | 185299 GiB | 185298 GiB |
|       from large pool | 179211 KiB |   7805 MiB | 182834 GiB | 182834 GiB |
|       from small pool |  16396 KiB |     36 MiB |   2464 GiB |   2464 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 195188 KiB |   7827 MiB | 185274 GiB | 185274 GiB |
|       from large pool | 178979 KiB |   7804 MiB | 182815 GiB | 182815 GiB |
|       from small pool |  16209 KiB |     36 MiB |   2459 GiB |   2459 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   8510 MiB |   8524 MiB |  25074 MiB |  16564 MiB |
|       from large pool |   8472 MiB |   8486 MiB |  24998 MiB |  16526 MiB |
|       from small pool |     38 MiB |     44 MiB |     76 MiB |     38 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  39913 KiB | 732464 KiB |  98949 GiB |  98949 GiB |
|       from large pool |  31733 KiB | 730714 KiB |  96477 GiB |  96477 GiB |
|       from small pool |   8180 KiB |  20265 KiB |   2472 GiB |   2472 GiB |
|---------------------------------------------------------------------------|
| Allocations           |     788    |    1679    |   31315 K  |   31314 K  |
|       from large pool |      79    |     762    |   17022 K  |   17022 K  |
|       from small pool |     709    |    1017    |   14293 K  |   14292 K  |
|---------------------------------------------------------------------------|
| Active allocs         |     788    |    1679    |   31315 K  |   31314 K  |
|       from large pool |      79    |     762    |   17022 K  |   17022 K  |
|       from small pool |     709    |    1017    |   14293 K  |   14292 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     367    |     370    |    1062    |     695    |
|       from large pool |     348    |     349    |    1024    |     676    |
|       from small pool |      19    |      22    |      38    |      19    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      44    |     383    |   18533 K  |   18533 K  |
|       from large pool |      11    |     351    |   12107 K  |   12107 K  |
|       from small pool |      33    |     215    |    6426 K  |    6426 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   7828 MiB | 185299 GiB | 185299 GiB |
|       from large pool |  16640 KiB |   7805 MiB | 182834 GiB | 182834 GiB |
|       from small pool |      0 KiB |     36 MiB |   2464 GiB |   2464 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   7828 MiB | 185299 GiB | 185299 GiB |
|       from large pool |  16640 KiB |   7805 MiB | 182834 GiB | 182834 GiB |
|       from small pool |      0 KiB |     36 MiB |   2464 GiB |   2464 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   7827 MiB | 185274 GiB | 185274 GiB |
|       from large pool |  16640 KiB |   7804 MiB | 182815 GiB | 182815 GiB |
|       from small pool |      0 KiB |     36 MiB |   2459 GiB |   2459 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 235520 KiB |   8524 MiB |  25074 MiB |  24844 MiB |
|       from large pool | 210944 KiB |   8486 MiB |  24998 MiB |  24792 MiB |
|       from small pool |  24576 KiB |     44 MiB |     76 MiB |     52 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  30464 KiB | 732464 KiB |  98949 GiB |  98949 GiB |
|       from large pool |  30464 KiB | 730714 KiB |  96477 GiB |  96477 GiB |
|       from small pool |      0 KiB |  20271 KiB |   2472 GiB |   2472 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    1679    |   31315 K  |   31315 K  |
|       from large pool |       2    |     762    |   17022 K  |   17022 K  |
|       from small pool |       0    |    1017    |   14293 K  |   14293 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    1679    |   31315 K  |   31315 K  |
|       from large pool |       2    |     762    |   17022 K  |   17022 K  |
|       from small pool |       0    |    1017    |   14293 K  |   14293 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      22    |     370    |    1062    |    1040    |
|       from large pool |      10    |     349    |    1024    |    1014    |
|       from small pool |      12    |      22    |      38    |      26    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     383    |   18533 K  |   18533 K  |
|       from large pool |       3    |     351    |   12107 K  |   12107 K  |
|       from small pool |       0    |     215    |    6426 K  |    6426 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Sat Jul 20 17:01:48 2024]
Finished job 0.
1 of 1 steps (100%) done
