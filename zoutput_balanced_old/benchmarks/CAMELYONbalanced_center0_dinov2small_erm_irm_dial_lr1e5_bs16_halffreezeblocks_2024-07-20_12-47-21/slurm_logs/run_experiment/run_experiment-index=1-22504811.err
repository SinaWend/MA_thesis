Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Sat Jul 20 14:26:32 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_halffreezeblocks_2024-07-20_12-47-21/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_halffreezeblocks_2024-07-20_12-47-21/rule_results/1.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=1
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/swiglu_ffn.py:51: UserWarning: xFormers is not available (SwiGLU)
  warnings.warn("xFormers is not available (SwiGLU)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/attention.py:33: UserWarning: xFormers is not available (Attention)
  warnings.warn("xFormers is not available (Attention)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/block.py:40: UserWarning: xFormers is not available (Block)
  warnings.warn("xFormers is not available (Block)")
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'888c1ef2'
model name: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_14_29_37_seed_0_22504811

 Experiment start at: 2024-07-20 14:29:37.384797
before training, model accuracy: 0.569767415523529
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.54264325, 'precision': 0.5424846, 'recall': 0.54205775, 'specificity': 0.54205775, 'f1': 0.5411881, 'auroc': 0.57495415, 'binary_precision': 0.5440568, 'binary_recall': 0.5920206, 'binary_specificity': 0.49209487, 'binary_f1_score': 0.56702614}
confusion matrix:
     0    1
0  747  771
1  634  920
---- Validation: 
scalar performance:
{'acc': 0.63121116, 'precision': 0.6390565, 'recall': 0.6293919, 'specificity': 0.6293919, 'f1': 0.6239481, 'auroc': 0.703023, 'binary_precision': 0.6687764, 'binary_recall': 0.4992126, 'binary_specificity': 0.7595712, 'binary_f1_score': 0.5716862}
confusion matrix:
     0    1
0  496  157
1  318  317
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6302326, 'precision': 0.63799745, 'recall': 0.6302326, 'specificity': 0.6302326, 'f1': 0.6249568, 'auroc': 0.666782, 'binary_precision': 0.6707317, 'binary_recall': 0.5116279, 'binary_specificity': 0.74883723, 'binary_f1_score': 0.5804749}
confusion matrix:
     0    1
0  161   54
1  105  110
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-20 14:30:48.254311,epoch time: 0:01:10.869514,used: 0:01:10.869514,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_14_29_37_seed_0_22504811
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.67545575, 'precision': 0.67873216, 'recall': 0.67436785, 'specificity': 0.67436785, 'f1': 0.67305946, 'auroc': 0.7465084, 'binary_precision': 0.6578503, 'binary_recall': 0.7503209, 'binary_specificity': 0.5984148, 'binary_f1_score': 0.7010495}
confusion matrix:
     0     1
0  906   608
1  389  1169
---- Validation: 
scalar performance:
{'acc': 0.6257764, 'precision': 0.64147216, 'recall': 0.62329406, 'specificity': 0.62329406, 'f1': 0.61231565, 'auroc': 0.7110393, 'binary_precision': 0.68523, 'binary_recall': 0.4456693, 'binary_specificity': 0.8009188, 'binary_f1_score': 0.5400763}
confusion matrix:
     0    1
0  523  130
1  352  283
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6139535, 'precision': 0.6333511, 'recall': 0.6139535, 'specificity': 0.6139535, 'f1': 0.5993849, 'auroc': 0.68711734, 'binary_precision': 0.68421054, 'binary_recall': 0.4232558, 'binary_specificity': 0.80465114, 'binary_f1_score': 0.5229885}
confusion matrix:
     0   1
0  173  42
1  124  91
early stop counter: 1
val acc:0.6257764101028442, best validation acc: 0.6312111616134644, corresponding to test acc:                         0.630232572555542 / 0.630232572555542
after epoch: 2,now: 2024-07-20 14:31:46.794368,epoch time: 0:00:58.540057,used: 0:02:09.409571,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_14_29_37_seed_0_22504811
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.7470703, 'precision': 0.74740076, 'recall': 0.74671614, 'specificity': 0.74671614, 'f1': 0.7467631, 'auroc': 0.81841624, 'binary_precision': 0.74135804, 'binary_recall': 0.7703656, 'binary_specificity': 0.72306675, 'binary_f1_score': 0.7555835}
confusion matrix:
      0     1
0  1094   419
1   358  1201
---- Validation: 
scalar performance:
{'acc': 0.61878884, 'precision': 0.6405674, 'recall': 0.61588186, 'specificity': 0.61588186, 'f1': 0.600021, 'auroc': 0.7188458, 'binary_precision': 0.69251335, 'binary_recall': 0.40787402, 'binary_specificity': 0.82388973, 'binary_f1_score': 0.51337963}
confusion matrix:
     0    1
0  538  115
1  376  259
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.63255817, 'precision': 0.6607213, 'recall': 0.6325581, 'specificity': 0.6325581, 'f1': 0.61572397, 'auroc': 0.70702004, 'binary_precision': 0.728, 'binary_recall': 0.4232558, 'binary_specificity': 0.8418605, 'binary_f1_score': 0.53529406}
confusion matrix:
     0   1
0  181  34
1  124  91
new oracle model saved
early stop counter: 2
val acc:0.6187888383865356, best validation acc: 0.6312111616134644, corresponding to test acc:                         0.630232572555542 / 0.6325581669807434
after epoch: 3,now: 2024-07-20 14:32:45.379378,epoch time: 0:00:58.585010,used: 0:03:07.994581,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_14_29_37_seed_0_22504811
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.79785156, 'precision': 0.7978759, 'recall': 0.79792327, 'specificity': 0.79792327, 'f1': 0.7978468, 'auroc': 0.86638916, 'binary_precision': 0.80535597, 'binary_recall': 0.79241645, 'binary_specificity': 0.8034301, 'binary_f1_score': 0.79883385}
confusion matrix:
      0     1
0  1218   298
1   323  1233
---- Validation: 
scalar performance:
{'acc': 0.60559005, 'precision': 0.63380027, 'recall': 0.60221386, 'specificity': 0.60221386, 'f1': 0.57929605, 'auroc': 0.7238958, 'binary_precision': 0.6918429, 'binary_recall': 0.36062992, 'binary_specificity': 0.84379786, 'binary_f1_score': 0.47412008}
confusion matrix:
     0    1
0  551  102
1  406  229
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.61162794, 'precision': 0.64166486, 'recall': 0.61162794, 'specificity': 0.61162794, 'f1': 0.58988917, 'auroc': 0.72116816, 'binary_precision': 0.70689654, 'binary_recall': 0.38139534, 'binary_specificity': 0.8418605, 'binary_f1_score': 0.49546826}
confusion matrix:
     0   1
0  181  34
1  133  82
early stop counter: 3
val acc:0.6055900454521179, best validation acc: 0.6312111616134644, corresponding to test acc:                         0.630232572555542 / 0.6325581669807434
after epoch: 4,now: 2024-07-20 14:33:44.013662,epoch time: 0:00:58.634284,used: 0:04:06.628865,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_14_29_37_seed_0_22504811
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.8108724, 'precision': 0.81221557, 'recall': 0.81135166, 'specificity': 0.81135166, 'f1': 0.81079775, 'auroc': 0.8751551, 'binary_precision': 0.83677685, 'binary_recall': 0.77934575, 'binary_specificity': 0.84335756, 'binary_f1_score': 0.8070408}
confusion matrix:
      0     1
0  1276   237
1   344  1215
---- Validation: 
scalar performance:
{'acc': 0.5947205, 'precision': 0.62593937, 'recall': 0.59106004, 'specificity': 0.59106004, 'f1': 0.562805, 'auroc': 0.7303276, 'binary_precision': 0.68524593, 'binary_recall': 0.32913387, 'binary_specificity': 0.8529862, 'binary_f1_score': 0.4446809}
confusion matrix:
     0    1
0  557   96
1  426  209
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6139535, 'precision': 0.6505473, 'recall': 0.6139535, 'specificity': 0.6139535, 'f1': 0.58897644, 'auroc': 0.7348621, 'binary_precision': 0.72477067, 'binary_recall': 0.36744186, 'binary_specificity': 0.8604651, 'binary_f1_score': 0.4876543}
confusion matrix:
     0   1
0  185  30
1  136  79
early stop counter: 4
val acc:0.5947204828262329, best validation acc: 0.6312111616134644, corresponding to test acc:                         0.630232572555542 / 0.6325581669807434
after epoch: 5,now: 2024-07-20 14:34:42.702306,epoch time: 0:00:58.688644,used: 0:05:05.317509,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_14_29_37_seed_0_22504811
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.83170575, 'precision': 0.83540076, 'recall': 0.8323852, 'specificity': 0.8323852, 'f1': 0.83141756, 'auroc': 0.89020395, 'binary_precision': 0.8740101, 'binary_recall': 0.78020567, 'binary_specificity': 0.88456464, 'binary_f1_score': 0.82444817}
confusion matrix:
      0     1
0  1341   175
1   342  1214
---- Validation: 
scalar performance:
{'acc': 0.58928573, 'precision': 0.62539685, 'recall': 0.5853529, 'specificity': 0.5853529, 'f1': 0.55168754, 'auroc': 0.73319024, 'binary_precision': 0.6892857, 'binary_recall': 0.30393702, 'binary_specificity': 0.8667688, 'binary_f1_score': 0.42185792}
confusion matrix:
     0    1
0  566   87
1  442  193
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.60465115, 'precision': 0.64558065, 'recall': 0.60465115, 'specificity': 0.60465115, 'f1': 0.5747627, 'auroc': 0.74435914, 'binary_precision': 0.7227723, 'binary_recall': 0.33953488, 'binary_specificity': 0.8697674, 'binary_f1_score': 0.46202534}
confusion matrix:
     0   1
0  187  28
1  142  73
early stop counter: 5
val acc:0.5892857313156128, best validation acc: 0.6312111616134644, corresponding to test acc:                         0.630232572555542 / 0.6325581669807434
after epoch: 6,now: 2024-07-20 14:35:41.590846,epoch time: 0:00:58.888540,used: 0:06:04.206049,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_14_29_37_seed_0_22504811
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.8375651, 'precision': 0.839945, 'recall': 0.83813566, 'specificity': 0.83813566, 'f1': 0.8374161, 'auroc': 0.90405095, 'binary_precision': 0.87201124, 'binary_recall': 0.79640335, 'binary_specificity': 0.879868, 'binary_f1_score': 0.83249414}
confusion matrix:
      0     1
0  1333   182
1   317  1240
---- Validation: 
scalar performance:
{'acc': 0.59006214, 'precision': 0.6262285, 'recall': 0.5861403, 'specificity': 0.5861403, 'f1': 0.5527543, 'auroc': 0.73753846, 'binary_precision': 0.6903915, 'binary_recall': 0.3055118, 'binary_specificity': 0.8667688, 'binary_f1_score': 0.4235808}
confusion matrix:
     0    1
0  566   87
1  441  194
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.61860466, 'precision': 0.6606593, 'recall': 0.61860466, 'specificity': 0.61860466, 'f1': 0.5918982, 'auroc': 0.7524067, 'binary_precision': 0.74285716, 'binary_recall': 0.3627907, 'binary_specificity': 0.8744186, 'binary_f1_score': 0.48750007}
confusion matrix:
     0   1
0  188  27
1  137  78
early stop counter: 6
val acc:0.590062141418457, best validation acc: 0.6312111616134644, corresponding to test acc:                         0.630232572555542 / 0.6325581669807434
after epoch: 7,now: 2024-07-20 14:36:40.173367,epoch time: 0:00:58.582521,used: 0:07:02.788570,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_14_29_37_seed_0_22504811
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.851888, 'precision': 0.85632384, 'recall': 0.85272753, 'specificity': 0.85272753, 'f1': 0.8516098, 'auroc': 0.9166459, 'binary_precision': 0.9, 'binary_recall': 0.79666454, 'binary_specificity': 0.90879047, 'binary_f1_score': 0.8451854}
confusion matrix:
      0     1
0  1375   138
1   317  1242
---- Validation: 
scalar performance:
{'acc': 0.5923913, 'precision': 0.6293269, 'recall': 0.5884808, 'specificity': 0.5884808, 'f1': 0.5555126, 'auroc': 0.74258363, 'binary_precision': 0.69503546, 'binary_recall': 0.30866143, 'binary_specificity': 0.86830014, 'binary_f1_score': 0.4274809}
confusion matrix:
     0    1
0  567   86
1  439  196
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.61860466, 'precision': 0.6586325, 'recall': 0.61860466, 'specificity': 0.61860466, 'f1': 0.59292525, 'auroc': 0.7601514, 'binary_precision': 0.7383177, 'binary_recall': 0.36744186, 'binary_specificity': 0.8697674, 'binary_f1_score': 0.49068323}
confusion matrix:
     0   1
0  187  28
1  136  79
early stop counter: 7
val acc:0.592391312122345, best validation acc: 0.6312111616134644, corresponding to test acc:                         0.630232572555542 / 0.6325581669807434
after epoch: 8,now: 2024-07-20 14:37:38.666119,epoch time: 0:00:58.492752,used: 0:08:01.281322,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_14_29_37_seed_0_22504811
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.85091144, 'precision': 0.85756433, 'recall': 0.8518019, 'specificity': 0.8518019, 'f1': 0.8504205, 'auroc': 0.91526926, 'binary_precision': 0.90970147, 'binary_recall': 0.783419, 'binary_specificity': 0.9201847, 'binary_f1_score': 0.8418508}
confusion matrix:
      0     1
0  1395   121
1   337  1219
---- Validation: 
scalar performance:
{'acc': 0.61102486, 'precision': 0.6451073, 'recall': 0.60748696, 'specificity': 0.60748696, 'f1': 0.58243924, 'auroc': 0.7495147, 'binary_precision': 0.71202534, 'binary_recall': 0.35433072, 'binary_specificity': 0.8606432, 'binary_f1_score': 0.47318614}
confusion matrix:
     0    1
0  562   91
1  410  225
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6348837, 'precision': 0.66935575, 'recall': 0.6348837, 'specificity': 0.6348837, 'f1': 0.6153079, 'auroc': 0.7696268, 'binary_precision': 0.7457627, 'binary_recall': 0.40930232, 'binary_specificity': 0.8604651, 'binary_f1_score': 0.5285285}
confusion matrix:
     0   1
0  185  30
1  127  88
new oracle model saved
early stop counter: 8
val acc:0.6110248565673828, best validation acc: 0.6312111616134644, corresponding to test acc:                         0.630232572555542 / 0.6348837018013
after epoch: 9,now: 2024-07-20 14:38:37.451087,epoch time: 0:00:58.784968,used: 0:09:00.066290,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_14_29_37_seed_0_22504811
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.8652344, 'precision': 0.8705151, 'recall': 0.86597896, 'specificity': 0.86597896, 'f1': 0.8649036, 'auroc': 0.9248216, 'binary_precision': 0.9179487, 'binary_recall': 0.8057878, 'binary_specificity': 0.92617005, 'binary_f1_score': 0.8582192}
confusion matrix:
      0     1
0  1405   112
1   302  1253
---- Validation: 
scalar performance:
{'acc': 0.6195652, 'precision': 0.64987206, 'recall': 0.6162786, 'specificity': 0.6162786, 'f1': 0.59552616, 'auroc': 0.7538893, 'binary_precision': 0.7138643, 'binary_recall': 0.38110235, 'binary_specificity': 0.8514548, 'binary_f1_score': 0.49691996}
confusion matrix:
     0    1
0  556   97
1  393  242
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.644186, 'precision': 0.6773739, 'recall': 0.644186, 'specificity': 0.644186, 'f1': 0.62672555, 'auroc': 0.77501357, 'binary_precision': 0.75409836, 'binary_recall': 0.427907, 'binary_specificity': 0.8604651, 'binary_f1_score': 0.54599404}
confusion matrix:
     0   1
0  185  30
1  123  92
new oracle model saved
early stop counter: 9
val acc:0.6195651888847351, best validation acc: 0.6312111616134644, corresponding to test acc:                         0.630232572555542 / 0.6441860198974609
after epoch: 10,now: 2024-07-20 14:39:36.284402,epoch time: 0:00:58.833315,used: 0:09:58.899605,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_14_29_37_seed_0_22504811
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.8652344, 'precision': 0.8711165, 'recall': 0.86601925, 'specificity': 0.86601925, 'f1': 0.86485857, 'auroc': 0.92886686, 'binary_precision': 0.9210332, 'binary_recall': 0.80257237, 'binary_specificity': 0.92946607, 'binary_f1_score': 0.85773194}
confusion matrix:
      0     1
0  1410   107
1   307  1248
---- Validation: 
scalar performance:
{'acc': 0.6164596, 'precision': 0.6503248, 'recall': 0.6129988, 'specificity': 0.6129988, 'f1': 0.58951366, 'auroc': 0.7564529, 'binary_precision': 0.71826625, 'binary_recall': 0.36535433, 'binary_specificity': 0.8606432, 'binary_f1_score': 0.48434243}
confusion matrix:
     0    1
0  562   91
1  403  232
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6511628, 'precision': 0.6908058, 'recall': 0.65116274, 'specificity': 0.65116274, 'f1': 0.6320509, 'auroc': 0.7823472, 'binary_precision': 0.7777778, 'binary_recall': 0.4232558, 'binary_specificity': 0.87906975, 'binary_f1_score': 0.54819274}
confusion matrix:
     0   1
0  189  26
1  124  91
new oracle model saved
early stop counter: 10
val acc:0.6164596080780029, best validation acc: 0.6312111616134644, corresponding to test acc:                         0.630232572555542 / 0.6511628031730652
after epoch: 11,now: 2024-07-20 14:40:35.164294,epoch time: 0:00:58.879892,used: 0:10:57.779497,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_14_29_37_seed_0_22504811
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.87890625, 'precision': 0.8850587, 'recall': 0.8797828, 'specificity': 0.8797828, 'f1': 0.8785769, 'auroc': 0.9403664, 'binary_precision': 0.9372694, 'binary_recall': 0.81567115, 'binary_specificity': 0.9438944, 'binary_f1_score': 0.87225276}
confusion matrix:
      0     1
0  1430    85
1   287  1270
---- Validation: 
scalar performance:
{'acc': 0.61878884, 'precision': 0.6507977, 'recall': 0.61542606, 'specificity': 0.61542606, 'f1': 0.5935428, 'auroc': 0.7606938, 'binary_precision': 0.71686745, 'binary_recall': 0.37480316, 'binary_specificity': 0.856049, 'binary_f1_score': 0.49224404}
confusion matrix:
     0    1
0  559   94
1  397  238
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.65581393, 'precision': 0.69263685, 'recall': 0.65581393, 'specificity': 0.65581393, 'f1': 0.6385405, 'auroc': 0.78888047, 'binary_precision': 0.7768595, 'binary_recall': 0.4372093, 'binary_specificity': 0.8744186, 'binary_f1_score': 0.55952376}
confusion matrix:
     0   1
0  188  27
1  121  94
new oracle model saved
early stop counter: 11
val acc:0.6187888383865356, best validation acc: 0.6312111616134644, corresponding to test acc:                         0.630232572555542 / 0.6558139324188232
after epoch: 12,now: 2024-07-20 14:41:34.156931,epoch time: 0:00:58.992637,used: 0:11:56.772134,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_14_29_37_seed_0_22504811
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.8694661, 'precision': 0.875322, 'recall': 0.87028766, 'specificity': 0.87028766, 'f1': 0.86911553, 'auroc': 0.9307456, 'binary_precision': 0.9255711, 'binary_recall': 0.8071979, 'binary_specificity': 0.9333773, 'binary_f1_score': 0.8623412}
confusion matrix:
      0     1
0  1415   101
1   300  1256
---- Validation: 
scalar performance:
{'acc': 0.6335404, 'precision': 0.66438925, 'recall': 0.6303867, 'specificity': 0.6303867, 'f1': 0.6122215, 'auroc': 0.76299816, 'binary_precision': 0.7321937, 'binary_recall': 0.40472442, 'binary_specificity': 0.856049, 'binary_f1_score': 0.5212982}
confusion matrix:
     0    1
0  559   94
1  378  257
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6581395, 'precision': 0.6908417, 'recall': 0.6581395, 'specificity': 0.6581395, 'f1': 0.64283895, 'auroc': 0.7951325, 'binary_precision': 0.76984125, 'binary_recall': 0.4511628, 'binary_specificity': 0.8651163, 'binary_f1_score': 0.56891495}
confusion matrix:
     0   1
0  186  29
1  118  97
new oracle model saved
better model found
persisted
after epoch: 13,now: 2024-07-20 14:42:32.740988,epoch time: 0:00:58.584057,used: 0:12:55.356191,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_14_29_37_seed_0_22504811
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.8886719, 'precision': 0.8938772, 'recall': 0.889591, 'specificity': 0.889591, 'f1': 0.8884468, 'auroc': 0.9437034, 'binary_precision': 0.94323146, 'binary_recall': 0.83076924, 'binary_specificity': 0.9484127, 'binary_f1_score': 0.8834356}
confusion matrix:
      0     1
0  1434    78
1   264  1296
---- Validation: 
scalar performance:
{'acc': 0.64052796, 'precision': 0.6717522, 'recall': 0.6374299, 'specificity': 0.6374299, 'f1': 0.6203408, 'auroc': 0.76700866, 'binary_precision': 0.74157304, 'binary_recall': 0.41574803, 'binary_specificity': 0.8591118, 'binary_f1_score': 0.53279513}
confusion matrix:
     0    1
0  561   92
1  371  264
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6604651, 'precision': 0.6910299, 'recall': 0.6604651, 'specificity': 0.6604651, 'f1': 0.64631784, 'auroc': 0.79984856, 'binary_precision': 0.76744187, 'binary_recall': 0.4604651, 'binary_specificity': 0.8604651, 'binary_f1_score': 0.57558143}
confusion matrix:
     0   1
0  185  30
1  116  99
new oracle model saved
better model found
persisted
after epoch: 14,now: 2024-07-20 14:43:31.566118,epoch time: 0:00:58.825130,used: 0:13:54.181321,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_14_29_37_seed_0_22504811
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.8805339, 'precision': 0.88998234, 'recall': 0.881611, 'specificity': 0.881611, 'f1': 0.8799995, 'auroc': 0.93959355, 'binary_precision': 0.9541985, 'binary_recall': 0.8028259, 'binary_specificity': 0.96039605, 'binary_f1_score': 0.87199163}
confusion matrix:
      0     1
0  1455    60
1   307  1250
---- Validation: 
scalar performance:
{'acc': 0.6583851, 'precision': 0.68256027, 'recall': 0.6557355, 'specificity': 0.6557355, 'f1': 0.6443346, 'auroc': 0.773824, 'binary_precision': 0.74559194, 'binary_recall': 0.46614173, 'binary_specificity': 0.8453292, 'binary_f1_score': 0.5736434}
confusion matrix:
     0    1
0  552  101
1  339  296
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.66744184, 'precision': 0.6935774, 'recall': 0.66744184, 'specificity': 0.66744184, 'f1': 0.6558248, 'auroc': 0.8065982, 'binary_precision': 0.7647059, 'binary_recall': 0.48372093, 'binary_specificity': 0.8511628, 'binary_f1_score': 0.5925926}
confusion matrix:
     0    1
0  183   32
1  111  104
new oracle model saved
better model found
persisted
after epoch: 15,now: 2024-07-20 14:44:30.337125,epoch time: 0:00:58.771007,used: 0:14:52.952328,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_14_29_37_seed_0_22504811
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.8805339, 'precision': 0.8884082, 'recall': 0.88156796, 'specificity': 0.88156796, 'f1': 0.88010836, 'auroc': 0.94336003, 'binary_precision': 0.94740796, 'binary_recall': 0.809371, 'binary_specificity': 0.95376486, 'binary_f1_score': 0.8729664}
confusion matrix:
      0     1
0  1444    70
1   297  1261
---- Validation: 
scalar performance:
{'acc': 0.66381985, 'precision': 0.6862745, 'recall': 0.6612907, 'specificity': 0.6612907, 'f1': 0.65119934, 'auroc': 0.77903557, 'binary_precision': 0.747549, 'binary_recall': 0.48031497, 'binary_specificity': 0.84226644, 'binary_f1_score': 0.5848514}
confusion matrix:
     0    1
0  550  103
1  330  305
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.67906976, 'precision': 0.7031338, 'recall': 0.67906976, 'specificity': 0.67906976, 'f1': 0.66927505, 'auroc': 0.81310976, 'binary_precision': 0.77304965, 'binary_recall': 0.5069767, 'binary_specificity': 0.8511628, 'binary_f1_score': 0.6123595}
confusion matrix:
     0    1
0  183   32
1  106  109
new oracle model saved
better model found
persisted
after epoch: 16,now: 2024-07-20 14:45:29.594785,epoch time: 0:00:59.257660,used: 0:15:52.209988,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_14_29_37_seed_0_22504811
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.8935547, 'precision': 0.9008119, 'recall': 0.8944918, 'specificity': 0.8944918, 'f1': 0.89321613, 'auroc': 0.94616246, 'binary_precision': 0.95827127, 'binary_recall': 0.82594734, 'binary_specificity': 0.9630363, 'binary_f1_score': 0.88720256}
confusion matrix:
      0     1
0  1459    56
1   271  1286
---- Validation: 
scalar performance:
{'acc': 0.66847825, 'precision': 0.687611, 'recall': 0.6661453, 'specificity': 0.6661453, 'f1': 0.6578506, 'auroc': 0.7828219, 'binary_precision': 0.74413145, 'binary_recall': 0.4992126, 'binary_specificity': 0.8330781, 'binary_f1_score': 0.59754944}
confusion matrix:
     0    1
0  544  109
1  318  317
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.69069767, 'precision': 0.70988095, 'recall': 0.69069767, 'specificity': 0.69069767, 'f1': 0.68346477, 'auroc': 0.8170254, 'binary_precision': 0.7733333, 'binary_recall': 0.53953487, 'binary_specificity': 0.8418605, 'binary_f1_score': 0.6356165}
confusion matrix:
     0    1
0  181   34
1   99  116
new oracle model saved
better model found
persisted
after epoch: 17,now: 2024-07-20 14:46:28.406070,epoch time: 0:00:58.811285,used: 0:16:51.021273,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_14_29_37_seed_0_22504811
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9010417, 'precision': 0.90710497, 'recall': 0.90189564, 'specificity': 0.90189564, 'f1': 0.90079236, 'auroc': 0.9571581, 'binary_precision': 0.9603233, 'binary_recall': 0.8394348, 'binary_specificity': 0.9643564, 'binary_f1_score': 0.89581907}
confusion matrix:
      0     1
0  1461    54
1   250  1307
---- Validation: 
scalar performance:
{'acc': 0.69409937, 'precision': 0.7071727, 'recall': 0.6922598, 'specificity': 0.6922598, 'f1': 0.68786705, 'auroc': 0.78896916, 'binary_precision': 0.75583863, 'binary_recall': 0.5606299, 'binary_specificity': 0.82388973, 'binary_f1_score': 0.64376134}
confusion matrix:
     0    1
0  538  115
1  279  356
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7186046, 'precision': 0.73163855, 'recall': 0.7186047, 'specificity': 0.7186047, 'f1': 0.7145897, 'auroc': 0.82208765, 'binary_precision': 0.7865854, 'binary_recall': 0.6, 'binary_specificity': 0.8372093, 'binary_f1_score': 0.68073875}
confusion matrix:
     0    1
0  180   35
1   86  129
new oracle model saved
better model found
persisted
after epoch: 18,now: 2024-07-20 14:47:27.381606,epoch time: 0:00:58.975536,used: 0:17:49.996809,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_14_29_37_seed_0_22504811
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.90625, 'precision': 0.9132681, 'recall': 0.9070733, 'specificity': 0.9070733, 'f1': 0.905962, 'auroc': 0.96131516, 'binary_precision': 0.97030437, 'binary_recall': 0.8405145, 'binary_specificity': 0.97363216, 'binary_f1_score': 0.900758}
confusion matrix:
      0     1
0  1477    40
1   248  1307
---- Validation: 
scalar performance:
{'acc': 0.69332296, 'precision': 0.70949674, 'recall': 0.6912988, 'specificity': 0.6912988, 'f1': 0.6858232, 'auroc': 0.7915641, 'binary_precision': 0.76431715, 'binary_recall': 0.5464567, 'binary_specificity': 0.8361409, 'binary_f1_score': 0.6372819}
confusion matrix:
     0    1
0  546  107
1  288  347
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7139535, 'precision': 0.7277962, 'recall': 0.7139535, 'specificity': 0.7139535, 'f1': 0.70954084, 'auroc': 0.8264143, 'binary_precision': 0.7839506, 'binary_recall': 0.59069765, 'binary_specificity': 0.8372093, 'binary_f1_score': 0.67374}
confusion matrix:
     0    1
0  180   35
1   88  127
early stop counter: 1
val acc:0.6933229565620422, best validation acc: 0.6940993666648865, corresponding to test acc:                         0.7186046242713928 / 0.7186046242713928
after epoch: 19,now: 2024-07-20 14:48:25.848894,epoch time: 0:00:58.467288,used: 0:18:48.464097,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_14_29_37_seed_0_22504811
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.90625, 'precision': 0.9118618, 'recall': 0.9070693, 'specificity': 0.9070693, 'f1': 0.9060378, 'auroc': 0.9661701, 'binary_precision': 0.963477, 'binary_recall': 0.8471419, 'binary_specificity': 0.9669967, 'binary_f1_score': 0.9015721}
confusion matrix:
      0     1
0  1465    50
1   238  1319
---- Validation: 
scalar performance:
{'acc': 0.7119565, 'precision': 0.7227142, 'recall': 0.71034837, 'specificity': 0.71034837, 'f1': 0.7073844, 'auroc': 0.79767156, 'binary_precision': 0.76829267, 'binary_recall': 0.5952756, 'binary_specificity': 0.82542115, 'binary_f1_score': 0.6708074}
confusion matrix:
     0    1
0  539  114
1  257  378
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7348837, 'precision': 0.74420273, 'recall': 0.7348837, 'specificity': 0.7348837, 'f1': 0.7323301, 'auroc': 0.8315197, 'binary_precision': 0.7919075, 'binary_recall': 0.6372093, 'binary_specificity': 0.83255816, 'binary_f1_score': 0.70618564}
confusion matrix:
     0    1
0  179   36
1   78  137
new oracle model saved
better model found
persisted
after epoch: 20,now: 2024-07-20 14:49:24.854613,epoch time: 0:00:59.005719,used: 0:19:47.469816,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_14_29_37_seed_0_22504811
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9065755, 'precision': 0.9137833, 'recall': 0.90745413, 'specificity': 0.90745413, 'f1': 0.90628517, 'auroc': 0.9639857, 'binary_precision': 0.9717472, 'binary_recall': 0.8399743, 'binary_specificity': 0.97493404, 'binary_f1_score': 0.90106857}
confusion matrix:
      0     1
0  1478    38
1   249  1307
---- Validation: 
scalar performance:
{'acc': 0.7204969, 'precision': 0.7285317, 'recall': 0.7191183, 'specificity': 0.7191183, 'f1': 0.71715516, 'auroc': 0.8026335, 'binary_precision': 0.7680312, 'binary_recall': 0.62047243, 'binary_specificity': 0.81776416, 'binary_f1_score': 0.68641114}
confusion matrix:
     0    1
0  534  119
1  241  394
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.74883723, 'precision': 0.75521976, 'recall': 0.74883723, 'specificity': 0.74883723, 'f1': 0.7472571, 'auroc': 0.8372958, 'binary_precision': 0.7955801, 'binary_recall': 0.66976744, 'binary_specificity': 0.82790697, 'binary_f1_score': 0.72727275}
confusion matrix:
     0    1
0  178   37
1   71  144
new oracle model saved
better model found
persisted
after epoch: 21,now: 2024-07-20 14:50:24.330046,epoch time: 0:00:59.475433,used: 0:20:46.945249,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_14_29_37_seed_0_22504811
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.91503906, 'precision': 0.920465, 'recall': 0.91580045, 'specificity': 0.91580045, 'f1': 0.9148545, 'auroc': 0.96362734, 'binary_precision': 0.97159505, 'binary_recall': 0.8573265, 'binary_specificity': 0.9742744, 'binary_f1_score': 0.9108911}
confusion matrix:
      0     1
0  1477    39
1   222  1334
---- Validation: 
scalar performance:
{'acc': 0.7243789, 'precision': 0.7316206, 'recall': 0.72307706, 'specificity': 0.72307706, 'f1': 0.72140837, 'auroc': 0.8060677, 'binary_precision': 0.7692308, 'binary_recall': 0.62992126, 'binary_specificity': 0.8162328, 'binary_f1_score': 0.6926407}
confusion matrix:
     0    1
0  533  120
1  235  400
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.75813955, 'precision': 0.76398754, 'recall': 0.75813955, 'specificity': 0.75813955, 'f1': 0.7567926, 'auroc': 0.8423797, 'binary_precision': 0.8032787, 'binary_recall': 0.68372095, 'binary_specificity': 0.83255816, 'binary_f1_score': 0.7386935}
confusion matrix:
     0    1
0  179   36
1   68  147
new oracle model saved
better model found
persisted
after epoch: 22,now: 2024-07-20 14:51:23.049258,epoch time: 0:00:58.719212,used: 0:21:45.664461,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_14_29_37_seed_0_22504811
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.9046224, 'precision': 0.91176856, 'recall': 0.9055438, 'specificity': 0.9055438, 'f1': 0.9043328, 'auroc': 0.96237755, 'binary_precision': 0.9695394, 'binary_recall': 0.83815026, 'binary_specificity': 0.9729373, 'binary_f1_score': 0.8990699}
confusion matrix:
      0     1
0  1474    41
1   252  1305
---- Validation: 
scalar performance:
{'acc': 0.7290373, 'precision': 0.7367322, 'recall': 0.72771466, 'specificity': 0.72771466, 'f1': 0.7260274, 'auroc': 0.8083998, 'binary_precision': 0.7760618, 'binary_recall': 0.6330709, 'binary_specificity': 0.82235837, 'binary_f1_score': 0.69731134}
confusion matrix:
     0    1
0  537  116
1  233  402
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.76046515, 'precision': 0.76529175, 'recall': 0.76046515, 'specificity': 0.76046515, 'f1': 0.75937057, 'auroc': 0.8454732, 'binary_precision': 0.8010753, 'binary_recall': 0.69302326, 'binary_specificity': 0.82790697, 'binary_f1_score': 0.7431421}
confusion matrix:
     0    1
0  178   37
1   66  149
new oracle model saved
better model found
persisted
after epoch: 23,now: 2024-07-20 14:52:22.026692,epoch time: 0:00:58.977434,used: 0:22:44.641895,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_14_29_37_seed_0_22504811
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9078776, 'precision': 0.9130449, 'recall': 0.90870273, 'specificity': 0.90870273, 'f1': 0.90769404, 'auroc': 0.9645919, 'binary_precision': 0.962963, 'binary_recall': 0.85109115, 'binary_specificity': 0.9663144, 'binary_f1_score': 0.90357757}
confusion matrix:
      0     1
0  1463    51
1   232  1326
---- Validation: 
scalar performance:
{'acc': 0.73524845, 'precision': 0.73913044, 'recall': 0.73429596, 'specificity': 0.73429596, 'f1': 0.7336104, 'auroc': 0.81160605, 'binary_precision': 0.7663044, 'binary_recall': 0.66614175, 'binary_specificity': 0.80245024, 'binary_f1_score': 0.71272117}
confusion matrix:
     0    1
0  524  129
1  212  423
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.772093, 'precision': 0.77401364, 'recall': 0.772093, 'specificity': 0.772093, 'f1': 0.771693, 'auroc': 0.84936726, 'binary_precision': 0.79695433, 'binary_recall': 0.73023254, 'binary_specificity': 0.81395346, 'binary_f1_score': 0.7621359}
confusion matrix:
     0    1
0  175   40
1   58  157
new oracle model saved
better model found
persisted
after epoch: 24,now: 2024-07-20 14:53:20.942937,epoch time: 0:00:58.916245,used: 0:23:43.558140,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_14_29_37_seed_0_22504811
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.91276044, 'precision': 0.91712296, 'recall': 0.913483, 'specificity': 0.913483, 'f1': 0.91261804, 'auroc': 0.96588516, 'binary_precision': 0.96333575, 'binary_recall': 0.86062944, 'binary_specificity': 0.9663366, 'binary_f1_score': 0.90909094}
confusion matrix:
      0     1
0  1464    51
1   217  1340
---- Validation: 
scalar performance:
{'acc': 0.7554348, 'precision': 0.7560682, 'recall': 0.7550289, 'specificity': 0.7550289, 'f1': 0.7550508, 'auroc': 0.8170093, 'binary_precision': 0.76578075, 'binary_recall': 0.7259843, 'binary_specificity': 0.78407353, 'binary_f1_score': 0.74535173}
confusion matrix:
     0    1
0  512  141
1  174  461
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7790698, 'precision': 0.7793659, 'recall': 0.7790698, 'specificity': 0.7790698, 'f1': 0.77901125, 'auroc': 0.8532828, 'binary_precision': 0.78846157, 'binary_recall': 0.7627907, 'binary_specificity': 0.7953488, 'binary_f1_score': 0.7754137}
confusion matrix:
     0    1
0  171   44
1   51  164
new oracle model saved
better model found
persisted
after epoch: 25,now: 2024-07-20 14:54:19.723999,epoch time: 0:00:58.781062,used: 0:24:42.339202,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_14_29_37_seed_0_22504811
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.91796875, 'precision': 0.9216658, 'recall': 0.9185683, 'specificity': 0.9185683, 'f1': 0.9178556, 'auroc': 0.9702171, 'binary_precision': 0.9643621, 'binary_recall': 0.87009645, 'binary_specificity': 0.9670402, 'binary_f1_score': 0.91480726}
confusion matrix:
      0     1
0  1467    50
1   202  1353
---- Validation: 
scalar performance:
{'acc': 0.76086956, 'precision': 0.7610843, 'recall': 0.7606058, 'specificity': 0.7606058, 'f1': 0.76066124, 'auroc': 0.82183504, 'binary_precision': 0.76585364, 'binary_recall': 0.7417323, 'binary_specificity': 0.7794793, 'binary_f1_score': 0.75359994}
confusion matrix:
     0    1
0  509  144
1  164  471
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7813954, 'precision': 0.7817855, 'recall': 0.7813953, 'specificity': 0.7813953, 'f1': 0.7813196, 'auroc': 0.8574581, 'binary_precision': 0.79227054, 'binary_recall': 0.7627907, 'binary_specificity': 0.8, 'binary_f1_score': 0.7772511}
confusion matrix:
     0    1
0  172   43
1   51  164
new oracle model saved
better model found
persisted
after epoch: 26,now: 2024-07-20 14:55:19.027933,epoch time: 0:00:59.303934,used: 0:25:41.643136,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_14_29_37_seed_0_22504811
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.9108073, 'precision': 0.9160954, 'recall': 0.91160077, 'specificity': 0.91160077, 'f1': 0.91062164, 'auroc': 0.9678441, 'binary_precision': 0.96654546, 'binary_recall': 0.85356456, 'binary_specificity': 0.969637, 'binary_f1_score': 0.9065484}
confusion matrix:
      0     1
0  1469    46
1   228  1329
---- Validation: 
scalar performance:
{'acc': 0.76009315, 'precision': 0.76066476, 'recall': 0.7597099, 'specificity': 0.7597099, 'f1': 0.7597455, 'auroc': 0.8255899, 'binary_precision': 0.76986754, 'binary_recall': 0.7322835, 'binary_specificity': 0.7871363, 'binary_f1_score': 0.75060534}
confusion matrix:
     0    1
0  514  139
1  170  465
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7860465, 'precision': 0.78614557, 'recall': 0.7860465, 'specificity': 0.7860465, 'f1': 0.786028, 'auroc': 0.8613521, 'binary_precision': 0.7914692, 'binary_recall': 0.7767442, 'binary_specificity': 0.7953488, 'binary_f1_score': 0.78403753}
confusion matrix:
     0    1
0  171   44
1   48  167
new oracle model saved
early stop counter: 1
val acc:0.7600931525230408, best validation acc: 0.760869562625885, corresponding to test acc:                         0.7813953757286072 / 0.7860465049743652
after epoch: 27,now: 2024-07-20 14:56:18.247073,epoch time: 0:00:59.219140,used: 0:26:40.862276,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_14_29_37_seed_0_22504811
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.9163411, 'precision': 0.9197263, 'recall': 0.91697985, 'specificity': 0.91697985, 'f1': 0.9162433, 'auroc': 0.9703182, 'binary_precision': 0.96099293, 'binary_recall': 0.87026334, 'binary_specificity': 0.96369636, 'binary_f1_score': 0.91338056}
confusion matrix:
      0     1
0  1460    55
1   202  1355
---- Validation: 
scalar performance:
{'acc': 0.77018636, 'precision': 0.7701901, 'recall': 0.7700546, 'specificity': 0.7700546, 'f1': 0.7700926, 'auroc': 0.82788825, 'binary_precision': 0.7703349, 'binary_recall': 0.7606299, 'binary_specificity': 0.7794793, 'binary_f1_score': 0.7654516}
confusion matrix:
     0    1
0  509  144
1  152  483
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7883721, 'precision': 0.78837836, 'recall': 0.7883721, 'specificity': 0.7883721, 'f1': 0.78837097, 'auroc': 0.8639914, 'binary_precision': 0.78971964, 'binary_recall': 0.7860465, 'binary_specificity': 0.7906977, 'binary_f1_score': 0.7878789}
confusion matrix:
     0    1
0  170   45
1   46  169
new oracle model saved
better model found
persisted
after epoch: 28,now: 2024-07-20 14:57:17.136456,epoch time: 0:00:58.889383,used: 0:27:39.751659,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_14_29_37_seed_0_22504811
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.91276044, 'precision': 0.9179739, 'recall': 0.91350865, 'specificity': 0.91350865, 'f1': 0.9125788, 'auroc': 0.9674958, 'binary_precision': 0.96802324, 'binary_recall': 0.85604113, 'binary_specificity': 0.97097623, 'binary_f1_score': 0.9085948}
confusion matrix:
      0     1
0  1472    44
1   224  1332
---- Validation: 
scalar performance:
{'acc': 0.75931674, 'precision': 0.76009846, 'recall': 0.75887907, 'specificity': 0.75887907, 'f1': 0.758893, 'auroc': 0.82956433, 'binary_precision': 0.7712855, 'binary_recall': 0.72755903, 'binary_specificity': 0.7901991, 'binary_f1_score': 0.7487845}
confusion matrix:
     0    1
0  516  137
1  173  462
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7953488, 'precision': 0.7954511, 'recall': 0.7953488, 'specificity': 0.7953488, 'f1': 0.7953311, 'auroc': 0.86596, 'binary_precision': 0.80094784, 'binary_recall': 0.7860465, 'binary_specificity': 0.80465114, 'binary_f1_score': 0.79342717}
confusion matrix:
     0    1
0  173   42
1   46  169
new oracle model saved
early stop counter: 1
val acc:0.7593167424201965, best validation acc: 0.7701863646507263, corresponding to test acc:                         0.7883720993995667 / 0.7953488230705261
after epoch: 29,now: 2024-07-20 14:58:15.630951,epoch time: 0:00:58.494495,used: 0:28:38.246154,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_14_29_37_seed_0_22504811
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.9202474, 'precision': 0.9255773, 'recall': 0.92103815, 'specificity': 0.92103815, 'f1': 0.92008376, 'auroc': 0.9750323, 'binary_precision': 0.9767442, 'binary_recall': 0.86319846, 'binary_specificity': 0.9788779, 'binary_f1_score': 0.9164678}
confusion matrix:
      0     1
0  1483    32
1   213  1344
---- Validation: 
scalar performance:
{'acc': 0.7670807, 'precision': 0.7701067, 'recall': 0.7662973, 'specificity': 0.7662973, 'f1': 0.7660377, 'auroc': 0.83150566, 'binary_precision': 0.79541445, 'binary_recall': 0.7102362, 'binary_specificity': 0.82235837, 'binary_f1_score': 0.7504159}
confusion matrix:
     0    1
0  537  116
1  184  451
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7906977, 'precision': 0.79110074, 'recall': 0.7906977, 'specificity': 0.7906977, 'f1': 0.7906252, 'auroc': 0.8681233, 'binary_precision': 0.8019324, 'binary_recall': 0.772093, 'binary_specificity': 0.80930233, 'binary_f1_score': 0.7867298}
confusion matrix:
     0    1
0  174   41
1   49  166
early stop counter: 2
val acc:0.7670807242393494, best validation acc: 0.7701863646507263, corresponding to test acc:                         0.7883720993995667 / 0.7953488230705261
after epoch: 30,now: 2024-07-20 14:59:14.273511,epoch time: 0:00:58.642560,used: 0:29:36.888714,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_14_29_37_seed_0_22504811
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 0:29:36.888714 at 2024-07-20 14:59:14.273511
persisted model performance metric: 

scalar performance:
{'acc': 0.7883721, 'precision': 0.78837836, 'recall': 0.7883721, 'specificity': 0.7883721, 'f1': 0.78837097, 'auroc': 0.8639914, 'binary_precision': 0.78971964, 'binary_recall': 0.7860465, 'binary_specificity': 0.7906977, 'binary_f1_score': 0.7878789}
confusion matrix:
     0    1
0  170   45
1   46  169
oracle model performance metric: 

scalar performance:
{'acc': 0.7953488, 'precision': 0.7954511, 'recall': 0.7953488, 'specificity': 0.7953488, 'f1': 0.7953311, 'auroc': 0.86596, 'binary_precision': 0.80094784, 'binary_recall': 0.7860465, 'binary_specificity': 0.80465114, 'binary_f1_score': 0.79342717}
confusion matrix:
     0    1
0  173   42
1   46  169
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_halffreezeblocks_2024-07-20_12-47-21/rule_results/1.csv
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_halffreezeblocks_2024-07-20_12-47-21/rule_results/1.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_halffreezeblocks_2024-07-20_12-47-21/confusion_matrix/1.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 197058 KiB |   7828 MiB |  61332 GiB |  61332 GiB |
|       from large pool | 180662 KiB |   7805 MiB |  60516 GiB |  60516 GiB |
|       from small pool |  16396 KiB |     32 MiB |    815 GiB |    815 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 197058 KiB |   7828 MiB |  61332 GiB |  61332 GiB |
|       from large pool | 180662 KiB |   7805 MiB |  60516 GiB |  60516 GiB |
|       from small pool |  16396 KiB |     32 MiB |    815 GiB |    815 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 195188 KiB |   7827 MiB |  61327 GiB |  61327 GiB |
|       from large pool | 178979 KiB |   7804 MiB |  60513 GiB |  60513 GiB |
|       from small pool |  16209 KiB |     32 MiB |    813 GiB |    813 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   8524 MiB |   8524 MiB |   8524 MiB |      0 B   |
|       from large pool |   8486 MiB |   8486 MiB |   8486 MiB |      0 B   |
|       from small pool |     38 MiB |     38 MiB |     38 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |  58942 KiB | 732464 KiB |  34525 GiB |  34525 GiB |
|       from large pool |  50762 KiB | 730714 KiB |  33708 GiB |  33708 GiB |
|       from small pool |   8180 KiB |  10132 KiB |    817 GiB |    817 GiB |
|---------------------------------------------------------------------------|
| Allocations           |     788    |    1675    |   10388 K  |   10387 K  |
|       from large pool |      79    |     762    |    5637 K  |    5637 K  |
|       from small pool |     709    |    1005    |    4750 K  |    4749 K  |
|---------------------------------------------------------------------------|
| Active allocs         |     788    |    1675    |   10388 K  |   10387 K  |
|       from large pool |      79    |     762    |    5637 K  |    5637 K  |
|       from small pool |     709    |    1005    |    4750 K  |    4749 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     368    |     368    |     368    |       0    |
|       from large pool |     349    |     349    |     349    |       0    |
|       from small pool |      19    |      19    |      19    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      42    |     380    |    6463 K  |    6463 K  |
|       from large pool |      10    |     350    |    4321 K  |    4321 K  |
|       from small pool |      32    |     215    |    2141 K  |    2141 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   7828 MiB |  61332 GiB |  61332 GiB |
|       from large pool |  16640 KiB |   7805 MiB |  60516 GiB |  60516 GiB |
|       from small pool |      0 KiB |     32 MiB |    815 GiB |    815 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   7828 MiB |  61332 GiB |  61332 GiB |
|       from large pool |  16640 KiB |   7805 MiB |  60516 GiB |  60516 GiB |
|       from small pool |      0 KiB |     32 MiB |    815 GiB |    815 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   7827 MiB |  61327 GiB |  61327 GiB |
|       from large pool |  16640 KiB |   7804 MiB |  60513 GiB |  60513 GiB |
|       from small pool |      0 KiB |     32 MiB |    813 GiB |    813 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 256000 KiB |   8524 MiB |   8524 MiB |   8274 MiB |
|       from large pool | 231424 KiB |   8486 MiB |   8486 MiB |   8260 MiB |
|       from small pool |  24576 KiB |     38 MiB |     38 MiB |     14 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  30464 KiB | 732464 KiB |  34525 GiB |  34525 GiB |
|       from large pool |  30464 KiB | 730714 KiB |  33708 GiB |  33708 GiB |
|       from small pool |      0 KiB |  22319 KiB |    817 GiB |    817 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    1675    |   10388 K  |   10388 K  |
|       from large pool |       2    |     762    |    5637 K  |    5637 K  |
|       from small pool |       0    |    1005    |    4750 K  |    4750 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    1675    |   10388 K  |   10388 K  |
|       from large pool |       2    |     762    |    5637 K  |    5637 K  |
|       from small pool |       0    |    1005    |    4750 K  |    4750 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      23    |     368    |     368    |     345    |
|       from large pool |      11    |     349    |     349    |     338    |
|       from small pool |      12    |      19    |      19    |       7    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     380    |    6463 K  |    6463 K  |
|       from large pool |       3    |     350    |    4321 K  |    4321 K  |
|       from small pool |       0    |     215    |    2141 K  |    2141 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   7828 MiB |  61332 GiB |  61332 GiB |
|       from large pool |  16640 KiB |   7805 MiB |  60516 GiB |  60516 GiB |
|       from small pool |      0 KiB |     32 MiB |    815 GiB |    815 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   7828 MiB |  61332 GiB |  61332 GiB |
|       from large pool |  16640 KiB |   7805 MiB |  60516 GiB |  60516 GiB |
|       from small pool |      0 KiB |     32 MiB |    815 GiB |    815 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   7827 MiB |  61327 GiB |  61327 GiB |
|       from large pool |  16640 KiB |   7804 MiB |  60513 GiB |  60513 GiB |
|       from small pool |      0 KiB |     32 MiB |    813 GiB |    813 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 256000 KiB |   8524 MiB |   8524 MiB |   8274 MiB |
|       from large pool | 231424 KiB |   8486 MiB |   8486 MiB |   8260 MiB |
|       from small pool |  24576 KiB |     38 MiB |     38 MiB |     14 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  30464 KiB | 732464 KiB |  34525 GiB |  34525 GiB |
|       from large pool |  30464 KiB | 730714 KiB |  33708 GiB |  33708 GiB |
|       from small pool |      0 KiB |  22319 KiB |    817 GiB |    817 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    1675    |   10388 K  |   10388 K  |
|       from large pool |       2    |     762    |    5637 K  |    5637 K  |
|       from small pool |       0    |    1005    |    4750 K  |    4750 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    1675    |   10388 K  |   10388 K  |
|       from large pool |       2    |     762    |    5637 K  |    5637 K  |
|       from small pool |       0    |    1005    |    4750 K  |    4750 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      23    |     368    |     368    |     345    |
|       from large pool |      11    |     349    |     349    |     338    |
|       from small pool |      12    |      19    |      19    |       7    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     380    |    6463 K  |    6463 K  |
|       from large pool |       3    |     350    |    4321 K  |    4321 K  |
|       from small pool |       0    |     215    |    2141 K  |    2141 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'888c1ef2'
model name: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_15_00_11_seed_1_22504811

 Experiment start at: 2024-07-20 15:00:11.093808
before training, model accuracy: 0.6177777647972107
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.54752606, 'precision': 0.5545018, 'recall': 0.545251, 'specificity': 0.545251, 'f1': 0.5263195, 'auroc': 0.520525, 'binary_precision': 0.53757495, 'binary_recall': 0.7508049, 'binary_specificity': 0.33969718, 'binary_f1_score': 0.62654483}
confusion matrix:
     0     1
0  516  1003
1  387  1166
---- Validation: 
scalar performance:
{'acc': 0.48946136, 'precision': 0.47250473, 'recall': 0.48412699, 'specificity': 0.48412699, 'f1': 0.42564404, 'auroc': 0.6234169, 'binary_precision': 0.44642857, 'binary_recall': 0.15873016, 'binary_specificity': 0.8095238, 'binary_f1_score': 0.23419204}
confusion matrix:
     0    1
0  527  124
1  530  100
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5688889, 'precision': 0.5867084, 'recall': 0.5688889, 'specificity': 0.5688889, 'f1': 0.54553974, 'auroc': 0.66931355, 'binary_precision': 0.62601626, 'binary_recall': 0.3422222, 'binary_specificity': 0.79555553, 'binary_f1_score': 0.44252875}
confusion matrix:
     0   1
0  179  46
1  148  77
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-20 15:01:13.655625,epoch time: 0:01:02.561817,used: 0:01:02.561817,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_15_00_11_seed_1_22504811
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.5777995, 'precision': 0.5781138, 'recall': 0.5772109, 'specificity': 0.5772109, 'f1': 0.576296, 'auroc': 0.59538317, 'binary_precision': 0.5752056, 'binary_recall': 0.6303928, 'binary_specificity': 0.52402896, 'binary_f1_score': 0.60153615}
confusion matrix:
     0    1
0  796  723
1  574  979
---- Validation: 
scalar performance:
{'acc': 0.47540984, 'precision': 0.41706464, 'recall': 0.4689196, 'specificity': 0.4689196, 'f1': 0.37333512, 'auroc': 0.62966865, 'binary_precision': 0.3432836, 'binary_recall': 0.073015876, 'binary_specificity': 0.86482334, 'binary_f1_score': 0.120418854}
confusion matrix:
     0   1
0  563  88
1  584  46
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.53555554, 'precision': 0.5728627, 'recall': 0.53555554, 'specificity': 0.53555554, 'f1': 0.4673772, 'auroc': 0.6778864, 'binary_precision': 0.625, 'binary_recall': 0.17777778, 'binary_specificity': 0.8933333, 'binary_f1_score': 0.2768166}
confusion matrix:
     0   1
0  201  24
1  185  40
early stop counter: 1
val acc:0.4754098355770111, best validation acc: 0.48946136236190796, corresponding to test acc:                         0.5688889026641846 / 0.5688889026641846
after epoch: 2,now: 2024-07-20 15:02:13.087965,epoch time: 0:00:59.432340,used: 0:02:01.994157,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_15_00_11_seed_1_22504811
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.6516927, 'precision': 0.6516569, 'recall': 0.65148103, 'specificity': 0.65148103, 'f1': 0.6514795, 'auroc': 0.6908028, 'binary_precision': 0.6526382, 'binary_recall': 0.6677378, 'binary_specificity': 0.6352243, 'binary_f1_score': 0.6601017}
confusion matrix:
     0     1
0  963   553
1  517  1039
---- Validation: 
scalar performance:
{'acc': 0.4800937, 'precision': 0.4241782, 'recall': 0.4734767, 'specificity': 0.4734767, 'f1': 0.37417403, 'auroc': 0.64568555, 'binary_precision': 0.3548387, 'binary_recall': 0.06984127, 'binary_specificity': 0.87711215, 'binary_f1_score': 0.11671088}
confusion matrix:
     0   1
0  571  80
1  586  44
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5288889, 'precision': 0.56528723, 'recall': 0.5288889, 'specificity': 0.5288889, 'f1': 0.45259243, 'auroc': 0.6939062, 'binary_precision': 0.61403507, 'binary_recall': 0.15555556, 'binary_specificity': 0.9022222, 'binary_f1_score': 0.24822696}
confusion matrix:
     0   1
0  203  22
1  190  35
early stop counter: 2
val acc:0.48009368777275085, best validation acc: 0.48946136236190796, corresponding to test acc:                         0.5688889026641846 / 0.5688889026641846
after epoch: 3,now: 2024-07-20 15:03:12.342242,epoch time: 0:00:59.254277,used: 0:03:01.248434,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_15_00_11_seed_1_22504811
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.7161458, 'precision': 0.71616733, 'recall': 0.7159503, 'specificity': 0.7159503, 'f1': 0.715981, 'auroc': 0.77583104, 'binary_precision': 0.71554434, 'binary_recall': 0.7302505, 'binary_specificity': 0.70165014, 'binary_f1_score': 0.72282267}
confusion matrix:
      0     1
0  1063   452
1   420  1137
---- Validation: 
scalar performance:
{'acc': 0.48868072, 'precision': 0.45601627, 'recall': 0.48233485, 'specificity': 0.48233485, 'f1': 0.39415133, 'auroc': 0.66459167, 'binary_precision': 0.41379312, 'binary_recall': 0.0952381, 'binary_specificity': 0.8694316, 'binary_f1_score': 0.15483871}
confusion matrix:
     0   1
0  566  85
1  570  60
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5311111, 'precision': 0.5673077, 'recall': 0.5311111, 'specificity': 0.5311111, 'f1': 0.45827985, 'auroc': 0.7165828, 'binary_precision': 0.6166667, 'binary_recall': 0.16444445, 'binary_specificity': 0.8977778, 'binary_f1_score': 0.25964913}
confusion matrix:
     0   1
0  202  23
1  188  37
early stop counter: 3
val acc:0.48868072032928467, best validation acc: 0.48946136236190796, corresponding to test acc:                         0.5688889026641846 / 0.5688889026641846
after epoch: 4,now: 2024-07-20 15:04:11.624801,epoch time: 0:00:59.282559,used: 0:04:00.530993,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_15_00_11_seed_1_22504811
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.75130206, 'precision': 0.7512603, 'recall': 0.7512684, 'specificity': 0.7512684, 'f1': 0.751264, 'auroc': 0.82421565, 'binary_precision': 0.75482625, 'binary_recall': 0.75385606, 'binary_specificity': 0.7486807, 'binary_f1_score': 0.7543409}
confusion matrix:
      0     1
0  1135   381
1   383  1173
---- Validation: 
scalar performance:
{'acc': 0.4964871, 'precision': 0.4761573, 'recall': 0.4901946, 'specificity': 0.4901946, 'f1': 0.4051328, 'auroc': 0.6823958, 'binary_precision': 0.44966444, 'binary_recall': 0.10634921, 'binary_specificity': 0.87403995, 'binary_f1_score': 0.17201541}
confusion matrix:
     0   1
0  569  82
1  563  67
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5466667, 'precision': 0.5968993, 'recall': 0.5466667, 'specificity': 0.5466667, 'f1': 0.47916663, 'auroc': 0.7315358, 'binary_precision': 0.6666667, 'binary_recall': 0.18666667, 'binary_specificity': 0.9066667, 'binary_f1_score': 0.29166666}
confusion matrix:
     0   1
0  204  21
1  183  42
better model found
persisted
after epoch: 5,now: 2024-07-20 15:05:11.388962,epoch time: 0:00:59.764161,used: 0:05:00.295154,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_15_00_11_seed_1_22504811
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.79036456, 'precision': 0.7903607, 'recall': 0.79040504, 'specificity': 0.79040504, 'f1': 0.7903557, 'auroc': 0.86058456, 'binary_precision': 0.79635656, 'binary_recall': 0.7871383, 'binary_specificity': 0.7936717, 'binary_f1_score': 0.79172057}
confusion matrix:
      0     1
0  1204   313
1   331  1224
---- Validation: 
scalar performance:
{'acc': 0.5113193, 'precision': 0.5123559, 'recall': 0.5049923, 'specificity': 0.5049923, 'f1': 0.4213975, 'auroc': 0.6965133, 'binary_precision': 0.51369864, 'binary_recall': 0.11904762, 'binary_specificity': 0.89093703, 'binary_f1_score': 0.19329897}
confusion matrix:
     0   1
0  580  71
1  555  75
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5422222, 'precision': 0.59265685, 'recall': 0.5422222, 'specificity': 0.5422222, 'f1': 0.47011614, 'auroc': 0.73898274, 'binary_precision': 0.66101694, 'binary_recall': 0.17333333, 'binary_specificity': 0.9111111, 'binary_f1_score': 0.27464786}
confusion matrix:
     0   1
0  205  20
1  186  39
better model found
persisted
after epoch: 6,now: 2024-07-20 15:06:11.477719,epoch time: 0:01:00.088757,used: 0:06:00.383911,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_15_00_11_seed_1_22504811
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.8141276, 'precision': 0.81540036, 'recall': 0.81453276, 'specificity': 0.81453276, 'f1': 0.81404936, 'auroc': 0.8862841, 'binary_precision': 0.8389539, 'binary_recall': 0.783419, 'binary_specificity': 0.84564644, 'binary_f1_score': 0.810236}
confusion matrix:
      0     1
0  1282   234
1   337  1219
---- Validation: 
scalar performance:
{'acc': 0.5120999, 'precision': 0.514567, 'recall': 0.5057092, 'specificity': 0.5057092, 'f1': 0.42019868, 'auroc': 0.7117542, 'binary_precision': 0.5177305, 'binary_recall': 0.11587302, 'binary_specificity': 0.8955453, 'binary_f1_score': 0.18936445}
confusion matrix:
     0   1
0  583  68
1  557  73
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5466667, 'precision': 0.6087457, 'recall': 0.5466667, 'specificity': 0.5466667, 'f1': 0.4711982, 'auroc': 0.7520988, 'binary_precision': 0.6909091, 'binary_recall': 0.16888888, 'binary_specificity': 0.92444444, 'binary_f1_score': 0.27142859}
confusion matrix:
     0   1
0  208  17
1  187  38
better model found
persisted
after epoch: 7,now: 2024-07-20 15:07:10.912651,epoch time: 0:00:59.434932,used: 0:06:59.818843,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_15_00_11_seed_1_22504811
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.83463544, 'precision': 0.83600664, 'recall': 0.83502895, 'specificity': 0.83502895, 'f1': 0.8345591, 'auroc': 0.9033364, 'binary_precision': 0.86078566, 'binary_recall': 0.80321544, 'binary_specificity': 0.86684245, 'binary_f1_score': 0.8310047}
confusion matrix:
      0     1
0  1315   202
1   306  1249
---- Validation: 
scalar performance:
{'acc': 0.52224827, 'precision': 0.5364909, 'recall': 0.516129, 'specificity': 0.516129, 'f1': 0.440755, 'auroc': 0.7240533, 'binary_precision': 0.5555556, 'binary_recall': 0.14285715, 'binary_specificity': 0.8894009, 'binary_f1_score': 0.22727275}
confusion matrix:
     0   1
0  579  72
1  540  90
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.55333334, 'precision': 0.6187544, 'recall': 0.55333334, 'specificity': 0.55333334, 'f1': 0.48199135, 'auroc': 0.7606321, 'binary_precision': 0.70689654, 'binary_recall': 0.18222222, 'binary_specificity': 0.92444444, 'binary_f1_score': 0.28975263}
confusion matrix:
     0   1
0  208  17
1  184  41
better model found
persisted
after epoch: 8,now: 2024-07-20 15:08:10.627750,epoch time: 0:00:59.715099,used: 0:07:59.533942,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_15_00_11_seed_1_22504811
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.84277344, 'precision': 0.8456895, 'recall': 0.84334135, 'specificity': 0.84334135, 'f1': 0.8425753, 'auroc': 0.9085927, 'binary_precision': 0.8806818, 'binary_recall': 0.79742765, 'binary_specificity': 0.8892551, 'binary_f1_score': 0.8369896}
confusion matrix:
      0     1
0  1349   168
1   315  1240
---- Validation: 
scalar performance:
{'acc': 0.51990634, 'precision': 0.53311837, 'recall': 0.5136201, 'specificity': 0.5136201, 'f1': 0.43280107, 'auroc': 0.73288405, 'binary_precision': 0.5503356, 'binary_recall': 0.13015874, 'binary_specificity': 0.89708143, 'binary_f1_score': 0.21052633}
confusion matrix:
     0   1
0  584  67
1  548  82
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.54888886, 'precision': 0.6195883, 'recall': 0.5488889, 'specificity': 0.5488889, 'f1': 0.47065264, 'auroc': 0.7675654, 'binary_precision': 0.71153843, 'binary_recall': 0.16444445, 'binary_specificity': 0.93333334, 'binary_f1_score': 0.26714802}
confusion matrix:
     0   1
0  210  15
1  188  37
early stop counter: 1
val acc:0.5199063420295715, best validation acc: 0.5222482681274414, corresponding to test acc:                         0.5533333420753479 / 0.5688889026641846
after epoch: 9,now: 2024-07-20 15:09:10.102908,epoch time: 0:00:59.475158,used: 0:08:59.009100,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_15_00_11_seed_1_22504811
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.84244794, 'precision': 0.8458992, 'recall': 0.8431307, 'specificity': 0.8431307, 'f1': 0.8422152, 'auroc': 0.90983164, 'binary_precision': 0.8840372, 'binary_recall': 0.793192, 'binary_specificity': 0.8930693, 'binary_f1_score': 0.8361544}
confusion matrix:
      0     1
0  1353   162
1   322  1235
---- Validation: 
scalar performance:
{'acc': 0.520687, 'precision': 0.535547, 'recall': 0.5143625, 'specificity': 0.5143625, 'f1': 0.43248895, 'auroc': 0.74148685, 'binary_precision': 0.55479455, 'binary_recall': 0.12857144, 'binary_specificity': 0.90015364, 'binary_f1_score': 0.2087629}
confusion matrix:
     0   1
0  586  65
1  549  81
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5555556, 'precision': 0.6336676, 'recall': 0.5555555, 'specificity': 0.5555555, 'f1': 0.4795161, 'auroc': 0.7813531, 'binary_precision': 0.7358491, 'binary_recall': 0.17333333, 'binary_specificity': 0.93777776, 'binary_f1_score': 0.28057554}
confusion matrix:
     0   1
0  211  14
1  186  39
early stop counter: 2
val acc:0.5206869840621948, best validation acc: 0.5222482681274414, corresponding to test acc:                         0.5533333420753479 / 0.5688889026641846
after epoch: 10,now: 2024-07-20 15:10:09.919766,epoch time: 0:00:59.816858,used: 0:09:58.825958,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_15_00_11_seed_1_22504811
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.851237, 'precision': 0.85512996, 'recall': 0.85188675, 'specificity': 0.85188675, 'f1': 0.8509742, 'auroc': 0.91905713, 'binary_precision': 0.89553314, 'binary_recall': 0.79935694, 'binary_specificity': 0.9044166, 'binary_f1_score': 0.84471637}
confusion matrix:
      0     1
0  1372   145
1   312  1243
---- Validation: 
scalar performance:
{'acc': 0.5253708, 'precision': 0.54617155, 'recall': 0.5190988, 'specificity': 0.5190988, 'f1': 0.4396616, 'auroc': 0.7486431, 'binary_precision': 0.5733333, 'binary_recall': 0.13650794, 'binary_specificity': 0.9016897, 'binary_f1_score': 0.22051282}
confusion matrix:
     0   1
0  587  64
1  544  86
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.56222224, 'precision': 0.6427665, 'recall': 0.56222224, 'specificity': 0.56222224, 'f1': 0.4903386, 'auroc': 0.78955066, 'binary_precision': 0.75, 'binary_recall': 0.18666667, 'binary_specificity': 0.93777776, 'binary_f1_score': 0.29893237}
confusion matrix:
     0   1
0  211  14
1  183  42
better model found
persisted
after epoch: 11,now: 2024-07-20 15:11:10.147049,epoch time: 0:01:00.227283,used: 0:10:59.053241,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_15_00_11_seed_1_22504811
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.8766276, 'precision': 0.87875175, 'recall': 0.8771521, 'specificity': 0.8771521, 'f1': 0.87654173, 'auroc': 0.9312272, 'binary_precision': 0.9107392, 'binary_recall': 0.83879256, 'binary_specificity': 0.91551155, 'binary_f1_score': 0.87328655}
confusion matrix:
      0     1
0  1387   128
1   251  1306
---- Validation: 
scalar performance:
{'acc': 0.54566747, 'precision': 0.579612, 'recall': 0.53988737, 'specificity': 0.53988737, 'f1': 0.4773965, 'auroc': 0.75512886, 'binary_precision': 0.62765956, 'binary_recall': 0.18730159, 'binary_specificity': 0.8924731, 'binary_f1_score': 0.28850856}
confusion matrix:
     0    1
0  581   70
1  512  118
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5711111, 'precision': 0.6420455, 'recall': 0.5711111, 'specificity': 0.5711111, 'f1': 0.5099284, 'auroc': 0.7976494, 'binary_precision': 0.74242425, 'binary_recall': 0.21777777, 'binary_specificity': 0.92444444, 'binary_f1_score': 0.33676976}
confusion matrix:
     0   1
0  208  17
1  176  49
new oracle model saved
better model found
persisted
after epoch: 12,now: 2024-07-20 15:12:09.758660,epoch time: 0:00:59.611611,used: 0:11:58.664852,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_15_00_11_seed_1_22504811
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.8802083, 'precision': 0.882637, 'recall': 0.8807391, 'specificity': 0.8807391, 'f1': 0.88010544, 'auroc': 0.9370074, 'binary_precision': 0.9165498, 'binary_recall': 0.8399743, 'binary_specificity': 0.92150396, 'binary_f1_score': 0.8765929}
confusion matrix:
      0     1
0  1397   119
1   249  1307
---- Validation: 
scalar performance:
{'acc': 0.5448868, 'precision': 0.5803716, 'recall': 0.5390169, 'specificity': 0.5390169, 'f1': 0.47409087, 'auroc': 0.75888133, 'binary_precision': 0.62983423, 'binary_recall': 0.18095239, 'binary_specificity': 0.89708143, 'binary_f1_score': 0.2811344}
confusion matrix:
     0    1
0  584   67
1  516  114
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5688889, 'precision': 0.64304173, 'recall': 0.5688889, 'specificity': 0.5688889, 'f1': 0.5046977, 'auroc': 0.801916, 'binary_precision': 0.74603176, 'binary_recall': 0.20888889, 'binary_specificity': 0.9288889, 'binary_f1_score': 0.3263889}
confusion matrix:
     0   1
0  209  16
1  178  47
early stop counter: 1
val acc:0.5448868274688721, best validation acc: 0.5456674695014954, corresponding to test acc:                         0.5711110830307007 / 0.5711110830307007
after epoch: 13,now: 2024-07-20 15:13:09.068155,epoch time: 0:00:59.309495,used: 0:12:57.974347,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_15_00_11_seed_1_22504811
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.8808594, 'precision': 0.88633615, 'recall': 0.88160634, 'specificity': 0.88160634, 'f1': 0.880567, 'auroc': 0.93446743, 'binary_precision': 0.93553114, 'binary_recall': 0.8212219, 'binary_specificity': 0.9419908, 'binary_f1_score': 0.8746576}
confusion matrix:
      0     1
0  1429    88
1   278  1277
---- Validation: 
scalar performance:
{'acc': 0.54879, 'precision': 0.5851488, 'recall': 0.54303634, 'specificity': 0.54303634, 'f1': 0.4816597, 'auroc': 0.7643357, 'binary_precision': 0.63684213, 'binary_recall': 0.1920635, 'binary_specificity': 0.89400923, 'binary_f1_score': 0.29512194}
confusion matrix:
     0    1
0  582   69
1  509  121
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5688889, 'precision': 0.64304173, 'recall': 0.5688889, 'specificity': 0.5688889, 'f1': 0.5046977, 'auroc': 0.80630124, 'binary_precision': 0.74603176, 'binary_recall': 0.20888889, 'binary_specificity': 0.9288889, 'binary_f1_score': 0.3263889}
confusion matrix:
     0   1
0  209  16
1  178  47
better model found
persisted
after epoch: 14,now: 2024-07-20 15:14:08.884492,epoch time: 0:00:59.816337,used: 0:13:57.790684,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_15_00_11_seed_1_22504811
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.88639325, 'precision': 0.8925344, 'recall': 0.8871368, 'specificity': 0.8871368, 'f1': 0.88607246, 'auroc': 0.94159025, 'binary_precision': 0.94464946, 'binary_recall': 0.8236808, 'binary_specificity': 0.9505929, 'binary_f1_score': 0.8800275}
confusion matrix:
      0     1
0  1443    75
1   274  1280
---- Validation: 
scalar performance:
{'acc': 0.5464481, 'precision': 0.5899234, 'recall': 0.5403738, 'specificity': 0.5403738, 'f1': 0.47018823, 'auroc': 0.76851726, 'binary_precision': 0.6484848, 'binary_recall': 0.16984127, 'binary_specificity': 0.9109063, 'binary_f1_score': 0.26918238}
confusion matrix:
     0    1
0  593   58
1  523  107
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.56666666, 'precision': 0.648443, 'recall': 0.56666666, 'specificity': 0.56666666, 'f1': 0.49745435, 'auroc': 0.8085333, 'binary_precision': 0.7586207, 'binary_recall': 0.19555555, 'binary_specificity': 0.93777776, 'binary_f1_score': 0.31095406}
confusion matrix:
     0   1
0  211  14
1  181  44
early stop counter: 1
val acc:0.5464481115341187, best validation acc: 0.5487899780273438, corresponding to test acc:                         0.5688889026641846 / 0.5711110830307007
after epoch: 15,now: 2024-07-20 15:15:08.559630,epoch time: 0:00:59.675138,used: 0:14:57.465822,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_15_00_11_seed_1_22504811
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.8955078, 'precision': 0.8993895, 'recall': 0.8961321, 'specificity': 0.8961321, 'f1': 0.89534545, 'auroc': 0.94708586, 'binary_precision': 0.9419771, 'binary_recall': 0.84565914, 'binary_specificity': 0.94660515, 'binary_f1_score': 0.89122325}
confusion matrix:
      0     1
0  1436    81
1   240  1315
---- Validation: 
scalar performance:
{'acc': 0.5581577, 'precision': 0.6028466, 'recall': 0.5524322, 'specificity': 0.5524322, 'f1': 0.4930741, 'auroc': 0.771865, 'binary_precision': 0.6666667, 'binary_recall': 0.2031746, 'binary_specificity': 0.9016897, 'binary_f1_score': 0.31143552}
confusion matrix:
     0    1
0  587   64
1  502  128
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5711111, 'precision': 0.6385895, 'recall': 0.57111114, 'specificity': 0.57111114, 'f1': 0.5116699, 'auroc': 0.8116149, 'binary_precision': 0.7352941, 'binary_recall': 0.22222222, 'binary_specificity': 0.92, 'binary_f1_score': 0.34129694}
confusion matrix:
     0   1
0  207  18
1  175  50
better model found
persisted
after epoch: 16,now: 2024-07-20 15:16:08.545725,epoch time: 0:00:59.986095,used: 0:15:57.451917,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_15_00_11_seed_1_22504811
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.8883464, 'precision': 0.89111155, 'recall': 0.8889082, 'specificity': 0.8889082, 'f1': 0.8882349, 'auroc': 0.9469074, 'binary_precision': 0.92741364, 'binary_recall': 0.8457584, 'binary_specificity': 0.93205804, 'binary_f1_score': 0.8847059}
confusion matrix:
      0     1
0  1413   103
1   240  1316
---- Validation: 
scalar performance:
{'acc': 0.57220924, 'precision': 0.61992747, 'recall': 0.56676906, 'specificity': 0.56676906, 'f1': 0.5158677, 'auroc': 0.7756882, 'binary_precision': 0.69158876, 'binary_recall': 0.23492064, 'binary_specificity': 0.8986175, 'binary_f1_score': 0.35071093}
confusion matrix:
     0    1
0  585   66
1  482  148
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.58666664, 'precision': 0.6527628, 'recall': 0.58666664, 'specificity': 0.58666664, 'f1': 0.5365346, 'auroc': 0.8179358, 'binary_precision': 0.7532467, 'binary_recall': 0.25777778, 'binary_specificity': 0.91555554, 'binary_f1_score': 0.38410598}
confusion matrix:
     0   1
0  206  19
1  167  58
new oracle model saved
better model found
persisted
after epoch: 17,now: 2024-07-20 15:17:08.141855,epoch time: 0:00:59.596130,used: 0:16:57.048047,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_15_00_11_seed_1_22504811
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.8909505, 'precision': 0.89575064, 'recall': 0.8916824, 'specificity': 0.8916824, 'f1': 0.89073324, 'auroc': 0.9494641, 'binary_precision': 0.9427121, 'binary_recall': 0.83547556, 'binary_specificity': 0.9478892, 'binary_f1_score': 0.8858603}
confusion matrix:
      0     1
0  1437    79
1   256  1300
---- Validation: 
scalar performance:
{'acc': 0.568306, 'precision': 0.6193769, 'recall': 0.5626728, 'specificity': 0.5626728, 'f1': 0.5069157, 'auroc': 0.7791871, 'binary_precision': 0.6934673, 'binary_recall': 0.21904762, 'binary_specificity': 0.906298, 'binary_f1_score': 0.33293125}
confusion matrix:
     0    1
0  590   61
1  492  138
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.57555556, 'precision': 0.6405423, 'recall': 0.57555556, 'specificity': 0.57555556, 'f1': 0.5200764, 'auroc': 0.81989133, 'binary_precision': 0.7361111, 'binary_recall': 0.23555556, 'binary_specificity': 0.91555554, 'binary_f1_score': 0.35690236}
confusion matrix:
     0   1
0  206  19
1  172  53
early stop counter: 1
val acc:0.568306028842926, best validation acc: 0.5722092390060425, corresponding to test acc:                         0.5866666436195374 / 0.5866666436195374
after epoch: 18,now: 2024-07-20 15:18:07.253355,epoch time: 0:00:59.111500,used: 0:17:56.159547,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_15_00_11_seed_1_22504811
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.8964844, 'precision': 0.9005929, 'recall': 0.89719504, 'specificity': 0.89719504, 'f1': 0.8963208, 'auroc': 0.9476479, 'binary_precision': 0.9447236, 'binary_recall': 0.84521514, 'binary_specificity': 0.94917494, 'binary_f1_score': 0.8922034}
confusion matrix:
      0     1
0  1438    77
1   241  1316
---- Validation: 
scalar performance:
{'acc': 0.57923496, 'precision': 0.6320804, 'recall': 0.5738095, 'specificity': 0.5738095, 'f1': 0.5241053, 'auroc': 0.78324676, 'binary_precision': 0.7116279, 'binary_recall': 0.24285714, 'binary_specificity': 0.9047619, 'binary_f1_score': 0.36213017}
confusion matrix:
     0    1
0  589   62
1  477  153
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.58444446, 'precision': 0.6536443, 'recall': 0.58444446, 'specificity': 0.58444446, 'f1': 0.53171694, 'auroc': 0.8235457, 'binary_precision': 0.7567568, 'binary_recall': 0.2488889, 'binary_specificity': 0.92, 'binary_f1_score': 0.37458196}
confusion matrix:
     0   1
0  207  18
1  169  56
better model found
persisted
after epoch: 19,now: 2024-07-20 15:19:06.444502,epoch time: 0:00:59.191147,used: 0:18:55.350694,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_15_00_11_seed_1_22504811
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.89973956, 'precision': 0.90562785, 'recall': 0.9006237, 'specificity': 0.9006237, 'f1': 0.8995, 'auroc': 0.95168316, 'binary_precision': 0.9582111, 'binary_recall': 0.83889604, 'binary_specificity': 0.9623514, 'binary_f1_score': 0.8945927}
confusion matrix:
      0     1
0  1457    57
1   251  1307
---- Validation: 
scalar performance:
{'acc': 0.58313817, 'precision': 0.63956285, 'recall': 0.577701, 'specificity': 0.577701, 'f1': 0.52823603, 'auroc': 0.78767467, 'binary_precision': 0.7242991, 'binary_recall': 0.24603175, 'binary_specificity': 0.9093702, 'binary_f1_score': 0.36729857}
confusion matrix:
     0    1
0  592   59
1  475  155
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.58666664, 'precision': 0.656, 'recall': 0.5866667, 'specificity': 0.5866667, 'f1': 0.53499997, 'auroc': 0.82741725, 'binary_precision': 0.76, 'binary_recall': 0.25333333, 'binary_specificity': 0.92, 'binary_f1_score': 0.38}
confusion matrix:
     0   1
0  207  18
1  168  57
better model found
persisted
after epoch: 20,now: 2024-07-20 15:20:06.297899,epoch time: 0:00:59.853397,used: 0:19:55.204091,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_15_00_11_seed_1_22504811
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.8951823, 'precision': 0.9005644, 'recall': 0.89595306, 'specificity': 0.89595306, 'f1': 0.894945, 'auroc': 0.9495883, 'binary_precision': 0.95036495, 'binary_recall': 0.83676094, 'binary_specificity': 0.9551451, 'binary_f1_score': 0.8899522}
confusion matrix:
      0     1
0  1448    68
1   254  1302
---- Validation: 
scalar performance:
{'acc': 0.5995316, 'precision': 0.65360737, 'recall': 0.59447, 'specificity': 0.59447, 'f1': 0.5543206, 'auroc': 0.7910346, 'binary_precision': 0.7407407, 'binary_recall': 0.2857143, 'binary_specificity': 0.9032258, 'binary_f1_score': 0.41237113}
confusion matrix:
     0    1
0  588   63
1  450  180
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.61777776, 'precision': 0.68558, 'recall': 0.61777776, 'specificity': 0.61777776, 'f1': 0.57935697, 'auroc': 0.83128893, 'binary_precision': 0.7977528, 'binary_recall': 0.31555554, 'binary_specificity': 0.92, 'binary_f1_score': 0.45222932}
confusion matrix:
     0   1
0  207  18
1  154  71
new oracle model saved
better model found
persisted
after epoch: 21,now: 2024-07-20 15:21:06.613903,epoch time: 0:01:00.316004,used: 0:20:55.520095,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_15_00_11_seed_1_22504811
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9088542, 'precision': 0.9139299, 'recall': 0.9095571, 'specificity': 0.9095571, 'f1': 0.90866446, 'auroc': 0.95979756, 'binary_precision': 0.962963, 'binary_recall': 0.85273314, 'binary_specificity': 0.966381, 'binary_f1_score': 0.90450203}
confusion matrix:
      0     1
0  1466    51
1   229  1326
---- Validation: 
scalar performance:
{'acc': 0.5979703, 'precision': 0.6548452, 'recall': 0.592806, 'specificity': 0.592806, 'f1': 0.55057377, 'auroc': 0.7933338, 'binary_precision': 0.7446808, 'binary_recall': 0.2777778, 'binary_specificity': 0.9078341, 'binary_f1_score': 0.4046243}
confusion matrix:
     0    1
0  591   60
1  455  175
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5977778, 'precision': 0.6705955, 'recall': 0.5977778, 'specificity': 0.5977778, 'f1': 0.5497289, 'auroc': 0.8322568, 'binary_precision': 0.78205127, 'binary_recall': 0.2711111, 'binary_specificity': 0.92444444, 'binary_f1_score': 0.40264025}
confusion matrix:
     0   1
0  208  17
1  164  61
early stop counter: 1
val acc:0.5979703068733215, best validation acc: 0.5995315909385681, corresponding to test acc:                         0.6177777647972107 / 0.6177777647972107
after epoch: 22,now: 2024-07-20 15:22:05.806114,epoch time: 0:00:59.192211,used: 0:21:54.712306,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_15_00_11_seed_1_22504811
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.89746094, 'precision': 0.9057634, 'recall': 0.89855444, 'specificity': 0.89855444, 'f1': 0.8970958, 'auroc': 0.9528966, 'binary_precision': 0.9676692, 'binary_recall': 0.82552916, 'binary_specificity': 0.9715797, 'binary_f1_score': 0.89096576}
confusion matrix:
      0     1
0  1470    43
1   272  1287
---- Validation: 
scalar performance:
{'acc': 0.6128025, 'precision': 0.6677238, 'recall': 0.6079365, 'specificity': 0.6079365, 'f1': 0.5725726, 'auroc': 0.7971789, 'binary_precision': 0.7596899, 'binary_recall': 0.31111112, 'binary_specificity': 0.9047619, 'binary_f1_score': 0.44144148}
confusion matrix:
     0    1
0  589   62
1  434  196
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6311111, 'precision': 0.69681245, 'recall': 0.63111115, 'specificity': 0.63111115, 'f1': 0.59752154, 'auroc': 0.8350617, 'binary_precision': 0.8105263, 'binary_recall': 0.3422222, 'binary_specificity': 0.92, 'binary_f1_score': 0.48124996}
confusion matrix:
     0   1
0  207  18
1  148  77
new oracle model saved
better model found
persisted
after epoch: 23,now: 2024-07-20 15:23:05.434166,epoch time: 0:00:59.628052,used: 0:22:54.340358,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_15_00_11_seed_1_22504811
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9108073, 'precision': 0.91599935, 'recall': 0.91155523, 'specificity': 0.91155523, 'f1': 0.91062164, 'auroc': 0.95984685, 'binary_precision': 0.965843, 'binary_recall': 0.8541131, 'binary_specificity': 0.96899736, 'binary_f1_score': 0.90654844}
confusion matrix:
      0     1
0  1469    47
1   227  1329
---- Validation: 
scalar performance:
{'acc': 0.6252927, 'precision': 0.6775142, 'recall': 0.6206861, 'specificity': 0.6206861, 'f1': 0.59058005, 'auroc': 0.8006364, 'binary_precision': 0.76978415, 'binary_recall': 0.33968255, 'binary_specificity': 0.9016897, 'binary_f1_score': 0.47136566}
confusion matrix:
     0    1
0  587   64
1  416  214
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.64444447, 'precision': 0.704597, 'recall': 0.64444447, 'specificity': 0.64444447, 'f1': 0.6162374, 'auroc': 0.8395457, 'binary_precision': 0.815534, 'binary_recall': 0.37333333, 'binary_specificity': 0.91555554, 'binary_f1_score': 0.51219517}
confusion matrix:
     0   1
0  206  19
1  141  84
new oracle model saved
better model found
persisted
after epoch: 24,now: 2024-07-20 15:24:05.016841,epoch time: 0:00:59.582675,used: 0:23:53.923033,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_15_00_11_seed_1_22504811
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.89778644, 'precision': 0.90501666, 'recall': 0.8985378, 'specificity': 0.8985378, 'f1': 0.8974421, 'auroc': 0.9609717, 'binary_precision': 0.96196866, 'binary_recall': 0.8306503, 'binary_specificity': 0.9664253, 'binary_f1_score': 0.89149964}
confusion matrix:
      0     1
0  1468    51
1   263  1290
---- Validation: 
scalar performance:
{'acc': 0.62138957, 'precision': 0.6757662, 'recall': 0.6166667, 'specificity': 0.6166667, 'f1': 0.58443505, 'auroc': 0.80254555, 'binary_precision': 0.7695167, 'binary_recall': 0.32857144, 'binary_specificity': 0.9047619, 'binary_f1_score': 0.46051168}
confusion matrix:
     0    1
0  589   62
1  423  207
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6422222, 'precision': 0.7057143, 'recall': 0.6422222, 'specificity': 0.6422222, 'f1': 0.61230767, 'auroc': 0.84197533, 'binary_precision': 0.82, 'binary_recall': 0.36444443, 'binary_specificity': 0.92, 'binary_f1_score': 0.50461537}
confusion matrix:
     0   1
0  207  18
1  143  82
early stop counter: 1
val acc:0.6213895678520203, best validation acc: 0.6252927184104919, corresponding to test acc:                         0.644444465637207 / 0.644444465637207
after epoch: 25,now: 2024-07-20 15:25:04.435705,epoch time: 0:00:59.418864,used: 0:24:53.341897,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_15_00_11_seed_1_22504811
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.90722656, 'precision': 0.91171753, 'recall': 0.9077828, 'specificity': 0.9077828, 'f1': 0.90704703, 'auroc': 0.9652494, 'binary_precision': 0.95740074, 'binary_recall': 0.85438144, 'binary_specificity': 0.9611842, 'binary_f1_score': 0.9029622}
confusion matrix:
      0     1
0  1461    59
1   226  1326
---- Validation: 
scalar performance:
{'acc': 0.6416862, 'precision': 0.6893443, 'recall': 0.6374296, 'specificity': 0.6374296, 'f1': 0.6134883, 'auroc': 0.80591524, 'binary_precision': 0.78032786, 'binary_recall': 0.37777779, 'binary_specificity': 0.89708143, 'binary_f1_score': 0.50909096}
confusion matrix:
     0    1
0  584   67
1  392  238
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.66444445, 'precision': 0.71734023, 'recall': 0.66444445, 'specificity': 0.66444445, 'f1': 0.6427051, 'auroc': 0.8446815, 'binary_precision': 0.8245614, 'binary_recall': 0.41777778, 'binary_specificity': 0.9111111, 'binary_f1_score': 0.5545723}
confusion matrix:
     0   1
0  205  20
1  131  94
new oracle model saved
better model found
persisted
after epoch: 26,now: 2024-07-20 15:26:04.627394,epoch time: 0:01:00.191689,used: 0:25:53.533586,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_15_00_11_seed_1_22504811
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.9140625, 'precision': 0.91876876, 'recall': 0.9146645, 'specificity': 0.9146645, 'f1': 0.91389376, 'auroc': 0.96223915, 'binary_precision': 0.96601593, 'binary_recall': 0.86027044, 'binary_specificity': 0.9690586, 'binary_f1_score': 0.9100818}
confusion matrix:
      0     1
0  1472    47
1   217  1336
---- Validation: 
scalar performance:
{'acc': 0.6401249, 'precision': 0.6905283, 'recall': 0.6357655, 'specificity': 0.6357655, 'f1': 0.6103698, 'auroc': 0.8084047, 'binary_precision': 0.7845118, 'binary_recall': 0.36984128, 'binary_specificity': 0.9016897, 'binary_f1_score': 0.5026969}
confusion matrix:
     0    1
0  587   64
1  397  233
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6622222, 'precision': 0.7156587, 'recall': 0.6622222, 'specificity': 0.6622222, 'f1': 0.6399166, 'auroc': 0.8472691, 'binary_precision': 0.82300884, 'binary_recall': 0.41333333, 'binary_specificity': 0.9111111, 'binary_f1_score': 0.5502958}
confusion matrix:
     0   1
0  205  20
1  132  93
early stop counter: 1
val acc:0.6401249170303345, best validation acc: 0.641686201095581, corresponding to test acc:                         0.6644444465637207 / 0.6644444465637207
after epoch: 27,now: 2024-07-20 15:27:03.732417,epoch time: 0:00:59.105023,used: 0:26:52.638609,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_15_00_11_seed_1_22504811
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.9169922, 'precision': 0.92219007, 'recall': 0.91773695, 'specificity': 0.91773695, 'f1': 0.91682184, 'auroc': 0.96631217, 'binary_precision': 0.97240376, 'binary_recall': 0.86053985, 'binary_specificity': 0.97493404, 'binary_f1_score': 0.9130582}
confusion matrix:
      0     1
0  1478    38
1   217  1339
---- Validation: 
scalar performance:
{'acc': 0.637783, 'precision': 0.6885222, 'recall': 0.6333845, 'specificity': 0.6333845, 'f1': 0.6072816, 'auroc': 0.81068933, 'binary_precision': 0.7823129, 'binary_recall': 0.36507937, 'binary_specificity': 0.9016897, 'binary_f1_score': 0.49783555}
confusion matrix:
     0    1
0  587   64
1  400  230
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6666667, 'precision': 0.7242286, 'recall': 0.6666667, 'specificity': 0.6666667, 'f1': 0.64380705, 'auroc': 0.850805, 'binary_precision': 0.8378378, 'binary_recall': 0.41333333, 'binary_specificity': 0.92, 'binary_f1_score': 0.55357146}
confusion matrix:
     0   1
0  207  18
1  132  93
new oracle model saved
early stop counter: 2
val acc:0.6377829909324646, best validation acc: 0.641686201095581, corresponding to test acc:                         0.6644444465637207 / 0.6666666865348816
after epoch: 28,now: 2024-07-20 15:28:03.194027,epoch time: 0:00:59.461610,used: 0:27:52.100219,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_15_00_11_seed_1_22504811
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9169922, 'precision': 0.92203975, 'recall': 0.91776454, 'specificity': 0.91776454, 'f1': 0.9168316, 'auroc': 0.963361, 'binary_precision': 0.9717391, 'binary_recall': 0.8612717, 'binary_specificity': 0.9742574, 'binary_f1_score': 0.9131767}
confusion matrix:
      0     1
0  1476    39
1   216  1341
---- Validation: 
scalar performance:
{'acc': 0.6338798, 'precision': 0.6869108, 'recall': 0.6293651, 'specificity': 0.6293651, 'f1': 0.60133576, 'auroc': 0.81170845, 'binary_precision': 0.78245616, 'binary_recall': 0.35396826, 'binary_specificity': 0.9047619, 'binary_f1_score': 0.48743168}
confusion matrix:
     0    1
0  589   62
1  407  223
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6755555, 'precision': 0.7391106, 'recall': 0.6755556, 'specificity': 0.6755556, 'f1': 0.6524619, 'auroc': 0.85285926, 'binary_precision': 0.86238533, 'binary_recall': 0.41777778, 'binary_specificity': 0.93333334, 'binary_f1_score': 0.56287426}
confusion matrix:
     0   1
0  210  15
1  131  94
new oracle model saved
early stop counter: 3
val acc:0.6338797807693481, best validation acc: 0.641686201095581, corresponding to test acc:                         0.6644444465637207 / 0.6755555272102356
after epoch: 29,now: 2024-07-20 15:29:02.394382,epoch time: 0:00:59.200355,used: 0:28:51.300574,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_15_00_11_seed_1_22504811
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.913737, 'precision': 0.9183947, 'recall': 0.914482, 'specificity': 0.914482, 'f1': 0.9135846, 'auroc': 0.9637604, 'binary_precision': 0.9660895, 'binary_recall': 0.85998714, 'binary_specificity': 0.9689769, 'binary_f1_score': 0.90995586}
confusion matrix:
      0     1
0  1468    47
1   218  1339
---- Validation: 
scalar performance:
{'acc': 0.64246684, 'precision': 0.6916691, 'recall': 0.63817203, 'specificity': 0.63817203, 'f1': 0.613801, 'auroc': 0.8145832, 'binary_precision': 0.7847682, 'binary_recall': 0.37619048, 'binary_specificity': 0.90015364, 'binary_f1_score': 0.50858366}
confusion matrix:
     0    1
0  586   65
1  393  237
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6911111, 'precision': 0.74177825, 'recall': 0.6911111, 'specificity': 0.6911111, 'f1': 0.67403364, 'auroc': 0.8558618, 'binary_precision': 0.852459, 'binary_recall': 0.46222222, 'binary_specificity': 0.92, 'binary_f1_score': 0.5994236}
confusion matrix:
     0    1
0  207   18
1  121  104
new oracle model saved
better model found
persisted
after epoch: 30,now: 2024-07-20 15:30:02.242476,epoch time: 0:00:59.848094,used: 0:29:51.148668,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_15_00_11_seed_1_22504811
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 0:29:51.148668 at 2024-07-20 15:30:02.242476
persisted model performance metric: 

scalar performance:
{'acc': 0.6911111, 'precision': 0.74177825, 'recall': 0.6911111, 'specificity': 0.6911111, 'f1': 0.67403364, 'auroc': 0.8558618, 'binary_precision': 0.852459, 'binary_recall': 0.46222222, 'binary_specificity': 0.92, 'binary_f1_score': 0.5994236}
confusion matrix:
     0    1
0  207   18
1  121  104
oracle model performance metric: 

scalar performance:
{'acc': 0.6911111, 'precision': 0.74177825, 'recall': 0.6911111, 'specificity': 0.6911111, 'f1': 0.67403364, 'auroc': 0.8558618, 'binary_precision': 0.852459, 'binary_recall': 0.46222222, 'binary_specificity': 0.92, 'binary_f1_score': 0.5994236}
confusion matrix:
     0    1
0  207   18
1  121  104
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_halffreezeblocks_2024-07-20_12-47-21/rule_results/1.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_halffreezeblocks_2024-07-20_12-47-21/confusion_matrix/1.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 195613 KiB |   7828 MiB | 124075 GiB | 124075 GiB |
|       from large pool | 179211 KiB |   7805 MiB | 122423 GiB | 122423 GiB |
|       from small pool |  16402 KiB |     36 MiB |   1652 GiB |   1652 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 195613 KiB |   7828 MiB | 124075 GiB | 124075 GiB |
|       from large pool | 179211 KiB |   7805 MiB | 122423 GiB | 122423 GiB |
|       from small pool |  16402 KiB |     36 MiB |   1652 GiB |   1652 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 195189 KiB |   7827 MiB | 124061 GiB | 124060 GiB |
|       from large pool | 178979 KiB |   7804 MiB | 122412 GiB | 122411 GiB |
|       from small pool |  16210 KiB |     36 MiB |   1648 GiB |   1648 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   8514 MiB |   8524 MiB |  16788 MiB |   8274 MiB |
|       from large pool |   8472 MiB |   8486 MiB |  16732 MiB |   8260 MiB |
|       from small pool |     42 MiB |     42 MiB |     56 MiB |     14 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  39907 KiB | 732464 KiB |  67125 GiB |  67125 GiB |
|       from large pool |  31733 KiB | 730714 KiB |  65467 GiB |  65467 GiB |
|       from small pool |   8174 KiB |  22319 KiB |   1657 GiB |   1657 GiB |
|---------------------------------------------------------------------------|
| Allocations           |     800    |    1679    |   20969 K  |   20968 K  |
|       from large pool |      79    |     762    |   11399 K  |   11399 K  |
|       from small pool |     721    |    1017    |    9570 K  |    9569 K  |
|---------------------------------------------------------------------------|
| Active allocs         |     800    |    1679    |   20969 K  |   20968 K  |
|       from large pool |      79    |     762    |   11399 K  |   11399 K  |
|       from small pool |     721    |    1017    |    9570 K  |    9569 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     369    |     369    |     714    |     345    |
|       from large pool |     348    |     349    |     686    |     338    |
|       from small pool |      21    |      21    |      28    |       7    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      44    |     382    |   12520 K  |   12520 K  |
|       from large pool |      11    |     351    |    8265 K  |    8265 K  |
|       from small pool |      33    |     215    |    4254 K  |    4254 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   7828 MiB | 124075 GiB | 124075 GiB |
|       from large pool |  16640 KiB |   7805 MiB | 122423 GiB | 122423 GiB |
|       from small pool |      0 KiB |     36 MiB |   1652 GiB |   1652 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   7828 MiB | 124075 GiB | 124075 GiB |
|       from large pool |  16640 KiB |   7805 MiB | 122423 GiB | 122423 GiB |
|       from small pool |      0 KiB |     36 MiB |   1652 GiB |   1652 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   7827 MiB | 124061 GiB | 124061 GiB |
|       from large pool |  16640 KiB |   7804 MiB | 122412 GiB | 122412 GiB |
|       from small pool |      0 KiB |     36 MiB |   1648 GiB |   1648 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 235520 KiB |   8524 MiB |  16788 MiB |  16558 MiB |
|       from large pool | 210944 KiB |   8486 MiB |  16732 MiB |  16526 MiB |
|       from small pool |  24576 KiB |     42 MiB |     56 MiB |     32 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  30464 KiB | 732464 KiB |  67125 GiB |  67125 GiB |
|       from large pool |  30464 KiB | 730714 KiB |  65468 GiB |  65468 GiB |
|       from small pool |      0 KiB |  22319 KiB |   1657 GiB |   1657 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    1679    |   20969 K  |   20969 K  |
|       from large pool |       2    |     762    |   11399 K  |   11399 K  |
|       from small pool |       0    |    1017    |    9570 K  |    9570 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    1679    |   20969 K  |   20969 K  |
|       from large pool |       2    |     762    |   11399 K  |   11399 K  |
|       from small pool |       0    |    1017    |    9570 K  |    9570 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      22    |     369    |     714    |     692    |
|       from large pool |      10    |     349    |     686    |     676    |
|       from small pool |      12    |      21    |      28    |      16    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     382    |   12520 K  |   12520 K  |
|       from large pool |       3    |     351    |    8265 K  |    8265 K  |
|       from small pool |       0    |     215    |    4254 K  |    4254 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   7828 MiB | 124075 GiB | 124075 GiB |
|       from large pool |  16640 KiB |   7805 MiB | 122423 GiB | 122423 GiB |
|       from small pool |      0 KiB |     36 MiB |   1652 GiB |   1652 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   7828 MiB | 124075 GiB | 124075 GiB |
|       from large pool |  16640 KiB |   7805 MiB | 122423 GiB | 122423 GiB |
|       from small pool |      0 KiB |     36 MiB |   1652 GiB |   1652 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   7827 MiB | 124061 GiB | 124061 GiB |
|       from large pool |  16640 KiB |   7804 MiB | 122412 GiB | 122412 GiB |
|       from small pool |      0 KiB |     36 MiB |   1648 GiB |   1648 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 235520 KiB |   8524 MiB |  16788 MiB |  16558 MiB |
|       from large pool | 210944 KiB |   8486 MiB |  16732 MiB |  16526 MiB |
|       from small pool |  24576 KiB |     42 MiB |     56 MiB |     32 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  30464 KiB | 732464 KiB |  67125 GiB |  67125 GiB |
|       from large pool |  30464 KiB | 730714 KiB |  65468 GiB |  65468 GiB |
|       from small pool |      0 KiB |  22319 KiB |   1657 GiB |   1657 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    1679    |   20969 K  |   20969 K  |
|       from large pool |       2    |     762    |   11399 K  |   11399 K  |
|       from small pool |       0    |    1017    |    9570 K  |    9570 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    1679    |   20969 K  |   20969 K  |
|       from large pool |       2    |     762    |   11399 K  |   11399 K  |
|       from small pool |       0    |    1017    |    9570 K  |    9570 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      22    |     369    |     714    |     692    |
|       from large pool |      10    |     349    |     686    |     676    |
|       from small pool |      12    |      21    |      28    |      16    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     382    |   12520 K  |   12520 K  |
|       from large pool |       3    |     351    |    8265 K  |    8265 K  |
|       from small pool |       0    |     215    |    4254 K  |    4254 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'888c1ef2'
model name: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_15_30_59_seed_2_22504811

 Experiment start at: 2024-07-20 15:30:59.212926
before training, model accuracy: 0.41203704476356506
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.5847513, 'precision': 0.60275084, 'recall': 0.58632684, 'specificity': 0.58632684, 'f1': 0.5681604, 'auroc': 0.648162, 'binary_precision': 0.64776444, 'binary_recall': 0.3857143, 'binary_specificity': 0.7869393, 'binary_f1_score': 0.48351648}
confusion matrix:
      0    1
0  1193  323
1   946  594
---- Validation: 
scalar performance:
{'acc': 0.64632237, 'precision': 0.65524554, 'recall': 0.6426138, 'specificity': 0.6426138, 'f1': 0.6374432, 'auroc': 0.6693495, 'binary_precision': 0.6864035, 'binary_recall': 0.50321543, 'binary_specificity': 0.7820122, 'binary_f1_score': 0.580705}
confusion matrix:
     0    1
0  513  143
1  309  313
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.36342594, 'precision': 0.33976665, 'recall': 0.36342594, 'specificity': 0.36342594, 'f1': 0.3390269, 'auroc': 0.30849195, 'binary_precision': 0.2781955, 'binary_recall': 0.1712963, 'binary_specificity': 0.5555556, 'binary_f1_score': 0.21203437}
confusion matrix:
     0   1
0  120  96
1  179  37
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-20 15:31:59.924494,epoch time: 0:01:00.711568,used: 0:01:00.711568,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_15_30_59_seed_2_22504811
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.64659685, 'precision': 0.6478169, 'recall': 0.6469143, 'specificity': 0.6469143, 'f1': 0.64615494, 'auroc': 0.70739937, 'binary_precision': 0.66335225, 'binary_recall': 0.60649353, 'binary_specificity': 0.6873351, 'binary_f1_score': 0.63364995}
confusion matrix:
      0    1
0  1042  474
1   606  934
---- Validation: 
scalar performance:
{'acc': 0.65884197, 'precision': 0.6590767, 'recall': 0.657642, 'specificity': 0.657642, 'f1': 0.6574998, 'auroc': 0.6889827, 'binary_precision': 0.6614583, 'binary_recall': 0.6125402, 'binary_specificity': 0.7027439, 'binary_f1_score': 0.63606006}
confusion matrix:
     0    1
0  461  195
1  241  381
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.4027778, 'precision': 0.4015625, 'recall': 0.4027778, 'specificity': 0.4027778, 'f1': 0.4009288, 'auroc': 0.34040636, 'binary_precision': 0.390625, 'binary_recall': 0.3472222, 'binary_specificity': 0.45833334, 'binary_f1_score': 0.36764705}
confusion matrix:
     0    1
0   99  117
1  141   75
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-07-20 15:32:58.301212,epoch time: 0:00:58.376718,used: 0:01:59.088286,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_15_30_59_seed_2_22504811
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.7018979, 'precision': 0.70190054, 'recall': 0.7019129, 'specificity': 0.7019129, 'f1': 0.70189404, 'auroc': 0.7644108, 'binary_precision': 0.7059594, 'binary_recall': 0.7, 'binary_specificity': 0.70382583, 'binary_f1_score': 0.70296705}
confusion matrix:
      0     1
0  1067   449
1   462  1078
---- Validation: 
scalar performance:
{'acc': 0.670579, 'precision': 0.6711011, 'recall': 0.6692833, 'specificity': 0.6692833, 'f1': 0.66911536, 'auroc': 0.7023077, 'binary_precision': 0.67600703, 'binary_recall': 0.62057877, 'binary_specificity': 0.7179878, 'binary_f1_score': 0.64710814}
confusion matrix:
     0    1
0  471  185
1  236  386
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.4537037, 'precision': 0.45344827, 'recall': 0.4537037, 'specificity': 0.4537037, 'f1': 0.45295328, 'auroc': 0.37382114, 'binary_precision': 0.45, 'binary_recall': 0.41666666, 'binary_specificity': 0.49074075, 'binary_f1_score': 0.43269226}
confusion matrix:
     0    1
0  106  110
1  126   90
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-07-20 15:33:56.614146,epoch time: 0:00:58.312934,used: 0:02:57.401220,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_15_30_59_seed_2_22504811
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.7558901, 'precision': 0.75604796, 'recall': 0.7559778, 'specificity': 0.7559778, 'f1': 0.75588334, 'auroc': 0.83151364, 'binary_precision': 0.7646667, 'binary_recall': 0.7448052, 'binary_specificity': 0.7671504, 'binary_f1_score': 0.7546053}
confusion matrix:
      0     1
0  1163   353
1   393  1147
---- Validation: 
scalar performance:
{'acc': 0.6799687, 'precision': 0.68294644, 'recall': 0.6778463, 'specificity': 0.6778463, 'f1': 0.6768775, 'auroc': 0.7127676, 'binary_precision': 0.700565, 'binary_recall': 0.59807074, 'binary_specificity': 0.75762194, 'binary_f1_score': 0.6452732}
confusion matrix:
     0    1
0  497  159
1  250  372
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.45833334, 'precision': 0.45727473, 'recall': 0.4583333, 'specificity': 0.4583333, 'f1': 0.4549572, 'auroc': 0.40704304, 'binary_precision': 0.45054945, 'binary_recall': 0.37962964, 'binary_specificity': 0.537037, 'binary_f1_score': 0.4120603}
confusion matrix:
     0    1
0  116  100
1  134   82
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-07-20 15:34:54.872950,epoch time: 0:00:58.258804,used: 0:03:55.660024,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_15_30_59_seed_2_22504811
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.78174084, 'precision': 0.7832379, 'recall': 0.7820178, 'specificity': 0.7820178, 'f1': 0.78155553, 'auroc': 0.8588472, 'binary_precision': 0.80588645, 'binary_recall': 0.7467533, 'binary_specificity': 0.8172823, 'binary_f1_score': 0.7751938}
confusion matrix:
      0     1
0  1239   277
1   390  1150
---- Validation: 
scalar performance:
{'acc': 0.67840374, 'precision': 0.6841183, 'recall': 0.67565536, 'specificity': 0.67565536, 'f1': 0.6736026, 'auroc': 0.71958077, 'binary_precision': 0.71057886, 'binary_recall': 0.5723473, 'binary_specificity': 0.7789634, 'binary_f1_score': 0.63401604}
confusion matrix:
     0    1
0  511  145
1  266  356
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.4652778, 'precision': 0.46287042, 'recall': 0.4652778, 'specificity': 0.4652778, 'f1': 0.45646763, 'auroc': 0.43927896, 'binary_precision': 0.45341614, 'binary_recall': 0.33796296, 'binary_specificity': 0.5925926, 'binary_f1_score': 0.38726792}
confusion matrix:
     0   1
0  128  88
1  143  73
new oracle model saved
early stop counter: 1
val acc:0.6784037351608276, best validation acc: 0.6799687147140503, corresponding to test acc:                         0.4583333432674408 / 0.4652777910232544
after epoch: 5,now: 2024-07-20 15:35:53.044562,epoch time: 0:00:58.171612,used: 0:04:53.831636,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_15_30_59_seed_2_22504811
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.815445, 'precision': 0.8171203, 'recall': 0.81572664, 'specificity': 0.81572664, 'f1': 0.81528485, 'auroc': 0.8932658, 'binary_precision': 0.842216, 'binary_recall': 0.77987015, 'binary_specificity': 0.8515831, 'binary_f1_score': 0.8098449}
confusion matrix:
      0     1
0  1291   225
1   339  1201
---- Validation: 
scalar performance:
{'acc': 0.68075114, 'precision': 0.692099, 'recall': 0.6771503, 'specificity': 0.6771503, 'f1': 0.6730614, 'auroc': 0.72551906, 'binary_precision': 0.7326087, 'binary_recall': 0.5418006, 'binary_specificity': 0.8125, 'binary_f1_score': 0.6229205}
confusion matrix:
     0    1
0  533  123
1  285  337
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.4513889, 'precision': 0.44621387, 'recall': 0.4513889, 'specificity': 0.4513889, 'f1': 0.43786752, 'auroc': 0.4646991, 'binary_precision': 0.4295302, 'binary_recall': 0.2962963, 'binary_specificity': 0.6064815, 'binary_f1_score': 0.35068494}
confusion matrix:
     0   1
0  131  85
1  152  64
better model found
persisted
after epoch: 6,now: 2024-07-20 15:36:51.786236,epoch time: 0:00:58.741674,used: 0:05:52.573310,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_15_30_59_seed_2_22504811
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.8426047, 'precision': 0.84500307, 'recall': 0.8429316, 'specificity': 0.8429316, 'f1': 0.8424115, 'auroc': 0.9119688, 'binary_precision': 0.87579846, 'binary_recall': 0.8012987, 'binary_specificity': 0.88456464, 'binary_f1_score': 0.83689386}
confusion matrix:
      0     1
0  1341   175
1   306  1234
---- Validation: 
scalar performance:
{'acc': 0.6791862, 'precision': 0.69347405, 'recall': 0.6752093, 'specificity': 0.6752093, 'f1': 0.6699313, 'auroc': 0.7284894, 'binary_precision': 0.739819, 'binary_recall': 0.52572346, 'binary_specificity': 0.8246951, 'binary_f1_score': 0.6146616}
confusion matrix:
     0    1
0  541  115
1  295  327
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.4652778, 'precision': 0.46107173, 'recall': 0.4652778, 'specificity': 0.4652778, 'f1': 0.45043314, 'auroc': 0.4852109, 'binary_precision': 0.44827586, 'binary_recall': 0.30092594, 'binary_specificity': 0.6296296, 'binary_f1_score': 0.36011085}
confusion matrix:
     0   1
0  136  80
1  151  65
early stop counter: 1
val acc:0.679186224937439, best validation acc: 0.6807511448860168, corresponding to test acc:                         0.4513888955116272 / 0.4652777910232544
after epoch: 7,now: 2024-07-20 15:37:49.583450,epoch time: 0:00:57.797214,used: 0:06:50.370524,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_15_30_59_seed_2_22504811
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.84129584, 'precision': 0.8459622, 'recall': 0.8417512, 'specificity': 0.8417512, 'f1': 0.8408758, 'auroc': 0.9091856, 'binary_precision': 0.8881531, 'binary_recall': 0.7837662, 'binary_specificity': 0.89973617, 'binary_f1_score': 0.83270085}
confusion matrix:
      0     1
0  1364   152
1   333  1207
---- Validation: 
scalar performance:
{'acc': 0.6760563, 'precision': 0.69652975, 'recall': 0.67141056, 'specificity': 0.67141056, 'f1': 0.6635918, 'auroc': 0.7328322, 'binary_precision': 0.75365853, 'binary_recall': 0.49678457, 'binary_specificity': 0.8460366, 'binary_f1_score': 0.5988372}
confusion matrix:
     0    1
0  555  101
1  313  309
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.47685185, 'precision': 0.47272727, 'recall': 0.47685185, 'specificity': 0.47685185, 'f1': 0.45629513, 'auroc': 0.5072017, 'binary_precision': 0.46212122, 'binary_recall': 0.2824074, 'binary_specificity': 0.6712963, 'binary_f1_score': 0.3505747}
confusion matrix:
     0   1
0  145  71
1  155  61
new oracle model saved
early stop counter: 2
val acc:0.6760563254356384, best validation acc: 0.6807511448860168, corresponding to test acc:                         0.4513888955116272 / 0.47685185074806213
after epoch: 8,now: 2024-07-20 15:38:47.584266,epoch time: 0:00:58.000816,used: 0:07:48.371340,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_15_30_59_seed_2_22504811
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.85340315, 'precision': 0.8559066, 'recall': 0.8537333, 'specificity': 0.8537333, 'f1': 0.85321987, 'auroc': 0.9196129, 'binary_precision': 0.88778406, 'binary_recall': 0.8116883, 'binary_specificity': 0.89577836, 'binary_f1_score': 0.84803253}
confusion matrix:
      0     1
0  1358   158
1   290  1250
---- Validation: 
scalar performance:
{'acc': 0.6697966, 'precision': 0.6967237, 'recall': 0.6645214, 'specificity': 0.6645214, 'f1': 0.65364254, 'auroc': 0.7362241, 'binary_precision': 0.7631579, 'binary_recall': 0.46623793, 'binary_specificity': 0.8628049, 'binary_f1_score': 0.57884234}
confusion matrix:
     0    1
0  566   90
1  332  290
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.4861111, 'precision': 0.48251104, 'recall': 0.4861111, 'specificity': 0.4861111, 'f1': 0.4582307, 'auroc': 0.52321243, 'binary_precision': 0.47457626, 'binary_recall': 0.25925925, 'binary_specificity': 0.712963, 'binary_f1_score': 0.33532935}
confusion matrix:
     0   1
0  154  62
1  160  56
new oracle model saved
early stop counter: 3
val acc:0.6697965860366821, best validation acc: 0.6807511448860168, corresponding to test acc:                         0.4513888955116272 / 0.4861111044883728
after epoch: 9,now: 2024-07-20 15:39:45.798881,epoch time: 0:00:58.214615,used: 0:08:46.585955,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_15_30_59_seed_2_22504811
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.86649215, 'precision': 0.87005293, 'recall': 0.8668797, 'specificity': 0.8668797, 'f1': 0.8662501, 'auroc': 0.93213296, 'binary_precision': 0.9083694, 'binary_recall': 0.8175325, 'binary_specificity': 0.9162269, 'binary_f1_score': 0.8605605}
confusion matrix:
      0     1
0  1389   127
1   281  1259
---- Validation: 
scalar performance:
{'acc': 0.6658842, 'precision': 0.6974734, 'recall': 0.6602105, 'specificity': 0.6602105, 'f1': 0.6470798, 'auroc': 0.7374544, 'binary_precision': 0.7700831, 'binary_recall': 0.44694534, 'binary_specificity': 0.8734756, 'binary_f1_score': 0.5656154}
confusion matrix:
     0    1
0  573   83
1  344  278
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5, 'precision': 0.5, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4666667, 'auroc': 0.5359225, 'binary_precision': 0.5, 'binary_recall': 0.25, 'binary_specificity': 0.75, 'binary_f1_score': 0.33333334}
confusion matrix:
     0   1
0  162  54
1  162  54
new oracle model saved
early stop counter: 4
val acc:0.6658841967582703, best validation acc: 0.6807511448860168, corresponding to test acc:                         0.4513888955116272 / 0.5
after epoch: 10,now: 2024-07-20 15:40:44.012766,epoch time: 0:00:58.213885,used: 0:09:44.799840,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_15_30_59_seed_2_22504811
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.875, 'precision': 0.879248, 'recall': 0.8754189, 'specificity': 0.8754189, 'f1': 0.8747295, 'auroc': 0.9334506, 'binary_precision': 0.9213974, 'binary_recall': 0.82207793, 'binary_specificity': 0.9287599, 'binary_f1_score': 0.86890876}
confusion matrix:
      0     1
0  1408   108
1   274  1266
---- Validation: 
scalar performance:
{'acc': 0.6627543, 'precision': 0.7000613, 'recall': 0.65666175, 'specificity': 0.65666175, 'f1': 0.6409408, 'auroc': 0.7408806, 'binary_precision': 0.7800586, 'binary_recall': 0.42765275, 'binary_specificity': 0.8856707, 'binary_f1_score': 0.5524403}
confusion matrix:
     0    1
0  581   75
1  356  266
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5069444, 'precision': 0.5095612, 'recall': 0.5069444, 'specificity': 0.5069444, 'f1': 0.47073138, 'auroc': 0.55386233, 'binary_precision': 0.5145631, 'binary_recall': 0.24537037, 'binary_specificity': 0.7685185, 'binary_f1_score': 0.33228838}
confusion matrix:
     0   1
0  166  50
1  163  53
new oracle model saved
early stop counter: 5
val acc:0.6627542972564697, best validation acc: 0.6807511448860168, corresponding to test acc:                         0.4513888955116272 / 0.5069444179534912
after epoch: 11,now: 2024-07-20 15:41:42.564886,epoch time: 0:00:58.552120,used: 0:10:43.351960,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_15_30_59_seed_2_22504811
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.8710733, 'precision': 0.874674, 'recall': 0.87146115, 'specificity': 0.87146115, 'f1': 0.87083954, 'auroc': 0.9323994, 'binary_precision': 0.9134199, 'binary_recall': 0.82207793, 'binary_specificity': 0.9208443, 'binary_f1_score': 0.8653452}
confusion matrix:
      0     1
0  1396   120
1   274  1266
---- Validation: 
scalar performance:
{'acc': 0.6517997, 'precision': 0.6952529, 'recall': 0.6451577, 'specificity': 0.6451577, 'f1': 0.62510955, 'auroc': 0.74207664, 'binary_precision': 0.7809524, 'binary_recall': 0.3954984, 'binary_specificity': 0.89481705, 'binary_f1_score': 0.5250801}
confusion matrix:
     0    1
0  587   69
1  376  246
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5138889, 'precision': 0.5203953, 'recall': 0.5138889, 'specificity': 0.5138889, 'f1': 0.47175965, 'auroc': 0.5629287, 'binary_precision': 0.5319149, 'binary_recall': 0.23148148, 'binary_specificity': 0.7962963, 'binary_f1_score': 0.32258064}
confusion matrix:
     0   1
0  172  44
1  166  50
new oracle model saved
early stop counter: 6
val acc:0.6517996788024902, best validation acc: 0.6807511448860168, corresponding to test acc:                         0.4513888955116272 / 0.5138888955116272
after epoch: 12,now: 2024-07-20 15:42:40.560936,epoch time: 0:00:57.996050,used: 0:11:41.348010,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_15_30_59_seed_2_22504811
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.8759817, 'precision': 0.8797742, 'recall': 0.8763775, 'specificity': 0.8763775, 'f1': 0.87574637, 'auroc': 0.9427757, 'binary_precision': 0.9197397, 'binary_recall': 0.82597405, 'binary_specificity': 0.926781, 'binary_f1_score': 0.8703388}
confusion matrix:
      0     1
0  1405   111
1   268  1272
---- Validation: 
scalar performance:
{'acc': 0.64788735, 'precision': 0.6959919, 'recall': 0.6409301, 'specificity': 0.6409301, 'f1': 0.6182664, 'auroc': 0.74414504, 'binary_precision': 0.7866667, 'binary_recall': 0.37942123, 'binary_specificity': 0.902439, 'binary_f1_score': 0.5119306}
confusion matrix:
     0    1
0  592   64
1  386  236
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5115741, 'precision': 0.517991, 'recall': 0.5115741, 'specificity': 0.5115741, 'f1': 0.46375814, 'auroc': 0.5735382, 'binary_precision': 0.52873564, 'binary_recall': 0.21296297, 'binary_specificity': 0.8101852, 'binary_f1_score': 0.30363035}
confusion matrix:
     0   1
0  175  41
1  170  46
early stop counter: 7
val acc:0.6478873491287231, best validation acc: 0.6807511448860168, corresponding to test acc:                         0.4513888955116272 / 0.5138888955116272
after epoch: 13,now: 2024-07-20 15:43:38.583145,epoch time: 0:00:58.022209,used: 0:12:39.370219,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_15_30_59_seed_2_22504811
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.8867801, 'precision': 0.89041734, 'recall': 0.88716376, 'specificity': 0.88716376, 'f1': 0.8865812, 'auroc': 0.94520485, 'binary_precision': 0.9301153, 'binary_recall': 0.8383117, 'binary_specificity': 0.93601584, 'binary_f1_score': 0.88183063}
confusion matrix:
      0     1
0  1419    97
1   249  1291
---- Validation: 
scalar performance:
{'acc': 0.64084506, 'precision': 0.6992767, 'recall': 0.6332788, 'specificity': 0.6332788, 'f1': 0.6049975, 'auroc': 0.7444085, 'binary_precision': 0.80073804, 'binary_recall': 0.3488746, 'binary_specificity': 0.91768295, 'binary_f1_score': 0.48600224}
confusion matrix:
     0    1
0  602   54
1  405  217
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5138889, 'precision': 0.5225784, 'recall': 0.5138889, 'specificity': 0.5138889, 'f1': 0.46213865, 'auroc': 0.57953966, 'binary_precision': 0.5365854, 'binary_recall': 0.2037037, 'binary_specificity': 0.8240741, 'binary_f1_score': 0.295302}
confusion matrix:
     0   1
0  178  38
1  172  44
early stop counter: 8
val acc:0.6408450603485107, best validation acc: 0.6807511448860168, corresponding to test acc:                         0.4513888955116272 / 0.5138888955116272
after epoch: 14,now: 2024-07-20 15:44:36.420584,epoch time: 0:00:57.837439,used: 0:13:37.207658,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_15_30_59_seed_2_22504811
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.8903796, 'precision': 0.8946214, 'recall': 0.8907917, 'specificity': 0.8907917, 'f1': 0.89015234, 'auroc': 0.9494256, 'binary_precision': 0.93754536, 'binary_recall': 0.8383117, 'binary_specificity': 0.94327176, 'binary_f1_score': 0.885156}
confusion matrix:
      0     1
0  1430    86
1   249  1291
---- Validation: 
scalar performance:
{'acc': 0.64710486, 'precision': 0.70353943, 'recall': 0.6397513, 'specificity': 0.6397513, 'f1': 0.6138582, 'auroc': 0.7475296, 'binary_precision': 0.80427045, 'binary_recall': 0.36334404, 'binary_specificity': 0.91615856, 'binary_f1_score': 0.5005537}
confusion matrix:
     0    1
0  601   55
1  396  226
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5138889, 'precision': 0.52177715, 'recall': 0.5138889, 'specificity': 0.5138889, 'f1': 0.46548513, 'auroc': 0.59190667, 'binary_precision': 0.53488374, 'binary_recall': 0.21296297, 'binary_specificity': 0.8148148, 'binary_f1_score': 0.30463576}
confusion matrix:
     0   1
0  176  40
1  170  46
early stop counter: 9
val acc:0.6471048593521118, best validation acc: 0.6807511448860168, corresponding to test acc:                         0.4513888955116272 / 0.5138888955116272
after epoch: 15,now: 2024-07-20 15:45:35.028719,epoch time: 0:00:58.608135,used: 0:14:35.815793,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_15_30_59_seed_2_22504811
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.89463353, 'precision': 0.8994242, 'recall': 0.89506906, 'specificity': 0.89506906, 'f1': 0.8943858, 'auroc': 0.94981694, 'binary_precision': 0.9451754, 'binary_recall': 0.8396104, 'binary_specificity': 0.9505277, 'binary_f1_score': 0.889271}
confusion matrix:
      0     1
0  1441    75
1   247  1293
---- Validation: 
scalar performance:
{'acc': 0.62754303, 'precision': 0.69426274, 'recall': 0.6193632, 'specificity': 0.6193632, 'f1': 0.5838751, 'auroc': 0.74727964, 'binary_precision': 0.8016529, 'binary_recall': 0.3118971, 'binary_specificity': 0.9268293, 'binary_f1_score': 0.44907412}
confusion matrix:
     0    1
0  608   48
1  428  194
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5162037, 'precision': 0.52765685, 'recall': 0.5162037, 'specificity': 0.5162037, 'f1': 0.46033242, 'auroc': 0.6012732, 'binary_precision': 0.54545456, 'binary_recall': 0.19444445, 'binary_specificity': 0.837963, 'binary_f1_score': 0.2866894}
confusion matrix:
     0   1
0  181  35
1  174  42
new oracle model saved
early stop counter: 10
val acc:0.627543032169342, best validation acc: 0.6807511448860168, corresponding to test acc:                         0.4513888955116272 / 0.5162037014961243
after epoch: 16,now: 2024-07-20 15:46:33.350273,epoch time: 0:00:58.321554,used: 0:15:34.137347,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_15_30_59_seed_2_22504811
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.8939791, 'precision': 0.89887893, 'recall': 0.89441967, 'specificity': 0.89441967, 'f1': 0.893723, 'auroc': 0.9538293, 'binary_precision': 0.9450952, 'binary_recall': 0.8383117, 'binary_specificity': 0.9505277, 'binary_f1_score': 0.88850653}
confusion matrix:
      0     1
0  1441    75
1   249  1291
---- Validation: 
scalar performance:
{'acc': 0.6173709, 'precision': 0.6874264, 'recall': 0.60882974, 'specificity': 0.60882974, 'f1': 0.568268, 'auroc': 0.74679434, 'binary_precision': 0.79555553, 'binary_recall': 0.28778136, 'binary_specificity': 0.92987806, 'binary_f1_score': 0.42266825}
confusion matrix:
     0    1
0  610   46
1  443  179
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5138889, 'precision': 0.525, 'recall': 0.5138889, 'specificity': 0.5138889, 'f1': 0.453125, 'auroc': 0.6071888, 'binary_precision': 0.5416667, 'binary_recall': 0.18055555, 'binary_specificity': 0.8472222, 'binary_f1_score': 0.27083334}
confusion matrix:
     0   1
0  183  33
1  177  39
early stop counter: 11
val acc:0.6173709034919739, best validation acc: 0.6807511448860168, corresponding to test acc:                         0.4513888955116272 / 0.5162037014961243
after epoch: 17,now: 2024-07-20 15:47:31.177066,epoch time: 0:00:57.826793,used: 0:16:31.964140,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_15_30_59_seed_2_22504811
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.89757854, 'precision': 0.90246046, 'recall': 0.8980168, 'specificity': 0.8980168, 'f1': 0.89733446, 'auroc': 0.95339406, 'binary_precision': 0.948793, 'binary_recall': 0.8422078, 'binary_specificity': 0.95382583, 'binary_f1_score': 0.89232886}
confusion matrix:
      0     1
0  1446    70
1   243  1297
---- Validation: 
scalar performance:
{'acc': 0.614241, 'precision': 0.6844801, 'recall': 0.6056143, 'specificity': 0.6056143, 'f1': 0.56369233, 'auroc': 0.74746096, 'binary_precision': 0.7918552, 'binary_recall': 0.2813505, 'binary_specificity': 0.92987806, 'binary_f1_score': 0.41518387}
confusion matrix:
     0    1
0  610   46
1  447  175
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5115741, 'precision': 0.5220814, 'recall': 0.5115741, 'specificity': 0.5115741, 'f1': 0.445625, 'auroc': 0.6102538, 'binary_precision': 0.53731346, 'binary_recall': 0.16666667, 'binary_specificity': 0.8564815, 'binary_f1_score': 0.25441697}
confusion matrix:
     0   1
0  185  31
1  180  36
early stop counter: 12
val acc:0.6142410039901733, best validation acc: 0.6807511448860168, corresponding to test acc:                         0.4513888955116272 / 0.5162037014961243
after epoch: 18,now: 2024-07-20 15:48:29.604348,epoch time: 0:00:58.427282,used: 0:17:30.391422,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_15_30_59_seed_2_22504811
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.8943063, 'precision': 0.8992687, 'recall': 0.8947495, 'specificity': 0.8947495, 'f1': 0.89404756, 'auroc': 0.9486979, 'binary_precision': 0.94578755, 'binary_recall': 0.8383117, 'binary_specificity': 0.9511873, 'binary_f1_score': 0.88881236}
confusion matrix:
      0     1
0  1442    74
1   249  1291
---- Validation: 
scalar performance:
{'acc': 0.6158059, 'precision': 0.68721557, 'recall': 0.60718036, 'specificity': 0.60718036, 'f1': 0.56546235, 'auroc': 0.7508038, 'binary_precision': 0.7963801, 'binary_recall': 0.2829582, 'binary_specificity': 0.93140244, 'binary_f1_score': 0.41755638}
confusion matrix:
     0    1
0  611   45
1  446  176
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5138889, 'precision': 0.5244602, 'recall': 0.5138889, 'specificity': 0.5138889, 'f1': 0.45500422, 'auroc': 0.6134473, 'binary_precision': 0.5405405, 'binary_recall': 0.18518518, 'binary_specificity': 0.8425926, 'binary_f1_score': 0.27586207}
confusion matrix:
     0   1
0  182  34
1  176  40
early stop counter: 13
val acc:0.6158059239387512, best validation acc: 0.6807511448860168, corresponding to test acc:                         0.4513888955116272 / 0.5162037014961243
after epoch: 19,now: 2024-07-20 15:49:27.662369,epoch time: 0:00:58.058021,used: 0:18:28.449443,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_15_30_59_seed_2_22504811
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9064136, 'precision': 0.9092461, 'recall': 0.9067471, 'specificity': 0.9067471, 'f1': 0.9062966, 'auroc': 0.9570662, 'binary_precision': 0.9453125, 'binary_recall': 0.8642857, 'binary_specificity': 0.94920844, 'binary_f1_score': 0.90298504}
confusion matrix:
      0     1
0  1439    77
1   209  1331
---- Validation: 
scalar performance:
{'acc': 0.62128323, 'precision': 0.6898159, 'recall': 0.61289066, 'specificity': 0.61289066, 'f1': 0.57444197, 'auroc': 0.7538233, 'binary_precision': 0.79741377, 'binary_recall': 0.29742765, 'binary_specificity': 0.92835367, 'binary_f1_score': 0.43325523}
confusion matrix:
     0    1
0  609   47
1  437  185
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5324074, 'precision': 0.55707383, 'recall': 0.5324074, 'specificity': 0.5324074, 'f1': 0.47576594, 'auroc': 0.628708, 'binary_precision': 0.5945946, 'binary_recall': 0.2037037, 'binary_specificity': 0.8611111, 'binary_f1_score': 0.3034483}
confusion matrix:
     0   1
0  186  30
1  172  44
new oracle model saved
early stop counter: 14
val acc:0.621283233165741, best validation acc: 0.6807511448860168, corresponding to test acc:                         0.4513888955116272 / 0.5324074029922485
after epoch: 20,now: 2024-07-20 15:50:26.159358,epoch time: 0:00:58.496989,used: 0:19:26.946432,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_15_30_59_seed_2_22504811
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9051047, 'precision': 0.90829885, 'recall': 0.9054587, 'specificity': 0.9054587, 'f1': 0.9049678, 'auroc': 0.95745385, 'binary_precision': 0.9464286, 'binary_recall': 0.8603896, 'binary_specificity': 0.9505277, 'binary_f1_score': 0.9013605}
confusion matrix:
      0     1
0  1441    75
1   215  1325
---- Validation: 
scalar performance:
{'acc': 0.6205008, 'precision': 0.69031644, 'recall': 0.61204517, 'specificity': 0.61204517, 'f1': 0.5728124, 'auroc': 0.7561809, 'binary_precision': 0.7991266, 'binary_recall': 0.29421222, 'binary_specificity': 0.92987806, 'binary_f1_score': 0.43008226}
confusion matrix:
     0    1
0  610   46
1  439  183
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.537037, 'precision': 0.56522727, 'recall': 0.537037, 'specificity': 0.537037, 'f1': 0.4809564, 'auroc': 0.6340021, 'binary_precision': 0.6081081, 'binary_recall': 0.20833333, 'binary_specificity': 0.8657407, 'binary_f1_score': 0.31034482}
confusion matrix:
     0   1
0  187  29
1  171  45
new oracle model saved
early stop counter: 15
val acc:0.6205008029937744, best validation acc: 0.6807511448860168, corresponding to test acc:                         0.4513888955116272 / 0.5370370149612427
after epoch: 21,now: 2024-07-20 15:51:25.819699,epoch time: 0:00:59.660341,used: 0:20:26.606773,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_15_30_59_seed_2_22504811
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.90052354, 'precision': 0.90514743, 'recall': 0.9009492, 'specificity': 0.9009492, 'f1': 0.9003022, 'auroc': 0.95328873, 'binary_precision': 0.9504373, 'binary_recall': 0.84675324, 'binary_specificity': 0.9551451, 'binary_f1_score': 0.8956044}
confusion matrix:
      0     1
0  1448    68
1   236  1304
---- Validation: 
scalar performance:
{'acc': 0.6165884, 'precision': 0.68922496, 'recall': 0.6079425, 'specificity': 0.6079425, 'f1': 0.56608564, 'auroc': 0.7568352, 'binary_precision': 0.8, 'binary_recall': 0.2829582, 'binary_specificity': 0.93292683, 'binary_f1_score': 0.41805226}
confusion matrix:
     0    1
0  612   44
1  446  176
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5324074, 'precision': 0.55966854, 'recall': 0.5324074, 'specificity': 0.5324074, 'f1': 0.47211272, 'auroc': 0.638546, 'binary_precision': 0.6, 'binary_recall': 0.19444445, 'binary_specificity': 0.8703704, 'binary_f1_score': 0.29370633}
confusion matrix:
     0   1
0  188  28
1  174  42
early stop counter: 16
val acc:0.6165884137153625, best validation acc: 0.6807511448860168, corresponding to test acc:                         0.4513888955116272 / 0.5370370149612427
after epoch: 22,now: 2024-07-20 15:52:24.024788,epoch time: 0:00:58.205089,used: 0:21:24.811862,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_15_30_59_seed_2_22504811
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.9191754, 'precision': 0.922041, 'recall': 0.9195071, 'specificity': 0.9195071, 'f1': 0.9190762, 'auroc': 0.96723133, 'binary_precision': 0.9588361, 'binary_recall': 0.8772727, 'binary_specificity': 0.96174145, 'binary_f1_score': 0.9162428}
confusion matrix:
      0     1
0  1458    58
1   189  1351
---- Validation: 
scalar performance:
{'acc': 0.6197183, 'precision': 0.6947156, 'recall': 0.6110746, 'specificity': 0.6110746, 'f1': 0.56962776, 'auroc': 0.75914884, 'binary_precision': 0.8090909, 'binary_recall': 0.28617364, 'binary_specificity': 0.9359756, 'binary_f1_score': 0.42280284}
confusion matrix:
     0    1
0  614   42
1  444  178
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5347222, 'precision': 0.5632047, 'recall': 0.5347222, 'specificity': 0.5347222, 'f1': 0.475649, 'auroc': 0.64396864, 'binary_precision': 0.6056338, 'binary_recall': 0.19907407, 'binary_specificity': 0.8703704, 'binary_f1_score': 0.29965156}
confusion matrix:
     0   1
0  188  28
1  173  43
early stop counter: 17
val acc:0.6197183132171631, best validation acc: 0.6807511448860168, corresponding to test acc:                         0.4513888955116272 / 0.5370370149612427
after epoch: 23,now: 2024-07-20 15:53:22.105148,epoch time: 0:00:58.080360,used: 0:22:22.892222,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_15_30_59_seed_2_22504811
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9064136, 'precision': 0.912206, 'recall': 0.90688586, 'specificity': 0.90688586, 'f1': 0.90614986, 'auroc': 0.95993215, 'binary_precision': 0.96307236, 'binary_recall': 0.84675324, 'binary_specificity': 0.9670185, 'binary_f1_score': 0.9011748}
confusion matrix:
      0     1
0  1466    50
1   236  1304
---- Validation: 
scalar performance:
{'acc': 0.6165884, 'precision': 0.7019351, 'recall': 0.60756755, 'specificity': 0.60756755, 'f1': 0.5612149, 'auroc': 0.7584797, 'binary_precision': 0.8267327, 'binary_recall': 0.26848873, 'binary_specificity': 0.94664633, 'binary_f1_score': 0.4053398}
confusion matrix:
     0    1
0  621   35
1  455  167
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5324074, 'precision': 0.56108594, 'recall': 0.5324074, 'specificity': 0.5324074, 'f1': 0.47022825, 'auroc': 0.6425754, 'binary_precision': 0.60294116, 'binary_recall': 0.18981482, 'binary_specificity': 0.875, 'binary_f1_score': 0.2887324}
confusion matrix:
     0   1
0  189  27
1  175  41
early stop counter: 18
val acc:0.6165884137153625, best validation acc: 0.6807511448860168, corresponding to test acc:                         0.4513888955116272 / 0.5370370149612427
after epoch: 24,now: 2024-07-20 15:54:20.372684,epoch time: 0:00:58.267536,used: 0:23:21.159758,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_15_30_59_seed_2_22504811
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.908377, 'precision': 0.9125184, 'recall': 0.90877736, 'specificity': 0.90877736, 'f1': 0.9082005, 'auroc': 0.9582754, 'binary_precision': 0.9558611, 'binary_recall': 0.8577922, 'binary_specificity': 0.9597625, 'binary_f1_score': 0.9041753}
confusion matrix:
      0     1
0  1455    61
1   219  1321
---- Validation: 
scalar performance:
{'acc': 0.6165884, 'precision': 0.7019351, 'recall': 0.60756755, 'specificity': 0.60756755, 'f1': 0.5612149, 'auroc': 0.75874686, 'binary_precision': 0.8267327, 'binary_recall': 0.26848873, 'binary_specificity': 0.94664633, 'binary_f1_score': 0.4053398}
confusion matrix:
     0    1
0  621   35
1  455  167
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5393519, 'precision': 0.571632, 'recall': 0.5393518, 'specificity': 0.5393518, 'f1': 0.48086637, 'auroc': 0.6541281, 'binary_precision': 0.6197183, 'binary_recall': 0.2037037, 'binary_specificity': 0.875, 'binary_f1_score': 0.3066202}
confusion matrix:
     0   1
0  189  27
1  172  44
new oracle model saved
early stop counter: 19
val acc:0.6165884137153625, best validation acc: 0.6807511448860168, corresponding to test acc:                         0.4513888955116272 / 0.5393518805503845
after epoch: 25,now: 2024-07-20 15:55:18.891450,epoch time: 0:00:58.518766,used: 0:24:19.678524,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_15_30_59_seed_2_22504811
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.90772253, 'precision': 0.9125395, 'recall': 0.9081537, 'specificity': 0.9081537, 'f1': 0.9075114, 'auroc': 0.96253896, 'binary_precision': 0.9591241, 'binary_recall': 0.85324675, 'binary_specificity': 0.9630607, 'binary_f1_score': 0.9030928}
confusion matrix:
      0     1
0  1460    56
1   226  1314
---- Validation: 
scalar performance:
{'acc': 0.6173709, 'precision': 0.704188, 'recall': 0.6083297, 'specificity': 0.6083297, 'f1': 0.56183136, 'auroc': 0.75865614, 'binary_precision': 0.8308458, 'binary_recall': 0.26848873, 'binary_specificity': 0.9481707, 'binary_f1_score': 0.40583232}
confusion matrix:
     0    1
0  622   34
1  455  167
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5393519, 'precision': 0.571632, 'recall': 0.5393518, 'specificity': 0.5393518, 'f1': 0.48086637, 'auroc': 0.65725744, 'binary_precision': 0.6197183, 'binary_recall': 0.2037037, 'binary_specificity': 0.875, 'binary_f1_score': 0.3066202}
confusion matrix:
     0   1
0  189  27
1  172  44
early stop counter: 20
val acc:0.6173709034919739, best validation acc: 0.6807511448860168, corresponding to test acc:                         0.4513888955116272 / 0.5393518805503845
after epoch: 26,now: 2024-07-20 15:56:17.604430,epoch time: 0:00:58.712980,used: 0:25:18.391504,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_15_30_59_seed_2_22504811
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.90379584, 'precision': 0.91077495, 'recall': 0.90431416, 'specificity': 0.90431416, 'f1': 0.90346086, 'auroc': 0.95965886, 'binary_precision': 0.96631736, 'binary_recall': 0.8383117, 'binary_specificity': 0.97031665, 'binary_f1_score': 0.89777464}
confusion matrix:
      0     1
0  1471    45
1   249  1291
---- Validation: 
scalar performance:
{'acc': 0.6173709, 'precision': 0.7026303, 'recall': 0.6083714, 'specificity': 0.6083714, 'f1': 0.56238854, 'auroc': 0.7611535, 'binary_precision': 0.82758623, 'binary_recall': 0.27009645, 'binary_specificity': 0.94664633, 'binary_f1_score': 0.4072727}
confusion matrix:
     0    1
0  621   35
1  454  168
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5347222, 'precision': 0.5605042, 'recall': 0.5347222, 'specificity': 0.5347222, 'f1': 0.4792465, 'auroc': 0.66177976, 'binary_precision': 0.6, 'binary_recall': 0.20833333, 'binary_specificity': 0.8611111, 'binary_f1_score': 0.30927834}
confusion matrix:
     0   1
0  186  30
1  171  45
early stop counter: 21
val acc:0.6173709034919739, best validation acc: 0.6807511448860168, corresponding to test acc:                         0.4513888955116272 / 0.5393518805503845
after epoch: 27,now: 2024-07-20 15:57:16.481502,epoch time: 0:00:58.877072,used: 0:26:17.268576,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_15_30_59_seed_2_22504811
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.91753924, 'precision': 0.920628, 'recall': 0.91788375, 'specificity': 0.91788375, 'f1': 0.9174284, 'auroc': 0.96634114, 'binary_precision': 0.95868945, 'binary_recall': 0.874026, 'binary_specificity': 0.96174145, 'binary_f1_score': 0.9144022}
confusion matrix:
      0     1
0  1458    58
1   194  1346
---- Validation: 
scalar performance:
{'acc': 0.62910795, 'precision': 0.70561403, 'recall': 0.6206376, 'specificity': 0.6206376, 'f1': 0.582255, 'auroc': 0.76370966, 'binary_precision': 0.8245614, 'binary_recall': 0.3022508, 'binary_specificity': 0.9390244, 'binary_f1_score': 0.44235295}
confusion matrix:
     0    1
0  616   40
1  434  188
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5462963, 'precision': 0.57389164, 'recall': 0.5462963, 'specificity': 0.5462963, 'f1': 0.49957442, 'auroc': 0.66943157, 'binary_precision': 0.61904764, 'binary_recall': 0.24074075, 'binary_specificity': 0.8518519, 'binary_f1_score': 0.34666666}
confusion matrix:
     0   1
0  184  32
1  164  52
new oracle model saved
early stop counter: 22
val acc:0.6291079521179199, best validation acc: 0.6807511448860168, corresponding to test acc:                         0.4513888955116272 / 0.5462962985038757
after epoch: 28,now: 2024-07-20 15:58:15.369540,epoch time: 0:00:58.888038,used: 0:27:16.156614,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_15_30_59_seed_2_22504811
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.924411, 'precision': 0.92769194, 'recall': 0.92476356, 'specificity': 0.92476356, 'f1': 0.92430377, 'auroc': 0.9739969, 'binary_precision': 0.9671663, 'binary_recall': 0.8798701, 'binary_specificity': 0.969657, 'binary_f1_score': 0.9214553}
confusion matrix:
      0     1
0  1470    46
1   185  1355
---- Validation: 
scalar performance:
{'acc': 0.6158059, 'precision': 0.7012361, 'recall': 0.60676366, 'specificity': 0.60676366, 'f1': 0.5600393, 'auroc': 0.76432, 'binary_precision': 0.82587063, 'binary_recall': 0.26688102, 'binary_specificity': 0.94664633, 'binary_f1_score': 0.40340218}
confusion matrix:
     0    1
0  621   35
1  456  166
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.537037, 'precision': 0.56386757, 'recall': 0.537037, 'specificity': 0.537037, 'f1': 0.48270905, 'auroc': 0.6742755, 'binary_precision': 0.6052632, 'binary_recall': 0.21296297, 'binary_specificity': 0.8611111, 'binary_f1_score': 0.3150685}
confusion matrix:
     0   1
0  186  30
1  170  46
early stop counter: 23
val acc:0.6158059239387512, best validation acc: 0.6807511448860168, corresponding to test acc:                         0.4513888955116272 / 0.5462962985038757
after epoch: 29,now: 2024-07-20 15:59:13.413867,epoch time: 0:00:58.044327,used: 0:28:14.200941,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_15_30_59_seed_2_22504811
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.9217932, 'precision': 0.9244047, 'recall': 0.9221096, 'specificity': 0.9221096, 'f1': 0.92170763, 'auroc': 0.9672258, 'binary_precision': 0.95971733, 'binary_recall': 0.8818182, 'binary_specificity': 0.96240103, 'binary_f1_score': 0.91912013}
confusion matrix:
      0     1
0  1459    57
1   182  1358
---- Validation: 
scalar performance:
{'acc': 0.6236307, 'precision': 0.70806444, 'recall': 0.61480224, 'specificity': 0.61480224, 'f1': 0.57170236, 'auroc': 0.7661115, 'binary_precision': 0.8341232, 'binary_recall': 0.2829582, 'binary_specificity': 0.94664633, 'binary_f1_score': 0.42256904}
confusion matrix:
     0    1
0  621   35
1  446  176
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5439815, 'precision': 0.5721747, 'recall': 0.5439815, 'specificity': 0.5439815, 'f1': 0.4946288, 'auroc': 0.6805556, 'binary_precision': 0.61728394, 'binary_recall': 0.23148148, 'binary_specificity': 0.8564815, 'binary_f1_score': 0.33670032}
confusion matrix:
     0   1
0  185  31
1  166  50
early stop counter: 24
val acc:0.623630702495575, best validation acc: 0.6807511448860168, corresponding to test acc:                         0.4513888955116272 / 0.5462962985038757
after epoch: 30,now: 2024-07-20 16:00:11.812071,epoch time: 0:00:58.398204,used: 0:29:12.599145,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_15_30_59_seed_2_22504811
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 0:29:12.599145 at 2024-07-20 16:00:11.812071
persisted model performance metric: 

scalar performance:
{'acc': 0.4513889, 'precision': 0.44621387, 'recall': 0.4513889, 'specificity': 0.4513889, 'f1': 0.43786752, 'auroc': 0.4646991, 'binary_precision': 0.4295302, 'binary_recall': 0.2962963, 'binary_specificity': 0.6064815, 'binary_f1_score': 0.35068494}
confusion matrix:
     0   1
0  131  85
1  152  64
oracle model performance metric: 

scalar performance:
{'acc': 0.5462963, 'precision': 0.57389164, 'recall': 0.5462963, 'specificity': 0.5462963, 'f1': 0.49957442, 'auroc': 0.66943157, 'binary_precision': 0.61904764, 'binary_recall': 0.24074075, 'binary_specificity': 0.8518519, 'binary_f1_score': 0.34666666}
confusion matrix:
     0   1
0  184  32
1  164  52
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_halffreezeblocks_2024-07-20_12-47-21/rule_results/1.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_halffreezeblocks_2024-07-20_12-47-21/confusion_matrix/1.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 195607 KiB |   7828 MiB | 185299 GiB | 185298 GiB |
|       from large pool | 179211 KiB |   7805 MiB | 182834 GiB | 182834 GiB |
|       from small pool |  16396 KiB |     36 MiB |   2464 GiB |   2464 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 195607 KiB |   7828 MiB | 185299 GiB | 185298 GiB |
|       from large pool | 179211 KiB |   7805 MiB | 182834 GiB | 182834 GiB |
|       from small pool |  16396 KiB |     36 MiB |   2464 GiB |   2464 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 195188 KiB |   7827 MiB | 185274 GiB | 185274 GiB |
|       from large pool | 178979 KiB |   7804 MiB | 182815 GiB | 182815 GiB |
|       from small pool |  16209 KiB |     36 MiB |   2459 GiB |   2459 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   8510 MiB |   8524 MiB |  25068 MiB |  16558 MiB |
|       from large pool |   8472 MiB |   8486 MiB |  24998 MiB |  16526 MiB |
|       from small pool |     38 MiB |     42 MiB |     70 MiB |     32 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  39913 KiB | 732464 KiB |  98948 GiB |  98948 GiB |
|       from large pool |  31733 KiB | 730714 KiB |  96476 GiB |  96476 GiB |
|       from small pool |   8180 KiB |  22319 KiB |   2472 GiB |   2471 GiB |
|---------------------------------------------------------------------------|
| Allocations           |     788    |    1679    |   31313 K  |   31312 K  |
|       from large pool |      79    |     762    |   17022 K  |   17021 K  |
|       from small pool |     709    |    1017    |   14291 K  |   14290 K  |
|---------------------------------------------------------------------------|
| Active allocs         |     788    |    1679    |   31313 K  |   31312 K  |
|       from large pool |      79    |     762    |   17022 K  |   17021 K  |
|       from small pool |     709    |    1017    |   14291 K  |   14290 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     367    |     369    |    1059    |     692    |
|       from large pool |     348    |     349    |    1024    |     676    |
|       from small pool |      19    |      21    |      35    |      16    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      44    |     382    |   18424 K  |   18424 K  |
|       from large pool |      11    |     351    |   12107 K  |   12107 K  |
|       from small pool |      33    |     215    |    6317 K  |    6317 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   7828 MiB | 185299 GiB | 185299 GiB |
|       from large pool |  16640 KiB |   7805 MiB | 182834 GiB | 182834 GiB |
|       from small pool |      0 KiB |     36 MiB |   2464 GiB |   2464 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   7828 MiB | 185299 GiB | 185299 GiB |
|       from large pool |  16640 KiB |   7805 MiB | 182834 GiB | 182834 GiB |
|       from small pool |      0 KiB |     36 MiB |   2464 GiB |   2464 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   7827 MiB | 185274 GiB | 185274 GiB |
|       from large pool |  16640 KiB |   7804 MiB | 182815 GiB | 182815 GiB |
|       from small pool |      0 KiB |     36 MiB |   2459 GiB |   2459 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 235520 KiB |   8524 MiB |  25068 MiB |  24838 MiB |
|       from large pool | 210944 KiB |   8486 MiB |  24998 MiB |  24792 MiB |
|       from small pool |  24576 KiB |     42 MiB |     70 MiB |     46 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  30464 KiB | 732464 KiB |  98948 GiB |  98948 GiB |
|       from large pool |  30464 KiB | 730714 KiB |  96476 GiB |  96476 GiB |
|       from small pool |      0 KiB |  22319 KiB |   2472 GiB |   2472 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    1679    |   31313 K  |   31313 K  |
|       from large pool |       2    |     762    |   17022 K  |   17022 K  |
|       from small pool |       0    |    1017    |   14291 K  |   14291 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    1679    |   31313 K  |   31313 K  |
|       from large pool |       2    |     762    |   17022 K  |   17022 K  |
|       from small pool |       0    |    1017    |   14291 K  |   14291 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      22    |     369    |    1059    |    1037    |
|       from large pool |      10    |     349    |    1024    |    1014    |
|       from small pool |      12    |      21    |      35    |      23    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     382    |   18424 K  |   18424 K  |
|       from large pool |       3    |     351    |   12107 K  |   12107 K  |
|       from small pool |       0    |     215    |    6317 K  |    6317 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Sat Jul 20 16:00:48 2024]
Finished job 0.
1 of 1 steps (100%) done
