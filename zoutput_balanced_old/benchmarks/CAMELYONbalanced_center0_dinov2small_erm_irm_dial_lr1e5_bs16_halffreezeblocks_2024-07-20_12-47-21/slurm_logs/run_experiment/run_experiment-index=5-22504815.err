Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Sat Jul 20 14:59:54 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_halffreezeblocks_2024-07-20_12-47-21/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_halffreezeblocks_2024-07-20_12-47-21/rule_results/5.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=5
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/swiglu_ffn.py:51: UserWarning: xFormers is not available (SwiGLU)
  warnings.warn("xFormers is not available (SwiGLU)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/attention.py:33: UserWarning: xFormers is not available (Attention)
  warnings.warn("xFormers is not available (Attention)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/block.py:40: UserWarning: xFormers is not available (Block)
  warnings.warn("xFormers is not available (Block)")
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'888c1ef2'
model name: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_15_02_20_seed_0_22504815

 Experiment start at: 2024-07-20 15:02:21.015580
before training, model accuracy: 0.569767415523529
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.54785156, 'precision': 0.5487145, 'recall': 0.5465541, 'specificity': 0.5465541, 'f1': 0.5421437, 'auroc': 0.5841306, 'binary_precision': 0.5446237, 'binary_recall': 0.65144694, 'binary_specificity': 0.44166118, 'binary_f1_score': 0.593265}
confusion matrix:
     0     1
0  670   847
1  542  1013
---- Validation: 
scalar performance:
{'acc': 0.636646, 'precision': 0.63999736, 'recall': 0.6354029, 'specificity': 0.6354029, 'f1': 0.6331351, 'auroc': 0.70406246, 'binary_precision': 0.65844405, 'binary_recall': 0.5464567, 'binary_specificity': 0.72434914, 'binary_f1_score': 0.5972461}
confusion matrix:
     0    1
0  473  180
1  288  347
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.63255817, 'precision': 0.6368326, 'recall': 0.6325581, 'specificity': 0.6325581, 'f1': 0.629666, 'auroc': 0.6716063, 'binary_precision': 0.66101694, 'binary_recall': 0.54418606, 'binary_specificity': 0.7209302, 'binary_f1_score': 0.5969387}
confusion matrix:
     0    1
0  155   60
1   98  117
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-20 15:03:40.150764,epoch time: 0:01:19.135184,used: 0:01:19.135184,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_15_02_20_seed_0_22504815
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.6819661, 'precision': 0.6853077, 'recall': 0.68100077, 'specificity': 0.68100077, 'f1': 0.6797596, 'auroc': 0.748434, 'binary_precision': 0.663467, 'binary_recall': 0.7551414, 'binary_specificity': 0.60686016, 'binary_f1_score': 0.70634204}
confusion matrix:
     0     1
0  920   596
1  381  1175
---- Validation: 
scalar performance:
{'acc': 0.6304348, 'precision': 0.642096, 'recall': 0.6282789, 'specificity': 0.6282789, 'f1': 0.62034225, 'auroc': 0.7119919, 'binary_precision': 0.67945826, 'binary_recall': 0.47401574, 'binary_specificity': 0.7825421, 'binary_f1_score': 0.5584416}
confusion matrix:
     0    1
0  511  142
1  334  301
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6302326, 'precision': 0.6433333, 'recall': 0.6302326, 'specificity': 0.6302326, 'f1': 0.6215857, 'auroc': 0.69207144, 'binary_precision': 0.68666667, 'binary_recall': 0.47906977, 'binary_specificity': 0.7813954, 'binary_f1_score': 0.56438357}
confusion matrix:
     0    1
0  168   47
1  112  103
early stop counter: 1
val acc:0.6304348111152649, best validation acc: 0.6366459727287292, corresponding to test acc:                         0.6325581669807434 / 0.6325581669807434
after epoch: 2,now: 2024-07-20 15:04:37.284151,epoch time: 0:00:57.133387,used: 0:02:16.268571,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_15_02_20_seed_0_22504815
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.7451172, 'precision': 0.745077, 'recall': 0.74509513, 'specificity': 0.74509513, 'f1': 0.74508405, 'auroc': 0.8123988, 'binary_precision': 0.7491941, 'binary_recall': 0.74678665, 'binary_specificity': 0.7434037, 'binary_f1_score': 0.7479884}
confusion matrix:
      0     1
0  1127   389
1   394  1162
---- Validation: 
scalar performance:
{'acc': 0.6226708, 'precision': 0.64068615, 'recall': 0.6200142, 'specificity': 0.6200142, 'f1': 0.60715145, 'auroc': 0.7197068, 'binary_precision': 0.6876574, 'binary_recall': 0.42992127, 'binary_specificity': 0.8101072, 'binary_f1_score': 0.5290698}
confusion matrix:
     0    1
0  529  124
1  362  273
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6348837, 'precision': 0.65472996, 'recall': 0.6348837, 'specificity': 0.6348837, 'f1': 0.622788, 'auroc': 0.7103299, 'binary_precision': 0.71014494, 'binary_recall': 0.45581394, 'binary_specificity': 0.81395346, 'binary_f1_score': 0.5552408}
confusion matrix:
     0   1
0  175  40
1  117  98
new oracle model saved
early stop counter: 2
val acc:0.6226708292961121, best validation acc: 0.6366459727287292, corresponding to test acc:                         0.6325581669807434 / 0.6348837018013
after epoch: 3,now: 2024-07-20 15:05:34.686540,epoch time: 0:00:57.402389,used: 0:03:13.670960,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_15_02_20_seed_0_22504815
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.7861328, 'precision': 0.78631955, 'recall': 0.78628135, 'specificity': 0.78628135, 'f1': 0.78613174, 'auroc': 0.8537526, 'binary_precision': 0.797351, 'binary_recall': 0.77427655, 'binary_specificity': 0.7982861, 'binary_f1_score': 0.78564435}
confusion matrix:
      0     1
0  1211   306
1   351  1204
---- Validation: 
scalar performance:
{'acc': 0.60947204, 'precision': 0.6356548, 'recall': 0.6062377, 'specificity': 0.6062377, 'f1': 0.58562243, 'auroc': 0.7232398, 'binary_precision': 0.69186044, 'binary_recall': 0.37480316, 'binary_specificity': 0.8376723, 'binary_f1_score': 0.48621038}
confusion matrix:
     0    1
0  547  106
1  397  238
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6255814, 'precision': 0.6544869, 'recall': 0.6255814, 'specificity': 0.6255814, 'f1': 0.6072079, 'auroc': 0.72296375, 'binary_precision': 0.72131145, 'binary_recall': 0.40930232, 'binary_specificity': 0.8418605, 'binary_f1_score': 0.5222551}
confusion matrix:
     0   1
0  181  34
1  127  88
early stop counter: 3
val acc:0.6094720363616943, best validation acc: 0.6366459727287292, corresponding to test acc:                         0.6325581669807434 / 0.6348837018013
after epoch: 4,now: 2024-07-20 15:06:31.947282,epoch time: 0:00:57.260742,used: 0:04:10.931702,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_15_02_20_seed_0_22504815
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.8177083, 'precision': 0.8223629, 'recall': 0.81852, 'specificity': 0.81852, 'f1': 0.8172843, 'auroc': 0.87872803, 'binary_precision': 0.8646672, 'binary_recall': 0.75915223, 'binary_specificity': 0.8778878, 'binary_f1_score': 0.8084816}
confusion matrix:
      0     1
0  1330   185
1   375  1182
---- Validation: 
scalar performance:
{'acc': 0.5923913, 'precision': 0.6246051, 'recall': 0.5886544, 'specificity': 0.5886544, 'f1': 0.5588808, 'auroc': 0.72930753, 'binary_precision': 0.68456376, 'binary_recall': 0.32125986, 'binary_specificity': 0.856049, 'binary_f1_score': 0.43729904}
confusion matrix:
     0    1
0  559   94
1  431  204
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.60465115, 'precision': 0.643627, 'recall': 0.60465115, 'specificity': 0.60465115, 'f1': 0.57587785, 'auroc': 0.73646295, 'binary_precision': 0.7184466, 'binary_recall': 0.34418604, 'binary_specificity': 0.8651163, 'binary_f1_score': 0.46540877}
confusion matrix:
     0   1
0  186  29
1  141  74
early stop counter: 4
val acc:0.592391312122345, best validation acc: 0.6366459727287292, corresponding to test acc:                         0.6325581669807434 / 0.6348837018013
after epoch: 5,now: 2024-07-20 15:07:29.361939,epoch time: 0:00:57.414657,used: 0:05:08.346359,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_15_02_20_seed_0_22504815
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.83658856, 'precision': 0.8400818, 'recall': 0.8372791, 'specificity': 0.8372791, 'f1': 0.8363388, 'auroc': 0.8934559, 'binary_precision': 0.8781362, 'binary_recall': 0.78676945, 'binary_specificity': 0.8877888, 'binary_f1_score': 0.8299458}
confusion matrix:
      0     1
0  1345   170
1   332  1225
---- Validation: 
scalar performance:
{'acc': 0.5939441, 'precision': 0.6262281, 'recall': 0.5902292, 'specificity': 0.5902292, 'f1': 0.5609668, 'auroc': 0.7332288, 'binary_precision': 0.68666667, 'binary_recall': 0.32440946, 'binary_specificity': 0.856049, 'binary_f1_score': 0.44064173}
confusion matrix:
     0    1
0  559   94
1  429  206
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6232558, 'precision': 0.6609054, 'recall': 0.62325585, 'specificity': 0.62325585, 'f1': 0.5998484, 'auroc': 0.7457869, 'binary_precision': 0.7387387, 'binary_recall': 0.38139534, 'binary_specificity': 0.8651163, 'binary_f1_score': 0.50306743}
confusion matrix:
     0   1
0  186  29
1  133  82
early stop counter: 5
val acc:0.5939440727233887, best validation acc: 0.6366459727287292, corresponding to test acc:                         0.6325581669807434 / 0.6348837018013
after epoch: 6,now: 2024-07-20 15:08:26.964236,epoch time: 0:00:57.602297,used: 0:06:05.948656,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_15_02_20_seed_0_22504815
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.8421224, 'precision': 0.8460736, 'recall': 0.84288746, 'specificity': 0.84288746, 'f1': 0.84185207, 'auroc': 0.89744663, 'binary_precision': 0.8868061, 'binary_recall': 0.7894737, 'binary_specificity': 0.8963012, 'binary_f1_score': 0.8353141}
confusion matrix:
      0     1
0  1357   157
1   328  1230
---- Validation: 
scalar performance:
{'acc': 0.5931677, 'precision': 0.6259772, 'recall': 0.58942014, 'specificity': 0.58942014, 'f1': 0.5595167, 'auroc': 0.73735756, 'binary_precision': 0.68686867, 'binary_recall': 0.32125986, 'binary_specificity': 0.8575804, 'binary_f1_score': 0.43776825}
confusion matrix:
     0    1
0  560   93
1  431  204
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6232558, 'precision': 0.6609054, 'recall': 0.62325585, 'specificity': 0.62325585, 'f1': 0.5998484, 'auroc': 0.75420225, 'binary_precision': 0.7387387, 'binary_recall': 0.38139534, 'binary_specificity': 0.8651163, 'binary_f1_score': 0.50306743}
confusion matrix:
     0   1
0  186  29
1  133  82
early stop counter: 6
val acc:0.5931677222251892, best validation acc: 0.6366459727287292, corresponding to test acc:                         0.6325581669807434 / 0.6348837018013
after epoch: 7,now: 2024-07-20 15:09:24.446058,epoch time: 0:00:57.481822,used: 0:07:03.430478,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_15_02_20_seed_0_22504815
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.8567708, 'precision': 0.8643335, 'recall': 0.8577131, 'specificity': 0.8577131, 'f1': 0.85623235, 'auroc': 0.91131824, 'binary_precision': 0.92018074, 'binary_recall': 0.78534704, 'binary_specificity': 0.93007916, 'binary_f1_score': 0.8474341}
confusion matrix:
      0     1
0  1410   106
1   334  1222
---- Validation: 
scalar performance:
{'acc': 0.5939441, 'precision': 0.630962, 'recall': 0.5900556, 'specificity': 0.5900556, 'f1': 0.55763626, 'auroc': 0.74217117, 'binary_precision': 0.6971831, 'binary_recall': 0.31181103, 'binary_specificity': 0.86830014, 'binary_f1_score': 0.43090317}
confusion matrix:
     0    1
0  567   86
1  437  198
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.627907, 'precision': 0.6689817, 'recall': 0.627907, 'specificity': 0.627907, 'f1': 0.6038327, 'auroc': 0.7617307, 'binary_precision': 0.7522936, 'binary_recall': 0.38139534, 'binary_specificity': 0.8744186, 'binary_f1_score': 0.50617284}
confusion matrix:
     0   1
0  188  27
1  133  82
early stop counter: 7
val acc:0.5939440727233887, best validation acc: 0.6366459727287292, corresponding to test acc:                         0.6325581669807434 / 0.6348837018013
after epoch: 8,now: 2024-07-20 15:10:21.457652,epoch time: 0:00:57.011594,used: 0:08:00.442072,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_15_02_20_seed_0_22504815
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.86002606, 'precision': 0.8666144, 'recall': 0.86081564, 'specificity': 0.86081564, 'f1': 0.85956514, 'auroc': 0.9217982, 'binary_precision': 0.91877794, 'binary_recall': 0.7934363, 'binary_specificity': 0.928195, 'binary_f1_score': 0.85151935}
confusion matrix:
      0     1
0  1409   109
1   321  1233
---- Validation: 
scalar performance:
{'acc': 0.5986025, 'precision': 0.6351639, 'recall': 0.5948017, 'specificity': 0.5948017, 'f1': 0.5643818, 'auroc': 0.7464856, 'binary_precision': 0.7020548, 'binary_recall': 0.32283464, 'binary_specificity': 0.8667688, 'binary_f1_score': 0.44228694}
confusion matrix:
     0    1
0  566   87
1  430  205
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6302326, 'precision': 0.6671108, 'recall': 0.6302326, 'specificity': 0.6302326, 'f1': 0.60864115, 'auroc': 0.770622, 'binary_precision': 0.74561405, 'binary_recall': 0.39534885, 'binary_specificity': 0.8651163, 'binary_f1_score': 0.5167174}
confusion matrix:
     0   1
0  186  29
1  130  85
early stop counter: 8
val acc:0.5986024737358093, best validation acc: 0.6366459727287292, corresponding to test acc:                         0.6325581669807434 / 0.6348837018013
after epoch: 9,now: 2024-07-20 15:11:18.881787,epoch time: 0:00:57.424135,used: 0:08:57.866207,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_15_02_20_seed_0_22504815
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.86360675, 'precision': 0.8716297, 'recall': 0.8646184, 'specificity': 0.8646184, 'f1': 0.86307746, 'auroc': 0.92138344, 'binary_precision': 0.9297583, 'binary_recall': 0.790623, 'binary_specificity': 0.93861383, 'binary_f1_score': 0.8545644}
confusion matrix:
      0     1
0  1422    93
1   326  1231
---- Validation: 
scalar performance:
{'acc': 0.5986025, 'precision': 0.6351639, 'recall': 0.5948017, 'specificity': 0.5948017, 'f1': 0.5643818, 'auroc': 0.7493193, 'binary_precision': 0.7020548, 'binary_recall': 0.32283464, 'binary_specificity': 0.8667688, 'binary_f1_score': 0.44228694}
confusion matrix:
     0    1
0  566   87
1  430  205
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6418605, 'precision': 0.6810214, 'recall': 0.6418605, 'specificity': 0.6418605, 'f1': 0.62138367, 'auroc': 0.7766577, 'binary_precision': 0.76521736, 'binary_recall': 0.40930232, 'binary_specificity': 0.8744186, 'binary_f1_score': 0.53333336}
confusion matrix:
     0   1
0  188  27
1  127  88
new oracle model saved
early stop counter: 9
val acc:0.5986024737358093, best validation acc: 0.6366459727287292, corresponding to test acc:                         0.6325581669807434 / 0.6418604850769043
after epoch: 10,now: 2024-07-20 15:12:16.162846,epoch time: 0:00:57.281059,used: 0:09:55.147266,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_15_02_20_seed_0_22504815
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.8649089, 'precision': 0.8706329, 'recall': 0.8658488, 'specificity': 0.8658488, 'f1': 0.86457294, 'auroc': 0.9277148, 'binary_precision': 0.92058825, 'binary_recall': 0.8030789, 'binary_specificity': 0.9286186, 'binary_f1_score': 0.8578281}
confusion matrix:
      0     1
0  1405   108
1   307  1252
---- Validation: 
scalar performance:
{'acc': 0.61568326, 'precision': 0.6489998, 'recall': 0.61223304, 'specificity': 0.61223304, 'f1': 0.5888574, 'auroc': 0.7547479, 'binary_precision': 0.7160494, 'binary_recall': 0.36535433, 'binary_specificity': 0.8591118, 'binary_f1_score': 0.4838373}
confusion matrix:
     0    1
0  561   92
1  403  232
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6534884, 'precision': 0.6927151, 'recall': 0.6534884, 'specificity': 0.6534884, 'f1': 0.63491005, 'auroc': 0.78360194, 'binary_precision': 0.779661, 'binary_recall': 0.427907, 'binary_specificity': 0.87906975, 'binary_f1_score': 0.5525526}
confusion matrix:
     0   1
0  189  26
1  123  92
new oracle model saved
early stop counter: 10
val acc:0.6156832575798035, best validation acc: 0.6366459727287292, corresponding to test acc:                         0.6325581669807434 / 0.6534883975982666
after epoch: 11,now: 2024-07-20 15:13:13.782062,epoch time: 0:00:57.619216,used: 0:10:52.766482,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_15_02_20_seed_0_22504815
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.8805339, 'precision': 0.8868523, 'recall': 0.88150656, 'specificity': 0.88150656, 'f1': 0.88021296, 'auroc': 0.93343806, 'binary_precision': 0.94017726, 'binary_recall': 0.81654906, 'binary_specificity': 0.946464, 'binary_f1_score': 0.87401307}
confusion matrix:
      0     1
0  1432    81
1   286  1273
---- Validation: 
scalar performance:
{'acc': 0.6218944, 'precision': 0.65152, 'recall': 0.6186625, 'specificity': 0.6186625, 'f1': 0.5988034, 'auroc': 0.7582882, 'binary_precision': 0.71511626, 'binary_recall': 0.38740158, 'binary_specificity': 0.84992343, 'binary_f1_score': 0.50255364}
confusion matrix:
     0    1
0  555   98
1  389  246
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.65581393, 'precision': 0.688918, 'recall': 0.65581393, 'specificity': 0.65581393, 'f1': 0.6400453, 'auroc': 0.78944296, 'binary_precision': 0.768, 'binary_recall': 0.44651163, 'binary_specificity': 0.8651163, 'binary_f1_score': 0.56470585}
confusion matrix:
     0   1
0  186  29
1  119  96
new oracle model saved
early stop counter: 11
val acc:0.6218944191932678, best validation acc: 0.6366459727287292, corresponding to test acc:                         0.6325581669807434 / 0.6558139324188232
after epoch: 12,now: 2024-07-20 15:14:11.688652,epoch time: 0:00:57.906590,used: 0:11:50.673072,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_15_02_20_seed_0_22504815
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.8857422, 'precision': 0.8901528, 'recall': 0.8864477, 'specificity': 0.8864477, 'f1': 0.88553405, 'auroc': 0.94280124, 'binary_precision': 0.93501806, 'binary_recall': 0.8322622, 'binary_specificity': 0.94063324, 'binary_f1_score': 0.8806528}
confusion matrix:
      0     1
0  1426    90
1   261  1295
---- Validation: 
scalar performance:
{'acc': 0.63819873, 'precision': 0.66243595, 'recall': 0.63537157, 'specificity': 0.63537157, 'f1': 0.6213103, 'auroc': 0.7636614, 'binary_precision': 0.7217848, 'binary_recall': 0.43307087, 'binary_specificity': 0.8376723, 'binary_f1_score': 0.54133856}
confusion matrix:
     0    1
0  547  106
1  360  275
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6604651, 'precision': 0.6893717, 'recall': 0.6604651, 'specificity': 0.6604651, 'f1': 0.646994, 'auroc': 0.7955003, 'binary_precision': 0.7633588, 'binary_recall': 0.4651163, 'binary_specificity': 0.855814, 'binary_f1_score': 0.57803464}
confusion matrix:
     0    1
0  184   31
1  115  100
new oracle model saved
better model found
persisted
after epoch: 13,now: 2024-07-20 15:15:09.700032,epoch time: 0:00:58.011380,used: 0:12:48.684452,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_15_02_20_seed_0_22504815
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.8844401, 'precision': 0.89241517, 'recall': 0.88542897, 'specificity': 0.88542897, 'f1': 0.8840195, 'auroc': 0.94208586, 'binary_precision': 0.9518797, 'binary_recall': 0.8131021, 'binary_specificity': 0.9577558, 'binary_f1_score': 0.87703496}
confusion matrix:
      0     1
0  1451    64
1   291  1266
---- Validation: 
scalar performance:
{'acc': 0.6273292, 'precision': 0.66350675, 'recall': 0.6239139, 'specificity': 0.6239139, 'f1': 0.6018208, 'auroc': 0.76732945, 'binary_precision': 0.737003, 'binary_recall': 0.37952757, 'binary_specificity': 0.86830014, 'binary_f1_score': 0.5010395}
confusion matrix:
     0    1
0  567   86
1  394  241
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.65581393, 'precision': 0.69073915, 'recall': 0.65581393, 'specificity': 0.65581393, 'f1': 0.6393026, 'auroc': 0.80168736, 'binary_precision': 0.7723577, 'binary_recall': 0.44186047, 'binary_specificity': 0.8697674, 'binary_f1_score': 0.56213015}
confusion matrix:
     0   1
0  187  28
1  120  95
early stop counter: 1
val acc:0.6273291707038879, best validation acc: 0.638198733329773, corresponding to test acc:                         0.6604651212692261 / 0.6604651212692261
after epoch: 14,now: 2024-07-20 15:16:06.894589,epoch time: 0:00:57.194557,used: 0:13:45.879009,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_15_02_20_seed_0_22504815
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.89192706, 'precision': 0.8981579, 'recall': 0.8927566, 'specificity': 0.8927566, 'f1': 0.89163315, 'auroc': 0.9455495, 'binary_precision': 0.95132744, 'binary_recall': 0.8290489, 'binary_specificity': 0.95646435, 'binary_f1_score': 0.885989}
confusion matrix:
      0     1
0  1450    66
1   266  1290
---- Validation: 
scalar performance:
{'acc': 0.6413044, 'precision': 0.67187285, 'recall': 0.638239, 'specificity': 0.638239, 'f1': 0.62158793, 'auroc': 0.77235293, 'binary_precision': 0.74094707, 'binary_recall': 0.41889763, 'binary_specificity': 0.8575804, 'binary_f1_score': 0.53521127}
confusion matrix:
     0    1
0  560   93
1  369  266
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6604651, 'precision': 0.6927575, 'recall': 0.6604651, 'specificity': 0.6604651, 'f1': 0.645623, 'auroc': 0.8088913, 'binary_precision': 0.77165353, 'binary_recall': 0.45581394, 'binary_specificity': 0.8651163, 'binary_f1_score': 0.5730994}
confusion matrix:
     0   1
0  186  29
1  117  98
better model found
persisted
after epoch: 15,now: 2024-07-20 15:17:04.351714,epoch time: 0:00:57.457125,used: 0:14:43.336134,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_15_02_20_seed_0_22504815
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9010417, 'precision': 0.90692735, 'recall': 0.9017606, 'specificity': 0.9017606, 'f1': 0.9007858, 'auroc': 0.9540694, 'binary_precision': 0.958884, 'binary_recall': 0.84041184, 'binary_specificity': 0.9631094, 'binary_f1_score': 0.8957476}
confusion matrix:
      0     1
0  1462    56
1   248  1306
---- Validation: 
scalar performance:
{'acc': 0.6576087, 'precision': 0.6804662, 'recall': 0.6550132, 'specificity': 0.6550132, 'f1': 0.64409256, 'auroc': 0.77690125, 'binary_precision': 0.74129355, 'binary_recall': 0.46929133, 'binary_specificity': 0.8407351, 'binary_f1_score': 0.5747348}
confusion matrix:
     0    1
0  549  104
1  337  298
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6744186, 'precision': 0.6993251, 'recall': 0.67441857, 'specificity': 0.67441857, 'f1': 0.6639199, 'auroc': 0.81445104, 'binary_precision': 0.76978415, 'binary_recall': 0.4976744, 'binary_specificity': 0.8511628, 'binary_f1_score': 0.6045198}
confusion matrix:
     0    1
0  183   32
1  108  107
new oracle model saved
better model found
persisted
after epoch: 16,now: 2024-07-20 15:18:01.937454,epoch time: 0:00:57.585740,used: 0:15:40.921874,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_15_02_20_seed_0_22504815
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.88932294, 'precision': 0.89737344, 'recall': 0.8902161, 'specificity': 0.8902161, 'f1': 0.88890684, 'auroc': 0.9472897, 'binary_precision': 0.9571106, 'binary_recall': 0.81800646, 'binary_specificity': 0.9624258, 'binary_f1_score': 0.88210815}
confusion matrix:
      0     1
0  1460    57
1   283  1272
---- Validation: 
scalar performance:
{'acc': 0.67158383, 'precision': 0.6898581, 'recall': 0.66931665, 'specificity': 0.66931665, 'f1': 0.6616217, 'auroc': 0.78136766, 'binary_precision': 0.7453704, 'binary_recall': 0.50708663, 'binary_specificity': 0.8315467, 'binary_f1_score': 0.6035614}
confusion matrix:
     0    1
0  543  110
1  313  322
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.68604654, 'precision': 0.70476186, 'recall': 0.6860465, 'specificity': 0.6860465, 'f1': 0.67870486, 'auroc': 0.81916714, 'binary_precision': 0.76666665, 'binary_recall': 0.53488374, 'binary_specificity': 0.8372093, 'binary_f1_score': 0.63013697}
confusion matrix:
     0    1
0  180   35
1  100  115
new oracle model saved
better model found
persisted
after epoch: 17,now: 2024-07-20 15:18:59.693098,epoch time: 0:00:57.755644,used: 0:16:38.677518,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_15_02_20_seed_0_22504815
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.8925781, 'precision': 0.89919233, 'recall': 0.89347506, 'specificity': 0.89347506, 'f1': 0.89227104, 'auroc': 0.9542693, 'binary_precision': 0.95410806, 'binary_recall': 0.8278741, 'binary_specificity': 0.9590759, 'binary_f1_score': 0.8865199}
confusion matrix:
      0     1
0  1453    62
1   268  1289
---- Validation: 
scalar performance:
{'acc': 0.6832298, 'precision': 0.6961245, 'recall': 0.68134475, 'specificity': 0.68134475, 'f1': 0.67648315, 'auroc': 0.78767407, 'binary_precision': 0.7430407, 'binary_recall': 0.5464567, 'binary_specificity': 0.8162328, 'binary_f1_score': 0.6297641}
confusion matrix:
     0    1
0  533  120
1  288  347
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7139535, 'precision': 0.7267101, 'recall': 0.7139535, 'specificity': 0.7139535, 'f1': 0.70987225, 'auroc': 0.8252244, 'binary_precision': 0.7804878, 'binary_recall': 0.59534883, 'binary_specificity': 0.83255816, 'binary_f1_score': 0.6754617}
confusion matrix:
     0    1
0  179   36
1   87  128
new oracle model saved
better model found
persisted
after epoch: 18,now: 2024-07-20 15:19:57.508047,epoch time: 0:00:57.814949,used: 0:17:36.492467,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_15_02_20_seed_0_22504815
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9085286, 'precision': 0.91368794, 'recall': 0.909199, 'specificity': 0.909199, 'f1': 0.9083301, 'auroc': 0.9630079, 'binary_precision': 0.9629091, 'binary_recall': 0.8519949, 'binary_specificity': 0.9664032, 'binary_f1_score': 0.90406287}
confusion matrix:
      0     1
0  1467    51
1   230  1324
---- Validation: 
scalar performance:
{'acc': 0.6925466, 'precision': 0.70448524, 'recall': 0.6907718, 'specificity': 0.6907718, 'f1': 0.6866965, 'auroc': 0.79303515, 'binary_precision': 0.7505241, 'binary_recall': 0.56377953, 'binary_specificity': 0.81776416, 'binary_f1_score': 0.6438849}
confusion matrix:
     0    1
0  534  119
1  277  358
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7209302, 'precision': 0.73251975, 'recall': 0.7209302, 'specificity': 0.7209302, 'f1': 0.7174089, 'auroc': 0.83119524, 'binary_precision': 0.78443116, 'binary_recall': 0.60930234, 'binary_specificity': 0.83255816, 'binary_f1_score': 0.68586385}
confusion matrix:
     0    1
0  179   36
1   84  131
new oracle model saved
better model found
persisted
after epoch: 19,now: 2024-07-20 15:20:54.925695,epoch time: 0:00:57.417648,used: 0:18:33.910115,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_15_02_20_seed_0_22504815
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9003906, 'precision': 0.90603125, 'recall': 0.9012562, 'specificity': 0.9012562, 'f1': 0.9001651, 'auroc': 0.9585096, 'binary_precision': 0.9576023, 'binary_recall': 0.84082156, 'binary_specificity': 0.9616909, 'binary_f1_score': 0.8954204}
confusion matrix:
      0     1
0  1456    58
1   248  1310
---- Validation: 
scalar performance:
{'acc': 0.7049689, 'precision': 0.71455276, 'recall': 0.7034137, 'specificity': 0.7034137, 'f1': 0.70057654, 'auroc': 0.7973641, 'binary_precision': 0.7565392, 'binary_recall': 0.592126, 'binary_specificity': 0.8147014, 'binary_f1_score': 0.66431093}
confusion matrix:
     0    1
0  532  121
1  259  376
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.74418604, 'precision': 0.75206006, 'recall': 0.74418604, 'specificity': 0.74418604, 'f1': 0.74217254, 'auroc': 0.8351541, 'binary_precision': 0.7966102, 'binary_recall': 0.65581393, 'binary_specificity': 0.83255816, 'binary_f1_score': 0.71938777}
confusion matrix:
     0    1
0  179   36
1   74  141
new oracle model saved
better model found
persisted
after epoch: 20,now: 2024-07-20 15:21:52.406634,epoch time: 0:00:57.480939,used: 0:19:31.391054,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_15_02_20_seed_0_22504815
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.8961589, 'precision': 0.90298116, 'recall': 0.8969344, 'specificity': 0.8969344, 'f1': 0.8958361, 'auroc': 0.95799696, 'binary_precision': 0.9584261, 'binary_recall': 0.83075935, 'binary_specificity': 0.9631094, 'binary_f1_score': 0.8900379}
confusion matrix:
      0     1
0  1462    56
1   263  1291
---- Validation: 
scalar performance:
{'acc': 0.7119565, 'precision': 0.7227142, 'recall': 0.71034837, 'specificity': 0.71034837, 'f1': 0.7073844, 'auroc': 0.8009116, 'binary_precision': 0.76829267, 'binary_recall': 0.5952756, 'binary_specificity': 0.82542115, 'binary_f1_score': 0.6708074}
confusion matrix:
     0    1
0  539  114
1  257  378
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.74651164, 'precision': 0.7548989, 'recall': 0.7465116, 'specificity': 0.7465116, 'f1': 0.74440914, 'auroc': 0.8397404, 'binary_precision': 0.8011364, 'binary_recall': 0.65581393, 'binary_specificity': 0.8372093, 'binary_f1_score': 0.72122765}
confusion matrix:
     0    1
0  180   35
1   74  141
new oracle model saved
better model found
persisted
after epoch: 21,now: 2024-07-20 15:22:49.714348,epoch time: 0:00:57.307714,used: 0:20:28.698768,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_15_02_20_seed_0_22504815
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9046224, 'precision': 0.91176856, 'recall': 0.9055438, 'specificity': 0.9055438, 'f1': 0.9043328, 'auroc': 0.95664424, 'binary_precision': 0.9695394, 'binary_recall': 0.83815026, 'binary_specificity': 0.9729373, 'binary_f1_score': 0.8990699}
confusion matrix:
      0     1
0  1474    41
1   252  1305
---- Validation: 
scalar performance:
{'acc': 0.71040374, 'precision': 0.7241807, 'recall': 0.7085999, 'specificity': 0.7085999, 'f1': 0.70470023, 'auroc': 0.80508864, 'binary_precision': 0.7763713, 'binary_recall': 0.57952756, 'binary_specificity': 0.8376723, 'binary_f1_score': 0.66366094}
confusion matrix:
     0    1
0  547  106
1  267  368
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.74651164, 'precision': 0.75581443, 'recall': 0.74651164, 'specificity': 0.74651164, 'f1': 0.7441859, 'auroc': 0.8436128, 'binary_precision': 0.8045977, 'binary_recall': 0.6511628, 'binary_specificity': 0.8418605, 'binary_f1_score': 0.71979433}
confusion matrix:
     0    1
0  181   34
1   75  140
early stop counter: 1
val acc:0.7104037404060364, best validation acc: 0.7119565010070801, corresponding to test acc:                         0.7465116381645203 / 0.7465116381645203
after epoch: 22,now: 2024-07-20 15:23:47.140568,epoch time: 0:00:57.426220,used: 0:21:26.124988,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_15_02_20_seed_0_22504815
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.9082031, 'precision': 0.914907, 'recall': 0.90909404, 'specificity': 0.90909404, 'f1': 0.9079471, 'auroc': 0.96148634, 'binary_precision': 0.9711752, 'binary_recall': 0.84393066, 'binary_specificity': 0.9742574, 'binary_f1_score': 0.9030928}
confusion matrix:
      0     1
0  1476    39
1   243  1314
---- Validation: 
scalar performance:
{'acc': 0.7259317, 'precision': 0.7358581, 'recall': 0.7244348, 'specificity': 0.7244348, 'f1': 0.7221123, 'auroc': 0.80876637, 'binary_precision': 0.7808765, 'binary_recall': 0.61732286, 'binary_specificity': 0.8315467, 'binary_f1_score': 0.6895339}
confusion matrix:
     0    1
0  543  110
1  243  392
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.75813955, 'precision': 0.76558566, 'recall': 0.75813955, 'specificity': 0.75813955, 'f1': 0.75643235, 'auroc': 0.8480909, 'binary_precision': 0.81005585, 'binary_recall': 0.6744186, 'binary_specificity': 0.8418605, 'binary_f1_score': 0.73604065}
confusion matrix:
     0    1
0  181   34
1   70  145
new oracle model saved
better model found
persisted
after epoch: 23,now: 2024-07-20 15:24:44.490494,epoch time: 0:00:57.349926,used: 0:22:23.474914,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_15_02_20_seed_0_22504815
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.90625, 'precision': 0.9148611, 'recall': 0.90725625, 'specificity': 0.90725625, 'f1': 0.90589756, 'auroc': 0.9649974, 'binary_precision': 0.9781462, 'binary_recall': 0.83365446, 'binary_specificity': 0.9808581, 'binary_f1_score': 0.9001387}
confusion matrix:
      0     1
0  1486    29
1   259  1298
---- Validation: 
scalar performance:
{'acc': 0.73059005, 'precision': 0.7404337, 'recall': 0.7291158, 'specificity': 0.7291158, 'f1': 0.72693574, 'auroc': 0.81218606, 'binary_precision': 0.78571427, 'binary_recall': 0.62362206, 'binary_specificity': 0.8346095, 'binary_f1_score': 0.6953468}
confusion matrix:
     0    1
0  545  108
1  239  396
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7651163, 'precision': 0.7723333, 'recall': 0.7651163, 'specificity': 0.7651163, 'f1': 0.7635497, 'auroc': 0.8507085, 'binary_precision': 0.81666666, 'binary_recall': 0.68372095, 'binary_specificity': 0.8465116, 'binary_f1_score': 0.74430376}
confusion matrix:
     0    1
0  182   33
1   68  147
new oracle model saved
better model found
persisted
after epoch: 24,now: 2024-07-20 15:25:42.111028,epoch time: 0:00:57.620534,used: 0:23:21.095448,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_15_02_20_seed_0_22504815
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.91015625, 'precision': 0.9166409, 'recall': 0.91098887, 'specificity': 0.91098887, 'f1': 0.9099119, 'auroc': 0.96732116, 'binary_precision': 0.9719764, 'binary_recall': 0.8470437, 'binary_specificity': 0.97493404, 'binary_f1_score': 0.90521985}
confusion matrix:
      0     1
0  1478    38
1   238  1318
---- Validation: 
scalar performance:
{'acc': 0.738354, 'precision': 0.7470088, 'recall': 0.7369898, 'specificity': 0.7369898, 'f1': 0.73527086, 'auroc': 0.81565154, 'binary_precision': 0.78988326, 'binary_recall': 0.6393701, 'binary_specificity': 0.8346095, 'binary_f1_score': 0.70670146}
confusion matrix:
     0    1
0  545  108
1  229  406
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7767442, 'precision': 0.78384256, 'recall': 0.7767442, 'specificity': 0.7767442, 'f1': 0.7753396, 'auroc': 0.85399675, 'binary_precision': 0.8287293, 'binary_recall': 0.6976744, 'binary_specificity': 0.855814, 'binary_f1_score': 0.7575757}
confusion matrix:
     0    1
0  184   31
1   65  150
new oracle model saved
better model found
persisted
after epoch: 25,now: 2024-07-20 15:26:39.445489,epoch time: 0:00:57.334461,used: 0:24:18.429909,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_15_02_20_seed_0_22504815
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.91048175, 'precision': 0.91703993, 'recall': 0.91131866, 'specificity': 0.91131866, 'f1': 0.91023517, 'auroc': 0.9677366, 'binary_precision': 0.97269374, 'binary_recall': 0.8470437, 'binary_specificity': 0.9755937, 'binary_f1_score': 0.90553075}
confusion matrix:
      0     1
0  1479    37
1   238  1318
---- Validation: 
scalar performance:
{'acc': 0.7445652, 'precision': 0.7517365, 'recall': 0.7433324, 'specificity': 0.7433324, 'f1': 0.74205744, 'auroc': 0.8193727, 'binary_precision': 0.79087454, 'binary_recall': 0.6551181, 'binary_specificity': 0.8315467, 'binary_f1_score': 0.7166236}
confusion matrix:
     0    1
0  543  110
1  219  416
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7790698, 'precision': 0.7823004, 'recall': 0.7790698, 'specificity': 0.7790698, 'f1': 0.7784358, 'auroc': 0.85691726, 'binary_precision': 0.8125, 'binary_recall': 0.7255814, 'binary_specificity': 0.83255816, 'binary_f1_score': 0.76658475}
confusion matrix:
     0    1
0  179   36
1   59  156
new oracle model saved
better model found
persisted
after epoch: 26,now: 2024-07-20 15:27:36.724466,epoch time: 0:00:57.278977,used: 0:25:15.708886,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_15_02_20_seed_0_22504815
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.91471356, 'precision': 0.9210318, 'recall': 0.9156597, 'specificity': 0.9156597, 'f1': 0.9145042, 'auroc': 0.9649537, 'binary_precision': 0.9764879, 'binary_recall': 0.8524695, 'binary_specificity': 0.97884995, 'binary_f1_score': 0.91027397}
confusion matrix:
      0     1
0  1481    32
1   230  1329
---- Validation: 
scalar performance:
{'acc': 0.7515528, 'precision': 0.7580135, 'recall': 0.7503973, 'specificity': 0.7503973, 'f1': 0.74937737, 'auroc': 0.8229251, 'binary_precision': 0.7954972, 'binary_recall': 0.66771656, 'binary_specificity': 0.8330781, 'binary_f1_score': 0.7260274}
confusion matrix:
     0    1
0  544  109
1  211  424
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7883721, 'precision': 0.79232454, 'recall': 0.78837204, 'specificity': 0.78837204, 'f1': 0.7876543, 'auroc': 0.86063814, 'binary_precision': 0.82631576, 'binary_recall': 0.73023254, 'binary_specificity': 0.8465116, 'binary_f1_score': 0.7753086}
confusion matrix:
     0    1
0  182   33
1   58  157
new oracle model saved
better model found
persisted
after epoch: 27,now: 2024-07-20 15:28:34.306601,epoch time: 0:00:57.582135,used: 0:26:13.291021,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_15_02_20_seed_0_22504815
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.9202474, 'precision': 0.92517936, 'recall': 0.9210471, 'specificity': 0.9210471, 'f1': 0.9201021, 'auroc': 0.97453594, 'binary_precision': 0.9746927, 'binary_recall': 0.8652118, 'binary_specificity': 0.97688246, 'binary_f1_score': 0.91669494}
confusion matrix:
      0     1
0  1479    35
1   210  1348
---- Validation: 
scalar performance:
{'acc': 0.7569876, 'precision': 0.7622253, 'recall': 0.75595254, 'specificity': 0.75595254, 'f1': 0.7552346, 'auroc': 0.82769287, 'binary_precision': 0.7959559, 'binary_recall': 0.6818898, 'binary_specificity': 0.8300153, 'binary_f1_score': 0.7345208}
confusion matrix:
     0    1
0  542  111
1  202  433
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7837209, 'precision': 0.7859541, 'recall': 0.7837209, 'specificity': 0.7837209, 'f1': 0.78329784, 'auroc': 0.8647052, 'binary_precision': 0.81122446, 'binary_recall': 0.73953485, 'binary_specificity': 0.82790697, 'binary_f1_score': 0.7737226}
confusion matrix:
     0    1
0  178   37
1   56  159
better model found
persisted
after epoch: 28,now: 2024-07-20 15:29:31.684906,epoch time: 0:00:57.378305,used: 0:27:10.669326,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_15_02_20_seed_0_22504815
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.91048175, 'precision': 0.9151338, 'recall': 0.91119146, 'specificity': 0.91119146, 'f1': 0.91031873, 'auroc': 0.9669256, 'binary_precision': 0.96245486, 'binary_recall': 0.8566838, 'binary_specificity': 0.9656992, 'binary_f1_score': 0.9064944}
confusion matrix:
      0     1
0  1464    52
1   223  1333
---- Validation: 
scalar performance:
{'acc': 0.75621116, 'precision': 0.7625498, 'recall': 0.7550783, 'specificity': 0.7550783, 'f1': 0.75414777, 'auroc': 0.830611, 'binary_precision': 0.8, 'binary_recall': 0.67401576, 'binary_specificity': 0.8361409, 'binary_f1_score': 0.731624}
confusion matrix:
     0    1
0  546  107
1  207  428
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7883721, 'precision': 0.79018635, 'recall': 0.7883721, 'specificity': 0.7883721, 'f1': 0.78804076, 'auroc': 0.86725795, 'binary_precision': 0.81313133, 'binary_recall': 0.74883723, 'binary_specificity': 0.82790697, 'binary_f1_score': 0.779661}
confusion matrix:
     0    1
0  178   37
1   54  161
early stop counter: 1
val acc:0.7562111616134644, best validation acc: 0.7569875717163086, corresponding to test acc:                         0.7837209105491638 / 0.7883720993995667
after epoch: 29,now: 2024-07-20 15:30:29.151182,epoch time: 0:00:57.466276,used: 0:28:08.135602,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_15_02_20_seed_0_22504815
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.92545575, 'precision': 0.9299014, 'recall': 0.9261426, 'specificity': 0.9261426, 'f1': 0.92533207, 'auroc': 0.9714451, 'binary_precision': 0.976995, 'binary_recall': 0.8733933, 'binary_specificity': 0.97889185, 'binary_f1_score': 0.92229384}
confusion matrix:
      0     1
0  1484    32
1   197  1359
---- Validation: 
scalar performance:
{'acc': 0.75621116, 'precision': 0.76336145, 'recall': 0.7550132, 'specificity': 0.7550132, 'f1': 0.75393057, 'auroc': 0.83214235, 'binary_precision': 0.80340266, 'binary_recall': 0.6692913, 'binary_specificity': 0.8407351, 'binary_f1_score': 0.7302406}
confusion matrix:
     0    1
0  549  104
1  210  425
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7906977, 'precision': 0.79377365, 'recall': 0.7906977, 'specificity': 0.7906977, 'f1': 0.7901484, 'auroc': 0.8696809, 'binary_precision': 0.8238342, 'binary_recall': 0.73953485, 'binary_specificity': 0.8418605, 'binary_f1_score': 0.77941173}
confusion matrix:
     0    1
0  181   34
1   56  159
new oracle model saved
early stop counter: 2
val acc:0.7562111616134644, best validation acc: 0.7569875717163086, corresponding to test acc:                         0.7837209105491638 / 0.7906976938247681
after epoch: 30,now: 2024-07-20 15:31:26.355282,epoch time: 0:00:57.204100,used: 0:29:05.339702,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_15_02_20_seed_0_22504815
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 0:29:05.339702 at 2024-07-20 15:31:26.355282
persisted model performance metric: 

scalar performance:
{'acc': 0.7837209, 'precision': 0.7859541, 'recall': 0.7837209, 'specificity': 0.7837209, 'f1': 0.78329784, 'auroc': 0.8647052, 'binary_precision': 0.81122446, 'binary_recall': 0.73953485, 'binary_specificity': 0.82790697, 'binary_f1_score': 0.7737226}
confusion matrix:
     0    1
0  178   37
1   56  159
oracle model performance metric: 

scalar performance:
{'acc': 0.7906977, 'precision': 0.79377365, 'recall': 0.7906977, 'specificity': 0.7906977, 'f1': 0.7901484, 'auroc': 0.8696809, 'binary_precision': 0.8238342, 'binary_recall': 0.73953485, 'binary_specificity': 0.8418605, 'binary_f1_score': 0.77941173}
confusion matrix:
     0    1
0  181   34
1   56  159
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_halffreezeblocks_2024-07-20_12-47-21/rule_results/5.csv
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_halffreezeblocks_2024-07-20_12-47-21/rule_results/5.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_halffreezeblocks_2024-07-20_12-47-21/confusion_matrix/5.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 197058 KiB |   7828 MiB |  61331 GiB |  61331 GiB |
|       from large pool | 180662 KiB |   7805 MiB |  60516 GiB |  60516 GiB |
|       from small pool |  16396 KiB |     32 MiB |    815 GiB |    815 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 197058 KiB |   7828 MiB |  61331 GiB |  61331 GiB |
|       from large pool | 180662 KiB |   7805 MiB |  60516 GiB |  60516 GiB |
|       from small pool |  16396 KiB |     32 MiB |    815 GiB |    815 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 195188 KiB |   7827 MiB |  61327 GiB |  61327 GiB |
|       from large pool | 178979 KiB |   7804 MiB |  60513 GiB |  60513 GiB |
|       from small pool |  16209 KiB |     32 MiB |    813 GiB |    813 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   8524 MiB |   8524 MiB |   8524 MiB |      0 B   |
|       from large pool |   8486 MiB |   8486 MiB |   8486 MiB |      0 B   |
|       from small pool |     38 MiB |     38 MiB |     38 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |  58942 KiB | 732464 KiB |  34525 GiB |  34525 GiB |
|       from large pool |  50762 KiB | 730714 KiB |  33707 GiB |  33707 GiB |
|       from small pool |   8180 KiB |  10132 KiB |    817 GiB |    817 GiB |
|---------------------------------------------------------------------------|
| Allocations           |     788    |    1675    |   10387 K  |   10386 K  |
|       from large pool |      79    |     762    |    5637 K  |    5637 K  |
|       from small pool |     709    |    1005    |    4749 K  |    4748 K  |
|---------------------------------------------------------------------------|
| Active allocs         |     788    |    1675    |   10387 K  |   10386 K  |
|       from large pool |      79    |     762    |    5637 K  |    5637 K  |
|       from small pool |     709    |    1005    |    4749 K  |    4748 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     368    |     368    |     368    |       0    |
|       from large pool |     349    |     349    |     349    |       0    |
|       from small pool |      19    |      19    |      19    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      42    |     380    |    6462 K  |    6462 K  |
|       from large pool |      10    |     350    |    4321 K  |    4321 K  |
|       from small pool |      32    |     215    |    2141 K  |    2140 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   7828 MiB |  61331 GiB |  61331 GiB |
|       from large pool |  16640 KiB |   7805 MiB |  60516 GiB |  60516 GiB |
|       from small pool |      0 KiB |     32 MiB |    815 GiB |    815 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   7828 MiB |  61331 GiB |  61331 GiB |
|       from large pool |  16640 KiB |   7805 MiB |  60516 GiB |  60516 GiB |
|       from small pool |      0 KiB |     32 MiB |    815 GiB |    815 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   7827 MiB |  61327 GiB |  61327 GiB |
|       from large pool |  16640 KiB |   7804 MiB |  60513 GiB |  60513 GiB |
|       from small pool |      0 KiB |     32 MiB |    813 GiB |    813 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 256000 KiB |   8524 MiB |   8524 MiB |   8274 MiB |
|       from large pool | 231424 KiB |   8486 MiB |   8486 MiB |   8260 MiB |
|       from small pool |  24576 KiB |     38 MiB |     38 MiB |     14 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  30464 KiB | 732464 KiB |  34525 GiB |  34525 GiB |
|       from large pool |  30464 KiB | 730714 KiB |  33707 GiB |  33707 GiB |
|       from small pool |      0 KiB |  22319 KiB |    817 GiB |    817 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    1675    |   10387 K  |   10387 K  |
|       from large pool |       2    |     762    |    5637 K  |    5637 K  |
|       from small pool |       0    |    1005    |    4749 K  |    4749 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    1675    |   10387 K  |   10387 K  |
|       from large pool |       2    |     762    |    5637 K  |    5637 K  |
|       from small pool |       0    |    1005    |    4749 K  |    4749 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      23    |     368    |     368    |     345    |
|       from large pool |      11    |     349    |     349    |     338    |
|       from small pool |      12    |      19    |      19    |       7    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     380    |    6462 K  |    6462 K  |
|       from large pool |       3    |     350    |    4321 K  |    4321 K  |
|       from small pool |       0    |     215    |    2141 K  |    2141 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   7828 MiB |  61331 GiB |  61331 GiB |
|       from large pool |  16640 KiB |   7805 MiB |  60516 GiB |  60516 GiB |
|       from small pool |      0 KiB |     32 MiB |    815 GiB |    815 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   7828 MiB |  61331 GiB |  61331 GiB |
|       from large pool |  16640 KiB |   7805 MiB |  60516 GiB |  60516 GiB |
|       from small pool |      0 KiB |     32 MiB |    815 GiB |    815 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   7827 MiB |  61327 GiB |  61327 GiB |
|       from large pool |  16640 KiB |   7804 MiB |  60513 GiB |  60513 GiB |
|       from small pool |      0 KiB |     32 MiB |    813 GiB |    813 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 256000 KiB |   8524 MiB |   8524 MiB |   8274 MiB |
|       from large pool | 231424 KiB |   8486 MiB |   8486 MiB |   8260 MiB |
|       from small pool |  24576 KiB |     38 MiB |     38 MiB |     14 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  30464 KiB | 732464 KiB |  34525 GiB |  34525 GiB |
|       from large pool |  30464 KiB | 730714 KiB |  33707 GiB |  33707 GiB |
|       from small pool |      0 KiB |  22319 KiB |    817 GiB |    817 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    1675    |   10387 K  |   10387 K  |
|       from large pool |       2    |     762    |    5637 K  |    5637 K  |
|       from small pool |       0    |    1005    |    4749 K  |    4749 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    1675    |   10387 K  |   10387 K  |
|       from large pool |       2    |     762    |    5637 K  |    5637 K  |
|       from small pool |       0    |    1005    |    4749 K  |    4749 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      23    |     368    |     368    |     345    |
|       from large pool |      11    |     349    |     349    |     338    |
|       from small pool |      12    |      19    |      19    |       7    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     380    |    6462 K  |    6462 K  |
|       from large pool |       3    |     350    |    4321 K  |    4321 K  |
|       from small pool |       0    |     215    |    2141 K  |    2141 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'888c1ef2'
model name: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_15_32_23_seed_1_22504815

 Experiment start at: 2024-07-20 15:32:23.963071
before training, model accuracy: 0.6177777647972107
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.5416667, 'precision': 0.5462687, 'recall': 0.53895473, 'specificity': 0.53895473, 'f1': 0.52141064, 'auroc': 0.52140254, 'binary_precision': 0.53469956, 'binary_recall': 0.73731536, 'binary_specificity': 0.34059405, 'binary_f1_score': 0.6198704}
confusion matrix:
     0     1
0  516   999
1  409  1148
---- Validation: 
scalar performance:
{'acc': 0.48790008, 'precision': 0.46900758, 'recall': 0.48248848, 'specificity': 0.48248848, 'f1': 0.42184234, 'auroc': 0.6204813, 'binary_precision': 0.44036698, 'binary_recall': 0.15238096, 'binary_specificity': 0.812596, 'binary_f1_score': 0.22641511}
confusion matrix:
     0    1
0  529  122
1  534   96
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.56222224, 'precision': 0.5795455, 'recall': 0.56222224, 'specificity': 0.56222224, 'f1': 0.53701526, 'auroc': 0.6686815, 'binary_precision': 0.6166667, 'binary_recall': 0.3288889, 'binary_specificity': 0.79555553, 'binary_f1_score': 0.4289855}
confusion matrix:
     0   1
0  179  46
1  151  74
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-20 15:33:29.302924,epoch time: 0:01:05.339853,used: 0:01:05.339853,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_15_32_23_seed_1_22504815
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.5960286, 'precision': 0.59771204, 'recall': 0.59501237, 'specificity': 0.59501237, 'f1': 0.59276533, 'auroc': 0.59458375, 'binary_precision': 0.5876116, 'binary_recall': 0.6771704, 'binary_specificity': 0.51285434, 'binary_f1_score': 0.62922025}
confusion matrix:
     0     1
0  778   739
1  502  1053
---- Validation: 
scalar performance:
{'acc': 0.4730679, 'precision': 0.41263846, 'recall': 0.46661547, 'specificity': 0.46661547, 'f1': 0.37195164, 'auroc': 0.62738156, 'binary_precision': 0.33576643, 'binary_recall': 0.073015876, 'binary_specificity': 0.86021507, 'binary_f1_score': 0.11994786}
confusion matrix:
     0   1
0  560  91
1  584  46
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5422222, 'precision': 0.5794344, 'recall': 0.5422222, 'specificity': 0.5422222, 'f1': 0.48149723, 'auroc': 0.6772741, 'binary_precision': 0.63380283, 'binary_recall': 0.2, 'binary_specificity': 0.8844444, 'binary_f1_score': 0.30405408}
confusion matrix:
     0   1
0  199  26
1  180  45
early stop counter: 1
val acc:0.47306790947914124, best validation acc: 0.4879000782966614, corresponding to test acc:                         0.5622222423553467 / 0.5622222423553467
after epoch: 2,now: 2024-07-20 15:34:27.078189,epoch time: 0:00:57.775265,used: 0:02:03.115118,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_15_32_23_seed_1_22504815
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.65690106, 'precision': 0.65697706, 'recall': 0.65656984, 'specificity': 0.65656984, 'f1': 0.6565224, 'auroc': 0.7012678, 'binary_precision': 0.6555349, 'binary_recall': 0.6807964, 'binary_specificity': 0.63234323, 'binary_f1_score': 0.66792685}
confusion matrix:
     0     1
0  958   557
1  497  1060
---- Validation: 
scalar performance:
{'acc': 0.47775176, 'precision': 0.42385107, 'recall': 0.47127497, 'specificity': 0.47127497, 'f1': 0.37660152, 'auroc': 0.64308393, 'binary_precision': 0.35555556, 'binary_recall': 0.07619048, 'binary_specificity': 0.8663595, 'binary_f1_score': 0.1254902}
confusion matrix:
     0   1
0  564  87
1  582  48
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.53555554, 'precision': 0.5728627, 'recall': 0.53555554, 'specificity': 0.53555554, 'f1': 0.4673772, 'auroc': 0.692879, 'binary_precision': 0.625, 'binary_recall': 0.17777778, 'binary_specificity': 0.8933333, 'binary_f1_score': 0.2768166}
confusion matrix:
     0   1
0  201  24
1  185  40
early stop counter: 2
val acc:0.477751761674881, best validation acc: 0.4879000782966614, corresponding to test acc:                         0.5622222423553467 / 0.5622222423553467
after epoch: 3,now: 2024-07-20 15:35:24.976591,epoch time: 0:00:57.898402,used: 0:03:01.013520,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_15_32_23_seed_1_22504815
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.69628906, 'precision': 0.69672394, 'recall': 0.6965285, 'specificity': 0.6965285, 'f1': 0.69625396, 'auroc': 0.7493597, 'binary_precision': 0.70956874, 'binary_recall': 0.6771704, 'binary_specificity': 0.7158866, 'binary_f1_score': 0.6929911}
confusion matrix:
      0     1
0  1086   431
1   502  1053
---- Validation: 
scalar performance:
{'acc': 0.48790008, 'precision': 0.448914, 'recall': 0.48136202, 'specificity': 0.48136202, 'f1': 0.38640106, 'auroc': 0.6581743, 'binary_precision': 0.4, 'binary_recall': 0.082539685, 'binary_specificity': 0.88018435, 'binary_f1_score': 0.1368421}
confusion matrix:
     0   1
0  573  78
1  578  52
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5311111, 'precision': 0.57138324, 'recall': 0.5311111, 'specificity': 0.5311111, 'f1': 0.45411897, 'auroc': 0.7088, 'binary_precision': 0.625, 'binary_recall': 0.15555556, 'binary_specificity': 0.9066667, 'binary_f1_score': 0.24911033}
confusion matrix:
     0   1
0  204  21
1  190  35
early stop counter: 3
val acc:0.4879000782966614, best validation acc: 0.4879000782966614, corresponding to test acc:                         0.5622222423553467 / 0.5622222423553467
after epoch: 4,now: 2024-07-20 15:36:23.036997,epoch time: 0:00:58.060406,used: 0:03:59.073926,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_15_32_23_seed_1_22504815
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.75065106, 'precision': 0.7506447, 'recall': 0.7506715, 'specificity': 0.7506715, 'f1': 0.75064254, 'auroc': 0.8215933, 'binary_precision': 0.75552666, 'binary_recall': 0.74871135, 'binary_specificity': 0.7526316, 'binary_f1_score': 0.75210357}
confusion matrix:
      0     1
0  1144   376
1   390  1162
---- Validation: 
scalar performance:
{'acc': 0.48946136, 'precision': 0.45457, 'recall': 0.48297492, 'specificity': 0.48297492, 'f1': 0.3901208, 'auroc': 0.6746934, 'binary_precision': 0.41044775, 'binary_recall': 0.08730159, 'binary_specificity': 0.8786482, 'binary_f1_score': 0.14397906}
confusion matrix:
     0   1
0  572  79
1  575  55
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.53333336, 'precision': 0.58020055, 'recall': 0.5333333, 'specificity': 0.5333333, 'f1': 0.45349184, 'auroc': 0.7228247, 'binary_precision': 0.6415094, 'binary_recall': 0.15111111, 'binary_specificity': 0.91555554, 'binary_f1_score': 0.2446043}
confusion matrix:
     0   1
0  206  19
1  191  34
better model found
persisted
after epoch: 5,now: 2024-07-20 15:37:21.224017,epoch time: 0:00:58.187020,used: 0:04:57.260946,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_15_32_23_seed_1_22504815
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.7828776, 'precision': 0.7828651, 'recall': 0.78289783, 'specificity': 0.78289783, 'f1': 0.78286743, 'auroc': 0.8578707, 'binary_precision': 0.7876623, 'binary_recall': 0.7810689, 'binary_specificity': 0.7847268, 'binary_f1_score': 0.78435177}
confusion matrix:
      0     1
0  1192   327
1   340  1213
---- Validation: 
scalar performance:
{'acc': 0.50741607, 'precision': 0.50264543, 'recall': 0.50104964, 'specificity': 0.50104964, 'f1': 0.41549444, 'auroc': 0.6917782, 'binary_precision': 0.4965035, 'binary_recall': 0.11269841, 'binary_specificity': 0.8894009, 'binary_f1_score': 0.18369988}
confusion matrix:
     0   1
0  579  72
1  559  71
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5377778, 'precision': 0.58537567, 'recall': 0.5377778, 'specificity': 0.5377778, 'f1': 0.46292087, 'auroc': 0.73394567, 'binary_precision': 0.64912283, 'binary_recall': 0.16444445, 'binary_specificity': 0.9111111, 'binary_f1_score': 0.26241136}
confusion matrix:
     0   1
0  205  20
1  188  37
better model found
persisted
after epoch: 6,now: 2024-07-20 15:38:19.684791,epoch time: 0:00:58.460774,used: 0:05:55.721720,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_15_32_23_seed_1_22504815
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.8024089, 'precision': 0.802904, 'recall': 0.80263734, 'specificity': 0.80263734, 'f1': 0.8023887, 'auroc': 0.8751646, 'binary_precision': 0.8184264, 'binary_recall': 0.7831403, 'binary_specificity': 0.8221344, 'binary_f1_score': 0.80039465}
confusion matrix:
      0     1
0  1248   270
1   337  1217
---- Validation: 
scalar performance:
{'acc': 0.51288056, 'precision': 0.5160928, 'recall': 0.50657964, 'specificity': 0.50657964, 'f1': 0.42408383, 'auroc': 0.70600057, 'binary_precision': 0.5202703, 'binary_recall': 0.12222222, 'binary_specificity': 0.89093703, 'binary_f1_score': 0.19794343}
confusion matrix:
     0   1
0  580  71
1  553  77
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5422222, 'precision': 0.59838897, 'recall': 0.54222226, 'specificity': 0.54222226, 'f1': 0.46601385, 'auroc': 0.74506664, 'binary_precision': 0.6727273, 'binary_recall': 0.16444445, 'binary_specificity': 0.92, 'binary_f1_score': 0.2642857}
confusion matrix:
     0   1
0  207  18
1  188  37
better model found
persisted
after epoch: 7,now: 2024-07-20 15:39:17.608796,epoch time: 0:00:57.924005,used: 0:06:53.645725,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_15_32_23_seed_1_22504815
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.82389325, 'precision': 0.82463014, 'recall': 0.8241844, 'specificity': 0.8241844, 'f1': 0.82386184, 'auroc': 0.89499414, 'binary_precision': 0.8434959, 'binary_recall': 0.8006431, 'binary_specificity': 0.84772575, 'binary_f1_score': 0.82151103}
confusion matrix:
      0     1
0  1286   231
1   310  1245
---- Validation: 
scalar performance:
{'acc': 0.51444185, 'precision': 0.5208357, 'recall': 0.5080133, 'specificity': 0.5080133, 'f1': 0.42169642, 'auroc': 0.71935487, 'binary_precision': 0.5289855, 'binary_recall': 0.11587302, 'binary_specificity': 0.90015364, 'binary_f1_score': 0.19010416}
confusion matrix:
     0   1
0  586  65
1  557  73
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.54888886, 'precision': 0.62375, 'recall': 0.54888886, 'specificity': 0.54888886, 'f1': 0.46850908, 'auroc': 0.75818276, 'binary_precision': 0.72, 'binary_recall': 0.16, 'binary_specificity': 0.93777776, 'binary_f1_score': 0.2618182}
confusion matrix:
     0   1
0  211  14
1  189  36
better model found
persisted
after epoch: 8,now: 2024-07-20 15:40:15.694529,epoch time: 0:00:58.085733,used: 0:07:51.731458,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_15_32_23_seed_1_22504815
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.8411458, 'precision': 0.8433008, 'recall': 0.8416615, 'specificity': 0.8416615, 'f1': 0.8410154, 'auroc': 0.9081854, 'binary_precision': 0.8739496, 'binary_recall': 0.80205655, 'binary_specificity': 0.8812665, 'binary_f1_score': 0.8364612}
confusion matrix:
      0     1
0  1336   180
1   308  1248
---- Validation: 
scalar performance:
{'acc': 0.51990634, 'precision': 0.5318924, 'recall': 0.5137225, 'specificity': 0.5137225, 'f1': 0.4360363, 'auroc': 0.73044395, 'binary_precision': 0.5477707, 'binary_recall': 0.13650794, 'binary_specificity': 0.89093703, 'binary_f1_score': 0.21855147}
confusion matrix:
     0   1
0  580  71
1  544  86
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.56, 'precision': 0.63167024, 'recall': 0.56, 'specificity': 0.56, 'f1': 0.49069417, 'auroc': 0.77017283, 'binary_precision': 0.7288136, 'binary_recall': 0.19111112, 'binary_specificity': 0.9288889, 'binary_f1_score': 0.3028169}
confusion matrix:
     0   1
0  209  16
1  182  43
better model found
persisted
after epoch: 9,now: 2024-07-20 15:41:14.505373,epoch time: 0:00:58.810844,used: 0:08:50.542302,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_15_32_23_seed_1_22504815
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.85286456, 'precision': 0.8540212, 'recall': 0.853203, 'specificity': 0.853203, 'f1': 0.8528121, 'auroc': 0.91924703, 'binary_precision': 0.87739724, 'binary_recall': 0.8243243, 'binary_specificity': 0.8820817, 'binary_f1_score': 0.85003316}
confusion matrix:
      0     1
0  1339   179
1   273  1281
---- Validation: 
scalar performance:
{'acc': 0.53239655, 'precision': 0.55703336, 'recall': 0.52639526, 'specificity': 0.52639526, 'f1': 0.45601857, 'auroc': 0.74078465, 'binary_precision': 0.5906433, 'binary_recall': 0.16031747, 'binary_specificity': 0.8924731, 'binary_f1_score': 0.25218478}
confusion matrix:
     0    1
0  581   70
1  529  101
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5711111, 'precision': 0.6420455, 'recall': 0.5711111, 'specificity': 0.5711111, 'f1': 0.5099284, 'auroc': 0.78157043, 'binary_precision': 0.74242425, 'binary_recall': 0.21777777, 'binary_specificity': 0.92444444, 'binary_f1_score': 0.33676976}
confusion matrix:
     0   1
0  208  17
1  176  49
new oracle model saved
better model found
persisted
after epoch: 10,now: 2024-07-20 15:42:13.707621,epoch time: 0:00:59.202248,used: 0:09:49.744550,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_15_32_23_seed_1_22504815
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.8538411, 'precision': 0.85881007, 'recall': 0.8545718, 'specificity': 0.8545718, 'f1': 0.8534965, 'auroc': 0.91867685, 'binary_precision': 0.9042398, 'binary_recall': 0.7954984, 'binary_specificity': 0.9136453, 'binary_f1_score': 0.84639066}
confusion matrix:
      0     1
0  1386   131
1   318  1237
---- Validation: 
scalar performance:
{'acc': 0.5316159, 'precision': 0.5588219, 'recall': 0.525448, 'specificity': 0.525448, 'f1': 0.45018, 'auroc': 0.7505413, 'binary_precision': 0.5949367, 'binary_recall': 0.14920636, 'binary_specificity': 0.9016897, 'binary_f1_score': 0.23857869}
confusion matrix:
     0   1
0  587  64
1  536  94
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.56222224, 'precision': 0.64730644, 'recall': 0.56222224, 'specificity': 0.56222224, 'f1': 0.4883383, 'auroc': 0.78874075, 'binary_precision': 0.7592593, 'binary_recall': 0.18222222, 'binary_specificity': 0.94222224, 'binary_f1_score': 0.29390684}
confusion matrix:
     0   1
0  212  13
1  184  41
early stop counter: 1
val acc:0.5316159129142761, best validation acc: 0.5323965549468994, corresponding to test acc:                         0.5711110830307007 / 0.5711110830307007
after epoch: 11,now: 2024-07-20 15:43:12.037447,epoch time: 0:00:58.329826,used: 0:10:48.074376,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_15_32_23_seed_1_22504815
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.86783856, 'precision': 0.87025034, 'recall': 0.868427, 'specificity': 0.868427, 'f1': 0.86773, 'auroc': 0.9298452, 'binary_precision': 0.9039271, 'binary_recall': 0.82734275, 'binary_specificity': 0.9095112, 'binary_f1_score': 0.863941}
confusion matrix:
      0     1
0  1377   137
1   269  1289
---- Validation: 
scalar performance:
{'acc': 0.53942233, 'precision': 0.5694066, 'recall': 0.53353816, 'specificity': 0.53353816, 'f1': 0.4674235, 'auroc': 0.7552483, 'binary_precision': 0.6111111, 'binary_recall': 0.17460318, 'binary_specificity': 0.8924731, 'binary_f1_score': 0.27160496}
confusion matrix:
     0    1
0  581   70
1  520  110
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5733333, 'precision': 0.6522702, 'recall': 0.5733333, 'specificity': 0.5733333, 'f1': 0.5098039, 'auroc': 0.7955556, 'binary_precision': 0.7619048, 'binary_recall': 0.21333334, 'binary_specificity': 0.93333334, 'binary_f1_score': 0.33333334}
confusion matrix:
     0   1
0  210  15
1  177  48
new oracle model saved
better model found
persisted
after epoch: 12,now: 2024-07-20 15:44:10.377931,epoch time: 0:00:58.340484,used: 0:11:46.414860,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_15_32_23_seed_1_22504815
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.87109375, 'precision': 0.87378323, 'recall': 0.87168396, 'specificity': 0.87168396, 'f1': 0.87096775, 'auroc': 0.92960215, 'binary_precision': 0.90909094, 'binary_recall': 0.82851636, 'binary_specificity': 0.9148515, 'binary_f1_score': 0.8669355}
confusion matrix:
      0     1
0  1386   129
1   267  1290
---- Validation: 
scalar performance:
{'acc': 0.5495706, 'precision': 0.58368087, 'recall': 0.54393244, 'specificity': 0.54393244, 'f1': 0.48551604, 'auroc': 0.76107085, 'binary_precision': 0.63316584, 'binary_recall': 0.2, 'binary_specificity': 0.8878648, 'binary_f1_score': 0.3039807}
confusion matrix:
     0    1
0  578   73
1  504  126
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.57555556, 'precision': 0.64379704, 'recall': 0.57555556, 'specificity': 0.57555556, 'f1': 0.51842, 'auroc': 0.80468154, 'binary_precision': 0.74285716, 'binary_recall': 0.23111111, 'binary_specificity': 0.92, 'binary_f1_score': 0.35254237}
confusion matrix:
     0   1
0  207  18
1  173  52
new oracle model saved
better model found
persisted
after epoch: 13,now: 2024-07-20 15:45:08.924709,epoch time: 0:00:58.546778,used: 0:12:44.961638,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_15_32_23_seed_1_22504815
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.875, 'precision': 0.87908405, 'recall': 0.8756162, 'specificity': 0.8756162, 'f1': 0.87477577, 'auroc': 0.93355024, 'binary_precision': 0.92146975, 'binary_recall': 0.8230373, 'binary_specificity': 0.928195, 'binary_f1_score': 0.86947656}
confusion matrix:
      0     1
0  1409   109
1   275  1279
---- Validation: 
scalar performance:
{'acc': 0.55347383, 'precision': 0.59291154, 'recall': 0.54777265, 'specificity': 0.54777265, 'f1': 0.4883557, 'auroc': 0.7669276, 'binary_precision': 0.6494845, 'binary_recall': 0.2, 'binary_specificity': 0.8955453, 'binary_f1_score': 0.30582526}
confusion matrix:
     0    1
0  583   68
1  504  126
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5711111, 'precision': 0.6420455, 'recall': 0.5711111, 'specificity': 0.5711111, 'f1': 0.5099284, 'auroc': 0.8098568, 'binary_precision': 0.74242425, 'binary_recall': 0.21777777, 'binary_specificity': 0.92444444, 'binary_f1_score': 0.33676976}
confusion matrix:
     0   1
0  208  17
1  176  49
better model found
persisted
after epoch: 14,now: 2024-07-20 15:46:07.062672,epoch time: 0:00:58.137963,used: 0:13:43.099601,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_15_32_23_seed_1_22504815
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.8746745, 'precision': 0.87852156, 'recall': 0.8754089, 'specificity': 0.8754089, 'f1': 0.87448615, 'auroc': 0.9390282, 'binary_precision': 0.9204301, 'binary_recall': 0.8241335, 'binary_specificity': 0.92668426, 'binary_f1_score': 0.86962414}
confusion matrix:
      0     1
0  1403   111
1   274  1284
---- Validation: 
scalar performance:
{'acc': 0.5604996, 'precision': 0.60370374, 'recall': 0.5548899, 'specificity': 0.5548899, 'f1': 0.49862874, 'auroc': 0.77157485, 'binary_precision': 0.6666667, 'binary_recall': 0.21269841, 'binary_specificity': 0.89708143, 'binary_f1_score': 0.322503}
confusion matrix:
     0    1
0  584   67
1  496  134
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.58, 'precision': 0.6559131, 'recall': 0.58000004, 'specificity': 0.58000004, 'f1': 0.5217907, 'auroc': 0.8120494, 'binary_precision': 0.7647059, 'binary_recall': 0.23111111, 'binary_specificity': 0.9288889, 'binary_f1_score': 0.35494882}
confusion matrix:
     0   1
0  209  16
1  173  52
new oracle model saved
better model found
persisted
after epoch: 15,now: 2024-07-20 15:47:05.701906,epoch time: 0:00:58.639234,used: 0:14:41.738835,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_15_32_23_seed_1_22504815
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.8922526, 'precision': 0.8962107, 'recall': 0.8928845, 'specificity': 0.8928845, 'f1': 0.8920796, 'auroc': 0.9439739, 'binary_precision': 0.9390244, 'binary_recall': 0.84180063, 'binary_specificity': 0.94396836, 'binary_f1_score': 0.88775855}
confusion matrix:
      0     1
0  1432    85
1   246  1309
---- Validation: 
scalar performance:
{'acc': 0.55581576, 'precision': 0.5994607, 'recall': 0.5500512, 'specificity': 0.5500512, 'f1': 0.48940086, 'auroc': 0.77493966, 'binary_precision': 0.66137564, 'binary_recall': 0.1984127, 'binary_specificity': 0.9016897, 'binary_f1_score': 0.30525032}
confusion matrix:
     0    1
0  587   64
1  505  125
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.58, 'precision': 0.6598011, 'recall': 0.58, 'specificity': 0.58, 'f1': 0.52008533, 'auroc': 0.81538767, 'binary_precision': 0.77272725, 'binary_recall': 0.22666667, 'binary_specificity': 0.93333334, 'binary_f1_score': 0.35051546}
confusion matrix:
     0   1
0  210  15
1  174  51
early stop counter: 1
val acc:0.5558157563209534, best validation acc: 0.5604996085166931, corresponding to test acc:                         0.5799999833106995 / 0.5799999833106995
after epoch: 16,now: 2024-07-20 15:48:03.913158,epoch time: 0:00:58.211252,used: 0:15:39.950087,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_15_32_23_seed_1_22504815
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.89127606, 'precision': 0.8975519, 'recall': 0.89202416, 'specificity': 0.89202416, 'f1': 0.8909653, 'auroc': 0.94394886, 'binary_precision': 0.950517, 'binary_recall': 0.8281853, 'binary_specificity': 0.955863, 'binary_f1_score': 0.8851444}
confusion matrix:
      0     1
0  1451    67
1   267  1287
---- Validation: 
scalar performance:
{'acc': 0.5620609, 'precision': 0.6100584, 'recall': 0.5563492, 'specificity': 0.5563492, 'f1': 0.49787417, 'auroc': 0.77693415, 'binary_precision': 0.6787565, 'binary_recall': 0.20793651, 'binary_specificity': 0.9047619, 'binary_f1_score': 0.3183475}
confusion matrix:
     0    1
0  589   62
1  499  131
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5822222, 'precision': 0.654688, 'recall': 0.5822222, 'specificity': 0.5822222, 'f1': 0.5268033, 'auroc': 0.8194568, 'binary_precision': 0.7605634, 'binary_recall': 0.24, 'binary_specificity': 0.92444444, 'binary_f1_score': 0.36486486}
confusion matrix:
     0   1
0  208  17
1  171  54
new oracle model saved
better model found
persisted
after epoch: 17,now: 2024-07-20 15:49:02.257607,epoch time: 0:00:58.344449,used: 0:16:38.294536,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_15_32_23_seed_1_22504815
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9003906, 'precision': 0.90453327, 'recall': 0.901102, 'specificity': 0.901102, 'f1': 0.90023327, 'auroc': 0.9472121, 'binary_precision': 0.9490309, 'binary_recall': 0.8490687, 'binary_specificity': 0.9531353, 'binary_f1_score': 0.89627117}
confusion matrix:
      0     1
0  1444    71
1   235  1322
---- Validation: 
scalar performance:
{'acc': 0.5714286, 'precision': 0.6224794, 'recall': 0.565873, 'specificity': 0.565873, 'f1': 0.51231134, 'auroc': 0.78046715, 'binary_precision': 0.69756097, 'binary_recall': 0.22698413, 'binary_specificity': 0.9047619, 'binary_f1_score': 0.34251496}
confusion matrix:
     0    1
0  589   62
1  487  143
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5888889, 'precision': 0.6583169, 'recall': 0.5888889, 'specificity': 0.5888889, 'f1': 0.53826696, 'auroc': 0.82301235, 'binary_precision': 0.7631579, 'binary_recall': 0.25777778, 'binary_specificity': 0.92, 'binary_f1_score': 0.38538206}
confusion matrix:
     0   1
0  207  18
1  167  58
new oracle model saved
better model found
persisted
after epoch: 18,now: 2024-07-20 15:50:00.579298,epoch time: 0:00:58.321691,used: 0:17:36.616227,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_15_32_23_seed_1_22504815
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9036458, 'precision': 0.90731376, 'recall': 0.90428233, 'specificity': 0.90428233, 'f1': 0.90351295, 'auroc': 0.95530283, 'binary_precision': 0.94935805, 'binary_recall': 0.8553985, 'binary_specificity': 0.95316625, 'binary_f1_score': 0.8999324}
confusion matrix:
      0     1
0  1445    71
1   225  1331
---- Validation: 
scalar performance:
{'acc': 0.5823575, 'precision': 0.63575447, 'recall': 0.5769841, 'specificity': 0.5769841, 'f1': 0.52876467, 'auroc': 0.78401726, 'binary_precision': 0.716895, 'binary_recall': 0.24920635, 'binary_specificity': 0.9047619, 'binary_f1_score': 0.36984685}
confusion matrix:
     0    1
0  589   62
1  473  157
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6, 'precision': 0.66937673, 'recall': 0.6, 'specificity': 0.6, 'f1': 0.5543672, 'auroc': 0.82731855, 'binary_precision': 0.7777778, 'binary_recall': 0.28, 'binary_specificity': 0.92, 'binary_f1_score': 0.41176474}
confusion matrix:
     0   1
0  207  18
1  162  63
new oracle model saved
better model found
persisted
after epoch: 19,now: 2024-07-20 15:50:59.336978,epoch time: 0:00:58.757680,used: 0:18:35.373907,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_15_32_23_seed_1_22504815
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9036458, 'precision': 0.9076717, 'recall': 0.904243, 'specificity': 0.904243, 'f1': 0.90348864, 'auroc': 0.9563551, 'binary_precision': 0.9512195, 'binary_recall': 0.85328186, 'binary_specificity': 0.9552042, 'binary_f1_score': 0.89959294}
confusion matrix:
      0     1
0  1450    68
1   228  1326
---- Validation: 
scalar performance:
{'acc': 0.587822, 'precision': 0.6410444, 'recall': 0.5825653, 'specificity': 0.5825653, 'f1': 0.53737813, 'auroc': 0.7870407, 'binary_precision': 0.7236842, 'binary_recall': 0.26190478, 'binary_specificity': 0.9032258, 'binary_f1_score': 0.3846154}
confusion matrix:
     0    1
0  588   63
1  465  165
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6066667, 'precision': 0.6725019, 'recall': 0.6066667, 'specificity': 0.6066667, 'f1': 0.5651794, 'auroc': 0.83160496, 'binary_precision': 0.7790698, 'binary_recall': 0.29777777, 'binary_specificity': 0.91555554, 'binary_f1_score': 0.43086818}
confusion matrix:
     0   1
0  206  19
1  158  67
new oracle model saved
better model found
persisted
after epoch: 20,now: 2024-07-20 15:51:58.197285,epoch time: 0:00:58.860307,used: 0:19:34.234214,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_15_32_23_seed_1_22504815
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.88964844, 'precision': 0.89432085, 'recall': 0.89037156, 'specificity': 0.89037156, 'f1': 0.88943493, 'auroc': 0.948702, 'binary_precision': 0.94062275, 'binary_recall': 0.8348329, 'binary_specificity': 0.9459103, 'binary_f1_score': 0.8845761}
confusion matrix:
      0     1
0  1434    82
1   257  1299
---- Validation: 
scalar performance:
{'acc': 0.59406716, 'precision': 0.6478651, 'recall': 0.5889145, 'specificity': 0.5889145, 'f1': 0.5464672, 'auroc': 0.7905048, 'binary_precision': 0.7330508, 'binary_recall': 0.2746032, 'binary_specificity': 0.9032258, 'binary_f1_score': 0.39953813}
confusion matrix:
     0    1
0  588   63
1  457  173
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6111111, 'precision': 0.6796895, 'recall': 0.6111111, 'specificity': 0.6111111, 'f1': 0.5700926, 'auroc': 0.8339753, 'binary_precision': 0.7906977, 'binary_recall': 0.30222222, 'binary_specificity': 0.92, 'binary_f1_score': 0.43729904}
confusion matrix:
     0   1
0  207  18
1  157  68
new oracle model saved
better model found
persisted
after epoch: 21,now: 2024-07-20 15:52:58.023179,epoch time: 0:00:59.825894,used: 0:20:34.060108,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_15_32_23_seed_1_22504815
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9036458, 'precision': 0.91020536, 'recall': 0.9044446, 'specificity': 0.9044446, 'f1': 0.9033704, 'auroc': 0.9616624, 'binary_precision': 0.96526235, 'binary_recall': 0.8398714, 'binary_specificity': 0.9690178, 'binary_f1_score': 0.8982118}
confusion matrix:
      0     1
0  1470    47
1   249  1306
---- Validation: 
scalar performance:
{'acc': 0.58469945, 'precision': 0.6413602, 'recall': 0.57928824, 'specificity': 0.57928824, 'f1': 0.5305675, 'auroc': 0.79338014, 'binary_precision': 0.7268519, 'binary_recall': 0.24920635, 'binary_specificity': 0.9093702, 'binary_f1_score': 0.3711584}
confusion matrix:
     0    1
0  592   59
1  473  157
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6022222, 'precision': 0.67834985, 'recall': 0.6022222, 'specificity': 0.6022222, 'f1': 0.5547042, 'auroc': 0.8354173, 'binary_precision': 0.7948718, 'binary_recall': 0.27555555, 'binary_specificity': 0.9288889, 'binary_f1_score': 0.4092409}
confusion matrix:
     0   1
0  209  16
1  163  62
early stop counter: 1
val acc:0.5846994519233704, best validation acc: 0.5940671563148499, corresponding to test acc:                         0.6111111044883728 / 0.6111111044883728
after epoch: 22,now: 2024-07-20 15:53:55.894348,epoch time: 0:00:57.871169,used: 0:21:31.931277,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_15_32_23_seed_1_22504815
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.89746094, 'precision': 0.9037022, 'recall': 0.8982872, 'specificity': 0.8982872, 'f1': 0.89718544, 'auroc': 0.95637107, 'binary_precision': 0.95725864, 'binary_recall': 0.8348329, 'binary_specificity': 0.96174145, 'binary_f1_score': 0.891864}
confusion matrix:
      0     1
0  1458    58
1   257  1299
---- Validation: 
scalar performance:
{'acc': 0.60031223, 'precision': 0.65825355, 'recall': 0.5951613, 'specificity': 0.5951613, 'f1': 0.5534446, 'auroc': 0.7969357, 'binary_precision': 0.75, 'binary_recall': 0.2809524, 'binary_specificity': 0.9093702, 'binary_f1_score': 0.408776}
confusion matrix:
     0    1
0  592   59
1  453  177
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6244444, 'precision': 0.6944444, 'recall': 0.6244444, 'specificity': 0.6244444, 'f1': 0.5873016, 'auroc': 0.83962464, 'binary_precision': 0.8111111, 'binary_recall': 0.32444444, 'binary_specificity': 0.92444444, 'binary_f1_score': 0.4634921}
confusion matrix:
     0   1
0  208  17
1  152  73
new oracle model saved
better model found
persisted
after epoch: 23,now: 2024-07-20 15:54:54.270903,epoch time: 0:00:58.376555,used: 0:22:30.307832,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_15_32_23_seed_1_22504815
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9111328, 'precision': 0.91711235, 'recall': 0.91181016, 'specificity': 0.91181016, 'f1': 0.9109001, 'auroc': 0.96089196, 'binary_precision': 0.9698972, 'binary_recall': 0.85061175, 'binary_specificity': 0.9730086, 'binary_f1_score': 0.9063465}
confusion matrix:
      0     1
0  1478    41
1   232  1321
---- Validation: 
scalar performance:
{'acc': 0.6034348, 'precision': 0.66142535, 'recall': 0.59833586, 'specificity': 0.59833586, 'f1': 0.5579278, 'auroc': 0.7993319, 'binary_precision': 0.75416666, 'binary_recall': 0.2873016, 'binary_specificity': 0.9093702, 'binary_f1_score': 0.41609195}
confusion matrix:
     0    1
0  592   59
1  449  181
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6288889, 'precision': 0.6981115, 'recall': 0.6288889, 'specificity': 0.6288889, 'f1': 0.59336835, 'auroc': 0.8425087, 'binary_precision': 0.8152174, 'binary_recall': 0.33333334, 'binary_specificity': 0.92444444, 'binary_f1_score': 0.4731861}
confusion matrix:
     0   1
0  208  17
1  150  75
new oracle model saved
better model found
persisted
after epoch: 24,now: 2024-07-20 15:55:52.928581,epoch time: 0:00:58.657678,used: 0:23:28.965510,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_15_32_23_seed_1_22504815
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.90266925, 'precision': 0.9083831, 'recall': 0.903377, 'specificity': 0.903377, 'f1': 0.9024272, 'auroc': 0.953882, 'binary_precision': 0.95970696, 'binary_recall': 0.84298587, 'binary_specificity': 0.9637681, 'binary_f1_score': 0.89756763}
confusion matrix:
      0     1
0  1463    55
1   244  1310
---- Validation: 
scalar performance:
{'acc': 0.61358315, 'precision': 0.6684693, 'recall': 0.6087302, 'specificity': 0.6087302, 'f1': 0.5736594, 'auroc': 0.80233335, 'binary_precision': 0.76061773, 'binary_recall': 0.31269842, 'binary_specificity': 0.9047619, 'binary_f1_score': 0.44319463}
confusion matrix:
     0    1
0  589   62
1  433  197
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.63555557, 'precision': 0.70041764, 'recall': 0.63555557, 'specificity': 0.63555557, 'f1': 0.60347307, 'auroc': 0.8455111, 'binary_precision': 0.814433, 'binary_recall': 0.3511111, 'binary_specificity': 0.92, 'binary_f1_score': 0.49068326}
confusion matrix:
     0   1
0  207  18
1  146  79
new oracle model saved
better model found
persisted
after epoch: 25,now: 2024-07-20 15:56:51.597613,epoch time: 0:00:58.669032,used: 0:24:27.634542,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_15_32_23_seed_1_22504815
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9095052, 'precision': 0.91598076, 'recall': 0.9103377, 'specificity': 0.9103377, 'f1': 0.9092591, 'auroc': 0.9629475, 'binary_precision': 0.9712389, 'binary_recall': 0.84640104, 'binary_specificity': 0.9742744, 'binary_f1_score': 0.90453297}
confusion matrix:
      0     1
0  1477    39
1   239  1317
---- Validation: 
scalar performance:
{'acc': 0.6159251, 'precision': 0.6735461, 'recall': 0.6110343, 'specificity': 0.6110343, 'f1': 0.5755696, 'auroc': 0.80648327, 'binary_precision': 0.76953125, 'binary_recall': 0.31269842, 'binary_specificity': 0.9093702, 'binary_f1_score': 0.4446953}
confusion matrix:
     0    1
0  592   59
1  433  197
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.64444447, 'precision': 0.70745265, 'recall': 0.64444447, 'specificity': 0.64444447, 'f1': 0.6152284, 'auroc': 0.84940255, 'binary_precision': 0.8217822, 'binary_recall': 0.36888888, 'binary_specificity': 0.92, 'binary_f1_score': 0.5092024}
confusion matrix:
     0   1
0  207  18
1  142  83
new oracle model saved
better model found
persisted
after epoch: 26,now: 2024-07-20 15:57:50.628457,epoch time: 0:00:59.030844,used: 0:25:26.665386,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_15_32_23_seed_1_22504815
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.9160156, 'precision': 0.92012364, 'recall': 0.91664714, 'specificity': 0.91664714, 'f1': 0.91588295, 'auroc': 0.9608836, 'binary_precision': 0.96487457, 'binary_recall': 0.86559486, 'binary_specificity': 0.9676994, 'binary_f1_score': 0.9125424}
confusion matrix:
      0     1
0  1468    49
1   209  1346
---- Validation: 
scalar performance:
{'acc': 0.63700235, 'precision': 0.68784976, 'recall': 0.6325909, 'specificity': 0.6325909, 'f1': 0.6062492, 'auroc': 0.8113525, 'binary_precision': 0.78156996, 'binary_recall': 0.36349207, 'binary_specificity': 0.9016897, 'binary_f1_score': 0.49620804}
confusion matrix:
     0    1
0  587   64
1  401  229
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.68222225, 'precision': 0.7329545, 'recall': 0.68222225, 'specificity': 0.68222225, 'f1': 0.6639248, 'auroc': 0.85333335, 'binary_precision': 0.84166664, 'binary_recall': 0.4488889, 'binary_specificity': 0.91555554, 'binary_f1_score': 0.5855073}
confusion matrix:
     0    1
0  206   19
1  124  101
new oracle model saved
better model found
persisted
after epoch: 27,now: 2024-07-20 15:58:49.146949,epoch time: 0:00:58.518492,used: 0:26:25.183878,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_15_32_23_seed_1_22504815
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.91503906, 'precision': 0.92101085, 'recall': 0.91579527, 'specificity': 0.91579527, 'f1': 0.9148278, 'auroc': 0.96840954, 'binary_precision': 0.9743402, 'binary_recall': 0.85466236, 'binary_specificity': 0.9769282, 'binary_f1_score': 0.9105858}
confusion matrix:
      0     1
0  1482    35
1   226  1329
---- Validation: 
scalar performance:
{'acc': 0.6299766, 'precision': 0.68440545, 'recall': 0.6253712, 'specificity': 0.6253712, 'f1': 0.59569776, 'auroc': 0.8125423, 'binary_precision': 0.7805755, 'binary_recall': 0.34444445, 'binary_specificity': 0.906298, 'binary_f1_score': 0.47797352}
confusion matrix:
     0    1
0  590   61
1  413  217
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6622222, 'precision': 0.72095025, 'recall': 0.66222227, 'specificity': 0.66222227, 'f1': 0.6381795, 'auroc': 0.8558222, 'binary_precision': 0.8348624, 'binary_recall': 0.40444446, 'binary_specificity': 0.92, 'binary_f1_score': 0.5449102}
confusion matrix:
     0   1
0  207  18
1  134  91
early stop counter: 1
val acc:0.6299765706062317, best validation acc: 0.6370023488998413, corresponding to test acc:                         0.6822222471237183 / 0.6822222471237183
after epoch: 28,now: 2024-07-20 15:59:47.779197,epoch time: 0:00:58.632248,used: 0:27:23.816126,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_15_32_23_seed_1_22504815
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9111328, 'precision': 0.91641724, 'recall': 0.9118481, 'specificity': 0.9118481, 'f1': 0.9109398, 'auroc': 0.96149445, 'binary_precision': 0.9665211, 'binary_recall': 0.8540193, 'binary_specificity': 0.969677, 'binary_f1_score': 0.9067941}
confusion matrix:
      0     1
0  1471    46
1   227  1328
---- Validation: 
scalar performance:
{'acc': 0.63309914, 'precision': 0.68533754, 'recall': 0.628597, 'specificity': 0.628597, 'f1': 0.6006794, 'auroc': 0.813959, 'binary_precision': 0.7797203, 'binary_recall': 0.35396826, 'binary_specificity': 0.9032258, 'binary_f1_score': 0.48689955}
confusion matrix:
     0    1
0  588   63
1  407  223
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.66444445, 'precision': 0.72259355, 'recall': 0.66444445, 'specificity': 0.66444445, 'f1': 0.6409985, 'auroc': 0.85694814, 'binary_precision': 0.8363636, 'binary_recall': 0.40888888, 'binary_specificity': 0.92, 'binary_f1_score': 0.5492537}
confusion matrix:
     0   1
0  207  18
1  133  92
early stop counter: 2
val acc:0.6330991387367249, best validation acc: 0.6370023488998413, corresponding to test acc:                         0.6822222471237183 / 0.6822222471237183
after epoch: 29,now: 2024-07-20 16:00:46.137262,epoch time: 0:00:58.358065,used: 0:28:22.174191,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_15_32_23_seed_1_22504815
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.90527344, 'precision': 0.9115166, 'recall': 0.90605235, 'specificity': 0.90605235, 'f1': 0.9050189, 'auroc': 0.95949614, 'binary_precision': 0.96539026, 'binary_recall': 0.84308684, 'binary_specificity': 0.9690178, 'binary_f1_score': 0.9001029}
confusion matrix:
      0     1
0  1470    47
1   244  1311
---- Validation: 
scalar performance:
{'acc': 0.6362217, 'precision': 0.68983907, 'recall': 0.6317204, 'specificity': 0.6317204, 'f1': 0.6040779, 'auroc': 0.8169385, 'binary_precision': 0.7867133, 'binary_recall': 0.35714287, 'binary_specificity': 0.906298, 'binary_f1_score': 0.4912664}
confusion matrix:
     0    1
0  590   61
1  405  225
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6755555, 'precision': 0.73338413, 'recall': 0.6755556, 'specificity': 0.6755556, 'f1': 0.65413046, 'auroc': 0.85868645, 'binary_precision': 0.8495575, 'binary_recall': 0.42666668, 'binary_specificity': 0.92444444, 'binary_f1_score': 0.56804734}
confusion matrix:
     0   1
0  208  17
1  129  96
early stop counter: 3
val acc:0.636221706867218, best validation acc: 0.6370023488998413, corresponding to test acc:                         0.6822222471237183 / 0.6822222471237183
after epoch: 30,now: 2024-07-20 16:01:44.459217,epoch time: 0:00:58.321955,used: 0:29:20.496146,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_15_32_23_seed_1_22504815
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 0:29:20.496146 at 2024-07-20 16:01:44.459217
persisted model performance metric: 

scalar performance:
{'acc': 0.68222225, 'precision': 0.7329545, 'recall': 0.68222225, 'specificity': 0.68222225, 'f1': 0.6639248, 'auroc': 0.85333335, 'binary_precision': 0.84166664, 'binary_recall': 0.4488889, 'binary_specificity': 0.91555554, 'binary_f1_score': 0.5855073}
confusion matrix:
     0    1
0  206   19
1  124  101
oracle model performance metric: 

scalar performance:
{'acc': 0.68222225, 'precision': 0.7329545, 'recall': 0.68222225, 'specificity': 0.68222225, 'f1': 0.6639248, 'auroc': 0.85333335, 'binary_precision': 0.84166664, 'binary_recall': 0.4488889, 'binary_specificity': 0.91555554, 'binary_f1_score': 0.5855073}
confusion matrix:
     0    1
0  206   19
1  124  101
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_halffreezeblocks_2024-07-20_12-47-21/rule_results/5.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_halffreezeblocks_2024-07-20_12-47-21/confusion_matrix/5.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 195613 KiB |   7828 MiB | 124076 GiB | 124075 GiB |
|       from large pool | 179211 KiB |   7805 MiB | 122424 GiB | 122423 GiB |
|       from small pool |  16402 KiB |     36 MiB |   1652 GiB |   1652 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 195613 KiB |   7828 MiB | 124076 GiB | 124075 GiB |
|       from large pool | 179211 KiB |   7805 MiB | 122424 GiB | 122423 GiB |
|       from small pool |  16402 KiB |     36 MiB |   1652 GiB |   1652 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 195189 KiB |   7827 MiB | 124061 GiB | 124061 GiB |
|       from large pool | 178979 KiB |   7804 MiB | 122412 GiB | 122412 GiB |
|       from small pool |  16210 KiB |     36 MiB |   1648 GiB |   1648 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   8514 MiB |   8524 MiB |  16788 MiB |   8274 MiB |
|       from large pool |   8472 MiB |   8486 MiB |  16732 MiB |   8260 MiB |
|       from small pool |     42 MiB |     42 MiB |     56 MiB |     14 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  39907 KiB | 732464 KiB |  67125 GiB |  67125 GiB |
|       from large pool |  31733 KiB | 730714 KiB |  65468 GiB |  65468 GiB |
|       from small pool |   8174 KiB |  22319 KiB |   1657 GiB |   1657 GiB |
|---------------------------------------------------------------------------|
| Allocations           |     800    |    1679    |   20971 K  |   20970 K  |
|       from large pool |      79    |     762    |   11399 K  |   11399 K  |
|       from small pool |     721    |    1017    |    9572 K  |    9571 K  |
|---------------------------------------------------------------------------|
| Active allocs         |     800    |    1679    |   20971 K  |   20970 K  |
|       from large pool |      79    |     762    |   11399 K  |   11399 K  |
|       from small pool |     721    |    1017    |    9572 K  |    9571 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     369    |     369    |     714    |     345    |
|       from large pool |     348    |     349    |     686    |     338    |
|       from small pool |      21    |      21    |      28    |       7    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      42    |     381    |   12529 K  |   12529 K  |
|       from large pool |      11    |     351    |    8266 K  |    8265 K  |
|       from small pool |      31    |     215    |    4263 K  |    4263 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   7828 MiB | 124076 GiB | 124076 GiB |
|       from large pool |  16640 KiB |   7805 MiB | 122424 GiB | 122424 GiB |
|       from small pool |      0 KiB |     36 MiB |   1652 GiB |   1652 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   7828 MiB | 124076 GiB | 124076 GiB |
|       from large pool |  16640 KiB |   7805 MiB | 122424 GiB | 122424 GiB |
|       from small pool |      0 KiB |     36 MiB |   1652 GiB |   1652 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   7827 MiB | 124061 GiB | 124061 GiB |
|       from large pool |  16640 KiB |   7804 MiB | 122412 GiB | 122412 GiB |
|       from small pool |      0 KiB |     36 MiB |   1648 GiB |   1648 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 235520 KiB |   8524 MiB |  16788 MiB |  16558 MiB |
|       from large pool | 210944 KiB |   8486 MiB |  16732 MiB |  16526 MiB |
|       from small pool |  24576 KiB |     42 MiB |     56 MiB |     32 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  30464 KiB | 732464 KiB |  67126 GiB |  67126 GiB |
|       from large pool |  30464 KiB | 730714 KiB |  65468 GiB |  65468 GiB |
|       from small pool |      0 KiB |  22319 KiB |   1657 GiB |   1657 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    1679    |   20971 K  |   20971 K  |
|       from large pool |       2    |     762    |   11399 K  |   11399 K  |
|       from small pool |       0    |    1017    |    9572 K  |    9572 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    1679    |   20971 K  |   20971 K  |
|       from large pool |       2    |     762    |   11399 K  |   11399 K  |
|       from small pool |       0    |    1017    |    9572 K  |    9572 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      22    |     369    |     714    |     692    |
|       from large pool |      10    |     349    |     686    |     676    |
|       from small pool |      12    |      21    |      28    |      16    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     381    |   12529 K  |   12529 K  |
|       from large pool |       3    |     351    |    8266 K  |    8266 K  |
|       from small pool |       0    |     215    |    4263 K  |    4263 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   7828 MiB | 124076 GiB | 124076 GiB |
|       from large pool |  16640 KiB |   7805 MiB | 122424 GiB | 122424 GiB |
|       from small pool |      0 KiB |     36 MiB |   1652 GiB |   1652 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   7828 MiB | 124076 GiB | 124076 GiB |
|       from large pool |  16640 KiB |   7805 MiB | 122424 GiB | 122424 GiB |
|       from small pool |      0 KiB |     36 MiB |   1652 GiB |   1652 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   7827 MiB | 124061 GiB | 124061 GiB |
|       from large pool |  16640 KiB |   7804 MiB | 122412 GiB | 122412 GiB |
|       from small pool |      0 KiB |     36 MiB |   1648 GiB |   1648 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 235520 KiB |   8524 MiB |  16788 MiB |  16558 MiB |
|       from large pool | 210944 KiB |   8486 MiB |  16732 MiB |  16526 MiB |
|       from small pool |  24576 KiB |     42 MiB |     56 MiB |     32 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  30464 KiB | 732464 KiB |  67126 GiB |  67126 GiB |
|       from large pool |  30464 KiB | 730714 KiB |  65468 GiB |  65468 GiB |
|       from small pool |      0 KiB |  22319 KiB |   1657 GiB |   1657 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    1679    |   20971 K  |   20971 K  |
|       from large pool |       2    |     762    |   11399 K  |   11399 K  |
|       from small pool |       0    |    1017    |    9572 K  |    9572 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    1679    |   20971 K  |   20971 K  |
|       from large pool |       2    |     762    |   11399 K  |   11399 K  |
|       from small pool |       0    |    1017    |    9572 K  |    9572 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      22    |     369    |     714    |     692    |
|       from large pool |      10    |     349    |     686    |     676    |
|       from small pool |      12    |      21    |      28    |      16    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     381    |   12529 K  |   12529 K  |
|       from large pool |       3    |     351    |    8266 K  |    8266 K  |
|       from small pool |       0    |     215    |    4263 K  |    4263 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'888c1ef2'
model name: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_16_02_43_seed_2_22504815

 Experiment start at: 2024-07-20 16:02:43.355785
before training, model accuracy: 0.41203704476356506
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.595877, 'precision': 0.6141056, 'recall': 0.59738636, 'specificity': 0.59738636, 'f1': 0.58115184, 'auroc': 0.65814877, 'binary_precision': 0.66171795, 'binary_recall': 0.40519482, 'binary_specificity': 0.78957784, 'binary_f1_score': 0.50261784}
confusion matrix:
      0    1
0  1197  319
1   916  624
---- Validation: 
scalar performance:
{'acc': 0.6455399, 'precision': 0.65401375, 'recall': 0.64189327, 'specificity': 0.64189327, 'f1': 0.63691247, 'auroc': 0.669896, 'binary_precision': 0.68409586, 'binary_recall': 0.50482315, 'binary_specificity': 0.7789634, 'binary_f1_score': 0.5809435}
confusion matrix:
     0    1
0  511  145
1  308  314
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.37037036, 'precision': 0.34976155, 'recall': 0.3703704, 'specificity': 0.3703704, 'f1': 0.34801137, 'auroc': 0.309435, 'binary_precision': 0.29411766, 'binary_recall': 0.18518518, 'binary_specificity': 0.5555556, 'binary_f1_score': 0.22727273}
confusion matrix:
     0   1
0  120  96
1  176  40
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-20 16:03:49.305293,epoch time: 0:01:05.949508,used: 0:01:05.949508,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_16_02_43_seed_2_22504815
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.66197646, 'precision': 0.66272753, 'recall': 0.66221, 'specificity': 0.66221, 'f1': 0.6617727, 'auroc': 0.7163841, 'binary_precision': 0.6759195, 'binary_recall': 0.6324675, 'binary_specificity': 0.6919525, 'binary_f1_score': 0.65347195}
confusion matrix:
      0    1
0  1049  467
1   566  974
---- Validation: 
scalar performance:
{'acc': 0.65884197, 'precision': 0.6591974, 'recall': 0.6575587, 'specificity': 0.6575587, 'f1': 0.65736175, 'auroc': 0.6898283, 'binary_precision': 0.6625874, 'binary_recall': 0.60932475, 'binary_specificity': 0.70579267, 'binary_f1_score': 0.6348409}
confusion matrix:
     0    1
0  463  193
1  243  379
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.3935185, 'precision': 0.39195302, 'recall': 0.3935185, 'specificity': 0.3935185, 'f1': 0.3913137, 'auroc': 0.33948475, 'binary_precision': 0.37894738, 'binary_recall': 0.33333334, 'binary_specificity': 0.4537037, 'binary_f1_score': 0.35467982}
confusion matrix:
     0    1
0   98  118
1  144   72
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-07-20 16:04:46.586282,epoch time: 0:00:57.280989,used: 0:02:03.230497,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_16_02_43_seed_2_22504815
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.70713353, 'precision': 0.70712286, 'recall': 0.7071334, 'specificity': 0.7071334, 'f1': 0.7071245, 'auroc': 0.77828705, 'binary_precision': 0.7103718, 'binary_recall': 0.70714283, 'binary_specificity': 0.707124, 'binary_f1_score': 0.70875365}
confusion matrix:
      0     1
0  1072   444
1   451  1089
---- Validation: 
scalar performance:
{'acc': 0.6674491, 'precision': 0.6679354, 'recall': 0.66615117, 'specificity': 0.66615117, 'f1': 0.6659715, 'auroc': 0.70397174, 'binary_precision': 0.67250437, 'binary_recall': 0.61736333, 'binary_specificity': 0.714939, 'binary_f1_score': 0.64375526}
confusion matrix:
     0    1
0  469  187
1  238  384
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.4560185, 'precision': 0.4558054, 'recall': 0.4560185, 'specificity': 0.4560185, 'f1': 0.4553619, 'auroc': 0.37452847, 'binary_precision': 0.45273632, 'binary_recall': 0.4212963, 'binary_specificity': 0.49074075, 'binary_f1_score': 0.43645084}
confusion matrix:
     0    1
0  106  110
1  125   91
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-07-20 16:05:43.683658,epoch time: 0:00:57.097376,used: 0:03:00.327873,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_16_02_43_seed_2_22504815
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.7388743, 'precision': 0.7388638, 'recall': 0.7388377, 'specificity': 0.7388377, 'f1': 0.7388457, 'auroc': 0.81881875, 'binary_precision': 0.7396641, 'binary_recall': 0.7435065, 'binary_specificity': 0.7341689, 'binary_f1_score': 0.74158037}
confusion matrix:
      0     1
0  1113   403
1   395  1145
---- Validation: 
scalar performance:
{'acc': 0.6791862, 'precision': 0.681214, 'recall': 0.67733413, 'specificity': 0.67733413, 'f1': 0.6767032, 'auroc': 0.7143067, 'binary_precision': 0.69485295, 'binary_recall': 0.60771704, 'binary_specificity': 0.7469512, 'binary_f1_score': 0.6483705}
confusion matrix:
     0    1
0  490  166
1  244  378
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.4699074, 'precision': 0.46962026, 'recall': 0.4699074, 'specificity': 0.4699074, 'f1': 0.46865183, 'auroc': 0.40155607, 'binary_precision': 0.46666667, 'binary_recall': 0.4212963, 'binary_specificity': 0.5185185, 'binary_f1_score': 0.4428224}
confusion matrix:
     0    1
0  112  104
1  125   91
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-07-20 16:06:40.672261,epoch time: 0:00:56.988603,used: 0:03:57.316476,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_16_02_43_seed_2_22504815
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.76865184, 'precision': 0.76998913, 'recall': 0.7689177, 'specificity': 0.7689177, 'f1': 0.7684727, 'auroc': 0.8502861, 'binary_precision': 0.7910552, 'binary_recall': 0.7350649, 'binary_specificity': 0.80277044, 'binary_f1_score': 0.7620329}
confusion matrix:
      0     1
0  1217   299
1   408  1132
---- Validation: 
scalar performance:
{'acc': 0.6791862, 'precision': 0.68380284, 'recall': 0.6766675, 'specificity': 0.6766675, 'f1': 0.67506087, 'auroc': 0.7218895, 'binary_precision': 0.70703125, 'binary_recall': 0.5819936, 'binary_specificity': 0.77134144, 'binary_f1_score': 0.63844794}
confusion matrix:
     0    1
0  506  150
1  260  362
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.4699074, 'precision': 0.469096, 'recall': 0.4699074, 'specificity': 0.4699074, 'f1': 0.4664049, 'auroc': 0.43383485, 'binary_precision': 0.4640884, 'binary_recall': 0.3888889, 'binary_specificity': 0.5509259, 'binary_f1_score': 0.42317382}
confusion matrix:
     0   1
0  119  97
1  132  84
early stop counter: 1
val acc:0.679186224937439, best validation acc: 0.679186224937439, corresponding to test acc:                         0.46990740299224854 / 0.46990740299224854
after epoch: 5,now: 2024-07-20 16:07:38.858544,epoch time: 0:00:58.186283,used: 0:04:55.502759,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_16_02_43_seed_2_22504815
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.8033377, 'precision': 0.8054291, 'recall': 0.80365705, 'specificity': 0.80365705, 'f1': 0.80310524, 'auroc': 0.88080907, 'binary_precision': 0.83274275, 'binary_recall': 0.762987, 'binary_specificity': 0.84432715, 'binary_f1_score': 0.7963402}
confusion matrix:
      0     1
0  1280   236
1   365  1175
---- Validation: 
scalar performance:
{'acc': 0.68622845, 'precision': 0.6940439, 'recall': 0.683194, 'specificity': 0.683194, 'f1': 0.6806439, 'auroc': 0.72962415, 'binary_precision': 0.7268994, 'binary_recall': 0.56913185, 'binary_specificity': 0.7972561, 'binary_f1_score': 0.638413}
confusion matrix:
     0    1
0  523  133
1  268  354
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.4837963, 'precision': 0.48283964, 'recall': 0.4837963, 'specificity': 0.4837963, 'f1': 0.4765002, 'auroc': 0.46352023, 'binary_precision': 0.47878787, 'binary_recall': 0.36574075, 'binary_specificity': 0.6018519, 'binary_f1_score': 0.41469815}
confusion matrix:
     0   1
0  130  86
1  137  79
new oracle model saved
better model found
persisted
after epoch: 6,now: 2024-07-20 16:08:37.729175,epoch time: 0:00:58.870631,used: 0:05:54.373390,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_16_02_43_seed_2_22504815
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.8187173, 'precision': 0.82086456, 'recall': 0.81903505, 'specificity': 0.81903505, 'f1': 0.8185071, 'auroc': 0.8989068, 'binary_precision': 0.8491501, 'binary_recall': 0.7785714, 'binary_specificity': 0.8594987, 'binary_f1_score': 0.81233066}
confusion matrix:
      0     1
0  1303   213
1   341  1199
---- Validation: 
scalar performance:
{'acc': 0.68075114, 'precision': 0.6930841, 'recall': 0.6770253, 'specificity': 0.6770253, 'f1': 0.67257106, 'auroc': 0.733891, 'binary_precision': 0.73568285, 'binary_recall': 0.53697747, 'binary_specificity': 0.81707317, 'binary_f1_score': 0.62081784}
confusion matrix:
     0    1
0  536  120
1  288  334
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.46296296, 'precision': 0.45861673, 'recall': 0.46296299, 'specificity': 0.46296299, 'f1': 0.44848233, 'auroc': 0.4877615, 'binary_precision': 0.44520548, 'binary_recall': 0.30092594, 'binary_specificity': 0.625, 'binary_f1_score': 0.35911605}
confusion matrix:
     0   1
0  135  81
1  151  65
early stop counter: 1
val acc:0.6807511448860168, best validation acc: 0.6862284541130066, corresponding to test acc:                         0.48379629850387573 / 0.48379629850387573
after epoch: 7,now: 2024-07-20 16:09:34.740092,epoch time: 0:00:57.010917,used: 0:06:51.384307,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_16_02_43_seed_2_22504815
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.8367147, 'precision': 0.8416457, 'recall': 0.83718514, 'specificity': 0.83718514, 'f1': 0.83624876, 'auroc': 0.9075, 'binary_precision': 0.88470066, 'binary_recall': 0.7772727, 'binary_specificity': 0.89709765, 'binary_f1_score': 0.82751465}
confusion matrix:
      0     1
0  1360   156
1   343  1197
---- Validation: 
scalar performance:
{'acc': 0.6768388, 'precision': 0.6958573, 'recall': 0.67233944, 'specificity': 0.67233944, 'f1': 0.6651273, 'auroc': 0.7356286, 'binary_precision': 0.7505995, 'binary_recall': 0.50321543, 'binary_specificity': 0.8414634, 'binary_f1_score': 0.6025024}
confusion matrix:
     0    1
0  552  104
1  309  313
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.4699074, 'precision': 0.4643935, 'recall': 0.4699074, 'specificity': 0.4699074, 'f1': 0.4485588, 'auroc': 0.5038152, 'binary_precision': 0.45038167, 'binary_recall': 0.27314815, 'binary_specificity': 0.6666667, 'binary_f1_score': 0.34005764}
confusion matrix:
     0   1
0  144  72
1  157  59
early stop counter: 2
val acc:0.6768388152122498, best validation acc: 0.6862284541130066, corresponding to test acc:                         0.48379629850387573 / 0.48379629850387573
after epoch: 8,now: 2024-07-20 16:10:31.250864,epoch time: 0:00:56.510772,used: 0:07:47.895079,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_16_02_43_seed_2_22504815
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.8537304, 'precision': 0.8582257, 'recall': 0.8541711, 'specificity': 0.8541711, 'f1': 0.85337245, 'auroc': 0.9132817, 'binary_precision': 0.9003663, 'binary_recall': 0.79805195, 'binary_specificity': 0.91029024, 'binary_f1_score': 0.8461274}
confusion matrix:
      0     1
0  1380   136
1   311  1229
---- Validation: 
scalar performance:
{'acc': 0.6791862, 'precision': 0.70408785, 'recall': 0.67420936, 'specificity': 0.67420936, 'f1': 0.6651114, 'auroc': 0.7390033, 'binary_precision': 0.7690355, 'binary_recall': 0.48713827, 'binary_specificity': 0.8612805, 'binary_f1_score': 0.59645665}
confusion matrix:
     0    1
0  565   91
1  319  303
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.49305555, 'precision': 0.49139008, 'recall': 0.49305558, 'specificity': 0.49305558, 'f1': 0.46729428, 'auroc': 0.5196545, 'binary_precision': 0.4876033, 'binary_recall': 0.27314815, 'binary_specificity': 0.712963, 'binary_f1_score': 0.35014835}
confusion matrix:
     0   1
0  154  62
1  157  59
new oracle model saved
early stop counter: 3
val acc:0.679186224937439, best validation acc: 0.6862284541130066, corresponding to test acc:                         0.48379629850387573 / 0.4930555522441864
after epoch: 9,now: 2024-07-20 16:11:28.089787,epoch time: 0:00:56.838923,used: 0:08:44.734002,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_16_02_43_seed_2_22504815
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.8566754, 'precision': 0.85896647, 'recall': 0.85699034, 'specificity': 0.85699034, 'f1': 0.8565155, 'auroc': 0.92770875, 'binary_precision': 0.88967466, 'binary_recall': 0.8168831, 'binary_specificity': 0.89709765, 'binary_f1_score': 0.8517265}
confusion matrix:
      0     1
0  1360   156
1   282  1258
---- Validation: 
scalar performance:
{'acc': 0.68153363, 'precision': 0.70402193, 'recall': 0.6767876, 'specificity': 0.6767876, 'f1': 0.6687565, 'auroc': 0.7449342, 'binary_precision': 0.7654321, 'binary_recall': 0.49839228, 'binary_specificity': 0.85518295, 'binary_f1_score': 0.6037001}
confusion matrix:
     0    1
0  561   95
1  312  310
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5023148, 'precision': 0.50276303, 'recall': 0.5023148, 'specificity': 0.5023148, 'f1': 0.4812767, 'auroc': 0.5382588, 'binary_precision': 0.503876, 'binary_recall': 0.30092594, 'binary_specificity': 0.7037037, 'binary_f1_score': 0.37681156}
confusion matrix:
     0   1
0  152  64
1  151  65
new oracle model saved
early stop counter: 4
val acc:0.6815336346626282, best validation acc: 0.6862284541130066, corresponding to test acc:                         0.48379629850387573 / 0.5023148059844971
after epoch: 10,now: 2024-07-20 16:12:25.402626,epoch time: 0:00:57.312839,used: 0:09:42.046841,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_16_02_43_seed_2_22504815
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.8736911, 'precision': 0.8755566, 'recall': 0.8739711, 'specificity': 0.8739711, 'f1': 0.8735863, 'auroc': 0.9370186, 'binary_precision': 0.9040616, 'binary_recall': 0.8383117, 'binary_specificity': 0.9096306, 'binary_f1_score': 0.8699461}
confusion matrix:
      0     1
0  1379   137
1   249  1291
---- Validation: 
scalar performance:
{'acc': 0.6799687, 'precision': 0.70860434, 'recall': 0.6747216, 'specificity': 0.6747216, 'f1': 0.66443104, 'auroc': 0.7475492, 'binary_precision': 0.77952754, 'binary_recall': 0.47749197, 'binary_specificity': 0.8719512, 'binary_f1_score': 0.5922233}
confusion matrix:
     0    1
0  572   84
1  325  297
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5023148, 'precision': 0.5028996, 'recall': 0.5023148, 'specificity': 0.5023148, 'f1': 0.47589087, 'auroc': 0.5501543, 'binary_precision': 0.5042017, 'binary_recall': 0.2777778, 'binary_specificity': 0.7268519, 'binary_f1_score': 0.35820898}
confusion matrix:
     0   1
0  157  59
1  156  60
early stop counter: 5
val acc:0.6799687147140503, best validation acc: 0.6862284541130066, corresponding to test acc:                         0.48379629850387573 / 0.5023148059844971
after epoch: 11,now: 2024-07-20 16:13:23.634696,epoch time: 0:00:58.232070,used: 0:10:40.278911,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_16_02_43_seed_2_22504815
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.87729055, 'precision': 0.8794261, 'recall': 0.87758887, 'specificity': 0.87758887, 'f1': 0.8771719, 'auroc': 0.94308114, 'binary_precision': 0.9099226, 'binary_recall': 0.8396104, 'binary_specificity': 0.9155673, 'binary_f1_score': 0.8733536}
confusion matrix:
      0     1
0  1388   128
1   247  1293
---- Validation: 
scalar performance:
{'acc': 0.6682316, 'precision': 0.704607, 'recall': 0.6622887, 'specificity': 0.6622887, 'f1': 0.6477736, 'auroc': 0.7474316, 'binary_precision': 0.7844828, 'binary_recall': 0.43890676, 'binary_specificity': 0.8856707, 'binary_f1_score': 0.5628866}
confusion matrix:
     0    1
0  581   75
1  349  273
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5115741, 'precision': 0.51552844, 'recall': 0.5115741, 'specificity': 0.5115741, 'f1': 0.4783654, 'auroc': 0.5589421, 'binary_precision': 0.5233645, 'binary_recall': 0.25925925, 'binary_specificity': 0.7638889, 'binary_f1_score': 0.3467492}
confusion matrix:
     0   1
0  165  51
1  160  56
new oracle model saved
early stop counter: 6
val acc:0.6682316064834595, best validation acc: 0.6862284541130066, corresponding to test acc:                         0.48379629850387573 / 0.5115740895271301
after epoch: 12,now: 2024-07-20 16:14:22.044319,epoch time: 0:00:58.409623,used: 0:11:38.688534,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_16_02_43_seed_2_22504815
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.88350785, 'precision': 0.88828874, 'recall': 0.88394785, 'specificity': 0.88394785, 'f1': 0.8832265, 'auroc': 0.9453834, 'binary_precision': 0.93338215, 'binary_recall': 0.8279221, 'binary_specificity': 0.9399736, 'binary_f1_score': 0.8774949}
confusion matrix:
      0     1
0  1425    91
1   265  1275
---- Validation: 
scalar performance:
{'acc': 0.6580595, 'precision': 0.70367897, 'recall': 0.6514219, 'specificity': 0.6514219, 'f1': 0.63184917, 'auroc': 0.74866676, 'binary_precision': 0.7936508, 'binary_recall': 0.40192926, 'binary_specificity': 0.9009146, 'binary_f1_score': 0.533618}
confusion matrix:
     0    1
0  591   65
1  372  250
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5162037, 'precision': 0.5239794, 'recall': 0.5162037, 'specificity': 0.5162037, 'f1': 0.47352397, 'auroc': 0.57096624, 'binary_precision': 0.53763443, 'binary_recall': 0.23148148, 'binary_specificity': 0.8009259, 'binary_f1_score': 0.32362458}
confusion matrix:
     0   1
0  173  43
1  166  50
new oracle model saved
early stop counter: 7
val acc:0.6580594778060913, best validation acc: 0.6862284541130066, corresponding to test acc:                         0.48379629850387573 / 0.5162037014961243
after epoch: 13,now: 2024-07-20 16:15:19.321421,epoch time: 0:00:57.277102,used: 0:12:35.965636,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_16_02_43_seed_2_22504815
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.8861257, 'precision': 0.89082205, 'recall': 0.8865607, 'specificity': 0.8865607, 'f1': 0.88585794, 'auroc': 0.94735634, 'binary_precision': 0.9356725, 'binary_recall': 0.83116883, 'binary_specificity': 0.9419525, 'binary_f1_score': 0.88033015}
confusion matrix:
      0     1
0  1428    88
1   260  1280
---- Validation: 
scalar performance:
{'acc': 0.6517997, 'precision': 0.70100176, 'recall': 0.6448661, 'specificity': 0.6448661, 'f1': 0.62268597, 'auroc': 0.7489878, 'binary_precision': 0.79401994, 'binary_recall': 0.38424438, 'binary_specificity': 0.9054878, 'binary_f1_score': 0.51787645}
confusion matrix:
     0    1
0  594   62
1  383  239
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5208333, 'precision': 0.53132355, 'recall': 0.5208333, 'specificity': 0.5208333, 'f1': 0.47704956, 'auroc': 0.5775249, 'binary_precision': 0.5494506, 'binary_recall': 0.23148148, 'binary_specificity': 0.8101852, 'binary_f1_score': 0.3257329}
confusion matrix:
     0   1
0  175  41
1  166  50
new oracle model saved
early stop counter: 8
val acc:0.6517996788024902, best validation acc: 0.6862284541130066, corresponding to test acc:                         0.48379629850387573 / 0.5208333134651184
after epoch: 14,now: 2024-07-20 16:16:16.047725,epoch time: 0:00:56.726304,used: 0:13:32.691940,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_16_02_43_seed_2_22504815
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.8838351, 'precision': 0.88720447, 'recall': 0.8842057, 'specificity': 0.8842057, 'f1': 0.8836466, 'auroc': 0.9444231, 'binary_precision': 0.925341, 'binary_recall': 0.837013, 'binary_specificity': 0.9313984, 'binary_f1_score': 0.8789636}
confusion matrix:
      0     1
0  1412   104
1   251  1289
---- Validation: 
scalar performance:
{'acc': 0.65258217, 'precision': 0.70079637, 'recall': 0.6457116, 'specificity': 0.6457116, 'f1': 0.62406284, 'auroc': 0.7497157, 'binary_precision': 0.7927632, 'binary_recall': 0.3874598, 'binary_specificity': 0.9039634, 'binary_f1_score': 0.52051836}
confusion matrix:
     0    1
0  593   63
1  381  241
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5277778, 'precision': 0.5407906, 'recall': 0.5277778, 'specificity': 0.5277778, 'f1': 0.4868522, 'auroc': 0.5862054, 'binary_precision': 0.5638298, 'binary_recall': 0.24537037, 'binary_specificity': 0.8101852, 'binary_f1_score': 0.34193546}
confusion matrix:
     0   1
0  175  41
1  163  53
new oracle model saved
early stop counter: 9
val acc:0.6525821685791016, best validation acc: 0.6862284541130066, corresponding to test acc:                         0.48379629850387573 / 0.5277777910232544
after epoch: 15,now: 2024-07-20 16:17:13.085105,epoch time: 0:00:57.037380,used: 0:14:29.729320,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_16_02_43_seed_2_22504815
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.89528793, 'precision': 0.8995236, 'recall': 0.89569783, 'specificity': 0.89569783, 'f1': 0.895074, 'auroc': 0.95255375, 'binary_precision': 0.9426705, 'binary_recall': 0.8435065, 'binary_specificity': 0.9478892, 'binary_f1_score': 0.89033586}
confusion matrix:
      0     1
0  1437    79
1   241  1299
---- Validation: 
scalar performance:
{'acc': 0.64632237, 'precision': 0.7028879, 'recall': 0.6389474, 'specificity': 0.6389474, 'f1': 0.6128072, 'auroc': 0.75045836, 'binary_precision': 0.8035714, 'binary_recall': 0.36173633, 'binary_specificity': 0.91615856, 'binary_f1_score': 0.49889135}
confusion matrix:
     0    1
0  601   55
1  397  225
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5115741, 'precision': 0.5189934, 'recall': 0.5115741, 'specificity': 0.5115741, 'f1': 0.45871413, 'auroc': 0.5905403, 'binary_precision': 0.5308642, 'binary_recall': 0.19907407, 'binary_specificity': 0.8240741, 'binary_f1_score': 0.28956228}
confusion matrix:
     0   1
0  178  38
1  173  43
early stop counter: 10
val acc:0.6463223695755005, best validation acc: 0.6862284541130066, corresponding to test acc:                         0.48379629850387573 / 0.5277777910232544
after epoch: 16,now: 2024-07-20 16:18:10.299804,epoch time: 0:00:57.214699,used: 0:15:26.944019,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_16_02_43_seed_2_22504815
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.89496076, 'precision': 0.89903164, 'recall': 0.89536285, 'specificity': 0.89536285, 'f1': 0.89475536, 'auroc': 0.95394236, 'binary_precision': 0.9413468, 'binary_recall': 0.84415585, 'binary_specificity': 0.9465699, 'binary_f1_score': 0.8901061}
confusion matrix:
      0     1
0  1435    81
1   240  1300
---- Validation: 
scalar performance:
{'acc': 0.63771516, 'precision': 0.6955891, 'recall': 0.630105, 'specificity': 0.630105, 'f1': 0.6011405, 'auroc': 0.75118864, 'binary_precision': 0.795539, 'binary_recall': 0.34405145, 'binary_specificity': 0.91615856, 'binary_f1_score': 0.48035914}
confusion matrix:
     0    1
0  601   55
1  408  214
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5208333, 'precision': 0.53792286, 'recall': 0.5208333, 'specificity': 0.5208333, 'f1': 0.45999676, 'auroc': 0.5976938, 'binary_precision': 0.5633803, 'binary_recall': 0.18518518, 'binary_specificity': 0.8564815, 'binary_f1_score': 0.27874565}
confusion matrix:
     0   1
0  185  31
1  176  40
early stop counter: 11
val acc:0.6377151608467102, best validation acc: 0.6862284541130066, corresponding to test acc:                         0.48379629850387573 / 0.5277777910232544
after epoch: 17,now: 2024-07-20 16:19:07.626261,epoch time: 0:00:57.326457,used: 0:16:24.270476,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_16_02_43_seed_2_22504815
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9126309, 'precision': 0.91564023, 'recall': 0.91297245, 'specificity': 0.91297245, 'f1': 0.91251546, 'auroc': 0.9599099, 'binary_precision': 0.9530249, 'binary_recall': 0.8694805, 'binary_specificity': 0.95646435, 'binary_f1_score': 0.9093378}
confusion matrix:
      0     1
0  1450    66
1   201  1339
---- Validation: 
scalar performance:
{'acc': 0.63458526, 'precision': 0.6949276, 'recall': 0.62680626, 'specificity': 0.62680626, 'f1': 0.595991, 'auroc': 0.7529042, 'binary_precision': 0.79693484, 'binary_recall': 0.33440515, 'binary_specificity': 0.91920733, 'binary_f1_score': 0.4711212}
confusion matrix:
     0    1
0  603   53
1  414  208
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5277778, 'precision': 0.5489204, 'recall': 0.5277778, 'specificity': 0.5277778, 'f1': 0.4705755, 'auroc': 0.60948217, 'binary_precision': 0.5810811, 'binary_recall': 0.19907407, 'binary_specificity': 0.8564815, 'binary_f1_score': 0.29655173}
confusion matrix:
     0   1
0  185  31
1  173  43
early stop counter: 12
val acc:0.6345852613449097, best validation acc: 0.6862284541130066, corresponding to test acc:                         0.48379629850387573 / 0.5277777910232544
after epoch: 18,now: 2024-07-20 16:20:05.191327,epoch time: 0:00:57.565066,used: 0:17:21.835542,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_16_02_43_seed_2_22504815
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9054319, 'precision': 0.90848684, 'recall': 0.90577817, 'specificity': 0.90577817, 'f1': 0.90530246, 'auroc': 0.9576941, 'binary_precision': 0.94583035, 'binary_recall': 0.8616883, 'binary_specificity': 0.9498681, 'binary_f1_score': 0.9018009}
confusion matrix:
      0     1
0  1440    76
1   213  1327
---- Validation: 
scalar performance:
{'acc': 0.63223785, 'precision': 0.69723344, 'recall': 0.624228, 'specificity': 0.624228, 'f1': 0.59095585, 'auroc': 0.75364184, 'binary_precision': 0.804, 'binary_recall': 0.3231511, 'binary_specificity': 0.9253049, 'binary_f1_score': 0.46100914}
confusion matrix:
     0    1
0  607   49
1  421  201
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5300926, 'precision': 0.5547774, 'recall': 0.5300926, 'specificity': 0.5300926, 'f1': 0.4704316, 'auroc': 0.61709106, 'binary_precision': 0.5915493, 'binary_recall': 0.19444445, 'binary_specificity': 0.8657407, 'binary_f1_score': 0.29268295}
confusion matrix:
     0   1
0  187  29
1  174  42
new oracle model saved
early stop counter: 13
val acc:0.6322378516197205, best validation acc: 0.6862284541130066, corresponding to test acc:                         0.48379629850387573 / 0.5300925970077515
after epoch: 19,now: 2024-07-20 16:21:02.266803,epoch time: 0:00:57.075476,used: 0:18:18.911018,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_16_02_43_seed_2_22504815
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.8920157, 'precision': 0.89689326, 'recall': 0.8924562, 'specificity': 0.8924562, 'f1': 0.891755, 'auroc': 0.95242953, 'binary_precision': 0.942899, 'binary_recall': 0.8363636, 'binary_specificity': 0.9485488, 'binary_f1_score': 0.8864419}
confusion matrix:
      0     1
0  1438    78
1   252  1288
---- Validation: 
scalar performance:
{'acc': 0.63380283, 'precision': 0.700873, 'recall': 0.6257524, 'specificity': 0.6257524, 'f1': 0.59224445, 'auroc': 0.75555104, 'binary_precision': 0.8104839, 'binary_recall': 0.3231511, 'binary_specificity': 0.92835367, 'binary_f1_score': 0.46206895}
confusion matrix:
     0    1
0  609   47
1  421  201
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5324074, 'precision': 0.55966854, 'recall': 0.5324074, 'specificity': 0.5324074, 'f1': 0.47211272, 'auroc': 0.62135637, 'binary_precision': 0.6, 'binary_recall': 0.19444445, 'binary_specificity': 0.8703704, 'binary_f1_score': 0.29370633}
confusion matrix:
     0   1
0  188  28
1  174  42
new oracle model saved
early stop counter: 14
val acc:0.6338028311729431, best validation acc: 0.6862284541130066, corresponding to test acc:                         0.48379629850387573 / 0.5324074029922485
after epoch: 20,now: 2024-07-20 16:21:59.259377,epoch time: 0:00:56.992574,used: 0:19:15.903592,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_16_02_43_seed_2_22504815
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.91197646, 'precision': 0.9162063, 'recall': 0.9123796, 'specificity': 0.9123796, 'f1': 0.9118043, 'auroc': 0.9594524, 'binary_precision': 0.9601738, 'binary_recall': 0.861039, 'binary_specificity': 0.9637203, 'binary_f1_score': 0.90790826}
confusion matrix:
      0     1
0  1461    55
1   214  1326
---- Validation: 
scalar performance:
{'acc': 0.62910795, 'precision': 0.701702, 'recall': 0.6207626, 'specificity': 0.6207626, 'f1': 0.5837191, 'auroc': 0.75835717, 'binary_precision': 0.8162393, 'binary_recall': 0.30707395, 'binary_specificity': 0.9344512, 'binary_f1_score': 0.44626167}
confusion matrix:
     0    1
0  613   43
1  431  191
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5347222, 'precision': 0.56181556, 'recall': 0.5347222, 'specificity': 0.5347222, 'f1': 0.47746652, 'auroc': 0.63215876, 'binary_precision': 0.60273975, 'binary_recall': 0.2037037, 'binary_specificity': 0.8657407, 'binary_f1_score': 0.30449826}
confusion matrix:
     0   1
0  187  29
1  172  44
new oracle model saved
early stop counter: 15
val acc:0.6291079521179199, best validation acc: 0.6862284541130066, corresponding to test acc:                         0.48379629850387573 / 0.5347222089767456
after epoch: 21,now: 2024-07-20 16:22:56.914550,epoch time: 0:00:57.655173,used: 0:20:13.558765,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_16_02_43_seed_2_22504815
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9060864, 'precision': 0.9128891, 'recall': 0.90659714, 'specificity': 0.90659714, 'f1': 0.9057703, 'auroc': 0.9541317, 'binary_precision': 0.9678865, 'binary_recall': 0.84155846, 'binary_specificity': 0.9716359, 'binary_f1_score': 0.90031266}
confusion matrix:
      0     1
0  1473    43
1   244  1296
---- Validation: 
scalar performance:
{'acc': 0.6103286, 'precision': 0.6901754, 'recall': 0.60130334, 'specificity': 0.60130334, 'f1': 0.5540511, 'auroc': 0.7584307, 'binary_precision': 0.8069307, 'binary_recall': 0.26205787, 'binary_specificity': 0.9405488, 'binary_f1_score': 0.39563107}
confusion matrix:
     0    1
0  617   39
1  459  163
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5439815, 'precision': 0.5906721, 'recall': 0.5439815, 'specificity': 0.5439815, 'f1': 0.47660193, 'auroc': 0.63689554, 'binary_precision': 0.6557377, 'binary_recall': 0.18518518, 'binary_specificity': 0.9027778, 'binary_f1_score': 0.28880864}
confusion matrix:
     0   1
0  195  21
1  176  40
new oracle model saved
early stop counter: 16
val acc:0.6103286147117615, best validation acc: 0.6862284541130066, corresponding to test acc:                         0.48379629850387573 / 0.5439814925193787
after epoch: 22,now: 2024-07-20 16:23:54.351709,epoch time: 0:00:57.437159,used: 0:21:10.995924,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_16_02_43_seed_2_22504815
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.90870416, 'precision': 0.9134728, 'recall': 0.9091329, 'specificity': 0.9091329, 'f1': 0.90849817, 'auroc': 0.96104324, 'binary_precision': 0.9598833, 'binary_recall': 0.8545455, 'binary_specificity': 0.9637203, 'binary_f1_score': 0.9041566}
confusion matrix:
      0     1
0  1461    55
1   224  1316
---- Validation: 
scalar performance:
{'acc': 0.6079812, 'precision': 0.68792295, 'recall': 0.59889174, 'specificity': 0.59889174, 'f1': 0.55050385, 'auroc': 0.7574504, 'binary_precision': 0.8040201, 'binary_recall': 0.25723472, 'binary_specificity': 0.9405488, 'binary_f1_score': 0.38976857}
confusion matrix:
     0    1
0  617   39
1  462  160
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5416667, 'precision': 0.5847428, 'recall': 0.5416666, 'specificity': 0.5416666, 'f1': 0.47494286, 'auroc': 0.64096797, 'binary_precision': 0.6451613, 'binary_recall': 0.18518518, 'binary_specificity': 0.8981481, 'binary_f1_score': 0.28776976}
confusion matrix:
     0   1
0  194  22
1  176  40
early stop counter: 17
val acc:0.6079812049865723, best validation acc: 0.6862284541130066, corresponding to test acc:                         0.48379629850387573 / 0.5439814925193787
after epoch: 23,now: 2024-07-20 16:24:51.993336,epoch time: 0:00:57.641627,used: 0:22:08.637551,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_16_02_43_seed_2_22504815
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9073953, 'precision': 0.91203344, 'recall': 0.9078188, 'specificity': 0.9078188, 'f1': 0.9071921, 'auroc': 0.9582201, 'binary_precision': 0.95775676, 'binary_recall': 0.8538961, 'binary_specificity': 0.96174145, 'binary_f1_score': 0.90284926}
confusion matrix:
      0     1
0  1458    58
1   225  1315
---- Validation: 
scalar performance:
{'acc': 0.62128323, 'precision': 0.6961251, 'recall': 0.61268234, 'specificity': 0.61268234, 'f1': 0.571915, 'auroc': 0.7595899, 'binary_precision': 0.8108108, 'binary_recall': 0.28938907, 'binary_specificity': 0.9359756, 'binary_f1_score': 0.4265403}
confusion matrix:
     0    1
0  614   42
1  442  180
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5416667, 'precision': 0.57671666, 'recall': 0.5416666, 'specificity': 0.5416666, 'f1': 0.48256588, 'auroc': 0.6458976, 'binary_precision': 0.62857145, 'binary_recall': 0.2037037, 'binary_specificity': 0.8796296, 'binary_f1_score': 0.3076923}
confusion matrix:
     0   1
0  190  26
1  172  44
early stop counter: 18
val acc:0.621283233165741, best validation acc: 0.6862284541130066, corresponding to test acc:                         0.48379629850387573 / 0.5439814925193787
after epoch: 24,now: 2024-07-20 16:25:49.484943,epoch time: 0:00:57.491607,used: 0:23:06.129158,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_16_02_43_seed_2_22504815
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.91753924, 'precision': 0.92082125, 'recall': 0.917894, 'specificity': 0.917894, 'f1': 0.91742027, 'auroc': 0.9648999, 'binary_precision': 0.96, 'binary_recall': 0.8727273, 'binary_specificity': 0.9630607, 'binary_f1_score': 0.9142857}
confusion matrix:
      0     1
0  1460    56
1   196  1344
---- Validation: 
scalar performance:
{'acc': 0.6181534, 'precision': 0.6919702, 'recall': 0.6095086, 'specificity': 0.6095086, 'f1': 0.5678567, 'auroc': 0.7615089, 'binary_precision': 0.80454546, 'binary_recall': 0.28456593, 'binary_specificity': 0.9344512, 'binary_f1_score': 0.4204276}
confusion matrix:
     0    1
0  613   43
1  445  177
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5439815, 'precision': 0.57829964, 'recall': 0.5439815, 'specificity': 0.5439815, 'f1': 0.4878652, 'auroc': 0.6529921, 'binary_precision': 0.63013697, 'binary_recall': 0.21296297, 'binary_specificity': 0.875, 'binary_f1_score': 0.31833908}
confusion matrix:
     0   1
0  189  27
1  170  46
early stop counter: 19
val acc:0.6181533932685852, best validation acc: 0.6862284541130066, corresponding to test acc:                         0.48379629850387573 / 0.5439814925193787
after epoch: 25,now: 2024-07-20 16:26:46.255438,epoch time: 0:00:56.770495,used: 0:24:02.899653,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_16_02_43_seed_2_22504815
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9191754, 'precision': 0.923936, 'recall': 0.9195996, 'specificity': 0.9195996, 'f1': 0.918998, 'auroc': 0.966065, 'binary_precision': 0.97086674, 'binary_recall': 0.86558443, 'binary_specificity': 0.97361475, 'binary_f1_score': 0.9152077}
confusion matrix:
      0     1
0  1476    40
1   207  1333
---- Validation: 
scalar performance:
{'acc': 0.6134585, 'precision': 0.6889359, 'recall': 0.60464376, 'specificity': 0.60464376, 'f1': 0.56039906, 'auroc': 0.76239854, 'binary_precision': 0.8018868, 'binary_recall': 0.27331188, 'binary_specificity': 0.9359756, 'binary_f1_score': 0.40767387}
confusion matrix:
     0    1
0  614   42
1  452  170
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5439815, 'precision': 0.57829964, 'recall': 0.5439815, 'specificity': 0.5439815, 'f1': 0.4878652, 'auroc': 0.6570859, 'binary_precision': 0.63013697, 'binary_recall': 0.21296297, 'binary_specificity': 0.875, 'binary_f1_score': 0.31833908}
confusion matrix:
     0   1
0  189  27
1  170  46
early stop counter: 20
val acc:0.613458514213562, best validation acc: 0.6862284541130066, corresponding to test acc:                         0.48379629850387573 / 0.5439814925193787
after epoch: 26,now: 2024-07-20 16:27:43.613783,epoch time: 0:00:57.358345,used: 0:25:00.257998,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_16_02_43_seed_2_22504815
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.91590315, 'precision': 0.9203967, 'recall': 0.91631687, 'specificity': 0.91631687, 'f1': 0.9157288, 'auroc': 0.9648999, 'binary_precision': 0.9658678, 'binary_recall': 0.8636364, 'binary_specificity': 0.96899736, 'binary_f1_score': 0.91189575}
confusion matrix:
      0     1
0  1469    47
1   210  1330
---- Validation: 
scalar performance:
{'acc': 0.6173709, 'precision': 0.69257545, 'recall': 0.6086631, 'specificity': 0.6086631, 'f1': 0.56618214, 'auroc': 0.76444006, 'binary_precision': 0.8064516, 'binary_recall': 0.2813505, 'binary_specificity': 0.9359756, 'binary_f1_score': 0.41716328}
confusion matrix:
     0    1
0  614   42
1  447  175
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5509259, 'precision': 0.58604956, 'recall': 0.5509259, 'specificity': 0.5509259, 'f1': 0.4998926, 'auroc': 0.663816, 'binary_precision': 0.64102566, 'binary_recall': 0.23148148, 'binary_specificity': 0.8703704, 'binary_f1_score': 0.34013605}
confusion matrix:
     0   1
0  188  28
1  166  50
new oracle model saved
early stop counter: 21
val acc:0.6173709034919739, best validation acc: 0.6862284541130066, corresponding to test acc:                         0.48379629850387573 / 0.5509259104728699
after epoch: 27,now: 2024-07-20 16:28:41.029852,epoch time: 0:00:57.416069,used: 0:25:57.674067,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_16_02_43_seed_2_22504815
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.91099477, 'precision': 0.9160881, 'recall': 0.91143644, 'specificity': 0.91143644, 'f1': 0.9107798, 'auroc': 0.9651766, 'binary_precision': 0.96412885, 'binary_recall': 0.8551948, 'binary_specificity': 0.9676781, 'binary_f1_score': 0.9064005}
confusion matrix:
      0     1
0  1467    49
1   223  1317
---- Validation: 
scalar performance:
{'acc': 0.6118936, 'precision': 0.68745315, 'recall': 0.60303605, 'specificity': 0.60303605, 'f1': 0.5580716, 'auroc': 0.76607466, 'binary_precision': 0.8, 'binary_recall': 0.27009645, 'binary_specificity': 0.9359756, 'binary_f1_score': 0.40384614}
confusion matrix:
     0    1
0  614   42
1  454  168
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5486111, 'precision': 0.5847059, 'recall': 0.5486111, 'specificity': 0.5486111, 'f1': 0.49479142, 'auroc': 0.66544497, 'binary_precision': 0.64, 'binary_recall': 0.22222222, 'binary_specificity': 0.875, 'binary_f1_score': 0.32989693}
confusion matrix:
     0   1
0  189  27
1  168  48
early stop counter: 22
val acc:0.6118935942649841, best validation acc: 0.6862284541130066, corresponding to test acc:                         0.48379629850387573 / 0.5509259104728699
after epoch: 28,now: 2024-07-20 16:29:37.742547,epoch time: 0:00:56.712695,used: 0:26:54.386762,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_16_02_43_seed_2_22504815
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9181937, 'precision': 0.922885, 'recall': 0.9186153, 'specificity': 0.9186153, 'f1': 0.9180167, 'auroc': 0.9704511, 'binary_precision': 0.9694323, 'binary_recall': 0.86493504, 'binary_specificity': 0.9722955, 'binary_f1_score': 0.9142073}
confusion matrix:
      0     1
0  1474    42
1   208  1332
---- Validation: 
scalar performance:
{'acc': 0.6095462, 'precision': 0.6894289, 'recall': 0.60049945, 'specificity': 0.60049945, 'f1': 0.5528708, 'auroc': 0.76737607, 'binary_precision': 0.80597013, 'binary_recall': 0.26045015, 'binary_specificity': 0.9405488, 'binary_f1_score': 0.39368162}
confusion matrix:
     0    1
0  617   39
1  460  162
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5532407, 'precision': 0.59478384, 'recall': 0.5532408, 'specificity': 0.5532408, 'f1': 0.4982639, 'auroc': 0.6723037, 'binary_precision': 0.65753424, 'binary_recall': 0.22222222, 'binary_specificity': 0.8842593, 'binary_f1_score': 0.33217993}
confusion matrix:
     0   1
0  191  25
1  168  48
new oracle model saved
early stop counter: 23
val acc:0.6095461845397949, best validation acc: 0.6862284541130066, corresponding to test acc:                         0.48379629850387573 / 0.5532407164573669
after epoch: 29,now: 2024-07-20 16:30:36.376951,epoch time: 0:00:58.634404,used: 0:27:53.021166,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_16_02_43_seed_2_22504815
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.9162304, 'precision': 0.91980326, 'recall': 0.9166004, 'specificity': 0.9166004, 'f1': 0.9160966, 'auroc': 0.9656285, 'binary_precision': 0.9605452, 'binary_recall': 0.8694805, 'binary_specificity': 0.9637203, 'binary_f1_score': 0.9127471}
confusion matrix:
      0     1
0  1461    55
1   201  1339
---- Validation: 
scalar performance:
{'acc': 0.6134585, 'precision': 0.6960553, 'recall': 0.60443544, 'specificity': 0.60443544, 'f1': 0.557633, 'auroc': 0.76695395, 'binary_precision': 0.8168317, 'binary_recall': 0.2652733, 'binary_specificity': 0.94359756, 'binary_f1_score': 0.4004854}
confusion matrix:
     0    1
0  619   37
1  457  165
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5601852, 'precision': 0.59971595, 'recall': 0.5601852, 'specificity': 0.5601852, 'f1': 0.5118006, 'auroc': 0.6789266, 'binary_precision': 0.6625, 'binary_recall': 0.24537037, 'binary_specificity': 0.875, 'binary_f1_score': 0.35810813}
confusion matrix:
     0   1
0  189  27
1  163  53
new oracle model saved
early stop counter: 24
val acc:0.613458514213562, best validation acc: 0.6862284541130066, corresponding to test acc:                         0.48379629850387573 / 0.5601851940155029
after epoch: 30,now: 2024-07-20 16:31:33.702879,epoch time: 0:00:57.325928,used: 0:28:50.347094,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_16_02_43_seed_2_22504815
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 0:28:50.347094 at 2024-07-20 16:31:33.702879
persisted model performance metric: 

scalar performance:
{'acc': 0.4837963, 'precision': 0.48283964, 'recall': 0.4837963, 'specificity': 0.4837963, 'f1': 0.4765002, 'auroc': 0.46352023, 'binary_precision': 0.47878787, 'binary_recall': 0.36574075, 'binary_specificity': 0.6018519, 'binary_f1_score': 0.41469815}
confusion matrix:
     0   1
0  130  86
1  137  79
oracle model performance metric: 

scalar performance:
{'acc': 0.5601852, 'precision': 0.59971595, 'recall': 0.5601852, 'specificity': 0.5601852, 'f1': 0.5118006, 'auroc': 0.6789266, 'binary_precision': 0.6625, 'binary_recall': 0.24537037, 'binary_specificity': 0.875, 'binary_f1_score': 0.35810813}
confusion matrix:
     0   1
0  189  27
1  163  53
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_halffreezeblocks_2024-07-20_12-47-21/rule_results/5.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_halffreezeblocks_2024-07-20_12-47-21/confusion_matrix/5.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 195607 KiB |   7828 MiB | 185299 GiB | 185299 GiB |
|       from large pool | 179211 KiB |   7805 MiB | 182835 GiB | 182835 GiB |
|       from small pool |  16396 KiB |     36 MiB |   2464 GiB |   2464 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 195607 KiB |   7828 MiB | 185299 GiB | 185299 GiB |
|       from large pool | 179211 KiB |   7805 MiB | 182835 GiB | 182835 GiB |
|       from small pool |  16396 KiB |     36 MiB |   2464 GiB |   2464 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 195188 KiB |   7827 MiB | 185275 GiB | 185275 GiB |
|       from large pool | 178979 KiB |   7804 MiB | 182815 GiB | 182815 GiB |
|       from small pool |  16209 KiB |     36 MiB |   2459 GiB |   2459 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   8510 MiB |   8524 MiB |  25068 MiB |  16558 MiB |
|       from large pool |   8472 MiB |   8486 MiB |  24998 MiB |  16526 MiB |
|       from small pool |     38 MiB |     42 MiB |     70 MiB |     32 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  37865 KiB | 732464 KiB |  98950 GiB |  98950 GiB |
|       from large pool |  31733 KiB | 730714 KiB |  96477 GiB |  96477 GiB |
|       from small pool |   6132 KiB |  22319 KiB |   2472 GiB |   2472 GiB |
|---------------------------------------------------------------------------|
| Allocations           |     788    |    1679    |   31316 K  |   31315 K  |
|       from large pool |      79    |     762    |   17022 K  |   17022 K  |
|       from small pool |     709    |    1017    |   14294 K  |   14293 K  |
|---------------------------------------------------------------------------|
| Active allocs         |     788    |    1679    |   31316 K  |   31315 K  |
|       from large pool |      79    |     762    |   17022 K  |   17022 K  |
|       from small pool |     709    |    1017    |   14294 K  |   14293 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     367    |     369    |    1059    |     692    |
|       from large pool |     348    |     349    |    1024    |     676    |
|       from small pool |      19    |      21    |      35    |      16    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      42    |     381    |   18482 K  |   18482 K  |
|       from large pool |      11    |     351    |   12107 K  |   12107 K  |
|       from small pool |      31    |     215    |    6374 K  |    6374 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   7828 MiB | 185299 GiB | 185299 GiB |
|       from large pool |  16640 KiB |   7805 MiB | 182835 GiB | 182835 GiB |
|       from small pool |      0 KiB |     36 MiB |   2464 GiB |   2464 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   7828 MiB | 185299 GiB | 185299 GiB |
|       from large pool |  16640 KiB |   7805 MiB | 182835 GiB | 182835 GiB |
|       from small pool |      0 KiB |     36 MiB |   2464 GiB |   2464 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   7827 MiB | 185275 GiB | 185275 GiB |
|       from large pool |  16640 KiB |   7804 MiB | 182815 GiB | 182815 GiB |
|       from small pool |      0 KiB |     36 MiB |   2459 GiB |   2459 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 233472 KiB |   8524 MiB |  25068 MiB |  24840 MiB |
|       from large pool | 210944 KiB |   8486 MiB |  24998 MiB |  24792 MiB |
|       from small pool |  22528 KiB |     42 MiB |     70 MiB |     48 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  30464 KiB | 732464 KiB |  98950 GiB |  98950 GiB |
|       from large pool |  30464 KiB | 730714 KiB |  96478 GiB |  96478 GiB |
|       from small pool |      0 KiB |  22319 KiB |   2472 GiB |   2472 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    1679    |   31316 K  |   31316 K  |
|       from large pool |       2    |     762    |   17022 K  |   17022 K  |
|       from small pool |       0    |    1017    |   14294 K  |   14294 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    1679    |   31316 K  |   31316 K  |
|       from large pool |       2    |     762    |   17022 K  |   17022 K  |
|       from small pool |       0    |    1017    |   14294 K  |   14294 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      21    |     369    |    1059    |    1038    |
|       from large pool |      10    |     349    |    1024    |    1014    |
|       from small pool |      11    |      21    |      35    |      24    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     381    |   18482 K  |   18482 K  |
|       from large pool |       3    |     351    |   12107 K  |   12107 K  |
|       from small pool |       0    |     215    |    6375 K  |    6375 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Sat Jul 20 16:32:08 2024]
Finished job 0.
1 of 1 steps (100%) done
