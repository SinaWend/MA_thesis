Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Sat Jul 20 13:29:54 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_halffreezeblocks_2024-07-20_12-47-21/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_halffreezeblocks_2024-07-20_12-47-21/rule_results/0.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=0
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/swiglu_ffn.py:51: UserWarning: xFormers is not available (SwiGLU)
  warnings.warn("xFormers is not available (SwiGLU)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/attention.py:33: UserWarning: xFormers is not available (Attention)
  warnings.warn("xFormers is not available (Attention)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/block.py:40: UserWarning: xFormers is not available (Block)
  warnings.warn("xFormers is not available (Block)")
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'888c1ef2'
model name: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_13_32_02_seed_0_22504809

 Experiment start at: 2024-07-20 13:32:02.902786
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
before training, model accuracy: 0.569767415523529
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.8177083, 'precision': 0.8198947, 'recall': 0.81821203, 'specificity': 0.81821203, 'f1': 0.8175375, 'auroc': 0.87397325, 'binary_precision': 0.8496135, 'binary_recall': 0.777492, 'binary_specificity': 0.8589321, 'binary_f1_score': 0.8119544}
confusion matrix:
      0     1
0  1303   214
1   346  1209
---- Validation: 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
scalar performance:
{'acc': 0.5791925, 'precision': 0.60976744, 'recall': 0.5752903, 'specificity': 0.5752903, 'f1': 0.5413431, 'auroc': 0.7190918, 'binary_precision': 0.66431093, 'binary_recall': 0.296063, 'binary_specificity': 0.85451764, 'binary_f1_score': 0.40958607}
confusion matrix:
     0    1
0  558   95
1  447  188
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.59069765, 'precision': 0.6297947, 'recall': 0.5906977, 'specificity': 0.5906977, 'f1': 0.5573648, 'auroc': 0.72144943, 'binary_precision': 0.7010309, 'binary_recall': 0.31627908, 'binary_specificity': 0.8651163, 'binary_f1_score': 0.43589744}
confusion matrix:
     0   1
0  186  29
1  147  68
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-20 13:33:34.906294,epoch time: 0:01:32.003508,used: 0:01:32.003508,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_13_32_02_seed_0_22504809
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.86067706, 'precision': 0.8631454, 'recall': 0.86124754, 'specificity': 0.86124754, 'f1': 0.860552, 'auroc': 0.9184032, 'binary_precision': 0.8966971, 'binary_recall': 0.8195247, 'binary_specificity': 0.9029703, 'binary_f1_score': 0.8563758}
confusion matrix:
      0     1
0  1368   147
1   281  1276
---- Validation: 
scalar performance:
{'acc': 0.5986025, 'precision': 0.62731147, 'recall': 0.5951055, 'specificity': 0.5951055, 'f1': 0.5698499, 'auroc': 0.73605525, 'binary_precision': 0.684375, 'binary_recall': 0.3448819, 'binary_specificity': 0.8453292, 'binary_f1_score': 0.45863876}
confusion matrix:
     0    1
0  552  101
1  416  219
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.61627907, 'precision': 0.6475675, 'recall': 0.61627907, 'specificity': 0.61627907, 'f1': 0.59480065, 'auroc': 0.7573174, 'binary_precision': 0.7155172, 'binary_recall': 0.3860465, 'binary_specificity': 0.8465116, 'binary_f1_score': 0.50151056}
confusion matrix:
     0   1
0  182  33
1  132  83
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-07-20 13:35:00.034191,epoch time: 0:01:25.127897,used: 0:02:57.131405,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_13_32_02_seed_0_22504809
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.875, 'precision': 0.8819982, 'recall': 0.8759817, 'specificity': 0.8759817, 'f1': 0.8746069, 'auroc': 0.9383588, 'binary_precision': 0.93740684, 'binary_recall': 0.80744547, 'binary_specificity': 0.94451785, 'binary_f1_score': 0.8675862}
confusion matrix:
      0     1
0  1430    84
1   300  1258
---- Validation: 
scalar performance:
{'acc': 0.617236, 'precision': 0.645064, 'recall': 0.61402494, 'specificity': 0.61402494, 'f1': 0.59418035, 'auroc': 0.7527535, 'binary_precision': 0.70520234, 'binary_recall': 0.38425198, 'binary_specificity': 0.84379786, 'binary_f1_score': 0.49745163}
confusion matrix:
     0    1
0  551  102
1  391  244
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6465116, 'precision': 0.6793517, 'recall': 0.6465116, 'specificity': 0.6465116, 'f1': 0.62955403, 'auroc': 0.78583014, 'binary_precision': 0.75609756, 'binary_recall': 0.43255815, 'binary_specificity': 0.8604651, 'binary_f1_score': 0.5502959}
confusion matrix:
     0   1
0  185  30
1  122  93
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-07-20 13:36:25.575968,epoch time: 0:01:25.541777,used: 0:04:22.673182,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_13_32_02_seed_0_22504809
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.8873698, 'precision': 0.8932272, 'recall': 0.8882607, 'specificity': 0.8882607, 'f1': 0.8870933, 'auroc': 0.94271314, 'binary_precision': 0.9449339, 'binary_recall': 0.82605904, 'binary_specificity': 0.95046234, 'binary_f1_score': 0.8815068}
confusion matrix:
      0     1
0  1439    75
1   271  1287
---- Validation: 
scalar performance:
{'acc': 0.66381985, 'precision': 0.6781994, 'recall': 0.6617248, 'specificity': 0.6617248, 'f1': 0.6550822, 'auroc': 0.76821214, 'binary_precision': 0.7254464, 'binary_recall': 0.511811, 'binary_specificity': 0.8116386, 'binary_f1_score': 0.6001846}
confusion matrix:
     0    1
0  530  123
1  310  325
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.67209303, 'precision': 0.6945178, 'recall': 0.67209303, 'specificity': 0.67209303, 'f1': 0.662362, 'auroc': 0.8084153, 'binary_precision': 0.7605634, 'binary_recall': 0.5023256, 'binary_specificity': 0.8418605, 'binary_f1_score': 0.60504204}
confusion matrix:
     0    1
0  181   34
1  107  108
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-07-20 13:37:50.784775,epoch time: 0:01:25.208807,used: 0:05:47.881989,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_13_32_02_seed_0_22504809
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.90201825, 'precision': 0.9081604, 'recall': 0.9028768, 'specificity': 0.9028768, 'f1': 0.90176815, 'auroc': 0.9573102, 'binary_precision': 0.9617647, 'binary_recall': 0.84007704, 'binary_specificity': 0.96567655, 'binary_f1_score': 0.8968118}
confusion matrix:
      0     1
0  1463    52
1   249  1308
---- Validation: 
scalar performance:
{'acc': 0.69798136, 'precision': 0.70567834, 'recall': 0.6965441, 'specificity': 0.6965441, 'f1': 0.69410455, 'auroc': 0.785506, 'binary_precision': 0.742126, 'binary_recall': 0.59370077, 'binary_specificity': 0.79938745, 'binary_f1_score': 0.65966755}
confusion matrix:
     0    1
0  522  131
1  258  377
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.727907, 'precision': 0.7365077, 'recall': 0.727907, 'specificity': 0.727907, 'f1': 0.7254106, 'auroc': 0.8304814, 'binary_precision': 0.7816092, 'binary_recall': 0.63255817, 'binary_specificity': 0.82325584, 'binary_f1_score': 0.69922876}
confusion matrix:
     0    1
0  177   38
1   79  136
new oracle model saved
better model found
persisted
after epoch: 5,now: 2024-07-20 13:39:16.774874,epoch time: 0:01:25.990099,used: 0:07:13.872088,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_13_32_02_seed_0_22504809
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9088542, 'precision': 0.9141476, 'recall': 0.9096103, 'specificity': 0.9096103, 'f1': 0.908659, 'auroc': 0.9612547, 'binary_precision': 0.9643377, 'binary_recall': 0.8515424, 'binary_specificity': 0.9676781, 'binary_f1_score': 0.9044369}
confusion matrix:
      0     1
0  1467    49
1   231  1325
---- Validation: 
scalar performance:
{'acc': 0.73990685, 'precision': 0.74147224, 'recall': 0.7392808, 'specificity': 0.7392808, 'f1': 0.73911405, 'auroc': 0.8053442, 'binary_precision': 0.757732, 'binary_recall': 0.69448817, 'binary_specificity': 0.78407353, 'binary_f1_score': 0.7247329}
confusion matrix:
     0    1
0  512  141
1  194  441
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7837209, 'precision': 0.7859541, 'recall': 0.7837209, 'specificity': 0.7837209, 'f1': 0.78329784, 'auroc': 0.849324, 'binary_precision': 0.81122446, 'binary_recall': 0.73953485, 'binary_specificity': 0.82790697, 'binary_f1_score': 0.7737226}
confusion matrix:
     0    1
0  178   37
1   56  159
new oracle model saved
better model found
persisted
after epoch: 6,now: 2024-07-20 13:40:41.594068,epoch time: 0:01:24.819194,used: 0:08:38.691282,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_13_32_02_seed_0_22504809
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9121094, 'precision': 0.91707265, 'recall': 0.9128406, 'specificity': 0.9128406, 'f1': 0.91193676, 'auroc': 0.96736526, 'binary_precision': 0.965942, 'binary_recall': 0.8566838, 'binary_specificity': 0.96899736, 'binary_f1_score': 0.90803814}
confusion matrix:
      0     1
0  1469    47
1   223  1333
---- Validation: 
scalar performance:
{'acc': 0.76086956, 'precision': 0.76206946, 'recall': 0.76034534, 'specificity': 0.76034534, 'f1': 0.76031417, 'auroc': 0.8218688, 'binary_precision': 0.7766498, 'binary_recall': 0.72283465, 'binary_specificity': 0.79785603, 'binary_f1_score': 0.74877656}
confusion matrix:
     0    1
0  521  132
1  176  459
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7976744, 'precision': 0.8000175, 'recall': 0.7976744, 'specificity': 0.7976744, 'f1': 0.79727864, 'auroc': 0.86390483, 'binary_precision': 0.82653064, 'binary_recall': 0.75348836, 'binary_specificity': 0.8418605, 'binary_f1_score': 0.7883212}
confusion matrix:
     0    1
0  181   34
1   53  162
new oracle model saved
better model found
persisted
after epoch: 7,now: 2024-07-20 13:42:07.126528,epoch time: 0:01:25.532460,used: 0:10:04.223742,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_13_32_02_seed_0_22504809
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.92578125, 'precision': 0.9298612, 'recall': 0.9264062, 'specificity': 0.9264062, 'f1': 0.9256678, 'auroc': 0.9780532, 'binary_precision': 0.9749463, 'binary_recall': 0.87588423, 'binary_specificity': 0.9769282, 'binary_f1_score': 0.92276424}
confusion matrix:
      0     1
0  1482    35
1   193  1362
---- Validation: 
scalar performance:
{'acc': 0.76319873, 'precision': 0.7641454, 'recall': 0.7627293, 'specificity': 0.7627293, 'f1': 0.76273406, 'auroc': 0.8298392, 'binary_precision': 0.77684563, 'binary_recall': 0.72913384, 'binary_specificity': 0.7963247, 'binary_f1_score': 0.7522339}
confusion matrix:
     0    1
0  520  133
1  172  463
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.80930233, 'precision': 0.8102689, 'recall': 0.80930233, 'specificity': 0.80930233, 'f1': 0.80915374, 'auroc': 0.87344515, 'binary_precision': 0.82758623, 'binary_recall': 0.7813954, 'binary_specificity': 0.8372093, 'binary_f1_score': 0.8038278}
confusion matrix:
     0    1
0  180   35
1   47  168
new oracle model saved
better model found
persisted
after epoch: 8,now: 2024-07-20 13:43:32.539040,epoch time: 0:01:25.412512,used: 0:11:29.636254,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_13_32_02_seed_0_22504809
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9235026, 'precision': 0.9285512, 'recall': 0.92419565, 'specificity': 0.92419565, 'f1': 0.9233501, 'auroc': 0.9758141, 'binary_precision': 0.9782609, 'binary_recall': 0.8681672, 'binary_specificity': 0.98022413, 'binary_f1_score': 0.9199318}
confusion matrix:
      0     1
0  1487    30
1   205  1350
---- Validation: 
scalar performance:
{'acc': 0.77018636, 'precision': 0.7714498, 'recall': 0.76966393, 'specificity': 0.76966393, 'f1': 0.7696526, 'auroc': 0.8383186, 'binary_precision': 0.78680205, 'binary_recall': 0.7322835, 'binary_specificity': 0.8070444, 'binary_f1_score': 0.7585645}
confusion matrix:
     0    1
0  527  126
1  170  465
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.81627905, 'precision': 0.8168342, 'recall': 0.81627905, 'specificity': 0.81627905, 'f1': 0.8161986, 'auroc': 0.88253105, 'binary_precision': 0.8300971, 'binary_recall': 0.7953488, 'binary_specificity': 0.8372093, 'binary_f1_score': 0.8123516}
confusion matrix:
     0    1
0  180   35
1   44  171
new oracle model saved
better model found
persisted
after epoch: 9,now: 2024-07-20 13:44:58.058481,epoch time: 0:01:25.519441,used: 0:12:55.155695,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_13_32_02_seed_0_22504809
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.929362, 'precision': 0.9314554, 'recall': 0.92989314, 'specificity': 0.92989314, 'f1': 0.9293221, 'auroc': 0.9779271, 'binary_precision': 0.9653019, 'binary_recall': 0.8928113, 'binary_specificity': 0.9669749, 'binary_f1_score': 0.9276426}
confusion matrix:
      0     1
0  1464    50
1   167  1391
---- Validation: 
scalar performance:
{'acc': 0.7795031, 'precision': 0.77947664, 'recall': 0.77952516, 'specificity': 0.77952516, 'f1': 0.779484, 'auroc': 0.8451773, 'binary_precision': 0.77379096, 'binary_recall': 0.78110236, 'binary_specificity': 0.77794796, 'binary_f1_score': 0.77742946}
confusion matrix:
     0    1
0  508  145
1  139  496
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.82093024, 'precision': 0.8209927, 'recall': 0.82093024, 'specificity': 0.82093024, 'f1': 0.82092154, 'auroc': 0.88979983, 'binary_precision': 0.8165138, 'binary_recall': 0.82790697, 'binary_specificity': 0.81395346, 'binary_f1_score': 0.8221709}
confusion matrix:
     0    1
0  175   40
1   37  178
new oracle model saved
better model found
persisted
after epoch: 10,now: 2024-07-20 13:46:23.146096,epoch time: 0:01:25.087615,used: 0:14:20.243310,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_13_32_02_seed_0_22504809
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9296875, 'precision': 0.93308246, 'recall': 0.9302272, 'specificity': 0.9302272, 'f1': 0.9296005, 'auroc': 0.975842, 'binary_precision': 0.9744681, 'binary_recall': 0.8841699, 'binary_specificity': 0.97628456, 'binary_f1_score': 0.92712545}
confusion matrix:
      0     1
0  1482    36
1   180  1374
---- Validation: 
scalar performance:
{'acc': 0.78493786, 'precision': 0.78543925, 'recall': 0.7846029, 'specificity': 0.7846029, 'f1': 0.78467506, 'auroc': 0.8490794, 'binary_precision': 0.7944079, 'binary_recall': 0.7606299, 'binary_specificity': 0.8085758, 'binary_f1_score': 0.77715206}
confusion matrix:
     0    1
0  528  125
1  152  483
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8255814, 'precision': 0.8256448, 'recall': 0.82558143, 'specificity': 0.82558143, 'f1': 0.82557285, 'auroc': 0.89410496, 'binary_precision': 0.8301887, 'binary_recall': 0.81860465, 'binary_specificity': 0.83255816, 'binary_f1_score': 0.82435596}
confusion matrix:
     0    1
0  179   36
1   39  176
new oracle model saved
better model found
persisted
after epoch: 11,now: 2024-07-20 13:47:48.379045,epoch time: 0:01:25.232949,used: 0:15:45.476259,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_13_32_02_seed_0_22504809
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9342448, 'precision': 0.93790764, 'recall': 0.93490016, 'specificity': 0.93490016, 'f1': 0.93416345, 'auroc': 0.9789779, 'binary_precision': 0.98152095, 'binary_recall': 0.8869621, 'binary_specificity': 0.9828383, 'binary_f1_score': 0.9318489}
confusion matrix:
      0     1
0  1489    26
1   176  1381
---- Validation: 
scalar performance:
{'acc': 0.78571427, 'precision': 0.78643036, 'recall': 0.78532517, 'specificity': 0.78532517, 'f1': 0.78539085, 'auroc': 0.8520553, 'binary_precision': 0.7976783, 'binary_recall': 0.7574803, 'binary_specificity': 0.81316996, 'binary_f1_score': 0.7770598}
confusion matrix:
     0    1
0  531  122
1  154  481
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.83023256, 'precision': 0.8302397, 'recall': 0.83023256, 'specificity': 0.83023256, 'f1': 0.83023167, 'auroc': 0.8983451, 'binary_precision': 0.8317757, 'binary_recall': 0.82790697, 'binary_specificity': 0.83255816, 'binary_f1_score': 0.8298368}
confusion matrix:
     0    1
0  179   36
1   37  178
new oracle model saved
better model found
persisted
after epoch: 12,now: 2024-07-20 13:49:13.698247,epoch time: 0:01:25.319202,used: 0:17:10.795461,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_13_32_02_seed_0_22504809
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.93359375, 'precision': 0.936671, 'recall': 0.9341675, 'specificity': 0.9341675, 'f1': 0.93352616, 'auroc': 0.98226714, 'binary_precision': 0.9767278, 'binary_recall': 0.8901028, 'binary_specificity': 0.9782322, 'binary_f1_score': 0.93140554}
confusion matrix:
      0     1
0  1483    33
1   171  1385
---- Validation: 
scalar performance:
{'acc': 0.79736024, 'precision': 0.7979467, 'recall': 0.79765713, 'specificity': 0.79765713, 'f1': 0.79733956, 'auroc': 0.8529452, 'binary_precision': 0.7807808, 'binary_recall': 0.81889766, 'binary_specificity': 0.77641654, 'binary_f1_score': 0.7993851}
confusion matrix:
     0    1
0  507  146
1  115  520
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8255814, 'precision': 0.8261529, 'recall': 0.8255814, 'specificity': 0.8255814, 'f1': 0.82550496, 'auroc': 0.90167654, 'binary_precision': 0.8125, 'binary_recall': 0.8465116, 'binary_specificity': 0.80465114, 'binary_f1_score': 0.8291572}
confusion matrix:
     0    1
0  173   42
1   33  182
better model found
persisted
after epoch: 13,now: 2024-07-20 13:50:38.788364,epoch time: 0:01:25.090117,used: 0:18:35.885578,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_13_32_02_seed_0_22504809
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9322917, 'precision': 0.9354856, 'recall': 0.9329688, 'specificity': 0.9329688, 'f1': 0.93222547, 'auroc': 0.9823925, 'binary_precision': 0.97671133, 'binary_recall': 0.88774854, 'binary_specificity': 0.97818905, 'binary_f1_score': 0.93010753}
confusion matrix:
      0     1
0  1480    33
1   175  1384
---- Validation: 
scalar performance:
{'acc': 0.79891306, 'precision': 0.799046, 'recall': 0.79905826, 'specificity': 0.79905826, 'f1': 0.7989129, 'auroc': 0.85727656, 'binary_precision': 0.78834355, 'binary_recall': 0.80944884, 'binary_specificity': 0.7886677, 'binary_f1_score': 0.7987568}
confusion matrix:
     0    1
0  515  138
1  121  514
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.83255816, 'precision': 0.8326733, 'recall': 0.83255816, 'specificity': 0.83255816, 'f1': 0.8325436, 'auroc': 0.9022391, 'binary_precision': 0.826484, 'binary_recall': 0.8418605, 'binary_specificity': 0.82325584, 'binary_f1_score': 0.8341014}
confusion matrix:
     0    1
0  177   38
1   34  181
new oracle model saved
better model found
persisted
after epoch: 14,now: 2024-07-20 13:52:04.542388,epoch time: 0:01:25.754024,used: 0:20:01.639602,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_13_32_02_seed_0_22504809
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.93359375, 'precision': 0.9373021, 'recall': 0.93418765, 'specificity': 0.93418765, 'f1': 0.9335054, 'auroc': 0.9821063, 'binary_precision': 0.9807829, 'binary_recall': 0.8861736, 'binary_specificity': 0.9822017, 'binary_f1_score': 0.9310811}
confusion matrix:
      0     1
0  1490    27
1   177  1378
---- Validation: 
scalar performance:
{'acc': 0.78959626, 'precision': 0.78984034, 'recall': 0.78934896, 'specificity': 0.78934896, 'f1': 0.7894225, 'auroc': 0.8540039, 'binary_precision': 0.79545456, 'binary_recall': 0.77165353, 'binary_specificity': 0.8070444, 'binary_f1_score': 0.78337324}
confusion matrix:
     0    1
0  527  126
1  145  490
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8255814, 'precision': 0.8256448, 'recall': 0.82558143, 'specificity': 0.82558143, 'f1': 0.82557285, 'auroc': 0.9026284, 'binary_precision': 0.8301887, 'binary_recall': 0.81860465, 'binary_specificity': 0.83255816, 'binary_f1_score': 0.82435596}
confusion matrix:
     0    1
0  179   36
1   39  176
early stop counter: 1
val acc:0.7895962595939636, best validation acc: 0.7989130616188049, corresponding to test acc:                         0.8325581550598145 / 0.8325581550598145
after epoch: 15,now: 2024-07-20 13:53:29.394033,epoch time: 0:01:24.851645,used: 0:21:26.491247,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_13_32_02_seed_0_22504809
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9436849, 'precision': 0.9448751, 'recall': 0.94405264, 'specificity': 0.94405264, 'f1': 0.9436706, 'auroc': 0.9863131, 'binary_precision': 0.97137016, 'binary_recall': 0.91580975, 'binary_specificity': 0.9722955, 'binary_f1_score': 0.9427721}
confusion matrix:
      0     1
0  1474    42
1   131  1425
---- Validation: 
scalar performance:
{'acc': 0.79891306, 'precision': 0.799046, 'recall': 0.79905826, 'specificity': 0.79905826, 'f1': 0.7989129, 'auroc': 0.8565819, 'binary_precision': 0.78834355, 'binary_recall': 0.80944884, 'binary_specificity': 0.7886677, 'binary_f1_score': 0.7987568}
confusion matrix:
     0    1
0  515  138
1  121  514
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8255814, 'precision': 0.8261529, 'recall': 0.8255814, 'specificity': 0.8255814, 'f1': 0.82550496, 'auroc': 0.9062196, 'binary_precision': 0.8125, 'binary_recall': 0.8465116, 'binary_specificity': 0.80465114, 'binary_f1_score': 0.8291572}
confusion matrix:
     0    1
0  173   42
1   33  182
early stop counter: 2
val acc:0.7989130616188049, best validation acc: 0.7989130616188049, corresponding to test acc:                         0.8325581550598145 / 0.8325581550598145
after epoch: 16,now: 2024-07-20 13:54:53.696101,epoch time: 0:01:24.302068,used: 0:22:50.793315,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_13_32_02_seed_0_22504809
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9326172, 'precision': 0.934453, 'recall': 0.93306786, 'specificity': 0.93306786, 'f1': 0.9325831, 'auroc': 0.98301834, 'binary_precision': 0.9661368, 'binary_recall': 0.8984576, 'binary_specificity': 0.9676781, 'binary_f1_score': 0.9310689}
confusion matrix:
      0     1
0  1467    49
1   158  1398
---- Validation: 
scalar performance:
{'acc': 0.79658383, 'precision': 0.7966949, 'recall': 0.79671776, 'specificity': 0.79671776, 'f1': 0.79658335, 'auroc': 0.8597895, 'binary_precision': 0.78648233, 'binary_recall': 0.8062992, 'binary_specificity': 0.7871363, 'binary_f1_score': 0.7962675}
confusion matrix:
     0    1
0  514  139
1  123  512
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.83488375, 'precision': 0.8354716, 'recall': 0.8348837, 'specificity': 0.8348837, 'f1': 0.83481133, 'auroc': 0.9094429, 'binary_precision': 0.8214286, 'binary_recall': 0.855814, 'binary_specificity': 0.81395346, 'binary_f1_score': 0.8382688}
confusion matrix:
     0    1
0  175   40
1   31  184
new oracle model saved
early stop counter: 3
val acc:0.7965838313102722, best validation acc: 0.7989130616188049, corresponding to test acc:                         0.8325581550598145 / 0.8348837494850159
after epoch: 17,now: 2024-07-20 13:56:18.406501,epoch time: 0:01:24.710400,used: 0:24:15.503715,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_13_32_02_seed_0_22504809
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.93652344, 'precision': 0.94022524, 'recall': 0.9370832, 'specificity': 0.9370832, 'f1': 0.9364375, 'auroc': 0.985712, 'binary_precision': 0.9836299, 'binary_recall': 0.88931787, 'binary_specificity': 0.9848485, 'binary_f1_score': 0.9340994}
confusion matrix:
      0     1
0  1495    23
1   172  1382
---- Validation: 
scalar performance:
{'acc': 0.80279505, 'precision': 0.80286753, 'recall': 0.8029084, 'specificity': 0.8029084, 'f1': 0.8027931, 'auroc': 0.86017776, 'binary_precision': 0.7935285, 'binary_recall': 0.8110236, 'binary_specificity': 0.79479325, 'binary_f1_score': 0.80218065}
confusion matrix:
     0    1
0  519  134
1  120  515
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.83255816, 'precision': 0.83301926, 'recall': 0.83255816, 'specificity': 0.83255816, 'f1': 0.83250016, 'auroc': 0.91251487, 'binary_precision': 0.8206278, 'binary_recall': 0.8511628, 'binary_specificity': 0.81395346, 'binary_f1_score': 0.83561647}
confusion matrix:
     0    1
0  175   40
1   32  183
better model found
persisted
after epoch: 18,now: 2024-07-20 13:57:42.900722,epoch time: 0:01:24.494221,used: 0:25:39.997936,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_13_32_02_seed_0_22504809
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.94466144, 'precision': 0.946773, 'recall': 0.945191, 'specificity': 0.945191, 'f1': 0.9446311, 'auroc': 0.9869909, 'binary_precision': 0.98127604, 'binary_recall': 0.90821564, 'binary_specificity': 0.98216647, 'binary_f1_score': 0.9433333}
confusion matrix:
      0     1
0  1487    27
1   143  1415
---- Validation: 
scalar performance:
{'acc': 0.78959626, 'precision': 0.78965867, 'recall': 0.78943574, 'specificity': 0.78943574, 'f1': 0.7894895, 'auroc': 0.85785776, 'binary_precision': 0.7916667, 'binary_recall': 0.77795273, 'binary_specificity': 0.8009188, 'binary_f1_score': 0.78474975}
confusion matrix:
     0    1
0  523  130
1  141  494
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.83255816, 'precision': 0.8325869, 'recall': 0.83255816, 'specificity': 0.83255816, 'f1': 0.8325545, 'auroc': 0.912212, 'binary_precision': 0.8294931, 'binary_recall': 0.8372093, 'binary_specificity': 0.82790697, 'binary_f1_score': 0.8333333}
confusion matrix:
     0    1
0  178   37
1   35  180
early stop counter: 1
val acc:0.7895962595939636, best validation acc: 0.8027950525283813, corresponding to test acc:                         0.8325581550598145 / 0.8348837494850159
after epoch: 19,now: 2024-07-20 13:59:07.396337,epoch time: 0:01:24.495615,used: 0:27:04.493551,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_13_32_02_seed_0_22504809
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.94433594, 'precision': 0.94524294, 'recall': 0.9446614, 'specificity': 0.9446614, 'f1': 0.944327, 'auroc': 0.9870105, 'binary_precision': 0.9688558, 'binary_recall': 0.9196658, 'binary_specificity': 0.969657, 'binary_f1_score': 0.9436202}
confusion matrix:
      0     1
0  1470    46
1   125  1431
---- Validation: 
scalar performance:
{'acc': 0.80201864, 'precision': 0.8026105, 'recall': 0.8023164, 'specificity': 0.8023164, 'f1': 0.8019985, 'auroc': 0.861181, 'binary_precision': 0.7852853, 'binary_recall': 0.82362205, 'binary_specificity': 0.78101075, 'binary_f1_score': 0.8039969}
confusion matrix:
     0    1
0  510  143
1  112  523
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.83023256, 'precision': 0.8308122, 'recall': 0.83023256, 'specificity': 0.83023256, 'f1': 0.8301581, 'auroc': 0.9126879, 'binary_precision': 0.81696427, 'binary_recall': 0.8511628, 'binary_specificity': 0.80930233, 'binary_f1_score': 0.833713}
confusion matrix:
     0    1
0  174   41
1   32  183
early stop counter: 2
val acc:0.8020186424255371, best validation acc: 0.8027950525283813, corresponding to test acc:                         0.8325581550598145 / 0.8348837494850159
after epoch: 20,now: 2024-07-20 14:00:31.807523,epoch time: 0:01:24.411186,used: 0:28:28.904737,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_13_32_02_seed_0_22504809
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9498698, 'precision': 0.9509087, 'recall': 0.95023435, 'specificity': 0.95023435, 'f1': 0.94986045, 'auroc': 0.98820955, 'binary_precision': 0.97623897, 'binary_recall': 0.923571, 'binary_specificity': 0.9768977, 'binary_f1_score': 0.94917494}
confusion matrix:
      0     1
0  1480    35
1   119  1438
---- Validation: 
scalar performance:
{'acc': 0.8004658, 'precision': 0.8008251, 'recall': 0.80069816, 'specificity': 0.80069816, 'f1': 0.80046, 'auroc': 0.8649335, 'binary_precision': 0.78636366, 'binary_recall': 0.81732285, 'binary_specificity': 0.78407353, 'binary_f1_score': 0.8015444}
confusion matrix:
     0    1
0  512  141
1  116  519
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.82790697, 'precision': 0.82836163, 'recall': 0.82790697, 'specificity': 0.82790697, 'f1': 0.82784736, 'auroc': 0.91340184, 'binary_precision': 0.8161435, 'binary_recall': 0.8465116, 'binary_specificity': 0.80930233, 'binary_f1_score': 0.8310502}
confusion matrix:
     0    1
0  174   41
1   33  182
early stop counter: 3
val acc:0.8004658222198486, best validation acc: 0.8027950525283813, corresponding to test acc:                         0.8325581550598145 / 0.8348837494850159
after epoch: 21,now: 2024-07-20 14:01:56.895030,epoch time: 0:01:25.087507,used: 0:29:53.992244,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_13_32_02_seed_0_22504809
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9485677, 'precision': 0.94956297, 'recall': 0.9489066, 'specificity': 0.9489066, 'f1': 0.9485581, 'auroc': 0.9873737, 'binary_precision': 0.9742198, 'binary_recall': 0.92287916, 'binary_specificity': 0.97493404, 'binary_f1_score': 0.9478547}
confusion matrix:
      0     1
0  1478    38
1   120  1436
---- Validation: 
scalar performance:
{'acc': 0.80124223, 'precision': 0.8012321, 'recall': 0.8012902, 'specificity': 0.8012902, 'f1': 0.8012303, 'auroc': 0.8658283, 'binary_precision': 0.7947123, 'binary_recall': 0.8047244, 'binary_specificity': 0.79785603, 'binary_f1_score': 0.799687}
confusion matrix:
     0    1
0  521  132
1  124  511
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.83255816, 'precision': 0.8328173, 'recall': 0.83255816, 'specificity': 0.83255816, 'f1': 0.8325255, 'auroc': 0.914397, 'binary_precision': 0.8235294, 'binary_recall': 0.8465116, 'binary_specificity': 0.81860465, 'binary_f1_score': 0.83486235}
confusion matrix:
     0    1
0  176   39
1   33  182
early stop counter: 4
val acc:0.8012422323226929, best validation acc: 0.8027950525283813, corresponding to test acc:                         0.8325581550598145 / 0.8348837494850159
after epoch: 22,now: 2024-07-20 14:03:21.431017,epoch time: 0:01:24.535987,used: 0:31:18.528231,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_13_32_02_seed_0_22504809
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.9534505, 'precision': 0.9548529, 'recall': 0.9538454, 'specificity': 0.9538454, 'f1': 0.95343566, 'auroc': 0.9913273, 'binary_precision': 0.9835729, 'binary_recall': 0.9235219, 'binary_specificity': 0.9841689, 'binary_f1_score': 0.95260197}
confusion matrix:
      0     1
0  1492    24
1   119  1437
---- Validation: 
scalar performance:
{'acc': 0.7958075, 'precision': 0.7960633, 'recall': 0.7955613, 'specificity': 0.7955613, 'f1': 0.79563886, 'auroc': 0.8643571, 'binary_precision': 0.8019481, 'binary_recall': 0.77795273, 'binary_specificity': 0.81316996, 'binary_f1_score': 0.7897682}
confusion matrix:
     0    1
0  531  122
1  141  494
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8465116, 'precision': 0.84654164, 'recall': 0.8465116, 'specificity': 0.8465116, 'f1': 0.8465083, 'auroc': 0.91599786, 'binary_precision': 0.843318, 'binary_recall': 0.8511628, 'binary_specificity': 0.8418605, 'binary_f1_score': 0.84722227}
confusion matrix:
     0    1
0  181   34
1   32  183
new oracle model saved
early stop counter: 5
val acc:0.7958074808120728, best validation acc: 0.8027950525283813, corresponding to test acc:                         0.8325581550598145 / 0.8465116024017334
after epoch: 23,now: 2024-07-20 14:04:45.819346,epoch time: 0:01:24.388329,used: 0:32:42.916560,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_13_32_02_seed_0_22504809
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 23 with time: 0:32:42.916560 at 2024-07-20 14:04:45.819346
persisted model performance metric: 

scalar performance:
{'acc': 0.83255816, 'precision': 0.83301926, 'recall': 0.83255816, 'specificity': 0.83255816, 'f1': 0.83250016, 'auroc': 0.91251487, 'binary_precision': 0.8206278, 'binary_recall': 0.8511628, 'binary_specificity': 0.81395346, 'binary_f1_score': 0.83561647}
confusion matrix:
     0    1
0  175   40
1   32  183
oracle model performance metric: 

scalar performance:
{'acc': 0.8465116, 'precision': 0.84654164, 'recall': 0.8465116, 'specificity': 0.8465116, 'f1': 0.8465083, 'auroc': 0.91599786, 'binary_precision': 0.843318, 'binary_recall': 0.8511628, 'binary_specificity': 0.8418605, 'binary_f1_score': 0.84722227}
confusion matrix:
     0    1
0  181   34
1   32  183
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_halffreezeblocks_2024-07-20_12-47-21/rule_results/0.csv
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_halffreezeblocks_2024-07-20_12-47-21/rule_results/0.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_halffreezeblocks_2024-07-20_12-47-21/confusion_matrix/0.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 196513 KiB |   1194 MiB |  42143 GiB |  42143 GiB |
|       from large pool | 180117 KiB |   1178 MiB |  41560 GiB |  41559 GiB |
|       from small pool |  16396 KiB |     32 MiB |    583 GiB |    583 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 196513 KiB |   1194 MiB |  42143 GiB |  42143 GiB |
|       from large pool | 180117 KiB |   1178 MiB |  41560 GiB |  41559 GiB |
|       from small pool |  16396 KiB |     32 MiB |    583 GiB |    583 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 195188 KiB |   1193 MiB |  42140 GiB |  42140 GiB |
|       from large pool | 178979 KiB |   1176 MiB |  41557 GiB |  41557 GiB |
|       from small pool |  16209 KiB |     32 MiB |    582 GiB |    582 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1348 MiB |   1348 MiB |   1348 MiB |      0 B   |
|       from large pool |   1310 MiB |   1310 MiB |   1310 MiB |      0 B   |
|       from small pool |     38 MiB |     38 MiB |     38 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |  47199 KiB | 147638 KiB |  23425 GiB |  23425 GiB |
|       from large pool |  45163 KiB | 146066 KiB |  22822 GiB |  22822 GiB |
|       from small pool |   2036 KiB |   7624 KiB |    603 GiB |    603 GiB |
|---------------------------------------------------------------------------|
| Allocations           |     788    |    1159    |    7360 K  |    7359 K  |
|       from large pool |      79    |     167    |    3893 K  |    3893 K  |
|       from small pool |     709    |    1005    |    3466 K  |    3465 K  |
|---------------------------------------------------------------------------|
| Active allocs         |     788    |    1159    |    7360 K  |    7359 K  |
|       from large pool |      79    |     167    |    3893 K  |    3893 K  |
|       from small pool |     709    |    1005    |    3466 K  |    3465 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      74    |      74    |      74    |       0    |
|       from large pool |      55    |      55    |      55    |       0    |
|       from small pool |      19    |      19    |      19    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      33    |     219    |    5042 K  |    5042 K  |
|       from large pool |      11    |      57    |    2959 K  |    2959 K  |
|       from small pool |      22    |     208    |    2082 K  |    2082 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   1194 MiB |  42143 GiB |  42143 GiB |
|       from large pool |  16640 KiB |   1178 MiB |  41560 GiB |  41560 GiB |
|       from small pool |      0 KiB |     32 MiB |    583 GiB |    583 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   1194 MiB |  42143 GiB |  42143 GiB |
|       from large pool |  16640 KiB |   1178 MiB |  41560 GiB |  41560 GiB |
|       from small pool |      0 KiB |     32 MiB |    583 GiB |    583 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   1193 MiB |  42140 GiB |  42140 GiB |
|       from large pool |  16640 KiB |   1176 MiB |  41557 GiB |  41557 GiB |
|       from small pool |      0 KiB |     32 MiB |    582 GiB |    582 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 243712 KiB |   1348 MiB |   1348 MiB |   1110 MiB |
|       from large pool | 225280 KiB |   1310 MiB |   1310 MiB |   1090 MiB |
|       from small pool |  18432 KiB |     38 MiB |     38 MiB |     20 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 147638 KiB |  23425 GiB |  23425 GiB |
|       from large pool |  24320 KiB | 146066 KiB |  22822 GiB |  22822 GiB |
|       from small pool |      0 KiB |   9146 KiB |    603 GiB |    603 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    1159    |    7360 K  |    7359 K  |
|       from large pool |       2    |     167    |    3893 K  |    3893 K  |
|       from small pool |       0    |    1005    |    3466 K  |    3466 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    1159    |    7360 K  |    7359 K  |
|       from large pool |       2    |     167    |    3893 K  |    3893 K  |
|       from small pool |       0    |    1005    |    3466 K  |    3466 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      20    |      74    |      74    |      54    |
|       from large pool |      11    |      55    |      55    |      44    |
|       from small pool |       9    |      19    |      19    |      10    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |     219    |    5042 K  |    5042 K  |
|       from large pool |       4    |      57    |    2959 K  |    2959 K  |
|       from small pool |       0    |     208    |    2082 K  |    2082 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   1194 MiB |  42143 GiB |  42143 GiB |
|       from large pool |  16640 KiB |   1178 MiB |  41560 GiB |  41560 GiB |
|       from small pool |      0 KiB |     32 MiB |    583 GiB |    583 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   1194 MiB |  42143 GiB |  42143 GiB |
|       from large pool |  16640 KiB |   1178 MiB |  41560 GiB |  41560 GiB |
|       from small pool |      0 KiB |     32 MiB |    583 GiB |    583 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   1193 MiB |  42140 GiB |  42140 GiB |
|       from large pool |  16640 KiB |   1176 MiB |  41557 GiB |  41557 GiB |
|       from small pool |      0 KiB |     32 MiB |    582 GiB |    582 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 243712 KiB |   1348 MiB |   1348 MiB |   1110 MiB |
|       from large pool | 225280 KiB |   1310 MiB |   1310 MiB |   1090 MiB |
|       from small pool |  18432 KiB |     38 MiB |     38 MiB |     20 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 147638 KiB |  23425 GiB |  23425 GiB |
|       from large pool |  24320 KiB | 146066 KiB |  22822 GiB |  22822 GiB |
|       from small pool |      0 KiB |   9146 KiB |    603 GiB |    603 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    1159    |    7360 K  |    7359 K  |
|       from large pool |       2    |     167    |    3893 K  |    3893 K  |
|       from small pool |       0    |    1005    |    3466 K  |    3466 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    1159    |    7360 K  |    7359 K  |
|       from large pool |       2    |     167    |    3893 K  |    3893 K  |
|       from small pool |       0    |    1005    |    3466 K  |    3466 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      20    |      74    |      74    |      54    |
|       from large pool |      11    |      55    |      55    |      44    |
|       from small pool |       9    |      19    |      19    |      10    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |     219    |    5042 K  |    5042 K  |
|       from large pool |       4    |      57    |    2959 K  |    2959 K  |
|       from small pool |       0    |     208    |    2082 K  |    2082 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'888c1ef2'
model name: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_14_06_03_seed_1_22504809

 Experiment start at: 2024-07-20 14:06:03.924973
before training, model accuracy: 0.6177777647972107
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.74316406, 'precision': 0.7431346, 'recall': 0.7431555, 'specificity': 0.7431555, 'f1': 0.7431412, 'auroc': 0.807467, 'binary_precision': 0.74725276, 'binary_recall': 0.74388677, 'binary_specificity': 0.74242425, 'binary_f1_score': 0.74556595}
confusion matrix:
      0     1
0  1127   391
1   398  1156
---- Validation: 
scalar performance:
{'acc': 0.49258393, 'precision': 0.4668877, 'recall': 0.48630312, 'specificity': 0.48630312, 'f1': 0.40095398, 'auroc': 0.67286956, 'binary_precision': 0.43333334, 'binary_recall': 0.103174604, 'binary_specificity': 0.8694316, 'binary_f1_score': 0.16666667}
confusion matrix:
     0   1
0  566  85
1  565  65
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.52444446, 'precision': 0.556962, 'recall': 0.52444446, 'specificity': 0.52444446, 'f1': 0.4452765, 'auroc': 0.718716, 'binary_precision': 0.6, 'binary_recall': 0.14666666, 'binary_specificity': 0.9022222, 'binary_f1_score': 0.23571429}
confusion matrix:
     0   1
0  203  22
1  192  33
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-20 14:07:32.630857,epoch time: 0:01:28.705884,used: 0:01:28.705884,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_14_06_03_seed_1_22504809
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.82389325, 'precision': 0.82386625, 'recall': 0.82391, 'specificity': 0.82391, 'f1': 0.8238776, 'auroc': 0.9005013, 'binary_precision': 0.828479, 'binary_recall': 0.8226221, 'binary_specificity': 0.8251979, 'binary_f1_score': 0.8255402}
confusion matrix:
      0     1
0  1251   265
1   276  1280
---- Validation: 
scalar performance:
{'acc': 0.53629977, 'precision': 0.559052, 'recall': 0.53061956, 'specificity': 0.53061956, 'f1': 0.4693529, 'auroc': 0.7340087, 'binary_precision': 0.59183675, 'binary_recall': 0.18412699, 'binary_specificity': 0.87711215, 'binary_f1_score': 0.2808717}
confusion matrix:
     0    1
0  571   80
1  514  116
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5555556, 'precision': 0.61238766, 'recall': 0.5555556, 'specificity': 0.5555556, 'f1': 0.491238, 'auroc': 0.7736691, 'binary_precision': 0.6923077, 'binary_recall': 0.2, 'binary_specificity': 0.9111111, 'binary_f1_score': 0.31034485}
confusion matrix:
     0   1
0  205  20
1  180  45
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-07-20 14:08:57.776049,epoch time: 0:01:25.145192,used: 0:02:53.851076,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_14_06_03_seed_1_22504809
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.8642578, 'precision': 0.86511236, 'recall': 0.8645482, 'specificity': 0.8645482, 'f1': 0.86422867, 'auroc': 0.929819, 'binary_precision': 0.88594705, 'binary_recall': 0.83976835, 'binary_specificity': 0.88932806, 'binary_f1_score': 0.86223984}
confusion matrix:
      0     1
0  1350   168
1   249  1305
---- Validation: 
scalar performance:
{'acc': 0.5425449, 'precision': 0.57337797, 'recall': 0.53676397, 'specificity': 0.53676397, 'f1': 0.4738047, 'auroc': 0.76005054, 'binary_precision': 0.61702126, 'binary_recall': 0.18412699, 'binary_specificity': 0.8894009, 'binary_f1_score': 0.2836186}
confusion matrix:
     0    1
0  579   72
1  514  116
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5644444, 'precision': 0.6414236, 'recall': 0.5644444, 'specificity': 0.5644444, 'f1': 0.49583867, 'auroc': 0.80507654, 'binary_precision': 0.7457627, 'binary_recall': 0.19555555, 'binary_specificity': 0.93333334, 'binary_f1_score': 0.30985916}
confusion matrix:
     0   1
0  210  15
1  181  44
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-07-20 14:10:22.535263,epoch time: 0:01:24.759214,used: 0:04:18.610290,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_14_06_03_seed_1_22504809
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.88639325, 'precision': 0.8901986, 'recall': 0.8870162, 'specificity': 0.8870162, 'f1': 0.88621664, 'auroc': 0.9461558, 'binary_precision': 0.9319484, 'binary_recall': 0.836656, 'binary_specificity': 0.9373764, 'binary_f1_score': 0.88173497}
confusion matrix:
      0     1
0  1422    95
1   254  1301
---- Validation: 
scalar performance:
{'acc': 0.55347383, 'precision': 0.59291154, 'recall': 0.54777265, 'specificity': 0.54777265, 'f1': 0.4883557, 'auroc': 0.77738523, 'binary_precision': 0.6494845, 'binary_recall': 0.2, 'binary_specificity': 0.8955453, 'binary_f1_score': 0.30582526}
confusion matrix:
     0    1
0  583   68
1  504  126
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5711111, 'precision': 0.6385895, 'recall': 0.57111114, 'specificity': 0.57111114, 'f1': 0.5116699, 'auroc': 0.8230716, 'binary_precision': 0.7352941, 'binary_recall': 0.22222222, 'binary_specificity': 0.92, 'binary_f1_score': 0.34129694}
confusion matrix:
     0   1
0  207  18
1  175  50
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-07-20 14:11:48.431575,epoch time: 0:01:25.896312,used: 0:05:44.506602,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_14_06_03_seed_1_22504809
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.8955078, 'precision': 0.8988886, 'recall': 0.8960919, 'specificity': 0.8960919, 'f1': 0.8953712, 'auroc': 0.95193803, 'binary_precision': 0.9388336, 'binary_recall': 0.84887457, 'binary_specificity': 0.9433092, 'binary_f1_score': 0.89159065}
confusion matrix:
      0     1
0  1431    86
1   235  1320
---- Validation: 
scalar performance:
{'acc': 0.6034348, 'precision': 0.6575918, 'recall': 0.59843826, 'specificity': 0.59843826, 'f1': 0.55987483, 'auroc': 0.79251695, 'binary_precision': 0.74596775, 'binary_recall': 0.2936508, 'binary_specificity': 0.9032258, 'binary_f1_score': 0.42141235}
confusion matrix:
     0    1
0  588   63
1  445  185
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6, 'precision': 0.67272854, 'recall': 0.6, 'specificity': 0.6, 'f1': 0.55294067, 'auroc': 0.8368592, 'binary_precision': 0.7848101, 'binary_recall': 0.27555555, 'binary_specificity': 0.92444444, 'binary_f1_score': 0.40789476}
confusion matrix:
     0   1
0  208  17
1  163  62
new oracle model saved
better model found
persisted
after epoch: 5,now: 2024-07-20 14:13:13.360068,epoch time: 0:01:24.928493,used: 0:07:09.435095,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_14_06_03_seed_1_22504809
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.90625, 'precision': 0.90985847, 'recall': 0.90684783, 'specificity': 0.90684783, 'f1': 0.9061208, 'auroc': 0.95855975, 'binary_precision': 0.9515324, 'binary_recall': 0.8585209, 'binary_specificity': 0.9551747, 'binary_f1_score': 0.90263695}
confusion matrix:
      0     1
0  1449    68
1   220  1335
---- Validation: 
scalar performance:
{'acc': 0.6346604, 'precision': 0.679276, 'recall': 0.6304147, 'specificity': 0.6304147, 'f1': 0.6060885, 'auroc': 0.80364025, 'binary_precision': 0.7647059, 'binary_recall': 0.37142858, 'binary_specificity': 0.8894009, 'binary_f1_score': 0.5}
confusion matrix:
     0    1
0  579   72
1  396  234
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6622222, 'precision': 0.7182492, 'recall': 0.6622222, 'specificity': 0.6622222, 'f1': 0.63905776, 'auroc': 0.8506074, 'binary_precision': 0.8288288, 'binary_recall': 0.40888888, 'binary_specificity': 0.91555554, 'binary_f1_score': 0.54761904}
confusion matrix:
     0   1
0  206  19
1  133  92
new oracle model saved
better model found
persisted
after epoch: 6,now: 2024-07-20 14:14:38.347518,epoch time: 0:01:24.987450,used: 0:08:34.422545,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_14_06_03_seed_1_22504809
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.91276044, 'precision': 0.9165555, 'recall': 0.91347003, 'specificity': 0.91347003, 'f1': 0.91264427, 'auroc': 0.9618325, 'binary_precision': 0.9600571, 'binary_recall': 0.86392814, 'binary_specificity': 0.96301186, 'binary_f1_score': 0.9094595}
confusion matrix:
      0     1
0  1458    56
1   212  1346
---- Validation: 
scalar performance:
{'acc': 0.6432475, 'precision': 0.69317746, 'recall': 0.6389401, 'specificity': 0.6389401, 'f1': 0.6144669, 'auroc': 0.81383955, 'binary_precision': 0.7873754, 'binary_recall': 0.37619048, 'binary_specificity': 0.9016897, 'binary_f1_score': 0.50913}
confusion matrix:
     0    1
0  587   64
1  393  237
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.68, 'precision': 0.7365347, 'recall': 0.68, 'specificity': 0.68, 'f1': 0.65966386, 'auroc': 0.85973334, 'binary_precision': 0.8521739, 'binary_recall': 0.43555555, 'binary_specificity': 0.92444444, 'binary_f1_score': 0.5764706}
confusion matrix:
     0   1
0  208  17
1  127  98
new oracle model saved
better model found
persisted
after epoch: 7,now: 2024-07-20 14:16:03.402909,epoch time: 0:01:25.055391,used: 0:09:59.477936,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_14_06_03_seed_1_22504809
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.90494794, 'precision': 0.91180456, 'recall': 0.90576303, 'specificity': 0.90576303, 'f1': 0.9046628, 'auroc': 0.96381974, 'binary_precision': 0.9681245, 'binary_recall': 0.8398714, 'binary_specificity': 0.9716546, 'binary_f1_score': 0.89944905}
confusion matrix:
      0     1
0  1474    43
1   249  1306
---- Validation: 
scalar performance:
{'acc': 0.6440281, 'precision': 0.69469416, 'recall': 0.63970816, 'specificity': 0.63970816, 'f1': 0.6151328, 'auroc': 0.82242215, 'binary_precision': 0.79, 'binary_recall': 0.37619048, 'binary_specificity': 0.9032258, 'binary_f1_score': 0.5096774}
confusion matrix:
     0    1
0  588   63
1  393  237
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.69555557, 'precision': 0.75, 'recall': 0.69555557, 'specificity': 0.69555557, 'f1': 0.67802584, 'auroc': 0.8699852, 'binary_precision': 0.8666667, 'binary_recall': 0.46222222, 'binary_specificity': 0.9288889, 'binary_f1_score': 0.60289854}
confusion matrix:
     0    1
0  209   16
1  121  104
new oracle model saved
better model found
persisted
after epoch: 8,now: 2024-07-20 14:17:28.697880,epoch time: 0:01:25.294971,used: 0:11:24.772907,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_14_06_03_seed_1_22504809
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.91276044, 'precision': 0.9178244, 'recall': 0.9135364, 'specificity': 0.9135364, 'f1': 0.91258913, 'auroc': 0.9670768, 'binary_precision': 0.96736765, 'binary_recall': 0.8567759, 'binary_specificity': 0.97029704, 'binary_f1_score': 0.90871936}
confusion matrix:
      0     1
0  1470    45
1   223  1334
---- Validation: 
scalar performance:
{'acc': 0.7135051, 'precision': 0.7472577, 'recall': 0.71039426, 'specificity': 0.71039426, 'f1': 0.7013923, 'auroc': 0.8356497, 'binary_precision': 0.8346056, 'binary_recall': 0.52063495, 'binary_specificity': 0.90015364, 'binary_f1_score': 0.6412512}
confusion matrix:
     0    1
0  586   65
1  302  328
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.75555557, 'precision': 0.78294146, 'recall': 0.75555557, 'specificity': 0.75555557, 'f1': 0.7494939, 'auroc': 0.88223207, 'binary_precision': 0.87096775, 'binary_recall': 0.6, 'binary_specificity': 0.9111111, 'binary_f1_score': 0.71052635}
confusion matrix:
     0    1
0  205   20
1   90  135
new oracle model saved
better model found
persisted
after epoch: 9,now: 2024-07-20 14:18:53.740133,epoch time: 0:01:25.042253,used: 0:12:49.815160,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_14_06_03_seed_1_22504809
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9270833, 'precision': 0.92889917, 'recall': 0.92748535, 'specificity': 0.92748535, 'f1': 0.92704326, 'auroc': 0.9745749, 'binary_precision': 0.95988935, 'binary_recall': 0.8931789, 'binary_specificity': 0.9617918, 'binary_f1_score': 0.9253333}
confusion matrix:
      0     1
0  1460    58
1   166  1388
---- Validation: 
scalar performance:
{'acc': 0.7330211, 'precision': 0.7576561, 'recall': 0.73041475, 'specificity': 0.73041475, 'f1': 0.7249831, 'auroc': 0.84164536, 'binary_precision': 0.8333333, 'binary_recall': 0.5714286, 'binary_specificity': 0.8894009, 'binary_f1_score': 0.6779661}
confusion matrix:
     0    1
0  579   72
1  270  360
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.77111113, 'precision': 0.792619, 'recall': 0.77111113, 'specificity': 0.77111113, 'f1': 0.7668265, 'auroc': 0.887921, 'binary_precision': 0.8719512, 'binary_recall': 0.63555557, 'binary_specificity': 0.9066667, 'binary_f1_score': 0.7352185}
confusion matrix:
     0    1
0  204   21
1   82  143
new oracle model saved
better model found
persisted
after epoch: 10,now: 2024-07-20 14:20:18.920515,epoch time: 0:01:25.180382,used: 0:14:14.995542,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_14_06_03_seed_1_22504809
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9189453, 'precision': 0.9241082, 'recall': 0.91976345, 'specificity': 0.91976345, 'f1': 0.91878843, 'auroc': 0.9751247, 'binary_precision': 0.97461927, 'binary_recall': 0.86264443, 'binary_specificity': 0.97688246, 'binary_f1_score': 0.9152196}
confusion matrix:
      0     1
0  1479    35
1   214  1344
---- Validation: 
scalar performance:
{'acc': 0.73224044, 'precision': 0.7581967, 'recall': 0.7295699, 'specificity': 0.7295699, 'f1': 0.7237948, 'auroc': 0.8457075, 'binary_precision': 0.8360656, 'binary_recall': 0.56666666, 'binary_specificity': 0.8924731, 'binary_f1_score': 0.6754967}
confusion matrix:
     0    1
0  581   70
1  273  357
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.77555555, 'precision': 0.797416, 'recall': 0.77555555, 'specificity': 0.77555555, 'f1': 0.7713541, 'auroc': 0.8927012, 'binary_precision': 0.8780488, 'binary_recall': 0.64, 'binary_specificity': 0.9111111, 'binary_f1_score': 0.7403599}
confusion matrix:
     0    1
0  205   20
1   81  144
new oracle model saved
early stop counter: 1
val acc:0.7322404384613037, best validation acc: 0.733021080493927, corresponding to test acc:                         0.7711111307144165 / 0.7755555510520935
after epoch: 11,now: 2024-07-20 14:21:43.672899,epoch time: 0:01:24.752384,used: 0:15:39.747926,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_14_06_03_seed_1_22504809
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.93326825, 'precision': 0.9355391, 'recall': 0.9338188, 'specificity': 0.9338188, 'f1': 0.9332263, 'auroc': 0.97786725, 'binary_precision': 0.97077245, 'binary_recall': 0.8953787, 'binary_specificity': 0.9722589, 'binary_f1_score': 0.93155265}
confusion matrix:
      0     1
0  1472    42
1   163  1395
---- Validation: 
scalar performance:
{'acc': 0.7517564, 'precision': 0.77047956, 'recall': 0.74953914, 'specificity': 0.74953914, 'f1': 0.7462324, 'auroc': 0.8514252, 'binary_precision': 0.83766234, 'binary_recall': 0.6142857, 'binary_specificity': 0.8847926, 'binary_f1_score': 0.7087912}
confusion matrix:
     0    1
0  576   75
1  243  387
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.80444443, 'precision': 0.8165499, 'recall': 0.80444443, 'specificity': 0.80444443, 'f1': 0.80255675, 'auroc': 0.8987259, 'binary_precision': 0.878453, 'binary_recall': 0.70666665, 'binary_specificity': 0.9022222, 'binary_f1_score': 0.78325117}
confusion matrix:
     0    1
0  203   22
1   66  159
new oracle model saved
better model found
persisted
after epoch: 12,now: 2024-07-20 14:23:09.234540,epoch time: 0:01:25.561641,used: 0:17:05.309567,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_14_06_03_seed_1_22504809
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.93391925, 'precision': 0.93638265, 'recall': 0.9344633, 'specificity': 0.9344633, 'f1': 0.93387103, 'auroc': 0.9793786, 'binary_precision': 0.9727654, 'binary_recall': 0.89466923, 'binary_specificity': 0.9742574, 'binary_f1_score': 0.9320843}
confusion matrix:
      0     1
0  1476    39
1   164  1393
---- Validation: 
scalar performance:
{'acc': 0.7626854, 'precision': 0.77898246, 'recall': 0.7606503, 'specificity': 0.7606503, 'f1': 0.75817215, 'auroc': 0.85671794, 'binary_precision': 0.84243697, 'binary_recall': 0.6365079, 'binary_specificity': 0.8847926, 'binary_f1_score': 0.7251356}
confusion matrix:
     0    1
0  576   75
1  229  401
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.81333333, 'precision': 0.82253313, 'recall': 0.81333333, 'specificity': 0.81333333, 'f1': 0.81199265, 'auroc': 0.90376294, 'binary_precision': 0.87700534, 'binary_recall': 0.72888887, 'binary_specificity': 0.8977778, 'binary_f1_score': 0.7961165}
confusion matrix:
     0    1
0  202   23
1   61  164
new oracle model saved
better model found
persisted
after epoch: 13,now: 2024-07-20 14:24:33.857098,epoch time: 0:01:24.622558,used: 0:18:29.932125,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_14_06_03_seed_1_22504809
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.93652344, 'precision': 0.9387236, 'recall': 0.9369611, 'specificity': 0.9369611, 'f1': 0.9364793, 'auroc': 0.98099303, 'binary_precision': 0.9728601, 'binary_recall': 0.8996139, 'binary_specificity': 0.9743083, 'binary_f1_score': 0.93480444}
confusion matrix:
      0     1
0  1479    39
1   156  1398
---- Validation: 
scalar performance:
{'acc': 0.76502734, 'precision': 0.784614, 'recall': 0.76282644, 'specificity': 0.76282644, 'f1': 0.7598549, 'auroc': 0.859486, 'binary_precision': 0.8552916, 'binary_recall': 0.62857145, 'binary_specificity': 0.89708143, 'binary_f1_score': 0.72461116}
confusion matrix:
     0    1
0  584   67
1  234  396
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.82, 'precision': 0.83213055, 'recall': 0.82, 'specificity': 0.82, 'f1': 0.8183414, 'auroc': 0.9063111, 'binary_precision': 0.8956044, 'binary_recall': 0.72444445, 'binary_specificity': 0.91555554, 'binary_f1_score': 0.80098283}
confusion matrix:
     0    1
0  206   19
1   62  163
new oracle model saved
better model found
persisted
after epoch: 14,now: 2024-07-20 14:25:59.271823,epoch time: 0:01:25.414725,used: 0:19:55.346850,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_14_06_03_seed_1_22504809
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.93847656, 'precision': 0.9412987, 'recall': 0.9390842, 'specificity': 0.9390842, 'f1': 0.9384249, 'auroc': 0.98489237, 'binary_precision': 0.98035085, 'binary_recall': 0.8966624, 'binary_specificity': 0.98150593, 'binary_f1_score': 0.936641}
confusion matrix:
      0     1
0  1486    28
1   161  1397
---- Validation: 
scalar performance:
{'acc': 0.7572209, 'precision': 0.7787056, 'recall': 0.75488997, 'specificity': 0.75488997, 'f1': 0.75127876, 'auroc': 0.85911787, 'binary_precision': 0.85209715, 'binary_recall': 0.61269844, 'binary_specificity': 0.89708143, 'binary_f1_score': 0.7128347}
confusion matrix:
     0    1
0  584   67
1  244  386
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.81777775, 'precision': 0.8329298, 'recall': 0.81777775, 'specificity': 0.81777775, 'f1': 0.8156806, 'auroc': 0.90700245, 'binary_precision': 0.9039548, 'binary_recall': 0.7111111, 'binary_specificity': 0.92444444, 'binary_f1_score': 0.7960199}
confusion matrix:
     0    1
0  208   17
1   65  160
early stop counter: 1
val acc:0.7572209239006042, best validation acc: 0.7650273442268372, corresponding to test acc:                         0.8199999928474426 / 0.8199999928474426
after epoch: 15,now: 2024-07-20 14:27:24.457091,epoch time: 0:01:25.185268,used: 0:21:20.532118,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_14_06_03_seed_1_22504809
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9352214, 'precision': 0.93688345, 'recall': 0.9356054, 'specificity': 0.9356054, 'f1': 0.93519056, 'auroc': 0.9834212, 'binary_precision': 0.96691936, 'binary_recall': 0.9028314, 'binary_specificity': 0.96837944, 'binary_f1_score': 0.93377703}
confusion matrix:
      0     1
0  1470    48
1   151  1403
---- Validation: 
scalar performance:
{'acc': 0.7728337, 'precision': 0.79154104, 'recall': 0.7707118, 'specificity': 0.7707118, 'f1': 0.7681538, 'auroc': 0.86400414, 'binary_precision': 0.8614072, 'binary_recall': 0.64126986, 'binary_specificity': 0.90015364, 'binary_f1_score': 0.7352139}
confusion matrix:
     0    1
0  586   65
1  226  404
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.82222223, 'precision': 0.82975197, 'recall': 0.82222223, 'specificity': 0.82222223, 'f1': 0.82120156, 'auroc': 0.9111111, 'binary_precision': 0.87958115, 'binary_recall': 0.74666667, 'binary_specificity': 0.8977778, 'binary_f1_score': 0.8076923}
confusion matrix:
     0    1
0  202   23
1   57  168
new oracle model saved
better model found
persisted
after epoch: 16,now: 2024-07-20 14:28:50.008048,epoch time: 0:01:25.550957,used: 0:22:46.083075,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_14_06_03_seed_1_22504809
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9436849, 'precision': 0.94441617, 'recall': 0.94394803, 'specificity': 0.94394803, 'f1': 0.9436776, 'auroc': 0.9861529, 'binary_precision': 0.96561027, 'binary_recall': 0.92149293, 'binary_specificity': 0.9664032, 'binary_f1_score': 0.9430359}
confusion matrix:
      0     1
0  1467    51
1   122  1432
---- Validation: 
scalar performance:
{'acc': 0.79313034, 'precision': 0.80211765, 'recall': 0.7916795, 'specificity': 0.7916795, 'f1': 0.7909777, 'auroc': 0.86966085, 'binary_precision': 0.8502879, 'binary_recall': 0.7031746, 'binary_specificity': 0.88018435, 'binary_f1_score': 0.76976544}
confusion matrix:
     0    1
0  573   78
1  187  443
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8488889, 'precision': 0.8506621, 'recall': 0.8488889, 'specificity': 0.8488889, 'f1': 0.8486976, 'auroc': 0.91723454, 'binary_precision': 0.8755981, 'binary_recall': 0.81333333, 'binary_specificity': 0.8844444, 'binary_f1_score': 0.8433179}
confusion matrix:
     0    1
0  199   26
1   42  183
new oracle model saved
better model found
persisted
after epoch: 17,now: 2024-07-20 14:30:15.336232,epoch time: 0:01:25.328184,used: 0:24:11.411259,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_14_06_03_seed_1_22504809
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9404297, 'precision': 0.9427304, 'recall': 0.94098175, 'specificity': 0.94098175, 'f1': 0.94039226, 'auroc': 0.98415387, 'binary_precision': 0.9784273, 'binary_recall': 0.902439, 'binary_specificity': 0.97952443, 'binary_f1_score': 0.93889815}
confusion matrix:
      0     1
0  1483    31
1   152  1406
---- Validation: 
scalar performance:
{'acc': 0.7822014, 'precision': 0.8021521, 'recall': 0.78005636, 'specificity': 0.78005636, 'f1': 0.77761316, 'auroc': 0.87099946, 'binary_precision': 0.875803, 'binary_recall': 0.64920634, 'binary_specificity': 0.9109063, 'binary_f1_score': 0.74567}
confusion matrix:
     0    1
0  593   58
1  221  409
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8422222, 'precision': 0.8507085, 'recall': 0.8422222, 'specificity': 0.8422222, 'f1': 0.841262, 'auroc': 0.9196444, 'binary_precision': 0.9052632, 'binary_recall': 0.7644445, 'binary_specificity': 0.92, 'binary_f1_score': 0.8289157}
confusion matrix:
     0    1
0  207   18
1   53  172
early stop counter: 1
val acc:0.7822014093399048, best validation acc: 0.7931303381919861, corresponding to test acc:                         0.8488888740539551 / 0.8488888740539551
after epoch: 18,now: 2024-07-20 14:31:40.382160,epoch time: 0:01:25.045928,used: 0:25:36.457187,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_14_06_03_seed_1_22504809
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9433594, 'precision': 0.9455469, 'recall': 0.94379413, 'specificity': 0.94379413, 'f1': 0.943321, 'auroc': 0.98832834, 'binary_precision': 0.9798331, 'binary_recall': 0.9066924, 'binary_specificity': 0.98089594, 'binary_f1_score': 0.94184494}
confusion matrix:
      0     1
0  1489    29
1   145  1409
---- Validation: 
scalar performance:
{'acc': 0.7861046, 'precision': 0.80168104, 'recall': 0.78420377, 'specificity': 0.78420377, 'f1': 0.78249604, 'auroc': 0.87250876, 'binary_precision': 0.86625516, 'binary_recall': 0.66825396, 'binary_specificity': 0.90015364, 'binary_f1_score': 0.7544803}
confusion matrix:
     0    1
0  586   65
1  209  421
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.84, 'precision': 0.8446015, 'recall': 0.84000003, 'specificity': 0.84000003, 'f1': 0.83946407, 'auroc': 0.9207506, 'binary_precision': 0.8844221, 'binary_recall': 0.7822222, 'binary_specificity': 0.8977778, 'binary_f1_score': 0.83018863}
confusion matrix:
     0    1
0  202   23
1   49  176
early stop counter: 2
val acc:0.7861046195030212, best validation acc: 0.7931303381919861, corresponding to test acc:                         0.8488888740539551 / 0.8488888740539551
after epoch: 19,now: 2024-07-20 14:33:05.329086,epoch time: 0:01:24.946926,used: 0:27:01.404113,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_14_06_03_seed_1_22504809
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9420573, 'precision': 0.9428967, 'recall': 0.9423545, 'specificity': 0.9423545, 'f1': 0.94204843, 'auroc': 0.9872159, 'binary_precision': 0.9655172, 'binary_recall': 0.918328, 'binary_specificity': 0.966381, 'binary_f1_score': 0.94133157}
confusion matrix:
      0     1
0  1466    51
1   127  1428
---- Validation: 
scalar performance:
{'acc': 0.7993755, 'precision': 0.8082455, 'recall': 0.7979519, 'specificity': 0.7979519, 'f1': 0.79735214, 'auroc': 0.8746641, 'binary_precision': 0.8565965, 'binary_recall': 0.7111111, 'binary_specificity': 0.8847926, 'binary_f1_score': 0.7771032}
confusion matrix:
     0    1
0  576   75
1  182  448
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.85555553, 'precision': 0.85674644, 'recall': 0.85555553, 'specificity': 0.85555553, 'f1': 0.8554349, 'auroc': 0.9229037, 'binary_precision': 0.8773585, 'binary_recall': 0.82666665, 'binary_specificity': 0.8844444, 'binary_f1_score': 0.8512586}
confusion matrix:
     0    1
0  199   26
1   39  186
new oracle model saved
better model found
persisted
after epoch: 20,now: 2024-07-20 14:34:30.951976,epoch time: 0:01:25.622890,used: 0:28:27.027003,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_14_06_03_seed_1_22504809
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.945638, 'precision': 0.9467286, 'recall': 0.945972, 'specificity': 0.945972, 'f1': 0.9456253, 'auroc': 0.9855659, 'binary_precision': 0.97210884, 'binary_recall': 0.91897106, 'binary_specificity': 0.972973, 'binary_f1_score': 0.94479334}
confusion matrix:
      0     1
0  1476    41
1   126  1429
---- Validation: 
scalar performance:
{'acc': 0.8001561, 'precision': 0.80957115, 'recall': 0.7986943, 'specificity': 0.7986943, 'f1': 0.7980441, 'auroc': 0.8756516, 'binary_precision': 0.8596154, 'binary_recall': 0.7095238, 'binary_specificity': 0.8878648, 'binary_f1_score': 0.77739125}
confusion matrix:
     0    1
0  578   73
1  183  447
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8511111, 'precision': 0.853127, 'recall': 0.8511111, 'specificity': 0.8511111, 'f1': 0.8508984, 'auroc': 0.9233778, 'binary_precision': 0.8798077, 'binary_recall': 0.81333333, 'binary_specificity': 0.8888889, 'binary_f1_score': 0.8452656}
confusion matrix:
     0    1
0  200   25
1   42  183
better model found
persisted
after epoch: 21,now: 2024-07-20 14:35:55.816484,epoch time: 0:01:24.864508,used: 0:29:51.891511,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_14_06_03_seed_1_22504809
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9498698, 'precision': 0.95016867, 'recall': 0.95007324, 'specificity': 0.95007324, 'f1': 0.9498692, 'auroc': 0.9880546, 'binary_precision': 0.96547145, 'binary_recall': 0.9344473, 'binary_specificity': 0.9656992, 'binary_f1_score': 0.949706}
confusion matrix:
      0     1
0  1464    52
1   102  1454
---- Validation: 
scalar performance:
{'acc': 0.80093676, 'precision': 0.8088701, 'recall': 0.79959035, 'specificity': 0.79959035, 'f1': 0.79911464, 'auroc': 0.8786677, 'binary_precision': 0.85444236, 'binary_recall': 0.71746033, 'binary_specificity': 0.8817204, 'binary_f1_score': 0.77998275}
confusion matrix:
     0    1
0  574   77
1  178  452
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.86, 'precision': 0.8608625, 'recall': 0.86, 'specificity': 0.86, 'f1': 0.8599163, 'auroc': 0.9256692, 'binary_precision': 0.8785047, 'binary_recall': 0.83555555, 'binary_specificity': 0.8844444, 'binary_f1_score': 0.85649204}
confusion matrix:
     0    1
0  199   26
1   37  188
new oracle model saved
better model found
persisted
after epoch: 22,now: 2024-07-20 14:37:20.813330,epoch time: 0:01:24.996846,used: 0:31:16.888357,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_14_06_03_seed_1_22504809
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.94921875, 'precision': 0.9502031, 'recall': 0.9495008, 'specificity': 0.9495008, 'f1': 0.94920737, 'auroc': 0.98888135, 'binary_precision': 0.97420233, 'binary_recall': 0.924018, 'binary_specificity': 0.9749835, 'binary_f1_score': 0.9484468}
confusion matrix:
      0     1
0  1481    38
1   118  1435
---- Validation: 
scalar performance:
{'acc': 0.79703355, 'precision': 0.808542, 'recall': 0.7954173, 'specificity': 0.7954173, 'f1': 0.79447234, 'auroc': 0.8795406, 'binary_precision': 0.86417323, 'binary_recall': 0.6968254, 'binary_specificity': 0.89400923, 'binary_f1_score': 0.77152896}
confusion matrix:
     0    1
0  582   69
1  191  439
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8622222, 'precision': 0.86455536, 'recall': 0.8622222, 'specificity': 0.8622222, 'f1': 0.8620014, 'auroc': 0.9256494, 'binary_precision': 0.8937198, 'binary_recall': 0.82222223, 'binary_specificity': 0.9022222, 'binary_f1_score': 0.8564815}
confusion matrix:
     0    1
0  203   22
1   40  185
new oracle model saved
early stop counter: 1
val acc:0.7970335483551025, best validation acc: 0.800936758518219, corresponding to test acc:                         0.8600000143051147 / 0.8622221946716309
after epoch: 23,now: 2024-07-20 14:38:45.997829,epoch time: 0:01:25.184499,used: 0:32:42.072856,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_14_06_03_seed_1_22504809
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.94596356, 'precision': 0.9484821, 'recall': 0.94645464, 'specificity': 0.94645464, 'f1': 0.9459212, 'auroc': 0.9890175, 'binary_precision': 0.9853249, 'binary_recall': 0.9067524, 'binary_specificity': 0.9861569, 'binary_f1_score': 0.9444072}
confusion matrix:
      0     1
0  1496    21
1   145  1410
---- Validation: 
scalar performance:
{'acc': 0.7798595, 'precision': 0.8055463, 'recall': 0.77744496, 'specificity': 0.77744496, 'f1': 0.7740735, 'auroc': 0.8769659, 'binary_precision': 0.8901345, 'binary_recall': 0.6301587, 'binary_specificity': 0.9247312, 'binary_f1_score': 0.7379182}
confusion matrix:
     0    1
0  602   49
1  233  397
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.84444445, 'precision': 0.8568797, 'recall': 0.8444444, 'specificity': 0.8444444, 'f1': 0.8430774, 'auroc': 0.9249778, 'binary_precision': 0.92349726, 'binary_recall': 0.7511111, 'binary_specificity': 0.93777776, 'binary_f1_score': 0.82843137}
confusion matrix:
     0    1
0  211   14
1   56  169
early stop counter: 2
val acc:0.7798594832420349, best validation acc: 0.800936758518219, corresponding to test acc:                         0.8600000143051147 / 0.8622221946716309
after epoch: 24,now: 2024-07-20 14:40:11.193635,epoch time: 0:01:25.195806,used: 0:34:07.268662,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_14_06_03_seed_1_22504809
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.94140625, 'precision': 0.94260645, 'recall': 0.94179595, 'specificity': 0.94179595, 'f1': 0.94139194, 'auroc': 0.98791146, 'binary_precision': 0.9693251, 'binary_recall': 0.9132948, 'binary_specificity': 0.97029704, 'binary_f1_score': 0.94047624}
confusion matrix:
      0     1
0  1470    45
1   135  1422
---- Validation: 
scalar performance:
{'acc': 0.8017174, 'precision': 0.81304264, 'recall': 0.800128, 'specificity': 0.800128, 'f1': 0.79928565, 'auroc': 0.8814547, 'binary_precision': 0.8686274, 'binary_recall': 0.7031746, 'binary_specificity': 0.89708143, 'binary_f1_score': 0.777193}
confusion matrix:
     0    1
0  584   67
1  187  443
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8688889, 'precision': 0.8715383, 'recall': 0.86888885, 'specificity': 0.86888885, 'f1': 0.8686547, 'auroc': 0.9271704, 'binary_precision': 0.9029126, 'binary_recall': 0.82666665, 'binary_specificity': 0.9111111, 'binary_f1_score': 0.86310905}
confusion matrix:
     0    1
0  205   20
1   39  186
new oracle model saved
better model found
persisted
after epoch: 25,now: 2024-07-20 14:41:36.730284,epoch time: 0:01:25.536649,used: 0:35:32.805311,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_14_06_03_seed_1_22504809
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9511719, 'precision': 0.9514899, 'recall': 0.95135593, 'specificity': 0.95135593, 'f1': 0.9511708, 'auroc': 0.9886154, 'binary_precision': 0.96675533, 'binary_recall': 0.93564993, 'binary_specificity': 0.96706194, 'binary_f1_score': 0.9509483}
confusion matrix:
      0     1
0  1468    50
1   100  1454
---- Validation: 
scalar performance:
{'acc': 0.80640125, 'precision': 0.8160454, 'recall': 0.8049411, 'specificity': 0.8049411, 'f1': 0.80435526, 'auroc': 0.8836515, 'binary_precision': 0.86730766, 'binary_recall': 0.715873, 'binary_specificity': 0.89400923, 'binary_f1_score': 0.78434783}
confusion matrix:
     0    1
0  582   69
1  179  451
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8666667, 'precision': 0.8685303, 'recall': 0.8666667, 'specificity': 0.8666667, 'f1': 0.8664979, 'auroc': 0.9280395, 'binary_precision': 0.8947368, 'binary_recall': 0.83111113, 'binary_specificity': 0.9022222, 'binary_f1_score': 0.8617512}
confusion matrix:
     0    1
0  203   22
1   38  187
better model found
persisted
after epoch: 26,now: 2024-07-20 14:43:01.483525,epoch time: 0:01:24.753241,used: 0:36:57.558552,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_14_06_03_seed_1_22504809
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.9514974, 'precision': 0.9527327, 'recall': 0.9519118, 'specificity': 0.9519118, 'f1': 0.95148605, 'auroc': 0.98935354, 'binary_precision': 0.98023176, 'binary_recall': 0.92297816, 'binary_specificity': 0.98084545, 'binary_f1_score': 0.9507438}
confusion matrix:
      0     1
0  1485    29
1   120  1438
---- Validation: 
scalar performance:
{'acc': 0.8032787, 'precision': 0.8146715, 'recall': 0.80168974, 'specificity': 0.80168974, 'f1': 0.8008661, 'auroc': 0.882625, 'binary_precision': 0.87058824, 'binary_recall': 0.7047619, 'binary_specificity': 0.8986175, 'binary_f1_score': 0.7789474}
confusion matrix:
     0    1
0  585   66
1  186  444
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8622222, 'precision': 0.86455536, 'recall': 0.8622222, 'specificity': 0.8622222, 'f1': 0.8620014, 'auroc': 0.92815804, 'binary_precision': 0.8937198, 'binary_recall': 0.82222223, 'binary_specificity': 0.9022222, 'binary_f1_score': 0.8564815}
confusion matrix:
     0    1
0  203   22
1   40  185
early stop counter: 1
val acc:0.8032786846160889, best validation acc: 0.806401252746582, corresponding to test acc:                         0.8666666746139526 / 0.8688889145851135
after epoch: 27,now: 2024-07-20 14:44:26.415098,epoch time: 0:01:24.931573,used: 0:38:22.490125,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_14_06_03_seed_1_22504809
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.9534505, 'precision': 0.95407486, 'recall': 0.95372665, 'specificity': 0.95372665, 'f1': 0.95344687, 'auroc': 0.99143374, 'binary_precision': 0.9744795, 'binary_recall': 0.93251926, 'binary_specificity': 0.97493404, 'binary_f1_score': 0.95303774}
confusion matrix:
      0     1
0  1478    38
1   105  1451
---- Validation: 
scalar performance:
{'acc': 0.8149883, 'precision': 0.82668567, 'recall': 0.8134153, 'specificity': 0.8134153, 'f1': 0.81275177, 'auroc': 0.885707, 'binary_precision': 0.88454014, 'binary_recall': 0.71746033, 'binary_specificity': 0.9093702, 'binary_f1_score': 0.79228747}
confusion matrix:
     0    1
0  592   59
1  178  452
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8666667, 'precision': 0.86902845, 'recall': 0.8666667, 'specificity': 0.8666667, 'f1': 0.866453, 'auroc': 0.93025184, 'binary_precision': 0.89855075, 'binary_recall': 0.82666665, 'binary_specificity': 0.9066667, 'binary_f1_score': 0.86111116}
confusion matrix:
     0    1
0  204   21
1   39  186
better model found
persisted
after epoch: 28,now: 2024-07-20 14:45:52.402166,epoch time: 0:01:25.987068,used: 0:39:48.477193,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_14_06_03_seed_1_22504809
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9534505, 'precision': 0.9544406, 'recall': 0.95376956, 'specificity': 0.95376956, 'f1': 0.9534414, 'auroc': 0.9915203, 'binary_precision': 0.9789688, 'binary_recall': 0.9279743, 'binary_specificity': 0.9795649, 'binary_f1_score': 0.9527897}
confusion matrix:
      0     1
0  1486    31
1   112  1443
---- Validation: 
scalar performance:
{'acc': 0.81030446, 'precision': 0.82261133, 'recall': 0.808679, 'specificity': 0.808679, 'f1': 0.8078767, 'auroc': 0.8859825, 'binary_precision': 0.8816568, 'binary_recall': 0.7095238, 'binary_specificity': 0.9078341, 'binary_f1_score': 0.7862797}
confusion matrix:
     0    1
0  591   60
1  183  447
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8711111, 'precision': 0.8753821, 'recall': 0.8711111, 'specificity': 0.8711111, 'f1': 0.8707434, 'auroc': 0.9316148, 'binary_precision': 0.91542286, 'binary_recall': 0.81777775, 'binary_specificity': 0.92444444, 'binary_f1_score': 0.86384976}
confusion matrix:
     0    1
0  208   17
1   41  184
new oracle model saved
early stop counter: 1
val acc:0.8103044629096985, best validation acc: 0.8149883151054382, corresponding to test acc:                         0.8666666746139526 / 0.8711110949516296
after epoch: 29,now: 2024-07-20 14:47:18.341251,epoch time: 0:01:25.939085,used: 0:41:14.416278,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_14_06_03_seed_1_22504809
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.95670575, 'precision': 0.95710623, 'recall': 0.95696265, 'specificity': 0.95696265, 'f1': 0.9567049, 'auroc': 0.9908594, 'binary_precision': 0.9746835, 'binary_recall': 0.9390244, 'binary_specificity': 0.9749009, 'binary_f1_score': 0.9565217}
confusion matrix:
      0     1
0  1476    38
1    95  1463
---- Validation: 
scalar performance:
{'acc': 0.8142077, 'precision': 0.8260739, 'recall': 0.8126216, 'specificity': 0.8126216, 'f1': 0.8119291, 'auroc': 0.8876015, 'binary_precision': 0.8843137, 'binary_recall': 0.715873, 'binary_specificity': 0.9093702, 'binary_f1_score': 0.791228}
confusion matrix:
     0    1
0  592   59
1  179  451
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8711111, 'precision': 0.8746934, 'recall': 0.87111115, 'specificity': 0.87111115, 'f1': 0.87080234, 'auroc': 0.9343407, 'binary_precision': 0.91133004, 'binary_recall': 0.82222223, 'binary_specificity': 0.92, 'binary_f1_score': 0.864486}
confusion matrix:
     0    1
0  207   18
1   40  185
early stop counter: 2
val acc:0.8142076730728149, best validation acc: 0.8149883151054382, corresponding to test acc:                         0.8666666746139526 / 0.8711110949516296
after epoch: 30,now: 2024-07-20 14:48:43.944419,epoch time: 0:01:25.603168,used: 0:42:40.019446,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_14_06_03_seed_1_22504809
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 0:42:40.019446 at 2024-07-20 14:48:43.944419
persisted model performance metric: 

scalar performance:
{'acc': 0.8666667, 'precision': 0.86902845, 'recall': 0.8666667, 'specificity': 0.8666667, 'f1': 0.866453, 'auroc': 0.93025184, 'binary_precision': 0.89855075, 'binary_recall': 0.82666665, 'binary_specificity': 0.9066667, 'binary_f1_score': 0.86111116}
confusion matrix:
     0    1
0  204   21
1   39  186
oracle model performance metric: 

scalar performance:
{'acc': 0.8711111, 'precision': 0.8753821, 'recall': 0.8711111, 'specificity': 0.8711111, 'f1': 0.8707434, 'auroc': 0.9316148, 'binary_precision': 0.91542286, 'binary_recall': 0.81777775, 'binary_specificity': 0.92444444, 'binary_f1_score': 0.86384976}
confusion matrix:
     0    1
0  208   17
1   41  184
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_halffreezeblocks_2024-07-20_12-47-21/rule_results/0.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_halffreezeblocks_2024-07-20_12-47-21/confusion_matrix/0.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 196570 KiB |   1194 MiB |  96912 GiB |  96912 GiB |
|       from large pool | 180168 KiB |   1178 MiB |  95564 GiB |  95564 GiB |
|       from small pool |  16402 KiB |     36 MiB |   1347 GiB |   1347 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 196570 KiB |   1194 MiB |  96912 GiB |  96912 GiB |
|       from large pool | 180168 KiB |   1178 MiB |  95564 GiB |  95564 GiB |
|       from small pool |  16402 KiB |     36 MiB |   1347 GiB |   1347 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 195189 KiB |   1193 MiB |  96897 GiB |  96897 GiB |
|       from large pool | 178979 KiB |   1176 MiB |  95552 GiB |  95552 GiB |
|       from small pool |  16210 KiB |     36 MiB |   1345 GiB |   1345 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1334 MiB |   1348 MiB |   2444 MiB |   1110 MiB |
|       from large pool |   1292 MiB |   1310 MiB |   2382 MiB |   1090 MiB |
|       from small pool |     42 MiB |     42 MiB |     62 MiB |     20 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  49189 KiB | 152022 KiB |  52583 GiB |  52583 GiB |
|       from large pool |  45111 KiB | 150341 KiB |  51188 GiB |  51188 GiB |
|       from small pool |   4078 KiB |   9275 KiB |   1394 GiB |   1394 GiB |
|---------------------------------------------------------------------------|
| Allocations           |     800    |    1171    |   16957 K  |   16956 K  |
|       from large pool |      79    |     167    |    8949 K  |    8949 K  |
|       from small pool |     721    |    1017    |    8007 K  |    8007 K  |
|---------------------------------------------------------------------------|
| Active allocs         |     800    |    1171    |   16957 K  |   16956 K  |
|       from large pool |      79    |     167    |    8949 K  |    8949 K  |
|       from small pool |     721    |    1017    |    8007 K  |    8007 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      76    |      76    |     130    |      54    |
|       from large pool |      55    |      55    |      99    |      44    |
|       from small pool |      21    |      21    |      31    |      10    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      33    |     219    |   11048 K  |   11048 K  |
|       from large pool |      12    |      57    |    6388 K  |    6388 K  |
|       from small pool |      21    |     208    |    4660 K  |    4660 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   1194 MiB |  96912 GiB |  96912 GiB |
|       from large pool |  16640 KiB |   1178 MiB |  95564 GiB |  95564 GiB |
|       from small pool |      0 KiB |     36 MiB |   1347 GiB |   1347 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   1194 MiB |  96912 GiB |  96912 GiB |
|       from large pool |  16640 KiB |   1178 MiB |  95564 GiB |  95564 GiB |
|       from small pool |      0 KiB |     36 MiB |   1347 GiB |   1347 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   1193 MiB |  96897 GiB |  96897 GiB |
|       from large pool |  16640 KiB |   1176 MiB |  95552 GiB |  95552 GiB |
|       from small pool |      0 KiB |     36 MiB |   1345 GiB |   1345 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 245760 KiB |   1348 MiB |   2444 MiB |   2204 MiB |
|       from large pool | 225280 KiB |   1310 MiB |   2382 MiB |   2162 MiB |
|       from small pool |  20480 KiB |     42 MiB |     62 MiB |     42 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 152022 KiB |  52583 GiB |  52583 GiB |
|       from large pool |  24320 KiB | 150341 KiB |  51188 GiB |  51188 GiB |
|       from small pool |      0 KiB |  11188 KiB |   1394 GiB |   1394 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    1171    |   16957 K  |   16957 K  |
|       from large pool |       2    |     167    |    8949 K  |    8949 K  |
|       from small pool |       0    |    1017    |    8007 K  |    8007 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    1171    |   16957 K  |   16957 K  |
|       from large pool |       2    |     167    |    8949 K  |    8949 K  |
|       from small pool |       0    |    1017    |    8007 K  |    8007 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      21    |      76    |     130    |     109    |
|       from large pool |      11    |      55    |      99    |      88    |
|       from small pool |      10    |      21    |      31    |      21    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |     219    |   11049 K  |   11049 K  |
|       from large pool |       4    |      57    |    6388 K  |    6388 K  |
|       from small pool |       0    |     208    |    4661 K  |    4661 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   1194 MiB |  96912 GiB |  96912 GiB |
|       from large pool |  16640 KiB |   1178 MiB |  95564 GiB |  95564 GiB |
|       from small pool |      0 KiB |     36 MiB |   1347 GiB |   1347 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   1194 MiB |  96912 GiB |  96912 GiB |
|       from large pool |  16640 KiB |   1178 MiB |  95564 GiB |  95564 GiB |
|       from small pool |      0 KiB |     36 MiB |   1347 GiB |   1347 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   1193 MiB |  96897 GiB |  96897 GiB |
|       from large pool |  16640 KiB |   1176 MiB |  95552 GiB |  95552 GiB |
|       from small pool |      0 KiB |     36 MiB |   1345 GiB |   1345 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 245760 KiB |   1348 MiB |   2444 MiB |   2204 MiB |
|       from large pool | 225280 KiB |   1310 MiB |   2382 MiB |   2162 MiB |
|       from small pool |  20480 KiB |     42 MiB |     62 MiB |     42 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 152022 KiB |  52583 GiB |  52583 GiB |
|       from large pool |  24320 KiB | 150341 KiB |  51188 GiB |  51188 GiB |
|       from small pool |      0 KiB |  11188 KiB |   1394 GiB |   1394 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    1171    |   16957 K  |   16957 K  |
|       from large pool |       2    |     167    |    8949 K  |    8949 K  |
|       from small pool |       0    |    1017    |    8007 K  |    8007 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    1171    |   16957 K  |   16957 K  |
|       from large pool |       2    |     167    |    8949 K  |    8949 K  |
|       from small pool |       0    |    1017    |    8007 K  |    8007 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      21    |      76    |     130    |     109    |
|       from large pool |      11    |      55    |      99    |      88    |
|       from small pool |      10    |      21    |      31    |      21    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |     219    |   11049 K  |   11049 K  |
|       from large pool |       4    |      57    |    6388 K  |    6388 K  |
|       from small pool |       0    |     208    |    4661 K  |    4661 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'888c1ef2'
model name: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_14_49_59_seed_2_22504809

 Experiment start at: 2024-07-20 14:49:59.249741
before training, model accuracy: 0.41203704476356506
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.7558901, 'precision': 0.75598925, 'recall': 0.75579274, 'specificity': 0.75579274, 'f1': 0.7558081, 'auroc': 0.8405219, 'binary_precision': 0.7525445, 'binary_recall': 0.7681818, 'binary_specificity': 0.7434037, 'binary_f1_score': 0.7602828}
confusion matrix:
      0     1
0  1127   389
1   357  1183
---- Validation: 
scalar performance:
{'acc': 0.6768388, 'precision': 0.6829157, 'recall': 0.674006, 'specificity': 0.674006, 'f1': 0.67175806, 'auroc': 0.7129122, 'binary_precision': 0.7102616, 'binary_recall': 0.56752414, 'binary_specificity': 0.7804878, 'binary_f1_score': 0.63092047}
confusion matrix:
     0    1
0  512  144
1  269  353
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.4375, 'precision': 0.4324609, 'recall': 0.4375, 'specificity': 0.4375, 'f1': 0.4268086, 'auroc': 0.42024606, 'binary_precision': 0.41401273, 'binary_recall': 0.30092594, 'binary_specificity': 0.5740741, 'binary_f1_score': 0.3485255}
confusion matrix:
     0   1
0  124  92
1  151  65
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-20 14:51:26.949519,epoch time: 0:01:27.699778,used: 0:01:27.699778,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_14_49_59_seed_2_22504809
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.84816754, 'precision': 0.8505614, 'recall': 0.84849226, 'specificity': 0.84849226, 'f1': 0.8479846, 'auroc': 0.91872454, 'binary_precision': 0.88156027, 'binary_recall': 0.80714285, 'binary_specificity': 0.8898417, 'binary_f1_score': 0.84271187}
confusion matrix:
      0     1
0  1349   167
1   297  1243
---- Validation: 
scalar performance:
{'acc': 0.65258217, 'precision': 0.68738556, 'recall': 0.64646155, 'specificity': 0.64646155, 'f1': 0.6299585, 'auroc': 0.72819775, 'binary_precision': 0.7617647, 'binary_recall': 0.4163987, 'binary_specificity': 0.8765244, 'binary_f1_score': 0.5384615}
confusion matrix:
     0    1
0  575   81
1  363  259
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.49074075, 'precision': 0.4859649, 'recall': 0.49074075, 'specificity': 0.49074075, 'f1': 0.44339025, 'auroc': 0.51963305, 'binary_precision': 0.47777778, 'binary_recall': 0.19907407, 'binary_specificity': 0.7824074, 'binary_f1_score': 0.28104573}
confusion matrix:
     0   1
0  169  47
1  173  43
new oracle model saved
early stop counter: 1
val acc:0.6525821685791016, best validation acc: 0.6768388152122498, corresponding to test acc:                         0.4375 / 0.49074074625968933
after epoch: 2,now: 2024-07-20 14:52:51.042907,epoch time: 0:01:24.093388,used: 0:02:51.793166,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_14_49_59_seed_2_22504809
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.88579845, 'precision': 0.89010286, 'recall': 0.88621545, 'specificity': 0.88621545, 'f1': 0.8855548, 'auroc': 0.943644, 'binary_precision': 0.9330909, 'binary_recall': 0.8331169, 'binary_specificity': 0.939314, 'binary_f1_score': 0.8802744}
confusion matrix:
      0     1
0  1424    92
1   257  1283
---- Validation: 
scalar performance:
{'acc': 0.6455399, 'precision': 0.69314295, 'recall': 0.6385602, 'specificity': 0.6385602, 'f1': 0.61553955, 'auroc': 0.7410693, 'binary_precision': 0.7826087, 'binary_recall': 0.3762058, 'binary_specificity': 0.9009146, 'binary_f1_score': 0.50814337}
confusion matrix:
     0    1
0  591   65
1  388  234
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5231481, 'precision': 0.53991723, 'recall': 0.5231481, 'specificity': 0.5231481, 'f1': 0.46719033, 'auroc': 0.5799254, 'binary_precision': 0.56578946, 'binary_recall': 0.19907407, 'binary_specificity': 0.8472222, 'binary_f1_score': 0.29452053}
confusion matrix:
     0   1
0  183  33
1  173  43
new oracle model saved
early stop counter: 2
val acc:0.6455398797988892, best validation acc: 0.6768388152122498, corresponding to test acc:                         0.4375 / 0.5231481194496155
after epoch: 3,now: 2024-07-20 14:54:15.243625,epoch time: 0:01:24.200718,used: 0:04:15.993884,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_14_49_59_seed_2_22504809
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.8893979, 'precision': 0.89547634, 'recall': 0.88988966, 'specificity': 0.88988966, 'f1': 0.8890546, 'auroc': 0.9481436, 'binary_precision': 0.94650817, 'binary_recall': 0.8272727, 'binary_specificity': 0.9525066, 'binary_f1_score': 0.8828829}
confusion matrix:
      0     1
0  1444    72
1   266  1274
---- Validation: 
scalar performance:
{'acc': 0.64241004, 'precision': 0.70370305, 'recall': 0.6347615, 'specificity': 0.6347615, 'f1': 0.60589707, 'auroc': 0.7523234, 'binary_precision': 0.80898875, 'binary_recall': 0.34726688, 'binary_specificity': 0.9222561, 'binary_f1_score': 0.48593923}
confusion matrix:
     0    1
0  605   51
1  406  216
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5324074, 'precision': 0.56108594, 'recall': 0.5324074, 'specificity': 0.5324074, 'f1': 0.47022825, 'auroc': 0.6212491, 'binary_precision': 0.60294116, 'binary_recall': 0.18981482, 'binary_specificity': 0.875, 'binary_f1_score': 0.2887324}
confusion matrix:
     0   1
0  189  27
1  175  41
new oracle model saved
early stop counter: 3
val acc:0.6424100399017334, best validation acc: 0.6768388152122498, corresponding to test acc:                         0.4375 / 0.5324074029922485
after epoch: 4,now: 2024-07-20 14:55:39.652651,epoch time: 0:01:24.409026,used: 0:05:40.402910,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_14_49_59_seed_2_22504809
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9070681, 'precision': 0.91056997, 'recall': 0.90743756, 'specificity': 0.90743756, 'f1': 0.9069197, 'auroc': 0.96351516, 'binary_precision': 0.95050216, 'binary_recall': 0.8603896, 'binary_specificity': 0.9544855, 'binary_f1_score': 0.90320385}
confusion matrix:
      0     1
0  1447    69
1   215  1325
---- Validation: 
scalar performance:
{'acc': 0.64084506, 'precision': 0.7056676, 'recall': 0.6330288, 'specificity': 0.6330288, 'f1': 0.60248566, 'auroc': 0.7626779, 'binary_precision': 0.8146718, 'binary_recall': 0.3392283, 'binary_specificity': 0.9268293, 'binary_f1_score': 0.47900113}
confusion matrix:
     0    1
0  608   48
1  411  211
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.537037, 'precision': 0.5681926, 'recall': 0.537037, 'specificity': 0.537037, 'f1': 0.47733924, 'auroc': 0.65189904, 'binary_precision': 0.6142857, 'binary_recall': 0.19907407, 'binary_specificity': 0.875, 'binary_f1_score': 0.3006993}
confusion matrix:
     0   1
0  189  27
1  173  43
new oracle model saved
early stop counter: 4
val acc:0.6408450603485107, best validation acc: 0.6768388152122498, corresponding to test acc:                         0.4375 / 0.5370370149612427
after epoch: 5,now: 2024-07-20 14:57:03.875924,epoch time: 0:01:24.223273,used: 0:07:04.626183,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_14_49_59_seed_2_22504809
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9132853, 'precision': 0.91585004, 'recall': 0.9136012, 'specificity': 0.9136012, 'f1': 0.9131905, 'auroc': 0.96712303, 'binary_precision': 0.95053005, 'binary_recall': 0.8733766, 'binary_specificity': 0.95382583, 'binary_f1_score': 0.9103215}
confusion matrix:
      0     1
0  1446    70
1   195  1345
---- Validation: 
scalar performance:
{'acc': 0.6251956, 'precision': 0.70091164, 'recall': 0.61666, 'specificity': 0.61666, 'f1': 0.5770969, 'auroc': 0.7683417, 'binary_precision': 0.81777775, 'binary_recall': 0.29581994, 'binary_specificity': 0.9375, 'binary_f1_score': 0.43447462}
confusion matrix:
     0    1
0  615   41
1  438  184
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5555556, 'precision': 0.60730255, 'recall': 0.5555556, 'specificity': 0.5555556, 'f1': 0.494626, 'auroc': 0.68334186, 'binary_precision': 0.6818182, 'binary_recall': 0.20833333, 'binary_specificity': 0.9027778, 'binary_f1_score': 0.31914893}
confusion matrix:
     0   1
0  195  21
1  171  45
new oracle model saved
early stop counter: 5
val acc:0.6251956224441528, best validation acc: 0.6768388152122498, corresponding to test acc:                         0.4375 / 0.5555555820465088
after epoch: 6,now: 2024-07-20 14:58:27.777072,epoch time: 0:01:23.901148,used: 0:08:28.527331,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_14_49_59_seed_2_22504809
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 6 with time: 0:08:28.527331 at 2024-07-20 14:58:27.777072
persisted model performance metric: 

scalar performance:
{'acc': 0.4375, 'precision': 0.4324609, 'recall': 0.4375, 'specificity': 0.4375, 'f1': 0.4268086, 'auroc': 0.42024606, 'binary_precision': 0.41401273, 'binary_recall': 0.30092594, 'binary_specificity': 0.5740741, 'binary_f1_score': 0.3485255}
confusion matrix:
     0   1
0  124  92
1  151  65
oracle model performance metric: 

scalar performance:
{'acc': 0.5555556, 'precision': 0.60730255, 'recall': 0.5555556, 'specificity': 0.5555556, 'f1': 0.494626, 'auroc': 0.68334186, 'binary_precision': 0.6818182, 'binary_recall': 0.20833333, 'binary_specificity': 0.9027778, 'binary_f1_score': 0.31914893}
confusion matrix:
     0   1
0  195  21
1  171  45
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_halffreezeblocks_2024-07-20_12-47-21/rule_results/0.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_halffreezeblocks_2024-07-20_12-47-21/confusion_matrix/0.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 196564 KiB |   1194 MiB | 108527 GiB | 108527 GiB |
|       from large pool | 180168 KiB |   1178 MiB | 107014 GiB | 107014 GiB |
|       from small pool |  16396 KiB |     36 MiB |   1512 GiB |   1512 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 196564 KiB |   1194 MiB | 108527 GiB | 108527 GiB |
|       from large pool | 180168 KiB |   1178 MiB | 107014 GiB | 107014 GiB |
|       from small pool |  16396 KiB |     36 MiB |   1512 GiB |   1512 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 195188 KiB |   1193 MiB | 108511 GiB | 108510 GiB |
|       from large pool | 178979 KiB |   1176 MiB | 107001 GiB | 107001 GiB |
|       from small pool |  16209 KiB |     36 MiB |   1509 GiB |   1509 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1330 MiB |   1348 MiB |   3534 MiB |   2204 MiB |
|       from large pool |   1292 MiB |   1310 MiB |   3454 MiB |   2162 MiB |
|       from small pool |     38 MiB |     42 MiB |     80 MiB |     42 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  51243 KiB | 152022 KiB |  58774 GiB |  58774 GiB |
|       from large pool |  45111 KiB | 150341 KiB |  57208 GiB |  57208 GiB |
|       from small pool |   6132 KiB |  11188 KiB |   1565 GiB |   1565 GiB |
|---------------------------------------------------------------------------|
| Allocations           |     788    |    1171    |   18973 K  |   18972 K  |
|       from large pool |      79    |     167    |   10024 K  |   10024 K  |
|       from small pool |     709    |    1017    |    8948 K  |    8947 K  |
|---------------------------------------------------------------------------|
| Active allocs         |     788    |    1171    |   18973 K  |   18972 K  |
|       from large pool |      79    |     167    |   10024 K  |   10024 K  |
|       from small pool |     709    |    1017    |    8948 K  |    8947 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      74    |      76    |     183    |     109    |
|       from large pool |      55    |      55    |     143    |      88    |
|       from small pool |      19    |      21    |      40    |      21    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      36    |     219    |   12313 K  |   12313 K  |
|       from large pool |      12    |      57    |    7110 K  |    7110 K  |
|       from small pool |      24    |     208    |    5202 K  |    5202 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   1194 MiB | 108527 GiB | 108527 GiB |
|       from large pool |  16640 KiB |   1178 MiB | 107014 GiB | 107014 GiB |
|       from small pool |      0 KiB |     36 MiB |   1512 GiB |   1512 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   1194 MiB | 108527 GiB | 108527 GiB |
|       from large pool |  16640 KiB |   1178 MiB | 107014 GiB | 107014 GiB |
|       from small pool |      0 KiB |     36 MiB |   1512 GiB |   1512 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   1193 MiB | 108511 GiB | 108511 GiB |
|       from large pool |  16640 KiB |   1176 MiB | 107001 GiB | 107001 GiB |
|       from small pool |      0 KiB |     36 MiB |   1509 GiB |   1509 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 247808 KiB |   1348 MiB |   3534 MiB |   3292 MiB |
|       from large pool | 225280 KiB |   1310 MiB |   3454 MiB |   3234 MiB |
|       from small pool |  22528 KiB |     42 MiB |     80 MiB |     58 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 152022 KiB |  58774 GiB |  58774 GiB |
|       from large pool |  24320 KiB | 150341 KiB |  57208 GiB |  57208 GiB |
|       from small pool |      0 KiB |  13054 KiB |   1565 GiB |   1565 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    1171    |   18973 K  |   18973 K  |
|       from large pool |       2    |     167    |   10024 K  |   10024 K  |
|       from small pool |       0    |    1017    |    8948 K  |    8948 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    1171    |   18973 K  |   18973 K  |
|       from large pool |       2    |     167    |   10024 K  |   10024 K  |
|       from small pool |       0    |    1017    |    8948 K  |    8948 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      22    |      76    |     183    |     161    |
|       from large pool |      11    |      55    |     143    |     132    |
|       from small pool |      11    |      21    |      40    |      29    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |     219    |   12313 K  |   12313 K  |
|       from large pool |       4    |      57    |    7110 K  |    7110 K  |
|       from small pool |       0    |     208    |    5202 K  |    5202 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Sat Jul 20 14:59:15 2024]
Finished job 0.
1 of 1 steps (100%) done
