Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Sat Jul 20 12:57:41 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_halffreezeblocks_2024-07-20_12-47-21/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_halffreezeblocks_2024-07-20_12-47-21/rule_results/6.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=6
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/swiglu_ffn.py:51: UserWarning: xFormers is not available (SwiGLU)
  warnings.warn("xFormers is not available (SwiGLU)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/attention.py:33: UserWarning: xFormers is not available (Attention)
  warnings.warn("xFormers is not available (Attention)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/block.py:40: UserWarning: xFormers is not available (Block)
  warnings.warn("xFormers is not available (Block)")
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'888c1ef2'
model name: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_12_58_17_seed_0_22504807

 Experiment start at: 2024-07-20 12:58:17.915282
before training, model accuracy: 0.569767415523529
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.8024089, 'precision': 0.8024148, 'recall': 0.8023051, 'specificity': 0.8023051, 'f1': 0.80234075, 'auroc': 0.8799311, 'binary_precision': 0.8021628, 'binary_recall': 0.8098908, 'binary_specificity': 0.79471946, 'binary_f1_score': 0.8060083}
confusion matrix:
      0     1
0  1204   311
1   296  1261
---- Validation: 
scalar performance:
{'acc': 0.59782606, 'precision': 0.6255314, 'recall': 0.59436154, 'specificity': 0.59436154, 'f1': 0.56957096, 'auroc': 0.7323438, 'binary_precision': 0.68111455, 'binary_recall': 0.3464567, 'binary_specificity': 0.84226644, 'binary_f1_score': 0.45929024}
confusion matrix:
     0    1
0  550  103
1  415  220
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.60697675, 'precision': 0.6372696, 'recall': 0.60697675, 'specificity': 0.60697675, 'f1': 0.5840274, 'auroc': 0.735338, 'binary_precision': 0.7017544, 'binary_recall': 0.37209302, 'binary_specificity': 0.8418605, 'binary_f1_score': 0.48632216}
confusion matrix:
     0   1
0  181  34
1  135  80
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-20 13:00:09.349818,epoch time: 0:01:51.434536,used: 0:01:51.434536,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_12_58_17_seed_0_22504807
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.8457031, 'precision': 0.8505717, 'recall': 0.8465482, 'specificity': 0.8465482, 'f1': 0.8453633, 'auroc': 0.91675127, 'binary_precision': 0.89562047, 'binary_recall': 0.7875481, 'binary_specificity': 0.9055482, 'binary_f1_score': 0.8381147}
confusion matrix:
      0     1
0  1371   143
1   331  1227
---- Validation: 
scalar performance:
{'acc': 0.5993789, 'precision': 0.6353389, 'recall': 0.5956108, 'specificity': 0.5956108, 'f1': 0.56583697, 'auroc': 0.74647117, 'binary_precision': 0.7016949, 'binary_recall': 0.32598424, 'binary_specificity': 0.86523736, 'binary_f1_score': 0.44516125}
confusion matrix:
     0    1
0  565   88
1  428  207
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.61627907, 'precision': 0.65650475, 'recall': 0.61627907, 'specificity': 0.61627907, 'f1': 0.58992946, 'auroc': 0.76560307, 'binary_precision': 0.7358491, 'binary_recall': 0.3627907, 'binary_specificity': 0.8697674, 'binary_f1_score': 0.48598137}
confusion matrix:
     0   1
0  187  28
1  137  78
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-07-20 13:01:54.367021,epoch time: 0:01:45.017203,used: 0:03:36.451739,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_12_58_17_seed_0_22504807
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.8645833, 'precision': 0.8693788, 'recall': 0.8653319, 'specificity': 0.8653319, 'f1': 0.86429334, 'auroc': 0.93015254, 'binary_precision': 0.91484714, 'binary_recall': 0.80784065, 'binary_specificity': 0.9228232, 'binary_f1_score': 0.8580205}
confusion matrix:
      0     1
0  1399   117
1   299  1257
---- Validation: 
scalar performance:
{'acc': 0.61180127, 'precision': 0.6502186, 'recall': 0.6081224, 'specificity': 0.6081224, 'f1': 0.58085036, 'auroc': 0.76110744, 'binary_precision': 0.7227723, 'binary_recall': 0.3448819, 'binary_specificity': 0.8713629, 'binary_f1_score': 0.46695098}
confusion matrix:
     0    1
0  569   84
1  416  219
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.644186, 'precision': 0.687135, 'recall': 0.644186, 'specificity': 0.644186, 'f1': 0.62252784, 'auroc': 0.7859816, 'binary_precision': 0.77678573, 'binary_recall': 0.40465117, 'binary_specificity': 0.88372093, 'binary_f1_score': 0.5321101}
confusion matrix:
     0   1
0  190  25
1  128  87
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-07-20 13:03:39.378471,epoch time: 0:01:45.011450,used: 0:05:21.463189,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_12_58_17_seed_0_22504807
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.87630206, 'precision': 0.8875961, 'recall': 0.8774808, 'specificity': 0.8774808, 'f1': 0.8756169, 'auroc': 0.94371974, 'binary_precision': 0.95726496, 'binary_recall': 0.79126525, 'binary_specificity': 0.96369636, 'binary_f1_score': 0.8663854}
confusion matrix:
      0     1
0  1460    55
1   325  1232
---- Validation: 
scalar performance:
{'acc': 0.64363354, 'precision': 0.676221, 'recall': 0.64051443, 'specificity': 0.64051443, 'f1': 0.623335, 'auroc': 0.77819395, 'binary_precision': 0.74858755, 'binary_recall': 0.41732284, 'binary_specificity': 0.863706, 'binary_f1_score': 0.5358949}
confusion matrix:
     0    1
0  564   89
1  370  265
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.67906976, 'precision': 0.7171148, 'recall': 0.67906976, 'specificity': 0.67906976, 'f1': 0.6643666, 'auroc': 0.8067496, 'binary_precision': 0.808, 'binary_recall': 0.46976745, 'binary_specificity': 0.88837206, 'binary_f1_score': 0.5941177}
confusion matrix:
     0    1
0  191   24
1  114  101
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-07-20 13:05:24.803946,epoch time: 0:01:45.425475,used: 0:07:06.888664,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_12_58_17_seed_0_22504807
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.898112, 'precision': 0.9024837, 'recall': 0.8988792, 'specificity': 0.8988792, 'f1': 0.897943, 'auroc': 0.956317, 'binary_precision': 0.94816417, 'binary_recall': 0.8453145, 'binary_specificity': 0.95244384, 'binary_f1_score': 0.8937903}
confusion matrix:
      0     1
0  1442    72
1   241  1317
---- Validation: 
scalar performance:
{'acc': 0.6964286, 'precision': 0.7084793, 'recall': 0.69466543, 'specificity': 0.69466543, 'f1': 0.690719, 'auroc': 0.7978705, 'binary_precision': 0.7552301, 'binary_recall': 0.5685039, 'binary_specificity': 0.82082695, 'binary_f1_score': 0.6486972}
confusion matrix:
     0    1
0  536  117
1  274  361
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.727907, 'precision': 0.7414955, 'recall': 0.72790694, 'specificity': 0.72790694, 'f1': 0.72402483, 'auroc': 0.8239481, 'binary_precision': 0.7987805, 'binary_recall': 0.60930234, 'binary_specificity': 0.8465116, 'binary_f1_score': 0.6912929}
confusion matrix:
     0    1
0  182   33
1   84  131
new oracle model saved
better model found
persisted
after epoch: 5,now: 2024-07-20 13:07:09.718606,epoch time: 0:01:44.914660,used: 0:08:51.803324,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_12_58_17_seed_0_22504807
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9091797, 'precision': 0.91609037, 'recall': 0.9099072, 'specificity': 0.9099072, 'f1': 0.9088974, 'auroc': 0.963753, 'binary_precision': 0.97255194, 'binary_recall': 0.8441726, 'binary_specificity': 0.97564185, 'binary_f1_score': 0.9038263}
confusion matrix:
      0     1
0  1482    37
1   242  1311
---- Validation: 
scalar performance:
{'acc': 0.69798136, 'precision': 0.7189884, 'recall': 0.69574106, 'specificity': 0.69574106, 'f1': 0.68898994, 'auroc': 0.8092221, 'binary_precision': 0.78341013, 'binary_recall': 0.53543305, 'binary_specificity': 0.856049, 'binary_f1_score': 0.6361086}
confusion matrix:
     0    1
0  559   94
1  295  340
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7348837, 'precision': 0.7561879, 'recall': 0.73488367, 'specificity': 0.73488367, 'f1': 0.7292551, 'auroc': 0.8360411, 'binary_precision': 0.83006537, 'binary_recall': 0.59069765, 'binary_specificity': 0.87906975, 'binary_f1_score': 0.6902174}
confusion matrix:
     0    1
0  189   26
1   88  127
new oracle model saved
better model found
persisted
after epoch: 6,now: 2024-07-20 13:08:54.932230,epoch time: 0:01:45.213624,used: 0:10:37.016948,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_12_58_17_seed_0_22504807
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.90234375, 'precision': 0.91079086, 'recall': 0.903247, 'specificity': 0.903247, 'f1': 0.9019687, 'auroc': 0.9656671, 'binary_precision': 0.9728711, 'binary_recall': 0.8302251, 'binary_specificity': 0.97626895, 'binary_f1_score': 0.8959056}
confusion matrix:
      0     1
0  1481    36
1   264  1291
---- Validation: 
scalar performance:
{'acc': 0.70729816, 'precision': 0.72941375, 'recall': 0.70505965, 'specificity': 0.70505965, 'f1': 0.6985841, 'auroc': 0.8198478, 'binary_precision': 0.797235, 'binary_recall': 0.5448819, 'binary_specificity': 0.86523736, 'binary_f1_score': 0.647334}
confusion matrix:
     0    1
0  565   88
1  289  346
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.75581396, 'precision': 0.7751536, 'recall': 0.75581396, 'specificity': 0.75581396, 'f1': 0.7514464, 'auroc': 0.84677124, 'binary_precision': 0.84810126, 'binary_recall': 0.6232558, 'binary_specificity': 0.88837206, 'binary_f1_score': 0.7184986}
confusion matrix:
     0    1
0  191   24
1   81  134
new oracle model saved
better model found
persisted
after epoch: 7,now: 2024-07-20 13:10:39.725666,epoch time: 0:01:44.793436,used: 0:12:21.810384,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_12_58_17_seed_0_22504807
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.91308594, 'precision': 0.92102945, 'recall': 0.9139546, 'specificity': 0.9139546, 'f1': 0.9127832, 'auroc': 0.972636, 'binary_precision': 0.98203593, 'binary_recall': 0.8437299, 'binary_specificity': 0.9841793, 'binary_f1_score': 0.90764445}
confusion matrix:
      0     1
0  1493    24
1   243  1312
---- Validation: 
scalar performance:
{'acc': 0.738354, 'precision': 0.7525792, 'recall': 0.7366425, 'specificity': 0.7366425, 'f1': 0.73365945, 'auroc': 0.82848394, 'binary_precision': 0.80912864, 'binary_recall': 0.61417323, 'binary_specificity': 0.8591118, 'binary_f1_score': 0.698299}
confusion matrix:
     0    1
0  561   92
1  245  390
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7790698, 'precision': 0.7885648, 'recall': 0.7790698, 'specificity': 0.7790698, 'f1': 0.7772373, 'auroc': 0.8593185, 'binary_precision': 0.84090906, 'binary_recall': 0.6883721, 'binary_specificity': 0.8697674, 'binary_f1_score': 0.7570332}
confusion matrix:
     0    1
0  187   28
1   67  148
new oracle model saved
better model found
persisted
after epoch: 8,now: 2024-07-20 13:12:24.707461,epoch time: 0:01:44.981795,used: 0:14:06.792179,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_12_58_17_seed_0_22504807
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9117839, 'precision': 0.9170482, 'recall': 0.9125362, 'specificity': 0.9125362, 'f1': 0.9115976, 'auroc': 0.9716893, 'binary_precision': 0.9672727, 'binary_recall': 0.85475576, 'binary_specificity': 0.97031665, 'binary_f1_score': 0.9075401}
confusion matrix:
      0     1
0  1471    45
1   226  1330
---- Validation: 
scalar performance:
{'acc': 0.7476708, 'precision': 0.75440586, 'recall': 0.746482, 'specificity': 0.746482, 'f1': 0.7453485, 'auroc': 0.83294785, 'binary_precision': 0.7924528, 'binary_recall': 0.6614173, 'binary_specificity': 0.8315467, 'binary_f1_score': 0.7210301}
confusion matrix:
     0    1
0  543  110
1  215  420
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7837209, 'precision': 0.78826714, 'recall': 0.7837209, 'specificity': 0.7837209, 'f1': 0.7828648, 'auroc': 0.8672796, 'binary_precision': 0.8244681, 'binary_recall': 0.7209302, 'binary_specificity': 0.8465116, 'binary_f1_score': 0.7692308}
confusion matrix:
     0    1
0  182   33
1   60  155
new oracle model saved
better model found
persisted
after epoch: 9,now: 2024-07-20 13:14:09.749934,epoch time: 0:01:45.042473,used: 0:15:51.834652,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_12_58_17_seed_0_22504807
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9274089, 'precision': 0.93166995, 'recall': 0.9280461, 'specificity': 0.9280461, 'f1': 0.9272923, 'auroc': 0.97934115, 'binary_precision': 0.97776186, 'binary_recall': 0.8765273, 'binary_specificity': 0.9795649, 'binary_f1_score': 0.92438114}
confusion matrix:
      0     1
0  1486    31
1   192  1363
---- Validation: 
scalar performance:
{'acc': 0.76940995, 'precision': 0.7703912, 'recall': 0.76894164, 'specificity': 0.76894164, 'f1': 0.7689575, 'auroc': 0.8408798, 'binary_precision': 0.78355706, 'binary_recall': 0.73543304, 'binary_specificity': 0.80245024, 'binary_f1_score': 0.7587328}
confusion matrix:
     0    1
0  524  129
1  168  467
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7976744, 'precision': 0.7979903, 'recall': 0.7976744, 'specificity': 0.7976744, 'f1': 0.7976208, 'auroc': 0.8752623, 'binary_precision': 0.8076923, 'binary_recall': 0.7813954, 'binary_specificity': 0.81395346, 'binary_f1_score': 0.7943262}
confusion matrix:
     0    1
0  175   40
1   47  168
new oracle model saved
better model found
persisted
after epoch: 10,now: 2024-07-20 13:15:54.592465,epoch time: 0:01:44.842531,used: 0:17:36.677183,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_12_58_17_seed_0_22504807
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.92317706, 'precision': 0.92942524, 'recall': 0.92398643, 'specificity': 0.92398643, 'f1': 0.9229835, 'auroc': 0.97756064, 'binary_precision': 0.9845815, 'binary_recall': 0.86182517, 'binary_specificity': 0.98614776, 'binary_f1_score': 0.91912264}
confusion matrix:
      0     1
0  1495    21
1   215  1341
---- Validation: 
scalar performance:
{'acc': 0.7740683, 'precision': 0.7792316, 'recall': 0.77308, 'specificity': 0.77308, 'f1': 0.7725568, 'auroc': 0.8477529, 'binary_precision': 0.81386864, 'binary_recall': 0.7023622, 'binary_specificity': 0.84379786, 'binary_f1_score': 0.7540152}
confusion matrix:
     0    1
0  551  102
1  189  446
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.80465114, 'precision': 0.80680156, 'recall': 0.80465114, 'specificity': 0.80465114, 'f1': 0.8043082, 'auroc': 0.88127637, 'binary_precision': 0.8324873, 'binary_recall': 0.7627907, 'binary_specificity': 0.8465116, 'binary_f1_score': 0.7961164}
confusion matrix:
     0    1
0  182   33
1   51  164
new oracle model saved
better model found
persisted
after epoch: 11,now: 2024-07-20 13:17:39.421751,epoch time: 0:01:44.829286,used: 0:19:21.506469,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_12_58_17_seed_0_22504807
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9264323, 'precision': 0.9317665, 'recall': 0.92721975, 'specificity': 0.92721975, 'f1': 0.9262835, 'auroc': 0.97902846, 'binary_precision': 0.98329705, 'binary_recall': 0.86962104, 'binary_specificity': 0.98481846, 'binary_f1_score': 0.922972}
confusion matrix:
      0     1
0  1492    23
1   203  1354
---- Validation: 
scalar performance:
{'acc': 0.7709627, 'precision': 0.77732587, 'recall': 0.7698653, 'specificity': 0.7698653, 'f1': 0.7691222, 'auroc': 0.8501863, 'binary_precision': 0.81598514, 'binary_recall': 0.6913386, 'binary_specificity': 0.848392, 'binary_f1_score': 0.7485081}
confusion matrix:
     0    1
0  554   99
1  196  439
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8116279, 'precision': 0.8131522, 'recall': 0.81162786, 'specificity': 0.81162786, 'f1': 0.8113984, 'auroc': 0.8838291, 'binary_precision': 0.835, 'binary_recall': 0.7767442, 'binary_specificity': 0.8465116, 'binary_f1_score': 0.8048193}
confusion matrix:
     0    1
0  182   33
1   48  167
new oracle model saved
early stop counter: 1
val acc:0.7709627151489258, best validation acc: 0.774068295955658, corresponding to test acc:                         0.804651141166687 / 0.8116279244422913
after epoch: 12,now: 2024-07-20 13:19:24.038988,epoch time: 0:01:44.617237,used: 0:21:06.123706,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_12_58_17_seed_0_22504807
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9319661, 'precision': 0.93638134, 'recall': 0.9326122, 'specificity': 0.9326122, 'f1': 0.9318533, 'auroc': 0.98051834, 'binary_precision': 0.983477, 'binary_recall': 0.8803859, 'binary_specificity': 0.9848385, 'binary_f1_score': 0.9290804}
confusion matrix:
      0     1
0  1494    23
1   186  1369
---- Validation: 
scalar performance:
{'acc': 0.7709627, 'precision': 0.77787626, 'recall': 0.7698219, 'specificity': 0.7698219, 'f1': 0.7689908, 'auroc': 0.8531478, 'binary_precision': 0.81835204, 'binary_recall': 0.68818897, 'binary_specificity': 0.8514548, 'binary_f1_score': 0.7476476}
confusion matrix:
     0    1
0  556   97
1  198  437
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.82325584, 'precision': 0.8246323, 'recall': 0.82325584, 'specificity': 0.82325584, 'f1': 0.82306826, 'auroc': 0.8895619, 'binary_precision': 0.84577113, 'binary_recall': 0.7906977, 'binary_specificity': 0.855814, 'binary_f1_score': 0.81730765}
confusion matrix:
     0    1
0  184   31
1   45  170
new oracle model saved
early stop counter: 2
val acc:0.7709627151489258, best validation acc: 0.774068295955658, corresponding to test acc:                         0.804651141166687 / 0.8232558369636536
after epoch: 13,now: 2024-07-20 13:21:08.906262,epoch time: 0:01:44.867274,used: 0:22:50.990980,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_12_58_17_seed_0_22504807
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.93359375, 'precision': 0.93777084, 'recall': 0.9343263, 'specificity': 0.9343263, 'f1': 0.933499, 'auroc': 0.98030114, 'binary_precision': 0.98426324, 'binary_recall': 0.88318354, 'binary_specificity': 0.985469, 'binary_f1_score': 0.93098783}
confusion matrix:
      0     1
0  1492    22
1   182  1376
---- Validation: 
scalar performance:
{'acc': 0.7996894, 'precision': 0.8014324, 'recall': 0.79912937, 'specificity': 0.79912937, 'f1': 0.7991621, 'auroc': 0.86217463, 'binary_precision': 0.8211244, 'binary_recall': 0.75905514, 'binary_specificity': 0.83920366, 'binary_f1_score': 0.78887075}
confusion matrix:
     0    1
0  548  105
1  153  482
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.82093024, 'precision': 0.8209927, 'recall': 0.82093024, 'specificity': 0.82093024, 'f1': 0.82092154, 'auroc': 0.89516497, 'binary_precision': 0.8254717, 'binary_recall': 0.81395346, 'binary_specificity': 0.82790697, 'binary_f1_score': 0.81967217}
confusion matrix:
     0    1
0  178   37
1   40  175
better model found
persisted
after epoch: 14,now: 2024-07-20 13:22:53.862782,epoch time: 0:01:44.956520,used: 0:24:35.947500,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_12_58_17_seed_0_22504807
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.930013, 'precision': 0.9334132, 'recall': 0.93061584, 'specificity': 0.93061584, 'f1': 0.92993116, 'auroc': 0.9800911, 'binary_precision': 0.9751949, 'binary_recall': 0.88431877, 'binary_specificity': 0.9769129, 'binary_f1_score': 0.92753625}
confusion matrix:
      0     1
0  1481    35
1   180  1376
---- Validation: 
scalar performance:
{'acc': 0.79891306, 'precision': 0.8010304, 'recall': 0.7982986, 'specificity': 0.7982986, 'f1': 0.7983001, 'auroc': 0.8649769, 'binary_precision': 0.82302403, 'binary_recall': 0.7543307, 'binary_specificity': 0.84226644, 'binary_f1_score': 0.78718156}
confusion matrix:
     0    1
0  550  103
1  156  479
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8255814, 'precision': 0.8256448, 'recall': 0.82558143, 'specificity': 0.82558143, 'f1': 0.82557285, 'auroc': 0.8981503, 'binary_precision': 0.8301887, 'binary_recall': 0.81860465, 'binary_specificity': 0.83255816, 'binary_f1_score': 0.82435596}
confusion matrix:
     0    1
0  179   36
1   39  176
new oracle model saved
early stop counter: 1
val acc:0.7989130616188049, best validation acc: 0.7996894121170044, corresponding to test acc:                         0.8209302425384521 / 0.8255813717842102
after epoch: 15,now: 2024-07-20 13:24:38.636710,epoch time: 0:01:44.773928,used: 0:26:20.721428,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_12_58_17_seed_0_22504807
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.94628906, 'precision': 0.94874346, 'recall': 0.9468014, 'specificity': 0.9468014, 'f1': 0.94624984, 'auroc': 0.9843321, 'binary_precision': 0.9853454, 'binary_recall': 0.907455, 'binary_specificity': 0.98614776, 'binary_f1_score': 0.9447976}
confusion matrix:
      0     1
0  1495    21
1   144  1412
---- Validation: 
scalar performance:
{'acc': 0.7950311, 'precision': 0.79752445, 'recall': 0.7943616, 'specificity': 0.7943616, 'f1': 0.7943149, 'auroc': 0.8667953, 'binary_precision': 0.82149047, 'binary_recall': 0.7464567, 'binary_specificity': 0.84226644, 'binary_f1_score': 0.7821782}
confusion matrix:
     0    1
0  550  103
1  161  474
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.82093024, 'precision': 0.8212708, 'recall': 0.82093024, 'specificity': 0.82093024, 'f1': 0.8208828, 'auroc': 0.9005084, 'binary_precision': 0.8317308, 'binary_recall': 0.80465114, 'binary_specificity': 0.8372093, 'binary_f1_score': 0.81796694}
confusion matrix:
     0    1
0  180   35
1   42  173
early stop counter: 2
val acc:0.7950310707092285, best validation acc: 0.7996894121170044, corresponding to test acc:                         0.8209302425384521 / 0.8255813717842102
after epoch: 16,now: 2024-07-20 13:26:23.357273,epoch time: 0:01:44.720563,used: 0:28:05.441991,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_12_58_17_seed_0_22504807
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9401042, 'precision': 0.9434186, 'recall': 0.940696, 'specificity': 0.940696, 'f1': 0.9400381, 'auroc': 0.98320484, 'binary_precision': 0.9851485, 'binary_recall': 0.89524424, 'binary_specificity': 0.98614776, 'binary_f1_score': 0.9380471}
confusion matrix:
      0     1
0  1495    21
1   163  1393
---- Validation: 
scalar performance:
{'acc': 0.79736024, 'precision': 0.7981727, 'recall': 0.79696256, 'specificity': 0.79696256, 'f1': 0.7970421, 'auroc': 0.86759114, 'binary_precision': 0.8106312, 'binary_recall': 0.76850396, 'binary_specificity': 0.82542115, 'binary_f1_score': 0.7890057}
confusion matrix:
     0    1
0  539  114
1  147  488
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.83255816, 'precision': 0.8325869, 'recall': 0.83255816, 'specificity': 0.83255816, 'f1': 0.8325545, 'auroc': 0.900941, 'binary_precision': 0.8294931, 'binary_recall': 0.8372093, 'binary_specificity': 0.82790697, 'binary_f1_score': 0.8333333}
confusion matrix:
     0    1
0  178   37
1   35  180
new oracle model saved
early stop counter: 3
val acc:0.7973602414131165, best validation acc: 0.7996894121170044, corresponding to test acc:                         0.8209302425384521 / 0.8325581550598145
after epoch: 17,now: 2024-07-20 13:28:07.941021,epoch time: 0:01:44.583748,used: 0:29:50.025739,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_12_58_17_seed_0_22504807
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9436849, 'precision': 0.9466997, 'recall': 0.94421995, 'specificity': 0.94421995, 'f1': 0.94362867, 'auroc': 0.98640656, 'binary_precision': 0.9866197, 'binary_recall': 0.9009646, 'binary_specificity': 0.9874753, 'binary_f1_score': 0.94184875}
confusion matrix:
      0     1
0  1498    19
1   154  1401
---- Validation: 
scalar performance:
{'acc': 0.7795031, 'precision': 0.7880472, 'recall': 0.7782663, 'specificity': 0.7782663, 'f1': 0.7773037, 'auroc': 0.8652253, 'binary_precision': 0.83428574, 'binary_recall': 0.6897638, 'binary_specificity': 0.8667688, 'binary_f1_score': 0.75517243}
confusion matrix:
     0    1
0  566   87
1  197  438
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.83488375, 'precision': 0.8369906, 'recall': 0.8348837, 'specificity': 0.8348837, 'f1': 0.83462524, 'auroc': 0.90165496, 'binary_precision': 0.8636364, 'binary_recall': 0.7953488, 'binary_specificity': 0.8744186, 'binary_f1_score': 0.82808715}
confusion matrix:
     0    1
0  188   27
1   44  171
new oracle model saved
early stop counter: 4
val acc:0.7795031070709229, best validation acc: 0.7996894121170044, corresponding to test acc:                         0.8209302425384521 / 0.8348837494850159
after epoch: 18,now: 2024-07-20 13:29:52.845125,epoch time: 0:01:44.904104,used: 0:31:34.929843,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_12_58_17_seed_0_22504807
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.945638, 'precision': 0.9477534, 'recall': 0.9461163, 'specificity': 0.9461163, 'f1': 0.94560564, 'auroc': 0.9863678, 'binary_precision': 0.98195696, 'binary_recall': 0.90938306, 'binary_specificity': 0.9828496, 'binary_f1_score': 0.94427764}
confusion matrix:
      0     1
0  1490    26
1   141  1415
---- Validation: 
scalar performance:
{'acc': 0.79658383, 'precision': 0.79983675, 'recall': 0.79582787, 'specificity': 0.79582787, 'f1': 0.795715, 'auroc': 0.86980504, 'binary_precision': 0.827768, 'binary_recall': 0.7417323, 'binary_specificity': 0.84992343, 'binary_f1_score': 0.782392}
confusion matrix:
     0    1
0  555   98
1  164  471
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.82790697, 'precision': 0.82816255, 'recall': 0.82790697, 'specificity': 0.82790697, 'f1': 0.82787347, 'auroc': 0.904251, 'binary_precision': 0.83732057, 'binary_recall': 0.81395346, 'binary_specificity': 0.8418605, 'binary_f1_score': 0.8254717}
confusion matrix:
     0    1
0  181   34
1   40  175
early stop counter: 5
val acc:0.7965838313102722, best validation acc: 0.7996894121170044, corresponding to test acc:                         0.8209302425384521 / 0.8348837494850159
after epoch: 19,now: 2024-07-20 13:31:37.309607,epoch time: 0:01:44.464482,used: 0:33:19.394325,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_12_58_17_seed_0_22504807
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 19 with time: 0:33:19.394325 at 2024-07-20 13:31:37.309607
persisted model performance metric: 

scalar performance:
{'acc': 0.82093024, 'precision': 0.8209927, 'recall': 0.82093024, 'specificity': 0.82093024, 'f1': 0.82092154, 'auroc': 0.89516497, 'binary_precision': 0.8254717, 'binary_recall': 0.81395346, 'binary_specificity': 0.82790697, 'binary_f1_score': 0.81967217}
confusion matrix:
     0    1
0  178   37
1   40  175
oracle model performance metric: 

scalar performance:
{'acc': 0.83488375, 'precision': 0.8369906, 'recall': 0.8348837, 'specificity': 0.8348837, 'f1': 0.83462524, 'auroc': 0.90165496, 'binary_precision': 0.8636364, 'binary_recall': 0.7953488, 'binary_specificity': 0.8744186, 'binary_f1_score': 0.82808715}
confusion matrix:
     0    1
0  188   27
1   44  171
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_halffreezeblocks_2024-07-20_12-47-21/rule_results/6.csv
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_halffreezeblocks_2024-07-20_12-47-21/rule_results/6.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_halffreezeblocks_2024-07-20_12-47-21/confusion_matrix/6.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 197058 KiB |   4046 MiB | 105099 GiB | 105098 GiB |
|       from large pool | 180662 KiB |   4027 MiB | 103889 GiB | 103889 GiB |
|       from small pool |  16396 KiB |     32 MiB |   1209 GiB |   1209 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 197058 KiB |   4046 MiB | 105099 GiB | 105098 GiB |
|       from large pool | 180662 KiB |   4027 MiB | 103889 GiB | 103889 GiB |
|       from small pool |  16396 KiB |     32 MiB |   1209 GiB |   1209 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 195188 KiB |   4045 MiB | 105092 GiB | 105091 GiB |
|       from large pool | 178979 KiB |   4026 MiB | 103883 GiB | 103883 GiB |
|       from small pool |  16209 KiB |     32 MiB |   1208 GiB |   1208 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   4434 MiB |   4434 MiB |   4434 MiB |      0 B   |
|       from large pool |   4396 MiB |   4396 MiB |   4396 MiB |      0 B   |
|       from small pool |     38 MiB |     38 MiB |     38 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |  52798 KiB | 392988 KiB |  54831 GiB |  54831 GiB |
|       from large pool |  50762 KiB | 392048 KiB |  53580 GiB |  53580 GiB |
|       from small pool |   2036 KiB |   7624 KiB |   1251 GiB |   1251 GiB |
|---------------------------------------------------------------------------|
| Allocations           |     788    |    1159    |   14081 K  |   14080 K  |
|       from large pool |      79    |     423    |    9520 K  |    9520 K  |
|       from small pool |     709    |    1005    |    4560 K  |    4559 K  |
|---------------------------------------------------------------------------|
| Active allocs         |     788    |    1159    |   14081 K  |   14080 K  |
|       from large pool |      79    |     423    |    9520 K  |    9520 K  |
|       from small pool |     709    |    1005    |    4560 K  |    4559 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     201    |     201    |     201    |       0    |
|       from large pool |     182    |     182    |     182    |       0    |
|       from small pool |      19    |      19    |      19    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      36    |     218    |   10118 K  |   10118 K  |
|       from large pool |      10    |     183    |    7445 K  |    7445 K  |
|       from small pool |      26    |     208    |    2672 K  |    2672 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   4046 MiB | 105099 GiB | 105099 GiB |
|       from large pool |  16640 KiB |   4027 MiB | 103889 GiB | 103889 GiB |
|       from small pool |      0 KiB |     32 MiB |   1209 GiB |   1209 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   4046 MiB | 105099 GiB | 105099 GiB |
|       from large pool |  16640 KiB |   4027 MiB | 103889 GiB | 103889 GiB |
|       from small pool |      0 KiB |     32 MiB |   1209 GiB |   1209 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   4045 MiB | 105092 GiB | 105092 GiB |
|       from large pool |  16640 KiB |   4026 MiB | 103883 GiB | 103883 GiB |
|       from small pool |      0 KiB |     32 MiB |   1208 GiB |   1208 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 249856 KiB |   4434 MiB |   4434 MiB |   4190 MiB |
|       from large pool | 231424 KiB |   4396 MiB |   4396 MiB |   4170 MiB |
|       from small pool |  18432 KiB |     38 MiB |     38 MiB |     20 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  30464 KiB | 392988 KiB |  54831 GiB |  54831 GiB |
|       from large pool |  30464 KiB | 392048 KiB |  53580 GiB |  53580 GiB |
|       from small pool |      0 KiB |  11194 KiB |   1251 GiB |   1251 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    1159    |   14081 K  |   14081 K  |
|       from large pool |       2    |     423    |    9520 K  |    9520 K  |
|       from small pool |       0    |    1005    |    4560 K  |    4560 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    1159    |   14081 K  |   14081 K  |
|       from large pool |       2    |     423    |    9520 K  |    9520 K  |
|       from small pool |       0    |    1005    |    4560 K  |    4560 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      20    |     201    |     201    |     181    |
|       from large pool |      11    |     182    |     182    |     171    |
|       from small pool |       9    |      19    |      19    |      10    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     218    |   10118 K  |   10118 K  |
|       from large pool |       3    |     183    |    7445 K  |    7445 K  |
|       from small pool |       0    |     208    |    2672 K  |    2672 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   4046 MiB | 105099 GiB | 105099 GiB |
|       from large pool |  16640 KiB |   4027 MiB | 103889 GiB | 103889 GiB |
|       from small pool |      0 KiB |     32 MiB |   1209 GiB |   1209 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   4046 MiB | 105099 GiB | 105099 GiB |
|       from large pool |  16640 KiB |   4027 MiB | 103889 GiB | 103889 GiB |
|       from small pool |      0 KiB |     32 MiB |   1209 GiB |   1209 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   4045 MiB | 105092 GiB | 105092 GiB |
|       from large pool |  16640 KiB |   4026 MiB | 103883 GiB | 103883 GiB |
|       from small pool |      0 KiB |     32 MiB |   1208 GiB |   1208 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 249856 KiB |   4434 MiB |   4434 MiB |   4190 MiB |
|       from large pool | 231424 KiB |   4396 MiB |   4396 MiB |   4170 MiB |
|       from small pool |  18432 KiB |     38 MiB |     38 MiB |     20 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  30464 KiB | 392988 KiB |  54831 GiB |  54831 GiB |
|       from large pool |  30464 KiB | 392048 KiB |  53580 GiB |  53580 GiB |
|       from small pool |      0 KiB |  11194 KiB |   1251 GiB |   1251 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    1159    |   14081 K  |   14081 K  |
|       from large pool |       2    |     423    |    9520 K  |    9520 K  |
|       from small pool |       0    |    1005    |    4560 K  |    4560 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    1159    |   14081 K  |   14081 K  |
|       from large pool |       2    |     423    |    9520 K  |    9520 K  |
|       from small pool |       0    |    1005    |    4560 K  |    4560 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      20    |     201    |     201    |     181    |
|       from large pool |      11    |     182    |     182    |     171    |
|       from small pool |       9    |      19    |      19    |      10    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     218    |   10118 K  |   10118 K  |
|       from large pool |       3    |     183    |    7445 K  |    7445 K  |
|       from small pool |       0    |     208    |    2672 K  |    2672 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'888c1ef2'
model name: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_13_32_33_seed_1_22504807

 Experiment start at: 2024-07-20 13:32:33.915532
before training, model accuracy: 0.6177777647972107
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.7281901, 'precision': 0.72837865, 'recall': 0.72799444, 'specificity': 0.72799444, 'f1': 0.728001, 'auroc': 0.78827405, 'binary_precision': 0.72392255, 'binary_recall': 0.74677837, 'binary_specificity': 0.7092105, 'binary_f1_score': 0.73517287}
confusion matrix:
      0     1
0  1078   442
1   393  1159
---- Validation: 
scalar performance:
{'acc': 0.49726775, 'precision': 0.47940642, 'recall': 0.49109063, 'specificity': 0.49109063, 'f1': 0.40985987, 'auroc': 0.6467071, 'binary_precision': 0.4556962, 'binary_recall': 0.114285715, 'binary_specificity': 0.86789554, 'binary_f1_score': 0.1827411}
confusion matrix:
     0   1
0  565  86
1  558  72
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.52, 'precision': 0.5451989, 'recall': 0.52, 'specificity': 0.52, 'f1': 0.44226402, 'auroc': 0.6802963, 'binary_precision': 0.57894737, 'binary_recall': 0.14666666, 'binary_specificity': 0.8933333, 'binary_f1_score': 0.23404256}
confusion matrix:
     0   1
0  201  24
1  192  33
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-20 13:34:21.269844,epoch time: 0:01:47.354312,used: 0:01:47.354312,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_13_32_33_seed_1_22504807
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.80338544, 'precision': 0.8044933, 'recall': 0.80378485, 'specificity': 0.80378485, 'f1': 0.80332005, 'auroc': 0.8844291, 'binary_precision': 0.8265936, 'binary_recall': 0.7745665, 'binary_specificity': 0.8330033, 'binary_f1_score': 0.7997348}
confusion matrix:
      0     1
0  1262   253
1   351  1206
---- Validation: 
scalar performance:
{'acc': 0.52380955, 'precision': 0.5403936, 'recall': 0.51766515, 'specificity': 0.51766515, 'f1': 0.44180214, 'auroc': 0.6847731, 'binary_precision': 0.5625, 'binary_recall': 0.14285715, 'binary_specificity': 0.8924731, 'binary_f1_score': 0.22784813}
confusion matrix:
     0   1
0  581  70
1  540  90
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.52666664, 'precision': 0.5675, 'recall': 0.52666664, 'specificity': 0.52666664, 'f1': 0.44232723, 'auroc': 0.6866173, 'binary_precision': 0.62, 'binary_recall': 0.13777778, 'binary_specificity': 0.91555554, 'binary_f1_score': 0.22545452}
confusion matrix:
     0   1
0  206  19
1  194  31
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-07-20 13:36:05.794512,epoch time: 0:01:44.524668,used: 0:03:31.878980,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_13_32_33_seed_1_22504807
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.84472656, 'precision': 0.8488362, 'recall': 0.8454336, 'specificity': 0.8454336, 'f1': 0.844435, 'auroc': 0.9159293, 'binary_precision': 0.890094, 'binary_recall': 0.7911311, 'binary_specificity': 0.89973617, 'binary_f1_score': 0.8376999}
confusion matrix:
      0     1
0  1364   152
1   325  1231
---- Validation: 
scalar performance:
{'acc': 0.5604996, 'precision': 0.60877085, 'recall': 0.5547363, 'specificity': 0.5547363, 'f1': 0.49478498, 'auroc': 0.72103727, 'binary_precision': 0.67724866, 'binary_recall': 0.2031746, 'binary_specificity': 0.906298, 'binary_f1_score': 0.3125763}
confusion matrix:
     0    1
0  590   61
1  502  128
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.54444444, 'precision': 0.59615386, 'recall': 0.54444444, 'specificity': 0.54444444, 'f1': 0.47368422, 'auroc': 0.712237, 'binary_precision': 0.6666667, 'binary_recall': 0.17777778, 'binary_specificity': 0.9111111, 'binary_f1_score': 0.28070176}
confusion matrix:
     0   1
0  205  20
1  185  40
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-07-20 13:37:50.838544,epoch time: 0:01:45.044032,used: 0:05:16.923012,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_13_32_33_seed_1_22504807
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.86783856, 'precision': 0.872361, 'recall': 0.8685271, 'specificity': 0.8685271, 'f1': 0.86757135, 'auroc': 0.9371034, 'binary_precision': 0.91660625, 'binary_recall': 0.81286174, 'binary_specificity': 0.9241925, 'binary_f1_score': 0.8616224}
confusion matrix:
      0     1
0  1402   115
1   291  1264
---- Validation: 
scalar performance:
{'acc': 0.58860266, 'precision': 0.64779896, 'recall': 0.58320534, 'specificity': 0.58320534, 'f1': 0.5352577, 'auroc': 0.74860895, 'binary_precision': 0.7373272, 'binary_recall': 0.25396827, 'binary_specificity': 0.9124424, 'binary_f1_score': 0.37780404}
confusion matrix:
     0    1
0  594   57
1  470  160
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.55333334, 'precision': 0.6122381, 'recall': 0.55333334, 'specificity': 0.55333334, 'f1': 0.48587796, 'auroc': 0.74192595, 'binary_precision': 0.6935484, 'binary_recall': 0.19111112, 'binary_specificity': 0.91555554, 'binary_f1_score': 0.29965156}
confusion matrix:
     0   1
0  206  19
1  182  43
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-07-20 13:39:35.509877,epoch time: 0:01:44.671333,used: 0:07:01.594345,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_13_32_33_seed_1_22504807
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.88671875, 'precision': 0.892493, 'recall': 0.887522, 'specificity': 0.887522, 'f1': 0.88643336, 'auroc': 0.9480575, 'binary_precision': 0.9434655, 'binary_recall': 0.82583547, 'binary_specificity': 0.94920844, 'binary_f1_score': 0.8807402}
confusion matrix:
      0     1
0  1439    77
1   271  1285
---- Validation: 
scalar performance:
{'acc': 0.60655737, 'precision': 0.6753932, 'recall': 0.60125446, 'specificity': 0.60125446, 'f1': 0.55737704, 'auroc': 0.77518594, 'binary_precision': 0.78125, 'binary_recall': 0.2777778, 'binary_specificity': 0.9247312, 'binary_f1_score': 0.40983608}
confusion matrix:
     0    1
0  602   49
1  455  175
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5711111, 'precision': 0.6420455, 'recall': 0.5711111, 'specificity': 0.5711111, 'f1': 0.5099284, 'auroc': 0.7819062, 'binary_precision': 0.74242425, 'binary_recall': 0.21777777, 'binary_specificity': 0.92444444, 'binary_f1_score': 0.33676976}
confusion matrix:
     0   1
0  208  17
1  176  49
new oracle model saved
better model found
persisted
after epoch: 5,now: 2024-07-20 13:41:20.306284,epoch time: 0:01:44.796407,used: 0:08:46.390752,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_13_32_33_seed_1_22504807
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.8938802, 'precision': 0.89769673, 'recall': 0.89450026, 'specificity': 0.89450026, 'f1': 0.89371806, 'auroc': 0.95578134, 'binary_precision': 0.93987113, 'binary_recall': 0.844373, 'binary_specificity': 0.9446276, 'binary_f1_score': 0.8895664}
confusion matrix:
      0     1
0  1433    84
1   242  1313
---- Validation: 
scalar performance:
{'acc': 0.62217015, 'precision': 0.6910093, 'recall': 0.6171019, 'specificity': 0.6171019, 'f1': 0.57928175, 'auroc': 0.79038835, 'binary_precision': 0.8016529, 'binary_recall': 0.30793652, 'binary_specificity': 0.92626727, 'binary_f1_score': 0.44495413}
confusion matrix:
     0    1
0  603   48
1  436  194
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5822222, 'precision': 0.648, 'recall': 0.5822222, 'specificity': 0.5822222, 'f1': 0.53000003, 'auroc': 0.7972741, 'binary_precision': 0.74666667, 'binary_recall': 0.2488889, 'binary_specificity': 0.91555554, 'binary_f1_score': 0.37333333}
confusion matrix:
     0   1
0  206  19
1  169  56
new oracle model saved
better model found
persisted
after epoch: 6,now: 2024-07-20 13:43:05.516782,epoch time: 0:01:45.210498,used: 0:10:31.601250,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_13_32_33_seed_1_22504807
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.90559894, 'precision': 0.9079642, 'recall': 0.90603423, 'specificity': 0.90603423, 'f1': 0.90551794, 'auroc': 0.962368, 'binary_precision': 0.9419174, 'binary_recall': 0.8667096, 'binary_specificity': 0.9453588, 'binary_f1_score': 0.90274984}
confusion matrix:
      0     1
0  1436    83
1   207  1346
---- Validation: 
scalar performance:
{'acc': 0.6627635, 'precision': 0.7208104, 'recall': 0.6584486, 'specificity': 0.6584486, 'f1': 0.635389, 'auroc': 0.8043084, 'binary_precision': 0.83, 'binary_recall': 0.3952381, 'binary_specificity': 0.921659, 'binary_f1_score': 0.53548384}
confusion matrix:
     0    1
0  600   51
1  381  249
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6311111, 'precision': 0.6910127, 'recall': 0.63111115, 'specificity': 0.63111115, 'f1': 0.5997299, 'auroc': 0.81706667, 'binary_precision': 0.7979798, 'binary_recall': 0.3511111, 'binary_specificity': 0.9111111, 'binary_f1_score': 0.4876543}
confusion matrix:
     0   1
0  205  20
1  146  79
new oracle model saved
better model found
persisted
after epoch: 7,now: 2024-07-20 13:44:50.306707,epoch time: 0:01:44.789925,used: 0:12:16.391175,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_13_32_33_seed_1_22504807
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9036458, 'precision': 0.90984744, 'recall': 0.90454936, 'specificity': 0.90454936, 'f1': 0.90340304, 'auroc': 0.9594669, 'binary_precision': 0.9639706, 'binary_recall': 0.8414634, 'binary_specificity': 0.9676354, 'binary_f1_score': 0.89856064}
confusion matrix:
      0     1
0  1465    49
1   247  1311
---- Validation: 
scalar performance:
{'acc': 0.66432476, 'precision': 0.72102433, 'recall': 0.6600614, 'specificity': 0.6600614, 'f1': 0.63774335, 'auroc': 0.81329095, 'binary_precision': 0.82894737, 'binary_recall': 0.4, 'binary_specificity': 0.92012286, 'binary_f1_score': 0.53961456}
confusion matrix:
     0    1
0  599   52
1  378  252
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6422222, 'precision': 0.70283973, 'recall': 0.6422222, 'specificity': 0.6422222, 'f1': 0.613334, 'auroc': 0.8309531, 'binary_precision': 0.8137255, 'binary_recall': 0.36888888, 'binary_specificity': 0.91555554, 'binary_f1_score': 0.5076453}
confusion matrix:
     0   1
0  206  19
1  142  83
new oracle model saved
better model found
persisted
after epoch: 8,now: 2024-07-20 13:46:34.944429,epoch time: 0:01:44.637722,used: 0:14:01.028897,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_13_32_33_seed_1_22504807
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9111328, 'precision': 0.9148066, 'recall': 0.91176635, 'specificity': 0.91176635, 'f1': 0.9110124, 'auroc': 0.9651222, 'binary_precision': 0.9572345, 'binary_recall': 0.86311054, 'binary_specificity': 0.96042216, 'binary_f1_score': 0.9077391}
confusion matrix:
      0     1
0  1456    60
1   213  1343
---- Validation: 
scalar performance:
{'acc': 0.68930525, 'precision': 0.73780394, 'recall': 0.6855095, 'specificity': 0.6855095, 'f1': 0.66984534, 'auroc': 0.8175871, 'binary_precision': 0.84117645, 'binary_recall': 0.45396826, 'binary_specificity': 0.9170507, 'binary_f1_score': 0.58969074}
confusion matrix:
     0    1
0  597   54
1  344  286
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.66888887, 'precision': 0.71366453, 'recall': 0.6688889, 'specificity': 0.6688889, 'f1': 0.6505829, 'auroc': 0.83672094, 'binary_precision': 0.8114754, 'binary_recall': 0.44, 'binary_specificity': 0.8977778, 'binary_f1_score': 0.5706052}
confusion matrix:
     0   1
0  202  23
1  126  99
new oracle model saved
better model found
persisted
after epoch: 9,now: 2024-07-20 13:48:19.756234,epoch time: 0:01:44.811805,used: 0:15:45.840702,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_13_32_33_seed_1_22504807
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.91471356, 'precision': 0.9209409, 'recall': 0.9154021, 'specificity': 0.9154021, 'f1': 0.9144816, 'auroc': 0.9700285, 'binary_precision': 0.9749816, 'binary_recall': 0.8531874, 'binary_specificity': 0.97761685, 'binary_f1_score': 0.9100275}
confusion matrix:
      0     1
0  1485    34
1   228  1325
---- Validation: 
scalar performance:
{'acc': 0.6541764, 'precision': 0.7216898, 'recall': 0.6495392, 'specificity': 0.6495392, 'f1': 0.62157327, 'auroc': 0.8267232, 'binary_precision': 0.84, 'binary_recall': 0.36666667, 'binary_specificity': 0.9324117, 'binary_f1_score': 0.5104972}
confusion matrix:
     0    1
0  607   44
1  399  231
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6533333, 'precision': 0.7233877, 'recall': 0.6533333, 'specificity': 0.6533333, 'f1': 0.6238426, 'auroc': 0.84669626, 'binary_precision': 0.8484849, 'binary_recall': 0.37333333, 'binary_specificity': 0.93333334, 'binary_f1_score': 0.5185185}
confusion matrix:
     0   1
0  210  15
1  141  84
early stop counter: 1
val acc:0.6541764140129089, best validation acc: 0.6893052458763123, corresponding to test acc:                         0.6688888669013977 / 0.6688888669013977
after epoch: 10,now: 2024-07-20 13:50:04.010561,epoch time: 0:01:44.254327,used: 0:17:30.095029,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_13_32_33_seed_1_22504807
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9202474, 'precision': 0.9250215, 'recall': 0.9209238, 'specificity': 0.9209238, 'f1': 0.92009765, 'auroc': 0.97574925, 'binary_precision': 0.9732659, 'binary_recall': 0.86623794, 'binary_specificity': 0.9756098, 'binary_f1_score': 0.9166383}
confusion matrix:
      0     1
0  1480    37
1   208  1347
---- Validation: 
scalar performance:
{'acc': 0.7064793, 'precision': 0.75022393, 'recall': 0.7029698, 'specificity': 0.7029698, 'f1': 0.6907386, 'auroc': 0.8369249, 'binary_precision': 0.8508287, 'binary_recall': 0.4888889, 'binary_specificity': 0.9170507, 'binary_f1_score': 0.62096775}
confusion matrix:
     0    1
0  597   54
1  322  308
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.70666665, 'precision': 0.7503649, 'recall': 0.70666665, 'specificity': 0.70666665, 'f1': 0.6932832, 'auroc': 0.8626765, 'binary_precision': 0.8549618, 'binary_recall': 0.4977778, 'binary_specificity': 0.91555554, 'binary_f1_score': 0.6292135}
confusion matrix:
     0    1
0  206   19
1  113  112
new oracle model saved
better model found
persisted
after epoch: 11,now: 2024-07-20 13:51:48.615798,epoch time: 0:01:44.605237,used: 0:19:14.700266,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_13_32_33_seed_1_22504807
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.93619794, 'precision': 0.9378811, 'recall': 0.936607, 'specificity': 0.936607, 'f1': 0.93616843, 'auroc': 0.9810181, 'binary_precision': 0.9682977, 'binary_recall': 0.903537, 'binary_specificity': 0.969677, 'binary_f1_score': 0.934797}
confusion matrix:
      0     1
0  1471    46
1   150  1405
---- Validation: 
scalar performance:
{'acc': 0.7259953, 'precision': 0.76194036, 'recall': 0.7228879, 'specificity': 0.7228879, 'f1': 0.71441066, 'auroc': 0.84285474, 'binary_precision': 0.8549618, 'binary_recall': 0.53333336, 'binary_specificity': 0.9124424, 'binary_f1_score': 0.65689147}
confusion matrix:
     0    1
0  594   57
1  294  336
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7488889, 'precision': 0.7764128, 'recall': 0.7488889, 'specificity': 0.7488889, 'f1': 0.7424782, 'auroc': 0.8763259, 'binary_precision': 0.8636364, 'binary_recall': 0.5911111, 'binary_specificity': 0.9066667, 'binary_f1_score': 0.701847}
confusion matrix:
     0    1
0  204   21
1   92  133
new oracle model saved
better model found
persisted
after epoch: 12,now: 2024-07-20 13:53:33.422210,epoch time: 0:01:44.806412,used: 0:20:59.506678,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_13_32_33_seed_1_22504807
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9322917, 'precision': 0.9367058, 'recall': 0.93286705, 'specificity': 0.93286705, 'f1': 0.93217385, 'auroc': 0.9775131, 'binary_precision': 0.98346514, 'binary_recall': 0.8808757, 'binary_specificity': 0.98485845, 'binary_f1_score': 0.9293478}
confusion matrix:
      0     1
0  1496    23
1   185  1368
---- Validation: 
scalar performance:
{'acc': 0.71428573, 'precision': 0.7615515, 'recall': 0.7107271, 'specificity': 0.7107271, 'f1': 0.69851303, 'auroc': 0.84639746, 'binary_precision': 0.8687151, 'binary_recall': 0.4936508, 'binary_specificity': 0.9278034, 'binary_f1_score': 0.6295546}
confusion matrix:
     0    1
0  604   47
1  319  311
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.72888887, 'precision': 0.7748393, 'recall': 0.72888887, 'specificity': 0.72888887, 'f1': 0.71706283, 'auroc': 0.88128394, 'binary_precision': 0.88721806, 'binary_recall': 0.52444446, 'binary_specificity': 0.93333334, 'binary_f1_score': 0.6592179}
confusion matrix:
     0    1
0  210   15
1  107  118
early stop counter: 1
val acc:0.7142857313156128, best validation acc: 0.7259953022003174, corresponding to test acc:                         0.7488889098167419 / 0.7488889098167419
after epoch: 13,now: 2024-07-20 13:55:17.627048,epoch time: 0:01:44.204838,used: 0:22:43.711516,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_13_32_33_seed_1_22504807
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9404297, 'precision': 0.94258577, 'recall': 0.94093937, 'specificity': 0.94093937, 'f1': 0.94039416, 'auroc': 0.9822273, 'binary_precision': 0.9770833, 'binary_recall': 0.9036609, 'binary_specificity': 0.97821784, 'binary_f1_score': 0.9389389}
confusion matrix:
      0     1
0  1482    33
1   150  1407
---- Validation: 
scalar performance:
{'acc': 0.7220921, 'precision': 0.7621167, 'recall': 0.71881723, 'specificity': 0.71881723, 'f1': 0.70907164, 'auroc': 0.84840167, 'binary_precision': 0.8605263, 'binary_recall': 0.5190476, 'binary_specificity': 0.9185868, 'binary_f1_score': 0.6475248}
confusion matrix:
     0    1
0  598   53
1  303  327
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.75777775, 'precision': 0.7919724, 'recall': 0.7577778, 'specificity': 0.7577778, 'f1': 0.75047183, 'auroc': 0.8858667, 'binary_precision': 0.8918919, 'binary_recall': 0.58666664, 'binary_specificity': 0.9288889, 'binary_f1_score': 0.7077748}
confusion matrix:
     0    1
0  209   16
1   93  132
new oracle model saved
early stop counter: 2
val acc:0.7220920920372009, best validation acc: 0.7259953022003174, corresponding to test acc:                         0.7488889098167419 / 0.757777750492096
after epoch: 14,now: 2024-07-20 13:57:02.509364,epoch time: 0:01:44.882316,used: 0:24:28.593832,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_13_32_33_seed_1_22504807
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.93098956, 'precision': 0.9330286, 'recall': 0.9314381, 'specificity': 0.9314381, 'f1': 0.9309473, 'auroc': 0.9792932, 'binary_precision': 0.96599585, 'binary_recall': 0.8951768, 'binary_specificity': 0.9676994, 'binary_f1_score': 0.929239}
confusion matrix:
      0     1
0  1468    49
1   163  1392
---- Validation: 
scalar performance:
{'acc': 0.72677594, 'precision': 0.7646789, 'recall': 0.72360474, 'specificity': 0.72360474, 'f1': 0.7147524, 'auroc': 0.8519274, 'binary_precision': 0.86082476, 'binary_recall': 0.53015876, 'binary_specificity': 0.9170507, 'binary_f1_score': 0.6561886}
confusion matrix:
     0    1
0  597   54
1  296  334
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7822222, 'precision': 0.8087921, 'recall': 0.7822223, 'specificity': 0.7822223, 'f1': 0.7774346, 'auroc': 0.8920296, 'binary_precision': 0.8993711, 'binary_recall': 0.63555557, 'binary_specificity': 0.9288889, 'binary_f1_score': 0.7447917}
confusion matrix:
     0    1
0  209   16
1   82  143
new oracle model saved
better model found
persisted
after epoch: 15,now: 2024-07-20 13:58:47.490581,epoch time: 0:01:44.981217,used: 0:26:13.575049,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_13_32_33_seed_1_22504807
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.93847656, 'precision': 0.9400088, 'recall': 0.9389349, 'specificity': 0.9389349, 'f1': 0.9384554, 'auroc': 0.9833951, 'binary_precision': 0.96980095, 'binary_recall': 0.90693194, 'binary_specificity': 0.9709379, 'binary_f1_score': 0.93731344}
confusion matrix:
      0     1
0  1470    44
1   145  1413
---- Validation: 
scalar performance:
{'acc': 0.74004686, 'precision': 0.77203625, 'recall': 0.73717356, 'specificity': 0.73717356, 'f1': 0.7305902, 'auroc': 0.8564601, 'binary_precision': 0.8613139, 'binary_recall': 0.5619048, 'binary_specificity': 0.9124424, 'binary_f1_score': 0.6801153}
confusion matrix:
     0    1
0  594   57
1  276  354
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7911111, 'precision': 0.81033504, 'recall': 0.7911111, 'specificity': 0.7911111, 'f1': 0.7878252, 'auroc': 0.9005827, 'binary_precision': 0.88757396, 'binary_recall': 0.6666667, 'binary_specificity': 0.91555554, 'binary_f1_score': 0.7614213}
confusion matrix:
     0    1
0  206   19
1   75  150
new oracle model saved
better model found
persisted
after epoch: 16,now: 2024-07-20 14:00:32.455556,epoch time: 0:01:44.964975,used: 0:27:58.540024,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_13_32_33_seed_1_22504807
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9378255, 'precision': 0.9393908, 'recall': 0.93824315, 'specificity': 0.93824315, 'f1': 0.937801, 'auroc': 0.984319, 'binary_precision': 0.96907216, 'binary_recall': 0.90616965, 'binary_specificity': 0.97031665, 'binary_f1_score': 0.93656594}
confusion matrix:
      0     1
0  1471    45
1   146  1410
---- Validation: 
scalar performance:
{'acc': 0.7408275, 'precision': 0.77824426, 'recall': 0.73776245, 'specificity': 0.73776245, 'f1': 0.7301337, 'auroc': 0.85832053, 'binary_precision': 0.8762626, 'binary_recall': 0.55079365, 'binary_specificity': 0.9247312, 'binary_f1_score': 0.67641324}
confusion matrix:
     0    1
0  602   49
1  283  347
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.79555553, 'precision': 0.81659293, 'recall': 0.7955556, 'specificity': 0.7955556, 'f1': 0.79210186, 'auroc': 0.90212345, 'binary_precision': 0.8982036, 'binary_recall': 0.6666667, 'binary_specificity': 0.92444444, 'binary_f1_score': 0.7653061}
confusion matrix:
     0    1
0  208   17
1   75  150
new oracle model saved
better model found
persisted
after epoch: 17,now: 2024-07-20 14:02:17.410363,epoch time: 0:01:44.954807,used: 0:29:43.494831,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_13_32_33_seed_1_22504807
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.93684894, 'precision': 0.93977714, 'recall': 0.93737894, 'specificity': 0.93737894, 'f1': 0.9367872, 'auroc': 0.98115975, 'binary_precision': 0.9788881, 'binary_recall': 0.89453375, 'binary_specificity': 0.98022413, 'binary_f1_score': 0.9348118}
confusion matrix:
      0     1
0  1487    30
1   164  1391
---- Validation: 
scalar performance:
{'acc': 0.7369243, 'precision': 0.7786697, 'recall': 0.7336918, 'specificity': 0.7336918, 'f1': 0.72488254, 'auroc': 0.86039793, 'binary_precision': 0.88250655, 'binary_recall': 0.53650796, 'binary_specificity': 0.9308756, 'binary_f1_score': 0.66732484}
confusion matrix:
     0    1
0  606   45
1  292  338
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7888889, 'precision': 0.8134645, 'recall': 0.78888893, 'specificity': 0.78888893, 'f1': 0.7846684, 'auroc': 0.903842, 'binary_precision': 0.90123457, 'binary_recall': 0.6488889, 'binary_specificity': 0.9288889, 'binary_f1_score': 0.75452197}
confusion matrix:
     0    1
0  209   16
1   79  146
early stop counter: 1
val acc:0.7369242906570435, best validation acc: 0.7408275008201599, corresponding to test acc:                         0.7955555319786072 / 0.7955555319786072
after epoch: 18,now: 2024-07-20 14:04:02.343213,epoch time: 0:01:44.932850,used: 0:31:28.427681,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_13_32_33_seed_1_22504807
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9394531, 'precision': 0.9425888, 'recall': 0.93999964, 'specificity': 0.93999964, 'f1': 0.9393889, 'auroc': 0.985245, 'binary_precision': 0.9830628, 'binary_recall': 0.89581996, 'binary_specificity': 0.9841793, 'binary_f1_score': 0.9374159}
confusion matrix:
      0     1
0  1493    24
1   162  1393
---- Validation: 
scalar performance:
{'acc': 0.73224044, 'precision': 0.777161, 'recall': 0.7288787, 'specificity': 0.7288787, 'f1': 0.71900654, 'auroc': 0.8609538, 'binary_precision': 0.8847185, 'binary_recall': 0.52380955, 'binary_specificity': 0.9339478, 'binary_f1_score': 0.6580259}
confusion matrix:
     0    1
0  608   43
1  300  330
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7888889, 'precision': 0.8169975, 'recall': 0.7888889, 'specificity': 0.7888889, 'f1': 0.7841029, 'auroc': 0.9064691, 'binary_precision': 0.9113924, 'binary_recall': 0.64, 'binary_specificity': 0.93777776, 'binary_f1_score': 0.75195825}
confusion matrix:
     0    1
0  211   14
1   81  144
early stop counter: 2
val acc:0.7322404384613037, best validation acc: 0.7408275008201599, corresponding to test acc:                         0.7955555319786072 / 0.7955555319786072
after epoch: 19,now: 2024-07-20 14:05:47.053805,epoch time: 0:01:44.710592,used: 0:33:13.138273,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_13_32_33_seed_1_22504807
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.93652344, 'precision': 0.9392436, 'recall': 0.93712133, 'specificity': 0.93712133, 'f1': 0.93647254, 'auroc': 0.98360705, 'binary_precision': 0.97757536, 'binary_recall': 0.8953787, 'binary_specificity': 0.97886395, 'binary_f1_score': 0.93467337}
confusion matrix:
      0     1
0  1482    32
1   163  1395
---- Validation: 
scalar performance:
{'acc': 0.74473065, 'precision': 0.7839643, 'recall': 0.7416283, 'specificity': 0.7416283, 'f1': 0.7339382, 'auroc': 0.8658694, 'binary_precision': 0.8854962, 'binary_recall': 0.552381, 'binary_specificity': 0.9308756, 'binary_f1_score': 0.680352}
confusion matrix:
     0    1
0  606   45
1  282  348
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8066667, 'precision': 0.8261554, 'recall': 0.8066667, 'specificity': 0.8066667, 'f1': 0.8037348, 'auroc': 0.91259253, 'binary_precision': 0.90588236, 'binary_recall': 0.6844444, 'binary_specificity': 0.9288889, 'binary_f1_score': 0.7797468}
confusion matrix:
     0    1
0  209   16
1   71  154
new oracle model saved
better model found
persisted
after epoch: 20,now: 2024-07-20 14:07:32.181509,epoch time: 0:01:45.127704,used: 0:34:58.265977,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_13_32_33_seed_1_22504807
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.945638, 'precision': 0.9472072, 'recall': 0.94607747, 'specificity': 0.94607747, 'f1': 0.945618, 'auroc': 0.9869598, 'binary_precision': 0.97733516, 'binary_recall': 0.91393703, 'binary_specificity': 0.97821784, 'binary_f1_score': 0.9445735}
confusion matrix:
      0     1
0  1482    33
1   134  1423
---- Validation: 
scalar performance:
{'acc': 0.74395, 'precision': 0.78421825, 'recall': 0.740809, 'specificity': 0.740809, 'f1': 0.7328603, 'auroc': 0.8641918, 'binary_precision': 0.8871795, 'binary_recall': 0.5492064, 'binary_specificity': 0.9324117, 'binary_f1_score': 0.6784314}
confusion matrix:
     0    1
0  607   44
1  284  346
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.81777775, 'precision': 0.8372005, 'recall': 0.81777775, 'specificity': 0.81777775, 'f1': 0.8151154, 'auroc': 0.9148642, 'binary_precision': 0.91812867, 'binary_recall': 0.69777775, 'binary_specificity': 0.93777776, 'binary_f1_score': 0.79292923}
confusion matrix:
     0    1
0  211   14
1   68  157
new oracle model saved
early stop counter: 1
val acc:0.7439500093460083, best validation acc: 0.7447306513786316, corresponding to test acc:                         0.8066666722297668 / 0.8177777528762817
after epoch: 21,now: 2024-07-20 14:09:17.616325,epoch time: 0:01:45.434816,used: 0:36:43.700793,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_13_32_33_seed_1_22504807
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.95182294, 'precision': 0.9529109, 'recall': 0.95213675, 'specificity': 0.95213675, 'f1': 0.9518112, 'auroc': 0.9878943, 'binary_precision': 0.9782313, 'binary_recall': 0.92535394, 'binary_specificity': 0.9789196, 'binary_f1_score': 0.95105827}
confusion matrix:
      0     1
0  1486    32
1   116  1438
---- Validation: 
scalar performance:
{'acc': 0.7509758, 'precision': 0.78746104, 'recall': 0.74800307, 'specificity': 0.74800307, 'f1': 0.74127877, 'auroc': 0.8668617, 'binary_precision': 0.8858561, 'binary_recall': 0.56666666, 'binary_specificity': 0.92933947, 'binary_f1_score': 0.6911907}
confusion matrix:
     0    1
0  605   46
1  273  357
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8377778, 'precision': 0.85318905, 'recall': 0.8377778, 'specificity': 0.8377778, 'f1': 0.83598864, 'auroc': 0.92033577, 'binary_precision': 0.9269663, 'binary_recall': 0.73333335, 'binary_specificity': 0.94222224, 'binary_f1_score': 0.81885856}
confusion matrix:
     0    1
0  212   13
1   60  165
new oracle model saved
better model found
persisted
after epoch: 22,now: 2024-07-20 14:11:02.054204,epoch time: 0:01:44.437879,used: 0:38:28.138672,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_13_32_33_seed_1_22504807
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.94954425, 'precision': 0.9512321, 'recall': 0.94995135, 'specificity': 0.94995135, 'f1': 0.94952166, 'auroc': 0.98634636, 'binary_precision': 0.9820937, 'binary_recall': 0.9170418, 'binary_specificity': 0.9828609, 'binary_f1_score': 0.9484536}
confusion matrix:
      0     1
0  1491    26
1   129  1426
---- Validation: 
scalar performance:
{'acc': 0.7431694, 'precision': 0.7836914, 'recall': 0.7400154, 'specificity': 0.7400154, 'f1': 0.7319567, 'auroc': 0.8690927, 'binary_precision': 0.88688946, 'binary_recall': 0.54761904, 'binary_specificity': 0.9324117, 'binary_f1_score': 0.67713445}
confusion matrix:
     0    1
0  607   44
1  285  345
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8333333, 'precision': 0.8472222, 'recall': 0.8333334, 'specificity': 0.8333334, 'f1': 0.83164984, 'auroc': 0.92165923, 'binary_precision': 0.9166667, 'binary_recall': 0.73333335, 'binary_specificity': 0.93333334, 'binary_f1_score': 0.8148148}
confusion matrix:
     0    1
0  210   15
1   60  165
early stop counter: 1
val acc:0.7431694269180298, best validation acc: 0.7509757876396179, corresponding to test acc:                         0.8377777934074402 / 0.8377777934074402
after epoch: 23,now: 2024-07-20 14:12:46.339108,epoch time: 0:01:44.284904,used: 0:40:12.423576,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_13_32_33_seed_1_22504807
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9482422, 'precision': 0.94942564, 'recall': 0.94862866, 'specificity': 0.94862866, 'f1': 0.94823, 'auroc': 0.9899905, 'binary_precision': 0.976158, 'binary_recall': 0.9203597, 'binary_specificity': 0.9768977, 'binary_f1_score': 0.94743794}
confusion matrix:
      0     1
0  1480    35
1   124  1433
---- Validation: 
scalar performance:
{'acc': 0.76346606, 'precision': 0.79332554, 'recall': 0.7608039, 'specificity': 0.7608039, 'f1': 0.75600535, 'auroc': 0.87182844, 'binary_precision': 0.882904, 'binary_recall': 0.5984127, 'binary_specificity': 0.92319506, 'binary_f1_score': 0.7133396}
confusion matrix:
     0    1
0  601   50
1  253  377
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.84444445, 'precision': 0.85568583, 'recall': 0.84444445, 'specificity': 0.84444445, 'f1': 0.8432056, 'auroc': 0.92519504, 'binary_precision': 0.9189189, 'binary_recall': 0.75555557, 'binary_specificity': 0.93333334, 'binary_f1_score': 0.8292683}
confusion matrix:
     0    1
0  210   15
1   55  170
new oracle model saved
better model found
persisted
after epoch: 24,now: 2024-07-20 14:14:31.646533,epoch time: 0:01:45.307425,used: 0:41:57.731001,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_13_32_33_seed_1_22504807
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.9479167, 'precision': 0.94839025, 'recall': 0.9481622, 'specificity': 0.9481622, 'f1': 0.9479145, 'auroc': 0.9882191, 'binary_precision': 0.96657753, 'binary_recall': 0.9293059, 'binary_specificity': 0.9670185, 'binary_f1_score': 0.9475754}
confusion matrix:
      0     1
0  1466    50
1   110  1446
---- Validation: 
scalar performance:
{'acc': 0.77205306, 'precision': 0.79355, 'recall': 0.76979005, 'specificity': 0.76979005, 'f1': 0.76675856, 'auroc': 0.87201375, 'binary_precision': 0.8689956, 'binary_recall': 0.63174605, 'binary_specificity': 0.9078341, 'binary_f1_score': 0.7316176}
confusion matrix:
     0    1
0  591   60
1  232  398
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8488889, 'precision': 0.8543769, 'recall': 0.8488889, 'specificity': 0.8488889, 'f1': 0.84830153, 'auroc': 0.9254519, 'binary_precision': 0.89847714, 'binary_recall': 0.7866667, 'binary_specificity': 0.9111111, 'binary_f1_score': 0.83886254}
confusion matrix:
     0    1
0  205   20
1   48  177
new oracle model saved
better model found
persisted
after epoch: 25,now: 2024-07-20 14:16:16.371626,epoch time: 0:01:44.725093,used: 0:43:42.456094,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_13_32_33_seed_1_22504807
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.94433594, 'precision': 0.94648683, 'recall': 0.9448701, 'specificity': 0.9448701, 'f1': 0.9443046, 'auroc': 0.98839545, 'binary_precision': 0.98126304, 'binary_recall': 0.9075738, 'binary_specificity': 0.98216647, 'binary_f1_score': 0.94298106}
confusion matrix:
      0     1
0  1487    27
1   144  1414
---- Validation: 
scalar performance:
{'acc': 0.7431694, 'precision': 0.7813641, 'recall': 0.74009216, 'specificity': 0.74009216, 'f1': 0.73248553, 'auroc': 0.8714993, 'binary_precision': 0.8810127, 'binary_recall': 0.552381, 'binary_specificity': 0.9278034, 'binary_f1_score': 0.6790244}
confusion matrix:
     0    1
0  604   47
1  282  348
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8488889, 'precision': 0.8641077, 'recall': 0.8488889, 'specificity': 0.8488889, 'f1': 0.8472932, 'auroc': 0.92586666, 'binary_precision': 0.9385475, 'binary_recall': 0.74666667, 'binary_specificity': 0.95111114, 'binary_f1_score': 0.83168316}
confusion matrix:
     0    1
0  214   11
1   57  168
early stop counter: 1
val acc:0.7431694269180298, best validation acc: 0.772053062915802, corresponding to test acc:                         0.8488888740539551 / 0.8488888740539551
after epoch: 26,now: 2024-07-20 14:18:01.068368,epoch time: 0:01:44.696742,used: 0:45:27.152836,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_13_32_33_seed_1_22504807
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.953125, 'precision': 0.95457745, 'recall': 0.95350444, 'specificity': 0.95350444, 'f1': 0.9531083, 'auroc': 0.98870975, 'binary_precision': 0.98355037, 'binary_recall': 0.92282957, 'binary_specificity': 0.9841793, 'binary_f1_score': 0.95222294}
confusion matrix:
      0     1
0  1493    24
1   120  1435
---- Validation: 
scalar performance:
{'acc': 0.74473065, 'precision': 0.7831943, 'recall': 0.74165386, 'specificity': 0.74165386, 'f1': 0.73411167, 'auroc': 0.8736376, 'binary_precision': 0.8835443, 'binary_recall': 0.55396825, 'binary_specificity': 0.92933947, 'binary_f1_score': 0.68097556}
confusion matrix:
     0    1
0  605   46
1  281  349
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8488889, 'precision': 0.8641077, 'recall': 0.8488889, 'specificity': 0.8488889, 'f1': 0.8472932, 'auroc': 0.924721, 'binary_precision': 0.9385475, 'binary_recall': 0.74666667, 'binary_specificity': 0.95111114, 'binary_f1_score': 0.83168316}
confusion matrix:
     0    1
0  214   11
1   57  168
early stop counter: 2
val acc:0.7447306513786316, best validation acc: 0.772053062915802, corresponding to test acc:                         0.8488888740539551 / 0.8488888740539551
after epoch: 27,now: 2024-07-20 14:19:45.943715,epoch time: 0:01:44.875347,used: 0:47:12.028183,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_13_32_33_seed_1_22504807
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.95247394, 'precision': 0.95299065, 'recall': 0.95272875, 'specificity': 0.95272875, 'f1': 0.9524715, 'auroc': 0.9908432, 'binary_precision': 0.9718875, 'binary_recall': 0.933162, 'binary_specificity': 0.9722955, 'binary_f1_score': 0.9521311}
confusion matrix:
      0     1
0  1474    42
1   104  1452
---- Validation: 
scalar performance:
{'acc': 0.76112413, 'precision': 0.7916795, 'recall': 0.758423, 'specificity': 0.758423, 'f1': 0.7533798, 'auroc': 0.87189424, 'binary_precision': 0.8820755, 'binary_recall': 0.5936508, 'binary_specificity': 0.92319506, 'binary_f1_score': 0.70967746}
confusion matrix:
     0    1
0  601   50
1  256  374
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8466667, 'precision': 0.8552632, 'recall': 0.8466667, 'specificity': 0.8466667, 'f1': 0.8457334, 'auroc': 0.9261037, 'binary_precision': 0.91052634, 'binary_recall': 0.7688889, 'binary_specificity': 0.92444444, 'binary_f1_score': 0.8337349}
confusion matrix:
     0    1
0  208   17
1   52  173
early stop counter: 3
val acc:0.7611241340637207, best validation acc: 0.772053062915802, corresponding to test acc:                         0.8488888740539551 / 0.8488888740539551
after epoch: 28,now: 2024-07-20 14:21:30.676850,epoch time: 0:01:44.733135,used: 0:48:56.761318,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_13_32_33_seed_1_22504807
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.95214844, 'precision': 0.95388114, 'recall': 0.9525137, 'specificity': 0.9525137, 'f1': 0.9521243, 'auroc': 0.98977315, 'binary_precision': 0.9848276, 'binary_recall': 0.9195106, 'binary_specificity': 0.9855168, 'binary_f1_score': 0.951049}
confusion matrix:
      0     1
0  1497    22
1   125  1428
---- Validation: 
scalar performance:
{'acc': 0.75800157, 'precision': 0.792276, 'recall': 0.7551459, 'specificity': 0.7551459, 'f1': 0.7492739, 'auroc': 0.87709993, 'binary_precision': 0.88834953, 'binary_recall': 0.5809524, 'binary_specificity': 0.92933947, 'binary_f1_score': 0.7024952}
confusion matrix:
     0    1
0  605   46
1  264  366
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8511111, 'precision': 0.86317015, 'recall': 0.8511111, 'specificity': 0.8511111, 'f1': 0.84986484, 'auroc': 0.92693335, 'binary_precision': 0.9293478, 'binary_recall': 0.76, 'binary_specificity': 0.94222224, 'binary_f1_score': 0.8361858}
confusion matrix:
     0    1
0  212   13
1   54  171
new oracle model saved
early stop counter: 4
val acc:0.7580015659332275, best validation acc: 0.772053062915802, corresponding to test acc:                         0.8488888740539551 / 0.851111114025116
after epoch: 29,now: 2024-07-20 14:23:16.436341,epoch time: 0:01:45.759491,used: 0:50:42.520809,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_13_32_33_seed_1_22504807
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.94954425, 'precision': 0.95116025, 'recall': 0.9499433, 'specificity': 0.9499433, 'f1': 0.94952303, 'auroc': 0.98837185, 'binary_precision': 0.98143053, 'binary_recall': 0.9176849, 'binary_specificity': 0.9822017, 'binary_f1_score': 0.9484879}
confusion matrix:
      0     1
0  1490    27
1   128  1427
---- Validation: 
scalar performance:
{'acc': 0.765808, 'precision': 0.7962935, 'recall': 0.76313365, 'specificity': 0.76313365, 'f1': 0.7583529, 'auroc': 0.87611496, 'binary_precision': 0.8873239, 'binary_recall': 0.6, 'binary_specificity': 0.92626727, 'binary_f1_score': 0.71590906}
confusion matrix:
     0    1
0  603   48
1  252  378
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8622222, 'precision': 0.87173873, 'recall': 0.8622222, 'specificity': 0.8622222, 'f1': 0.86133474, 'auroc': 0.929758, 'binary_precision': 0.93121696, 'binary_recall': 0.7822222, 'binary_specificity': 0.94222224, 'binary_f1_score': 0.85024154}
confusion matrix:
     0    1
0  212   13
1   49  176
new oracle model saved
early stop counter: 5
val acc:0.7658079862594604, best validation acc: 0.772053062915802, corresponding to test acc:                         0.8488888740539551 / 0.8622221946716309
after epoch: 30,now: 2024-07-20 14:25:02.133049,epoch time: 0:01:45.696708,used: 0:52:28.217517,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_13_32_33_seed_1_22504807
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 30 with time: 0:52:28.217517 at 2024-07-20 14:25:02.133049
persisted model performance metric: 

scalar performance:
{'acc': 0.8488889, 'precision': 0.8543769, 'recall': 0.8488889, 'specificity': 0.8488889, 'f1': 0.84830153, 'auroc': 0.9254519, 'binary_precision': 0.89847714, 'binary_recall': 0.7866667, 'binary_specificity': 0.9111111, 'binary_f1_score': 0.83886254}
confusion matrix:
     0    1
0  205   20
1   48  177
oracle model performance metric: 

scalar performance:
{'acc': 0.8622222, 'precision': 0.87173873, 'recall': 0.8622222, 'specificity': 0.8622222, 'f1': 0.86133474, 'auroc': 0.929758, 'binary_precision': 0.93121696, 'binary_recall': 0.7822222, 'binary_specificity': 0.94222224, 'binary_f1_score': 0.85024154}
confusion matrix:
     0    1
0  212   13
1   49  176
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_halffreezeblocks_2024-07-20_12-47-21/rule_results/6.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_halffreezeblocks_2024-07-20_12-47-21/confusion_matrix/6.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 195613 KiB |   4046 MiB | 270586 GiB | 270586 GiB |
|       from large pool | 179211 KiB |   4027 MiB | 267467 GiB | 267467 GiB |
|       from small pool |  16402 KiB |     36 MiB |   3118 GiB |   3118 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 195613 KiB |   4046 MiB | 270586 GiB | 270586 GiB |
|       from large pool | 179211 KiB |   4027 MiB | 267467 GiB | 267467 GiB |
|       from small pool |  16402 KiB |     36 MiB |   3118 GiB |   3118 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 195189 KiB |   4045 MiB | 270566 GiB | 270566 GiB |
|       from large pool | 178979 KiB |   4026 MiB | 267451 GiB | 267451 GiB |
|       from small pool |  16210 KiB |     36 MiB |   3115 GiB |   3115 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   4424 MiB |   4434 MiB |   8614 MiB |   4190 MiB |
|       from large pool |   4382 MiB |   4396 MiB |   8552 MiB |   4170 MiB |
|       from small pool |     42 MiB |     42 MiB |     62 MiB |     20 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  33763 KiB | 398560 KiB | 143658 GiB | 143658 GiB |
|       from large pool |  31733 KiB | 397444 KiB | 140431 GiB | 140431 GiB |
|       from small pool |   2030 KiB |  11194 KiB |   3226 GiB |   3226 GiB |
|---------------------------------------------------------------------------|
| Allocations           |     800    |    1171    |   36268 K  |   36268 K  |
|       from large pool |      79    |     423    |   24507 K  |   24507 K  |
|       from small pool |     721    |    1017    |   11761 K  |   11761 K  |
|---------------------------------------------------------------------------|
| Active allocs         |     800    |    1171    |   36268 K  |   36268 K  |
|       from large pool |      79    |     423    |   24507 K  |   24507 K  |
|       from small pool |     721    |    1017    |   11761 K  |   11761 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     202    |     202    |     383    |     181    |
|       from large pool |     181    |     182    |     352    |     171    |
|       from small pool |      21    |      21    |      31    |      10    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      32    |     218    |   25863 K  |   25863 K  |
|       from large pool |      11    |     186    |   18872 K  |   18872 K  |
|       from small pool |      21    |     208    |    6990 K  |    6990 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   4046 MiB | 270586 GiB | 270586 GiB |
|       from large pool |  16640 KiB |   4027 MiB | 267467 GiB | 267467 GiB |
|       from small pool |      0 KiB |     36 MiB |   3118 GiB |   3118 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   4046 MiB | 270586 GiB | 270586 GiB |
|       from large pool |  16640 KiB |   4027 MiB | 267467 GiB | 267467 GiB |
|       from small pool |      0 KiB |     36 MiB |   3118 GiB |   3118 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   4045 MiB | 270566 GiB | 270566 GiB |
|       from large pool |  16640 KiB |   4026 MiB | 267451 GiB | 267451 GiB |
|       from small pool |      0 KiB |     36 MiB |   3115 GiB |   3115 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 229376 KiB |   4434 MiB |   8614 MiB |   8390 MiB |
|       from large pool | 210944 KiB |   4396 MiB |   8552 MiB |   8346 MiB |
|       from small pool |  18432 KiB |     42 MiB |     62 MiB |     44 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  30464 KiB | 398560 KiB | 143658 GiB | 143658 GiB |
|       from large pool |  30464 KiB | 397444 KiB | 140432 GiB | 140432 GiB |
|       from small pool |      0 KiB |  11194 KiB |   3226 GiB |   3226 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    1171    |   36268 K  |   36268 K  |
|       from large pool |       2    |     423    |   24507 K  |   24507 K  |
|       from small pool |       0    |    1017    |   11761 K  |   11761 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    1171    |   36268 K  |   36268 K  |
|       from large pool |       2    |     423    |   24507 K  |   24507 K  |
|       from small pool |       0    |    1017    |   11761 K  |   11761 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      19    |     202    |     383    |     364    |
|       from large pool |      10    |     182    |     352    |     342    |
|       from small pool |       9    |      21    |      31    |      22    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     218    |   25863 K  |   25863 K  |
|       from large pool |       3    |     186    |   18872 K  |   18872 K  |
|       from small pool |       0    |     208    |    6990 K  |    6990 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   4046 MiB | 270586 GiB | 270586 GiB |
|       from large pool |  16640 KiB |   4027 MiB | 267467 GiB | 267467 GiB |
|       from small pool |      0 KiB |     36 MiB |   3118 GiB |   3118 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   4046 MiB | 270586 GiB | 270586 GiB |
|       from large pool |  16640 KiB |   4027 MiB | 267467 GiB | 267467 GiB |
|       from small pool |      0 KiB |     36 MiB |   3118 GiB |   3118 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   4045 MiB | 270566 GiB | 270566 GiB |
|       from large pool |  16640 KiB |   4026 MiB | 267451 GiB | 267451 GiB |
|       from small pool |      0 KiB |     36 MiB |   3115 GiB |   3115 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 229376 KiB |   4434 MiB |   8614 MiB |   8390 MiB |
|       from large pool | 210944 KiB |   4396 MiB |   8552 MiB |   8346 MiB |
|       from small pool |  18432 KiB |     42 MiB |     62 MiB |     44 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  30464 KiB | 398560 KiB | 143658 GiB | 143658 GiB |
|       from large pool |  30464 KiB | 397444 KiB | 140432 GiB | 140432 GiB |
|       from small pool |      0 KiB |  11194 KiB |   3226 GiB |   3226 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    1171    |   36268 K  |   36268 K  |
|       from large pool |       2    |     423    |   24507 K  |   24507 K  |
|       from small pool |       0    |    1017    |   11761 K  |   11761 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    1171    |   36268 K  |   36268 K  |
|       from large pool |       2    |     423    |   24507 K  |   24507 K  |
|       from small pool |       0    |    1017    |   11761 K  |   11761 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      19    |     202    |     383    |     364    |
|       from large pool |      10    |     182    |     352    |     342    |
|       from small pool |       9    |      21    |      31    |      22    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     218    |   25863 K  |   25863 K  |
|       from large pool |       3    |     186    |   18872 K  |   18872 K  |
|       from small pool |       0    |     208    |    6990 K  |    6990 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'888c1ef2'
model name: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_14_25_58_seed_2_22504807

 Experiment start at: 2024-07-20 14:25:58.818407
before training, model accuracy: 0.41203704476356506
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.77159685, 'precision': 0.7724662, 'recall': 0.771809, 'specificity': 0.771809, 'f1': 0.77149665, 'auroc': 0.84481376, 'binary_precision': 0.7899449, 'binary_recall': 0.7448052, 'binary_specificity': 0.7988127, 'binary_f1_score': 0.76671124}
confusion matrix:
      0     1
0  1211   305
1   393  1147
---- Validation: 
scalar performance:
{'acc': 0.6830986, 'precision': 0.6899769, 'recall': 0.68018687, 'specificity': 0.68018687, 'f1': 0.67785823, 'auroc': 0.71857595, 'binary_precision': 0.72008115, 'binary_recall': 0.57073957, 'binary_specificity': 0.78963417, 'binary_f1_score': 0.6367713}
confusion matrix:
     0    1
0  518  138
1  267  355
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.46296296, 'precision': 0.46086603, 'recall': 0.46296296, 'specificity': 0.46296296, 'f1': 0.45567113, 'auroc': 0.44699502, 'binary_precision': 0.45180723, 'binary_recall': 0.3472222, 'binary_specificity': 0.5787037, 'binary_f1_score': 0.39267012}
confusion matrix:
     0   1
0  125  91
1  141  75
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-20 14:27:44.967081,epoch time: 0:01:46.148674,used: 0:01:46.148674,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_14_25_58_seed_2_22504807
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.8566754, 'precision': 0.86354804, 'recall': 0.8572165, 'specificity': 0.8572165, 'f1': 0.85611916, 'auroc': 0.92738235, 'binary_precision': 0.91553545, 'binary_recall': 0.78831166, 'binary_specificity': 0.92612135, 'binary_f1_score': 0.8471737}
confusion matrix:
      0     1
0  1404   112
1   326  1214
---- Validation: 
scalar performance:
{'acc': 0.63380283, 'precision': 0.67792904, 'recall': 0.6267523, 'specificity': 0.6267523, 'f1': 0.60224086, 'auroc': 0.7214165, 'binary_precision': 0.7601351, 'binary_recall': 0.36173633, 'binary_specificity': 0.8917683, 'binary_f1_score': 0.49019605}
confusion matrix:
     0    1
0  585   71
1  397  225
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5, 'precision': 0.5, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.44851065, 'auroc': 0.53999484, 'binary_precision': 0.5, 'binary_recall': 0.19444445, 'binary_specificity': 0.8055556, 'binary_f1_score': 0.28}
confusion matrix:
     0   1
0  174  42
1  174  42
new oracle model saved
early stop counter: 1
val acc:0.6338028311729431, best validation acc: 0.6830986142158508, corresponding to test acc:                         0.46296295523643494 / 0.5
after epoch: 2,now: 2024-07-20 14:29:28.877536,epoch time: 0:01:43.910455,used: 0:03:30.059129,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_14_25_58_seed_2_22504807
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.89267015, 'precision': 0.89407694, 'recall': 0.89291024, 'specificity': 0.89291024, 'f1': 0.89261055, 'auroc': 0.94784164, 'binary_precision': 0.9196676, 'binary_recall': 0.86233765, 'binary_specificity': 0.92348284, 'binary_f1_score': 0.8900804}
confusion matrix:
      0     1
0  1400   116
1   212  1328
---- Validation: 
scalar performance:
{'acc': 0.6314554, 'precision': 0.68248534, 'recall': 0.6240074, 'specificity': 0.6240074, 'f1': 0.59591794, 'auroc': 0.7323004, 'binary_precision': 0.77256316, 'binary_recall': 0.34405145, 'binary_specificity': 0.9039634, 'binary_f1_score': 0.4760846}
confusion matrix:
     0    1
0  593   63
1  408  214
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5462963, 'precision': 0.5701754, 'recall': 0.5462963, 'specificity': 0.5462963, 'f1': 0.50411135, 'auroc': 0.60288066, 'binary_precision': 0.6111111, 'binary_recall': 0.25462964, 'binary_specificity': 0.837963, 'binary_f1_score': 0.35947713}
confusion matrix:
     0   1
0  181  35
1  161  55
new oracle model saved
early stop counter: 2
val acc:0.6314554214477539, best validation acc: 0.6830986142158508, corresponding to test acc:                         0.46296295523643494 / 0.5462962985038757
after epoch: 3,now: 2024-07-20 14:31:13.139933,epoch time: 0:01:44.262397,used: 0:05:14.321526,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_14_25_58_seed_2_22504807
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.89528793, 'precision': 0.90299535, 'recall': 0.8958366, 'specificity': 0.8958366, 'f1': 0.894873, 'auroc': 0.9557555, 'binary_precision': 0.96072507, 'binary_recall': 0.82597405, 'binary_specificity': 0.9656992, 'binary_f1_score': 0.88826823}
confusion matrix:
      0     1
0  1464    52
1   268  1272
---- Validation: 
scalar performance:
{'acc': 0.59859157, 'precision': 0.67700815, 'recall': 0.5892871, 'specificity': 0.5892871, 'f1': 0.5367324, 'auroc': 0.73975575, 'binary_precision': 0.78835976, 'binary_recall': 0.23954985, 'binary_specificity': 0.9390244, 'binary_f1_score': 0.36744758}
confusion matrix:
     0    1
0  616   40
1  473  149
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5462963, 'precision': 0.58726573, 'recall': 0.5462963, 'specificity': 0.5462963, 'f1': 0.4859641, 'auroc': 0.64270407, 'binary_precision': 0.64705884, 'binary_recall': 0.2037037, 'binary_specificity': 0.8888889, 'binary_f1_score': 0.30985916}
confusion matrix:
     0   1
0  192  24
1  172  44
early stop counter: 3
val acc:0.5985915660858154, best validation acc: 0.6830986142158508, corresponding to test acc:                         0.46296295523643494 / 0.5462962985038757
after epoch: 4,now: 2024-07-20 14:32:56.910342,epoch time: 0:01:43.770409,used: 0:06:58.091935,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_14_25_58_seed_2_22504807
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.911322, 'precision': 0.9147068, 'recall': 0.91168404, 'specificity': 0.91168404, 'f1': 0.9111873, 'auroc': 0.95976555, 'binary_precision': 0.9541876, 'binary_recall': 0.86558443, 'binary_specificity': 0.95778364, 'binary_f1_score': 0.90772897}
confusion matrix:
      0     1
0  1452    64
1   207  1333
---- Validation: 
scalar performance:
{'acc': 0.6134585, 'precision': 0.69311965, 'recall': 0.6045188, 'specificity': 0.6045188, 'f1': 0.558751, 'auroc': 0.7529875, 'binary_precision': 0.8106796, 'binary_recall': 0.26848873, 'binary_specificity': 0.9405488, 'binary_f1_score': 0.40338165}
confusion matrix:
     0    1
0  617   39
1  455  167
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5486111, 'precision': 0.5865418, 'recall': 0.5486111, 'specificity': 0.5486111, 'f1': 0.49306452, 'auroc': 0.67221797, 'binary_precision': 0.6438356, 'binary_recall': 0.2175926, 'binary_specificity': 0.8796296, 'binary_f1_score': 0.32525954}
confusion matrix:
     0   1
0  190  26
1  169  47
new oracle model saved
early stop counter: 4
val acc:0.613458514213562, best validation acc: 0.6830986142158508, corresponding to test acc:                         0.46296295523643494 / 0.5486111044883728
after epoch: 5,now: 2024-07-20 14:34:41.196539,epoch time: 0:01:44.286197,used: 0:08:42.378132,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_14_25_58_seed_2_22504807
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9073953, 'precision': 0.91203344, 'recall': 0.9078188, 'specificity': 0.9078188, 'f1': 0.9071921, 'auroc': 0.9631866, 'binary_precision': 0.95775676, 'binary_recall': 0.8538961, 'binary_specificity': 0.96174145, 'binary_f1_score': 0.90284926}
confusion matrix:
      0     1
0  1458    58
1   225  1315
---- Validation: 
scalar performance:
{'acc': 0.6056338, 'precision': 0.69506097, 'recall': 0.5962302, 'specificity': 0.5962302, 'f1': 0.5433449, 'auroc': 0.76290584, 'binary_precision': 0.8206522, 'binary_recall': 0.24276528, 'binary_specificity': 0.9496951, 'binary_f1_score': 0.37468985}
confusion matrix:
     0    1
0  623   33
1  471  151
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5601852, 'precision': 0.6059943, 'recall': 0.5601852, 'specificity': 0.5601852, 'f1': 0.5069086, 'auroc': 0.69937414, 'binary_precision': 0.6756757, 'binary_recall': 0.23148148, 'binary_specificity': 0.8888889, 'binary_f1_score': 0.34482756}
confusion matrix:
     0   1
0  192  24
1  166  50
new oracle model saved
early stop counter: 5
val acc:0.6056337952613831, best validation acc: 0.6830986142158508, corresponding to test acc:                         0.46296295523643494 / 0.5601851940155029
after epoch: 6,now: 2024-07-20 14:36:25.441542,epoch time: 0:01:44.245003,used: 0:10:26.623135,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_14_25_58_seed_2_22504807
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 6 with time: 0:10:26.623135 at 2024-07-20 14:36:25.441542
persisted model performance metric: 

scalar performance:
{'acc': 0.46296296, 'precision': 0.46086603, 'recall': 0.46296296, 'specificity': 0.46296296, 'f1': 0.45567113, 'auroc': 0.44699502, 'binary_precision': 0.45180723, 'binary_recall': 0.3472222, 'binary_specificity': 0.5787037, 'binary_f1_score': 0.39267012}
confusion matrix:
     0   1
0  125  91
1  141  75
oracle model performance metric: 

scalar performance:
{'acc': 0.5601852, 'precision': 0.6059943, 'recall': 0.5601852, 'specificity': 0.5601852, 'f1': 0.5069086, 'auroc': 0.69937414, 'binary_precision': 0.6756757, 'binary_recall': 0.23148148, 'binary_specificity': 0.8888889, 'binary_f1_score': 0.34482756}
confusion matrix:
     0   1
0  192  24
1  166  50
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_halffreezeblocks_2024-07-20_12-47-21/rule_results/6.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_halffreezeblocks_2024-07-20_12-47-21/confusion_matrix/6.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 195607 KiB |   4046 MiB | 304230 GiB | 304230 GiB |
|       from large pool | 179211 KiB |   4027 MiB | 300718 GiB | 300718 GiB |
|       from small pool |  16396 KiB |     36 MiB |   3511 GiB |   3511 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 195607 KiB |   4046 MiB | 304230 GiB | 304230 GiB |
|       from large pool | 179211 KiB |   4027 MiB | 300718 GiB | 300718 GiB |
|       from small pool |  16396 KiB |     36 MiB |   3511 GiB |   3511 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 195188 KiB |   4045 MiB | 304207 GiB | 304207 GiB |
|       from large pool | 178979 KiB |   4026 MiB | 300700 GiB | 300699 GiB |
|       from small pool |  16209 KiB |     36 MiB |   3507 GiB |   3507 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   4420 MiB |   4434 MiB |  12810 MiB |   8390 MiB |
|       from large pool |   4382 MiB |   4396 MiB |  12728 MiB |   8346 MiB |
|       from small pool |     38 MiB |     42 MiB |     82 MiB |     44 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  33769 KiB | 398560 KiB | 161785 GiB | 161785 GiB |
|       from large pool |  31733 KiB | 397444 KiB | 158153 GiB | 158153 GiB |
|       from small pool |   2036 KiB |  11194 KiB |   3632 GiB |   3632 GiB |
|---------------------------------------------------------------------------|
| Allocations           |     788    |    1171    |   40789 K  |   40788 K  |
|       from large pool |      79    |     423    |   27557 K  |   27557 K  |
|       from small pool |     709    |    1017    |   13231 K  |   13230 K  |
|---------------------------------------------------------------------------|
| Active allocs         |     788    |    1171    |   40789 K  |   40788 K  |
|       from large pool |      79    |     423    |   27557 K  |   27557 K  |
|       from small pool |     709    |    1017    |   13231 K  |   13230 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     200    |     202    |     564    |     364    |
|       from large pool |     181    |     182    |     523    |     342    |
|       from small pool |      19    |      21    |      41    |      22    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      32    |     218    |   29062 K  |   29062 K  |
|       from large pool |      11    |     186    |   21191 K  |   21191 K  |
|       from small pool |      21    |     208    |    7870 K  |    7870 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   4046 MiB | 304230 GiB | 304230 GiB |
|       from large pool |  16640 KiB |   4027 MiB | 300718 GiB | 300718 GiB |
|       from small pool |      0 KiB |     36 MiB |   3511 GiB |   3511 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   4046 MiB | 304230 GiB | 304230 GiB |
|       from large pool |  16640 KiB |   4027 MiB | 300718 GiB | 300718 GiB |
|       from small pool |      0 KiB |     36 MiB |   3511 GiB |   3511 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   4045 MiB | 304207 GiB | 304207 GiB |
|       from large pool |  16640 KiB |   4026 MiB | 300700 GiB | 300700 GiB |
|       from small pool |      0 KiB |     36 MiB |   3507 GiB |   3507 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 229376 KiB |   4434 MiB |  12810 MiB |  12586 MiB |
|       from large pool | 210944 KiB |   4396 MiB |  12728 MiB |  12522 MiB |
|       from small pool |  18432 KiB |     42 MiB |     82 MiB |     64 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  30464 KiB | 398560 KiB | 161785 GiB | 161785 GiB |
|       from large pool |  30464 KiB | 397444 KiB | 158153 GiB | 158153 GiB |
|       from small pool |      0 KiB |  12296 KiB |   3632 GiB |   3632 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    1171    |   40789 K  |   40789 K  |
|       from large pool |       2    |     423    |   27557 K  |   27557 K  |
|       from small pool |       0    |    1017    |   13231 K  |   13231 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    1171    |   40789 K  |   40789 K  |
|       from large pool |       2    |     423    |   27557 K  |   27557 K  |
|       from small pool |       0    |    1017    |   13231 K  |   13231 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      19    |     202    |     564    |     545    |
|       from large pool |      10    |     182    |     523    |     513    |
|       from small pool |       9    |      21    |      41    |      32    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     218    |   29062 K  |   29062 K  |
|       from large pool |       3    |     186    |   21191 K  |   21191 K  |
|       from small pool |       0    |     208    |    7870 K  |    7870 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Sat Jul 20 14:37:00 2024]
Finished job 0.
1 of 1 steps (100%) done
