Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Sat Jul 20 12:50:41 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_halffreezeblocks_2024-07-20_12-47-21/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_halffreezeblocks_2024-07-20_12-47-21/rule_results/4.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=4
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/swiglu_ffn.py:51: UserWarning: xFormers is not available (SwiGLU)
  warnings.warn("xFormers is not available (SwiGLU)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/attention.py:33: UserWarning: xFormers is not available (Attention)
  warnings.warn("xFormers is not available (Attention)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/block.py:40: UserWarning: xFormers is not available (Block)
  warnings.warn("xFormers is not available (Block)")
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'888c1ef2'
model name: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_12_53_25_seed_0_22504805

 Experiment start at: 2024-07-20 12:53:25.514630
before training, model accuracy: 0.569767415523529
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.54785156, 'precision': 0.54840237, 'recall': 0.5466006, 'specificity': 0.5466006, 'f1': 0.5429852, 'auroc': 0.5894469, 'binary_precision': 0.54555374, 'binary_recall': 0.6426735, 'binary_specificity': 0.4505277, 'binary_f1_score': 0.59014463}
confusion matrix:
     0     1
0  683   833
1  556  1000
---- Validation: 
scalar performance:
{'acc': 0.63121116, 'precision': 0.6351619, 'recall': 0.6298477, 'specificity': 0.6298477, 'f1': 0.62699103, 'auroc': 0.7022054, 'binary_precision': 0.6550388, 'binary_recall': 0.5322835, 'binary_specificity': 0.7274119, 'binary_f1_score': 0.5873154}
confusion matrix:
     0    1
0  475  178
1  297  338
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.627907, 'precision': 0.63298166, 'recall': 0.627907, 'specificity': 0.627907, 'f1': 0.6243229, 'auroc': 0.66433746, 'binary_precision': 0.6589595, 'binary_recall': 0.53023255, 'binary_specificity': 0.7255814, 'binary_f1_score': 0.58762884}
confusion matrix:
     0    1
0  156   59
1  101  114
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-20 12:54:57.242702,epoch time: 0:01:31.728072,used: 0:01:31.728072,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_12_53_25_seed_0_22504805
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.6614583, 'precision': 0.66590154, 'recall': 0.6602199, 'specificity': 0.6602199, 'f1': 0.6580657, 'auroc': 0.74557614, 'binary_precision': 0.64195496, 'binary_recall': 0.7508028, 'binary_specificity': 0.56963694, 'binary_f1_score': 0.6921255}
confusion matrix:
     0     1
0  863   652
1  388  1169
---- Validation: 
scalar performance:
{'acc': 0.6281056, 'precision': 0.64297235, 'recall': 0.62569964, 'specificity': 0.62569964, 'f1': 0.6155236, 'auroc': 0.7111213, 'binary_precision': 0.6857143, 'binary_recall': 0.4535433, 'binary_specificity': 0.79785603, 'binary_f1_score': 0.5459715}
confusion matrix:
     0    1
0  521  132
1  347  288
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.62093025, 'precision': 0.6387235, 'recall': 0.62093025, 'specificity': 0.62093025, 'f1': 0.6083723, 'auroc': 0.6876582, 'binary_precision': 0.6884058, 'binary_recall': 0.44186047, 'binary_specificity': 0.8, 'binary_f1_score': 0.5382436}
confusion matrix:
     0   1
0  172  43
1  120  95
early stop counter: 1
val acc:0.6281055808067322, best validation acc: 0.6312111616134644, corresponding to test acc:                         0.6279069781303406 / 0.6279069781303406
after epoch: 2,now: 2024-07-20 12:55:55.911063,epoch time: 0:00:58.668361,used: 0:02:30.396433,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_12_53_25_seed_0_22504805
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.7526042, 'precision': 0.7542203, 'recall': 0.7519752, 'specificity': 0.7519752, 'f1': 0.75186205, 'auroc': 0.82881856, 'binary_precision': 0.7372176, 'binary_recall': 0.7958922, 'binary_specificity': 0.7080581, 'binary_f1_score': 0.7654321}
confusion matrix:
      0     1
0  1072   442
1   318  1240
---- Validation: 
scalar performance:
{'acc': 0.6218944, 'precision': 0.64348805, 'recall': 0.6190315, 'specificity': 0.6190315, 'f1': 0.60383475, 'auroc': 0.7185637, 'binary_precision': 0.6957672, 'binary_recall': 0.41417322, 'binary_specificity': 0.82388973, 'binary_f1_score': 0.5192498}
confusion matrix:
     0    1
0  538  115
1  372  263
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.627907, 'precision': 0.6522702, 'recall': 0.627907, 'specificity': 0.627907, 'f1': 0.6124031, 'auroc': 0.7070416, 'binary_precision': 0.7131783, 'binary_recall': 0.427907, 'binary_specificity': 0.82790697, 'binary_f1_score': 0.53488374}
confusion matrix:
     0   1
0  178  37
1  123  92
early stop counter: 2
val acc:0.6218944191932678, best validation acc: 0.6312111616134644, corresponding to test acc:                         0.6279069781303406 / 0.6279069781303406
after epoch: 3,now: 2024-07-20 12:56:54.437594,epoch time: 0:00:58.526531,used: 0:03:28.922964,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_12_53_25_seed_0_22504805
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.7753906, 'precision': 0.77656114, 'recall': 0.77582955, 'specificity': 0.77582955, 'f1': 0.7753049, 'auroc': 0.8419124, 'binary_precision': 0.79848695, 'binary_recall': 0.74518615, 'binary_specificity': 0.8064729, 'binary_f1_score': 0.7709164}
confusion matrix:
      0     1
0  1221   293
1   397  1161
---- Validation: 
scalar performance:
{'acc': 0.61413044, 'precision': 0.64014924, 'recall': 0.61096215, 'specificity': 0.61096215, 'f1': 0.5915247, 'auroc': 0.72539103, 'binary_precision': 0.69714284, 'binary_recall': 0.38425198, 'binary_specificity': 0.8376723, 'binary_f1_score': 0.4954315}
confusion matrix:
     0    1
0  547  106
1  391  244
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6232558, 'precision': 0.6508832, 'recall': 0.6232558, 'specificity': 0.6232558, 'f1': 0.60518265, 'auroc': 0.72274745, 'binary_precision': 0.7154471, 'binary_recall': 0.40930232, 'binary_specificity': 0.8372093, 'binary_f1_score': 0.52071005}
confusion matrix:
     0   1
0  180  35
1  127  88
early stop counter: 3
val acc:0.614130437374115, best validation acc: 0.6312111616134644, corresponding to test acc:                         0.6279069781303406 / 0.6279069781303406
after epoch: 4,now: 2024-07-20 12:57:52.990174,epoch time: 0:00:58.552580,used: 0:04:27.475544,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_12_53_25_seed_0_22504805
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.8258464, 'precision': 0.8266808, 'recall': 0.8262217, 'specificity': 0.8262217, 'f1': 0.82581824, 'auroc': 0.88317037, 'binary_precision': 0.8473541, 'binary_recall': 0.8011546, 'binary_specificity': 0.85128886, 'binary_f1_score': 0.82360697}
confusion matrix:
      0     1
0  1288   225
1   310  1249
---- Validation: 
scalar performance:
{'acc': 0.61180127, 'precision': 0.6393643, 'recall': 0.6085348, 'specificity': 0.6085348, 'f1': 0.5876025, 'auroc': 0.73281157, 'binary_precision': 0.6979472, 'binary_recall': 0.37480316, 'binary_specificity': 0.84226644, 'binary_f1_score': 0.4877049}
confusion matrix:
     0    1
0  550  103
1  397  238
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.627907, 'precision': 0.6614511, 'recall': 0.627907, 'specificity': 0.627907, 'f1': 0.607521, 'auroc': 0.7357274, 'binary_precision': 0.73504275, 'binary_recall': 0.4, 'binary_specificity': 0.855814, 'binary_f1_score': 0.5180723}
confusion matrix:
     0   1
0  184  31
1  129  86
early stop counter: 4
val acc:0.611801266670227, best validation acc: 0.6312111616134644, corresponding to test acc:                         0.6279069781303406 / 0.6279069781303406
after epoch: 5,now: 2024-07-20 12:58:51.935075,epoch time: 0:00:58.944901,used: 0:05:26.420445,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_12_53_25_seed_0_22504805
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.83170575, 'precision': 0.83254075, 'recall': 0.8320142, 'specificity': 0.8320142, 'f1': 0.83166957, 'auroc': 0.8962625, 'binary_precision': 0.8525815, 'binary_recall': 0.80707395, 'binary_specificity': 0.8569545, 'binary_f1_score': 0.82920384}
confusion matrix:
      0     1
0  1300   217
1   300  1255
---- Validation: 
scalar performance:
{'acc': 0.6234472, 'precision': 0.6484765, 'recall': 0.6204326, 'specificity': 0.6204326, 'f1': 0.6034843, 'auroc': 0.7393568, 'binary_precision': 0.70604396, 'binary_recall': 0.40472442, 'binary_specificity': 0.8361409, 'binary_f1_score': 0.5145145}
confusion matrix:
     0    1
0  546  107
1  378  257
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6465116, 'precision': 0.67599595, 'recall': 0.6465116, 'specificity': 0.6465116, 'f1': 0.63105965, 'auroc': 0.74585176, 'binary_precision': 0.7480315, 'binary_recall': 0.44186047, 'binary_specificity': 0.8511628, 'binary_f1_score': 0.5555556}
confusion matrix:
     0   1
0  183  32
1  120  95
new oracle model saved
early stop counter: 5
val acc:0.6234471797943115, best validation acc: 0.6312111616134644, corresponding to test acc:                         0.6279069781303406 / 0.6465116143226624
after epoch: 6,now: 2024-07-20 12:59:50.846047,epoch time: 0:00:58.910972,used: 0:06:25.331417,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_12_53_25_seed_0_22504805
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.836263, 'precision': 0.83808714, 'recall': 0.8367397, 'specificity': 0.8367397, 'f1': 0.83615464, 'auroc': 0.9034556, 'binary_precision': 0.8663883, 'binary_recall': 0.8001285, 'binary_specificity': 0.8733509, 'binary_f1_score': 0.8319412}
confusion matrix:
      0     1
0  1324   192
1   311  1245
---- Validation: 
scalar performance:
{'acc': 0.6125776, 'precision': 0.64111805, 'recall': 0.6092788, 'specificity': 0.6092788, 'f1': 0.5879309, 'auroc': 0.7440499, 'binary_precision': 0.70118344, 'binary_recall': 0.37322834, 'binary_specificity': 0.8453292, 'binary_f1_score': 0.48715314}
confusion matrix:
     0    1
0  552  101
1  398  237
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6372093, 'precision': 0.6663606, 'recall': 0.6372093, 'specificity': 0.6372093, 'f1': 0.62058824, 'auroc': 0.75450516, 'binary_precision': 0.736, 'binary_recall': 0.427907, 'binary_specificity': 0.8465116, 'binary_f1_score': 0.5411765}
confusion matrix:
     0   1
0  182  33
1  123  92
early stop counter: 6
val acc:0.6125776171684265, best validation acc: 0.6312111616134644, corresponding to test acc:                         0.6279069781303406 / 0.6465116143226624
after epoch: 7,now: 2024-07-20 13:00:49.478182,epoch time: 0:00:58.632135,used: 0:07:23.963552,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_12_53_25_seed_0_22504805
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.8538411, 'precision': 0.8582494, 'recall': 0.8545667, 'specificity': 0.8545667, 'f1': 0.85354984, 'auroc': 0.91152704, 'binary_precision': 0.9013778, 'binary_recall': 0.7988432, 'binary_specificity': 0.91029024, 'binary_f1_score': 0.8470187}
confusion matrix:
      0     1
0  1380   136
1   313  1243
---- Validation: 
scalar performance:
{'acc': 0.60714287, 'precision': 0.63958263, 'recall': 0.60361505, 'specificity': 0.60361505, 'f1': 0.57845557, 'auroc': 0.74869466, 'binary_precision': 0.70347005, 'binary_recall': 0.3511811, 'binary_specificity': 0.856049, 'binary_f1_score': 0.46848738}
confusion matrix:
     0    1
0  559   94
1  412  223
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6372093, 'precision': 0.673193, 'recall': 0.6372093, 'specificity': 0.6372093, 'f1': 0.61733294, 'auroc': 0.7624229, 'binary_precision': 0.75213677, 'binary_recall': 0.40930232, 'binary_specificity': 0.8651163, 'binary_f1_score': 0.5301205}
confusion matrix:
     0   1
0  186  29
1  127  88
early stop counter: 7
val acc:0.6071428656578064, best validation acc: 0.6312111616134644, corresponding to test acc:                         0.6279069781303406 / 0.6465116143226624
after epoch: 8,now: 2024-07-20 13:01:47.932964,epoch time: 0:00:58.454782,used: 0:08:22.418334,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_12_53_25_seed_0_22504805
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.8544922, 'precision': 0.8579033, 'recall': 0.8551638, 'specificity': 0.8551638, 'f1': 0.854288, 'auroc': 0.91932905, 'binary_precision': 0.8964286, 'binary_recall': 0.80603725, 'binary_specificity': 0.90429044, 'binary_f1_score': 0.84883326}
confusion matrix:
      0     1
0  1370   145
1   302  1255
---- Validation: 
scalar performance:
{'acc': 0.61490685, 'precision': 0.647112, 'recall': 0.61148906, 'specificity': 0.61148906, 'f1': 0.5885482, 'auroc': 0.7535566, 'binary_precision': 0.71253824, 'binary_recall': 0.36692914, 'binary_specificity': 0.856049, 'binary_f1_score': 0.48440745}
confusion matrix:
     0    1
0  559   94
1  402  233
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6395349, 'precision': 0.6716521, 'recall': 0.6395349, 'specificity': 0.6395349, 'f1': 0.6218461, 'auroc': 0.77044886, 'binary_precision': 0.74590164, 'binary_recall': 0.4232558, 'binary_specificity': 0.855814, 'binary_f1_score': 0.5400593}
confusion matrix:
     0   1
0  184  31
1  124  91
early stop counter: 8
val acc:0.6149068474769592, best validation acc: 0.6312111616134644, corresponding to test acc:                         0.6279069781303406 / 0.6465116143226624
after epoch: 9,now: 2024-07-20 13:02:46.634411,epoch time: 0:00:58.701447,used: 0:09:21.119781,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_12_53_25_seed_0_22504805
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.8613281, 'precision': 0.8643675, 'recall': 0.86198986, 'specificity': 0.86198986, 'f1': 0.861169, 'auroc': 0.9243382, 'binary_precision': 0.90141845, 'binary_recall': 0.81578946, 'binary_specificity': 0.90819025, 'binary_f1_score': 0.856469}
confusion matrix:
      0     1
0  1375   139
1   287  1271
---- Validation: 
scalar performance:
{'acc': 0.6304348, 'precision': 0.66047305, 'recall': 0.6272805, 'specificity': 0.6272805, 'f1': 0.6089351, 'auroc': 0.7577119, 'binary_precision': 0.72649574, 'binary_recall': 0.4015748, 'binary_specificity': 0.8529862, 'binary_f1_score': 0.51724136}
confusion matrix:
     0    1
0  557   96
1  380  255
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.65581393, 'precision': 0.6838827, 'recall': 0.65581393, 'specificity': 0.65581393, 'f1': 0.64215827, 'auroc': 0.77840996, 'binary_precision': 0.7557252, 'binary_recall': 0.4604651, 'binary_specificity': 0.8511628, 'binary_f1_score': 0.5722543}
confusion matrix:
     0   1
0  183  32
1  116  99
new oracle model saved
early stop counter: 9
val acc:0.6304348111152649, best validation acc: 0.6312111616134644, corresponding to test acc:                         0.6279069781303406 / 0.6558139324188232
after epoch: 10,now: 2024-07-20 13:03:45.519093,epoch time: 0:00:58.884682,used: 0:10:20.004463,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_12_53_25_seed_0_22504805
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.86588544, 'precision': 0.87546325, 'recall': 0.8668797, 'specificity': 0.8668797, 'f1': 0.8652314, 'auroc': 0.9275876, 'binary_precision': 0.9386032, 'binary_recall': 0.78649515, 'binary_specificity': 0.9472643, 'binary_f1_score': 0.8558432}
confusion matrix:
      0     1
0  1437    80
1   332  1223
---- Validation: 
scalar performance:
{'acc': 0.61413044, 'precision': 0.65246, 'recall': 0.6104846, 'specificity': 0.6104846, 'f1': 0.58393145, 'auroc': 0.76181406, 'binary_precision': 0.7254902, 'binary_recall': 0.3496063, 'binary_specificity': 0.8713629, 'binary_f1_score': 0.47183847}
confusion matrix:
     0    1
0  569   84
1  413  222
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6465116, 'precision': 0.6890651, 'recall': 0.6465116, 'specificity': 0.6465116, 'f1': 0.6254356, 'auroc': 0.786371, 'binary_precision': 0.7787611, 'binary_recall': 0.40930232, 'binary_specificity': 0.88372093, 'binary_f1_score': 0.5365854}
confusion matrix:
     0   1
0  190  25
1  127  88
early stop counter: 10
val acc:0.614130437374115, best validation acc: 0.6312111616134644, corresponding to test acc:                         0.6279069781303406 / 0.6558139324188232
after epoch: 11,now: 2024-07-20 13:04:44.228864,epoch time: 0:00:58.709771,used: 0:11:18.714234,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_12_53_25_seed_0_22504805
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.87434894, 'precision': 0.8789187, 'recall': 0.8750738, 'specificity': 0.8750738, 'f1': 0.87410223, 'auroc': 0.938408, 'binary_precision': 0.92391306, 'binary_recall': 0.8194087, 'binary_specificity': 0.9307388, 'binary_f1_score': 0.8685286}
confusion matrix:
      0     1
0  1411   105
1   281  1275
---- Validation: 
scalar performance:
{'acc': 0.625, 'precision': 0.65832174, 'recall': 0.6216602, 'specificity': 0.6216602, 'f1': 0.6004939, 'auroc': 0.7649226, 'binary_precision': 0.7275449, 'binary_recall': 0.38267717, 'binary_specificity': 0.8606432, 'binary_f1_score': 0.50154793}
confusion matrix:
     0    1
0  562   91
1  392  243
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.66976744, 'precision': 0.70782024, 'recall': 0.66976744, 'specificity': 0.66976744, 'f1': 0.6539255, 'auroc': 0.79247165, 'binary_precision': 0.796748, 'binary_recall': 0.45581394, 'binary_specificity': 0.88372093, 'binary_f1_score': 0.57988167}
confusion matrix:
     0   1
0  190  25
1  117  98
new oracle model saved
early stop counter: 11
val acc:0.625, best validation acc: 0.6312111616134644, corresponding to test acc:                         0.6279069781303406 / 0.669767439365387
after epoch: 12,now: 2024-07-20 13:05:42.911218,epoch time: 0:00:58.682354,used: 0:12:17.396588,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_12_53_25_seed_0_22504805
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.8727214, 'precision': 0.8795573, 'recall': 0.8735597, 'specificity': 0.8735597, 'f1': 0.87230706, 'auroc': 0.9334241, 'binary_precision': 0.9336811, 'binary_recall': 0.8057878, 'binary_specificity': 0.94133157, 'binary_f1_score': 0.86503285}
confusion matrix:
      0     1
0  1428    89
1   302  1253
---- Validation: 
scalar performance:
{'acc': 0.63819873, 'precision': 0.66912127, 'recall': 0.6350894, 'specificity': 0.6350894, 'f1': 0.617736, 'auroc': 0.7693263, 'binary_precision': 0.73802817, 'binary_recall': 0.41259843, 'binary_specificity': 0.8575804, 'binary_f1_score': 0.5292929}
confusion matrix:
     0    1
0  560   93
1  373  262
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.66511625, 'precision': 0.70019674, 'recall': 0.6651163, 'specificity': 0.6651163, 'f1': 0.6497737, 'auroc': 0.79911304, 'binary_precision': 0.784, 'binary_recall': 0.45581394, 'binary_specificity': 0.8744186, 'binary_f1_score': 0.57647055}
confusion matrix:
     0   1
0  188  27
1  117  98
better model found
persisted
after epoch: 13,now: 2024-07-20 13:06:41.852327,epoch time: 0:00:58.941109,used: 0:13:16.337697,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_12_53_25_seed_0_22504805
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.88411456, 'precision': 0.89120483, 'recall': 0.8849587, 'specificity': 0.8849587, 'f1': 0.883733, 'auroc': 0.9438586, 'binary_precision': 0.94705445, 'binary_recall': 0.81672025, 'binary_specificity': 0.9531971, 'binary_f1_score': 0.87707186}
confusion matrix:
      0     1
0  1446    71
1   285  1270
---- Validation: 
scalar performance:
{'acc': 0.6529503, 'precision': 0.6798799, 'recall': 0.6501368, 'specificity': 0.6501368, 'f1': 0.6368749, 'auroc': 0.77478147, 'binary_precision': 0.7460733, 'binary_recall': 0.4488189, 'binary_specificity': 0.8514548, 'binary_f1_score': 0.560472}
confusion matrix:
     0    1
0  556   97
1  350  285
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.67209303, 'precision': 0.6989546, 'recall': 0.67209303, 'specificity': 0.67209303, 'f1': 0.6606384, 'auroc': 0.80562466, 'binary_precision': 0.77205884, 'binary_recall': 0.4883721, 'binary_specificity': 0.855814, 'binary_f1_score': 0.59829056}
confusion matrix:
     0    1
0  184   31
1  110  105
new oracle model saved
better model found
persisted
after epoch: 14,now: 2024-07-20 13:07:40.755593,epoch time: 0:00:58.903266,used: 0:14:15.240963,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_12_53_25_seed_0_22504805
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.88639325, 'precision': 0.8937331, 'recall': 0.88724977, 'specificity': 0.88724977, 'f1': 0.8860062, 'auroc': 0.94376826, 'binary_precision': 0.9506726, 'binary_recall': 0.81800646, 'binary_specificity': 0.9564931, 'binary_f1_score': 0.87936395}
confusion matrix:
      0     1
0  1451    66
1   283  1272
---- Validation: 
scalar performance:
{'acc': 0.65993786, 'precision': 0.6879823, 'recall': 0.6571367, 'specificity': 0.6571367, 'f1': 0.6443075, 'auroc': 0.7781626, 'binary_precision': 0.75718015, 'binary_recall': 0.4566929, 'binary_specificity': 0.8575804, 'binary_f1_score': 0.5697446}
confusion matrix:
     0    1
0  560   93
1  345  290
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6744186, 'precision': 0.70244825, 'recall': 0.67441857, 'specificity': 0.67441857, 'f1': 0.6627451, 'auroc': 0.8125689, 'binary_precision': 0.7777778, 'binary_recall': 0.4883721, 'binary_specificity': 0.8604651, 'binary_f1_score': 0.6}
confusion matrix:
     0    1
0  185   30
1  110  105
new oracle model saved
better model found
persisted
after epoch: 15,now: 2024-07-20 13:08:39.960240,epoch time: 0:00:59.204647,used: 0:15:14.445610,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_12_53_25_seed_0_22504805
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.89160156, 'precision': 0.90032464, 'recall': 0.89262736, 'specificity': 0.89262736, 'f1': 0.89117205, 'auroc': 0.9483245, 'binary_precision': 0.962935, 'binary_recall': 0.8175979, 'binary_specificity': 0.9676568, 'binary_f1_score': 0.88433486}
confusion matrix:
      0     1
0  1466    49
1   284  1273
---- Validation: 
scalar performance:
{'acc': 0.6700311, 'precision': 0.6944301, 'recall': 0.66745967, 'specificity': 0.66745967, 'f1': 0.65722007, 'auroc': 0.7843436, 'binary_precision': 0.759901, 'binary_recall': 0.48346457, 'binary_specificity': 0.8514548, 'binary_f1_score': 0.5909529}
confusion matrix:
     0    1
0  556   97
1  328  307
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.67906976, 'precision': 0.7031338, 'recall': 0.67906976, 'specificity': 0.67906976, 'f1': 0.66927505, 'auroc': 0.8189724, 'binary_precision': 0.77304965, 'binary_recall': 0.5069767, 'binary_specificity': 0.8511628, 'binary_f1_score': 0.6123595}
confusion matrix:
     0    1
0  183   32
1  106  109
new oracle model saved
better model found
persisted
after epoch: 16,now: 2024-07-20 13:09:38.904946,epoch time: 0:00:58.944706,used: 0:16:13.390316,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_12_53_25_seed_0_22504805
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.89713544, 'precision': 0.903306, 'recall': 0.8979573, 'specificity': 0.8979573, 'f1': 0.8968626, 'auroc': 0.9550874, 'binary_precision': 0.95655376, 'binary_recall': 0.8348329, 'binary_specificity': 0.9610818, 'binary_f1_score': 0.891558}
confusion matrix:
      0     1
0  1457    59
1   257  1299
---- Validation: 
scalar performance:
{'acc': 0.6708075, 'precision': 0.69410396, 'recall': 0.6682905, 'specificity': 0.6682905, 'f1': 0.65855366, 'auroc': 0.78831077, 'binary_precision': 0.7579462, 'binary_recall': 0.48818898, 'binary_specificity': 0.848392, 'binary_f1_score': 0.5938697}
confusion matrix:
     0    1
0  554   99
1  325  310
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6883721, 'precision': 0.7121659, 'recall': 0.68837214, 'specificity': 0.68837214, 'f1': 0.67938304, 'auroc': 0.8241644, 'binary_precision': 0.7832168, 'binary_recall': 0.52093023, 'binary_specificity': 0.855814, 'binary_f1_score': 0.6256983}
confusion matrix:
     0    1
0  184   31
1  103  112
new oracle model saved
better model found
persisted
after epoch: 17,now: 2024-07-20 13:10:37.846289,epoch time: 0:00:58.941343,used: 0:17:12.331659,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_12_53_25_seed_0_22504805
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.89908856, 'precision': 0.903113, 'recall': 0.89979076, 'specificity': 0.89979076, 'f1': 0.89893436, 'auroc': 0.9555111, 'binary_precision': 0.9469534, 'binary_recall': 0.84842646, 'binary_specificity': 0.9511551, 'binary_f1_score': 0.8949865}
confusion matrix:
      0     1
0  1441    74
1   236  1321
---- Validation: 
scalar performance:
{'acc': 0.6886646, 'precision': 0.7064013, 'recall': 0.68653095, 'specificity': 0.68653095, 'f1': 0.6802452, 'auroc': 0.7939842, 'binary_precision': 0.7635135, 'binary_recall': 0.53385824, 'binary_specificity': 0.83920366, 'binary_f1_score': 0.62835956}
confusion matrix:
     0    1
0  548  105
1  296  339
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7186046, 'precision': 0.733912, 'recall': 0.7186046, 'specificity': 0.7186046, 'f1': 0.7139244, 'auroc': 0.8313683, 'binary_precision': 0.79375, 'binary_recall': 0.59069765, 'binary_specificity': 0.8465116, 'binary_f1_score': 0.67733335}
confusion matrix:
     0    1
0  182   33
1   88  127
new oracle model saved
better model found
persisted
after epoch: 18,now: 2024-07-20 13:11:36.871059,epoch time: 0:00:59.024770,used: 0:18:11.356429,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_12_53_25_seed_0_22504805
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.90494794, 'precision': 0.912676, 'recall': 0.9058113, 'specificity': 0.9058113, 'f1': 0.90462047, 'auroc': 0.9572277, 'binary_precision': 0.9723261, 'binary_recall': 0.83601284, 'binary_specificity': 0.9756098, 'binary_f1_score': 0.8990318}
confusion matrix:
      0     1
0  1480    37
1   255  1300
---- Validation: 
scalar performance:
{'acc': 0.70341617, 'precision': 0.7191243, 'recall': 0.7014699, 'specificity': 0.7014699, 'f1': 0.6966759, 'auroc': 0.79955864, 'binary_precision': 0.77440345, 'binary_recall': 0.5622047, 'binary_specificity': 0.8407351, 'binary_f1_score': 0.6514599}
confusion matrix:
     0    1
0  549  104
1  278  357
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.73023254, 'precision': 0.7433962, 'recall': 0.73023254, 'specificity': 0.73023254, 'f1': 0.7265351, 'auroc': 0.83720934, 'binary_precision': 0.8, 'binary_recall': 0.6139535, 'binary_specificity': 0.8465116, 'binary_f1_score': 0.6947368}
confusion matrix:
     0    1
0  182   33
1   83  132
new oracle model saved
better model found
persisted
after epoch: 19,now: 2024-07-20 13:12:36.027119,epoch time: 0:00:59.156060,used: 0:19:10.512489,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_12_53_25_seed_0_22504805
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9000651, 'precision': 0.9100174, 'recall': 0.90104455, 'specificity': 0.90104455, 'f1': 0.8996004, 'auroc': 0.95729387, 'binary_precision': 0.9770642, 'binary_recall': 0.82186496, 'binary_specificity': 0.98022413, 'binary_f1_score': 0.89276975}
confusion matrix:
      0     1
0  1487    30
1   277  1278
---- Validation: 
scalar performance:
{'acc': 0.68944097, 'precision': 0.7078953, 'recall': 0.68727493, 'specificity': 0.68727493, 'f1': 0.68079305, 'auroc': 0.8019848, 'binary_precision': 0.7664399, 'binary_recall': 0.5322835, 'binary_specificity': 0.84226644, 'binary_f1_score': 0.62825274}
confusion matrix:
     0    1
0  550  103
1  297  338
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.73023254, 'precision': 0.7483027, 'recall': 0.7302326, 'specificity': 0.7302326, 'f1': 0.72523355, 'auroc': 0.8412764, 'binary_precision': 0.81528664, 'binary_recall': 0.59534883, 'binary_specificity': 0.8651163, 'binary_f1_score': 0.68817204}
confusion matrix:
     0    1
0  186   29
1   87  128
early stop counter: 1
val acc:0.6894409656524658, best validation acc: 0.7034161686897278, corresponding to test acc:                         0.7302325367927551 / 0.7302325367927551
after epoch: 20,now: 2024-07-20 13:13:35.093177,epoch time: 0:00:59.066058,used: 0:20:09.578547,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_12_53_25_seed_0_22504805
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9117839, 'precision': 0.91819215, 'recall': 0.91265315, 'specificity': 0.91265315, 'f1': 0.9115529, 'auroc': 0.96470535, 'binary_precision': 0.9734904, 'binary_recall': 0.8490687, 'binary_specificity': 0.9762376, 'binary_f1_score': 0.9070326}
confusion matrix:
      0     1
0  1479    36
1   235  1322
---- Validation: 
scalar performance:
{'acc': 0.71428573, 'precision': 0.7274245, 'recall': 0.71253693, 'specificity': 0.71253693, 'f1': 0.7089745, 'auroc': 0.8055637, 'binary_precision': 0.77870566, 'binary_recall': 0.58740157, 'binary_specificity': 0.8376723, 'binary_f1_score': 0.6696589}
confusion matrix:
     0    1
0  547  106
1  262  373
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.75581396, 'precision': 0.7675339, 'recall': 0.75581396, 'specificity': 0.75581396, 'f1': 0.75311005, 'auroc': 0.84493244, 'binary_precision': 0.8235294, 'binary_recall': 0.6511628, 'binary_specificity': 0.8604651, 'binary_f1_score': 0.72727275}
confusion matrix:
     0    1
0  185   30
1   75  140
new oracle model saved
better model found
persisted
after epoch: 21,now: 2024-07-20 13:14:34.219870,epoch time: 0:00:59.126693,used: 0:21:08.705240,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_12_53_25_seed_0_22504805
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9046224, 'precision': 0.9118817, 'recall': 0.90559614, 'specificity': 0.90559614, 'f1': 0.9043329, 'auroc': 0.9620919, 'binary_precision': 0.9702602, 'binary_recall': 0.83761233, 'binary_specificity': 0.97357994, 'binary_f1_score': 0.8990699}
confusion matrix:
      0     1
0  1474    40
1   253  1305
---- Validation: 
scalar performance:
{'acc': 0.7204969, 'precision': 0.7315907, 'recall': 0.7189013, 'specificity': 0.7189013, 'f1': 0.71611613, 'auroc': 0.8121258, 'binary_precision': 0.7789047, 'binary_recall': 0.6047244, 'binary_specificity': 0.8330781, 'binary_f1_score': 0.68085104}
confusion matrix:
     0    1
0  544  109
1  251  384
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.772093, 'precision': 0.7818488, 'recall': 0.77209306, 'specificity': 0.77209306, 'f1': 0.7701037, 'auroc': 0.849908, 'binary_precision': 0.83428574, 'binary_recall': 0.67906976, 'binary_specificity': 0.8651163, 'binary_f1_score': 0.74871796}
confusion matrix:
     0    1
0  186   29
1   69  146
new oracle model saved
better model found
persisted
after epoch: 22,now: 2024-07-20 13:15:33.086016,epoch time: 0:00:58.866146,used: 0:22:07.571386,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_12_53_25_seed_0_22504805
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.9033203, 'precision': 0.91344476, 'recall': 0.9044106, 'specificity': 0.9044106, 'f1': 0.90287936, 'auroc': 0.9561304, 'binary_precision': 0.98165137, 'binary_recall': 0.8246628, 'binary_specificity': 0.9841584, 'binary_f1_score': 0.89633507}
confusion matrix:
      0     1
0  1491    24
1   273  1284
---- Validation: 
scalar performance:
{'acc': 0.7220497, 'precision': 0.73257244, 'recall': 0.7204977, 'specificity': 0.7204977, 'f1': 0.7179116, 'auroc': 0.8134956, 'binary_precision': 0.77867204, 'binary_recall': 0.6094488, 'binary_specificity': 0.8315467, 'binary_f1_score': 0.68374556}
confusion matrix:
     0    1
0  543  110
1  248  387
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.772093, 'precision': 0.7818488, 'recall': 0.77209306, 'specificity': 0.77209306, 'f1': 0.7701037, 'auroc': 0.85202813, 'binary_precision': 0.83428574, 'binary_recall': 0.67906976, 'binary_specificity': 0.8651163, 'binary_f1_score': 0.74871796}
confusion matrix:
     0    1
0  186   29
1   69  146
better model found
persisted
after epoch: 23,now: 2024-07-20 13:16:31.741570,epoch time: 0:00:58.655554,used: 0:23:06.226940,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_12_53_25_seed_0_22504805
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.91796875, 'precision': 0.9224664, 'recall': 0.9187354, 'specificity': 0.9187354, 'f1': 0.9178349, 'auroc': 0.96293557, 'binary_precision': 0.9697842, 'binary_recall': 0.8652118, 'binary_specificity': 0.9722589, 'binary_f1_score': 0.9145183}
confusion matrix:
      0     1
0  1472    42
1   210  1348
---- Validation: 
scalar performance:
{'acc': 0.7251553, 'precision': 0.7339721, 'recall': 0.7237342, 'specificity': 0.7237342, 'f1': 0.72167635, 'auroc': 0.8154876, 'binary_precision': 0.77603143, 'binary_recall': 0.62204725, 'binary_specificity': 0.82542115, 'binary_f1_score': 0.69055945}
confusion matrix:
     0    1
0  539  114
1  240  395
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7744186, 'precision': 0.7818889, 'recall': 0.7744186, 'specificity': 0.7744186, 'f1': 0.7729141, 'auroc': 0.85492694, 'binary_precision': 0.8277778, 'binary_recall': 0.69302326, 'binary_specificity': 0.855814, 'binary_f1_score': 0.75443035}
confusion matrix:
     0    1
0  184   31
1   66  149
new oracle model saved
better model found
persisted
after epoch: 24,now: 2024-07-20 13:17:30.543578,epoch time: 0:00:58.802008,used: 0:24:05.028948,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_12_53_25_seed_0_22504805
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.91503906, 'precision': 0.9192792, 'recall': 0.9157157, 'specificity': 0.9157157, 'f1': 0.9149026, 'auroc': 0.96789134, 'binary_precision': 0.96482414, 'binary_recall': 0.8637532, 'binary_specificity': 0.9676781, 'binary_f1_score': 0.91149545}
confusion matrix:
      0     1
0  1467    49
1   212  1344
---- Validation: 
scalar performance:
{'acc': 0.738354, 'precision': 0.74380916, 'recall': 0.73725027, 'specificity': 0.73725027, 'f1': 0.7362515, 'auroc': 0.8190689, 'binary_precision': 0.7769517, 'binary_recall': 0.65826774, 'binary_specificity': 0.8162328, 'binary_f1_score': 0.7127025}
confusion matrix:
     0    1
0  533  120
1  217  418
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7883721, 'precision': 0.79232454, 'recall': 0.78837204, 'specificity': 0.78837204, 'f1': 0.7876543, 'auroc': 0.8585181, 'binary_precision': 0.82631576, 'binary_recall': 0.73023254, 'binary_specificity': 0.8465116, 'binary_f1_score': 0.7753086}
confusion matrix:
     0    1
0  182   33
1   58  157
new oracle model saved
better model found
persisted
after epoch: 25,now: 2024-07-20 13:18:29.846394,epoch time: 0:00:59.302816,used: 0:25:04.331764,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_12_53_25_seed_0_22504805
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9111328, 'precision': 0.9154745, 'recall': 0.9117837, 'specificity': 0.9117837, 'f1': 0.9109807, 'auroc': 0.96438223, 'binary_precision': 0.96115106, 'binary_recall': 0.859164, 'binary_specificity': 0.96440345, 'binary_f1_score': 0.9073005}
confusion matrix:
      0     1
0  1463    54
1   219  1336
---- Validation: 
scalar performance:
{'acc': 0.7414596, 'precision': 0.74387676, 'recall': 0.7407037, 'specificity': 0.7407037, 'f1': 0.74038154, 'auroc': 0.82180846, 'binary_precision': 0.7649123, 'binary_recall': 0.68661416, 'binary_specificity': 0.79479325, 'binary_f1_score': 0.72365147}
confusion matrix:
     0    1
0  519  134
1  199  436
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7860465, 'precision': 0.7890732, 'recall': 0.7860465, 'specificity': 0.7860465, 'f1': 0.78548497, 'auroc': 0.86156845, 'binary_precision': 0.81865287, 'binary_recall': 0.7348837, 'binary_specificity': 0.8372093, 'binary_f1_score': 0.7745098}
confusion matrix:
     0    1
0  180   35
1   57  158
better model found
persisted
after epoch: 26,now: 2024-07-20 13:19:28.663523,epoch time: 0:00:58.817129,used: 0:26:03.148893,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_12_53_25_seed_0_22504805
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.90983075, 'precision': 0.9157363, 'recall': 0.9105861, 'specificity': 0.9105861, 'f1': 0.9096065, 'auroc': 0.9663553, 'binary_precision': 0.96847504, 'binary_recall': 0.8495177, 'binary_specificity': 0.9716546, 'binary_f1_score': 0.9051045}
confusion matrix:
      0     1
0  1474    43
1   234  1321
---- Validation: 
scalar performance:
{'acc': 0.742236, 'precision': 0.7465708, 'recall': 0.74125236, 'specificity': 0.74125236, 'f1': 0.7405444, 'auroc': 0.8247049, 'binary_precision': 0.7759563, 'binary_recall': 0.67086613, 'binary_specificity': 0.8116386, 'binary_f1_score': 0.71959454}
confusion matrix:
     0    1
0  530  123
1  209  426
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7930232, 'precision': 0.79641545, 'recall': 0.7930232, 'specificity': 0.7930232, 'f1': 0.7924294, 'auroc': 0.86388314, 'binary_precision': 0.828125, 'binary_recall': 0.73953485, 'binary_specificity': 0.8465116, 'binary_f1_score': 0.7813268}
confusion matrix:
     0    1
0  182   33
1   56  159
new oracle model saved
better model found
persisted
after epoch: 27,now: 2024-07-20 13:20:27.676648,epoch time: 0:00:59.013125,used: 0:27:02.162018,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_12_53_25_seed_0_22504805
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.9169922, 'precision': 0.92170775, 'recall': 0.91770303, 'specificity': 0.91770303, 'f1': 0.9168409, 'auroc': 0.9719013, 'binary_precision': 0.96967506, 'binary_recall': 0.86311054, 'binary_specificity': 0.9722955, 'binary_f1_score': 0.9132948}
confusion matrix:
      0     1
0  1474    42
1   213  1343
---- Validation: 
scalar performance:
{'acc': 0.75621116, 'precision': 0.7576108, 'recall': 0.75564265, 'specificity': 0.75564265, 'f1': 0.75556934, 'auroc': 0.8282428, 'binary_precision': 0.7734242, 'binary_recall': 0.71496063, 'binary_specificity': 0.7963247, 'binary_f1_score': 0.7430442}
confusion matrix:
     0    1
0  520  133
1  181  454
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7930232, 'precision': 0.7940985, 'recall': 0.7930232, 'specificity': 0.7930232, 'f1': 0.7928339, 'auroc': 0.8672147, 'binary_precision': 0.8118812, 'binary_recall': 0.7627907, 'binary_specificity': 0.82325584, 'binary_f1_score': 0.7865707}
confusion matrix:
     0    1
0  177   38
1   51  164
better model found
persisted
after epoch: 28,now: 2024-07-20 13:21:26.589066,epoch time: 0:00:58.912418,used: 0:28:01.074436,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_12_53_25_seed_0_22504805
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9111328, 'precision': 0.91801137, 'recall': 0.9119448, 'specificity': 0.9119448, 'f1': 0.9108694, 'auroc': 0.9701734, 'binary_precision': 0.97481483, 'binary_recall': 0.8463023, 'binary_specificity': 0.97758734, 'binary_f1_score': 0.9060241}
confusion matrix:
      0     1
0  1483    34
1   239  1316
---- Validation: 
scalar performance:
{'acc': 0.7468944, 'precision': 0.75321245, 'recall': 0.745738, 'specificity': 0.745738, 'f1': 0.74467814, 'auroc': 0.82960296, 'binary_precision': 0.78986865, 'binary_recall': 0.6629921, 'binary_specificity': 0.82848394, 'binary_f1_score': 0.72089034}
confusion matrix:
     0    1
0  541  112
1  214  421
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7953488, 'precision': 0.7974336, 'recall': 0.7953488, 'specificity': 0.7953488, 'f1': 0.7949896, 'auroc': 0.8693131, 'binary_precision': 0.822335, 'binary_recall': 0.75348836, 'binary_specificity': 0.8372093, 'binary_f1_score': 0.78640777}
confusion matrix:
     0    1
0  180   35
1   53  162
new oracle model saved
early stop counter: 1
val acc:0.7468944191932678, best validation acc: 0.7562111616134644, corresponding to test acc:                         0.7930232286453247 / 0.7953488230705261
after epoch: 29,now: 2024-07-20 13:22:25.544821,epoch time: 0:00:58.955755,used: 0:29:00.030191,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_12_53_25_seed_0_22504805
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.9202474, 'precision': 0.9255773, 'recall': 0.92103815, 'specificity': 0.92103815, 'f1': 0.92008376, 'auroc': 0.9705663, 'binary_precision': 0.9767442, 'binary_recall': 0.86319846, 'binary_specificity': 0.9788779, 'binary_f1_score': 0.9164678}
confusion matrix:
      0     1
0  1483    32
1   213  1344
---- Validation: 
scalar performance:
{'acc': 0.7523292, 'precision': 0.75817347, 'recall': 0.7512281, 'specificity': 0.7512281, 'f1': 0.750339, 'auroc': 0.8309076, 'binary_precision': 0.7936803, 'binary_recall': 0.67244095, 'binary_specificity': 0.8300153, 'binary_f1_score': 0.7280478}
confusion matrix:
     0    1
0  542  111
1  208  427
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7953488, 'precision': 0.7979269, 'recall': 0.7953489, 'specificity': 0.7953489, 'f1': 0.7949052, 'auroc': 0.87151974, 'binary_precision': 0.82564104, 'binary_recall': 0.74883723, 'binary_specificity': 0.8418605, 'binary_f1_score': 0.7853659}
confusion matrix:
     0    1
0  181   34
1   54  161
early stop counter: 2
val acc:0.7523291707038879, best validation acc: 0.7562111616134644, corresponding to test acc:                         0.7930232286453247 / 0.7953488230705261
after epoch: 30,now: 2024-07-20 13:23:24.362446,epoch time: 0:00:58.817625,used: 0:29:58.847816,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_12_53_25_seed_0_22504805
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 0:29:58.847816 at 2024-07-20 13:23:24.362446
persisted model performance metric: 

scalar performance:
{'acc': 0.7930232, 'precision': 0.7940985, 'recall': 0.7930232, 'specificity': 0.7930232, 'f1': 0.7928339, 'auroc': 0.8672147, 'binary_precision': 0.8118812, 'binary_recall': 0.7627907, 'binary_specificity': 0.82325584, 'binary_f1_score': 0.7865707}
confusion matrix:
     0    1
0  177   38
1   51  164
oracle model performance metric: 

scalar performance:
{'acc': 0.7953488, 'precision': 0.7974336, 'recall': 0.7953488, 'specificity': 0.7953488, 'f1': 0.7949896, 'auroc': 0.8693131, 'binary_precision': 0.822335, 'binary_recall': 0.75348836, 'binary_specificity': 0.8372093, 'binary_f1_score': 0.78640777}
confusion matrix:
     0    1
0  180   35
1   53  162
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_halffreezeblocks_2024-07-20_12-47-21/rule_results/4.csv
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_halffreezeblocks_2024-07-20_12-47-21/rule_results/4.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_halffreezeblocks_2024-07-20_12-47-21/confusion_matrix/4.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 197058 KiB |   7828 MiB |  61331 GiB |  61331 GiB |
|       from large pool | 180662 KiB |   7805 MiB |  60516 GiB |  60516 GiB |
|       from small pool |  16396 KiB |     32 MiB |    815 GiB |    815 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 197058 KiB |   7828 MiB |  61331 GiB |  61331 GiB |
|       from large pool | 180662 KiB |   7805 MiB |  60516 GiB |  60516 GiB |
|       from small pool |  16396 KiB |     32 MiB |    815 GiB |    815 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 195188 KiB |   7827 MiB |  61327 GiB |  61327 GiB |
|       from large pool | 178979 KiB |   7804 MiB |  60513 GiB |  60513 GiB |
|       from small pool |  16209 KiB |     32 MiB |    813 GiB |    813 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   8524 MiB |   8524 MiB |   8524 MiB |      0 B   |
|       from large pool |   8486 MiB |   8486 MiB |   8486 MiB |      0 B   |
|       from small pool |     38 MiB |     38 MiB |     38 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |  58942 KiB | 732464 KiB |  34525 GiB |  34524 GiB |
|       from large pool |  50762 KiB | 730714 KiB |  33707 GiB |  33707 GiB |
|       from small pool |   8180 KiB |  10132 KiB |    817 GiB |    817 GiB |
|---------------------------------------------------------------------------|
| Allocations           |     788    |    1675    |   10386 K  |   10386 K  |
|       from large pool |      79    |     762    |    5637 K  |    5637 K  |
|       from small pool |     709    |    1005    |    4749 K  |    4748 K  |
|---------------------------------------------------------------------------|
| Active allocs         |     788    |    1675    |   10386 K  |   10386 K  |
|       from large pool |      79    |     762    |    5637 K  |    5637 K  |
|       from small pool |     709    |    1005    |    4749 K  |    4748 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     368    |     368    |     368    |       0    |
|       from large pool |     349    |     349    |     349    |       0    |
|       from small pool |      19    |      19    |      19    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      42    |     380    |    6462 K  |    6462 K  |
|       from large pool |      10    |     350    |    4321 K  |    4321 K  |
|       from small pool |      32    |     215    |    2140 K  |    2140 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   7828 MiB |  61331 GiB |  61331 GiB |
|       from large pool |  16640 KiB |   7805 MiB |  60516 GiB |  60516 GiB |
|       from small pool |      0 KiB |     32 MiB |    815 GiB |    815 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   7828 MiB |  61331 GiB |  61331 GiB |
|       from large pool |  16640 KiB |   7805 MiB |  60516 GiB |  60516 GiB |
|       from small pool |      0 KiB |     32 MiB |    815 GiB |    815 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   7827 MiB |  61327 GiB |  61327 GiB |
|       from large pool |  16640 KiB |   7804 MiB |  60513 GiB |  60513 GiB |
|       from small pool |      0 KiB |     32 MiB |    813 GiB |    813 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 256000 KiB |   8524 MiB |   8524 MiB |   8274 MiB |
|       from large pool | 231424 KiB |   8486 MiB |   8486 MiB |   8260 MiB |
|       from small pool |  24576 KiB |     38 MiB |     38 MiB |     14 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  30464 KiB | 732464 KiB |  34525 GiB |  34525 GiB |
|       from large pool |  30464 KiB | 730714 KiB |  33707 GiB |  33707 GiB |
|       from small pool |      0 KiB |  22319 KiB |    817 GiB |    817 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    1675    |   10386 K  |   10386 K  |
|       from large pool |       2    |     762    |    5637 K  |    5637 K  |
|       from small pool |       0    |    1005    |    4749 K  |    4749 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    1675    |   10386 K  |   10386 K  |
|       from large pool |       2    |     762    |    5637 K  |    5637 K  |
|       from small pool |       0    |    1005    |    4749 K  |    4749 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      23    |     368    |     368    |     345    |
|       from large pool |      11    |     349    |     349    |     338    |
|       from small pool |      12    |      19    |      19    |       7    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     380    |    6462 K  |    6462 K  |
|       from large pool |       3    |     350    |    4321 K  |    4321 K  |
|       from small pool |       0    |     215    |    2140 K  |    2140 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   7828 MiB |  61331 GiB |  61331 GiB |
|       from large pool |  16640 KiB |   7805 MiB |  60516 GiB |  60516 GiB |
|       from small pool |      0 KiB |     32 MiB |    815 GiB |    815 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   7828 MiB |  61331 GiB |  61331 GiB |
|       from large pool |  16640 KiB |   7805 MiB |  60516 GiB |  60516 GiB |
|       from small pool |      0 KiB |     32 MiB |    815 GiB |    815 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   7827 MiB |  61327 GiB |  61327 GiB |
|       from large pool |  16640 KiB |   7804 MiB |  60513 GiB |  60513 GiB |
|       from small pool |      0 KiB |     32 MiB |    813 GiB |    813 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 256000 KiB |   8524 MiB |   8524 MiB |   8274 MiB |
|       from large pool | 231424 KiB |   8486 MiB |   8486 MiB |   8260 MiB |
|       from small pool |  24576 KiB |     38 MiB |     38 MiB |     14 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  30464 KiB | 732464 KiB |  34525 GiB |  34525 GiB |
|       from large pool |  30464 KiB | 730714 KiB |  33707 GiB |  33707 GiB |
|       from small pool |      0 KiB |  22319 KiB |    817 GiB |    817 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    1675    |   10386 K  |   10386 K  |
|       from large pool |       2    |     762    |    5637 K  |    5637 K  |
|       from small pool |       0    |    1005    |    4749 K  |    4749 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    1675    |   10386 K  |   10386 K  |
|       from large pool |       2    |     762    |    5637 K  |    5637 K  |
|       from small pool |       0    |    1005    |    4749 K  |    4749 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      23    |     368    |     368    |     345    |
|       from large pool |      11    |     349    |     349    |     338    |
|       from small pool |      12    |      19    |      19    |       7    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     380    |    6462 K  |    6462 K  |
|       from large pool |       3    |     350    |    4321 K  |    4321 K  |
|       from small pool |       0    |     215    |    2140 K  |    2140 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'888c1ef2'
model name: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_13_24_23_seed_1_22504805

 Experiment start at: 2024-07-20 13:24:23.136120
before training, model accuracy: 0.6177777647972107
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.54557294, 'precision': 0.55137885, 'recall': 0.5430951, 'specificity': 0.5430951, 'f1': 0.5252231, 'auroc': 0.52851677, 'binary_precision': 0.5369252, 'binary_recall': 0.7434084, 'binary_specificity': 0.3427818, 'binary_f1_score': 0.62351674}
confusion matrix:
     0     1
0  520   997
1  399  1156
---- Validation: 
scalar performance:
{'acc': 0.48711944, 'precision': 0.46776563, 'recall': 0.48172042, 'specificity': 0.48172042, 'f1': 0.42130536, 'auroc': 0.62264895, 'binary_precision': 0.43835616, 'binary_recall': 0.15238096, 'binary_specificity': 0.8110599, 'binary_f1_score': 0.22614841}
confusion matrix:
     0    1
0  528  123
1  534   96
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5644444, 'precision': 0.5819538, 'recall': 0.5644444, 'specificity': 0.5644444, 'f1': 0.5398677, 'auroc': 0.6701827, 'binary_precision': 0.6198347, 'binary_recall': 0.33333334, 'binary_specificity': 0.79555553, 'binary_f1_score': 0.433526}
confusion matrix:
     0   1
0  179  46
1  150  75
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-20 13:25:28.648365,epoch time: 0:01:05.512245,used: 0:01:05.512245,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_13_24_23_seed_1_22504805
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.5810547, 'precision': 0.581611, 'recall': 0.5800873, 'specificity': 0.5800873, 'f1': 0.5786307, 'auroc': 0.59221244, 'binary_precision': 0.57756156, 'binary_recall': 0.64762515, 'binary_specificity': 0.5125495, 'binary_f1_score': 0.61059}
confusion matrix:
     0     1
0  776   738
1  549  1009
---- Validation: 
scalar performance:
{'acc': 0.4746292, 'precision': 0.41784576, 'recall': 0.46820277, 'specificity': 0.46820277, 'f1': 0.37474445, 'auroc': 0.63119495, 'binary_precision': 0.34532374, 'binary_recall': 0.07619048, 'binary_specificity': 0.86021507, 'binary_f1_score': 0.12483745}
confusion matrix:
     0   1
0  560  91
1  582  48
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5377778, 'precision': 0.5745294, 'recall': 0.5377778, 'specificity': 0.5377778, 'f1': 0.47278303, 'auroc': 0.67948645, 'binary_precision': 0.6268657, 'binary_recall': 0.18666667, 'binary_specificity': 0.8888889, 'binary_f1_score': 0.28767124}
confusion matrix:
     0   1
0  200  25
1  183  42
early stop counter: 1
val acc:0.4746291935443878, best validation acc: 0.4871194362640381, corresponding to test acc:                         0.5644444227218628 / 0.5644444227218628
after epoch: 2,now: 2024-07-20 13:26:28.153846,epoch time: 0:00:59.505481,used: 0:02:05.017726,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_13_24_23_seed_1_22504805
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.65755206, 'precision': 0.65792084, 'recall': 0.6571617, 'specificity': 0.6571617, 'f1': 0.65697503, 'auroc': 0.68887067, 'binary_precision': 0.6526764, 'binary_recall': 0.6904762, 'binary_specificity': 0.6238472, 'binary_f1_score': 0.67104447}
confusion matrix:
     0     1
0  947   571
1  481  1073
---- Validation: 
scalar performance:
{'acc': 0.47931305, 'precision': 0.42898524, 'recall': 0.47286227, 'specificity': 0.47286227, 'f1': 0.3793952, 'auroc': 0.65052545, 'binary_precision': 0.3649635, 'binary_recall': 0.07936508, 'binary_specificity': 0.8663595, 'binary_f1_score': 0.1303781}
confusion matrix:
     0   1
0  564  87
1  580  50
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5377778, 'precision': 0.5745294, 'recall': 0.5377778, 'specificity': 0.5377778, 'f1': 0.47278303, 'auroc': 0.6983309, 'binary_precision': 0.6268657, 'binary_recall': 0.18666667, 'binary_specificity': 0.8888889, 'binary_f1_score': 0.28767124}
confusion matrix:
     0   1
0  200  25
1  183  42
early stop counter: 2
val acc:0.47931304574012756, best validation acc: 0.4871194362640381, corresponding to test acc:                         0.5644444227218628 / 0.5644444227218628
after epoch: 3,now: 2024-07-20 13:27:27.625345,epoch time: 0:00:59.471499,used: 0:03:04.489225,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_13_24_23_seed_1_22504805
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.71940106, 'precision': 0.71965456, 'recall': 0.7191577, 'specificity': 0.7191577, 'f1': 0.7191491, 'auroc': 0.77773064, 'binary_precision': 0.71446306, 'binary_recall': 0.74114615, 'binary_specificity': 0.6971692, 'binary_f1_score': 0.72756}
confusion matrix:
      0     1
0  1059   460
1   402  1151
---- Validation: 
scalar performance:
{'acc': 0.490242, 'precision': 0.45819527, 'recall': 0.48381975, 'specificity': 0.48381975, 'f1': 0.39332563, 'auroc': 0.6668471, 'binary_precision': 0.4172662, 'binary_recall': 0.092063494, 'binary_specificity': 0.875576, 'binary_f1_score': 0.15084526}
confusion matrix:
     0   1
0  570  81
1  572  58
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5311111, 'precision': 0.5673077, 'recall': 0.5311111, 'specificity': 0.5311111, 'f1': 0.45827985, 'auroc': 0.71824193, 'binary_precision': 0.6166667, 'binary_recall': 0.16444445, 'binary_specificity': 0.8977778, 'binary_f1_score': 0.25964913}
confusion matrix:
     0   1
0  202  23
1  188  37
better model found
persisted
after epoch: 4,now: 2024-07-20 13:28:27.455462,epoch time: 0:00:59.830117,used: 0:04:04.319342,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_13_24_23_seed_1_22504805
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.7639974, 'precision': 0.76396453, 'recall': 0.7639277, 'specificity': 0.7639277, 'f1': 0.7639422, 'auroc': 0.83501077, 'binary_precision': 0.7658349, 'binary_recall': 0.7692802, 'binary_specificity': 0.7585752, 'binary_f1_score': 0.76755375}
confusion matrix:
      0     1
0  1150   366
1   359  1197
---- Validation: 
scalar performance:
{'acc': 0.49336457, 'precision': 0.46626514, 'recall': 0.48694316, 'specificity': 0.48694316, 'f1': 0.3970418, 'auroc': 0.6815351, 'binary_precision': 0.43165466, 'binary_recall': 0.0952381, 'binary_specificity': 0.8786482, 'binary_f1_score': 0.15604681}
confusion matrix:
     0   1
0  572  79
1  570  60
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5377778, 'precision': 0.58537567, 'recall': 0.5377778, 'specificity': 0.5377778, 'f1': 0.46292087, 'auroc': 0.73102224, 'binary_precision': 0.64912283, 'binary_recall': 0.16444445, 'binary_specificity': 0.9111111, 'binary_f1_score': 0.26241136}
confusion matrix:
     0   1
0  205  20
1  188  37
better model found
persisted
after epoch: 5,now: 2024-07-20 13:29:27.520596,epoch time: 0:01:00.065134,used: 0:05:04.384476,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_13_24_23_seed_1_22504805
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.7841797, 'precision': 0.7844269, 'recall': 0.78435934, 'specificity': 0.78435934, 'f1': 0.78417695, 'auroc': 0.8528413, 'binary_precision': 0.79667777, 'binary_recall': 0.77056557, 'binary_specificity': 0.79815304, 'binary_f1_score': 0.7834041}
confusion matrix:
      0     1
0  1210   306
1   357  1199
---- Validation: 
scalar performance:
{'acc': 0.50897735, 'precision': 0.5065657, 'recall': 0.50263697, 'specificity': 0.50263697, 'f1': 0.41820025, 'auroc': 0.69566727, 'binary_precision': 0.50344825, 'binary_recall': 0.11587302, 'binary_specificity': 0.8894009, 'binary_f1_score': 0.1883871}
confusion matrix:
     0   1
0  579  72
1  557  73
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.54, 'precision': 0.58653843, 'recall': 0.54, 'specificity': 0.54, 'f1': 0.46854943, 'auroc': 0.7386074, 'binary_precision': 0.65, 'binary_recall': 0.17333333, 'binary_specificity': 0.9066667, 'binary_f1_score': 0.2736842}
confusion matrix:
     0   1
0  204  21
1  186  39
better model found
persisted
after epoch: 6,now: 2024-07-20 13:30:27.162213,epoch time: 0:00:59.641617,used: 0:06:04.026093,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_13_24_23_seed_1_22504805
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.80891925, 'precision': 0.809421, 'recall': 0.8092128, 'specificity': 0.8092128, 'f1': 0.8089086, 'auroc': 0.88198626, 'binary_precision': 0.8261745, 'binary_recall': 0.7896087, 'binary_specificity': 0.8288169, 'binary_f1_score': 0.8074779}
confusion matrix:
      0     1
0  1254   259
1   328  1231
---- Validation: 
scalar performance:
{'acc': 0.50897735, 'precision': 0.5065508, 'recall': 0.5026626, 'specificity': 0.5026626, 'f1': 0.41904762, 'auroc': 0.7098335, 'binary_precision': 0.50340134, 'binary_recall': 0.11746032, 'binary_specificity': 0.8878648, 'binary_f1_score': 0.1904762}
confusion matrix:
     0   1
0  578  73
1  556  74
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5422222, 'precision': 0.59265685, 'recall': 0.5422222, 'specificity': 0.5422222, 'f1': 0.47011614, 'auroc': 0.7536198, 'binary_precision': 0.66101694, 'binary_recall': 0.17333333, 'binary_specificity': 0.9111111, 'binary_f1_score': 0.27464786}
confusion matrix:
     0   1
0  205  20
1  186  39
early stop counter: 1
val acc:0.5089773535728455, best validation acc: 0.5089773535728455, corresponding to test acc:                         0.5400000214576721 / 0.5644444227218628
after epoch: 7,now: 2024-07-20 13:31:26.550905,epoch time: 0:00:59.388692,used: 0:07:03.414785,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_13_24_23_seed_1_22504805
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.8300781, 'precision': 0.8306192, 'recall': 0.8303142, 'specificity': 0.8303142, 'f1': 0.83005977, 'auroc': 0.89847076, 'binary_precision': 0.8472409, 'binary_recall': 0.8101673, 'binary_specificity': 0.8504611, 'binary_f1_score': 0.8282895}
confusion matrix:
      0     1
0  1291   227
1   295  1259
---- Validation: 
scalar performance:
{'acc': 0.51600313, 'precision': 0.5225385, 'recall': 0.50985664, 'specificity': 0.50985664, 'f1': 0.43265137, 'auroc': 0.7219882, 'binary_precision': 0.53125, 'binary_recall': 0.13492064, 'binary_specificity': 0.8847926, 'binary_f1_score': 0.21518987}
confusion matrix:
     0   1
0  576  75
1  545  85
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.56, 'precision': 0.62458473, 'recall': 0.56, 'specificity': 0.56, 'f1': 0.4944853, 'auroc': 0.764326, 'binary_precision': 0.71428573, 'binary_recall': 0.2, 'binary_specificity': 0.92, 'binary_f1_score': 0.3125}
confusion matrix:
     0   1
0  207  18
1  180  45
better model found
persisted
after epoch: 8,now: 2024-07-20 13:32:26.217283,epoch time: 0:00:59.666378,used: 0:08:03.081163,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_13_24_23_seed_1_22504805
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.8388672, 'precision': 0.8424414, 'recall': 0.8395308, 'specificity': 0.8395308, 'f1': 0.8386085, 'auroc': 0.9031347, 'binary_precision': 0.88083273, 'binary_recall': 0.7885604, 'binary_specificity': 0.8905013, 'binary_f1_score': 0.8321465}
confusion matrix:
      0     1
0  1350   166
1   329  1227
---- Validation: 
scalar performance:
{'acc': 0.5152225, 'precision': 0.5234504, 'recall': 0.5087302, 'specificity': 0.5087302, 'f1': 0.42045784, 'auroc': 0.73148274, 'binary_precision': 0.5338346, 'binary_recall': 0.11269841, 'binary_specificity': 0.9047619, 'binary_f1_score': 0.18610746}
confusion matrix:
     0   1
0  589  62
1  559  71
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.55777776, 'precision': 0.6413317, 'recall': 0.55777776, 'specificity': 0.55777776, 'f1': 0.48108315, 'auroc': 0.7728395, 'binary_precision': 0.75, 'binary_recall': 0.17333333, 'binary_specificity': 0.94222224, 'binary_f1_score': 0.28158844}
confusion matrix:
     0   1
0  212  13
1  186  39
early stop counter: 1
val acc:0.5152224898338318, best validation acc: 0.5160031318664551, corresponding to test acc:                         0.5600000023841858 / 0.5644444227218628
after epoch: 9,now: 2024-07-20 13:33:25.698376,epoch time: 0:00:59.481093,used: 0:09:02.562256,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_13_24_23_seed_1_22504805
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.8544922, 'precision': 0.8582998, 'recall': 0.85516703, 'specificity': 0.85516703, 'f1': 0.85425085, 'auroc': 0.9181427, 'binary_precision': 0.8986341, 'binary_recall': 0.8033419, 'binary_specificity': 0.9069921, 'binary_f1_score': 0.8483203}
confusion matrix:
      0     1
0  1375   141
1   306  1250
---- Validation: 
scalar performance:
{'acc': 0.5175644, 'precision': 0.528957, 'recall': 0.5111367, 'specificity': 0.5111367, 'f1': 0.42541546, 'auroc': 0.74157465, 'binary_precision': 0.54347825, 'binary_recall': 0.11904762, 'binary_specificity': 0.9032258, 'binary_f1_score': 0.19531249}
confusion matrix:
     0   1
0  588  63
1  555  75
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5555556, 'precision': 0.63821316, 'recall': 0.5555556, 'specificity': 0.5555556, 'f1': 0.47742474, 'auroc': 0.78457284, 'binary_precision': 0.74509805, 'binary_recall': 0.16888888, 'binary_specificity': 0.94222224, 'binary_f1_score': 0.2753623}
confusion matrix:
     0   1
0  212  13
1  187  38
better model found
persisted
after epoch: 10,now: 2024-07-20 13:34:25.690205,epoch time: 0:00:59.991829,used: 0:10:02.554085,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_13_24_23_seed_1_22504805
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.8574219, 'precision': 0.85980964, 'recall': 0.85795724, 'specificity': 0.85795724, 'f1': 0.85729384, 'auroc': 0.9254168, 'binary_precision': 0.8925562, 'binary_recall': 0.816838, 'binary_specificity': 0.8990765, 'binary_f1_score': 0.85302013}
confusion matrix:
      0     1
0  1363   153
1   285  1271
---- Validation: 
scalar performance:
{'acc': 0.5230289, 'precision': 0.53952616, 'recall': 0.51682025, 'specificity': 0.51682025, 'f1': 0.43890905, 'auroc': 0.7469729, 'binary_precision': 0.5612903, 'binary_recall': 0.13809524, 'binary_specificity': 0.8955453, 'binary_f1_score': 0.22165605}
confusion matrix:
     0   1
0  583  68
1  543  87
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.56222224, 'precision': 0.6309445, 'recall': 0.56222224, 'specificity': 0.56222224, 'f1': 0.49610925, 'auroc': 0.7931062, 'binary_precision': 0.7258065, 'binary_recall': 0.2, 'binary_specificity': 0.92444444, 'binary_f1_score': 0.31358886}
confusion matrix:
     0   1
0  208  17
1  180  45
better model found
persisted
after epoch: 11,now: 2024-07-20 13:35:25.761075,epoch time: 0:01:00.070870,used: 0:11:02.624955,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_13_24_23_seed_1_22504805
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.8723958, 'precision': 0.8750098, 'recall': 0.8729774, 'specificity': 0.8729774, 'f1': 0.8722762, 'auroc': 0.935537, 'binary_precision': 0.9099226, 'binary_recall': 0.83044314, 'binary_specificity': 0.91551155, 'binary_f1_score': 0.86836797}
confusion matrix:
      0     1
0  1387   128
1   264  1293
---- Validation: 
scalar performance:
{'acc': 0.5300546, 'precision': 0.5557607, 'recall': 0.52386075, 'specificity': 0.52386075, 'f1': 0.4475664, 'auroc': 0.7547655, 'binary_precision': 0.5897436, 'binary_recall': 0.14603175, 'binary_specificity': 0.9016897, 'binary_f1_score': 0.2340967}
confusion matrix:
     0   1
0  587  64
1  538  92
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5688889, 'precision': 0.6511769, 'recall': 0.5688889, 'specificity': 0.5688889, 'f1': 0.5009832, 'auroc': 0.79703707, 'binary_precision': 0.7627119, 'binary_recall': 0.2, 'binary_specificity': 0.93777776, 'binary_f1_score': 0.31690142}
confusion matrix:
     0   1
0  211  14
1  180  45
new oracle model saved
better model found
persisted
after epoch: 12,now: 2024-07-20 13:36:25.521976,epoch time: 0:00:59.760901,used: 0:12:02.385856,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_13_24_23_seed_1_22504805
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.87369794, 'precision': 0.8768575, 'recall': 0.87430394, 'specificity': 0.87430394, 'f1': 0.8735416, 'auroc': 0.9365318, 'binary_precision': 0.91477275, 'binary_recall': 0.8277635, 'binary_specificity': 0.9208443, 'binary_f1_score': 0.8690958}
confusion matrix:
      0     1
0  1396   120
1   268  1288
---- Validation: 
scalar performance:
{'acc': 0.53942233, 'precision': 0.57189065, 'recall': 0.53343576, 'specificity': 0.53343576, 'f1': 0.46455592, 'auroc': 0.7597713, 'binary_precision': 0.61627907, 'binary_recall': 0.16825397, 'binary_specificity': 0.8986175, 'binary_f1_score': 0.26433915}
confusion matrix:
     0    1
0  585   66
1  524  106
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5644444, 'precision': 0.63036966, 'recall': 0.5644444, 'specificity': 0.5644444, 'f1': 0.5014132, 'auroc': 0.8034963, 'binary_precision': 0.72307694, 'binary_recall': 0.20888889, 'binary_specificity': 0.92, 'binary_f1_score': 0.32413796}
confusion matrix:
     0   1
0  207  18
1  178  47
better model found
persisted
after epoch: 13,now: 2024-07-20 13:37:25.440888,epoch time: 0:00:59.918912,used: 0:13:02.304768,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_13_24_23_seed_1_22504805
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.8889974, 'precision': 0.89262307, 'recall': 0.8896046, 'specificity': 0.8896046, 'f1': 0.8888361, 'auroc': 0.94087136, 'binary_precision': 0.93357146, 'binary_recall': 0.8405145, 'binary_specificity': 0.9386948, 'binary_f1_score': 0.8846023}
confusion matrix:
      0     1
0  1424    93
1   248  1307
---- Validation: 
scalar performance:
{'acc': 0.5464481, 'precision': 0.584316, 'recall': 0.54055303, 'specificity': 0.54055303, 'f1': 0.4751988, 'auroc': 0.7639675, 'binary_precision': 0.6368715, 'binary_recall': 0.18095239, 'binary_specificity': 0.90015364, 'binary_f1_score': 0.28182942}
confusion matrix:
     0    1
0  586   65
1  516  114
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5688889, 'precision': 0.63936067, 'recall': 0.5688889, 'specificity': 0.5688889, 'f1': 0.50650084, 'auroc': 0.8046223, 'binary_precision': 0.73846155, 'binary_recall': 0.21333334, 'binary_specificity': 0.92444444, 'binary_f1_score': 0.3310345}
confusion matrix:
     0   1
0  208  17
1  177  48
better model found
persisted
after epoch: 14,now: 2024-07-20 13:38:25.079020,epoch time: 0:00:59.638132,used: 0:14:01.942900,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_13_24_23_seed_1_22504805
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.8828125, 'precision': 0.8880484, 'recall': 0.88358116, 'specificity': 0.88358116, 'f1': 0.88254726, 'auroc': 0.9419478, 'binary_precision': 0.9364964, 'binary_recall': 0.82455015, 'binary_specificity': 0.9426121, 'binary_f1_score': 0.87696517}
confusion matrix:
      0     1
0  1429    87
1   273  1283
---- Validation: 
scalar performance:
{'acc': 0.5511319, 'precision': 0.59575045, 'recall': 0.5451869, 'specificity': 0.5451869, 'f1': 0.47922593, 'auroc': 0.7688416, 'binary_precision': 0.6571429, 'binary_recall': 0.18253969, 'binary_specificity': 0.9078341, 'binary_f1_score': 0.28571427}
confusion matrix:
     0    1
0  591   60
1  515  115
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5711111, 'precision': 0.6420455, 'recall': 0.5711111, 'specificity': 0.5711111, 'f1': 0.5099284, 'auroc': 0.8111408, 'binary_precision': 0.74242425, 'binary_recall': 0.21777777, 'binary_specificity': 0.92444444, 'binary_f1_score': 0.33676976}
confusion matrix:
     0   1
0  208  17
1  176  49
new oracle model saved
better model found
persisted
after epoch: 15,now: 2024-07-20 13:39:25.328058,epoch time: 0:01:00.249038,used: 0:15:02.191938,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_13_24_23_seed_1_22504805
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.8902995, 'precision': 0.8952518, 'recall': 0.8911573, 'specificity': 0.8911573, 'f1': 0.89008725, 'auroc': 0.9448271, 'binary_precision': 0.9433962, 'binary_recall': 0.83386785, 'binary_specificity': 0.9484468, 'binary_f1_score': 0.885257}
confusion matrix:
      0     1
0  1435    78
1   259  1300
---- Validation: 
scalar performance:
{'acc': 0.55581576, 'precision': 0.604727, 'recall': 0.5498976, 'specificity': 0.5498976, 'f1': 0.48535144, 'auroc': 0.7726495, 'binary_precision': 0.6723164, 'binary_recall': 0.18888889, 'binary_specificity': 0.9109063, 'binary_f1_score': 0.29491943}
confusion matrix:
     0    1
0  593   58
1  511  119
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.57555556, 'precision': 0.65092325, 'recall': 0.57555556, 'specificity': 0.57555556, 'f1': 0.51500684, 'auroc': 0.81617785, 'binary_precision': 0.75757575, 'binary_recall': 0.22222222, 'binary_specificity': 0.9288889, 'binary_f1_score': 0.34364262}
confusion matrix:
     0   1
0  209  16
1  175  50
new oracle model saved
better model found
persisted
after epoch: 16,now: 2024-07-20 13:40:25.257062,epoch time: 0:00:59.929004,used: 0:16:02.120942,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_13_24_23_seed_1_22504805
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.87630206, 'precision': 0.8823401, 'recall': 0.8770886, 'specificity': 0.8770886, 'f1': 0.87595713, 'auroc': 0.9383557, 'binary_precision': 0.9335793, 'binary_recall': 0.8135048, 'binary_specificity': 0.9406724, 'binary_f1_score': 0.8694158}
confusion matrix:
      0     1
0  1427    90
1   290  1265
---- Validation: 
scalar performance:
{'acc': 0.5636222, 'precision': 0.61310863, 'recall': 0.5579109, 'specificity': 0.5579109, 'f1': 0.49966428, 'auroc': 0.7759198, 'binary_precision': 0.68393785, 'binary_recall': 0.20952381, 'binary_specificity': 0.906298, 'binary_f1_score': 0.32077765}
confusion matrix:
     0    1
0  590   61
1  498  132
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5911111, 'precision': 0.664, 'recall': 0.5911111, 'specificity': 0.5911111, 'f1': 0.53999996, 'auroc': 0.8211161, 'binary_precision': 0.7733333, 'binary_recall': 0.25777778, 'binary_specificity': 0.92444444, 'binary_f1_score': 0.38666666}
confusion matrix:
     0   1
0  208  17
1  167  58
new oracle model saved
better model found
persisted
after epoch: 17,now: 2024-07-20 13:41:25.149926,epoch time: 0:00:59.892864,used: 0:17:02.013806,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_13_24_23_seed_1_22504805
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.8964844, 'precision': 0.90126026, 'recall': 0.89724845, 'specificity': 0.89724845, 'f1': 0.896287, 'auroc': 0.9504051, 'binary_precision': 0.94858795, 'binary_recall': 0.8413616, 'binary_specificity': 0.9531353, 'binary_f1_score': 0.8917631}
confusion matrix:
      0     1
0  1444    71
1   247  1310
---- Validation: 
scalar performance:
{'acc': 0.57220924, 'precision': 0.6253499, 'recall': 0.56661546, 'specificity': 0.56661546, 'f1': 0.51229155, 'auroc': 0.7804599, 'binary_precision': 0.7029703, 'binary_recall': 0.22539683, 'binary_specificity': 0.9078341, 'binary_f1_score': 0.34134617}
confusion matrix:
     0    1
0  591   60
1  488  142
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5911111, 'precision': 0.664, 'recall': 0.5911111, 'specificity': 0.5911111, 'f1': 0.53999996, 'auroc': 0.82350624, 'binary_precision': 0.7733333, 'binary_recall': 0.25777778, 'binary_specificity': 0.92444444, 'binary_f1_score': 0.38666666}
confusion matrix:
     0   1
0  208  17
1  167  58
better model found
persisted
after epoch: 18,now: 2024-07-20 13:42:24.584043,epoch time: 0:00:59.434117,used: 0:18:01.447923,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_13_24_23_seed_1_22504805
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.89908856, 'precision': 0.905051, 'recall': 0.8998544, 'specificity': 0.8998544, 'f1': 0.8988277, 'auroc': 0.95103335, 'binary_precision': 0.9573843, 'binary_recall': 0.8379421, 'binary_specificity': 0.96176666, 'binary_f1_score': 0.89369}
confusion matrix:
      0     1
0  1459    58
1   252  1303
---- Validation: 
scalar performance:
{'acc': 0.5800156, 'precision': 0.6330073, 'recall': 0.5746032, 'specificity': 0.5746032, 'f1': 0.5252732, 'auroc': 0.7847146, 'binary_precision': 0.712963, 'binary_recall': 0.24444444, 'binary_specificity': 0.9047619, 'binary_f1_score': 0.36406618}
confusion matrix:
     0    1
0  589   62
1  476  154
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.59555554, 'precision': 0.6650517, 'recall': 0.59555554, 'specificity': 0.59555554, 'f1': 0.54797333, 'auroc': 0.82793087, 'binary_precision': 0.7721519, 'binary_recall': 0.2711111, 'binary_specificity': 0.92, 'binary_f1_score': 0.40131578}
confusion matrix:
     0   1
0  207  18
1  164  61
new oracle model saved
better model found
persisted
after epoch: 19,now: 2024-07-20 13:43:24.719188,epoch time: 0:01:00.135145,used: 0:19:01.583068,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_13_24_23_seed_1_22504805
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.8922526, 'precision': 0.8991532, 'recall': 0.8930352, 'specificity': 0.8930352, 'f1': 0.89190984, 'auroc': 0.95060813, 'binary_precision': 0.9546468, 'binary_recall': 0.82625484, 'binary_specificity': 0.95981556, 'binary_f1_score': 0.8858227}
confusion matrix:
      0     1
0  1457    61
1   270  1284
---- Validation: 
scalar performance:
{'acc': 0.5815769, 'precision': 0.6397748, 'recall': 0.57606244, 'specificity': 0.57606244, 'f1': 0.5247385, 'auroc': 0.7877356, 'binary_precision': 0.72596157, 'binary_recall': 0.23968254, 'binary_specificity': 0.9124424, 'binary_f1_score': 0.36038184}
confusion matrix:
     0    1
0  594   57
1  479  151
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5933333, 'precision': 0.66981745, 'recall': 0.59333336, 'specificity': 0.59333336, 'f1': 0.5417337, 'auroc': 0.83160496, 'binary_precision': 0.7837838, 'binary_recall': 0.25777778, 'binary_specificity': 0.9288889, 'binary_f1_score': 0.38795987}
confusion matrix:
     0   1
0  209  16
1  167  58
better model found
persisted
after epoch: 20,now: 2024-07-20 13:44:24.822867,epoch time: 0:01:00.103679,used: 0:20:01.686747,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_13_24_23_seed_1_22504805
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.898112, 'precision': 0.9052166, 'recall': 0.89894617, 'specificity': 0.89894617, 'f1': 0.8977878, 'auroc': 0.95249426, 'binary_precision': 0.9620536, 'binary_recall': 0.83151126, 'binary_specificity': 0.966381, 'binary_f1_score': 0.8920318}
confusion matrix:
      0     1
0  1466    51
1   262  1293
---- Validation: 
scalar performance:
{'acc': 0.59406716, 'precision': 0.64975464, 'recall': 0.58886325, 'specificity': 0.58886325, 'f1': 0.5454347, 'auroc': 0.7931875, 'binary_precision': 0.73706895, 'binary_recall': 0.27142859, 'binary_specificity': 0.906298, 'binary_f1_score': 0.3967518}
confusion matrix:
     0    1
0  590   61
1  459  171
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6155556, 'precision': 0.69028103, 'recall': 0.6155556, 'specificity': 0.6155556, 'f1': 0.57370263, 'auroc': 0.83774817, 'binary_precision': 0.8095238, 'binary_recall': 0.30222222, 'binary_specificity': 0.9288889, 'binary_f1_score': 0.44012943}
confusion matrix:
     0   1
0  209  16
1  157  68
new oracle model saved
better model found
persisted
after epoch: 21,now: 2024-07-20 13:45:24.677597,epoch time: 0:00:59.854730,used: 0:21:01.541477,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_13_24_23_seed_1_22504805
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9042969, 'precision': 0.90740466, 'recall': 0.90485406, 'specificity': 0.90485406, 'f1': 0.9041871, 'auroc': 0.95725274, 'binary_precision': 0.9462137, 'binary_recall': 0.8598071, 'binary_specificity': 0.9499011, 'binary_f1_score': 0.90094346}
confusion matrix:
      0     1
0  1441    76
1   218  1337
---- Validation: 
scalar performance:
{'acc': 0.6159251, 'precision': 0.6706882, 'recall': 0.6111111, 'specificity': 0.6111111, 'f1': 0.5769099, 'auroc': 0.7967474, 'binary_precision': 0.7633588, 'binary_recall': 0.31746033, 'binary_specificity': 0.9047619, 'binary_f1_score': 0.44843048}
confusion matrix:
     0    1
0  589   62
1  430  200
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.64666665, 'precision': 0.7121428, 'recall': 0.64666665, 'specificity': 0.64666665, 'f1': 0.6171237, 'auroc': 0.84185684, 'binary_precision': 0.83, 'binary_recall': 0.36888888, 'binary_specificity': 0.92444444, 'binary_f1_score': 0.5107692}
confusion matrix:
     0   1
0  208  17
1  142  83
new oracle model saved
better model found
persisted
after epoch: 22,now: 2024-07-20 13:46:24.560583,epoch time: 0:00:59.882986,used: 0:22:01.424463,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_13_24_23_seed_1_22504805
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.89713544, 'precision': 0.9041538, 'recall': 0.89796543, 'specificity': 0.89796543, 'f1': 0.89681196, 'auroc': 0.9536737, 'binary_precision': 0.9605948, 'binary_recall': 0.8308682, 'binary_specificity': 0.9650626, 'binary_f1_score': 0.89103454}
confusion matrix:
      0     1
0  1464    53
1   263  1292
---- Validation: 
scalar performance:
{'acc': 0.61202186, 'precision': 0.6669751, 'recall': 0.60714287, 'specificity': 0.60714287, 'f1': 0.57148397, 'auroc': 0.79883695, 'binary_precision': 0.75875485, 'binary_recall': 0.30952382, 'binary_specificity': 0.9047619, 'binary_f1_score': 0.43968433}
confusion matrix:
     0    1
0  589   62
1  435  195
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.64666665, 'precision': 0.7121428, 'recall': 0.64666665, 'specificity': 0.64666665, 'f1': 0.6171237, 'auroc': 0.84474075, 'binary_precision': 0.83, 'binary_recall': 0.36888888, 'binary_specificity': 0.92444444, 'binary_f1_score': 0.5107692}
confusion matrix:
     0   1
0  208  17
1  142  83
early stop counter: 1
val acc:0.6120218634605408, best validation acc: 0.6159250736236572, corresponding to test acc:                         0.6466666460037231 / 0.6466666460037231
after epoch: 23,now: 2024-07-20 13:47:23.838299,epoch time: 0:00:59.277716,used: 0:23:00.702179,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_13_24_23_seed_1_22504805
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9016927, 'precision': 0.9089565, 'recall': 0.90248805, 'specificity': 0.90248805, 'f1': 0.901369, 'auroc': 0.95892274, 'binary_precision': 0.966468, 'binary_recall': 0.83462036, 'binary_specificity': 0.97035575, 'binary_f1_score': 0.8957182}
confusion matrix:
      0     1
0  1473    45
1   257  1297
---- Validation: 
scalar performance:
{'acc': 0.60655737, 'precision': 0.6655358, 'recall': 0.6014849, 'specificity': 0.6014849, 'f1': 0.56189674, 'auroc': 0.80219686, 'binary_precision': 0.76033056, 'binary_recall': 0.2920635, 'binary_specificity': 0.9109063, 'binary_f1_score': 0.42201838}
confusion matrix:
     0    1
0  593   58
1  446  184
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.64, 'precision': 0.7134725, 'recall': 0.64, 'specificity': 0.64, 'f1': 0.6061078, 'auroc': 0.8468741, 'binary_precision': 0.83870965, 'binary_recall': 0.34666666, 'binary_specificity': 0.93333334, 'binary_f1_score': 0.49056605}
confusion matrix:
     0   1
0  210  15
1  147  78
early stop counter: 2
val acc:0.6065573692321777, best validation acc: 0.6159250736236572, corresponding to test acc:                         0.6466666460037231 / 0.6466666460037231
after epoch: 24,now: 2024-07-20 13:48:23.468713,epoch time: 0:00:59.630414,used: 0:24:00.332593,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_13_24_23_seed_1_22504805
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.89713544, 'precision': 0.90365756, 'recall': 0.89785063, 'specificity': 0.89785063, 'f1': 0.89682686, 'auroc': 0.9514258, 'binary_precision': 0.95780903, 'binary_recall': 0.833226, 'binary_specificity': 0.9624753, 'binary_f1_score': 0.89118457}
confusion matrix:
      0     1
0  1462    57
1   259  1294
---- Validation: 
scalar performance:
{'acc': 0.6206089, 'precision': 0.6769241, 'recall': 0.61582184, 'specificity': 0.61582184, 'f1': 0.5825045, 'auroc': 0.8049984, 'binary_precision': 0.77272725, 'binary_recall': 0.32380953, 'binary_specificity': 0.9078341, 'binary_f1_score': 0.45637587}
confusion matrix:
     0    1
0  591   60
1  426  204
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.66, 'precision': 0.72213686, 'recall': 0.65999997, 'specificity': 0.65999997, 'f1': 0.6344358, 'auroc': 0.8509432, 'binary_precision': 0.8396226, 'binary_recall': 0.39555556, 'binary_specificity': 0.92444444, 'binary_f1_score': 0.5377643}
confusion matrix:
     0   1
0  208  17
1  136  89
new oracle model saved
better model found
persisted
after epoch: 25,now: 2024-07-20 13:49:23.528083,epoch time: 0:01:00.059370,used: 0:25:00.391963,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_13_24_23_seed_1_22504805
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.90494794, 'precision': 0.912089, 'recall': 0.9057791, 'specificity': 0.9057791, 'f1': 0.904649, 'auroc': 0.9639936, 'binary_precision': 0.96951675, 'binary_recall': 0.8385852, 'binary_specificity': 0.972973, 'binary_f1_score': 0.89931035}
confusion matrix:
      0     1
0  1476    41
1   251  1304
---- Validation: 
scalar performance:
{'acc': 0.618267, 'precision': 0.677709, 'recall': 0.61336404, 'specificity': 0.61336404, 'f1': 0.5779328, 'auroc': 0.8070612, 'binary_precision': 0.7764706, 'binary_recall': 0.31428573, 'binary_specificity': 0.9124424, 'binary_f1_score': 0.44745764}
confusion matrix:
     0    1
0  594   57
1  432  198
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.66888887, 'precision': 0.7344779, 'recall': 0.6688889, 'specificity': 0.6688889, 'f1': 0.643993, 'auroc': 0.8544593, 'binary_precision': 0.8584906, 'binary_recall': 0.40444446, 'binary_specificity': 0.93333334, 'binary_f1_score': 0.5498489}
confusion matrix:
     0   1
0  210  15
1  134  91
new oracle model saved
early stop counter: 1
val acc:0.6182669997215271, best validation acc: 0.620608925819397, corresponding to test acc:                         0.6600000262260437 / 0.6688888669013977
after epoch: 26,now: 2024-07-20 13:50:23.220945,epoch time: 0:00:59.692862,used: 0:26:00.084825,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_13_24_23_seed_1_22504805
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.9095052, 'precision': 0.914806, 'recall': 0.9102614, 'specificity': 0.9102614, 'f1': 0.9093114, 'auroc': 0.9639605, 'binary_precision': 0.9650655, 'binary_recall': 0.8521851, 'binary_specificity': 0.9683377, 'binary_f1_score': 0.9051195}
confusion matrix:
      0     1
0  1468    48
1   230  1326
---- Validation: 
scalar performance:
{'acc': 0.63544106, 'precision': 0.68563724, 'recall': 0.6310292, 'specificity': 0.6310292, 'f1': 0.60455567, 'auroc': 0.812696, 'binary_precision': 0.778157, 'binary_recall': 0.36190477, 'binary_specificity': 0.90015364, 'binary_f1_score': 0.49404117}
confusion matrix:
     0    1
0  586   65
1  402  228
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.69777775, 'precision': 0.74893713, 'recall': 0.69777775, 'specificity': 0.69777775, 'f1': 0.68140924, 'auroc': 0.860721, 'binary_precision': 0.86178863, 'binary_recall': 0.47111112, 'binary_specificity': 0.92444444, 'binary_f1_score': 0.60919535}
confusion matrix:
     0    1
0  208   17
1  119  106
new oracle model saved
better model found
persisted
after epoch: 27,now: 2024-07-20 13:51:23.067656,epoch time: 0:00:59.846711,used: 0:26:59.931536,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_13_24_23_seed_1_22504805
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.9117839, 'precision': 0.91678905, 'recall': 0.9123677, 'specificity': 0.9123677, 'f1': 0.9115923, 'auroc': 0.960497, 'binary_precision': 0.9651416, 'binary_recall': 0.8563144, 'binary_specificity': 0.96842104, 'binary_f1_score': 0.90747696}
confusion matrix:
      0     1
0  1472    48
1   223  1329
---- Validation: 
scalar performance:
{'acc': 0.6479313, 'precision': 0.6954371, 'recall': 0.6437532, 'specificity': 0.6437532, 'f1': 0.6212497, 'auroc': 0.8152415, 'binary_precision': 0.78778136, 'binary_recall': 0.3888889, 'binary_specificity': 0.8986175, 'binary_f1_score': 0.52072257}
confusion matrix:
     0    1
0  585   66
1  385  245
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7088889, 'precision': 0.7542068, 'recall': 0.7088889, 'specificity': 0.7088889, 'f1': 0.6953095, 'auroc': 0.86261725, 'binary_precision': 0.86153847, 'binary_recall': 0.4977778, 'binary_specificity': 0.92, 'binary_f1_score': 0.6309859}
confusion matrix:
     0    1
0  207   18
1  113  112
new oracle model saved
better model found
persisted
after epoch: 28,now: 2024-07-20 13:52:23.021161,epoch time: 0:00:59.953505,used: 0:27:59.885041,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_13_24_23_seed_1_22504805
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9095052, 'precision': 0.91706276, 'recall': 0.9104939, 'specificity': 0.9104939, 'f1': 0.9092206, 'auroc': 0.9638623, 'binary_precision': 0.97690016, 'binary_recall': 0.8414634, 'binary_specificity': 0.97952443, 'binary_f1_score': 0.9041379}
confusion matrix:
      0     1
0  1483    31
1   247  1311
---- Validation: 
scalar performance:
{'acc': 0.6299766, 'precision': 0.68627816, 'recall': 0.62532, 'specificity': 0.62532, 'f1': 0.59488857, 'auroc': 0.81511474, 'binary_precision': 0.78467155, 'binary_recall': 0.34126985, 'binary_specificity': 0.9093702, 'binary_f1_score': 0.47566372}
confusion matrix:
     0    1
0  592   59
1  415  215
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6911111, 'precision': 0.74971604, 'recall': 0.6911111, 'specificity': 0.6911111, 'f1': 0.67185855, 'auroc': 0.86218274, 'binary_precision': 0.87068963, 'binary_recall': 0.4488889, 'binary_specificity': 0.93333334, 'binary_f1_score': 0.5923754}
confusion matrix:
     0    1
0  210   15
1  124  101
early stop counter: 1
val acc:0.6299765706062317, best validation acc: 0.6479312777519226, corresponding to test acc:                         0.7088888883590698 / 0.7088888883590698
after epoch: 29,now: 2024-07-20 13:53:22.658509,epoch time: 0:00:59.637348,used: 0:28:59.522389,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_13_24_23_seed_1_22504805
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.9039714, 'precision': 0.9101395, 'recall': 0.90483034, 'specificity': 0.90483034, 'f1': 0.9037262, 'auroc': 0.964905, 'binary_precision': 0.9639706, 'binary_recall': 0.8420039, 'binary_specificity': 0.9676568, 'binary_f1_score': 0.8988687}
confusion matrix:
      0     1
0  1466    49
1   246  1311
---- Validation: 
scalar performance:
{'acc': 0.6416862, 'precision': 0.696311, 'recall': 0.6372248, 'specificity': 0.6372248, 'f1': 0.61058855, 'auroc': 0.8190963, 'binary_precision': 0.7958478, 'binary_recall': 0.36507937, 'binary_specificity': 0.9093702, 'binary_f1_score': 0.5005441}
confusion matrix:
     0    1
0  592   59
1  400  230
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.70666665, 'precision': 0.75753844, 'recall': 0.7066667, 'specificity': 0.7066667, 'f1': 0.69142854, 'auroc': 0.86644936, 'binary_precision': 0.872, 'binary_recall': 0.48444444, 'binary_specificity': 0.9288889, 'binary_f1_score': 0.62285715}
confusion matrix:
     0    1
0  209   16
1  116  109
early stop counter: 2
val acc:0.641686201095581, best validation acc: 0.6479312777519226, corresponding to test acc:                         0.7088888883590698 / 0.7088888883590698
after epoch: 30,now: 2024-07-20 13:54:22.630779,epoch time: 0:00:59.972270,used: 0:29:59.494659,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_13_24_23_seed_1_22504805
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 0:29:59.494659 at 2024-07-20 13:54:22.630779
persisted model performance metric: 

scalar performance:
{'acc': 0.7088889, 'precision': 0.7542068, 'recall': 0.7088889, 'specificity': 0.7088889, 'f1': 0.6953095, 'auroc': 0.86261725, 'binary_precision': 0.86153847, 'binary_recall': 0.4977778, 'binary_specificity': 0.92, 'binary_f1_score': 0.6309859}
confusion matrix:
     0    1
0  207   18
1  113  112
oracle model performance metric: 

scalar performance:
{'acc': 0.7088889, 'precision': 0.7542068, 'recall': 0.7088889, 'specificity': 0.7088889, 'f1': 0.6953095, 'auroc': 0.86261725, 'binary_precision': 0.86153847, 'binary_recall': 0.4977778, 'binary_specificity': 0.92, 'binary_f1_score': 0.6309859}
confusion matrix:
     0    1
0  207   18
1  113  112
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_halffreezeblocks_2024-07-20_12-47-21/rule_results/4.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_halffreezeblocks_2024-07-20_12-47-21/confusion_matrix/4.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 195613 KiB |   7828 MiB | 124075 GiB | 124075 GiB |
|       from large pool | 179211 KiB |   7805 MiB | 122423 GiB | 122423 GiB |
|       from small pool |  16402 KiB |     36 MiB |   1652 GiB |   1652 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 195613 KiB |   7828 MiB | 124075 GiB | 124075 GiB |
|       from large pool | 179211 KiB |   7805 MiB | 122423 GiB | 122423 GiB |
|       from small pool |  16402 KiB |     36 MiB |   1652 GiB |   1652 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 195189 KiB |   7827 MiB | 124061 GiB | 124060 GiB |
|       from large pool | 178979 KiB |   7804 MiB | 122412 GiB | 122412 GiB |
|       from small pool |  16210 KiB |     36 MiB |   1648 GiB |   1648 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   8516 MiB |   8524 MiB |  16790 MiB |   8274 MiB |
|       from large pool |   8472 MiB |   8486 MiB |  16732 MiB |   8260 MiB |
|       from small pool |     44 MiB |     44 MiB |     58 MiB |     14 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  37859 KiB | 732464 KiB |  67125 GiB |  67125 GiB |
|       from large pool |  31733 KiB | 730714 KiB |  65468 GiB |  65468 GiB |
|       from small pool |   6126 KiB |  22319 KiB |   1657 GiB |   1657 GiB |
|---------------------------------------------------------------------------|
| Allocations           |     800    |    1679    |   20970 K  |   20969 K  |
|       from large pool |      79    |     762    |   11399 K  |   11399 K  |
|       from small pool |     721    |    1017    |    9570 K  |    9570 K  |
|---------------------------------------------------------------------------|
| Active allocs         |     800    |    1679    |   20970 K  |   20969 K  |
|       from large pool |      79    |     762    |   11399 K  |   11399 K  |
|       from small pool |     721    |    1017    |    9570 K  |    9570 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     370    |     370    |     715    |     345    |
|       from large pool |     348    |     349    |     686    |     338    |
|       from small pool |      22    |      22    |      29    |       7    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      46    |     381    |   12512 K  |   12512 K  |
|       from large pool |      11    |     351    |    8265 K  |    8265 K  |
|       from small pool |      35    |     215    |    4246 K  |    4246 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   7828 MiB | 124075 GiB | 124075 GiB |
|       from large pool |  16640 KiB |   7805 MiB | 122423 GiB | 122423 GiB |
|       from small pool |      0 KiB |     36 MiB |   1652 GiB |   1652 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   7828 MiB | 124075 GiB | 124075 GiB |
|       from large pool |  16640 KiB |   7805 MiB | 122423 GiB | 122423 GiB |
|       from small pool |      0 KiB |     36 MiB |   1652 GiB |   1652 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   7827 MiB | 124061 GiB | 124061 GiB |
|       from large pool |  16640 KiB |   7804 MiB | 122412 GiB | 122412 GiB |
|       from small pool |      0 KiB |     36 MiB |   1648 GiB |   1648 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 233472 KiB |   8524 MiB |  16790 MiB |  16562 MiB |
|       from large pool | 210944 KiB |   8486 MiB |  16732 MiB |  16526 MiB |
|       from small pool |  22528 KiB |     44 MiB |     58 MiB |     36 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  30464 KiB | 732464 KiB |  67125 GiB |  67125 GiB |
|       from large pool |  30464 KiB | 730714 KiB |  65468 GiB |  65468 GiB |
|       from small pool |      0 KiB |  22319 KiB |   1657 GiB |   1657 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    1679    |   20970 K  |   20970 K  |
|       from large pool |       2    |     762    |   11399 K  |   11399 K  |
|       from small pool |       0    |    1017    |    9570 K  |    9570 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    1679    |   20970 K  |   20970 K  |
|       from large pool |       2    |     762    |   11399 K  |   11399 K  |
|       from small pool |       0    |    1017    |    9570 K  |    9570 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      21    |     370    |     715    |     694    |
|       from large pool |      10    |     349    |     686    |     676    |
|       from small pool |      11    |      22    |      29    |      18    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     381    |   12512 K  |   12512 K  |
|       from large pool |       3    |     351    |    8265 K  |    8265 K  |
|       from small pool |       0    |     215    |    4246 K  |    4246 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   7828 MiB | 124075 GiB | 124075 GiB |
|       from large pool |  16640 KiB |   7805 MiB | 122423 GiB | 122423 GiB |
|       from small pool |      0 KiB |     36 MiB |   1652 GiB |   1652 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   7828 MiB | 124075 GiB | 124075 GiB |
|       from large pool |  16640 KiB |   7805 MiB | 122423 GiB | 122423 GiB |
|       from small pool |      0 KiB |     36 MiB |   1652 GiB |   1652 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   7827 MiB | 124061 GiB | 124061 GiB |
|       from large pool |  16640 KiB |   7804 MiB | 122412 GiB | 122412 GiB |
|       from small pool |      0 KiB |     36 MiB |   1648 GiB |   1648 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 233472 KiB |   8524 MiB |  16790 MiB |  16562 MiB |
|       from large pool | 210944 KiB |   8486 MiB |  16732 MiB |  16526 MiB |
|       from small pool |  22528 KiB |     44 MiB |     58 MiB |     36 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  30464 KiB | 732464 KiB |  67125 GiB |  67125 GiB |
|       from large pool |  30464 KiB | 730714 KiB |  65468 GiB |  65468 GiB |
|       from small pool |      0 KiB |  22319 KiB |   1657 GiB |   1657 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    1679    |   20970 K  |   20970 K  |
|       from large pool |       2    |     762    |   11399 K  |   11399 K  |
|       from small pool |       0    |    1017    |    9570 K  |    9570 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    1679    |   20970 K  |   20970 K  |
|       from large pool |       2    |     762    |   11399 K  |   11399 K  |
|       from small pool |       0    |    1017    |    9570 K  |    9570 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      21    |     370    |     715    |     694    |
|       from large pool |      10    |     349    |     686    |     676    |
|       from small pool |      11    |      22    |      29    |      18    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     381    |   12512 K  |   12512 K  |
|       from large pool |       3    |     351    |    8265 K  |    8265 K  |
|       from small pool |       0    |     215    |    4246 K  |    4246 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'888c1ef2'
model name: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_13_55_20_seed_2_22504805

 Experiment start at: 2024-07-20 13:55:20.718234
before training, model accuracy: 0.41203704476356506
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.59424084, 'precision': 0.6141207, 'recall': 0.5958195, 'specificity': 0.5958195, 'f1': 0.57797277, 'auroc': 0.645486, 'binary_precision': 0.6637555, 'binary_recall': 0.3948052, 'binary_specificity': 0.79683375, 'binary_f1_score': 0.49511406}
confusion matrix:
      0    1
0  1208  308
1   932  608
---- Validation: 
scalar performance:
{'acc': 0.64710486, 'precision': 0.65571356, 'recall': 0.6434593, 'specificity': 0.6434593, 'f1': 0.63851553, 'auroc': 0.67113364, 'binary_precision': 0.6862745, 'binary_recall': 0.50643086, 'binary_specificity': 0.7804878, 'binary_f1_score': 0.5827937}
confusion matrix:
     0    1
0  512  144
1  307  315
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.36574075, 'precision': 0.34313333, 'recall': 0.36574075, 'specificity': 0.36574075, 'f1': 0.3420345, 'auroc': 0.31072104, 'binary_precision': 0.2835821, 'binary_recall': 0.17592593, 'binary_specificity': 0.5555556, 'binary_f1_score': 0.21714287}
confusion matrix:
     0   1
0  120  96
1  178  38
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-20 13:56:24.188327,epoch time: 0:01:03.470093,used: 0:01:03.470093,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_13_55_20_seed_2_22504805
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.6564136, 'precision': 0.6587134, 'recall': 0.65684986, 'specificity': 0.65684986, 'f1': 0.65553886, 'auroc': 0.7185639, 'binary_precision': 0.6798825, 'binary_recall': 0.6012987, 'binary_specificity': 0.71240103, 'binary_f1_score': 0.63818055}
confusion matrix:
      0    1
0  1080  436
1   614  926
---- Validation: 
scalar performance:
{'acc': 0.6611894, 'precision': 0.6616039, 'recall': 0.65988696, 'specificity': 0.65988696, 'f1': 0.65968394, 'auroc': 0.6921688, 'binary_precision': 0.66549915, 'binary_recall': 0.61093247, 'binary_specificity': 0.70884144, 'binary_f1_score': 0.6370495}
confusion matrix:
     0    1
0  465  191
1  242  380
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.4027778, 'precision': 0.40111616, 'recall': 0.4027778, 'specificity': 0.4027778, 'f1': 0.40025827, 'auroc': 0.3447145, 'binary_precision': 0.3882979, 'binary_recall': 0.33796296, 'binary_specificity': 0.4675926, 'binary_f1_score': 0.36138612}
confusion matrix:
     0    1
0  101  115
1  143   73
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-07-20 13:57:22.661665,epoch time: 0:00:58.473338,used: 0:02:01.943431,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_13_55_20_seed_2_22504805
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.7058246, 'precision': 0.7060055, 'recall': 0.7059221, 'specificity': 0.7059221, 'f1': 0.7058107, 'auroc': 0.7752938, 'binary_precision': 0.7143813, 'binary_recall': 0.6935065, 'binary_specificity': 0.7183377, 'binary_f1_score': 0.7037892}
confusion matrix:
      0     1
0  1089   427
1   472  1068
---- Validation: 
scalar performance:
{'acc': 0.672144, 'precision': 0.67275995, 'recall': 0.6708077, 'specificity': 0.6708077, 'f1': 0.6706176, 'auroc': 0.70730233, 'binary_precision': 0.6783831, 'binary_recall': 0.62057877, 'binary_specificity': 0.7210366, 'binary_f1_score': 0.6481948}
confusion matrix:
     0    1
0  473  183
1  236  386
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.4722222, 'precision': 0.47216254, 'recall': 0.4722222, 'specificity': 0.4722222, 'f1': 0.47193927, 'auroc': 0.38085133, 'binary_precision': 0.47087377, 'binary_recall': 0.44907406, 'binary_specificity': 0.49537036, 'binary_f1_score': 0.4597156}
confusion matrix:
     0    1
0  107  109
1  119   97
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-07-20 13:58:21.365407,epoch time: 0:00:58.703742,used: 0:03:00.647173,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_13_55_20_seed_2_22504805
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.7539267, 'precision': 0.75447327, 'recall': 0.75409657, 'specificity': 0.75409657, 'f1': 0.75386596, 'auroc': 0.8245846, 'binary_precision': 0.7683924, 'binary_recall': 0.73246753, 'binary_specificity': 0.7757256, 'binary_f1_score': 0.74999994}
confusion matrix:
      0     1
0  1176   340
1   412  1128
---- Validation: 
scalar performance:
{'acc': 0.68153363, 'precision': 0.6844013, 'recall': 0.6794541, 'specificity': 0.6794541, 'f1': 0.67855614, 'auroc': 0.71868634, 'binary_precision': 0.7016885, 'binary_recall': 0.6012862, 'binary_specificity': 0.75762194, 'binary_f1_score': 0.64761907}
confusion matrix:
     0    1
0  497  159
1  248  374
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.4699074, 'precision': 0.46942973, 'recall': 0.4699074, 'specificity': 0.4699074, 'f1': 0.46782863, 'auroc': 0.41548783, 'binary_precision': 0.46560848, 'binary_recall': 0.4074074, 'binary_specificity': 0.5324074, 'binary_f1_score': 0.4345679}
confusion matrix:
     0    1
0  115  101
1  128   88
better model found
persisted
after epoch: 4,now: 2024-07-20 13:59:19.665571,epoch time: 0:00:58.300164,used: 0:03:58.947337,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_13_55_20_seed_2_22504805
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.773233, 'precision': 0.7744402, 'recall': 0.7734837, 'specificity': 0.7734837, 'f1': 0.77308136, 'auroc': 0.8490491, 'binary_precision': 0.79471123, 'binary_recall': 0.74155843, 'binary_specificity': 0.80540895, 'binary_f1_score': 0.7672154}
confusion matrix:
      0     1
0  1221   295
1   398  1142
---- Validation: 
scalar performance:
{'acc': 0.68153363, 'precision': 0.68505025, 'recall': 0.67928743, 'specificity': 0.67928743, 'f1': 0.67815197, 'auroc': 0.7255068, 'binary_precision': 0.7047619, 'binary_recall': 0.5948553, 'binary_specificity': 0.7637195, 'binary_f1_score': 0.6451613}
confusion matrix:
     0    1
0  501  155
1  252  370
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.47916666, 'precision': 0.47878423, 'recall': 0.4791667, 'specificity': 0.4791667, 'f1': 0.47680897, 'auroc': 0.442494, 'binary_precision': 0.47593582, 'binary_recall': 0.41203704, 'binary_specificity': 0.5462963, 'binary_f1_score': 0.44168735}
confusion matrix:
     0   1
0  118  98
1  127  89
new oracle model saved
early stop counter: 1
val acc:0.6815336346626282, best validation acc: 0.6815336346626282, corresponding to test acc:                         0.46990740299224854 / 0.4791666567325592
after epoch: 5,now: 2024-07-20 14:00:18.327611,epoch time: 0:00:58.662040,used: 0:04:57.609377,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_13_55_20_seed_2_22504805
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.802356, 'precision': 0.80284035, 'recall': 0.8025083, 'specificity': 0.8025083, 'f1': 0.80232215, 'auroc': 0.88028944, 'binary_precision': 0.81707317, 'binary_recall': 0.7831169, 'binary_specificity': 0.8218997, 'binary_f1_score': 0.7997348}
confusion matrix:
      0     1
0  1246   270
1   334  1206
---- Validation: 
scalar performance:
{'acc': 0.68622845, 'precision': 0.69123733, 'recall': 0.6836939, 'specificity': 0.6836939, 'f1': 0.68213665, 'auroc': 0.7328224, 'binary_precision': 0.7162427, 'binary_recall': 0.58842444, 'binary_specificity': 0.7789634, 'binary_f1_score': 0.6460724}
confusion matrix:
     0    1
0  511  145
1  256  366
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.4861111, 'precision': 0.48575824, 'recall': 0.4861111, 'specificity': 0.4861111, 'f1': 0.48290813, 'auroc': 0.47078615, 'binary_precision': 0.48351648, 'binary_recall': 0.4074074, 'binary_specificity': 0.5648148, 'binary_f1_score': 0.44221106}
confusion matrix:
     0   1
0  122  94
1  128  88
new oracle model saved
better model found
persisted
after epoch: 6,now: 2024-07-20 14:01:17.586901,epoch time: 0:00:59.259290,used: 0:05:56.868667,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_13_55_20_seed_2_22504805
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.82231677, 'precision': 0.82338417, 'recall': 0.8225397, 'specificity': 0.8225397, 'f1': 0.8222313, 'auroc': 0.9014919, 'binary_precision': 0.8440304, 'binary_recall': 0.79415584, 'binary_specificity': 0.8509235, 'binary_f1_score': 0.8183339}
confusion matrix:
      0     1
0  1290   226
1   317  1223
---- Validation: 
scalar performance:
{'acc': 0.68622845, 'precision': 0.69513166, 'recall': 0.6830273, 'specificity': 0.6830273, 'f1': 0.68009216, 'auroc': 0.73655987, 'binary_precision': 0.7306889, 'binary_recall': 0.562701, 'binary_specificity': 0.80335367, 'binary_f1_score': 0.6357857}
confusion matrix:
     0    1
0  527  129
1  272  350
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.49305555, 'precision': 0.4926788, 'recall': 0.49305558, 'specificity': 0.49305558, 'f1': 0.48644847, 'auroc': 0.49451303, 'binary_precision': 0.49101797, 'binary_recall': 0.37962964, 'binary_specificity': 0.6064815, 'binary_f1_score': 0.42819843}
confusion matrix:
     0   1
0  131  85
1  134  82
new oracle model saved
early stop counter: 1
val acc:0.6862284541130066, best validation acc: 0.6862284541130066, corresponding to test acc:                         0.4861111044883728 / 0.4930555522441864
after epoch: 7,now: 2024-07-20 14:02:15.968089,epoch time: 0:00:58.381188,used: 0:06:55.249855,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_13_55_20_seed_2_22504805
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.8468586, 'precision': 0.84791464, 'recall': 0.84707534, 'specificity': 0.84707534, 'f1': 0.8467914, 'auroc': 0.91921234, 'binary_precision': 0.869146, 'binary_recall': 0.81948054, 'binary_specificity': 0.8746702, 'binary_f1_score': 0.84358287}
confusion matrix:
      0     1
0  1326   190
1   278  1262
---- Validation: 
scalar performance:
{'acc': 0.68466353, 'precision': 0.69971716, 'recall': 0.68066967, 'specificity': 0.68066967, 'f1': 0.675479, 'auroc': 0.73959637, 'binary_precision': 0.7482993, 'binary_recall': 0.5305466, 'binary_specificity': 0.83079267, 'binary_f1_score': 0.62088424}
confusion matrix:
     0    1
0  545  111
1  292  330
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.4976852, 'precision': 0.49743876, 'recall': 0.4976852, 'specificity': 0.4976852, 'f1': 0.4853049, 'auroc': 0.514639, 'binary_precision': 0.4966443, 'binary_recall': 0.3425926, 'binary_specificity': 0.6527778, 'binary_f1_score': 0.40547946}
confusion matrix:
     0   1
0  141  75
1  142  74
new oracle model saved
early stop counter: 2
val acc:0.6846635341644287, best validation acc: 0.6862284541130066, corresponding to test acc:                         0.4861111044883728 / 0.49768519401550293
after epoch: 8,now: 2024-07-20 14:03:14.369306,epoch time: 0:00:58.401217,used: 0:07:53.651072,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_13_55_20_seed_2_22504805
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.85209423, 'precision': 0.8549979, 'recall': 0.85245, 'specificity': 0.85245, 'f1': 0.85187334, 'auroc': 0.92387307, 'binary_precision': 0.8891273, 'binary_recall': 0.80714285, 'binary_specificity': 0.89775723, 'binary_f1_score': 0.8461538}
confusion matrix:
      0     1
0  1361   155
1   297  1243
---- Validation: 
scalar performance:
{'acc': 0.68075114, 'precision': 0.70487666, 'recall': 0.67585874, 'specificity': 0.67585874, 'f1': 0.6671876, 'auroc': 0.741557, 'binary_precision': 0.76884425, 'binary_recall': 0.49196142, 'binary_specificity': 0.8597561, 'binary_f1_score': 0.6000001}
confusion matrix:
     0    1
0  564   92
1  316  306
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.49074075, 'precision': 0.48857749, 'recall': 0.49074072, 'specificity': 0.49074072, 'f1': 0.46543074, 'auroc': 0.52820647, 'binary_precision': 0.48360655, 'binary_recall': 0.27314815, 'binary_specificity': 0.7083333, 'binary_f1_score': 0.34911242}
confusion matrix:
     0   1
0  153  63
1  157  59
early stop counter: 3
val acc:0.6807511448860168, best validation acc: 0.6862284541130066, corresponding to test acc:                         0.4861111044883728 / 0.49768519401550293
after epoch: 9,now: 2024-07-20 14:04:12.514370,epoch time: 0:00:58.145064,used: 0:08:51.796136,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_13_55_20_seed_2_22504805
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.8566754, 'precision': 0.8610453, 'recall': 0.8571086, 'specificity': 0.8571086, 'f1': 0.8563385, 'auroc': 0.9266912, 'binary_precision': 0.9027778, 'binary_recall': 0.8019481, 'binary_specificity': 0.9122691, 'binary_f1_score': 0.849381}
confusion matrix:
      0     1
0  1383   133
1   305  1235
---- Validation: 
scalar performance:
{'acc': 0.67840374, 'precision': 0.7039635, 'recall': 0.67336386, 'specificity': 0.67336386, 'f1': 0.6639551, 'auroc': 0.74452007, 'binary_precision': 0.769821, 'binary_recall': 0.48392284, 'binary_specificity': 0.8628049, 'binary_f1_score': 0.5942744}
confusion matrix:
     0    1
0  566   90
1  321  301
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5046296, 'precision': 0.50565565, 'recall': 0.5046296, 'specificity': 0.5046296, 'f1': 0.48109564, 'auroc': 0.5442387, 'binary_precision': 0.5080645, 'binary_recall': 0.29166666, 'binary_specificity': 0.7175926, 'binary_f1_score': 0.37058824}
confusion matrix:
     0   1
0  155  61
1  153  63
new oracle model saved
early stop counter: 4
val acc:0.6784037351608276, best validation acc: 0.6862284541130066, corresponding to test acc:                         0.4861111044883728 / 0.5046296119689941
after epoch: 10,now: 2024-07-20 14:05:11.019888,epoch time: 0:00:58.505518,used: 0:09:50.301654,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_13_55_20_seed_2_22504805
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.872055, 'precision': 0.874885, 'recall': 0.8723992, 'specificity': 0.8723992, 'f1': 0.8718798, 'auroc': 0.9356654, 'binary_precision': 0.9094797, 'binary_recall': 0.82857144, 'binary_specificity': 0.9162269, 'binary_f1_score': 0.8671423}
confusion matrix:
      0     1
0  1389   127
1   264  1276
---- Validation: 
scalar performance:
{'acc': 0.6674491, 'precision': 0.70195085, 'recall': 0.6616099, 'specificity': 0.6616099, 'f1': 0.64764273, 'auroc': 0.7468084, 'binary_precision': 0.7790368, 'binary_recall': 0.4421222, 'binary_specificity': 0.88109756, 'binary_f1_score': 0.5641026}
confusion matrix:
     0    1
0  578   78
1  347  275
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5046296, 'precision': 0.50633204, 'recall': 0.5046296, 'specificity': 0.5046296, 'f1': 0.46893382, 'auroc': 0.55591995, 'binary_precision': 0.50961536, 'binary_recall': 0.24537037, 'binary_specificity': 0.7638889, 'binary_f1_score': 0.33124998}
confusion matrix:
     0   1
0  165  51
1  163  53
early stop counter: 5
val acc:0.6674491167068481, best validation acc: 0.6862284541130066, corresponding to test acc:                         0.4861111044883728 / 0.5046296119689941
after epoch: 11,now: 2024-07-20 14:06:09.816913,epoch time: 0:00:58.797025,used: 0:10:49.098679,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_13_55_20_seed_2_22504805
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.87729055, 'precision': 0.8814033, 'recall': 0.8777019, 'specificity': 0.8777019, 'f1': 0.8770362, 'auroc': 0.93846375, 'binary_precision': 0.9230211, 'binary_recall': 0.82532465, 'binary_specificity': 0.93007916, 'binary_f1_score': 0.8714433}
confusion matrix:
      0     1
0  1410   106
1   269  1271
---- Validation: 
scalar performance:
{'acc': 0.6635368, 'precision': 0.7035643, 'recall': 0.6572989, 'specificity': 0.6572989, 'f1': 0.6407296, 'auroc': 0.7489265, 'binary_precision': 0.78742516, 'binary_recall': 0.42282957, 'binary_specificity': 0.8917683, 'binary_f1_score': 0.5502092}
confusion matrix:
     0    1
0  585   71
1  359  263
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5046296, 'precision': 0.50659907, 'recall': 0.5046296, 'specificity': 0.5046296, 'f1': 0.4646902, 'auroc': 0.5673654, 'binary_precision': 0.5102041, 'binary_recall': 0.23148148, 'binary_specificity': 0.7777778, 'binary_f1_score': 0.31847134}
confusion matrix:
     0   1
0  168  48
1  166  50
early stop counter: 6
val acc:0.663536787033081, best validation acc: 0.6862284541130066, corresponding to test acc:                         0.4861111044883728 / 0.5046296119689941
after epoch: 12,now: 2024-07-20 14:07:08.311240,epoch time: 0:00:58.494327,used: 0:11:47.593006,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_13_55_20_seed_2_22504805
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.88154453, 'precision': 0.88457215, 'recall': 0.881897, 'specificity': 0.881897, 'f1': 0.8813736, 'auroc': 0.9463823, 'binary_precision': 0.92071426, 'binary_recall': 0.837013, 'binary_specificity': 0.926781, 'binary_f1_score': 0.87687075}
confusion matrix:
      0     1
0  1405   111
1   251  1289
---- Validation: 
scalar performance:
{'acc': 0.6604069, 'precision': 0.7048082, 'recall': 0.6538752, 'specificity': 0.6538752, 'f1': 0.6351905, 'auroc': 0.75070095, 'binary_precision': 0.79375, 'binary_recall': 0.40836012, 'binary_specificity': 0.8993902, 'binary_f1_score': 0.53927815}
confusion matrix:
     0    1
0  590   66
1  368  254
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5185185, 'precision': 0.52678573, 'recall': 0.5185185, 'specificity': 0.5185185, 'f1': 0.47826087, 'auroc': 0.57977533, 'binary_precision': 0.5416667, 'binary_recall': 0.24074075, 'binary_specificity': 0.7962963, 'binary_f1_score': 0.33333334}
confusion matrix:
     0   1
0  172  44
1  164  52
new oracle model saved
early stop counter: 7
val acc:0.6604068875312805, best validation acc: 0.6862284541130066, corresponding to test acc:                         0.4861111044883728 / 0.5185185074806213
after epoch: 13,now: 2024-07-20 14:08:07.085087,epoch time: 0:00:58.773847,used: 0:12:46.366853,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_13_55_20_seed_2_22504805
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.88645285, 'precision': 0.8902383, 'recall': 0.8868443, 'specificity': 0.8868443, 'f1': 0.8862438, 'auroc': 0.9476093, 'binary_precision': 0.93068594, 'binary_recall': 0.837013, 'binary_specificity': 0.9366755, 'binary_f1_score': 0.8813675}
confusion matrix:
      0     1
0  1420    96
1   251  1289
---- Validation: 
scalar performance:
{'acc': 0.65023476, 'precision': 0.7042152, 'recall': 0.6430501, 'specificity': 0.6430501, 'f1': 0.6187989, 'auroc': 0.75267625, 'binary_precision': 0.8027682, 'binary_recall': 0.37299034, 'binary_specificity': 0.9131098, 'binary_f1_score': 0.5093304}
confusion matrix:
     0    1
0  599   57
1  390  232
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5162037, 'precision': 0.52476496, 'recall': 0.5162037, 'specificity': 0.5162037, 'f1': 0.4704361, 'auroc': 0.5890347, 'binary_precision': 0.53932583, 'binary_recall': 0.22222222, 'binary_specificity': 0.8101852, 'binary_f1_score': 0.3147541}
confusion matrix:
     0   1
0  175  41
1  168  48
early stop counter: 8
val acc:0.6502347588539124, best validation acc: 0.6862284541130066, corresponding to test acc:                         0.4861111044883728 / 0.5185185074806213
after epoch: 14,now: 2024-07-20 14:09:05.428113,epoch time: 0:00:58.343026,used: 0:13:44.709879,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_13_55_20_seed_2_22504805
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9024869, 'precision': 0.90478665, 'recall': 0.9027893, 'specificity': 0.9027893, 'f1': 0.9023906, 'auroc': 0.9524989, 'binary_precision': 0.9373239, 'binary_recall': 0.8642857, 'binary_specificity': 0.9412929, 'binary_f1_score': 0.89932436}
confusion matrix:
      0     1
0  1427    89
1   209  1331
---- Validation: 
scalar performance:
{'acc': 0.6541471, 'precision': 0.70470345, 'recall': 0.6471944, 'specificity': 0.6471944, 'f1': 0.62505275, 'auroc': 0.755556, 'binary_precision': 0.8, 'binary_recall': 0.3858521, 'binary_specificity': 0.9085366, 'binary_f1_score': 0.5206074}
confusion matrix:
     0    1
0  596   60
1  382  240
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5324074, 'precision': 0.546875, 'recall': 0.5324074, 'specificity': 0.5324074, 'f1': 0.49331105, 'auroc': 0.59799385, 'binary_precision': 0.5729167, 'binary_recall': 0.25462964, 'binary_specificity': 0.8101852, 'binary_f1_score': 0.3525641}
confusion matrix:
     0   1
0  175  41
1  161  55
new oracle model saved
early stop counter: 9
val acc:0.6541470885276794, best validation acc: 0.6862284541130066, corresponding to test acc:                         0.4861111044883728 / 0.5324074029922485
after epoch: 15,now: 2024-07-20 14:10:03.833870,epoch time: 0:00:58.405757,used: 0:14:43.115636,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_13_55_20_seed_2_22504805
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.8969241, 'precision': 0.9019166, 'recall': 0.8973675, 'specificity': 0.8973675, 'f1': 0.8966718, 'auroc': 0.9528359, 'binary_precision': 0.94871795, 'binary_recall': 0.84090906, 'binary_specificity': 0.95382583, 'binary_f1_score': 0.8915662}
confusion matrix:
      0     1
0  1446    70
1   245  1295
---- Validation: 
scalar performance:
{'acc': 0.6541471, 'precision': 0.70743114, 'recall': 0.64706933, 'specificity': 0.64706933, 'f1': 0.62397754, 'auroc': 0.7577567, 'binary_precision': 0.8061224, 'binary_recall': 0.38102895, 'binary_specificity': 0.9131098, 'binary_f1_score': 0.5174672}
confusion matrix:
     0    1
0  599   57
1  385  237
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5416667, 'precision': 0.56214833, 'recall': 0.5416667, 'specificity': 0.5416667, 'f1': 0.5005139, 'auroc': 0.60631, 'binary_precision': 0.59782606, 'binary_recall': 0.25462964, 'binary_specificity': 0.8287037, 'binary_f1_score': 0.35714287}
confusion matrix:
     0   1
0  179  37
1  161  55
new oracle model saved
early stop counter: 10
val acc:0.6541470885276794, best validation acc: 0.6862284541130066, corresponding to test acc:                         0.4861111044883728 / 0.5416666865348816
after epoch: 16,now: 2024-07-20 14:11:02.767313,epoch time: 0:00:58.933443,used: 0:15:42.049079,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_13_55_20_seed_2_22504805
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.90674084, 'precision': 0.90871096, 'recall': 0.90702033, 'specificity': 0.90702033, 'f1': 0.9066652, 'auroc': 0.95590496, 'binary_precision': 0.93911827, 'binary_recall': 0.87142855, 'binary_specificity': 0.9426121, 'binary_f1_score': 0.90400803}
confusion matrix:
      0     1
0  1429    87
1   198  1342
---- Validation: 
scalar performance:
{'acc': 0.65258217, 'precision': 0.70522237, 'recall': 0.6455033, 'specificity': 0.6455033, 'f1': 0.62227607, 'auroc': 0.75910467, 'binary_precision': 0.8027211, 'binary_recall': 0.37942123, 'binary_specificity': 0.9115854, 'binary_f1_score': 0.5152839}
confusion matrix:
     0    1
0  598   58
1  386  236
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5416667, 'precision': 0.56214833, 'recall': 0.5416667, 'specificity': 0.5416667, 'f1': 0.5005139, 'auroc': 0.61402607, 'binary_precision': 0.59782606, 'binary_recall': 0.25462964, 'binary_specificity': 0.8287037, 'binary_f1_score': 0.35714287}
confusion matrix:
     0   1
0  179  37
1  161  55
early stop counter: 11
val acc:0.6525821685791016, best validation acc: 0.6862284541130066, corresponding to test acc:                         0.4861111044883728 / 0.5416666865348816
after epoch: 17,now: 2024-07-20 14:12:01.170491,epoch time: 0:00:58.403178,used: 0:16:40.452257,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_13_55_20_seed_2_22504805
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9100131, 'precision': 0.91338825, 'recall': 0.910375, 'specificity': 0.910375, 'f1': 0.9098764, 'auroc': 0.9606068, 'binary_precision': 0.9527559, 'binary_recall': 0.8642857, 'binary_specificity': 0.95646435, 'binary_f1_score': 0.906367}
confusion matrix:
      0     1
0  1450    66
1   209  1331
---- Validation: 
scalar performance:
{'acc': 0.64397496, 'precision': 0.70500624, 'recall': 0.6363692, 'specificity': 0.6363692, 'f1': 0.6080323, 'auroc': 0.75909483, 'binary_precision': 0.81040895, 'binary_recall': 0.3504823, 'binary_specificity': 0.9222561, 'binary_f1_score': 0.48933783}
confusion matrix:
     0    1
0  605   51
1  404  218
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.537037, 'precision': 0.56020904, 'recall': 0.537037, 'specificity': 0.537037, 'f1': 0.48775107, 'auroc': 0.6203061, 'binary_precision': 0.597561, 'binary_recall': 0.22685185, 'binary_specificity': 0.8472222, 'binary_f1_score': 0.32885906}
confusion matrix:
     0   1
0  183  33
1  167  49
early stop counter: 12
val acc:0.6439749598503113, best validation acc: 0.6862284541130066, corresponding to test acc:                         0.4861111044883728 / 0.5416666865348816
after epoch: 18,now: 2024-07-20 14:12:59.734141,epoch time: 0:00:58.563650,used: 0:17:39.015907,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_13_55_20_seed_2_22504805
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.89528793, 'precision': 0.9013197, 'recall': 0.89577496, 'specificity': 0.89577496, 'f1': 0.89497054, 'auroc': 0.95300233, 'binary_precision': 0.9525223, 'binary_recall': 0.8337662, 'binary_specificity': 0.95778364, 'binary_f1_score': 0.8891967}
confusion matrix:
      0     1
0  1452    64
1   256  1284
---- Validation: 
scalar performance:
{'acc': 0.63693273, 'precision': 0.70352966, 'recall': 0.6289678, 'specificity': 0.6289678, 'f1': 0.59662277, 'auroc': 0.7599355, 'binary_precision': 0.81349206, 'binary_recall': 0.329582, 'binary_specificity': 0.92835367, 'binary_f1_score': 0.46910754}
confusion matrix:
     0    1
0  609   47
1  417  205
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.537037, 'precision': 0.56136364, 'recall': 0.5370371, 'specificity': 0.5370371, 'f1': 0.4861058, 'auroc': 0.62932956, 'binary_precision': 0.6, 'binary_recall': 0.22222222, 'binary_specificity': 0.8518519, 'binary_f1_score': 0.32432434}
confusion matrix:
     0   1
0  184  32
1  168  48
early stop counter: 13
val acc:0.6369327306747437, best validation acc: 0.6862284541130066, corresponding to test acc:                         0.4861111044883728 / 0.5416666865348816
after epoch: 19,now: 2024-07-20 14:13:58.171791,epoch time: 0:00:58.437650,used: 0:18:37.453557,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_13_55_20_seed_2_22504805
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9070681, 'precision': 0.9099046, 'recall': 0.90740156, 'specificity': 0.90740156, 'f1': 0.90695184, 'auroc': 0.96041274, 'binary_precision': 0.94602275, 'binary_recall': 0.86493504, 'binary_specificity': 0.9498681, 'binary_f1_score': 0.90366346}
confusion matrix:
      0     1
0  1440    76
1   208  1332
---- Validation: 
scalar performance:
{'acc': 0.64945227, 'precision': 0.71161634, 'recall': 0.6419129, 'specificity': 0.6419129, 'f1': 0.61466336, 'auroc': 0.7627833, 'binary_precision': 0.81985295, 'binary_recall': 0.3585209, 'binary_specificity': 0.9253049, 'binary_f1_score': 0.49888143}
confusion matrix:
     0    1
0  607   49
1  399  223
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5416667, 'precision': 0.56533134, 'recall': 0.5416667, 'specificity': 0.5416667, 'f1': 0.49602884, 'auroc': 0.6319016, 'binary_precision': 0.60465115, 'binary_recall': 0.24074075, 'binary_specificity': 0.8425926, 'binary_f1_score': 0.34437087}
confusion matrix:
     0   1
0  182  34
1  164  52
early stop counter: 14
val acc:0.649452269077301, best validation acc: 0.6862284541130066, corresponding to test acc:                         0.4861111044883728 / 0.5416666865348816
after epoch: 20,now: 2024-07-20 14:14:56.736930,epoch time: 0:00:58.565139,used: 0:19:36.018696,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_13_55_20_seed_2_22504805
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.91066754, 'precision': 0.9133042, 'recall': 0.91098845, 'specificity': 0.91098845, 'f1': 0.910566, 'auroc': 0.9597167, 'binary_precision': 0.9483369, 'binary_recall': 0.8701299, 'binary_specificity': 0.95184696, 'binary_f1_score': 0.9075517}
confusion matrix:
      0     1
0  1443    73
1   200  1340
---- Validation: 
scalar performance:
{'acc': 0.6400626, 'precision': 0.7073004, 'recall': 0.6321416, 'specificity': 0.6321416, 'f1': 0.60053813, 'auroc': 0.76380527, 'binary_precision': 0.81889766, 'binary_recall': 0.33440515, 'binary_specificity': 0.92987806, 'binary_f1_score': 0.47488585}
confusion matrix:
     0    1
0  610   46
1  414  208
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5439815, 'precision': 0.5708392, 'recall': 0.5439815, 'specificity': 0.5439815, 'f1': 0.49623233, 'auroc': 0.6399391, 'binary_precision': 0.61445785, 'binary_recall': 0.2361111, 'binary_specificity': 0.8518519, 'binary_f1_score': 0.34113714}
confusion matrix:
     0   1
0  184  32
1  165  51
new oracle model saved
early stop counter: 15
val acc:0.6400625705718994, best validation acc: 0.6862284541130066, corresponding to test acc:                         0.4861111044883728 / 0.5439814925193787
after epoch: 21,now: 2024-07-20 14:15:55.613506,epoch time: 0:00:58.876576,used: 0:20:34.895272,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_13_55_20_seed_2_22504805
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.911322, 'precision': 0.91451186, 'recall': 0.9116737, 'specificity': 0.9116737, 'f1': 0.91119623, 'auroc': 0.9619427, 'binary_precision': 0.9528908, 'binary_recall': 0.8668831, 'binary_specificity': 0.95646435, 'binary_f1_score': 0.90785444}
confusion matrix:
      0     1
0  1450    66
1   205  1335
---- Validation: 
scalar performance:
{'acc': 0.63849765, 'precision': 0.7060011, 'recall': 0.6305339, 'specificity': 0.6305339, 'f1': 0.5983615, 'auroc': 0.76518756, 'binary_precision': 0.8174603, 'binary_recall': 0.33118972, 'binary_specificity': 0.92987806, 'binary_f1_score': 0.4713959}
confusion matrix:
     0    1
0  610   46
1  416  206
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5439815, 'precision': 0.5708392, 'recall': 0.5439815, 'specificity': 0.5439815, 'f1': 0.49623233, 'auroc': 0.64754796, 'binary_precision': 0.61445785, 'binary_recall': 0.2361111, 'binary_specificity': 0.8518519, 'binary_f1_score': 0.34113714}
confusion matrix:
     0   1
0  184  32
1  165  51
early stop counter: 16
val acc:0.6384976506233215, best validation acc: 0.6862284541130066, corresponding to test acc:                         0.4861111044883728 / 0.5439814925193787
after epoch: 22,now: 2024-07-20 14:16:54.092200,epoch time: 0:00:58.478694,used: 0:21:33.373966,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_13_55_20_seed_2_22504805
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.90968585, 'precision': 0.91291237, 'recall': 0.9100401, 'specificity': 0.9100401, 'f1': 0.90955555, 'auroc': 0.96205497, 'binary_precision': 0.9514286, 'binary_recall': 0.86493504, 'binary_specificity': 0.9551451, 'binary_f1_score': 0.90612245}
confusion matrix:
      0     1
0  1448    68
1   208  1332
---- Validation: 
scalar performance:
{'acc': 0.63771516, 'precision': 0.7065288, 'recall': 0.6296884, 'specificity': 0.6296884, 'f1': 0.5968248, 'auroc': 0.7675562, 'binary_precision': 0.8192771, 'binary_recall': 0.3279743, 'binary_specificity': 0.93140244, 'binary_f1_score': 0.46842712}
confusion matrix:
     0    1
0  611   45
1  418  204
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5439815, 'precision': 0.5708392, 'recall': 0.5439815, 'specificity': 0.5439815, 'f1': 0.49623233, 'auroc': 0.6518562, 'binary_precision': 0.61445785, 'binary_recall': 0.2361111, 'binary_specificity': 0.8518519, 'binary_f1_score': 0.34113714}
confusion matrix:
     0   1
0  184  32
1  165  51
early stop counter: 17
val acc:0.6377151608467102, best validation acc: 0.6862284541130066, corresponding to test acc:                         0.4861111044883728 / 0.5439814925193787
after epoch: 23,now: 2024-07-20 14:17:52.641047,epoch time: 0:00:58.548847,used: 0:22:31.922813,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_13_55_20_seed_2_22504805
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.91361254, 'precision': 0.91696477, 'recall': 0.91397214, 'specificity': 0.91397214, 'f1': 0.9134836, 'auroc': 0.9645213, 'binary_precision': 0.95636624, 'binary_recall': 0.8681818, 'binary_specificity': 0.9597625, 'binary_f1_score': 0.910143}
confusion matrix:
      0     1
0  1455    61
1   203  1337
---- Validation: 
scalar performance:
{'acc': 0.63458526, 'precision': 0.70889115, 'recall': 0.6263063, 'specificity': 0.6263063, 'f1': 0.5905765, 'auroc': 0.76762855, 'binary_precision': 0.8270042, 'binary_recall': 0.31511253, 'binary_specificity': 0.9375, 'binary_f1_score': 0.45634454}
confusion matrix:
     0    1
0  615   41
1  426  196
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5439815, 'precision': 0.5708392, 'recall': 0.5439815, 'specificity': 0.5439815, 'f1': 0.49623233, 'auroc': 0.6593579, 'binary_precision': 0.61445785, 'binary_recall': 0.2361111, 'binary_specificity': 0.8518519, 'binary_f1_score': 0.34113714}
confusion matrix:
     0   1
0  184  32
1  165  51
early stop counter: 18
val acc:0.6345852613449097, best validation acc: 0.6862284541130066, corresponding to test acc:                         0.4861111044883728 / 0.5439814925193787
after epoch: 24,now: 2024-07-20 14:18:51.125487,epoch time: 0:00:58.484440,used: 0:23:30.407253,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_13_55_20_seed_2_22504805
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.91590315, 'precision': 0.91893387, 'recall': 0.91624486, 'specificity': 0.91624486, 'f1': 0.91579205, 'auroc': 0.9684397, 'binary_precision': 0.9565836, 'binary_recall': 0.8727273, 'binary_specificity': 0.9597625, 'binary_f1_score': 0.91273344}
confusion matrix:
      0     1
0  1455    61
1   196  1344
---- Validation: 
scalar performance:
{'acc': 0.63536775, 'precision': 0.71488965, 'recall': 0.62694347, 'specificity': 0.62694347, 'f1': 0.58978873, 'auroc': 0.76819956, 'binary_precision': 0.83913046, 'binary_recall': 0.31028938, 'binary_specificity': 0.94359756, 'binary_f1_score': 0.45305166}
confusion matrix:
     0    1
0  619   37
1  429  193
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5462963, 'precision': 0.57526135, 'recall': 0.5462963, 'specificity': 0.5462963, 'f1': 0.49799606, 'auroc': 0.6648662, 'binary_precision': 0.6219512, 'binary_recall': 0.2361111, 'binary_specificity': 0.8564815, 'binary_f1_score': 0.34228188}
confusion matrix:
     0   1
0  185  31
1  165  51
new oracle model saved
early stop counter: 19
val acc:0.635367751121521, best validation acc: 0.6862284541130066, corresponding to test acc:                         0.4861111044883728 / 0.5462962985038757
after epoch: 25,now: 2024-07-20 14:19:49.660965,epoch time: 0:00:58.535478,used: 0:24:28.942731,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_13_55_20_seed_2_22504805
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.91099477, 'precision': 0.9158471, 'recall': 0.9114262, 'specificity': 0.9114262, 'f1': 0.91079116, 'auroc': 0.96416795, 'binary_precision': 0.96277374, 'binary_recall': 0.85649353, 'binary_specificity': 0.96635884, 'binary_f1_score': 0.9065292}
confusion matrix:
      0     1
0  1465    51
1   221  1319
---- Validation: 
scalar performance:
{'acc': 0.63302034, 'precision': 0.71439695, 'recall': 0.62449026, 'specificity': 0.62449026, 'f1': 0.58592576, 'auroc': 0.7696259, 'binary_precision': 0.84, 'binary_recall': 0.30385852, 'binary_specificity': 0.94512194, 'binary_f1_score': 0.44628102}
confusion matrix:
     0    1
0  620   36
1  433  189
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5486111, 'precision': 0.5797721, 'recall': 0.5486111, 'specificity': 0.5486111, 'f1': 0.4997595, 'auroc': 0.66977453, 'binary_precision': 0.6296296, 'binary_recall': 0.2361111, 'binary_specificity': 0.8611111, 'binary_f1_score': 0.34343433}
confusion matrix:
     0   1
0  186  30
1  165  51
new oracle model saved
early stop counter: 20
val acc:0.6330203413963318, best validation acc: 0.6862284541130066, corresponding to test acc:                         0.4861111044883728 / 0.5486111044883728
after epoch: 26,now: 2024-07-20 14:20:48.354961,epoch time: 0:00:58.693996,used: 0:25:27.636727,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_13_55_20_seed_2_22504805
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.90772253, 'precision': 0.91153705, 'recall': 0.90810746, 'specificity': 0.90810746, 'f1': 0.90756035, 'auroc': 0.9654135, 'binary_precision': 0.95317, 'binary_recall': 0.8590909, 'binary_specificity': 0.957124, 'binary_f1_score': 0.90368855}
confusion matrix:
      0     1
0  1451    65
1   217  1323
---- Validation: 
scalar performance:
{'acc': 0.63536775, 'precision': 0.71216476, 'recall': 0.6270268, 'specificity': 0.6270268, 'f1': 0.5907449, 'auroc': 0.77148545, 'binary_precision': 0.8333333, 'binary_recall': 0.31350482, 'binary_specificity': 0.9405488, 'binary_f1_score': 0.45560744}
confusion matrix:
     0    1
0  617   39
1  427  195
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5532407, 'precision': 0.58275867, 'recall': 0.5532408, 'specificity': 0.5532408, 'f1': 0.50950396, 'auroc': 0.6751543, 'binary_precision': 0.6321839, 'binary_recall': 0.25462964, 'binary_specificity': 0.8518519, 'binary_f1_score': 0.36303633}
confusion matrix:
     0   1
0  184  32
1  161  55
new oracle model saved
early stop counter: 21
val acc:0.635367751121521, best validation acc: 0.6862284541130066, corresponding to test acc:                         0.4861111044883728 / 0.5532407164573669
after epoch: 27,now: 2024-07-20 14:21:46.642518,epoch time: 0:00:58.287557,used: 0:26:25.924284,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_13_55_20_seed_2_22504805
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.91884816, 'precision': 0.9227569, 'recall': 0.9192338, 'specificity': 0.9192338, 'f1': 0.9187056, 'auroc': 0.9683043, 'binary_precision': 0.96541786, 'binary_recall': 0.8701299, 'binary_specificity': 0.9683377, 'binary_f1_score': 0.9153006}
confusion matrix:
      0     1
0  1468    48
1   200  1340
---- Validation: 
scalar performance:
{'acc': 0.63302034, 'precision': 0.7088999, 'recall': 0.6246569, 'specificity': 0.6246569, 'f1': 0.5878709, 'auroc': 0.77249575, 'binary_precision': 0.82832617, 'binary_recall': 0.31028938, 'binary_specificity': 0.9390244, 'binary_f1_score': 0.45146194}
confusion matrix:
     0    1
0  616   40
1  429  193
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5578704, 'precision': 0.5884463, 'recall': 0.5578704, 'specificity': 0.5578704, 'f1': 0.5160445, 'auroc': 0.6803198, 'binary_precision': 0.64044946, 'binary_recall': 0.2638889, 'binary_specificity': 0.8518519, 'binary_f1_score': 0.37377048}
confusion matrix:
     0   1
0  184  32
1  159  57
new oracle model saved
early stop counter: 22
val acc:0.6330203413963318, best validation acc: 0.6862284541130066, corresponding to test acc:                         0.4861111044883728 / 0.5578703880310059
after epoch: 28,now: 2024-07-20 14:22:45.675890,epoch time: 0:00:59.033372,used: 0:27:24.957656,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_13_55_20_seed_2_22504805
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9123037, 'precision': 0.91765964, 'recall': 0.9127557, 'specificity': 0.9127557, 'f1': 0.9120804, 'auroc': 0.96522117, 'binary_precision': 0.9669604, 'binary_recall': 0.8551948, 'binary_specificity': 0.97031665, 'binary_f1_score': 0.9076499}
confusion matrix:
      0     1
0  1471    45
1   223  1317
---- Validation: 
scalar performance:
{'acc': 0.62754303, 'precision': 0.71285397, 'recall': 0.6187799, 'specificity': 0.6187799, 'f1': 0.57693887, 'auroc': 0.7732923, 'binary_precision': 0.8411215, 'binary_recall': 0.28938907, 'binary_specificity': 0.9481707, 'binary_f1_score': 0.43062204}
confusion matrix:
     0    1
0  622   34
1  442  180
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5532407, 'precision': 0.58736944, 'recall': 0.5532407, 'specificity': 0.5532407, 'f1': 0.5048902, 'auroc': 0.68233454, 'binary_precision': 0.6419753, 'binary_recall': 0.24074075, 'binary_specificity': 0.8657407, 'binary_f1_score': 0.35016835}
confusion matrix:
     0   1
0  187  29
1  164  52
early stop counter: 23
val acc:0.627543032169342, best validation acc: 0.6862284541130066, corresponding to test acc:                         0.4861111044883728 / 0.5578703880310059
after epoch: 29,now: 2024-07-20 14:23:43.984925,epoch time: 0:00:58.309035,used: 0:28:23.266691,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_13_55_20_seed_2_22504805
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.9100131, 'precision': 0.9144485, 'recall': 0.91042644, 'specificity': 0.91042644, 'f1': 0.9098265, 'auroc': 0.9629772, 'binary_precision': 0.95933187, 'binary_recall': 0.8577922, 'binary_specificity': 0.9630607, 'binary_f1_score': 0.905725}
confusion matrix:
      0     1
0  1460    56
1   219  1321
---- Validation: 
scalar performance:
{'acc': 0.63615024, 'precision': 0.7101836, 'recall': 0.62791395, 'specificity': 0.62791395, 'f1': 0.59279704, 'auroc': 0.7759514, 'binary_precision': 0.8284519, 'binary_recall': 0.31832796, 'binary_specificity': 0.9375, 'binary_f1_score': 0.45993036}
confusion matrix:
     0    1
0  615   41
1  424  198
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5648148, 'precision': 0.5951781, 'recall': 0.5648148, 'specificity': 0.5648148, 'f1': 0.5270991, 'auroc': 0.6880573, 'binary_precision': 0.64893615, 'binary_recall': 0.2824074, 'binary_specificity': 0.8472222, 'binary_f1_score': 0.39354837}
confusion matrix:
     0   1
0  183  33
1  155  61
new oracle model saved
early stop counter: 24
val acc:0.6361502408981323, best validation acc: 0.6862284541130066, corresponding to test acc:                         0.4861111044883728 / 0.5648148059844971
after epoch: 30,now: 2024-07-20 14:24:42.636696,epoch time: 0:00:58.651771,used: 0:29:21.918462,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_13_55_20_seed_2_22504805
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 0:29:21.918462 at 2024-07-20 14:24:42.636696
persisted model performance metric: 

scalar performance:
{'acc': 0.4861111, 'precision': 0.48575824, 'recall': 0.4861111, 'specificity': 0.4861111, 'f1': 0.48290813, 'auroc': 0.47078615, 'binary_precision': 0.48351648, 'binary_recall': 0.4074074, 'binary_specificity': 0.5648148, 'binary_f1_score': 0.44221106}
confusion matrix:
     0   1
0  122  94
1  128  88
oracle model performance metric: 

scalar performance:
{'acc': 0.5648148, 'precision': 0.5951781, 'recall': 0.5648148, 'specificity': 0.5648148, 'f1': 0.5270991, 'auroc': 0.6880573, 'binary_precision': 0.64893615, 'binary_recall': 0.2824074, 'binary_specificity': 0.8472222, 'binary_f1_score': 0.39354837}
confusion matrix:
     0   1
0  183  33
1  155  61
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_halffreezeblocks_2024-07-20_12-47-21/rule_results/4.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_halffreezeblocks_2024-07-20_12-47-21/confusion_matrix/4.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 195607 KiB |   7828 MiB | 185299 GiB | 185299 GiB |
|       from large pool | 179211 KiB |   7805 MiB | 182834 GiB | 182834 GiB |
|       from small pool |  16396 KiB |     36 MiB |   2464 GiB |   2464 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 195607 KiB |   7828 MiB | 185299 GiB | 185299 GiB |
|       from large pool | 179211 KiB |   7805 MiB | 182834 GiB | 182834 GiB |
|       from small pool |  16396 KiB |     36 MiB |   2464 GiB |   2464 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 195188 KiB |   7827 MiB | 185275 GiB | 185274 GiB |
|       from large pool | 178979 KiB |   7804 MiB | 182815 GiB | 182815 GiB |
|       from small pool |  16209 KiB |     36 MiB |   2459 GiB |   2459 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   8510 MiB |   8524 MiB |  25072 MiB |  16562 MiB |
|       from large pool |   8472 MiB |   8486 MiB |  24998 MiB |  16526 MiB |
|       from small pool |     38 MiB |     44 MiB |     74 MiB |     36 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  39913 KiB | 732464 KiB |  98949 GiB |  98949 GiB |
|       from large pool |  31733 KiB | 730714 KiB |  96477 GiB |  96477 GiB |
|       from small pool |   8180 KiB |  22319 KiB |   2471 GiB |   2471 GiB |
|---------------------------------------------------------------------------|
| Allocations           |     788    |    1679    |   31314 K  |   31314 K  |
|       from large pool |      79    |     762    |   17022 K  |   17022 K  |
|       from small pool |     709    |    1017    |   14292 K  |   14291 K  |
|---------------------------------------------------------------------------|
| Active allocs         |     788    |    1679    |   31314 K  |   31314 K  |
|       from large pool |      79    |     762    |   17022 K  |   17022 K  |
|       from small pool |     709    |    1017    |   14292 K  |   14291 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     367    |     370    |    1061    |     694    |
|       from large pool |     348    |     349    |    1024    |     676    |
|       from small pool |      19    |      22    |      37    |      18    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      42    |     381    |   18495 K  |   18495 K  |
|       from large pool |      11    |     351    |   12107 K  |   12107 K  |
|       from small pool |      31    |     215    |    6388 K  |    6388 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   7828 MiB | 185299 GiB | 185299 GiB |
|       from large pool |  16640 KiB |   7805 MiB | 182834 GiB | 182834 GiB |
|       from small pool |      0 KiB |     36 MiB |   2464 GiB |   2464 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   7828 MiB | 185299 GiB | 185299 GiB |
|       from large pool |  16640 KiB |   7805 MiB | 182834 GiB | 182834 GiB |
|       from small pool |      0 KiB |     36 MiB |   2464 GiB |   2464 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   7827 MiB | 185275 GiB | 185275 GiB |
|       from large pool |  16640 KiB |   7804 MiB | 182815 GiB | 182815 GiB |
|       from small pool |      0 KiB |     36 MiB |   2459 GiB |   2459 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 235520 KiB |   8524 MiB |  25072 MiB |  24842 MiB |
|       from large pool | 210944 KiB |   8486 MiB |  24998 MiB |  24792 MiB |
|       from small pool |  24576 KiB |     44 MiB |     74 MiB |     50 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  30464 KiB | 732464 KiB |  98949 GiB |  98949 GiB |
|       from large pool |  30464 KiB | 730714 KiB |  96477 GiB |  96477 GiB |
|       from small pool |      0 KiB |  22319 KiB |   2471 GiB |   2471 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    1679    |   31314 K  |   31314 K  |
|       from large pool |       2    |     762    |   17022 K  |   17022 K  |
|       from small pool |       0    |    1017    |   14292 K  |   14292 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    1679    |   31314 K  |   31314 K  |
|       from large pool |       2    |     762    |   17022 K  |   17022 K  |
|       from small pool |       0    |    1017    |   14292 K  |   14292 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      22    |     370    |    1061    |    1039    |
|       from large pool |      10    |     349    |    1024    |    1014    |
|       from small pool |      12    |      22    |      37    |      25    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     381    |   18495 K  |   18495 K  |
|       from large pool |       3    |     351    |   12107 K  |   12107 K  |
|       from small pool |       0    |     215    |    6388 K  |    6388 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Sat Jul 20 14:25:18 2024]
Finished job 0.
1 of 1 steps (100%) done
