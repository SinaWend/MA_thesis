Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Sat Jul 20 12:50:39 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_halffreezeblocks_2024-07-20_12-47-21/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_halffreezeblocks_2024-07-20_12-47-21/rule_results/2.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=2
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/swiglu_ffn.py:51: UserWarning: xFormers is not available (SwiGLU)
  warnings.warn("xFormers is not available (SwiGLU)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/attention.py:33: UserWarning: xFormers is not available (Attention)
  warnings.warn("xFormers is not available (Attention)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/block.py:40: UserWarning: xFormers is not available (Block)
  warnings.warn("xFormers is not available (Block)")
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'888c1ef2'
model name: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_12_53_26_seed_0_22504803

 Experiment start at: 2024-07-20 12:53:26.907062
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
before training, model accuracy: 0.569767415523529
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.5491536, 'precision': 0.54896986, 'recall': 0.548143, 'specificity': 0.548143, 'f1': 0.5467221, 'auroc': 0.57515854, 'binary_precision': 0.5503742, 'binary_recall': 0.6128205, 'binary_specificity': 0.4834656, 'binary_f1_score': 0.5799212}
confusion matrix:
     0    1
0  731  781
1  604  956
---- Validation: 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
scalar performance:
{'acc': 0.632764, 'precision': 0.63904405, 'recall': 0.63111866, 'specificity': 0.63111866, 'f1': 0.6267867, 'auroc': 0.70118296, 'binary_precision': 0.66530615, 'binary_recall': 0.51338583, 'binary_specificity': 0.7488515, 'binary_f1_score': 0.5795556}
confusion matrix:
     0    1
0  489  164
1  309  326
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.627907, 'precision': 0.6340429, 'recall': 0.627907, 'specificity': 0.627907, 'f1': 0.6235994, 'auroc': 0.6666739, 'binary_precision': 0.6627219, 'binary_recall': 0.52093023, 'binary_specificity': 0.7348837, 'binary_f1_score': 0.5833333}
confusion matrix:
     0    1
0  158   57
1  103  112
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-20 12:55:11.402550,epoch time: 0:01:44.495488,used: 0:01:44.495488,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_12_53_26_seed_0_22504803
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.6699219, 'precision': 0.67418724, 'recall': 0.668679, 'specificity': 0.668679, 'f1': 0.6668287, 'auroc': 0.7485387, 'binary_precision': 0.65027624, 'binary_recall': 0.75545573, 'binary_specificity': 0.58190227, 'binary_f1_score': 0.69893116}
confusion matrix:
     0     1
0  881   633
1  381  1177
---- Validation: 
scalar performance:
{'acc': 0.6265528, 'precision': 0.64088583, 'recall': 0.6241683, 'specificity': 0.6241683, 'f1': 0.6141414, 'auroc': 0.7092957, 'binary_precision': 0.6824645, 'binary_recall': 0.4535433, 'binary_specificity': 0.79479325, 'binary_f1_score': 0.5449385}
confusion matrix:
     0    1
0  519  134
1  347  288
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6139535, 'precision': 0.6302257, 'recall': 0.6139535, 'specificity': 0.6139535, 'f1': 0.60150516, 'auroc': 0.68865335, 'binary_precision': 0.676259, 'binary_recall': 0.4372093, 'binary_specificity': 0.7906977, 'binary_f1_score': 0.53107345}
confusion matrix:
     0   1
0  170  45
1  121  94
early stop counter: 1
val acc:0.6265528202056885, best validation acc: 0.6327639818191528, corresponding to test acc:                         0.6279069781303406 / 0.6279069781303406
after epoch: 2,now: 2024-07-20 12:56:41.731578,epoch time: 0:01:30.329028,used: 0:03:14.824516,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_12_53_26_seed_0_22504803
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.7470703, 'precision': 0.7471646, 'recall': 0.74685836, 'specificity': 0.74685836, 'f1': 0.74690294, 'auroc': 0.8161464, 'binary_precision': 0.74466753, 'binary_recall': 0.7623635, 'binary_specificity': 0.73135316, 'binary_f1_score': 0.75341165}
confusion matrix:
      0     1
0  1108   407
1   370  1187
---- Validation: 
scalar performance:
{'acc': 0.60559005, 'precision': 0.62957907, 'recall': 0.60240924, 'specificity': 0.60240924, 'f1': 0.5823222, 'auroc': 0.7139164, 'binary_precision': 0.6819484, 'binary_recall': 0.37480316, 'binary_specificity': 0.8300153, 'binary_f1_score': 0.48373985}
confusion matrix:
     0    1
0  542  111
1  397  238
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.61162794, 'precision': 0.64166486, 'recall': 0.61162794, 'specificity': 0.61162794, 'f1': 0.58988917, 'auroc': 0.70481336, 'binary_precision': 0.70689654, 'binary_recall': 0.38139534, 'binary_specificity': 0.8418605, 'binary_f1_score': 0.49546826}
confusion matrix:
     0   1
0  181  34
1  133  82
early stop counter: 2
val acc:0.6055900454521179, best validation acc: 0.6327639818191528, corresponding to test acc:                         0.6279069781303406 / 0.6279069781303406
after epoch: 3,now: 2024-07-20 12:58:08.911645,epoch time: 0:01:27.180067,used: 0:04:42.004583,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_12_53_26_seed_0_22504803
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.7861328, 'precision': 0.7867569, 'recall': 0.786448, 'specificity': 0.786448, 'f1': 0.78610814, 'auroc': 0.8436332, 'binary_precision': 0.80418634, 'binary_recall': 0.7644416, 'binary_specificity': 0.80845445, 'binary_f1_score': 0.78381044}
confusion matrix:
      0     1
0  1224   290
1   367  1191
---- Validation: 
scalar performance:
{'acc': 0.6001553, 'precision': 0.6278873, 'recall': 0.5967238, 'specificity': 0.5967238, 'f1': 0.5726072, 'auroc': 0.72029036, 'binary_precision': 0.68404907, 'binary_recall': 0.3511811, 'binary_specificity': 0.84226644, 'binary_f1_score': 0.46409988}
confusion matrix:
     0    1
0  550  103
1  412  223
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.61162794, 'precision': 0.64487875, 'recall': 0.61162794, 'specificity': 0.61162794, 'f1': 0.5879879, 'auroc': 0.7185722, 'binary_precision': 0.71428573, 'binary_recall': 0.37209302, 'binary_specificity': 0.8511628, 'binary_f1_score': 0.48929664}
confusion matrix:
     0   1
0  183  32
1  135  80
early stop counter: 3
val acc:0.6001552939414978, best validation acc: 0.6327639818191528, corresponding to test acc:                         0.6279069781303406 / 0.6279069781303406
after epoch: 4,now: 2024-07-20 12:59:36.217825,epoch time: 0:01:27.306180,used: 0:06:09.310763,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_12_53_26_seed_0_22504803
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.8105469, 'precision': 0.813421, 'recall': 0.81115913, 'specificity': 0.81115913, 'f1': 0.8102946, 'auroc': 0.87532806, 'binary_precision': 0.8468661, 'binary_recall': 0.7641388, 'binary_specificity': 0.8581794, 'binary_f1_score': 0.80337834}
confusion matrix:
      0     1
0  1301   215
1   367  1189
---- Validation: 
scalar performance:
{'acc': 0.5908385, 'precision': 0.6235269, 'recall': 0.58705795, 'specificity': 0.58705795, 'f1': 0.55637383, 'auroc': 0.7250799, 'binary_precision': 0.68367344, 'binary_recall': 0.31653544, 'binary_specificity': 0.8575804, 'binary_f1_score': 0.43272337}
confusion matrix:
     0    1
0  560   93
1  434  201
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6, 'precision': 0.6372435, 'recall': 0.6, 'specificity': 0.6, 'f1': 0.57088816, 'auroc': 0.73105466, 'binary_precision': 0.70873785, 'binary_recall': 0.33953488, 'binary_specificity': 0.8604651, 'binary_f1_score': 0.4591195}
confusion matrix:
     0   1
0  185  30
1  142  73
early stop counter: 4
val acc:0.5908384919166565, best validation acc: 0.6327639818191528, corresponding to test acc:                         0.6279069781303406 / 0.6279069781303406
after epoch: 5,now: 2024-07-20 13:01:04.067208,epoch time: 0:01:27.849383,used: 0:07:37.160146,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_12_53_26_seed_0_22504803
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.8313802, 'precision': 0.83736587, 'recall': 0.83220017, 'specificity': 0.83220017, 'f1': 0.83084995, 'auroc': 0.8887422, 'binary_precision': 0.88550186, 'binary_recall': 0.7659164, 'binary_specificity': 0.8984839, 'binary_f1_score': 0.8213793}
confusion matrix:
      0     1
0  1363   154
1   364  1191
---- Validation: 
scalar performance:
{'acc': 0.5877329, 'precision': 0.62434125, 'recall': 0.5837564, 'specificity': 0.5837564, 'f1': 0.54910254, 'auroc': 0.729334, 'binary_precision': 0.6884058, 'binary_recall': 0.2992126, 'binary_specificity': 0.86830014, 'binary_f1_score': 0.41712403}
confusion matrix:
     0    1
0  567   86
1  445  190
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6, 'precision': 0.63911045, 'recall': 0.6, 'specificity': 0.6, 'f1': 0.56975985, 'auroc': 0.7416117, 'binary_precision': 0.7128713, 'binary_recall': 0.33488372, 'binary_specificity': 0.8651163, 'binary_f1_score': 0.45569623}
confusion matrix:
     0   1
0  186  29
1  143  72
early stop counter: 5
val acc:0.5877329111099243, best validation acc: 0.6327639818191528, corresponding to test acc:                         0.6279069781303406 / 0.6279069781303406
after epoch: 6,now: 2024-07-20 13:02:30.435329,epoch time: 0:01:26.368121,used: 0:09:03.528267,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_12_53_26_seed_0_22504803
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.835612, 'precision': 0.83974457, 'recall': 0.83629155, 'specificity': 0.83629155, 'f1': 0.83528435, 'auroc': 0.8976568, 'binary_precision': 0.8804348, 'binary_recall': 0.7813505, 'binary_specificity': 0.89123267, 'binary_f1_score': 0.8279387}
confusion matrix:
      0     1
0  1352   165
1   340  1215
---- Validation: 
scalar performance:
{'acc': 0.5916149, 'precision': 0.62434673, 'recall': 0.5878453, 'specificity': 0.5878453, 'f1': 0.557423, 'auroc': 0.73475057, 'binary_precision': 0.6847458, 'binary_recall': 0.31811023, 'binary_specificity': 0.8575804, 'binary_f1_score': 0.4344086}
confusion matrix:
     0    1
0  560   93
1  433  202
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.61860466, 'precision': 0.6566921, 'recall': 0.61860466, 'specificity': 0.61860466, 'f1': 0.5939285, 'auroc': 0.7504597, 'binary_precision': 0.73394495, 'binary_recall': 0.37209302, 'binary_specificity': 0.8651163, 'binary_f1_score': 0.49382713}
confusion matrix:
     0   1
0  186  29
1  135  80
early stop counter: 6
val acc:0.5916149020195007, best validation acc: 0.6327639818191528, corresponding to test acc:                         0.6279069781303406 / 0.6279069781303406
after epoch: 7,now: 2024-07-20 13:03:58.219758,epoch time: 0:01:27.784429,used: 0:10:31.312696,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_12_53_26_seed_0_22504803
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.8619792, 'precision': 0.8672924, 'recall': 0.862808, 'specificity': 0.862808, 'f1': 0.86164933, 'auroc': 0.9163251, 'binary_precision': 0.9150183, 'binary_recall': 0.8021837, 'binary_specificity': 0.92343235, 'binary_f1_score': 0.854894}
confusion matrix:
      0     1
0  1399   116
1   308  1249
---- Validation: 
scalar performance:
{'acc': 0.5954969, 'precision': 0.6289709, 'recall': 0.59176064, 'specificity': 0.59176064, 'f1': 0.56224173, 'auroc': 0.7399525, 'binary_precision': 0.6912752, 'binary_recall': 0.32440946, 'binary_specificity': 0.8591118, 'binary_f1_score': 0.4415863}
confusion matrix:
     0    1
0  561   92
1  429  206
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6302326, 'precision': 0.66527563, 'recall': 0.6302326, 'specificity': 0.6302326, 'f1': 0.60953516, 'auroc': 0.7589183, 'binary_precision': 0.7413793, 'binary_recall': 0.4, 'binary_specificity': 0.8604651, 'binary_f1_score': 0.51963747}
confusion matrix:
     0   1
0  185  30
1  129  86
new oracle model saved
early stop counter: 7
val acc:0.5954968929290771, best validation acc: 0.6327639818191528, corresponding to test acc:                         0.6279069781303406 / 0.630232572555542
after epoch: 8,now: 2024-07-20 13:05:24.881659,epoch time: 0:01:26.661901,used: 0:11:57.974597,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_12_53_26_seed_0_22504803
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.8567708, 'precision': 0.8648246, 'recall': 0.8578893, 'specificity': 0.8578893, 'f1': 0.85622084, 'auroc': 0.91406405, 'binary_precision': 0.92290246, 'binary_recall': 0.78319436, 'binary_specificity': 0.9325843, 'binary_f1_score': 0.8473282}
confusion matrix:
      0     1
0  1411   102
1   338  1221
---- Validation: 
scalar performance:
{'acc': 0.5916149, 'precision': 0.6260724, 'recall': 0.5877802, 'specificity': 0.5877802, 'f1': 0.556167, 'auroc': 0.7420048, 'binary_precision': 0.6885813, 'binary_recall': 0.3133858, 'binary_specificity': 0.8621746, 'binary_f1_score': 0.43073595}
confusion matrix:
     0    1
0  563   90
1  436  199
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6302326, 'precision': 0.6671108, 'recall': 0.6302326, 'specificity': 0.6302326, 'f1': 0.60864115, 'auroc': 0.76755, 'binary_precision': 0.74561405, 'binary_recall': 0.39534885, 'binary_specificity': 0.8651163, 'binary_f1_score': 0.5167174}
confusion matrix:
     0   1
0  186  29
1  130  85
early stop counter: 8
val acc:0.5916149020195007, best validation acc: 0.6327639818191528, corresponding to test acc:                         0.6279069781303406 / 0.630232572555542
after epoch: 9,now: 2024-07-20 13:06:54.523116,epoch time: 0:01:29.641457,used: 0:13:27.616054,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_12_53_26_seed_0_22504803
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.8590495, 'precision': 0.8666098, 'recall': 0.8599421, 'specificity': 0.8599421, 'f1': 0.85851395, 'auroc': 0.91657805, 'binary_precision': 0.92243975, 'binary_recall': 0.78778136, 'binary_specificity': 0.93210286, 'binary_f1_score': 0.8498092}
confusion matrix:
      0     1
0  1414   103
1   330  1225
---- Validation: 
scalar performance:
{'acc': 0.60170805, 'precision': 0.63474023, 'recall': 0.5980815, 'specificity': 0.5980815, 'f1': 0.5709229, 'auroc': 0.7465604, 'binary_precision': 0.6980519, 'binary_recall': 0.33858266, 'binary_specificity': 0.8575804, 'binary_f1_score': 0.45599154}
confusion matrix:
     0    1
0  560   93
1  420  215
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6372093, 'precision': 0.67508626, 'recall': 0.6372093, 'specificity': 0.6372093, 'f1': 0.6164666, 'auroc': 0.7742996, 'binary_precision': 0.75652176, 'binary_recall': 0.40465117, 'binary_specificity': 0.8697674, 'binary_f1_score': 0.52727276}
confusion matrix:
     0   1
0  187  28
1  128  87
new oracle model saved
early stop counter: 9
val acc:0.6017080545425415, best validation acc: 0.6327639818191528, corresponding to test acc:                         0.6279069781303406 / 0.6372092962265015
after epoch: 10,now: 2024-07-20 13:08:22.584577,epoch time: 0:01:28.061461,used: 0:14:55.677515,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_12_53_26_seed_0_22504803
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.8691406, 'precision': 0.87433076, 'recall': 0.8699154, 'specificity': 0.8699154, 'f1': 0.86883616, 'auroc': 0.9314319, 'binary_precision': 0.9217836, 'binary_recall': 0.81041133, 'binary_specificity': 0.9294195, 'binary_f1_score': 0.8625171}
confusion matrix:
      0     1
0  1409   107
1   295  1261
---- Validation: 
scalar performance:
{'acc': 0.621118, 'precision': 0.64974415, 'recall': 0.6179185, 'specificity': 0.6179185, 'f1': 0.59845346, 'auroc': 0.7513113, 'binary_precision': 0.71181554, 'binary_recall': 0.38897637, 'binary_specificity': 0.84686065, 'binary_f1_score': 0.503055}
confusion matrix:
     0    1
0  553  100
1  388  247
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.644186, 'precision': 0.67400277, 'recall': 0.644186, 'specificity': 0.644186, 'f1': 0.62826097, 'auroc': 0.7813953, 'binary_precision': 0.74603176, 'binary_recall': 0.4372093, 'binary_specificity': 0.8511628, 'binary_f1_score': 0.5513196}
confusion matrix:
     0   1
0  183  32
1  121  94
new oracle model saved
early stop counter: 10
val acc:0.6211180090904236, best validation acc: 0.6327639818191528, corresponding to test acc:                         0.6279069781303406 / 0.6441860198974609
after epoch: 11,now: 2024-07-20 13:09:47.528174,epoch time: 0:01:24.943597,used: 0:16:20.621112,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_12_53_26_seed_0_22504803
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.87109375, 'precision': 0.87951434, 'recall': 0.87207234, 'specificity': 0.87207234, 'f1': 0.87056684, 'auroc': 0.93173075, 'binary_precision': 0.93939394, 'binary_recall': 0.7969152, 'binary_specificity': 0.94722956, 'binary_f1_score': 0.8623088}
confusion matrix:
      0     1
0  1436    80
1   316  1240
---- Validation: 
scalar performance:
{'acc': 0.617236, 'precision': 0.64713484, 'recall': 0.6139381, 'specificity': 0.6139381, 'f1': 0.5928856, 'auroc': 0.7560767, 'binary_precision': 0.71005917, 'binary_recall': 0.37795275, 'binary_specificity': 0.84992343, 'binary_f1_score': 0.4933196}
confusion matrix:
     0    1
0  555   98
1  395  240
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.65581393, 'precision': 0.688918, 'recall': 0.65581393, 'specificity': 0.65581393, 'f1': 0.6400453, 'auroc': 0.789616, 'binary_precision': 0.768, 'binary_recall': 0.44651163, 'binary_specificity': 0.8651163, 'binary_f1_score': 0.56470585}
confusion matrix:
     0   1
0  186  29
1  119  96
new oracle model saved
early stop counter: 11
val acc:0.6172360181808472, best validation acc: 0.6327639818191528, corresponding to test acc:                         0.6279069781303406 / 0.6558139324188232
after epoch: 12,now: 2024-07-20 13:11:16.330264,epoch time: 0:01:28.802090,used: 0:17:49.423202,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_12_53_26_seed_0_22504803
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.8876953, 'precision': 0.8946066, 'recall': 0.8885708, 'specificity': 0.8885708, 'f1': 0.88734627, 'auroc': 0.9443867, 'binary_precision': 0.9501859, 'binary_recall': 0.82133675, 'binary_specificity': 0.95580477, 'binary_f1_score': 0.88107544}
confusion matrix:
      0     1
0  1449    67
1   278  1278
---- Validation: 
scalar performance:
{'acc': 0.625, 'precision': 0.6544082, 'recall': 0.6218121, 'specificity': 0.6218121, 'f1': 0.60272276, 'auroc': 0.75915885, 'binary_precision': 0.7183908, 'binary_recall': 0.39370078, 'binary_specificity': 0.84992343, 'binary_f1_score': 0.508647}
confusion matrix:
     0    1
0  555   98
1  385  250
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6627907, 'precision': 0.6946658, 'recall': 0.6627907, 'specificity': 0.6627907, 'f1': 0.6483976, 'auroc': 0.79541373, 'binary_precision': 0.7734375, 'binary_recall': 0.4604651, 'binary_specificity': 0.8651163, 'binary_f1_score': 0.5772595}
confusion matrix:
     0   1
0  186  29
1  116  99
new oracle model saved
early stop counter: 12
val acc:0.625, best validation acc: 0.6327639818191528, corresponding to test acc:                         0.6279069781303406 / 0.6627907156944275
after epoch: 13,now: 2024-07-20 13:12:41.828462,epoch time: 0:01:25.498198,used: 0:19:14.921400,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_12_53_26_seed_0_22504803
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.8902995, 'precision': 0.89722306, 'recall': 0.8912182, 'specificity': 0.8912182, 'f1': 0.8899665, 'auroc': 0.942592, 'binary_precision': 0.9531947, 'binary_recall': 0.82402056, 'binary_specificity': 0.95841587, 'binary_f1_score': 0.8839132}
confusion matrix:
      0     1
0  1452    63
1   274  1283
---- Validation: 
scalar performance:
{'acc': 0.6374224, 'precision': 0.6646739, 'recall': 0.63445395, 'specificity': 0.63445395, 'f1': 0.61875594, 'auroc': 0.7634081, 'binary_precision': 0.7282609, 'binary_recall': 0.42204726, 'binary_specificity': 0.84686065, 'binary_f1_score': 0.5343968}
confusion matrix:
     0    1
0  553  100
1  367  268
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6581395, 'precision': 0.68743587, 'recall': 0.6581395, 'specificity': 0.6581395, 'f1': 0.64423805, 'auroc': 0.8011033, 'binary_precision': 0.76153845, 'binary_recall': 0.4604651, 'binary_specificity': 0.855814, 'binary_f1_score': 0.573913}
confusion matrix:
     0   1
0  184  31
1  116  99
better model found
persisted
after epoch: 14,now: 2024-07-20 13:14:10.829646,epoch time: 0:01:29.001184,used: 0:20:43.922584,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_12_53_26_seed_0_22504803
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.88997394, 'precision': 0.89890134, 'recall': 0.8910128, 'specificity': 0.8910128, 'f1': 0.8895243, 'auroc': 0.94878364, 'binary_precision': 0.9620925, 'binary_recall': 0.8150289, 'binary_specificity': 0.9669967, 'binary_f1_score': 0.8824757}
confusion matrix:
      0     1
0  1465    50
1   288  1269
---- Validation: 
scalar performance:
{'acc': 0.6335404, 'precision': 0.66495174, 'recall': 0.630365, 'specificity': 0.630365, 'f1': 0.6119214, 'auroc': 0.7665385, 'binary_precision': 0.7335244, 'binary_recall': 0.4031496, 'binary_specificity': 0.8575804, 'binary_f1_score': 0.52032524}
confusion matrix:
     0    1
0  560   93
1  379  256
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.66744184, 'precision': 0.7020677, 'recall': 0.66744184, 'specificity': 0.66744184, 'f1': 0.6525576, 'auroc': 0.80718225, 'binary_precision': 0.78571427, 'binary_recall': 0.4604651, 'binary_specificity': 0.8744186, 'binary_f1_score': 0.58064514}
confusion matrix:
     0   1
0  188  27
1  116  99
new oracle model saved
early stop counter: 1
val acc:0.6335403919219971, best validation acc: 0.6374223828315735, corresponding to test acc:                         0.6581395268440247 / 0.6674418449401855
after epoch: 15,now: 2024-07-20 13:15:37.788240,epoch time: 0:01:26.958594,used: 0:22:10.881178,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_12_53_26_seed_0_22504803
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.8889974, 'precision': 0.8956543, 'recall': 0.8898561, 'specificity': 0.8898561, 'f1': 0.8886684, 'auroc': 0.94740844, 'binary_precision': 0.9503336, 'binary_recall': 0.82390743, 'binary_specificity': 0.95580477, 'binary_f1_score': 0.8826162}
confusion matrix:
      0     1
0  1449    67
1   274  1282
---- Validation: 
scalar performance:
{'acc': 0.64829195, 'precision': 0.6742976, 'recall': 0.64547753, 'specificity': 0.64547753, 'f1': 0.6320007, 'auroc': 0.77190435, 'binary_precision': 0.7382199, 'binary_recall': 0.44409448, 'binary_specificity': 0.84686065, 'binary_f1_score': 0.5545722}
confusion matrix:
     0    1
0  553  100
1  353  282
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.66976744, 'precision': 0.69866586, 'recall': 0.66976744, 'specificity': 0.66976744, 'f1': 0.6573051, 'auroc': 0.8134775, 'binary_precision': 0.7744361, 'binary_recall': 0.47906977, 'binary_specificity': 0.8604651, 'binary_f1_score': 0.591954}
confusion matrix:
     0    1
0  185   30
1  112  103
new oracle model saved
better model found
persisted
after epoch: 16,now: 2024-07-20 13:17:07.247309,epoch time: 0:01:29.459069,used: 0:23:40.340247,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_12_53_26_seed_0_22504803
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.8929036, 'precision': 0.9018109, 'recall': 0.8939386, 'specificity': 0.8939386, 'f1': 0.89247036, 'auroc': 0.94952476, 'binary_precision': 0.9651515, 'binary_recall': 0.8182402, 'binary_specificity': 0.969637, 'binary_f1_score': 0.8856448}
confusion matrix:
      0     1
0  1469    46
1   283  1274
---- Validation: 
scalar performance:
{'acc': 0.66071427, 'precision': 0.68268716, 'recall': 0.6581845, 'specificity': 0.6581845, 'f1': 0.6479771, 'auroc': 0.7778925, 'binary_precision': 0.74264705, 'binary_recall': 0.47716534, 'binary_specificity': 0.83920366, 'binary_f1_score': 0.5810163}
confusion matrix:
     0    1
0  548  105
1  332  303
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.68604654, 'precision': 0.708819, 'recall': 0.6860465, 'specificity': 0.6860465, 'f1': 0.6772472, 'auroc': 0.82005405, 'binary_precision': 0.7777778, 'binary_recall': 0.52093023, 'binary_specificity': 0.8511628, 'binary_f1_score': 0.6239555}
confusion matrix:
     0    1
0  183   32
1  103  112
new oracle model saved
better model found
persisted
after epoch: 17,now: 2024-07-20 13:18:33.661235,epoch time: 0:01:26.413926,used: 0:25:06.754173,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_12_53_26_seed_0_22504803
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.90266925, 'precision': 0.90942186, 'recall': 0.90347993, 'specificity': 0.90347993, 'f1': 0.90238076, 'auroc': 0.95746344, 'binary_precision': 0.96518517, 'binary_recall': 0.8379421, 'binary_specificity': 0.9690178, 'binary_f1_score': 0.897074}
confusion matrix:
      0     1
0  1470    47
1   252  1303
---- Validation: 
scalar performance:
{'acc': 0.6746894, 'precision': 0.6909344, 'recall': 0.67255306, 'specificity': 0.67255306, 'f1': 0.6658922, 'auroc': 0.78403497, 'binary_precision': 0.7432432, 'binary_recall': 0.51968503, 'binary_specificity': 0.82542115, 'binary_f1_score': 0.61167747}
confusion matrix:
     0    1
0  539  114
1  305  330
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7046512, 'precision': 0.7213176, 'recall': 0.7046512, 'specificity': 0.7046512, 'f1': 0.69898415, 'auroc': 0.82654405, 'binary_precision': 0.78205127, 'binary_recall': 0.5674419, 'binary_specificity': 0.8418605, 'binary_f1_score': 0.65768194}
confusion matrix:
     0    1
0  181   34
1   93  122
new oracle model saved
better model found
persisted
after epoch: 18,now: 2024-07-20 13:20:00.407186,epoch time: 0:01:26.745951,used: 0:26:33.500124,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_12_53_26_seed_0_22504803
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9039714, 'precision': 0.9113449, 'recall': 0.9047708, 'specificity': 0.9047708, 'f1': 0.9036515, 'auroc': 0.95380867, 'binary_precision': 0.9694258, 'binary_recall': 0.83655083, 'binary_specificity': 0.97299075, 'binary_f1_score': 0.89810014}
confusion matrix:
      0     1
0  1477    41
1   254  1300
---- Validation: 
scalar performance:
{'acc': 0.6840062, 'precision': 0.7004464, 'recall': 0.6819151, 'specificity': 0.6819151, 'f1': 0.6757933, 'auroc': 0.78723276, 'binary_precision': 0.75446427, 'binary_recall': 0.5322835, 'binary_specificity': 0.8315467, 'binary_f1_score': 0.62419206}
confusion matrix:
     0    1
0  543  110
1  297  338
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7209302, 'precision': 0.7358055, 'recall': 0.7209302, 'specificity': 0.7209302, 'f1': 0.71645856, 'auroc': 0.83009195, 'binary_precision': 0.7950311, 'binary_recall': 0.59534883, 'binary_specificity': 0.8465116, 'binary_f1_score': 0.68085104}
confusion matrix:
     0    1
0  182   33
1   87  128
new oracle model saved
better model found
persisted
after epoch: 19,now: 2024-07-20 13:21:28.480350,epoch time: 0:01:28.073164,used: 0:28:01.573288,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_12_53_26_seed_0_22504803
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9091797, 'precision': 0.9144421, 'recall': 0.9098947, 'specificity': 0.9098947, 'f1': 0.9089825, 'auroc': 0.9628265, 'binary_precision': 0.9643377, 'binary_recall': 0.85209006, 'binary_specificity': 0.9676994, 'binary_f1_score': 0.9047457}
confusion matrix:
      0     1
0  1468    49
1   230  1325
---- Validation: 
scalar performance:
{'acc': 0.71506214, 'precision': 0.72194517, 'recall': 0.7137584, 'specificity': 0.7137584, 'f1': 0.71199113, 'auroc': 0.79487526, 'binary_precision': 0.75769234, 'binary_recall': 0.62047243, 'binary_specificity': 0.8070444, 'binary_f1_score': 0.6822511}
confusion matrix:
     0    1
0  527  126
1  241  394
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.75116277, 'precision': 0.7588283, 'recall': 0.75116277, 'specificity': 0.75116277, 'f1': 0.7493067, 'auroc': 0.83781505, 'binary_precision': 0.8033708, 'binary_recall': 0.66511625, 'binary_specificity': 0.8372093, 'binary_f1_score': 0.72773534}
confusion matrix:
     0    1
0  180   35
1   72  143
new oracle model saved
better model found
persisted
after epoch: 20,now: 2024-07-20 13:22:55.919194,epoch time: 0:01:27.438844,used: 0:29:29.012132,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_12_53_26_seed_0_22504803
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9000651, 'precision': 0.90623736, 'recall': 0.90084314, 'specificity': 0.90084314, 'f1': 0.8997967, 'auroc': 0.9608353, 'binary_precision': 0.95949924, 'binary_recall': 0.8379421, 'binary_specificity': 0.9637442, 'binary_f1_score': 0.8946104}
confusion matrix:
      0     1
0  1462    55
1   252  1303
---- Validation: 
scalar performance:
{'acc': 0.71506214, 'precision': 0.7224616, 'recall': 0.713715, 'specificity': 0.713715, 'f1': 0.7118015, 'auroc': 0.79766977, 'binary_precision': 0.7596899, 'binary_recall': 0.61732286, 'binary_specificity': 0.8101072, 'binary_f1_score': 0.68114686}
confusion matrix:
     0    1
0  529  124
1  243  392
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.75581396, 'precision': 0.7627778, 'recall': 0.75581396, 'specificity': 0.75581396, 'f1': 0.7541854, 'auroc': 0.84118986, 'binary_precision': 0.8055556, 'binary_recall': 0.6744186, 'binary_specificity': 0.8372093, 'binary_f1_score': 0.7341772}
confusion matrix:
     0    1
0  180   35
1   70  145
new oracle model saved
early stop counter: 1
val acc:0.715062141418457, best validation acc: 0.715062141418457, corresponding to test acc:                         0.7511627674102783 / 0.7558139562606812
after epoch: 21,now: 2024-07-20 13:24:25.877456,epoch time: 0:01:29.958262,used: 0:30:58.970394,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_12_53_26_seed_0_22504803
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.90201825, 'precision': 0.90893066, 'recall': 0.9027945, 'specificity': 0.9027945, 'f1': 0.9017137, 'auroc': 0.96213186, 'binary_precision': 0.9651076, 'binary_recall': 0.83655083, 'binary_specificity': 0.9690382, 'binary_f1_score': 0.89624274}
confusion matrix:
      0     1
0  1471    47
1   254  1300
---- Validation: 
scalar performance:
{'acc': 0.7158385, 'precision': 0.7236723, 'recall': 0.714459, 'specificity': 0.714459, 'f1': 0.712441, 'auroc': 0.8021488, 'binary_precision': 0.76218325, 'binary_recall': 0.61574805, 'binary_specificity': 0.81316996, 'binary_f1_score': 0.68118465}
confusion matrix:
     0    1
0  531  122
1  244  391
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7651163, 'precision': 0.77413654, 'recall': 0.76511633, 'specificity': 0.76511633, 'f1': 0.7631681, 'auroc': 0.8453218, 'binary_precision': 0.8238636, 'binary_recall': 0.6744186, 'binary_specificity': 0.855814, 'binary_f1_score': 0.741688}
confusion matrix:
     0    1
0  184   31
1   70  145
new oracle model saved
better model found
persisted
after epoch: 22,now: 2024-07-20 13:25:52.545061,epoch time: 0:01:26.667605,used: 0:32:25.637999,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_12_53_26_seed_0_22504803
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.9108073, 'precision': 0.91797686, 'recall': 0.9117254, 'specificity': 0.9117254, 'f1': 0.91053975, 'auroc': 0.9627285, 'binary_precision': 0.9762435, 'binary_recall': 0.8445729, 'binary_specificity': 0.9788779, 'binary_f1_score': 0.90564734}
confusion matrix:
      0     1
0  1483    32
1   242  1315
---- Validation: 
scalar performance:
{'acc': 0.73059005, 'precision': 0.7370215, 'recall': 0.72937626, 'specificity': 0.72937626, 'f1': 0.7280285, 'auroc': 0.8065669, 'binary_precision': 0.77272725, 'binary_recall': 0.6425197, 'binary_specificity': 0.8162328, 'binary_f1_score': 0.70163375}
confusion matrix:
     0    1
0  533  120
1  227  408
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7790698, 'precision': 0.78666663, 'recall': 0.7790698, 'specificity': 0.7790698, 'f1': 0.77759635, 'auroc': 0.8490211, 'binary_precision': 0.8333333, 'binary_recall': 0.6976744, 'binary_specificity': 0.8604651, 'binary_f1_score': 0.75949365}
confusion matrix:
     0    1
0  185   30
1   65  150
new oracle model saved
better model found
persisted
after epoch: 23,now: 2024-07-20 13:27:21.799238,epoch time: 0:01:29.254177,used: 0:33:54.892176,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_12_53_26_seed_0_22504803
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9033203, 'precision': 0.9077014, 'recall': 0.90397805, 'specificity': 0.90397805, 'f1': 0.9031495, 'auroc': 0.9627459, 'binary_precision': 0.95317, 'binary_recall': 0.85080385, 'binary_specificity': 0.95715225, 'binary_f1_score': 0.89908254}
confusion matrix:
      0     1
0  1452    65
1   232  1323
---- Validation: 
scalar performance:
{'acc': 0.73990685, 'precision': 0.74215245, 'recall': 0.73917234, 'specificity': 0.73917234, 'f1': 0.7388741, 'auroc': 0.8100325, 'binary_precision': 0.7622378, 'binary_recall': 0.68661416, 'binary_specificity': 0.79173046, 'binary_f1_score': 0.72245234}
confusion matrix:
     0    1
0  517  136
1  199  436
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7837209, 'precision': 0.7864538, 'recall': 0.78372097, 'specificity': 0.78372097, 'f1': 0.78320384, 'auroc': 0.85332614, 'binary_precision': 0.814433, 'binary_recall': 0.7348837, 'binary_specificity': 0.83255816, 'binary_f1_score': 0.77261615}
confusion matrix:
     0    1
0  179   36
1   57  158
new oracle model saved
better model found
persisted
after epoch: 24,now: 2024-07-20 13:28:47.827091,epoch time: 0:01:26.027853,used: 0:35:20.920029,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_12_53_26_seed_0_22504803
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.913737, 'precision': 0.9185382, 'recall': 0.9144558, 'specificity': 0.9144558, 'f1': 0.91357493, 'auroc': 0.9672868, 'binary_precision': 0.966739, 'binary_recall': 0.8592545, 'binary_specificity': 0.969657, 'binary_f1_score': 0.90983325}
confusion matrix:
      0     1
0  1470    46
1   219  1337
---- Validation: 
scalar performance:
{'acc': 0.74378884, 'precision': 0.7469909, 'recall': 0.74293566, 'specificity': 0.74293566, 'f1': 0.7424749, 'auroc': 0.81332195, 'binary_precision': 0.771836, 'binary_recall': 0.6818898, 'binary_specificity': 0.8039816, 'binary_f1_score': 0.7240802}
confusion matrix:
     0    1
0  525  128
1  202  433
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7837209, 'precision': 0.7859541, 'recall': 0.7837209, 'specificity': 0.7837209, 'f1': 0.78329784, 'auroc': 0.85600865, 'binary_precision': 0.81122446, 'binary_recall': 0.73953485, 'binary_specificity': 0.82790697, 'binary_f1_score': 0.7737226}
confusion matrix:
     0    1
0  178   37
1   56  159
better model found
persisted
after epoch: 25,now: 2024-07-20 13:30:14.218931,epoch time: 0:01:26.391840,used: 0:36:47.311869,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_12_53_26_seed_0_22504803
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.91308594, 'precision': 0.9192997, 'recall': 0.91385794, 'specificity': 0.91385794, 'f1': 0.9128583, 'auroc': 0.9682293, 'binary_precision': 0.9735294, 'binary_recall': 0.8514469, 'binary_specificity': 0.97626895, 'binary_f1_score': 0.90840477}
confusion matrix:
      0     1
0  1481    36
1   231  1324
---- Validation: 
scalar performance:
{'acc': 0.7375776, 'precision': 0.74289525, 'recall': 0.7364845, 'specificity': 0.7364845, 'f1': 0.7355056, 'auroc': 0.8162762, 'binary_precision': 0.7755102, 'binary_recall': 0.65826774, 'binary_specificity': 0.8147014, 'binary_f1_score': 0.7120954}
confusion matrix:
     0    1
0  532  121
1  217  418
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7883721, 'precision': 0.79371583, 'recall': 0.7883721, 'specificity': 0.7883721, 'f1': 0.78740513, 'auroc': 0.8596863, 'binary_precision': 0.8333333, 'binary_recall': 0.7209302, 'binary_specificity': 0.855814, 'binary_f1_score': 0.7730673}
confusion matrix:
     0    1
0  184   31
1   60  155
new oracle model saved
early stop counter: 1
val acc:0.7375776171684265, best validation acc: 0.7437888383865356, corresponding to test acc:                         0.7837209105491638 / 0.7883720993995667
after epoch: 26,now: 2024-07-20 13:31:43.827635,epoch time: 0:01:29.608704,used: 0:38:16.920573,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_12_53_26_seed_0_22504803
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.9169922, 'precision': 0.92407024, 'recall': 0.9178556, 'specificity': 0.9178556, 'f1': 0.91674614, 'auroc': 0.9715473, 'binary_precision': 0.982209, 'binary_recall': 0.8515424, 'binary_specificity': 0.9841689, 'binary_f1_score': 0.9122203}
confusion matrix:
      0     1
0  1492    24
1   231  1325
---- Validation: 
scalar performance:
{'acc': 0.7445652, 'precision': 0.7492743, 'recall': 0.74354947, 'specificity': 0.74354947, 'f1': 0.7427901, 'auroc': 0.81975377, 'binary_precision': 0.7802198, 'binary_recall': 0.67086613, 'binary_specificity': 0.8162328, 'binary_f1_score': 0.7214225}
confusion matrix:
     0    1
0  533  120
1  209  426
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7930232, 'precision': 0.79641545, 'recall': 0.7930232, 'specificity': 0.7930232, 'f1': 0.7924294, 'auroc': 0.8621309, 'binary_precision': 0.828125, 'binary_recall': 0.73953485, 'binary_specificity': 0.8465116, 'binary_f1_score': 0.7813268}
confusion matrix:
     0    1
0  182   33
1   56  159
new oracle model saved
better model found
persisted
after epoch: 27,now: 2024-07-20 13:33:10.998176,epoch time: 0:01:27.170541,used: 0:39:44.091114,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_12_53_26_seed_0_22504803
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.91341144, 'precision': 0.9188256, 'recall': 0.91425174, 'specificity': 0.91425174, 'f1': 0.91323125, 'auroc': 0.9704131, 'binary_precision': 0.9701601, 'binary_recall': 0.8555841, 'binary_specificity': 0.9729194, 'binary_f1_score': 0.90927696}
confusion matrix:
      0     1
0  1473    41
1   225  1333
---- Validation: 
scalar performance:
{'acc': 0.7554348, 'precision': 0.7578769, 'recall': 0.7547033, 'specificity': 0.7547033, 'f1': 0.7544637, 'auroc': 0.82467055, 'binary_precision': 0.7797203, 'binary_recall': 0.7023622, 'binary_specificity': 0.8070444, 'binary_f1_score': 0.7390224}
confusion matrix:
     0    1
0  527  126
1  189  446
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7976744, 'precision': 0.7995472, 'recall': 0.7976744, 'specificity': 0.7976744, 'f1': 0.7973577, 'auroc': 0.8667604, 'binary_precision': 0.82323235, 'binary_recall': 0.75813955, 'binary_specificity': 0.8372093, 'binary_f1_score': 0.7893463}
confusion matrix:
     0    1
0  180   35
1   52  163
new oracle model saved
better model found
persisted
after epoch: 28,now: 2024-07-20 13:34:41.172819,epoch time: 0:01:30.174643,used: 0:41:14.265757,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_12_53_26_seed_0_22504803
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9088542, 'precision': 0.91649854, 'recall': 0.9097101, 'specificity': 0.9097101, 'f1': 0.90854716, 'auroc': 0.96472776, 'binary_precision': 0.9761016, 'binary_recall': 0.8405145, 'binary_specificity': 0.97890574, 'binary_f1_score': 0.90324813}
confusion matrix:
      0     1
0  1485    32
1   248  1307
---- Validation: 
scalar performance:
{'acc': 0.7546584, 'precision': 0.7576788, 'recall': 0.7538508, 'specificity': 0.7538508, 'f1': 0.75350773, 'auroc': 0.82638097, 'binary_precision': 0.7823009, 'binary_recall': 0.696063, 'binary_specificity': 0.8116386, 'binary_f1_score': 0.7366667}
confusion matrix:
     0    1
0  530  123
1  193  442
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8023256, 'precision': 0.80470526, 'recall': 0.8023256, 'specificity': 0.8023256, 'f1': 0.8019389, 'auroc': 0.86909676, 'binary_precision': 0.8316327, 'binary_recall': 0.75813955, 'binary_specificity': 0.8465116, 'binary_f1_score': 0.7931874}
confusion matrix:
     0    1
0  182   33
1   52  163
new oracle model saved
early stop counter: 1
val acc:0.7546584010124207, best validation acc: 0.7554348111152649, corresponding to test acc:                         0.7976744174957275 / 0.8023256063461304
after epoch: 29,now: 2024-07-20 13:36:08.567924,epoch time: 0:01:27.395105,used: 0:42:41.660862,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_12_53_26_seed_0_22504803
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.91471356, 'precision': 0.9184191, 'recall': 0.9154142, 'specificity': 0.9154142, 'f1': 0.91460407, 'auroc': 0.9692799, 'binary_precision': 0.96153843, 'binary_recall': 0.8664955, 'binary_specificity': 0.9643329, 'binary_f1_score': 0.9115463}
confusion matrix:
      0     1
0  1460    54
1   208  1350
---- Validation: 
scalar performance:
{'acc': 0.76319873, 'precision': 0.76363194, 'recall': 0.76285946, 'specificity': 0.76285946, 'f1': 0.7629093, 'auroc': 0.82945585, 'binary_precision': 0.77138156, 'binary_recall': 0.7385827, 'binary_specificity': 0.7871363, 'binary_f1_score': 0.75462586}
confusion matrix:
     0    1
0  514  139
1  166  469
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.80697674, 'precision': 0.80714285, 'recall': 0.80697674, 'specificity': 0.80697674, 'f1': 0.8069506, 'auroc': 0.8724067, 'binary_precision': 0.8142857, 'binary_recall': 0.7953488, 'binary_specificity': 0.81860465, 'binary_f1_score': 0.80470586}
confusion matrix:
     0    1
0  176   39
1   44  171
new oracle model saved
better model found
persisted
after epoch: 30,now: 2024-07-20 13:37:39.500561,epoch time: 0:01:30.932637,used: 0:44:12.593499,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_12_53_26_seed_0_22504803
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 0:44:12.593499 at 2024-07-20 13:37:39.500561
persisted model performance metric: 

scalar performance:
{'acc': 0.80697674, 'precision': 0.80714285, 'recall': 0.80697674, 'specificity': 0.80697674, 'f1': 0.8069506, 'auroc': 0.8724067, 'binary_precision': 0.8142857, 'binary_recall': 0.7953488, 'binary_specificity': 0.81860465, 'binary_f1_score': 0.80470586}
confusion matrix:
     0    1
0  176   39
1   44  171
oracle model performance metric: 

scalar performance:
{'acc': 0.80697674, 'precision': 0.80714285, 'recall': 0.80697674, 'specificity': 0.80697674, 'f1': 0.8069506, 'auroc': 0.8724067, 'binary_precision': 0.8142857, 'binary_recall': 0.7953488, 'binary_specificity': 0.81860465, 'binary_f1_score': 0.80470586}
confusion matrix:
     0    1
0  176   39
1   44  171
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_halffreezeblocks_2024-07-20_12-47-21/rule_results/2.csv
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_halffreezeblocks_2024-07-20_12-47-21/rule_results/2.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_halffreezeblocks_2024-07-20_12-47-21/confusion_matrix/2.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 197058 KiB |   7828 MiB |  61331 GiB |  61331 GiB |
|       from large pool | 180662 KiB |   7805 MiB |  60516 GiB |  60516 GiB |
|       from small pool |  16396 KiB |     32 MiB |    815 GiB |    815 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 197058 KiB |   7828 MiB |  61331 GiB |  61331 GiB |
|       from large pool | 180662 KiB |   7805 MiB |  60516 GiB |  60516 GiB |
|       from small pool |  16396 KiB |     32 MiB |    815 GiB |    815 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 195188 KiB |   7827 MiB |  61327 GiB |  61327 GiB |
|       from large pool | 178979 KiB |   7804 MiB |  60513 GiB |  60513 GiB |
|       from small pool |  16209 KiB |     32 MiB |    813 GiB |    813 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   8524 MiB |   8524 MiB |   8524 MiB |      0 B   |
|       from large pool |   8486 MiB |   8486 MiB |   8486 MiB |      0 B   |
|       from small pool |     38 MiB |     38 MiB |     38 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |  56894 KiB | 732464 KiB |  34525 GiB |  34525 GiB |
|       from large pool |  50762 KiB | 730714 KiB |  33707 GiB |  33707 GiB |
|       from small pool |   6132 KiB |   9662 KiB |    817 GiB |    817 GiB |
|---------------------------------------------------------------------------|
| Allocations           |     788    |    1675    |   10387 K  |   10387 K  |
|       from large pool |      79    |     762    |    5637 K  |    5637 K  |
|       from small pool |     709    |    1005    |    4750 K  |    4749 K  |
|---------------------------------------------------------------------------|
| Active allocs         |     788    |    1675    |   10387 K  |   10387 K  |
|       from large pool |      79    |     762    |    5637 K  |    5637 K  |
|       from small pool |     709    |    1005    |    4750 K  |    4749 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     368    |     368    |     368    |       0    |
|       from large pool |     349    |     349    |     349    |       0    |
|       from small pool |      19    |      19    |      19    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      40    |     383    |    6399 K  |    6399 K  |
|       from large pool |      10    |     350    |    4321 K  |    4321 K  |
|       from small pool |      30    |     213    |    2077 K  |    2077 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   7828 MiB |  61331 GiB |  61331 GiB |
|       from large pool |  16640 KiB |   7805 MiB |  60516 GiB |  60516 GiB |
|       from small pool |      0 KiB |     32 MiB |    815 GiB |    815 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   7828 MiB |  61331 GiB |  61331 GiB |
|       from large pool |  16640 KiB |   7805 MiB |  60516 GiB |  60516 GiB |
|       from small pool |      0 KiB |     32 MiB |    815 GiB |    815 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   7827 MiB |  61327 GiB |  61327 GiB |
|       from large pool |  16640 KiB |   7804 MiB |  60513 GiB |  60513 GiB |
|       from small pool |      0 KiB |     32 MiB |    813 GiB |    813 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 253952 KiB |   8524 MiB |   8524 MiB |   8276 MiB |
|       from large pool | 231424 KiB |   8486 MiB |   8486 MiB |   8260 MiB |
|       from small pool |  22528 KiB |     38 MiB |     38 MiB |     16 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  30464 KiB | 732464 KiB |  34525 GiB |  34525 GiB |
|       from large pool |  30464 KiB | 730714 KiB |  33707 GiB |  33707 GiB |
|       from small pool |      0 KiB |  19386 KiB |    817 GiB |    817 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    1675    |   10387 K  |   10387 K  |
|       from large pool |       2    |     762    |    5637 K  |    5637 K  |
|       from small pool |       0    |    1005    |    4750 K  |    4750 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    1675    |   10387 K  |   10387 K  |
|       from large pool |       2    |     762    |    5637 K  |    5637 K  |
|       from small pool |       0    |    1005    |    4750 K  |    4750 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      22    |     368    |     368    |     346    |
|       from large pool |      11    |     349    |     349    |     338    |
|       from small pool |      11    |      19    |      19    |       8    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     383    |    6399 K  |    6399 K  |
|       from large pool |       3    |     350    |    4321 K  |    4321 K  |
|       from small pool |       0    |     213    |    2077 K  |    2077 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   7828 MiB |  61331 GiB |  61331 GiB |
|       from large pool |  16640 KiB |   7805 MiB |  60516 GiB |  60516 GiB |
|       from small pool |      0 KiB |     32 MiB |    815 GiB |    815 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   7828 MiB |  61331 GiB |  61331 GiB |
|       from large pool |  16640 KiB |   7805 MiB |  60516 GiB |  60516 GiB |
|       from small pool |      0 KiB |     32 MiB |    815 GiB |    815 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   7827 MiB |  61327 GiB |  61327 GiB |
|       from large pool |  16640 KiB |   7804 MiB |  60513 GiB |  60513 GiB |
|       from small pool |      0 KiB |     32 MiB |    813 GiB |    813 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 253952 KiB |   8524 MiB |   8524 MiB |   8276 MiB |
|       from large pool | 231424 KiB |   8486 MiB |   8486 MiB |   8260 MiB |
|       from small pool |  22528 KiB |     38 MiB |     38 MiB |     16 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  30464 KiB | 732464 KiB |  34525 GiB |  34525 GiB |
|       from large pool |  30464 KiB | 730714 KiB |  33707 GiB |  33707 GiB |
|       from small pool |      0 KiB |  19386 KiB |    817 GiB |    817 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    1675    |   10387 K  |   10387 K  |
|       from large pool |       2    |     762    |    5637 K  |    5637 K  |
|       from small pool |       0    |    1005    |    4750 K  |    4750 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    1675    |   10387 K  |   10387 K  |
|       from large pool |       2    |     762    |    5637 K  |    5637 K  |
|       from small pool |       0    |    1005    |    4750 K  |    4750 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      22    |     368    |     368    |     346    |
|       from large pool |      11    |     349    |     349    |     338    |
|       from small pool |      11    |      19    |      19    |       8    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     383    |    6399 K  |    6399 K  |
|       from large pool |       3    |     350    |    4321 K  |    4321 K  |
|       from small pool |       0    |     213    |    2077 K  |    2077 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'888c1ef2'
model name: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_13_39_04_seed_1_22504803

 Experiment start at: 2024-07-20 13:39:04.750146
before training, model accuracy: 0.6177777647972107
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.55045575, 'precision': 0.5570496, 'recall': 0.54814684, 'specificity': 0.54814684, 'f1': 0.53104466, 'auroc': 0.53688, 'binary_precision': 0.54036397, 'binary_recall': 0.74517375, 'binary_specificity': 0.3511199, 'binary_f1_score': 0.6264539}
confusion matrix:
     0     1
0  533   985
1  396  1158
---- Validation: 
scalar performance:
{'acc': 0.490242, 'precision': 0.47327346, 'recall': 0.48484382, 'specificity': 0.48484382, 'f1': 0.42482862, 'auroc': 0.62343407, 'binary_precision': 0.44748858, 'binary_recall': 0.15555556, 'binary_specificity': 0.8141321, 'binary_f1_score': 0.23085983}
confusion matrix:
     0    1
0  530  121
1  532   98
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.56222224, 'precision': 0.57871854, 'recall': 0.56222224, 'specificity': 0.56222224, 'f1': 0.53801894, 'auroc': 0.66964936, 'binary_precision': 0.6147541, 'binary_recall': 0.33333334, 'binary_specificity': 0.7911111, 'binary_f1_score': 0.43227664}
confusion matrix:
     0   1
0  178  47
1  150  75
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-20 13:40:36.919528,epoch time: 0:01:32.169382,used: 0:01:32.169382,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_13_39_04_seed_1_22504803
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.5878906, 'precision': 0.5884278, 'recall': 0.58704793, 'specificity': 0.58704793, 'f1': 0.5858811, 'auroc': 0.6057354, 'binary_precision': 0.5841527, 'binary_recall': 0.64868337, 'binary_specificity': 0.52541256, 'binary_f1_score': 0.6147292}
confusion matrix:
     0     1
0  796   719
1  547  1010
---- Validation: 
scalar performance:
{'acc': 0.4746292, 'precision': 0.41999215, 'recall': 0.46825397, 'specificity': 0.46825397, 'f1': 0.37658915, 'auroc': 0.63325775, 'binary_precision': 0.34965035, 'binary_recall': 0.07936508, 'binary_specificity': 0.85714287, 'binary_f1_score': 0.12936611}
confusion matrix:
     0   1
0  558  93
1  580  50
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5422222, 'precision': 0.57766795, 'recall': 0.5422222, 'specificity': 0.5422222, 'f1': 0.48326606, 'auroc': 0.67972344, 'binary_precision': 0.63013697, 'binary_recall': 0.20444444, 'binary_specificity': 0.88, 'binary_f1_score': 0.30872485}
confusion matrix:
     0   1
0  198  27
1  179  46
early stop counter: 1
val acc:0.4746291935443878, best validation acc: 0.49024200439453125, corresponding to test acc:                         0.5622222423553467 / 0.5622222423553467
after epoch: 2,now: 2024-07-20 13:42:06.608195,epoch time: 0:01:29.688667,used: 0:03:01.858049,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_13_39_04_seed_1_22504803
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.64941406, 'precision': 0.6500428, 'recall': 0.6488892, 'specificity': 0.6488892, 'f1': 0.6485193, 'auroc': 0.6932245, 'binary_precision': 0.6429426, 'binary_recall': 0.69131833, 'binary_specificity': 0.6064601, 'binary_f1_score': 0.6662535}
confusion matrix:
     0     1
0  920   597
1  480  1075
---- Validation: 
scalar performance:
{'acc': 0.48087433, 'precision': 0.4381833, 'recall': 0.47457758, 'specificity': 0.47457758, 'f1': 0.38668728, 'auroc': 0.6534709, 'binary_precision': 0.38255033, 'binary_recall': 0.09047619, 'binary_specificity': 0.85867894, 'binary_f1_score': 0.14634147}
confusion matrix:
     0   1
0  559  92
1  573  57
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5422222, 'precision': 0.5832976, 'recall': 0.5422222, 'specificity': 0.5422222, 'f1': 0.47785234, 'auroc': 0.69999015, 'binary_precision': 0.64179105, 'binary_recall': 0.19111112, 'binary_specificity': 0.8933333, 'binary_f1_score': 0.29452053}
confusion matrix:
     0   1
0  201  24
1  182  43
early stop counter: 2
val acc:0.48087432980537415, best validation acc: 0.49024200439453125, corresponding to test acc:                         0.5622222423553467 / 0.5622222423553467
after epoch: 3,now: 2024-07-20 13:43:34.337555,epoch time: 0:01:27.729360,used: 0:04:29.587409,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_13_39_04_seed_1_22504803
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.7246094, 'precision': 0.7245591, 'recall': 0.7245809, 'specificity': 0.7245809, 'f1': 0.72456723, 'auroc': 0.7809135, 'binary_precision': 0.72938144, 'binary_recall': 0.7265725, 'binary_specificity': 0.7225892, 'binary_f1_score': 0.7279743}
confusion matrix:
      0     1
0  1094   420
1   426  1132
---- Validation: 
scalar performance:
{'acc': 0.48790008, 'precision': 0.45180494, 'recall': 0.48146442, 'specificity': 0.48146442, 'f1': 0.39008498, 'auroc': 0.66803205, 'binary_precision': 0.4057971, 'binary_recall': 0.08888889, 'binary_specificity': 0.87403995, 'binary_f1_score': 0.14583334}
confusion matrix:
     0   1
0  569  82
1  574  56
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5311111, 'precision': 0.57138324, 'recall': 0.5311111, 'specificity': 0.5311111, 'f1': 0.45411897, 'auroc': 0.72031605, 'binary_precision': 0.625, 'binary_recall': 0.15555556, 'binary_specificity': 0.9066667, 'binary_f1_score': 0.24911033}
confusion matrix:
     0   1
0  204  21
1  190  35
early stop counter: 3
val acc:0.4879000782966614, best validation acc: 0.49024200439453125, corresponding to test acc:                         0.5622222423553467 / 0.5622222423553467
after epoch: 4,now: 2024-07-20 13:45:05.114879,epoch time: 0:01:30.777324,used: 0:06:00.364733,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_13_39_04_seed_1_22504803
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.7701823, 'precision': 0.77023613, 'recall': 0.77027047, 'specificity': 0.77027047, 'f1': 0.77017987, 'auroc': 0.8392867, 'binary_precision': 0.7785059, 'binary_recall': 0.76349616, 'binary_specificity': 0.77704483, 'binary_f1_score': 0.77092797}
confusion matrix:
      0     1
0  1178   338
1   368  1188
---- Validation: 
scalar performance:
{'acc': 0.4918033, 'precision': 0.4632867, 'recall': 0.48543268, 'specificity': 0.48543268, 'f1': 0.39696813, 'auroc': 0.6851462, 'binary_precision': 0.42657343, 'binary_recall': 0.0968254, 'binary_specificity': 0.87403995, 'binary_f1_score': 0.15782666}
confusion matrix:
     0   1
0  569  82
1  569  61
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5511111, 'precision': 0.60612774, 'recall': 0.5511111, 'specificity': 0.5511111, 'f1': 0.4842729, 'auroc': 0.7358222, 'binary_precision': 0.6825397, 'binary_recall': 0.19111112, 'binary_specificity': 0.9111111, 'binary_f1_score': 0.29861113}
confusion matrix:
     0   1
0  205  20
1  182  43
better model found
persisted
after epoch: 5,now: 2024-07-20 13:46:32.932319,epoch time: 0:01:27.817440,used: 0:07:28.182173,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_13_39_04_seed_1_22504803
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.79557294, 'precision': 0.79581296, 'recall': 0.79575026, 'specificity': 0.79575026, 'f1': 0.7955708, 'auroc': 0.8705127, 'binary_precision': 0.80810094, 'binary_recall': 0.7821337, 'binary_specificity': 0.80936676, 'binary_f1_score': 0.79490536}
confusion matrix:
      0     1
0  1227   289
1   339  1217
---- Validation: 
scalar performance:
{'acc': 0.51053864, 'precision': 0.5100646, 'recall': 0.5043779, 'specificity': 0.5043779, 'f1': 0.42584264, 'auroc': 0.7007022, 'binary_precision': 0.509434, 'binary_recall': 0.12857144, 'binary_specificity': 0.88018435, 'binary_f1_score': 0.20532319}
confusion matrix:
     0   1
0  573  78
1  549  81
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5511111, 'precision': 0.60339665, 'recall': 0.5511111, 'specificity': 0.5511111, 'f1': 0.48615038, 'auroc': 0.7466074, 'binary_precision': 0.6769231, 'binary_recall': 0.19555555, 'binary_specificity': 0.9066667, 'binary_f1_score': 0.3034483}
confusion matrix:
     0   1
0  204  21
1  181  44
better model found
persisted
after epoch: 6,now: 2024-07-20 13:48:02.160292,epoch time: 0:01:29.227973,used: 0:08:57.410146,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_13_39_04_seed_1_22504803
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.80371094, 'precision': 0.80449724, 'recall': 0.80401516, 'specificity': 0.80401516, 'f1': 0.80366874, 'auroc': 0.8775265, 'binary_precision': 0.82336956, 'binary_recall': 0.7794212, 'binary_specificity': 0.8286091, 'binary_f1_score': 0.8007928}
confusion matrix:
      0     1
0  1257   260
1   343  1212
---- Validation: 
scalar performance:
{'acc': 0.5136612, 'precision': 0.51699734, 'recall': 0.5075525, 'specificity': 0.5075525, 'f1': 0.4310997, 'auroc': 0.7148222, 'binary_precision': 0.5214724, 'binary_recall': 0.13492064, 'binary_specificity': 0.88018435, 'binary_f1_score': 0.2143758}
confusion matrix:
     0   1
0  573  78
1  545  85
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.56222224, 'precision': 0.6184211, 'recall': 0.56222224, 'specificity': 0.56222224, 'f1': 0.5032917, 'auroc': 0.75911117, 'binary_precision': 0.7, 'binary_recall': 0.21777777, 'binary_specificity': 0.9066667, 'binary_f1_score': 0.3322034}
confusion matrix:
     0   1
0  204  21
1  176  49
better model found
persisted
after epoch: 7,now: 2024-07-20 13:49:29.807089,epoch time: 0:01:27.646797,used: 0:10:25.056943,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_13_39_04_seed_1_22504803
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.8222656, 'precision': 0.823142, 'recall': 0.82260007, 'specificity': 0.82260007, 'f1': 0.82222575, 'auroc': 0.89092946, 'binary_precision': 0.8435374, 'binary_recall': 0.7969152, 'binary_specificity': 0.84828496, 'binary_f1_score': 0.81956375}
confusion matrix:
      0     1
0  1286   230
1   316  1240
---- Validation: 
scalar performance:
{'acc': 0.5175644, 'precision': 0.5261095, 'recall': 0.51141834, 'specificity': 0.51141834, 'f1': 0.43448153, 'auroc': 0.72756934, 'binary_precision': 0.5375, 'binary_recall': 0.13650794, 'binary_specificity': 0.8863287, 'binary_f1_score': 0.21772152}
confusion matrix:
     0   1
0  577  74
1  544  86
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.55777776, 'precision': 0.6184019, 'recall': 0.55777776, 'specificity': 0.55777776, 'f1': 0.49286157, 'auroc': 0.769521, 'binary_precision': 0.703125, 'binary_recall': 0.2, 'binary_specificity': 0.91555554, 'binary_f1_score': 0.31141868}
confusion matrix:
     0   1
0  206  19
1  180  45
better model found
persisted
after epoch: 8,now: 2024-07-20 13:50:57.051039,epoch time: 0:01:27.243950,used: 0:11:52.300893,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_13_39_04_seed_1_22504803
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.83528644, 'precision': 0.83801496, 'recall': 0.83586895, 'specificity': 0.83586895, 'f1': 0.8350975, 'auroc': 0.90831643, 'binary_precision': 0.87181306, 'binary_recall': 0.7911311, 'binary_specificity': 0.8806069, 'binary_f1_score': 0.82951486}
confusion matrix:
      0     1
0  1335   181
1   325  1231
---- Validation: 
scalar performance:
{'acc': 0.520687, 'precision': 0.53484523, 'recall': 0.5144137, 'specificity': 0.5144137, 'f1': 0.43413195, 'auroc': 0.7381806, 'binary_precision': 0.55333334, 'binary_recall': 0.13174604, 'binary_specificity': 0.89708143, 'binary_f1_score': 0.21282052}
confusion matrix:
     0   1
0  584  67
1  547  83
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5644444, 'precision': 0.63749003, 'recall': 0.5644445, 'specificity': 0.5644445, 'f1': 0.49773353, 'auroc': 0.7804642, 'binary_precision': 0.73770493, 'binary_recall': 0.2, 'binary_specificity': 0.9288889, 'binary_f1_score': 0.3146853}
confusion matrix:
     0   1
0  209  16
1  180  45
new oracle model saved
better model found
persisted
after epoch: 9,now: 2024-07-20 13:52:27.303742,epoch time: 0:01:30.252703,used: 0:13:22.553596,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_13_39_04_seed_1_22504803
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.8460286, 'precision': 0.85003436, 'recall': 0.846761, 'specificity': 0.846761, 'f1': 0.84575665, 'auroc': 0.9135704, 'binary_precision': 0.8910534, 'binary_recall': 0.793192, 'binary_specificity': 0.90033, 'binary_f1_score': 0.83927965}
confusion matrix:
      0     1
0  1364   151
1   322  1235
---- Validation: 
scalar performance:
{'acc': 0.52224827, 'precision': 0.5375128, 'recall': 0.51605225, 'specificity': 0.51605225, 'f1': 0.43838972, 'auroc': 0.74757516, 'binary_precision': 0.5576923, 'binary_recall': 0.13809524, 'binary_specificity': 0.89400923, 'binary_f1_score': 0.22137405}
confusion matrix:
     0   1
0  582  69
1  543  87
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.56222224, 'precision': 0.6346154, 'recall': 0.56222224, 'specificity': 0.56222224, 'f1': 0.49422336, 'auroc': 0.7880297, 'binary_precision': 0.73333335, 'binary_recall': 0.19555555, 'binary_specificity': 0.9288889, 'binary_f1_score': 0.3087719}
confusion matrix:
     0   1
0  209  16
1  181  44
better model found
persisted
after epoch: 10,now: 2024-07-20 13:53:55.634772,epoch time: 0:01:28.331030,used: 0:14:50.884626,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_13_39_04_seed_1_22504803
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.8535156, 'precision': 0.85756135, 'recall': 0.85421145, 'specificity': 0.85421145, 'f1': 0.8532529, 'auroc': 0.9186789, 'binary_precision': 0.8989899, 'binary_recall': 0.80077124, 'binary_specificity': 0.9076517, 'binary_f1_score': 0.84704286}
confusion matrix:
      0     1
0  1376   140
1   310  1246
---- Validation: 
scalar performance:
{'acc': 0.5316159, 'precision': 0.5560984, 'recall': 0.52557606, 'specificity': 0.52557606, 'f1': 0.45399216, 'auroc': 0.75363666, 'binary_precision': 0.58928573, 'binary_recall': 0.15714286, 'binary_specificity': 0.89400923, 'binary_f1_score': 0.2481203}
confusion matrix:
     0   1
0  582  69
1  531  99
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.56666666, 'precision': 0.63661754, 'recall': 0.56666666, 'specificity': 0.56666666, 'f1': 0.5030553, 'auroc': 0.79529876, 'binary_precision': 0.734375, 'binary_recall': 0.20888889, 'binary_specificity': 0.92444444, 'binary_f1_score': 0.3252595}
confusion matrix:
     0   1
0  208  17
1  178  47
new oracle model saved
better model found
persisted
after epoch: 11,now: 2024-07-20 13:55:26.110133,epoch time: 0:01:30.475361,used: 0:16:21.359987,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_13_39_04_seed_1_22504803
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.8776042, 'precision': 0.88138574, 'recall': 0.8782298, 'specificity': 0.8782298, 'f1': 0.8774109, 'auroc': 0.93116045, 'binary_precision': 0.92258066, 'binary_recall': 0.82765275, 'binary_specificity': 0.92880684, 'binary_f1_score': 0.87254244}
confusion matrix:
      0     1
0  1409   108
1   268  1287
---- Validation: 
scalar performance:
{'acc': 0.5448868, 'precision': 0.57837355, 'recall': 0.5390937, 'specificity': 0.5390937, 'f1': 0.47615814, 'auroc': 0.76035154, 'binary_precision': 0.62566847, 'binary_recall': 0.18571429, 'binary_specificity': 0.8924731, 'binary_f1_score': 0.2864137}
confusion matrix:
     0    1
0  581   70
1  513  117
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.56666666, 'precision': 0.6331676, 'recall': 0.56666666, 'specificity': 0.56666666, 'f1': 0.5048499, 'auroc': 0.8017185, 'binary_precision': 0.72727275, 'binary_recall': 0.21333334, 'binary_specificity': 0.92, 'binary_f1_score': 0.3298969}
confusion matrix:
     0   1
0  207  18
1  177  48
better model found
persisted
after epoch: 12,now: 2024-07-20 13:56:54.925018,epoch time: 0:01:28.814885,used: 0:17:50.174872,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_13_39_04_seed_1_22504803
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.88346356, 'precision': 0.88547885, 'recall': 0.8838977, 'specificity': 0.8838977, 'f1': 0.8833804, 'auroc': 0.93747234, 'binary_precision': 0.9164345, 'binary_recall': 0.8468468, 'binary_specificity': 0.9209486, 'binary_f1_score': 0.8802675}
confusion matrix:
      0     1
0  1398   120
1   238  1316
---- Validation: 
scalar performance:
{'acc': 0.54566747, 'precision': 0.57834023, 'recall': 0.53993857, 'specificity': 0.53993857, 'f1': 0.47874403, 'auroc': 0.76371884, 'binary_precision': 0.625, 'binary_recall': 0.1904762, 'binary_specificity': 0.8894009, 'binary_f1_score': 0.29197082}
confusion matrix:
     0    1
0  579   72
1  510  120
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.57555556, 'precision': 0.64379704, 'recall': 0.57555556, 'specificity': 0.57555556, 'f1': 0.51842, 'auroc': 0.80790126, 'binary_precision': 0.74285716, 'binary_recall': 0.23111111, 'binary_specificity': 0.92, 'binary_f1_score': 0.35254237}
confusion matrix:
     0   1
0  207  18
1  173  52
new oracle model saved
better model found
persisted
after epoch: 13,now: 2024-07-20 13:58:26.675540,epoch time: 0:01:31.750522,used: 0:19:21.925394,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_13_39_04_seed_1_22504803
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.8753255, 'precision': 0.8794647, 'recall': 0.87594557, 'specificity': 0.87594557, 'f1': 0.87509835, 'auroc': 0.9343116, 'binary_precision': 0.9221341, 'binary_recall': 0.8230373, 'binary_specificity': 0.92885375, 'binary_f1_score': 0.8697722}
confusion matrix:
      0     1
0  1410   108
1   275  1279
---- Validation: 
scalar performance:
{'acc': 0.5550351, 'precision': 0.59302485, 'recall': 0.54943675, 'specificity': 0.54943675, 'f1': 0.49271205, 'auroc': 0.76971203, 'binary_precision': 0.64851487, 'binary_recall': 0.20793651, 'binary_specificity': 0.89093703, 'binary_f1_score': 0.31490386}
confusion matrix:
     0    1
0  580   71
1  499  131
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.58, 'precision': 0.64880955, 'recall': 0.58, 'specificity': 0.58, 'f1': 0.5251017, 'auroc': 0.8128, 'binary_precision': 0.75, 'binary_recall': 0.24, 'binary_specificity': 0.92, 'binary_f1_score': 0.36363634}
confusion matrix:
     0   1
0  207  18
1  171  54
new oracle model saved
better model found
persisted
after epoch: 14,now: 2024-07-20 13:59:54.319542,epoch time: 0:01:27.644002,used: 0:20:49.569396,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_13_39_04_seed_1_22504803
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.8880208, 'precision': 0.89233464, 'recall': 0.8886464, 'specificity': 0.8886464, 'f1': 0.8878137, 'auroc': 0.9436527, 'binary_precision': 0.93650794, 'binary_recall': 0.83526385, 'binary_specificity': 0.942029, 'binary_f1_score': 0.88299316}
confusion matrix:
      0     1
0  1430    88
1   256  1298
---- Validation: 
scalar performance:
{'acc': 0.5581577, 'precision': 0.60121787, 'recall': 0.5524834, 'specificity': 0.5524834, 'f1': 0.4943666, 'auroc': 0.7741252, 'binary_precision': 0.6632653, 'binary_recall': 0.20634921, 'binary_specificity': 0.8986175, 'binary_f1_score': 0.31477}
confusion matrix:
     0    1
0  585   66
1  500  130
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.57555556, 'precision': 0.64379704, 'recall': 0.57555556, 'specificity': 0.57555556, 'f1': 0.51842, 'auroc': 0.8153087, 'binary_precision': 0.74285716, 'binary_recall': 0.23111111, 'binary_specificity': 0.92, 'binary_f1_score': 0.35254237}
confusion matrix:
     0   1
0  207  18
1  173  52
better model found
persisted
after epoch: 15,now: 2024-07-20 14:01:21.902424,epoch time: 0:01:27.582882,used: 0:22:17.152278,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_13_39_04_seed_1_22504803
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.8932292, 'precision': 0.898492, 'recall': 0.8939538, 'specificity': 0.8939538, 'f1': 0.89298743, 'auroc': 0.94734573, 'binary_precision': 0.9474836, 'binary_recall': 0.83536977, 'binary_specificity': 0.9525379, 'binary_f1_score': 0.88790154}
confusion matrix:
      0     1
0  1445    72
1   256  1299
---- Validation: 
scalar performance:
{'acc': 0.5620609, 'precision': 0.6091798, 'recall': 0.5563748, 'specificity': 0.5563748, 'f1': 0.49851465, 'auroc': 0.77853364, 'binary_precision': 0.6769231, 'binary_recall': 0.20952381, 'binary_specificity': 0.9032258, 'binary_f1_score': 0.32}
confusion matrix:
     0    1
0  588   63
1  498  132
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5777778, 'precision': 0.653443, 'recall': 0.5777778, 'specificity': 0.5777778, 'f1': 0.5184075, 'auroc': 0.81888396, 'binary_precision': 0.76119405, 'binary_recall': 0.22666667, 'binary_specificity': 0.9288889, 'binary_f1_score': 0.34931508}
confusion matrix:
     0   1
0  209  16
1  174  51
better model found
persisted
after epoch: 16,now: 2024-07-20 14:02:51.468405,epoch time: 0:01:29.565981,used: 0:23:46.718259,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_13_39_04_seed_1_22504803
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.8844401, 'precision': 0.8907359, 'recall': 0.8853221, 'specificity': 0.8853221, 'f1': 0.88412184, 'auroc': 0.9424908, 'binary_precision': 0.94387, 'binary_recall': 0.82080925, 'binary_specificity': 0.949835, 'binary_f1_score': 0.87804884}
confusion matrix:
      0     1
0  1439    76
1   279  1278
---- Validation: 
scalar performance:
{'acc': 0.55737704, 'precision': 0.60342026, 'recall': 0.5515873, 'specificity': 0.5515873, 'f1': 0.4905346, 'auroc': 0.77943337, 'binary_precision': 0.6684492, 'binary_recall': 0.1984127, 'binary_specificity': 0.9047619, 'binary_f1_score': 0.30599755}
confusion matrix:
     0    1
0  589   62
1  505  125
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5733333, 'precision': 0.6446748, 'recall': 0.5733333, 'specificity': 0.5733333, 'f1': 0.5133381, 'auroc': 0.8198519, 'binary_precision': 0.74626863, 'binary_recall': 0.22222222, 'binary_specificity': 0.92444444, 'binary_f1_score': 0.34246576}
confusion matrix:
     0   1
0  208  17
1  175  50
early stop counter: 1
val acc:0.5573770403862, best validation acc: 0.5620608925819397, corresponding to test acc:                         0.5777778029441833 / 0.5799999833106995
after epoch: 17,now: 2024-07-20 14:04:19.387833,epoch time: 0:01:27.919428,used: 0:25:14.637687,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_13_39_04_seed_1_22504803
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.898112, 'precision': 0.90097266, 'recall': 0.89862067, 'specificity': 0.89862067, 'f1': 0.8980017, 'auroc': 0.94487214, 'binary_precision': 0.93789697, 'binary_recall': 0.85521233, 'binary_specificity': 0.942029, 'binary_f1_score': 0.89464825}
confusion matrix:
      0     1
0  1430    88
1   225  1329
---- Validation: 
scalar performance:
{'acc': 0.57377046, 'precision': 0.6245098, 'recall': 0.56827956, 'specificity': 0.56827956, 'f1': 0.5164634, 'auroc': 0.7820374, 'binary_precision': 0.7, 'binary_recall': 0.23333333, 'binary_specificity': 0.9032258, 'binary_f1_score': 0.35}
confusion matrix:
     0    1
0  588   63
1  483  147
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5977778, 'precision': 0.66403764, 'recall': 0.5977778, 'specificity': 0.5977778, 'f1': 0.5525979, 'auroc': 0.8266667, 'binary_precision': 0.76829267, 'binary_recall': 0.28, 'binary_specificity': 0.91555554, 'binary_f1_score': 0.4104235}
confusion matrix:
     0   1
0  206  19
1  162  63
new oracle model saved
better model found
persisted
after epoch: 18,now: 2024-07-20 14:05:50.394977,epoch time: 0:01:31.007144,used: 0:26:45.644831,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_13_39_04_seed_1_22504803
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.89127606, 'precision': 0.89637184, 'recall': 0.89202917, 'specificity': 0.89202917, 'f1': 0.8910433, 'auroc': 0.9483093, 'binary_precision': 0.94468707, 'binary_recall': 0.83419025, 'binary_specificity': 0.9498681, 'binary_f1_score': 0.8860069}
confusion matrix:
      0     1
0  1440    76
1   258  1298
---- Validation: 
scalar performance:
{'acc': 0.5745511, 'precision': 0.62733114, 'recall': 0.569022, 'specificity': 0.569022, 'f1': 0.5164615, 'auroc': 0.7848048, 'binary_precision': 0.705314, 'binary_recall': 0.23174603, 'binary_specificity': 0.906298, 'binary_f1_score': 0.348865}
confusion matrix:
     0    1
0  590   61
1  484  146
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5933333, 'precision': 0.6628412, 'recall': 0.59333336, 'specificity': 0.59333336, 'f1': 0.54475343, 'auroc': 0.8287407, 'binary_precision': 0.7692308, 'binary_recall': 0.26666668, 'binary_specificity': 0.92, 'binary_f1_score': 0.3960396}
confusion matrix:
     0   1
0  207  18
1  165  60
better model found
persisted
after epoch: 19,now: 2024-07-20 14:07:19.369236,epoch time: 0:01:28.974259,used: 0:28:14.619090,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_13_39_04_seed_1_22504803
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9013672, 'precision': 0.9059949, 'recall': 0.90215373, 'specificity': 0.90215373, 'f1': 0.90119296, 'auroc': 0.9472448, 'binary_precision': 0.9530686, 'binary_recall': 0.84724003, 'binary_specificity': 0.9570674, 'binary_f1_score': 0.8970438}
confusion matrix:
      0     1
0  1449    65
1   238  1320
---- Validation: 
scalar performance:
{'acc': 0.57689303, 'precision': 0.6302054, 'recall': 0.57140297, 'specificity': 0.57140297, 'f1': 0.5200058, 'auroc': 0.78836954, 'binary_precision': 0.7095238, 'binary_recall': 0.23650794, 'binary_specificity': 0.906298, 'binary_f1_score': 0.3547619}
confusion matrix:
     0    1
0  590   61
1  481  149
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.60444444, 'precision': 0.67690456, 'recall': 0.60444444, 'specificity': 0.60444444, 'f1': 0.55931866, 'auroc': 0.8327506, 'binary_precision': 0.79012346, 'binary_recall': 0.28444445, 'binary_specificity': 0.92444444, 'binary_f1_score': 0.4183007}
confusion matrix:
     0   1
0  208  17
1  161  64
new oracle model saved
better model found
persisted
after epoch: 20,now: 2024-07-20 14:08:50.758777,epoch time: 0:01:31.389541,used: 0:29:46.008631,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_13_39_04_seed_1_22504803
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.8873698, 'precision': 0.8944565, 'recall': 0.8883013, 'specificity': 0.8883013, 'f1': 0.8870156, 'auroc': 0.9526037, 'binary_precision': 0.95085627, 'binary_recall': 0.820167, 'binary_specificity': 0.9564356, 'binary_f1_score': 0.8806896}
confusion matrix:
      0     1
0  1449    66
1   280  1277
---- Validation: 
scalar performance:
{'acc': 0.5925059, 'precision': 0.6461869, 'recall': 0.5873272, 'specificity': 0.5873272, 'f1': 0.5442064, 'auroc': 0.7927828, 'binary_precision': 0.7307692, 'binary_recall': 0.27142859, 'binary_specificity': 0.9032258, 'binary_f1_score': 0.39583337}
confusion matrix:
     0    1
0  588   63
1  459  171
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.61777776, 'precision': 0.6825125, 'recall': 0.61777776, 'specificity': 0.61777776, 'f1': 0.58058786, 'auroc': 0.8372938, 'binary_precision': 0.7912088, 'binary_recall': 0.32, 'binary_specificity': 0.91555554, 'binary_f1_score': 0.45569623}
confusion matrix:
     0   1
0  206  19
1  153  72
new oracle model saved
better model found
persisted
after epoch: 21,now: 2024-07-20 14:10:18.269444,epoch time: 0:01:27.510667,used: 0:31:13.519298,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_13_39_04_seed_1_22504803
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.89778644, 'precision': 0.90470374, 'recall': 0.898566, 'specificity': 0.898566, 'f1': 0.897465, 'auroc': 0.95726526, 'binary_precision': 0.9606241, 'binary_recall': 0.83204633, 'binary_specificity': 0.9650856, 'binary_f1_score': 0.8917241}
confusion matrix:
      0     1
0  1465    53
1   261  1293
---- Validation: 
scalar performance:
{'acc': 0.5964091, 'precision': 0.6503506, 'recall': 0.5912954, 'specificity': 0.5912954, 'f1': 0.5498441, 'auroc': 0.795694, 'binary_precision': 0.7364017, 'binary_recall': 0.2793651, 'binary_specificity': 0.9032258, 'binary_f1_score': 0.40506333}
confusion matrix:
     0    1
0  588   63
1  454  176
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6244444, 'precision': 0.6944444, 'recall': 0.6244444, 'specificity': 0.6244444, 'f1': 0.5873016, 'auroc': 0.83926916, 'binary_precision': 0.8111111, 'binary_recall': 0.32444444, 'binary_specificity': 0.92444444, 'binary_f1_score': 0.4634921}
confusion matrix:
     0   1
0  208  17
1  152  73
new oracle model saved
better model found
persisted
after epoch: 22,now: 2024-07-20 14:11:44.169927,epoch time: 0:01:25.900483,used: 0:32:39.419781,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_13_39_04_seed_1_22504803
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.90234375, 'precision': 0.91036034, 'recall': 0.9031773, 'specificity': 0.9031773, 'f1': 0.9019844, 'auroc': 0.9573287, 'binary_precision': 0.9707207, 'binary_recall': 0.83204633, 'binary_specificity': 0.9743083, 'binary_f1_score': 0.89604986}
confusion matrix:
      0     1
0  1479    39
1   261  1293
---- Validation: 
scalar performance:
{'acc': 0.5971897, 'precision': 0.65305936, 'recall': 0.5920379, 'specificity': 0.5920379, 'f1': 0.5499559, 'auroc': 0.7980494, 'binary_precision': 0.7415254, 'binary_recall': 0.2777778, 'binary_specificity': 0.906298, 'binary_f1_score': 0.40415704}
confusion matrix:
     0    1
0  590   61
1  455  175
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.62222224, 'precision': 0.692583, 'recall': 0.6222222, 'specificity': 0.6222222, 'f1': 0.5842482, 'auroc': 0.8409481, 'binary_precision': 0.80898875, 'binary_recall': 0.32, 'binary_specificity': 0.92444444, 'binary_f1_score': 0.4585987}
confusion matrix:
     0   1
0  208  17
1  153  72
better model found
persisted
after epoch: 23,now: 2024-07-20 14:13:13.769807,epoch time: 0:01:29.599880,used: 0:34:09.019661,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_13_39_04_seed_1_22504803
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9082031, 'precision': 0.91402304, 'recall': 0.90895426, 'specificity': 0.90895426, 'f1': 0.9079778, 'auroc': 0.9640266, 'binary_precision': 0.96630037, 'binary_recall': 0.8482315, 'binary_specificity': 0.969677, 'binary_f1_score': 0.9034247}
confusion matrix:
      0     1
0  1471    46
1   236  1319
---- Validation: 
scalar performance:
{'acc': 0.60967994, 'precision': 0.66565436, 'recall': 0.6047363, 'specificity': 0.6047363, 'f1': 0.5677437, 'auroc': 0.8012996, 'binary_precision': 0.75793654, 'binary_recall': 0.30317461, 'binary_specificity': 0.906298, 'binary_f1_score': 0.43310654}
confusion matrix:
     0    1
0  590   61
1  439  191
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6422222, 'precision': 0.7057143, 'recall': 0.6422222, 'specificity': 0.6422222, 'f1': 0.61230767, 'auroc': 0.8443062, 'binary_precision': 0.82, 'binary_recall': 0.36444443, 'binary_specificity': 0.92, 'binary_f1_score': 0.50461537}
confusion matrix:
     0   1
0  207  18
1  143  82
new oracle model saved
better model found
persisted
after epoch: 24,now: 2024-07-20 14:14:42.038614,epoch time: 0:01:28.268807,used: 0:35:37.288468,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_13_39_04_seed_1_22504803
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.90559894, 'precision': 0.912385, 'recall': 0.9063225, 'specificity': 0.9063225, 'f1': 0.90530896, 'auroc': 0.9564876, 'binary_precision': 0.9681245, 'binary_recall': 0.840953, 'binary_specificity': 0.9716919, 'binary_f1_score': 0.9000689}
confusion matrix:
      0     1
0  1476    43
1   247  1306
---- Validation: 
scalar performance:
{'acc': 0.6284153, 'precision': 0.6830251, 'recall': 0.62378395, 'specificity': 0.62378395, 'f1': 0.59358704, 'auroc': 0.80635655, 'binary_precision': 0.7789855, 'binary_recall': 0.34126985, 'binary_specificity': 0.906298, 'binary_f1_score': 0.47461367}
confusion matrix:
     0    1
0  590   61
1  415  215
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6533333, 'precision': 0.71428573, 'recall': 0.6533333, 'specificity': 0.6533333, 'f1': 0.62679434, 'auroc': 0.84902716, 'binary_precision': 0.82857144, 'binary_recall': 0.38666666, 'binary_specificity': 0.92, 'binary_f1_score': 0.52727276}
confusion matrix:
     0   1
0  207  18
1  138  87
new oracle model saved
better model found
persisted
after epoch: 25,now: 2024-07-20 14:16:13.298606,epoch time: 0:01:31.259992,used: 0:37:08.548460,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_13_39_04_seed_1_22504803
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.913737, 'precision': 0.9177472, 'recall': 0.9143964, 'specificity': 0.9143964, 'f1': 0.91360736, 'auroc': 0.9652287, 'binary_precision': 0.9620616, 'binary_recall': 0.8637532, 'binary_specificity': 0.96503955, 'binary_f1_score': 0.9102608}
confusion matrix:
      0     1
0  1463    53
1   212  1344
---- Validation: 
scalar performance:
{'acc': 0.6416862, 'precision': 0.6910062, 'recall': 0.6373784, 'specificity': 0.6373784, 'f1': 0.6127796, 'auroc': 0.81075513, 'binary_precision': 0.78405315, 'binary_recall': 0.37460318, 'binary_specificity': 0.90015364, 'binary_f1_score': 0.50698173}
confusion matrix:
     0    1
0  586   65
1  394  236
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.67777777, 'precision': 0.732294, 'recall': 0.67777777, 'specificity': 0.67777777, 'f1': 0.6576941, 'auroc': 0.8529185, 'binary_precision': 0.8448276, 'binary_recall': 0.43555555, 'binary_specificity': 0.92, 'binary_f1_score': 0.57478005}
confusion matrix:
     0   1
0  207  18
1  127  98
new oracle model saved
better model found
persisted
after epoch: 26,now: 2024-07-20 14:17:41.975587,epoch time: 0:01:28.676981,used: 0:38:37.225441,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_13_39_04_seed_1_22504803
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.92252606, 'precision': 0.92565477, 'recall': 0.923078, 'specificity': 0.923078, 'f1': 0.9224405, 'auroc': 0.96788764, 'binary_precision': 0.965371, 'binary_recall': 0.8784566, 'binary_specificity': 0.9676994, 'binary_f1_score': 0.9198653}
confusion matrix:
      0     1
0  1468    49
1   189  1366
---- Validation: 
scalar performance:
{'acc': 0.63153785, 'precision': 0.6867025, 'recall': 0.6269329, 'specificity': 0.6269329, 'f1': 0.5974037, 'auroc': 0.8130032, 'binary_precision': 0.78417265, 'binary_recall': 0.34603176, 'binary_specificity': 0.9078341, 'binary_f1_score': 0.48017618}
confusion matrix:
     0    1
0  591   60
1  412  218
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.67333335, 'precision': 0.7317995, 'recall': 0.67333335, 'specificity': 0.67333335, 'f1': 0.65134853, 'auroc': 0.8548938, 'binary_precision': 0.84821427, 'binary_recall': 0.42222223, 'binary_specificity': 0.92444444, 'binary_f1_score': 0.56379825}
confusion matrix:
     0   1
0  208  17
1  130  95
early stop counter: 1
val acc:0.6315378546714783, best validation acc: 0.641686201095581, corresponding to test acc:                         0.6777777671813965 / 0.6777777671813965
after epoch: 27,now: 2024-07-20 14:19:13.729557,epoch time: 0:01:31.753970,used: 0:40:08.979411,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_13_39_04_seed_1_22504803
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.91015625, 'precision': 0.91581476, 'recall': 0.9109763, 'specificity': 0.9109763, 'f1': 0.9099529, 'auroc': 0.96328557, 'binary_precision': 0.96785975, 'binary_recall': 0.8509955, 'binary_specificity': 0.9709571, 'binary_f1_score': 0.90567327}
confusion matrix:
      0     1
0  1471    44
1   232  1325
---- Validation: 
scalar performance:
{'acc': 0.6323185, 'precision': 0.68927705, 'recall': 0.6276754, 'specificity': 0.6276754, 'f1': 0.5976547, 'auroc': 0.81493187, 'binary_precision': 0.78909093, 'binary_recall': 0.34444445, 'binary_specificity': 0.9109063, 'binary_f1_score': 0.47955802}
confusion matrix:
     0    1
0  593   58
1  413  217
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6711111, 'precision': 0.73305714, 'recall': 0.6711111, 'specificity': 0.6711111, 'f1': 0.647701, 'auroc': 0.85621727, 'binary_precision': 0.853211, 'binary_recall': 0.41333333, 'binary_specificity': 0.9288889, 'binary_f1_score': 0.5568862}
confusion matrix:
     0   1
0  209  16
1  132  93
early stop counter: 2
val acc:0.6323184967041016, best validation acc: 0.641686201095581, corresponding to test acc:                         0.6777777671813965 / 0.6777777671813965
after epoch: 28,now: 2024-07-20 14:20:41.892374,epoch time: 0:01:28.162817,used: 0:41:37.142228,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_13_39_04_seed_1_22504803
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9140625, 'precision': 0.92028105, 'recall': 0.914751, 'specificity': 0.914751, 'f1': 0.91382873, 'auroc': 0.9645189, 'binary_precision': 0.9742458, 'binary_recall': 0.8525435, 'binary_specificity': 0.9769585, 'binary_f1_score': 0.9093407}
confusion matrix:
      0     1
0  1484    35
1   229  1324
---- Validation: 
scalar performance:
{'acc': 0.6393443, 'precision': 0.6962335, 'recall': 0.6347926, 'specificity': 0.6347926, 'f1': 0.60671055, 'auroc': 0.81875503, 'binary_precision': 0.79787236, 'binary_recall': 0.35714287, 'binary_specificity': 0.9124424, 'binary_f1_score': 0.49342108}
confusion matrix:
     0    1
0  594   57
1  405  225
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6755555, 'precision': 0.7361875, 'recall': 0.6755556, 'specificity': 0.6755556, 'f1': 0.65330553, 'auroc': 0.85963464, 'binary_precision': 0.8558559, 'binary_recall': 0.42222223, 'binary_specificity': 0.9288889, 'binary_f1_score': 0.56547624}
confusion matrix:
     0   1
0  209  16
1  130  95
early stop counter: 3
val acc:0.6393442749977112, best validation acc: 0.641686201095581, corresponding to test acc:                         0.6777777671813965 / 0.6777777671813965
after epoch: 29,now: 2024-07-20 14:22:08.678883,epoch time: 0:01:26.786509,used: 0:43:03.928737,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_13_39_04_seed_1_22504803
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.91796875, 'precision': 0.9233079, 'recall': 0.91880065, 'specificity': 0.91880065, 'f1': 0.9178028, 'auroc': 0.9690527, 'binary_precision': 0.97456396, 'binary_recall': 0.86071885, 'binary_specificity': 0.97688246, 'binary_f1_score': 0.9141104}
confusion matrix:
      0     1
0  1479    35
1   217  1341
---- Validation: 
scalar performance:
{'acc': 0.63700235, 'precision': 0.69329715, 'recall': 0.6324373, 'specificity': 0.6324373, 'f1': 0.60396224, 'auroc': 0.8204545, 'binary_precision': 0.7935943, 'binary_recall': 0.35396826, 'binary_specificity': 0.9109063, 'binary_f1_score': 0.4895719}
confusion matrix:
     0    1
0  593   58
1  407  223
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6755555, 'precision': 0.7361875, 'recall': 0.6755556, 'specificity': 0.6755556, 'f1': 0.65330553, 'auroc': 0.8619062, 'binary_precision': 0.8558559, 'binary_recall': 0.42222223, 'binary_specificity': 0.9288889, 'binary_f1_score': 0.56547624}
confusion matrix:
     0   1
0  209  16
1  130  95
early stop counter: 4
val acc:0.6370023488998413, best validation acc: 0.641686201095581, corresponding to test acc:                         0.6777777671813965 / 0.6777777671813965
after epoch: 30,now: 2024-07-20 14:23:38.631881,epoch time: 0:01:29.952998,used: 0:44:33.881735,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_13_39_04_seed_1_22504803
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 0:44:33.881735 at 2024-07-20 14:23:38.631881
persisted model performance metric: 

scalar performance:
{'acc': 0.67777777, 'precision': 0.732294, 'recall': 0.67777777, 'specificity': 0.67777777, 'f1': 0.6576941, 'auroc': 0.8529185, 'binary_precision': 0.8448276, 'binary_recall': 0.43555555, 'binary_specificity': 0.92, 'binary_f1_score': 0.57478005}
confusion matrix:
     0   1
0  207  18
1  127  98
oracle model performance metric: 

scalar performance:
{'acc': 0.67777777, 'precision': 0.732294, 'recall': 0.67777777, 'specificity': 0.67777777, 'f1': 0.6576941, 'auroc': 0.8529185, 'binary_precision': 0.8448276, 'binary_recall': 0.43555555, 'binary_specificity': 0.92, 'binary_f1_score': 0.57478005}
confusion matrix:
     0   1
0  207  18
1  127  98
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_halffreezeblocks_2024-07-20_12-47-21/rule_results/2.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_halffreezeblocks_2024-07-20_12-47-21/confusion_matrix/2.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 195613 KiB |   7828 MiB | 124075 GiB | 124075 GiB |
|       from large pool | 179211 KiB |   7805 MiB | 122423 GiB | 122423 GiB |
|       from small pool |  16402 KiB |     36 MiB |   1652 GiB |   1652 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 195613 KiB |   7828 MiB | 124075 GiB | 124075 GiB |
|       from large pool | 179211 KiB |   7805 MiB | 122423 GiB | 122423 GiB |
|       from small pool |  16402 KiB |     36 MiB |   1652 GiB |   1652 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 195189 KiB |   7827 MiB | 124061 GiB | 124060 GiB |
|       from large pool | 178979 KiB |   7804 MiB | 122412 GiB | 122411 GiB |
|       from small pool |  16210 KiB |     36 MiB |   1648 GiB |   1648 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   8516 MiB |   8524 MiB |  16792 MiB |   8276 MiB |
|       from large pool |   8472 MiB |   8486 MiB |  16732 MiB |   8260 MiB |
|       from small pool |     44 MiB |     44 MiB |     60 MiB |     16 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  39907 KiB | 732464 KiB |  67125 GiB |  67125 GiB |
|       from large pool |  31733 KiB | 730714 KiB |  65468 GiB |  65468 GiB |
|       from small pool |   8174 KiB |  19386 KiB |   1657 GiB |   1657 GiB |
|---------------------------------------------------------------------------|
| Allocations           |     800    |    1679    |   20971 K  |   20970 K  |
|       from large pool |      79    |     762    |   11399 K  |   11399 K  |
|       from small pool |     721    |    1017    |    9572 K  |    9571 K  |
|---------------------------------------------------------------------------|
| Active allocs         |     800    |    1679    |   20971 K  |   20970 K  |
|       from large pool |      79    |     762    |   11399 K  |   11399 K  |
|       from small pool |     721    |    1017    |    9572 K  |    9571 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     370    |     370    |     716    |     346    |
|       from large pool |     348    |     349    |     686    |     338    |
|       from small pool |      22    |      22    |      30    |       8    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      45    |     383    |   12519 K  |   12519 K  |
|       from large pool |      11    |     351    |    8266 K  |    8265 K  |
|       from small pool |      34    |     213    |    4253 K  |    4253 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   7828 MiB | 124075 GiB | 124075 GiB |
|       from large pool |  16640 KiB |   7805 MiB | 122423 GiB | 122423 GiB |
|       from small pool |      0 KiB |     36 MiB |   1652 GiB |   1652 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   7828 MiB | 124075 GiB | 124075 GiB |
|       from large pool |  16640 KiB |   7805 MiB | 122423 GiB | 122423 GiB |
|       from small pool |      0 KiB |     36 MiB |   1652 GiB |   1652 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   7827 MiB | 124061 GiB | 124061 GiB |
|       from large pool |  16640 KiB |   7804 MiB | 122412 GiB | 122412 GiB |
|       from small pool |      0 KiB |     36 MiB |   1648 GiB |   1648 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 235520 KiB |   8524 MiB |  16792 MiB |  16562 MiB |
|       from large pool | 210944 KiB |   8486 MiB |  16732 MiB |  16526 MiB |
|       from small pool |  24576 KiB |     44 MiB |     60 MiB |     36 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  30464 KiB | 732464 KiB |  67126 GiB |  67126 GiB |
|       from large pool |  30464 KiB | 730714 KiB |  65468 GiB |  65468 GiB |
|       from small pool |      0 KiB |  22313 KiB |   1657 GiB |   1657 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    1679    |   20971 K  |   20971 K  |
|       from large pool |       2    |     762    |   11399 K  |   11399 K  |
|       from small pool |       0    |    1017    |    9572 K  |    9572 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    1679    |   20971 K  |   20971 K  |
|       from large pool |       2    |     762    |   11399 K  |   11399 K  |
|       from small pool |       0    |    1017    |    9572 K  |    9572 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      22    |     370    |     716    |     694    |
|       from large pool |      10    |     349    |     686    |     676    |
|       from small pool |      12    |      22    |      30    |      18    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     383    |   12519 K  |   12519 K  |
|       from large pool |       3    |     351    |    8266 K  |    8266 K  |
|       from small pool |       0    |     213    |    4253 K  |    4253 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   7828 MiB | 124075 GiB | 124075 GiB |
|       from large pool |  16640 KiB |   7805 MiB | 122423 GiB | 122423 GiB |
|       from small pool |      0 KiB |     36 MiB |   1652 GiB |   1652 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   7828 MiB | 124075 GiB | 124075 GiB |
|       from large pool |  16640 KiB |   7805 MiB | 122423 GiB | 122423 GiB |
|       from small pool |      0 KiB |     36 MiB |   1652 GiB |   1652 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   7827 MiB | 124061 GiB | 124061 GiB |
|       from large pool |  16640 KiB |   7804 MiB | 122412 GiB | 122412 GiB |
|       from small pool |      0 KiB |     36 MiB |   1648 GiB |   1648 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 235520 KiB |   8524 MiB |  16792 MiB |  16562 MiB |
|       from large pool | 210944 KiB |   8486 MiB |  16732 MiB |  16526 MiB |
|       from small pool |  24576 KiB |     44 MiB |     60 MiB |     36 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  30464 KiB | 732464 KiB |  67126 GiB |  67126 GiB |
|       from large pool |  30464 KiB | 730714 KiB |  65468 GiB |  65468 GiB |
|       from small pool |      0 KiB |  22313 KiB |   1657 GiB |   1657 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    1679    |   20971 K  |   20971 K  |
|       from large pool |       2    |     762    |   11399 K  |   11399 K  |
|       from small pool |       0    |    1017    |    9572 K  |    9572 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    1679    |   20971 K  |   20971 K  |
|       from large pool |       2    |     762    |   11399 K  |   11399 K  |
|       from small pool |       0    |    1017    |    9572 K  |    9572 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      22    |     370    |     716    |     694    |
|       from large pool |      10    |     349    |     686    |     676    |
|       from small pool |      12    |      22    |      30    |      18    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     383    |   12519 K  |   12519 K  |
|       from large pool |       3    |     351    |    8266 K  |    8266 K  |
|       from small pool |       0    |     213    |    4253 K  |    4253 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'888c1ef2'
model name: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_14_25_04_seed_2_22504803

 Experiment start at: 2024-07-20 14:25:04.283425
before training, model accuracy: 0.41203704476356506
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.5998037, 'precision': 0.62130105, 'recall': 0.6014007, 'specificity': 0.6014007, 'f1': 0.5833666, 'auroc': 0.659135, 'binary_precision': 0.6743674, 'binary_recall': 0.39805195, 'binary_specificity': 0.80474937, 'binary_f1_score': 0.5006125}
confusion matrix:
      0    1
0  1220  296
1   927  613
---- Validation: 
scalar performance:
{'acc': 0.6455399, 'precision': 0.65401375, 'recall': 0.64189327, 'specificity': 0.64189327, 'f1': 0.63691247, 'auroc': 0.6695602, 'binary_precision': 0.68409586, 'binary_recall': 0.50482315, 'binary_specificity': 0.7789634, 'binary_f1_score': 0.5809435}
confusion matrix:
     0    1
0  511  145
1  308  314
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.36805555, 'precision': 0.34646463, 'recall': 0.36805558, 'specificity': 0.36805558, 'f1': 0.34502923, 'auroc': 0.30883485, 'binary_precision': 0.2888889, 'binary_recall': 0.18055555, 'binary_specificity': 0.5555556, 'binary_f1_score': 0.22222222}
confusion matrix:
     0   1
0  120  96
1  177  39
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-20 14:26:37.483346,epoch time: 0:01:33.199921,used: 0:01:33.199921,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_14_25_04_seed_2_22504803
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.6616492, 'precision': 0.6623846, 'recall': 0.6618802, 'specificity': 0.6618802, 'f1': 0.6614507, 'auroc': 0.7160269, 'binary_precision': 0.67545074, 'binary_recall': 0.6324675, 'binary_specificity': 0.6912929, 'binary_f1_score': 0.6532528}
confusion matrix:
      0    1
0  1048  468
1   566  974
---- Validation: 
scalar performance:
{'acc': 0.6619718, 'precision': 0.6624294, 'recall': 0.6606492, 'specificity': 0.6606492, 'f1': 0.6604342, 'auroc': 0.6919433, 'binary_precision': 0.6666667, 'binary_recall': 0.61093247, 'binary_specificity': 0.71036583, 'binary_f1_score': 0.6375839}
confusion matrix:
     0    1
0  466  190
1  242  380
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.4050926, 'precision': 0.40380394, 'recall': 0.4050926, 'specificity': 0.4050926, 'f1': 0.40309355, 'auroc': 0.344243, 'binary_precision': 0.39267015, 'binary_recall': 0.3472222, 'binary_specificity': 0.46296296, 'binary_f1_score': 0.36855033}
confusion matrix:
     0    1
0  100  116
1  141   75
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-07-20 14:28:03.446198,epoch time: 0:01:25.962852,used: 0:02:59.162773,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_14_25_04_seed_2_22504803
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.697644, 'precision': 0.69772923, 'recall': 0.69770753, 'specificity': 0.69770753, 'f1': 0.6976419, 'auroc': 0.76287353, 'binary_precision': 0.704244, 'binary_recall': 0.68961036, 'binary_specificity': 0.70580477, 'binary_f1_score': 0.69685036}
confusion matrix:
      0     1
0  1070   446
1   478  1062
---- Validation: 
scalar performance:
{'acc': 0.6729264, 'precision': 0.6733672, 'recall': 0.6716949, 'specificity': 0.6716949, 'f1': 0.67157435, 'auroc': 0.7058809, 'binary_precision': 0.67770034, 'binary_recall': 0.6254019, 'binary_specificity': 0.7179878, 'binary_f1_score': 0.65050167}
confusion matrix:
     0    1
0  471  185
1  233  389
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.46296296, 'precision': 0.46291208, 'recall': 0.46296299, 'specificity': 0.46296299, 'f1': 0.46277875, 'auroc': 0.3788366, 'binary_precision': 0.46153846, 'binary_recall': 0.44444445, 'binary_specificity': 0.4814815, 'binary_f1_score': 0.4528302}
confusion matrix:
     0    1
0  104  112
1  120   96
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-07-20 14:29:33.068858,epoch time: 0:01:29.622660,used: 0:04:28.785433,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_14_25_04_seed_2_22504803
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.74770945, 'precision': 0.75179124, 'recall': 0.74819505, 'specificity': 0.74819505, 'f1': 0.746917, 'auroc': 0.82333255, 'binary_precision': 0.7858736, 'binary_recall': 0.68636364, 'binary_specificity': 0.8100264, 'binary_f1_score': 0.7327556}
confusion matrix:
      0     1
0  1228   288
1   483  1057
---- Validation: 
scalar performance:
{'acc': 0.6791862, 'precision': 0.68399966, 'recall': 0.67662585, 'specificity': 0.67662585, 'f1': 0.6749439, 'auroc': 0.7148582, 'binary_precision': 0.7078431, 'binary_recall': 0.58038586, 'binary_specificity': 0.77286583, 'binary_f1_score': 0.6378092}
confusion matrix:
     0    1
0  507  149
1  261  361
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.44212964, 'precision': 0.43974155, 'recall': 0.44212964, 'specificity': 0.44212964, 'f1': 0.43654716, 'auroc': 0.41405177, 'binary_precision': 0.42774567, 'binary_recall': 0.3425926, 'binary_specificity': 0.5416667, 'binary_f1_score': 0.38046274}
confusion matrix:
     0   1
0  117  99
1  142  74
better model found
persisted
after epoch: 4,now: 2024-07-20 14:30:57.951884,epoch time: 0:01:24.883026,used: 0:05:53.668459,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_14_25_04_seed_2_22504803
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.789267, 'precision': 0.7913724, 'recall': 0.7895932, 'specificity': 0.7895932, 'f1': 0.7890035, 'auroc': 0.8710294, 'binary_precision': 0.8181818, 'binary_recall': 0.74805194, 'binary_specificity': 0.83113456, 'binary_f1_score': 0.7815468}
confusion matrix:
      0     1
0  1260   256
1   388  1152
---- Validation: 
scalar performance:
{'acc': 0.6799687, 'precision': 0.6881849, 'recall': 0.6768048, 'specificity': 0.6768048, 'f1': 0.6738533, 'auroc': 0.72190905, 'binary_precision': 0.72141373, 'binary_recall': 0.55787784, 'binary_specificity': 0.7957317, 'binary_f1_score': 0.62919307}
confusion matrix:
     0    1
0  522  134
1  275  347
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.4513889, 'precision': 0.44686908, 'recall': 0.4513889, 'specificity': 0.4513889, 'f1': 0.43946785, 'auroc': 0.44425154, 'binary_precision': 0.43137255, 'binary_recall': 0.30555555, 'binary_specificity': 0.5972222, 'binary_f1_score': 0.3577236}
confusion matrix:
     0   1
0  129  87
1  150  66
better model found
persisted
after epoch: 5,now: 2024-07-20 14:32:24.149513,epoch time: 0:01:26.197629,used: 0:07:19.866088,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_14_25_04_seed_2_22504803
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.8098822, 'precision': 0.81368744, 'recall': 0.81030995, 'specificity': 0.81030995, 'f1': 0.8094413, 'auroc': 0.8853245, 'binary_precision': 0.85025567, 'binary_recall': 0.7558442, 'binary_specificity': 0.8647757, 'binary_f1_score': 0.800275}
confusion matrix:
      0     1
0  1311   205
1   376  1164
---- Validation: 
scalar performance:
{'acc': 0.67840374, 'precision': 0.6900308, 'recall': 0.67473876, 'specificity': 0.67473876, 'f1': 0.6704125, 'auroc': 0.7294452, 'binary_precision': 0.7308534, 'binary_recall': 0.53697747, 'binary_specificity': 0.8125, 'binary_f1_score': 0.61909175}
confusion matrix:
     0    1
0  533  123
1  288  334
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.4560185, 'precision': 0.44998902, 'recall': 0.4560185, 'specificity': 0.4560185, 'f1': 0.4391129, 'auroc': 0.47721618, 'binary_precision': 0.4326241, 'binary_recall': 0.2824074, 'binary_specificity': 0.6296296, 'binary_f1_score': 0.3417367}
confusion matrix:
     0   1
0  136  80
1  155  61
early stop counter: 1
val acc:0.6784037351608276, best validation acc: 0.6799687147140503, corresponding to test acc:                         0.4513888955116272 / 0.46296295523643494
after epoch: 6,now: 2024-07-20 14:33:51.325403,epoch time: 0:01:27.175890,used: 0:08:47.041978,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_14_25_04_seed_2_22504803
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.8242801, 'precision': 0.82883793, 'recall': 0.8247396, 'specificity': 0.8247396, 'f1': 0.82380307, 'auroc': 0.9032489, 'binary_precision': 0.8695652, 'binary_recall': 0.76623374, 'binary_specificity': 0.8832454, 'binary_f1_score': 0.81463575}
confusion matrix:
      0     1
0  1339   177
1   360  1180
---- Validation: 
scalar performance:
{'acc': 0.68075114, 'precision': 0.69712865, 'recall': 0.676567, 'specificity': 0.676567, 'f1': 0.6706327, 'auroc': 0.7329155, 'binary_precision': 0.7476852, 'binary_recall': 0.5192926, 'binary_specificity': 0.83384144, 'binary_f1_score': 0.61290324}
confusion matrix:
     0    1
0  547  109
1  299  323
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.47685185, 'precision': 0.47295403, 'recall': 0.47685188, 'specificity': 0.47685188, 'f1': 0.45729852, 'auroc': 0.4962706, 'binary_precision': 0.46268657, 'binary_recall': 0.28703704, 'binary_specificity': 0.6666667, 'binary_f1_score': 0.35428572}
confusion matrix:
     0   1
0  144  72
1  154  62
new oracle model saved
better model found
persisted
after epoch: 7,now: 2024-07-20 14:35:18.277857,epoch time: 0:01:26.952454,used: 0:10:13.994432,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_14_25_04_seed_2_22504803
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.83802354, 'precision': 0.8416552, 'recall': 0.8384273, 'specificity': 0.8384273, 'f1': 0.8376974, 'auroc': 0.91343176, 'binary_precision': 0.8788977, 'binary_recall': 0.787013, 'binary_specificity': 0.8898417, 'binary_f1_score': 0.8304213}
confusion matrix:
      0     1
0  1349   167
1   328  1212
---- Validation: 
scalar performance:
{'acc': 0.6682316, 'precision': 0.69075966, 'recall': 0.6632887, 'specificity': 0.6632887, 'f1': 0.6539072, 'auroc': 0.7350992, 'binary_precision': 0.75, 'binary_recall': 0.47749197, 'binary_specificity': 0.8490854, 'binary_f1_score': 0.58349705}
confusion matrix:
     0    1
0  557   99
1  325  297
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.48842594, 'precision': 0.4857921, 'recall': 0.4884259, 'specificity': 0.4884259, 'f1': 0.46356505, 'auroc': 0.5163109, 'binary_precision': 0.4796748, 'binary_recall': 0.27314815, 'binary_specificity': 0.7037037, 'binary_f1_score': 0.34808257}
confusion matrix:
     0   1
0  152  64
1  157  59
new oracle model saved
early stop counter: 1
val acc:0.6682316064834595, best validation acc: 0.6807511448860168, corresponding to test acc:                         0.47685185074806213 / 0.48842594027519226
after epoch: 8,now: 2024-07-20 14:36:46.835244,epoch time: 0:01:28.557387,used: 0:11:42.551819,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_14_25_04_seed_2_22504803
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.85503924, 'precision': 0.857359, 'recall': 0.8553567, 'specificity': 0.8553567, 'f1': 0.85487443, 'auroc': 0.9260293, 'binary_precision': 0.88818115, 'binary_recall': 0.8149351, 'binary_specificity': 0.89577836, 'binary_f1_score': 0.8499831}
confusion matrix:
      0     1
0  1358   158
1   285  1255
---- Validation: 
scalar performance:
{'acc': 0.6737089, 'precision': 0.698436, 'recall': 0.6686657, 'specificity': 0.6686657, 'f1': 0.6590494, 'auroc': 0.7393391, 'binary_precision': 0.7621483, 'binary_recall': 0.4790997, 'binary_specificity': 0.8582317, 'binary_f1_score': 0.5883514}
confusion matrix:
     0    1
0  563   93
1  324  298
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.49074075, 'precision': 0.48857749, 'recall': 0.49074072, 'specificity': 0.49074072, 'f1': 0.46543074, 'auroc': 0.53187156, 'binary_precision': 0.48360655, 'binary_recall': 0.27314815, 'binary_specificity': 0.7083333, 'binary_f1_score': 0.34911242}
confusion matrix:
     0   1
0  153  63
1  157  59
new oracle model saved
early stop counter: 2
val acc:0.6737089157104492, best validation acc: 0.6807511448860168, corresponding to test acc:                         0.47685185074806213 / 0.49074074625968933
after epoch: 9,now: 2024-07-20 14:38:13.710329,epoch time: 0:01:26.875085,used: 0:13:09.426904,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_14_25_04_seed_2_22504803
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.87729055, 'precision': 0.8795018, 'recall': 0.877594, 'specificity': 0.877594, 'f1': 0.87716687, 'auroc': 0.93502593, 'binary_precision': 0.91050035, 'binary_recall': 0.83896106, 'binary_specificity': 0.9162269, 'binary_f1_score': 0.873268}
confusion matrix:
      0     1
0  1389   127
1   248  1292
---- Validation: 
scalar performance:
{'acc': 0.6744914, 'precision': 0.70178103, 'recall': 0.6692612, 'specificity': 0.6692612, 'f1': 0.65880805, 'auroc': 0.74197793, 'binary_precision': 0.76963353, 'binary_recall': 0.4726688, 'binary_specificity': 0.86585367, 'binary_f1_score': 0.58565736}
confusion matrix:
     0    1
0  568   88
1  328  294
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5, 'precision': 0.5, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.47169125, 'auroc': 0.55004716, 'binary_precision': 0.5, 'binary_recall': 0.2685185, 'binary_specificity': 0.7314815, 'binary_f1_score': 0.34939757}
confusion matrix:
     0   1
0  158  58
1  158  58
new oracle model saved
early stop counter: 3
val acc:0.6744914054870605, best validation acc: 0.6807511448860168, corresponding to test acc:                         0.47685185074806213 / 0.5
after epoch: 10,now: 2024-07-20 14:39:42.042202,epoch time: 0:01:28.331873,used: 0:14:37.758777,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_14_25_04_seed_2_22504803
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.88056284, 'precision': 0.8844992, 'recall': 0.88096404, 'specificity': 0.88096404, 'f1': 0.88032925, 'auroc': 0.94214904, 'binary_precision': 0.92541635, 'binary_recall': 0.8298701, 'binary_specificity': 0.93205804, 'binary_f1_score': 0.8750428}
confusion matrix:
      0     1
0  1413   103
1   262  1278
---- Validation: 
scalar performance:
{'acc': 0.6690141, 'precision': 0.70593894, 'recall': 0.66305095, 'specificity': 0.66305095, 'f1': 0.6484635, 'auroc': 0.74322844, 'binary_precision': 0.7867435, 'binary_recall': 0.43890676, 'binary_specificity': 0.8871951, 'binary_f1_score': 0.5634675}
confusion matrix:
     0    1
0  582   74
1  349  273
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5115741, 'precision': 0.5157274, 'recall': 0.5115741, 'specificity': 0.5115741, 'f1': 0.47704858, 'auroc': 0.5626286, 'binary_precision': 0.52380955, 'binary_recall': 0.25462964, 'binary_specificity': 0.7685185, 'binary_f1_score': 0.34267914}
confusion matrix:
     0   1
0  166  50
1  161  55
new oracle model saved
early stop counter: 4
val acc:0.6690140962600708, best validation acc: 0.6807511448860168, corresponding to test acc:                         0.47685185074806213 / 0.5115740895271301
after epoch: 11,now: 2024-07-20 14:41:08.599433,epoch time: 0:01:26.557231,used: 0:16:04.316008,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_14_25_04_seed_2_22504803
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.8746728, 'precision': 0.8776077, 'recall': 0.8750223, 'specificity': 0.8750223, 'f1': 0.874495, 'auroc': 0.940608, 'binary_precision': 0.91291934, 'binary_recall': 0.8305195, 'binary_specificity': 0.9195251, 'binary_f1_score': 0.8697722}
confusion matrix:
      0     1
0  1394   122
1   261  1279
---- Validation: 
scalar performance:
{'acc': 0.657277, 'precision': 0.70142496, 'recall': 0.6507014, 'specificity': 0.6507014, 'f1': 0.6315015, 'auroc': 0.7439784, 'binary_precision': 0.7893082, 'binary_recall': 0.40353698, 'binary_specificity': 0.89786583, 'binary_f1_score': 0.5340426}
confusion matrix:
     0    1
0  589   67
1  371  251
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5185185, 'precision': 0.52678573, 'recall': 0.5185185, 'specificity': 0.5185185, 'f1': 0.47826087, 'auroc': 0.57499576, 'binary_precision': 0.5416667, 'binary_recall': 0.24074075, 'binary_specificity': 0.7962963, 'binary_f1_score': 0.33333334}
confusion matrix:
     0   1
0  172  44
1  164  52
new oracle model saved
early stop counter: 5
val acc:0.65727698802948, best validation acc: 0.6807511448860168, corresponding to test acc:                         0.47685185074806213 / 0.5185185074806213
after epoch: 12,now: 2024-07-20 14:42:35.020341,epoch time: 0:01:26.420908,used: 0:17:30.736916,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_14_25_04_seed_2_22504803
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.88350785, 'precision': 0.88654935, 'recall': 0.88386047, 'specificity': 0.88386047, 'f1': 0.88333976, 'auroc': 0.9460025, 'binary_precision': 0.92285717, 'binary_recall': 0.83896106, 'binary_specificity': 0.9287599, 'binary_f1_score': 0.8789116}
confusion matrix:
      0     1
0  1408   108
1   248  1292
---- Validation: 
scalar performance:
{'acc': 0.65023476, 'precision': 0.6988289, 'recall': 0.64330006, 'specificity': 0.64330006, 'f1': 0.62099016, 'auroc': 0.7449832, 'binary_precision': 0.7906977, 'binary_recall': 0.38263667, 'binary_specificity': 0.9039634, 'binary_f1_score': 0.51570964}
confusion matrix:
     0    1
0  593   63
1  384  238
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5185185, 'precision': 0.5276215, 'recall': 0.5185185, 'specificity': 0.5185185, 'f1': 0.4752873, 'auroc': 0.5843407, 'binary_precision': 0.54347825, 'binary_recall': 0.23148148, 'binary_specificity': 0.8055556, 'binary_f1_score': 0.32467532}
confusion matrix:
     0   1
0  174  42
1  166  50
early stop counter: 6
val acc:0.6502347588539124, best validation acc: 0.6807511448860168, corresponding to test acc:                         0.47685185074806213 / 0.5185185074806213
after epoch: 13,now: 2024-07-20 14:44:03.703243,epoch time: 0:01:28.682902,used: 0:18:59.419818,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_14_25_04_seed_2_22504803
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.8802356, 'precision': 0.88372016, 'recall': 0.8806137, 'specificity': 0.8806137, 'f1': 0.8800317, 'auroc': 0.94528234, 'binary_precision': 0.9223022, 'binary_recall': 0.83246756, 'binary_specificity': 0.9287599, 'binary_f1_score': 0.8750853}
confusion matrix:
      0     1
0  1408   108
1   258  1282
---- Validation: 
scalar performance:
{'acc': 0.65023476, 'precision': 0.7042152, 'recall': 0.6430501, 'specificity': 0.6430501, 'f1': 0.6187989, 'auroc': 0.7472649, 'binary_precision': 0.8027682, 'binary_recall': 0.37299034, 'binary_specificity': 0.9131098, 'binary_f1_score': 0.5093304}
confusion matrix:
     0    1
0  599   57
1  390  232
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5185185, 'precision': 0.52955663, 'recall': 0.5185185, 'specificity': 0.5185185, 'f1': 0.46893618, 'auroc': 0.5937071, 'binary_precision': 0.54761904, 'binary_recall': 0.21296297, 'binary_specificity': 0.8240741, 'binary_f1_score': 0.30666667}
confusion matrix:
     0   1
0  178  38
1  170  46
early stop counter: 7
val acc:0.6502347588539124, best validation acc: 0.6807511448860168, corresponding to test acc:                         0.47685185074806213 / 0.5185185074806213
after epoch: 14,now: 2024-07-20 14:45:29.323923,epoch time: 0:01:25.620680,used: 0:20:25.040498,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_14_25_04_seed_2_22504803
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.8972513, 'precision': 0.90108013, 'recall': 0.89764076, 'specificity': 0.89764076, 'f1': 0.89706504, 'auroc': 0.95193994, 'binary_precision': 0.94227993, 'binary_recall': 0.84805197, 'binary_specificity': 0.94722956, 'binary_f1_score': 0.8926863}
confusion matrix:
      0     1
0  1436    80
1   234  1306
---- Validation: 
scalar performance:
{'acc': 0.64162755, 'precision': 0.70304835, 'recall': 0.6339576, 'specificity': 0.6339576, 'f1': 0.6048269, 'auroc': 0.7470958, 'binary_precision': 0.8082707, 'binary_recall': 0.34565917, 'binary_specificity': 0.9222561, 'binary_f1_score': 0.48423424}
confusion matrix:
     0    1
0  605   51
1  407  215
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5115741, 'precision': 0.5197549, 'recall': 0.5115741, 'specificity': 0.5115741, 'f1': 0.4551682, 'auroc': 0.5941144, 'binary_precision': 0.53246754, 'binary_recall': 0.18981482, 'binary_specificity': 0.8333333, 'binary_f1_score': 0.2798635}
confusion matrix:
     0   1
0  180  36
1  175  41
early stop counter: 8
val acc:0.6416275501251221, best validation acc: 0.6807511448860168, corresponding to test acc:                         0.47685185074806213 / 0.5185185074806213
after epoch: 15,now: 2024-07-20 14:46:58.971486,epoch time: 0:01:29.647563,used: 0:21:54.688061,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_14_25_04_seed_2_22504803
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.8985602, 'precision': 0.9024004, 'recall': 0.89894974, 'specificity': 0.89894974, 'f1': 0.89837635, 'auroc': 0.9489125, 'binary_precision': 0.94372296, 'binary_recall': 0.84935063, 'binary_specificity': 0.9485488, 'binary_f1_score': 0.8940533}
confusion matrix:
      0     1
0  1438    78
1   232  1308
---- Validation: 
scalar performance:
{'acc': 0.63771516, 'precision': 0.7019268, 'recall': 0.62985504, 'specificity': 0.62985504, 'f1': 0.5985884, 'auroc': 0.7486079, 'binary_precision': 0.8093385, 'binary_recall': 0.33440515, 'binary_specificity': 0.9253049, 'binary_f1_score': 0.47326508}
confusion matrix:
     0    1
0  607   49
1  414  208
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5092593, 'precision': 0.5159669, 'recall': 0.5092592, 'specificity': 0.5092592, 'f1': 0.4516716, 'auroc': 0.59990144, 'binary_precision': 0.5263158, 'binary_recall': 0.18518518, 'binary_specificity': 0.8333333, 'binary_f1_score': 0.2739726}
confusion matrix:
     0   1
0  180  36
1  176  40
early stop counter: 9
val acc:0.6377151608467102, best validation acc: 0.6807511448860168, corresponding to test acc:                         0.47685185074806213 / 0.5185185074806213
after epoch: 16,now: 2024-07-20 14:48:26.714601,epoch time: 0:01:27.743115,used: 0:23:22.431176,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_14_25_04_seed_2_22504803
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.8929974, 'precision': 0.89615244, 'recall': 0.89335316, 'specificity': 0.89335316, 'f1': 0.8928403, 'auroc': 0.9522239, 'binary_precision': 0.93352395, 'binary_recall': 0.84805197, 'binary_specificity': 0.93865436, 'binary_f1_score': 0.8887377}
confusion matrix:
      0     1
0  1423    93
1   234  1306
---- Validation: 
scalar performance:
{'acc': 0.63536775, 'precision': 0.69666016, 'recall': 0.6275684, 'specificity': 0.6275684, 'f1': 0.5966401, 'auroc': 0.75026715, 'binary_precision': 0.8, 'binary_recall': 0.33440515, 'binary_specificity': 0.9207317, 'binary_f1_score': 0.47165534}
confusion matrix:
     0    1
0  604   52
1  414  208
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.525463, 'precision': 0.54101217, 'recall': 0.525463, 'specificity': 0.525463, 'f1': 0.4757747, 'auroc': 0.61231136, 'binary_precision': 0.56626505, 'binary_recall': 0.2175926, 'binary_specificity': 0.8333333, 'binary_f1_score': 0.31438127}
confusion matrix:
     0   1
0  180  36
1  169  47
new oracle model saved
early stop counter: 10
val acc:0.635367751121521, best validation acc: 0.6807511448860168, corresponding to test acc:                         0.47685185074806213 / 0.5254629850387573
after epoch: 17,now: 2024-07-20 14:49:55.097501,epoch time: 0:01:28.382900,used: 0:24:50.814076,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_14_25_04_seed_2_22504803
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.8985602, 'precision': 0.90189874, 'recall': 0.898924, 'specificity': 0.898924, 'f1': 0.8984035, 'auroc': 0.95606685, 'binary_precision': 0.9405444, 'binary_recall': 0.8525974, 'binary_specificity': 0.94525063, 'binary_f1_score': 0.8944142}
confusion matrix:
      0     1
0  1433    83
1   227  1313
---- Validation: 
scalar performance:
{'acc': 0.63693273, 'precision': 0.6990744, 'recall': 0.6291345, 'specificity': 0.6291345, 'f1': 0.59837127, 'auroc': 0.753512, 'binary_precision': 0.8038462, 'binary_recall': 0.33601287, 'binary_specificity': 0.9222561, 'binary_f1_score': 0.47392288}
confusion matrix:
     0    1
0  605   51
1  413  209
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5277778, 'precision': 0.544335, 'recall': 0.5277778, 'specificity': 0.5277778, 'f1': 0.47914892, 'auroc': 0.62022036, 'binary_precision': 0.5714286, 'binary_recall': 0.22222222, 'binary_specificity': 0.8333333, 'binary_f1_score': 0.32000002}
confusion matrix:
     0   1
0  180  36
1  168  48
new oracle model saved
early stop counter: 11
val acc:0.6369327306747437, best validation acc: 0.6807511448860168, corresponding to test acc:                         0.47685185074806213 / 0.5277777910232544
after epoch: 18,now: 2024-07-20 14:51:21.218262,epoch time: 0:01:26.120761,used: 0:26:16.934837,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_14_25_04_seed_2_22504803
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.901178, 'precision': 0.9059243, 'recall': 0.9016088, 'specificity': 0.9016088, 'f1': 0.900952, 'auroc': 0.95564497, 'binary_precision': 0.95182484, 'binary_recall': 0.84675324, 'binary_specificity': 0.95646435, 'binary_f1_score': 0.89621997}
confusion matrix:
      0     1
0  1450    66
1   236  1304
---- Validation: 
scalar performance:
{'acc': 0.63223785, 'precision': 0.69723344, 'recall': 0.624228, 'specificity': 0.624228, 'f1': 0.59095585, 'auroc': 0.7560388, 'binary_precision': 0.804, 'binary_recall': 0.3231511, 'binary_specificity': 0.9253049, 'binary_f1_score': 0.46100914}
confusion matrix:
     0    1
0  607   49
1  421  201
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5300926, 'precision': 0.550346, 'recall': 0.5300926, 'specificity': 0.5300926, 'f1': 0.47754908, 'auroc': 0.62808645, 'binary_precision': 0.5822785, 'binary_recall': 0.21296297, 'binary_specificity': 0.8472222, 'binary_f1_score': 0.3118644}
confusion matrix:
     0   1
0  183  33
1  170  46
new oracle model saved
early stop counter: 12
val acc:0.6322378516197205, best validation acc: 0.6807511448860168, corresponding to test acc:                         0.47685185074806213 / 0.5300925970077515
after epoch: 19,now: 2024-07-20 14:52:47.817865,epoch time: 0:01:26.599603,used: 0:27:43.534440,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_14_25_04_seed_2_22504803
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.8959424, 'precision': 0.9019834, 'recall': 0.8964294, 'specificity': 0.8964294, 'f1': 0.89562696, 'auroc': 0.95290446, 'binary_precision': 0.9532641, 'binary_recall': 0.83441556, 'binary_specificity': 0.9584433, 'binary_f1_score': 0.8898892}
confusion matrix:
      0     1
0  1453    63
1   255  1285
---- Validation: 
scalar performance:
{'acc': 0.6189358, 'precision': 0.68528044, 'recall': 0.61056244, 'specificity': 0.61056244, 'f1': 0.5720536, 'auroc': 0.7573947, 'binary_precision': 0.78969955, 'binary_recall': 0.29581994, 'binary_specificity': 0.9253049, 'binary_f1_score': 0.43040934}
confusion matrix:
     0    1
0  607   49
1  438  184
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.525463, 'precision': 0.5474308, 'recall': 0.5254629, 'specificity': 0.5254629, 'f1': 0.4633215, 'auroc': 0.6361454, 'binary_precision': 0.5797101, 'binary_recall': 0.18518518, 'binary_specificity': 0.8657407, 'binary_f1_score': 0.28070176}
confusion matrix:
     0   1
0  187  29
1  176  40
early stop counter: 13
val acc:0.6189358234405518, best validation acc: 0.6807511448860168, corresponding to test acc:                         0.47685185074806213 / 0.5300925970077515
after epoch: 20,now: 2024-07-20 14:54:15.548176,epoch time: 0:01:27.730311,used: 0:29:11.264751,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_14_25_04_seed_2_22504803
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.901178, 'precision': 0.905041, 'recall': 0.9015677, 'specificity': 0.9015677, 'f1': 0.9009989, 'auroc': 0.95886385, 'binary_precision': 0.94660896, 'binary_recall': 0.851948, 'binary_specificity': 0.9511873, 'binary_f1_score': 0.8967874}
confusion matrix:
      0     1
0  1442    74
1   228  1312
---- Validation: 
scalar performance:
{'acc': 0.6228482, 'precision': 0.69005173, 'recall': 0.61454004, 'specificity': 0.61454004, 'f1': 0.57718253, 'auroc': 0.7594061, 'binary_precision': 0.7966102, 'binary_recall': 0.3022508, 'binary_specificity': 0.9268293, 'binary_f1_score': 0.43822843}
confusion matrix:
     0    1
0  608   48
1  434  188
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5462963, 'precision': 0.57526135, 'recall': 0.5462963, 'specificity': 0.5462963, 'f1': 0.49799606, 'auroc': 0.6416967, 'binary_precision': 0.6219512, 'binary_recall': 0.2361111, 'binary_specificity': 0.8564815, 'binary_f1_score': 0.34228188}
confusion matrix:
     0   1
0  185  31
1  165  51
new oracle model saved
early stop counter: 14
val acc:0.6228482127189636, best validation acc: 0.6807511448860168, corresponding to test acc:                         0.47685185074806213 / 0.5462962985038757
after epoch: 21,now: 2024-07-20 14:55:41.297914,epoch time: 0:01:25.749738,used: 0:30:37.014489,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_14_25_04_seed_2_22504803
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9090314, 'precision': 0.91264987, 'recall': 0.9094062, 'specificity': 0.9094062, 'f1': 0.9088814, 'auroc': 0.95985293, 'binary_precision': 0.9533046, 'binary_recall': 0.8616883, 'binary_specificity': 0.957124, 'binary_f1_score': 0.90518415}
confusion matrix:
      0     1
0  1451    65
1   213  1327
---- Validation: 
scalar performance:
{'acc': 0.62128323, 'precision': 0.68862367, 'recall': 0.6129323, 'specificity': 0.6129323, 'f1': 0.57493675, 'auroc': 0.7619623, 'binary_precision': 0.7948718, 'binary_recall': 0.29903537, 'binary_specificity': 0.9268293, 'binary_f1_score': 0.43457946}
confusion matrix:
     0    1
0  608   48
1  436  186
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5509259, 'precision': 0.58278745, 'recall': 0.5509259, 'specificity': 0.5509259, 'f1': 0.5031185, 'auroc': 0.64949846, 'binary_precision': 0.63414633, 'binary_recall': 0.24074075, 'binary_specificity': 0.8611111, 'binary_f1_score': 0.34899327}
confusion matrix:
     0   1
0  186  30
1  164  52
new oracle model saved
early stop counter: 15
val acc:0.621283233165741, best validation acc: 0.6807511448860168, corresponding to test acc:                         0.47685185074806213 / 0.5509259104728699
after epoch: 22,now: 2024-07-20 14:57:11.779093,epoch time: 0:01:30.481179,used: 0:32:07.495668,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_14_25_04_seed_2_22504803
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.9060864, 'precision': 0.9091457, 'recall': 0.9064327, 'specificity': 0.9064327, 'f1': 0.9059578, 'auroc': 0.96002555, 'binary_precision': 0.9465431, 'binary_recall': 0.86233765, 'binary_specificity': 0.9505277, 'binary_f1_score': 0.9024804}
confusion matrix:
      0     1
0  1441    75
1   212  1328
---- Validation: 
scalar performance:
{'acc': 0.6228482, 'precision': 0.68888575, 'recall': 0.6145817, 'specificity': 0.6145817, 'f1': 0.57766837, 'auroc': 0.76256275, 'binary_precision': 0.7941176, 'binary_recall': 0.30385852, 'binary_specificity': 0.9253049, 'binary_f1_score': 0.43953484}
confusion matrix:
     0    1
0  607   49
1  433  189
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5509259, 'precision': 0.58278745, 'recall': 0.5509259, 'specificity': 0.5509259, 'f1': 0.5031185, 'auroc': 0.6571288, 'binary_precision': 0.63414633, 'binary_recall': 0.24074075, 'binary_specificity': 0.8611111, 'binary_f1_score': 0.34899327}
confusion matrix:
     0   1
0  186  30
1  164  52
early stop counter: 16
val acc:0.6228482127189636, best validation acc: 0.6807511448860168, corresponding to test acc:                         0.47685185074806213 / 0.5509259104728699
after epoch: 23,now: 2024-07-20 14:58:39.066759,epoch time: 0:01:27.287666,used: 0:33:34.783334,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_14_25_04_seed_2_22504803
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.91361254, 'precision': 0.9168668, 'recall': 0.913967, 'specificity': 0.913967, 'f1': 0.913488, 'auroc': 0.9638363, 'binary_precision': 0.9557143, 'binary_recall': 0.86883116, 'binary_specificity': 0.9591029, 'binary_f1_score': 0.9102041}
confusion matrix:
      0     1
0  1454    62
1   202  1338
---- Validation: 
scalar performance:
{'acc': 0.63380283, 'precision': 0.6942459, 'recall': 0.6260024, 'specificity': 0.6260024, 'f1': 0.59490895, 'auroc': 0.7647562, 'binary_precision': 0.79615384, 'binary_recall': 0.33279744, 'binary_specificity': 0.91920733, 'binary_f1_score': 0.46938777}
confusion matrix:
     0    1
0  603   53
1  415  207
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5601852, 'precision': 0.59122807, 'recall': 0.5601852, 'specificity': 0.5601852, 'f1': 0.5192916, 'auroc': 0.6591435, 'binary_precision': 0.64444447, 'binary_recall': 0.2685185, 'binary_specificity': 0.8518519, 'binary_f1_score': 0.37908494}
confusion matrix:
     0   1
0  184  32
1  158  58
new oracle model saved
early stop counter: 17
val acc:0.6338028311729431, best validation acc: 0.6807511448860168, corresponding to test acc:                         0.47685185074806213 / 0.5601851940155029
after epoch: 24,now: 2024-07-20 15:00:03.823314,epoch time: 0:01:24.756555,used: 0:34:59.539889,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_14_25_04_seed_2_22504803
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.90870416, 'precision': 0.9129035, 'recall': 0.9091072, 'specificity': 0.9091072, 'f1': 0.9085257, 'auroc': 0.96391904, 'binary_precision': 0.9565532, 'binary_recall': 0.8577922, 'binary_specificity': 0.96042216, 'binary_f1_score': 0.9044848}
confusion matrix:
      0     1
0  1456    60
1   219  1321
---- Validation: 
scalar performance:
{'acc': 0.6220657, 'precision': 0.6905292, 'recall': 0.61369455, 'specificity': 0.61369455, 'f1': 0.57556856, 'auroc': 0.7661507, 'binary_precision': 0.7982833, 'binary_recall': 0.29903537, 'binary_specificity': 0.92835367, 'binary_f1_score': 0.4350877}
confusion matrix:
     0    1
0  609   47
1  436  186
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5625, 'precision': 0.6006663, 'recall': 0.5625, 'specificity': 0.5625, 'f1': 0.51668984, 'auroc': 0.6666667, 'binary_precision': 0.6626506, 'binary_recall': 0.25462964, 'binary_specificity': 0.8703704, 'binary_f1_score': 0.367893}
confusion matrix:
     0   1
0  188  28
1  161  55
new oracle model saved
early stop counter: 18
val acc:0.6220657229423523, best validation acc: 0.6807511448860168, corresponding to test acc:                         0.47685185074806213 / 0.5625
after epoch: 25,now: 2024-07-20 15:01:31.699704,epoch time: 0:01:27.876390,used: 0:36:27.416279,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_14_25_04_seed_2_22504803
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.90674084, 'precision': 0.9118464, 'recall': 0.90718484, 'specificity': 0.90718484, 'f1': 0.9065126, 'auroc': 0.96022177, 'binary_precision': 0.95970696, 'binary_recall': 0.85064936, 'binary_specificity': 0.9637203, 'binary_f1_score': 0.90189326}
confusion matrix:
      0     1
0  1461    55
1   230  1310
---- Validation: 
scalar performance:
{'acc': 0.62441313, 'precision': 0.70022786, 'recall': 0.6158561, 'specificity': 0.6158561, 'f1': 0.5759612, 'auroc': 0.7670845, 'binary_precision': 0.81696427, 'binary_recall': 0.29421222, 'binary_specificity': 0.9375, 'binary_f1_score': 0.4326241}
confusion matrix:
     0    1
0  615   41
1  439  183
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5625, 'precision': 0.6025641, 'recall': 0.5625, 'specificity': 0.5625, 'f1': 0.5151515, 'auroc': 0.6713177, 'binary_precision': 0.6666667, 'binary_recall': 0.25, 'binary_specificity': 0.875, 'binary_f1_score': 0.36363637}
confusion matrix:
     0   1
0  189  27
1  162  54
early stop counter: 19
val acc:0.6244131326675415, best validation acc: 0.6807511448860168, corresponding to test acc:                         0.47685185074806213 / 0.5625
after epoch: 26,now: 2024-07-20 15:02:56.976713,epoch time: 0:01:25.277009,used: 0:37:52.693288,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_14_25_04_seed_2_22504803
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.911322, 'precision': 0.91660386, 'recall': 0.9117714, 'specificity': 0.9117714, 'f1': 0.9110992, 'auroc': 0.9676391, 'binary_precision': 0.9655172, 'binary_recall': 0.8545455, 'binary_specificity': 0.96899736, 'binary_f1_score': 0.90664834}
confusion matrix:
      0     1
0  1469    47
1   224  1316
---- Validation: 
scalar performance:
{'acc': 0.6228482, 'precision': 0.707397, 'recall': 0.6139984, 'specificity': 0.6139984, 'f1': 0.5705453, 'auroc': 0.7682731, 'binary_precision': 0.8333333, 'binary_recall': 0.2813505, 'binary_specificity': 0.94664633, 'binary_f1_score': 0.42067307}
confusion matrix:
     0    1
0  621   35
1  447  175
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5532407, 'precision': 0.59478384, 'recall': 0.5532408, 'specificity': 0.5532408, 'f1': 0.4982639, 'auroc': 0.6756687, 'binary_precision': 0.65753424, 'binary_recall': 0.22222222, 'binary_specificity': 0.8842593, 'binary_f1_score': 0.33217993}
confusion matrix:
     0   1
0  191  25
1  168  48
early stop counter: 20
val acc:0.6228482127189636, best validation acc: 0.6807511448860168, corresponding to test acc:                         0.47685185074806213 / 0.5625
after epoch: 27,now: 2024-07-20 15:04:25.755527,epoch time: 0:01:28.778814,used: 0:39:21.472102,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_14_25_04_seed_2_22504803
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.91099477, 'precision': 0.9156122, 'recall': 0.9114159, 'specificity': 0.9114159, 'f1': 0.91080225, 'auroc': 0.9662415, 'binary_precision': 0.9614265, 'binary_recall': 0.8577922, 'binary_specificity': 0.96503955, 'binary_f1_score': 0.9066576}
confusion matrix:
      0     1
0  1463    53
1   219  1321
---- Validation: 
scalar performance:
{'acc': 0.6189358, 'precision': 0.7071398, 'recall': 0.60989577, 'specificity': 0.60989577, 'f1': 0.5636234, 'auroc': 0.76796424, 'binary_precision': 0.8358209, 'binary_recall': 0.27009645, 'binary_specificity': 0.9496951, 'binary_f1_score': 0.40826246}
confusion matrix:
     0    1
0  623   33
1  454  168
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5601852, 'precision': 0.60833335, 'recall': 0.5601852, 'specificity': 0.5601852, 'f1': 0.5052084, 'auroc': 0.68079126, 'binary_precision': 0.6805556, 'binary_recall': 0.22685185, 'binary_specificity': 0.8935185, 'binary_f1_score': 0.3402778}
confusion matrix:
     0   1
0  193  23
1  167  49
early stop counter: 21
val acc:0.6189358234405518, best validation acc: 0.6807511448860168, corresponding to test acc:                         0.47685185074806213 / 0.5625
after epoch: 28,now: 2024-07-20 15:05:52.098278,epoch time: 0:01:26.342751,used: 0:40:47.814853,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_14_25_04_seed_2_22504803
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9103403, 'precision': 0.9136687, 'recall': 0.9106997, 'specificity': 0.9106997, 'f1': 0.91020644, 'auroc': 0.96439755, 'binary_precision': 0.9527897, 'binary_recall': 0.86493504, 'binary_specificity': 0.95646435, 'binary_f1_score': 0.9067393}
confusion matrix:
      0     1
0  1450    66
1   208  1332
---- Validation: 
scalar performance:
{'acc': 0.6259781, 'precision': 0.7085687, 'recall': 0.6172555, 'specificity': 0.6172555, 'f1': 0.57568187, 'auroc': 0.7718978, 'binary_precision': 0.8333333, 'binary_recall': 0.28938907, 'binary_specificity': 0.94512194, 'binary_f1_score': 0.42959428}
confusion matrix:
     0    1
0  620   36
1  442  180
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5694444, 'precision': 0.61289203, 'recall': 0.5694444, 'specificity': 0.5694444, 'f1': 0.5236085, 'auroc': 0.68679273, 'binary_precision': 0.68292683, 'binary_recall': 0.25925925, 'binary_specificity': 0.8796296, 'binary_f1_score': 0.3758389}
confusion matrix:
     0   1
0  190  26
1  160  56
new oracle model saved
early stop counter: 22
val acc:0.6259781122207642, best validation acc: 0.6807511448860168, corresponding to test acc:                         0.47685185074806213 / 0.5694444179534912
after epoch: 29,now: 2024-07-20 15:07:22.494291,epoch time: 0:01:30.396013,used: 0:42:18.210866,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_14_25_04_seed_2_22504803
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.91590315, 'precision': 0.918229, 'recall': 0.91620374, 'specificity': 0.91620374, 'f1': 0.9158218, 'auroc': 0.9673153, 'binary_precision': 0.95144266, 'binary_recall': 0.87792206, 'binary_specificity': 0.9544855, 'binary_f1_score': 0.91320497}
confusion matrix:
      0     1
0  1447    69
1   188  1352
---- Validation: 
scalar performance:
{'acc': 0.6220657, 'precision': 0.7052262, 'recall': 0.6132362, 'specificity': 0.6132362, 'f1': 0.5699215, 'auroc': 0.77162087, 'binary_precision': 0.8293839, 'binary_recall': 0.2813505, 'binary_specificity': 0.94512194, 'binary_f1_score': 0.42016804}
confusion matrix:
     0    1
0  620   36
1  447  175
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5625, 'precision': 0.6045649, 'recall': 0.5625, 'specificity': 0.5625, 'f1': 0.5135802, 'auroc': 0.6861497, 'binary_precision': 0.6708861, 'binary_recall': 0.24537037, 'binary_specificity': 0.8796296, 'binary_f1_score': 0.35932204}
confusion matrix:
     0   1
0  190  26
1  163  53
early stop counter: 23
val acc:0.6220657229423523, best validation acc: 0.6807511448860168, corresponding to test acc:                         0.47685185074806213 / 0.5694444179534912
after epoch: 30,now: 2024-07-20 15:08:47.236071,epoch time: 0:01:24.741780,used: 0:43:42.952646,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_14_25_04_seed_2_22504803
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 0:43:42.952646 at 2024-07-20 15:08:47.236071
persisted model performance metric: 

scalar performance:
{'acc': 0.47685185, 'precision': 0.47295403, 'recall': 0.47685188, 'specificity': 0.47685188, 'f1': 0.45729852, 'auroc': 0.4962706, 'binary_precision': 0.46268657, 'binary_recall': 0.28703704, 'binary_specificity': 0.6666667, 'binary_f1_score': 0.35428572}
confusion matrix:
     0   1
0  144  72
1  154  62
oracle model performance metric: 

scalar performance:
{'acc': 0.5694444, 'precision': 0.61289203, 'recall': 0.5694444, 'specificity': 0.5694444, 'f1': 0.5236085, 'auroc': 0.68679273, 'binary_precision': 0.68292683, 'binary_recall': 0.25925925, 'binary_specificity': 0.8796296, 'binary_f1_score': 0.3758389}
confusion matrix:
     0   1
0  190  26
1  160  56
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_halffreezeblocks_2024-07-20_12-47-21/rule_results/2.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_halffreezeblocks_2024-07-20_12-47-21/confusion_matrix/2.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 195607 KiB |   7828 MiB | 185299 GiB | 185299 GiB |
|       from large pool | 179211 KiB |   7805 MiB | 182834 GiB | 182834 GiB |
|       from small pool |  16396 KiB |     36 MiB |   2464 GiB |   2464 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 195607 KiB |   7828 MiB | 185299 GiB | 185299 GiB |
|       from large pool | 179211 KiB |   7805 MiB | 182834 GiB | 182834 GiB |
|       from small pool |  16396 KiB |     36 MiB |   2464 GiB |   2464 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 195188 KiB |   7827 MiB | 185275 GiB | 185275 GiB |
|       from large pool | 178979 KiB |   7804 MiB | 182815 GiB | 182815 GiB |
|       from small pool |  16209 KiB |     36 MiB |   2459 GiB |   2459 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   8512 MiB |   8524 MiB |  25074 MiB |  16562 MiB |
|       from large pool |   8474 MiB |   8486 MiB |  25000 MiB |  16526 MiB |
|       from small pool |     38 MiB |     44 MiB |     74 MiB |     36 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  39913 KiB | 732464 KiB | 100652 GiB | 100652 GiB |
|       from large pool |  31733 KiB | 730714 KiB |  98180 GiB |  98180 GiB |
|       from small pool |   8180 KiB |  22313 KiB |   2472 GiB |   2472 GiB |
|---------------------------------------------------------------------------|
| Allocations           |     788    |    1679    |   31316 K  |   31315 K  |
|       from large pool |      79    |     762    |   17022 K  |   17022 K  |
|       from small pool |     709    |    1017    |   14294 K  |   14293 K  |
|---------------------------------------------------------------------------|
| Active allocs         |     788    |    1679    |   31316 K  |   31315 K  |
|       from large pool |      79    |     762    |   17022 K  |   17022 K  |
|       from small pool |     709    |    1017    |   14294 K  |   14293 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     368    |     370    |    1062    |     694    |
|       from large pool |     349    |     349    |    1025    |     676    |
|       from small pool |      19    |      22    |      37    |      18    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      44    |     383    |   18326 K  |   18325 K  |
|       from large pool |      11    |     352    |   12008 K  |   12008 K  |
|       from small pool |      33    |     214    |    6317 K  |    6317 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   7828 MiB | 185299 GiB | 185299 GiB |
|       from large pool |  16640 KiB |   7805 MiB | 182834 GiB | 182834 GiB |
|       from small pool |      0 KiB |     36 MiB |   2464 GiB |   2464 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   7828 MiB | 185299 GiB | 185299 GiB |
|       from large pool |  16640 KiB |   7805 MiB | 182834 GiB | 182834 GiB |
|       from small pool |      0 KiB |     36 MiB |   2464 GiB |   2464 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   7827 MiB | 185275 GiB | 185275 GiB |
|       from large pool |  16640 KiB |   7804 MiB | 182815 GiB | 182815 GiB |
|       from small pool |      0 KiB |     36 MiB |   2459 GiB |   2459 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 235520 KiB |   8524 MiB |  25074 MiB |  24844 MiB |
|       from large pool | 210944 KiB |   8486 MiB |  25000 MiB |  24794 MiB |
|       from small pool |  24576 KiB |     44 MiB |     74 MiB |     50 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  30464 KiB | 732464 KiB | 100653 GiB | 100653 GiB |
|       from large pool |  30464 KiB | 730714 KiB |  98180 GiB |  98180 GiB |
|       from small pool |      0 KiB |  22319 KiB |   2472 GiB |   2472 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    1679    |   31316 K  |   31316 K  |
|       from large pool |       2    |     762    |   17022 K  |   17022 K  |
|       from small pool |       0    |    1017    |   14294 K  |   14294 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    1679    |   31316 K  |   31316 K  |
|       from large pool |       2    |     762    |   17022 K  |   17022 K  |
|       from small pool |       0    |    1017    |   14294 K  |   14294 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      22    |     370    |    1062    |    1040    |
|       from large pool |      10    |     349    |    1025    |    1015    |
|       from small pool |      12    |      22    |      37    |      25    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     383    |   18326 K  |   18326 K  |
|       from large pool |       3    |     352    |   12008 K  |   12008 K  |
|       from small pool |       0    |     214    |    6317 K  |    6317 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Sat Jul 20 15:09:42 2024]
Finished job 0.
1 of 1 steps (100%) done
