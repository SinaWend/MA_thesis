Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Sat Jul 13 05:42:21 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYONWILD_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_halffreeze/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYONWILD_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_halffreeze/rule_results/1.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=1
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/swiglu_ffn.py:51: UserWarning: xFormers is not available (SwiGLU)
  warnings.warn("xFormers is not available (SwiGLU)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/attention.py:33: UserWarning: xFormers is not available (Attention)
  warnings.warn("xFormers is not available (Attention)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/block.py:40: UserWarning: xFormers is not available (Block)
  warnings.warn("xFormers is not available (Block)")
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_05_50_53_seed_0_21955595

 Experiment start at: 2024-07-13 05:50:53.926045
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
before training, model accuracy: 0.5360825061798096
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.982446, 'precision': 0.89579356, 'recall': 0.92238665, 'specificity': 0.92238665, 'f1': 0.9086009, 'auroc': 0.9912431, 'binary_precision': 0.99257046, 'binary_recall': 0.9889471, 'binary_specificity': 0.8558262, 'binary_f1_score': 0.9907555}
confusion matrix:
      0      1
0  1300    219
1   327  29258
---- Validation: 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
scalar performance:
{'acc': 0.78959626, 'precision': 0.8273732, 'recall': 0.79195356, 'specificity': 0.79195356, 'f1': 0.78423655, 'auroc': 0.936282, 'binary_precision': 0.7126168, 'binary_recall': 0.96062994, 'binary_specificity': 0.6232772, 'binary_f1_score': 0.8182427}
confusion matrix:
     0    1
0  407  246
1   25  610
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7690722, 'precision': 0.80582494, 'recall': 0.7466408, 'specificity': 0.7466408, 'f1': 0.74904835, 'auroc': 0.93414295, 'binary_precision': 0.7244318, 'binary_recall': 0.9444444, 'binary_specificity': 0.5488372, 'binary_f1_score': 0.8199357}
confusion matrix:
     0    1
0  118   97
1   15  255
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-13 06:01:21.264213,epoch time: 0:10:27.338168,used: 0:10:27.338168,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_05_50_53_seed_0_21955595
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.98331404, 'precision': 0.9666912, 'recall': 0.8468628, 'specificity': 0.8468628, 'f1': 0.8970126, 'auroc': 0.99416804, 'binary_precision': 0.98459536, 'binary_recall': 0.9980734, 'binary_specificity': 0.6956522, 'binary_f1_score': 0.99128854}
confusion matrix:
      0      1
0  1056    462
1    57  29529
---- Validation: 
scalar performance:
{'acc': 0.77251554, 'precision': 0.824064, 'recall': 0.77528185, 'specificity': 0.77528185, 'f1': 0.7642622, 'auroc': 0.9374661, 'binary_precision': 0.6912752, 'binary_recall': 0.97322834, 'binary_specificity': 0.57733536, 'binary_f1_score': 0.8083715}
confusion matrix:
     0    1
0  377  276
1   17  618
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.75670105, 'precision': 0.7970902, 'recall': 0.73268735, 'specificity': 0.73268735, 'f1': 0.73353636, 'auroc': 0.93696815, 'binary_precision': 0.7122905, 'binary_recall': 0.9444444, 'binary_specificity': 0.52093023, 'binary_f1_score': 0.81210196}
confusion matrix:
     0    1
0  112  103
1   15  255
early stop counter: 1
val acc:0.7725155353546143, best validation acc: 0.7895962595939636, corresponding to test acc:                         0.7690721750259399 / 0.7690721750259399
after epoch: 2,now: 2024-07-13 06:11:28.265116,epoch time: 0:10:07.000903,used: 0:20:34.339071,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_05_50_53_seed_0_21955595
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9894869, 'precision': 0.96291596, 'recall': 0.92077935, 'specificity': 0.92077935, 'f1': 0.94072783, 'auroc': 0.99691904, 'binary_precision': 0.9920619, 'binary_recall': 0.9969241, 'binary_specificity': 0.84463465, 'binary_f1_score': 0.9944871}
confusion matrix:
      0      1
0  1283    236
1    91  29494
---- Validation: 
scalar performance:
{'acc': 0.7189441, 'precision': 0.80515087, 'recall': 0.7226224, 'specificity': 0.7226224, 'f1': 0.69970655, 'auroc': 0.93689454, 'binary_precision': 0.63942796, 'binary_recall': 0.9858268, 'binary_specificity': 0.45941806, 'binary_f1_score': 0.7757125}
confusion matrix:
     0    1
0  300  353
1    9  626
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.74432987, 'precision': 0.7936292, 'recall': 0.7177864, 'specificity': 0.7177864, 'f1': 0.71607435, 'auroc': 0.9324204, 'binary_precision': 0.69836956, 'binary_recall': 0.95185184, 'binary_specificity': 0.48372093, 'binary_f1_score': 0.80564266}
confusion matrix:
     0    1
0  104  111
1   13  257
early stop counter: 2
val acc:0.7189440727233887, best validation acc: 0.7895962595939636, corresponding to test acc:                         0.7690721750259399 / 0.7690721750259399
after epoch: 3,now: 2024-07-13 06:21:36.018993,epoch time: 0:10:07.753877,used: 0:30:42.092948,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_05_50_53_seed_0_21955595
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9887796, 'precision': 0.92063046, 'recall': 0.9678716, 'specificity': 0.9678716, 'f1': 0.94283247, 'auroc': 0.9976001, 'binary_precision': 0.99714327, 'binary_recall': 0.99104273, 'binary_specificity': 0.9447005, 'binary_f1_score': 0.99408364}
confusion matrix:
      0      1
0  1435     84
1   265  29320
---- Validation: 
scalar performance:
{'acc': 0.86413044, 'precision': 0.8723797, 'recall': 0.8651783, 'specificity': 0.8651783, 'f1': 0.86359096, 'auroc': 0.9450121, 'binary_precision': 0.8133515, 'binary_recall': 0.9401575, 'binary_specificity': 0.7901991, 'binary_f1_score': 0.87216944}
confusion matrix:
     0    1
0  516  137
1   38  597
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8783505, 'precision': 0.87889886, 'recall': 0.8741602, 'specificity': 0.8741602, 'f1': 0.87605524, 'auroc': 0.9485271, 'binary_precision': 0.8754448, 'binary_recall': 0.9111111, 'binary_specificity': 0.8372093, 'binary_f1_score': 0.8929219}
confusion matrix:
     0    1
0  180   35
1   24  246
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-07-13 06:31:41.487957,epoch time: 0:10:05.468964,used: 0:40:47.561912,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_05_50_53_seed_0_21955595
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.98800796, 'precision': 0.97345734, 'recall': 0.89370245, 'specificity': 0.89370245, 'f1': 0.92950946, 'auroc': 0.9978092, 'binary_precision': 0.9892808, 'binary_recall': 0.9982086, 'binary_specificity': 0.7891963, 'binary_f1_score': 0.9937246}
confusion matrix:
      0      1
0  1198    320
1    53  29533
---- Validation: 
scalar performance:
{'acc': 0.73524845, 'precision': 0.8143674, 'recall': 0.73872375, 'specificity': 0.73872375, 'f1': 0.7193012, 'auroc': 0.947232, 'binary_precision': 0.653125, 'binary_recall': 0.98740155, 'binary_specificity': 0.49004593, 'binary_f1_score': 0.7862069}
confusion matrix:
     0    1
0  320  333
1    8  627
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.77319586, 'precision': 0.81100476, 'recall': 0.75081825, 'specificity': 0.75081825, 'f1': 0.7535296, 'auroc': 0.9414815, 'binary_precision': 0.72727275, 'binary_recall': 0.94814813, 'binary_specificity': 0.5534884, 'binary_f1_score': 0.8231512}
confusion matrix:
     0    1
0  119   96
1   14  256
early stop counter: 1
val acc:0.7352484464645386, best validation acc: 0.864130437374115, corresponding to test acc:                         0.8783504962921143 / 0.8783504962921143
after epoch: 5,now: 2024-07-13 06:41:45.599423,epoch time: 0:10:04.111466,used: 0:50:51.673378,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_05_50_53_seed_0_21955595
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9936343, 'precision': 0.9617573, 'recall': 0.97040546, 'specificity': 0.97040546, 'f1': 0.96603644, 'auroc': 0.99862134, 'binary_precision': 0.99715793, 'binary_recall': 0.9961468, 'binary_specificity': 0.94466406, 'binary_f1_score': 0.9966521}
confusion matrix:
      0      1
0  1434     84
1   114  29472
---- Validation: 
scalar performance:
{'acc': 0.8959627, 'precision': 0.8963405, 'recall': 0.89620286, 'specificity': 0.89620286, 'f1': 0.8959605, 'auroc': 0.94858134, 'binary_precision': 0.8801214, 'binary_recall': 0.9133858, 'binary_specificity': 0.8790199, 'binary_f1_score': 0.89644516}
confusion matrix:
     0    1
0  574   79
1   55  580
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8804124, 'precision': 0.8796731, 'recall': 0.8845392, 'specificity': 0.8845392, 'f1': 0.8799218, 'auroc': 0.94320416, 'binary_precision': 0.9308943, 'binary_recall': 0.84814817, 'binary_specificity': 0.9209302, 'binary_f1_score': 0.8875969}
confusion matrix:
     0    1
0  198   17
1   41  229
new oracle model saved
better model found
persisted
after epoch: 6,now: 2024-07-13 06:51:50.640904,epoch time: 0:10:05.041481,used: 1:00:56.714859,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_05_50_53_seed_0_21955595
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.99209106, 'precision': 0.98544556, 'recall': 0.9279872, 'specificity': 0.9279872, 'f1': 0.9547095, 'auroc': 0.9989375, 'binary_precision': 0.992712, 'binary_recall': 0.99901986, 'binary_specificity': 0.8569545, 'binary_f1_score': 0.995856}
confusion matrix:
      0      1
0  1300    217
1    29  29558
---- Validation: 
scalar performance:
{'acc': 0.7880435, 'precision': 0.8394144, 'recall': 0.79074776, 'specificity': 0.79074776, 'f1': 0.7807447, 'auroc': 0.95298195, 'binary_precision': 0.7038288, 'binary_recall': 0.984252, 'binary_specificity': 0.5972435, 'binary_f1_score': 0.8207485}
confusion matrix:
     0    1
0  390  263
1   10  625
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.82474226, 'precision': 0.84380615, 'recall': 0.8099053, 'specificity': 0.8099053, 'f1': 0.81559837, 'auroc': 0.9433893, 'binary_precision': 0.7863777, 'binary_recall': 0.94074076, 'binary_specificity': 0.67906976, 'binary_f1_score': 0.856661}
confusion matrix:
     0    1
0  146   69
1   16  254
early stop counter: 1
val acc:0.7880434989929199, best validation acc: 0.8959627151489258, corresponding to test acc:                         0.8804123997688293 / 0.8804123997688293
after epoch: 7,now: 2024-07-13 07:01:54.355453,epoch time: 0:10:03.714549,used: 1:11:00.429408,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_05_50_53_seed_0_21955595
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9908372, 'precision': 0.9268993, 'recall': 0.9848716, 'specificity': 0.9848716, 'f1': 0.953804, 'auroc': 0.999102, 'binary_precision': 0.9988763, 'binary_recall': 0.99148244, 'binary_specificity': 0.9782609, 'binary_f1_score': 0.99516565}
confusion matrix:
      0      1
0  1485     33
1   252  29334
---- Validation: 
scalar performance:
{'acc': 0.88509315, 'precision': 0.886492, 'recall': 0.88468003, 'specificity': 0.88468003, 'f1': 0.88489085, 'auroc': 0.9459702, 'binary_precision': 0.90651083, 'binary_recall': 0.8551181, 'binary_specificity': 0.91424197, 'binary_f1_score': 0.88006485}
confusion matrix:
     0    1
0  597   56
1   92  543
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8618557, 'precision': 0.86463654, 'recall': 0.86881995, 'specificity': 0.86881995, 'f1': 0.8616651, 'auroc': 0.9377606, 'binary_precision': 0.93562233, 'binary_recall': 0.8074074, 'binary_specificity': 0.9302326, 'binary_f1_score': 0.8667992}
confusion matrix:
     0    1
0  200   15
1   52  218
early stop counter: 2
val acc:0.8850931525230408, best validation acc: 0.8959627151489258, corresponding to test acc:                         0.8804123997688293 / 0.8804123997688293
after epoch: 8,now: 2024-07-13 07:11:56.778332,epoch time: 0:10:02.422879,used: 1:21:02.852287,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_05_50_53_seed_0_21955595
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9926376, 'precision': 0.9475006, 'recall': 0.9767561, 'specificity': 0.9767561, 'f1': 0.9616082, 'auroc': 0.998832, 'binary_precision': 0.99789697, 'binary_recall': 0.99435544, 'binary_specificity': 0.9591568, 'binary_f1_score': 0.9961231}
confusion matrix:
      0      1
0  1456     62
1   167  29419
---- Validation: 
scalar performance:
{'acc': 0.84782606, 'precision': 0.8628527, 'recall': 0.84925056, 'specificity': 0.84925056, 'f1': 0.8465817, 'auroc': 0.9417106, 'binary_precision': 0.7854356, 'binary_recall': 0.9511811, 'binary_specificity': 0.74732006, 'binary_f1_score': 0.8603989}
confusion matrix:
     0    1
0  488  165
1   31  604
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8329897, 'precision': 0.835742, 'recall': 0.8253661, 'specificity': 0.8253661, 'f1': 0.82855535, 'auroc': 0.9366064, 'binary_precision': 0.8225256, 'binary_recall': 0.8925926, 'binary_specificity': 0.75813955, 'binary_f1_score': 0.8561279}
confusion matrix:
     0    1
0  163   52
1   29  241
early stop counter: 3
val acc:0.8478260636329651, best validation acc: 0.8959627151489258, corresponding to test acc:                         0.8804123997688293 / 0.8804123997688293
after epoch: 9,now: 2024-07-13 07:21:58.740301,epoch time: 0:10:01.961969,used: 1:31:04.814256,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_05_50_53_seed_0_21955595
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9927662, 'precision': 0.9509673, 'recall': 0.9737145, 'specificity': 0.9737145, 'f1': 0.96202683, 'auroc': 0.9986334, 'binary_precision': 0.99755967, 'binary_recall': 0.99482846, 'binary_specificity': 0.9526004, 'binary_f1_score': 0.9961922}
confusion matrix:
      0      1
0  1447     72
1   153  29432
---- Validation: 
scalar performance:
{'acc': 0.9076087, 'precision': 0.9076201, 'recall': 0.9075581, 'specificity': 0.9075581, 'f1': 0.90758413, 'auroc': 0.9513692, 'binary_precision': 0.90822786, 'binary_recall': 0.903937, 'binary_specificity': 0.9111792, 'binary_f1_score': 0.9060773}
confusion matrix:
     0    1
0  595   58
1   61  574
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8845361, 'precision': 0.88633347, 'recall': 0.89108527, 'specificity': 0.89108527, 'f1': 0.8843192, 'auroc': 0.94306636, 'binary_precision': 0.9533898, 'binary_recall': 0.8333333, 'binary_specificity': 0.9488372, 'binary_f1_score': 0.88932806}
confusion matrix:
     0    1
0  204   11
1   45  225
new oracle model saved
better model found
persisted
after epoch: 10,now: 2024-07-13 07:32:05.290895,epoch time: 0:10:06.550594,used: 1:41:11.364850,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_05_50_53_seed_0_21955595
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.99344134, 'precision': 0.95897865, 'recall': 0.9715712, 'specificity': 0.9715712, 'f1': 0.96517944, 'auroc': 0.9989549, 'binary_precision': 0.9972919, 'binary_recall': 0.99580866, 'binary_specificity': 0.94733375, 'binary_f1_score': 0.99654967}
confusion matrix:
      0      1
0  1439     80
1   124  29461
---- Validation: 
scalar performance:
{'acc': 0.83462733, 'precision': 0.85849166, 'recall': 0.8364291, 'specificity': 0.8364291, 'f1': 0.8323227, 'auroc': 0.9455559, 'binary_precision': 0.7624378, 'binary_recall': 0.9653543, 'binary_specificity': 0.70750386, 'binary_f1_score': 0.85198057}
confusion matrix:
     0    1
0  462  191
1   22  613
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.79793817, 'precision': 0.80486465, 'recall': 0.78630495, 'specificity': 0.78630495, 'f1': 0.7902249, 'auroc': 0.92773473, 'binary_precision': 0.77922076, 'binary_recall': 0.8888889, 'binary_specificity': 0.68372095, 'binary_f1_score': 0.8304498}
confusion matrix:
     0    1
0  147   68
1   30  240
early stop counter: 1
val acc:0.8346273303031921, best validation acc: 0.907608687877655, corresponding to test acc:                         0.88453608751297 / 0.88453608751297
after epoch: 11,now: 2024-07-13 07:42:20.266404,epoch time: 0:10:14.975509,used: 1:51:26.340359,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_05_50_53_seed_0_21955595
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9927983, 'precision': 0.9452797, 'recall': 0.9818403, 'specificity': 0.9818403, 'f1': 0.9627495, 'auroc': 0.99908197, 'binary_precision': 0.99843824, 'binary_recall': 0.9939836, 'binary_specificity': 0.969697, 'binary_f1_score': 0.996206}
confusion matrix:
      0      1
0  1472     46
1   178  29408
---- Validation: 
scalar performance:
{'acc': 0.86878884, 'precision': 0.87342703, 'recall': 0.8695771, 'specificity': 0.8695771, 'f1': 0.8685313, 'auroc': 0.94323653, 'binary_precision': 0.828169, 'binary_recall': 0.92598426, 'binary_specificity': 0.81316996, 'binary_f1_score': 0.8743494}
confusion matrix:
     0    1
0  531  122
1   47  588
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.84742266, 'precision': 0.8451282, 'recall': 0.8478036, 'specificity': 0.8478036, 'f1': 0.8460977, 'auroc': 0.92780364, 'binary_precision': 0.8769231, 'binary_recall': 0.84444445, 'binary_specificity': 0.8511628, 'binary_f1_score': 0.8603774}
confusion matrix:
     0    1
0  183   32
1   42  228
early stop counter: 2
val acc:0.8687888383865356, best validation acc: 0.907608687877655, corresponding to test acc:                         0.88453608751297 / 0.88453608751297
after epoch: 12,now: 2024-07-13 07:52:35.904807,epoch time: 0:10:15.638403,used: 2:01:41.978762,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_05_50_53_seed_0_21955595
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9919946, 'precision': 0.9401348, 'recall': 0.97924185, 'specificity': 0.97924185, 'f1': 0.95875216, 'auroc': 0.9986738, 'binary_precision': 0.9981999, 'binary_recall': 0.993375, 'binary_specificity': 0.96510863, 'binary_f1_score': 0.9957816}
confusion matrix:
      0      1
0  1466     53
1   196  29389
---- Validation: 
scalar performance:
{'acc': 0.882764, 'precision': 0.88310635, 'recall': 0.88255656, 'specificity': 0.88255656, 'f1': 0.8826773, 'auroc': 0.93849826, 'binary_precision': 0.89158577, 'binary_recall': 0.86771655, 'binary_specificity': 0.8973966, 'binary_f1_score': 0.87948924}
confusion matrix:
     0    1
0  586   67
1   84  551
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.84742266, 'precision': 0.8485949, 'recall': 0.85301465, 'specificity': 0.85301465, 'f1': 0.8470788, 'auroc': 0.923807, 'binary_precision': 0.9117647, 'binary_recall': 0.8037037, 'binary_specificity': 0.9023256, 'binary_f1_score': 0.8543307}
confusion matrix:
     0    1
0  194   21
1   53  217
early stop counter: 3
val acc:0.8827639818191528, best validation acc: 0.907608687877655, corresponding to test acc:                         0.88453608751297 / 0.88453608751297
after epoch: 13,now: 2024-07-13 08:02:38.977922,epoch time: 0:10:03.073115,used: 2:11:45.051877,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_05_50_53_seed_0_21955595
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9936664, 'precision': 0.95703924, 'recall': 0.97668576, 'specificity': 0.97668576, 'f1': 0.9666308, 'auroc': 0.9989469, 'binary_precision': 0.9978317, 'binary_recall': 0.9955045, 'binary_specificity': 0.957867, 'binary_f1_score': 0.9966668}
confusion matrix:
      0      1
0  1455     64
1   133  29452
---- Validation: 
scalar performance:
{'acc': 0.8781056, 'precision': 0.8825784, 'recall': 0.878874, 'specificity': 0.878874, 'f1': 0.87788296, 'auroc': 0.94942486, 'binary_precision': 0.8375706, 'binary_recall': 0.9338583, 'binary_specificity': 0.82388973, 'binary_f1_score': 0.8830976}
confusion matrix:
     0    1
0  538  115
1   42  593
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.84742266, 'precision': 0.8465488, 'recall': 0.8435401, 'specificity': 0.8435401, 'f1': 0.84480405, 'auroc': 0.93493533, 'binary_precision': 0.85251796, 'binary_recall': 0.87777776, 'binary_specificity': 0.80930233, 'binary_f1_score': 0.8649635}
confusion matrix:
     0    1
0  174   41
1   33  237
early stop counter: 4
val acc:0.8781055808067322, best validation acc: 0.907608687877655, corresponding to test acc:                         0.88453608751297 / 0.88453608751297
after epoch: 14,now: 2024-07-13 08:12:42.908716,epoch time: 0:10:03.930794,used: 2:21:48.982671,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_05_50_53_seed_0_21955595
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.992509, 'precision': 0.98715, 'recall': 0.9311114, 'specificity': 0.9311114, 'f1': 0.9572315, 'auroc': 0.999408, 'binary_precision': 0.9930126, 'binary_recall': 0.999155, 'binary_specificity': 0.8630678, 'binary_f1_score': 0.9960743}
confusion matrix:
      0      1
0  1311    208
1    25  29560
---- Validation: 
scalar performance:
{'acc': 0.79270184, 'precision': 0.8374757, 'recall': 0.79523337, 'specificity': 0.79523337, 'f1': 0.7865304, 'auroc': 0.94566506, 'binary_precision': 0.71100914, 'binary_recall': 0.97637796, 'binary_specificity': 0.61408883, 'binary_f1_score': 0.8228268}
confusion matrix:
     0    1
0  401  252
1   15  620
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.80618554, 'precision': 0.8284946, 'recall': 0.78944874, 'specificity': 0.78944874, 'f1': 0.79463965, 'auroc': 0.9348148, 'binary_precision': 0.76666665, 'binary_recall': 0.93703705, 'binary_specificity': 0.6418605, 'binary_f1_score': 0.84333336}
confusion matrix:
     0    1
0  138   77
1   17  253
early stop counter: 5
val acc:0.7927018404006958, best validation acc: 0.907608687877655, corresponding to test acc:                         0.88453608751297 / 0.88453608751297
after epoch: 15,now: 2024-07-13 08:22:51.093563,epoch time: 0:10:08.184847,used: 2:31:57.167518,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_05_50_53_seed_0_21955595
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.99520963, 'precision': 0.9705076, 'recall': 0.9784338, 'specificity': 0.9784338, 'f1': 0.97443366, 'auroc': 0.99939626, 'binary_precision': 0.99793625, 'binary_recall': 0.99702555, 'binary_specificity': 0.959842, 'binary_f1_score': 0.99748075}
confusion matrix:
      0      1
0  1458     61
1    88  29497
---- Validation: 
scalar performance:
{'acc': 0.9006211, 'precision': 0.9025205, 'recall': 0.90112257, 'specificity': 0.90112257, 'f1': 0.9005672, 'auroc': 0.9534167, 'binary_precision': 0.87115663, 'binary_recall': 0.93700784, 'binary_specificity': 0.86523736, 'binary_f1_score': 0.9028831}
confusion matrix:
     0    1
0  565   88
1   40  595
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8845361, 'precision': 0.88270783, 'recall': 0.88682175, 'specificity': 0.88682175, 'f1': 0.88378465, 'auroc': 0.9464944, 'binary_precision': 0.9212598, 'binary_recall': 0.8666667, 'binary_specificity': 0.90697676, 'binary_f1_score': 0.8931298}
confusion matrix:
     0    1
0  195   20
1   36  234
early stop counter: 6
val acc:0.9006211161613464, best validation acc: 0.907608687877655, corresponding to test acc:                         0.88453608751297 / 0.88453608751297
after epoch: 16,now: 2024-07-13 08:33:06.039243,epoch time: 0:10:14.945680,used: 2:42:12.113198,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_05_50_53_seed_0_21955595
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.99382716, 'precision': 0.96869195, 'recall': 0.964592, 'specificity': 0.964592, 'f1': 0.9666319, 'auroc': 0.99912417, 'binary_precision': 0.99652016, 'binary_recall': 0.9969917, 'binary_specificity': 0.9321922, 'binary_f1_score': 0.99675584}
confusion matrix:
      0      1
0  1416    103
1    89  29496
---- Validation: 
scalar performance:
{'acc': 0.85636646, 'precision': 0.85662043, 'recall': 0.8565663, 'specificity': 0.8565663, 'f1': 0.8563657, 'auroc': 0.92081606, 'binary_precision': 0.8429878, 'binary_recall': 0.8708661, 'binary_specificity': 0.84226644, 'binary_f1_score': 0.85670024}
confusion matrix:
     0    1
0  550  103
1   82  553
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8556701, 'precision': 0.8539921, 'recall': 0.8580534, 'specificity': 0.8580534, 'f1': 0.85482514, 'auroc': 0.9336606, 'binary_precision': 0.8968254, 'binary_recall': 0.837037, 'binary_specificity': 0.87906975, 'binary_f1_score': 0.86590034}
confusion matrix:
     0    1
0  189   26
1   44  226
early stop counter: 7
val acc:0.8563664555549622, best validation acc: 0.907608687877655, corresponding to test acc:                         0.88453608751297 / 0.88453608751297
after epoch: 17,now: 2024-07-13 08:43:23.411669,epoch time: 0:10:17.372426,used: 2:52:29.485624,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_05_50_53_seed_0_21955595
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9948238, 'precision': 0.9736797, 'recall': 0.9704244, 'specificity': 0.9704244, 'f1': 0.9720458, 'auroc': 0.9994216, 'binary_precision': 0.9970942, 'binary_recall': 0.99746495, 'binary_specificity': 0.9433838, 'binary_f1_score': 0.9972796}
confusion matrix:
      0      1
0  1433     86
1    75  29510
---- Validation: 
scalar performance:
{'acc': 0.89518636, 'precision': 0.8952567, 'recall': 0.89508986, 'specificity': 0.89508986, 'f1': 0.89514685, 'auroc': 0.9480623, 'binary_precision': 0.8980892, 'binary_recall': 0.88818896, 'binary_specificity': 0.90199083, 'binary_f1_score': 0.8931116}
confusion matrix:
     0    1
0  589   64
1   71  564
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.88659793, 'precision': 0.8894168, 'recall': 0.89388454, 'specificity': 0.89388454, 'f1': 0.88644147, 'auroc': 0.94372094, 'binary_precision': 0.9613734, 'binary_recall': 0.8296296, 'binary_specificity': 0.95813954, 'binary_f1_score': 0.89065605}
confusion matrix:
     0    1
0  206    9
1   46  224
new oracle model saved
early stop counter: 8
val acc:0.8951863646507263, best validation acc: 0.907608687877655, corresponding to test acc:                         0.88453608751297 / 0.8865979313850403
after epoch: 18,now: 2024-07-13 08:53:44.412281,epoch time: 0:10:21.000612,used: 3:02:50.486236,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_05_50_53_seed_0_21955595
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9932806, 'precision': 0.9493724, 'recall': 0.9820938, 'specificity': 0.9820938, 'f1': 0.9650874, 'auroc': 0.9993057, 'binary_precision': 0.998439, 'binary_recall': 0.9944906, 'binary_specificity': 0.969697, 'binary_f1_score': 0.99646086}
confusion matrix:
      0      1
0  1472     46
1   163  29423
---- Validation: 
scalar performance:
{'acc': 0.8874224, 'precision': 0.8888752, 'recall': 0.88786703, 'specificity': 0.88786703, 'f1': 0.88737994, 'auroc': 0.94398963, 'binary_precision': 0.8613569, 'binary_recall': 0.91968507, 'binary_specificity': 0.856049, 'binary_f1_score': 0.8895659}
confusion matrix:
     0    1
0  559   94
1   51  584
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8886598, 'precision': 0.8875731, 'recall': 0.8924203, 'specificity': 0.8924203, 'f1': 0.88814193, 'auroc': 0.94592595, 'binary_precision': 0.9354839, 'binary_recall': 0.85925925, 'binary_specificity': 0.9255814, 'binary_f1_score': 0.8957529}
confusion matrix:
     0    1
0  199   16
1   38  232
new oracle model saved
early stop counter: 9
val acc:0.8874223828315735, best validation acc: 0.907608687877655, corresponding to test acc:                         0.88453608751297 / 0.8886597752571106
after epoch: 19,now: 2024-07-13 09:03:54.338795,epoch time: 0:10:09.926514,used: 3:13:00.412750,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_05_50_53_seed_0_21955595
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.99498457, 'precision': 0.9752606, 'recall': 0.9705089, 'specificity': 0.9705089, 'f1': 0.9728714, 'auroc': 0.99949944, 'binary_precision': 0.9970947, 'binary_recall': 0.99763393, 'binary_specificity': 0.9433838, 'binary_f1_score': 0.9973642}
confusion matrix:
      0      1
0  1433     86
1    70  29515
---- Validation: 
scalar performance:
{'acc': 0.88897514, 'precision': 0.8900162, 'recall': 0.889355, 'specificity': 0.889355, 'f1': 0.888951, 'auroc': 0.95181775, 'binary_precision': 0.8660714, 'binary_recall': 0.91653544, 'binary_specificity': 0.8621746, 'binary_f1_score': 0.8905892}
confusion matrix:
     0    1
0  563   90
1   53  582
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.89484537, 'precision': 0.8957461, 'recall': 0.9008182, 'specificity': 0.9008182, 'f1': 0.8945872, 'auroc': 0.9552455, 'binary_precision': 0.95815897, 'binary_recall': 0.84814817, 'binary_specificity': 0.95348835, 'binary_f1_score': 0.8998035}
confusion matrix:
     0    1
0  205   10
1   41  229
new oracle model saved
early stop counter: 10
val acc:0.8889751434326172, best validation acc: 0.907608687877655, corresponding to test acc:                         0.88453608751297 / 0.8948453664779663
after epoch: 20,now: 2024-07-13 09:14:04.671503,epoch time: 0:10:10.332708,used: 3:23:10.745458,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_05_50_53_seed_0_21955595
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9953704, 'precision': 0.98419285, 'recall': 0.9654032, 'specificity': 0.9654032, 'f1': 0.9745909, 'auroc': 0.99929196, 'binary_precision': 0.99652576, 'binary_recall': 0.9986142, 'binary_specificity': 0.9321922, 'binary_f1_score': 0.9975689}
confusion matrix:
      0      1
0  1416    103
1    41  29544
---- Validation: 
scalar performance:
{'acc': 0.7546584, 'precision': 0.8251406, 'recall': 0.75788784, 'specificity': 0.75788784, 'f1': 0.7421206, 'auroc': 0.9481424, 'binary_precision': 0.67022413, 'binary_recall': 0.98897636, 'binary_specificity': 0.5267994, 'binary_f1_score': 0.79898226}
confusion matrix:
     0    1
0  344  309
1    7  628
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.77938145, 'precision': 0.8306228, 'recall': 0.7549526, 'specificity': 0.7549526, 'f1': 0.7573968, 'auroc': 0.9348148, 'binary_precision': 0.7257618, 'binary_recall': 0.97037035, 'binary_specificity': 0.53953487, 'binary_f1_score': 0.8304279}
confusion matrix:
     0    1
0  116   99
1    8  262
early stop counter: 11
val acc:0.7546584010124207, best validation acc: 0.907608687877655, corresponding to test acc:                         0.88453608751297 / 0.8948453664779663
after epoch: 21,now: 2024-07-13 09:24:14.865878,epoch time: 0:10:10.194375,used: 3:33:20.939833,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_05_50_53_seed_0_21955595
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9954668, 'precision': 0.973511, 'recall': 0.97794443, 'specificity': 0.97794443, 'f1': 0.9757162, 'auroc': 0.9994439, 'binary_precision': 0.9978695, 'binary_recall': 0.9973635, 'binary_specificity': 0.95852536, 'binary_f1_score': 0.9976164}
confusion matrix:
      0      1
0  1456     63
1    78  29507
---- Validation: 
scalar performance:
{'acc': 0.89363354, 'precision': 0.8943324, 'recall': 0.89394915, 'specificity': 0.89394915, 'f1': 0.89362276, 'auroc': 0.94767153, 'binary_precision': 0.8738739, 'binary_recall': 0.91653544, 'binary_specificity': 0.8713629, 'binary_f1_score': 0.8946964}
confusion matrix:
     0    1
0  569   84
1   53  582
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.84742266, 'precision': 0.8452782, 'recall': 0.8459087, 'specificity': 0.8459087, 'f1': 0.8455786, 'auroc': 0.9326615, 'binary_precision': 0.86567163, 'binary_recall': 0.85925925, 'binary_specificity': 0.83255816, 'binary_f1_score': 0.8624535}
confusion matrix:
     0    1
0  179   36
1   38  232
early stop counter: 12
val acc:0.8936335444450378, best validation acc: 0.907608687877655, corresponding to test acc:                         0.88453608751297 / 0.8948453664779663
after epoch: 22,now: 2024-07-13 09:34:25.040780,epoch time: 0:10:10.174902,used: 3:43:31.114735,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_05_50_53_seed_0_21955595
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.9923161, 'precision': 0.944564, 'recall': 0.97691274, 'specificity': 0.97691274, 'f1': 0.9601, 'auroc': 0.99876463, 'binary_precision': 0.99792993, 'binary_recall': 0.99398345, 'binary_specificity': 0.959842, 'binary_f1_score': 0.9959528}
confusion matrix:
      0      1
0  1458     61
1   178  29407
---- Validation: 
scalar performance:
{'acc': 0.88121116, 'precision': 0.8831233, 'recall': 0.8817197, 'specificity': 0.8817197, 'f1': 0.8811424, 'auroc': 0.9355874, 'binary_precision': 0.8523392, 'binary_recall': 0.91811025, 'binary_specificity': 0.8453292, 'binary_f1_score': 0.8840031}
confusion matrix:
     0    1
0  552  101
1   52  583
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8845361, 'precision': 0.89113814, 'recall': 0.89392763, 'specificity': 0.89392763, 'f1': 0.88449633, 'auroc': 0.9441515, 'binary_precision': 0.9776786, 'binary_recall': 0.8111111, 'binary_specificity': 0.9767442, 'binary_f1_score': 0.88663965}
confusion matrix:
     0    1
0  210    5
1   51  219
early stop counter: 13
val acc:0.8812111616134644, best validation acc: 0.907608687877655, corresponding to test acc:                         0.88453608751297 / 0.8948453664779663
after epoch: 23,now: 2024-07-13 09:44:34.224450,epoch time: 0:10:09.183670,used: 3:53:40.298405,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_05_50_53_seed_0_21955595
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.99575615, 'precision': 0.97798705, 'recall': 0.9761931, 'specificity': 0.9761931, 'f1': 0.9770882, 'auroc': 0.99956506, 'binary_precision': 0.9976684, 'binary_recall': 0.9978707, 'binary_specificity': 0.9545155, 'binary_f1_score': 0.99776953}
confusion matrix:
      0      1
0  1448     69
1    63  29524
---- Validation: 
scalar performance:
{'acc': 0.8913044, 'precision': 0.89604425, 'recall': 0.89208615, 'specificity': 0.89208615, 'f1': 0.8910985, 'auroc': 0.9496546, 'binary_precision': 0.84908324, 'binary_recall': 0.9480315, 'binary_specificity': 0.8361409, 'binary_f1_score': 0.8958333}
confusion matrix:
     0    1
0  546  107
1   33  602
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9010309, 'precision': 0.90084773, 'recall': 0.89832044, 'specificity': 0.89832044, 'f1': 0.89944017, 'auroc': 0.95662355, 'binary_precision': 0.90217394, 'binary_recall': 0.9222222, 'binary_specificity': 0.8744186, 'binary_f1_score': 0.9120879}
confusion matrix:
     0    1
0  188   27
1   21  249
new oracle model saved
early stop counter: 14
val acc:0.8913043737411499, best validation acc: 0.907608687877655, corresponding to test acc:                         0.88453608751297 / 0.9010308980941772
after epoch: 24,now: 2024-07-13 09:54:38.284152,epoch time: 0:10:04.059702,used: 4:03:44.358107,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_05_50_53_seed_0_21955595
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.9963027, 'precision': 0.9837376, 'recall': 0.9761677, 'specificity': 0.9761677, 'f1': 0.9799193, 'auroc': 0.9995936, 'binary_precision': 0.9976361, 'binary_recall': 0.99847907, 'binary_specificity': 0.9538563, 'binary_f1_score': 0.99805737}
confusion matrix:
      0      1
0  1447     70
1    45  29542
---- Validation: 
scalar performance:
{'acc': 0.8586956, 'precision': 0.87464345, 'recall': 0.86014396, 'specificity': 0.86014396, 'f1': 0.8574996, 'auroc': 0.951632, 'binary_precision': 0.7937743, 'binary_recall': 0.9637795, 'binary_specificity': 0.7565084, 'binary_f1_score': 0.87055475}
confusion matrix:
     0    1
0  494  159
1   23  612
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.85360825, 'precision': 0.8631147, 'recall': 0.84341085, 'specificity': 0.84341085, 'f1': 0.8483875, 'auroc': 0.9466839, 'binary_precision': 0.8262295, 'binary_recall': 0.93333334, 'binary_specificity': 0.75348836, 'binary_f1_score': 0.87652177}
confusion matrix:
     0    1
0  162   53
1   18  252
early stop counter: 15
val acc:0.8586956262588501, best validation acc: 0.907608687877655, corresponding to test acc:                         0.88453608751297 / 0.9010308980941772
after epoch: 25,now: 2024-07-13 10:04:39.591691,epoch time: 0:10:01.307539,used: 4:13:45.665646,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_05_50_53_seed_0_21955595
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.99575615, 'precision': 0.97857505, 'recall': 0.9755831, 'specificity': 0.9755831, 'f1': 0.9770739, 'auroc': 0.99956703, 'binary_precision': 0.99760103, 'binary_recall': 0.9979382, 'binary_specificity': 0.95322794, 'binary_f1_score': 0.99776965}
confusion matrix:
      0      1
0  1447     71
1    61  29525
---- Validation: 
scalar performance:
{'acc': 0.86878884, 'precision': 0.88024044, 'recall': 0.8700112, 'specificity': 0.8700112, 'f1': 0.8680403, 'auroc': 0.9449011, 'binary_precision': 0.8106667, 'binary_recall': 0.9574803, 'binary_specificity': 0.7825421, 'binary_f1_score': 0.8779783}
confusion matrix:
     0    1
0  511  142
1   27  608
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8659794, 'precision': 0.8673246, 'recall': 0.86068046, 'specificity': 0.86068046, 'f1': 0.86312824, 'auroc': 0.943497, 'binary_precision': 0.8596491, 'binary_recall': 0.9074074, 'binary_specificity': 0.81395346, 'binary_f1_score': 0.88288295}
confusion matrix:
     0    1
0  175   40
1   25  245
early stop counter: 16
val acc:0.8687888383865356, best validation acc: 0.907608687877655, corresponding to test acc:                         0.88453608751297 / 0.9010308980941772
after epoch: 26,now: 2024-07-13 10:14:42.184693,epoch time: 0:10:02.593002,used: 4:23:48.258648,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_05_50_53_seed_0_21955595
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.99356997, 'precision': 0.9475583, 'recall': 0.988183, 'specificity': 0.988183, 'f1': 0.966879, 'auroc': 0.999583, 'binary_precision': 0.99908286, 'binary_recall': 0.99415267, 'binary_specificity': 0.98221344, 'binary_f1_score': 0.99661165}
confusion matrix:
      0      1
0  1491     27
1   173  29413
---- Validation: 
scalar performance:
{'acc': 0.91071427, 'precision': 0.9109552, 'recall': 0.9105557, 'specificity': 0.9105557, 'f1': 0.91066253, 'auroc': 0.96136546, 'binary_precision': 0.9180064, 'binary_recall': 0.8992126, 'binary_specificity': 0.9218989, 'binary_f1_score': 0.90851235}
confusion matrix:
     0    1
0  602   51
1   64  571
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.91752577, 'precision': 0.91934687, 'recall': 0.92450476, 'specificity': 0.92450476, 'f1': 0.91737086, 'auroc': 0.96013784, 'binary_precision': 0.9872881, 'binary_recall': 0.86296296, 'binary_specificity': 0.9860465, 'binary_f1_score': 0.9209486}
confusion matrix:
     0    1
0  212    3
1   37  233
new oracle model saved
better model found
persisted
after epoch: 27,now: 2024-07-13 10:24:45.791630,epoch time: 0:10:03.606937,used: 4:33:51.865585,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_05_50_53_seed_0_21955595
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.9956597, 'precision': 0.987835, 'recall': 0.964908, 'specificity': 0.964908, 'f1': 0.9760643, 'auroc': 0.99954194, 'binary_precision': 0.99646, 'binary_recall': 0.998986, 'binary_specificity': 0.93083006, 'binary_f1_score': 0.99772143}
confusion matrix:
      0      1
0  1413    105
1    30  29556
---- Validation: 
scalar performance:
{'acc': 0.8796584, 'precision': 0.8864905, 'recall': 0.8806007, 'specificity': 0.8806007, 'f1': 0.8792916, 'auroc': 0.95374525, 'binary_precision': 0.8314917, 'binary_recall': 0.9480315, 'binary_specificity': 0.81316996, 'binary_f1_score': 0.88594556}
confusion matrix:
     0    1
0  531  122
1   33  602
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8639175, 'precision': 0.8668877, 'recall': 0.85740745, 'specificity': 0.85740745, 'f1': 0.8605836, 'auroc': 0.9474074, 'binary_precision': 0.85172415, 'binary_recall': 0.91481483, 'binary_specificity': 0.8, 'binary_f1_score': 0.88214284}
confusion matrix:
     0    1
0  172   43
1   23  247
early stop counter: 1
val acc:0.8796584010124207, best validation acc: 0.9107142686843872, corresponding to test acc:                         0.9175257682800293 / 0.9175257682800293
after epoch: 28,now: 2024-07-13 10:34:49.515087,epoch time: 0:10:03.723457,used: 4:43:55.589042,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_05_50_53_seed_0_21955595
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.99662423, 'precision': 0.98824275, 'recall': 0.97510195, 'specificity': 0.97510195, 'f1': 0.98157245, 'auroc': 0.9996741, 'binary_precision': 0.99750245, 'binary_recall': 0.9989522, 'binary_specificity': 0.9512516, 'binary_f1_score': 0.99822676}
confusion matrix:
      0      1
0  1444     74
1    31  29555
---- Validation: 
scalar performance:
{'acc': 0.89440995, 'precision': 0.8952769, 'recall': 0.89475834, 'specificity': 0.89475834, 'f1': 0.8943937, 'auroc': 0.94868267, 'binary_precision': 0.8729447, 'binary_recall': 0.91968507, 'binary_specificity': 0.86983156, 'binary_f1_score': 0.8957056}
confusion matrix:
     0    1
0  568   85
1   51  584
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.87216496, 'precision': 0.8707659, 'recall': 0.87523687, 'specificity': 0.87523687, 'f1': 0.8714957, 'auroc': 0.9333333, 'binary_precision': 0.916, 'binary_recall': 0.84814817, 'binary_specificity': 0.9023256, 'binary_f1_score': 0.88076925}
confusion matrix:
     0    1
0  194   21
1   41  229
early stop counter: 2
val acc:0.8944099545478821, best validation acc: 0.9107142686843872, corresponding to test acc:                         0.9175257682800293 / 0.9175257682800293
after epoch: 29,now: 2024-07-13 10:44:52.475741,epoch time: 0:10:02.960654,used: 4:53:58.549696,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_05_50_53_seed_0_21955595
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.9962706, 'precision': 0.9719249, 'recall': 0.9889839, 'specificity': 0.9889839, 'f1': 0.9802849, 'auroc': 0.99958205, 'binary_precision': 0.99901783, 'binary_recall': 0.99705935, 'binary_specificity': 0.9809085, 'binary_f1_score': 0.9980376}
confusion matrix:
      0      1
0  1490     29
1    87  29498
---- Validation: 
scalar performance:
{'acc': 0.91925466, 'precision': 0.91941357, 'recall': 0.9191304, 'specificity': 0.9191304, 'f1': 0.9192164, 'auroc': 0.95624554, 'binary_precision': 0.9248, 'binary_recall': 0.91023624, 'binary_specificity': 0.92802453, 'binary_f1_score': 0.91746026}
confusion matrix:
     0    1
0  606   47
1   57  578
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9030928, 'precision': 0.9059371, 'recall': 0.91059434, 'specificity': 0.91059434, 'f1': 0.9029591, 'auroc': 0.95614123, 'binary_precision': 0.9785408, 'binary_recall': 0.84444445, 'binary_specificity': 0.9767442, 'binary_f1_score': 0.90656066}
confusion matrix:
     0    1
0  210    5
1   42  228
better model found
persisted
after epoch: 30,now: 2024-07-13 10:54:54.567625,epoch time: 0:10:02.091884,used: 5:04:00.641580,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_05_50_53_seed_0_21955595
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 5:04:00.641580 at 2024-07-13 10:54:54.567625
persisted model performance metric: 

scalar performance:
{'acc': 0.9030928, 'precision': 0.9059371, 'recall': 0.91059434, 'specificity': 0.91059434, 'f1': 0.9029591, 'auroc': 0.95614123, 'binary_precision': 0.9785408, 'binary_recall': 0.84444445, 'binary_specificity': 0.9767442, 'binary_f1_score': 0.90656066}
confusion matrix:
     0    1
0  210    5
1   42  228
oracle model performance metric: 

scalar performance:
{'acc': 0.91752577, 'precision': 0.91934687, 'recall': 0.92450476, 'specificity': 0.92450476, 'f1': 0.91737086, 'auroc': 0.96013784, 'binary_precision': 0.9872881, 'binary_recall': 0.86296296, 'binary_specificity': 0.9860465, 'binary_f1_score': 0.9209486}
confusion matrix:
     0    1
0  212    3
1   37  233
results aggregation path: zoutput/benchmarks/CAMELYONWILD_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_halffreeze/rule_results/1.csv
results aggregation path: zoutput/benchmarks/CAMELYONWILD_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_halffreeze/rule_results/1.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONWILD_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_halffreeze/confusion_matrix/1.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 318782 KiB |   6782 MiB | 291711 GiB | 291711 GiB |
|       from large pool | 291597 KiB |   6756 MiB | 287048 GiB | 287047 GiB |
|       from small pool |  27185 KiB |     43 MiB |   4663 GiB |   4663 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 318782 KiB |   6782 MiB | 291711 GiB | 291711 GiB |
|       from large pool | 291597 KiB |   6756 MiB | 287048 GiB | 287047 GiB |
|       from small pool |  27185 KiB |     43 MiB |   4663 GiB |   4663 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 313851 KiB |   6778 MiB | 291498 GiB | 291497 GiB |
|       from large pool | 286862 KiB |   6752 MiB | 286845 GiB | 286844 GiB |
|       from small pool |  26989 KiB |     43 MiB |   4652 GiB |   4652 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   7454 MiB |   7454 MiB |   7454 MiB |      0 B   |
|       from large pool |   7404 MiB |   7404 MiB |   7404 MiB |      0 B   |
|       from small pool |     50 MiB |     50 MiB |     50 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory | 291521 KiB | 680184 KiB | 228749 GiB | 228749 GiB |
|       from large pool | 281843 KiB | 675647 KiB | 224080 GiB | 224079 GiB |
|       from small pool |   9678 KiB |  10779 KiB |   4669 GiB |   4669 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    1064    |    4635    |   59408 K  |   59407 K  |
|       from large pool |     130    |     756    |   27095 K  |   27095 K  |
|       from small pool |     934    |    4503    |   32313 K  |   32312 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    1064    |    4635    |   59408 K  |   59407 K  |
|       from large pool |     130    |     756    |   27095 K  |   27095 K  |
|       from small pool |     934    |    4503    |   32313 K  |   32312 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     334    |     334    |     334    |       0    |
|       from large pool |     309    |     309    |     309    |       0    |
|       from small pool |      25    |      25    |      25    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      78    |    1992    |   32505 K  |   32505 K  |
|       from large pool |      28    |     307    |   17750 K  |   17750 K  |
|       from small pool |      50    |    1965    |   14755 K  |   14755 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   6782 MiB | 291711 GiB | 291711 GiB |
|       from large pool |  16640 KiB |   6756 MiB | 287048 GiB | 287048 GiB |
|       from small pool |      0 KiB |     43 MiB |   4663 GiB |   4663 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   6782 MiB | 291711 GiB | 291711 GiB |
|       from large pool |  16640 KiB |   6756 MiB | 287048 GiB | 287048 GiB |
|       from small pool |      0 KiB |     43 MiB |   4663 GiB |   4663 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   6778 MiB | 291498 GiB | 291498 GiB |
|       from large pool |  16640 KiB |   6752 MiB | 286845 GiB | 286845 GiB |
|       from small pool |      0 KiB |     43 MiB |   4652 GiB |   4652 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 610304 KiB |   7454 MiB |   7454 MiB |   6858 MiB |
|       from large pool | 573440 KiB |   7404 MiB |   7404 MiB |   6844 MiB |
|       from small pool |  36864 KiB |     50 MiB |     50 MiB |     14 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 680184 KiB | 228749 GiB | 228749 GiB |
|       from large pool |  24320 KiB | 675647 KiB | 224080 GiB | 224080 GiB |
|       from small pool |      0 KiB |  32547 KiB |   4669 GiB |   4669 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    4635    |   59408 K  |   59408 K  |
|       from large pool |       2    |     756    |   27095 K  |   27095 K  |
|       from small pool |       0    |    4503    |   32313 K  |   32313 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    4635    |   59408 K  |   59408 K  |
|       from large pool |       2    |     756    |   27095 K  |   27095 K  |
|       from small pool |       0    |    4503    |   32313 K  |   32313 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      43    |     334    |     334    |     291    |
|       from large pool |      25    |     309    |     309    |     284    |
|       from small pool |      18    |      25    |      25    |       7    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    1992    |   32505 K  |   32505 K  |
|       from large pool |       3    |     307    |   17750 K  |   17750 K  |
|       from small pool |       0    |    1965    |   14755 K  |   14755 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   6782 MiB | 291711 GiB | 291711 GiB |
|       from large pool |  16640 KiB |   6756 MiB | 287048 GiB | 287048 GiB |
|       from small pool |      0 KiB |     43 MiB |   4663 GiB |   4663 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   6782 MiB | 291711 GiB | 291711 GiB |
|       from large pool |  16640 KiB |   6756 MiB | 287048 GiB | 287048 GiB |
|       from small pool |      0 KiB |     43 MiB |   4663 GiB |   4663 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   6778 MiB | 291498 GiB | 291498 GiB |
|       from large pool |  16640 KiB |   6752 MiB | 286845 GiB | 286845 GiB |
|       from small pool |      0 KiB |     43 MiB |   4652 GiB |   4652 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 610304 KiB |   7454 MiB |   7454 MiB |   6858 MiB |
|       from large pool | 573440 KiB |   7404 MiB |   7404 MiB |   6844 MiB |
|       from small pool |  36864 KiB |     50 MiB |     50 MiB |     14 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 680184 KiB | 228749 GiB | 228749 GiB |
|       from large pool |  24320 KiB | 675647 KiB | 224080 GiB | 224080 GiB |
|       from small pool |      0 KiB |  32547 KiB |   4669 GiB |   4669 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    4635    |   59408 K  |   59408 K  |
|       from large pool |       2    |     756    |   27095 K  |   27095 K  |
|       from small pool |       0    |    4503    |   32313 K  |   32313 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    4635    |   59408 K  |   59408 K  |
|       from large pool |       2    |     756    |   27095 K  |   27095 K  |
|       from small pool |       0    |    4503    |   32313 K  |   32313 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      43    |     334    |     334    |     291    |
|       from large pool |      25    |     309    |     309    |     284    |
|       from small pool |      18    |      25    |      25    |       7    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    1992    |   32505 K  |   32505 K  |
|       from large pool |       3    |     307    |   17750 K  |   17750 K  |
|       from small pool |       0    |    1965    |   14755 K  |   14755 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_11_08_26_seed_1_21955595

 Experiment start at: 2024-07-13 11:08:26.253097
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
before training, model accuracy: 0.6276150345802307
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.98276526, 'precision': 0.91513246, 'recall': 0.89487815, 'specificity': 0.89487815, 'f1': 0.9047208, 'auroc': 0.99229395, 'binary_precision': 0.9896551, 'binary_recall': 0.9922546, 'binary_specificity': 0.7975016, 'binary_f1_score': 0.9909531}
confusion matrix:
      0      1
0  1213    308
1   230  29465
---- Validation: 
scalar performance:
{'acc': 0.7314598, 'precision': 0.7766286, 'recall': 0.7347158, 'specificity': 0.7347158, 'f1': 0.72177494, 'auroc': 0.9072416, 'binary_precision': 0.66067415, 'binary_recall': 0.93333334, 'binary_specificity': 0.5360983, 'binary_f1_score': 0.77368426}
confusion matrix:
     0    1
0  349  302
1   42  588
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.73849374, 'precision': 0.81422925, 'recall': 0.7234519, 'specificity': 0.7234519, 'f1': 0.7127887, 'auroc': 0.9420465, 'binary_precision': 0.67391306, 'binary_recall': 0.9802371, 'binary_specificity': 0.46666667, 'binary_f1_score': 0.7987117}
confusion matrix:
     0    1
0  105  120
1    5  248
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-13 11:18:30.003812,epoch time: 0:10:03.750715,used: 0:10:03.750715,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_11_08_26_seed_1_21955595
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9877306, 'precision': 0.9156251, 'recall': 0.961738, 'specificity': 0.961738, 'f1': 0.93731225, 'auroc': 0.9956895, 'binary_precision': 0.99654424, 'binary_recall': 0.9905371, 'binary_specificity': 0.9329389, 'binary_f1_score': 0.99353164}
confusion matrix:
      0      1
0  1419    102
1   281  29414
---- Validation: 
scalar performance:
{'acc': 0.8462139, 'precision': 0.8501119, 'recall': 0.8470814, 'specificity': 0.8470814, 'f1': 0.8459792, 'auroc': 0.9249555, 'binary_precision': 0.8088445, 'binary_recall': 0.9, 'binary_specificity': 0.7941628, 'binary_f1_score': 0.851991}
confusion matrix:
     0    1
0  517  134
1   63  567
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8535565, 'precision': 0.8545664, 'recall': 0.8515766, 'specificity': 0.8515766, 'f1': 0.85252374, 'auroc': 0.9385859, 'binary_precision': 0.84528303, 'binary_recall': 0.8853755, 'binary_specificity': 0.81777775, 'binary_f1_score': 0.8648649}
confusion matrix:
     0    1
0  184   41
1   29  224
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-07-13 11:28:19.998028,epoch time: 0:09:49.994216,used: 0:19:53.744931,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_11_08_26_seed_1_21955595
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.99019736, 'precision': 0.96207255, 'recall': 0.92966187, 'specificity': 0.92966187, 'f1': 0.9452102, 'auroc': 0.9974525, 'binary_precision': 0.9929882, 'binary_recall': 0.9967334, 'binary_specificity': 0.8625904, 'binary_f1_score': 0.9948573}
confusion matrix:
      0      1
0  1312    209
1    97  29598
---- Validation: 
scalar performance:
{'acc': 0.7619048, 'precision': 0.8059113, 'recall': 0.764977, 'specificity': 0.764977, 'f1': 0.7543949, 'auroc': 0.91686964, 'binary_precision': 0.6857143, 'binary_recall': 0.95238096, 'binary_specificity': 0.57757294, 'binary_f1_score': 0.79734224}
confusion matrix:
     0    1
0  376  275
1   30  600
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.73221755, 'precision': 0.77291054, 'recall': 0.71998245, 'specificity': 0.71998245, 'f1': 0.7142056, 'auroc': 0.9314712, 'binary_precision': 0.68115944, 'binary_recall': 0.92885375, 'binary_specificity': 0.51111114, 'binary_f1_score': 0.78595316}
confusion matrix:
     0    1
0  115  110
1   18  235
early stop counter: 1
val acc:0.761904776096344, best validation acc: 0.8462138772010803, corresponding to test acc:                         0.8535565137863159 / 0.8535565137863159
after epoch: 3,now: 2024-07-13 11:38:08.323483,epoch time: 0:09:48.325455,used: 0:29:42.070386,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_11_08_26_seed_1_21955595
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.98827523, 'precision': 0.98128605, 'recall': 0.8895205, 'specificity': 0.8895205, 'f1': 0.93004847, 'auroc': 0.9980941, 'binary_precision': 0.98886627, 'binary_recall': 0.99892247, 'binary_specificity': 0.7801185, 'binary_f1_score': 0.99386895}
confusion matrix:
      0      1
0  1185    334
1    32  29665
---- Validation: 
scalar performance:
{'acc': 0.6846214, 'precision': 0.7886291, 'recall': 0.6894777, 'specificity': 0.6894777, 'f1': 0.65675426, 'auroc': 0.9331602, 'binary_precision': 0.6112205, 'binary_recall': 0.98571426, 'binary_specificity': 0.39324117, 'binary_f1_score': 0.7545565}
confusion matrix:
     0    1
0  256  395
1    9  621
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6841004, 'precision': 0.75946224, 'recall': 0.6671498, 'specificity': 0.6671498, 'f1': 0.6458999, 'auroc': 0.92799294, 'binary_precision': 0.63350785, 'binary_recall': 0.95652175, 'binary_specificity': 0.37777779, 'binary_f1_score': 0.76220477}
confusion matrix:
    0    1
0  85  140
1  11  242
early stop counter: 2
val acc:0.6846213936805725, best validation acc: 0.8462138772010803, corresponding to test acc:                         0.8535565137863159 / 0.8535565137863159
after epoch: 4,now: 2024-07-13 11:47:57.314405,epoch time: 0:09:48.990922,used: 0:39:31.061308,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_11_08_26_seed_1_21955595
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.99141467, 'precision': 0.93750846, 'recall': 0.9755263, 'specificity': 0.9755263, 'f1': 0.9556265, 'auroc': 0.998654, 'binary_precision': 0.99783456, 'binary_recall': 0.99313015, 'binary_specificity': 0.9579224, 'binary_f1_score': 0.99547684}
confusion matrix:
      0      1
0  1457     64
1   204  29491
---- Validation: 
scalar performance:
{'acc': 0.8540203, 'precision': 0.8554932, 'recall': 0.85455704, 'specificity': 0.85455704, 'f1': 0.8539691, 'auroc': 0.9267379, 'binary_precision': 0.8281481, 'binary_recall': 0.88730156, 'binary_specificity': 0.82181257, 'binary_f1_score': 0.856705}
confusion matrix:
     0    1
0  535  116
1   71  559
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8472803, 'precision': 0.84768164, 'recall': 0.8456478, 'specificity': 0.8456478, 'f1': 0.84635985, 'auroc': 0.9219499, 'binary_precision': 0.84351146, 'binary_recall': 0.8735178, 'binary_specificity': 0.81777775, 'binary_f1_score': 0.85825247}
confusion matrix:
     0    1
0  184   41
1   32  221
better model found
persisted
after epoch: 5,now: 2024-07-13 11:57:47.075314,epoch time: 0:09:49.760909,used: 0:49:20.822217,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_11_08_26_seed_1_21955595
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9931125, 'precision': 0.9769714, 'recall': 0.9474126, 'specificity': 0.9474126, 'f1': 0.9616656, 'auroc': 0.99853414, 'binary_precision': 0.9947305, 'binary_recall': 0.9980468, 'binary_specificity': 0.89677846, 'binary_f1_score': 0.9963859}
confusion matrix:
      0      1
0  1364    157
1    58  29637
---- Validation: 
scalar performance:
{'acc': 0.63544106, 'precision': 0.7794563, 'recall': 0.64124423, 'specificity': 0.64124423, 'f1': 0.58667743, 'auroc': 0.941749, 'binary_precision': 0.5747021, 'binary_recall': 0.99523807, 'binary_specificity': 0.28725037, 'binary_f1_score': 0.72864616}
confusion matrix:
     0    1
0  187  464
1    3  627
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.58995813, 'precision': 0.72825885, 'recall': 0.5654282, 'specificity': 0.5654282, 'f1': 0.48474383, 'auroc': 0.94086957, 'binary_precision': 0.56462586, 'binary_recall': 0.98418975, 'binary_specificity': 0.14666666, 'binary_f1_score': 0.71757925}
confusion matrix:
    0    1
0  33  192
1   4  249
early stop counter: 1
val acc:0.6354410648345947, best validation acc: 0.8540202975273132, corresponding to test acc:                         0.8472803235054016 / 0.8535565137863159
after epoch: 6,now: 2024-07-13 12:07:35.645202,epoch time: 0:09:48.569888,used: 0:59:09.392105,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_11_08_26_seed_1_21955595
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9884034, 'precision': 0.90796053, 'recall': 0.9854836, 'specificity': 0.9854836, 'f1': 0.9429066, 'auroc': 0.99902546, 'binary_precision': 0.99908125, 'binary_recall': 0.9887186, 'binary_specificity': 0.98224854, 'binary_f1_score': 0.99387294}
confusion matrix:
      0      1
0  1494     27
1   335  29360
---- Validation: 
scalar performance:
{'acc': 0.8657299, 'precision': 0.8685647, 'recall': 0.8664619, 'specificity': 0.8664619, 'f1': 0.86560535, 'auroc': 0.94003665, 'binary_precision': 0.8318841, 'binary_recall': 0.9111111, 'binary_specificity': 0.82181257, 'binary_f1_score': 0.869697}
confusion matrix:
     0    1
0  535  116
1   56  574
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8556485, 'precision': 0.85787034, 'recall': 0.8530611, 'specificity': 0.8530611, 'f1': 0.8543577, 'auroc': 0.93456304, 'binary_precision': 0.84074074, 'binary_recall': 0.8972332, 'binary_specificity': 0.8088889, 'binary_f1_score': 0.8680688}
confusion matrix:
     0    1
0  182   43
1   26  227
new oracle model saved
better model found
persisted
after epoch: 7,now: 2024-07-13 12:17:25.266507,epoch time: 0:09:49.621305,used: 1:08:59.013410,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_11_08_26_seed_1_21955595
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.990806, 'precision': 0.9721401, 'recall': 0.92623913, 'specificity': 0.92623913, 'f1': 0.9478845, 'auroc': 0.99805605, 'binary_precision': 0.9925963, 'binary_recall': 0.9977774, 'binary_specificity': 0.85470086, 'binary_f1_score': 0.99518013}
confusion matrix:
      0      1
0  1300    221
1    66  29629
---- Validation: 
scalar performance:
{'acc': 0.8266979, 'precision': 0.8486893, 'recall': 0.8287506, 'specificity': 0.8287506, 'f1': 0.82451105, 'auroc': 0.9395393, 'binary_precision': 0.75692695, 'binary_recall': 0.9539682, 'binary_specificity': 0.70353305, 'binary_f1_score': 0.84410113}
confusion matrix:
     0    1
0  458  193
1   29  601
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.84309626, 'precision': 0.8509069, 'recall': 0.838498, 'specificity': 0.838498, 'f1': 0.8404987, 'auroc': 0.9394642, 'binary_precision': 0.8111888, 'binary_recall': 0.91699606, 'binary_specificity': 0.76, 'binary_f1_score': 0.86085343}
confusion matrix:
     0    1
0  171   54
1   21  232
early stop counter: 1
val acc:0.8266978859901428, best validation acc: 0.8657299280166626, corresponding to test acc:                         0.8556485176086426 / 0.8556485176086426
after epoch: 8,now: 2024-07-13 12:27:16.015725,epoch time: 0:09:50.749218,used: 1:18:49.762628,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_11_08_26_seed_1_21955595
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9933047, 'precision': 0.9656384, 'recall': 0.9618608, 'specificity': 0.9618608, 'f1': 0.96374094, 'auroc': 0.99856865, 'binary_precision': 0.9962636, 'binary_recall': 0.9966998, 'binary_specificity': 0.9270217, 'binary_f1_score': 0.99648166}
confusion matrix:
      0      1
0  1410    111
1    98  29597
---- Validation: 
scalar performance:
{'acc': 0.85480094, 'precision': 0.85757005, 'recall': 0.8555299, 'specificity': 0.8555299, 'f1': 0.85466623, 'auroc': 0.9310633, 'binary_precision': 0.82173914, 'binary_recall': 0.9, 'binary_specificity': 0.8110599, 'binary_f1_score': 0.8590909}
confusion matrix:
     0    1
0  528  123
1   63  567
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8577406, 'precision': 0.85833114, 'recall': 0.85946417, 'specificity': 0.85946417, 'f1': 0.8576783, 'auroc': 0.92722005, 'binary_precision': 0.89361703, 'binary_recall': 0.8300395, 'binary_specificity': 0.8888889, 'binary_f1_score': 0.8606557}
confusion matrix:
     0    1
0  200   25
1   43  210
new oracle model saved
early stop counter: 2
val acc:0.8548009395599365, best validation acc: 0.8657299280166626, corresponding to test acc:                         0.8556485176086426 / 0.857740581035614
after epoch: 9,now: 2024-07-13 12:37:05.933231,epoch time: 0:09:49.917506,used: 1:28:39.680134,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_11_08_26_seed_1_21955595
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.99349695, 'precision': 0.95112205, 'recall': 0.98223484, 'specificity': 0.98223484, 'f1': 0.96609616, 'auroc': 0.9990429, 'binary_precision': 0.9984451, 'binary_recall': 0.9947129, 'binary_specificity': 0.9697567, 'binary_f1_score': 0.9965755}
confusion matrix:
      0      1
0  1475     46
1   157  29538
---- Validation: 
scalar performance:
{'acc': 0.87431693, 'precision': 0.8757002, 'recall': 0.8748336, 'specificity': 0.8748336, 'f1': 0.87427986, 'auroc': 0.9383147, 'binary_precision': 0.8484398, 'binary_recall': 0.9063492, 'binary_specificity': 0.843318, 'binary_f1_score': 0.876439}
confusion matrix:
     0    1
0  549  102
1   59  571
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.86820084, 'precision': 0.8678912, 'recall': 0.8690997, 'specificity': 0.8690997, 'f1': 0.8680339, 'auroc': 0.93199825, 'binary_precision': 0.892562, 'binary_recall': 0.85375494, 'binary_specificity': 0.8844444, 'binary_f1_score': 0.8727272}
confusion matrix:
     0    1
0  199   26
1   37  216
new oracle model saved
better model found
persisted
after epoch: 10,now: 2024-07-13 12:46:55.659834,epoch time: 0:09:49.726603,used: 1:38:29.406737,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_11_08_26_seed_1_21955595
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9940415, 'precision': 0.97259516, 'recall': 0.96255994, 'specificity': 0.96255994, 'f1': 0.96751744, 'auroc': 0.99866426, 'binary_precision': 0.9962999, 'binary_recall': 0.99744064, 'binary_specificity': 0.9276792, 'binary_f1_score': 0.99687}
confusion matrix:
      0      1
0  1411    110
1    76  29619
---- Validation: 
scalar performance:
{'acc': 0.7892272, 'precision': 0.8300724, 'recall': 0.7920891, 'specificity': 0.7920891, 'f1': 0.7835759, 'auroc': 0.9435423, 'binary_precision': 0.7097902, 'binary_recall': 0.96666664, 'binary_specificity': 0.6175115, 'binary_f1_score': 0.8185483}
confusion matrix:
     0    1
0  402  249
1   21  609
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8012552, 'precision': 0.8208717, 'recall': 0.7935617, 'specificity': 0.7935617, 'f1': 0.79476535, 'auroc': 0.93352664, 'binary_precision': 0.7548387, 'binary_recall': 0.9249012, 'binary_specificity': 0.6622222, 'binary_f1_score': 0.8312611}
confusion matrix:
     0    1
0  149   76
1   19  234
early stop counter: 1
val acc:0.7892271876335144, best validation acc: 0.874316930770874, corresponding to test acc:                         0.8682008385658264 / 0.8682008385658264
after epoch: 11,now: 2024-07-13 12:56:44.188246,epoch time: 0:09:48.528412,used: 1:48:17.935149,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_11_08_26_seed_1_21955595
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9950346, 'precision': 0.9711515, 'recall': 0.97555757, 'specificity': 0.97555757, 'f1': 0.973343, 'auroc': 0.99938786, 'binary_precision': 0.9976415, 'binary_recall': 0.99713755, 'binary_specificity': 0.95397764, 'binary_f1_score': 0.99738944}
confusion matrix:
      0      1
0  1451     70
1    85  29610
---- Validation: 
scalar performance:
{'acc': 0.8735363, 'precision': 0.877313, 'recall': 0.8743727, 'specificity': 0.8743727, 'f1': 0.8733658, 'auroc': 0.9450741, 'binary_precision': 0.8352436, 'binary_recall': 0.9253968, 'binary_specificity': 0.8233487, 'binary_f1_score': 0.87801206}
confusion matrix:
     0    1
0  536  115
1   47  583
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8619247, 'precision': 0.8615844, 'recall': 0.8612033, 'specificity': 0.8612033, 'f1': 0.86137867, 'auroc': 0.9388142, 'binary_precision': 0.8666667, 'binary_recall': 0.8735178, 'binary_specificity': 0.8488889, 'binary_f1_score': 0.87007874}
confusion matrix:
     0    1
0  191   34
1   32  221
early stop counter: 2
val acc:0.8735362887382507, best validation acc: 0.874316930770874, corresponding to test acc:                         0.8682008385658264 / 0.8682008385658264
after epoch: 12,now: 2024-07-13 13:06:34.537664,epoch time: 0:09:50.349418,used: 1:58:08.284567,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_11_08_26_seed_1_21955595
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.99384934, 'precision': 0.96844244, 'recall': 0.964932, 'specificity': 0.964932, 'f1': 0.9666799, 'auroc': 0.9989565, 'binary_precision': 0.9965666, 'binary_recall': 0.9969693, 'binary_specificity': 0.93289477, 'binary_f1_score': 0.99676794}
confusion matrix:
      0      1
0  1418    102
1    90  29606
---- Validation: 
scalar performance:
{'acc': 0.86260736, 'precision': 0.8648469, 'recall': 0.86326164, 'specificity': 0.86326164, 'f1': 0.86251605, 'auroc': 0.93457437, 'binary_precision': 0.83187133, 'binary_recall': 0.9031746, 'binary_specificity': 0.8233487, 'binary_f1_score': 0.8660578}
confusion matrix:
     0    1
0  536  115
1   61  569
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8389121, 'precision': 0.83879554, 'recall': 0.83995605, 'specificity': 0.83995605, 'f1': 0.83875334, 'auroc': 0.9276241, 'binary_precision': 0.8666667, 'binary_recall': 0.8221344, 'binary_specificity': 0.8577778, 'binary_f1_score': 0.8438134}
confusion matrix:
     0    1
0  193   32
1   45  208
early stop counter: 3
val acc:0.8626073598861694, best validation acc: 0.874316930770874, corresponding to test acc:                         0.8682008385658264 / 0.8682008385658264
after epoch: 13,now: 2024-07-13 13:16:24.581753,epoch time: 0:09:50.044089,used: 2:07:58.328656,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_11_08_26_seed_1_21955595
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9945861, 'precision': 0.98449576, 'recall': 0.95629644, 'specificity': 0.95629644, 'f1': 0.96992564, 'auroc': 0.99937785, 'binary_precision': 0.99560225, 'binary_recall': 0.99872035, 'binary_specificity': 0.9138725, 'binary_f1_score': 0.9971589}
confusion matrix:
      0      1
0  1390    131
1    38  29657
---- Validation: 
scalar performance:
{'acc': 0.8376269, 'precision': 0.8547467, 'recall': 0.8394265, 'specificity': 0.8394265, 'f1': 0.8361159, 'auroc': 0.9461835, 'binary_precision': 0.77260983, 'binary_recall': 0.94920635, 'binary_specificity': 0.7296467, 'binary_f1_score': 0.8518518}
confusion matrix:
     0    1
0  475  176
1   32  598
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8556485, 'precision': 0.8604676, 'recall': 0.8520773, 'specificity': 0.8520773, 'f1': 0.8538518, 'auroc': 0.949126, 'binary_precision': 0.83093524, 'binary_recall': 0.9130435, 'binary_specificity': 0.7911111, 'binary_f1_score': 0.8700565}
confusion matrix:
     0    1
0  178   47
1   22  231
early stop counter: 4
val acc:0.8376268744468689, best validation acc: 0.874316930770874, corresponding to test acc:                         0.8682008385658264 / 0.8682008385658264
after epoch: 14,now: 2024-07-13 13:26:15.911660,epoch time: 0:09:51.329907,used: 2:17:49.658563,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_11_08_26_seed_1_21955595
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.98340595, 'precision': 0.98998886, 'recall': 0.83065295, 'specificity': 0.83065295, 'f1': 0.89330477, 'auroc': 0.99928, 'binary_precision': 0.982951, 'binary_recall': 0.99989897, 'binary_specificity': 0.661407, 'binary_f1_score': 0.99135256}
confusion matrix:
      0      1
0  1006    515
1     3  29692
---- Validation: 
scalar performance:
{'acc': 0.6916472, 'precision': 0.79680204, 'recall': 0.696467, 'specificity': 0.696467, 'f1': 0.6648855, 'auroc': 0.943635, 'binary_precision': 0.6159921, 'binary_recall': 0.9904762, 'binary_specificity': 0.40245774, 'binary_f1_score': 0.75958616}
confusion matrix:
     0    1
0  262  389
1    6  624
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6757322, 'precision': 0.7705161, 'recall': 0.6572771, 'specificity': 0.6572771, 'f1': 0.62940735, 'auroc': 0.94863415, 'binary_precision': 0.6243655, 'binary_recall': 0.972332, 'binary_specificity': 0.3422222, 'binary_f1_score': 0.7604328}
confusion matrix:
    0    1
0  77  148
1   7  246
early stop counter: 5
val acc:0.6916471719741821, best validation acc: 0.874316930770874, corresponding to test acc:                         0.8682008385658264 / 0.8682008385658264
after epoch: 15,now: 2024-07-13 13:36:06.085191,epoch time: 0:09:50.173531,used: 2:27:39.832094,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_11_08_26_seed_1_21955595
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9945861, 'precision': 0.95614505, 'recall': 0.9887333, 'specificity': 0.9887333, 'f1': 0.97180855, 'auroc': 0.9995619, 'binary_precision': 0.9990872, 'binary_recall': 0.99521804, 'binary_specificity': 0.98224854, 'binary_f1_score': 0.9971489}
confusion matrix:
      0      1
0  1494     27
1   142  29553
---- Validation: 
scalar performance:
{'acc': 0.8735363, 'precision': 0.8753027, 'recall': 0.8741167, 'specificity': 0.8741167, 'f1': 0.8734801, 'auroc': 0.94141614, 'binary_precision': 0.84513277, 'binary_recall': 0.9095238, 'binary_specificity': 0.83870965, 'binary_f1_score': 0.8761468}
confusion matrix:
     0    1
0  546  105
1   57  573
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8535565, 'precision': 0.8529757, 'recall': 0.8532982, 'specificity': 0.8532982, 'f1': 0.8531219, 'auroc': 0.92795783, 'binary_precision': 0.8645418, 'binary_recall': 0.8577075, 'binary_specificity': 0.8488889, 'binary_f1_score': 0.8611111}
confusion matrix:
     0    1
0  191   34
1   36  217
early stop counter: 6
val acc:0.8735362887382507, best validation acc: 0.874316930770874, corresponding to test acc:                         0.8682008385658264 / 0.8682008385658264
after epoch: 16,now: 2024-07-13 13:45:55.633603,epoch time: 0:09:49.548412,used: 2:37:29.380506,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_11_08_26_seed_1_21955595
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9957714, 'precision': 0.971678, 'recall': 0.98343027, 'specificity': 0.98343027, 'f1': 0.97747326, 'auroc': 0.99958897, 'binary_precision': 0.99844885, 'binary_recall': 0.99710387, 'binary_specificity': 0.9697567, 'binary_f1_score': 0.99777585}
confusion matrix:
      0      1
0  1475     46
1    86  29609
---- Validation: 
scalar performance:
{'acc': 0.85323966, 'precision': 0.86289656, 'recall': 0.85458267, 'specificity': 0.85458267, 'f1': 0.85255957, 'auroc': 0.9416094, 'binary_precision': 0.79945797, 'binary_recall': 0.93650794, 'binary_specificity': 0.77265745, 'binary_f1_score': 0.862573}
confusion matrix:
     0    1
0  503  148
1   40  590
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8786611, 'precision': 0.88223, 'recall': 0.8757839, 'specificity': 0.8757839, 'f1': 0.8774251, 'auroc': 0.94093984, 'binary_precision': 0.85714287, 'binary_recall': 0.9249012, 'binary_specificity': 0.82666665, 'binary_f1_score': 0.88973385}
confusion matrix:
     0    1
0  186   39
1   19  234
new oracle model saved
early stop counter: 7
val acc:0.8532396554946899, best validation acc: 0.874316930770874, corresponding to test acc:                         0.8682008385658264 / 0.8786610960960388
after epoch: 17,now: 2024-07-13 13:55:45.597241,epoch time: 0:09:49.963638,used: 2:47:19.344144,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_11_08_26_seed_1_21955595
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9951627, 'precision': 0.96471685, 'recall': 0.98466986, 'specificity': 0.98466986, 'f1': 0.9744585, 'auroc': 0.9995043, 'binary_precision': 0.9986161, 'binary_recall': 0.9962957, 'binary_specificity': 0.97304404, 'binary_f1_score': 0.9974545}
confusion matrix:
      0      1
0  1480     41
1   110  29585
---- Validation: 
scalar performance:
{'acc': 0.8844653, 'precision': 0.8845215, 'recall': 0.8846134, 'specificity': 0.8846134, 'f1': 0.88446176, 'auroc': 0.945527, 'binary_precision': 0.8742236, 'binary_recall': 0.89365077, 'binary_specificity': 0.875576, 'binary_f1_score': 0.8838304}
confusion matrix:
     0    1
0  570   81
1   67  563
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8640167, 'precision': 0.8651878, 'recall': 0.8661308, 'specificity': 0.8661308, 'f1': 0.86398757, 'auroc': 0.9289416, 'binary_precision': 0.9051724, 'binary_recall': 0.8300395, 'binary_specificity': 0.9022222, 'binary_f1_score': 0.8659794}
confusion matrix:
     0    1
0  203   22
1   43  210
better model found
persisted
after epoch: 18,now: 2024-07-13 14:05:33.526052,epoch time: 0:09:47.928811,used: 2:57:07.272955,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_11_08_26_seed_1_21955595
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9967325, 'precision': 0.9930306, 'recall': 0.97140384, 'specificity': 0.97140384, 'f1': 0.9819475, 'auroc': 0.9996908, 'binary_precision': 0.99711096, 'binary_recall': 0.99946123, 'binary_specificity': 0.9433465, 'binary_f1_score': 0.9982847}
confusion matrix:
      0      1
0  1432     86
1    16  29682
---- Validation: 
scalar performance:
{'acc': 0.83138174, 'precision': 0.85249937, 'recall': 0.8333845, 'specificity': 0.8333845, 'f1': 0.82937276, 'auroc': 0.9486376, 'binary_precision': 0.7620253, 'binary_recall': 0.95555556, 'binary_specificity': 0.7112135, 'binary_f1_score': 0.84788734}
confusion matrix:
     0    1
0  463  188
1   28  602
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.85983264, 'precision': 0.8716122, 'recall': 0.8545543, 'specificity': 0.8545543, 'f1': 0.8570236, 'auroc': 0.935863, 'binary_precision': 0.8184931, 'binary_recall': 0.94466406, 'binary_specificity': 0.7644445, 'binary_f1_score': 0.8770642}
confusion matrix:
     0    1
0  172   53
1   14  239
early stop counter: 1
val acc:0.8313817381858826, best validation acc: 0.8844652771949768, corresponding to test acc:                         0.8640167117118835 / 0.8786610960960388
after epoch: 19,now: 2024-07-13 14:15:22.631013,epoch time: 0:09:49.104961,used: 3:06:56.377916,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_11_08_26_seed_1_21955595
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.99570733, 'precision': 0.9713408, 'recall': 0.98308474, 'specificity': 0.98308474, 'f1': 0.97713196, 'auroc': 0.9991926, 'binary_precision': 0.9984151, 'binary_recall': 0.9970702, 'binary_specificity': 0.9690993, 'binary_f1_score': 0.9977422}
confusion matrix:
      0      1
0  1474     47
1    87  29608
---- Validation: 
scalar performance:
{'acc': 0.8735363, 'precision': 0.877313, 'recall': 0.8743727, 'specificity': 0.8743727, 'f1': 0.8733658, 'auroc': 0.94964707, 'binary_precision': 0.8352436, 'binary_recall': 0.9253968, 'binary_specificity': 0.8233487, 'binary_f1_score': 0.87801206}
confusion matrix:
     0    1
0  536  115
1   47  583
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.87656903, 'precision': 0.8760886, 'recall': 0.876267, 'specificity': 0.876267, 'f1': 0.876174, 'auroc': 0.94283706, 'binary_precision': 0.88492066, 'binary_recall': 0.88142294, 'binary_specificity': 0.8711111, 'binary_f1_score': 0.88316834}
confusion matrix:
     0    1
0  196   29
1   30  223
early stop counter: 2
val acc:0.8735362887382507, best validation acc: 0.8844652771949768, corresponding to test acc:                         0.8640167117118835 / 0.8786610960960388
after epoch: 20,now: 2024-07-13 14:25:12.126993,epoch time: 0:09:49.495980,used: 3:16:45.873896,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_11_08_26_seed_1_21955595
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.99564326, 'precision': 0.9699399, 'recall': 0.98398674, 'specificity': 0.98398674, 'f1': 0.97684765, 'auroc': 0.99948967, 'binary_precision': 0.99851584, 'binary_recall': 0.9969018, 'binary_specificity': 0.97107166, 'binary_f1_score': 0.9977082}
confusion matrix:
      0      1
0  1477     44
1    92  29603
---- Validation: 
scalar performance:
{'acc': 0.8985168, 'precision': 0.89857346, 'recall': 0.8986687, 'specificity': 0.8986687, 'f1': 0.8985138, 'auroc': 0.9483652, 'binary_precision': 0.88819873, 'binary_recall': 0.9079365, 'binary_specificity': 0.8894009, 'binary_f1_score': 0.89795923}
confusion matrix:
     0    1
0  579   72
1   58  572
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8870293, 'precision': 0.8889357, 'recall': 0.8895916, 'specificity': 0.8895916, 'f1': 0.8870214, 'auroc': 0.9385507, 'binary_precision': 0.93449783, 'binary_recall': 0.8458498, 'binary_specificity': 0.93333334, 'binary_f1_score': 0.8879668}
confusion matrix:
     0    1
0  210   15
1   39  214
new oracle model saved
better model found
persisted
after epoch: 21,now: 2024-07-13 14:34:58.630004,epoch time: 0:09:46.503011,used: 3:26:32.376907,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_11_08_26_seed_1_21955595
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9964441, 'precision': 0.9887444, 'recall': 0.97255576, 'specificity': 0.97255576, 'f1': 0.98049825, 'auroc': 0.9995639, 'binary_precision': 0.9972435, 'binary_recall': 0.9990234, 'binary_specificity': 0.9460881, 'binary_f1_score': 0.9981327}
confusion matrix:
      0      1
0  1439     82
1    29  29666
---- Validation: 
scalar performance:
{'acc': 0.8306011, 'precision': 0.85494304, 'recall': 0.8327445, 'specificity': 0.8327445, 'f1': 0.82824606, 'auroc': 0.94584894, 'binary_precision': 0.7578027, 'binary_recall': 0.96349204, 'binary_specificity': 0.7019969, 'binary_f1_score': 0.84835774}
confusion matrix:
     0    1
0  457  194
1   23  607
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.85146445, 'precision': 0.8628112, 'recall': 0.8461572, 'specificity': 0.8461572, 'f1': 0.84848773, 'auroc': 0.9427843, 'binary_precision': 0.81164384, 'binary_recall': 0.9367589, 'binary_specificity': 0.75555557, 'binary_f1_score': 0.8697248}
confusion matrix:
     0    1
0  170   55
1   16  237
early stop counter: 1
val acc:0.8306010961532593, best validation acc: 0.8985167741775513, corresponding to test acc:                         0.8870292901992798 / 0.8870292901992798
after epoch: 22,now: 2024-07-13 14:44:43.402255,epoch time: 0:09:44.772251,used: 3:36:17.149158,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_11_08_26_seed_1_21955595
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.99506664, 'precision': 0.95940256, 'recall': 0.9902334, 'specificity': 0.9902334, 'f1': 0.9742567, 'auroc': 0.99955535, 'binary_precision': 0.99922264, 'binary_recall': 0.9955885, 'binary_specificity': 0.98487836, 'binary_f1_score': 0.9974023}
confusion matrix:
      0      1
0  1498     23
1   131  29564
---- Validation: 
scalar performance:
{'acc': 0.8516784, 'precision': 0.8609244, 'recall': 0.8529954, 'specificity': 0.8529954, 'f1': 0.8510225, 'auroc': 0.9203204, 'binary_precision': 0.79891306, 'binary_recall': 0.93333334, 'binary_specificity': 0.77265745, 'binary_f1_score': 0.8609078}
confusion matrix:
     0    1
0  503  148
1   42  588
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8410042, 'precision': 0.8411992, 'recall': 0.839473, 'specificity': 0.839473, 'f1': 0.8400972, 'auroc': 0.88815105, 'binary_precision': 0.83908045, 'binary_recall': 0.8656126, 'binary_specificity': 0.81333333, 'binary_f1_score': 0.85214007}
confusion matrix:
     0    1
0  183   42
1   34  219
early stop counter: 2
val acc:0.8516783714294434, best validation acc: 0.8985167741775513, corresponding to test acc:                         0.8870292901992798 / 0.8870292901992798
after epoch: 23,now: 2024-07-13 14:54:29.334315,epoch time: 0:09:45.932060,used: 3:46:03.081218,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_11_08_26_seed_1_21955595
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.99686056, 'precision': 0.98191047, 'recall': 0.9843147, 'specificity': 0.9843147, 'f1': 0.9831093, 'auroc': 0.9997043, 'binary_precision': 0.9984842, 'binary_recall': 0.9982152, 'binary_specificity': 0.9704142, 'binary_f1_score': 0.99834967}
confusion matrix:
      0      1
0  1476     45
1    53  29642
---- Validation: 
scalar performance:
{'acc': 0.891491, 'precision': 0.8929186, 'recall': 0.8920123, 'specificity': 0.8920123, 'f1': 0.89145905, 'auroc': 0.95267355, 'binary_precision': 0.86478454, 'binary_recall': 0.9238095, 'binary_specificity': 0.86021507, 'binary_f1_score': 0.8933231}
confusion matrix:
     0    1
0  560   91
1   48  582
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9079498, 'precision': 0.90781677, 'recall': 0.9073869, 'specificity': 0.9073869, 'f1': 0.9075858, 'auroc': 0.95144486, 'binary_precision': 0.9098039, 'binary_recall': 0.91699606, 'binary_specificity': 0.8977778, 'binary_f1_score': 0.91338587}
confusion matrix:
     0    1
0  202   23
1   21  232
new oracle model saved
early stop counter: 3
val acc:0.8914909958839417, best validation acc: 0.8985167741775513, corresponding to test acc:                         0.8870292901992798 / 0.9079498052597046
after epoch: 24,now: 2024-07-13 15:04:17.316427,epoch time: 0:09:47.982112,used: 3:55:51.063330,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_11_08_26_seed_1_21955595
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.99442595, 'precision': 0.9905428, 'recall': 0.9487268, 'specificity': 0.9487268, 'f1': 0.9686004, 'auroc': 0.99963707, 'binary_precision': 0.9948041, 'binary_recall': 0.99936014, 'binary_specificity': 0.89809334, 'binary_f1_score': 0.9970769}
confusion matrix:
      0      1
0  1366    155
1    19  29676
---- Validation: 
scalar performance:
{'acc': 0.8235753, 'precision': 0.8550674, 'recall': 0.8260113, 'specificity': 0.8260113, 'f1': 0.82029784, 'auroc': 0.9536464, 'binary_precision': 0.7451456, 'binary_recall': 0.9746032, 'binary_specificity': 0.67741936, 'binary_f1_score': 0.8445667}
confusion matrix:
     0    1
0  441  210
1   16  614
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.84309626, 'precision': 0.8590075, 'recall': 0.8367765, 'specificity': 0.8367765, 'f1': 0.83913594, 'auroc': 0.9438032, 'binary_precision': 0.7966667, 'binary_recall': 0.94466406, 'binary_specificity': 0.72888887, 'binary_f1_score': 0.8643761}
confusion matrix:
     0    1
0  164   61
1   14  239
early stop counter: 4
val acc:0.8235753178596497, best validation acc: 0.8985167741775513, corresponding to test acc:                         0.8870292901992798 / 0.9079498052597046
after epoch: 25,now: 2024-07-13 15:14:03.820875,epoch time: 0:09:46.504448,used: 4:05:37.567778,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_11_08_26_seed_1_21955595
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.99593157, 'precision': 0.97292554, 'recall': 0.9838264, 'specificity': 0.9838264, 'f1': 0.97830653, 'auroc': 0.99959326, 'binary_precision': 0.9984827, 'binary_recall': 0.9972386, 'binary_specificity': 0.9704142, 'binary_f1_score': 0.9978602}
confusion matrix:
      0      1
0  1476     45
1    82  29613
---- Validation: 
scalar performance:
{'acc': 0.8985168, 'precision': 0.8996054, 'recall': 0.89897597, 'specificity': 0.89897597, 'f1': 0.89849883, 'auroc': 0.9538341, 'binary_precision': 0.8742515, 'binary_recall': 0.92698413, 'binary_specificity': 0.87096775, 'binary_f1_score': 0.89984584}
confusion matrix:
     0    1
0  567   84
1   46  584
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9016736, 'precision': 0.90180326, 'recall': 0.90317965, 'specificity': 0.90317965, 'f1': 0.9016009, 'auroc': 0.9525516, 'binary_precision': 0.9327731, 'binary_recall': 0.8774704, 'binary_specificity': 0.9288889, 'binary_f1_score': 0.904277}
confusion matrix:
     0    1
0  209   16
1   31  222
early stop counter: 5
val acc:0.8985167741775513, best validation acc: 0.8985167741775513, corresponding to test acc:                         0.8870292901992798 / 0.9079498052597046
after epoch: 26,now: 2024-07-13 15:23:49.997397,epoch time: 0:09:46.176522,used: 4:15:23.744300,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_11_08_26_seed_1_21955595
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.9952909, 'precision': 0.96535814, 'recall': 0.98535264, 'specificity': 0.98535264, 'f1': 0.97511995, 'auroc': 0.9995775, 'binary_precision': 0.99868363, 'binary_recall': 0.99636316, 'binary_specificity': 0.9743421, 'binary_f1_score': 0.997522}
confusion matrix:
      0      1
0  1481     39
1   108  29588
---- Validation: 
scalar performance:
{'acc': 0.90163934, 'precision': 0.9017904, 'recall': 0.9018433, 'specificity': 0.9018433, 'f1': 0.90163875, 'auroc': 0.9516324, 'binary_precision': 0.8888889, 'binary_recall': 0.9142857, 'binary_specificity': 0.8894009, 'binary_f1_score': 0.90140843}
confusion matrix:
     0    1
0  579   72
1   54  576
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8786611, 'precision': 0.8800673, 'recall': 0.88094866, 'specificity': 0.88094866, 'f1': 0.87864196, 'auroc': 0.9401493, 'binary_precision': 0.9220779, 'binary_recall': 0.84189725, 'binary_specificity': 0.92, 'binary_f1_score': 0.8801653}
confusion matrix:
     0    1
0  207   18
1   40  213
better model found
persisted
after epoch: 27,now: 2024-07-13 15:33:36.350640,epoch time: 0:09:46.353243,used: 4:25:10.097543,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_11_08_26_seed_1_21955595
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.9960597, 'precision': 0.9709081, 'recall': 0.9876294, 'specificity': 0.9876294, 'f1': 0.9791056, 'auroc': 0.99965656, 'binary_precision': 0.9988866, 'binary_recall': 0.9969693, 'binary_specificity': 0.9782895, 'binary_f1_score': 0.99792707}
confusion matrix:
      0      1
0  1487     33
1    90  29606
---- Validation: 
scalar performance:
{'acc': 0.8883685, 'precision': 0.88843447, 'recall': 0.8882488, 'specificity': 0.8882488, 'f1': 0.8883151, 'auroc': 0.9484359, 'binary_precision': 0.8908507, 'binary_recall': 0.88095236, 'binary_specificity': 0.8955453, 'binary_f1_score': 0.8858739}
confusion matrix:
     0    1
0  583   68
1   75  555
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8702929, 'precision': 0.877036, 'recall': 0.8745191, 'specificity': 0.8745191, 'f1': 0.8702361, 'auroc': 0.9381291, 'binary_precision': 0.94418603, 'binary_recall': 0.80237156, 'binary_specificity': 0.94666666, 'binary_f1_score': 0.8675214}
confusion matrix:
     0    1
0  213   12
1   50  203
early stop counter: 1
val acc:0.8883684873580933, best validation acc: 0.9016393423080444, corresponding to test acc:                         0.8786610960960388 / 0.9079498052597046
after epoch: 28,now: 2024-07-13 15:43:20.954021,epoch time: 0:09:44.603381,used: 4:34:54.700924,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_11_08_26_seed_1_21955595
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9966043, 'precision': 0.9901062, 'recall': 0.9729518, 'specificity': 0.9729518, 'f1': 0.98135895, 'auroc': 0.99974585, 'binary_precision': 0.9972774, 'binary_recall': 0.9991581, 'binary_specificity': 0.9467456, 'binary_f1_score': 0.99821687}
confusion matrix:
      0      1
0  1440     81
1    25  29670
---- Validation: 
scalar performance:
{'acc': 0.8306011, 'precision': 0.8531252, 'recall': 0.8326677, 'specificity': 0.8326677, 'f1': 0.8284331, 'auroc': 0.94274986, 'binary_precision': 0.7597484, 'binary_recall': 0.95873016, 'binary_specificity': 0.7066052, 'binary_f1_score': 0.8477193}
confusion matrix:
     0    1
0  460  191
1   26  604
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8158996, 'precision': 0.8377265, 'recall': 0.8081335, 'specificity': 0.8081335, 'f1': 0.8097409, 'auroc': 0.919473, 'binary_precision': 0.76527333, 'binary_recall': 0.94071144, 'binary_specificity': 0.6755555, 'binary_f1_score': 0.8439716}
confusion matrix:
     0    1
0  152   73
1   15  238
early stop counter: 2
val acc:0.8306010961532593, best validation acc: 0.9016393423080444, corresponding to test acc:                         0.8786610960960388 / 0.9079498052597046
after epoch: 29,now: 2024-07-13 15:53:05.542964,epoch time: 0:09:44.588943,used: 4:44:39.289867,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_11_08_26_seed_1_21955595
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.99721295, 'precision': 0.98221934, 'recall': 0.9879308, 'specificity': 0.9879308, 'f1': 0.9850563, 'auroc': 0.99978435, 'binary_precision': 0.9988543, 'binary_recall': 0.9982152, 'binary_specificity': 0.9776463, 'binary_f1_score': 0.9985346}
confusion matrix:
      0      1
0  1487     34
1    53  29642
---- Validation: 
scalar performance:
{'acc': 0.89617485, 'precision': 0.8976145, 'recall': 0.8966974, 'specificity': 0.8966974, 'f1': 0.8961443, 'auroc': 0.9528905, 'binary_precision': 0.8692422, 'binary_recall': 0.9285714, 'binary_specificity': 0.86482334, 'binary_f1_score': 0.8979278}
confusion matrix:
     0    1
0  563   88
1   45  585
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8849372, 'precision': 0.88569057, 'recall': 0.88343436, 'specificity': 0.88343436, 'f1': 0.8842437, 'auroc': 0.9410453, 'binary_precision': 0.8778626, 'binary_recall': 0.90909094, 'binary_specificity': 0.8577778, 'binary_f1_score': 0.8932039}
confusion matrix:
     0    1
0  193   32
1   23  230
early stop counter: 3
val acc:0.8961748480796814, best validation acc: 0.9016393423080444, corresponding to test acc:                         0.8786610960960388 / 0.9079498052597046
after epoch: 30,now: 2024-07-13 16:02:56.724260,epoch time: 0:09:51.181296,used: 4:54:30.471163,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_11_08_26_seed_1_21955595
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 4:54:30.471163 at 2024-07-13 16:02:56.724260
persisted model performance metric: 

scalar performance:
{'acc': 0.8786611, 'precision': 0.8800673, 'recall': 0.88094866, 'specificity': 0.88094866, 'f1': 0.87864196, 'auroc': 0.9401493, 'binary_precision': 0.9220779, 'binary_recall': 0.84189725, 'binary_specificity': 0.92, 'binary_f1_score': 0.8801653}
confusion matrix:
     0    1
0  207   18
1   40  213
oracle model performance metric: 

scalar performance:
{'acc': 0.9079498, 'precision': 0.90781677, 'recall': 0.9073869, 'specificity': 0.9073869, 'f1': 0.9075858, 'auroc': 0.95144486, 'binary_precision': 0.9098039, 'binary_recall': 0.91699606, 'binary_specificity': 0.8977778, 'binary_f1_score': 0.91338587}
confusion matrix:
     0    1
0  202   23
1   21  232
results aggregation path: zoutput/benchmarks/CAMELYONWILD_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_halffreeze/rule_results/1.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONWILD_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_halffreeze/confusion_matrix/1.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 318521 KiB |   6782 MiB | 580994 GiB | 580994 GiB |
|       from large pool | 291339 KiB |   6756 MiB | 571696 GiB | 571695 GiB |
|       from small pool |  27182 KiB |     43 MiB |   9298 GiB |   9298 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 318521 KiB |   6782 MiB | 580994 GiB | 580994 GiB |
|       from large pool | 291339 KiB |   6756 MiB | 571696 GiB | 571695 GiB |
|       from small pool |  27182 KiB |     43 MiB |   9298 GiB |   9298 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 313851 KiB |   6778 MiB | 579893 GiB | 579893 GiB |
|       from large pool | 286862 KiB |   6752 MiB | 570616 GiB | 570615 GiB |
|       from small pool |  26989 KiB |     43 MiB |   9277 GiB |   9277 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   7456 MiB |   7456 MiB |  14314 MiB |   6858 MiB |
|       from large pool |   7404 MiB |   7404 MiB |  14248 MiB |   6844 MiB |
|       from small pool |     52 MiB |     52 MiB |     66 MiB |     14 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 285638 KiB | 680184 KiB | 453942 GiB | 453942 GiB |
|       from large pool | 275957 KiB | 675647 KiB | 444631 GiB | 444631 GiB |
|       from small pool |   9681 KiB |  32547 KiB |   9310 GiB |   9310 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    1058    |    4649    |  118421 K  |  118420 K  |
|       from large pool |     130    |     756    |   53912 K  |   53912 K  |
|       from small pool |     928    |    4517    |   64509 K  |   64508 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    1058    |    4649    |  118421 K  |  118420 K  |
|       from large pool |     130    |     756    |   53912 K  |   53912 K  |
|       from small pool |     928    |    4517    |   64509 K  |   64508 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     335    |     335    |     626    |     291    |
|       from large pool |     309    |     309    |     593    |     284    |
|       from small pool |      26    |      26    |      33    |       7    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      76    |    1997    |   70722 K  |   70721 K  |
|       from large pool |      27    |     307    |   41565 K  |   41565 K  |
|       from small pool |      49    |    1971    |   29156 K  |   29156 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   6782 MiB | 580994 GiB | 580994 GiB |
|       from large pool |  16640 KiB |   6756 MiB | 571696 GiB | 571696 GiB |
|       from small pool |      0 KiB |     43 MiB |   9298 GiB |   9298 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   6782 MiB | 580994 GiB | 580994 GiB |
|       from large pool |  16640 KiB |   6756 MiB | 571696 GiB | 571696 GiB |
|       from small pool |      0 KiB |     43 MiB |   9298 GiB |   9298 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   6778 MiB | 579893 GiB | 579893 GiB |
|       from large pool |  16640 KiB |   6752 MiB | 570616 GiB | 570616 GiB |
|       from small pool |      0 KiB |     43 MiB |   9277 GiB |   9277 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 604160 KiB |   7456 MiB |  14314 MiB |  13724 MiB |
|       from large pool | 567296 KiB |   7404 MiB |  14248 MiB |  13694 MiB |
|       from small pool |  36864 KiB |     52 MiB |     66 MiB |     30 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 680184 KiB | 453942 GiB | 453942 GiB |
|       from large pool |  24320 KiB | 675647 KiB | 444631 GiB | 444631 GiB |
|       from small pool |      0 KiB |  32547 KiB |   9310 GiB |   9310 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    4649    |  118421 K  |  118421 K  |
|       from large pool |       2    |     756    |   53912 K  |   53912 K  |
|       from small pool |       0    |    4517    |   64509 K  |   64509 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    4649    |  118421 K  |  118421 K  |
|       from large pool |       2    |     756    |   53912 K  |   53912 K  |
|       from small pool |       0    |    4517    |   64509 K  |   64509 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      43    |     335    |     626    |     583    |
|       from large pool |      25    |     309    |     593    |     568    |
|       from small pool |      18    |      26    |      33    |      15    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    1997    |   70722 K  |   70722 K  |
|       from large pool |       3    |     307    |   41565 K  |   41565 K  |
|       from small pool |       0    |    1971    |   29156 K  |   29156 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   6782 MiB | 580994 GiB | 580994 GiB |
|       from large pool |  16640 KiB |   6756 MiB | 571696 GiB | 571696 GiB |
|       from small pool |      0 KiB |     43 MiB |   9298 GiB |   9298 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   6782 MiB | 580994 GiB | 580994 GiB |
|       from large pool |  16640 KiB |   6756 MiB | 571696 GiB | 571696 GiB |
|       from small pool |      0 KiB |     43 MiB |   9298 GiB |   9298 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   6778 MiB | 579893 GiB | 579893 GiB |
|       from large pool |  16640 KiB |   6752 MiB | 570616 GiB | 570616 GiB |
|       from small pool |      0 KiB |     43 MiB |   9277 GiB |   9277 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 604160 KiB |   7456 MiB |  14314 MiB |  13724 MiB |
|       from large pool | 567296 KiB |   7404 MiB |  14248 MiB |  13694 MiB |
|       from small pool |  36864 KiB |     52 MiB |     66 MiB |     30 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 680184 KiB | 453942 GiB | 453942 GiB |
|       from large pool |  24320 KiB | 675647 KiB | 444631 GiB | 444631 GiB |
|       from small pool |      0 KiB |  32547 KiB |   9310 GiB |   9310 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    4649    |  118421 K  |  118421 K  |
|       from large pool |       2    |     756    |   53912 K  |   53912 K  |
|       from small pool |       0    |    4517    |   64509 K  |   64509 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    4649    |  118421 K  |  118421 K  |
|       from large pool |       2    |     756    |   53912 K  |   53912 K  |
|       from small pool |       0    |    4517    |   64509 K  |   64509 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      43    |     335    |     626    |     583    |
|       from large pool |      25    |     309    |     593    |     568    |
|       from small pool |      18    |      26    |      33    |      15    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    1997    |   70722 K  |   70722 K  |
|       from large pool |       3    |     307    |   41565 K  |   41565 K  |
|       from small pool |       0    |    1971    |   29156 K  |   29156 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_16_16_04_seed_2_21955595

 Experiment start at: 2024-07-13 16:16:04.236055
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
before training, model accuracy: 0.3810526132583618
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9725905, 'precision': 0.8238654, 'recall': 0.9530401, 'specificity': 0.9530401, 'f1': 0.8759993, 'auroc': 0.99273825, 'binary_precision': 0.99643934, 'binary_recall': 0.97468185, 'binary_specificity': 0.9313984, 'binary_f1_score': 0.9854405}
confusion matrix:
      0      1
0  1412    104
1   756  29104
---- Validation: 
scalar performance:
{'acc': 0.75352114, 'precision': 0.80274236, 'recall': 0.75878364, 'specificity': 0.75878364, 'f1': 0.7454915, 'auroc': 0.92206, 'binary_precision': 0.6738392, 'binary_recall': 0.95659167, 'binary_specificity': 0.5609756, 'binary_f1_score': 0.79069763}
confusion matrix:
     0    1
0  368  288
1   27  595
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.69894737, 'precision': 0.7760703, 'recall': 0.6724403, 'specificity': 0.6724403, 'f1': 0.65590346, 'auroc': 0.9277313, 'binary_precision': 0.6510417, 'binary_recall': 0.96525097, 'binary_specificity': 0.37962964, 'binary_f1_score': 0.777605}
confusion matrix:
    0    1
0  82  134
1   9  250
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-13 16:26:02.503305,epoch time: 0:09:58.267250,used: 0:09:58.267250,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_16_16_04_seed_2_21955595
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9842874, 'precision': 0.9625437, 'recall': 0.85962903, 'specificity': 0.85962903, 'f1': 0.9039532, 'auroc': 0.9956753, 'binary_precision': 0.9860316, 'binary_recall': 0.99762225, 'binary_specificity': 0.7216359, 'binary_f1_score': 0.9917931}
confusion matrix:
      0      1
0  1094    422
1    71  29789
---- Validation: 
scalar performance:
{'acc': 0.57589984, 'precision': 0.74716973, 'recall': 0.58668196, 'specificity': 0.58668196, 'f1': 0.499974, 'auroc': 0.91372, 'binary_precision': 0.53466207, 'binary_recall': 0.9919614, 'binary_specificity': 0.18140244, 'binary_f1_score': 0.69481987}
confusion matrix:
     0    1
0  119  537
1    5  617
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5726316, 'precision': 0.780303, 'recall': 0.5300926, 'specificity': 0.5300926, 'f1': 0.41599187, 'auroc': 0.92084944, 'binary_precision': 0.56060606, 'binary_recall': 1.0, 'binary_specificity': 0.060185187, 'binary_f1_score': 0.7184466}
confusion matrix:
    0    1
0  13  203
1   0  259
early stop counter: 1
val acc:0.5758998394012451, best validation acc: 0.7535211443901062, corresponding to test acc:                         0.6989473700523376 / 0.6989473700523376
after epoch: 2,now: 2024-07-13 16:35:58.919191,epoch time: 0:09:56.415886,used: 0:19:54.683136,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_16_16_04_seed_2_21955595
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9891637, 'precision': 0.93160063, 'recall': 0.95423377, 'specificity': 0.95423377, 'f1': 0.94259226, 'auroc': 0.99674493, 'binary_precision': 0.99570125, 'binary_recall': 0.9929002, 'binary_specificity': 0.9155673, 'binary_f1_score': 0.99429876}
confusion matrix:
      0      1
0  1388    128
1   212  29648
---- Validation: 
scalar performance:
{'acc': 0.7276995, 'precision': 0.79832995, 'recall': 0.73404783, 'specificity': 0.73404783, 'f1': 0.7139697, 'auroc': 0.9344488, 'binary_precision': 0.64636755, 'binary_recall': 0.9726688, 'binary_specificity': 0.49542683, 'binary_f1_score': 0.7766367}
confusion matrix:
     0    1
0  325  331
1   17  605
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.71157897, 'precision': 0.78429604, 'recall': 0.6863292, 'specificity': 0.6863292, 'f1': 0.67361486, 'auroc': 0.92810667, 'binary_precision': 0.66137564, 'binary_recall': 0.96525097, 'binary_specificity': 0.4074074, 'binary_f1_score': 0.78492934}
confusion matrix:
    0    1
0  88  128
1   9  250
new oracle model saved
early stop counter: 2
val acc:0.7276995182037354, best validation acc: 0.7535211443901062, corresponding to test acc:                         0.6989473700523376 / 0.7115789651870728
after epoch: 3,now: 2024-07-13 16:45:46.036094,epoch time: 0:09:47.116903,used: 0:29:41.800039,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_16_16_04_seed_2_21955595
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9903748, 'precision': 0.95172143, 'recall': 0.94266033, 'specificity': 0.94266033, 'f1': 0.94713956, 'auroc': 0.99733245, 'binary_precision': 0.9944132, 'binary_recall': 0.9954789, 'binary_specificity': 0.8898417, 'binary_f1_score': 0.99494576}
confusion matrix:
      0      1
0  1349    167
1   135  29725
---- Validation: 
scalar performance:
{'acc': 0.80359936, 'precision': 0.83248615, 'recall': 0.8074808, 'specificity': 0.8074808, 'f1': 0.8005116, 'auroc': 0.9326352, 'binary_precision': 0.72760737, 'binary_recall': 0.95337623, 'binary_specificity': 0.6615854, 'binary_f1_score': 0.82533056}
confusion matrix:
     0    1
0  434  222
1   29  593
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.77894735, 'precision': 0.80615354, 'recall': 0.7638621, 'specificity': 0.7638621, 'f1': 0.7659341, 'auroc': 0.9281782, 'binary_precision': 0.7347561, 'binary_recall': 0.93050194, 'binary_specificity': 0.5972222, 'binary_f1_score': 0.8211244}
confusion matrix:
     0    1
0  129   87
1   18  241
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-07-13 16:55:32.420787,epoch time: 0:09:46.384693,used: 0:39:28.184732,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_16_16_04_seed_2_21955595
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9894187, 'precision': 0.9201032, 'recall': 0.97596955, 'specificity': 0.97596955, 'f1': 0.9460705, 'auroc': 0.9979614, 'binary_precision': 0.99800986, 'binary_recall': 0.99085736, 'binary_specificity': 0.9610818, 'binary_f1_score': 0.9944207}
confusion matrix:
      0      1
0  1457     59
1   273  29587
---- Validation: 
scalar performance:
{'acc': 0.8888889, 'precision': 0.8924917, 'recall': 0.8876436, 'specificity': 0.8876436, 'f1': 0.8883351, 'auroc': 0.94111246, 'binary_precision': 0.9240283, 'binary_recall': 0.840836, 'binary_specificity': 0.9344512, 'binary_f1_score': 0.88047135}
confusion matrix:
     0    1
0  613   43
1   99  523
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.86315787, 'precision': 0.87577146, 'recall': 0.87221146, 'specificity': 0.87221146, 'f1': 0.86309725, 'auroc': 0.9392071, 'binary_precision': 0.9708738, 'binary_recall': 0.77220076, 'binary_specificity': 0.9722222, 'binary_f1_score': 0.86021507}
confusion matrix:
     0    1
0  210    6
1   59  200
new oracle model saved
better model found
persisted
after epoch: 5,now: 2024-07-13 17:05:16.525888,epoch time: 0:09:44.105101,used: 0:49:12.289833,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_16_16_04_seed_2_21955595
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9926696, 'precision': 0.95729494, 'recall': 0.9635893, 'specificity': 0.9635893, 'f1': 0.9604181, 'auroc': 0.99852765, 'binary_precision': 0.9965145, 'binary_recall': 0.9957803, 'binary_specificity': 0.9313984, 'binary_f1_score': 0.9961473}
confusion matrix:
      0      1
0  1412    104
1   126  29734
---- Validation: 
scalar performance:
{'acc': 0.79890454, 'precision': 0.83598137, 'recall': 0.8032826, 'specificity': 0.8032826, 'f1': 0.7946949, 'auroc': 0.93844116, 'binary_precision': 0.71752083, 'binary_recall': 0.9678457, 'binary_specificity': 0.6387195, 'binary_f1_score': 0.82409304}
confusion matrix:
     0    1
0  419  237
1   20  602
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.77894735, 'precision': 0.81422365, 'recall': 0.7623248, 'specificity': 0.7623248, 'f1': 0.7638774, 'auroc': 0.92860717, 'binary_precision': 0.7291667, 'binary_recall': 0.9459459, 'binary_specificity': 0.5787037, 'binary_f1_score': 0.8235294}
confusion matrix:
     0    1
0  125   91
1   14  245
early stop counter: 1
val acc:0.798904538154602, best validation acc: 0.8888888955116272, corresponding to test acc:                         0.8631578683853149 / 0.8631578683853149
after epoch: 6,now: 2024-07-13 17:15:00.145572,epoch time: 0:09:43.619684,used: 0:58:55.909517,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_16_16_04_seed_2_21955595
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9925102, 'precision': 0.9591483, 'recall': 0.9594357, 'specificity': 0.9594357, 'f1': 0.95929193, 'auroc': 0.9985324, 'binary_precision': 0.9960816, 'binary_recall': 0.9960482, 'binary_specificity': 0.9228232, 'binary_f1_score': 0.9960649}
confusion matrix:
      0      1
0  1399    117
1   118  29742
---- Validation: 
scalar performance:
{'acc': 0.8482003, 'precision': 0.8614167, 'recall': 0.85075927, 'specificity': 0.85075927, 'f1': 0.8473747, 'auroc': 0.9360957, 'binary_precision': 0.78533334, 'binary_recall': 0.9469453, 'binary_specificity': 0.75457317, 'binary_f1_score': 0.8586006}
confusion matrix:
     0    1
0  495  161
1   33  589
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.85263157, 'precision': 0.8578948, 'recall': 0.84641784, 'specificity': 0.84641784, 'f1': 0.8494549, 'auroc': 0.9342736, 'binary_precision': 0.83157897, 'binary_recall': 0.9150579, 'binary_specificity': 0.7777778, 'binary_f1_score': 0.8713235}
confusion matrix:
     0    1
0  168   48
1   22  237
early stop counter: 2
val acc:0.8482003211975098, best validation acc: 0.8888888955116272, corresponding to test acc:                         0.8631578683853149 / 0.8631578683853149
after epoch: 7,now: 2024-07-13 17:25:09.325533,epoch time: 0:10:09.179961,used: 1:09:05.089478,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_16_16_04_seed_2_21955595
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9912035, 'precision': 0.9352211, 'recall': 0.9753419, 'specificity': 0.9753419, 'f1': 0.9542873, 'auroc': 0.9985394, 'binary_precision': 0.997846, 'binary_recall': 0.9929002, 'binary_specificity': 0.95778364, 'binary_f1_score': 0.99536693}
confusion matrix:
      0      1
0  1452     64
1   212  29648
---- Validation: 
scalar performance:
{'acc': 0.8849765, 'precision': 0.8849765, 'recall': 0.8852492, 'specificity': 0.8852492, 'f1': 0.8849562, 'auroc': 0.94192123, 'binary_precision': 0.8716745, 'binary_recall': 0.8954984, 'binary_specificity': 0.875, 'binary_f1_score': 0.8834259}
confusion matrix:
     0    1
0  574   82
1   65  557
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.87578946, 'precision': 0.8830259, 'recall': 0.8830259, 'specificity': 0.8830259, 'f1': 0.87578946, 'auroc': 0.9431932, 'binary_precision': 0.962963, 'binary_recall': 0.8030888, 'binary_specificity': 0.962963, 'binary_f1_score': 0.87578946}
confusion matrix:
     0    1
0  208    8
1   51  208
new oracle model saved
early stop counter: 3
val acc:0.8849765062332153, best validation acc: 0.8888888955116272, corresponding to test acc:                         0.8631578683853149 / 0.87578946352005
after epoch: 8,now: 2024-07-13 17:34:53.423699,epoch time: 0:09:44.098166,used: 1:18:49.187644,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_16_16_04_seed_2_21955595
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9907573, 'precision': 0.9822582, 'recall': 0.91531104, 'specificity': 0.91531104, 'f1': 0.9460162, 'auroc': 0.9988879, 'binary_precision': 0.9915226, 'binary_recall': 0.9988279, 'binary_specificity': 0.8317942, 'binary_f1_score': 0.99516183}
confusion matrix:
      0      1
0  1261    255
1    35  29825
---- Validation: 
scalar performance:
{'acc': 0.6760563, 'precision': 0.7872088, 'recall': 0.6841596, 'specificity': 0.6841596, 'f1': 0.6471139, 'auroc': 0.9365001, 'binary_precision': 0.6017613, 'binary_recall': 0.988746, 'binary_specificity': 0.37957317, 'binary_f1_score': 0.7481752}
confusion matrix:
     0    1
0  249  407
1    7  615
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6568421, 'precision': 0.76238275, 'recall': 0.62499106, 'specificity': 0.62499106, 'f1': 0.58814085, 'auroc': 0.9375626, 'binary_precision': 0.6170732, 'binary_recall': 0.976834, 'binary_specificity': 0.27314815, 'binary_f1_score': 0.75635284}
confusion matrix:
    0    1
0  59  157
1   6  253
early stop counter: 4
val acc:0.6760563254356384, best validation acc: 0.8888888955116272, corresponding to test acc:                         0.8631578683853149 / 0.87578946352005
after epoch: 9,now: 2024-07-13 17:44:37.944465,epoch time: 0:09:44.520766,used: 1:28:33.708410,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_16_16_04_seed_2_21955595
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9886856, 'precision': 0.9097632, 'recall': 0.9846635, 'specificity': 0.9846635, 'f1': 0.9436617, 'auroc': 0.99894273, 'binary_precision': 0.9989853, 'binary_recall': 0.9891159, 'binary_specificity': 0.9802111, 'binary_f1_score': 0.99402606}
confusion matrix:
      0      1
0  1486     30
1   325  29535
---- Validation: 
scalar performance:
{'acc': 0.85367763, 'precision': 0.85648257, 'recall': 0.8548864, 'specificity': 0.8548864, 'f1': 0.8536023, 'auroc': 0.9284835, 'binary_precision': 0.81751823, 'binary_recall': 0.90032154, 'binary_specificity': 0.8094512, 'binary_f1_score': 0.85692424}
confusion matrix:
     0    1
0  531  125
1   62  560
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8442105, 'precision': 0.8433465, 'recall': 0.8459978, 'specificity': 0.8459978, 'f1': 0.8437056, 'auroc': 0.9118583, 'binary_precision': 0.88065845, 'binary_recall': 0.82625484, 'binary_specificity': 0.8657407, 'binary_f1_score': 0.8525897}
confusion matrix:
     0    1
0  187   29
1   45  214
early stop counter: 5
val acc:0.8536776304244995, best validation acc: 0.8888888955116272, corresponding to test acc:                         0.8631578683853149 / 0.87578946352005
after epoch: 10,now: 2024-07-13 17:54:24.493377,epoch time: 0:09:46.548912,used: 1:38:20.257322,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_16_16_04_seed_2_21955595
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9949006, 'precision': 0.97283345, 'recall': 0.97164905, 'specificity': 0.97164905, 'f1': 0.97224045, 'auroc': 0.99941885, 'binary_precision': 0.9972542, 'binary_recall': 0.9973878, 'binary_specificity': 0.9459103, 'binary_f1_score': 0.997321}
confusion matrix:
      0      1
0  1434     82
1    78  29782
---- Validation: 
scalar performance:
{'acc': 0.7363067, 'precision': 0.81112933, 'recall': 0.7427236, 'specificity': 0.7427236, 'f1': 0.72270966, 'auroc': 0.94416857, 'binary_precision': 0.6517572, 'binary_recall': 0.98392284, 'binary_specificity': 0.5015244, 'binary_f1_score': 0.7841128}
confusion matrix:
     0    1
0  329  327
1   10  612
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.71157897, 'precision': 0.7770953, 'recall': 0.6870978, 'specificity': 0.6870978, 'f1': 0.67569685, 'auroc': 0.9291792, 'binary_precision': 0.6631016, 'binary_recall': 0.95752895, 'binary_specificity': 0.41666666, 'binary_f1_score': 0.78357035}
confusion matrix:
    0    1
0  90  126
1  11  248
early stop counter: 6
val acc:0.7363067269325256, best validation acc: 0.8888888955116272, corresponding to test acc:                         0.8631578683853149 / 0.87578946352005
after epoch: 11,now: 2024-07-13 18:04:34.037918,epoch time: 0:10:09.544541,used: 1:48:29.801863,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_16_16_04_seed_2_21955595
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9931158, 'precision': 0.9529706, 'recall': 0.9744682, 'specificity': 0.9744682, 'f1': 0.9634402, 'auroc': 0.99890465, 'binary_precision': 0.9976497, 'binary_recall': 0.9951105, 'binary_specificity': 0.95382583, 'binary_f1_score': 0.99637854}
confusion matrix:
      0      1
0  1446     70
1   146  29714
---- Validation: 
scalar performance:
{'acc': 0.8740219, 'precision': 0.87809145, 'recall': 0.87545335, 'specificity': 0.87545335, 'f1': 0.87390447, 'auroc': 0.9456954, 'binary_precision': 0.83165467, 'binary_recall': 0.92926043, 'binary_specificity': 0.82164633, 'binary_f1_score': 0.8777525}
confusion matrix:
     0    1
0  539  117
1   44  578
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8673684, 'precision': 0.8666004, 'recall': 0.8656961, 'specificity': 0.8656961, 'f1': 0.86611277, 'auroc': 0.9457135, 'binary_precision': 0.8740458, 'binary_recall': 0.8841699, 'binary_specificity': 0.8472222, 'binary_f1_score': 0.8790787}
confusion matrix:
     0    1
0  183   33
1   30  229
early stop counter: 7
val acc:0.8740218877792358, best validation acc: 0.8888888955116272, corresponding to test acc:                         0.8631578683853149 / 0.87578946352005
after epoch: 12,now: 2024-07-13 18:14:26.403661,epoch time: 0:09:52.365743,used: 1:58:22.167606,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_16_16_04_seed_2_21955595
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9922234, 'precision': 0.980492, 'recall': 0.93330014, 'specificity': 0.93330014, 'f1': 0.95554245, 'auroc': 0.9991045, 'binary_precision': 0.9933369, 'binary_recall': 0.99852645, 'binary_specificity': 0.8680739, 'binary_f1_score': 0.99592495}
confusion matrix:
      0      1
0  1316    200
1    44  29816
---- Validation: 
scalar performance:
{'acc': 0.76760566, 'precision': 0.81737196, 'recall': 0.7727948, 'specificity': 0.7727948, 'f1': 0.76030767, 'auroc': 0.93632853, 'binary_precision': 0.68486917, 'binary_recall': 0.9678457, 'binary_specificity': 0.5777439, 'binary_f1_score': 0.8021319}
confusion matrix:
     0    1
0  379  277
1   20  602
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7894737, 'precision': 0.8175056, 'recall': 0.7746675, 'specificity': 0.7746675, 'f1': 0.7773131, 'auroc': 0.92556846, 'binary_precision': 0.74311924, 'binary_recall': 0.93822396, 'binary_specificity': 0.6111111, 'binary_f1_score': 0.82935154}
confusion matrix:
     0    1
0  132   84
1   16  243
early stop counter: 8
val acc:0.7676056623458862, best validation acc: 0.8888888955116272, corresponding to test acc:                         0.8631578683853149 / 0.87578946352005
after epoch: 13,now: 2024-07-13 18:24:34.766214,epoch time: 0:10:08.362553,used: 2:08:30.530159,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_16_16_04_seed_2_21955595
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9919684, 'precision': 0.9349068, 'recall': 0.98576206, 'specificity': 0.98576206, 'f1': 0.95875305, 'auroc': 0.99928784, 'binary_precision': 0.9989215, 'binary_recall': 0.99263227, 'binary_specificity': 0.97889185, 'binary_f1_score': 0.99576694}
confusion matrix:
      0      1
0  1484     32
1   220  29640
---- Validation: 
scalar performance:
{'acc': 0.8888889, 'precision': 0.8894243, 'recall': 0.8883936, 'specificity': 0.8883936, 'f1': 0.8886902, 'auroc': 0.94486463, 'binary_precision': 0.8986711, 'binary_recall': 0.86977494, 'binary_specificity': 0.9070122, 'binary_f1_score': 0.88398695}
confusion matrix:
     0    1
0  595   61
1   81  541
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.86315787, 'precision': 0.87704396, 'recall': 0.8725958, 'specificity': 0.8725958, 'f1': 0.8630705, 'auroc': 0.93441653, 'binary_precision': 0.9754902, 'binary_recall': 0.76833975, 'binary_specificity': 0.9768519, 'binary_f1_score': 0.8596112}
confusion matrix:
     0    1
0  211    5
1   60  199
early stop counter: 9
val acc:0.8888888955116272, best validation acc: 0.8888888955116272, corresponding to test acc:                         0.8631578683853149 / 0.87578946352005
after epoch: 14,now: 2024-07-13 18:34:20.020305,epoch time: 0:09:45.254091,used: 2:18:15.784250,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_16_16_04_seed_2_21955595
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9875701, 'precision': 0.9885297, 'recall': 0.87512887, 'specificity': 0.87512887, 'f1': 0.92361134, 'auroc': 0.99898386, 'binary_precision': 0.98749423, 'binary_recall': 0.99959815, 'binary_specificity': 0.75065964, 'binary_f1_score': 0.9935093}
confusion matrix:
      0      1
0  1138    378
1    12  29848
---- Validation: 
scalar performance:
{'acc': 0.7809077, 'precision': 0.8323804, 'recall': 0.78608537, 'specificity': 0.78608537, 'f1': 0.7740909, 'auroc': 0.94365144, 'binary_precision': 0.6947608, 'binary_recall': 0.9807074, 'binary_specificity': 0.5914634, 'binary_f1_score': 0.81333333}
confusion matrix:
     0    1
0  388  268
1   12  610
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.76842105, 'precision': 0.81983507, 'recall': 0.7488292, 'specificity': 0.7488292, 'f1': 0.74807143, 'auroc': 0.9404762, 'binary_precision': 0.7122507, 'binary_recall': 0.96525097, 'binary_specificity': 0.5324074, 'binary_f1_score': 0.81967217}
confusion matrix:
     0    1
0  115  101
1    9  250
early stop counter: 10
val acc:0.7809076905250549, best validation acc: 0.8888888955116272, corresponding to test acc:                         0.8631578683853149 / 0.87578946352005
after epoch: 15,now: 2024-07-13 18:44:05.069698,epoch time: 0:09:45.049393,used: 2:28:00.833643,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_16_16_04_seed_2_21955595
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9789648, 'precision': 0.9852742, 'recall': 0.78451335, 'specificity': 0.78451335, 'f1': 0.85622656, 'auroc': 0.99782777, 'binary_precision': 0.97859436, 'binary_recall': 0.9997656, 'binary_specificity': 0.5692612, 'binary_f1_score': 0.98906666}
confusion matrix:
     0      1
0  863    653
1    7  29853
---- Validation: 
scalar performance:
{'acc': 0.6635368, 'precision': 0.78354883, 'recall': 0.67200613, 'specificity': 0.67200613, 'f1': 0.6301456, 'auroc': 0.9432832, 'binary_precision': 0.5923077, 'binary_recall': 0.9903537, 'binary_specificity': 0.35365853, 'binary_f1_score': 0.74127555}
confusion matrix:
     0    1
0  232  424
1    6  616
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6315789, 'precision': 0.7983871, 'recall': 0.5949074, 'specificity': 0.5949074, 'f1': 0.5332705, 'auroc': 0.94042253, 'binary_precision': 0.5967742, 'binary_recall': 1.0, 'binary_specificity': 0.18981482, 'binary_f1_score': 0.7474748}
confusion matrix:
    0    1
0  41  175
1   0  259
early stop counter: 11
val acc:0.663536787033081, best validation acc: 0.8888888955116272, corresponding to test acc:                         0.8631578683853149 / 0.87578946352005
after epoch: 16,now: 2024-07-13 18:54:02.810160,epoch time: 0:09:57.740462,used: 2:37:58.574105,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_16_16_04_seed_2_21955595
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9951237, 'precision': 0.97196066, 'recall': 0.9752101, 'specificity': 0.9752101, 'f1': 0.9735791, 'auroc': 0.9993659, 'binary_precision': 0.99762136, 'binary_recall': 0.99725384, 'binary_specificity': 0.95316625, 'binary_f1_score': 0.9974376}
confusion matrix:
      0      1
0  1445     71
1    82  29778
---- Validation: 
scalar performance:
{'acc': 0.899061, 'precision': 0.8992902, 'recall': 0.8995103, 'specificity': 0.8995103, 'f1': 0.8990561, 'auroc': 0.94867563, 'binary_precision': 0.8809892, 'binary_recall': 0.9163987, 'binary_specificity': 0.88262194, 'binary_f1_score': 0.8983452}
confusion matrix:
     0    1
0  579   77
1   52  570
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8673684, 'precision': 0.8697706, 'recall': 0.87222934, 'specificity': 0.87222934, 'f1': 0.8672837, 'auroc': 0.9422816, 'binary_precision': 0.9298246, 'binary_recall': 0.8185328, 'binary_specificity': 0.9259259, 'binary_f1_score': 0.8706366}
confusion matrix:
     0    1
0  200   16
1   47  212
better model found
persisted
after epoch: 17,now: 2024-07-13 19:04:03.510379,epoch time: 0:10:00.700219,used: 2:47:59.274324,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_16_16_04_seed_2_21955595
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9934345, 'precision': 0.9496887, 'recall': 0.98277545, 'specificity': 0.98277545, 'f1': 0.96557343, 'auroc': 0.9992806, 'binary_precision': 0.9985206, 'binary_recall': 0.99457467, 'binary_specificity': 0.97097623, 'binary_f1_score': 0.99654377}
confusion matrix:
      0      1
0  1472     44
1   162  29698
---- Validation: 
scalar performance:
{'acc': 0.842723, 'precision': 0.85468984, 'recall': 0.8451739, 'specificity': 0.8451739, 'f1': 0.84195656, 'auroc': 0.9332087, 'binary_precision': 0.78255033, 'binary_recall': 0.937299, 'binary_specificity': 0.7530488, 'binary_f1_score': 0.8529627}
confusion matrix:
     0    1
0  494  162
1   39  583
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8231579, 'precision': 0.8375603, 'recall': 0.8128575, 'specificity': 0.8128575, 'f1': 0.8167236, 'auroc': 0.913324, 'binary_precision': 0.78688526, 'binary_recall': 0.9266409, 'binary_specificity': 0.6990741, 'binary_f1_score': 0.8510638}
confusion matrix:
     0    1
0  151   65
1   19  240
early stop counter: 1
val acc:0.84272301197052, best validation acc: 0.8990610241889954, corresponding to test acc:                         0.8673684000968933 / 0.87578946352005
after epoch: 18,now: 2024-07-13 19:13:56.265068,epoch time: 0:09:52.754689,used: 2:57:52.029013,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_16_16_04_seed_2_21955595
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9953468, 'precision': 0.9747011, 'recall': 0.9747011, 'specificity': 0.9747011, 'f1': 0.9747011, 'auroc': 0.9994627, 'binary_precision': 0.99755526, 'binary_recall': 0.99755526, 'binary_specificity': 0.95184696, 'binary_f1_score': 0.99755526}
confusion matrix:
      0      1
0  1443     73
1    73  29787
---- Validation: 
scalar performance:
{'acc': 0.91001564, 'precision': 0.90994847, 'recall': 0.9102227, 'specificity': 0.9102227, 'f1': 0.9099914, 'auroc': 0.95194244, 'binary_precision': 0.8992126, 'binary_recall': 0.9180064, 'binary_specificity': 0.902439, 'binary_f1_score': 0.90851235}
confusion matrix:
     0    1
0  592   64
1   51  571
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9073684, 'precision': 0.9095129, 'recall': 0.9123677, 'specificity': 0.9123677, 'f1': 0.907299, 'auroc': 0.9569748, 'binary_precision': 0.9694323, 'binary_recall': 0.85714287, 'binary_specificity': 0.9675926, 'binary_f1_score': 0.90983605}
confusion matrix:
     0    1
0  209    7
1   37  222
new oracle model saved
better model found
persisted
after epoch: 19,now: 2024-07-13 19:23:50.600103,epoch time: 0:09:54.335035,used: 3:07:46.364048,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_16_16_04_seed_2_21955595
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9944862, 'precision': 0.98092675, 'recall': 0.9582824, 'specificity': 0.9582824, 'f1': 0.9693008, 'auroc': 0.9993603, 'binary_precision': 0.9958577, 'binary_recall': 0.998359, 'binary_specificity': 0.9182058, 'binary_f1_score': 0.99710685}
confusion matrix:
      0      1
0  1392    124
1    49  29811
---- Validation: 
scalar performance:
{'acc': 0.829421, 'precision': 0.8559772, 'recall': 0.8330499, 'specificity': 0.8330499, 'f1': 0.8271653, 'auroc': 0.9490242, 'binary_precision': 0.75187033, 'binary_recall': 0.9694534, 'binary_specificity': 0.69664633, 'binary_f1_score': 0.8469101}
confusion matrix:
     0    1
0  457  199
1   19  603
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.84210527, 'precision': 0.8547619, 'recall': 0.8329222, 'specificity': 0.8329222, 'f1': 0.837008, 'auroc': 0.94671464, 'binary_precision': 0.8066667, 'binary_recall': 0.93436295, 'binary_specificity': 0.7314815, 'binary_f1_score': 0.86583185}
confusion matrix:
     0    1
0  158   58
1   17  242
early stop counter: 1
val acc:0.8294209837913513, best validation acc: 0.9100156426429749, corresponding to test acc:                         0.9073684215545654 / 0.9073684215545654
after epoch: 20,now: 2024-07-13 19:33:54.403555,epoch time: 0:10:03.803452,used: 3:17:50.167500,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_16_16_04_seed_2_21955595
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9960161, 'precision': 0.98316956, 'recall': 0.97317433, 'specificity': 0.97317433, 'f1': 0.9781138, 'auroc': 0.99946845, 'binary_precision': 0.99735725, 'binary_recall': 0.99845946, 'binary_specificity': 0.9478892, 'binary_f1_score': 0.99790806}
confusion matrix:
      0      1
0  1437     79
1    46  29814
---- Validation: 
scalar performance:
{'acc': 0.8818466, 'precision': 0.88765216, 'recall': 0.8835336, 'specificity': 0.8835336, 'f1': 0.8816582, 'auroc': 0.9478668, 'binary_precision': 0.8330976, 'binary_recall': 0.9469453, 'binary_specificity': 0.82012194, 'binary_f1_score': 0.88638073}
confusion matrix:
     0    1
0  538  118
1   33  589
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8694737, 'precision': 0.86809015, 'recall': 0.8699324, 'specificity': 0.8699324, 'f1': 0.8687612, 'auroc': 0.9480909, 'binary_precision': 0.8924303, 'binary_recall': 0.8648649, 'binary_specificity': 0.875, 'binary_f1_score': 0.87843144}
confusion matrix:
     0    1
0  189   27
1   35  224
early stop counter: 2
val acc:0.8818466067314148, best validation acc: 0.9100156426429749, corresponding to test acc:                         0.9073684215545654 / 0.9073684215545654
after epoch: 21,now: 2024-07-13 19:43:53.667071,epoch time: 0:09:59.263516,used: 3:27:49.431016,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_16_16_04_seed_2_21955595
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9955699, 'precision': 0.98339486, 'recall': 0.9679308, 'specificity': 0.9679308, 'f1': 0.9755229, 'auroc': 0.99940455, 'binary_precision': 0.9968239, 'binary_recall': 0.99852645, 'binary_specificity': 0.9373351, 'binary_f1_score': 0.99767447}
confusion matrix:
      0      1
0  1421     95
1    44  29816
---- Validation: 
scalar performance:
{'acc': 0.8380282, 'precision': 0.8592709, 'recall': 0.84126735, 'specificity': 0.84126735, 'f1': 0.83641267, 'auroc': 0.9469104, 'binary_precision': 0.76500636, 'binary_recall': 0.96302253, 'binary_specificity': 0.7195122, 'binary_f1_score': 0.852669}
confusion matrix:
     0    1
0  472  184
1   23  599
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.85263157, 'precision': 0.86181223, 'recall': 0.8448806, 'specificity': 0.8448806, 'f1': 0.8486545, 'auroc': 0.9397433, 'binary_precision': 0.8225256, 'binary_recall': 0.93050194, 'binary_specificity': 0.7592593, 'binary_f1_score': 0.8731884}
confusion matrix:
     0    1
0  164   52
1   18  241
early stop counter: 3
val acc:0.8380281925201416, best validation acc: 0.9100156426429749, corresponding to test acc:                         0.9073684215545654 / 0.9073684215545654
after epoch: 22,now: 2024-07-13 19:53:49.778898,epoch time: 0:09:56.111827,used: 3:37:45.542843,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_16_16_04_seed_2_21955595
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.9948368, 'precision': 0.9614043, 'recall': 0.9844515, 'specificity': 0.9844515, 'f1': 0.9726136, 'auroc': 0.9995481, 'binary_precision': 0.99862325, 'binary_recall': 0.9959478, 'binary_specificity': 0.97295517, 'binary_f1_score': 0.99728376}
confusion matrix:
      0      1
0  1475     41
1   121  29739
---- Validation: 
scalar performance:
{'acc': 0.8920188, 'precision': 0.89199895, 'recall': 0.8922756, 'specificity': 0.8922756, 'f1': 0.89199734, 'auroc': 0.9471611, 'binary_precision': 0.87931037, 'binary_recall': 0.90192926, 'binary_specificity': 0.88262194, 'binary_f1_score': 0.89047617}
confusion matrix:
     0    1
0  579   77
1   61  561
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.85473686, 'precision': 0.8627672, 'recall': 0.8621836, 'specificity': 0.8621836, 'f1': 0.8547343, 'auroc': 0.93102026, 'binary_precision': 0.94392526, 'binary_recall': 0.7799228, 'binary_specificity': 0.9444444, 'binary_f1_score': 0.85412264}
confusion matrix:
     0    1
0  204   12
1   57  202
early stop counter: 4
val acc:0.8920187950134277, best validation acc: 0.9100156426429749, corresponding to test acc:                         0.9073684215545654 / 0.9073684215545654
after epoch: 23,now: 2024-07-13 20:03:45.454193,epoch time: 0:09:55.675295,used: 3:47:41.218138,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_16_16_04_seed_2_21955595
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9942313, 'precision': 0.9581461, 'recall': 0.9813157, 'specificity': 0.9813157, 'f1': 0.9694109, 'auroc': 0.99944997, 'binary_precision': 0.99832094, 'binary_recall': 0.99561286, 'binary_specificity': 0.9670185, 'binary_f1_score': 0.9969651}
confusion matrix:
      0      1
0  1466     50
1   131  29729
---- Validation: 
scalar performance:
{'acc': 0.8974961, 'precision': 0.8974961, 'recall': 0.8977776, 'specificity': 0.8977776, 'f1': 0.897478, 'auroc': 0.9493943, 'binary_precision': 0.8841941, 'binary_recall': 0.9083601, 'binary_specificity': 0.8871951, 'binary_f1_score': 0.89611423}
confusion matrix:
     0    1
0  582   74
1   57  565
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.86315787, 'precision': 0.8734052, 'recall': 0.8714429, 'specificity': 0.8714429, 'f1': 0.86313605, 'auroc': 0.9322001, 'binary_precision': 0.96190476, 'binary_recall': 0.7799228, 'binary_specificity': 0.962963, 'binary_f1_score': 0.8614073}
confusion matrix:
     0    1
0  208    8
1   57  202
early stop counter: 5
val acc:0.8974961042404175, best validation acc: 0.9100156426429749, corresponding to test acc:                         0.9073684215545654 / 0.9073684215545654
after epoch: 24,now: 2024-07-13 20:13:39.994581,epoch time: 0:09:54.540388,used: 3:57:35.758526,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_16_16_04_seed_2_21955595
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.996271, 'precision': 0.9759146, 'recall': 0.9839527, 'specificity': 0.9839527, 'f1': 0.97989607, 'auroc': 0.9995986, 'binary_precision': 0.9984916, 'binary_recall': 0.99758875, 'binary_specificity': 0.97031665, 'binary_f1_score': 0.99803996}
confusion matrix:
      0      1
0  1471     45
1    72  29788
---- Validation: 
scalar performance:
{'acc': 0.86463225, 'precision': 0.8728235, 'recall': 0.8666403, 'specificity': 0.8666403, 'f1': 0.8642592, 'auroc': 0.9471395, 'binary_precision': 0.81051177, 'binary_recall': 0.94212216, 'binary_specificity': 0.79115856, 'binary_f1_score': 0.8713755}
confusion matrix:
     0    1
0  519  137
1   36  586
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8589474, 'precision': 0.8583585, 'recall': 0.85682106, 'specificity': 0.85682106, 'f1': 0.85749215, 'auroc': 0.9279101, 'binary_precision': 0.8636364, 'binary_recall': 0.88030887, 'binary_specificity': 0.8333333, 'binary_f1_score': 0.8718929}
confusion matrix:
     0    1
0  180   36
1   31  228
early stop counter: 6
val acc:0.864632248878479, best validation acc: 0.9100156426429749, corresponding to test acc:                         0.9073684215545654 / 0.9073684215545654
after epoch: 25,now: 2024-07-13 20:23:37.535065,epoch time: 0:09:57.540484,used: 4:07:33.299010,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_16_16_04_seed_2_21955595
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9946456, 'precision': 0.99200714, 'recall': 0.94928706, 'specificity': 0.94928706, 'f1': 0.9695711, 'auroc': 0.99968266, 'binary_precision': 0.99489963, 'binary_recall': 0.99949765, 'binary_specificity': 0.8990765, 'binary_f1_score': 0.99719334}
confusion matrix:
      0      1
0  1363    153
1    15  29845
---- Validation: 
scalar performance:
{'acc': 0.86932707, 'precision': 0.88160026, 'recall': 0.8717551, 'specificity': 0.8717551, 'f1': 0.86871874, 'auroc': 0.9561199, 'binary_precision': 0.80619115, 'binary_recall': 0.96302253, 'binary_specificity': 0.7804878, 'binary_f1_score': 0.8776557}
confusion matrix:
     0    1
0  512  144
1   23  599
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.87578946, 'precision': 0.8777554, 'recall': 0.87188077, 'specificity': 0.87188077, 'f1': 0.8739095, 'auroc': 0.94837695, 'binary_precision': 0.86496353, 'binary_recall': 0.9150579, 'binary_specificity': 0.8287037, 'binary_f1_score': 0.8893058}
confusion matrix:
     0    1
0  179   37
1   22  237
early stop counter: 7
val acc:0.8693270683288574, best validation acc: 0.9100156426429749, corresponding to test acc:                         0.9073684215545654 / 0.9073684215545654
after epoch: 26,now: 2024-07-13 20:33:36.283288,epoch time: 0:09:58.748223,used: 4:17:32.047233,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_16_16_04_seed_2_21955595
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.9948049, 'precision': 0.9638895, 'recall': 0.9809909, 'specificity': 0.9809909, 'f1': 0.9722671, 'auroc': 0.9993237, 'binary_precision': 0.9982551, 'binary_recall': 0.99628264, 'binary_specificity': 0.9656992, 'binary_f1_score': 0.9972679}
confusion matrix:
      0      1
0  1464     52
1   111  29749
---- Validation: 
scalar performance:
{'acc': 0.91079813, 'precision': 0.91120785, 'recall': 0.91040164, 'specificity': 0.91040164, 'f1': 0.91066134, 'auroc': 0.9551352, 'binary_precision': 0.9191419, 'binary_recall': 0.8954984, 'binary_specificity': 0.9253049, 'binary_f1_score': 0.9071661}
confusion matrix:
     0    1
0  607   49
1   65  557
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8947368, 'precision': 0.9006939, 'recall': 0.9015534, 'specificity': 0.9015534, 'f1': 0.8947327, 'auroc': 0.95390034, 'binary_precision': 0.977169, 'binary_recall': 0.82625484, 'binary_specificity': 0.9768519, 'binary_f1_score': 0.89539754}
confusion matrix:
     0    1
0  211    5
1   45  214
better model found
persisted
after epoch: 27,now: 2024-07-13 20:43:35.061577,epoch time: 0:09:58.778289,used: 4:27:30.825522,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_16_16_04_seed_2_21955595
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.9947093, 'precision': 0.9887196, 'recall': 0.95307744, 'specificity': 0.95307744, 'f1': 0.9701493, 'auroc': 0.99949384, 'binary_precision': 0.99529624, 'binary_recall': 0.99916273, 'binary_specificity': 0.9069921, 'binary_f1_score': 0.99722576}
confusion matrix:
      0      1
0  1375    141
1    25  29835
---- Validation: 
scalar performance:
{'acc': 0.84741783, 'precision': 0.8631966, 'recall': 0.8502054, 'specificity': 0.8502054, 'f1': 0.8463809, 'auroc': 0.94529164, 'binary_precision': 0.7805519, 'binary_recall': 0.95498395, 'binary_specificity': 0.74542683, 'binary_f1_score': 0.8590022}
confusion matrix:
     0    1
0  489  167
1   28  594
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8589474, 'precision': 0.8594851, 'recall': 0.8556682, 'specificity': 0.8556682, 'f1': 0.8571005, 'auroc': 0.93495286, 'binary_precision': 0.85555553, 'binary_recall': 0.8918919, 'binary_specificity': 0.8194444, 'binary_f1_score': 0.8733459}
confusion matrix:
     0    1
0  177   39
1   28  231
early stop counter: 1
val acc:0.8474178314208984, best validation acc: 0.9107981324195862, corresponding to test acc:                         0.8947368264198303 / 0.9073684215545654
after epoch: 28,now: 2024-07-13 20:53:32.664912,epoch time: 0:09:57.603335,used: 4:37:28.428857,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_16_16_04_seed_2_21955595
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9958567, 'precision': 0.9783318, 'recall': 0.97653437, 'specificity': 0.97653437, 'f1': 0.9774312, 'auroc': 0.9995202, 'binary_precision': 0.99772316, 'binary_recall': 0.9979237, 'binary_specificity': 0.9551451, 'binary_f1_score': 0.9978234}
confusion matrix:
      0      1
0  1448     68
1    62  29798
---- Validation: 
scalar performance:
{'acc': 0.8912363, 'precision': 0.8922893, 'recall': 0.8920134, 'specificity': 0.8920134, 'f1': 0.891233, 'auroc': 0.94977725, 'binary_precision': 0.8642534, 'binary_recall': 0.92122185, 'binary_specificity': 0.8628049, 'binary_f1_score': 0.8918288}
confusion matrix:
     0    1
0  566   90
1   49  573
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8736842, 'precision': 0.87467635, 'recall': 0.87763655, 'specificity': 0.87763655, 'f1': 0.87352216, 'auroc': 0.934649, 'binary_precision': 0.9270386, 'binary_recall': 0.8339768, 'binary_specificity': 0.9212963, 'binary_f1_score': 0.8780487}
confusion matrix:
     0    1
0  199   17
1   43  216
early stop counter: 2
val acc:0.8912363052368164, best validation acc: 0.9107981324195862, corresponding to test acc:                         0.8947368264198303 / 0.9073684215545654
after epoch: 29,now: 2024-07-13 21:03:29.195701,epoch time: 0:09:56.530789,used: 4:47:24.959646,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_16_16_04_seed_2_21955595
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.996271, 'precision': 0.98398393, 'recall': 0.9751867, 'specificity': 0.9751867, 'f1': 0.97954035, 'auroc': 0.9994394, 'binary_precision': 0.99755764, 'binary_recall': 0.99852645, 'binary_specificity': 0.95184696, 'binary_f1_score': 0.9980418}
confusion matrix:
      0      1
0  1443     73
1    44  29816
---- Validation: 
scalar performance:
{'acc': 0.8904538, 'precision': 0.89108455, 'recall': 0.89108455, 'specificity': 0.89108455, 'f1': 0.89045376, 'auroc': 0.9469821, 'binary_precision': 0.86737806, 'binary_recall': 0.914791, 'binary_specificity': 0.86737806, 'binary_f1_score': 0.89045376}
confusion matrix:
     0    1
0  569   87
1   53  569
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8568421, 'precision': 0.85892177, 'recall': 0.8614239, 'specificity': 0.8614239, 'f1': 0.8567348, 'auroc': 0.9266365, 'binary_precision': 0.9170306, 'binary_recall': 0.8108108, 'binary_specificity': 0.912037, 'binary_f1_score': 0.8606558}
confusion matrix:
     0    1
0  197   19
1   49  210
early stop counter: 3
val acc:0.8904538154602051, best validation acc: 0.9107981324195862, corresponding to test acc:                         0.8947368264198303 / 0.9073684215545654
after epoch: 30,now: 2024-07-13 21:14:39.990509,epoch time: 0:11:10.794808,used: 4:58:35.754454,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_16_16_04_seed_2_21955595
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 4:58:35.754454 at 2024-07-13 21:14:39.990509
persisted model performance metric: 

scalar performance:
{'acc': 0.8947368, 'precision': 0.9006939, 'recall': 0.9015534, 'specificity': 0.9015534, 'f1': 0.8947327, 'auroc': 0.95390034, 'binary_precision': 0.977169, 'binary_recall': 0.82625484, 'binary_specificity': 0.9768519, 'binary_f1_score': 0.89539754}
confusion matrix:
     0    1
0  211    5
1   45  214
oracle model performance metric: 

scalar performance:
{'acc': 0.9073684, 'precision': 0.9095129, 'recall': 0.9123677, 'specificity': 0.9123677, 'f1': 0.907299, 'auroc': 0.9569748, 'binary_precision': 0.9694323, 'binary_recall': 0.85714287, 'binary_specificity': 0.9675926, 'binary_f1_score': 0.90983605}
confusion matrix:
     0    1
0  209    7
1   37  222
results aggregation path: zoutput/benchmarks/CAMELYONWILD_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_halffreeze/rule_results/1.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONWILD_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_halffreeze/confusion_matrix/1.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 318241 KiB |   6782 MiB |    849 TiB |    849 TiB |
|       from large pool | 291059 KiB |   6756 MiB |    836 TiB |    836 TiB |
|       from small pool |  27182 KiB |     43 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 318241 KiB |   6782 MiB |    849 TiB |    849 TiB |
|       from large pool | 291059 KiB |   6756 MiB |    836 TiB |    836 TiB |
|       from small pool |  27182 KiB |     43 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 313851 KiB |   6778 MiB |    848 TiB |    848 TiB |
|       from large pool | 286862 KiB |   6752 MiB |    835 TiB |    835 TiB |
|       from small pool |  26989 KiB |     43 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   7450 MiB |   7456 MiB |  21174 MiB |  13724 MiB |
|       from large pool |   7398 MiB |   7404 MiB |  21092 MiB |  13694 MiB |
|       from small pool |     52 MiB |     52 MiB |     82 MiB |     30 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 259294 KiB | 680184 KiB | 681271 GiB | 681271 GiB |
|       from large pool | 249613 KiB | 675647 KiB | 667306 GiB | 667306 GiB |
|       from small pool |   9681 KiB |  32547 KiB |  13964 GiB |  13964 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    1058    |    4669    |  177607 K  |  177606 K  |
|       from large pool |     130    |     756    |   80799 K  |   80799 K  |
|       from small pool |     928    |    4537    |   96807 K  |   96806 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    1058    |    4669    |  177607 K  |  177606 K  |
|       from large pool |     130    |     756    |   80799 K  |   80799 K  |
|       from small pool |     928    |    4537    |   96807 K  |   96806 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     335    |     335    |     918    |     583    |
|       from large pool |     309    |     309    |     877    |     568    |
|       from small pool |      26    |      26    |      41    |      15    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      75    |    2005    |  102741 K  |  102740 K  |
|       from large pool |      25    |     307    |   59031 K  |   59031 K  |
|       from small pool |      50    |    1981    |   43709 K  |   43709 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   6782 MiB |    849 TiB |    849 TiB |
|       from large pool |  16640 KiB |   6756 MiB |    836 TiB |    836 TiB |
|       from small pool |      0 KiB |     43 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   6782 MiB |    849 TiB |    849 TiB |
|       from large pool |  16640 KiB |   6756 MiB |    836 TiB |    836 TiB |
|       from small pool |      0 KiB |     43 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   6778 MiB |    848 TiB |    848 TiB |
|       from large pool |  16640 KiB |   6752 MiB |    835 TiB |    835 TiB |
|       from small pool |      0 KiB |     43 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 577536 KiB |   7456 MiB |  21174 MiB |  20610 MiB |
|       from large pool | 540672 KiB |   7404 MiB |  21092 MiB |  20564 MiB |
|       from small pool |  36864 KiB |     52 MiB |     82 MiB |     46 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 680184 KiB | 681271 GiB | 681271 GiB |
|       from large pool |  24320 KiB | 675647 KiB | 667307 GiB | 667307 GiB |
|       from small pool |      0 KiB |  32547 KiB |  13964 GiB |  13964 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    4669    |  177607 K  |  177607 K  |
|       from large pool |       2    |     756    |   80799 K  |   80799 K  |
|       from small pool |       0    |    4537    |   96807 K  |   96807 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    4669    |  177607 K  |  177607 K  |
|       from large pool |       2    |     756    |   80799 K  |   80799 K  |
|       from small pool |       0    |    4537    |   96807 K  |   96807 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      42    |     335    |     918    |     876    |
|       from large pool |      24    |     309    |     877    |     853    |
|       from small pool |      18    |      26    |      41    |      23    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    2005    |  102741 K  |  102741 K  |
|       from large pool |       3    |     307    |   59031 K  |   59031 K  |
|       from small pool |       0    |    1981    |   43709 K  |   43709 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Sat Jul 13 21:22:04 2024]
Finished job 0.
1 of 1 steps (100%) done
