Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Sat Jul 13 12:01:34 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYONWILD_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_halffreeze/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYONWILD_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_halffreeze/rule_results/5.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=5
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/swiglu_ffn.py:51: UserWarning: xFormers is not available (SwiGLU)
  warnings.warn("xFormers is not available (SwiGLU)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/attention.py:33: UserWarning: xFormers is not available (Attention)
  warnings.warn("xFormers is not available (Attention)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/block.py:40: UserWarning: xFormers is not available (Block)
  warnings.warn("xFormers is not available (Block)")
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_12_11_06_seed_0_21955597

 Experiment start at: 2024-07-13 12:11:06.616306
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
before training, model accuracy: 0.5360825061798096
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9817708, 'precision': 0.9090201, 'recall': 0.89028513, 'specificity': 0.89028513, 'f1': 0.8994057, 'auroc': 0.9906664, 'binary_precision': 0.98921144, 'binary_recall': 0.991652, 'binary_specificity': 0.7889182, 'binary_f1_score': 0.99043024}
confusion matrix:
      0      1
0  1196    320
1   247  29341
---- Validation: 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
scalar performance:
{'acc': 0.71040374, 'precision': 0.79682815, 'recall': 0.71413463, 'specificity': 0.71413463, 'f1': 0.6899256, 'auroc': 0.92656785, 'binary_precision': 0.6331301, 'binary_recall': 0.98110235, 'binary_specificity': 0.44716692, 'binary_f1_score': 0.7696109}
confusion matrix:
     0    1
0  292  361
1   12  623
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.72164947, 'precision': 0.7876623, 'recall': 0.6907838, 'specificity': 0.6907838, 'f1': 0.6826609, 'auroc': 0.93021536, 'binary_precision': 0.6753247, 'binary_recall': 0.962963, 'binary_specificity': 0.41860464, 'binary_f1_score': 0.79389316}
confusion matrix:
    0    1
0  90  125
1  10  260
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-13 12:22:28.836266,epoch time: 0:11:22.219960,used: 0:11:22.219960,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_12_11_06_seed_0_21955597
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.98334616, 'precision': 0.97147816, 'recall': 0.84344244, 'specificity': 0.84344244, 'f1': 0.89634454, 'auroc': 0.9948554, 'binary_precision': 0.9842407, 'binary_recall': 0.998479, 'binary_specificity': 0.6884058, 'binary_f1_score': 0.99130875}
confusion matrix:
      0      1
0  1045    473
1    45  29541
---- Validation: 
scalar performance:
{'acc': 0.6506211, 'precision': 0.7770549, 'recall': 0.6552845, 'specificity': 0.6552845, 'f1': 0.6094919, 'auroc': 0.94207233, 'binary_precision': 0.5863679, 'binary_recall': 0.98897636, 'binary_specificity': 0.32159266, 'binary_f1_score': 0.7362251}
confusion matrix:
     0    1
0  210  443
1    7  628
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7195876, 'precision': 0.78628254, 'recall': 0.6884582, 'specificity': 0.6884582, 'f1': 0.67978096, 'auroc': 0.9367614, 'binary_precision': 0.6735751, 'binary_recall': 0.962963, 'binary_specificity': 0.41395348, 'binary_f1_score': 0.79268295}
confusion matrix:
    0    1
0  89  126
1  10  260
early stop counter: 1
val acc:0.6506211161613464, best validation acc: 0.7104037404060364, corresponding to test acc:                         0.7216494679450989 / 0.7216494679450989
after epoch: 2,now: 2024-07-13 12:33:31.398731,epoch time: 0:11:02.562465,used: 0:22:24.782425,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_12_11_06_seed_0_21955597
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9872364, 'precision': 0.9248948, 'recall': 0.940518, 'specificity': 0.940518, 'f1': 0.93254757, 'auroc': 0.9951345, 'binary_precision': 0.9942762, 'binary_recall': 0.9922934, 'binary_specificity': 0.88874257, 'binary_f1_score': 0.9932838}
confusion matrix:
      0      1
0  1350    169
1   228  29357
---- Validation: 
scalar performance:
{'acc': 0.8198758, 'precision': 0.84550273, 'recall': 0.82177234, 'specificity': 0.82177234, 'f1': 0.8170526, 'auroc': 0.9386623, 'binary_precision': 0.7478475, 'binary_recall': 0.9574803, 'binary_specificity': 0.6860643, 'binary_f1_score': 0.839779}
confusion matrix:
     0    1
0  448  205
1   27  608
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.83092785, 'precision': 0.8339477, 'recall': 0.8230405, 'specificity': 0.8230405, 'f1': 0.8263197, 'auroc': 0.9333161, 'binary_precision': 0.8197279, 'binary_recall': 0.8925926, 'binary_specificity': 0.75348836, 'binary_f1_score': 0.8546099}
confusion matrix:
     0    1
0  162   53
1   29  241
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-07-13 12:44:22.823304,epoch time: 0:10:51.424573,used: 0:33:16.206998,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_12_11_06_seed_0_21955597
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9903871, 'precision': 0.94515365, 'recall': 0.9521074, 'specificity': 0.9521074, 'f1': 0.9486003, 'auroc': 0.99755967, 'binary_precision': 0.9953657, 'binary_recall': 0.9945246, 'binary_specificity': 0.9096902, 'binary_f1_score': 0.99494493}
confusion matrix:
      0      1
0  1380    137
1   162  29425
---- Validation: 
scalar performance:
{'acc': 0.7259317, 'precision': 0.8059006, 'recall': 0.72947025, 'specificity': 0.72947025, 'f1': 0.70873076, 'auroc': 0.93239915, 'binary_precision': 0.6459627, 'binary_recall': 0.98267716, 'binary_specificity': 0.4762634, 'binary_f1_score': 0.7795128}
confusion matrix:
     0    1
0  311  342
1   11  624
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7876289, 'precision': 0.8189032, 'recall': 0.76757103, 'specificity': 0.76757103, 'f1': 0.77172923, 'auroc': 0.9421189, 'binary_precision': 0.7434402, 'binary_recall': 0.9444444, 'binary_specificity': 0.59069765, 'binary_f1_score': 0.8319739}
confusion matrix:
     0    1
0  127   88
1   15  255
early stop counter: 1
val acc:0.725931704044342, best validation acc: 0.8198757767677307, corresponding to test acc:                         0.830927848815918 / 0.830927848815918
after epoch: 4,now: 2024-07-13 12:54:56.277945,epoch time: 0:10:33.454641,used: 0:43:49.661639,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_12_11_06_seed_0_21955597
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.99112654, 'precision': 0.93913615, 'recall': 0.9697299, 'specificity': 0.9697299, 'f1': 0.9538538, 'auroc': 0.99816257, 'binary_precision': 0.9972178, 'binary_recall': 0.9934426, 'binary_specificity': 0.94601715, 'binary_f1_score': 0.9953266}
confusion matrix:
      0      1
0  1437     82
1   194  29391
---- Validation: 
scalar performance:
{'acc': 0.88121116, 'precision': 0.8812693, 'recall': 0.88132906, 'specificity': 0.88132906, 'f1': 0.8812094, 'auroc': 0.9424485, 'binary_precision': 0.87191355, 'binary_recall': 0.8897638, 'binary_specificity': 0.87289435, 'binary_f1_score': 0.8807482}
confusion matrix:
     0    1
0  570   83
1   70  565
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.88247424, 'precision': 0.88459575, 'recall': 0.8892334, 'specificity': 0.8892334, 'f1': 0.88227403, 'auroc': 0.94065464, 'binary_precision': 0.9531915, 'binary_recall': 0.8296296, 'binary_specificity': 0.9488372, 'binary_f1_score': 0.8871287}
confusion matrix:
     0    1
0  204   11
1   46  224
new oracle model saved
better model found
persisted
after epoch: 5,now: 2024-07-13 13:05:22.443064,epoch time: 0:10:26.165119,used: 0:54:15.826758,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_12_11_06_seed_0_21955597
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.99125516, 'precision': 0.9639619, 'recall': 0.94013244, 'specificity': 0.94013244, 'f1': 0.95169663, 'auroc': 0.9980278, 'binary_precision': 0.99403375, 'binary_recall': 0.9967889, 'binary_specificity': 0.88347596, 'binary_f1_score': 0.9954094}
confusion matrix:
      0      1
0  1342    177
1    95  29490
---- Validation: 
scalar performance:
{'acc': 0.8439441, 'precision': 0.85811996, 'recall': 0.8453353, 'specificity': 0.8453353, 'f1': 0.8427336, 'auroc': 0.9286829, 'binary_precision': 0.7832898, 'binary_recall': 0.9448819, 'binary_specificity': 0.7457887, 'binary_f1_score': 0.856531}
confusion matrix:
     0    1
0  487  166
1   35  600
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8618557, 'precision': 0.85988915, 'recall': 0.86360896, 'specificity': 0.86360896, 'f1': 0.8609096, 'auroc': 0.9363997, 'binary_precision': 0.8980392, 'binary_recall': 0.84814817, 'binary_specificity': 0.87906975, 'binary_f1_score': 0.8723809}
confusion matrix:
     0    1
0  189   26
1   41  229
early stop counter: 1
val acc:0.8439440727233887, best validation acc: 0.8812111616134644, corresponding to test acc:                         0.8824742436408997 / 0.8824742436408997
after epoch: 6,now: 2024-07-13 13:15:58.912678,epoch time: 0:10:36.469614,used: 1:04:52.296372,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_12_11_06_seed_0_21955597
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9907407, 'precision': 0.93379533, 'recall': 0.9726342, 'specificity': 0.9726342, 'f1': 0.9522775, 'auroc': 0.99816084, 'binary_precision': 0.99755454, 'binary_recall': 0.99269927, 'binary_specificity': 0.9525692, 'binary_f1_score': 0.995121}
confusion matrix:
      0      1
0  1446     72
1   216  29370
---- Validation: 
scalar performance:
{'acc': 0.8920807, 'precision': 0.8922999, 'recall': 0.89191854, 'specificity': 0.89191854, 'f1': 0.8920182, 'auroc': 0.9429429, 'binary_precision': 0.8987138, 'binary_recall': 0.88031495, 'binary_specificity': 0.9035222, 'binary_f1_score': 0.88941926}
confusion matrix:
     0    1
0  590   63
1   76  559
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.87216496, 'precision': 0.8769028, 'recall': 0.88044786, 'specificity': 0.88044786, 'f1': 0.87207305, 'auroc': 0.9337123, 'binary_precision': 0.95614034, 'binary_recall': 0.8074074, 'binary_specificity': 0.95348835, 'binary_f1_score': 0.87550205}
confusion matrix:
     0    1
0  205   10
1   52  218
better model found
persisted
after epoch: 7,now: 2024-07-13 13:26:31.353177,epoch time: 0:10:32.440499,used: 1:15:24.736871,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_12_11_06_seed_0_21955597
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9927983, 'precision': 0.94754785, 'recall': 0.9787276, 'specificity': 0.9787276, 'f1': 0.962548, 'auroc': 0.9988124, 'binary_precision': 0.9981, 'binary_recall': 0.99432147, 'binary_specificity': 0.96313363, 'binary_f1_score': 0.9962072}
confusion matrix:
      0      1
0  1463     56
1   168  29417
---- Validation: 
scalar performance:
{'acc': 0.86878884, 'precision': 0.8778591, 'recall': 0.869881, 'specificity': 0.869881, 'f1': 0.8682149, 'auroc': 0.94953394, 'binary_precision': 0.8157182, 'binary_recall': 0.9480315, 'binary_specificity': 0.79173046, 'binary_f1_score': 0.87691194}
confusion matrix:
     0    1
0  517  136
1   33  602
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8412371, 'precision': 0.83947575, 'recall': 0.8384582, 'specificity': 0.8384582, 'f1': 0.8389337, 'auroc': 0.93266153, 'binary_precision': 0.85347986, 'binary_recall': 0.86296296, 'binary_specificity': 0.81395346, 'binary_f1_score': 0.8581952}
confusion matrix:
     0    1
0  175   40
1   37  233
early stop counter: 1
val acc:0.8687888383865356, best validation acc: 0.8920807242393494, corresponding to test acc:                         0.8721649646759033 / 0.8824742436408997
after epoch: 8,now: 2024-07-13 13:37:03.016714,epoch time: 0:10:31.663537,used: 1:25:56.400408,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_12_11_06_seed_0_21955597
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9918981, 'precision': 0.9417014, 'recall': 0.9757562, 'specificity': 0.9757562, 'f1': 0.95801795, 'auroc': 0.9987335, 'binary_precision': 0.99782765, 'binary_recall': 0.9936454, 'binary_specificity': 0.957867, 'binary_f1_score': 0.9957322}
confusion matrix:
      0      1
0  1455     64
1   188  29397
---- Validation: 
scalar performance:
{'acc': 0.89285713, 'precision': 0.89658237, 'recall': 0.8935525, 'specificity': 0.8935525, 'f1': 0.8927081, 'auroc': 0.95198715, 'binary_precision': 0.85449356, 'binary_recall': 0.9433071, 'binary_specificity': 0.84379786, 'binary_f1_score': 0.8967066}
confusion matrix:
     0    1
0  551  102
1   36  599
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8618557, 'precision': 0.85969126, 'recall': 0.8612403, 'specificity': 0.8612403, 'f1': 0.8603717, 'auroc': 0.94113696, 'binary_precision': 0.88301885, 'binary_recall': 0.8666667, 'binary_specificity': 0.855814, 'binary_f1_score': 0.87476635}
confusion matrix:
     0    1
0  184   31
1   36  234
better model found
persisted
after epoch: 9,now: 2024-07-13 13:47:41.297296,epoch time: 0:10:38.280582,used: 1:36:34.680990,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_12_11_06_seed_0_21955597
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9922196, 'precision': 0.9742274, 'recall': 0.94032717, 'specificity': 0.94032717, 'f1': 0.95657736, 'auroc': 0.99844956, 'binary_precision': 0.9940065, 'binary_recall': 0.99783677, 'binary_specificity': 0.8828176, 'binary_f1_score': 0.99591804}
confusion matrix:
      0      1
0  1341    178
1    64  29521
---- Validation: 
scalar performance:
{'acc': 0.79347825, 'precision': 0.8405896, 'recall': 0.7960642, 'specificity': 0.7960642, 'f1': 0.787037, 'auroc': 0.94569945, 'binary_precision': 0.71037626, 'binary_recall': 0.98110235, 'binary_specificity': 0.61102605, 'binary_f1_score': 0.82407403}
confusion matrix:
     0    1
0  399  254
1   12  623
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.78969073, 'precision': 0.8145973, 'recall': 0.77131784, 'specificity': 0.77131784, 'f1': 0.7757316, 'auroc': 0.927683, 'binary_precision': 0.75, 'binary_recall': 0.93333334, 'binary_specificity': 0.60930234, 'binary_f1_score': 0.8316831}
confusion matrix:
     0    1
0  131   84
1   18  252
early stop counter: 1
val acc:0.79347825050354, best validation acc: 0.8928571343421936, corresponding to test acc:                         0.861855685710907 / 0.8824742436408997
after epoch: 10,now: 2024-07-13 13:58:13.603284,epoch time: 0:10:32.305988,used: 1:47:06.986978,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_12_11_06_seed_0_21955597
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.99350566, 'precision': 0.95606077, 'recall': 0.9759625, 'specificity': 0.9759625, 'f1': 0.96577334, 'auroc': 0.9989668, 'binary_precision': 0.99776393, 'binary_recall': 0.99540323, 'binary_specificity': 0.95652175, 'binary_f1_score': 0.99658215}
confusion matrix:
      0      1
0  1452     66
1   136  29450
---- Validation: 
scalar performance:
{'acc': 0.85170805, 'precision': 0.86525106, 'recall': 0.8530574, 'specificity': 0.8530574, 'f1': 0.8506384, 'auroc': 0.9468763, 'binary_precision': 0.79133856, 'binary_recall': 0.9496063, 'binary_specificity': 0.7565084, 'binary_f1_score': 0.86327845}
confusion matrix:
     0    1
0  494  159
1   32  603
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8618557, 'precision': 0.8619776, 'recall': 0.8574505, 'specificity': 0.8574505, 'f1': 0.8592492, 'auroc': 0.93321276, 'binary_precision': 0.86121, 'binary_recall': 0.8962963, 'binary_specificity': 0.81860465, 'binary_f1_score': 0.8784029}
confusion matrix:
     0    1
0  176   39
1   28  242
early stop counter: 2
val acc:0.8517080545425415, best validation acc: 0.8928571343421936, corresponding to test acc:                         0.861855685710907 / 0.8824742436408997
after epoch: 11,now: 2024-07-13 14:08:45.490368,epoch time: 0:10:31.887084,used: 1:57:38.874062,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_12_11_06_seed_0_21955597
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9933449, 'precision': 0.9561131, 'recall': 0.97401863, 'specificity': 0.97401863, 'f1': 0.9648726, 'auroc': 0.9990287, 'binary_precision': 0.99756116, 'binary_recall': 0.99543685, 'binary_specificity': 0.9526004, 'binary_f1_score': 0.99649787}
confusion matrix:
      0      1
0  1447     72
1   135  29450
---- Validation: 
scalar performance:
{'acc': 0.8773292, 'precision': 0.8816653, 'recall': 0.87808657, 'specificity': 0.87808657, 'f1': 0.8771132, 'auroc': 0.9378592, 'binary_precision': 0.8373409, 'binary_recall': 0.93228346, 'binary_specificity': 0.82388973, 'binary_f1_score': 0.88226527}
confusion matrix:
     0    1
0  538  115
1   43  592
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8907217, 'precision': 0.8916216, 'recall': 0.89664084, 'specificity': 0.89664084, 'f1': 0.8904534, 'auroc': 0.94406545, 'binary_precision': 0.9539749, 'binary_recall': 0.84444445, 'binary_specificity': 0.9488372, 'binary_f1_score': 0.89587426}
confusion matrix:
     0    1
0  204   11
1   42  228
new oracle model saved
early stop counter: 3
val acc:0.8773291707038879, best validation acc: 0.8928571343421936, corresponding to test acc:                         0.861855685710907 / 0.8907216787338257
after epoch: 12,now: 2024-07-13 14:19:25.847538,epoch time: 0:10:40.357170,used: 2:08:19.231232,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_12_11_06_seed_0_21955597
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.99379504, 'precision': 0.98675656, 'recall': 0.94549143, 'specificity': 0.94549143, 'f1': 0.9651085, 'auroc': 0.9993601, 'binary_precision': 0.99448204, 'binary_recall': 0.9990198, 'binary_specificity': 0.8919631, 'binary_f1_score': 0.99674577}
confusion matrix:
      0      1
0  1354    164
1    29  29557
---- Validation: 
scalar performance:
{'acc': 0.77251554, 'precision': 0.82895464, 'recall': 0.7753904, 'specificity': 0.7753904, 'f1': 0.7635354, 'auroc': 0.9457049, 'binary_precision': 0.6891593, 'binary_recall': 0.98110235, 'binary_specificity': 0.5696784, 'binary_f1_score': 0.8096166}
confusion matrix:
     0    1
0  372  281
1   12  623
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.84742266, 'precision': 0.8594931, 'recall': 0.8359604, 'specificity': 0.8359604, 'f1': 0.8413351, 'auroc': 0.9448751, 'binary_precision': 0.816129, 'binary_recall': 0.93703705, 'binary_specificity': 0.7348837, 'binary_f1_score': 0.8724138}
confusion matrix:
     0    1
0  158   57
1   17  253
early stop counter: 4
val acc:0.7725155353546143, best validation acc: 0.8928571343421936, corresponding to test acc:                         0.861855685710907 / 0.8907216787338257
after epoch: 13,now: 2024-07-13 14:30:12.478615,epoch time: 0:10:46.631077,used: 2:19:05.862309,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_12_11_06_seed_0_21955597
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9939236, 'precision': 0.9626611, 'recall': 0.9727615, 'specificity': 0.9727615, 'f1': 0.9676503, 'auroc': 0.9991003, 'binary_precision': 0.99739426, 'binary_recall': 0.9962143, 'binary_specificity': 0.94930875, 'binary_f1_score': 0.996804}
confusion matrix:
      0      1
0  1442     77
1   112  29473
---- Validation: 
scalar performance:
{'acc': 0.89285713, 'precision': 0.894561, 'recall': 0.89333546, 'specificity': 0.89333546, 'f1': 0.8928065, 'auroc': 0.95164955, 'binary_precision': 0.8649045, 'binary_recall': 0.9275591, 'binary_specificity': 0.8591118, 'binary_f1_score': 0.8951368}
confusion matrix:
     0    1
0  561   92
1   46  589
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8783505, 'precision': 0.87682605, 'recall': 0.8812661, 'specificity': 0.8812661, 'f1': 0.8776766, 'auroc': 0.9464772, 'binary_precision': 0.9203187, 'binary_recall': 0.85555553, 'binary_specificity': 0.90697676, 'binary_f1_score': 0.88675624}
confusion matrix:
     0    1
0  195   20
1   39  231
early stop counter: 5
val acc:0.8928571343421936, best validation acc: 0.8928571343421936, corresponding to test acc:                         0.861855685710907 / 0.8907216787338257
after epoch: 14,now: 2024-07-13 14:40:56.568005,epoch time: 0:10:44.089390,used: 2:29:49.951699,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_12_11_06_seed_0_21955597
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9947917, 'precision': 0.9803364, 'recall': 0.9628893, 'specificity': 0.9628893, 'f1': 0.971433, 'auroc': 0.9992929, 'binary_precision': 0.9962893, 'binary_recall': 0.99824244, 'binary_specificity': 0.92753625, 'binary_f1_score': 0.9972649}
confusion matrix:
      0      1
0  1408    110
1    52  29534
---- Validation: 
scalar performance:
{'acc': 0.78881985, 'precision': 0.8361274, 'recall': 0.79142666, 'specificity': 0.79142666, 'f1': 0.7821115, 'auroc': 0.9425715, 'binary_precision': 0.7064846, 'binary_recall': 0.9779528, 'binary_specificity': 0.6049005, 'binary_f1_score': 0.8203435}
confusion matrix:
     0    1
0  395  258
1   14  621
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8329897, 'precision': 0.8484584, 'recall': 0.8196813, 'specificity': 0.8196813, 'f1': 0.825261, 'auroc': 0.9415159, 'binary_precision': 0.79810727, 'binary_recall': 0.93703705, 'binary_specificity': 0.7023256, 'binary_f1_score': 0.8620102}
confusion matrix:
     0    1
0  151   64
1   17  253
early stop counter: 6
val acc:0.7888198494911194, best validation acc: 0.8928571343421936, corresponding to test acc:                         0.861855685710907 / 0.8907216787338257
after epoch: 15,now: 2024-07-13 14:51:44.047860,epoch time: 0:10:47.479855,used: 2:40:37.431554,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_12_11_06_seed_0_21955597
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9953061, 'precision': 0.9826027, 'recall': 0.9662845, 'specificity': 0.9662845, 'f1': 0.9742873, 'auroc': 0.99929845, 'binary_precision': 0.9966262, 'binary_recall': 0.9984452, 'binary_specificity': 0.9341239, 'binary_f1_score': 0.9975349}
confusion matrix:
      0      1
0  1418    100
1    46  29540
---- Validation: 
scalar performance:
{'acc': 0.8408385, 'precision': 0.86328316, 'recall': 0.8425764, 'specificity': 0.8425764, 'f1': 0.8387954, 'auroc': 0.9455662, 'binary_precision': 0.76942354, 'binary_recall': 0.96692914, 'binary_specificity': 0.7182236, 'binary_f1_score': 0.8569434}
confusion matrix:
     0    1
0  469  184
1   21  614
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8515464, 'precision': 0.854023, 'recall': 0.8448751, 'specificity': 0.8448751, 'f1': 0.8479094, 'auroc': 0.9420155, 'binary_precision': 0.8413793, 'binary_recall': 0.9037037, 'binary_specificity': 0.7860465, 'binary_f1_score': 0.87142855}
confusion matrix:
     0    1
0  169   46
1   26  244
early stop counter: 7
val acc:0.8408384919166565, best validation acc: 0.8928571343421936, corresponding to test acc:                         0.861855685710907 / 0.8907216787338257
after epoch: 16,now: 2024-07-13 15:02:34.384371,epoch time: 0:10:50.336511,used: 2:51:27.768065,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_12_11_06_seed_0_21955597
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9948238, 'precision': 0.9619843, 'recall': 0.98415494, 'specificity': 0.98415494, 'f1': 0.9727785, 'auroc': 0.99928975, 'binary_precision': 0.9985767, 'binary_recall': 0.9959778, 'binary_specificity': 0.972332, 'binary_f1_score': 0.9972756}
confusion matrix:
      0      1
0  1476     42
1   119  29467
---- Validation: 
scalar performance:
{'acc': 0.83928573, 'precision': 0.86408216, 'recall': 0.8411101, 'specificity': 0.8411101, 'f1': 0.83698547, 'auroc': 0.9427958, 'binary_precision': 0.7655087, 'binary_recall': 0.9716535, 'binary_specificity': 0.71056664, 'binary_f1_score': 0.85634977}
confusion matrix:
     0    1
0  464  189
1   18  617
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8515464, 'precision': 0.86148536, 'recall': 0.8410853, 'specificity': 0.8410853, 'f1': 0.8461294, 'auroc': 0.9391731, 'binary_precision': 0.8235294, 'binary_recall': 0.93333334, 'binary_specificity': 0.74883723, 'binary_f1_score': 0.875}
confusion matrix:
     0    1
0  161   54
1   18  252
early stop counter: 8
val acc:0.8392857313156128, best validation acc: 0.8928571343421936, corresponding to test acc:                         0.861855685710907 / 0.8907216787338257
after epoch: 17,now: 2024-07-13 15:13:14.754886,epoch time: 0:10:40.370515,used: 3:02:08.138580,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_12_11_06_seed_0_21955597
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.995081, 'precision': 0.9776443, 'recall': 0.9689785, 'specificity': 0.9689785, 'f1': 0.9732672, 'auroc': 0.99922734, 'binary_precision': 0.99692726, 'binary_recall': 0.9979044, 'binary_specificity': 0.9400527, 'binary_f1_score': 0.9974156}
confusion matrix:
      0      1
0  1427     91
1    62  29524
---- Validation: 
scalar performance:
{'acc': 0.8532609, 'precision': 0.8734975, 'recall': 0.8548926, 'specificity': 0.8548926, 'f1': 0.85163087, 'auroc': 0.95058787, 'binary_precision': 0.7829949, 'binary_recall': 0.9716535, 'binary_specificity': 0.7381317, 'binary_f1_score': 0.867182}
confusion matrix:
     0    1
0  482  171
1   18  617
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8701031, 'precision': 0.8763701, 'recall': 0.8620155, 'specificity': 0.8620155, 'f1': 0.8662807, 'auroc': 0.951869, 'binary_precision': 0.8484849, 'binary_recall': 0.93333334, 'binary_specificity': 0.7906977, 'binary_f1_score': 0.88888896}
confusion matrix:
     0    1
0  170   45
1   18  252
early stop counter: 9
val acc:0.85326087474823, best validation acc: 0.8928571343421936, corresponding to test acc:                         0.861855685710907 / 0.8907216787338257
after epoch: 18,now: 2024-07-13 15:23:58.456365,epoch time: 0:10:43.701479,used: 3:12:51.840059,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_12_11_06_seed_0_21955597
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9960134, 'precision': 0.9776772, 'recall': 0.97946805, 'specificity': 0.97946805, 'f1': 0.9785708, 'auroc': 0.9995649, 'binary_precision': 0.9980054, 'binary_recall': 0.99780303, 'binary_specificity': 0.96113306, 'binary_f1_score': 0.99790424}
confusion matrix:
      0      1
0  1459     59
1    65  29521
---- Validation: 
scalar performance:
{'acc': 0.88509315, 'precision': 0.8850621, 'recall': 0.8851141, 'specificity': 0.8851141, 'f1': 0.8850796, 'auroc': 0.9411752, 'binary_precision': 0.8810642, 'binary_recall': 0.88661414, 'binary_specificity': 0.88361406, 'binary_f1_score': 0.8838304}
confusion matrix:
     0    1
0  577   76
1   72  563
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8556701, 'precision': 0.8621032, 'recall': 0.8646856, 'specificity': 0.8646856, 'f1': 0.8556204, 'auroc': 0.9443066, 'binary_precision': 0.9464286, 'binary_recall': 0.78518516, 'binary_specificity': 0.94418603, 'binary_f1_score': 0.8582996}
confusion matrix:
     0    1
0  203   12
1   58  212
early stop counter: 10
val acc:0.8850931525230408, best validation acc: 0.8928571343421936, corresponding to test acc:                         0.861855685710907 / 0.8907216787338257
after epoch: 19,now: 2024-07-13 15:34:33.372474,epoch time: 0:10:34.916109,used: 3:23:26.756168,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_12_11_06_seed_0_21955597
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9951132, 'precision': 0.9651423, 'recall': 0.9836916, 'specificity': 0.9836916, 'f1': 0.97421384, 'auroc': 0.9993948, 'binary_precision': 0.9985095, 'binary_recall': 0.9963495, 'binary_specificity': 0.9710336, 'binary_f1_score': 0.99742836}
confusion matrix:
      0      1
0  1475     44
1   108  29477
---- Validation: 
scalar performance:
{'acc': 0.88509315, 'precision': 0.8881239, 'recall': 0.8844847, 'specificity': 0.8844847, 'f1': 0.88473296, 'auroc': 0.9451809, 'binary_precision': 0.919105, 'binary_recall': 0.8409449, 'binary_specificity': 0.92802453, 'binary_f1_score': 0.87828946}
confusion matrix:
     0    1
0  606   47
1  101  534
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8556701, 'precision': 0.8726468, 'recall': 0.8689492, 'specificity': 0.8689492, 'f1': 0.85562044, 'auroc': 0.94358313, 'binary_precision': 0.9854369, 'binary_recall': 0.75185186, 'binary_specificity': 0.9860465, 'binary_f1_score': 0.8529413}
confusion matrix:
     0    1
0  212    3
1   67  203
early stop counter: 11
val acc:0.8850931525230408, best validation acc: 0.8928571343421936, corresponding to test acc:                         0.861855685710907 / 0.8907216787338257
after epoch: 20,now: 2024-07-13 15:45:04.518904,epoch time: 0:10:31.146430,used: 3:33:57.902598,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_12_11_06_seed_0_21955597
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.98562884, 'precision': 0.8881149, 'recall': 0.9877585, 'specificity': 0.9877585, 'f1': 0.9314697, 'auroc': 0.9994149, 'binary_precision': 0.99948573, 'binary_recall': 0.9853985, 'binary_specificity': 0.99011856, 'binary_f1_score': 0.99239206}
confusion matrix:
      0      1
0  1503     15
1   432  29154
---- Validation: 
scalar performance:
{'acc': 0.8431677, 'precision': 0.8528038, 'recall': 0.8420084, 'specificity': 0.8420084, 'f1': 0.8417479, 'auroc': 0.9378326, 'binary_precision': 0.9077213, 'binary_recall': 0.75905514, 'binary_specificity': 0.9249617, 'binary_f1_score': 0.82675815}
confusion matrix:
     0    1
0  604   49
1  153  482
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.80618554, 'precision': 0.8247123, 'recall': 0.8197675, 'specificity': 0.8197675, 'f1': 0.80604625, 'auroc': 0.92900944, 'binary_precision': 0.93564355, 'binary_recall': 0.7, 'binary_specificity': 0.9395349, 'binary_f1_score': 0.80084753}
confusion matrix:
     0    1
0  202   13
1   81  189
early stop counter: 12
val acc:0.8431677222251892, best validation acc: 0.8928571343421936, corresponding to test acc:                         0.861855685710907 / 0.8907216787338257
after epoch: 21,now: 2024-07-13 15:55:26.540384,epoch time: 0:10:22.021480,used: 3:44:19.924078,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_12_11_06_seed_0_21955597
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.99520963, 'precision': 0.9816122, 'recall': 0.96623385, 'specificity': 0.96623385, 'f1': 0.97378397, 'auroc': 0.99931633, 'binary_precision': 0.99662584, 'binary_recall': 0.9983438, 'binary_specificity': 0.9341239, 'binary_f1_score': 0.99748415}
confusion matrix:
      0      1
0  1418    100
1    49  29537
---- Validation: 
scalar performance:
{'acc': 0.88586956, 'precision': 0.8901585, 'recall': 0.8866178, 'specificity': 0.8866178, 'f1': 0.8856759, 'auroc': 0.9490329, 'binary_precision': 0.84560907, 'binary_recall': 0.9401575, 'binary_specificity': 0.8330781, 'binary_f1_score': 0.89038026}
confusion matrix:
     0    1
0  544  109
1   38  597
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8742268, 'precision': 0.87216705, 'recall': 0.8756675, 'specificity': 0.8756675, 'f1': 0.8732765, 'auroc': 0.9461498, 'binary_precision': 0.9066148, 'binary_recall': 0.86296296, 'binary_specificity': 0.88837206, 'binary_f1_score': 0.88425046}
confusion matrix:
     0    1
0  191   24
1   37  233
early stop counter: 13
val acc:0.885869562625885, best validation acc: 0.8928571343421936, corresponding to test acc:                         0.861855685710907 / 0.8907216787338257
after epoch: 22,now: 2024-07-13 16:06:06.212056,epoch time: 0:10:39.671672,used: 3:54:59.595750,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_12_11_06_seed_0_21955597
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.9927341, 'precision': 0.9886917, 'recall': 0.93216646, 'specificity': 0.93216646, 'f1': 0.95850265, 'auroc': 0.9994365, 'binary_precision': 0.99311364, 'binary_recall': 0.99929017, 'binary_specificity': 0.8650428, 'binary_f1_score': 0.99619234}
confusion matrix:
      0      1
0  1314    205
1    21  29564
---- Validation: 
scalar performance:
{'acc': 0.80667704, 'precision': 0.84106547, 'recall': 0.8088857, 'specificity': 0.8088857, 'f1': 0.8024227, 'auroc': 0.93346816, 'binary_precision': 0.72921616, 'binary_recall': 0.96692914, 'binary_specificity': 0.65084225, 'binary_f1_score': 0.83141506}
confusion matrix:
     0    1
0  425  228
1   21  614
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8185567, 'precision': 0.8241595, 'recall': 0.8086133, 'specificity': 0.8086133, 'f1': 0.81252414, 'auroc': 0.9107493, 'binary_precision': 0.8013245, 'binary_recall': 0.8962963, 'binary_specificity': 0.7209302, 'binary_f1_score': 0.8461538}
confusion matrix:
     0    1
0  155   60
1   28  242
early stop counter: 14
val acc:0.8066770434379578, best validation acc: 0.8928571343421936, corresponding to test acc:                         0.861855685710907 / 0.8907216787338257
after epoch: 23,now: 2024-07-13 16:16:46.291436,epoch time: 0:10:40.079380,used: 4:05:39.675130,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_12_11_06_seed_0_21955597
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.99440587, 'precision': 0.99018884, 'recall': 0.94897074, 'specificity': 0.94897074, 'f1': 0.96857435, 'auroc': 0.9996191, 'binary_precision': 0.99481815, 'binary_recall': 0.99932396, 'binary_specificity': 0.8986175, 'binary_f1_score': 0.997066}
confusion matrix:
      0      1
0  1365    154
1    20  29565
---- Validation: 
scalar performance:
{'acc': 0.863354, 'precision': 0.87486327, 'recall': 0.86458623, 'specificity': 0.86458623, 'f1': 0.86255836, 'auroc': 0.94278014, 'binary_precision': 0.80559254, 'binary_recall': 0.9527559, 'binary_specificity': 0.77641654, 'binary_f1_score': 0.8730159}
confusion matrix:
     0    1
0  507  146
1   30  605
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.85773194, 'precision': 0.8565368, 'recall': 0.85469425, 'specificity': 0.85469425, 'f1': 0.8555208, 'auroc': 0.9411197, 'binary_precision': 0.86545455, 'binary_recall': 0.88148147, 'binary_specificity': 0.82790697, 'binary_f1_score': 0.8733945}
confusion matrix:
     0    1
0  178   37
1   32  238
early stop counter: 15
val acc:0.8633540272712708, best validation acc: 0.8928571343421936, corresponding to test acc:                         0.861855685710907 / 0.8907216787338257
after epoch: 24,now: 2024-07-13 16:27:21.185650,epoch time: 0:10:34.894214,used: 4:16:14.569344,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_12_11_06_seed_0_21955597
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.99524176, 'precision': 0.9755033, 'recall': 0.97312534, 'specificity': 0.97312534, 'f1': 0.974311, 'auroc': 0.9994943, 'binary_precision': 0.99736434, 'binary_recall': 0.997634, 'binary_specificity': 0.9486166, 'binary_f1_score': 0.99749917}
confusion matrix:
      0      1
0  1440     78
1    70  29516
---- Validation: 
scalar performance:
{'acc': 0.8734472, 'precision': 0.88299966, 'recall': 0.87456197, 'specificity': 0.87456197, 'f1': 0.87286717, 'auroc': 0.9453311, 'binary_precision': 0.81891894, 'binary_recall': 0.9543307, 'binary_specificity': 0.79479325, 'binary_f1_score': 0.8814545}
confusion matrix:
     0    1
0  519  134
1   29  606
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8659794, 'precision': 0.86493504, 'recall': 0.8630491, 'specificity': 0.8630491, 'f1': 0.86389637, 'auroc': 0.9363997, 'binary_precision': 0.8727273, 'binary_recall': 0.8888889, 'binary_specificity': 0.8372093, 'binary_f1_score': 0.88073397}
confusion matrix:
     0    1
0  180   35
1   30  240
early stop counter: 16
val acc:0.8734471797943115, best validation acc: 0.8928571343421936, corresponding to test acc:                         0.861855685710907 / 0.8907216787338257
after epoch: 25,now: 2024-07-13 16:38:05.239592,epoch time: 0:10:44.053942,used: 4:26:58.623286,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_12_11_06_seed_0_21955597
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.99485594, 'precision': 0.9643211, 'recall': 0.9816828, 'specificity': 0.9816828, 'f1': 0.9728235, 'auroc': 0.9994175, 'binary_precision': 0.9983065, 'binary_recall': 0.9962819, 'binary_specificity': 0.96708363, 'binary_f1_score': 0.99729323}
confusion matrix:
      0      1
0  1469     50
1   110  29475
---- Validation: 
scalar performance:
{'acc': 0.9045031, 'precision': 0.90480494, 'recall': 0.9043217, 'specificity': 0.9043217, 'f1': 0.9044404, 'auroc': 0.9497372, 'binary_precision': 0.91290325, 'binary_recall': 0.8913386, 'binary_specificity': 0.91730475, 'binary_f1_score': 0.901992}
confusion matrix:
     0    1
0  599   54
1   69  566
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.87216496, 'precision': 0.8817905, 'recall': 0.88281655, 'specificity': 0.88281655, 'f1': 0.87216, 'auroc': 0.9357493, 'binary_precision': 0.9770642, 'binary_recall': 0.7888889, 'binary_specificity': 0.9767442, 'binary_f1_score': 0.8729508}
confusion matrix:
     0    1
0  210    5
1   57  213
better model found
persisted
after epoch: 26,now: 2024-07-13 16:48:49.801584,epoch time: 0:10:44.561992,used: 4:37:43.185278,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_12_11_06_seed_0_21955597
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.99324846, 'precision': 0.9475198, 'recall': 0.98426425, 'specificity': 0.98426425, 'f1': 0.9650776, 'auroc': 0.9994168, 'binary_precision': 0.9986759, 'binary_recall': 0.99422026, 'binary_specificity': 0.9743083, 'binary_f1_score': 0.9964431}
confusion matrix:
      0      1
0  1479     39
1   171  29415
---- Validation: 
scalar performance:
{'acc': 0.9076087, 'precision': 0.9076343, 'recall': 0.90771, 'specificity': 0.90771, 'f1': 0.90760595, 'auroc': 0.9540726, 'binary_precision': 0.8993808, 'binary_recall': 0.9149606, 'binary_specificity': 0.9004594, 'binary_f1_score': 0.90710384}
confusion matrix:
     0    1
0  588   65
1   54  581
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.88247424, 'precision': 0.8833724, 'recall': 0.888286, 'specificity': 0.888286, 'f1': 0.8821857, 'auroc': 0.95112836, 'binary_precision': 0.9456067, 'binary_recall': 0.837037, 'binary_specificity': 0.9395349, 'binary_f1_score': 0.8880157}
confusion matrix:
     0    1
0  202   13
1   44  226
better model found
persisted
after epoch: 27,now: 2024-07-13 16:59:22.899117,epoch time: 0:10:33.097533,used: 4:48:16.282811,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_12_11_06_seed_0_21955597
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.99527395, 'precision': 0.9844216, 'recall': 0.96410346, 'specificity': 0.96410346, 'f1': 0.9740201, 'auroc': 0.9994715, 'binary_precision': 0.9963915, 'binary_recall': 0.998648, 'binary_specificity': 0.92955893, 'binary_f1_score': 0.9975185}
confusion matrix:
      0      1
0  1412    107
1    40  29545
---- Validation: 
scalar performance:
{'acc': 0.9013975, 'precision': 0.9072694, 'recall': 0.9022573, 'specificity': 0.9022573, 'f1': 0.901161, 'auroc': 0.9581628, 'binary_precision': 0.8547486, 'binary_recall': 0.9637795, 'binary_specificity': 0.8407351, 'binary_f1_score': 0.9059955}
confusion matrix:
     0    1
0  549  104
1   23  612
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.87216496, 'precision': 0.8754642, 'recall': 0.86576223, 'specificity': 0.86576223, 'f1': 0.8690331, 'auroc': 0.9542291, 'binary_precision': 0.8586207, 'binary_recall': 0.9222222, 'binary_specificity': 0.80930233, 'binary_f1_score': 0.8892857}
confusion matrix:
     0    1
0  174   41
1   21  249
early stop counter: 1
val acc:0.9013975262641907, best validation acc: 0.907608687877655, corresponding to test acc:                         0.8824742436408997 / 0.8907216787338257
after epoch: 28,now: 2024-07-13 17:09:53.981227,epoch time: 0:10:31.082110,used: 4:58:47.364921,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_12_11_06_seed_0_21955597
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.99633485, 'precision': 0.98407274, 'recall': 0.97619975, 'specificity': 0.97619975, 'f1': 0.9801003, 'auroc': 0.99956656, 'binary_precision': 0.9976361, 'binary_recall': 0.9985128, 'binary_specificity': 0.9538867, 'binary_f1_score': 0.9980743}
confusion matrix:
      0      1
0  1448     70
1    44  29542
---- Validation: 
scalar performance:
{'acc': 0.882764, 'precision': 0.89031595, 'recall': 0.8837503, 'specificity': 0.8837503, 'f1': 0.8823651, 'auroc': 0.9541535, 'binary_precision': 0.8324176, 'binary_recall': 0.9543307, 'binary_specificity': 0.81316996, 'binary_f1_score': 0.88921493}
confusion matrix:
     0    1
0  531  122
1   29  606
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8639175, 'precision': 0.8634049, 'recall': 0.86024976, 'specificity': 0.86024976, 'f1': 0.8615819, 'auroc': 0.9411929, 'binary_precision': 0.86690646, 'binary_recall': 0.8925926, 'binary_specificity': 0.82790697, 'binary_f1_score': 0.879562}
confusion matrix:
     0    1
0  178   37
1   29  241
early stop counter: 2
val acc:0.8827639818191528, best validation acc: 0.907608687877655, corresponding to test acc:                         0.8824742436408997 / 0.8907216787338257
after epoch: 29,now: 2024-07-13 17:20:27.105185,epoch time: 0:10:33.123958,used: 5:09:20.488879,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_12_11_06_seed_0_21955597
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.9953382, 'precision': 0.98200357, 'recall': 0.9671968, 'specificity': 0.9671968, 'f1': 0.97447145, 'auroc': 0.99944, 'binary_precision': 0.99672705, 'binary_recall': 0.99837774, 'binary_specificity': 0.93601584, 'binary_f1_score': 0.9975517}
confusion matrix:
      0      1
0  1419     97
1    48  29540
---- Validation: 
scalar performance:
{'acc': 0.86180127, 'precision': 0.87500715, 'recall': 0.86311996, 'specificity': 0.86311996, 'f1': 0.86085886, 'auroc': 0.93775785, 'binary_precision': 0.801054, 'binary_recall': 0.9574803, 'binary_specificity': 0.76875955, 'binary_f1_score': 0.8723099}
confusion matrix:
     0    1
0  502  151
1   27  608
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8742268, 'precision': 0.8741692, 'recall': 0.87045646, 'specificity': 0.87045646, 'f1': 0.87199783, 'auroc': 0.9499397, 'binary_precision': 0.87455195, 'binary_recall': 0.9037037, 'binary_specificity': 0.8372093, 'binary_f1_score': 0.88888884}
confusion matrix:
     0    1
0  180   35
1   26  244
early stop counter: 3
val acc:0.861801266670227, best validation acc: 0.907608687877655, corresponding to test acc:                         0.8824742436408997 / 0.8907216787338257
after epoch: 30,now: 2024-07-13 17:31:00.892241,epoch time: 0:10:33.787056,used: 5:19:54.275935,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_12_11_06_seed_0_21955597
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 5:19:54.275935 at 2024-07-13 17:31:00.892241
persisted model performance metric: 

scalar performance:
{'acc': 0.88247424, 'precision': 0.8833724, 'recall': 0.888286, 'specificity': 0.888286, 'f1': 0.8821857, 'auroc': 0.95112836, 'binary_precision': 0.9456067, 'binary_recall': 0.837037, 'binary_specificity': 0.9395349, 'binary_f1_score': 0.8880157}
confusion matrix:
     0    1
0  202   13
1   44  226
oracle model performance metric: 

scalar performance:
{'acc': 0.8907217, 'precision': 0.8916216, 'recall': 0.89664084, 'specificity': 0.89664084, 'f1': 0.8904534, 'auroc': 0.94406545, 'binary_precision': 0.9539749, 'binary_recall': 0.84444445, 'binary_specificity': 0.9488372, 'binary_f1_score': 0.89587426}
confusion matrix:
     0    1
0  204   11
1   42  228
results aggregation path: zoutput/benchmarks/CAMELYONWILD_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_halffreeze/rule_results/5.csv
results aggregation path: zoutput/benchmarks/CAMELYONWILD_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_halffreeze/rule_results/5.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONWILD_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_halffreeze/confusion_matrix/5.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 318782 KiB |   6782 MiB | 291711 GiB | 291710 GiB |
|       from large pool | 291597 KiB |   6756 MiB | 287047 GiB | 287047 GiB |
|       from small pool |  27185 KiB |     43 MiB |   4663 GiB |   4663 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 318782 KiB |   6782 MiB | 291711 GiB | 291710 GiB |
|       from large pool | 291597 KiB |   6756 MiB | 287047 GiB | 287047 GiB |
|       from small pool |  27185 KiB |     43 MiB |   4663 GiB |   4663 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 313851 KiB |   6778 MiB | 291497 GiB | 291497 GiB |
|       from large pool | 286862 KiB |   6752 MiB | 286844 GiB | 286844 GiB |
|       from small pool |  26989 KiB |     43 MiB |   4652 GiB |   4652 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   7454 MiB |   7454 MiB |   7454 MiB |      0 B   |
|       from large pool |   7404 MiB |   7404 MiB |   7404 MiB |      0 B   |
|       from small pool |     50 MiB |     50 MiB |     50 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory | 291521 KiB | 680184 KiB | 228749 GiB | 228748 GiB |
|       from large pool | 281843 KiB | 675647 KiB | 224079 GiB | 224079 GiB |
|       from small pool |   9678 KiB |  10779 KiB |   4669 GiB |   4669 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    1064    |    4635    |   59407 K  |   59406 K  |
|       from large pool |     130    |     756    |   27095 K  |   27095 K  |
|       from small pool |     934    |    4503    |   32311 K  |   32310 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    1064    |    4635    |   59407 K  |   59406 K  |
|       from large pool |     130    |     756    |   27095 K  |   27095 K  |
|       from small pool |     934    |    4503    |   32311 K  |   32310 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     334    |     334    |     334    |       0    |
|       from large pool |     309    |     309    |     309    |       0    |
|       from small pool |      25    |      25    |      25    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      78    |    1992    |   32445 K  |   32445 K  |
|       from large pool |      28    |     307    |   17750 K  |   17749 K  |
|       from small pool |      50    |    1965    |   14695 K  |   14695 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   6782 MiB | 291711 GiB | 291711 GiB |
|       from large pool |  16640 KiB |   6756 MiB | 287047 GiB | 287047 GiB |
|       from small pool |      0 KiB |     43 MiB |   4663 GiB |   4663 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   6782 MiB | 291711 GiB | 291711 GiB |
|       from large pool |  16640 KiB |   6756 MiB | 287047 GiB | 287047 GiB |
|       from small pool |      0 KiB |     43 MiB |   4663 GiB |   4663 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   6778 MiB | 291497 GiB | 291497 GiB |
|       from large pool |  16640 KiB |   6752 MiB | 286844 GiB | 286844 GiB |
|       from small pool |      0 KiB |     43 MiB |   4652 GiB |   4652 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 610304 KiB |   7454 MiB |   7454 MiB |   6858 MiB |
|       from large pool | 573440 KiB |   7404 MiB |   7404 MiB |   6844 MiB |
|       from small pool |  36864 KiB |     50 MiB |     50 MiB |     14 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 680184 KiB | 228749 GiB | 228749 GiB |
|       from large pool |  24320 KiB | 675647 KiB | 224080 GiB | 224079 GiB |
|       from small pool |      0 KiB |  30499 KiB |   4669 GiB |   4669 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    4635    |   59407 K  |   59407 K  |
|       from large pool |       2    |     756    |   27095 K  |   27095 K  |
|       from small pool |       0    |    4503    |   32311 K  |   32311 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    4635    |   59407 K  |   59407 K  |
|       from large pool |       2    |     756    |   27095 K  |   27095 K  |
|       from small pool |       0    |    4503    |   32311 K  |   32311 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      43    |     334    |     334    |     291    |
|       from large pool |      25    |     309    |     309    |     284    |
|       from small pool |      18    |      25    |      25    |       7    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    1992    |   32445 K  |   32445 K  |
|       from large pool |       3    |     307    |   17750 K  |   17750 K  |
|       from small pool |       0    |    1965    |   14695 K  |   14695 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   6782 MiB | 291711 GiB | 291711 GiB |
|       from large pool |  16640 KiB |   6756 MiB | 287047 GiB | 287047 GiB |
|       from small pool |      0 KiB |     43 MiB |   4663 GiB |   4663 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   6782 MiB | 291711 GiB | 291711 GiB |
|       from large pool |  16640 KiB |   6756 MiB | 287047 GiB | 287047 GiB |
|       from small pool |      0 KiB |     43 MiB |   4663 GiB |   4663 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   6778 MiB | 291497 GiB | 291497 GiB |
|       from large pool |  16640 KiB |   6752 MiB | 286844 GiB | 286844 GiB |
|       from small pool |      0 KiB |     43 MiB |   4652 GiB |   4652 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 610304 KiB |   7454 MiB |   7454 MiB |   6858 MiB |
|       from large pool | 573440 KiB |   7404 MiB |   7404 MiB |   6844 MiB |
|       from small pool |  36864 KiB |     50 MiB |     50 MiB |     14 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 680184 KiB | 228749 GiB | 228749 GiB |
|       from large pool |  24320 KiB | 675647 KiB | 224080 GiB | 224079 GiB |
|       from small pool |      0 KiB |  30499 KiB |   4669 GiB |   4669 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    4635    |   59407 K  |   59407 K  |
|       from large pool |       2    |     756    |   27095 K  |   27095 K  |
|       from small pool |       0    |    4503    |   32311 K  |   32311 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    4635    |   59407 K  |   59407 K  |
|       from large pool |       2    |     756    |   27095 K  |   27095 K  |
|       from small pool |       0    |    4503    |   32311 K  |   32311 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      43    |     334    |     334    |     291    |
|       from large pool |      25    |     309    |     309    |     284    |
|       from small pool |      18    |      25    |      25    |       7    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    1992    |   32445 K  |   32445 K  |
|       from large pool |       3    |     307    |   17750 K  |   17750 K  |
|       from small pool |       0    |    1965    |   14695 K  |   14695 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_17_45_43_seed_1_21955597

 Experiment start at: 2024-07-13 17:45:43.954453
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
before training, model accuracy: 0.6276150345802307
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9805869, 'precision': 0.8692901, 'recall': 0.9520571, 'specificity': 0.9520571, 'f1': 0.90590596, 'auroc': 0.99372256, 'binary_precision': 0.99587464, 'binary_recall': 0.98366725, 'binary_specificity': 0.92044705, 'binary_f1_score': 0.9897333}
confusion matrix:
      0      1
0  1400    121
1   485  29210
---- Validation: 
scalar performance:
{'acc': 0.8501171, 'precision': 0.8507875, 'recall': 0.8504864, 'specificity': 0.8504864, 'f1': 0.850106, 'auroc': 0.9234145, 'binary_precision': 0.83081573, 'binary_recall': 0.8730159, 'binary_specificity': 0.827957, 'binary_f1_score': 0.85139316}
confusion matrix:
     0    1
0  539  112
1   80  550
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.86820084, 'precision': 0.86769557, 'recall': 0.86787, 'specificity': 0.86787, 'f1': 0.867779, 'auroc': 0.9328766, 'binary_precision': 0.8769841, 'binary_recall': 0.8735178, 'binary_specificity': 0.8622222, 'binary_f1_score': 0.87524754}
confusion matrix:
     0    1
0  194   31
1   32  221
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-13 17:56:36.436557,epoch time: 0:10:52.482104,used: 0:10:52.482104,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_17_45_43_seed_1_21955597
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.990806, 'precision': 0.96171, 'recall': 0.93715537, 'specificity': 0.93715537, 'f1': 0.9490583, 'auroc': 0.9969378, 'binary_precision': 0.9937542, 'binary_recall': 0.9965988, 'binary_specificity': 0.877712, 'binary_f1_score': 0.9951744}
confusion matrix:
      0      1
0  1335    186
1   101  29594
---- Validation: 
scalar performance:
{'acc': 0.7822014, 'precision': 0.8186347, 'recall': 0.7849462, 'specificity': 0.7849462, 'f1': 0.7768706, 'auroc': 0.9287415, 'binary_precision': 0.7067138, 'binary_recall': 0.95238096, 'binary_specificity': 0.6175115, 'binary_f1_score': 0.81135905}
confusion matrix:
     0    1
0  402  249
1   30  600
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.76778245, 'precision': 0.7982317, 'recall': 0.75776017, 'specificity': 0.75776017, 'f1': 0.75647503, 'auroc': 0.923285, 'binary_precision': 0.7164634, 'binary_recall': 0.92885375, 'binary_specificity': 0.58666664, 'binary_f1_score': 0.8089501}
confusion matrix:
     0    1
0  132   93
1   18  235
early stop counter: 1
val acc:0.7822014093399048, best validation acc: 0.8501170873641968, corresponding to test acc:                         0.8682008385658264 / 0.8682008385658264
after epoch: 2,now: 2024-07-13 18:07:09.191433,epoch time: 0:10:32.754876,used: 0:21:25.236980,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_17_45_43_seed_1_21955597
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.98792285, 'precision': 0.9584619, 'recall': 0.9069458, 'specificity': 0.9069458, 'f1': 0.9309956, 'auroc': 0.9956492, 'binary_precision': 0.9906942, 'binary_recall': 0.99666613, 'binary_specificity': 0.8172255, 'binary_f1_score': 0.9936712}
confusion matrix:
      0      1
0  1243    278
1    99  29596
---- Validation: 
scalar performance:
{'acc': 0.8485558, 'precision': 0.84881544, 'recall': 0.8487967, 'specificity': 0.8487967, 'f1': 0.84855574, 'auroc': 0.9195938, 'binary_precision': 0.83435583, 'binary_recall': 0.8634921, 'binary_specificity': 0.8341014, 'binary_f1_score': 0.848674}
confusion matrix:
     0    1
0  543  108
1   86  544
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.83054394, 'precision': 0.8298947, 'recall': 0.8303294, 'specificity': 0.8303294, 'f1': 0.83007914, 'auroc': 0.9109881, 'binary_precision': 0.844, 'binary_recall': 0.8339921, 'binary_specificity': 0.82666665, 'binary_f1_score': 0.8389662}
confusion matrix:
     0    1
0  186   39
1   42  211
early stop counter: 2
val acc:0.8485558032989502, best validation acc: 0.8501170873641968, corresponding to test acc:                         0.8682008385658264 / 0.8682008385658264
after epoch: 3,now: 2024-07-13 18:17:47.994132,epoch time: 0:10:38.802699,used: 0:32:04.039679,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_17_45_43_seed_1_21955597
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9867696, 'precision': 0.900779, 'recall': 0.97620374, 'specificity': 0.97620374, 'f1': 0.934808, 'auroc': 0.9976096, 'binary_precision': 0.9981626, 'binary_recall': 0.98791045, 'binary_specificity': 0.964497, 'binary_f1_score': 0.9930101}
confusion matrix:
      0      1
0  1467     54
1   359  29336
---- Validation: 
scalar performance:
{'acc': 0.8844653, 'precision': 0.89048016, 'recall': 0.88346136, 'specificity': 0.88346136, 'f1': 0.88379896, 'auroc': 0.93747103, 'binary_precision': 0.93501806, 'binary_recall': 0.82222223, 'binary_specificity': 0.9447005, 'binary_f1_score': 0.875}
confusion matrix:
     0    1
0  615   36
1  112  518
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8619247, 'precision': 0.88020295, 'recall': 0.8685814, 'specificity': 0.8685814, 'f1': 0.86137867, 'auroc': 0.93577516, 'binary_precision': 0.9794872, 'binary_recall': 0.7549407, 'binary_specificity': 0.9822222, 'binary_f1_score': 0.85267854}
confusion matrix:
     0    1
0  221    4
1   62  191
better model found
persisted
after epoch: 4,now: 2024-07-13 18:28:32.344080,epoch time: 0:10:44.349948,used: 0:42:48.389627,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_17_45_43_seed_1_21955597
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9928562, 'precision': 0.97190964, 'recall': 0.9497731, 'specificity': 0.9497731, 'f1': 0.96054494, 'auroc': 0.9981123, 'binary_precision': 0.99499494, 'binary_recall': 0.997508, 'binary_specificity': 0.90203816, 'binary_f1_score': 0.99624985}
confusion matrix:
      0      1
0  1372    149
1    74  29621
---- Validation: 
scalar performance:
{'acc': 0.8266979, 'precision': 0.8443261, 'recall': 0.8285458, 'specificity': 0.8285458, 'f1': 0.82497764, 'auroc': 0.93594897, 'binary_precision': 0.7622108, 'binary_recall': 0.9412698, 'binary_specificity': 0.7158218, 'binary_f1_score': 0.84232956}
confusion matrix:
     0    1
0  466  185
1   37  593
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7782427, 'precision': 0.8023107, 'recall': 0.76936316, 'specificity': 0.76936316, 'f1': 0.7693218, 'auroc': 0.93045235, 'binary_precision': 0.73040754, 'binary_recall': 0.9209486, 'binary_specificity': 0.61777776, 'binary_f1_score': 0.8146853}
confusion matrix:
     0    1
0  139   86
1   20  233
early stop counter: 1
val acc:0.8266978859901428, best validation acc: 0.8844652771949768, corresponding to test acc:                         0.8619247078895569 / 0.8682008385658264
after epoch: 5,now: 2024-07-13 18:38:59.112054,epoch time: 0:10:26.767974,used: 0:53:15.157601,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_17_45_43_seed_1_21955597
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9924718, 'precision': 0.97389203, 'recall': 0.94333315, 'specificity': 0.94333315, 'f1': 0.95804536, 'auroc': 0.998737, 'binary_precision': 0.9943285, 'binary_recall': 0.9977774, 'binary_specificity': 0.8888889, 'binary_f1_score': 0.9960499}
confusion matrix:
      0      1
0  1352    169
1    66  29629
---- Validation: 
scalar performance:
{'acc': 0.8516784, 'precision': 0.86055845, 'recall': 0.85296977, 'specificity': 0.85296977, 'f1': 0.85105306, 'auroc': 0.937042, 'binary_precision': 0.7997275, 'binary_recall': 0.931746, 'binary_specificity': 0.7741935, 'binary_f1_score': 0.86070377}
confusion matrix:
     0    1
0  504  147
1   43  587
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.84309626, 'precision': 0.84418, 'recall': 0.8409574, 'specificity': 0.8409574, 'f1': 0.8419333, 'auroc': 0.93104964, 'binary_precision': 0.83458644, 'binary_recall': 0.8774704, 'binary_specificity': 0.80444443, 'binary_f1_score': 0.85549134}
confusion matrix:
     0    1
0  181   44
1   31  222
early stop counter: 2
val acc:0.8516783714294434, best validation acc: 0.8844652771949768, corresponding to test acc:                         0.8619247078895569 / 0.8682008385658264
after epoch: 6,now: 2024-07-13 18:49:27.978156,epoch time: 0:10:28.866102,used: 1:03:44.023703,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_17_45_43_seed_1_21955597
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9912545, 'precision': 0.9345454, 'recall': 0.9779372, 'specificity': 0.9779372, 'f1': 0.9550791, 'auroc': 0.998672, 'binary_precision': 0.99810386, 'binary_recall': 0.99269235, 'binary_specificity': 0.9631821, 'binary_f1_score': 0.9953907}
confusion matrix:
      0      1
0  1465     56
1   217  29478
---- Validation: 
scalar performance:
{'acc': 0.87119436, 'precision': 0.87123203, 'recall': 0.8713262, 'specificity': 0.8713262, 'f1': 0.87118936, 'auroc': 0.93682003, 'binary_precision': 0.86158633, 'binary_recall': 0.8793651, 'binary_specificity': 0.86328727, 'binary_f1_score': 0.87038493}
confusion matrix:
     0    1
0  562   89
1   76  554
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8640167, 'precision': 0.86563814, 'recall': 0.8663768, 'specificity': 0.8663768, 'f1': 0.86400187, 'auroc': 0.9234958, 'binary_precision': 0.90869564, 'binary_recall': 0.82608694, 'binary_specificity': 0.9066667, 'binary_f1_score': 0.86542445}
confusion matrix:
     0    1
0  204   21
1   44  209
early stop counter: 3
val acc:0.8711943626403809, best validation acc: 0.8844652771949768, corresponding to test acc:                         0.8619247078895569 / 0.8682008385658264
after epoch: 7,now: 2024-07-13 19:00:01.031825,epoch time: 0:10:33.053669,used: 1:14:17.077372,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_17_45_43_seed_1_21955597
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.98737824, 'precision': 0.9006465, 'recall': 0.9855685, 'specificity': 0.9855685, 'f1': 0.9384829, 'auroc': 0.99915093, 'binary_precision': 0.99914825, 'binary_recall': 0.9875737, 'binary_specificity': 0.9835634, 'binary_f1_score': 0.99332726}
confusion matrix:
      0      1
0  1496     25
1   369  29326
---- Validation: 
scalar performance:
{'acc': 0.8649493, 'precision': 0.8752812, 'recall': 0.8635945, 'specificity': 0.8635945, 'f1': 0.8636719, 'auroc': 0.94162583, 'binary_precision': 0.93358636, 'binary_recall': 0.7809524, 'binary_specificity': 0.94623655, 'binary_f1_score': 0.8504754}
confusion matrix:
     0    1
0  616   35
1  138  492
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.84518826, 'precision': 0.8673953, 'recall': 0.85252523, 'specificity': 0.85252523, 'f1': 0.84430516, 'auroc': 0.9296442, 'binary_precision': 0.97354496, 'binary_recall': 0.72727275, 'binary_specificity': 0.9777778, 'binary_f1_score': 0.8325792}
confusion matrix:
     0    1
0  220    5
1   69  184
early stop counter: 4
val acc:0.8649492859840393, best validation acc: 0.8844652771949768, corresponding to test acc:                         0.8619247078895569 / 0.8682008385658264
after epoch: 8,now: 2024-07-13 19:10:34.629492,epoch time: 0:10:33.597667,used: 1:24:50.675039,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_17_45_43_seed_1_21955597
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9927281, 'precision': 0.9441352, 'recall': 0.98245454, 'specificity': 0.98245454, 'f1': 0.9624038, 'auroc': 0.9992534, 'binary_precision': 0.9985113, 'binary_recall': 0.99383736, 'binary_specificity': 0.97107166, 'binary_f1_score': 0.99616885}
confusion matrix:
      0      1
0  1477     44
1   183  29512
---- Validation: 
scalar performance:
{'acc': 0.8844653, 'precision': 0.8856609, 'recall': 0.8849462, 'specificity': 0.8849462, 'f1': 0.8844398, 'auroc': 0.9427743, 'binary_precision': 0.8597015, 'binary_recall': 0.9142857, 'binary_specificity': 0.85560673, 'binary_f1_score': 0.8861538}
confusion matrix:
     0    1
0  557   94
1   54  576
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8535565, 'precision': 0.8538264, 'recall': 0.85501975, 'specificity': 0.85501975, 'f1': 0.8534641, 'auroc': 0.9213878, 'binary_precision': 0.886076, 'binary_recall': 0.8300395, 'binary_specificity': 0.88, 'binary_f1_score': 0.85714287}
confusion matrix:
     0    1
0  198   27
1   43  210
early stop counter: 5
val acc:0.8844652771949768, best validation acc: 0.8844652771949768, corresponding to test acc:                         0.8619247078895569 / 0.8682008385658264
after epoch: 9,now: 2024-07-13 19:21:04.253660,epoch time: 0:10:29.624168,used: 1:35:20.299207,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_17_45_43_seed_1_21955597
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.99481034, 'precision': 0.9837419, 'recall': 0.9595332, 'specificity': 0.9595332, 'f1': 0.97129166, 'auroc': 0.99926317, 'binary_precision': 0.9959362, 'binary_recall': 0.9986193, 'binary_specificity': 0.92044705, 'binary_f1_score': 0.997276}
confusion matrix:
      0      1
0  1400    121
1    41  29654
---- Validation: 
scalar performance:
{'acc': 0.8399688, 'precision': 0.8545039, 'recall': 0.84162825, 'specificity': 0.84162825, 'f1': 0.83873606, 'auroc': 0.94045305, 'binary_precision': 0.7785059, 'binary_recall': 0.94285715, 'binary_specificity': 0.74039936, 'binary_f1_score': 0.85283566}
confusion matrix:
     0    1
0  482  169
1   36  594
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8242678, 'precision': 0.8285694, 'recall': 0.82046556, 'specificity': 0.82046556, 'f1': 0.8219961, 'auroc': 0.9181379, 'binary_precision': 0.8028674, 'binary_recall': 0.8853755, 'binary_specificity': 0.75555557, 'binary_f1_score': 0.8421053}
confusion matrix:
     0    1
0  170   55
1   29  224
early stop counter: 6
val acc:0.8399688005447388, best validation acc: 0.8844652771949768, corresponding to test acc:                         0.8619247078895569 / 0.8682008385658264
after epoch: 10,now: 2024-07-13 19:31:47.470992,epoch time: 0:10:43.217332,used: 1:46:03.516539,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_17_45_43_seed_1_21955597
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9934649, 'precision': 0.9829337, 'recall': 0.9454146, 'specificity': 0.9454146, 'f1': 0.9633306, 'auroc': 0.99927247, 'binary_precision': 0.99450016, 'binary_recall': 0.998653, 'binary_specificity': 0.8921762, 'binary_f1_score': 0.99657226}
confusion matrix:
      0      1
0  1357    164
1    40  29655
---- Validation: 
scalar performance:
{'acc': 0.7205308, 'precision': 0.7977614, 'recall': 0.7246544, 'specificity': 0.7246544, 'f1': 0.70350134, 'auroc': 0.9356326, 'binary_precision': 0.6419624, 'binary_recall': 0.97619045, 'binary_specificity': 0.47311828, 'binary_f1_score': 0.7745592}
confusion matrix:
     0    1
0  308  343
1   15  615
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6757322, 'precision': 0.77528334, 'recall': 0.6570312, 'specificity': 0.6570312, 'f1': 0.6281425, 'auroc': 0.9057356, 'binary_precision': 0.6237374, 'binary_recall': 0.97628456, 'binary_specificity': 0.33777776, 'binary_f1_score': 0.76117104}
confusion matrix:
    0    1
0  76  149
1   6  247
early stop counter: 7
val acc:0.7205308079719543, best validation acc: 0.8844652771949768, corresponding to test acc:                         0.8619247078895569 / 0.8682008385658264
after epoch: 11,now: 2024-07-13 19:42:28.907662,epoch time: 0:10:41.436670,used: 1:56:44.953209,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_17_45_43_seed_1_21955597
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.99599564, 'precision': 0.97796166, 'recall': 0.9788566, 'specificity': 0.9788566, 'f1': 0.9784087, 'auroc': 0.9995043, 'binary_precision': 0.99794567, 'binary_recall': 0.9978448, 'binary_specificity': 0.95986843, 'binary_f1_score': 0.99789524}
confusion matrix:
      0      1
0  1459     61
1    64  29632
---- Validation: 
scalar performance:
{'acc': 0.89071035, 'precision': 0.89289093, 'recall': 0.89134663, 'specificity': 0.89134663, 'f1': 0.89064634, 'auroc': 0.9514593, 'binary_precision': 0.85923755, 'binary_recall': 0.93015873, 'binary_specificity': 0.85253453, 'binary_f1_score': 0.89329267}
confusion matrix:
     0    1
0  555   96
1   44  586
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8661088, 'precision': 0.8675009, 'recall': 0.8683531, 'specificity': 0.8683531, 'f1': 0.8660877, 'auroc': 0.93440485, 'binary_precision': 0.90909094, 'binary_recall': 0.8300395, 'binary_specificity': 0.9066667, 'binary_f1_score': 0.8677686}
confusion matrix:
     0    1
0  204   21
1   43  210
better model found
persisted
after epoch: 12,now: 2024-07-13 19:53:07.310108,epoch time: 0:10:38.402446,used: 2:07:23.355655,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_17_45_43_seed_1_21955597
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.99471426, 'precision': 0.96466565, 'recall': 0.97943157, 'specificity': 0.97943157, 'f1': 0.9719193, 'auroc': 0.99936914, 'binary_precision': 0.9980773, 'binary_recall': 0.99636316, 'binary_specificity': 0.9625, 'binary_f1_score': 0.99721944}
confusion matrix:
      0      1
0  1463     57
1   108  29588
---- Validation: 
scalar performance:
{'acc': 0.85714287, 'precision': 0.8586249, 'recall': 0.85768044, 'specificity': 0.85768044, 'f1': 0.85709274, 'auroc': 0.9293175, 'binary_precision': 0.83111113, 'binary_recall': 0.89047617, 'binary_specificity': 0.8248848, 'binary_f1_score': 0.8597701}
confusion matrix:
     0    1
0  537  114
1   69  561
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8242678, 'precision': 0.82365, 'recall': 0.82440054, 'specificity': 0.82440054, 'f1': 0.82389474, 'auroc': 0.90719366, 'binary_precision': 0.84210527, 'binary_recall': 0.8221344, 'binary_specificity': 0.82666665, 'binary_f1_score': 0.832}
confusion matrix:
     0    1
0  186   39
1   45  208
early stop counter: 1
val acc:0.8571428656578064, best validation acc: 0.8907103538513184, corresponding to test acc:                         0.866108775138855 / 0.8682008385658264
after epoch: 13,now: 2024-07-13 20:03:43.665275,epoch time: 0:10:36.355167,used: 2:17:59.710822,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_17_45_43_seed_1_21955597
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9946822, 'precision': 0.9611083, 'recall': 0.98348165, 'specificity': 0.98348165, 'f1': 0.97199804, 'auroc': 0.9994564, 'binary_precision': 0.99851435, 'binary_recall': 0.9958916, 'binary_specificity': 0.97107166, 'binary_f1_score': 0.9972012}
confusion matrix:
      0      1
0  1477     44
1   122  29573
---- Validation: 
scalar performance:
{'acc': 0.85480094, 'precision': 0.8687134, 'recall': 0.8564004, 'specificity': 0.8564004, 'f1': 0.85378075, 'auroc': 0.9500743, 'binary_precision': 0.792876, 'binary_recall': 0.9539682, 'binary_specificity': 0.7588326, 'binary_f1_score': 0.8659942}
confusion matrix:
     0    1
0  494  157
1   29  601
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.84309626, 'precision': 0.8509069, 'recall': 0.838498, 'specificity': 0.838498, 'f1': 0.8404987, 'auroc': 0.9397804, 'binary_precision': 0.8111888, 'binary_recall': 0.91699606, 'binary_specificity': 0.76, 'binary_f1_score': 0.86085343}
confusion matrix:
     0    1
0  171   54
1   21  232
early stop counter: 2
val acc:0.8548009395599365, best validation acc: 0.8907103538513184, corresponding to test acc:                         0.866108775138855 / 0.8682008385658264
after epoch: 14,now: 2024-07-13 20:14:20.386047,epoch time: 0:10:36.720772,used: 2:28:36.431594,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_17_45_43_seed_1_21955597
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9927281, 'precision': 0.9428377, 'recall': 0.9843259, 'specificity': 0.9843259, 'f1': 0.9625375, 'auroc': 0.9994372, 'binary_precision': 0.9987138, 'binary_recall': 0.9936353, 'binary_specificity': 0.9750164, 'binary_f1_score': 0.996168}
confusion matrix:
      0      1
0  1483     38
1   189  29506
---- Validation: 
scalar performance:
{'acc': 0.863388, 'precision': 0.86386496, 'recall': 0.8630824, 'specificity': 0.8630824, 'f1': 0.86324096, 'auroc': 0.9339136, 'binary_precision': 0.87356323, 'binary_recall': 0.84444445, 'binary_specificity': 0.8817204, 'binary_f1_score': 0.8587571}
confusion matrix:
     0    1
0  574   77
1   98  532
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.832636, 'precision': 0.83899546, 'recall': 0.83673257, 'specificity': 0.83673257, 'f1': 0.8325627, 'auroc': 0.90650856, 'binary_precision': 0.9023256, 'binary_recall': 0.76679844, 'binary_specificity': 0.9066667, 'binary_f1_score': 0.82905984}
confusion matrix:
     0    1
0  204   21
1   59  194
early stop counter: 3
val acc:0.8633880019187927, best validation acc: 0.8907103538513184, corresponding to test acc:                         0.866108775138855 / 0.8682008385658264
after epoch: 15,now: 2024-07-13 20:24:48.371812,epoch time: 0:10:27.985765,used: 2:39:04.417359,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_17_45_43_seed_1_21955597
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.99327266, 'precision': 0.9447653, 'recall': 0.9883548, 'specificity': 0.9883548, 'f1': 0.9654148, 'auroc': 0.99955237, 'binary_precision': 0.99911976, 'binary_recall': 0.9938037, 'binary_specificity': 0.982906, 'binary_f1_score': 0.99645466}
confusion matrix:
      0      1
0  1495     26
1   184  29511
---- Validation: 
scalar performance:
{'acc': 0.8899298, 'precision': 0.89147496, 'recall': 0.88942647, 'specificity': 0.88942647, 'f1': 0.88970363, 'auroc': 0.9431668, 'binary_precision': 0.9123103, 'binary_recall': 0.85873014, 'binary_specificity': 0.92012286, 'binary_f1_score': 0.8847098}
confusion matrix:
     0    1
0  599   52
1   89  541
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8200837, 'precision': 0.8299196, 'recall': 0.8251208, 'specificity': 0.8251208, 'f1': 0.8198282, 'auroc': 0.90536666, 'binary_precision': 0.90338165, 'binary_recall': 0.73913044, 'binary_specificity': 0.9111111, 'binary_f1_score': 0.8130435}
confusion matrix:
     0    1
0  205   20
1   66  187
early stop counter: 4
val acc:0.8899297714233398, best validation acc: 0.8907103538513184, corresponding to test acc:                         0.866108775138855 / 0.8682008385658264
after epoch: 16,now: 2024-07-13 20:35:20.619672,epoch time: 0:10:32.247860,used: 2:49:36.665219,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_17_45_43_seed_1_21955597
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9942978, 'precision': 0.95737433, 'recall': 0.98357296, 'specificity': 0.98357296, 'f1': 0.97006476, 'auroc': 0.99944043, 'binary_precision': 0.99854755, 'binary_recall': 0.9954541, 'binary_specificity': 0.9716919, 'binary_f1_score': 0.9969984}
confusion matrix:
      0      1
0  1476     43
1   135  29562
---- Validation: 
scalar performance:
{'acc': 0.87822014, 'precision': 0.88148135, 'recall': 0.87747055, 'specificity': 0.87747055, 'f1': 0.87777853, 'auroc': 0.94474673, 'binary_precision': 0.912892, 'binary_recall': 0.83174604, 'binary_specificity': 0.92319506, 'binary_f1_score': 0.8704319}
confusion matrix:
     0    1
0  601   50
1  106  524
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.83472806, 'precision': 0.85568345, 'recall': 0.841906, 'specificity': 0.841906, 'f1': 0.83383715, 'auroc': 0.9391304, 'binary_precision': 0.95789474, 'binary_recall': 0.71936756, 'binary_specificity': 0.96444446, 'binary_f1_score': 0.8216704}
confusion matrix:
     0    1
0  217    8
1   71  182
early stop counter: 5
val acc:0.8782201409339905, best validation acc: 0.8907103538513184, corresponding to test acc:                         0.866108775138855 / 0.8682008385658264
after epoch: 17,now: 2024-07-13 20:46:10.340249,epoch time: 0:10:49.720577,used: 3:00:26.385796,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_17_45_43_seed_1_21955597
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.99596363, 'precision': 0.9754211, 'recall': 0.9813481, 'specificity': 0.9813481, 'f1': 0.9783641, 'auroc': 0.99954545, 'binary_precision': 0.998214, 'binary_recall': 0.99754167, 'binary_specificity': 0.9651545, 'binary_f1_score': 0.9978777}
confusion matrix:
      0      1
0  1468     53
1    73  29622
---- Validation: 
scalar performance:
{'acc': 0.8462139, 'precision': 0.8498807, 'recall': 0.8453661, 'specificity': 0.8453661, 'f1': 0.8455498, 'auroc': 0.92651355, 'binary_precision': 0.8818342, 'binary_recall': 0.7936508, 'binary_specificity': 0.89708143, 'binary_f1_score': 0.8354219}
confusion matrix:
     0    1
0  584   67
1  130  500
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.80543935, 'precision': 0.82655907, 'recall': 0.8127624, 'specificity': 0.8127624, 'f1': 0.8042666, 'auroc': 0.9111638, 'binary_precision': 0.9255319, 'binary_recall': 0.68774706, 'binary_specificity': 0.93777776, 'binary_f1_score': 0.7891157}
confusion matrix:
     0    1
0  211   14
1   79  174
early stop counter: 6
val acc:0.8462138772010803, best validation acc: 0.8907103538513184, corresponding to test acc:                         0.866108775138855 / 0.8682008385658264
after epoch: 18,now: 2024-07-13 20:56:57.989953,epoch time: 0:10:47.649704,used: 3:11:14.035500,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_17_45_43_seed_1_21955597
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.99349695, 'precision': 0.9457585, 'recall': 0.9897203, 'specificity': 0.9897203, 'f1': 0.96657753, 'auroc': 0.999627, 'binary_precision': 0.9992551, 'binary_recall': 0.9939047, 'binary_specificity': 0.98553586, 'binary_f1_score': 0.99657273}
confusion matrix:
      0      1
0  1499     22
1   181  29514
---- Validation: 
scalar performance:
{'acc': 0.8985168, 'precision': 0.90003014, 'recall': 0.8980287, 'specificity': 0.8980287, 'f1': 0.8983154, 'auroc': 0.9484944, 'binary_precision': 0.92087543, 'binary_recall': 0.86825395, 'binary_specificity': 0.9278034, 'binary_f1_score': 0.8937909}
confusion matrix:
     0    1
0  604   47
1   83  547
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.85983264, 'precision': 0.8721018, 'recall': 0.8653755, 'specificity': 0.8653755, 'f1': 0.85956156, 'auroc': 0.9295389, 'binary_precision': 0.9558824, 'binary_recall': 0.770751, 'binary_specificity': 0.96, 'binary_f1_score': 0.8533917}
confusion matrix:
     0    1
0  216    9
1   58  195
better model found
persisted
after epoch: 19,now: 2024-07-13 21:07:34.663991,epoch time: 0:10:36.674038,used: 3:21:50.709538,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_17_45_43_seed_1_21955597
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9964121, 'precision': 0.9838627, 'recall': 0.9772173, 'specificity': 0.9772173, 'f1': 0.9805144, 'auroc': 0.9996125, 'binary_precision': 0.9977454, 'binary_recall': 0.9984846, 'binary_specificity': 0.95595, 'binary_f1_score': 0.9981148}
confusion matrix:
      0      1
0  1454     67
1    45  29650
---- Validation: 
scalar performance:
{'acc': 0.8883685, 'precision': 0.889788, 'recall': 0.8888889, 'specificity': 0.8888889, 'f1': 0.8883356, 'auroc': 0.9518372, 'binary_precision': 0.8618128, 'binary_recall': 0.9206349, 'binary_specificity': 0.85714287, 'binary_f1_score': 0.8902533}
confusion matrix:
     0    1
0  558   93
1   50  580
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8661088, 'precision': 0.8667017, 'recall': 0.8678613, 'specificity': 0.8678613, 'f1': 0.8660502, 'auroc': 0.94036007, 'binary_precision': 0.9021277, 'binary_recall': 0.8379447, 'binary_specificity': 0.8977778, 'binary_f1_score': 0.8688525}
confusion matrix:
     0    1
0  202   23
1   41  212
early stop counter: 1
val acc:0.8883684873580933, best validation acc: 0.8985167741775513, corresponding to test acc:                         0.8598326444625854 / 0.8682008385658264
after epoch: 20,now: 2024-07-13 21:17:32.843458,epoch time: 0:09:58.179467,used: 3:31:48.889005,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_17_45_43_seed_1_21955597
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.99535495, 'precision': 0.9869914, 'recall': 0.96231455, 'specificity': 0.96231455, 'f1': 0.9742959, 'auroc': 0.99945664, 'binary_precision': 0.996205, 'binary_recall': 0.99892235, 'binary_specificity': 0.92570674, 'binary_f1_score': 0.9975618}
confusion matrix:
      0      1
0  1408    113
1    32  29663
---- Validation: 
scalar performance:
{'acc': 0.8704137, 'precision': 0.8712142, 'recall': 0.87081414, 'specificity': 0.87081414, 'f1': 0.8704004, 'auroc': 0.9381927, 'binary_precision': 0.8493976, 'binary_recall': 0.8952381, 'binary_specificity': 0.8463902, 'binary_f1_score': 0.87171566}
confusion matrix:
     0    1
0  551  100
1   66  564
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8410042, 'precision': 0.8501983, 'recall': 0.8458674, 'specificity': 0.8458674, 'f1': 0.84082586, 'auroc': 0.9332104, 'binary_precision': 0.923445, 'binary_recall': 0.7628459, 'binary_specificity': 0.9288889, 'binary_f1_score': 0.83549786}
confusion matrix:
     0    1
0  209   16
1   60  193
early stop counter: 2
val acc:0.8704137206077576, best validation acc: 0.8985167741775513, corresponding to test acc:                         0.8598326444625854 / 0.8682008385658264
after epoch: 21,now: 2024-07-13 21:27:30.782853,epoch time: 0:09:57.939395,used: 3:41:46.828400,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_17_45_43_seed_1_21955597
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9963801, 'precision': 0.9829487, 'recall': 0.9778243, 'specificity': 0.9778243, 'f1': 0.98037124, 'auroc': 0.99952745, 'binary_precision': 0.99781233, 'binary_recall': 0.9983836, 'binary_specificity': 0.95726496, 'binary_f1_score': 0.99809784}
confusion matrix:
      0      1
0  1456     65
1    48  29647
---- Validation: 
scalar performance:
{'acc': 0.8485558, 'precision': 0.8604934, 'recall': 0.85005116, 'specificity': 0.85005116, 'f1': 0.8476458, 'auroc': 0.9405652, 'binary_precision': 0.79066664, 'binary_recall': 0.9412698, 'binary_specificity': 0.7588326, 'binary_f1_score': 0.85942024}
confusion matrix:
     0    1
0  494  157
1   37  593
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.87656903, 'precision': 0.87690544, 'recall': 0.87528324, 'specificity': 0.87528324, 'f1': 0.8759037, 'auroc': 0.9350022, 'binary_precision': 0.8730769, 'binary_recall': 0.8972332, 'binary_specificity': 0.85333335, 'binary_f1_score': 0.8849902}
confusion matrix:
     0    1
0  192   33
1   26  227
new oracle model saved
early stop counter: 3
val acc:0.8485558032989502, best validation acc: 0.8985167741775513, corresponding to test acc:                         0.8598326444625854 / 0.8765690326690674
after epoch: 22,now: 2024-07-13 21:37:28.322331,epoch time: 0:09:57.539478,used: 3:51:44.367878,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_17_45_43_seed_1_21955597
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.99589956, 'precision': 0.9837327, 'recall': 0.9716457, 'specificity': 0.9716457, 'f1': 0.977604, 'auroc': 0.99955094, 'binary_precision': 0.99717504, 'binary_recall': 0.9985183, 'binary_specificity': 0.9447732, 'binary_f1_score': 0.9978462}
confusion matrix:
      0      1
0  1437     84
1    44  29651
---- Validation: 
scalar performance:
{'acc': 0.86729115, 'precision': 0.8757738, 'recall': 0.8685356, 'specificity': 0.8685356, 'f1': 0.8667845, 'auroc': 0.95010126, 'binary_precision': 0.8150685, 'binary_recall': 0.9444444, 'binary_specificity': 0.79262674, 'binary_f1_score': 0.875}
confusion matrix:
     0    1
0  516  135
1   35  595
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.88284516, 'precision': 0.883774, 'recall': 0.8812121, 'specificity': 0.8812121, 'f1': 0.8821001, 'auroc': 0.94633293, 'binary_precision': 0.8745247, 'binary_recall': 0.90909094, 'binary_specificity': 0.85333335, 'binary_f1_score': 0.89147294}
confusion matrix:
     0    1
0  192   33
1   23  230
new oracle model saved
early stop counter: 4
val acc:0.8672911524772644, best validation acc: 0.8985167741775513, corresponding to test acc:                         0.8598326444625854 / 0.8828451633453369
after epoch: 23,now: 2024-07-13 21:47:24.603626,epoch time: 0:09:56.281295,used: 4:01:40.649173,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_17_45_43_seed_1_21955597
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.99708486, 'precision': 0.98769253, 'recall': 0.9806899, 'specificity': 0.9806899, 'f1': 0.984163, 'auroc': 0.99966323, 'binary_precision': 0.998082, 'binary_recall': 0.99885505, 'binary_specificity': 0.96252465, 'binary_f1_score': 0.9984684}
confusion matrix:
      0      1
0  1464     57
1    34  29661
---- Validation: 
scalar performance:
{'acc': 0.8899298, 'precision': 0.8905922, 'recall': 0.89029694, 'specificity': 0.89029694, 'f1': 0.889923, 'auroc': 0.9518104, 'binary_precision': 0.8698941, 'binary_recall': 0.9126984, 'binary_specificity': 0.86789554, 'binary_f1_score': 0.8907823}
confusion matrix:
     0    1
0  565   86
1   55  575
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.87656903, 'precision': 0.87871933, 'recall': 0.8792183, 'specificity': 0.8792183, 'f1': 0.87656426, 'auroc': 0.9397805, 'binary_precision': 0.9254386, 'binary_recall': 0.8339921, 'binary_specificity': 0.92444444, 'binary_f1_score': 0.87733895}
confusion matrix:
     0    1
0  208   17
1   42  211
early stop counter: 5
val acc:0.8899297714233398, best validation acc: 0.8985167741775513, corresponding to test acc:                         0.8598326444625854 / 0.8828451633453369
after epoch: 24,now: 2024-07-13 21:57:18.367632,epoch time: 0:09:53.764006,used: 4:11:34.413179,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_17_45_43_seed_1_21955597
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.9955151, 'precision': 0.9871135, 'recall': 0.9639582, 'specificity': 0.9639582, 'f1': 0.97522205, 'auroc': 0.99960244, 'binary_precision': 0.9963723, 'binary_recall': 0.99892235, 'binary_specificity': 0.92899406, 'binary_f1_score': 0.99764574}
confusion matrix:
      0      1
0  1413    108
1    32  29663
---- Validation: 
scalar performance:
{'acc': 0.8758782, 'precision': 0.8802992, 'recall': 0.8767793, 'specificity': 0.8767793, 'f1': 0.8756733, 'auroc': 0.94793904, 'binary_precision': 0.8349929, 'binary_recall': 0.931746, 'binary_specificity': 0.82181257, 'binary_f1_score': 0.8807202}
confusion matrix:
     0    1
0  535  116
1   43  587
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8786611, 'precision': 0.87809753, 'recall': 0.8787352, 'specificity': 0.8787352, 'f1': 0.87835443, 'auroc': 0.9420817, 'binary_precision': 0.8915663, 'binary_recall': 0.8774704, 'binary_specificity': 0.88, 'binary_f1_score': 0.8844622}
confusion matrix:
     0    1
0  198   27
1   31  222
early stop counter: 6
val acc:0.8758782148361206, best validation acc: 0.8985167741775513, corresponding to test acc:                         0.8598326444625854 / 0.8828451633453369
after epoch: 25,now: 2024-07-13 22:07:11.443842,epoch time: 0:09:53.076210,used: 4:21:27.489389,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_17_45_43_seed_1_21955597
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9971489, 'precision': 0.9838829, 'recall': 0.98539287, 'specificity': 0.98539287, 'f1': 0.98463655, 'auroc': 0.99964803, 'binary_precision': 0.9985854, 'binary_recall': 0.9984173, 'binary_specificity': 0.9723684, 'binary_f1_score': 0.99850136}
confusion matrix:
      0      1
0  1478     42
1    47  29649
---- Validation: 
scalar performance:
{'acc': 0.88368464, 'precision': 0.8859277, 'recall': 0.8843318, 'specificity': 0.8843318, 'f1': 0.883612, 'auroc': 0.95203227, 'binary_precision': 0.85212296, 'binary_recall': 0.9238095, 'binary_specificity': 0.84485406, 'binary_f1_score': 0.8865194}
confusion matrix:
     0    1
0  550  101
1   48  582
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.88075316, 'precision': 0.8806373, 'recall': 0.88194114, 'specificity': 0.88194114, 'f1': 0.8806356, 'auroc': 0.9488801, 'binary_precision': 0.90833336, 'binary_recall': 0.86166006, 'binary_specificity': 0.9022222, 'binary_f1_score': 0.88438135}
confusion matrix:
     0    1
0  203   22
1   35  218
early stop counter: 7
val acc:0.8836846351623535, best validation acc: 0.8985167741775513, corresponding to test acc:                         0.8598326444625854 / 0.8828451633453369
after epoch: 26,now: 2024-07-13 22:17:09.495401,epoch time: 0:09:58.051559,used: 4:31:25.540948,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_17_45_43_seed_1_21955597
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.9949065, 'precision': 0.96139264, 'recall': 0.98578274, 'specificity': 0.98578274, 'f1': 0.9732357, 'auroc': 0.9994376, 'binary_precision': 0.99875045, 'binary_recall': 0.9958916, 'binary_specificity': 0.9756739, 'binary_f1_score': 0.9973189}
confusion matrix:
      0      1
0  1484     37
1   122  29573
---- Validation: 
scalar performance:
{'acc': 0.8758782, 'precision': 0.87586105, 'recall': 0.87596005, 'specificity': 0.87596005, 'f1': 0.87586725, 'auroc': 0.9448199, 'binary_precision': 0.8685446, 'binary_recall': 0.88095236, 'binary_specificity': 0.87096775, 'binary_f1_score': 0.8747044}
confusion matrix:
     0    1
0  567   84
1   75  555
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8619247, 'precision': 0.86773664, 'recall': 0.8658762, 'specificity': 0.8658762, 'f1': 0.861886, 'auroc': 0.9430479, 'binary_precision': 0.9308756, 'binary_recall': 0.798419, 'binary_specificity': 0.93333334, 'binary_f1_score': 0.85957456}
confusion matrix:
     0    1
0  210   15
1   51  202
early stop counter: 8
val acc:0.8758782148361206, best validation acc: 0.8985167741775513, corresponding to test acc:                         0.8598326444625854 / 0.8828451633453369
after epoch: 27,now: 2024-07-13 22:27:07.527564,epoch time: 0:09:58.032163,used: 4:41:23.573111,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_17_45_43_seed_1_21955597
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.9946181, 'precision': 0.9615251, 'recall': 0.9822004, 'specificity': 0.9822004, 'f1': 0.971609, 'auroc': 0.9994217, 'binary_precision': 0.99837965, 'binary_recall': 0.9959589, 'binary_specificity': 0.96844184, 'binary_f1_score': 0.9971678}
confusion matrix:
      0      1
0  1473     48
1   120  29575
---- Validation: 
scalar performance:
{'acc': 0.90163934, 'precision': 0.90166074, 'recall': 0.90176654, 'specificity': 0.90176654, 'f1': 0.90163445, 'auroc': 0.9520128, 'binary_precision': 0.89252335, 'binary_recall': 0.9095238, 'binary_specificity': 0.89400923, 'binary_f1_score': 0.9009434}
confusion matrix:
     0    1
0  582   69
1   57  573
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9079498, 'precision': 0.90855443, 'recall': 0.9098463, 'specificity': 0.9098463, 'f1': 0.9079095, 'auroc': 0.96093106, 'binary_precision': 0.94468087, 'binary_recall': 0.8774704, 'binary_specificity': 0.94222224, 'binary_f1_score': 0.9098361}
confusion matrix:
     0    1
0  212   13
1   31  222
new oracle model saved
better model found
persisted
after epoch: 28,now: 2024-07-13 22:37:06.093181,epoch time: 0:09:58.565617,used: 4:51:22.138728,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_17_45_43_seed_1_21955597
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.99618787, 'precision': 0.9807349, 'recall': 0.9780351, 'specificity': 0.9780351, 'f1': 0.9793808, 'auroc': 0.99953115, 'binary_precision': 0.9978454, 'binary_recall': 0.99814785, 'binary_specificity': 0.9579224, 'binary_f1_score': 0.9979966}
confusion matrix:
      0      1
0  1457     64
1    55  29640
---- Validation: 
scalar performance:
{'acc': 0.8930523, 'precision': 0.8932202, 'recall': 0.8928827, 'specificity': 0.8928827, 'f1': 0.89298546, 'auroc': 0.94586897, 'binary_precision': 0.8982229, 'binary_recall': 0.8825397, 'binary_specificity': 0.9032258, 'binary_f1_score': 0.89031225}
confusion matrix:
     0    1
0  588   63
1   74  556
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8786611, 'precision': 0.8837997, 'recall': 0.88242424, 'specificity': 0.88242424, 'f1': 0.87864196, 'auroc': 0.93906015, 'binary_precision': 0.94520545, 'binary_recall': 0.8181818, 'binary_specificity': 0.94666666, 'binary_f1_score': 0.87711865}
confusion matrix:
     0    1
0  213   12
1   46  207
early stop counter: 1
val acc:0.8930522799491882, best validation acc: 0.9016393423080444, corresponding to test acc:                         0.9079498052597046 / 0.9079498052597046
after epoch: 29,now: 2024-07-13 22:46:58.865165,epoch time: 0:09:52.771984,used: 5:01:14.910712,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_17_45_43_seed_1_21955597
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.99445796, 'precision': 0.99327147, 'recall': 0.9465604, 'specificity': 0.9465604, 'f1': 0.96862686, 'auroc': 0.9996309, 'binary_precision': 0.99457216, 'binary_recall': 0.99962956, 'binary_specificity': 0.89349115, 'binary_f1_score': 0.9970945}
confusion matrix:
      0      1
0  1359    162
1    11  29684
---- Validation: 
scalar performance:
{'acc': 0.8235753, 'precision': 0.85295355, 'recall': 0.8259344, 'specificity': 0.8259344, 'f1': 0.82052505, 'auroc': 0.95364034, 'binary_precision': 0.7469438, 'binary_recall': 0.96984124, 'binary_specificity': 0.68202764, 'binary_f1_score': 0.8439227}
confusion matrix:
     0    1
0  444  207
1   19  611
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8556485, 'precision': 0.8724345, 'recall': 0.849372, 'specificity': 0.849372, 'f1': 0.8520051, 'auroc': 0.96240664, 'binary_precision': 0.8066667, 'binary_recall': 0.95652175, 'binary_specificity': 0.74222225, 'binary_f1_score': 0.8752261}
confusion matrix:
     0    1
0  167   58
1   11  242
early stop counter: 2
val acc:0.8235753178596497, best validation acc: 0.9016393423080444, corresponding to test acc:                         0.9079498052597046 / 0.9079498052597046
after epoch: 30,now: 2024-07-13 22:57:03.225111,epoch time: 0:10:04.359946,used: 5:11:19.270658,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_17_45_43_seed_1_21955597
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 5:11:19.270658 at 2024-07-13 22:57:03.225111
persisted model performance metric: 

scalar performance:
{'acc': 0.9079498, 'precision': 0.90855443, 'recall': 0.9098463, 'specificity': 0.9098463, 'f1': 0.9079095, 'auroc': 0.96093106, 'binary_precision': 0.94468087, 'binary_recall': 0.8774704, 'binary_specificity': 0.94222224, 'binary_f1_score': 0.9098361}
confusion matrix:
     0    1
0  212   13
1   31  222
oracle model performance metric: 

scalar performance:
{'acc': 0.9079498, 'precision': 0.90855443, 'recall': 0.9098463, 'specificity': 0.9098463, 'f1': 0.9079095, 'auroc': 0.96093106, 'binary_precision': 0.94468087, 'binary_recall': 0.8774704, 'binary_specificity': 0.94222224, 'binary_f1_score': 0.9098361}
confusion matrix:
     0    1
0  212   13
1   31  222
results aggregation path: zoutput/benchmarks/CAMELYONWILD_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_halffreeze/rule_results/5.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONWILD_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_halffreeze/confusion_matrix/5.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 318521 KiB |   6782 MiB | 580993 GiB | 580993 GiB |
|       from large pool | 291339 KiB |   6756 MiB | 571695 GiB | 571694 GiB |
|       from small pool |  27182 KiB |     43 MiB |   9298 GiB |   9298 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 318521 KiB |   6782 MiB | 580993 GiB | 580993 GiB |
|       from large pool | 291339 KiB |   6756 MiB | 571695 GiB | 571694 GiB |
|       from small pool |  27182 KiB |     43 MiB |   9298 GiB |   9298 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 313851 KiB |   6778 MiB | 579892 GiB | 579892 GiB |
|       from large pool | 286862 KiB |   6752 MiB | 570615 GiB | 570614 GiB |
|       from small pool |  26989 KiB |     43 MiB |   9277 GiB |   9277 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   7456 MiB |   7456 MiB |  14314 MiB |   6858 MiB |
|       from large pool |   7404 MiB |   7404 MiB |  14248 MiB |   6844 MiB |
|       from small pool |     52 MiB |     52 MiB |     66 MiB |     14 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 285638 KiB | 680184 KiB | 453941 GiB | 453941 GiB |
|       from large pool | 275957 KiB | 675647 KiB | 444630 GiB | 444630 GiB |
|       from small pool |   9681 KiB |  30499 KiB |   9310 GiB |   9310 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    1058    |    4649    |  118417 K  |  118416 K  |
|       from large pool |     130    |     756    |   53912 K  |   53912 K  |
|       from small pool |     928    |    4517    |   64505 K  |   64504 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    1058    |    4649    |  118417 K  |  118416 K  |
|       from large pool |     130    |     756    |   53912 K  |   53912 K  |
|       from small pool |     928    |    4517    |   64505 K  |   64504 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     335    |     335    |     626    |     291    |
|       from large pool |     309    |     309    |     593    |     284    |
|       from small pool |      26    |      26    |      33    |       7    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      72    |    1997    |   70654 K  |   70654 K  |
|       from large pool |      27    |     307    |   41565 K  |   41565 K  |
|       from small pool |      45    |    1971    |   29089 K  |   29089 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   6782 MiB | 580993 GiB | 580993 GiB |
|       from large pool |  16640 KiB |   6756 MiB | 571695 GiB | 571695 GiB |
|       from small pool |      0 KiB |     43 MiB |   9298 GiB |   9298 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   6782 MiB | 580993 GiB | 580993 GiB |
|       from large pool |  16640 KiB |   6756 MiB | 571695 GiB | 571695 GiB |
|       from small pool |      0 KiB |     43 MiB |   9298 GiB |   9298 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   6778 MiB | 579892 GiB | 579892 GiB |
|       from large pool |  16640 KiB |   6752 MiB | 570615 GiB | 570615 GiB |
|       from small pool |      0 KiB |     43 MiB |   9277 GiB |   9277 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 604160 KiB |   7456 MiB |  14314 MiB |  13724 MiB |
|       from large pool | 567296 KiB |   7404 MiB |  14248 MiB |  13694 MiB |
|       from small pool |  36864 KiB |     52 MiB |     66 MiB |     30 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 680184 KiB | 453941 GiB | 453941 GiB |
|       from large pool |  24320 KiB | 675647 KiB | 444630 GiB | 444630 GiB |
|       from small pool |      0 KiB |  30502 KiB |   9310 GiB |   9310 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    4649    |  118417 K  |  118417 K  |
|       from large pool |       2    |     756    |   53912 K  |   53912 K  |
|       from small pool |       0    |    4517    |   64505 K  |   64505 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    4649    |  118417 K  |  118417 K  |
|       from large pool |       2    |     756    |   53912 K  |   53912 K  |
|       from small pool |       0    |    4517    |   64505 K  |   64505 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      43    |     335    |     626    |     583    |
|       from large pool |      25    |     309    |     593    |     568    |
|       from small pool |      18    |      26    |      33    |      15    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    1997    |   70654 K  |   70654 K  |
|       from large pool |       3    |     307    |   41565 K  |   41565 K  |
|       from small pool |       0    |    1971    |   29089 K  |   29089 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   6782 MiB | 580993 GiB | 580993 GiB |
|       from large pool |  16640 KiB |   6756 MiB | 571695 GiB | 571695 GiB |
|       from small pool |      0 KiB |     43 MiB |   9298 GiB |   9298 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   6782 MiB | 580993 GiB | 580993 GiB |
|       from large pool |  16640 KiB |   6756 MiB | 571695 GiB | 571695 GiB |
|       from small pool |      0 KiB |     43 MiB |   9298 GiB |   9298 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   6778 MiB | 579892 GiB | 579892 GiB |
|       from large pool |  16640 KiB |   6752 MiB | 570615 GiB | 570615 GiB |
|       from small pool |      0 KiB |     43 MiB |   9277 GiB |   9277 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 604160 KiB |   7456 MiB |  14314 MiB |  13724 MiB |
|       from large pool | 567296 KiB |   7404 MiB |  14248 MiB |  13694 MiB |
|       from small pool |  36864 KiB |     52 MiB |     66 MiB |     30 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 680184 KiB | 453941 GiB | 453941 GiB |
|       from large pool |  24320 KiB | 675647 KiB | 444630 GiB | 444630 GiB |
|       from small pool |      0 KiB |  30502 KiB |   9310 GiB |   9310 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    4649    |  118417 K  |  118417 K  |
|       from large pool |       2    |     756    |   53912 K  |   53912 K  |
|       from small pool |       0    |    4517    |   64505 K  |   64505 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    4649    |  118417 K  |  118417 K  |
|       from large pool |       2    |     756    |   53912 K  |   53912 K  |
|       from small pool |       0    |    4517    |   64505 K  |   64505 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      43    |     335    |     626    |     583    |
|       from large pool |      25    |     309    |     593    |     568    |
|       from small pool |      18    |      26    |      33    |      15    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    1997    |   70654 K  |   70654 K  |
|       from large pool |       3    |     307    |   41565 K  |   41565 K  |
|       from small pool |       0    |    1971    |   29089 K  |   29089 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_23_10_41_seed_2_21955597

 Experiment start at: 2024-07-13 23:10:41.717325
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
before training, model accuracy: 0.3810526132583618
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9804309, 'precision': 0.9206816, 'recall': 0.8547853, 'specificity': 0.8547853, 'f1': 0.88460755, 'auroc': 0.99066937, 'binary_precision': 0.9856849, 'binary_recall': 0.9938714, 'binary_specificity': 0.7156992, 'binary_f1_score': 0.9897612}
confusion matrix:
      0      1
0  1085    431
1   183  29677
---- Validation: 
scalar performance:
{'acc': 0.5798122, 'precision': 0.7422432, 'recall': 0.5904096, 'specificity': 0.5904096, 'f1': 0.50774336, 'auroc': 0.91041696, 'binary_precision': 0.5371179, 'binary_recall': 0.988746, 'binary_specificity': 0.19207317, 'binary_f1_score': 0.69609505}
confusion matrix:
     0    1
0  126  530
1    7  615
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.62526315, 'precision': 0.7729572, 'recall': 0.5887316, 'specificity': 0.5887316, 'f1': 0.526426, 'auroc': 0.91008866, 'binary_precision': 0.5935335, 'binary_recall': 0.992278, 'binary_specificity': 0.18518518, 'binary_f1_score': 0.74277455}
confusion matrix:
    0    1
0  40  176
1   2  257
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-13 23:20:53.756370,epoch time: 0:10:12.039045,used: 0:10:12.039045,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_23_10_41_seed_2_21955597
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9871558, 'precision': 0.92152965, 'recall': 0.9428475, 'specificity': 0.9428475, 'f1': 0.93189275, 'auroc': 0.9958663, 'binary_precision': 0.9945935, 'binary_recall': 0.9918955, 'binary_specificity': 0.8937995, 'binary_f1_score': 0.9932426}
confusion matrix:
      0      1
0  1355    161
1   242  29618
---- Validation: 
scalar performance:
{'acc': 0.73239434, 'precision': 0.79642755, 'recall': 0.73845434, 'specificity': 0.73845434, 'f1': 0.72027636, 'auroc': 0.92005527, 'binary_precision': 0.65184385, 'binary_recall': 0.96623796, 'binary_specificity': 0.5106707, 'binary_f1_score': 0.7784974}
confusion matrix:
     0    1
0  335  321
1   21  601
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.70526314, 'precision': 0.76933336, 'recall': 0.6805377, 'specificity': 0.6805377, 'f1': 0.6680709, 'auroc': 0.9175426, 'binary_precision': 0.6586667, 'binary_recall': 0.95366794, 'binary_specificity': 0.4074074, 'binary_f1_score': 0.7791798}
confusion matrix:
    0    1
0  88  128
1  12  247
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-07-13 23:31:22.202713,epoch time: 0:10:28.446343,used: 0:20:40.485388,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_23_10_41_seed_2_21955597
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9859447, 'precision': 0.9733757, 'recall': 0.8692658, 'specificity': 0.8692658, 'f1': 0.91420615, 'auroc': 0.99650407, 'binary_precision': 0.98695666, 'binary_recall': 0.99842596, 'binary_specificity': 0.74010557, 'binary_f1_score': 0.9926582}
confusion matrix:
      0      1
0  1122    394
1    47  29813
---- Validation: 
scalar performance:
{'acc': 0.68075114, 'precision': 0.78270507, 'recall': 0.6885661, 'specificity': 0.6885661, 'f1': 0.65454423, 'auroc': 0.93107957, 'binary_precision': 0.6061508, 'binary_recall': 0.9823151, 'binary_specificity': 0.39481708, 'binary_f1_score': 0.7496933}
confusion matrix:
     0    1
0  259  397
1   11  611
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6421053, 'precision': 0.76581335, 'recall': 0.6080187, 'specificity': 0.6080187, 'f1': 0.5601852, 'auroc': 0.93506, 'binary_precision': 0.60570073, 'binary_recall': 0.98455596, 'binary_specificity': 0.23148148, 'binary_f1_score': 0.75}
confusion matrix:
    0    1
0  50  166
1   4  255
early stop counter: 1
val acc:0.6807511448860168, best validation acc: 0.7323943376541138, corresponding to test acc:                         0.7052631378173828 / 0.7052631378173828
after epoch: 3,now: 2024-07-13 23:41:19.484990,epoch time: 0:09:57.282277,used: 0:30:37.767665,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_23_10_41_seed_2_21955597
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9903111, 'precision': 0.95425844, 'recall': 0.93886995, 'specificity': 0.93886995, 'f1': 0.94641614, 'auroc': 0.9972936, 'binary_precision': 0.9940162, 'binary_recall': 0.9958138, 'binary_specificity': 0.8819261, 'binary_f1_score': 0.9949141}
confusion matrix:
      0      1
0  1337    179
1   125  29735
---- Validation: 
scalar performance:
{'acc': 0.79577464, 'precision': 0.82669276, 'recall': 0.7998172, 'specificity': 0.7998172, 'f1': 0.7922268, 'auroc': 0.93371105, 'binary_precision': 0.7193196, 'binary_recall': 0.9517685, 'binary_specificity': 0.64786583, 'binary_f1_score': 0.8193772}
confusion matrix:
     0    1
0  425  231
1   30  592
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.79157895, 'precision': 0.81540006, 'recall': 0.77775097, 'specificity': 0.77775097, 'f1': 0.78065574, 'auroc': 0.9325932, 'binary_precision': 0.7484472, 'binary_recall': 0.93050194, 'binary_specificity': 0.625, 'binary_f1_score': 0.82960415}
confusion matrix:
     0    1
0  135   81
1   18  241
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-07-13 23:51:13.863127,epoch time: 0:09:54.378137,used: 0:40:32.145802,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_23_10_41_seed_2_21955597
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.990566, 'precision': 0.94821286, 'recall': 0.9493352, 'specificity': 0.9493352, 'f1': 0.94877326, 'auroc': 0.9975854, 'binary_precision': 0.99510986, 'binary_recall': 0.9949766, 'binary_specificity': 0.9036939, 'binary_f1_score': 0.9950432}
confusion matrix:
      0      1
0  1370    146
1   150  29710
---- Validation: 
scalar performance:
{'acc': 0.80046946, 'precision': 0.828445, 'recall': 0.804307, 'specificity': 0.804307, 'f1': 0.79741204, 'auroc': 0.9224865, 'binary_precision': 0.72570723, 'binary_recall': 0.948553, 'binary_specificity': 0.660061, 'binary_f1_score': 0.8222996}
confusion matrix:
     0    1
0  433  223
1   32  590
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8084211, 'precision': 0.81085324, 'recall': 0.8024185, 'specificity': 0.8024185, 'f1': 0.8046496, 'auroc': 0.9136994, 'binary_precision': 0.79787236, 'binary_recall': 0.8687259, 'binary_specificity': 0.7361111, 'binary_f1_score': 0.831793}
confusion matrix:
     0    1
0  159   57
1   34  225
new oracle model saved
better model found
persisted
after epoch: 5,now: 2024-07-14 00:01:10.192427,epoch time: 0:09:56.329300,used: 0:50:28.475102,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_23_10_41_seed_2_21955597
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9883988, 'precision': 0.9124545, 'recall': 0.9754337, 'specificity': 0.9754337, 'f1': 0.9414182, 'auroc': 0.99813634, 'binary_precision': 0.9980077, 'binary_recall': 0.9897857, 'binary_specificity': 0.9610818, 'binary_f1_score': 0.9938796}
confusion matrix:
      0      1
0  1457     59
1   305  29555
---- Validation: 
scalar performance:
{'acc': 0.8779343, 'precision': 0.87806153, 'recall': 0.87830615, 'specificity': 0.87830615, 'f1': 0.8779235, 'auroc': 0.93848765, 'binary_precision': 0.86180127, 'binary_recall': 0.89228296, 'binary_specificity': 0.8643293, 'binary_f1_score': 0.8767773}
confusion matrix:
     0    1
0  567   89
1   67  555
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8821053, 'precision': 0.8826241, 'recall': 0.8857429, 'specificity': 0.8857429, 'f1': 0.88191634, 'auroc': 0.9297155, 'binary_precision': 0.93191487, 'binary_recall': 0.84555984, 'binary_specificity': 0.9259259, 'binary_f1_score': 0.8866397}
confusion matrix:
     0    1
0  200   16
1   40  219
new oracle model saved
better model found
persisted
after epoch: 6,now: 2024-07-14 00:11:21.311646,epoch time: 0:10:11.119219,used: 1:00:39.594321,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_23_10_41_seed_2_21955597
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9924146, 'precision': 0.95669127, 'recall': 0.9612639, 'specificity': 0.9612639, 'f1': 0.9589648, 'auroc': 0.9982748, 'binary_precision': 0.99628067, 'binary_recall': 0.9957468, 'binary_specificity': 0.926781, 'binary_f1_score': 0.9960136}
confusion matrix:
      0      1
0  1405    111
1   127  29733
---- Validation: 
scalar performance:
{'acc': 0.8450704, 'precision': 0.85863805, 'recall': 0.84766877, 'specificity': 0.84766877, 'f1': 0.84419125, 'auroc': 0.9376961, 'binary_precision': 0.7819149, 'binary_recall': 0.9453376, 'binary_specificity': 0.75, 'binary_f1_score': 0.85589516}
confusion matrix:
     0    1
0  492  164
1   34  588
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8, 'precision': 0.8106171, 'recall': 0.7900847, 'specificity': 0.7900847, 'f1': 0.79322183, 'auroc': 0.9300908, 'binary_precision': 0.7715232, 'binary_recall': 0.8996139, 'binary_specificity': 0.6805556, 'binary_f1_score': 0.8306595}
confusion matrix:
     0    1
0  147   69
1   26  233
early stop counter: 1
val acc:0.8450704216957092, best validation acc: 0.8779342770576477, corresponding to test acc:                         0.88210529088974 / 0.88210529088974
after epoch: 7,now: 2024-07-14 00:21:34.576988,epoch time: 0:10:13.265342,used: 1:10:52.859663,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_23_10_41_seed_2_21955597
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9922552, 'precision': 0.95519924, 'recall': 0.9611802, 'specificity': 0.9611802, 'f1': 0.9581678, 'auroc': 0.9986818, 'binary_precision': 0.99628, 'binary_recall': 0.99557936, 'binary_specificity': 0.926781, 'binary_f1_score': 0.99592954}
confusion matrix:
      0      1
0  1405    111
1   132  29728
---- Validation: 
scalar performance:
{'acc': 0.78716743, 'precision': 0.8256501, 'recall': 0.791683, 'specificity': 0.791683, 'f1': 0.782357, 'auroc': 0.9374682, 'binary_precision': 0.7068558, 'binary_recall': 0.9614148, 'binary_specificity': 0.6219512, 'binary_f1_score': 0.81471395}
confusion matrix:
     0    1
0  408  248
1   24  598
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.76842105, 'precision': 0.7881216, 'recall': 0.7545939, 'specificity': 0.7545939, 'f1': 0.7565238, 'auroc': 0.91337764, 'binary_precision': 0.73208725, 'binary_recall': 0.90733594, 'binary_specificity': 0.6018519, 'binary_f1_score': 0.8103449}
confusion matrix:
     0    1
0  130   86
1   24  235
early stop counter: 2
val acc:0.7871674299240112, best validation acc: 0.8779342770576477, corresponding to test acc:                         0.88210529088974 / 0.88210529088974
after epoch: 8,now: 2024-07-14 00:31:37.214259,epoch time: 0:10:02.637271,used: 1:20:55.496934,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_23_10_41_seed_2_21955597
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9846379, 'precision': 0.9879234, 'recall': 0.8438467, 'specificity': 0.8438467, 'f1': 0.90214825, 'auroc': 0.99836874, 'binary_precision': 0.9844018, 'binary_recall': 0.9996986, 'binary_specificity': 0.6879947, 'binary_f1_score': 0.9919913}
confusion matrix:
      0      1
0  1043    473
1     9  29851
---- Validation: 
scalar performance:
{'acc': 0.69248825, 'precision': 0.79140806, 'recall': 0.70008236, 'specificity': 0.70008236, 'f1': 0.66891694, 'auroc': 0.9452304, 'binary_precision': 0.61484456, 'binary_recall': 0.98553056, 'binary_specificity': 0.41463414, 'binary_f1_score': 0.7572575}
confusion matrix:
     0    1
0  272  384
1    9  613
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7242105, 'precision': 0.79595757, 'recall': 0.69983375, 'specificity': 0.69983375, 'f1': 0.6898999, 'auroc': 0.93211067, 'binary_precision': 0.67112297, 'binary_recall': 0.969112, 'binary_specificity': 0.43055555, 'binary_f1_score': 0.793049}
confusion matrix:
    0    1
0  93  123
1   8  251
early stop counter: 3
val acc:0.6924882531166077, best validation acc: 0.8779342770576477, corresponding to test acc:                         0.88210529088974 / 0.88210529088974
after epoch: 9,now: 2024-07-14 00:41:39.483164,epoch time: 0:10:02.268905,used: 1:30:57.765839,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_23_10_41_seed_2_21955597
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9916178, 'precision': 0.98470056, 'recall': 0.9226507, 'specificity': 0.9226507, 'f1': 0.9513227, 'auroc': 0.9986297, 'binary_precision': 0.9922496, 'binary_recall': 0.9989953, 'binary_specificity': 0.8463061, 'binary_f1_score': 0.9956111}
confusion matrix:
      0      1
0  1283    233
1    30  29830
---- Validation: 
scalar performance:
{'acc': 0.7652582, 'precision': 0.8238542, 'recall': 0.7708415, 'specificity': 0.7708415, 'f1': 0.75652814, 'auroc': 0.942654, 'binary_precision': 0.6792873, 'binary_recall': 0.9807074, 'binary_specificity': 0.5609756, 'binary_f1_score': 0.8026316}
confusion matrix:
     0    1
0  368  288
1   12  610
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.77894735, 'precision': 0.8212197, 'recall': 0.7611719, 'specificity': 0.7611719, 'f1': 0.76221573, 'auroc': 0.9355962, 'binary_precision': 0.7251462, 'binary_recall': 0.95752895, 'binary_specificity': 0.5648148, 'binary_f1_score': 0.82529116}
confusion matrix:
     0    1
0  122   94
1   11  248
early stop counter: 4
val acc:0.7652581930160522, best validation acc: 0.8779342770576477, corresponding to test acc:                         0.88210529088974 / 0.88210529088974
after epoch: 10,now: 2024-07-14 00:51:39.405556,epoch time: 0:09:59.922392,used: 1:40:57.688231,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_23_10_41_seed_2_21955597
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9941038, 'precision': 0.9651191, 'recall': 0.9712304, 'specificity': 0.9712304, 'f1': 0.96815246, 'auroc': 0.9989362, 'binary_precision': 0.9972519, 'binary_recall': 0.99655056, 'binary_specificity': 0.9459103, 'binary_f1_score': 0.9969011}
confusion matrix:
      0      1
0  1434     82
1   103  29757
---- Validation: 
scalar performance:
{'acc': 0.8794992, 'precision': 0.8834852, 'recall': 0.88091373, 'specificity': 0.88091373, 'f1': 0.8793926, 'auroc': 0.94528365, 'binary_precision': 0.8371758, 'binary_recall': 0.9340836, 'binary_specificity': 0.8277439, 'binary_f1_score': 0.88297874}
confusion matrix:
     0    1
0  543  113
1   41  581
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8568421, 'precision': 0.85892177, 'recall': 0.8614239, 'specificity': 0.8614239, 'f1': 0.8567348, 'auroc': 0.9291613, 'binary_precision': 0.9170306, 'binary_recall': 0.8108108, 'binary_specificity': 0.912037, 'binary_f1_score': 0.8606558}
confusion matrix:
     0    1
0  197   19
1   49  210
better model found
persisted
after epoch: 11,now: 2024-07-14 01:01:39.403841,epoch time: 0:09:59.998285,used: 1:50:57.686516,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_23_10_41_seed_2_21955597
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.993052, 'precision': 0.9635632, 'recall': 0.9606596, 'specificity': 0.9606596, 'f1': 0.9621062, 'auroc': 0.9987291, 'binary_precision': 0.99618345, 'binary_recall': 0.99651706, 'binary_specificity': 0.9248021, 'binary_f1_score': 0.9963502}
confusion matrix:
      0      1
0  1402    114
1   104  29756
---- Validation: 
scalar performance:
{'acc': 0.8802817, 'precision': 0.88190556, 'recall': 0.88121766, 'specificity': 0.88121766, 'f1': 0.88026524, 'auroc': 0.94249225, 'binary_precision': 0.84947836, 'binary_recall': 0.9163987, 'binary_specificity': 0.8460366, 'binary_f1_score': 0.88167053}
confusion matrix:
     0    1
0  555  101
1   52  570
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.84842104, 'precision': 0.84992194, 'recall': 0.85254896, 'specificity': 0.85254896, 'f1': 0.8482697, 'auroc': 0.918329, 'binary_precision': 0.9047619, 'binary_recall': 0.8069498, 'binary_specificity': 0.8981481, 'binary_f1_score': 0.8530612}
confusion matrix:
     0    1
0  194   22
1   50  209
better model found
persisted
after epoch: 12,now: 2024-07-14 01:11:40.275386,epoch time: 0:10:00.871545,used: 2:00:58.558061,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_23_10_41_seed_2_21955597
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9943269, 'precision': 0.97137666, 'recall': 0.96665156, 'specificity': 0.96665156, 'f1': 0.9690008, 'auroc': 0.9989872, 'binary_precision': 0.9967533, 'binary_recall': 0.99728733, 'binary_specificity': 0.93601584, 'binary_f1_score': 0.99702024}
confusion matrix:
      0      1
0  1419     97
1    81  29779
---- Validation: 
scalar performance:
{'acc': 0.8826291, 'precision': 0.88373685, 'recall': 0.88342094, 'specificity': 0.88342094, 'f1': 0.8826245, 'auroc': 0.94317424, 'binary_precision': 0.85542166, 'binary_recall': 0.9131833, 'binary_specificity': 0.85365856, 'binary_f1_score': 0.88335925}
confusion matrix:
     0    1
0  560   96
1   54  568
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.86105263, 'precision': 0.8631377, 'recall': 0.86566925, 'specificity': 0.86566925, 'f1': 0.86094844, 'auroc': 0.91797155, 'binary_precision': 0.9213974, 'binary_recall': 0.8146718, 'binary_specificity': 0.9166667, 'binary_f1_score': 0.8647541}
confusion matrix:
     0    1
0  198   18
1   48  211
better model found
persisted
after epoch: 13,now: 2024-07-14 01:21:38.774764,epoch time: 0:09:58.499378,used: 2:10:57.057439,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_23_10_41_seed_2_21955597
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9931795, 'precision': 0.98459184, 'recall': 0.94006395, 'specificity': 0.94006395, 'f1': 0.9611372, 'auroc': 0.9989106, 'binary_precision': 0.9940012, 'binary_recall': 0.9988614, 'binary_specificity': 0.8812665, 'binary_f1_score': 0.9964254}
confusion matrix:
      0      1
0  1336    180
1    34  29826
---- Validation: 
scalar performance:
{'acc': 0.8599374, 'precision': 0.8673608, 'recall': 0.86185884, 'specificity': 0.86185884, 'f1': 0.85959625, 'auroc': 0.945492, 'binary_precision': 0.8080668, 'binary_recall': 0.9340836, 'binary_specificity': 0.78963417, 'binary_f1_score': 0.8665176}
confusion matrix:
     0    1
0  518  138
1   41  581
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8694737, 'precision': 0.8682524, 'recall': 0.8707011, 'specificity': 0.8707011, 'f1': 0.8689154, 'auroc': 0.9284284, 'binary_precision': 0.8987854, 'binary_recall': 0.85714287, 'binary_specificity': 0.8842593, 'binary_f1_score': 0.8774704}
confusion matrix:
     0    1
0  191   25
1   37  222
early stop counter: 1
val acc:0.8599374294281006, best validation acc: 0.8826290965080261, corresponding to test acc:                         0.8610526323318481 / 0.88210529088974
after epoch: 14,now: 2024-07-14 01:31:38.357963,epoch time: 0:09:59.583199,used: 2:20:56.640638,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_23_10_41_seed_2_21955597
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9939444, 'precision': 0.9835921, 'recall': 0.9495448, 'specificity': 0.9495448, 'f1': 0.96587795, 'auroc': 0.99901587, 'binary_precision': 0.994962, 'binary_recall': 0.9986939, 'binary_specificity': 0.90039575, 'binary_f1_score': 0.9968244}
confusion matrix:
      0      1
0  1365    151
1    39  29821
---- Validation: 
scalar performance:
{'acc': 0.8810642, 'precision': 0.88557947, 'recall': 0.8825631, 'specificity': 0.8825631, 'f1': 0.88093555, 'auroc': 0.9483055, 'binary_precision': 0.83667624, 'binary_recall': 0.9389067, 'binary_specificity': 0.8262195, 'binary_f1_score': 0.8848485}
confusion matrix:
     0    1
0  542  114
1   38  584
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8673684, 'precision': 0.8661897, 'recall': 0.8664647, 'specificity': 0.8664647, 'f1': 0.86632323, 'auroc': 0.93641853, 'binary_precision': 0.87984496, 'binary_recall': 0.87644786, 'binary_specificity': 0.8564815, 'binary_f1_score': 0.87814313}
confusion matrix:
     0    1
0  185   31
1   32  227
early stop counter: 2
val acc:0.8810641765594482, best validation acc: 0.8826290965080261, corresponding to test acc:                         0.8610526323318481 / 0.88210529088974
after epoch: 15,now: 2024-07-14 01:41:38.994820,epoch time: 0:10:00.636857,used: 2:30:57.277495,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_23_10_41_seed_2_21955597
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9951237, 'precision': 0.9855026, 'recall': 0.96080875, 'specificity': 0.96080875, 'f1': 0.97279733, 'auroc': 0.9994632, 'binary_precision': 0.9960923, 'binary_recall': 0.9987944, 'binary_specificity': 0.9228232, 'binary_f1_score': 0.99744153}
confusion matrix:
      0      1
0  1399    117
1    36  29824
---- Validation: 
scalar performance:
{'acc': 0.81377155, 'precision': 0.8474175, 'recall': 0.81788933, 'specificity': 0.81788933, 'f1': 0.810417, 'auroc': 0.9497374, 'binary_precision': 0.73244554, 'binary_recall': 0.9726688, 'binary_specificity': 0.6631098, 'binary_f1_score': 0.8356354}
confusion matrix:
     0    1
0  435  221
1   17  605
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8168421, 'precision': 0.8356733, 'recall': 0.8051444, 'specificity': 0.8051444, 'f1': 0.8090421, 'auroc': 0.9394573, 'binary_precision': 0.775641, 'binary_recall': 0.93436295, 'binary_specificity': 0.6759259, 'binary_f1_score': 0.84763575}
confusion matrix:
     0    1
0  146   70
1   17  242
early stop counter: 3
val acc:0.8137715458869934, best validation acc: 0.8826290965080261, corresponding to test acc:                         0.8610526323318481 / 0.88210529088974
after epoch: 16,now: 2024-07-14 01:51:34.312647,epoch time: 0:09:55.317827,used: 2:40:52.595322,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_23_10_41_seed_2_21955597
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9931158, 'precision': 0.950605, 'recall': 0.9775989, 'specificity': 0.9775989, 'f1': 0.9636618, 'auroc': 0.99903524, 'binary_precision': 0.9979842, 'binary_recall': 0.9947756, 'binary_specificity': 0.96042216, 'binary_f1_score': 0.99637735}
confusion matrix:
      0      1
0  1456     60
1   156  29704
---- Validation: 
scalar performance:
{'acc': 0.8794992, 'precision': 0.8834852, 'recall': 0.88091373, 'specificity': 0.88091373, 'f1': 0.8793926, 'auroc': 0.94360244, 'binary_precision': 0.8371758, 'binary_recall': 0.9340836, 'binary_specificity': 0.8277439, 'binary_f1_score': 0.88297874}
confusion matrix:
     0    1
0  543  113
1   41  581
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.84842104, 'precision': 0.8469697, 'recall': 0.8479372, 'specificity': 0.8479372, 'f1': 0.84739226, 'auroc': 0.914039, 'binary_precision': 0.8666667, 'binary_recall': 0.85328186, 'binary_specificity': 0.8425926, 'binary_f1_score': 0.8599222}
confusion matrix:
     0    1
0  182   34
1   38  221
early stop counter: 4
val acc:0.8794991970062256, best validation acc: 0.8826290965080261, corresponding to test acc:                         0.8610526323318481 / 0.88210529088974
after epoch: 17,now: 2024-07-14 02:01:34.281820,epoch time: 0:09:59.969173,used: 2:50:52.564495,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_23_10_41_seed_2_21955597
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9959523, 'precision': 0.98103595, 'recall': 0.9747062, 'specificity': 0.9747062, 'f1': 0.97784775, 'auroc': 0.99949527, 'binary_precision': 0.9975235, 'binary_recall': 0.99822503, 'binary_specificity': 0.9511873, 'binary_f1_score': 0.99787414}
confusion matrix:
      0      1
0  1442     74
1    53  29807
---- Validation: 
scalar performance:
{'acc': 0.87323946, 'precision': 0.8821341, 'recall': 0.87531614, 'specificity': 0.87531614, 'f1': 0.872858, 'auroc': 0.94890356, 'binary_precision': 0.8168044, 'binary_recall': 0.95337623, 'binary_specificity': 0.7972561, 'binary_f1_score': 0.87982196}
confusion matrix:
     0    1
0  523  133
1   29  593
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.85263157, 'precision': 0.8512032, 'recall': 0.8521825, 'specificity': 0.8521825, 'f1': 0.85163134, 'auroc': 0.9227978, 'binary_precision': 0.87058824, 'binary_recall': 0.85714287, 'binary_specificity': 0.8472222, 'binary_f1_score': 0.8638132}
confusion matrix:
     0    1
0  183   33
1   37  222
early stop counter: 5
val acc:0.8732394576072693, best validation acc: 0.8826290965080261, corresponding to test acc:                         0.8610526323318481 / 0.88210529088974
after epoch: 18,now: 2024-07-14 02:11:37.804504,epoch time: 0:10:03.522684,used: 3:00:56.087179,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_23_10_41_seed_2_21955597
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9940082, 'precision': 0.9696263, 'recall': 0.9649188, 'specificity': 0.9649188, 'f1': 0.9672593, 'auroc': 0.9989918, 'binary_precision': 0.9965859, 'binary_recall': 0.9971199, 'binary_specificity': 0.9327177, 'binary_f1_score': 0.9968529}
confusion matrix:
      0      1
0  1414    102
1    86  29774
---- Validation: 
scalar performance:
{'acc': 0.8873239, 'precision': 0.8924501, 'recall': 0.88891065, 'specificity': 0.88891065, 'f1': 0.88717777, 'auroc': 0.9529246, 'binary_precision': 0.84045583, 'binary_recall': 0.948553, 'binary_specificity': 0.8292683, 'binary_f1_score': 0.89123863}
confusion matrix:
     0    1
0  544  112
1   32  590
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8926316, 'precision': 0.892538, 'recall': 0.8957797, 'specificity': 0.8957797, 'f1': 0.89240074, 'auroc': 0.9418168, 'binary_precision': 0.93697476, 'binary_recall': 0.8610039, 'binary_specificity': 0.9305556, 'binary_f1_score': 0.8973843}
confusion matrix:
     0    1
0  201   15
1   36  223
new oracle model saved
better model found
persisted
after epoch: 19,now: 2024-07-14 02:21:41.008587,epoch time: 0:10:03.204083,used: 3:10:59.291262,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_23_10_41_seed_2_21955597
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9937851, 'precision': 0.98186666, 'recall': 0.9494611, 'specificity': 0.9494611, 'f1': 0.965037, 'auroc': 0.9992064, 'binary_precision': 0.99496114, 'binary_recall': 0.99852645, 'binary_specificity': 0.90039575, 'binary_f1_score': 0.99674064}
confusion matrix:
      0      1
0  1365    151
1    44  29816
---- Validation: 
scalar performance:
{'acc': 0.8388106, 'precision': 0.85549676, 'recall': 0.84169626, 'specificity': 0.84169626, 'f1': 0.8376075, 'auroc': 0.94272757, 'binary_precision': 0.77154046, 'binary_recall': 0.9501608, 'binary_specificity': 0.7332317, 'binary_f1_score': 0.851585}
confusion matrix:
     0    1
0  481  175
1   31  591
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.85052633, 'precision': 0.8504939, 'recall': 0.84756184, 'specificity': 0.84756184, 'f1': 0.8487132, 'auroc': 0.910321, 'binary_precision': 0.8507463, 'binary_recall': 0.88030887, 'binary_specificity': 0.8148148, 'binary_f1_score': 0.86527514}
confusion matrix:
     0    1
0  176   40
1   31  228
early stop counter: 1
val acc:0.8388106226921082, best validation acc: 0.8873239159584045, corresponding to test acc:                         0.8926315903663635 / 0.8926315903663635
after epoch: 20,now: 2024-07-14 02:31:42.181700,epoch time: 0:10:01.173113,used: 3:21:00.464375,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_23_10_41_seed_2_21955597
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.993307, 'precision': 0.9880396, 'recall': 0.93825245, 'specificity': 0.93825245, 'f1': 0.9616612, 'auroc': 0.9992249, 'binary_precision': 0.9938045, 'binary_recall': 0.99919623, 'binary_specificity': 0.8773087, 'binary_f1_score': 0.9964931}
confusion matrix:
      0      1
0  1330    186
1    24  29836
---- Validation: 
scalar performance:
{'acc': 0.8544601, 'precision': 0.8717898, 'recall': 0.8573568, 'specificity': 0.8573568, 'f1': 0.8533738, 'auroc': 0.9442458, 'binary_precision': 0.7845953, 'binary_recall': 0.96623796, 'binary_specificity': 0.7484756, 'binary_f1_score': 0.8659942}
confusion matrix:
     0    1
0  491  165
1   21  601
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8694737, 'precision': 0.8737205, 'recall': 0.86416775, 'specificity': 0.86416775, 'f1': 0.8669828, 'auroc': 0.9216716, 'binary_precision': 0.8505338, 'binary_recall': 0.9227799, 'binary_specificity': 0.8055556, 'binary_f1_score': 0.8851851}
confusion matrix:
     0    1
0  174   42
1   20  239
early stop counter: 2
val acc:0.8544601202011108, best validation acc: 0.8873239159584045, corresponding to test acc:                         0.8926315903663635 / 0.8926315903663635
after epoch: 21,now: 2024-07-14 02:41:43.632945,epoch time: 0:10:01.451245,used: 3:31:01.915620,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_23_10_41_seed_2_21955597
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9950599, 'precision': 0.97497463, 'recall': 0.97110665, 'specificity': 0.97110665, 'f1': 0.9730318, 'auroc': 0.99921024, 'binary_precision': 0.9971881, 'binary_recall': 0.99762225, 'binary_specificity': 0.94459105, 'binary_f1_score': 0.9974051}
confusion matrix:
      0      1
0  1432     84
1    71  29789
---- Validation: 
scalar performance:
{'acc': 0.9053208, 'precision': 0.90523165, 'recall': 0.9054829, 'specificity': 0.9054829, 'f1': 0.9052901, 'auroc': 0.95088375, 'binary_precision': 0.8957346, 'binary_recall': 0.91157556, 'binary_specificity': 0.8993902, 'binary_f1_score': 0.9035857}
confusion matrix:
     0    1
0  590   66
1   55  567
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.87789476, 'precision': 0.885644, 'recall': 0.8853407, 'specificity': 0.8853407, 'f1': 0.87789416, 'auroc': 0.94033325, 'binary_precision': 0.96744186, 'binary_recall': 0.8030888, 'binary_specificity': 0.9675926, 'binary_f1_score': 0.8776371}
confusion matrix:
     0    1
0  209    7
1   51  208
better model found
persisted
after epoch: 22,now: 2024-07-14 02:51:50.055721,epoch time: 0:10:06.422776,used: 3:41:08.338396,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_23_10_41_seed_2_21955597
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.9954424, 'precision': 0.97368157, 'recall': 0.97694284, 'specificity': 0.97694284, 'f1': 0.975306, 'auroc': 0.9991858, 'binary_precision': 0.99778885, 'binary_recall': 0.9974213, 'binary_specificity': 0.95646435, 'binary_f1_score': 0.9976051}
confusion matrix:
      0      1
0  1450     66
1    77  29783
---- Validation: 
scalar performance:
{'acc': 0.87010956, 'precision': 0.87786734, 'recall': 0.87205905, 'specificity': 0.87205905, 'f1': 0.869783, 'auroc': 0.9434879, 'binary_precision': 0.81666666, 'binary_recall': 0.9453376, 'binary_specificity': 0.7987805, 'binary_f1_score': 0.87630403}
confusion matrix:
     0    1
0  524  132
1   34  588
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.86315787, 'precision': 0.8618641, 'recall': 0.8641409, 'specificity': 0.8641409, 'f1': 0.8625339, 'auroc': 0.9244423, 'binary_precision': 0.891129, 'binary_recall': 0.85328186, 'binary_specificity': 0.875, 'binary_f1_score': 0.8717948}
confusion matrix:
     0    1
0  189   27
1   38  221
early stop counter: 1
val acc:0.8701095581054688, best validation acc: 0.9053208231925964, corresponding to test acc:                         0.8778947591781616 / 0.8926315903663635
after epoch: 23,now: 2024-07-14 03:01:55.016143,epoch time: 0:10:04.960422,used: 3:51:13.298818,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_23_10_41_seed_2_21955597
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9951555, 'precision': 0.9615608, 'recall': 0.9880627, 'specificity': 0.9880627, 'f1': 0.97439766, 'auroc': 0.9996469, 'binary_precision': 0.9989922, 'binary_recall': 0.9959143, 'binary_specificity': 0.9802111, 'binary_f1_score': 0.9974509}
confusion matrix:
      0      1
0  1486     30
1   122  29738
---- Validation: 
scalar performance:
{'acc': 0.9053208, 'precision': 0.9055903, 'recall': 0.9049829, 'specificity': 0.9049829, 'f1': 0.9051926, 'auroc': 0.9517195, 'binary_precision': 0.91133004, 'binary_recall': 0.89228296, 'binary_specificity': 0.91768295, 'binary_f1_score': 0.901706}
confusion matrix:
     0    1
0  602   54
1   67  555
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8568421, 'precision': 0.87259865, 'recall': 0.86680436, 'specificity': 0.86680436, 'f1': 0.8566992, 'auroc': 0.93341553, 'binary_precision': 0.97512436, 'binary_recall': 0.7567568, 'binary_specificity': 0.9768519, 'binary_f1_score': 0.8521739}
confusion matrix:
     0    1
0  211    5
1   63  196
early stop counter: 2
val acc:0.9053208231925964, best validation acc: 0.9053208231925964, corresponding to test acc:                         0.8778947591781616 / 0.8926315903663635
after epoch: 24,now: 2024-07-14 03:12:02.328513,epoch time: 0:10:07.312370,used: 4:01:20.611188,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_23_10_41_seed_2_21955597
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.9925421, 'precision': 0.936485, 'recall': 0.9907595, 'specificity': 0.9907595, 'f1': 0.9618338, 'auroc': 0.999491, 'binary_precision': 0.99942684, 'binary_recall': 0.99273276, 'binary_specificity': 0.9887863, 'binary_f1_score': 0.99606854}
confusion matrix:
      0      1
0  1499     17
1   217  29643
---- Validation: 
scalar performance:
{'acc': 0.9029734, 'precision': 0.90295357, 'recall': 0.90323794, 'specificity': 0.90323794, 'f1': 0.9029542, 'auroc': 0.95155096, 'binary_precision': 0.89028215, 'binary_recall': 0.9131833, 'binary_specificity': 0.89329267, 'binary_f1_score': 0.90158737}
confusion matrix:
     0    1
0  586   70
1   54  568
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.87789476, 'precision': 0.8806398, 'recall': 0.8830348, 'specificity': 0.8830348, 'f1': 0.8778292, 'auroc': 0.9347741, 'binary_precision': 0.94273126, 'binary_recall': 0.82625484, 'binary_specificity': 0.9398148, 'binary_f1_score': 0.88065845}
confusion matrix:
     0    1
0  203   13
1   45  214
early stop counter: 3
val acc:0.9029734134674072, best validation acc: 0.9053208231925964, corresponding to test acc:                         0.8778947591781616 / 0.8926315903663635
after epoch: 25,now: 2024-07-14 03:22:09.966665,epoch time: 0:10:07.638152,used: 4:11:28.249340,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_23_10_41_seed_2_21955597
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9949643, 'precision': 0.98226666, 'recall': 0.9622904, 'specificity': 0.9622904, 'f1': 0.9720434, 'auroc': 0.99944484, 'binary_precision': 0.9962574, 'binary_recall': 0.99845946, 'binary_specificity': 0.92612135, 'binary_f1_score': 0.99735725}
confusion matrix:
      0      1
0  1404    112
1    46  29814
---- Validation: 
scalar performance:
{'acc': 0.87558687, 'precision': 0.87894785, 'recall': 0.8768945, 'specificity': 0.8768945, 'f1': 0.87550384, 'auroc': 0.9513371, 'binary_precision': 0.8359942, 'binary_recall': 0.926045, 'binary_specificity': 0.8277439, 'binary_f1_score': 0.87871855}
confusion matrix:
     0    1
0  543  113
1   46  576
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8947368, 'precision': 0.89751494, 'recall': 0.90001607, 'specificity': 0.90001607, 'f1': 0.8946803, 'auroc': 0.94054765, 'binary_precision': 0.9603524, 'binary_recall': 0.8416988, 'binary_specificity': 0.9583333, 'binary_f1_score': 0.8971193}
confusion matrix:
     0    1
0  207    9
1   41  218
new oracle model saved
early stop counter: 4
val acc:0.8755868673324585, best validation acc: 0.9053208231925964, corresponding to test acc:                         0.8778947591781616 / 0.8947368264198303
after epoch: 26,now: 2024-07-14 03:32:19.052946,epoch time: 0:10:09.086281,used: 4:21:37.335621,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_23_10_41_seed_2_21955597
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.994295, 'precision': 0.9525411, 'recall': 0.98948896, 'specificity': 0.98948896, 'f1': 0.9702021, 'auroc': 0.9996474, 'binary_precision': 0.9991927, 'binary_recall': 0.9948091, 'binary_specificity': 0.9841689, 'binary_f1_score': 0.99699605}
confusion matrix:
      0      1
0  1492     24
1   155  29705
---- Validation: 
scalar performance:
{'acc': 0.9021909, 'precision': 0.90412897, 'recall': 0.90130925, 'specificity': 0.90130925, 'f1': 0.9018708, 'auroc': 0.95253, 'binary_precision': 0.92624354, 'binary_recall': 0.8681672, 'binary_specificity': 0.9344512, 'binary_f1_score': 0.8962656}
confusion matrix:
     0    1
0  613   43
1   82  540
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.85263157, 'precision': 0.8726648, 'recall': 0.86371195, 'specificity': 0.86371195, 'f1': 0.85234296, 'auroc': 0.93589574, 'binary_precision': 0.9846154, 'binary_recall': 0.74131274, 'binary_specificity': 0.9861111, 'binary_f1_score': 0.845815}
confusion matrix:
     0    1
0  213    3
1   67  192
early stop counter: 5
val acc:0.9021909236907959, best validation acc: 0.9053208231925964, corresponding to test acc:                         0.8778947591781616 / 0.8947368264198303
after epoch: 27,now: 2024-07-14 03:42:27.576384,epoch time: 0:10:08.523438,used: 4:31:45.859059,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_23_10_41_seed_2_21955597
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.9963985, 'precision': 0.9757659, 'recall': 0.985585, 'specificity': 0.985585, 'f1': 0.9806195, 'auroc': 0.9997372, 'binary_precision': 0.99865896, 'binary_recall': 0.99755526, 'binary_specificity': 0.97361475, 'binary_f1_score': 0.99810684}
confusion matrix:
      0      1
0  1476     40
1    73  29787
---- Validation: 
scalar performance:
{'acc': 0.9061033, 'precision': 0.9066396, 'recall': 0.90670335, 'specificity': 0.90670335, 'f1': 0.9061031, 'auroc': 0.9563024, 'binary_precision': 0.88379204, 'binary_recall': 0.92926043, 'binary_specificity': 0.88414633, 'binary_f1_score': 0.90595615}
confusion matrix:
     0    1
0  580   76
1   44  578
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8821053, 'precision': 0.8863086, 'recall': 0.88804877, 'specificity': 0.88804877, 'f1': 0.8820797, 'auroc': 0.942943, 'binary_precision': 0.9551569, 'binary_recall': 0.82239383, 'binary_specificity': 0.9537037, 'binary_f1_score': 0.8838175}
confusion matrix:
     0    1
0  206   10
1   46  213
better model found
persisted
after epoch: 28,now: 2024-07-14 03:52:34.012536,epoch time: 0:10:06.436152,used: 4:41:52.295211,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_23_10_41_seed_2_21955597
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9974184, 'precision': 0.9864085, 'recall': 0.98549473, 'specificity': 0.98549473, 'f1': 0.98595107, 'auroc': 0.99979913, 'binary_precision': 0.99859357, 'binary_recall': 0.9986939, 'binary_specificity': 0.9722955, 'binary_f1_score': 0.9986437}
confusion matrix:
      0      1
0  1474     42
1    39  29821
---- Validation: 
scalar performance:
{'acc': 0.8763693, 'precision': 0.88354146, 'recall': 0.8782399, 'specificity': 0.8782399, 'f1': 0.87609625, 'auroc': 0.951453, 'binary_precision': 0.82402235, 'binary_recall': 0.948553, 'binary_specificity': 0.80792683, 'binary_f1_score': 0.8819133}
confusion matrix:
     0    1
0  530  126
1   32  590
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.86105263, 'precision': 0.8598178, 'recall': 0.8622104, 'specificity': 0.8622104, 'f1': 0.86045825, 'auroc': 0.93500644, 'binary_precision': 0.89068824, 'binary_recall': 0.84942085, 'binary_specificity': 0.875, 'binary_f1_score': 0.8695652}
confusion matrix:
     0    1
0  189   27
1   39  220
early stop counter: 1
val acc:0.876369297504425, best validation acc: 0.9061033129692078, corresponding to test acc:                         0.88210529088974 / 0.8947368264198303
after epoch: 29,now: 2024-07-14 04:02:42.692879,epoch time: 0:10:08.680343,used: 4:52:00.975554,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_23_10_41_seed_2_21955597
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.9966535, 'precision': 0.9771241, 'recall': 0.98697126, 'specificity': 0.98697126, 'f1': 0.9819915, 'auroc': 0.99969435, 'binary_precision': 0.99879307, 'binary_recall': 0.9976892, 'binary_specificity': 0.9762533, 'binary_f1_score': 0.9982408}
confusion matrix:
      0      1
0  1480     36
1    69  29791
---- Validation: 
scalar performance:
{'acc': 0.90688574, 'precision': 0.9075359, 'recall': 0.9063823, 'specificity': 0.9063823, 'f1': 0.906713, 'auroc': 0.9518101, 'binary_precision': 0.9184692, 'binary_recall': 0.8874598, 'binary_specificity': 0.9253049, 'binary_f1_score': 0.9026983}
confusion matrix:
     0    1
0  607   49
1   70  552
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.84, 'precision': 0.8596154, 'recall': 0.850976, 'specificity': 0.850976, 'f1': 0.83968663, 'auroc': 0.93023384, 'binary_precision': 0.9692308, 'binary_recall': 0.7297297, 'binary_specificity': 0.9722222, 'binary_f1_score': 0.83259904}
confusion matrix:
     0    1
0  210    6
1   70  189
better model found
persisted
after epoch: 30,now: 2024-07-14 04:12:54.178131,epoch time: 0:10:11.485252,used: 5:02:12.460806,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_23_10_41_seed_2_21955597
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 5:02:12.460806 at 2024-07-14 04:12:54.178131
persisted model performance metric: 

scalar performance:
{'acc': 0.84, 'precision': 0.8596154, 'recall': 0.850976, 'specificity': 0.850976, 'f1': 0.83968663, 'auroc': 0.93023384, 'binary_precision': 0.9692308, 'binary_recall': 0.7297297, 'binary_specificity': 0.9722222, 'binary_f1_score': 0.83259904}
confusion matrix:
     0    1
0  210    6
1   70  189
oracle model performance metric: 

scalar performance:
{'acc': 0.8947368, 'precision': 0.89751494, 'recall': 0.90001607, 'specificity': 0.90001607, 'f1': 0.8946803, 'auroc': 0.94054765, 'binary_precision': 0.9603524, 'binary_recall': 0.8416988, 'binary_specificity': 0.9583333, 'binary_f1_score': 0.8971193}
confusion matrix:
     0    1
0  207    9
1   41  218
results aggregation path: zoutput/benchmarks/CAMELYONWILD_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_halffreeze/rule_results/5.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONWILD_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_halffreeze/confusion_matrix/5.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 318241 KiB |   6782 MiB |    849 TiB |    849 TiB |
|       from large pool | 291059 KiB |   6756 MiB |    836 TiB |    836 TiB |
|       from small pool |  27182 KiB |     43 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 318241 KiB |   6782 MiB |    849 TiB |    849 TiB |
|       from large pool | 291059 KiB |   6756 MiB |    836 TiB |    836 TiB |
|       from small pool |  27182 KiB |     43 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 313851 KiB |   6778 MiB |    848 TiB |    848 TiB |
|       from large pool | 286862 KiB |   6752 MiB |    835 TiB |    835 TiB |
|       from small pool |  26989 KiB |     43 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   7450 MiB |   7456 MiB |  21174 MiB |  13724 MiB |
|       from large pool |   7398 MiB |   7404 MiB |  21092 MiB |  13694 MiB |
|       from small pool |     52 MiB |     52 MiB |     82 MiB |     30 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 259294 KiB | 680184 KiB | 681270 GiB | 681270 GiB |
|       from large pool | 249613 KiB | 675647 KiB | 667306 GiB | 667306 GiB |
|       from small pool |   9681 KiB |  30502 KiB |  13964 GiB |  13964 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    1058    |    4669    |  177606 K  |  177605 K  |
|       from large pool |     130    |     756    |   80799 K  |   80799 K  |
|       from small pool |     928    |    4537    |   96806 K  |   96805 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    1058    |    4669    |  177606 K  |  177605 K  |
|       from large pool |     130    |     756    |   80799 K  |   80799 K  |
|       from small pool |     928    |    4537    |   96806 K  |   96805 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     335    |     335    |     918    |     583    |
|       from large pool |     309    |     309    |     877    |     568    |
|       from small pool |      26    |      26    |      41    |      15    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      72    |    2005    |  102603 K  |  102603 K  |
|       from large pool |      25    |     307    |   59031 K  |   59031 K  |
|       from small pool |      47    |    1981    |   43571 K  |   43571 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   6782 MiB |    849 TiB |    849 TiB |
|       from large pool |  16640 KiB |   6756 MiB |    836 TiB |    836 TiB |
|       from small pool |      0 KiB |     43 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   6782 MiB |    849 TiB |    849 TiB |
|       from large pool |  16640 KiB |   6756 MiB |    836 TiB |    836 TiB |
|       from small pool |      0 KiB |     43 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   6778 MiB |    848 TiB |    848 TiB |
|       from large pool |  16640 KiB |   6752 MiB |    835 TiB |    835 TiB |
|       from small pool |      0 KiB |     43 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 577536 KiB |   7456 MiB |  21174 MiB |  20610 MiB |
|       from large pool | 540672 KiB |   7404 MiB |  21092 MiB |  20564 MiB |
|       from small pool |  36864 KiB |     52 MiB |     82 MiB |     46 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 680184 KiB | 681271 GiB | 681271 GiB |
|       from large pool |  24320 KiB | 675647 KiB | 667306 GiB | 667306 GiB |
|       from small pool |      0 KiB |  30502 KiB |  13964 GiB |  13964 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    4669    |  177606 K  |  177606 K  |
|       from large pool |       2    |     756    |   80799 K  |   80799 K  |
|       from small pool |       0    |    4537    |   96806 K  |   96806 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    4669    |  177606 K  |  177606 K  |
|       from large pool |       2    |     756    |   80799 K  |   80799 K  |
|       from small pool |       0    |    4537    |   96806 K  |   96806 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      42    |     335    |     918    |     876    |
|       from large pool |      24    |     309    |     877    |     853    |
|       from small pool |      18    |      26    |      41    |      23    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    2005    |  102603 K  |  102603 K  |
|       from large pool |       3    |     307    |   59031 K  |   59031 K  |
|       from small pool |       0    |    1981    |   43571 K  |   43571 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Sun Jul 14 04:20:33 2024]
Finished job 0.
1 of 1 steps (100%) done
