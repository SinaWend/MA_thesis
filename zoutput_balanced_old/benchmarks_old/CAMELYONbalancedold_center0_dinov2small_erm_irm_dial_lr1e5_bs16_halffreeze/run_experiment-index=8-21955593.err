Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Sat Jul 13 01:06:05 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYONWILD_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_halffreeze/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYONWILD_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_halffreeze/rule_results/8.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=8
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/swiglu_ffn.py:51: UserWarning: xFormers is not available (SwiGLU)
  warnings.warn("xFormers is not available (SwiGLU)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/attention.py:33: UserWarning: xFormers is not available (Attention)
  warnings.warn("xFormers is not available (Attention)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/block.py:40: UserWarning: xFormers is not available (Block)
  warnings.warn("xFormers is not available (Block)")
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_dann_b44271c83_not_commited_2024md_07md_13_01_14_23_seed_0_21955593

 Experiment start at: 2024-07-13 01:14:23.327359
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
before training, model accuracy: 0.5319587588310242
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.951196, 'precision': 0.475598, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48749384, 'auroc': 0.9926598, 'binary_precision': 0.951196, 'binary_recall': 1.0, 'binary_specificity': 0.0, 'binary_f1_score': 0.9749877}
confusion matrix:
   0      1
0  0   1518
1  0  29586
---- Validation: 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
scalar performance:
{'acc': 0.49301243, 'precision': 0.24650621, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.33021322, 'auroc': 0.931607, 'binary_precision': 0.49301243, 'binary_recall': 1.0, 'binary_specificity': 0.0, 'binary_f1_score': 0.66042644}
confusion matrix:
   0    1
0  0  653
1  0  635
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.556701, 'precision': 0.2783505, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.3576159, 'auroc': 0.9296986, 'binary_precision': 0.556701, 'binary_recall': 1.0, 'binary_specificity': 0.0, 'binary_f1_score': 0.7152318}
confusion matrix:
   0    1
0  0  215
1  0  270
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-13 01:42:39.490690,epoch time: 0:28:16.163331,used: 0:28:16.163331,model: dset_te_center0_dann_b44271c83_not_commited_2024md_07md_13_01_14_23_seed_0_21955593
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.951196, 'precision': 0.475598, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48749384, 'auroc': 0.99400866, 'binary_precision': 0.951196, 'binary_recall': 1.0, 'binary_specificity': 0.0, 'binary_f1_score': 0.9749877}
confusion matrix:
   0      1
0  0   1518
1  0  29586
---- Validation: 
scalar performance:
{'acc': 0.49301243, 'precision': 0.24650621, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.33021322, 'auroc': 0.92364496, 'binary_precision': 0.49301243, 'binary_recall': 1.0, 'binary_specificity': 0.0, 'binary_f1_score': 0.66042644}
confusion matrix:
   0    1
0  0  653
1  0  635
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.556701, 'precision': 0.2783505, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.3576159, 'auroc': 0.9259087, 'binary_precision': 0.556701, 'binary_recall': 1.0, 'binary_specificity': 0.0, 'binary_f1_score': 0.7152318}
confusion matrix:
   0    1
0  0  215
1  0  270
early stop counter: 1
val acc:0.4930124282836914, best validation acc: 0.4930124282836914, corresponding to test acc:                         0.5567010045051575 / 0.5567010045051575
after epoch: 2,now: 2024-07-13 02:11:03.476996,epoch time: 0:28:23.986306,used: 0:56:40.149637,model: dset_te_center0_dann_b44271c83_not_commited_2024md_07md_13_01_14_23_seed_0_21955593
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.951196, 'precision': 0.475598, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48749384, 'auroc': 0.9875063, 'binary_precision': 0.951196, 'binary_recall': 1.0, 'binary_specificity': 0.0, 'binary_f1_score': 0.9749877}
confusion matrix:
   0      1
0  0   1518
1  0  29586
---- Validation: 
scalar performance:
{'acc': 0.49301243, 'precision': 0.24650621, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.33021322, 'auroc': 0.8601681, 'binary_precision': 0.49301243, 'binary_recall': 1.0, 'binary_specificity': 0.0, 'binary_f1_score': 0.66042644}
confusion matrix:
   0    1
0  0  653
1  0  635
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.556701, 'precision': 0.2783505, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.3576159, 'auroc': 0.88811374, 'binary_precision': 0.556701, 'binary_recall': 1.0, 'binary_specificity': 0.0, 'binary_f1_score': 0.7152318}
confusion matrix:
   0    1
0  0  215
1  0  270
early stop counter: 2
val acc:0.4930124282836914, best validation acc: 0.4930124282836914, corresponding to test acc:                         0.5567010045051575 / 0.5567010045051575
after epoch: 3,now: 2024-07-13 02:39:17.670966,epoch time: 0:28:14.193970,used: 1:24:54.343607,model: dset_te_center0_dann_b44271c83_not_commited_2024md_07md_13_01_14_23_seed_0_21955593
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9511638, 'precision': 0.4755819, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48748538, 'auroc': 0.99442595, 'binary_precision': 0.9511638, 'binary_recall': 1.0, 'binary_specificity': 0.0, 'binary_f1_score': 0.97497076}
confusion matrix:
   0      1
0  0   1519
1  0  29585
---- Validation: 
scalar performance:
{'acc': 0.49301243, 'precision': 0.24650621, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.33021322, 'auroc': 0.91087043, 'binary_precision': 0.49301243, 'binary_recall': 1.0, 'binary_specificity': 0.0, 'binary_f1_score': 0.66042644}
confusion matrix:
   0    1
0  0  653
1  0  635
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.556701, 'precision': 0.2783505, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.3576159, 'auroc': 0.8927821, 'binary_precision': 0.556701, 'binary_recall': 1.0, 'binary_specificity': 0.0, 'binary_f1_score': 0.7152318}
confusion matrix:
   0    1
0  0  215
1  0  270
early stop counter: 3
val acc:0.4930124282836914, best validation acc: 0.4930124282836914, corresponding to test acc:                         0.5567010045051575 / 0.5567010045051575
after epoch: 4,now: 2024-07-13 03:07:24.256595,epoch time: 0:28:06.585629,used: 1:53:00.929236,model: dset_te_center0_dann_b44271c83_not_commited_2024md_07md_13_01_14_23_seed_0_21955593
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.99234825, 'precision': 0.955993, 'recall': 0.9622532, 'specificity': 0.9622532, 'f1': 0.9590992, 'auroc': 0.9986813, 'binary_precision': 0.9963468, 'binary_recall': 0.9956059, 'binary_specificity': 0.9289006, 'binary_f1_score': 0.99597615}
confusion matrix:
      0      1
0  1411    108
1   130  29455
---- Validation: 
scalar performance:
{'acc': 0.8206522, 'precision': 0.8391726, 'recall': 0.82227755, 'specificity': 0.82227755, 'f1': 0.81866, 'auroc': 0.9283452, 'binary_precision': 0.75634515, 'binary_recall': 0.93858266, 'binary_specificity': 0.70597243, 'binary_f1_score': 0.83766687}
confusion matrix:
     0    1
0  461  192
1   39  596
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.814433, 'precision': 0.8216398, 'recall': 0.8034884, 'specificity': 0.8034884, 'f1': 0.8076618, 'auroc': 0.91657186, 'binary_precision': 0.7941176, 'binary_recall': 0.9, 'binary_specificity': 0.7069768, 'binary_f1_score': 0.84375}
confusion matrix:
     0    1
0  152   63
1   27  243
new oracle model saved
better model found
persisted
after epoch: 5,now: 2024-07-13 03:35:29.425014,epoch time: 0:28:05.168419,used: 2:21:06.097655,model: dset_te_center0_dann_b44271c83_not_commited_2024md_07md_13_01_14_23_seed_0_21955593
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9907086, 'precision': 0.9758582, 'recall': 0.92168295, 'specificity': 0.92168295, 'f1': 0.94695246, 'auroc': 0.99873257, 'binary_precision': 0.99210536, 'binary_recall': 0.9981748, 'binary_specificity': 0.84519106, 'binary_f1_score': 0.99513084}
confusion matrix:
      0      1
0  1283    235
1    54  29532
---- Validation: 
scalar performance:
{'acc': 0.7523292, 'precision': 0.8117323, 'recall': 0.755352, 'specificity': 0.755352, 'f1': 0.7413816, 'auroc': 0.9299128, 'binary_precision': 0.6721133, 'binary_recall': 0.9716535, 'binary_specificity': 0.5390505, 'binary_f1_score': 0.7945911}
confusion matrix:
     0    1
0  352  301
1   18  617
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7814433, 'precision': 0.80321807, 'recall': 0.7634367, 'specificity': 0.7634367, 'f1': 0.76744294, 'auroc': 0.917528, 'binary_precision': 0.74550897, 'binary_recall': 0.9222222, 'binary_specificity': 0.60465115, 'binary_f1_score': 0.8245033}
confusion matrix:
     0    1
0  130   85
1   21  249
early stop counter: 1
val acc:0.7523291707038879, best validation acc: 0.820652186870575, corresponding to test acc:                         0.8144329786300659 / 0.8144329786300659
after epoch: 6,now: 2024-07-13 04:03:24.606123,epoch time: 0:27:55.181109,used: 2:49:01.278764,model: dset_te_center0_dann_b44271c83_not_commited_2024md_07md_13_01_14_23_seed_0_21955593
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9936343, 'precision': 0.9572154, 'recall': 0.9760301, 'specificity': 0.9760301, 'f1': 0.96641016, 'auroc': 0.99878883, 'binary_precision': 0.9977642, 'binary_recall': 0.9955384, 'binary_specificity': 0.95652175, 'binary_f1_score': 0.9966501}
confusion matrix:
      0      1
0  1452     66
1   132  29454
---- Validation: 
scalar performance:
{'acc': 0.8742236, 'precision': 0.8782794, 'recall': 0.87495875, 'specificity': 0.87495875, 'f1': 0.8740183, 'auroc': 0.9435314, 'binary_precision': 0.835461, 'binary_recall': 0.9275591, 'binary_specificity': 0.82235837, 'binary_f1_score': 0.87910455}
confusion matrix:
     0    1
0  537  116
1   46  589
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8329897, 'precision': 0.83648527, 'recall': 0.82489234, 'specificity': 0.82489234, 'f1': 0.8283186, 'auroc': 0.9316193, 'binary_precision': 0.82033896, 'binary_recall': 0.8962963, 'binary_specificity': 0.75348836, 'binary_f1_score': 0.8566372}
confusion matrix:
     0    1
0  162   53
1   28  242
new oracle model saved
better model found
persisted
after epoch: 7,now: 2024-07-13 04:31:19.684433,epoch time: 0:27:55.078310,used: 3:16:56.357074,model: dset_te_center0_dann_b44271c83_not_commited_2024md_07md_13_01_14_23_seed_0_21955593
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9922196, 'precision': 0.949929, 'recall': 0.9684309, 'specificity': 0.9684309, 'f1': 0.9589708, 'auroc': 0.9984486, 'binary_precision': 0.9970189, 'binary_recall': 0.99479467, 'binary_specificity': 0.94206715, 'binary_f1_score': 0.9959055}
confusion matrix:
      0      1
0  1431     88
1   154  29431
---- Validation: 
scalar performance:
{'acc': 0.8773292, 'precision': 0.8819252, 'recall': 0.8781083, 'specificity': 0.8781083, 'f1': 0.8770969, 'auroc': 0.94031906, 'binary_precision': 0.8363893, 'binary_recall': 0.9338583, 'binary_specificity': 0.82235837, 'binary_f1_score': 0.8824405}
confusion matrix:
     0    1
0  537  116
1   42  593
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8515464, 'precision': 0.85040045, 'recall': 0.8481912, 'specificity': 0.8481912, 'f1': 0.8491603, 'auroc': 0.9161068, 'binary_precision': 0.8586956, 'binary_recall': 0.87777776, 'binary_specificity': 0.81860465, 'binary_f1_score': 0.8681319}
confusion matrix:
     0    1
0  176   39
1   33  237
new oracle model saved
better model found
persisted
after epoch: 8,now: 2024-07-13 04:59:08.709301,epoch time: 0:27:49.024868,used: 3:44:45.381942,model: dset_te_center0_dann_b44271c83_not_commited_2024md_07md_13_01_14_23_seed_0_21955593
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9935378, 'precision': 0.97146577, 'recall': 0.9581946, 'specificity': 0.9581946, 'f1': 0.9647244, 'auroc': 0.9991113, 'binary_precision': 0.9958488, 'binary_recall': 0.9973635, 'binary_specificity': 0.91902566, 'binary_f1_score': 0.99660563}
confusion matrix:
      0      1
0  1396    123
1    78  29507
---- Validation: 
scalar performance:
{'acc': 0.8781056, 'precision': 0.8793895, 'recall': 0.8785267, 'specificity': 0.8785267, 'f1': 0.87806666, 'auroc': 0.94186497, 'binary_precision': 0.8535503, 'binary_recall': 0.9086614, 'binary_specificity': 0.848392, 'binary_f1_score': 0.8802441}
confusion matrix:
     0    1
0  554   99
1   58  577
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8742268, 'precision': 0.87229323, 'recall': 0.87614125, 'specificity': 0.87614125, 'f1': 0.8733654, 'auroc': 0.93291986, 'binary_precision': 0.9098039, 'binary_recall': 0.85925925, 'binary_specificity': 0.89302325, 'binary_f1_score': 0.88380945}
confusion matrix:
     0    1
0  192   23
1   38  232
new oracle model saved
better model found
persisted
after epoch: 9,now: 2024-07-13 05:27:05.934530,epoch time: 0:27:57.225229,used: 4:12:42.607171,model: dset_te_center0_dann_b44271c83_not_commited_2024md_07md_13_01_14_23_seed_0_21955593
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.99466306, 'precision': 0.9640646, 'recall': 0.9796957, 'specificity': 0.9796957, 'f1': 0.97173524, 'auroc': 0.9992218, 'binary_precision': 0.99810374, 'binary_recall': 0.99628204, 'binary_specificity': 0.9631094, 'binary_f1_score': 0.9971921}
confusion matrix:
      0      1
0  1462     56
1   110  29476
---- Validation: 
scalar performance:
{'acc': 0.86878884, 'precision': 0.8739667, 'recall': 0.8696205, 'specificity': 0.8696205, 'f1': 0.8684939, 'auroc': 0.9446672, 'binary_precision': 0.82633054, 'binary_recall': 0.92913383, 'binary_specificity': 0.8101072, 'binary_f1_score': 0.87472206}
confusion matrix:
     0    1
0  529  124
1   45  590
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8618557, 'precision': 0.8596628, 'recall': 0.8626615, 'specificity': 0.8626615, 'f1': 0.86070925, 'auroc': 0.9252713, 'binary_precision': 0.8918919, 'binary_recall': 0.85555553, 'binary_specificity': 0.8697674, 'binary_f1_score': 0.8733459}
confusion matrix:
     0    1
0  187   28
1   39  231
early stop counter: 1
val acc:0.8687888383865356, best validation acc: 0.8781055808067322, corresponding to test acc:                         0.8742268085479736 / 0.8742268085479736
after epoch: 10,now: 2024-07-13 05:55:27.216614,epoch time: 0:28:21.282084,used: 4:41:03.889255,model: dset_te_center0_dann_b44271c83_not_commited_2024md_07md_13_01_14_23_seed_0_21955593
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9916088, 'precision': 0.97484845, 'recall': 0.932824, 'specificity': 0.932824, 'f1': 0.9527532, 'auroc': 0.9986172, 'binary_precision': 0.9932383, 'binary_recall': 0.99797195, 'binary_specificity': 0.8676761, 'binary_f1_score': 0.9955995}
confusion matrix:
      0      1
0  1318    201
1    60  29525
---- Validation: 
scalar performance:
{'acc': 0.7445652, 'precision': 0.8107194, 'recall': 0.7477602, 'specificity': 0.7477602, 'f1': 0.73179966, 'auroc': 0.93052053, 'binary_precision': 0.66381156, 'binary_recall': 0.97637796, 'binary_specificity': 0.51914245, 'binary_f1_score': 0.79031235}
confusion matrix:
     0    1
0  339  314
1   15  620
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.78350514, 'precision': 0.82773566, 'recall': 0.7605513, 'specificity': 0.7605513, 'f1': 0.7638261, 'auroc': 0.92968994, 'binary_precision': 0.73239434, 'binary_recall': 0.962963, 'binary_specificity': 0.55813956, 'binary_f1_score': 0.83199996}
confusion matrix:
     0    1
0  120   95
1   10  260
early stop counter: 2
val acc:0.7445651888847351, best validation acc: 0.8781055808067322, corresponding to test acc:                         0.8742268085479736 / 0.8742268085479736
after epoch: 11,now: 2024-07-13 06:23:16.973238,epoch time: 0:27:49.756624,used: 5:08:53.645879,model: dset_te_center0_dann_b44271c83_not_commited_2024md_07md_13_01_14_23_seed_0_21955593
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.99318415, 'precision': 0.9856343, 'recall': 0.9398974, 'specificity': 0.9398974, 'f1': 0.96150947, 'auroc': 0.99931157, 'binary_precision': 0.9939129, 'binary_recall': 0.99895215, 'binary_specificity': 0.8808427, 'binary_f1_score': 0.9964261}
confusion matrix:
      0      1
0  1338    181
1    31  29554
---- Validation: 
scalar performance:
{'acc': 0.7236025, 'precision': 0.80875885, 'recall': 0.7272383, 'specificity': 0.7272383, 'f1': 0.705176, 'auroc': 0.9402323, 'binary_precision': 0.6430769, 'binary_recall': 0.98740155, 'binary_specificity': 0.46707505, 'binary_f1_score': 0.778882}
confusion matrix:
     0    1
0  305  348
1    8  627
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7402062, 'precision': 0.79367685, 'recall': 0.7126615, 'specificity': 0.7126615, 'f1': 0.709796, 'auroc': 0.8943324, 'binary_precision': 0.6935484, 'binary_recall': 0.95555556, 'binary_specificity': 0.46976745, 'binary_f1_score': 0.80373836}
confusion matrix:
     0    1
0  101  114
1   12  258
early stop counter: 3
val acc:0.7236024737358093, best validation acc: 0.8781055808067322, corresponding to test acc:                         0.8742268085479736 / 0.8742268085479736
after epoch: 12,now: 2024-07-13 06:51:12.674391,epoch time: 0:27:55.701153,used: 5:36:49.347032,model: dset_te_center0_dann_b44271c83_not_commited_2024md_07md_13_01_14_23_seed_0_21955593
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9938593, 'precision': 0.95557606, 'recall': 0.9808356, 'specificity': 0.9808356, 'f1': 0.9678236, 'auroc': 0.9992337, 'binary_precision': 0.998271, 'binary_recall': 0.99526805, 'binary_specificity': 0.9664032, 'binary_f1_score': 0.9967672}
confusion matrix:
      0      1
0  1467     51
1   140  29446
---- Validation: 
scalar performance:
{'acc': 0.8532609, 'precision': 0.86510646, 'recall': 0.85452366, 'specificity': 0.85452366, 'f1': 0.852353, 'auroc': 0.9366437, 'binary_precision': 0.795756, 'binary_recall': 0.9448819, 'binary_specificity': 0.7641654, 'binary_f1_score': 0.8639309}
confusion matrix:
     0    1
0  499  154
1   35  600
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8164948, 'precision': 0.8184993, 'recall': 0.80865633, 'specificity': 0.80865633, 'f1': 0.8116225, 'auroc': 0.898174, 'binary_precision': 0.8088737, 'binary_recall': 0.87777776, 'binary_specificity': 0.73953485, 'binary_f1_score': 0.8419183}
confusion matrix:
     0    1
0  159   56
1   33  237
early stop counter: 4
val acc:0.85326087474823, best validation acc: 0.8781055808067322, corresponding to test acc:                         0.8742268085479736 / 0.8742268085479736
after epoch: 13,now: 2024-07-13 07:19:10.728786,epoch time: 0:27:58.054395,used: 6:04:47.401427,model: dset_te_center0_dann_b44271c83_not_commited_2024md_07md_13_01_14_23_seed_0_21955593
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9954668, 'precision': 0.97946703, 'recall': 0.97136873, 'specificity': 0.97136873, 'f1': 0.9753794, 'auroc': 0.9993986, 'binary_precision': 0.9971634, 'binary_recall': 0.9980734, 'binary_specificity': 0.94466406, 'binary_f1_score': 0.9976182}
confusion matrix:
      0      1
0  1434     84
1    57  29529
---- Validation: 
scalar performance:
{'acc': 0.85248446, 'precision': 0.86721456, 'recall': 0.85388815, 'specificity': 0.85388815, 'f1': 0.8513197, 'auroc': 0.9433336, 'binary_precision': 0.7900913, 'binary_recall': 0.9543307, 'binary_specificity': 0.7534456, 'binary_f1_score': 0.8644793}
confusion matrix:
     0    1
0  492  161
1   29  606
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8639175, 'precision': 0.8626717, 'recall': 0.86119723, 'specificity': 0.86119723, 'f1': 0.86187345, 'auroc': 0.9407321, 'binary_precision': 0.8722628, 'binary_recall': 0.8851852, 'binary_specificity': 0.8372093, 'binary_f1_score': 0.8786765}
confusion matrix:
     0    1
0  180   35
1   31  239
early stop counter: 5
val acc:0.8524844646453857, best validation acc: 0.8781055808067322, corresponding to test acc:                         0.8742268085479736 / 0.8742268085479736
after epoch: 14,now: 2024-07-13 07:47:08.088326,epoch time: 0:27:57.359540,used: 6:32:44.760967,model: dset_te_center0_dann_b44271c83_not_commited_2024md_07md_13_01_14_23_seed_0_21955593
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 14 with time: 6:32:44.760967 at 2024-07-13 07:47:08.088326
persisted model performance metric: 

scalar performance:
{'acc': 0.8742268, 'precision': 0.87229323, 'recall': 0.87614125, 'specificity': 0.87614125, 'f1': 0.8733654, 'auroc': 0.93291986, 'binary_precision': 0.9098039, 'binary_recall': 0.85925925, 'binary_specificity': 0.89302325, 'binary_f1_score': 0.88380945}
confusion matrix:
     0    1
0  192   23
1   38  232
oracle model performance metric: 

scalar performance:
{'acc': 0.8742268, 'precision': 0.87229323, 'recall': 0.87614125, 'specificity': 0.87614125, 'f1': 0.8733654, 'auroc': 0.93291986, 'binary_precision': 0.9098039, 'binary_recall': 0.85925925, 'binary_specificity': 0.89302325, 'binary_f1_score': 0.88380945}
confusion matrix:
     0    1
0  192   23
1   38  232
results aggregation path: zoutput/benchmarks/CAMELYONWILD_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_halffreeze/rule_results/8.csv
results aggregation path: zoutput/benchmarks/CAMELYONWILD_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_halffreeze/rule_results/8.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONWILD_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_halffreeze/confusion_matrix/8.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 318224 KiB |   5292 MiB |    858 TiB |    858 TiB |
|       from large pool | 291029 KiB |   5266 MiB |    848 TiB |    848 TiB |
|       from small pool |  27195 KiB |     43 MiB |     10 TiB |     10 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 318224 KiB |   5292 MiB |    858 TiB |    858 TiB |
|       from large pool | 291029 KiB |   5266 MiB |    848 TiB |    848 TiB |
|       from small pool |  27195 KiB |     43 MiB |     10 TiB |     10 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 313851 KiB |   5290 MiB |    857 TiB |    857 TiB |
|       from large pool | 286862 KiB |   5264 MiB |    847 TiB |    847 TiB |
|       from small pool |  26989 KiB |     43 MiB |     10 TiB |     10 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   6784 MiB |   6784 MiB |   6784 MiB |      0 B   |
|       from large pool |   6734 MiB |   6734 MiB |   6734 MiB |      0 B   |
|       from small pool |     50 MiB |     50 MiB |     50 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory | 204015 KiB |   1019 MiB |    952 TiB |    952 TiB |
|       from large pool | 196395 KiB |   1017 MiB |    942 TiB |    942 TiB |
|       from small pool |   7620 KiB |      8 MiB |     10 TiB |     10 TiB |
|---------------------------------------------------------------------------|
| Allocations           |    1084    |    4635    |  121598 K  |  121597 K  |
|       from large pool |     130    |     601    |   77099 K  |   77099 K  |
|       from small pool |     954    |    4504    |   44499 K  |   44498 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    1084    |    4635    |  121598 K  |  121597 K  |
|       from large pool |     130    |     601    |   77099 K  |   77099 K  |
|       from small pool |     954    |    4504    |   44499 K  |   44498 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     265    |     265    |     265    |       0    |
|       from large pool |     240    |     240    |     240    |       0    |
|       from small pool |      25    |      25    |      25    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      65    |    1977    |   71260 K  |   71260 K  |
|       from large pool |      21    |     241    |   52530 K  |   52530 K  |
|       from small pool |      44    |    1956    |   18730 K  |   18730 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   5292 MiB |    858 TiB |    858 TiB |
|       from large pool |  16640 KiB |   5266 MiB |    848 TiB |    848 TiB |
|       from small pool |      0 KiB |     43 MiB |     10 TiB |     10 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   5292 MiB |    858 TiB |    858 TiB |
|       from large pool |  16640 KiB |   5266 MiB |    848 TiB |    848 TiB |
|       from small pool |      0 KiB |     43 MiB |     10 TiB |     10 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   5290 MiB |    857 TiB |    857 TiB |
|       from large pool |  16640 KiB |   5264 MiB |    847 TiB |    847 TiB |
|       from small pool |      0 KiB |     43 MiB |     10 TiB |     10 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 522240 KiB |   6784 MiB |   6784 MiB |   6274 MiB |
|       from large pool | 487424 KiB |   6734 MiB |   6734 MiB |   6258 MiB |
|       from small pool |  34816 KiB |     50 MiB |     50 MiB |     16 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1019 MiB |    952 TiB |    952 TiB |
|       from large pool |  24320 KiB |   1017 MiB |    942 TiB |    942 TiB |
|       from small pool |      0 KiB |     20 MiB |     10 TiB |     10 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    4635    |  121598 K  |  121598 K  |
|       from large pool |       2    |     601    |   77099 K  |   77099 K  |
|       from small pool |       0    |    4504    |   44499 K  |   44499 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    4635    |  121598 K  |  121598 K  |
|       from large pool |       2    |     601    |   77099 K  |   77099 K  |
|       from small pool |       0    |    4504    |   44499 K  |   44499 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      39    |     265    |     265    |     226    |
|       from large pool |      22    |     240    |     240    |     218    |
|       from small pool |      17    |      25    |      25    |       8    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    1977    |   71261 K  |   71261 K  |
|       from large pool |       3    |     241    |   52530 K  |   52530 K  |
|       from small pool |       0    |    1956    |   18730 K  |   18730 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   5292 MiB |    858 TiB |    858 TiB |
|       from large pool |  16640 KiB |   5266 MiB |    848 TiB |    848 TiB |
|       from small pool |      0 KiB |     43 MiB |     10 TiB |     10 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   5292 MiB |    858 TiB |    858 TiB |
|       from large pool |  16640 KiB |   5266 MiB |    848 TiB |    848 TiB |
|       from small pool |      0 KiB |     43 MiB |     10 TiB |     10 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   5290 MiB |    857 TiB |    857 TiB |
|       from large pool |  16640 KiB |   5264 MiB |    847 TiB |    847 TiB |
|       from small pool |      0 KiB |     43 MiB |     10 TiB |     10 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 522240 KiB |   6784 MiB |   6784 MiB |   6274 MiB |
|       from large pool | 487424 KiB |   6734 MiB |   6734 MiB |   6258 MiB |
|       from small pool |  34816 KiB |     50 MiB |     50 MiB |     16 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1019 MiB |    952 TiB |    952 TiB |
|       from large pool |  24320 KiB |   1017 MiB |    942 TiB |    942 TiB |
|       from small pool |      0 KiB |     20 MiB |     10 TiB |     10 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    4635    |  121598 K  |  121598 K  |
|       from large pool |       2    |     601    |   77099 K  |   77099 K  |
|       from small pool |       0    |    4504    |   44499 K  |   44499 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    4635    |  121598 K  |  121598 K  |
|       from large pool |       2    |     601    |   77099 K  |   77099 K  |
|       from small pool |       0    |    4504    |   44499 K  |   44499 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      39    |     265    |     265    |     226    |
|       from large pool |      22    |     240    |     240    |     218    |
|       from small pool |      17    |      25    |      25    |       8    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    1977    |   71261 K  |   71261 K  |
|       from large pool |       3    |     241    |   52530 K  |   52530 K  |
|       from small pool |       0    |    1956    |   18730 K  |   18730 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_dann_b44271c83_not_commited_2024md_07md_13_08_02_08_seed_1_21955593

 Experiment start at: 2024-07-13 08:02:08.347481
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
before training, model accuracy: 0.5941422581672668
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.951307, 'precision': 0.4756535, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48752296, 'auroc': 0.98786056, 'binary_precision': 0.951307, 'binary_recall': 1.0, 'binary_specificity': 0.0, 'binary_f1_score': 0.9750459}
confusion matrix:
   0      1
0  0   1520
1  0  29696
---- Validation: 
scalar performance:
{'acc': 0.4918033, 'precision': 0.24590164, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.32967034, 'auroc': 0.90443885, 'binary_precision': 0.4918033, 'binary_recall': 1.0, 'binary_specificity': 0.0, 'binary_f1_score': 0.6593407}
confusion matrix:
   0    1
0  0  651
1  0  630
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5292887, 'precision': 0.26464435, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.34610122, 'auroc': 0.89963984, 'binary_precision': 0.5292887, 'binary_recall': 1.0, 'binary_specificity': 0.0, 'binary_f1_score': 0.69220245}
confusion matrix:
   0    1
0  0  225
1  0  253
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-13 08:30:18.022557,epoch time: 0:28:09.675076,used: 0:28:09.675076,model: dset_te_center0_dann_b44271c83_not_commited_2024md_07md_13_08_02_08_seed_1_21955593
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.951275, 'precision': 0.4756375, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4875146, 'auroc': 0.99013984, 'binary_precision': 0.951275, 'binary_recall': 1.0, 'binary_specificity': 0.0, 'binary_f1_score': 0.9750292}
confusion matrix:
   0      1
0  0   1521
1  0  29695
---- Validation: 
scalar performance:
{'acc': 0.4918033, 'precision': 0.24590164, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.32967034, 'auroc': 0.93245554, 'binary_precision': 0.4918033, 'binary_recall': 1.0, 'binary_specificity': 0.0, 'binary_f1_score': 0.6593407}
confusion matrix:
   0    1
0  0  651
1  0  630
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5292887, 'precision': 0.26464435, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.34610122, 'auroc': 0.9242863, 'binary_precision': 0.5292887, 'binary_recall': 1.0, 'binary_specificity': 0.0, 'binary_f1_score': 0.69220245}
confusion matrix:
   0    1
0  0  225
1  0  253
early stop counter: 1
val acc:0.49180328845977783, best validation acc: 0.49180328845977783, corresponding to test acc:                         0.5292887091636658 / 0.5292887091636658
after epoch: 2,now: 2024-07-13 08:58:18.816580,epoch time: 0:28:00.794023,used: 0:56:10.469099,model: dset_te_center0_dann_b44271c83_not_commited_2024md_07md_13_08_02_08_seed_1_21955593
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9881151, 'precision': 0.925082, 'recall': 0.9512771, 'specificity': 0.9512771, 'f1': 0.93773866, 'auroc': 0.99668217, 'binary_precision': 0.9954051, 'binary_recall': 0.99208677, 'binary_specificity': 0.9104674, 'binary_f1_score': 0.9937431}
confusion matrix:
      0      1
0  1383    136
1   235  29462
---- Validation: 
scalar performance:
{'acc': 0.7135051, 'precision': 0.7915467, 'recall': 0.7176907, 'specificity': 0.7176907, 'f1': 0.695438, 'auroc': 0.92531514, 'binary_precision': 0.63655245, 'binary_recall': 0.97301584, 'binary_specificity': 0.4623656, 'binary_f1_score': 0.7696171}
confusion matrix:
     0    1
0  301  350
1   17  613
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.748954, 'precision': 0.7848349, 'recall': 0.7377602, 'specificity': 0.7377602, 'f1': 0.7343707, 'auroc': 0.90505934, 'binary_precision': 0.6973294, 'binary_recall': 0.92885375, 'binary_specificity': 0.5466667, 'binary_f1_score': 0.79661024}
confusion matrix:
     0    1
0  123  102
1   18  235
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-07-13 09:26:26.964911,epoch time: 0:28:08.148331,used: 1:24:18.617430,model: dset_te_center0_dann_b44271c83_not_commited_2024md_07md_13_08_02_08_seed_1_21955593
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.977896, 'precision': 0.981257, 'recall': 0.77708375, 'specificity': 0.77708375, 'f1': 0.8490534, 'auroc': 0.9971852, 'binary_precision': 0.97770095, 'binary_recall': 0.9995622, 'binary_specificity': 0.55460525, 'binary_f1_score': 0.9885107}
confusion matrix:
     0      1
0  843    677
1   13  29683
---- Validation: 
scalar performance:
{'acc': 0.56128025, 'precision': 0.7535571, 'recall': 0.5683052, 'specificity': 0.5683052, 'f1': 0.46774635, 'auroc': 0.91624486, 'binary_precision': 0.5286195, 'binary_recall': 0.9968254, 'binary_specificity': 0.13978495, 'binary_f1_score': 0.69086903}
confusion matrix:
    0    1
0  91  560
1   2  628
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6338912, 'precision': 0.7484879, 'recall': 0.61258674, 'specificity': 0.61258674, 'f1': 0.56432974, 'auroc': 0.8702415, 'binary_precision': 0.59375, 'binary_recall': 0.97628456, 'binary_specificity': 0.2488889, 'binary_f1_score': 0.73841554}
confusion matrix:
    0    1
0  56  169
1   6  247
early stop counter: 1
val acc:0.5612802505493164, best validation acc: 0.7135050892829895, corresponding to test acc:                         0.7489539980888367 / 0.7489539980888367
after epoch: 4,now: 2024-07-13 09:54:35.080597,epoch time: 0:28:08.115686,used: 1:52:26.733116,model: dset_te_center0_dann_b44271c83_not_commited_2024md_07md_13_08_02_08_seed_1_21955593
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.98965275, 'precision': 0.98139036, 'recall': 0.90473616, 'specificity': 0.90473616, 'f1': 0.9393861, 'auroc': 0.9983039, 'binary_precision': 0.9903833, 'binary_recall': 0.9988214, 'binary_specificity': 0.8106509, 'binary_f1_score': 0.9945845}
confusion matrix:
      0      1
0  1233    288
1    35  29660
---- Validation: 
scalar performance:
{'acc': 0.6612022, 'precision': 0.7670244, 'recall': 0.66628265, 'specificity': 0.66628265, 'f1': 0.6279432, 'auroc': 0.91225463, 'binary_precision': 0.5947776, 'binary_recall': 0.97619045, 'binary_specificity': 0.3563748, 'binary_f1_score': 0.73918265}
confusion matrix:
     0    1
0  232  419
1   15  615
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7175732, 'precision': 0.7672914, 'recall': 0.703935, 'specificity': 0.703935, 'f1': 0.694638, 'auroc': 0.8899692, 'binary_precision': 0.66573036, 'binary_recall': 0.9367589, 'binary_specificity': 0.47111112, 'binary_f1_score': 0.7783251}
confusion matrix:
     0    1
0  106  119
1   16  237
early stop counter: 2
val acc:0.6612021923065186, best validation acc: 0.7135050892829895, corresponding to test acc:                         0.7489539980888367 / 0.7489539980888367
after epoch: 5,now: 2024-07-13 10:23:05.520957,epoch time: 0:28:30.440360,used: 2:20:57.173476,model: dset_te_center0_dann_b44271c83_not_commited_2024md_07md_13_08_02_08_seed_1_21955593
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.99381727, 'precision': 0.9673103, 'recall': 0.9658515, 'specificity': 0.9658515, 'f1': 0.9665796, 'auroc': 0.9990747, 'binary_precision': 0.9966668, 'binary_recall': 0.9968346, 'binary_specificity': 0.9348684, 'binary_f1_score': 0.99675065}
confusion matrix:
      0      1
0  1421     99
1    94  29602
---- Validation: 
scalar performance:
{'acc': 0.84933645, 'precision': 0.8619424, 'recall': 0.85087043, 'specificity': 0.85087043, 'f1': 0.8483751, 'auroc': 0.93183744, 'binary_precision': 0.79017264, 'binary_recall': 0.9444444, 'binary_specificity': 0.75729644, 'binary_f1_score': 0.8604483}
confusion matrix:
     0    1
0  493  158
1   35  595
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.81380755, 'precision': 0.81814575, 'recall': 0.8098463, 'specificity': 0.8098463, 'f1': 0.8113094, 'auroc': 0.9142556, 'binary_precision': 0.79285717, 'binary_recall': 0.8774704, 'binary_specificity': 0.74222225, 'binary_f1_score': 0.8330207}
confusion matrix:
     0    1
0  167   58
1   31  222
new oracle model saved
better model found
persisted
after epoch: 6,now: 2024-07-13 10:51:37.342906,epoch time: 0:28:31.821949,used: 2:49:28.995425,model: dset_te_center0_dann_b44271c83_not_commited_2024md_07md_13_08_02_08_seed_1_21955593
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9925038, 'precision': 0.98243773, 'recall': 0.9351986, 'specificity': 0.9351986, 'f1': 0.95746654, 'auroc': 0.9989493, 'binary_precision': 0.99346775, 'binary_recall': 0.9986867, 'binary_specificity': 0.87171054, 'binary_f1_score': 0.9960704}
confusion matrix:
      0      1
0  1325    195
1    39  29657
---- Validation: 
scalar performance:
{'acc': 0.76346606, 'precision': 0.8227526, 'recall': 0.7669483, 'specificity': 0.7669483, 'f1': 0.75362647, 'auroc': 0.9393729, 'binary_precision': 0.6802646, 'binary_recall': 0.97936505, 'binary_specificity': 0.5545315, 'binary_f1_score': 0.8028627}
confusion matrix:
     0    1
0  361  290
1   13  617
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7656904, 'precision': 0.7986723, 'recall': 0.75529206, 'specificity': 0.75529206, 'f1': 0.753572, 'auroc': 0.92182696, 'binary_precision': 0.71299094, 'binary_recall': 0.9328063, 'binary_specificity': 0.5777778, 'binary_f1_score': 0.8082192}
confusion matrix:
     0    1
0  130   95
1   17  236
early stop counter: 1
val acc:0.7634660601615906, best validation acc: 0.8493364453315735, corresponding to test acc:                         0.8138075470924377 / 0.8138075470924377
after epoch: 7,now: 2024-07-13 11:20:14.181013,epoch time: 0:28:36.838107,used: 3:18:05.833532,model: dset_te_center0_dann_b44271c83_not_commited_2024md_07md_13_08_02_08_seed_1_21955593
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9939774, 'precision': 0.96070933, 'recall': 0.97562575, 'specificity': 0.97562575, 'f1': 0.9680345, 'auroc': 0.9991399, 'binary_precision': 0.99770606, 'binary_recall': 0.9959589, 'binary_specificity': 0.9552926, 'binary_f1_score': 0.9968318}
confusion matrix:
      0      1
0  1453     68
1   120  29575
---- Validation: 
scalar performance:
{'acc': 0.9008587, 'precision': 0.9008417, 'recall': 0.9009472, 'specificity': 0.9009472, 'f1': 0.90084994, 'auroc': 0.94541, 'binary_precision': 0.8935837, 'binary_recall': 0.9063492, 'binary_specificity': 0.8955453, 'binary_f1_score': 0.8999211}
confusion matrix:
     0    1
0  583   68
1   59  571
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.87447697, 'precision': 0.8774879, 'recall': 0.8774879, 'specificity': 0.8774879, 'f1': 0.874477, 'auroc': 0.9279754, 'binary_precision': 0.9288889, 'binary_recall': 0.82608694, 'binary_specificity': 0.9288889, 'binary_f1_score': 0.874477}
confusion matrix:
     0    1
0  209   16
1   44  209
new oracle model saved
better model found
persisted
after epoch: 8,now: 2024-07-13 11:49:01.233129,epoch time: 0:28:47.052116,used: 3:46:52.885648,model: dset_te_center0_dann_b44271c83_not_commited_2024md_07md_13_08_02_08_seed_1_21955593
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9928242, 'precision': 0.98239243, 'recall': 0.93884, 'specificity': 0.93884, 'f1': 0.9594714, 'auroc': 0.9990413, 'binary_precision': 0.9938336, 'binary_recall': 0.998653, 'binary_specificity': 0.87902695, 'binary_f1_score': 0.99623746}
confusion matrix:
      0      1
0  1337    184
1    40  29655
---- Validation: 
scalar performance:
{'acc': 0.82435596, 'precision': 0.8464943, 'recall': 0.8264209, 'specificity': 0.8264209, 'f1': 0.82210803, 'auroc': 0.93454516, 'binary_precision': 0.754717, 'binary_recall': 0.95238096, 'binary_specificity': 0.70046085, 'binary_f1_score': 0.8421052}
confusion matrix:
     0    1
0  456  195
1   30  600
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8012552, 'precision': 0.82396686, 'recall': 0.79306984, 'specificity': 0.79306984, 'f1': 0.7941178, 'auroc': 0.88231885, 'binary_precision': 0.75159234, 'binary_recall': 0.9328063, 'binary_specificity': 0.6533333, 'binary_f1_score': 0.8324515}
confusion matrix:
     0    1
0  147   78
1   17  236
early stop counter: 1
val acc:0.824355959892273, best validation acc: 0.9008587002754211, corresponding to test acc:                         0.874476969242096 / 0.874476969242096
after epoch: 9,now: 2024-07-13 12:17:34.035681,epoch time: 0:28:32.802552,used: 4:15:25.688200,model: dset_te_center0_dann_b44271c83_not_commited_2024md_07md_13_08_02_08_seed_1_21955593
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.98821115, 'precision': 0.9881797, 'recall': 0.88339347, 'specificity': 0.88339347, 'f1': 0.9288218, 'auroc': 0.99914646, 'binary_precision': 0.9882138, 'binary_recall': 0.9995285, 'binary_specificity': 0.7672584, 'binary_f1_score': 0.9938389}
confusion matrix:
      0      1
0  1167    354
1    14  29681
---- Validation: 
scalar performance:
{'acc': 0.72521466, 'precision': 0.7989887, 'recall': 0.7292371, 'specificity': 0.7292371, 'f1': 0.7093816, 'auroc': 0.945588, 'binary_precision': 0.6463158, 'binary_recall': 0.9746032, 'binary_specificity': 0.48387095, 'binary_f1_score': 0.77721524}
confusion matrix:
     0    1
0  315  336
1   16  614
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.751046, 'precision': 0.80548793, 'recall': 0.73801494, 'specificity': 0.73801494, 'f1': 0.73213726, 'auroc': 0.938094, 'binary_precision': 0.69034094, 'binary_recall': 0.9604743, 'binary_specificity': 0.51555556, 'binary_f1_score': 0.80330586}
confusion matrix:
     0    1
0  116  109
1   10  243
early stop counter: 2
val acc:0.7252146601676941, best validation acc: 0.9008587002754211, corresponding to test acc:                         0.874476969242096 / 0.874476969242096
after epoch: 10,now: 2024-07-13 12:45:49.297532,epoch time: 0:28:15.261851,used: 4:43:40.950051,model: dset_te_center0_dann_b44271c83_not_commited_2024md_07md_13_08_02_08_seed_1_21955593
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9952909, 'precision': 0.9796144, 'recall': 0.9691229, 'specificity': 0.9691229, 'f1': 0.97430396, 'auroc': 0.99940866, 'binary_precision': 0.99693924, 'binary_recall': 0.9981142, 'binary_specificity': 0.9401316, 'binary_f1_score': 0.99752635}
confusion matrix:
      0      1
0  1429     91
1    56  29640
---- Validation: 
scalar performance:
{'acc': 0.84543324, 'precision': 0.8623915, 'recall': 0.84720945, 'specificity': 0.84720945, 'f1': 0.84404176, 'auroc': 0.94843096, 'binary_precision': 0.7797927, 'binary_recall': 0.95555556, 'binary_specificity': 0.7388633, 'binary_f1_score': 0.8587732}
confusion matrix:
     0    1
0  481  170
1   28  602
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.85983264, 'precision': 0.8621261, 'recall': 0.8572595, 'specificity': 0.8572595, 'f1': 0.8585793, 'auroc': 0.9410453, 'binary_precision': 0.84444445, 'binary_recall': 0.90118575, 'binary_specificity': 0.81333333, 'binary_f1_score': 0.87189287}
confusion matrix:
     0    1
0  183   42
1   25  228
early stop counter: 3
val acc:0.845433235168457, best validation acc: 0.9008587002754211, corresponding to test acc:                         0.874476969242096 / 0.874476969242096
after epoch: 11,now: 2024-07-13 13:13:23.650765,epoch time: 0:27:34.353233,used: 5:11:15.303284,model: dset_te_center0_dann_b44271c83_not_commited_2024md_07md_13_08_02_08_seed_1_21955593
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9948424, 'precision': 0.9695829, 'recall': 0.9751447, 'specificity': 0.9751447, 'f1': 0.97234553, 'auroc': 0.9992287, 'binary_precision': 0.99760747, 'binary_recall': 0.99696916, 'binary_specificity': 0.9533202, 'binary_f1_score': 0.9972882}
confusion matrix:
      0      1
0  1450     71
1    90  29605
---- Validation: 
scalar performance:
{'acc': 0.9078845, 'precision': 0.907847, 'recall': 0.9079365, 'specificity': 0.9079365, 'f1': 0.90787184, 'auroc': 0.9478117, 'binary_precision': 0.9025157, 'binary_recall': 0.9111111, 'binary_specificity': 0.9047619, 'binary_f1_score': 0.90679306}
confusion matrix:
     0    1
0  589   62
1   56  574
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8912134, 'precision': 0.89816964, 'recall': 0.8955116, 'specificity': 0.8955116, 'f1': 0.89116573, 'auroc': 0.94423366, 'binary_precision': 0.96744186, 'binary_recall': 0.8221344, 'binary_specificity': 0.9688889, 'binary_f1_score': 0.88888884}
confusion matrix:
     0    1
0  218    7
1   45  208
new oracle model saved
better model found
persisted
after epoch: 12,now: 2024-07-13 13:41:03.653275,epoch time: 0:27:40.002510,used: 5:38:55.305794,model: dset_te_center0_dann_b44271c83_not_commited_2024md_07md_13_08_02_08_seed_1_21955593
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.99388134, 'precision': 0.9820186, 'recall': 0.95093566, 'specificity': 0.95093566, 'f1': 0.9659007, 'auroc': 0.99924505, 'binary_precision': 0.99506676, 'binary_recall': 0.9985183, 'binary_specificity': 0.90335304, 'binary_f1_score': 0.9967895}
confusion matrix:
      0      1
0  1374    147
1    44  29651
---- Validation: 
scalar performance:
{'acc': 0.8813427, 'precision': 0.88494325, 'recall': 0.88215566, 'specificity': 0.88215566, 'f1': 0.8811961, 'auroc': 0.94539416, 'binary_precision': 0.8433908, 'binary_recall': 0.931746, 'binary_specificity': 0.8325653, 'binary_f1_score': 0.88536954}
confusion matrix:
     0    1
0  542  109
1   43  587
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8870293, 'precision': 0.8880091, 'recall': 0.8890997, 'specificity': 0.8890997, 'f1': 0.88699764, 'auroc': 0.9422047, 'binary_precision': 0.9270386, 'binary_recall': 0.85375494, 'binary_specificity': 0.92444444, 'binary_f1_score': 0.8888889}
confusion matrix:
     0    1
0  208   17
1   37  216
early stop counter: 1
val acc:0.8813427090644836, best validation acc: 0.9078844785690308, corresponding to test acc:                         0.8912134170532227 / 0.8912134170532227
after epoch: 13,now: 2024-07-13 14:08:46.876573,epoch time: 0:27:43.223298,used: 6:06:38.529092,model: dset_te_center0_dann_b44271c83_not_commited_2024md_07md_13_08_02_08_seed_1_21955593
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9942017, 'precision': 0.99106145, 'recall': 0.94576645, 'specificity': 0.94576645, 'f1': 0.9671976, 'auroc': 0.9995421, 'binary_precision': 0.9945046, 'binary_recall': 0.99942756, 'binary_specificity': 0.8921053, 'binary_f1_score': 0.99696}
confusion matrix:
      0      1
0  1356    164
1    17  29679
---- Validation: 
scalar performance:
{'acc': 0.8813427, 'precision': 0.88543034, 'recall': 0.88220686, 'specificity': 0.88220686, 'f1': 0.88116884, 'auroc': 0.94485533, 'binary_precision': 0.8414286, 'binary_recall': 0.9349206, 'binary_specificity': 0.8294931, 'binary_f1_score': 0.88571423}
confusion matrix:
     0    1
0  540  111
1   41  589
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.86820084, 'precision': 0.8684721, 'recall': 0.86688626, 'specificity': 0.86688626, 'f1': 0.8674904, 'auroc': 0.9428634, 'binary_precision': 0.86538464, 'binary_recall': 0.88932806, 'binary_specificity': 0.84444445, 'binary_f1_score': 0.877193}
confusion matrix:
     0    1
0  190   35
1   28  225
early stop counter: 2
val acc:0.8813427090644836, best validation acc: 0.9078844785690308, corresponding to test acc:                         0.8912134170532227 / 0.8912134170532227
after epoch: 14,now: 2024-07-13 14:36:40.583549,epoch time: 0:27:53.706976,used: 6:34:32.236068,model: dset_te_center0_dann_b44271c83_not_commited_2024md_07md_13_08_02_08_seed_1_21955593
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9939774, 'precision': 0.97601354, 'recall': 0.9581597, 'specificity': 0.9581597, 'f1': 0.9668964, 'auroc': 0.9992224, 'binary_precision': 0.9958326, 'binary_recall': 0.99784476, 'binary_specificity': 0.9184747, 'binary_f1_score': 0.9968377}
confusion matrix:
      0      1
0  1397    124
1    64  29631
---- Validation: 
scalar performance:
{'acc': 0.85714287, 'precision': 0.86999726, 'recall': 0.85867894, 'specificity': 0.85867894, 'f1': 0.8562314, 'auroc': 0.9524931, 'binary_precision': 0.7968128, 'binary_recall': 0.95238096, 'binary_specificity': 0.764977, 'binary_f1_score': 0.867679}
confusion matrix:
     0    1
0  498  153
1   30  600
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.84309626, 'precision': 0.8483225, 'recall': 0.8392358, 'specificity': 0.8392358, 'f1': 0.840991, 'auroc': 0.9382169, 'binary_precision': 0.81785715, 'binary_recall': 0.9051383, 'binary_specificity': 0.7733333, 'binary_f1_score': 0.859287}
confusion matrix:
     0    1
0  174   51
1   24  229
early stop counter: 3
val acc:0.8571428656578064, best validation acc: 0.9078844785690308, corresponding to test acc:                         0.8912134170532227 / 0.8912134170532227
after epoch: 15,now: 2024-07-13 15:04:43.406226,epoch time: 0:28:02.822677,used: 7:02:35.058745,model: dset_te_center0_dann_b44271c83_not_commited_2024md_07md_13_08_02_08_seed_1_21955593
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.99593157, 'precision': 0.982267, 'recall': 0.9735339, 'specificity': 0.9735339, 'f1': 0.977856, 'auroc': 0.99963725, 'binary_precision': 0.99737585, 'binary_recall': 0.9983499, 'binary_specificity': 0.94871795, 'binary_f1_score': 0.99786264}
confusion matrix:
      0      1
0  1443     78
1    49  29646
---- Validation: 
scalar performance:
{'acc': 0.882904, 'precision': 0.8852376, 'recall': 0.88356376, 'specificity': 0.88356376, 'f1': 0.8828262, 'auroc': 0.9495404, 'binary_precision': 0.85087717, 'binary_recall': 0.9238095, 'binary_specificity': 0.843318, 'binary_f1_score': 0.8858447}
confusion matrix:
     0    1
0  549  102
1   48  582
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.86820084, 'precision': 0.8676192, 'recall': 0.86836183, 'specificity': 0.86836183, 'f1': 0.867895, 'auroc': 0.9325253, 'binary_precision': 0.8830645, 'binary_recall': 0.8656126, 'binary_specificity': 0.8711111, 'binary_f1_score': 0.8742515}
confusion matrix:
     0    1
0  196   29
1   34  219
early stop counter: 4
val acc:0.8829039931297302, best validation acc: 0.9078844785690308, corresponding to test acc:                         0.8912134170532227 / 0.8912134170532227
after epoch: 16,now: 2024-07-13 15:32:33.845234,epoch time: 0:27:50.439008,used: 7:30:25.497753,model: dset_te_center0_dann_b44271c83_not_commited_2024md_07md_13_08_02_08_seed_1_21955593
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9960917, 'precision': 0.97336376, 'recall': 0.98515815, 'specificity': 0.98515815, 'f1': 0.9791798, 'auroc': 0.99966943, 'binary_precision': 0.9986174, 'binary_recall': 0.99727225, 'binary_specificity': 0.97304404, 'binary_f1_score': 0.99794436}
confusion matrix:
      0      1
0  1480     41
1    81  29614
---- Validation: 
scalar performance:
{'acc': 0.8462139, 'precision': 0.8609862, 'recall': 0.84787506, 'specificity': 0.84787506, 'f1': 0.84502923, 'auroc': 0.94759715, 'binary_precision': 0.7837484, 'binary_recall': 0.94920635, 'binary_specificity': 0.74654377, 'binary_f1_score': 0.8585786}
confusion matrix:
     0    1
0  486  165
1   32  598
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8200837, 'precision': 0.8283261, 'recall': 0.8150373, 'specificity': 0.8150373, 'f1': 0.81679946, 'auroc': 0.908195, 'binary_precision': 0.7889273, 'binary_recall': 0.90118575, 'binary_specificity': 0.72888887, 'binary_f1_score': 0.8413284}
confusion matrix:
     0    1
0  164   61
1   25  228
early stop counter: 5
val acc:0.8462138772010803, best validation acc: 0.9078844785690308, corresponding to test acc:                         0.8912134170532227 / 0.8912134170532227
after epoch: 17,now: 2024-07-13 16:00:06.198655,epoch time: 0:27:32.353421,used: 7:57:57.851174,model: dset_te_center0_dann_b44271c83_not_commited_2024md_07md_13_08_02_08_seed_1_21955593
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 17 with time: 7:57:57.851174 at 2024-07-13 16:00:06.198655
persisted model performance metric: 

scalar performance:
{'acc': 0.8912134, 'precision': 0.89816964, 'recall': 0.8955116, 'specificity': 0.8955116, 'f1': 0.89116573, 'auroc': 0.94423366, 'binary_precision': 0.96744186, 'binary_recall': 0.8221344, 'binary_specificity': 0.9688889, 'binary_f1_score': 0.88888884}
confusion matrix:
     0    1
0  218    7
1   45  208
oracle model performance metric: 

scalar performance:
{'acc': 0.8912134, 'precision': 0.89816964, 'recall': 0.8955116, 'specificity': 0.8955116, 'f1': 0.89116573, 'auroc': 0.94423366, 'binary_precision': 0.96744186, 'binary_recall': 0.8221344, 'binary_specificity': 0.9688889, 'binary_f1_score': 0.88888884}
confusion matrix:
     0    1
0  218    7
1   45  208
results aggregation path: zoutput/benchmarks/CAMELYONWILD_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_halffreeze/rule_results/8.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONWILD_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_halffreeze/confusion_matrix/8.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 319379 KiB |   5292 MiB |   1902 TiB |   1902 TiB |
|       from large pool | 292187 KiB |   5266 MiB |   1880 TiB |   1880 TiB |
|       from small pool |  27192 KiB |     43 MiB |     22 TiB |     22 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 319379 KiB |   5292 MiB |   1902 TiB |   1902 TiB |
|       from large pool | 292187 KiB |   5266 MiB |   1880 TiB |   1880 TiB |
|       from small pool |  27192 KiB |     43 MiB |     22 TiB |     22 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 313851 KiB |   5290 MiB |   1901 TiB |   1901 TiB |
|       from large pool | 286862 KiB |   5264 MiB |   1879 TiB |   1879 TiB |
|       from small pool |  26989 KiB |     43 MiB |     22 TiB |     22 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   6250 MiB |   6784 MiB |  12524 MiB |   6274 MiB |
|       from large pool |   6200 MiB |   6734 MiB |  12458 MiB |   6258 MiB |
|       from small pool |     50 MiB |     50 MiB |     66 MiB |     16 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 209004 KiB |   1019 MiB |   2131 TiB |   2131 TiB |
|       from large pool | 201381 KiB |   1017 MiB |   2109 TiB |   2109 TiB |
|       from small pool |   7623 KiB |     20 MiB |     22 TiB |     22 TiB |
|---------------------------------------------------------------------------|
| Allocations           |    1078    |    4649    |  269606 K  |  269605 K  |
|       from large pool |     130    |     601    |  170939 K  |  170938 K  |
|       from small pool |     948    |    4518    |   98667 K  |   98666 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    1078    |    4649    |  269606 K  |  269605 K  |
|       from large pool |     130    |     601    |  170939 K  |  170938 K  |
|       from small pool |     948    |    4518    |   98667 K  |   98666 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     264    |     265    |     490    |     226    |
|       from large pool |     239    |     240    |     457    |     218    |
|       from small pool |      25    |      25    |      33    |       8    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      65    |    1981    |  160430 K  |  160430 K  |
|       from large pool |      21    |     241    |  118857 K  |  118857 K  |
|       from small pool |      44    |    1960    |   41573 K  |   41573 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   5292 MiB |   1902 TiB |   1902 TiB |
|       from large pool |  16640 KiB |   5266 MiB |   1880 TiB |   1880 TiB |
|       from small pool |      0 KiB |     43 MiB |     22 TiB |     22 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   5292 MiB |   1902 TiB |   1902 TiB |
|       from large pool |  16640 KiB |   5266 MiB |   1880 TiB |   1880 TiB |
|       from small pool |      0 KiB |     43 MiB |     22 TiB |     22 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   5290 MiB |   1901 TiB |   1901 TiB |
|       from large pool |  16640 KiB |   5264 MiB |   1879 TiB |   1879 TiB |
|       from small pool |      0 KiB |     43 MiB |     22 TiB |     22 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 528384 KiB |   6784 MiB |  12524 MiB |  12008 MiB |
|       from large pool | 493568 KiB |   6734 MiB |  12458 MiB |  11976 MiB |
|       from small pool |  34816 KiB |     50 MiB |     66 MiB |     32 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1019 MiB |   2131 TiB |   2131 TiB |
|       from large pool |  24320 KiB |   1017 MiB |   2109 TiB |   2109 TiB |
|       from small pool |      0 KiB |     20 MiB |     22 TiB |     22 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    4649    |  269606 K  |  269606 K  |
|       from large pool |       2    |     601    |  170939 K  |  170939 K  |
|       from small pool |       0    |    4518    |   98667 K  |   98667 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    4649    |  269606 K  |  269606 K  |
|       from large pool |       2    |     601    |  170939 K  |  170939 K  |
|       from small pool |       0    |    4518    |   98667 K  |   98667 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      39    |     265    |     490    |     451    |
|       from large pool |      22    |     240    |     457    |     435    |
|       from small pool |      17    |      25    |      33    |      16    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    1981    |  160430 K  |  160430 K  |
|       from large pool |       3    |     241    |  118857 K  |  118857 K  |
|       from small pool |       0    |    1960    |   41573 K  |   41573 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   5292 MiB |   1902 TiB |   1902 TiB |
|       from large pool |  16640 KiB |   5266 MiB |   1880 TiB |   1880 TiB |
|       from small pool |      0 KiB |     43 MiB |     22 TiB |     22 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   5292 MiB |   1902 TiB |   1902 TiB |
|       from large pool |  16640 KiB |   5266 MiB |   1880 TiB |   1880 TiB |
|       from small pool |      0 KiB |     43 MiB |     22 TiB |     22 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   5290 MiB |   1901 TiB |   1901 TiB |
|       from large pool |  16640 KiB |   5264 MiB |   1879 TiB |   1879 TiB |
|       from small pool |      0 KiB |     43 MiB |     22 TiB |     22 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 528384 KiB |   6784 MiB |  12524 MiB |  12008 MiB |
|       from large pool | 493568 KiB |   6734 MiB |  12458 MiB |  11976 MiB |
|       from small pool |  34816 KiB |     50 MiB |     66 MiB |     32 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1019 MiB |   2131 TiB |   2131 TiB |
|       from large pool |  24320 KiB |   1017 MiB |   2109 TiB |   2109 TiB |
|       from small pool |      0 KiB |     20 MiB |     22 TiB |     22 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    4649    |  269606 K  |  269606 K  |
|       from large pool |       2    |     601    |  170939 K  |  170939 K  |
|       from small pool |       0    |    4518    |   98667 K  |   98667 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    4649    |  269606 K  |  269606 K  |
|       from large pool |       2    |     601    |  170939 K  |  170939 K  |
|       from small pool |       0    |    4518    |   98667 K  |   98667 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      39    |     265    |     490    |     451    |
|       from large pool |      22    |     240    |     457    |     435    |
|       from small pool |      17    |      25    |      33    |      16    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    1981    |  160430 K  |  160430 K  |
|       from large pool |       3    |     241    |  118857 K  |  118857 K  |
|       from small pool |       0    |    1960    |   41573 K  |   41573 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_dann_b44271c83_not_commited_2024md_07md_13_16_15_00_seed_2_21955593

 Experiment start at: 2024-07-13 16:15:00.442370
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
before training, model accuracy: 0.5684210062026978
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9516828, 'precision': 0.4758414, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48762167, 'auroc': 0.9922514, 'binary_precision': 0.9516828, 'binary_recall': 1.0, 'binary_specificity': 0.0, 'binary_f1_score': 0.97524333}
confusion matrix:
   0      1
0  0   1516
1  0  29860
---- Validation: 
scalar performance:
{'acc': 0.48669797, 'precision': 0.24334899, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.32736844, 'auroc': 0.9240403, 'binary_precision': 0.48669797, 'binary_recall': 1.0, 'binary_specificity': 0.0, 'binary_f1_score': 0.6547369}
confusion matrix:
   0    1
0  0  656
1  0  622
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5452632, 'precision': 0.2726316, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.35286105, 'auroc': 0.9232089, 'binary_precision': 0.5452632, 'binary_recall': 1.0, 'binary_specificity': 0.0, 'binary_f1_score': 0.7057221}
confusion matrix:
   0    1
0  0  216
1  0  259
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-13 16:43:07.207055,epoch time: 0:28:06.764685,used: 0:28:06.764685,model: dset_te_center0_dann_b44271c83_not_commited_2024md_07md_13_16_15_00_seed_2_21955593
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9516828, 'precision': 0.4758414, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48762167, 'auroc': 0.9921876, 'binary_precision': 0.9516828, 'binary_recall': 1.0, 'binary_specificity': 0.0, 'binary_f1_score': 0.97524333}
confusion matrix:
   0      1
0  0   1516
1  0  29860
---- Validation: 
scalar performance:
{'acc': 0.48669797, 'precision': 0.24334899, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.32736844, 'auroc': 0.92744935, 'binary_precision': 0.48669797, 'binary_recall': 1.0, 'binary_specificity': 0.0, 'binary_f1_score': 0.6547369}
confusion matrix:
   0    1
0  0  656
1  0  622
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5452632, 'precision': 0.2726316, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.35286105, 'auroc': 0.92931324, 'binary_precision': 0.5452632, 'binary_recall': 1.0, 'binary_specificity': 0.0, 'binary_f1_score': 0.7057221}
confusion matrix:
   0    1
0  0  216
1  0  259
early stop counter: 1
val acc:0.4866979718208313, best validation acc: 0.4866979718208313, corresponding to test acc:                         0.5452631711959839 / 0.5452631711959839
after epoch: 2,now: 2024-07-13 17:10:56.747132,epoch time: 0:27:49.540077,used: 0:55:56.304762,model: dset_te_center0_dann_b44271c83_not_commited_2024md_07md_13_16_15_00_seed_2_21955593
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9516828, 'precision': 0.4758414, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48762167, 'auroc': 0.9916631, 'binary_precision': 0.9516828, 'binary_recall': 1.0, 'binary_specificity': 0.0, 'binary_f1_score': 0.97524333}
confusion matrix:
   0      1
0  0   1516
1  0  29860
---- Validation: 
scalar performance:
{'acc': 0.48669797, 'precision': 0.24334899, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.32736844, 'auroc': 0.89287364, 'binary_precision': 0.48669797, 'binary_recall': 1.0, 'binary_specificity': 0.0, 'binary_f1_score': 0.6547369}
confusion matrix:
   0    1
0  0  656
1  0  622
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5452632, 'precision': 0.2726316, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.35286105, 'auroc': 0.89384925, 'binary_precision': 0.5452632, 'binary_recall': 1.0, 'binary_specificity': 0.0, 'binary_f1_score': 0.7057221}
confusion matrix:
   0    1
0  0  216
1  0  259
early stop counter: 2
val acc:0.4866979718208313, best validation acc: 0.4866979718208313, corresponding to test acc:                         0.5452631711959839 / 0.5452631711959839
after epoch: 3,now: 2024-07-13 17:38:49.098749,epoch time: 0:27:52.351617,used: 1:23:48.656379,model: dset_te_center0_dann_b44271c83_not_commited_2024md_07md_13_16_15_00_seed_2_21955593
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9516828, 'precision': 0.4758414, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48762167, 'auroc': 0.99134934, 'binary_precision': 0.9516828, 'binary_recall': 1.0, 'binary_specificity': 0.0, 'binary_f1_score': 0.97524333}
confusion matrix:
   0      1
0  0   1516
1  0  29860
---- Validation: 
scalar performance:
{'acc': 0.48669797, 'precision': 0.24334899, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.32736844, 'auroc': 0.91250014, 'binary_precision': 0.48669797, 'binary_recall': 1.0, 'binary_specificity': 0.0, 'binary_f1_score': 0.6547369}
confusion matrix:
   0    1
0  0  656
1  0  622
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5452632, 'precision': 0.2726316, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.35286105, 'auroc': 0.9126671, 'binary_precision': 0.5452632, 'binary_recall': 1.0, 'binary_specificity': 0.0, 'binary_f1_score': 0.7057221}
confusion matrix:
   0    1
0  0  216
1  0  259
early stop counter: 3
val acc:0.4866979718208313, best validation acc: 0.4866979718208313, corresponding to test acc:                         0.5452631711959839 / 0.5452631711959839
after epoch: 4,now: 2024-07-13 18:06:56.639915,epoch time: 0:28:07.541166,used: 1:51:56.197545,model: dset_te_center0_dann_b44271c83_not_commited_2024md_07md_13_16_15_00_seed_2_21955593
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9516828, 'precision': 0.4758414, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48762167, 'auroc': 0.99605936, 'binary_precision': 0.9516828, 'binary_recall': 1.0, 'binary_specificity': 0.0, 'binary_f1_score': 0.97524333}
confusion matrix:
   0      1
0  0   1516
1  0  29860
---- Validation: 
scalar performance:
{'acc': 0.48669797, 'precision': 0.24334899, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.32736844, 'auroc': 0.904722, 'binary_precision': 0.48669797, 'binary_recall': 1.0, 'binary_specificity': 0.0, 'binary_f1_score': 0.6547369}
confusion matrix:
   0    1
0  0  656
1  0  622
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5452632, 'precision': 0.2726316, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.35286105, 'auroc': 0.8855373, 'binary_precision': 0.5452632, 'binary_recall': 1.0, 'binary_specificity': 0.0, 'binary_f1_score': 0.7057221}
confusion matrix:
   0    1
0  0  216
1  0  259
early stop counter: 4
val acc:0.4866979718208313, best validation acc: 0.4866979718208313, corresponding to test acc:                         0.5452631711959839 / 0.5452631711959839
after epoch: 5,now: 2024-07-13 18:34:59.468587,epoch time: 0:28:02.828672,used: 2:19:59.026217,model: dset_te_center0_dann_b44271c83_not_commited_2024md_07md_13_16_15_00_seed_2_21955593
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9516828, 'precision': 0.4758414, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48762167, 'auroc': 0.9773958, 'binary_precision': 0.9516828, 'binary_recall': 1.0, 'binary_specificity': 0.0, 'binary_f1_score': 0.97524333}
confusion matrix:
   0      1
0  0   1516
1  0  29860
---- Validation: 
scalar performance:
{'acc': 0.48669797, 'precision': 0.24334899, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.32736844, 'auroc': 0.8050263, 'binary_precision': 0.48669797, 'binary_recall': 1.0, 'binary_specificity': 0.0, 'binary_f1_score': 0.6547369}
confusion matrix:
   0    1
0  0  656
1  0  622
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5452632, 'precision': 0.2726316, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.35286105, 'auroc': 0.82087445, 'binary_precision': 0.5452632, 'binary_recall': 1.0, 'binary_specificity': 0.0, 'binary_f1_score': 0.7057221}
confusion matrix:
   0    1
0  0  216
1  0  259
early stop counter: 5
val acc:0.4866979718208313, best validation acc: 0.4866979718208313, corresponding to test acc:                         0.5452631711959839 / 0.5452631711959839
after epoch: 6,now: 2024-07-13 19:02:54.921952,epoch time: 0:27:55.453365,used: 2:47:54.479582,model: dset_te_center0_dann_b44271c83_not_commited_2024md_07md_13_16_15_00_seed_2_21955593
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 6 with time: 2:47:54.479582 at 2024-07-13 19:02:54.921952
persisted model performance metric: 

scalar performance:
{'acc': 0.5452632, 'precision': 0.2726316, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.35286105, 'auroc': 0.9232089, 'binary_precision': 0.5452632, 'binary_recall': 1.0, 'binary_specificity': 0.0, 'binary_f1_score': 0.7057221}
confusion matrix:
   0    1
0  0  216
1  0  259
oracle model performance metric: 

scalar performance:
{'acc': 0.5452632, 'precision': 0.2726316, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.35286105, 'auroc': 0.9232089, 'binary_precision': 0.5452632, 'binary_recall': 1.0, 'binary_specificity': 0.0, 'binary_f1_score': 0.7057221}
confusion matrix:
   0    1
0  0  216
1  0  259
results aggregation path: zoutput/benchmarks/CAMELYONWILD_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_halffreeze/rule_results/8.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONWILD_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_halffreeze/confusion_matrix/8.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 318443 KiB |   5294 MiB |   2277 TiB |   2277 TiB |
|       from large pool | 291251 KiB |   5268 MiB |   2250 TiB |   2250 TiB |
|       from small pool |  27192 KiB |     43 MiB |     26 TiB |     26 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 318443 KiB |   5294 MiB |   2277 TiB |   2277 TiB |
|       from large pool | 291251 KiB |   5268 MiB |   2250 TiB |   2250 TiB |
|       from small pool |  27192 KiB |     43 MiB |     26 TiB |     26 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 313851 KiB |   5290 MiB |   2275 TiB |   2275 TiB |
|       from large pool | 286862 KiB |   5264 MiB |   2249 TiB |   2249 TiB |
|       from small pool |  26989 KiB |     43 MiB |     26 TiB |     26 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   6772 MiB |   6784 MiB |  18780 MiB |  12008 MiB |
|       from large pool |   6722 MiB |   6734 MiB |  18698 MiB |  11976 MiB |
|       from small pool |     50 MiB |     50 MiB |     82 MiB |     32 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 244756 KiB |   1019 MiB |   2549 TiB |   2549 TiB |
|       from large pool | 237133 KiB |   1017 MiB |   2522 TiB |   2522 TiB |
|       from small pool |   7623 KiB |     20 MiB |     26 TiB |     26 TiB |
|---------------------------------------------------------------------------|
| Allocations           |    1078    |    4669    |  322591 K  |  322590 K  |
|       from large pool |     130    |     601    |  204553 K  |  204553 K  |
|       from small pool |     948    |    4538    |  118037 K  |  118036 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    1078    |    4669    |  322591 K  |  322590 K  |
|       from large pool |     130    |     601    |  204553 K  |  204553 K  |
|       from small pool |     948    |    4538    |  118037 K  |  118036 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     265    |     265    |     716    |     451    |
|       from large pool |     240    |     240    |     675    |     435    |
|       from small pool |      25    |      25    |      41    |      16    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      65    |    1995    |  191314 K  |  191314 K  |
|       from large pool |      24    |     241    |  141708 K  |  141708 K  |
|       from small pool |      41    |    1971    |   49606 K  |   49606 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   5294 MiB |   2277 TiB |   2277 TiB |
|       from large pool |  16640 KiB |   5268 MiB |   2250 TiB |   2250 TiB |
|       from small pool |      0 KiB |     43 MiB |     26 TiB |     26 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   5294 MiB |   2277 TiB |   2277 TiB |
|       from large pool |  16640 KiB |   5268 MiB |   2250 TiB |   2250 TiB |
|       from small pool |      0 KiB |     43 MiB |     26 TiB |     26 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   5290 MiB |   2275 TiB |   2275 TiB |
|       from large pool |  16640 KiB |   5264 MiB |   2249 TiB |   2249 TiB |
|       from small pool |      0 KiB |     43 MiB |     26 TiB |     26 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 563200 KiB |   6784 MiB |  18780 MiB |  18230 MiB |
|       from large pool | 528384 KiB |   6734 MiB |  18698 MiB |  18182 MiB |
|       from small pool |  34816 KiB |     50 MiB |     82 MiB |     48 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1019 MiB |   2549 TiB |   2549 TiB |
|       from large pool |  24320 KiB |   1017 MiB |   2522 TiB |   2522 TiB |
|       from small pool |      0 KiB |     25 MiB |     26 TiB |     26 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    4669    |  322591 K  |  322591 K  |
|       from large pool |       2    |     601    |  204553 K  |  204553 K  |
|       from small pool |       0    |    4538    |  118037 K  |  118037 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    4669    |  322591 K  |  322591 K  |
|       from large pool |       2    |     601    |  204553 K  |  204553 K  |
|       from small pool |       0    |    4538    |  118037 K  |  118037 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      41    |     265    |     716    |     675    |
|       from large pool |      24    |     240    |     675    |     651    |
|       from small pool |      17    |      25    |      41    |      24    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    1995    |  191314 K  |  191314 K  |
|       from large pool |       3    |     241    |  141708 K  |  141708 K  |
|       from small pool |       0    |    1971    |   49606 K  |   49606 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Sat Jul 13 19:11:06 2024]
Finished job 0.
1 of 1 steps (100%) done
