Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Fri Jul 12 22:58:05 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYONWILD_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_halffreeze/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYONWILD_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_halffreeze/rule_results/4.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=4
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/swiglu_ffn.py:51: UserWarning: xFormers is not available (SwiGLU)
  warnings.warn("xFormers is not available (SwiGLU)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/attention.py:33: UserWarning: xFormers is not available (Attention)
  warnings.warn("xFormers is not available (Attention)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/block.py:40: UserWarning: xFormers is not available (Block)
  warnings.warn("xFormers is not available (Block)")
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_23_08_03_seed_0_21955591

 Experiment start at: 2024-07-12 23:08:03.667856
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
before training, model accuracy: 0.5360825061798096
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.98196375, 'precision': 0.9342662, 'recall': 0.8610623, 'specificity': 0.8610623, 'f1': 0.89390767, 'auroc': 0.99116266, 'binary_precision': 0.9861325, 'binary_recall': 0.9950316, 'binary_specificity': 0.7270929, 'binary_f1_score': 0.9905621}
confusion matrix:
      0      1
0  1103    414
1   147  29440
---- Validation: 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
scalar performance:
{'acc': 0.6754658, 'precision': 0.78462887, 'recall': 0.6797434, 'specificity': 0.6797434, 'f1': 0.644166, 'auroc': 0.92836213, 'binary_precision': 0.6048309, 'binary_recall': 0.9858268, 'binary_specificity': 0.37366003, 'binary_f1_score': 0.7497006}
confusion matrix:
     0    1
0  244  409
1    9  626
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.70309275, 'precision': 0.77121735, 'recall': 0.6703273, 'specificity': 0.6703273, 'f1': 0.65747243, 'auroc': 0.93429804, 'binary_precision': 0.66071427, 'binary_recall': 0.9592593, 'binary_specificity': 0.38139534, 'binary_f1_score': 0.7824773}
confusion matrix:
    0    1
0  82  133
1  11  259
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-12 23:19:17.231654,epoch time: 0:11:13.563798,used: 0:11:13.563798,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_23_08_03_seed_0_21955591
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.98829734, 'precision': 0.9393475, 'recall': 0.93385214, 'specificity': 0.93385214, 'f1': 0.93658054, 'auroc': 0.99559903, 'binary_precision': 0.99351484, 'binary_recall': 0.99418646, 'binary_specificity': 0.8735178, 'binary_f1_score': 0.9938506}
confusion matrix:
      0      1
0  1326    192
1   172  29414
---- Validation: 
scalar performance:
{'acc': 0.7554348, 'precision': 0.8124533, 'recall': 0.75839317, 'specificity': 0.75839317, 'f1': 0.74512887, 'auroc': 0.9317306, 'binary_precision': 0.6754386, 'binary_recall': 0.97007877, 'binary_specificity': 0.5467075, 'binary_f1_score': 0.7963801}
confusion matrix:
     0    1
0  357  296
1   19  616
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.75670105, 'precision': 0.7882011, 'recall': 0.73458225, 'specificity': 0.73458225, 'f1': 0.73626727, 'auroc': 0.9316796, 'binary_precision': 0.7171429, 'binary_recall': 0.9296296, 'binary_specificity': 0.53953487, 'binary_f1_score': 0.8096774}
confusion matrix:
     0    1
0  116   99
1   19  251
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-07-12 23:29:50.859103,epoch time: 0:10:33.627449,used: 0:21:47.191247,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_23_08_03_seed_0_21955591
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9890368, 'precision': 0.9605212, 'recall': 0.9179918, 'specificity': 0.9179918, 'f1': 0.9381087, 'auroc': 0.99693966, 'binary_precision': 0.99179363, 'binary_recall': 0.99672145, 'binary_specificity': 0.8392622, 'binary_f1_score': 0.9942514}
confusion matrix:
      0      1
0  1274    244
1    97  29489
---- Validation: 
scalar performance:
{'acc': 0.6490683, 'precision': 0.78283095, 'recall': 0.65381825, 'specificity': 0.65381825, 'f1': 0.6059637, 'auroc': 0.94242567, 'binary_precision': 0.5848007, 'binary_recall': 0.9937008, 'binary_specificity': 0.31393567, 'binary_f1_score': 0.73628944}
confusion matrix:
     0    1
0  205  448
1    4  631
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7113402, 'precision': 0.7927449, 'recall': 0.67773473, 'specificity': 0.67773473, 'f1': 0.6646317, 'auroc': 0.93221354, 'binary_precision': 0.6641414, 'binary_recall': 0.97407407, 'binary_specificity': 0.38139534, 'binary_f1_score': 0.7897898}
confusion matrix:
    0    1
0  82  133
1   7  263
early stop counter: 1
val acc:0.649068295955658, best validation acc: 0.7554348111152649, corresponding to test acc:                         0.7567010521888733 / 0.7567010521888733
after epoch: 3,now: 2024-07-12 23:40:48.308001,epoch time: 0:10:57.448898,used: 0:32:44.640145,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_23_08_03_seed_0_21955591
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.98913324, 'precision': 0.9680446, 'recall': 0.9115378, 'specificity': 0.9115378, 'f1': 0.93777144, 'auroc': 0.99763703, 'binary_precision': 0.9911005, 'binary_recall': 0.99753255, 'binary_specificity': 0.8255431, 'binary_f1_score': 0.9943061}
confusion matrix:
      0      1
0  1254    265
1    73  29512
---- Validation: 
scalar performance:
{'acc': 0.7624224, 'precision': 0.82246447, 'recall': 0.7654146, 'specificity': 0.7654146, 'f1': 0.7521676, 'auroc': 0.94337285, 'binary_precision': 0.67978144, 'binary_recall': 0.97952753, 'binary_specificity': 0.55130166, 'binary_f1_score': 0.8025807}
confusion matrix:
     0    1
0  360  293
1   13  622
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7876289, 'precision': 0.81687844, 'recall': 0.7680448, 'specificity': 0.7680448, 'f1': 0.77225786, 'auroc': 0.9394487, 'binary_precision': 0.74486804, 'binary_recall': 0.94074076, 'binary_specificity': 0.59534883, 'binary_f1_score': 0.8314238}
confusion matrix:
     0    1
0  128   87
1   16  254
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-07-12 23:51:50.038201,epoch time: 0:11:01.730200,used: 0:43:46.370345,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_23_08_03_seed_0_21955591
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9902263, 'precision': 0.96503115, 'recall': 0.92710114, 'specificity': 0.92710114, 'f1': 0.9451672, 'auroc': 0.99740696, 'binary_precision': 0.9926973, 'binary_recall': 0.99705935, 'binary_specificity': 0.85714287, 'binary_f1_score': 0.9948735}
confusion matrix:
      0      1
0  1302    217
1    87  29498
---- Validation: 
scalar performance:
{'acc': 0.73913044, 'precision': 0.8137647, 'recall': 0.7425088, 'specificity': 0.7425088, 'f1': 0.7243762, 'auroc': 0.9435916, 'binary_precision': 0.65720296, 'binary_recall': 0.984252, 'binary_specificity': 0.5007657, 'binary_f1_score': 0.7881463}
confusion matrix:
     0    1
0  327  326
1   10  625
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7752577, 'precision': 0.81478024, 'recall': 0.7526701, 'specificity': 0.7526701, 'f1': 0.75545955, 'auroc': 0.94106805, 'binary_precision': 0.72804534, 'binary_recall': 0.95185184, 'binary_specificity': 0.5534884, 'binary_f1_score': 0.82504016}
confusion matrix:
     0    1
0  119   96
1   13  257
early stop counter: 1
val acc:0.739130437374115, best validation acc: 0.7624223828315735, corresponding to test acc:                         0.7876288890838623 / 0.7876288890838623
after epoch: 5,now: 2024-07-13 00:02:55.563652,epoch time: 0:11:05.525451,used: 0:54:51.895796,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_23_08_03_seed_0_21955591
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.99057996, 'precision': 0.93906415, 'recall': 0.9628628, 'specificity': 0.9628628, 'f1': 0.9506105, 'auroc': 0.99759287, 'binary_precision': 0.99650836, 'binary_recall': 0.993578, 'binary_specificity': 0.93214756, 'binary_f1_score': 0.9950411}
confusion matrix:
      0      1
0  1415    103
1   190  29396
---- Validation: 
scalar performance:
{'acc': 0.88819873, 'precision': 0.8900524, 'recall': 0.88869786, 'specificity': 0.88869786, 'f1': 0.88813806, 'auroc': 0.9479121, 'binary_precision': 0.8594436, 'binary_recall': 0.92440945, 'binary_specificity': 0.8529862, 'binary_f1_score': 0.8907435}
confusion matrix:
     0    1
0  557   96
1   48  587
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8618557, 'precision': 0.86016655, 'recall': 0.8598191, 'specificity': 0.8598191, 'f1': 0.85998905, 'auroc': 0.93777776, 'binary_precision': 0.8745387, 'binary_recall': 0.87777776, 'binary_specificity': 0.8418605, 'binary_f1_score': 0.87615526}
confusion matrix:
     0    1
0  181   34
1   33  237
new oracle model saved
better model found
persisted
after epoch: 6,now: 2024-07-13 00:14:04.400434,epoch time: 0:11:08.836782,used: 1:06:00.732578,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_23_08_03_seed_0_21955591
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9917374, 'precision': 0.9762264, 'recall': 0.9328481, 'specificity': 0.9328481, 'f1': 0.95338535, 'auroc': 0.9985467, 'binary_precision': 0.9932394, 'binary_recall': 0.9981072, 'binary_specificity': 0.86758894, 'binary_f1_score': 0.99566734}
confusion matrix:
      0      1
0  1317    201
1    56  29530
---- Validation: 
scalar performance:
{'acc': 0.8136646, 'precision': 0.8461884, 'recall': 0.81579864, 'specificity': 0.81579864, 'f1': 0.8098682, 'auroc': 0.950615, 'binary_precision': 0.73652697, 'binary_recall': 0.96850395, 'binary_specificity': 0.6630934, 'binary_f1_score': 0.8367347}
confusion matrix:
     0    1
0  433  220
1   20  615
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.828866, 'precision': 0.8356091, 'recall': 0.81882, 'specificity': 0.81882, 'f1': 0.8230401, 'auroc': 0.9339191, 'binary_precision': 0.8085809, 'binary_recall': 0.9074074, 'binary_specificity': 0.73023254, 'binary_f1_score': 0.8551483}
confusion matrix:
     0    1
0  157   58
1   25  245
early stop counter: 1
val acc:0.8136646151542664, best validation acc: 0.888198733329773, corresponding to test acc:                         0.861855685710907 / 0.861855685710907
after epoch: 7,now: 2024-07-13 00:25:08.160251,epoch time: 0:11:03.759817,used: 1:17:04.492395,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_23_08_03_seed_0_21955591
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9920589, 'precision': 0.97404623, 'recall': 0.9386417, 'specificity': 0.9386417, 'f1': 0.95557904, 'auroc': 0.99858695, 'binary_precision': 0.99383944, 'binary_recall': 0.9978368, 'binary_specificity': 0.8794466, 'binary_f1_score': 0.9958341}
confusion matrix:
      0      1
0  1335    183
1    64  29522
---- Validation: 
scalar performance:
{'acc': 0.79891306, 'precision': 0.83702874, 'recall': 0.80125046, 'specificity': 0.80125046, 'f1': 0.7938937, 'auroc': 0.9456084, 'binary_precision': 0.7201405, 'binary_recall': 0.96850395, 'binary_specificity': 0.63399696, 'binary_f1_score': 0.8260578}
confusion matrix:
     0    1
0  414  239
1   20  615
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8226804, 'precision': 0.83267283, 'recall': 0.8108958, 'specificity': 0.8108958, 'f1': 0.81560564, 'auroc': 0.9321791, 'binary_precision': 0.7967742, 'binary_recall': 0.91481483, 'binary_specificity': 0.7069768, 'binary_f1_score': 0.8517241}
confusion matrix:
     0    1
0  152   63
1   23  247
early stop counter: 2
val acc:0.7989130616188049, best validation acc: 0.888198733329773, corresponding to test acc:                         0.861855685710907 / 0.861855685710907
after epoch: 8,now: 2024-07-13 00:36:09.976597,epoch time: 0:11:01.816346,used: 1:28:06.308741,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_23_08_03_seed_0_21955591
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9933449, 'precision': 0.9553529, 'recall': 0.97494054, 'specificity': 0.97494054, 'f1': 0.96491545, 'auroc': 0.9988828, 'binary_precision': 0.99766237, 'binary_recall': 0.99533564, 'binary_specificity': 0.95454544, 'binary_f1_score': 0.99649763}
confusion matrix:
      0      1
0  1449     69
1   138  29448
---- Validation: 
scalar performance:
{'acc': 0.9029503, 'precision': 0.9035996, 'recall': 0.9026817, 'specificity': 0.9026817, 'f1': 0.9028518, 'auroc': 0.95373505, 'binary_precision': 0.9166667, 'binary_recall': 0.8834646, 'binary_specificity': 0.9218989, 'binary_f1_score': 0.8997594}
confusion matrix:
     0    1
0  602   51
1   74  561
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8742268, 'precision': 0.8777653, 'recall': 0.88182604, 'specificity': 0.88182604, 'f1': 0.8740898, 'auroc': 0.9396038, 'binary_precision': 0.95238096, 'binary_recall': 0.8148148, 'binary_specificity': 0.9488372, 'binary_f1_score': 0.8782435}
confusion matrix:
     0    1
0  204   11
1   50  220
new oracle model saved
better model found
persisted
after epoch: 9,now: 2024-07-13 00:47:12.338928,epoch time: 0:11:02.362331,used: 1:39:08.671072,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_23_08_03_seed_0_21955591
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.99376285, 'precision': 0.9784538, 'recall': 0.9532262, 'specificity': 0.9532262, 'f1': 0.96545947, 'auroc': 0.99901474, 'binary_precision': 0.99531543, 'binary_recall': 0.9981411, 'binary_specificity': 0.90831137, 'binary_f1_score': 0.9967262}
confusion matrix:
      0      1
0  1377    139
1    55  29533
---- Validation: 
scalar performance:
{'acc': 0.8470497, 'precision': 0.865322, 'recall': 0.8486151, 'specificity': 0.8486151, 'f1': 0.8454999, 'auroc': 0.94508874, 'binary_precision': 0.7800512, 'binary_recall': 0.96062994, 'binary_specificity': 0.7366003, 'binary_f1_score': 0.8609739}
confusion matrix:
     0    1
0  481  172
1   25  610
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8453608, 'precision': 0.8446341, 'recall': 0.8412144, 'specificity': 0.8412144, 'f1': 0.8426204, 'auroc': 0.93529713, 'binary_precision': 0.8494624, 'binary_recall': 0.87777776, 'binary_specificity': 0.80465114, 'binary_f1_score': 0.863388}
confusion matrix:
     0    1
0  173   42
1   33  237
early stop counter: 1
val acc:0.8470497131347656, best validation acc: 0.9029502868652344, corresponding to test acc:                         0.8742268085479736 / 0.8742268085479736
after epoch: 10,now: 2024-07-13 00:58:17.257864,epoch time: 0:11:04.918936,used: 1:50:13.590008,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_23_08_03_seed_0_21955591
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.99318415, 'precision': 0.9649074, 'recall': 0.96141934, 'specificity': 0.96141934, 'f1': 0.96315604, 'auroc': 0.99869144, 'binary_precision': 0.99621594, 'binary_recall': 0.99662, 'binary_specificity': 0.9262187, 'binary_f1_score': 0.99641794}
confusion matrix:
      0      1
0  1406    112
1   100  29486
---- Validation: 
scalar performance:
{'acc': 0.84006214, 'precision': 0.85622334, 'recall': 0.84155023, 'specificity': 0.84155023, 'f1': 0.83861417, 'auroc': 0.93174565, 'binary_precision': 0.77677417, 'binary_recall': 0.9480315, 'binary_specificity': 0.7350689, 'binary_f1_score': 0.85390073}
confusion matrix:
     0    1
0  480  173
1   33  602
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8391753, 'precision': 0.83778864, 'recall': 0.8356589, 'specificity': 0.8356589, 'f1': 0.8365903, 'auroc': 0.92580533, 'binary_precision': 0.84782606, 'binary_recall': 0.8666667, 'binary_specificity': 0.80465114, 'binary_f1_score': 0.8571428}
confusion matrix:
     0    1
0  173   42
1   36  234
early stop counter: 2
val acc:0.840062141418457, best validation acc: 0.9029502868652344, corresponding to test acc:                         0.8742268085479736 / 0.8742268085479736
after epoch: 11,now: 2024-07-13 01:09:11.919363,epoch time: 0:10:54.661499,used: 2:01:08.251507,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_23_08_03_seed_0_21955591
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9936343, 'precision': 0.9808492, 'recall': 0.94950193, 'specificity': 0.94950193, 'f1': 0.96458745, 'auroc': 0.9990847, 'binary_precision': 0.99491394, 'binary_recall': 0.99841136, 'binary_specificity': 0.9005925, 'binary_f1_score': 0.99665964}
confusion matrix:
      0      1
0  1368    151
1    47  29538
---- Validation: 
scalar performance:
{'acc': 0.86024845, 'precision': 0.8747922, 'recall': 0.861632, 'specificity': 0.861632, 'f1': 0.85918367, 'auroc': 0.952443, 'binary_precision': 0.79738563, 'binary_recall': 0.96062994, 'binary_specificity': 0.762634, 'binary_f1_score': 0.87142855}
confusion matrix:
     0    1
0  498  155
1   25  610
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.85360825, 'precision': 0.8520458, 'recall': 0.85099053, 'specificity': 0.85099053, 'f1': 0.8514843, 'auroc': 0.9384496, 'binary_precision': 0.8644689, 'binary_recall': 0.8740741, 'binary_specificity': 0.82790697, 'binary_f1_score': 0.86924493}
confusion matrix:
     0    1
0  178   37
1   34  236
early stop counter: 3
val acc:0.8602484464645386, best validation acc: 0.9029502868652344, corresponding to test acc:                         0.8742268085479736 / 0.8742268085479736
after epoch: 12,now: 2024-07-13 01:20:09.852807,epoch time: 0:10:57.933444,used: 2:12:06.184951,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_23_08_03_seed_0_21955591
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9869792, 'precision': 0.8974273, 'recall': 0.98690593, 'specificity': 0.98690593, 'f1': 0.93701524, 'auroc': 0.9993448, 'binary_precision': 0.99931556, 'binary_recall': 0.9869871, 'binary_specificity': 0.98682475, 'binary_f1_score': 0.9931131}
confusion matrix:
      0      1
0  1498     20
1   385  29201
---- Validation: 
scalar performance:
{'acc': 0.86568326, 'precision': 0.8774879, 'recall': 0.86445236, 'specificity': 0.86445236, 'f1': 0.8643223, 'auroc': 0.95131856, 'binary_precision': 0.9408397, 'binary_recall': 0.776378, 'binary_specificity': 0.9525268, 'binary_f1_score': 0.8507334}
confusion matrix:
     0    1
0  622   31
1  142  493
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.85979384, 'precision': 0.87686604, 'recall': 0.8731266, 'specificity': 0.8731266, 'f1': 0.85974556, 'auroc': 0.9331783, 'binary_precision': 0.99029124, 'binary_recall': 0.75555557, 'binary_specificity': 0.9906977, 'binary_f1_score': 0.8571429}
confusion matrix:
     0    1
0  213    2
1   66  204
early stop counter: 4
val acc:0.8656832575798035, best validation acc: 0.9029502868652344, corresponding to test acc:                         0.8742268085479736 / 0.8742268085479736
after epoch: 13,now: 2024-07-13 01:31:08.027163,epoch time: 0:10:58.174356,used: 2:23:04.359307,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_23_08_03_seed_0_21955591
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9773341, 'precision': 0.8420927, 'recall': 0.9852748, 'specificity': 0.9852748, 'f1': 0.8993417, 'auroc': 0.9989743, 'binary_precision': 0.99968857, 'binary_recall': 0.9764746, 'binary_specificity': 0.99407506, 'binary_f1_score': 0.98794526}
confusion matrix:
      0      1
0  1510      9
1   696  28889
---- Validation: 
scalar performance:
{'acc': 0.84782606, 'precision': 0.86090755, 'recall': 0.8464941, 'specificity': 0.8464941, 'f1': 0.8460589, 'auroc': 0.9416599, 'binary_precision': 0.92621356, 'binary_recall': 0.7511811, 'binary_specificity': 0.94180703, 'binary_f1_score': 0.8295653}
confusion matrix:
     0    1
0  615   38
1  158  477
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.84948456, 'precision': 0.86562055, 'recall': 0.8624462, 'specificity': 0.8624462, 'f1': 0.84944355, 'auroc': 0.9383118, 'binary_precision': 0.9758454, 'binary_recall': 0.74814814, 'binary_specificity': 0.9767442, 'binary_f1_score': 0.8469601}
confusion matrix:
     0    1
0  210    5
1   68  202
early stop counter: 5
val acc:0.8478260636329651, best validation acc: 0.9029502868652344, corresponding to test acc:                         0.8742268085479736 / 0.8742268085479736
after epoch: 14,now: 2024-07-13 01:41:58.738928,epoch time: 0:10:50.711765,used: 2:33:55.071072,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_23_08_03_seed_0_21955591
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.99517745, 'precision': 0.971558, 'recall': 0.9768555, 'specificity': 0.9768555, 'f1': 0.9741902, 'auroc': 0.9993529, 'binary_precision': 0.9977678, 'binary_recall': 0.99716073, 'binary_specificity': 0.95655036, 'binary_f1_score': 0.9974641}
confusion matrix:
      0      1
0  1453     66
1    84  29501
---- Validation: 
scalar performance:
{'acc': 0.89440995, 'precision': 0.894488, 'recall': 0.89454126, 'specificity': 0.89454126, 'f1': 0.8944089, 'auroc': 0.9420048, 'binary_precision': 0.8844376, 'binary_recall': 0.903937, 'binary_specificity': 0.8851455, 'binary_f1_score': 0.89408094}
confusion matrix:
     0    1
0  578   75
1   61  574
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8886598, 'precision': 0.89046013, 'recall': 0.8952627, 'specificity': 0.8952627, 'f1': 0.8884506, 'auroc': 0.9336262, 'binary_precision': 0.9576271, 'binary_recall': 0.837037, 'binary_specificity': 0.95348835, 'binary_f1_score': 0.8932806}
confusion matrix:
     0    1
0  205   10
1   44  226
new oracle model saved
early stop counter: 6
val acc:0.8944099545478821, best validation acc: 0.9029502868652344, corresponding to test acc:                         0.8742268085479736 / 0.8886597752571106
after epoch: 15,now: 2024-07-13 01:52:56.446237,epoch time: 0:10:57.707309,used: 2:44:52.778381,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_23_08_03_seed_0_21955591
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.994213, 'precision': 0.98073095, 'recall': 0.95602304, 'specificity': 0.95602304, 'f1': 0.968014, 'auroc': 0.99928766, 'binary_precision': 0.9955845, 'binary_recall': 0.9983438, 'binary_specificity': 0.91370225, 'binary_f1_score': 0.99696225}
confusion matrix:
      0      1
0  1387    131
1    49  29537
---- Validation: 
scalar performance:
{'acc': 0.7585404, 'precision': 0.82255244, 'recall': 0.7616296, 'specificity': 0.7616296, 'f1': 0.7473559, 'auroc': 0.95184064, 'binary_precision': 0.6753247, 'binary_recall': 0.98267716, 'binary_specificity': 0.54058194, 'binary_f1_score': 0.8005131}
confusion matrix:
     0    1
0  353  300
1   11  624
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7649484, 'precision': 0.8217902, 'recall': 0.73867357, 'specificity': 0.73867357, 'f1': 0.73897153, 'auroc': 0.9454608, 'binary_precision': 0.7119565, 'binary_recall': 0.97037035, 'binary_specificity': 0.5069767, 'binary_f1_score': 0.8213166}
confusion matrix:
     0    1
0  109  106
1    8  262
early stop counter: 7
val acc:0.7585403919219971, best validation acc: 0.9029502868652344, corresponding to test acc:                         0.8742268085479736 / 0.8886597752571106
after epoch: 16,now: 2024-07-13 02:03:54.282900,epoch time: 0:10:57.836663,used: 2:55:50.615044,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_23_08_03_seed_0_21955591
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9939558, 'precision': 0.9524432, 'recall': 0.98620576, 'specificity': 0.98620576, 'f1': 0.9686425, 'auroc': 0.9994253, 'binary_precision': 0.9988461, 'binary_recall': 0.99479467, 'binary_specificity': 0.97761685, 'binary_f1_score': 0.9968163}
confusion matrix:
      0      1
0  1485     34
1   154  29431
---- Validation: 
scalar performance:
{'acc': 0.8959627, 'precision': 0.89604086, 'recall': 0.8960943, 'specificity': 0.8960943, 'f1': 0.89596176, 'auroc': 0.9510436, 'binary_precision': 0.8859784, 'binary_recall': 0.9055118, 'binary_specificity': 0.88667685, 'binary_f1_score': 0.89563864}
confusion matrix:
     0    1
0  579   74
1   60  575
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8701031, 'precision': 0.87158024, 'recall': 0.8762274, 'specificity': 0.8762274, 'f1': 0.86983526, 'auroc': 0.93192077, 'binary_precision': 0.93670887, 'binary_recall': 0.82222223, 'binary_specificity': 0.9302326, 'binary_f1_score': 0.87573963}
confusion matrix:
     0    1
0  200   15
1   48  222
early stop counter: 8
val acc:0.8959627151489258, best validation acc: 0.9029502868652344, corresponding to test acc:                         0.8742268085479736 / 0.8886597752571106
after epoch: 17,now: 2024-07-13 02:14:54.151858,epoch time: 0:10:59.868958,used: 3:06:50.484002,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_23_08_03_seed_0_21955591
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9938593, 'precision': 0.9625809, 'recall': 0.9721032, 'specificity': 0.9721032, 'f1': 0.9672878, 'auroc': 0.9991351, 'binary_precision': 0.99732673, 'binary_recall': 0.9962143, 'binary_specificity': 0.9479921, 'binary_f1_score': 0.9967702}
confusion matrix:
      0      1
0  1440     79
1   112  29473
---- Validation: 
scalar performance:
{'acc': 0.9013975, 'precision': 0.9041636, 'recall': 0.90199685, 'specificity': 0.90199685, 'f1': 0.90130705, 'auroc': 0.9551796, 'binary_precision': 0.867052, 'binary_recall': 0.9448819, 'binary_specificity': 0.8591118, 'binary_f1_score': 0.9042954}
confusion matrix:
     0    1
0  561   92
1   35  600
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8845361, 'precision': 0.8824496, 'recall': 0.8849268, 'specificity': 0.8849268, 'f1': 0.88344145, 'auroc': 0.95118, 'binary_precision': 0.90839696, 'binary_recall': 0.88148147, 'binary_specificity': 0.88837206, 'binary_f1_score': 0.8947368}
confusion matrix:
     0    1
0  191   24
1   32  238
early stop counter: 9
val acc:0.9013975262641907, best validation acc: 0.9029502868652344, corresponding to test acc:                         0.8742268085479736 / 0.8886597752571106
after epoch: 18,now: 2024-07-13 02:25:53.735194,epoch time: 0:10:59.583336,used: 3:17:50.067338,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_23_08_03_seed_0_21955591
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9951453, 'precision': 0.9731587, 'recall': 0.97463703, 'specificity': 0.97463703, 'f1': 0.97389656, 'auroc': 0.9994469, 'binary_precision': 0.9975322, 'binary_recall': 0.9973636, 'binary_specificity': 0.95191044, 'binary_f1_score': 0.9974479}
confusion matrix:
      0      1
0  1445     73
1    78  29508
---- Validation: 
scalar performance:
{'acc': 0.8625776, 'precision': 0.87427557, 'recall': 0.86382055, 'specificity': 0.86382055, 'f1': 0.86176085, 'auroc': 0.94789946, 'binary_precision': 0.80452126, 'binary_recall': 0.9527559, 'binary_specificity': 0.7748851, 'binary_f1_score': 0.8723864}
confusion matrix:
     0    1
0  506  147
1   30  605
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.85360825, 'precision': 0.85233766, 'recall': 0.8505168, 'specificity': 0.8505168, 'f1': 0.851333, 'auroc': 0.93496984, 'binary_precision': 0.8618182, 'binary_recall': 0.87777776, 'binary_specificity': 0.82325584, 'binary_f1_score': 0.8697248}
confusion matrix:
     0    1
0  177   38
1   33  237
early stop counter: 10
val acc:0.8625776171684265, best validation acc: 0.9029502868652344, corresponding to test acc:                         0.8742268085479736 / 0.8886597752571106
after epoch: 19,now: 2024-07-13 02:36:44.235414,epoch time: 0:10:50.500220,used: 3:28:40.567558,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_23_08_03_seed_0_21955591
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.99556327, 'precision': 0.97197217, 'recall': 0.9808055, 'specificity': 0.9808055, 'f1': 0.97634304, 'auroc': 0.99949384, 'binary_precision': 0.9981729, 'binary_recall': 0.99716073, 'binary_specificity': 0.9644503, 'binary_f1_score': 0.99766654}
confusion matrix:
      0      1
0  1465     54
1    84  29501
---- Validation: 
scalar performance:
{'acc': 0.85947204, 'precision': 0.874226, 'recall': 0.8608663, 'specificity': 0.8608663, 'f1': 0.858382, 'auroc': 0.9525002, 'binary_precision': 0.79634464, 'binary_recall': 0.96062994, 'binary_specificity': 0.7611026, 'binary_f1_score': 0.8708065}
confusion matrix:
     0    1
0  497  156
1   25  610
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.85360825, 'precision': 0.85811776, 'recall': 0.84577954, 'specificity': 0.84577954, 'f1': 0.8495138, 'auroc': 0.9457537, 'binary_precision': 0.83728814, 'binary_recall': 0.91481483, 'binary_specificity': 0.7767442, 'binary_f1_score': 0.8743363}
confusion matrix:
     0    1
0  167   48
1   23  247
early stop counter: 11
val acc:0.8594720363616943, best validation acc: 0.9029502868652344, corresponding to test acc:                         0.8742268085479736 / 0.8886597752571106
after epoch: 20,now: 2024-07-13 02:47:37.549577,epoch time: 0:10:53.314163,used: 3:39:33.881721,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_23_08_03_seed_0_21955591
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.99520963, 'precision': 0.98718005, 'recall': 0.9606092, 'specificity': 0.9606092, 'f1': 0.97348, 'auroc': 0.9994588, 'binary_precision': 0.9960233, 'binary_recall': 0.9989522, 'binary_specificity': 0.9222661, 'binary_f1_score': 0.9974856}
confusion matrix:
      0      1
0  1400    118
1    31  29555
---- Validation: 
scalar performance:
{'acc': 0.8920807, 'precision': 0.8961706, 'recall': 0.8928085, 'specificity': 0.8928085, 'f1': 0.89191127, 'auroc': 0.9564867, 'binary_precision': 0.85227275, 'binary_recall': 0.9448819, 'binary_specificity': 0.8407351, 'binary_f1_score': 0.89619124}
confusion matrix:
     0    1
0  549  104
1   35  600
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8886598, 'precision': 0.8869764, 'recall': 0.88768303, 'specificity': 0.88768303, 'f1': 0.88731414, 'auroc': 0.94685614, 'binary_precision': 0.9029851, 'binary_recall': 0.8962963, 'binary_specificity': 0.87906975, 'binary_f1_score': 0.8996283}
confusion matrix:
     0    1
0  189   26
1   28  242
early stop counter: 12
val acc:0.8920807242393494, best validation acc: 0.9029502868652344, corresponding to test acc:                         0.8742268085479736 / 0.8886597752571106
after epoch: 21,now: 2024-07-13 02:58:27.542100,epoch time: 0:10:49.992523,used: 3:50:23.874244,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_23_08_03_seed_0_21955591
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9845679, 'precision': 0.88131297, 'recall': 0.9881406, 'specificity': 0.9881406, 'f1': 0.9272232, 'auroc': 0.99934256, 'binary_precision': 0.999588, 'binary_recall': 0.98418117, 'binary_specificity': 0.99210006, 'binary_f1_score': 0.99182475}
confusion matrix:
      0      1
0  1507     12
1   468  29117
---- Validation: 
scalar performance:
{'acc': 0.83229816, 'precision': 0.8531534, 'recall': 0.8305941, 'specificity': 0.8305941, 'f1': 0.8292532, 'auroc': 0.9484626, 'binary_precision': 0.9355509, 'binary_recall': 0.70866144, 'binary_specificity': 0.9525268, 'binary_f1_score': 0.8064516}
confusion matrix:
     0    1
0  622   31
1  185  450
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.82474226, 'precision': 0.85450625, 'recall': 0.8416451, 'specificity': 0.8416451, 'f1': 0.8242371, 'auroc': 0.9501809, 'binary_precision': 0.98941797, 'binary_recall': 0.6925926, 'binary_specificity': 0.9906977, 'binary_f1_score': 0.8148148}
confusion matrix:
     0    1
0  213    2
1   83  187
early stop counter: 13
val acc:0.8322981595993042, best validation acc: 0.9029502868652344, corresponding to test acc:                         0.8742268085479736 / 0.8886597752571106
after epoch: 22,now: 2024-07-13 03:09:24.292502,epoch time: 0:10:56.750402,used: 4:01:20.624646,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_23_08_03_seed_0_21955591
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.995724, 'precision': 0.9718741, 'recall': 0.9827636, 'specificity': 0.9827636, 'f1': 0.9772494, 'auroc': 0.9994024, 'binary_precision': 0.99837554, 'binary_recall': 0.99712694, 'binary_specificity': 0.96840024, 'binary_f1_score': 0.9977508}
confusion matrix:
      0      1
0  1471     48
1    85  29500
---- Validation: 
scalar performance:
{'acc': 0.88975155, 'precision': 0.89420766, 'recall': 0.8905114, 'specificity': 0.8905114, 'f1': 0.8895574, 'auroc': 0.94756246, 'binary_precision': 0.8486563, 'binary_recall': 0.9448819, 'binary_specificity': 0.8361409, 'binary_f1_score': 0.8941878}
confusion matrix:
     0    1
0  546  107
1   35  600
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.87216496, 'precision': 0.87, 'recall': 0.8728682, 'specificity': 0.8728682, 'f1': 0.8710549, 'auroc': 0.9446167, 'binary_precision': 0.9, 'binary_recall': 0.8666667, 'binary_specificity': 0.87906975, 'binary_f1_score': 0.88301885}
confusion matrix:
     0    1
0  189   26
1   36  234
early stop counter: 14
val acc:0.8897515535354614, best validation acc: 0.9029502868652344, corresponding to test acc:                         0.8742268085479736 / 0.8886597752571106
after epoch: 23,now: 2024-07-13 03:20:11.786817,epoch time: 0:10:47.494315,used: 4:12:08.118961,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_23_08_03_seed_0_21955591
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.99575615, 'precision': 0.9854274, 'recall': 0.9684164, 'specificity': 0.9684164, 'f1': 0.9767528, 'auroc': 0.9995769, 'binary_precision': 0.99682873, 'binary_recall': 0.9987156, 'binary_specificity': 0.9381172, 'binary_f1_score': 0.99777126}
confusion matrix:
      0      1
0  1425     94
1    38  29547
---- Validation: 
scalar performance:
{'acc': 0.8431677, 'precision': 0.86428475, 'recall': 0.84485173, 'specificity': 0.84485173, 'f1': 0.84129256, 'auroc': 0.9443706, 'binary_precision': 0.7730139, 'binary_recall': 0.9653543, 'binary_specificity': 0.72434914, 'binary_f1_score': 0.85854334}
confusion matrix:
     0    1
0  473  180
1   22  613
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.89484537, 'precision': 0.8929674, 'recall': 0.89465976, 'specificity': 0.89465976, 'f1': 0.89371586, 'auroc': 0.94928503, 'binary_precision': 0.91320753, 'binary_recall': 0.8962963, 'binary_specificity': 0.89302325, 'binary_f1_score': 0.904673}
confusion matrix:
     0    1
0  192   23
1   28  242
new oracle model saved
early stop counter: 15
val acc:0.8431677222251892, best validation acc: 0.9029502868652344, corresponding to test acc:                         0.8742268085479736 / 0.8948453664779663
after epoch: 24,now: 2024-07-13 03:30:55.990708,epoch time: 0:10:44.203891,used: 4:22:52.322852,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_23_08_03_seed_0_21955591
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.9934092, 'precision': 0.989164, 'recall': 0.9390789, 'specificity': 0.9390789, 'f1': 0.96262026, 'auroc': 0.99957633, 'binary_precision': 0.9938147, 'binary_recall': 0.99929017, 'binary_specificity': 0.8788677, 'binary_f1_score': 0.9965449}
confusion matrix:
      0      1
0  1335    184
1    21  29564
---- Validation: 
scalar performance:
{'acc': 0.86102486, 'precision': 0.8783525, 'recall': 0.8625279, 'specificity': 0.8625279, 'f1': 0.85974574, 'auroc': 0.9499868, 'binary_precision': 0.7938144, 'binary_recall': 0.97007877, 'binary_specificity': 0.75497705, 'binary_f1_score': 0.8731396}
confusion matrix:
     0    1
0  493  160
1   19  616
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.88247424, 'precision': 0.8817316, 'recall': 0.87975883, 'specificity': 0.87975883, 'f1': 0.8806476, 'auroc': 0.9501636, 'binary_precision': 0.8872727, 'binary_recall': 0.9037037, 'binary_specificity': 0.855814, 'binary_f1_score': 0.8954128}
confusion matrix:
     0    1
0  184   31
1   26  244
early stop counter: 16
val acc:0.8610248565673828, best validation acc: 0.9029502868652344, corresponding to test acc:                         0.8742268085479736 / 0.8948453664779663
after epoch: 25,now: 2024-07-13 03:41:42.269206,epoch time: 0:10:46.278498,used: 4:33:38.601350,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_23_08_03_seed_0_21955591
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9959491, 'precision': 0.97789955, 'recall': 0.9784968, 'specificity': 0.9784968, 'f1': 0.97819793, 'auroc': 0.99958134, 'binary_precision': 0.9979043, 'binary_recall': 0.9978368, 'binary_specificity': 0.9591568, 'binary_f1_score': 0.99787056}
confusion matrix:
      0      1
0  1456     62
1    64  29522
---- Validation: 
scalar performance:
{'acc': 0.886646, 'precision': 0.8867676, 'recall': 0.8867974, 'specificity': 0.8867974, 'f1': 0.8866457, 'auroc': 0.9470289, 'binary_precision': 0.875576, 'binary_recall': 0.8976378, 'binary_specificity': 0.87595713, 'binary_f1_score': 0.88646966}
confusion matrix:
     0    1
0  572   81
1   65  570
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8886598, 'precision': 0.8918495, 'recall': 0.89621013, 'specificity': 0.89621013, 'f1': 0.88852286, 'auroc': 0.9494746, 'binary_precision': 0.9655172, 'binary_recall': 0.8296296, 'binary_specificity': 0.96279067, 'binary_f1_score': 0.8924303}
confusion matrix:
     0    1
0  207    8
1   46  224
early stop counter: 17
val acc:0.8866459727287292, best validation acc: 0.9029502868652344, corresponding to test acc:                         0.8742268085479736 / 0.8948453664779663
after epoch: 26,now: 2024-07-13 03:52:30.322812,epoch time: 0:10:48.053606,used: 4:44:26.654956,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_23_08_03_seed_0_21955591
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.9901299, 'precision': 0.9288776, 'recall': 0.9723131, 'specificity': 0.9723131, 'f1': 0.94941497, 'auroc': 0.99866784, 'binary_precision': 0.99755293, 'binary_recall': 0.992057, 'binary_specificity': 0.9525692, 'binary_f1_score': 0.9947974}
confusion matrix:
      0      1
0  1446     72
1   235  29351
---- Validation: 
scalar performance:
{'acc': 0.8369565, 'precision': 0.84550583, 'recall': 0.83805335, 'specificity': 0.83805335, 'f1': 0.83622634, 'auroc': 0.9004184, 'binary_precision': 0.78755075, 'binary_recall': 0.91653544, 'binary_specificity': 0.7595712, 'binary_f1_score': 0.84716153}
confusion matrix:
     0    1
0  496  157
1   53  582
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8391753, 'precision': 0.8368376, 'recall': 0.83944875, 'specificity': 0.83944875, 'f1': 0.8377787, 'auroc': 0.9018777, 'binary_precision': 0.86923075, 'binary_recall': 0.837037, 'binary_specificity': 0.8418605, 'binary_f1_score': 0.8528302}
confusion matrix:
     0    1
0  181   34
1   44  226
early stop counter: 18
val acc:0.8369565010070801, best validation acc: 0.9029502868652344, corresponding to test acc:                         0.8742268085479736 / 0.8948453664779663
after epoch: 27,now: 2024-07-13 04:03:17.993360,epoch time: 0:10:47.670548,used: 4:55:14.325504,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_23_08_03_seed_0_21955591
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.99553114, 'precision': 0.9861692, 'recall': 0.9651529, 'specificity': 0.9651529, 'f1': 0.9754025, 'auroc': 0.9994923, 'binary_precision': 0.996493, 'binary_recall': 0.998817, 'binary_specificity': 0.9314888, 'binary_f1_score': 0.99765366}
confusion matrix:
      0      1
0  1414    104
1    35  29551
---- Validation: 
scalar performance:
{'acc': 0.89440995, 'precision': 0.9016427, 'recall': 0.895366, 'specificity': 0.895366, 'f1': 0.89407897, 'auroc': 0.9577842, 'binary_precision': 0.8441379, 'binary_recall': 0.9637795, 'binary_specificity': 0.8269525, 'binary_f1_score': 0.9}
confusion matrix:
     0    1
0  540  113
1   23  612
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8907217, 'precision': 0.8887211, 'recall': 0.89237726, 'specificity': 0.89237726, 'f1': 0.8898959, 'auroc': 0.9527476, 'binary_precision': 0.922179, 'binary_recall': 0.87777776, 'binary_specificity': 0.90697676, 'binary_f1_score': 0.8994307}
confusion matrix:
     0    1
0  195   20
1   33  237
early stop counter: 19
val acc:0.8944099545478821, best validation acc: 0.9029502868652344, corresponding to test acc:                         0.8742268085479736 / 0.8948453664779663
after epoch: 28,now: 2024-07-13 04:14:04.144038,epoch time: 0:10:46.150678,used: 5:06:00.476182,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_23_08_03_seed_0_21955591
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.99556327, 'precision': 0.9786693, 'recall': 0.9732774, 'specificity': 0.9732774, 'f1': 0.9759563, 'auroc': 0.9995365, 'binary_precision': 0.9973653, 'binary_recall': 0.9979721, 'binary_specificity': 0.9485827, 'binary_f1_score': 0.9976686}
confusion matrix:
      0      1
0  1439     78
1    60  29527
---- Validation: 
scalar performance:
{'acc': 0.8408385, 'precision': 0.8644926, 'recall': 0.8426198, 'specificity': 0.8426198, 'f1': 0.8386797, 'auroc': 0.94664, 'binary_precision': 0.7680798, 'binary_recall': 0.97007877, 'binary_specificity': 0.7151608, 'binary_f1_score': 0.8573417}
confusion matrix:
     0    1
0  467  186
1   19  616
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.87216496, 'precision': 0.8740293, 'recall': 0.8667097, 'specificity': 0.8667097, 'f1': 0.8693654, 'auroc': 0.9527132, 'binary_precision': 0.8636364, 'binary_recall': 0.91481483, 'binary_specificity': 0.81860465, 'binary_f1_score': 0.88848925}
confusion matrix:
     0    1
0  176   39
1   23  247
early stop counter: 20
val acc:0.8408384919166565, best validation acc: 0.9029502868652344, corresponding to test acc:                         0.8742268085479736 / 0.8948453664779663
after epoch: 29,now: 2024-07-13 04:24:45.977282,epoch time: 0:10:41.833244,used: 5:16:42.309426,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_23_08_03_seed_0_21955591
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.9954668, 'precision': 0.9670814, 'recall': 0.98543036, 'specificity': 0.98543036, 'f1': 0.976058, 'auroc': 0.9996356, 'binary_precision': 0.998679, 'binary_recall': 0.9965524, 'binary_specificity': 0.9743083, 'binary_f1_score': 0.99761456}
confusion matrix:
      0      1
0  1479     39
1   102  29484
---- Validation: 
scalar performance:
{'acc': 0.9130435, 'precision': 0.91312265, 'recall': 0.91317844, 'specificity': 0.91317844, 'f1': 0.91304255, 'auroc': 0.9551482, 'binary_precision': 0.9029276, 'binary_recall': 0.92283463, 'binary_specificity': 0.9035222, 'binary_f1_score': 0.91277254}
confusion matrix:
     0    1
0  590   63
1   49  586
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.89896905, 'precision': 0.901807, 'recall': 0.9064169, 'specificity': 0.9064169, 'f1': 0.8988297, 'auroc': 0.95040476, 'binary_precision': 0.97424895, 'binary_recall': 0.84074074, 'binary_specificity': 0.97209305, 'binary_f1_score': 0.9025845}
confusion matrix:
     0    1
0  209    6
1   43  227
new oracle model saved
better model found
persisted
after epoch: 30,now: 2024-07-13 04:35:28.694996,epoch time: 0:10:42.717714,used: 5:27:25.027140,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_23_08_03_seed_0_21955591
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 5:27:25.027140 at 2024-07-13 04:35:28.694996
persisted model performance metric: 

scalar performance:
{'acc': 0.89896905, 'precision': 0.901807, 'recall': 0.9064169, 'specificity': 0.9064169, 'f1': 0.8988297, 'auroc': 0.95040476, 'binary_precision': 0.97424895, 'binary_recall': 0.84074074, 'binary_specificity': 0.97209305, 'binary_f1_score': 0.9025845}
confusion matrix:
     0    1
0  209    6
1   43  227
oracle model performance metric: 

scalar performance:
{'acc': 0.89896905, 'precision': 0.901807, 'recall': 0.9064169, 'specificity': 0.9064169, 'f1': 0.8988297, 'auroc': 0.95040476, 'binary_precision': 0.97424895, 'binary_recall': 0.84074074, 'binary_specificity': 0.97209305, 'binary_f1_score': 0.9025845}
confusion matrix:
     0    1
0  209    6
1   43  227
results aggregation path: zoutput/benchmarks/CAMELYONWILD_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_halffreeze/rule_results/4.csv
results aggregation path: zoutput/benchmarks/CAMELYONWILD_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_halffreeze/rule_results/4.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONWILD_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_halffreeze/confusion_matrix/4.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 318782 KiB |   6782 MiB | 291711 GiB | 291711 GiB |
|       from large pool | 291597 KiB |   6756 MiB | 287048 GiB | 287047 GiB |
|       from small pool |  27185 KiB |     43 MiB |   4663 GiB |   4663 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 318782 KiB |   6782 MiB | 291711 GiB | 291711 GiB |
|       from large pool | 291597 KiB |   6756 MiB | 287048 GiB | 287047 GiB |
|       from small pool |  27185 KiB |     43 MiB |   4663 GiB |   4663 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 313851 KiB |   6778 MiB | 291498 GiB | 291497 GiB |
|       from large pool | 286862 KiB |   6752 MiB | 286845 GiB | 286844 GiB |
|       from small pool |  26989 KiB |     43 MiB |   4652 GiB |   4652 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   7454 MiB |   7454 MiB |   7454 MiB |      0 B   |
|       from large pool |   7404 MiB |   7404 MiB |   7404 MiB |      0 B   |
|       from small pool |     50 MiB |     50 MiB |     50 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory | 289473 KiB | 680184 KiB | 228749 GiB | 228749 GiB |
|       from large pool | 281843 KiB | 675647 KiB | 224080 GiB | 224079 GiB |
|       from small pool |   7630 KiB |  10779 KiB |   4669 GiB |   4669 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    1064    |    4635    |   59408 K  |   59407 K  |
|       from large pool |     130    |     756    |   27095 K  |   27095 K  |
|       from small pool |     934    |    4503    |   32312 K  |   32311 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    1064    |    4635    |   59408 K  |   59407 K  |
|       from large pool |     130    |     756    |   27095 K  |   27095 K  |
|       from small pool |     934    |    4503    |   32312 K  |   32311 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     334    |     334    |     334    |       0    |
|       from large pool |     309    |     309    |     309    |       0    |
|       from small pool |      25    |      25    |      25    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      73    |    1992    |   32484 K  |   32484 K  |
|       from large pool |      28    |     307    |   17750 K  |   17750 K  |
|       from small pool |      45    |    1965    |   14734 K  |   14734 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   6782 MiB | 291711 GiB | 291711 GiB |
|       from large pool |  16640 KiB |   6756 MiB | 287048 GiB | 287048 GiB |
|       from small pool |      0 KiB |     43 MiB |   4663 GiB |   4663 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   6782 MiB | 291711 GiB | 291711 GiB |
|       from large pool |  16640 KiB |   6756 MiB | 287048 GiB | 287048 GiB |
|       from small pool |      0 KiB |     43 MiB |   4663 GiB |   4663 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   6778 MiB | 291498 GiB | 291498 GiB |
|       from large pool |  16640 KiB |   6752 MiB | 286845 GiB | 286845 GiB |
|       from small pool |      0 KiB |     43 MiB |   4652 GiB |   4652 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 608256 KiB |   7454 MiB |   7454 MiB |   6860 MiB |
|       from large pool | 573440 KiB |   7404 MiB |   7404 MiB |   6844 MiB |
|       from small pool |  34816 KiB |     50 MiB |     50 MiB |     16 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 680184 KiB | 228749 GiB | 228749 GiB |
|       from large pool |  24320 KiB | 675647 KiB | 224080 GiB | 224080 GiB |
|       from small pool |      0 KiB |  28451 KiB |   4669 GiB |   4669 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    4635    |   59408 K  |   59408 K  |
|       from large pool |       2    |     756    |   27095 K  |   27095 K  |
|       from small pool |       0    |    4503    |   32312 K  |   32312 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    4635    |   59408 K  |   59408 K  |
|       from large pool |       2    |     756    |   27095 K  |   27095 K  |
|       from small pool |       0    |    4503    |   32312 K  |   32312 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      42    |     334    |     334    |     292    |
|       from large pool |      25    |     309    |     309    |     284    |
|       from small pool |      17    |      25    |      25    |       8    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    1992    |   32485 K  |   32485 K  |
|       from large pool |       3    |     307    |   17750 K  |   17750 K  |
|       from small pool |       0    |    1965    |   14734 K  |   14734 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   6782 MiB | 291711 GiB | 291711 GiB |
|       from large pool |  16640 KiB |   6756 MiB | 287048 GiB | 287048 GiB |
|       from small pool |      0 KiB |     43 MiB |   4663 GiB |   4663 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   6782 MiB | 291711 GiB | 291711 GiB |
|       from large pool |  16640 KiB |   6756 MiB | 287048 GiB | 287048 GiB |
|       from small pool |      0 KiB |     43 MiB |   4663 GiB |   4663 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   6778 MiB | 291498 GiB | 291498 GiB |
|       from large pool |  16640 KiB |   6752 MiB | 286845 GiB | 286845 GiB |
|       from small pool |      0 KiB |     43 MiB |   4652 GiB |   4652 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 608256 KiB |   7454 MiB |   7454 MiB |   6860 MiB |
|       from large pool | 573440 KiB |   7404 MiB |   7404 MiB |   6844 MiB |
|       from small pool |  34816 KiB |     50 MiB |     50 MiB |     16 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 680184 KiB | 228749 GiB | 228749 GiB |
|       from large pool |  24320 KiB | 675647 KiB | 224080 GiB | 224080 GiB |
|       from small pool |      0 KiB |  28451 KiB |   4669 GiB |   4669 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    4635    |   59408 K  |   59408 K  |
|       from large pool |       2    |     756    |   27095 K  |   27095 K  |
|       from small pool |       0    |    4503    |   32312 K  |   32312 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    4635    |   59408 K  |   59408 K  |
|       from large pool |       2    |     756    |   27095 K  |   27095 K  |
|       from small pool |       0    |    4503    |   32312 K  |   32312 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      42    |     334    |     334    |     292    |
|       from large pool |      25    |     309    |     309    |     284    |
|       from small pool |      17    |      25    |      25    |       8    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    1992    |   32485 K  |   32485 K  |
|       from large pool |       3    |     307    |   17750 K  |   17750 K  |
|       from small pool |       0    |    1965    |   14734 K  |   14734 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_04_49_58_seed_1_21955591

 Experiment start at: 2024-07-13 04:49:58.771433
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
before training, model accuracy: 0.6276150345802307
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9847194, 'precision': 0.9342102, 'recall': 0.89528143, 'specificity': 0.89528143, 'f1': 0.91372406, 'auroc': 0.9936718, 'binary_precision': 0.98961055, 'binary_recall': 0.9943762, 'binary_specificity': 0.79618675, 'binary_f1_score': 0.99198765}
confusion matrix:
      0      1
0  1211    310
1   167  29528
---- Validation: 
scalar performance:
{'acc': 0.7665886, 'precision': 0.80641276, 'recall': 0.7695084, 'specificity': 0.7695084, 'f1': 0.7600157, 'auroc': 0.9146954, 'binary_precision': 0.6917729, 'binary_recall': 0.947619, 'binary_specificity': 0.5913978, 'binary_f1_score': 0.799732}
confusion matrix:
     0    1
0  385  266
1   33  597
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.748954, 'precision': 0.7790246, 'recall': 0.73849803, 'specificity': 0.73849803, 'f1': 0.7359699, 'auroc': 0.91617036, 'binary_precision': 0.70090634, 'binary_recall': 0.91699606, 'binary_specificity': 0.56, 'binary_f1_score': 0.7945205}
confusion matrix:
     0    1
0  126   99
1   21  232
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-13 05:00:47.743257,epoch time: 0:10:48.971824,used: 0:10:48.971824,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_04_49_58_seed_1_21955591
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9910623, 'precision': 0.96783304, 'recall': 0.9335474, 'specificity': 0.9335474, 'f1': 0.94996345, 'auroc': 0.997481, 'binary_precision': 0.9933584, 'binary_recall': 0.99727225, 'binary_specificity': 0.8698225, 'binary_f1_score': 0.9953115}
confusion matrix:
      0      1
0  1323    198
1    81  29614
---- Validation: 
scalar performance:
{'acc': 0.7423888, 'precision': 0.7977466, 'recall': 0.7458781, 'specificity': 0.7458781, 'f1': 0.731585, 'auroc': 0.92239535, 'binary_precision': 0.66519827, 'binary_recall': 0.95873016, 'binary_specificity': 0.5330261, 'binary_f1_score': 0.7854356}
confusion matrix:
     0    1
0  347  304
1   26  604
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7196653, 'precision': 0.7740456, 'recall': 0.70566535, 'specificity': 0.70566535, 'f1': 0.6957554, 'auroc': 0.91773385, 'binary_precision': 0.66573817, 'binary_recall': 0.94466406, 'binary_specificity': 0.46666667, 'binary_f1_score': 0.78104573}
confusion matrix:
     0    1
0  105  120
1   14  239
early stop counter: 1
val acc:0.7423887848854065, best validation acc: 0.7665886282920837, corresponding to test acc:                         0.7489539980888367 / 0.7489539980888367
after epoch: 2,now: 2024-07-13 05:11:24.635246,epoch time: 0:10:36.891989,used: 0:21:25.863813,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_04_49_58_seed_1_21955591
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.99029344, 'precision': 0.95876384, 'recall': 0.93434894, 'specificity': 0.93434894, 'f1': 0.9461838, 'auroc': 0.9974848, 'binary_precision': 0.9934858, 'binary_recall': 0.9963295, 'binary_specificity': 0.8723684, 'binary_f1_score': 0.99490565}
confusion matrix:
      0      1
0  1326    194
1   109  29587
---- Validation: 
scalar performance:
{'acc': 0.80249804, 'precision': 0.8311034, 'recall': 0.8048899, 'specificity': 0.8048899, 'f1': 0.79895735, 'auroc': 0.9307878, 'binary_precision': 0.72959805, 'binary_recall': 0.9507936, 'binary_specificity': 0.65898615, 'binary_f1_score': 0.82563746}
confusion matrix:
     0    1
0  429  222
1   31  599
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7573222, 'precision': 0.7869893, 'recall': 0.747141, 'specificity': 0.747141, 'f1': 0.7452634, 'auroc': 0.9199649, 'binary_precision': 0.7082067, 'binary_recall': 0.9209486, 'binary_specificity': 0.5733333, 'binary_f1_score': 0.80068725}
confusion matrix:
     0    1
0  129   96
1   20  233
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-07-13 05:22:02.831385,epoch time: 0:10:38.196139,used: 0:32:04.059952,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_04_49_58_seed_1_21955591
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.99231166, 'precision': 0.951283, 'recall': 0.9675766, 'specificity': 0.9675766, 'f1': 0.9592678, 'auroc': 0.9983013, 'binary_precision': 0.9969295, 'binary_recall': 0.9949823, 'binary_specificity': 0.94017094, 'binary_f1_score': 0.99595493}
confusion matrix:
      0      1
0  1430     91
1   149  29546
---- Validation: 
scalar performance:
{'acc': 0.8376269, 'precision': 0.84518886, 'recall': 0.8388377, 'specificity': 0.8388377, 'f1': 0.83703804, 'auroc': 0.92562366, 'binary_precision': 0.78983516, 'binary_recall': 0.9126984, 'binary_specificity': 0.764977, 'binary_f1_score': 0.8468336}
confusion matrix:
     0    1
0  498  153
1   55  575
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.82217574, 'precision': 0.8282997, 'recall': 0.8177514, 'specificity': 0.8177514, 'f1': 0.8194246, 'auroc': 0.91935, 'binary_precision': 0.79577464, 'binary_recall': 0.8932806, 'binary_specificity': 0.74222225, 'binary_f1_score': 0.84171325}
confusion matrix:
     0    1
0  167   58
1   27  226
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-07-13 05:32:38.901326,epoch time: 0:10:36.069941,used: 0:42:40.129893,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_04_49_58_seed_1_21955591
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9930164, 'precision': 0.969766, 'recall': 0.9539119, 'specificity': 0.9539119, 'f1': 0.9616871, 'auroc': 0.9986217, 'binary_precision': 0.99542844, 'binary_recall': 0.9972386, 'binary_specificity': 0.91058517, 'binary_f1_score': 0.9963327}
confusion matrix:
      0      1
0  1385    136
1    82  29613
---- Validation: 
scalar performance:
{'acc': 0.793911, 'precision': 0.8290571, 'recall': 0.79656935, 'specificity': 0.79656935, 'f1': 0.78922516, 'auroc': 0.93926316, 'binary_precision': 0.7173397, 'binary_recall': 0.95873016, 'binary_specificity': 0.6344086, 'binary_f1_score': 0.8206522}
confusion matrix:
     0    1
0  413  238
1   26  604
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.77615064, 'precision': 0.7976051, 'recall': 0.76763284, 'specificity': 0.76763284, 'f1': 0.7677325, 'auroc': 0.9230391, 'binary_precision': 0.73101264, 'binary_recall': 0.9130435, 'binary_specificity': 0.62222224, 'binary_f1_score': 0.8119508}
confusion matrix:
     0    1
0  140   85
1   22  231
early stop counter: 1
val acc:0.7939109802246094, best validation acc: 0.8376268744468689, corresponding to test acc:                         0.8221757411956787 / 0.8221757411956787
after epoch: 5,now: 2024-07-13 05:43:15.948408,epoch time: 0:10:37.047082,used: 0:53:17.176975,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_04_49_58_seed_1_21955591
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.99058175, 'precision': 0.9842891, 'recall': 0.912398, 'specificity': 0.912398, 'f1': 0.94514686, 'auroc': 0.9982158, 'binary_precision': 0.9911463, 'binary_recall': 0.9990234, 'binary_specificity': 0.8257725, 'binary_f1_score': 0.9950692}
confusion matrix:
      0      1
0  1256    265
1    29  29666
---- Validation: 
scalar performance:
{'acc': 0.7587822, 'precision': 0.8065871, 'recall': 0.76198155, 'specificity': 0.76198155, 'f1': 0.7504554, 'auroc': 0.9240765, 'binary_precision': 0.68135595, 'binary_recall': 0.95714283, 'binary_specificity': 0.56682026, 'binary_f1_score': 0.79603964}
confusion matrix:
     0    1
0  369  282
1   27  603
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.73221755, 'precision': 0.77291054, 'recall': 0.71998245, 'specificity': 0.71998245, 'f1': 0.7142056, 'auroc': 0.8941941, 'binary_precision': 0.68115944, 'binary_recall': 0.92885375, 'binary_specificity': 0.51111114, 'binary_f1_score': 0.78595316}
confusion matrix:
     0    1
0  115  110
1   18  235
early stop counter: 2
val acc:0.7587822079658508, best validation acc: 0.8376268744468689, corresponding to test acc:                         0.8221757411956787 / 0.8221757411956787
after epoch: 6,now: 2024-07-13 05:53:54.736772,epoch time: 0:10:38.788364,used: 1:03:55.965339,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_04_49_58_seed_1_21955591
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9919593, 'precision': 0.93697035, 'recall': 0.98329794, 'specificity': 0.98329794, 'f1': 0.9588207, 'auroc': 0.9988991, 'binary_precision': 0.9986452, 'binary_recall': 0.9928944, 'binary_specificity': 0.97370154, 'binary_f1_score': 0.9957615}
confusion matrix:
      0      1
0  1481     40
1   211  29484
---- Validation: 
scalar performance:
{'acc': 0.86260736, 'precision': 0.86563027, 'recall': 0.86336404, 'specificity': 0.86336404, 'f1': 0.8624664, 'auroc': 0.93957525, 'binary_precision': 0.8280347, 'binary_recall': 0.9095238, 'binary_specificity': 0.8172043, 'binary_f1_score': 0.8668684}
confusion matrix:
     0    1
0  532  119
1   57  573
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.82217574, 'precision': 0.82382476, 'recall': 0.81947297, 'specificity': 0.81947297, 'f1': 0.8205856, 'auroc': 0.91457176, 'binary_precision': 0.8111111, 'binary_recall': 0.8656126, 'binary_specificity': 0.7733333, 'binary_f1_score': 0.83747613}
confusion matrix:
     0    1
0  174   51
1   34  219
better model found
persisted
after epoch: 7,now: 2024-07-13 06:04:37.714640,epoch time: 0:10:42.977868,used: 1:14:38.943207,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_04_49_58_seed_1_21955591
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9931125, 'precision': 0.9505633, 'recall': 0.9782901, 'specificity': 0.9782901, 'f1': 0.9639622, 'auroc': 0.9989464, 'binary_precision': 0.99804026, 'binary_recall': 0.9947129, 'binary_specificity': 0.9618672, 'binary_f1_score': 0.99637383}
confusion matrix:
      0      1
0  1463     58
1   157  29538
---- Validation: 
scalar performance:
{'acc': 0.88602656, 'precision': 0.88762844, 'recall': 0.8855095, 'specificity': 0.8855095, 'f1': 0.88578427, 'auroc': 0.94134784, 'binary_precision': 0.9087838, 'binary_recall': 0.85396826, 'binary_specificity': 0.9170507, 'binary_f1_score': 0.88052374}
confusion matrix:
     0    1
0  597   54
1   92  538
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.86820084, 'precision': 0.8806534, 'recall': 0.8737725, 'specificity': 0.8737725, 'f1': 0.86794597, 'auroc': 0.9363549, 'binary_precision': 0.96568626, 'binary_recall': 0.7786561, 'binary_specificity': 0.9688889, 'binary_f1_score': 0.8621444}
confusion matrix:
     0    1
0  218    7
1   56  197
new oracle model saved
better model found
persisted
after epoch: 8,now: 2024-07-13 06:15:17.400210,epoch time: 0:10:39.685570,used: 1:25:18.628777,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_04_49_58_seed_1_21955591
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.99407357, 'precision': 0.9791019, 'recall': 0.95602703, 'specificity': 0.95602703, 'f1': 0.96724725, 'auroc': 0.9990661, 'binary_precision': 0.99559987, 'binary_recall': 0.9981815, 'binary_specificity': 0.9138725, 'binary_f1_score': 0.99688905}
confusion matrix:
      0      1
0  1390    131
1    54  29641
---- Validation: 
scalar performance:
{'acc': 0.8469945, 'precision': 0.85613406, 'recall': 0.8483103, 'specificity': 0.8483103, 'f1': 0.8463179, 'auroc': 0.94188976, 'binary_precision': 0.79483694, 'binary_recall': 0.9285714, 'binary_specificity': 0.7680492, 'binary_f1_score': 0.85651535}
confusion matrix:
     0    1
0  500  151
1   45  585
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8263598, 'precision': 0.8318317, 'recall': 0.8221959, 'specificity': 0.8221959, 'f1': 0.82385504, 'auroc': 0.9089855, 'binary_precision': 0.8014184, 'binary_recall': 0.8932806, 'binary_specificity': 0.7511111, 'binary_f1_score': 0.8448598}
confusion matrix:
     0    1
0  169   56
1   27  226
early stop counter: 1
val acc:0.8469945192337036, best validation acc: 0.8860265612602234, corresponding to test acc:                         0.8682008385658264 / 0.8682008385658264
after epoch: 9,now: 2024-07-13 06:25:56.287326,epoch time: 0:10:38.887116,used: 1:35:57.515893,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_04_49_58_seed_1_21955591
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.99413764, 'precision': 0.96116656, 'recall': 0.9769575, 'specificity': 0.9769575, 'f1': 0.9689132, 'auroc': 0.9992173, 'binary_precision': 0.99784076, 'binary_recall': 0.9959926, 'binary_specificity': 0.9579224, 'binary_f1_score': 0.9969158}
confusion matrix:
      0      1
0  1457     64
1   119  29576
---- Validation: 
scalar performance:
{'acc': 0.8594848, 'precision': 0.8605013, 'recall': 0.85993344, 'specificity': 0.85993344, 'f1': 0.85946, 'auroc': 0.92737424, 'binary_precision': 0.8368263, 'binary_recall': 0.88730156, 'binary_specificity': 0.8325653, 'binary_f1_score': 0.8613251}
confusion matrix:
     0    1
0  542  109
1   71  559
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8535565, 'precision': 0.8530437, 'recall': 0.854036, 'specificity': 0.854036, 'f1': 0.8532996, 'auroc': 0.91393936, 'binary_precision': 0.8734694, 'binary_recall': 0.8458498, 'binary_specificity': 0.8622222, 'binary_f1_score': 0.85943776}
confusion matrix:
     0    1
0  194   31
1   39  214
early stop counter: 2
val acc:0.8594847917556763, best validation acc: 0.8860265612602234, corresponding to test acc:                         0.8682008385658264 / 0.8682008385658264
after epoch: 10,now: 2024-07-13 06:36:34.111024,epoch time: 0:10:37.823698,used: 1:46:35.339591,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_04_49_58_seed_1_21955591
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.99359304, 'precision': 0.9824034, 'recall': 0.9473533, 'specificity': 0.9473533, 'f1': 0.96414316, 'auroc': 0.999156, 'binary_precision': 0.99469995, 'binary_recall': 0.99858564, 'binary_specificity': 0.89612097, 'binary_f1_score': 0.996639}
confusion matrix:
      0      1
0  1363    158
1    42  29653
---- Validation: 
scalar performance:
{'acc': 0.85714287, 'precision': 0.8695563, 'recall': 0.8586533, 'specificity': 0.8586533, 'f1': 0.856267, 'auroc': 0.9455271, 'binary_precision': 0.7976032, 'binary_recall': 0.9507936, 'binary_specificity': 0.76651305, 'binary_f1_score': 0.8674873}
confusion matrix:
     0    1
0  499  152
1   31  599
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.84309626, 'precision': 0.8509069, 'recall': 0.838498, 'specificity': 0.838498, 'f1': 0.8404987, 'auroc': 0.9255512, 'binary_precision': 0.8111888, 'binary_recall': 0.91699606, 'binary_specificity': 0.76, 'binary_f1_score': 0.86085343}
confusion matrix:
     0    1
0  171   54
1   21  232
early stop counter: 3
val acc:0.8571428656578064, best validation acc: 0.8860265612602234, corresponding to test acc:                         0.8682008385658264 / 0.8682008385658264
after epoch: 11,now: 2024-07-13 06:47:13.895869,epoch time: 0:10:39.784845,used: 1:57:15.124436,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_04_49_58_seed_1_21955591
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9941056, 'precision': 0.99066377, 'recall': 0.94512755, 'specificity': 0.94512755, 'f1': 0.96666485, 'auroc': 0.9993516, 'binary_precision': 0.9944376, 'binary_recall': 0.9993938, 'binary_specificity': 0.8908613, 'binary_f1_score': 0.99690956}
confusion matrix:
      0      1
0  1355    166
1    18  29677
---- Validation: 
scalar performance:
{'acc': 0.77517563, 'precision': 0.82530886, 'recall': 0.77836657, 'specificity': 0.77836657, 'f1': 0.7674831, 'auroc': 0.94700766, 'binary_precision': 0.6934389, 'binary_recall': 0.97301584, 'binary_specificity': 0.58371735, 'binary_f1_score': 0.80977535}
confusion matrix:
     0    1
0  380  271
1   17  613
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.77615064, 'precision': 0.8141426, 'recall': 0.7654194, 'specificity': 0.7654194, 'f1': 0.76387215, 'auroc': 0.93314004, 'binary_precision': 0.7185629, 'binary_recall': 0.9486166, 'binary_specificity': 0.5822222, 'binary_f1_score': 0.8177172}
confusion matrix:
     0    1
0  131   94
1   13  240
early stop counter: 4
val acc:0.7751756310462952, best validation acc: 0.8860265612602234, corresponding to test acc:                         0.8682008385658264 / 0.8682008385658264
after epoch: 12,now: 2024-07-13 06:57:59.135382,epoch time: 0:10:45.239513,used: 2:08:00.363949,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_04_49_58_seed_1_21955591
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.99391335, 'precision': 0.9908707, 'recall': 0.9428059, 'specificity': 0.9428059, 'f1': 0.96546435, 'auroc': 0.999398, 'binary_precision': 0.99420476, 'binary_recall': 0.99942756, 'binary_specificity': 0.8861842, 'binary_f1_score': 0.99680936}
confusion matrix:
      0      1
0  1347    173
1    17  29679
---- Validation: 
scalar performance:
{'acc': 0.8618267, 'precision': 0.8686806, 'recall': 0.8629544, 'specificity': 0.8629544, 'f1': 0.8614129, 'auroc': 0.94601953, 'binary_precision': 0.814147, 'binary_recall': 0.931746, 'binary_specificity': 0.7941628, 'binary_f1_score': 0.86898595}
confusion matrix:
     0    1
0  517  134
1   43  587
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.87447697, 'precision': 0.87394917, 'recall': 0.8742907, 'specificity': 0.8742907, 'f1': 0.8741045, 'auroc': 0.93429947, 'binary_precision': 0.8844622, 'binary_recall': 0.8774704, 'binary_specificity': 0.8711111, 'binary_f1_score': 0.88095236}
confusion matrix:
     0    1
0  196   29
1   31  222
new oracle model saved
early stop counter: 5
val acc:0.8618267178535461, best validation acc: 0.8860265612602234, corresponding to test acc:                         0.8682008385658264 / 0.874476969242096
after epoch: 13,now: 2024-07-13 07:08:39.701065,epoch time: 0:10:40.565683,used: 2:18:40.929632,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_04_49_58_seed_1_21955591
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9943298, 'precision': 0.95696187, 'recall': 0.9845354, 'specificity': 0.9845354, 'f1': 0.9702958, 'auroc': 0.9993478, 'binary_precision': 0.9986486, 'binary_recall': 0.9953866, 'binary_specificity': 0.9736842, 'binary_f1_score': 0.99701494}
confusion matrix:
      0      1
0  1480     40
1   137  29559
---- Validation: 
scalar performance:
{'acc': 0.8899298, 'precision': 0.89056945, 'recall': 0.88960576, 'specificity': 0.88960576, 'f1': 0.8897997, 'auroc': 0.9425621, 'binary_precision': 0.9028007, 'binary_recall': 0.8698413, 'binary_specificity': 0.9093702, 'binary_f1_score': 0.8860146}
confusion matrix:
     0    1
0  592   59
1   82  548
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8472803, 'precision': 0.85512125, 'recall': 0.85179627, 'specificity': 0.85179627, 'f1': 0.84716725, 'auroc': 0.9270971, 'binary_precision': 0.9245283, 'binary_recall': 0.77470356, 'binary_specificity': 0.9288889, 'binary_f1_score': 0.8430107}
confusion matrix:
     0    1
0  209   16
1   57  196
better model found
persisted
after epoch: 14,now: 2024-07-13 07:19:22.635302,epoch time: 0:10:42.934237,used: 2:29:23.863869,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_04_49_58_seed_1_21955591
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.99442595, 'precision': 0.96483564, 'recall': 0.9758468, 'specificity': 0.9758468, 'f1': 0.9702691, 'auroc': 0.9991077, 'binary_precision': 0.9977072, 'binary_recall': 0.9964305, 'binary_specificity': 0.95526314, 'binary_f1_score': 0.9970684}
confusion matrix:
      0      1
0  1452     68
1   106  29590
---- Validation: 
scalar performance:
{'acc': 0.84543324, 'precision': 0.847103, 'recall': 0.84600616, 'specificity': 0.84600616, 'f1': 0.8453646, 'auroc': 0.918499, 'binary_precision': 0.8185841, 'binary_recall': 0.88095236, 'binary_specificity': 0.8110599, 'binary_f1_score': 0.8486239}
confusion matrix:
     0    1
0  528  123
1   75  555
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.87447697, 'precision': 0.8774879, 'recall': 0.8774879, 'specificity': 0.8774879, 'f1': 0.874477, 'auroc': 0.9309618, 'binary_precision': 0.9288889, 'binary_recall': 0.82608694, 'binary_specificity': 0.9288889, 'binary_f1_score': 0.874477}
confusion matrix:
     0    1
0  209   16
1   44  209
early stop counter: 1
val acc:0.845433235168457, best validation acc: 0.8899297714233398, corresponding to test acc:                         0.8472803235054016 / 0.874476969242096
after epoch: 15,now: 2024-07-13 07:30:02.032687,epoch time: 0:10:39.397385,used: 2:40:03.261254,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_04_49_58_seed_1_21955591
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9928562, 'precision': 0.9409261, 'recall': 0.98875976, 'specificity': 0.98875976, 'f1': 0.9634574, 'auroc': 0.99949324, 'binary_precision': 0.999187, 'binary_recall': 0.99329853, 'binary_specificity': 0.9842209, 'binary_f1_score': 0.99623406}
confusion matrix:
      0      1
0  1497     24
1   199  29496
---- Validation: 
scalar performance:
{'acc': 0.88758785, 'precision': 0.8888956, 'recall': 0.8871224, 'specificity': 0.8871224, 'f1': 0.88738024, 'auroc': 0.9395094, 'binary_precision': 0.9077181, 'binary_recall': 0.85873014, 'binary_specificity': 0.9155146, 'binary_f1_score': 0.8825449}
confusion matrix:
     0    1
0  596   55
1   89  541
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.83682007, 'precision': 0.85286415, 'recall': 0.84314454, 'specificity': 0.84314454, 'f1': 0.83625823, 'auroc': 0.9216864, 'binary_precision': 0.9441624, 'binary_recall': 0.7351779, 'binary_specificity': 0.95111114, 'binary_f1_score': 0.82666665}
confusion matrix:
     0    1
0  214   11
1   67  186
early stop counter: 2
val acc:0.88758784532547, best validation acc: 0.8899297714233398, corresponding to test acc:                         0.8472803235054016 / 0.874476969242096
after epoch: 16,now: 2024-07-13 07:40:38.951638,epoch time: 0:10:36.918951,used: 2:50:40.180205,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_04_49_58_seed_1_21955591
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9955792, 'precision': 0.9849803, 'recall': 0.96677756, 'specificity': 0.96677756, 'f1': 0.975685, 'auroc': 0.99940324, 'binary_precision': 0.9966729, 'binary_recall': 0.9986867, 'binary_specificity': 0.9348684, 'binary_f1_score': 0.99767876}
confusion matrix:
      0      1
0  1421     99
1    39  29657
---- Validation: 
scalar performance:
{'acc': 0.7509758, 'precision': 0.81497467, 'recall': 0.7546339, 'specificity': 0.7546339, 'f1': 0.73939854, 'auroc': 0.9451119, 'binary_precision': 0.6688382, 'binary_recall': 0.9777778, 'binary_specificity': 0.53149, 'binary_f1_score': 0.79432625}
confusion matrix:
     0    1
0  346  305
1   14  616
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7343096, 'precision': 0.7921555, 'recall': 0.72048306, 'specificity': 0.72048306, 'f1': 0.712014, 'auroc': 0.93076855, 'binary_precision': 0.67597765, 'binary_recall': 0.95652175, 'binary_specificity': 0.48444444, 'binary_f1_score': 0.792144}
confusion matrix:
     0    1
0  109  116
1   11  242
early stop counter: 3
val acc:0.7509757876396179, best validation acc: 0.8899297714233398, corresponding to test acc:                         0.8472803235054016 / 0.874476969242096
after epoch: 17,now: 2024-07-13 07:51:21.990534,epoch time: 0:10:43.038896,used: 3:01:23.219101,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_04_49_58_seed_1_21955591
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.99589956, 'precision': 0.97872686, 'recall': 0.9769335, 'specificity': 0.9769335, 'f1': 0.97782826, 'auroc': 0.9994705, 'binary_precision': 0.99774426, 'binary_recall': 0.99794585, 'binary_specificity': 0.95592105, 'binary_f1_score': 0.99784505}
confusion matrix:
      0      1
0  1453     67
1    61  29635
---- Validation: 
scalar performance:
{'acc': 0.8399688, 'precision': 0.86014867, 'recall': 0.8419099, 'specificity': 0.8419099, 'f1': 0.8381983, 'auroc': 0.9504029, 'binary_precision': 0.77070063, 'binary_recall': 0.96031743, 'binary_specificity': 0.7235023, 'binary_f1_score': 0.85512364}
confusion matrix:
     0    1
0  471  180
1   25  605
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.84518826, 'precision': 0.85565174, 'recall': 0.8399824, 'specificity': 0.8399824, 'f1': 0.8421794, 'auroc': 0.94194114, 'binary_precision': 0.80756015, 'binary_recall': 0.92885375, 'binary_specificity': 0.7511111, 'binary_f1_score': 0.8639706}
confusion matrix:
     0    1
0  169   56
1   18  235
early stop counter: 4
val acc:0.8399688005447388, best validation acc: 0.8899297714233398, corresponding to test acc:                         0.8472803235054016 / 0.874476969242096
after epoch: 18,now: 2024-07-13 08:02:05.140609,epoch time: 0:10:43.150075,used: 3:12:06.369176,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_04_49_58_seed_1_21955591
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9902614, 'precision': 0.99029076, 'recall': 0.9037453, 'specificity': 0.9037453, 'f1': 0.94238025, 'auroc': 0.99942327, 'binary_precision': 0.9902589, 'binary_recall': 0.9995959, 'binary_specificity': 0.80789477, 'binary_f1_score': 0.9949054}
confusion matrix:
      0      1
0  1228    292
1    12  29684
---- Validation: 
scalar performance:
{'acc': 0.64480877, 'precision': 0.7720582, 'recall': 0.6503328, 'specificity': 0.6503328, 'f1': 0.60248244, 'auroc': 0.9383646, 'binary_precision': 0.5818522, 'binary_recall': 0.9873016, 'binary_specificity': 0.31336406, 'binary_f1_score': 0.73219544}
confusion matrix:
     0    1
0  204  447
1    8  622
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.58995813, 'precision': 0.76575017, 'recall': 0.5646904, 'specificity': 0.5646904, 'f1': 0.47718745, 'auroc': 0.93148875, 'binary_precision': 0.5637584, 'binary_recall': 0.99604744, 'binary_specificity': 0.13333334, 'binary_f1_score': 0.7199999}
confusion matrix:
    0    1
0  30  195
1   1  252
early stop counter: 5
val acc:0.6448087692260742, best validation acc: 0.8899297714233398, corresponding to test acc:                         0.8472803235054016 / 0.874476969242096
after epoch: 19,now: 2024-07-13 08:12:51.189868,epoch time: 0:10:46.049259,used: 3:22:52.418435,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_04_49_58_seed_1_21955591
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.99426574, 'precision': 0.9533709, 'recall': 0.9885649, 'specificity': 0.9885649, 'f1': 0.9702296, 'auroc': 0.9995264, 'binary_precision': 0.9990869, 'binary_recall': 0.9948813, 'binary_specificity': 0.98224854, 'binary_f1_score': 0.9969796}
confusion matrix:
      0      1
0  1494     27
1   152  29543
---- Validation: 
scalar performance:
{'acc': 0.89461356, 'precision': 0.89688325, 'recall': 0.89400923, 'specificity': 0.89400923, 'f1': 0.8943331, 'auroc': 0.9480872, 'binary_precision': 0.9230769, 'binary_recall': 0.85714287, 'binary_specificity': 0.9308756, 'binary_f1_score': 0.8888889}
confusion matrix:
     0    1
0  606   45
1   90  540
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.832636, 'precision': 0.85922015, 'recall': 0.84066755, 'specificity': 0.84066755, 'f1': 0.8313338, 'auroc': 0.93336844, 'binary_precision': 0.9726776, 'binary_recall': 0.7035573, 'binary_specificity': 0.9777778, 'binary_f1_score': 0.8165138}
confusion matrix:
     0    1
0  220    5
1   75  178
better model found
persisted
after epoch: 20,now: 2024-07-13 08:23:29.499336,epoch time: 0:10:38.309468,used: 3:33:30.727903,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_04_49_58_seed_1_21955591
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9928242, 'precision': 0.9429897, 'recall': 0.9853121, 'specificity': 0.9853121, 'f1': 0.9630655, 'auroc': 0.99942195, 'binary_precision': 0.9988152, 'binary_recall': 0.9936353, 'binary_specificity': 0.97698885, 'binary_f1_score': 0.99621856}
confusion matrix:
      0      1
0  1486     35
1   189  29506
---- Validation: 
scalar performance:
{'acc': 0.89461356, 'precision': 0.8950741, 'recall': 0.89434206, 'specificity': 0.89434206, 'f1': 0.8945107, 'auroc': 0.9432814, 'binary_precision': 0.90507364, 'binary_recall': 0.87777776, 'binary_specificity': 0.9109063, 'binary_f1_score': 0.8912167}
confusion matrix:
     0    1
0  593   58
1   77  553
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8702929, 'precision': 0.87617636, 'recall': 0.8742732, 'specificity': 0.8742732, 'f1': 0.87025654, 'auroc': 0.93614405, 'binary_precision': 0.94009215, 'binary_recall': 0.8063241, 'binary_specificity': 0.94222224, 'binary_f1_score': 0.8680851}
confusion matrix:
     0    1
0  212   13
1   49  204
early stop counter: 1
val acc:0.8946135640144348, best validation acc: 0.8946135640144348, corresponding to test acc:                         0.8326359987258911 / 0.874476969242096
after epoch: 21,now: 2024-07-13 08:34:08.551133,epoch time: 0:10:39.051797,used: 3:44:09.779700,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_04_49_58_seed_1_21955591
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9965082, 'precision': 0.9824725, 'recall': 0.979763, 'specificity': 0.979763, 'f1': 0.9811135, 'auroc': 0.99969363, 'binary_precision': 0.99801373, 'binary_recall': 0.9983162, 'binary_specificity': 0.9612097, 'binary_f1_score': 0.99816495}
confusion matrix:
      0      1
0  1462     59
1    50  29645
---- Validation: 
scalar performance:
{'acc': 0.8852459, 'precision': 0.8883061, 'recall': 0.88599586, 'specificity': 0.88599586, 'f1': 0.8851339, 'auroc': 0.9480262, 'binary_precision': 0.8494935, 'binary_recall': 0.931746, 'binary_specificity': 0.8402458, 'binary_f1_score': 0.8887207}
confusion matrix:
     0    1
0  547  104
1   43  587
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9121339, 'precision': 0.9121339, 'recall': 0.9135529, 'specificity': 0.9135529, 'f1': 0.9120585, 'auroc': 0.9471761, 'binary_precision': 0.9414226, 'binary_recall': 0.88932806, 'binary_specificity': 0.93777776, 'binary_f1_score': 0.9146341}
confusion matrix:
     0    1
0  211   14
1   28  225
new oracle model saved
early stop counter: 2
val acc:0.8852459192276001, best validation acc: 0.8946135640144348, corresponding to test acc:                         0.8326359987258911 / 0.9121338725090027
after epoch: 22,now: 2024-07-13 08:44:55.183356,epoch time: 0:10:46.632223,used: 3:54:56.411923,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_04_49_58_seed_1_21955591
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.9949705, 'precision': 0.96271646, 'recall': 0.98488075, 'specificity': 0.98488075, 'f1': 0.9735082, 'auroc': 0.99960524, 'binary_precision': 0.9986495, 'binary_recall': 0.99605995, 'binary_specificity': 0.97370154, 'binary_f1_score': 0.997353}
confusion matrix:
      0      1
0  1481     40
1   117  29578
---- Validation: 
scalar performance:
{'acc': 0.9078845, 'precision': 0.90784323, 'recall': 0.9079109, 'specificity': 0.9079109, 'f1': 0.90786827, 'auroc': 0.95316124, 'binary_precision': 0.90378547, 'binary_recall': 0.9095238, 'binary_specificity': 0.906298, 'binary_f1_score': 0.9066456}
confusion matrix:
     0    1
0  590   61
1   57  573
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9121339, 'precision': 0.9127397, 'recall': 0.9140448, 'specificity': 0.9140448, 'f1': 0.9120954, 'auroc': 0.95342994, 'binary_precision': 0.94893616, 'binary_recall': 0.88142294, 'binary_specificity': 0.94666666, 'binary_f1_score': 0.9139344}
confusion matrix:
     0    1
0  213   12
1   30  223
better model found
persisted
after epoch: 23,now: 2024-07-13 08:55:41.198131,epoch time: 0:10:46.014775,used: 4:05:42.426698,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_04_49_58_seed_1_21955591
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9942017, 'precision': 0.975065, 'recall': 0.9617084, 'specificity': 0.9617084, 'f1': 0.96828043, 'auroc': 0.999256, 'binary_precision': 0.9962004, 'binary_recall': 0.99771005, 'binary_specificity': 0.92570674, 'binary_f1_score': 0.9969546}
confusion matrix:
      0      1
0  1408    113
1    68  29627
---- Validation: 
scalar performance:
{'acc': 0.8813427, 'precision': 0.88386214, 'recall': 0.8820276, 'specificity': 0.8820276, 'f1': 0.881254, 'auroc': 0.9389803, 'binary_precision': 0.8483965, 'binary_recall': 0.9238095, 'binary_specificity': 0.8402458, 'binary_f1_score': 0.8844984}
confusion matrix:
     0    1
0  547  104
1   48  582
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.88912135, 'precision': 0.8903285, 'recall': 0.8873869, 'specificity': 0.8873869, 'f1': 0.88837826, 'auroc': 0.9287835, 'binary_precision': 0.8787879, 'binary_recall': 0.91699606, 'binary_specificity': 0.8577778, 'binary_f1_score': 0.8974855}
confusion matrix:
     0    1
0  193   32
1   21  232
early stop counter: 1
val acc:0.8813427090644836, best validation acc: 0.9078844785690308, corresponding to test acc:                         0.9121338725090027 / 0.9121338725090027
after epoch: 24,now: 2024-07-13 09:06:20.023042,epoch time: 0:10:38.824911,used: 4:16:21.251609,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_04_49_58_seed_1_21955591
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.9955472, 'precision': 0.9736147, 'recall': 0.978634, 'specificity': 0.978634, 'f1': 0.97610956, 'auroc': 0.99945325, 'binary_precision': 0.9979446, 'binary_recall': 0.9973733, 'binary_specificity': 0.9598948, 'binary_f1_score': 0.99765885}
confusion matrix:
      0      1
0  1460     61
1    78  29617
---- Validation: 
scalar performance:
{'acc': 0.9047619, 'precision': 0.90478337, 'recall': 0.90488994, 'specificity': 0.90488994, 'f1': 0.90475726, 'auroc': 0.95226145, 'binary_precision': 0.89563864, 'binary_recall': 0.9126984, 'binary_specificity': 0.89708143, 'binary_f1_score': 0.9040881}
confusion matrix:
     0    1
0  584   67
1   55  575
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.91422594, 'precision': 0.91502035, 'recall': 0.91626704, 'specificity': 0.91626704, 'f1': 0.91419554, 'auroc': 0.9515854, 'binary_precision': 0.9529914, 'binary_recall': 0.88142294, 'binary_specificity': 0.95111114, 'binary_f1_score': 0.9158111}
confusion matrix:
     0    1
0  214   11
1   30  223
new oracle model saved
early stop counter: 2
val acc:0.9047619104385376, best validation acc: 0.9078844785690308, corresponding to test acc:                         0.9121338725090027 / 0.9142259359359741
after epoch: 25,now: 2024-07-13 09:17:05.988266,epoch time: 0:10:45.965224,used: 4:27:07.216833,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_04_49_58_seed_1_21955591
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9967645, 'precision': 0.9826939, 'recall': 0.9823928, 'specificity': 0.9823928, 'f1': 0.98254335, 'auroc': 0.99965185, 'binary_precision': 0.9982826, 'binary_recall': 0.9983162, 'binary_specificity': 0.9664694, 'binary_f1_score': 0.9982994}
confusion matrix:
      0      1
0  1470     51
1    50  29645
---- Validation: 
scalar performance:
{'acc': 0.88056207, 'precision': 0.8824365, 'recall': 0.88115716, 'specificity': 0.88115716, 'f1': 0.88050497, 'auroc': 0.94321066, 'binary_precision': 0.85125184, 'binary_recall': 0.9174603, 'binary_specificity': 0.84485406, 'binary_f1_score': 0.88311684}
confusion matrix:
     0    1
0  550  101
1   52  578
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8702929, 'precision': 0.87305915, 'recall': 0.86763287, 'specificity': 0.86763287, 'f1': 0.8690804, 'auroc': 0.9127448, 'binary_precision': 0.8523985, 'binary_recall': 0.9130435, 'binary_specificity': 0.82222223, 'binary_f1_score': 0.8816794}
confusion matrix:
     0    1
0  185   40
1   22  231
early stop counter: 3
val acc:0.8805620670318604, best validation acc: 0.9078844785690308, corresponding to test acc:                         0.9121338725090027 / 0.9142259359359741
after epoch: 26,now: 2024-07-13 09:27:52.461077,epoch time: 0:10:46.472811,used: 4:37:53.689644,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_04_49_58_seed_1_21955591
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.99625194, 'precision': 0.98166466, 'recall': 0.9777569, 'specificity': 0.9777569, 'f1': 0.9797019, 'auroc': 0.9995849, 'binary_precision': 0.99781203, 'binary_recall': 0.9982489, 'binary_specificity': 0.95726496, 'binary_f1_score': 0.9980304}
confusion matrix:
      0      1
0  1456     65
1    52  29643
---- Validation: 
scalar performance:
{'acc': 0.8844653, 'precision': 0.8872027, 'recall': 0.88517666, 'specificity': 0.88517666, 'f1': 0.8843688, 'auroc': 0.94821155, 'binary_precision': 0.8502907, 'binary_recall': 0.9285714, 'binary_specificity': 0.84178185, 'binary_f1_score': 0.88770866}
confusion matrix:
     0    1
0  548  103
1   45  585
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8870293, 'precision': 0.8870187, 'recall': 0.88614845, 'specificity': 0.88614845, 'f1': 0.8865207, 'auroc': 0.93935883, 'binary_precision': 0.8871595, 'binary_recall': 0.90118575, 'binary_specificity': 0.8711111, 'binary_f1_score': 0.8941176}
confusion matrix:
     0    1
0  196   29
1   25  228
early stop counter: 4
val acc:0.8844652771949768, best validation acc: 0.9078844785690308, corresponding to test acc:                         0.9121338725090027 / 0.9142259359359741
after epoch: 27,now: 2024-07-13 09:38:44.008914,epoch time: 0:10:51.547837,used: 4:48:45.237481,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_04_49_58_seed_1_21955591
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.9955472, 'precision': 0.99427027, 'recall': 0.9574253, 'specificity': 0.9574253, 'f1': 0.97505516, 'auroc': 0.9996366, 'binary_precision': 0.9956732, 'binary_recall': 0.99966323, 'binary_specificity': 0.91518736, 'binary_f1_score': 0.9976642}
confusion matrix:
      0      1
0  1392    129
1    10  29685
---- Validation: 
scalar performance:
{'acc': 0.82201403, 'precision': 0.8499098, 'recall': 0.82432157, 'specificity': 0.82432157, 'f1': 0.8190849, 'auroc': 0.9462975, 'binary_precision': 0.74692875, 'binary_recall': 0.96507937, 'binary_specificity': 0.68356377, 'binary_f1_score': 0.84210527}
confusion matrix:
     0    1
0  445  206
1   22  608
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.82217574, 'precision': 0.83793646, 'recall': 0.815538, 'specificity': 0.815538, 'f1': 0.81743836, 'auroc': 0.91797984, 'binary_precision': 0.7781457, 'binary_recall': 0.92885375, 'binary_specificity': 0.7022222, 'binary_f1_score': 0.8468468}
confusion matrix:
     0    1
0  158   67
1   18  235
early stop counter: 5
val acc:0.8220140337944031, best validation acc: 0.9078844785690308, corresponding to test acc:                         0.9121338725090027 / 0.9142259359359741
after epoch: 28,now: 2024-07-13 09:49:27.806151,epoch time: 0:10:43.797237,used: 4:59:29.034718,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_04_49_58_seed_1_21955591
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9964441, 'precision': 0.9789528, 'recall': 0.9828377, 'specificity': 0.9828377, 'f1': 0.9808865, 'auroc': 0.9996574, 'binary_precision': 0.99834925, 'binary_recall': 0.99791217, 'binary_specificity': 0.9677632, 'binary_f1_score': 0.9981307}
confusion matrix:
      0      1
0  1471     49
1    62  29634
---- Validation: 
scalar performance:
{'acc': 0.8985168, 'precision': 0.89866745, 'recall': 0.8987199, 'specificity': 0.8987199, 'f1': 0.8985162, 'auroc': 0.9492502, 'binary_precision': 0.88580245, 'binary_recall': 0.9111111, 'binary_specificity': 0.8863287, 'binary_f1_score': 0.89827853}
confusion matrix:
     0    1
0  577   74
1   56  574
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8619247, 'precision': 0.86219513, 'recall': 0.8634168, 'specificity': 0.8634168, 'f1': 0.8618376, 'auroc': 0.91539747, 'binary_precision': 0.89451474, 'binary_recall': 0.8379447, 'binary_specificity': 0.8888889, 'binary_f1_score': 0.8653061}
confusion matrix:
     0    1
0  200   25
1   41  212
early stop counter: 6
val acc:0.8985167741775513, best validation acc: 0.9078844785690308, corresponding to test acc:                         0.9121338725090027 / 0.9142259359359741
after epoch: 29,now: 2024-07-13 10:00:14.298340,epoch time: 0:10:46.492189,used: 5:10:15.526907,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_04_49_58_seed_1_21955591
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.99589956, 'precision': 0.9896077, 'recall': 0.9657197, 'specificity': 0.9657197, 'f1': 0.97733134, 'auroc': 0.9996161, 'binary_precision': 0.9965405, 'binary_recall': 0.9991581, 'binary_specificity': 0.9322814, 'binary_f1_score': 0.99784756}
confusion matrix:
      0      1
0  1418    103
1    25  29670
---- Validation: 
scalar performance:
{'acc': 0.85323966, 'precision': 0.8636714, 'recall': 0.8546339, 'specificity': 0.8546339, 'f1': 0.8524953, 'auroc': 0.9490423, 'binary_precision': 0.7978437, 'binary_recall': 0.93968254, 'binary_specificity': 0.76958525, 'binary_f1_score': 0.8629738}
confusion matrix:
     0    1
0  501  150
1   38  592
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8786611, 'precision': 0.87954724, 'recall': 0.87701356, 'specificity': 0.87701356, 'f1': 0.87788934, 'auroc': 0.9284673, 'binary_precision': 0.8707224, 'binary_recall': 0.9051383, 'binary_specificity': 0.8488889, 'binary_f1_score': 0.88759685}
confusion matrix:
     0    1
0  191   34
1   24  229
early stop counter: 7
val acc:0.8532396554946899, best validation acc: 0.9078844785690308, corresponding to test acc:                         0.9121338725090027 / 0.9142259359359741
after epoch: 30,now: 2024-07-13 10:11:09.480174,epoch time: 0:10:55.181834,used: 5:21:10.708741,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_04_49_58_seed_1_21955591
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 5:21:10.708741 at 2024-07-13 10:11:09.480174
persisted model performance metric: 

scalar performance:
{'acc': 0.9121339, 'precision': 0.9127397, 'recall': 0.9140448, 'specificity': 0.9140448, 'f1': 0.9120954, 'auroc': 0.95342994, 'binary_precision': 0.94893616, 'binary_recall': 0.88142294, 'binary_specificity': 0.94666666, 'binary_f1_score': 0.9139344}
confusion matrix:
     0    1
0  213   12
1   30  223
oracle model performance metric: 

scalar performance:
{'acc': 0.91422594, 'precision': 0.91502035, 'recall': 0.91626704, 'specificity': 0.91626704, 'f1': 0.91419554, 'auroc': 0.9515854, 'binary_precision': 0.9529914, 'binary_recall': 0.88142294, 'binary_specificity': 0.95111114, 'binary_f1_score': 0.9158111}
confusion matrix:
     0    1
0  214   11
1   30  223
results aggregation path: zoutput/benchmarks/CAMELYONWILD_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_halffreeze/rule_results/4.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONWILD_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_halffreeze/confusion_matrix/4.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 318521 KiB |   6782 MiB | 580994 GiB | 580994 GiB |
|       from large pool | 291339 KiB |   6756 MiB | 571695 GiB | 571695 GiB |
|       from small pool |  27182 KiB |     43 MiB |   9298 GiB |   9298 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 318521 KiB |   6782 MiB | 580994 GiB | 580994 GiB |
|       from large pool | 291339 KiB |   6756 MiB | 571695 GiB | 571695 GiB |
|       from small pool |  27182 KiB |     43 MiB |   9298 GiB |   9298 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 313851 KiB |   6778 MiB | 579893 GiB | 579893 GiB |
|       from large pool | 286862 KiB |   6752 MiB | 570615 GiB | 570615 GiB |
|       from small pool |  26989 KiB |     43 MiB |   9277 GiB |   9277 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   7456 MiB |   7456 MiB |  14316 MiB |   6860 MiB |
|       from large pool |   7404 MiB |   7404 MiB |  14248 MiB |   6844 MiB |
|       from small pool |     52 MiB |     52 MiB |     68 MiB |     16 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 285638 KiB | 680184 KiB | 453948 GiB | 453948 GiB |
|       from large pool | 275957 KiB | 675647 KiB | 444637 GiB | 444637 GiB |
|       from small pool |   9681 KiB |  28451 KiB |   9310 GiB |   9310 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    1058    |    4649    |  118421 K  |  118420 K  |
|       from large pool |     130    |     756    |   53912 K  |   53912 K  |
|       from small pool |     928    |    4517    |   64508 K  |   64507 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    1058    |    4649    |  118421 K  |  118420 K  |
|       from large pool |     130    |     756    |   53912 K  |   53912 K  |
|       from small pool |     928    |    4517    |   64508 K  |   64507 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     335    |     335    |     627    |     292    |
|       from large pool |     309    |     309    |     593    |     284    |
|       from small pool |      26    |      26    |      34    |       8    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      74    |    1997    |   70791 K  |   70791 K  |
|       from large pool |      27    |     307    |   41575 K  |   41575 K  |
|       from small pool |      47    |    1971    |   29216 K  |   29216 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   6782 MiB | 580994 GiB | 580994 GiB |
|       from large pool |  16640 KiB |   6756 MiB | 571695 GiB | 571695 GiB |
|       from small pool |      0 KiB |     43 MiB |   9298 GiB |   9298 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   6782 MiB | 580994 GiB | 580994 GiB |
|       from large pool |  16640 KiB |   6756 MiB | 571695 GiB | 571695 GiB |
|       from small pool |      0 KiB |     43 MiB |   9298 GiB |   9298 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   6778 MiB | 579893 GiB | 579893 GiB |
|       from large pool |  16640 KiB |   6752 MiB | 570615 GiB | 570615 GiB |
|       from small pool |      0 KiB |     43 MiB |   9277 GiB |   9277 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 604160 KiB |   7456 MiB |  14316 MiB |  13726 MiB |
|       from large pool | 567296 KiB |   7404 MiB |  14248 MiB |  13694 MiB |
|       from small pool |  36864 KiB |     52 MiB |     68 MiB |     32 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 680184 KiB | 453948 GiB | 453948 GiB |
|       from large pool |  24320 KiB | 675647 KiB | 444638 GiB | 444638 GiB |
|       from small pool |      0 KiB |  30502 KiB |   9310 GiB |   9310 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    4649    |  118421 K  |  118421 K  |
|       from large pool |       2    |     756    |   53912 K  |   53912 K  |
|       from small pool |       0    |    4517    |   64508 K  |   64508 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    4649    |  118421 K  |  118421 K  |
|       from large pool |       2    |     756    |   53912 K  |   53912 K  |
|       from small pool |       0    |    4517    |   64508 K  |   64508 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      43    |     335    |     627    |     584    |
|       from large pool |      25    |     309    |     593    |     568    |
|       from small pool |      18    |      26    |      34    |      16    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    1997    |   70791 K  |   70791 K  |
|       from large pool |       3    |     307    |   41575 K  |   41575 K  |
|       from small pool |       0    |    1971    |   29216 K  |   29216 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   6782 MiB | 580994 GiB | 580994 GiB |
|       from large pool |  16640 KiB |   6756 MiB | 571695 GiB | 571695 GiB |
|       from small pool |      0 KiB |     43 MiB |   9298 GiB |   9298 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   6782 MiB | 580994 GiB | 580994 GiB |
|       from large pool |  16640 KiB |   6756 MiB | 571695 GiB | 571695 GiB |
|       from small pool |      0 KiB |     43 MiB |   9298 GiB |   9298 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   6778 MiB | 579893 GiB | 579893 GiB |
|       from large pool |  16640 KiB |   6752 MiB | 570615 GiB | 570615 GiB |
|       from small pool |      0 KiB |     43 MiB |   9277 GiB |   9277 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 604160 KiB |   7456 MiB |  14316 MiB |  13726 MiB |
|       from large pool | 567296 KiB |   7404 MiB |  14248 MiB |  13694 MiB |
|       from small pool |  36864 KiB |     52 MiB |     68 MiB |     32 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 680184 KiB | 453948 GiB | 453948 GiB |
|       from large pool |  24320 KiB | 675647 KiB | 444638 GiB | 444638 GiB |
|       from small pool |      0 KiB |  30502 KiB |   9310 GiB |   9310 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    4649    |  118421 K  |  118421 K  |
|       from large pool |       2    |     756    |   53912 K  |   53912 K  |
|       from small pool |       0    |    4517    |   64508 K  |   64508 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    4649    |  118421 K  |  118421 K  |
|       from large pool |       2    |     756    |   53912 K  |   53912 K  |
|       from small pool |       0    |    4517    |   64508 K  |   64508 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      43    |     335    |     627    |     584    |
|       from large pool |      25    |     309    |     593    |     568    |
|       from small pool |      18    |      26    |      34    |      16    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    1997    |   70791 K  |   70791 K  |
|       from large pool |       3    |     307    |   41575 K  |   41575 K  |
|       from small pool |       0    |    1971    |   29216 K  |   29216 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_10_26_13_seed_2_21955591

 Experiment start at: 2024-07-13 10:26:13.481886
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
before training, model accuracy: 0.3810526132583618
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9824069, 'precision': 0.9196173, 'recall': 0.8821214, 'specificity': 0.8821214, 'f1': 0.8998877, 'auroc': 0.992857, 'binary_precision': 0.9884341, 'binary_recall': 0.9931346, 'binary_specificity': 0.77110815, 'binary_f1_score': 0.99077874}
confusion matrix:
      0      1
0  1169    347
1   205  29655
---- Validation: 
scalar performance:
{'acc': 0.63302034, 'precision': 0.75946534, 'recall': 0.6420722, 'specificity': 0.6420722, 'f1': 0.5902264, 'auroc': 0.90854144, 'binary_precision': 0.57156223, 'binary_recall': 0.9823151, 'binary_specificity': 0.30182928, 'binary_f1_score': 0.72264934}
confusion matrix:
     0    1
0  198  458
1   11  611
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.63578945, 'precision': 0.7614919, 'recall': 0.6010743, 'specificity': 0.6010743, 'f1': 0.5493828, 'auroc': 0.9132526, 'binary_precision': 0.6014151, 'binary_recall': 0.98455596, 'binary_specificity': 0.2175926, 'binary_f1_score': 0.7467057}
confusion matrix:
    0    1
0  47  169
1   4  255
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-13 10:37:20.279348,epoch time: 0:11:06.797462,used: 0:11:06.797462,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_10_26_13_seed_2_21955591
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9841599, 'precision': 0.96309984, 'recall': 0.85768366, 'specificity': 0.85768366, 'f1': 0.90289706, 'auroc': 0.993935, 'binary_precision': 0.98583674, 'binary_recall': 0.9976892, 'binary_specificity': 0.7176781, 'binary_f1_score': 0.99172753}
confusion matrix:
      0      1
0  1088    428
1    69  29791
---- Validation: 
scalar performance:
{'acc': 0.6690141, 'precision': 0.76892287, 'recall': 0.6769248, 'specificity': 0.6769248, 'f1': 0.6410005, 'auroc': 0.924898, 'binary_precision': 0.5982231, 'binary_recall': 0.97427654, 'binary_specificity': 0.37957317, 'binary_f1_score': 0.7412844}
confusion matrix:
     0    1
0  249  407
1   16  606
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6757895, 'precision': 0.7697368, 'recall': 0.6462087, 'specificity': 0.6462087, 'f1': 0.6192801, 'auroc': 0.92967975, 'binary_precision': 0.6315789, 'binary_recall': 0.972973, 'binary_specificity': 0.31944445, 'binary_f1_score': 0.7659574}
confusion matrix:
    0    1
0  69  147
1   7  252
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-07-13 10:48:26.519387,epoch time: 0:11:06.240039,used: 0:22:13.037501,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_10_26_13_seed_2_21955591
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9882713, 'precision': 0.9153009, 'recall': 0.96847916, 'specificity': 0.96847916, 'f1': 0.9400831, 'auroc': 0.9976079, 'binary_precision': 0.9972685, 'binary_recall': 0.99038845, 'binary_specificity': 0.9465699, 'binary_f1_score': 0.99381655}
confusion matrix:
      0      1
0  1435     81
1   287  29573
---- Validation: 
scalar performance:
{'acc': 0.8325509, 'precision': 0.8413683, 'recall': 0.8346821, 'specificity': 0.8346821, 'f1': 0.83198756, 'auroc': 0.9211974, 'binary_precision': 0.779452, 'binary_recall': 0.914791, 'binary_specificity': 0.75457317, 'binary_f1_score': 0.841716}
confusion matrix:
     0    1
0  495  161
1   53  569
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.82736844, 'precision': 0.8295205, 'recall': 0.82209885, 'specificity': 0.82209885, 'f1': 0.8242773, 'auroc': 0.92322683, 'binary_precision': 0.8172043, 'binary_recall': 0.88030887, 'binary_specificity': 0.7638889, 'binary_f1_score': 0.84758365}
confusion matrix:
     0    1
0  165   51
1   31  228
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-07-13 10:59:20.393049,epoch time: 0:10:53.873662,used: 0:33:06.911163,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_10_26_13_seed_2_21955591
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9904386, 'precision': 0.9654521, 'recall': 0.92797947, 'specificity': 0.92797947, 'f1': 0.9458407, 'auroc': 0.9975322, 'binary_precision': 0.99286383, 'binary_recall': 0.9971199, 'binary_specificity': 0.85883904, 'binary_f1_score': 0.9949873}
confusion matrix:
      0      1
0  1302    214
1    86  29774
---- Validation: 
scalar performance:
{'acc': 0.7707355, 'precision': 0.81315434, 'recall': 0.7755519, 'specificity': 0.7755519, 'f1': 0.7646806, 'auroc': 0.9228958, 'binary_precision': 0.6910569, 'binary_recall': 0.95659167, 'binary_specificity': 0.5945122, 'binary_f1_score': 0.8024275}
confusion matrix:
     0    1
0  390  266
1   27  595
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7726316, 'precision': 0.7996732, 'recall': 0.7573019, 'specificity': 0.7573019, 'f1': 0.75899196, 'auroc': 0.9187938, 'binary_precision': 0.7294833, 'binary_recall': 0.9266409, 'binary_specificity': 0.587963, 'binary_f1_score': 0.8163265}
confusion matrix:
     0    1
0  127   89
1   19  240
early stop counter: 1
val acc:0.770735502243042, best validation acc: 0.8325508832931519, corresponding to test acc:                         0.827368438243866 / 0.827368438243866
after epoch: 4,now: 2024-07-13 11:10:20.537860,epoch time: 0:11:00.144811,used: 0:44:07.055974,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_10_26_13_seed_2_21955591
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9914903, 'precision': 0.96497726, 'recall': 0.9407418, 'specificity': 0.9407418, 'f1': 0.9524981, 'auroc': 0.9981282, 'binary_precision': 0.9941556, 'binary_recall': 0.996919, 'binary_specificity': 0.88456464, 'binary_f1_score': 0.9955354}
confusion matrix:
      0      1
0  1341    175
1    92  29768
---- Validation: 
scalar performance:
{'acc': 0.7629108, 'precision': 0.8019037, 'recall': 0.7675966, 'specificity': 0.7675966, 'f1': 0.75701946, 'auroc': 0.90472806, 'binary_precision': 0.6865497, 'binary_recall': 0.9437299, 'binary_specificity': 0.5914634, 'binary_f1_score': 0.7948545}
confusion matrix:
     0    1
0  388  268
1   35  587
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7768421, 'precision': 0.7947131, 'recall': 0.7638532, 'specificity': 0.7638532, 'f1': 0.7662749, 'auroc': 0.897022, 'binary_precision': 0.7413249, 'binary_recall': 0.90733594, 'binary_specificity': 0.6203704, 'binary_f1_score': 0.8159722}
confusion matrix:
     0    1
0  134   82
1   24  235
early stop counter: 2
val acc:0.762910783290863, best validation acc: 0.8325508832931519, corresponding to test acc:                         0.827368438243866 / 0.827368438243866
after epoch: 5,now: 2024-07-13 11:21:17.957473,epoch time: 0:10:57.419613,used: 0:55:04.475587,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_10_26_13_seed_2_21955591
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9863271, 'precision': 0.89517224, 'recall': 0.9799806, 'specificity': 0.9799806, 'f1': 0.93290687, 'auroc': 0.99819654, 'binary_precision': 0.9986108, 'binary_recall': 0.987006, 'binary_specificity': 0.97295517, 'binary_f1_score': 0.9927745}
confusion matrix:
      0      1
0  1475     41
1   388  29472
---- Validation: 
scalar performance:
{'acc': 0.86619717, 'precision': 0.8679466, 'recall': 0.86716485, 'specificity': 0.86716485, 'f1': 0.8661735, 'auroc': 0.92754734, 'binary_precision': 0.83506685, 'binary_recall': 0.903537, 'binary_specificity': 0.83079267, 'binary_f1_score': 0.86795366}
confusion matrix:
     0    1
0  545  111
1   60  562
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.84, 'precision': 0.8384877, 'recall': 0.8398309, 'specificity': 0.8398309, 'f1': 0.83902323, 'auroc': 0.9136636, 'binary_precision': 0.86166006, 'binary_recall': 0.8416988, 'binary_specificity': 0.837963, 'binary_f1_score': 0.8515625}
confusion matrix:
     0    1
0  181   35
1   41  218
new oracle model saved
better model found
persisted
after epoch: 6,now: 2024-07-13 11:32:13.798894,epoch time: 0:10:55.841421,used: 1:06:00.317008,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_10_26_13_seed_2_21955591
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9925102, 'precision': 0.94489646, 'recall': 0.9779069, 'specificity': 0.9779069, 'f1': 0.9607388, 'auroc': 0.9989556, 'binary_precision': 0.99804986, 'binary_recall': 0.9940723, 'binary_specificity': 0.96174145, 'binary_f1_score': 0.9960571}
confusion matrix:
      0      1
0  1458     58
1   177  29683
---- Validation: 
scalar performance:
{'acc': 0.8748044, 'precision': 0.87478447, 'recall': 0.875049, 'specificity': 0.875049, 'f1': 0.8747796, 'auroc': 0.9336057, 'binary_precision': 0.86206895, 'binary_recall': 0.8842444, 'binary_specificity': 0.86585367, 'binary_f1_score': 0.8730159}
confusion matrix:
     0    1
0  568   88
1   72  550
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.85473686, 'precision': 0.8565217, 'recall': 0.8591091, 'specificity': 0.8591091, 'f1': 0.85461056, 'auroc': 0.9280888, 'binary_precision': 0.9130435, 'binary_recall': 0.8108108, 'binary_specificity': 0.9074074, 'binary_f1_score': 0.8588957}
confusion matrix:
     0    1
0  196   20
1   49  210
new oracle model saved
better model found
persisted
after epoch: 7,now: 2024-07-13 11:43:14.667206,epoch time: 0:11:00.868312,used: 1:17:01.185320,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_10_26_13_seed_2_21955591
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9936576, 'precision': 0.9695119, 'recall': 0.9609778, 'specificity': 0.9609778, 'f1': 0.9652012, 'auroc': 0.99885714, 'binary_precision': 0.9961859, 'binary_recall': 0.9971534, 'binary_specificity': 0.9248021, 'binary_f1_score': 0.9966694}
confusion matrix:
      0      1
0  1402    114
1    85  29775
---- Validation: 
scalar performance:
{'acc': 0.85758996, 'precision': 0.8609509, 'recall': 0.8589057, 'specificity': 0.8589057, 'f1': 0.85748905, 'auroc': 0.9279101, 'binary_precision': 0.81884056, 'binary_recall': 0.9083601, 'binary_specificity': 0.8094512, 'binary_f1_score': 0.86128044}
confusion matrix:
     0    1
0  531  125
1   57  565
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.83157897, 'precision': 0.8300725, 'recall': 0.8317246, 'specificity': 0.8317246, 'f1': 0.8306595, 'auroc': 0.91010654, 'binary_precision': 0.8565737, 'binary_recall': 0.83011585, 'binary_specificity': 0.8333333, 'binary_f1_score': 0.8431372}
confusion matrix:
     0    1
0  180   36
1   44  215
early stop counter: 1
val acc:0.8575899600982666, best validation acc: 0.8748043775558472, corresponding to test acc:                         0.854736864566803 / 0.854736864566803
after epoch: 8,now: 2024-07-13 11:54:20.007404,epoch time: 0:11:05.340198,used: 1:28:06.525518,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_10_26_13_seed_2_21955591
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9786461, 'precision': 0.8488171, 'recall': 0.98001504, 'specificity': 0.98001504, 'f1': 0.9024507, 'auroc': 0.99845433, 'binary_precision': 0.99904263, 'binary_recall': 0.97849965, 'binary_specificity': 0.98153037, 'binary_f1_score': 0.98866445}
confusion matrix:
      0      1
0  1488     28
1   642  29218
---- Validation: 
scalar performance:
{'acc': 0.84976524, 'precision': 0.8601605, 'recall': 0.84749234, 'specificity': 0.84749234, 'f1': 0.8479929, 'auroc': 0.9330034, 'binary_precision': 0.9150579, 'binary_recall': 0.7620579, 'binary_specificity': 0.93292683, 'binary_f1_score': 0.8315789}
confusion matrix:
     0    1
0  612   44
1  148  474
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8294737, 'precision': 0.8578272, 'recall': 0.84247637, 'specificity': 0.84247637, 'f1': 0.8286962, 'auroc': 0.9152546, 'binary_precision': 0.9836956, 'binary_recall': 0.6988417, 'binary_specificity': 0.9861111, 'binary_f1_score': 0.8171557}
confusion matrix:
     0    1
0  213    3
1   78  181
early stop counter: 2
val acc:0.8497652411460876, best validation acc: 0.8748043775558472, corresponding to test acc:                         0.854736864566803 / 0.854736864566803
after epoch: 9,now: 2024-07-13 12:05:22.513990,epoch time: 0:11:02.506586,used: 1:39:09.032104,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_10_26_13_seed_2_21955591
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9929564, 'precision': 0.94828963, 'recall': 0.97876745, 'specificity': 0.97876745, 'f1': 0.96296644, 'auroc': 0.9987253, 'binary_precision': 0.9981177, 'binary_recall': 0.99447423, 'binary_specificity': 0.9630607, 'binary_f1_score': 0.9962927}
confusion matrix:
      0      1
0  1460     56
1   165  29695
---- Validation: 
scalar performance:
{'acc': 0.8834116, 'precision': 0.88334334, 'recall': 0.8835998, 'specificity': 0.8835998, 'f1': 0.8833801, 'auroc': 0.9376397, 'binary_precision': 0.87244093, 'binary_recall': 0.89067525, 'binary_specificity': 0.8765244, 'binary_f1_score': 0.8814638}
confusion matrix:
     0    1
0  575   81
1   68  554
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.86526316, 'precision': 0.86677665, 'recall': 0.86953026, 'specificity': 0.86953026, 'f1': 0.86512864, 'auroc': 0.9322001, 'binary_precision': 0.9220779, 'binary_recall': 0.82239383, 'binary_specificity': 0.9166667, 'binary_f1_score': 0.8693877}
confusion matrix:
     0    1
0  198   18
1   46  213
new oracle model saved
better model found
persisted
after epoch: 10,now: 2024-07-13 12:16:25.219320,epoch time: 0:11:02.705330,used: 1:50:11.737434,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_10_26_13_seed_2_21955591
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9930839, 'precision': 0.9768518, 'recall': 0.94658816, 'specificity': 0.94658816, 'f1': 0.96116817, 'auroc': 0.9989246, 'binary_precision': 0.9946931, 'binary_recall': 0.9980576, 'binary_specificity': 0.8951187, 'binary_f1_score': 0.9963725}
confusion matrix:
      0      1
0  1357    159
1    58  29802
---- Validation: 
scalar performance:
{'acc': 0.8763693, 'precision': 0.8765412, 'recall': 0.87603176, 'specificity': 0.87603176, 'f1': 0.87620896, 'auroc': 0.9350989, 'binary_precision': 0.8803279, 'binary_recall': 0.8633441, 'binary_specificity': 0.8887195, 'binary_f1_score': 0.8717533}
confusion matrix:
     0    1
0  583   73
1   85  537
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.86105263, 'precision': 0.8644445, 'recall': 0.86643785, 'specificity': 0.86643785, 'f1': 0.86100274, 'auroc': 0.9245317, 'binary_precision': 0.9288889, 'binary_recall': 0.8069498, 'binary_specificity': 0.9259259, 'binary_f1_score': 0.86363643}
confusion matrix:
     0    1
0  200   16
1   50  209
early stop counter: 1
val acc:0.876369297504425, best validation acc: 0.8834115862846375, corresponding to test acc:                         0.8652631640434265 / 0.8652631640434265
after epoch: 11,now: 2024-07-13 12:27:26.132952,epoch time: 0:11:00.913632,used: 2:01:12.651066,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_10_26_13_seed_2_21955591
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9905979, 'precision': 0.9241881, 'recall': 0.98504204, 'specificity': 0.98504204, 'f1': 0.95231676, 'auroc': 0.99921626, 'binary_precision': 0.99891996, 'binary_recall': 0.9911922, 'binary_specificity': 0.97889185, 'binary_f1_score': 0.99504113}
confusion matrix:
      0      1
0  1484     32
1   263  29597
---- Validation: 
scalar performance:
{'acc': 0.85602504, 'precision': 0.8560496, 'recall': 0.8557564, 'specificity': 0.8557564, 'f1': 0.85586935, 'auroc': 0.92658174, 'binary_precision': 0.85667753, 'binary_recall': 0.84565914, 'binary_specificity': 0.86585367, 'binary_f1_score': 0.8511327}
confusion matrix:
     0    1
0  568   88
1   96  526
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.80421054, 'precision': 0.8136568, 'recall': 0.8120084, 'specificity': 0.8120084, 'f1': 0.80417925, 'auroc': 0.88778067, 'binary_precision': 0.8952381, 'binary_recall': 0.7258687, 'binary_specificity': 0.8981481, 'binary_f1_score': 0.8017057}
confusion matrix:
     0    1
0  194   22
1   71  188
early stop counter: 2
val acc:0.8560250401496887, best validation acc: 0.8834115862846375, corresponding to test acc:                         0.8652631640434265 / 0.8652631640434265
after epoch: 12,now: 2024-07-13 12:38:21.019832,epoch time: 0:10:54.886880,used: 2:12:07.537946,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_10_26_13_seed_2_21955591
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9949962, 'precision': 0.9769244, 'recall': 0.9682555, 'specificity': 0.9682555, 'f1': 0.9725456, 'auroc': 0.9992715, 'binary_precision': 0.99688846, 'binary_recall': 0.9978567, 'binary_specificity': 0.93865436, 'binary_f1_score': 0.9973723}
confusion matrix:
      0      1
0  1423     93
1    64  29796
---- Validation: 
scalar performance:
{'acc': 0.8896714, 'precision': 0.8895586, 'recall': 0.88973904, 'specificity': 0.88973904, 'f1': 0.8896221, 'auroc': 0.94025713, 'binary_precision': 0.88235295, 'binary_recall': 0.89228296, 'binary_specificity': 0.8871951, 'binary_f1_score': 0.8872902}
confusion matrix:
     0    1
0  582   74
1   67  555
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.85052633, 'precision': 0.85499233, 'recall': 0.8564011, 'specificity': 0.8564011, 'f1': 0.85050243, 'auroc': 0.9102496, 'binary_precision': 0.9234234, 'binary_recall': 0.7915058, 'binary_specificity': 0.9212963, 'binary_f1_score': 0.8523908}
confusion matrix:
     0    1
0  199   17
1   54  205
better model found
persisted
after epoch: 13,now: 2024-07-13 12:49:06.628638,epoch time: 0:10:45.608806,used: 2:22:53.146752,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_10_26_13_seed_2_21955591
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9949962, 'precision': 0.9822942, 'recall': 0.96262026, 'specificity': 0.96262026, 'f1': 0.97222924, 'auroc': 0.999333, 'binary_precision': 0.99629074, 'binary_recall': 0.99845946, 'binary_specificity': 0.926781, 'binary_f1_score': 0.9973739}
confusion matrix:
      0      1
0  1405    111
1    46  29814
---- Validation: 
scalar performance:
{'acc': 0.85915494, 'precision': 0.86209226, 'recall': 0.8603884, 'specificity': 0.8603884, 'f1': 0.85907733, 'auroc': 0.9311991, 'binary_precision': 0.82215744, 'binary_recall': 0.9067524, 'binary_specificity': 0.8140244, 'binary_f1_score': 0.86238533}
confusion matrix:
     0    1
0  534  122
1   58  564
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.83157897, 'precision': 0.8303344, 'recall': 0.829803, 'specificity': 0.829803, 'f1': 0.8300537, 'auroc': 0.9053339, 'binary_precision': 0.8429119, 'binary_recall': 0.84942085, 'binary_specificity': 0.8101852, 'binary_f1_score': 0.8461539}
confusion matrix:
     0    1
0  175   41
1   39  220
early stop counter: 1
val acc:0.8591549396514893, best validation acc: 0.8896713852882385, corresponding to test acc:                         0.8505263328552246 / 0.8652631640434265
after epoch: 14,now: 2024-07-13 12:59:32.524513,epoch time: 0:10:25.895875,used: 2:33:19.042627,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_10_26_13_seed_2_21955591
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9896736, 'precision': 0.9922385, 'recall': 0.8950183, 'specificity': 0.8950183, 'f1': 0.93774265, 'auroc': 0.9992075, 'binary_precision': 0.9894604, 'binary_recall': 0.9997991, 'binary_specificity': 0.7902375, 'binary_f1_score': 0.9946029}
confusion matrix:
      0      1
0  1198    318
1     6  29854
---- Validation: 
scalar performance:
{'acc': 0.69092333, 'precision': 0.793853, 'recall': 0.6986413, 'specificity': 0.6986413, 'f1': 0.666324, 'auroc': 0.9419825, 'binary_precision': 0.6131605, 'binary_recall': 0.988746, 'binary_specificity': 0.40853658, 'binary_f1_score': 0.7569231}
confusion matrix:
     0    1
0  268  388
1    7  615
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6421053, 'precision': 0.75845975, 'recall': 0.6084031, 'specificity': 0.6084031, 'f1': 0.5621313, 'auroc': 0.93400544, 'binary_precision': 0.6062052, 'binary_recall': 0.980695, 'binary_specificity': 0.2361111, 'binary_f1_score': 0.7492625}
confusion matrix:
    0    1
0  51  165
1   5  254
early stop counter: 2
val acc:0.6909233331680298, best validation acc: 0.8896713852882385, corresponding to test acc:                         0.8505263328552246 / 0.8652631640434265
after epoch: 15,now: 2024-07-13 13:10:01.945507,epoch time: 0:10:29.420994,used: 2:43:48.463621,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_10_26_13_seed_2_21955591
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9954105, 'precision': 0.98025155, 'recall': 0.9694124, 'specificity': 0.9694124, 'f1': 0.97476304, 'auroc': 0.9992703, 'binary_precision': 0.99698955, 'binary_recall': 0.99819154, 'binary_specificity': 0.94063324, 'binary_f1_score': 0.9975902}
confusion matrix:
      0      1
0  1426     90
1    54  29806
---- Validation: 
scalar performance:
{'acc': 0.87558687, 'precision': 0.8777137, 'recall': 0.8766445, 'specificity': 0.8766445, 'f1': 0.87555325, 'auroc': 0.9427937, 'binary_precision': 0.84194976, 'binary_recall': 0.9163987, 'binary_specificity': 0.8368902, 'binary_f1_score': 0.87759817}
confusion matrix:
     0    1
0  549  107
1   52  570
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8736842, 'precision': 0.8730982, 'recall': 0.87609935, 'specificity': 0.87609935, 'f1': 0.87333333, 'auroc': 0.9356142, 'binary_precision': 0.9128631, 'binary_recall': 0.84942085, 'binary_specificity': 0.9027778, 'binary_f1_score': 0.88}
confusion matrix:
     0    1
0  195   21
1   39  220
new oracle model saved
early stop counter: 3
val acc:0.8755868673324585, best validation acc: 0.8896713852882385, corresponding to test acc:                         0.8505263328552246 / 0.8736842274665833
after epoch: 16,now: 2024-07-13 13:20:40.240627,epoch time: 0:10:38.295120,used: 2:54:26.758741,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_10_26_13_seed_2_21955591
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9934345, 'precision': 0.9543835, 'recall': 0.9765141, 'specificity': 0.9765141, 'f1': 0.96515405, 'auroc': 0.9991004, 'binary_precision': 0.9978511, 'binary_recall': 0.9952445, 'binary_specificity': 0.95778364, 'binary_f1_score': 0.99654603}
confusion matrix:
      0      1
0  1452     64
1   142  29718
---- Validation: 
scalar performance:
{'acc': 0.81611896, 'precision': 0.839607, 'recall': 0.8195926, 'specificity': 0.8195926, 'f1': 0.81391764, 'auroc': 0.9301053, 'binary_precision': 0.7433962, 'binary_recall': 0.9501608, 'binary_specificity': 0.6890244, 'binary_f1_score': 0.8341567}
confusion matrix:
     0    1
0  452  204
1   31  591
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8105263, 'precision': 0.81113636, 'recall': 0.80588627, 'specificity': 0.80588627, 'f1': 0.8075572, 'auroc': 0.9076755, 'binary_precision': 0.80727273, 'binary_recall': 0.85714287, 'binary_specificity': 0.7546296, 'binary_f1_score': 0.83146065}
confusion matrix:
     0    1
0  163   53
1   37  222
early stop counter: 4
val acc:0.8161189556121826, best validation acc: 0.8896713852882385, corresponding to test acc:                         0.8505263328552246 / 0.8736842274665833
after epoch: 17,now: 2024-07-13 13:31:11.022637,epoch time: 0:10:30.782010,used: 3:04:57.540751,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_10_26_13_seed_2_21955591
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9916815, 'precision': 0.98899007, 'recall': 0.91955346, 'specificity': 0.91955346, 'f1': 0.9513321, 'auroc': 0.99928844, 'binary_precision': 0.99192286, 'binary_recall': 0.99939716, 'binary_specificity': 0.83970976, 'binary_f1_score': 0.995646}
confusion matrix:
      0      1
0  1273    243
1    18  29842
---- Validation: 
scalar performance:
{'acc': 0.8302034, 'precision': 0.85159755, 'recall': 0.83347875, 'specificity': 0.83347875, 'f1': 0.82845557, 'auroc': 0.9363506, 'binary_precision': 0.7579618, 'binary_recall': 0.95659167, 'binary_specificity': 0.71036583, 'binary_f1_score': 0.84577113}
confusion matrix:
     0    1
0  466  190
1   27  595
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.81473684, 'precision': 0.82593465, 'recall': 0.8051355, 'specificity': 0.8051355, 'f1': 0.80860806, 'auroc': 0.9199021, 'binary_precision': 0.78405315, 'binary_recall': 0.9111969, 'binary_specificity': 0.6990741, 'binary_f1_score': 0.8428572}
confusion matrix:
     0    1
0  151   65
1   23  236
early stop counter: 5
val acc:0.8302034139633179, best validation acc: 0.8896713852882385, corresponding to test acc:                         0.8505263328552246 / 0.8736842274665833
after epoch: 18,now: 2024-07-13 13:41:41.859521,epoch time: 0:10:30.836884,used: 3:15:28.377635,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_10_26_13_seed_2_21955591
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9897693, 'precision': 0.99268854, 'recall': 0.8956946, 'specificity': 0.8956946, 'f1': 0.9383407, 'auroc': 0.9994463, 'binary_precision': 0.9895264, 'binary_recall': 0.9998326, 'binary_specificity': 0.7915567, 'binary_f1_score': 0.9946528}
confusion matrix:
      0      1
0  1200    316
1     5  29855
---- Validation: 
scalar performance:
{'acc': 0.7629108, 'precision': 0.8185265, 'recall': 0.7683883, 'specificity': 0.7683883, 'f1': 0.7544669, 'auroc': 0.92878497, 'binary_precision': 0.6786114, 'binary_recall': 0.97427654, 'binary_specificity': 0.5625, 'binary_f1_score': 0.8}
confusion matrix:
     0    1
0  369  287
1   16  606
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7536842, 'precision': 0.8020718, 'recall': 0.7337784, 'specificity': 0.7337784, 'f1': 0.731689, 'auroc': 0.85036826, 'binary_precision': 0.70170456, 'binary_recall': 0.95366794, 'binary_specificity': 0.5138889, 'binary_f1_score': 0.80851066}
confusion matrix:
     0    1
0  111  105
1   12  247
early stop counter: 6
val acc:0.762910783290863, best validation acc: 0.8896713852882385, corresponding to test acc:                         0.8505263328552246 / 0.8736842274665833
after epoch: 19,now: 2024-07-13 13:52:17.218984,epoch time: 0:10:35.359463,used: 3:26:03.737098,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_10_26_13_seed_2_21955591
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9958886, 'precision': 0.9833617, 'recall': 0.971542, 'specificity': 0.971542, 'f1': 0.9773704, 'auroc': 0.999519, 'binary_precision': 0.99719054, 'binary_recall': 0.99849296, 'binary_specificity': 0.94459105, 'binary_f1_score': 0.99784136}
confusion matrix:
      0      1
0  1432     84
1    45  29815
---- Validation: 
scalar performance:
{'acc': 0.87089205, 'precision': 0.8719163, 'recall': 0.8716546, 'specificity': 0.8716546, 'f1': 0.8708881, 'auroc': 0.9390048, 'binary_precision': 0.84464556, 'binary_recall': 0.90032154, 'binary_specificity': 0.8429878, 'binary_f1_score': 0.8715953}
confusion matrix:
     0    1
0  553  103
1   62  560
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8357895, 'precision': 0.83981955, 'recall': 0.8413503, 'specificity': 0.8413503, 'f1': 0.8357538, 'auroc': 0.90622765, 'binary_precision': 0.9058296, 'binary_recall': 0.7799228, 'binary_specificity': 0.9027778, 'binary_f1_score': 0.8381743}
confusion matrix:
     0    1
0  195   21
1   57  202
early stop counter: 7
val acc:0.8708920478820801, best validation acc: 0.8896713852882385, corresponding to test acc:                         0.8505263328552246 / 0.8736842274665833
after epoch: 20,now: 2024-07-13 14:02:49.133717,epoch time: 0:10:31.914733,used: 3:36:35.651831,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_10_26_13_seed_2_21955591
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9956973, 'precision': 0.9728474, 'recall': 0.98083365, 'specificity': 0.98083365, 'f1': 0.9768032, 'auroc': 0.9993229, 'binary_precision': 0.9981899, 'binary_recall': 0.99728733, 'binary_specificity': 0.96437997, 'binary_f1_score': 0.9977384}
confusion matrix:
      0      1
0  1462     54
1    81  29779
---- Validation: 
scalar performance:
{'acc': 0.85680753, 'precision': 0.87006366, 'recall': 0.85935175, 'specificity': 0.85935175, 'f1': 0.85604525, 'auroc': 0.9507367, 'binary_precision': 0.7930574, 'binary_recall': 0.95498395, 'binary_specificity': 0.7637195, 'binary_f1_score': 0.86652076}
confusion matrix:
     0    1
0  501  155
1   28  594
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.86315787, 'precision': 0.86234456, 'recall': 0.86145073, 'specificity': 0.86145073, 'f1': 0.8618624, 'auroc': 0.9295367, 'binary_precision': 0.870229, 'binary_recall': 0.88030887, 'binary_specificity': 0.8425926, 'binary_f1_score': 0.8752399}
confusion matrix:
     0    1
0  182   34
1   31  228
early stop counter: 8
val acc:0.8568075299263, best validation acc: 0.8896713852882385, corresponding to test acc:                         0.8505263328552246 / 0.8736842274665833
after epoch: 21,now: 2024-07-13 14:13:19.263430,epoch time: 0:10:30.129713,used: 3:47:05.781544,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_10_26_13_seed_2_21955591
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9944544, 'precision': 0.9619243, 'recall': 0.9792414, 'specificity': 0.9792414, 'f1': 0.9704046, 'auroc': 0.9993813, 'binary_precision': 0.9980872, 'binary_recall': 0.9960817, 'binary_specificity': 0.96240103, 'binary_f1_score': 0.9970834}
confusion matrix:
      0      1
0  1459     57
1   117  29743
---- Validation: 
scalar performance:
{'acc': 0.85915494, 'precision': 0.8596654, 'recall': 0.8597218, 'specificity': 0.8597218, 'f1': 0.8591546, 'auroc': 0.9279591, 'binary_precision': 0.8379205, 'binary_recall': 0.88102895, 'binary_specificity': 0.8384146, 'binary_f1_score': 0.85893416}
confusion matrix:
     0    1
0  550  106
1   74  548
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.83157897, 'precision': 0.83255595, 'recall': 0.8351834, 'specificity': 0.8351834, 'f1': 0.83136296, 'auroc': 0.8921064, 'binary_precision': 0.88412017, 'binary_recall': 0.7953668, 'binary_specificity': 0.875, 'binary_f1_score': 0.8373984}
confusion matrix:
     0    1
0  189   27
1   53  206
early stop counter: 9
val acc:0.8591549396514893, best validation acc: 0.8896713852882385, corresponding to test acc:                         0.8505263328552246 / 0.8736842274665833
after epoch: 22,now: 2024-07-13 14:24:02.364702,epoch time: 0:10:43.101272,used: 3:57:48.882816,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_10_26_13_seed_2_21955591
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.9956973, 'precision': 0.9773191, 'recall': 0.9758245, 'specificity': 0.9758245, 'f1': 0.9765705, 'auroc': 0.9994263, 'binary_precision': 0.9976561, 'binary_recall': 0.9978232, 'binary_specificity': 0.95382583, 'binary_f1_score': 0.9977396}
confusion matrix:
      0      1
0  1446     70
1    65  29795
---- Validation: 
scalar performance:
{'acc': 0.8356807, 'precision': 0.8527421, 'recall': 0.83860576, 'specificity': 0.83860576, 'f1': 0.834409, 'auroc': 0.93594134, 'binary_precision': 0.7682292, 'binary_recall': 0.948553, 'binary_specificity': 0.72865856, 'binary_f1_score': 0.8489209}
confusion matrix:
     0    1
0  478  178
1   32  590
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8231579, 'precision': 0.82186234, 'recall': 0.82400256, 'specificity': 0.82400256, 'f1': 0.8224014, 'auroc': 0.8899077, 'binary_precision': 0.854251, 'binary_recall': 0.8146718, 'binary_specificity': 0.8333333, 'binary_f1_score': 0.83399206}
confusion matrix:
     0    1
0  180   36
1   48  211
early stop counter: 10
val acc:0.8356807231903076, best validation acc: 0.8896713852882385, corresponding to test acc:                         0.8505263328552246 / 0.8736842274665833
after epoch: 23,now: 2024-07-13 14:34:45.703750,epoch time: 0:10:43.339048,used: 4:08:32.221864,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_10_26_13_seed_2_21955591
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9953149, 'precision': 0.98166096, 'recall': 0.9668576, 'specificity': 0.9668576, 'f1': 0.9741307, 'auroc': 0.9995699, 'binary_precision': 0.9967234, 'binary_recall': 0.998359, 'binary_specificity': 0.9353562, 'binary_f1_score': 0.9975406}
confusion matrix:
      0      1
0  1418     98
1    49  29811
---- Validation: 
scalar performance:
{'acc': 0.86697966, 'precision': 0.8693537, 'recall': 0.86809367, 'specificity': 0.86809367, 'f1': 0.8669327, 'auroc': 0.938897, 'binary_precision': 0.83235294, 'binary_recall': 0.90996784, 'binary_specificity': 0.8262195, 'binary_f1_score': 0.8694316}
confusion matrix:
     0    1
0  542  114
1   56  566
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.83157897, 'precision': 0.83255595, 'recall': 0.8351834, 'specificity': 0.8351834, 'f1': 0.83136296, 'auroc': 0.8990598, 'binary_precision': 0.88412017, 'binary_recall': 0.7953668, 'binary_specificity': 0.875, 'binary_f1_score': 0.8373984}
confusion matrix:
     0    1
0  189   27
1   53  206
early stop counter: 11
val acc:0.8669796586036682, best validation acc: 0.8896713852882385, corresponding to test acc:                         0.8505263328552246 / 0.8736842274665833
after epoch: 24,now: 2024-07-13 14:45:27.000008,epoch time: 0:10:41.296258,used: 4:19:13.518122,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_10_26_13_seed_2_21955591
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.9912672, 'precision': 0.99090993, 'recall': 0.9133875, 'specificity': 0.9133875, 'f1': 0.94847035, 'auroc': 0.9996191, 'binary_precision': 0.99129856, 'binary_recall': 0.99959815, 'binary_specificity': 0.8271768, 'binary_f1_score': 0.99543107}
confusion matrix:
      0      1
0  1254    262
1    12  29848
---- Validation: 
scalar performance:
{'acc': 0.814554, 'precision': 0.84644735, 'recall': 0.81856817, 'specificity': 0.81856817, 'f1': 0.8114104, 'auroc': 0.9500922, 'binary_precision': 0.7344701, 'binary_recall': 0.9694534, 'binary_specificity': 0.66768295, 'binary_f1_score': 0.83575886}
confusion matrix:
     0    1
0  438  218
1   19  603
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8, 'precision': 0.8307823, 'recall': 0.78508866, 'specificity': 0.78508866, 'f1': 0.7882261, 'auroc': 0.92730236, 'binary_precision': 0.75, 'binary_recall': 0.9498069, 'binary_specificity': 0.6203704, 'binary_f1_score': 0.83816016}
confusion matrix:
     0    1
0  134   82
1   13  246
early stop counter: 12
val acc:0.81455397605896, best validation acc: 0.8896713852882385, corresponding to test acc:                         0.8505263328552246 / 0.8736842274665833
after epoch: 25,now: 2024-07-13 14:56:10.022657,epoch time: 0:10:43.022649,used: 4:29:56.540771,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_10_26_13_seed_2_21955591
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9968447, 'precision': 0.97566634, 'recall': 0.9908286, 'specificity': 0.9908286, 'f1': 0.9831146, 'auroc': 0.99978006, 'binary_precision': 0.99919486, 'binary_recall': 0.99748826, 'binary_specificity': 0.9841689, 'binary_f1_score': 0.99834085}
confusion matrix:
      0      1
0  1492     24
1    75  29785
---- Validation: 
scalar performance:
{'acc': 0.8810642, 'precision': 0.88457555, 'recall': 0.88239646, 'specificity': 0.88239646, 'f1': 0.8809799, 'auroc': 0.9445559, 'binary_precision': 0.8405797, 'binary_recall': 0.93247586, 'binary_specificity': 0.83231705, 'binary_f1_score': 0.88414633}
confusion matrix:
     0    1
0  546  110
1   42  580
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8336842, 'precision': 0.8327768, 'recall': 0.83134925, 'specificity': 0.83134925, 'f1': 0.8319683, 'auroc': 0.9034034, 'binary_precision': 0.84090906, 'binary_recall': 0.85714287, 'binary_specificity': 0.8055556, 'binary_f1_score': 0.84894836}
confusion matrix:
     0    1
0  174   42
1   37  222
early stop counter: 13
val acc:0.8810641765594482, best validation acc: 0.8896713852882385, corresponding to test acc:                         0.8505263328552246 / 0.8736842274665833
after epoch: 26,now: 2024-07-13 15:07:01.202685,epoch time: 0:10:51.180028,used: 4:40:47.720799,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_10_26_13_seed_2_21955591
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.9954742, 'precision': 0.9800137, 'recall': 0.9703851, 'specificity': 0.9703851, 'f1': 0.9751451, 'auroc': 0.99930704, 'binary_precision': 0.9970895, 'binary_recall': 0.9981581, 'binary_specificity': 0.9426121, 'binary_f1_score': 0.9976235}
confusion matrix:
      0      1
0  1429     87
1    55  29805
---- Validation: 
scalar performance:
{'acc': 0.87558687, 'precision': 0.88132066, 'recall': 0.8772694, 'specificity': 0.8772694, 'f1': 0.8753884, 'auroc': 0.9462738, 'binary_precision': 0.8274399, 'binary_recall': 0.94051445, 'binary_specificity': 0.8140244, 'binary_f1_score': 0.88036114}
confusion matrix:
     0    1
0  534  122
1   37  585
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.84, 'precision': 0.83997726, 'recall': 0.83675635, 'specificity': 0.83675635, 'f1': 0.8379829, 'auroc': 0.9352567, 'binary_precision': 0.8401487, 'binary_recall': 0.87258685, 'binary_specificity': 0.8009259, 'binary_f1_score': 0.85606056}
confusion matrix:
     0    1
0  173   43
1   33  226
early stop counter: 14
val acc:0.8755868673324585, best validation acc: 0.8896713852882385, corresponding to test acc:                         0.8505263328552246 / 0.8736842274665833
after epoch: 27,now: 2024-07-13 15:17:44.884811,epoch time: 0:10:43.682126,used: 4:51:31.402925,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_10_26_13_seed_2_21955591
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.9956655, 'precision': 0.97038245, 'recall': 0.9833214, 'specificity': 0.9833214, 'f1': 0.9767539, 'auroc': 0.9995978, 'binary_precision': 0.9984572, 'binary_recall': 0.9969859, 'binary_specificity': 0.969657, 'binary_f1_score': 0.997721}
confusion matrix:
      0      1
0  1470     46
1    90  29770
---- Validation: 
scalar performance:
{'acc': 0.90923315, 'precision': 0.909402, 'recall': 0.9089606, 'specificity': 0.9089606, 'f1': 0.90912545, 'auroc': 0.95166063, 'binary_precision': 0.9133987, 'binary_recall': 0.8987138, 'binary_specificity': 0.91920733, 'binary_f1_score': 0.90599674}
confusion matrix:
     0    1
0  603   53
1   63  559
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.86526316, 'precision': 0.87019455, 'recall': 0.8714518, 'specificity': 0.8714518, 'f1': 0.8652482, 'auroc': 0.933934, 'binary_precision': 0.9411765, 'binary_recall': 0.8030888, 'binary_specificity': 0.9398148, 'binary_f1_score': 0.8666667}
confusion matrix:
     0    1
0  203   13
1   51  208
better model found
persisted
after epoch: 28,now: 2024-07-13 15:28:23.387627,epoch time: 0:10:38.502816,used: 5:02:09.905741,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_10_26_13_seed_2_21955591
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9916178, 'precision': 0.92960477, 'recall': 0.98964775, 'specificity': 0.98964775, 'f1': 0.9574151, 'auroc': 0.9995221, 'binary_precision': 0.9993589, 'binary_recall': 0.99182856, 'binary_specificity': 0.987467, 'binary_f1_score': 0.9955795}
confusion matrix:
      0      1
0  1497     19
1   244  29616
---- Validation: 
scalar performance:
{'acc': 0.885759, 'precision': 0.88618946, 'recall': 0.88630307, 'specificity': 0.88630307, 'f1': 0.8857578, 'auroc': 0.9418453, 'binary_precision': 0.86503065, 'binary_recall': 0.9067524, 'binary_specificity': 0.86585367, 'binary_f1_score': 0.8854003}
confusion matrix:
     0    1
0  568   88
1   58  564
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8126316, 'precision': 0.81934613, 'recall': 0.81934613, 'specificity': 0.81934613, 'f1': 0.8126316, 'auroc': 0.89443016, 'binary_precision': 0.8935185, 'binary_recall': 0.74517375, 'binary_specificity': 0.8935185, 'binary_f1_score': 0.8126316}
confusion matrix:
     0    1
0  193   23
1   66  193
early stop counter: 1
val acc:0.8857589960098267, best validation acc: 0.9092331528663635, corresponding to test acc:                         0.8652631640434265 / 0.8736842274665833
after epoch: 29,now: 2024-07-13 15:38:58.569820,epoch time: 0:10:35.182193,used: 5:12:45.087934,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_10_26_13_seed_2_21955591
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.996271, 'precision': 0.9801587, 'recall': 0.97925663, 'specificity': 0.97925663, 'f1': 0.9797072, 'auroc': 0.9996934, 'binary_precision': 0.99799085, 'binary_recall': 0.9980911, 'binary_specificity': 0.96042216, 'binary_f1_score': 0.998041}
confusion matrix:
      0      1
0  1456     60
1    57  29803
---- Validation: 
scalar performance:
{'acc': 0.8841941, 'precision': 0.8842618, 'recall': 0.88394535, 'specificity': 0.88394535, 'f1': 0.88406885, 'auroc': 0.94571996, 'binary_precision': 0.8859935, 'binary_recall': 0.8745981, 'binary_specificity': 0.89329267, 'binary_f1_score': 0.880259}
confusion matrix:
     0    1
0  586   70
1   78  544
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8442105, 'precision': 0.8570912, 'recall': 0.85329974, 'specificity': 0.85329974, 'f1': 0.84412694, 'auroc': 0.91884744, 'binary_precision': 0.9512195, 'binary_recall': 0.7528958, 'binary_specificity': 0.9537037, 'binary_f1_score': 0.8405172}
confusion matrix:
     0    1
0  206   10
1   64  195
early stop counter: 2
val acc:0.8841940760612488, best validation acc: 0.9092331528663635, corresponding to test acc:                         0.8652631640434265 / 0.8736842274665833
after epoch: 30,now: 2024-07-13 15:49:26.978670,epoch time: 0:10:28.408850,used: 5:23:13.496784,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_10_26_13_seed_2_21955591
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 5:23:13.496784 at 2024-07-13 15:49:26.978670
persisted model performance metric: 

scalar performance:
{'acc': 0.86526316, 'precision': 0.87019455, 'recall': 0.8714518, 'specificity': 0.8714518, 'f1': 0.8652482, 'auroc': 0.933934, 'binary_precision': 0.9411765, 'binary_recall': 0.8030888, 'binary_specificity': 0.9398148, 'binary_f1_score': 0.8666667}
confusion matrix:
     0    1
0  203   13
1   51  208
oracle model performance metric: 

scalar performance:
{'acc': 0.8736842, 'precision': 0.8730982, 'recall': 0.87609935, 'specificity': 0.87609935, 'f1': 0.87333333, 'auroc': 0.9356142, 'binary_precision': 0.9128631, 'binary_recall': 0.84942085, 'binary_specificity': 0.9027778, 'binary_f1_score': 0.88}
confusion matrix:
     0    1
0  195   21
1   39  220
results aggregation path: zoutput/benchmarks/CAMELYONWILD_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_halffreeze/rule_results/4.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONWILD_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_halffreeze/confusion_matrix/4.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 318241 KiB |   6782 MiB |    849 TiB |    849 TiB |
|       from large pool | 291059 KiB |   6756 MiB |    836 TiB |    836 TiB |
|       from small pool |  27182 KiB |     43 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 318241 KiB |   6782 MiB |    849 TiB |    849 TiB |
|       from large pool | 291059 KiB |   6756 MiB |    836 TiB |    836 TiB |
|       from small pool |  27182 KiB |     43 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 313851 KiB |   6778 MiB |    848 TiB |    848 TiB |
|       from large pool | 286862 KiB |   6752 MiB |    835 TiB |    835 TiB |
|       from small pool |  26989 KiB |     43 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   7450 MiB |   7456 MiB |  21176 MiB |  13726 MiB |
|       from large pool |   7398 MiB |   7404 MiB |  21092 MiB |  13694 MiB |
|       from small pool |     52 MiB |     52 MiB |     84 MiB |     32 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 259294 KiB | 680184 KiB | 681277 GiB | 681277 GiB |
|       from large pool | 249613 KiB | 675647 KiB | 667313 GiB | 667313 GiB |
|       from small pool |   9681 KiB |  30502 KiB |  13964 GiB |  13964 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    1058    |    4669    |  177608 K  |  177607 K  |
|       from large pool |     130    |     756    |   80800 K  |   80799 K  |
|       from small pool |     928    |    4537    |   96808 K  |   96807 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    1058    |    4669    |  177608 K  |  177607 K  |
|       from large pool |     130    |     756    |   80800 K  |   80799 K  |
|       from small pool |     928    |    4537    |   96808 K  |   96807 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     335    |     335    |     919    |     584    |
|       from large pool |     309    |     309    |     877    |     568    |
|       from small pool |      26    |      26    |      42    |      16    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      75    |    2006    |  102811 K  |  102811 K  |
|       from large pool |      25    |     307    |   59042 K  |   59041 K  |
|       from small pool |      50    |    1982    |   43769 K  |   43769 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   6782 MiB |    849 TiB |    849 TiB |
|       from large pool |  16640 KiB |   6756 MiB |    836 TiB |    836 TiB |
|       from small pool |      0 KiB |     43 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   6782 MiB |    849 TiB |    849 TiB |
|       from large pool |  16640 KiB |   6756 MiB |    836 TiB |    836 TiB |
|       from small pool |      0 KiB |     43 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   6778 MiB |    848 TiB |    848 TiB |
|       from large pool |  16640 KiB |   6752 MiB |    835 TiB |    835 TiB |
|       from small pool |      0 KiB |     43 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 577536 KiB |   7456 MiB |  21176 MiB |  20612 MiB |
|       from large pool | 540672 KiB |   7404 MiB |  21092 MiB |  20564 MiB |
|       from small pool |  36864 KiB |     52 MiB |     84 MiB |     48 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 680184 KiB | 681278 GiB | 681278 GiB |
|       from large pool |  24320 KiB | 675647 KiB | 667313 GiB | 667313 GiB |
|       from small pool |      0 KiB |  30502 KiB |  13964 GiB |  13964 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    4669    |  177608 K  |  177608 K  |
|       from large pool |       2    |     756    |   80800 K  |   80800 K  |
|       from small pool |       0    |    4537    |   96808 K  |   96808 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    4669    |  177608 K  |  177608 K  |
|       from large pool |       2    |     756    |   80800 K  |   80800 K  |
|       from small pool |       0    |    4537    |   96808 K  |   96808 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      42    |     335    |     919    |     877    |
|       from large pool |      24    |     309    |     877    |     853    |
|       from small pool |      18    |      26    |      42    |      24    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    2006    |  102811 K  |  102811 K  |
|       from large pool |       3    |     307    |   59042 K  |   59042 K  |
|       from small pool |       0    |    1982    |   43769 K  |   43769 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Sat Jul 13 15:57:27 2024]
Finished job 0.
1 of 1 steps (100%) done
