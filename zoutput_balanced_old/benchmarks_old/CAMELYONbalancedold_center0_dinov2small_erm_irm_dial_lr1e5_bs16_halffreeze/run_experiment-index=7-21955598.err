Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Sat Jul 13 12:36:34 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYONWILD_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_halffreeze/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYONWILD_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_halffreeze/rule_results/7.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=7
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/swiglu_ffn.py:51: UserWarning: xFormers is not available (SwiGLU)
  warnings.warn("xFormers is not available (SwiGLU)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/attention.py:33: UserWarning: xFormers is not available (Attention)
  warnings.warn("xFormers is not available (Attention)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/block.py:40: UserWarning: xFormers is not available (Block)
  warnings.warn("xFormers is not available (Block)")
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_dann_b44271c83_not_commited_2024md_07md_13_12_45_07_seed_0_21955598

 Experiment start at: 2024-07-13 12:45:07.592545
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9511638, 'precision': 0.4755819, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48748538, 'auroc': 0.9915348, 'binary_precision': 0.9511638, 'binary_recall': 1.0, 'binary_specificity': 0.0, 'binary_f1_score': 0.97497076}
confusion matrix:
   0      1
0  0   1519
1  0  29585
---- Validation: 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
scalar performance:
{'acc': 0.49301243, 'precision': 0.24650621, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.33021322, 'auroc': 0.91586983, 'binary_precision': 0.49301243, 'binary_recall': 1.0, 'binary_specificity': 0.0, 'binary_f1_score': 0.66042644}
confusion matrix:
   0    1
0  0  653
1  0  635
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.556701, 'precision': 0.2783505, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.3576159, 'auroc': 0.91304904, 'binary_precision': 0.556701, 'binary_recall': 1.0, 'binary_specificity': 0.0, 'binary_f1_score': 0.7152318}
confusion matrix:
   0    1
0  0  215
1  0  270
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-13 13:03:28.978012,epoch time: 0:18:21.385467,used: 0:18:21.385467,model: dset_te_center0_dann_b44271c83_not_commited_2024md_07md_13_12_45_07_seed_0_21955598
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9511638, 'precision': 0.4755819, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48748538, 'auroc': 0.9916595, 'binary_precision': 0.9511638, 'binary_recall': 1.0, 'binary_specificity': 0.0, 'binary_f1_score': 0.97497076}
confusion matrix:
   0      1
0  0   1519
1  0  29585
---- Validation: 
scalar performance:
{'acc': 0.49301243, 'precision': 0.24650621, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.33021322, 'auroc': 0.9294847, 'binary_precision': 0.49301243, 'binary_recall': 1.0, 'binary_specificity': 0.0, 'binary_f1_score': 0.66042644}
confusion matrix:
   0    1
0  0  653
1  0  635
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.556701, 'precision': 0.2783505, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.3576159, 'auroc': 0.91295433, 'binary_precision': 0.556701, 'binary_recall': 1.0, 'binary_specificity': 0.0, 'binary_f1_score': 0.7152318}
confusion matrix:
   0    1
0  0  215
1  0  270
early stop counter: 1
val acc:0.4930124282836914, best validation acc: 0.4930124282836914, corresponding to test acc:                         0.5567010045051575 / 0.5567010045051575
after epoch: 2,now: 2024-07-13 13:21:33.200151,epoch time: 0:18:04.222139,used: 0:36:25.607606,model: dset_te_center0_dann_b44271c83_not_commited_2024md_07md_13_12_45_07_seed_0_21955598
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9511638, 'precision': 0.4755819, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48748538, 'auroc': 0.9904373, 'binary_precision': 0.9511638, 'binary_recall': 1.0, 'binary_specificity': 0.0, 'binary_f1_score': 0.97497076}
confusion matrix:
   0      1
0  0   1519
1  0  29585
---- Validation: 
scalar performance:
{'acc': 0.49301243, 'precision': 0.24650621, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.33021322, 'auroc': 0.9196223, 'binary_precision': 0.49301243, 'binary_recall': 1.0, 'binary_specificity': 0.0, 'binary_f1_score': 0.66042644}
confusion matrix:
   0    1
0  0  653
1  0  635
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.556701, 'precision': 0.2783505, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.3576159, 'auroc': 0.90432394, 'binary_precision': 0.556701, 'binary_recall': 1.0, 'binary_specificity': 0.0, 'binary_f1_score': 0.7152318}
confusion matrix:
   0    1
0  0  215
1  0  270
early stop counter: 2
val acc:0.4930124282836914, best validation acc: 0.4930124282836914, corresponding to test acc:                         0.5567010045051575 / 0.5567010045051575
after epoch: 3,now: 2024-07-13 13:39:36.334313,epoch time: 0:18:03.134162,used: 0:54:28.741768,model: dset_te_center0_dann_b44271c83_not_commited_2024md_07md_13_12_45_07_seed_0_21955598
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9511638, 'precision': 0.4755819, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48748538, 'auroc': 0.9949527, 'binary_precision': 0.9511638, 'binary_recall': 1.0, 'binary_specificity': 0.0, 'binary_f1_score': 0.97497076}
confusion matrix:
   0      1
0  0   1519
1  0  29585
---- Validation: 
scalar performance:
{'acc': 0.49301243, 'precision': 0.24650621, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.33021322, 'auroc': 0.92895174, 'binary_precision': 0.49301243, 'binary_recall': 1.0, 'binary_specificity': 0.0, 'binary_f1_score': 0.66042644}
confusion matrix:
   0    1
0  0  653
1  0  635
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.556701, 'precision': 0.2783505, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.3576159, 'auroc': 0.92029285, 'binary_precision': 0.556701, 'binary_recall': 1.0, 'binary_specificity': 0.0, 'binary_f1_score': 0.7152318}
confusion matrix:
   0    1
0  0  215
1  0  270
early stop counter: 3
val acc:0.4930124282836914, best validation acc: 0.4930124282836914, corresponding to test acc:                         0.5567010045051575 / 0.5567010045051575
after epoch: 4,now: 2024-07-13 13:57:39.586510,epoch time: 0:18:03.252197,used: 1:12:31.993965,model: dset_te_center0_dann_b44271c83_not_commited_2024md_07md_13_12_45_07_seed_0_21955598
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9839892, 'precision': 0.88428175, 'recall': 0.9709742, 'specificity': 0.9709742, 'f1': 0.92261636, 'auroc': 0.9964353, 'binary_precision': 0.9977412, 'binary_recall': 0.985398, 'binary_specificity': 0.95655036, 'binary_f1_score': 0.99153113}
confusion matrix:
      0      1
0  1453     66
1   432  29153
---- Validation: 
scalar performance:
{'acc': 0.753882, 'precision': 0.8066925, 'recall': 0.7567532, 'specificity': 0.7567532, 'f1': 0.74416625, 'auroc': 0.9314467, 'binary_precision': 0.67588496, 'binary_recall': 0.9622047, 'binary_specificity': 0.55130166, 'binary_f1_score': 0.7940221}
confusion matrix:
     0    1
0  360  293
1   24  611
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7587629, 'precision': 0.7897459, 'recall': 0.73690784, 'specificity': 0.73690784, 'f1': 0.73882604, 'auroc': 0.8924892, 'binary_precision': 0.7191977, 'binary_recall': 0.9296296, 'binary_specificity': 0.54418606, 'binary_f1_score': 0.8109855}
confusion matrix:
     0    1
0  117   98
1   19  251
new oracle model saved
better model found
persisted
after epoch: 5,now: 2024-07-13 14:15:42.568079,epoch time: 0:18:02.981569,used: 1:30:34.975534,model: dset_te_center0_dann_b44271c83_not_commited_2024md_07md_13_12_45_07_seed_0_21955598
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9890046, 'precision': 0.9242404, 'recall': 0.9648471, 'specificity': 0.9648471, 'f1': 0.94349754, 'auroc': 0.9974761, 'binary_precision': 0.9968062, 'binary_recall': 0.9916177, 'binary_specificity': 0.93807644, 'binary_f1_score': 0.9942052}
confusion matrix:
      0      1
0  1424     94
1   248  29338
---- Validation: 
scalar performance:
{'acc': 0.70729816, 'precision': 0.78471243, 'recall': 0.7108982, 'specificity': 0.7108982, 'f1': 0.6881703, 'auroc': 0.91662705, 'binary_precision': 0.63271606, 'binary_recall': 0.96850395, 'binary_specificity': 0.4532925, 'binary_f1_score': 0.7654014}
confusion matrix:
     0    1
0  296  357
1   20  615
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7340206, 'precision': 0.7958381, 'recall': 0.7047373, 'specificity': 0.7047373, 'f1': 0.69968176, 'auroc': 0.9213437, 'binary_precision': 0.68601584, 'binary_recall': 0.962963, 'binary_specificity': 0.44651163, 'binary_f1_score': 0.8012327}
confusion matrix:
    0    1
0  96  119
1  10  260
early stop counter: 1
val acc:0.7072981595993042, best validation acc: 0.7538819909095764, corresponding to test acc:                         0.7587628960609436 / 0.7587628960609436
after epoch: 6,now: 2024-07-13 14:34:08.631890,epoch time: 0:18:26.063811,used: 1:49:01.039345,model: dset_te_center0_dann_b44271c83_not_commited_2024md_07md_13_12_45_07_seed_0_21955598
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9933128, 'precision': 0.9600824, 'recall': 0.96869326, 'specificity': 0.96869326, 'f1': 0.96434313, 'auroc': 0.99870986, 'binary_precision': 0.99698865, 'binary_recall': 0.9959777, 'binary_specificity': 0.9414088, 'binary_f1_score': 0.99648285}
confusion matrix:
      0      1
0  1430     89
1   119  29466
---- Validation: 
scalar performance:
{'acc': 0.8097826, 'precision': 0.83749723, 'recall': 0.81177485, 'specificity': 0.81177485, 'f1': 0.80645037, 'auroc': 0.9365907, 'binary_precision': 0.73722625, 'binary_recall': 0.9543307, 'binary_specificity': 0.669219, 'binary_f1_score': 0.83184624}
confusion matrix:
     0    1
0  437  216
1   29  606
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8103093, 'precision': 0.8203739, 'recall': 0.7978897, 'specificity': 0.7978897, 'f1': 0.8024055, 'auroc': 0.92211884, 'binary_precision': 0.7852564, 'binary_recall': 0.9074074, 'binary_specificity': 0.6883721, 'binary_f1_score': 0.8419244}
confusion matrix:
     0    1
0  148   67
1   25  245
new oracle model saved
better model found
persisted
after epoch: 7,now: 2024-07-13 14:52:20.251781,epoch time: 0:18:11.619891,used: 2:07:12.659236,model: dset_te_center0_dann_b44271c83_not_commited_2024md_07md_13_12_45_07_seed_0_21955598
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9873328, 'precision': 0.98358893, 'recall': 0.87780374, 'specificity': 0.87780374, 'f1': 0.9235102, 'auroc': 0.99867177, 'binary_precision': 0.98763824, 'binary_recall': 0.9991888, 'binary_specificity': 0.7564187, 'binary_f1_score': 0.9933799}
confusion matrix:
      0      1
0  1149    370
1    24  29561
---- Validation: 
scalar performance:
{'acc': 0.56444097, 'precision': 0.760175, 'recall': 0.5704224, 'specificity': 0.5704224, 'f1': 0.4711355, 'auroc': 0.9293406, 'binary_precision': 0.5309883, 'binary_recall': 0.9984252, 'binary_specificity': 0.1424196, 'binary_f1_score': 0.69327503}
confusion matrix:
    0    1
0  93  560
1   1  634
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.58969074, 'precision': 0.78784645, 'recall': 0.5372093, 'specificity': 0.5372093, 'f1': 0.43462265, 'auroc': 0.9191128, 'binary_precision': 0.57569295, 'binary_recall': 1.0, 'binary_specificity': 0.074418604, 'binary_f1_score': 0.7307172}
confusion matrix:
    0    1
0  16  199
1   0  270
early stop counter: 1
val acc:0.5644409656524658, best validation acc: 0.8097826242446899, corresponding to test acc:                         0.8103092908859253 / 0.8103092908859253
after epoch: 8,now: 2024-07-13 15:10:27.587524,epoch time: 0:18:07.335743,used: 2:25:19.994979,model: dset_te_center0_dann_b44271c83_not_commited_2024md_07md_13_12_45_07_seed_0_21955598
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.99402004, 'precision': 0.96460533, 'recall': 0.97156316, 'specificity': 0.97156316, 'f1': 0.9680553, 'auroc': 0.9990195, 'binary_precision': 0.9972599, 'binary_recall': 0.9964509, 'binary_specificity': 0.9466754, 'binary_f1_score': 0.99685526}
confusion matrix:
      0      1
0  1438     81
1   105  29480
---- Validation: 
scalar performance:
{'acc': 0.8470497, 'precision': 0.8618089, 'recall': 0.8484632, 'specificity': 0.8484632, 'f1': 0.84582055, 'auroc': 0.93674624, 'binary_precision': 0.78515625, 'binary_recall': 0.9496063, 'binary_specificity': 0.74732006, 'binary_f1_score': 0.8595866}
confusion matrix:
     0    1
0  488  165
1   32  603
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8268041, 'precision': 0.83117396, 'recall': 0.81791556, 'specificity': 0.81791556, 'f1': 0.8215787, 'auroc': 0.8994143, 'binary_precision': 0.81208056, 'binary_recall': 0.8962963, 'binary_specificity': 0.73953485, 'binary_f1_score': 0.85211265}
confusion matrix:
     0    1
0  159   56
1   28  242
new oracle model saved
better model found
persisted
after epoch: 9,now: 2024-07-13 15:28:17.196836,epoch time: 0:17:49.609312,used: 2:43:09.604291,model: dset_te_center0_dann_b44271c83_not_commited_2024md_07md_13_12_45_07_seed_0_21955598
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.99463093, 'precision': 0.9743315, 'recall': 0.9675126, 'specificity': 0.9675126, 'f1': 0.97089446, 'auroc': 0.9992355, 'binary_precision': 0.9967914, 'binary_recall': 0.99756634, 'binary_specificity': 0.9374589, 'binary_f1_score': 0.9971787}
confusion matrix:
      0      1
0  1424     95
1    72  29513
---- Validation: 
scalar performance:
{'acc': 0.84782606, 'precision': 0.86333406, 'recall': 0.8492723, 'specificity': 0.8492723, 'f1': 0.84653807, 'auroc': 0.9431057, 'binary_precision': 0.7846952, 'binary_recall': 0.9527559, 'binary_specificity': 0.7457887, 'binary_f1_score': 0.8605975}
confusion matrix:
     0    1
0  487  166
1   30  605
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.85360825, 'precision': 0.85456145, 'recall': 0.84814817, 'specificity': 0.84814817, 'f1': 0.8504939, 'auroc': 0.9343841, 'binary_precision': 0.8491228, 'binary_recall': 0.8962963, 'binary_specificity': 0.8, 'binary_f1_score': 0.8720721}
confusion matrix:
     0    1
0  172   43
1   28  242
new oracle model saved
better model found
persisted
after epoch: 10,now: 2024-07-13 15:45:54.680094,epoch time: 0:17:37.483258,used: 3:00:47.087549,model: dset_te_center0_dann_b44271c83_not_commited_2024md_07md_13_12_45_07_seed_0_21955598
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9945666, 'precision': 0.97775275, 'recall': 0.9631071, 'specificity': 0.9631071, 'f1': 0.9703028, 'auroc': 0.99923235, 'binary_precision': 0.9963218, 'binary_recall': 0.99797195, 'binary_specificity': 0.92824227, 'binary_f1_score': 0.9971462}
confusion matrix:
      0      1
0  1410    109
1    60  29525
---- Validation: 
scalar performance:
{'acc': 0.753882, 'precision': 0.8157338, 'recall': 0.7569486, 'specificity': 0.7569486, 'f1': 0.74265707, 'auroc': 0.94375086, 'binary_precision': 0.6724512, 'binary_recall': 0.97637796, 'binary_specificity': 0.53751916, 'binary_f1_score': 0.79640335}
confusion matrix:
     0    1
0  351  302
1   15  620
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7876289, 'precision': 0.81687844, 'recall': 0.7680448, 'specificity': 0.7680448, 'f1': 0.77225786, 'auroc': 0.9336951, 'binary_precision': 0.74486804, 'binary_recall': 0.94074076, 'binary_specificity': 0.59534883, 'binary_f1_score': 0.8314238}
confusion matrix:
     0    1
0  128   87
1   16  254
early stop counter: 1
val acc:0.7538819909095764, best validation acc: 0.8478260636329651, corresponding to test acc:                         0.853608250617981 / 0.853608250617981
after epoch: 11,now: 2024-07-13 16:03:39.476183,epoch time: 0:17:44.796089,used: 3:18:31.883638,model: dset_te_center0_dann_b44271c83_not_commited_2024md_07md_13_12_45_07_seed_0_21955598
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.99408436, 'precision': 0.9580361, 'recall': 0.9803175, 'specificity': 0.9803175, 'f1': 0.9688802, 'auroc': 0.9991175, 'binary_precision': 0.99820393, 'binary_recall': 0.9955724, 'binary_specificity': 0.9650626, 'binary_f1_score': 0.9968864}
confusion matrix:
      0      1
0  1464     53
1   131  29456
---- Validation: 
scalar performance:
{'acc': 0.8913044, 'precision': 0.893715, 'recall': 0.8918691, 'specificity': 0.8918691, 'f1': 0.8912194, 'auroc': 0.94544864, 'binary_precision': 0.8592163, 'binary_recall': 0.93228346, 'binary_specificity': 0.8514548, 'binary_f1_score': 0.89425987}
confusion matrix:
     0    1
0  556   97
1   43  592
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8845361, 'precision': 0.8834473, 'recall': 0.88824284, 'specificity': 0.88824284, 'f1': 0.8839991, 'auroc': 0.9360379, 'binary_precision': 0.9314516, 'binary_recall': 0.85555553, 'binary_specificity': 0.9209302, 'binary_f1_score': 0.89189196}
confusion matrix:
     0    1
0  198   17
1   39  231
new oracle model saved
better model found
persisted
after epoch: 12,now: 2024-07-13 16:21:22.703582,epoch time: 0:17:43.227399,used: 3:36:15.111037,model: dset_te_center0_dann_b44271c83_not_commited_2024md_07md_13_12_45_07_seed_0_21955598
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.99427724, 'precision': 0.9742398, 'recall': 0.96355635, 'specificity': 0.96355635, 'f1': 0.96883017, 'auroc': 0.99826133, 'binary_precision': 0.99638784, 'binary_recall': 0.9976002, 'binary_specificity': 0.9295125, 'binary_f1_score': 0.9969936}
confusion matrix:
      0      1
0  1411    107
1    71  29515
---- Validation: 
scalar performance:
{'acc': 0.8097826, 'precision': 0.8381528, 'recall': 0.81179655, 'specificity': 0.81179655, 'f1': 0.80636966, 'auroc': 0.9367806, 'binary_precision': 0.73665047, 'binary_recall': 0.9559055, 'binary_specificity': 0.6676876, 'binary_f1_score': 0.8320768}
confusion matrix:
     0    1
0  436  217
1   28  607
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8556701, 'precision': 0.8540113, 'recall': 0.8533161, 'specificity': 0.8533161, 'f1': 0.85364866, 'auroc': 0.92649436, 'binary_precision': 0.86764705, 'binary_recall': 0.8740741, 'binary_specificity': 0.83255816, 'binary_f1_score': 0.8708487}
confusion matrix:
     0    1
0  179   36
1   34  236
early stop counter: 1
val acc:0.8097826242446899, best validation acc: 0.8913043737411499, corresponding to test acc:                         0.88453608751297 / 0.88453608751297
after epoch: 13,now: 2024-07-13 16:39:13.653770,epoch time: 0:17:50.950188,used: 3:54:06.061225,model: dset_te_center0_dann_b44271c83_not_commited_2024md_07md_13_12_45_07_seed_0_21955598
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9944702, 'precision': 0.9690864, 'recall': 0.97143424, 'specificity': 0.97143424, 'f1': 0.97025704, 'auroc': 0.9992577, 'binary_precision': 0.99722785, 'binary_recall': 0.99695826, 'binary_specificity': 0.9459103, 'binary_f1_score': 0.99709296}
confusion matrix:
      0      1
0  1434     82
1    90  29498
---- Validation: 
scalar performance:
{'acc': 0.85170805, 'precision': 0.8618932, 'recall': 0.8528837, 'specificity': 0.8528837, 'f1': 0.8509309, 'auroc': 0.9433409, 'binary_precision': 0.79758716, 'binary_recall': 0.93700784, 'binary_specificity': 0.76875955, 'binary_f1_score': 0.86169446}
confusion matrix:
     0    1
0  502  151
1   40  595
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8742268, 'precision': 0.8757061, 'recall': 0.88040483, 'specificity': 0.88040483, 'f1': 0.8739675, 'auroc': 0.9321275, 'binary_precision': 0.9409283, 'binary_recall': 0.82592595, 'binary_specificity': 0.9348837, 'binary_f1_score': 0.87968445}
confusion matrix:
     0    1
0  201   14
1   47  223
early stop counter: 2
val acc:0.8517080545425415, best validation acc: 0.8913043737411499, corresponding to test acc:                         0.88453608751297 / 0.88453608751297
after epoch: 14,now: 2024-07-13 16:56:58.065734,epoch time: 0:17:44.411964,used: 4:11:50.473189,model: dset_te_center0_dann_b44271c83_not_commited_2024md_07md_13_12_45_07_seed_0_21955598
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.994213, 'precision': 0.98074275, 'recall': 0.9560514, 'specificity': 0.9560514, 'f1': 0.9680345, 'auroc': 0.9989555, 'binary_precision': 0.9955843, 'binary_recall': 0.99834377, 'binary_specificity': 0.91375905, 'binary_f1_score': 0.99696213}
confusion matrix:
      0      1
0  1388    131
1    49  29536
---- Validation: 
scalar performance:
{'acc': 0.867236, 'precision': 0.87485397, 'recall': 0.8682411, 'specificity': 0.8682411, 'f1': 0.8667599, 'auroc': 0.9430599, 'binary_precision': 0.8178082, 'binary_recall': 0.9401575, 'binary_specificity': 0.7963247, 'binary_f1_score': 0.8747253}
confusion matrix:
     0    1
0  520  133
1   38  597
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.85979384, 'precision': 0.8579098, 'recall': 0.8617571, 'specificity': 0.8617571, 'f1': 0.85888135, 'auroc': 0.93271315, 'binary_precision': 0.8976378, 'binary_recall': 0.84444445, 'binary_specificity': 0.87906975, 'binary_f1_score': 0.870229}
confusion matrix:
     0    1
0  189   26
1   42  228
early stop counter: 3
val acc:0.8672360181808472, best validation acc: 0.8913043737411499, corresponding to test acc:                         0.88453608751297 / 0.88453608751297
after epoch: 15,now: 2024-07-13 17:14:37.621962,epoch time: 0:17:39.556228,used: 4:29:30.029417,model: dset_te_center0_dann_b44271c83_not_commited_2024md_07md_13_12_45_07_seed_0_21955598
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9941165, 'precision': 0.9831412, 'recall': 0.95253503, 'specificity': 0.95253503, 'f1': 0.96728086, 'auroc': 0.9991865, 'binary_precision': 0.9952168, 'binary_recall': 0.9986142, 'binary_specificity': 0.9064559, 'binary_f1_score': 0.9969126}
confusion matrix:
      0      1
0  1376    142
1    41  29545
---- Validation: 
scalar performance:
{'acc': 0.8338509, 'precision': 0.85922205, 'recall': 0.83570683, 'specificity': 0.83570683, 'f1': 0.83137727, 'auroc': 0.95180815, 'binary_precision': 0.76019776, 'binary_recall': 0.96850395, 'binary_specificity': 0.70290965, 'binary_f1_score': 0.8518005}
confusion matrix:
     0    1
0  459  194
1   20  615
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.85360825, 'precision': 0.85811776, 'recall': 0.84577954, 'specificity': 0.84577954, 'f1': 0.8495138, 'auroc': 0.9487338, 'binary_precision': 0.83728814, 'binary_recall': 0.91481483, 'binary_specificity': 0.7767442, 'binary_f1_score': 0.8743363}
confusion matrix:
     0    1
0  167   48
1   23  247
early stop counter: 4
val acc:0.8338509202003479, best validation acc: 0.8913043737411499, corresponding to test acc:                         0.88453608751297 / 0.88453608751297
after epoch: 16,now: 2024-07-13 17:32:19.187588,epoch time: 0:17:41.565626,used: 4:47:11.595043,model: dset_te_center0_dann_b44271c83_not_commited_2024md_07md_13_12_45_07_seed_0_21955598
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9943094, 'precision': 0.96600723, 'recall': 0.9732766, 'specificity': 0.9732766, 'f1': 0.96961045, 'auroc': 0.99920595, 'binary_precision': 0.99742895, 'binary_recall': 0.9965861, 'binary_specificity': 0.9499671, 'binary_f1_score': 0.99700737}
confusion matrix:
      0      1
0  1443     76
1   101  29484
---- Validation: 
scalar performance:
{'acc': 0.88509315, 'precision': 0.8895043, 'recall': 0.8858521, 'specificity': 0.8858521, 'f1': 0.88489085, 'auroc': 0.95000184, 'binary_precision': 0.84441304, 'binary_recall': 0.9401575, 'binary_specificity': 0.8315467, 'binary_f1_score': 0.88971686}
confusion matrix:
     0    1
0  543  110
1   38  597
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8659794, 'precision': 0.86402386, 'recall': 0.8677864, 'specificity': 0.8677864, 'f1': 0.8650615, 'auroc': 0.9327649, 'binary_precision': 0.9019608, 'binary_recall': 0.8518519, 'binary_specificity': 0.88372093, 'binary_f1_score': 0.8761905}
confusion matrix:
     0    1
0  190   25
1   40  230
early stop counter: 5
val acc:0.8850931525230408, best validation acc: 0.8913043737411499, corresponding to test acc:                         0.88453608751297 / 0.88453608751297
after epoch: 17,now: 2024-07-13 17:50:02.293068,epoch time: 0:17:43.105480,used: 5:04:54.700523,model: dset_te_center0_dann_b44271c83_not_commited_2024md_07md_13_12_45_07_seed_0_21955598
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 17 with time: 5:04:54.700523 at 2024-07-13 17:50:02.293068
persisted model performance metric: 

scalar performance:
{'acc': 0.8845361, 'precision': 0.8834473, 'recall': 0.88824284, 'specificity': 0.88824284, 'f1': 0.8839991, 'auroc': 0.9360379, 'binary_precision': 0.9314516, 'binary_recall': 0.85555553, 'binary_specificity': 0.9209302, 'binary_f1_score': 0.89189196}
confusion matrix:
     0    1
0  198   17
1   39  231
oracle model performance metric: 

scalar performance:
{'acc': 0.8845361, 'precision': 0.8834473, 'recall': 0.88824284, 'specificity': 0.88824284, 'f1': 0.8839991, 'auroc': 0.9360379, 'binary_precision': 0.9314516, 'binary_recall': 0.85555553, 'binary_specificity': 0.9209302, 'binary_f1_score': 0.89189196}
confusion matrix:
     0    1
0  198   17
1   39  231
results aggregation path: zoutput/benchmarks/CAMELYONWILD_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_halffreeze/rule_results/7.csv
results aggregation path: zoutput/benchmarks/CAMELYONWILD_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_halffreeze/rule_results/7.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONWILD_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_halffreeze/confusion_matrix/7.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 319979 KiB |   1933 MiB | 418203 GiB | 418203 GiB |
|       from large pool | 292783 KiB |   1909 MiB | 412540 GiB | 412540 GiB |
|       from small pool |  27195 KiB |     43 MiB |   5663 GiB |   5663 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 319979 KiB |   1933 MiB | 418203 GiB | 418203 GiB |
|       from large pool | 292783 KiB |   1909 MiB | 412540 GiB | 412540 GiB |
|       from small pool |  27195 KiB |     43 MiB |   5663 GiB |   5663 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 313851 KiB |   1929 MiB | 418008 GiB | 418008 GiB |
|       from large pool | 286862 KiB |   1906 MiB | 412354 GiB | 412353 GiB |
|       from small pool |  26989 KiB |     43 MiB |   5654 GiB |   5654 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2190 MiB |   2190 MiB |   2190 MiB |      0 B   |
|       from large pool |   2140 MiB |   2140 MiB |   2140 MiB |      0 B   |
|       from small pool |     50 MiB |     50 MiB |     50 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory | 187925 KiB | 275970 KiB | 284797 GiB | 284797 GiB |
|       from large pool | 182352 KiB | 271529 KiB | 279049 GiB | 279049 GiB |
|       from small pool |   5572 KiB |   9119 KiB |   5747 GiB |   5747 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    1084    |    4635    |   72829 K  |   72828 K  |
|       from large pool |     130    |     276    |   38547 K  |   38546 K  |
|       from small pool |     954    |    4504    |   34282 K  |   34281 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    1084    |    4635    |   72829 K  |   72828 K  |
|       from large pool |     130    |     276    |   38547 K  |   38546 K  |
|       from small pool |     954    |    4504    |   34282 K  |   34281 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     114    |     114    |     114    |       0    |
|       from large pool |      89    |      89    |      89    |       0    |
|       from small pool |      25    |      25    |      25    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      63    |    1975    |   39956 K  |   39956 K  |
|       from large pool |      19    |      87    |   24520 K  |   24520 K  |
|       from small pool |      44    |    1956    |   15436 K  |   15436 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   1933 MiB | 418203 GiB | 418203 GiB |
|       from large pool |  16640 KiB |   1909 MiB | 412540 GiB | 412540 GiB |
|       from small pool |      0 KiB |     43 MiB |   5663 GiB |   5663 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   1933 MiB | 418203 GiB | 418203 GiB |
|       from large pool |  16640 KiB |   1909 MiB | 412540 GiB | 412540 GiB |
|       from small pool |      0 KiB |     43 MiB |   5663 GiB |   5663 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   1929 MiB | 418008 GiB | 418008 GiB |
|       from large pool |  16640 KiB |   1906 MiB | 412354 GiB | 412354 GiB |
|       from small pool |      0 KiB |     43 MiB |   5654 GiB |   5654 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 507904 KiB |   2190 MiB |   2190 MiB |   1694 MiB |
|       from large pool | 475136 KiB |   2140 MiB |   2140 MiB |   1676 MiB |
|       from small pool |  32768 KiB |     50 MiB |     50 MiB |     18 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 275970 KiB | 284797 GiB | 284797 GiB |
|       from large pool |  24320 KiB | 271529 KiB | 279049 GiB | 279049 GiB |
|       from small pool |      0 KiB |  23654 KiB |   5747 GiB |   5747 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    4635    |   72829 K  |   72829 K  |
|       from large pool |       2    |     276    |   38547 K  |   38547 K  |
|       from small pool |       0    |    4504    |   34282 K  |   34282 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    4635    |   72829 K  |   72829 K  |
|       from large pool |       2    |     276    |   38547 K  |   38547 K  |
|       from small pool |       0    |    4504    |   34282 K  |   34282 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      38    |     114    |     114    |      76    |
|       from large pool |      22    |      89    |      89    |      67    |
|       from small pool |      16    |      25    |      25    |       9    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    1975    |   39956 K  |   39956 K  |
|       from large pool |       3    |      87    |   24520 K  |   24520 K  |
|       from small pool |       0    |    1956    |   15436 K  |   15436 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   1933 MiB | 418203 GiB | 418203 GiB |
|       from large pool |  16640 KiB |   1909 MiB | 412540 GiB | 412540 GiB |
|       from small pool |      0 KiB |     43 MiB |   5663 GiB |   5663 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   1933 MiB | 418203 GiB | 418203 GiB |
|       from large pool |  16640 KiB |   1909 MiB | 412540 GiB | 412540 GiB |
|       from small pool |      0 KiB |     43 MiB |   5663 GiB |   5663 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   1929 MiB | 418008 GiB | 418008 GiB |
|       from large pool |  16640 KiB |   1906 MiB | 412354 GiB | 412354 GiB |
|       from small pool |      0 KiB |     43 MiB |   5654 GiB |   5654 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 507904 KiB |   2190 MiB |   2190 MiB |   1694 MiB |
|       from large pool | 475136 KiB |   2140 MiB |   2140 MiB |   1676 MiB |
|       from small pool |  32768 KiB |     50 MiB |     50 MiB |     18 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 275970 KiB | 284797 GiB | 284797 GiB |
|       from large pool |  24320 KiB | 271529 KiB | 279049 GiB | 279049 GiB |
|       from small pool |      0 KiB |  23654 KiB |   5747 GiB |   5747 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    4635    |   72829 K  |   72829 K  |
|       from large pool |       2    |     276    |   38547 K  |   38547 K  |
|       from small pool |       0    |    4504    |   34282 K  |   34282 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    4635    |   72829 K  |   72829 K  |
|       from large pool |       2    |     276    |   38547 K  |   38547 K  |
|       from small pool |       0    |    4504    |   34282 K  |   34282 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      38    |     114    |     114    |      76    |
|       from large pool |      22    |      89    |      89    |      67    |
|       from small pool |      16    |      25    |      25    |       9    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    1975    |   39956 K  |   39956 K  |
|       from large pool |       3    |      87    |   24520 K  |   24520 K  |
|       from small pool |       0    |    1956    |   15436 K  |   15436 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_dann_b44271c83_not_commited_2024md_07md_13_18_03_05_seed_1_21955598

 Experiment start at: 2024-07-13 18:03:06.032275
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.951275, 'precision': 0.4756375, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4875146, 'auroc': 0.9882462, 'binary_precision': 0.951275, 'binary_recall': 1.0, 'binary_specificity': 0.0, 'binary_f1_score': 0.9750292}
confusion matrix:
   0      1
0  0   1521
1  0  29695
---- Validation: 
scalar performance:
{'acc': 0.4918033, 'precision': 0.24590164, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.32967034, 'auroc': 0.91545117, 'binary_precision': 0.4918033, 'binary_recall': 1.0, 'binary_specificity': 0.0, 'binary_f1_score': 0.6593407}
confusion matrix:
   0    1
0  0  651
1  0  630
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
scalar performance:
{'acc': 0.5292887, 'precision': 0.26464435, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.34610122, 'auroc': 0.90965307, 'binary_precision': 0.5292887, 'binary_recall': 1.0, 'binary_specificity': 0.0, 'binary_f1_score': 0.69220245}
confusion matrix:
   0    1
0  0  225
1  0  253
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-13 18:20:55.212064,epoch time: 0:17:49.179789,used: 0:17:49.179789,model: dset_te_center0_dann_b44271c83_not_commited_2024md_07md_13_18_03_05_seed_1_21955598
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.951275, 'precision': 0.4756375, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4875146, 'auroc': 0.9880059, 'binary_precision': 0.951275, 'binary_recall': 1.0, 'binary_specificity': 0.0, 'binary_f1_score': 0.9750292}
confusion matrix:
   0      1
0  0   1521
1  0  29695
---- Validation: 
scalar performance:
{'acc': 0.4918033, 'precision': 0.24590164, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.32967034, 'auroc': 0.9031453, 'binary_precision': 0.4918033, 'binary_recall': 1.0, 'binary_specificity': 0.0, 'binary_f1_score': 0.6593407}
confusion matrix:
   0    1
0  0  651
1  0  630
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5292887, 'precision': 0.26464435, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.34610122, 'auroc': 0.8991655, 'binary_precision': 0.5292887, 'binary_recall': 1.0, 'binary_specificity': 0.0, 'binary_f1_score': 0.69220245}
confusion matrix:
   0    1
0  0  225
1  0  253
early stop counter: 1
val acc:0.49180328845977783, best validation acc: 0.49180328845977783, corresponding to test acc:                         0.5292887091636658 / 0.5292887091636658
after epoch: 2,now: 2024-07-13 18:38:39.338416,epoch time: 0:17:44.126352,used: 0:35:33.306141,model: dset_te_center0_dann_b44271c83_not_commited_2024md_07md_13_18_03_05_seed_1_21955598
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.951275, 'precision': 0.4756375, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4875146, 'auroc': 0.9966113, 'binary_precision': 0.951275, 'binary_recall': 1.0, 'binary_specificity': 0.0, 'binary_f1_score': 0.9750292}
confusion matrix:
   0      1
0  0   1521
1  0  29695
---- Validation: 
scalar performance:
{'acc': 0.4918033, 'precision': 0.24590164, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.32967034, 'auroc': 0.94048107, 'binary_precision': 0.4918033, 'binary_recall': 1.0, 'binary_specificity': 0.0, 'binary_f1_score': 0.6593407}
confusion matrix:
   0    1
0  0  651
1  0  630
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5292887, 'precision': 0.26464435, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.34610122, 'auroc': 0.9279666, 'binary_precision': 0.5292887, 'binary_recall': 1.0, 'binary_specificity': 0.0, 'binary_f1_score': 0.69220245}
confusion matrix:
   0    1
0  0  225
1  0  253
early stop counter: 2
val acc:0.49180328845977783, best validation acc: 0.49180328845977783, corresponding to test acc:                         0.5292887091636658 / 0.5292887091636658
after epoch: 3,now: 2024-07-13 18:56:23.652318,epoch time: 0:17:44.313902,used: 0:53:17.620043,model: dset_te_center0_dann_b44271c83_not_commited_2024md_07md_13_18_03_05_seed_1_21955598
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.951307, 'precision': 0.4756535, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48752296, 'auroc': 0.9840826, 'binary_precision': 0.951307, 'binary_recall': 1.0, 'binary_specificity': 0.0, 'binary_f1_score': 0.9750459}
confusion matrix:
   0      1
0  0   1520
1  0  29696
---- Validation: 
scalar performance:
{'acc': 0.4918033, 'precision': 0.24590164, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.32967034, 'auroc': 0.85625046, 'binary_precision': 0.4918033, 'binary_recall': 1.0, 'binary_specificity': 0.0, 'binary_f1_score': 0.6593407}
confusion matrix:
   0    1
0  0  651
1  0  630
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5292887, 'precision': 0.26464435, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.34610122, 'auroc': 0.8527888, 'binary_precision': 0.5292887, 'binary_recall': 1.0, 'binary_specificity': 0.0, 'binary_f1_score': 0.69220245}
confusion matrix:
   0    1
0  0  225
1  0  253
early stop counter: 3
val acc:0.49180328845977783, best validation acc: 0.49180328845977783, corresponding to test acc:                         0.5292887091636658 / 0.5292887091636658
after epoch: 4,now: 2024-07-13 19:14:07.537515,epoch time: 0:17:43.885197,used: 1:11:01.505240,model: dset_te_center0_dann_b44271c83_not_commited_2024md_07md_13_18_03_05_seed_1_21955598
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.951275, 'precision': 0.4756375, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4875146, 'auroc': 0.99274635, 'binary_precision': 0.951275, 'binary_recall': 1.0, 'binary_specificity': 0.0, 'binary_f1_score': 0.9750292}
confusion matrix:
   0      1
0  0   1521
1  0  29695
---- Validation: 
scalar performance:
{'acc': 0.4918033, 'precision': 0.24590164, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.32967034, 'auroc': 0.903772, 'binary_precision': 0.4918033, 'binary_recall': 1.0, 'binary_specificity': 0.0, 'binary_f1_score': 0.6593407}
confusion matrix:
   0    1
0  0  651
1  0  630
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5292887, 'precision': 0.26464435, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.34610122, 'auroc': 0.88490117, 'binary_precision': 0.5292887, 'binary_recall': 1.0, 'binary_specificity': 0.0, 'binary_f1_score': 0.69220245}
confusion matrix:
   0    1
0  0  225
1  0  253
early stop counter: 4
val acc:0.49180328845977783, best validation acc: 0.49180328845977783, corresponding to test acc:                         0.5292887091636658 / 0.5292887091636658
after epoch: 5,now: 2024-07-13 19:31:53.630303,epoch time: 0:17:46.092788,used: 1:28:47.598028,model: dset_te_center0_dann_b44271c83_not_commited_2024md_07md_13_18_03_05_seed_1_21955598
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.951275, 'precision': 0.4756375, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4875146, 'auroc': 0.9836513, 'binary_precision': 0.951275, 'binary_recall': 1.0, 'binary_specificity': 0.0, 'binary_f1_score': 0.9750292}
confusion matrix:
   0      1
0  0   1521
1  0  29695
---- Validation: 
scalar performance:
{'acc': 0.4918033, 'precision': 0.24590164, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.32967034, 'auroc': 0.89211714, 'binary_precision': 0.4918033, 'binary_recall': 1.0, 'binary_specificity': 0.0, 'binary_f1_score': 0.6593407}
confusion matrix:
   0    1
0  0  651
1  0  630
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5292887, 'precision': 0.26464435, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.34610122, 'auroc': 0.87597716, 'binary_precision': 0.5292887, 'binary_recall': 1.0, 'binary_specificity': 0.0, 'binary_f1_score': 0.69220245}
confusion matrix:
   0    1
0  0  225
1  0  253
early stop counter: 5
val acc:0.49180328845977783, best validation acc: 0.49180328845977783, corresponding to test acc:                         0.5292887091636658 / 0.5292887091636658
after epoch: 6,now: 2024-07-13 19:49:42.492208,epoch time: 0:17:48.861905,used: 1:46:36.459933,model: dset_te_center0_dann_b44271c83_not_commited_2024md_07md_13_18_03_05_seed_1_21955598
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 6 with time: 1:46:36.459933 at 2024-07-13 19:49:42.492208
persisted model performance metric: 

scalar performance:
{'acc': 0.5292887, 'precision': 0.26464435, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.34610122, 'auroc': 0.90965307, 'binary_precision': 0.5292887, 'binary_recall': 1.0, 'binary_specificity': 0.0, 'binary_f1_score': 0.69220245}
confusion matrix:
   0    1
0  0  225
1  0  253
oracle model performance metric: 

scalar performance:
{'acc': 0.5292887, 'precision': 0.26464435, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.34610122, 'auroc': 0.90965307, 'binary_precision': 0.5292887, 'binary_recall': 1.0, 'binary_specificity': 0.0, 'binary_f1_score': 0.69220245}
confusion matrix:
   0    1
0  0  225
1  0  253
results aggregation path: zoutput/benchmarks/CAMELYONWILD_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_halffreeze/rule_results/7.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONWILD_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_halffreeze/confusion_matrix/7.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 318718 KiB |   1933 MiB | 569639 GiB | 569639 GiB |
|       from large pool | 291525 KiB |   1909 MiB | 561902 GiB | 561902 GiB |
|       from small pool |  27192 KiB |     43 MiB |   7736 GiB |   7736 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 318718 KiB |   1933 MiB | 569639 GiB | 569639 GiB |
|       from large pool | 291525 KiB |   1909 MiB | 561902 GiB | 561902 GiB |
|       from small pool |  27192 KiB |     43 MiB |   7736 GiB |   7736 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 313851 KiB |   1929 MiB | 569363 GiB | 569363 GiB |
|       from large pool | 286862 KiB |   1906 MiB | 561638 GiB | 561638 GiB |
|       from small pool |  26989 KiB |     43 MiB |   7725 GiB |   7725 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2198 MiB |   2198 MiB |   3892 MiB |   1694 MiB |
|       from large pool |   2148 MiB |   2148 MiB |   3824 MiB |   1676 MiB |
|       from small pool |     50 MiB |     50 MiB |     68 MiB |     18 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 197378 KiB | 275970 KiB | 388243 GiB | 388243 GiB |
|       from large pool | 189754 KiB | 271529 KiB | 380392 GiB | 380391 GiB |
|       from small pool |   7623 KiB |  23654 KiB |   7851 GiB |   7851 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    1078    |    4649    |   99095 K  |   99094 K  |
|       from large pool |     130    |     276    |   52517 K  |   52517 K  |
|       from small pool |     948    |    4518    |   46578 K  |   46577 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    1078    |    4649    |   99095 K  |   99094 K  |
|       from large pool |     130    |     276    |   52517 K  |   52517 K  |
|       from small pool |     948    |    4518    |   46578 K  |   46577 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     115    |     115    |     191    |      76    |
|       from large pool |      90    |      90    |     157    |      67    |
|       from small pool |      25    |      25    |      34    |       9    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      71    |    1986    |   53822 K  |   53822 K  |
|       from large pool |      25    |      91    |   32973 K  |   32973 K  |
|       from small pool |      46    |    1961    |   20849 K  |   20849 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   1933 MiB | 569639 GiB | 569639 GiB |
|       from large pool |  16640 KiB |   1909 MiB | 561902 GiB | 561902 GiB |
|       from small pool |      0 KiB |     43 MiB |   7736 GiB |   7736 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   1933 MiB | 569639 GiB | 569639 GiB |
|       from large pool |  16640 KiB |   1909 MiB | 561902 GiB | 561902 GiB |
|       from small pool |      0 KiB |     43 MiB |   7736 GiB |   7736 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   1929 MiB | 569363 GiB | 569363 GiB |
|       from large pool |  16640 KiB |   1906 MiB | 561638 GiB | 561638 GiB |
|       from small pool |      0 KiB |     43 MiB |   7725 GiB |   7725 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 516096 KiB |   2198 MiB |   3892 MiB |   3388 MiB |
|       from large pool | 481280 KiB |   2148 MiB |   3824 MiB |   3354 MiB |
|       from small pool |  34816 KiB |     50 MiB |     68 MiB |     34 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 275970 KiB | 388244 GiB | 388244 GiB |
|       from large pool |  24320 KiB | 271529 KiB | 380392 GiB | 380392 GiB |
|       from small pool |      0 KiB |  23654 KiB |   7851 GiB |   7851 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    4649    |   99095 K  |   99095 K  |
|       from large pool |       2    |     276    |   52517 K  |   52517 K  |
|       from small pool |       0    |    4518    |   46578 K  |   46578 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    4649    |   99095 K  |   99095 K  |
|       from large pool |       2    |     276    |   52517 K  |   52517 K  |
|       from small pool |       0    |    4518    |   46578 K  |   46578 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      39    |     115    |     191    |     152    |
|       from large pool |      22    |      90    |     157    |     135    |
|       from small pool |      17    |      25    |      34    |      17    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    1986    |   53822 K  |   53822 K  |
|       from large pool |       3    |      91    |   32973 K  |   32973 K  |
|       from small pool |       0    |    1961    |   20849 K  |   20849 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   1933 MiB | 569639 GiB | 569639 GiB |
|       from large pool |  16640 KiB |   1909 MiB | 561902 GiB | 561902 GiB |
|       from small pool |      0 KiB |     43 MiB |   7736 GiB |   7736 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   1933 MiB | 569639 GiB | 569639 GiB |
|       from large pool |  16640 KiB |   1909 MiB | 561902 GiB | 561902 GiB |
|       from small pool |      0 KiB |     43 MiB |   7736 GiB |   7736 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   1929 MiB | 569363 GiB | 569363 GiB |
|       from large pool |  16640 KiB |   1906 MiB | 561638 GiB | 561638 GiB |
|       from small pool |      0 KiB |     43 MiB |   7725 GiB |   7725 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 516096 KiB |   2198 MiB |   3892 MiB |   3388 MiB |
|       from large pool | 481280 KiB |   2148 MiB |   3824 MiB |   3354 MiB |
|       from small pool |  34816 KiB |     50 MiB |     68 MiB |     34 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 275970 KiB | 388244 GiB | 388244 GiB |
|       from large pool |  24320 KiB | 271529 KiB | 380392 GiB | 380392 GiB |
|       from small pool |      0 KiB |  23654 KiB |   7851 GiB |   7851 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    4649    |   99095 K  |   99095 K  |
|       from large pool |       2    |     276    |   52517 K  |   52517 K  |
|       from small pool |       0    |    4518    |   46578 K  |   46578 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    4649    |   99095 K  |   99095 K  |
|       from large pool |       2    |     276    |   52517 K  |   52517 K  |
|       from small pool |       0    |    4518    |   46578 K  |   46578 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      39    |     115    |     191    |     152    |
|       from large pool |      22    |      90    |     157    |     135    |
|       from small pool |      17    |      25    |      34    |      17    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    1986    |   53822 K  |   53822 K  |
|       from large pool |       3    |      91    |   32973 K  |   32973 K  |
|       from small pool |       0    |    1961    |   20849 K  |   20849 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_dann_b44271c83_not_commited_2024md_07md_13_20_02_49_seed_2_21955598

 Experiment start at: 2024-07-13 20:02:49.540670
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9516828, 'precision': 0.4758414, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48762167, 'auroc': 0.98599696, 'binary_precision': 0.9516828, 'binary_recall': 1.0, 'binary_specificity': 0.0, 'binary_f1_score': 0.97524333}
confusion matrix:
   0      1
0  0   1516
1  0  29860
---- Validation: 
scalar performance:
{'acc': 0.48669797, 'precision': 0.24334899, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.32736844, 'auroc': 0.90471834, 'binary_precision': 0.48669797, 'binary_recall': 1.0, 'binary_specificity': 0.0, 'binary_f1_score': 0.6547369}
confusion matrix:
   0    1
0  0  656
1  0  622
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
scalar performance:
{'acc': 0.5452632, 'precision': 0.2726316, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.35286105, 'auroc': 0.9184184, 'binary_precision': 0.5452632, 'binary_recall': 1.0, 'binary_specificity': 0.0, 'binary_f1_score': 0.7057221}
confusion matrix:
   0    1
0  0  216
1  0  259
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-13 20:20:43.525621,epoch time: 0:17:53.984951,used: 0:17:53.984951,model: dset_te_center0_dann_b44271c83_not_commited_2024md_07md_13_20_02_49_seed_2_21955598
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9516828, 'precision': 0.4758414, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48762167, 'auroc': 0.9946528, 'binary_precision': 0.9516828, 'binary_recall': 1.0, 'binary_specificity': 0.0, 'binary_f1_score': 0.97524333}
confusion matrix:
   0      1
0  0   1516
1  0  29860
---- Validation: 
scalar performance:
{'acc': 0.48669797, 'precision': 0.24334899, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.32736844, 'auroc': 0.9260341, 'binary_precision': 0.48669797, 'binary_recall': 1.0, 'binary_specificity': 0.0, 'binary_f1_score': 0.6547369}
confusion matrix:
   0    1
0  0  656
1  0  622
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5452632, 'precision': 0.2726316, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.35286105, 'auroc': 0.9260913, 'binary_precision': 0.5452632, 'binary_recall': 1.0, 'binary_specificity': 0.0, 'binary_f1_score': 0.7057221}
confusion matrix:
   0    1
0  0  216
1  0  259
early stop counter: 1
val acc:0.4866979718208313, best validation acc: 0.4866979718208313, corresponding to test acc:                         0.5452631711959839 / 0.5452631711959839
after epoch: 2,now: 2024-07-13 20:38:36.132118,epoch time: 0:17:52.606497,used: 0:35:46.591448,model: dset_te_center0_dann_b44271c83_not_commited_2024md_07md_13_20_02_49_seed_2_21955598
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9516828, 'precision': 0.4758414, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48762167, 'auroc': 0.9918622, 'binary_precision': 0.9516828, 'binary_recall': 1.0, 'binary_specificity': 0.0, 'binary_f1_score': 0.97524333}
confusion matrix:
   0      1
0  0   1516
1  0  29860
---- Validation: 
scalar performance:
{'acc': 0.48669797, 'precision': 0.24334899, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.32736844, 'auroc': 0.90755874, 'binary_precision': 0.48669797, 'binary_recall': 1.0, 'binary_specificity': 0.0, 'binary_f1_score': 0.6547369}
confusion matrix:
   0    1
0  0  656
1  0  622
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5452632, 'precision': 0.2726316, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.35286105, 'auroc': 0.91267157, 'binary_precision': 0.5452632, 'binary_recall': 1.0, 'binary_specificity': 0.0, 'binary_f1_score': 0.7057221}
confusion matrix:
   0    1
0  0  216
1  0  259
early stop counter: 2
val acc:0.4866979718208313, best validation acc: 0.4866979718208313, corresponding to test acc:                         0.5452631711959839 / 0.5452631711959839
after epoch: 3,now: 2024-07-13 20:56:31.993288,epoch time: 0:17:55.861170,used: 0:53:42.452618,model: dset_te_center0_dann_b44271c83_not_commited_2024md_07md_13_20_02_49_seed_2_21955598
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9516828, 'precision': 0.4758414, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48762167, 'auroc': 0.9935982, 'binary_precision': 0.9516828, 'binary_recall': 1.0, 'binary_specificity': 0.0, 'binary_f1_score': 0.97524333}
confusion matrix:
   0      1
0  0   1516
1  0  29860
---- Validation: 
scalar performance:
{'acc': 0.48669797, 'precision': 0.24334899, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.32736844, 'auroc': 0.9073461, 'binary_precision': 0.48669797, 'binary_recall': 1.0, 'binary_specificity': 0.0, 'binary_f1_score': 0.6547369}
confusion matrix:
   0    1
0  0  656
1  0  622
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5452632, 'precision': 0.2726316, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.35286105, 'auroc': 0.91620195, 'binary_precision': 0.5452632, 'binary_recall': 1.0, 'binary_specificity': 0.0, 'binary_f1_score': 0.7057221}
confusion matrix:
   0    1
0  0  216
1  0  259
early stop counter: 3
val acc:0.4866979718208313, best validation acc: 0.4866979718208313, corresponding to test acc:                         0.5452631711959839 / 0.5452631711959839
after epoch: 4,now: 2024-07-13 21:14:27.082623,epoch time: 0:17:55.089335,used: 1:11:37.541953,model: dset_te_center0_dann_b44271c83_not_commited_2024md_07md_13_20_02_49_seed_2_21955598
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9516828, 'precision': 0.4758414, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48762167, 'auroc': 0.99639773, 'binary_precision': 0.9516828, 'binary_recall': 1.0, 'binary_specificity': 0.0, 'binary_f1_score': 0.97524333}
confusion matrix:
   0      1
0  0   1516
1  0  29860
---- Validation: 
scalar performance:
{'acc': 0.48669797, 'precision': 0.24334899, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.32736844, 'auroc': 0.91109586, 'binary_precision': 0.48669797, 'binary_recall': 1.0, 'binary_specificity': 0.0, 'binary_f1_score': 0.6547369}
confusion matrix:
   0    1
0  0  656
1  0  622
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5452632, 'precision': 0.2726316, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.35286105, 'auroc': 0.9004898, 'binary_precision': 0.5452632, 'binary_recall': 1.0, 'binary_specificity': 0.0, 'binary_f1_score': 0.7057221}
confusion matrix:
   0    1
0  0  216
1  0  259
early stop counter: 4
val acc:0.4866979718208313, best validation acc: 0.4866979718208313, corresponding to test acc:                         0.5452631711959839 / 0.5452631711959839
after epoch: 5,now: 2024-07-13 21:32:15.966543,epoch time: 0:17:48.883920,used: 1:29:26.425873,model: dset_te_center0_dann_b44271c83_not_commited_2024md_07md_13_20_02_49_seed_2_21955598
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9516828, 'precision': 0.4758414, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48762167, 'auroc': 0.99557245, 'binary_precision': 0.9516828, 'binary_recall': 1.0, 'binary_specificity': 0.0, 'binary_f1_score': 0.97524333}
confusion matrix:
   0      1
0  0   1516
1  0  29860
---- Validation: 
scalar performance:
{'acc': 0.48669797, 'precision': 0.24334899, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.32736844, 'auroc': 0.8899486, 'binary_precision': 0.48669797, 'binary_recall': 1.0, 'binary_specificity': 0.0, 'binary_f1_score': 0.6547369}
confusion matrix:
   0    1
0  0  656
1  0  622
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5452632, 'precision': 0.2726316, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.35286105, 'auroc': 0.8955652, 'binary_precision': 0.5452632, 'binary_recall': 1.0, 'binary_specificity': 0.0, 'binary_f1_score': 0.7057221}
confusion matrix:
   0    1
0  0  216
1  0  259
early stop counter: 5
val acc:0.4866979718208313, best validation acc: 0.4866979718208313, corresponding to test acc:                         0.5452631711959839 / 0.5452631711959839
after epoch: 6,now: 2024-07-13 21:50:04.469349,epoch time: 0:17:48.502806,used: 1:47:14.928679,model: dset_te_center0_dann_b44271c83_not_commited_2024md_07md_13_20_02_49_seed_2_21955598
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 6 with time: 1:47:14.928679 at 2024-07-13 21:50:04.469349
persisted model performance metric: 

scalar performance:
{'acc': 0.5452632, 'precision': 0.2726316, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.35286105, 'auroc': 0.9184184, 'binary_precision': 0.5452632, 'binary_recall': 1.0, 'binary_specificity': 0.0, 'binary_f1_score': 0.7057221}
confusion matrix:
   0    1
0  0  216
1  0  259
oracle model performance metric: 

scalar performance:
{'acc': 0.5452632, 'precision': 0.2726316, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.35286105, 'auroc': 0.9184184, 'binary_precision': 0.5452632, 'binary_recall': 1.0, 'binary_specificity': 0.0, 'binary_f1_score': 0.7057221}
confusion matrix:
   0    1
0  0  216
1  0  259
results aggregation path: zoutput/benchmarks/CAMELYONWILD_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_halffreeze/rule_results/7.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONWILD_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_halffreeze/confusion_matrix/7.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 318814 KiB |   1933 MiB | 721943 GiB | 721942 GiB |
|       from large pool | 291621 KiB |   1909 MiB | 712122 GiB | 712122 GiB |
|       from small pool |  27192 KiB |     43 MiB |   9820 GiB |   9820 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 318814 KiB |   1933 MiB | 721943 GiB | 721942 GiB |
|       from large pool | 291621 KiB |   1909 MiB | 712122 GiB | 712122 GiB |
|       from small pool |  27192 KiB |     43 MiB |   9820 GiB |   9820 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 313851 KiB |   1929 MiB | 721477 GiB | 721476 GiB |
|       from large pool | 286862 KiB |   1906 MiB | 711671 GiB | 711670 GiB |
|       from small pool |  26989 KiB |     43 MiB |   9805 GiB |   9805 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2178 MiB |   2198 MiB |   5566 MiB |   3388 MiB |
|       from large pool |   2128 MiB |   2148 MiB |   5482 MiB |   3354 MiB |
|       from small pool |     50 MiB |     50 MiB |     84 MiB |     34 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 197282 KiB | 277351 KiB | 492762 GiB | 492762 GiB |
|       from large pool | 189658 KiB | 271595 KiB | 482797 GiB | 482797 GiB |
|       from small pool |   7623 KiB |  23654 KiB |   9965 GiB |   9965 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    1078    |    4669    |  125490 K  |  125489 K  |
|       from large pool |     130    |     276    |   66557 K  |   66557 K  |
|       from small pool |     948    |    4538    |   58932 K  |   58931 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    1078    |    4669    |  125490 K  |  125489 K  |
|       from large pool |     130    |     276    |   66557 K  |   66557 K  |
|       from small pool |     948    |    4538    |   58932 K  |   58931 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     114    |     115    |     266    |     152    |
|       from large pool |      89    |      90    |     224    |     135    |
|       from small pool |      25    |      25    |      42    |      17    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      69    |    1993    |   68928 K  |   68928 K  |
|       from large pool |      22    |      91    |   42429 K  |   42429 K  |
|       from small pool |      47    |    1971    |   26499 K  |   26499 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   1933 MiB | 721943 GiB | 721943 GiB |
|       from large pool |  16640 KiB |   1909 MiB | 712122 GiB | 712122 GiB |
|       from small pool |      0 KiB |     43 MiB |   9820 GiB |   9820 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   1933 MiB | 721943 GiB | 721943 GiB |
|       from large pool |  16640 KiB |   1909 MiB | 712122 GiB | 712122 GiB |
|       from small pool |      0 KiB |     43 MiB |   9820 GiB |   9820 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   1929 MiB | 721477 GiB | 721476 GiB |
|       from large pool |  16640 KiB |   1906 MiB | 711671 GiB | 711671 GiB |
|       from small pool |      0 KiB |     43 MiB |   9805 GiB |   9805 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 516096 KiB |   2198 MiB |   5566 MiB |   5062 MiB |
|       from large pool | 481280 KiB |   2148 MiB |   5482 MiB |   5012 MiB |
|       from small pool |  34816 KiB |     50 MiB |     84 MiB |     50 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 277351 KiB | 492763 GiB | 492763 GiB |
|       from large pool |  24320 KiB | 271595 KiB | 482797 GiB | 482797 GiB |
|       from small pool |      0 KiB |  23654 KiB |   9965 GiB |   9965 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    4669    |  125490 K  |  125490 K  |
|       from large pool |       2    |     276    |   66557 K  |   66557 K  |
|       from small pool |       0    |    4538    |   58932 K  |   58932 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    4669    |  125490 K  |  125490 K  |
|       from large pool |       2    |     276    |   66557 K  |   66557 K  |
|       from small pool |       0    |    4538    |   58932 K  |   58932 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      39    |     115    |     266    |     227    |
|       from large pool |      22    |      90    |     224    |     202    |
|       from small pool |      17    |      25    |      42    |      25    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    1993    |   68928 K  |   68928 K  |
|       from large pool |       3    |      91    |   42429 K  |   42429 K  |
|       from small pool |       0    |    1971    |   26499 K  |   26499 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Sat Jul 13 21:57:25 2024]
Finished job 0.
1 of 1 steps (100%) done
