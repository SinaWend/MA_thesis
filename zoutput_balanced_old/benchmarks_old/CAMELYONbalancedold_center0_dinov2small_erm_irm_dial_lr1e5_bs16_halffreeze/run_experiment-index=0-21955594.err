Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Sat Jul 13 01:18:14 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYONWILD_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_halffreeze/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYONWILD_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_halffreeze/rule_results/0.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=0
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/swiglu_ffn.py:51: UserWarning: xFormers is not available (SwiGLU)
  warnings.warn("xFormers is not available (SwiGLU)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/attention.py:33: UserWarning: xFormers is not available (Attention)
  warnings.warn("xFormers is not available (Attention)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/block.py:40: UserWarning: xFormers is not available (Block)
  warnings.warn("xFormers is not available (Block)")
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_01_24_10_seed_0_21955594

 Experiment start at: 2024-07-13 01:24:10.926986
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
before training, model accuracy: 0.5360825061798096
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9884581, 'precision': 0.9487232, 'recall': 0.9242497, 'specificity': 0.9242497, 'f1': 0.9361028, 'auroc': 0.99683094, 'binary_precision': 0.99248475, 'binary_recall': 0.99540323, 'binary_specificity': 0.8530962, 'binary_f1_score': 0.99394184}
confusion matrix:
      0      1
0  1295    223
1   136  29450
---- Validation: 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
scalar performance:
{'acc': 0.73059005, 'precision': 0.80573547, 'recall': 0.73402107, 'specificity': 0.73402107, 'f1': 0.7148069, 'auroc': 0.9378483, 'binary_precision': 0.6506276, 'binary_recall': 0.97952753, 'binary_specificity': 0.48851454, 'binary_f1_score': 0.7818982}
confusion matrix:
     0    1
0  319  334
1   13  622
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7525773, 'precision': 0.7917565, 'recall': 0.7285099, 'specificity': 0.7285099, 'f1': 0.72902, 'auroc': 0.921615, 'binary_precision': 0.7094972, 'binary_recall': 0.94074076, 'binary_specificity': 0.51627904, 'binary_f1_score': 0.80891716}
confusion matrix:
     0    1
0  111  104
1   16  254
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-13 01:40:31.013140,epoch time: 0:16:20.086154,used: 0:16:20.086154,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_01_24_10_seed_0_21955594
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9882009, 'precision': 0.907159, 'recall': 0.9844233, 'specificity': 0.9844233, 'f1': 0.9419919, 'auroc': 0.9987345, 'binary_precision': 0.9989754, 'binary_recall': 0.9886095, 'binary_specificity': 0.9802371, 'binary_f1_score': 0.9937655}
confusion matrix:
      0      1
0  1488     30
1   337  29249
---- Validation: 
scalar performance:
{'acc': 0.8369565, 'precision': 0.8491572, 'recall': 0.8356441, 'specificity': 0.8356441, 'f1': 0.83511823, 'auroc': 0.9364339, 'binary_precision': 0.91102517, 'binary_recall': 0.7417323, 'binary_specificity': 0.9295559, 'binary_f1_score': 0.8177084}
confusion matrix:
     0    1
0  607   46
1  164  471
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.83092785, 'precision': 0.8447186, 'recall': 0.8429371, 'specificity': 0.8429371, 'f1': 0.83090985, 'auroc': 0.91965544, 'binary_precision': 0.947619, 'binary_recall': 0.73703706, 'binary_specificity': 0.9488372, 'binary_f1_score': 0.82916665}
confusion matrix:
     0    1
0  204   11
1   71  199
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-07-13 01:56:44.239004,epoch time: 0:16:13.225864,used: 0:32:33.312018,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_01_24_10_seed_0_21955594
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9934092, 'precision': 0.9509671, 'recall': 0.98154676, 'specificity': 0.98154676, 'f1': 0.96569383, 'auroc': 0.9991822, 'binary_precision': 0.99837154, 'binary_recall': 0.9946933, 'binary_specificity': 0.96840024, 'binary_f1_score': 0.996529}
confusion matrix:
      0      1
0  1471     48
1   157  29428
---- Validation: 
scalar performance:
{'acc': 0.88586956, 'precision': 0.8860159, 'recall': 0.88603175, 'specificity': 0.88603175, 'f1': 0.8858695, 'auroc': 0.9410908, 'binary_precision': 0.8742331, 'binary_recall': 0.8976378, 'binary_specificity': 0.8744257, 'binary_f1_score': 0.88578093}
confusion matrix:
     0    1
0  571   82
1   65  570
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8371134, 'precision': 0.83583486, 'recall': 0.8399656, 'specificity': 0.8399656, 'f1': 0.83630896, 'auroc': 0.91395354, 'binary_precision': 0.88353413, 'binary_recall': 0.8148148, 'binary_specificity': 0.8651163, 'binary_f1_score': 0.84778416}
confusion matrix:
     0    1
0  186   29
1   50  220
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-07-13 02:12:54.922657,epoch time: 0:16:10.683653,used: 0:48:43.995671,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_01_24_10_seed_0_21955594
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.99402004, 'precision': 0.9586898, 'recall': 0.9787202, 'specificity': 0.9787202, 'f1': 0.9684651, 'auroc': 0.9991146, 'binary_precision': 0.998035, 'binary_recall': 0.9956738, 'binary_specificity': 0.96176666, 'binary_f1_score': 0.996853}
confusion matrix:
      0      1
0  1459     58
1   128  29459
---- Validation: 
scalar performance:
{'acc': 0.8913044, 'precision': 0.8931694, 'recall': 0.89180404, 'specificity': 0.89180404, 'f1': 0.89124537, 'auroc': 0.94817615, 'binary_precision': 0.86237186, 'binary_recall': 0.9275591, 'binary_specificity': 0.856049, 'binary_f1_score': 0.89377844}
confusion matrix:
     0    1
0  559   94
1   46  589
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.85979384, 'precision': 0.857746, 'recall': 0.8612834, 'specificity': 0.8612834, 'f1': 0.8587847, 'auroc': 0.9204479, 'binary_precision': 0.89453125, 'binary_recall': 0.84814817, 'binary_specificity': 0.8744186, 'binary_f1_score': 0.87072253}
confusion matrix:
     0    1
0  188   27
1   41  229
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-07-13 02:29:08.618613,epoch time: 0:16:13.695956,used: 1:04:57.691627,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_01_24_10_seed_0_21955594
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.98852235, 'precision': 0.984513, 'recall': 0.8899828, 'specificity': 0.8899828, 'f1': 0.9315903, 'auroc': 0.99879026, 'binary_precision': 0.98886067, 'binary_recall': 0.9991888, 'binary_specificity': 0.7807768, 'binary_f1_score': 0.9939979}
confusion matrix:
      0      1
0  1186    333
1    24  29561
---- Validation: 
scalar performance:
{'acc': 0.66925466, 'precision': 0.7872571, 'recall': 0.6736829, 'specificity': 0.6736829, 'f1': 0.63472617, 'auroc': 0.9526378, 'binary_precision': 0.5996187, 'binary_recall': 0.9905512, 'binary_specificity': 0.3568147, 'binary_f1_score': 0.7470308}
confusion matrix:
     0    1
0  233  420
1    6  629
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7484536, 'precision': 0.8083899, 'recall': 0.7205426, 'specificity': 0.7205426, 'f1': 0.7181629, 'auroc': 0.9478897, 'binary_precision': 0.69786096, 'binary_recall': 0.96666664, 'binary_specificity': 0.4744186, 'binary_f1_score': 0.810559}
confusion matrix:
     0    1
0  102  113
1    9  261
early stop counter: 1
val acc:0.6692546606063843, best validation acc: 0.8913043737411499, corresponding to test acc:                         0.8597938418388367 / 0.8597938418388367
after epoch: 5,now: 2024-07-13 02:45:23.557437,epoch time: 0:16:14.938824,used: 1:21:12.630451,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_01_24_10_seed_0_21955594
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9959491, 'precision': 0.9761923, 'recall': 0.98035955, 'specificity': 0.98035955, 'f1': 0.9782658, 'auroc': 0.99955225, 'binary_precision': 0.99810636, 'binary_recall': 0.9976341, 'binary_specificity': 0.96308506, 'binary_f1_score': 0.9978702}
confusion matrix:
      0      1
0  1461     56
1    70  29517
---- Validation: 
scalar performance:
{'acc': 0.9122671, 'precision': 0.91228, 'recall': 0.9122174, 'specificity': 0.9122174, 'f1': 0.9122437, 'auroc': 0.95592725, 'binary_precision': 0.91297466, 'binary_recall': 0.9086614, 'binary_specificity': 0.91577333, 'binary_f1_score': 0.9108129}
confusion matrix:
     0    1
0  598   55
1   58  577
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8783505, 'precision': 0.8792479, 'recall': 0.88410854, 'specificity': 0.88410854, 'f1': 0.8780519, 'auroc': 0.9452368, 'binary_precision': 0.9414226, 'binary_recall': 0.8333333, 'binary_specificity': 0.9348837, 'binary_f1_score': 0.8840864}
confusion matrix:
     0    1
0  201   14
1   45  225
new oracle model saved
better model found
persisted
after epoch: 6,now: 2024-07-13 03:01:32.184339,epoch time: 0:16:08.626902,used: 1:37:21.257353,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_01_24_10_seed_0_21955594
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9954025, 'precision': 0.9662334, 'recall': 0.9857091, 'specificity': 0.9857091, 'f1': 0.9757481, 'auroc': 0.99965394, 'binary_precision': 0.9987127, 'binary_recall': 0.996451, 'binary_specificity': 0.97496706, 'binary_f1_score': 0.99758065}
confusion matrix:
      0      1
0  1480     38
1   105  29481
---- Validation: 
scalar performance:
{'acc': 0.91537267, 'precision': 0.915619, 'recall': 0.915215, 'specificity': 0.915215, 'f1': 0.9153236, 'auroc': 0.95627207, 'binary_precision': 0.92282957, 'binary_recall': 0.903937, 'binary_specificity': 0.9264931, 'binary_f1_score': 0.9132856}
confusion matrix:
     0    1
0  605   48
1   61  574
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8701031, 'precision': 0.87710094, 'recall': 0.8795435, 'specificity': 0.8795435, 'f1': 0.8700677, 'auroc': 0.9382256, 'binary_precision': 0.9641256, 'binary_recall': 0.7962963, 'binary_specificity': 0.96279067, 'binary_f1_score': 0.872211}
confusion matrix:
     0    1
0  207    8
1   55  215
better model found
persisted
after epoch: 7,now: 2024-07-13 03:17:44.212690,epoch time: 0:16:12.028351,used: 1:53:33.285704,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_01_24_10_seed_0_21955594
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9956597, 'precision': 0.97016317, 'recall': 0.98395985, 'specificity': 0.98395985, 'f1': 0.97694993, 'auroc': 0.9995612, 'binary_precision': 0.9985105, 'binary_recall': 0.99692434, 'binary_specificity': 0.97099537, 'binary_f1_score': 0.99771684}
confusion matrix:
      0      1
0  1473     44
1    91  29496
---- Validation: 
scalar performance:
{'acc': 0.9208075, 'precision': 0.9211201, 'recall': 0.92103076, 'specificity': 0.92103076, 'f1': 0.92080677, 'auroc': 0.9566531, 'binary_precision': 0.90563166, 'binary_recall': 0.93700784, 'binary_specificity': 0.9050536, 'binary_f1_score': 0.9210527}
confusion matrix:
     0    1
0  591   62
1   40  595
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8886598, 'precision': 0.88660014, 'recall': 0.88910425, 'specificity': 0.88910425, 'f1': 0.88760424, 'auroc': 0.9417571, 'binary_precision': 0.91221374, 'binary_recall': 0.8851852, 'binary_specificity': 0.89302325, 'binary_f1_score': 0.8984962}
confusion matrix:
     0    1
0  192   23
1   31  239
new oracle model saved
better model found
persisted
after epoch: 8,now: 2024-07-13 03:33:55.235699,epoch time: 0:16:11.023009,used: 2:09:44.308713,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_01_24_10_seed_0_21955594
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9965599, 'precision': 0.9776546, 'recall': 0.9857011, 'specificity': 0.9857011, 'f1': 0.9816402, 'auroc': 0.999678, 'binary_precision': 0.99864674, 'binary_recall': 0.9977353, 'binary_specificity': 0.9736669, 'binary_f1_score': 0.9981908}
confusion matrix:
      0      1
0  1479     40
1    67  29518
---- Validation: 
scalar performance:
{'acc': 0.92158383, 'precision': 0.921577, 'recall': 0.92155766, 'specificity': 0.92155766, 'f1': 0.9215668, 'auroc': 0.9584787, 'binary_precision': 0.92113566, 'binary_recall': 0.91968507, 'binary_specificity': 0.9234303, 'binary_f1_score': 0.9204098}
confusion matrix:
     0    1
0  603   50
1   51  584
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9134021, 'precision': 0.91352075, 'recall': 0.9189061, 'specificity': 0.9189061, 'f1': 0.9131329, 'auroc': 0.9593971, 'binary_precision': 0.9710744, 'binary_recall': 0.8703704, 'binary_specificity': 0.96744186, 'binary_f1_score': 0.9179688}
confusion matrix:
     0    1
0  208    7
1   35  235
new oracle model saved
better model found
persisted
after epoch: 9,now: 2024-07-13 03:50:07.555012,epoch time: 0:16:12.319313,used: 2:25:56.628026,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_01_24_10_seed_0_21955594
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9959491, 'precision': 0.98588777, 'recall': 0.97007906, 'specificity': 0.97007906, 'f1': 0.9778378, 'auroc': 0.99966204, 'binary_precision': 0.996997, 'binary_recall': 0.9987494, 'binary_specificity': 0.9414088, 'binary_f1_score': 0.9978724}
confusion matrix:
      0      1
0  1430     89
1    37  29548
---- Validation: 
scalar performance:
{'acc': 0.8773292, 'precision': 0.88923526, 'recall': 0.8785641, 'specificity': 0.8785641, 'f1': 0.8766149, 'auroc': 0.94420904, 'binary_precision': 0.8175766, 'binary_recall': 0.96692914, 'binary_specificity': 0.7901991, 'binary_f1_score': 0.8860029}
confusion matrix:
     0    1
0  516  137
1   21  614
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.85360825, 'precision': 0.8558188, 'recall': 0.8472007, 'specificity': 0.8472007, 'f1': 0.850119, 'auroc': 0.90814817, 'binary_precision': 0.8442907, 'binary_recall': 0.9037037, 'binary_specificity': 0.7906977, 'binary_f1_score': 0.8729874}
confusion matrix:
     0    1
0  170   45
1   26  244
early stop counter: 1
val acc:0.8773291707038879, best validation acc: 0.9215838313102722, corresponding to test acc:                         0.9134020805358887 / 0.9134020805358887
after epoch: 10,now: 2024-07-13 04:06:16.206422,epoch time: 0:16:08.651410,used: 2:42:05.279436,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_01_24_10_seed_0_21955594
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9945666, 'precision': 0.95236576, 'recall': 0.99370664, 'specificity': 0.99370664, 'f1': 0.9720211, 'auroc': 0.9997381, 'binary_precision': 0.99962634, 'binary_recall': 0.99465966, 'binary_specificity': 0.9927536, 'binary_f1_score': 0.9971368}
confusion matrix:
      0      1
0  1507     11
1   158  29428
---- Validation: 
scalar performance:
{'acc': 0.8990683, 'precision': 0.90121067, 'recall': 0.89857113, 'specificity': 0.89857113, 'f1': 0.8988339, 'auroc': 0.95109427, 'binary_precision': 0.927242, 'binary_recall': 0.8629921, 'binary_specificity': 0.9341501, 'binary_f1_score': 0.8939641}
confusion matrix:
     0    1
0  610   43
1   87  548
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.85360825, 'precision': 0.8635911, 'recall': 0.86425495, 'specificity': 0.86425495, 'f1': 0.85360575, 'auroc': 0.9271318, 'binary_precision': 0.95852536, 'binary_recall': 0.77037036, 'binary_specificity': 0.95813954, 'binary_f1_score': 0.8542095}
confusion matrix:
     0    1
0  206    9
1   62  208
early stop counter: 2
val acc:0.899068295955658, best validation acc: 0.9215838313102722, corresponding to test acc:                         0.9134020805358887 / 0.9134020805358887
after epoch: 11,now: 2024-07-13 04:22:27.089240,epoch time: 0:16:10.882818,used: 2:58:16.162254,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_01_24_10_seed_0_21955594
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.99520963, 'precision': 0.993721, 'recall': 0.9543296, 'specificity': 0.9543296, 'f1': 0.9731159, 'auroc': 0.99973786, 'binary_precision': 0.9953557, 'binary_recall': 0.9996282, 'binary_specificity': 0.909031, 'binary_f1_score': 0.99748737}
confusion matrix:
      0      1
0  1379    138
1    11  29576
---- Validation: 
scalar performance:
{'acc': 0.83462733, 'precision': 0.86301565, 'recall': 0.836581, 'specificity': 0.836581, 'f1': 0.8318681, 'auroc': 0.96067816, 'binary_precision': 0.7579462, 'binary_recall': 0.97637796, 'binary_specificity': 0.6967841, 'binary_f1_score': 0.8534067}
confusion matrix:
     0    1
0  455  198
1   15  620
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8515464, 'precision': 0.8582432, 'recall': 0.8425064, 'specificity': 0.8425064, 'f1': 0.84684205, 'auroc': 0.93378115, 'binary_precision': 0.83, 'binary_recall': 0.9222222, 'binary_specificity': 0.7627907, 'binary_f1_score': 0.87368417}
confusion matrix:
     0    1
0  164   51
1   21  249
early stop counter: 3
val acc:0.8346273303031921, best validation acc: 0.9215838313102722, corresponding to test acc:                         0.9134020805358887 / 0.9134020805358887
after epoch: 12,now: 2024-07-13 04:38:13.513016,epoch time: 0:15:46.423776,used: 3:14:02.586030,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_01_24_10_seed_0_21955594
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.99582046, 'precision': 0.99146795, 'recall': 0.96311766, 'specificity': 0.96311766, 'f1': 0.9768244, 'auroc': 0.99976397, 'binary_precision': 0.99625987, 'binary_recall': 0.9993578, 'binary_specificity': 0.9268775, 'binary_f1_score': 0.99780643}
confusion matrix:
      0      1
0  1407    111
1    19  29567
---- Validation: 
scalar performance:
{'acc': 0.8718944, 'precision': 0.8810322, 'recall': 0.87298715, 'specificity': 0.87298715, 'f1': 0.8713341, 'auroc': 0.9478204, 'binary_precision': 0.81842816, 'binary_recall': 0.9511811, 'binary_specificity': 0.79479325, 'binary_f1_score': 0.87982523}
confusion matrix:
     0    1
0  519  134
1   31  604
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.84948456, 'precision': 0.8488534, 'recall': 0.84539187, 'specificity': 0.84539187, 'f1': 0.84681714, 'auroc': 0.9269595, 'binary_precision': 0.8530466, 'binary_recall': 0.88148147, 'binary_specificity': 0.80930233, 'binary_f1_score': 0.867031}
confusion matrix:
     0    1
0  174   41
1   32  238
early stop counter: 4
val acc:0.8718944191932678, best validation acc: 0.9215838313102722, corresponding to test acc:                         0.9134020805358887 / 0.9134020805358887
after epoch: 13,now: 2024-07-13 04:54:12.836655,epoch time: 0:15:59.323639,used: 3:30:01.909669,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_01_24_10_seed_0_21955594
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.99752444, 'precision': 0.9818973, 'recall': 0.99182415, 'specificity': 0.99182415, 'f1': 0.9868041, 'auroc': 0.9998574, 'binary_precision': 0.9992556, 'binary_recall': 0.998141, 'binary_specificity': 0.98550725, 'binary_f1_score': 0.998698}
confusion matrix:
      0      1
0  1496     22
1    55  29531
---- Validation: 
scalar performance:
{'acc': 0.9200311, 'precision': 0.9226867, 'recall': 0.92061234, 'specificity': 0.92061234, 'f1': 0.919965, 'auroc': 0.9586693, 'binary_precision': 0.8855072, 'binary_recall': 0.9622047, 'binary_specificity': 0.8790199, 'binary_f1_score': 0.92226416}
confusion matrix:
     0    1
0  574   79
1   24  611
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8927835, 'precision': 0.89075065, 'recall': 0.8932817, 'specificity': 0.8932817, 'f1': 0.891767, 'auroc': 0.9416193, 'binary_precision': 0.9160305, 'binary_recall': 0.8888889, 'binary_specificity': 0.89767444, 'binary_f1_score': 0.9022556}
confusion matrix:
     0    1
0  193   22
1   30  240
early stop counter: 5
val acc:0.9200310707092285, best validation acc: 0.9215838313102722, corresponding to test acc:                         0.9134020805358887 / 0.9134020805358887
after epoch: 14,now: 2024-07-13 05:10:12.862719,epoch time: 0:16:00.026064,used: 3:46:01.935733,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_01_24_10_seed_0_21955594
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 14 with time: 3:46:01.935733 at 2024-07-13 05:10:12.862719
persisted model performance metric: 

scalar performance:
{'acc': 0.9134021, 'precision': 0.91352075, 'recall': 0.9189061, 'specificity': 0.9189061, 'f1': 0.9131329, 'auroc': 0.9593971, 'binary_precision': 0.9710744, 'binary_recall': 0.8703704, 'binary_specificity': 0.96744186, 'binary_f1_score': 0.9179688}
confusion matrix:
     0    1
0  208    7
1   35  235
oracle model performance metric: 

scalar performance:
{'acc': 0.9134021, 'precision': 0.91352075, 'recall': 0.9189061, 'specificity': 0.9189061, 'f1': 0.9131329, 'auroc': 0.9593971, 'binary_precision': 0.9710744, 'binary_recall': 0.8703704, 'binary_specificity': 0.96744186, 'binary_f1_score': 0.9179688}
confusion matrix:
     0    1
0  208    7
1   35  235
results aggregation path: zoutput/benchmarks/CAMELYONWILD_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_halffreeze/rule_results/0.csv
results aggregation path: zoutput/benchmarks/CAMELYONWILD_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_halffreeze/rule_results/0.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONWILD_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_halffreeze/confusion_matrix/0.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 319000 KiB |   1123 MiB | 210123 GiB | 210123 GiB |
|       from large pool | 291814 KiB |   1100 MiB | 207055 GiB | 207054 GiB |
|       from small pool |  27185 KiB |     43 MiB |   3068 GiB |   3068 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 319000 KiB |   1123 MiB | 210123 GiB | 210123 GiB |
|       from large pool | 291814 KiB |   1100 MiB | 207055 GiB | 207054 GiB |
|       from small pool |  27185 KiB |     43 MiB |   3068 GiB |   3068 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 313851 KiB |   1121 MiB | 209996 GiB | 209996 GiB |
|       from large pool | 286862 KiB |   1098 MiB | 206933 GiB | 206933 GiB |
|       from small pool |  26989 KiB |     43 MiB |   3063 GiB |   3063 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1320 MiB |   1320 MiB |   1320 MiB |      0 B   |
|       from large pool |   1270 MiB |   1270 MiB |   1270 MiB |      0 B   |
|       from small pool |     50 MiB |     50 MiB |     50 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory | 201192 KiB | 243156 KiB | 164085 GiB | 164084 GiB |
|       from large pool | 195609 KiB | 239401 KiB | 160904 GiB | 160904 GiB |
|       from small pool |   5582 KiB |   9130 KiB |   3180 GiB |   3180 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    1064    |    4615    |   39702 K  |   39701 K  |
|       from large pool |     130    |     212    |   19537 K  |   19537 K  |
|       from small pool |     934    |    4484    |   20164 K  |   20164 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    1064    |    4615    |   39702 K  |   39701 K  |
|       from large pool |     130    |     212    |   19537 K  |   19537 K  |
|       from small pool |     934    |    4484    |   20164 K  |   20164 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      78    |      78    |      78    |       0    |
|       from large pool |      53    |      53    |      53    |       0    |
|       from small pool |      25    |      25    |      25    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      50    |    1978    |   21915 K  |   21915 K  |
|       from large pool |      21    |      52    |   12519 K  |   12519 K  |
|       from small pool |      29    |    1957    |    9396 K  |    9396 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   1123 MiB | 210123 GiB | 210123 GiB |
|       from large pool |  16640 KiB |   1100 MiB | 207055 GiB | 207055 GiB |
|       from small pool |      0 KiB |     43 MiB |   3068 GiB |   3068 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   1123 MiB | 210123 GiB | 210123 GiB |
|       from large pool |  16640 KiB |   1100 MiB | 207055 GiB | 207055 GiB |
|       from small pool |      0 KiB |     43 MiB |   3068 GiB |   3068 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   1121 MiB | 209996 GiB | 209996 GiB |
|       from large pool |  16640 KiB |   1098 MiB | 206933 GiB | 206933 GiB |
|       from small pool |      0 KiB |     43 MiB |   3063 GiB |   3063 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 520192 KiB |   1320 MiB |   1320 MiB |    812 MiB |
|       from large pool | 487424 KiB |   1270 MiB |   1270 MiB |    794 MiB |
|       from small pool |  32768 KiB |     50 MiB |     50 MiB |     18 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 255308 KiB | 164085 GiB | 164085 GiB |
|       from large pool |  24320 KiB | 243866 KiB | 160905 GiB | 160905 GiB |
|       from small pool |      0 KiB |  15280 KiB |   3180 GiB |   3180 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    4615    |   39702 K  |   39702 K  |
|       from large pool |       2    |     212    |   19537 K  |   19537 K  |
|       from small pool |       0    |    4484    |   20164 K  |   20164 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    4615    |   39702 K  |   39702 K  |
|       from large pool |       2    |     212    |   19537 K  |   19537 K  |
|       from small pool |       0    |    4484    |   20164 K  |   20164 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      38    |      78    |      78    |      40    |
|       from large pool |      22    |      53    |      53    |      31    |
|       from small pool |      16    |      25    |      25    |       9    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    1978    |   21915 K  |   21915 K  |
|       from large pool |       4    |      52    |   12519 K  |   12519 K  |
|       from small pool |       0    |    1957    |    9396 K  |    9396 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   1123 MiB | 210123 GiB | 210123 GiB |
|       from large pool |  16640 KiB |   1100 MiB | 207055 GiB | 207055 GiB |
|       from small pool |      0 KiB |     43 MiB |   3068 GiB |   3068 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   1123 MiB | 210123 GiB | 210123 GiB |
|       from large pool |  16640 KiB |   1100 MiB | 207055 GiB | 207055 GiB |
|       from small pool |      0 KiB |     43 MiB |   3068 GiB |   3068 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   1121 MiB | 209996 GiB | 209996 GiB |
|       from large pool |  16640 KiB |   1098 MiB | 206933 GiB | 206933 GiB |
|       from small pool |      0 KiB |     43 MiB |   3063 GiB |   3063 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 520192 KiB |   1320 MiB |   1320 MiB |    812 MiB |
|       from large pool | 487424 KiB |   1270 MiB |   1270 MiB |    794 MiB |
|       from small pool |  32768 KiB |     50 MiB |     50 MiB |     18 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 255308 KiB | 164085 GiB | 164085 GiB |
|       from large pool |  24320 KiB | 243866 KiB | 160905 GiB | 160905 GiB |
|       from small pool |      0 KiB |  15280 KiB |   3180 GiB |   3180 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    4615    |   39702 K  |   39702 K  |
|       from large pool |       2    |     212    |   19537 K  |   19537 K  |
|       from small pool |       0    |    4484    |   20164 K  |   20164 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    4615    |   39702 K  |   39702 K  |
|       from large pool |       2    |     212    |   19537 K  |   19537 K  |
|       from small pool |       0    |    4484    |   20164 K  |   20164 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      38    |      78    |      78    |      40    |
|       from large pool |      22    |      53    |      53    |      31    |
|       from small pool |      16    |      25    |      25    |       9    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    1978    |   21915 K  |   21915 K  |
|       from large pool |       4    |      52    |   12519 K  |   12519 K  |
|       from small pool |       0    |    1957    |    9396 K  |    9396 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_05_23_48_seed_1_21955594

 Experiment start at: 2024-07-13 05:23:48.168249
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
before training, model accuracy: 0.6276150345802307
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.98545617, 'precision': 0.9850242, 'recall': 0.85605824, 'specificity': 0.85605824, 'f1': 0.9096296, 'auroc': 0.9981981, 'binary_precision': 0.98548895, 'binary_recall': 0.9994275, 'binary_specificity': 0.71268904, 'binary_f1_score': 0.9924093}
confusion matrix:
      0      1
0  1084    437
1    17  29678
---- Validation: 
scalar performance:
{'acc': 0.7962529, 'precision': 0.82497203, 'recall': 0.79866874, 'specificity': 0.79866874, 'f1': 0.7925122, 'auroc': 0.9333888, 'binary_precision': 0.7241798, 'binary_recall': 0.94603175, 'binary_specificity': 0.6513057, 'binary_f1_score': 0.8203716}
confusion matrix:
     0    1
0  424  227
1   34  596
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.79288703, 'precision': 0.8089565, 'recall': 0.7856566, 'specificity': 0.7856566, 'f1': 0.7867639, 'auroc': 0.9127097, 'binary_precision': 0.751634, 'binary_recall': 0.90909094, 'binary_specificity': 0.6622222, 'binary_f1_score': 0.8228981}
confusion matrix:
     0    1
0  149   76
1   23  230
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-13 05:39:59.834085,epoch time: 0:16:11.665836,used: 0:16:11.665836,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_05_23_48_seed_1_21955594
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9934329, 'precision': 0.9819479, 'recall': 0.94602156, 'specificity': 0.94602156, 'f1': 0.9632109, 'auroc': 0.999149, 'binary_precision': 0.9945663, 'binary_recall': 0.99855196, 'binary_specificity': 0.89349115, 'binary_f1_score': 0.99655515}
confusion matrix:
      0      1
0  1359    162
1    43  29652
---- Validation: 
scalar performance:
{'acc': 0.7423888, 'precision': 0.80174077, 'recall': 0.7459805, 'specificity': 0.7459805, 'f1': 0.7308714, 'auroc': 0.9312736, 'binary_precision': 0.6637555, 'binary_recall': 0.96507937, 'binary_specificity': 0.5268817, 'binary_f1_score': 0.78654593}
confusion matrix:
     0    1
0  343  308
1   22  608
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.751046, 'precision': 0.80548793, 'recall': 0.73801494, 'specificity': 0.73801494, 'f1': 0.73213726, 'auroc': 0.92244184, 'binary_precision': 0.69034094, 'binary_recall': 0.9604743, 'binary_specificity': 0.51555556, 'binary_f1_score': 0.80330586}
confusion matrix:
     0    1
0  116  109
1   10  243
early stop counter: 1
val acc:0.7423887848854065, best validation acc: 0.7962529063224792, corresponding to test acc:                         0.7928870320320129 / 0.7928870320320129
after epoch: 2,now: 2024-07-13 05:56:08.081981,epoch time: 0:16:08.247896,used: 0:32:19.913732,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_05_23_48_seed_1_21955594
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.99509865, 'precision': 0.974545, 'recall': 0.9724723, 'specificity': 0.9724723, 'f1': 0.9735061, 'auroc': 0.9992629, 'binary_precision': 0.9973066, 'binary_recall': 0.99754167, 'binary_specificity': 0.947403, 'binary_f1_score': 0.9974241}
confusion matrix:
      0      1
0  1441     80
1    73  29622
---- Validation: 
scalar performance:
{'acc': 0.84153, 'precision': 0.85520494, 'recall': 0.84313875, 'specificity': 0.84313875, 'f1': 0.84039557, 'auroc': 0.9410138, 'binary_precision': 0.7812912, 'binary_recall': 0.9412698, 'binary_specificity': 0.7450077, 'binary_f1_score': 0.8538517}
confusion matrix:
     0    1
0  485  166
1   37  593
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8284519, 'precision': 0.8402704, 'recall': 0.82269657, 'specificity': 0.82269657, 'f1': 0.82469225, 'auroc': 0.93932366, 'binary_precision': 0.7898305, 'binary_recall': 0.9209486, 'binary_specificity': 0.72444445, 'binary_f1_score': 0.8503649}
confusion matrix:
     0    1
0  163   62
1   20  233
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-07-13 06:12:19.473773,epoch time: 0:16:11.391792,used: 0:48:31.305524,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_05_23_48_seed_1_21955594
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.99545103, 'precision': 0.9765961, 'recall': 0.97421706, 'specificity': 0.97421706, 'f1': 0.97540325, 'auroc': 0.9993781, 'binary_precision': 0.997475, 'binary_recall': 0.9977437, 'binary_specificity': 0.9506903, 'binary_f1_score': 0.9976094}
confusion matrix:
      0      1
0  1446     75
1    67  29628
---- Validation: 
scalar performance:
{'acc': 0.88368464, 'precision': 0.8896043, 'recall': 0.8847158, 'specificity': 0.8847158, 'f1': 0.8834115, 'auroc': 0.95156896, 'binary_precision': 0.83730716, 'binary_recall': 0.947619, 'binary_specificity': 0.82181257, 'binary_f1_score': 0.88905436}
confusion matrix:
     0    1
0  535  116
1   33  597
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8389121, 'precision': 0.8432734, 'recall': 0.8352833, 'specificity': 0.8352833, 'f1': 0.836907, 'auroc': 0.9403777, 'binary_precision': 0.81654674, 'binary_recall': 0.8972332, 'binary_specificity': 0.7733333, 'binary_f1_score': 0.85499054}
confusion matrix:
     0    1
0  174   51
1   26  227
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-07-13 06:28:29.041578,epoch time: 0:16:09.567805,used: 1:04:40.873329,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_05_23_48_seed_1_21955594
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9919593, 'precision': 0.9355487, 'recall': 0.9854812, 'specificity': 0.9854812, 'f1': 0.9589896, 'auroc': 0.9993929, 'binary_precision': 0.99888176, 'binary_recall': 0.9926587, 'binary_specificity': 0.97830373, 'binary_f1_score': 0.9957605}
confusion matrix:
      0      1
0  1488     33
1   218  29477
---- Validation: 
scalar performance:
{'acc': 0.8992974, 'precision': 0.903944, 'recall': 0.8984383, 'specificity': 0.8984383, 'f1': 0.8988415, 'auroc': 0.9469656, 'binary_precision': 0.94336283, 'binary_recall': 0.8460317, 'binary_specificity': 0.9508448, 'binary_f1_score': 0.8920502}
confusion matrix:
     0    1
0  619   32
1   97  533
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8786611, 'precision': 0.8946165, 'recall': 0.88488364, 'specificity': 0.88488364, 'f1': 0.878301, 'auroc': 0.93154144, 'binary_precision': 0.98994976, 'binary_recall': 0.7786561, 'binary_specificity': 0.9911111, 'binary_f1_score': 0.8716814}
confusion matrix:
     0    1
0  223    2
1   56  197
new oracle model saved
better model found
persisted
after epoch: 5,now: 2024-07-13 06:44:38.350982,epoch time: 0:16:09.309404,used: 1:20:50.182733,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_05_23_48_seed_1_21955594
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9961238, 'precision': 0.984511, 'recall': 0.97330594, 'specificity': 0.97330594, 'f1': 0.9788354, 'auroc': 0.99959064, 'binary_precision': 0.997343, 'binary_recall': 0.99858564, 'binary_specificity': 0.9480263, 'binary_f1_score': 0.9979639}
confusion matrix:
      0      1
0  1441     79
1    42  29654
---- Validation: 
scalar performance:
{'acc': 0.8883685, 'precision': 0.89318115, 'recall': 0.88929856, 'specificity': 0.88929856, 'f1': 0.88816977, 'auroc': 0.95891297, 'binary_precision': 0.8453901, 'binary_recall': 0.94603175, 'binary_specificity': 0.8325653, 'binary_f1_score': 0.8928839}
confusion matrix:
     0    1
0  542  109
1   34  596
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8702929, 'precision': 0.8724854, 'recall': 0.8678788, 'specificity': 0.8678788, 'f1': 0.8691845, 'auroc': 0.9475274, 'binary_precision': 0.8550186, 'binary_recall': 0.90909094, 'binary_specificity': 0.82666665, 'binary_f1_score': 0.88122606}
confusion matrix:
     0    1
0  186   39
1   23  230
early stop counter: 1
val acc:0.8883684873580933, best validation acc: 0.8992974162101746, corresponding to test acc:                         0.8786610960960388 / 0.8786610960960388
after epoch: 6,now: 2024-07-13 07:00:52.254072,epoch time: 0:16:13.903090,used: 1:37:04.085823,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_05_23_48_seed_1_21955594
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9930164, 'precision': 0.9416007, 'recall': 0.9897796, 'specificity': 0.9897796, 'f1': 0.9642872, 'auroc': 0.9996159, 'binary_precision': 0.9992886, 'binary_recall': 0.9933659, 'binary_specificity': 0.9861933, 'binary_f1_score': 0.9963184}
confusion matrix:
      0      1
0  1500     21
1   197  29498
---- Validation: 
scalar performance:
{'acc': 0.90944576, 'precision': 0.9095063, 'recall': 0.90934455, 'specificity': 0.90934455, 'f1': 0.90940547, 'auroc': 0.9521322, 'binary_precision': 0.911859, 'binary_recall': 0.9031746, 'binary_specificity': 0.9155146, 'binary_f1_score': 0.90749604}
confusion matrix:
     0    1
0  596   55
1   61  569
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8849372, 'precision': 0.8861263, 'recall': 0.8871234, 'specificity': 0.8871234, 'f1': 0.8849126, 'auroc': 0.9283619, 'binary_precision': 0.92672414, 'binary_recall': 0.8498024, 'binary_specificity': 0.92444444, 'binary_f1_score': 0.886598}
confusion matrix:
     0    1
0  208   17
1   38  215
new oracle model saved
better model found
persisted
after epoch: 7,now: 2024-07-13 07:17:05.037006,epoch time: 0:16:12.782934,used: 1:53:16.868757,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_05_23_48_seed_1_21955594
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.996348, 'precision': 0.97691154, 'recall': 0.98404527, 'specificity': 0.98404527, 'f1': 0.98044884, 'auroc': 0.9997112, 'binary_precision': 0.99848336, 'binary_recall': 0.9976764, 'binary_specificity': 0.9704142, 'binary_f1_score': 0.99807966}
confusion matrix:
      0      1
0  1476     45
1    69  29626
---- Validation: 
scalar performance:
{'acc': 0.9172521, 'precision': 0.9174794, 'recall': 0.9170763, 'specificity': 0.9170763, 'f1': 0.91719717, 'auroc': 0.9534489, 'binary_precision': 0.9239482, 'binary_recall': 0.9063492, 'binary_specificity': 0.9278034, 'binary_f1_score': 0.9150641}
confusion matrix:
     0    1
0  604   47
1   59  571
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.91004187, 'precision': 0.9135089, 'recall': 0.9132982, 'specificity': 0.9132982, 'f1': 0.91004145, 'auroc': 0.9465085, 'binary_precision': 0.96875, 'binary_recall': 0.8577075, 'binary_specificity': 0.9688889, 'binary_f1_score': 0.9098532}
confusion matrix:
     0    1
0  218    7
1   36  217
new oracle model saved
better model found
persisted
after epoch: 8,now: 2024-07-13 07:33:15.966133,epoch time: 0:16:10.929127,used: 2:09:27.797884,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_05_23_48_seed_1_21955594
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.987122, 'precision': 0.8964233, 'recall': 0.9910479, 'specificity': 0.9910479, 'f1': 0.9379927, 'auroc': 0.99950194, 'binary_precision': 0.99976116, 'binary_recall': 0.9866981, 'binary_specificity': 0.99539775, 'binary_f1_score': 0.99318665}
confusion matrix:
      0      1
0  1514      7
1   395  29300
---- Validation: 
scalar performance:
{'acc': 0.8883685, 'precision': 0.896304, 'recall': 0.8872248, 'specificity': 0.8872248, 'f1': 0.8875693, 'auroc': 0.94731915, 'binary_precision': 0.94843465, 'binary_recall': 0.8174603, 'binary_specificity': 0.9569892, 'binary_f1_score': 0.8780904}
confusion matrix:
     0    1
0  623   28
1  115  515
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8493724, 'precision': 0.87514067, 'recall': 0.85721564, 'specificity': 0.85721564, 'f1': 0.8483102, 'auroc': 0.9428722, 'binary_precision': 0.9891892, 'binary_recall': 0.7233202, 'binary_specificity': 0.9911111, 'binary_f1_score': 0.83561647}
confusion matrix:
     0    1
0  223    2
1   70  183
early stop counter: 1
val acc:0.8883684873580933, best validation acc: 0.9172521233558655, corresponding to test acc:                         0.910041868686676 / 0.910041868686676
after epoch: 9,now: 2024-07-13 07:49:27.479271,epoch time: 0:16:11.513138,used: 2:25:39.311022,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_05_23_48_seed_1_21955594
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9969887, 'precision': 0.9837583, 'recall': 0.9837583, 'specificity': 0.9837583, 'f1': 0.9837583, 'auroc': 0.99969006, 'binary_precision': 0.99841726, 'binary_recall': 0.99841726, 'binary_specificity': 0.9690993, 'binary_f1_score': 0.99841726}
confusion matrix:
      0      1
0  1474     47
1    47  29648
---- Validation: 
scalar performance:
{'acc': 0.8938329, 'precision': 0.8951919, 'recall': 0.89434206, 'specificity': 0.89434206, 'f1': 0.89380443, 'auroc': 0.94856024, 'binary_precision': 0.86755955, 'binary_recall': 0.9253968, 'binary_specificity': 0.86328727, 'binary_f1_score': 0.8955453}
confusion matrix:
     0    1
0  562   89
1   47  583
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8702929, 'precision': 0.86975443, 'recall': 0.8700923, 'specificity': 0.8700923, 'f1': 0.86990803, 'auroc': 0.9210365, 'binary_precision': 0.8804781, 'binary_recall': 0.8735178, 'binary_specificity': 0.8666667, 'binary_f1_score': 0.8769842}
confusion matrix:
     0    1
0  195   30
1   32  221
early stop counter: 2
val acc:0.8938329219818115, best validation acc: 0.9172521233558655, corresponding to test acc:                         0.910041868686676 / 0.910041868686676
after epoch: 10,now: 2024-07-13 08:05:38.710566,epoch time: 0:16:11.231295,used: 2:41:50.542317,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_05_23_48_seed_1_21955594
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.99686056, 'precision': 0.97768533, 'recall': 0.98899305, 'specificity': 0.98899305, 'f1': 0.9832653, 'auroc': 0.9997872, 'binary_precision': 0.99898845, 'binary_recall': 0.99771005, 'binary_specificity': 0.9802761, 'binary_f1_score': 0.99834883}
confusion matrix:
      0      1
0  1491     30
1    68  29627
---- Validation: 
scalar performance:
{'acc': 0.91569084, 'precision': 0.91566825, 'recall': 0.91566825, 'specificity': 0.91566825, 'f1': 0.91566825, 'auroc': 0.9526614, 'binary_precision': 0.9142857, 'binary_recall': 0.9142857, 'binary_specificity': 0.9170507, 'binary_f1_score': 0.9142857}
confusion matrix:
     0    1
0  597   54
1   54  576
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8849372, 'precision': 0.8889886, 'recall': 0.8883531, 'specificity': 0.8883531, 'f1': 0.88493264, 'auroc': 0.94931924, 'binary_precision': 0.9459459, 'binary_recall': 0.8300395, 'binary_specificity': 0.94666666, 'binary_f1_score': 0.88421047}
confusion matrix:
     0    1
0  213   12
1   43  210
early stop counter: 3
val acc:0.9156908392906189, best validation acc: 0.9172521233558655, corresponding to test acc:                         0.910041868686676 / 0.910041868686676
after epoch: 11,now: 2024-07-13 08:21:54.157017,epoch time: 0:16:15.446451,used: 2:58:05.988768,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_05_23_48_seed_1_21955594
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9939774, 'precision': 0.9471055, 'recall': 0.9937135, 'specificity': 0.9937135, 'f1': 0.969111, 'auroc': 0.9996939, 'binary_precision': 0.9996613, 'binary_recall': 0.9940059, 'binary_specificity': 0.9934211, 'binary_f1_score': 0.9968256}
confusion matrix:
      0      1
0  1510     10
1   178  29518
---- Validation: 
scalar performance:
{'acc': 0.8938329, 'precision': 0.8985393, 'recall': 0.89295954, 'specificity': 0.89295954, 'f1': 0.893341, 'auroc': 0.94525635, 'binary_precision': 0.9379433, 'binary_recall': 0.8396825, 'binary_specificity': 0.94623655, 'binary_f1_score': 0.8860972}
confusion matrix:
     0    1
0  616   35
1  101  529
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8556485, 'precision': 0.871609, 'recall': 0.86191475, 'specificity': 0.86191475, 'f1': 0.85518646, 'auroc': 0.94259113, 'binary_precision': 0.96464646, 'binary_recall': 0.7549407, 'binary_specificity': 0.9688889, 'binary_f1_score': 0.8470067}
confusion matrix:
     0    1
0  218    7
1   62  191
early stop counter: 4
val acc:0.8938329219818115, best validation acc: 0.9172521233558655, corresponding to test acc:                         0.910041868686676 / 0.910041868686676
after epoch: 12,now: 2024-07-13 08:38:08.214376,epoch time: 0:16:14.057359,used: 3:14:20.046127,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_05_23_48_seed_1_21955594
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.997245, 'precision': 0.99242425, 'recall': 0.97765505, 'specificity': 0.97765505, 'f1': 0.98491454, 'auroc': 0.9998151, 'binary_precision': 0.99774736, 'binary_recall': 0.99936014, 'binary_specificity': 0.95595, 'binary_f1_score': 0.9985531}
confusion matrix:
      0      1
0  1454     67
1    19  29676
---- Validation: 
scalar performance:
{'acc': 0.9063232, 'precision': 0.9064749, 'recall': 0.9065284, 'specificity': 0.9065284, 'f1': 0.90632266, 'auroc': 0.95421934, 'binary_precision': 0.8935185, 'binary_recall': 0.9190476, 'binary_specificity': 0.89400923, 'binary_f1_score': 0.90610325}
confusion matrix:
     0    1
0  582   69
1   51  579
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.88284516, 'precision': 0.8826269, 'recall': 0.88391745, 'specificity': 0.88391745, 'f1': 0.88271374, 'auroc': 0.93897235, 'binary_precision': 0.9087137, 'binary_recall': 0.8656126, 'binary_specificity': 0.9022222, 'binary_f1_score': 0.88663965}
confusion matrix:
     0    1
0  203   22
1   34  219
early stop counter: 5
val acc:0.9063231945037842, best validation acc: 0.9172521233558655, corresponding to test acc:                         0.910041868686676 / 0.910041868686676
after epoch: 13,now: 2024-07-13 08:54:29.800918,epoch time: 0:16:21.586542,used: 3:30:41.632669,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_05_23_48_seed_1_21955594
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 13 with time: 3:30:41.632669 at 2024-07-13 08:54:29.800918
persisted model performance metric: 

scalar performance:
{'acc': 0.91004187, 'precision': 0.9135089, 'recall': 0.9132982, 'specificity': 0.9132982, 'f1': 0.91004145, 'auroc': 0.9465085, 'binary_precision': 0.96875, 'binary_recall': 0.8577075, 'binary_specificity': 0.9688889, 'binary_f1_score': 0.9098532}
confusion matrix:
     0    1
0  218    7
1   36  217
oracle model performance metric: 

scalar performance:
{'acc': 0.91004187, 'precision': 0.9135089, 'recall': 0.9132982, 'specificity': 0.9132982, 'f1': 0.91004145, 'auroc': 0.9465085, 'binary_precision': 0.96875, 'binary_recall': 0.8577075, 'binary_specificity': 0.9688889, 'binary_f1_score': 0.9098532}
confusion matrix:
     0    1
0  218    7
1   36  217
results aggregation path: zoutput/benchmarks/CAMELYONWILD_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_halffreeze/rule_results/0.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONWILD_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_halffreeze/confusion_matrix/0.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 318667 KiB |   1124 MiB | 406252 GiB | 406252 GiB |
|       from large pool | 291484 KiB |   1100 MiB | 400317 GiB | 400317 GiB |
|       from small pool |  27182 KiB |     43 MiB |   5935 GiB |   5935 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 318667 KiB |   1124 MiB | 406252 GiB | 406252 GiB |
|       from large pool | 291484 KiB |   1100 MiB | 400317 GiB | 400317 GiB |
|       from small pool |  27182 KiB |     43 MiB |   5935 GiB |   5935 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 313851 KiB |   1121 MiB | 406019 GiB | 406019 GiB |
|       from large pool | 286862 KiB |   1098 MiB | 400095 GiB | 400094 GiB |
|       from small pool |  26989 KiB |     43 MiB |   5924 GiB |   5924 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1314 MiB |   1320 MiB |   2126 MiB |    812 MiB |
|       from large pool |   1264 MiB |   1270 MiB |   2058 MiB |    794 MiB |
|       from small pool |     50 MiB |     50 MiB |     68 MiB |     18 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 242485 KiB | 279565 KiB | 313736 GiB | 313736 GiB |
|       from large pool | 236899 KiB | 275811 KiB | 307584 GiB | 307584 GiB |
|       from small pool |   5585 KiB |  15280 KiB |   6151 GiB |   6151 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    1058    |    4629    |   76740 K  |   76739 K  |
|       from large pool |     130    |     212    |   37772 K  |   37772 K  |
|       from small pool |     928    |    4498    |   38967 K  |   38966 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    1058    |    4629    |   76740 K  |   76739 K  |
|       from large pool |     130    |     212    |   37772 K  |   37772 K  |
|       from small pool |     928    |    4498    |   38967 K  |   38966 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      78    |      78    |     118    |      40    |
|       from large pool |      53    |      53    |      84    |      31    |
|       from small pool |      25    |      25    |      34    |       9    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      53    |    1989    |   42206 K  |   42206 K  |
|       from large pool |      26    |      54    |   24045 K  |   24045 K  |
|       from small pool |      27    |    1963    |   18161 K  |   18161 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   1124 MiB | 406252 GiB | 406252 GiB |
|       from large pool |  16640 KiB |   1100 MiB | 400317 GiB | 400317 GiB |
|       from small pool |      0 KiB |     43 MiB |   5935 GiB |   5935 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   1124 MiB | 406252 GiB | 406252 GiB |
|       from large pool |  16640 KiB |   1100 MiB | 400317 GiB | 400317 GiB |
|       from small pool |      0 KiB |     43 MiB |   5935 GiB |   5935 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   1121 MiB | 406019 GiB | 406019 GiB |
|       from large pool |  16640 KiB |   1098 MiB | 400095 GiB | 400095 GiB |
|       from small pool |      0 KiB |     43 MiB |   5924 GiB |   5924 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 561152 KiB |   1320 MiB |   2126 MiB |   1578 MiB |
|       from large pool | 528384 KiB |   1270 MiB |   2058 MiB |   1542 MiB |
|       from small pool |  32768 KiB |     50 MiB |     68 MiB |     36 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 289072 KiB | 313736 GiB | 313736 GiB |
|       from large pool |  24320 KiB | 281114 KiB | 307584 GiB | 307584 GiB |
|       from small pool |      0 KiB |  15283 KiB |   6151 GiB |   6151 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    4629    |   76740 K  |   76740 K  |
|       from large pool |       2    |     212    |   37772 K  |   37772 K  |
|       from small pool |       0    |    4498    |   38967 K  |   38967 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    4629    |   76740 K  |   76740 K  |
|       from large pool |       2    |     212    |   37772 K  |   37772 K  |
|       from small pool |       0    |    4498    |   38967 K  |   38967 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      40    |      78    |     118    |      78    |
|       from large pool |      24    |      53    |      84    |      60    |
|       from small pool |      16    |      25    |      34    |      18    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    1989    |   42207 K  |   42207 K  |
|       from large pool |       4    |      54    |   24045 K  |   24045 K  |
|       from small pool |       0    |    1963    |   18161 K  |   18161 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   1124 MiB | 406252 GiB | 406252 GiB |
|       from large pool |  16640 KiB |   1100 MiB | 400317 GiB | 400317 GiB |
|       from small pool |      0 KiB |     43 MiB |   5935 GiB |   5935 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   1124 MiB | 406252 GiB | 406252 GiB |
|       from large pool |  16640 KiB |   1100 MiB | 400317 GiB | 400317 GiB |
|       from small pool |      0 KiB |     43 MiB |   5935 GiB |   5935 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   1121 MiB | 406019 GiB | 406019 GiB |
|       from large pool |  16640 KiB |   1098 MiB | 400095 GiB | 400095 GiB |
|       from small pool |      0 KiB |     43 MiB |   5924 GiB |   5924 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 561152 KiB |   1320 MiB |   2126 MiB |   1578 MiB |
|       from large pool | 528384 KiB |   1270 MiB |   2058 MiB |   1542 MiB |
|       from small pool |  32768 KiB |     50 MiB |     68 MiB |     36 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 289072 KiB | 313736 GiB | 313736 GiB |
|       from large pool |  24320 KiB | 281114 KiB | 307584 GiB | 307584 GiB |
|       from small pool |      0 KiB |  15283 KiB |   6151 GiB |   6151 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    4629    |   76740 K  |   76740 K  |
|       from large pool |       2    |     212    |   37772 K  |   37772 K  |
|       from small pool |       0    |    4498    |   38967 K  |   38967 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    4629    |   76740 K  |   76740 K  |
|       from large pool |       2    |     212    |   37772 K  |   37772 K  |
|       from small pool |       0    |    4498    |   38967 K  |   38967 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      40    |      78    |     118    |      78    |
|       from large pool |      24    |      53    |      84    |      60    |
|       from small pool |      16    |      25    |      34    |      18    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    1989    |   42207 K  |   42207 K  |
|       from large pool |       4    |      54    |   24045 K  |   24045 K  |
|       from small pool |       0    |    1963    |   18161 K  |   18161 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_09_08_07_seed_2_21955594

 Experiment start at: 2024-07-13 09:08:07.772026
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
before training, model accuracy: 0.3810526132583618
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.987602, 'precision': 0.90861404, 'recall': 0.9712583, 'specificity': 0.9712583, 'f1': 0.93741274, 'auroc': 0.9977726, 'binary_precision': 0.9976024, 'binary_recall': 0.9893503, 'binary_specificity': 0.95316625, 'binary_f1_score': 0.99345917}
confusion matrix:
      0      1
0  1445     71
1   318  29542
---- Validation: 
scalar performance:
{'acc': 0.7887324, 'precision': 0.8243301, 'recall': 0.7930824, 'specificity': 0.7930824, 'f1': 0.7843591, 'auroc': 0.9369731, 'binary_precision': 0.7100239, 'binary_recall': 0.95659167, 'binary_specificity': 0.62957317, 'binary_f1_score': 0.81506854}
confusion matrix:
     0    1
0  413  243
1   27  595
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7642105, 'precision': 0.81437826, 'recall': 0.74458385, 'specificity': 0.74458385, 'f1': 0.7434909, 'auroc': 0.9417095, 'binary_precision': 0.7094017, 'binary_recall': 0.96138996, 'binary_specificity': 0.5277778, 'binary_f1_score': 0.8163935}
confusion matrix:
     0    1
0  114  102
1   10  249
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-13 09:24:37.157604,epoch time: 0:16:29.385578,used: 0:16:29.385578,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_09_08_07_seed_2_21955594
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9939125, 'precision': 0.96123505, 'recall': 0.9736345, 'specificity': 0.9736345, 'f1': 0.96734285, 'auroc': 0.99924886, 'binary_precision': 0.9975182, 'binary_recall': 0.9960817, 'binary_specificity': 0.9511873, 'binary_f1_score': 0.9967994}
confusion matrix:
      0      1
0  1442     74
1   117  29743
---- Validation: 
scalar performance:
{'acc': 0.7887324, 'precision': 0.82981217, 'recall': 0.79337406, 'specificity': 0.79337406, 'f1': 0.78364354, 'auroc': 0.9401101, 'binary_precision': 0.7065728, 'binary_recall': 0.9678457, 'binary_specificity': 0.61890244, 'binary_f1_score': 0.816825}
confusion matrix:
     0    1
0  406  250
1   20  602
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7642105, 'precision': 0.81437826, 'recall': 0.74458385, 'specificity': 0.74458385, 'f1': 0.7434909, 'auroc': 0.9312885, 'binary_precision': 0.7094017, 'binary_recall': 0.96138996, 'binary_specificity': 0.5277778, 'binary_f1_score': 0.8163935}
confusion matrix:
     0    1
0  114  102
1   10  249
early stop counter: 1
val acc:0.7887324094772339, best validation acc: 0.7887324094772339, corresponding to test acc:                         0.7642105221748352 / 0.7642105221748352
after epoch: 2,now: 2024-07-13 09:40:55.805760,epoch time: 0:16:18.648156,used: 0:32:48.033734,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_09_08_07_seed_2_21955594
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9894824, 'precision': 0.9886101, 'recall': 0.895857, 'specificity': 0.895857, 'f1': 0.9368556, 'auroc': 0.99922884, 'binary_precision': 0.9895557, 'binary_recall': 0.99949765, 'binary_specificity': 0.79221636, 'binary_f1_score': 0.9945018}
confusion matrix:
      0      1
0  1201    315
1    15  29845
---- Validation: 
scalar performance:
{'acc': 0.7394366, 'precision': 0.80574214, 'recall': 0.7455224, 'specificity': 0.7455224, 'f1': 0.7275446, 'auroc': 0.94303143, 'binary_precision': 0.6565547, 'binary_recall': 0.97427654, 'binary_specificity': 0.5167683, 'binary_f1_score': 0.784466}
confusion matrix:
     0    1
0  339  317
1   16  606
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.74526316, 'precision': 0.81571263, 'recall': 0.72221327, 'specificity': 0.72221327, 'f1': 0.71620226, 'auroc': 0.9525955, 'binary_precision': 0.6875, 'binary_recall': 0.976834, 'binary_specificity': 0.4675926, 'binary_f1_score': 0.80701756}
confusion matrix:
     0    1
0  101  115
1    6  253
early stop counter: 2
val acc:0.7394366264343262, best validation acc: 0.7887324094772339, corresponding to test acc:                         0.7642105221748352 / 0.7642105221748352
after epoch: 3,now: 2024-07-13 09:57:16.464270,epoch time: 0:16:20.658510,used: 0:49:08.692244,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_09_08_07_seed_2_21955594
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9945181, 'precision': 0.959754, 'recall': 0.98271865, 'specificity': 0.98271865, 'f1': 0.97092307, 'auroc': 0.9993839, 'binary_precision': 0.99845535, 'binary_recall': 0.9957803, 'binary_specificity': 0.969657, 'binary_f1_score': 0.997116}
confusion matrix:
      0      1
0  1470     46
1   126  29734
---- Validation: 
scalar performance:
{'acc': 0.900626, 'precision': 0.9009323, 'recall': 0.90111804, 'specificity': 0.90111804, 'f1': 0.90062296, 'auroc': 0.9536458, 'binary_precision': 0.88135594, 'binary_recall': 0.91961414, 'binary_specificity': 0.88262194, 'binary_f1_score': 0.90007865}
confusion matrix:
     0    1
0  579   77
1   50  572
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.90947366, 'precision': 0.9102298, 'recall': 0.91352963, 'specificity': 0.91352963, 'f1': 0.9093435, 'auroc': 0.95123696, 'binary_precision': 0.96153843, 'binary_recall': 0.8687259, 'binary_specificity': 0.9583333, 'binary_f1_score': 0.9127789}
confusion matrix:
     0    1
0  207    9
1   34  225
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-07-13 10:13:39.095153,epoch time: 0:16:22.630883,used: 1:05:31.323127,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_09_08_07_seed_2_21955594
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9927014, 'precision': 0.9421405, 'recall': 0.9842688, 'specificity': 0.9842688, 'f1': 0.962128, 'auroc': 0.9992597, 'binary_precision': 0.9987208, 'binary_recall': 0.99360347, 'binary_specificity': 0.97493404, 'binary_f1_score': 0.9961555}
confusion matrix:
      0      1
0  1478     38
1   191  29669
---- Validation: 
scalar performance:
{'acc': 0.8802817, 'precision': 0.88105357, 'recall': 0.8796761, 'specificity': 0.8796761, 'f1': 0.880026, 'auroc': 0.9404385, 'binary_precision': 0.8927973, 'binary_recall': 0.8569132, 'binary_specificity': 0.902439, 'binary_f1_score': 0.8744873}
confusion matrix:
     0    1
0  592   64
1   89  533
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.86526316, 'precision': 0.8739114, 'recall': 0.87298906, 'specificity': 0.87298906, 'f1': 0.86525774, 'auroc': 0.94696486, 'binary_precision': 0.9577465, 'binary_recall': 0.7876448, 'binary_specificity': 0.9583333, 'binary_f1_score': 0.86440676}
confusion matrix:
     0    1
0  207    9
1   55  204
early stop counter: 1
val acc:0.8802816867828369, best validation acc: 0.900626003742218, corresponding to test acc:                         0.9094736576080322 / 0.9094736576080322
after epoch: 5,now: 2024-07-13 10:30:13.973797,epoch time: 0:16:34.878644,used: 1:22:06.201771,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_09_08_07_seed_2_21955594
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9960161, 'precision': 0.98651767, 'recall': 0.96973056, 'specificity': 0.96973056, 'f1': 0.97796017, 'auroc': 0.999684, 'binary_precision': 0.99699146, 'binary_recall': 0.9988279, 'binary_specificity': 0.94063324, 'binary_f1_score': 0.99790883}
confusion matrix:
      0      1
0  1426     90
1    35  29825
---- Validation: 
scalar performance:
{'acc': 0.87871677, 'precision': 0.8851048, 'recall': 0.8804848, 'specificity': 0.8804848, 'f1': 0.87849164, 'auroc': 0.9497417, 'binary_precision': 0.8284107, 'binary_recall': 0.9469453, 'binary_specificity': 0.8140244, 'binary_f1_score': 0.8837209}
confusion matrix:
     0    1
0  534  122
1   33  589
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.87789476, 'precision': 0.8773854, 'recall': 0.8761172, 'specificity': 0.8761172, 'f1': 0.8766874, 'auroc': 0.94095886, 'binary_precision': 0.88212925, 'binary_recall': 0.8957529, 'binary_specificity': 0.8564815, 'binary_f1_score': 0.8888889}
confusion matrix:
     0    1
0  185   31
1   27  232
early stop counter: 2
val acc:0.878716766834259, best validation acc: 0.900626003742218, corresponding to test acc:                         0.9094736576080322 / 0.9094736576080322
after epoch: 6,now: 2024-07-13 10:47:01.294854,epoch time: 0:16:47.321057,used: 1:38:53.522828,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_09_08_07_seed_2_21955594
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9947093, 'precision': 0.9563812, 'recall': 0.9893936, 'specificity': 0.9893936, 'f1': 0.9722415, 'auroc': 0.9996184, 'binary_precision': 0.9991595, 'binary_recall': 0.99527794, 'binary_specificity': 0.98350924, 'binary_f1_score': 0.997215}
confusion matrix:
      0      1
0  1491     25
1   141  29719
---- Validation: 
scalar performance:
{'acc': 0.9021909, 'precision': 0.902623, 'recall': 0.9017675, 'specificity': 0.9017675, 'f1': 0.90203494, 'auroc': 0.95416296, 'binary_precision': 0.9107438, 'binary_recall': 0.8858521, 'binary_specificity': 0.91768295, 'binary_f1_score': 0.8981255}
confusion matrix:
     0    1
0  602   54
1   71  551
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8821053, 'precision': 0.8931989, 'recall': 0.89073896, 'specificity': 0.89073896, 'f1': 0.8820796, 'auroc': 0.9480909, 'binary_precision': 0.98564595, 'binary_recall': 0.7953668, 'binary_specificity': 0.9861111, 'binary_f1_score': 0.8803419}
confusion matrix:
     0    1
0  213    3
1   53  206
better model found
persisted
after epoch: 7,now: 2024-07-13 11:03:52.489039,epoch time: 0:16:51.194185,used: 1:55:44.717013,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_09_08_07_seed_2_21955594
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9956973, 'precision': 0.9900713, 'recall': 0.9626756, 'specificity': 0.9626756, 'f1': 0.9759356, 'auroc': 0.9996569, 'binary_precision': 0.9962603, 'binary_recall': 0.9992297, 'binary_specificity': 0.92612135, 'binary_f1_score': 0.9977428}
confusion matrix:
      0      1
0  1404    112
1    23  29837
---- Validation: 
scalar performance:
{'acc': 0.7824726, 'precision': 0.83324814, 'recall': 0.7876098, 'specificity': 0.7876098, 'f1': 0.7758297, 'auroc': 0.9553081, 'binary_precision': 0.69634706, 'binary_recall': 0.9807074, 'binary_specificity': 0.5945122, 'binary_f1_score': 0.81441927}
confusion matrix:
     0    1
0  390  266
1   12  610
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7768421, 'precision': 0.8198494, 'recall': 0.7588571, 'specificity': 0.7588571, 'f1': 0.75966126, 'auroc': 0.9448019, 'binary_precision': 0.72303206, 'binary_recall': 0.95752895, 'binary_specificity': 0.5601852, 'binary_f1_score': 0.8239202}
confusion matrix:
     0    1
0  121   95
1   11  248
early stop counter: 1
val acc:0.7824726104736328, best validation acc: 0.9021909236907959, corresponding to test acc:                         0.88210529088974 / 0.9094736576080322
after epoch: 8,now: 2024-07-13 11:20:41.354978,epoch time: 0:16:48.865939,used: 2:12:33.582952,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_09_08_07_seed_2_21955594
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9963029, 'precision': 0.9917736, 'recall': 0.96768975, 'specificity': 0.96768975, 'f1': 0.97939575, 'auroc': 0.99980336, 'binary_precision': 0.99675995, 'binary_recall': 0.9993637, 'binary_specificity': 0.93601584, 'binary_f1_score': 0.99806017}
confusion matrix:
      0      1
0  1419     97
1    19  29841
---- Validation: 
scalar performance:
{'acc': 0.8685446, 'precision': 0.8801442, 'recall': 0.8709097, 'specificity': 0.8709097, 'f1': 0.8679742, 'auroc': 0.9540392, 'binary_precision': 0.80675673, 'binary_recall': 0.9598071, 'binary_specificity': 0.7820122, 'binary_f1_score': 0.87665194}
confusion matrix:
     0    1
0  513  143
1   25  597
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.88, 'precision': 0.8868909, 'recall': 0.8738203, 'specificity': 0.8738203, 'f1': 0.877336, 'auroc': 0.9462677, 'binary_precision': 0.85314685, 'binary_recall': 0.94208497, 'binary_specificity': 0.8055556, 'binary_f1_score': 0.89541286}
confusion matrix:
     0    1
0  174   42
1   15  244
early stop counter: 2
val acc:0.8685445785522461, best validation acc: 0.9021909236907959, corresponding to test acc:                         0.88210529088974 / 0.9094736576080322
after epoch: 9,now: 2024-07-13 11:37:31.328101,epoch time: 0:16:49.973123,used: 2:29:23.556075,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_09_08_07_seed_2_21955594
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.996781, 'precision': 0.9780817, 'recall': 0.9873513, 'specificity': 0.9873513, 'f1': 0.98266685, 'auroc': 0.99976516, 'binary_precision': 0.9988266, 'binary_recall': 0.9977897, 'binary_specificity': 0.9769129, 'binary_f1_score': 0.9983079}
confusion matrix:
      0      1
0  1481     35
1    66  29794
---- Validation: 
scalar performance:
{'acc': 0.8967136, 'precision': 0.89798623, 'recall': 0.897557, 'specificity': 0.897557, 'f1': 0.8967073, 'auroc': 0.95430756, 'binary_precision': 0.8678679, 'binary_recall': 0.92926043, 'binary_specificity': 0.86585367, 'binary_f1_score': 0.89751554}
confusion matrix:
     0    1
0  568   88
1   44  578
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.88631576, 'precision': 0.8850268, 'recall': 0.887298, 'specificity': 0.887298, 'f1': 0.88576436, 'auroc': 0.9359181, 'binary_precision': 0.9116466, 'binary_recall': 0.87644786, 'binary_specificity': 0.8981481, 'binary_f1_score': 0.8937007}
confusion matrix:
     0    1
0  194   22
1   32  227
early stop counter: 3
val acc:0.8967136144638062, best validation acc: 0.9021909236907959, corresponding to test acc:                         0.88210529088974 / 0.9094736576080322
after epoch: 10,now: 2024-07-13 11:54:21.055855,epoch time: 0:16:49.727754,used: 2:46:13.283829,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_09_08_07_seed_2_21955594
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9949962, 'precision': 0.9932444, 'recall': 0.9519758, 'specificity': 0.9519758, 'f1': 0.9716102, 'auroc': 0.9998002, 'binary_precision': 0.9951655, 'binary_recall': 0.99959815, 'binary_specificity': 0.90435356, 'binary_f1_score': 0.997377}
confusion matrix:
      0      1
0  1371    145
1    12  29848
---- Validation: 
scalar performance:
{'acc': 0.87089205, 'precision': 0.88553596, 'recall': 0.87352955, 'specificity': 0.87352955, 'f1': 0.87014395, 'auroc': 0.9594297, 'binary_precision': 0.80345285, 'binary_recall': 0.9726688, 'binary_specificity': 0.7743902, 'binary_f1_score': 0.88000005}
confusion matrix:
     0    1
0  508  148
1   17  605
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.87157893, 'precision': 0.88943714, 'recall': 0.86187077, 'specificity': 0.86187077, 'f1': 0.8670146, 'auroc': 0.937652, 'binary_precision': 0.8256579, 'binary_recall': 0.969112, 'binary_specificity': 0.7546296, 'binary_f1_score': 0.89165187}
confusion matrix:
     0    1
0  163   53
1    8  251
early stop counter: 4
val acc:0.8708920478820801, best validation acc: 0.9021909236907959, corresponding to test acc:                         0.88210529088974 / 0.9094736576080322
after epoch: 11,now: 2024-07-13 12:11:14.263597,epoch time: 0:16:53.207742,used: 3:03:06.491571,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_09_08_07_seed_2_21955594
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9902155, 'precision': 0.9913904, 'recall': 0.90156436, 'specificity': 0.90156436, 'f1': 0.9414815, 'auroc': 0.99955887, 'binary_precision': 0.99011576, 'binary_recall': 0.9996986, 'binary_specificity': 0.8034301, 'binary_f1_score': 0.99488413}
confusion matrix:
      0      1
0  1218    298
1     9  29851
---- Validation: 
scalar performance:
{'acc': 0.82159626, 'precision': 0.84825087, 'recall': 0.82526124, 'specificity': 0.82526124, 'f1': 0.81917113, 'auroc': 0.94384265, 'binary_precision': 0.74502486, 'binary_recall': 0.96302253, 'binary_specificity': 0.6875, 'binary_f1_score': 0.8401122}
confusion matrix:
     0    1
0  451  205
1   23  599
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.82736844, 'precision': 0.8421408, 'recall': 0.8171028, 'specificity': 0.8171028, 'f1': 0.8210873, 'auroc': 0.8976476, 'binary_precision': 0.79016393, 'binary_recall': 0.93050194, 'binary_specificity': 0.7037037, 'binary_f1_score': 0.85460985}
confusion matrix:
     0    1
0  152   64
1   18  241
early stop counter: 5
val acc:0.8215962648391724, best validation acc: 0.9021909236907959, corresponding to test acc:                         0.88210529088974 / 0.9094736576080322
after epoch: 12,now: 2024-07-13 12:28:03.005876,epoch time: 0:16:48.742279,used: 3:19:55.233850,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_09_08_07_seed_2_21955594
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 12 with time: 3:19:55.233850 at 2024-07-13 12:28:03.005876
persisted model performance metric: 

scalar performance:
{'acc': 0.8821053, 'precision': 0.8931989, 'recall': 0.89073896, 'specificity': 0.89073896, 'f1': 0.8820796, 'auroc': 0.9480909, 'binary_precision': 0.98564595, 'binary_recall': 0.7953668, 'binary_specificity': 0.9861111, 'binary_f1_score': 0.8803419}
confusion matrix:
     0    1
0  213    3
1   53  206
oracle model performance metric: 

scalar performance:
{'acc': 0.90947366, 'precision': 0.9102298, 'recall': 0.91352963, 'specificity': 0.91352963, 'f1': 0.9093435, 'auroc': 0.95123696, 'binary_precision': 0.96153843, 'binary_recall': 0.8687259, 'binary_specificity': 0.9583333, 'binary_f1_score': 0.9127789}
confusion matrix:
     0    1
0  207    9
1   34  225
results aggregation path: zoutput/benchmarks/CAMELYONWILD_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_halffreeze/rule_results/0.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONWILD_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_halffreeze/confusion_matrix/0.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 317603 KiB |   1124 MiB | 588574 GiB | 588574 GiB |
|       from large pool | 290420 KiB |   1100 MiB | 579972 GiB | 579972 GiB |
|       from small pool |  27182 KiB |     43 MiB |   8601 GiB |   8601 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 317603 KiB |   1124 MiB | 588574 GiB | 588574 GiB |
|       from large pool | 290420 KiB |   1100 MiB | 579972 GiB | 579972 GiB |
|       from small pool |  27182 KiB |     43 MiB |   8601 GiB |   8601 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 313851 KiB |   1121 MiB | 588260 GiB | 588259 GiB |
|       from large pool | 286862 KiB |   1098 MiB | 579673 GiB | 579673 GiB |
|       from small pool |  26989 KiB |     43 MiB |   8586 GiB |   8586 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1322 MiB |   1322 MiB |   2900 MiB |   1578 MiB |
|       from large pool |   1272 MiB |   1272 MiB |   2814 MiB |   1542 MiB |
|       from small pool |     50 MiB |     50 MiB |     86 MiB |     36 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 216925 KiB | 289072 KiB | 452994 GiB | 452994 GiB |
|       from large pool | 211339 KiB | 281114 KiB | 444079 GiB | 444079 GiB |
|       from small pool |   5585 KiB |  15283 KiB |   8915 GiB |   8915 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    1058    |    4649    |  111147 K  |  111146 K  |
|       from large pool |     130    |     212    |   54727 K  |   54727 K  |
|       from small pool |     928    |    4518    |   56419 K  |   56418 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    1058    |    4649    |  111147 K  |  111146 K  |
|       from large pool |     130    |     212    |   54727 K  |   54727 K  |
|       from small pool |     928    |    4518    |   56419 K  |   56418 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      79    |      79    |     157    |      78    |
|       from large pool |      54    |      54    |     114    |      60    |
|       from small pool |      25    |      25    |      43    |      18    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      56    |    2002    |   61755 K  |   61755 K  |
|       from large pool |      27    |      56    |   35518 K  |   35518 K  |
|       from small pool |      29    |    1975    |   26236 K  |   26236 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   1124 MiB | 588574 GiB | 588574 GiB |
|       from large pool |  16640 KiB |   1100 MiB | 579972 GiB | 579972 GiB |
|       from small pool |      0 KiB |     43 MiB |   8601 GiB |   8601 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   1124 MiB | 588574 GiB | 588574 GiB |
|       from large pool |  16640 KiB |   1100 MiB | 579972 GiB | 579972 GiB |
|       from small pool |      0 KiB |     43 MiB |   8601 GiB |   8601 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   1121 MiB | 588260 GiB | 588260 GiB |
|       from large pool |  16640 KiB |   1098 MiB | 579673 GiB | 579673 GiB |
|       from small pool |      0 KiB |     43 MiB |   8586 GiB |   8586 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 534528 KiB |   1322 MiB |   2900 MiB |   2378 MiB |
|       from large pool | 501760 KiB |   1272 MiB |   2814 MiB |   2324 MiB |
|       from small pool |  32768 KiB |     50 MiB |     86 MiB |     54 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 289072 KiB | 452995 GiB | 452995 GiB |
|       from large pool |  24320 KiB | 281114 KiB | 444079 GiB | 444079 GiB |
|       from small pool |      0 KiB |  17331 KiB |   8915 GiB |   8915 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    4649    |  111147 K  |  111147 K  |
|       from large pool |       2    |     212    |   54727 K  |   54727 K  |
|       from small pool |       0    |    4518    |   56419 K  |   56419 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    4649    |  111147 K  |  111147 K  |
|       from large pool |       2    |     212    |   54727 K  |   54727 K  |
|       from small pool |       0    |    4518    |   56419 K  |   56419 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      39    |      79    |     157    |     118    |
|       from large pool |      23    |      54    |     114    |      91    |
|       from small pool |      16    |      25    |      43    |      27    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    2002    |   61755 K  |   61755 K  |
|       from large pool |       4    |      56    |   35518 K  |   35518 K  |
|       from small pool |       0    |    1975    |   26236 K  |   26236 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Sat Jul 13 12:35:29 2024]
Finished job 0.
1 of 1 steps (100%) done
