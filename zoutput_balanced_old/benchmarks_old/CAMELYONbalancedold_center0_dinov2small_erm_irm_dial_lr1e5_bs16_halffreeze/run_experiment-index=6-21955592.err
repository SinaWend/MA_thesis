Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Sat Jul 13 00:25:01 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYONWILD_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_halffreeze/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYONWILD_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_halffreeze/rule_results/6.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=6
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/swiglu_ffn.py:51: UserWarning: xFormers is not available (SwiGLU)
  warnings.warn("xFormers is not available (SwiGLU)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/attention.py:33: UserWarning: xFormers is not available (Attention)
  warnings.warn("xFormers is not available (Attention)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/block.py:40: UserWarning: xFormers is not available (Block)
  warnings.warn("xFormers is not available (Block)")
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_00_32_56_seed_0_21955592

 Experiment start at: 2024-07-13 00:32:56.568036
before training, model accuracy: 0.5360825061798096
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9915445, 'precision': 0.9538562, 'recall': 0.9552732, 'specificity': 0.9552732, 'f1': 0.9545635, 'auroc': 0.9972809, 'binary_precision': 0.99563897, 'binary_recall': 0.9954707, 'binary_specificity': 0.9150757, 'binary_f1_score': 0.9955548}
confusion matrix:
      0      1
0  1390    129
1   134  29451
---- Validation: 
scalar performance:
{'acc': 0.7826087, 'precision': 0.82635975, 'recall': 0.7851491, 'specificity': 0.7851491, 'f1': 0.77607566, 'auroc': 0.94394374, 'binary_precision': 0.7033219, 'binary_recall': 0.96692914, 'binary_specificity': 0.60336906, 'binary_f1_score': 0.8143236}
confusion matrix:
     0    1
0  394  259
1   21  614
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7814433, 'precision': 0.8189947, 'recall': 0.7596469, 'specificity': 0.7596469, 'f1': 0.7630875, 'auroc': 0.93729544, 'binary_precision': 0.7342857, 'binary_recall': 0.95185184, 'binary_specificity': 0.5674419, 'binary_f1_score': 0.82903224}
confusion matrix:
     0    1
0  122   93
1   13  257
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-13 01:01:56.464701,epoch time: 0:28:59.896665,used: 0:28:59.896665,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_00_32_56_seed_0_21955592
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9941487, 'precision': 0.98005915, 'recall': 0.95598924, 'specificity': 0.95598924, 'f1': 0.9676794, 'auroc': 0.9992599, 'binary_precision': 0.9955842, 'binary_recall': 0.99827623, 'binary_specificity': 0.91370225, 'binary_f1_score': 0.9969284}
confusion matrix:
      0      1
0  1387    131
1    51  29535
---- Validation: 
scalar performance:
{'acc': 0.8206522, 'precision': 0.8499435, 'recall': 0.82266825, 'specificity': 0.82266825, 'f1': 0.8174343, 'auroc': 0.94980407, 'binary_precision': 0.7451456, 'binary_recall': 0.96692914, 'binary_specificity': 0.6784074, 'binary_f1_score': 0.8416724}
confusion matrix:
     0    1
0  443  210
1   21  614
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8391753, 'precision': 0.8560332, 'recall': 0.8257106, 'specificity': 0.8257106, 'f1': 0.8315792, 'auroc': 0.9476141, 'binary_precision': 0.8018868, 'binary_recall': 0.9444444, 'binary_specificity': 0.7069768, 'binary_f1_score': 0.86734694}
confusion matrix:
     0    1
0  152   63
1   15  255
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-07-13 01:30:26.863493,epoch time: 0:28:30.398792,used: 0:57:30.295457,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_00_32_56_seed_0_21955592
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.99517745, 'precision': 0.9800872, 'recall': 0.96746683, 'specificity': 0.96746683, 'f1': 0.9736833, 'auroc': 0.99928725, 'binary_precision': 0.99675983, 'binary_recall': 0.9981748, 'binary_specificity': 0.9367589, 'binary_f1_score': 0.9974668}
confusion matrix:
      0      1
0  1422     96
1    54  29532
---- Validation: 
scalar performance:
{'acc': 0.89052796, 'precision': 0.89720106, 'recall': 0.89145076, 'specificity': 0.89145076, 'f1': 0.8902129, 'auroc': 0.9552592, 'binary_precision': 0.84210527, 'binary_recall': 0.9574803, 'binary_specificity': 0.82542115, 'binary_f1_score': 0.8960943}
confusion matrix:
     0    1
0  539  114
1   27  608
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8742268, 'precision': 0.87522304, 'recall': 0.86950904, 'specificity': 0.86950904, 'f1': 0.8717048, 'auroc': 0.95307493, 'binary_precision': 0.8692579, 'binary_recall': 0.9111111, 'binary_specificity': 0.82790697, 'binary_f1_score': 0.8896926}
confusion matrix:
     0    1
0  178   37
1   24  246
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-07-13 01:58:58.827838,epoch time: 0:28:31.964345,used: 1:26:02.259802,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_00_32_56_seed_0_21955592
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9953704, 'precision': 0.9731177, 'recall': 0.97725517, 'specificity': 0.97725517, 'f1': 0.97517633, 'auroc': 0.999228, 'binary_precision': 0.99780196, 'binary_recall': 0.99732983, 'binary_specificity': 0.9571805, 'binary_f1_score': 0.99756587}
confusion matrix:
      0      1
0  1453     65
1    79  29507
---- Validation: 
scalar performance:
{'acc': 0.92158383, 'precision': 0.9215621, 'recall': 0.92157936, 'specificity': 0.92157936, 'f1': 0.9215702, 'auroc': 0.95609844, 'binary_precision': 0.9198113, 'binary_recall': 0.9212598, 'binary_specificity': 0.9218989, 'binary_f1_score': 0.920535}
confusion matrix:
     0    1
0  602   51
1   50  585
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8783505, 'precision': 0.87871575, 'recall': 0.8836348, 'specificity': 0.8836348, 'f1': 0.8779999, 'auroc': 0.9554005, 'binary_precision': 0.93775934, 'binary_recall': 0.837037, 'binary_specificity': 0.9302326, 'binary_f1_score': 0.88454014}
confusion matrix:
     0    1
0  200   15
1   44  226
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-07-13 02:27:38.169442,epoch time: 0:28:39.341604,used: 1:54:41.601406,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_00_32_56_seed_0_21955592
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9953382, 'precision': 0.9698258, 'recall': 0.9806756, 'specificity': 0.9806756, 'f1': 0.9751814, 'auroc': 0.99952936, 'binary_precision': 0.9981725, 'binary_recall': 0.9969242, 'binary_specificity': 0.9644269, 'binary_f1_score': 0.997548}
confusion matrix:
      0      1
0  1464     54
1    91  29495
---- Validation: 
scalar performance:
{'acc': 0.88819873, 'precision': 0.89467645, 'recall': 0.8891102, 'specificity': 0.8891102, 'f1': 0.8878862, 'auroc': 0.9441222, 'binary_precision': 0.8404993, 'binary_recall': 0.9543307, 'binary_specificity': 0.82388973, 'binary_f1_score': 0.89380527}
confusion matrix:
     0    1
0  538  115
1   29  606
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8556701, 'precision': 0.85762125, 'recall': 0.8495263, 'specificity': 0.8495263, 'f1': 0.8523245, 'auroc': 0.92465115, 'binary_precision': 0.8472222, 'binary_recall': 0.9037037, 'binary_specificity': 0.7953488, 'binary_f1_score': 0.87455195}
confusion matrix:
     0    1
0  171   44
1   26  244
early stop counter: 1
val acc:0.888198733329773, best validation acc: 0.9215838313102722, corresponding to test acc:                         0.8783504962921143 / 0.8783504962921143
after epoch: 5,now: 2024-07-13 02:56:13.360213,epoch time: 0:28:35.190771,used: 2:23:16.792177,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_00_32_56_seed_0_21955592
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9937307, 'precision': 0.95051646, 'recall': 0.98608744, 'specificity': 0.98608744, 'f1': 0.96754295, 'auroc': 0.9994782, 'binary_precision': 0.9988458, 'binary_recall': 0.99455804, 'binary_specificity': 0.97761685, 'binary_f1_score': 0.99669725}
confusion matrix:
      0      1
0  1485     34
1   161  29424
---- Validation: 
scalar performance:
{'acc': 0.9060559, 'precision': 0.90652055, 'recall': 0.90583134, 'specificity': 0.90583134, 'f1': 0.9059783, 'auroc': 0.951772, 'binary_precision': 0.9172078, 'binary_recall': 0.8897638, 'binary_specificity': 0.9218989, 'binary_f1_score': 0.9032774}
confusion matrix:
     0    1
0  602   51
1   70  565
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8886598, 'precision': 0.89046013, 'recall': 0.8952627, 'specificity': 0.8952627, 'f1': 0.8884506, 'auroc': 0.9505081, 'binary_precision': 0.9576271, 'binary_recall': 0.837037, 'binary_specificity': 0.95348835, 'binary_f1_score': 0.8932806}
confusion matrix:
     0    1
0  205   10
1   44  226
new oracle model saved
early stop counter: 2
val acc:0.9060559272766113, best validation acc: 0.9215838313102722, corresponding to test acc:                         0.8783504962921143 / 0.8886597752571106
after epoch: 6,now: 2024-07-13 03:24:45.309736,epoch time: 0:28:31.949523,used: 2:51:48.741700,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_00_32_56_seed_0_21955592
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.99665636, 'precision': 0.9814267, 'recall': 0.9826292, 'specificity': 0.9826292, 'f1': 0.98202705, 'auroc': 0.99969757, 'binary_precision': 0.99830973, 'binary_recall': 0.9981747, 'binary_specificity': 0.96708363, 'binary_f1_score': 0.9982422}
confusion matrix:
      0      1
0  1469     50
1    54  29531
---- Validation: 
scalar performance:
{'acc': 0.88121116, 'precision': 0.89094, 'recall': 0.88232744, 'specificity': 0.88232744, 'f1': 0.8806667, 'auroc': 0.95283794, 'binary_precision': 0.82567567, 'binary_recall': 0.9622047, 'binary_specificity': 0.80245024, 'binary_f1_score': 0.88872725}
confusion matrix:
     0    1
0  524  129
1   24  611
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.87628865, 'precision': 0.87829006, 'recall': 0.87088716, 'specificity': 0.87088716, 'f1': 0.8735794, 'auroc': 0.9373988, 'binary_precision': 0.86713284, 'binary_recall': 0.91851854, 'binary_specificity': 0.82325584, 'binary_f1_score': 0.8920863}
confusion matrix:
     0    1
0  177   38
1   22  248
early stop counter: 3
val acc:0.8812111616134644, best validation acc: 0.9215838313102722, corresponding to test acc:                         0.8783504962921143 / 0.8886597752571106
after epoch: 7,now: 2024-07-13 03:53:24.544641,epoch time: 0:28:39.234905,used: 3:20:27.976605,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_00_32_56_seed_0_21955592
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9942451, 'precision': 0.9498858, 'recall': 0.99322516, 'specificity': 0.99322516, 'f1': 0.97043586, 'auroc': 0.99961853, 'binary_precision': 0.99959224, 'binary_recall': 0.99435544, 'binary_specificity': 0.9920949, 'binary_f1_score': 0.99696696}
confusion matrix:
      0      1
0  1506     12
1   167  29419
---- Validation: 
scalar performance:
{'acc': 0.8967391, 'precision': 0.90061796, 'recall': 0.89744604, 'specificity': 0.89744604, 'f1': 0.89658946, 'auroc': 0.94996804, 'binary_precision': 0.85754985, 'binary_recall': 0.9480315, 'binary_specificity': 0.84686065, 'binary_f1_score': 0.90052354}
confusion matrix:
     0    1
0  553  100
1   33  602
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.89484537, 'precision': 0.8928059, 'recall': 0.896081, 'specificity': 0.896081, 'f1': 0.89397275, 'auroc': 0.95591736, 'binary_precision': 0.9227799, 'binary_recall': 0.8851852, 'binary_specificity': 0.90697676, 'binary_f1_score': 0.9035917}
confusion matrix:
     0    1
0  195   20
1   31  239
new oracle model saved
early stop counter: 4
val acc:0.89673912525177, best validation acc: 0.9215838313102722, corresponding to test acc:                         0.8783504962921143 / 0.8948453664779663
after epoch: 8,now: 2024-07-13 04:22:08.883952,epoch time: 0:28:44.339311,used: 3:49:12.315916,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_00_32_56_seed_0_21955592
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.99662423, 'precision': 0.98491734, 'recall': 0.9785528, 'specificity': 0.9785528, 'f1': 0.9817116, 'auroc': 0.99967444, 'binary_precision': 0.99787205, 'binary_recall': 0.99858034, 'binary_specificity': 0.95852536, 'binary_f1_score': 0.9982261}
confusion matrix:
      0      1
0  1456     63
1    42  29543
---- Validation: 
scalar performance:
{'acc': 0.92624223, 'precision': 0.9283287, 'recall': 0.9267596, 'specificity': 0.9267596, 'f1': 0.9261995, 'auroc': 0.96380365, 'binary_precision': 0.8947368, 'binary_recall': 0.9637795, 'binary_specificity': 0.8897397, 'binary_f1_score': 0.9279757}
confusion matrix:
     0    1
0  581   72
1   23  612
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9154639, 'precision': 0.9158133, 'recall': 0.9127046, 'specificity': 0.9127046, 'f1': 0.91405946, 'auroc': 0.9700947, 'binary_precision': 0.9133574, 'binary_recall': 0.93703705, 'binary_specificity': 0.88837206, 'binary_f1_score': 0.92504567}
confusion matrix:
     0    1
0  191   24
1   17  253
new oracle model saved
better model found
persisted
after epoch: 9,now: 2024-07-13 04:50:49.496834,epoch time: 0:28:40.612882,used: 4:17:52.928798,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_00_32_56_seed_0_21955592
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9962384, 'precision': 0.97650725, 'recall': 0.9833462, 'specificity': 0.9833462, 'f1': 0.9798995, 'auroc': 0.9996499, 'binary_precision': 0.9984101, 'binary_recall': 0.99763393, 'binary_specificity': 0.9690586, 'binary_f1_score': 0.99802184}
confusion matrix:
      0      1
0  1472     47
1    70  29515
---- Validation: 
scalar performance:
{'acc': 0.9068323, 'precision': 0.9074935, 'recall': 0.90713966, 'specificity': 0.90713966, 'f1': 0.90682423, 'auroc': 0.9594555, 'binary_precision': 0.88721806, 'binary_recall': 0.92913383, 'binary_specificity': 0.8851455, 'binary_f1_score': 0.9076923}
confusion matrix:
     0    1
0  578   75
1   45  590
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.91752577, 'precision': 0.9167942, 'recall': 0.92213607, 'specificity': 0.92213607, 'f1': 0.91718745, 'auroc': 0.96136093, 'binary_precision': 0.96747965, 'binary_recall': 0.88148147, 'binary_specificity': 0.96279067, 'binary_f1_score': 0.9224806}
confusion matrix:
     0    1
0  207    8
1   32  238
new oracle model saved
early stop counter: 1
val acc:0.9068322777748108, best validation acc: 0.9262422323226929, corresponding to test acc:                         0.915463924407959 / 0.9175257682800293
after epoch: 10,now: 2024-07-13 05:19:26.483086,epoch time: 0:28:36.986252,used: 4:46:29.915050,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_00_32_56_seed_0_21955592
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9958848, 'precision': 0.9918354, 'recall': 0.9634639, 'specificity': 0.9634639, 'f1': 0.97718096, 'auroc': 0.9997293, 'binary_precision': 0.99629354, 'binary_recall': 0.9993916, 'binary_specificity': 0.92753625, 'binary_f1_score': 0.9978402}
confusion matrix:
      0      1
0  1408    110
1    18  29568
---- Validation: 
scalar performance:
{'acc': 0.757764, 'precision': 0.8266896, 'recall': 0.7609507, 'specificity': 0.7609507, 'f1': 0.7457483, 'auroc': 0.9590744, 'binary_precision': 0.67309755, 'binary_recall': 0.98897636, 'binary_specificity': 0.53292495, 'binary_f1_score': 0.80102044}
confusion matrix:
     0    1
0  348  305
1    7  628
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.77319586, 'precision': 0.81584793, 'recall': 0.7498708, 'specificity': 0.7498708, 'f1': 0.7522569, 'auroc': 0.9522997, 'binary_precision': 0.7247191, 'binary_recall': 0.95555556, 'binary_specificity': 0.54418606, 'binary_f1_score': 0.8242811}
confusion matrix:
     0    1
0  117   98
1   12  258
early stop counter: 2
val acc:0.7577639818191528, best validation acc: 0.9262422323226929, corresponding to test acc:                         0.915463924407959 / 0.9175257682800293
after epoch: 11,now: 2024-07-13 05:48:00.668823,epoch time: 0:28:34.185737,used: 5:15:04.100787,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_00_32_56_seed_0_21955592
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9967207, 'precision': 0.98233974, 'recall': 0.98233974, 'specificity': 0.98233974, 'f1': 0.98233974, 'auroc': 0.99970245, 'binary_precision': 0.99827623, 'binary_recall': 0.99827623, 'binary_specificity': 0.9664032, 'binary_f1_score': 0.99827623}
confusion matrix:
      0      1
0  1467     51
1    51  29535
---- Validation: 
scalar performance:
{'acc': 0.9083851, 'precision': 0.9086237, 'recall': 0.90858424, 'specificity': 0.90858424, 'f1': 0.9083849, 'auroc': 0.95309114, 'binary_precision': 0.8946565, 'binary_recall': 0.92283463, 'binary_specificity': 0.89433384, 'binary_f1_score': 0.90852714}
confusion matrix:
     0    1
0  584   69
1   49  586
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9257732, 'precision': 0.92543876, 'recall': 0.9309647, 'specificity': 0.9309647, 'f1': 0.92550683, 'auroc': 0.95836353, 'binary_precision': 0.9795082, 'binary_recall': 0.8851852, 'binary_specificity': 0.9767442, 'binary_f1_score': 0.9299611}
confusion matrix:
     0    1
0  210    5
1   31  239
new oracle model saved
early stop counter: 3
val acc:0.9083850979804993, best validation acc: 0.9262422323226929, corresponding to test acc:                         0.915463924407959 / 0.9257732033729553
after epoch: 12,now: 2024-07-13 06:16:37.833145,epoch time: 0:28:37.164322,used: 5:43:41.265109,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_00_32_56_seed_0_21955592
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9954668, 'precision': 0.9657973, 'recall': 0.9869928, 'specificity': 0.9869928, 'f1': 0.97613096, 'auroc': 0.9997212, 'binary_precision': 0.99884796, 'binary_recall': 0.9963834, 'binary_specificity': 0.9776021, 'binary_f1_score': 0.9976142}
confusion matrix:
      0      1
0  1484     34
1   107  29479
---- Validation: 
scalar performance:
{'acc': 0.91925466, 'precision': 0.9205142, 'recall': 0.9188916, 'specificity': 0.9188916, 'f1': 0.9191328, 'auroc': 0.9618044, 'binary_precision': 0.9402985, 'binary_recall': 0.8929134, 'binary_specificity': 0.9448698, 'binary_f1_score': 0.9159936}
confusion matrix:
     0    1
0  617   36
1   68  567
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.89484537, 'precision': 0.90010417, 'recall': 0.90366066, 'specificity': 0.90366066, 'f1': 0.89478093, 'auroc': 0.95781225, 'binary_precision': 0.98237884, 'binary_recall': 0.82592595, 'binary_specificity': 0.98139536, 'binary_f1_score': 0.8973843}
confusion matrix:
     0    1
0  211    4
1   47  223
early stop counter: 4
val acc:0.9192546606063843, best validation acc: 0.9262422323226929, corresponding to test acc:                         0.915463924407959 / 0.9257732033729553
after epoch: 13,now: 2024-07-13 06:45:15.296265,epoch time: 0:28:37.463120,used: 6:12:18.728229,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_00_32_56_seed_0_21955592
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.99614197, 'precision': 0.9903899, 'recall': 0.96761924, 'specificity': 0.96761924, 'f1': 0.9787034, 'auroc': 0.99977016, 'binary_precision': 0.99672985, 'binary_recall': 0.99922264, 'binary_specificity': 0.93601584, 'binary_f1_score': 0.9979747}
confusion matrix:
      0      1
0  1419     97
1    23  29565
---- Validation: 
scalar performance:
{'acc': 0.8082298, 'precision': 0.8552289, 'recall': 0.8107644, 'specificity': 0.8107644, 'f1': 0.80252063, 'auroc': 0.9667628, 'binary_precision': 0.7224771, 'binary_recall': 0.992126, 'binary_specificity': 0.62940276, 'binary_f1_score': 0.83609825}
confusion matrix:
     0    1
0  411  242
1    5  630
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.843299, 'precision': 0.87116325, 'recall': 0.8270457, 'specificity': 0.8270457, 'f1': 0.833964, 'auroc': 0.9709389, 'binary_precision': 0.7939394, 'binary_recall': 0.97037035, 'binary_specificity': 0.68372095, 'binary_f1_score': 0.87333333}
confusion matrix:
     0    1
0  147   68
1    8  262
early stop counter: 5
val acc:0.8082298040390015, best validation acc: 0.9262422323226929, corresponding to test acc:                         0.915463924407959 / 0.9257732033729553
after epoch: 14,now: 2024-07-13 07:13:59.212913,epoch time: 0:28:43.916648,used: 6:41:02.644877,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_00_32_56_seed_0_21955592
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 14 with time: 6:41:02.644877 at 2024-07-13 07:13:59.212913
persisted model performance metric: 

scalar performance:
{'acc': 0.9154639, 'precision': 0.9158133, 'recall': 0.9127046, 'specificity': 0.9127046, 'f1': 0.91405946, 'auroc': 0.9700947, 'binary_precision': 0.9133574, 'binary_recall': 0.93703705, 'binary_specificity': 0.88837206, 'binary_f1_score': 0.92504567}
confusion matrix:
     0    1
0  191   24
1   17  253
oracle model performance metric: 

scalar performance:
{'acc': 0.9257732, 'precision': 0.92543876, 'recall': 0.9309647, 'specificity': 0.9309647, 'f1': 0.92550683, 'auroc': 0.95836353, 'binary_precision': 0.9795082, 'binary_recall': 0.8851852, 'binary_specificity': 0.9767442, 'binary_f1_score': 0.9299611}
confusion matrix:
     0    1
0  210    5
1   31  239
results aggregation path: zoutput/benchmarks/CAMELYONWILD_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_halffreeze/rule_results/6.csv
results aggregation path: zoutput/benchmarks/CAMELYONWILD_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_halffreeze/rule_results/6.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONWILD_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_halffreeze/confusion_matrix/6.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 317369 KiB |   4484 MiB | 714960 GiB | 714959 GiB |
|       from large pool | 290183 KiB |   4459 MiB | 706318 GiB | 706318 GiB |
|       from small pool |  27185 KiB |     43 MiB |   8641 GiB |   8641 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 317369 KiB |   4484 MiB | 714960 GiB | 714959 GiB |
|       from large pool | 290183 KiB |   4459 MiB | 706318 GiB | 706318 GiB |
|       from small pool |  27185 KiB |     43 MiB |   8641 GiB |   8641 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 313851 KiB |   4482 MiB | 714812 GiB | 714811 GiB |
|       from large pool | 286862 KiB |   4457 MiB | 706179 GiB | 706178 GiB |
|       from small pool |  26989 KiB |     43 MiB |   8633 GiB |   8633 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   4940 MiB |   4940 MiB |   4940 MiB |      0 B   |
|       from large pool |   4890 MiB |   4890 MiB |   4890 MiB |      0 B   |
|       from small pool |     50 MiB |     50 MiB |     50 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory | 184391 KiB | 460796 KiB | 423177 GiB | 423176 GiB |
|       from large pool | 178808 KiB | 458013 KiB | 414465 GiB | 414465 GiB |
|       from small pool |   5582 KiB |   9130 KiB |   8711 GiB |   8711 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    1064    |    4615    |  102026 K  |  102025 K  |
|       from large pool |     130    |     521    |   65287 K  |   65287 K  |
|       from small pool |     934    |    4484    |   36739 K  |   36738 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    1064    |    4615    |  102026 K  |  102025 K  |
|       from large pool |     130    |     521    |   65287 K  |   65287 K  |
|       from small pool |     934    |    4484    |   36739 K  |   36738 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     230    |     230    |     230    |       0    |
|       from large pool |     205    |     205    |     205    |       0    |
|       from small pool |      25    |      25    |      25    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      60    |    1986    |   59933 K  |   59933 K  |
|       from large pool |      26    |     208    |   45691 K  |   45691 K  |
|       from small pool |      34    |    1960    |   14241 K  |   14241 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   4484 MiB | 714960 GiB | 714960 GiB |
|       from large pool |  16640 KiB |   4459 MiB | 706318 GiB | 706318 GiB |
|       from small pool |      0 KiB |     43 MiB |   8641 GiB |   8641 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   4484 MiB | 714960 GiB | 714960 GiB |
|       from large pool |  16640 KiB |   4459 MiB | 706318 GiB | 706318 GiB |
|       from small pool |      0 KiB |     43 MiB |   8641 GiB |   8641 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   4482 MiB | 714812 GiB | 714812 GiB |
|       from large pool |  16640 KiB |   4457 MiB | 706179 GiB | 706179 GiB |
|       from small pool |      0 KiB |     43 MiB |   8633 GiB |   8633 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 501760 KiB |   4940 MiB |   4940 MiB |   4450 MiB |
|       from large pool | 468992 KiB |   4890 MiB |   4890 MiB |   4432 MiB |
|       from small pool |  32768 KiB |     50 MiB |     50 MiB |     18 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 460796 KiB | 423177 GiB | 423177 GiB |
|       from large pool |  24320 KiB | 458013 KiB | 414465 GiB | 414465 GiB |
|       from small pool |      0 KiB |  22689 KiB |   8711 GiB |   8711 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    4615    |  102026 K  |  102026 K  |
|       from large pool |       2    |     521    |   65287 K  |   65287 K  |
|       from small pool |       0    |    4484    |   36739 K  |   36739 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    4615    |  102026 K  |  102026 K  |
|       from large pool |       2    |     521    |   65287 K  |   65287 K  |
|       from small pool |       0    |    4484    |   36739 K  |   36739 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      38    |     230    |     230    |     192    |
|       from large pool |      22    |     205    |     205    |     183    |
|       from small pool |      16    |      25    |      25    |       9    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    1986    |   59933 K  |   59933 K  |
|       from large pool |       3    |     208    |   45691 K  |   45691 K  |
|       from small pool |       0    |    1960    |   14242 K  |   14242 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   4484 MiB | 714960 GiB | 714960 GiB |
|       from large pool |  16640 KiB |   4459 MiB | 706318 GiB | 706318 GiB |
|       from small pool |      0 KiB |     43 MiB |   8641 GiB |   8641 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   4484 MiB | 714960 GiB | 714960 GiB |
|       from large pool |  16640 KiB |   4459 MiB | 706318 GiB | 706318 GiB |
|       from small pool |      0 KiB |     43 MiB |   8641 GiB |   8641 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   4482 MiB | 714812 GiB | 714812 GiB |
|       from large pool |  16640 KiB |   4457 MiB | 706179 GiB | 706179 GiB |
|       from small pool |      0 KiB |     43 MiB |   8633 GiB |   8633 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 501760 KiB |   4940 MiB |   4940 MiB |   4450 MiB |
|       from large pool | 468992 KiB |   4890 MiB |   4890 MiB |   4432 MiB |
|       from small pool |  32768 KiB |     50 MiB |     50 MiB |     18 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 460796 KiB | 423177 GiB | 423177 GiB |
|       from large pool |  24320 KiB | 458013 KiB | 414465 GiB | 414465 GiB |
|       from small pool |      0 KiB |  22689 KiB |   8711 GiB |   8711 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    4615    |  102026 K  |  102026 K  |
|       from large pool |       2    |     521    |   65287 K  |   65287 K  |
|       from small pool |       0    |    4484    |   36739 K  |   36739 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    4615    |  102026 K  |  102026 K  |
|       from large pool |       2    |     521    |   65287 K  |   65287 K  |
|       from small pool |       0    |    4484    |   36739 K  |   36739 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      38    |     230    |     230    |     192    |
|       from large pool |      22    |     205    |     205    |     183    |
|       from small pool |      16    |      25    |      25    |       9    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    1986    |   59933 K  |   59933 K  |
|       from large pool |       3    |     208    |   45691 K  |   45691 K  |
|       from small pool |       0    |    1960    |   14242 K  |   14242 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_07_25_32_seed_1_21955592

 Experiment start at: 2024-07-13 07:25:32.330585
before training, model accuracy: 0.6276150345802307
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.99151075, 'precision': 0.93872654, 'recall': 0.97495306, 'specificity': 0.97495306, 'f1': 0.9560317, 'auroc': 0.9986249, 'binary_precision': 0.9977674, 'binary_recall': 0.99329853, 'binary_specificity': 0.9566075, 'binary_f1_score': 0.9955279}
confusion matrix:
      0      1
0  1455     66
1   199  29496
---- Validation: 
scalar performance:
{'acc': 0.882904, 'precision': 0.8852376, 'recall': 0.88356376, 'specificity': 0.88356376, 'f1': 0.8828262, 'auroc': 0.9443177, 'binary_precision': 0.85087717, 'binary_recall': 0.9238095, 'binary_specificity': 0.843318, 'binary_f1_score': 0.8858447}
confusion matrix:
     0    1
0  549  102
1   48  582
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8640167, 'precision': 0.8634386, 'recall': 0.8639174, 'specificity': 0.8639174, 'f1': 0.8636437, 'auroc': 0.93895483, 'binary_precision': 0.876, 'binary_recall': 0.8656126, 'binary_specificity': 0.8622222, 'binary_f1_score': 0.8707753}
confusion matrix:
     0    1
0  194   31
1   34  219
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-13 07:54:29.475772,epoch time: 0:28:57.145187,used: 0:28:57.145187,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_07_25_32_seed_1_21955592
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.99407357, 'precision': 0.96681845, 'recall': 0.9694384, 'specificity': 0.9694384, 'f1': 0.9681243, 'auroc': 0.9990422, 'binary_precision': 0.9970356, 'binary_recall': 0.9967334, 'binary_specificity': 0.9421433, 'binary_f1_score': 0.99688447}
confusion matrix:
      0      1
0  1433     88
1    97  29598
---- Validation: 
scalar performance:
{'acc': 0.90398127, 'precision': 0.9039407, 'recall': 0.9040195, 'specificity': 0.9040195, 'f1': 0.90396625, 'auroc': 0.94549286, 'binary_precision': 0.8992126, 'binary_recall': 0.9063492, 'binary_specificity': 0.9016897, 'binary_f1_score': 0.90276676}
confusion matrix:
     0    1
0  587   64
1   59  571
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9016736, 'precision': 0.9021046, 'recall': 0.9034256, 'specificity': 0.9034256, 'f1': 0.9016216, 'auroc': 0.9540272, 'binary_precision': 0.9364407, 'binary_recall': 0.8735178, 'binary_specificity': 0.93333334, 'binary_f1_score': 0.90388554}
confusion matrix:
     0    1
0  210   15
1   32  221
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-07-13 08:23:12.993075,epoch time: 0:28:43.517303,used: 0:57:40.662490,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_07_25_32_seed_1_21955592
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.99589956, 'precision': 0.98403394, 'recall': 0.97133386, 'specificity': 0.97133386, 'f1': 0.9775898, 'auroc': 0.9994063, 'binary_precision': 0.9971416, 'binary_recall': 0.99855196, 'binary_specificity': 0.9441157, 'binary_f1_score': 0.99784625}
confusion matrix:
      0      1
0  1436     85
1    43  29652
---- Validation: 
scalar performance:
{'acc': 0.84543324, 'precision': 0.8604135, 'recall': 0.84710705, 'specificity': 0.84710705, 'f1': 0.8442211, 'auroc': 0.94835055, 'binary_precision': 0.78272253, 'binary_recall': 0.94920635, 'binary_specificity': 0.7450077, 'binary_f1_score': 0.8579628}
confusion matrix:
     0    1
0  485  166
1   32  598
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8556485, 'precision': 0.8612554, 'recall': 0.8518314, 'specificity': 0.8518314, 'f1': 0.8537117, 'auroc': 0.93674135, 'binary_precision': 0.82857144, 'binary_recall': 0.91699606, 'binary_specificity': 0.7866667, 'binary_f1_score': 0.8705441}
confusion matrix:
     0    1
0  177   48
1   21  232
early stop counter: 1
val acc:0.845433235168457, best validation acc: 0.9039812684059143, corresponding to test acc:                         0.9016736149787903 / 0.9016736149787903
after epoch: 3,now: 2024-07-13 08:51:58.634743,epoch time: 0:28:45.641668,used: 1:26:26.304158,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_07_25_32_seed_1_21955592
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9961558, 'precision': 0.9891592, 'recall': 0.9689734, 'specificity': 0.9689734, 'f1': 0.97882956, 'auroc': 0.9995936, 'binary_precision': 0.9968751, 'binary_recall': 0.99909073, 'binary_specificity': 0.938856, 'binary_f1_score': 0.9979817}
confusion matrix:
      0      1
0  1428     93
1    27  29668
---- Validation: 
scalar performance:
{'acc': 0.8212334, 'precision': 0.8550822, 'recall': 0.82375836, 'specificity': 0.82375836, 'f1': 0.8176327, 'auroc': 0.9552679, 'binary_precision': 0.74127555, 'binary_recall': 0.9777778, 'binary_specificity': 0.6697389, 'binary_f1_score': 0.843258}
confusion matrix:
     0    1
0  436  215
1   14  616
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.83472806, 'precision': 0.85286224, 'recall': 0.8278876, 'specificity': 0.8278876, 'f1': 0.8300868, 'auroc': 0.94972336, 'binary_precision': 0.7861842, 'binary_recall': 0.94466406, 'binary_specificity': 0.7111111, 'binary_f1_score': 0.8581687}
confusion matrix:
     0    1
0  160   65
1   14  239
early stop counter: 2
val acc:0.8212333917617798, best validation acc: 0.9039812684059143, corresponding to test acc:                         0.9016736149787903 / 0.9016736149787903
after epoch: 4,now: 2024-07-13 09:20:41.107312,epoch time: 0:28:42.472569,used: 1:55:08.776727,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_07_25_32_seed_1_21955592
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9958034, 'precision': 0.9857837, 'recall': 0.9684763, 'specificity': 0.9684763, 'f1': 0.9769552, 'auroc': 0.9994627, 'binary_precision': 0.99684054, 'binary_recall': 0.998754, 'binary_specificity': 0.93819857, 'binary_f1_score': 0.9977964}
confusion matrix:
      0      1
0  1427     94
1    37  29658
---- Validation: 
scalar performance:
{'acc': 0.88758785, 'precision': 0.8928144, 'recall': 0.88855606, 'specificity': 0.88855606, 'f1': 0.8873648, 'auroc': 0.9545461, 'binary_precision': 0.84322035, 'binary_recall': 0.947619, 'binary_specificity': 0.8294931, 'binary_f1_score': 0.89237666}
confusion matrix:
     0    1
0  540  111
1   33  597
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.88075316, 'precision': 0.88146734, 'recall': 0.87923586, 'specificity': 0.87923586, 'f1': 0.8800343, 'auroc': 0.95624065, 'binary_precision': 0.8740458, 'binary_recall': 0.9051383, 'binary_specificity': 0.85333335, 'binary_f1_score': 0.8893204}
confusion matrix:
     0    1
0  192   33
1   24  229
early stop counter: 3
val acc:0.88758784532547, best validation acc: 0.9039812684059143, corresponding to test acc:                         0.9016736149787903 / 0.9016736149787903
after epoch: 5,now: 2024-07-13 09:49:27.124336,epoch time: 0:28:46.017024,used: 2:23:54.793751,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_07_25_32_seed_1_21955592
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.99686056, 'precision': 0.9842367, 'recall': 0.98181957, 'specificity': 0.98181957, 'f1': 0.9830248, 'auroc': 0.99974024, 'binary_precision': 0.9982157, 'binary_recall': 0.9984846, 'binary_specificity': 0.9651545, 'binary_f1_score': 0.9983501}
confusion matrix:
      0      1
0  1468     53
1    45  29650
---- Validation: 
scalar performance:
{'acc': 0.90007806, 'precision': 0.9031192, 'recall': 0.90081924, 'specificity': 0.90081924, 'f1': 0.8999853, 'auroc': 0.9580913, 'binary_precision': 0.8637681, 'binary_recall': 0.94603175, 'binary_specificity': 0.85560673, 'binary_f1_score': 0.9030302}
confusion matrix:
     0    1
0  557   94
1   34  596
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.91004187, 'precision': 0.9095197, 'recall': 0.9103469, 'specificity': 0.9103469, 'f1': 0.9098331, 'auroc': 0.9570663, 'binary_precision': 0.9233871, 'binary_recall': 0.9051383, 'binary_specificity': 0.91555554, 'binary_f1_score': 0.9141717}
confusion matrix:
     0    1
0  206   19
1   24  229
new oracle model saved
early stop counter: 4
val acc:0.9000780582427979, best validation acc: 0.9039812684059143, corresponding to test acc:                         0.9016736149787903 / 0.910041868686676
after epoch: 6,now: 2024-07-13 10:18:09.855404,epoch time: 0:28:42.731068,used: 2:52:37.524819,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_07_25_32_seed_1_21955592
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.99625194, 'precision': 0.9846162, 'recall': 0.9746218, 'specificity': 0.9746218, 'f1': 0.979561, 'auroc': 0.99967086, 'binary_precision': 0.99747723, 'binary_recall': 0.99858564, 'binary_specificity': 0.9506579, 'binary_f1_score': 0.99803114}
confusion matrix:
      0      1
0  1445     75
1    42  29654
---- Validation: 
scalar performance:
{'acc': 0.90554255, 'precision': 0.90622103, 'recall': 0.90591395, 'specificity': 0.90591395, 'f1': 0.90553683, 'auroc': 0.9567089, 'binary_precision': 0.8850227, 'binary_recall': 0.9285714, 'binary_specificity': 0.88325655, 'binary_f1_score': 0.9062742}
confusion matrix:
     0    1
0  575   76
1   45  585
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.90585774, 'precision': 0.90561724, 'recall': 0.90541065, 'specificity': 0.90541065, 'f1': 0.90550995, 'auroc': 0.95805, 'binary_precision': 0.9094488, 'binary_recall': 0.9130435, 'binary_specificity': 0.8977778, 'binary_f1_score': 0.91124254}
confusion matrix:
     0    1
0  202   23
1   22  231
better model found
persisted
after epoch: 7,now: 2024-07-13 10:46:57.111386,epoch time: 0:28:47.255982,used: 3:21:24.780801,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_07_25_32_seed_1_21955592
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9967004, 'precision': 0.986482, 'recall': 0.9776665, 'specificity': 0.9776665, 'f1': 0.9820294, 'auroc': 0.9997387, 'binary_precision': 0.99777967, 'binary_recall': 0.998754, 'binary_specificity': 0.95657897, 'binary_f1_score': 0.99826664}
confusion matrix:
      0      1
0  1454     66
1    37  29659
---- Validation: 
scalar performance:
{'acc': 0.8680718, 'precision': 0.87675166, 'recall': 0.8693292, 'specificity': 0.8693292, 'f1': 0.86755526, 'auroc': 0.9483335, 'binary_precision': 0.8153215, 'binary_recall': 0.94603175, 'binary_specificity': 0.79262674, 'binary_f1_score': 0.87582666}
confusion matrix:
     0    1
0  516  135
1   34  596
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.88075316, 'precision': 0.8808316, 'recall': 0.8797277, 'specificity': 0.8797277, 'f1': 0.880182, 'auroc': 0.94434786, 'binary_precision': 0.87984496, 'binary_recall': 0.8972332, 'binary_specificity': 0.8622222, 'binary_f1_score': 0.888454}
confusion matrix:
     0    1
0  194   31
1   26  227
early stop counter: 1
val acc:0.8680717945098877, best validation acc: 0.9055425524711609, corresponding to test acc:                         0.9058577418327332 / 0.910041868686676
after epoch: 8,now: 2024-07-13 11:15:40.760011,epoch time: 0:28:43.648625,used: 3:50:08.429426,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_07_25_32_seed_1_21955592
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.99746925, 'precision': 0.99040693, 'recall': 0.98213947, 'specificity': 0.98213947, 'f1': 0.98623407, 'auroc': 0.999822, 'binary_precision': 0.9982168, 'binary_recall': 0.9991244, 'binary_specificity': 0.9651545, 'binary_f1_score': 0.9986704}
confusion matrix:
      0      1
0  1468     53
1    26  29669
---- Validation: 
scalar performance:
{'acc': 0.91256833, 'precision': 0.9128486, 'recall': 0.9128264, 'specificity': 0.9128264, 'f1': 0.9125682, 'auroc': 0.9543096, 'binary_precision': 0.89723927, 'binary_recall': 0.9285714, 'binary_specificity': 0.89708143, 'binary_f1_score': 0.9126365}
confusion matrix:
     0    1
0  584   67
1   45  585
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92259413, 'precision': 0.92302847, 'recall': 0.9244181, 'specificity': 0.9244181, 'f1': 0.9225531, 'auroc': 0.9598243, 'binary_precision': 0.9576271, 'binary_recall': 0.8932806, 'binary_specificity': 0.95555556, 'binary_f1_score': 0.92433536}
confusion matrix:
     0    1
0  215   10
1   27  226
new oracle model saved
better model found
persisted
after epoch: 9,now: 2024-07-13 11:44:23.164063,epoch time: 0:28:42.404052,used: 4:18:50.833478,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_07_25_32_seed_1_21955592
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9962199, 'precision': 0.9892055, 'recall': 0.96963084, 'specificity': 0.96963084, 'f1': 0.9791957, 'auroc': 0.99977726, 'binary_precision': 0.9969421, 'binary_recall': 0.99909073, 'binary_specificity': 0.94017094, 'binary_f1_score': 0.9980153}
confusion matrix:
      0      1
0  1430     91
1    27  29668
---- Validation: 
scalar performance:
{'acc': 0.90554255, 'precision': 0.9092027, 'recall': 0.9063492, 'specificity': 0.9063492, 'f1': 0.905431, 'auroc': 0.9575207, 'binary_precision': 0.86618704, 'binary_recall': 0.95555556, 'binary_specificity': 0.85714287, 'binary_f1_score': 0.90867925}
confusion matrix:
     0    1
0  558   93
1   28  602
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.91841006, 'precision': 0.9182192, 'recall': 0.9180062, 'specificity': 0.9180062, 'f1': 0.91810864, 'auroc': 0.960931, 'binary_precision': 0.9212598, 'binary_recall': 0.9249012, 'binary_specificity': 0.9111111, 'binary_f1_score': 0.9230769}
confusion matrix:
     0    1
0  205   20
1   19  234
early stop counter: 1
val acc:0.9055425524711609, best validation acc: 0.9125683307647705, corresponding to test acc:                         0.9225941300392151 / 0.9225941300392151
after epoch: 10,now: 2024-07-13 12:13:02.001770,epoch time: 0:28:38.837707,used: 4:47:29.671185,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_07_25_32_seed_1_21955592
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.99746925, 'precision': 0.98416144, 'recall': 0.98868924, 'specificity': 0.98868924, 'f1': 0.9864136, 'auroc': 0.9998156, 'binary_precision': 0.9989218, 'binary_recall': 0.99841726, 'binary_specificity': 0.9789612, 'binary_f1_score': 0.9986695}
confusion matrix:
      0      1
0  1489     32
1    47  29648
---- Validation: 
scalar performance:
{'acc': 0.9141296, 'precision': 0.9155378, 'recall': 0.9146441, 'specificity': 0.9146441, 'f1': 0.9141065, 'auroc': 0.9575476, 'binary_precision': 0.8869048, 'binary_recall': 0.94603175, 'binary_specificity': 0.88325655, 'binary_f1_score': 0.91551465}
confusion matrix:
     0    1
0  575   76
1   34  596
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9121339, 'precision': 0.9122665, 'recall': 0.9113395, 'specificity': 0.9113395, 'f1': 0.91173834, 'auroc': 0.96458495, 'binary_precision': 0.91050583, 'binary_recall': 0.9249012, 'binary_specificity': 0.8977778, 'binary_f1_score': 0.91764706}
confusion matrix:
     0    1
0  202   23
1   19  234
better model found
persisted
after epoch: 11,now: 2024-07-13 12:41:44.900363,epoch time: 0:28:42.898593,used: 5:16:12.569778,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_07_25_32_seed_1_21955592
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9978216, 'precision': 0.9867748, 'recall': 0.9898101, 'specificity': 0.9898101, 'f1': 0.9882872, 'auroc': 0.99980366, 'binary_precision': 0.9990231, 'binary_recall': 0.9986867, 'binary_specificity': 0.9809336, 'binary_f1_score': 0.9988549}
confusion matrix:
      0      1
0  1492     29
1    39  29656
---- Validation: 
scalar performance:
{'acc': 0.9008587, 'precision': 0.90379465, 'recall': 0.9015873, 'specificity': 0.9015873, 'f1': 0.9007714, 'auroc': 0.95307827, 'binary_precision': 0.86502177, 'binary_recall': 0.94603175, 'binary_specificity': 0.85714287, 'binary_f1_score': 0.9037149}
confusion matrix:
     0    1
0  558   93
1   34  596
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8933054, 'precision': 0.8950383, 'recall': 0.8913395, 'specificity': 0.8913395, 'f1': 0.89251465, 'auroc': 0.94729906, 'binary_precision': 0.87969923, 'binary_recall': 0.9249012, 'binary_specificity': 0.8577778, 'binary_f1_score': 0.90173405}
confusion matrix:
     0    1
0  193   32
1   19  234
early stop counter: 1
val acc:0.9008587002754211, best validation acc: 0.9141296148300171, corresponding to test acc:                         0.9121338725090027 / 0.9225941300392151
after epoch: 12,now: 2024-07-13 13:10:19.827776,epoch time: 0:28:34.927413,used: 5:44:47.497191,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_07_25_32_seed_1_21955592
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.99413764, 'precision': 0.9893422, 'recall': 0.94670385, 'specificity': 0.94670385, 'f1': 0.96694374, 'auroc': 0.9997629, 'binary_precision': 0.99460346, 'binary_recall': 0.9992591, 'binary_specificity': 0.8941486, 'binary_f1_score': 0.99692583}
confusion matrix:
      0      1
0  1360    161
1    22  29673
---- Validation: 
scalar performance:
{'acc': 0.8696331, 'precision': 0.881983, 'recall': 0.87112135, 'specificity': 0.87112135, 'f1': 0.8688656, 'auroc': 0.9560432, 'binary_precision': 0.80907875, 'binary_recall': 0.96190476, 'binary_specificity': 0.7803379, 'binary_f1_score': 0.8788978}
confusion matrix:
     0    1
0  508  143
1   24  606
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8493724, 'precision': 0.85519445, 'recall': 0.84541065, 'specificity': 0.84541065, 'f1': 0.8472762, 'auroc': 0.93022394, 'binary_precision': 0.82206404, 'binary_recall': 0.9130435, 'binary_specificity': 0.7777778, 'binary_f1_score': 0.8651686}
confusion matrix:
     0    1
0  175   50
1   22  231
early stop counter: 2
val acc:0.8696330785751343, best validation acc: 0.9141296148300171, corresponding to test acc:                         0.9121338725090027 / 0.9225941300392151
after epoch: 13,now: 2024-07-13 13:39:05.342410,epoch time: 0:28:45.514634,used: 6:13:33.011825,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_07_25_32_seed_1_21955592
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9978216, 'precision': 0.99436545, 'recall': 0.98201275, 'specificity': 0.98201275, 'f1': 0.9881021, 'auroc': 0.9999232, 'binary_precision': 0.99818397, 'binary_recall': 0.9995285, 'binary_specificity': 0.964497, 'binary_f1_score': 0.99885577}
confusion matrix:
      0      1
0  1467     54
1    14  29681
---- Validation: 
scalar performance:
{'acc': 0.79703355, 'precision': 0.84060216, 'recall': 0.7999488, 'specificity': 0.7999488, 'f1': 0.7913733, 'auroc': 0.9567003, 'binary_precision': 0.7146172, 'binary_recall': 0.9777778, 'binary_specificity': 0.62211984, 'binary_f1_score': 0.82573724}
confusion matrix:
     0    1
0  405  246
1   14  616
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.79707116, 'precision': 0.83898866, 'recall': 0.78641194, 'specificity': 0.78641194, 'f1': 0.7859402, 'auroc': 0.94027233, 'binary_precision': 0.7335329, 'binary_recall': 0.96837944, 'binary_specificity': 0.60444444, 'binary_f1_score': 0.8347529}
confusion matrix:
     0    1
0  136   89
1    8  245
early stop counter: 3
val acc:0.7970335483551025, best validation acc: 0.9141296148300171, corresponding to test acc:                         0.9121338725090027 / 0.9225941300392151
after epoch: 14,now: 2024-07-13 14:07:46.185705,epoch time: 0:28:40.843295,used: 6:42:13.855120,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_07_25_32_seed_1_21955592
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.99718094, 'precision': 0.9799307, 'recall': 0.99009717, 'specificity': 0.99009717, 'f1': 0.9849544, 'auroc': 0.99986273, 'binary_precision': 0.9990897, 'binary_recall': 0.9979458, 'binary_specificity': 0.98224854, 'binary_f1_score': 0.9985174}
confusion matrix:
      0      1
0  1494     27
1    61  29634
---- Validation: 
scalar performance:
{'acc': 0.91959405, 'precision': 0.91955566, 'recall': 0.91961086, 'specificity': 0.91961086, 'f1': 0.9195782, 'auroc': 0.96217537, 'binary_precision': 0.91627175, 'binary_recall': 0.9206349, 'binary_specificity': 0.9185868, 'binary_f1_score': 0.91844815}
confusion matrix:
     0    1
0  598   53
1   50  580
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.89748955, 'precision': 0.8986894, 'recall': 0.8997189, 'specificity': 0.8997189, 'f1': 0.89746755, 'auroc': 0.95725954, 'binary_precision': 0.9396552, 'binary_recall': 0.86166006, 'binary_specificity': 0.93777776, 'binary_f1_score': 0.89896905}
confusion matrix:
     0    1
0  211   14
1   35  218
better model found
persisted
after epoch: 15,now: 2024-07-13 14:36:23.549134,epoch time: 0:28:37.363429,used: 7:10:51.218549,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_07_25_32_seed_1_21955592
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.99772555, 'precision': 0.9939908, 'recall': 0.9813385, 'specificity': 0.9813385, 'f1': 0.98757327, 'auroc': 0.99989146, 'binary_precision': 0.99811673, 'binary_recall': 0.99949485, 'binary_specificity': 0.9631821, 'binary_f1_score': 0.99880534}
confusion matrix:
      0      1
0  1465     56
1    15  29680
---- Validation: 
scalar performance:
{'acc': 0.87822014, 'precision': 0.88729507, 'recall': 0.8794931, 'specificity': 0.8794931, 'f1': 0.8777312, 'auroc': 0.9572227, 'binary_precision': 0.82377046, 'binary_recall': 0.95714283, 'binary_specificity': 0.80184335, 'binary_f1_score': 0.88546246}
confusion matrix:
     0    1
0  522  129
1   27  603
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.88912135, 'precision': 0.89132905, 'recall': 0.88689506, 'specificity': 0.88689506, 'f1': 0.88821673, 'auroc': 0.9622662, 'binary_precision': 0.8731343, 'binary_recall': 0.9249012, 'binary_specificity': 0.8488889, 'binary_f1_score': 0.8982725}
confusion matrix:
     0    1
0  191   34
1   19  234
early stop counter: 1
val acc:0.8782201409339905, best validation acc: 0.9195940494537354, corresponding to test acc:                         0.8974895477294922 / 0.9225941300392151
after epoch: 16,now: 2024-07-13 15:05:02.194691,epoch time: 0:28:38.645557,used: 7:39:29.864106,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_07_25_32_seed_1_21955592
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.99785364, 'precision': 0.9873874, 'recall': 0.98951507, 'specificity': 0.98951507, 'f1': 0.9884487, 'auroc': 0.9999007, 'binary_precision': 0.99898946, 'binary_recall': 0.998754, 'binary_specificity': 0.9802761, 'binary_f1_score': 0.99887174}
confusion matrix:
      0      1
0  1491     30
1    37  29658
---- Validation: 
scalar performance:
{'acc': 0.91959405, 'precision': 0.91955566, 'recall': 0.91961086, 'specificity': 0.91961086, 'f1': 0.9195782, 'auroc': 0.95881546, 'binary_precision': 0.91627175, 'binary_recall': 0.9206349, 'binary_specificity': 0.9185868, 'binary_f1_score': 0.91844815}
confusion matrix:
     0    1
0  598   53
1   50  580
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.90585774, 'precision': 0.9093082, 'recall': 0.9090997, 'specificity': 0.9090997, 'f1': 0.9058573, 'auroc': 0.9533421, 'binary_precision': 0.96428573, 'binary_recall': 0.85375494, 'binary_specificity': 0.96444446, 'binary_f1_score': 0.9056604}
confusion matrix:
     0    1
0  217    8
1   37  216
early stop counter: 2
val acc:0.9195940494537354, best validation acc: 0.9195940494537354, corresponding to test acc:                         0.8974895477294922 / 0.9225941300392151
after epoch: 17,now: 2024-07-13 15:33:39.897385,epoch time: 0:28:37.702694,used: 8:08:07.566800,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_07_25_32_seed_1_21955592
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9974052, 'precision': 0.9909768, 'recall': 0.9808582, 'specificity': 0.9808582, 'f1': 0.9858588, 'auroc': 0.999817, 'binary_precision': 0.99808264, 'binary_recall': 0.99919176, 'binary_specificity': 0.96252465, 'binary_f1_score': 0.9986369}
confusion matrix:
      0      1
0  1464     57
1    24  29671
---- Validation: 
scalar performance:
{'acc': 0.9032006, 'precision': 0.90524733, 'recall': 0.9038147, 'specificity': 0.9038147, 'f1': 0.903151, 'auroc': 0.9554995, 'binary_precision': 0.8720588, 'binary_recall': 0.9412698, 'binary_specificity': 0.8663595, 'binary_f1_score': 0.9053435}
confusion matrix:
     0    1
0  564   87
1   37  593
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92050207, 'precision': 0.9202864, 'recall': 0.921704, 'specificity': 0.921704, 'f1': 0.9204129, 'auroc': 0.9532894, 'binary_precision': 0.9460581, 'binary_recall': 0.90118575, 'binary_specificity': 0.94222224, 'binary_f1_score': 0.9230769}
confusion matrix:
     0    1
0  212   13
1   25  228
early stop counter: 3
val acc:0.903200626373291, best validation acc: 0.9195940494537354, corresponding to test acc:                         0.8974895477294922 / 0.9225941300392151
after epoch: 18,now: 2024-07-13 16:02:20.128271,epoch time: 0:28:40.230886,used: 8:36:47.797686,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_07_25_32_seed_1_21955592
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9976615, 'precision': 0.9923881, 'recall': 0.9822405, 'specificity': 0.9822405, 'f1': 0.9872555, 'auroc': 0.9998896, 'binary_precision': 0.99821717, 'binary_recall': 0.99932647, 'binary_specificity': 0.9651545, 'binary_f1_score': 0.99877155}
confusion matrix:
      0      1
0  1468     53
1    20  29675
---- Validation: 
scalar performance:
{'acc': 0.83528495, 'precision': 0.8541229, 'recall': 0.8371736, 'specificity': 0.8371736, 'f1': 0.8335709, 'auroc': 0.94265723, 'binary_precision': 0.7682458, 'binary_recall': 0.95238096, 'binary_specificity': 0.7219662, 'binary_f1_score': 0.85046065}
confusion matrix:
     0    1
0  470  181
1   30  600
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8849372, 'precision': 0.8848008, 'recall': 0.88417214, 'specificity': 0.88417214, 'f1': 0.88445127, 'auroc': 0.9468775, 'binary_precision': 0.88671875, 'binary_recall': 0.8972332, 'binary_specificity': 0.8711111, 'binary_f1_score': 0.89194494}
confusion matrix:
     0    1
0  196   29
1   26  227
early stop counter: 4
val acc:0.835284948348999, best validation acc: 0.9195940494537354, corresponding to test acc:                         0.8974895477294922 / 0.9225941300392151
after epoch: 19,now: 2024-07-13 16:30:58.422768,epoch time: 0:28:38.294497,used: 9:05:26.092183,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_07_25_32_seed_1_21955592
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9973091, 'precision': 0.97409415, 'recall': 0.99827373, 'specificity': 0.99827373, 'f1': 0.98584753, 'auroc': 0.9999318, 'binary_precision': 0.9999662, 'binary_recall': 0.9972049, 'binary_specificity': 0.99934256, 'binary_f1_score': 0.9985836}
confusion matrix:
      0      1
0  1520      1
1    83  29612
---- Validation: 
scalar performance:
{'acc': 0.9227166, 'precision': 0.92314476, 'recall': 0.9224782, 'specificity': 0.9224782, 'f1': 0.92264855, 'auroc': 0.9593227, 'binary_precision': 0.93311584, 'binary_recall': 0.9079365, 'binary_specificity': 0.93701994, 'binary_f1_score': 0.920354}
confusion matrix:
     0    1
0  610   41
1   58  572
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92050207, 'precision': 0.9230391, 'recall': 0.92342556, 'specificity': 0.92342556, 'f1': 0.92050076, 'auroc': 0.95778656, 'binary_precision': 0.97356826, 'binary_recall': 0.8735178, 'binary_specificity': 0.97333336, 'binary_f1_score': 0.92083335}
confusion matrix:
     0    1
0  219    6
1   32  221
better model found
persisted
after epoch: 20,now: 2024-07-13 16:59:37.497742,epoch time: 0:28:39.074974,used: 9:34:05.167157,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_07_25_32_seed_1_21955592
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9990069, 'precision': 0.9966457, 'recall': 0.9926164, 'specificity': 0.9926164, 'f1': 0.9946219, 'auroc': 0.9999658, 'binary_precision': 0.9992595, 'binary_recall': 0.9996969, 'binary_specificity': 0.98553586, 'binary_f1_score': 0.9994781}
confusion matrix:
      0      1
0  1499     22
1     9  29686
---- Validation: 
scalar performance:
{'acc': 0.9227166, 'precision': 0.92279506, 'recall': 0.92288786, 'specificity': 0.92288786, 'f1': 0.92271495, 'auroc': 0.96373594, 'binary_precision': 0.9116279, 'binary_recall': 0.93333334, 'binary_specificity': 0.9124424, 'binary_f1_score': 0.92235297}
confusion matrix:
     0    1
0  594   57
1   42  588
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9121339, 'precision': 0.9124079, 'recall': 0.91379887, 'specificity': 0.91379887, 'f1': 0.91207844, 'auroc': 0.9510057, 'binary_precision': 0.9451477, 'binary_recall': 0.8853755, 'binary_specificity': 0.94222224, 'binary_f1_score': 0.91428566}
confusion matrix:
     0    1
0  212   13
1   29  224
early stop counter: 1
val acc:0.9227166175842285, best validation acc: 0.9227166175842285, corresponding to test acc:                         0.9205020666122437 / 0.9225941300392151
after epoch: 21,now: 2024-07-13 17:28:15.310564,epoch time: 0:28:37.812822,used: 10:02:42.979979,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_07_25_32_seed_1_21955592
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.99711686, 'precision': 0.9741596, 'recall': 0.99598944, 'specificity': 0.99598944, 'f1': 0.98479974, 'auroc': 0.9999337, 'binary_precision': 0.99972993, 'binary_recall': 0.9972386, 'binary_specificity': 0.9947403, 'binary_f1_score': 0.9984827}
confusion matrix:
      0      1
0  1513      8
1    82  29613
---- Validation: 
scalar performance:
{'acc': 0.8797814, 'precision': 0.88997436, 'recall': 0.878469, 'specificity': 0.878469, 'f1': 0.8786992, 'auroc': 0.9540756, 'binary_precision': 0.9490566, 'binary_recall': 0.7984127, 'binary_specificity': 0.95852536, 'binary_f1_score': 0.8672414}
confusion matrix:
     0    1
0  624   27
1  127  503
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.83682007, 'precision': 0.8654501, 'recall': 0.84511197, 'specificity': 0.84511197, 'f1': 0.8354256, 'auroc': 0.93719804, 'binary_precision': 0.98342544, 'binary_recall': 0.7035573, 'binary_specificity': 0.9866667, 'binary_f1_score': 0.8202765}
confusion matrix:
     0    1
0  222    3
1   75  178
early stop counter: 2
val acc:0.8797814249992371, best validation acc: 0.9227166175842285, corresponding to test acc:                         0.9205020666122437 / 0.9225941300392151
after epoch: 22,now: 2024-07-13 17:56:51.946952,epoch time: 0:28:36.636388,used: 10:31:19.616367,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_07_25_32_seed_1_21955592
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.9986225, 'precision': 0.99062085, 'recall': 0.99459755, 'specificity': 0.99459755, 'f1': 0.9926002, 'auroc': 0.9999535, 'binary_precision': 0.9994947, 'binary_recall': 0.99905705, 'binary_specificity': 0.99013805, 'binary_f1_score': 0.9992758}
confusion matrix:
      0      1
0  1506     15
1    28  29667
---- Validation: 
scalar performance:
{'acc': 0.92740047, 'precision': 0.92741764, 'recall': 0.92734253, 'specificity': 0.92734253, 'f1': 0.92737496, 'auroc': 0.9693731, 'binary_precision': 0.9282297, 'binary_recall': 0.9238095, 'binary_specificity': 0.9308756, 'binary_f1_score': 0.9260143}
confusion matrix:
     0    1
0  606   45
1   48  582
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.89748955, 'precision': 0.89827657, 'recall': 0.89947295, 'specificity': 0.89947295, 'f1': 0.8974532, 'auroc': 0.95430833, 'binary_precision': 0.9358974, 'binary_recall': 0.8656126, 'binary_specificity': 0.93333334, 'binary_f1_score': 0.89938396}
confusion matrix:
     0    1
0  210   15
1   34  219
better model found
persisted
after epoch: 23,now: 2024-07-13 18:25:28.187234,epoch time: 0:28:36.240282,used: 10:59:55.856649,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_07_25_32_seed_1_21955592
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.99833417, 'precision': 0.9880497, 'recall': 0.9941342, 'specificity': 0.9941342, 'f1': 0.99107087, 'auroc': 0.99994385, 'binary_precision': 0.9994608, 'binary_recall': 0.9987877, 'binary_specificity': 0.9894806, 'binary_f1_score': 0.9991241}
confusion matrix:
      0      1
0  1505     16
1    36  29659
---- Validation: 
scalar performance:
{'acc': 0.913349, 'precision': 0.91338724, 'recall': 0.9134921, 'specificity': 0.9134921, 'f1': 0.9133456, 'auroc': 0.9635627, 'binary_precision': 0.90357697, 'binary_recall': 0.9222222, 'binary_specificity': 0.9047619, 'binary_f1_score': 0.91280437}
confusion matrix:
     0    1
0  589   62
1   49  581
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.90585774, 'precision': 0.9059874, 'recall': 0.90737814, 'specificity': 0.90737814, 'f1': 0.90578806, 'auroc': 0.9535705, 'binary_precision': 0.93697476, 'binary_recall': 0.88142294, 'binary_specificity': 0.93333334, 'binary_f1_score': 0.9083503}
confusion matrix:
     0    1
0  210   15
1   30  223
early stop counter: 1
val acc:0.9133489727973938, best validation acc: 0.9274004697799683, corresponding to test acc:                         0.8974895477294922 / 0.9225941300392151
after epoch: 24,now: 2024-07-13 18:54:02.105710,epoch time: 0:28:33.918476,used: 11:28:29.775125,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_07_25_32_seed_1_21955592
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.9984303, 'precision': 0.98667336, 'recall': 0.9966798, 'specificity': 0.9966798, 'f1': 0.9916197, 'auroc': 0.99994576, 'binary_precision': 0.9997303, 'binary_recall': 0.9986193, 'binary_specificity': 0.9947403, 'binary_f1_score': 0.9991745}
confusion matrix:
      0      1
0  1513      8
1    41  29654
---- Validation: 
scalar performance:
{'acc': 0.92349726, 'precision': 0.92467695, 'recall': 0.9230927, 'specificity': 0.9230927, 'f1': 0.9233758, 'auroc': 0.96609855, 'binary_precision': 0.9433333, 'binary_recall': 0.8984127, 'binary_specificity': 0.9477727, 'binary_f1_score': 0.92032516}
confusion matrix:
     0    1
0  617   34
1   64  566
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8535565, 'precision': 0.8701339, 'recall': 0.8599385, 'specificity': 0.8599385, 'f1': 0.85305226, 'auroc': 0.94886255, 'binary_precision': 0.964467, 'binary_recall': 0.7509881, 'binary_specificity': 0.9688889, 'binary_f1_score': 0.84444445}
confusion matrix:
     0    1
0  218    7
1   63  190
early stop counter: 2
val acc:0.9234972596168518, best validation acc: 0.9274004697799683, corresponding to test acc:                         0.8974895477294922 / 0.9225941300392151
after epoch: 25,now: 2024-07-13 19:22:37.051412,epoch time: 0:28:34.945702,used: 11:57:04.720827,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_07_25_32_seed_1_21955592
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.99932724, 'precision': 0.99560297, 'recall': 0.9971495, 'specificity': 0.9971495, 'f1': 0.9963749, 'auroc': 0.9999904, 'binary_precision': 0.9997306, 'binary_recall': 0.9995622, 'binary_specificity': 0.99473685, 'binary_f1_score': 0.99964637}
confusion matrix:
      0      1
0  1512      8
1    13  29683
---- Validation: 
scalar performance:
{'acc': 0.91803277, 'precision': 0.9182152, 'recall': 0.91825396, 'specificity': 0.91825396, 'f1': 0.9180325, 'auroc': 0.96350425, 'binary_precision': 0.9044684, 'binary_recall': 0.931746, 'binary_specificity': 0.9047619, 'binary_f1_score': 0.91790456}
confusion matrix:
     0    1
0  589   62
1   43  587
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8786611, 'precision': 0.8846161, 'recall': 0.88267016, 'specificity': 0.88267016, 'f1': 0.87862706, 'auroc': 0.94482213, 'binary_precision': 0.94930875, 'binary_recall': 0.81422925, 'binary_specificity': 0.95111114, 'binary_f1_score': 0.87659574}
confusion matrix:
     0    1
0  214   11
1   47  206
early stop counter: 3
val acc:0.9180327653884888, best validation acc: 0.9274004697799683, corresponding to test acc:                         0.8974895477294922 / 0.9225941300392151
after epoch: 26,now: 2024-07-13 19:51:19.560008,epoch time: 0:28:42.508596,used: 12:25:47.229423,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_07_25_32_seed_1_21955592
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.99891084, 'precision': 0.99321544, 'recall': 0.99506104, 'specificity': 0.99506104, 'f1': 0.99413633, 'auroc': 0.99995005, 'binary_precision': 0.99952847, 'binary_recall': 0.99932647, 'binary_specificity': 0.99079555, 'binary_f1_score': 0.9994275}
confusion matrix:
      0      1
0  1507     14
1    20  29675
---- Validation: 
scalar performance:
{'acc': 0.91569084, 'precision': 0.9159721, 'recall': 0.9159498, 'specificity': 0.9159498, 'f1': 0.91569084, 'auroc': 0.9577207, 'binary_precision': 0.90030676, 'binary_recall': 0.931746, 'binary_specificity': 0.90015364, 'binary_f1_score': 0.91575664}
confusion matrix:
     0    1
0  586   65
1   43  587
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.91841006, 'precision': 0.91962785, 'recall': 0.92071146, 'specificity': 0.92071146, 'f1': 0.91839254, 'auroc': 0.96149313, 'binary_precision': 0.9612069, 'binary_recall': 0.88142294, 'binary_specificity': 0.96, 'binary_f1_score': 0.9195876}
confusion matrix:
     0    1
0  216    9
1   30  223
early stop counter: 4
val acc:0.9156908392906189, best validation acc: 0.9274004697799683, corresponding to test acc:                         0.8974895477294922 / 0.9225941300392151
after epoch: 27,now: 2024-07-13 20:20:02.298305,epoch time: 0:28:42.738297,used: 12:54:29.967720,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_07_25_32_seed_1_21955592
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.9987186, 'precision': 0.99068916, 'recall': 0.9955838, 'specificity': 0.9955838, 'f1': 0.9931229, 'auroc': 0.9999677, 'binary_precision': 0.9995957, 'binary_recall': 0.99905705, 'binary_specificity': 0.99211043, 'binary_f1_score': 0.9993263}
confusion matrix:
      0      1
0  1509     12
1    28  29667
---- Validation: 
scalar performance:
{'acc': 0.91569084, 'precision': 0.9157481, 'recall': 0.9158474, 'specificity': 0.9158474, 'f1': 0.91568834, 'auroc': 0.96341884, 'binary_precision': 0.9052795, 'binary_recall': 0.9253968, 'binary_specificity': 0.906298, 'binary_f1_score': 0.9152276}
confusion matrix:
     0    1
0  590   61
1   47  583
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8953975, 'precision': 0.8991471, 'recall': 0.8987264, 'specificity': 0.8987264, 'f1': 0.89539564, 'auroc': 0.9494071, 'binary_precision': 0.9551569, 'binary_recall': 0.84189725, 'binary_specificity': 0.95555556, 'binary_f1_score': 0.89495796}
confusion matrix:
     0    1
0  215   10
1   40  213
early stop counter: 5
val acc:0.9156908392906189, best validation acc: 0.9274004697799683, corresponding to test acc:                         0.8974895477294922 / 0.9225941300392151
after epoch: 28,now: 2024-07-13 20:48:43.793135,epoch time: 0:28:41.494830,used: 13:23:11.462550,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_07_25_32_seed_1_21955592
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 28 with time: 13:23:11.462550 at 2024-07-13 20:48:43.793135
persisted model performance metric: 

scalar performance:
{'acc': 0.89748955, 'precision': 0.89827657, 'recall': 0.89947295, 'specificity': 0.89947295, 'f1': 0.8974532, 'auroc': 0.95430833, 'binary_precision': 0.9358974, 'binary_recall': 0.8656126, 'binary_specificity': 0.93333334, 'binary_f1_score': 0.89938396}
confusion matrix:
     0    1
0  210   15
1   34  219
oracle model performance metric: 

scalar performance:
{'acc': 0.92259413, 'precision': 0.92302847, 'recall': 0.9244181, 'specificity': 0.9244181, 'f1': 0.9225531, 'auroc': 0.9598243, 'binary_precision': 0.9576271, 'binary_recall': 0.8932806, 'binary_specificity': 0.95555556, 'binary_f1_score': 0.92433536}
confusion matrix:
     0    1
0  215   10
1   27  226
results aggregation path: zoutput/benchmarks/CAMELYONWILD_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_halffreeze/rule_results/6.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONWILD_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_halffreeze/confusion_matrix/6.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 319892 KiB |   4486 MiB |   2094 TiB |   2094 TiB |
|       from large pool | 292709 KiB |   4460 MiB |   2069 TiB |   2069 TiB |
|       from small pool |  27182 KiB |     43 MiB |     25 TiB |     25 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 319892 KiB |   4486 MiB |   2094 TiB |   2094 TiB |
|       from large pool | 292709 KiB |   4460 MiB |   2069 TiB |   2069 TiB |
|       from small pool |  27182 KiB |     43 MiB |     25 TiB |     25 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 313851 KiB |   4482 MiB |   2094 TiB |   2094 TiB |
|       from large pool | 286862 KiB |   4457 MiB |   2068 TiB |   2068 TiB |
|       from small pool |  26989 KiB |     43 MiB |     25 TiB |     25 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   4934 MiB |   4940 MiB |   9384 MiB |   4450 MiB |
|       from large pool |   4884 MiB |   4890 MiB |   9316 MiB |   4432 MiB |
|       from small pool |     50 MiB |     50 MiB |     68 MiB |     18 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 169580 KiB | 460796 KiB |   1229 TiB |   1229 TiB |
|       from large pool | 161946 KiB | 458013 KiB |   1204 TiB |   1204 TiB |
|       from small pool |   7633 KiB |  22689 KiB |     25 TiB |     25 TiB |
|---------------------------------------------------------------------------|
| Allocations           |    1058    |    4629    |  306031 K  |  306030 K  |
|       from large pool |     130    |     521    |  195814 K  |  195814 K  |
|       from small pool |     928    |    4498    |  110217 K  |  110216 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    1058    |    4629    |  306031 K  |  306030 K  |
|       from large pool |     130    |     521    |  195814 K  |  195814 K  |
|       from small pool |     928    |    4498    |  110217 K  |  110216 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     230    |     230    |     422    |     192    |
|       from large pool |     205    |     205    |     388    |     183    |
|       from small pool |      25    |      25    |      34    |       9    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      54    |    1986    |  177519 K  |  177519 K  |
|       from large pool |      18    |     208    |  135029 K  |  135029 K  |
|       from small pool |      36    |    1965    |   42489 K  |   42489 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   4486 MiB |   2094 TiB |   2094 TiB |
|       from large pool |  16640 KiB |   4460 MiB |   2069 TiB |   2069 TiB |
|       from small pool |      0 KiB |     43 MiB |     25 TiB |     25 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   4486 MiB |   2094 TiB |   2094 TiB |
|       from large pool |  16640 KiB |   4460 MiB |   2069 TiB |   2069 TiB |
|       from small pool |      0 KiB |     43 MiB |     25 TiB |     25 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   4482 MiB |   2094 TiB |   2094 TiB |
|       from large pool |  16640 KiB |   4457 MiB |   2068 TiB |   2068 TiB |
|       from small pool |      0 KiB |     43 MiB |     25 TiB |     25 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 489472 KiB |   4940 MiB |   9384 MiB |   8906 MiB |
|       from large pool | 454656 KiB |   4890 MiB |   9316 MiB |   8872 MiB |
|       from small pool |  34816 KiB |     50 MiB |     68 MiB |     34 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 460796 KiB |   1229 TiB |   1229 TiB |
|       from large pool |  24320 KiB | 458013 KiB |   1204 TiB |   1204 TiB |
|       from small pool |      0 KiB |  22689 KiB |     25 TiB |     25 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    4629    |  306031 K  |  306031 K  |
|       from large pool |       2    |     521    |  195814 K  |  195814 K  |
|       from small pool |       0    |    4498    |  110217 K  |  110217 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    4629    |  306031 K  |  306031 K  |
|       from large pool |       2    |     521    |  195814 K  |  195814 K  |
|       from small pool |       0    |    4498    |  110217 K  |  110217 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      38    |     230    |     422    |     384    |
|       from large pool |      21    |     205    |     388    |     367    |
|       from small pool |      17    |      25    |      34    |      17    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    1986    |  177519 K  |  177519 K  |
|       from large pool |       3    |     208    |  135029 K  |  135029 K  |
|       from small pool |       0    |    1965    |   42490 K  |   42490 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   4486 MiB |   2094 TiB |   2094 TiB |
|       from large pool |  16640 KiB |   4460 MiB |   2069 TiB |   2069 TiB |
|       from small pool |      0 KiB |     43 MiB |     25 TiB |     25 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   4486 MiB |   2094 TiB |   2094 TiB |
|       from large pool |  16640 KiB |   4460 MiB |   2069 TiB |   2069 TiB |
|       from small pool |      0 KiB |     43 MiB |     25 TiB |     25 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   4482 MiB |   2094 TiB |   2094 TiB |
|       from large pool |  16640 KiB |   4457 MiB |   2068 TiB |   2068 TiB |
|       from small pool |      0 KiB |     43 MiB |     25 TiB |     25 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 489472 KiB |   4940 MiB |   9384 MiB |   8906 MiB |
|       from large pool | 454656 KiB |   4890 MiB |   9316 MiB |   8872 MiB |
|       from small pool |  34816 KiB |     50 MiB |     68 MiB |     34 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 460796 KiB |   1229 TiB |   1229 TiB |
|       from large pool |  24320 KiB | 458013 KiB |   1204 TiB |   1204 TiB |
|       from small pool |      0 KiB |  22689 KiB |     25 TiB |     25 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    4629    |  306031 K  |  306031 K  |
|       from large pool |       2    |     521    |  195814 K  |  195814 K  |
|       from small pool |       0    |    4498    |  110217 K  |  110217 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    4629    |  306031 K  |  306031 K  |
|       from large pool |       2    |     521    |  195814 K  |  195814 K  |
|       from small pool |       0    |    4498    |  110217 K  |  110217 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      38    |     230    |     422    |     384    |
|       from large pool |      21    |     205    |     388    |     367    |
|       from small pool |      17    |      25    |      34    |      17    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    1986    |  177519 K  |  177519 K  |
|       from large pool |       3    |     208    |  135029 K  |  135029 K  |
|       from small pool |       0    |    1965    |   42490 K  |   42490 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_21_00_23_seed_2_21955592

 Experiment start at: 2024-07-13 21:00:23.047203
before training, model accuracy: 0.3810526132583618
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9805903, 'precision': 0.8591163, 'recall': 0.9810364, 'specificity': 0.9810364, 'f1': 0.90991634, 'auroc': 0.9982302, 'binary_precision': 0.9990446, 'binary_recall': 0.98054254, 'binary_specificity': 0.98153037, 'binary_f1_score': 0.9897071}
confusion matrix:
      0      1
0  1488     28
1   581  29279
---- Validation: 
scalar performance:
{'acc': 0.84976524, 'precision': 0.8630303, 'recall': 0.8523253, 'specificity': 0.8523253, 'f1': 0.84894806, 'auroc': 0.9437348, 'binary_precision': 0.7866667, 'binary_recall': 0.948553, 'binary_specificity': 0.75609756, 'binary_f1_score': 0.8600583}
confusion matrix:
     0    1
0  496  160
1   32  590
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7957895, 'precision': 0.8137635, 'recall': 0.7835335, 'specificity': 0.7835335, 'f1': 0.7867105, 'auroc': 0.93087727, 'binary_precision': 0.7579618, 'binary_recall': 0.9189189, 'binary_specificity': 0.6481481, 'binary_f1_score': 0.83071554}
confusion matrix:
     0    1
0  140   76
1   21  238
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-13 21:29:14.458776,epoch time: 0:28:51.411573,used: 0:28:51.411573,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_21_00_23_seed_2_21955592
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9852435, 'precision': 0.986114, 'recall': 0.8516785, 'specificity': 0.8516785, 'f1': 0.9070103, 'auroc': 0.9988489, 'binary_precision': 0.98517907, 'binary_recall': 0.99953115, 'binary_specificity': 0.70382583, 'binary_f1_score': 0.99230325}
confusion matrix:
      0      1
0  1067    449
1    14  29846
---- Validation: 
scalar performance:
{'acc': 0.5571205, 'precision': 0.7563696, 'recall': 0.5685559, 'specificity': 0.5685559, 'f1': 0.46513122, 'auroc': 0.95116866, 'binary_precision': 0.52360874, 'binary_recall': 0.9983923, 'binary_specificity': 0.13871951, 'binary_f1_score': 0.6869469}
confusion matrix:
    0    1
0  91  565
1   1  621
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6, 'precision': 0.7554307, 'recall': 0.5609538, 'specificity': 0.5609538, 'f1': 0.47887796, 'auroc': 0.9499142, 'binary_precision': 0.5775281, 'binary_recall': 0.992278, 'binary_specificity': 0.12962963, 'binary_f1_score': 0.7301137}
confusion matrix:
    0    1
0  28  188
1   2  257
early stop counter: 1
val acc:0.5571205019950867, best validation acc: 0.8497652411460876, corresponding to test acc:                         0.7957894802093506 / 0.7957894802093506
after epoch: 2,now: 2024-07-13 21:58:05.919286,epoch time: 0:28:51.460510,used: 0:57:42.872083,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_21_00_23_seed_2_21955592
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9941994, 'precision': 0.9844415, 'recall': 0.9515572, 'specificity': 0.9515572, 'f1': 0.9673573, 'auroc': 0.99913186, 'binary_precision': 0.99516153, 'binary_recall': 0.9987609, 'binary_specificity': 0.90435356, 'binary_f1_score': 0.99695796}
confusion matrix:
      0      1
0  1371    145
1    37  29823
---- Validation: 
scalar performance:
{'acc': 0.8748044, 'precision': 0.8763354, 'recall': 0.8757156, 'specificity': 0.8757156, 'f1': 0.87478936, 'auroc': 0.94046056, 'binary_precision': 0.8447761, 'binary_recall': 0.90996784, 'binary_specificity': 0.8414634, 'binary_f1_score': 0.876161}
confusion matrix:
     0    1
0  552  104
1   56  566
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8589474, 'precision': 0.8599681, 'recall': 0.85528386, 'specificity': 0.85528386, 'f1': 0.8569592, 'auroc': 0.94061923, 'binary_precision': 0.85294116, 'binary_recall': 0.8957529, 'binary_specificity': 0.8148148, 'binary_f1_score': 0.8738229}
confusion matrix:
     0    1
0  176   40
1   27  232
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-07-13 22:26:55.851465,epoch time: 0:28:49.932179,used: 1:26:32.804262,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_21_00_23_seed_2_21955592
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9953786, 'precision': 0.97643524, 'recall': 0.9731525, 'specificity': 0.9731525, 'f1': 0.97478753, 'auroc': 0.9990969, 'binary_precision': 0.9973888, 'binary_recall': 0.9977562, 'binary_specificity': 0.9485488, 'binary_f1_score': 0.9975724}
confusion matrix:
      0      1
0  1438     78
1    67  29793
---- Validation: 
scalar performance:
{'acc': 0.8896714, 'precision': 0.89184815, 'recall': 0.89073896, 'specificity': 0.89073896, 'f1': 0.8896416, 'auroc': 0.94959164, 'binary_precision': 0.85524374, 'binary_recall': 0.93086815, 'binary_specificity': 0.8506098, 'binary_f1_score': 0.891455}
confusion matrix:
     0    1
0  558   98
1   43  579
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.88631576, 'precision': 0.8856125, 'recall': 0.8849921, 'specificity': 0.8849921, 'f1': 0.8852862, 'auroc': 0.9525955, 'binary_precision': 0.8927203, 'binary_recall': 0.8996139, 'binary_specificity': 0.8703704, 'binary_f1_score': 0.8961538}
confusion matrix:
     0    1
0  188   28
1   26  233
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-07-13 22:55:48.474797,epoch time: 0:28:52.623332,used: 1:55:25.427594,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_21_00_23_seed_2_21955592
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9962073, 'precision': 0.9739274, 'recall': 0.98548454, 'specificity': 0.98548454, 'f1': 0.9796282, 'auroc': 0.9996705, 'binary_precision': 0.99865866, 'binary_recall': 0.9973543, 'binary_specificity': 0.97361475, 'binary_f1_score': 0.9980061}
confusion matrix:
      0      1
0  1476     40
1    79  29781
---- Validation: 
scalar performance:
{'acc': 0.92253524, 'precision': 0.9224685, 'recall': 0.9227512, 'specificity': 0.9227512, 'f1': 0.9225143, 'auroc': 0.9617187, 'binary_precision': 0.911811, 'binary_recall': 0.93086815, 'binary_specificity': 0.91463417, 'binary_f1_score': 0.92124104}
confusion matrix:
     0    1
0  600   56
1   43  579
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8968421, 'precision': 0.89612675, 'recall': 0.89925635, 'specificity': 0.89925635, 'f1': 0.8965321, 'auroc': 0.9560989, 'binary_precision': 0.9338843, 'binary_recall': 0.87258685, 'binary_specificity': 0.9259259, 'binary_f1_score': 0.90219563}
confusion matrix:
     0    1
0  200   16
1   33  226
new oracle model saved
better model found
persisted
after epoch: 5,now: 2024-07-13 23:24:35.649818,epoch time: 0:28:47.175021,used: 2:24:12.602615,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_21_00_23_seed_2_21955592
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9957292, 'precision': 0.9709873, 'recall': 0.9833549, 'specificity': 0.9833549, 'f1': 0.97708154, 'auroc': 0.9995183, 'binary_precision': 0.9984573, 'binary_recall': 0.9970529, 'binary_specificity': 0.969657, 'binary_f1_score': 0.9977546}
confusion matrix:
      0      1
0  1470     46
1    88  29772
---- Validation: 
scalar performance:
{'acc': 0.91784036, 'precision': 0.91787773, 'recall': 0.917678, 'specificity': 0.917678, 'f1': 0.91776377, 'auroc': 0.9546555, 'binary_precision': 0.9189627, 'binary_recall': 0.91157556, 'binary_specificity': 0.9237805, 'binary_f1_score': 0.91525424}
confusion matrix:
     0    1
0  606   50
1   55  567
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.89894736, 'precision': 0.9024445, 'recall': 0.9046457, 'specificity': 0.9046457, 'f1': 0.8989111, 'auroc': 0.9563671, 'binary_precision': 0.9688889, 'binary_recall': 0.8416988, 'binary_specificity': 0.9675926, 'binary_f1_score': 0.9008265}
confusion matrix:
     0    1
0  209    7
1   41  218
new oracle model saved
early stop counter: 1
val acc:0.9178403615951538, best validation acc: 0.922535240650177, corresponding to test acc:                         0.8968421220779419 / 0.8989473581314087
after epoch: 6,now: 2024-07-13 23:53:58.065869,epoch time: 0:29:22.416051,used: 2:53:35.018666,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_21_00_23_seed_2_21955592
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.996781, 'precision': 0.98148465, 'recall': 0.9835944, 'specificity': 0.9835944, 'f1': 0.982537, 'auroc': 0.9997523, 'binary_precision': 0.9984256, 'binary_recall': 0.99819154, 'binary_specificity': 0.96899736, 'binary_f1_score': 0.9983086}
confusion matrix:
      0      1
0  1469     47
1    54  29806
---- Validation: 
scalar performance:
{'acc': 0.91784036, 'precision': 0.9181375, 'recall': 0.91751134, 'specificity': 0.91751134, 'f1': 0.9177291, 'auroc': 0.96241224, 'binary_precision': 0.9244663, 'binary_recall': 0.9051447, 'binary_specificity': 0.92987806, 'binary_f1_score': 0.9147034}
confusion matrix:
     0    1
0  610   46
1   59  563
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.88631576, 'precision': 0.88907737, 'recall': 0.89152545, 'specificity': 0.89152545, 'f1': 0.8862548, 'auroc': 0.96189046, 'binary_precision': 0.95154184, 'binary_recall': 0.8339768, 'binary_specificity': 0.9490741, 'binary_f1_score': 0.8888889}
confusion matrix:
     0    1
0  205   11
1   43  216
early stop counter: 2
val acc:0.9178403615951538, best validation acc: 0.922535240650177, corresponding to test acc:                         0.8968421220779419 / 0.8989473581314087
after epoch: 7,now: 2024-07-14 00:22:16.865054,epoch time: 0:28:18.799185,used: 3:21:53.817851,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_21_00_23_seed_2_21955592
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9961117, 'precision': 0.9884598, 'recall': 0.96884155, 'specificity': 0.96884155, 'f1': 0.9784272, 'auroc': 0.9996817, 'binary_precision': 0.99689215, 'binary_recall': 0.9990288, 'binary_specificity': 0.93865436, 'binary_f1_score': 0.9979594}
confusion matrix:
      0      1
0  1423     93
1    29  29831
---- Validation: 
scalar performance:
{'acc': 0.9201878, 'precision': 0.92009103, 'recall': 0.9202146, 'specificity': 0.9202146, 'f1': 0.9201438, 'auroc': 0.96028495, 'binary_precision': 0.9153355, 'binary_recall': 0.92122185, 'binary_specificity': 0.91920733, 'binary_f1_score': 0.91826916}
confusion matrix:
     0    1
0  603   53
1   49  573
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9073684, 'precision': 0.90709877, 'recall': 0.91044617, 'specificity': 0.91044617, 'f1': 0.90715075, 'auroc': 0.96471465, 'binary_precision': 0.9497908, 'binary_recall': 0.87644786, 'binary_specificity': 0.9444444, 'binary_f1_score': 0.9116466}
confusion matrix:
     0    1
0  204   12
1   32  227
new oracle model saved
early stop counter: 3
val acc:0.920187771320343, best validation acc: 0.922535240650177, corresponding to test acc:                         0.8968421220779419 / 0.9073684215545654
after epoch: 8,now: 2024-07-14 00:50:38.588361,epoch time: 0:28:21.723307,used: 3:50:15.541158,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_21_00_23_seed_2_21955592
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.995793, 'precision': 0.9648382, 'recall': 0.9915283, 'specificity': 0.9915283, 'f1': 0.97776634, 'auroc': 0.99974966, 'binary_precision': 0.99932814, 'binary_recall': 0.99624914, 'binary_specificity': 0.9868074, 'binary_f1_score': 0.9977862}
confusion matrix:
      0      1
0  1496     20
1   112  29748
---- Validation: 
scalar performance:
{'acc': 0.8974961, 'precision': 0.8978862, 'recall': 0.8980276, 'specificity': 0.8980276, 'f1': 0.8974945, 'auroc': 0.9535012, 'binary_precision': 0.87711215, 'binary_recall': 0.9180064, 'binary_specificity': 0.8780488, 'binary_f1_score': 0.8970935}
confusion matrix:
     0    1
0  576   80
1   51  571
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8694737, 'precision': 0.86888677, 'recall': 0.87185395, 'specificity': 0.87185395, 'f1': 0.8691111, 'auroc': 0.9326112, 'binary_precision': 0.9087137, 'binary_recall': 0.84555984, 'binary_specificity': 0.8981481, 'binary_f1_score': 0.876}
confusion matrix:
     0    1
0  194   22
1   40  219
early stop counter: 4
val acc:0.8974961042404175, best validation acc: 0.922535240650177, corresponding to test acc:                         0.8968421220779419 / 0.9073684215545654
after epoch: 9,now: 2024-07-14 01:18:57.092449,epoch time: 0:28:18.504088,used: 4:18:34.045246,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_21_00_23_seed_2_21955592
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9947412, 'precision': 0.97493637, 'recall': 0.96749544, 'specificity': 0.96749544, 'f1': 0.9711832, 'auroc': 0.9993527, 'binary_precision': 0.99682117, 'binary_recall': 0.99765575, 'binary_specificity': 0.9373351, 'binary_f1_score': 0.9972383}
confusion matrix:
      0      1
0  1421     95
1    70  29790
---- Validation: 
scalar performance:
{'acc': 0.8888889, 'precision': 0.8952465, 'recall': 0.89064336, 'specificity': 0.89064336, 'f1': 0.8886901, 'auroc': 0.9556235, 'binary_precision': 0.8380282, 'binary_recall': 0.95659167, 'binary_specificity': 0.8246951, 'binary_f1_score': 0.8933934}
confusion matrix:
     0    1
0  541  115
1   27  595
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.93263155, 'precision': 0.9315155, 'recall': 0.9332279, 'specificity': 0.9332279, 'f1': 0.93222034, 'auroc': 0.95463324, 'binary_precision': 0.9486166, 'binary_recall': 0.9266409, 'binary_specificity': 0.9398148, 'binary_f1_score': 0.93750006}
confusion matrix:
     0    1
0  203   13
1   19  240
new oracle model saved
early stop counter: 5
val acc:0.8888888955116272, best validation acc: 0.922535240650177, corresponding to test acc:                         0.8968421220779419 / 0.9326315522193909
after epoch: 10,now: 2024-07-14 01:47:11.401648,epoch time: 0:28:14.309199,used: 4:46:48.354445,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_21_00_23_seed_2_21955592
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 10 with time: 4:46:48.354445 at 2024-07-14 01:47:11.401648
persisted model performance metric: 

scalar performance:
{'acc': 0.8968421, 'precision': 0.89612675, 'recall': 0.89925635, 'specificity': 0.89925635, 'f1': 0.8965321, 'auroc': 0.9560989, 'binary_precision': 0.9338843, 'binary_recall': 0.87258685, 'binary_specificity': 0.9259259, 'binary_f1_score': 0.90219563}
confusion matrix:
     0    1
0  200   16
1   33  226
oracle model performance metric: 

scalar performance:
{'acc': 0.93263155, 'precision': 0.9315155, 'recall': 0.9332279, 'specificity': 0.9332279, 'f1': 0.93222034, 'auroc': 0.95463324, 'binary_precision': 0.9486166, 'binary_recall': 0.9266409, 'binary_specificity': 0.9398148, 'binary_f1_score': 0.93750006}
confusion matrix:
     0    1
0  203   13
1   19  240
results aggregation path: zoutput/benchmarks/CAMELYONWILD_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_halffreeze/rule_results/6.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONWILD_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_halffreeze/confusion_matrix/6.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 321228 KiB |   4486 MiB |   2600 TiB |   2600 TiB |
|       from large pool | 294045 KiB |   4461 MiB |   2568 TiB |   2568 TiB |
|       from small pool |  27182 KiB |     43 MiB |     31 TiB |     31 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 321228 KiB |   4486 MiB |   2600 TiB |   2600 TiB |
|       from large pool | 294045 KiB |   4461 MiB |   2568 TiB |   2568 TiB |
|       from small pool |  27182 KiB |     43 MiB |     31 TiB |     31 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 313851 KiB |   4482 MiB |   2598 TiB |   2598 TiB |
|       from large pool | 286862 KiB |   4457 MiB |   2567 TiB |   2567 TiB |
|       from small pool |  26989 KiB |     43 MiB |     31 TiB |     31 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   4928 MiB |   4940 MiB |  13834 MiB |   8906 MiB |
|       from large pool |   4878 MiB |   4890 MiB |  13750 MiB |   8872 MiB |
|       from small pool |     50 MiB |     50 MiB |     84 MiB |     34 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 188724 KiB | 460796 KiB |   1526 TiB |   1526 TiB |
|       from large pool | 181090 KiB | 458013 KiB |   1494 TiB |   1494 TiB |
|       from small pool |   7633 KiB |  22689 KiB |     31 TiB |     31 TiB |
|---------------------------------------------------------------------------|
| Allocations           |    1058    |    4649    |  379738 K  |  379737 K  |
|       from large pool |     130    |     521    |  242991 K  |  242991 K  |
|       from small pool |     928    |    4518    |  136746 K  |  136745 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    1058    |    4649    |  379738 K  |  379737 K  |
|       from large pool |     130    |     521    |  242991 K  |  242991 K  |
|       from small pool |     928    |    4518    |  136746 K  |  136745 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     230    |     230    |     614    |     384    |
|       from large pool |     205    |     205    |     572    |     367    |
|       from small pool |      25    |      25    |      42    |      17    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      57    |    1995    |  219876 K  |  219876 K  |
|       from large pool |      20    |     208    |  167338 K  |  167338 K  |
|       from small pool |      37    |    1975    |   52537 K  |   52537 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   4486 MiB |   2600 TiB |   2600 TiB |
|       from large pool |  16640 KiB |   4461 MiB |   2568 TiB |   2568 TiB |
|       from small pool |      0 KiB |     43 MiB |     31 TiB |     31 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   4486 MiB |   2600 TiB |   2600 TiB |
|       from large pool |  16640 KiB |   4461 MiB |   2568 TiB |   2568 TiB |
|       from small pool |      0 KiB |     43 MiB |     31 TiB |     31 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   4482 MiB |   2598 TiB |   2598 TiB |
|       from large pool |  16640 KiB |   4457 MiB |   2567 TiB |   2567 TiB |
|       from small pool |      0 KiB |     43 MiB |     31 TiB |     31 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 509952 KiB |   4940 MiB |  13834 MiB |  13336 MiB |
|       from large pool | 475136 KiB |   4890 MiB |  13750 MiB |  13286 MiB |
|       from small pool |  34816 KiB |     50 MiB |     84 MiB |     50 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 460796 KiB |   1526 TiB |   1526 TiB |
|       from large pool |  24320 KiB | 458013 KiB |   1494 TiB |   1494 TiB |
|       from small pool |      0 KiB |  22689 KiB |     31 TiB |     31 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    4649    |  379738 K  |  379738 K  |
|       from large pool |       2    |     521    |  242991 K  |  242991 K  |
|       from small pool |       0    |    4518    |  136746 K  |  136746 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    4649    |  379738 K  |  379738 K  |
|       from large pool |       2    |     521    |  242991 K  |  242991 K  |
|       from small pool |       0    |    4518    |  136746 K  |  136746 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      39    |     230    |     614    |     575    |
|       from large pool |      22    |     205    |     572    |     550    |
|       from small pool |      17    |      25    |      42    |      25    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    1995    |  219877 K  |  219877 K  |
|       from large pool |       3    |     208    |  167338 K  |  167338 K  |
|       from small pool |       0    |    1975    |   52538 K  |   52538 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Sun Jul 14 01:54:39 2024]
Finished job 0.
1 of 1 steps (100%) done
