Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Sat Jul 13 11:00:37 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYONWILD_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_halffreeze/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYONWILD_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_halffreeze/rule_results/3.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=3
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/swiglu_ffn.py:51: UserWarning: xFormers is not available (SwiGLU)
  warnings.warn("xFormers is not available (SwiGLU)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/attention.py:33: UserWarning: xFormers is not available (Attention)
  warnings.warn("xFormers is not available (Attention)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/block.py:40: UserWarning: xFormers is not available (Block)
  warnings.warn("xFormers is not available (Block)")
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_11_09_35_seed_0_21955596

 Experiment start at: 2024-07-13 11:09:35.437360
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
before training, model accuracy: 0.5360825061798096
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9818673, 'precision': 0.93407524, 'recall': 0.86007345, 'specificity': 0.86007345, 'f1': 0.89322996, 'auroc': 0.99118733, 'binary_precision': 0.98603344, 'binary_recall': 0.9950316, 'binary_specificity': 0.72511536, 'binary_f1_score': 0.9905121}
confusion matrix:
      0      1
0  1100    417
1   147  29440
---- Validation: 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
scalar performance:
{'acc': 0.67313665, 'precision': 0.78354144, 'recall': 0.6774463, 'specificity': 0.6774463, 'f1': 0.6410663, 'auroc': 0.92834044, 'binary_precision': 0.60308284, 'binary_recall': 0.9858268, 'binary_specificity': 0.36906585, 'binary_f1_score': 0.7483563}
confusion matrix:
     0    1
0  241  412
1    9  626
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.70515466, 'precision': 0.776441, 'recall': 0.67217916, 'specificity': 0.67217916, 'f1': 0.65925777, 'auroc': 0.9342809, 'binary_precision': 0.6615776, 'binary_recall': 0.962963, 'binary_specificity': 0.38139534, 'binary_f1_score': 0.7843137}
confusion matrix:
    0    1
0  82  133
1  10  260
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-13 11:20:02.504914,epoch time: 0:10:27.067554,used: 0:10:27.067554,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_11_09_35_seed_0_21955596
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.98829734, 'precision': 0.9398298, 'recall': 0.9332272, 'specificity': 0.9332272, 'f1': 0.93650055, 'auroc': 0.99561167, 'binary_precision': 0.99344814, 'binary_recall': 0.99425405, 'binary_specificity': 0.87220025, 'binary_f1_score': 0.993851}
confusion matrix:
      0      1
0  1324    194
1   170  29416
---- Validation: 
scalar performance:
{'acc': 0.7531056, 'precision': 0.81114286, 'recall': 0.756096, 'specificity': 0.756096, 'f1': 0.74244857, 'auroc': 0.9317523, 'binary_precision': 0.67322403, 'binary_recall': 0.97007877, 'binary_specificity': 0.5421133, 'binary_f1_score': 0.7948387}
confusion matrix:
     0    1
0  354  299
1   19  616
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7525773, 'precision': 0.7851055, 'recall': 0.7299311, 'specificity': 0.7299311, 'f1': 0.7311232, 'auroc': 0.9315934, 'binary_precision': 0.7130682, 'binary_recall': 0.9296296, 'binary_specificity': 0.53023255, 'binary_f1_score': 0.80707395}
confusion matrix:
     0    1
0  114  101
1   19  251
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-07-13 11:30:01.190445,epoch time: 0:09:58.685531,used: 0:20:25.753085,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_11_09_35_seed_0_21955596
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.98894036, 'precision': 0.95921236, 'recall': 0.91825354, 'specificity': 0.91825354, 'f1': 0.93766683, 'auroc': 0.9969423, 'binary_precision': 0.9918259, 'binary_recall': 0.9965862, 'binary_specificity': 0.83992094, 'binary_f1_score': 0.9942003}
confusion matrix:
      0      1
0  1275    243
1   101  29485
---- Validation: 
scalar performance:
{'acc': 0.6513975, 'precision': 0.78378165, 'recall': 0.65611535, 'specificity': 0.65611535, 'f1': 0.6092526, 'auroc': 0.9424817, 'binary_precision': 0.5864312, 'binary_recall': 0.9937008, 'binary_specificity': 0.31852987, 'binary_f1_score': 0.73758036}
confusion matrix:
     0    1
0  208  445
1    4  631
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.71340203, 'precision': 0.7940225, 'recall': 0.68006027, 'specificity': 0.68006027, 'f1': 0.6676198, 'auroc': 0.93217915, 'binary_precision': 0.6658228, 'binary_recall': 0.97407407, 'binary_specificity': 0.3860465, 'binary_f1_score': 0.7909774}
confusion matrix:
    0    1
0  83  132
1   7  263
early stop counter: 1
val acc:0.6513975262641907, best validation acc: 0.7531055808067322, corresponding to test acc:                         0.7525773048400879 / 0.7525773048400879
after epoch: 3,now: 2024-07-13 11:39:58.420171,epoch time: 0:09:57.229726,used: 0:30:22.982811,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_11_09_35_seed_0_21955596
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.98916537, 'precision': 0.96808195, 'recall': 0.911867, 'specificity': 0.911867, 'f1': 0.93797636, 'auroc': 0.9976385, 'binary_precision': 0.9911338, 'binary_recall': 0.99753255, 'binary_specificity': 0.82620144, 'binary_f1_score': 0.9943229}
confusion matrix:
      0      1
0  1255    264
1    73  29512
---- Validation: 
scalar performance:
{'acc': 0.7624224, 'precision': 0.82246447, 'recall': 0.7654146, 'specificity': 0.7654146, 'f1': 0.7521676, 'auroc': 0.9433764, 'binary_precision': 0.67978144, 'binary_recall': 0.97952753, 'binary_specificity': 0.55130166, 'binary_f1_score': 0.8025807}
confusion matrix:
     0    1
0  360  293
1   13  622
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7876289, 'precision': 0.81687844, 'recall': 0.7680448, 'specificity': 0.7680448, 'f1': 0.77225786, 'auroc': 0.93948317, 'binary_precision': 0.74486804, 'binary_recall': 0.94074076, 'binary_specificity': 0.59534883, 'binary_f1_score': 0.8314238}
confusion matrix:
     0    1
0  128   87
1   16  254
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-07-13 11:49:52.245260,epoch time: 0:09:53.825089,used: 0:40:16.807900,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_11_09_35_seed_0_21955596
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9902263, 'precision': 0.96503115, 'recall': 0.92710114, 'specificity': 0.92710114, 'f1': 0.9451672, 'auroc': 0.9974159, 'binary_precision': 0.9926973, 'binary_recall': 0.99705935, 'binary_specificity': 0.85714287, 'binary_f1_score': 0.9948735}
confusion matrix:
      0      1
0  1302    217
1    87  29498
---- Validation: 
scalar performance:
{'acc': 0.738354, 'precision': 0.81337535, 'recall': 0.74174315, 'specificity': 0.74174315, 'f1': 0.72345066, 'auroc': 0.9436399, 'binary_precision': 0.6565126, 'binary_recall': 0.984252, 'binary_specificity': 0.4992343, 'binary_f1_score': 0.78764963}
confusion matrix:
     0    1
0  326  327
1   10  625
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7752577, 'precision': 0.81478024, 'recall': 0.7526701, 'specificity': 0.7526701, 'f1': 0.75545955, 'auroc': 0.9406718, 'binary_precision': 0.72804534, 'binary_recall': 0.95185184, 'binary_specificity': 0.5534884, 'binary_f1_score': 0.82504016}
confusion matrix:
     0    1
0  119   96
1   13  257
early stop counter: 1
val acc:0.7383540272712708, best validation acc: 0.7624223828315735, corresponding to test acc:                         0.7876288890838623 / 0.7876288890838623
after epoch: 5,now: 2024-07-13 11:59:45.770622,epoch time: 0:09:53.525362,used: 0:50:10.333262,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_11_09_35_seed_0_21955596
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9907086, 'precision': 0.93994313, 'recall': 0.9632429, 'specificity': 0.9632429, 'f1': 0.9512552, 'auroc': 0.9976034, 'binary_precision': 0.9965425, 'binary_recall': 0.99367946, 'binary_specificity': 0.9328063, 'binary_f1_score': 0.99510896}
confusion matrix:
      0      1
0  1416    102
1   187  29399
---- Validation: 
scalar performance:
{'acc': 0.88897514, 'precision': 0.89074796, 'recall': 0.88946354, 'specificity': 0.88946354, 'f1': 0.8889188, 'auroc': 0.947976, 'binary_precision': 0.8607038, 'binary_recall': 0.92440945, 'binary_specificity': 0.85451764, 'binary_f1_score': 0.8914198}
confusion matrix:
     0    1
0  558   95
1   48  587
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.85979384, 'precision': 0.858197, 'recall': 0.8574935, 'specificity': 0.8574935, 'f1': 0.8578301, 'auroc': 0.93786395, 'binary_precision': 0.8713235, 'binary_recall': 0.87777776, 'binary_specificity': 0.8372093, 'binary_f1_score': 0.8745387}
confusion matrix:
     0    1
0  180   35
1   33  237
new oracle model saved
better model found
persisted
after epoch: 6,now: 2024-07-13 12:09:39.593561,epoch time: 0:09:53.822939,used: 1:00:04.156201,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_11_09_35_seed_0_21955596
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.99170524, 'precision': 0.9758772, 'recall': 0.93283117, 'specificity': 0.93283117, 'f1': 0.9532194, 'auroc': 0.99854445, 'binary_precision': 0.99323916, 'binary_recall': 0.9980734, 'binary_specificity': 0.86758894, 'binary_f1_score': 0.9956505}
confusion matrix:
      0      1
0  1317    201
1    57  29529
---- Validation: 
scalar performance:
{'acc': 0.81444097, 'precision': 0.8466786, 'recall': 0.8165644, 'specificity': 0.8165644, 'f1': 0.8107027, 'auroc': 0.9506252, 'binary_precision': 0.73741007, 'binary_recall': 0.96850395, 'binary_specificity': 0.6646248, 'binary_f1_score': 0.8373043}
confusion matrix:
     0    1
0  434  219
1   20  615
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.828866, 'precision': 0.8356091, 'recall': 0.81882, 'specificity': 0.81882, 'f1': 0.8230401, 'auroc': 0.93393624, 'binary_precision': 0.8085809, 'binary_recall': 0.9074074, 'binary_specificity': 0.73023254, 'binary_f1_score': 0.8551483}
confusion matrix:
     0    1
0  157   58
1   25  245
early stop counter: 1
val acc:0.8144409656524658, best validation acc: 0.8889751434326172, corresponding to test acc:                         0.8597938418388367 / 0.8597938418388367
after epoch: 7,now: 2024-07-13 12:19:35.361662,epoch time: 0:09:55.768101,used: 1:09:59.924302,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_11_09_35_seed_0_21955596
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.99202675, 'precision': 0.9740131, 'recall': 0.93831235, 'specificity': 0.93831235, 'f1': 0.9553847, 'auroc': 0.99858725, 'binary_precision': 0.99380594, 'binary_recall': 0.9978368, 'binary_specificity': 0.8787879, 'binary_f1_score': 0.99581736}
confusion matrix:
      0      1
0  1334    184
1    64  29522
---- Validation: 
scalar performance:
{'acc': 0.79891306, 'precision': 0.8378223, 'recall': 0.80127215, 'specificity': 0.80127215, 'f1': 0.7937907, 'auroc': 0.9457049, 'binary_precision': 0.7196262, 'binary_recall': 0.97007877, 'binary_specificity': 0.63246554, 'binary_f1_score': 0.8262911}
confusion matrix:
     0    1
0  413  240
1   19  616
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.82061857, 'precision': 0.83101416, 'recall': 0.8085702, 'specificity': 0.8085702, 'f1': 0.81330395, 'auroc': 0.9321964, 'binary_precision': 0.7942122, 'binary_recall': 0.91481483, 'binary_specificity': 0.7023256, 'binary_f1_score': 0.85025823}
confusion matrix:
     0    1
0  151   64
1   23  247
early stop counter: 2
val acc:0.7989130616188049, best validation acc: 0.8889751434326172, corresponding to test acc:                         0.8597938418388367 / 0.8597938418388367
after epoch: 8,now: 2024-07-13 12:29:29.260908,epoch time: 0:09:53.899246,used: 1:19:53.823548,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_11_09_35_seed_0_21955596
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9933128, 'precision': 0.95506537, 'recall': 0.9749236, 'specificity': 0.9749236, 'f1': 0.9647567, 'auroc': 0.99888444, 'binary_precision': 0.9976623, 'binary_recall': 0.99530184, 'binary_specificity': 0.95454544, 'binary_f1_score': 0.99648064}
confusion matrix:
      0      1
0  1449     69
1   139  29447
---- Validation: 
scalar performance:
{'acc': 0.9029503, 'precision': 0.9035996, 'recall': 0.9026817, 'specificity': 0.9026817, 'f1': 0.9028518, 'auroc': 0.9537158, 'binary_precision': 0.9166667, 'binary_recall': 0.8834646, 'binary_specificity': 0.9218989, 'binary_f1_score': 0.8997594}
confusion matrix:
     0    1
0  602   51
1   74  561
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8742268, 'precision': 0.8777653, 'recall': 0.88182604, 'specificity': 0.88182604, 'f1': 0.8740898, 'auroc': 0.9394487, 'binary_precision': 0.95238096, 'binary_recall': 0.8148148, 'binary_specificity': 0.9488372, 'binary_f1_score': 0.8782435}
confusion matrix:
     0    1
0  204   11
1   50  220
new oracle model saved
better model found
persisted
after epoch: 9,now: 2024-07-13 12:39:22.511608,epoch time: 0:09:53.250700,used: 1:29:47.074248,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_11_09_35_seed_0_21955596
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.99382716, 'precision': 0.97912645, 'recall': 0.95326006, 'specificity': 0.95326006, 'f1': 0.9657935, 'auroc': 0.99901843, 'binary_precision': 0.9953158, 'binary_recall': 0.99820876, 'binary_specificity': 0.90831137, 'binary_f1_score': 0.9967602}
confusion matrix:
      0      1
0  1377    139
1    53  29535
---- Validation: 
scalar performance:
{'acc': 0.8454969, 'precision': 0.86477244, 'recall': 0.8471054, 'specificity': 0.8471054, 'f1': 0.84383166, 'auroc': 0.9450242, 'binary_precision': 0.7773537, 'binary_recall': 0.9622047, 'binary_specificity': 0.73200613, 'binary_f1_score': 0.85995775}
confusion matrix:
     0    1
0  478  175
1   24  611
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8453608, 'precision': 0.8446341, 'recall': 0.8412144, 'specificity': 0.8412144, 'f1': 0.8426204, 'auroc': 0.935056, 'binary_precision': 0.8494624, 'binary_recall': 0.87777776, 'binary_specificity': 0.80465114, 'binary_f1_score': 0.863388}
confusion matrix:
     0    1
0  173   42
1   33  237
early stop counter: 1
val acc:0.8454968929290771, best validation acc: 0.9029502868652344, corresponding to test acc:                         0.8742268085479736 / 0.8742268085479736
after epoch: 10,now: 2024-07-13 12:49:16.159253,epoch time: 0:09:53.647645,used: 1:39:40.721893,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_11_09_35_seed_0_21955596
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.99318415, 'precision': 0.9646367, 'recall': 0.96173185, 'specificity': 0.96173185, 'f1': 0.9631792, 'auroc': 0.9986938, 'binary_precision': 0.9962495, 'binary_recall': 0.9965862, 'binary_specificity': 0.9268775, 'binary_f1_score': 0.9964178}
confusion matrix:
      0      1
0  1407    111
1   101  29485
---- Validation: 
scalar performance:
{'acc': 0.83928573, 'precision': 0.85566, 'recall': 0.8407845, 'specificity': 0.8407845, 'f1': 0.8378066, 'auroc': 0.93172157, 'binary_precision': 0.77577317, 'binary_recall': 0.9480315, 'binary_specificity': 0.7335375, 'binary_f1_score': 0.85329545}
confusion matrix:
     0    1
0  479  174
1   33  602
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8412371, 'precision': 0.8400531, 'recall': 0.83751076, 'specificity': 0.83751076, 'f1': 0.83859956, 'auroc': 0.925478, 'binary_precision': 0.84837544, 'binary_recall': 0.8703704, 'binary_specificity': 0.80465114, 'binary_f1_score': 0.8592322}
confusion matrix:
     0    1
0  173   42
1   35  235
early stop counter: 2
val acc:0.8392857313156128, best validation acc: 0.9029502868652344, corresponding to test acc:                         0.8742268085479736 / 0.8742268085479736
after epoch: 11,now: 2024-07-13 12:59:09.807660,epoch time: 0:09:53.648407,used: 1:49:34.370300,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_11_09_35_seed_0_21955596
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9936021, 'precision': 0.98082066, 'recall': 0.94917274, 'specificity': 0.94917274, 'f1': 0.9643971, 'auroc': 0.9990817, 'binary_precision': 0.99488044, 'binary_recall': 0.99841136, 'binary_specificity': 0.8999342, 'binary_f1_score': 0.9966427}
confusion matrix:
      0      1
0  1367    152
1    47  29538
---- Validation: 
scalar performance:
{'acc': 0.86024845, 'precision': 0.8747922, 'recall': 0.861632, 'specificity': 0.861632, 'f1': 0.85918367, 'auroc': 0.9523827, 'binary_precision': 0.79738563, 'binary_recall': 0.96062994, 'binary_specificity': 0.762634, 'binary_f1_score': 0.87142855}
confusion matrix:
     0    1
0  498  155
1   25  610
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8556701, 'precision': 0.85460436, 'recall': 0.85236865, 'specificity': 0.85236865, 'f1': 0.8533503, 'auroc': 0.938174, 'binary_precision': 0.8623188, 'binary_recall': 0.88148147, 'binary_specificity': 0.82325584, 'binary_f1_score': 0.8717949}
confusion matrix:
     0    1
0  177   38
1   32  238
early stop counter: 3
val acc:0.8602484464645386, best validation acc: 0.9029502868652344, corresponding to test acc:                         0.8742268085479736 / 0.8742268085479736
after epoch: 12,now: 2024-07-13 13:09:05.343342,epoch time: 0:09:55.535682,used: 1:59:29.905982,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_11_09_35_seed_0_21955596
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.98710775, 'precision': 0.8982741, 'recall': 0.9869735, 'specificity': 0.9869735, 'f1': 0.93756807, 'auroc': 0.9993433, 'binary_precision': 0.9993157, 'binary_recall': 0.9871223, 'binary_specificity': 0.98682475, 'binary_f1_score': 0.9931815}
confusion matrix:
      0      1
0  1498     20
1   381  29205
---- Validation: 
scalar performance:
{'acc': 0.8695652, 'precision': 0.88003993, 'recall': 0.86841106, 'specificity': 0.86841106, 'f1': 0.86838436, 'auroc': 0.9513571, 'binary_precision': 0.93973637, 'binary_recall': 0.78582674, 'binary_specificity': 0.9509954, 'binary_f1_score': 0.8559177}
confusion matrix:
     0    1
0  621   32
1  136  499
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.85979384, 'precision': 0.87686604, 'recall': 0.8731266, 'specificity': 0.8731266, 'f1': 0.85974556, 'auroc': 0.93293715, 'binary_precision': 0.99029124, 'binary_recall': 0.75555557, 'binary_specificity': 0.9906977, 'binary_f1_score': 0.8571429}
confusion matrix:
     0    1
0  213    2
1   66  204
early stop counter: 4
val acc:0.8695651888847351, best validation acc: 0.9029502868652344, corresponding to test acc:                         0.8742268085479736 / 0.8742268085479736
after epoch: 13,now: 2024-07-13 13:19:00.145622,epoch time: 0:09:54.802280,used: 2:09:24.708262,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_11_09_35_seed_0_21955596
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9774627, 'precision': 0.8427144, 'recall': 0.9853424, 'specificity': 0.9853424, 'f1': 0.8998121, 'auroc': 0.9989774, 'binary_precision': 0.9996886, 'binary_recall': 0.97660977, 'binary_specificity': 0.99407506, 'binary_f1_score': 0.98801446}
confusion matrix:
      0      1
0  1510      9
1   692  28893
---- Validation: 
scalar performance:
{'acc': 0.8470497, 'precision': 0.8598777, 'recall': 0.8457284, 'specificity': 0.8457284, 'f1': 0.8452995, 'auroc': 0.94152725, 'binary_precision': 0.9244186, 'binary_recall': 0.7511811, 'binary_specificity': 0.94027567, 'binary_f1_score': 0.8288445}
confusion matrix:
     0    1
0  614   39
1  158  477
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.84948456, 'precision': 0.86562055, 'recall': 0.8624462, 'specificity': 0.8624462, 'f1': 0.84944355, 'auroc': 0.93805337, 'binary_precision': 0.9758454, 'binary_recall': 0.74814814, 'binary_specificity': 0.9767442, 'binary_f1_score': 0.8469601}
confusion matrix:
     0    1
0  210    5
1   68  202
early stop counter: 5
val acc:0.8470497131347656, best validation acc: 0.9029502868652344, corresponding to test acc:                         0.8742268085479736 / 0.8742268085479736
after epoch: 14,now: 2024-07-13 13:28:55.171696,epoch time: 0:09:55.026074,used: 2:19:19.734336,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_11_09_35_seed_0_21955596
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9950489, 'precision': 0.9700607, 'recall': 0.9771002, 'specificity': 0.9771002, 'f1': 0.97355115, 'auroc': 0.9993485, 'binary_precision': 0.9978012, 'binary_recall': 0.9969917, 'binary_specificity': 0.9572087, 'binary_f1_score': 0.99739623}
confusion matrix:
      0      1
0  1454     65
1    89  29496
---- Validation: 
scalar performance:
{'acc': 0.89440995, 'precision': 0.894488, 'recall': 0.89454126, 'specificity': 0.89454126, 'f1': 0.8944089, 'auroc': 0.94175637, 'binary_precision': 0.8844376, 'binary_recall': 0.903937, 'binary_specificity': 0.8851455, 'binary_f1_score': 0.89408094}
confusion matrix:
     0    1
0  578   75
1   61  574
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8886598, 'precision': 0.89046013, 'recall': 0.8952627, 'specificity': 0.8952627, 'f1': 0.8884506, 'auroc': 0.9326271, 'binary_precision': 0.9576271, 'binary_recall': 0.837037, 'binary_specificity': 0.95348835, 'binary_f1_score': 0.8932806}
confusion matrix:
     0    1
0  205   10
1   44  226
new oracle model saved
early stop counter: 6
val acc:0.8944099545478821, best validation acc: 0.9029502868652344, corresponding to test acc:                         0.8742268085479736 / 0.8886597752571106
after epoch: 15,now: 2024-07-13 13:38:50.623311,epoch time: 0:09:55.451615,used: 2:29:15.185951,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_11_09_35_seed_0_21955596
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9942451, 'precision': 0.9819969, 'recall': 0.95510244, 'specificity': 0.95510244, 'f1': 0.9681198, 'auroc': 0.9992907, 'binary_precision': 0.9954844, 'binary_recall': 0.998479, 'binary_specificity': 0.91172594, 'binary_f1_score': 0.9969794}
confusion matrix:
      0      1
0  1384    134
1    45  29541
---- Validation: 
scalar performance:
{'acc': 0.7515528, 'precision': 0.8189122, 'recall': 0.7547383, 'specificity': 0.7547383, 'f1': 0.739229, 'auroc': 0.9516598, 'binary_precision': 0.6688103, 'binary_recall': 0.98267716, 'binary_specificity': 0.5267994, 'binary_f1_score': 0.79591835}
confusion matrix:
     0    1
0  344  309
1   11  624
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7649484, 'precision': 0.8249706, 'recall': 0.73819983, 'specificity': 0.73819983, 'f1': 0.7382102, 'auroc': 0.9451809, 'binary_precision': 0.71081084, 'binary_recall': 0.97407407, 'binary_specificity': 0.5023256, 'binary_f1_score': 0.821875}
confusion matrix:
     0    1
0  108  107
1    7  263
early stop counter: 7
val acc:0.7515528202056885, best validation acc: 0.9029502868652344, corresponding to test acc:                         0.8742268085479736 / 0.8886597752571106
after epoch: 16,now: 2024-07-13 13:48:44.627607,epoch time: 0:09:54.004296,used: 2:39:09.190247,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_11_09_35_seed_0_21955596
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.99402004, 'precision': 0.95299673, 'recall': 0.98623955, 'specificity': 0.98623955, 'f1': 0.9689574, 'auroc': 0.9994278, 'binary_precision': 0.9988462, 'binary_recall': 0.99486226, 'binary_specificity': 0.97761685, 'binary_f1_score': 0.99685025}
confusion matrix:
      0      1
0  1485     34
1   152  29433
---- Validation: 
scalar performance:
{'acc': 0.8959627, 'precision': 0.89604086, 'recall': 0.8960943, 'specificity': 0.8960943, 'f1': 0.89596176, 'auroc': 0.9509568, 'binary_precision': 0.8859784, 'binary_recall': 0.9055118, 'binary_specificity': 0.88667685, 'binary_f1_score': 0.89563864}
confusion matrix:
     0    1
0  579   74
1   60  575
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8680412, 'precision': 0.8698268, 'recall': 0.8743756, 'specificity': 0.8743756, 'f1': 0.8677934, 'auroc': 0.9319552, 'binary_precision': 0.9364407, 'binary_recall': 0.8185185, 'binary_specificity': 0.9302326, 'binary_f1_score': 0.87351775}
confusion matrix:
     0    1
0  200   15
1   49  221
early stop counter: 8
val acc:0.8959627151489258, best validation acc: 0.9029502868652344, corresponding to test acc:                         0.8742268085479736 / 0.8886597752571106
after epoch: 17,now: 2024-07-13 13:58:37.728505,epoch time: 0:09:53.100898,used: 2:49:02.291145,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_11_09_35_seed_0_21955596
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.99376285, 'precision': 0.96324146, 'recall': 0.97017896, 'specificity': 0.97017896, 'f1': 0.96668136, 'auroc': 0.9991256, 'binary_precision': 0.9971246, 'binary_recall': 0.9963157, 'binary_specificity': 0.94404215, 'binary_f1_score': 0.99672}
confusion matrix:
      0      1
0  1434     85
1   109  29476
---- Validation: 
scalar performance:
{'acc': 0.8998447, 'precision': 0.90303665, 'recall': 0.9004872, 'specificity': 0.9004872, 'f1': 0.89973295, 'auroc': 0.95519173, 'binary_precision': 0.8635057, 'binary_recall': 0.9464567, 'binary_specificity': 0.85451764, 'binary_f1_score': 0.90308034}
confusion matrix:
     0    1
0  558   95
1   34  601
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8845361, 'precision': 0.8824496, 'recall': 0.8849268, 'specificity': 0.8849268, 'f1': 0.88344145, 'auroc': 0.95119727, 'binary_precision': 0.90839696, 'binary_recall': 0.88148147, 'binary_specificity': 0.88837206, 'binary_f1_score': 0.8947368}
confusion matrix:
     0    1
0  191   24
1   32  238
early stop counter: 9
val acc:0.8998447060585022, best validation acc: 0.9029502868652344, corresponding to test acc:                         0.8742268085479736 / 0.8886597752571106
after epoch: 18,now: 2024-07-13 14:08:30.784543,epoch time: 0:09:53.056038,used: 2:58:55.347183,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_11_09_35_seed_0_21955596
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.99524176, 'precision': 0.9735374, 'recall': 0.9753127, 'specificity': 0.9753127, 'f1': 0.97442317, 'auroc': 0.99945474, 'binary_precision': 0.9975997, 'binary_recall': 0.9973974, 'binary_specificity': 0.95322794, 'binary_f1_score': 0.9974986}
confusion matrix:
      0      1
0  1447     71
1    77  29509
---- Validation: 
scalar performance:
{'acc': 0.86024845, 'precision': 0.8725196, 'recall': 0.86152345, 'specificity': 0.86152345, 'f1': 0.8593665, 'auroc': 0.94781625, 'binary_precision': 0.8013245, 'binary_recall': 0.9527559, 'binary_specificity': 0.770291, 'binary_f1_score': 0.8705036}
confusion matrix:
     0    1
0  503  150
1   30  605
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8515464, 'precision': 0.85040045, 'recall': 0.8481912, 'specificity': 0.8481912, 'f1': 0.8491603, 'auroc': 0.93529713, 'binary_precision': 0.8586956, 'binary_recall': 0.87777776, 'binary_specificity': 0.81860465, 'binary_f1_score': 0.8681319}
confusion matrix:
     0    1
0  176   39
1   33  237
early stop counter: 10
val acc:0.8602484464645386, best validation acc: 0.9029502868652344, corresponding to test acc:                         0.8742268085479736 / 0.8886597752571106
after epoch: 19,now: 2024-07-13 14:18:24.350287,epoch time: 0:09:53.565744,used: 3:08:48.912927,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_11_09_35_seed_0_21955596
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9955954, 'precision': 0.97092944, 'recall': 0.9823837, 'specificity': 0.9823837, 'f1': 0.97657967, 'auroc': 0.9995043, 'binary_precision': 0.99834156, 'binary_recall': 0.99702555, 'binary_specificity': 0.9677419, 'binary_f1_score': 0.99768317}
confusion matrix:
      0      1
0  1470     49
1    88  29497
---- Validation: 
scalar performance:
{'acc': 0.863354, 'precision': 0.87706923, 'recall': 0.8646947, 'specificity': 0.8646947, 'f1': 0.86238647, 'auroc': 0.95278484, 'binary_precision': 0.80157685, 'binary_recall': 0.96062994, 'binary_specificity': 0.76875955, 'binary_f1_score': 0.87392545}
confusion matrix:
     0    1
0  502  151
1   25  610
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.85773194, 'precision': 0.8616059, 'recall': 0.85043067, 'specificity': 0.85043067, 'f1': 0.85395455, 'auroc': 0.9465977, 'binary_precision': 0.8430034, 'binary_recall': 0.91481483, 'binary_specificity': 0.7860465, 'binary_f1_score': 0.8774423}
confusion matrix:
     0    1
0  169   46
1   23  247
early stop counter: 11
val acc:0.8633540272712708, best validation acc: 0.9029502868652344, corresponding to test acc:                         0.8742268085479736 / 0.8886597752571106
after epoch: 20,now: 2024-07-13 14:28:16.984362,epoch time: 0:09:52.634075,used: 3:18:41.547002,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_11_09_35_seed_0_21955596
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9951132, 'precision': 0.987107, 'recall': 0.9596211, 'specificity': 0.9596211, 'f1': 0.9729199, 'auroc': 0.99945414, 'binary_precision': 0.9959226, 'binary_recall': 0.9989522, 'binary_specificity': 0.9202899, 'binary_f1_score': 0.99743515}
confusion matrix:
      0      1
0  1397    121
1    31  29555
---- Validation: 
scalar performance:
{'acc': 0.89285713, 'precision': 0.897613, 'recall': 0.8936393, 'specificity': 0.8936393, 'f1': 0.8926542, 'auroc': 0.95667243, 'binary_precision': 0.85049367, 'binary_recall': 0.9496063, 'binary_specificity': 0.8376723, 'binary_f1_score': 0.89732146}
confusion matrix:
     0    1
0  547  106
1   32  603
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.88659793, 'precision': 0.88499933, 'recall': 0.8853575, 'specificity': 0.8853575, 'f1': 0.8851745, 'auroc': 0.9471835, 'binary_precision': 0.8996283, 'binary_recall': 0.8962963, 'binary_specificity': 0.8744186, 'binary_f1_score': 0.89795923}
confusion matrix:
     0    1
0  188   27
1   28  242
early stop counter: 12
val acc:0.8928571343421936, best validation acc: 0.9029502868652344, corresponding to test acc:                         0.8742268085479736 / 0.8886597752571106
after epoch: 21,now: 2024-07-13 14:38:05.135602,epoch time: 0:09:48.151240,used: 3:28:29.698242,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_11_09_35_seed_0_21955596
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9854681, 'precision': 0.8867999, 'recall': 0.98861384, 'specificity': 0.98861384, 'f1': 0.9309478, 'auroc': 0.9993583, 'binary_precision': 0.99958843, 'binary_recall': 0.9851276, 'binary_specificity': 0.99210006, 'binary_f1_score': 0.99230534}
confusion matrix:
      0      1
0  1507     12
1   440  29145
---- Validation: 
scalar performance:
{'acc': 0.8369565, 'precision': 0.85643715, 'recall': 0.83531857, 'specificity': 0.83531857, 'f1': 0.8342025, 'auroc': 0.9487237, 'binary_precision': 0.936345, 'binary_recall': 0.71811026, 'binary_specificity': 0.9525268, 'binary_f1_score': 0.81283426}
confusion matrix:
     0    1
0  622   31
1  179  456
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8268041, 'precision': 0.8557538, 'recall': 0.843497, 'specificity': 0.843497, 'f1': 0.8263427, 'auroc': 0.9505426, 'binary_precision': 0.9894737, 'binary_recall': 0.6962963, 'binary_specificity': 0.9906977, 'binary_f1_score': 0.8173913}
confusion matrix:
     0    1
0  213    2
1   82  188
early stop counter: 13
val acc:0.8369565010070801, best validation acc: 0.9029502868652344, corresponding to test acc:                         0.8742268085479736 / 0.8886597752571106
after epoch: 22,now: 2024-07-13 14:47:53.436160,epoch time: 0:09:48.300558,used: 3:38:17.998800,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_11_09_35_seed_0_21955596
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.9956276, 'precision': 0.97150123, 'recall': 0.9820884, 'specificity': 0.9820884, 'f1': 0.97672904, 'auroc': 0.9994123, 'binary_precision': 0.9983079, 'binary_recall': 0.99709314, 'binary_specificity': 0.96708363, 'binary_f1_score': 0.99770015}
confusion matrix:
      0      1
0  1469     50
1    86  29499
---- Validation: 
scalar performance:
{'acc': 0.8920807, 'precision': 0.8961706, 'recall': 0.8928085, 'specificity': 0.8928085, 'f1': 0.89191127, 'auroc': 0.94733936, 'binary_precision': 0.85227275, 'binary_recall': 0.9448819, 'binary_specificity': 0.8407351, 'binary_f1_score': 0.89619124}
confusion matrix:
     0    1
0  549  104
1   35  600
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.87628865, 'precision': 0.8741932, 'recall': 0.87751937, 'specificity': 0.87751937, 'f1': 0.8753085, 'auroc': 0.94392765, 'binary_precision': 0.90697676, 'binary_recall': 0.8666667, 'binary_specificity': 0.88837206, 'binary_f1_score': 0.88636357}
confusion matrix:
     0    1
0  191   24
1   36  234
early stop counter: 14
val acc:0.8920807242393494, best validation acc: 0.9029502868652344, corresponding to test acc:                         0.8742268085479736 / 0.8886597752571106
after epoch: 23,now: 2024-07-13 14:57:42.699089,epoch time: 0:09:49.262929,used: 3:48:07.261729,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_11_09_35_seed_0_21955596
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9956597, 'precision': 0.98596776, 'recall': 0.9668044, 'specificity': 0.9668044, 'f1': 0.9761714, 'auroc': 0.99957025, 'binary_precision': 0.9966608, 'binary_recall': 0.9987832, 'binary_specificity': 0.93482554, 'binary_f1_score': 0.99772084}
confusion matrix:
      0      1
0  1420     99
1    36  29549
---- Validation: 
scalar performance:
{'acc': 0.8447205, 'precision': 0.86535144, 'recall': 0.8463831, 'specificity': 0.8463831, 'f1': 0.8429172, 'auroc': 0.94536304, 'binary_precision': 0.7749684, 'binary_recall': 0.9653543, 'binary_specificity': 0.7274119, 'binary_f1_score': 0.8597475}
confusion matrix:
     0    1
0  475  178
1   22  613
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9010309, 'precision': 0.8994858, 'recall': 0.9002153, 'specificity': 0.9002153, 'f1': 0.89983475, 'auroc': 0.95014644, 'binary_precision': 0.9141791, 'binary_recall': 0.9074074, 'binary_specificity': 0.89302325, 'binary_f1_score': 0.91078067}
confusion matrix:
     0    1
0  192   23
1   25  245
new oracle model saved
early stop counter: 15
val acc:0.8447204828262329, best validation acc: 0.9029502868652344, corresponding to test acc:                         0.8742268085479736 / 0.9010308980941772
after epoch: 24,now: 2024-07-13 15:07:34.661285,epoch time: 0:09:51.962196,used: 3:57:59.223925,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_11_09_35_seed_0_21955596
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.99369854, 'precision': 0.98835486, 'recall': 0.9429782, 'specificity': 0.9429782, 'f1': 0.96443784, 'auroc': 0.99954987, 'binary_precision': 0.9942152, 'binary_recall': 0.9991888, 'binary_specificity': 0.8867676, 'binary_f1_score': 0.9966958}
confusion matrix:
      0      1
0  1347    172
1    24  29561
---- Validation: 
scalar performance:
{'acc': 0.8734472, 'precision': 0.88545966, 'recall': 0.8746922, 'specificity': 0.8746922, 'f1': 0.8726951, 'auroc': 0.9509375, 'binary_precision': 0.8138298, 'binary_recall': 0.9637795, 'binary_specificity': 0.7856049, 'binary_f1_score': 0.88248014}
confusion matrix:
     0    1
0  513  140
1   23  612
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8886598, 'precision': 0.8869764, 'recall': 0.88768303, 'specificity': 0.88768303, 'f1': 0.88731414, 'auroc': 0.95068043, 'binary_precision': 0.9029851, 'binary_recall': 0.8962963, 'binary_specificity': 0.87906975, 'binary_f1_score': 0.8996283}
confusion matrix:
     0    1
0  189   26
1   28  242
early stop counter: 16
val acc:0.8734471797943115, best validation acc: 0.9029502868652344, corresponding to test acc:                         0.8742268085479736 / 0.9010308980941772
after epoch: 25,now: 2024-07-13 15:17:25.239226,epoch time: 0:09:50.577941,used: 4:07:49.801866,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_11_09_35_seed_0_21955596
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.99582046, 'precision': 0.9763607, 'recall': 0.97874165, 'specificity': 0.97874165, 'f1': 0.9775479, 'auroc': 0.9995736, 'binary_precision': 0.9979377, 'binary_recall': 0.9976678, 'binary_specificity': 0.95981556, 'binary_f1_score': 0.99780273}
confusion matrix:
      0      1
0  1457     61
1    69  29517
---- Validation: 
scalar performance:
{'acc': 0.8913044, 'precision': 0.8912737, 'recall': 0.89132655, 'specificity': 0.89132655, 'f1': 0.8912915, 'auroc': 0.9472091, 'binary_precision': 0.8873239, 'binary_recall': 0.8929134, 'binary_specificity': 0.8897397, 'binary_f1_score': 0.8901099}
confusion matrix:
     0    1
0  581   72
1   68  567
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8927835, 'precision': 0.89676046, 'recall': 0.9008613, 'specificity': 0.9008613, 'f1': 0.8926809, 'auroc': 0.94835484, 'binary_precision': 0.973913, 'binary_recall': 0.8296296, 'binary_specificity': 0.97209305, 'binary_f1_score': 0.896}
confusion matrix:
     0    1
0  209    6
1   46  224
early stop counter: 17
val acc:0.8913043737411499, best validation acc: 0.9029502868652344, corresponding to test acc:                         0.8742268085479736 / 0.9010308980941772
after epoch: 26,now: 2024-07-13 15:27:15.712112,epoch time: 0:09:50.472886,used: 4:17:40.274752,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_11_09_35_seed_0_21955596
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.99003345, 'precision': 0.9271372, 'recall': 0.97382486, 'specificity': 0.97382486, 'f1': 0.9491162, 'auroc': 0.9987155, 'binary_precision': 0.99772185, 'binary_recall': 0.99178666, 'binary_specificity': 0.955863, 'binary_f1_score': 0.99474543}
confusion matrix:
      0      1
0  1451     67
1   243  29343
---- Validation: 
scalar performance:
{'acc': 0.8408385, 'precision': 0.8486238, 'recall': 0.8418818, 'specificity': 0.8418818, 'f1': 0.8402065, 'auroc': 0.902982, 'binary_precision': 0.7929155, 'binary_recall': 0.91653544, 'binary_specificity': 0.7672282, 'binary_f1_score': 0.85025567}
confusion matrix:
     0    1
0  501  152
1   53  582
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8391753, 'precision': 0.83692753, 'recall': 0.8399224, 'specificity': 0.8399224, 'f1': 0.8379011, 'auroc': 0.90490955, 'binary_precision': 0.872093, 'binary_recall': 0.8333333, 'binary_specificity': 0.8465116, 'binary_f1_score': 0.85227275}
confusion matrix:
     0    1
0  182   33
1   45  225
early stop counter: 18
val acc:0.8408384919166565, best validation acc: 0.9029502868652344, corresponding to test acc:                         0.8742268085479736 / 0.9010308980941772
after epoch: 27,now: 2024-07-13 15:37:04.394102,epoch time: 0:09:48.681990,used: 4:27:28.956742,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_11_09_35_seed_0_21955596
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.9954025, 'precision': 0.9854454, 'recall': 0.9644604, 'specificity': 0.9644604, 'f1': 0.9746946, 'auroc': 0.99948895, 'binary_precision': 0.99642557, 'binary_recall': 0.99874943, 'binary_specificity': 0.93017125, 'binary_f1_score': 0.99758613}
confusion matrix:
      0      1
0  1412    106
1    37  29549
---- Validation: 
scalar performance:
{'acc': 0.8920807, 'precision': 0.899794, 'recall': 0.8930689, 'specificity': 0.8930689, 'f1': 0.89171356, 'auroc': 0.95791686, 'binary_precision': 0.8406593, 'binary_recall': 0.9637795, 'binary_specificity': 0.82235837, 'binary_f1_score': 0.8980191}
confusion matrix:
     0    1
0  537  116
1   23  612
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8907217, 'precision': 0.8887211, 'recall': 0.89237726, 'specificity': 0.89237726, 'f1': 0.8898959, 'auroc': 0.9523686, 'binary_precision': 0.922179, 'binary_recall': 0.87777776, 'binary_specificity': 0.90697676, 'binary_f1_score': 0.8994307}
confusion matrix:
     0    1
0  195   20
1   33  237
early stop counter: 19
val acc:0.8920807242393494, best validation acc: 0.9029502868652344, corresponding to test acc:                         0.8742268085479736 / 0.9010308980941772
after epoch: 28,now: 2024-07-13 15:46:54.141940,epoch time: 0:09:49.747838,used: 4:37:18.704580,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_11_09_35_seed_0_21955596
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9956919, 'precision': 0.98352563, 'recall': 0.96959263, 'specificity': 0.96959263, 'f1': 0.9764456, 'auroc': 0.9995203, 'binary_precision': 0.99696285, 'binary_recall': 0.99851286, 'binary_specificity': 0.9406724, 'binary_f1_score': 0.9977372}
confusion matrix:
      0      1
0  1427     90
1    44  29543
---- Validation: 
scalar performance:
{'acc': 0.8167702, 'precision': 0.85107416, 'recall': 0.81894827, 'specificity': 0.81894827, 'f1': 0.8128677, 'auroc': 0.94719887, 'binary_precision': 0.7377831, 'binary_recall': 0.97480315, 'binary_specificity': 0.6630934, 'binary_f1_score': 0.8398915}
confusion matrix:
     0    1
0  433  220
1   16  619
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8618557, 'precision': 0.87194896, 'recall': 0.85176575, 'specificity': 0.85176575, 'f1': 0.85692894, 'auroc': 0.95348835, 'binary_precision': 0.83278686, 'binary_recall': 0.94074076, 'binary_specificity': 0.7627907, 'binary_f1_score': 0.8834782}
confusion matrix:
     0    1
0  164   51
1   16  254
early stop counter: 20
val acc:0.8167701959609985, best validation acc: 0.9029502868652344, corresponding to test acc:                         0.8742268085479736 / 0.9010308980941772
after epoch: 29,now: 2024-07-13 15:56:41.822455,epoch time: 0:09:47.680515,used: 4:47:06.385095,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_11_09_35_seed_0_21955596
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.9959169, 'precision': 0.97179484, 'recall': 0.985042, 'specificity': 0.985042, 'f1': 0.97831583, 'auroc': 0.9996705, 'binary_precision': 0.9986121, 'binary_recall': 0.9970932, 'binary_specificity': 0.97299075, 'binary_f1_score': 0.9978521}
confusion matrix:
      0      1
0  1477     41
1    86  29500
---- Validation: 
scalar performance:
{'acc': 0.9114907, 'precision': 0.9120555, 'recall': 0.91177726, 'specificity': 0.91177726, 'f1': 0.9114853, 'auroc': 0.955047, 'binary_precision': 0.892911, 'binary_recall': 0.93228346, 'binary_specificity': 0.89127105, 'binary_f1_score': 0.91217256}
confusion matrix:
     0    1
0  582   71
1   43  592
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.90515465, 'precision': 0.90578234, 'recall': 0.9110249, 'specificity': 0.9110249, 'f1': 0.904902, 'auroc': 0.95305765, 'binary_precision': 0.96666664, 'binary_recall': 0.85925925, 'binary_specificity': 0.96279067, 'binary_f1_score': 0.9098039}
confusion matrix:
     0    1
0  207    8
1   38  232
new oracle model saved
better model found
persisted
after epoch: 30,now: 2024-07-13 16:06:37.779628,epoch time: 0:09:55.957173,used: 4:57:02.342268,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_11_09_35_seed_0_21955596
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 4:57:02.342268 at 2024-07-13 16:06:37.779628
persisted model performance metric: 

scalar performance:
{'acc': 0.90515465, 'precision': 0.90578234, 'recall': 0.9110249, 'specificity': 0.9110249, 'f1': 0.904902, 'auroc': 0.95305765, 'binary_precision': 0.96666664, 'binary_recall': 0.85925925, 'binary_specificity': 0.96279067, 'binary_f1_score': 0.9098039}
confusion matrix:
     0    1
0  207    8
1   38  232
oracle model performance metric: 

scalar performance:
{'acc': 0.90515465, 'precision': 0.90578234, 'recall': 0.9110249, 'specificity': 0.9110249, 'f1': 0.904902, 'auroc': 0.95305765, 'binary_precision': 0.96666664, 'binary_recall': 0.85925925, 'binary_specificity': 0.96279067, 'binary_f1_score': 0.9098039}
confusion matrix:
     0    1
0  207    8
1   38  232
results aggregation path: zoutput/benchmarks/CAMELYONWILD_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_halffreeze/rule_results/3.csv
results aggregation path: zoutput/benchmarks/CAMELYONWILD_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_halffreeze/rule_results/3.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONWILD_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_halffreeze/confusion_matrix/3.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 318782 KiB |   6782 MiB | 291711 GiB | 291711 GiB |
|       from large pool | 291597 KiB |   6756 MiB | 287048 GiB | 287047 GiB |
|       from small pool |  27185 KiB |     43 MiB |   4663 GiB |   4663 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 318782 KiB |   6782 MiB | 291711 GiB | 291711 GiB |
|       from large pool | 291597 KiB |   6756 MiB | 287048 GiB | 287047 GiB |
|       from small pool |  27185 KiB |     43 MiB |   4663 GiB |   4663 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 313851 KiB |   6778 MiB | 291498 GiB | 291497 GiB |
|       from large pool | 286862 KiB |   6752 MiB | 286845 GiB | 286844 GiB |
|       from small pool |  26989 KiB |     43 MiB |   4652 GiB |   4652 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   7454 MiB |   7454 MiB |   7454 MiB |      0 B   |
|       from large pool |   7404 MiB |   7404 MiB |   7404 MiB |      0 B   |
|       from small pool |     50 MiB |     50 MiB |     50 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory | 289473 KiB | 680184 KiB | 228749 GiB | 228749 GiB |
|       from large pool | 281843 KiB | 675647 KiB | 224080 GiB | 224079 GiB |
|       from small pool |   7630 KiB |  10779 KiB |   4669 GiB |   4669 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    1064    |    4635    |   59408 K  |   59407 K  |
|       from large pool |     130    |     756    |   27095 K  |   27095 K  |
|       from small pool |     934    |    4503    |   32312 K  |   32311 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    1064    |    4635    |   59408 K  |   59407 K  |
|       from large pool |     130    |     756    |   27095 K  |   27095 K  |
|       from small pool |     934    |    4503    |   32312 K  |   32311 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     334    |     334    |     334    |       0    |
|       from large pool |     309    |     309    |     309    |       0    |
|       from small pool |      25    |      25    |      25    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      73    |    1992    |   32484 K  |   32484 K  |
|       from large pool |      28    |     307    |   17750 K  |   17750 K  |
|       from small pool |      45    |    1965    |   14734 K  |   14734 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   6782 MiB | 291711 GiB | 291711 GiB |
|       from large pool |  16640 KiB |   6756 MiB | 287048 GiB | 287048 GiB |
|       from small pool |      0 KiB |     43 MiB |   4663 GiB |   4663 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   6782 MiB | 291711 GiB | 291711 GiB |
|       from large pool |  16640 KiB |   6756 MiB | 287048 GiB | 287048 GiB |
|       from small pool |      0 KiB |     43 MiB |   4663 GiB |   4663 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   6778 MiB | 291498 GiB | 291498 GiB |
|       from large pool |  16640 KiB |   6752 MiB | 286845 GiB | 286845 GiB |
|       from small pool |      0 KiB |     43 MiB |   4652 GiB |   4652 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 608256 KiB |   7454 MiB |   7454 MiB |   6860 MiB |
|       from large pool | 573440 KiB |   7404 MiB |   7404 MiB |   6844 MiB |
|       from small pool |  34816 KiB |     50 MiB |     50 MiB |     16 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 680184 KiB | 228749 GiB | 228749 GiB |
|       from large pool |  24320 KiB | 675647 KiB | 224080 GiB | 224080 GiB |
|       from small pool |      0 KiB |  28451 KiB |   4669 GiB |   4669 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    4635    |   59408 K  |   59408 K  |
|       from large pool |       2    |     756    |   27095 K  |   27095 K  |
|       from small pool |       0    |    4503    |   32312 K  |   32312 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    4635    |   59408 K  |   59408 K  |
|       from large pool |       2    |     756    |   27095 K  |   27095 K  |
|       from small pool |       0    |    4503    |   32312 K  |   32312 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      42    |     334    |     334    |     292    |
|       from large pool |      25    |     309    |     309    |     284    |
|       from small pool |      17    |      25    |      25    |       8    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    1992    |   32485 K  |   32485 K  |
|       from large pool |       3    |     307    |   17750 K  |   17750 K  |
|       from small pool |       0    |    1965    |   14734 K  |   14734 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   6782 MiB | 291711 GiB | 291711 GiB |
|       from large pool |  16640 KiB |   6756 MiB | 287048 GiB | 287048 GiB |
|       from small pool |      0 KiB |     43 MiB |   4663 GiB |   4663 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   6782 MiB | 291711 GiB | 291711 GiB |
|       from large pool |  16640 KiB |   6756 MiB | 287048 GiB | 287048 GiB |
|       from small pool |      0 KiB |     43 MiB |   4663 GiB |   4663 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   6778 MiB | 291498 GiB | 291498 GiB |
|       from large pool |  16640 KiB |   6752 MiB | 286845 GiB | 286845 GiB |
|       from small pool |      0 KiB |     43 MiB |   4652 GiB |   4652 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 608256 KiB |   7454 MiB |   7454 MiB |   6860 MiB |
|       from large pool | 573440 KiB |   7404 MiB |   7404 MiB |   6844 MiB |
|       from small pool |  34816 KiB |     50 MiB |     50 MiB |     16 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 680184 KiB | 228749 GiB | 228749 GiB |
|       from large pool |  24320 KiB | 675647 KiB | 224080 GiB | 224080 GiB |
|       from small pool |      0 KiB |  28451 KiB |   4669 GiB |   4669 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    4635    |   59408 K  |   59408 K  |
|       from large pool |       2    |     756    |   27095 K  |   27095 K  |
|       from small pool |       0    |    4503    |   32312 K  |   32312 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    4635    |   59408 K  |   59408 K  |
|       from large pool |       2    |     756    |   27095 K  |   27095 K  |
|       from small pool |       0    |    4503    |   32312 K  |   32312 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      42    |     334    |     334    |     292    |
|       from large pool |      25    |     309    |     309    |     284    |
|       from small pool |      17    |      25    |      25    |       8    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    1992    |   32485 K  |   32485 K  |
|       from large pool |       3    |     307    |   17750 K  |   17750 K  |
|       from small pool |       0    |    1965    |   14734 K  |   14734 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_16_19_43_seed_1_21955596

 Experiment start at: 2024-07-13 16:19:43.818574
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
before training, model accuracy: 0.6276150345802307
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9847835, 'precision': 0.93484926, 'recall': 0.8953152, 'specificity': 0.8953152, 'f1': 0.91402936, 'auroc': 0.9936938, 'binary_precision': 0.98961127, 'binary_recall': 0.99444354, 'binary_specificity': 0.79618675, 'binary_f1_score': 0.9920215}
confusion matrix:
      0      1
0  1211    310
1   165  29530
---- Validation: 
scalar performance:
{'acc': 0.7673693, 'precision': 0.80690825, 'recall': 0.7702765, 'specificity': 0.7702765, 'f1': 0.7608817, 'auroc': 0.914649, 'binary_precision': 0.6925754, 'binary_recall': 0.947619, 'binary_specificity': 0.59293395, 'binary_f1_score': 0.8002681}
confusion matrix:
     0    1
0  386  265
1   33  597
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.748954, 'precision': 0.7790246, 'recall': 0.73849803, 'specificity': 0.73849803, 'f1': 0.7359699, 'auroc': 0.91599476, 'binary_precision': 0.70090634, 'binary_recall': 0.91699606, 'binary_specificity': 0.56, 'binary_f1_score': 0.7945205}
confusion matrix:
     0    1
0  126   99
1   21  232
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-13 16:29:45.895216,epoch time: 0:10:02.076642,used: 0:10:02.076642,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_16_19_43_seed_1_21955596
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9910623, 'precision': 0.968132, 'recall': 0.93323547, 'specificity': 0.93323547, 'f1': 0.9499309, 'auroc': 0.99748075, 'binary_precision': 0.9933253, 'binary_recall': 0.9973059, 'binary_specificity': 0.869165, 'binary_f1_score': 0.9953117}
confusion matrix:
      0      1
0  1322    199
1    80  29615
---- Validation: 
scalar performance:
{'acc': 0.7408275, 'precision': 0.7968277, 'recall': 0.744342, 'specificity': 0.744342, 'f1': 0.7297812, 'auroc': 0.9224465, 'binary_precision': 0.6637363, 'binary_recall': 0.95873016, 'binary_specificity': 0.5299539, 'binary_f1_score': 0.7844156}
confusion matrix:
     0    1
0  345  306
1   26  604
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.71548116, 'precision': 0.7711959, 'recall': 0.7012209, 'specificity': 0.7012209, 'f1': 0.6904204, 'auroc': 0.91769874, 'binary_precision': 0.6620499, 'binary_recall': 0.94466406, 'binary_specificity': 0.45777777, 'binary_f1_score': 0.77850163}
confusion matrix:
     0    1
0  103  122
1   14  239
early stop counter: 1
val acc:0.7408275008201599, best validation acc: 0.767369270324707, corresponding to test acc:                         0.7489539980888367 / 0.7489539980888367
after epoch: 2,now: 2024-07-13 16:39:35.394398,epoch time: 0:09:49.499182,used: 0:19:51.575824,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_16_19_43_seed_1_21955596
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.99029344, 'precision': 0.95876384, 'recall': 0.93434894, 'specificity': 0.93434894, 'f1': 0.9461838, 'auroc': 0.9974872, 'binary_precision': 0.9934858, 'binary_recall': 0.9963295, 'binary_specificity': 0.8723684, 'binary_f1_score': 0.99490565}
confusion matrix:
      0      1
0  1326    194
1   109  29587
---- Validation: 
scalar performance:
{'acc': 0.80249804, 'precision': 0.8311034, 'recall': 0.8048899, 'specificity': 0.8048899, 'f1': 0.79895735, 'auroc': 0.9307653, 'binary_precision': 0.72959805, 'binary_recall': 0.9507936, 'binary_specificity': 0.65898615, 'binary_f1_score': 0.82563746}
confusion matrix:
     0    1
0  429  222
1   31  599
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7573222, 'precision': 0.7869893, 'recall': 0.747141, 'specificity': 0.747141, 'f1': 0.7452634, 'auroc': 0.9199648, 'binary_precision': 0.7082067, 'binary_recall': 0.9209486, 'binary_specificity': 0.5733333, 'binary_f1_score': 0.80068725}
confusion matrix:
     0    1
0  129   96
1   20  233
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-07-13 16:49:19.312810,epoch time: 0:09:43.918412,used: 0:29:35.494236,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_16_19_43_seed_1_21955596
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.99237573, 'precision': 0.9518573, 'recall': 0.9676103, 'specificity': 0.9676103, 'f1': 0.9595825, 'auroc': 0.9983038, 'binary_precision': 0.9969297, 'binary_recall': 0.99504966, 'binary_specificity': 0.94017094, 'binary_f1_score': 0.9959888}
confusion matrix:
      0      1
0  1430     91
1   147  29548
---- Validation: 
scalar performance:
{'acc': 0.8376269, 'precision': 0.84518886, 'recall': 0.8388377, 'specificity': 0.8388377, 'f1': 0.83703804, 'auroc': 0.9254968, 'binary_precision': 0.78983516, 'binary_recall': 0.9126984, 'binary_specificity': 0.764977, 'binary_f1_score': 0.8468336}
confusion matrix:
     0    1
0  498  153
1   55  575
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.82217574, 'precision': 0.8282997, 'recall': 0.8177514, 'specificity': 0.8177514, 'f1': 0.8194246, 'auroc': 0.9194027, 'binary_precision': 0.79577464, 'binary_recall': 0.8932806, 'binary_specificity': 0.74222225, 'binary_f1_score': 0.84171325}
confusion matrix:
     0    1
0  167   58
1   27  226
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-07-13 16:59:02.407408,epoch time: 0:09:43.094598,used: 0:39:18.588834,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_16_19_43_seed_1_21955596
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9930484, 'precision': 0.9700881, 'recall': 0.9539287, 'specificity': 0.9539287, 'f1': 0.96185064, 'auroc': 0.9986251, 'binary_precision': 0.99542856, 'binary_recall': 0.99727225, 'binary_specificity': 0.91058517, 'binary_f1_score': 0.9963495}
confusion matrix:
      0      1
0  1385    136
1    81  29614
---- Validation: 
scalar performance:
{'acc': 0.793911, 'precision': 0.8290571, 'recall': 0.79656935, 'specificity': 0.79656935, 'f1': 0.78922516, 'auroc': 0.93924856, 'binary_precision': 0.7173397, 'binary_recall': 0.95873016, 'binary_specificity': 0.6344086, 'binary_f1_score': 0.8206522}
confusion matrix:
     0    1
0  413  238
1   26  604
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.77615064, 'precision': 0.7991549, 'recall': 0.7673869, 'specificity': 0.7673869, 'f1': 0.76734364, 'auroc': 0.9229161, 'binary_precision': 0.7295597, 'binary_recall': 0.91699606, 'binary_specificity': 0.61777776, 'binary_f1_score': 0.81260943}
confusion matrix:
     0    1
0  139   86
1   21  232
early stop counter: 1
val acc:0.7939109802246094, best validation acc: 0.8376268744468689, corresponding to test acc:                         0.8221757411956787 / 0.8221757411956787
after epoch: 5,now: 2024-07-13 17:08:45.107213,epoch time: 0:09:42.699805,used: 0:49:01.288639,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_16_19_43_seed_1_21955596
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.99058175, 'precision': 0.9842891, 'recall': 0.912398, 'specificity': 0.912398, 'f1': 0.94514686, 'auroc': 0.9982132, 'binary_precision': 0.9911463, 'binary_recall': 0.9990234, 'binary_specificity': 0.8257725, 'binary_f1_score': 0.9950692}
confusion matrix:
      0      1
0  1256    265
1    29  29666
---- Validation: 
scalar performance:
{'acc': 0.7587822, 'precision': 0.8065871, 'recall': 0.76198155, 'specificity': 0.76198155, 'f1': 0.7504554, 'auroc': 0.92404664, 'binary_precision': 0.68135595, 'binary_recall': 0.95714283, 'binary_specificity': 0.56682026, 'binary_f1_score': 0.79603964}
confusion matrix:
     0    1
0  369  282
1   27  603
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7343096, 'precision': 0.7744056, 'recall': 0.7222047, 'specificity': 0.7222047, 'f1': 0.7167546, 'auroc': 0.89417654, 'binary_precision': 0.68313956, 'binary_recall': 0.92885375, 'binary_specificity': 0.51555556, 'binary_f1_score': 0.7872697}
confusion matrix:
     0    1
0  116  109
1   18  235
early stop counter: 2
val acc:0.7587822079658508, best validation acc: 0.8376268744468689, corresponding to test acc:                         0.8221757411956787 / 0.8221757411956787
after epoch: 6,now: 2024-07-13 17:18:36.743302,epoch time: 0:09:51.636089,used: 0:58:52.924728,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_16_19_43_seed_1_21955596
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9918311, 'precision': 0.9357351, 'recall': 0.9835425, 'specificity': 0.9835425, 'f1': 0.9582381, 'auroc': 0.9988954, 'binary_precision': 0.99867874, 'binary_recall': 0.992726, 'binary_specificity': 0.974359, 'binary_f1_score': 0.99569345}
confusion matrix:
      0      1
0  1482     39
1   216  29479
---- Validation: 
scalar performance:
{'acc': 0.863388, 'precision': 0.8661078, 'recall': 0.86410654, 'specificity': 0.86410654, 'f1': 0.86326766, 'auroc': 0.9397069, 'binary_precision': 0.8301887, 'binary_recall': 0.9079365, 'binary_specificity': 0.8202765, 'binary_f1_score': 0.8673237}
confusion matrix:
     0    1
0  534  117
1   58  572
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8242678, 'precision': 0.82572347, 'recall': 0.8216952, 'specificity': 0.8216952, 'f1': 0.822766, 'auroc': 0.91457176, 'binary_precision': 0.8141264, 'binary_recall': 0.8656126, 'binary_specificity': 0.7777778, 'binary_f1_score': 0.8390804}
confusion matrix:
     0    1
0  175   50
1   34  219
new oracle model saved
better model found
persisted
after epoch: 7,now: 2024-07-13 17:28:35.204775,epoch time: 0:09:58.461473,used: 1:08:51.386201,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_16_19_43_seed_1_21955596
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9932086, 'precision': 0.95140123, 'recall': 0.97834057, 'specificity': 0.97834057, 'f1': 0.96443284, 'auroc': 0.99895066, 'binary_precision': 0.9980405, 'binary_recall': 0.9948139, 'binary_specificity': 0.9618672, 'binary_f1_score': 0.9964246}
confusion matrix:
      0      1
0  1463     58
1   154  29541
---- Validation: 
scalar performance:
{'acc': 0.8852459, 'precision': 0.8867651, 'recall': 0.8847414, 'specificity': 0.8847414, 'f1': 0.8850102, 'auroc': 0.9412869, 'binary_precision': 0.90725124, 'binary_recall': 0.85396826, 'binary_specificity': 0.9155146, 'binary_f1_score': 0.8798038}
confusion matrix:
     0    1
0  596   55
1   92  538
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.86820084, 'precision': 0.8806534, 'recall': 0.8737725, 'specificity': 0.8737725, 'f1': 0.86794597, 'auroc': 0.9362143, 'binary_precision': 0.96568626, 'binary_recall': 0.7786561, 'binary_specificity': 0.9688889, 'binary_f1_score': 0.8621444}
confusion matrix:
     0    1
0  218    7
1   56  197
new oracle model saved
better model found
persisted
after epoch: 8,now: 2024-07-13 17:38:18.170635,epoch time: 0:09:42.965860,used: 1:18:34.352061,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_16_19_43_seed_1_21955596
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9939774, 'precision': 0.9781038, 'recall': 0.9559765, 'specificity': 0.9559765, 'f1': 0.966748, 'auroc': 0.99906474, 'binary_precision': 0.99559945, 'binary_recall': 0.9980805, 'binary_specificity': 0.9138725, 'binary_f1_score': 0.9968384}
confusion matrix:
      0      1
0  1390    131
1    57  29638
---- Validation: 
scalar performance:
{'acc': 0.84933645, 'precision': 0.8579866, 'recall': 0.8506144, 'specificity': 0.8506144, 'f1': 0.8487165, 'auroc': 0.941838, 'binary_precision': 0.79809004, 'binary_recall': 0.9285714, 'binary_specificity': 0.77265745, 'binary_f1_score': 0.8584005}
confusion matrix:
     0    1
0  503  148
1   45  585
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8263598, 'precision': 0.83107865, 'recall': 0.8224418, 'specificity': 0.8224418, 'f1': 0.82403004, 'auroc': 0.9092314, 'binary_precision': 0.8035714, 'binary_recall': 0.88932806, 'binary_specificity': 0.75555557, 'binary_f1_score': 0.8442776}
confusion matrix:
     0    1
0  170   55
1   28  225
early stop counter: 1
val acc:0.8493364453315735, best validation acc: 0.8852459192276001, corresponding to test acc:                         0.8682008385658264 / 0.8682008385658264
after epoch: 9,now: 2024-07-13 17:48:02.029186,epoch time: 0:09:43.858551,used: 1:28:18.210612,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_16_19_43_seed_1_21955596
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9941056, 'precision': 0.9608734, 'recall': 0.97694063, 'specificity': 0.97694063, 'f1': 0.96875286, 'auroc': 0.99921674, 'binary_precision': 0.9978407, 'binary_recall': 0.9959589, 'binary_specificity': 0.9579224, 'binary_f1_score': 0.9968989}
confusion matrix:
      0      1
0  1457     64
1   120  29575
---- Validation: 
scalar performance:
{'acc': 0.8594848, 'precision': 0.8606273, 'recall': 0.859959, 'specificity': 0.859959, 'f1': 0.8594539, 'auroc': 0.9273133, 'binary_precision': 0.8358209, 'binary_recall': 0.8888889, 'binary_specificity': 0.8310292, 'binary_f1_score': 0.8615385}
confusion matrix:
     0    1
0  541  110
1   70  560
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.85146445, 'precision': 0.8509076, 'recall': 0.8518138, 'specificity': 0.8518138, 'f1': 0.85117716, 'auroc': 0.9136232, 'binary_precision': 0.8699187, 'binary_recall': 0.8458498, 'binary_specificity': 0.8577778, 'binary_f1_score': 0.8577154}
confusion matrix:
     0    1
0  193   32
1   39  214
early stop counter: 2
val acc:0.8594847917556763, best validation acc: 0.8852459192276001, corresponding to test acc:                         0.8682008385658264 / 0.8682008385658264
after epoch: 10,now: 2024-07-13 17:57:47.289243,epoch time: 0:09:45.260057,used: 1:38:03.470669,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_16_19_43_seed_1_21955596
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.99362504, 'precision': 0.9824307, 'recall': 0.947682, 'specificity': 0.947682, 'f1': 0.964334, 'auroc': 0.9991591, 'binary_precision': 0.99473333, 'binary_recall': 0.99858564, 'binary_specificity': 0.89677846, 'binary_f1_score': 0.99665576}
confusion matrix:
      0      1
0  1364    157
1    42  29653
---- Validation: 
scalar performance:
{'acc': 0.85870415, 'precision': 0.8707311, 'recall': 0.86018944, 'specificity': 0.86018944, 'f1': 0.8578723, 'auroc': 0.9454514, 'binary_precision': 0.799733, 'binary_recall': 0.9507936, 'binary_specificity': 0.76958525, 'binary_f1_score': 0.86874545}
confusion matrix:
     0    1
0  501  150
1   31  599
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.84518826, 'precision': 0.8526134, 'recall': 0.8407203, 'specificity': 0.8407203, 'f1': 0.84271, 'auroc': 0.9253228, 'binary_precision': 0.81403506, 'binary_recall': 0.91699606, 'binary_specificity': 0.7644445, 'binary_f1_score': 0.86245346}
confusion matrix:
     0    1
0  172   53
1   21  232
early stop counter: 3
val acc:0.858704149723053, best validation acc: 0.8852459192276001, corresponding to test acc:                         0.8682008385658264 / 0.8682008385658264
after epoch: 11,now: 2024-07-13 18:07:59.051358,epoch time: 0:10:11.762115,used: 1:48:15.232784,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_16_19_43_seed_1_21955596
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9942017, 'precision': 0.99039125, 'recall': 0.9464257, 'specificity': 0.9464257, 'f1': 0.96726215, 'auroc': 0.9993452, 'binary_precision': 0.9945707, 'binary_recall': 0.99936014, 'binary_specificity': 0.89349115, 'binary_f1_score': 0.9969596}
confusion matrix:
      0      1
0  1359    162
1    19  29676
---- Validation: 
scalar performance:
{'acc': 0.7759563, 'precision': 0.82575536, 'recall': 0.77913463, 'specificity': 0.77913463, 'f1': 0.76835835, 'auroc': 0.9469851, 'binary_precision': 0.69422424, 'binary_recall': 0.97301584, 'binary_specificity': 0.5852535, 'binary_f1_score': 0.81031054}
confusion matrix:
     0    1
0  381  270
1   17  613
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.77615064, 'precision': 0.8141426, 'recall': 0.7654194, 'specificity': 0.7654194, 'f1': 0.76387215, 'auroc': 0.9328941, 'binary_precision': 0.7185629, 'binary_recall': 0.9486166, 'binary_specificity': 0.5822222, 'binary_f1_score': 0.8177172}
confusion matrix:
     0    1
0  131   94
1   13  240
early stop counter: 4
val acc:0.7759562730789185, best validation acc: 0.8852459192276001, corresponding to test acc:                         0.8682008385658264 / 0.8682008385658264
after epoch: 12,now: 2024-07-13 18:17:50.349877,epoch time: 0:09:51.298519,used: 1:58:06.531303,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_16_19_43_seed_1_21955596
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9939454, 'precision': 0.99089193, 'recall': 0.94313484, 'specificity': 0.94313484, 'f1': 0.96565735, 'auroc': 0.99939835, 'binary_precision': 0.9942381, 'binary_recall': 0.99942756, 'binary_specificity': 0.88684213, 'binary_f1_score': 0.996826}
confusion matrix:
      0      1
0  1348    172
1    17  29679
---- Validation: 
scalar performance:
{'acc': 0.86260736, 'precision': 0.86931443, 'recall': 0.86372244, 'specificity': 0.86372244, 'f1': 0.86220753, 'auroc': 0.9453368, 'binary_precision': 0.81527776, 'binary_recall': 0.931746, 'binary_specificity': 0.79569894, 'binary_f1_score': 0.8696296}
confusion matrix:
     0    1
0  518  133
1   43  587
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.86820084, 'precision': 0.86781144, 'recall': 0.86762404, 'specificity': 0.86762404, 'f1': 0.8677139, 'auroc': 0.9322969, 'binary_precision': 0.87401575, 'binary_recall': 0.8774704, 'binary_specificity': 0.8577778, 'binary_f1_score': 0.8757397}
confusion matrix:
     0    1
0  193   32
1   31  222
early stop counter: 5
val acc:0.8626073598861694, best validation acc: 0.8852459192276001, corresponding to test acc:                         0.8682008385658264 / 0.8682008385658264
after epoch: 13,now: 2024-07-13 18:27:47.148667,epoch time: 0:09:56.798790,used: 2:08:03.330093,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_16_19_43_seed_1_21955596
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9943619, 'precision': 0.9567654, 'recall': 0.98517644, 'specificity': 0.98517644, 'f1': 0.97049034, 'auroc': 0.9993527, 'binary_precision': 0.99871606, 'binary_recall': 0.9953529, 'binary_specificity': 0.975, 'binary_f1_score': 0.9970316}
confusion matrix:
      0      1
0  1482     38
1   138  29558
---- Validation: 
scalar performance:
{'acc': 0.8891491, 'precision': 0.88973665, 'recall': 0.8888377, 'specificity': 0.8888377, 'f1': 0.889024, 'auroc': 0.9424768, 'binary_precision': 0.9013158, 'binary_recall': 0.8698413, 'binary_specificity': 0.9078341, 'binary_f1_score': 0.8852989}
confusion matrix:
     0    1
0  591   60
1   82  548
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8493724, 'precision': 0.8559024, 'recall': 0.8535266, 'specificity': 0.8535266, 'f1': 0.84930646, 'auroc': 0.9267457, 'binary_precision': 0.9209302, 'binary_recall': 0.7826087, 'binary_specificity': 0.92444444, 'binary_f1_score': 0.84615386}
confusion matrix:
     0    1
0  208   17
1   55  198
better model found
persisted
after epoch: 14,now: 2024-07-13 18:37:31.174092,epoch time: 0:09:44.025425,used: 2:17:47.355518,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_16_19_43_seed_1_21955596
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.99445796, 'precision': 0.96539634, 'recall': 0.9755516, 'specificity': 0.9755516, 'f1': 0.9704126, 'auroc': 0.99910283, 'binary_precision': 0.9976737, 'binary_recall': 0.99649787, 'binary_specificity': 0.9546053, 'binary_f1_score': 0.99708545}
confusion matrix:
      0      1
0  1451     69
1   104  29592
---- Validation: 
scalar performance:
{'acc': 0.84387195, 'precision': 0.8462013, 'recall': 0.84454685, 'specificity': 0.84454685, 'f1': 0.84375536, 'auroc': 0.9182478, 'binary_precision': 0.81341106, 'binary_recall': 0.8857143, 'binary_specificity': 0.8033794, 'binary_f1_score': 0.84802437}
confusion matrix:
     0    1
0  523  128
1   72  558
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8786611, 'precision': 0.88055277, 'recall': 0.8811946, 'specificity': 0.8811946, 'f1': 0.8786526, 'auroc': 0.9306631, 'binary_precision': 0.9257642, 'binary_recall': 0.8379447, 'binary_specificity': 0.92444444, 'binary_f1_score': 0.8796681}
confusion matrix:
     0    1
0  208   17
1   41  212
new oracle model saved
early stop counter: 1
val acc:0.8438719511032104, best validation acc: 0.8891491293907166, corresponding to test acc:                         0.849372386932373 / 0.8786610960960388
after epoch: 15,now: 2024-07-13 18:47:14.887409,epoch time: 0:09:43.713317,used: 2:27:31.068835,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_16_19_43_seed_1_21955596
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9930805, 'precision': 0.9429673, 'recall': 0.9885657, 'specificity': 0.9885657, 'f1': 0.96451056, 'auroc': 0.9994954, 'binary_precision': 0.9991534, 'binary_recall': 0.99356794, 'binary_specificity': 0.9835634, 'binary_f1_score': 0.9963528}
confusion matrix:
      0      1
0  1496     25
1   191  29504
---- Validation: 
scalar performance:
{'acc': 0.8883685, 'precision': 0.88934374, 'recall': 0.8879672, 'specificity': 0.8879672, 'f1': 0.88819814, 'auroc': 0.93948257, 'binary_precision': 0.90515804, 'binary_recall': 0.8634921, 'binary_specificity': 0.9124424, 'binary_f1_score': 0.8838343}
confusion matrix:
     0    1
0  594   57
1   86  544
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.83682007, 'precision': 0.85286415, 'recall': 0.84314454, 'specificity': 0.84314454, 'f1': 0.83625823, 'auroc': 0.9213526, 'binary_precision': 0.9441624, 'binary_recall': 0.7351779, 'binary_specificity': 0.95111114, 'binary_f1_score': 0.82666665}
confusion matrix:
     0    1
0  214   11
1   67  186
early stop counter: 2
val acc:0.8883684873580933, best validation acc: 0.8891491293907166, corresponding to test acc:                         0.849372386932373 / 0.8786610960960388
after epoch: 16,now: 2024-07-13 18:57:14.775651,epoch time: 0:09:59.888242,used: 2:37:30.957077,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_16_19_43_seed_1_21955596
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9955472, 'precision': 0.98464715, 'recall': 0.9667607, 'specificity': 0.9667607, 'f1': 0.9755166, 'auroc': 0.9994, 'binary_precision': 0.9966728, 'binary_recall': 0.998653, 'binary_specificity': 0.9348684, 'binary_f1_score': 0.9976619}
confusion matrix:
      0      1
0  1421     99
1    40  29656
---- Validation: 
scalar performance:
{'acc': 0.7494145, 'precision': 0.8141414, 'recall': 0.7530978, 'specificity': 0.7530978, 'f1': 0.7375832, 'auroc': 0.945048, 'binary_precision': 0.667389, 'binary_recall': 0.9777778, 'binary_specificity': 0.5284178, 'binary_f1_score': 0.79330325}
confusion matrix:
     0    1
0  344  307
1   14  616
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.73221755, 'precision': 0.79383004, 'recall': 0.71801496, 'specificity': 0.71801496, 'f1': 0.7086309, 'auroc': 0.9304699, 'binary_precision': 0.6731302, 'binary_recall': 0.9604743, 'binary_specificity': 0.47555557, 'binary_f1_score': 0.7915309}
confusion matrix:
     0    1
0  107  118
1   10  243
early stop counter: 3
val acc:0.7494145035743713, best validation acc: 0.8891491293907166, corresponding to test acc:                         0.849372386932373 / 0.8786610960960388
after epoch: 17,now: 2024-07-13 19:07:12.976427,epoch time: 0:09:58.200776,used: 2:47:29.157853,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_16_19_43_seed_1_21955596
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9958675, 'precision': 0.9786967, 'recall': 0.97660446, 'specificity': 0.97660446, 'f1': 0.9776481, 'auroc': 0.999472, 'binary_precision': 0.99771065, 'binary_recall': 0.99794585, 'binary_specificity': 0.95526314, 'binary_f1_score': 0.99782825}
confusion matrix:
      0      1
0  1452     68
1    61  29635
---- Validation: 
scalar performance:
{'acc': 0.8376269, 'precision': 0.8579613, 'recall': 0.8395802, 'specificity': 0.8395802, 'f1': 0.8358033, 'auroc': 0.9502773, 'binary_precision': 0.7684478, 'binary_recall': 0.95873016, 'binary_specificity': 0.72043014, 'binary_f1_score': 0.85310733}
confusion matrix:
     0    1
0  469  182
1   26  604
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.84518826, 'precision': 0.85565174, 'recall': 0.8399824, 'specificity': 0.8399824, 'f1': 0.8421794, 'auroc': 0.9415195, 'binary_precision': 0.80756015, 'binary_recall': 0.92885375, 'binary_specificity': 0.7511111, 'binary_f1_score': 0.8639706}
confusion matrix:
     0    1
0  169   56
1   18  235
early stop counter: 4
val acc:0.8376268744468689, best validation acc: 0.8891491293907166, corresponding to test acc:                         0.849372386932373 / 0.8786610960960388
after epoch: 18,now: 2024-07-13 19:17:05.509914,epoch time: 0:09:52.533487,used: 2:57:21.691340,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_16_19_43_seed_1_21955596
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.99022937, 'precision': 0.9902703, 'recall': 0.9034164, 'specificity': 0.9034164, 'f1': 0.94217074, 'auroc': 0.99942625, 'binary_precision': 0.99022585, 'binary_recall': 0.9995959, 'binary_specificity': 0.80723685, 'binary_f1_score': 0.99488884}
confusion matrix:
      0      1
0  1227    293
1    12  29684
---- Validation: 
scalar performance:
{'acc': 0.64480877, 'precision': 0.7720582, 'recall': 0.6503328, 'specificity': 0.6503328, 'f1': 0.60248244, 'auroc': 0.93799347, 'binary_precision': 0.5818522, 'binary_recall': 0.9873016, 'binary_specificity': 0.31336406, 'binary_f1_score': 0.73219544}
confusion matrix:
     0    1
0  204  447
1    8  622
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.58995813, 'precision': 0.76575017, 'recall': 0.5646904, 'specificity': 0.5646904, 'f1': 0.47718745, 'auroc': 0.93169963, 'binary_precision': 0.5637584, 'binary_recall': 0.99604744, 'binary_specificity': 0.13333334, 'binary_f1_score': 0.7199999}
confusion matrix:
    0    1
0  30  195
1   1  252
early stop counter: 5
val acc:0.6448087692260742, best validation acc: 0.8891491293907166, corresponding to test acc:                         0.849372386932373 / 0.8786610960960388
after epoch: 19,now: 2024-07-13 19:27:00.830495,epoch time: 0:09:55.320581,used: 3:07:17.011921,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_16_19_43_seed_1_21955596
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9942978, 'precision': 0.9536468, 'recall': 0.9885818, 'specificity': 0.9885818, 'f1': 0.9703871, 'auroc': 0.99952483, 'binary_precision': 0.9990869, 'binary_recall': 0.99491495, 'binary_specificity': 0.98224854, 'binary_f1_score': 0.9969966}
confusion matrix:
      0      1
0  1494     27
1   151  29544
---- Validation: 
scalar performance:
{'acc': 0.89617485, 'precision': 0.8984564, 'recall': 0.8955709, 'specificity': 0.8955709, 'f1': 0.8958985, 'auroc': 0.9481164, 'binary_precision': 0.9247863, 'binary_recall': 0.85873014, 'binary_specificity': 0.9324117, 'binary_f1_score': 0.890535}
confusion matrix:
     0    1
0  607   44
1   89  541
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.83472806, 'precision': 0.8605627, 'recall': 0.84264386, 'specificity': 0.84264386, 'f1': 0.83350307, 'auroc': 0.9328415, 'binary_precision': 0.97282606, 'binary_recall': 0.7075099, 'binary_specificity': 0.9777778, 'binary_f1_score': 0.8192219}
confusion matrix:
     0    1
0  220    5
1   74  179
better model found
persisted
after epoch: 20,now: 2024-07-13 19:37:04.067075,epoch time: 0:10:03.236580,used: 3:17:20.248501,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_16_19_43_seed_1_21955596
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9927601, 'precision': 0.94246066, 'recall': 0.98527837, 'specificity': 0.98527837, 'f1': 0.9627577, 'auroc': 0.99941653, 'binary_precision': 0.9988151, 'binary_recall': 0.99356794, 'binary_specificity': 0.97698885, 'binary_f1_score': 0.99618465}
confusion matrix:
      0      1
0  1486     35
1   191  29504
---- Validation: 
scalar performance:
{'acc': 0.89461356, 'precision': 0.8949132, 'recall': 0.8943932, 'specificity': 0.8943932, 'f1': 0.89453024, 'auroc': 0.9431156, 'binary_precision': 0.902439, 'binary_recall': 0.88095236, 'binary_specificity': 0.9078341, 'binary_f1_score': 0.8915662}
confusion matrix:
     0    1
0  591   60
1   75  555
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8702929, 'precision': 0.87617636, 'recall': 0.8742732, 'specificity': 0.8742732, 'f1': 0.87025654, 'auroc': 0.93582344, 'binary_precision': 0.94009215, 'binary_recall': 0.8063241, 'binary_specificity': 0.94222224, 'binary_f1_score': 0.8680851}
confusion matrix:
     0    1
0  212   13
1   49  204
early stop counter: 1
val acc:0.8946135640144348, best validation acc: 0.8961748480796814, corresponding to test acc:                         0.8347280621528625 / 0.8786610960960388
after epoch: 21,now: 2024-07-13 19:46:59.670322,epoch time: 0:09:55.603247,used: 3:27:15.851748,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_16_19_43_seed_1_21955596
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9963801, 'precision': 0.9794739, 'recall': 0.981567, 'specificity': 0.981567, 'f1': 0.98051786, 'auroc': 0.9996865, 'binary_precision': 0.9982148, 'binary_recall': 0.99797946, 'binary_specificity': 0.9651545, 'binary_f1_score': 0.9980971}
confusion matrix:
      0      1
0  1468     53
1    60  29635
---- Validation: 
scalar performance:
{'acc': 0.8930523, 'precision': 0.8948015, 'recall': 0.89362514, 'specificity': 0.89362514, 'f1': 0.8930082, 'auroc': 0.94811344, 'binary_precision': 0.86410636, 'binary_recall': 0.9285714, 'binary_specificity': 0.85867894, 'binary_f1_score': 0.89517975}
confusion matrix:
     0    1
0  559   92
1   45  585
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9121339, 'precision': 0.91312957, 'recall': 0.9142908, 'specificity': 0.9142908, 'f1': 0.9121093, 'auroc': 0.9483531, 'binary_precision': 0.9527897, 'binary_recall': 0.8774704, 'binary_specificity': 0.95111114, 'binary_f1_score': 0.9135803}
confusion matrix:
     0    1
0  214   11
1   31  222
new oracle model saved
early stop counter: 2
val acc:0.8930522799491882, best validation acc: 0.8961748480796814, corresponding to test acc:                         0.8347280621528625 / 0.9121338725090027
after epoch: 22,now: 2024-07-13 19:56:54.024885,epoch time: 0:09:54.354563,used: 3:37:10.206311,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_16_19_43_seed_1_21955596
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.9951307, 'precision': 0.9644243, 'recall': 0.984653, 'specificity': 0.984653, 'f1': 0.9742972, 'auroc': 0.9996058, 'binary_precision': 0.99861604, 'binary_recall': 0.996262, 'binary_specificity': 0.97304404, 'binary_f1_score': 0.99743766}
confusion matrix:
      0      1
0  1480     41
1   111  29584
---- Validation: 
scalar performance:
{'acc': 0.90710384, 'precision': 0.9070718, 'recall': 0.9070916, 'specificity': 0.9070916, 'f1': 0.9070811, 'auroc': 0.95288265, 'binary_precision': 0.9049128, 'binary_recall': 0.9063492, 'binary_specificity': 0.9078341, 'binary_f1_score': 0.9056304}
confusion matrix:
     0    1
0  591   60
1   59  571
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9121339, 'precision': 0.9127397, 'recall': 0.9140448, 'specificity': 0.9140448, 'f1': 0.9120954, 'auroc': 0.9538164, 'binary_precision': 0.94893616, 'binary_recall': 0.88142294, 'binary_specificity': 0.94666666, 'binary_f1_score': 0.9139344}
confusion matrix:
     0    1
0  213   12
1   30  223
better model found
persisted
after epoch: 23,now: 2024-07-13 20:06:48.319054,epoch time: 0:09:54.294169,used: 3:47:04.500480,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_16_19_43_seed_1_21955596
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9943298, 'precision': 0.97261655, 'recall': 0.9658303, 'specificity': 0.9658303, 'f1': 0.9691961, 'auroc': 0.9993086, 'binary_precision': 0.996635, 'binary_recall': 0.99740696, 'binary_specificity': 0.93425375, 'binary_f1_score': 0.99702084}
confusion matrix:
      0      1
0  1421    100
1    77  29618
---- Validation: 
scalar performance:
{'acc': 0.89071035, 'precision': 0.89191926, 'recall': 0.89119303, 'specificity': 0.89119303, 'f1': 0.89068633, 'auroc': 0.9414332, 'binary_precision': 0.86567163, 'binary_recall': 0.9206349, 'binary_specificity': 0.86175114, 'binary_f1_score': 0.8923077}
confusion matrix:
     0    1
0  561   90
1   50  580
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.89748955, 'precision': 0.89767444, 'recall': 0.89652175, 'specificity': 0.89652175, 'f1': 0.89699864, 'auroc': 0.9366886, 'binary_precision': 0.89534885, 'binary_recall': 0.9130435, 'binary_specificity': 0.88, 'binary_f1_score': 0.9041096}
confusion matrix:
     0    1
0  198   27
1   22  231
early stop counter: 1
val acc:0.8907103538513184, best validation acc: 0.9071038365364075, corresponding to test acc:                         0.9121338725090027 / 0.9121338725090027
after epoch: 24,now: 2024-07-13 20:16:44.129040,epoch time: 0:09:55.809986,used: 3:57:00.310466,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_16_19_43_seed_1_21955596
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.99545103, 'precision': 0.97241735, 'recall': 0.9788954, 'specificity': 0.9788954, 'f1': 0.9756317, 'auroc': 0.9994452, 'binary_precision': 0.997978, 'binary_recall': 0.9972386, 'binary_specificity': 0.9605523, 'binary_f1_score': 0.9976081}
confusion matrix:
      0      1
0  1461     60
1    82  29613
---- Validation: 
scalar performance:
{'acc': 0.9032006, 'precision': 0.90316296, 'recall': 0.9032514, 'specificity': 0.9032514, 'f1': 0.90318733, 'auroc': 0.9523053, 'binary_precision': 0.8977987, 'binary_recall': 0.9063492, 'binary_specificity': 0.90015364, 'binary_f1_score': 0.90205365}
confusion matrix:
     0    1
0  586   65
1   59  571
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.91422594, 'precision': 0.91544014, 'recall': 0.91651297, 'specificity': 0.91651297, 'f1': 0.9142076, 'auroc': 0.95246375, 'binary_precision': 0.95689654, 'binary_recall': 0.8774704, 'binary_specificity': 0.95555556, 'binary_f1_score': 0.9154639}
confusion matrix:
     0    1
0  215   10
1   31  222
new oracle model saved
early stop counter: 2
val acc:0.903200626373291, best validation acc: 0.9071038365364075, corresponding to test acc:                         0.9121338725090027 / 0.9142259359359741
after epoch: 25,now: 2024-07-13 20:26:40.901466,epoch time: 0:09:56.772426,used: 4:06:57.082892,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_16_19_43_seed_1_21955596
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9967965, 'precision': 0.9812799, 'recall': 0.98428106, 'specificity': 0.98428106, 'f1': 0.9827753, 'auroc': 0.99966466, 'binary_precision': 0.9984841, 'binary_recall': 0.99814785, 'binary_specificity': 0.9704142, 'binary_f1_score': 0.99831593}
confusion matrix:
      0      1
0  1476     45
1    55  29640
---- Validation: 
scalar performance:
{'acc': 0.88212335, 'precision': 0.8835267, 'recall': 0.8826421, 'specificity': 0.8826421, 'f1': 0.88208854, 'auroc': 0.9438885, 'binary_precision': 0.85586923, 'binary_recall': 0.9142857, 'binary_specificity': 0.85099846, 'binary_f1_score': 0.8841136}
confusion matrix:
     0    1
0  554   97
1   54  576
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8702929, 'precision': 0.8701868, 'recall': 0.8693544, 'specificity': 0.8693544, 'f1': 0.8697089, 'auroc': 0.9157839, 'binary_precision': 0.8715953, 'binary_recall': 0.8853755, 'binary_specificity': 0.85333335, 'binary_f1_score': 0.8784313}
confusion matrix:
     0    1
0  192   33
1   29  224
early stop counter: 3
val acc:0.8821233510971069, best validation acc: 0.9071038365364075, corresponding to test acc:                         0.9121338725090027 / 0.9142259359359741
after epoch: 26,now: 2024-07-13 20:36:37.013752,epoch time: 0:09:56.112286,used: 4:16:53.195178,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_16_19_43_seed_1_21955596
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.9963801, 'precision': 0.98236144, 'recall': 0.97844803, 'specificity': 0.97844803, 'f1': 0.9803959, 'auroc': 0.9995922, 'binary_precision': 0.9978794, 'binary_recall': 0.9983162, 'binary_specificity': 0.9585799, 'binary_f1_score': 0.9980978}
confusion matrix:
      0      1
0  1458     63
1    50  29645
---- Validation: 
scalar performance:
{'acc': 0.8813427, 'precision': 0.8844875, 'recall': 0.88210446, 'specificity': 0.88210446, 'f1': 0.88122106, 'auroc': 0.94775796, 'binary_precision': 0.8453757, 'binary_recall': 0.9285714, 'binary_specificity': 0.8356375, 'binary_f1_score': 0.8850227}
confusion matrix:
     0    1
0  544  107
1   45  585
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8912134, 'precision': 0.89122665, 'recall': 0.89034694, 'specificity': 0.89034694, 'f1': 0.8907237, 'auroc': 0.9389899, 'binary_precision': 0.8910506, 'binary_recall': 0.9051383, 'binary_specificity': 0.8755556, 'binary_f1_score': 0.8980393}
confusion matrix:
     0    1
0  197   28
1   24  229
early stop counter: 4
val acc:0.8813427090644836, best validation acc: 0.9071038365364075, corresponding to test acc:                         0.9121338725090027 / 0.9142259359359741
after epoch: 27,now: 2024-07-13 20:46:33.176175,epoch time: 0:09:56.162423,used: 4:26:49.357601,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_16_19_43_seed_1_21955596
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.9955472, 'precision': 0.99427027, 'recall': 0.9574253, 'specificity': 0.9574253, 'f1': 0.97505516, 'auroc': 0.99962085, 'binary_precision': 0.9956732, 'binary_recall': 0.99966323, 'binary_specificity': 0.91518736, 'binary_f1_score': 0.9976642}
confusion matrix:
      0      1
0  1392    129
1    10  29685
---- Validation: 
scalar performance:
{'acc': 0.79547226, 'precision': 0.8354801, 'recall': 0.79828465, 'specificity': 0.79828465, 'f1': 0.7902037, 'auroc': 0.94528997, 'binary_precision': 0.71545666, 'binary_recall': 0.96984124, 'binary_specificity': 0.6267281, 'binary_f1_score': 0.8234501}
confusion matrix:
     0    1
0  408  243
1   19  611
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8117155, 'precision': 0.8347372, 'recall': 0.80368906, 'specificity': 0.80368906, 'f1': 0.8051101, 'auroc': 0.915661, 'binary_precision': 0.76038337, 'binary_recall': 0.94071144, 'binary_specificity': 0.6666667, 'binary_f1_score': 0.84098935}
confusion matrix:
     0    1
0  150   75
1   15  238
early stop counter: 5
val acc:0.795472264289856, best validation acc: 0.9071038365364075, corresponding to test acc:                         0.9121338725090027 / 0.9142259359359741
after epoch: 28,now: 2024-07-13 20:56:29.388503,epoch time: 0:09:56.212328,used: 4:36:45.569929,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_16_19_43_seed_1_21955596
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9966043, 'precision': 0.9805229, 'recall': 0.98292184, 'specificity': 0.98292184, 'f1': 0.981719, 'auroc': 0.99965835, 'binary_precision': 0.9983495, 'binary_recall': 0.99808055, 'binary_specificity': 0.9677632, 'binary_f1_score': 0.998215}
confusion matrix:
      0      1
0  1471     49
1    57  29639
---- Validation: 
scalar performance:
{'acc': 0.8953942, 'precision': 0.8957428, 'recall': 0.8956733, 'specificity': 0.8956733, 'f1': 0.8953936, 'auroc': 0.9486456, 'binary_precision': 0.87920487, 'binary_recall': 0.9126984, 'binary_specificity': 0.8786482, 'binary_f1_score': 0.8956386}
confusion matrix:
     0    1
0  572   79
1   55  575
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8577406, 'precision': 0.85735047, 'recall': 0.85848045, 'specificity': 0.85848045, 'f1': 0.8575385, 'auroc': 0.91409755, 'binary_precision': 0.88065845, 'binary_recall': 0.8458498, 'binary_specificity': 0.8711111, 'binary_f1_score': 0.8629032}
confusion matrix:
     0    1
0  196   29
1   39  214
early stop counter: 6
val acc:0.8953942060470581, best validation acc: 0.9071038365364075, corresponding to test acc:                         0.9121338725090027 / 0.9142259359359741
after epoch: 29,now: 2024-07-13 21:06:23.325725,epoch time: 0:09:53.937222,used: 4:46:39.507151,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_16_19_43_seed_1_21955596
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.9955792, 'precision': 0.99002206, 'recall': 0.9618087, 'specificity': 0.9618087, 'f1': 0.97545016, 'auroc': 0.9996135, 'binary_precision': 0.9961392, 'binary_recall': 0.99922544, 'binary_specificity': 0.92439187, 'binary_f1_score': 0.99767995}
confusion matrix:
      0      1
0  1406    115
1    23  29672
---- Validation: 
scalar performance:
{'acc': 0.8485558, 'precision': 0.8622507, 'recall': 0.85015357, 'specificity': 0.85015357, 'f1': 0.84749174, 'auroc': 0.9490594, 'binary_precision': 0.78759897, 'binary_recall': 0.947619, 'binary_specificity': 0.75268817, 'binary_f1_score': 0.86023057}
confusion matrix:
     0    1
0  490  161
1   33  597
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.87656903, 'precision': 0.8780855, 'recall': 0.87454545, 'specificity': 0.87454545, 'f1': 0.87565416, 'auroc': 0.9271146, 'binary_precision': 0.86466163, 'binary_recall': 0.90909094, 'binary_specificity': 0.84, 'binary_f1_score': 0.8863198}
confusion matrix:
     0    1
0  189   36
1   23  230
early stop counter: 7
val acc:0.8485558032989502, best validation acc: 0.9071038365364075, corresponding to test acc:                         0.9121338725090027 / 0.9142259359359741
after epoch: 30,now: 2024-07-13 21:17:19.822822,epoch time: 0:10:56.497097,used: 4:57:36.004248,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_16_19_43_seed_1_21955596
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 4:57:36.004248 at 2024-07-13 21:17:19.822822
persisted model performance metric: 

scalar performance:
{'acc': 0.9121339, 'precision': 0.9127397, 'recall': 0.9140448, 'specificity': 0.9140448, 'f1': 0.9120954, 'auroc': 0.9538164, 'binary_precision': 0.94893616, 'binary_recall': 0.88142294, 'binary_specificity': 0.94666666, 'binary_f1_score': 0.9139344}
confusion matrix:
     0    1
0  213   12
1   30  223
oracle model performance metric: 

scalar performance:
{'acc': 0.91422594, 'precision': 0.91544014, 'recall': 0.91651297, 'specificity': 0.91651297, 'f1': 0.9142076, 'auroc': 0.95246375, 'binary_precision': 0.95689654, 'binary_recall': 0.8774704, 'binary_specificity': 0.95555556, 'binary_f1_score': 0.9154639}
confusion matrix:
     0    1
0  215   10
1   31  222
results aggregation path: zoutput/benchmarks/CAMELYONWILD_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_halffreeze/rule_results/3.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONWILD_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_halffreeze/confusion_matrix/3.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 318521 KiB |   6782 MiB | 580994 GiB | 580994 GiB |
|       from large pool | 291339 KiB |   6756 MiB | 571695 GiB | 571695 GiB |
|       from small pool |  27182 KiB |     43 MiB |   9298 GiB |   9298 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 318521 KiB |   6782 MiB | 580994 GiB | 580994 GiB |
|       from large pool | 291339 KiB |   6756 MiB | 571695 GiB | 571695 GiB |
|       from small pool |  27182 KiB |     43 MiB |   9298 GiB |   9298 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 313851 KiB |   6778 MiB | 579893 GiB | 579893 GiB |
|       from large pool | 286862 KiB |   6752 MiB | 570615 GiB | 570615 GiB |
|       from small pool |  26989 KiB |     43 MiB |   9277 GiB |   9277 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   7456 MiB |   7456 MiB |  14316 MiB |   6860 MiB |
|       from large pool |   7404 MiB |   7404 MiB |  14248 MiB |   6844 MiB |
|       from small pool |     52 MiB |     52 MiB |     68 MiB |     16 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 285638 KiB | 680184 KiB | 453948 GiB | 453948 GiB |
|       from large pool | 275957 KiB | 675647 KiB | 444637 GiB | 444637 GiB |
|       from small pool |   9681 KiB |  28451 KiB |   9310 GiB |   9310 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    1058    |    4649    |  118421 K  |  118420 K  |
|       from large pool |     130    |     756    |   53912 K  |   53912 K  |
|       from small pool |     928    |    4517    |   64508 K  |   64507 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    1058    |    4649    |  118421 K  |  118420 K  |
|       from large pool |     130    |     756    |   53912 K  |   53912 K  |
|       from small pool |     928    |    4517    |   64508 K  |   64507 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     335    |     335    |     627    |     292    |
|       from large pool |     309    |     309    |     593    |     284    |
|       from small pool |      26    |      26    |      34    |       8    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      73    |    1997    |   70745 K  |   70745 K  |
|       from large pool |      27    |     307    |   41575 K  |   41575 K  |
|       from small pool |      46    |    1971    |   29169 K  |   29169 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   6782 MiB | 580994 GiB | 580994 GiB |
|       from large pool |  16640 KiB |   6756 MiB | 571695 GiB | 571695 GiB |
|       from small pool |      0 KiB |     43 MiB |   9298 GiB |   9298 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   6782 MiB | 580994 GiB | 580994 GiB |
|       from large pool |  16640 KiB |   6756 MiB | 571695 GiB | 571695 GiB |
|       from small pool |      0 KiB |     43 MiB |   9298 GiB |   9298 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   6778 MiB | 579893 GiB | 579893 GiB |
|       from large pool |  16640 KiB |   6752 MiB | 570615 GiB | 570615 GiB |
|       from small pool |      0 KiB |     43 MiB |   9277 GiB |   9277 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 604160 KiB |   7456 MiB |  14316 MiB |  13726 MiB |
|       from large pool | 567296 KiB |   7404 MiB |  14248 MiB |  13694 MiB |
|       from small pool |  36864 KiB |     52 MiB |     68 MiB |     32 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 680184 KiB | 453948 GiB | 453948 GiB |
|       from large pool |  24320 KiB | 675647 KiB | 444638 GiB | 444638 GiB |
|       from small pool |      0 KiB |  30502 KiB |   9310 GiB |   9310 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    4649    |  118421 K  |  118421 K  |
|       from large pool |       2    |     756    |   53912 K  |   53912 K  |
|       from small pool |       0    |    4517    |   64508 K  |   64508 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    4649    |  118421 K  |  118421 K  |
|       from large pool |       2    |     756    |   53912 K  |   53912 K  |
|       from small pool |       0    |    4517    |   64508 K  |   64508 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      43    |     335    |     627    |     584    |
|       from large pool |      25    |     309    |     593    |     568    |
|       from small pool |      18    |      26    |      34    |      16    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    1997    |   70745 K  |   70745 K  |
|       from large pool |       3    |     307    |   41575 K  |   41575 K  |
|       from small pool |       0    |    1971    |   29169 K  |   29169 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   6782 MiB | 580994 GiB | 580994 GiB |
|       from large pool |  16640 KiB |   6756 MiB | 571695 GiB | 571695 GiB |
|       from small pool |      0 KiB |     43 MiB |   9298 GiB |   9298 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   6782 MiB | 580994 GiB | 580994 GiB |
|       from large pool |  16640 KiB |   6756 MiB | 571695 GiB | 571695 GiB |
|       from small pool |      0 KiB |     43 MiB |   9298 GiB |   9298 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   6778 MiB | 579893 GiB | 579893 GiB |
|       from large pool |  16640 KiB |   6752 MiB | 570615 GiB | 570615 GiB |
|       from small pool |      0 KiB |     43 MiB |   9277 GiB |   9277 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 604160 KiB |   7456 MiB |  14316 MiB |  13726 MiB |
|       from large pool | 567296 KiB |   7404 MiB |  14248 MiB |  13694 MiB |
|       from small pool |  36864 KiB |     52 MiB |     68 MiB |     32 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 680184 KiB | 453948 GiB | 453948 GiB |
|       from large pool |  24320 KiB | 675647 KiB | 444638 GiB | 444638 GiB |
|       from small pool |      0 KiB |  30502 KiB |   9310 GiB |   9310 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    4649    |  118421 K  |  118421 K  |
|       from large pool |       2    |     756    |   53912 K  |   53912 K  |
|       from small pool |       0    |    4517    |   64508 K  |   64508 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    4649    |  118421 K  |  118421 K  |
|       from large pool |       2    |     756    |   53912 K  |   53912 K  |
|       from small pool |       0    |    4517    |   64508 K  |   64508 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      43    |     335    |     627    |     584    |
|       from large pool |      25    |     309    |     593    |     568    |
|       from small pool |      18    |      26    |      34    |      16    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    1997    |   70745 K  |   70745 K  |
|       from large pool |       3    |     307    |   41575 K  |   41575 K  |
|       from small pool |       0    |    1971    |   29169 K  |   29169 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_21_30_35_seed_2_21955596

 Experiment start at: 2024-07-13 21:30:35.086678
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
before training, model accuracy: 0.3810526132583618
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9824707, 'precision': 0.92023784, 'recall': 0.8821549, 'specificity': 0.8821549, 'f1': 0.90018463, 'auroc': 0.9928806, 'binary_precision': 0.98843485, 'binary_recall': 0.9932016, 'binary_specificity': 0.77110815, 'binary_f1_score': 0.9908125}
confusion matrix:
      0      1
0  1169    347
1   203  29657
---- Validation: 
scalar performance:
{'acc': 0.63302034, 'precision': 0.75946534, 'recall': 0.6420722, 'specificity': 0.6420722, 'f1': 0.5902264, 'auroc': 0.90876937, 'binary_precision': 0.57156223, 'binary_recall': 0.9823151, 'binary_specificity': 0.30182928, 'binary_f1_score': 0.72264934}
confusion matrix:
     0    1
0  198  458
1   11  611
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.63578945, 'precision': 0.7614919, 'recall': 0.6010743, 'specificity': 0.6010743, 'f1': 0.5493828, 'auroc': 0.91346705, 'binary_precision': 0.6014151, 'binary_recall': 0.98455596, 'binary_specificity': 0.2175926, 'binary_f1_score': 0.7467057}
confusion matrix:
    0    1
0  47  169
1   4  255
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-13 21:40:32.811601,epoch time: 0:09:57.724923,used: 0:09:57.724923,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_21_30_35_seed_2_21955596
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9842236, 'precision': 0.9642818, 'recall': 0.8574041, 'specificity': 0.8574041, 'f1': 0.90314937, 'auroc': 0.9939517, 'binary_precision': 0.9858055, 'binary_recall': 0.9977897, 'binary_specificity': 0.7170185, 'binary_f1_score': 0.9917614}
confusion matrix:
      0      1
0  1087    429
1    66  29794
---- Validation: 
scalar performance:
{'acc': 0.6682316, 'precision': 0.76851356, 'recall': 0.67616266, 'specificity': 0.67616266, 'f1': 0.6399809, 'auroc': 0.9249673, 'binary_precision': 0.5976331, 'binary_recall': 0.97427654, 'binary_specificity': 0.37804878, 'binary_f1_score': 0.7408313}
confusion matrix:
     0    1
0  248  408
1   16  606
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.67157894, 'precision': 0.76691717, 'recall': 0.6415791, 'specificity': 0.6415791, 'f1': 0.6128527, 'auroc': 0.9296975, 'binary_precision': 0.62842894, 'binary_recall': 0.972973, 'binary_specificity': 0.3101852, 'binary_f1_score': 0.76363635}
confusion matrix:
    0    1
0  67  149
1   7  252
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-07-13 21:50:19.874090,epoch time: 0:09:47.062489,used: 0:19:44.787412,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_21_30_35_seed_2_21955596
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9882713, 'precision': 0.9153009, 'recall': 0.96847916, 'specificity': 0.96847916, 'f1': 0.9400831, 'auroc': 0.9976162, 'binary_precision': 0.9972685, 'binary_recall': 0.99038845, 'binary_specificity': 0.9465699, 'binary_f1_score': 0.99381655}
confusion matrix:
      0      1
0  1435     81
1   287  29573
---- Validation: 
scalar performance:
{'acc': 0.8325509, 'precision': 0.8413683, 'recall': 0.8346821, 'specificity': 0.8346821, 'f1': 0.83198756, 'auroc': 0.92127883, 'binary_precision': 0.779452, 'binary_recall': 0.914791, 'binary_specificity': 0.75457317, 'binary_f1_score': 0.841716}
confusion matrix:
     0    1
0  495  161
1   53  569
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.82736844, 'precision': 0.8295205, 'recall': 0.82209885, 'specificity': 0.82209885, 'f1': 0.8242773, 'auroc': 0.9232983, 'binary_precision': 0.8172043, 'binary_recall': 0.88030887, 'binary_specificity': 0.7638889, 'binary_f1_score': 0.84758365}
confusion matrix:
     0    1
0  165   51
1   31  228
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-07-13 22:00:07.602774,epoch time: 0:09:47.728684,used: 0:29:32.516096,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_21_30_35_seed_2_21955596
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9904704, 'precision': 0.96549094, 'recall': 0.9283093, 'specificity': 0.9283093, 'f1': 0.94603896, 'auroc': 0.9975408, 'binary_precision': 0.9928969, 'binary_recall': 0.9971199, 'binary_specificity': 0.8594987, 'binary_f1_score': 0.99500394}
confusion matrix:
      0      1
0  1303    213
1    86  29774
---- Validation: 
scalar performance:
{'acc': 0.7707355, 'precision': 0.81315434, 'recall': 0.7755519, 'specificity': 0.7755519, 'f1': 0.7646806, 'auroc': 0.9230207, 'binary_precision': 0.6910569, 'binary_recall': 0.95659167, 'binary_specificity': 0.5945122, 'binary_f1_score': 0.8024275}
confusion matrix:
     0    1
0  390  266
1   27  595
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7726316, 'precision': 0.7996732, 'recall': 0.7573019, 'specificity': 0.7573019, 'f1': 0.75899196, 'auroc': 0.9187223, 'binary_precision': 0.7294833, 'binary_recall': 0.9266409, 'binary_specificity': 0.587963, 'binary_f1_score': 0.8163265}
confusion matrix:
     0    1
0  127   89
1   19  240
early stop counter: 1
val acc:0.770735502243042, best validation acc: 0.8325508832931519, corresponding to test acc:                         0.827368438243866 / 0.827368438243866
after epoch: 4,now: 2024-07-13 22:09:54.451520,epoch time: 0:09:46.848746,used: 0:39:19.364842,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_21_30_35_seed_2_21955596
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9915222, 'precision': 0.96530414, 'recall': 0.9407586, 'specificity': 0.9407586, 'f1': 0.95266074, 'auroc': 0.99813485, 'binary_precision': 0.99415576, 'binary_recall': 0.9969525, 'binary_specificity': 0.88456464, 'binary_f1_score': 0.9955522}
confusion matrix:
      0      1
0  1341    175
1    91  29769
---- Validation: 
scalar performance:
{'acc': 0.7636933, 'precision': 0.8024032, 'recall': 0.7683588, 'specificity': 0.7683588, 'f1': 0.75788164, 'auroc': 0.90468943, 'binary_precision': 0.6873536, 'binary_recall': 0.9437299, 'binary_specificity': 0.5929878, 'binary_f1_score': 0.79539293}
confusion matrix:
     0    1
0  389  267
1   35  587
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7768421, 'precision': 0.7947131, 'recall': 0.7638532, 'specificity': 0.7638532, 'f1': 0.7662749, 'auroc': 0.8969505, 'binary_precision': 0.7413249, 'binary_recall': 0.90733594, 'binary_specificity': 0.6203704, 'binary_f1_score': 0.8159722}
confusion matrix:
     0    1
0  134   82
1   24  235
early stop counter: 2
val acc:0.7636932730674744, best validation acc: 0.8325508832931519, corresponding to test acc:                         0.827368438243866 / 0.827368438243866
after epoch: 5,now: 2024-07-13 22:19:41.125313,epoch time: 0:09:46.673793,used: 0:49:06.038635,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_21_30_35_seed_2_21955596
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9863909, 'precision': 0.89559776, 'recall': 0.9800141, 'specificity': 0.9800141, 'f1': 0.93318236, 'auroc': 0.9982045, 'binary_precision': 0.99861085, 'binary_recall': 0.987073, 'binary_specificity': 0.97295517, 'binary_f1_score': 0.99280834}
confusion matrix:
      0      1
0  1475     41
1   386  29474
---- Validation: 
scalar performance:
{'acc': 0.86619717, 'precision': 0.8679466, 'recall': 0.86716485, 'specificity': 0.86716485, 'f1': 0.8661735, 'auroc': 0.9276993, 'binary_precision': 0.83506685, 'binary_recall': 0.903537, 'binary_specificity': 0.83079267, 'binary_f1_score': 0.86795366}
confusion matrix:
     0    1
0  545  111
1   60  562
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.84, 'precision': 0.8384877, 'recall': 0.8398309, 'specificity': 0.8398309, 'f1': 0.83902323, 'auroc': 0.9137888, 'binary_precision': 0.86166006, 'binary_recall': 0.8416988, 'binary_specificity': 0.837963, 'binary_f1_score': 0.8515625}
confusion matrix:
     0    1
0  181   35
1   41  218
new oracle model saved
better model found
persisted
after epoch: 6,now: 2024-07-13 22:29:28.906692,epoch time: 0:09:47.781379,used: 0:58:53.820014,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_21_30_35_seed_2_21955596
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9925421, 'precision': 0.9451694, 'recall': 0.97792363, 'specificity': 0.97792363, 'f1': 0.9608941, 'auroc': 0.99895716, 'binary_precision': 0.9980499, 'binary_recall': 0.9941058, 'binary_specificity': 0.96174145, 'binary_f1_score': 0.99607396}
confusion matrix:
      0      1
0  1458     58
1   176  29684
---- Validation: 
scalar performance:
{'acc': 0.8748044, 'precision': 0.87478447, 'recall': 0.875049, 'specificity': 0.875049, 'f1': 0.8747796, 'auroc': 0.933743, 'binary_precision': 0.86206895, 'binary_recall': 0.8842444, 'binary_specificity': 0.86585367, 'binary_f1_score': 0.8730159}
confusion matrix:
     0    1
0  568   88
1   72  550
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.85263157, 'precision': 0.85470587, 'recall': 0.85717857, 'specificity': 0.85717857, 'f1': 0.8525211, 'auroc': 0.9281961, 'binary_precision': 0.91266376, 'binary_recall': 0.8069498, 'binary_specificity': 0.9074074, 'binary_f1_score': 0.8565574}
confusion matrix:
     0    1
0  196   20
1   50  209
new oracle model saved
better model found
persisted
after epoch: 7,now: 2024-07-13 22:39:06.426450,epoch time: 0:09:37.519758,used: 1:08:31.339772,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_21_30_35_seed_2_21955596
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9936894, 'precision': 0.9698292, 'recall': 0.9609945, 'specificity': 0.9609945, 'f1': 0.9653651, 'auroc': 0.9988603, 'binary_precision': 0.996186, 'binary_recall': 0.9971869, 'binary_specificity': 0.9248021, 'binary_f1_score': 0.9966862}
confusion matrix:
      0      1
0  1402    114
1    84  29776
---- Validation: 
scalar performance:
{'acc': 0.85837245, 'precision': 0.8616274, 'recall': 0.8596679, 'specificity': 0.8596679, 'f1': 0.8582779, 'auroc': 0.92801297, 'binary_precision': 0.820029, 'binary_recall': 0.9083601, 'binary_specificity': 0.8109756, 'binary_f1_score': 0.86193746}
confusion matrix:
     0    1
0  532  124
1   57  565
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.83157897, 'precision': 0.8300725, 'recall': 0.8317246, 'specificity': 0.8317246, 'f1': 0.8306595, 'auroc': 0.91019595, 'binary_precision': 0.8565737, 'binary_recall': 0.83011585, 'binary_specificity': 0.8333333, 'binary_f1_score': 0.8431372}
confusion matrix:
     0    1
0  180   36
1   44  215
early stop counter: 1
val acc:0.8583724498748779, best validation acc: 0.8748043775558472, corresponding to test acc:                         0.8526315689086914 / 0.8526315689086914
after epoch: 8,now: 2024-07-13 22:48:40.596628,epoch time: 0:09:34.170178,used: 1:18:05.509950,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_21_30_35_seed_2_21955596
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9786461, 'precision': 0.8488171, 'recall': 0.98001504, 'specificity': 0.98001504, 'f1': 0.9024507, 'auroc': 0.9984603, 'binary_precision': 0.99904263, 'binary_recall': 0.97849965, 'binary_specificity': 0.98153037, 'binary_f1_score': 0.98866445}
confusion matrix:
      0      1
0  1488     28
1   642  29218
---- Validation: 
scalar performance:
{'acc': 0.8513302, 'precision': 0.8621895, 'recall': 0.8490168, 'specificity': 0.8490168, 'f1': 0.84952444, 'auroc': 0.93313026, 'binary_precision': 0.9186047, 'binary_recall': 0.7620579, 'binary_specificity': 0.9359756, 'binary_f1_score': 0.8330404}
confusion matrix:
     0    1
0  614   42
1  148  474
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8294737, 'precision': 0.8578272, 'recall': 0.84247637, 'specificity': 0.84247637, 'f1': 0.8286962, 'auroc': 0.91530824, 'binary_precision': 0.9836956, 'binary_recall': 0.6988417, 'binary_specificity': 0.9861111, 'binary_f1_score': 0.8171557}
confusion matrix:
     0    1
0  213    3
1   78  181
early stop counter: 2
val acc:0.8513302206993103, best validation acc: 0.8748043775558472, corresponding to test acc:                         0.8526315689086914 / 0.8526315689086914
after epoch: 9,now: 2024-07-13 22:58:16.046879,epoch time: 0:09:35.450251,used: 1:27:40.960201,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_21_30_35_seed_2_21955596
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9929564, 'precision': 0.94828963, 'recall': 0.97876745, 'specificity': 0.97876745, 'f1': 0.96296644, 'auroc': 0.998727, 'binary_precision': 0.9981177, 'binary_recall': 0.99447423, 'binary_specificity': 0.9630607, 'binary_f1_score': 0.9962927}
confusion matrix:
      0      1
0  1460     56
1   165  29695
---- Validation: 
scalar performance:
{'acc': 0.8849765, 'precision': 0.88488555, 'recall': 0.8851242, 'specificity': 0.8851242, 'f1': 0.8849392, 'auroc': 0.93771565, 'binary_precision': 0.87519747, 'binary_recall': 0.89067525, 'binary_specificity': 0.87957317, 'binary_f1_score': 0.88286847}
confusion matrix:
     0    1
0  577   79
1   68  554
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.86526316, 'precision': 0.86677665, 'recall': 0.86953026, 'specificity': 0.86953026, 'f1': 0.86512864, 'auroc': 0.9320705, 'binary_precision': 0.9220779, 'binary_recall': 0.82239383, 'binary_specificity': 0.9166667, 'binary_f1_score': 0.8693877}
confusion matrix:
     0    1
0  198   18
1   46  213
new oracle model saved
better model found
persisted
after epoch: 10,now: 2024-07-13 23:07:50.727339,epoch time: 0:09:34.680460,used: 1:37:15.640661,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_21_30_35_seed_2_21955596
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9930839, 'precision': 0.9777796, 'recall': 0.94564897, 'specificity': 0.94564897, 'f1': 0.9610925, 'auroc': 0.9989242, 'binary_precision': 0.99459404, 'binary_recall': 0.9981581, 'binary_specificity': 0.89313984, 'binary_f1_score': 0.9963729}
confusion matrix:
      0      1
0  1354    162
1    55  29805
---- Validation: 
scalar performance:
{'acc': 0.8763693, 'precision': 0.8765412, 'recall': 0.87603176, 'specificity': 0.87603176, 'f1': 0.87620896, 'auroc': 0.93525755, 'binary_precision': 0.8803279, 'binary_recall': 0.8633441, 'binary_specificity': 0.8887195, 'binary_f1_score': 0.8717533}
confusion matrix:
     0    1
0  583   73
1   85  537
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.86105263, 'precision': 0.8644445, 'recall': 0.86643785, 'specificity': 0.86643785, 'f1': 0.86100274, 'auroc': 0.92463887, 'binary_precision': 0.9288889, 'binary_recall': 0.8069498, 'binary_specificity': 0.9259259, 'binary_f1_score': 0.86363643}
confusion matrix:
     0    1
0  200   16
1   50  209
early stop counter: 1
val acc:0.876369297504425, best validation acc: 0.8849765062332153, corresponding to test acc:                         0.8652631640434265 / 0.8652631640434265
after epoch: 11,now: 2024-07-13 23:17:23.418955,epoch time: 0:09:32.691616,used: 1:46:48.332277,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_21_30_35_seed_2_21955596
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9906298, 'precision': 0.9244314, 'recall': 0.9850588, 'specificity': 0.9850588, 'f1': 0.9524647, 'auroc': 0.99921954, 'binary_precision': 0.99892, 'binary_recall': 0.9912257, 'binary_specificity': 0.97889185, 'binary_f1_score': 0.995058}
confusion matrix:
      0      1
0  1484     32
1   262  29598
---- Validation: 
scalar performance:
{'acc': 0.85524255, 'precision': 0.8552441, 'recall': 0.8549942, 'specificity': 0.8549942, 'f1': 0.8550935, 'auroc': 0.9265964, 'binary_precision': 0.8552846, 'binary_recall': 0.84565914, 'binary_specificity': 0.8643293, 'binary_f1_score': 0.8504447}
confusion matrix:
     0    1
0  567   89
1   96  526
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.80421054, 'precision': 0.8136568, 'recall': 0.8120084, 'specificity': 0.8120084, 'f1': 0.80417925, 'auroc': 0.8876734, 'binary_precision': 0.8952381, 'binary_recall': 0.7258687, 'binary_specificity': 0.8981481, 'binary_f1_score': 0.8017057}
confusion matrix:
     0    1
0  194   22
1   71  188
early stop counter: 2
val acc:0.8552425503730774, best validation acc: 0.8849765062332153, corresponding to test acc:                         0.8652631640434265 / 0.8652631640434265
after epoch: 12,now: 2024-07-13 23:27:54.489208,epoch time: 0:10:31.070253,used: 1:57:19.402530,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_21_30_35_seed_2_21955596
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.995028, 'precision': 0.97695553, 'recall': 0.9685854, 'specificity': 0.9685854, 'f1': 0.9727292, 'auroc': 0.99927187, 'binary_precision': 0.99692184, 'binary_recall': 0.9978567, 'binary_specificity': 0.939314, 'binary_f1_score': 0.9973891}
confusion matrix:
      0      1
0  1424     92
1    64  29796
---- Validation: 
scalar performance:
{'acc': 0.8904538, 'precision': 0.890355, 'recall': 0.8905846, 'specificity': 0.8905846, 'f1': 0.89041513, 'auroc': 0.94033, 'binary_precision': 0.8813291, 'binary_recall': 0.8954984, 'binary_specificity': 0.8856707, 'binary_f1_score': 0.8883572}
confusion matrix:
     0    1
0  581   75
1   65  557
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.84842104, 'precision': 0.8524984, 'recall': 0.8540863, 'specificity': 0.8540863, 'f1': 0.8483882, 'auroc': 0.91024953, 'binary_precision': 0.9192825, 'binary_recall': 0.7915058, 'binary_specificity': 0.9166667, 'binary_f1_score': 0.8506225}
confusion matrix:
     0    1
0  198   18
1   54  205
better model found
persisted
after epoch: 13,now: 2024-07-13 23:37:55.669189,epoch time: 0:10:01.179981,used: 2:07:20.582511,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_21_30_35_seed_2_21955596
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.995028, 'precision': 0.98232174, 'recall': 0.96295005, 'specificity': 0.96295005, 'f1': 0.972415, 'auroc': 0.99933636, 'binary_precision': 0.996324, 'binary_recall': 0.99845946, 'binary_specificity': 0.92744064, 'binary_f1_score': 0.9973906}
confusion matrix:
      0      1
0  1406    110
1    46  29814
---- Validation: 
scalar performance:
{'acc': 0.86071986, 'precision': 0.86345917, 'recall': 0.8619128, 'specificity': 0.8619128, 'f1': 0.860653, 'auroc': 0.93111634, 'binary_precision': 0.8245614, 'binary_recall': 0.9067524, 'binary_specificity': 0.81707317, 'binary_f1_score': 0.86370593}
confusion matrix:
     0    1
0  536  120
1   58  564
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.83157897, 'precision': 0.8303344, 'recall': 0.829803, 'specificity': 0.829803, 'f1': 0.8300537, 'auroc': 0.90497637, 'binary_precision': 0.8429119, 'binary_recall': 0.84942085, 'binary_specificity': 0.8101852, 'binary_f1_score': 0.8461539}
confusion matrix:
     0    1
0  175   41
1   39  220
early stop counter: 1
val acc:0.8607198596000671, best validation acc: 0.8904538154602051, corresponding to test acc:                         0.848421037197113 / 0.8652631640434265
after epoch: 14,now: 2024-07-13 23:47:25.575360,epoch time: 0:09:29.906171,used: 2:16:50.488682,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_21_30_35_seed_2_21955596
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9897374, 'precision': 0.9922755, 'recall': 0.8956779, 'specificity': 0.8956779, 'f1': 0.9381704, 'auroc': 0.99920505, 'binary_precision': 0.98952603, 'binary_recall': 0.9997991, 'binary_specificity': 0.7915567, 'binary_f1_score': 0.99463606}
confusion matrix:
      0      1
0  1200    316
1     6  29854
---- Validation: 
scalar performance:
{'acc': 0.69170576, 'precision': 0.79420507, 'recall': 0.69940346, 'specificity': 0.69940346, 'f1': 0.6673212, 'auroc': 0.9419948, 'binary_precision': 0.61377245, 'binary_recall': 0.988746, 'binary_specificity': 0.41006097, 'binary_f1_score': 0.7573892}
confusion matrix:
     0    1
0  269  387
1    7  615
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6442105, 'precision': 0.7599681, 'recall': 0.6107179, 'specificity': 0.6107179, 'f1': 0.56566083, 'auroc': 0.9342021, 'binary_precision': 0.6076555, 'binary_recall': 0.980695, 'binary_specificity': 0.24074075, 'binary_f1_score': 0.7503693}
confusion matrix:
    0    1
0  52  164
1   5  254
early stop counter: 2
val acc:0.6917057633399963, best validation acc: 0.8904538154602051, corresponding to test acc:                         0.848421037197113 / 0.8652631640434265
after epoch: 15,now: 2024-07-13 23:56:55.489598,epoch time: 0:09:29.914238,used: 2:26:20.402920,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_21_30_35_seed_2_21955596
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9953786, 'precision': 0.9796307, 'recall': 0.96970874, 'specificity': 0.96970874, 'f1': 0.974612, 'auroc': 0.99927187, 'binary_precision': 0.9970227, 'binary_recall': 0.9981246, 'binary_specificity': 0.9412929, 'binary_f1_score': 0.9975734}
confusion matrix:
      0      1
0  1427     89
1    56  29804
---- Validation: 
scalar performance:
{'acc': 0.87558687, 'precision': 0.8777137, 'recall': 0.8766445, 'specificity': 0.8766445, 'f1': 0.87555325, 'auroc': 0.94287956, 'binary_precision': 0.84194976, 'binary_recall': 0.9163987, 'binary_specificity': 0.8368902, 'binary_f1_score': 0.87759817}
confusion matrix:
     0    1
0  549  107
1   52  570
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8736842, 'precision': 0.8730982, 'recall': 0.87609935, 'specificity': 0.87609935, 'f1': 0.87333333, 'auroc': 0.93566775, 'binary_precision': 0.9128631, 'binary_recall': 0.84942085, 'binary_specificity': 0.9027778, 'binary_f1_score': 0.88}
confusion matrix:
     0    1
0  195   21
1   39  220
new oracle model saved
early stop counter: 3
val acc:0.8755868673324585, best validation acc: 0.8904538154602051, corresponding to test acc:                         0.848421037197113 / 0.8736842274665833
after epoch: 16,now: 2024-07-14 00:06:30.978306,epoch time: 0:09:35.488708,used: 2:35:55.891628,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_21_30_35_seed_2_21955596
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9935301, 'precision': 0.9550001, 'recall': 0.97687733, 'specificity': 0.97687733, 'f1': 0.96565104, 'auroc': 0.9991017, 'binary_precision': 0.9978847, 'binary_recall': 0.99531144, 'binary_specificity': 0.9584433, 'binary_f1_score': 0.9965964}
confusion matrix:
      0      1
0  1453     63
1   140  29720
---- Validation: 
scalar performance:
{'acc': 0.814554, 'precision': 0.8391478, 'recall': 0.81810987, 'specificity': 0.81810987, 'f1': 0.8122028, 'auroc': 0.93009126, 'binary_precision': 0.74092615, 'binary_recall': 0.9517685, 'binary_specificity': 0.6844512, 'binary_f1_score': 0.8332161}
confusion matrix:
     0    1
0  449  207
1   30  592
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8084211, 'precision': 0.8092091, 'recall': 0.80357146, 'specificity': 0.80357146, 'f1': 0.8053147, 'auroc': 0.9074253, 'binary_precision': 0.8043478, 'binary_recall': 0.85714287, 'binary_specificity': 0.75, 'binary_f1_score': 0.8299065}
confusion matrix:
     0    1
0  162   54
1   37  222
early stop counter: 4
val acc:0.81455397605896, best validation acc: 0.8904538154602051, corresponding to test acc:                         0.848421037197113 / 0.8736842274665833
after epoch: 17,now: 2024-07-14 00:17:17.190038,epoch time: 0:10:46.211732,used: 2:46:42.103360,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_21_30_35_seed_2_21955596
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9917453, 'precision': 0.9890338, 'recall': 0.9202131, 'specificity': 0.9202131, 'f1': 0.9517378, 'auroc': 0.9992919, 'binary_precision': 0.99198884, 'binary_recall': 0.99939716, 'binary_specificity': 0.84102905, 'binary_f1_score': 0.99567926}
confusion matrix:
      0      1
0  1275    241
1    18  29842
---- Validation: 
scalar performance:
{'acc': 0.8309859, 'precision': 0.8521364, 'recall': 0.8342409, 'specificity': 0.8342409, 'f1': 0.8292733, 'auroc': 0.9365491, 'binary_precision': 0.7589286, 'binary_recall': 0.95659167, 'binary_specificity': 0.7118902, 'binary_f1_score': 0.84637266}
confusion matrix:
     0    1
0  467  189
1   27  595
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8168421, 'precision': 0.8276191, 'recall': 0.8074503, 'specificity': 0.8074503, 'f1': 0.81092924, 'auroc': 0.92002714, 'binary_precision': 0.7866667, 'binary_recall': 0.9111969, 'binary_specificity': 0.7037037, 'binary_f1_score': 0.84436494}
confusion matrix:
     0    1
0  152   64
1   23  236
early stop counter: 5
val acc:0.8309859037399292, best validation acc: 0.8904538154602051, corresponding to test acc:                         0.848421037197113 / 0.8736842274665833
after epoch: 18,now: 2024-07-14 00:27:03.587265,epoch time: 0:09:46.397227,used: 2:56:28.500587,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_21_30_35_seed_2_21955596
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.989578, 'precision': 0.99257976, 'recall': 0.89371574, 'specificity': 0.89371574, 'f1': 0.9370557, 'auroc': 0.9994494, 'binary_precision': 0.98932964, 'binary_recall': 0.9998326, 'binary_specificity': 0.78759897, 'binary_f1_score': 0.9945534}
confusion matrix:
      0      1
0  1194    322
1     5  29855
---- Validation: 
scalar performance:
{'acc': 0.75899845, 'precision': 0.8163638, 'recall': 0.76457727, 'specificity': 0.76457727, 'f1': 0.7500355, 'auroc': 0.92852277, 'binary_precision': 0.67483294, 'binary_recall': 0.97427654, 'binary_specificity': 0.55487806, 'binary_f1_score': 0.7973684}
confusion matrix:
     0    1
0  364  292
1   16  606
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7473684, 'precision': 0.7978873, 'recall': 0.72683394, 'specificity': 0.72683394, 'f1': 0.7237087, 'auroc': 0.8497247, 'binary_precision': 0.6957747, 'binary_recall': 0.95366794, 'binary_specificity': 0.5, 'binary_f1_score': 0.80456024}
confusion matrix:
     0    1
0  108  108
1   12  247
early stop counter: 6
val acc:0.758998453617096, best validation acc: 0.8904538154602051, corresponding to test acc:                         0.848421037197113 / 0.8736842274665833
after epoch: 19,now: 2024-07-14 00:36:37.429557,epoch time: 0:09:33.842292,used: 3:06:02.342879,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_21_30_35_seed_2_21955596
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9959204, 'precision': 0.9839926, 'recall': 0.97124565, 'specificity': 0.97124565, 'f1': 0.9775244, 'auroc': 0.9995263, 'binary_precision': 0.9971574, 'binary_recall': 0.99855995, 'binary_specificity': 0.9439314, 'binary_f1_score': 0.9978582}
confusion matrix:
      0      1
0  1431     85
1    43  29817
---- Validation: 
scalar performance:
{'acc': 0.87089205, 'precision': 0.8720492, 'recall': 0.87169635, 'specificity': 0.87169635, 'f1': 0.8708856, 'auroc': 0.938995, 'binary_precision': 0.84360904, 'binary_recall': 0.90192926, 'binary_specificity': 0.8414634, 'binary_f1_score': 0.8717949}
confusion matrix:
     0    1
0  552  104
1   61  561
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.83789474, 'precision': 0.84088564, 'recall': 0.84289646, 'specificity': 0.84289646, 'f1': 0.8378228, 'auroc': 0.9060668, 'binary_precision': 0.9026549, 'binary_recall': 0.7876448, 'binary_specificity': 0.8981481, 'binary_f1_score': 0.84123707}
confusion matrix:
     0    1
0  194   22
1   55  204
early stop counter: 7
val acc:0.8708920478820801, best validation acc: 0.8904538154602051, corresponding to test acc:                         0.848421037197113 / 0.8736842274665833
after epoch: 20,now: 2024-07-14 00:46:10.708367,epoch time: 0:09:33.278810,used: 3:15:35.621689,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_21_30_35_seed_2_21955596
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9957611, 'precision': 0.97346234, 'recall': 0.98086715, 'specificity': 0.98086715, 'f1': 0.9771326, 'auroc': 0.9993305, 'binary_precision': 0.99819005, 'binary_recall': 0.9973543, 'binary_specificity': 0.96437997, 'binary_f1_score': 0.997772}
confusion matrix:
      0      1
0  1462     54
1    79  29781
---- Validation: 
scalar performance:
{'acc': 0.85758996, 'precision': 0.8710985, 'recall': 0.8601556, 'specificity': 0.8601556, 'f1': 0.85681534, 'auroc': 0.9508127, 'binary_precision': 0.79333335, 'binary_recall': 0.95659167, 'binary_specificity': 0.7637195, 'binary_f1_score': 0.86734694}
confusion matrix:
     0    1
0  501  155
1   27  595
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8673684, 'precision': 0.86688566, 'recall': 0.86531174, 'specificity': 0.86531174, 'f1': 0.86600006, 'auroc': 0.9295546, 'binary_precision': 0.8712121, 'binary_recall': 0.8880309, 'binary_specificity': 0.8425926, 'binary_f1_score': 0.8795411}
confusion matrix:
     0    1
0  182   34
1   29  230
early stop counter: 8
val acc:0.8575899600982666, best validation acc: 0.8904538154602051, corresponding to test acc:                         0.848421037197113 / 0.8736842274665833
after epoch: 21,now: 2024-07-14 00:56:24.819761,epoch time: 0:10:14.111394,used: 3:25:49.733083,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_21_30_35_seed_2_21955596
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9942631, 'precision': 0.9601686, 'recall': 0.9791409, 'specificity': 0.9791409, 'f1': 0.9694403, 'auroc': 0.9993793, 'binary_precision': 0.99808687, 'binary_recall': 0.9958808, 'binary_specificity': 0.96240103, 'binary_f1_score': 0.9969826}
confusion matrix:
      0      1
0  1459     57
1   123  29737
---- Validation: 
scalar performance:
{'acc': 0.85837245, 'precision': 0.8585952, 'recall': 0.8587929, 'specificity': 0.8587929, 'f1': 0.8583654, 'auroc': 0.9276283, 'binary_precision': 0.8408037, 'binary_recall': 0.8745981, 'binary_specificity': 0.8429878, 'binary_f1_score': 0.857368}
confusion matrix:
     0    1
0  553  103
1   78  544
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8294737, 'precision': 0.8306992, 'recall': 0.8332529, 'specificity': 0.8332529, 'f1': 0.82927996, 'auroc': 0.8919455, 'binary_precision': 0.8836207, 'binary_recall': 0.7915058, 'binary_specificity': 0.875, 'binary_f1_score': 0.8350305}
confusion matrix:
     0    1
0  189   27
1   54  205
early stop counter: 9
val acc:0.8583724498748779, best validation acc: 0.8904538154602051, corresponding to test acc:                         0.848421037197113 / 0.8736842274665833
after epoch: 22,now: 2024-07-14 01:06:14.626695,epoch time: 0:09:49.806934,used: 3:35:39.540017,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_21_30_35_seed_2_21955596
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.9957292, 'precision': 0.97735006, 'recall': 0.9761543, 'specificity': 0.9761543, 'f1': 0.9767513, 'auroc': 0.9994279, 'binary_precision': 0.99768955, 'binary_recall': 0.9978232, 'binary_specificity': 0.9544855, 'binary_f1_score': 0.99775636}
confusion matrix:
      0      1
0  1447     69
1    65  29795
---- Validation: 
scalar performance:
{'acc': 0.8364632, 'precision': 0.85330427, 'recall': 0.839368, 'specificity': 0.839368, 'f1': 0.83522016, 'auroc': 0.9358752, 'binary_precision': 0.7692308, 'binary_recall': 0.948553, 'binary_specificity': 0.73018295, 'binary_f1_score': 0.849532}
confusion matrix:
     0    1
0  479  177
1   32  590
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8210526, 'precision': 0.8196764, 'recall': 0.82168776, 'specificity': 0.82168776, 'f1': 0.8202368, 'auroc': 0.89008653, 'binary_precision': 0.8508065, 'binary_recall': 0.8146718, 'binary_specificity': 0.8287037, 'binary_f1_score': 0.83234715}
confusion matrix:
     0    1
0  179   37
1   48  211
early stop counter: 10
val acc:0.836463212966919, best validation acc: 0.8904538154602051, corresponding to test acc:                         0.848421037197113 / 0.8736842274665833
after epoch: 23,now: 2024-07-14 01:15:50.275226,epoch time: 0:09:35.648531,used: 3:45:15.188548,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_21_30_35_seed_2_21955596
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9953149, 'precision': 0.9819628, 'recall': 0.9665445, 'specificity': 0.9665445, 'f1': 0.9741142, 'auroc': 0.9995671, 'binary_precision': 0.99669015, 'binary_recall': 0.9983925, 'binary_specificity': 0.93469656, 'binary_f1_score': 0.99754065}
confusion matrix:
      0      1
0  1417     99
1    48  29812
---- Validation: 
scalar performance:
{'acc': 0.86697966, 'precision': 0.8693537, 'recall': 0.86809367, 'specificity': 0.86809367, 'f1': 0.8669327, 'auroc': 0.93872535, 'binary_precision': 0.83235294, 'binary_recall': 0.90996784, 'binary_specificity': 0.8262195, 'binary_f1_score': 0.8694316}
confusion matrix:
     0    1
0  542  114
1   56  566
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.83157897, 'precision': 0.83255595, 'recall': 0.8351834, 'specificity': 0.8351834, 'f1': 0.83136296, 'auroc': 0.89816606, 'binary_precision': 0.88412017, 'binary_recall': 0.7953668, 'binary_specificity': 0.875, 'binary_f1_score': 0.8373984}
confusion matrix:
     0    1
0  189   27
1   53  206
early stop counter: 11
val acc:0.8669796586036682, best validation acc: 0.8904538154602051, corresponding to test acc:                         0.848421037197113 / 0.8736842274665833
after epoch: 24,now: 2024-07-14 01:25:24.760523,epoch time: 0:09:34.485297,used: 3:54:49.673845,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_21_30_35_seed_2_21955596
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.9912991, 'precision': 0.99055994, 'recall': 0.9140303, 'specificity': 0.9140303, 'f1': 0.94871116, 'auroc': 0.9996216, 'binary_precision': 0.9913641, 'binary_recall': 0.99956465, 'binary_specificity': 0.82849604, 'binary_f1_score': 0.9954475}
confusion matrix:
      0      1
0  1256    260
1    13  29847
---- Validation: 
scalar performance:
{'acc': 0.814554, 'precision': 0.84644735, 'recall': 0.81856817, 'specificity': 0.81856817, 'f1': 0.8114104, 'auroc': 0.95016384, 'binary_precision': 0.7344701, 'binary_recall': 0.9694534, 'binary_specificity': 0.66768295, 'binary_f1_score': 0.83575886}
confusion matrix:
     0    1
0  438  218
1   19  603
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7978947, 'precision': 0.82732046, 'recall': 0.7831582, 'specificity': 0.7831582, 'f1': 0.7862206, 'auroc': 0.9279994, 'binary_precision': 0.74923545, 'binary_recall': 0.9459459, 'binary_specificity': 0.6203704, 'binary_f1_score': 0.83617747}
confusion matrix:
     0    1
0  134   82
1   14  245
early stop counter: 12
val acc:0.81455397605896, best validation acc: 0.8904538154602051, corresponding to test acc:                         0.848421037197113 / 0.8736842274665833
after epoch: 25,now: 2024-07-14 01:35:00.195827,epoch time: 0:09:35.435304,used: 4:04:25.109149,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_21_30_35_seed_2_21955596
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9966216, 'precision': 0.97301483, 'recall': 0.99133754, 'specificity': 0.99133754, 'f1': 0.98198164, 'auroc': 0.9997771, 'binary_precision': 0.9992617, 'binary_recall': 0.9971869, 'binary_specificity': 0.9854881, 'binary_f1_score': 0.99822325}
confusion matrix:
      0      1
0  1494     22
1    84  29776
---- Validation: 
scalar performance:
{'acc': 0.8826291, 'precision': 0.8846891, 'recall': 0.8836709, 'specificity': 0.8836709, 'f1': 0.8826004, 'auroc': 0.94442844, 'binary_precision': 0.84911245, 'binary_recall': 0.92282957, 'binary_specificity': 0.8445122, 'binary_f1_score': 0.8844376}
confusion matrix:
     0    1
0  554  102
1   48  574
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.83789474, 'precision': 0.83680964, 'recall': 0.83597887, 'specificity': 0.83597887, 'f1': 0.8363601, 'auroc': 0.90270627, 'binary_precision': 0.84732825, 'binary_recall': 0.85714287, 'binary_specificity': 0.8148148, 'binary_f1_score': 0.8522073}
confusion matrix:
     0    1
0  176   40
1   37  222
early stop counter: 13
val acc:0.8826290965080261, best validation acc: 0.8904538154602051, corresponding to test acc:                         0.848421037197113 / 0.8736842274665833
after epoch: 26,now: 2024-07-14 01:44:36.083192,epoch time: 0:09:35.887365,used: 4:14:00.996514,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_21_30_35_seed_2_21955596
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.9954742, 'precision': 0.9800137, 'recall': 0.9703851, 'specificity': 0.9703851, 'f1': 0.9751451, 'auroc': 0.9993041, 'binary_precision': 0.9970895, 'binary_recall': 0.9981581, 'binary_specificity': 0.9426121, 'binary_f1_score': 0.9976235}
confusion matrix:
      0      1
0  1429     87
1    55  29805
---- Validation: 
scalar performance:
{'acc': 0.8779343, 'precision': 0.8829683, 'recall': 0.87951434, 'specificity': 0.87951434, 'f1': 0.8777759, 'auroc': 0.94616115, 'binary_precision': 0.8319088, 'binary_recall': 0.9389067, 'binary_specificity': 0.82012194, 'binary_f1_score': 0.88217515}
confusion matrix:
     0    1
0  538  118
1   38  584
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.84210527, 'precision': 0.84193164, 'recall': 0.8390712, 'specificity': 0.8390712, 'f1': 0.84019005, 'auroc': 0.9352746, 'binary_precision': 0.8432836, 'binary_recall': 0.87258685, 'binary_specificity': 0.8055556, 'binary_f1_score': 0.857685}
confusion matrix:
     0    1
0  174   42
1   33  226
early stop counter: 14
val acc:0.8779342770576477, best validation acc: 0.8904538154602051, corresponding to test acc:                         0.848421037197113 / 0.8736842274665833
after epoch: 27,now: 2024-07-14 01:54:11.141972,epoch time: 0:09:35.058780,used: 4:23:36.055294,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_21_30_35_seed_2_21955596
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.9956655, 'precision': 0.9706496, 'recall': 0.9830084, 'specificity': 0.9830084, 'f1': 0.9767395, 'auroc': 0.9995978, 'binary_precision': 0.99842376, 'binary_recall': 0.9970194, 'binary_specificity': 0.96899736, 'binary_f1_score': 0.99772114}
confusion matrix:
      0      1
0  1469     47
1    89  29771
---- Validation: 
scalar performance:
{'acc': 0.9084507, 'precision': 0.9086524, 'recall': 0.90815675, 'specificity': 0.90815675, 'f1': 0.90833706, 'auroc': 0.9517416, 'binary_precision': 0.91325694, 'binary_recall': 0.8971061, 'binary_specificity': 0.91920733, 'binary_f1_score': 0.90510947}
confusion matrix:
     0    1
0  603   53
1   64  558
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.86526316, 'precision': 0.87019455, 'recall': 0.8714518, 'specificity': 0.8714518, 'f1': 0.8652482, 'auroc': 0.93438077, 'binary_precision': 0.9411765, 'binary_recall': 0.8030888, 'binary_specificity': 0.9398148, 'binary_f1_score': 0.8666667}
confusion matrix:
     0    1
0  203   13
1   51  208
better model found
persisted
after epoch: 28,now: 2024-07-14 02:03:46.293392,epoch time: 0:09:35.151420,used: 4:33:11.206714,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_21_30_35_seed_2_21955596
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9912672, 'precision': 0.92653537, 'recall': 0.9900897, 'specificity': 0.9900897, 'f1': 0.9558263, 'auroc': 0.999527, 'binary_precision': 0.99942607, 'binary_recall': 0.99139315, 'binary_specificity': 0.9887863, 'binary_f1_score': 0.9953934}
confusion matrix:
      0      1
0  1499     17
1   257  29603
---- Validation: 
scalar performance:
{'acc': 0.8881064, 'precision': 0.8882049, 'recall': 0.8884646, 'specificity': 0.8884646, 'f1': 0.8880948, 'auroc': 0.9426736, 'binary_precision': 0.87247276, 'binary_recall': 0.90192926, 'binary_specificity': 0.875, 'binary_f1_score': 0.88695645}
confusion matrix:
     0    1
0  574   82
1   61  561
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8084211, 'precision': 0.81693447, 'recall': 0.81586945, 'specificity': 0.81586945, 'f1': 0.8084074, 'auroc': 0.89552057, 'binary_precision': 0.8962264, 'binary_recall': 0.7335907, 'binary_specificity': 0.8981481, 'binary_f1_score': 0.80679405}
confusion matrix:
     0    1
0  194   22
1   69  190
early stop counter: 1
val acc:0.8881064057350159, best validation acc: 0.908450722694397, corresponding to test acc:                         0.8652631640434265 / 0.8736842274665833
after epoch: 29,now: 2024-07-14 02:13:20.976754,epoch time: 0:09:34.683362,used: 4:42:45.890076,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_21_30_35_seed_2_21955596
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.9962392, 'precision': 0.9810004, 'recall': 0.9779876, 'specificity': 0.9779876, 'f1': 0.97948873, 'auroc': 0.9996892, 'binary_precision': 0.9978574, 'binary_recall': 0.99819154, 'binary_specificity': 0.95778364, 'binary_f1_score': 0.99802446}
confusion matrix:
      0      1
0  1452     64
1    54  29806
---- Validation: 
scalar performance:
{'acc': 0.8873239, 'precision': 0.8872441, 'recall': 0.8872441, 'specificity': 0.8872441, 'f1': 0.8872441, 'auroc': 0.9465263, 'binary_precision': 0.8842444, 'binary_recall': 0.8842444, 'binary_specificity': 0.8902439, 'binary_f1_score': 0.8842444}
confusion matrix:
     0    1
0  584   72
1   72  550
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8463158, 'precision': 0.8586278, 'recall': 0.8552302, 'specificity': 0.8552302, 'f1': 0.8462477, 'auroc': 0.9196875, 'binary_precision': 0.9514563, 'binary_recall': 0.7567568, 'binary_specificity': 0.9537037, 'binary_f1_score': 0.8430108}
confusion matrix:
     0    1
0  206   10
1   63  196
early stop counter: 2
val acc:0.8873239159584045, best validation acc: 0.908450722694397, corresponding to test acc:                         0.8652631640434265 / 0.8736842274665833
after epoch: 30,now: 2024-07-14 02:22:54.367503,epoch time: 0:09:33.390749,used: 4:52:19.280825,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_21_30_35_seed_2_21955596
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 4:52:19.280825 at 2024-07-14 02:22:54.367503
persisted model performance metric: 

scalar performance:
{'acc': 0.86526316, 'precision': 0.87019455, 'recall': 0.8714518, 'specificity': 0.8714518, 'f1': 0.8652482, 'auroc': 0.93438077, 'binary_precision': 0.9411765, 'binary_recall': 0.8030888, 'binary_specificity': 0.9398148, 'binary_f1_score': 0.8666667}
confusion matrix:
     0    1
0  203   13
1   51  208
oracle model performance metric: 

scalar performance:
{'acc': 0.8736842, 'precision': 0.8730982, 'recall': 0.87609935, 'specificity': 0.87609935, 'f1': 0.87333333, 'auroc': 0.93566775, 'binary_precision': 0.9128631, 'binary_recall': 0.84942085, 'binary_specificity': 0.9027778, 'binary_f1_score': 0.88}
confusion matrix:
     0    1
0  195   21
1   39  220
results aggregation path: zoutput/benchmarks/CAMELYONWILD_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_halffreeze/rule_results/3.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONWILD_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_halffreeze/confusion_matrix/3.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 318241 KiB |   6782 MiB |    849 TiB |    849 TiB |
|       from large pool | 291059 KiB |   6756 MiB |    836 TiB |    836 TiB |
|       from small pool |  27182 KiB |     43 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 318241 KiB |   6782 MiB |    849 TiB |    849 TiB |
|       from large pool | 291059 KiB |   6756 MiB |    836 TiB |    836 TiB |
|       from small pool |  27182 KiB |     43 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 313851 KiB |   6778 MiB |    848 TiB |    848 TiB |
|       from large pool | 286862 KiB |   6752 MiB |    835 TiB |    835 TiB |
|       from small pool |  26989 KiB |     43 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   7450 MiB |   7456 MiB |  21176 MiB |  13726 MiB |
|       from large pool |   7398 MiB |   7404 MiB |  21092 MiB |  13694 MiB |
|       from small pool |     52 MiB |     52 MiB |     84 MiB |     32 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 259294 KiB | 680184 KiB | 681277 GiB | 681277 GiB |
|       from large pool | 249613 KiB | 675647 KiB | 667313 GiB | 667313 GiB |
|       from small pool |   9681 KiB |  30502 KiB |  13964 GiB |  13964 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    1058    |    4669    |  177608 K  |  177607 K  |
|       from large pool |     130    |     756    |   80800 K  |   80799 K  |
|       from small pool |     928    |    4537    |   96808 K  |   96807 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    1058    |    4669    |  177608 K  |  177607 K  |
|       from large pool |     130    |     756    |   80800 K  |   80799 K  |
|       from small pool |     928    |    4537    |   96808 K  |   96807 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     335    |     335    |     919    |     584    |
|       from large pool |     309    |     309    |     877    |     568    |
|       from small pool |      26    |      26    |      42    |      16    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      75    |    2006    |  102764 K  |  102764 K  |
|       from large pool |      25    |     307    |   59042 K  |   59042 K  |
|       from small pool |      50    |    1982    |   43722 K  |   43722 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   6782 MiB |    849 TiB |    849 TiB |
|       from large pool |  16640 KiB |   6756 MiB |    836 TiB |    836 TiB |
|       from small pool |      0 KiB |     43 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   6782 MiB |    849 TiB |    849 TiB |
|       from large pool |  16640 KiB |   6756 MiB |    836 TiB |    836 TiB |
|       from small pool |      0 KiB |     43 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   6778 MiB |    848 TiB |    848 TiB |
|       from large pool |  16640 KiB |   6752 MiB |    835 TiB |    835 TiB |
|       from small pool |      0 KiB |     43 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 577536 KiB |   7456 MiB |  21176 MiB |  20612 MiB |
|       from large pool | 540672 KiB |   7404 MiB |  21092 MiB |  20564 MiB |
|       from small pool |  36864 KiB |     52 MiB |     84 MiB |     48 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 680184 KiB | 681278 GiB | 681278 GiB |
|       from large pool |  24320 KiB | 675647 KiB | 667313 GiB | 667313 GiB |
|       from small pool |      0 KiB |  30502 KiB |  13964 GiB |  13964 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    4669    |  177608 K  |  177608 K  |
|       from large pool |       2    |     756    |   80800 K  |   80800 K  |
|       from small pool |       0    |    4537    |   96808 K  |   96808 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    4669    |  177608 K  |  177608 K  |
|       from large pool |       2    |     756    |   80800 K  |   80800 K  |
|       from small pool |       0    |    4537    |   96808 K  |   96808 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      42    |     335    |     919    |     877    |
|       from large pool |      24    |     309    |     877    |     853    |
|       from small pool |      18    |      26    |      42    |      24    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    2006    |  102765 K  |  102765 K  |
|       from large pool |       3    |     307    |   59042 K  |   59042 K  |
|       from small pool |       0    |    1982    |   43722 K  |   43722 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Sun Jul 14 02:30:06 2024]
Finished job 0.
1 of 1 steps (100%) done
